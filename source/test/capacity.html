<HTML>

<HEAD>
   <TITLE>Stage3d Example</TITLE>
   <META http-equiv="Content-Type" content="text/html;charset=UTF-8">
   <LINK rel="stylesheet" href='../acs/lang_cn.css' type="text/css" media="all" />
   <SCRIPT language='javascript' src='../ajs/me.js'></SCRIPT>
   <SCRIPT language='javascript' src='../ajs/context_cn.js'></SCRIPT>
</HEAD>

<SCRIPT>
   function _load() {
      // 环境设置
      MO.initialize();
      MO.Runtime.setProcessCd(MO.EProcess.Debug);
      MO.Window.Browser.setContentPath('..');

//      var systemConsole = MO.Console.find(MO.FEaiLogicConsole).system();
//      systemConsole.postDeviceInfo();

      //      var hCanvas = document.createElement('CANVAS');
      //      hCanvas.style.width = '200px';
      //      hCanvas.style.height = '200px';
      //      hCanvas.width = 400;
      //      hCanvas.height = 400;
      //      var c2d = hCanvas.getContext('2d');
      //      c2d.webkitBackingStorePixelRatio = 4;
      //
      //      RDump.dump(c2d, _dump);
      //      return;

            var hCanvas = document.createElement("CANVAS");
            var context = MO.REngine3d.createContext(MO.FWglContext, hCanvas);
//            RDump.dump(RBrowser, _dump);
//            RDump.dump(context.capability(), _dump);
//            RDump.dump(context.parameters(), _dump);
//            RDump.dump(context.extensions(), _dump);
//            RDump.dump(context, _dump);
            var postJson = {};
            var agentCode = navigator.userAgent;
            postJson.code = agentCode;
            postJson.content2d = {};
            postJson.content3d = {};
            postJson.content3d.capability = {};
            postJson.content3d.parameters = {};
            postJson.content3d.extensions = {};
      
            var capability = context.capability();
            postJson.content3d.capability = parseInfo(capability);      
            var jsonString =  JSON.stringify(postJson);
      
            var tempForm = document.createElement("form");
            tempForm.action = "http://localhost:88/device/Device.wa?do=putMobileInfo";
            tempForm.method = "post";
            
            var codeInput = document.createElement("input");
            codeInput.name = "agentCode";
            codeInput.value = agentCode;
            tempForm.appendChild(codeInput);
            
            var option = document.createElement("textarea");
            option.name = "capability";
            option.value = jsonString;
            tempForm.appendChild(option);
            tempForm.submit();



   }

   function parseInfo(data) {
      var json = {};
      for (var key in data) {
         var type = typeof data[key];
         //         document.writeln("<font color='blue'>" + type + "</font>");
         if (type == "function") continue;
         json[key] = data[key];
         //         document.writeln(key + " : <font color='red'>" + data[key] + "</font><br>");
         if (type == "object") {
            var nextVal = data[key];
            parseInfo(nextVal);
         }
      }
      return json;

   }
</SCRIPT>

<BODY scroll='auto' onload='_load()'>
   <DIV id='_dump'></DIV>
   <br>
</BODY>

</HTML>