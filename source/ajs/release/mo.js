var ELogger=new function(){this.Debug="D";this.Info="I";this.Warn="W";this.Error="E";this.Fatal="F";return this},EProcess=new function(){this.Debug=1;this.Release=2;return this},EScope=new function(){this.Local=1;this.Session=2;this.Global=3;return this},RRuntime=new function(){this._processCd=EProcess.Release;this.isDebug=RRuntime_isDebug;this.isRelease=RRuntime_isRelease;this.setProcessCd=RRuntime_setProcessCd;this.nvl=RRuntime_nvl;this.subString=RRuntime_subString;this.className=RRuntime_className;
return this};function RRuntime_isDebug(){return this._processCd==EProcess.Debug}function RRuntime_isRelease(){return this._processCd==EProcess.Release}function RRuntime_setProcessCd(b){this._processCd=b}function RRuntime_nvl(b,d){return null!=b?b:d}function RRuntime_subString(b,d,f){if(null==b)return b;var h=0;if(null!=d){var q=b.indexOf(d);-1!=q&&(h=q+d.length)}d=b.length;null!=f&&(q=b.indexOf(f,h),-1!=q&&(d=q));return b.substring(h,d)}
function RRuntime_className(b){return b&&("function"==typeof b||(b=b.constructor))?this.subString(b.toString(),"function ","("):null}function SLooperEntry(){this.value=this.next=this.prior=null;this.dispose=SLooperEntry_dispose;return this}function SLooperEntry_dispose(){this.value=this.next=this.prior=null}
function TArray(){this._length=0;this._memory=[];this.isEmpty=TArray_isEmpty;this.length=TArray_length;this.memory=TArray_memory;this.contains=TArray_contains;this.indexOf=TArray_indexOf;this.get=TArray_get;this.set=TArray_set;this.push=TArray_push;this.swap=TArray_swap;this.sort=TArray_sort;this.erase=TArray_erase;this.remove=TArray_remove;this.compress=TArray_compress;this.clear=TArray_clear;this.dispose=TArray_dispose;this.dump=TArray_dump;return this}
function TArray_isEmpty(){return 0==this._length}function TArray_length(){return this._length}function TArray_memory(){return this._memory}function TArray_contains(b){return-1!=this.indexOf(b)}function TArray_indexOf(b){for(var d=this._length,f=0;f<d;f++)if(this._memory[f]==b)return f;return-1}function TArray_get(b){return 0<=b&&b<this._length?this._memory[b]:null}function TArray_set(b,d){0<=b&&b<this._length&&(this._memory[b]=d)}
function TArray_push(){for(var b=arguments.length,d=0;d<b;d++)this._memory[this._length++]=arguments[d]}function TArray_swap(b,d){if(0<=b&&b<this._length&&0<=d&&d<this._length&&b!=d){var f=this._memory[b];this._memory[b]=this._memory[d];this._memory[d]=f}}function TArray_sort(){this._memory.sort()}function TArray_erase(b){var d=null;if(0<=b&&b<c)for(this._length--,d=this._memory[b];b<c;b++)this._memory[b]=this._memory[b+1];return d}
function TArray_remove(b){if(null!=b){for(var d=0,f=this._length,h=d;h<f;h++)this._memory[h]!=b&&(this._memory[d++]=this._memory[h]);this._length=d}return b}function TArray_compress(){for(var b=this._length,d=0,f=0;f<b;f++){var h=this._memory[f];null!=h&&(this._memory[d++]=h)}this._length=d}function TArray_clear(){this._length=0}function TArray_dispose(){this._length=0;this._memory=null}
function TArray_dump(){var b=new TString,d=this._length;b.append(RRuntime.className(this),":",d);if(0<d)for(var f=0;f<d;f++)b.append(" [",this._memory[f],"]");return b.flush()}function TAttributes(){TDictionary.call(this);this.join=TAttributes_join;this.split=TAttributes_split;this.pack=TAttributes_pack;this.unpack=TAttributes_unpack;this.dump=TAttributes_dump;return this}
function TAttributes_join(b,d){var f=new TString;b||(b="=");d||(d=",");for(var h=this.count,q=0;q<h;q++)0<q&&f.append(d),f.append(this.names[q]),f.append(b),f.append(this.values[q]);return f.toString()}function TAttributes_split(b,d,f){b=b.split(f);f=b.length;for(var h=0;h<f;h++){var q=b[h];if(q.length){var z=q.split(d);2==z.length?this.set(RString.trim(z[0]),RString.trim(z[1])):this.set(RString.trim(q),"")}}}
function TAttributes_pack(){for(var b=new TString,d=this.count,f=0;f<d;f++){var h=this.names[f].length;b.append(h.toString().length,h,this.names[f]);if(null!=this.values[f]){var q=this.values[f]+"",h=q.length;b.append(h.toString().length,h,q)}else b.append("0")}return b.toString()}
function TAttributes_unpack(b){if(b&&b.length){var d=null,f=null,h=0;this.count=0;for(var q=b.length;h<q;){var z=parseInt(b.substr(h++,1)),A=parseInt(b.substr(h,z)),d=b.substr(h+z,A),h=h+(z+A),z=parseInt(b.substr(h++,1));0==z?f=null:(A=parseInt(b.substr(h,z)),f=b.substr(h+z,A),h+=z+A);this.set(d,f)}}}
function TAttributes_dump(){var b=new TString,d=this._count;b.append(RRuntime.className(this)," : ",d);if(0<d){b.append(" (");for(var f=0;f<d;f++)0<f&&b.append(", "),b.append(this._names[f],"=",this._values[f]);b.append(")")}return b.flush()}function TDictionary(){TMap.call(this);this.dump=TDictionary_dump;return this}
function TDictionary_dump(){var b=new TString,d=this._count;b.append(RRuntime.className(this),": ",d);if(0<d){b.append(" {\n");for(var f=0;f<d;f++)b.append("   ",this._names[f],"=[",this._values[f],"]\n");b.append("}")}return b.flush()}
function TList(){this._count=0;this._memory=[];this.isEmpty=TList_isEmpty;this.contains=TList_contains;this.indexOf=TList_indexOf;this.first=TList_first;this.last=TList_last;this.get=TList_get;this.set=TList_set;this.append=TList_append;this.insert=TList_insert;this.push=TList_push;this.pushUnique=TList_pushUnique;this.pop=TList_pop;this.swap=TList_swap;this.sort=TList_sort;this.erase=TList_erase;this.remove=TList_remove;this.clear=TList_clear;this.compress=TList_compress;this.pack=TList_pack;this.dispose=
TList_dispose;this.dump=TList_dump;return this}function TList_isEmpty(){return 0==this._count}function TList_contains(b){return-1!=this.indexOf(b)}function TList_indexOf(b){for(var d=this._count,f=0;f<d;f++)if(this._memory[f]==b)return f;return-1}function TList_first(){return this._count?this._memory[0]:null}function TList_last(){return this._count?this._memory[this._count-1]:null}function TList_get(b){return 0<=b&&b<this._count?this._memory[b]:null}
function TList_set(b,d){0<=b&&b<this._count&&(this._memory[b]=d)}function TList_append(b){for(var d=b._count,f=0;f<d;f++)this.push(b.get(f))}function TList_insert(b,d){var f=this._count;if(0<=b&&b<=f){for(;f>b;f--)this._memory[f]=this._memory[f-1];this._memory[b]=d}}function TList_push(b){var d=this._count++;this._memory[d]=b;return d}function TList_pushUnique(b){for(var d=this._count-1;0<=d;d--)if(this._memory[d]==b)return d;d=this._count++;this._memory[d]=b;return d}
function TList_pop(){if(this._count)return this._memory[--this._count]}function TList_swap(b,d){if(0<=b&&b<this._count&&0<=d&&d<this._count&&b!=d){var f=this._memory[b];this._memory[b]=this._memory[d];this._memory[d]=f}}function TList_sort(){this._memory.sort()}function TList_erase(b){var d=null;if(0<=b&&b<this._count)for(var d=this._memory[b],f=--this._count;b<f;b++)this._memory[b]=this._memory[b+1];return d}
function TList_remove(b){if(null!=b){var d=this._count;if(0<d){for(var f=0,h=f;h<d;h++)this._memory[h]!=b&&(this._memory[f++]=this._memory[h]);this._count=f}}return b}function TList_clear(){this._count=0}function TList_compress(){var b=this._count;if(0<b){for(var d=0,f=0;f<b;f++){var h=this._memory[f];null!=h&&(this._memory[d++]=h)}this._count=d}}function TList_pack(){for(var b=new TStrings,d=0;d<this._count;d++)b.push(this.get(d).pack());return b.pack()}
function TList_dispose(){this._count=0;for(var b in this._memory)delete this._memory[b];this._memory=null}function TList_dump(){var b=this._count,d=new TString;d.append(RClass.name(this),":",b);if(0<b)for(var f=0;f<b;f++)d.append(" [",this._memory[f],"]");return d.toString()}
function TLooper(){this._recordCount=this._count=0;this._unused=this._current=null;this.innerCreate=TLooper_innerCreate;this.innerFree=TLooper_innerFree;this.innerPush=TLooper_innerPush;this.innerRemove=TLooper_innerRemove;this.innerRemoveCurrent=TLooper_innerRemoveCurrent;this.innerRemoveValue=TLooper_innerRemoveValue;this.isEmpty=TLooper_isEmpty;this.count=TLooper_count;this.record=TLooper_record;this.unrecord=TLooper_unrecord;this.contains=TLooper_contains;this.current=TLooper_current;this.next=
TLooper_next;this.push=TLooper_push;this.pushUnique=TLooper_pushUnique;this.removeCurrent=TLooper_removeCurrent;this.remove=TLooper_remove;this.clear=TLooper_clear;this.dispose=TLooper_dispose;this.dump=TLooper_dump;return this}function TLooper_innerCreate(){var b=this._unused;null==b?b=new SLooperEntry:this._unused=b.next;return b}function TLooper_innerFree(b){b.next=this._unused;this._unused=b}
function TLooper_innerPush(b){var d=this._current;if(d){var f=d.prior;b.prior=f;b.next=d;f.next=b;d.prior=b}else b.prior=b,this._current=b.next=b;this._count++}function TLooper_innerRemove(b){var d=b.prior,f=b.next;d.next=f;f.prior=d;this._count--;this._current=0<this._count?f:null;this.innerFree(b)}function TLooper_innerRemoveCurrent(){var b=null;0<this._count&&(b=this._current.value,this.innerRemove(this._current));return b}
function TLooper_innerRemoveValue(b){if(0<o._count)if(o._current.value==b)o.innerRemoveCurrent();else for(var d=o._current,f=d.next;f!=d;){if(f.value==b){o.innerRemove(f);o._current=d;break}f=f.next}}function TLooper_isEmpty(b){return 0==this._count}function TLooper_count(){return this._count}function TLooper_record(){this._recordCount=this._count}function TLooper_unrecord(b){this._recordCount=-1}
function TLooper_contains(b){if(this._current)for(var d=this._count,f=this._current,h=0;h<d;h++){if(f.value==b)return!0;f=f.next}return!1}function TLooper_current(){var b=this._current;return b?b.value:null}function TLooper_next(){this._current&&(this._current=this._current.next);var b=this._recordCount;if(0<b)this._recordCount--;else if(0==b)return null;return this._current?this._current.value:null}function TLooper_push(b){var d=this.innerCreate();d.value=b;this.innerPush(d)}
function TLooper_pushUnique(b){this.contains(b)||this.push(b)}function TLooper_removeCurrent(){return this.innerRemoveCurrent()}function TLooper_remove(b){this.innerRemoveValue(b)}function TLooper_clear(){var b=this._current;b&&(b.prior.next=null,b.prior=this._unused,this._unused=b,this._current=null);this._count=0}function TLooper_dispose(){this.clear();for(var b=this._unused;b;){var d=b.next;b.dispose();b=d}this._unused=null}
function TLooper_dump(){var b=this._count,d=new TString;d.append(RClass.name(this),": ",b);if(0<b)for(var f=this._current,h=0;h<b;h++)d.append(" [",f.value,"]"),f=f.next;return d.toString()}
function TMap(){this._count=0;this._table={};this._names=[];this._values=[];this.isEmpty=TMap_isEmpty;this.count=TMap_count;this.contains=TMap_contains;this.containsValue=TMap_containsValue;this.indexOf=TMap_indexOf;this.indexOfValue=TMap_indexOfValue;this.first=TMap_first;this.last=TMap_last;this.nameAt=TMap_nameAt;this.name=TMap_name;this.at=this.valueAt=TMap_valueAt;this.value=TMap_value;this.setValueAt=TMap_setValueAt;this.setValue=TMap_setValue;this.get=TMap_get;this.set=TMap_set;this.assign=
TMap_assign;this.append=TMap_append;this.insert=TMap_insert;this.remove=TMap_remove;this.removeName=TMap_removeName;this.removeValue=TMap_removeValue;this.rebuild=TMap_rebuild;this.clear=TMap_clear;this.toString=TMap_toString;this.dispose=TMap_dispose;this.dump=TMap_dump;return this}function TMap_isEmpty(){return 0==this._count}function TMap_count(){return this._count}function TMap_contains(b){return null!=b&&null!=this._table[b.toString().toLowerCase()]?!0:!1}
function TMap_containsValue(b){return-1!=this.indexOfValue(b)}function TMap_indexOf(b){return null!=b&&(b=this._table[b.toString().toLowerCase()],null!=b)?b:-1}function TMap_indexOfValue(b){for(var d=this._count,f=0;f<d;f++)if(this._values[f]==b)return f;return-1}function TMap_first(){return 0<this._count?this._values[0]:null}function TMap_last(){return 0<this._count?this._values[this._count-1]:null}function TMap_nameAt(b){return this._names[b]}
function TMap_name(b){return 0<=b&&b<this._count?this._names[b]:null}function TMap_valueAt(b){return this._values[b]}function TMap_value(b){return 0<=b&&b<this._count?this._values[b]:null}function TMap_setValueAt(b,d){this._values[b]=d}function TMap_setValue(b,d){0<=b&&b<this._count&&(this._values[b]=d)}function TMap_get(b,d){if(null!=b){var f=this._table[b.toString().toLowerCase()];if(null!=f)return this._values[f]}return d}
function TMap_set(b,d){if(null!=b){var f=b.toString().toLowerCase(),h=this._table[f];if(null==h||h>=this._count)h=this._count++,this._names[h]=b,this._table[f]=h;this._values[h]=d}}function TMap_assign(b){this.clear();this.append(b)}function TMap_append(b){if(b)for(var d=b._count,f=0;f<d;f++)this.set(b.name(f),b.value(f))}
function TMap_insert(b,d,f){var h=this._count;if(0<=b&&b<=h){for(;h>b;h--)this._names[h]=this._names[h-1],this._values[h]=this._values[h-1];this._names[b]=d;this._values[b]=f;this._count++;this.rebuild()}}function TMap_remove(b){var d=null,f=this._count;if(0<=b&&b<f){for(d=this._values[b];b<f;b++)this._names[b]=this._names[b+1],this._values[b]=this._values[b+1];this._count--;this.rebuild()}return d}function TMap_removeName(b){b=this.indexOf(b);return-1!=b?this.remove(b):null}
function TMap_removeValue(b){for(var d=0,f=this._count,h=0;h<f;h++){var q=this._values[h];b!=q&&(d!=h&&(this._names[d]=this._names[h],this._values[d]=q),d++)}this._count=d;this.rebuild()}function TMap_rebuild(){var b=this._table,d;for(d in b)delete b[d];var f=this._count;for(d=0;d<f;d++)b[(this._names[d]+"").toLowerCase()]=d}function TMap_clear(){this._count=0;for(var b in this._table)delete this._table[b]}function TMap_toString(){return this.dump().toString()}
function TMap_dispose(){this._count=0;var b=this._table;if(b){for(var d in b)b[d]=null;this._table=null}if(b=this._names){for(d=b.length-1;0<=d;d--)b[d]=null;this._names=null}if(b=this._values){for(d=b.length-1;0<=d;d--)b[d]=null;this._values=null}}function TMap_dump(){var b=new TString,d=this._count;b.appendLine(RRuntime.className(this),": ",d);if(0<d){b.append(" {");for(var f=0;f<d;f++)b.appendLine(this._names[f],"=[",this._values[f],"]");b.append("}")}return b.flush()}
function TObjects(){this._count=0;this._items=[];this.isEmpty=TObjects_isEmpty;this.count=TObjects_count;this.items=TObjects_items;this.contains=TObjects_contains;this.indexOf=TObjects_indexOf;this.first=TObjects_first;this.last=TObjects_last;this.at=this.getAt=TObjects_getAt;this.get=TObjects_get;this.setAt=TObjects_setAt;this.set=TObjects_set;this.assign=TObjects_assign;this.append=TObjects_append;this.insert=TObjects_insert;this.shift=TObjects_shift;this.unshift=TObjects_unshift;this.pop=TObjects_pop;
this.push=TObjects_push;this.pushUnique=TObjects_pushUnique;this.swap=TObjects_swap;this.sort=TObjects_sort;this.erase=TObjects_erase;this.remove=TObjects_remove;this.clear=TObjects_clear;this.dispose=TObjects_dispose;this.dump=TObjects_dump;return this}function TObjects_isEmpty(){return 0==this._count}function TObjects_count(){return this._count}function TObjects_items(){return this._items}function TObjects_contains(b){return-1!=this.indexOf(b)}
function TObjects_indexOf(b){for(var d=this._count,f=this._items,h=0;h<d;h++)if(f[h]==b)return h;return-1}function TObjects_first(){return this._count?this._items[0]:null}function TObjects_last(){return this._count?this._items[this._count-1]:null}function TObjects_getAt(b){return this._items[b]}function TObjects_get(b){return 0<=b&&b<this._count?this._items[b]:null}function TObjects_setAt(b,d){this._items[b]=d}function TObjects_set(b,d){0<=b&&b<this._count&&(this._items[b]=d)}
function TObjects_assign(b){for(var d=this._count=b._count,f=0;f<d;f++)this._items[f]=b._items[f]}function TObjects_append(b){for(var d=b._count,f=0;f<d;f++)this.push(b.get(f))}function TObjects_insert(b,d){var f=this._count;if(0<=b&&b<=f){for(;f>b;f--)this._items[f]=this._items[f-1];this._items[b]=d}}function TObjects_shift(){return this.erase(0)}function TObjects_unshift(b){return this.insert(0,b)}function TObjects_pop(){if(this._count)return this._items[--this._count]}
function TObjects_push(b){var d=this._count++;this._items[d]=b;return d}function TObjects_pushUnique(b){for(var d=this._count-1;0<=d;d--)if(this._items[d]==b)return d;d=this._count++;this._items[d]=b;return d}function TObjects_swap(b,d){if(0<=b&&b<this._count&&0<=d&&d<this._count&&b!=d){var f=this._items,h=f[b];f[b]=f[d];f[d]=h}}function TObjects_sort(b){var d=this._items;d.length!=this._count&&(d.length=this._count);d.sort(b)}
function TObjects_erase(b){var d=null;if(0<=b&&b<this._count){for(var d=this._items[b],f=--this._count,h=this._items;b<f;b++)h[b]=h[b+1];h[f]=null}return d}function TObjects_remove(b){var d=this._count;if(d){for(var f=0,h=this._items,q=f;q<d;q++)h[q]!=b&&(h[f++]=h[q]);for(q=f;q<d;q++)h[q]=null;this._count=f}return b}function TObjects_clear(){this._count=0}function TObjects_dispose(){for(var b in this._items)this._items[b]=null;this._count=0;this._items=null}
function TObjects_dump(){var b=this._count,d=new TString;d.append(RRuntime.className(this),":",b);if(0<b)for(var f=0;f<b;f++)d.append(" [",this._items[f],"]");return d.flush()}
function TString(){this._count=0;this._memory=[];this.isEmpty=TString_isEmpty;this.assign=TString_assign;this.append=TString_append;this.appendIf=TString_appendIf;this.appendLine=TString_appendLine;this.appendRepeat=TString_appendRepeat;this.push=TString_push;this.clear=TString_clear;this.toString=TString_toString;this.flush=TString_flush;this.dispose=TString_dispose;this.dump=TString_dump;return this}function TString_isEmpty(){return 0==this._count}
function TString_assign(b){for(var d=arguments,f=d.length,h=this._count=0;h<f;h++)b=d[n],null!=b&&(this._memory[this._count++]=b)}function TString_append(b){for(var d=arguments,f=d.length,h=0;h<f;h++)b=d[h],null!=b&&(this._memory[this._count++]=b)}function TString_appendIf(b,d){if(b)for(var f=arguments,h=f.length,q=1;q<h;q++)d=f[q],null!=d&&(this._memory[this._count++]=d)}function TString_appendRepeat(b,d){for(var f=0;f<d;f++)this._memory[this._count++]=b}
function TString_appendLine(b){for(var d=arguments,f=d.length,h=0;h<f;h++)b=d[h],null!=b&&(this._memory[this._count++]=b);this._memory[this._count++]="\r\n"}function TString_push(b){for(var d=arguments,f=d.length,h=0;h<f;h++)b=d[h],null!=b&&(this._memory[this._count++]=b)}function TString_clear(){this._count=0}function TString_toString(){var b=this._memory;this._memory.length!=this._count&&(b=this._memory.slice(0,this._count));return b.join("")}
function TString_flush(){var b=this.toString();this.dispose();return b}function TString_dispose(){this._count=0;var b=this._memory;if(b){for(var d=b.length-1;0<=d;d--)b[d]=null;this._memory=null}}function TString_dump(){var b=this.toString();return RRuntime.className(this)+":"+b.length+"["+b+"]"}function TStrings(){TList(this);this.pack=TStrings_pack;this.unpack=TStrings_unpack;return this}
function TStrings_pack(){for(var b=new TString,d=this.count,f=0;f<d;f++){var h=this.get(f),q=h.length.toString();sa=q.length+q+h;b.append(sa)}return b.flush()}function TStrings_unpack(b){if(!RString.isEmpty(b))for(var d=b.length,f=0;f<d;){var h=parseInt(b.charAt(f++)),q=parseInt(b.substr(f,h)),f=f+h,h=b.substr(f,q),f=f+q;this.push(h)}}
var RGlobal=new function(){this.instances=new TDictionary;this.get=RGlobal_get;this.set=RGlobal_set;this.globalGet=RGlobal_globalGet;this.globalSet=RGlobal_globalSet;return this};function RGlobal_get(b){return this.instances.get(b)}function RGlobal_set(b,d){this.instances.set(b,d)}function RGlobal_globalGet(b){return top.RGlobal?top.RGlobal.get(b):this.instances.get(b)}function RGlobal_globalSet(b,d){top.RGlobal?top.RGlobal.set(b,d):this.instances.set(b,d)}
var RMemory=new function(){this.objects=[];this.instances={};this.isObject=RMemory_isObject;this.create=RMemory_create;this.register=RMemory_register;this.disposeObject=RMemory_disposeObject;this.dispose=RMemory_dispose;this.unlink=RMemory_unlink;this.free=RMemory_free;this.freeHtml=RMemory_freeHtml;this.release=RMemory_release;this.refresh=RMemory_refresh;return this};
function RMemory_isObject(b){var d=typeof b;return"boolean"!=d&&"number"!=d&&"string"!=d&&"date"!=d&&"function"!=d&&b instanceof Object}function RMemory_create(b){b=new b;this.objects.push(b);return b}function RMemory_register(b,d){this.isObject(d)&&(this.objects.push(d),this.instances[b]=d)}function RMemory_disposeObject(b){}function RMemory_dispose(b){null!=b&&this.isObject(b)&&!b._disposed&&(b._disposed=!0,b.dispose instanceof Function&&b.dispose(),this.disposeObject(b))}
function RMemory_unlink(b){for(var d in b){var f=b[d];b[d]=null;null!=f&&this.isObject(f)&&this.unlink(b)}}function RMemory_free(b){this.dispose(b);this.unlink(b)}function RMemory_freeHtml(b){b&&b.removeNode(!0)}function RMemory_release(){this.free(this.objects);this.free(this.instances);this.refresh()}function RMemory_refresh(){RContext.optionGarbage&&CollectGarbage()}
function AAnnotation(b){this._annotationCd=null;this._duplicate=this._inherit=!1;this._name=b;this.annotationCd=AAnnotation_annotationCd;this.name=AAnnotation_name;this.code=AAnnotation_code;this.value=AAnnotation_value;return this}function AAnnotation_annotationCd(){return this._annotationCd}function AAnnotation_name(){return this._name}function AAnnotation_code(){return this._name}function AAnnotation_value(){return null}
function AEnum(b,d){this.inherit=!0;this.annotation=EAnnotation.Enum;this.name=b;this.linker=d;return this}function ALinker(b,d){this.inherit=!0;this.annotation=EAnnotation.Linker;this.name=b;this.linker=d;return this}
function AProperty(b,d){AAnnotation.call(this,b);this._inherit=!0;this._annotationCd=EAnnotation.Property;this._linker=null;this._force=!1;this.code=AProperty_code;this.build=AProperty_build;this.load=AProperty_load;this.save=AProperty_save;this.toString=AProperty_toString;var f=null;null==d?(f=RString.startsWith(b,"_")?b.substring(1):b,f=RString.toUnderline(f)):f=d;this._linker=f;return this}function AProperty_code(){return this._linker}function AProperty_build(){}
function AProperty_load(b,d){b[this._name]=d.get(this._linker)}function AProperty_save(b,d){d.set(this._linker,b[this._name])}function AProperty_toString(){return"<"+this._annotationCd+",linker="+this._linker+">"}
var EAnnotation=new function(){this.Property="property";this.Event="enum";this.Event="event";this.Linker="linker";this.Style="style";this.StyleIcon="icon";return this},EBoolean=new function(){this.True="Y";this.False="N";return this},ECharCase=function(){this.Upper="U";this.Lower="L";this.Word="W";return this},EDataType=new function(){this.Unknown=0;this.Int8=1;this.Int16=2;this.Int32=3;this.Int64=4;this.Uint8=5;this.Uint16=6;this.Uint32=7;this.Uint64=8;this.Float16=9;this.Float32=10;this.Float64=
11;this.String=12;return this},EEndian=new function(){this.Big=0;this.Little=1;return this},ENodeType=new function(){this.Node=1;this.Text=3;this.Data=4;return this},ENumber=new function(){this.Integer="I";this.PositiveInteger="PI";this.NegativeInteger="NI";this.Float="F";this.PositiveFloat="PF";this.NegativeFloat="NF";return this},ERegExp=new function(){this.I=/^-?[1-9]\d*|0$/;this.PI=/^[1-9]\d*$/;this.NI=/^-[1-9]\d*$/;this.F=/^-?([1-9]\d*\.\d*|0\.\d*[1-9]\d*|0?\.0+|0)$/;this.PF=/^[1-9]\d*\.\d*|0\.\d*[1-9]\d*$/;
this.NF=/^-([1-9]\d*\.\d*|0\.\d*[1-9]\d*)$/;this.U=/[1-9]{1}[0-9]/;this.E=/^\w{1,}[@]{1}[a-zA-Z]{1,}[.]{1}[a-zA-Z]{1,}$/;return this},EResult=new function(){this.Success=0;this.Continue=1;this.Skip=2;this.Finish=3;this.Failure=-1;this.Cancel=-2;return this};function MInstance(b){b=RClass.inherits(this,b);b.__free=!1;b.instanceCreate=RMethod.empty;b.instanceAlloc=RMethod.empty;b.instanceFree=RMethod.empty;b.instanceRelease=RMethod.empty;return b}
function MInvoke(b){b=RClass.inherits(this,b);b.invoke=RMethod.virtual(b,"invoke");return b}function MPoolAble(b){b=RClass.inherits(this,b);b._poolCode=null;b.poolCode=MPoolAble_poolCode;b.setPoolCode=MPoolAble_setPoolCode;return b}function MPoolAble_poolCode(){return this._code}function MPoolAble_setPoolCode(b){this._poolCode=b}function SArguments(){this.owner=null;return this}function SEnumItem(){this.name=null;this.value=0;return this}
function TClass(){this.__disposed=!0;this._unused=null;this._annotations={};this._attributes={};this.instance=this.clazz=this.base=this.parent=this.name=null;this._abstract=!1;this.styles=[];this.instances=[];this.register=TClass_register;this.assign=TClass_assign;this.annotations=TClass_annotations;this.annotation=TClass_annotation;this.annotationFind=TClass_annotationFind;this.attributeFind=TClass_attributeFind;this.style=TClass_style;this.build=TClass_build;this.newInstance=TClass_newInstance;
this.free=TClass_free;this.alloc=TClass_alloc;return this}
function TClass_register(b){var d=b.annotationCd(),f=b.name(),h=b.code();if(!d||!h)throw new TError(this,"Unknown annotation. (class={1},annotation={2},name={3},code={4})",RClass.dump(this),d,f,h);var q=this._annotations[d];q||(q=this._annotations[d]={});if(!b._duplicate&&q[h])throw new TError(this,"Duplicate annotation. (class={1},annotation={2},name={3},code={4},value={5})",RClass.dump(this),d,f,h,b.toString());q[h]=b;this._attributes[f]=b}
function TClass_assign(b){for(var d in b._annotations){var f=this._annotations[d];f||(f=this._annotations[d]={});var h=b._annotations[d],q;for(q in h){var z=h[q];if(!z._duplicate&&f[q])throw new TError(this,"Duplicate annotation. (annotation={1}, {2}.{3}={4}.{5}, source={6})",d,this.name,q,b.name,q,z.toString());z._inherit&&(f[q]=z)}}for(q in b._attributes)z=b._attributes[q],z.construct!=Function&&(this._attributes[q]=b._attributes[q])}
function TClass_annotations(b){var d=this._annotations[b];d||RLogger.fatal(this,null,"Can't find annotations. (annotation={1}, class={2})",b,this.name);return d}function TClass_annotation(b,d){var f=null,h=this._annotations[b];h&&(f=h[d]);f||RLogger.fatal(this,null,"Can't find annotation. (annotation={1}, name={2}, class={3})",b,d,this.name);return f}
function TClass_annotationFind(b){for(var d in this._annotations){var f=this._annotations[d];if(f&&(f=f[b],null!=f&&f.constructor!=Function))return f}return null}function TClass_attributeFind(b){return(b=this._attributes[b])&&b.constructor!=Function?b:null}
function TClass_style(b){if(this.styles[b])return this.styles[b];for(var d=null,f=this;f;){var h=f._annotations[EAnnotation.Style];if(h&&(d=h[b]))break;f=f.parent}d||RLogger.fatal(this,null,"No register style annotation. (name={1}, linker={2}, class={3})",this.name+"_"+b,this.liner,this.name);d=f.name+"_"+d.style();return this.styles[b]=d}
function TClass_build(){for(var b in this.instance){var d=this.instance[b];if(null!=d&&d.constructor==Function&&d.__virtual){this._abstract=!0;break}}if(d=this._annotations[EAnnotation.Property])for(b in d)d[b].build(this.instance)}
function TClass_newInstance(){var b=this.alloc();if(!b){if(this._abstract){var b=new TString,d;for(d in this.instance){var f=this.instance[d];RMethod.isVirtual(f)&&(b.isEmpty()||b.append(","),b.append(f._name))}return RLogger.fatal(this,null,"Abstract Class can't be create.(name={1})\n[{2}]",this.name,b)}var h=this.instance;if(!h)return RLogger.fatal(this,null,"Class instance is empty. (name={1})",this.name);b=new h.constructor;for(d in h){f=h[d];if(null!=f){if("__base"==d||"__inherits"==d){b[d]=
h[d];continue}RClass.isBase(f)||(f=RObject.clone(f))}b[d]=f}b.__class=this;b.construct&&b.construct()}return b}function TClass_alloc(){var b=this._unused;b&&(this._unused=b.cnext,b.cnext=null,b._using=!0);return b}function TClass_free(b){if(b._using){b.cnext=this._unused;this._unused=b;b._using=!1;for(var d in b){var f=b[d];if(f&&!RClass.isBase(f))if(f._class)this.free(f);else if(this.isClass(f,Array))for(var h=0;h<f.length;h++){var q=f[h];q._class&&this.free(q)}}}}
function TClassBase(){this.__disposed=!0;return this}function TContext(b,d,f){this.name=b;this.code=d;this.text=f;return this}
function TDataset(){this._code=null;this._pageSize=20;this._total=this._pageCount=this._pageIndex=0;this._rows=new TObjects;this.isEmpty=TDataset_isEmpty;this.createRow=TDataset_createRow;this.count=TDataset_count;this.row=TDataset_row;this.rows=TDataset_rows;this.find=TDataset_find;this.push=TDataset_push;this.loadConfig=TDataset_loadConfig;this.clear=TDataset_clear;return this}function TDataset_isEmpty(){return this._rows.isEmpty()}
function TDataset_createRow(){var b=new TRow;b._dataset=this;this._rows.push(b);return b}function TDataset_count(){return this._rows.count()}function TDataset_row(b){return this._rows.get(b)}function TDataset_rows(){return this._rows}
function TDataset_find(b){var d=arguments,f=d.length;if(0!=f%2)throw new TError(this,"Parameters must is pairs (length={1})",f);for(var h=this._rows,q=h.count(),z=0;z<q;z++){for(var A=h.get(z),B=!0,C=0;C<f;C+=2)if(A.get(d[z])!=d[z+1]){B=!1;break}if(B)return A}return null}function TDataset_push(b){this._rows.push(b)}
function TDataset_loadConfig(b){this._code=b.get("name");this._pageSize=RInteger.parse(b.get("page_size",1E3));this._pageIndex=RInteger.parse(b.get("page",0));this._pageCount=RInteger.parse(b.get("page_count",1));this._total=RInteger.parse(b.get("total"));if(b=b.nodes())for(var d=b.count(),f=0;f<d;f++){var h=b.get(f);h.isName("Row")&&this.createRow().loadConfig(h)}}function TDataset_clear(){this._pageSize=20;this._total=this._pageCount=this._pageIndex=0;this._rows.clear()}
function TDataset_findIndex(b){for(var d=this._rows,f=d.count(),h=0;h<f;h++){var q=d.get(h);if(q._index=b)return q}return null}function TDataset_remove(b){return this._rows.remove(b)}function TDataset_removeRow(b){b=this.indexOf(b);-1!=b&&this._rows.remove(b)}function TDataset_saveViewer(b){b.datasetName=this._code;b.datasetId=this.id;b.position=0;b.start=0;b._count=this._rows._count;b._rows=this._rows;b.dataset=this}
function TDataset_pack(){for(var b=this._rows,d=new TStrings,f=0;f<b._count;f++)d.push(b.get(f).pack());return d.pack()}function TDataset_dump(){var b=new TString;b.append(RClass._code(this));b.append(" count=",this._count);b.append(" fields=",this.fieldCount);b.appendLine();if(this._rows)for(var d=this._count,f=0;f<d;f++)b.append("- "),this._rows.get(f).dump(s),f!=this._count-1&&b.appendLine();return b.toString()}
function TDatasetViewer(){this._datasetId=null;this._count=this._start=this._position=0;this._ouids=this._rows=e._values=null;this.isEmpty=TDatasetViewer_isEmpty;this.count=TDatasetViewer_count;this.current=TDatasetViewer_current;this.reset=TDatasetViewer_reset;this.move=TDatasetViewer_move;this.moveToRow=TDatasetViewer_moveToRow;this.first=TDatasetViewer_first;this.prior=TDatasetViewer_prior;this.next=TDatasetViewer_next;this.last=TDatasetViewer_last;return this}
function TDatasetViewer_isEmpty(){return null==this._count}function TDatasetViewer_count(){return this._count}function TDatasetViewer_current(){var b=this._rows;return b?b.get(this._position-this._start):null}function TDatasetViewer_reset(){this._position=-1}function TDatasetViewer_move(b){this._position=b}function TDatasetViewer_moveToRow(b){b=this._rows.indexOf(b);-1!=b&&(this._position=b-this._start)}function TDatasetViewer_first(b){this._position=b?-1:0}
function TDatasetViewer_prior(){return 0<this._position?(this._position--,!0):!1}function TDatasetViewer_next(){return this._position<this._count-1?(this._position++,!0):!1}function TDatasetViewer_last(){this._position=this._count-1}
function TDate(b){this.date=b?b:new Date;this.ms=this.second=this.minute=this.hour=this.day=this.month=this.year=null;this.equals=TDate_equals;this.isBefore=TDate_isBefore;this.isAfter=TDate_isAfter;this.monthDays=TDate_monthDays;this.monthWeekDay=TDate_monthWeekDay;this.weekDay=TDate_weekDay;this.setYear=TDate_setYear;this.setMonth=TDate_setMonth;this.setDay=TDate_setDay;this.setHour=TDate_setHour;this.setMinute=TDate_setMinute;this.setSecond=TDate_setSecond;this.addYear=TDate_addYear;this.addMonth=
TDate_addMonth;this.addDay=TDate_addDay;this.addMseconds=TDate_addMseconds;this.refresh=TDate_refresh;this.setDate=TDate_setDate;this.now=TDate_now;this.clone=TDate_clone;this.dump=TDate_dump;this.refresh();return this}function TDate_clone(){var b=new Date;b.setTime(this.date.getTime());return new TDate(b)}function TDate_equals(b){return this.date.getTime()==b.date.getTime()}function TDate_isBefore(b){return this.date.getTime()<b.date.getTime()}
function TDate_isAfter(b){return this.date.getTime()>b.date.getTime()}function TDate_monthDays(){return RDate.monthDays(this.year,this.month)}function TDate_monthWeekDay(){return(8-(this.day-this.weekDay())%7)%7}function TDate_weekDay(){return this.date.getDay()}function TDate_setYear(b){this.date.setFullYear(b);this.refresh()}function TDate_setMonth(b){this.date.setMonth(parseInt(b,10)-1);this.refresh()}function TDate_setDay(b){this.date.setDate(b);this.refresh()}
function TDate_setHour(b){this.date.setHours(b);this.refresh()}function TDate_setMinute(b){this.date.setMinutes(b);this.refresh()}function TDate_setSecond(b){this.date.setSeconds(b);this.refresh()}function TDate_addYear(b){this.date.setFullYear(this.date.getFullYear()+parseInt(b));this.refresh()}function TDate_addMonth(b){this.date.setMonth(this.date.getMonth()+parseInt(b));this.refresh()}function TDate_addDay(b){this.date.setTime(this.date.getTime()+864E5*parseInt(b));this.refresh()}
function TDate_addMseconds(b){this.date.setTime(this.date.getTime()+parseInt(b));this.refresh()}function TDate_refresh(){var b=this.date;b&&(this.year=b.getFullYear(),this.month=b.getMonth()+1,this.day=b.getDate(),this.hour=b.getHours(),this.minute=b.getMinutes(),this.second=b.getSeconds(),this.ms=b.getMilliseconds())}function TDate_setDate(b){this.date=b;this.refresh()}function TDate_now(){this.date=new Date;this.refresh()}
function TDate_dump(){return RClass.dump(this)+" "+RDate.formatDate(this)}
function TError(b,d,f){for(var h=new TString,q=TError.caller,z=new TString,A=[];q&&!RArray.contains(A,q);)A.push(q),q=q.caller;for(var B=A.length,C=0;C<B;C++)q=A[C],0<C&&z.appendLine(),z.append("   "+(B-C)+": "+RMethod.name(q));q=arguments;B=q.length;for(C=2;C<B;C++){var A=q[C],D=null,D="function"==typeof A?RMethod.name(A):A;d=d.replace("{"+(C-1)+"}",D)}h.appendLine(d);h.appendLine("------------------------------------------------------------");h.append(z);throw Error(h);}
function TFatalError(b,d,f,h){for(var q=new TString,z=TFatalError.caller,A=new TString,B=[];z&&!RArray.contains(B,z);)B.push(z),z=z.caller;for(var C=B.length,D=0;D<C;D++)z=B[D],0<D&&A.appendLine(),A.append("   "+(C-D)+": "+RMethod.name(z));z=arguments;C=z.length;for(D=2;D<C;D++){var B=z[D],E=null,E="function"==typeof B?RMethod.name(B):B;f=f.replace("{"+(D-1)+"}",E)}q.appendLine(f);q.appendLine("------------------------------------------------------------");q.append(A);throw Error(q);}
function TInstancePool(){TObjects.call(this);this._instance=null;this.instance=TInstancePool_instance;this.alloc=TInstancePool_alloc;this.free=TInstancePool_free;return this}function TInstancePool_instance(b){var d=this._instance;null==d&&(d=this._instance=RClass.create(b),d.instanceCreate());d.instanceAlloc();return d}function TInstancePool_alloc(b){var d=null;0==this._count?(d=RClass.create(b),d.instanceCreate()):d=this.pop();d.instanceAlloc();return d}
function TInstancePool_free(b){b.instanceFree();return this.push(b)}function TInvoke(){this.callback=this.owner=null;this.invoke=TInvoke_invoke;return this}function TInvoke_invoke(b,d,f,h,q,z){if(this.callback){var A=this.owner?this.owner:this;try{this.callback.call(A,b,d,f,h,q,z)}catch(B){RLogger.fatal(this,B,"Call method failure. (owner={1}, callback={2})",A,this.callback)}}}
function TListener(){this._callback=this._owner=null;this.process=TListener_process;this.toString=TListener_toString;this.dispose=TListener_dispose;return this}function TListener_process(b,d,f,h,q,z){this._callback.call(this._owner?this._owner:this,b,d,f,h,q,z)}function TListener_toString(){return RClass.name(this)+"(owner="+RClass.name(this._owner)+", callback="+RMethod.name(this._callback)+")"}function TListener_dispose(){this._callback=this._owner=null;RObject.free(this)}
function TListeners(){this._listeners=null;this.isEmpty=TListeners_isEmpty;this.find=TListeners_find;this.register=TListeners_register;this.unregister=TListeners_unregister;this.push=TListeners_push;this.remove=TListeners_remove;this.process=TListeners_process;this.clear=TListeners_clear;this.dispose=TListeners_dispose;this.dump=TListeners_dump;return this}function TListeners_isEmpty(){var b=this._listeners;return b?b.isEmpty():!0}
function TListeners_find(b,d){var f=this._listeners;if(f)for(var h=f.count(),q=0;q<h;q++){var z=f.getAt(q);if(z._owner==b&&z._callback==d)return z}return null}function TListeners_register(b,d){var f=this.find(b,d);if(f)throw new TError(this,"Listener is already register. (owner={1}, process={2})",b,d);f=new TListener;f._owner=b;f._callback=d;this.push(f);return f}
function TListeners_unregister(b,d){var f=this.find(b,d);if(!f)throw new TError(this,"Listener is not register. (owner={1}, process={2})",b,d);this.remove(f);f.dispose()}function TListeners_push(b){if(!b)throw new TError(this,"Listener is null.");if(!b._callback)throw new TError(this,"Listener process is null.");var d=this._listeners;d||(d=this._listeners=new TObjects);d.push(b)}function TListeners_remove(b){if(!b)throw new TError(this,"Listener is null.");this._listeners.remove(b)}
function TListeners_process(b,d,f,h,q,z){var A=this._listeners;if(A)for(var B=A.count(),C=0;C<B;C++)A.getAt(C).process(b,d,f,h,q,z)}function TListeners_clear(){var b=this._listeners;b&&b.clear()}function TListeners_dispose(){var b=this._listeners;if(b){for(var d=b.count()-1;0<=d;d--)b.getAt(d).dispose();this._listeners=RObject.dispose(b)}RObject.free(this)}
function TListeners_dump(){var b=new TString;b.append(RClass.name(this));for(var d=this._listeners,f=d.count(),h=0;h<f;h++)b.append("\n   "+d.getAt(h));return b.flush()}function TLoaderListener(){this.invoke=null;this.ids=new TArray;this.check=TLoaderListener_check;return this}function TLoaderListener_check(b){var d=this.ids;if(!d.isEmpty())for(var f=d.length,h=0;h<f;h++)if(!b.contains(d.get(h)))return!1;return!0}
function TLocker(){this._lock=!1;this.enter=TLocker_enter;this.leave=TLocker_leave;return this}function TLocker_enter(){this._lock=!0}function TLocker_leave(){this._lock=!1}function TMessage(){this.typeCd=EMessage.None;this.redirect=this.description=this.message=this.attrType=null;this.loadConfig=TMessage_loadConfig;this.saveConfig=TMessage_saveConfig;this.icon=TMessage_icon;return this}
function TMessage_loadConfig(b){this.typeCd=RString.toLower(b.name);this.message=b.nvl("message");this.attrType=b.nvl("type");this.redirect=b.nvl("redirect");this.description=b.nvl("description").replace(/\\n/g,"\n")}function TMessage_saveConfig(b){b.name=this.typeCd;b.set("message",this.message);b.set("description",this.description)}function TMessage_icon(){return"sys.msg."+this.typeCd}
function TMessages(){this._items=new TObjects;this.hasMessage=TMessages_hasMessage;this.message=TMessages_message;this.messages=TMessages_messages;this.type=TMessages_type;this.push=TMessages_push;return this}function TMessages_hasMessage(b){for(var d=0;d<this._items.count;d++){var f=this._items.get(d);if(f&&f.type==b)return!0}return!1}function TMessages_message(b){for(var d=0;d<this._items.count;d++){var f=this._items.get(d);if(f&&f.type==b)return f}return null}
function TMessages_messages(b){for(var d=null,f=0;f<this._items.count;f++){var h=this._items.get(f);h&&h.type==b&&(d||(d=new TList),d.push(h))}return d}function TMessages_type(){return this.hasMessage(EMessage.Fatal)?EMessage.Fatal:this.hasMessage(EMessage.Error)?EMessage.Error:this.hasMessage(EMessage.Warn)?EMessage.Warn:this.hasMessage(EMessage.Valid)?EMessage.Valid:this.hasMessage(EMessage.Info)?EMessage.Info:EMessage.None}function TMessages_push(b){b&&this._items.push(b)}
function TNode(b){this._name=RString.nvl(b,"Node");this._nodes=this._attributes=this._value=null;this.isName=TNode_isName;this.name=TNode_name;this.setName=TNode_setName;this.value=TNode_value;this.setValue=TNode_setValue;this.contains=TNode_contains;this.hasAttribute=TNode_hasAttribute;this.attributes=TNode_attributes;this.hasNode=TNode_hasNode;this.nodeCount=TNode_nodeCount;this.node=TNode_node;this.nodes=TNode_nodes;this.get=TNode_get;this.getInteger=TNode_getInteger;this.set=TNode_set;this.setNvl=
TNode_setNvl;this.setBoolean=TNode_setBoolean;this.setFloat=TNode_setFloat;this.find=TNode_find;this.findNode=TNode_findNode;this.searchNode=TNode_searchNode;this.push=TNode_push;this.toString=TNode_toString;this.innerDump=TNode_innerDump;this.dump=TNode_dump;return this}function TNode_isName(b){return RString.equals(this._name,b)}function TNode_name(){return this._name}function TNode_setName(b){this._name=b}function TNode_value(){return this._value}function TNode_setValue(b){this._value=b}
function TNode_contains(b){var d=this._attributes;return d?d.contains(b):!1}function TNode_hasAttribute(){var b=this._attributes;return b?!b.isEmpty():!1}function TNode_attributes(){var b=this._attributes;b||(b=this._attributes=new TAttributes);return b}function TNode_hasNode(){var b=this._nodes;return b?!b.isEmpty():!1}function TNode_nodeCount(){var b=this._nodes;return b?b.count():0}function TNode_node(b){var d=this._nodes;return d?d.at(b):null}
function TNode_nodes(){var b=this._nodes;b||(b=this._nodes=new TObjects);return b}function TNode_get(b,d){return this._attributes?this._attributes.get(b,d):null}function TNode_getInteger(b,d){return RInteger.parse(this.get(b,d))}function TNode_set(b,d){null!=d&&this.attributes().set(b,d)}function TNode_setNvl(b,d){RString.isEmpty(d)||this.attributes().set(b,d)}function TNode_setBoolean(b,d){null!=d&&this.attributes().set(b,RBoolean.format(d))}
function TNode_setFloat(b,d){null!=d&&this.attributes().set(b,RFloat.format(d))}function TNode_find(b){if(this.hasNode())for(var d=this._nodes,f=d.count(),h=0;h<f;h++){var q=d.get(h);if(q.isName(b))return q}return null}
function TNode_findNode(b,d){if(this.hasNode()){var f=this._nodes,h=f.count(),q=arguments,z=q.length;if((z-1)%2)throw new TError("Attributes is not pair. (length={1})",z);for(var A=0;A<h;A++){var B=f.get(A);if(null==b||B.isName(b)){for(var C=!0,D=1;D<z;D+=2)if(B.get(q[D])!=q[D+1]){C=!1;break}if(C)return B}}}return null}
function TNode_searchNode(b,d){if(this.hasAttribute()&&this._attributes.get(b)==d)return this;if(this.hasNode())for(var f=this._nodes,h=f.count();0<h;ni++){var q=f.get(q).searchNode(b,d);if(null!=q)return q}return null}function TNode_push(b){this.nodes().push(b)}function TNode_toString(){return this.dump()}
function TNode_innerDump(b,d,f){null==f&&(f="");b.append(f,d._name,"(",RClass.name(d),")");var h=d._attributes;if(h){var q=h.count();b.append(" [",q,":");for(var z=0;z<q;z++)0<z&&b.append(" "),b.append(h.name(z),"=",h.value(z)),z<q-1&&b.append(",");b.append("]")}d._value&&(q=d._value.toString(),RString.isEmpty(q)||b.append(" {",q.length,":",q,"}"));if(d=d._nodes)for(q=d.count(),b.append("\n"),z=0;z<q;z++)d.get(z).dump(b,f+"   "),z<q-1&&b.append("\n");return b}
function TNode_dump(b,d){return this.innerDump(RString.nvlString(b),this,d)}function TRow(){TAttributes.call(this);this._statusCd=this._uniqueId=this._index=this._dataset=null;this.loadConfig=TRow_loadConfig;this.saveConfig=TRow_saveConfig;return this}function TRow_loadConfig(b){this._index=b.get("_id");this._statusCd=b.get("_status");this._uniqueId=b.get("ouid");b.hasAttribute()&&this.append(b.attributes())}
function TRow_saveConfig(b){b.set("_id",this._index);b.set("_status",this._statusCd);for(var d=this.count(),f=0;f<d;f++)b.set(this._names[f],this._values[f])}function TRow_copy(){var b=new TRow;b._dataset=this._dataset;b._index=this._index;b._statusCd=this._statusCd;b._uniqueId=this._uniqueId;for(var d=this.count,f=0;f<d;f++)b.set(this.names[f],this.values[f]);return b}function TRow_toAttributes(b){b||(b=new TAttributes);b.set(RDataset.ROW_STATUS,this._statusCd);b.append(this);return b}
function TRow_dump(b){var d=this.count;b=RString.nvlStr(b);b.append(RClass.name(this)," [",this._statusCd,": ");for(var f=0;f<d;f++)0<f&&b.append(","),b.append(this.names[f],"=",this.values[f]);b.append("]");return b}
function TSpeed(){this.arguments=arguments;this._span=this._end=this._start=0;this._spanMin=Number.MAX_VALUE;this._spanMax=0;this.start=(new Date).getTime();this.callerName=RMethod.name(TSpeed.caller);this.reset=TSpeed_reset;this.begin=TSpeed_begin;this.end=TSpeed_end;this.record=TSpeed_record;this.toString=TSpeed_toString;return this}function TSpeed_reset(){this._span=this._end=this._start=0}function TSpeed_begin(){this._start=(new Date).getTime()}
function TSpeed_end(){this._end=(new Date).getTime();this._span+=this._end-this._start;this._span<this._spanMin&&(this._spanMin=this._span);this._span>this._spanMax&&(this._spanMax=this._span)}function TSpeed_record(){var b=(new Date).getTime()-this.start;RLogger.debug(this,"Speed test. (caller={1}, speed={2}, arguments={3})",this.callerName,b,this.arguments);this.record=this.callerName=this.start=this.arguments=null}
function TSpeed_toString(){return this._span+" ("+this._spanMin+" - "+this._spanMax+")"}
function TUnsupportError(b,d){for(var f="Unsupport method. (name={1})",h=new TString,q=TUnsupportError.caller,z=new TString,A=[];q&&!RArray.contains(A,q);)A.push(q),q=q.caller;for(var B=A.length,C=0;C<B;C++)q=A[C],0<C&&z.appendLine(),z.append("   "+(B-C)+": "+RMethod.name(q));q=arguments;B=q.length;for(C=1;C<B;C++)var A=q[C],D=null,D="function"==typeof A?RMethod.name(A):A,f=f.replace("{"+(C-1)+"}",D);h.appendLine(f);h.appendLine("------------------------------------------------------------");h.append(z);
throw Error(h);}function FConsole(b){b=RClass.inherits(this,b,FObject);b._scopeCd=EScope.Global;b.scopeCd=FConsole_scopeCd;return b}function FConsole_scopeCd(){return this._scopeCd}function FObject(b){b||(b=this);b.__class=null;b.__hash=0;b.__dispose=!1;b.construct=FObject_construct;b.hashCode=FObject_hashCode;b.toString=FObject_toString;b.dispose=FObject_dispose;b.innerDump=FObject_innerDump;b.dump=FObject_dump;return b}function FObject_construct(){this.__dispose=!1}
function FObject_hashCode(){var b=this.__hash;b||(b=this.__hash=RObject.nextId());return b}function FObject_toString(){return RClass.dump(this)}function FObject_dispose(){RObject.free(this);this.__dispose=!0}function FObject_innerDump(b,d){b.append(RClass.dump(this))}function FObject_dump(){var b=new TString;this.innerDump(b,0);return b.flush()}
function FObjectPool(b){b=RClass.inherits(this,b,FObject);b._items=null;b._frees=null;b._allocCount=0;b._freeCount=0;b.construct=FObjectPool_construct;b.hasFree=FObjectPool_hasFree;b.alloc=FObjectPool_alloc;b.free=FObjectPool_free;b.push=FObjectPool_push;b.dispose=FObjectPool_dispose;b.innerDump=FObjectPool_innerDump;return b}function FObjectPool_construct(){this.__base.FObject.construct.call(this);this._items=new TObjects;this._frees=new TObjects}
function FObjectPool_hasFree(){return!this._frees.isEmpty()}function FObjectPool_alloc(){var b=null;this._frees.isEmpty()||(b=this._frees.pop());this._allocCount++;return b}function FObjectPool_free(b){this._frees.push(b);this._freeCount++}function FObjectPool_push(b){this._items.push(b);this._frees.push(b)}function FObjectPool_dispose(){this._items=RObject.dispose(this._items);this._frees=RObject.dispose(this._frees);this.__base.FObject.dispose.call(this)}
function FObjectPool_innerDump(b,d){b.append("Pool:");b.append("total=",this._items.count());b.append(", free=",this._frees.count());b.append(", alloc_count=",this._allocCount);b.append(", free_count=",this._freeCount)}function FObjectPools(b){b=RClass.inherits(this,b,FObject);b._pools=null;b.construct=FObjectPools_construct;b.pool=FObjectPools_pool;b.alloc=FObjectPools_alloc;b.free=FObjectPools_free;b.dispose=FObjectPools_dispose;return b}
function FObjectPools_construct(){this.__base.FObject.construct.call(this);this._pools=new TDictionary}function FObjectPools_pool(b){var d=this._pools.get(b);d||(d=RClass.create(FObjectPool),this._pools.set(b,d));return d}function FObjectPools_alloc(b){return this.pool(b).alloc()}function FObjectPools_free(b,d){return this.pool(b).free(d)}function FObjectPools_push(b,d){return this.pool(b).push(d)}
function FObjectPools_dispose(){for(var b=this._pools,d=b.count(),f=0;f<d;f++)b.valueAt(f).dispose();b.dispose();this.__base.FObject.dispose.call(this)}function FTimer(b){b=RClass.inherits(this,b,FObject);b._count=0;b._startTime=0;b._beginTime=0;b._endTime=0;b._stopTime=0;b._span=0;b._spanSecond=0;b.setup=FTimer_setup;b.current=FTimer_current;b.span=FTimer_span;b.spanSecond=FTimer_spanSecond;b.rate=FTimer_rate;b.update=FTimer_update;return b}
function FTimer_setup(){var b=(new Date).getTime();this._endTime=this._beginTime=this._startTime=b}function FTimer_current(){return this._lastTime}function FTimer_span(){return this._span}function FTimer_spanSecond(){return this._spanSecond}function FTimer_rate(){return 0==this._count?0:parseInt(1E3*this._count/(this._lastTime-this._startTime))}function FTimer_update(){this._count++;var b=this._beginTime=this._endTime;this._spanSecond=(this._span=(this._endTime=(new Date).getTime())-b)/1E3}
var RArray=new function(){this.array1=Array(1);this.array2=Array(2);this.array3=Array(3);this.array4=Array(4);this.array9=Array(9);this.array12=Array(12);this.array16=Array(16);this.equals=RArray_equals;this.count=RArray_count;this.contains=RArray_contains;this.find=RArray_find;this.search=RArray_search;this.reverse=RArray_reverse;this.copy=RArray_copy;this.move=RArray_move;this.remove=RArray_remove;this.sortPartition=RArray_sortPartition;this.sortArray=RArray_sortArray;this.sort=RArray_sort;this.nameMaxLength=
RArray_nameMaxLength;return this};function RArray_equals(b,d){if(b&&d&&b.length==d.length){for(var f=b.length,h=0;h<f;h++)if(b[h]!=d[h])return!1;return!0}return!1}function RArray_count(b){for(var d in b)d++;return 0}function RArray_contains(b,d){for(var f=b.length,h=0;h<f;h++)if(b[h]==d)return!0;return!1}function RArray_find(b,d){for(var f=b.length,h=0;h<f;h++)if(b[h]==d)return h;return-1}function RArray_search(b,d){for(var f in b)if(b[f]==d)return f;return null}
function RArray_reverse(b,d,f){for(var h=f+1-d>>1,q=0;q<h;q++){var z=b[d+q];b[d+q]=b[f-q];b[f-q]=z}}function RArray_copy(b,d){for(var f in b)d[f]=b[f]}function RArray_move(b,d,f,h){if(d>h)for(var q=0;q<f;q++)b[h-q]=b[d+q];else if(d<h)for(q=0;q<f;q++)b[h+f-q-1]=b[d+f-q-1]}function RArray_remove(b,d){return b.slice(0,d).concat(b.slice(d+1))}
function RArray_sortPartition(b,d,f){var h=d;f+=1;for(var q=b[h];;){for(;b[++h]<q;);for(;b[--f]>q;);if(h>f)break;var z=b[h];b[h]=b[f];b[f]=z}b[d]=b[f];b[f]=q;return f}function RArray_sortArray(b,d,f){if(d<f){var h=this.sortPartition(b,d,f);this.sortArray(b,d,h-1);this.sortArray(b,h+1,f)}}function RArray_sort(b,d){var f=b.length-1;this.sortArray(b,0,f);d&&this.reverse(b,0,f);return b}function RArray_nameMaxLength(b){for(var d in b)b=d.length,b>d&&(d=b);return 0}
var RAssert=new function(){this.isTrue=RAssert_isTrue;this.isFalse=RAssert_isFalse;this.debugEnd=this.debug=this.debugBegin=RAssert_empty;this.debugTrue=RAssert_isTrue;this.debugFalse=RAssert_isFalse;return this};function RAssert_empty(){}function RAssert_isTrue(b){if(!b)throw new TError(b,"Assert failure.");}function RAssert_isFalse(b){if(p)throw new TError(p,"Assert failure.");}var RBoolean=new function(){this.format=RBoolean_format;this.parse=RBoolean_parse;this.toString=RBoolean_toString;return this};
function RBoolean_format(b){return b?EBoolean.True:EBoolean.False}function RBoolean_parse(b){if(null!=b){if(b.constructor==Boolean)return b;if(b.constructor==String)return b==EBoolean.True;if(b.constructor==Number)return 0<b;throw new TError(this,"Unknown type.");}return!1}function RBoolean_toString(b,d,f){null==d&&(d=EBoolean.True);null==f&&(f=EBoolean.False);return b?d:f}var RByte=new function(){this.copy=RByte_copy;return this};function RByte_copy(b,d,f,h,q){for(var z=0;z<q;z++)b[d++]=f[h++]}
var RChar=new function(){this.parse=RChar_parse;this.toString=RChar_toString;return this};function RChar_parse(b){return String.fromCharCode(b)}function RChar_toString(b){return b}
var RClass=new function(){this.codes=[];this.classes={};this.isBase=RClass_isBase;this.isBaseName=RClass_isBaseName;this.isBaseDataName=RClass_isBaseDataName;this.isBaseType=RClass_isBaseType;this.isBaseDataType=RClass_isBaseDataType;this.isName=RClass_isName;this.isClass=RClass_isClass;this.typeOf=RClass_typeOf;this.safeTypeOf=RClass_safeTypeOf;this.checkClass=RClass_checkClass;this.code=RClass_code;this.name=RClass_name;this.inherits=RClass_inherits;this.forName=RClass_forName;this.find=RClass_find;
this.register=RClass_register;this.createBase=RClass_createBase;this.createClass=RClass_createClass;this.create=RClass_create;this.createByName=RClass_createByName;this.innerCopy=RClass_innerCopy;this.build=RClass_build;this.free=RClass_free;this.dump=RClass_dump;return this};function RClass_isBase(b){return null!=b?RClass.isBaseName(typeof b):!1}function RClass_isBaseName(b){return null==b||"boolean"!=b&&"number"!=b&&"date"!=b&&"string"!=b&&"function"!=b?!1:!0}
function RClass_isBaseDataName(b){return null==b||"boolean"!=b&&"number"!=b&&"date"!=b&&"string"!=b?!1:!0}function RClass_isBaseType(b){return null==b||b!=Boolean&&b!=Number&&b!=Date&&b!=String&&b!=Function?!1:!0}function RClass_isBaseDataType(b){return null==b||b!=Boolean&&b!=Number&&b!=Date&&b!=String?!1:!0}function RClass_isName(b,d){return this.name(b)==d}function RClass_isClass(b,d){if(b&&d){var f=this.name(d);return b.__base?null!=b.__base[f]:this.name(b)==f}return!1}
function RClass_typeOf(b){return b&&b.constructor?RString.mid(b.constructor.toString(),"function ","("):"Null"}function RClass_safeTypeOf(b,d){if(null==b)return"Null";try{var f=b.constructor;if(f==Boolean)return"Boolean";if(f==Number)return"Number";if(f==String)return"String";if(f==Function||f.constructor==Function)return RString.mid(f.toString(),"function ","(");if(b.__class)return b.__class.name;if(b.tagName)return"Html";for(var h in b)return"Object"}catch(q){}return"Unknown"}
function RClass_checkClass(b,d){if(!this.isClass(b,d))throw Error("Invalid class "+o.name(o)+"<>"+o.name(d));}function RClass_code(b){for(var d=this.codes,f=d.length,h=0;h<f;h++)if(d[h]==b)return h;d[f]=b;return f}function RClass_name(b){if(b){if(b.__name)return b.__name;if(b.__class)return b.__class.name;if("function"==typeof b)return RMethod.name(b);if(b=b.constructor)return RString.mid(b.toString(),"function ","(")}return null}
function RClass_inherits(b,d){var f=RRuntime.nvl(d,b);f.__inherits=[];for(var h=arguments,q=h.length,z=2;z<q;z++)f.__inherits.push(RMethod.name(h[z]));return f}function RClass_forName(b){var d=null;null!=b&&(d=this.classes[b],d||(d=this.createClass(b),this.build(d)));return d}function RClass_find(b){var d=null;null!=b&&(b.__class?d=b.__class.name:b.constructor==Function?d=RMethod.name(b):b.constructor!=String&&RLogger.fatal(this,null,"Find class failure. (value={1})",b));return this.classes[d]}
function RClass_register(b,d,f){b=RMethod.name(b.constructor);this.classes[b].register(d);b=d.value();return null!=b?b:f}function RClass_createBase(b){return b?eval("function "+b+"(){return this;} new "+b+"();"):null}function RClass_createClass(b){var d=this.classes[b]=new TClass;d.name=b;d.base=this.createBase(b);d.clazz=new d.base.constructor;eval(b)(d.clazz);return d}
function RClass_create(b){var d=typeof b;"function"==d?b=RMethod.name(b):"string"!=d&&RLogger.fatal(this,null,"Param is invlid (name={1})",b);return this.createByName(b)}function RClass_createByName(b){(b=this.forName(b))||RLogger.fatal(this,null,"Cant find class. (name={1})",b);return b.newInstance()}
function RClass_innerCopy(b,d){if(null!=b&&null!=d)for(var f in b){var h=b[f];if(null!=h){var q=typeof h;if("function"==q){q=d[f];null==q?d[f]=h:RMethod.isVirtual(q)?d[f]=h:!RMethod.isVirtual(h)&&RMethod.isEmpty(q)?d[f]=h:RMethod.isVirtual(h)||RMethod.isEmpty(h)||(d[f]=h);continue}else if(!RClass.isBaseName(q)){null==d[f]&&(d[f]=new h.constructor);this.innerCopy(h,d[f]);continue}}d[f]=h}}
function RClass_build(b){var d=b.clazz.__inherits;if(d&&d.constructor==Array)for(var f=!1,h=d.length,q=0;q<h;q++){var z=d[q];RString.startsWith(z,"F")&&(f&&RLogger.fatal(this,null,"Parent class is too many. (name={1})",z),b.parent=RClass.forName(z),f=!0)}f=b.instance=new b.base.constructor;if(d&&d.constructor==Array)for(h=d.length,q=0;q<h;q++)if(z=d[q],!RString.startsWith(z,"F")){var A=RClass.forName(z);null==A&&RLogger.fatal(this,null,"Parent class is not exists. (name={1})",z);RClass.innerCopy(A.instance,
f);b.assign(A)}b.parent&&(this.innerCopy(b.parent.instance,f),b.assign(b.parent));f.__base||(f.__base=new TClassBase);f.__base[b.name]=new b.base.constructor;var A=b.clazz,B;for(B in A)"__base"!=B&&(null==A[B]&&null==f[B]?f[B]=null:null!=A[B]&&(null==f[B]||null!=f[B]&&A[B]!=f[B])&&(f[B]=A[B]));if(d&&d.constructor==Array)for(h=d.length,q=0;q<h;q++)for(B in z=d[q],A=RClass.forName(z),z=f.__base[z]=new A.base.constructor,A=A.instance,A)if("__base"!=B){var C=A[B],D=f[B];null!=C&&null!=D&&C!=D&&C.constructor==
Function&&D.constructor==Function&&(z[B]=A[B])}b.build();if(RRuntime.isRelease())for(B in b.instance)null==b.instance[B]&&delete b.instance[B]}function RClass_free(b){var d=b.__class;d&&d.free(b)}
function RClass_dump(b){if(null==b)return"@null";var d=this.safeTypeOf(b);switch(d){case "Boolean":return"Boolean:"+b;case "Number":return"Number:"+b;case "String":return d+"<"+b.length+">:"+b;case "Function":return d+"<"+RMethod.name(b)+">@"+this.code(b);case "Html":return d+"<"+b.tagName+">@"+this.code(b);default:if(b.__name)return d+"<"+b.__name+">@"+this.code(b)}return d+"@"+this.code(b)}
var RConsole=new function(){this.ConsolePreFix="console:";this._registers=new TObjects;this._consoles=new TDictionary;this._localConsoles=new TDictionary;this.initialize=RConsole_initialize;this.register=RConsole_register;this.create=RConsole_create;this.createByName=RConsole_createByName;this.get=RConsole_get;this.find=RConsole_find;this.release=RConsole_release;return this};function RConsole_initialize(){for(var b=this._registers,d=0;d<b;d++){var f=b.get(d);f.force&&this.find(f.clazz)}}
function RConsole_register(b){this._registers.push(b)}function RConsole_create(b){var d=null;if(b){var d=RClass.create(b),f;for(f in d)if(RString.startsWith(f,"lnk")){var h=d[f];if("string"==typeof h&&RString.startsWith(h,"&")){var q=this.find(h.substr(1));if(!q)return RMessage.fatal(this,null,"Can't link console. (name={0}, property={1}:{2})",b,f,h);d[f]=q}}}return d}
function RConsole_createByName(b){var d=null;if(b){var d=RClass.createByName(b),f;for(f in d)if(RString.startsWith(f,"lnk")){var h=d[f];if("string"==typeof h&&RString.startsWith(h,"&")){var q=this.find(h.substr(1));if(!q)return RMessage.fatal(this,null,"Can't link console. (name={0}, property={1}:{2})",b,f,h);d[f]=q}}}return d}function RConsole_get(b){b=RClass.name(b);return this._consoles.get(b)}
function RConsole_find(b){var d=null;if(b.constructor=String)d=RClass.name(b);else if(b.constructor==Function)d=b;else return RLogger.fatal(this,null,"Parameter type is invalid. (console={1})",b);if((b=RGlobal.get(this.ConsolePreFix+d))||(b=this._consoles.get(d)))return b;var f=RClass.forName(d).instance.scopeCd();switch(f){case EScope.Global:b=top.RConsole.createByName(d);RGlobal.set(this.ConsolePreFix+d,b);this._consoles.set(d,b);break;case EScope.Local:b=this.createByName(d);this._localConsoles.set(d,
b);this._consoles.set(d,b);break;default:return RLogger.fatal(this,"Unknown scope code. (name={1})",d)}RLogger.info(this,"Create console. (name={1}, scope={2})",d,REnum.decode(EScope,f));return b}function RConsole_release(){this._registers&&(this._registers.dispose(),this._registers=null);var b=this._localConsoles;if(b){for(var d=b.count(),f=0;f<d;f++)b.value(f).dispose();b.dispose()}this._localConsoles=null;this._consoles&&this._consoles.dispose();this._consoles=null}
var RConst=new function(){this.PI_2=Math.PI/2;this.PI=Math.PI;this.PI2=2*Math.PI;this.RADIAN_RATE=180/Math.PI;this.DEGREE_RATE=Math.PI/180;this.PERCENT_10=.1;this.PERCENT_100=.01;this.PERCENT_1000=.001;this.identity3x3=[1,0,0,0,1,0,0,0,1];this.identity4x4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return this},RDate=new function(){this.MinYear=1800;this.MaxYear=2400;this.Pattern="n-: /";this.Chars="0123456789-:/";this.DisplayFormat="yyyy-mm-dd hh24:mi:ss";this.DataFormat="yyyymmddhh24miss";this.MonthDays=
[0,31,28,31,30,31,30,31,31,30,31,30,31];this.DaySeconds=1E3;this.Parts="YYYY MM DD HH24 MI SS".split(" ");this.PartsDefine={YYYY:["Year",4],MM:["Month",2],DD:["Day",2],HH24:["Hour",2],MI:["Minute",2],SS:["Second",2]};this.nvl=RDate_nvl;this.make=RDate_make;this.format=RDate_format;this.formatDate=RDate_formatDate;this.formatText=RDate_formatText;this.monthDays=RDate_monthDays;this.splitFormat=RDate_splitFormat;this.makeDate=RDate_makeDate;this.checkItems=RDate_checkItems;this.check=RDate_check;this.parse=
RDate_parse;this.splitDate=RDate_splitDate;this.splitTime=RDate_splitTime;this.autoParse=RDate_autoParse;this.getFormat=RDate_getFormat;return this};function RDate_nvl(b){return b?b:new TDate}function RDate_make(b,d,f,h,q,z){return new TDate(new Date(b,d,f))}function RDate_format(b){return this.formatDate(new TDate,b)}
function RDate_formatText(b,d){if(!b)return!1;d=d.toLowerCase();d=d.replace(/yyyy/g,b.substring(0,4));b=b.substring(4);d=d.replace(/mm/g,b.substring(0,2));b=b.substring(2);d=d.replace(/dd/g,b.substring(0,2));b=b.substring(2);d=d.replace(/hh24/g,b.substring(0,4));b=b.substring(4);d=d.replace(/mi/g,b.substring(0,2));b=b.substring(2);d=d.replace(/ss/g,b.substring(0,2));b.substring(2);return d}
function RDate_formatDate(b,d){if(!b)return"";d=d?d.toLowerCase():this.DataFormat;d=d.replace(/yyyy/g,RInteger.format(b.year,4));d=d.replace(/yy/g,RInteger.format(b.year%100,2));d=d.replace(/mm/g,RInteger.format(b.month,2));d=d.replace(/dd/g,RInteger.format(b.day,2));d=d.replace(/hh24/g,RInteger.format(b.hour,2));d=d.replace(/mi/g,RInteger.format(b.minute,2));d=d.replace(/ss/g,RInteger.format(b.second,2));return d=d.replace(/ms/g,RInteger.format(b.ms,3))}
function RDate_monthDays(b,d){if(!b||!d)return 0;b=parseInt(b);d=parseInt(d);this.MonthDays[2]=0!=b%4&&0!=b%400||0==b%100?28:29;return this.MonthDays[d]}
function RDate_splitFormat(b,d){if(!b)return!1;d=d.toLowerCase();for(var f=[];0<d.length;)0==d.indexOf("yyyy")?(f.year=b.substring(0,4),d=d.substring(4),b=b.substring(4)):0==d.indexOf("mm")?(f.month=b.substring(0,2),d=d.substring(2),b=b.substring(2)):0==d.indexOf("dd")?(f.day=b.substring(0,2),d=d.substring(2),b=b.substring(2)):0==d.indexOf("hh24")?(f.hour=b.substring(0,2),d=d.substring(4),b=b.substring(2)):0==d.indexOf("mi")?(f.minute=b.substring(0,2),d=d.substring(2),b=b.substring(2)):0==d.indexOf("ss")?
(f.second=b.substring(0,2),d=d.substring(2),b=b.substring(2)):0==d.indexOf("ms")?(f.ms=b.substring(0,2),d=d.substring(2),b=b.substring(3)):(d=d.substring(1),b=b.substring(1));return f}
function RDate_checkItems(b){if(!b)return!1;var d=RInteger.parse(b.year);if(d<this.MinYear||d>this.MaxYear)return!1;var f=RInteger.parse(b.month);if(1>f||12<f)return!1;var h=RInteger.parse(b.day);if(1>h||h>this.monthDays(d,f))return!1;d=RInteger.parse(b.hour);if(0>d||23<d)return!1;d=RInteger.parse(b.second);if(0>d||59<d)return!1;b=RInteger.parse(b.ms);return 0>b||99<b?!1:!0}function RDate_check(b,d){return this.checkItems(this.splitFormat(b,d))}
function RDate_makeDate(b,d){var f=new Date(RInteger.parse(d.year),RInteger.parse(d.month)-1,RInteger.parse(d.day),RInteger.parse(d.hour),RInteger.parse(d.minute),RInteger.parse(d.second),RInteger.parse(d.ms));return b?(b.setDate(f),b):new TDate(f)}function RDate_parse(b,d,f){f||(f=this.DataFormat);d=this.splitFormat(d,f);return this.checkItems(d)?this.makeDate(b,d):null}
function RDate_splitDate(b,d){if(d){var f=null;-1!=d.indexOf("-")||-1!=d.indexOf("/")?(-1!=d.indexOf("-")?f=d.split("-"):-1!=d.indexOf("/")&&(f=d.split("/")),1<=f.length&&(b.year=RInteger.parse(f[0])),2<=f.length&&(b.month=RInteger.parse(f[1])),3<=f.length&&(b.day=RInteger.parse(f[2]))):-1!=d.indexOf(":")?this.splitTime(b,d):14==d.length?(b.year=RInteger.parse(d.substr(0,4)),b.month=RInteger.parse(d.substr(4,2)),b.day=RInteger.parse(d.substr(6,2)),b.hour=RInteger.parse(d.substr(8,2)),b.minute=RInteger.parse(d.substr(10,
2)),b.second=RInteger.parse(d.substr(12,2))):8==d.length?(b.year=RInteger.parse(d.substr(0,4)),b.month=RInteger.parse(d.substr(4,2)),b.day=RInteger.parse(d.substr(6,2))):6==d.length?(b.year=RInteger.parse(d.substr(0,4)),b.month=RInteger.parse(d.substr(4,2))):4==d.length&&(b.year=RInteger.parse(d))}}
function RDate_splitTime(b,d){if(d)if(-1!=d.indexOf(":")){var f=d.split(":");1<=f.length&&(b.hour=RInteger.parse(f[0]));2<=f.length&&(b.minute=RInteger.parse(f[1]));3<=f.length&&(b.second=RInteger.parse(f[2]))}else 6==d.length?(b.hour=RInteger.parse(d.substr(0,2)),b.minute=RInteger.parse(d.substr(2,2)),b.second=RInteger.parse(d.substr(4,2))):4==d.length?(b.hour=RInteger.parse(d.substr(0,2)),b.minute=RInteger.parse(d.substr(2,2))):2==d.length&&(b.hour=RInteger.parse(d.substr(0,2)))}
function RDate_autoParse(b,d){if(!d)return null;b=this.nvl(b);var f=[];f.year=2E3;f.month=1;f.day=1;f.hour=0;f.minute=0;f.second=0;d=RString.trim(d);if(-1==d.indexOf(" "))this.splitDate(f,d);else{var h=d.split(" ");2==h.length&&(this.splitDate(f,h[0]),this.splitTime(f,h[1]))}return this.checkItems(f)?this.makeDate(b,f):null}
function RDate_getFormat(b){var d="",f="";if(b){if(-1!=b.indexOf(":"))if(b=RString.split(b," "),1==b.length)b=RString.split(b[0],":"),1==b.length?(d+="HH24",f=1==b[0].length?f+("0"+b[0]):f+b[0]):2==b.length?(d+="HH24MI",1==b[0].length?f+="0"+b[0]:2==b[0].length&&(f+=b[0]),1==b[1].length?f+="0"+b[1]:2==b[1].length&&(f+=b[1])):3==b.length&&(d+="HH24MISS",1==b[0].length?f+="0"+b[0]:2==b[0].length&&(f+=b[0]),1==b[1].length?f+="0"+b[1]:2==b[1].length&&(f+=b[1]),1==b[2].length?f+="0"+b[2]:2==b[2].length&&
(f+=b[2]));else{if(2==b.length){var h=RString.split(b[0],"-");3==h.length?(d+="YYYYMMDD",4==h[0].length&&(f+=h[0]),1==h[1].length?f+="0"+h[1]:2==h[1].length&&(f+=h[1]),1==h[2].length?f+="0"+h[2]:2==h[2].length&&(f+=h[2])):2==h.length?(d+="YYYYMM",1==h[0].length&&(f+=h[0]),1==h[1].length?f+="0"+h[1]:2==h[1].length&&(f+=h[1])):1==h.length&&(d+="YYYY",4==h[0].length&&(f+=h[0]));b=RString.split(b[1],":");1==b.length?(d+="HH24",f=1==b[0].length?f+("0"+b[0]):f+b[0]):2==b.length?(d+="HH24MI",1==b[0].length?
f+="0"+b[0]:2==b[0].length&&(f+=b[0]),1==b[1].length?f+="0"+b[1]:2==b[1].length&&(f+=b[1])):3==b.length&&(d+=" HH24MISS",1==b[0].length?f+="0"+b[0]:2==b[0].length&&(f+=b[0]),1==b[1].length?f+="0"+b[1]:2==b[1].length&&(f+=b[1]),1==b[2].length?f+="0"+b[2]:2==b[2].length&&(f+=b[2]))}}else b=RString.split(b,"-"),3==b.length?(d+="YYYYMMDD",4==b[0].length&&(f+=b[0]),1==b[1].length?f+="0"+b[1]:2==b[1].length&&(f+=b[1]),1==b[2].length?f+="0"+b[2]:2==b[2].length&&(f+=b[2])):2==b.length?(d="YYYYMM",4==b[0].length&&
(f+=b[0]),1==b[1].length?f+="0"+b[1]:2==b[1].length&&(f+=b[1])):1==b.length&&(d+="YYYY",4==b[0].length&&(f+=b[0]));b=Array(2);b[0]=d;b[1]=f;return b}}var REnum=new function(){this.contains=REnum_contains;this.tryEncode=REnum_tryEncode;this.encode=REnum_encode;this.tryDecode=REnum_tryDecode;this.decode=REnum_decode;this.parse=REnum_encode;this.format=REnum_decode;return this};function REnum_contains(){}
function REnum_tryEncode(b,d,f){if(null!=b)for(var h in b)if(h.toLowerCase()==d.toLowerCase())return b[h];return f}function REnum_encode(b,d){var f=this.tryEncode(b,d);if(null==f)throw new TError(this,"Invalid value (enum={1}, value={2})",RClass.dump(b),d);return f}function REnum_tryDecode(b,d,f){if(null!=b)for(var h in b)if(b[h]==d)return h;return f}
function REnum_decode(b,d){var f=this.tryDecode(b,d);if(null==f)throw new TError(this,"Invalid value (enum={1}, value={2})",RClass.dump(b),d);return f}var RFile=new function(){this.pictures=["jpg","png","gif","bmp"];this.knowns="jpg png gif bmp doc docx vsd xls xlsx".split(" ");this.inPicture=RFile_inPicture;this.isPicture=RFile_isPicture;this.isKnown=RFile_isKnown;this.name=RFile_name;this.extension=RFile_extension;return this};
function RFile_inPicture(b){if(b){b=b.toLowerCase();for(var d in this.pictures)if(this.pictures[d]==b)return!0}}function RFile_isPicture(b){return this.inPicture(this.extension(b))}function RFile_isKnown(b){b=this.extension(b).toLowerCase();for(var d in this.knowns)if(this.knowns[d]==b)return!0;return!1}function RFile_name(b){if(b){b=b.replace(/\\/g,"/");var d=b.lastIndexOf("/");-1!=d&&(b=b.substring(d+1));d=b.lastIndexOf(".");return-1!=d?b.substring(0,d):b}return""}
function RFile_extension(b){if(b){b=b.replace(/\\/g,"/");var d=b.lastIndexOf("/");-1!=d&&(b=b.substring(d+1));d=b.lastIndexOf(".");return-1!=d?b.substring(d+1):b}return""}
var RFloat=new function(){this.NUMBER=this.Chars="0123456789-.%";this.LEFT_CHAR="0";this.isFloat=RFloat_isFloat;this.parse=RFloat_parse;this.format=RFloat_format;this.nvl=RFloat_nvl;this.toRange=RFloat_toRange;this.sum=RFloat_sum;this.calculate=RFloat_calculate;this.attach=RFloat_attach;this.fill=RFloat_fill;this.copy=RFloat_copy;return this};function RFloat_isFloat(b){return RString.isPattern(b,"n")}
function RFloat_parse(b){if(null==b||""==b)return 0;b=RString.trim(b.toString());if(null==b)return 0;for(;"0"==b.charAt(0);)b=b.substr(1);b=0<b.length?parseFloat(b):0;-1!=RString.findChars(b,"%")&&(b/=100);return isNaN(b)?0:b}
function RFloat_format(b,d,f,h,q){null==d&&(d=0);null==f&&(f=this.LEFT_CHAR);null==h&&(h=6);null==q&&(q=this.LEFT_CHAR);var z=b.toString(),A=z.indexOf(".");-1==A?(b=z,z=""):(b=z.substring(0,A),z=z.substring(A+1,A+h+1));d=RString.lpad(b,d,f);h=RString.rpad(z,h,q);return d+"."+h}function RFloat_nvl(b,d){return b?b:d?d:0}function RFloat_toRange(b,d,f){null==b&&(b=0);return Math.min(Math.max(b,d),f)}
function RFloat_sum(){for(var b=arguments,d=0,f=b.length-1;0<=f;f--){var h=b[n];null!=h&&(d+=parseFloat(h))}return d}function RFloat_calculate(b,d,f){d=RFloat.nvl(d);f=RFloat.nvl(f);d=parseFloat(d);f=parseFloat(f);return b?(d+f).toString():(d-f).toString()}function RFloat_attach(b,d,f){for(var h=!1,q=0;q<f;q++)b[q]!=d[q]&&(b[q]=d[q],h=!0);return h}function RFloat_fill(b,d,f,h){for(var q=0;q<f;q++)b[d++]=h}function RFloat_copy(b,d,f,h,q){for(var z=0;z<q;z++)b[d++]=f[h++]}
var RHex=new function(){this.NUMBER="0x123456789ABCDEF";this.PAD="0";this.isValid=RHex_isValid;this.parse=RHex_parse;this.format=RHex_format;return this};function RHex_isValid(b){return RString.isPattern(b,this.NUMBER)}function RHex_parse(b){return b?parseInt("0x"+b):"0"}function RHex_format(b,d){var f=null,f=b?b.toString(16):"0";return d?RString.lpad(f,d,this.PAD):f}
var RInstance=new function(){this._pools=new TDictionary;this.pool=RInstance_pool;this.get=RInstance_get;this.alloc=RInstance_alloc;this.free=RInstance_free;return this};function RInstance_pool(b){b=RClass.name(b);var d=this._pools.get(b);null==d&&(d=new TInstancePool,this._pools.set(b,d));return d}function RInstance_get(b){return this.pool(b).instance(b)}function RInstance_alloc(b){return this.pool(p).alloc(p)}function RInstance_free(b){this.pool(p).free(p)}
var RInteger=new function(){this.NUMBER=this.Chars="0123456789-%";this.LEFT_CHAR="0";this.MAX_UINT16=65535;this.MAX_UINT32=4294967295;this.isInteger=this.isInt=RInteger_isInt;this.nvl=RInteger_nvl;this.strideByte=RInteger_strideByte;this.strideBit=RInteger_strideBit;this.parse=RInteger_parse;this.format=RInteger_format;this.toRange=RInteger_toRange;this.pow2=RInteger_pow2;this.sum=RInteger_sum;this.calculate=RInteger_calculate;this.copy=RInteger_copy;this.toString=RInteger_toString;return this};
function RInteger_isInt(b){return RString.isPattern(b,"n")}function RInteger_nvl(b,d){return b?b:d?d:0}function RInteger_strideByte(b){return 65535<b?4:255<b?2:1}function RInteger_strideBit(b){return 65535<b?32:255<b?16:8}function RInteger_parse(b,d){null==d&&(d=0);if(null==b||""==b)return d;for(b=RString.trim(b.toString());"0"==b.charAt(0);)b=b.substr(1);var f=0<b.length?parseInt(b):d;return isNaN(f)?d:f}
function RInteger_format(b,d,f){f||(f=this.LEFT_CHAR);b=b.toString();for(d=parseInt(d)-b.length-1;0<=d;d--)b=f+b;return b}function RInteger_toRange(b,d,f){null==b&&(b=0);isNaN(b)&&(b=0);b<d&&(b=d);b>f&&(b=f);return b}function RInteger_pow2(b){return 4096<b?8192:2048<b?4096:1024<b?2048:512<b?1024:256<b?512:128<b?256:64<b?128:32<b?64:16<b?32:8<b?16:4<b?8:2<b?4:1<b?2:1}function RInteger_sum(){for(var b=0,d=arguments,f=d.length,h=0;h<f;h++)null!=d[h]&&(b+=parseInt(d[h]));return b}
function RInteger_calculate(b,d,f){d=RInteger.parse(d);f=RInteger.parse(f);var h="";"+"==b?h=d+f:"-"==b?h=d-f:"x"==b?h=d*f:"/"==b&&(h=d/f);return h.toString()}function RInteger_copy(b,d,f,h,q){for(var z=0;z<q;z++)b[d++]=f[h++]}function RInteger_toString(b){return null==b?"0":b.toString()}var RJson=new function(){this.parse=RJson_parse;this.toString=RJson_toString;return this};function RJson_parse(b,d){var f=null;try{f=JSON.parse(b)}catch(h){d&&(f=new d)}return f}
function RJson_toString(b){return JSON.stringify(b)}var RLogger=new function(){this._statusError=!1;this._labelLength=40;this.lsnsOutput=new TListeners;this.output=RLogger_output;this.debug=RLogger_debug;this.info=RLogger_info;this.warn=RLogger_warn;this.error=RLogger_error;this.fatal=RLogger_fatal;return this};function RLogger_output(b,d){this.lsnsOutput.process(b,d)}
function RLogger_debug(b,d,f){var h=RMethod.name(RLogger_debug.caller),h=h.replace("_","."),q=new TString;q.append(RDate.format("yymmdd-hh24miss.ms"));q.append("|D ["+RString.rpad(h,this._labelLength)+"] ");for(var z=arguments,A=z.length,h=2;h<A;h++){var B=z[h],C="";null!=B&&(C="function"==typeof B?RMethod.name(B):B.toString());d=d.replace("{"+(h-1)+"}",C)}q.append(d);this.output(b,q.flush())}
function RLogger_info(b,d,f){var h=RMethod.name(RLogger_info.caller),h=h.replace("_","."),q=new TString;q.append(RDate.format("yymmdd-hh24miss.ms"));q.append("|I ["+RString.rpad(h,this._labelLength)+"] ");for(var z=arguments,A=z.length,h=2;h<A;h++){var B=z[h],C="";null!=B&&(C="function"==typeof B?RMethod.name(B):B.toString());d=d.replace("{"+(h-1)+"}",C)}q.append(d);this.output(b,q.flush())}
function RLogger_warn(b,d,f){var h=RMethod.name(RLogger_warn.caller),h=h.replace("_","."),q=new TString;q.append(RDate.format("yymmdd-hh24miss.ms"));q.append("|W ["+RString.rpad(h,this._labelLength)+"] ");for(var z=arguments,A=z.length,h=2;h<A;h++){var B=z[h],C="";null!=B&&(C="function"==typeof B?RMethod.name(B):B.toString());d=d.replace("{"+(h-1)+"}",C)}q.append(d);this.output(b,q.flush())}
function RLogger_error(b,d,f){var h=RMethod.name(RLogger_error.caller),h=h.replace("_","."),q=new TString;q.append(RDate.format("yymmdd-hh24miss.ms"));q.append("|E ["+RString.rpad(h,this._labelLength)+"] ");for(var z=arguments,A=z.length,h=2;h<A;h++){var B=z[h],C="";null!=B&&(C="function"==typeof B?RMethod.name(B):B.toString());d=d.replace("{"+(h-1)+"}",C)}q.append(d);this.output(b,q.flush())}
function RLogger_fatal(b,d,f,h){if(!this._statusError){this._statusError=!0;for(var q=new TString,z=[],A=RLogger_fatal.caller;A&&!RArray.contains(z,A);)z.push(A),A=A.caller;for(var B=z.length,C=0;C<B;C++)A=z[C],0<C&&q.appendLine(),q.append("   "+(B-C)+": "+RMethod.name(A));z=new TString;z.appendLine(RContext.get("RMessage:fatal"));z.appendLine(RString.repeat("-",60));z.append(RClass.dump(b),": ");if(f)for(A=arguments,B=A.length,C=3;C<B;C++){var D=A[C];"function"==typeof D&&(D=RMethod.name(D));f=f.replace("{"+
(C-2)+"}",D)}z.appendLine(f);z.appendLine(RString.repeat("-",60));z.appendLine("Stack:");z.append(q);throw Error(z.toString());}}
var RMethod=new function(){this._virtuals={};this.isFunction=RMethod_isFunction;this.isEmpty=RMethod_isEmpty;this.isVirtual=RMethod_isVirtual;this.name=RMethod_name;this.fullName=RMethod_fullName;this.empty=RMethod_empty;this.emptyTrue=RMethod_emptyTrue;this.emptyFalse=RMethod_emptyFalse;this.emptyCall=RMethod_emptyCall;this.virtual=RMethod_virtual;this.empty.__empty=!0;this.emptyTrue.__empty=!0;this.emptyFalse.__empty=!0;return this};function RMethod_isFunction(b){return"function"==typeof b}
function RMethod_isEmpty(b){return b&&b.__empty}function RMethod_isVirtual(b){return b&&b.__virtual}function RMethod_name(b){return b&&"function"==typeof b?b.__name?b.__name:b.__name=RString.mid(b.toString(),"function ","("):null}function RMethod_fullName(b){return b&&b.constructor==Function?b.__fullname?b.__fullname:b.__fullname=RString.mid(b.toString(),"function ",")")+")":null}function RMethod_empty(){}function RMethod_emptyTrue(){return!0}function RMethod_emptyFalse(){return!1}
function RMethod_emptyCall(){}function RMethod_virtual(b,d){var f=RClass.name(b)+"."+d;if(this._virtuals[f])return this._virtuals[f];var h=function(){throw Error("Virtual method be called.("+f+")");};h.__virtual=!0;h.__name=f;return this._virtuals[f]=h}var RObject=new function(){this._hash=1;this.nextId=RObject_nextId;this.nvl=RObject_nvl;this.clone=RObject_clone;this.copy=RObject_copy;this.free=RObject_free;this.dispose=RObject_dispose;this.release=RObject_release;return this};
function RObject_nextId(b){return this._hash++}function RObject_nvl(b){for(var d=arguments,f=d.length,h=0;h<f;h++)if(null!=d[h])return d[h];return null}function RObject_clone(b){var d=new b.constructor,f;for(f in b){var h=b[f];null!=h&&(RClass.isBaseType(h.constructor)||(h=RObject.clone(h)));d[f]=h}return d}function RObject_copy(b,d){if(null!=b&&null!=d)for(var f in b){var h=b[f];null==h||RClass.isBaseType(h.constructor)||(null==d[f]&&(d[f]=new c),RObject.copy(h,d[f]));d[f]=h}}
function RObject_free(b){if(b)if(RRuntime.isDebug())for(var d in b)if("__base"==d||"__inherits"==d||"__class"==d)b[d]=null;else{var f=b[d];if(null!=f){if(!RClass.isBaseType(f.constructor))throw new TError(RObject,"Free object is not base object.");b[d]=null}}else for(d in b)b[d]=null}function RObject_dispose(b){b&&(b.__dispose||b.dispose());return null}function RObject_release(b){if(b)for(var d in p){var f=b[d];"Object"==typeof f&&RObject.release(f);b[d]=null}}
var RRandom=new function(){this._seed=(new Date).getTime();this.get=RRandom_get;this.rand=RRandom_rand;RMemory.register("RRandom",this);return this};function RRandom_get(){this._seed=(9301*this._seed+49297)%233280;return this._seed/233280}function RRandom_rand(b){return Math.ceil(this.get()*b)}var RRect=new function(){this.nvl=RRect_nvl;this.pack=RRect_pack;this.unpack=RRect_unpack;return this};function RRect_nvl(b){return b?b:new TRect}
function RRect_pack(b){var d=null;b&&(d=b.left+","+b.top+","+b.right+","+b.bottom);return d}function RRect_unpack(b,d){d=this.nvl(d);if(b){var f=b.split(",");4==f.length&&(d.left=RInt.parse(f[0]),d.top=RInt.parse(f[1]),d.right=RInt.parse(f[2]),d.bottom=RInt.parse(f[3]))}return d}var RRegExp=new function(){this.test=RRegExp_test;this.testRgexp=RRegExp_testRgexp;return this};function RRegExp_test(b,d){return b&&null!=d?b.test(d):!1}function RRegExp_testRgexp(b,d){return b&&d?(new R,b.test(d)):!1}
var RSet=new function(){this.contains=RSet_contains;this.containsString=RSet_containsString;return this};function RSet_contains(b,d){return(b&d)==d}function RSet_containsString(b,d){return null!=b&&null!=s?-1!=b.indexOf(s):!1}
var RString=new function(){this.EMPTY="";this.SPACE="   ";this.PAD=" ";this.TRIM=" \t\r\n";this.LOWER="abcdefghijklmnopqrstuvwxyz";this.UPPER="ABCDEFGHIJKLMNOPQRSTUVWXYZ";this.CodeLowerA=97;this.CodeLowerZ=122;this.CodeUpperA=65;this.CodeUpperZ=90;this.isEmpty=RString_isEmpty;this.isBlank=RString_isBlank;this.isAnsi=RString_isAnsi;this.isDbcs=RString_isDbcs;this.isPattern=RString_isPattern;this.inChars=RString_inChars;this.contains=RString_contains;this.equals=RString_equals;this.startsWith=RString_startsWith;
this.endsWith=RString_endsWith;this.findChars=RString_findChars;this.inRange=RString_inRange;this.nvl=RString_nvl;this.nvlString=RString_nvlString;this.empty=RString_empty;this.firstUpper=RString_firstUpper;this.firstLower=RString_firstLower;this.firstLine=RString_firstLine;this.format=RString_format;this.formatLines=RString_formatLines;this.repeat=RString_repeat;this.pad=RString_pad;this.lpad=RString_lpad;this.rpad=RString_rpad;this.trim=RString_trim;this.ltrim=RString_ltrim;this.rtrim=RString_rtrim;
this.mid=RString_mid;this.toLine=RString_toLine;this.toUnderline=RString_toUnderline;this.toLower=RString_toLower;this.toUpper=RString_toUpper;this.split=RString_split;this.splitTwo=RString_splitTwo;this.splitParts=RString_splitParts;this.splitPattern=RString_splitPattern;this.replace=RString_replace;this.replaceChar=RString_replaceChar;this.remove=RString_remove;this.removeChars=RString_removeChars;return this};function RString_isEmpty(b){return null!=b?0==b.length:!0}
function RString_isBlank(b){return null!=b?0==b.trim().length:!0}function RString_isAnsi(b){if(null!=b){for(var d=b.length,f=0;f<d;f++)if(255<b.charCodeAt(f))return!1;return!0}return!1}function RString_isDbcs(b){if(null==b){b=b.length;for(var d=0;d<b;d++)if(256>value.charCodeAt(d))return!1;return!0}return!1}
function RString_isPattern(b,d){if(null!=b){null==d&&(d="$a$A$f");d=d.replace(/\a/g,this.LOWER);d=d.replace(/\A/g,this.UPPER);d=d.replace(/\f/g,RFloat.NUMBER);d=d.replace(/\n/g,RInteger.NUMBER);for(var f=b.length,h=0;h<f;h++)if(-1==d.indexOf(b.charAt(h)))return!1;return!0}return!1}function RString_inChars(b,d){return-1!=this.findChars(d,b)?!0:!1}function RString_contains(b,d){return null!=b&&null!=d?-1!=b.toString().indexOf(d):!1}
function RString_equals(b,d,f){null==b?b="":b.constructor!=String&&(b=b.toString());null==d?d="":d.constructor!=String&&(d=d.toString());return f?b==d:b.toLowerCase()==d.toLowerCase()}function RString_startsWith(b,d){return null==d?!0:null!=b?0==b.indexOf(d):!1}function RString_endsWith(b,d){if(null==d)return!0;var f=null!=b?b.indexOf(d):-1;return-1!=f?f==b.length-d.length:!1}
function RString_findChars(b,d){if(null!=b&&null!=d)for(var f=b.length,h=0;h<f;h++)if(-1!=d.indexOf(b.charAt(h)))return h;return-1}function RString_inRange(b,d,f){if(b&&d){f||(b=b.toLowerCase());for(var h=d.length,q=0;q<h;q++){var z=d[q];if(null!=z)if(f){if(b==z)return!0}else if(b==z.toLowerCase())return!0}}return!1}function RString_nvl(b,d){if(null!=b){var f=null,f=b.constructor!=String?b.toString():b;if(0<f.length)return f}return null!=d?d:this.EMPTY}
function RString_nvlString(b){null==b&&(b=new TString);return b}function RString_empty(b){if(null!=b){var d=null,d=b.constructor!=String?b.toString():b;if(0<d.length)return d}return null}function RString_firstUpper(b){return null!=b?b.charAt(0).toUpperCase()+b.substr(1):b}function RString_firstLower(){return null!=v?v.charAt(0).toLowerCase()+v.substr(1):v}function RString_firstLine(b){if(b){var d=Math.min(b.indexOf("\r"),b.indexOf("\n"));return-1!=d?b.substr(0,d):b}return""}
function RString_format(b,d){for(var f=arguments,h=f.length,q=1;q<h;q++)d=f[q],"function"==typeof d?d=RMethod.name(d):null==d&&(d=""),b=b.replace("{"+(q-1)+"}",d);return b}function RString_formatLines(b){b=b.replace(/\\r/g,"");b=b.split("\n");for(var d=b.length,f=new TString,h=0;h<d;h++){var q=b[h],q=this.trim(q);this.isEmpty(q)||this.startsWith(q,"//")||f.appendLine(q)}return f.toString()}function RString_repeat(b,d){return Array(d+1).join(b)}
function RString_pad(b,d,f){b=null!=b?b.toString():this.EMPTY;d-=b.length;if(0<d){null==f&&(f=this.PAD);var h=0==d%2?d/2:(d-1)/2;return Array(h+1).join(f)+b+Array(d-h+1).join(f)}return b}function RString_lpad(b,d,f){b=null!=b?b.toString():this.EMPTY;d-=b.length;return 0<d?(null==f&&(f=this.PAD),d=Array(d),d[d.length]=b,d.join(f)):b}function RString_rpad(b,d,f){b=null!=b?b.toString():this.EMPTY;d-=b.length;return 0<d?(null==f&&(f=this.PAD),b+Array(d+1).join(f)):b}
function RString_trim(b,d){b=this.nvl(b);d=this.nvl(d,this.TRIM);for(var f=0,h=b.length-1;f<h&&-1!=d.indexOf(b.charAt(f));f++);for(;h>=f&&-1!=d.indexOf(b.charAt(h));h--);return f==h+1?null:0!=f||h!=b.length-1?b.substring(f,h+1):b}function RString_ltrim(b,d){b=this.nvl(value);d=this.nvl(trims,this.TRIM);for(var f=0,h=b.length-1;f<h&&-1!=d.indexOf(b.charAt(f));f++);return 0!=f?b.substring(f,h+1):b}
function RString_rtrim(b,d){b=this.nvl(b);d=this.nvl(d,this.TRIM);for(var f=b.length-1;0<=f&&-1!=d.indexOf(b.charAt(f));f--);return f!=b.length-1?b.substring(0,f+1):b}function RString_mid(b,d,f){if(null==b)return b;var h=0;if(null!=d){var q=b.indexOf(d);-1!=q&&(h=q+d.length)}d=b.length;null!=f&&(q=b.indexOf(f,h),-1!=q&&(d=q));return b.substring(h,d)}function RString_toLine(b){return b.replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\t/g,"\\t")}
function RString_toUnderline(b){var d=null;if(b){for(var d=new TString,f=b.length,h=0;h<f;h++){var q=b.charAt(h);q.toUpperCase()==q?(0<h&&d.append("_"),d.append(q.toLowerCase())):d.append(q)}d=d.toString()}return d}function RString_toLower(b){return null!=b?b.toLowerCase():this.EMPTY}function RString_toUpper(b){return null!=b?b.toUpperCase():this.EMPTY}function RString_split(b,d){return b&&d?b.split(d):null}
function RString_splitTwo(b,d){if(b&&d){var f=[],h=b.indexOf(d);-1==h?f.push(b):(f.push(b.substring(0,h)),f.push(b.substring(h+d.length)));return f}return null}function RString_splitParts(b,d){for(var f=[],h=0,q=b.length,z=0;z<q;z++)for(var A in d)if(this.startsWith(d[A],b.charAt(z))&&this.equals(b.substr(z,d[A].length),d[A])){f[h++]=d[A];z=z+d[A].length-1;break}return f}
function RString_splitPattern(b,d){var f=[];if(b)for(var h=b.length,q=d.length,z="",A=0;A<h;A++){for(var B=!1,C=0;C<q;C++){var D=d[C];if(-1==b.indexOf(D)){z.length&&(f[f.length]=z,z="");f[f.length]=D;b=b.substring(D.length);B=!0;break}}B||(z+=b.charAt(0),b=b.substring(1))}return f}function RString_replace(b,d,f){return b.replace(new RegExp(d,"g"),f)}
function RString_replaceChar(b,d,f){if(null!=b){for(var h=b.length,q=[],z=0;z<h;z++){var A=b.charAt(z);q[q.length]=A==d?f:A}return q.join("")}return b}function RString_remove(b,d){return b.replace(d,"")}function RString_removeChars(b,d){if(null!=b){for(var f=b.length,h=[],q=0;q<f;q++){var z=b.charAt(q);-1==d.indexOf(z)&&(h[h.length]=z)}return h.join("")}return b}
var RTimer=new function(){this._count=this._lastTime=this._startTime=0;this.setup=RTimer_setup;this.now=RTimer_now;this.current=RTimer_current;this.rate=RTimer_rate;this.update=RTimer_update;return this};function RTimer_setup(){var b=(new Date).getTime();this._lastTime=this._startTime=b}function RTimer_now(){return(new Date).getTime()}function RTimer_current(){return this._lastTime}function RTimer_rate(){return 0==this._count?0:parseInt(1E3*this._count/(this._lastTime-this._startTime))}
function RTimer_update(){this._count++;this._lastTime=(new Date).getTime()}var EFrustumPlane=new function(){this.Near=0;this.Far=1;this.Left=2;this.Right=3;this.Top=4;this.Bottom=5;this.Count=6;return this};
function SColor4(){this.blue=this.green=this.red=0;this.alpha=1;this.assign=SColor4_assign;this.assignPower=SColor4_assignPower;this.set=SColor4_set;this.serialize=SColor4_serialize;this.unserialize=SColor4_unserialize;this.unserialize3=SColor4_unserialize3;this.saveConfig=SColor4_saveConfig;this.savePower=SColor4_savePower;this.copyArray=SColor4_copyArray;this.toString=SColor4_toString;return this}function SColor4_assign(b){this.red=b.red;this.green=b.green;this.blue=b.blue;this.alpha=b.alpha}
function SColor4_assignPower(b){this.red=b.red*b.alpha;this.green=b.green*b.alpha;this.blue=b.blue*b.alpha;this.alpha=b.alpha}function SColor4_set(b,d,f,h){this.red=b;this.green=d;this.blue=f;this.alpha=h}function SColor4_serialize(b){b.writeFloat(this.red);b.writeFloat(this.green);b.writeFloat(this.blue);b.writeFloat(this.alpha)}function SColor4_unserialize(b){this.red=b.readFloat();this.green=b.readFloat();this.blue=b.readFloat();this.alpha=b.readFloat()}
function SColor4_unserialize3(b){this.red=b.readFloat();this.green=b.readFloat();this.blue=b.readFloat();this.alpha=1}function SColor4_saveConfig(b){b.setFloat("r",this.red);b.setFloat("g",this.green);b.setFloat("b",this.blue);b.setFloat("a",this.alpha)}function SColor4_savePower(b){b.setFloat("r",this.red);b.setFloat("g",this.green);b.setFloat("b",this.blue);b.setFloat("power",this.alpha)}
function SColor4_copyArray(b,d){b[d++]=this.red;b[d++]=this.green;b[d++]=this.blue;b[d++]=this.alpha;return 4}function SColor4_toString(){return RFloat.format(this.red)+","+RFloat.format(this.green)+","+RFloat.format(this.blue)+","+RFloat.format(this.alpha)}
function SCorners(){this.blue=this.green=this.red=0;this.alpha=1;this.assign=SCorners_assign;this.assignPower=SCorners_assignPower;this.set=SCorners_set;this.serialize=SCorners_serialize;this.unserialize=SCorners_unserialize;this.unserialize3=SCorners_unserialize3;this.saveConfig=SCorners_saveConfig;this.savePower=SCorners_savePower;this.copyArray=SCorners_copyArray;this.toString=SCorners_toString;return this}
function SCorners_assign(b){this.red=b.red;this.green=b.green;this.blue=b.blue;this.alpha=b.alpha}function SCorners_assignPower(b){this.red=b.red*b.alpha;this.green=b.green*b.alpha;this.blue=b.blue*b.alpha;this.alpha=b.alpha}function SCorners_set(b,d,f,h){this.red=b;this.green=d;this.blue=f;this.alpha=h}function SCorners_serialize(b){b.writeFloat(this.red);b.writeFloat(this.green);b.writeFloat(this.blue);b.writeFloat(this.alpha)}
function SCorners_unserialize(b){this.red=b.readFloat();this.green=b.readFloat();this.blue=b.readFloat();this.alpha=b.readFloat()}function SCorners_unserialize3(b){this.red=b.readFloat();this.green=b.readFloat();this.blue=b.readFloat();this.alpha=1}function SCorners_saveConfig(b){b.setFloat("r",this.red);b.setFloat("g",this.green);b.setFloat("b",this.blue);b.setFloat("a",this.alpha)}
function SCorners_savePower(b){b.setFloat("r",this.red);b.setFloat("g",this.green);b.setFloat("b",this.blue);b.setFloat("power",this.alpha)}function SCorners_copyArray(b,d){b[d++]=this.red;b[d++]=this.green;b[d++]=this.blue;b[d++]=this.alpha;return 4}function SCorners_toString(){return RFloat.format(this.red)+","+RFloat.format(this.green)+","+RFloat.format(this.blue)+","+RFloat.format(this.alpha)}
function SFrustum(){this.center=new SPoint3;this.maxZ=this.minZ=this.maxY=this.minY=this.maxX=this.minX=this.radius=null;this.points=Array(24);this.coners=Array(24);this.updateCenter=SFrustum_updateCenter;this.update=SFrustum_update;this.updateFlat=SFrustum_updateFlat;return this}
function SFrustum_updateCenter(){var b=this.coners;this.minX=this.minY=this.minZ=Number.MAX_VALUE;this.maxX=this.maxY=this.maxZ=-Number.MAX_VALUE;for(var d=0;24>d;){var f=b[d++];f<this.minX&&(this.minX=f);f>this.maxX&&(this.maxX=f);f=b[d++];f<this.minY&&(this.minY=f);f>this.maxY&&(this.maxY=f);f=b[d++];f<this.minZ&&(this.minZ=f);f>this.maxZ&&(this.maxZ=f)}this.center.x=.5*(this.minX+this.maxX);this.center.y=.5*(this.minY+this.maxY);this.center.z=.5*(this.minZ+this.maxZ);b=this.maxX-this.minX;d=this.maxY-
this.minY;f=this.maxZ-this.minZ;this.radius=.5*Math.sqrt(b*b+d*d+f*f)}function SFrustum_update(b,d,f,h,q,z,A,B){f=d/f;z=Math.tan(RConst.DEGREE_RATE*b*.5);b=h*z;d=b*f;z*=q;A=z*f;f=this.points;f[0]=-d;f[1]=b;f[2]=h;f[3]=d;f[4]=b;f[5]=h;f[6]=d;f[7]=-b;f[8]=h;f[9]=-d;f[10]=-b;f[11]=h;f[12]=-A;f[13]=z;f[14]=q;f[15]=A;f[16]=z;f[17]=q;f[18]=A;f[19]=-z;f[20]=q;f[21]=-A;f[22]=-z;f[23]=q;h=RMath.matrix;h.assign(B);h.invert();h.transform(this.coners,f,8);this.updateCenter()}
function SFrustum_updateFlat(b,d,f,h,q,z,A,B){d/=f;h*=A;q*=z;A=Math.tan(RConst.DEGREE_RATE*b*.5);b=h*A;z=b*d;A*=q;f=A*d;d=this.points;d[0]=-z;d[1]=b;d[2]=h;d[3]=z;d[4]=b;d[5]=h;d[6]=z;d[7]=-b;d[8]=h;d[9]=-z;d[10]=-b;d[11]=h;d[12]=-f;d[13]=A;d[14]=q;d[15]=f;d[16]=A;d[17]=q;d[18]=f;d[19]=-A;d[20]=q;d[21]=-f;d[22]=-A;d[23]=q;h=RMath.matrix;h.assign(B);h.invert();h.transform(this.coners,0,d,0,8);this.coners[1]=0;this.coners[4]=0;this.coners[7]=0;this.coners[10]=0;this.coners[13]=0;this.coners[16]=0;this.coners[19]=
0;this.coners[22]=0;this.updateCenter()}function SFrustumPlanes(){this.planes=[];this.containsPoint=SFrustumPlanes_containsPoint;this.containsCube=SFrustumPlanes_containsCube;this.containsRectangle=SFrustumPlanes_containsRectangle;this.containsCorners=SFrustumPlanes_containsCorners;this.containsSphere=SFrustumPlanes_containsSphere;this.updateVision=SFrustumPlanes_updateVision;for(var b=0;b<EFrustumPlane.Count;b++)this.planes.push(new SPlane);return this}
function SFrustumPlanes_containsPoint(b,d,f){for(var h=this.planes,q=0;q<EFrustumPlane.Count;q++)if(0>h[n].dot(b,d,f))return!1;return!0}function SFrustumPlanes_containsCube(b,d,f,h){h=this.planes;for(var q=0;q<EFrustumPlane.Count;q++){var z=h[n];if(!(0<=z.dot(b-l,d-l,f-l)||0<=z.dot(b+l,d-l,f-l)||0<=z.dot(b-l,d+l,f-l)||0<=z.dot(b+l,d+l,f-l)||0<=z.dot(b-l,d-l,f+l)||0<=z.dot(b+l,d-l,f+l)||0<=z.dot(b-l,d+l,f+l)||0<=z.dot(b+l,d+l,f+l)))return!1}return!0}
function SFrustumPlanes_containsRectangle(b,d,f,h,q,z){for(var A=this.planes,B=0;B<EFrustumPlane.Count;B++){var C=A[n];if(!(0<=C.dot(b-h,d-q,f-z)||0<=C.dot(b+h,d-q,f-z)||0<=C.dot(b-h,d+q,f-z)||0<=C.dot(b+h,d+q,f-z)||0<=C.dot(b-h,d-q,f+z)||0<=C.dot(b+h,d-q,f+z)||0<=C.dot(b-h,d+q,f+z)||0<=C.dot(b+h,d+q,f+z)))return!1}return!0}
function SFrustumPlanes_containsCorners(b){for(var d=this.planes,f=EFrustumPlane.Count-1;0<=f;f--){var h=d[f];if(!(0<=h.dot(b[0],b[1],b[2])||0<=h.dot(b[3],b[4],b[5])||0<=h.dot(b[6],b[7],b[8])||0<=h.dot(b[9],b[10],b[11])||0<=h.dot(b[12],b[13],b[14])||0<=h.dot(b[15],b[16],b[17])||0<=h.dot(b[18],b[19],b[20])||0<=h.dot(b[21],b[22],b[23])))return!1}return!0}function SFrustumPlanes_containsSphere(b,d,f,h){for(var q=this.planes,z=0;z<EFrustumPlane.Count;z++)if(q[n].dot(b,d,f)<-h)return!1;return!0}
function SFrustumPlanes_updateVision(b){var d=this.planes,f=d[EFrustumPlane.Near];f.a=b[3]+b[2];f.b=b[7]+b[6];f.c=b[11]+b[10];f.d=b[15]+b[14];f.normalize();f=d[EFrustumPlane.Far];f.a=b[3]-b[2];f.b=b[7]-b[6];f.c=b[11]-b[10];f.d=b[15]-b[14];f.normalize();f=d[EFrustumPlane.Left];f.a=b[3]-b[0];f.b=b[7]-b[4];f.c=b[11]-b[8];f.d=b[15]-b[12];f.normalize();f=d[EFrustumPlane.Right];f.a=b[3]+b[0];f.b=b[7]+b[4];f.c=b[11]+b[8];f.d=b[15]+b[12];f.normalize();f=d[EFrustumPlane.Top];f.a=b[3]-b[1];f.b=b[7]-b[5];f.c=
b[11]-b[9];f.d=b[15]-b[13];f.normalize();d=d[EFrustumPlane.Bottom];d.a=b[3]+b[1];d.b=b[7]+b[5];d.c=b[11]+b[9];d.d=b[15]+b[13];d.normalize()}
function SMatrix3d(){SMatrix4x4.call(this);this._dirty=!1;this.rz=this.ry=this.rx=this.tz=this.ty=this.tx=0;this.sz=this.sy=this.sx=1;this.isIdentity=SMatrix3d_isIdentity;this.identity=SMatrix3d_identity;this.setTranslate=SMatrix3d_setTranslate;this.setRotation=SMatrix3d_setRotation;this.setScale=SMatrix3d_setScale;this.setScaleAll=SMatrix3d_setScaleAll;this.set=SMatrix3d_set;this.setAll=SMatrix3d_setAll;this.equals=SMatrix3d_equals;this.assign=SMatrix3d_assign;this.attach=SMatrix3d_attach;this.append=
SMatrix3d_append;this.updateForce=SMatrix3d_updateForce;this.update=SMatrix3d_update;this.merge=SMatrix3d_merge;this.serialize=SMatrix3d_serialize;this.unserialize=SMatrix3d_unserialize;this.saveConfig=SMatrix3d_saveConfig;this.identity();return this}function SMatrix3d_isIdentity(){return 0!=this.tx||0!=this.ty||0!=this.tz||0!=this.rx||0!=this.ry||0!=this.rz||1!=this.sx||1!=this.sy||1!=this.sz?!1:this.isIdentityData()}
function SMatrix3d_identity(){this.rx=this.ry=this.rz=this.tx=this.ty=this.tz=0;this.sx=this.sy=this.sz=1;return this.identityData()}function SMatrix3d_setTranslate(b,d,f){this.tx=b;this.ty=d;this.tz=f;this._dirty=!0}function SMatrix3d_setRotation(b,d,f){this.rx=b;this.ry=d;this.rz=f;this._dirty=!0}function SMatrix3d_setScale(b,d,f){this.sx=b;this.sy=d;this.sz=f;this._dirty=!0}function SMatrix3d_setScaleAll(b){this.sz=this.sy=this.sx=b;this._dirty=!0}
function SMatrix3d_set(b,d,f){this.tx=b.x;this.ty=b.y;this.tz=b.z;this.rx=d.x;this.ry=d.y;this.rz=d.z;this.sx=f.x;this.sy=f.y;this.sz=f.z;this._dirty=!0}function SMatrix3d_setAll(b,d,f,h,q,z,A,B,C){this.tx=b;this.ty=d;this.tz=f;this.rx=h;this.ry=q;this.rz=z;this.sx=A;this.sy=B;this.sz=C;this._dirty=!0}function SMatrix3d_equals(b){return this.equalsData(b._data)}
function SMatrix3d_assign(b){this.tx=b.tx;this.ty=b.ty;this.tz=b.tz;this.rx=b.rx;this.ry=b.ry;this.rz=b.rz;this.sx=b.sx;this.sy=b.sy;this.sz=b.sz;this.assignData(b._data)}function SMatrix3d_attach(b){this.tx=b.tx;this.ty=b.ty;this.tz=b.tz;this.rx=b.rx;this.ry=b.ry;this.rz=b.rz;this.sx=b.sx;this.sy=b.sy;this.sz=b.sz;return this.attachData(b._data)}function SMatrix3d_append(b){this.appendData(b._data)}
function SMatrix3d_updateForce(){var b=this._data,d=Math.sin(this.rx),f=Math.cos(this.rx),h=Math.sin(this.ry),q=Math.cos(this.ry),z=Math.sin(this.rz),A=Math.cos(this.rz);b[0]=q*A*this.sx;b[1]=q*z*this.sx;b[2]=-h*this.sx;b[3]=0;b[4]=(d*h*A-f*z)*this.sy;b[5]=(d*h*z+f*A)*this.sy;b[6]=d*q*this.sy;b[7]=0;b[8]=(f*h*A+d*z)*this.sz;b[9]=(f*h*z-d*A)*this.sz;b[10]=f*q*this.sz;b[11]=0;b[12]=this.tx;b[13]=this.ty;b[14]=this.tz;b[15]=1}
function SMatrix3d_update(){this._dirty&&(this.updateForce(),this._dirty=!1)}function SMatrix3d_merge(b,d){this.tx=b.tx+d.tx;this.ty=b.ty+d.ty;this.tz=b.tz+d.tz;this.rx=b.rx+d.rx;this.ry=b.ry+d.ry;this.rz=b.rz+d.rz;this.sx=b.sx*d.sx;this.sy=b.sy*d.sy;this.sz=b.sz*d.sz;this.updateForce()}
function SMatrix3d_serialize(b){b.writeFloat(this.tx);b.writeFloat(this.ty);b.writeFloat(this.tz);b.writeFloat(this.rx);b.writeFloat(this.ry);b.writeFloat(this.rz);b.writeFloat(this.sx);b.writeFloat(this.sy);b.writeFloat(this.sz)}function SMatrix3d_unserialize(b){this.tx=b.readFloat();this.ty=b.readFloat();this.tz=b.readFloat();this.rx=b.readFloat();this.ry=b.readFloat();this.rz=b.readFloat();this.sx=b.readFloat();this.sy=b.readFloat();this.sz=b.readFloat();this.updateForce()}
function SMatrix3d_saveConfig(b){b.set("tx",RFloat.format(this.tx));b.set("ty",RFloat.format(this.ty));b.set("tz",RFloat.format(this.tz));b.set("rx",RFloat.format(this.rx));b.set("ry",RFloat.format(this.ry));b.set("rz",RFloat.format(this.rz));b.set("sx",RFloat.format(this.sx));b.set("sy",RFloat.format(this.sy));b.set("sz",RFloat.format(this.sz))}
function SMatrix3x3(){this._data=Array(9);this.data=SMatrix3x3_data;this.equalsData=SMatrix3x3_equalsData;this.assignData=SMatrix3x3_assignData;this.appendData=SMatrix3x3_appendData;this.rotationX=SMatrix3x3_rotationX;this.rotationY=SMatrix3x3_rotationY;this.rotationZ=SMatrix3x3_rotationZ;this.rotation=SMatrix3x3_rotation;this.invert=SMatrix3x3_invert;this.transform=SMatrix3x3_transform;this.transformPoint3=SMatrix3x3_transformPoint3;this.build=SMatrix3x3_build;this.writeData=SMatrix3x3_writeData;
this.toString=SMatrix3x3_toString;return this}function SMatrix3x3_data(){return this._data}function SMatrix3x3_equalsData(b){for(var d=this._data,f=0;9>f;f++)if(d[f]!=b[f])return!1;return!0}function SMatrix3x3_assignData(b){for(var d=this._data,f=0;9>f;f++)d[f]=b[f]}
function SMatrix3x3_appendData(b){var d=this._data,f=d[0]*b[1]+d[1]*b[4]+d[2]*b[7],h=d[0]*b[2]+d[1]*b[5]+d[2]*b[8],q=d[3]*b[0]+d[4]*b[3]+d[5]*b[6],z=d[3]*b[1]+d[4]*b[4]+d[5]*b[7],A=d[3]*b[2]+d[4]*b[5]+d[5]*b[8],B=d[6]*b[0]+d[7]*b[3]+d[8]*b[6],C=d[6]*b[1]+d[7]*b[4]+d[8]*b[7],D=d[6]*b[2]+d[7]*b[5]+d[8]*b[8];d[0]=d[0]*b[0]+d[1]*b[3]+d[2]*b[6];d[1]=f;d[2]=h;d[3]=q;d[4]=z;d[5]=A;d[6]=B;d[7]=C;d[8]=D}
function SMatrix3x3_rotationX(b){var d=Math.sin(b);b=Math.cos(b);var f=RMath.value9;f[0]=1;f[1]=0;f[2]=0;f[3]=0;f[4]=b;f[5]=d;f[6]=0;f[7]=-d;f[8]=b;this.appendData(f)}function SMatrix3x3_rotationY(b){var d=Math.sin(b);b=Math.cos(b);var f=RMath.value9;f[0]=b;f[1]=0;f[2]=d;f[3]=0;f[4]=1;f[5]=0;f[6]=-d;f[7]=0;f[8]=b;this.appendData(f)}
function SMatrix3x3_rotationZ(b){var d=Math.sin(b);b=Math.cos(b);var f=RMath.value9;f[0]=b;f[1]=d;f[2]=0;f[3]=-d;f[4]=b;f[5]=1;f[6]=0;f[7]=0;f[8]=1;this.appendData(f)}function SMatrix3x3_rotation(b,d,f){var h=Math.sin(b);b=Math.cos(b);var q=Math.sin(d);d=Math.cos(d);var z=Math.sin(f);f=Math.cos(f);var A=RMath.value9;A[0]=d*f;A[1]=d*z;A[2]=-q;A[3]=h*q*f-b*z;A[4]=h*q*z+b*f;A[5]=h*d;A[6]=b*q*f+h*z;A[7]=b*q*z-h*b;A[8]=b*d;this.appendData(A)}
function SMatrix3x3_invert(){var b=this._data,d=RValue.value9;d[0]=b[4]*b[8]-b[5]*b[7];d[1]=b[2]*b[7]-b[1]*b[8];d[2]=b[1]*b[5]-b[2]*b[4];d[3]=b[5]*b[6]-b[3]*b[8];d[4]=b[0]*b[8]-b[2]*b[6];d[5]=b[2]*b[3]-b[0]*b[5];d[6]=b[3]*b[7]-b[4]*b[6];d[7]=b[1]*b[6]-b[0]*b[7];d[8]=b[0]*b[4]-b[1]*b[3];var f=b[0]*d[0]+b[1]*d[3]+b[2]*d[6];if(0==f)return!1;for(var f=1/f,h=0;9>h;h++)b[h]=d[h]*f;return!0}
function SMatrix3x3_transform(b,d,f){for(var h=this._data,q=0;q<f;q++){var z=(q<<1)+q;b[z]=d[z]*h[0]+d[z+1]*h[3]+d[z+2]*h[6];b[z+1]=d[z]*h[1]+d[z+1]*h[4]+d[z+2]*h[7];b[z+2]=d[z]*h[2]+d[z+1]*h[5]+d[z+2]*h[8]}}function SMatrix3x3_transformPoint3(b,d){var f=this._data,h=b.x*f[0]+b.y*f[3]+b.z*f[6],q=b.x*f[1]+b.y*f[4]+b.z*f[7],f=b.x*f[2]+b.y*f[5]+b.z*f[8],z=null,z=d?d:new SPoint3;z.set(h,q,f);return z}
function SMatrix3x3_build(b){var d=this._data,f=b.x*b.x,h=b.y*b.y,q=b.z*b.z,z=b.x*b.y,A=b.x*b.z,B=b.y*b.z,C=b.w*b.x,D=b.w*b.y;b=b.w*b.z;d[0]=1-2*(h+q);d[1]=2*(z-b);d[2]=2*(A+D);d[3]=2*(z+b);d[4]=1-2*(f+q);d[5]=2*(B-C);d[6]=2*(A-D);d[7]=2*(B+C);d[8]=1-2*(f+h)}function SMatrix3x3_writeData(b,d){var f=this._data;b[d++]=f[0];b[d++]=f[3];b[d++]=f[6];b[d++]=f[1];b[d++]=f[4];b[d++]=f[7];b[d++]=f[2];b[d++]=f[5];b[d++]=f[8]}
function SMatrix3x3_toString(){for(var b=this._data,d=new TString,f=0;3>f;f++){0<f&&d.append("|");for(var h=0;3>h;h++){var q=b[3*f+h];0<h&&d.append(",");d.append(RFloat.format(q,0,null,3,null))}}return d.flush()}
function SMatrix4x4(){this._data=Array(16);this.data=SMatrix4x4_data;this.isIdentityData=SMatrix4x4_isIdentityData;this.identityData=SMatrix4x4_identityData;this.equalsData=SMatrix4x4_equalsData;this.assignData=SMatrix4x4_assignData;this.attachData=SMatrix4x4_attachData;this.appendData=SMatrix4x4_appendData;this.addTranslate=SMatrix4x4_addTranslate;this.addRotationX=SMatrix4x4_addRotationX;this.addRotationY=SMatrix4x4_addRotationY;this.addRotationZ=SMatrix4x4_addRotationZ;this.addRotation=SMatrix4x4_addRotation;
this.addScale=SMatrix4x4_addScale;this.invert=SMatrix4x4_invert;this.transform=SMatrix4x4_transform;this.transformPoint3=SMatrix4x4_transformPoint3;this.buildQuaternion=SMatrix4x4_buildQuaternion;this.build=SMatrix4x4_build;this.writeData=SMatrix4x4_writeData;this.toString=SMatrix4x4_toString;return this}function SMatrix4x4_data(){return this._data}function SMatrix4x4_isIdentityData(){for(var b=this._data,d=RConst.identity4x4,f=0;16>f;f++)if(b[f]!=d[f])return!1;return!0}
function SMatrix4x4_identityData(){for(var b=this._data,d=RConst.identity4x4,f=0;16>f;f++)b[f]=d[f];return this}function SMatrix4x4_equalsData(b){for(var d=this._data,f=0;16>f;f++)if(d[f]!=b[f])return!1;return!0}function SMatrix4x4_assignData(b){for(var d=this._data,f=0;16>f;f++)d[f]=b[f]}function SMatrix4x4_attachData(b){for(var d=!1,f=this._data,h=0;16>h;h++){var q=b[h];d||f[h]!=q&&(d=!0);f[h]=q}return d}
function SMatrix4x4_appendData(b){var d=this._data,f=d[0]*b[1]+d[1]*b[5]+d[2]*b[9]+d[3]*b[13],h=d[0]*b[2]+d[1]*b[6]+d[2]*b[10]+d[3]*b[14],q=d[0]*b[3]+d[1]*b[7]+d[2]*b[11]+d[3]*b[15],z=d[4]*b[0]+d[5]*b[4]+d[6]*b[8]+d[7]*b[12],A=d[4]*b[1]+d[5]*b[5]+d[6]*b[9]+d[7]*b[13],B=d[4]*b[2]+d[5]*b[6]+d[6]*b[10]+d[7]*b[14],C=d[4]*b[3]+d[5]*b[7]+d[6]*b[11]+d[7]*b[15],D=d[8]*b[0]+d[9]*b[4]+d[10]*b[8]+d[11]*b[12],E=d[8]*b[1]+d[9]*b[5]+d[10]*b[9]+d[11]*b[13],F=d[8]*b[2]+d[9]*b[6]+d[10]*b[10]+d[11]*b[14],G=d[8]*b[3]+
d[9]*b[7]+d[10]*b[11]+d[11]*b[15],I=d[12]*b[0]+d[13]*b[4]+d[14]*b[8]+d[15]*b[12],H=d[12]*b[1]+d[13]*b[5]+d[14]*b[9]+d[15]*b[13],K=d[12]*b[2]+d[13]*b[6]+d[14]*b[10]+d[15]*b[14],J=d[12]*b[3]+d[13]*b[7]+d[14]*b[11]+d[15]*b[15];d[0]=d[0]*b[0]+d[1]*b[4]+d[2]*b[8]+d[3]*b[12];d[1]=f;d[2]=h;d[3]=q;d[4]=z;d[5]=A;d[6]=B;d[7]=C;d[8]=D;d[9]=E;d[10]=F;d[11]=G;d[12]=I;d[13]=H;d[14]=K;d[15]=J}
function SMatrix4x4_addTranslate(b,d,f){var h=RArray.array16;h[0]=1;h[1]=0;h[2]=0;h[3]=0;h[4]=0;h[5]=1;h[6]=0;h[7]=0;h[8]=0;h[9]=0;h[10]=1;h[11]=0;h[12]=b;h[13]=d;h[14]=f;h[15]=1;this.appendData(h)}function SMatrix4x4_addRotationX(b){var d=Math.sin(b);b=Math.cos(b);var f=RArray.array16;f[0]=1;f[1]=0;f[2]=0;f[3]=0;f[4]=0;f[5]=b;f[6]=d;f[7]=0;f[8]=0;f[9]=-d;f[10]=b;f[11]=0;f[12]=0;f[13]=0;f[14]=0;f[15]=1;this.appendData(f)}
function SMatrix4x4_addRotationY(b){var d=Math.sin(b);b=Math.cos(b);var f=RArray.array16;f[0]=b;f[1]=0;f[2]=d;f[3]=0;f[4]=0;f[5]=1;f[6]=0;f[7]=0;f[8]=-d;f[9]=0;f[10]=b;f[11]=0;f[12]=0;f[13]=0;f[14]=0;f[15]=1;this.appendData(f)}function SMatrix4x4_addRotationZ(b){var d=Math.sin(b);b=Math.cos(b);var f=RArray.array16;f[0]=b;f[1]=d;f[2]=0;f[3]=0;f[4]=-d;f[5]=b;f[6]=1;f[7]=0;f[8]=0;f[9]=0;f[10]=1;f[11]=0;f[12]=0;f[13]=0;f[14]=0;f[15]=1;this.appendData(f)}
function SMatrix4x4_addRotation(b,d,f){var h=Math.sin(b);b=Math.cos(b);var q=Math.sin(d);d=Math.cos(d);var z=Math.sin(f);f=Math.cos(f);var A=RArray.array16;A[0]=d*f;A[1]=d*z;A[2]=-q;A[3]=0;A[4]=h*q*f-b*z;A[5]=h*q*z+b*f;A[6]=h*d;A[7]=0;A[8]=b*q*f+h*z;A[9]=b*q*z-h*b;A[10]=b*d;A[11]=0;A[12]=0;A[13]=0;A[14]=0;A[15]=1;this.appendData(A)}
function SMatrix4x4_addScale(b,d,f){var h=RArray.array16;h[0]=b;h[1]=0;h[2]=0;h[3]=0;h[4]=0;h[5]=d;h[6]=0;h[7]=0;h[8]=0;h[9]=0;h[10]=f;h[11]=0;h[12]=0;h[13]=0;h[14]=0;h[15]=1;this.appendData(h)}
function SMatrix4x4_invert(){var b=this._data,d=RArray.array16;d[0]=b[5]*b[10]*b[15]-b[5]*b[11]*b[14]-b[9]*b[6]*b[15]+b[9]*b[7]*b[14]+b[13]*b[6]*b[11]-b[13]*b[7]*b[10];d[4]=-(b[4]*b[10]*b[15])+b[4]*b[11]*b[14]+b[8]*b[6]*b[15]-b[8]*b[7]*b[14]-b[12]*b[6]*b[11]+b[12]*b[7]*b[10];d[8]=b[4]*b[9]*b[15]-b[4]*b[11]*b[13]-b[8]*b[5]*b[15]+b[8]*b[7]*b[13]+b[12]*b[5]*b[11]-b[12]*b[7]*b[9];d[12]=-(b[4]*b[9]*b[14])+b[4]*b[10]*b[13]+b[8]*b[5]*b[14]-b[8]*b[6]*b[13]-b[12]*b[5]*b[10]+b[12]*b[6]*b[9];d[1]=-(b[1]*b[10]*
b[15])+b[1]*b[11]*b[14]+b[9]*b[2]*b[15]-b[9]*b[3]*b[14]-b[13]*b[2]*b[11]+b[13]*b[3]*b[10];d[5]=b[0]*b[10]*b[15]-b[0]*b[11]*b[14]-b[8]*b[2]*b[15]+b[8]*b[3]*b[14]+b[12]*b[2]*b[11]-b[12]*b[3]*b[10];d[9]=-(b[0]*b[9]*b[15])+b[0]*b[11]*b[13]+b[8]*b[1]*b[15]-b[8]*b[3]*b[13]-b[12]*b[1]*b[11]+b[12]*b[3]*b[9];d[13]=b[0]*b[9]*b[14]-b[0]*b[10]*b[13]-b[8]*b[1]*b[14]+b[8]*b[2]*b[13]+b[12]*b[1]*b[10]-b[12]*b[2]*b[9];d[2]=b[1]*b[6]*b[15]-b[1]*b[7]*b[14]-b[5]*b[2]*b[15]+b[5]*b[3]*b[14]+b[13]*b[2]*b[7]-b[13]*b[3]*
b[6];d[6]=-(b[0]*b[6]*b[15])+b[0]*b[7]*b[14]+b[4]*b[2]*b[15]-b[4]*b[3]*b[14]-b[12]*b[2]*b[7]+b[12]*b[3]*b[6];d[10]=b[0]*b[5]*b[15]-b[0]*b[7]*b[13]-b[4]*b[1]*b[15]+b[4]*b[3]*b[13]+b[12]*b[1]*b[7]-b[12]*b[3]*b[5];d[14]=-(b[0]*b[5]*b[14])+b[0]*b[6]*b[13]+b[4]*b[1]*b[14]-b[4]*b[2]*b[13]-b[12]*b[1]*b[6]+b[12]*b[2]*b[5];d[3]=-(b[1]*b[6]*b[11])+b[1]*b[7]*b[10]+b[5]*b[2]*b[11]-b[5]*b[3]*b[10]-b[9]*b[2]*b[7]+b[9]*b[3]*b[6];d[7]=b[0]*b[6]*b[11]-b[0]*b[7]*b[10]-b[4]*b[2]*b[11]+b[4]*b[3]*b[10]+b[8]*b[2]*b[7]-
b[8]*b[3]*b[6];d[11]=-(b[0]*b[5]*b[11])+b[0]*b[7]*b[9]+b[4]*b[1]*b[11]-b[4]*b[3]*b[9]-b[8]*b[1]*b[7]+b[8]*b[3]*b[5];d[15]=b[0]*b[5]*b[10]-b[0]*b[6]*b[9]-b[4]*b[1]*b[10]+b[4]*b[2]*b[9]+b[8]*b[1]*b[6]-b[8]*b[2]*b[5];var f=b[0]*d[0]+b[1]*d[4]+b[2]*d[8]+b[3]*d[12];if(0==f)return!1;for(var f=1/f,h=0;16>h;h++)b[h]=d[h]*f;return!0}
function SMatrix4x4_transform(b,d,f,h,q){for(var z=this._data,A=0;A<q;A++){var B=f[h++],C=f[h++],D=f[h++];b[d++]=B*z[0]+C*z[4]+D*z[8]+z[12];b[d++]=B*z[1]+C*z[5]+D*z[9]+z[13];b[d++]=B*z[2]+C*z[6]+D*z[10]+z[14]}}function SMatrix4x4_transformPoint3(b,d){var f=this._data,h=b.x*f[0]+b.y*f[4]+b.z*f[8]+f[12],q=b.x*f[1]+b.y*f[5]+b.z*f[9]+f[13],f=b.x*f[2]+b.y*f[6]+b.z*f[10]+f[14],z=null,z=d?d:new SPoint3;z.set(h,q,f);return z}
function SMatrix4x4_build(b,d,f){var h=this._data,q=d.x*d.x,z=d.y*d.y,A=d.z*d.z,B=d.x*d.y,C=d.x*d.z,D=d.y*d.z,E=d.w*d.x,F=d.w*d.y;d=d.w*d.z;h[0]=(1-2*(z+A))*f.x;h[1]=2*(B-d)*f.x;h[2]=2*(C+F)*f.x;h[3]=0;h[4]=2*(B+d)*f.y;h[5]=(1-2*(q+A))*f.y;h[6]=2*(D-E)*f.y;h[7]=0;h[8]=2*(C-F)*f.z;h[9]=2*(D+E)*f.z;h[10]=(1-2*(q+z))*f.z;h[11]=0;h[12]=b.x;h[13]=b.y;h[14]=b.z;h[15]=1}
function SMatrix4x4_buildQuaternion(b){var d=this._data,f=b.x*b.x,h=b.y*b.y,q=b.z*b.z,z=b.x*b.y,A=b.x*b.z,B=b.y*b.z,C=b.w*b.x,D=b.w*b.y;b=b.w*b.z;d[0]=1-2*(h+q);d[1]=2*(z-b);d[2]=2*(A+D);d[3]=0;d[4]=2*(z+b);d[5]=1-2*(f+q);d[6]=2*(B-C);d[7]=0;d[8]=2*(A-D);d[9]=2*(B+C);d[10]=1-2*(f+h);d[11]=0;d[12]=0;d[13]=0;d[14]=0;d[15]=1}
function SMatrix4x4_writeData(b,d){var f=this._data;b[d++]=f[0];b[d++]=f[4];b[d++]=f[8];b[d++]=f[12];b[d++]=f[1];b[d++]=f[5];b[d++]=f[9];b[d++]=f[13];b[d++]=f[2];b[d++]=f[6];b[d++]=f[10];b[d++]=f[14];b[d++]=f[3];b[d++]=f[7];b[d++]=f[11];b[d++]=f[15]}function SMatrix4x4_toString(){for(var b=this._data,d=new TString,f=0;4>f;f++){0<f&&d.append("|");for(var h=0;4>h;h++){var q=b[4*f+h];0<h&&d.append(",");d.append(RFloat.format(q,0,null,3,null))}}return d.flush()}
function SOrthoMatrix3d(){SMatrix3d.call(this);this.perspectiveLH=SOrthoMatrix3d_perspectiveLH;this.perspectiveRH=SOrthoMatrix3d_perspectiveRH;this.perspectiveFieldOfViewLH=SOrthoMatrix3d_perspectiveFieldOfViewLH;this.perspectiveFieldOfViewRH=SOrthoMatrix3d_perspectiveFieldOfViewRH;return this}function SOrthoMatrix3d_perspectiveLH(b,d,f,h){var q=this._data;q[0]=2*f/b;q[1]=0;q[2]=0;q[3]=0;q[4]=0;q[5]=2*f/d;q[6]=0;q[7]=0;q[8]=0;q[9]=0;q[10]=h/(h-f);q[11]=1;q[12]=0;q[13]=0;q[14]=f*h/(f-h);q[15]=0}
function SOrthoMatrix3d_perspectiveRH(b,d,f,h){var q=this._data;q[0]=2*f/b;q[1]=0;q[2]=0;q[3]=0;q[4]=0;q[5]=2*f/d;q[6]=0;q[7]=0;q[8]=0;q[9]=0;q[10]=h/(f-h);q[11]=1;q[12]=0;q[13]=0;q[14]=f*h/(f-h);q[15]=0}function SOrthoMatrix3d_perspectiveFieldOfViewLH(b,d,f,h){var q=this._data;b=1/Math.tan(.5*b);q[0]=b/d;q[1]=0;q[2]=0;q[3]=0;q[4]=0;q[5]=b;q[6]=0;q[7]=0;q[8]=0;q[9]=0;q[10]=h/(h-f);q[11]=1;q[12]=0;q[13]=0;q[14]=f*h/(f-h);q[15]=0}
function SOrthoMatrix3d_perspectiveFieldOfViewRH(b,d,f,h){var q=this._data;b=1/Math.tan(.5*b);q[0]=b/d;q[1]=0;q[2]=0;q[3]=0;q[4]=0;q[5]=b;q[6]=0;q[7]=0;q[8]=0;q[9]=0;q[10]=h/(f-h);q[11]=1;q[12]=0;q[13]=0;q[14]=f*h/(h-f);q[15]=0}
function SOutline3(){this.min=new SPoint3;this.max=new SPoint3;this.isEmpty=SOutline3_isEmpty;this.assign=SOutline3_assign;this.setMin=SOutline3_setMin;this.setMax=SOutline3_setMax;this.set=SOutline3_set;this.mergeMin=SOutline3_mergeMin;this.mergeMax=SOutline3_mergeMax;this.mergePoint=SOutline3_mergePoint;this.serialize=SOutline3_serialize;this.unserialize=SOutline3_unserialize;this.toString=SOutline3_toString;return this}
function SOutline3_isEmpty(b){return this.min.isEmpty()&&this.max.isEmpty()}function SOutline3_assign(b){this.min.assign(b.min);this.max.assign(b.max)}function SOutline3_setMin(){this.min.setMax();this.max.setMin()}function SOutline3_setMax(){this.min.setMin();this.max.setMax()}function SOutline3_set(b,d,f,h,q,z){this.min.set(b,d,f);this.max.set(h,q,z)}function SOutline3_mergeMin(b){this.min.mergeMax(b.min);this.max.mergeMin(b.max)}
function SOutline3_mergeMax(b){this.min.mergeMin(b.min);this.max.mergeMax(b.max)}function SOutline3_mergePoint(b,d,f){this.min.mergeMin3(b,d,f);this.max.mergeMax3(b,d,f)}function SOutline3_serialize(b){this.min.serialize(b);this.max.serialize(b)}function SOutline3_unserialize(b){this.min.unserialize(b);this.max.unserialize(b)}function SOutline3_toString(){return"("+this.min+")-("+this.max+")"}
function SOutline3d(){SOutline3.call(this);this.center=new SPoint3;this.distance=new SPoint3;this.radius=0;this.points=Array(24);this.update=SOutline3d_update;this.calculateFrom=SOutline3d_calculateFrom;this.calculate=SOutline3d_calculate;return this}
function SOutline3d_update(){var b=this.min,d=b.x,f=b.y,b=b.z,h=this.max,q=h.x,z=h.y,h=h.z,A=this.points;A[0]=d;A[1]=z;A[2]=b;A[3]=q;A[4]=z;A[5]=b;A[6]=q;A[7]=f;A[8]=b;A[9]=d;A[10]=f;A[11]=b;A[12]=d;A[13]=z;A[14]=h;A[15]=q;A[16]=z;A[17]=h;A[18]=q;A[19]=f;A[20]=h;A[21]=d;A[22]=f;A[23]=h;A=this.center;A.x=.5*(d+q);A.y=.5*(f+z);A.z=.5*(b+h);A=this.distance;A.x=q-d;A.y=z-f;A.z=h-b;d=q-d;f=z-f;b=h-b;this.radius=.5*Math.sqrt(d*d+f*f+b*b)}
function SOutline3d_calculateFrom(b,d){var f=this.points;d.transform(f,0,b.points,0,8);for(var h=minY=minZ=Number.MAX_VALUE,q=maxY=maxZ=-Number.MAX_VALUE,z=0;24>z;){var A=f[z++];A<h&&(h=A);A>q&&(q=A);A=f[z++];A<minY&&(minY=A);A>maxY&&(maxY=A);A=f[z++];A<minZ&&(minZ=A);A>maxZ&&(maxZ=A)}this.min.set(h,minY,minZ);this.max.set(q,maxY,maxZ);this.update()}
function SOutline3d_calculate(b){b=viy=viz=Number.MAX_VALUE;for(var d=vay=vaz=-Number.MAX_VALUE,f=0,h=this.points;24>f;){var q=h[f++];q<b&&(b=q);q>d&&(d=q);q=h[f++];q<viy&&(viy=q);q>vay&&(vay=q);q=h[f++];q<viz&&(viz=q);q>vaz&&(vaz=q)}this.min.set(b,viy,viz);this.max.set(d,vay,vaz);this.center.x=.5*(b+d);this.center.y=.5*(viy+vay);this.center.z=.5*(viz+vaz);b=d-b;d=vay-viy;f=vaz-viz;this.radius=.5*Math.sqrt(b*b+d*d+f*f)}
function SPadding(b,d,f,h){this.left=RInteger.nvl(b);this.top=RInteger.nvl(d);this.right=RInteger.nvl(f);this.bottom=RInteger.nvl(h);this.isEmpty=SPadding_isEmpty;this.reset=SPadding_reset;this.assign=SPadding_assign;this.set=SPadding_set;this.parse=SPadding_parse;this.toString=SPadding_toString;this.dispose=SPadding_dispose;this.dump=SPadding_dump;return this}function SPadding_isEmpty(){return 0==this.left&&0==this.top&&0==this.right&&0==this.bottom}
function SPadding_reset(){this.bottom=this.right=this.top=this.left=0}function SPadding_assign(b){this.left=b.left;this.top=b.top;this.right=b.right;this.bottom=b.bottom}function SPadding_set(b,d,f,h){this.left=b;this.top=d;this.right=f;this.bottom=h}function SPadding_parse(b){var d=b.split(",");if(4==d.length)this.left=parseInt(d[0]),this.top=parseInt(d[1]),this.right=parseInt(d[2]),this.bottom=parseInt(d[3]);else throw new TError(this,"Parse value failure. (value={1})",b);}
function SPadding_toString(){return this.left+","+this.top+","+this.right+","+this.bottom}function SPadding_dispose(){this.bottom=this.right=this.top=this.left=null}function SPadding_dump(b){return RClass.dump(this)+" ["+this.left+","+this.top+","+this.right+","+this.bottom+"]"}
function SPerspectiveMatrix3d(){SMatrix3d.call(this);this.perspectiveLH=SPerspectiveMatrix3d_perspectiveLH;this.perspectiveRH=SPerspectiveMatrix3d_perspectiveRH;this.perspectiveFieldOfViewLH=SPerspectiveMatrix3d_perspectiveFieldOfViewLH;this.perspectiveFieldOfViewRH=SPerspectiveMatrix3d_perspectiveFieldOfViewRH;return this}
function SPerspectiveMatrix3d_perspectiveLH(b,d,f,h){var q=this._data;q[0]=2*f/b;q[1]=0;q[2]=0;q[3]=0;q[4]=0;q[5]=2*f/d;q[6]=0;q[7]=0;q[8]=0;q[9]=0;q[10]=h/(h-f);q[11]=1;q[12]=0;q[13]=0;q[14]=f*h/(f-h);q[15]=0}function SPerspectiveMatrix3d_perspectiveRH(b,d,f,h){var q=this._data;q[0]=2*f/b;q[1]=0;q[2]=0;q[3]=0;q[4]=0;q[5]=2*f/d;q[6]=0;q[7]=0;q[8]=0;q[9]=0;q[10]=h/(f-h);q[11]=1;q[12]=0;q[13]=0;q[14]=f*h/(f-h);q[15]=0}
function SPerspectiveMatrix3d_perspectiveFieldOfViewLH(b,d,f,h){var q=this._data;b=1/Math.tan(.5*b);q[0]=b/d;q[1]=0;q[2]=0;q[3]=0;q[4]=0;q[5]=b;q[6]=0;q[7]=0;q[8]=0;q[9]=0;q[10]=h/(h-f);q[11]=1;q[12]=0;q[13]=0;q[14]=f*h/(f-h);q[15]=0}function SPerspectiveMatrix3d_perspectiveFieldOfViewRH(b,d,f,h){var q=this._data;b=1/Math.tan(.5*b);q[0]=b/d;q[1]=0;q[2]=0;q[3]=0;q[4]=0;q[5]=b;q[6]=0;q[7]=0;q[8]=0;q[9]=0;q[10]=h/(f-h);q[11]=1;q[12]=0;q[13]=0;q[14]=f*h/(h-f);q[15]=0}
function SPlane(b){b||(b=this);b.a=0;b.b=0;b.c=0;b.d=0;b.assign=SPlane_assign;b.set=SPlane_set;b.normalize=SPlane_normalize;b.dot=SPlane_dot;b.toString=SPlane_toString;b.dump=SPlane_dump;return b}function SPlane_assign(b){this.a=b.a;this.b=b.b;this.c=b.c;this.d=b.d}function SPlane_set(b,d,f,h){this.a=b;this.b=d;this.c=f;this.d=h}function SPlane_normalize(){var b=1/Math.sqrt(this.a*this.a+this.b*this.b+this.c*this.c);this.a*=b;this.b*=b;this.c*=b;this.d*=b}
function SPlane_dot(b,d,f){return b*this.a+d*this.b+f*this.c+this.d}function SPlane_toString(){return this.a+","+this.b+","+this.c+","+this.d}function SPlane_dump(){return RClass.dump(this)+" ["+this.toString()+"]"}
function SPoint2(b,d){this.x=RInteger.nvl(b);this.y=RInteger.nvl(d);this.isEmpty=SPoint2_isEmpty;this.equals=SPoint2_equals;this.assign=SPoint2_assign;this.set=SPoint2_set;this.serialize=SPoint2_serialize;this.unserialize=SPoint2_unserialize;this.toString=SPoint2_toString;this.dispose=SPoint2_dispose;this.dump=SPoint2_dump;return this}function SPoint2_isEmpty(){return 0==this.x&&0==this.y}function SPoint2_equals(b){return b?this.x==b.x&&this.y==b.y:!1}
function SPoint2_assign(b){this.x=b.x;this.y=b.y}function SPoint2_set(b,d){this.x=b;this.y=d}function SPoint2_serialize(b){b.writeFloat(this.x);b.writeFloat(this.y)}function SPoint2_unserialize(b){this.x=b.readFloat();this.y=b.readFloat()}function SPoint2_toString(){return this.x+","+this.y}function SPoint2_dispose(){this.y=this.x=null}function SPoint2_dump(){return RClass.dump(this)+" ["+this.x+","+this.y+"]"}
function SPoint3(b,d,f){SValue3.call(this,b,d,f);this.conjugate=SPoint3_conjugate;this.mergeMin=SPoint3_mergeMin;this.mergeMin3=SPoint3_mergeMin3;this.mergeMax=SPoint3_mergeMax;this.mergeMax3=SPoint3_mergeMax3;this.resize=SPoint3_resize;this.slerp=SPoint3_slerp;return this}function SPoint3_conjugate(b){var d=null,d=b?b:new SPoint3;d.x=-this.x;d.y=-this.y;d.z=-this.z;return d}function SPoint3_mergeMin(b){this.x=Math.min(this.x,b.x);this.y=Math.min(this.y,b.y);this.z=Math.min(this.z,b.z)}
function SPoint3_mergeMin3(b,d,f){this.x=Math.min(this.x,b);this.y=Math.min(this.y,d);this.z=Math.min(this.z,f)}function SPoint3_mergeMax(b){this.x=Math.max(this.x,b.x);this.y=Math.max(this.y,b.y);this.z=Math.max(this.z,b.z)}function SPoint3_mergeMax3(b,d,f){this.x=Math.max(this.x,b);this.y=Math.max(this.y,d);this.z=Math.max(this.z,f)}function SPoint3_resize(b,d,f){null!=b&&(this.x+=b);null!=d&&(this.y+=d);null!=f&&(this.z+=f)}
function SPoint3_slerp(b,d,f){this.x=(d.x-b.x)*f+b.x;this.y=(d.y-b.y)*f+b.y;this.z=(d.z-b.z)*f+b.z}function SPoint4(b,d,f,h){SValue4.call(this,b,d,f,h);this.serialize3=SPoint4_serialize3;this.unserialize3=SPoint4_unserialize3;return this}function SPoint4_serialize3(b){b.writeFloat(this.x);b.writeFloat(this.y);b.writeFloat(this.z)}function SPoint4_unserialize3(b){this.x=b.readFloat();this.y=b.readFloat();this.z=b.readFloat()}
function SQuaternion(b){b||(b=this);b.x=0;b.y=0;b.z=0;b.w=1;b.identity=SQuaternion_identity;b.assign=SQuaternion_assign;b.set=SQuaternion_set;b.absolute=SQuaternion_absolute;b.normalize=SQuaternion_normalize;b.conjugate=SQuaternion_conjugate;b.mul=SQuaternion_mul;b.mul2=SQuaternion_mul2;b.translate=SQuaternion_translate;b.slerp=SQuaternion_slerp;b.fromAxisAngle=SQuaternion_fromAxisAngle;b.fromEuler=SQuaternion_fromEuler;b.parseEuler=SQuaternion_parseEuler;b.serialize=SQuaternion_serialize;b.unserialize=
SQuaternion_unserialize;b.clone=SQuaternion_clone;b.toString=SQuaternion_toString;return b}function SQuaternion_identity(){this.x=this.y=this.z=0;this.w=1;return this}function SQuaternion_assign(b){this.x=b.x;this.y=b.y;this.z=b.z;this.w=b.w}function SQuaternion_set(b,d,f,h){this.x=b;this.y=d;this.z=f;this.w=h}function SQuaternion_absolute(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}
function SQuaternion_normalize(){var b=this.absolute();0!=b&&(b=1/b,this.x*=b,this.y*=b,this.z*=b,this.w*=b)}function SQuaternion_conjugate(b){var d=null,d=b?b:new SQuaternion;d.x=-this.x;d.y=-this.y;d.z=-this.z;d.w=this.w;return d}function SQuaternion_mul(b){var d=this.x,f=this.y,h=this.z,q=this.w;this.x=q*b.x+d*b.w+f*b.z-h*b.y;this.y=q*b.y+f*b.w+h*b.x-d*b.z;this.z=q*b.z+h*b.w+d*b.y-f*b.x;this.w=q*b.w-d*b.x-f*b.y-h*b.z}
function SQuaternion_mul2(b,d){this.x=b.w*d.x+b.x*d.w+b.y*d.z-b.z*d.y;this.y=b.w*d.y+b.y*d.w+b.z*d.x-b.x*d.z;this.z=b.w*d.z+b.z*d.w+b.x*d.y-b.y*d.x;this.w=b.w*d.w-b.x*d.x-b.y*d.y-b.z*d.z}function SQuaternion_translate(b,d){var f=new SQuaternion;f.set(b.x,b.y,b.z,0);f.normalize();var h=this.conjugate();f.mul(h);h=this.clone();h.mul(f);f=null;f=d?d:new SVector3;f.set(h.x,h.y,h.z);return f}
function SQuaternion_slerp(b,d,f){var h=b.x*d.x+b.y*d.y+b.z*d.z+b.w*d.w,q=!1;0>h&&(q=!0,h=-h);var z=0,A=0;.999999<h?(z=1-f,A=q?-f:f):(h=Math.acos(h),A=1/Math.sin(h),z=Math.sin((1-f)*h)*A,A=q?-Math.sin(f*h)*A:Math.sin(f*h)*A);this.x=z*b.x+A*d.x;this.y=z*b.y+A*d.y;this.z=z*b.z+A*d.z;this.w=z*b.w+A*d.w}function SQuaternion_fromAxisAngle(b,d){var f=.5*d,h=Math.sin(f);this.x=b.x*h;this.y=b.y*h;this.z=b.z*h;this.w=Math.cos(f)}
function SQuaternion_fromEuler(b,d,f){var h=Math.sin(.5*f);f=Math.cos(.5*f);var q=Math.sin(.5*b);b=Math.cos(.5*b);var z=Math.sin(.5*d);d=Math.cos(.5*d);this.x=f*q*d+h*b*z;this.y=f*b*z-h*q*d;this.z=h*b*d-f*q*z;this.w=f*b*d+h*q*z}
function SQuaternion_parseEuler(b){var d=this.x*this.x,f=this.y*this.y,h=this.z*this.z,q=null,q=b?b:new SVector3;q.x=Math.asin(RFloat.toRange(2*(this.w*this.x-this.y*this.z),-1,1));q.y=Math.atan2(2*(this.w*this.y+this.z*this.x),1-2*(d+f));q.z=Math.atan2(2*(this.w*this.z+this.x*this.y),1-2*(h+d));return q}function SQuaternion_serialize(b){b.writeFloat(this.x);b.writeFloat(this.y);b.writeFloat(this.z);b.writeFloat(this.w)}
function SQuaternion_unserialize(b){this.x=b.readFloat();this.y=b.readFloat();this.z=b.readFloat();this.w=b.readFloat()}function SQuaternion_clone(){var b=new SQuaternion;b.x=this.x;b.y=this.y;b.z=this.z;b.w=this.w;return b}function SQuaternion_toString(){return this.x+","+this.y+","+this.z+","+this.w}function SRange(b,d,f,h){this.x=b;this.y=d;this.width=f;this.height=h;this.dump=SRange_dump;return this}function SRange_reset(){this.bottom=this.right=this.top=this.left=0}
function SRange_assign(b){this.left=b.left;this.top=b.top;this.right=b.right;this.bottom=b.bottom}function SRange_set(b,d,f,h){this.left=b;this.top=d;this.right=f;this.bottom=h}function SRange_setBounds(b,d,f,h){this.left=b;this.top=d;this.right=this.left+f-1;this.bottom=this.top+h-1}function SRange_width(){return this.right-this.left+1}function SRange_setWidth(b){b&&(this.right=this.left+b-1)}function SRange_height(){return this.bottom-this.top+1}
function SRange_setHeight(b){b&&(this.bottom=this.top+b-1)}function SRange_move(b,d){this.left+=b;this.top+=d;this.right+=b;this.bottom+=d}function SRange_inc(b){b=RInt.nvl(b,1);this.left-=b;this.top-=b;this.right+=b;this.bottom+=b}function SRange_dec(b){b=RInt.nvl(b,1);this.left+=b;this.top+=b;this.right-=b;this.bottom-=b}function SRange_dump(b){b=RString.nvlStr(b);b.append(RClass.name(this));b.append(" [",this.x,",",this.y,"-",this.width,",",this.height,"] ");return b}
function SRectangle(){this.position=new SPoint2;this.size=new SSize2;this.left=SRectangle_left;this.top=SRectangle_top;this.right=SRectangle_right;this.bottom=SRectangle_bottom;this.width=SRectangle_width;this.height=SRectangle_height;this.assign=SRectangle_assign;this.setPosition=SRectangle_setPosition;this.setSize=SRectangle_setSize;this.set=SRectangle_set;this.toString=SRectangle_toString;this.dispose=SRectangle_dispose;this.dump=SRectangle_dump;return this}
function SRectangle_left(){return this.position.x}function SRectangle_top(){return this.position.y}function SRectangle_right(){return this.position.x+this.size.width}function SRectangle_bottom(){return this.position.y+this.size.height}function SRectangle_width(){return this.size.width}function SRectangle_height(){return this.size.height}function SRectangle_assign(b){this.position.assign(b.position);this.size.assign(b.size)}function SRectangle_setPosition(b,d,f,h){this.position.set(b,d)}
function SRectangle_setSize(b,d){this.size.set(b,d)}function SRectangle_set(b,d,f,h){this.position.set(b,d);this.size.set(f,h)}function SRectangle_toString(){return this.position.x+","+this.position.y+","+this.size.width+","+this.size.height}function SRectangle_dispose(){this.position=this.position.dispose();this.size=this.size.dispose()}function SRectangle_dump(){return RClass.dump(this)+" ["+this.position.x+","+this.position.y+"-"+this.size.width+","+this.size.height+"]"}
function SSize2(b,d){this.width=RInteger.nvl(b);this.height=RInteger.nvl(d);this.isEmpty=SSize2_isEmpty;this.equalsData=SSize2_equalsData;this.equals=SSize2_equals;this.square=SSize2_square;this.assign=SSize2_assign;this.set=SSize2_set;this.serialize=SSize2_serialize;this.unserialize=SSize2_unserialize;this.parse=SSize2_parse;this.toString=SSize2_toString;this.dispose=SSize2_dispose;this.dump=SSize2_dump;return this}function SSize2_isEmpty(){return 0==this.width&&0==this.height}
function SSize2_equalsData(b,d){return this.width!=b||this.height!=d?!1:!0}function SSize2_equals(b){return this.width!=b.width||this.height!=b.height?!1:!0}function SSize2_square(){return this.width*this.height}function SSize2_assign(b){this.width=b.width;this.height=b.height}function SSize2_set(b,d){this.width=b;this.height=d}function SSize2_serialize(b){b.writeFloat(this.width);b.writeFloat(this.height)}
function SSize2_unserialize(b,d){d||(d=EDataType.Float16);this.width=b.readData(d);this.height=b.readData(d)}function SSize2_parse(b){var d=b.split(",");if(2==d.length)this.width=parseInt(d[0]),this.height=parseInt(d[1]);else throw new TError(this,"Parse value failure. (value={1})",b);}function SSize2_toString(){return this.width+","+this.height}function SSize2_dispose(){this.height=this.width=null}function SSize2_dump(){return RClass.dump(this)+" ["+this.width+","+this.height+"]"}
function SSize3(b,d,f){this.width=RInteger.nvl(b);this.height=RInteger.nvl(d);this.deep=RInteger.nvl(f);this.assign=SSize3_assign;this.set=SSize3_set;this.parse=SSize3_parse;this.toString=SSize3_toString;this.dump=SSize3_dump;return this}function SSize3_assign(b){this.width=b.width;this.height=b.height;this.deep=b.deep}function SSize3_set(b,d,f){this.width=b;this.height=d;this.deep=f}
function SSize3_parse(b){var d=b.split(",");if(3==d.length)this.width=parseInt(d[0]),this.height=parseInt(d[1]),this.deep=parseInt(d[2]);else throw new TError(this,"Parse value failure. (value={1})",b);}function SSize3_toString(){return this.width+","+this.height+","+this.deep}function SSize3_dump(){return RClass.dump(this)+" ["+this.width+","+this.height+","+this.deep+"]"}
function SSquare(b,d,f,h){this.left=RInteger.nvl(left);this.top=RInteger.nvl(top);this.right=RInteger.nvl(right);this.bottom=RInteger.nvl(bottom);this.reset=SSquare_reset;this.assign=SSquare_assign;this.set=SSquare_set;this.setBounds=SSquare_setBounds;this.width=SSquare_width;this.setWidth=SSquare_setWidth;this.height=SSquare_height;this.setHeight=SSquare_setHeight;this.move=SSquare_move;this.inc=SSquare_inc;this.dec=SSquare_dec;this.dump=this.unpack=this.pack=SSquare_dump;return this}
function SSquare_reset(){this.bottom=this.right=this.top=this.left=0}function SSquare_assign(b){this.left=b.left;this.top=b.top;this.right=b.right;this.bottom=b.bottom}function SSquare_set(b,d,f,h){this.left=b;this.top=d;this.right=f;this.bottom=h}function SSquare_setBounds(b,d,f,h){this.left=b;this.top=d;this.right=this.left+f-1;this.bottom=this.top+h-1}function SSquare_width(){return this.right-this.left+1}function SSquare_setWidth(b){b&&(this.right=this.left+b-1)}
function SSquare_height(){return this.bottom-this.top+1}function SSquare_setHeight(b){b&&(this.bottom=this.top+b-1)}function SSquare_move(b,d){this.left+=b;this.top+=d;this.right+=b;this.bottom+=d}function SSquare_inc(b){b=RInt.nvl(b,1);this.left-=b;this.top-=b;this.right+=b;this.bottom+=b}function SSquare_dec(b){b=RInt.nvl(b,1);this.left+=b;this.top+=b;this.right-=b;this.bottom-=b}
function SSquare_dump(b){b=RString.nvlStr(b);b.append(RClass.name(this));b.append(" [",this.left,",",this.top,"-",this.right,",",this.bottom,"] ");b.append("(",this.width(),"-",this.height(),")");return b}
function SValue3(b,d,f){this.x=RRuntime.nvl(b,0);this.y=RRuntime.nvl(d,0);this.z=RRuntime.nvl(f,0);this.isEmpty=SValue3_isEmpty;this.assign=SValue3_assign;this.setMin=SValue3_setMin;this.setMax=SValue3_setMax;this.set=SValue3_set;this.absolute=SValue3_absolute;this.normalize=SValue3_normalize;this.negative=SValue3_negative;this.serialize=SValue3_serialize;this.unserialize=SValue3_unserialize;this.parse=SValue3_parse;this.toString=SValue3_toString;return this}
function SValue3_isEmpty(b){return 0==this.x&&0==this.y&&0==this.z}function SValue3_assign(b){this.x=b.x;this.y=b.y;this.z=b.z}function SValue3_setMin(){this.z=this.y=this.x=Number.MIN_VALUE}function SValue3_setMax(){this.z=this.y=this.x=Number.MAX_VALUE}function SValue3_set(b,d,f){this.x=b;this.y=d;this.z=f}function SValue3_normalize(){var b=this.absolute();0!=b&&(this.x/=b,this.y/=b,this.z/=b)}function SValue3_absolute(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}
function SValue3_negative(b){var d=null,d=b?b:new this.constructor;d.x=-this.x;d.y=-this.y;d.z=-this.z;return d}function SValue3_serialize(b){b.writeFloat(this.x);b.writeFloat(this.y);b.writeFloat(this.z)}function SValue3_unserialize(b){this.x=b.readFloat();this.y=b.readFloat();this.z=b.readFloat()}function SValue3_parse(b){var d=b.split(",");if(3==d.length)this.x=parseFloat(d[0]),this.y=parseFloat(d[1]),this.z=parseFloat(d[2]);else throw new TError(this,"Parse value failure. (value={1})",b);}
function SValue3_toString(){return this.x+","+this.y+","+this.z}function SValue4(b,d,f,h){this.x=RRuntime.nvl(b,0);this.y=RRuntime.nvl(d,0);this.z=RRuntime.nvl(f,0);this.w=RRuntime.nvl(h,1);this.assign=SValue4_assign;this.set=SValue4_set;this.absolute=SValue4_absolute;this.normalize=SValue4_normalize;this.negative=SValue4_negative;this.serialize=SValue4_serialize;this.unserialize=SValue4_unserialize;this.parse=SValue4_parse;this.toString=SValue4_toString;return this}
function SValue4_assign(b){this.x=b.x;this.y=b.y;this.z=b.z;this.w=b.w}function SValue4_set(b,d,f,h){this.x=b;this.y=d;this.z=f;this.w=h}function SValue4_absolute(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}function SValue4_normalize(){var b=this.absolute();0!=b&&(this.x/=b,this.y/=b,this.z/=b,this.w/=w)}function SValue4_negative(b){var d=null,d=b?b:new this.constructor;d.x=-this.x;d.y=-this.y;d.z=-this.z;d.w=-this.w;return d}
function SValue4_serialize(b){b.writeFloat(this.x);b.writeFloat(this.y);b.writeFloat(this.z);b.writeFloat(this.w)}function SValue4_unserialize(b){this.x=b.readFloat();this.y=b.readFloat();this.z=b.readFloat();this.w=b.readFloat()}function SValue4_parse(b){var d=b.split(",");if(4==d.length)this.x=parseFloat(d[0]),this.y=parseFloat(d[1]),this.z=parseFloat(d[2]),this.w=parseFloat(d[3]);else throw new TError(this,"Parse value failure. (value={1})",b);}
function SValue4_toString(){return this.x+","+this.y+","+this.z+","+this.w}function SVector3(b,d,f){SValue3.call(this,b,d,f);this.conjugate=SVector3_conjugate;this.dotPoint3=SVector3_dotPoint3;this.cross=SVector3_cross;this.cross2=SVector3_cross2;this.slerp=SVector3_slerp;this.clone=SVector3_clone;return this}function SVector3_conjugate(b){var d=null,d=b?b:new SVector3;d.x=-this.x;d.y=-this.y;d.z=-this.z;return d}function SVector3_dotPoint3(b){return this.x*b.x+this.y*b.y+this.z*b.z}
function SVector3_cross(b){var d=this.z*b.x-this.x*b.z,f=this.x*b.y-this.y*b.x;this.x=this.y*b.z-this.z*b.y;this.y=d;this.z=f}function SVector3_cross2(b,d){b.x=this.y*d.z-this.z*d.y;b.y=this.z*d.x-this.x*d.z;b.z=this.x*d.y-this.y*d.x}function SVector3_slerp(b,d,f){this.x=(d.x-b.x)*f+b.x;this.y=(d.y-b.y)*f+b.y;this.z=(d.z-b.z)*f+b.z}function SVector3_clone(){var b=new SVector3;b.x=this.x;b.y=this.y;b.z=this.z;return b}
function SVector4(b,d,f,h){SValue4.call(this,b,d,f,h);this.serialize3=SVector4_serialize3;this.unserialize3=SVector4_unserialize3;return this}function SVector4_serialize3(b){b.writeFloat(this.x);b.writeFloat(this.y);b.writeFloat(this.z)}function SVector4_unserialize3(b){this.x=b.readFloat();this.y=b.readFloat();this.z=b.readFloat()}
var RMath=new function(){this.value1=Array(1);this.value2=Array(2);this.value3=Array(3);this.value4=Array(4);this.value9=Array(9);this.value12=Array(12);this.value16=Array(16);this.matrix=this.rectangle=this.vector3=this.vectorBackward=this.vectorForward=this.vectorScale=this.vectorAxisZ=this.vectorAxisY=this.vectorAxisX=null;this.construct=RMath_construct;this.min=RMath_min;this.max=RMath_max;this.sign=RMath_sign;this.construct();return this};
function RMath_construct(){this.vectorAxisX=new SVector3(1,0,0);this.vectorAxisY=new SVector3(0,1,0);this.vectorAxisZ=new SVector3(0,0,1);this.vectorScale=new SVector3(1,1,1);this.vectorForward=new SVector3(0,0,1);this.vectorBackward=new SVector3(0,0,-1);this.vector3=new SVector3;this.rectangle=new SRectangle;this.matrix=new SMatrix3d}function RMath_min(){var b=0,d=arguments.length;if(1<d)for(var b=Number.MAX_VALUE,f=0;f<d;f++){var h=arguments[f];h<b&&(b=h)}return b}
function RMath_max(){var b=0,d=arguments.length;if(1<d)for(var b=Number.MIN_VALUE,f=0;f<d;f++){var h=arguments[f];h>b&&(b=h)}return b}function RMath_sign(b){return 0<b?1:0>b?-1:0}
function AStyle(b,d){AAnnotation.call(this,b);this._annotationCd=EAnnotation.Style;this._duplicate=!0;this._style=d;this.code=AStyle_code;this.style=AStyle_style;this.build=AStyle_build;this.toString=AStyle_toString;if(null==d){var f=null;RString.startsWith(b,"_style")?f=b.substring(6):RString.startsWith(b,"style")&&(f=b.substring(5));if(null==f)throw new TError("Style name is empty.");this._style=f}return this}function AStyle_code(){return this._style}function AStyle_style(){return this._style}
function AStyle_build(b){b[this._name]=null}function AStyle_toString(){return"style="+this._style}
function AStyleIcon(b,d){AAnnotation.call(this,b);this._annotationCd=EAnnotation.Style;this._style=d;this.code=AStyleIcon_code;this.style=AStyleIcon_style;this.build=AStyleIcon_build;this.toString=AStyleIcon_toString;if(null==d){var f=null;RString.startsWith(b,"_style")?f=b.substring(6):RString.startsWith(b,"style")&&(f=b.substring(5));if(null==f)throw new TError("Style name is empty.");this._style=f}return this}function AStyleIcon_code(){return this._style}
function AStyleIcon_style(){return this._style}function AStyleIcon_build(b){b[this._name]=null}function AStyleIcon_toString(){return"style="+this._style}
var EBrowser=new function(){this.Unknown=0;this.Explorer=1;this.FireFox=2;this.Chrome=3;this.Safari=4;return this},EDevice=new function(){this.Unknown=0;this.Pc=1;this.Mobile=2;return this},EEvent=new function(){this.Unknown=0;this.Load=1;this.Process=2;this.EnterFrame=3;this.LeaveFrame=4;this.Enter=5;this.Leave=6;this.Focus=7;this.Blur=8;this.Click=9;this.DoubleClick=10;this.ItemClick=11;this.Selected=12;this.DataChanged=13;this.Result=14;return this},EHttpContent=new function(){this.Binary=1;this.Text=
2;return this},EHttpMethod=new function(){this.Get="GET";this.Post="POST";return this},EHttpStatus=new function(){this.Begin=0;this.Build=1;this.Send=2;this.Receive=3;this.Finish=4;return this},EKeyCode=new function(){this.None=0;this.Esc=27;this.Tab=9;this.Enter=13;this.Shift=16;this.Alt=18;this.Ctrl=17;this.BackSpace=8;this.Space=32;this.Left=37;this.Up=38;this.Right=39;this.Down=40;this.Insert=45;this.Delete=46;this.Home=36;this.End=35;this.PageUp=33;this.PageDown=34;this.F1=112;this.F2=113;this.F3=
114;this.F4=115;this.F5=116;this.F6=117;this.F7=118;this.F8=119;this.F9=120;this.F10=121;this.F11=122;this.F12=123;this.N0=48;this.N1=49;this.N2=50;this.N3=51;this.N4=52;this.N5=53;this.N6=54;this.N7=55;this.N8=56;this.N9=57;this.A=65;this.B=66;this.C=67;this.D=68;this.E=69;this.F=70;this.G=71;this.H=72;this.I=73;this.J=74;this.K=75;this.L=76;this.M=77;this.N=78;this.O=79;this.P=80;this.Q=81;this.R=82;this.S=83;this.T=84;this.U=85;this.V=86;this.W=87;this.X=88;this.Y=89;this.Z=90;this.ControlKeys=
[this.Tab,this.Enter,this.BackSpace,this.Left,this.Up,this.Right,this.Down,this.Insert,this.Delete,this.Home,this.End,this.PageUp,this.PageDown,this.F1,this.F2,this.F3,this.F4,this.F5,this.F6,this.F7,this.F8,this.F9,this.F10,this.F11,this.F12];var b=this.integerCodes={};b[45]=!0;b[190]=!0;for(var d=this.N0;d<=this.N9;d++)b[d]=!0;b=this.floatCodes={};b[45]=!0;b[190]=!0;b[46]=!0;b[189]=!0;for(d=this.N0;d<=this.N9;d++)b[d]=!0;return this},EKeyStatus=new function(){this.Normal=0;this.Press=1;return this},
EMouseButton=new function(){this.Left=0;this.Right=2;this.Middle=3;return this},EMouseCursor=new function(){this.HSize="E-resize";this.VSize="N-resize";return this},EOrientation=new function(){this.Unknown=0;this.Horizontal="H";this.Vertical="V";return this},ESoftware=new function(){this.Unknown=0;this.Window=1;this.Linux=2;this.Android=3;this.Apple=4;return this};
function MAttributeCode(b){b=RClass.inherits(this,b);b._code=null;b.isCode=MAttributeCode_isCode;b.code=MAttributeCode_code;b.setCode=MAttributeCode_setCode;return b}function MAttributeCode_isCode(b){return this._code==b}function MAttributeCode_code(){return this._code}function MAttributeCode_setCode(b){this._code=b}function MAttributeGuid(b){b=RClass.inherits(this,b);b._guid=null;b.guid=MAttributeGuid_guid;b.setGuid=MAttributeGuid_setGuid;return b}
function MAttributeGuid_guid(){return this._guid}function MAttributeGuid_setGuid(b){this._guid=b}function MAttributeLabel(b){b=RClass.inherits(this,b);b._label=null;b.label=MAttributeLabel_label;b.setLabel=MAttributeLabel_setLabel;return b}function MAttributeLabel_label(){return this._label}function MAttributeLabel_setLabel(b){this._label=b}function MAttributeName(b){b=RClass.inherits(this,b);b._name=null;b.name=MAttributeName_name;b.setName=MAttributeName_setName;return b}
function MAttributeName_name(){return this._name}function MAttributeName_setName(b){this._name=b}function MAttributeParent(b){b=RClass.inherits(this,b);b._parent=null;b.parent=MAttributeParent_parent;b.findParent=MAttributeParent_findParent;b.setParent=MAttributeParent_setParent;b.dispose=MAttributeParent_dispose;return b}function MAttributeParent_parent(){return this._parent}
function MAttributeParent_findParent(b){var d=this;if(b)for(;RClass.isClass(d._parent,b);)d=d._parent;else for(;d._parent;)d=d._parent;return d}function MAttributeParent_setParent(b){this._parent=b}function MAttributeParent_dispose(){this._parent=null}function MClone(b){b=RClass.inherits(this,b);b.clone=MClone_clone;return b}function MClone_clone(){var b=RClass.create(this.constructor),d;for(d in this)v=this[d],null!=v&&(RClass.isBaseDataType(v.constructor)||(b[d]=v.clone())),b[d]=v;return b}
function MDataStream(b){b=RClass.inherits(this,b);b._viewer=null;b._endianCd=!1;b._position=0;b.testString=MDataStream_testString;b.readBoolean=MDataStream_readBoolean;b.readInt8=MDataStream_readInt8;b.readInt16=MDataStream_readInt16;b.readInt32=MDataStream_readInt32;b.readInt64=MDataStream_readInt64;b.readUint8=MDataStream_readUint8;b.readUint16=MDataStream_readUint16;b.readUint32=MDataStream_readUint32;b.readUint64=MDataStream_readUint64;b.readFloat=MDataStream_readFloat;b.readDouble=MDataStream_readDouble;
b.readString=MDataStream_readString;b.readData=MDataStream_readData;b.readBytes=MDataStream_readBytes;b.writeBoolean=MDataStream_writeBoolean;b.writeInt8=MDataStream_writeInt8;b.writeInt16=MDataStream_writeInt16;b.writeInt32=MDataStream_writeInt32;b.writeInt64=MDataStream_writeInt64;b.writeUint8=MDataStream_writeUint8;b.writeUint16=MDataStream_writeUint16;b.writeUint32=MDataStream_writeUint32;b.writeUint64=MDataStream_writeUint64;b.writeFloat=MDataStream_writeFloat;b.writeDouble=MDataStream_writeDouble;
b.writeString=MDataStream_writeString;b.writeBytes=MDataStream_writeBytes;return b}function MDataStream_testString(){for(var b=this._position,d=this._viewer.getUint16(b,this._endianCd),b=b+2,f=new TString,h=0;h<d;h++){var q=this._viewer.getUint16(b,this._endianCd),b=b+2;f.push(String.fromCharCode(q))}return f.toString()}function MDataStream_readBoolean(){var b=this._viewer.getInt8(this._position,this._endianCd);this._position++;return 0<b}
function MDataStream_readInt8(){var b=this._viewer.getInt8(this._position,this._endianCd);this._position++;return b}function MDataStream_readInt16(){var b=this._viewer.getInt16(this._position,this._endianCd);this._position+=2;return b}function MDataStream_readInt32(){var b=this._viewer.getInt32(this._position,this._endianCd);this._position+=4;return b}function MDataStream_readInt64(){var b=this._viewer.getInt64(this._position,this._endianCd);this._position+=8;return b}
function MDataStream_readUint8(){var b=this._viewer.getUint8(this._position,this._endianCd);this._position+=1;return b}function MDataStream_readUint16(){var b=this._viewer.getUint16(this._position,this._endianCd);this._position+=2;return b}function MDataStream_readUint32(){var b=this._viewer.getUint32(this._position,this._endianCd);this._position+=4;return b}function MDataStream_readUint64(){var b=this._viewer.getUint64(this._position,this._endianCd);this._position+=8;return b}
function MDataStream_readFloat(){var b=this._viewer.getFloat32(this._position,this._endianCd);this._position+=4;return b}function MDataStream_readDouble(){var b=this._viewer.getFloat64(this._position,this._endianCd);this._position+=8;return b}function MDataStream_readString(){for(var b=this._viewer,d=this._endianCd,f=this._position,h=b.getUint16(f,d),f=f+2,q=new TString,z=0;z<h;z++){var A=b.getUint16(f,d);q.push(String.fromCharCode(A));f+=2}this._position=f;return q.flush()}
function MDataStream_readData(b){switch(b){case EDataType.Int8:return this.readInt8();case EDataType.Int16:return this.readInt16();case EDataType.Int32:return this.readInt32();case EDataType.Int64:return this.readInt64();case EDataType.Uint8:return this.readUint8();case EDataType.Uint16:return this.readUint16();case EDataType.Uint32:return this.readUint32();case EDataType.Uint64:return this.readUint64();case EDataType.Float32:return this.readFloat();case EDataType.Float64:return this.readDouble();
case EDataType.String:return this.readString()}throw new TError(this,"Unknown data cd. (data_cd={1})",b);}
function MDataStream_readBytes(b,d,f){var h=this._viewer;if(!(0>=f)){if(0!=d)throw new TError(this,"Unsupport.");d=this._position;var q=this._endianCd;if(0==f%8){b=new Float64Array(b);f>>=3;for(var z=0;z<f;z++)b[z]=h.getFloat64(d,q),d+=8}else if(0==f%4)for(b=new Uint32Array(b),f>>=2,z=0;z<f;z++)b[z]=h.getUint32(d,q),d+=4;else if(0==f%2)for(b=new Uint16Array(b),f>>=1,z=0;z<f;z++)b[z]=h.getUint16(d,q),d+=2;else for(b=new Uint8Array(b),z=0;z<f;z++)b[z]=h.getUint8(d++,q);this._position=d}}
function MDataStream_writeBoolean(b){this._viewer.setInt8(this._position,0<b?1:0,this._endianCd);this._position++}function MDataStream_writeInt8(b){this._viewer.setInt8(this._position,b,this._endianCd);this._position++}function MDataStream_writeInt16(b){this._viewer.setInt16(this._position,b,this._endianCd);this._position+=2}function MDataStream_writeInt32(b){this._viewer.setInt32(this._position,b,this._endianCd);this._position+=4}
function MDataStream_writeInt64(b){this._viewer.setInt64(this._position,b,this._endianCd);this._position+=8}function MDataStream_writeUint8(b){this._viewer.setUint8(this._position,b,this._endianCd);this._position+=1}function MDataStream_writeUint16(b){this._viewer.setUint16(this._position,b,this._endianCd);this._position+=2}function MDataStream_writeUint32(b){this._viewer.setUint32(this._position,b,this._endianCd);this._position+=4}
function MDataStream_writeUint64(b){this._viewer.setUint64(this._position,b,this._endianCd);this._position+=8}function MDataStream_writeFloat(b){this._viewer.setFloat32(this._position,b,this._endianCd);this._position+=4}function MDataStream_writeDouble(b){this._viewer.setDouble(this._position,b,this._endianCd);this._position+=8}
function MDataStream_writeString(b){var d=this._viewer,f=v.length,h=this._endianCd,q=this._position;d.setUint16(q,f,h);for(var q=q+2,z=0;z<f;z++)d.setUint16(q,b.charCodeAt(z),h),q+=2;this._position=q}
function MDataStream_writeBytes(b,d,f){var h=this._viewer;if(!(0>=f)){if(0!=d)throw new TError("Unsupport.");d=this._position;var q=this._endianCd;if(0==f%8){b=new Float64Array(b);f>>=3;for(var z=0;z<f;z++)h.setFloat64(d,b[z],q),d+=8}else if(0==f%4)for(b=new Uint32Array(b),f>>=2,z=0;z<f;z++)h.setUint32(d,b[z],q),d+=4;else if(0==f%2)for(b=new Uint16Array(b),f>>=1,z=0;z<f;z++)h.setUint16(d,b[z],q),d+=2;else for(b=new Uint8Array(b),z=0;z<f;z++)h.setUint8(d++,b[z],q);this._position=d}}
function MDataView(b){b=RClass.inherits(this,b);b._viewer=null;b._endianCd=0;b.endianCd=MDataView_endianCd;b.setEndianCd=MDataView_setEndianCd;b.getInt8=MDataView_getInt8;b.getInt16=MDataView_getInt16;b.getInt32=MDataView_getInt32;b.getInt64=MDataView_getInt64;b.getUint8=MDataView_getUint8;b.getUint16=MDataView_getUint16;b.getUint32=MDataView_getUint32;b.getUint64=MDataView_getUint64;b.getFloat=MDataView_getFloat;b.getDouble=MDataView_getDouble;b.setInt8=MDataView_setInt8;b.setInt16=MDataView_setInt16;
b.setInt32=MDataView_setInt32;b.setInt64=MDataView_setInt64;b.setUint8=MDataView_setUint8;b.setUint16=MDataView_setUint16;b.setUint32=MDataView_setUint32;b.setUint64=MDataView_setUint64;b.setFloat=MDataView_setFloat;b.setDouble=MDataView_setDouble;return b}function MDataView_endianCd(b){return this._endianCd}function MDataView_setEndianCd(b){this._endianCd=b}function MDataView_getInt8(b){return this._viewer.getInt8(b,this._endianCd)}
function MDataView_getInt16(b){return this._viewer.getInt16(b,this._endianCd)}function MDataView_getInt32(b){return this._viewer.getInt32(b,this._endianCd)}function MDataView_getInt64(b){return this._viewer.getInt64(b,this._endianCd)}function MDataView_getUint8(b){return this._viewer.getUint8(b,this._endianCd)}function MDataView_getUint16(b){return this._viewer.getUint16(b,this._endianCd)}function MDataView_getUint32(b){return this._viewer.getUint32(b,this._endianCd)}
function MDataView_getUint64(b){return this._viewer.getUint64(b,this._endianCd)}function MDataView_getFloat(b){return this._viewer.getFloat32(b,this._endianCd)}function MDataView_getDouble(b){return this._viewer.getFloat64(b,this._endianCd)}function MDataView_setInt8(b,d){this._viewer.setInt8(b,d,this._endianCd)}function MDataView_setInt16(b,d){this._viewer.setInt16(b,d,this._endianCd)}function MDataView_setInt32(b,d){this._viewer.setInt32(b,d,this._endianCd)}
function MDataView_setInt64(b,d){this._viewer.setInt64(b,d,this._endianCd)}function MDataView_setUint8(b,d){this._viewer.setUint8(b,d,this._endianCd)}function MDataView_setUint16(b,d){this._viewer.setUint16(b,d,this._endianCd)}function MDataView_setUint32(b,d){this._viewer.setUint32(b,d,this._endianCd)}function MDataView_setUint64(b,d){this._viewer.setUint64(b,d,this._endianCd)}function MDataView_setFloat(b,d){this._viewer.setFloat32(b,d,this._endianCd)}
function MDataView_setDouble(b,d){this._viewer.setDouble(b,d,this._endianCd)}function MListener(b){b=RClass.inherits(this,b);b._listenerss=null;b.addListener=MListener_addListener;b.setListener=MListener_setListener;b.removeListener=MListener_removeListener;b.clearListeners=MListener_clearListeners;b.clearAllListeners=MListener_clearAllListeners;b.processListener=MListener_processListener;b.dispose=MListener_dispose;return b}
function MListener_addListener(b,d,f){var h=this._listenerss;h||(h=this._listenerss=new TDictionary);var q=h.get(b);q||(q=new TListeners,h.set(b,q));return q.register(d,f)}function MListener_setListener(b,d,f){var h=this._listenerss;h&&(h=h.get(b))&&h.clear();return this.addListener(b,d,f)}function MListener_removeListener(b,d,f){return this._listenerss.get(b).unregister(d,f)}function MListener_clearListeners(b){var d=this._listenerss;d&&(b=d.get(b))&&b.clear()}
function MListener_clearAllListeners(){var b=this._listenerss;if(b)for(var d=b.count(),f=0;f<d;f++){var h=b.at(f);h&&h.clear()}}function MListener_processListener(b,d,f,h,q,z){var A=this._listenerss;A&&(b=A.get(b))&&b.process(d,f,h,q,z)}function MListener_dispose(){var b=this._listenerss;if(b){for(var d=b.count()-1;0<=d;d--)b.at(d).dispose();this._listenerss=RObject.dispose(b)}}
function MListenerLoad(b){b=RClass.inherits(this,b,MListener);b.addLoadListener=MListenerLoad_addLoadListener;b.removeLoadListener=MListenerLoad_removeLoadListener;b.clearLoadListeners=MListenerLoad_clearLoadListeners;b.processLoadListener=MListenerLoad_processLoadListener;return b}function MListenerLoad_addLoadListener(b,d){return this.addListener(EEvent.Load,b,d)}function MListenerLoad_removeLoadListener(b,d){this.removeListener(EEvent.Load,b,d)}
function MListenerLoad_clearLoadListeners(){this.clearListeners(EEvent.Load)}function MListenerLoad_processLoadListener(b,d,f,h,q){this.processListener(EEvent.Load,b,d,f,h,q)}function MListenerProcess(b){b=RClass.inherits(this,b,MListener);b.addProcessListener=MListenerProcess_addProcessListener;b.removeProcessListener=MListenerProcess_removeProcessListener;b.processProcessListener=MListenerProcess_processProcessListener;return b}
function MListenerProcess_addProcessListener(b,d){return this.addListener(EEvent.Process,b,d)}function MListenerProcess_removeProcessListener(b,d){this.removeListener(EEvent.Process,b,d)}function MListenerProcess_processProcessListener(b,d,f,h,q){this.processListener(EEvent.Process,b,d,f,h,q)}
function MMouseCapture(b){b=RClass.inherits(this,b);b.onMouseCaptureStart=RMethod.virtual(b,"onMouseCaptureStart");b.onMouseCapture=RMethod.virtual(b,"onMouseCapture");b.onMouseCaptureStop=RMethod.virtual(b,"onMouseCaptureStop");b.testMouseCapture=RMethod.emptyTrue;return b}function MMouseWheel(b){b=RClass.inherits(this,b);b.onMouseWheel=RClass.register(b,new AEventMouseWheel("onMouseWheel"),RMethod.empty);return b}
function MProperty(b){b=RClass.inherits(this,b);b.propertyAssign=MProperty_propertyAssign;b.propertyLoad=MProperty_propertyLoad;b.propertySave=MProperty_propertySave;return b}function MProperty_propertyAssign(b){var d=RClass.find(this.constructor).annotations(EAnnotation.Property),f;for(f in d){var h=d[f];h.constructor!=Function&&(this[h._name]=b[h._name])}}
function MProperty_propertyLoad(b){var d=RClass.find(this.constructor).annotations(EAnnotation.Property),f;for(f in d){var h=d[f];h.constructor!=Function&&(h._force?h.load(this,b):b.contains(h._linker)?h.load(this,b):null==this[h._name]&&(this[h._name]=h._value))}}function MProperty_propertySave(b){var d=RClass.find(this.constructor).annotations(EAnnotation.Property),f;for(f in d){var h=d[f];h.constructor!=Function&&h.save(this,b)}}function SClickEvent(b){SEvent.call(this,b);return this}
function SEvent(b){this.listener=this.annotation=null;this.sender=b;this.process=this.onProcess=this.ohProcess=this.hSource=this.hSender=this.hEvent=this.source=null;this.dispose=SEvent_dispose;return this}function SEvent_dispose(){for(var b in this)this[b]=null}function SKeyboardEvent(){SEvent.call(this);this.ctrlKey=this.shiftKey=this.altKey=!1;this.keyCode=0;this.attachEvent=SKeyboardEvent_attachEvent;this.cancel=SKeyboardEvent_cancel;return this}
function SKeyboardEvent_attachEvent(b){this.altKey=b.altKey;this.shiftKey=b.shiftKey;this.ctrlKey=b.ctrlKey;this.keyCode=b.keyCode}function SKeyboardEvent_cancel(){this.hEvent.returnValue=!1}function SMouseEvent(){SEvent.call(this);this.button=null;this.ctrlKey=this.altKey=this.mouseRight=this.mouseMiddle=this.mouseLeft=!1;this.deltaZ=this.deltaY=this.deltaX=this.clientY=this.clientX=this.offsetY=this.offsetX=this.y=this.x=0;this.attachEvent=SMouseEvent_attachEvent;return this}
function SMouseEvent_attachEvent(b){var d=this.hSource=RHtml.eventSource(b);d&&(this.source=d.__linker);this.button=b.button;this.mouseLeft=b.button==EMouseButton.Left;this.mouseMiddle=b.button==EMouseButton.Middle;this.mouseRight=b.button==EMouseButton.Right;this.altKey=b.altKey;this.ctrlKey=b.ctrlKey;RBrowser.isBrowser(EBrowser.FireFox)?(this.x=b.pageX,this.y=b.pageY,this.offsetX=b.layerX,this.offsetY=b.layerY):(this.x=b.x,this.y=b.y,this.offsetX=b.offsetX,this.offsetY=b.offsetY);this.clientX=b.clientX;
this.clientY=b.clientY;this.deltaX=b.deltaX;this.deltaY=b.deltaY;this.deltaZ=b.deltaZ}function SResizeEvent(){SEvent.call(this);this.height=this.width=null;this.attachEvent=SResizeEvent_attachEvent;return this}function SResizeEvent_attachEvent(b){if(b=this.hSource=RHtml.eventSource(b))this.source=b.__linker}function SXmlEvent(){SEvent.call(this);this.root=this.document=this.connection=null;return this}
function TDumpItem(){this.link=this.hRow=this.hText=this.hTable=this.hDocument=this.hPanel=this.hParent=null;this.level=0;this.caption=null;this.children=[];this.items=[];this.display=this.innerDisplay=this.loaded=!1;this.create=TDumpItem_create;this.push=TDumpItem_push;this.innerShow=TDumpItem_innerShow;this.show=TDumpItem_show;return this}function TDumpItem_create(){return this.children[this.children.length]=new TDumpItem}function TDumpItem_push(b){this.items[this.items.length]=b}
function TDumpItem_innerShow(b){for(var d=this.items.length,f=0;f<d;f++)RHtml.visibleSet(this.items[f],b);d=this.children.length;for(f=0;f<d;f++){var h=this.children[f];RHtml.visibleSet(h.hRow,b);b?h.show(h.innerDisplay):(h.innerDisplay=h.display,h.show(!1))}}function TDumpItem_show(b){this.display=b;var d=RString.repeat("   ",this.level-1)+(b?" -":" +")+" "+this.caption;this.hText.innerHTML=RHtml.toHtml(d);this.innerShow(b)}
function THtmlItem(){this._link=null;this._links={};this.get=THtmlItem_get;this.set=THtmlItem_set;return this}function THtmlItem_get(b){return this._links[b]}function THtmlItem_set(b,d){this._links[b]=d}function TXmlDocument(){this._root=null;this.create=TXmlDocument_create;this.root=TXmlDocument_root;this.setRoot=TXmlDocument_setRoot;this.xml=TXmlDocument_xml;this.dump=TXmlDocument_dump;return this}
function TXmlDocument_create(b,d,f){var h=new TXmlNode;h._name=b;h._attributes=d;h._value=f;return h}function TXmlDocument_root(){var b=this._root;b||(b=this._root=new TXmlNode,b._name="Configuration");return b}function TXmlDocument_setRoot(b){if(this._root)throw new TError(this,"Root node is already exists.");this._root=b}function TXmlDocument_xml(){var b=new TString;b.append("<?xml version='1.0' encoding='UTF-8'?>");this.root().innerXml(b,0);return b.flush()}
function TXmlDocument_dump(){var b=new TString;b.appendLine(RClass.name(this));this.root().dump(b);return b.flush()}function TXmlNode(b){TNode.call(this,b);this.create=TXmlNode_create;this.innerXml=TXmlNode_innerXml;this.xml=TXmlNode_xml;this.toString=TXmlNode_toString;return this}function TXmlNode_create(b,d){var f=new TXmlNode;f._name=b;f._attributes=d;if(!RClass.isClass(d,TAttributes)){d=arguments;var h=d.length;for(b=1;b<h;b+=2)b+1<h?f.set(d[b],d[b+1]):f._value=d[b]}this.push(f);return f}
function TXmlNode_innerXml(b,d){b.appendRepeat("   ",d);b.append("<",this._name);var f=this._attributes;if(f)for(var h=f.count(),q=0;q<h;q++)b.append(" ",f.name(q),'="'),RXml.buildText(b,f.value(q)),b.append('"');this._nodes||null!=this._value||b.append("/");b.append(">\n");if(f=this._nodes)for(h=f.count(),q=0;q<h;q++)f.get(q).innerXml(b,d+1);RXml.buildText(b,this._value);if(this._nodes||null!=this._value)b.appendRepeat("   ",d),b.append("</",this._name,">"),b.append("\n");return b}
function TXmlNode_xml(){var b=new TString;this.innerXml(b,0);return b.flush()}function TXmlNode_toString(){return this.xml().toString()}function FBytes(b){b=RClass.inherits(this,b,FObject,MDataView);b._memory=null;b.construct=FBytes_construct;b.dispose=FBytes_dispose;return b}function FBytes_construct(){this.__base.FObject.construct.call(this);this._memory=new ArrayBuffer;this._viewer=new DataView(this._memory)}
function FBytes_dispose(){this._viewer=this._memory=null;this.__base.FObject.dispose.call(this)}function FClassFactory(b){b=RClass.inherits(this,b,FObject);b._classes=null;b.construct=FClassFactory_construct;b.register=FClassFactory_register;b.unregister=FClassFactory_unregister;b.create=FClassFactory_create;b.dispose=FClassFactory_dispose;return b}function FClassFactory_construct(){this.__base.FObject.construct.call(this);this._classes=new TDictionary}
function FClassFactory_register(b,d){this._classes.set(b,d)}function FClassFactory_unregister(b){this._classes.set(b,null)}function FClassFactory_create(b){var d=this._classes.get(b);if(!d)throw new TError("Create unregister class. (name={1})",b);return RClass.create(d)}function FClassFactory_dispose(){this._classes=RObject.dispose(this._classes);this.__base.FObject.dispose.call(this)}
function FComponent(b){b=RClass.inherits(this,b,FObject,MAttributeParent,MAttributeCode);b.dispose=FComponent_dispose;return b}function FComponent_dispose(){this.__base.MAttributeParent.dispose.call(this);this.__base.FObject.dispose.call(this)}
function FDataStream(b){b=RClass.inherits(this,b,FObject,MDataView,MDataStream);b._length=0;b._memory=null;b._viewer=null;b.construct=FDataStream_construct;b.length=FDataStream_length;b.setLength=FDataStream_setLength;b.memory=FDataStream_memory;b.flip=FDataStream_flip;b.dispose=FDataStream_dispose;return b}function FDataStream_construct(){this.__base.FObject.construct.call(this)}function FDataStream_length(){return this._length}
function FDataStream_setLength(b){this._length=b;this._memory=new ArrayBuffer(b);this._viewer=new DataView(this._memory)}function FDataStream_memory(){return this._memory}function FDataStream_flip(){this._length=this._position;this._position=0}function FDataStream_dispose(){this._memory=this._viewer=null;this.__base.FObject.dispose.call(this)}function FDataView(b){b=RClass.inherits(this,b,FObject,MDataView,MDataStream);b.link=FDataView_link;b.dispose=FDataView_dispose;return b}
function FDataView_link(b){this._memory=b;this._viewer=new DataView(b)}function FDataView_dispose(){this._memory=this._viewer=null;this.__base.FObject.dispose.call(this)}
function FFileReader(b){b=RClass.inherits(this,b,FObject,MListenerLoad);b._reader=null;b._fileName=null;b._length=0;b._data=null;b._statusLoading=!1;b.ohloadStart=FFileReader_ohLoadStart;b.ohLoad=FFileReader_ohLoad;b.ohLoadEnd=FFileReader_ohLoadEnd;b.ohProgress=FFileReader_ohProgress;b.construct=FFileReader_construct;b.fileName=FFileReader_fileName;b.length=FFileReader_length;b.data=FFileReader_data;b.loadFile=FFileReader_loadFile;b.dispose=FFileReader_dispose;return b}
function FFileReader_ohLoadStart(){}function FFileReader_ohLoad(){}function FFileReader_ohLoadEnd(){var b=this.__linker,d=b._reader;b._statusFree=!0;if(d.error){debugger;RLogger.error(b,"Load file failure. (error={1])",d.error)}else b._length=d.result.byteLength,b._data=d.result,d=new SEvent(b),b.processLoadListener(d),d.dispose()}function FFileReader_ohProgress(){}
function FFileReader_construct(){this.__base.FObject.construct.call(this);var b=this._reader=new FileReader;b.__linker=this;b.onloadstart=this.ohLoadStart;b.onload=this.ohLoad;b.onloadend=this.ohLoadEnd;b.onprogress=this.ohProgress}function FFileReader_fileName(){return this._fileName}function FFileReader_length(){return this._length}function FFileReader_data(){return this._data}function FFileReader_loadFile(b){this._fileName=b.name;this._length=b.size;this._reader.readAsArrayBuffer(b)}
function FFileReader_dispose(){var b=this._reader=new FileReader;b.__linker=null;b.onloadstart=null;b.onload=null;b.onloadend=null;this._data=this._fileName=this._reader=b.onprogress=null;this.__base.MListenerLoad.dispose.call(this);this.__base.FObject.dispose.call(this)}
function FHttpConnection(b){b=RClass.inherits(this,b,FObject,MListenerLoad);b._asynchronous=!1;b._methodCd=EHttpMethod.Get;b._contentCd=EHttpContent.Binary;b._url=null;b._input=null;b._inputData=null;b._output=null;b._outputData=null;b._connection=null;b._contentLength=0;b._statusFree=!0;b.onConnectionSend=FHttpConnection_onConnectionSend;b.onConnectionReady=FHttpConnection_onConnectionReady;b.onConnectionComplete=FHttpConnection_onConnectionComplete;b.construct=FHttpConnection_construct;b.setHeaders=
FHttpConnection_setHeaders;b.inputData=FHttpConnection_inputData;b.setInputData=FHttpConnection_setInputData;b.outputData=FHttpConnection_outputData;b.setOutputData=FHttpConnection_setOutputData;b.content=FHttpConnection_content;b.sendSync=FHttpConnection_sendSync;b.sendAsync=FHttpConnection_sendAsync;b.send=FHttpConnection_send;b.dispose=FHttpConnection_dispose;return b}
function FHttpConnection_onConnectionSend(){var b=this._input;if(b)if(b.constructor==String)this._inputData=b,this._contentLength=b.length;else if(b.constructor==ArrayBuffer)this._inputData=b,this._contentLength=b.byteLength;else throw new TError("Unknown send data type.");}
function FHttpConnection_onConnectionReady(){var b=this._linker;if(b._asynchronous){var d=b._connection;if(d.readyState==EHttpStatus.Finish)if(200==d.status)b.setOutputData(),b.onConnectionComplete();else throw new TError(b,"Connection failure. (url={1})",b._url);}}function FHttpConnection_onConnectionComplete(){this._statusFree=!0;this.processLoadListener(this)}
function FHttpConnection_construct(){var b=this._connection=RXml.createConnection();b._linker=this;b.onreadystatechange=this.onConnectionReady}
function FHttpConnection_setHeaders(){var b=this._connection;this._contentCd==EHttpContent.Binary?RBrowser.isBrowser(EBrowser.Explorer)?(b.setRequestHeader("Accept-Charset","x-user-defined"),b.responseType="arraybuffer"):(b.overrideMimeType("text/plain; charset=x-user-defined"),this._asynchronous&&(b.responseType="arraybuffer")):b.setRequestHeader("content-type","application/x-www-form-urlencoded");RBrowser.isBrowser(EBrowser.Chrome)||0<this._contentLength&&b.setRequestHeader("content-length",this._contentLength)}
function FHttpConnection_inputData(){return this._inputData}function FHttpConnection_setInputData(b){this._inputData=b}function FHttpConnection_outputData(){return this._outputData}function FHttpConnection_setOutputData(){var b=this._connection;this._outputData=this._contentCd==EHttpContent.Binary?b.response:b.responseText}function FHttpConnection_content(){return this._outputData}
function FHttpConnection_sendSync(){var b=this._connection;b.open(this._methodCd,this._url,!1);this.setHeaders(b,0);b.send(this._inputData);this.setOutputData();this.onConnectionComplete();RLogger.info(this,"Send http sync request. (method={1}, url={2})",this._methodCd,this._url)}
function FHttpConnection_sendAsync(){var b=this._connection;b.open(this._methodCd,this._url,!0);this.setHeaders(b,0);b.send(this._inputData);RLogger.info(this,"Send http asynchronous request. (method={1}, url={2})",this._methodCd,this._url)}function FHttpConnection_send(b,d){this._url=b;this._input=d;this._methodCd=null!=d?EHttpMethod.Post:EHttpMethod.Get;this._statusFree=!1;this.onConnectionSend();this._asynchronous?this.sendAsync():this.sendSync();return this.content()}
function FHttpConnection_dispose(){this._outputData=this._output=this._inputData=this._input=null;var b=this._connection;b&&(this._connection=b.onreadystatechange=null);this.__base.MListenerLoad.dispose.call(this);this.__base.FObject.dispose.call(this)}
function FXmlConnection(b){b=RClass.inherits(this,b,FHttpConnection);b._contentCd=EHttpContent.Text;b._inputNode=null;b._outputNode=null;b.onConnectionSend=FXmlConnection_onConnectionSend;b.onConnectionComplete=FXmlConnection_onConnectionComplete;b.content=FXmlConnection_content;return b}
function FXmlConnection_onConnectionSend(){var b=this._input;if(b){var d=null;if(b.constructor==String)d=b,this._inputNode=null;else if(b.constructor==TXmlNode)d=new TXmlDocument,d.setRoot(b),d=d.xml(),this._inputNode=b;else if(b.constructor==TXmlDocument)d=b.xml(),this._inputNode=b.root();else throw new TError("Unknown send data type.");this._inputData=d;this._contentLength=d.length}}
function FXmlConnection_onConnectionComplete(){var b=this._connection,d=null;if(b.responseXML)d=b.responseXML.documentElement;else if(b.responseXml)d=b.responseXml.documentElement;else throw new TError(this,"Fetch xml data failure.");if(!d)return RMessage.fatal(this,null,"Read xml error. (url={1})\n{2}",this._url,b._outputText);b=new TXmlDocument;RXml.buildNode(b,null,d);var f=this._outputNode=b.root();this._statusFree=!0;d=new SXmlEvent;d.connection=this;d.document=b;d.root=f;d.parameters=this._parameters;
this.processLoadListener(d);d.dispose();this._asynchronous&&(this._parameters=this._outputNode=this._output=this._inputNode=this._input=null)}function FXmlConnection_content(){return this._outputNode}function FXmlData(b){b=RClass.inherits(this,b,FObject);b._ready=null;b._config=null;b.testReady=FXmlData_testReady;return b}function FXmlData_testReady(){return this._ready}
var RDump=new function(){this.LINE_SINGLE="------------------------------";this.LINE_DOUBLE="==============================";this.LINE_DOT="..............................";this.LINE_STAR="******************************";this.onclick=RDump_onclick;this.nameInfo=RDump_nameInfo;this.typeInfo=RDump_typeInfo;this.dumpInner=RDump_dumpInner;this.dump=RDump_dump;this.appendLevel=RDump_appendLevel;this.stack=RDump_stack;return this};
function RDump_onclick(){var b=this.link;this.link&&(b.loaded?b.show(!b.display):(RDump.dumpInner(this.link),b.loaded=!0,b.show(!0)))}function RDump_nameInfo(b){switch(RClass.typeOf(b)){case "Unknown":return"@unknown";case "Function":return RMethod.name(b)+"@Function";case "Array":return"@<Array>"}return b}
function RDump_typeInfo(b,d){if(null==b)return"null";switch(d){case "Unknown":return"unknown";case "Undefined":return"undefined";case "Boolean":case "Number":return b.toString();case "String":return b.length+":'"+RString.toLine(b)+"'";case "Function":return b.__virtual?"virtual":RMethod.name(b,!0);case "Array":return"@<Array@"+RClass.code(b)+"> length="+b.length;case "Html":return"@<"+b.tagName+">";default:if(b.constructor==TClass)return"@<"+b.name+"@"+RClass.code(b)+">";if(b.constructor==Function)return"@"+
b.toString();try{for(var f in b)return"@<Object@"+RClass.code(b)+">"}catch(h){}return"<Object@"+RClass.code(b)+">"}}
function RDump_dumpInner(b){var d=b.hTable,f=b.hRow,h=b.level,q=b.link,z=RClass.typeOf(q,!0),A=q.__class,B=[],C;for(C in q)B[B.length]=C;RString.endsWith(z,"Array")?RArray.reverse(B,0,B.length-1):RArray.sort(B,!0);var D=B.length;2E3<D&&(D=2E3);for(var E=0;E<D;E++){C=B[E];var F=q[C];RClass.safeTypeOf(F,!0);var z=RClass.safeTypeOf(F,!0),G=null,I=!0;if(A){var H=A.attributeFind(C);H&&(z="Annotation<"+RMethod.name(H.constructor)+">",G=F&&F.constructor==Function?"<FONT color='green'>"+RMethod.name(F)+"</FONT>":
F+"<FONT color='green'> - ("+RHtml.toHtml(H.toString())+")</FONT>",I=!1)}null==G&&(G=this.typeInfo(F,z));var H=null,K=RBuilder.appendTableRow(d,null,f?f.rowIndex+1:0);K.bgColor="#FFFFFF";RString.startsWith(G,"@")?(K.style.cursor="pointer",K.onclick=this.onclick,K.bgColor="#FFF0E0",H=K.link=b.create(),H.link=F,H.level=h,H.caption=C,H.hTable=d,H.level=h+1,H.hRow=K):b.push(K);"Function"==z&&"virtual"==G&&(K.bgColor="#E0F0FF");var F=RBuilder.appendTableCell(K),J=RString.startsWith(G,"@")?" +":"  ";C=
RString.repeat("   ",h)+J+" "+C;F.innerHTML=RHtml.toHtml(C);F.style.borderBottom="1px solid #F0F0F0";F.width="240px";H&&(H.hText=F);F=RBuilder.appendTableCell(K);F.innerHTML=RHtml.toHtml(z);F.style.borderBottom="1px solid #F0F0F0";F.style.color="Function"==z?"#3333FF":"#FF3333";F.width="200px";F=RBuilder.appendTableCell(K);RString.startsWith(G,"@")&&(G=G.substr(1));F.innerHTML=I?RHtml.toHtml(G):G;F.style.borderBottom="1px solid #F0F0F0"}d.width="100%"}
function RDump_dump(b,d){d||(d=RBuilder.append(null,"DIV"));var f=new TString;f.append("<",RClass.safeTypeOf(b));b&&b.tagName&&f.append(" - ",b.tagName);f.appendLine("@"+RClass.code(b)+">");var h=RBuilder.append(d,"DIV");h.style.border="1px solid #BBBBBB";h.style.backgroundColor="#E0E0EB";var q=RBuilder.appendTable(h,null,null,0,1,0),z=RBuilder.appendTableRow(q),z=RBuilder.appendTableCell(z);q.width="100%";z.style.padding=2;z.style.borderBottom="1px solid gray";z.style.backgroundColor="#E0E0EB";RHtml.textSet(z,
f.toString());f=RBuilder.appendTable(h,null,null,0,1,0);f.style.width="100%";h=new TDumpItem;h.hTable=f;h.hRow=null;h.hParent=d;h.link=b;h.level=0;this.dumpInner(h)}function RDump_appendLevel(b,d){for(var f=0;f<d;f++)b.append("   ")}function RDump_stack(){for(var b=RDump_stack.caller,d=new TString;b;)d.append(RMethod.name(b)),(b=b.caller)&&d.appendLine();RLogger.debug(this,d)}
var REngine=new function(){this._spaces={};this.Global={};this.Top={};this.Local={};this.onRelease=REngine_onRelease;this.register=REngine_register;this.initialize=REngine_initialize;this.connect=REngine_connect;this.buildSpace=REngine_buildSpace;this.find=REngine_find;this.findGlobal=REngine_findGlobal;this.findTop=REngine_findTop;this.findLocal=REngine_findLocal;return this};function REngine_onRelease(){RConsole.release();REvent.release();CollectGarbage()}
function REngine_register(b){var d=this._spaces[b.space];d||(d=this._spaces[b.space]={});d[b.name]=b}function REngine_initialize(){RConsole.initialize()}function REngine_connect(){RConsole.initialize()}function REngine_buildSpace(b,d){for(var f in d)RString.startsWith(f,"R")&&(b[f.substring(1)]=d[f].instance)}function REngine_find(b,d){var f=null;if(b=this._spaces[b])if(f=b[d])return f.instance;return null}function REngine_findGlobal(b){return this.find(ESpace.Global,b)}
function REngine_findTop(b){return top.REngine.find(ESpace.Top,b)}function REngine_findLocal(b){return this.find(ESpace.Local,b)}
var RHtml=new function(){this._nextUid=1;this._links={};this._clientPosition=new SPoint2;this.uid=RHtml_uid;this.fullscreen=RHtml_fullscreen;this.displayGet=RHtml_displayGet;this.displaySet=RHtml_displaySet;this.visibleGet=RHtml_visibleGet;this.visibleSet=RHtml_visibleSet;this.textGet=RHtml_textGet;this.textSet=RHtml_textSet;this.checkGet=RHtml_checkGet;this.checkSet=RHtml_checkSet;this.radioGet=RHtml_radioGet;this.radioSet=RHtml_radioSet;this.cursorSet=RHtml_cursorSet;this.linkGet=RHtml_linkGet;
this.linkSet=RHtml_linkSet;this.clientPosition=RHtml_clientPosition;this.clientX=RHtml_clientX;this.clientY=RHtml_clientY;this.setSize=RHtml_setSize;this.toText=RHtml_toText;this.toHtml=RHtml_toHtml;this.eventSource=RHtml_eventSource;this.get=RHtml_get;this.parent=RHtml_parent;this.searchLinker=RHtml_searchLinker;this.searchObject=RHtml_searchObject;this.tableMoveRow=RHtml_tableMoveRow;this.free=RHtml_free;this.offsetPosition=RHtml_offsetPosition;this.offsetX=RHtml_offsetX;this.offsetY=RHtml_offsetY;
this.scrollWidth=RHtml_scrollWidth;this.scrollHeight=RHtml_scrollHeight;this.point=RHtml_point;this.toPoint=RHtml_toPoint;this.rect=RHtml_rect;this.toRect=RHtml_toRect;this.top=RHtml_top;this.clientRect=RHtml_clientRect;this.offsetRect=RHtml_offsetRect;this.changeWidth=RHtml_changeWidth;this.clear=RHtml_clear;this.setRect=RHtml_setRect;this.setBounds=RHtml_setBounds;this.setPixelRect=RHtml_setPixelRect;this.setPixelBounds=RHtml_setPixelBounds;this.showNodes=RHtml_showNodes;this.hideNodes=RHtml_hideNodes;
this.showChildren=RHtml_showChildren;this.hideChildren=RHtml_hideChildren;this.posParent=RHtml_posParent;this.form=RHtml_form;this.popup=RHtml_popup;this.bodyWidth=RHtml_bodyWidth;this.bodyHeight=RHtml_bodyHeight;this.frameHeight=RHtml_frameHeight;this.selectText=RHtml_selectText;this.currentStyle=RHtml_currentStyle;this.clone=RHtml_clone;return this};function RHtml_uid(b){var d=b.__puuid;null==d&&(d=b.__puuid=RHtml._nextUid++);return d}
function RHtml_fullscreen(b,d){d?b.requestFullscreen?b.requestFullscreen():b.mozRequestFullScreen?b.mozRequestFullScreen():b.webkitRequestFullScreen&&b.webkitRequestFullScreen():b.exitFullscreen?b.exitFullscreen():b.mozCancelFullScreen?b.mozCancelFullScreen():b.webkitCancelFullScreen&&b.webkitCancelFullScreen()}function RHtml_displayGet(b){var d=null;b=b.style.display;return d=RBrowser.isBrowser(EBrowser.Explorer)?"inline"==b:"none"!=b}
function RHtml_displaySet(b,d){var f=null,f=RBrowser.isBrowser(EBrowser.Explorer)?d?"inline":"none":d?null:"none";b.style.display=f}function RHtml_visibleGet(b){var d=null;b=b.style.display;return d=RBrowser.isBrowser(EBrowser.Explorer)?"block"==b:"none"!=b}function RHtml_visibleSet(b,d){var f=null,f=RBrowser.isBrowser(EBrowser.Explorer)?d?"":"none":d?null:"none";b.style.display=f}function RHtml_textGet(b,d){var f=null;return f=RBrowser.isBrowser(EBrowser.FireFox)?b.textContent:b.innerText}
function RHtml_textSet(b,d){RBrowser.isBrowser(EBrowser.FireFox)?b.textContent=d:b.innerText=d}function RHtml_checkGet(b){return RBool.toString(b.checked)}function RHtml_checkSet(b,d){b.checked=RBool.isTrue(d)}function RHtml_radioGet(b){if(b)for(var d=b.length,f=0;f<d;f++){var h=b[f];if(h.checked)return h.value}return null}function RHtml_radioSet(b,d){if(b)for(var f=b.length,h=0;h<f;h++){var q=b[h];if(q.value==d){q.checked=!0;break}}}function RHtml_cursorSet(b,d){b&&(b.style.cursor=d)}
function RHtml_linkGet(b,d){var f=this.uid(b);return(f=this._links[f])?f.get(d):null}function RHtml_linkSet(b,d,f){var h=this._links,q=this.uid(b),z=h[q];z||(z=h[q]=new THtmlItem,z._link=b);z.set(d,f)}function RHtml_clientPosition(b,d){var f=this._clientPosition;for(f.set(0,0);b!=d;)f.x+=b.offsetLeft+b.clientLeft-b.scrollLeft,f.y+=b.offsetTop+b.clientTop-b.scrollTop,b=b.offsetParent;return f}function RHtml_clientX(b,d){for(var f=0;b!=d;)f+=b.offsetLeft-b.scrollLeft,b=b.offsetParent;return f}
function RHtml_clientY(b,d){for(var f=0;b!=d;)f+=b.offsetTop-b.scrollTop,b=b.offsetParent;return f}function RHtml_setSize(b,d){d.width&&(b.style.width=d.width+"px");d.height&&(b.style.height=d.height+"px")}function RHtml_toText(b){null!=b&&(b=b.toString(),b=b.replace(/&lt;/,"<"),b=b.replace(/&gt;/g,">"),b=b.replace(/&nbsp;/g," "),b=b.replace(/<BR>/g,"\n"));return b}
function RHtml_toHtml(b){null!=b&&(b=b.toString(),b=b.replace(/</g,"&lt;"),b=b.replace(/>/g,"&gt;"),b=b.replace(/ /g,"&nbsp;"),b=b.replace(/\n/g,"<BR>"),b=b.replace(/\\n/g,"<BR>"),b=b.replace(/\r/g,""),b=b.replace(/\\r/g,""));return b}function RHtml_eventSource(b){return b.srcElement?b.srcElement:b.target}function RHtml_get(b){return document.getElementById(b)}function RHtml_parent(b,d){if(b&&t)for(d=d.toLowerCase();b;){if(b.tagName.toLowerCase()==d)return b;b=b.parentElement}return null}
function RHtml_searchLinker(b,d){for(;b;){var f=b.__linker;if(f&&RClass.isClass(f,d))return f;b=b.parentElement}return null}function RHtml_searchObject(b,d){for(;b;){var f=b[d];if(f)return f;b=b.parentElement}return null}
function RHtml_tableMoveRow(b,d,f){if("TABLE"!=b.tagName)throw new TError("Html table is invalid.");if(d==f)return!1;if(b.moveRow)b.moveRow(d,f);else{b=b.getElementsByTagName("tbody")[0];var h=b.rows[d],q=b.rows[f];if(null==h||null==q)return!1;var z=null;if(d<=f)for(z=q;(z=z.nextSibling)&&"TR"!=z.tagName;);null==z?b.insertBefore(h,q):null==z?b.appendChild(h):b.insertBefore(h,z)}return!0}function RHtml_free(b){return null}
function RHtml_clone(b,d,f){f||(f=d.cloneNode(!0));d._pname&&(b[d._pname]=f);d._ptyName&&(b[d._ptyName]=f);var h=REvent.find(d).events;f._psource=d;for(var q in h)f[h[q].handle]=d[h[q].handle],f[h[q].handle]&&RHtml.link(f,"_plink",b);d=d.children;for(q=d.length;0<=--q;)RHtml_clone(b,d[q],f.children[q]);return f}
function RHtml_offsetPosition(b,d){for(var f=new TPoint;b!=d;)f.x+=b.offsetLeft-b.scrollLeft,f.y+=b.offsetTop-b.scrollTop,RHtml.currentStyle(b),f.x+=b.clientLeft,f.y+=b.clientTop,b=b.offsetParent;return f}function RHtml_offsetX(b){for(var d=0;b;)d+=b.offsetLeft,b=b.offsetParent;return d}function RHtml_offsetY(b){for(var d=0;b;)d+=b.offsetTop,b=b.offsetParent;return d}function RHtml_bodyWidth(b){return b.all?b.body.scrollWidth:b.documentElement.scrollWidth}
function RHtml_bodyHeight(b){return b.all?b.body.scrollHeight:b.documentElement.scrollHeight}function RHtml_frameHeight(b){b=b.contentWindow.document;return Math.max(b.body.scrollHeight,b.documentElement.scrollHeight)}function RHtml_scrollWidth(b){var d=0;b.offsetWidth&&(d+=b.offsetWidth);b.borderTopWidth&&(d-=parseInt(b.borderLeftWidth));b.borderBottomWidth&&(d-=parseInt(b.borderRightWidth));b.clientWidth&&(d-=b.clientWidth);return d}
function RHtml_scrollHeight(b){var d=0;b.offsetHeight&&(d+=b.offsetHeight);b.borderTopWidth&&(d-=parseInt(b.borderTopWidth));b.borderBottomWidth&&(d-=parseInt(b.borderBottomWidth));b.clientHeight&&(d-=b.clientHeight);return d}function RHtml_currentStyle(b){return b.currentStyle?b.currentStyle:window.getComputedStyle(b,null)}function RHtml_point(b,d){return this.toPoint(new TPoint,b,d)}
function RHtml_toPoint(b,d,f){if(b&&d){f=RObject.nvl(f,window.document.body);var h=RHtml.currentStyle(d);b.x=-RInt.parse(h.borderLeftWidth);for(b.y=-RInt.parse(h.borderTopWidth);d&&d!=f;)b.x+=d.offsetLeft-d.scrollLeft,b.y+=d.offsetTop-d.scrollTop,"absolute"!=RHtml.currentStyle(d).position&&(b.x+=d.clientLeft,b.y+=d.clientTop),d=d.offsetParent}return b}function RHtml_rect(b,d){return this.toRect(new TRect,b,d)}
function RHtml_toRect(b,d,f){if(b&&d){f=RObject.nvl(f,window.document.body);var h=RHtml.currentStyle(d);b.left=-RInt.parse(h.borderLeftWidth);b.top=-RInt.parse(h.borderTopWidth);for(var h=d.offsetWidth,h=d.offsetWidth-1,q=d.offsetHeight,q=d.offsetHeight-1;d&&d!=f;)b.left+=d.offsetLeft-d.scrollLeft,b.top+=d.offsetTop-d.scrollTop,"absolute"!=RHtml.currentStyle(d).position&&(b.left+=d.clientLeft,b.top+=d.clientTop),d=d.offsetParent;b.right=b.left+h;b.bottom=b.top+q}return b}
function RHtml_top(b){var d=0;if(b)for(d=RHtml.currentStyle(o),d=-RInteger.parse(d.borderTopWidth);b;)d+=b.offsetTop-b.scrollTop,"absolute"!=RHtml.currentStyle(o).position&&(d+=b.clientTop),b=b.offsetParent;return d}function RHtml_clientRect(b){if(b){for(var d=0,f=0,h=b.offsetWidth-1,q=b.offsetHeight-1;b;)d+=b.offsetLeft,f+=b.offsetTop,b=b.offsetParent;return new TRect(d,f,d+h,f+q)}return null}
function RHtml_offsetRect(b){if(b){for(var d=0,f=0,h=b.offsetWidth-1,q=b.offsetHeight-1;b;)d+=b.offsetLeft+b.clientLeft,f+=b.offsetTop+b.clientTop,b=b.offsetParent;return new TRect(d,f,d+h,f+q)}return null}function RHtml_clear(b){if(b){var d=b.children;if(d&&d.length)for(var f=d.length-1;0<=f;f--){var h=d[f];h.children&&h.children.length&&this.clear(h);b.removeChild(h)}}}function RHtml_setRect(b,d){if(b&&b.style){var f=b.style;f.left=d.left;f.top=d.top;f.width=d.width();f.height=d.height()}}
function RHtml_setBounds(b,d,f,h,q){b&&b.style&&(b=b.style,null!=d&&(b.left=d),null!=f&&(b.top=f),null!=h&&(b.width=h),null!=q&&(b.height=q))}function RHtml_setPixelRect(b,d){if(b&&b.style){var f=b.style;f.pixelLeft=d.left;f.pixelTop=d.top;f.pixelWidth=d.width();f.pixelHeight=d.height()}}function RHtml_setPixelBounds(b,d,f,h,q){b&&b.style&&(b=b.style,null!=d&&(b.pixelLeft=d),null!=f&&(b.pixelTop=f),null!=h&&(b.pixelWidth=h),null!=q&&(b.pixelHeight=q))}
function RHtml_changeWidth(b,d){if(b&&d){var f=RHtml.currentStyle(d),f=parseInt(f.paddingLeft)+parseInt(f.paddingRight);d.style.pixelWidth=b.offsetWidth-f}}function RHtml_showNodes(b,d){if(b&&b.childNodes)for(var f=0;f<b.childNodes.length;f++){var h=b.childNodes(f);h.tagName&&h.style?h.style.display="block":"#text"==h.nodeName&&(h.nodeValue=d[f])}}
function RHtml_hideNodes(b,d){if(b&&b.childNodes)for(var f=0;f<b.childNodes.length;f++){var h=b.childNodes(f);h.tagName&&h.style?h.style.display="none":"#text"==h.nodeName&&(d[f]=h.nodeValue,h.nodeValue="")}}function RHtml_showChildren(b){if(b&&b.children)for(var d=0;d<b.children.length;d++){var f=b.children(d);f.tagName&&f.style&&(f.style.display="block")}}
function RHtml_hideChildren(b){if(b&&b.children)for(var d=0;d<b.children.length;d++){var f=b.children(d);f.tagName&&f.style&&(f.style.display="none")}}function RHtml_posParent(b){for(;b;){if("visible"!=b.currentStyle.overflow)return b;b=b.offsetParent}return null}function RHtml_form(b){if(b){var d=this.parent(b,"FORM");return d?d:b.ownerDocument.forms[0]}return window.document.forms[0]}
function RHtml_popup(b,d,f){d=RString.format("left={0},top={1},width={2},height={3},toolbar=no,location=no,directories=no,status=no,menubar=no,resizable=yes,scrollbars=yes,dependent=yes",(screen.width-d)/2,(screen.height-f)/2-20,d,f);window.open(b,"_blank",d)}function RHtml_selectText(){document.getElementById(id).select();return document.selection.createRange().text}function getTRNode(b,d){for(;(b=b[d])&&"TR"!=b.tagName;);return b}
var RKeyboard=new function(){this._status=[];this.onKeyDown=RKeyboard_onKeyDown;this.onKeyUp=RKeyboard_onKeyUp;this.construct=RKeyboard_construct;this.isControlKey=RKeyboard_isControlKey;this.isIntegerKey=RKeyboard_isIntegerKey;this.isFloatKey=RKeyboard_isFloatKey;this.isNumKey=RKeyboard_isNumKey;this.isPress=RKeyboard_isPress;this.fixCase=RKeyboard_fixCase;this.fixPattern=RKeyboard_fixPattern;this.fixChars=RKeyboard_fixChars;return this};
function RKeyboard_onKeyDown(b){this._status[b.keyCode]=EKeyStatus.Press}function RKeyboard_onKeyUp(b){this._status[b.keyCode]=EKeyStatus.Normal}function RKeyboard_construct(){for(var b=this._status,d=0;256>d;d++)b[d]=EKeyStatus.Normal;RWindow.lsnsKeyDown.register(this,this.onKeyDown);RWindow.lsnsKeyUp.register(this,this.onKeyUp)}function RKeyboard_isControlKey(b){for(var d=EKeyCode.ControlKeys,f=d.length-1;0<=f;f--)if(d[f]==b)return!0;return!1}
function RKeyboard_isIntegerKey(b){return EKeyCode.integerCodes[b]}function RKeyboard_isFloatKey(b){return EKeyCode.floatCodes[b]}function RKeyboard_isNumKey(b){return 96<=p&&105>=p?!0:!1}function RKeyboard_isPress(b){return this._status[b]==EKeyStatus.Press}function RKeyboard_fixCase(b,d){if(b&&d){var f=b.keyCode;ECase.Upper==d?f=String.fromCharCode(f).toUpperCase().charCodeAt(0):ECase.Lower==d&&(f=String.fromCharCode(f).toLowerCase().charCodeAt(0));b.keyCode=f}}
function RKeyboard_fixPattern(b,d){if(d){var f=b.keyCode;if(!this.isControlKeyPress(f)&&!RString.isPattern(String.fromCharCode(f),d))return b.keyCode=0,!1}return!0}function RKeyboard_fixChars(b,d){if(d){var f=b.keyCode;this.isNumKey(f)&&(f=b.keyCode-=48);if(!this.isControlKeyPress(f)&&!RString.inChars(String.fromCharCode(f),d))return b.keyCode=0,b.returnValue=!1}return!0}
var RLoader=new function(){this._loading=new TArray;this._loaded=new TArray;this._waits=new TArray;this.hWindow=this._intervalId=null;this.onInterval=RLoader_onInterval;this.intervalStart=RLoader_intervalStart;this.intervalStop=RLoader_intervalStop;this.loadJsFile=RLoader_loadJsFile;this.loadJs=RLoader_loadJs;this.loaded=RLoader_loaded;this.wait=RLoader_wait;this.waitJs=RLoader_waitJs;this.dispose=RLoader_dispose;return this};function RLoader_dispose(){this.intervalStop();this.hWindow=null}
function RLoader_onInterval(){for(var b=this._waits,d=b.length,f=0;f<d;f++){var h=b.get(f);h&&h.check(this._loaded)&&(h.invoke.invoke(),b.set(f,null))}b.compress();b.isEmpty()&&this.intervalStop()}function RLoader_intervalStart(){var b=this;b._intervalId||(b.hWindow=window,b._intervalId=window.setInterval(function(){b.onInterval()},10))}function RLoader_intervalStop(){var b=this.hWindow;b&&this._intervalId&&(b.clearInterval(this._intervalId),this._intervalId=this.hWindow=null)}
function RLoader_loadJsFile(b,d){var f=this,h=RWindow.hDocument,q=h.getElementsByTagName("head")[0];if(null==document.getElementById(b)){var z=top.RContext.location(d),A=RWindow.createElement("SCRIPT");A.id=b;A.type="text/javascript";A.src=z;h.attachEvent?A.onreadystatechange=function(){var d=A.readyState;if("loaded"==d||"complete"==d)A.onreadystatechange=null,f._loading.extract(b),f._loaded.push(b)}:A.onload=function(){"complete"==h.readyState&&(A.onload=null,f._loading.extract(b),f._loaded.push(b))};
q.appendChild(A)}}function RLoader_loadJs(b){for(var d=arguments,f=d.length,h=0;h<f;h++){var q=d[h];this.loadJsFile("js:"+q,"/ajs/"+q.replace(/\./g,"/")+".js")}}function RLoader_loaded(b){this._loading.extract(b);this._loaded.push(b)}function RLoader_wait(b,d){var f=new TLoaderListener;f.invoke=b;for(var h=arguments.length,q=1;q<h;q++)f.ids.push(arguments[q]);this._waits.push(f);this.intervalStart()}
function RLoader_waitJs(b,d){var f=new TLoaderListener;f.invoke=b;for(var h=arguments,q=h.length,z=1;z<q;z++)f.ids.push("js:"+h[z]);this._waits.push(f);this.intervalStart()}var RMessage=new function(){this._hasError=!1;this._messages=null;this.push=RMessage_push;this.fatal=RMessage_fatal;this.confirmResult=!1;this.error=RMessage_error;this.warn=RMessage_warn;this.onWindowClose=RMessage_onWindowClose;this.confirm=RMessage_confirm;this.info=RMessage_info;return this};
function RMessage_push(b){this._messages||(this._messages=new FLoopList);this._messages.push(b)}
function RMessage_fatal(b,d,f,h){if(!this._hasError){this._hasError=!0;for(var q=new TString,z=[],A=RMessage_fatal.caller;A&&!RArray.contains(z,A);)z.push(A),A=A.caller;for(var B=z.length,C=0;C<B;C++)A=z[C],0<C&&q.appendLine(),q.append("   "+(B-C)+": "+RMethod.name(A));z=new TString;z.appendLine(RContext.get("RMessage:fatal"));z.appendLine(RString.repeat("-",60));z.append(RClass.dump(b),": ");if(f)for(A=arguments,B=A.length,C=3;C<B;C++){var D=A[C];"function"==typeof D&&(D=RMethod.name(D));f=f.replace("{"+
(C-2)+"}",D)}z.appendLine(f);z.appendLine(RString.repeat("-",60));z.appendLine("Stack:");z.append(q);alert(z)}}function RMessage_error(b,d,f,h){if(!this._hasError)throw this._hasError=!0,Error(f);}function RMessage_warn(b,d,f){new TString;b=top.RControl.create(FAlertWindow);b.setText(d);b.show()}function RMessage_info(b,d,f){new TString;b=top.RControl.create(FInfoWindow);b.setText(d);b.show()}
function RMessage_confirm(b,d){var f=top.RControl.create(FConfirmWindow);f.setText(b);f.lsns.register(this,d);f.show()}function RMessage_onWindowClose(b){this.confirmResult=b}var RResource=new function(){this.uriIcon="/ars/icon/";this.uriImage="/ars/img/";this.iconPath=RResource_iconPath;this.iconUrlPath=RResource_iconUrlPath;this.imagePath=RResource_imagePath;return this};
function RResource_iconPath(b,d){b=RString.nvl(b,"n").replace(/\./g,"/")+"."+RString.nvl(d,"gif");return RBrowser.contentPath("/ars/icon/"+b)}function RResource_iconUrlPath(b,d){b=RString.nvl(b,"n").replace(/\./g,"/")+"."+RString.nvl(d,"gif");return RBrowser.contentPath("/ars/icon/"+b)}function RResource_imagePath(b,d){}var RStyle=new function(){this._connected=!1;this._rules=new TMap;this.connect=RStyle_connect;this.has=RStyle_has;this.nvl=RStyle_nvl;this.style=RStyle_style;return this};
function RStyle_connect(){if(!this._connected){for(var b=this._rules,d=document.styleSheets,f=d.length,h=0;h<f;h++){var q=d[h].cssRules;if(q)for(var z=q.length,A=0;A<z;A++){var B=q[A];b.set(B.selectorText,B)}}this._connected=!0}}function RStyle_has(b){this._connected||this.connect();return b?this._rules.contains("."+b.toLowerCase()):!1}function RStyle_nvl(b,d){this.connect();var f=arguments,h=f.length;for(d=0;d<h;d++)if((b=f[d])&&this._rules.contains("."+b.toLowerCase()))return b;return null}
function RStyle_style(b,d){return RClass.name(b)+"_"+d}var RTypeArray=new function(){this._float4=this._float3=null;this._data={};this.float3=RTypeArray_float3;this.float4=RTypeArray_float4;this.createArray=RTypeArray_createArray;this.findTemp=RTypeArray_findTemp;return this};function RTypeArray_float3(){var b=this._float3;null==b&&(b=this._float3=new Float32Array(3));return b}function RTypeArray_float4(){var b=this._float4;null==b&&(b=this._float4=new Float32Array(4));return b}
function RTypeArray_createArray(b,d){switch(b){case EDataType.Boolean:case EDataType.Int8:return new Int8Array(d);case EDataType.Int16:return new Int16Array(d);case EDataType.Int32:return new Int32Array(d);case EDataType.Int64:return new Int64Array(d);case EDataType.Uint8:return new Uint8Array(d);case EDataType.Uint16:return new Uint16Array(d);case EDataType.Uint32:return new Uint32Array(d);case EDataType.Float32:return new Float32Array(d);case EDataType.Float64:return new Float64Array(d)}throw new TError("Create unknown type array. (type={1}, length={2})",
b,d);}function RTypeArray_findTemp(b,d){var f=this._data,h=f[b];null==h&&(h=f[b]={});f=h[d];null==f&&(f=h[d]=this.createArray(b,d));return f}function FTag(b){b=RClass.inherits(this,b,FObject);b._name="Tag";b._children=null;b._trimLeft=!1;b._trimRight=!1;b.onBegin=FTag_onBegin;b.onEnd=FTag_onEnd;b.name=FTag_name;b.set=FTag_set;b.push=FTag_push;b.parse=FTag_parse;b.toString=FTag_toString;b.innerDump=FTag_innerDump;b.dump=FTag_dump;return b}function FTag_onBegin(b){return EResult.Continue}
function FTag_onEnd(b){return EResult.Continue}function FTag_name(){return this._name}function FTag_set(b,d){throw new TError(this,"Unknown attribute name. (name={1}, value={2})",b,d);}function FTag_push(b){var d=this._children;null==d&&(d=this._children=new TObjects);d.push(b)}
function FTag_parse(b){var d=this.onBegin(b);if(d==EResult.Continue){var f=this._children;if(f)for(var h=f.count(),q=0;q<h;q++){var z=f.get(q),d=z.parse(b);if(d==EResult.Cancel)return d;b._trimLeft=z._trimLeft;b._trimRight=z._trimRight}return this.onEnd(b)}return d}function FTag_toString(){return null}
function FTag_innerDump(b,d,f){b.appendRepeat("   ",f);b.append(RClass.dump(d));var h=d.toString();RString.isEmpty(h)||b.append(" [",h,"]");if(d=d._children){b.append("\n");for(var h=d.count(),q=0;q<h;q++){var z=d.get(q);this.innerDump(b,z,f+1);q<h-1&&b.append("\n")}}}function FTag_dump(){var b=new TString;this.innerDump(b,this,0);return b.toString()}
function FTagContext(b){b=RClass.inherits(this,b,FObject,MInstance);b._trimLeft=!1;b._trimRight=!1;b._attributes=null;b._source=null;b.construct=FTagContext_construct;b.instanceAlloc=FTagContext_instanceAlloc;b.attributes=FTagContext_attributes;b.get=FTagContext_get;b.set=FTagContext_set;b.setBoolean=FTagContext_setBoolean;b.source=FTagContext_source;b.write=FTagContext_write;b.resetSource=FTagContext_resetSource;b.dispose=FTagContext_dispose;return b}
function FTagContext_construct(){this.__base.FObject.construct.call(this);this._attributes=new TAttributes;this._source=new TString}function FTagContext_instanceAlloc(b){this._attributes.clear()}function FTagContext_attributes(){return this._attributes}function FTagContext_get(b,d){return this._attributes.get(b,d)}function FTagContext_set(b,d){this._attributes.set(b,d)}function FTagContext_setBoolean(b,d){this._attributes.set(b,RBoolean.toString(d))}
function FTagContext_source(){return this._source.toString()}function FTagContext_write(b){RString.isEmpty(b)||this._source.append(b)}function FTagContext_resetSource(b){this._source.clear()}function FTagContext_dispose(){this._attributes.dispose();this._attributes=null;this._source.dispose();this._source=null;this.__base.FObject.dispose.call(this)}
function FTagDocument(b){b=RClass.inherits(this,b,FObject);b._space=null;b._root=null;b.space=FTagDocument_space;b.setSpace=FTagDocument_setSpace;b.create=FTagDocument_create;b.root=FTagDocument_root;b.loadNode=FTagDocument_loadNode;b.load=FTagDocument_load;b.parse=FTagDocument_parse;b.dump=FTagDocument_dump;return b}function FTagDocument_space(){return this._space}function FTagDocument_setSpace(b){this._space=b}
function FTagDocument_create(b){var d=this._space+"_",f=null,f=RString.startsWith(b,d)?b.substring(d.length):b;b=null;switch(f){case "source":b=RClass.create(FTag);break;case "write":b=RClass.create(FTagWrite);break;case "true":b=RClass.create(FTagTrue);break;case "false":b=RClass.create(FTagFalse);break;case "equals":b=RClass.create(FTagEquals);break;case "notEquals":b=RClass.create(FTagNotEquals);break;default:throw new TError(this,"Unknown tag type. (name={1})",f);}return b}
function FTagDocument_root(){return this._root}
function FTagDocument_loadNode(b,d){var f=this.create(d.nodeName);b?b.push(f):this._root=f;var h=d.attributes;if(h)for(var q=h.length,z=0;z<q;z++){var A=h[z];A.nodeName&&f.set(A.nodeName,RXml.formatText(A.value))}if(h=d.childNodes)for(q=h.length,z=0;z<q;z++)switch(A=h[z],A.nodeType){case ENodeType.Text:var B=RClass.create(FTagText);B.setText(A.nodeValue);f.push(B);break;case ENodeType.Data:B=RClass.create(FTagText);B.setText(A.data);f.push(B);break;case ENodeType.Node:this.loadNode(f,A)}}
function FTagDocument_load(b){b=("<source>"+b+"</source>").replace(new RegExp("<"+this._space+":","g"),"<"+this._space+"_");b=b.replace(new RegExp("</"+this._space+":","g"),"</"+this._space+"_");b=b.replace(RegExp(" & ","g")," &amp; ");b=b.replace(RegExp(" < ","g")," &lt; ");b=b.replace(RegExp(" > ","g")," &gt; ");b=RXml.makeString(b);this.loadNode(null,b.firstChild)}function FTagDocument_parse(b){b.resetSource();this._root.parse(b);return b.source()}
function FTagDocument_dump(){var b=new TString;b.appendLine(RClass.dump(this));b.appendLine(this.root().dump(b));return b.toString()}function FTagEquals(b){b=RClass.inherits(this,b,FTag);b._trimLeft=!0;b._source=null;b._value=null;b.onBegin=FTagEquals_onBegin;b.set=FTagEquals_set;b.toString=FTagEquals_toString;return b}
function FTagEquals_onBegin(b){var d=!1;b=b.get(this._source);for(var f=this._value.split("|"),h=f.length,q=0;q<h;q++)if(b==f[q]){d=!0;break}return d?EResult.Continue:EResult.Skip}function FTagEquals_set(b,d){switch(b){case "source":this._source=d;return;case "value":this._value=d;return}this.__base.FTag.set.call(this,b,d)}function FTagEquals_toString(){return"source="+this._source+", value="+this._value}
function FTagFalse(b){b=RClass.inherits(this,b,FTag);b._trimLeft=!0;b._source=null;b.onBegin=FTagFalse_onBegin;b.set=FTagFalse_set;b.toString=FTagFalse_toString;return b}function FTagFalse_onBegin(b){b=b.get(this._source);return RBoolean.parse(b)?EResult.Skip:EResult.Continue}function FTagFalse_set(b,d){switch(b){case "source":this._source=d;return}this.__base.FTag.set.call(this,b,d)}function FTagFalse_toString(){return"source="+this._source}
function FTagNotEquals(b){b=RClass.inherits(this,b,FTag);b._trimLeft=!0;b._source=null;b._value=null;b.onBegin=FTagNotEquals_onBegin;b.set=FTagNotEquals_set;b.toString=FTagNotEquals_toString;return b}function FTagNotEquals_onBegin(b){var d=!0;b=b.get(this._source);for(var f=this._value.split("|"),h=f.length,q=0;q<h;q++)if(b==f[q]){d=!1;break}return d?EResult.Continue:EResult.Skip}
function FTagNotEquals_set(b,d){switch(b){case "source":this._source=d;return;case "value":this._value=d;return}this.__base.FTag.set.call(this,b,d)}function FTagNotEquals_toString(){return"source="+this._source+", value="+this._value}function FTagText(b){b=RClass.inherits(this,b,FTag);b._text=null;b.onBegin=FTagText_onBegin;b.text=FTagText_text;b.setText=FTagText_setText;b.toString=FTagText_toString;return b}
function FTagText_onBegin(b){var d=this._text;b._trimLeft&&(RString.startsWith(d,"\r")&&(d=d.substring(1)),RString.startsWith(d,"\n")&&(d=d.substring(1)));b._trimRight&&(RString.endsWith(d,"\r")&&(d=d.substring(0,d.length-1)),RString.endsWith(d,"\n")&&(d=d.substring(0,d.length-1)));b.write(d);return EResult.Skip}function FTagText_text(){return this._text}function FTagText_setText(b){this._text=b}function FTagText_toString(){return"{"+this._text+"}"}
function FTagTrue(b){b=RClass.inherits(this,b,FTag);b._trimLeft=!0;b._source=null;b.onBegin=FTagTrue_onBegin;b.set=FTagTrue_set;b.toString=FTagTrue_toString;return b}function FTagTrue_onBegin(b){for(var d=!1,f=this._source.split("|"),h=f.length,q=0;q<h;q++){var z=b.get(f[q]);if(RBoolean.parse(z)){d=!0;break}}return d?EResult.Continue:EResult.Skip}function FTagTrue_set(b,d){switch(b){case "source":this._source=d;return}this.__base.FTag.set.call(this,b,d)}
function FTagTrue_toString(){return"source="+this._source}function FTagWrite(b){b=RClass.inherits(this,b,FTag);b._source=null;b.onBegin=FTagWrite_onBegin;b.set=FTagWrite_set;b.toString=FTagWrite_toString;return b}function FTagWrite_onBegin(b){var d=b.get(this._source);b.write(d);return EResult.Skip}function FTagWrite_set(b,d){switch(b){case "source":this._source=d;return}this.__base.FTag.set.call(this,b,d)}function FTagWrite_toString(){return"source="+this._source}
var EThreadStatus=new function(){this.Sleep=0;this.Active=1;this.Finish=2;return this};function SProcessEvent(){this.data=this.code=this.index=null;return this}function SXmlEvent(){this.callback=this.outputDocument=this.inputDocument=this.parameter=this.action=this.url=this.owner=null;this.process=SXmlEvent_process;this.dispose=SXmlEvent_dispose;return this}
function SXmlEvent_process(b){this.outputDocument=b.document;this.outputNode=b.root;this.owner?this.callback.call(this.owner,this):this.callback(this)}function SXmlEvent_dispose(){this.callback=this.outputDocument=this.inputDocument=this.parameter=this.action=this.url=this.owner=null}function FContent(b){b=RClass.inherits(this,b,FObject);b._name=null;b.name=FContent_name;return b}function FContent_name(){return this._name}
function FContentConsole(b){b=RClass.inherits(this,b,FConsole);b._scopeCd=EScope.Local;b.connections=null;b.onLoad=FContentConsole_onLoad;b.construct=FContentConsole_construct;b.alloc=FContentConsole_alloc;b.process=FContentConsole_process;b.send=FContentConsole_send;return b}function FContentConsole_construct(){this.connections=new TObjects}function FContentConsole_onLoad(){var b=this.event;b.document=this.document;b.process();this.document=this.event=null;this._statusFree=!0}
function FContentConsole_alloc(){for(var b=null,d=this.connections,f=d.count-1;0<=f;f--){var h=d.get(f);if(h._statusFree){b=h;break}}b||(b=RClass.create(FXmlConnection),d.push(b),b.onLoad=this.onLoad);b._statusFree=!1;return b}
function FContentConsole_process(b){var d=this.alloc();d.event=b;switch(b.code){case EXmlEvent.Send:d.send(b.url,b.document);break;case EXmlEvent.Receive:d.receive(b.url,b.document);break;case EXmlEvent.SyncSend:return d.syncSend(b.url,b.document);case EXmlEvent.SyncReceive:return d.syncReceive(b.url,b.document)}}function FContentConsole_send(b,d){var f=this.alloc(),h=f.syncSend(b,d);f._statusFree=!0;return h}
function FContentPipeline(b){b=RClass.inherits(this,b,FPipeline);b._scopeCd=EScope.Global;b.scopeCd=FContentPipeline_scopeCd;return b}function FContentPipeline_scopeCd(){return this._scopeCd}
function FDragConsole(b){b=RClass.inherits(this,b,FConsole);b._scopeCd=EScope.Local;b._activeDragable=null;b._dragables=null;b.onMouseDown=FDragConsole_onMouseDown;b.onMouseMove=FDragConsole_onMouseMove;b.onMouseUp=FDragConsole_onMouseUp;b.construct=FDragConsole_construct;b.register=FDragConsole_register;b.unregister=FDragConsole_unregister;b.clear=FDragConsole_clear;return b}
function FDragConsole_onMouseDown(b){var d=b.source;d&&RClass.isClass(d,MUiDragable)&&(RWindow.setOptionSelect(!1),this._activeDragable=d,d.onDragStart(b))}function FDragConsole_onMouseMove(b){if(this._activeDragable)this._activeDragable.onDragMove(b)}function FDragConsole_onMouseUp(b){this._activeDragable&&(RWindow.setOptionSelect(!0),this._activeDragable.onDragStop(b),this._activeDragable=null)}
function FDragConsole_construct(){this.__base.FConsole.construct.call(this);this._dragables=new TObjects;RWindow.lsnsMouseDown.register(this,this.onMouseDown);RWindow.lsnsMouseMove.register(this,this.onMouseMove);RWindow.lsnsMouseUp.register(this,this.onMouseUp)}function FDragConsole_register(b){this._dragables.push(b)}function FDragConsole_unregister(b,d){this._dragables.remove(p)}function FDragConsole_clear(){this._dragables.clear()}
function FEvent(b){b=RClass.inherits(this,b,FObject);b._owner=null;b._callback=null;b._valid=!0;b.owner=FEvent_owner;b.setOwner=FEvent_setOwner;b.callback=FEvent_callback;b.setCallback=FEvent_setCallback;b.valid=FEvent_valid;b.setValid=FEvent_setValid;b.process=FEvent_process;return b}function FEvent_owner(){return this._owner}function FEvent_setOwner(b){this._owner=b}function FEvent_callback(){return this._callback}function FEvent_setCallback(b){this._callback=b}
function FEvent_valid(){return this._valid}function FEvent_setValid(b){this._valid=b}function FEvent_process(){if(this._valid){var b=this._owner;b?this._callback.call(b,this):this._callback(this)}}
function FEventConsole(b){b=RClass.inherits(this,b,FConsole);b._scopeCd=EScope.Local;b._thread=null;b._interval=100;b._processEvents=null;b._events=null;b.onProcess=FEventConsole_onProcess;b.construct=FEventConsole_construct;b.register=FEventConsole_register;b.push=FEventConsole_push;b.clear=FEventConsole_clear;return b}
function FEventConsole_onProcess(){var b=this._events;if(!b.isEmpty()){var d=this._processEvents;d.assign(b);b.clear();b=d.count();if(0<b){for(var f=0;f<b;f++)d.get(f).process();d.clear()}}}
function FEventConsole_construct(){this.__base.FConsole.construct.call(this);this._processEvents=new TObjects;this._events=new TObjects;var b=this._thread=RClass.create(FThread);b.setInterval(this._interval);b.lsnsProcess.register(this,this.onProcess);RConsole.find(FThreadConsole).start(b);RLogger.debug(this,"Add event thread. (thread={1})",RClass.dump(b))}function FEventConsole_register(b,d){var f=RClass.create(FEvent);f.owner=b;f.callback=d;this._events.push(f)}
function FEventConsole_push(b){var d=this._events;d.contains(b)||d.push(b)}function FEventConsole_clear(){this._events.clear()}function FHttpConsole(b){b=RClass.inherits(this,b,FConsole);b._scopeCd=EScope.Local;b._pool=null;b.onLoad=FHttpConsole_onLoad;b.construct=FHttpConsole_construct;b.alloc=FHttpConsole_alloc;b.send=FHttpConsole_send;b.dispose=FHttpConsole_dispose;return b}function FHttpConsole_onLoad(b){this._pool.free(b)}
function FHttpConsole_construct(){this.__base.FConsole.construct.call(this);this._pool=RClass.create(FObjectPool)}function FHttpConsole_alloc(){var b=this._pool;if(!b.hasFree()){var d=RClass.create(FHttpConnection);d._asynchronous=!0;this._pool.push(d)}d=b.alloc();d.clearLoadListeners();d.addLoadListener(this,this.onLoad);return d}function FHttpConsole_send(b,d){var f=this.alloc();f.send(b,d);return f}function FHttpConsole_dispose(){this.__base.FConsole.dispose.call(this)}
function FIdleConsole(b){b=RClass.inherits(this,b,FConsole);b.scope=EScope.Page;b.register=FIdleConsole_register;return b}function FIdleConsole_register(b,d){this.active=new TActive(b,d);this.active.interval=100;RConsole.find(FActiveConsole).push(this.active)}function FIdleConsole_construct(){}
function FLoggerConsole(b){b=RClass.inherits(this,b,FConsole);b.scope=EScope.Page;b.iLogger=null;b.onKeyDown=FLoggerConsole_onKeyDown;b.construct=FLoggerConsole_construct;b.connect=FLoggerConsole_connect;b.disconnect=FLoggerConsole_disconnect;b.output=FLoggerConsole_output;return b}function FLoggerConsole_onKeyDown(b){b.shiftKey&&b.ctrlKey&&EKey.L==b.keyCode&&this.connect()}
function FLoggerConsole_construct(){this.base.FConsole.construct.call(this);RWindow.lsnsKeyDown.register(this,this.onKeyDown)}function FLoggerConsole_connect(){}function FLoggerConsole_disconnect(){this.iLogger=null}function FLoggerConsole_output(b,d,f,h,q,z){this.iLogger&&(d=RClass.dump(d),h&&(d+=" ("+h+"ms)"),b=b+" ["+RString.rpad(d,36)+"] ",b=z?b+(RString.rpad(q,120)+" ["+z+"]"):b+q,this.iLogger.Output(b))}
function FLoggerConsole_xml(){this.environment||this.connect();return this.environment?this.environment.xml():null}
function FMonitorConsole(b){b=RClass.inherits(this,b,FConsole);b.scope=EScope.Global;b.working=!1;b.interval=10;b.intervalId=null;b.monitors=new TList;b.hWindow=null;b.doInterval=FMonitorConsole_doInterval;b.push=FMonitorConsole_push;b.process=FMonitorConsole_process;b.processAll=FMonitorConsole_processAll;b.startup=FMonitorConsole_startup;b.wait=FMonitorConsole_wait;b.release=FMonitorConsole_release;return b}
function FMonitorConsole_push(b){this.startup();b.id=this.monitors.sync(b);b.name="T:"+RString.lpad(b.id,4,"0");b.status=EMonitor.Active}function FMonitorConsole_process(b){if(b)switch(b.status){case EMonitor.Active:b.process(this.interval);break;case EMonitor.Cancel:this.monitors.removeItem(b)}}function FMonitorConsole_processAll(){this.working=!0;for(var b=this.monitors,d=0;d<b.count;d++)this.process(b.get(d));this.working=!1}
function FMonitorConsole_doInterval(){var b=RGlobal.get(FMonitorConsole);b&&!b.working&&b.processAll()}function FMonitorConsole_startup(){this.hWindow||(this.hWindow=window,this.intervalId=this.hWindow.setInterval(this.doInterval,this.interval))}function FMonitorConsole_wait(b){}function FMonitorConsole_release(){this.hWindow&&this.intervalId&&this.hWindow.clearInterval(this.intervalId)}
function FMouseConsole(b){b=RClass.inherits(this,b,FConsole);b._scopeCd=EScope.Local;b._activeCapture=null;b.onMouseDown=FMouseConsole_onMouseDown;b.onMouseMove=FMouseConsole_onMouseMove;b.onMouseUp=FMouseConsole_onMouseUp;b.construct=FMouseConsole_construct;b.captureStart=FMouseConsole_captureStart;b.capture=FMouseConsole_capture;b.captureStop=FMouseConsole_captureStop;b.register=FMouseConsole_register;b.unregister=FMouseConsole_unregister;b.clear=FMouseConsole_clear;return b}
function FMouseConsole_onMouseDown(b){var d=RHtml.searchLinker(b.hSource,MMouseCapture);d&&d.testMouseCapture()&&(this._activeCapture=d,this.captureStart(b))}function FMouseConsole_onMouseMove(b){this._activeCapture&&this.capture(b)}function FMouseConsole_onMouseUp(b){this._activeCapture&&this.captureStop(b)}
function FMouseConsole_construct(){this.__base.FConsole.construct.call(this);RWindow.lsnsMouseDown.register(this,this.onMouseDown);RWindow.lsnsMouseMove.register(this,this.onMouseMove);RWindow.lsnsMouseUp.register(this,this.onMouseUp)}function FMouseConsole_captureStart(b){var d=this._activeCapture;d&&(RWindow.setOptionSelect(!1),d.onMouseCaptureStart(b))}function FMouseConsole_capture(b){var d=this._activeCapture;if(d)if(d.testMouseCapture())d.onMouseCapture(b);else this.captureStop(b)}
function FMouseConsole_captureStop(b){var d=this._activeCapture;d&&(d.onMouseCaptureStop(b),this._activeCapture=null);RWindow.setOptionSelect(!0)}function FMouseConsole_register(b){}function FMouseConsole_unregister(b){}function FMouseConsole_clear(){}function FPipeline(b){b=RClass.inherits(this,b,FObject);b._code=null;b.code=FPipeline_code;return b}function FPipeline_code(){return this._code}
function FProcess(b){b=RClass.inherits(this,b,FObject);b._name=null;b._source=null;b._worker=null;b._events=null;b.ohMessage=FProcess_ohMessage;b.onMessage=FProcess_onMessage;b.construct=FProcess_construct;b.name=FProcess_name;b.start=FProcess_start;b.process=FProcess_process;return b}function FProcess_ohMessage(){this.__linker.onMessage(this)}function FProcess_onMessage(b){}function FProcess_name(){return this._name}
function FProcess_construct(){this.__base.FObject.construct.call(this);this._events=new TObjects}function FProcess_start(b){if(this._worker)throw new TError(this,"Process is already start.");this._source=b;b=this._worker=new Worker(b);b.__linker=this;b.onmessage=this.ohMessage}function FProcess_process(b){var d=this._events,f=d.count();d.push(b);d=new SProcessEvent;d.index=f;d.code=b.code();d.data=b.data();this._worker.postMessage(d)}
function FProcessConsole(b){b=RClass.inherits(this,b,FConsole);b._scopeCd=EScope.Local;b.connections=null;b.onLoad=FProcessConsole_onLoad;b.construct=FProcessConsole_construct;b.alloc=FProcessConsole_alloc;b.process=FProcessConsole_process;b.send=FProcessConsole_send;return b}function FProcessConsole_construct(){this.connections=new TObjects}function FProcessConsole_onLoad(){var b=this.event;b.document=this.document;b.process();this.document=this.event=null;this._statusFree=!0}
function FProcessConsole_alloc(){for(var b=null,d=this.connections,f=d.count-1;0<=f;f--){var h=d.get(f);if(h._statusFree){b=h;break}}b||(b=RClass.create(FXmlConnection),d.push(b),b.onLoad=this.onLoad);b._statusFree=!1;return b}
function FProcessConsole_process(b){var d=this.alloc();d.event=b;switch(b.code){case EXmlEvent.Send:d.send(b.url,b.document);break;case EXmlEvent.Receive:d.receive(b.url,b.document);break;case EXmlEvent.SyncSend:return d.syncSend(b.url,b.document);case EXmlEvent.SyncReceive:return d.syncReceive(b.url,b.document)}}function FProcessConsole_send(b,d){var f=this.alloc(),h=f.syncSend(b,d);f._statusFree=!0;return h}
function FProcessEvent(b){b=RClass.inherits(this,b,FObject);b._code=null;b._data=null;b._listeners=null;b.code=FProcessEvent_code;b.setCode=FProcessEvent_setCode;b.data=FProcessEvent_data;b.setData=FProcessEvent_setData;b.register=FProcessEvent_register;return b}function FProcessEvent_name(){return this._name}function FProcessEvent_code(){return this._code}function FProcessEvent_setCode(b){this._code=b}function FProcessEvent_data(){return this._data}
function FProcessEvent_setData(b){this._data=b}function FProcessEvent_register(b,d){this._listeners||(this._listeners=new TListeners);this._listeners.register(b,d)}function FProcessor(b){b=RClass.inherits(this,b,FObject);b._name=null;b._source=null;b._worker=null;b._events=null;b.ohMessage=FProcessor_ohMessage;b.onMessage=FProcessor_onMessage;b.construct=FProcessor_construct;b.name=FProcessor_name;b.start=FProcessor_start;b.process=FProcessor_process;return b}
function FProcessor_ohMessage(){this.__linker.onMessage(this)}function FProcessor_onMessage(b){}function FProcessor_name(){return this._name}function FProcessor_construct(){this.__base.FObject.construct.call(this);this._events=new TObjects}function FProcessor_start(b){if(this._worker)throw new TError(this,"Process is already start.");this._source=b;b=this._worker=new Worker(b);b.__linker=this;b.onmessage=this.ohMessage}
function FProcessor_process(b){var d=this._events,f=d.count();d.push(b);d=new SProcessEvent;d.index=f;d.code=b.code();d.data=b.data();this._worker.postMessage(d)}
function FProcessServer(b){b=RClass.inherits(this,b,FObject);b._name=null;b._handle=null;b._processors=null;b.ohInterval=FProcessServer_ohInterval;b.onInterval=FProcessServer_onInterval;b.ohMessage=FProcessServer_ohMessage;b.onMessage=FProcessServer_onMessage;b.construct=FProcessServer_construct;b.name=FProcessServer_name;b.registerProcessor=FProcessServer_registerProcessor;b.unregisterProcessor=FProcessServer_unregisterProcessor;b.send=FProcessServer_send;b.process=FProcessServer_process;return b}
function FProcessServer_ohInterval(){FProcessServer.__linker.onInterval()}function FProcessServer_onInterval(){}function FProcessServer_ohMessage(b){FProcessServer.__linker.onMessage(b.data)}function FProcessServer_onMessage(b){console.log("messgae",this,b)}function FProcessServer_construct(){this.__base.FObject.construct.call(this);this._processors=new TDictionary}function FProcessServer_name(){return this._name}function FProcessServer_registerProcessor(b,d){this._processors.set(b,d)}
function FProcessServer_unregisterProcessor(b){this._processors.set(b,null)}function FProcessServer_send(b){postMessage(b)}function FProcessServer_process(){onmessage=this.ohMessage;FProcessServer.__linker=this}function FStatistics(b){b=RClass.inherits(this,b,FObject);b._code=null;b.reset=FStatistics_reset;b.resetFrame=FStatistics_resetFrame;return b}function FStatistics_reset(){}function FStatistics_resetFrame(){}
function FStatisticsConsole(b){b=RClass.inherits(this,b,FConsole);b._scopeCd=EScope.Local;b._statisticses=null;b.construct=FStatisticsConsole_construct;b.register=FStatisticsConsole_register;b.unregister=FStatisticsConsole_unregister;b.find=FStatisticsConsole_find;b.statisticses=FStatisticsConsole_statisticses;b.reset=FStatisticsConsole_reset;b.resetFrame=FStatisticsConsole_resetFrame;return b}function FStatisticsConsole_construct(){this._statisticses=new TDictionary}
function FStatisticsConsole_register(b,d){this._statisticses.set(b,d)}function FStatisticsConsole_unregister(b){return this._statisticses.remove(b)}function FStatisticsConsole_find(b){return this._statisticses.get(b)}function FStatisticsConsole_statisticses(){return this._statisticses}function FStatisticsConsole_reset(b){b=this._statisticses;for(var d=b.count()-1;0<=d;d--)b.getAt(d).reset()}
function FStatisticsConsole_resetFrame(b,d){for(var f=this._statisticses,h=f.count()-1;0<=h;h--)f.getAt(h).resetFrame()}function FThread(b){b=RClass.inherits(this,b,FObject,MListenerProcess);b._name=null;b._statusCd=EThreadStatus.Sleep;b._interval=100;b._delay=0;b.construct=FThread_construct;b.name=FThread_name;b.statusCd=FThread_statusCd;b.interval=FThread_interval;b.setInterval=FThread_setInterval;b.start=FThread_start;b.stop=FThread_stop;b.process=FThread_process;return b}
function FThread_construct(){this.__base.FObject.construct.call(this)}function FThread_name(){return this._name}function FThread_statusCd(){return this._statusCd}function FThread_interval(){return this._interval}function FThread_setInterval(b){this._interval=b}function FThread_start(){this._statusCd=EThreadStatus.Active}function FThread_stop(){this._statusCd=EThreadStatus.Finish}
function FThread_process(b){0>=this._delay?(this.processProcessListener(this),this._delay=this._interval):this._delay-=b}
function FThreadConsole(b){b=RClass.inherits(this,b,FConsole);b._scopeCd=EScope.Local;b._active=!0;b._interval=20;b._threads=null;b._hWindow=null;b._hIntervalId=null;b.ohInterval=FThreadConsole_ohInterval;b.construct=FThreadConsole_construct;b.push=FThreadConsole_push;b.start=FThreadConsole_start;b.process=FThreadConsole_process;b.processAll=FThreadConsole_processAll;b.dispose=FThreadConsole_dispose;return b}function FThreadConsole_ohInterval(){RConsole.get(FThreadConsole).processAll()}
function FThreadConsole_push(b){this._threads.push(b)}function FThreadConsole_start(b){b.start();this._threads.push(b)}function FThreadConsole_construct(){this.__base.FConsole.construct.call(this);this._threads=new TObjects;this._hWindow=window;this._hIntervalId=this._hWindow.setInterval(this.ohInterval,this._interval)}
function FThreadConsole_process(b){if(b)switch(b.statusCd()){case EThreadStatus.Active:b.process(this._interval);break;case EThreadStatus.Finish:b.dispose(),this._threads.remove(b)}}function FThreadConsole_processAll(){if(this._active)for(var b=this._threads,d=b.count(),f=0;f<d;f++){var h=b.get(f);this.process(h)}}function FThreadConsole_dispose(){var b=this._hWindow;if(b){var d=this._hIntervalId;d&&(b.clearInterval(d),this._hIntervalId=null);this._hWindow=null}}
function FXmlConsole(b){b=RClass.inherits(this,b,FConsole);b._scopeCd=EScope.Local;b._connections=null;b._caches=null;b.onLoad=FXmlConsole_onLoad;b.construct=FXmlConsole_construct;b.alloc=FXmlConsole_alloc;b.send=FXmlConsole_send;b.sendAsync=FXmlConsole_sendAsync;b.load=FXmlConsole_load;b.process=FXmlConsole_process;return b}function FXmlConsole_construct(){this._connections=new TObjects;this._caches=new TDictionary}function FXmlConsole_onLoad(b){debugger}
function FXmlConsole_alloc(){for(var b=null,d=this._connections,f=d.count-1;0<=f;f--){var h=d.get(f);if(h._statusFree){b=h;break}}b||(b=RClass.create(FXmlConnection),d.push(b),b.onLoad=this.onLoad);b._statusFree=!1;b.clearLoadListeners();return b}function FXmlConsole_send(b,d){var f=this.alloc();f._asynchronous=!1;var h=f.send(b,d);f._statusFree=!0;return h}function FXmlConsole_sendAsync(b,d,f){var h=this.alloc();h._asynchronous=!0;h._parameters=f;h.send(b,d);return h}
function FXmlConsole_load(b,d,f){var h=this._caches.get(b);if(h)return h;var q=this.alloc();q._asynchronous=!0;q._parameters=f;h=q._cache=RClass.create(FXmlData);q.send(b,d);this._caches.set(b,h);return h}function FXmlConsole_process(b){if(b.constructor!=SXmlEvent)throw new TError("Parameter type is invalid.");var d=this.alloc();d._asynchronous=!0;d.send(b.url,b.inputDocument);d.addLoadListener(b,b.process);return d}
function SBrowserCapability(){this.blobCreate=this.optionStorage=this.optionProcess=!1;return this}
function FImage(b){b=RClass.inherits(this,b,FObject,MListenerLoad);b._optionAlpha=!0;b._ready=!1;b._size=null;b._url=null;b._hImage=null;b.ohLoad=FImage_ohLoad;b.ohError=FImage_ohError;b.construct=FImage_construct;b.optionAlpha=FImage_optionAlpha;b.setOptionAlpha=FImage_setOptionAlpha;b.size=FImage_size;b.image=FImage_image;b.url=FImage_url;b.testReady=FImage_testReady;b.loadUrl=FImage_loadUrl;b.dispose=FImage_dispose;return b}
function FImage_ohLoad(){var b=this.__linker,d=b._hImage;b._size.set(d.naturalWidth,d.naturalHeight);b._ready=!0;d=new SEvent(b);b.processLoadListener(d);d.dispose()}function FImage_ohError(b){b=this.__linker;RLogger.error(b,"Load image failure. (url={1})",b._url)}function FImage_construct(){this.__base.FObject.construct.call(this);this._size=new SSize2}function FImage_optionAlpha(){return this._optionAlpha}function FImage_setOptionAlpha(b){this._optionAlpha=b}
function FImage_size(){return this._size}function FImage_image(){return this._hImage}function FImage_url(){return this._url}function FImage_testReady(){return this._ready}function FImage_loadUrl(b){this._url=b;var d=this._hImage;d||(d=this._hImage=new Image,d.__linker=this,d.onload=this.ohLoad,d.onerror=this.ohError);d.src=b}
function FImage_dispose(){this._size=RObject.dispose(this._size);this._hImage=RHtml.free(this._hImage);this.__base.MListenerLoad.dispose.call(this);this.__base.FObject.dispose.call(this)}function FWindowStorage(b){b=RClass.inherits(this,b,FObject);b._scopeCd=null;b._storage=null;b.scopeCd=FWindowStorage_scopeCd;b.link=FWindowStorage_link;b.get=FWindowStorage_get;b.set=FWindowStorage_set;b.remove=FWindowStorage_remove;b.clear=FWindowStorage_clear;b.innerDump=FWindowStorage_innerDump;return b}
function FWindowStorage_scopeCd(){return this._scopeCd}function FWindowStorage_link(b){this._storage=b}function FWindowStorage_get(b){return this._storage.getItem(b)}function FWindowStorage_set(b,d){this._storage.setItem(b,d)}function FWindowStorage_remove(b){this._storage.removeItem(b)}function FWindowStorage_clear(){this._storage.clear()}function FWindowStorage_innerDump(b,d){for(var f=this._storage,h=f.length,q=0;q<h;q++){var z=f.key(q),A=f.getItem(z);0<q&&b.append(";");b.append(z+"="+A)}}
var RApplication=new function(){this._workspaces=new TDictionary;this.initialize=RApplication_initialize;this.findWorkspace=RApplication_findWorkspace;this.release=RApplication_release;return this};function RApplication_initialize(){RBrowser.construct();RWindow.connect(window);RKeyboard.construct()}function RApplication_findWorkspace(b){var d=RClass.name(b),f=this._workspaces,h=f.get(d);null==h&&(h=RClass.create(b),f.set(d,h));return h}
function RApplication_release(){try{CollectGarbage()}catch(b){RLogger.error(b)}}
var RBrowser=new function(){this._capability=null;this._deviceCd=EDevice.Unknown;this._softwareCd=ESoftware.Unknown;this._typeCd=EBrowser.Unknown;this._supportHtml5=!1;this._contentPath=this._hostPath="";this.onLog=RBrowser_onLog;this.construct=RBrowser_construct;this.capability=RBrowser_capability;this.supportHtml5=RBrowser_supportHtml5;this.hostPath=RBrowser_hostPath;this.setHostPath=RBrowser_setHostPath;this.contentPath=RBrowser_contentPath;this.setContentPath=RBrowser_setContentPath;this.isBrowser=
RBrowser_isBrowser;this.encode=RBrowser_encode;this.decode=RBrowser_decode;this.urlEncode=RBrowser_urlEncode;this.urlDecode=RBrowser_urlDecode;return this};function RBrowser_onLog(b,d){console.log(d)}
function RBrowser_construct(){var b=window.navigator.userAgent.toLowerCase();-1!=b.indexOf("android")&&(this._typeCd=EDevice.Mobile,this._softwareCd=ESoftware.Android);if(-1!=b.indexOf("chrome"))this._typeCd=EBrowser.Chrome;else if(-1!=b.indexOf("firefox"))this._typeCd=EBrowser.FireFox;else if(-1!=b.indexOf("msie")||-1!=b.indexOf("windows"))this._typeCd=EBrowser.Explorer;else if(-1!=b.indexOf("safari")||-1!=b.indexOf("applewebkit"))this._typeCd=EBrowser.Safari;else{alert("Unknown browser.\n"+b);return}this._typeCd==
EBrowser.Chrome&&RLogger.lsnsOutput.register(this,this.onLog);RLogger.info(this,"Parse browser agent. (type_cd={1})",REnum.decode(EBrowser,this._typeCd));window.applicationCache&&(this._supportHtml5=!0);b=this._capability=new SBrowserCapability;window.Worker&&(b.optionProcess=!1);window.localStorage&&(b.optionStorage=!0);try{new Blob(["Test"],{type:"text/plain"}),b.blobCreate=!0}catch(d){RLogger.warn(this,"Browser blob not support.")}}function RBrowser_capability(){return this._capability}
function RBrowser_supportHtml5(){return this._supportHtml5}function RBrowser_hostPath(b){return b?this._hostPath+b:this._hostPath}function RBrowser_setHostPath(b){this._hostPath=b}function RBrowser_contentPath(b){return b?this._contentPath+b:this._contentPath}function RBrowser_setContentPath(b){this._contentPath=b}function RBrowser_isBrowser(b){return this._typeCd==b}function RBrowser_encode(b){return escape(b)}function RBrowser_decode(b){return unescape(b)}
function RBrowser_urlEncode(b,d){return d?encodeURIComponent(b):encodeURI(b)}function RBrowser_urlDecode(b,d){return d?decodeURIComponent(b):decodeURI(b)}
var RBuilder=new function(){this.create=RBuilder_create;this.createIcon=RBuilder_createIcon;this.createImage=RBuilder_createImage;this.createText=RBuilder_createText;this.createButton=RBuilder_createButton;this.createCheck=RBuilder_createCheck;this.createRadio=RBuilder_createRadio;this.createEdit=RBuilder_createEdit;this.createFile=RBuilder_createFile;this.createSpan=RBuilder_createSpan;this.createDiv=RBuilder_createDiv;this.createTable=RBuilder_createTable;this.createTableRow=RBuilder_createTableRow;
this.createTableCell=RBuilder_createTableCell;this.createFragment=RBuilder_createFragment;this.append=RBuilder_append;this.appendIcon=RBuilder_appendIcon;this.appendImage=RBuilder_appendImage;this.appendEmpty=RBuilder_appendEmpty;this.appendText=RBuilder_appendText;this.appendButton=RBuilder_appendButton;this.appendCheck=RBuilder_appendCheck;this.appendRadio=RBuilder_appendRadio;this.appendEdit=RBuilder_appendEdit;this.appendFile=RBuilder_appendFile;this.appendSpan=RBuilder_appendSpan;this.appendDiv=
RBuilder_appendDiv;this.appendTable=RBuilder_appendTable;this.appendTableRow=RBuilder_appendTableRow;this.appendTableRowCell=RBuilder_appendTableRowCell;this.appendTableCell=RBuilder_appendTableCell;return this};function RBuilder_create(b,d,f){var h=null,h=b.ownerDocument?b.ownerDocument:b.hDocument?b.hDocument:b;b=h.createElement(d);f&&(b.className=f);return b}
function RBuilder_createIcon(b,d,f,h,q){b=this.create(b,"IMG",RString.nvl(d,"Tag_Icon"));b.align="absmiddle";f&&(b.src=RResource.iconPath(f));h&&(b.style.width=h+"px");q&&(b.style.height=q+"px");return b}function RBuilder_createImage(b,d,f,h,q){b=this.create(b,"IMG",f);f&&(b.src=RResource.imagePath(f));h&&(b.style.width=h);q&&(b.style.height=q);return b}function RBuilder_createText(b,d,f){b=this.create(b,"SPAN",d);f&&(b.innerHTML=f);return b}
function RBuilder_createButton(b,d){var f=this.create(b,"INPUT",d);f.type="button";return f}function RBuilder_createCheck(b,d){var f=this.create(b,"INPUT",d);f.type="checkbox";return f}function RBuilder_createRadio(b,d){var f=this.create(b,"INPUT",d);f.type="radio";return f}function RBuilder_createEdit(b,d){var f=this.create(b,"INPUT",d);f.type="text";return f}function RBuilder_createFile(b,d){var f=this.create(b,"INPUT",d);f.type="file";return f}
function RBuilder_createSpan(b,d){return this.create(b,"SPAN",d)}function RBuilder_createDiv(b,d){return this.create(b,"DIV",d)}function RBuilder_createTable(b,d,f,h,q){b=this.create(b,"TABLE",d);f&&(b.border=RInteger.nvl(f));b.cellSpacing=RInteger.nvl(h);b.cellPadding=RInteger.nvl(q);return b}function RBuilder_createTableRow(b,d){return this.create(b,"TR",d)}function RBuilder_createTableCell(b,d){return this.create(b,"TD",d)}
function RBuilder_createFragment(b){var d=null,d=b.ownerDocument?b.ownerDocument:b.hDocument?b.hDocument:b;b=d.createDocumentFragment();b.__fragment=!0;return b}function RBuilder_append(b,d,f){d=RBuilder.create(b.ownerDocument,d,f);b?b.appendChild(d):this.hDocument.body.appendChild(d);return d}function RBuilder_appendIcon(b,d,f,h,q){d=this.createIcon(b.ownerDocument,d,f,h,q);b.appendChild(d);return d}
function RBuilder_appendImage(b,d,f,h,q){d=this.createImage(b.ownerDocument,d,f,h,q);b.appendChild(d);return d}function RBuilder_appendEmpty(b,d,f){d=this.createIcon(b.ownerDocument,null,"n",d,f);b.appendChild(d);return d}function RBuilder_appendText(b,d,f){d=this.createText(b.ownerDocument,d,f);b.appendChild(d);return d}function RBuilder_appendButton(b,d){var f=this.createButton(b.ownerDocument,d);b.appendChild(f);return f}
function RBuilder_appendCheck(b,d){var f=this.createCheck(b.ownerDocument,d);b.appendChild(f);return f}function RBuilder_appendRadio(b,d){var f=this.createRadio(b.ownerDocument,d);b.appendChild(f);return f}function RBuilder_appendEdit(b,d){var f=this.createEdit(b.ownerDocument,d);b.appendChild(f);return f}function RBuilder_appendFile(b,d){var f=this.createFile(b.ownerDocument,d);b.appendChild(f);return f}
function RBuilder_appendSpan(b,d){var f=this.createSpan(b.ownerDocument,d);b.appendChild(f);return f}function RBuilder_appendDiv(b,d){var f=this.createDiv(b.ownerDocument,d);b.appendChild(f);return f}function RBuilder_appendTable(b,d,f,h,q){d=this.createTable(b.ownerDocument,d,f,h,q);b?b.appendChild(d):this.hDocument.body.appendChild(d);return d}
function RBuilder_appendTableRow(b,d,f,h){var q=null,q=null==f?RBrowser.isBrowser(EBrowser.Explorer)?b.insertRow():b.insertRow(-1):b.insertRow(f);d&&(q.className=d);h&&(q.height=h);return q}function RBuilder_appendTableRowCell(b,d,f,h){b=this.appendTableRow(b,null,null,f);return this.appendTableCell(b,d,null,h)}function RBuilder_appendTableCell(b,d,f,h){var q=null;null==f?(q=this.create(b,"TD",d),b.appendChild(q)):q=b.insertCell(f);d&&(q.className=d);h&&(q.width=h);return q}
var RContext=new function(){this.optionGarbage=!0;this._location=null;this._contexts={};this.languageId=this.themeId=this.contextTag=this.contextPath=null;this.construct=RContext_construct;this.initialize=RContext_initialize;this.get=RContext_get;this.find=RContext_find;this.location=RContext_location;this.context=RContext_context;this.construct();return this};function RContext_construct(){this.optionGarbage=window.ActiveXObject?!0:!1}
function RContext_location(b){var d=this._location;if(null==d){var d=window.location,f=d.href,d=f.substring(0,f.indexOf(d.pathname));this.contextPath&&(d+=this.contextPath);this._location=d}b&&(d+=b);return d}function RContext_context(b){return null!=b?RString.endsWith(b,".wv")?this.contextPath+"/"+b:RString.startsWith(b,"#")?this.contextPath+this.contextTag+b.substr(1):this.contextPath+b:this.contextPath}
function RContext_initialize(b){for(var d in b){var f=b[d],h;for(h in f)this._contexts[d+":"+h]=new TContext(d,h,f[h])}}function RContext_get(b,d,f,h,q,z){var A=this._contexts[b];return A?RString.format(A.text,d,f,h,q,z):RLogger.fatal(this,null,"Can not find context (path={1})",b)}function RContext_find(b,d){var f=b+":"+d,h=this._contexts[f];return h?h.text:RLogger.fatal(this,null,"Can not find context (id={1})",f)}
var RValue=new function(){this.double64=this.double16=this.double16=this.double4=this.double3=this.double2=this.double1=this.float16=this.float12=this.float9=this.float4=this.float3=this.float2=this.float1=null;this.construct=RValue_construct;this.construct();return this};
function RValue_construct(){RBrowser.supportHtml5()&&(this.float1=new Float32Array(1),this.float2=new Float32Array(2),this.float3=new Float32Array(3),this.float4=new Float32Array(4),this.float9=new Float32Array(9),this.float12=new Float32Array(12),this.float16=new Float32Array(16),this.double1=new Float64Array(1),this.double2=new Float64Array(2),this.double3=new Float64Array(3),this.double4=new Float64Array(4),this.double9=new Float64Array(9),this.double12=new Float64Array(12),this.double16=new Float64Array(16))}
var RWindow=new function(){this._statusEnable=this._optionSelect=!0;this._sessionStorage=this._localStorage=null;this._mouseEvent=new SMouseEvent;this._keyEvent=new SKeyboardEvent;this._resizeEvent=new SResizeEvent;this._orientationEvent=new SEvent;this._disableDeep=0;this._hDisableImage=this._hDisablePanel=this._hContainer=this._hDocument=this._hWindow=null;this.lsnsLoad=new TListeners;this.lsnsUnload=new TListeners;this.lsnsMouseDown=new TListeners;this.lsnsMouseUp=new TListeners;this.lsnsMouseOver=
new TListeners;this.lsnsMouseMove=new TListeners;this.lsnsMouseWheel=new TListeners;this.lsnsKeyDown=new TListeners;this.lsnsKeyUp=new TListeners;this.lsnsKeyPress=new TListeners;this.lsnsResize=new TListeners;this.lsnsOrientation=new TListeners;this.ohMouseDown=RWindow_ohMouseDown;this.ohMouseMove=RWindow_ohMouseMove;this.ohMouseUp=RWindow_ohMouseUp;this.ohMouseWheel=RWindow_ohMouseWheel;this.ohKeyDown=RWindow_ohKeyDown;this.ohKeyUp=RWindow_ohKeyUp;this.ohKeyPress=RWindow_ohKeyPress;this.ohResize=
RWindow_ohResize;this.ohSelect=RWindow_ohSelect;this.ohOrientation=RWindow_ohOrientation;this.ohUnload=RWindow_ohUnload;this.connect=RWindow_connect;this.optionSelect=RWindow_optionSelect;this.setOptionSelect=RWindow_setOptionSelect;this.setCaption=RWindow_setCaption;this.setStatus=RWindow_setStatus;this.storage=RWindow_storage;this.makeDisablePanel=RWindow_makeDisablePanel;this.windowEnable=RWindow_windowEnable;this.windowDisable=RWindow_windowDisable;this.isEnable=RWindow_isEnable;this.enable=RWindow_enable;
this.disable=RWindow_disable;this.setEnable=RWindow_setEnable;this.redirect=RWindow_redirect;this.historyForward=RWindow_historyForward;this.historyBack=RWindow_historyBack;return this};function RWindow_ohMouseDown(b){var d=RWindow;b||(b=d._hWindow.event);var f=d._mouseEvent;f.attachEvent(b);d.lsnsMouseDown.process(f)}function RWindow_ohMouseMove(b){var d=RWindow;b||(b=d._hWindow.event);var f=d._mouseEvent;f.attachEvent(b);d.lsnsMouseMove.process(f)}
function RWindow_ohMouseUp(b){var d=RWindow;b||(b=d._hWindow.event);var f=d._mouseEvent;f.attachEvent(b);d.lsnsMouseUp.process(f)}function RWindow_ohMouseWheel(b){var d=RWindow;b||(b=d._hWindow.event);var f=d._mouseEvent;f.attachEvent(b);d.lsnsMouseWheel.process(f)}function RWindow_ohKeyDown(b){var d=RWindow;b||(b=d._hWindow.event);var f=d._keyEvent;f.attachEvent(b);d.lsnsKeyDown.process(f)}
function RWindow_ohKeyUp(b){var d=RWindow;b||(b=d._hWindow.event);var f=d._keyEvent;f.attachEvent(b);d.lsnsKeyUp.process(f)}function RWindow_ohKeyPress(b){var d=RWindow;b||(b=d._hWindow.event);var f=d._keyEvent;f.attachEvent(b);d.lsnsKeyPress.process(f)}function RWindow_ohResize(b){var d=RWindow;b||(b=d._hWindow.event);var f=d._resizeEvent;f.attachEvent(b);d.lsnsResize.process(f)}function RWindow_ohSelect(b){return RWindow._optionSelect}
function RWindow_ohOrientation(b){b=RWindow;var d=b._orientationEvent;if(180==window.orientation||0==window.orientation)d.orientationCd=EOrientation.Vertical;else if(90==window.orientation||-90==window.orientation)d.orientationCd=EOrientation.Horizontal;else throw new TError(b,"Unknown orientation mode.");b.lsnsOrientation.process(d)}function RWindow_ohUnload(b){}
function RWindow_connect(b){b=this._hWindow=b;var d=this._hContainer=(this._hDocument=b.document).body;RBrowser.supportHtml5()?(d.addEventListener("mousedown",this.ohMouseDown,!0),d.addEventListener("mousemove",this.ohMouseMove,!0),d.addEventListener("mouseup",this.ohMouseUp,!0),d.addEventListener("mousewheel",this.ohMouseWheel,!0),d.addEventListener("keydown",this.ohKeyDown,!0),d.addEventListener("keyup",this.ohKeyUp,!0),d.addEventListener("keypress",this.ohKeyPress,!0),b.addEventListener("orientationchange",
this.ohOrientation)):(d.onmousedown=this.ohMouseDown,d.onmousemove=this.ohMouseMove,d.onmouseup=this.ohMouseUp,d.onmousewheel=this.ohMouseWheel,d.onkeydown=this.ohKeyDown,d.onkeyup=this.ohKeyUp,d.onkeypress=this.ohKeyPress);d.onresize=this.ohResize;d.onselectstart=this.ohSelect;d.onunload=this.ohUnload}function RWindow_optionSelect(){return this._optionSelect}
function RWindow_setOptionSelect(b){this._optionSelect=b;RBrowser.isBrowser(EBrowser.FireFox)&&(this._hContainer.style.MozUserSelect=b?"":"none")}function RWindow_setCaption(b){top.document.title=b}function RWindow_setStatus(b){window.status=RString.nvl(b)}
function RWindow_storage(b){switch(b){case EScope.Local:return b=this._localStorage,b||(b=this._localStorage=RClass.create(FWindowStorage),b.link(window.localStorage)),b;case EScope.Session:return b=this._sessionStorage,b||(b=this._sessionStorage=RClass.create(FWindowStorage),b.link(window.sessionStorage)),b}throw new TError(this,"Unknown scope. (scope_cd={1})",b);}
function RWindow_makeDisablePanel(b){var d=this._hDisablePanel;d||(d=this._hDisablePanel=RBuilder.createDiv(this._hDocument,"RWindow_Disable"),d.style.zIndex=5E3);var f=this._hDisableImage;f||(f=this._hDisableImage=RBuilder.appendIcon(d),f.src=RResource.iconPath("control.RWindow_Loading"),f.style.margin=this._hContainer.offsetHeight/2,f.style.display="none");RHtml.visibleSet(f,b);return d}function RWindow_windowDisable(){this._hContainer.disabled=!0}
function RWindow_windowEnable(){this._hContainer.disabled=!1}function RWindow_isEnable(){return this._statusEnable}function RWindow_enable(){this._disableDeep--;0==this._disableDeep&&this.setEnable(!0)}function RWindow_disable(){0==this._disableDeep&&this.setEnable(!1);this._disableDeep++}
function RWindow_setEnable(b,d){var f=this.makeDisablePanel(d);if(b)this.windowEnable(),f._linked&&(this._hContainer.removeChild(f),f._linked=!1);else{var h=this._hDocument,q=this._hDisablePanel.style;q.left="0px";q.top="0px";q.width=(h.all?this._hContainer.scrollWidth:h.documentElement.scrollWidth)+"px";q.height=(h.all?this._hContainer.scrollHeight:h.documentElement.scrollHeight)+"px";f._linked||(this._hContainer.appendChild(f),f._linked=!0)}this._statusEnable=b}function RWindow_redirect(){}
function RWindow_historyForward(){}function RWindow_historyBack(){}function RWindow_onUnload(){RMemory.release()}function RWindow_onResize(){var b=this._hDisablePanel;if(b&&"block"==b.style.display){var b=b.style,d=this.hDocument;b.pixelLeft=0;b.pixelTop=0;b.pixelWidth=d.all?this._hContainer.scrollWidth:d.documentElement.scrollWidth;b.pixelHeight=d.all?this._hContainer.scrollHeight:d.documentElement.scrollHeight}}
function RWindow_connect2(b){var d=this;d.hWindow=b;var f=d.hDocument=b.document,f=d._hContainer=d.hContainer=f.body;d.processUnload=f.onunload;f.onunload=function(f){f||(f=b.event);d.lsnsUnload.process(f);d.onUnload()};f.onmouseover=function(f){f||(f=b.event);d.lsnsMouseOver.process(f)};f.onmousewheel=function(f){f||(f=b.event);d.lsnsMouseWheel.process(f)};f.onkeydown=function(f){f||(f=b.event);RLogger.debug(d,"Window key down. (key_code={1})",f.keyCode);var q=f.srcElement?f.srcElement:f.target,
z=q.tagName;if(EKeyCode.BackSpace==f.keyCode)if("INPUT"==z){if(q.readOnly||"checkbox"==q.type)return RKey.eventClear(f)}else if("TEXTAREA"==z){if(q.readOnly)return RKey.eventClear(f)}else return RKey.eventClear(f);d.__keyDownEvent.attach(f);d.lsnsKeyDown.process(d.__keyDownEvent);EKeyCode.Enter==f.keyCode&&"INPUT"==z&&REvent.process(q,f)&&RKey.eventClear(f)};f.onkeyup=function(f){f||(f=b.event);d.lsnsKeyUp.process(f)};f.onkeypress=function(f){f||(f=b.event);RLogger.debug(d,"Window key press. (key_code={1})",
f.keyCode);d.lsnsKeyPress.process(f)};f.onresize=function(f){f||(f=b.event);if(d.oldBodyWidth!=d._hContainer.offsetWidth||d.oldBodyHeight!=d._hContainer.offsetHeight)d.oldBodyWidth=d._hContainer.offsetWidth,d.oldBodyHeight=d._hContainer.offsetHeight,d.onResize(),d.lsnsResize.process(f)}}
function RWindow_panel(b){if(EPanel.Disable==b){b=this._hDisablePanel;if(!b){b=this._hDisablePanel=RBuilder.append(this._hContainer,"DIV","RWindow_Disable");var d=RBuilder.append(b,"IMG");d.src=RRes.iconPath("#ctl.RWindow_Loading");d.style.margin=document.body.offsetHeight/2;b.style.zIndex=ELayer.Disable}return b}}function RWindow_screenPos(b){var d=this.hWindow.event;return b?(b.x=d.screenX,b.y=d.screenY,b):new TPoint(d.screenX,d.screenY)}
function RWindow_clientPos(b){var d=this.hWindow.event;return b?(b.x=d.clientX,b.y=d.clientY,b):new TPoint(d.clientX,d.clientY)}function RWindow_offsetPos(b){var d=this.hWindow.event;return b?(b.x=d.offsetX,b.y=d.offsetY,b):new TPoint(d.offsetX,d.offsetY)}
function RWindow_showShadow(b,d){this._hShadow||(this._hShadow=RBuilder.append(this._hContainer,"DIV","RWindow_Shadow"),this._hShadow.style.zIndex=ELayer.Shadow);var f=this._hShadow.style;0==b?f.display="none":(f.display="block",f.pixelLeft=d.left+3,f.pixelTop=d.top+3,f.pixelWidth=d.width(),f.pixelHeight=d.height())}
function RWindow_moveCenter(b){b&&(b.style.pixelLeft=Math.max(parseInt((this._hContainer.offsetWidth-b.offsetWidth)/2),0),b.style.pixelTop=Math.max(parseInt((this._hContainer.offsetHeight-b.offsetHeight)/2),0)+this._hContainer.scrollTop)}function RWindow_appendControl(b){this._hContainer.appendChild(b.hPanel)}function RWindow_appendElement(b){this._hContainer.appendChild(b)}function RWindow_appendContainer(b){this.hContainer.appendChild(b)}
function RWindow_containerTop(b){var d=this.hContainer;b=RHtml.top(b)+b.offsetHeight;"auto"==d.currentStyle.overflow&&(b-=RHtml.top(d));return b-d.scrollTop}
function RWindow_dispose(){this._hContainer.onload=null;this._hContainer.onunload=null;this._hContainer.onmousedown=null;this._hContainer.onmouseup=null;this._hContainer.onmousemove=null;this._hContainer.onmouseover=null;this._hContainer.onmousewheel=null;this._hContainer.onkeydown=null;this._hContainer.onkeyup=null;this._hContainer.onkeypress=null;this._hContainer.onresize=null;this._hContainer=RHtml.free(this._hContainer);this._hShadow=this._hDisableImage=this._hDisablePanel=this._hContainer=this._hDocument=
this._hWindow=null}var RXml=new function(){this.httpActiveX=!1;this.httpVendor=null;this.domActiveX=!1;this.domVendor=null;this.construct=RXml_construct;this.isNode=RXml_isNode;this.createConnection=RXml_createConnection;this.createDocument=RXml_createDocument;this.formatText=RXml_formatText;this.buildText=RXml_buildText;this.buildNode=RXml_buildNode;this.makeString=RXml_makeString;this.makeNode=RXml_makeNode;this.makeDocument=RXml_makeDocument;this.unpack=RXml_unpack;this.construct();return this};
function RXml_construct(){var b=window.document;if(window.ActiveXObject&&!window.XMLHttpRequest)for(var d=["MSXml2.XmlHTTP","Microsoft.XmlHTTP","MSXml.XmlHTTP","MSXml3.XmlHTTP"],f=d.length,h=0;h<f;h++){var q=d[h];try{new ActiveXObject(q);this.httpActiveX=!0;this.httpVendor=q;break}catch(z){m=z}}else if(window.XMLHttpRequest)try{this.httpActiveX=!1}catch(A){m=A}else alert("Unknown http vendor.");if(window.ActiveXObject||!window.DOMParser)for(d=["MSXml2.DOMDocument","Microsoft.XmlDOM","MSXml.DOMDocument",
"MSXml3.XmlDOM"],f=d.length,h=0;h<f;h++){q=d[h];try{new ActiveXObject(q);this.domActiveX=!0;this.domVendor=q;break}catch(B){m=B}}else if(window.DOMParser&&b&&b.implementation&&b.implementation.createDocument)try{document.implementation.createDocument("","",null),this.domActiveX=!1}catch(C){m=C}else alert("Unknown dom vendor.")}function RXml_isNode(b){return RClass.isName(b,"TNode")}
function RXml_createConnection(){var b=null;(b=this.httpActiveX?new ActiveXObject(this.httpVendor):new XMLHttpRequest)||alert("Create xml connection failure. (message="+m+")");return b}function RXml_createDocument(){var b=null;(b=this.domActiveX?new ActiveXObject(this.domVendor):document.implementation.createDocument("","",null))||alert("Create xml document failure. (message="+m+")");return b}function RXml_formatText(b){null!=b&&(b=b.replace(/\\n/g,"\n"));return b}
function RXml_buildText(b,d){if(null!=d){d=d.toString();for(var f=d.length,h=0;h<f;h++){var q=d.charAt(h);switch(q){case "<":b.append("&lt;");break;case ">":b.append("&gt;");break;case '"':b.append("&quot;");break;case "&":b.append("&amp;");break;case "\r":continue;case "\n":b.append("\\n");break;default:b.append(q)}}}return b}
function RXml_buildNode(b,d,f){var h=null,q=f.attributes;if(q){var z=q.length;if(0<z)for(var h=new TAttributes,A=0;A<z;A++){var B=q[A];B.nodeName&&h.set(B.nodeName,RXml.formatText(B.value))}}z=new TString;z.append(f.value);if(q=f.childNodes)for(B=q.length,A=0;A<B;A++){var C=q[A],D=C.nodeType;D==ENodeType.Text?z.append(C.nodeValue):D==ENodeType.Data&&z.append(C.data)}f=b.create(f.nodeName,h,RString.trim(z.toString()));d?d.push(f):b._root=f;if(q)for(d=q.length,A=0;A<d;A++)q[A].nodeType==ENodeType.Node&&
this.buildNode(b,f,q[A])}function RXml_makeString(b){var d=null;this.domActiveX?(d=new ActiveXObject(this.domVendor),d.async=!1,d.loadXML(b)):d=(new DOMParser).parseFromString(b,"text/xml");return d}function RXml_makeNode(b){if(b.documentElement){var d=new TXmlDocument;this.buildNode(d,null,b.documentElement);return d.root()}if("SCRIPT"==b.tagName){var f=b.textContent;f||(f=b.text);if(f)return d=new TXmlDocument,b=this.makeString(f),this.buildNode(d,null,b.documentElement),d.root()}return null}
function RXml_makeDocument(b){var d=new TXmlDocument;b.documentElement&&RXml.buildNode(d,null,b.documentElement);return d}function RXml_unpack(b,d){if(RString.isEmpty(b))return null;d||(d=new TNode);var f=new TAttributes;f.unpack(b);d.name=f.get("name");d.value=f.get("value");f.contains("attributes")&&d.attributes().unpack(f.get("attributes"));if(f.contains("nodes")){var h=new TStrings;h.unpack(f.get("nodes"));for(f=0;f<h.count;f++)this.unpack(h.get(f),d.create())}return d}
function MCanvasObject(b){b=RClass.inherits(this,b);b.htmlCanvas=RMethod.virtual(b,"htmlCanvas");return b}function MGraphicObject(b){b=RClass.inherits(this,b);b._graphicContext=null;b.graphicContext=MGraphicObject_graphicContext;b.linkGraphicContext=MGraphicObject_linkGraphicContext;b.dispose=MGraphicObject_dispose;return b}function MGraphicObject_graphicContext(){return this._graphicContext}
function MGraphicObject_linkGraphicContext(b){if(RClass.isClass(b,FGraphicContext))this._graphicContext=b;else if(RClass.isClass(b,MGraphicObject))this._graphicContext=b._graphicContext;else throw new TError(this,"Link graphic context failure. (context={1})",b);}function MGraphicObject_dispose(){this._graphicContext=null}function MGraphicRenderable(b){b=RClass.inherits(this,b,FObject);b.process=RMethod.empty;return b}
function FFloatStream(b){b=RClass.inherits(this,b,FObject);b._length=0;b._memory=null;b._position=0;b.construct=FFloatStream_construct;b.length=FFloatStream_length;b.setLength=FFloatStream_setLength;b.memory=FFloatStream_memory;b.writeFloat4=FFloatStream_writeFloat4;b.writeColor4=FFloatStream_writeColor4;b.reset=FFloatStream_reset;b.clear=FFloatStream_clear;b.dispose=FFloatStream_dispose;return b}function FFloatStream_construct(){this.__base.FObject.construct.call(this)}
function FFloatStream_length(){return this._length}function FFloatStream_setLength(b){this._length=b;this._memory=new Float32Array(b)}function FFloatStream_memory(){return this._memory}function FFloatStream_writeFloat4(b,d,f,h){this._memory[this._position++]=b;this._memory[this._position++]=d;this._memory[this._position++]=f;this._memory[this._position++]=h}function FFloatStream_writeColor4(b){this.writeFloat4(b.red,b.green,b.blue,b.alpha)}function FFloatStream_reset(){this._position=0}
function FFloatStream_clear(){this._position=0}function FFloatStream_dispose(){this._memory=null;this.__base.FObject.dispose.call(this)}function FGraphicContext(b){b=RClass.inherits(this,b,FObject,MGraphicObject);b._hCanvas=null;b.construct=FGraphicContext_construct;b.linkCanvas=RMethod.virtual(b,"linkCanvas");b.dispose=FGraphicContext_dispose;return b}function FGraphicContext_construct(){this.__base.FObject.construct.call(this)}
function FGraphicContext_dispose(){this._hCanvas=null;this.__base.FObject.dispose.call(this)}function FG2dContext(b){b=RClass.inherits(this,b,FGraphicContext);b._native=null;b.construct=FG2dContext_construct;b.linkCanvas=FG2dContext_linkCanvas;b.drawLine=FG2dContext_drawLine;b.drawRecrangle=FG2dContext_drawRecrangle;b.drawText=FG2dContext_drawText;b.drawImage=FG2dContext_drawImage;b.fillRecrangle=FG2dContext_fillRecrangle;b.dispose=FG2dContext_dispose;return b}
function FG2dContext_construct(){this.__base.FGraphicContext.construct.call(this)}function FG2dContext_linkCanvas(b){this._hCanvas=b;this._native=b.getContext("2d")}function FG2dContext_drawLine(b,d,f,h){var q=this._native;q.moveTo(b,d);q.lineTo(f,h);q.stroke()}function FG2dContext_drawRecrangle(b,d,f,h){var q=this._native;q.moveTo(b,d);q.lineTo(f,d);q.lineTo(f,h);q.lineTo(b,h);q.lineTo(b,d);q.stroke()}function FG2dContext_drawText(b,d,f){this._native.fillText(f,b,d)}
function FG2dContext_drawImage(b,d,f){this._native.drawImage(b,0,0)}function FG2dContext_fillRecrangle(b,d,f,h){var q=this._native;q.beginPath();q.moveTo(b,d);q.lineTo(f,d);q.lineTo(f,h);q.lineTo(b,h);q.lineTo(b,d);q.closePath();q.fill()}function FG2dContext_dispose(){this._native=null;this.__base.FGraphicContext.dispose.call(this)}
function FG2dContext(b){b=RClass.inherits(this,b,FGraphicContext);b._size=null;b.construct=FG2dContext_construct;b.linkCanvas=FG2dContext_linkCanvas;b.size=FG2dContext_size;b.dispose=FG2dContext_dispose;return b}function FG2dContext_construct(){var b=this;b.__base.FGraphicContext.construct.call(b);b._size=new SSize2}function FG2dContext_linkCanvas(b){this._size.set(b.width,b.height)}function FG2dContext_size(){return this._size}
function FG2dContext_dispose(){var b=this;b._size=RObject.dispose(b._size);b.__base.FGraphicContext.dispose.call(b)}
function FG2dCanvasContext(b){b=RClass.inherits(this,b,FG2dContext);b._native=null;b.construct=FG2dCanvasContext_construct;b.linkCanvas=FG2dCanvasContext_linkCanvas;b.clear=FG2dCanvasContext_clear;b.drawLine=FG2dCanvasContext_drawLine;b.drawRectangle=FG2dCanvasContext_drawRectangle;b.drawText=FG2dCanvasContext_drawText;b.drawImage=FG2dCanvasContext_drawImage;b.fillRectangle=FG2dCanvasContext_fillRectangle;b.toBytes=FG2dCanvasContext_toBytes;return b}
function FG2dCanvasContext_construct(){this.__base.FG2dContext.construct.call(this)}function FG2dCanvasContext_linkCanvas(b){this.__base.FG2dContext.linkCanvas.call(this,b);if(b.getContext){var d=b.getContext("2d");if(!d)throw new TError(this,"Current browser can't support Context2D technique.");this._native=d}this._hCanvas=b}function FG2dCanvasContext_clear(b,d,f,h,q){d=this._native;b=this._size;d.clearRect(0,0,b.width,b.height)}
function FG2dCanvasContext_drawLine(b,d,f,h,q,z){var A=this._native;A.strokeStyle=q;A.lineWidth=z;A.moveTo(b,d);A.lineTo(f,h);A.stroke()}function FG2dCanvasContext_drawRectangle(b,d,f,h,q,z){var A=this._native;A.strokeStyle=q;A.lineWidth=z;A.strokeRect(b,d,f,h)}function FG2dCanvasContext_drawText(b,d,f,h){var q=this._native;q.fillStyle=h;q.fillText(b,d,f)}
function FG2dCanvasContext_drawImage(b,d,f){var h=this._native,q=null;if("IMG"==b.tagName)q=b;else if(RClass.isClass(b,FImage))q=b.image();else throw new TError(this,"Unknown data type");h.drawImage(q,d,f,this._size.width,this._size.height)}function FG2dCanvasContext_fillRectangle(b,d,f,h,q){var z=this._native;z.fillStyle=q;z.fillRect(b,d,f,h)}function FG2dCanvasContext_toBytes(){var b=this._size;return this._native.getImageData(0,0,b.width,b.height)}
var EG3dMaterialMap=new function(){this.AmbientColor=0;this.DiffuseColor=1;this.SpecularColor=2;this.ReflectColor=3;this.EmissiveColor=4;this.Count=8;return this},EG3dRegionParameter=new function(){this.Unknown=0;this.CameraPosition=1;this.CameraDirection=2;this.CameraViewMatrix=3;this.CameraProjectionMatrix=4;this.CameraViewProjectionMatrix=5;this.LightPosition=6;this.LightDirection=7;this.LightViewMatrix=8;this.LightProjectionMatrix=9;this.LightViewProjectionMatrix=10;this.LightInfo=11;return this},
EG3dTechniqueMode=new function(){this.Color="color";this.Ambient="ambient";this.DiffuseLevel="diffuse.level";this.DiffuseColor="diffuse.color";this.SpecularLevel="specular.level";this.SpecularColor="specular.color";this.Reflect="reflect";this.Emissive="emissive";this.Result="result";return this};
function MG3dRegion(b){b=RClass.inherits(this,b);b._changed=!1;b._spaceName=null;b._technique=null;b._techniquePass=null;b._camera=null;b._projection=null;b._directionalLight=null;b._lights=null;b._allRenderables=null;b._renderables=null;b._cameraPosition=null;b._cameraDirection=null;b._cameraViewMatrix=null;b._cameraProjectionMatrix=null;b._cameraViewProjectionMatrix=null;b._lightPosition=null;b._lightDirection=null;b._lightViewMatrix=null;b._lightProjectionMatrix=null;b._lightViewProjectionMatrix=
null;b._lightInfo=null;b._materialMap=null;b.construct=MG3dRegion_construct;b.isChanged=MG3dRegion_isChanged;b.spaceName=MG3dRegion_spaceName;b.technique=MG3dRegion_technique;b.setTechnique=MG3dRegion_setTechnique;b.techniquePass=MG3dRegion_techniquePass;b.setTechniquePass=MG3dRegion_setTechniquePass;b.camera=MG3dRegion_camera;b.directionalLight=MG3dRegion_directionalLight;b.lights=MG3dRegion_lights;b.materialMap=MG3dRegion_materialMap;b.allRenderables=MG3dRegion_allRenderables;b.renderables=MG3dRegion_renderables;
b.pushRenderable=MG3dRegion_pushRenderable;b.setup=MG3dRegion_setup;b.change=MG3dRegion_change;b.prepare=MG3dRegion_prepare;b.reset=MG3dRegion_reset;b.calculate=MG3dRegion_calculate;b.update=MG3dRegion_update;b.dispose=MG3dRegion_dispose;return b}
function MG3dRegion_construct(){this._lights=new TObjects;this._renderables=new TObjects;this._allRenderables=new TObjects;this._cameraPosition=new SPoint3;this._cameraDirection=new SVector3;this._cameraViewMatrix=new SMatrix3d;this._cameraProjectionMatrix=new SMatrix3d;this._cameraViewProjectionMatrix=new SMatrix3d;this._lightPosition=new SPoint3;this._lightDirection=new SVector3;this._lightViewMatrix=new SMatrix3d;this._lightProjectionMatrix=new SMatrix3d;this._lightViewProjectionMatrix=new SMatrix3d;
this._lightInfo=new SVector4}function MG3dRegion_isChanged(){return this._changed}function MG3dRegion_spaceName(){return this._spaceName}function MG3dRegion_technique(){return this._technique}function MG3dRegion_setTechnique(b){this._technique=b}function MG3dRegion_techniquePass(){return this._techniquePass}function MG3dRegion_setTechniquePass(b,d){this._techniquePass=b;this._spaceName=b.fullCode();this._finish=d}function MG3dRegion_camera(){return this._camera}
function MG3dRegion_directionalLight(){return this._directionalLight}function MG3dRegion_lights(){return this._lights}function MG3dRegion_materialMap(){return this._materialMap}function MG3dRegion_allRenderables(b){return this._allRenderables}function MG3dRegion_renderables(b){return this._renderables}function MG3dRegion_pushRenderable(b){this._renderables.push(b);this._allRenderables.push(b)}function MG3dRegion_setup(){}function MG3dRegion_change(){this._changed=!0}
function MG3dRegion_prepare(){this._changed=!1;var b=this._camera,d=b.projection();b.updateFrustum();this._cameraPosition.assign(b.position());this._cameraDirection.assign(b.direction());this._cameraViewMatrix.assign(b.matrix());this._cameraProjectionMatrix.assign(d.matrix());this._cameraViewProjectionMatrix.assign(b.matrix());this._cameraViewProjectionMatrix.append(d.matrix());b=this._directionalLight.camera();b.position();d=b.projection();this._lightPosition.assign(b.position());this._lightDirection.assign(b.direction());
this._lightViewMatrix.assign(b.matrix());this._lightProjectionMatrix.assign(d.matrix());this._lightViewProjectionMatrix.assign(b.matrix());this._lightViewProjectionMatrix.append(d.matrix());this._lightInfo.set(0,0,d._znear,1/d.distance());this._allRenderables.clear()}function MG3dRegion_reset(){this._renderables.clear()}
function MG3dRegion_calculate(b){switch(b){case EG3dRegionParameter.CameraPosition:return this._cameraPosition;case EG3dRegionParameter.CameraDirection:return this._cameraDirection;case EG3dRegionParameter.CameraViewMatrix:return this._cameraViewMatrix;case EG3dRegionParameter.CameraProjectionMatrix:return this._cameraProjectionMatrix;case EG3dRegionParameter.CameraViewProjectionMatrix:return this._cameraViewProjectionMatrix;case EG3dRegionParameter.LightPosition:return this._lightPosition;case EG3dRegionParameter.LightDirection:return this._lightDirection;
case EG3dRegionParameter.LightViewMatrix:return this._lightViewMatrix;case EG3dRegionParameter.LightProjectionMatrix:return this._lightProjectionMatrix;case EG3dRegionParameter.LightViewProjectionMatrix:return this._lightViewProjectionMatrix;case EG3dRegionParameter.LightInfo:return this._lightInfo}throw new TError(this,"Unknown parameter type. (type_cd={1})",b);}function MG3dRegion_update(){for(var b=this._renderables,d=b.count(),f=0;f<d;f++)b.getAt(f).update(this)}
function MG3dRegion_dispose(){this._renderables=RObject.free(this._renderables);this._allRenderables=RObject.free(this._allRenderables)}
function MG3dRenderable(b){b=RClass.inherits(this,b,MGraphicRenderable);b._optionMerge=!1;b._currentMatrix=null;b._matrix=null;b._material=null;b._activeInfo=null;b._infos=null;b.construct=MG3dRenderable_construct;b.currentMatrix=MG3dRenderable_currentMatrix;b.matrix=MG3dRenderable_matrix;b.material=MG3dRenderable_material;b.setMaterial=MG3dRenderable_setMaterial;b.activeEffect=MG3dRenderable_activeEffect;b.activeInfo=MG3dRenderable_activeInfo;b.effectFind=MG3dRenderable_effectFind;b.effectSet=MG3dRenderable_effectSet;
b.infos=MG3dRenderable_infos;b.selectInfo=MG3dRenderable_selectInfo;b.resetInfos=MG3dRenderable_resetInfos;b.testVisible=RMethod.emptyTrue;b.update=RMethod.empty;b.dispose=MG3dRenderable_dispose;return b}function MG3dRenderable_construct(){this._currentMatrix=new SMatrix3d;this._matrix=new SMatrix3d}function MG3dRenderable_currentMatrix(){return this._currentMatrix}function MG3dRenderable_matrix(){return this._matrix}
function MG3dRenderable_activeEffect(){var b=this._activeInfo;return b?b.effect:null}function MG3dRenderable_activeInfo(){return this._activeInfo}function MG3dRenderable_effectFind(b){var d=this._infos;return d&&(b=d.get(b))?b.effect:null}function MG3dRenderable_effectSet(b,d){var f=this.infos(),h=f.get(b);h||(h=new SG3dRenderableInfo,f.set(b,h));h.effect=d}function MG3dRenderable_infos(){var b=this._infos;b||(b=this._infos=new TDictionary);return b}
function MG3dRenderable_selectInfo(b){var d=this.infos(),f=d.get(b);f||(f=new SG3dRenderableInfo,d.set(b,f));return this._activeInfo=f}function MG3dRenderable_resetInfos(){var b=this._infos;if(b)for(var d=b.count()-1;0<=d;d--)b.at(d).reset()}function MG3dRenderable_material(){return this._material}function MG3dRenderable_setMaterial(b){this._material=b}
function MG3dRenderable_dispose(){this._currentMatrix=RObject.dispose(this._currentMatrix);this._matrix=RObject.dispose(this._matrix);this._material=RObject.dispose(this._material);this._activeInfo=null;this._infos=RObject.dispose(this._infos)}
function SG3dEffectInfo(){this.supportInstance=this.optionNormalCompress=this.optionNormalInvert=this.optionAlphaTest=this.blendTargetMode=this.blendSourceMode=this.optionBlendMode=this.optionDepthWrite=this.depthModeCd=this.optionDepthTest=this.cullModeCd=this.optionCullMode=this.fillModeCd=this.mergeCount=this.optionMerge=this.techniqueModeCode=this.techniqueCode=this.code=null;this.vertexCount=0;this.vertexSkeleton=this.vertexNormalFull=this.vertexNormal=this.vertexCoord=this.vertexColor=null;
this.vertexBoneCount=0;this.fragmentHeight=this.fragmentEmissive=this.fragmentRefract=this.fragmentReflect=this.fragmentLight=this.fragmentEnvironment=this.fragmentSpecularView=this.fragmentSpecularLevel=this.fragmentSpecularColor=this.fragmentDiffuseView=this.fragmentDiffuse=this.fragmentAmbient=this.fragmentBump=this.fragmentAlpha=null;this.attributes=new TArray;this.samplers=new TArray;this.attributeContains=SG3dEffectInfo_attributeContains;this.samplerContains=SG3dEffectInfo_samplerContains;this.reset=
SG3dEffectInfo_reset;this.reset();return this}function SG3dEffectInfo_attributeContains(b){return this.attributes.contains(b)}function SG3dEffectInfo_samplerContains(b){return this.samplers.contains(b)}
function SG3dEffectInfo_reset(){this.code=null;this.optionMerge=!1;this.mergeCount=0;this.fillModeCd=EG3dFillMode.Fill;this.optionCullMode=!0;this.cullModeCd=EG3dCullMode.Front;this.optionDepthTest=!0;this.depthModeCd=EG3dDepthMode.Less;this.optionDepthWrite=!0;this.optionBlendMode=!1;this.blendSourceMode=EG3dBlendMode.SourceAlpha;this.blendTargetMode=EG3dBlendMode.OneMinusSourceAlpha;this.optionNormalInvert=this.optionAlphaTest=!1;this.optionNormalCompress=!0;this.supportInstance=!1;this.vertexCount=
0;this.vertexSkeleton=this.vertexNormalFull=this.vertexNormal=this.vertexCoord=this.vertexColor=!1;this.vertexBoneCount=0;this.fragmentHeight=this.fragmentEmissive=this.fragmentRefract=this.fragmentReflect=this.fragmentLight=this.fragmentEnvironment=this.fragmentSpecularView=this.fragmentSpecularLevel=this.fragmentSpecularColor=this.fragmentDiffuseView=this.fragmentDiffuse=this.fragmentAmbient=this.fragmentBump=this.fragmentAlpha=!1;this.attributes.clear();this.samplers.clear()}
function SG3dMaterialInfo(b){b||(b=this);b.effectCode="automatic";b.optionDepth=null;b.optionDouble=null;b.optionNormalInvert=null;b.optionShadow=null;b.optionShadowSelf=null;b.optionAlpha=null;b.alphaBase=1;b.alphaRate=1;b.alphaLevel=1;b.alphaMerge=1;b.optionColor=null;b.colorMin=0;b.colorMax=1;b.colorBalance=.5;b.colorRate=1;b.optionVertex=null;b.vertexColor=new SColor4;b.optionAmbient=null;b.ambientColor=new SColor4;b.ambientShadow=1;b.optionDiffuse=null;b.diffuseColor=new SColor4;b.diffuseShadow=
1;b.optionDiffuseView=null;b.diffuseViewColor=new SColor4;b.diffuseViewShadow=1;b.optionSpecular=null;b.specularColor=new SColor4;b.specularBase=1;b.specularLevel=1;b.specularAverage=1;b.specularShadow=1;b.specularInfo=null;b.optionSpecularView=null;b.specularViewColor=new SColor4;b.specularViewBase=1;b.specularViewRate=1;b.specularViewAverage=1;b.specularViewShadow=1;b.specularViewShadow=null;b.optionReflect=null;b.reflectColor=new SColor4;b.reflectMerge=1;b.reflectShadow=1;b.optionRefract=null;
b.refractFrontColor=new SColor4;b.refractBackColor=new SColor4;b.optionOpacity=null;b.opacityColor=new SColor4;b.opacityRate=1;b.opacityAlpha=1;b.opacityDepth=1;b.opacityTransmittance=1;b.optionEmissive=null;b.emissiveColor=new SColor4;b.assign=SG3dMaterialInfo_assign;b.calculate=SG3dMaterialInfo_calculate;b.reset=SG3dMaterialInfo_reset;b.reset();return b}
function SG3dMaterialInfo_assign(b){this.effectCode=b.effectCode;this.transformName=b.transformName;this.optionDepth=b.optionDepth;this.optionDouble=b.optionDouble;this.optionNormalInvert=b.optionNormalInvert;this.optionShadow=b.optionShadow;this.optionShadowSelf=b.optionShadowSelf;this.optionAlpha=b.optionAlpha;this.alphaBase=b.alphaBase;this.alphaRate=b.alphaRate;this.alphaLevel=b.alphaLevel;this.alphaMerge=b.alphaMerge;this.optionColor=b.optionColor;this.colorMin=b.colorMin;this.colorMax=b.colorMax;
this.colorBalance=b.colorBalance;this.colorRate=b.colorRate;this.optionVertex=b.optionVertex;this.vertexColor.assign(b.vertexColor);this.optionAmbient=b.optionAmbient;this.ambientColor.assign(b.ambientColor);this.ambientShadow=b.ambientShadow;this.optionDiffuse=b.optionDiffuse;this.diffuseColor.assign(b.diffuseColor);this.diffuseShadow=b.diffuseShadow;this.optionDiffuseView=b.optionDiffuseView;this.diffuseViewColor.assign(b.diffuseViewColor);this.diffuseViewShadow=b.diffuseViewShadow;this.optionSpecular=
b.optionSpecular;this.specularColor.assign(b.specularColor);this.specularBase=b.specularBase;this.specularLevel=b.specularLevel;this.specularAverage=b.specularAverage;this.specularShadow=b.specularShadow;this.optionSpecularView=b.optionSpecularView;this.specularViewColor.assign(b.specularViewColor);this.specularViewBase=b.specularViewBase;this.specularViewRate=b.specularViewRate;this.specularViewAverage=b.specularViewAverage;this.specularViewShadow=b.specularViewShadow;this.optionReflect=b.optionReflect;
this.reflectColor.assign(b.reflectColor);this.reflectMerge=RFloat.toRange(b.reflectMerge,0,2);this.reflectShadow=b.reflectShadow;this.optionRefract=b.optionRefract;this.refractFrontColor.assign(b.refractFrontColor);this.refractFrontMerge=b.refractFrontMerge;this.refractFrontShadow=b.refractFrontShadow;this.refractBackColor.assign(b.refractBackColor);this.refractBackMerge=b.refractBackMerge;this.refractBackShadow=b.refractBackShadow;this.optionOpacity=b.optionOpacity;this.opacityColor.assign(b.opacityColor);
this.opacityRate=b.opacityRate;this.opacityAlpha=b.optionAlpha;this.opacityDepth=b.optionDepth;this.opacityTransmittance=b.optionTransmittance;this.optionEmissive=b.optionEmissive;this.emissiveColor.assign(b.emissiveColor)}
function SG3dMaterialInfo_calculate(b){this.effectCode=b.effectCode;this.transformName=b.transformName;this.optionDepth=b.optionDepth;this.optionDouble=b.optionDouble;this.optionNormalInvert=b.optionNormalInvert;this.optionShadow=b.optionShadow;this.optionShadowSelf=b.optionShadowSelf;this.optionAlpha=b.optionAlpha;this.alphaBase=b.alphaBase;this.alphaRate=b.alphaRate;this.alphaLevel=b.alphaLevel;this.alphaMerge=b.alphaMerge;this.optionColor=b.optionColor;this.colorMin=b.colorMin;this.colorMax=b.colorMax;
this.colorBalance=b.colorBalance;this.colorRate=b.colorRate;this.optionVertex=b.optionVertex;this.vertexColor.assignPower(b.vertexColor);this.optionAmbient=b.optionAmbient;this.ambientColor.assignPower(b.ambientColor);this.ambientShadow=b.ambientShadow;this.optionDiffuse=b.optionDiffuse;this.diffuseColor.assignPower(b.diffuseColor);this.diffuseShadow=b.diffuseShadow;this.optionDiffuseView=b.optionDiffuseView;this.diffuseViewColor.assignPower(b.diffuseViewColor);this.diffuseViewShadow=b.diffuseViewShadow;
this.optionSpecular=b.optionSpecular;this.specularColor.assignPower(b.specularColor);this.specularBase=b.specularBase;this.specularLevel=b.specularLevel;this.specularAverage=b.specularAverage;this.specularShadow=b.specularShadow;this.optionSpecularView=b.optionSpecularView;this.specularViewColor.assignPower(b.specularViewColor);this.specularViewBase=b.specularViewBase;this.specularViewRate=b.specularViewRate;this.specularViewAverage=b.specularViewAverage;this.specularViewShadow=b.specularViewShadow;
this.optionReflect=b.optionReflect;this.reflectColor.assignPower(b.reflectColor);this.reflectMerge=RFloat.toRange(b.reflectMerge,0,2);this.reflectShadow=b.reflectShadow;this.optionRefract=b.optionRefract;this.refractFrontColor.assignPower(b.refractFrontColor);this.refractFrontMerge=b.refractFrontMerge;this.refractFrontShadow=b.refractFrontShadow;this.refractBackColor.assignPower(b.refractBackColor);this.refractBackMerge=b.refractBackMerge;this.refractBackShadow=b.refractBackShadow;this.optionOpacity=
b.optionOpacity;this.opacityColor.assignPower(b.opacityColor);this.opacityRate=b.opacityRate;this.opacityAlpha=b.optionAlpha;this.opacityDepth=b.optionDepth;this.opacityTransmittance=b.optionTransmittance;this.optionEmissive=b.optionEmissive;this.emissiveColor.assignPower(b.emissiveColor)}
function SG3dMaterialInfo_reset(){this.optionDepth=!0;this.optionNormalInvert=this.optionDouble=!1;this.optionShadowSelf=this.optionShadow=!0;this.optionAlpha=!1;this.alphaBase=.2;this.alphaMerge=this.alphaLevel=this.alphaRate=1;this.optionColor=!0;this.colorMin=0;this.colorMax=1;this.colorBalance=.5;this.colorRate=1;this.optionVertex=!0;this.vertexColor.set(1,1,1,1);this.optionAmbient=!0;this.ambientColor.set(.5,.5,.5,1);this.ambientShadow=1;this.optionDiffuse=!0;this.diffuseColor.set(.5,.5,.5,1);
this.diffuseShadow=1;this.optionDiffuseView=!0;this.diffuseViewColor.set(1,1,1,1);this.diffuseViewShadow=1;this.optionSpecular=!0;this.specularColor.set(.5,.5,.5,1);this.specularBase=0;this.specularLevel=16;this.specularShadow=this.specularAverage=1;this.optionSpecularView=!0;this.specularViewColor.set(1,1,1,1);this.specularViewBase=0;this.specularViewRate=16;this.specularViewShadow=this.specularViewAverage=1;this.optionReflect=!0;this.reflectColor.set(1,1,1,1);this.reflectShadow=this.reflectMerge=
1;this.optionRefract=!0;this.refractFrontColor.set(1,1,1,1);this.refractFrontShadow=this.refractFrontMerge=1;this.refractBackColor.set(1,1,1,1);this.refractBackShadow=this.refractBackMerge=1;this.optionOpacity=!0;this.opacityColor.set(1,1,1,1);this.opacityTransmittance=this.opacityDepth=this.opacityAlpha=this.opacityRate=1;this.optionEmissive=!0;this.emissiveColor.set(1,1,1,1)}
function SG3dRenderableInfo(){this.material=this.layout=this.effect=null;this.reset=SG3dRenderableInfo_reset;return this}function SG3dRenderableInfo_reset(){this.effect=null;this.layout=RObject.dispose(this.layout)}function FG3dAnimation(b){b=RClass.inherits(this,b,FObject);b._baseTick=0;b._currentTick=0;b._lastTick=0;b._bones=null;b.construct=FG3dAnimation_construct;b.findBone=FG3dAnimation_findBone;b.process=FG3dAnimation_process;b.dispose=FG3dAnimation_dispose;return b}
function FG3dAnimation_construct(){this.__base.FObject.construct.call(this);this._bones=new TObjects}function FG3dAnimation_findBone(b){for(var d=this._bones,f=d.count(),h=0;h<f;h++){var q=d.get(h);if(q.boneId()==b)return q}return null}function FG3dAnimation_process(){var b=RTimer.current();0==this._lastTick&&(this._lastTick=b);this._currentTick=(b-this._lastTick+this._baseTick)/1E3;for(var b=this._bones,d=b.count(),f=0;f<d;f++)b.get(f).update(this._currentTick);return!0}
function FG3dAnimation_dispose(){this._bones.dispose();this._bones=null;this.__base.FObject.dispose.call(this)}function FG3dBaseMaterial(b){b=RClass.inherits(this,b,FObject);b._name=null;b._info=null;b.construct=FG3dBaseMaterial_construct;b.info=FG3dBaseMaterial_info;b.assignInfo=FG3dBaseMaterial_assignInfo;b.assign=FG3dBaseMaterial_assign;b.calculate=FG3dBaseMaterial_calculate;return b}
function FG3dBaseMaterial_construct(){this.__base.FObject.construct.call(this);this._info=new SG3dMaterialInfo}function FG3dBaseMaterial_info(){return this._info}function FG3dBaseMaterial_assignInfo(b){this._info.assign(b)}function FG3dBaseMaterial_assign(b){this._info.assign(b.info())}function FG3dBaseMaterial_calculate(b){this._info.calculate(b.info())}function FG3dBone(b){b=RClass.inherits(this,b,FObject);b._boneId=0;b._modeId=null;b.update=FG3dBone_update;return b}
function FG3dBone_update(b){}
function FG3dCamera(b){b=RClass.inherits(this,b,FObject);b._matrix=null;b._position=null;b._target=null;b._direction=null;b._directionTarget=null;b._centerFront=.6;b._centerBack=1;b._focalNear=.1;b._focalFar=200;b._frustum=null;b._planes=null;b._viewport=null;b.__axisUp=null;b.__axisX=null;b.__axisY=null;b.__axisZ=null;b.construct=FG3dCamera_construct;b.matrix=FG3dCamera_matrix;b.position=FG3dCamera_position;b.setPosition=FG3dCamera_setPosition;b.direction=FG3dCamera_direction;b.setDirection=FG3dCamera_setDirection;
b.frustum=FG3dCamera_frustum;b.planes=FG3dCamera_planes;b.doWalk=FG3dCamera_doWalk;b.doStrafe=FG3dCamera_doStrafe;b.doFly=FG3dCamera_doFly;b.doPitch=FG3dCamera_doPitch;b.doYaw=FG3dCamera_doYaw;b.doRoll=FG3dCamera_doRoll;b.lookAt=FG3dCamera_lookAt;b.update=FG3dCamera_update;b.updateFrustum=FG3dCamera_updateFrustum;return b}
function FG3dCamera_construct(){this.__base.FObject.construct.call(this);this._matrix=new SMatrix3d;this._position=new SPoint3;this._target=new SPoint3;this._direction=new SVector3;this._directionTarget=new SVector3;this._frustum=new SFrustum;this._planes=new SFrustumPlanes;this._viewport=RClass.create(FG3dViewport);this.__axisUp=new SVector3;this.__axisUp.set(0,1,0);this.__axisX=new SVector3;this.__axisY=new SVector3;this.__axisZ=new SVector3}
function FG3dCamera_position(){return this._position}function FG3dCamera_matrix(){return this._matrix}function FG3dCamera_setPosition(b,d,f){this._position.set(b,d,f)}function FG3dCamera_direction(){return this._direction}function FG3dCamera_setDirection(b,d,f){this._direction.set(b,d,f);this._directionTarget.set(b,d,f)}function FG3dCamera_frustum(){return this._frustum}function FG3dCamera_planes(){return this._planes}
function FG3dCamera_doWalk(b){this._position.x+=this._direction.x*b;this._position.z+=this._direction.z*b}function FG3dCamera_doStrafe(b){this._position.x+=this.__axisY.x*b;this._position.z+=this.__axisY.z*b}function FG3dCamera_doFly(b){this._position.y+=b}function FG3dCamera_doPitch(b){throw new TFatal(o,"Unsupport.");}function FG3dCamera_doYaw(b){throw new TFatal(o,"Unsupport.");}function FG3dCamera_doRoll(b){throw new TFatal(o,"Unsupport.");}
function FG3dCamera_lookAt(b,d,f){var h=this._position,q=this._direction;this._target.set(b,d,f);q.set(b-h.x,d-h.y,f-h.z);q.normalize();this._directionTarget.assign(q)}
function FG3dCamera_update(){var b=this.__axisX,d=this.__axisY,f=this.__axisZ;f.assign(this._direction);f.normalize();this.__axisUp.cross2(b,f);b.normalize();f.cross2(d,b);d.normalize();var h=this._matrix.data();h[0]=b.x;h[1]=d.x;h[2]=f.x;h[3]=0;h[4]=b.y;h[5]=d.y;h[6]=f.y;h[7]=0;h[8]=b.z;h[9]=d.z;h[10]=f.z;h[11]=0;h[12]=-b.dotPoint3(this._position);h[13]=-d.dotPoint3(this._position);h[14]=-f.dotPoint3(this._position);h[15]=1}
function FG3dCamera_updateFrustum(){var b=RMath.matrix;b.assign(this._matrix);b.append(this._projection.matrix());this._planes.updateVision(b.data())}function FG3dDirectionalLight(b){b=RClass.inherits(this,b,FG3dLight);b._camera=null;b._viewport=null;b._direction=null;b.construct=FG3dDirectionalLight_construct;b.camera=FG3dDirectionalLight_camera;b.projection=FG3dDirectionalLight_projection;b.viewport=FG3dDirectionalLight_viewport;b.direction=FG3dDirectionalLight_direction;return b}
function FG3dDirectionalLight_construct(){this.__base.FG3dLight.construct.call(this);this._direction=new SVector3;this._camera=RClass.create(FG3dPerspectiveCamera)}function FG3dDirectionalLight_camera(){return this._camera}function FG3dDirectionalLight_projection(){return this._projection}function FG3dDirectionalLight_viewport(){return this._viewport}function FG3dDirectionalLight_direction(){return this._direction}
function FG3dEffect(b){b=RClass.inherits(this,b,FG3dObject);b._ready=null;b._code=null;b._stateFillCd=EG3dFillMode.Face;b._stateCullCd=EG3dCullMode.Front;b._stateDepth=!0;b._stateDepthCd=EG3dDepthMode.LessEqual;b._stateDepthWrite=!0;b._stateBlend=!0;b._stateBlendSourceCd=EG3dBlendMode.SourceAlpha;b._stateBlendTargetCd=EG3dBlendMode.OneMinusSourceAlpha;b._stateAlphaTest=!1;b._optionShadow=!1;b._optionLightMap=!1;b._optionFog=!1;b._program=null;b._vertexTemplate=null;b._fragmentTemplate=null;b.setup=
RMethod.empty;b.testReady=FG3dEffect_testReady;b.code=FG3dEffect_code;b.program=FG3dEffect_program;b.setParameter=FG3dEffect_setParameter;b.setSampler=FG3dEffect_setSampler;b.drawRenderable=FG3dEffect_drawRenderable;b.drawRenderables=FG3dEffect_drawRenderables;b.drawGroup=FG3dEffect_drawGroup;b.drawRegion=FG3dEffect_drawRegion;b.buildInfo=FG3dEffect_buildInfo;b.loadConfig=FG3dEffect_loadConfig;b.load=FG3dEffect_load;b.build=FG3dEffect_build;return b}
function FG3dEffect_testReady(){return this._ready}function FG3dEffect_code(){return this._code}function FG3dEffect_program(){return this._program}function FG3dEffect_setParameter(b,d,f){this._program.setParameter(b,d,f)}function FG3dEffect_setSampler(b,d){this._program.setSampler(b,d)}function FG3dEffect_buildInfo(b,d){}
function FG3dEffect_drawRenderable(b,d){var f=this._graphicContext,h=this._program;if(h.hasAttribute())for(var q=h.attributes(),z=q.count(),A=0;A<z;A++){var B=q.value(A);if(B._statusUsed){var C=r.findVertexBuffer(B._linker);if(!C)throw new TError("Can't find renderable vertex buffer. (linker={1})",B._linker);h.setAttribute(B._name,C,C._formatCd)}}h=r.indexBuffer();f.drawTriangles(h,0,h.count())}
function FG3dEffect_drawRenderables(b,d,f,h){this._graphicContext.setProgram(this._program);for(var q=0;q<h;q++)this.drawRenderable(b,d.getAt(f+q))}function FG3dEffect_drawGroup(b,d,f,h){this.drawRenderables(b,d,f,h)}function FG3dEffect_drawRegion(b,d,f){for(var h=b.renderables(),q=0;q<f;){for(var z=q,A=f,B=h.at(d+z).materialReference(),C=q;C<f;C++){var D=h.at(d+C).materialReference();if(B!=D){A=C;break}q++}this.drawGroup(b,h,d+z,A-z)}}
function FG3dEffect_loadConfig(b){var d=this._graphicContext,f=this._program=d.createProgram();b=b.nodes();for(var d=b.count(),h=0;h<d;h++){var q=b.get(h);if(q.isName("State")){var z=q.get("name"),A=q.get("value");if("fill_mode"==z)this._stateFillCd=REnum.parse(EG3dFillMode,A);else if("cull_mode"==z)this._stateCullCd=REnum.parse(EG3dCullMode,A);else if("depth_mode"==z)this._stateDepth=!0,this._stateDepthCd=REnum.parse(EG3dDepthMode,A);else if("depth_write"==z)this._stateDepthWrite=RBoolean.parse(A);
else if("blend_mode"==z){if(this._stateBlend=RBoolean.parse(A))this._stateBlendSourceCd=REnum.parse(EG3dBlendMode,q.get("source")),this._stateBlendTargetCd=REnum.parse(EG3dBlendMode,q.get("target"))}else"alpha_test"==z&&(this._stateAlphaTest=RBoolean.parse(A))}else if(q.isName("Option"))z=q.get("name"),A=q.get("value"),"shadow"==z?this._optionShadow=RBoolean.parse(A):"lightmap"==z?this._optionLightMap=RBoolean.parse(A):"fog"==z&&(this._optionFog=RBoolean.parse(A));else if(q.isName("Parameter"))z=
RClass.create(FG3dProgramParameter),z.loadConfig(q),f.parameters().set(z.name(),z);else if(q.isName("Attribute"))z=RClass.create(FG3dProgramAttribute),z.loadConfig(q),f.attributes().set(z.name(),z);else if(q.isName("Sampler"))z=RClass.create(FG3dProgramSampler),z.loadConfig(q),f.samplers().set(z.name(),z);else if(q.isName("Source"))if(z=q.get("name"),"vertex"==z)this._vertexSource=q.value();else if("fragment"==z)this._fragmentSource=q.value();else throw new TError(this,"Unknown source type. (name={1})",
nt);else throw new TError(this,"Unknown config type. (name={1})",q.name());}(this._vertexTemplate=RClass.create(FG3dShaderTemplate)).load(this._vertexSource);(this._fragmentTemplate=RClass.create(FG3dShaderTemplate)).load(this._fragmentSource)}
function FG3dEffect_build(b){var d=this._program,f=d._parameters,h=f.count(),q=RInstance.get(FTagContext);this.buildInfo(q,b);b=this._vertexTemplate.parse(q);b=RString.formatLines(b);d.upload(EG3dShader.Vertex,b);q=this._fragmentTemplate.parse(q);for(b=0;b<h;b++){var z=f.value(b),A=z.name();(z=z.define())&&(q=q.replace(new RegExp(A,"g"),z))}f=RString.formatLines(q);d.upload(EG3dShader.Fragment,f);d.build();d.link()}
function FG3dEffect_load(){var b=RConsole.find(FG3dEffectConsole).loadConfig(this._code);this.loadConfig(b)}
function FG3dEffectConsole(b){b=RClass.inherits(this,b,FConsole);b._configs=null;b._loadEffects=null;b._registerEffects=null;b._templateEffects=null;b._effects=null;b._path="/ars/shader/";b._effectInfo=null;b._tagContext=null;b._thread=null;b._interval=300;b.onProcess=FG3dEffectConsole_onProcess;b.construct=FG3dEffectConsole_construct;b.path=FG3dEffectConsole_path;b.register=FG3dEffectConsole_register;b.unregister=FG3dEffectConsole_unregister;b.create=FG3dEffectConsole_create;b.buildEffectInfo=FG3dEffectConsole_buildEffectInfo;
b.findTemplate=FG3dEffectConsole_findTemplate;b.find=FG3dEffectConsole_find;b.loadConfig=FG3dEffectConsole_loadConfig;return b}function FG3dEffectConsole_onProcess(){var b=this._loadEffects;for(b.record();b.next();)b.current().processLoad()&&b.removeCurrent()}
function FG3dEffectConsole_construct(){this.__base.FConsole.construct.call(this);this._configs=new TDictionary;this._loadEffects=new TLooper;this._registerEffects=new TDictionary;this._templateEffects=new TDictionary;this._effects=new TDictionary;this._effectInfo=new SG3dEffectInfo;this._tagContext=RClass.create(FTagContext)}function FG3dEffectConsole_path(){return this._path}function FG3dEffectConsole_register(b,d){this._registerEffects.set(b,d)}
function FG3dEffectConsole_unregister(b){this._registerEffects.set(b,null)}function FG3dEffectConsole_create(b,d){var f=this._registerEffects.get(d);if(!f)throw new TError(this,"Unknown effect type name. (type={1})",f);f=RClass.create(f);f.linkGraphicContext(b);f.setup();return f}
function FG3dEffectConsole_buildEffectInfo(b,d,f,h){b=b.capability();f=f.technique();d.techniqueModeCode=f.activeMode().code();d.optionMerge=h._optionMerge;d.optionMerge&&(d.mergeCount=h.mergeMaxCount());f=h.material().info();d.optionNormalInvert=f.optionNormalInvert;d.optionColor=f.optionColor;d.optionAmbient=f.optionAmbient;d.optionDiffuse=f.optionDiffuse;d.optionSpecular=f.optionSpecular;d.optionReflect=f.optionReflect;d.optionRefract=f.optionRefract;d.vertexCount=h.vertexCount();var q=h.vertexBuffers();
f=q.count();for(var z=0;z<f;z++){var A=q.at(z);"normal"==A.name()&&(4==A.stride()?d.optionNormalCompress=!0:d.optionNormalCompress=!1);d.attributes.push(A.name())}if(q=h.textures())for(f=q.count(),z=0;z<f;z++)d.samplers.push(q.name(z));if(f=h.bones())f=f.count(),d.vertexBoneCount=f,b=b.calculateBoneCount(d.vertexBoneCount,d.vertexCount),f>b&&(f=b),h._boneLimit=f,d.vertexBoneLimit=f}
function FG3dEffectConsole_findTemplate(b,d){var f=this._templateEffects,h=f.get(d);null==h&&(h=this.create(b,d),h.load(),RLogger.info(this,"Create effect template. (code={1}, instance={2})",d,h),f.set(d,h));return h}
function FG3dEffectConsole_find(b,d,f){RClass.isClass(b,FGraphicContext)||(b=b.graphicContext());if(!RClass.isClass(b,FGraphicContext))throw new TError(this,"Unknown context.");var h=f.material().info().effectCode;RString.isEmpty(h)&&(h="automatic");"skeleton"!=h&&"skeleton.4"!=h||null!=f.bones()||(h="automatic");var q=d.spaceName()+"."+h,z=this.findTemplate(b,q);if(z){var A=this._effectInfo;A.reset();this.buildEffectInfo(b,A,d,f);z.buildInfo(this._tagContext,A);d=q+this._tagContext.code;f=this._effects;
A=f.get(d);A||(A=this.create(b,q),A._flag=d,A.load(),A.build(this._effectInfo),RLogger.info(this,"Create effect. (name={1}, instance={2})",h,A));f.set(d,A)}return A}function FG3dEffectConsole_loadConfig(b){var d=this._configs.get(b);if(d)return d;d=RBrowser.contentPath(this._path+b+".xml");RRuntime.isDebug()&&(d+="?"+RDate.format());d=RClass.create(FXmlConnection).send(d);this._configs.set(b,d);return d}function FG3dLight(b){return b=RClass.inherits(this,b,FObject)}
function FG3dLightMaterial(b){return b=RClass.inherits(this,b,FG3dBaseMaterial)}function FG3dMaterial(b){b=RClass.inherits(this,b,FG3dBaseMaterial);b._dirty=!0;b._textures=null;b.textures=FG3dMaterial_textures;b.update=FG3dMaterial_update;return b}function FG3dMaterial_textures(){return this._textures}function FG3dMaterial_update(){this._dirty=!0}
function FG3dMaterialMap(b){b=RClass.inherits(this,b,FObject,MGraphicObject);b._size=null;b._data=null;b._texture=null;b._stride=null;b._dirty=!1;b.construct=FG3dMaterialMap_construct;b.size=FG3dMaterialMap_size;b.data=FG3dMaterialMap_data;b.texture=FG3dMaterialMap_texture;b.setup=FG3dMaterialMap_setup;b.resize=FG3dMaterialMap_resize;b.setUint8=FG3dMaterialMap_setUint8;b.setUint16=FG3dMaterialMap_setUint16;b.setUint32=FG3dMaterialMap_setUint32;b.setFloat16=FG3dMaterialMap_setFloat16;b.setFloat32=
FG3dMaterialMap_setFloat32;b.update=FG3dMaterialMap_update;return b}function FG3dMaterialMap_construct(){this.__base.FObject.construct.call(this);this._size=new SSize2}function FG3dMaterialMap_size(){return this._size}function FG3dMaterialMap_data(){return this._data}function FG3dMaterialMap_texture(){return this._texture}
function FG3dMaterialMap_setup(b,d){var f=this._texture=this._graphicContext.createFlatTexture();this.resize(b,d);f.setFilterCd(EG3dSamplerFilter.Nearest,EG3dSamplerFilter.Nearest);f.uploadData(this._data,b,d)}function FG3dMaterialMap_resize(b,d){var f=this._size;2048<d?d=4096:1024<d?d=2048:512<d?d=1024:256<d?d=512:128<d?d=256:64<d?d=128:32<d?d=64:16<d&&(d=32);d<f.height&&(d=f.height);if(f.width!=b||f.height!=d)f.set(b,d),this._stride=4*b,this._data=new Uint8Array(4*b*d)}
function FG3dMaterialMap_setUint8(b,d,f,h,q,z){var A=this._data;b=this._stride*b+(d<<2);f.constructor==SColor4?(h=255*f.red,A[b]!=h&&(this._dirty=!0),A[b++]=h,h=255*f.green,A[b]!=h&&(this._dirty=!0),A[b++]=h,h=255*f.blue,A[b]!=h&&(this._dirty=!0),A[b++]=h,h=255*f.alpha,A[b]!=h&&(this._dirty=!0),A[b++]=h):(A[b++]=f,A[b++]=h,A[b++]=q,A[b++]=z)}
function FG3dMaterialMap_setUint16(b,d,f,h){var q=this._data;b=this._stride*b+(d<<2);q[b++]=f>>8&255;q[b++]=f&255;q[b++]=h>>8&255;q[b++]=h&255;this._dirty=!0}function FG3dMaterialMap_setUint32(b,d,f){var h=this._data;b=this._stride*b+(d<<2);h[b++]=f>>24&255;h[b++]=f>>16&255;h[b++]=f>>8&255;h[b++]=f&255;this._dirty=!0}
function FG3dMaterialMap_setFloat16(b,d,f,h){var q=this._data;b=this._stride*b+(d<<2);parseInt(256*f);q[b++]=parseInt(f)&255;q[b++]=parseInt(256*f)&255;q[b++]=parseInt(h)&255;q[b++]=parseInt(256*h)&255;this._dirty=!0}function FG3dMaterialMap_setFloat32(b,d,f){var h=this._data;b=this._stride*b+(d<<2);h[b++]=parseInt(.00390625*f)&255;h[b++]=parseInt(f)&255;h[b++]=parseInt(256*f)&255;h[b++]=parseInt(65536*f)&255;this._dirty=!0}
function FG3dMaterialMap_update(){if(this._dirty){var b=this._size;this._texture.uploadData(this._data,b.width,b.height);this._dirty=!1}}function FG3dMaterialTexture(b){b=RClass.inherits(this,b,FG3dMaterial);b._texture=null;b.construct=FG3dMaterialTexture_construct;return b}function FG3dMaterialTexture_construct(){}function FG3dObject(b){b=RClass.inherits(this,b,FObject,MGraphicObject);b.setup=FG3dObject_setup;b.dispose=FG3dObject_dispose;return b}function FG3dObject_setup(){}
function FG3dObject_dispose(){this.__base.MGraphicObject.dispose.call(this);this.__base.FObject.dispose.call(this)}function FG3dOrthoCamera(b){b=RClass.inherits(this,b,FG3dCamera);b._projection=null;b.construct=FG3dOrthoCamera_construct;b.projection=FG3dOrthoCamera_projection;b.updateFrustum=FG3dOrthoCamera_updateFrustum;b.updateFromCamera=FG3dOrthoCamera_updateFromCamera;b.updateFlatCamera=FG3dOrthoCamera_updateFlatCamera;return b}
function FG3dOrthoCamera_construct(){this.__base.FG3dCamera.construct.call(this);this._projection=RClass.create(FG3dOrthoProjection)}function FG3dOrthoCamera_projection(){return this._projection}function FG3dOrthoCamera_updateFrustum(){this.__base.FG3dCamera.updateFrustum.call(this);var b=this._projection,d=b._size,f=this._frustum;f.update(b._angle,d.width,d.height,b._znear,b._zfar,this._centerFront,this._centerBack,this._matrix);return f}
function FG3dOrthoCamera_updateFromCamera(b){b=b.updateFrustum();var d=this._direction;d.normalize();this._position.set(b.center.x-d.x*b.radius,b.center.y-d.y*b.radius,b.center.z-d.z*b.radius);this.lookAt(b.center.x,b.center.y,b.center.z);this.update();d=this._frustum;this._matrix.transform(d.coners,b.coners,8);d.updateCenter();this._projection.updateFrustum(d)}
function FG3dOrthoCamera_updateFlatCamera(b){var d=b.updateFlatFrustum(),f=RConst.DEGREE_RATE*this._projection.angle(),f=d.radius/Math.sin(.5*f),f=Math.max(f,b._projection._zfar);b=this._direction;b.normalize();this._position.set(d.center.x-b.x*f,d.center.y-b.y*f,d.center.z-b.z*f);this.lookAt(d.center.x,d.center.y,d.center.z);this.update();this._projection._znear=.3;this._projection._zfar=1.5*f;this._projection.update()}
function FG3dOrthoProjection(b){b=RClass.inherits(this,b,FG3dProjection);b._matrix=null;b.construct=FG3dOrthoProjection_construct;b.matrix=FG3dOrthoProjection_matrix;b.update=FG3dOrthoProjection_update;b.updateFrustum=FG3dOrthoProjection_updateFrustum;return b}function FG3dOrthoProjection_construct(){this.__base.FG3dProjection.construct.call(this);this._matrix=new SOrthoMatrix3d}function FG3dOrthoProjection_matrix(){return this._matrix}
function FG3dOrthoProjection_update(){var b=this._size;this._matrix.identity();var d=this._matrix.data();d[0]=2/b.width*8;d[4]=d[8]=d[12]=0;d[5]=2/b.height*8;d[1]=d[9]=d[13]=0;d[10]=1/(this._znear-this._zfar);d[2]=d[6]=d[14]=0;d[3]=d[7]=0;d[11]=this._znear/(this._znear-this._zfar);d[15]=1}function FG3dOrthoProjection_updateFrustum(b){this._znear=b.minZ;this._zfar=b.maxZ;this.update()}
function FG3dPerspectiveCamera(b){b=RClass.inherits(this,b,FG3dCamera);b._projection=null;b._centerFront=.4;b.construct=FG3dPerspectiveCamera_construct;b.projection=FG3dPerspectiveCamera_projection;b.updateFrustum=FG3dPerspectiveCamera_updateFrustum;b.updateFlatFrustum=FG3dPerspectiveCamera_updateFlatFrustum;b.updateFromCamera=FG3dPerspectiveCamera_updateFromCamera;b.updateFlatCamera=FG3dPerspectiveCamera_updateFlatCamera;return b}
function FG3dPerspectiveCamera_construct(){this.__base.FG3dCamera.construct.call(this);this._projection=RClass.create(FG3dPerspectiveProjection)}function FG3dPerspectiveCamera_projection(){return this._projection}function FG3dPerspectiveCamera_updateFrustum(){this.__base.FG3dCamera.updateFrustum.call(this);var b=this._projection,d=b._size,f=this._frustum;f.update(b._angle,d.width,d.height,b._znear,b._zfar,this._centerFront,this._centerBack,this._matrix);return f}
function FG3dPerspectiveCamera_updateFlatFrustum(){var b=this._projection,d=b._size,f=this._frustum;f.updateFlat(b._angle,d.width,d.height,b._znear,b._zfar,this._centerFront,this._centerBack,this._matrix);return f}
function FG3dPerspectiveCamera_updateFromCamera(b){var d=this._frustum,f=b.updateFrustum(),h=RConst.DEGREE_RATE*this._projection.angle(),h=f.radius/Math.sin(.5*h),h=Math.max(h,b._projection._zfar);b=this._direction;b.normalize();this._position.set(f.center.x-b.x*h,f.center.y-b.y*h,f.center.z-b.z*h);this.lookAt(f.center.x,f.center.y,f.center.z);this.update();this._matrix.transform(d.coners,0,f.coners,0,8);d.updateCenter();this._projection.updateFrustum(d)}
function FG3dPerspectiveCamera_updateFlatCamera(b){var d=b.updateFlatFrustum(),f=RConst.DEGREE_RATE*this._projection.angle(),f=d.radius/Math.sin(.5*f),f=Math.max(f,b._projection._zfar);b=this._direction;b.normalize();this._position.set(d.center.x-b.x*f*this._centerFront,d.center.y-b.y*f*this._centerFront,d.center.z-b.z*f*this._centerFront);this.lookAt(d.center.x,d.center.y,d.center.z);this.update();this._projection._znear=.1;this._projection._zfar=f;this._projection.update()}
function FG3dPerspectiveProjection(b){b=RClass.inherits(this,b,FG3dProjection);b._matrix=null;b.construct=FG3dPerspectiveProjection_construct;b.matrix=FG3dPerspectiveProjection_matrix;b.update=FG3dPerspectiveProjection_update;b.updateFrustum=FG3dPerspectiveProjection_updateFrustum;return b}function FG3dPerspectiveProjection_construct(){this.__base.FG3dProjection.construct.call(this);this._matrix=new SPerspectiveMatrix3d}function FG3dPerspectiveProjection_matrix(){return this._matrix}
function FG3dPerspectiveProjection_update(){var b=this._size;this._fieldOfView=RConst.DEGREE_RATE*this._angle;this._matrix.perspectiveFieldOfViewLH(this._fieldOfView,b.width/b.height,this._znear,this._zfar)}function FG3dPerspectiveProjection_updateFrustum(b){this._znear=b.minZ;this._zfar=b.maxZ;this.update()}function FG3dPointLight(b){return b=RClass.inherits(this,b,FG3dLight)}
function FG3dProjection(b){b=RClass.inherits(this,b,FObject);b._size=null;b._angle=60;b._fieldOfView=0;b._znear=.1;b._zfar=200;b._scale=0;b.construct=FG3dProjection_construct;b.size=FG3dProjection_size;b.angle=FG3dProjection_angle;b.znear=FG3dProjection_znear;b.zfar=FG3dProjection_zfar;b.distance=FG3dProjection_distance;return b}function FG3dProjection_construct(){this.__base.FObject.construct.call(this);this._size=new SSize2}function FG3dProjection_size(){return this._size}
function FG3dProjection_angle(){return this._angle}function FG3dProjection_znear(){return this._znear}function FG3dProjection_zfar(){return this._zfar}function FG3dProjection_distance(){return this._zfar-this._znear}function FG3dShaderTemplate(b){b=RClass.inherits(this,b,FTagDocument);b._space="shader";return b}function FG3dSpotLight(b){return b=RClass.inherits(this,b,FG3dLight)}
function FG3dTechnique(b){b=RClass.inherits(this,b,FG3dObject);b._code=null;b._activeMode=null;b._modes=null;b._passes=null;b.construct=FG3dTechnique_construct;b.code=FG3dTechnique_code;b.activeMode=FG3dTechnique_activeMode;b.modes=FG3dTechnique_modes;b.passes=FG3dTechnique_passes;b.registerMode=FG3dTechnique_registerMode;b.selectMode=FG3dTechnique_selectMode;b.updateRegion=RMethod.empty;b.clear=FG3dTechnique_clear;b.sortRenderables=FG3dTechnique_sortRenderables;b.drawRegion=FG3dTechnique_drawRegion;
b.present=FG3dTechnique_present;return b}function FG3dTechnique_construct(){this.__base.FG3dObject.construct.call(this);this._modes=new TObjects;this._passes=new TObjects}function FG3dTechnique_code(){return this._code}function FG3dTechnique_activeMode(){return this._activeMode}function FG3dTechnique_modes(){return this._modes}function FG3dTechnique_passes(){return this._passes}
function FG3dTechnique_registerMode(b){var d=RClass.create(FG3dTechniqueMode);d.setCode(b);this._modes.push(d);return this._activeMode=d}function FG3dTechnique_selectMode(b){}function FG3dTechnique_clear(b){var d=this._graphicContext;d.setRenderTarget(null);d.clear(b.red,b.green,b.blue,b.alpha,1)}function FG3dTechnique_sortRenderables(b,d){}
function FG3dTechnique_drawRegion(b){b.setTechnique(this);for(var d=this._passes,f=d.count(),h=0;h<f;h++){var q=d.get(h);b.setTechniquePass(q,h==f-1);q.drawRegion(b)}}function FG3dTechnique_present(b){this._graphicContext.present()}function FG3dTechniqueConsole(b){b=RClass.inherits(this,b,FConsole);b._techniques=null;b.construct=FG3dTechniqueConsole_construct;b.techniques=FG3dTechniqueConsole_techniques;b.find=FG3dTechniqueConsole_find;return b}
function FG3dTechniqueConsole_construct(){this.__base.FConsole.construct.call(this);this._techniques=new TDictionary}function FG3dTechniqueConsole_techniques(){return this._techniques}
function FG3dTechniqueConsole_find(b,d){RClass.isClass(b,FGraphicContext)||(b=b.graphicContext());if(!RClass.isClass(b,FGraphicContext))throw new TError(this,"Unknown context.");var f=b.hashCode()+"|"+RClass.name(d),h=this._techniques,q=h.get(f);if(!q){q=RClass.create(d);q.linkGraphicContext(b);q.setup();for(var z=q.code(),A=q.passes(),B=A.count(),C=0;C<B;C++){var D=A.at(C),E=D.code();D.setFullCode(z+"."+E)}h.set(f,q)}return q}
function FG3dTechniqueMode(b){b=RClass.inherits(this,b,FObject);b._code=null;b.code=FG3dTechniqueMode_code;b.setCode=FG3dTechniqueMode_setCode;return b}function FG3dTechniqueMode_code(){return this._code}function FG3dTechniqueMode_setCode(b){this._code=b}
function FG3dTechniquePass(b){b=RClass.inherits(this,b,FG3dObject);b._fullCode=null;b._code=null;b._index=null;b._finish=!1;b._materialMap=null;b.setup=FG3dTechniquePass_setup;b.fullCode=FG3dTechniquePass_fullCode;b.setFullCode=FG3dTechniquePass_setFullCode;b.code=FG3dTechniquePass_code;b.activeEffects=FG3dTechniquePass_activeEffects;b.sortRenderables=FG3dTechniquePass_sortRenderables;b.drawRegion=FG3dTechniquePass_drawRegion;return b}
function FG3dTechniquePass_setup(){var b=this._materialMap=RClass.create(FG3dMaterialMap);b.linkGraphicContext(this);b.setup(EG3dMaterialMap.Count,32)}function FG3dTechniquePass_fullCode(){return this._fullCode}function FG3dTechniquePass_setFullCode(b){this._fullCode=b}function FG3dTechniquePass_code(){return this._code}
function FG3dTechniquePass_sortRenderables(b,d){var f=b.material().info(),h=d.material().info();if(f.optionAlpha&&h.optionAlpha)return f=b.activeEffect(),h=d.activeEffect(),f==h&&(sm=b._materialReference,tm=d._materialReference,sm&&tm)?sm.hashCode()-tm.hashCode():f.hashCode()-h.hashCode();if(f.optionAlpha&&!h.optionAlpha)return 1;if(!f.optionAlpha&&h.optionAlpha)return-1;f=b.activeEffect();h=d.activeEffect();return f==h&&(sm=b._materialReference,tm=d._materialReference,sm&&tm)?sm.hashCode()-tm.hashCode():
f.hashCode()-h.hashCode()}function FG3dTechniquePass_activeEffects(b,d){for(var f=b.spaceName(),h=d.count()-1;0<=h;h--){var q=d.get(h),z=q.selectInfo(f);z.effect||(z.effect=RConsole.find(FG3dEffectConsole).find(this._graphicContext,b,q))}}
function FG3dTechniquePass_drawRegion(b){var d=b.renderables(),f=d.count();if(0!=f){b._statistics._frameDrawSort.begin();this.activeEffects(b,d);d.sort(this.sortRenderables);b._statistics._frameDrawSort.end();if(this._graphicContext.capability().optionMaterialMap){var h=this._materialMap;h.resize(EG3dMaterialMap.Count,f);for(var q=0;q<f;q++){var z=d.get(q);z._materialId=q;z=z.material().info();h.setUint8(q,EG3dMaterialMap.AmbientColor,z.ambientColor);h.setUint8(q,EG3dMaterialMap.DiffuseColor,z.diffuseColor);
h.setUint8(q,EG3dMaterialMap.SpecularColor,z.specularColor);h.setUint8(q,EG3dMaterialMap.ReflectColor,z.reflectColor);h.setUint8(q,EG3dMaterialMap.EmissiveColor,z.emissiveColor)}h.update();b._materialMap=h}for(h=0;h<f;){for(var z=h,A=f,B=d.getAt(z).activeEffect(),q=h;q<f;q++){var C=d.getAt(q).activeEffect();if(B!=C){A=q;break}h++}B.drawRegion(b,z,A-z)}}}function FG3dTrack(b){b=RClass.inherits(this,b,FObject);b._frames=null;b.construct=FG3dTrack_construct;b.calculate=FG3dTrack_calculate;return b}
function FG3dTrack_construct(){this.__base.FObject.construct.call(this)}function FG3dTrack_update(b){b=new SG3dFrameInfo;this._trackResource.calculateFrameInfo(b,tick);b.update();this._matrix.assign(this._trackResource.matrixInvert());this._matrix.append(b.matrix);return!0}
function FG3dTrack_calculate(b){var d=this._frames.count();if(0==d)return!1;0>b&&(b=-b);var f=this._frames.Get(index),h=null,h=index<d-1?this._frames.Get(index+1):this._frames.Get(0);info.tick=b;info.currentFrame=f;info.nextFrame=h;return!0}function FG3dViewport(b){b=RClass.inherits(this,b,FObject);b.left=0;b.top=0;b.width=0;b.height=0;b.set=FG3dViewport_set;return b}function FG3dViewport_set(b,d,f,h){this.left=b;this.top=d;this.width=f;this.height=h}
var REngine3d=new function(){this.contexts=new TObjects;this.createContext=REngine3d_createContext;return this};function REngine3d_createContext(b,d,f){b=RClass.create(b);f&&(b._optionAlpha=f.alpha,b._optionAntialias=f.antialias);b.linkCanvas(d);this.contexts.push(b);return b}
var EG3dAttribute=new function(){this.Position="position";this.Color="color";this.Coord="coord";this.Normal="normal";this.Binormal="binormal";this.Tangent="tangent";this.BoneIndex="bone_index";this.BoneWeight="bone_weight";return this},EG3dAttributeFormat=new function(){this.Unknown=0;this.Float1=1;this.Float2=2;this.Float3=3;this.Float4=4;this.Byte4=5;this.Byte4Normal=6;return this},EG3dBlendMode=new function(){this.Zero=0;this.One=1;this.SrcColor=2;this.OneMinusSrcColor=3;this.DstColor=4;this.OneMinusDstColor=
5;this.SrcAlpha=6;this.OneMinusSrcAlpha=7;this.DstAlpha=8;this.OneMinusDstAlpha=9;this.SrcAlphaSaturate=10;return this},EG3dCullMode=new function(){this.None=0;this.Front=1;this.Back=2;this.Both=3;return this},EG3dDepthMode=new function(){this.None=0;this.Equal=1;this.NotEqual=2;this.Less=3;this.LessEqual=4;this.Greater=5;this.GreaterEqual=6;this.Always=7;return this},EG3dFillMode=new function(){this.Unknown=0;this.Point=1;this.Line=2;this.Face=3;return this},EG3dIndexStride=new function(){this.Unknown=
0;this.Uint16=1;this.Uint32=2;return this},EG3dParameterFormat=new function(){this.Unknown=0;this.Float1=1;this.Float2=2;this.Float3=3;this.Float4=4;this.Float3x3=5;this.Float4x3=6;this.Float4x4=7;return this},EG3dSampler=new function(){this.Diffuse="diffuse";this.Alpha="alpha";this.Normal="normal";this.SpecularColor="specular.color";this.SpecularLevel="specular.level";this.Light="light";this.Reflect="reflect";this.Refract="refract";this.Emissive="emissive";this.Height="height";this.Environment="environment";
return this},EG3dSamplerFilter=new function(){this.Unknown=0;this.Nearest=1;this.Linear=2;this.Repeat=3;this.ClampToEdge=4;this.ClampToBorder=5;return this},EG3dShader=new function(){this.Unknown=0;this.Vertex=1;this.Fragment=2;return this},EG3dTexture=new function(){this.Unknown=0;this.Flat2d=1;this.Flat3d=2;this.Cube=3;return this};
function SG3dContextCapability(){this.shaderVersion=this.version=this.vendor=null;this.optionShaderSource=this.optionIndex32=this.optionMaterialMap=this.optionLayout=this.optionInstance=this.optionDebug=!1;this.mergeCount=0;this.attributeCount=null;this.vertexCount=65536;this.samplerCompressRgba=this.samplerCompressRgb=this.samplerSize=this.samplerCount=this.varyingCount=this.fragmentConst=this.vertexConst=null;this.calculateBoneCount=SG3dContextCapability_calculateBoneCount;this.calculateInstanceCount=
SG3dContextCapability_calculateInstanceCount;return this}function SG3dContextCapability_calculateBoneCount(b,d){var f=0,f=b%8,f=0!=f?b+8-f:b,h=(this.vertexConst-16)/4;return f>h?h:f}function SG3dContextCapability_calculateInstanceCount(b,d){var f=(this.vertexConst-16)/(4*b+4),h=cl;0<d&&(h=Math.min(f,this.vertexCount/d));64<h&&(h=64);return h}function SG3dLayoutBuffer(){this.formatCd=this.index=this.buffer=this.slot=null;this.dispose=SG3dLayoutBuffer_dispose;return this}
function SG3dLayoutBuffer_dispose(){this.formatCd=this.index=this.buffer=this.slot=null}function SG3dLayoutSampler(){this.slot=null;this.index=-1;this.texture=null;this.dispose=SG3dLayoutSampler_dispose;return this}function SG3dLayoutSampler_dispose(){this.slot=null;this.index=-1;this.texture=null}function FG3dBuffer(b){b=RClass.inherits(this,b,FG3dObject,MAttributeName);b.isValid=RMethod.virtual(b,"isValid");return b}
function FG3dContext(b){b=RClass.inherits(this,b,FGraphicContext);b._optionAlpha=!0;b._optionAntialias=!1;b._size=null;b._capability=null;b._statistics=null;b._fillModeCd=EG3dFillMode.Face;b._optionDepth=!1;b._optionCull=!1;b._depthModeCd=0;b._cullModeCd=0;b._statusBlend=!1;b._blendSourceCd=0;b._blendTargetCd=0;b._program=null;b.construct=FG3dContext_construct;b.linkCanvas=FG3dContext_linkCanvas;b.size=FG3dContext_size;b.capability=FG3dContext_capability;b.statistics=FG3dContext_statistics;b.createProgram=
RMethod.virtual(b,"createProgram");b.createLayout=RMethod.virtual(b,"createLayout");b.createVertexBuffer=RMethod.virtual(b,"createVertexBuffer");b.createIndexBuffer=RMethod.virtual(b,"createIndexBuffer");b.createFlatTexture=RMethod.virtual(b,"createFlatTexture");b.createCubeTexture=RMethod.virtual(b,"createCubeTexture");b.createRenderTarget=RMethod.virtual(b,"createRenderTarget");b.setViewport=RMethod.virtual(b,"setViewport");b.setFillMode=RMethod.virtual(b,"setFillMode");b.setDepthMode=RMethod.virtual(b,
"setDepthMode");b.setCullingMode=RMethod.virtual(b,"setCullingMode");b.setBlendFactors=RMethod.virtual(b,"setBlendFactors");b.setScissorRectangle=RMethod.virtual(b,"setScissorRectangle");b.setRenderTarget=RMethod.virtual(b,"setRenderTarget");b.setProgram=RMethod.virtual(b,"setProgram");b.bindVertexBuffer=RMethod.virtual(b,"bindVertexBuffer");b.bindTexture=RMethod.virtual(b,"bindTexture");b.prepare=FG3dContext_prepare;b.clear=RMethod.virtual(b,"clear");b.clearColor=RMethod.virtual(b,"clearColor");
b.clearDepth=RMethod.virtual(b,"clearDepth");b.drawTriangles=RMethod.virtual(b,"drawTriangles");b.present=RMethod.virtual(b,"present");b.dispose=FG3dContext_dispose;return b}function FG3dContext_construct(){this.__base.FGraphicContext.construct.call(this);this._size=new SSize2;this._statistics=RClass.create(FG3dStatistics);RConsole.find(FStatisticsConsole).register("graphic3d.context",this._statistics)}function FG3dContext_linkCanvas(b){this._size.set(b.width,b.height)}
function FG3dContext_size(){return this._size}function FG3dContext_capability(){return this._capability}function FG3dContext_statistics(){return this._statistics}function FG3dContext_prepare(){this._statistics.resetFrame()}function FG3dContext_dispose(){this._program=null;this.__base.FGraphicContext.dispose.call(this)}function FG3dCubeTexture(b){b=RClass.inherits(this,b,FG3dTexture);b.size=0;b.construct=FG3dTexture_construct;b.upload=RMethod.virtual(b,"upload");b.update=RMethod.empty;return b}
function FG3dTexture_construct(){this.__base.FG3dTexture.construct();this._textureCd=EG3dTexture.Cube}function FG3dFlatTexture(b){b=RClass.inherits(this,b,FG3dTexture);b._optionFlipY=!1;b._size=null;b.construct=FG3dFlatTexture_construct;b.optionFlipY=FG3dFlatTexture_optionFlipY;b.setOptionFlipY=FG3dFlatTexture_setOptionFlipY;b.size=FG3dFlatTexture_size;b.uploadData=RMethod.virtual(b,"uploadData");b.upload=RMethod.virtual(b,"upload");b.update=RMethod.empty;return b}
function FG3dFlatTexture_construct(){this.__base.FG3dTexture.construct();this._textureCd=EG3dTexture.Flat2d}function FG3dFlatTexture_optionFlipY(){return this._optionFlipY}function FG3dFlatTexture_setOptionFlipY(b){this._optionFlipY=b}function FG3dFlatTexture_size(){return this._size}function FG3dFragmentShader(b){return b=RClass.inherits(this,b,FG3dShader)}
function FG3dIndexBuffer(b){b=RClass.inherits(this,b,FG3dBuffer);b._strideCd=EG3dIndexStride.Uint16;b._count=0;b.strideCd=FG3dIndexBuffer_strideCd;b.count=FG3dIndexBuffer_count;b.upload=RMethod.virtual(b,"upload");return b}function FG3dIndexBuffer_strideCd(){return this._strideCd}function FG3dIndexBuffer_count(){return this._count}
function FG3dLayout(b){b=RClass.inherits(this,b,FG3dObject);b._buffers=null;b._samplers=null;b.buffers=FG3dLayout_buffers;b.linkBuffers=FG3dLayout_linkBuffers;b.bindBuffers=FG3dLayout_bindBuffers;b.samplers=FG3dLayout_samplers;b.linkSamplers=FG3dLayout_linkSamplers;b.bindSamplers=FG3dLayout_bindSamplers;b.unbindSamplers=FG3dLayout_unbindSamplers;b.dispose=FG3dLayout_dispose;return b}function FG3dLayout_construct(){this.__base.FG3dObject.construct.call(this)}
function FG3dLayout_buffers(){return this._buffers}function FG3dLayout_linkBuffers(b){if(!b.isEmpty()){var d=this._buffers;d||(d=this._buffers=new TObjects);d.assign(b)}}function FG3dLayout_bindBuffers(){var b=this._graphicContext,d=this._buffers;if(d)for(var f=d.count(),h=0;h<f;h++){var q=d.at(h);b.bindVertexBuffer(q.slot,q.buffer,q.index,q.formatCd)}}function FG3dLayout_samplers(){return this._samplers}
function FG3dLayout_linkSamplers(b){if(!b.isEmpty()){var d=this._samplers;d||(d=this._samplers=new TObjects);d.assign(b)}}function FG3dLayout_bindSamplers(){var b=this._graphicContext,d=this._samplers;if(d)for(var f=d.count(),h=0;h<f;h++){var q=d.at(h);b.bindTexture(q.slot,q.index,q.texture)}}function FG3dLayout_unbindSamplers(){var b=this._graphicContext,d=this._samplers;if(d)for(var f=d.count(),h=0;h<f;h++){var q=d.at(h);b.bindTexture(q.slot,q.index,null)}}
function FG3dLayout_dispose(){this._buffers=RObject.dispose(this._buffers);this._samplers=RObject.dispose(this._samplers);this.__base.FG3dObject.dispose.call(this)}
function FG3dProgram(b){b=RClass.inherits(this,b,FG3dObject);b._attributes=null;b._parameters=null;b._samplers=null;b._vertexShader=null;b._fragmentShader=null;b.hasAttribute=FG3dProgram_hasAttribute;b.registerAttribute=FG3dProgram_registerAttribute;b.findAttribute=FG3dProgram_findAttribute;b.attributes=FG3dProgram_attributes;b.hasParameter=FG3dProgram_hasParameter;b.registerParameter=FG3dProgram_registerParameter;b.findParameter=FG3dProgram_findParameter;b.parameters=FG3dProgram_parameters;b.hasSampler=
FG3dProgram_hasSampler;b.registerSampler=FG3dProgram_registerSampler;b.findSampler=FG3dProgram_findSampler;b.samplers=FG3dProgram_samplers;b.vertexShader=RMethod.virtual(b,"vertexShader");b.fragmentShader=RMethod.virtual(b,"fragmentShader");b.setAttribute=FG3dProgram_setAttribute;b.setParameter=FG3dProgram_setParameter;b.setParameter4=FG3dProgram_setParameter4;b.setSampler=FG3dProgram_setSampler;b.upload=RMethod.virtual(b,"upload");return b}
function FG3dProgram_hasAttribute(){var b=this._attributes;return b?!b.isEmpty():!1}function FG3dProgram_registerAttribute(b){var d=RClass.create(FG3dProgramAttribute);d._name=b;this.attributes().set(b,d);return d}function FG3dProgram_findAttribute(b){return this._attributes?this._attributes.get(b):null}function FG3dProgram_attributes(){var b=this._attributes;null==b&&(b=this._attributes=new TDictionary);return b}
function FG3dProgram_hasParameter(){var b=this._parameters;return b?!b.isEmpty():!1}function FG3dProgram_registerParameter(b,d){var f=RClass.create(FG3dProgramParameter);f._name=b;f.formatCd=d;this.parameters().set(b,f);return f}function FG3dProgram_findParameter(b){return this._parameters?this._parameters.get(b):null}function FG3dProgram_parameters(){var b=this._parameters;null==b&&(b=this._parameters=new TDictionary);return b}
function FG3dProgram_hasSampler(){var b=this._samplers;return b?!b.isEmpty():!1}function FG3dProgram_registerSampler(b){var d=RClass.create(FG3dProgramSampler);d._name=b;this.samplers().set(b,d);return d}function FG3dProgram_findSampler(b){return this._samplers?this._samplers.get(b):null}function FG3dProgram_samplers(){var b=this._samplers;null==b&&(b=this._samplers=new TDictionary);return b}
function FG3dProgram_setAttribute(b,d,f){var h=this.findAttribute(b);if(null==h)throw new TError(this,"Bind invalid attribute. (name={1})",b);this._graphicContext.bindVertexBuffer(h._slot,d,0,f)}
function FG3dProgram_setParameter(b,d,f){var h=this.findParameter(b);if(null==h)throw new TError(this,"Bind invalid parameter. (name={1})",b);var q=null,q=d.constructor;if(q==Float32Array||q==SMatrix3d||q==SPerspectiveMatrix3d)q=d;else if(q==SColor4)q=RTypeArray.float4(),q[0]=d.red,q[1]=d.green,q[2]=d.blue,q[3]=d.alpha;else if(q==SPoint3||q==SVector3)q=RTypeArray.float3(),q[0]=d.x,q[1]=d.y,q[2]=d.z;else if(q==SPoint4||q==SVector4)q=RTypeArray.float4(),q[0]=d.x,q[1]=d.y,q[2]=d.z,q[3]=d.w;else throw new TError(this,
"Bind invalid parameter type. (name={1}, type={2})",b,q);h.attachData(q)&&this._graphicContext.bindConst(null,h._slot,h._formatCd,q,f)}function FG3dProgram_setParameter4(b,d,f,h,q){var z=RTypeArray.float4();z[0]=d;z[1]=f;z[2]=h;z[3]=q;this.setParameter(b,z,1)}function FG3dProgram_setSampler(b,d){var f=this.findSampler(b);if(null==f)throw new TError(this,"Bind invalid sampler. (name={1})",b);this._graphicContext.bindTexture(f._slot,f._index,d)}
function FG3dProgramAttribute(b){b=RClass.inherits(this,b,FObject);b._name=null;b._linker=null;b._statusUsed=!1;b._slot=-1;b._index=-1;b._formatCd=EG3dAttributeFormat.Unknown;b.name=FG3dProgramAttribute_name;b.linker=FG3dProgramAttribute_linker;b.loadConfig=FG3dProgramAttribute_loadConfig;return b}function FG3dProgramAttribute_name(){return this._name}function FG3dProgramAttribute_linker(){return this._linker}
function FG3dProgramAttribute_loadConfig(b){this._name=b.get("name");this._linker=b.get("linker");this._formatCd=REnum.encode(EG3dAttributeFormat,b.get("format"))}
function FG3dProgramParameter(b){b=RClass.inherits(this,b,FObject);b._name=null;b._linker=null;b._formatCd=EG3dParameterFormat.Unknown;b._define=null;b._statusUsed=!1;b._slot=null;b._size=0;b._buffer=null;b._memory=null;b.name=FG3dProgramParameter_name;b.linker=FG3dProgramParameter_linker;b.define=FG3dProgramParameter_define;b.attachData=FG3dProgramParameter_attachData;b.loadConfig=FG3dProgramParameter_loadConfig;return b}function FG3dProgramParameter_name(){return this._name}
function FG3dProgramParameter_linker(){return this._linker}function FG3dProgramParameter_define(){return this._define}function FG3dProgramParameter_attachData(b){var d=!1,d=b.constructor;if(d==SMatrix3d)d=this._memory,d||(d=this._memory=new Float32Array(16)),d=RFloat.attach(d,b._data,16);else if(d==Float32Array){var f=b.length,d=this._memory;d||(d=this._memory=new Float32Array(f));d=RFloat.attach(d,b,f)}else throw new TError(this,"Unknown data type.");return d}
function FG3dProgramParameter_loadConfig(b){this._name=b.get("name");this._linker=b.get("linker");this._formatCd=REnum.encode(EG3dParameterFormat,b.get("format"));this._define=b.get("define")}
function FG3dProgramSampler(b){b=RClass.inherits(this,b,FObject);b._name=null;b._linker=null;b._statusUsed=!1;b._formatCd=EG3dTexture.Flat2d;b._bind=!0;b._slot=-1;b._index=0;b._source=null;b.name=FG3dProgramSampler_name;b.linker=FG3dProgramSampler_linker;b.formatCd=FG3dProgramSampler_formatCd;b.loadConfig=FG3dProgramSampler_loadConfig;return b}function FG3dProgramSampler_name(){return this._name}function FG3dProgramSampler_linker(){return this._linker}
function FG3dProgramSampler_formatCd(){return this._formatCd}function FG3dProgramSampler_loadConfig(b){this._name=b.get("name");this._linker=b.get("linker");this._bind=RBoolean.parse(b.get("bind","Y"));this._formatCd=REnum.encode(EG3dTexture,b.get("format","Flat2d"))}
function FG3dRenderTarget(b){b=RClass.inherits(this,b,FG3dObject);b._size=null;b._color=null;b._textures=null;b.construct=FG3dRenderTarget_construct;b.size=FG3dRenderTarget_size;b.color=FG3dRenderTarget_color;b.textures=FG3dRenderTarget_textures;return b}function FG3dRenderTarget_construct(){this.__base.FG3dObject.construct();this._size=new SSize2;this._color=new SColor4;this._color.set(0,0,0,1)}function FG3dRenderTarget_size(){return this._size}
function FG3dRenderTarget_color(){return this._color}function FG3dRenderTarget_textures(){var b=this._textures;null==b&&(b=this._textures=new TObjects);return b}function FG3dShader(b){b=RClass.inherits(this,b,FG3dObject);b._source=null;b.source=FG3dShader_source;b.upload=RMethod.virtual(b,"upload");return b}function FG3dShader_source(){return this._source}
function FG3dStatistics(b){b=RClass.inherits(this,b,FStatistics);b._frameClearCount=0;b._frameFillModeCount=0;b._frameDepthModeCount=0;b._frameCullModeCount=0;b._frameBlendModeCount=0;b._frameProgramCount=0;b._frameConstCount=0;b._frameConstLength=0;b._frameBufferCount=0;b._frameTextureCount=0;b._frameTargetCount=0;b._frameDrawCount=0;b._frameTriangleCount=0;b._programTotal=0;b._layoutTotal=0;b._vertexBufferTotal=0;b._indexBufferTotal=0;b._flatTextureTotal=0;b._cubeTextureTotal=0;b._targetTotal=0;
b.reset=FG3dStatistics_reset;b.resetFrame=FG3dStatistics_resetFrame;return b}function FG3dStatistics_reset(){o._programTotal=0;o._layoutTotal=0;o._vertexBufferTotal=0;o._indexBufferTotal=0;o._flatTextureTotal=0;o._cubeTextureTotal=0;o._targetTotal=0}
function FG3dStatistics_resetFrame(){this._frameDrawCount=this._frameTriangleCount=this._frameTargetCount=this._frameTextureCount=this._frameBufferCount=this._frameConstLength=this._frameConstCount=this._frameProgramCount=this._frameBlendModeCount=this._frameCullModeCount=this._frameDepthModeCount=this._frameFillModeCount=this._frameClearCount=0}
function FG3dTexture(b){b=RClass.inherits(this,b,FG3dObject);b._textureCd=EG3dTexture.Unknown;b._filterMinCd=EG3dSamplerFilter.Linear;b._filterMagCd=EG3dSamplerFilter.Linear;b._wrapS=EG3dSamplerFilter.Unknown;b._wrapT=EG3dSamplerFilter.Unknown;b._statusLoad=!1;b.isValid=RMethod.virtual(b,"isValid");b.textureCd=FG3dTexture_textureCd;b.filterMinCd=FG3dTexture_filterMinCd;b.filterMagCd=FG3dTexture_filterMagCd;b.setFilterCd=FG3dTexture_setFilterCd;b.wrapS=FG3dTexture_wrapS;b.wrapT=FG3dTexture_wrapT;b.setWrapCd=
FG3dTexture_setWrapCd;return b}function FG3dTexture_textureCd(){return this._textureCd}function FG3dTexture_filterMinCd(){return this._filterMinCd}function FG3dTexture_filterMagCd(){return this._filterMagCd}function FG3dTexture_setFilterCd(b,d){this._filterMinCd=b;this._filterMagCd=d}function FG3dTexture_wrapS(){return this._wrapS}function FG3dTexture_wrapT(){return this._wrapT}function FG3dTexture_setWrapCd(b,d){this._wrapS=b;this._wrapT=d}
function FG3dVertexBuffer(b){b=RClass.inherits(this,b,FG3dBuffer);b._formatCd=EG3dAttributeFormat.Unknown;b._stride=0;b._count=0;b.formatCd=FG3dVertexBuffer_formatCd;b.stride=FG3dVertexBuffer_stride;b.count=FG3dVertexBuffer_count;b.upload=RMethod.virtual(b,"upload");return b}function FG3dVertexBuffer_formatCd(){return this._formatCd}function FG3dVertexBuffer_stride(){return this._stride}function FG3dVertexBuffer_count(){return this._count}
function FG3dVertexShader(b){return b=RClass.inherits(this,b,FG3dShader)}
function FG3dAutomaticEffect(b){b=RClass.inherits(this,b,FG3dEffect);b._optionMerge=!1;b._optionBlendMode=!0;b._supportInstance=!1;b._supportLayout=!1;b._supportMaterialMap=!1;b._supportVertexColor=!0;b._supportVertexCoord=!0;b._supportVertexNormal=!0;b._supportVertexNormalFull=!0;b._supportVertexNormalCompress=!1;b._supportSkeleton=!1;b._supportAlpha=!0;b._supportAmbient=!0;b._supportDiffuse=!0;b._supportDiffuseView=!0;b._supportSpecularColor=!0;b._supportSpecularLevel=!0;b._supportSpecularView=
!0;b._supportLight=!0;b._supportReflect=!0;b._supportRefract=!0;b._supportEmissive=!0;b._supportHeight=!0;b._supportEnvironment=!0;b._dynamicSkeleton=!0;b.setup=FG3dAutomaticEffect_setup;b.buildInfo=FG3dAutomaticEffect_buildInfo;b.bindAttributes=FG3dAutomaticEffect_bindAttributes;b.bindSamplers=FG3dAutomaticEffect_bindSamplers;b.bindMaterialSamplers=FG3dAutomaticEffect_bindMaterialSamplers;b.bindMaterial=FG3dAutomaticEffect_bindMaterial;b.drawRenderable=FG3dAutomaticEffect_drawRenderable;return b}
function FG3dAutomaticEffect_setup(){this._supportLayout=this._graphicContext.capability().optionLayout}
function FG3dAutomaticEffect_buildInfo(b,d){var f=this._graphicContext.capability(),h=new TString;h.append(d.techniqueModeCode);b.set("technique.mode",d.techniqueModeCode);if(this._optionMerge=d.optionMerge){var q=d.mergeCount;h.append("|OI"+q);b.setBoolean("option.instance",!0);b.set("instance.count",q)}f.optionMaterialMap&&(h.append("|OM"),b.setBoolean("option.material.map",!0),this._supportMaterialMap=!0);d.optionNormalInvert&&(h.append("|ON"),b.setBoolean("option.normal.invert",!0),this._supportNormalInvert=
!0);d.optionColor&&(h.append("|OC"),b.setBoolean("option.color",!0),this.optionAmbient=!0);d.optionAmbient&&(h.append("|OA"),b.setBoolean("option.ambient",!0),this.optionAmbient=!0);d.optionDiffuse&&(h.append("|OD"),b.setBoolean("option.diffuse",!0),this.optionDiffuse=!0);d.optionSpecular&&(h.append("|OS"),b.setBoolean("option.specular",!0),this.optionSpecular=!0);d.optionReflect&&(h.append("|ORL"),b.setBoolean("option.reflect",!0),this.optionReflect=!0);d.optionRefract&&(h.append("|ORF"),b.setBoolean("option.refract",
!0),this.optionRefract=!0);q=d.attributeContains(EG3dAttribute.Color);if(this._dynamicVertexColor=this._supportVertexColor&&q)h.append("|AC"),b.setBoolean("vertex.attribute.color",!0);q=d.attributeContains(EG3dAttribute.Coord);if(this._dynamicVertexCoord=this._supportVertexCoord&&q)h.append("|AD"),b.setBoolean("vertex.attribute.coord",!0);q=d.attributeContains(EG3dAttribute.Normal);if(this._dynamicVertexNormal=this._supportVertexNormal&&q)h.append("|AN"),b.setBoolean("vertex.attribute.normal",!0);
var z=d.attributeContains(EG3dAttribute.Binormal),A=d.attributeContains(EG3dAttribute.Tangent);if(this._dynamicVertexNormalFull=this._supportVertexNormalFull&&q&&z&&A)h.append("|ANF"),b.setBoolean("vertex.attribute.normal.full",!0);if(this._dynamicVertexNormalCompress=d.optionNormalCompress)h.append("|ANC"),b.setBoolean("vertex.attribute.normal.compress",!0);if(this._dynamicInstance=this._supportInstance&&f.optionInstance)h.append("|SI"),d&&b.setBoolean("support.instance",!0);if(this._dynamicSkeleton=
this._supportSkeleton)h.append("|SS"),d&&b.setBoolean("support.skeleton",!0);q=d.samplerContains(EG3dSampler.Diffuse);(this._dynamicAlpha=this._supportAlpha)?(h.append("|RA"),d&&b.setBoolean("support.alpha",!0),this._optionBlendMode=!0):this._optionBlendMode=!1;if(this._dynamicAmbient=this._supportAmbient)h.append("|TA"),d&&b.setBoolean("support.ambient",!0),q&&(h.append("|TAS"),d&&b.setBoolean("support.ambient.sampler",!0));d.samplerContains(EG3dSampler.Alpha)&&b.setBoolean("support.alpha.sampler",
!0);q=d.samplerContains(EG3dSampler.Normal);this._dynamicDiffuse=this._supportDiffuse&&(this._dynamicVertexNormal||q);this._supportDiffuse&&(d&&b.setBoolean("support.diffuse",!0),q?(h.append("|TDD"),d&&(b.setBoolean("support.dump",!0),b.setBoolean("support.diffuse.dump",!0))):this._dynamicVertexNormal&&(h.append("|TDN"),d&&b.setBoolean("support.diffuse.normal",!0)));this._dynamicDiffuseView=this._supportDiffuseView&&(this._dynamicVertexNormal||q);this._supportDiffuseView&&(d&&b.setBoolean("support.diffuse.view",
!0),q?(h.append("|TDVD"),d&&(b.setBoolean("support.dump",!0),b.setBoolean("support.diffuse.view.dump",!0))):this._dynamicVertexNormal&&(h.append("|TDVN"),d&&b.setBoolean("support.diffuse.view.normal",!0)));q=d.samplerContains(EG3dSampler.SpecularColor);z=d.samplerContains(EG3dSampler.SpecularLevel);this._dynamicSpecularColor=this._supportSpecularColor&&q;this._dynamicSpecularLevel=this._supportSpecularLevel&&z;(this._dynamicSpecularColor||this._dynamicSpecularLevel)&&this._dynamicVertexNormal&&(h.append("|TS"),
d&&b.setBoolean("support.specular",!0),this._dynamicSpecularColor&&(h.append("|TSC"),d&&b.setBoolean("support.specular.color",!0)),this._dynamicSpecularLevel?(h.append("|TSL"),d&&b.setBoolean("support.specular.level",!0)):(h.append("|NSL"),d&&b.setBoolean("support.specular.normal",!0)));(this._dynamicSpecularView=this._supportSpecularView)&&this._dynamicVertexNormal&&(h.append("|TSV"),d&&b.setBoolean("support.specular.view",!0),this._dynamicSpecularColor&&(h.append("|TSVC"),d&&b.setBoolean("support.specular.view.color",
!0)),this._dynamicSpecularLevel?(h.append("|TSVL"),d&&b.setBoolean("support.specular.view.level",!0)):(h.append("|NSVL"),d&&b.setBoolean("support.specular.view.normal",!0)));q=d.samplerContains(EG3dSampler.Light);if(this._dynamicLight=this._supportLight&&q)h.append("|TL"),d&&(b.setBoolean("support.sampler.light",!0),b.setBoolean("support.light",!0));q=d.samplerContains(EG3dSampler.Reflect);if(this._dynamicReflect=this._supportReflect&&q)h.append("|TRL"),d&&(b.setBoolean("support.sampler.light",!0),
b.setBoolean("support.reflect",!0));q=d.samplerContains(EG3dSampler.Refract);if(this._dynamicRefract=this._supportRefract&&q)h.append("|TRF"),d&&(b.setBoolean("support.sampler.light",!0),b.setBoolean("support.refract",!0));q=d.samplerContains(EG3dSampler.Emissive);if(this._dynamicEmissive=this._supportEmissive&&q)h.append("|TLE"),d&&(b.setBoolean("support.sampler.light",!0),b.setBoolean("support.emissive",!0));q=d.samplerContains(EG3dSampler.Height);if(this._dynamicHeight=this._supportHeight&&q)h.append("|TH"),
d&&b.setBoolean("support.height",!0);q=d.samplerContains(EG3dSampler.Environment);if(this._dynamicEnvironment=this._supportEnvironment&&q)h.append("|TE"),d&&b.setBoolean("support.environment",!0);this._dynamicSkeleton&&(f=f.calculateBoneCount(d.vertexBoneCount,d.vertexCount),h.append("|B"+f),b.set("bone.count",f),b.setBoolean("support.bone.weight.1",!0),b.setBoolean("support.bone.weight.2",!0),b.setBoolean("support.bone.weight.3",!0),b.setBoolean("support.bone.weight.4",!0));b.code=h.flush()}
function FG3dAutomaticEffect_bindAttributes(b){var d=this._program;if(d.hasAttribute())for(var f=d.attributes(),h=f.count(),q=0;q<h;q++){var z=f.at(q);if(z._statusUsed){var A=b.findVertexBuffer(z._linker);d.setAttribute(z._name,A,A._formatCd)}}}
function FG3dAutomaticEffect_bindSamplers(b){var d=this._program;this._supportMaterialMap&&d.setSampler("fs_material",region.materialMap().texture());if(d.hasSampler())for(var f=d.samplers(),h=f.count(),q=0;q<h;q++){var z=f.at(q);if(z._bind&&z._statusUsed){var A=z.linker(),A=b.findTexture(A);d.setSampler(z.name(),A.texture())}}}
function FG3dAutomaticEffect_bindMaterialSamplers(b,d){var f=this._program;if(f.hasSampler())for(var h=f.samplers(),q=h.count(),z=0;z<q;z++){var A=h.at(z);if(A._bind&&A._statusUsed){var B=A.linker(),B=d.findBitmap(B);f.setSampler(A.name(),B.texture())}}}
function FG3dAutomaticEffect_bindMaterial(b){var d=this._graphicContext;b=b.info();b.optionDepth?d.setDepthMode(this._stateDepth,this._stateDepthCd):d.setDepthMode(!1);b.optionAlpha?d.setBlendFactors(this._stateBlend,this._stateBlendSourceCd,this._stateBlendTargetCd):d.setBlendFactors(!1);b.optionDouble?d.setCullingMode(!1):d.setCullingMode(this._stateDepth,this._stateCullCd)}
function FG3dAutomaticEffect_drawRenderable(b,d){var f=this._graphicContext,h=d.activeInfo(),q=h.layout;q?(this._supportLayout?q.active():q.bindBuffers(),q.bindSamplers()):(q=h.layout=f.createLayout(),this._supportLayout?(q.bind(),this.bindAttributes(d),q.unbind(),q.active()):(f.recordBegin(),this.bindAttributes(d),f.recordEnd(),q.linkBuffers(f.recordBuffers())),f.recordBegin(),this.bindSamplers(d),f.recordEnd(),q.linkSamplers(f.recordSamplers()));var h=0,z=d.indexBuffers();z&&(h=z.count());if(1<
h)for(var A=d.materials(),B=0;B<h;B++){var C=z.at(B);if(A){var D=A.at(B);D&&this.bindMaterialSamplers(d,D)}f.drawTriangles(C)}else f.drawTriangles(d.indexBuffer());this._supportLayout&&q.deactive()}function FG3dSelectAutomaticEffect(b){b=RClass.inherits(this,b,FG3dAutomaticEffect);b._code="select.automatic";b.drawRenderable=FG3dSelectAutomaticEffect_drawRenderable;return b}
function FG3dSelectAutomaticEffect_drawRenderable(b,d,f){var h=this._graphicContext,q=h.size(),z=this._program,A=b._selectX,B=b._selectY,C=d.material(),D=C.info();this.bindMaterial(C);z.setParameter("vc_model_matrix",d.currentMatrix());z.setParameter("vc_vp_matrix",b.calculate(EG3dRegionParameter.CameraViewProjectionMatrix));z.setParameter4("vc_offset",q.width,q.height,1-A/q.width*2,B/q.height*2-1);b=f+1;z.setParameter4("fc_index",(b&255)/255,(b>>8&255)/255,(b>>16&255)/255,D.alphaBase);this.bindAttributes(d);
this.bindSamplers(d);h.drawTriangles(d.indexBuffer())}function FG3dSelectPass(b){b=RClass.inherits(this,b,FG3dTechniquePass);b._code="select";b._texture=null;b._renderTarget=null;b._position=null;b._data=null;b.construct=FG3dSelectPass_construct;b.setup=FG3dSelectPass_setup;b.textureDepth=FG3dSelectPass_texture;b.drawRegion=FG3dSelectPass_drawRegion;return b}
function FG3dSelectPass_construct(){this.__base.FG3dTechniquePass.construct.call(this);this._data=new Uint8Array(4);this._position=new SPoint2}
function FG3dSelectPass_setup(){this.__base.FG3dTechniquePass.setup.call(this);var b=this._graphicContext,d=this._texture=b.createFlatTexture();d.setFilterCd(EG3dSamplerFilter.Nearest,EG3dSamplerFilter.Nearest);d.setWrapCd(EG3dSamplerFilter.ClampToEdge,EG3dSamplerFilter.ClampToEdge);b=this._renderTarget=b.createRenderTarget();b.size().set(1,1);b.textures().push(d);b.build()}function FG3dSelectPass_texture(){return this._texture}
function FG3dSelectPass_drawRegion(b){var d=this._graphicContext,f=d._native;d.setRenderTarget(this._renderTarget);d.clear(0,0,0,0,1,1);var h=b.allRenderables();this.activeEffects(b,h);for(var q=h.count(),z=0;z<q;z++){var A=h.get(z),B=A.activeEffect();d.setProgram(B.program());var C=A.display();C?C._optionFace||B.drawRenderable(b,A,z):B.drawRenderable(b,A,z)}d.clearDepth(1);for(z=0;z<q;z++)A=h.get(z),B=A.activeEffect(),d.setProgram(B.program()),(C=A.display())&&C._optionFace&&B.drawRenderable(b,A,
z);f.readPixels(0,0,1,1,f.RGBA,f.UNSIGNED_BYTE,this._data);b=this._data[0]+(this._data[1]<<8)+(this._data[2]<<16);this._selectRenderable=null;0!=b&&(this._selectRenderable=h.get(b-1))}function FG3dSelectSkeletonEffect(b){b=RClass.inherits(this,b,FG3dAutomaticEffect);b._code="select.automatic";b.drawRenderable=FG3dSelectSkeletonEffect_drawRenderable;return b}
function FG3dSelectSkeletonEffect_drawRenderable(b,d,f){var h=this._graphicContext,q=h.size(),z=this._program,A=b._selectX,B=b._selectY,C=d.material(),D=C.info();this.bindMaterial(C);z.setParameter("vc_model_matrix",d.currentMatrix());z.setParameter("vc_vp_matrix",b.calculate(EG3dRegionParameter.CameraViewProjectionMatrix));z.setParameter4("vc_offset",q.width,q.height,1-A/q.width*2,B/q.height*2-1);b=f+1;z.setParameter4("fc_index",(b&255)/255,(b>>8&255)/255,(b>>16&255)/255,D.alphaBase);this.bindAttributes(d);
this.bindSamplers(d);h.drawTriangles(d.indexBuffer())}function FG3dSelectTechnique(b){b=RClass.inherits(this,b,FG3dTechnique);b._code="select";b._passSelect=null;b.setup=FG3dSelectTechnique_setup;b.passSelect=FG3dSelectTechnique_passSelect;b.test=FG3dSelectTechnique_test;return b}
function FG3dSelectTechnique_setup(){this.__base.FG3dTechnique.setup.call(this);this.registerMode(EG3dTechniqueMode.Result);var b=this._passSelect=RClass.create(FG3dSelectPass);b.linkGraphicContext(this);b.setup();this._passes.push(b)}function FG3dSelectTechnique_passSelect(){return this._passSelect}function FG3dSelectTechnique_test(b,d,f){b._selectX=d;b._selectY=f;b.setTechnique(this);this.drawRegion(b);return this._passSelect._selectRenderable}
function FWglContext(b){b=RClass.inherits(this,b,FG3dContext);b._native=null;b._nativeInstance=null;b._nativeLayout=null;b._nativeDebugShader=null;b._activeRenderTarget=null;b._activeTextureSlot=null;b._parameters=null;b._extensions=null;b._statusRecord=!1;b._recordBuffers=null;b._recordSamplers=null;b._data9=null;b._data16=null;b.construct=FWglContext_construct;b.linkCanvas=FWglContext_linkCanvas;b.parameters=FWglContext_parameters;b.extensions=FWglContext_extensions;b.recordBuffers=FWglContext_recordBuffers;
b.recordSamplers=FWglContext_recordSamplers;b.recordBegin=FWglContext_recordBegin;b.recordEnd=FWglContext_recordEnd;b.createProgram=FWglContext_createProgram;b.createLayout=FWglContext_createLayout;b.createVertexBuffer=FWglContext_createVertexBuffer;b.createIndexBuffer=FWglContext_createIndexBuffer;b.createFlatTexture=FWglContext_createFlatTexture;b.createCubeTexture=FWglContext_createCubeTexture;b.createRenderTarget=FWglContext_createRenderTarget;b.setViewport=FWglContext_setViewport;b.setFillMode=
FWglContext_setFillMode;b.setDepthMode=FWglContext_setDepthMode;b.setCullingMode=FWglContext_setCullingMode;b.setBlendFactors=FWglContext_setBlendFactors;b.setScissorRectangle=FWglContext_setScissorRectangle;b.setRenderTarget=FWglContext_setRenderTarget;b.setProgram=FWglContext_setProgram;b.bindConst=FWglContext_bindConst;b.bindVertexBuffer=FWglContext_bindVertexBuffer;b.bindTexture=FWglContext_bindTexture;b.clear=FWglContext_clear;b.clearColor=FWglContext_clearColor;b.clearDepth=FWglContext_clearDepth;
b.readPixels=FWglContext_readPixels;b.drawTriangles=FWglContext_drawTriangles;b.present=FWglContext_present;b.checkError=FWglContext_checkError;return b}function FWglContext_construct(){this.__base.FG3dContext.construct.call(this);this._capability=new SG3dContextCapability;this._data9=new Float32Array(9);this._data16=new Float32Array(16);this._recordBuffers=new TObjects;this._recordSamplers=new TObjects}
function FWglContext_linkCanvas(b){this.__base.FG3dContext.linkCanvas.call(this,b);this._hCanvas=b;if(b.getContext){var d={};d.alpha=this._optionAlpha;d.antialias=this._optionAntialias;var f=b.getContext("experimental-webgl",d);null==f&&(f=b.getContext("webgl",d));if(null==f)throw new TError("Current browser can't support WebGL technique.");this._native=f;this._contextAttributes=f.getContextAttributes()}d=this._native;this.setViewport(0,0,b.width,b.height);this.setDepthMode(!0,EG3dDepthMode.LessEqual);
this.setCullingMode(!0,EG3dCullMode.Front);b=this._capability;b.vendor=d.getParameter(d.VENDOR);b.version=d.getParameter(d.VERSION);b.shaderVersion=d.getParameter(d.SHADING_LANGUAGE_VERSION);b.attributeCount=d.getParameter(d.MAX_VERTEX_ATTRIBS);b.vertexConst=d.getParameter(d.MAX_VERTEX_UNIFORM_VECTORS);b.varyingCount=d.getParameter(d.MAX_VARYING_VECTORS);b.fragmentConst=d.getParameter(d.MAX_FRAGMENT_UNIFORM_VECTORS);b.samplerCount=d.getParameter(d.MAX_VERTEX_TEXTURE_IMAGE_UNITS);b.samplerSize=d.getParameter(d.MAX_TEXTURE_SIZE);
if(f=this._nativeInstance=d.getExtension("ANGLE_instanced_arrays"))b.optionInstance=!0;b.mergeCount=parseInt((b.vertexConst-32)/4);if(f=this._nativeLayout=d.getExtension("OES_vertex_array_object"))b.optionLayout=!0;if(f=d.getExtension("OES_element_index_uint"))b.optionIndex32=!0;if(f=this._nativeSamplerS3tc=d.getExtension("WEBGL_compressed_texture_s3tc"))b.samplerCompressRgb=f.COMPRESSED_RGB_S3TC_DXT1_EXT,b.samplerCompressRgba=f.COMPRESSED_RGBA_S3TC_DXT5_EXT;var f=b.shader={},h=f.vertexPrecision=
{};d.getShaderPrecisionFormat&&(h.floatLow=d.getShaderPrecisionFormat(d.VERTEX_SHADER,d.LOW_FLOAT),h.floatMedium=d.getShaderPrecisionFormat(d.VERTEX_SHADER,d.MEDIUM_FLOAT),h.floatHigh=d.getShaderPrecisionFormat(d.VERTEX_SHADER,d.HIGH_FLOAT),h.intLow=d.getShaderPrecisionFormat(d.VERTEX_SHADER,d.LOW_INT),h.intMedium=d.getShaderPrecisionFormat(d.VERTEX_SHADER,d.MEDIUM_INT),h.intHigh=d.getShaderPrecisionFormat(d.VERTEX_SHADER,d.HIGH_INT));f=f.fragmentPrecision={};d.getShaderPrecisionFormat&&(f.floatLow=
d.getShaderPrecisionFormat(d.FRAGMENT_SHADER,d.LOW_FLOAT),f.floatMedium=d.getShaderPrecisionFormat(d.FRAGMENT_SHADER,d.MEDIUM_FLOAT),f.floatHigh=d.getShaderPrecisionFormat(d.FRAGMENT_SHADER,d.HIGH_FLOAT),f.intLow=d.getShaderPrecisionFormat(d.FRAGMENT_SHADER,d.LOW_INT),f.intMedium=d.getShaderPrecisionFormat(d.FRAGMENT_SHADER,d.MEDIUM_INT),f.intHigh=d.getShaderPrecisionFormat(d.FRAGMENT_SHADER,d.HIGH_INT));if(f=this._nativeDebugShader=d.getExtension("WEBGL_debug_shaders"))b.optionShaderSource=!0}
function FWglContext_parameters(){var b=this._parameters;if(b)return b;for(var d="ACTIVE_TEXTURE ALIASED_LINE_WIDTH_RANGE ALIASED_POINT_SIZE_RANGE ALPHA_BITS ARRAY_BUFFER_BINDING BLEND BLEND_COLOR BLEND_DST_ALPHA BLEND_DST_RGB BLEND_EQUATION_ALPHA BLEND_EQUATION_RGB BLEND_SRC_ALPHA BLEND_SRC_RGB BLUE_BITS COLOR_CLEAR_VALUE COLOR_WRITEMASK COMPRESSED_TEXTURE_FORMATS CULL_FACE CULL_FACE_MODE CURRENT_PROGRAM DEPTH_BITS DEPTH_CLEAR_VALUE DEPTH_FUNC DEPTH_RANGE DEPTH_TEST DEPTH_WRITEMASK DITHER ELEMENT_ARRAY_BUFFER_BINDING FRAMEBUFFER_BINDING FRONT_FACE GENERATE_MIPMAP_HINT GREEN_BITS IMPLEMENTATION_COLOR_READ_FORMAT IMPLEMENTATION_COLOR_READ_TYPE LINE_WIDTH MAX_COMBINED_TEXTURE_IMAGE_UNITS MAX_CUBE_MAP_TEXTURE_SIZE MAX_FRAGMENT_UNIFORM_VECTORS MAX_RENDERBUFFER_SIZE MAX_TEXTURE_IMAGE_UNITS MAX_TEXTURE_SIZE MAX_VARYING_VECTORS MAX_VERTEX_ATTRIBS MAX_VERTEX_TEXTURE_IMAGE_UNITS MAX_VERTEX_UNIFORM_VECTORS MAX_VIEWPORT_DIMS PACK_ALIGNMENT POLYGON_OFFSET_FACTOR POLYGON_OFFSET_FILL POLYGON_OFFSET_UNITS RED_BITS RENDERBUFFER_BINDING RENDERER SAMPLE_BUFFERS SAMPLE_COVERAGE_INVERT SAMPLE_COVERAGE_VALUE SAMPLES SCISSOR_BOX SCISSOR_TEST SHADING_LANGUAGE_VERSION STENCIL_BACK_FAIL STENCIL_BACK_FUNC STENCIL_BACK_PASS_DEPTH_FAIL STENCIL_BACK_PASS_DEPTH_PASS STENCIL_BACK_REF STENCIL_BACK_VALUE_MASK STENCIL_BACK_WRITEMASK STENCIL_BITS STENCIL_CLEAR_VALUE STENCIL_FAIL STENCIL_FUNC STENCIL_PASS_DEPTH_FAIL STENCIL_PASS_DEPTH_PASS STENCIL_REF STENCIL_TEST STENCIL_VALUE_MASK STENCIL_WRITEMASK SUBPIXEL_BITS TEXTURE_BINDING_2D TEXTURE_BINDING_CUBE_MAP UNPACK_ALIGNMENT UNPACK_COLORSPACE_CONVERSION_WEBGL UNPACK_FLIP_Y_WEBGL UNPACK_PREMULTIPLY_ALPHA_WEBGL VENDOR VERSION VIEWPORT".split(" "),
f=this._native,h=d.length,b={},q=0;q<h;q++){var z=d[q];b[z]=f.getParameter(f[z])}if(d=f.getExtension("WEBGL_debug_renderer_info"))b.UNMASKED_RENDERER_WEBGL=f.getParameter(d.UNMASKED_RENDERER_WEBGL),b.UNMASKED_VENDOR_WEBGL=f.getParameter(d.UNMASKED_VENDOR_WEBGL);return this._parameters=b}function FWglContext_extensions(){var b=this._extensions;if(!b)for(var b=this._extensions={},d=this._native,f=d.getSupportedExtensions(),h=f.length,q=0;q<h;q++){var z=f[q];b[z]=d.getExtension(z)}return b}
function FWglContext_recordBuffers(){return this._recordBuffers}function FWglContext_recordSamplers(){return this._recordSamplers}function FWglContext_recordBegin(){this._recordBuffers.clear();this._recordSamplers.clear();this._statusRecord=!0}function FWglContext_recordEnd(){this._statusRecord=!1}function FWglContext_createProgram(){var b=RClass.create(FWglProgram);b.linkGraphicContext(this);b.setup();this._statistics._programTotal++;return b}
function FWglContext_createLayout(){var b=RClass.create(FWglLayout);b.linkGraphicContext(this);this._capability.optionLayout&&b.setup();this._statistics._layoutTotal++;return b}function FWglContext_createVertexBuffer(){var b=RClass.create(FWglVertexBuffer);b.linkGraphicContext(this);b.setup();this._statistics._vertexBufferTotal++;return b}
function FWglContext_createIndexBuffer(){var b=RClass.create(FWglIndexBuffer);b.linkGraphicContext(this);b.setup();this._statistics._indexBufferTotal++;return b}function FWglContext_createFlatTexture(){var b=RClass.create(FWglFlatTexture);b.linkGraphicContext(this);b.setup();this._statistics._flatTextureTotal++;return b}function FWglContext_createCubeTexture(){var b=RClass.create(FWglCubeTexture);b.linkGraphicContext(this);b.setup();this._statistics._cubeTextureTotal++;return b}
function FWglContext_createRenderTarget(){var b=RClass.create(FWglRenderTarget);b.linkGraphicContext(this);b.setup();this._statistics._targetTotal++;return b}function FWglContext_setViewport(b,d,f,h){this._size.set(f,h);this._native.viewport(b,d,f,h)}
function FWglContext_setFillMode(b){var d=this._native;if(this._fillModeCd!=b){this._statistics._frameFillModeCount++;switch(b){case EG3dFillMode.Point:d.polygonMode(d.FRONT_AND_BACK,d.POINT);break;case EG3dFillMode.Line:d.polygonMode(d.FRONT_AND_BACK,d.LINE);break;case EG3dFillMode.Face:d.polygonMode(d.FRONT,d.FILL);break;default:throw new TError("Invalid parameter. (fill_mode={1})",b);}this._fillModeCd=b;return!0}}
function FWglContext_setDepthMode(b,d){var f=this._native;if(this._optionDepth==b&&this._depthModeCd==d)return!0;this._statistics._frameDepthModeCount++;this._optionDepth!=b&&(b?f.enable(f.DEPTH_TEST):f.disable(f.DEPTH_TEST),this._optionDepth=b);if(b&&this._depthModeCd!=d){var h=RWglUtility.convertDepthMode(f,d);f.depthFunc(h);this._depthModeCd=d}return!0}
function FWglContext_setCullingMode(b,d){var f=this._native;if(this._optionCull==b&&this._cullModeCd==d)return!0;this._statistics._frameCullModeCount++;this._optionCull!=b&&(b?f.enable(f.CULL_FACE):f.disable(f.CULL_FACE),this._optionCull=b);if(b&&this._cullModeCd!=d){var h=RWglUtility.convertCullMode(f,d);f.cullFace(h);this._cullModeCd=d}return!0}
function FWglContext_setBlendFactors(b,d,f){var h=this._native;if(this._statusBlend==b&&this._blendSourceCd==d&&this._blendTargetCd==f)return!0;this._statistics._frameBlendModeCount++;this._statusBlend!=b&&(b?h.enable(h.BLEND):(h.disable(h.BLEND),this._blendTargetCd=this._blendSourceCd=0),this._statusBlend=b);if(b&&(this._blendSourceCd!=d||this._blendTargetCd!=f)){b=RWglUtility.convertBlendFactors(h,d);var q=RWglUtility.convertBlendFactors(h,f);h.blendFunc(b,q);this._blendSourceCd=d;this._blendTargetCd=
f}return!0}function FWglContext_setScissorRectangle(b,d,f,h){this._native.scissor(b,d,f,h)}
function FWglContext_setRenderTarget(b){var d=this._native;if(this._activeRenderTarget!=b){this._statistics._frameTargetCount++;var f=!0;if(null==b){d.bindFramebuffer(d.FRAMEBUFFER,null);f=this.checkError("glBindFramebuffer","Bind frame buffer. (frame_buffer={1})",null);if(!f)return f;d.viewport(0,0,this._size.width,this._size.height)}else{d.bindFramebuffer(d.FRAMEBUFFER,b._native);result=this.checkError("glBindFramebuffer","Bind frame buffer. (frame_buffer={1})",b._native);if(!f)return f;f=b.size();
d.viewport(0,0,f.width,f.height)}this._activeRenderTarget=b}}function FWglContext_setProgram(b){var d=this._native;if(this._program!=b)return this._statistics._frameProgramCount++,b?d.useProgram(b._native):d.useProgram(null),this._program=b,this.checkError("useProgram","Set program failure. (program={1}, program_native={2})",b,b._native)}
function FWglContext_bindConst(b,d,f,h,q){var z=this._native,A=!0;this._statistics._frameConstCount++;switch(f){case EG3dParameterFormat.Float1:z.uniform1fv(d,h);this._statistics._frameConstLength+=h.byteLength;A=this.checkError("uniform1fv","Bind const data failure. (shader_cd={1}, slot={2}, data={3}, count={4})",b,d,h,q);break;case EG3dParameterFormat.Float2:z.uniform2fv(d,h);this._statistics._frameConstLength+=h.byteLength;A=this.checkError("uniform2fv","Bind const data failure. (shader_cd={1}, slot={2}, data={3}, count={4})",
b,d,h,q);break;case EG3dParameterFormat.Float3:z.uniform3fv(d,h);this._statistics._frameConstLength+=h.byteLength;A=this.checkError("uniform3fv","Bind const data failure. (shader_cd={1}, slot={2}, data={3}, count={4})",b,d,h,q);break;case EG3dParameterFormat.Float4:z.uniform4fv(d,h);this._statistics._frameConstLength+=h.byteLength;A=this.checkError("uniform4fv","Bind const data failure. (shader_cd={1}, slot={2}, data={3}, count={4})",b,d,h,q);break;case EG3dParameterFormat.Float3x3:var B=this._data9;
B[0]=h[0];B[1]=h[4];B[2]=h[8];B[3]=h[1];B[4]=h[5];B[5]=h[9];B[6]=h[2];B[7]=h[6];B[8]=h[10];z.uniformMatrix3fv(d,z.FALSE,B);this._statistics._frameConstLength+=B.byteLength;A=this.checkError("uniformMatrix3fv","Bind const matrix3x3 failure. (shader_cd={1}, slot={2}, data={3}, count={4})",b,d,h,q);break;case EG3dParameterFormat.Float4x3:z.uniform4fv(d,z.FALSE,pd);this._statistics._frameConstLength+=B.byteLength;A=this.checkError("uniform4fv","Bind const matrix4x3 failure. (shader_cd={1}, slot={2}, data={3}, count={4})",
b,d,h,q);break;case EG3dParameterFormat.Float4x4:f=null;if(h.constructor==Float32Array)f=h;else if(h.writeData)f=this._data16,h.writeData(f,0);else throw new TError("Unknown data type.");z.uniformMatrix4fv(d,z.FALSE,f);this._statistics._frameConstLength+=f.byteLength;A=this.checkError("uniformMatrix4fv","Bind const matrix4x4 failure. (shader_cd=%d, slot=%d, pData=0x%08X, count=%d)",b,d,h,q)}return A}
function FWglContext_bindVertexBuffer(b,d,f,h){var q=this._native,z=!0;this._statistics._frameBufferCount++;this._statusRecord&&(z=new SG3dLayoutBuffer,z.slot=b,z.buffer=d,z.index=f,z.formatCd=h,this._recordBuffers.push(z));z=null;null!=d&&(z=d._native);q.bindBuffer(q.ARRAY_BUFFER,z);z=this.checkError("bindBuffer","Bind buffer. (buffer_id=%d)",z);if(!z)return z;if(null!=d){if(q.enableVertexAttribArray(b),z=this.checkError("enableVertexAttribArray","Enable vertex attribute array. (slot=%d)",b),!z)return z}else return q.disableVertexAttribArray(b),
z=this.checkError("disableVertexAttribArray","Disable vertex attribute array. (slot=%d)",b);d=d._stride;switch(h){case EG3dAttributeFormat.Float1:q.vertexAttribPointer(b,1,q.FLOAT,!1,d,f);break;case EG3dAttributeFormat.Float2:q.vertexAttribPointer(b,2,q.FLOAT,!1,d,f);break;case EG3dAttributeFormat.Float3:q.vertexAttribPointer(b,3,q.FLOAT,!1,d,f);break;case EG3dAttributeFormat.Float4:q.vertexAttribPointer(b,4,q.FLOAT,!1,d,f);break;case EG3dAttributeFormat.Byte4:q.vertexAttribPointer(b,4,q.UNSIGNED_BYTE,
!1,d,f);break;case EG3dAttributeFormat.Byte4Normal:q.vertexAttribPointer(b,4,q.UNSIGNED_BYTE,!0,d,f);break;default:throw new TError(this,"Unknown vertex format. (format_cd=%d)",formatCd);}return z=this.checkError("glVertexAttribPointer","Bind vertex attribute pointer. (slot=%d, format_cd=%d)",b,h)}
function FWglContext_bindTexture(b,d,f){var h=this._native,q=!0;this._statistics._frameTextureCount++;if(this._statusRecord){var z=new SG3dLayoutSampler;z.slot=b;z.index=d;z.texture=f;this._recordSamplers.push(z)}if(this._activeTextureSlot!=b){h.uniform1i(b,d);h.activeTexture(h.TEXTURE0+d);q=this.checkError("activeTexture","Active texture failure. (slot=%d, index=%d)",b,d);if(!q)return q;this._activeTextureSlot=b}if(null==f)return h.bindTexture(h.TEXTURE_2D,null),q=this.checkError("bindTexture","Bind texture clear failure. (slot=%d)",
b);b=f._native;switch(f.textureCd()){case EG3dTexture.Flat2d:h.bindTexture(h.TEXTURE_2D,f._native);q=this.checkError("glBindTexture","Bind flag texture failure. (texture_id=%d)",b);if(!q)break;break;case EG3dTexture.Cube:h.bindTexture(h.TEXTURE_CUBE_MAP,f._native);q=this.checkError("glBindTexture","Bind cube texture failure. (texture_id=%d)",b);if(!q)break;break;default:RLogger.fatal(this,null,"Unknown texture type.")}return q}
function FWglContext_clear(b,d,f,h,q){var z=this._native;z.clearColor(b,d,f,h);z.clearDepth(q);z.clear(z.COLOR_BUFFER_BIT|z.DEPTH_BUFFER_BIT);this._statistics._frameClearCount++}function FWglContext_clearColor(b,d,f,h){var q=this._native;q.clearColor(b,d,f,h);q.clear(q.COLOR_BUFFER_BIT);this._statistics._frameClearCount++}function FWglContext_clearDepth(b){var d=this._native;d.clearDepth(b);d.clear(d.DEPTH_BUFFER_BIT);this._statistics._frameClearCount++}
function FWglContext_readPixels(b,d,f,h){var q=this._native,z=new Uint8Array(4*f*h);q.readPixels(b,d,f,h,q.RGBA,q.UNSIGNED_BYTE,z);return z}
function FWglContext_drawTriangles(b,d,f){var h=this._native,q=!0;null==d&&(d=0);null==f&&(f=b.count());h.bindBuffer(h.ELEMENT_ARRAY_BUFFER,b._native);q=this.checkError("bindBuffer","Bind element array buffer failure. (index=0x%08X, offset=%d, count=%d, buffer_id)",b,d,f,b._native);if(!q)return q;q=RWglUtility.convertIndexStride(h,b.strideCd());b._fillMode==EG3dFillMode.Line?h.drawElements(h.LINES,f,q,2*d):h.drawElements(h.TRIANGLES,f,q,2*d);this._statistics._frameTriangleCount+=f;this._statistics._frameDrawCount++;
q=this.checkError("drawElements","Draw triangles failure. (index=0x%08X, offset=%d, count=%d)",b,d,f);if(!q)return q;h.bindBuffer(h.ELEMENT_ARRAY_BUFFER,null);return q=this.checkError("bindBuffer","Bind element array buffer failure. (index=0x%08X, offset=%d, count=%d)",b,d,f)}function FWglContext_present(){}
function FWglContext_checkError(b,d,f){if(!this._capability.optionDebug||!RRuntime.isDebug())return!0;b=this._native;d=!1;for(var h=f=null;;){f=b.getError();if(f==b.NO_ERROR){d=!0;break}switch(f){case b.INVALID_OPERATION:h="Invalid operation.";break;case b.INVALID_ENUM:h="Invalid enum.";break;case b.INVALID_VALUE:h="Invalid value.";break;case b.INVALID_FRAMEBUFFER_OPERATION:h="Invalid paramebuffer opeartion.";break;case b.OUT_OF_MEMORY:h="Out of memory.";break;default:h="Unknown"}}d||RLogger.fatal(this,
null,"OpenGL check failure. (code={1}, description={2})",f,h);return d}function FWglCubeTexture(b){b=RClass.inherits(this,b,FG3dCubeTexture);b._native=null;b.setup=FWglCubeTexture_setup;b.isValid=FWglCubeTexture_isValid;b.makeMipmap=FWglCubeTexture_makeMipmap;b.upload=FWglCubeTexture_upload;b.update=FWglCubeTexture_update;b.dispose=FWglCubeTexture_dispose;return b}
function FWglCubeTexture_setup(){var b=this._graphicContext._native;this.__base.FG3dCubeTexture.setup.call(this);this._native=b.createTexture()}function FWglCubeTexture_isValid(){return this._graphicContext._native.isTexture(this._native)}function FWglCubeTexture_makeMipmap(){var b=this._graphicContext._native;b.bindTexture(b.TEXTURE_CUBE_MAP,this._native);b.generateMipmap(b.TEXTURE_CUBE_MAP)}
function FWglCubeTexture_upload(b,d,f,h,q,z){var A=this._graphicContext,B=A._native;B.bindTexture(B.TEXTURE_CUBE_MAP,this._native);B.texImage2D(B.TEXTURE_CUBE_MAP_POSITIVE_X,0,B.RGB,B.RGB,B.UNSIGNED_BYTE,b.image());B.texImage2D(B.TEXTURE_CUBE_MAP_NEGATIVE_X,0,B.RGB,B.RGB,B.UNSIGNED_BYTE,d.image());B.texImage2D(B.TEXTURE_CUBE_MAP_POSITIVE_Y,0,B.RGB,B.RGB,B.UNSIGNED_BYTE,f.image());B.texImage2D(B.TEXTURE_CUBE_MAP_NEGATIVE_Y,0,B.RGB,B.RGB,B.UNSIGNED_BYTE,h.image());B.texImage2D(B.TEXTURE_CUBE_MAP_POSITIVE_Z,
0,B.RGB,B.RGB,B.UNSIGNED_BYTE,q.image());B.texImage2D(B.TEXTURE_CUBE_MAP_NEGATIVE_Z,0,B.RGB,B.RGB,B.UNSIGNED_BYTE,z.image());this._statusLoad=A.checkError("texImage2D","Upload cube image failure.");this.update()}
function FWglCubeTexture_update(){this.__base.FG3dCubeTexture.update.call(this);var b=this._graphicContext._native;b.bindTexture(b.TEXTURE_CUBE_MAP,this._native);var d=RWglUtility.convertSamplerFilter(b,this._filterMinCd);d&&b.texParameteri(b.TEXTURE_CUBE_MAP,b.TEXTURE_MIN_FILTER,d);(d=RWglUtility.convertSamplerFilter(b,this._filterMagCd))&&b.texParameteri(b.TEXTURE_CUBE_MAP,b.TEXTURE_MAG_FILTER,d)}
function FWglCubeTexture_dispose(){var b=this._graphicContext,d=this._native;d&&(b._native.deleteTexture(d),this._native=null);this.__base.FG3dCubeTexture.dispose.call(this)}
function FWglFlatTexture(b){b=RClass.inherits(this,b,FG3dFlatTexture);b._native=null;b.setup=FWglFlatTexture_setup;b.isValid=FWglFlatTexture_isValid;b.texture=FWglFlatTexture_texture;b.makeMipmap=FWglFlatTexture_makeMipmap;b.uploadData=FWglFlatTexture_uploadData;b.upload=FWglFlatTexture_upload;b.update=FWglFlatTexture_update;b.dispose=FWglFlatTexture_dispose;return b}
function FWglFlatTexture_setup(){var b=this._graphicContext._native;this.__base.FG3dFlatTexture.setup.call(this);this._native=b.createTexture()}function FWglFlatTexture_isValid(){return this._graphicContext._native.isTexture(this._native)}function FWglFlatTexture_texture(){return this}function FWglFlatTexture_makeMipmap(){var b=this._graphicContext._native;b.bindTexture(b.TEXTURE_2D,this._native);b.generateMipmap(b.TEXTURE_2D)}
function FWglFlatTexture_uploadData(b,d,f){var h=this._graphicContext,q=h._native,z=null;if(b.constructor==ArrayBuffer)z=new Uint8Array(b);else if(b.constructor==Uint8Array)z=b;else throw new TError("Invalid data format.");this.width=d;this.height=f;q.bindTexture(q.TEXTURE_2D,this._native);q.texImage2D(q.TEXTURE_2D,0,q.RGBA,d,f,0,q.RGBA,q.UNSIGNED_BYTE,z);this._statusLoad=h.checkError("texImage2D","Upload data failure.");this.update()}
function FWglFlatTexture_upload(b){var d=this._graphicContext;d.capability();var f=d._native,h=null;if("IMG"==b.tagName||"CANVAS"==b.tagName)h=b;else if(RClass.isClass(b,FImage))h=b.image();else if(RClass.isClass(b,MCanvasObject))h=b.htmlCanvas();else throw new TError("Invalid image format.");f.bindTexture(f.TEXTURE_2D,this._native);this._optionFlipY&&f.pixelStorei(f.UNPACK_FLIP_Y_WEBGL,!0);f.texImage2D(f.TEXTURE_2D,0,f.RGBA,f.RGBA,f.UNSIGNED_BYTE,h);this.update();this._statusLoad=d.checkError("texImage2D",
"Upload image failure.")}function FWglFlatTexture_update(){this.__base.FG3dFlatTexture.update.call(this);var b=this._graphicContext._native;b.bindTexture(b.TEXTURE_2D,this._native);var d=RWglUtility.convertSamplerFilter(b,this._filterMinCd);d&&b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,d);(d=RWglUtility.convertSamplerFilter(b,this._filterMagCd))&&b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,d)}
function FWglFlatTexture_dispose(){var b=this._graphicContext,d=this._native;d&&(b._native.deleteTexture(d),this._native=null);this.__base.FG3dFlatTexture.dispose.call(this)}function FWglFragmentShader(b){b=RClass.inherits(this,b,FG3dFragmentShader);b._native=null;b.setup=FWglFragmentShader_setup;b.targetSource=FWglFragmentShader_targetSource;b.upload=FWglFragmentShader_upload;b.dispose=FWglFragmentShader_dispose;return b}
function FWglFragmentShader_setup(){this.__base.FG3dFragmentShader.setup.call(this);var b=this._graphicContext._native;this._native=b.createShader(b.FRAGMENT_SHADER)}function FWglFragmentShader_targetSource(){var b=this._graphicContext;return b.capability().optionShaderSource?b._nativeDebugShader.getTranslatedShaderSource(this._native):this._source}
function FWglFragmentShader_upload(b){var d=this._graphicContext._native,f=this._native;d.shaderSource(f,b);d.compileShader(f);if(!d.getShaderParameter(f,d.COMPILE_STATUS)){var h=d.getShaderInfoLog(f);d.deleteShader(f);this._native=null;throw new TError(this,"Upload fragment shader source failure. (error={1})\n{2}",h,b);}this._source=b;return!0}
function FWglFragmentShader_dispose(){var b=this._graphicContext,d=this._native;d&&(b._native.deleteShader(d),this._native=null);this.__base.FG3dFragmentShader.dispose.call(this)}function FWglIndexBuffer(b){b=RClass.inherits(this,b,FG3dIndexBuffer);b._native=null;b.setup=FWglIndexBuffer_setup;b.isValid=FWglIndexBuffer_isValid;b.upload=FWglIndexBuffer_upload;b.dispose=FWglIndexBuffer_dispose;return b}
function FWglIndexBuffer_setup(){this.__base.FG3dIndexBuffer.setup.call(this);this._native=this._graphicContext._native.createBuffer()}function FWglIndexBuffer_isValid(){return this._graphicContext._native.isBuffer(this._native)}
function FWglIndexBuffer_upload(b,d){var f=this._graphicContext,h=f._native;this._count=d;var q=null;if(b.constructor==Array||b.constructor==ArrayBuffer)if(this._strideCd==EG3dIndexStride.Uint16)q=new Uint16Array(b);else if(this._strideCd==EG3dIndexStride.Uint32)q=new Uint32Array(b);else throw new TError(this,"Index stride is invalid.");else if(b.constructor==Uint16Array){if(this._strideCd!=EG3dIndexStride.Uint16)throw new TError(this,"Index stride16 is invalid.");q=b}else if(b.constructor==Uint32Array){if(this._strideCd!=
EG3dIndexStride.Uint32)throw new TError(this,"Index stride16 is invalid.");q=b}else throw new TError(this,"Upload index data type is invalid. (value={1})",b);h.bindBuffer(h.ELEMENT_ARRAY_BUFFER,this._native);f.checkError("bindBuffer","Bind buffer failure.");h.bufferData(h.ELEMENT_ARRAY_BUFFER,q,h.STATIC_DRAW);f.checkError("bufferData","Upload buffer data. (count={1})",d)}
function FWglIndexBuffer_dispose(){var b=this._graphicContext,d=this._native;d&&(b._native.deleteBuffer(d),this._native=null);this.__base.FG3dIndexBuffer.dispose.call(this)}function FWglLayout(b){b=RClass.inherits(this,b,FG3dLayout);b._native=null;b.setup=FWglLayout_setup;b.bind=FWglLayout_bind;b.unbind=FWglLayout_unbind;b.active=FWglLayout_active;b.deactive=FWglLayout_deactive;b.dispose=FWglLayout_dispose;return b}
function FWglLayout_setup(){this.__base.FG3dLayout.setup.call(this);this._native=this._graphicContext._nativeLayout.createVertexArrayOES()}function FWglLayout_bind(){this._graphicContext._nativeLayout.bindVertexArrayOES(this._native)}function FWglLayout_unbind(){this._graphicContext._nativeLayout.bindVertexArrayOES(null)}function FWglLayout_active(){this._graphicContext._nativeLayout.bindVertexArrayOES(this._native)}
function FWglLayout_deactive(){this._graphicContext._nativeLayout.bindVertexArrayOES(null)}function FWglLayout_dispose(){var b=this._graphicContext,d=this._native;d&&(b._nativeLayout.deleteVertexArrayOES(d),this._native=null);this.__base.FG3dLayout.dispose.call(this)}
function FWglProgram(b){b=RClass.inherits(this,b,FG3dProgram);b._native=null;b.setup=FWglProgram_setup;b.vertexShader=FWglProgram_vertexShader;b.fragmentShader=FWglProgram_fragmentShader;b.upload=FWglProgram_upload;b.build=FWglProgram_build;b.link=FWglProgram_link;b.dispose=FWglProgram_dispose;return b}function FWglProgram_setup(){this._native=(g=this._graphicContext)._native.createProgram()}
function FWglProgram_vertexShader(){var b=this._vertexShader;b||(b=this._vertexShader=RClass.create(FWglVertexShader),b.linkGraphicContext(this),b.setup());return b}function FWglProgram_fragmentShader(){var b=this._fragmentShader;b||(b=this._fragmentShader=RClass.create(FWglFragmentShader),b.linkGraphicContext(this),b.setup());return b}
function FWglProgram_upload(b,d){if(b==EG3dShader.Vertex)this.vertexShader().upload(d);else if(b==EG3dShader.Fragment)this.fragmentShader().upload(d);else throw Error("Unknown type");}
function FWglProgram_build(){var b=this._graphicContext,d=b._native,f=this._native,h=this.vertexShader();d.attachShader(f,h._native);var q=b.checkError("attachShader","Attach shader failure. (program_id=%d, shader_id=%d)",f,h._native);if(!q)return q;h=this.fragmentShader();d.attachShader(f,h._native);q=b.checkError("attachShader","Attach shader failure. (program_id=%d, shader_id=%d)",f,h._native);if(!q)return q;if(this.hasAttribute())for(var h=this.attributes(),z=h.count(),A=0;A<z;A++)if(q=h.value(A).name(),
d.bindAttribLocation(f,A,q),q=b.checkError("bindAttribLocation","Bind attribute location. (program_id=%d, slot=%d, name=%s)",f,A,q),!q)return q}
function FWglProgram_link(){var b=this._graphicContext,d=b._native,f=!1,h=this._native;d.linkProgram(h);f=d.getProgramParameter(h,d.LINK_STATUS);if(!f)return b=d.getProgramInfoLog(h),RLogger.fatal(this,null,"Link program failure. (status={1}, reason={2})",f,b),d.deleteProgram(this._native),this._native=null,!1;d.validateProgram(h);(f=d.getProgramParameter(h,d.VALIDATE_STATUS))||d.getProgramInfoLog(h);d.finish();f=b.checkError("finish","Finish program link faliure. (program_id={1})",h);if(!f)return f;
if(this.hasParameter())for(var q=this._parameters.count(),z=0;z<q;z++){var A=this._parameters.value(z),B=d.getUniformLocation(h,A.name()),f=b.checkError("getUniformLocation","Find parameter slot. (program_id=%d, name=%s, slot=%d)",h,A.name(),B);if(!f)return f;A._slot=B;null!=B&&(A._statusUsed=!0)}if(this.hasAttribute())for(q=this._attributes.count(),z=0;z<q;z++){A=this._attributes.value(z);B=d.getAttribLocation(h,A.name());f=b.checkError("getAttribLocation","Find attribute slot. (program_id=%d, name=%s, slot=%d)",
h,A.name(),B);if(!f)return f;A._slot=B;-1!=B&&(A._statusUsed=!0)}if(this.hasSampler()){q=this._samplers.count();for(z=0;z<q;z++){A=this._samplers.value(z);B=d.getUniformLocation(h,A.name());f=b.checkError("getUniformLocation","Find sampler slot. (program_id=%d, name=%s, slot=%d)",h,A.name(),B);if(!f)return f;A._slot=B;null!=B&&(A._statusUsed=!0)}for(z=d=0;z<q;z++)A=this._samplers.value(z),A._statusUsed&&(A._index=d++)}return f}
function FWglProgram_dispose(){var b=this._graphicContext,d=this._native;d&&(b._native.deleteProgram(d),this._native=null);this.__base.FProgram3d.dispose.call(this)}function FWglRenderTarget(b){b=RClass.inherits(this,b,FG3dRenderTarget);b._optionDepth=!0;b._native=null;b._nativeDepth=null;b.setup=FWglRenderTarget_setup;b.build=FWglRenderTarget_build;b.dispose=FWglRenderTarget_dispose;return b}
function FWglRenderTarget_setup(){this.__base.FG3dRenderTarget.setup.call(this);var b=this._graphicContext;this._native=b._native.createFramebuffer();return b.checkError("createFramebuffer","Create frame buffer failure.")}
function FWglRenderTarget_build(){var b=this._size,d=this._graphicContext,f=d._native;f.bindFramebuffer(f.FRAMEBUFFER,this._native);var h=d.checkError("bindFramebuffer","Bind frame buffer failure.");if(!h)return h;if(this._optionDepth){var q=this._nativeDepth=f.createRenderbuffer(),h=d.checkError("createRenderbuffer","Create render buffer failure.");if(!h)return h;f.bindRenderbuffer(f.RENDERBUFFER,q);h=d.checkError("bindRenderbuffer","Bind render buffer failure.");if(!h)return h;f.renderbufferStorage(f.RENDERBUFFER,
f.DEPTH_COMPONENT16,b.width,b.height);h=d.checkError("renderbufferStorage","Set render buffer storage format failure.");if(!h)return h;f.framebufferRenderbuffer(f.FRAMEBUFFER,f.DEPTH_ATTACHMENT,f.RENDERBUFFER,q);h=d.checkError("framebufferRenderbuffer","Set depth buffer to frame buffer failure. (framebuffer=%d, depthbuffer=%d)",this._native,q);if(!h)return h}for(var q=this._textures,z=q.count(),A=0;A<z;A++){var B=q.get(A);f.bindTexture(f.TEXTURE_2D,B._native);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,
f.LINEAR);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,f.LINEAR);f.texImage2D(f.TEXTURE_2D,0,f.RGBA,b.width,b.height,0,f.RGBA,f.UNSIGNED_BYTE,null);h=d.checkError("texImage2D","Alloc texture storage. (texture_id, size=%dx%d)",B._native,this._size.width,this._size.height);if(!h)return h;f.framebufferTexture2D(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0+A,f.TEXTURE_2D,B._native,0);h=d.checkError("framebufferTexture2D","Set color buffer into frame buffer failure. (framebuffer_id=%d, texture_id=%d)",this._native,
B._native);if(!h)return h}}function FWglRenderTarget_dispose(){var b=this._graphicContext,d=this._nativeDepth;d&&(b._native.deleteRenderbuffer(d),this._nativeDepth=null);if(d=this._native)b._native.deleteFramebuffer(d),this._native=null;this.__base.FG3dRenderTarget.dispose.call(this)}
function FWglVertexBuffer(b){b=RClass.inherits(this,b,FG3dVertexBuffer);b._native=null;b.setup=FWglVertexBuffer_setup;b.isValid=FWglVertexBuffer_isValid;b.upload=FWglVertexBuffer_upload;b.dispose=FWglVertexBuffer_dispose;return b}function FWglVertexBuffer_setup(){this.__base.FG3dVertexBuffer.setup.call(this);this._native=this._graphicContext._native.createBuffer()}function FWglVertexBuffer_isValid(){return this._graphicContext._native.isBuffer(this._native)}
function FWglVertexBuffer_upload(b,d,f){var h=this._graphicContext,q=h._native;this._stride=d;this._count=f;d=null;if(b.constructor==Array||b.constructor==ArrayBuffer)d=new Float32Array(b);else if(b.constructor==Uint8Array)d=b;else if(b.constructor==Float32Array)d=b;else throw new TError(this,"Upload vertex data type is invalid. (data={1})",b);q.bindBuffer(q.ARRAY_BUFFER,this._native);h.checkError("bindBuffer","Bindbuffer");q.bufferData(q.ARRAY_BUFFER,d,q.STATIC_DRAW);h.checkError("bufferData","bufferData")}
function FWglVertexBuffer_dispose(){var b=this._graphicContext,d=this._native;d&&(b._native.deleteBuffer(d),this._native=null);this.__base.FG3dVertexBuffer.dispose.call(this)}function FWglVertexShader(b){b=RClass.inherits(this,b,FG3dVertexShader);b._native=null;b.setup=FWglVertexShader_setup;b.targetSource=FWglVertexShader_targetSource;b.upload=FWglVertexShader_upload;b.dispose=FWglVertexShader_dispose;return b}
function FWglVertexShader_setup(){this.__base.FG3dVertexShader.setup.call(this);var b=this._graphicContext._native;this._native=b.createShader(b.VERTEX_SHADER)}function FWglVertexShader_targetSource(){var b=this._graphicContext;return b.capability().optionShaderSource?b._nativeDebugShader.getTranslatedShaderSource(this._native):this._source}
function FWglVertexShader_upload(b){var d=this._graphicContext._native,f=this._native;d.shaderSource(f,b);d.compileShader(f);if(!d.getShaderParameter(f,d.COMPILE_STATUS)){var h=d.getShaderInfoLog(f);d.deleteShader(f);this._native=null;throw new TError(this,"Upload vertex shader source failure. (error={1})\n{2}",h,b);}this._source=b;return!0}
function FWglVertexShader_dispose(){var b=this._graphicContext,d=this._native;d&&(b._native.deleteShader(d),this._native=null);this.__base.FG3dVertexShader.dispose.call(this)}
var RWglUtility=new function(){this.convertFillMode=RWglUtility_convertFillMode;this.convertCullMode=RWglUtility_convertCullMode;this.convertDepthMode=RWglUtility_convertDepthMode;this.convertBlendFactors=RWglUtility_convertBlendFactors;this.convertIndexStride=RWglUtility_convertIndexStride;this.convertSamplerFilter=RWglUtility_convertSamplerFilter;return this};
function RWglUtility_convertFillMode(b,d){switch(d){case EG3dFillMode.Point:return b.POINT;case EG3dFillMode.Line:return b.LINE;case EG3dFillMode.Face:return b.FILL}throw new TError(this,"Convert fill mode failure. (fill_cd={1})",d);}function RWglUtility_convertCullMode(b,d){switch(d){case EG3dCullMode.Front:return b.FRONT;case EG3dCullMode.Back:return b.BACK;case EG3dCullMode.Both:return b.FRONT_AND_BACK}throw new TError(this,"Convert cull mode failure. (cull_cd={1})",d);}
function RWglUtility_convertDepthMode(b,d){switch(d){case EG3dDepthMode.Equal:return b.EQUAL;case EG3dDepthMode.NotEqual:return b.NOTEQUAL;case EG3dDepthMode.Less:return b.LESS;case EG3dDepthMode.LessEqual:return b.LEQUAL;case EG3dDepthMode.Greater:return b.GREATER;case EG3dDepthMode.GreaterEqual:return b.GEQUAL;case EG3dDepthMode.Always:return b.ALWAYS}throw new TError(this,"Convert depth mode failure. (depth_cd={1})",d);}
function RWglUtility_convertBlendFactors(b,d){switch(d){case EG3dBlendMode.Zero:return b.ZERO;case EG3dBlendMode.One:return b.ONE;case EG3dBlendMode.SrcColor:return b.SRC_COLOR;case EG3dBlendMode.OneMinusSrcColor:return b.ONE_MINUS_SRC_COLOR;case EG3dBlendMode.DstColor:return b.DST_COLOR;case EG3dBlendMode.OneMinusDstColor:return b.ONE_MINUS_DST_COLOR;case EG3dBlendMode.SrcAlpha:return b.SRC_ALPHA;case EG3dBlendMode.OneMinusSrcAlpha:return b.ONE_MINUS_SRC_ALPHA;case EG3dBlendMode.DstAlpha:return b.DST_ALPHA;
case EG3dBlendMode.OneMinusDstAlpha:return b.ONE_MINUS_DST_ALPHA;case EG3dBlendMode.SrcAlphaSaturate:return b.SRC_ALPHA_SATURATE}throw new TError(this,"Convert blend factors failure. (blend_cd={1})",d);}function RWglUtility_convertIndexStride(b,d){switch(d){case EG3dIndexStride.Uint16:return b.UNSIGNED_SHORT;case EG3dIndexStride.Uint32:return b.UNSIGNED_INT}throw new TError(this,"Convert index stride failure. (stride_cd={1})",d);}
function RWglUtility_convertSamplerFilter(b,d){switch(d){case EG3dSamplerFilter.Unknown:return 0;case EG3dSamplerFilter.Nearest:return b.NEAREST;case EG3dSamplerFilter.Linear:return b.LINEAR;case EG3dSamplerFilter.Repeat:return b.REPEAT;case EG3dSamplerFilter.ClampToEdge:return b.CLAMP_TO_EDGE;case EG3dSamplerFilter.ClampToBorder:return b.CLAMP_TO_BORDER}throw new TError(this,"Convert sampler filter failure. (filter_cd={1})",d);}
var EDisplayTransform=new function(){this.CameraPosition="camera.position";this.CameraDirection="camera.direction";this.BilboardedSphere="bilboarded.sphere";this.BilboardedCylinder="bilboarded.cylinder";return this},EResourceCompress=new function(){this.None="none";this.Deflate="deflate";this.Lzma="lzma";return this},EStageKey=new function(){this.Forward=EKeyCode.W;this.Back=EKeyCode.S;this.Up=EKeyCode.Q;this.Down=EKeyCode.E;this.RotationLeft=EKeyCode.A;this.RotationRight=EKeyCode.D;this.RotationUp=
EKeyCode.Z;this.RotationDown=EKeyCode.X;this.FocusForward=EKeyCode.I;this.FocusBack=EKeyCode.K;this.FocusLeft=EKeyCode.J;this.FocusRight=EKeyCode.L;return this};function MListenerEnterFrame(b){b=RClass.inherits(this,b,MListener);b.addEnterFrameListener=MListenerEnterFrame_addEnterFrameListener;b.removeEnterFrameListener=MListenerEnterFrame_removeEnterFrameListener;b.processEnterFrameListener=MListenerEnterFrame_processEnterFrameListener;return b}
function MListenerEnterFrame_addEnterFrameListener(b,d){return this.addListener(EEvent.EnterFrame,b,d)}function MListenerEnterFrame_removeEnterFrameListener(b,d){this.removeListener(EEvent.EnterFrame,b,d)}function MListenerEnterFrame_processEnterFrameListener(b,d,f,h,q){this.processListener(EEvent.EnterFrame,b,d,f,h,q)}
function MListenerLeaveFrame(b){b=RClass.inherits(this,b,MListener);b.addLeaveFrameListener=MListenerLeaveFrame_addLeaveFrameListener;b.removeLeaveFrameListener=MListenerLeaveFrame_removeLeaveFrameListener;b.processLeaveFrameListener=MListenerLeaveFrame_processLeaveFrameListener;return b}function MListenerLeaveFrame_addLeaveFrameListener(b,d){return this.addListener(EEvent.LeaveFrame,b,d)}function MListenerLeaveFrame_removeLeaveFrameListener(b,d){this.removeListener(EEvent.LeaveFrame,b,d)}
function MListenerLeaveFrame_processLeaveFrameListener(b,d,f,h,q){this.processListener(EEvent.LeaveFrame,b,d,f,h,q)}function MResourceData(b){b=RClass.inherits(this,b);b._ready=!1;b._guid=null;b._index=-1;b._compressData=null;b._data=null;b.compressData=MResourceData_compressData;b.setCompressData=MResourceData_setCompressData;b.testReady=MResourceData_testReady;b.completeData=MResourceData_completeData;b.dispose=MResourceData_dispose;return b}
function MResourceData_compressData(){return this._compressData}function MResourceData_setCompressData(b){this._compressData=b}function MResourceData_testReady(){return this._ready}function MResourceData_completeData(b){this._data=b;this._ready=!0}function MResourceData_dispose(){this._data=this._compressData=null}
function FDisplay(b){b=RClass.inherits(this,b,FComponent,MGraphicObject);b._currentMatrix=null;b._matrix=null;b._location=null;b._rotation=null;b._scale=null;b._visible=!0;b._renderables=null;b.construct=FDisplay_construct;b.currentMatrix=FDisplay_currentMatrix;b.matrix=FDisplay_matrix;b.location=FDisplay_location;b.rotation=FDisplay_rotation;b.scale=FDisplay_scale;b.hasRenderable=FDisplay_hasRenderable;b.renderables=FDisplay_renderables;b.pushRenderable=FDisplay_pushRenderable;b.removeRenderable=
FDisplay_removeRenderable;b.clearRenderables=FDisplay_clearRenderables;b.filterDisplays=FDisplay_filterDisplays;b.filterRenderables=FDisplay_filterRenderables;b.show=FDisplay_show;b.hide=FDisplay_hide;b.setVisible=FDisplay_setVisible;b.update=FDisplay_update;b.updateMatrix=FDisplay_updateMatrix;b.process=FDisplay_process;b.remove=FDisplay_remove;b.dispose=FDisplay_dispose;return b}
function FDisplay_construct(){this.__base.FComponent.construct.call(this);this._currentMatrix=new SMatrix3d;this._matrix=new SMatrix3d;this._location=new SPoint3;this._rotation=new SVector3;this._scale=new SVector3;this._scale.set(1,1,1)}function FDisplay_currentMatrix(){return this._currentMatrix}function FDisplay_matrix(){return this._matrix}function FDisplay_location(){return this._location}function FDisplay_rotation(){return this._rotation}function FDisplay_scale(){return this._scale}
function FDisplay_hasRenderable(){var b=this._renderables;return b?!b.isEmpty():!1}function FDisplay_renderables(){var b=this._renderables;b||(b=this._renderables=new TObjects);return b}function FDisplay_pushRenderable(b){b._display=this;this.renderables().push(b)}function FDisplay_removeRenderable(b){var d=this._renderables;d&&d.remove(b)}function FDisplay_clearRenderables(){var b=this._renderables;b&&b.clear()}function FDisplay_filterDisplays(b){this._visible&&b.push(this)}
function FDisplay_filterRenderables(b){if(!this._visible)return!1;var d=this._renderables;if(d)for(var f=d.count(),h=0;h<f;h++)d.getAt(h).filterDrawables(b);return!0}function FDisplay_show(){this.setVisible(!0)}function FDisplay_hide(){this.setVisible(!1)}function FDisplay_setVisible(b){this._visible=b}function FDisplay_update(){var b=this._matrix;b.set(this._location,this._rotation,this._scale);b.update()}
function FDisplay_updateMatrix(b){this._currentMatrix.assign(this._matrix);(b=this._parent)&&this._currentMatrix.append(b._currentMatrix)}function FDisplay_process(b){this.updateMatrix(b);var d=this._renderables;if(d)for(var f=d.count(),h=0;h<f;h++)d.at(h).process(b)}function FDisplay_remove(){var b=this._parent;b&&(b.removeDisplay(this),this._parent=null)}
function FDisplay_dispose(){RObject.dispose(this._currentMatrix);RObject.dispose(this._matrix);RObject.dispose(this._position);RObject.dispose(this._direction);RObject.dispose(this._scale);RObject.dispose(this._renderables);this.__base.FComponent.dispose.call(this)}
function FDisplayContainer(b){b=RClass.inherits(this,b,FDisplay);b._displays=null;b.hasDisplay=FDisplayContainer_hasDisplay;b.findDisplay=FDisplayContainer_findDisplay;b.searchDisplay=FDisplayContainer_searchDisplay;b.displays=FDisplayContainer_displays;b.pushDisplay=FDisplayContainer_pushDisplay;b.removeDisplay=FDisplayContainer_removeDisplay;b.filterDisplays=FDisplayContainer_filterDisplays;b.filterRenderables=FDisplayContainer_filterRenderables;b.process=FDisplayContainer_process;b.dispose=FDisplayContainer_dispose;
return b}function FDisplayContainer_hasDisplay(){var b=this._displays;return b?!b.isEmpty():!1}function FDisplayContainer_findDisplay(b){var d=this._displays;if(d)for(var f=d.count(),h=0;h<f;h++){var q=d.at(h);if(q.code()==b)return q}return null}function FDisplayContainer_searchDisplay(b){var d=this._displays;if(d)for(var f=d.count(),h=0;h<f;h++){var q=d.at(h);if(q.isName(b)||(q=q.searchDisplay(b)))return q}return null}
function FDisplayContainer_displays(){var b=this._displays;b||(b=this._displays=new TObjects);return b}function FDisplayContainer_pushDisplay(b){b.setParent(this);this.displays().push(b)}function FDisplayContainer_removeDisplay(b){this.displays().remove(b);b.setParent(null)}function FDisplayContainer_filterDisplays(b){this.__base.FDisplay.filterDisplays.call(this,b);if(!this._visible)return!1;var d=this._displays;if(d)for(var f=d.count(),h=0;h<f;h++)d.at(h).filterDisplays(b)}
function FDisplayContainer_filterRenderables(b){this.__base.FDisplay.filterRenderables.call(this,b);if(!this._visible)return!1;var d=this._displays;if(d)for(var f=d.count(),h=0;h<f;h++)d.at(h).filterRenderables(b);return!0}function FDisplayContainer_process(b){this.__base.FDisplay.process.call(this,b);var d=this._displays;if(d)for(var f=d.count(),h=0;h<f;h++)d.at(h).process(b)}
function FDisplayContainer_dispose(){var b=this._displays;if(b){for(var d=v.count()-1;0<=d;d--)b.at(d).dispose();this._displays=RObject.dispose(b)}this.__base.FDisplay.dispose.call(this)}
function FDisplayLayer(b){b=RClass.inherits(this,b,FDisplayContainer);b._statusActive=!1;b._technique=null;b._visibleRenderables=null;b.construct=FDisplayLayer_construct;b.technique=FDisplayLayer_technique;b.setTechnique=FDisplayLayer_setTechnique;b.selectTechnique=FDisplayLayer_selectTechnique;b.visibleRenderables=FDisplayLayer_visibleRenderables;b.filterRenderables=FDisplayLayer_filterRenderables;b.active=FDisplayLayer_active;b.deactive=FDisplayLayer_deactive;return b}
function FDisplayLayer_construct(){this.__base.FDisplayContainer.construct.call(this);this._visibleRenderables=new TObjects}function FDisplayLayer_technique(){return this._technique}function FDisplayLayer_setTechnique(b){this._technique=b}function FDisplayLayer_selectTechnique(b,d){this._technique=RConsole.find(FG3dTechniqueConsole).find(b,d)}function FDisplayLayer_visibleRenderables(){return this._visibleRenderables}
function FDisplayLayer_filterRenderables(b){this.__base.FDisplayContainer.filterRenderables.call(this,b);this._visibleRenderables.assign(b.renderables())}function FDisplayLayer_active(){this._statusActive=!0}function FDisplayLayer_deactive(){this._statusActive=!1}function FDisplayUiLayer(b){return b=RClass.inherits(this,b,FDisplayLayer)}
function FDrawable(b){b=RClass.inherits(this,b,FObject);b._visible=!0;b.testVisible=FDrawable_testVisible;b.visible=FDrawable_visible;b.setVisible=FDrawable_setVisible;b.process=RMethod.empty;return b}function FDrawable_testVisible(){return this._visible}function FDrawable_visible(){return this._visible}function FDrawable_setVisible(b){this._visible=b}function FRegion(b){return b=RClass.inherits(this,b,FObject)}
function FRenderable(b){b=RClass.inherits(this,b,FDrawable);b._drawables=null;b.hasDrawable=FRenderable_hasDrawable;b.drawables=FRenderable_drawables;b.pushDrawable=FRenderable_pushDrawable;b.removeDrawable=FRenderable_removeDrawable;b.filterDrawables=FRenderable_filterDrawables;b.process=FRenderable_process;return b}function FRenderable_hasDrawable(){var b=this._drawables;return b?!b.isEmpty():!1}
function FRenderable_drawables(){var b=this._drawables;b||(b=this._drawables=new TObjects);return b}function FRenderable_pushDrawable(b){b._drawable=this;b._parent=this;this.drawables().push(b)}function FRenderable_removeDrawable(b){this._drawables.remove(b)}function FRenderable_filterDrawables(b){if(!this.testVisible())return!1;b.pushRenderable(this);var d=this._drawables;if(d)for(var f=d.count(),h=0;h<f;h++){var q=d.getAt(h);q.testVisible()&&b.pushRenderable(q)}return!0}
function FRenderable_process(b){this.__base.FDrawable.process.call(this,b);var d=this._drawables;if(d)for(var f=d.count(),h=0;h<f;h++)d.getAt(h).process(b)}
function FStage(b){b=RClass.inherits(this,b,FComponent,MListenerEnterFrame,MListenerLeaveFrame);b._statusActive=!1;b._layers=null;b._timer=null;b.onProcess=FStage_onProcess;b.construct=FStage_construct;b.timer=FStage_timer;b.registerLayer=FStage_registerLayer;b.unregisterLayer=FStage_unregisterLayer;b.layers=FStage_layers;b.active=FStage_active;b.deactive=FStage_deactive;b.process=FStage_process;b.dispose=FStage_dispose;return b}
function FStage_onProcess(){for(var b=this._layers,d=b.count(),f=0;f<d;f++)b.valueAt(f).process()}function FStage_construct(){this.__base.FComponent.construct.call(this);this._timer=RClass.create(FTimer);this._layers=new TDictionary}function FStage_timer(){return this._timer}function FStage_registerLayer(b,d){d.setCode(b);this._layers.set(b,d)}function FStage_unregisterLayer(b){this._layers.set(b,null)}function FStage_layers(){return this._layers}
function FStage_active(){this._statusActive=!0;for(var b=this._layers,d=b.count(),f=0;f<d;f++)b.value(f).active()}function FStage_deactive(){for(var b=this._layers,d=b.count(),f=0;f<d;f++)b.value(f).deactive();this._statusActive=!1}function FStage_process(){var b=this._timer;b||(b=RClass.create(FTimer),b.setup());this.processEnterFrameListener(this);this.onProcess();this.processLeaveFrameListener(this);b.update()}
function FStage_dispose(){this._timer=RObject.dispose(this._timer);this._layers=RObject.dispose(this._layers);this.__base.MListenerEnterFrame.dispose.call(this);this.__base.MListenerLeaveFrame.dispose.call(this);this.__base.FComponent.dispose.call(this)}
var RStage=new function(){this._started=!1;this._active=!0;this._interval=25;this.lsnsLeaveFrame=this.lsnsEnterFrame=this._stages=null;this.onProcess=RStage_onProcess;this.construct=RStage_construct;this.register=RStage_register;this.unregister=RStage_unregister;this.active=RStage_active;this.deactive=RStage_deactive;this.process=RStage_process;this.start=RStage_start;this.construct();return this};function RStage_onProcess(){RStage.process()}
function RStage_construct(){this.lsnsEnterFrame=new TListeners;this.lsnsLeaveFrame=new TListeners}function RStage_register(b,d){var f=this._stages;f||(f=this._stages=new TDictionary);f.set(b,d)}function RStage_unregister(b){this._stages.removeValue(b)}function RStage_active(){var b=this._stages;if(b)for(var d=b.count(),f=0;f<d;f++)b.at(f).active()}function RStage_deactive(){var b=this._stages;if(b)for(var d=b.count(),f=0;f<d;f++)b.at(f).deactive()}
function RStage_process(){if(this._active)try{this.lsnsEnterFrame.process(this);var b=this._stages;if(b)for(var d=b.count(),f=0;f<d;f++)b.at(f).process();this.lsnsLeaveFrame.process(this);RTimer.update()}catch(h){alert(h)}}function RStage_start(b){this._started||(RE3dEngine.setup(),this.active(),this.process(),null==b&&(b=this._interval),RTimer.setup(),setInterval("RStage_onProcess()",parseInt(b)),this._started=!0)}
function MLinkerResource(b){b=RClass.inherits(this,b);b._resource=null;b.resource=MLinkerResource_resource;b.setResource=MLinkerResource_setResource;b.loadResource=MLinkerResource_loadResource;return b}function MLinkerResource_resource(){return this._resource}function MLinkerResource_setResource(b){this._resource=b}function MLinkerResource_loadResource(b){this._resource=b}
function FResource(b){b=RClass.inherits(this,b,FObject);b._typeCode=null;b._type=null;b._dataCompress=!1;b._dataBlock=!1;b._guid=null;b._code=null;b._label=null;b._sourceUrl=null;b.typeCode=FResource_typeCode;b.type=FResource_type;b.guid=FResource_guid;b.setGuid=FResource_setGuid;b.code=FResource_code;b.setCode=FResource_setCode;b.label=FResource_label;b.setLabel=FResource_setLabel;b.sourceUrl=FResource_sourceUrl;b.setSourceUrl=FResource_setSourceUrl;return b}
function FResource_typeCode(){return this._typeCode}function FResource_type(){return this._type}function FResource_guid(){return this._guid}function FResource_setGuid(b){this._guid=b}function FResource_code(){return this._code}function FResource_setCode(b){this._code=b}function FResource_label(){return this._label}function FResource_setLabel(b){this._label=b}function FResource_sourceUrl(){return this._sourceUrl}function FResource_setSourceUrl(b){this._sourceUrl=b}
function FResourceBlockStorage(b){b=RClass.inherits(this,b,FResourceStorage);b._ready=!1;b._dataLength=0;b._blockSize=0;b._blockCount=0;b._blocks=null;b._resource=null;b.construct=FResourceBlockStorage_construct;b.testReady=FResourceBlockStorage_testReady;b.blocks=FResourceBlockStorage_blocks;b.load=FResourceBlockStorage_load;b.complete=FResourceBlockStorage_complete;b.dispose=FResourceBlockStorage_dispose;return b}
function FResourceBlockStorage_construct(){this.__base.FResourceStorage.construct.call(this);this._blocks=new TObjects}function FResourceBlockStorage_testReady(){if(!this._ready){for(var b=this._blocks,d=b.count(),f=0;f<d;f++)if(!b.at(f).testReady())return!1;this._ready=!0}return this._ready}function FResourceBlockStorage_blocks(){return this._blocks}
function FResourceBlockStorage_load(b){var d=this._resource;this._compressLength=b.byteLength;var f=RClass.create(FDataView);f.setEndianCd(!0);f.link(b);f.readString();this._dataLength=f.readInt32();this._blockSize=f.readInt32();b=this._blockCount=f.readInt32();for(var h=this._blocks,q=0;q<b;q++){var z=f.readInt32(),A=new ArrayBuffer(z);f.readBytes(A,0,z);z=RClass.create(FResourceBlockStorageData);z._guid=d.guid();z._index=q;z.setCompressData(A);h.push(z)}f.dispose()}
function FResourceBlockStorage_complete(){var b=this._resource,d=RClass.create(FDataStream);d.setEndianCd(!0);d.setLength(this._dataLength);for(var f=this._blocks,h=f.count(),q=0;q<h;q++){var z=f.at(q)._data;d.writeBytes(z.buffer,0,z.byteLength)}d.flip();f=RTimer.current()-b._compressStartTick;RLogger.info(this,"Process resource storage. (guid={1}, block_count={2}, length={3}, total={4}, tick={5})",b.guid(),h,this._compressLength,this._dataLength,f);b.onComplete(d);d.dispose()}
function FResourceBlockStorage_dispose(){this._resource=null;var b=this._blocks;if(b){for(var d=b.count(),f=0;f<d;f++)b.at(f).dispose();this._blocks=RObject.dispose(b)}this.__base.FResourceStorage.dispose.call(this)}function FResourceBlockStorageData(b){b=RClass.inherits(this,b,FObject,MResourceData);b.dispose=FResourceBlockStorageData_dispose;return b}function FResourceBlockStorageData_dispose(){this.__base.MResourceData.dispose.call(this);this.__base.FObject.dispose.call(this)}
function FResourceConsole(b){b=RClass.inherits(this,b,FConsole);b._scopeCd=EScope.Global;b._factory=null;b._types=null;b._resources=null;b._loadResources=null;b._loadingResources=null;b._processStorages=null;b._thread=null;b._loadLimit=8;b._interval=150;b.onComplete=FResourceConsole_onComplete;b.onLoad=FResourceConsole_onLoad;b.onBlockLoad=FResourceConsole_onBlockLoad;b.onProcess=FResourceConsole_onProcess;b.construct=FResourceConsole_construct;b.registerType=FResourceConsole_registerType;b.factory=
FResourceConsole_factory;b.load=FResourceConsole_load;return b}function FResourceConsole_onComplete(b,d){b._data=null;this._loadingResources.remove(b);b.onComplete(d)}function FResourceConsole_onLoad(b){var d=b.outputData();b=b._resource;var f=RClass.create(FResourceSingleStorage);f.setResource(b);f.load(d);RConsole.find(FResourceDataConsole).load(f);this._loadingResources.remove(b);this._processStorages.push(f)}
function FResourceConsole_onBlockLoad(b){var d=b.outputData();b=b._resource;b._compressLength=d.byteLength;b._compressStartTick=RTimer.current();var f=RClass.create(FResourceBlockStorage);f.setResource(b);f.load(d);for(var d=RConsole.find(FResourceDataConsole),h=f.blocks(),q=h.count(),z=0;z<q;z++){var A=h.at(z);d.load(A)}this._loadingResources.remove(b);this._processStorages.push(f)}
function FResourceConsole_onProcess(){var b=RConsole.find(FHttpConsole),d=this._loadResources,f=this._loadingResources,h=f.count();if(!d.isEmpty())for(h=this._loadLimit-h;0<h;h--){var q=d.shift(),z=q.sourceUrl(),z=b.send(z);z._resource=q;q._dataCompress?q._dataBlock?z.addLoadListener(this,this.onBlockLoad):z.addLoadListener(this,this.onLoad):z.addLoadListener(this,this.onComplete);q._dataLoad=!0;f.push(q);if(d.isEmpty())break}b=this._processStorages;for(b.record();b.next();)d=b.current(),d.testReady()&&
(b.removeCurrent(),d.complete(),d.dispose())}function FResourceConsole_construct(){this.__base.FConsole.construct.call(this);this._factory=RClass.create(FClassFactory);this._types=new TDictionary;this._resources=new TDictionary;this._loadResources=new TObjects;this._loadingResources=new TObjects;this._processStorages=new TLooper;var b=this._thread=RClass.create(FThread);b.setInterval(this._interval);b.addProcessListener(this,this.onProcess);RConsole.find(FThreadConsole).start(b)}
function FResourceConsole_registerType(b){var d=b.code();return this._types.set(d,b)}function FResourceConsole_factory(){return this._factory}function FResourceConsole_load(b){var d=b.guid(),f=this._resources;if(f.contains(d))throw new TError(this,"Resource is already loaded. (guid={1})",d);f.set(d,b);this._loadResources.push(b);b._dataLoad=!0}
function FResourceDataConsole(b){b=RClass.inherits(this,b,FConsole);b._scopeCd=EScope.Global;b._loadDatas=null;b._processDatas=null;b._pipeline=null;b._pipelinePool=null;b._thread=null;b._processLimit=4;b._interval=200;b.onPipelineComplete=FResourceDataConsole_onPipelineComplete;b.onProcess=FResourceDataConsole_onProcess;b.construct=FResourceDataConsole_construct;b.allocPipeline=FResourceDataConsole_allocPipeline;b.freePipeline=FResourceDataConsole_freePipeline;b.load=FResourceDataConsole_load;return b}
function FResourceDataConsole_onPipelineComplete(b,d){b&&this.freePipeline(b);this._processDatas.remove(d)}function FResourceDataConsole_onProcess(){var b=this._loadDatas,d=b.count();if(0!=d){var f=this._pipeline;if(f)f.testBusy()||(d=b.shift(),f.decompress(d));else{var h=this._processDatas,f=h.count(),f=this._processLimit-f;if(!(0>=f))for(var q=Math.min(d,f),z=0;z<q;z++)d=b.shift(),f=this.allocPipeline(),f.decompress(d),h.push(d)}}}
function FResourceDataConsole_construct(){this.__base.FConsole.construct.call(this);this._loadDatas=new TObjects;this._processDatas=new TObjects;this._pipelinePool=RClass.create(FObjectPool);RBrowser.capability().optionProcess||(this._pipeline=RClass.create(FResourceSinglePipeline)).setConsole(this);var b=this._thread=RClass.create(FThread);b.setInterval(this._interval);b.addProcessListener(this,this.onProcess);RConsole.find(FThreadConsole).start(b)}
function FResourceDataConsole_allocPipeline(){var b=this._pipelinePool;if(!b.hasFree()){var d=RClass.create(FResourceThreadPipeline);d.setConsole(this);b.push(d)}return b.alloc()}function FResourceDataConsole_freePipeline(b){this._pipelinePool.free(b)}function FResourceDataConsole_load(b){this._loadDatas.push(b)}function FResourceGroup(b){b=RClass.inherits(this,b,FObject);b._code=null;b._resources=null;b.code=FResourceGroup_code;return b}function FResourceGroup_code(){return this._code}
function FResourcePipeline(b){b=RClass.inherits(this,b,FPipeline);b._console=null;b._compressCd=null;b._resource=null;b.console=FResourcePipeline_console;b.setConsole=FResourcePipeline_setConsole;b.compressCd=FResourcePipeline_compressCd;b.resource=FResourcePipeline_resource;b.setResource=FResourcePipeline_setResource;b.dispose=FResourcePipeline_dispose;return b}function FResourcePipeline_console(){return this._console}function FResourcePipeline_setConsole(b){this._console=b}
function FResourcePipeline_compressCd(){return this._compressCd}function FResourcePipeline_resource(){return this._resource}function FResourcePipeline_setResource(b){this._resource=b}function FResourcePipeline_dispose(){this._resource=this._console=null;this.__base.FPipeline.dispose.call(this)}
function FResourceSinglePipeline(b){b=RClass.inherits(this,b,FResourcePipeline);b._startTime=0;b._statusBusy=!1;b._data=0;b._dataLength=0;b._worker=null;b.onComplete=FResourceSinglePipeline_onComplete;b.construct=FResourceSinglePipeline_construct;b.testBusy=FResourceSinglePipeline_testBusy;b.decompress=FResourceSinglePipeline_decompress;b.dispose=FResourceSinglePipeline_dispose;return b}
function FResourceSinglePipeline_onComplete(b){var d=null;if(b.constructor==Array)d=new Uint8Array(b);else if(b.constructor==ArrayBuffer)d=b;else throw new TError(this,"Unknown buffer type.");b=this._data;b.completeData(d);var f=RTimer.now()-this._startTime;RLogger.info(this,"Process resource data decompress. (guid={1}, block={2}, length={3}, total={4}, tick={5})",b._guid,b._index,this._dataLength,d.byteLength,f);this._console.onPipelineComplete(null,b);this._data=null;this._statusBusy=!1}
function FResourceSinglePipeline_construct(){this.__base.FResourcePipeline.construct.call(this)}function FResourceSinglePipeline_testBusy(){return this._statusBusy}
function FResourceSinglePipeline_decompress(b){var d=this;d._startTime=RTimer.current();var f=b.compressData();d._data=b;d._dataLength=f.byteLength;b=null;if(f.constructor==ArrayBuffer)b=new Uint8Array(f);else if(f.constructor==Uint8Array)b=f;else throw new TError(d,"Unknown data type.");d._statusBusy=!0;LZMA.decompress(b,function(b){d.onComplete(b)},null)}function FResourceSinglePipeline_dispose(){this._worker=this._data=null;this.__base.FPipeline.dispose.call(this)}
function FResourceSingleStorage(b){b=RClass.inherits(this,b,FResourceStorage,MResourceData);b.construct=FResourceSingleStorage_construct;b.load=FResourceSingleStorage_load;b.complete=FResourceSingleStorage_complete;b.dispose=FResourceSingleStorage_dispose;return b}function FResourceSingleStorage_construct(){this.__base.FResourceStorage.construct.call(this)}function FResourceSingleStorage_load(b){this._compressLength=b.byteLength;this._compressData=new Uint8Array(b)}
function FResourceSingleStorage_complete(){this._resource.onComplete(this._data)}function FResourceSingleStorage_dispose(){this.__base.MResourceData.dispose.call(this);this.__base.FResourceStorage.dispose.call(this)}
function FResourceStorage(b){b=RClass.inherits(this,b,FObject);b._ready=!1;b._dataLength=0;b._resource=null;b.construct=FResourceStorage_construct;b.testReady=FResourceStorage_testReady;b.resource=FResourceStorage_resource;b.setResource=FResourceStorage_setResource;b.load=FResourceStorage_load;b.complete=FResourceStorage_complete;b.dispose=FResourceStorage_dispose;return b}function FResourceStorage_construct(){this.__base.FObject.construct.call(this)}
function FResourceStorage_testReady(){return this._ready}function FResourceStorage_resource(){return this._resource}function FResourceStorage_setResource(b){this._resource=b}function FResourceStorage_load(b){}function FResourceStorage_complete(){}function FResourceStorage_dispose(){this._resource=null;this.__base.FObject.dispose.call(this)}
function FResourceThreadPipeline(b){b=RClass.inherits(this,b,FResourcePipeline);b._startTime=0;b._data=0;b._dataLength=0;b._worker=null;b.onComplete=FResourceThreadPipeline_onComplete;b.construct=FResourceThreadPipeline_construct;b.worker=FResourceThreadPipeline_worker;b.decompress=FResourceThreadPipeline_decompress;b.dispose=FResourceThreadPipeline_dispose;return b}
function FResourceThreadPipeline_onComplete(b){var d=null;if(b.constructor==Array)d=new Uint8Array(b);else if(b.constructor==Uint8Array)d=b;else throw new TError(this,"Unknown buffer type.");var f=this._data;f.completeData(d);d=RTimer.now()-this._startTime;RLogger.info(this,"Process resource data decompress. (guid={1}, block={2}, length={3}, total={4}, tick={5})",f._guid,f._index,this._dataLength,b.byteLength,d);this._console.onPipelineComplete(this,f);this._data=null}
function FResourceThreadPipeline_construct(){this.__base.FResourcePipeline.construct.call(this)}function FResourceThreadPipeline_worker(){var b=this._worker;b||(b=RBrowser.contentPath("/ajs/lzma_worker.js"),b=this._worker=new LZMA_WORKER(b));return b}function FResourceThreadPipeline_decompress(b){var d=this;d._startTime=RTimer.current();var f=b.compressData();d._data=b;d._dataLength=f.byteLength;debugger;d.worker().decompress(f,function(b){d.onComplete(b)},null)}
function FResourceThreadPipeline_dispose(){this._worker=this._data=null;this.__base.FPipeline.dispose.call(this)}function FResourceType(b){b=RClass.inherits(this,b,FObject);b._code=null;b._pipeline=null;b._resources=null;b.construct=FResourceType_construct;b.code=FResourceType_code;b.setCode=FResourceType_setCode;b.pipeline=FResourceType_pipeline;b.setPipeline=FResourceType_setPipeline;b.findResource=FResourceType_findResource;b.resources=FResourceType_resources;return b}
function FResourceType_construct(){this.__base.FObject.construct.call(this);this._resources=new TDictionary}function FResourceType_code(){return this._code}function FResourceType_setCode(b){this._code=b}function FResourceType_pipeline(){return this._pipeline}function FResourceType_setPipeline(b){this._pipeline=b}function FResourceType_findResource(b){return this._resources.get(b)}function FResourceType_resources(){return this._resources}
function FE2dCanvas(b){b=RClass.inherits(this,b,FObject,MCanvasObject);b._size=null;b._context=null;b._hCanvas=null;b.onResize=FE2dCanvas_onResize;b.construct=FE2dCanvas_construct;b.htmlCanvas=FE2dCanvas_htmlCanvas;b.size=FE2dCanvas_size;b.context=FE2dCanvas_context;b.build=FE2dCanvas_build;b.setPanel=FE2dCanvas_setPanel;b.dispose=FE2dCanvas_dispose;return b}function FE2dCanvas_onResize(b){}function FE2dCanvas_construct(){this.__base.FObject.construct.call(this);this._size=new SSize2}
function FE2dCanvas_htmlCanvas(){return this._hCanvas}function FE2dCanvas_size(){return this._size}function FE2dCanvas_context(){return this._context}function FE2dCanvas_build(b){var d=this._size,f=d.width,d=d.height;b=this._hCanvas=RBuilder.create(b,"CANVAS");b.__linker=this;b.width=f;b.height=d;var h=b.style;h.width=f+"px";h.height=d+"px";(this._context=RClass.create(FG2dCanvasContext)).linkCanvas(b)}function FE2dCanvas_setPanel(b){this._hPanel=b;b.appendChild(this._hCanvas);this.onResize()}
function FE2dCanvas_dispose(){this._context=RObject.dispose(this._context);this._hPanel=RHtml.free(this._hPanel);this._hCanvas=RHtml.free(this._hCanvas);this.__base.FObject.dispose.call(this)}function FE2dCanvasConsole(b){b=RClass.inherits(this,b,FConsole);b._scopeCd=EScope.Local;b._pools=null;b.construct=FE2dCanvasConsole_construct;b.allocBySize=FE2dCanvasConsole_allocBySize;b.free=FE2dCanvasConsole_free;return b}
function FE2dCanvasConsole_construct(){this.__base.FConsole.construct.call(this);this._pools=RClass.create(FObjectPools)}function FE2dCanvasConsole_allocBySize(b,d){var f=this._pools.alloc(b+"x"+d);if(f)return f;f=RClass.create(FE2dCanvas);f.size().set(b,d);f.build(RWindow._hDocument);return f}function FE2dCanvasConsole_free(b){var d=this._pools,f=b.size();d.free(f.width+"x"+f.height,b)}function FE2dDrawable(b){return b=RClass.inherits(this,b,FDrawable)}
function ME3dObject(b){return b=RClass.inherits(this,b,MGraphicObject,MAttributeGuid,MAttributeCode)}
function FE3dCanvas(b){b=RClass.inherits(this,b,FObject,MGraphicObject,MListenerLoad,MMouseCapture);b._optionAlpha=!0;b._optionAntialias=!1;b._scaleRate=1;b._size=null;b._interval=1E3/60;b._hPanel=null;b._hCanvas=null;b.onEnterFrame=RMethod.empty;b.ohTouchStart=FE3dCanvas_ohTouchStart;b.ohTouchMove=FE3dCanvas_ohTouchMove;b.ohTouchStop=FE3dCanvas_ohTouchStop;b.onMouseCaptureStart=RMethod.empty;b.onMouseCapture=RMethod.empty;b.onMouseCaptureStop=RMethod.empty;b.onTouchStart=RMethod.empty;b.onTouchMove=
RMethod.empty;b.onTouchStop=RMethod.empty;b.onResize=FE3dCanvas_onResize;b.construct=FE3dCanvas_construct;b.build=FE3dCanvas_build;b.resize=FE3dCanvas_resize;b.setPanel=FE3dCanvas_setPanel;b.dispose=FE3dCanvas_dispose;return b}function FE3dCanvas_ohTouchStart(b){this.__linker.onTouchStart(b)}function FE3dCanvas_ohTouchMove(b){this.__linker.onTouchMove(b)}function FE3dCanvas_ohTouchStop(b){this.__linker.onTouchStop(b)}
function FE3dCanvas_onResize(b){var d=this._hPanel;b=d.offsetWidth;d=d.offsetHeight;if(!this._size.equalsData(b,d)){this._size.set(b,d);var f=this._hCanvas;b=f.width=b*this._scaleRate;d=f.height=d*this._scaleRate;this._graphicContext.setViewport(0,0,b,d)}}function FE3dCanvas_construct(){this.__base.FObject.construct.call(this);this._size=new SSize2}
function FE3dCanvas_build(b){b=this._hCanvas=RBuilder.create(b,"CANVAS");b.__linker=this;b.style.width="100%";b.style.height="100%";RMethod.isEmpty(this.onTouchStart)||b.addEventListener("touchstart",this.ohTouchStart,!1);RMethod.isEmpty(this.onTouchMove)||b.addEventListener("touchmove",this.ohTouchMove,!1);RMethod.isEmpty(this.onTouchStop)||b.addEventListener("touchend",this.ohTouchStop,!1);var d={};d.alpha=this._optionAlpha;d.antialias=this._optionAntialias;this._graphicContext=REngine3d.createContext(FWglContext,
b,d);RStage.lsnsEnterFrame.register(this,this.onEnterFrame);RStage.start(this._interval);RWindow.lsnsResize.register(this,this.onResize);RWindow.lsnsOrientation.register(this,this.onResize);RConsole.find(FMouseConsole).register(this)}function FE3dCanvas_resize(){this.onResize()}function FE3dCanvas_setPanel(b){this._hPanel=b;b.appendChild(this._hCanvas);this.onResize()}
function FE3dCanvas_dispose(){var b=this._hCanvas;b&&(b.__linker=null,b.removeEventListener("touchstart",this.ohTouchStart),b.removeEventListener("touchmove",this.ohTouchMove),b.removeEventListener("touchend",this.ohTouchStop));this._graphicContext=RObject.dispose(this._graphicContext);this._hPanel=RHtml.free(this._hPanel);this._hCanvas=RHtml.free(this._hCanvas);this.__base.FObject.dispose.call(this)}
function FE3dDisplay(b){b=RClass.inherits(this,b,FDisplay);b._outline=null;b._materials=null;b.construct=FE3dDisplay_construct;b.materials=FE3dDisplay_materials;b.calculateOutline=FE3dDisplay_calculateOutline;b.dispose=FE3dDisplay_dispose;return b}function FE3dDisplay_construct(){this.__base.FDisplay.construct.call(this);this._outline=new SOutline3}function FE3dDisplay_materials(){return this._materials}function FE3dDisplay_calculateOutline(){return this._outline}
function FE3dDisplay_dispose(){this._materials=RObject.free(this._materials);this.__base.FDisplay.dispose.call(this)}function FE3dDisplayContainer(b){b=RClass.inherits(this,b,FDisplayContainer);b._outline=null;b._materials=null;b.construct=FE3dDisplayContainer_construct;b.materials=FE3dDisplayContainer_materials;b.calculateOutline=FE3dDisplayContainer_calculateOutline;b.dispose=FE3dDisplayContainer_dispose;return b}
function FE3dDisplayContainer_construct(){this.__base.FDisplayContainer.construct.call(this);this._outline=new SOutline3}function FE3dDisplayContainer_materials(){return this._materials}function FE3dDisplayContainer_calculateOutline(){return this._outline}function FE3dDisplayContainer_dispose(){this._materials=RObject.free(this._materials);this.__base.FDisplayContainer.dispose.call(this)}
function FE3dRenderable(b){b=RClass.inherits(this,b,FRenderable,MG3dRenderable,MGraphicObject,MLinkerResource);b._display=null;b._outline=null;b._outlineVisible=!0;b._calculateMatrix=null;b._vertexCount=0;b._vertexBuffers=null;b._indexBuffer=null;b._indexBuffers=null;b._materialReference=null;b._materials=null;b._bones=null;b._textures=null;b.construct=FE3dRenderable_construct;b.setup=RMethod.empty;b.testReady=RMethod.emptyTrue;b.testVisible=FE3dRenderable_testVisible;b.display=FE3dRenderable_display;
b.setDisplay=FE3dRenderable_setDisplay;b.vertexCount=FE3dRenderable_vertexCount;b.findVertexBuffer=FE3dRenderable_findVertexBuffer;b.vertexBuffers=FE3dRenderable_vertexBuffers;b.indexBuffer=FE3dRenderable_indexBuffer;b.indexBuffers=FE3dRenderable_indexBuffers;b.materialReference=FE3dRenderable_materialReference;b.materials=FE3dRenderable_materials;b.pushMaterial=FE3dRenderable_pushMaterial;b.bones=FE3dRenderable_bones;b.findTexture=FE3dRenderable_findTexture;b.pushTexture=FE3dRenderable_pushTexture;
b.textures=FE3dRenderable_textures;b.processDelay=RMethod.empty;b.update=FE3dRenderable_update;b.remove=FE3dRenderable_remove;return b}function FE3dRenderable_construct(){this.__base.FRenderable.construct.call(this);this.__base.MG3dRenderable.construct.call(this);this._outline=new SOutline3d;this._calculateMatrix=new SMatrix3d;this._vertexBuffers=new TDictionary;this._materialReference=this}
function FE3dRenderable_testVisible(){if(!this.testReady()||!this.__base.FRenderable.testVisible.call(this)||!this._outlineVisible)return!1;var b=this._material;return b&&!b.testVisible()?!1:!0}function FE3dRenderable_display(){return this._display}function FE3dRenderable_setDisplay(b){this._display=b}function FE3dRenderable_vertexCount(){return this._vertexCount}function FE3dRenderable_findVertexBuffer(b){return this._vertexBuffers.get(b)}
function FE3dRenderable_vertexBuffers(){return this._vertexBuffers}function FE3dRenderable_materialReference(){return this._materialReference}function FE3dRenderable_materials(){return this._materials}function FE3dRenderable_pushMaterial(b){var d=this._materials;d||(d=this._materials=new TObjects);d.push(b)}function FE3dRenderable_indexBuffer(){return this._indexBuffer}function FE3dRenderable_indexBuffers(){return this._indexBuffers}function FE3dRenderable_bones(){return this._bones}
function FE3dRenderable_findTexture(b){return this._textures.get(b)}function FE3dRenderable_textures(){return this._textures}function FE3dRenderable_pushTexture(b){var d=this._textures;d||(d=this._textures=new TDictionary);var f=b.code();d.set(f,b)}function FE3dRenderable_update(b){var d=this._calculateMatrix;d.assign(this._matrix);var f=this._drawable;f&&d.append(f.currentMatrix());(f=this._display)&&d.append(f.currentMatrix());this._currentMatrix.attachData(d.data())&&b&&b.change()}
function FE3dRenderable_remove(){var b=this._display;b&&(b.removeRenderable(this),this._display=null)}
function FE3dStage(b){b=RClass.inherits(this,b,FStage,MGraphicObject);b._statistics=null;b._camera=null;b._directionalLight=null;b._technique=null;b._region=null;b._allDisplays=null;b.onProcess=FE3dStage_onProcess;b.construct=FE3dStage_construct;b.createRegion=FE3dStage_createRegion;b.setup=FE3dStage_setup;b.statistics=FE3dStage_statistics;b.camera=FE3dStage_camera;b.projection=FE3dStage_projection;b.directionalLight=FE3dStage_directionalLight;b.technique=FE3dStage_technique;b.selectTechnique=FE3dStage_selectTechnique;
b.region=FE3dStage_region;b.filterDisplays=FE3dStage_filterDisplays;b.allDisplays=FE3dStage_allDisplays;return b}
function FE3dStage_onProcess(){var b=this._region;if(b){var d=this._technique;if(d){var f=d._graphicContext,h=b._statistics=this._statistics;h.resetFrame();h._frame.begin();h._frameProcess.begin();f.prepare();d.updateRegion(b);b.prepare();b.change();for(var f=this._layers,q=f.count(),z=0;z<q;z++){var A=f.at(z);b.reset();A.process(b);A.filterRenderables(b);b.update()}RConsole.find(FE3dStageConsole).process(b);h._frameProcess.end();h._frameDraw.begin();if(b.isChanged()){d.clear(b.backgroundColor());
for(z=0;z<q;z++){var A=f.at(z),B=A.technique();B||(B=d);b.reset();b.renderables().assign(A.visibleRenderables());B.drawRegion(b)}d.present(b)}h._frameDraw.end();h._frame.end()}}}function FE3dStage_construct(){this.__base.FStage.construct.call(this);this._statistics=RClass.create(FE3dStageStatistics);RConsole.find(FStatisticsConsole).register("engine.stage",this._statistics);this._allDisplays=new TObjects;(this._region=this.createRegion())._timer=this._timer}
function FE3dStage_createRegion(){return RClass.create(FE3dRegion)}function FE3dStage_setup(){this.__base.FStage.construct.call(this);this._region.linkGraphicContext(this);this._region.setup()}function FE3dStage_statistics(){return this._statistics}function FE3dStage_camera(){return this._region._camera}function FE3dStage_projection(){return this._region._camera._projection}function FE3dStage_directionalLight(){return this._region._directionalLight}
function FE3dStage_technique(){return this._technique}function FE3dStage_selectTechnique(b,d){return this._technique=RConsole.find(FG3dTechniqueConsole).find(b,d)}function FE3dStage_region(){return this._region}function FE3dStage_filterDisplays(b){for(var d=this._layers,f=d.count(),h=0;h<f;h++)d.value(h).filterDisplays(b)}function FE3dStage_allDisplays(){var b=this._allDisplays;b.clear();this.filterDisplays(b);return b}
function FE3dStageConsole(b){b=RClass.inherits(this,b,FConsole);b._scopeCd=EScope.Local;b._looper=null;b._thread=null;b._interval=25;b._limit=8;b.onProcess=FE3dStageConsole_onProcess;b.construct=FE3dStageConsole_construct;b.process=FE3dStageConsole_process;return b}function FE3dStageConsole_onProcess(){var b=this._looper;b.record();for(var d=this._limit-1;0<=d;d--){var f=b.next();if(f)f.processDelay(f._linkRegion);else break}}
function FE3dStageConsole_construct(){this._looper=new TLooper;this._renderables=new TDictionary;var b=this._thread=RClass.create(FThread);b.setInterval(this._interval);b.addProcessListener(this,this.onProcess);RConsole.find(FThreadConsole).start(b)}function FE3dStageConsole_process(b){for(var d=b.allRenderables(),f=d.count()-1;0<=f;f--){var h=d.getAt(f);h._linkStageLooper||(this._looper.push(h),h._linkRegion=b,h._linkStageLooper=this._looper)}}
function FE3dStageStatistics(b){b=RClass.inherits(this,b,FStatistics);b._frame=null;b._frameProcess=null;b._frameDraw=null;b._frameDrawSort=null;b._frameDrawRenderable=null;b.construct=FE3dStageStatistics_construct;b.reset=FE3dStageStatistics_reset;b.resetFrame=FE3dStageStatistics_resetFrame;return b}
function FE3dStageStatistics_construct(){this.__base.FStatistics.construct.call(this);this._frame=new TSpeed;this._frameProcess=new TSpeed;this._frameDraw=new TSpeed;this._frameDrawSort=new TSpeed;this._frameDrawRenderable=new TSpeed}function FE3dStageStatistics_reset(){}function FE3dStageStatistics_resetFrame(){this._frame.reset();this._frameProcess.reset();this._frameDraw.reset();this._frameDrawSort.reset();this._frameDrawRenderable.reset()}
function FE3dTechnique(b){return b=RClass.inherits(this,b,FG3dTechnique,MLinkerResource)}var RE3dEngine=new function(){this._setuped=!1;this.onSetup=RE3dEngine_onSetup;this.setup=RE3dEngine_setup;return this};
function RE3dEngine_onSetup(){var b=RConsole.find(FG3dEffectConsole);b.register("select.select.control",FG3dSelectAutomaticEffect);b.register("select.select.automatic",FG3dSelectAutomaticEffect);b.register("select.select.skeleton",FG3dSelectSkeletonEffect);b.register("select.select.skeleton.4",FG3dSelectSkeletonEffect);b.register("control.control.automatic",FE3dControlAutomaticEffect);b.register("control.control.control",FE3dControlAutomaticEffect);b.register("general.color.control",FE3dControlAutomaticEffect);
b.register("general.color.flat",FE3dGeneralColorFlatEffect);b.register("general.color.automatic",FE3dGeneralColorAutomaticEffect);b.register("general.color.skin",FE3dGeneralColorAutomaticEffect);b.register("general.color.parallax",FE3dGeneralColorAutomaticEffect);b.register("general.color.skeleton",FE3dGeneralColorSkeletonEffect);b.register("general.color.skeleton.4",FE3dGeneralColorSkeletonEffect);b.register("general.color.fur.skeleton",FE3dGeneralColorSkeletonEffect);b.register("general.color.fur.skeleton.4",
FE3dGeneralColorSkeletonEffect);b.register("shadow.depth.automatic",FE3dShadowDepthAutomaticEffect);b.register("shadow.depth.skeleton",FE3dShadowDepthSkeletonEffect);b.register("shadow.color.automatic",FE3dShadowColorAutomaticEffect);b.register("shadow.color.skeleton",FE3dShadowColorSkeletonEffect)}function RE3dEngine_setup(){this._setuped||(this.onSetup(),this._setuped=!0)}
var EE3sResource=new function(){this.Unknown="Unknown";this.Bitmap="Bitmap";this.Material="Material";this.Mesh="Mesh";this.Model="Model";this.Template="Template";this.Scene="Scene";this.Project="Project";this.All="All";return this};
function ME3sGeometry(b){b=RClass.inherits(this,b);b._outline=null;b._streams=null;b.construct=ME3sGeometry_construct;b.outline=ME3sGeometry_outline;b.findStream=ME3sGeometry_findStream;b.streams=ME3sGeometry_streams;b.calculateOutline=ME3sGeometry_calculateOutline;b.dispose=ME3sGeometry_dispose;return b}function ME3sGeometry_construct(){this._outline=new SOutline3d}function ME3sGeometry_outline(){return this._outline}
function ME3sGeometry_findStream(b){var d=this._streams,f=d.count();for(n=0;n<f;n++){var h=d.getAt(n);if(h.code()==b)return h}return null}function ME3sGeometry_streams(){return this._streams}function ME3sGeometry_calculateOutline(){var b=this._outline;if(b.isEmpty()){b.setMin();for(var d=this.findStream("position"),f=d.dataCount(),d=new Float32Array(d.data()),h=0,q=0;q<f;q++){var z=d[h++],A=d[h++],B=d[h++];b.mergePoint(z,A,B)}b.update()}return b}
function ME3sGeometry_dispose(){this._outline=RObject.dispose(this._outline);this.__base.FE3sSpace.dispose.call(this)}function SE3sCompressEvent(b,d,f){this.owner=b;this.process=d;this.data=f;return this}function SE3sMaterialInfo(){SG3dMaterialInfo.call(this);this.unserialize=SE3sMaterialInfo_unserialize;this.saveConfig=SE3sMaterialInfo_saveConfig;return this}
function SE3sMaterialInfo_unserialize(b){this.effectCode=b.readString();this.optionDepth=b.readBoolean();this.optionDouble=b.readBoolean();this.optionNormalInvert=b.readBoolean();this.optionShadow=b.readBoolean();this.optionShadowSelf=b.readBoolean();this.optionAlpha=b.readBoolean();this.alphaBase=b.readFloat();this.alphaRate=b.readFloat();this.optionColor=b.readBoolean();this.colorMin=b.readFloat();this.colorMax=b.readFloat();this.colorBalance=b.readFloat();this.colorRate=b.readFloat();this.optionVertex=
b.readBoolean();this.vertexColor.unserialize(b);this.optionAmbient=b.readBoolean();this.ambientColor.unserialize(b);this.optionDiffuse=b.readBoolean();this.diffuseColor.unserialize(b);this.optionDiffuseView=b.readBoolean();this.diffuseViewColor.unserialize(b);this.optionSpecular=b.readBoolean();this.specularColor.unserialize(b);this.specularBase=b.readFloat();this.specularLevel=b.readFloat();this.optionSpecularView=b.readBoolean();this.specularViewColor.unserialize(b);this.specularViewBase=b.readFloat();
this.specularViewLevel=b.readFloat();this.optionReflect=b.readBoolean();this.reflectColor.unserialize(b);this.reflectMerge=b.readFloat();this.optionRefract=b.readBoolean();this.refractFrontColor.unserialize(b);this.refractBackColor.unserialize(b);this.optionOpacity=b.readBoolean();this.opacityColor.unserialize(b);this.opacityRate=b.readFloat();this.opacityAlpha=b.readFloat();this.opacityDepth=b.readFloat();this.opacityTransmittance=b.readFloat();this.optionEmissive=b.readBoolean();this.emissiveColor.unserialize(b)}
function SE3sMaterialInfo_saveConfig(b){b.set("effect_code",this.effectCode);b.setBoolean("option_double",this.optionDouble);b.setBoolean("option_alpha",this.optionAlpha);b.setBoolean("option_normal_invert",this.optionNormalInvert);b.setBoolean("option_shadow",this.optionShadow);b.setBoolean("option_shadow_self",this.optionShadowSelf);var d=b.create("Alpha");d.setBoolean("valid",this.optionAlpha);d.setFloat("base",this.alphaBase);d.setFloat("rate",this.alphaRate);d=b.create("Color");d.setBoolean("valid",
this.optionColor);d.setFloat("min",this.colorMin);d.setFloat("max",this.colorMax);d.setFloat("balance",this.colorBalance);d.setFloat("rate",this.colorRate);d=b.create("Vertex");d.setBoolean("valid",this.optionVertex);this.vertexColor.savePower(d);d=b.create("Ambient");d.setBoolean("valid",this.optionAmbient);this.ambientColor.savePower(d);d=b.create("Diffuse");d.setBoolean("valid",this.optionDiffuse);this.diffuseColor.savePower(d);d=b.create("DiffuseView");d.setBoolean("valid",this.optionDiffuseView);
this.diffuseViewColor.savePower(d);d=b.create("Specular");d.setBoolean("valid",this.optionSpecular);this.specularColor.savePower(d);d.setFloat("base",this.specularBase);d.setFloat("level",this.specularLevel);d=b.create("SpecularView");d.setBoolean("valid",this.optionSpecularView);this.specularViewColor.savePower(d);d.setFloat("base",this.specularViewBase);d.setFloat("level",this.specularViewLevel);d=b.create("Reflect");d.setBoolean("valid",this.optionReflect);this.reflectColor.savePower(d);d.setFloat("merge",
this.reflectMerge);d=b.create("Refract");d.setBoolean("valid",this.optionRefract);this.refractFrontColor.savePower(d.create("Front"));this.refractBackColor.savePower(d.create("Back"));d=b.create("Opacity");d.setBoolean("valid",this.optionOpacity);this.opacityColor.savePower(d);d.setFloat("rate",this.opacityRate);d.setFloat("alpha",this.opacityAlpha);d.setFloat("depth",this.opacityDepth);d.setFloat("transmittance",this.opacityTransmittance);d=b.create("Emissive");d.setBoolean("valid",this.optionEmissive);
this.emissiveColor.savePower(d)}function SE3sSceneShadow(){this.range=this.level=this.rate=this.base=null;this.unserialize=SE3sSceneShadow_unserialize;return this}function SE3sSceneShadow_unserialize(b){this.base=b.readFloat();this.rate=b.readFloat();this.level=b.readFloat();this.range=b.readFloat()}
function FE3sAnimation(b){b=RClass.inherits(this,b,FE3sObject);b._model=null;b._skeletonGuid=null;b._skeleton=null;b._frameCount=0;b._frameTick=0;b._frameSpan=0;b._frameTranslates=null;b._frameRotations=null;b._frameScales=null;b._tracks=null;b.skeletonGuid=FE3sAnimation_skeletonGuid;b.skeleton=FE3sAnimation_skeleton;b.frameCount=FE3sAnimation_frameCount;b.frameTick=FE3sAnimation_frameTick;b.frameSpan=FE3sAnimation_frameSpan;b.tracks=FE3sAnimation_tracks;b.unserialize=FE3sAnimation_unserialize;return b}
function FE3sAnimation_skeletonGuid(){return this._skeletonGuid}function FE3sAnimation_skeleton(){var b=this._skeleton;if(!b){var d=this._skeletonGuid;d&&(b=this._skeleton=RConsole.find(FE3sModelConsole).findSkeleton(d))}return b}function FE3sAnimation_frameCount(){return this._frameCount}function FE3sAnimation_frameTick(){return this._frameTick}function FE3sAnimation_frameSpan(){return this._frameSpan}function FE3sAnimation_tracks(){return this._tracks}
function FE3sAnimation_unserialize(b){this.__base.FE3sObject.unserialize.call(this,b);this._skeletonGuid=b.readString();this._frameCount=b.readUint16();this._frameTick=b.readUint16();this._frameSpan=b.readUint32();var d=b.readUint32(),f=RInteger.strideByte(d);if(0<d)for(var h=this._frameTranslates=new TObjects,q=0;q<d;q++){var z=new SPoint3;z.unserialize(b);h.push(z)}z=b.readUint32();d=RInteger.strideByte(z);if(0<z)for(var A=this._frameRotations=new TObjects,q=0;q<z;q++){var B=new SQuaternion;B.unserialize(b);
A.push(B)}B=b.readUint32();z=RInteger.strideByte(B);if(0<B)for(var C=this._frameScales=new TObjects,q=0;q<B;q++){var D=new SVector3;D.unserialize(b);C.push(D)}B=null;D=b.readUint16();if(0<D)for(var B=this._tracks=new TObjects,E=0;E<D;E++){var F=RClass.create(FE3sTrack);F.unserialize(b);B.push(F);for(var G=F._frameCount,F=F._frames,q=0;q<G;q++){var I=RClass.create(FE3sFrame),H=0,H=4==f?b.readUint32():2==f?b.readUint16():b.readUint8();I._translation=h.at(H);H=0;H=4==d?b.readUint32():2==d?b.readUint16():
b.readUint8();I._quaternion=A.at(H);H=0;H=4==z?b.readUint32():2==z?b.readUint16():b.readUint8();I._scale=C.at(H);F.push(I)}}if(B&&this._skeletonGuid){b=this.skeleton();for(q=0;q<D;q++)F=B.at(q),f=F.boneIndex(),b.findBone(f).setTrack(F);b.pushAnimation(this)}}function FE3sBone(b){b=RClass.inherits(this,b,FObject);b._index=null;b._track=null;b._bones=null;b.index=FE3sBone_index;b.track=FE3sBone_track;b.setTrack=FE3sBone_setTrack;b.bones=FE3sBone_bones;b.unserialize=FE3sBone_unserialize;return b}
function FE3sBone_index(){return this._index}function FE3sBone_track(){return this._track}function FE3sBone_setTrack(b){this._track=b}function FE3sBone_bones(){return this._bones}function FE3sBone_unserialize(b){this._index=b.readUint8();var d=b.readUint8();if(0<d)for(var f=this._bones=new TObjects,h=0;h<d;h++){var q=RClass.create(FE3sBone);q.unserialize(b);f.push(q)}}
function FE3sBoneRefer(b){b=RClass.inherits(this,b,FObject);b._index=null;b._bone=null;b._track=null;b.index=FE3sBoneRefer_index;b.bone=FE3sBoneRefer_bone;b.setBone=FE3sBoneRefer_setBone;b.track=FE3sBoneRefer_track;b.setTrack=FE3sBoneRefer_setTrack;b.unserialize=FE3sBoneRefer_unserialize;return b}function FE3sBoneRefer_index(){return this._index}function FE3sBoneRefer_bone(){return this._bone}function FE3sBoneRefer_setBone(b){this._bone=b}function FE3sBoneRefer_track(){return this._track}
function FE3sBoneRefer_setTrack(b){this._track=b}function FE3sBoneRefer_unserialize(b){this._index=b.readUint8()}function FE3sCamera(b){b=RClass.inherits(this,b,FE3sObject);b._typeCd=null;b._position=null;b._direction=null;b._projection=null;b.construct=FE3sCamera_construct;b.typeCd=FE3sCamera_typeCd;b.position=FE3sCamera_position;b.direction=FE3sCamera_direction;b.projection=FE3sCamera_projection;b.unserialize=FE3sCamera_unserialize;b.saveConfig=FE3sCamera_saveConfig;return b}
function FE3sCamera_construct(){this.__base.FE3sObject.construct.call(this);this._position=new SPoint3;this._direction=new SVector3;this._projection=RClass.create(FE3sProjection)}function FE3sCamera_typeCd(){return this._typeCd}function FE3sCamera_position(){return this._position}function FE3sCamera_direction(){return this._direction}function FE3sCamera_projection(){return this._projection}
function FE3sCamera_unserialize(b){this.__base.FE3sObject.unserialize.call(this,b);this._typeCd=b.readString();this._position.unserialize(b);this._direction.unserialize(b);this._projection.unserialize(b)}function FE3sCamera_saveConfig(b){this.__base.FE3sObject.saveConfig.call(this,b);b.set("position",this._position.toString());b.set("direction",this._direction.toString());this._projection.saveConfig(b.create("Projection"))}function FE3sComponent(b){return b=RClass.inherits(this,b,FE3sObject)}
function FE3sDisplay(b){b=RClass.inherits(this,b,FE3sDrawable);b._outline=null;b._renderables=null;b.construct=FE3sDisplay_construct;b.renderables=FE3sDisplay_renderables;b.calculateOutline=FE3sDisplay_calculateOutline;b.unserialize=FE3sDisplay_unserialize;b.saveConfig=FE3sDisplay_saveConfig;b.clone=FE3sDisplay_clone;return b}function FE3sDisplay_construct(){this.__base.FE3sDrawable.construct.call(this);this._outline=new SOutline3d}function FE3sDisplay_renderables(){return this._renderables}
function FE3sDisplay_calculateOutline(){var b=this._outline;if(b.isEmpty()){var d=this._renderables;if(d){b.setMin();for(var f=d.count(),h=0;h<f;h++){var q=d.getAt(h).calculateOutline();b.mergeMax(q)}b.update()}}return b}function FE3sDisplay_unserialize(b){this.__base.FE3sDrawable.unserialize.call(this,b);var d=RConsole.find(FE3sResourceConsole),f=b.readUint16();if(0<f)for(var h=this._renderables=new TObjects,q=0;q<f;q++){var z=d.unserialize(b);h.push(z)}}
function FE3sDisplay_saveConfig(b){this.__base.FE3sDrawable.saveConfig.call(this,b);var d=this._renderables;if(d){b=b.create("RenderableCollection");for(var f=d.count(),h=0;h<f;h++)d.at(h).saveConfig(b.create("Renderable"))}}function FE3sDisplay_clone(b){b=this.__base.FE3sDrawable.clone.call(this,b);b._outline.assign(this._outline);return b}
function FE3sDisplayContainer(b){b=RClass.inherits(this,b,FE3sDisplay);b._displays=null;b.construct=FE3sDisplayContainer_construct;b.displays=FE3sDisplayContainer_displays;b.pushDisplay=FE3sDisplayContainer_pushDisplay;b.calculateOutline=FE3sDisplayContainer_calculateOutline;b.unserialize=FE3sDisplayContainer_unserialize;b.saveConfig=FE3sDisplayContainer_saveConfig;b.clone=FE3sDisplayContainer_clone;return b}function FE3sDisplayContainer_construct(){this.__base.FE3sDisplay.construct.call(this)}
function FE3sDisplayContainer_displays(){return this._displays}function FE3sDisplayContainer_pushDisplay(b){var d=this._displays;d||(d=this._displays=new TObjects);b.setParent(this);d.push(b)}function FE3sDisplayContainer_calculateOutline(){var b=this._outline;if(b.isEmpty()){var d=this._renderables;if(d){b.setMin();for(var f=d.count(),h=0;h<f;h++){var q=d.getAt(h).calculateOutline();b.mergeMax(q)}b.update()}}return b}
function FE3sDisplayContainer_unserialize(b){this.__base.FE3sDisplay.unserialize.call(this,b);var d=b.readUint16();if(0<d){this._displays=new TObjects;for(var f=0;f<d;f++){var h=RClass.create(FE3sSceneDisplay);h.unserialize(b);this.pushDisplay(h)}}}function FE3sDisplayContainer_saveConfig(b){this.__base.FE3sDisplay.saveConfig.call(this,b);var d=this._displays;if(d){b=b.create("DisplayCollection");for(var f=d.count(),h=0;h<f;h++)d.at(h).saveConfig(b.create("Display"))}}
function FE3sDisplayContainer_clone(b){return this.__base.FE3sDisplay.clone.call(this,b)}function FE3sDisplayLayer(b){b=RClass.inherits(this,b,FE3sDisplayContainer);b._typeCd=null;b._transformCd=null;b.typeCd=FE3sDisplayLayer_typeCd;b.setTypeCd=FE3sDisplayLayer_setTypeCd;b.transformCd=FE3sDisplayLayer_transformCd;b.setTransformCd=FE3sDisplayLayer_setTransformCd;b.unserialize=FE3sDisplayLayer_unserialize;b.saveConfig=FE3sDisplayLayer_saveConfig;return b}
function FE3sDisplayLayer_typeCd(){return this._typeCd}function FE3sDisplayLayer_setTypeCd(b){this._typeCd=b}function FE3sDisplayLayer_transformCd(){return this._transformCd}function FE3sDisplayLayer_setTransformCd(b){this._transformCd=b}function FE3sDisplayLayer_unserialize(b){this.__base.FE3sDisplayContainer.unserialize.call(this,b);this._typeCd=b.readString();this._transformCd=b.readString()}
function FE3sDisplayLayer_saveConfig(b){this.__base.FE3sDisplayContainer.saveConfig.call(this,b);b.set("type_cd",this._typeCd);b.set("transform_cd",this._transformCd)}function FE3sDisplayMaterial(b){b=RClass.inherits(this,b,FObject);b._groupGuid=null;b._material=null;b.groupGuid=FE3sDisplayMaterial_groupGuid;b.material=FE3sDisplayMaterial_material;b.unserialize=FE3sDisplayMaterial_unserialize;return b}function FE3sDisplayMaterial_groupGuid(){return this._groupGuid}
function FE3sDisplayMaterial_material(){return this._material}function FE3sDisplayMaterial_unserialize(b){this._groupGuid=b.readString();this._material=this._template._activeTheme.findMaterial(this._groupGuid)}function FE3sDrawable(b){b=RClass.inherits(this,b,FE3sComponent);b._matrix=null;b.construct=FE3sDrawable_construct;b.matrix=FE3sDrawable_matrix;b.unserialize=FE3sDrawable_unserialize;b.saveConfig=FE3sDrawable_saveConfig;b.clone=FE3sDrawable_clone;return b}
function FE3sDrawable_construct(){this.__base.FE3sComponent.construct.call(this);this._matrix=new SMatrix3d}function FE3sDrawable_matrix(){return this._matrix}function FE3sDrawable_unserialize(b){this.__base.FE3sComponent.unserialize.call(this,b);this._matrix.unserialize(b)}function FE3sDrawable_saveConfig(b){this.__base.FE3sComponent.saveConfig.call(this,b);this._matrix.saveConfig(b.create("Matrix"))}
function FE3sDrawable_clone(b){b=this.__base.FE3sComponent.clone.call(this,b);b._matrix.assign(this._matrix);return b}function FE3sFrame(b){b=RClass.inherits(this,b,FObject);b._translation=null;b._quaternion=null;b._scale=null;b.translation=FE3sFrame_translation;b.quaternion=FE3sFrame_quaternion;b.scale=FE3sFrame_scale;return b}function FE3sFrame_tick(){return this._tick}function FE3sFrame_translation(){return this._translation}function FE3sFrame_quaternion(){return this._quaternion}
function FE3sFrame_scale(){return this._scale}function FE3sGeometry(b){b=RClass.inherits(this,b,FE3sRenderable,ME3sGeometry);b.construct=FE3sGeometry_construct;b.unserialize=FE3sGeometry_unserialize;b.dispose=FE3sGeometry_dispose;return b}function FE3sGeometry_construct(){this.__base.FE3sRenderable.construct.call(this);this.__base.ME3sGeometry.construct.call(this)}
function FE3sGeometry_unserialize(b){this.__base.FE3sRenderable.unserialize.call(this,b);var d=this._outline;d.unserialize(b);var f=b.readInt8();if(0<f)for(var h=this._streams=new TObjects,q=0;q<f;q++){var z=RClass.create(FE3sStream);z.unserialize(b);h.push(z)}d.isEmpty()&&this.calculateOutline();d.update()}function FE3sGeometry_dispose(){this.__base.ME3sGeometry.dispose.call(this);this.__base.FE3sRenderable.dispose.call(this)}
function FE3sLight(b){b=RClass.inherits(this,b,FE3sObject);b._typeName=null;b._material=null;b._camera=null;b.construct=FE3sLight_construct;b.typeName=FE3sLight_typeName;b.material=FE3sLight_material;b.camera=FE3sLight_camera;b.unserialize=FE3sLight_unserialize;return b}function FE3sLight_construct(){this.__base.FE3sObject.construct.call(this);this._material=RClass.create(FE3sMaterial);this._camera=RClass.create(FE3sCamera)}function FE3sLight_typeName(){return this._typeName}
function FE3sLight_material(){return this._material}function FE3sLight_camera(){return this._camera}function FE3sLight_unserialize(b){this.__base.FE3sObject.unserialize.call(this,b);this._typeName=b.readString();this._material.unserialize(b);this._camera.unserialize(b)}
function FE3sMaterial(b){b=RClass.inherits(this,b,FE3sObject);b._parentGuid=null;b._info=null;b._bitmaps=null;b._bitmapPacks=null;b.construct=FE3sMaterial_construct;b.parentGuid=FE3sMaterial_parentGuid;b.effectCode=FE3sMaterial_effectCode;b.info=FE3sMaterial_info;b.bitmaps=FE3sMaterial_bitmaps;b.bitmapPacks=FE3sMaterial_bitmapPacks;b.unserialize=FE3sMaterial_unserialize;b.saveConfig=FE3sMaterial_saveConfig;b.clone=FE3sMaterial_clone;return b}
function FE3sMaterial_construct(){this.__base.FE3sObject.construct.call(this);this._info=new SE3sMaterialInfo}function FE3sMaterial_parentGuid(){return this._parentGuid}function FE3sMaterial_effectCode(){return this._info.effectCode}function FE3sMaterial_info(){return this._info}function FE3sMaterial_bitmaps(){return this._bitmaps}function FE3sMaterial_bitmapPacks(){return this._bitmapPacks}
function FE3sMaterial_unserialize(b){this.__base.FE3sObject.unserialize.call(this,b);this._parentGuid=b.readString();this._info.unserialize(b);var d=b.readInt16();if(0<d)for(var f=this._bitmapPacks=new TDictionary,h=0;h<d;h++){var q=RClass.create(FE3sMaterialBitmapPack);q.unserialize(b);f.set(q.guid(),q)}d=b.readInt16();if(0<d)for(q=this._bitmaps=new TObjects,h=0;h<d;h++){var z=RClass.create(FE3sMaterialBitmap);z.unserialize(b);q.push(z);var A=f.get(z.bitmapPackGuid());z.setBitmapPack(A)}}
function FE3sMaterial_saveConfig(b){this.__base.FE3sObject.saveConfig.call(this,b);b.set("parent_guid",this._parentGuid);this._info.saveConfig(b)}function FE3sMaterial_clone(b){b=this.__base.FE3sObject.clone.call(this,b);b._parentGuid=this._parentGuid;b._info.assign(this._info);return b}
function FE3sMaterialBitmap(b){b=RClass.inherits(this,b,FE3sObject);b._bitmapPackGuid=null;b._bitmapPack=null;b._bitmapGuid=null;b._index=0;b.bitmapPackGuid=FE3sMaterialBitmap_bitmapPackGuid;b.bitmapPack=FE3sMaterialBitmap_bitmapPack;b.setBitmapPack=FE3sMaterialBitmap_setBitmapPack;b.bitmapGuid=FE3sMaterialBitmap_bitmapGuid;b.unserialize=FE3sMaterialBitmap_unserialize;return b}function FE3sMaterialBitmap_bitmapPackGuid(){return this._bitmapPackGuid}
function FE3sMaterialBitmap_bitmapPack(){return this._bitmapPack}function FE3sMaterialBitmap_setBitmapPack(b){this._bitmapPack=b}function FE3sMaterialBitmap_bitmapGuid(){return this._bitmapGuid}function FE3sMaterialBitmap_unserialize(b){this.__base.FE3sObject.unserialize.call(this,b);this._bitmapPackGuid=b.readString();this._bitmapGuid=b.readString();this._index=b.readUint16()}
function FE3sMaterialBitmapPack(b){b=RClass.inherits(this,b,FE3sObject);b._typeName=null;b._formatName=null;b._size=null;b.construct=FE3sMaterialBitmapPack_construct;b.typeName=FE3sMaterialBitmapPack_typeName;b.formatName=FE3sMaterialBitmapPack_formatName;b.size=FE3sMaterialBitmapPack_size;b.unserialize=FE3sMaterialBitmapPack_unserialize;b.dispose=FE3sMaterialBitmapPack_dispose;return b}function FE3sMaterialBitmapPack_construct(){this.__base.FE3sObject.construct.call(this);this._size=new SSize2}
function FE3sMaterialBitmapPack_typeName(){return this._typeName}function FE3sMaterialBitmapPack_formatName(){return this._formatName}function FE3sMaterialBitmapPack_size(){return this._size}function FE3sMaterialBitmapPack_unserialize(b){this.__base.FE3sObject.unserialize.call(this,b);this._typeName=b.readString();this._formatName=b.readString();this._size.unserialize(b,EDataType.Uint16)}
function FE3sMaterialBitmapPack_dispose(){this._size=RObject.dispose(this._size);this.__base.FE3sObject.dispose.call(this)}function FE3sMaterialConsole(b){b=RClass.inherits(this,b,FConsole);b._resources=null;b._materials=null;b.construct=FE3sMaterialConsole_construct;b.find=FE3sMaterialConsole_find;b.unserialize=FE3sMaterialConsole_unserialize;b.loadByGuid=FE3sMaterialConsole_loadByGuid;b.dispose=FE3sMaterialConsole_dispose;return b}
function FE3sMaterialConsole_construct(){this.__base.FConsole.construct.call(this);this._resources=new TDictionary;this._materials=new TDictionary}function FE3sMaterialConsole_find(b){return this._materials.get(b)}function FE3sMaterialConsole_unserialize(b){var d=RClass.create(FE3sMaterial);d.unserialize(b);b=d.guid();if(this._materials.contains(b))throw new TError(this,"Material is already exists.");this._materials.set(b,d);return d}
function FE3sMaterialConsole_loadByGuid(b){var d=this._resources,f=d.get(b);if(f)return f;var h=RConsole.find(FE3sVendorConsole).find("material");h.set("guid",b);var q=h.makeUrl(),f=RClass.create(FE3sMaterialResource);f.setGuid(b);f.setVendor(h);f.setSourceUrl(q);RConsole.find(FResourceConsole).load(f);d.set(b,f);return f}function FE3sMaterialConsole_dispose(){this._resources=RObject.free(this._resources);this._materials=RObject.free(this._materials);this.__base.FConsole.dispose.call(this)}
function FE3sMaterialRefer(b){return b=RClass.inherits(this,b,FE3sObject)}function FE3sMaterialResource(b){b=RClass.inherits(this,b,FE3sResource);b._typeName="Material";b._dataCompress=!0;b._material=null;b.material=FE3sMaterialResource_material;b.unserialize=FE3sMaterialResource_unserialize;return b}function FE3sMaterialResource_material(){return this._material}
function FE3sMaterialResource_unserialize(b){this.__base.FE3sResource.unserialize.call(this,b);this._material=RConsole.find(FE3sMaterialConsole).unserialize(b);RLogger.info(this,"Unserialize material success. (guid={1}, code={2})",this._guid,this._code)}
function FE3sMesh(b){b=RClass.inherits(this,b,FE3sSpace,ME3sGeometry);b._dataCompress=!0;b._typeName="Mesh";b._display=null;b._renderable=null;b.construct=FE3sMesh_construct;b.unserialize=FE3sMesh_unserialize;b.saveConfig=FE3sMesh_saveConfig;b.dispose=FE3sMesh_dispose;return b}function FE3sMesh_construct(){this.__base.FE3sSpace.construct.call(this);this.__base.ME3sGeometry.construct.call(this);this._display=RClass.create(FE3sMeshDisplay)}
function FE3sMesh_unserialize(b){this.__base.FE3sSpace.unserialize.call(this,b);this._outline.unserialize(b);this._outline.update();var d=b.readInt8();if(0<d)for(var f=this._streams=new TObjects,h=0;h<d;h++){var q=RClass.create(FE3sStream);q.unserialize(b);f.push(q)}this._display.unserialize(b);this._renderable=this._display._renderable}function FE3sMesh_saveConfig(b){this.__base.FE3sSpace.saveConfig.call(this,b);this._display.saveConfig(b.create("Display"))}
function FE3sMesh_dispose(){this._outline=RObject.dispose(this._outline);this._display=RObject.dispose(this._display);this.__base.ME3sGeometry.dispose.call(this);this.__base.FE3sSpace.dispose.call(this)}
function FE3sMeshConsole(b){b=RClass.inherits(this,b,FConsole);b._venderCode="mesh";b._serviceUrl="/cloud.content.mesh.ws";b._dataUrl="/cloud.content.mesh.wv";b._meshs=null;b.construct=FE3sMeshConsole_construct;b.find=FE3sMeshConsole_find;b.meshs=FE3sMeshConsole_meshs;b.loadByGuid=FE3sMeshConsole_loadByGuid;b.loadByCode=FE3sMeshConsole_loadByCode;b.dispose=FE3sMeshConsole_dispose;return b}function FE3sMeshConsole_construct(){this.__base.FConsole.construct.call(this);this._meshs=new TDictionary}
function FE3sMeshConsole_find(b){return this._meshs.get(b)}function FE3sMeshConsole_meshs(){return this._meshs}function FE3sMeshConsole_loadByGuid(b){var d=this._meshs,f=d.get(b);if(f)return f;var h=RConsole.find(FE3sVendorConsole).find(this._venderCode);h.set("guid",b);var q=h.makeUrl(),f=RClass.create(FE3sMesh);f.setGuid(b);f.setVendor(h);f.setSourceUrl(q);RConsole.find(FResourceConsole).load(f);d.set(b,f);return f}
function FE3sMeshConsole_loadByCode(b){var d=this._meshs,f=d.get(b);if(f)return f;var h=RConsole.find(FE3sVendorConsole).find(this._venderCode);h.set("code",b);var q=h.makeUrl(),f=RClass.create(FE3sMesh);f.setGuid(b);f.setVendor(h);f.setSourceUrl(q);RConsole.find(FResourceConsole).load(f);d.set(b,f);return f}function FE3sMeshConsole_dispose(){this._meshs=RObject.free(this._meshs);this.__base.FConsole.dispose.call(this)}
function FE3sMeshDisplay(b){b=RClass.inherits(this,b,FE3sObject);b._matrix=null;b._material=null;b._renderable=null;b.construct=FE3sMeshDisplay_construct;b.matrix=FE3sMeshDisplay_matrix;b.material=FE3sMeshDisplay_material;b.renderable=FE3sMeshDisplay_renderable;b.unserialize=FE3sMeshDisplay_unserialize;b.saveConfig=FE3sMeshDisplay_saveConfig;return b}
function FE3sMeshDisplay_construct(){this.__base.FE3sObject.construct.call(this);this._matrix=new SMatrix3d;this._material=RClass.create(FE3sMaterial);this._renderable=RClass.create(FE3sRenderable)}function FE3sMeshDisplay_matrix(){return this._matrix}function FE3sMeshDisplay_material(){return this._material}function FE3sMeshDisplay_renderable(){return this._renderable}
function FE3sMeshDisplay_unserialize(b){this.__base.FE3sObject.unserialize.call(this,b);this._matrix.unserialize(b);this._material.unserialize(b);this._renderable.unserialize(b)}function FE3sMeshDisplay_saveConfig(b){this.__base.FE3sObject.saveConfig.call(this,b);this._matrix.saveConfig(b.create("Matrix"));this._material.saveConfig(b.create("Material"));this._renderable.saveConfig(b.create("Renderable"))}
function FE3sModel(b){b=RClass.inherits(this,b,FE3sSpace);b._typeName="Model";b._dataCompress=!0;b._dataBlock=!0;b._meshes=null;b._skeletons=null;b._animations=null;b._display=null;b.construct=FE3sModel_construct;b.findMeshByCode=FE3sModel_findMeshByCode;b.meshes=FE3sModel_meshes;b.skeletons=FE3sModel_skeletons;b.animations=FE3sModel_animations;b.display=FE3sModel_display;b.unserialize=FE3sModel_unserialize;b.saveConfig=FE3sModel_saveConfig;return b}
function FE3sModel_construct(){this.__base.FE3sSpace.construct.call(this);(this._display=RClass.create(FE3sModelDisplay))._model=this}function FE3sModel_findMeshByCode(b){for(var d=this._meshes,f=d.count()-1;0<=f;f--){var h=d.getAt(f);if(h._code==b)return h}return null}function FE3sModel_meshes(){return this._meshes}function FE3sModel_skeletons(){return this._skeletons}function FE3sModel_animations(){return this._animations}function FE3sModel_display(){return this._display}
function FE3sModel_unserialize(b){this.__base.FE3sSpace.unserialize.call(this,b);var d=RConsole.find(FE3sModelConsole);d.models().set(this.guid(),this);var f=b.readInt16();if(0<f)for(var h=this._meshes=new TDictionary,q=0;q<f;q++){var z=d.unserialMesh(b),A=z.guid();h.set(A,z)}z=b.readInt16();if(0<z)for(A=this._skeletons=new TObjects,q=0;q<z;q++)f=d.unserialSkeleton(b),A.push(f);z=b.readInt16();if(0<z)for(A=this._animations=new TObjects,q=0;q<z;q++)f=d.unserialAnimation(this,b),A.push(f);q=this._display;
q.unserialize(b);if(b=q.renderables())for(d=b.count(),q=0;q<d;q++)f=b.get(q),A=f.meshGuid(),z=h.get(A),f.setMesh(z);RLogger.info(this,"Unserialize model success. (guid={1}, code={2})",this._guid,this._code)}function FE3sModel_saveConfig(b){this.__base.FE3sSpace.saveConfig.call(this,b);this._display.saveConfig(b.create("Display"))}
function FE3sModelConsole(b){b=RClass.inherits(this,b,FConsole);b._models=null;b._meshs=null;b._skeletons=null;b._animations=null;b.construct=FE3sModelConsole_construct;b.findModel=FE3sModelConsole_findModel;b.models=FE3sModelConsole_models;b.findMesh=FE3sModelConsole_findMesh;b.meshs=FE3sModelConsole_meshs;b.findSkeleton=FE3sModelConsole_findSkeleton;b.skeletons=FE3sModelConsole_skeletons;b.findAnimation=FE3sModelConsole_findAnimation;b.animations=FE3sModelConsole_animations;b.unserialMesh=FE3sModelConsole_unserialMesh;
b.unserialSkeleton=FE3sModelConsole_unserialSkeleton;b.unserialAnimation=FE3sModelConsole_unserialAnimation;b.load=FE3sModelConsole_load;b.dispose=FE3sModelConsole_dispose;return b}
function FE3sModelConsole_construct(){this.__base.FConsole.construct.call(this);this._models=new TDictionary;this._meshs=new TDictionary;this._skeletons=new TDictionary;this._animations=new TDictionary;var b=RConsole.find(FResourceConsole),d=RClass.create(FResourcePipeline),f=RClass.create(FResourceType);f.setCode("resource3d.model");f._pipeline=d;b.registerType(f)}function FE3sModelConsole_findModel(b){return this._models.get(b)}function FE3sModelConsole_models(){return this._models}
function FE3sModelConsole_findMesh(b){return this._meshs.get(b)}function FE3sModelConsole_meshs(){return this._meshs}function FE3sModelConsole_findSkeleton(b){return this._skeletons.get(b)}function FE3sModelConsole_skeletons(){return this._skeletons}function FE3sModelConsole_findAnimation(b){return this._animations.get(b)}function FE3sModelConsole_animations(){return this._animations}
function FE3sModelConsole_unserialMesh(b){var d=RClass.create(FE3sModelMesh);d.unserialize(b);this._meshs.set(d.guid(),d);return d}function FE3sModelConsole_unserialSkeleton(b){var d=RClass.create(FE3sSkeleton);d.unserialize(b);this._skeletons.set(d.guid(),d);return d}function FE3sModelConsole_unserialAnimation(b,d){var f=RClass.create(FE3sAnimation);f._model=b;f.unserialize(d);this._animations.set(f.guid(),f);return f}
function FE3sModelConsole_load(b){var d=this._models,f=d.get(b);if(f)return f;var h=RConsole.find(FE3sVendorConsole).find("model");h.set("guid",b);var q=h.makeUrl(),f=RClass.create(FE3sModel);f.setGuid(b);f.setVendor(h);f.setSourceUrl(q);RConsole.find(FResourceConsole).load(f);d.set(b,f);return f}function FE3sModelConsole_dispose(){this._materials=RObject.free(this._materials);this.__base.FConsole.dispose.call(this)}
function FE3sModelDisplay(b){b=RClass.inherits(this,b,FE3sDisplay);b._model=null;b._material=null;b.construct=FE3sModelDisplay_construct;b.material=FE3sModelDisplay_material;b.calculateOutline=FE3sModelDisplay_calculateOutline;b.unserialize=FE3sModelDisplay_unserialize;b.saveConfig=FE3sModelDisplay_saveConfig;return b}function FE3sModelDisplay_construct(){this.__base.FE3sDisplay.construct.call(this);this._material=RClass.create(FE3sMaterial)}
function FE3sModelDisplay_material(){return this._material}function FE3sModelDisplay_calculateOutline(){var b=this._outline;if(b.isEmpty()){var d=this._model.meshes();if(d){b.setMin();for(var f=d.count(),h=0;h<f;h++){var q=d.at(h).calculateOutline();b.mergeMax(q)}b.update()}}return b}function FE3sModelDisplay_unserialize(b){this.__base.FE3sDisplay.unserialize.call(this,b);this._material.unserialize(b)}
function FE3sModelDisplay_saveConfig(b){this.__base.FE3sDisplay.saveConfig.call(this,b);this._material.saveConfig(b.create("Material"))}function FE3sModelMesh(b){return b=RClass.inherits(this,b,FE3sGeometry)}
function FE3sModelRenderable(b){b=RClass.inherits(this,b,FE3sRenderable);b._meshGuid=null;b._mesh=null;b.construct=FE3sModelRenderable_construct;b.meshGuid=FE3sModelRenderable_meshGuid;b.mesh=FE3sModelRenderable_mesh;b.setMesh=FE3sModelRenderable_setMesh;b.unserialize=FE3sModelRenderable_unserialize;b.saveConfig=FE3sModelRenderable_saveConfig;return b}function FE3sModelRenderable_construct(){this.__base.FE3sRenderable.construct.call(this)}
function FE3sModelRenderable_meshGuid(){return this._meshGuid}function FE3sModelRenderable_mesh(){return this._mesh}function FE3sModelRenderable_setMesh(b){this._mesh=b}function FE3sModelRenderable_unserialize(b){this.__base.FE3sRenderable.unserialize.call(this,b);this._meshGuid=b.readString()}function FE3sModelRenderable_saveConfig(b){this.__base.FE3sRenderable.saveConfig.call(this,b);b.set("mesh_guid",this._meshGuid)}
function FE3sMovie(b){b=RClass.inherits(this,b,FE3sObject);b._interval=null;b._rotation=null;b.construct=FE3sMovie_construct;b.interval=FE3sMovie_interval;b.rotation=FE3sMovie_rotation;b.unserialize=FE3sMovie_unserialize;return b}function FE3sMovie_construct(){this.__base.FE3sObject.construct.call(this);this._rotation=new SVector3}function FE3sMovie_interval(){return this._interval}function FE3sMovie_rotation(){return this._rotation}
function FE3sMovie_unserialize(b){this.__base.FE3sObject.unserialize.call(this,b);this._interval=b.readInt32();this._rotation.unserialize(b)}function FE3sObject(b){b=RClass.inherits(this,b,FObject,MAttributeParent,MAttributeGuid,MAttributeCode,MAttributeLabel);b._typeName=null;b._isClone=!1;b.makeLabel=FE3sObject_makeLabel;b.unserialize=FE3sObject_unserialize;b.saveConfig=FE3sObject_saveConfig;b.clone=FE3sObject_clone;b.dispose=FE3sObject_dispose;return b}
function FE3sObject_makeLabel(){var b="";RString.isEmpty(this._code)||(b+=this._code);RString.isEmpty(this._label)||(b+=" ["+this._label+"]");return b}function FE3sObject_unserialize(b){this._typeName=b.readString();this._guid=b.readString();this._code=b.readString();this._label=b.readString()}
function FE3sObject_saveConfig(b){RString.isEmpty(this._typeName)||b.setName(this._typeName);b.set("guid",this._guid);b.set("code",this._code);b.set("label",this._label);this._isClone&&b.set("is_clone","Y")}function FE3sObject_clone(b){var d=null,d=b?b:RClass.create(this.constructor);d._isClone=!0;d._typeName=this._typeName;d._guid=this._guid;d._code=this._code;d._label=this._label;return d}
function FE3sObject_dispose(){this.__base.MAttributeParent.dispose.call(this);this.__base.FComponent.dispose.call(this)}function FE3sProjection(b){b=RClass.inherits(this,b,FE3sObject);b._angle=null;b._znear=null;b._zfar=null;b.angle=FE3sProjection_angle;b.znear=FE3sProjection_znear;b.zfar=FE3sProjection_zfar;b.unserialize=FE3sProjection_unserialize;b.saveConfig=FE3sProjection_saveConfig;return b}function FE3sProjection_angle(){return this._angle}
function FE3sProjection_znear(){return this._znear}function FE3sProjection_zfar(){return this._zfar}function FE3sProjection_unserialize(b){this.__base.FE3sObject.unserialize.call(this,b);this._angle=b.readFloat();this._znear=b.readFloat();this._zfar=b.readFloat()}function FE3sProjection_saveConfig(b){this.__base.FE3sObject.saveConfig.call(this,b);b.setFloat("angle",this._angle);b.setFloat("znear",this._znear);b.setFloat("zfar",this._zfar)}
function FE3sRegion(b){b=RClass.inherits(this,b,FE3sObject);b._optionBackground=!0;b._backgroundColor=null;b._moveSpeed=.1;b._rotationKeySpeed=.005;b._rotationMouseSpeed=.003;b._material=null;b._camera=null;b._light=null;b.construct=FE3sRegion_construct;b.optionBackground=FE3sRegion_optionBackground;b.setOptionBackground=FE3sRegion_setOptionBackground;b.backgroundColor=FE3sRegion_backgroundColor;b.moveSpeed=FE3sRegion_moveSpeed;b.setMoveSpeed=FE3sRegion_setMoveSpeed;b.rotationKeySpeed=FE3sRegion_rotationKeySpeed;
b.setRotationKeySpeed=FE3sRegion_setRotationKeySpeed;b.rotationMouseSpeed=FE3sRegion_rotationMouseSpeed;b.setRotationMouseSpeed=FE3sRegion_setRotationMouseSpeed;b.camera=FE3sRegion_camera;b.light=FE3sRegion_light;b.unserialize=FE3sRegion_unserialize;b.saveConfig=FE3sRegion_saveConfig;return b}
function FE3sRegion_construct(){this.__base.FE3sObject.construct.call(this);this._backgroundColor=new SColor4;this._material=RClass.create(FE3sMaterial);this._camera=RClass.create(FE3sCamera);this._light=RClass.create(FE3sLight)}function FE3sRegion_optionBackground(){return this._optionBackground}function FE3sRegion_setOptionBackground(b){this._optionBackground=b}function FE3sRegion_backgroundColor(){return this._backgroundColor}function FE3sRegion_moveSpeed(){return this._moveSpeed}
function FE3sRegion_setMoveSpeed(b){this._moveSpeed=b}function FE3sRegion_rotationKeySpeed(){return this._rotationKeySpeed}function FE3sRegion_setRotationKeySpeed(b){this._rotationKeySpeed=b}function FE3sRegion_rotationMouseSpeed(){return this._rotationMouseSpeed}function FE3sRegion_setRotationMouseSpeed(b){this._rotationMouseSpeed=b}function FE3sRegion_camera(){return this._camera}function FE3sRegion_light(){return this._light}
function FE3sRegion_unserialize(b){this.__base.FE3sObject.unserialize.call(this,b);this._backgroundColor.unserialize(b);this._moveSpeed=b.readFloat();this._rotationKeySpeed=b.readFloat();this._rotationMouseSpeed=b.readFloat();this._material.unserialize(b);this._camera.unserialize(b);this._light.unserialize(b)}
function FE3sRegion_saveConfig(b){this.__base.FE3sObject.saveConfig.call(this,b);b.set("color",this._backgroundColor.toString());b.setFloat("move_speed",this._moveSpeed);b.setFloat("rotation_key_speed",this._rotationKeySpeed);b.setFloat("rotation_mouse_speed",this._rotationMouseSpeed);this._camera.saveConfig(b.create("Camera"))}
function FE3sRenderable(b){b=RClass.inherits(this,b,FE3sDrawable);b._materialRefers=null;b.construct=FE3sRenderable_construct;b.materialRefers=FE3sRenderable_materialRefers;b.syncMaterialRefer=FE3sRenderable_syncMaterialRefer;b.pushMaterialRefer=FE3sRenderable_pushMaterialRefer;b.unserialize=FE3sRenderable_unserialize;b.saveConfig=FE3sRenderable_saveConfig;b.clone=FE3sRenderable_clone;return b}function FE3sRenderable_construct(){this.__base.FE3sDrawable.construct.call(this)}
function FE3sRenderable_materialRefers(){return this._materialRefers}function FE3sRenderable_syncMaterialRefer(b){var d=this._materialRefers;d||(d=this._materialRefers=new TObjects);for(var f=d.count();f<=b;f++)d.push(RClass.create(FE3sMaterialRefer));return d.at(b)}function FE3sRenderable_pushMaterialRefer(b){var d=this._materialRefers;d||(d=this._materialRefers=new TObjects);d.push(b)}
function FE3sRenderable_unserialize(b){this.__base.FE3sDrawable.unserialize.call(this,b);var d=b.readUint16();if(0<d)for(var f=0;f<d;f++){var h=RClass.create(FE3sMaterialRefer);h.unserialize(b);this.pushMaterialRefer(h)}}function FE3sRenderable_saveConfig(b){this.__base.FE3sDrawable.saveConfig.call(this,b);var d=this._materialRefers;if(d){var f=d.count();b=b.create("MaterialReferCollection");for(var h=0;h<f;h++)d.at(h).saveConfig(b.create("MaterialRefer"))}}
function FE3sRenderable_clone(b){b=this.__base.FE3sDrawable.clone.call(this,b);var d=this._materialRefers;if(d)for(var f=d.count(),h=0;h<f;h++){var q=d.at(h);b.pushMaterialRefer(q.clone())}return b}
function FE3sResource(b){b=RClass.inherits(this,b,FResource,MListenerLoad);b._dataLoad=!1;b._dataReady=!1;b._dataSize=0;b._blockSize=0;b._blockCount=0;b._vendor=null;b.onComplete=FE3sResource_onComplete;b.makeLabel=FE3sResource_makeLabel;b.vendor=FE3sResource_vendor;b.setVendor=FE3sResource_setVendor;b.testReady=FE3sResource_testReady;b.unserialize=FE3sResource_unserialize;b.saveConfig=FE3sResource_saveConfig;b.dispose=FE3sResource_dispose;return b}
function FE3sResource_onComplete(b){if(RClass.isClass(b,MDataStream))this.unserialize(b);else{var d=RClass.create(FDataView);d.setEndianCd(!0);b.constructor==Array?(b=new Uint8Array(b),d.link(b.buffer)):b.constructor==Uint8Array?d.link(b.buffer):d.link(b.outputData());this.unserialize(d);d.dispose()}this._dataReady=!0;this.processLoadListener()}function FE3sResource_makeLabel(){var b="";RString.isEmpty(this._code)||(b+=this._code);RString.isEmpty(this._label)||(b+=" ["+this._label+"]");return b}
function FE3sResource_vendor(){return this._vendor}function FE3sResource_setVendor(b){this._vendor=b}function FE3sResource_testReady(){return this._dataReady}function FE3sResource_unserialize(b){this._typeName=b.readString();this._guid=b.readString();this._code=b.readString();this._label=b.readString()}function FE3sResource_saveConfig(b){RString.isEmpty(this._typeName)||b.setName(this._typeName);b.set("guid",this._guid);b.set("code",this._code);b.set("label",this._label)}
function FE3sResource_dispose(){this._vendor=null;this.__base.MListenerLoad.dispose.call(this);this.__base.FConsole.dispose.call(this)}function FE3sResourceConsole(b){b=RClass.inherits(this,b,FConsole);b._factory=null;b.construct=FE3sResourceConsole_construct;b.factory=FE3sResourceConsole_factory;b.create=FE3sResourceConsole_create;b.unserializeResource=FE3sResourceConsole_unserializeResource;b.unserialize=FE3sResourceConsole_unserialize;return b}
function FE3sResourceConsole_construct(){this.__base.FConsole.construct.call(this);var b=this._factory=RClass.create(FClassFactory);b.register("Shape",FE3sShape);b.register("Sprite",FE3sSprite);b.register("ModelMesh",FE3sModelMesh);b.register("ModelRenderable",FE3sModelRenderable)}function FE3sResourceConsole_factory(){return this._factory}function FE3sResourceConsole_create(b){return this._factory.create(b)}function FE3sResourceConsole_unserializeResource(b,d){b.unserialize(d)}
function FE3sResourceConsole_unserialize(b){var d=b.testString(),d=this._factory.create(d);d.unserialize(b);return d}function FE3sScene(b){b=RClass.inherits(this,b,FE3sSpace);b._typeName="Scene";b._dataCompress=!0;b._templates=null;b.construct=FE3sScene_construct;b.unserialize=FE3sScene_unserialize;b.saveConfig=FE3sScene_saveConfig;return b}function FE3sScene_construct(){this.__base.FE3sSpace.construct.call(this)}
function FE3sScene_unserialize(b){this.__base.FE3sSpace.unserialize.call(this,b);b=b.readInt16();if(0<b)for(var d=RConsole.find(FE3sTemplateConsole),f=this._templates=new TDictionary,h=0;h<b;h++){var q=d.unserialize(p);f.set(ttemplate.guid(),q)}}function FE3sScene_saveConfig(b){this.__base.FE3sSpace.saveConfig.call(this,b)}
function FE3sSceneAnimation(b){b=RClass.inherits(this,b,FE3sObject);b._playRate=1;b.construct=FE3sSceneAnimation_construct;b.playRate=FE3sSceneAnimation_playRate;b.setPlayRate=FE3sSceneAnimation_setPlayRate;b.unserialize=FE3sSceneAnimation_unserialize;b.saveConfig=FE3sSceneAnimation_saveConfig;return b}function FE3sSceneAnimation_construct(){this.__base.FE3sObject.construct.call(this)}function FE3sSceneAnimation_playRate(){return this._playRate}
function FE3sSceneAnimation_setPlayRate(b){this._playRate=b}function FE3sSceneAnimation_unserialize(b){this.__base.FE3sObject.unserialize.call(this,b);this._playRate=b.readFloat()}function FE3sSceneAnimation_saveConfig(b){this.__base.FE3sObject.saveConfig.call(this,b);b.set("play_rate",this._playRate)}
function FE3sSceneConsole(b){b=RClass.inherits(this,b,FConsole);b._vendorCode="scene";b._dataUrl="/cloud.content.scene.wv";b._scenes=null;b.construct=FE3sSceneConsole_construct;b.loadByGuid=FE3sSceneConsole_loadByGuid;b.loadByCode=FE3sSceneConsole_loadByCode;return b}function FE3sSceneConsole_construct(){this.__base.FConsole.construct.call(this);this._scenes=new TDictionary}
function FE3sSceneConsole_loadByGuid(b){var d=this._scenes,f=d.get(b);if(f)return f;var h=RConsole.find(FE3sVendorConsole).find(this._vendorCode);h.set("guid",b);var q=h.makeUrl(),f=RClass.create(FE3sScene);f.setGuid(b);f.setVendor(h);f.setSourceUrl(q);RConsole.find(FResourceConsole).load(f);d.set(b,f);return f}
function FE3sSceneConsole_loadByCode(b){var d=this._scenes,f=d.get(b);if(f)return f;var h=RConsole.find(FE3sVendorConsole).find(this._vendorCode);h.set("code",b);var q=h.makeUrl(),f=RClass.create(FE3sScene);f.setCode(b);f.setVendor(h);f.setSourceUrl(q);RConsole.find(FResourceConsole).load(f);d.set(b,f);return f}
function FE3sSceneDisplay(b){b=RClass.inherits(this,b,FE3sSprite);b._templateGuid=null;b._animations=null;b._movies=null;b._renderables=null;b.construct=FE3sSceneDisplay_construct;b.templateGuid=FE3sSceneDisplay_templateGuid;b.findAnimation=FE3sSceneDisplay_findAnimation;b.syncAnimation=FE3sSceneDisplay_syncAnimation;b.animations=FE3sSceneDisplay_animations;b.movies=FE3sSceneDisplay_movies;b.renderables=FE3sSceneDisplay_renderables;b.unserialize=FE3sSceneDisplay_unserialize;b.saveConfig=FE3sSceneDisplay_saveConfig;
b.clone=FE3sSceneDisplay_clone;return b}function FE3sSceneDisplay_construct(){this.__base.FE3sSprite.construct.call(this)}function FE3sSceneDisplay_templateGuid(){return this._templateGuid}function FE3sSceneDisplay_findAnimation(b){var d=this._animations;return d?d.get(b):null}function FE3sSceneDisplay_syncAnimation(b){var d=this._animations;d||(d=this._animations=new TDictionary);var f=d.get(b);f||(f=RClass.create(FE3sSceneAnimation),f._guid=b,d.set(b,f));return f}
function FE3sSceneDisplay_animations(){return this._animations}function FE3sSceneDisplay_movies(){return this._movies}function FE3sSceneDisplay_renderables(){return this._renderables}
function FE3sSceneDisplay_unserialize(b){this.__base.FE3sSprite.unserialize.call(this,b);this._templateGuid=b.readString();var d=b.readUint16();if(0<d)for(var f=this._animations=new TDictionary,h=0;h<d;h++){var q=RClass.create(FE3sSceneAnimation);q.unserialize(b);f.set(q.guid(),q)}d=b.readUint16();if(0<d)for(f=this._movies=new TObjects,h=0;h<d;h++)q=RClass.create(FE3sMovie),q.unserialize(b),f.push(q)}
function FE3sSceneDisplay_saveConfig(b){this.__base.FE3sSprite.saveConfig.call(this,b);b.set("template_guid",this._templateGuid);var d=this._animations;if(d){var f=d.count();b=b.create("AnimationCollection");for(var h=0;h<f;h++)d.at(h).saveConfig(b.create("Animation"))}}function FE3sSceneDisplay_clone(b){b=this.__base.FE3sSprite.clone.call(this,b);b._templateGuid=this._templateGuid;return b}function FE3sSceneLayer(b){return b=RClass.inherits(this,b,FE3sDisplayLayer)}
function FE3sSceneRenderable(b){b=RClass.inherits(this,b,FE3sObject);b.unserialize=FE3sSceneRenderable_unserialize;return b}function FE3sSceneRenderable_unserialize(b){this.__base.FE3sObject.unserialize.call(this,b)}
function FE3sShape(b){b=RClass.inherits(this,b,FE3sRenderable);b._modelGuid=null;b._model=null;b._meshGuid=null;b._mesh=null;b._materialGuid=null;b._material=null;b.construct=FE3sShape_construct;b.modelGuid=FE3sShape_modelGuid;b.model=FE3sShape_model;b.meshGuid=FE3sShape_meshGuid;b.mesh=FE3sShape_mesh;b.materialGuid=FE3sShape_materialGuid;b.material=FE3sShape_material;b.unserialize=FE3sShape_unserialize;return b}function FE3sShape_construct(){this.__base.FE3sRenderable.construct.call(this)}
function FE3sShape_modelGuid(){return this._modelGuid}function FE3sShape_model(){var b=this._model;b||(b=this._model=RConsole.find(FE3sModelConsole).findModel(this._modelGuid));return b}function FE3sShape_meshGuid(){return this._meshGuid}function FE3sShape_mesh(){var b=this._mesh;b||(b=this._mesh=RConsole.find(FE3sModelConsole).findMesh(this._meshGuid));return b}function FE3sShape_materialGuid(){return this._materialGuid}
function FE3sShape_material(){var b=this._material;b||(b=this._material=RConsole.find(FE3sMaterialConsole).find(this._materialGuid));return b}function FE3sShape_unserialize(b){this.__base.FE3sRenderable.unserialize.call(this,b);this._modelGuid=b.readString();this._meshGuid=b.readString();this._materialGuid=b.readString()}
function FE3sSkeleton(b){b=RClass.inherits(this,b,FE3sObject);b._bones=null;b._roots=null;b._skins=null;b._animations=null;b.findBone=FE3sSkeleton_findBone;b.bones=FE3sSkeleton_bones;b.roots=FE3sSkeleton_roots;b.skins=FE3sSkeleton_skins;b.animations=FE3sSkeleton_animations;b.pushAnimation=FE3sSkeleton_pushAnimation;b.innerFilter=FE3sSkeleton_innerFilter;b.unserialize=FE3sSkeleton_unserialize;return b}function FE3sSkeleton_findBone(b){return this._bones.get(b)}
function FE3sSkeleton_bones(){return this._bones}function FE3sSkeleton_roots(){return this._roots}function FE3sSkeleton_skins(){return this._skins}function FE3sSkeleton_animations(){return this._animations}function FE3sSkeleton_pushAnimation(b){var d=this._animations;d||(d=this._animations=new TObjects);d.push(b)}function FE3sSkeleton_innerFilter(b){this._bones.set(b.index(),b);if(b=b.bones())for(var d=b.count(),f=0;f<d;f++){var h=b.get(f);this.innerFilter(h)}}
function FE3sSkeleton_unserialize(b){this.__base.FE3sObject.unserialize.call(this,b);var d=b.readUint8();if(0<d){this._bones=new TDictionary;for(var f=this._roots=new TObjects,h=0;h<d;h++){var q=RClass.create(FE3sBone);q.unserialize(b);this.innerFilter(q);f.push(q)}}d=b.readUint8();if(0<d)for(f=this._skins=new TObjects,h=0;h<d;h++)q=RClass.create(FE3sSkeletonSkin),q.unserialize(b),f.push(q)}
function FE3sSkeletonSkin(b){b=RClass.inherits(this,b,FE3sObject);b._meshGuid=null;b._streams=null;b._boneRefers=null;b.meshGuid=FE3sSkeletonSkin_meshGuid;b.find=FE3sSkeletonSkin_find;b.streams=FE3sSkeletonSkin_streams;b.boneRefers=FE3sSkeletonSkin_boneRefers;b.unserialize=FE3sSkeletonSkin_unserialize;return b}function FE3sSkeletonSkin_meshGuid(){return this._meshGuid}function FE3sSkeletonSkin_find(b){return this._streams.get(b)}function FE3sSkeletonSkin_streams(){return this._streams}
function FE3sSkeletonSkin_boneRefers(){return this._boneRefers}function FE3sSkeletonSkin_unserialize(b){this.__base.FE3sObject.unserialize.call(this,b);this._meshGuid=b.readString();var d=b.readUint8();if(0<d)for(var f=this._streams=new TObjects,h=0;h<d;h++){var q=RClass.create(FE3sStream);q.unserialize(b);f.push(q)}d=b.readUint8();if(0<d)for(f=this._boneRefers=new TObjects,h=0;h<d;h++)q=RClass.create(FE3sBoneRefer),q.unserialize(b),f.push(q)}
function FE3sSpace(b){b=RClass.inherits(this,b,FE3sResource);b._typeName=null;b._technique=null;b._region=null;b._materials=null;b._displays=null;b._layers=null;b.construct=FE3sSpace_construct;b.technique=FE3sSpace_technique;b.region=FE3sSpace_region;b.materials=FE3sSpace_materials;b.displays=FE3sSpace_displays;b.layers=FE3sSpace_layers;b.unserialize=FE3sSpace_unserialize;b.saveConfig=FE3sSpace_saveConfig;return b}
function FE3sSpace_construct(){this.__base.FE3sResource.construct.call(this);this._technique=RClass.create(FE3sTechnique);this._region=RClass.create(FE3sRegion)}function FE3sSpace_technique(){return this._technique}function FE3sSpace_region(){return this._region}function FE3sSpace_materials(){return this._materials}function FE3sSpace_displays(){return this._displays}function FE3sSpace_layers(){return this._layers}
function FE3sSpace_unserialize(b){this.__base.FE3sResource.unserialize.call(this,b);var d=RConsole.find(FE3sResourceConsole),f=RConsole.find(FE3sMaterialConsole);this._technique.unserialize(b);this._region.unserialize(b);var h=b.readInt16();if(0<h)for(var q=this._materials=new TDictionary,z=0;z<h;z++){var A=f.unserialize(b);q.set(A.guid(),A)}f=b.readInt16();if(0<f)for(h=this._displays=new TObjects,z=0;z<f;z++)q=d.unserialize(b),h.push(q);d=b.readInt16();if(0<d)for(f=this._layers=new TDictionary,z=
0;z<d;z++)h=RClass.create(FE3sDisplayLayer),h.unserialize(b),f.set(h.code(),h)}
function FE3sSpace_saveConfig(b){this.__base.FE3sResource.saveConfig.call(this,b);this._technique.saveConfig(b.create("Technique"));this._region.saveConfig(b.create("Region"));var d=this._materials;if(d)for(var f=b.create("MaterialCollection"),h=d.count(),q=0;q<h;q++)d.at(q).saveConfig(f.create("Material"));if(d=this._displays)for(f=b.create("DisplayCollection"),h=d.count(),q=0;q<h;q++)d.at(q).saveConfig(f.create("Display"));if(d=this._layers)for(b=b.create("LayerCollection"),f=d.count(),q=0;q<f;q++)d.valueAt(q).saveConfig(b.create("Layer"))}
function FE3sSprite(b){b=RClass.inherits(this,b,FE3sDisplayContainer);b._materials=null;b.construct=FE3sSprite_construct;b.materials=FE3sSprite_materials;b.pushMaterial=FE3sSprite_pushMaterial;b.unserialize=FE3sSprite_unserialize;b.saveConfig=FE3sSprite_saveConfig;b.clone=FE3sSprite_clone;return b}function FE3sSprite_construct(){this.__base.FE3sDisplayContainer.construct.call(this)}function FE3sSprite_materials(){return this._materials}
function FE3sSprite_pushMaterial(b){var d=this._materials;d||(d=this._materials=new TDictionary);d.set(b.guid(),b)}function FE3sSprite_unserialize(b){this.__base.FE3sDisplayContainer.unserialize.call(this,b);var d=b.readUint16();if(0<d)for(var f=RConsole.find(FE3sMaterialConsole),h=0;h<d;h++){var q=f.unserialize(b);this.pushMaterial(q)}}
function FE3sSprite_saveConfig(b){this.__base.FE3sDisplayContainer.saveConfig.call(this,b);var d=this._materials;if(d){var f=d.count();b=b.create("MaterialCollection");for(var h=0;h<f;h++)d.at(h).saveConfig(b.create("Material"))}}function FE3sSprite_clone(b){b=this.__base.FE3sDisplayContainer.clone.call(this,b);var d=this._materials;if(d)for(var f=d.count(),h=0;h<f;h++){var q=d.at(h);b.pushMaterial(q.clone())}return b}
function FE3sStream(b){b=RClass.inherits(this,b,FObject);b._code=null;b._elementDataCd=0;b._elementCount=0;b._elementNormalize=!1;b._dataStride=0;b._dataCount=0;b._dataLength=0;b._data=null;b._formatCd=EG3dAttributeFormat.Unknown;b.code=FE3sStream_code;b.elementDataCd=FE3sStream_elementDataCd;b.formatCd=FE3sStream_formatCd;b.dataStride=FE3sStream_dataStride;b.dataCount=FE3sStream_dataCount;b.data=FE3sStream_data;b.unserialize=FE3sStream_unserialize;b.dispose=FE3sStream_dispose;return b}
function FE3sStream_code(){return this._code}function FE3sStream_elementDataCd(){return this._elementDataCd}function FE3sStream_formatCd(){return this._formatCd}function FE3sStream_dataStride(){return this._dataStride}function FE3sStream_dataCount(){return this._dataCount}function FE3sStream_data(){return this._data}
function FE3sStream_unserialize(b){this._code=b.readString();this._elementDataCd=b.readUint8();this._elementCount=b.readUint8();this._elementNormalize=b.readBoolean();var d=this._dataStride=b.readUint8(),f=this._dataCount=b.readInt32(),d=this._dataLength=d*f,f=this._data=new ArrayBuffer(d);b.readBytes(f,0,d)}function FE3sStream_dispose(){this.data=null;this.__base.FObject.dispose.call(this)}
function FE3sTechnique(b){b=RClass.inherits(this,b,FE3sObject);b._techniqueCode=null;b._passes=null;b.passes=FE3sTechnique_passes;b.unserialize=FE3sTechnique_unserialize;b.saveConfig=FE3sTechnique_saveConfig;return b}function FE3sTechnique_passes(){return this._passes}function FE3sTechnique_unserialize(b){this.__base.FE3sObject.unserialize.call(this,b);var d=b.readInt16();if(0<d)for(var f=this._passes=new TObjects,h=0;h<d;h++){var q=RClass.create(FE3sTechniquePass);q.unserialize(b);f.push(q)}}
function FE3sTechnique_saveConfig(b){this.__base.FE3sObject.saveConfig.call(this,b);b.set("technique_code",this._techniqueCode)}function FE3sTechniquePass(b){b=RClass.inherits(this,b,FE3sObject);b._targetWidth=null;b._targetHeight=null;b.targetWidth=FE3sTechniquePass_targetWidth;b.targetHeight=FE3sTechniquePass_targetHeight;b.unserialize=FE3sTechniquePass_unserialize;return b}function FE3sTechniquePass_targetWidth(){return this._targetWidth}
function FE3sTechniquePass_targetHeight(){return this._targetHeight}function FE3sTechniquePass_unserialize(b){this.__base.FE3sObject.unserialize.call(this,b);this._targetWidth=b.readUint16();this._targetHeight=b.readUint16()}function FE3sTemplate(b){b=RClass.inherits(this,b,FE3sSpace);b._typeName="Template";b._dataCompress=!0;return b}
function FE3sTemplateConsole(b){b=RClass.inherits(this,b,FConsole);b._templates=null;b._serviceUrl="/cloud.content.template.ws";b.construct=FE3sTemplateConsole_construct;b.unserialize=FE3sTemplateConsole_unserialize;b.loadByGuid=FE3sTemplateConsole_loadByGuid;b.loadByCode=FE3sTemplateConsole_loadByCode;b.update=FE3sTemplateConsole_update;return b}function FE3sTemplateConsole_construct(){this.__base.FConsole.construct.call(this);this._templates=new TDictionary}
function FE3sTemplateConsole_unserialize(b){var d=RClass.create(FE3sTemplate);d._dataReady=!0;d.unserialize(b);this._templates.set(d.guid(),d);return d}function FE3sTemplateConsole_loadByGuid(b){var d=this._templates,f=d.get(b);if(f)return f;var h=RConsole.find(FE3sVendorConsole).find("template");h.set("guid",b);var q=h.makeUrl(),f=RClass.create(FE3sTemplate);f.setGuid(b);f.setVendor(h);f.setSourceUrl(q);RConsole.find(FResourceConsole).load(f);d.set(b,f);return f}
function FE3sTemplateConsole_loadByCode(b){var d=this._templates,f=d.get(b);if(f)return f;var h=RConsole.find(FE3sVendorConsole).find("template");h.set("code",b);var q=h.makeUrl(),f=RClass.create(FE3sTemplate);f.setCode(b);f.setVendor(h);f.setSourceUrl(q);RConsole.find(FResourceConsole).load(f);d.set(b,f);return f}function FE3sTemplateConsole_update(b){var d=RBrowser.hostPath(this._serviceUrl+"?action=update");RConsole.find(FXmlConsole).send(d,b)}
function FE3sTemplateTheme(b){b=RClass.inherits(this,b,FE3sObject);b._materials=null;b.findMaterial=FE3sTemplateTheme_findMaterial;b.materials=FE3sTemplateTheme_materials;b.unserialize=FE3sTemplateTheme_unserialize;return b}function FE3sTemplateTheme_findMaterial(b){return this._materials.get(b)}function FE3sTemplateTheme_materials(){return this._materials}
function FE3sTemplateTheme_unserialize(b){this.__base.FE3sObject.unserialize.call(this,b);var d=b.readUint16();if(0<d)for(var f=RConsole.find(FE3sMaterialConsole),h=this._materials=new TDictionary,q=0;q<d;q++){var z=f.unserialize(b);h.set(z.groupGuid(),z)}}
function FE3sTexture(b){b=RClass.inherits(this,b,FE3sResource);b._dataCompress=!0;b._bitmaps=null;b._bitmapPacks=null;b.construct=FE3sTexture_construct;b.bitmaps=FE3sTexture_bitmaps;b.bitmapPacks=FE3sTexture_bitmapPacks;b.unserialize=FE3sTexture_unserialize;b.dispose=FE3sTexture_dispose;return b}function FE3sTexture_construct(){this.__base.FE3sResource.construct.call(this)}function FE3sTexture_bitmaps(){return this._bitmaps}function FE3sTexture_bitmapPacks(){return this._bitmapPacks}
function FE3sTexture_unserialize(b){this.__base.FE3sResource.unserialize.call(this,b);var d=b.readInt16();if(0<d)for(var f=this._bitmaps=new TDictionary,h=0;h<d;h++){var q=RClass.create(FE3sTextureBitmap);q.unserialize(b);f.set(q.code(),q)}d=b.readInt16();if(0<d)for(f=this._bitmapPacks=new TDictionary,h=0;h<d;h++)q=RClass.create(FE3sTextureBitmapPack),q._texture=this,q.unserialize(b),f.set(q.code(),q)}
function FE3sTexture_dispose(){this._bitmaps=RObject.free(this._bitmaps);this._bitmapPacks=RObject.free(this._bitmapPacks);this.__base.FE3sResource.dispose.call(this)}function FE3sTextureBitmap(b){b=RClass.inherits(this,b,FE3sObject);b._packCode=null;b.packCode=FE3sTextureBitmap_packCode;b.unserialize=FE3sTextureBitmap_unserialize;return b}function FE3sTextureBitmap_packCode(){return this._packCode}
function FE3sTextureBitmap_unserialize(b){this.__base.FE3sObject.unserialize.call(this,b);this._packCode=b.readString()}
function FE3sTextureBitmapPack(b){b=RClass.inherits(this,b,FE3sObject);b._optionCompress=null;b._size=null;b._data=null;b._typeName=null;b._formatName=null;b.construct=FE3sTextureBitmapPack_construct;b.optionCompress=FE3sTextureBitmapPack_optionCompress;b.size=FE3sTextureBitmapPack_size;b.data=FE3sTextureBitmapPack_data;b.unserialize=FE3sTextureBitmapPack_unserialize;b.dispose=FE3sTextureBitmapPack_dispose;return b}
function FE3sTextureBitmapPack_construct(){this.__base.FE3sObject.construct.call(this);this._size=new SSize2}function FE3sTextureBitmapPack_optionCompress(){return this._optionCompress}function FE3sTextureBitmapPack_size(){return this._size}function FE3sTextureBitmapPack_data(){return this._data}
function FE3sTextureBitmapPack_unserialize(b){this.__base.FE3sObject.unserialize.call(this,b);this._typeName=b.readString();this._formatName=b.readString();this._size.width=b.readUint16();this._size.height=b.readUint16();if("flat"==this._typeName)var d=b.readInt32();else if("cube"==this._typeName){this._data=[];for(var f=0;6>f;f++){var d=b.readInt32(),h=this._data[f]=new ArrayBuffer(d);b.readBytes(h,0,d)}}else throw new TError(this,"Unserial texture failure ");}
function FE3sTextureBitmapPack_dispose(){this._data=null;this.__base.FE3sObject.dispose.call(this)}function FE3sTextureConsole(b){b=RClass.inherits(this,b,FConsole);b._textures=null;b.construct=FE3sTextureConsole_construct;b.unserialize=FE3sTextureConsole_unserialize;b.load=FE3sTextureConsole_load;b.loadBitmap=FE3sTextureConsole_loadBitmap;b.dispose=FE3sModelConsole_dispose;return b}function FE3sTextureConsole_construct(){this.__base.FConsole.construct.call(this);this._textures=new TDictionary}
function FE3sTextureConsole_unserialize(b){var d=RClass.create(FE3sTexture);d._dataReady=!0;d.unserialize(b);this._textures.set(d.guid(),d);return d}function FE3sTextureConsole_load(b){var d=this._textures,f=d.get(b);if(f)return f;var h=RConsole.find(FE3sVendorConsole).find("texture"),q=h.makeUrl(b),f=RClass.create(FE3sTexture);f.setGuid(b);f.setVendor(h);f.setSourceUrl(q);RConsole.find(FResourceConsole).load(f);d.set(b,f);return f}
function FE3sTextureConsole_loadBitmap(b,d,f){var h=RConsole.find(FE3sVendorConsole).find("texture.bitmap");h.set("guid",b);h.set("code",d);h.set("format",f);b=h.makeUrl();d=this._image=RClass.create(FImage);d.loadUrl(b);return d}function FE3sTextureConsole_dispose(){this._textures=RObject.free(this._textures);this.__base.FConsole.dispose.call(this)}
function FE3sTheme(b){b=RClass.inherits(this,b,FE3sResource);b._materials=null;b.materials=FE3sTheme_materials;b.find=FE3sTheme_find;b.unserialize=FE3sTheme_unserialize;return b}function FE3sTheme_materials(){return this._materials}function FE3sTheme_find(b){var d=this._materials;return d?d.get(b):null}function FE3sTheme_unserialize(b){var d=b.readInt32();if(0<d)for(var f=this._materials=new TDictionary,h=0;h<d;h++){var q=RClass.create(FE3sMaterial);q.unserialize(b);f.set(q.code(),q)}}
function FE3sThemeConsole(b){b=RClass.inherits(this,b,FConsole);b._path="/assets/theme/";b._activeTheme=null;b._themes=null;b.construct=FE3sThemeConsole_construct;b.activeTheme=FE3sThemeConsole_activeTheme;b.find=FE3sThemeConsole_find;b.select=FE3sThemeConsole_select;return b}function FE3sThemeConsole_construct(){this.__base.FConsole.construct.call(this);this._themes=new TDictionary}function FE3sThemeConsole_activeTheme(){return this._activeTheme}
function FE3sThemeConsole_find(b){var d=this._activeTheme;if(null==d)throw new TError("Active theme is empty.");return d.find(b)}function FE3sThemeConsole_select(b){var d=this._themes.get(b);if(null==d){var f=RBrowser.contentPath(this._path+b+".ser"),d=RClass.create(FE3sTheme);d.load(f);this._themes.set(b,d)}return this._activeTheme=d}
function FE3sTrack(b){b=RClass.inherits(this,b,FObject);b._meshCode=null;b._boneIndex=0;b._frameTick=0;b._matrix=null;b._matrixInvert=null;b._frameCount=null;b._frames=null;b.construct=FE3sTrack_construct;b.boneIndex=FE3sTrack_boneIndex;b.frameTick=FE3sTrack_frameTick;b.matrix=FE3sTrack_matrix;b.matrixInvert=FE3sTrack_matrixInvert;b.frames=FE3sTrack_frames;b.calculate=FE3sTrack_calculate;b.unserialize=FE3sTrack_unserialize;return b}
function FE3sTrack_construct(){this.__base.FObject.construct.call(this);this._matrix=new SMatrix3d;this._matrixInvert=new SMatrix3d}function FE3sTrack_boneIndex(){return this._boneIndex}function FE3sTrack_frameTick(){return this._frameTick}function FE3sTrack_matrix(){return this._matrix}function FE3sTrack_matrixInvert(){return this._matrixInvert}function FE3sTrack_frames(){return this._frames}
function FE3sTrack_calculate(b,d){var f=b.frameCount;if(0==f)throw new TError("Frame count is invalid.");var h=b.beginIndex,q=this._frameTick,z=parseInt(d/q)%f,A=this._frames,B=A.get(h+z),C=null,C=z<f-1?A.get(h+z+1):A.get(h);b.tick=d;b.rate=d%q/q;b.currentFrame=B;b.nextFrame=C;return!0}
function FE3sTrack_unserialize(b){this._meshCode=b.readString();this._boneIndex=b.readUint16();this._frameTick=b.readUint16();this._matrix.unserialize(b);this._matrixInvert.assign(this._matrix);this._matrixInvert.invert();this._frameCount=b.readInt16();this._frames=new TObjects}
function FE3sVendor(b){b=RClass.inherits(this,b,FObject);b._contentUrl=null;b._parameters=null;b.construct=FE3sVendor_construct;b.contentUrl=FE3sVendor_contentUrl;b.setContentUrl=FE3sVendor_setContentUrl;b.get=FE3sVendor_get;b.set=FE3sVendor_set;b.makeSource=RMethod.virtual(b,"makeSource");b.makeUrl=FE3sVendor_makeUrl;b.reset=FE3sVendor_reset;b.dispose=FE3sVendor_dispose;return b}function FE3sVendor_construct(){this.__base.FObject.construct.call(this);this._parameters=new TAttributes}
function FE3sVendor_contentUrl(b){return this._contentUrl}function FE3sVendor_setContentUrl(b){this._contentUrl=b}function FE3sVendor_get(b){return this._parameters.get(b)}function FE3sVendor_set(b,d){this._parameters.set(b,d)}function FE3sVendor_makeUrl(){var b=this.makeSource();RRuntime.isDebug()&&(b=-1==b.indexOf("?")?b+"?":b+"&",b+="date="+RDate.format());return b}function FE3sVendor_reset(){this._parameters.clear()}
function FE3sVendor_dispose(){this._parameters=RObject.dispose(this._parameters);this.__base.FObject.dispose.call(this)}function FE3sVendorConsole(b){b=RClass.inherits(this,b,FConsole);b._setuped=!1;b._vendors=null;b.construct=FE3sVendorConsole_construct;b.createVendor=FE3sVendorConsole_createVendor;b.register=FE3sVendorConsole_register;b.find=FE3sVendorConsole_find;b.setup=FE3sVendorConsole_setup;return b}
function FE3sVendorConsole_construct(){this.__base.FConsole.construct.call(this);this._vendors=new TDictionary}function FE3sVendorConsole_createVendor(b,d){var f=RClass.create(b);f.setContentUrl(d);return f}function FE3sVendorConsole_register(b,d){this._vendors.set(b,d)}function FE3sVendorConsole_find(b){this._setuped||this.setup("net");b=this._vendors.get(b);b.reset();return b}
function FE3sVendorConsole_setup(b){if("net"==b)this._vendors.set("bitmap",this.createVendor(FE3sVendorNet,RBrowser.hostPath("/cloud.resource.bitmap.wv"),"guid")),this._vendors.set("material",this.createVendor(FE3sVendorNet,RBrowser.hostPath("/cloud.resource.material.wv?do=data"),"guid")),this._vendors.set("mesh",this.createVendor(FE3sVendorNet,RBrowser.hostPath("/cloud.resource.mesh.wv"),"guid")),this._vendors.set("model",this.createVendor(FE3sVendorNet,RBrowser.hostPath("/cloud.resource.model.wv"),
"guid")),this._vendors.set("template",this.createVendor(FE3sVendorNet,RBrowser.hostPath("/cloud.resource.template.wv"),"guid")),this._vendors.set("scene",this.createVendor(FE3sVendorNet,RBrowser.hostPath("/cloud.resource.scene.wv"),"guid|code"));else if("local"==b)this._vendors.set("bitmap",this.createVendor(FE3sVendorLocal,RBrowser.contentPath("/ar3/bitmap/{guid}.bin"))),this._vendors.set("material",this.createVendor(FE3sVendorLocal,RBrowser.contentPath("/ar3/material/{guid}.bin"))),this._vendors.set("mesh",
this.createVendor(FE3sVendorLocal,RBrowser.contentPath("/ar3/mesh/{guid}.bin"))),this._vendors.set("model",this.createVendor(FE3sVendorLocal,RBrowser.contentPath("/ar3/model/{guid}.bin"))),this._vendors.set("template",this.createVendor(FE3sVendorLocal,RBrowser.contentPath("/ar3/template/{guid}.bin"))),this._vendors.set("scene",this.createVendor(FE3sVendorLocal,RBrowser.contentPath("/ar3/scene/{guid}.bin")));else throw new TError(this,"Unknown setup code. (code={1})",b);this._setuped=!0}
function FE3sVendorLocal(b){b=RClass.inherits(this,b,FE3sVendor);b.makeSource=FE3sVendorLocal_makeSource;return b}function FE3sVendorLocal_makeSource(){for(var b=this._contentUrl,d=this._parameters,f=d.count(),h=0;h<f;h++)var q=d.name(h),z=d.value(h),b=RString.replace(b,"{"+q+"}",z);return b}function FE3sVendorNet(b){b=RClass.inherits(this,b,FE3sVendor);b.makeSource=FE3sVendorNet_makeSource;return b}
function FE3sVendorNet_makeSource(){for(var b=this._contentUrl,b=-1==b.indexOf("?")?b+"?":b+"&",d=this._parameters,f=d.count(),h=!1,q=0;q<f;q++){var z=d.name(q),A=d.value(q);RString.isEmpty(A)||(h?b+="&":h=!0,b+=z+"="+A)}return b}
function SE3rPlayInfo(b){b||(b=this);b.tick=0;b.playRate=1;b.beginIndex=0;b.endIndex=0;b.frameCount=0;b.currentFrame=null;b.nextFrame=null;b.rate=1;b.alpha=1;b.translation=new SPoint3;b.quaternion=new SQuaternion;b.scale=new SVector3;b.matrix=new SMatrix3d;b.update=SE3rPlayInfo_update;return b}
function SE3rPlayInfo_update(){var b=this.currentFrame;if(!b)return!1;var d=this.nextFrame;if(!d)return!1;var f=this.matrix,h=b.translation(),q=b.quaternion(),b=b.scale(),z=this.rate;0<z&&1>z?(this.translation.slerp(h,d.translation(),z),this.quaternion.slerp(q,d.quaternion(),z),this.scale.slerp(b,d.scale(),z),f.build(this.translation,this.quaternion,this.scale)):f.build(h,q,b);return!0}
function FE3rAnimation(b){b=RClass.inherits(this,b,FObject);b._valid=!1;b._baseTick=0;b._currentTick=0;b._lastTick=0;b._playRate=1;b._tracks=null;b._resource=null;b._playInfo=null;b.construct=FE3rAnimation_construct;b.findTrack=FE3rAnimation_findTrack;b.tracks=FE3rAnimation_tracks;b.resource=FE3rAnimation_resource;b.loadResource=FE3rAnimation_loadResource;b.record=FE3rAnimation_record;b.process=RMethod.virtual(b,"process");b.dispose=FE3rAnimation_dispose;return b}
function FE3rAnimation_construct(){this.__base.FObject.construct.call(this);this._playInfo=new SE3rPlayInfo}function FE3rAnimation_findTrack(b){for(var d=this._tracks,f=d.count(),h=0;h<f;h++){var q=d.get(h);if(q.boneIndex()==b)return q}return null}function FE3rAnimation_tracks(){return this._tracks}function FE3rAnimation_resource(){return this._resource}
function FE3rAnimation_loadResource(b){var d=b.frameCount();this._resource=b;if(b=b.tracks())for(var f=this._tracks=new TObjects,h=b.count(),q=0;q<h;q++){var z=b.at(q),A=RClass.create(FE3rTrack);A._animation=this;A.loadResource(z);f.push(A)}0<d&&(b=this._playInfo,b.beginIndex=0,b.endIndex=0<d?d-1:0,b.frameCount=d,this._valid=!0)}function FE3rAnimation_record(){var b=RTimer.current();0==this._lastTick&&(this._lastTick=b);this._currentTick=(b-this._lastTick+this._baseTick)*this._playRate}
function FE3rAnimation_dispose(){this._resource=this._tracks=null;this.__base.FObject.dispose.call(this)}function FE3rBitmap(b){b=RClass.inherits(this,b,FE3rObject);b._pack=null;b.construct=FE3rBitmap_construct;b.testReady=FE3rBitmap_testReady;b.texture=FE3rBitmap_texture;b.loadResource=FE3rBitmap_loadResource;b.dispose=FE3rBitmap_dispose;return b}function FE3rBitmap_construct(){this.__base.FE3rObject.construct.call(this)}function FE3rBitmap_testReady(){return this._pack.testReady()}
function FE3rBitmap_texture(){return this._pack.texture()}function FE3rBitmap_loadResource(b){this._resource=b;this._guid=b.guid();this._code=b.code()}function FE3rBitmap_dispose(){this.__base.FE3rObject.dispose.call(this)}
function FE3rBitmapConsole(b){b=RClass.inherits(this,b,FConsole);b._scopeCd=EScope.Local;b._bitmaps=null;b._dataUrl="/cloud.resource.material.wv";b.construct=FE3rBitmapConsole_construct;b.bitmaps=FE3rBitmapConsole_bitmaps;b.load=FE3rBitmapConsole_load;b.loadUrl=FE3rBitmapConsole_loadUrl;return b}function FE3rBitmapConsole_construct(){this.__base.FConsole.construct.call(this);this._bitmaps=new TDictionary}function FE3rBitmapConsole_bitmaps(){return this._bitmaps}
function FE3rBitmapConsole_load(b,d,f){var h=d+"|"+f,q=this._bitmaps.get(h);if(q)return q;d=RBrowser.hostPath(this._dataUrl+"?guid="+d+"&code="+f);RLogger.info(this,"Load bitmap. (url={1})",d);q="environment"==f?RClass.create(FE3rBitmapCubePack):RClass.create(FE3rBitmapFlatPack);q.linkGraphicContext(b);q.loadUrl(d);this._bitmaps.set(h,q);return q}
function FE3rBitmapConsole_loadUrl(b,d){var f=this._bitmaps.get(d);if(f)return f;f=RBrowser.contentPath(d);RLogger.info(this,"Load bitmap from url. (url={1})",f);f=RClass.create(FE3rBitmap);f.linkGraphicContext(b);f.setup();f.loadUrl(d);this._bitmaps.set(d,f);return f}
function FE3rBitmapCubePack(b){b=RClass.inherits(this,b,FE3rBitmapPack);b._resource=null;b._images=null;b.onLoad=FE3rBitmapCubePack_onLoad;b.construct=FE3rBitmapCubePack_construct;b.loadUrl=FE3rBitmapCubePack_loadUrl;b.dispose=FE3rBitmapCubePack_dispose;return b}
function FE3rBitmapCubePack_onLoad(b){var d=this._graphicContext;b=this._images;for(var f=RBrowser.capability(),h=0;6>h;h++)if(!b[h].testReady())return;(this._texture=d.createCubeTexture()).upload(b[0],b[1],b[2],b[3],b[4],b[5]);if(f.blobCreate)for(h=0;6>h;h++)d=b[h],window.URL.revokeObjectURL(d.url()),b[h]=RObject.dispose(d);this._images=RObject.dispose(this._images);this._dataReady=!0}function FE3rBitmapCubePack_construct(){this.__base.FE3rBitmapPack.construct.call(this)}
function FE3rBitmapCubePack_loadUrl(b){this._images=new TObjects;for(var d=0;6>d;d++){var f=this._images[d]=RClass.create(FImage);f._index=d;f.setOptionAlpha(!1);f.loadUrl(b+"&index="+d);f.addLoadListener(this,this.onLoad)}}function FE3rBitmapCubePack_dispose(){this._images=RObject.dispose(this._images);this.__base.FE3rBitmapPack.dispose.call(this)}
function FE3rBitmapFlatPack(b){b=RClass.inherits(this,b,FE3rBitmapPack);b._resource=null;b._image=null;b.onLoad=FE3rBitmapFlatPack_onLoad;b.construct=FE3rBitmapFlatPack_construct;b.loadUrl=FE3rBitmapFlatPack_loadUrl;b.dispose=FE3rBitmapFlatPack_dispose;return b}function FE3rBitmapFlatPack_onLoad(b){b=this._texture=this._graphicContext.createFlatTexture();b.upload(this._image);b.makeMipmap();this._image=RObject.dispose(this._image);this._dataReady=!0}
function FE3rBitmapFlatPack_construct(){this.__base.FE3rBitmapPack.construct.call(this)}function FE3rBitmapFlatPack_loadUrl(b){var d=this._image=RClass.create(FImage);d.addLoadListener(this,this.onLoad);d.loadUrl(b)}function FE3rBitmapFlatPack_dispose(){this._image=RObject.dispose(this._image);this.__base.FE3rBitmapPack.dispose.call(this)}
function FE3rBitmapPack(b){b=RClass.inherits(this,b,FObject,MGraphicObject);b._resource=null;b._image=null;b._texture=null;b._ready=!1;b._dataReady=!1;b.onLoad=RMethod.virtual(b,"onLoad");b.construct=FE3rBitmapPack_construct;b.texture=FE3rBitmapPack_texture;b.testReady=FE3rBitmapPack_testReady;b.loadUrl=RMethod.virtual(b,"loadUrl");b.dispose=FE3rBitmapPack_dispose;return b}function FE3rBitmapPack_construct(){this.__base.FObject.construct.call(this)}
function FE3rBitmapPack_texture(){return this._texture}function FE3rBitmapPack_testReady(){this._dataReady&&(this._ready=this._texture.isValid());return this._ready}function FE3rBitmapPack_dispose(){this._dataReady=this._ready=!1;this.__base.FObject.dispose.call(this)}
function FE3rBone(b){b=RClass.inherits(this,b,FObject);b._matrix=null;b._boneResource=null;b._trackResource=null;b.construct=FE3rBone_construct;b.matrix=FE3rBone_matrix;b.trackResource=FE3rBone_trackResource;b.loadResource=FE3rBone_loadResource;b.update=FE3rBone_update;b.dispose=FE3rBone_dispose;return b}function FE3rBone_construct(){this.__base.FObject.construct.call(this);this._matrix=new SMatrix3d}function FE3rBone_matrix(){return this._matrix}
function FE3rBone_trackResource(){return this._trackResource}function FE3rBone_loadResource(b){this._boneResource=b;this._trackResource=b.track()}function FE3rBone_update(b,d){var f=this._trackResource;f.calculate(b,d);b.update();var h=this._matrix;h.assign(f.matrixInvert());h.append(b.matrix)}function FE3rBone_dispose(){this._trackResource=this._boneResource=null;this.__base.FG3dBone.dispose.call(this)}
function FE3rDynamicMesh(b){b=RClass.inherits(this,b,FE3dRenderable);b._model=null;b._optionMerge=!0;b._vertexPosition=0;b._vertexTotal=0;b._indexPosition=0;b._indexTotal=0;b._mergeRenderables=null;b.construct=FE3rDynamicMesh_construct;b.mergeCount=FE3rDynamicMesh_mergeCount;b.mergeMaxCount=FE3rDynamicMesh_mergeMaxCount;b.mergeRenderables=FE3rDynamicMesh_mergeRenderables;b.syncVertexBuffer=FE3rDynamicMesh_syncVertexBuffer;b.mergeRenderable=FE3rDynamicMesh_mergeRenderable;b.mergeVertexBuffer=FE3rDynamicMesh_mergeVertexBuffer;
b.mergeIndexBuffer=FE3rDynamicMesh_mergeIndexBuffer;b.build=FE3rDynamicMesh_build;return b}function FE3rDynamicMesh_construct(){this.__base.FE3dRenderable.construct.call(this);this._mergeRenderables=new TObjects}function FE3rDynamicMesh_mergeCount(){return this._mergeRenderables.count()}function FE3rDynamicMesh_mergeMaxCount(){return this._model._mergeMaxCount}function FE3rDynamicMesh_mergeRenderables(){return this._mergeRenderables}
function FE3rDynamicMesh_syncVertexBuffer(b){var d=b._resource._code,f=this._vertexBuffers.get(d);if(!f){var h=this._vertexTotal,f=this._graphicContext.createVertexBuffer();f._name=d;f._formatCd=b._formatCd;f._stride=b._stride;switch(b._formatCd){case EG3dAttributeFormat.Float2:f._data=new Float32Array(2*h);break;case EG3dAttributeFormat.Float3:f._data=new Float32Array(3*h);break;case EG3dAttributeFormat.Byte4:case EG3dAttributeFormat.Byte4Normal:f._data=new Uint8Array(4*h);break;default:throw new TError("Unknown code");
}this._vertexBuffers.set(d,f)}return f}function FE3rDynamicMesh_mergeRenderable(b){var d=this._graphicContext.capability(),f=b.vertexCount(),h=b.indexBuffer().count(),q=d.mergeCount;if(this._mergeRenderables.count()>=q)return!1;q=this._vertexTotal+f;if(d.optionIndex32){if(q>RInteger.MAX_UINT32)return!1}else if(q>RInteger.MAX_UINT16)return!1;this._vertexTotal+=f;this._indexTotal+=h;this._mergeRenderables.push(b);return!0}
function FE3rDynamicMesh_mergeVertexBuffer(b,d,f,h){b=this._vertexPosition;f=f._data;var q=h._dataCount;switch(d){case "position":d=new Float32Array(h._data);RFloat.copy(f,3*b,d,0,3*q);break;case "coord":d=new Float32Array(h._data);RFloat.copy(f,2*b,d,0,2*q);break;case "color":case "normal":case "binormal":case "tangent":case "bone_index":case "bone_weight":d=new Uint8Array(h._data);RByte.copy(f,4*b,d,0,4*q);break;default:throw new TError("Unknown code");}}
function FE3rDynamicMesh_mergeIndexBuffer(b){var d=this._vertexPosition,f=this._indexPosition,h=this._indexBuffer._data,q=new Uint16Array(b._data);b=3*b._dataCount;for(var z=0;z<b;z++)h[f++]=d+q[z]}
function FE3rDynamicMesh_build(){var b=this._graphicContext,d=b.capability(),f=this._vertexTotal,h=this._indexTotal,q=this._mergeRenderables,z=q.count(),A=q.first();this._material=A._material;this._textures=A._textures;var B=this._instanceVertexBuffer=this._graphicContext.createVertexBuffer();B._name="instance";B._stride=4;B._formatCd=EG3dAttributeFormat.Float1;A=B._data=new Float32Array(f);this._vertexBuffers.set(B._name,B);B=this._indexBuffer=b.createIndexBuffer();d.optionIndex32?(B._strideCd=EG3dIndexStride.Uint32,
B._data=new Uint32Array(h)):(B._strideCd=EG3dIndexStride.Uint16,B._data=new Uint16Array(h));B._count=h;for(b=0;b<z;b++){for(var C=q.getAt(b),d=C.vertexCount(),D=C.vertexBuffers(),E=D.count(),F=0;F<E;F++){var B=D.valueAt(F),G=B._resource,I=G._code,B=this.syncVertexBuffer(B);this.mergeVertexBuffer(C,I,B,G)}RFloat.fill(A,this._vertexPosition,d,b);B=C.indexBuffer();C=B.count();this.mergeIndexBuffer(B._resource);this._vertexPosition+=d;this._indexPosition+=C}D=this._vertexBuffers;E=D.count();for(F=0;F<
E;F++)B=D.valueAt(F),B.upload(B._data,B._stride,f),B._data=null;this._indexBuffer.upload(this._indexBuffer._data,h);this._indexBuffer._data=null}
function FE3rDynamicModel(b){b=RClass.inherits(this,b,FE3rObject);b._renderables=null;b._mergeMaxCount=0;b._meshes=null;b._updateDate=0;b.construct=FE3rDynamicModel_construct;b.createMesh=FE3rDynamicModel_createMesh;b.renderables=FE3rDynamicModel_renderables;b.meshes=FE3rDynamicModel_meshes;b.pushRenderable=FE3rDynamicModel_pushRenderable;b.build=FE3rDynamicModel_build;b.update=FE3rDynamicModel_update;return b}
function FE3rDynamicModel_construct(){this.__base.FE3rObject.construct.call(this);this._renderables=new TObjects;this._meshes=new TObjects}function FE3rDynamicModel_createMesh(){var b=RClass.create(FE3rDynamicMesh);b._model=this;b.linkGraphicContext(this);this._meshes.push(b);return b}function FE3rDynamicModel_renderables(){return this._renderables}function FE3rDynamicModel_meshes(){return this._meshes}function FE3rDynamicModel_pushRenderable(b){this._renderables.push(b)}
function FE3rDynamicModel_build(){var b=this._renderables,d=this._meshes,f=b.count();if(0<f)for(var h=this.createMesh(),q=0;q<f;q++){var z=b.getAt(q);if(!h.mergeRenderable(z)&&(h=this.createMesh(),!h.mergeRenderable(z)))throw new TError(this,"Merge renderable failure.");}b=0;f=d.count();for(q=0;q<f;q++)h=d.getAt(q),h.build(),b=Math.max(b,h.mergeCount());this._mergeMaxCount=b}function FE3rDynamicModel_update(b){this._updateDate=RTimer.current()}
function FE3rGeometry(b){b=RClass.inherits(this,b,FE3rObject);b._ready=!1;b._resource=null;b._vertexCount=0;b._vertexBuffers=null;b._indexBuffer=null;b._indexBuffers=null;b._resourceMaterial=null;b._material=null;b._textures=null;b.construct=FE3rGeometry_construct;b.testReady=FE3rGeometry_testReady;b.resource=FE3rGeometry_resource;b.setResource=FE3rGeometry_setResource;b.vertexCount=FE3rGeometry_vertexCount;b.findVertexBuffer=FE3rGeometry_findVertexBuffer;b.vertexBuffers=FE3rGeometry_vertexBuffers;
b.indexBuffer=FE3rGeometry_indexBuffer;b.indexBuffers=FE3rGeometry_indexBuffers;b.material=FE3rGeometry_material;b.findTexture=FE3rGeometry_findTexture;b.textures=FE3rGeometry_textures;b.resource=FE3rGeometry_resource;b.loadResource=FE3rGeometry_loadResource;b.processLoad=FE3rGeometry_processLoad;return b}function FE3rGeometry_construct(){this.__base.FE3rObject.construct.call(this);this._vertexBuffers=new TDictionary;this._indexBuffers=new TObjects}
function FE3rGeometry_testReady(){if(!this._ready){if(!this._resource.testReady())return!1;var b=this._textures;if(null!=b)for(var d=b.count(),f=0;f<d;f++)if(!b.value(f).testReady())return!1}return this._ready}function FE3rGeometry_guid(){return this._resource.guid()}function FE3rGeometry_resource(){return this._resource}function FE3rGeometry_setResource(b){this._resource=b}function FE3rGeometry_vertexCount(){return this._vertexCount}
function FE3rGeometry_findVertexBuffer(b){return this._vertexBuffers.get(b)}function FE3rGeometry_vertexBuffers(){return this._vertexBuffers}function FE3rGeometry_indexBuffer(){return this._indexBuffer}function FE3rGeometry_indexBuffers(){return this._indexBuffers}function FE3rGeometry_material(){return this._material}function FE3rGeometry_findTexture(b){return this._textures.get(b)}function FE3rGeometry_textures(){return this._textures}function FE3rGeometry_resource(){return this._resource}
function FE3rGeometry_loadResource(b){var d=this._graphicContext;this._resource=b;b=b.streams();for(var f=b.count(),h=0;h<f;h++){var q=b.get(h),z=q._code,A=q._dataCount,B=q._data;if("index16"==z||"index32"==z){var C=this._indexBuffer=d.createIndexBuffer();C._resource=q;q=q.elementDataCd();if(q==EDataType.Uint16)C._strideCd=EG3dIndexStride.Uint16;else if(q==EDataType.Uint32)C._strideCd=EG3dIndexStride.Uint32;else throw new TError(this,"Unknown data type.");C.upload(B,3*A);this._indexBuffers.push(C)}else{C=
d.createVertexBuffer();C._name=z;C._resource=q;C._vertexCount=A;var D=null;switch(z){case "position":D=new Float32Array(B);C._formatCd=EG3dAttributeFormat.Float3;this._vertexCount=A;break;case "coord":D=new Float32Array(B);C._formatCd=EG3dAttributeFormat.Float2;break;case "color":D=new Uint8Array(B);C._formatCd=EG3dAttributeFormat.Byte4Normal;break;case "normal":case "binormal":case "tangent":D=new Uint8Array(B);C._formatCd=EG3dAttributeFormat.Byte4Normal;break;default:throw new TError(this,"Unknown code");
}C.upload(D,q._dataStride,A);this._vertexBuffers.set(z,C)}}this._ready=!0}function FE3rGeometry_processLoad(){if(this._dataReady)return!0;if(!this._resource.testReady())return!1;this.loadResource(this._resource);return!0}function FE3rInstanceMesh(b){b=RClass.inherits(this,b,FE3rMesh);b._merges=null;b.construct=FE3rInstanceMesh_construct;b.mergeRenderable=FE3rInstanceMesh_mergeRenderable;b.build=FE3rInstanceMesh_build;return b}
function FE3rInstanceMesh_construct(){this.__base.FE3rMesh.construct.call(this);this._merges=new TObjects}function FE3rInstanceMesh_mergeRenderable(b){this._merges.push(b)}function FE3rInstanceMesh_build(){}
function FE3rMaterial(b){b=RClass.inherits(this,b,FG3dMaterial,MAttributeGuid,MGraphicObject,MLinkerResource);b._ready=!1;b._visible=!0;b._bitmaps=null;b._reference=null;b.visible=FE3rMaterial_visible;b.setVisible=FE3rMaterial_setVisible;b.findBitmap=FE3rMaterial_findBitmap;b.bitmaps=FE3rMaterial_bitmaps;b.reference=FE3rMaterial_reference;b.testReady=FE3rMaterial_testReady;b.testVisible=FE3rMaterial_testVisible;b.loadResource=FE3rMaterial_loadResource;b.reloadResource=FE3rMaterial_reloadResource;
b.load=FE3rMaterial_load;return b}function FE3rMaterial_visible(){return this._visible}function FE3rMaterial_setVisible(b){this._visible=b}function FE3rMaterial_findBitmap(b){return this._bitmaps.get(b)}function FE3rMaterial_bitmaps(){return this._bitmaps}function FE3rMaterial_reference(){return this._reference}function FE3rMaterial_testReady(){if(!this._ready){var b=this._bitmaps;if(b)for(var d=b.count(),f=0;f<d;f++)if(!b.at(f).testReady())return!1;this._ready=!0}return this._ready}
function FE3rMaterial_testVisible(){var b=this._visible;b&&this._reference&&(b=this._reference.testVisible());return b}function FE3rMaterial_loadResource(b){this._guid=b.guid();this._resource=b;this._info.calculate(b.info());this._dirty=!0}function FE3rMaterial_reloadResource(){this._info.calculate(this._resource.info());this._dirty=!0}
function FE3rMaterial_load(){var b=this._resource.bitmaps();if(b)for(var d=RConsole.find(FE3rBitmapConsole),f=this._bitmaps=new TDictionary,h=b.count(),q=0;q<h;q++){var z=b.at(q),A=z.code(),B=z.bitmapPack().code(),B=d.load(this,this._guid,B),C=RClass.create(FE3rBitmap);C._pack=B;C.loadResource(z);f.set(A,C)}}
function FE3rMaterialConsole(b){b=RClass.inherits(this,b,FConsole);b._scopeCd=EScope.Local;b._materials=null;b.construct=FE3rMaterialConsole_construct;b.load=FE3rMaterialConsole_load;return b}function FE3rMaterialConsole_construct(){this.__base.FConsole.construct.call(this);this._materials=new TDictionary}
function FE3rMaterialConsole_load(b,d){if(!b)throw new TError("Graphics context is empty");if(!d)throw new TError("Material guid is empty");var f=this._materials.get(d);if(f)return f;var h=RConsole.find(FE3sMaterialConsole).find(d),f=RClass.create(FE3rMaterial);f.linkGraphicContext(b);f.loadResource(h);f.load();this._materials.set(d,f);return f}
function FE3rMesh(b){b=RClass.inherits(this,b,FE3rObject);b._ready=!1;b._resource=null;b._vertexCount=0;b._vertexBuffers=null;b._indexBuffer=null;b._resourceMaterial=null;b._material=null;b._textures=null;b.construct=FE3rMesh_construct;b.testReady=FE3rMesh_testReady;b.resource=FE3rMesh_resource;b.setResource=FE3rMesh_setResource;b.vertexCount=FE3rMesh_vertexCount;b.findVertexBuffer=FE3rMesh_findVertexBuffer;b.vertexBuffers=FE3rMesh_vertexBuffers;b.indexBuffer=FE3rMesh_indexBuffer;b.material=FE3rMesh_material;
b.findTexture=FE3rMesh_findTexture;b.textures=FE3rMesh_textures;b.resource=FE3rMesh_resource;b.loadResource=FE3rMesh_loadResource;b.processLoad=FE3rMesh_processLoad;return b}function FE3rMesh_construct(){this.__base.FE3rObject.construct.call(this);this._vertexBuffers=new TObjects}function FE3rMesh_testReady(){if(!this._ready){if(!this._resource.testReady())return!1;var b=this._textures;if(null!=b)for(var d=b.count(),f=0;f<d;f++)if(!b.value(f).testReady())return!1}return this._ready}
function FE3rMesh_guid(){return this._resource.guid()}function FE3rMesh_resource(){return this._resource}function FE3rMesh_setResource(b){this._resource=b}function FE3rMesh_vertexCount(){return this._vertexCount}function FE3rMesh_findVertexBuffer(b){for(var d=this._vertexBuffers,f=d.count(),h=0;h<f;h++){var q=d.get(h);if(q.name()==b)return q}return null}function FE3rMesh_vertexBuffers(){return this._vertexBuffers}function FE3rMesh_indexBuffer(){return this._indexBuffer}
function FE3rMesh_material(){return this._material}function FE3rMesh_findTexture(b){return this._textures.get(b)}function FE3rMesh_textures(){return this._textures}function FE3rMesh_resource(){return this._resource}
function FE3rMesh_loadResource(b){var d=this._graphicContext;this._resource=b;b=b.streams();for(var f=b.count(),h=0;h<f;h++){var q=b.get(h),z=q._code,A=q._dataCount,B=q._data;if("index16"==z||"index32"==z){var C=this._indexBuffer=d.createIndexBuffer();C._resource=q;q=q.elementDataCd();if(q==EDataType.Uint16)C._strideCd=EG3dIndexStride.Uint16;else if(q==EDataType.Uint32)C._strideCd=EG3dIndexStride.Uint32;else throw new TError(this,"Unknown data type.");C.upload(B,3*A)}else{C=d.createVertexBuffer();
C._name=z;C._resource=q;C._vertexCount=A;var D=null;switch(z){case "position":D=new Float32Array(B);C._formatCd=EG3dAttributeFormat.Float3;break;case "coord":D=new Float32Array(B);C._formatCd=EG3dAttributeFormat.Float2;break;case "color":D=new Uint8Array(B);C._formatCd=EG3dAttributeFormat.Byte4Normal;break;case "normal":case "binormal":case "tangent":D=new Uint8Array(B);C._formatCd=EG3dAttributeFormat.Byte4Normal;break;default:throw new TError(this,"Unknown code");}C.upload(D,q._dataStride,A);this._vertexBuffers.push(C)}}this._ready=
!0}function FE3rMesh_processLoad(){if(this._dataReady)return!0;if(!this._resource.testReady())return!1;this.loadResource(this._resource);return!0}function FE3rMeshAnimation(b){b=RClass.inherits(this,b,FE3rAnimation);b.process=FE3rMeshAnimation_process;return b}function FE3rMeshAnimation_process(b){if(this._valid){var d=Math.abs(this._currentTick),f=b._resource,h=this._playInfo;f.calculate(h,d);h.update();b=b._matrix;b.assign(f.matrixInvert());b.append(h.matrix)}}
function FE3rMeshConsole(b){b=RClass.inherits(this,b,FConsole);b._scopeCd=EScope.Local;b._loadMeshs=null;b._meshs=null;b._thread=null;b._interval=200;b.onProcess=FE3rMeshConsole_onProcess;b.construct=FE3rMeshConsole_construct;b.findMesh=FE3rMeshConsole_findMesh;b.meshs=FE3rMeshConsole_meshs;b.loadByGuid=FE3rMeshConsole_loadByGuid;b.loadByCode=FE3rMeshConsole_loadByCode;return b}
function FE3rMeshConsole_onProcess(){var b=this._loadMeshs;for(b.record();b.next();)b.current().processLoad()&&b.removeCurrent()}function FE3rMeshConsole_construct(){this.__base.FConsole.construct.call(this);this._loadMeshs=new TLooper;this._meshs=new TDictionary;var b=this._thread=RClass.create(FThread);b.setInterval(this._interval);b.addProcessListener(this,this.onProcess);RConsole.find(FThreadConsole).start(b)}function FE3rMeshConsole_findMesh(b){return this._meshs.get(b)}
function FE3rMeshConsole_meshs(){return this._meshs}function FE3rMeshConsole_loadByGuid(b,d){if(!RClass.isClass(b,MGraphicObject))throw new TError("Graphics context is empty");if(RString.isEmpty(d))throw new TError("Mesh guid is empty");var f=this._meshs.get(d);if(f)return f;var h=RConsole.find(FE3sMeshConsole).loadByGuid(d),f=RClass.create(FE3rMesh);f.linkGraphicContext(b);f.setCode(d);f.setResource(h);this._meshs.set(d,f);h.testReady()?f.loadResource(h):this._loadMeshs.push(f);return f}
function FE3rMeshConsole_loadByCode(b,d){if(!RClass.isClass(b,MGraphicObject))throw new TError("Graphics context is empty");if(RString.isEmpty(d))throw new TError("Mesh code is empty");var f=this._meshs.get(d);if(f)return f;var h=RConsole.find(FE3sMeshConsole).loadByCode(d),f=RClass.create(FE3rMesh);f.linkGraphicContext(b);f.setCode(d);f.setResource(h);this._meshs.set(d,f);h.testReady()?f.loadResource(h):this._loadMeshs.push(f);return f}
function FE3rModel(b){b=RClass.inherits(this,b,FE3rObject);b._resource=null;b._meshes=null;b._skeletons=null;b._dataReady=!1;b.findMeshByGuid=FE3rModel_findMeshByGuid;b.geometrys=FE3rModel_geometrys;b.resource=FE3rModel_resource;b.setResource=FE3rModel_setResource;b.testReady=FE3rModel_testReady;b.loadResource=FE3rModel_loadResource;b.loadSkeletonResource=FE3rModel_loadSkeletonResource;b.processLoad=FE3rModel_processLoad;b.dispose=FE3rModel_dispose;return b}
function FE3rModel_findMeshByGuid(b){for(var d=this._meshes,f=d.count(),h=0;h<f;h++){var q=d.get(h);if(q._guid==b)return q}return null}function FE3rModel_geometrys(){return this._meshes}function FE3rModel_resource(){return this._resource}function FE3rModel_setResource(b){this._resource=b}function FE3rModel_testReady(){return this._dataReady}
function FE3rModel_loadSkeletonResource(b){var d=RConsole.find(FE3rModelConsole);if(b=b.skins())for(var f=b.count(),h=0;h<f;h++){var q=b.at(h),z=RClass.create(FE3rSkin);z.linkGraphicContext(this);z.loadResource(q);q=q.meshGuid();d.findMesh(q).pushSkin(z)}}
function FE3rModel_loadResource(b){var d=RConsole.find(FE3rModelConsole),f=b.meshes();if(f)for(var h=this._meshes=new TObjects,q=f.count(),z=0;z<q;z++){var A=f.valueAt(z),B=RClass.create(FE3rModelMesh);B.linkGraphicContext(this);B.loadResource(A);h.push(B);d.meshs().set(B.guid(),B)}if(b=b.skeletons())for(d=b.count(),z=0;z<d;z++)f=b.get(z),this.loadSkeletonResource(f);this._dataReady=!0}
function FE3rModel_processLoad(){if(this._dataReady)return!0;if(!this._resource.testReady())return!1;this.loadResource(this._resource);return!0}function FE3rModel_dispose(){this._ready=!1;this._resource=null;this._meshes=RObject.dispose(this._meshes);this._skeletons=RObject.dispose(this._skeletons);this.__base.FObject.dispose.call(this)}
function FE3rModelConsole(b){b=RClass.inherits(this,b,FConsole);b._scopeCd=EScope.Local;b._loadModels=null;b._models=null;b._meshs=null;b._dynamicMeshs=null;b._thread=null;b._interval=200;b.onProcess=FE3rModelConsole_onProcess;b.construct=FE3rModelConsole_construct;b.findModel=FE3rModelConsole_findModel;b.models=FE3rModelConsole_models;b.findMesh=FE3rModelConsole_findMesh;b.meshs=FE3rModelConsole_meshs;b.load=FE3rModelConsole_load;b.loadMeshByGuid=FE3rModelConsole_loadMeshByGuid;b.loadMeshByCode=
FE3rModelConsole_loadMeshByCode;b.merge=FE3rModelConsole_merge;return b}function FE3rModelConsole_onProcess(){var b=this._loadModels;for(b.record();b.next();)b.current().processLoad()&&b.removeCurrent()}
function FE3rModelConsole_construct(){this.__base.FConsole.construct.call(this);this._loadModels=new TLooper;this._models=new TDictionary;this._meshs=new TDictionary;this._dynamicMeshs=new TDictionary;var b=this._thread=RClass.create(FThread);b.setInterval(this._interval);b.addProcessListener(this,this.onProcess);RConsole.find(FThreadConsole).start(b)}function FE3rModelConsole_findModel(b){return this._models.get(b)}function FE3rModelConsole_models(){return this._models}
function FE3rModelConsole_findMesh(b){return this._meshs.get(b)}function FE3rModelConsole_meshs(){return this._meshs}function FE3rModelConsole_load(b,d){if(!b)throw new TError("Graphics context is empty");if(!d)throw new TError("Model guid is empty");var f=this._models.get(d);if(f)return f;var h=RConsole.find(FE3sModelConsole).load(d),f=RClass.create(FE3rModel);f.linkGraphicContext(b);f.setCode(d);f.setResource(h);this._models.set(d,f);this._loadModels.push(f);return f}
function FE3rModelConsole_loadMeshByGuid(b,d){if(!b)throw new TError("Graphics context is empty");if(!guid)throw new TError("Model guid is empty");var f=this._models.get(d);if(f)return f;RConsole.find(FE3sModelConsole).load(guid);f=RClass.create(FE3rModel);f.linkGraphicContext(pc);f.setCode(d);f.setResource(rm);this._models.set(d,f);rm.testReady()?f.loadResource(rm):this._loadModels.push(f);return f}
function FE3rModelConsole_loadMeshByCode(b,d){if(!RClass.isClass(b,MGraphicObject))throw new TError("Graphics context is empty");if(RString.isEmpty(d))throw new TError("Model guid is empty");var f=this._models.get(d);if(f)return f;var h=RConsole.find(FE3sModelConsole).load(guid),f=RClass.create(FE3rModel);f.linkGraphicContext(pc);f.setCode(d);f.setResource(h);this._models.set(d,f);rm.testReady()?m.loadResource(rm):this._loadModels.push(m);return m}
function FE3rModelConsole_merge(b,d,f,h){b="merge";for(var q=d.renderables(),z=0;z<h;z++){var A=q.getAt(f+z);b+="|"+A.hashCode()}var B=this._dynamicMeshs.get(b);if(!B){B=RClass.create(FE3rDynamicModel);B.linkGraphicContext(d);for(z=0;z<h;z++)A=q.getAt(f+z),B.pushRenderable(A);B.build();this._dynamicMeshs.set(b,B);RLogger.info(this,"Create merge model. (mesh={1}, renderables={2})",B.meshes().count(),B.renderables().count())}B.update();return B}
function FE3rModelMesh(b){b=RClass.inherits(this,b,FE3rGeometry);b._ready=!1;b._resourceMaterial=null;b._skins=null;b._boneIds=null;b.construct=FE3rModelMesh_construct;b.testReady=FE3rModelMesh_testReady;b.guid=FE3rModelMesh_guid;b.skins=FE3rModelMesh_skins;b.pushSkin=FE3rModelMesh_pushSkin;b.boneIds=FE3rModelMesh_boneIds;return b}function FE3rModelMesh_construct(){this.__base.FE3rGeometry.construct.call(this)}
function FE3rModelMesh_testReady(){if(!this._ready){var b=this._textures;if(null!=b)for(var d=b.count(),f=0;f<d;f++)if(!b.value(f).testReady())return!1;this._ready=!0}return this._ready}function FE3rModelMesh_guid(){return this._resource.guid()}function FE3rModelMesh_skins(){return this._skins}function FE3rModelMesh_pushSkin(b){var d=this._skins;d||(d=this._skins=new TObjects);d.push(b)}function FE3rModelMesh_boneIds(b){return this._boneIds}
function FE3rObject(b){return b=RClass.inherits(this,b,FObject,MAttributeGuid,MAttributeCode,MGraphicObject)}function FE3rPipeline(b){b=RClass.inherits(this,b,FObject);b._vertexBuffers=null;b._indexBuffer=null;b.construct=FE3rPipeline_construct;b.findVertexBuffer=FE3rPipeline_findVertexBuffer;b.loadResource=FE3rPipeline_loadResource;return b}function FE3rPipeline_construct(){this.__base.FRenderable.construct.call(this);this._vertexBuffers=new TObjects}
function FE3rPipeline_findVertexBuffer(b){for(var d=this._vertexBuffers,f=d.count(),h=0;h<f;h++){var q=d.get(h);if(q.name()==b)return q}return null}function FE3rPipeline_loadResource(b){for(var d=this._context,f=b.vertexBuffers(),h=f.count(),q=0;q<h;q++){var z=f.get(q),A=context.createVertexBuffer();A._name=z.name();A.upload(new Float32Array(z._data),z._stride,z._vertexCount);this._vertexBuffers.push(A)}b=b.indexBuffer();(this._indexBuffer=d.createIndexBuffer()).upload(b.data(),b.count())}
function FE3rSkeleton(b){b=RClass.inherits(this,b,FE3rObject);b._resource=null;b._bones=null;b._skins=null;b.resource=FE3rSkeleton_resource;b.bones=FE3rSkeleton_bones;b.skins=FE3rSkeleton_skins;b.loadResource=FE3rSkeleton_loadResource;return b}function FE3rSkeleton_resource(){return this._resource}function FE3rSkeleton_bones(){return this._bones}function FE3rSkeleton_skins(){return this._skins}
function FE3rSkeleton_loadResource(b){this._resource=b;b=b._bones;var d=b.count();if(0<d)for(var f=this._bones=new TObjects,h=0;h<d;h++){var q=b.value(h),z=RClass.create(FE3rBone);z.loadResource(q);f.push(z)}}function FE3rSkeletonAnimation(b){b=RClass.inherits(this,b,FE3rAnimation);b.process=FE3rSkeletonAnimation_process;return b}
function FE3rSkeletonAnimation_process(b){if(this._valid){var d=Math.abs(this._currentTick);b=b.bones();for(var f=b.count(),h=0;h<f;h++)b.at(h).update(this._playInfo,d)}}function FE3rSkin(b){b=RClass.inherits(this,b,FE3rObject);b._resource=null;b._streams=null;b.resource=FE3rSkin_resource;b.streams=FE3rSkin_streams;b.loadResource=FE3rSkin_loadResource;return b}function FE3rSkin_resource(){return this._resource}function FE3rSkin_streams(){return this._streams}
function FE3rSkin_loadResource(b){this._resource=b;if(b=b.streams())for(var d=this._streams=new TObjects,f=b.count(),h=0;h<f;h++){var q=RClass.create(FE3rStream);q.linkGraphicContext(this);q.loadResource(b.get(h));d.push(q)}}function FE3rStream(b){b=RClass.inherits(this,b,FE3rObject);b._buffer=null;b._resource=null;b.resource=FE3rStream_resource;b.buffer=FE3rStream_buffer;b.loadResource=FE3rStream_loadResource;return b}function FE3rStream_resource(){return this._resource}
function FE3rStream_buffer(){return this._buffer}function FE3rStream_loadResource(b){var d=b._code;this._resource=b;this._vertexCount=b._dataCount;var f=this._buffer=this._graphicContext.createVertexBuffer();f._name=d;f._resource=b;switch(d){case "bone_index":f._formatCd=EG3dAttributeFormat.Byte4;break;case "bone_weight":f._formatCd=EG3dAttributeFormat.Byte4Normal;break;default:throw new TError("Unknown code");}f.upload(b._data,b._dataStride,b._dataCount)}
function FE3rTexture(b){b=RClass.inherits(this,b,FObject,MGraphicObject);b._resource=null;b._bitmaps=null;b._bitmapPacks=null;b._ready=!1;b._dataReady=!1;b.construct=FE3rTexture_construct;b.resource=FE3rTexture_resource;b.setResource=FE3rTexture_setResource;b.bitmaps=FE3rTexture_bitmaps;b.testReady=FE3rTexture_testReady;b.loadBitmap=FE3rTexture_loadBitmap;b.loadResource=FE3rTexture_loadResource;b.load=FE3rTexture_load;b.processLoad=FE3rTexture_processLoad;b.dispose=FE3rTexture_dispose;return b}
function FE3rTexture_construct(){this.__base.FObject.construct.call(this);this._bitmaps=new TDictionary}function FE3rTexture_resource(){return this._resource}function FE3rTexture_setResource(b){this._resource=b}function FE3rTexture_bitmaps(){return this._bitmaps}function FE3rTexture_testReady(){return this._ready}function FE3rTexture_loadBitmap(b){var d=this._bitmaps,f=d.get(b);f||(f=RClass.create(FE3rTextureBitmap),d.set(b,f));return f}
function FE3rTexture_loadResource(b){if(b=b.bitmapPacks()){this._bitmapPacks=new TDictionary;for(var d=b.count(),f=0;f<d;f++){var h=b.valueAt(f),q=null;if("flat"==h._typeName)q=RClass.create(FE3rTextureBitmapFlatPack);else if("cube"==h._typeName)q=RClass.create(FE3rTextureBitmapCubePack);else throw new TError(this,"Load resource failure.");q.linkGraphicContext(this);q.loadResource(h);this._bitmapPacks.set(h.code(),q)}}this._dataReady=!0}
function FE3rTexture_load(){for(var b=this._resource.bitmaps(),d=b.count()-1;0<=d;d--){var f=b.valueAt(d),h=this.loadBitmap(f.guid()),f=this._bitmapPacks.get(f.packCode());if(!f)throw new TError("Link pack is not eists.");h.load(f)}this._ready=!0}
function FE3rTexture_processLoad(){if(this._dataReady){for(var b=this._bitmapPacks,d=b.count()-1;0<=d;d--)if(!b.valueAt(d).testReady())return!1;this.load()}else{if(!this._resource.testReady())return!1;this.loadResource(this._resource)}return this._ready}function FE3rTexture_dispose(){this._ready=!1;this._resource=null;this._bitmaps=RObject.dispose(this._bitmaps);this.__base.FObject.dispose.call(this)}
function FE3rTextureBitmap(b){b=RClass.inherits(this,b,FObject,MGraphicObject);b._ready=!1;b._bitmapPack=null;b.construct=FE3rTextureBitmap_construct;b.texture=FE3rTextureBitmap_texture;b.testReady=FE3rTextureBitmap_testReady;b.load=FE3rTextureBitmap_load;b.dispose=FE3rTextureBitmap_dispose;return b}function FE3rTextureBitmap_construct(){this.__base.FObject.construct.call(this)}function FE3rTextureBitmap_texture(){return this._bitmapPack.texture()}
function FE3rTextureBitmap_testReady(){return this._ready}function FE3rTextureBitmap_load(b){this._bitmapPack=b;this._ready=!0}function FE3rTextureBitmap_dispose(){this._context=null;this._ready=!1;this._bitmapPack=null;this.__base.FObject.dispose.call(this)}
function FE3rTextureBitmapCubePack(b){b=RClass.inherits(this,b,FE3rTextureBitmapPack);b._resource=null;b._images=null;b.onLoad=FE3rTextureBitmapCubePack_onLoad;b.construct=FE3rTextureBitmapCubePack_construct;b.loadResource=FE3rTextureBitmapCubePack_loadResource;b.dispose=FE3rTextureBitmapCubePack_dispose;return b}
function FE3rTextureBitmapCubePack_onLoad(b){var d=this._graphicContext;b=this._images;for(var f=RBrowser.capability(),h=0;6>h;h++)if(!b[h].testReady())return;(this._texture=d.createCubeTexture()).upload(b[0],b[1],b[2],b[3],b[4],b[5]);if(f.blobCreate)for(h=0;6>h;h++)d=b[h],window.URL.revokeObjectURL(d.url()),b[h]=RObject.dispose(d);this._images=RObject.dispose(this._images);this._dataReady=!0}function FE3rTextureBitmapCubePack_construct(){this.__base.FE3rTextureBitmapPack.construct.call(this)}
function FE3rTextureBitmapCubePack_loadResource(b){this._resource=b;var d=b._texture,f=RBrowser.capability(),h=b.data(),q=b._formatName;this._images=new TObjects;for(var z=0;6>z;z++){var A=this._images[z]=RClass.create(FImage);A._index=z;A.setOptionAlpha(!1);if(f.blobCreate)var B=new Blob([h[z]],{type:"image/"+q}),B=window.URL.createObjectURL(B);else B=RBrowser.hostPath("/cloud.content.texture.bitmap.wv")+"?guid="+d._guid+"&code="+b._code+"&index="+z;A.loadUrl(B);A.addLoadListener(this,this.onLoad)}}
function FE3rTextureBitmapCubePack_dispose(){this._images=RObject.dispose(this._images);this.__base.FE3rTextureBitmapPack.dispose.call(this)}function FE3rTextureBitmapFlatPack(b){b=RClass.inherits(this,b,FE3rTextureBitmapPack);b._resource=null;b._image=null;b.onLoad=FE3rTextureBitmapFlatPack_onLoad;b.construct=FE3rTextureBitmapFlatPack_construct;b.loadResource=FE3rTextureBitmapFlatPack_loadResource;b.dispose=FE3rTextureBitmapFlatPack_dispose;return b}
function FE3rTextureBitmapFlatPack_onLoad(b){b=this._texture=this._graphicContext.createFlatTexture();b.upload(this._image);b.makeMipmap();this._image=RObject.dispose(this._image);this._dataReady=!0}function FE3rTextureBitmapFlatPack_construct(){this.__base.FE3rTextureBitmapPack.construct.call(this)}
function FE3rTextureBitmapFlatPack_loadResource(b){this._resource=b;var d=b._texture,f=b.code();(this._image=RConsole.find(FE3sTextureConsole).loadBitmap(d._guid,f,b._formatName)).addLoadListener(this,this.onLoad)}function FE3rTextureBitmapFlatPack_dispose(){this._image=RObject.dispose(this._image);this.__base.FE3rTextureBitmapPack.dispose.call(this)}
function FE3rTextureBitmapPack(b){b=RClass.inherits(this,b,FObject,MGraphicObject);b._resource=null;b._image=null;b._texture=null;b._ready=!1;b._dataReady=!1;b.onLoad=RMethod.virtual(b,"onLoad");b.construct=FE3rTextureBitmapPack_construct;b.texture=FE3rTextureBitmapPack_texture;b.testReady=FE3rTextureBitmapPack_testReady;b.loadResource=RMethod.virtual(b,"loadResource");b.dispose=FE3rTextureBitmapPack_dispose;return b}
function FE3rTextureBitmapPack_construct(){this.__base.FObject.construct.call(this)}function FE3rTextureBitmapPack_texture(){return this._texture}function FE3rTextureBitmapPack_testReady(){this._dataReady&&(this._ready=this._texture.isValid());return this._ready}function FE3rTextureBitmapPack_dispose(){this._dataReady=this._ready=!1;this.__base.FObject.dispose.call(this)}
function FE3rTextureConsole(b){b=RClass.inherits(this,b,FConsole);b._scopeCd=EScope.Local;b._loadTextures=null;b._bitmaps=null;b._textures=null;b._thread=null;b._interval=200;b.onProcess=FE3rTextureConsole_onProcess;b.construct=FE3rTextureConsole_construct;b.bitmaps=FE3rTextureConsole_bitmaps;b.textures=FE3rTextureConsole_textures;b.load=FE3rTextureConsole_load;b.loadBitmap=FE3rTextureConsole_loadBitmap;return b}
function FE3rTextureConsole_onProcess(){var b=this._loadTextures;for(b.record();b.next();)b.current().processLoad()&&b.removeCurrent()}function FE3rTextureConsole_construct(){this.__base.FConsole.construct.call(this);this._loadTextures=new TLooper;this._bitmaps=new TDictionary;this._textures=new TDictionary;var b=this._thread=RClass.create(FThread);b.setInterval(this._interval);b.addProcessListener(this,this.onProcess);RConsole.find(FThreadConsole).start(b)}
function FE3rTextureConsole_bitmaps(){return this._bitmaps}function FE3rTextureConsole_textures(){return this._textures}function FE3rTextureConsole_load(b,d,f){if(b=this._textures.get(d+"|"+f))return b;d=RBrowser.hostPath(this._dataUrl+"?guid="+d+"&code="+f);RLogger.info(this,"Load bitmap. (url={1})",d);bitmap="environment"==f?RClass.create(FE3rTextureCube):RClass.create(FE3rTexture);t._name=pg;t.linkGraphicContext(pc);t.load(u);this._bitmaps.set(pg,t);return t}
function FE3rTextureConsole_load2(b,d){var f=this._textures,h=f.get(d);if(h)return h;var q=RConsole.find(FE3sTextureConsole).load(d),h=RClass.create(FE3rTexture);h.linkGraphicContext(b);h.setResource(q);f.set(d,h);this._loadTextures.push(h);return h}function FE3rTextureConsole_loadBitmap(b,d,f){var h=this._bitmaps.get(f);return h?h:this.load(b,d).loadBitmap(f)}
function FE3rTrack(b){b=RClass.inherits(this,b,FObject);b._matrix=null;b._resource=null;b.construct=FE3rTrack_construct;b.matrix=FE3rTrack_matrix;b.resource=FE3rTrack_resource;b.loadResource=FE3rTrack_loadResource;b.dispose=FE3rTrack_dispose;return b}function FE3rTrack_construct(){this.__base.FObject.construct.call(this);this._matrix=new SMatrix3d}function FE3rTrack_matrix(){return this._matrix}function FE3rTrack_resource(){return this._resource}
function FE3rTrack_loadResource(b){this._resource=b;var d=b.frames();null!=d&&(this._frameCount=d.count());this._frameTick=b.frameTick()}function FE3rTrack_dispose(){this._resource=null;this.__base.FG3dTrack.dispose.call(this)}function FE3dAutomaticEffect(b){b=RClass.inherits(this,b,FG3dAutomaticEffect);b.drawGroup=FE3dAutomaticEffect_drawGroup;return b}
function FE3dAutomaticEffect_drawGroup(b,d,f,h){if(1<h){var q=RConsole.find(FE3rModelConsole).merge(this,b,f,h);if(q){d=this._graphicContext;q=q.meshes();f=q.count();h=b.spaceName();var z=q.first(),A=z.selectInfo(h),B=A.effect;B||(B=A.effect=RConsole.find(FG3dEffectConsole).find(d,b,z));for(d=1;d<f;d++)z=q.getAt(d),A=z.selectInfo(h),A.effect=B;return B.drawRenderables(b,q,0,f)}}this.drawRenderables(b,d,f,h)}
function FE3dControlAutomaticEffect(b){b=RClass.inherits(this,b,FG3dAutomaticEffect);b._code="control.automatic";b.drawRenderable=FE3dControlAutomaticEffect_drawRenderable;return b}
function FE3dControlAutomaticEffect_drawRenderable(b,d){var f=this._graphicContext,h=this._program,q=d.material(),z=q.info();this.bindMaterial(q);h.setParameter("vc_model_matrix",d.currentMatrix());h.setParameter("vc_vp_matrix",b.calculate(EG3dRegionParameter.CameraViewProjectionMatrix));h.setParameter4("fc_alpha",z.alphaBase,z.alphaRate,z.alphaLevel,z.alphaMerge);h.setParameter("fc_ambient_color",z.ambientColor);this.bindAttributes(d);this.bindSamplers(d);f.drawTriangles(d.indexBuffer())}
function FE3dControlFrameEffect(b){b=RClass.inherits(this,b,FG3dAutomaticEffect);b._code="control.frame";b.drawRenderable=FE3dControlFrameEffect_drawRenderable;return b}
function FE3dControlFrameEffect_drawRenderable(b,d){var f=this._graphicContext,h=this._program,q=b.calculate(EG3dRegionParameter.CameraPosition),z=b.calculate(EG3dRegionParameter.LightDirection),A=d.material(),B=A.info();this.bindMaterial(A);h.setParameter("vc_model_matrix",d.currentMatrix());h.setParameter("vc_vp_matrix",b.calculate(EG3dRegionParameter.CameraViewProjectionMatrix));h.setParameter("vc_camera_position",q);h.setParameter("vc_light_direction",z);h.setParameter("fc_camera_position",q);
h.setParameter("fc_light_direction",z);h.setParameter("fc_color",B.ambientColor);h.setParameter4("fc_vertex_color",B.colorMin,B.colorMax,B.colorRate,B.colorMerge);h.setParameter4("fc_alpha",B.alphaBase,B.alphaRate,B.alphaLevel,B.alphaMerge);h.setParameter("fc_ambient_color",B.ambientColor);h.setParameter("fc_diffuse_color",B.diffuseColor);h.setParameter("fc_specular_color",B.specularColor);h.setParameter4("fc_specular",B.specularBase,B.specularLevel,B.specularAverage,B.specularShadow);h.setParameter("fc_specular_view_color",
B.specularViewColor);h.setParameter4("fc_specular_view",B.specularViewBase,B.specularViewRate,B.specularViewAverage,B.specularViewShadow);h.setParameter("fc_reflect_color",B.reflectColor);h.setParameter4("fc_reflect",0,0,1-B.reflectMerge,B.reflectMerge);h.setParameter("fc_emissive_color",B.emissiveColor);this.bindAttributes(d);this.bindSamplers(d);f.drawTriangles(d.indexBuffer())}function FE3dControlPass(b){b=RClass.inherits(this,b,FG3dTechniquePass);b._code="control";return b}
function FE3dControlTechnique(b){b=RClass.inherits(this,b,FG3dTechnique);b._code="control";b._passControl=null;b.setup=FE3dControlTechnique_setup;b.passControl=FE3dControlTechnique_passControl;b.drawRegion=FE3dControlTechnique_drawRegion;return b}function FE3dControlTechnique_setup(){this.__base.FG3dTechnique.setup.call(this);this.registerMode(EG3dTechniqueMode.Result);var b=this._passControl=RClass.create(FE3dControlPass);b.linkGraphicContext(this);b.setup();this._passes.push(b)}
function FE3dControlTechnique_passControl(){return this._passControl}function FE3dControlTechnique_drawRegion(b){b.renderables().isEmpty()||(this._graphicContext.clearDepth(1),this.__base.FG3dTechnique.drawRegion.call(this,b))}function FE3dGeneralColorAutomaticEffect(b){b=RClass.inherits(this,b,FE3dAutomaticEffect);b._code="general.color.automatic";b.buildMaterial=FE3dGeneralColorAutomaticEffect_buildMaterial;b.drawRenderable=FE3dGeneralColorAutomaticEffect_drawRenderable;return b}
function FE3dGeneralColorAutomaticEffect_buildMaterial(b,d){var f=d.material(),h=b.material;h||(h=b.material=RClass.create(FFloatStream),h.setLength(40),f._dirty=!0);if(f._dirty){var q=f.info();h.reset();q.optionAlpha?h.writeFloat4(q.alphaBase,q.alphaRate,0,0):h.writeFloat4(q.alphaBase,1,0,0);h.writeFloat4(q.colorMin,q.colorMax,q.colorBalance,q.colorRate);h.writeColor4(q.vertexColor);h.writeColor4(q.ambientColor);h.writeColor4(q.diffuseColor);h.writeColor4(q.specularColor);h.writeFloat4(q.specularBase,
q.specularLevel,q.specularAverage,q.specularShadow);h.writeColor4(q.reflectColor);h.writeFloat4(0,0,1-q.reflectMerge,q.reflectMerge);h.writeColor4(q.emissiveColor);f._dirty=!1}}
function FE3dGeneralColorAutomaticEffect_drawRenderable(b,d){var f=this._program,h=b.calculate(EG3dRegionParameter.CameraPosition),q=b.calculate(EG3dRegionParameter.LightDirection),z=b.calculate(EG3dRegionParameter.CameraViewProjectionMatrix),A=d.material();this.bindMaterial(A);if(d._optionMerge){for(var A=d.mergeRenderables(),B=A.count(),C=RTypeArray.findTemp(EDataType.Float32,16*B),D=0;D<B;D++){var E=A.at(D).currentMatrix();E.writeData(C,16*D)}f.setParameter("vc_model_matrix",C)}else E=d.currentMatrix(),
f.setParameter("vc_model_matrix",E);f.setParameter("vc_vp_matrix",z);f.setParameter("vc_camera_position",h);f.setParameter("vc_light_direction",q);f.setParameter("fc_camera_position",h);f.setParameter("fc_light_direction",q);this._supportMaterialMap?f.setParameter4("fc_material",.03125,d._materialId/512,0,0):(h=d.activeInfo(),this.buildMaterial(h,d),f.setParameter("fc_materials",h.material.memory()));this.__base.FE3dAutomaticEffect.drawRenderable.call(this,b,d)}
function FE3dGeneralColorFlatEffect(b){b=RClass.inherits(this,b,FE3dAutomaticEffect);b._code="general.color.flat";b.drawRenderable=FE3dGeneralColorFlatEffect_drawRenderable;return b}
function FE3dGeneralColorFlatEffect_drawRenderable(b,d){var f=this._graphicContext.size(),h=this._program,q=d.material();this.bindMaterial(q);if(d._optionMerge){for(var q=d.mergeRenderables(),z=q.count(),A=RTypeArray.findTemp(EDataType.Float32,4*z),B=0,C=0;C<z;C++){var D=q.getAt(C),E=D.matrix();A[B++]=E.sx/f.width*2;A[B++]=E.sy/f.height*2;A[B++]=E.tx/f.width*2-1;A[B++]=1-E.ty/f.height*2;D.currentMatrix().writeData(A,4*C)}h.setParameter("vc_position",A)}else E=d.matrix(),h.setParameter4("vc_position",
E.sx/f.width*2,E.sy/f.height*2,E.tx/f.width*2-1,1-E.ty/f.height*2);this.__base.FE3dAutomaticEffect.drawRenderable.call(this,b,d)}function FE3dGeneralColorPass(b){b=RClass.inherits(this,b,FG3dTechniquePass);b._code="color";return b}function FE3dGeneralColorSkeletonEffect(b){b=RClass.inherits(this,b,FE3dAutomaticEffect);b._code="general.color.skeleton";b._supportSkeleton=!0;b.drawRenderable=FE3dGeneralColorSkeletonEffect_drawRenderable;return b}
function FE3dGeneralColorSkeletonEffect_drawRenderable(b,d){var f=this._program,h=b.calculate(EG3dRegionParameter.CameraPosition),q=b.calculate(EG3dRegionParameter.LightDirection),z=d.material(),A=z.info();this.bindMaterial(z);f.setParameter("vc_model_matrix",d.currentMatrix());f.setParameter("vc_vp_matrix",b.calculate(EG3dRegionParameter.CameraViewProjectionMatrix));f.setParameter("vc_camera_position",h);f.setParameter("vc_light_direction",q);f.setParameter("fc_camera_position",h);f.setParameter("fc_light_direction",
q);f.setParameter("fc_color",A.ambientColor);f.setParameter4("fc_vertex_color",A.colorMin,A.colorMax,A.colorRate,A.colorMerge);f.setParameter4("fc_alpha",A.alphaBase,A.alphaRate,A.alphaLevel,A.alphaMerge);f.setParameter("fc_ambient_color",A.ambientColor);f.setParameter("fc_diffuse_color",A.diffuseColor);f.setParameter("fc_specular_color",A.specularColor);f.setParameter4("fc_specular",A.specularBase,A.specularLevel,A.specularAverage,A.specularShadow);f.setParameter("fc_specular_view_color",A.specularViewColor);
f.setParameter4("fc_specular_view",A.specularViewBase,A.specularViewRate,A.specularViewAverage,A.specularViewShadow);f.setParameter("fc_reflect_color",A.reflectColor);if(h=d.bones()){q=d._boneLimit;z=RTypeArray.findTemp(EDataType.Float32,16*q);for(A=0;A<q;A++)h.get(A).matrix().writeData(z,16*A);f.setParameter("vc_bone_matrix",z)}this.__base.FE3dAutomaticEffect.drawRenderable.call(this,b,d)}
function FE3dGeneralTechnique(b){b=RClass.inherits(this,b,FE3dTechnique);b._code="general";b._passColor=null;b.setup=FE3dGeneralTechnique_setup;b.passColor=FE3dGeneralTechnique_passColor;return b}
function FE3dGeneralTechnique_setup(){this.__base.FE3dTechnique.setup.call(this);this.registerMode(EG3dTechniqueMode.Ambient);this.registerMode(EG3dTechniqueMode.DiffuseLevel);this.registerMode(EG3dTechniqueMode.DiffuseColor);this.registerMode(EG3dTechniqueMode.SpecularLevel);this.registerMode(EG3dTechniqueMode.SpecularColor);this.registerMode(EG3dTechniqueMode.Result);var b=this._passColor=RClass.create(FE3dGeneralColorPass);b.linkGraphicContext(this);b.setup();this._passes.push(b)}
function FE3dGeneralTechnique_passColor(){return this._passColor}function FE3dShadowColorAutomaticEffect(b){b=RClass.inherits(this,b,FG3dAutomaticEffect);b._code="shadow.color.automatic";b.drawRenderable=FE3dShadowColorAutomaticEffect_drawRenderable;return b}
function FE3dShadowColorAutomaticEffect_drawRenderable(b,d){var f=this._graphicContext,h=this._program,q=b.calculate(EG3dRegionParameter.CameraPosition),z=b.calculate(EG3dRegionParameter.CameraViewProjectionMatrix),A=b.calculate(EG3dRegionParameter.LightDirection),B=b.calculate(EG3dRegionParameter.LightViewMatrix),C=b.calculate(EG3dRegionParameter.LightViewProjectionMatrix),D=b.calculate(EG3dRegionParameter.LightInfo),E=b.techniquePass(),F=d.material();this.bindMaterial(F);h.setParameter("vc_light_depth",
D);h.setParameter("vc_model_matrix",d.currentMatrix());h.setParameter("vc_vp_matrix",z);h.setParameter("vc_camera_position",q);h.setParameter("vc_light_direction",A);h.setParameter("vc_light_view_matrix",B);h.setParameter("vc_light_vp_matrix",C);h.setParameter("fc_camera_position",q);h.setParameter("fc_light_direction",A);h.setParameter4("fc_light_depth",1/4096,0,-1/4096,D.w);q=F.info();h.setParameter("fc_color",q.ambientColor);h.setParameter4("fc_vertex_color",q.colorMin,q.colorMax,q.colorRate,q.colorMerge);
h.setParameter4("fc_alpha",q.alphaBase,q.alphaRate,q.alphaLevel,q.alphaMerge);h.setParameter("fc_ambient_color",q.ambientColor);h.setParameter("fc_diffuse_color",q.diffuseColor);h.setParameter("fc_specular_color",q.specularColor);h.setParameter4("fc_specular",q.specularBase,q.specularLevel,q.specularAverage,q.specularShadow);h.setParameter("fc_specular_view_color",q.specularViewColor);h.setParameter4("fc_specular_view",q.specularViewBase,q.specularViewRate,q.specularViewAverage,q.specularViewShadow);
h.setParameter("fc_reflect_color",q.reflectColor);this.bindAttributes(d);h.setSampler("fs_light_depth",E.textureDepth());this.bindSamplers(d);f.drawTriangles(d.indexBuffer())}function FE3dShadowColorPass(b){b=RClass.inherits(this,b,FG3dTechniquePass);b._code="color";b._textureDepth=null;b.textureDepth=FE3dShadowColorPass_textureDepth;b.setTextureDepth=FE3dShadowColorPass_setTextureDepth;b.drawRegion=FE3dShadowColorPass_drawRegion;return b}
function FE3dShadowColorPass_textureDepth(){return this._textureDepth}function FE3dShadowColorPass_setTextureDepth(b){this._textureDepth=b}function FE3dShadowColorPass_drawRegion(b){var d=this._graphicContext;d.setRenderTarget(null);var f=b._backgroundColor;d.clear(f.red,f.green,f.blue,f.alpha,1);this.__base.FG3dTechniquePass.drawRegion.call(this,b)}
function FE3dShadowColorSkeletonEffect(b){b=RClass.inherits(this,b,FG3dAutomaticEffect);b._code="shadow.color.skeleton";b._supportSkeleton=!0;b.drawRenderable=FE3dShadowColorSkeletonEffect_drawRenderable;return b}
function FE3dShadowColorSkeletonEffect_drawRenderable(b,d){var f=this._graphicContext,h=this._program,q=b.matrixViewProjection(),z=b.cameraPosition(),A=b.lightDirection();if(h.hasAttribute())for(var B=h.attributes(),C=B.count(),D=0;D<C;D++){var E=B.value(D);if(E._statusUsed){var F=d.findVertexBuffer(E._linker);if(null==F)throw new TError("Can't find renderable vertex buffer. (linker={1})",E._linker);h.setAttribute(E._name,F,F._formatCd)}}if(h.hasSampler())for(B=h.samplers(),C=B.count(),D=0;D<C;D++)if(E=
B.value(D),E._statusUsed){var F=E.linker(),G=d.findTexture(F);if(null!=G)h.setSampler(E.name(),G.texture());else throw new TError("Can't find sampler. (linker={1})",F);}h.setParameter("vc_model_matrix",d.currentMatrix());h.setParameter("vc_vp_matrix",q);h.setParameter("vc_camera_position",z);h.setParameter("vc_light_direction",A);h.setParameter("fc_camera_position",z);h.setParameter("fc_light_direction",A);q=d.material();q=q.info();h.setParameter("fc_color",q.ambientColor);h.setParameter4("fc_vertex_color",
q.colorMin,q.colorMax,q.colorRate,q.colorMerge);h.setParameter4("fc_alpha",q.alphaBase,q.alphaRate,q.alphaLevel,q.alphaMerge);h.setParameter("fc_ambient_color",q.ambientColor);h.setParameter("fc_diffuse_color",q.diffuseColor);h.setParameter("fc_specular_color",q.specularColor);h.setParameter4("fc_specular",q.specularBase,q.specularLevel,q.specularAverage,q.specularShadow);h.setParameter("fc_specular_view_color",q.specularViewColor);h.setParameter4("fc_specular_view",q.specularViewBase,q.specularViewRate,
q.specularViewAverage,q.specularViewShadow);h.setParameter("fc_reflect_color",q.reflectColor);if(z=d.bones()){A=z.count();32<A&&(A=32);D=RTypeArray.findTemp(EDataType.Float32,16*A);for(B=0;B<A;B++)q=z.get(B).matrix(),q.writeData(D,16*B);h.setParameter("vc_bone_matrix",D)}h=d.indexBuffer();f.drawTriangles(h,0,h._count)}
function FE3dShadowDepthAutomaticEffect(b){b=RClass.inherits(this,b,FG3dAutomaticEffect);b._code="shadow.depth.automatic";b.drawRenderable=FE3dShadowDepthAutomaticEffect_drawRenderable;return b}
function FE3dShadowDepthAutomaticEffect_drawRenderable(b,d){var f=this._graphicContext,h=this._program,q=b.calculate(EG3dRegionParameter.LightViewMatrix),z=b.calculate(EG3dRegionParameter.LightViewProjectionMatrix),A=b.calculate(EG3dRegionParameter.LightInfo);f.setBlendFactors(!1);h.setParameter("vc_camera",A);h.setParameter("vc_model_matrix",d.currentMatrix());h.setParameter("vc_view_matrix",q);h.setParameter("vc_vp_matrix",z);h.setParameter("fc_camera",A);h.setParameter4("fc_alpha",0,0,0,.1);this.bindAttributes(d);
this.bindSamplers(d);f.drawTriangles(d.indexBuffer())}function FE3dShadowDepthPass(b){b=RClass.inherits(this,b,FG3dTechniquePass);b._code="depth";b._renderTarget=null;b._textureDepth=null;b._renderTarget=null;b.setup=FE3dShadowDepthPass_setup;b.textureDepth=FE3dShadowDepthPass_textureDepth;b.drawRegion=FE3dShadowDepthPass_drawRegion;return b}
function FE3dShadowDepthPass_setup(){this.__base.FG3dTechniquePass.setup.call(this);var b=this._graphicContext,d=this._textureDepth=b.createFlatTexture();d.setFilter(EG3dSamplerFilter.Linear,EG3dSamplerFilter.Linear);d.setWrap(EG3dSamplerFilter.ClampToEdge,EG3dSamplerFilter.ClampToEdge);b=this._renderTarget=b.createRenderTarget();b.size().set(2048,2048);b.textures().push(d);b.build()}function FE3dShadowDepthPass_textureDepth(){return this._textureDepth}
function FE3dShadowDepthPass_drawRegion(b){var d=this._graphicContext;this._finish?(d.setRenderTarget(null),d=b._backgroundColor,this._context.clear(d.red,d.green,d.blue,d.alpha,1)):(d.setRenderTarget(this._renderTarget),d.clear(0,0,0,1,1,1));b._textureDepth=this._textureDepth;this.__base.FG3dTechniquePass.drawRegion.call(this,b)}
function FE3dShadowDepthSkeletonEffect(b){b=RClass.inherits(this,b,FG3dAutomaticEffect);b._code="shadow.depth.skeleton";b._supportSkeleton=!0;b.drawRenderable=FE3dShadowDepthSkeletonEffect_drawRenderable;return b}
function FE3dShadowDepthSkeletonEffect_drawRenderable(b,d){var f=this._graphicContext,h=this._program;h.setParameter("vc_model_matrix",r.currentMatrix());h.setParameter("vc_vp_matrix",prvp);h.setParameter("vc_camera_position",prcp);h.setParameter("vc_light_direction",prld);h.setParameter("fc_camera_position",prcp);h.setParameter("fc_light_direction",prld);var q=r.material(),q=q.info();h.setParameter("fc_color",q.ambientColor);h.setParameter4("fc_vertex_color",q.colorMin,q.colorMax,q.colorRate,q.colorMerge);
h.setParameter4("fc_alpha",q.alphaBase,q.alphaRate,q.alphaLevel,q.alphaMerge);h.setParameter("fc_ambient_color",q.ambientColor);h.setParameter("fc_diffuse_color",q.diffuseColor);h.setParameter("fc_specular_color",q.specularColor);h.setParameter4("fc_specular",q.specularBase,q.specularRate,q.specularAverage,q.specularShadow);h.setParameter("fc_specular_view_color",q.specularViewColor);h.setParameter4("fc_specular_view",q.specularViewBase,q.specularViewRate,q.specularViewAverage,q.specularViewShadow);
h.setParameter("fc_reflect_color",q.reflectColor);var z=d.bones();if(z){var A=z.count();32<A&&(A=32);for(var B=RTypeArray.findTemp(EDataType.Float32,16*A),C=0;C<A;C++)q=z.get(C).matrix(),q.writeData(B,16*C);h.setParameter("vc_bone_matrix",B)}this.bindAttributes(d);this.bindSamplers(d);f.drawTriangles(d.indexBuffer())}
function FE3dShadowTechnique(b){b=RClass.inherits(this,b,FE3dTechnique);b._code="shadow";b._passDepth=null;b._passColor=null;b.setup=FE3dShadowTechnique_setup;b.passDepth=FE3dShadowTechnique_passDepth;b.passColor=FE3dShadowTechnique_passColor;b.updateRegion=FE3dShadowTechnique_updateRegion;return b}
function FE3dShadowTechnique_setup(){this.__base.FE3dTechnique.setup.call(this);this.registerMode(EG3dTechniqueMode.Ambient);this.registerMode(EG3dTechniqueMode.DiffuseLevel);this.registerMode(EG3dTechniqueMode.DiffuseColor);this.registerMode(EG3dTechniqueMode.SpecularLevel);this.registerMode(EG3dTechniqueMode.SpecularColor);this.registerMode(EG3dTechniqueMode.Result);var b=this._passes,d=this._passDepth=RClass.create(FE3dShadowDepthPass);d.linkGraphicContext(this);d.setup();var f=this._passColor=
RClass.create(FE3dShadowColorPass);f.linkGraphicContext(this);f.setup();b.push(f);f.setTextureDepth(d.textureDepth())}function FE3dShadowTechnique_passDepth(){return this._passDepth}function FE3dShadowTechnique_passColor(){return this._passColor}function FE3dShadowTechnique_updateRegion(b){this.__base.FE3dTechnique.updateRegion.call(this,b);this._graphicContext.size();b.camera();b.directionalLight().camera()}
var EE3dInstance=new function(){this.ModelRenderable="model.renderable";this.TemplateRenderable="template.renderable";this.Scene="scene";this.SceneLayer="scene.layer";this.SceneDisplay="scene.display";this.SceneMaterial="scene.material";this.SceneMovie="scene.movie";this.SceneRenderable="scene.renderable";return this};function FE3dAnimation(b){return b=RClass.inherits(this,b,FObject,ME3dObject,MLinkerResource)}
function FE3dBitmap(b){b=RClass.inherits(this,b,FE3dMeshRenderable,MListenerLoad);b._ready=!1;b._size=null;b._renderable=null;b.construct=FE3dBitmap_construct;b.testReady=FE3dBitmap_testReady;b.size=FE3dBitmap_size;b.setSize=FE3dBitmap_setSize;b.renderable=FE3dBitmap_renderable;b.setRenderable=FE3dBitmap_setRenderable;b.vertexBuffers=FE3dBitmap_vertexBuffers;b.indexBuffer=FE3dBitmap_indexBuffer;b.findVertexBuffer=FE3dBitmap_findVertexBuffer;b.findTexture=FE3dBitmap_findTexture;b.textures=FE3dBitmap_textures;
b.processLoad=FE3dBitmap_processLoad;b.process=FE3dBitmap_process;b.loadUrl=FE3dBitmap_loadUrl;b.dispose=FE3dBitmap_dispose;return b}function FE3dBitmap_construct(){this.__base.FE3dMeshRenderable.construct.call(this);this._material=RClass.create(FE3dMaterial);this._size=new SSize2}
function FE3dBitmap_testReady(){if(!this._ready){var b=this._renderable;if(b&&(this._ready=b.testReady())){var d=b.size(),b=b.adjustSize(),f=this.matrix();f.sz=b.height/d.height;f.updateForce();d=new SEvent(this);this.processLoadListener(d);d.dispose()}}return this._ready}function FE3dBitmap_size(){return this._size}function FE3dBitmap_setSize(b,d){this._size.set(b,d);this._scale.set(b,d,1)}function FE3dBitmap_renderable(b){return this._renderable}
function FE3dBitmap_setRenderable(b){this._renderable=b;this._ready=!0;this.processLoadListener(this)}function FE3dBitmap_vertexBuffers(){return this._renderable.vertexBuffers()}function FE3dBitmap_indexBuffer(){return this._renderable.indexBuffer()}function FE3dBitmap_findVertexBuffer(b){return this._renderable.findVertexBuffer(b)}function FE3dBitmap_findTexture(b){return this._renderable.findTexture(b)}function FE3dBitmap_textures(){return this._renderable.textures()}
function FE3dBitmap_processLoad(){return!0}function FE3dBitmap_process(){this.__base.FE3dMeshRenderable.process.call(this)}function FE3dBitmap_loadUrl(b){var d=this._graphicContext;this._renderable=RConsole.find(FE3dBitmapConsole).loadUrl(d,b);this._ready=!1}function FE3dBitmap_dispose(){this._material=RObject.dispoe(this._material);this.__base.FE3dMeshRenderable.dispose.call(this)}
function FE3dBitmapConsole(b){b=RClass.inherits(this,b,FConsole);b._scopeCd=EScope.Local;b._bitmaps=null;b._dataUrl="/cloud.resource.bitmap.wv";b.construct=FE3dBitmapConsole_construct;b.bitmaps=FE3dBitmapConsole_bitmaps;b.load=FE3dBitmapConsole_load;b.loadUrl=FE3dBitmapConsole_loadUrl;return b}function FE3dBitmapConsole_construct(){this.__base.FConsole.construct.call(this);this._bitmaps=new TDictionary}function FE3dBitmapConsole_bitmaps(){return this._bitmaps}
function FE3dBitmapConsole_load(b,d,f){var h=d+"|"+f,q=this._bitmaps.get(h);if(q)return q;d=RBrowser.hostPath(this._dataUrl+"?guid="+d+"&code="+f);RLogger.info(this,"Load bitmap. (url={1})",d);q="environment"==f?RClass.create(FE3rBitmapCubePack):RClass.create(FE3rBitmapFlatPack);q.linkGraphicContext(b);q.loadUrl(d);this._bitmaps.set(h,q);return q}
function FE3dBitmapConsole_loadUrl(b,d){var f=this._bitmaps.get(d);if(f)return f;f=RBrowser.contentPath(d);RLogger.info(this,"Load bitmap from url. (url={1})",f);f=RClass.create(FE3dBitmapData);f.linkGraphicContext(b);f.setup();f.loadUrl(d);this._bitmaps.set(d,f);return f}
function FE3dBitmapData(b){b=RClass.inherits(this,b,FE3rObject);b._ready=!1;b._vertexCount=4;b._vertexBuffers=null;b._indexBuffer=null;b._indexBuffers=null;b._material=null;b._textures=null;b._image=null;b._size=null;b._adjustSize=null;b.onImageLoad=FE3dBitmapData_onImageLoad;b.construct=FE3dBitmapData_construct;b.testReady=FE3dBitmapData_testReady;b.size=FE3dBitmapData_size;b.adjustSize=FE3dBitmapData_adjustSize;b.vertexCount=FE3dBitmapData_vertexCount;b.findVertexBuffer=FE3dBitmapData_findVertexBuffer;
b.vertexBuffers=FE3dBitmapData_vertexBuffers;b.indexBuffer=FE3dBitmapData_indexBuffer;b.indexBuffers=FE3dBitmapData_indexBuffers;b.material=FE3dBitmapData_material;b.findTexture=FE3dBitmapData_findTexture;b.textures=FE3dBitmapData_textures;b.setup=FE3dBitmapData_setup;b.loadUrl=FE3dBitmapData_loadUrl;b.dispose=FE3dBitmapData_dispose;return b}
function FE3dBitmapData_onImageLoad(b){var d=this._graphicContext;b=b.sender;var f=b.size(),h=f.width,q=f.height;this._size.set(h,q);f=RInteger.pow2(h);q=RInteger.pow2(q);this._adjustSize.set(f,q);h=RConsole.find(FE2dCanvasConsole);f=h.allocBySize(f,q);f.context().drawImage(b,0,0);d=this._imageTexture=d.createFlatTexture();d.setOptionFlipY(!0);d.upload(f);this._textures.set("diffuse",d);h.free(f);b.dispose();this._ready=!0}
function FE3dBitmapData_construct(){this.__base.FE3rObject.construct.call(this);this._size=new SSize2;this._adjustSize=new SSize2;this._vertexBuffers=new TDictionary;this._textures=new TDictionary}function FE3dBitmapData_testReady(){return this._ready}function FE3dBitmapData_size(){return this._size}function FE3dBitmapData_adjustSize(){return this._adjustSize}function FE3dBitmapData_vertexCount(){return this._vertexCount}
function FE3dBitmapData_findVertexBuffer(b){return this._vertexBuffers.get(b)}function FE3dBitmapData_vertexBuffers(){return this._vertexBuffers}function FE3dBitmapData_indexBuffer(){return this._indexBuffer}function FE3dBitmapData_indexBuffers(){return this._indexBuffers}function FE3dBitmapData_material(){return this._material}function FE3dBitmapData_findTexture(b){return this._textures.get(b)}function FE3dBitmapData_textures(){return this._textures}
function FE3dBitmapData_setup(){var b=this._graphicContext,d=[0,0,0,1,0,0,1,-1,0,0,-1,0],f=this._vertexPositionBuffer=b.createVertexBuffer();f.setName("position");f._formatCd=EG3dAttributeFormat.Float3;f.upload(d,12,4);this._vertexBuffers.set(f.name(),f);d=[0,1,1,1,1,0,0,0];f=this._vertexColorBuffer=b.createVertexBuffer();f.setName("coord");f._formatCd=EG3dAttributeFormat.Float2;f.upload(d,8,4);this._vertexBuffers.set(f.name(),f);d=[0,1,2,0,2,3];f=this._indexBuffer=b.createIndexBuffer();f.upload(d,
6)}function FE3dBitmapData_loadUrl(b){var d=this._imageTexture;d&&(d.dispose(),this._imageTexture=null,this._textures.clear());d=RClass.create(FImage);d.addLoadListener(this,this.onImageLoad);d.loadUrl(b);this._ready=!1}
function FE3dBitmapData_dispose(){this._size=RObject.dispose(this._size);this._adjustSize=RObject.dispose(this._adjustSize);this._vertexBuffers=RObject.dispose(this._vertexBuffers);this._indexBuffer=RObject.dispose(this._indexBuffer);this._imageTexture=RObject.dispose(this._imageTexture);this._textures=RObject.dispose(this._textures);this.__base.FE3rObject.dispose.call(this)}
function FE3dBoundBox(b){b=RClass.inherits(this,b,FE3dRenderable);b._outline=null;b._rate=.2;b._vertexPositionBuffer=null;b._vertexColorBuffer=null;b.construct=FE3dBoundBox_construct;b.outline=FE3dBoundBox_outline;b.setup=FE3dBoundBox_setup;b.upload=FE3dBoundBox_upload;return b}function FE3dBoundBox_construct(){this.__base.FE3dRenderable.construct.call(this);this._material=RClass.create(FE3dMaterial);this._outline=new SOutline3}function FE3dBoundBox_outline(){return this._outline}
function FE3dBoundBox_setup(){var b=this._graphicContext,d=this._vertexPositionBuffer=b.createVertexBuffer();d._name="position";d._formatCd=EG3dAttributeFormat.Float3;this._vertexBuffers.set(d._name,d);for(var f=new Uint8Array(128),d=127;0<=d;d--)f[d]=255;d=this._vertexColorBuffer=b.createVertexBuffer();d._name="color";d._formatCd=EG3dAttributeFormat.Byte4Normal;d.upload(f,4,32);this._vertexBuffers.set(d._name,d);this._vertexCount=32;b=this._indexBuffer=b.createIndexBuffer();b._fillMode=EG3dFillMode.Line;
b._lineWidth=1;b.upload([0,1,0,4,0,12,3,2,3,5,3,13,8,6,8,9,8,14,11,7,11,10,11,15,20,16,20,21,20,24,23,17,23,22,23,25,28,18,28,26,28,29,31,19,31,27,31,30],48);this.update();b=this.material().info();b.effectCode="control";b.ambientColor.set(1,1,1,1)}
function FE3dBoundBox_upload(){var b=this._outline,d=b.max,f=d.x,h=d.y,d=d.z,q=b.min,b=q.x,z=q.y,q=q.z,A=this._rate,B=(f-b)*A,C=(h-z)*A,A=(d-q)*A;this._vertexPositionBuffer.upload([b,h,q,b+B,h,q,f-B,h,q,f,h,q,b,h-C,q,f,h-C,q,b,z+C,q,f,z+C,q,b,z,q,b+B,z,q,f-B,z,q,f,z,q,b,h,q+A,f,h,q+A,b,z,q+A,f,z,q+A,b,h,d-A,f,h,d-A,b,z,d-A,f,z,d-A,b,h,d,b+B,h,d,f-B,h,d,f,h,d,b,h-C,d,f,h-C,d,b,z+C,d,f,z+C,d,b,z,d,b+B,z,d,f-B,z,d,f,z,d],12,32)}
function FE3dCamera(b){b=RClass.inherits(this,b,FG3dPerspectiveCamera,MLinkerResource);b._rotation=null;b._rotationMatrix=null;b._quaternion=null;b._quaternionX=null;b._quaternionY=null;b._quaternionZ=null;b.construct=FE3dCamera_construct;b.rotation=FE3dCamera_rotation;b.doPitch=FE3dCamera_doPitch;b.doYaw=FE3dCamera_doYaw;b.doRoll=FE3dCamera_doRoll;b.loadResource=FE3dCamera_loadResource;b.commitResource=FE3dCamera_commitResource;b.update=FE3dCamera_update;return b}
function FE3dCamera_construct(){this.__base.FG3dPerspectiveCamera.construct.call(this);this._rotation=new SVector3;this._rotationMatrix=new SMatrix3x3;this._quaternion=new SQuaternion;this._quaternionX=new SQuaternion;this._quaternionY=new SQuaternion;this._quaternionZ=new SQuaternion}function FE3dCamera_rotation(){return this._rotation}function FE3dCamera_doPitch(b){this._rotation.x+=b}function FE3dCamera_doYaw(b){this._rotation.y+=b}function FE3dCamera_doRoll(b){this._rotation.z+=b}
function FE3dCamera_loadResource(b){var d=b.projection();this._resource=b;this.position().assign(b.position());this.setDirection(b.direction().x,b.direction().y,b.direction().z);this.update();b=this.projection();b._angle=d.angle();b._znear=d.znear();b._zfar=d.zfar();b.update()}function FE3dCamera_commitResource(){var b=this._resource;b._position.assign(this._position);b._direction.assign(this._direction)}
function FE3dCamera_update(){var b=this._rotation;this._quaternionX.fromAxisAngle(RMath.vectorAxisX,b.x);this._quaternionY.fromAxisAngle(RMath.vectorAxisY,b.y);this._quaternionZ.fromAxisAngle(RMath.vectorAxisZ,b.z);var d=this._quaternion.identity();d.mul(this._quaternionX);d.mul(this._quaternionY);d.mul(this._quaternionZ);b=this._rotationMatrix;b.build(d);d=this._direction;b.transformPoint3(this._directionTarget,d);d.normalize();this.__base.FG3dPerspectiveCamera.update.call(this)}
function FE3dCube(b){b=RClass.inherits(this,b,FE3dRenderable);b.vertexPositionBuffer=null;b.vertexColorBuffer=null;b.indexBuffer=null;b.setup=FE3dCube_setup;return b}
function FE3dCube_setup(b){this.vertexPositionBuffer=b.createVertexBuffer();this.vertexPositionBuffer.upload([-1,1,-1,1,1,-1,1,-1,-1,-1,-1,-1,-1,1,1,1,1,1,1,-1,1,-1,-1,1],12,8);this.vertexColorBuffer=b.createVertexBuffer();this.vertexColorBuffer.upload([0,1,0,1,1,0,0,1,1,0,0,1,0,0,0,1,0,1,0,1,1,0,1,1,1,0,1,1,0,0,1,1],16,8);this.indexBuffer=context.createIndexBuffer();this.indexBuffer.upload([0,1,2,0,2,3,1,5,6,1,6,2,5,4,7,5,7,6,4,0,3,4,3,7,0,4,5,0,5,1,3,2,6,3,6,7],36);b=this.material().info();b.effectCode=
"control";b.ambientColor.set(1,1,1,1)}function FE3dDimensional(b){b=RClass.inherits(this,b,FE3dRenderable);b._cellSize=null;b._size=null;b._lineColor=null;b._lineCenterColor=null;b._vertexPositionBuffer=null;b._vertexColorBuffer=null;b.construct=FE3dDimensional_construct;b.setup=FE3dDimensional_setup;return b}
function FE3dDimensional_construct(){this.__base.FE3dRenderable.construct.call(this);this._material=RClass.create(FE3dMaterial);this._cellSize=new SSize2;this._cellSize.set(1,1);this._size=new SSize2;this._size.set(16,16)}
function FE3dDimensional_setup(){for(var b=this._graphicContext,d=this._cellSize.width,f=this._cellSize.height,h=this._size.width,q=h/2,z=this._size.height,A=z/2,B=2*(h+2+(z+2)),C=0,D=0,E=new Float32Array(3*B),F=0,G=new Uint8Array(4*B),I=0,H=new Uint16Array(B),K=0;K<=z;K++){var J=1;0==K-A&&(J=0);E[C++]=d*-q*J;E[C++]=0;E[C++]=f*(K-A);E[C++]=d*q*J;E[C++]=0;E[C++]=f*(K-A);for(J=0;8>J;J++)G[F++]=255;H[I++]=D++;H[I++]=D++}E[C++]=d*-q;E[C++]=0;E[C++]=0;E[C++]=d*q;E[C++]=0;for(J=E[C++]=0;2>J;J++)G[F++]=
255,G[F++]=0,G[F++]=0,G[F++]=255;H[I++]=D++;H[I++]=D++;for(z=0;z<=h;z++){J=1;0==z-q&&(J=0);E[C++]=d*(z-q);E[C++]=0;E[C++]=f*-A*J;E[C++]=d*(z-q);E[C++]=0;E[C++]=f*A*J;for(J=0;8>J;J++)G[F++]=255;H[I++]=D++;H[I++]=D++}E[C++]=0;E[C++]=0;E[C++]=f*-A;E[C++]=0;E[C++]=0;E[C++]=f*A;for(J=0;2>J;J++)G[F++]=255,G[F++]=0,G[F++]=0,G[F++]=255;H[I++]=D++;H[I++]=D++;this._vertexCount=B;d=this._vertexPositionBuffer=b.createVertexBuffer();d._name="position";d._formatCd=EG3dAttributeFormat.Float3;d.upload(E,12,B);this._vertexBuffers.set(d._name,
d);d=this._vertexColorBuffer=b.createVertexBuffer();d._name="color";d._formatCd=EG3dAttributeFormat.Byte4Normal;d.upload(G,4,B);this._vertexBuffers.set(d._name,d);b=this._indexBuffer=b.createIndexBuffer();b._fillMode=EG3dFillMode.Line;b.upload(H,B);B=this.material().info();B.effectCode="control";B.ambientColor.set(1,1,1,1)}
function FE3dDirectionalLight(b){b=RClass.inherits(this,b,FG3dDirectionalLight,MLinkerResource);b._material=null;b.construct=FE3dDirectionalLight_construct;b.material=FE3dDirectionalLight_material;b.loadResource=FE3dDirectionalLight_loadResource;b.dispose=FE3dDirectionalLight_dispose;return b}function FE3dDirectionalLight_construct(){this.__base.FG3dDirectionalLight.construct.call(this);this._material=RClass.create(FE3dMaterial)}function FE3dDirectionalLight_material(){return this._material}
function FE3dDirectionalLight_loadResource(b){this.__base.MLinkerResource.loadResource.call(this,b);this._material.loadResource(b.material())}function FE3dDirectionalLight_dispose(){this._material=RObject.dispose(this._material);this.__base.FG3dDirectionalLight.dispose.call(this)}function FE3dFlatStage(b){b=RClass.inherits(this,b,FE3dStage);b._layer=null;b.construct=FE3dFlatStage_construct;b.layer=FE3dFlatStage_layer;return b}
function FE3dFlatStage_construct(){this.__base.FE3dStage.construct.call(this);var b=this._layer=RClass.create(FDisplayLayer);this.registerLayer("Layer",b)}function FE3dFlatStage_layer(){return this._layer}
function FE3dInstanceConsole(b){b=RClass.inherits(this,b,FConsole);b._scopeCd=EScope.Local;b._factory=null;b.construct=FE3dInstanceConsole_construct;b.factory=FE3dInstanceConsole_factory;b.register=FE3dInstanceConsole_register;b.unregister=FE3dInstanceConsole_unregister;b.create=FE3dInstanceConsole_create;return b}
function FE3dInstanceConsole_construct(){var b=this._factory=RClass.create(FClassFactory);b.register(EE3dInstance.ModelRenderable,FE3dModelRenderable);b.register(EE3dInstance.TemplateRenderable,FE3dTemplateRenderable);b.register(EE3dInstance.Scene,FE3dScene);b.register(EE3dInstance.SceneLayer,FE3dSceneLayer);b.register(EE3dInstance.SceneDisplay,FE3dSceneDisplay);b.register(EE3dInstance.SceneMaterial,FE3dSceneMaterial);b.register(EE3dInstance.SceneMovie,FE3dSceneDisplayMovie);b.register(EE3dInstance.SceneRenderable,
FE3dSceneDisplayRenderable)}function FE3dInstanceConsole_factory(){return this._factory}function FE3dInstanceConsole_register(b,d){this._factory.register(b,d)}function FE3dInstanceConsole_unregister(b){this._factory.unregister(b,clazz)}function FE3dInstanceConsole_create(b){return this._factory.create(b)}function FE3dMaterial(b){b=RClass.inherits(this,b,FE3rMaterial);b._parent=null;b.loadParent=FE3dRenderable_loadParent;return b}function FE3dRenderable_loadParent(b){this._parent=b}
function FE3dMesh(b){b=RClass.inherits(this,b,FE3dSpace,MLinkerResource,MListenerLoad);b._ready=!1;b._display=null;b._renderable=null;b._layer=null;b.construct=FE3dMesh_construct;b.testReady=FE3dMesh_testReady;b.loadRenderable=FE3dMesh_loadRenderable;b.processLoad=FE3dMesh_processLoad;b.process=FE3dMesh_process;return b}function FE3dMesh_construct(){this.__base.FE3dSpace.construct.call(this);var b=this._layer=RClass.create(FDisplayLayer);this.registerLayer("Layer",b)}
function FE3dMesh_testReady(){return this._ready}
function FE3dMesh_loadRenderable(b){var d=b.resource();this.selectTechnique(this,FE3dGeneralTechnique).setResource(d.technique());this.loadResource(d);var f=RClass.create(FE3dMeshRenderable);f.setResource(d._renderable);f._material.loadResource(d._display._material);f._renderable=b;for(var h=b._vertexBuffers,q=h.count(),z=0;z<q;z++){var A=h.getAt(z);f._vertexBuffers.set(A._name,A)}f._indexBuffer=b._indexBuffer;f.matrix().assign(f.resource().matrix());b=this._display=RClass.create(FE3dMeshDisplay);
b._renderable=f;b.load(d._display);b.pushRenderable(f);this._layer.pushDisplay(b);this._ready=!0;this.processLoadListener(this)}function FE3dMesh_processLoad(){if(!this._renderable.testReady())return!1;this.loadRenderable(this._renderable);return!0}function FE3dMesh_process(){this.__base.FE3dSpace.process.call(this)}
function FE3dMeshConsole(b){b=RClass.inherits(this,b,FConsole);b._scopeCd=EScope.Local;b._loadMeshs=null;b._meshs=null;b._thread=null;b._interval=100;b.onProcess=FE3dMeshConsole_onProcess;b.construct=FE3dMeshConsole_construct;b.meshs=FE3dMeshConsole_meshs;b.allocByGuid=FE3dMeshConsole_allocByGuid;b.allocByCode=FE3dMeshConsole_allocByCode;b.free=FE3dMeshConsole_free;return b}
function FE3dMeshConsole_onProcess(){var b=this._loadMeshs;for(b.record();b.next();)b.current().processLoad()&&b.removeCurrent()}function FE3dMeshConsole_construct(){this._loadMeshs=new TLooper;this._meshs=new TDictionary;var b=this._thread=RClass.create(FThread);b.setInterval(this._interval);b.addProcessListener(this,this.onProcess);RConsole.find(FThreadConsole).start(b)}function FE3dMeshConsole_meshs(){return this._meshs}
function FE3dMeshConsole_allocByGuid(b,d){var f=this._meshs.get(d);if(f&&!f.isEmpty())return f.pop();var f=RConsole.find(FE3rMeshConsole).loadByGuid(b,d),h=RClass.create(FE3dMesh);h.linkGraphicContext(b);h._name=d;h._renderable=f;this._loadMeshs.push(h);return h}
function FE3dMeshConsole_allocByCode(b,d){var f=this._meshs.get(d);if(f&&!f.isEmpty())return f.pop();var f=RConsole.find(FE3rMeshConsole).loadByCode(b,d),h=RClass.create(FE3dMesh);h.linkGraphicContext(b);h._name=d;h._renderable=f;this._loadMeshs.push(h);return h}function FE3dMeshConsole_free(b){b._display.remove()}
function FE3dMeshDisplay(b){b=RClass.inherits(this,b,FE3dDisplay,MLinkerResource);b._material=null;b._renderable=null;b.renderable=FE3dMeshDisplay_renderable;b.load=FE3dMeshDisplay_load;b.reloadResource=FE3dMeshDisplay_reloadResource;return b}function FE3dMeshDisplay_renderable(){return this._renderable}function FE3dMeshDisplay_load(b){this._resource=b;this._matrix.assign(b.matrix())}function FE3dMeshDisplay_reloadResource(){this._matrix.assign(this._resource.matrix())}
function FE3dMeshRenderable(b){b=RClass.inherits(this,b,FE3dRenderable);b._renderable=null;b._activeTrack=null;b.renderable=FE3dMeshRenderable_renderable;b.vertexCount=FE3dMeshRenderable_vertexCount;b.findVertexBuffer=FE3dMeshRenderable_findVertexBuffer;b.vertexBuffers=FE3dMeshRenderable_vertexBuffers;b.indexBuffer=FE3dMeshRenderable_indexBuffer;b.indexBuffers=FE3dMeshRenderable_indexBuffers;b.findTexture=FE3dMeshRenderable_findTexture;b.textures=FE3dMeshRenderable_textures;b.reloadResource=FE3dMeshRenderable_reloadResource;
b.process=FE3dMeshRenderable_process;b.processDelay=FE3dMeshRenderable_processDelay;b.update=FE3dMeshRenderable_update;b.dispose=FE3dMeshRenderable_dispose;return b}function FE3dMeshRenderable_renderable(){return this._renderable}function FE3dMeshRenderable_vertexCount(){return this._renderable.vertexCount()}function FE3dMeshRenderable_findVertexBuffer(b){var d=this._vertexBuffers.get(b);return d?d:this._renderable.findVertexBuffer(b)}
function FE3dMeshRenderable_vertexBuffers(){return this._renderable.vertexBuffers()}function FE3dMeshRenderable_indexBuffer(){return this._renderable.indexBuffer()}function FE3dMeshRenderable_indexBuffers(){return this._renderable.indexBuffers()}function FE3dMeshRenderable_findTexture(b){return(b=this._textures.get(b))?b:this._renderable.findTexture(p)}function FE3dMeshRenderable_textures(){var b=this._textures;return b?b:this._renderable.textures()}
function FE3dMeshRenderable_reloadResource(){this._matrix.assign(this._resource.matrix())}function FE3dMeshRenderable_process(b){this.__base.FE3dRenderable.process.call(this,b);if((b=this._activeTrack)&&this._display._optionPlay){var d=b._animation;d&&d.process(b)}}function FE3dMeshRenderable_processDelay(b){this.__base.FE3dRenderable.processDelay.call(this,b)}
function FE3dMeshRenderable_update(b){var d=this._display,f=this._matrix,h=this._activeTrack,q=this._calculateMatrix;h?(q.assign(h.matrix()),q.append(f)):q.assign(f);d&&(d=this._display.currentMatrix(),q.append(d));this._currentMatrix.attachData(q.data())&&b.change()}function FE3dMeshRenderable_dispose(){this._modelMatrix=RObject.dispose(this._modelMatrix);this._vertexBuffers=RObject.dispose(this._vertexBuffers);this.__base.FE3dRenderable.dispose.call(this)}
function FE3dModel(b){b=RClass.inherits(this,b,FE3dSpace,MPoolAble,MLinkerResource,MListenerLoad);b._dataReady=!1;b._renderable=null;b._display=null;b.construct=FE3dModel_construct;b.display=FE3dModel_display;b.testReady=FE3dModel_testReady;b.renderable=FE3dModel_renderable;b.setRenderable=FE3dModel_setRenderable;b.loadRenderable=FE3dModel_loadRenderable;b.processLoad=FE3dModel_processLoad;return b}
function FE3dModel_construct(){this.__base.FE3dSpace.construct.call(this);var b=this._layer=RClass.create(FDisplayLayer);this.registerLayer("sprite",b);var d=this._display=RClass.create(FE3dModelDisplay);b.pushDisplay(d)}function FE3dModel_display(){return this._display}function FE3dModel_testReady(){return this._dataReady}function FE3dModel_renderable(){return this._renderable}function FE3dModel_setRenderable(b){this._renderable=b}
function FE3dModel_loadRenderable(b){this._renderable=b;var d=b.resource();this.selectTechnique(this,FE3dGeneralTechnique);this.loadResource(d);this._display.load(b);this._dataReady=!0}function FE3dModel_processLoad(){if(this._dataReady)return!0;var b=this._renderable;if(!b.testReady())return!1;this.loadRenderable(b);this.processLoadListener(this);return!0}
function FE3dModelConsole(b){b=RClass.inherits(this,b,FConsole);b._scopeCd=EScope.Local;b._looper=null;b._pools=null;b._thread=null;b._interval=100;b.onProcess=FE3dModelConsole_onProcess;b.construct=FE3dModelConsole_construct;b.pools=FE3dModelConsole_pools;b.allocByGuid=FE3dModelConsole_allocByGuid;b.allocByCode=FE3dModelConsole_allocByCode;b.free=FE3dModelConsole_free;return b}
function FE3dModelConsole_onProcess(){var b=this._looper;for(b.record();b.next();)b.current().processLoad()&&b.removeCurrent()}function FE3dModelConsole_construct(){this._looper=new TLooper;this._pools=RClass.create(FObjectPools);var b=this._thread=RClass.create(FThread);b.setInterval(this._interval);b.addProcessListener(this,this.onProcess);RConsole.find(FThreadConsole).start(b)}function FE3dModelConsole_pools(){return this._pools}
function FE3dModelConsole_allocByGuid(b,d){var f=this._pools.alloc(d);if(f)return f;var h=RConsole.find(FE3rModelConsole).load(b,d),f=RClass.create(FE3dModel);f.linkGraphicContext(b);f.setPoolCode(d);f.setRenderable(h);this._looper.push(f);return f}function FE3dModelConsole_allocByCode(b,d){return this._pools.alloc(d)}function FE3dModelConsole_free(b){var d=b.poolCode();this._pools.free(d,b)}
function FE3dModelDisplay(b){b=RClass.inherits(this,b,FE3dDisplay,MLinkerResource);b._material=null;b._shapes=null;b.construct=FE3dModelDisplay_construct;b.material=FE3dModelDisplay_material;b.shapes=FE3dModelDisplay_shapes;b.load=FE3dModelDisplay_load;b.reloadResource=FE3dModelDisplay_reloadResource;b.dispose=FE3dModelDisplay_dispose;return b}function FE3dModelDisplay_construct(){this.__base.FE3dDisplay.construct.call(this);this._material=RClass.create(FE3dMaterial)}
function FE3dModelDisplay_material(){return this._material}function FE3dModelDisplay_shapes(){return this._shapes}
function FE3dModelDisplay_load(b){var d=this._material,f=RConsole.find(FE3dInstanceConsole),h=this._resource=b.resource().display();this._matrix.assign(h.matrix());d.loadResource(h.material());if(b=b.geometrys())for(var h=b.count(),q=this._shapes=new TObjects,z=0;z<h;z++){var A=b.get(z),B=f.create(EE3dInstance.ModelRenderable);B.setDisplay(this);B.setMaterial(d);B.load(A);q.push(B);this.pushRenderable(B)}}
function FE3dModelDisplay_reloadResource(){var b=this._resource;this._matrix.assign(b.matrix());this._material.loadResource(b.material())}function FE3dModelDisplay_dispose(){this._material=RObject.dispose(this._material);this.__base.FE3dDisplay.dispose.call(this)}function FE3dModelRenderable(b){b=RClass.inherits(this,b,FE3dMeshRenderable);b._ready=!1;b._materialResource=null;b.testVisible=FE3dModelRenderable_testVisible;b.load=FE3dModelRenderable_load;return b}
function FE3dModelRenderable_testVisible(b){!this._ready&&(b=this._renderable)&&(this._ready=b.testReady());return this._ready}function FE3dModelRenderable_load(b){var d=this._material,f=this._materialResource=b.material();f&&d.assignInfo(f.info());this._effectCode=d.info().effectCode;this._renderable=b}function FE3dPolygon(b){return b=RClass.inherits(this,b,FE3dRenderable)}
function FE3dRectangle(b){b=RClass.inherits(this,b,FE3dRenderable);b._vertexPositionBuffer=null;b._vertexColorBuffer=null;b._indexBuffer=null;b.setup=FE3dRectangle_setup;return b}
function FE3dRectangle_setup(b){this._vertexPositionBuffer=b.createVertexBuffer();this._vertexPositionBuffer.upload([-1,1,0,1,1,0,1,-1,0,-1,-1,0],12,4);this._vertexColorBuffer=b.createVertexBuffer();this._vertexColorBuffer.upload([0,1,0,1,1,0,0,1,1,0,0,1,0,0,0,1],16,4);this._indexBuffer=context.createIndexBuffer();this._indexBuffer.upload([0,1,2,0,2,3],6)}
function FE3dRegion(b){b=RClass.inherits(this,b,FRegion,MGraphicObject,MG3dRegion,MLinkerResource);b._backgroundColor=null;b.construct=FE3dRegion_construct;b.backgroundColor=FE3dRegion_backgroundColor;b.loadResource=FE3dRegion_loadResource;b.reloadResource=FE3dRegion_reloadResource;b.prepare=FE3dRegion_prepare;b.dispose=FE3dRegion_dispose;return b}
function FE3dRegion_construct(){this.__base.FRegion.construct.call(this);this.__base.MG3dRegion.construct.call(this);var b=this._camera=RClass.create(FE3dCamera);b.position().set(0,0,-100);b.lookAt(0,0,0);b.update();b.projection().update();b=this._directionalLight=RClass.create(FE3dDirectionalLight);b.direction().set(0,-1,0);b=b.camera();b.position().set(10,10,-10);b.lookAt(0,0,0);(this._backgroundColor=new SColor4).set(0,0,0,1);this._calculateCameraMatrix=new SMatrix3d}
function FE3dRegion_backgroundColor(){return this._backgroundColor}function FE3dRegion_loadResource(b){this._resource=b;this._camera.loadResource(b.camera());this._directionalLight.loadResource(b.light());this.reloadResource()}function FE3dRegion_reloadResource(){var b=this._resource;b.optionBackground()?(this._backgroundColor.assignPower(b.backgroundColor()),this._backgroundColor.alpha=1):this._backgroundColor.set(0,0,0,0)}
function FE3dRegion_prepare(){this.__base.MG3dRegion.prepare.call(this);this._calculateCameraMatrix.attach(this._camera.matrix())&&(this._changed=!0)}function FE3dRegion_dispose(){this.__base.FRegion.dispose.call(this);this.__base.MG3dRegion.dispose.call(this)}
function FE3dScene(b){b=RClass.inherits(this,b,FE3dSpace,MLinkerResource,MListenerLoad);b._ready=!1;b._dataReady=!1;b._resource=null;b._dirty=!1;b.onProcess=FE3dScene_onProcess;b.construct=FE3dScene_construct;b.createRegion=FE3dScene_createRegion;b.resource=FE3dScene_resource;b.loadTechniqueResource=FE3dScene_loadTechniqueResource;b.loadRegionResource=FE3dScene_loadRegionResource;b.loadDisplayResource=FE3dScene_loadDisplayResource;b.loadLayerResource=FE3dScene_loadLayerResource;b.loadResource=FE3dScene_loadResource;
b.testReady=FE3dScene_testReady;b.dirty=FE3dScene_dirty;b.processLoad=FE3dScene_processLoad;b.active=FE3dScene_active;b.deactive=FE3dScene_deactive;return b}function FE3dScene_onProcess(){this.__base.FE3dSpace.onProcess.call(this);if(this._dirty){for(var b=this._region.allRenderables(),d=b.count()-1;0<=d;d--)b.getAt(d).resetInfos();this._dirty=!1}}function FE3dScene_construct(){this.__base.FE3dSpace.construct.call(this)}function FE3dScene_createRegion(){return RClass.create(FE3dSceneRegion)}
function FE3dScene_resource(b){return this._resource}function FE3dScene_loadTechniqueResource(b){this._technique._resource=b}
function FE3dScene_loadRegionResource(b){this._region.loadResource(b);var d=b.camera(),f=d.projection(),h=this.camera();h._resource=d;var q=h.projection();h.position().assign(d.position());h.setDirection(d.direction().x,d.direction().y,d.direction().z);h.update();q.size().assign(this._graphicContext.size());q._angle=f.angle();q._znear=f.znear();q._zfar=f.zfar();q.update();f=b.light();b=f.camera();d=b.projection();h=this.directionalLight();h._resource=f;f=h._camera;h=f._projection;f.position().set(1,
1,-1);f.lookAt(0,0,0);f.position().assign(b.position());f.update();h.size().set(1024,1024);h._angle=60;h._znear=d.znear();h._zfar=d.zfar();h.update()}function FE3dScene_loadDisplayResource(b,d){var f=RConsole.find(FE3dInstanceConsole).create(EE3dInstance.SceneDisplay);f.linkGraphicContext(this);f.loadResource(d);RConsole.find(FE3dSceneConsole).loadDisplay(f);b.pushDisplay(f)}
function FE3dScene_loadLayerResource(b){var d=RConsole.find(FE3dInstanceConsole).create(EE3dInstance.SceneLayer);d.loadResource(b);var f=b.displays();if(f)for(var h=f.count(),q=0;q<h;q++){var z=f.at(q);this.loadDisplayResource(d,z)}this.registerLayer(b.code(),d)}
function FE3dScene_loadResource(b){this.selectTechnique(this,FE3dGeneralTechnique);this.loadTechniqueResource(b.technique());this.loadRegionResource(b.region());if(b=b.layers())for(var d=b.count(),f=0;f<d;f++){var h=b.at(f);this.loadLayerResource(h)}}function FE3dScene_testReady(){return this._ready}function FE3dScene_dirty(){this._dirty=!0}
function FE3dScene_processLoad(){if(this._dataReady)return!0;if(!this._resource.testReady())return!1;this.loadResource(this._resource);this._ready=!0;this.processLoadListener(this);return!0}function FE3dScene_active(){this.__base.FE3dSpace.active.call(this)}function FE3dScene_deactive(){this.__base.FE3dSpace.deactive.call(this)}
function FE3dSceneAnimation(b){b=RClass.inherits(this,b,FE3dAnimation);b._animation=null;b._activeClip=null;b._clips=null;b.clips=FE3dSceneAnimation_clips;b.pushClip=FE3dSceneAnimation_pushClip;b.record=RMethod.empty;b.process=RMethod.empty;b.selectClip=FE3dSceneAnimation_selectClip;b.loadAnimation=FE3dSceneAnimation_loadAnimation;b.loadSceneResource=FE3dSceneAnimation_loadSceneResource;b.reloadResource=FE3dSceneAnimation_reloadResource;return b}
function FE3dSceneAnimation_clips(){return this._clips}function FE3dSceneAnimation_pushClip(b){var d=this._clips;d||(d=this._clips=new TDictionary);d.set(b.code(),b)}function FE3dSceneAnimation_selectClip(b){b=this._clips.get(b);if(this._activeClip!=b){var d=this._animation._playInfo;d.beginIndex=b.beginIndex();d.endIndex=b.endIndex();d.frameCount=d.endIndex-d.beginIndex+1;this._animation._playRate=b.playRate();this._activeClip=b}}function FE3dSceneAnimation_loadAnimation(b){this._animation=b}
function FE3dSceneAnimation_loadSceneResource(b){this._resource=b}function FE3dSceneAnimation_reloadResource(){this._animation._playRate=this._resource._playRate}
function FE3dSceneAnimationClip(b){b=RClass.inherits(this,b,FObject,MAttributeCode);b._animation=null;b._beginIndex=0;b._endIndex=0;b._playRate=1;b.beginIndex=FE3dSceneAnimationClip_beginIndex;b.endIndex=FE3dSceneAnimationClip_endIndex;b.setRange=FE3dSceneAnimationClip_setRange;b.playRate=FE3dSceneAnimationClip_playRate;b.setPlayRate=FE3dSceneAnimationClip_setPlayRate;return b}function FE3dSceneAnimationClip_beginIndex(){return this._beginIndex}
function FE3dSceneAnimationClip_endIndex(){return this._endIndex}function FE3dSceneAnimationClip_setRange(b,d){this._beginIndex=b;this._endIndex=d}function FE3dSceneAnimationClip_playRate(){return this._playRate}function FE3dSceneAnimationClip_setPlayRate(b){this._playRate=b}
function FE3dSceneCanvas(b){b=RClass.inherits(this,b,FE3dCanvas);b._activeSpace=null;b._captureStatus=!1;b._capturePosition=null;b._captureCameraPosition=null;b._captureCameraRotation=null;b._actionFullScreen=!1;b._actionPlay=!1;b._actionMovie=!1;b._actionUp=!1;b._actionDown=!1;b._actionForward=!1;b._actionBack=!1;b._cameraMoveRate=.4;b._cameraKeyRotation=.03;b._cameraMouseRotation=.005;b.onEnterFrame=FE3dSceneCanvas_onEnterFrame;b.onMouseCaptureStart=FE3dSceneCanvas_onMouseCaptureStart;b.onMouseCapture=
FE3dSceneCanvas_onMouseCapture;b.onMouseCaptureStop=FE3dSceneCanvas_onMouseCaptureStop;b.onTouchStart=FE3dSceneCanvas_onTouchStart;b.onTouchMove=FE3dSceneCanvas_onTouchMove;b.onTouchStop=FE3dSceneCanvas_onTouchStop;b.onDataLoaded=FE3dSceneCanvas_onDataLoaded;b.onResize=FE3dSceneCanvas_onResize;b.construct=FE3dSceneCanvas_construct;b.testPlay=FE3dSceneCanvas_testPlay;b.switchPlay=FE3dSceneCanvas_switchPlay;b.testMovie=FE3dSceneCanvas_testMovie;b.switchMovie=FE3dSceneCanvas_switchMovie;b.doAction=FE3dSceneCanvas_doAction;
b.loadByGuid=FE3dSceneCanvas_loadByGuid;b.loadByCode=FE3dSceneCanvas_loadByCode;b.dispose=FE3dSceneCanvas_dispose;return b}
function FE3dSceneCanvas_onEnterFrame(){var b=this._activeSpace;if(b){var d=b.timer().spanSecond(),f=b.camera(),h=this._cameraMoveRate*d,d=this._cameraKeyRotation*d,q=RKeyboard.isPress(EStageKey.Forward),z=RKeyboard.isPress(EStageKey.Back);(q&&!z||this._actionForward)&&f.doWalk(h);(!q&&z||this._actionBack)&&f.doWalk(-h);q=RKeyboard.isPress(EStageKey.Up);z=RKeyboard.isPress(EStageKey.Down);(q&&!z||this._actionUp)&&f.doFly(h);(!q&&z||this._actionDown)&&f.doFly(-h);h=RKeyboard.isPress(EStageKey.RotationLeft);
q=RKeyboard.isPress(EStageKey.RotationRight);h&&!q&&f.doYaw(d);!h&&q&&f.doYaw(-d);h=RKeyboard.isPress(EStageKey.RotationUp);q=RKeyboard.isPress(EStageKey.RotationDown);h&&!q&&f.doPitch(d);!h&&q&&f.doPitch(-d);f.update();if(this._optionRotation){d=this._rotation;b=b.layers();f=b.count();for(h=0;h<f;h++)q=b.value(h).matrix(),q.setRotation(0,d.y,0),q.update();d.y+=.01}}}
function FE3dSceneCanvas_onMouseCaptureStart(b){var d=this._activeSpace;if(d){var f=this._activeSpace.region();RConsole.find(FG3dTechniqueConsole).find(this._graphicContext,FG3dSelectTechnique).test(f,b.offsetX,b.offsetY);this._capturePosition.set(b.clientX,b.clientY);this._captureCameraRotation.assign(d.camera()._rotation)}}
function FE3dSceneCanvas_onMouseCapture(b){if(this._activeSpace){var d=b.clientX-this._capturePosition.x;b=b.clientY-this._capturePosition.y;var f=this._activeSpace.camera().rotation(),h=this._captureCameraRotation;f.x=h.x+b*this._cameraMouseRotation;f.y=h.y+d*this._cameraMouseRotation}}function FE3dSceneCanvas_onMouseCaptureStop(b){}
function FE3dSceneCanvas_onTouchStart(b){var d=this._activeSpace;if(d){this._activeSpace.region();var f=b.touches;1==f.length&&(b.preventDefault(),b=f[0],this._captureStatus=!0,this._capturePosition.set(b.clientX,b.clientY),this._captureCameraPosition.assign(d.camera().position()),this._captureCameraRotation.assign(d.camera().rotation()))}}
function FE3dSceneCanvas_onTouchMove(b){if(this._captureStatus){var d=b.touches;if(1==d.length){b.preventDefault();b=d[0];var d=this._activeSpace.camera().rotation(),f=b.clientX-this._capturePosition.x;d.x=this._captureCameraRotation.x+-(b.clientY-this._capturePosition.y)*this._cameraMouseRotation;d.y=this._captureCameraRotation.y+-f*this._cameraMouseRotation}}}function FE3dSceneCanvas_onTouchStop(b){this._captureStatus=!1}
function FE3dSceneCanvas_onDataLoaded(b){b=this._activeSpace;var d=this._graphicContext.size(),f=b.camera().projection();f.size().set(d.width,d.height);f.update();d=b._region._resource;this._cameraMoveRate=d.moveSpeed();this._cameraKeyRotation=d.rotationKeySpeed();this._cameraMouseRotation=d.rotationMouseSpeed();d=new SEvent(this);d.space=b;this.processLoadListener(d);d.dispose()}
function FE3dSceneCanvas_onResize(b){this.__base.FE3dCanvas.onResize.call(this,b);b=this._graphicContext.size();var d=this._activeSpace;d&&(d=d.camera().projection(),d.size().set(b.width,b.height),d.update())}function FE3dSceneCanvas_construct(){this.__base.FE3dCanvas.construct.call(this);this._rotation=new SVector3;this._capturePosition=new SPoint2;this._captureCameraPosition=new SPoint3;this._captureCameraRotation=new SVector3}function FE3dSceneCanvas_testPlay(){return this._actionPlay}
function FE3dSceneCanvas_switchPlay(b){for(var d=this._activeSpace.allDisplays(),f=d.count(),h=0;h<f;h++){var q=d.get(h);q._movies&&(q._optionPlay=b)}this._actionPlay=b}function FE3dSceneCanvas_testMovie(){return this._actionMovie}function FE3dSceneCanvas_switchMovie(b){for(var d=this._activeSpace.allDisplays(),f=d.count(),h=0;h<f;h++){var q=d.get(h);q._movies&&(q._optionMovie=b)}this._actionMovie=b}
function FE3dSceneCanvas_doAction(b,d,f){if(this._activeSpace)switch(b.preventDefault(),this._actionBack=this._actionForward=this._actionDown=this._actionUp=!1,d){case "fullscreen":b=this._actionFullScreen=!this._actionFullScreen;RHtml.fullscreen(this._hPanel,b);break;case "play":this.switchMovie(!this._actionMovie);this.switchPlay(this._actionMovie);break;case "up":this._actionUp=f;break;case "down":this._actionDown=f;break;case "forward":this._actionForward=f;break;case "back":this._actionBack=
f}}function FE3dSceneCanvas_loadByGuid(b){var d=RConsole.find(FE3dSceneConsole);this._activeSpace&&d.free(this._activeSpace);b=this._activeSpace=d.allocByGuid(this._graphicContext,b);b.addLoadListener(this,this.onDataLoaded);RStage.register("canvas.space",b)}
function FE3dSceneCanvas_loadByCode(b){var d=RConsole.find(FE3dSceneConsole);this._activeSpace&&d.free(this._activeSpace);b=this._activeSpace=d.allocByCode(this._graphicContext,b);b.addLoadListener(this,this.onDataLoaded);RStage.register("canvas.space",b)}function FE3dSceneCanvas_dispose(){var b=this._rotation;b&&(b.dispose(),this._rotation=null);this.__base.FE3dCanvas.dispose.call(this)}
function FE3dSceneConsole(b){b=RClass.inherits(this,b,FConsole);b._scopeCd=EScope.Local;b._loadDisplays=null;b._loadScenes=null;b._pools=null;b._thread=null;b._interval=100;b.onProcess=FE3dSceneConsole_onProcess;b.construct=FE3dSceneConsole_construct;b.scenes=FE3dSceneConsole_scenes;b.loadDisplay=FE3dSceneConsole_loadDisplay;b.allocByGuid=FE3dSceneConsole_allocByGuid;b.allocByCode=FE3dSceneConsole_allocByCode;b.free=FE3dSceneConsole_free;return b}
function FE3dSceneConsole_onProcess(){var b=this._loadDisplays;for(b.record();b.next();)b.current().processLoad()&&b.removeCurrent();b=this._loadScenes;for(b.record();b.next();)b.current().processLoad()&&b.removeCurrent()}
function FE3dSceneConsole_construct(){this._loadDisplays=new TLooper;this._loadScenes=new TLooper;this._pools=RClass.create(FObjectPools);var b=this._thread=RClass.create(FThread);b.setInterval(this._interval);b.addProcessListener(this,this.onProcess);RConsole.find(FThreadConsole).start(b)}function FE3dSceneConsole_scenes(){return this._scenes}function FE3dSceneConsole_loadDisplay(b){this._loadDisplays.push(b)}
function FE3dSceneConsole_allocByGuid(b,d){var f=this._pools.alloc(d);if(f)return f;var h=RConsole.find(FE3sSceneConsole).loadByGuid(d),f=RClass.create(FE3dScene);f.linkGraphicContext(b);f.setResource(h);f._poolCode=d;f.setup();this._loadScenes.push(f);return f}
function FE3dSceneConsole_allocByCode(b,d){var f=this._pools.alloc(d);if(f)return f;var h=RConsole.find(FE3sSceneConsole).loadByCode(d),f=RClass.create(FE3dScene);f.linkGraphicContext(b);f.setResource(h);f._poolCode=d;f.setup();this._loadScenes.push(f);return f}function FE3dSceneConsole_free(b){this._pools.free(b._poolCode,b)}
function FE3dSceneDisplay(b){b=RClass.inherits(this,b,FE3dSprite,MListenerLoad);b._dataReady=!1;b._optionPlay=!1;b._optionMovie=!1;b._movieMatrix=null;b._resource=null;b._materials=null;b._parentMaterials=null;b._movies=null;b._template=null;b._sprite=null;b.construct=FE3dSceneDisplay_construct;b.meshRenderables=FE3dSceneDisplay_meshRenderables;b.loadResource=FE3dSceneDisplay_loadResource;b.loadTemplate=FE3dSceneDisplay_loadTemplate;b.processLoad=FE3dSceneDisplay_processLoad;b.clone=FE3dSceneDisplay_clone;
return b}function FE3dSceneDisplay_construct(){this.__base.FE3dSprite.construct.call(this);this._movieMatrix=new SMatrix3d}function FE3dSceneDisplay_meshRenderables(){return this._template.sprite().meshRenderables()}
function FE3dSceneDisplay_loadResource(b){var d=RConsole.find(FE3dInstanceConsole);this._resource=b;this._code=b.code();this._matrix.assign(b.matrix());var f=b.movies();if(f)for(var h=f.count(),q=this._movies=new TObjects,z=0;z<h;z++){var A=f.at(z),B=d.create(EE3dInstance.SceneMovie);B.loadResource(A);q.push(B)}if(f=b.materials())for(h=f.count(),q=this._materials=new TDictionary,A=this._parentMaterials=new TDictionary,z=0;z<h;z++){var B=f.at(z),C=d.create(EE3dInstance.SceneMaterial);C._display=this;
C.loadSceneResource(B);q.set(B.guid(),C);A.set(B.parentGuid(),C)}b=b.templateGuid();this._template=RConsole.find(FE3dTemplateConsole).allocByGuid(this,b)}
function FE3dSceneDisplay_loadTemplate(b){var d=this._resource,f=b._sprites;if(f)for(var h=f.count(),q=0;q<h;q++){var z=f.at(q);z.matrix().identity()}f=this._parentMaterials;z=this._sprite=b.sprite();q=z.renderables();h=q.count();for(b=0;b<h;b++){var A=q.at(b),B=A.material(),C=B.guid();if(C=f.get(C))C.loadParent(B),C.reloadResource(),A.setMaterial(C)}this.pushDisplay(z);if(h=z.animations())for(z=h.count(),b=0;b<z;b++)f=h.at(b),A=f.resource(),B=A.guid(),q=d.findAnimation(B),q||(q=d.syncAnimation(B),
q._guid=A._guid,q._code=A._code,q._label=A._label),A=RClass.create(FE3dSceneAnimation),A.loadAnimation(f),A.loadSceneResource(q),A.reloadResource(),this.pushAnimation(A)}function FE3dSceneDisplay_processLoad(){if(this._ready)return!0;var b=this._template;if(!b.testReady())return!1;this.loadTemplate(b);this._ready=!0;this.processLoadListener(this);return!0}function FE3dSceneDisplay_clone(){}
function FE3dSceneDisplayMovie(b){b=RClass.inherits(this,b,FObject);b._resource=null;b._interval=null;b._firstTick=0;b._lastTick=0;b._matrix=new SMatrix3d;b.loadResource=FE3dSceneDisplayMovie_loadResource;b.process=FE3dSceneDisplayMovie_process;return b}function FE3dSceneDisplayMovie_loadResource(b){this._resource=b;this._interval=b._interval;this._matrix.setRotation(b._rotation.x,b._rotation.y*Math.PI/180,b._rotation.z);this._matrix.update()}
function FE3dSceneDisplayMovie_process(b){0==this._firstTick&&(this._firstTick=RTimer.current());0==this._lastTick&&(this._lastTick=RTimer.current());var d=RTimer.current();d-this._lastTick>this._interval&&("rotation"==this._resource.code()&&b.append(this._matrix),this._lastTick=d)}function FE3dSceneDisplayRenderable(b){b=RClass.inherits(this,b,FE3dTemplateRenderable);b.loadMaterial=FE3dSceneDisplayRenderable_loadMaterial;b.reloadResource=FE3dSceneDisplayRenderable_reloadResource;return b}
function FE3dSceneDisplayRenderable_loadMaterial(b){this._materialReference=b;this._material.calculate(b)}function FE3dSceneDisplayRenderable_reloadResource(){var b=this._material;b.calculate(this._materialReference);b.update()}function FE3dSceneLayer(b){b=RClass.inherits(this,b,FDisplayLayer,MLinkerResource);b.makeLabel=FE3dSceneLayer_makeLabel;b.loadResource=FE3dSceneLayer_loadResource;b.process=FE3dSceneLayer_process;return b}
function FE3dSceneLayer_makeLabel(){var b=this.resource(),d=b.code();return(b=b.label())?d+"["+b+"]":d}function FE3dSceneLayer_loadResource(b){this._resource=b}function FE3dSceneLayer_process(b){this.__base.FDisplayLayer.process.call(this,b);var d=this._resource.transformCd();d&&d==EDisplayTransform.CameraPosition&&(b=b.camera().position(),this._matrix.setTranslate(b.x,b.y,b.z),this._matrix.update())}
function FE3dSceneMaterial(b){b=RClass.inherits(this,b,FE3dMaterial);b._display=null;b._parentMaterial=null;b.loadSceneResource=FE3dSceneMaterial_loadSceneResource;b.reloadResource=FE3dSceneMaterial_reloadResource;return b}function FE3dSceneMaterial_loadSceneResource(b){this._resource=b;this.reloadResource()}function FE3dSceneMaterial_reloadResource(){this.calculate(this._resource);this.update()}
function FE3dSceneRegion(b){b=RClass.inherits(this,b,FE3dRegion);b._resource=null;b.construct=FE3dSceneRegion_construct;b.resource=FE3dSceneRegion_resource;b.loadResource=FE3dSceneRegion_loadResource;b.reloadResource=FE3dSceneRegion_reloadResource;b.dispose=FE3dSceneRegion_dispose;return b}function FE3dSceneRegion_construct(){this.__base.FE3dRegion.construct.call(this)}function FE3dSceneRegion_resource(){return this._resource}
function FE3dSceneRegion_loadResource(b){this._resource=b;this.reloadResource()}function FE3dSceneRegion_reloadResource(){var b=this._resource;b.optionBackground()?(this._backgroundColor.assignPower(b.backgroundColor()),this._backgroundColor.alpha=1):this._backgroundColor.set(0,0,0,0)}function FE3dSceneRegion_dispose(){this._resource=null;this.__base.FE3dRegion.dispose.call(this)}
function FE3dSimpleCanvas(b){b=RClass.inherits(this,b,FE3dCanvas);b._activeSpace=null;b._captureStatus=!1;b._capturePosition=null;b._captureCameraPosition=null;b._captureCameraRotation=null;b._actionFullScreen=!1;b._actionPlay=!1;b._actionMovie=!1;b._actionUp=!1;b._actionDown=!1;b._actionForward=!1;b._actionBack=!1;b._cameraMoveRate=.4;b._cameraKeyRotation=.03;b._cameraMouseRotation=.005;b.onEnterFrame=FE3dSimpleCanvas_onEnterFrame;b.onMouseCaptureStart=FE3dSimpleCanvas_onMouseCaptureStart;b.onMouseCapture=
FE3dSimpleCanvas_onMouseCapture;b.onMouseCaptureStop=FE3dSimpleCanvas_onMouseCaptureStop;b.onTouchStart=FE3dSimpleCanvas_onTouchStart;b.onTouchMove=FE3dSimpleCanvas_onTouchMove;b.onTouchStop=FE3dSimpleCanvas_onTouchStop;b.onSceneLoad=FE3dSimpleCanvas_onSceneLoad;b.onResize=FE3dSimpleCanvas_onResize;b.construct=FE3dSimpleCanvas_construct;b.switchPlay=FE3dSimpleCanvas_switchPlay;b.switchMovie=FE3dSimpleCanvas_switchMovie;b.doAction=FE3dSimpleCanvas_doAction;b.dispose=FE3dSimpleCanvas_dispose;return b}
function FE3dSimpleCanvas_onEnterFrame(){var b=this._activeSpace;if(b){var d=b.camera(),f=this._cameraMoveRate,h=this._cameraKeyRotation,q=RKeyboard.isPress(EKeyCode.W),z=RKeyboard.isPress(EKeyCode.S);(q&&!z||this._actionForward)&&d.doWalk(f);(!q&&z||this._actionBack)&&d.doWalk(-f);q=RKeyboard.isPress(EKeyCode.A);z=RKeyboard.isPress(EKeyCode.D);q&&!z&&d.doYaw(h);!q&&z&&d.doYaw(-h);q=RKeyboard.isPress(EKeyCode.Q);z=RKeyboard.isPress(EKeyCode.E);(q&&!z||this._actionUp)&&d.doFly(f);(!q&&z||this._actionDown)&&
d.doFly(-f);f=RKeyboard.isPress(EKeyCode.Z);q=RKeyboard.isPress(EKeyCode.X);f&&!q&&d.doPitch(h);!f&&q&&d.doPitch(-h);d.update();if(this._optionRotation){h=this._rotation;b=b.layers();d=b.count();for(f=0;f<d;f++)q=b.value(f).matrix(),q.setRotation(0,h.y,0),q.update();h.y+=.01}}}function FE3dSimpleCanvas_onMouseCaptureStart(b){var d=this._activeSpace;d&&(this._capturePosition.set(b.clientX,b.clientY),this._captureCameraRotation.assign(d.camera()._rotation))}
function FE3dSimpleCanvas_onMouseCapture(b){if(this._activeSpace){var d=b.clientX-this._capturePosition.x;b=b.clientY-this._capturePosition.y;var f=this._activeSpace.camera().rotation(),h=this._captureCameraRotation;f.x=h.x+b*this._cameraMouseRotation;f.y=h.y+d*this._cameraMouseRotation}}function FE3dSimpleCanvas_onMouseCaptureStop(b){}
function FE3dSimpleCanvas_onTouchStart(b){var d=this._activeSpace;if(d){this._activeSpace.region();var f=b.touches;1==f.length&&(b.preventDefault(),b=f[0],this._captureStatus=!0,this._capturePosition.set(b.clientX,b.clientY),this._captureCameraPosition.assign(d.camera().position()),this._captureCameraRotation.assign(d.camera().rotation()))}}
function FE3dSimpleCanvas_onTouchMove(b){if(this._captureStatus){var d=b.touches;if(1==d.length){b.preventDefault();b=d[0];var d=this._activeSpace.camera().rotation(),f=b.clientX-this._capturePosition.x;d.x=this._captureCameraRotation.x+-(b.clientY-this._capturePosition.y)*this._cameraMouseRotation;d.y=this._captureCameraRotation.y+-f*this._cameraMouseRotation}}}function FE3dSimpleCanvas_onTouchStop(b){this._captureStatus=!1}
function FE3dSimpleCanvas_onSceneLoad(b){b=this._activeSpace;var d=this._graphicContext.size(),f=b.camera().projection();f.size().set(d.width,d.height);f.update();d=b._region._resource;this._cameraMoveRate=d.moveSpeed();this._cameraKeyRotation=d.rotationKeySpeed();this._cameraMouseRotation=d.rotationMouseSpeed();this.processLoadListener(this,b)}
function FE3dSimpleCanvas_onResize(b){this.__base.FE3dCanvas.onResize.call(this,b);b=this._graphicContext.size();var d=this._activeSpace;d&&(d=d.camera().projection(),d.size().set(b.width,b.height),d.update())}function FE3dSimpleCanvas_construct(){this.__base.FE3dCanvas.construct.call(this);this._rotation=new SVector3;this._capturePosition=new SPoint2;this._captureCameraPosition=new SPoint3;this._captureCameraRotation=new SVector3}
function FE3dSimpleCanvas_switchPlay(b){for(var d=this._activeSpace.allDisplays(),f=d.count(),h=0;h<f;h++){var q=d.get(h);q._movies&&(q._optionPlay=b)}this._actionPlay=b}function FE3dSimpleCanvas_switchMovie(b){for(var d=this._activeSpace.allDisplays(),f=d.count(),h=0;h<f;h++){var q=d.get(h);q._movies&&(q._optionMovie=b)}this._actionMovie=b}
function FE3dSimpleCanvas_doAction(b,d,f){if(this._activeSpace)switch(b.preventDefault(),this._actionBack=this._actionForward=this._actionDown=this._actionUp=!1,d){case "fullscreen":b=this._actionFullScreen=!this._actionFullScreen;RHtml.fullscreen(this._hPanel,b);break;case "play":this.switchMovie(!this._actionMovie);this.switchPlay(this._actionMovie);break;case "up":this._actionUp=f;break;case "down":this._actionDown=f;break;case "forward":this._actionForward=f;break;case "back":this._actionBack=
f}}function FE3dSimpleCanvas_dispose(){var b=this._rotation;b&&(b.dispose(),this._rotation=null);this.__base.FE3dCanvas.dispose.call(this)}
function FE3dSimpleStage(b){b=RClass.inherits(this,b,FE3dStage);b._optionKeyboard=!0;b._skyLayer=null;b._mapLayer=null;b._spriteLayer=null;b._faceLayer=null;b.construct=FE3dSimpleStage_construct;b.skyLayer=FE3dSimpleStage_skyLayer;b.mapLayer=FE3dSimpleStage_mapLayer;b.spriteLayer=FE3dSimpleStage_spriteLayer;b.faceLayer=FE3dSimpleStage_faceLayer;b.active=FE3dSimpleStage_active;b.deactive=FE3dSimpleStage_deactive;return b}
function FE3dSimpleStage_construct(){this.__base.FE3dStage.construct.call(this);var b=this._skyLayer=RClass.create(FDisplayLayer);this.registerLayer("SkyLayer",b);b=this._mapLayer=RClass.create(FDisplayLayer);this.registerLayer("MapLayer",b);b=this._spriteLayer=RClass.create(FDisplayLayer);this.registerLayer("SpriteLayer",b);b=this._faceLayer=RClass.create(FDisplayLayer);this.registerLayer("FaceLayer",b)}function FE3dSimpleStage_skyLayer(){return this._skyLayer}
function FE3dSimpleStage_mapLayer(){return this._mapLayer}function FE3dSimpleStage_spriteLayer(){return this._spriteLayer}function FE3dSimpleStage_faceLayer(){return this._faceLayer}function FE3dSimpleStage_active(){this.__base.FE3dStage.active.call(this)}function FE3dSimpleStage_deactive(){this.__base.FE3dStage.deactive.call(this)}
function FE3dSpace(b){b=RClass.inherits(this,b,FE3dStage,MListenerLoad);b._dataReady=!1;b._resource=null;b._materials=null;b._dirty=!1;b.onProcess=FE3dSpace_onProcess;b.construct=FE3dSpace_construct;b.linkGraphicContext=FE3dSpace_linkGraphicContext;b.createRegion=FE3dSpace_createRegion;b.resource=FE3dSpace_resource;b.findMaterial=FE3dSpace_findMaterial;b.materials=FE3dSpace_materials;b.loadTechniqueResource=FE3dSpace_loadTechniqueResource;b.loadRegionResource=FE3dSpace_loadRegionResource;b.loadDisplayResource=
FE3dSpace_loadDisplayResource;b.loadLayerResource=FE3dSpace_loadLayerResource;b.loadResource=FE3dSpace_loadResource;b.commitResource=FE3dSpace_commitResource;b.dirty=FE3dSpace_dirty;b.processLoad=FE3dSpace_processLoad;b.active=FE3dSpace_active;b.deactive=FE3dSpace_deactive;return b}function FE3dSpace_onProcess(){this.__base.FE3dStage.onProcess.call(this);if(this._dirty){for(var b=this._region.allRenderables(),d=b.count()-1;0<=d;d--)b.getAt(d).resetInfos();this._dirty=!1}}
function FE3dSpace_construct(){this.__base.FE3dStage.construct.call(this);this._materials=new TDictionary}function FE3dSpace_linkGraphicContext(b){this.__base.FE3dStage.linkGraphicContext.call(this,b);this._region.linkGraphicContext(b)}function FE3dSpace_createRegion(){return RClass.create(FE3dRegion)}function FE3dSpace_resource(b){return this._resource}function FE3dSpace_findMaterial(b){return this._materials.get(b)}function FE3dSpace_materials(b){return this._materials}
function FE3dSpace_loadTechniqueResource(b){this._technique._resource=b}
function FE3dSpace_loadRegionResource(b){this._region.loadResource(b);var d=b.camera();d.projection();var f=this.camera();f.projection().size().assign(this._graphicContext.size());f.loadResource(d);f=b.light();b=f.camera();var d=b.projection(),h=this.directionalLight();h._resource=f;f=h._camera;h=f._projection;f.position().set(1,1,-1);f.lookAt(0,0,0);f.position().assign(b.position());f.update();h.size().set(1024,1024);h._angle=60;h._znear=d.znear();h._zfar=d.zfar();h.update()}
function FE3dSpace_loadDisplayResource(b,d){var f=RConsole.find(FE3dSpaceConsole).factory().create(EE3dScene.Display);f.linkGraphicContext(this);f.loadSceneResource(d);RConsole.find(FE3dTemplateConsole).loadByGuid(f,d.templateGuid());b.pushDisplay(f)}
function FE3dSpace_loadLayerResource(b){var d=RConsole.find(FE3dSpaceConsole).factory().create(EE3dScene.Layer);d.loadResource(b);var f=b.displays();if(f)for(var h=f.count(),q=0;q<h;q++){var z=f.get(q);this.loadDisplayResource(d,z)}this.registerLayer(b.code(),d)}
function FE3dSpace_loadResource(b){this._resource=b;this.loadTechniqueResource(b.technique());this.loadRegionResource(b.region());var d=b.materials();if(d)for(var f=d.count(),h=RConsole.find(FE3rMaterialConsole),q=0;q<f;q++){var z=d.at(q).guid(),A=h.load(this,z);this._materials.set(z,A)}if(b=b.layers())for(d=b.count(),q=0;q<d;q++)f=b.at(q),this.loadLayerResource(f)}function FE3dSpace_commitResource(){this._region.camera().commitResource()}function FE3dSpace_dirty(){this._dirty=!0}
function FE3dSpace_processLoad(){if(this._dataReady)return!0;if(!this._resource.testReady())return!1;this.loadResource(this._resource);this.processLoadListener(this);return!0}function FE3dSpace_active(){this.__base.FE3dStage.active.call(this)}function FE3dSpace_deactive(){this.__base.FE3dStage.deactive.call(this)}
function FE3dSphere(b){b=RClass.inherits(this,b,FE3dRenderable);b._outline=null;b._splitCount=8;b._vertexPositionBuffer=null;b._vertexColorBuffer=null;b.construct=FE3dSphere_construct;b.splitCount=FE3dSphere_splitCount;b.setSplitCount=FE3dSphere_setSplitCount;b.setup=FE3dSphere_setup;return b}function FE3dSphere_construct(){this.__base.FE3dRenderable.construct.call(this);this._material=RClass.create(FE3dMaterial);this._outline=new SOutline3}
function FE3dSphere_splitCount(){return this._splitCount}function FE3dSphere_setSplitCount(b){this._splitCount=b}
function FE3dSphere_setup(){for(var b=this._graphicContext,d=new TArray,f=new TArray,h=2*this._splitCount,q=this._splitCount,z=2*Math.PI/h,A=Math.PI/q,B=0,C=0;C<=q;C++)for(var D=0;D<h;D++){var E=z*D-Math.PI,F=A*C-RConst.PI_2,G=Math.sin(E)*Math.cos(F),I=Math.sin(F),E=-Math.cos(E)*Math.cos(F);d.push(G,I,E);f.push(G,I,E);B++}this._vertexCount=B;C=this._vertexPositionBuffer=b.createVertexBuffer();C._name="position";C._formatCd=EG3dAttributeFormat.Float3;C.upload(new Float32Array(d.memory()),12,B);this._vertexBuffers.set(C._name,
C);C=this._vertexColorBuffer=b.createVertexBuffer();C._name="normal";C._formatCd=EG3dAttributeFormat.Float3;C.upload(new Float32Array(f.memory()),12,B);this._vertexBuffers.set(C._name,C);d=new TArray;for(C=0;C<q;C++)for(D=0;D<h;D++)f=h*C,B=f+D,z=f+D+h,D==h-1?(d.push(B,z,f),d.push(z,f+h,f)):(d.push(B,z,B+1),d.push(z,z+1,B+1));(this._indexBuffer=b.createIndexBuffer()).upload(new Uint16Array(d.memory()),d.length());this.update();b=this.material().info();b.ambientColor.set(.2,.2,.2,1);b.diffuseColor.set(.8,
.8,.8,1);b.specularColor.set(.8,.8,.8,1);b.specularLevel=64}
function FE3dSprite(b){b=RClass.inherits(this,b,FE3dDisplayContainer,MGraphicObject,MLinkerResource);b._dataReady=!1;b._ready=!1;b._shapes=null;b._skeletons=null;b._animations=null;b._resource=null;b.construct=FE3dSprite_construct;b.testReady=FE3dSprite_testReady;b.makeLabel=FE3dSprite_makeLabel;b.findMeshByCode=FE3dSprite_findMeshByCode;b.meshRenderables=FE3dSprite_shapes;b.skeletons=FE3dSprite_skeletons;b.pushSkeleton=FE3dSprite_pushSkeleton;b.findAnimation=FE3dSprite_findAnimation;b.animations=
FE3dSprite_animations;b.pushAnimation=FE3dSprite_pushAnimation;b.loadSkeletons=FE3dSprite_loadSkeletons;b.linkAnimation=FE3dSprite_linkAnimation;b.loadAnimations=FE3dSprite_loadAnimations;b.loadResource=FE3dSprite_loadResource;b.reloadResource=FE3dSprite_reloadResource;b.load=FE3dSprite_load;b.updateMatrix=FE3dSprite_updateMatrix;b.selectClip=FE3dSprite_selectClip;b.process=FE3dSprite_process;b.dispose=FE3dSprite_dispose;return b}
function FE3dSprite_construct(){this.__base.FE3dDisplayContainer.construct.call(this);this._shapes=new TObjects}function FE3dSprite_testReady(){var b=this._shapes;if(b)for(var d=b.count(),f=0;f<d;f++)if(!b.at(f).testReady())return!1;return!0}function FE3dSprite_makeLabel(){var b=this.resource(),d=b.code();return(b=b.label())?d+"["+b+"]":d}function FE3dSprite_findMeshByCode(b){for(var d=this._shapes,f=d.count()-1;0<=f;f--){var h=d.getAt(f);if(h._renderable._resource._code==b)return h}return null}
function FE3dSprite_shapes(){return this._shapes}function FE3dSprite_skeletons(){return this._skeletons}function FE3dSprite_pushSkeleton(b){var d=this._skeletons;d||(d=this._skeletons=new TDictionary);this._activeSkeleton||(this._activeSkeleton=b);d.set(b._resource.guid(),b)}function FE3dSprite_findAnimation(b){var d=this._animations;return d?d.get(b):null}function FE3dSprite_animations(){return this._animations}
function FE3dSprite_pushAnimation(b){var d=this._animations;d||(d=this._animations=new TDictionary);var f=b.resource();d.set(f.guid(),b)}function FE3dSprite_loadSkeletons(b){var d=b.count();if(0<d){this.skeletons();for(var f=0;f<d;f++){var h=b.getAt(f),q=RClass.create(FE3rSkeleton);q.loadResource(h);this.pushSkeleton(q)}}}function FE3dSprite_linkAnimation(b){b=b.tracks();for(var d=b.count(),f=0;f<d;f++){var h=b.getAt(f),q=h._resource._meshCode;q&&(this.findMeshByCode(q)._activeTrack=h)}}
function FE3dSprite_loadAnimations(b){var d=b.count();if(0<d)for(var f=0;f<d;f++){var h=b.getAt(f),q=this.findAnimation(h.guid());q||(q=h.skeleton()?RClass.create(FE3rSkeletonAnimation):RClass.create(FE3rMeshAnimation),q._display=this,q.loadResource(h),this.pushAnimation(q))}}
function FE3dSprite_loadResource(b){this._resource=b;this._matrix.assign(b.matrix());b=b.renderables();var d=b.count();if(0<d)for(var f=this._shapes,h=0;h<d;h++){var q=b.at(h),z=RClass.create(FE3dTemplateRenderable);z._display=this;z.linkGraphicContext(this);z.loadResource(q);f.push(z);this.pushRenderable(z)}}function FE3dSprite_reloadResource(){var b=this._shapes;if(b)for(var d=b.count(),f=0;f<d;f++)b.getAt(f).reloadResource()}
function FE3dSprite_load(){var b=this._shapes;if(b)for(var d=b.count(),f=0;f<d;f++)b.at(f).load()}function FE3dSprite_updateMatrix(b){b=this._currentMatrix.identity();var d=this._movies;if(d){if(this._optionMovie)for(var f=d.count(),h=0;h<f;h++)d.at(h).process(this._movieMatrix);b.append(this._movieMatrix)}b.append(this._matrix);(b=this._parent)&&this._currentMatrix.append(b._currentMatrix)}
function FE3dSprite_selectClip(b){var d=this._animations;if(d)for(var f=d.count(),h=0;h<f;h++)d.at(h).selectClip(b)}function FE3dSprite_process(b){var d=this._animations;if(d)for(var f=d.count(),h=0;h<f;h++){var q=d.at(h);q.record()}this.__base.FE3dDisplayContainer.process.call(this,b);if((b=this._activeSkeleton)&&d)for(f=d.count(),h=0;h<f;h++)q=d.at(h),q.process(b)}function FE3dSprite_dispose(){this._shapes=RObject.dispose(this._shapes);this.__base.FE3dDisplayContainer.dispose.call(this)}
function FE3dTemplate(b){b=RClass.inherits(this,b,FE3dSpace,MGraphicObject,MListenerLoad);b._dataReady=!1;b._ready=!1;b._resource=null;b._sprites=null;b._skeletons=null;b._animations=null;b._resource=null;b.construct=FE3dTemplate_construct;b.testReady=FE3dTemplate_testReady;b.sprite=FE3dTemplate_sprite;b.findMeshByCode=FE3dTemplate_findMeshByCode;b.meshRenderables=FE3dTemplate_sprites;b.skeletons=FE3dTemplate_skeletons;b.pushSkeleton=FE3dTemplate_pushSkeleton;b.findAnimation=FE3dTemplate_findAnimation;
b.animations=FE3dTemplate_animations;b.pushAnimation=FE3dTemplate_pushAnimation;b.visible=FE3dTemplate_visible;b.setVisible=FE3dTemplate_setVisible;b.resource=FE3dTemplate_resource;b.setResource=FE3dTemplate_setResource;b.loadSkeletons=FE3dTemplate_loadSkeletons;b.linkAnimation=FE3dTemplate_linkAnimation;b.loadAnimations=FE3dTemplate_loadAnimations;b.loadResource=FE3dTemplate_loadResource;b.reloadResource=FE3dTemplate_reloadResource;b.processLoad=FE3dTemplate_processLoad;b.process=FE3dTemplate_process;
b.dispose=FE3dTemplate_dispose;return b}function FE3dTemplate_construct(){this.__base.FE3dSpace.construct.call(this);var b=this._layer=RClass.create(FDisplayLayer);this.registerLayer("Layer",b);this._sprites=new TObjects}function FE3dTemplate_testReady(){return this._ready}function FE3dTemplate_sprite(){return this._sprites.first()}function FE3dTemplate_findMeshByCode(b){for(var d=this._sprites,f=d.count()-1;0<=f;f--){var h=d.getAt(f);if(h._renderable._resource._code==b)return h}return null}
function FE3dTemplate_sprites(){return this._sprites}function FE3dTemplate_skeletons(){return this._skeletons}function FE3dTemplate_pushSkeleton(b){var d=this._skeletons;d||(d=this._skeletons=new TDictionary);this._activeSkeleton||(this._activeSkeleton=b);d.set(b._resource.guid(),b)}function FE3dTemplate_findAnimation(b){var d=this._animations;return d?d.get(b):null}function FE3dTemplate_animations(){return this._animations}
function FE3dTemplate_pushAnimation(b){var d=this._animations;d||(d=this._animations=new TDictionary);var f=b.resource();d.set(f.guid(),b)}function FE3dTemplate_visible(){return this.sprite().visible()}function FE3dTemplate_setVisible(b){this.sprite().setVisible(b)}function FE3dTemplate_resource(b){return this._resource}function FE3dTemplate_setResource(b){this._resource=b}
function FE3dTemplate_loadSkeletons(b){var d=b.count();if(0<d){this.skeletons();for(var f=0;f<d;f++){var h=b.getAt(f),q=RClass.create(FE3rSkeleton);q.loadResource(h);this.pushSkeleton(q)}}}function FE3dTemplate_linkAnimation(b){b=b.tracks();for(var d=b.count(),f=0;f<d;f++){var h=b.getAt(f),q=h._resource._meshCode;q&&(this.findMeshByCode(q)._activeTrack=h)}}
function FE3dTemplate_loadAnimations(b){var d=b.count();if(0<d)for(var f=0;f<d;f++){var h=b.getAt(f),q=this.findAnimation(h.guid());q||(q=h.skeleton()?RClass.create(FE3rSkeletonAnimation):RClass.create(FE3rMeshAnimation),q._display=this,q.loadResource(h),this.pushAnimation(q))}}
function FE3dTemplate_loadResource(b){this.selectTechnique(this,FE3dGeneralTechnique).setResource(b.technique());this.__base.FE3dSpace.loadResource.call(this,b);if(b=b.displays()){var d=b.count();if(0<d)for(var f=0;f<d;f++){var h=b.at(f),q=RClass.create(FE3dTemplateDisplay);q._parent=this;q.linkGraphicContext(this);q.loadResource(h);this._sprites.push(q)}}}function FE3dTemplate_reloadResource(){var b=this._sprites;if(b)for(var d=b.count(),f=0;f<d;f++)b.getAt(f).reloadResource()}
function FE3dTemplate_processLoad(){if(this._ready)return!0;if(!this._dataReady){var b=this._resource;if(!b.testReady())return!1;this.loadResource(b);this._dataReady=!0}var d=this._sprites;if(d){for(var f=d.count(),b=0;b<f;b++){var h=d.at(b);if(!h.testReady())return!1}for(b=0;b<f;b++)h=d.at(b),h.load(),this._layer.pushDisplay(h)}if(d=this._animations)for(f=d.count(),b=0;b<f;b++)h=d.at(b),null==h.resource().skeleton()&&this.linkAnimation(h);this._ready=!0;this.processLoadListener(this);return this._ready}
function FE3dTemplate_process(b){this.__base.FE3dSpace.process.call(this)}function FE3dTemplate_dispose(){this._sprites=RObject.dispose(this._sprites);this.__base.FE3dSpace.dispose.call(this)}
function FE3dTemplateCanvas(b){b=RClass.inherits(this,b,FE3dCanvas);b._activeTemplate=null;b._capturePosition=null;b._captureRotation=null;b.onEnterFrame=FDsSceneCanvas_onEnterFrame;b.onMouseCaptureStart=FE3dTemplateCanvas_onMouseCaptureStart;b.onMouseCapture=FE3dTemplateCanvas_onMouseCapture;b.onMouseCaptureStop=FE3dTemplateCanvas_onMouseCaptureStop;b.onResize=FE3dTemplateCanvas_onResize;b.onTemplateLoad=FE3dTemplateCanvas_onTemplateLoad;b.construct=FE3dTemplateCanvas_construct;b.build=FE3dTemplateCanvas_build;
b.load=FE3dTemplateCanvas_load;b.setPanel=FE3dTemplateCanvas_setPanel;b.dispose=FE3dTemplateCanvas_dispose;return b}
function FE3dTemplateCanvas_onEnterFrame(){var b=this._activeTemplate;if(b){var d=b.camera(),f=.05,h=RKeyboard.isPress(EKeyCode.W),q=RKeyboard.isPress(EKeyCode.S);h&&!q&&d.doWalk(.5);!h&&q&&d.doWalk(-.5);h=RKeyboard.isPress(EKeyCode.A);q=RKeyboard.isPress(EKeyCode.D);h&&!q&&d.doYaw(f);!h&&q&&d.doYaw(-f);h=RKeyboard.isPress(EKeyCode.Q);q=RKeyboard.isPress(EKeyCode.E);h&&!q&&d.doFly(.5);!h&&q&&d.doFly(-.5);q=RKeyboard.isPress(EKeyCode.Z);h=RKeyboard.isPress(EKeyCode.X);q&&!h&&d.doPitch(f);!q&&h&&d.doPitch(-f);
d.update();if(this._optionRotation){f=this._rotation;b=b.layers();d=b.count();for(h=0;h<d;h++)q=b.value(h).matrix(),q.setRotation(0,f.y,0),q.update();f.y+=.01}}}function FE3dTemplateCanvas_onMouseCaptureStart(b){var d=this._activeTemplate;if(d){var f=this._activeTemplate.region();RConsole.find(FG3dTechniqueConsole).find(this._context,FG3dSelectTechnique).test(f,b.offsetX,b.offsetY);this._capturePosition.set(b.clientX,b.clientY);this._captureRotation.assign(d.camera()._rotation)}}
function FE3dTemplateCanvas_onMouseCapture(b){if(this._activeTemplate){var d=b.clientX-this._capturePosition.x;b=b.clientY-this._capturePosition.y;var f=this._activeTemplate.camera().rotation(),h=this._captureRotation;f.x=h.x+.003*b;f.y=h.y+.003*d}}function FE3dTemplateCanvas_onMouseCaptureStop(b){}function FE3dTemplateCanvas_onResize(){var b=this._hPanel,d=b.offsetWidth,b=b.offsetHeight,f=this._hCanvas;f.width=d;f.height=b;this._context.setViewport(0,0,d,b)}
function FE3dTemplateCanvas_onTemplateLoad(b){b=this._activeTemplate;var d=this._context.size(),f=b.camera().projection();f.size().set(d.width,d.height);f.update();this.processLoadListener(this,b)}function FE3dTemplateCanvas_construct(){this.__base.FObject.construct.call(this);this._rotation=new SVector3;this._capturePosition=new SPoint2;this._captureRotation=new SVector3}
function FE3dTemplateCanvas_build(b){b=this._hCanvas=RBuilder.create(b,"CANVAS");b.__linker=this;this._context=REngine3d.createContext(FWglContext,b);RStage.lsnsEnterFrame.register(this,this.onEnterFrame);RStage.start(1E3/60);RWindow.lsnsResize.register(this,this.onResize);RConsole.find(FMouseConsole).register(this)}
function FE3dTemplateCanvas_load(b){var d=this._context,f=RConsole.find(FE3dSceneConsole);null!=this._activeTemplate&&f.free(this._activeTemplate);b=f.alloc(this._context,b);b.addLoadListener(this,this.onTemplateLoad);b.selectTechnique(d,FG3dGeneralTechnique);this._stage=this._activeTemplate=b;RStage.register("stage3d",b)}function FE3dTemplateCanvas_setPanel(b){this._hPanel=b;b.appendChild(this._hCanvas);this.onResize()}
function FE3dTemplateCanvas_dispose(){var b=this._rotation;b&&(b.dispose(),this._rotation=null);this.__base.FObject.dispose.call(this)}
function FE3dTemplateConsole(b){b=RClass.inherits(this,b,FConsole);b._scopeCd=EScope.Local;b._loadQueue=null;b._pools=null;b._thread=null;b._interval=200;b.onProcess=FE3dTemplateConsole_onProcess;b.construct=FE3dTemplateConsole_construct;b.allocByGuid=FE3dTemplateConsole_allocByGuid;b.allocByCode=FE3dTemplateConsole_allocByCode;b.free=FE3dTemplateConsole_free;return b}
function FE3dTemplateConsole_onProcess(){var b=this._loadQueue;for(b.record();b.next();)b.current().processLoad()&&b.removeCurrent()}function FE3dTemplateConsole_construct(){this._loadQueue=new TLooper;this._pools=RClass.create(FObjectPools);var b=this._thread=RClass.create(FThread);b.setInterval(this._interval);b.addProcessListener(this,this.onProcess);RConsole.find(FThreadConsole).start(b)}
function FE3dTemplateConsole_allocByGuid(b,d){var f=this._pools.alloc(d);if(f)return f;var h=RConsole.find(FE3sTemplateConsole).loadByGuid(d),f=RClass.create(FE3dTemplate);f.linkGraphicContext(b);f.setResource(h);f._poolCode=d;this._loadQueue.push(f);return f}
function FE3dTemplateConsole_allocByCode(b,d){var f=this._pools.alloc(d);if(f)return f;var h=RConsole.find(FE3sTemplateConsole).loadByCode(d),f=RClass.create(FE3dTemplate);f.linkGraphicContext(b);f.setResource(h);f._poolCode=d;this._loadQueue.push(f);return f}function FE3dTemplateConsole_free(b){this._pools.free(b._poolCode,b)}
function FE3dTemplateDisplay(b){b=RClass.inherits(this,b,FE3dSprite,MListenerLoad);b._dataReady=!1;b._ready=!1;b._shapes=null;b._skeletons=null;b.construct=FE3dTemplateDisplay_construct;b.testReady=FE3dTemplateDisplay_testReady;b.findMeshByCode=FE3dTemplateDisplay_findMeshByCode;b.meshRenderables=FE3dTemplateDisplay_shapes;b.skeletons=FE3dTemplateDisplay_skeletons;b.pushSkeleton=FE3dTemplateDisplay_pushSkeleton;b.loadSkeletons=FE3dTemplateDisplay_loadSkeletons;b.linkAnimation=FE3dTemplateDisplay_linkAnimation;
b.loadAnimations=FE3dTemplateDisplay_loadAnimations;b.loadResource=FE3dTemplateDisplay_loadResource;b.reloadResource=FE3dTemplateDisplay_reloadResource;b.load=FE3dTemplateDisplay_load;b.dispose=FE3dTemplateDisplay_dispose;return b}function FE3dTemplateDisplay_construct(){this.__base.FE3dSprite.construct.call(this);this._shapes=new TObjects}function FE3dTemplateDisplay_testReady(){var b=this._shapes;if(b)for(var d=b.count(),f=0;f<d;f++)if(!b.at(f).testReady())return!1;return!0}
function FE3dTemplateDisplay_findMeshByCode(b){for(var d=this._shapes,f=d.count()-1;0<=f;f--){var h=d.getAt(f);if(h._renderable._resource._code==b)return h}return null}function FE3dTemplateDisplay_shapes(){return this._shapes}function FE3dTemplateDisplay_skeletons(){return this._skeletons}function FE3dTemplateDisplay_pushSkeleton(b){var d=b.resource().guid(),f=this._skeletons;f||(f=this._skeletons=new TDictionary);this._activeSkeleton||(this._activeSkeleton=b);f.set(d,b)}
function FE3dTemplateDisplay_loadSkeletons(b){var d=b.count();if(0<d)for(var f=0;f<d;f++){var h=b.at(f),q=RClass.create(FE3rSkeleton);q.loadResource(h);this.pushSkeleton(q)}}function FE3dTemplateDisplay_linkAnimation(b){b=b.tracks();for(var d=b.count(),f=0;f<d;f++){var h=b.at(f),q=h._resource._meshCode;q&&(this.findMeshByCode(q)._activeTrack=h)}}
function FE3dTemplateDisplay_loadAnimations(b){for(var d=b.count(),f=0;f<d;f++){var h=b.at(f),q=h.guid(),q=this.findAnimation(q);q||(q=h.skeleton()?RClass.create(FE3rSkeletonAnimation):RClass.create(FE3rMeshAnimation),q._display=this,q.loadResource(h),this.pushAnimation(q))}}
function FE3dTemplateDisplay_loadResource(b){this._resource=b;var d=RConsole.find(FE3dInstanceConsole);this._matrix.assign(b.matrix());if(b=b.renderables())for(var f=this._shapes,h=b.count(),q=0;q<h;q++){var z=b.at(q),A=d.create(EE3dInstance.TemplateRenderable);A._display=this;A.linkGraphicContext(this);A.loadResource(z);f.push(A);this.pushRenderable(A)}}function FE3dTemplateDisplay_reloadResource(){var b=this._shapes;if(b)for(var d=b.count(),f=0;f<d;f++)b.getAt(f).reloadResource()}
function FE3dTemplateDisplay_load(){var b=this._shapes;if(b)for(var d=b.count(),f=0;f<d;f++)b.at(f).load();if(b=this._animations)for(d=b.count(),f=0;f<d;f++){var h=b.at(f);null==h.resource().skeleton()&&this.linkAnimation(h)}}function FE3dTemplateDisplay_dispose(){this._shapes=RObject.dispose(this._shapes);this.__base.FE3dSprite.dispose.call(this)}
function FE3dTemplateRenderable(b){b=RClass.inherits(this,b,FE3dMeshRenderable,MLinkerResource);b._ready=!1;b._model=null;b._materialCode=null;b._materialResource=null;b.construct=FE3dTemplateRenderable_construct;b.testReady=FE3dTemplateRenderable_testReady;b.testVisible=FE3dTemplateRenderable_testVisible;b.loadResource=FE3dTemplateRenderable_loadResource;b.reloadResource=FE3dTemplateRenderable_reloadResource;b.load=FE3dTemplateRenderable_load;b.dispose=FE3dTemplateRenderable_dispose;return b}
function FE3dTemplateRenderable_construct(){this.__base.FE3dMeshRenderable.construct.call(this)}function FE3dTemplateRenderable_testReady(){if(!this._ready){if(!this._model.testReady())return!1;var b=this._materials;if(b)for(var d=b.count(),f=0;f<d;f++){var h=b.at(f);if(h&&!h.testReady())return!1}this._ready=!0}return this._ready}function FE3dTemplateRenderable_testVisible(b){b=!1;this._ready&&(b=this.__base.FE3dMeshRenderable.testVisible.call(this));return b}
function FE3dTemplateRenderable_loadResource(b){this._resource=b;this._matrix.assign(b.matrix());var d=b.modelGuid();this._model=RConsole.find(FE3rModelConsole).load(this,d);var f=b.materialGuid();RString.isEmpty(f)||(f=this._material=this._materialReference=RConsole.find(FE3rMaterialConsole).load(this,f),this._materialResource=f.resource(),this.pushMaterial(f));d=this._display._parent;if(b=b.materialRefers())for(var h=b.count(),q=0;q<h;q++)f=b.at(q).guid(),f=d.findMaterial(f),this.pushMaterial(f),
this._material=f;this._material||(this._material=this._materialReference=RClass.create(FE3dMaterial))}function FE3dTemplateRenderable_reloadResource(){var b=this._material;b.calculate(this._materialResource);b.update()}
function FE3dTemplateRenderable_load(){var b=this._display,d=this._resource,f=d.model(),h=this._material.bitmaps();if(h)for(var q=h.count(),z=0;z<q;z++){var A=h.at(z);this.pushTexture(A)}(z=f.skeletons())&&b.loadSkeletons(z);(z=f.animations())&&b.loadAnimations(z);d.mesh();z=d.meshGuid();d=this._renderable=RConsole.find(FE3rModelConsole).findMesh(z);f=d.vertexBuffers();h=f.count();for(z=0;z<h;z++)q=f.at(z),this._vertexBuffers.set(q._name,q);if(z=d.skins()){b=b._activeSkeleton;d=this._activeSkin=z.first();
f=d.streams();h=f.count();for(z=0;z<h;z++)q=f.at(z).buffer(),this._vertexBuffers.set(q._name,q);d=d.resource().boneRefers();f=d.count();if(0<f)for(h=this._bones=new TObjects,z=0;z<f;z++){q=d.at(z).index();q=b.bones().get(q);if(!q)throw new TError(this,"Bone is not exist.");h.push(q)}}this._ready=!0}function FE3dTemplateRenderable_dispose(){this.__base.FE3dMeshRenderable.dispose.call(this)}function FGameObject(b){return b=RClass.inherits(this,b,FObject)}
function FGmTemplateObject(b){return b=RClass.inherits(this,b,FObject)}var EGmEntityAction=new function(){this.Unknown=0;this.ClipPlay=1;this.Move=2;this.Rotation=3;this.Scale=4;return this},EGmEntityClipAction=new function(){this.Unknown=0;this.Play=1;this.Reset=2;return this};function SGmEntityClipAction(){this.typeCd=EGmEntityClipAction.Play;this.code=null;this.count=0;this.optionReset=this.optionForce=!1;return this}
function FGmEntity(b){b=RClass.inherits(this,b,FComponent);b._location=null;b._rotation=null;b._scale=null;b._controllers=null;b._displays=null;b.construct=FGmEntity_construct;b.location=FGmEntity_location;b.rotation=FGmEntity_rotation;b.scale=FGmEntity_scale;b.findController=FGmEntity_findController;b.hasDisplay=FGmEntity_hasDisplay;b.findDisplay=FGmEntity_findDisplay;b.displays=FGmEntity_displays;b.pushDisplay=FGmEntity_pushDisplay;b.removeDisplay=FGmEntity_removeDisplay;b.selectClip=FGmEntity_selectClip;
b.update=FGmEntity_update;b.process=FGmEntity_process;b.dispose=FGmEntity_dispose;return b}function FGmEntity_construct(){this.__base.FComponent.construct.call(this);this._location=new SPoint3(0,0,0);this._rotation=new SVector3(0,0,0);this._scale=new SVector3(1,1,1);this._controllers=new TDictionary}function FGmEntity_location(){return this._location}function FGmEntity_rotation(){return this._rotation}function FGmEntity_scale(){return this._scale}
function FGmEntity_findController(b){var d=RClass.name(b),f=this._controllers.get(d);f||(f=RClass.create(b),f.linkEntity(this),this._controllers.set(d,f));return f}function FGmEntity_hasDisplay(){var b=this._displays;return b?!b.isEmpty():!1}function FGmEntity_findDisplay(b){var d=this._displays;if(d)for(var f=d.count(),h=0;h<f;h++){var q=d.at(h);if(q.code()==b)return q}return null}function FGmEntity_displays(){return this._displays}
function FGmEntity_pushDisplay(b){var d=this._displays;d||(d=this._displays=new TObjects);d.push(b)}function FGmEntity_removeDisplay(b){this._displays.remove(b)}function FGmEntity_selectClip(b){var d=this._displays;if(d)for(var f=d.count(),h=0;h<f;h++)d.at(h).selectClip(b)}function FGmEntity_update(){var b=this._location,d=this._rotation,f=this._scale,h=this._displays;if(h)for(var q=h.count(),z=0;z<q;z++){var A=h.at(z).matrix();A.setAll(b.x,b.z,b.y,d.x,d.z,d.y,f.x,f.z,f.y);A.update()}}
function FGmEntity_process(){}function FGmEntity_dispose(){this._location=RObject.dispose(this._location);this._rotation=RObject.dispose(this._rotation);this._scale=RObject.dispose(this._scale);this.__base.FComponent.dispose.call(this)}
function FGmEntityClipController(b){b=RClass.inherits(this,b,FGmEntityController);b._queue=null;b.construct=FGmEntityClipController_construct;b.play=FGmEntityClipController_play;b.process=FGmEntityClipController_process;b.dispose=FGmEntityClipController_dispose;return b}function FGmEntityClipController_construct(){this.__base.FGmEntityController.construct.call(this);this._queue=new TObjects}function FGmEntityClipController_play(b){this._queue.push(b)}
function FGmEntityClipController_process(){this.__base.FGmEntityController.process.call(this)}function FGmEntityClipController_dispose(){this.__base.FGmEntityController.dispose.call(this)}function FGmEntityController(b){b=RClass.inherits(this,b,FComponent);b._entity=null;b.construct=FGmEntityController_construct;b.linkEntity=FGmEntityController_linkEntity;b.process=FGmEntityController_process;b.dispose=FGmEntityController_dispose;return b}
function FGmEntityController_construct(){this.__base.FComponent.construct.call(this)}function FGmEntityController_linkEntity(b){this._entity=b}function FGmEntityController_process(){}function FGmEntityController_dispose(){this.__base.FComponent.dispose.call(this)}function FGmEntityMoveController(b){b=RClass.inherits(this,b,FGmEntityController);b.construct=FGmEntityMoveController_construct;b.dispose=FGmEntityMoveController_dispose;return b}
function FGmEntityMoveController_construct(){this.__base.FGmEntityController.construct.call(this)}function FGmEntityMoveController_dispose(){this.__base.FGmEntityController.dispose.call(this)}function FGmNpcEntity(b){b=RClass.inherits(this,b,FGmSpriteEntity);b.construct=FGmNpcEntity_construct;b.dispose=FGmNpcEntity_dispose;return b}function FGmNpcEntity_construct(){this.__base.FGmSpriteEntity.construct.call(this)}function FGmNpcEntity_dispose(){this.__base.FGmSpriteEntity.dispose.call(this)}
function FGmPlayerEntity(b){b=RClass.inherits(this,b,FGmRoleEntity);b.construct=FGmPlayerEntity_construct;b.dispose=FGmPlayerEntity_dispose;return b}function FGmPlayerEntity_construct(){this.__base.FGmRoleEntity.construct.call(this)}function FGmPlayerEntity_dispose(){this.__base.FGmRoleEntity.dispose.call(this)}function FGmRoleEntity(b){b=RClass.inherits(this,b,FGmNpcEntity);b.construct=FGmRoleEntity_construct;b.dispose=FGmRoleEntity_dispose;return b}
function FGmRoleEntity_construct(){this.__base.FGmNpcEntity.construct.call(this)}function FGmRoleEntity_dispose(){this.__base.FGmNpcEntity.dispose.call(this)}
function FGmSpriteEntity(b){b=RClass.inherits(this,b,FGmEntity);b._birthLocation=null;b._targetLocation=null;b._targetDirection=null;b._targetScale=null;b._moveInterval=25;b._moveLastTick=0;b._moveSpeed=1;b.construct=FGmSpriteEntity_construct;b.moveForward=FGmSpriteEntity_moveForward;b.moveRotation=FGmSpriteEntity_moveRotation;b.dispose=FGmSpriteEntity_dispose;return b}
function FGmSpriteEntity_construct(){this.__base.FGmEntity.construct.call(this);this._targetLocation=new SPoint3(0,0,0);this._targetDirection=new SVector3(0,-1,0);this._scale=new SVector3(1,1,1)}function FGmEntity_setTargetDirection(b,d,f){var h=this._targetDirection;h.set(b,d,f);h.normalize()}function FGmSpriteEntity_moveForward(b){this._location.x+=this._targetDirection.x*b;this._location.y+=this._targetDirection.y*b;this._location.z+=this._targetDirection.z*b}
function FGmSpriteEntity_moveRotation(b){this._rotation.z+=b;b=this._rotation.z+Math.PI;var d=this._targetDirection;d.x=Math.sin(b);d.y=Math.cos(b)}function FGmSpriteEntity_dispose(){this._targetLocation=RObject.dispose(this._targetLocation);this._targetDirection=RObject.dispose(this._targetDirection);this._targetScale=RObject.dispose(this._targetScale);this.__base.FGmEntity.dispose.call(this)}
function FGmStillEntity(b){b=RClass.inherits(this,b,FGmEntity);b.construct=FGmStillEntity_construct;b.dispose=FGmStillEntity_dispose;return b}function FGmStillEntity_construct(){this.__base.FGmEntity.construct.call(this)}function FGmStillEntity_dispose(){this.__base.FGmEntity.dispose.call(this)}function FGmSceneObject(b){return b=RClass.inherits(this,b,FObject)}function FGmStageObject(b){return b=RClass.inherits(this,b,FObject)}
function AEvent(b,d,f){AAnnotation.call(this,b);this._annotationCd=EAnnotation.Event;this._logger=this._inherit=!0;this._linker=d;this._handle=f;this._process=null;this.linker=AEvent_linker;this.handle=AEvent_handle;this.value=AEvent_value;this.create=AEvent_create;this.attach=RMethod.empty;this.bind=AEvent_bind;this.toString=AEvent_toString;return this}function AEvent_linker(){return this._linker}function AEvent_handle(){return this._handle}function AEvent_value(){return this._process}
function AEvent_create(){return new SEvent}function AEvent_bind(b,d){d?b.addEventListener(this._linker,RUiEvent.ohEvent,!0):b[this._handle]=RUiEvent.ohEvent}function AEvent_toString(){return"linker="+this._linker+",handle="+this._handle}function AEventBlur(b,d){AEvent.call(this,b,"blur","onblur");this.attach=AEventBlur_attach;return this}function AEventBlur_attach(b,d){}function AEventChange(b){AEvent.call(this,b,"change","onchange");this.attach=AEventChange_attach;return this}
function AEventChange_attach(b,d){}function AEventClick(b){AEvent.call(this,b,"click","onclick");this.attach=AEventClick_attach;return this}function AEventClick_attach(b,d){b.altKey=d.altKey;b.ctrlKey=d.ctrlKey;b.shiftKey=d.shiftKey}function AEventDoubleClick(b){AEvent.call(this,b,"dblclick","ondblclick");this.attach=AEventDoubleClick_attach;return this}function AEventDoubleClick_attach(b,d){b.altKey=d.altKey;b.ctrlKey=d.ctrlKey;b.shiftKey=d.shiftKey}
function AEventFocus(b){AEvent.call(this,b,"focus","onfocus");this.attach=AEventFocus_attach;return this}function AEventFocus_attach(b,d){}function AEventInputChanged(b){AEvent.call(this,b,"input","oninput");this.attach=AEventInputChanged_attach;this.bind=AEventInputChanged_bind;return this}function AEventInputChanged_attach(b,d){}function AEventInputChanged_bind(b,d){RBrowser.isBrowser(EBrowser.Explorer)?b.onpropertychange=RUiEvent.ohEvent:b.addEventListener("input",RUiEvent.ohEvent)}
function AEventKeyDown(b){AEvent.call(this,b,"keydown","onkeydown");this.attach=AEventKeyDown_attach;return this}function AEventKeyDown_attach(b,d){b.altKey=d.altKey;b.shiftKey=d.shiftKey;b.ctrlKey=d.ctrlKey;b.keyCode=d.keyCode}function AEventKeyPress(b){AEvent.call(this,b,"keypress","onkeypress");this.create=AEventKeyPress_create;this.attach=AEventKeyPress_attach;return this}function AEventKeyPress_create(){return new SKeyboardEvent}
function AEventKeyPress_attach(b,d){b.hEvent=d;b.attachEvent(d)}function AEventKeyUp(b){AEvent.call(this,b,"keyup","onkeyup");this.attach=AEventKeyUp_attach;return this}function AEventKeyUp_attach(b,d){b.altKey=d.altKey;b.shiftKey=d.shiftKey;b.ctrlKey=d.ctrlKey;b.keyCode=d.keyCode}function AEventLoad(b){AEvent.call(this,b,"load","onload");this.attach=AEventLoad_attach;return this}function AEventLoad_attach(b,d){}
function AEventMouse(b,d,f){AEvent.call(this,b,d,f);this.attach=AEventMouse_attach;return this}
function AEventMouse_attach(b,d){b.button=d.button;b.mouseLeft=d.button==EMouseButton.Left;b.mouseMiddle=d.button==EMouseButton.Middle;b.mouseRight=d.button==EMouseButton.Right;b.altKey=d.altKey;b.ctrlKey=d.ctrlKey;RBrowser.isBrowser(EBrowser.FireFox)?(b.x=d.pageX,b.y=d.pageY,b.offsetX=d.layerX,b.offsetY=d.layerY):(b.x=d.x,b.y=d.y,b.offsetX=d.offsetX,b.offsetY=d.offsetY);b.clientX=d.clientX;b.clientY=d.clientY}
function AEventMouseDown(b){AEventMouse.call(this,b,"mousedown","onmousedown");return this}function AEventMouseEnter(b){AEvent.call(this,b,"mouseenter","onmouseenter");this._logger=!1;this.attach=AEventMouseEnter_attach;return this}function AEventMouseEnter_attach(b,d){}function AEventMouseLeave(b){AEvent.call(this,b,"mouseleave","onmouseleave");this._logger=!1;this.attach=AEventMouseLeave_attach;return this}function AEventMouseLeave_attach(b,d){}
function AEventMouseMove(b){AEventMouse.call(this,b,"mousemove","onmousemove");this._logger=!1;return this}function AEventMouseOut(b){AEvent.call(this,b,"mouseout","onmouseout");this._y=this._x=this._ctrlKey=this._altKey=this._hSource=null;this.attach=AEventMouseOut_attach;return this}function AEventMouseOut_attach(b){this._hSource=b.srcElement;this._altKey=b.altKey;this._ctrlKey=b.ctrlKey;RBrowser.isBrowser(EBrowser.FireFox)?(this._x=b.pageX,this._y=b.pageY):(this._x=b.x,this._y=b.y)}
function AEventMouseOver(b){AEvent.call(this,b,"mouseover","onmouseover");this._y=this._x=this._ctrlKey=this._altKey=this._hSource=null;this.attach=AEventMouseOver_attach;return this}function AEventMouseOver_attach(b){this._hSource=b.srcElement;this._altKey=b.altKey;this._ctrlKey=b.ctrlKey;RBrowser.isBrowser(EBrowser.FireFox)?(this._x=b.pageX,this._y=b.pageY):(this._x=b.x,this._y=b.y)}function AEventMouseUp(b){AEventMouse.call(this,b,"mouseup","onmouseup");return this}
function AEventMouseWheel(b){AEvent.call(this,b,"mousewheel","onmousewheel");this.attach=AEventMouseWheel_attach;return this}function AEventMouseWheel_attach(b,d){b.altKey=d.altKey;b.ctrlKey=d.ctrlKey;b.delta=d.wheelDelta;RBrowser.isBrowser(EBrowser.FireFox)?(b.x=d.pageX,b.y=d.pageY):(b.x=d.x,b.y=d.y)}function AEventReadyStateChange(b){AEvent.call(this,b,"readystatechange","onreadystatechange");this.attach=AEventReadyStateChange_attach;return this}function AEventReadyStateChange_attach(b,d){}
function AEventResize(b){AEvent.call(this,b,"resize","onresize");this.attach=AEventResize_attach;return this}function AEventResize_attach(b,d){b.x=d.x;b.y=d.y}function AEventScroll(b){AEvent.call(this,b,"scroll","onscroll");this.attach=AEventScroll_attach;return this}function AEventScroll_attach(b,d){}function AEventTouchEnd(b){AEvent.call(this,b,"touchstart","ontouchstart");this.attach=AEventTouchEnd_attach;return this}function AEventTouchEnd_attach(b,d){}
function AEventTouchMove(b){AEvent.call(this,b,"touchstart","ontouchstart");this.attach=AEventTouchMove_attach;return this}function AEventTouchMove_attach(b,d){}function AEventTouchStart(b){AEvent.call(this,b,"touchstart","ontouchstart");this.attach=AEventTouchStart_attach;return this}function AEventTouchStart_attach(b,d){}
function APtyAttributes(b,d,f,h,q,z){AProperty.call(this,b,d);this._left=RInteger.nvl(f);this._top=RInteger.nvl(h);this._right=RInteger.nvl(q);this._bottom=RInteger.nvl(z);this.load=APtyAttributes_load;this.save=APtyAttributes_save;this.toString=APtyAttributes_toString;return this}function APtyAttributes_load(b,d){var f=b[this._name];f||(f=b[this._name]=new TAttributes);f.split(d.get(this._linker),"=","\n")}
function APtyAttributes_save(b,d){var f=b[this._name];f&&(f.isEmpty()||d.set(this._linker,f.join("=","\n")))}function APtyAttributes_toString(){return"linker="+this._linker+",value="+this._left+","+this._top+","+this._right+","+this._bottom}function APtyBoolean(b,d,f){AProperty.call(this,b,d);this._value=f?f:!1;this.build=APtyBoolean_build;this.load=APtyBoolean_load;this.save=APtyBoolean_save;this.toString=APtyBoolean_toString;return this}
function APtyBoolean_build(b){null==b[this._name]&&(b[this._name]=this._value)}function APtyBoolean_load(b,d){b[this._name]=RBoolean.parse(d.get(this._linker))}function APtyBoolean_save(b,d){var f=b[this._name];f&&d.set(this._linker,RBoolean.toString(f))}function APtyBoolean_toString(){return"linker="+this._linker+",value="+this._value}function APtyConfig(b,d){AProperty.call(this,b,d);this.force=!0;this.load=APtyConfig_load;this.save=RMethod.empty;return this}
function APtyConfig_load(b,d){b[this.name]=d}function APtyEnum(b,d,f,h){AProperty.call(this,b,d);this._enum=f;this._default=h;this.build=APtyEnum_build;this.load=APtyEnum_load;this.save=APtyEnum_save;this.toString=APtyEnum_toString;return this}function APtyEnum_build(b){null==b[this._name]&&(b[this._name]=this._default)}function APtyEnum_load(b,d){b[this._name]=d.get(this._linker)}function APtyEnum_save(b,d){d.set(this._linker,b[this._name])}
function APtyEnum_toString(){return"linker="+this._linker+",enum="+this._enum+",default="+this._default}function APtyInteger(b,d,f){AProperty.call(this,b,d);this._value=RInteger.nvl(f);this.build=APtyInteger_build;this.load=APtyInteger_load;this.save=APtyInteger_save;this.toString=APtyInteger_toString;return this}function APtyInteger_build(b){null==b[this._name]&&(b[this._name]=this._value)}function APtyInteger_load(b,d){b[this._name]=RInteger.parse(d.get(this._linker))}
function APtyInteger_save(b,d){d.set(this._linker,RInteger.toString(b[this._name]))}function APtyInteger_toString(){return"linker="+this._linker+",value="+this._value}function APtyNumber(b,d,f){AProperty.call(this,b,d);this._value=RInteger.nvl(f);this.build=APtyNumber_build;this.toString=APtyNumber_toString;return this}function APtyNumber_build(b){null==b[this._name]&&(b[this._name]=this._value)}function APtyNumber_toString(){return"linker="+this._linker+",value="+this._value}
function APtyPadding(b,d,f,h,q,z){AProperty.call(this,b,d);this._left=RInteger.nvl(f);this._top=RInteger.nvl(h);this._right=RInteger.nvl(q);this._bottom=RInteger.nvl(z);this.load=APtyPadding_load;this.save=APtyPadding_save;this.toString=APtyPadding_toString;return this}function APtyPadding_load(b,d){b[this._name].parse(d.get(this._linker))}function APtyPadding_save(b,d){var f=b[this._name];f.isEmpty()||d.set(this._linker,f.toString())}
function APtyPadding_toString(){return"linker="+this._linker+",value="+this._left+","+this._top+","+this._right+","+this._bottom}function APtyPoint2(b,d,f,h){AProperty.call(this,b,d);this._x=RInteger.nvl(f);this._y=RInteger.nvl(h);this.load=APtyPoint2_load;this.save=APtyPoint2_save;this.toString=APtyPoint2_toString;return this}function APtyPoint2_load(b,d){b[this._name].parse(d.get(this._linker))}function APtyPoint2_save(b,d){var f=b[this._name];f.isEmpty()||d.set(this._linker,f.toString())}
function APtyPoint2_toString(){return"linker="+this._linker+",value="+this._x+","+this._y}function APtySet(b,d,f,h){AProperty.call(this,b,d);this._search=f;this._value=h;this.build=APtySet_build;this.load=APtySet_load;this.save=APtySet_save;this.toString=APtySet_toString;return this}function APtySet_build(b){null==b[this.name]&&(b[this.name]=this._value)}function APtySet_load(b,d){b[this.name]=RSet.containsString(d.get(this.linker),this.search)}
function APtySet_save(b,d){var f=this.name,h=b[f],q=d.get(this.linker),q=RSet.containsString(q,this._search);h&&!q?d.set(f,h+this._search):!b&&q&&d.set(f,RString.remove(h,this._search))}function APtySet_toString(){return"linker="+this.linker+",value="+this._value+",search="+this._search}function APtySize2(b,d,f,h){AProperty.call(this,b,d);this._width=RInteger.nvl(f);this._height=RInteger.nvl(h);this.load=APtySize2_load;this.save=APtySize2_save;this.toString=APtySize2_toString;return this}
function APtySize2_load(b,d){b[this._name].parse(d.get(this._linker))}function APtySize2_save(b,d){var f=b[this._name];f.isEmpty()||d.set(this._linker,f.toString())}function APtySize2_toString(){return"linker="+this._linker+",value="+this._width+","+this._height}function APtyString(b,d,f){AProperty.call(this,b,d);this._value=f?f:null;this.build=APtyString_build;this.toString=APtyString_toString;return this}function APtyString_build(b){null==b[this._name]&&(b[this._name]=this._value)}
function APtyString_toString(){return"linker="+this._linker+",value="+this._value}var EEditConfig=new function(){this.Search="S";this.Copy="C";return this};function EEditStatusFace(b){b||(b=this);b.Blur=0;b.Cancel=1;b.Ok=2;return b}
var EEditStatus=new EEditStatusFace,EEventInvoke=new function(){this.Unknown=0;this.Before=1;this.After=2;return this},EEventStatus=new function(){this.Unknown=0;this.Continue=1;this.Stop=2;this.Cancel=3;this.Failure=4;return this},EEventType=new function(){this.Unknown=0;this.Construct=1;this.Initialize=2;this.Build=3;this.Refresh=4;this.Resize=5;this.Visible=6;this.Show=7;this.Hidden=8;this.Enable=9;this.Disable=10;this.Release=11;this.Design=12;this.Action=13;this.Valid=14;this.Mode=15;return this},
ERowStatus=new function(){this.Normal="N";this.Insert="I";this.Update="U";this.Delete="D";return this},EUiAlign=new function(){this.Left="left";this.Center="center";this.Right="right";this.Top="up";this.Middle="middle";this.Bottom="down";this.BottomLeft="bl";this.BottomRight="br";return this},EUiBorder=new function(){this.None=0;this.Square=1;this.Round=2;this.RoundIcon=3;this.RoundDrop=4;this.RoundTitle=5;this.RoundIconDrop=6;return this},EUiBorderStyle=new function(){this.Readonly=1;this.Edit=2;
this.Hover=3;return this},EUiColor=new function(){this.ReadonlyBackgroundColor="#FEFECB";this.Normal="#FFFFFF";this.Select="#F8C59A";this.Invalid=this.Valid="#FFCCCC";this.Edit="#FFFFFF";this.EditHover="#EBFFFF";this.Require="#FF0000";this.Text="#000000";this.TextEdit="#0066FF";this.TextReadonly="#333333";this.TextInvalid="red";this.Delete="#DDDDDD";this.ColumnReadonly="#FFFFFF";this.Rows=["#FFFFFF","#FAFAFA"];this.RowSelect="#cde5ff";this.RowHover="#E8E8FF";this.RowEdit="#FFFFFF";this.RowEditSelect=
"#FDEBDB";this.RowEditHover="#F8F8E0";return this},EUiCursor=new function(){this.Default="default";this.Auto="auto";this.NorthWest="NW";this.SouthWest="SW";this.SouthEast="SE";this.NorthEast="NE";this.West="W";this.South="S";this.East="E";this.North="N";this.Pointer="pointer";this.Cross="crosshair";this.Move="move";return this},EUiDialog=new function(){this.Confirm=1;this.Info=2;this.Warn=3;this.Error=4;return this},EUiDirection=new function(){this.Horizontal="H";this.Vertical="V";return this},EUiDock=
new function(){this.None="none";this.Left="left";this.Right="right";this.Center="center";this.Fill="fill";return this},EUiLabelMode=new function(){this.All="A";this.Label="L";this.Hidden="H";return this},EUiLabelPosition=new function(){this.Left="left";this.Right="right";this.Top="top";this.Bottom="bottom";return this},EUiLayer=new function(){this.Default=2E4;this.Shadow=6E3;this.Disable=5E3;this.Drap=1E4;this.Window=2E4;this.Drop=4E4;this.Editor=1E4;this.Border=2E4;this.Move=25E3;this.Message=this.Search=
45E3;return this},EUiLayout=new function(){this.Display="P";this.Search="S";this.Design="G";this.Insert="I";this.Update="U";this.Delete="D";this.Zoom="Z";return this},EUiMerge=new function(){this.Append="append";this.Override="override";this.Disable="disable";return this},EPanel=new function(){this.Container=0;this.Parent=1;this.Size=8;this.Border=2;this.Edit=3;this.Focus=4;this.Design=5;this.Scroll=6;this.Shadow=7;this.Move=9;this.Disable=10;this.Drop=11;return this},EUiPosition=new function(){this.Left=
"left";this.Right="right";this.Top="top";this.Bottom="bottom";this.Center="center";this.Before=1;this.After=2;this.LineBefore=3;this.LineAfter=4;return this},EUiScroll=new function(){this.None="N";this.Horizontal="H";this.HorizontalAuto="HA";this.Vertical="V";this.VerticalAuto="VA";this.Both="B";this.BothAuto="BA";return this},EUiSize=new function(){this.Normal=0;this.Horizontal=1;this.Vertical=2;this.Fill=3;this.Both=4;return this},EUiWrap=new function(){this.NextLine=0;this.SameLine=1;return this};
function MListenerBlur(b){b=RClass.inherits(this,b,MListener);b.addBlurListener=MListenerBlur_addBlurListener;b.processBlurListener=MListenerBlur_processBlurListener;return b}function MListenerBlur_addBlurListener(b,d){return this.addListener(EEvent.Blur,b,d)}function MListenerBlur_processBlurListener(b,d,f,h,q){this.processListener(EEvent.Blur,b,d,f,h,q)}
function MListenerClick(b){b=RClass.inherits(this,b,MListener);b.addClickListener=MListenerClick_addClickListener;b.setClickListener=MListenerClick_setClickListener;b.removeClickListener=MListenerClick_removeClickListener;b.processClickListener=MListenerClick_processClickListener;return b}function MListenerClick_addClickListener(b,d){return this.addListener(EEvent.Click,b,d)}function MListenerClick_setClickListener(b,d){return this.setListener(EEvent.Click,b,d)}
function MListenerClick_removeClickListener(b,d){return this.removeListener(EEvent.Click,b,d)}function MListenerClick_processClickListener(b,d,f,h,q){this.processListener(EEvent.Click,b,d,f,h,q)}function MListenerDataChanged(b){b=RClass.inherits(this,b,MListener);b.addDataChangedListener=MListenerDataChanged_addDataChangedListener;b.processDataChangedListener=MListenerDataChanged_processDataChangedListener;return b}
function MListenerDataChanged_addDataChangedListener(b,d){return this.addListener(EEvent.DataChanged,b,d)}function MListenerDataChanged_processDataChangedListener(b,d,f,h,q){this.processListener(EEvent.DataChanged,b,d,f,h,q)}
function MListenerDoubleClick(b){b=RClass.inherits(this,b,MListener);b.addDoubleClickListener=MListenerDoubleClick_addDoubleClickListener;b.setDoubleClickListener=MListenerDoubleClick_setDoubleClickListener;b.processDoubleClickListener=MListenerDoubleClick_processDoubleClickListener;return b}function MListenerDoubleClick_addDoubleClickListener(b,d){return this.addListener(EEvent.DoubleClick,b,d)}
function MListenerDoubleClick_setDoubleClickListener(b,d){return this.setListener(EEvent.DoubleClick,b,d)}function MListenerDoubleClick_processDoubleClickListener(b,d,f,h,q){this.processListener(EEvent.DoubleClick,b,d,f,h,q)}function MListenerEnter(b){b=RClass.inherits(this,b,MListener);b.addEnterListener=MListenerEnter_addEnterListener;b.processEnterListener=MListenerEnter_processEnterListener;return b}function MListenerEnter_addEnterListener(b,d){return this.addListener(EEvent.Enter,b,d)}
function MListenerEnter_processEnterListener(b,d,f,h,q){this.processListener(EEvent.Enter,b,d,f,h,q)}function MListenerFocus(b){b=RClass.inherits(this,b,MListener);b.addFocusListener=MListenerFocus_addFocusListener;b.processFocusListener=MListenerFocus_processFocusListener;return b}function MListenerFocus_addFocusListener(b,d){return this.addListener(EEvent.Focus,b,d)}function MListenerFocus_processFocusListener(b,d,f,h,q){this.processListener(EEvent.Focus,b,d,f,h,q)}
function MListenerItemClick(b){b=RClass.inherits(this,b,MListener);b.addItemClickListener=MListenerItemClick_addItemClickListener;b.processItemClickListener=MListenerItemClick_processItemClickListener;return b}function MListenerItemClick_addItemClickListener(b,d){return this.addListener(EEvent.ItemClick,b,d)}function MListenerItemClick_processItemClickListener(b,d,f,h,q){this.processListener(EEvent.ItemClick,b,d,f,h,q)}
function MListenerLeave(b){b=RClass.inherits(this,b,MListener);b.addLeaveListener=MListenerLeave_addLeaveListener;b.processLeaveListener=MListenerLeave_processLeaveListener;return b}function MListenerLeave_addLeaveListener(b,d){return this.addListener(EEvent.Leave,b,d)}function MListenerLeave_processLeaveListener(b,d,f,h,q){this.processListener(EEvent.Leave,b,d,f,h,q)}
function MListenerResult(b){b=RClass.inherits(this,b,MListener);b.addResultListener=MListenerResult_addResultListener;b.removeResultListener=MListenerResult_removeResultListener;b.processResultListener=MListenerResult_processResultListener;b.clearResultListeners=MListenerResult_clearResultListeners;return b}function MListenerResult_addResultListener(b,d){return this.addListener(EEvent.Result,b,d)}function MListenerResult_removeResultListener(b,d){return this.removeListener(EEvent.Result,b,d)}
function MListenerResult_processResultListener(b,d,f,h,q){this.processListener(EEvent.Result,b,d,f,h,q)}function MListenerResult_clearResultListeners(){return this.clearListeners(EEvent.Result)}function MListenerSelected(b){b=RClass.inherits(this,b,MListener);b.addSelectedListener=MListenerSelected_addSelectedListener;b.processSelectedListener=MListenerSelected_processSelectedListener;return b}function MListenerSelected_addSelectedListener(b,d){return this.addListener(EEvent.Selected,b,d)}
function MListenerSelected_processSelectedListener(b,d,f,h,q){this.processListener(EEvent.Selected,b,d,f,h,q)}function MPropertyCheck(b){b=RClass.inherits(this,b);b._valueTrue=RClass.register(b,new APtyString("_valueTrue"),EBoolean.True);b._valueFalse=RClass.register(b,new APtyString("_valueFalse"),EBoolean.False);return b}
function MPropertyEdit(b){b=RClass.inherits(this,b,MUiEditValidator,MUiEditReference,MUiEditZoom);b._editCaseCd=RClass.register(b,new APtyString("_editCaseCd"));b._editPattern=RClass.register(b,new APtyString("_editPattern"));b._editLength=RClass.register(b,new APtyInteger("_editLength"));b._editComplete=RClass.register(b,new APtyBoolean("_editComplete"));b._validLengthMin=RClass.register(b,new APtyInteger("_validLengthMin"));b._validLengthMax=RClass.register(b,new APtyInteger("_validLengthMax"));
b.oeValid=MPropertyEdit_oeValid;return b}function MPropertyEdit_oeValid(b){var d=EEventStatus.Stop;if(this._visible&&this._validable){var f=this.text();if(this.validRequire&&!RValidator.validRequire(this,f))return b.controls.push(this),d;this.editLength&&!RValidator.validTextLength(this,f,this.editLength)&&b.controls.push(this)}return d}
function MPropertyNumber(b){b=RClass.inherits(this,b);b._valueMin=RClass.register(b,new APtyNumber("_valueMin"));b._valueMax=RClass.register(b,new APtyNumber("_valueMax"));b._valuePrecision=RClass.register(b,new APtyInteger("_valuePrecision"),3);return b}
function MPropertySelect(b){b=RClass.inherits(this,b,MUiEditValidator,MUiEditReference,MUiEditZoom);b._editCaseCd=RClass.register(b,new APtyString("_editCaseCd"));b._editPattern=RClass.register(b,new APtyString("_editPattern"));b._editLength=RClass.register(b,new APtyInteger("_editLength"));b._editComplete=RClass.register(b,new APtyBoolean("_editComplete"));b._validLengthMin=RClass.register(b,new APtyInteger("_validLengthMin"));b._validLengthMax=RClass.register(b,new APtyInteger("_validLengthMax"));
b.oeValid=MPropertySelect_oeValid;return b}function MPropertySelect_oeValid(b){var d=EEventStatus.Stop;if(this._visible&&this._validable){var f=this.text();if(this.validRequire&&!RValidator.validRequire(this,f))return b.controls.push(this),d;this.editLength&&!RValidator.validTextLength(this,f,this.editLength)&&b.controls.push(this)}return d}function MUiContainer(b){b=RClass.inherits(this,b);b.createChild=MUiContainer_createChild;b.appendChild=RMethod.empty;b.removeChild=RMethod.empty;return b}
function MUiContainer_createChild(b){b=RUiControl.newInstance(b);b._parent=this;return b}function MUiDataProperties(b){b=RClass.inherits(this,b);b._dataProperties=null;b.dataProperties=MUiDataProperties_dataProperties;b.dataPropertyGet=MUiDataProperties_dataPropertyGet;b.dataPropertySet=MUiDataProperties_dataPropertySet;return b}function MUiDataProperties_dataProperties(b,d){var f=this._dataProperties;null==f&&(f=this._dataProperties=new TDictionary);return f}
function MUiDataProperties_dataPropertyGet(b){var d=this._dataProperties;return d?d.get(b):null}function MUiDataProperties_dataPropertySet(b,d){this.dataProperties().set(b,d)}function MUiDescribeFrame(b){b=RClass.inherits(this,b);b._frameName=null;b.buildDefine=MUiDescribeFrame_buildDefine;return b}function MUiDescribeFrame_buildDefine(b,d){RString.isEmpty(d)&&(d=this._frameName);var f=RConsole.find(FUiDescribeFrameConsole).load(d);RUiControl.build(this,f,null,b)}
function MUiDesign(b){b=RClass.inherits(this,b);b._statusDesign=!1;b._storage=null;b.oeDesign=MUiDesign_oeDesign;b.onDesignEnter=RClass.register(b,new AEventMouseEnter("onDesignEnter"),MUiDesign_onDesignEnter);b.onDesignLeave=RClass.register(b,new AEventMouseEnter("onDesignLeave"),MUiDesign_onDesignLeave);b.onDesignBegin=RClass.register(b,new AEventMouseEnter("onDesignBegin"),MUiDesign_onDesignBegin);b.onDesignEnd=RClass.register(b,new AEventMouseEnter("onDesignEnd"),MUiDesign_onDesignEnd);return b}
function MUiDesign_oeDesign(b){if(b.isBefore())switch(b.mode){case EDesign.Move:var d=this,f=d._hPanel;if(b.flag)d.isDesign=!0,RHtml.link(f,"className",f.className),RHtml.link(f,"onmousedown",f.onmousedown),f.onmousedown=null,d.onDesignEnter();else if(d.isDesign=!1,f.className=RHtml.findLink(f,"className"),b=RHtml.findLink(f,"onmousedown"))f.onmousedown=b;break;case EDesign.Border:f=this._hPanel,b.flag?(RHtml.link(f,"styleBorder",f.style.border),f.style.border="1 solid red"):f.style.border=RHtml.findLink(f,
"styleBorder")}}function MUiDesign_onDesignEnter(b){this._hPanel.className=this.style("Design")}function MUiDesign_onDesignLeave(b){}function MUiDesign_onDesignBegin(b){b=this._storage=RObject.nvlObj(this._storage);b.designStyle=this._hPanel.className;b.designLayer=this._hPanel.zIndex;this._hPanel.className=this.style("DesignDrag");this._statusDesign=!0}
function MUiDesign_onDesignEnd(b){b=this._storage=RObject.nvlObj(this._storage);this._hPanel.className=b.designStyle;this._hPanel.zIndex=b.designLayer;this._statusDesign=!1}
function MUiDisplay(b){b=RClass.inherits(this,b);b._dispDisplay=RClass.register(b,new APtySet(null,"_dispDisplay","disp_mode",EDisplayMode.Display,!1));b._dispSearch=RClass.register(b,new APtySet(null,"_dispSearch","disp_mode",EDisplayMode.Search,!1));b._dispInsert=RClass.register(b,new APtySet(null,"_dispInsert","disp_mode",EDisplayMode.Insert,!1));b._dispUpdate=RClass.register(b,new APtySet(null,"_dispUpdate","disp_mode",EDisplayMode.Update,!1));b._dispDelete=RClass.register(b,new APtySet(null,
"_dispDelete","disp_mode",EDisplayMode.Delete,!1));b._dispZoom=RClass.register(b,new APtySet(null,"_dispZoom","disp_mode",EDisplayMode.Zoom,!1));b._dispAlign=RClass.register(b,new APtyString(null,"_dispAlign",null,EAlign.Left));b._visible=!0;b.oeMode=MUiDisplay_oeMode;b.canVisible=MUiDisplay_canVisible;return b}function MUiDisplay_oeMode(b){if(b.isBefore()){var d=!0;this.base.MUiDisplayAble||(d=this.canVisible(b.mode));this.setVisible(d)}}
function MUiDisplay_canVisible(b){switch(RString.nvl(b,this._emode)){case EMode.Display:return this.dispList;case EMode.Search:return this.dispSearch;case EMode.Insert:return this.dispInsert;case EMode.Update:return this.dispUpdate;case EMode.Delete:return this.dispDelete;case EMode.Zoom:return this.dispZoom}}
function MUiDragable(b){b=RClass.inherits(this,b);b.onDragStart=RMethod.virtual(b,"onDragStart");b.onDragMove=RMethod.virtual(b,"onDragMove");b.onDragStop=RMethod.virtual(b,"onDragStop");return b}
function MUiDropable(b){b=RClass.inherits(this,b);b._styleDrop=RClass.register(b,new AStyle("_styleDrop"));b._styleIconDrop=RClass.register(b,new AStyleIcon("_styleIconDrop"));b._hDropPanel=null;b._hDrop=null;b.onBuildDrop=MUiDropable_onBuildDrop;b.onDropEnter=RClass.register(b,new AEventMouseEnter("onDropEnter"));b.onDropLeave=RClass.register(b,new AEventMouseLeave("onDropLeave"));b.onDropClick=RClass.register(b,new AEventClick("onDropClick"),MUiDropable_onDropClick);b.onDropDoubleClick=RClass.register(b,
new AEventDoubleClick("onDropDoubleClick"),MUiDropable_onDropDoubleClick);b.canDrop=MUiDropable_canDrop;return b}function MUiDropable_onBuildDrop(b){this._hDropPanel=b;b.className=this.styleName("Drop",MUiDropable);b=this.hDrop=RBuilder.appendIcon(b,null,"control.drop");b.style.width=16;b.style.borderLeft="1 solid #CCCCCC";b.style.cursor="hand"}function MUiDropable_onDropClick(){this._editable&&this.drop()}function MUiDropable_onDropDoubleClick(){this._editable&&this.drop()}
function MUiDropable_canDrop(){return RClass.isClass(this,MUiDesign)?!RConsole.find(FUiDesignConsole).canDesignMove:!0}function MUiEditable(b){return b=RClass.inherits(this,b)}function MUiEditable_testEdit(b){switch(RString.nvl(b,this._emode)){case EMode.Insert:return this.editInsert;case EMode.Update:return this.editUpdate;case EMode.Delete:return this.editDelete;case EMode.Zoom:return this.editZoom}}
function MUiEditChange(b){b=RClass.inherits(this,b);b._styleChangePanel=RClass.register(b,new AStyle("_styleChangePanel"));b._styleChangeIcon=RClass.register(b,new AStyle("_styleChangeIcon"));b._hChangePanel=null;b._hChangeIcon=null;b.onBuildEditChange=MUiEditChange_onBuildEditChange;b.onChangeEnter=RClass.register(b,new AEventMouseEnter("onChangeEnter"),MUiEditChange_onChangeEnter);b.onChangeLeave=RClass.register(b,new AEventMouseLeave("onChangeLeave"),MUiEditChange_onChangeLeave);b.onChangeClick=
RClass.register(b,new AEventClick("onChangeClick"),MUiEditChange_onChangeClick);b.construct=MUiEditChange_construct;b.changeSet=MUiEditChange_changeSet;b.dispose=MUiEditChange_dispose;return b}
function MUiEditChange_onBuildEditChange(b){b=this._hChangePanel;b.className=this.styleName("ChangePanel",MUiEditChange);b.style.verticalAlign="top";b.width=5;this.attachEvent("onChangeEnter",b,this.onChangeEnter);this.attachEvent("onChangeLeave",b,this.onChangeLeave);this.attachEvent("onChangeClick",b,this.onChangeClick);(this._hChangeIcon=RBuilder.appendIcon(b,this.styleName("ChangeIcon",MUiEditChange),"control.change"))._pname="change.icon"}function MUiEditChange_onChangeEnter(b){}
function MUiEditChange_onChangeLeave(b){}function MUiEditChange_onChangeClick(b){}function MUiEditChange_construct(){}function MUiEditChange_changeSet(b){}function MUiEditChange_dispose(){RHtml.free(this._hChangeIcon);this._hChangeIcon=null;RHtml.free(this._hChangePanel);this._hChangePanel=null}
function MUiEditDescriptor(b){b=RClass.inherits(this,b,MEditable);b._dataName=RClass.register(b,new APtyString(null,"_dataName"));b._dataCode=RClass.register(b,new APtyString(null,"_dataCode"));b._dataDefault=RClass.register(b,new APtyString(null,"_dataDefault"));b._labelIcon=RClass.register(b,new APtyString(null,"_labelIcon"));b._labelIconDisable=RClass.register(b,new APtyString(null,"_labelIconDisable"));b._labelColor=RClass.register(b,new APtyString(null,"_labelColor"));b._labelAlign=RClass.register(b,
new APtyString(null,"_labelAlign",null,EAlign.Left));b._labelValign=RClass.register(b,new APtyString(null,"_labelValign",null,EAlign.Middle));b._editSearch=RClass.register(b,new APtySet(null,"_editSearch","editAccess",EEditConfig.Search,!1));b._editCopy=RClass.register(b,new APtySet(null,"_editCopy","editAccess",EEditConfig.Copy,!1));b._editAlign=RClass.register(b,new APtyString(null,"_editAlign",null,EAlign.Left));b._editValign=RClass.register(b,new APtyString(null,"_editValign",null,EAlign.Middle));
b._editFormat=RClass.register(b,new APtyString(null,"_editFormat"));b._editUnit=RClass.register(b,new APtyString(null,"_editUnit"));b._editTip=RClass.register(b,new APtyString(null,"_editTip"));b._validInsert=RClass.register(b,new APtySet(null,"_validInsert","validAccess",EDisplayMode.Insert,!1));b._validUpdate=RClass.register(b,new APtySet(null,"_validUpdate","validAccess",EDisplayMode.Update,!1));b._validDelete=RClass.register(b,new APtySet(null,"_validDelete","validAccess",EDisplayMode.Delete,
!1));b._validRequire=RClass.register(b,new APtyBoolean(null,"_validRequire",null,!1));return b}function MUiEditDescriptor_onDataEnter(b,d){b.__progress||(b._editable&&(b._hover=!0,b.refreshStyle()),this.editTip&&(this.__tip=window.status))}function MUiEditDescriptor_onDataLeave(b,d){b.__progress||(b._editable&&(this._hover=!1,this.refreshStyle()),this.editTip&&(window.status=this.__tip))}
function MUiEditDescriptor_onDataKeyDown(b,d){b._editable&&!b._disabled&&(b._invalidText=this.validText(b.text()),b.refreshStyle())}function MUiEditDescriptor_onDataChange(b,d){if(b._editable&&!b._disabled&&b.isTextChanged()){var f=b.text();(b._invalidText=this.validText(f))&&b.refreshStyle();this.callEvent("onDataChange",this,this.__changedEvent)}}
function MUiEditDescriptor_onDataEditEnd(b,d){var f=b._invalidText=this.validText(b.text());f?RLogger.debug(this,"Edit valid failed ({0})",f):b.commitValue();b.isTextChanged()&&this.callEvent("onDataChange",this,this.__changedEvent);b.refreshStyle()}function MUiEditDescriptor_oeSaveCode(b){RString.isEmpty(this.dataName)||RString.isEmpty(this.dataCode)||b.values.set(this.dataName,this.dataCode);return EEventStatus.Stop}
function MUiEditDescriptor_canValid(b){switch(RString.nvl(b,this._emode)){case EMode.Insert:return this.validInsert;case EMode.Update:return this.validUpdate;case EMode.Delete:return this.validDelete}}function MUiEditDescriptor_formatValue(b){return RString.nvl(b)}function MUiEditDescriptor_formatText(b){return RString.nvl(b)}function MUiEditDescriptor_validText(b){}
function MUiEditDrop(b){b=RClass.inherits(this,b);b._styleDropPanel=RClass.register(b,new AStyle("_styleDropPanel"));b._styleDropIcon=RClass.register(b,new AStyle("_styleDropIcon"));b._hDropPanel=null;b._hDropIcon=null;b.onBuildEditDrop=MUiEditDrop_onBuildEditDrop;b.onDropEnter=RClass.register(b,new AEventMouseEnter("onDropEnter"),MUiEditDrop_onDropEnter);b.onDropLeave=RClass.register(b,new AEventMouseLeave("onDropLeave"),MUiEditDrop_onDropLeave);b.onDropClick=RClass.register(b,new AEventClick("onDropClick"),
MUiEditDrop_onDropClick);b.construct=MUiEditDrop_construct;b.dispose=MUiEditDrop_dispose;return b}function MUiEditDrop_onBuildEditDrop(b){b=this._hDropPanel;b.className=this.styleName("DropPanel",MUiEditDrop);b.width=11;this.attachEvent("onDropEnter",b);this.attachEvent("onDropLeave",b);this.attachEvent("onDropClick",b);(this._hDropIcon=RBuilder.appendIcon(b,this.styleName("DropIcon",MUiEditDrop),"control.drop")).align="center"}function MUiEditDrop_onDropEnter(b){}
function MUiEditDrop_onDropLeave(b){}function MUiEditDrop_onDropClick(b){}function MUiEditDrop_construct(){}function MUiEditDrop_dispose(){RHtml.free(this._hDropIcon);this._hDropIcon=null;RHtml.free(this._hDropPanel);this._hDropPanel=null}function MUiEditFormator(b){b=RClass.inherits(this,b);b.formatText=MUiEditFormator_formatText;b.formatValue=MUiEditFormator_formatValue;return b}function MUiEditFormator_formatText(b){return b}function MUiEditFormator_formatValue(b){return b}
function MUiEditReference(b){b=RClass.inherits(this,b);b._lovService=RClass.register(b,new APtyString("_lovService"));b._lovReference=RClass.register(b,new APtyString("_lovReference"));b._lovFields=RClass.register(b,new APtyString("_lovFields"));b._lovWhere=RClass.register(b,new APtyString("_lovWhere"));b._lovOrder=RClass.register(b,new APtyString("_lovOrder"));b._listView=null;b.onListSelected=RMethod.empty;b.canListView=MUiEditReference_canListView;b.setLabelStyle=MUiEditReference_setLabelStyle;
b.doListView=MUiEditReference_doListView;return b}function MUiEditReference_onListClick(b){this.canListView()&&this.doListView()}function MUiEditReference_canListView(){return!RString.isEmpty(this._lovReference)&&this._editable}function MUiEditReference_setLabelStyle(){RString.isEmpty(this.lovRefer)||(this.hLabel.style.cursor="hand",this.attachEvent("onListClick",this.hLabel),this.hLabel.className="RLine_Underline")}
function MUiEditReference_doListView(b){var d=this._listView;d||(d=this._listView=top.RControl.create(top.FListWindow));d.linkConsole=RConsole;d.linkLovControl(this);d.show();d.fetch(b)}function MUiEditValidator(b){b=RClass.inherits(this,b);b._validable=!1;b._valid=!0;b._validText=null;b.oeValid=RMethod.empty;return b}
function MUiEditValue(b){b=RClass.inherits(this,b,MUiEditFormator);b._dataValue=RClass.register(b,new APtyString("_dataValue"));b._statusEditable=!0;b._statusEditing=!1;b._statusInvalid=!0;b._recordText=null;b._recordValue=null;b.isTextChanged=MUiEditValue_isTextChanged;b.isValueChanged=MUiEditValue_isValueChanged;b.formator=MUiEditValue_formator;b.text=MUiEditValue_text;b.setText=MUiEditValue_setText;b.get=MUiEditValue_get;b.set=MUiEditValue_set;b.clearValue=MUiEditValue_clearValue;b.resetValue=
MUiEditValue_resetValue;b.loadValue=MUiEditValue_loadValue;b.saveValue=MUiEditValue_saveValue;b.recordValue=MUiEditValue_recordValue;b.validValue=RMethod.empty;b.setEditAble=MUiEditValue_setEditAble;b.doFocus=MUiEditValue_doFocus;b.doBlur=MUiEditValue_doBlur;return b}function MUiEditValue_isTextChanged(){var b=this.text();return RString.equals(this._recordText,b)}function MUiEditValue_isValueChanged(){var b=this.get();return RString.equals(this._recordValue,b)}
function MUiEditValue_formator(){return this}function MUiEditValue_text(){}function MUiEditValue_setText(b){}function MUiEditValue_get(){var b=this.text();return this._dataValue=this.formator().formatValue(b)}function MUiEditValue_set(b){this._dataValue=RString.nvl(b);b=this.formator().formatText(b);this.setText(b)}function MUiEditValue_clearValue(){this._dataValue=RString.EMPTY;this.set(RString.EMPTY)}function MUiEditValue_resetValue(){this._dataValue=value;this.set(value)}
function MUiEditValue_loadValue(b,d){}function MUiEditValue_saveValue(b,d){}function MUiEditValue_recordValue(){this._recordText=this.text();this._recordValue=this.get()}function MUiEditValue_setEditAble(b){this._statusEditable=b}function MUiEditValue_doFocus(){this._statusEditable&&(this._statusEditing=!0)}function MUiEditValue_doBlur(){this._statusEditable&&this._statusEditing&&(this._statusEditing=!1)}
function MUiEditValue_oeClearValue(b){b=this.descriptor();RString.isEmpty(b.dataName)||(this.clearValue(),this.dataValue=this.reget());return EEventStatus.Stop}function MUiEditValue_oeResetValue(b){b=this.descriptor();RString.isEmpty(b.dataName)||(this.resetValue(),this.dataValue=this.reget());return EEventStatus.Stop}
function MUiEditValue_oeLoadValue(b){var d=this.descriptor();b=b.values;d=d.dataName;!RString.isEmpty(d)&&b.contains(d)&&(d=b.nvl(d),RControl.isInfo(d)?this.setInfoPack(d):RControl.isGroup(d)?this.setGroupPack(d):this.loadValue(b),this.recordValue(),this.dataValue=this.reget());return EEventStatus.Stop}function MUiEditValue_oeSaveValue(b){var d=this.descriptor();RString.isEmpty(d.dataName)||this.saveValue(b.values);return EEventStatus.Stop}
function MUiEditValue_oeRecordValue(){var b=this.descriptor();RString.isEmpty(b.dataName)||this.recordValue();return EEventStatus.Stop}function MUiEditValue_commitValue(){this.__commitValue=RString.nvl(this.reget())}function MUiEditValue_reget(){return this.descriptor().formatValue(this.text())}function MUiEditValue_setInfoPack(b){var d=this._info;d||(d=this._info=new TControlInfo);d.unpack(b);b=this.descriptor();b.setInfo(d);b!=this&&this.setInfo(d)}
function MUiEditValue_setInfo(b){this.set(b.value)}function MUiEditZoom(b){b=RClass.inherits(this,b);b._zoomReference=RClass.register(b,new APtyString("_zoomReference"));b._zoomField=RClass.register(b,new APtyString("_zoomField"));b.testZoom=MUiEditZoom_testZoom;b.doZoom=MUiEditZoom_doZoom;return b}function MUiEditZoom_testZoom(){return!RString.isEmpty(this._zoomReference)}function MUiEditZoom_doZoom(b){RFormSpace.doZoom(this,b)}
function MUiFocus(b){b=RClass.inherits(this,b);b.onFocus=RClass.register(b,new AEventFocus("onFocus"),MUiFocus_onFocus);b.onBlur=RClass.register(b,new AEventBlur("onBlur"));b.testFocus=RMethod.emptyTrue;b.testBlur=RMethod.emptyTrue;b.doFocus=RMethod.empty;b.doBlur=RMethod.empty;b.focus=MUiFocus_focus;b.blur=MUiFocus_blur;return b}function MUiFocus_onFocus(b){RConsole.find(FUiFocusConsole).focus(this,b)}function MUiFocus_focus(){RConsole.find(FUiFocusConsole).focus(this)}
function MUiFocus_blur(){RConsole.find(FUiFocusConsole).blur(this)}function MUiHorizontal(b){b=RClass.inherits(this,b);b.setVisible=MUiHorizontal_setVisible;return b}function MUiHorizontal_setVisible(b){var d=this.hPanelLine;d&&RHtml.displaySet(d,b)}
function MUiMargin(b){b=RClass.inherits(this,b);b._margin=RClass.register(b,new APtyPadding("_margin"));b.construct=MUiMargin_construct;b.margin=MUiMargin_margin;b.setMargin=MUiMargin_setMargin;b.refreshMargin=MUiMargin_refreshMargin;b.dispose=MUiMargin_dispose;return b}function MUiMargin_construct(){this._margin=new SPadding}function MUiMargin_margin(){return this._margin}
function MUiMargin_setMargin(b,d,f,h){var q=this._padding,z=this.panel(EPanel.Container),A=null;z&&!z.__fragment&&(A=z.style);null!=b&&(q.left=b,A&&(A.marginLeft=0==b?null:b+"px"));null!=d&&(q.top=d,A&&(A.marginTop=0==d?null:d+"px"));null!=f&&(q.right=f,A&&(A.marginRight=0==f?null:f+"px"));null!=h&&(q.bottom=h,A&&(A.marginBottom=0==h?null:h+"px"))}function MUiMargin_refreshMargin(){var b=this._margin;this.setMargin(b.left,b.top,b.right,b.bottom)}
function MUiMargin_dispose(){this._margin=RObject.dispose(this._margin)}function MUiPadding(b){b=RClass.inherits(this,b);b._padding=RClass.register(b,new APtyPadding("_padding"));b.construct=MUiPadding_construct;b.padding=MUiPadding_padding;b.setPadding=MUiPadding_setPadding;b.refreshPadding=MUiPadding_refreshPadding;b.dispose=MUiPadding_dispose;return b}function MUiPadding_construct(){this._padding=new SPadding}function MUiPadding_padding(){return this._padding}
function MUiPadding_setPadding(b,d,f,h){var q=this._padding,z=this.panel(EPanel.Container),A=null;z&&!z.__fragment&&(A=z.style);null!=b&&(q.left=b,A&&(A.paddingLeft=0==b?null:b+"px"));null!=d&&(q.top=d,A&&(A.paddingTop=0==d?null:d+"px"));null!=f&&(q.right=f,A&&(A.paddingRight=0==f?null:f+"px"));null!=h&&(q.bottom=h,A&&(A.paddingBottom=0==h?null:h+"px"))}function MUiPadding_refreshPadding(){var b=this._padding;this.setPadding(b.left,b.top,b.right,b.bottom)}
function MUiPadding_dispose(){var b=this._padding;b&&(b.dispose(),this._padding=null)}function MUiPopup(b){b=RClass.inherits(this,b);b._opener=null;b.opener=MUiPopup_opener}function MUiPopup_opener(){return this._opener}function MUiProgress(b){b=RClass.inherits(this,b);b.oeProgress=RMethod.virtual(b,"oeProgress");return b}
function MUiSize(b){b=RClass.inherits(this,b);b._dockCd=RClass.register(b,new APtyString("_dockCd"));b._location=RClass.register(b,new APtyPoint2("_location"));b._size=RClass.register(b,new APtySize2("_size"));b.construct=MUiSize_construct;b.dockCd=MUiSize_dockCd;b.setDockCd=MUiSize_setDockCd;b.left=MUiSize_left;b.setLeft=MUiSize_setLeft;b.top=MUiSize_top;b.setTop=MUiSize_setTop;b.location=MUiSize_location;b.setLocation=MUiSize_setLocation;b.refreshLocation=MUiSize_refreshLocation;b.width=MUiSize_width;
b.setWidth=MUiSize_setWidth;b.height=MUiSize_height;b.setHeight=MUiSize_setHeight;b.size=MUiSize_size;b.setSize=MUiSize_setSize;b.refreshSize=MUiSize_refreshSize;b.setBounds=MUiSize_setBounds;b.refreshBounds=MUiSize_refreshBounds;b.dispose=MUiSize_dispose;b.innerDump=MUiSize_innerDump;return b}function MUiSize_construct(){this._location=new SPoint2;this._size=new SUiSize2}function MUiSize_dockCd(){return this._dockCd}function MUiSize_setDockCd(b){this._dockCd=b}
function MUiSize_left(){return this._location.x}function MUiSize_setLeft(b){this.setLocation(b,null)}function MUiSize_top(){return this._location.y}function MUiSize_setTop(b){this.setLocation(null,b)}function MUiSize_location(){return this._location}function MUiSize_setLocation(b,d){var f=this.panel(EPanel.Size);null!=b&&(this._location.x=b,f&&!f.__fragment&&(f.style.left=0==b?null:b+"px"));null!=d&&(this._location.y=d,f&&!f.__fragment&&(f.style.top=0==d?null:d+"px"))}
function MUiSize_refreshLocation(){this.setLocation(this._location.x,this._location.y)}function MUiSize_width(){return this._size.width}function MUiSize_setWidth(b){this.setSize(b,null)}function MUiSize_height(){return this._size.width}function MUiSize_setHeight(b){this.setSize(null,b)}function MUiSize_size(){return this._size}
function MUiSize_setSize(b,d){var f=this.panel(EPanel.Size);null!=b&&(this._size.width=b,f&&!f.__fragment&&("TD"==f.tagName?0!=b&&(f.width=b):RString.contains(b,"%")?f.style.width=b:f.style.width=0==b?null:b+"px"));null!=d&&(this._size.height=d,f&&!f.__fragment&&("TD"==f.tagName?0!=d&&(f.height=d):RString.contains(d,"%")?f.style.height=d:f.style.height=0==d?null:d+"px"))}function MUiSize_refreshSize(){this.setSize(this._size.width,this._size.height)}
function MUiSize_setBounds(b,d,f,h){this.setLocation(b,d);this.setSize(f,h)}function MUiSize_refreshBounds(){this.refreshLocation();this.refreshSize()}function MUiSize_dispose(){var b=this._location;b&&(b.dispose(),this._location=null);if(b=this._size)b.dispose(),this._size=null}function MUiSize_innerDump(b,d){b.append("MUiSize:");b.append(this.left,",",this.top,"-",this.width,",",this.height,"]")}
function MUiSizeable(b){b=RClass.inherits(this,b);b.isSizeable=!0;b.onSize=null;b.inSizeRange=RMethod.virtual(b,"inSizeRange");b.cursor=MUiSizeable_cursor;b.setCursor=MUiSizeable_setCursor;b.resize=MUiSizeable_resize;b.setBounds=MUiSizeable_setBounds;b.startDrag=MUiSizeable_startDrag;b.stopDrag=MUiSizeable_stopDrag;return b}
function MUiSizeable_cursor(){var b=RWindow.source();if(!this.inSizeRange(b))return ECursor.Default;for(var d=this.panel(EPanel.Border),f=RHtml.rect(d),h=RWindow.offsetPos(),h=new TPoint(h.x-f.left,h.y-f.top);b;){h.x+=b.offsetLeft+b.clientLeft;h.y+=b.offsetTop+b.clientTop;if(b==d)break;b=b.offsetParent}b=EMoveSize.Border;d=EMoveSize.Range;x=h.x;y=h.y;h=f.width();f=f.height();return 0<=x&&x<=d&&0<=y&&y<=d?ECursor.NorthWest:0<=x&&x<=d&&y>=f-d&&y<=f?ECursor.SouthWest:x>=h-d&&x<=h&&y>=f-d&&y<=f?ECursor.SouthEast:
x>=h-d&&x<=h&&0<=y&&y<=d?ECursor.NorthEast:0<=x&&x<b&&y>d&&y<f-d?ECursor.West:x>d&&x<h-d&&y>=f-b&&y<=f?ECursor.South:x>=h-b&&x<=h&&y>d&&y<f-d?ECursor.East:x>d&&x<h-d&&0<=y&&y<b?ECursor.North:ECursor.Default}function MUiSizeable_setCursor(b){b||(b=this.cursor());var d=this.panel(EPanel.Size);d&&(d.style.cursor=null==b||"default"==b?"default":b+"-resize")}
function MUiSizeable_resize(b,d){var f=!1,h=this.htmlPanel(EPanel.Border).style;null!=b&&(b=Math.max(parseInt(b),EMoveSize.MinWidth),this.width!=b&&(this.width=b,h.pixelWidth=b,f=!0));null!=d&&(d=Math.max(parseInt(d),EMoveSize.MinHeight),this.height!=d&&(this.height=d,h.pixelHeight=d,f=!0));if(f&&this.onSize)this.onSize()}
function MUiSizeable_setBounds(b,d,f,h,q){var z=!1,A=this.htmlPanel(EPanel.Border).style;null!=b&&(b=null==f||null!=f&&f-b>EMoveSize.MinWidth?Math.max(b,0):this.left,q||this.left!=b)&&(this.left=b,A.pixelLeft=b,z=!0);null!=d&&(d=null==h||null!=h&&h-d>EMoveSize.MinHeight?Math.max(d,0):this.top,q||this.top!=d)&&(this.top=d,A.pixelTop=d,z=!0);null!=f&&(b=Math.max(f-this.left+1,EMoveSize.MinWidth),q||this.width!=b)&&(this.width=b,A.pixelWidth=this.width,z=!0);null!=h&&(h=Math.max(h-this.top+1,EMoveSize.MinHeight),
q||this.height!=h)&&(this.height=h,A.pixelHeight=this.height,z=!0);if(z&&this.onSize)this.onSize()}function MUiSizeable_startDrag(){}function MUiSizeable_stopDrag(){}function MUiStorage(b){b=RClass.inherits(this,b);b._storageCode=null;b._storageObject=null;b.storageGet=MUiHorizontal_storageGet;b.storageGetBoolean=MUiHorizontal_storageGetBoolean;b.storageSet=MUiHorizontal_storageSet;b.storageUpdate=MUiHorizontal_storageUpdate;b.dispose=MUiHorizontal_dispose;return b}
function MUiHorizontal_storageGet(b,d){if(null==b)throw new TError(this,"Name is empty.");var f=this._storageObject;f||(f=RWindow.storage(EScope.Local).get(this._storageCode),f=this._storageObject=RJson.parse(f,Object));return f&&(f=f[b],null!=f)?f:d}function MUiHorizontal_storageGetBoolean(b,d){var f=this.storageGet(b,d);return RBoolean.parse(f)}
function MUiHorizontal_storageSet(b,d){if(null==b)throw new TError(this,"Name is empty.");var f=this._storageObject;f||(f=this._storageObject={});f[b]=d}function MUiHorizontal_storageUpdate(){var b=this._storageObject;if(b){var d=RWindow.storage(EScope.Local),b=RJson.toString(b);d.set(this._storageCode,b)}}function MUiHorizontal_dispose(){this._storageObject=this._storageCode=null}
function MUiStyle(b){b=RClass.inherits(this,b);b.construct=RMethod.empty;b.styleName=MUiStyle_styleName;b.styleIcon=MUiStyle_styleIcon;b.styleIconPath=MUiStyle_styleIconPath;b.dispose=RMethod.empty;return b}function MUiStyle_styleName(b,d){var f=RClass.name(d?d:this);return RClass.forName(f).style(b)}function MUiStyle_styleIcon(b,d){return RClass.name(d?d:this,!0)+"_"+b}function MUiStyle_styleIconPath(b,d){return RResource.iconPath(RClass.name(d?d:this,!0)+"_"+b)}
function MUiValue(b){b=RClass.inherits(this,b);b.get=RMethod.empty;b.set=RMethod.empty;return b}function MUiVertical(b){b=RClass.inherits(this,b);b.setVisible=MUiHorizontal_setVisible;return b}function MUiHorizontal_setVisible(b){var d=this.hPanelLine;d&&RHtml.displaySet(d,b)}function SServiceInfo(){this.url=this.action=this.service=null;return this}function SUiSize2(b,d){SSize2.call(this,b,d);this.parse=SUiSize2_parse;return this}
function SUiSize2_parse(b){b=b.split(",");if(2==b.length){var d=b[0];RString.contains(d,"%")?this.width=d:this.width=parseInt(d);b=b[1];RString.contains(b,"%")?this.height=b:this.height=parseInt(b)}else throw new TError(this,"Parse value failure. (value={1})",b);}function TDatasetFetchArg(b){b||(b=this);b.datasets=new TDictionary;b.saveConfig=TDatasetFetchArg_saveConfig;b.process=TDatasetFetchArg_process;return b}function TDatasetFetchArg_saveConfig(b){b.set("name",this.name)}
function TDatasetFetchArg_process(){this.owner?this.callback.call(this.owner,this):this.callback(this)}function TDatasetFetchArg_push(b){RClass.isClass(b,TSearchItem)?this.searchs.push(b):RClass.isClass(b,TOrderItem)&&this.orders.push(b)}function TDatasetFetchArg_invoke(){this.callback&&this.callback.invoke(this)}
function TEvent(b,d,f){this.owner=b;this.code=d;this.type=null;this.onProcess=f;this.isBefore=TEvent_isBefore;this.isAfter=TEvent_isAfter;this.process=TEvent_process;this.dump=TEvent_dump;return this}function TEvent_isBefore(){return EEventType.Before==this.type}function TEvent_isAfter(){return EEventType.After==this.type}
function TEvent_process(){if(!this.onProcess)return RMessage.fatal(this,null,"Process event is null. (owner={1})",RClass.dump(this.owner));var b=new TSpeed(this,"Process event (owner={0}, process={1})",this.owner,RMethod.name(this.onProcess));if(this.owner)this.onProcess.call(this.owner,this);else this.onProcess();b.record()}function TEvent_dump(){return RClass.typeOf(this)+" ["+this.owner+","+this.type+"-"+this.code+"]"}
function TEventProcess(b,d,f){this.owner=b;this.invoke=d;this.clazz=RClass.name(f);this.invokeCd=EEventInvoke.Unknown;this.isBefore=TEventProcess_isBefore;this.isAfter=TEventProcess_isAfter;this.dispose=TEventProcess_dispose;this.dump=TEventProcess_dump;return this}function TEventProcess_isBefore(){return this.invokeCd==EEventInvoke.Before}function TEventProcess_isAfter(){return this.invokeCd==EEventInvoke.After}
function TEventProcess_dispose(){this.invokeCd=this.clazz=this.invoke=this.owner=null}function TEventProcess_dump(){return RClass.dump(this)+":owner="+this.owner+",type="+this.type+".invoke="+RMethod.name(this.invoke)}function THtmlEvent(){this.linker=null;this.events={};this.push=THtmlEvent_push;this.dispose=THtmlEvent_dispose;this.dump=THtmlEvent_dump;return this}
function THtmlEvent_push(b,d){var f=this.events,h=f[b];h||(h=[],h.handle=d.handle,f[b]=h);f=h.length;if(0<f)for(var q=d.annotation.name(),z=0;z<f;z++){var A=h[z].annotation.name();if(A==q)throw new TError(this,"Duplicate event for same control. (name={1}, source={2}, event={3})\n{4}\n{5}",A,RClass.dump(d.source),RClass.dump(d),RString.repeat("-",60),this.dump());}h[h.length]=d}
function THtmlEvent_dispose(){for(var b in this.events){var d=this.events[b];d.length&&(this.linker[d.handle]=null)}this.linker.linker&&this.linker.removeAttribute("link")}function THtmlEvent_dump(){var b=this.events,d=new TString,f;for(f in b){var h=b[f],q=h.length;d.append("event="+f+" (count="+q+")\n");for(var z=0;z<q;z++){var A=h[z];d.append("   "+z+" source="+RClass.dump(A.source)+", event="+RClass.dump(A)+"\n")}}return d.flush()}
function THtmlEvent_load(b){this.ctrlKey=b.ctrlKey;this.keyCode=b.keyCode}function TOrderItem(b){b||(b=this);return b}function TOrderItem_set(b,d){this.name=b;this.type=d}function TOrderItem_toNode(){var b=new TNode("OrderItem");b.set("name",this.name);b.set("type",this.type);return b}function TOrderItem_pack(){var b=new TAttributes;b.set("name",this.name);b.set("type",this.type);return b.pack()}
function TOrderItem_unpack(b){var d=new TAttributes;d.unpack(b);this.name=d.get("name");this.type=d.get("type")}function TOrderItems(b){b||(b=this);TObjects(b)}function TOrderItems_pack(){for(var b=new TStrings,d=this.count,f=0;f<d;f++){var h=this.get(f).pack();b.push(h)}return b.pack()}function TOrderItems_unpack(b){this.clear();var d=new TStrings;d.unpack(b);for(b=0;b<d.count;b++){t=d.get(b);var f=new TOrderItem;f.unpack(t);this.push(f)}}function TSearchItem(b){b||(b=this);return b}
function TSearchItem_set(b,d,f,h){this.name=b;this.type=RString.nvl(f,ESearch.Equals);this.value=d;this.format=h}function TSearchItem_toNode(){var b=new TNode("SearchItem");b.set("name",this.name);b.set("type",this.type);b.set("value",this.value);b.set("format",this.format);return b}function TSearchItem_equals(b){return this.name==b.name&&this.type==b.type&&this.value==b.value?!0:!1}
function TSearchItem_pack(){var b=new TAttributes;b.set("name",this.name);b.set("type",this.type);b.set("value",this.value);b.set("format",this.format);return b.pack()}function TSearchItem_unpack(b){var d=new TAttributes;d.unpack(b);this.name=d.get("name");this.type=d.get("type");this.value=d.get("value");this.format=d.get("format")}function TSearchItems(b){b||(b=this);TObjects(b)}
function TSearchItems_pack(){for(var b=new TStrings,d=this.count,f=0;f<d;f++){var h=this.get(f).pack();b.push(h)}return b.pack()}function TSearchItems_removeAll(b){if(null!=b){for(var d=0,f=this.count,h=d;h<f;h++)this.memory[h].equals(b)||(this.memory[d++]=this.memory[h]);this.count=d}}
function TSearchItems_unpack(b){this.clear();var d=new TStrings;d.unpack(b);for(var f=0;f<d.count;f++){t=d.get(f);var h=new TSearchItem;h.unpack(t);RString.isEmpty(h.name)?(this.clear(),RMessage.fatal(this,"unpack","Invalid value (value={1})",b)):this.push(h)}}function FUiCanvas(b){b=RClass.inherits(this,b,FUiControl);b._styleCanvas=RClass.register(b,new AStyle("_styleCanvas"));b.onBuildPanel=FUiCanvas_onBuildPanel;b.construct=FUiCanvas_construct;b.dispose=FUiCanvas_dispose;return b}
function FUiCanvas_onBuildPanel(b){this._hPanel=RBuilder.create(b,"CANVAS",this.styleName("Canvas"))}function FUiCanvas_construct(){this.__base.FUiControl.construct.call(this)}function FUiCanvas_dispose(){this.__base.FUiControl.dispose.call(this)}
function FUiComponent(b){b=RClass.inherits(this,b,FObject,MProperty,MClone);b._name=RClass.register(b,new APtyString("_name"));b._label=RClass.register(b,new APtyString("_label"));b._parent=null;b._components=null;b._tag=null;b.oeInitialize=FUiComponent_oeInitialize;b.oeRelease=FUiComponent_oeRelease;b.name=FUiComponent_name;b.setName=FUiComponent_setName;b.label=FUiComponent_label;b.setLabel=FUiComponent_setLabel;b.tag=FUiComponent_tag;b.setTag=FUiComponent_setTag;b.isParent=FUiComponent_isParent;
b.topComponent=FUiComponent_topComponent;b.hasComponent=FUiComponent_hasComponent;b.findComponent=FUiComponent_findComponent;b.components=FUiComponent_components;b.push=FUiComponent_push;b.remove=FUiComponent_remove;b.clear=FUiComponent_clear;b.process=FUiComponent_process;b.psInitialize=FUiComponent_psInitialize;b.psRelease=FUiComponent_psRelease;b.toString=FUiComponent_toString;b.dispose=FUiComponent_dispose;b.innerDumpInfo=FUiComponent_innerDumpInfo;b.innerDump=FUiComponent_innerDump;return b}
function FUiComponent_oeInitialize(b){return EEventStatus.Continue}function FUiComponent_oeRelease(b){return EEventStatus.Continue}function FUiComponent_name(){return this._name}function FUiComponent_setName(b){this._name=b}function FUiComponent_label(){return this._label}function FUiComponent_setLabel(b){this._label=b}function FUiComponent_tag(){return this._tag}function FUiComponent_setTag(b){this._tag=b}function FUiComponent_isParent(b){for(;b;){if(b==this)return!0;b=b._parent}}
function FUiComponent_topComponent(b){var d=this;if(b)for(;RClass.isClass(d._parent,b);)d=d._parent;else for(;d._parent;)d=d._parent;return d}function FUiComponent_hasComponent(){var b=this._components;return b?!b.isEmpty():!1}function FUiComponent_findComponent(b){var d=this._components;return d?d.get(b):null}function FUiComponent_components(){var b=this._components;null==b&&(this._components=b=new TDictionary);return b}
function FUiComponent_push(b){if(RClass.isClass(b,FUiComponent)){var d=this.components();b._parent=this;null==b._name&&(b._name=d.count());d.set(b._name,b)}}function FUiComponent_remove(b){if(!RClass.isClass(b,FUiComponent))throw new TError(this,"Parameter is not componet. (component={1})",b);var d=this._components;if(!d.contains(b.name()))throw new TError(this,"Parameter component is not in this component. (name={1})",b.name());d.removeValue(b)}
function FUiComponent_clear(b){(b=this._components)&&b.clear()}
function FUiComponent_process(b){var d=this.__base[b.clazz];if(d){b.invokeCd=EEventInvoke.Before;var f=this[b.invoke];if(!f)return RLogger.fatal(this,null,"Process invoke before is null. (sender={1}, invoke={2})",RClass.dump(this),b.invoke);f=f.call(this,b);if(f==EEventStatus.Stop||f==EEventStatus.Cancel)return f}if(RClass.isClass(this,MUiContainer)){var h=this._components;if(h){var q=h.count();if(q)for(var z=0;z<q;z++)if(f=h.valueAt(z).process(b),f==EEventStatus.Cancel)return f}}if(d){b.invokeCd=
EEventInvoke.After;f=this[b.invoke];if(!f)return RLogger.fatal(this,null,"Process invoke after is null. (sender={1}, invoke={2})",RClass.dump(this),b.invoke);f=f.call(this,b);if(f==EEventStatus.Stop||f==EEventStatus.Cancel)return f}return EEventStatus.Continue}function FUiComponent_psInitialize(){var b=new TEventProcess(this,"oeInitialize",FUiComponent);this.process(b);b.dispose()}
function FUiComponent_psRelease(){var b=new TEventProcess(this,"oeRelease",FUiComponent);this.process(b);b.dispose()}function FUiComponent_toString(){return RClass.dump(this)+":label="+this._label}function FUiComponent_dispose(){this._tag=this._label=this._name=this._parent=null;var b=this._components;b&&(b.dispose(),this._components=null);this.__base.FObject.dispose.call(this)}
function FUiComponent_innerDumpInfo(b){b.append(RClass.dump(this));b.append(",name=",this._name);b.append(",label=",this._label)}function FUiComponent_innerDump(b,d){this.innerdumpInfo(b);var f=this.components;if(f){b.appendLine();for(var h=f.count,q=0;q<h;q++){var z=f.value(q);z&&z.innerDump(b,d+1)}}return b}
function FUiContainer(b){b=RClass.inherits(this,b,FUiControl,MUiContainer);b._scrollCd=RClass.register(b,new APtyEnum("_scrollCd",null,EUiScroll,EUiScroll.None));b._controls=null;b.oeDesign=RMethod.empty;b.construct=FUiContainer_construct;b.hasControl=FUiContainer_hasControl;b.findControl=FUiContainer_findControl;b.searchControl=FUiContainer_searchControl;b.controls=FUiContainer_controls;b.panel=FUiContainer_panel;b.focusFirstControl=FUiContainer_focusFirstControl;b.setControlsProperty=FUiContainer_setControlsProperty;
b.storeConfig=FUiContainer_storeConfig;b.push=FUiContainer_push;b.remove=FUiContainer_remove;b.clear=FUiContainer_clear;b.dispose=FUiContainer_dispose;return b}function FUiContainer_construct(){this.__base.FUiControl.construct.call(this)}function FUiContainer_hasControl(){var b=this._controls;return b?!b.isEmpty():!1}function FUiContainer_findControl(b){var d=this._controls;if(d)for(var f=d.count(),h=0;h<f;h++){var q=d.value(h);if(q.name()==b)return q}return null}
function FUiContainer_searchControl(b){var d=this._controls;if(d)for(var f=d.count(),h=0;h<f;h++){var q=d.value(h);if(q.name()==b||RClass.isClass(q,FUiContainer)&&(q=q.searchControl(b)))return q}return null}function FUiContainer_controls(){var b=this._controls;null==b&&(this._controls=b=new TDictionary);return b}function FUiContainer_panel(b){return b==EPanel.Container?this._hPanel:this.__base.FUiControl.panel.call(this,b)}
function FUiContainer_focusFirstControl(){var b=this._components;if(b){for(var d=b.count(),f=0;f<d;f++)if(b.valueAt(f),RClass.isClass(d,MUiFocus)&&d.testFocus()&&!RClass.isClass(d,FCalendar)&&!RClass.isClass(d,FSelect)&&!RClass.isClass(d,FNumber))return d.focus();RConsole.find(FFocusConsole).focus(this)}}function FUiContainer_setControlsProperty(b,d){var f=this._controls;if(f)for(var h=f.count()-1;0<=h;h--)f.value(h)[b]=d[n]}
function FUiContainer_storeConfig(b){b.name=RClass.name(this);this.saveConfig(b);var d=this._components;if(d)for(var f=d.count(),h=0;h<f;h++){var q=d.value(h),z=b.create(RClass.name(q));RClass.isClass(q,FUiContainer)?q.storeConfig(z):q.saveConfig(z)}}function FUiContainer_push(b){this.__base.FUiControl.push.call(this,b);RClass.isClass(b,FUiControl)&&(this.controls().set(b._name,b),this.appendChild(b))}
function FUiContainer_remove(b){if(RClass.isClass(b,FUiControl)){var d=this._controls;if(!d.contains(b.name()))throw new TError(this,"Parameter component is not in this component. (name={1})",b.name());d.removeValue(b);this.removeChild(b)}this.__base.FUiControl.remove.call(this,b)}function FUiContainer_clear(){var b=this._controls;if(b){for(var d=b.count()-1;0<=d;d--)this.removeChild(b.valueAt(d));b.clear()}this.__base.FUiControl.clear.call(this)}
function FUiContainer_dispose(){var b=this._controls;b&&(b.dispose(),this._controls=null);this.__base.FUiControl.dispose.call(this)}
function FUiControl(b){b=RClass.inherits(this,b,FUiComponent,MUiStyle,MUiSize,MUiPadding,MUiMargin);b._wrapCd=RClass.register(b,new APtyEnum("_wrapCd",null,EUiWrap,EUiWrap.NextLine));b._visible=RClass.register(b,new APtyBoolean("_visible"),!0);b._disable=RClass.register(b,new APtyBoolean("_disable"),!1);b._hint=RClass.register(b,new APtyString("_hint"));b._stylePanel=RClass.register(b,new AStyle("_stylePanel"));b._layoutCd=EUiLayout.Display;b._sizeCd=EUiSize.Normal;b._statusVisible=!0;b._statusEnable=
!0;b._statusBuild=!1;b._statusBuilded=!1;b._storage=null;b._hParent=null;b._hPanel=null;b.onEnter=RClass.register(b,new AEventMouseEnter("onEnter"),FUiControl_onEnter);b.onLeave=RClass.register(b,new AEventMouseLeave("onLeave"),FUiControl_onLeave);b.onBuildPanel=FUiControl_onBuildPanel;b.onBuild=FUiControl_onBuild;b.onBuilded=RMethod.empty;b.oeMode=FUiControl_oeMode;b.oeEnable=FUiControl_oeEnable;b.oeVisible=FUiControl_oeVisible;b.oeResize=FUiControl_oeResize;b.oeRefresh=FUiControl_oeRefresh;b.construct=
FUiControl_construct;b.topControl=FUiControl_topControl;b.panel=FUiControl_panel;b.wrapCd=FUiControl_wrapCd;b.setWrapCd=FUiControl_setWrapCd;b.isVisible=FUiControl_isVisible;b.setVisible=FUiControl_setVisible;b.show=FUiControl_show;b.hide=FUiControl_hide;b.isEnable=FUiControl_isEnable;b.setEnable=FUiControl_setEnable;b.enable=FUiControl_enable;b.disable=FUiControl_disable;b.attachEvent=FUiControl_attachEvent;b.linkEvent=FUiControl_linkEvent;b.callEvent=FUiControl_callEvent;b.psMode=FUiControl_psMode;
b.psDesign=FUiControl_psDesign;b.psEnable=FUiControl_psEnable;b.psVisible=FUiControl_psVisible;b.psResize=FUiControl_psResize;b.psRefresh=FUiControl_psRefresh;b.isBuild=FUiControl_isBuild;b.build=FUiControl_build;b.builded=FUiControl_builded;b.refresh=FUiControl_refresh;b.setPanel=FUiControl_setPanel;b.dispose=FUiControl_dispose;return b}function FUiControl_onEnter(b){RConsole.find(FUiFocusConsole).enter(this);this._hint&&RWindow.setStatus(this._hint)}
function FUiControl_onLeave(b){RConsole.find(FUiFocusConsole).leave(this);this._hint&&RWindow.setStatus()}function FUiControl_onBuildPanel(b){this._hPanel=RBuilder.createDiv(b,this.styleName("Panel"))}function FUiControl_onBuild(b){this.onBuildPanel(b);this._statusVisible!=this._visible&&this.setVisible(this._visible);b=this._hPanel;RHtml.linkSet(b,"control",this);this.attachEvent("onEnter",b);this.attachEvent("onLeave",b);this.refreshBounds();this.refreshPadding();this.refreshMargin()}
function FUiControl_oeMode(b){this._displayCd=b.displayCd;return EEventStatus.Continue}function FUiControl_oeEnable(b){b.isBefore()&&this.setEnable(b.enable);return EEventStatus.Continue}function FUiControl_oeVisible(b){b.isBefore()&&this.setVisible(b.visible);return EEventStatus.Continue}function FUiControl_oeResize(b){return EEventStatus.Continue}function FUiControl_oeRefresh(b){return EEventStatus.Continue}
function FUiControl_construct(){this.__base.FUiComponent.construct.call(this);this.__base.MUiStyle.construct.call(this);this.__base.MUiSize.construct.call(this);this.__base.MUiPadding.construct.call(this);this.__base.MUiMargin.construct.call(this)}function FUiControl_topControl(b){var d=this;if(b){for(;d._parent;){if(RClass.isClass(d._parent,b))return d._parent;d=d._parent}if(!RClass.isClass(d,b))return null}else for(;d._parent&&RClass.isClass(d._parent,FUiControl);)d=d._parent;return d}
function FUiControl_panel(b){switch(b){case EPanel.Parent:return this._hParent;case EPanel.Container:case EPanel.Size:return this._hPanel}return null}function FUiControl_wrapCd(){return this._wrapCd}function FUiControl_setWrapCd(b){this._wrapCd=b}function FUiControl_isVisible(){return this._statusVisible}function FUiControl_setVisible(b){this._statusVisible=b;var d=this.panel(EPanel.Container);d&&RHtml.visibleSet(d,b)}function FUiControl_show(){this._statusVisible||this.setVisible(!0)}
function FUiControl_hide(){this._statusVisible&&this.setVisible(!1)}function FUiControl_isEnable(){return this._statusEnable}function FUiControl_setEnable(b){this._statusEnable=b;var d=this.panel(EPanel.Container);d&&(d.style.disabled=!b)}function FUiControl_enable(){this._statusEnable||this.setEnable(!0)}function FUiControl_disable(){this._statusEnable&&this.setEnable(!1)}function FUiControl_attachEvent(b,d,f,h){return RUiControl.attachEvent(this,b,d,f,h)}
function FUiControl_linkEvent(b,d,f,h){return RUiControl.linkEvent(this,b,d,f,h)}function FUiControl_callEvent(b,d,f){var h=this._events;h&&(b=h.get(b))&&b.invoke(d,d,f)}function FUiControl_psMode(b){var d=new TEventProcess(this,"oeMode",FUiControl);d.displayCd=b;this.process(d);d.dispose()}function FUiControl_psDesign(b,d){RConsole.find(FDesignConsole).setFlag(b,d,this);var f=new TEventProcess(this,"oeDesign",MDesign);f.mode=b;f.flag=d;this.process(f);f.dispose()}
function FUiControl_psEnable(b){var d=new TEventProcess(this,"oeEnable",FUiControl);d.enable=b;this.process(d);d.dispose()}function FUiControl_psVisible(b){var d=new TEventProcess(this,"oeVisible",FUiControl);d.visible=b;this.process(d);d.dispose()}function FUiControl_psResize(){var b=new TEventProcess(this,"oeResize",FUiControl);this.process(b);b.dispose()}function FUiControl_psRefresh(b){b=new TEventProcess(this,"oeRefresh",FUiControl);this.process(b);b.dispose()}
function FUiControl_isBuild(){return this._statusBuild}
function FUiControl_build(b){if(this._statusBuild)throw new TError(this,"Current control is already builded.");var d=null;if(b.createElement)d=b;else if(b.ownerDocument&&b.ownerDocument.createElement)d=b.ownerDocument;else if(b.hDocument)d=b.hDocument;else throw new TError("Build document is invalid. (document={1})",b);b=new SArguments;b.owner=this;b.hDocument=d;this.onBuild(b);b.owner=null;b.hDocument=null;RObject.free(b);this._statusBuild=!0}
function FUiControl_builded(b){if(!this._statusBuild)throw new TError(this,"Current control is not build.");if(this._statusBuilded)throw new TError(this,"Current control is already builded.");this.onBuilded(b);this._statusBuilded=!0}function FUiControl_refresh(){if(!this._statusBuild)throw new TError(this,"Current control is not build.");}function FUiControl_setPanel(b){this._hParent=b;b.appendChild(this._hPanel)}
function FUiControl_dispose(){this._hParent=this._statusBuild=this._statusEnable=this._statusVisible=this._styleContainer=this._hint=this._wrapCd=this._disable=null;this._hPanel=RHtml.free(this._hPanel);this.__base.MUiMargin.dispose.call(this);this.__base.MUiPadding.dispose.call(this);this.__base.MUiSize.dispose.call(this);this.__base.MUiStyle.dispose.call(this);this.__base.FUiComponent.dispose.call(this)}
function FUiWorkspace(b){b=RClass.inherits(this,b,FUiContainer,MUiDescribeFrame);b._stylePanel=RClass.register(b,new AStyle("_stylePanel"));b._frames=null;b._hContainer=null;b.onBuildPanel=FUiWorkspace_onBuildPanel;b.appendChild=FUiWorkspace_appendChild;return b}function FUiWorkspace_onBuildPanel(b){this._hPanel=RBuilder.createDiv(b,this.styleName("Panel"))}
function FUiWorkspace_appendChild(b){if(RClass.isClass(b,FUiFrameSet))this._hPanel.appendChild(b._hPanel);else throw new TError(this,"Unknown child type.");}
var RUiControl=new function(){this.PREFIX="FUi";this.newInstance=RUiControl_newInstance;this.attachEvent=RUiControl_attachEvent;this.innerCreate=RUiControl_innerCreate;this.create=RUiControl_create;this.innerbuild=RUiControl_innerbuild;this.build=RUiControl_build;this.setStyleScroll=RUiControl_setStyleScroll;this.inDesign=this.inSizing=this.inMoving=!1;this.instances=new TList;this.events=new TMap;this.controls=new TMap;this.linkEvent=RUiControl_linkEvent;this.find=RUiControl_find;this.fromNode=RUiControl_fromNode;
this.fromXml=RUiControl_fromXml;this.toNode=RUiControl_toNode;this.toXml=RUiControl_toXml;this.store=RUiControl_store;this.htmlControl=RUiControl_htmlControl;this.psDesign=RUiControl_psDesign;this.psMode=RUiControl_psMode;this.isInfo=RUiControl_isInfo;this.isGroup=RUiControl_isGroup;return this};
function RUiControl_newInstance(b){var d=null;if(b){var f=d=null;if(b.constructor==String)RString.startsWith(b,this.PREFIX)||(d=this.PREFIX+b);else if(b.constructor==TXmlNode)d=b.get("type"),RString.isEmpty(d)?(d=b.name(),RString.startsWith(d,this.PREFIX)||(d=this.PREFIX+d)):f=d;else throw new TError(this,"Unknown parameter. (name={p})",b);d=RClass.create(d);f&&(d.__typed=!0)}if(null==d)throw new TError(this,"Create instance failure. (name={p})",b);return d}
function RUiControl_attachEvent(b,d,f,h,q){var z=null,A=b[d];if(!RMethod.isEmpty(A)||h)d=RClass.find(b.constructor).annotation(EAnnotation.Event,d),z=d.create(),z.annotation=d,z.source=b,z.hSource=f,z.ohProcess=h,z.onProcess=A,z.process=RUiEvent.onProcess,RUiEvent.find(f).push(d.linker(),z),RHtml.linkSet(f,"_plink",b),d.bind(f,q);return z}
function RUiControl_innerCreate(b,d,f){if(null!=b&&null!=d&&(RClass.isClass(b,MProperty)&&b.propertyLoad(d),RClass.isClass(b,MUiContainer)&&d.hasNode())){d=d.nodes();for(var h=d.count(),q=0;q<h;q++){var z=d.get(q),A=b.createChild(z,f);A&&(this.innerCreate(A,z,f),b.push(A))}}}function RUiControl_create(b,d,f){var h=null,h=b?b:RUiControl.newInstance(d.name());this.innerCreate(h,d,f);return h}
function RUiControl_innerbuild(b,d,f,h,q){if(null!=d&&null!=f){RClass.isClass(d,MProperty)&&d.propertyLoad(f);var z=f.get("linker");z&&b&&(b[z]=d);RClass.isClass(d,FUiControl)&&(d.isBuild()?d.refresh():d.build(q));d.__typed&&(b=d);if(RClass.isClass(d,MUiContainer)&&f.hasNode()){f=f.nodes();for(var z=f.count(),A=0;A<z;A++){var B=f.get(A),C=d.createChild(B);if(!C)throw new TError("Invalid create child.");this.innerbuild(b,C,B,h,q);d.push(C)}}RClass.isClass(d,FUiControl)&&d.builded(q)}}
function RUiControl_build(b,d,f,h){b||(b=RUiControl.newInstance(d));this.innerbuild(b,b,d,f,h);return b}
function RUiControl_setStyleScroll(b,d){var f=b.style;switch(d){case EUiScroll.None:f.overflowX="";f.overflowY="";break;case EUiScroll.Horizontal:f.overflowX="scroll";break;case EUiScroll.HorizontalAuto:f.overflowX="auto";break;case EUiScroll.Vertical:f.overflowY="scroll";break;case EUiScroll.VerticalAuto:f.overflowY="auto";break;case EUiScroll.Both:f.overflow="scroll";break;case EUiScroll.BothAuto:f.overflow="auto";break;default:throw new TError(o,"Unknown scroll type. (scroll_cd={1})",d);}}
function RUiControl_linkEvent(b,d,f,h,q){var z=b[f];if(!RMethod.isEmpty(z)||q){f=RClass.find(c.constructor).annotation(EAnnotation.Event,f);var A=new f.constructor;A.name=f.name;A.source=b;A.sender=d;A.hSource=h;A.ohProcess=q;A.onProcess=z;A.process=RUiEvent.onProcess;RUiEvent.find(h).push(A.type,A);h[A.handle]=RUiEvent.ohEvent;RHtml.linkSet(h,"_plink",b);return A}}
function RUiControl_find(b){var d=null;if(b){b.constructor==Function?b=RMethod.name(b):b.constructor!=String&&RMsg.fatal(this,null,"Param invlid (class={0})",b);var f=this.controls,d=f.get(b);d||(d=new TControl(b),f.set(b,d))}return d}function RUiControl_fromNode(b,d){if(b)return this.create(b,d)}function RUiControl_fromXml(b,d,f){var h=null;(b=RXml.makeNode(b))&&(h=this.create(b,d,f));return h}function RUiControl_toNode(){}function RUiControl_toXml(){}
function RUiControl_store(b,d){var f=new TNode;f.name=RClass.name(b).substr(1);RClass.isClass(b,FContainer)?b.storeConfig(f):b.saveConfig(f);return f}function RUiControl_htmlControl(b,d){if(d)for(;b;){var f=RHtml.linkGet(b,"control");if(f&&RClass.isClass(f,d))return f;b=b.parentElement}else for(;b;){if(f=RHtml.linkGet(b,"control"))return f;b=b.parentElement}return null}
function RUiControl_psDesign(b,d,f,h){var q=this.instances;if(q&&q.count)for(var z=q.count,A=0;A<z;A++)q.get(A).psDesign(b,d,f,h)}function RUiControl_psMode(b,d,f,h){var q=this.instances;if(q&&q.count)for(var z=q.count,A=0;A<z;A++)q.get(A).psMode(b,d,f,h)}function RUiControl_isInfo(b){return b?0==b.indexOf("C#"):!1}function RUiControl_isGroup(b){return b?0==b.indexOf("G#"):!1}
var RUiEvent=new function(){this._objects=[];this.ohEvent=RUiEvent_ohEvent;this.onProcess=RUiEvent_onProcess;this.find=RUiEvent_find;this.process=RUiEvent_process;this.release=RUiEvent_release;this.current=0;this.events=[];this.nvl=RUiEvent_nvl;this.alloc=RUiEvent_alloc;this.free=RUiEvent_free;return this};function RUiEvent_ohEvent(b){RUiEvent.process(this,b?b:window.event)}
function RUiEvent_onProcess(b){b=this;var d=b.annotation;d._logger&&RLogger.debug(b,"Process {1}. (source={2}, html={3}, process={4})",d._handle,RClass.dump(b.source),RClass.dump(b.hSource),RMethod.name(b.onProcess));b.sender?b.onProcess.call(b.source,b.sender,b):b.onProcess.call(b.source,b)}function RUiEvent_find(b){var d=RHtml.uid(b),f=this._objects,h=f[d];null==h&&(h=f[d]=new THtmlEvent,h.linker=b);return h}
function RUiEvent_process(b,d){if(b&&d){var f=this.find(b);if(f&&(f=f.events[d.type])){for(var h=f.length,q=0;q<h;q++){var z=f[q],A=z.annotation;z.source=RHtml.linkGet(b,"_plink");z.hSender=RHtml.eventSource(d);z.sender=z.hSender._plinker;z.hSource=b;A.attach(z,d);z.ohProcess?(A._logger&&RLogger.debug(z,"Execute {1}. (source={2}, html={3}, process={4})",A._handle,RClass.dump(z.source),RClass.dump(z.hSource),RMethod.name(z.ohProcess)),z.ohProcess.call(z.source,z)):z.onProcess&&RConsole.find(FUiFrameEventConsole).push(z)}return!0}return!1}}
function RUiEvent_release(){var b=this._objects;b&&(RMemory.free(b),this._objects=null)}function RUiEvent_nvl(b,d,f){b||(b=new TEvent);b.sender=d;b.code=f;return b}function RUiEvent_alloc(b,d){for(var f=null,h=this.events,q=0;q<h.length;q++)if(!h[q].inUsing){f=h[q];break}f||(f=h[h.length]=new TEvent);f.inUsing=!0;f.sender=b;f.code=d;return f}function RUiEvent_free(b){b.inUsing=!1}var RUiLayer=new function(){this._layers=[];this.next=RUiLayer_next;this.free=RUiLayer_free;return this};
function RUiLayer_next(b){b=RInteger.nvl(b,EUiLayer.Default);var d=RInteger.nvl(this._layers[b],b);this._layers[b]=++d;return d}function RUiLayer_free(b,d){var f=RInteger.nvl(b,EUiLayer.Default),h=RInteger.nvl(this._layers[f],f);--h;h>f&&(this._layers[f]=h);return h}var RUiService=new function(){this._services=new TDictionary;this.url=RUiService_url;this.makeUrl=RUiService_makeUrl;this.parse=RUiService_parse;return this};
function RUiService_url(b){if(RString.startsWith(b,"http://"))return b;if(RString.startsWith(b,"#"))return b.substr(1);RString.startsWith(b,"/")||(b="/"+b);return b+".ws"}function RUiService_makeUrl(b,d){return this.url(b)+"?action="+d}
function RUiService_parse(b){var d=null,f=this._services;if(b){d=f.get(b);if(null==d){var h=b.split("@");1==h.length?h[0]&&(d=new SServiceInfo,d.service=h[0],d.action=null,d.url=this.url(h[0])):2==h.length&&h[0]&&h[1]&&(d=new SServiceInfo,d.service=h[1],d.action=h[0],d.url=this.url(h[1])+"?action="+h[0])}if(null==d)throw new TError(this,"Unknown service format. (source={1})",b);f.set(b,d)}return d}
function FUiConfirmDialog(b){b=RClass.inherits(this,b,FUiDialog,MListenerResult);b._styleText=RClass.register(b,new AStyle("_styleText"));b._frameName="system.dialog.ConfirmDialog";b._controlText=null;b._controlConfirmButton=null;b._controlCancelButton=null;b.onBuilded=FUiConfirmDialog_onBuilded;b.onConfirmClick=FUiConfirmDialog_onConfirmClick;b.onCancelClick=FUiConfirmDialog_onCancelClick;b.construct=FUiConfirmDialog_construct;b.setText=FUiConfirmDialog_setText;b.dispose=FUiConfirmDialog_dispose;
return b}function FUiConfirmDialog_onBuilded(b){this.__base.FUiDialog.onBuilded.call(this,b);this._controlText._hPanel.className=this.styleName("Text");this._controlConfirmButton.addClickListener(this,this.onConfirmClick);this._controlCancelButton.addClickListener(this,this.onCancelClick)}function FUiConfirmDialog_onConfirmClick(b){b=new SEvent;b.sender=this;b.resultCd=EResult.Success;this.processResultListener(b);b.dispose();this.hide()}
function FUiConfirmDialog_onCancelClick(b){b=new SEvent;b.sender=this;b.resultCd=EResult.Cancel;this.processResultListener(b);b.dispose();this.hide()}function FUiConfirmDialog_construct(){this.__base.FUiDialog.construct.call(this)}function FUiConfirmDialog_setText(b){this._controlText.set(b)}function FUiConfirmDialog_dispose(){this.__base.FUiDialog.dispose.call(this)}
function FUiDescribeFrameConsole(b){b=RClass.inherits(this,b,FConsole);b._scopeCd=EScope.Global;b._service="cloud.describe.frame";b._defines=null;b.lsnsLoaded=null;b.construct=FUiDescribeFrameConsole_construct;b.load=FUiDescribeFrameConsole_load;b.events=null;b.formId=0;b.createFromName=FUiDescribeFrameConsole_createFromName;b.loadNode=FUiDescribeFrameConsole_loadNode;b.loadService=FUiDescribeFrameConsole_loadService;b.nextFormId=FUiDescribeFrameConsole_nextFormId;b.get=FUiDescribeFrameConsole_get;
b.find=FUiDescribeFrameConsole_find;b.getLov=FUiDescribeFrameConsole_getLov;b.findLov=FUiDescribeFrameConsole_findLov;b.getEvents=FUiDescribeFrameConsole_getEvents;return b}function FUiDescribeFrameConsole_construct(){this._defines=new TDictionary;this.lsnsLoaded=new TListeners}
function FUiDescribeFrameConsole_load(b){var d=this._defines,f=d.get(b);if(f)return f;var h=new TXmlDocument,f=h.root();f.set("action","query");f=f.create("Frame");f.set("name",b);for(var f=RUiService.url(this._service),h=RConsole.find(FXmlConsole).send(f,h).nodes(),q=h.count(),z=0;z<q;z++){var f=h.at(z),A=f.get("name");d.set(A,f)}f=d.get(b);if(!f)throw new TError(this,"Unknown frame. (name={1])",b);return f}
function FUiDescribeFrameConsole_createFromName(b,d){var f=this.loadService(b,d);this.loadNode(f);return EForm.Lov==d?this.getLov(b):this.get(b)}
function FUiDescribeFrameConsole_loadNode(b){b=b.root();if(b.hasNode()){b=b.nodes;for(var d=b.count,f=0;f<d;f++){var h=b.get(f),q=h.get("name"),z=h.get("type");if(h.hasNode())for(var h=h.nodes,A=0;A<h.count;A++){var B=h.get(A);if(B.isName("Define")){if(B.hasNode())for(var B=B.nodes,C=0;C<B.count;C++){var D=B.get(C);this._defines.get(z).set(q,D)}}else B.isName("Events")&&this.events.set(q,B)}}}}
function FUiDescribeFrameConsole_loadService(b,d){d||(d=EForm.Form);var f=new TXmlDocument,h=f.root();h.set("action","loadDefine");h=h.create("WebForm");h.set("name",b);h.set("type",d);h=RUiService.url("logic.webform");f=RConsole.find(FXmlConsole).send(h,f);h=f.root();return RConsole.find(FMessageConsole).checkResult(new TMessageArg(h))?f:null}function FUiDescribeFrameConsole_nextFormId(){return++this.formId}function FUiDescribeFrameConsole_get(b){return this._defines.get(EForm.Form).get(b)}
function FUiDescribeFrameConsole_find(b,d){if(EForm.Lov==d)return this.findLov(b);var f=this.get(b);RClass.isMode(ERun.Debug)&&(RMemory.free(f),f=null,this._defines.get(EForm.Form).set(b,null));f||(f=this.createFromName(b));return f}function FUiDescribeFrameConsole_getLov(b){return this._defines.get(EForm.Lov).get(b)}function FUiDescribeFrameConsole_findLov(b){var d=this.getLov(b);d||(d=this.createFromName(b,EForm.Lov));return d}
function FUiDescribeFrameConsole_getEvents(b){return this.events.get(b)}
function FUiDesktopConsole(b){b=RClass.inherits(this,b,FConsole);b._scopeCd=EScope.Local;b._maskVisible=!1;b._statusEnable=!0;b._loadingVisible=!1;b._progressVisible=!1;b._progressBar=null;b._hMaskPanel=null;b._hLoadingPanel=null;b._hLoadingLabel=null;b.construct=FUiDesktopConsole_construct;b.getMaskPanel=FUiDesktopConsole_getMaskPanel;b.getProgressBar=FUiDesktopConsole_getProgressBar;b.getLoadingPanel=FUiDesktopConsole_getLoadingPanel;b.setMaskVisible=FUiDesktopConsole_setMaskVisible;b.isEnable=
FUiDesktopConsole_isEnable;b.enable=FUiDesktopConsole_enable;b.disable=FUiDesktopConsole_disable;b.showLoading=FUiDesktopConsole_showLoading;b.showUploading=FUiDesktopConsole_showUploading;b.showProgress=FUiDesktopConsole_showProgress;b.hide=FUiDesktopConsole_hide;return b}function FUiDesktopConsole_construct(){this.__base.FConsole.construct.call(this)}
function FUiDesktopConsole_getMaskPanel(){var b=top.RWindow._hDocument,d=this._hMaskPanel;d||(d=this._hMaskPanel=RBuilder.createTable(b,"FUiDesktopConsole_MaskPanel"),d.style.zIndex=5E3,b=this._hMaskInnerPanel=RBuilder.appendTableRowCell(d),b.align="center",b.vAlign="middle");return d}
function FUiDesktopConsole_getLoadingPanel(){var b=top.RWindow._hDocument,d=this._hLoadingPanel;d||(d=this._hLoadingPanel=RBuilder.createTable(b),b=RBuilder.appendTableRowCell(d),(this._hLoadingIcon=RBuilder.appendIcon(b)).src=RResource.iconPath("control.RWindow_Loading"),b=this._hLoadingLabel=RBuilder.appendTableRowCell(d),b.align="center",b.style.color="#FFFFFF");return d}
function FUiDesktopConsole_getProgressBar(){var b=this._progressBar;b||(b=this._progressBar=RClass.create(FUiProgressBar),b.build(top.RWindow._hDocument));return b}function FUiDesktopConsole_setMaskVisible(b){if(this._maskVisible!=b){var d=top.RWindow._hDocument.body,f=this.getMaskPanel();if(b){var h=f.style;h.left="0px";h.top="0px";d.appendChild(f)}else d.removeChild(f)}this._maskVisible=b}function FUiDesktopConsole_isEnable(){return this._statusEnable}
function FUiDesktopConsole_enable(){this._disableDeep--;0==this._disableDeep&&this.setEnable(!0)}function FUiDesktopConsole_disable(){0==this._disableDeep&&this.setEnable(!1);this._disableDeep++}function FUiDesktopConsole_showLoading(){this.setMaskVisible(!0);if(!this._loadingVisible){var b=this.getLoadingPanel();RHtml.textSet(this._hLoadingLabel,"\u6b63\u5728\u52aa\u529b\u52a0\u8f7d\u4e2d\uff0c\u8bf7\u7a0d\u7b49 ...");this._hMaskInnerPanel.appendChild(b);this._loadingVisible=!0}}
function FUiDesktopConsole_showUploading(){this.setMaskVisible(!0);if(!this._loadingVisible){var b=this.getLoadingPanel();RHtml.textSet(this._hLoadingLabel,"\u6b63\u5728\u52aa\u529b\u4e0a\u4f20\u4e2d\uff0c\u8bf7\u7a0d\u7b49 ...");this._hMaskInnerPanel.appendChild(b);this._loadingVisible=!0}}function FUiDesktopConsole_showProgress(b){this.setMaskVisible(!0);if(!this._progressVisible){b=this.getMaskPanel();var d=this.getProgressBar();b.appendChild(d._hPanel);this._progressVisible=!0}}
function FUiDesktopConsole_hide(){if(this._loadingVisible){var b=this.getLoadingPanel();this._hMaskInnerPanel.removeChild(b);this._loadingVisible=!1}this.setMaskVisible(!1)}
function FUiEditorConsole(b){b=RClass.inherits(this,b,FConsole);b._scopeCd=EScope.Local;b._hoverEditor=null;b._focusEditor=null;b._editors=null;b.construct=FUiEditorConsole_construct;b.makeName=FUiEditorConsole_makeName;b.enter=FUiEditorConsole_enter;b.leave=FUiEditorConsole_leave;b.focus=FUiEditorConsole_focus;b.blur=FUiEditorConsole_blur;b.lost=FUiEditorConsole_lost;return b}function FUiEditorConsole_construct(){this.__base.FConsole.construct.call(this);this._editors=new TDictionary}
function FUiEditorConsole_makeName(b,d){return d?d+"@"+RClass.name(b):RClass.name(b)}function FUiEditorConsole_enter(b,d){var f=RClass.name(d),h=this._hoverEditors.get(f);h||(h=RClass.create(d),h.psBuild(),this._hoverEditors.set(f,h));this._hoverEditor=h;h.editable=b;h.show();return h}function FUiEditorConsole_leave(b){this._hoverEditor!=this._focusEditor&&(b=RObject.nvl(b,this._hoverEditor),this._hoverEditor=null,RLog.debug(this,"Leave {1}",RClass.dump(b)))}
function FUiEditorConsole_focus(b,d,f){this.makeName(d,f);var h=this._editors.get(f);h||(h=RClass.create(d),h.build(b._hPanel),this._editors.set(f,h));RLogger.debug(this,"Focus editor {1} (editable={2}, name={3})",RClass.dump(h),RClass.dump(b),f);h.reset();RClass.isClass(h,FUiDropEditor)&&(h.linkControl(b),this._focusEditor=h);return h}
function FUiEditorConsole_blur(b){if(this._focusEditor){RLogger.debug(this,"Blur editor {1}",RClass.dump(b));if(b=RObject.nvl(b,this._focusEditor))b.onEditEnd();this._focusEditor=null}}function FUiEditorConsole_lost(b){this.leave(b);this.blur(b)}
function FUiEnvironmentConsole(b){b=RClass.inherits(this,b,FConsole);b.scope=EScope.Local;b.environment=null;b.connect=FUiEnvironmentConsole_connect;b.build=FUiEnvironmentConsole_build;b.buildValue=FUiEnvironmentConsole_buildValue;b.load=FUiEnvironmentConsole_load;b.xml=FUiEnvironmentConsole_xml;return b}function FUiEnvironmentConsole_connect(){}
function FUiEnvironmentConsole_build(b){this.environment||this.connect();this.environment&&b.create("Environment").attributes().append(this.environment.attributes())}function FUiEnvironmentConsole_buildValue(){this.environment||this.connect();if(this.environment){var b=RHtml.get("_environment");b&&(b.value=this.environment.xml())}}function FUiEnvironmentConsole_load(b){this.environment=RXml.makeNode(b)}
function FUiEnvironmentConsole_xml(){this.environment||this.connect();return this.environment?this.environment.xml():null}
function FUiErrorDialog(b){b=RClass.inherits(this,b,FUiDialog,MListenerResult);b._styleText=RClass.register(b,new AStyle("_styleText"));b._frameName="system.dialog.ErrorDialog";b._controlText=null;b._controlConfirmButton=null;b._controlCancelButton=null;b.onBuilded=FUiErrorDialog_onBuilded;b.onConfirmClick=FUiErrorDialog_onConfirmClick;b.construct=FUiErrorDialog_construct;b.setCode=FUiErrorDialog_setCode;b.setDescription=FUiErrorDialog_setDescription;b.dispose=FUiErrorDialog_dispose;return b}
function FUiErrorDialog_onBuilded(b){this.__base.FUiDialog.onBuilded.call(this,b);this._controlConfirm.addClickListener(this,this.onConfirmClick)}function FUiErrorDialog_onConfirmClick(b){b=new SEvent;b.sender=this;b.resultCd=EResult.Success;this.processResultListener(b);b.dispose();this.hide()}function FUiErrorDialog_construct(){this.__base.FUiDialog.construct.call(this)}function FUiErrorDialog_setCode(b){this._controlCode.set(b)}
function FUiErrorDialog_setDescription(b){this._controlDescription.set(b)}function FUiErrorDialog_dispose(){this.__base.FUiDialog.dispose.call(this)}
function FUiFocusConsole(b){b=RClass.inherits(this,b,FConsole);b.scope=EScope.Page;b._blurAble=!0;b._focusAble=!0;b._focusClasses=null;b._storeControl=null;b._hoverContainer=null;b._hoverControl=null;b._focusControl=null;b._blurControl=null;b._activeControl=null;b.lsnsFocus=null;b.lsnsBlur=null;b.lsnsFocusClass=null;b.onMouseDown=FUiFocusConsole_onMouseDown;b.onMouseWheel=FUiFocusConsole_onMouseWheel;b.construct=FUiFocusConsole_construct;b.enter=FUiFocusConsole_enter;b.leave=FUiFocusConsole_leave;
b.isFocus=FUiFocusConsole_isFocus;b.focus=FUiFocusConsole_focus;b.blur=FUiFocusConsole_blur;b.findClass=FUiFocusConsole_findClass;b.focusClass=FUiFocusConsole_focusClass;b.focusHtml=FUiFocusConsole_focusHtml;b.lockBlur=FUiFocusConsole_lockBlur;b.unlockBlur=FUiFocusConsole_unlockBlur;b.storeFocus=FUiFocusConsole_storeFocus;b.restoreFocus=FUiFocusConsole_restoreFocus;b.dispose=FUiFocusConsole_dispose;return b}function FUiFocusConsole_onMouseDown(b){this.focusHtml(b.hSource)}
function FUiFocusConsole_onMouseWheel(b,d){}function FUiFocusConsole_construct(){this.__base.FConsole.construct.call(this);this._focusClasses={};this.lsnsFocus=new TListeners;this.lsnsBlur=new TListeners;this.lsnsFocusClass=new TListeners;RLogger.info(this,"Add listener for window mouse down and wheel.");RWindow.lsnsMouseDown.register(this,this.onMouseDown);RWindow.lsnsMouseWheel.register(this,this.onMouseWheel)}
function FUiFocusConsole_enter(b){RClass.isClass(b,MUiContainer)?this._hoverContainer=b:this._hoverControl=b}function FUiFocusConsole_leave(b){this._hoverContainer==b&&(this._hoverContainer=null);this._hoverControl==b&&(this._hoverControl=null)}function FUiFocusConsole_isFocus(b){return this._focusControl==b}
function FUiFocusConsole_focus(b,d){if(RClass.isClass(b,MUiFocus)){var f=this._focusControl;f!=b&&(this._blurControl!=f&&this._blurAble&&f&&f.testBlur(b)&&(RLogger.debug(this,"Blur focus control. (name={1}, instance={2})",f.name,RClass.dump(f)),this._blurControl=f,f.doBlur(d),this.lsnsBlur.process(f)),this._focusAble&&(RLogger.debug(this,"Focus control. (name={1}, instance={2})",b.name,RClass.dump(b)),b.doFocus(d),this._focusControl=this._activeControl=b,this.lsnsFocus.process(b)))}}
function FUiFocusConsole_blur(b,d){var f=this._focusControl,h=this._blurControl;f&&b&&!f.testBlur(b)||(h!=b&&RClass.isClass(b,MUiFocus)&&(RLogger.debug(this,"Blur control. (name={1}, instance={2})",b.name,RClass.dump(b)),this._blurControl=b,b.doBlur(d)),f&&(RLogger.debug(this,"Blur focus control. (name={1}, instance={2})",f.name,RClass.dump(f)),f.doBlur(d),this._focusControl=null))}
function FUiFocusConsole_findClass(b){var d=RClass.name(b);if(this._focusClasses[d])return this._focusClasses[d];d=this._activeControl;RClass.isClass(d,FEditor)&&(d=d.source);if(d)return d.topControl(b)}function FUiFocusConsole_focusClass(b,d){var f=RClass.name(b);this._focusClasses[f]!=d&&(this._focusClasses[f]=d,RLogger.debug(this,"Focus class. (name={1}, class={2})",f,RClass.dump(d)),this.lsnsFocusClass.process(d,b))}
function FUiFocusConsole_focusHtml(b){var d=RHtml.searchLinker(b,FUiControl);RLogger.debug(this,"Focus html control. (control={1}, element={2})",RClass.dump(d),b.tagName);d?this._focusControl!=d&&this.blur(d,b):this.blur(null,b)}function FUiFocusConsole_lockBlur(){this._blurAble=!1}function FUiFocusConsole_unlockBlur(){this._blurAble=!0}function FUiFocusConsole_storeFocus(){this._storeControl=this._focusControl}
function FUiFocusConsole_restoreFocus(){this._storeControl&&(this._storeControl.focus(),this._storeControl=null)}function FUiFocusConsole_dispose(){this.__base.FConsole.dispose.call(this);this._focusClasses=null}function FUiFrameConsole(b){b=RClass.inherits(this,b,FConsole);b._scopeCd=EScope.Local;b._frames=null;b.construct=FUiFrameConsole_construct;b.create=FUiFrameConsole_create;b.find=FUiFrameConsole_find;b.findByClass=FUiFrameConsole_findByClass;b.get=FUiFrameConsole_get;return b}
function FUiFrameConsole_construct(){this._frames=new TMap}function FUiFrameConsole_create(b,d){var f=RConsole.find(FUiDescribeFrameConsole).load(d);return RUiControl.build(null,f,null,b._hPanel)}function FUiFrameConsole_find(b){return this._frames.get(b)}function FUiFrameConsole_findByClass(b,d){var f=RClass.name(d),h=this._frames,q=h.get(f);q||(q=RClass.create(d),q.buildDefine(b._hPanel),h.set(f,q));return q}
function FUiFrameConsole_get(b,d,f){var h=this._frames,q=h.get(d);q||(q=this.create(b,d),f&&q.setPanel(f),h.set(d,q));return q}function FUiFrameConsole_hiddenAll(){for(var b=this._frames,d=b.count,f=0;f<d;f++)b.value(f).setVisible(!1)}
function FUiFrameConsole_onProcessLoaded(b){var d=b.document.root(),f=b.argument;if(!b.messageChecked){var h=new TMessageArg;h.argument=f;h.form=f.form;h.config=d;h.invokeCaller=new TInvoke(this,this.onLoaded);h.invokeParam=b;h.event=b;if(!RConsole.find(FMessageConsole).checkResult(h))return}f=b.argument;if(b=d.find("Form"))b=RDataset.make(b),f.resultDataset=b,f.resultRow=b.rows.get(0);f.invoke()}
function FUiFrameConsole_process(b){var d=new TXmlDocument,f=d.root();f.set("action","process");b.checked&&f.set("checked",b.checked);f.push(b.toNode());f=new TEvent(this,EXmlEvent.Send,this.onProcessLoaded);f.url=RService.url(RString.nvl(b.url,"logic.webform"));f.action=EDataAction.Process;f.argument=b;f.document=d;RConsole.find(FXmlConsole).process(f)}function FUiFrameConsole_loadEvents(b){}
function FUiFrameConsole_processEvent(b){var d=this.events;if(!d.isEmpty()){var f=b.source;if(RClass.isClass(f,FControl)){var h=f.topControl();h&&(h=RString.nvl(b.name,b.handle)+"@"+f.name+"@"+h.name,d=d.get(h),f=b.caller?b.caller:f,d&&d.code&&(d.event||(d.event=new Function("o","e",d.code)),d.event.call(f,f,b)))}}}function FUiFrameConsole_free(b){b.setVisible(!1);this._freeFrames.push(b)}
function FUiFrameConsole_dispose(){RMemory.free(this._frames);RMemory.free(this._formIds);RMemory.free(this._framesLoaded);this._framesLoaded=this._formIds=this._frames=null}
function FUiFrameEventConsole(b){b=RClass.inherits(this,b,FConsole);b._scopeCd=EScope.Local;b._thread=null;b._interval=20;b._allow=!0;b._allows=new TAttributes;b._events=new TObjects;b._listeners=new TAttributes;b.onProcess=FUiFrameEventConsole_onProcess;b.construct=FUiFrameEventConsole_construct;b.register=FUiFrameEventConsole_register;b.push=FUiFrameEventConsole_push;b.clear=FUiFrameEventConsole_clear;return b}
function FUiFrameEventConsole_onProcess(){var b=this._events,d=b.count();if(0<d){for(;;){for(var f=!1,h=0;h<d;h++){var q=b.get(h);if(q){f=!0;q.process();var z=this._listeners.get(RMethod.name(q));z&&z.process(q);b.set(h,null)}}if(!f)break}b.clear()}}
function FUiFrameEventConsole_construct(){this.__base.FConsole.construct.call(this);var b=this._thread=RClass.create(FThread);b.setInterval(this._interval);b.addProcessListener(this,this.onProcess);RConsole.find(FThreadConsole).start(b);RLogger.debug(this,"Add event thread. (thread={1})",RClass.dump(b))}function FUiFrameEventConsole_register(b,d){this._events.push(new TEvent(b,null,d))}
function FUiFrameEventConsole_push(b){var d=RClass.name(b);if(this._allow){var f=!0;this._allows.contains(d)&&(f=RBoolean.isTrue(this._allows.get(d)));if(f){for(var f=this._events,h=f.count(),q=0;q<h;q++)f.get(d)==b&&f.set(d,null);f.push(b)}}}function FUiFrameEventConsole_clear(){this._events.clear()}function FUiFrameEventConsole_add(b,d){this._events.push(new TEvent(b,null,d))}function FUiFrameEventConsole_allowEvent(b){this._allows.set(RMethod.name(b),EBool.True)}
function FUiFrameEventConsole_skipEvent(b){this._allows.set(RMethod.name(b),EBool.False)}function FUiFrameEventConsole_allowAll(){this._allow=!0}function FUiFrameEventConsole_skipAll(){this._allow=!1}function FUiFrameEventConsole_onlyCall(b,d){this._allow=!1;d.call(b);this._allow=!0}
function FUiInfoDialog(b){b=RClass.inherits(this,b,FUiDialog,MListenerResult);b._styleText=RClass.register(b,new AStyle("_styleText"));b._frameName="system.dialog.InfoDialog";b._controlText=null;b._controlConfirmButton=null;b._controlCancelButton=null;b.onBuilded=FUiInfoDialog_onBuilded;b.onConfirmClick=FUiInfoDialog_onConfirmClick;b.construct=FUiInfoDialog_construct;b.setText=FUiInfoDialog_setText;b.dispose=FUiInfoDialog_dispose;return b}
function FUiInfoDialog_onBuilded(b){this.__base.FUiDialog.onBuilded.call(this,b);this._controlText._hPanel.className=this.styleName("Text");this._controlConfirmButton.addClickListener(this,this.onConfirmClick)}function FUiInfoDialog_onConfirmClick(b){b=new SEvent;b.sender=this;b.resultCd=EResult.Success;this.processResultListener(b);b.dispose();this.hide()}function FUiInfoDialog_construct(){this.__base.FUiDialog.construct.call(this)}function FUiInfoDialog_setText(b){this._controlText.set(b)}
function FUiInfoDialog_dispose(){this.__base.FUiDialog.dispose.call(this)}function FUiKeyConsole(b){b=RClass.inherits(this,b,FConsole);b._scopeCd=EScope.Local;b._enable=!0;b._enableRegister=!0;b._listeners={};b._disableKeys={};b.onKeyDown=FUiKeyConsole_onKeyDown;b.construct=FUiKeyConsole_construct;b.enable=FUiKeyConsole_enable;b.disable=FUiKeyConsole_disable;b.enableRegister=FUiKeyConsole_enableRegister;b.disableRegister=FUiKeyConsole_disableRegister;b.register=FUiKeyConsole_register;return b}
function FUiKeyConsole_onKeyDown(b){var d=REnum.tryDecode(EKeyCode,b.keyCode);if(d&&this._enable){var f=this._listeners[d];f&&(f.process(this,b),b.keyCode=null,b.returnValue=!1)}d&&this._disableKeys[d]&&(b.keyCode=null,b.returnValue=!1)}function FUiKeyConsole_construct(){this.__base.FConsole.construct.call(this);RWindow.lsnsKeyDown.register(this,this.onKeyDown)}function FUiKeyConsole_enable(){this._enable=!0}function FUiKeyConsole_disable(){this._enable=!1}
function FUiKeyConsole_enableRegister(){this._enableRegister=!0}function FUiKeyConsole_disableRegister(){this._enableRegister=!1}function FUiKeyConsole_register(b,d,f){if(this._enableRegister){RInteger.isInteger(b)&&(b=REnum.decode(EKeyCode,b));var h=this._listeners,q=h[b];q||(q=h[b]=new TListeners);q.clear();q.register(d,f)}}
function FUiMessageConsole(b){b=RClass.inherits(this,b,FConsole,MUiStyle);b._scopeCd=EScope.Global;b._result=[];b._attributes=[];b._messageBox=null;b._messageWindow=null;b.showInfo=FUiMessageConsole_showInfo;b.showConfirm=FUiMessageConsole_showConfirm;b.showError=FUiMessageConsole_showError;b.popup=FUiMessageConsole_popup;b.close=FUiMessageConsole_close;b.parse=FUiMessageConsole_parse;b.check=FUiMessageConsole_check;return b}
function FUiMessageConsole_showInfo(b){var d=RConsole.find(FUiWindowConsole).find(FUiInfoDialog);d.clearResultListeners();d.setText(b);d.showPosition(EUiPosition.Center);return d}function FUiMessageConsole_showConfirm(b){var d=RConsole.find(FUiWindowConsole).find(FUiConfirmDialog);d.clearResultListeners();d.setText(b);d.showPosition(EUiPosition.Center);return d}
function FUiMessageConsole_showError(b,d,f){b=RConsole.find(FUiWindowConsole).find(FUiErrorDialog);b.clearResultListeners();b.setCode(d);b.setDescription(f);b.showPosition(EUiPosition.Center);return b}function FUiMessageConsole_popup(b){var d=this._messageWindow;d||(d=this._messageWindow=RControl.create(FUiMessageWindow));d.loadMessages(b);d.show()}function FUiMessageConsole_close(){RWindow.setEnable(!0)}
function FUiMessageConsole_parse(b){var d=null;if((b=b.find("Messages"))&&b.nodes&&b.nodes.count)for(var d=new TMessages,f=0;f<b.nodes.count;f++){b.node(f);var h=new TMessage;h.loadConfig(b.node(f));d.push(h)}return d}
function FUiMessageConsole_check(b){var d=b.messages=this.parse(b.config);return d?((d=d.message(EMessage.Fatal))&&"session.timeout"==d.attrType?(b=RString.splitTwo(d.redirect,"@"),b=RContext.context(b[1]+"?do="+b[0]),fmMain.action=b,fmMain.target="_self",fmMain.submit()):this.popupMessage(b),!1):!0}
function FUiMessageDialog(b){b=RClass.inherits(this,b,FUiWindow);b._styleMsgPanel=RClass.register(b,new AStyle("_styleMsgPanel"));b._styleButtonPanel=RClass.register(b,new AStyle("_styleButtonPanel"));b._styleItmeForm=RClass.register(b,new AStyle("_styleItmeForm"));b._styleItemTitle=RClass.register(b,new AStyle("_styleItemTitle"));b._styleItemBodyForm=RClass.register(b,new AStyle("_styleItemBodyForm"));b._styleRowItem=RClass.register(b,new AStyle("_styleRowItem"));b._styleDescForm=RClass.register(b,
new AStyle("_styleDescForm"));b._styleDescTitle=RClass.register(b,new AStyle("_styleDescTitle"));b._styleDescBody=RClass.register(b,new AStyle("_styleDescBody"));b._type=null;b._isDialog=!1;b._titleBlur=!1;b._messageArg=null;b._hMessagePanel=null;b._hMessages=null;b._hDescription=null;b._hButtonPanel=null;b._hBlank=null;b.onBuild=FUiMessageDialog_onBuild;b.onItemOver=RClass.register(b,new AEventMouseOver("onItemOver"),FUiMessageDialog_onItemOver);b.onItemClick=RClass.register(b,new AEventClick("onItemClick"),
FUiMessageDialog_onItemClick);b.onDescClick=RClass.register(b,new AEventClick("onDescClick"),FUiMessageDialog_onDescClick);b.onBuildMessages=FUiMessageDialog_onBuildMessages;b.onBuildButtons=FUiMessageDialog_onBuildButtons;b.onOk=FUiMessageDialog_onOk;b.onCancel=FUiMessageDialog_onCancel;b.onClose=FUiMessageDialog_onClose;b.loadMessages=FUiMessageDialog_loadMessages;b.show=FUiMessageDialog_show;b.hide=FUiMessageDialog_hide;b.dispose=FUiMessageDialog_dispose;return b}
function FUiMessageDialog_onBuild(b){this.__base.FUiWindow.oeBuild.call(this,e);this.setIcon("Icon");b=RBuilder.appendTable(this.hBodyPanel,0,0,0);b.style.vAlign="top";b.width="100%";b.height="100%";var d=this.hTitlePanel=b.insertRow().insertCell();d.style.height="100%";d.style.vAlign="top";(this.hMsgPanel=b.insertRow().insertCell()).style.height="100%";this.onBuildMessages();b=this._hButtonPanel=b.insertRow().insertCell();b.style.align="right";this.onBuildButtons();b.height=20;RConsole.find(FKeyConsole).register(EKey.Esc,
new TListener(this,this.onClose));return r}function FUiMessageDialog_onItemOver(b){}function FUiMessageDialog_onItemClick(b){b=this.hItemBodyForm;for(var d=0;d<b.rows.count;d++);}function FUiMessageDialog_onDescClick(b){}
function FUiMessageDialog_onBuildMessages(){if(!this._type){var b=this.hItmeForm=RBuilder.appendTable(this.hTitlePanel);b.style.height="100%";b.style.width="100%";b.style.vAlign="top";var d=this.hItemTitle=b.insertRow().insertCell();d.height=25;d=RBuilder.appendTable(d);d.height="100%";d.width="100%";d.style.backgroundColor="#F5F5F5";var d=d.insertRow(),f=d.insertCell();f.width="20";f=RBuilder.appendIcon(f,null,null,16,14);f.style.paddingLeft=20;f.src=this.styleIconPath("TitleIcon");d.insertCell().innerText=
" "+RContext.get("FUiMessageDialog:MessageContext");b=this.hItemBody=b.insertRow().insertCell();b.height=100;this.hItemBody.style.borderBottom="2 solid #F5F5F5";b.style.padding="5";b.vAlign="top";b=RBuilder.appendDiv(b);b.style.height="100px";b.style.overflow="auto";b=this.hItemBodyForm=RBuilder.appendTable(b);b.style.border="2px solid #FFFFFF";b.width="100%";b.style.vAlign="top";b=this.hDescForm=RBuilder.appendTable(this.hMsgPanel);b.style.tableLayout="fixed";b.style.border="2px solid #EEEDED";b.style.borderTopWidth=
0}this.hItmeForm.style.display="none";this.hDescForm.style.display="none";this.hMsgPanel.style.height="100%";EMessage.Fatal==this._type||EMessage.Error==this._type?(this.hItmeForm.style.display="block",this.hDescForm.style.display="block"):this.hItmeForm.style.display="block"}
function FUiMessageDialog_onBuildButtons(b){if(!this._type){var d=RBuilder.appendTable(this._hButtonPanel,null,0,0,2).insertRow();(this._hBlank=d.insertCell()).width="72%";b=this.btnOk=RClass.create(FButton);b.icon="tool.ok";b.label=RContext.get("FToolButton:ok");b.width="100%";b.lsnsClick.register(this,this.onOk);var f=d.insertCell();f.style.align="right";f.width="15%";b.psBuild(f);b=this.btnCancel=RClass.create(FButton);b.icon="tool.cancel";b.label=RContext.get("FToolButton:cancel");b.width="100%";
b.lsnsClick.register(this,this.onCancel);d=d.insertCell();d.width="15%";b.psBuild(d)}this.btnOk.hPanel.style.display="none";this.btnCancel.hPanel.style.display="none";EMessage.Warn==this._type?(this.btnOk.hPanel.style.display="block",this.btnCancel.hPanel.style.display="block",this._hBlank.width="72%"):(this.btnOk.hPanel.style.display="block",this._hBlank.width="87%")}
function FUiMessageDialog_onOk(){var b=this._messageArg,d=b.argument,f=this.msgs.get(0)._type;EMessage.Warn==f&&d&&(d.checked=EBoolean.True,"process"==d.actionType?RConsole.find(FFormConsole).process(d):"update"==d.actionType&&RConsole.find(FDatasetConsole).update(d));f==EMessage.Info&&b.invokeCaller&&(b.invokeParam.messageChecked=!0,b.invokeCaller.invoke(b.invokeParam));this.hide()}function FUiMessageDialog_onCancel(){this.hide()}function FUiMessageDialog_onClose(){this.hide()}
function FUiMessageDialog_loadMessages(b){this._messageArg=b;var d=b.messages;this._type=d._type();this.onBuildButtons();this.onBuildMessages();RHtml.clear(this.hItemBodyForm);RHtml.clear(this.hDescDiv);b=!0;for(var d=this.msgs=d.items,f=EMessage.Info,h=0;h<d.count;h++){var q=d.get(h),z=q.message,A=q._type,q=this.hItemBodyForm.insertRow();q.height=12;var B=q.insertCell();B.width=20;B=RBuilder.appendIcon(B,null,h,16,16);EMessage.Error==A?(this.setIcon("TitleError"),B.src=this.styleIconPath("ItemError"),
f=EMessage.Error):EMessage.Warn==A?(this.setIcon("TitleWarn"),B.src=this.styleIconPath("ItemWarn"),f=EMessage.Warn):EMessage.Info==A?(this.setIcon("TitleInfo"),f=EMessage.Info,B.src=this.styleIconPath("ItemInfo")):EMessage.Fatal==A&&(f=EMessage.Fatal,B.src=this.styleIconPath("ItemError"));A=q.insertCell();A.style.textOverflow="ellipsis";A.style.overflow="hidden";A.innerText=" "+z;A.style.cursor="hand";this.attachEvent("onItemClick",q);this.attachEvent("onItemOver",q);b&&(b=!1)}EMessage.Error==f?this.setCaption(" "+
RContext.get("FUiMessageDialog:Error")):EMessage.Warn==f?this.setCaption(" "+RContext.get("FUiMessageDialog:Warn")):EMessage.Info==f?this.setCaption(" "+RContext.get("FUiMessageDialog:Info")):EMessage.Fatal==f&&this.setCaption(" "+RContext.get("FUiMessageDialog:Fatal"))}
function FUiMessageDialog_show(){this.__base.FUiWindow.show.call(this);this.panel().style.zIndex=RLayer.next(ELayer.Message);RWindow.moveCenter(this.panel());this.psMode(EMode.Update);RConsole.find(FFocusConsole).blur();RWindow.setEnable(!1,!0);this.focus()}function FUiMessageDialog_hide(){this.__base.FUiWindow.hide.call(this);var b=this._messageArg.argument.form;RClass.isClass(b,MDataset)&&b.psProgress(!1);RWindow.setEnable(!0)}
function FUiMessageDialog_dispose(){this.__base.FUiWindow.dispose.call(this);this._hButtonPanel=this.hItemBodyForm=this.hDescTitle=this.hDescDiv=this.hDescBody=this.hItmeForm=null}
function FUiPopupConsole(b){b=RClass.inherits(this,b,FConsole);b._scopeCd=EScope.Local;b._activeControl=null;b.onMouseDown=FUiPopupConsole_onMouseDown;b.onMouseWheel=FUiPopupConsole_onMouseWheel;b.construct=FUiPopupConsole_construct;b.show=FUiPopupConsole_show;b.hide=FUiPopupConsole_hide;b.dispose=FUiPopupConsole_dispose;return b}function FUiPopupConsole_onMouseDown(b){this.hide()}function FUiPopupConsole_onMouseWheel(b,d){this.hide()}
function FUiPopupConsole_construct(){this.__base.FConsole.construct.call(this);RLogger.info(this,"Add listener for control popup.");RWindow.lsnsMouseDown.register(this,this.onMouseDown);RWindow.lsnsMouseWheel.register(this,this.onMouseWheel)}function FUiPopupConsole_show(b){this.hide();RClass.isClass(b,MUiPopup)&&(this._activeControl=b)}function FUiPopupConsole_hide(b){this._activeControl&&this._activeControl.opener().drop(!1);this._activeControl=null}
function FUiPopupConsole_dispose(){this._activeControl=null;this.__base.FConsole.dispose.call(this)}function FUiResultConsole(b){b=RClass.inherits(this,b,FConsole);b.scope=EScope.Page;b.executeCommand=FUiResultConsole_executeCommand;b.checkService=FUiResultConsole_checkService;b.checkEvent=FUiResultConsole_checkEvent;return b}
function FUiResultConsole_executeCommand(b){var d=b.get("name");if(EResultCommand.TreeReload==d)(d=RGlobal.get("catalog.tree"))&&d.reload();else if(EResultCommand.TreeNodeRefresh==d){if(d=RGlobal.get("catalog.tree"))if(b=b.get("uuid")){var f=d.findByUuid(b);if(f)d.reloadNode(f);else return alert("Can't find tree node. (uuid="+b+")")}else d.reloadNode()}else EResultCommand.TreeParentRefresh==d?(d=RGlobal.get("catalog.tree"))&&(f=d.focusNode)&&d.reloadNode(f.parentNode):EResultCommand.PageRedirect==
d&&(d=b.get("action"),b=top.RContext.context(b.get("page")),d&&(b+="?do="+d),fmMain.action=b,fmMain.target="",fmMain.submit())}function FUiResultConsole_checkService(b){if(b){if(!RConsole.find(FMessageConsole).checkResult(new TMessageArg(b)))return!1;if((b=b.find("Commands"))&&b.nodes&&b.nodes.count)for(var d=0;d<b.nodes.count;d++){var f=b.node(d);f.isName("Command")&&this.executeCommand(f)}RConsole.find(FFocusConsole).restoreFocus()}return!0}
function FUiResultConsole_checkEvent(b){if(b=b.root){if("success"==b.get("result_cd"))return!0;b.get("message_cd");var d=b.find("Messages");if(d)for(var f=d.nodeCount(),h=0;h<f;h++)if(b=d.node(h),b.isName("Message"))return d=b.get("code"),f=b.get("message"),b=b.get("description"),RConsole.find(FUiMessageConsole).showError(d,f,b),!1}return!0}
function FUiWindowConsole(b){b=RClass.inherits(this,b,FConsole);b._scopeCd=EScope.Local;b._activeWindow=null;b._windows=null;b.construct=FUiWindowConsole_construct;b.create=FUiWindowConsole_create;b.find=FUiWindowConsole_find;return this}function FUiWindowConsole_construct(){this.__base.FConsole.construct.call(this);this._windows=new TDictionary}function FUiWindowConsole_create(b){b=RClass.create(b);b.buildDefine(RWindow._hDocument);return b}
function FUiWindowConsole_find(b){var d=RClass.name(b),f=this._windows.get(d);if(f)return f;b=this.create(b);this._windows.set(d,b);return b}function FUiWindowConsole_loadDefine(b){if(null==b)return null;var d=this.defines.find(b);if(null==d){var f=new TXmlDocument,h=f.root();h.create("Action").value="window.config.load";h.create("Window","name",b);f=(new TXmlCnn).syncSend("window.xml",f);f.root()}return d?d:ILogger.fatal(this,"loadDefine","Not find window define: "+sWinName)}
function FUiWindowConsole_dump(){var b=this.className,b=b+("\n\nDefine:\n"+this.m_oDefinePool.dump());return b+="\n\nWindow:\n"+this.windowList.dump()}function FUiWindowConsole_clear(){this.activeControl=this.activeForm=this._activeWindow=this.focusWinCtl=null;this.m_oDefinePool=new FList;for(var b=this.windowList.size()-1;0<=b;b--)this.windowList.value(b).release();this.windowList=new FList;IEngine.process(this,this.EVENT_CLOSEALL)}
function FUiWindowConsole_hideAll(b,d){for(var f=this.windowList.size()-1;0<=f;f--){var h=this.windowList.value(f);h!=b&&h.hide(d)}}function FUiWindowConsole_setMaxWindow(b){this.maxFlag=!0;this.hideAll(b)}function FUiWindowConsole_restore(){var b=this.windowList.size();this.hideAll(null,!0);for(var d=0;d<b;d++)this.windowList.value(d).maxFlag&&this.windowList.value(d).restore();this.maxFlag=!1}function FUiWindowConsole_initialize(b){this.clientWindow=b}
function FUiWindowConsole_hasWindow(){return!this.windowList.isEmpty()}function FUiWindowConsole_focus(b){this.focusWinCtl=b;this.maxFlag&&(b.show(),this.hideAll(b,!0),b.max())}
function FUiWindowConsole_saveDefine(b,d){d&&(this.clientWindow.document.body.disabled=!0);if(!b)return LoggerUtil.fatal(this,"saveDefine","Window node is null.");if(!b.attribute("full_name"))return ILogger.fatal(this,"saveDefine","Window full name is null.");var f=new FXMLDocument("Config");f.rootNode.createNode("Action").setAttribute("name","define.save");f.rootNode.push(b);f=new FXMLConnect(SystemManager.serviceURL("window"),f);f.clientWindow=d;f.onload=this.onSaveDefineAfter;f.send()}
function FUiWindowConsole_onEventMousedown(b){}function FUiWindowConsole_onSaveDefineAfter(){ILogger.info(this,"saveDefine","Save Ok.");this.clientWindow&&(this.clientWindow.document.body.disabled=!1)}function FUiWindowConsole_releaseWindowName(b){b=this.windowList.removeName(b);IEngine.process(this,this.EVENT_CLOSE,b)}function FUiWindowConsole_releaseWindow(b){this.windowList.removeValue(b);IEngine.process(this,this.EVENT_CLOSE,b)}
function FUiWindowConsole_doFrameAction(b){if(!this.activeForm)return ILogger.fatal(this,"doFrameAction","Not active form!");this.activeForm.doAction(b)}function FUiWindowConsole_doProperties(){TrackManager.push(this,"Do properties.");if(WindowManager.focusWinCtl){var b=[];b.WindowManager=WindowManager;window.showModalDialog(SystemManager.actionURL("window"),b,"dialogWidth:500px;dialogHeight:360px;resizable:no;scroll:no;edge:sunken")}}
function FUiWindowConsole_onEventRelease(b){if(b){for(var d=null,f=[],h=this.windowList.size(),q=0;q<h;q++)d=this.windowList.value(q),d.clientWindow==b&&(d==MoveManager.focusBorder&&MoveManager.focus(null),f.push(d));for(q=0;q<f.length;q++)this.windowList.removeValue(f[q])}else this.windowList.clear(),MoveManager.focus(null)}
function FUiWorkspaceConsole(b){b=RClass.inherits(this,b,FConsole);b._scopeCd=EScope.Local;b._activeWorkspace=null;b._workspaces=null;b.onResize=FUiWorkspaceConsole_onResize;b.construct=FUiWorkspaceConsole_construct;b.active=FUiWorkspaceConsole_active;b.resize=FUiWorkspaceConsole_resize;b.dispose=FUiWorkspaceConsole_dispose;return b}function FUiWorkspaceConsole_onResize(b){(b=this._activeWorkspace)&&b.psResize()}
function FUiWorkspaceConsole_construct(){this.__base.FConsole.construct.call(this);this._workspaces=new TDictionary;RWindow.lsnsResize.register(this,this.onResize)}function FUiWorkspaceConsole_active(b){this._activeWorkspace=b}function FUiWorkspaceConsole_resize(){this.onResize()}function FUiWorkspaceConsole_dispose(){this.__base.FConsole.dispose.call(this)}var EUiSplitStyle=new function(){this.Normal="N";this.BulgeLine="B";this.HollowLine="H";return this};
function MUiShadow(b){b=RClass.inherits(this,b);b._hShadow=null;b.show=MUiShadow_show;b.hide=MUiShadow_hide;b.setVisible=MUiShadow_setVisible;return b}
function MUiShadow_show(b){this._hShadow||(this._hShadow=RBuilder.createDiv(this._hPanel,"RWindow_Shadow"));this._hShadow.style.zIndex=RUiLayer.next();if(0==b)this.hide();else{if(b=this.panel(EPanel.Shadow)){var d=this._hShadow.style;d.pixelLeft=b.offsetLeft+2;d.pixelTop=b.offsetTop+2;d.pixelWidth=b.offsetWidth;d.pixelHeight=b.offsetHeight;d.display="block"}if(b=this.panel(EPanel.Panel))b.style.zIndex=RUiLayer.next()}}function MUiShadow_hide(){this._hShadow&&(this._hShadow.style.display="none")}
function MUiShadow_setVisible(b){if(b){this._hShadow||(this._hShadow=RBuilder.createDiv(this._hPanel,"RWindow_Shadow"));this._hShadow.style.zIndex=RUiLayer.next();if(b=this.panel(EPanel.Shadow)){b=RHtml.rect(b);var d=this._hShadow.style;d.pixelLeft=b.left+2;d.pixelTop=b.top+2;d.pixelWidth=b.width();d.pixelHeight=b.height();d.display="block"}if(b=this.panel(EPanel.Panel))b.style.zIndex=RUiLayer.next()}else this._hShadow&&(this._hShadow.style.display="none")}
function SUiColorBar(){this._draging=!1;this.typeCd=this.control=null;this.minValue=0;this.maxValue=1;this.hInput=this.hInputPanel=this.hSlideRowBR=this.hSlideRowBM=this.hSlideRowBL=this.hSlideRowMR=this.hSlideRowMM=this.hSlideRowML=this.hSlideRowUR=this.hSlideRowUM=this.hSlideRowUL=this.hSlideForm=this.hSlidePanel=this.hColorImage=this.hColorPanel=this.hPanel=null;this.onMouseDown=SUiColorBar_onMouseDown;this.onMouseMove=SUiColorBar_onMouseMove;this.onMouseUp=SUiColorBar_onMouseUp;this.build=SUiColorBar_build;
this.setRange=SUiColorBar_setRange;this.setColorValue=SUiColorBar_setColorValue;this.setSlideValue=SUiColorBar_setSlideValue;this.setInputValue=SUiColorBar_setInputValue;this.convertSlide=SUiColorBar_convertSlide;this.convertGet=SUiColorBar_convertGet;this.convertSet=SUiColorBar_convertSet;this.get=SUiColorBar_get;this.set=SUiColorBar_set;this.changeSlide=SUiColorBar_changeSlide;this.changeInputEdit=SUiColorBar_changeInputEdit;this.changeInputChange=SUiColorBar_changeInputChange;return this}
function SUiColorBar_onMouseDown(b){b=RHtml.clientX(b.hSource,this.hSlideForm)+b.offsetX;this._draging=!0;RWindow.setOptionSelect(!1);this.changeSlide(b)}function SUiColorBar_onMouseMove(b){this._draging&&(b=RHtml.clientX(b.hSource,this.hSlideForm)+b.offsetX,this.changeSlide(b))}function SUiColorBar_onMouseUp(b){this._draging=!1;RWindow.setOptionSelect(!0)}
function SUiColorBar_build(b){b=this.control;var d=RBuilder.appendTableRow(this.hPanel),f=this.hColorPanel=RBuilder.appendTableCell(d);f.width=13;f.style.padding="2px";this.hColorImage=RBuilder.appendIcon(f,null,"n",11,11);f=this.hSlidePanel=RBuilder.appendTableCell(d);f.style.padding="2px";f.vAlign="middle";var h=this.hSlideForm=RBuilder.appendTable(f);h.__pbar=this;h.width="100%";h.style.height="9px";h.style.cursor="pointer";var q=this.hSlideRowUp=RBuilder.appendTableRow(h);q.style.height="3px";
this.hSlideRowUL=RBuilder.appendTableCell(q);f=this.hSlideRowUM=RBuilder.appendTableCell(q);f.width=2;f.bgColor="#EEEEEE";this.hSlideRowUR=RBuilder.appendTableCell(q);q=this.hSlideRow=RBuilder.appendTableRow(h);q.style.height="3px";f=this.hSlideRowML=RBuilder.appendTableCell(q);f.bgColor="#999999";f=this.hSlideRowMM=RBuilder.appendTableCell(q);f.width=2;f.bgColor="#EEEEEE";f=this.hSlideRowMR=RBuilder.appendTableCell(q);f.bgColor="#999999";q=this.hSlideRowDown=RBuilder.appendTableRow(h);q.style.height=
"3px";this.hSlideRowBL=RBuilder.appendTableCell(q);f=this.hSlideRowBM=RBuilder.appendTableCell(q);f.width=2;f.bgColor="#EEEEEE";this.hSlideRowBR=RBuilder.appendTableCell(q);f=this.hInputPanel=RBuilder.appendTableCell(d,this.control.styleName("InputPanel"));f.width=36;d=this.hInput=RBuilder.appendEdit(f,this.control.styleName("Input"));d._pbar=this;b.attachEvent("onInputKeyPress",d,b.onInputKeyPress);b.attachEvent("onInputEdit",d,b.onInputEdit);b.attachEvent("onInputChange",d,b.onInputChange)}
function SUiColorBar_setRange(b,d){null!=b&&(this.minValue=b);null!=d&&(this.maxValue=d)}function SUiColorBar_setColorValue(b){b=RHex.format(b,2);var d=null;switch(this.typeCd){case "red":d=b+"0000";break;case "green":d="00"+b+"00";break;case "blue":d="0000"+b;break;default:throw new TError(this,"Invalid type.");}this.hColorImage.style.backgroundColor="#"+d}
function SUiColorBar_setSlideValue(b){var d=this.hSlideForm.offsetWidth;0<d&&(this.hSlideRowML.width=RInteger.toRange(b/this.maxValue*d,1,d-1))}function SUiColorBar_setInputValue(b){this.hInput.value=b}function SUiColorBar_convertGet(b){return b}function SUiColorBar_get(){return this.convertGet(this.hInput.value)}function SUiColorBar_convertSet(b){return b}function SUiColorBar_set(b){b=this.convertSet(b);this.setColorValue(b);this.setSlideValue(b);this.setInputValue(b)}
function SUiColorBar_convertSlide(b){return b}function SUiColorBar_changeSlide(b){b=this.convertSlide(b/(this.hSlideForm.offsetWidth-3));this.set(b);this.control.refreshValue()}function SUiColorBar_changeInputEdit(){var b=this.convertGet(this.hInput.value);this.setColorValue(b);this.setSlideValue(b);this.control.refreshValue()}function SUiColorBar_changeInputChange(){var b=this.convertGet(this.hInput.value);this.set(b);this.control.refreshValue()}
function SUiColorChannel(){SUiColorBar.call(this);this.minValue=0;this.maxValue=255;this.setInputValue=SUiColorChannel_setInputValue;this.convertGet=SUiColorChannel_convertGet;this.convertSet=SUiColorChannel_convertSet;return this}function SUiColorChannel_setInputValue(b){b=RInteger.toRange(b,this.minValue,this.maxValue);b=RInteger.format(b);var d=this.hInput;d.value!=b&&(d.value=b)}
function SUiColorChannel_convertGet(b){b=RInteger.parse(RString.nvl(b,"0"));return RInteger.toRange(b,this.minValue,this.maxValue)/255}function SUiColorChannel_convertSet(b){return parseInt(255*b)}
function SUiColorPower(){SUiColorBar.call(this);this.minValue=0;this.maxValue=4;this.setColorValue=SUiColorPower_setColorValue;this.setSlideValue=SUiColorPower_setSlideValue;this.setInputValue=SUiColorPower_setInputValue;this.convertGet=SUiColorPower_convertGet;this.convertSet=SUiColorPower_convertSet;this.convertSlide=SUiColorPower_convertSlide;return this}
function SUiColorPower_setColorValue(b){b=RInteger.toRange(parseInt(255*b),0,255);b=RHex.format(b,2);this.hColorImage.style.backgroundColor="#"+b+b+b}function SUiColorPower_setSlideValue(b){var d=this.hSlideForm.offsetWidth;0<d&&(this.hSlideRowML.width=RInteger.toRange(b/this.maxValue*d,1,d-1))}function SUiColorPower_setInputValue(b){var d=this.hInput;b=RFloat.toRange(b,this.minValue,this.maxValue);b=RFloat.format(b,0,null,2,null);d.value!=b&&(d.value=b)}
function SUiColorPower_convertGet(b){return RFloat.parse(b)}function SUiColorPower_convertSet(b){return b}function SUiColorPower_convertSlide(b){return b*this.maxValue}
function SUiSlide(){this._draging=!1;this.control=null;this.stepValue=1;this.minValue=0;this.range=this.maxValue=100;this.hSlideBR=this.hSlideBM=this.hSlideBL=this.hSlideB=this.hSlideMR=this.hSlideMM=this.hSlideML=this.hSlideM=this.hSlideUR=this.hSlideUM=this.hSlideUL=this.hSlideU=this.hSlideForm=this.hSlidePanel=this.hPanel=null;this.onMouseDown=SUiSlide_onMouseDown;this.onMouseMove=SUiSlide_onMouseMove;this.onMouseUp=SUiSlide_onMouseUp;this.onSlideChange=RMethod.empty;this.build=SUiSlide_build;
this.setRange=SUiSlide_setRange;this.setSlideValue=SUiSlide_setSlideValue;this.get=SUiSlide_get;this.set=SUiSlide_set;this.changeSlide=SUiSlide_changeSlide;return this}function SUiSlide_onMouseDown(b){b=RHtml.clientX(b.hSource,this.hSlideForm)+b.offsetX;this._draging=!0;RWindow.setOptionSelect(!1);this.changeSlide(b)}function SUiSlide_onMouseMove(b){this._draging&&(b=RHtml.clientX(b.hSource,this.hSlideForm)+b.offsetX,this.changeSlide(b))}
function SUiSlide_onMouseUp(b){this._draging=!1;RWindow.setOptionSelect(!0)}
function SUiSlide_build(b){b=this.hSlideForm=RBuilder.appendTable(this.hPanel);b.__pcapture=this;b.width="100%";b.style.height="9px";b.style.cursor="pointer";var d=this.hSlideU=RBuilder.appendTableRow(b);d.style.height="3px";this.hSlideUL=RBuilder.appendTableCell(d);var f=this.hSlideUM=RBuilder.appendTableCell(d);f.width=2;f.bgColor="#EEEEEE";this.hSlideUR=RBuilder.appendTableCell(d);d=this.hSlideM=RBuilder.appendTableRow(b);d.style.height="3px";f=this.hSlideML=RBuilder.appendTableCell(d);f.bgColor=
"#999999";f=this.hSlideMM=RBuilder.appendTableCell(d);f.width=2;f.bgColor="#EEEEEE";f=this.hSlideMR=RBuilder.appendTableCell(d);f.bgColor="#999999";d=this.hSlideB=RBuilder.appendTableRow(b);d.style.height="3px";this.hSlideBL=RBuilder.appendTableCell(d);f=this.hSlideBM=RBuilder.appendTableCell(d);f.width=2;f.bgColor="#EEEEEE";this.hSlideBR=RBuilder.appendTableCell(d)}
function SUiSlide_setRange(b,d){null!=b&&(this.minValue=RFloat.parse(b));null!=d&&(this.maxValue=RFloat.parse(d));this.range=this.maxValue-this.minValue}function SUiSlide_setSlideValue(b){var d=this.hSlideForm.offsetWidth;0<d&&(this.hSlideML.width=RInteger.toRange((b-this.minValue)/this.range*d,1,d-1))}function SUiSlide_get(){return p/(this.hSlideForm.offsetWidth-3)*this.range+this.minValue}function SUiSlide_set(b){this.setSlideValue(b)}
function SUiSlide_changeSlide(b){var d=this.control,f=this.hSlideForm.offsetWidth-3;this.hSlideML.width=RInteger.toRange(b,1,f-1);b=b/f*this.range+this.minValue;b=RFloat.toRange(b,this.minValue,this.maxValue);this.onSlideChange.call(d,b)}
function FUiButton(b){b=RClass.inherits(this,b,FUiControl,MListenerClick);b._labelPositionCd=RClass.register(b,new APtyString("_labelPositionCd"),EUiPosition.Left);b._icon=RClass.register(b,new APtyString("_icon"));b._action=RClass.register(b,new APtyString("_action"));b._stylePanel=RClass.register(b,new AStyle("_stylePanel"));b._styleForm=RClass.register(b,new AStyle("_styleForm"));b._styleIcon=RClass.register(b,new AStyle("_styleIcon"));b._styleLabel=RClass.register(b,new AStyle("_styleLabel"));
b._styleIconPanel=RClass.register(b,new AStyleIcon("_styleIconPanel"));b._hForm=null;b._hLeftButton=null;b._hMiddleButton=null;b._hRightButton=null;b._hLabelPanel=null;b._hLabel=null;b.onBuild=FUiButton_onBuild;b.onClick=RClass.register(b,new AEventClick("onClick"),FUiButton_onClick);b.doClick=FUiButton_doClick;return b}
function FUiButton_onBuild(b){this.__base.FUiControl.onBuild.call(this,b);b=this._hPanel;this.attachEvent("onClick",b);b=RBuilder.appendTable(b,this.styleName("Form"));b=RBuilder.appendTableRow(b);if(this._icon){var d=RBuilder.appendTableCell(b);d.width=16;this._hIcon=RBuilder.appendIcon(d,this.styleName("Icon"),this._icon)}this.label&&(d=RBuilder.appendTableCell(b),d.align="center",d.noWrap=!0,this._hLabel=RBuilder.appendText(d,this.styleName("Label"),this._label))}
function FUiButton_onButtonEnter(b){this._disabled||(this._hLeftButton.background=this.styleIconPath("HoverLeft"),this._hMiddleButton.background=this.styleIconPath("HoverMiddle"),this._hRightButton.background=this.styleIconPath("HoverRight"))}function FUiButton_onButtonLeave(b){this._disabled||(this._hLeftButton.background=this.styleIconPath("ButtonLeft"),this._hMiddleButton.background=this.styleIconPath("Button"),this._hRightButton.background=this.styleIconPath("ButtonRight"))}
function FUiButton_onButtonDown(b){this._disabled||(this._hLeftButton.background=this.styleIconPath("PressLeft"),this._hMiddleButton.background=this.styleIconPath("PressMiddle"),this._hRightButton.background=this.styleIconPath("PressRight"))}function FUiButton_onButtonUp(b){this._disabled||(this._hLeftButton.background=this.styleIconPath("ButtonLeft"),this._hMiddleButton.background=this.styleIconPath("Button"),this._hRightButton.background=this.styleIconPath("ButtonRight"))}
function FUiButton_onButtonClickDelay(b){this.__process=!1;this.clickActive.status=EActive.Sleep}function FUiButton_onClick(b){this.doClick()}function FUiButton_onButtonClick(b){this.doClick()}function FUiButton_oeMode(b){this.__base.FUiControl.oeMode.call(this,b);this.__base.MDisplay.oeMode.call(this,b);return EEventStatus.Stop}function FUiButton_setLabel(b){this.label=b;this._hLabel.innerText=b;this._hLabel.noWrap=!0}function FUiButton_setLabelColor(b){this._hLabel.style.color="#FF0000"}
function FUiButton_setLabelStyle(b,d,f){this._hLabel.style.color="#FF0000";this._hLabel.style.fontWeight="bold";this._hLabel.style.fontSize="12"}function FUiButton_doClick(){if(!this._disabled){RConsole.find(FUiFocusConsole).blur();RLogger.debug(this,"Tool button click. (label={1})",this._label);var b=new SClickEvent(this);this.processClickListener(b);b.dispose();this._action&&eval(this._action)}}
function FUiButton_dispose(){this.__base.FUiControl.dispose.call(this);this._hLabel=this._hFormEnd=this._hForm=null}
function FUiCalendar(b){b=RClass.inherits(this,b,FEditControl,MEditBorder,MDropable,MDescCalendar);b.editFormat=RDate.DisplayFormat;b.editHour=RClass.register(b,new TPtyBoolSet("editHour","editDate",EDateTimeMode.Hour));b.editMinute=RClass.register(b,new TPtyBoolSet("editMinute","editDate",EDateTimeMode.Minute));b.editSecond=RClass.register(b,new TPtyBoolSet("editSecond","editDate",EDateTimeMode.Second));b.borderStyle=EUiBorder.RoundDrop;b.date=null;b.lsnEditEnd=null;b.hForm=null;b.hDrop=null;b.hForm=
null;b.onKeyPress=FUiCalendar_onKeyPress;b.onDataClick=FUiCalendar_onDataClick;b.refreshStyle=FUiCalendar_refreshStyle;b.onEditEnd=FUiCalendar_onEditEnd;b.onBuildEdit=FUiCalendar_onBuildEdit;b.construct=FUiCalendar_construct;b.formatValue=FUiCalendar_formatValue;b.formatText=FUiCalendar_formatText;b.drop=FUiCalendar_drop;b.doBlur=FUiCalendar_doBlur;return b}function FUiCalendar_onDataClick(){this.editCheck||this.drop()}
function FUiCalendar_onBuildEdit(b){b=RBuilder.appendTable(b.hPanel);b.style.tableLayout="fixed";b=this.hEdit=b.insertRow();this.onBuildChange(b.insertCell());b=b.insertCell();b=this.hEdit=RBuilder.appendEdit(b,this.style("Edit"));b.style.disabled="true";this.editLength&&(b.maxLength=this.editLength)}function FUiCalendar_onEditEnd(b){b&&(this.set(b.get()),this._invalidText=this.validText(this.text()),this.refreshStyle());this.onDataEditEnd(this)}
function FUiCalendar_onKeyPress(b){RString.inChars(String.fromCharCode(b.keyCode),RDate.Chars)||RKey.eventClear(b)}function FUiCalendar_construct(){this.base.FEditControl.construct.call(this);this.date=new TDate;this.lsnEditEnd=new TListener(this,this.onEditEnd)}function FUiCalendar_formatValue(b){return b?("@now"==b.toLowerCase()?this.date.now():RDate.autoParse(this.date,b),RDate.formatDate(this.date)):RString.nvl(b)}
function FUiCalendar_formatText(b){return b?(RDate.autoParse(this.date,b),RDate.formatDate(this.date,this.editFormat)):RString.nvl(b)}function FUiCalendar_refreshStyle(){this.base.FEditControl.refreshStyle.call(this);this.editCheck||(this.hEdit.readOnly="true")}
function FUiCalendar_drop(){if(this.canDrop()&&this._editable){var b=this.editor=RConsole.find(FEditConsole).focus(this,FUiCalendarEditor,this.name);b.set(this.reget(),this.editFormat);b.setHourEditable(this.editHour);b.setMinuteEditable(this.editMinute);b.setSecondEditable(this.editSecond);b.lsnEditEnd=this.lsnEditEnd;b.show()}}function FUiCalendar_doBlur(){this.base.FEditControl.doBlur.call(this);this.editor&&this.editor.hide()}
function FUiCalendarEditor(b){b=RClass.inherits(this,b,FDropEditor,MUiFocusLooper);b.editFormat=null;b.dataValue=null;b.date=new TDate;b.hTitlePanel=null;b.hYearPrior=null;b.hYear=null;b.hYearNext=null;b.hMonthPrior=null;b.hMonth=null;b.hMonthNext=null;b.hDaysPanel=null;b.hTimePanel=null;b.hTime=null;b.hNow=null;b.hOk=null;b.hCancel=null;b.hHour=null;b.hMinute=null;b.hSecond=null;b.hSelect=null;b.editFormat=RDate.DisplayFormat;b.dateOrg=new TDate;b.dateOrgValue=null;b.dayCells=new TList;b.focusObject=
null;b.skipBlur=!1;b.styleYearMonth=RClass.register(b,new TStyle("YearMonth"));b.styleButton=RClass.register(b,new TStyle("Button"));b.styleButtonHover=RClass.register(b,new TStyle("ButtonHover"));b.styleDay=RClass.register(b,new TStyle("Day"));b.styleDaySel=RClass.register(b,new TStyle("DaySel"));b.styleDayHover=RClass.register(b,new TStyle("DayHover"));b.styleDayFree=RClass.register(b,new TStyle("DayFree"));b.styleDayNone=RClass.register(b,new TStyle("DayNone"));b.styleTitlePanel=RClass.register(b,
new TStyle("TitlePanel"));b.styleDaysPanel=RClass.register(b,new TStyle("DaysPanel"));b.styleTimePanel=RClass.register(b,new TStyle("TimePanel"));b.styleMonth=RClass.register(b,new TStyle("Year"));b.styleMonth=RClass.register(b,new TStyle("Month"));b.styleWeek=RClass.register(b,new TStyle("Week"));b.styleTime=RClass.register(b,new TStyle("Time"));b.styleHour=RClass.register(b,new TStyle("Hour"));b.styleSplit=RClass.register(b,new TStyle("Split"));b.styleMinute=RClass.register(b,new TStyle("Minute"));
b.styleSecond=RClass.register(b,new TStyle("Second"));b.styleNow=RClass.register(b,new TStyle("Now"));b.styleOk=RClass.register(b,new TStyle("Ok"));b.onDaySelect=RClass.register(b,new HMouseDown("onDaySelect"),FUiCalendarEditor_onDaySelect);b.onButtonNow=RClass.register(b,new HMouseDown("onButtonNow"),FUiCalendarEditor_onButtonNow);b.onDateKeyDown=RClass.register(b,new HKeyDown("onDateKeyDown"),FUiCalendarEditor_onDateKeyDown);b.onDateBlur=RClass.register(b,new HBlur("onDateBlur"),FUiCalendarEditor_onDateBlur);
b.onTimeBlur=RClass.register(b,new HBlur("onTimeBlur"),FUiCalendarEditor_onTimeBlur);b.onTimeClick=RClass.register(b,new HClick("onTimeClick"),FUiCalendarEditor_onTimeClick);b.onDayDbClick=RClass.register(b,new HDoubleClick("onDayDbClick"),FUiCalendarEditor_onDayDbClick);b.onDayEnter=RClass.register(b,new HMouseEnter("onDayEnter"),FUiCalendarEditor_onDayEnter);b.onDayOut=RClass.register(b,new HMouseOut("onDayOut"),FUiCalendarEditor_onDayOut);b.onButtonOk=RClass.register(b,new HMouseDown("onButtonOk"),
FUiCalendarEditor_onButtonOk);b.onButtonCancel=RClass.register(b,new HMouseDown("onButtonCancel"),FUiCalendarEditor_onButtonCancel);b.onButtonOver=RClass.register(b,new HMouseEnter("onButtonOver"),FUiCalendarEditor_onButtonOver);b.onButtonOut=RClass.register(b,new HMouseOut("onButtonOut"),FUiCalendarEditor_onButtonOut);b.onMdown=RClass.register(b,new HMouseDown("onMdown"),FUiCalendarEditor_onMdown);b.onMup=RClass.register(b,new HMouseUp("onMup"),FUiCalendarEditor_onMup);b.onBuildDrop=FUiCalendarEditor_onBuildDrop;
b.show=FUiCalendarEditor_show;b.setMinuteEditable=FUiCalendarEditor_setMinuteEditable;b.setHourEditable=FUiCalendarEditor_setHourEditable;b.setSecondEditable=FUiCalendarEditor_setSecondEditable;b.buildTitle=FUiCalendarEditor_buildTitle;b.buildDays=FUiCalendarEditor_buildDays;b.buildTime=FUiCalendarEditor_buildTime;b.testBlur=FUiCalendarEditor_testBlur;b.get=FUiCalendarEditor_get;b.set=FUiCalendarEditor_set;b.setDate=FUiCalendarEditor_setDate;b.storeChange=FUiCalendarEditor_storeChange;b.daySelectLsns=
new TListeners;b.onBuildButton=FUiCalendarEditor_onBuildButton;b.ohKdown=FUiCalendarEditor_ohKdown;b.ohDaysChange=FUiCalendarEditor_ohDaysChange;b.ohKeyCheck=FUiCalendarEditor_ohKeyCheck;b.onDateAction=FUiCalendarEditor_onDateAction;b.panel=FUiCalendarEditor_panel;b.dispose=FUiCalendarEditor_dispose;return b}function FUiCalendarEditor_onTimeClick(b){b=b.hSource;b.editAble&&b.select()}
function FUiCalendarEditor_onTimeBlur(b){b=b.hSource;b==this.hHour?b.value=Math.min(RInteger.parse(b.value),23):b==this.hMinute?b.value=Math.min(RInteger.parse(b.value),59):b==this.hSecond&&(b.value=Math.min(RInteger.parse(b.value),59));this.storeChange();this.setDate(this.date)}
function FUiCalendarEditor_onDayDbClick(b){var d=b.source;RClass.isClass(d,FUiCalendarEditor)&&0!=RInteger.parse(b.hSource.innerText)&&(d.date.setDay(b.hSource.innerText),d.dataValue=RDate.formatDate(d.date),d.editEnd())}function FUiCalendarEditor_onDaySelect(b){RClass.isClass(this,FUiCalendarEditor)&&0!=RInteger.parse(b.hSource.innerText)&&(b=b.hSource,this.hSelect&&(this.hSelect.style.border="1 solid #FFFFFF"),this.hSelect=b,b.style.border="1 solid #2BD6F0",this.date.setDay(b.innerText))}
function FUiCalendarEditor_onButtonNow(b){b=b.source;RClass.isClass(b,FUiCalendarEditor)&&(b.dataValue=RDate.format(),b.editEnd())}
function FUiCalendarEditor_onDateKeyDown(b,d){var f=b.hSource,h=f.value;EKey.Enter==b.keyCode?(this.storeChange(),this.setDate(this.date)):EKey.Up==b.keyCode?(f==this.hYear?this.hYear.value=RInteger.parse(this.hYear.value)+1:f==this.hMonth?this.hMonth.value=RInteger.parse(this.hMonth.value)+1:f==this.hHour?this.hHour.editAble&&23>h&&(f.value=RInteger.parse(f.value)+1):f==this.hMinute?this.hMinute.editAble&&59>h&&(f.value=RInteger.parse(f.value)+1):this.hSecond.editAble&&59>h&&(f.value=RInteger.parse(f.value)+
1),this.storeChange(),this.setDate(this.date)):EKey.Down==b.keyCode?(f==this.hYear?this.hYear.value=RInteger.parse(this.hYear.value)-1:f==this.hMonth?this.hMonth.value=RInteger.parse(this.hMonth.value)-1:f==this.hHour?this.hHour.editAble&&0<h&&(f.value=RInteger.parse(f.value)-1):f==this.hMinute?this.hMinute.editAble&&0<h&&(f.value=RInteger.parse(f.value)-1):this.hSecond.editAble&&0<h&&(f.value=RInteger.parse(f.value)-1),this.storeChange(),this.setDate(this.date),f.select()):f==this.hHour||f==this.hMinute||
f==this.hSecond?f.editAble?RKey.fixChars(d,RDate.Chars):(d.keyCode=0,d.returnValue=!1):RKey.fixChars(d,RDate.Chars)}function FUiCalendarEditor_onDateBlur(){this.storeChange();this.setDate(this.date)}
function FUiCalendarEditor_onBuildDrop(){this.hDatePanel=RBuilder.appendTable(this.hDropPanel);this.hDropPanel.align="center";this.hDatePanel.width="100%";var b=this.hDatePanel.insertRow(),b=this.hTitlePanel=b.insertCell();b.colSpan=2;b.className=this.style("TitlePanel");this.buildTitle();b=this.hDatePanel.insertRow();b=this.hDaysPanel=b.insertCell();b.colSpan=2;b.className=this.style("DaysPanel");this.buildDays();b=this.hDatePanel.insertRow();this.hTimePanel=b.insertCell();this.buildTime();this.pushFocus(this.hYear);
this.pushFocus(this.hMonth)}function FUiCalendarEditor_show(b){this.base.FDropEditor.show.call(this,b);b=this.hPanel;var d=this.source.getEditRange();b.style.pixelLeft=d.x;b.style.pixelTop=d.y+d.height;b.style.pixelWidth=273;this.base.MShadow.show.call(this)}
function FUiCalendarEditor_buildTitle(){var b=RBuilder.appendTable(this.hTitlePanel,null,0,5,1);b.align="center";b.width="100%";b.style.filter="progid:DXImageTransform.Microsoft.Gradient(startColorStr='#E5FAFE', endColorStr='#FFFFFF', gradientType='0')";var b=b.insertRow(),d=b.insertCell(),d=this.hYearPrior=RBuilder.append(d,"SPAN",this.style("Button"));d.link=this;d.linkAction=this.onDateAction;d.innerText="3";this.attachEvent("onButtonOver",d);this.attachEvent("onButtonOut",d);this.attachEvent("onMdown",
d);this.attachEvent("onMup",d);d=b.insertCell();d=this.hYear=RBuilder.append(d,"INPUT",this.style("Year"));d.maxLength="4";this.attachEvent("onDateBlur",d,this.onDateBlur);this.attachEvent("onDateKeyDown",d,this.onDateKeyDown);d=b.insertCell();d.innerText=RContext.get("FUiCalendarEditor:year");d.className=this.style("YearMonth");d=b.insertCell();d=this.hYearNext=RBuilder.append(d,"SPAN",this.style("Button"));d.link=this;d.linkAction=this.onDateAction;d.innerText="4";this.attachEvent("onButtonOver",
d);this.attachEvent("onButtonOut",d);this.attachEvent("onMdown",d);this.attachEvent("onMup",d);b.insertCell().width="10";d=b.insertCell();d=this.hMonthPrior=RBuilder.append(d,"SPAN",this.style("Button"));d.link=this;d.linkAction=this.onDateAction;d.innerText="3";this.attachEvent("onButtonOver",d);this.attachEvent("onButtonOut",d);this.attachEvent("onMdown",d);this.attachEvent("onMup",d);d=b.insertCell();d=this.hMonth=RBuilder.append(d,"INPUT",this.style("Month"));d.maxLength="2";this.attachEvent("onDateBlur",
d,this.onDateBlur);this.attachEvent("onDateKeyDown",d,this.onDateKeyDown);d=b.insertCell();d.innerText=RContext.get("FUiCalendarEditor:month");d.className=this.style("YearMonth");d=b.insertCell();d=this.hMonthNext=RBuilder.append(d,"SPAN",this.style("Button"));d.link=this;d.linkAction=this.onDateAction;d.innerText="4";this.attachEvent("onButtonOver",d);this.attachEvent("onButtonOut",d);this.attachEvent("onMdown",d);this.attachEvent("onMup",d)}
function FUiCalendarEditor_buildDays(){var b=RBuilder.appendTable(this.hDaysPanel,null,0,0,1);b.width="100%";for(var d=RContext.get("FUiCalendarEditor:weekdays").split(","),f=d.length,h=b.insertRow(),q=0;q<f;q++){var z=h.insertCell();z.className=this.style("Week");z.align="center";z.innerText=d[q]}for(q=0;6>q;q++)for(d=b.insertRow(),h=0;h<f;h++)z=d.insertCell(),z.link=this,z.className=this.style("DayNone"),this.attachEvent("onDayEnter",z),this.attachEvent("onDayOut",z),this.attachEvent("onDaySelect",
z),this.attachEvent("onDayDbClick",z),z.innerText=".",this.dayCells.push(z)}
function FUiCalendarEditor_buildTime(){var b=RBuilder.appendTable(this.hTimePanel,null,0,1,1);this.hTimePanel.style.filter="progid:DXImageTransform.Microsoft.Gradient(startColorStr='#FFFFFF', endColorStr='#E5FAFE', gradientType='0')";b=b.insertRow();b.insertCell().width=5;var d=b.insertCell();d.width=50;d.style.color="#1F8FB7";d.style.fontWeight="BOLD";d.innerText="\u65f6\u95f4:";var d=b.insertCell(),f=RBuilder.appendTable(d,null,0,0,0);d.style.border="1 solid #2BD6F0";d.style.backgroundColor="#FFFFFF";
d=f.insertRow();f=d.insertCell();f=this.hHour=RBuilder.appendEdit(f,this.style("Hour"));f.maxLength=2;this.attachEvent("onTimeClick",f);this.attachEvent("onDateKeyDown",f,this.onDateKeyDown);this.attachEvent("onTimeBlur",f,this.onTimeBlur);d.insertCell().innerText=":";f=d.insertCell();f=this.hMinute=RBuilder.appendEdit(f,this.style("Minute"));f.maxLength=2;this.attachEvent("onTimeClick",f);this.attachEvent("onDateKeyDown",f,this.onDateKeyDown);this.attachEvent("onTimeBlur",f,this.onTimeBlur);d.insertCell().innerText=
":";d=d.insertCell();d=this.hSecond=RBuilder.appendEdit(d,this.style("Second"));d.maxLength=2;this.attachEvent("onTimeClick",d);this.attachEvent("onDateKeyDown",d,this.onDateKeyDown);this.attachEvent("onTimeBlur",d,this.onTimeBlur);b.insertCell().width=50;d=b.insertCell();d.style.display="none";f=this.hNow=RBuilder.append(d,"SPAN",this.style("Now"));f.style.width=50;d.style.border="1 solid #2BD6F0";f.innerText=RContext.get("FUiCalendarEditor:now");f.style.display="none";f.link=this;this.attachEvent("onButtonNow",
f);d=b.insertCell();f=this.hCancel=RBuilder.append(d,"SPAN",this.style("Ok"));f.style.width=50;d.style.border="1 solid #2BD6F0";f.link=this;this.attachEvent("onButtonCancel",f);f.innerText=RContext.get("FUiCalendarEditor:cancel");b=b.insertCell();d=this.hOk=RBuilder.append(b,"SPAN",this.style("Ok"));d.style.width=50;b.style.border="1 solid #2BD6F0";d.link=this;this.attachEvent("onButtonOk",d);d.innerText=RContext.get("FUiCalendarEditor:ok")}
function FUiCalendarEditor_testBlur(b){return this.source!=b}function FUiCalendarEditor_get(){return this.dataValue}function FUiCalendarEditor_set(b,d){this.changed=!1;this.skipBlur=0;this.dateOrgValue=this.dataValue=b;this.editFormat=d;RDate.parse(this.date,b);RDate.parse(this.dateOrg,b);b||(this.date.now(),RDate.parse(this.date,b),RDate.parse(this.dateOrg,b));this.setDate(this.date)}
function FUiCalendarEditor_setDate(b){this.hYear.value=b.year;this.hMonth.value=b.month;this.hHour.value=RString.lpad(b.hour,2,"0");this.hMinute.value=RString.lpad(b.minute,2,"0");this.hSecond.value=RString.lpad(b.second,2,"0");var d=b.day;if(this.dateOrg.year!=b.year||this.dateOrg.month!=b.month)d=-1;this.hSelect&&(this.hSelect.style.border="1 solid #FFFFFF");b=this.date.monthWeekDay();for(var f=this.date.monthDays(),h=b,q=0;q<this.dayCells.count;q++){var z=this.dayCells.get(q);if(q<b)z.className=
this.style("DayNone"),z.innerText=".";else if(q<f+b){7==h&&(h=0);var A=q-b+1;A==d?(z.className=this.style("DaySel"),z.isCurrent=!0,this.hSelect=z,z.style.border="1 solid #2BD6F0"):(z.isFree=0==h||6==h,z.className=z.isFree?this.style("DayFree"):this.style("Day"),z.isCurrent=!1);z.innerText=A;h++}else z.className=this.style("DayNone"),z.innerText="."}}
function FUiCalendarEditor_setHourEditable(b){b?this.hHour.editAble=!0:(this.hHour.value="00",this.hHour.style.cursor="default",this.hHour.style.color="gray",this.hHour.editAble=!1)}function FUiCalendarEditor_setMinuteEditable(b){b?this.hMinute.editAble=!0:(this.hMinute.value="00",this.hMinute.style.cursor="default",this.hMinute.style.color="gray",this.hMinute.editAble=!1)}
function FUiCalendarEditor_setSecondEditable(b){b?this.hSecond.editAble=!0:(this.hSecond.value="00",this.hSecond.style.cursor="default",this.hSecond.style.color="gray",this.hSecond.editAble=!1)}
function FUiCalendarEditor_storeChange(){this.date.setYear(this.hYear.value);this.date.setMonth(this.hMonth.value);this.date.setHour(Math.min(RInteger.parse(this.hHour.value),23));this.date.setMinute(Math.min(RInteger.parse(this.hMinute.value),59));this.date.setSecond(Math.min(RInteger.parse(this.hSecond.value),59))}function FUiCalendarEditor_onBuildButton(){}
function FUiCalendarEditor_onMdown(b){var d=b.source;RClass.isClass(d,FUiCalendarEditor)&&(d.isSkipBlur=!0,b.hSource.linkAction&&b.hSource.linkAction.call(d,b.hSource))}function FUiCalendarEditor_onMup(b){b=b.source;RClass.isClass(b,FUiCalendarEditor)&&(b=b.focusObject)&&b.focus&&b.select&&(b.focus(),b.select())}
function FUiCalendarEditor_ohKdown(){var b=this.link;if(RClass.isClass(b,FUiCalendarEditor)){var d=RWindow.event(this);EKey.Esc==d.keyCode?(b.dataValue=b.dateOrgValue,b.editStatus=EEditStatus.Cancel,b.endEdit()):event.ctrlKey&&EKey.Enter==d.keyCode?(b.storeChange(),b.editStatus=EEditStatus.Ok,b.endEdit()):EKey.Enter==d.keyCode?(b.storeChange(),b.setDate(b.date)):EKey.Tab==d.keyCode&&(b.isSkipBlur=!0,d.shiftKey?b.focusPrior():b.focusNext(),d.returnValue=0)}}
function FUiCalendarEditor_onButtonOver(b){var d=b.source;RClass.isClass(d,FUiCalendarEditor)&&(b.hSource.className=d.style("ButtonHover"))}function FUiCalendarEditor_onButtonOut(b){var d=b.source;RClass.isClass(d,FUiCalendarEditor)&&(b.hSource.className=d.style("Button"))}function FUiCalendarEditor_onButtonOk(b){b=b.source;RClass.isClass(b,FUiCalendarEditor)&&(b.editStatus=EEditStatus.Ok,b.dataValue=RDate.formatDate(b.date),b.editEnd())}
function FUiCalendarEditor_onButtonCancel(b){b=b.source;RClass.isClass(b,FUiCalendarEditor)&&(b.editStatus=EEditStatus.Cancel,b.dataValue="",b.editEnd())}function FUiCalendarEditor_ohDaysChange(){var b=this.link;RClass.isClass(b,FUiCalendarEditor)&&(b.date.setYear(b.hYear.value),b.date.setMonth(b.hMonth.value),b.setDate(b.date))}function FUiCalendarEditor_ohKeyCheck(){var b=RWindow.event(this);RString.inChars(String.fromCharCode(b.keyCode),RDate.Chars)||(b.keyCode=0)}
function FUiCalendarEditor_onDayEnter(b){var d=b.source;RClass.isClass(d,FUiCalendarEditor)&&"."!=b.hSource.innerText&&!b.hSource.isCurrent&&(b.hSource.className=d.style("DayHover"))}function FUiCalendarEditor_onDayOut(b){var d=b.source;RClass.isClass(d,FUiCalendarEditor)&&"."!=b.hSource.innerText&&!b.hSource.isCurrent&&(b.hSource.className=b.hSource.isFree?d.style("DayFree"):d.style("Day"))}
function FUiCalendarEditor_onDateAction(b){this.hYearPrior==b?(this.date.addYear(-1),this.setDate(this.date),this.focusObject!=this.hYear&&(this.focusObject=this.hYear,this.hYear.focus(),this.hYear.select())):this.hYearNext==b?(this.date.addYear(1),this.setDate(this.date),this.focusObject!=this.hYear&&(this.focusObject=this.hYear,this.hYear.focus(),this.hYear.select())):this.hMonthPrior==b?(this.date.addMonth(-1),this.setDate(this.date),this.focusObject!=this.hMonth&&(this.focusObject=this.hMonth,
this.hMonth.focus())):this.hMonthNext==b&&(this.date.addMonth(1),this.setDate(this.date),this.focusObject!=this.hMonth&&(this.focusObject=this.hMonth,this.hMonth.focus()))}function FUiCalendarEditor_panel(b){return EPanel.Shadow==b?this.hPanel:this.base.FDropEditor.panel.call(this,b)}
function FUiCalendarEditor_dispose(){this.base.FDropEditor.dispose.call(this);this.hTimePanel=this.hTime=this.hMonth=this.hYear=this.hMonthNext=this.hButtonPanel=this.hNow=this.hOk=this.hTitlePanel=this.hDropPanel=this.hDatePanel=null}
function FUiCheck(b){b=RClass.inherits(this,b,FUiEditControl,MPropertyCheck,MListenerDataChanged);b._styleInput=RClass.register(b,new AStyle("_styleInput"));b._hInput=null;b.onBuildEditValue=FUiCheck_onBuildEditValue;b.onInputClick=RClass.register(b,new AEventClick("onInputClick"),FUiCheck_onInputClick);b.oeSaveValue=FUiCheck_oeSaveValue;b.construct=FUiCheck_construct;b.formatLoad=FUiCheck_formatLoad;b.formatSave=FUiCheck_formatSave;b.get=FUiCheck_get;b.set=FUiCheck_set;b.refreshValue=FUiCheck_refreshValue;
b.refreshStyle=FUiCheck_refreshStyle;return b}function FUiCheck_onBuildEditValue(b){b=this._hInput=RBuilder.appendCheck(this._hValuePanel,this.styleName("Input"));this.attachEvent("onInputClick",b)}function FUiCheck_onInputClick(b){this.refreshValue()}function FUiCheck_oeSaveValue(b){return EStore.Prepare==b.store?(RBoolean.isTrue(this.reget())&&b.values.set(this.dataName,EBoolean.True),EEventStatus.Stop):this.base.FUiEditControl.oeSaveValue.call(this,b)}
function FUiCheck_construct(){this.__base.FUiEditControl.construct.call(this);this._editSize.set(60,20)}function FUiCheck_formatLoad(b){return b==this._valueTrue}function FUiCheck_formatSave(b){return RBoolean.toString(b,this._valueTrue,this._valueFalse)}function FUiCheck_get(){return this._hInput.checked}function FUiCheck_set(b){this._hInput.checked=b}function FUiCheck_refreshValue(){this.processDataChangedListener(this)}
function FUiCheck_refreshStyle(){this.panel(EPanel.Edit).disabled=!this._editable;this._editable||(this.hEdit.style.cursor="normal")}
function FCheckPicker(b){b=RClass.inherits(this,b,FEditControl,MEditBorder,MDescCheckPicker,MDropable);b.stIconDropSelect=RClass.register(b,new TStyleIcon("DropSelect"));b.items=new TItems;b.borderStyle=EUiBorder.RoundDrop;b.onBuildEdit=FCheckPicker_onBuildEdit;b.onEditEnd=FCheckPicker_onEditEnd;b.onDataKeyDown=FCheckPicker_onDataKeyDown;b.loadConfig=FCheckPicker_loadConfig;b.formatValue=FCheckPicker_formatValue;b.validText=FCheckPicker_validText;b.formatText=FCheckPicker_formatText;b.refreshStyle=
FCheckPicker_refreshStyle;b.drop=FCheckPicker_drop;b.dispose=FCheckPicker_dispose;return b}function FCheckPicker_onBuildEdit(b){b=this.hEdit=RBuilder.appendEdit(b.hPanel,this.style("Edit"));this.editLength&&(b.maxLength=this.editLength)}function FCheckPicker_onEditEnd(b){RLog.debug(this,"Begin (editor={1}:{2} value={3})",b,b?b.value():"",this.dataValue);b&&this.set(b.values);this.onDataEditEnd(this);RLog.debug(this,"End (editor={1} value={2})",b,this.dataValue)}
function FCheckPicker_loadConfig(b){this.base.FEditControl.loadConfig.call(this,b);this.dataEmpty&&this.items.create();this.items.loadConfig(b);return EStatus.Stop}function FCheckPicker_text(){return this.hEdit.value}function FCheckPicker_setText(b){this.hEdit.value=b}
function FCheckPicker_formatValue(b){if(RString.isEmpty(b))return"";ta=RString.split(b,",");b=[];for(var d=this.items.items,f=0;f<ta.length;f++)for(var h=0;h<d.count;h++){var q=d.value(h);q.label==ta[f]&&b.push(q.value)}return RString.toUpper(b.join())}function FCheckPicker_validText(b){return RString.isEmpty(b)?!0:!RString.isEmpty(this.formatValue(b))}
function FCheckPicker_formatText(b){if(RString.isEmpty(b))return"";va=RString.split(b,",");b=[];for(var d=this.items.items,f=0;f<va.length;f++){var h=d.values[d.indexOf(va[f])];h&&b.push(h.label)}return RString.toUpper(b.join())}function FCheckPicker_refreshStyle(){this.base.FEditControl.refreshStyle.call(this);this.hDrop.src=this.styleIconPath(this._hover?"DropSelect":"Drop")}
function FCheckPicker_drop(){if(this.canDrop()&&this.canEdit&&0<this.items.count()){var b=this.editor=RConsole.find(FEditConsole).focus(this,FCheckPickerEditor,this.editRefer);b.linkControl(this)&&(b.setItems(this.items),b.set(this.reget()));b.show()}}function FCheckPicker_onDataKeyDown(b,d){this.base.FEditControl.onDataKeyDown.call(this,b,d);if(this.items.count()&&this.editor&&this.editor.source==this)this.editor.onEditKeyDown(b,d)}
function FCheckPicker_dispose(){this.base.FEditControl.dispose.call(this);RMemory.freeHtml(this.hEdit);this.hEdit=null}
function FCheckPickerEditor(b){b=RClass.inherits(this,b,FDropEditor,MShadow);b.MinWidth=120;b.onEditFocus=RClass.register(b,new HFocus("onEditFocus"));b.onEditBlur=RClass.register(b,new HBlur("onEditBlur"));b.stIconDropSelect=RClass.register(b,new TStyleIcon("DropSelect"));b.stFlag=RClass.register(b,new TStyle("Flag"));b.stEditForm=RClass.register(b,new TStyle("EditForm"));b.pattern=null;b.originItem=null;b.selectItem=null;b.items=null;b.itemClickListener=null;b.values=[];b.hBtnTextSpan=null;b.onBuildDrop=
FCheckPickerEditor_onBuildDrop;b.onBuildButton=FCheckPickerEditor_onBuildButton;b.onItemClick=FCheckPickerEditor_onItemClick;b.onEditKeyDown=FCheckPickerEditor_onEditKeyDown;b.construct=FCheckPickerEditor_construct;b.set=FCheckPickerEditor_set;b.setItems=FCheckPickerEditor_setItems;b.select=FCheckPickerEditor_select;b.linkControl=FCheckPickerEditor_linkControl;b.show=FCheckPickerEditor_show;b.hide=FCheckPickerEditor_hide;b.dispose=FCheckPickerEditor_dispose;return b}
function FCheckPickerEditor_construct(){this.itemClickListener=new TListener(this,this.onItemClick)}function FCheckPickerEditor_onBuildDrop(){this.hItemsForm=RBuilder.appendTable(this.hDropPanel);this.hItemsForm.width="100%";this.hItemsPanel=RBuilder.append(this.hItemsForm,"TBODY");this.onBuildButton()}function FCheckPickerEditor_onBuildButton(){this.base.FDropEditor.onBuildButton.call(this);(this.hBtnTextSpan=RBuilder.newSpan(this.hButtonPanel,null)).innerText="colse"}
function FCheckPickerEditor_onItemClick(b){b.setChecked(!b.checked);b=this.items.items;for(var d=this.components,f=[],h=0;h<b.count;h++){var q=d.value(h);q.checked&&f.push(q.value)}this.source.set(f.join())}function FCheckPickerEditor_select(b){var d=this.components;b=Math.min(Math.max(0,b),d.count-1);for(var f=0;f<d.count;f++)this.components.value(f).setChecked(f==b);this.position=b}function FCheckPickerEditor_onEditKeyDown(b,d){}
function FCheckPickerEditor_set(b){for(var d=this.components,f=d.count,h=0;h<f;h++)d.value(h).setChecked(!1);if(!RString.isEmpty(b))for(this.values=b,va=RString.split(b,","),h=0;h<va.length;h++)(b=d.get(va[h]))&&b.setChecked(!0)}
function FCheckPickerEditor_setItems(b){if(!this.components){var d=this.hItemsPanel;this.items=b;for(var f=b.count(),h=0;h<f;h++){if(0<h){var q=RBuilder.append(d,"TR");q.height=1;q=RBuilder.append(q,"TD");q.colSpan=3;q.style.borderTop="1 dashed #24c2db";RBuilder.appendEmpty(q)}var q=b.get(h),z=RControl.create(FSelectItem);z.name=q.value;z.lsnsClick.push(this.itemClickListener);z.set(q.icon,q.label,q.value);z.setPanel(d);this.push(z)}this.position=0}}
function FCheckPickerEditor_linkControl(b){if(this.source==b)return!1;this.source=b;RLog.debug(this,"link Panel (panel={0}, edit={1})",RClass.dump(b.hEditCell),RClass.dump(b.hEdit));RHtml.toRect(this.rect,b.hEditCell);RHtml.setPixelRect(this.hPanel,this.rect);this.hPanel.style.pixelTop=this.rect.bottom;var d=this.border.hForm;d.style.pixelWidth=b.editBorder.hForm.width;d.style.pixelHeight=b.editBorder.hForm.height;return!0}
function FCheckPickerEditor_show(b){this.base.FDropEditor.show.call(this,b);RConsole.find(FFocusConsole).focus(this);this.border.hForm.offsetWidth<this.MinWidth&&(this.border.hForm.style.pixelWidth=this.MinWidth);this.base.MShadow.show.call(this,b);this.isSkipBlur=!1}function FCheckPickerEditor_hide(){this.source=null;this.base.FDropEditor.hide.call(this);this.base.MShadow.hide.call(this)}
function FCheckPickerEditor_dispose(){this.base.FDropEditor.dispose.call(this);RMemory.freeHtml(this.hPanel);RMemory.freeHtml(this.hItemsForm);RMemory.freeHtml(this.hItemsPanel);RMemory.freeHtml(this.hBtnTextSpan);RMemory.freeHtml(this.hDropPanel);RMemory.freeHtml(this.hButtonPanel);this.hButtonPanel=this.hDropPanel=this.hBtnTextSpan=this.hItemsPanel=this.hItemsForm=this.hPanel=null}
function FUiColor(b){b=RClass.inherits(this,b,FEditControl);b._inputSize=RClass.register(b,new APtySize2("_inputSize"));b._styleInputPanel=RClass.register(b,new AStyle("_styleInputPanel"));b._styleInput=RClass.register(b,new AStyle("_styleInput"));b._hInput=null;b.onBuildEditValue=FUiColor_onBuildEditValue;b.construct=FUiColor_construct;b.get=FUiColor_get;b.set=FUiColor_set;return b}function FUiColor_oeDataLoad(b){alert(b);return EEventStatus.Stop}
function FUiColor_oeDataSave(b){return EEventStatus.Stop}function FUiColor_onBuildEditValue(b){b=this._hValuePanel;b.className=this.styleName("InputPanel");b=this._hInput=RBuilder.appendEdit(b,this.styleName("Input"));this._editLength&&(b.maxLength=this._editLength)}function FUiColor_construct(){this.__base.FEditControl.construct.call(this);this._inputSize=new SSize2(120,0)}function FUiColor_get(b){b=this.__base.FEditControl.get.call(this,b);var d=this._hInput;d&&(b=d.value);return b}
function FUiColor_set(b){this.__base.FEditControl.set.call(this,b);var d=this._hInput;d&&(d.value=RString.nvl(b))}function FUiColor_onDataKeyDown(b,d){this.__base.FEditControl.onDataKeyDown.call(this,b,d);this.editCase&&RKey.fixCase(d,this.editCase)}function FUiColor_formatValue(b){b=RString.nvl(b);ECase.Upper==this.editCase?b=RString.toUpper(b):ECase.Lower==this.editCase&&(b=RString.toLower(b));return b}
function FUiColor_setText(b){this.hEdit&&(this.hEdit.value="U"==this.editCase?RString.toUpper(b):"L"==this.editCase?RString.toLower(b):b,this.hEdit.style.textAlign="right"==this.editAlign?"right":"left"==this.editAlign?"left":"center")}
function FUiColor_validText(b){var d=this.__base.FEditControl.validText.call(this,b);if(!d){if(this.validLenmin&&this.validLenmin>b.length)return RContext.get("MDescEdit:ValidMinLength",this.validLenmin);if(this.validLenmax&&this.validLenmax<b.length)return RContext.get("MDescEdit:ValidMaxLength",this.validLenmax)}return d}
function FUiColor_findEditor(){if(this.editComplete){var b=this.editor;!b&&(this.dsControl=this.topControl(MDataset))&&(b=this.editor=RConsole.find(FUiColorConsole).focus(this,FUiColorEditor));b&&b.linkControl(this);return this.editor}}function FUiColor_drop(){var b=this.findEditor();if(b){var d=this.reget();0<d.length&&(this.finded!=d&&(b.source!=this&&b.linkControl(this),b.search(d)),this.finded=d)}}function FUiColor_clone(){var b=this._class.newInstance();GHtml_clone(b,this.hPanel);return b}
function FUiColor_link(){}
function FUiColor3Tpl(b){b=RClass.inherits(this,b,FEditControl,MListenerDataChanged);b._inputSize=RClass.register(b,new APtySize2("_inputSize"));b._styleValuePanel=RClass.register(b,new AStyle("_styleValuePanel"));b._styleInput=RClass.register(b,new AStyle("_styleInput"));b._innerOriginValue=null;b._innerDataValue=null;b._hInputRed=null;b._hInputGreen=null;b._hInputBlue=null;b.onBuildEditValue=FUiColor3Tpl_onBuildEditValue;b.onInputKeyPress=RClass.register(b,new AEventKeyPress("onInputKeyPress"),FUiColor3Tpl_onInputKeyPress);
b.onInputChanged=RClass.register(b,new AEventInputChanged("onInputChanged"),FUiColor3Tpl_onInputChanged);b.construct=FUiColor3Tpl_construct;b.get=FUiColor3Tpl_get;b.set=FUiColor3Tpl_set;return b}
function FUiColor3Tpl_onBuildEditValue(b){var d=this._hValuePanel;d.className=this.styleName("ValuePanel");d=this._hValueForm=RBuilder.appendTable(d);d.width="100%";d=this._hValueLine=RBuilder.appendTableRow(d);this._hChangePanel=RBuilder.appendTableCell(d);this.onBuildEditChange(b);var f=RBuilder.appendTableCell(d);f.style.borderRight="1px solid #666666";f=this._hInputRed=RBuilder.appendEdit(f,this.styleName("Input"));this.attachEvent("onInputKeyPress",f,this.onInputKeyPress);this.attachEvent("onInputChanged",
f,this.onInputChanged);f=RBuilder.appendTableCell(d);f.style.borderLeft="1px solid #999999";f.style.borderRight="1px solid #666666";f=this._hInputGreen=RBuilder.appendEdit(f,this.styleName("Input"));this.attachEvent("onInputKeyPress",f,this.onInputKeyPress);this.attachEvent("onInputChanged",f,this.onInputChanged);f=RBuilder.appendTableCell(d);f.style.borderLeft="1px solid #999999";f=this._hInputBlue=RBuilder.appendEdit(f,this.styleName("Input"));this.attachEvent("onInputKeyPress",f,this.onInputKeyPress);
this.attachEvent("onInputChanged",f,this.onInputChanged);(this._hDropPanel=RBuilder.appendTableCell(d)).style.borderLeft="1px solid #666666";this.onBuildEditDrop(b)}function FUiColor3Tpl_onInputKeyPress(b){EKeyCode.floatCodes[b.keyCode]||b.cancel()}function FUiColor3Tpl_onInputChanged(b){this.processDataChangedListener(this)}
function FUiColor3Tpl_construct(){this.__base.FEditControl.construct.call(this);this._inputSize=new SSize2(120,0);this._innerOriginValue=new SColor4;this._innerDataValue=new SColor4}function FUiColor3Tpl_get(b){b=this._innerDataValue;var d=this._hInputRed;d&&(b.red=RFloat.parse(d.value));if(d=this._hInputGreen)b.green=RFloat.parse(d.value);if(d=this._hInputBlue)b.blue=RFloat.parse(d.value);return b}
function FUiColor3Tpl_set(b){this.__base.FEditControl.set.call(this,b);if(b.constructor==SColor4)this._innerOriginValue.assign(b),this._innerDataValue.assign(b);else throw new TError("Invalid value format.");b=this._innerDataValue;var d=this._hInputRed;d&&(d.value=RFloat.format(b.red,0,null,2,null));if(d=this._hInputGreen)d.value=RFloat.format(b.green,0,null,2,null);if(d=this._hInputBlue)d.value=RFloat.format(b.blue,0,null,2,null);this.changeSet(!1)}
function FUiColor3Tpl_onDataKeyDown(b,d){this.__base.FEditControl.onDataKeyDown.call(this,b,d);this.editCase&&RKey.fixCase(d,this.editCase)}function FUiColor3Tpl_formatValue(b){b=RString.nvl(b);ECase.Upper==this.editCase?b=RString.toUpper(b):ECase.Lower==this.editCase&&(b=RString.toLower(b));return b}
function FUiColor3Tpl_setText(b){this.hEdit&&(this.hEdit.value="U"==this.editCase?RString.toUpper(b):"L"==this.editCase?RString.toLower(b):b,this.hEdit.style.textAlign="right"==this.editAlign?"right":"left"==this.editAlign?"left":"center")}
function FUiColor3Tpl_validText(b){var d=this.__base.FEditControl.validText.call(this,b);if(!d){if(this.validLenmin&&this.validLenmin>b.length)return RContext.get("MDescEdit:ValidMinLength",this.validLenmin);if(this.validLenmax&&this.validLenmax<b.length)return RContext.get("MDescEdit:ValidMaxLength",this.validLenmax)}return d}
function FUiColor3Tpl_findEditor(){if(this.editComplete){var b=this.editor;!b&&(this.dsControl=this.topControl(MDataset))&&(b=this.editor=RConsole.find(FUiColor3TplConsole).focus(this,FUiColor3TplEditor));b&&b.linkControl(this);return this.editor}}function FUiColor3Tpl_drop(){var b=this.findEditor();if(b){var d=this.reget();0<d.length&&(this.finded!=d&&(b.source!=this&&b.linkControl(this),b.search(d)),this.finded=d)}}
function FUiColor3Tpl_clone(){var b=this._class.newInstance();GHtml_clone(b,this.hPanel);return b}function FUiColor3Tpl_link(){}
function FUiColor4(b){b=RClass.inherits(this,b,FEditControl);b._inputSize=RClass.register(b,new APtySize2("_inputSize"));b._styleInputPanel=RClass.register(b,new AStyle("_styleInputPanel"));b._styleInput=RClass.register(b,new AStyle("_styleInput"));b._hInput=null;b.onBuildEditValue=FUiColor4_onBuildEditValue;b.construct=FUiColor4_construct;b.get=FUiColor4_get;b.set=FUiColor4_set;return b}function FUiColor4_oeDataLoad(b){alert(b);return EEventStatus.Stop}
function FUiColor4_oeDataSave(b){return EEventStatus.Stop}function FUiColor4_onBuildEditValue(b){b=this._hValuePanel;b.className=this.styleName("InputPanel");b=this._hInput=RBuilder.appendEdit(b,this.styleName("Input"));this._editLength&&(b.maxLength=this._editLength)}function FUiColor4_construct(){this.__base.FEditControl.construct.call(this);this._inputSize=new SSize2(120,0)}function FUiColor4_get(b){b=this.__base.FEditControl.get.call(this,b);var d=this._hInput;d&&(b=d.value);return b}
function FUiColor4_set(b){this.__base.FEditControl.set.call(this,b);var d=null;if(b.constructor==SColor4){var d=RFloat.format(b.red,0,null,3,null),f=RFloat.format(b.green,0,null,3,null);b=RFloat.format(b.blue,0,null,3,null);d=d+","+f+","+b}if(b=this._hInput)b.value=d}function FUiColor4_onDataKeyDown(b,d){this.__base.FEditControl.onDataKeyDown.call(this,b,d);this.editCase&&RKey.fixCase(d,this.editCase)}
function FUiColor4_formatValue(b){b=RString.nvl(b);ECase.Upper==this.editCase?b=RString.toUpper(b):ECase.Lower==this.editCase&&(b=RString.toLower(b));return b}function FUiColor4_setText(b){this.hEdit&&(this.hEdit.value="U"==this.editCase?RString.toUpper(b):"L"==this.editCase?RString.toLower(b):b,this.hEdit.style.textAlign="right"==this.editAlign?"right":"left"==this.editAlign?"left":"center")}
function FUiColor4_validText(b){var d=this.__base.FEditControl.validText.call(this,b);if(!d){if(this.validLenmin&&this.validLenmin>b.length)return RContext.get("MDescEdit:ValidMinLength",this.validLenmin);if(this.validLenmax&&this.validLenmax<b.length)return RContext.get("MDescEdit:ValidMaxLength",this.validLenmax)}return d}
function FUiColor4_findEditor(){if(this.editComplete){var b=this.editor;!b&&(this.dsControl=this.topControl(MDataset))&&(b=this.editor=RConsole.find(FUiColor4Console).focus(this,FUiColor4Editor));b&&b.linkControl(this);return this.editor}}function FUiColor4_drop(){var b=this.findEditor();if(b){var d=this.reget();0<d.length&&(this.finded!=d&&(b.source!=this&&b.linkControl(this),b.search(d)),this.finded=d)}}
function FUiColor4_clone(){var b=this._class.newInstance();GHtml_clone(b,this.hPanel);return b}function FUiColor4_link(){}
function FUiColorPicker(b){b=RClass.inherits(this,b,FEditControl,MEditBorder,MDescColor,MDropable);b.borderStyle=EUiBorder.RoundDrop;b.onBuildEdit=FUiColorPicker_onBuildEdit;b.onEditEnd=FUiColorPicker_onEditEnd;b.onDataKeyDown=FUiColorPicker_onDataKeyDown;b.checkColor=FUiColorPicker_checkColor;b.setText=FUiColorPicker_setText;b.drop=FUiColorPicker_drop;b.dispose=FUiColorPicker_dispose;return b}
function FUiColorPicker_onBuildEdit(b){(this.hEdit=RBuilder.appendEdit(b.hPanel,this.style("Edit"))).maxLength=20}function FUiColorPicker_onEditEnd(b){RLog.debug(this,"Begin (editor={0}:{1} value={2})",b,b?b.color:"",this.dataValue);b&&(this.set(b.color),this.hDrop.style.backgroundColor=b.color);this.onDataEditEnd(this);RLog.debug(this,"End (editor={0} value={1})",b,this.dataValue)}
function FUiColorPicker_setText(b){this.base.FEditControl.setText.call(this,RString.toUpper(b));this.hDrop.style.backgroundColor=b}function FUiColorPicker_checkColor(b){return""!=document.createElement("<span style='color:"+b+";'></span>").style.color?!0:!1}function FUiColorPicker_onDataKeyDown(b){this.base.FEditControl.onDataKeyDown.call(this,this,b);this.checkColor(this.text())?this.hDrop.style.backgroundColor=this.text():this.hDrop.style.backgroundColor=""}
function FUiColorPicker_drop(){if(this.canDrop()&&this.canEdit){var b=this.editor=RConsole.find(FEditConsole).focus(this,FUiColorPickerEditor,this.name);b.linkControl(this)&&b.set(this.reget());b.show()}}function FUiColorPicker_dispose(){this.base.FEditControl.dispose.call(this);RMemory.freeHtml(this.hEdit);RMemory.freeHtml(this.hDrop);this.hDrop=this.hEdit=null}
function FColorPickerEditor(b){b=RClass.inherits(this,b,FDropEditor,MShadow);b.MinWidth=240;b.ColorHex="00 33 66 99 CC FF".split(" ");b.SpColorHex="FF0000 00FF00 0000FF FFFF00 00FFFF FF00FF".split(" ");b.onCellEnter=RClass.register(b,new HMouseOver("onCellEnter"),FColorPickerEditor_onCellEnter);b.onCellSelect=RClass.register(b,new HMouseDown("onCellSelect"),FColorPickerEditor_onCellSelect);b.color=null;b.hTable=null;b.cellWidth=16;b.cellHeight=10;b.onBuildDrop=FColorPickerEditor_onBuildDrop;b.onKeyDown=
FColorPickerEditor_onKeyDown;b.onCellSelect=FColorPickerEditor_onCellSelect;b.onEditEnd=FColorPickerEditor_onEditEnd;b.makeCell=FColorPickerEditor_makeCell;b.set=FColorPickerEditor_set;b.show=FColorPickerEditor_show;b.hide=FColorPickerEditor_hide;b.linkControl=FColorPickerEditor_linkControl;b.dispose=FColorPickerEditor_dispose;return b}
function FColorPickerEditor_onBuildDrop(){this.hTable=RBuilder.appendTable(this.hDropPanel);for(var b=0;2>b;b++)for(var d=0;6>d;d++){var f=this.hTable.insertRow();this.makeCell(f,"#000000");0==b?this.makeCell(f,"#"+this.ColorHex[d]+this.ColorHex[d]+this.ColorHex[d]):this.makeCell(f,"#"+this.SpColorHex[d]);this.makeCell(f,"#000000");for(k=0;3>k;k++)for(l=0;6>l;l++)this.makeCell(f,"#"+this.ColorHex[k+3*b]+this.ColorHex[l]+this.ColorHex[d])}}
function FColorPickerEditor_linkControl(b){if(this.source==b)return!1;this.source=b;RLog.debug(this,"link Panel (panel={0}, edit={1})",RClass.dump(b.hEditCell),RClass.dump(b.hEdit));RHtml.toRect(this.rect,b.hEditCell);RHtml.setPixelRect(this.hPanel,this.rect);this.hPanel.style.pixelTop=this.rect.bottom;var d=this.border.hForm;d.style.pixelWidth=b.editBorder.hForm.width;d.style.pixelHeight=b.editBorder.hForm.height;return!0}
function FColorPickerEditor_onCellEnter(b){this.editable.hDrop.style.backgroundColor=b.hSource.style.backgroundColor}function FColorPickerEditor_onCellSelect(b){this.color=b.srcElement.style.backgroundColor;this.editStatus=EEditStatus.Ok;this.blur()}function FColorPickerEditor_makeCell(b,d){var f=b.insertCell();f.link=this;f.width=this.cellWidth;f.height=this.cellHeight;f.style.backgroundColor=d;this.attachEvent("onCellEnter",f);this.attachEvent("onCellSelect",f);return f}
function FColorPickerEditor_onKeyDown(b){alert(FColorPickerEditor_onKeyDown);var d=b.keyCode;EKey.Up==d?this.select(this.selectIndex-1):EKey.Down==d?this.select(this.selectIndex+1):EKey.Esc==d?(this.editStatus=EEditStatus.Cancel,this.selectIndex=this.originIndex,RKey.eventClear(b),this.inEdit=!1,this.hEdit.blur()):EKey.Enter==d&&(this.editStatus=EEditStatus.Ok,RKey.eventClear(b),this.inEdit=!1,this.hEdit.blur())}function FColorPickerEditor_set(b){this.color=b}
function FColorPickerEditor_show(b){this.base.FDropEditor.show.call(this,b);RConsole.find(FFocusConsole).focus(this);this.border.hForm.offsetWidth<this.MinWidth&&(this.border.hForm.style.pixelWidth=this.MinWidth);this.base.MShadow.show.call(this,b);this.isSkipBlur=!1}
function FColorPickerEditor_onEditEnd(){var b=this.editable;RLog.debug(this,"Edit end (editable={0}, status={1})",RClass.dump(b),REnum.decode(EEditStatus,this.editStatus));if(b){b.hDrop.style.backgroundColor=this.color;var d=RConsole.find(FEventConsole);EEditStatus.Cancel==this.editStatus?d.add(b,b.focus):EEditStatus.Ok==this.editStatus&&(b.onEditEnd(this),d.add(b,b.focus))}this.editable=null;this.inEdit=!1}
function FColorPickerEditor_hide(){this.source=null;this.base.FDropEditor.hide.call(this);this.base.MShadow.hide.call(this)}function FColorPickerEditor_dispose(){this.base.FDropEditor.dispose.call(this);RMemory.freeHtml(this.hTable);RMemory.freeHtml(this.hDropPanel);RMemory.freeHtml(this.hEdit);this.hEdit=this.hDropPanel=this.hTable=null}
function FUiColorPower(b){b=RClass.inherits(this,b,FUiEditControl,MListenerDataChanged,MMouseCapture);b._inputSize=RClass.register(b,new APtySize2("_inputSize"));b._valueMin=RClass.register(b,new APtyNumber("_valueMin"));b._valueMax=RClass.register(b,new APtyNumber("_valueMax"));b._styleValuePanel=RClass.register(b,new AStyle("_styleValuePanel"));b._styleInputPanel=RClass.register(b,new AStyle("_styleInputPanel"));b._styleInput=RClass.register(b,new AStyle("_styleInput"));b._innerOriginValue=null;
b._innerDataValue=null;b._barRed=null;b._barGreen=null;b._barBlue=null;b._barPower=null;b._hColorPanel=null;b._hColorImage=null;b._hChannelPanel=null;b._hChannelForm=null;b.onBuildEditValue=FUiColorPower_onBuildEditValue;b.onMouseCaptureStart=FUiColorPower_onMouseCaptureStart;b.onMouseCapture=FUiColorPower_onMouseCapture;b.onMouseCaptureStop=FUiColorPower_onMouseCaptureStop;b.onInputKeyPress=RClass.register(b,new AEventKeyPress("onInputKeyPress"),FUiColorPower_onInputKeyPress);b.onInputEdit=RClass.register(b,
new AEventInputChanged("onInputEdit"),FUiColorPower_onInputEdit);b.onInputChange=RClass.register(b,new AEventChange("onInputChange"),FUiColorPower_onInputChange);b.construct=FUiColorPower_construct;b.get=FUiColorPower_get;b.set=FUiColorPower_set;b.setDisplayColor=FUiColorPower_setDisplayColor;b.setDisplay=FUiColorPower_setDisplay;b.refreshValue=FUiColorPower_refreshValue;b.dispose=FUiColorPower_dispose;return b}
function FUiColorPower_onBuildEditValue(b){var d=this._hValuePanel;d.className=this.styleName("ValuePanel");d=this._hValueForm=RBuilder.appendTable(d);d.width="100%";d=this._hValueLine=RBuilder.appendTableRow(d);this._hChangePanel=RBuilder.appendTableCell(d);this.onBuildEditChange(b);b=this._hColorPanel=RBuilder.appendTableCell(d);b.width=16;b.style.padding="2px";this._hColorImage=RBuilder.appendIcon(b,null,"n",14,65);b=this._hChannelPanel=RBuilder.appendTableCell(d);b=this._hChannelForm=RBuilder.appendTable(b,
null,0,1,0);b.__linker=this;b.width="100%";d=this._barRed=new SUiColorChannel;d.control=this;d.typeCd="red";d.hPanel=b;d.build();d=this._barGreen=new SUiColorChannel;d.control=this;d.typeCd="green";d.hPanel=b;d.build();d=this._barBlue=new SUiColorChannel;d.control=this;d.typeCd="blue";d.hPanel=b;d.build();d=this._barPower=new SUiColorPower;d.control=this;d.typeCd="power";d.setRange(this._valueMin,this._valueMax);d.hPanel=b;d.build()}
function FUiColorPower_onMouseCaptureStart(b){var d=RHtml.searchObject(b.hSource,"__pbar");if(d)d.onMouseDown(b)}function FUiColorPower_onMouseCapture(b){var d=RHtml.searchObject(b.hSource,"__pbar");if(d)d.onMouseMove(b)}function FUiColorPower_onMouseCaptureStop(b){var d=RHtml.searchObject(b.hSource,"__pbar");if(d)d.onMouseUp(b)}function FUiColorPower_onInputKeyPress(b){var d=b.keyCode;RKeyboard.isControlKey(d)||RKeyboard.isFloatKey(d)||b.cancel()}
function FUiColorPower_onInputEdit(b){(b=b.hSender._pbar)&&b.changeInputEdit();this.processDataChangedListener(this)}function FUiColorPower_onInputChange(b){(b=b.hSender._pbar)&&b.changeInputChange();this.processDataChangedListener(this)}function FUiColorPower_construct(){this.__base.FUiEditControl.construct.call(this);this._inputSize=new SSize2(120,0);this._innerOriginValue=new SColor4;this._innerDataValue=new SColor4}
function FUiColorPower_get(b){b=this._innerDataValue;b.red=this._barRed.get();b.green=this._barGreen.get();b.blue=this._barBlue.get();b.alpha=this._barPower.get();return b}
function FUiColorPower_set(b){this.__base.FUiEditControl.set.call(this,b);if(b.constructor==SColor4)this._innerOriginValue.assign(b),this._innerDataValue.assign(b);else throw new TError("Invalid value format.");this.setDisplayColor();b=this._innerDataValue;this._barRed.set(b.red);this._barGreen.set(b.green);this._barBlue.set(b.blue);this._barPower.set(b.alpha);this.changeSet(!1)}
function FUiColorPower_setDisplayColor(){var b=this._innerDataValue,d=b.alpha,f=RHex.format(RInteger.toRange(parseInt(b.red*d*255),0,255),2),h=RHex.format(RInteger.toRange(parseInt(b.green*d*255),0,255),2),b=RHex.format(RInteger.toRange(parseInt(b.blue*d*255),0,255),2);this._hColorImage.style.backgroundColor="#"+f+h+b}
function FUiColorPower_setDisplay(){this.setDisplayColor();var b=this._innerDataValue;this._barRed.set(b.red);this._barGreen.set(b.green);this._barBlue.set(b.blue);this._barPower.set(b.alpha)}function FUiColorPower_refreshValue(){this.get();this.setDisplayColor();this.processDataChangedListener(this)}function FUiColorPower_dispose(b){this.__base.FUiEditControl.dispose.call(this,b)}
function FUiDateTime(b){b=RClass.inherits(this,b,FUiEditControl,MUiDropable);b.editDispMode=RClass.register(b,new APtySet("editDisplay","editDate",EDateTimeMode.Display));b.editYear=RClass.register(b,new APtySet("editYear","editDate",EDateTimeMode.Year));b.editMonth=RClass.register(b,new APtySet("editMonth","editDate",EDateTimeMode.Month));b.editDay=RClass.register(b,new APtySet("editDay","editDate",EDateTimeMode.Day));b._date=null;b.borderStyle=EUiBorder.RoundDrop;b.lsnEditEnd=null;b.hYearPanel=
null;b.hYear=null;b.hMonthPanel=null;b.hMonth=null;b.hDayPanel=null;b.hDay=null;b.onKeyPress=FUiDateTime_onKeyPress;b.onEditEnd=FUiDateTime_onEditEnd;b.onBuildEdit=FUiDateTime_onBuildEdit;b.oeSaveValue=FUiDateTime_oeSaveValue;b.construct=FUiDateTime_construct;b.formatValue=FUiDateTime_formatValue;b.text=FUiDateTime_text;b.setText=FUiDateTime_setText;b.validText=FUiDateTime_validText;b.setEditable=FUiDateTime_setEditable;b.refreshStyle=FUiDateTime_refreshStyle;b.drop=FUiDateTime_drop;b.dispose=FUiDateTime_dispose;
return b}function FUiDateTime_onKeyPress(b){RString.inChars(String.fromCharCode(b.keyCode),RDate.Chars)||RKey.eventClear(b)}function FUiDateTime_onEditEnd(b){b&&this.set(b.get());this.onDataEditEnd(this)}
function FUiDateTime_onBuildEdit(b){b=RBuilder.appendTable(b.hPanel);b.width="100%";b.style.tableLayout="fixed";b=this.hEdit=b.insertRow();this.onBuildChange(b.insertCell());var d=oonDateDoubleClickPanel=b.insertCell();d.width="40%";d.style.padding="0 1";d=this.hYear=RBuilder.appendEdit(d);d.maxLength=4;d.style.border=0;d.style.width="100%";d.style.textAlign="right";d=this.hYearSplit=b.insertCell();d.width=5;d.innerText="-";this.hYear.style.display=this.editYear?"block":"none";this.hYearSplit.style.display=
this.editYear?"block":"none";d=this.hMonthPanel=b.insertCell();d.width="20%";d.style.padding="0 1";d=this.hMonth=RBuilder.appendEdit(d);d.maxLength=2;d.style.border=0;d.style.width="100%";d.style.textAlign="right";d=this.hMonthSplit=b.insertCell();d.width=5;d.innerText="-";this.hMonth.style.display=this.editMonth?"block":"none";this.hMonthSplit.style.display=this.editDay?"block":"none";d=this.hDayPanel=b.insertCell();d.width="20%";d.style.padding="0 1";d=this.hDay=RBuilder.appendEdit(d);d.maxLength=
2;d.style.border=0;d.style.width="100%";d.style.textAlign="right";this.hDay.style.display=this.editDay?"block":"none"}function FUiDateTime_oeSaveValue(b){var d=RString.nvl(this.dataCode,this.dataName);if(!RString.isEmpty(d)){b=b.values;var f=b.get(d);f?b.set(d,this.reget().substring(0,8)+f.substring(8)):b.set(d,this.reget())}return EEventStatus.Stop}
function FUiDateTime_construct(){this.base.FUiEditControl.construct.call(this);this._date=new TDate;this.lsnEditEnd=new TListener(this,this.onEditEnd)}function FUiDateTime_formatValue(b){return b?("@now"==b.toLowerCase()?this._date.now():RDate.autoParse(this._date,b),RDate.formatDate(this._date)):RString.nvl(b)}function FUiDateTime_text(){this._date.setYear(this._date.year);this._date.setMonth(this._date.month);this._date.setDay(this._date.day);return RDate.formatDate(this._date)}
function FUiDateTime_setText(b){b?(RDate.autoParse(this._date,b),this.hYear.value=RInteger.format(this._date.year,4),this.hMonth.value=RInteger.format(this._date.month,2),this.hDay.value=RInteger.format(this._date.day,2)):(this.hYear.value="",this.hMonth.value="",this.hDay.value="")}function FUiDateTime_validText(b){return null}function FUiDateTime_setEditable(b){this.base.FUiEditControl.setEditable.call(this,b);this.hYear.readOnly=!b;this.hMonth.readOnly=!b;this.hDay.readOnly=!b}
function FUiDateTime_refreshStyle(){this.base.FUiEditControl.refreshStyle.call(this);this.hYear.style.color=this._textColor;this.hYear.style.backgroundColor=this._backColor;this.hMonth.style.color=this._textColor;this.hMonth.style.backgroundColor=this._backColor;this.hDay.style.color=this._textColor;this.hDay.style.backgroundColor=this._backColor}
function FUiDateTime_drop(){if(this.canDrop()&&this._editable){var b=this.editor=RConsole.find(FEditConsole).focus(this,FUiDateTimeEditor,this.editRefer);b.set(RDate.formatDate(this._date));b.setYearVisible(this.editYear);b.setMonthVisible(this.editMonth);b.setDayVisible(this.editDay);b.lsnEditEnd=this.lsnEditEnd;b.show()}}function FUiDateTime_dispose(){this.base.FUiEditControl.dispose.call(this);this._date=null}
function FUiDateTimeEditor(b){b=RClass.inherits(this,b,FUiDropEditor);b.date=null;b.years=null;b.months=null;b.days=null;b.hPanelDay=null;b.hPanelMonth=null;b.hPanelYear=null;b.hTitleDay=null;b.hTitleMonth=null;b.hTitleYear=null;b.onButtonEnter=RClass.register(b,new AEventMouseEnter("onButtonEnter"),FUiDateTimeEditor_onButtonEnter);b.onButtonLeave=RClass.register(b,new AEventMouseLeave("onButtonLeave"),FUiDateTimeEditor_onButtonLeave);b.onYearClick=RClass.register(b,new AEventMouseDown("onYearClick"),
FUiDateTimeEditor_onYearClick);b.onMonthClick=RClass.register(b,new AEventMouseDown("onMonthClick"),FUiDateTimeEditor_onMonthClick);b.onDayClick=RClass.register(b,new AEventMouseDown("onDayClick"),FUiDateTimeEditor_onDayClick);b.onDateDoubleClick=RClass.register(b,new AEventDoubleClick("onDateDoubleClick"),FUiDateTimeEditor_onDateDoubleClick);b.onNowClick=RClass.register(b,new AEventMouseDown("onNowClick"),FUiDateTimeEditor_onNowClick);b.onConfirmClick=RClass.register(b,new AEventMouseDown("onConfirmClick"),
FUiDateTimeEditor_onConfirmClick);b.onBuildDrop=FUiDateTimeEditor_onBuildDrop;b.onBuildButton=FUiDateTimeEditor_onBuildButton;b.construct=FUiDateTimeEditor_construct;b.buildTitle=FUiDateTimeEditor_buildTitle;b.get=FUiDateTimeEditor_get;b.set=FUiDateTimeEditor_set;b.resetDay=FUiDateTimeEditor_resetDay;b.setYearVisible=FUiDateTimeEditor_setYearVisible;b.setMonthVisible=FUiDateTimeEditor_setMonthVisible;b.setDayVisible=FUiDateTimeEditor_setDayVisible;b.selectCell=FUiDateTimeEditor_selectCell;b.restore=
FUiDateTimeEditor_restore;b.show=FUiDateTimeEditor_show;b.dispose=FUiDateTimeEditor_dispose;return b}function FUiDateTimeEditor_onButtonEnter(b){!b.hSource.isSelect&&RString.isEmpty(b.hSource.innerText)&&(b.hSource.style.backgroundColor="#CCCCFF")}function FUiDateTimeEditor_onButtonLeave(b){b.hSource.isSelect||(b.hSource.style.backgroundColor="#FFFFFF")}function FUiDateTimeEditor_onYearClick(b){this.date.setYear(b.hSource.innerText);this.restore();this.resetDay()}
function FUiDateTimeEditor_onMonthClick(b){this.date.setMonth(b.hSource.innerText);this.restore();this.resetDay()}function FUiDateTimeEditor_onDayClick(b){RString.equals(b.hSource.innerText,".")||(this.date.setDay(b.hSource.innerText),this.restore())}function FUiDateTimeEditor_onDateDoubleClick(){this.onConfirmClick()}function FUiDateTimeEditor_onNowClick(){this.date=new TDate;this.editEnd()}
function FUiDateTimeEditor_onConfirmClick(){this.date.setYear(this.hYear.value);this.date.setMonth(this.hMonth.value);this.date.setDay(this.hDay.value);this.editEnd()}
function FUiDateTimeEditor_onBuildDrop(){var b=this.hDropPanel;b.width=220;this.attachEvent("onDateDoubleClick",b);this.hTitleYear=this.buildTitle("Year",4);var d=this.hPanelYear=this.hSelectPanel=RBuilder.appendTable(b);d.width="100%";for(var f=0;4>f;f++)for(var h=d.insertRow(),q=0;4>q;q++){var z=h.insertCell();z.innerText=RInteger.format(2E3+4*f+q,2);z.align="center";z.style.padding="1 6";z.style.cursor="hand";z.style.borderBottom="1 solid #EEEEEE";5>q&&(z.style.borderRight="1 solid #EEEEEE");this.attachEvent("onButtonEnter",
z);this.attachEvent("onButtonLeave",z);this.attachEvent("onYearClick",z);this.years.push(z)}this.hTitleMonth=this.buildTitle("Month",2);d=this.hPanelMonth=this.hSelectPanel=RBuilder.appendTable(b);d.width="100%";for(f=0;2>f;f++)for(h=d.insertRow(),q=0;6>q;q++)z=h.insertCell(),z.innerText=RInteger.format(6*f+q+1,2),z.align="center",z.style.cursor="hand",z.style.borderBottom="1 solid #EEEEEE",5>q&&(z.style.borderRight="1 solid #EEEEEE"),this.attachEvent("onButtonEnter",z),this.attachEvent("onButtonLeave",
z),this.attachEvent("onMonthClick",z),this.months.push(z);this.hTitleDay=this.buildTitle("Day",2);d=this.hPanelDay=this.hSelectPanel=RBuilder.appendTable(b);d.width="100%";for(f=0;5>f;f++)for(h=d.insertRow(),q=0;7>q;q++)b=7*f+q+1,31<b||(z=h.insertCell(),z.innerText=RInteger.format(b,2),z.align="center",z.style.borderBottom="1 solid #EEEEEE",z.style.cursor="hand",5>q&&(z.style.borderRight="1 solid #EEEEEE"),this.attachEvent("onButtonEnter",z),this.attachEvent("onButtonLeave",z),this.attachEvent("onDayClick",
z),this.days.push(z))}
function FUiDateTimeEditor_onBuildButton(){this.base.FUiDropEditor.onBuildButton.call(this);var b=RBuilder.appendTable(this.hButtonPanel);b.width="100%";b.height=20;b.style.filter="progid:DXImageTransform.Microsoft.Gradient(startColorStr='#EEEEEE', endColorStr='#FFFFFF', gradientType='0')";var b=b.insertRow(),d=b.insertCell();d.style.padding="0 6";d=this.hNow=RBuilder.append(d,"SPAN");d.style.cursor="hand";this.attachEvent("onNowClick",d);d.innerText=RContext.get("FDate:Now");d=b.insertCell();d.style.padding=
"0 6";d.align="right";d=this.hNow=RBuilder.append(d,"SPAN");d.style.cursor="hand";this.attachEvent("onConfirmClick",d);d.innerText=RContext.get("FDate:Confirm")}function FUiDateTimeEditor_construct(){this.base.FUiDropEditor.construct.call(this);this.date=new TDate;this.years=new TList;this.months=new TList;this.days=new TList}
function FUiDateTimeEditor_buildTitle(b,d){var f=RBuilder.appendTable(this.hDropPanel);f.width="100%";f.style.borderBottom="1 solid #999999";f.style.filter="progid:DXImageTransform.Microsoft.Gradient(startColorStr='#FFFFFF', endColorStr='#E5FAFE', gradientType='0')";f.style.backgroundColor="#F8F8F8";f.style.padding="2 6";var h=f.insertRow(),q=h.insertCell();q.width=60;q=this["h"+b]=RBuilder.appendEdit(q);q.style.width="100%";q.style.textAlign="right";q.style.border="1 solid #CCCCCC";q.maxLength=d;
q=h.insertCell();q.innerText=RContext.get("FDate:"+b);return f}function FUiDateTimeEditor_get(){return RDate.formatDate(this.date)}function FUiDateTimeEditor_set(b){RDate.autoParse(this.date,b);this.restore()}function FUiDateTimeEditor_setYearVisible(b){this.hPanelYear.style.display=b?"block":"none";this.hTitleYear.style.display=b?"block":"none"}function FUiDateTimeEditor_setMonthVisible(b){this.hPanelMonth.style.display=b?"block":"none";this.hTitleMonth.style.display=b?"block":"none"}
function FUiDateTimeEditor_setDayVisible(b){this.hPanelDay.style.display=b?"block":"none";this.hTitleDay.style.display=b?"block":"none"}function FUiDateTimeEditor_show(b){this.base.FUiDropEditor.show.call(this,b);b=this.hPanel;var d=this.source.getEditRange();b.style.pixelLeft=d.x;b.style.pixelTop=d.y+d.height;b.style.pixelWidth=220;this.base.MShadow.show.call(this)}
function FUiDateTimeEditor_resetDay(){for(var b=this.date.monthDays(),d=0;d<this.days.count;d++)this.days.get(d).innerText=d>=b?".":RInteger.format(d+1,2)}function FUiDateTimeEditor_selectCell(b,d){for(var f=b.count,h=0;h<f;h++){var q=b.get(h);q.innerText==d?(q.style.color="#FFFFFF",q.style.backgroundColor="#9999EE",q.isSelect=!0):(q.style.color="#000000",q.style.backgroundColor="#FFFFFF",q.isSelect=!1)}}
function FUiDateTimeEditor_restore(){this.hYear.value=this.date.year;this.hMonth.value=this.date.month;this.hDay.value=this.date.day;this.selectCell(this.years,this.date.year);this.selectCell(this.months,this.date.month);this.selectCell(this.days,this.date.day)}function FUiDateTimeEditor_dispose(){this.base.FUiDropEditor.dispose.call(this);this.hPanel=null}
function FUiDropEditor(b){b=RClass.inherits(this,b,FUiEditor,MUiShadow);b._stylePanel=RClass.register(b,new AStyle("_stylePanel"));b._styleDropForm=RClass.register(b,new AStyle("_styleDropForm"));b._styleDropPanel=RClass.register(b,new AStyle("_styleDropPanel"));b._styleButtonPanel=RClass.register(b,new AStyle("_styleButtonPanel"));b._minWidth=160;b._minHeight=300;b._hDropForm=null;b._hDropPanel=null;b._hButtonPanel=null;b.onBuildDrop=RMethod.virtual(b,"onBuildDrop");b.onBuildButton=RMethod.empty;
b.onBuild=FUiDropEditor_onBuild;b.onDropMouseDown=RClass.register(b,new AEventMouseDown("onDropMouseDown"));b.onDropMouseUp=RClass.register(b,new AEventMouseUp("onDropMouseUp"));b.panel=FUiDropEditor_panel;b.setVisible=FUiDropEditor_setVisible;b.dispose=FUiDropEditor_dispose;return b}
function FUiDropEditor_onBuild(b){this.__base.FUiEditor.onBuild.call(this,b);b=this._hPanel;b.className=this.styleName("Panel");b=this._hDropForm=RBuilder.appendTable(b,this.styleName("DropForm"));this._hDropPanel=RBuilder.appendTableRowCell(b,this.styleName("DropPanel"));this._hButtonPanel=RBuilder.appendTableRowCell(b,this.styleName("ButtonPanel"));this.onBuildDrop();this.onBuildButton()}
function FUiDropEditor_panel(b){return b==EPanel.Shadow?this.hPanel:this.__base.FUiEditor.panel.call(this,b)}function FUiDropEditor_setVisible(b){var d=this._hPanel,f=this._hPanel.ownerDocument;b?f.body.appendChild(d):f.body.removeChild(d);this.__base.FUiEditor.setVisible.call(this,b)}function FUiDropEditor_dispose(){this._hButtonPanel=RHtml.free(this._hButtonPanel);this._hDropPanel=RHtml.free(this._hDropPanel);this._hDropForm=RHtml.free(this._hDropForm);this.__base.FControl.dispose.call(this)}
function FUiEdit(b){b=RClass.inherits(this,b,FUiEditControl,MPropertyEdit,MListenerDataChanged);b._inputSize=RClass.register(b,new APtySize2("_inputSize"));b._unit=RClass.register(b,new APtyString("_unit"));b._styleValuePanel=RClass.register(b,new AStyle("_styleValuePanel"));b._styleInputPanel=RClass.register(b,new AStyle("_styleInputPanel"));b._styleInput=RClass.register(b,new AStyle("_styleInput"));b._hValueForm=null;b._hValueLine=null;b._hInputPanel=null;b._hInput=null;b.onBuildEditValue=FUiEdit_onBuildEditValue;
b.onInputEdit=RClass.register(b,new AEventInputChanged("onInputEdit"),FUiEdit_onInputEdit);b.construct=FUiEdit_construct;b.formatText=FUiEdit_formatText;b.formatValue=FUiEdit_formatValue;b.text=FUiEdit_text;b.setText=FUiEdit_setText;b.setEditAble=FUiEdit_setEditAble;b.refreshValue=FUiEdit_refreshValue;return b}
function FUiEdit_onBuildEditValue(b){var d=this._hValuePanel;d.className=this.styleName("ValuePanel");d=this._hValueForm=RBuilder.appendTable(d);d.width="100%";d=this._hValueLine=RBuilder.appendTableRow(d);this._hChangePanel=RBuilder.appendTableCell(d);this.onBuildEditChange(b);b=this._hInputPanel=RBuilder.appendTableCell(d);d=this._hInput=RBuilder.appendEdit(b,this.styleName("Input"));this.attachEvent("onInputEdit",d,this.onInputEdit);RHtml.setSize(b,this._inputSize);this._editLength&&(d.maxLength=
this._editLength)}function FUiEdit_onInputEdit(b){this.refreshValue()}function FUiEdit_construct(){this.__base.FUiEditControl.construct.call(this);this._inputSize=new SSize2(120,0)}function FUiEdit_formatText(b){return this._dataDisplay=b=RString.nvl(b)}function FUiEdit_formatValue(b){return b}function FUiEdit_text(){return this._hInput.value}function FUiEdit_setText(b){this._hInput.value=b}
function FUiEdit_setEditAble(b){this.__base.FUiEditControl.setEditAble.call(this,b);this._hInput.readOnly=!b}function FUiEdit_refreshValue(){this.processDataChangedListener(this)}
function FUiEditControl(b){b=RClass.inherits(this,b,FUiControl,MUiEditValue,MUiEditChange,MUiEditDrop);b._labelModeCd=RClass.register(b,new APtyString("_labelModeCd"),EUiLabelMode.All);b._labelPositionCd=RClass.register(b,new APtyString("_labelPositionCd"),EUiLabelPosition.Left);b._labelSize=RClass.register(b,new APtySize2("_labelSize"));b._labelAlignCd=RClass.register(b,new APtyString("_labelAlignCd"),EUiAlign.Left);b._labelColor=RClass.register(b,new APtyString("_labelColor"));b._editSize=RClass.register(b,
new APtySize2("_editSize"));b._editColor=RClass.register(b,new APtyString("_editColor"));b._styleLabelPanel=RClass.register(b,new AStyle("_styleLabelPanel"));b._styleEditPanel=RClass.register(b,new AStyle("_styleEditPanel"));b._progressing=!1;b._hLabelPanel=null;b._hLabelForm=null;b._hIconPanel=null;b._hIcon=null;b._hTextPanel=null;b._hText=null;b._hEditPanel=null;b._hEditForm=null;b._hValuePanel=null;b.onBuildLabelIcon=FUiEditControl_onBuildLabelIcon;b.onBuildLabelText=FUiEditControl_onBuildLabelText;
b.onBuildLabel=FUiEditControl_onBuildLabel;b.onBuildEditValue=RMethod.virtual(b,"onBuildEditValue");b.onBuildEdit=FUiEditControl_onBuildEdit;b.onBuildPanel=FUiEditControl_onBuildPanel;b.onBuild=FUiEditControl_onBuild;b.oeMode=FUiEditControl_oeMode;b.oeProgress=FUiEditControl_oeProgress;b.construct=FUiEditControl_construct;b.panel=FUiEditControl_panel;b.label=FUiEditControl_label;b.setLabel=FUiEditControl_setLabel;b.getValueRectangle=FUiEditControl_getValueRectangle;b.dispose=FUiEditControl_dispose;
return b}function FUiEditControl_onBuildLabelIcon(b){this._hIcon=this._labelIcon?RBuilder.appendIcon(this._hIconPanel,null,this._labelIcon):RBuilder.appendIcon(this._hIconPanel,null,"n",16,16)}function FUiEditControl_onBuildLabelText(b){this._hText=RBuilder.appendSpan(this._hTextPanel,null,this._label)}
function FUiEditControl_onBuildLabel(b){var d=this._hLabelForm=RBuilder.appendTable(this._hLabelPanel,this.styleName("LabelPanel")),f=RBuilder.appendTableRow(d);(this._hIconPanel=RBuilder.appendTableCell(f)).width="20px";this.onBuildLabelIcon(b);f=this._hTextPanel=RBuilder.appendTableCell(f);f.noWrap=!0;this.onBuildLabelText(b);RHtml.setSize(d,this._labelSize);this._labelAlignCd&&(f.align=this._labelAlignCd,f.style.paddingRight=4);this._labelColor&&(this._hLabel.style.color=this._labelColor)}
function FUiEditControl_onBuildEdit(b){var d=this._hEditForm=RBuilder.appendTable(this._hEditPanel,this.styleName("EditPanel")),f=this._hEditLine=RBuilder.appendTableRow(d);this._hValuePanel=RBuilder.appendTableCell(f);this.onBuildEditValue(b);RHtml.setSize(d,this._editSize)}function FUiEditControl_onBuildPanel(b){this._hPanel=RBuilder.createTable(b,this.styleName("Panel"))}
function FUiEditControl_onBuild(b){this.__base.FUiControl.onBuild.call(this,b);var d=this._hPanel,f=null,h=null,q=this._labelModeCd;q==EUiLabelMode.Label?f=RBuilder.appendTableCell(RBuilder.appendTableRow(d)):q==EUiLabelMode.Hidden?h=RBuilder.appendTableCell(RBuilder.appendTableRow(d)):(f=this._labelPositionCd,f==EUiLabelPosition.Top?(f=RBuilder.appendTableRowCell(d),h=RBuilder.appendTableRowCell(d)):f==EUiLabelPosition.Right?(d=RBuilder.appendTableRow(d),h=RBuilder.appendTableCell(d),f=RBuilder.appendTableCell(d)):
f==EUiLabelPosition.Bottom?(h=RBuilder.appendTableRowCell(d),f=RBuilder.appendTableRowCell(d)):(d=RBuilder.appendTableRow(d),f=RBuilder.appendTableCell(d),h=RBuilder.appendTableCell(d)));this._hLabelPanel=f;this._hEditPanel=h;f&&(this.onBuildLabel(b),f.appendChild(this._hLabelForm),this.setLabel(this._label));if(h)this.onBuildEdit(b)}
function FUiEditControl_oeMode(b){this.__base.FUiControl.oeMode.call(this,b);this.__base.MDisplay.oeMode.call(this,b);this._editable=this.canEdit(b.mode);this._validable=this.canValid(b.mode);this._progressing||this.setEditable(this._editable);return EEventStatus.Stop}
function FUiEditControl_oeProgress(b){if(this._progressing&&b.enable)return EEventStatus.Stop;(this._progressing=b.enable)?(b=this._editable,this.setEditable(!1),this._editable=b):this.setEditable(this._editable);return EEventStatus.Stop}function FUiEditControl_construct(){this.__base.FUiControl.construct.call(this);this.__base.MUiEditChange.construct.call(this);this.__base.MUiEditDrop.construct.call(this);this._labelSize=new SSize2(100,20);this._editSize=new SSize2(200,20)}
function FUiEditControl_panel(b){return EPanel.Edit==b||EPanel.Focus==b?this.hEdit:this.__base.FUiControl.panel.call(this,b)}function FUiEditControl_label(b){return this._label}function FUiEditControl_setLabel(b){this._label=b;this._hText&&(this._hText.innerHTML=RString.nvl(b))}function FUiEditControl_getValueRectangle(b){b||(b=new SRectangle);var d=this._hValuePanel,f=RHtml.clientPosition(d);b.position.assign(f);b.setSize(d.offsetWidth,d.offsetHeight);return b}
function FUiEditControl_dispose(){this._dataTypeCd=this._labelAlignCd=this._labelPositionCd=this._labelModeCd=null;this._labelSize=RObject.dispose(this._labelSize);this._editSize=RObject.dispose(this._editSize);this._hLabelPanel=RHtml.free(this._hLabelPanel);this._hLabelForm=RHtml.free(this._hLabelForm);this._hIconPanel=RHtml.free(this._hIconPanel);this._hIcon=RHtml.free(this._hIcon);this._hTextPanel=RHtml.free(this._hTextPanel);this._hText=RHtml.free(this._hText);this._hEditPanel=RHtml.free(this._hEditPanel);
this._hEditForm=RHtml.free(this._hEditForm);this._hValuePanel=RHtml.free(this._hValuePanel);this._hDropPanel=RHtml.free(this._hDropPanel);this.__base.MUiEditDrop.dispose.call(this);this.__base.MUiEditChange.dispose.call(this);this.__base.FUiControl.dispose.call(this)}
function FUiEditor(b){b=RClass.inherits(this,b,FUiControl,MUiFocus);b._visible=!1;b._statusVisible=!1;b._styleEdit=RClass.register(b,new AStyle("_styleEdit"));b._statusEditing=!1;b._source=null;b._hEdit=null;b.lsnEditBegin=null;b.lsnEditCancel=null;b.lsnEditEnd=null;b.onEditKeyDown=RClass.register(b,new AEventKeyDown("onEditKeyDown"));b.onEditKeyPress=RClass.register(b,new AEventKeyPress("onEditKeyPress"));b.onEditKeyUp=RClass.register(b,new AEventKeyUp("onEditKeyUp"));b.onEditChange=RClass.register(b,
new AEventChange("onEditChange"));b.onEditBegin=FUiEditor_onEditBegin;b.onEditChanged=FUiEditor_onEditChanged;b.onEditEnd=FUiEditor_onEditEnd;b.onBuildPanel=FUiEditor_onBuildPanel;b.onBuild=FUiEditor_onBuild;b.get=RMethod.virtual(b,"get");b.set=RMethod.virtual(b,"set");b.doBlur=FUiEditor_doBlur;b.panel=FUiEditor_panel;b.linkControl=FUiEditor_linkControl;b.editBegin=FUiEditor_editBegin;b.editCancel=FUiEditor_editCancel;b.editEnd=FUiEditor_editEnd;b.reset=FUiEditor_reset;b.setVisible=FUiEditor_setVisible;
b.dispose=FUiEditor_dispose;return b}function FUiEditor_onEditBegin(){this.editBegin()}function FUiEditor_onEditChanged(){RLogger.debug(this,"Edit changed");(this.storage=RObject.nvlObj(this.storage)).value==this.value()?this.changed&&(this.changed=!1):this.changed||(this.changed=!0)}
function FUiEditor_onEditEnd(){var b=this._source;RLogger.debug(this,"Editor end. (control={1})",RClass.dump(b));this.hide();this.lsnEditEnd&&this.lsnEditEnd.process(this);this._source=b._editor=null;this._statusEditing=!1}function FUiEditor_onBuildPanel(b){(this._hPanel=RBuilder.createSpan(b)).__linker=this}function FUiEditor_onBuild(b){this.__base.FUiControl.onBuild.call(this,b);this._hPanel.style.zIndex=EUiLayer.Editor}function FUiEditor_get(b){}function FUiEditor_set(b,d){}
function FUiEditor_doBlur(){var b=this._source;b&&(this.editCancel(),RClass.isClass(b,MUiFocus)&&b.doBlur())}function FUiEditor_panel(b){return b==EPanel.Edit||b==EPanel.Focus?this._hEdit:this.__base.FUiControl.panel.call(this,b)}function FUiEditor_linkControl(b){this._source=b}function FUiEditor_editBegin(){var b=this._source;RLogger.debug(this,"Editor begin. (control={1})",RClass.dump(b));this.lsnEditCancel&&this.lsnEditCancel.process(this);b._editor=this;this._statusEditing=!0}
function FUiEditor_editCancel(){var b=this._source;RLogger.debug(this,"Editor cancel. (control={1})",RClass.dump(b));this.hide();this.lsnEditCancel&&this.lsnEditCancel.process(this);this._source=b._editor=null;this._statusEditing=!1}function FUiEditor_editEnd(){this.onEditEnd()}function FUiEditor_reset(){this.lsnEditEnd=this.lsnEditCancel=this.lsnEditBegin=null}function FUiEditor_setVisible(b){this.__base.FUiControl.setVisible.call(this,b);b&&(this.editBegin(),this.focus())}
function FUiEditor_dispose(){this.__base.FUiControl.dispose.call(this);this._hEdit=null}
function FUiFile(b){b=RClass.inherits(this,b,FUiEditControl,MListenerDataChanged);b._inputSize=RClass.register(b,new APtySize2("_inputSize"));b._unit=RClass.register(b,new APtyString("_unit"));b._styleValuePanel=RClass.register(b,new AStyle("_styleValuePanel"));b._styleInputPanel=RClass.register(b,new AStyle("_styleInputPanel"));b._styleInput=RClass.register(b,new AStyle("_styleInput"));b._styleFile=RClass.register(b,new AStyle("_styleFile"));b._styleBrowser=RClass.register(b,new AStyle("_styleBrowser"));
b._hValueForm=null;b._hValueLine=null;b._hInputPanel=null;b._hInput=null;b.onBuildEditValue=FUiFile_onBuildEditValue;b.onFileChange=RClass.register(b,new AEventChange("onFileChange"),FUiFile_onFileChange);b.construct=FUiFile_construct;b.formatDisplay=FUiFile_formatDisplay;b.formatValue=FUiFile_formatValue;b.get=FUiFile_get;b.set=FUiFile_set;b.refreshValue=FUiFile_refreshValue;return b}
function FUiFile_onBuildEditValue(b){var d=this._hValuePanel;d.className=this.styleName("ValuePanel");d=this._hValueForm=RBuilder.appendTable(d);d.width="100%";d=this._hValueLine=RBuilder.appendTableRow(d);this._hChangePanel=RBuilder.appendTableCell(d);this.onBuildEditChange(b);b=this._hInputPanel=RBuilder.appendTableCell(d,this.styleName("InputPanel"));var d=this._hInputEdit=RBuilder.appendEdit(b,this.styleName("Input")),f=this._hInput=RBuilder.appendFile(b,this.styleName("File"));this.attachEvent("onFileChange",
f);var h=this._hBrowserPanel=RBuilder.appendTableCell(this._hEditLine);h.style.paddingLeft="4px";(this._hBrowser=RBuilder.appendButton(h,this.styleName("Browser"))).value="\u6d4f\u89c8...";RHtml.setSize(b,this._inputSize);RHtml.setSize(f,this._inputSize);this._editLength&&(d.maxLength=this._editLength)}function FUiFile_onFileChange(b){var d=this._hInput;d.files&&d.files.length&&(d=d.files[0],this._hInputEdit.value=d.name+" ("+d.size+"byte)",this.processDataChangedListener(b))}
function FUiFile_construct(){this.__base.FUiEditControl.construct.call(this);this._inputSize=new SSize2(120,0)}function FUiFile_formatDisplay(b){return this._dataDisplay=b=RString.nvl(b)}function FUiFile_formatValue(b){return b}function FUiFile_get(){var b=this.__base.FUiEditControl.get.call(this);return b=this._hInput.value}function FUiFile_set(b){this.__base.FUiEditControl.set.call(this,b);this._hInput.value=RString.nvl(b)}function FUiFile_refreshValue(){this.processDataChangedListener(this)}
function FUiForm(b){b=RClass.inherits(this,b,FUiLayout,MUiDescribeFrame);b.onMouseDown=FUiForm_onMouseDown;b.construct=FUiForm_construct;b._dataStatusCd=ERowStatus.Update;b._dataComponents=null;b.lsnsLoaded=null;b.lsnsClick=null;b.onLoadDataset=FUiForm_onLoadDataset;b.onLoadDatasetEnd=FUiForm_onLoadDatasetEnd;b.isDataChanged=FUiForm_isDataChanged;b.getFormLink=FUiForm_getFormLink;b.allDataComponents=FUiForm_allDataComponents;b.get=FUiForm_get;b.reget=FUiForm_reget;b.set=FUiForm_set;b.getDataCodes=
FUiForm_getDataCodes;b.getCurrentRow=FUiForm_getCurrentRow;b.getSelectedRows=FUiForm_getSelectedRows;b.getCurrentRows=FUiForm_getCurrentRows;b.getChangedRows=FUiForm_getChangedRows;b.getRows=FUiForm_getRows;b.clearValue=FUiForm_clearValue;b.resetValue=FUiForm_resetValue;b.loadValue=FUiForm_loadValue;b.saveValue=FUiForm_saveValue;b.recordValue=FUiForm_recordValue;b.toAttributes=FUiForm_toAttributes;b.focus=FUiForm_focus;b.dsUpdate=FUiForm_dsUpdate;b.doPrepare=FUiForm_doPrepare;b.doUpdate=FUiForm_doUpdate;
b.doDelete=FUiForm_doDelete;b.dispose=FUiForm_dispose;return b}function FUiForm_onMouseDown(b){}function FUiForm_construct(){this.__base.FUiLayout.construct.call(this)}function FUiForm_onLoadDataset(b){this.doUpdate(this.dsViewer.current())}function FUiForm_onLoadDatasetEnd(){this.topControl().topResize();this.psProgress(!1)}function FUiForm_isDataChanged(){var b=this.allDataComponents();if(!b.isEmpty())for(var d=b.count,f=0;f<d;f++)if(b.value(f).isDataChanged())return!0}
function FUiForm_getFormLink(b){if(EFormLink.Form==b)return this.name;if(EFormLink.Table==b)return this.formName;RMessage.fatal(this,null,"Form link is invalid. (type={0})",b)}function FUiForm_allDataComponents(b,d){b||(b=this);d||(d=this._dataComponents);var f=b.components;if(f)for(var h=f.count,q=0;q<h;q++){var z=f.value(q);RClass.isClass(z,MDataset)||(RClass.isClass(z,MValue)&&d.set(z.dataName,z),this.allDataComponents(z,d))}return d}
function FUiForm_get(b){var d=this.allDataComponents();if(d&&(b=d.get(b)))return b.get()}function FUiForm_reget(b){var d=this.allDataComponents();if(d&&(b=d.get(b)))return b.reget()}function FUiForm_set(b,d){var f=this.allDataComponents();f&&(f=f.get(b))&&f.set(d)}function FUiForm_getDataCodes(){var b=this._codeEvent;b.values=new TAttributes;this.process(b);return b.values}function FUiForm_getCurrentRow(){return this.saveValue()}
function FUiForm_getSelectedRows(){var b=new TList;b.push(this.saveValue());return b}function FUiForm_getCurrentRows(){var b=new TList,d=new TRow;this.toDeepAttributes(d);this.saveValue(d);b.push(d);return b}function FUiForm_getChangedRows(){var b=new TList;if(this.isDataChanged()){var d=new TRow;this.toDeepAttributes(d);this.saveValue(d);b.push(d)}return b}function FUiForm_getRows(){var b=new TList;b.push(this.saveValue());return b}function FUiForm_clearValue(){this.process(this._clearEvent)}
function FUiForm_resetValue(){this.process(this._resetEvent)}function FUiForm_loadValue(b,d){if(b){var f=this._loadEvent;f.viewer=this.dsViewer;f.store=d;f.values=b;this.process(f)}}function FUiForm_saveValue(b,d){b||(b=new TRow);var f=this._saveEvent;f.viewer=this.dsViewer;f.store=d;f.values=b;this.process(f);b.set("_status",this._dataStatusCd);return b}function FUiForm_recordValue(){this.process(this._recordEvent)}function FUiForm_toAttributes(b,d){return this.saveValue(b,d)}
function FUiForm_focus(){this.__base.MUiFocus.focus.call(this);this.focusControl();RConsole.find(FFocusConsole).focusClass(MDataset,this)}
function FUiForm_dsUpdate(b,d){if(b){this.psProgress(!0);this.psMode(EMode.Update);var f=new TDatasetFetchArg(this.name,this.formId,this.dsPageSize,0);f.form=this;f.reset=!0;this.dsSearchs.clear();b&&this.dsSearchs.push(new TSearchItem("OUID",b));d&&this.dsSearchs.push(new TSearchItem("OVER",d));f.searchs=this.dsSearchs;f.values.append(this.dsValues);f.callback=new TInvoke(this,this.onDsUpdate);this.onDsUpdateCheck(f)&&RConsole.find(FDatasetConsole).fetch(f)}else return this.__base.MDataset.dsUpdate.call(this,
b,d)}function FUiForm_setEditable(b){var d=this.allDataComponents();if(d)for(var f=d.count,h=0;h<f;h++)d.value(h).setEditable(b)}function FUiForm_doPrepare(b){this._dataStatusCd=ERowStatus.Insert;this.resetValue();this.loadValue(b);this.recordValue();this.dsLoaded()}function FUiForm_doUpdate(b){this._dataStatusCd=ERowStatus.Update;this.clearValue();this.loadValue(b);this.recordValue();this.dsLoaded()}
function FUiForm_doDelete(b){this._dataStatusCd=ERowStatus.Delete;this.clearValue();this.loadValue(b);this.recordValue();this.dsLoaded()}function FUiForm_dispose(){this.__base.FUiLayout.dispose.call(this);RMemory.freeHtml(this.hEdit);RMemory.freeHtml(this.hDrop);this.hDrop=this.hEdit=null}
function FUiForm_allNameComponents(b,d,f){var h=this._nameComponents;if(!b&&h)return h;h||(h=this._nameComponents=new TMap);b&&h.clear();d||(d=this);f||(f=h);if(b=d.components){d=b.count;for(var q=0;q<d;q++){var z=b.value(q);RClass.isClass(z,MDataset)||(RClass.isClass(z,MValue)&&f.set(z.name,z),this.allNameComponents(!1,z,f))}}return h}function FUiForm_onLoaded(){var b=this.form,d=this.document;b&&d&&(RControl.build(b,d.root()),b.isLoading=!1,b.lsnsLoaded.process(b))}
function FUiForm_onDsFetchEnd(){var b=this.dsCurrent();b&&this.loadValue(b)}function FUiForm_onDsUpdateBegin(){var b=this.dsCurrent();b&&this.saveValue(b)}function FUiForm_onDsUpdateEnd(){var b=this.dsCurrent();b&&this.loadValue(b)}
function FUiForm_connect(b,d,f,h){var q=new TXmlDocument,z=q.root();z.set("type",d);z.set("name",this.name);z.set("action",f);z.create("Attributes").value=h;d=new TEvent(this,EXmlEvent.Send);d.url=b;d.document=q;d.form=this;d.onLoad=this.onLoaded;RConsole.find(FXmlConsole).process(d)}function FUiForm_loadDocument(b){b&&(b=b.root(),b.isName("Table")&&(this.loadConfig(b),this.buildColumns(b),this.buildRows(b)))}
function FUiForm_testStatus(b){var d=this.__base.MDataset.testStatus.call(this,b);return EDataAction.Fetch==b||EDataAction.Fetch==b||EDataAction.Search==b?!0:EDataAction.First==b||EDataAction.Prior==b||EDataAction.Next==b||EDataAction.Last==b?!1:EDataAction.Action==b?!0:d}function FUiForm_hasAction(){for(var b=this.components,d=b.count,f=0;f<d;f++){var h=b.value(f);if(RClass.isClass(h,FDataAction))return!0}return!1}function FUiFrame(b){return b=RClass.inherits(this,b,FUiLayout)}
function FUiIconPicker(b){return b=RClass.inherits(this,b,FUiEdit)}function FUiIconPicker_onEditKeyDown(b){this.base.FUiEditControl.onEditKeyDown.call(this,b);this.hEditIcon.src=RRes.iconPath(RString.nvl(this.text(),this.styleIcon("Default")))}function FUiIconPicker_onEditKeyPress(b){this.base.FUiEditControl.onEditKeyPress.call(this,b);this.editCase&&RKey.fixCase(b,this.editCase)}
function FUiIconPicker_onBuildEdit(b){var d=b.hPanel;b.hIcon.width=1;d.align="center";d.noWrap="true";b=RString.nvl(this.iconDefault,this.styleIcon("Default"));this.hEditIcon=RBuilder.appendIcon(d,b);d=this.hEdit=RBuilder.appendEdit(d,this.style("Edit"));d.autocomplete=RBool.isTrue(this.editComplete)?"on":"off";this.editLength&&(d.maxLength=this.editLength)}
function FUiIconPicker_setText(b){this.base.FUiEditControl.setText.call(this,b);this.hEditIcon.src=RResource.iconPath(RString.nvl(this.text(),this.styleIcon("Default")))}function FUiIconPicker_dispose(){this.base.FUiEditControl.dispose.call(this);this.hEdit=this.hEditIcon=null}function FUiLabel(b){b=RClass.inherits(this,b,FUiControl);b.onBuild=FUiLabel_onBuild;b.get=FUiLabel_get;b.set=FUiLabel_set;return b}function FUiLabel_onBuild(b){this.__base.FUiControl.onBuild.call(this,b)}
function FUiLabel_get(){return this._hPanel.innerHTML}function FUiLabel_set(b){this._hPanel.innerHTML=b}
function FUiLayout(b){b=RClass.inherits(this,b,FUiContainer);b._styleForm=RClass.register(b,new AStyle("_styleForm","Form"));b._lastSplit=null;b._hPanelForm=null;b._hContainer=null;b._hPanelTable=null;b._hPanelLine=null;b.onBuildPanel=FUiLayout_onBuildPanel;b.onDesignBegin=FUiLayout_onDesignBegin;b.onDesignEnd=FUiLayout_onDesignEnd;b.oeDesign=FUiLayout_oeDesign;b.oeResize=FUiLayout_oeResize;b.oeRefresh=FUiLayout_oeRefresh;b.insertPosition=FUiLayout_insertPosition;b.moveChild=FUiLayout_moveChild;b.innerAppendLine=
FUiLayout_innerAppendLine;b.appendChild=FUiLayout_appendChild;b.resize=FUiLayout_resize;b.dispose=FUiLayout_dispose;return b}function FUiLayout_onBuildPanel(b){b=this._hPanel=this._hPanelForm=RBuilder.createTable(b,this.styleName("Form"),null,0,1);this._layoutCd==EUiLayout.Design&&(b=RBuilder.appendTableRow(b),this._hContainer=RBuilder.appendTableCell(b))}function FUiLayout_onDesignBegin(){this.__base.MDesign.onDesignBegin.call(this)}
function FUiLayout_onDesignEnd(){this.__base.MDesign.onDesignEnd.call(this)}function FUiLayout_oeDesign(b){this.__base.FUiContainer.oeDesign.call(this,b);if(b.isAfter())switch(b.layoutCd){case EDesign.Border:event.flag?(this._hPanel.border=1,this._hPanel.style.border="1 solid red"):(this._hPanel.border=0,this._hPanel.style.border=null)}}function FUiLayout_oeResize(b){this.__base.FUiContainer.oeResize.call(this,b);b.isAfter()&&this.resize()}
function FUiLayout_oeRefresh(b){this.__base.FUiContainer.oeDesign.call(this,b);b.isAfter()&&this.resize()}function FUiLayout_insertPosition(b,d,f,h){h=this._components;var q=this.controls;h.removeValue(b);q.removeValue(b);if(d){var z=h.indexOfValue(d);h.insert(z+f,b.name,b);z=q.indexOfValue(d);q.insert(z+f,b.name,b)}else h.set(b.name,b),q.set(b.name,b)}
function FUiLayout_moveChild(b,d,f,h){if(b&&d&&f&&b!=d){var q=!1,z=RClass.isClass(b,MUiHorizontal),A=RHtml.parent(b._hPanel,"TD"),B=RHtml.parent(b._hPanel,"TABLE"),C=RClass.isClass(d,MUiHorizontal),D=RHtml.parent(d._hPanel,"TD"),E=RHtml.parent(D,"TABLE");switch(f){case EPosition.Before:z=E.rows[0];for(f=0;f<z.cells.length;f++)if(z.cells[f]==D){z=RBuilder.appendTableCell(z,null,D.cellIndex);z.appendChild(b._hPanel);this.insertPosition(b,d,0,h);b.nowrap=!0;b._hPanelLine=E;q=!0;break}break;case EPosition.After:z=
E.rows[0];for(f=0;f<z.cells.length;f++)if(z.cells[f]==D){A=RHtml.parent(b._hPanel,"TD");z=RBuilder.appendTableCell(z,null,D.cellIndex+1);z.appendChild(b._hPanel);this.insertPosition(b,d,1,h);b.nowrap=!1;b._hPanelLine=E;q=d.nowrap=!0;break}break;case EPosition.LineBefore:if(C)z?this._hContainer.insertBefore(b._hPanel,d._hPanel):(D=this.innerAppendLine(),this._hContainer.insertBefore(D,d._hPanel),z=RBuilder.appendTableCell(this._hPanelLine),z.appendChild(b._hPanel),b._hPanelLine=D),this.insertPosition(b,
d,0,h);else for(D=this._hContainer.children.length,f=0;f<D;f++)if(this._hContainer.children[f]==E){z?this._hContainer.insertBefore(b._hPanel,E):(D=this.innerAppendLine(),this._hContainer.insertBefore(D,E),z=RBuilder.appendTableCell(this._hPanelLine),z.appendChild(b._hPanel),b._hPanelLine=D,q=!0);this.insertPosition(b,d,0,h);b.nowrap=!1;break}break;case EPosition.LineAfter:z?this._hContainer.appendChild(b._hPanel):(this.innerAppendLine(),z=RBuilder.appendTableCell(this._hPanelLine),z.appendChild(b._hPanel),
z.appendChild(b._hPanel),q=!0),this.insertPosition(b,null,0,h),d.nowrap=!1,b.nowrap=!1}q&&(A.removeNode(!0),0==B.rows[0].cells.length&&B.removeNode(!0))}}function FUiLayout_innerAppendLine(){var b=null;this._layoutCd==EUiLayout.Design?(b=this._hPanelTable=RBuilder.appendTable(this._hContainer),b.style.paddingBottom=4,this._hPanelLine=RBuilder.appendTableRow(b)):this._hPanelLine=this._hPanelTable=null;return b}
function FUiLayout_appendChild(b){if(this._layoutCd==EUiLayout.Design)if(this._hPanelLine||this.innerAppendLine(),RClass.isClass(b,MUiHorizontal))0==this._hPanelTable.rows[0].cells.length?this._hContainer.insertBefore(b._hPanel,this._hPanelTable):(this._hContainer.appendChild(b._hPanel),this.innerAppendLine());else{var d=RBuilder.appendTableCell(this._hPanelLine);RClass.isClass(b,FUiLayout)||(b._hPanelLine=this._hPanelTable);d.appendChild(b._hPanel);b._hLayoutCell=d;b.wrapCd()==EUiWrap.NextLine&&
this.controls.last()!=b&&this.innerAppendLine()}else if(b._hPanel.style.paddingTop=2,b._hPanel.style.paddingBottom=2,b.dockCd()==EUiDock.Fill)d=RBuilder.appendTableRowCell(this._hPanelForm),d.appendChild(b._hPanel);else if(b._sizeCd==EUiSize.Fill)d=RBuilder.appendTableRowCell(this._hPanelForm),d.appendChild(b._hPanel);else if(RSet.contains(b._sizeCd,EUiSize.Horizontal)||"100%"==b.width){RClass.isClass(b,FUiSplit)&&(this._lastSplit=b);var d=RBuilder.appendTableRow(this._hPanelForm),f=RBuilder.appendTableCell(d);
f.vAlign="top";f.appendChild(b._hPanel);b._hLayoutRow=d;this._hPanelLast=f;RSet.contains(b._sizeCd,EUiSize.Vertical)?b.height&&(f.height=b.height):f.height=1;this._hPanelLine=null}else this._hPanelLine||(d=RBuilder.appendTableRow(this._hPanelForm),d.height=1,this._lastSplit&&this._lastSplit.pushLine(d),f=RBuilder.appendTableCell(d),f.vAlign="top",d=this._hPanelTable=RBuilder.appendTable(f),this._hPanelLine=RBuilder.appendTableRow(d)),f=RBuilder.appendTableCell(this._hPanelLine),b._hLayoutRow=this._hPanelLine,
this._hPanelLast=f,f.appendChild(b._hPanel),b._hLayoutCell=f,b.wrapCd()==EUiWrap.NextLine&&(this._hPanelLine=null)}function FUiLayout_resize(){var b=this._components;if(b)for(var b=b.count(),d=0;d<b;d++){var f=this._components.at(d);if(RClass.isClass(f,FUiTable)||RClass.isClass(f,FUiPageControl))break}}function FUiLayout_dispose(){this._hContainer=this._hPanel=this._hPanelTable=this._hPanelCurrent=null;this.__base.FUiContainer.dispose.call(this)}
function FUiLayoutHorizontal(b){b=RClass.inherits(this,b,FUiContainer);b._stylePanel=RClass.register(b,new AStyle("_stylePanel"));b._hLine=null;b.onBuildPanel=FUiLayoutHorizontal_onBuildPanel;b.onBuild=FUiLayoutHorizontal_onBuild;b.appendChild=FUiLayoutHorizontal_appendChild;b.dispose=FUiLayoutHorizontal_dispose;return b}function FUiLayoutHorizontal_onBuildPanel(b){this._hPanel=RBuilder.createTable(b,this.styleName("Panel"))}
function FUiLayoutHorizontal_onBuild(b){this.__base.FUiContainer.onBuild.call(this,b);this._hLine=RBuilder.appendTableRow(this._hPanel)}function FUiLayoutHorizontal_appendChild(b){var d=RBuilder.appendTableCell(this._hLine);d.appendChild(b._hPanel);b=b.dockCd();"left"==b?d.align="left":"center"==b?d.align="center":"right"==b&&(d.align="right")}function FUiLayoutHorizontal_dispose(){this._hLine=RHtml.free(this._hLine);this.__base.FUiContainer.dispose.call(this)}
function FUiLayoutVertical(b){b=RClass.inherits(this,b,FUiContainer);b._stylePanel=RClass.register(b,new AStyle("_stylePanel"));b._hLine=null;b.onBuildPanel=FUiLayoutVertical_onBuildPanel;b.appendChild=FUiLayoutVertical_appendChild;b.dispose=FUiLayoutVertical_dispose;return b}function FUiLayoutVertical_onBuildPanel(b){this._hPanel=RBuilder.createTable(b,this.styleName("Panel"))}
function FUiLayoutVertical_appendChild(b){var d=RBuilder.appendTableRowCell(this._hPanel);d.appendChild(b._hPanel);if(b=b.size().height)d.style.height=b+"px"}function FUiLayoutVertical_dispose(){this.__base.FUiContainer.dispose.call(this)}
function FUiListBox(b){b=RClass.inherits(this,b,FUiContainer,MUiHorizontal,MListenerClick);b._sizeCd=EUiSize.Horizontal;b._stylePanel=RClass.register(b,new AStyle("_stylePanel"));b._hForm=null;b.onBuildPanel=FUiListBox_onBuildPanel;b.createItem=FUiListBox_createItem;b.appendChild=FUiListBox_appendChild;b.clickItem=FUiListBox_clickItem;b.clear=FUiListBox_clear;b.dispose=FUiListBox_dispose;return b}function FUiListBox_onBuildPanel(b){this._hPanel=RBuilder.createTable(b,this.styleName("Panel"))}
function FUiListBox_createItem(b,d){var f=RClass.create(FUiListItem);f.build(this._hPanel);f.setLabel(d);return f}function FUiListBox_appendChild(b){this._hPanel.appendChild(b._hPanel)}function FUiListBox_clickItem(b){var d=this._components;if(d)for(var f=d.count(),h=0;h<f;h++){var q=d.value(h);RClass.isClass(q,FUiListItem)&&q.setChecked(q==b)}this.processClickListener(this,b)}
function FUiListBox_clear(){var b=this._components;if(b){for(var d=b.count(),f=0;f<d;f++){var h=b.value(f);RClass.isClass(h,FUiListItem)&&this._hPanel.removeChild(h._hPanel);h.dispose()}b.clear();this._controls.clear()}}function FUiListBox_dispose(){this.__base.FContainer.dispose.call(this)}
function FUiListItem(b){b=RClass.inherits(this,b,FUiControl);b._styleNormal=RClass.register(b,new AStyle("_styleNormal"));b._styleHover=RClass.register(b,new AStyle("_styleHover"));b._styleSelect=RClass.register(b,new AStyle("_styleSelect"));b._styleIconPanel=RClass.register(b,new AStyle("_styleIconPanel"));b._styleIcon=RClass.register(b,new AStyle("_styleIcon"));b._styleLabel=RClass.register(b,new AStyle("_styleLabel"));b._checked=!1;b._hPanel=null;b._hIconPanel=null;b._hIcon=null;b._hLabel=null;
b.onBuildPanel=FUiListItem_onBuildPanel;b.onBuild=FUiListItem_onBuild;b.onEnter=FUiListItem_onEnter;b.onLeave=FUiListItem_onLeave;b.onClick=RClass.register(b,new AEventClick("onClick"),FUiListItem_onClick);b.label=FUiListItem_label;b.setLabel=FUiListItem_setLabel;b.setChecked=FUiListItem_setChecked;b.dispose=FUiListItem_dispose;return b}function FUiListItem_onBuildPanel(b){this._hPanel=RBuilder.createTableRow(b,this.styleName("Normal"))}
function FUiListItem_onBuild(b){this.__base.FUiControl.onBuild.call(this,b);b=this._hPanel;this._hIconPanel=RBuilder.appendTableCell(b,this.styleName("IconPanel"));this._icon&&(this._hIcon=RBuilder.appendIcon(this._hIconPanel,this.styleName("Icon"),this._icon));this._hLabel=RBuilder.appendTableCell(b,this.styleName("Label"));this._label&&this.setLabel(this._label);this.attachEvent("onClick",b)}
function FUiListItem_onEnter(){this.__base.FUiControl.onEnter.call(this);this._hPanel.className=RBoolean.parse(this._checked)?this.styleName("Select"):this.styleName("Hover")}function FUiListItem_onLeave(){this._hPanel.className=RBoolean.parse(this._checked)?this.styleName("Select"):this.styleName("Normal");this.__base.FUiControl.onLeave.call(this)}function FUiListItem_onClick(b){this._parent.clickItem(this)}function FUiListItem_label(b){return this._label}
function FUiListItem_setLabel(b){this._label=b;this._hLabel.innerHTML=RString.nvl(b)}function FUiListItem_setChecked(b){this._checked=b;this._hIcon?this._hIcon.style.display=b?"block":"none":this._hIconPanel.innerHTML=b?"O":"";this._hPanel.className=b?this.styleName("Select"):this.styleName("Normal")}
function FUiListItem_dispose(){this._hPanel=RHtml.free(this._hPanel);this._hIconPanel=RHtml.free(this._hIconPanel);this._hIcon=RHtml.free(this._hIcon);this._hLabel=RHtml.free(this._hLabel);this.__base.FUiControl.dispose.call(this)}
function FUiListView(b){b=RClass.inherits(this,b,FUiContainer,MUiHorizontal,MListenerClick,MListenerDoubleClick);b._sizeCd=EUiSize.Horizontal;b._stylePanel=RClass.register(b,new AStyle("_stylePanel"));b._focusItem=null;b._itemPool=null;b._hForm=null;b.onBuildPanel=FUiListView_onBuildPanel;b.onBuild=FUiListView_onBuild;b.onClick=RClass.register(b,new AEventClick("onClick"),FUiListView_onClick);b.construct=FUiListView_construct;b.focusItem=FUiListView_focusItem;b.createItem=FUiListView_createItem;b.appendChild=
FUiListView_appendChild;b.selectItem=FUiListView_selectItem;b.doClickItem=FUiListView_doClickItem;b.doDoubleClickItem=FUiListView_doDoubleClickItem;b.clear=FUiListView_clear;b.dispose=FUiListView_dispose;return b}function FUiListView_onBuildPanel(b){this._hPanel=RBuilder.createDiv(b,this.styleName("Panel"))}function FUiListView_onBuild(b){this.__base.FUiContainer.onBuild.call(this,b);this.attachEvent("onClick",this._hPanel)}
function FUiListView_onClick(b,d){if(b.hSender==this._hNodePanel){var f=this._focusNode;f&&(f.select(!1),this._focusNode=null)}}function FUiListView_construct(){this.__base.FUiContainer.construct.call(this);this._itemPool=RClass.create(FObjectPool)}function FUiListView_focusItem(){return this._focusItem}function FUiListView_createItem(b,d,f){d=this._itemPool.alloc();d||(d=b?RClass.create(b):RClass.create(FUiListViewItem),d.build(this._hPanel));return d}
function FUiListView_appendChild(b){this._hPanel.appendChild(b._hPanel)}function FUiListView_selectItem(b){var d=this._components;if(d)for(var f=d.count(),h=0;h<f;h++){var q=d.valueAt(h);RClass.isClass(q,FUiListViewItem)&&q.setChecked(q==b)}this._focusItem=b}function FUiListView_doClickItem(b){this.selectItem(b);var d=new SClickEvent(this);d.item=b;this.processClickListener(d);d.dispose()}
function FUiListView_doDoubleClickItem(b){this.selectItem(b);var d=new SClickEvent(this);d.item=b;this.processDoubleClickListener(d);d.dispose()}function FUiListView_clear(){var b=this._components;if(b){for(var d=b.count(),f=0;f<d;f++){var h=b.value(f);RClass.isClass(h,FUiListViewItem)?(this._hPanel.removeChild(h._hPanel),this._itemPool.free(h)):h.dispose()}b.clear();this._controls.clear()}}function FUiListView_dispose(){this.__base.FContainer.dispose.call(this)}
function FUiListViewItem(b){b=RClass.inherits(this,b,FUiControl);b._stylePanel=RClass.register(b,new AStyle("_stylePanel"));b._styleNormal=RClass.register(b,new AStyle("_styleNormal"));b._styleHover=RClass.register(b,new AStyle("_styleHover"));b._styleSelect=RClass.register(b,new AStyle("_styleSelect"));b._styleForm=RClass.register(b,new AStyle("_styleForm"));b._styleContent=RClass.register(b,new AStyle("_styleContent"));b._styleIconPanel=RClass.register(b,new AStyle("_styleIconPanel"));b._styleIcon=
RClass.register(b,new AStyle("_styleIcon"));b._styleLabel=RClass.register(b,new AStyle("_styleLabel"));b._checked=!1;b._contentHeight=28;b._hPanel=null;b._hBorder=null;b._hForm=null;b._hContentForm=null;b._hContentLine=null;b._hIconPanel=null;b._hIcon=null;b._hLabel=null;b.onBuildPanel=FUiListViewItem_onBuildPanel;b.onBuild=FUiListViewItem_onBuild;b.onEnter=FUiListViewItem_onEnter;b.onLeave=FUiListViewItem_onLeave;b.onClick=RClass.register(b,new AEventClick("onClick"),FUiListViewItem_onClick);b.onDoubleClick=
RClass.register(b,new AEventDoubleClick("onDoubleClick"),FUiListViewItem_onDoubleClick);b.label=FUiListViewItem_label;b.setLabel=FUiListViewItem_setLabel;b.setChecked=FUiListViewItem_setChecked;b.dispose=FUiListViewItem_dispose;return b}function FUiListViewItem_onBuildPanel(b){this._hPanel=RBuilder.createDiv(b,this.styleName("Panel"))}
function FUiListViewItem_onBuild(b){this.__base.FUiControl.onBuild.call(this,b);b=this._hPanel;var d=this._hBorder=RBuilder.appendDiv(b,this.styleName("Normal")),d=this._hForm=RBuilder.appendTable(d,this.styleName("Form"));this._hLine1=RBuilder.appendTableRowCell(d);d=this._hLine2=RBuilder.appendTableRowCell(d);d.height=this._contentHeight;d=this._hContentForm=RBuilder.appendTable(d,this.styleName("Content"));d=this._hContentLine=RBuilder.appendTableRow(d);this._hIconPanel=RBuilder.appendTableCell(d,
this.styleName("IconPanel"));this._hIcon=RBuilder.appendIcon(this._hIconPanel,this.styleName("Icon"),RString.nvl(this._icon,"tools.select"));RHtml.displaySet(this._hIcon,!1);this._hLabel=RBuilder.appendTableCell(d,this.styleName("Label"));this._label&&this.setLabel(this._label);this.attachEvent("onClick",b);this.attachEvent("onDoubleClick",b)}
function FUiListViewItem_onEnter(){this.__base.FUiControl.onEnter.call(this);this._hBorder.className=RBoolean.parse(this._checked)?this.styleName("Select"):this.styleName("Hover")}function FUiListViewItem_onLeave(){this._hBorder.className=RBoolean.parse(this._checked)?this.styleName("Select"):this.styleName("Normal");this.__base.FUiControl.onLeave.call(this)}function FUiListViewItem_onClick(b){this._checked?this._parent.doDoubleClickItem(this):this._parent.doClickItem(this)}
function FUiListViewItem_onDoubleClick(b){this._parent.doDoubleClickItem(this)}function FUiListViewItem_label(b){return this._label}function FUiListViewItem_setLabel(b){this._label=b;this._hLabel.innerHTML=RString.nvl(b)}function FUiListViewItem_setChecked(b){this._checked=b;this._hIcon?this._hIcon.style.display=b?"block":"none":this._hIconPanel.innerHTML=b?"O":"";this._hBorder.className=b?this.styleName("Select"):this.styleName("Normal")}
function FUiListViewItem_dispose(){this._hPanel=RHtml.free(this._hPanel);this._hBorder=RHtml.free(this._hBorder);this._hForm=RHtml.free(this._hForm);this._hLine1=RHtml.free(this._hLine1);this._hLine2=RHtml.free(this._hLine2);this._hContentForm=RHtml.free(this._hContentForm);this._hContentLine=RHtml.free(this._hContentLine);this._hIconPanel=RHtml.free(this._hIconPanel);this._hIcon=RHtml.free(this._hIcon);this._hLabel=RHtml.free(this._hLabel);this.__base.FUiControl.dispose.call(this)}
function FUiMemo(b){b=RClass.inherits(this,b,FUiEditControl,MPropertyEdit,MListenerDataChanged);b._inputSize=RClass.register(b,new APtySize2("_inputSize"));b._styleValuePanel=RClass.register(b,new AStyle("_styleValuePanel"));b._styleInputPanel=RClass.register(b,new AStyle("_styleInputPanel"));b._styleInput=RClass.register(b,new AStyle("_styleInput"));b._hValueForm=null;b._hValueLine=null;b._hInputPanel=null;b._hInput=null;b.onBuildEditValue=FUiMemo_onBuildEditValue;b.onInputEdit=RClass.register(b,
new AEventInputChanged("onInputEdit"),FUiMemo_onInputEdit);b.construct=FUiMemo_construct;b.formatDisplay=FUiMemo_formatDisplay;b.formatValue=FUiMemo_formatValue;b.get=FUiMemo_get;b.set=FUiMemo_set;b.refreshValue=FUiMemo_refreshValue;return b}
function FUiMemo_onBuildEditValue(b){var d=this._hValuePanel;d.className=this.styleName("ValuePanel");d=this._hValueForm=RBuilder.appendTable(d);d.width="100%";d=this._hValueLine=RBuilder.appendTableRow(d);this._hChangePanel=RBuilder.appendTableCell(d);this.onBuildEditChange(b);b=this._hInputPanel=RBuilder.appendTableCell(d);d=this._hInput=RBuilder.append(b,"TEXTAREA",this.styleName("Input"));d.wrap="off";this.attachEvent("onInputEdit",d,this.onInputEdit);RHtml.setSize(b,this._inputSize);this._editLength&&
(d.maxLength=this._editLength)}function FUiMemo_onInputEdit(b){this.refreshValue()}function FUiMemo_construct(){this.__base.FUiEditControl.construct.call(this);this._inputSize=new SSize2(120,0)}function FUiMemo_formatDisplay(b){return this._dataDisplay=b=RString.nvl(b)}function FUiMemo_formatValue(b){return b}function FUiMemo_get(){this.__base.FUiEditControl.get.call(this);return this._hInput.value}
function FUiMemo_set(b){this.__base.FUiEditControl.set.call(this,b);this._hInput.value=RString.nvl(b)}function FUiMemo_refreshValue(){this.processDataChangedListener(this)}
function FUiNumber(b){b=RClass.inherits(this,b,FUiEditControl,MListenerDataChanged,MPropertyNumber);b._inputSize=RClass.register(b,new APtySize2("_inputSize"));b._styleValuePanel=RClass.register(b,new AStyle("_styleValuePanel"));b._styleInput=RClass.register(b,new AStyle("_styleInput"));b._styleAdjustForm=RClass.register(b,new AStyle("_styleAdjustForm"));b._styleUpPanel=RClass.register(b,new AStyle("_styleUpPanel"));b._styleDownPanel=RClass.register(b,new AStyle("_styleDownPanel"));b._innerOriginValue=
null;b._innerDataValue=null;b._hInput=null;b._iconUp=null;b._iconDown=null;b.onBuildEditValue=FUiNumber_onBuildEditValue;b.onInputKeyPress=RClass.register(b,new AEventKeyPress("onInputKeyPress"),FUiNumber_onInputKeyPress);b.onInputChanged=RClass.register(b,new AEventInputChanged("onInputChanged"),FUiNumber_onInputChanged);b.construct=FUiNumber_construct;b.formatDisplay=FUiNumber_formatDisplay;b.formatValue=FUiNumber_formatValue;b.get=FUiNumber_get;b.set=FUiNumber_set;return b}
function FUiNumber_onBuildEditValue(b){var d=this._hValuePanel;d.className=this.styleName("ValuePanel");d=this._hValueForm=RBuilder.appendTable(d);d.width="100%";d=this._hValueLine=RBuilder.appendTableRow(d);this._hChangePanel=RBuilder.appendTableCell(d);this.onBuildEditChange(b);b=this._hInputPanel=RBuilder.appendTableCell(d);b=this._hInput=RBuilder.appendEdit(b,this.styleName("Input"));this.attachEvent("onInputKeyPress",b,this.onInputKeyPress);this.attachEvent("onInputChanged",b,this.onInputChanged);
this._editLength&&(b.maxLength=this._editLength);b=this._hAdjustPanel=RBuilder.appendTableCell(d);b.style.borderLeft="1px solid #666666";b.width=12;b=this.hAdjustForm=RBuilder.appendTable(b,this.styleName("AdjustForm"));d=RBuilder.appendTableRowCell(b);d.className=this.styleName("UpPanel");(this._hUpIcon=RBuilder.appendIcon(d,null,"control.number.up")).align="center";d=RBuilder.appendTableRowCell(b);d.className=this.styleName("DownPanel");this._hDownIcon=RBuilder.appendIcon(d,null,"control.number.down")}
function FUiNumber_onInputKeyPress(b){RKeyboard.isFloatKey(b.keyCode)||b.cancel()}function FUiNumber_onInputChanged(b){this.processDataChangedListener(this)}function FUiNumber_construct(){this.__base.FUiEditControl.construct.call(this);this._editSize.set(100,20);this._inputSize=new SSize2(80,0)}function FUiNumber_formatDisplay(b){return this._dataDisplay=RFloat.format(b,0,null,this._valuePrecision,null)}function FUiNumber_formatValue(b){return b}
function FUiNumber_get(b){b=this.__base.FUiEditControl.get.call(this,b);var d=this._hInput;d&&(b=this.formatValue(d.value));return b}function FUiNumber_set(b){this.__base.FUiEditControl.set.call(this,b);var d=RString.nvl(b,"0");this._innerDataValue=this._innerOriginValue=d;if(d=this._hInput)d.value=this.formatDisplay(b);this.changeSet(!1)}function FUiNumber_onDataKeyDown(b,d){this.__base.FUiEditControl.onDataKeyDown.call(this,b,d);this.editCase&&RKey.fixCase(d,this.editCase)}
function FUiNumber_setText(b){this.hEdit&&(this.hEdit.value="U"==this.editCase?RString.toUpper(b):"L"==this.editCase?RString.toLower(b):b,this.hEdit.style.textAlign="right"==this.editAlign?"right":"left"==this.editAlign?"left":"center")}
function FUiNumber_validText(b){var d=this.__base.FUiEditControl.validText.call(this,b);if(!d){if(this.validLenmin&&this.validLenmin>b.length)return RContext.get("MDescEdit:ValidMinLength",this.validLenmin);if(this.validLenmax&&this.validLenmax<b.length)return RContext.get("MDescEdit:ValidMaxLength",this.validLenmax)}return d}
function FUiNumber_findEditor(){if(this.editComplete){var b=this.editor;!b&&(this.dsControl=this.topControl(MDataset))&&(b=this.editor=RConsole.find(FUiNumberConsole).focus(this,FUiNumberEditor));b&&b.linkControl(this);return this.editor}}function FUiNumber_drop(){var b=this.findEditor();if(b){var d=this.reget();0<d.length&&(this.finded!=d&&(b.source!=this&&b.linkControl(this),b.search(d)),this.finded=d)}}
function FUiNumber2(b){b=RClass.inherits(this,b,FUiEditControl);b._inputSize=RClass.register(b,new APtySize2("_inputSize"));b._styleInputPanel=RClass.register(b,new AStyle("_styleInputPanel"));b._styleInput=RClass.register(b,new AStyle("_styleInput"));b._hInput=null;b.onBuildEditValue=FUiNumber2_onBuildEditValue;b.construct=FUiNumber2_construct;b.get=FUiNumber2_get;b.set=FUiNumber2_set;return b}function FUiNumber2_oeDataLoad(b){alert(b);return EEventStatus.Stop}
function FUiNumber2_oeDataSave(b){return EEventStatus.Stop}function FUiNumber2_onBuildEditValue(b){b=this._hValuePanel;b.className=this.styleName("InputPanel");b=this._hInputForm=RBuilder.appendTable(b);b=RBuilder.appendTableRow(b);var d=RBuilder.appendTableCell(b);d.style.borderRight="1px solid #666666";this._hInput1=RBuilder.appendEdit(d,this.styleName("Input"));b=RBuilder.appendTableCell(b);b.style.borderLeft="1px solid #999999";this._hInput2=RBuilder.appendEdit(b,this.styleName("Input"))}
function FUiNumber2_construct(){this.__base.FUiEditControl.construct.call(this);this._inputSize=new SSize2(120,0)}function FUiNumber2_get(b){b=this.__base.FUiEditControl.get.call(this,b);var d=this._hInput;d&&(b=d.value);return b}function FUiNumber2_set(b){this.__base.FUiEditControl.set.call(this,b);var d=this._hInput;d&&(d.value=RString.nvl(b))}function FUiNumber2_onDataKeyDown(b,d){this.__base.FUiEditControl.onDataKeyDown.call(this,b,d);this.editCase&&RKey.fixCase(d,this.editCase)}
function FUiNumber2_formatValue(b){b=RString.nvl(b);ECase.Upper==this.editCase?b=RString.toUpper(b):ECase.Lower==this.editCase&&(b=RString.toLower(b));return b}function FUiNumber2_setText(b){this.hEdit&&(this.hEdit.value="U"==this.editCase?RString.toUpper(b):"L"==this.editCase?RString.toLower(b):b,this.hEdit.style.textAlign="right"==this.editAlign?"right":"left"==this.editAlign?"left":"center")}
function FUiNumber2_validText(b){var d=this.__base.FUiEditControl.validText.call(this,b);if(!d){if(this.validLenmin&&this.validLenmin>b.length)return RContext.get("MDescEdit:ValidMinLength",this.validLenmin);if(this.validLenmax&&this.validLenmax<b.length)return RContext.get("MDescEdit:ValidMaxLength",this.validLenmax)}return d}
function FUiNumber2_findEditor(){if(this.editComplete){var b=this.editor;!b&&(this.dsControl=this.topControl(MDataset))&&(b=this.editor=RConsole.find(FUiNumber2Console).focus(this,FUiNumber2Editor));b&&b.linkControl(this);return this.editor}}function FUiNumber2_drop(){var b=this.findEditor();if(b){var d=this.reget();0<d.length&&(this.finded!=d&&(b.source!=this&&b.linkControl(this),b.search(d)),this.finded=d)}}
function FUiNumber2_clone(){var b=this._class.newInstance();GHtml_clone(b,this.hPanel);return b}function FUiNumber2_link(){}
function FUiNumber3(b){b=RClass.inherits(this,b,FUiEditControl,MListenerDataChanged);b._inputSize=RClass.register(b,new APtySize2("_inputSize"));b._styleValuePanel=RClass.register(b,new AStyle("_styleValuePanel"));b._styleInputPanel=RClass.register(b,new AStyle("_styleInputPanel"));b._styleInput=RClass.register(b,new AStyle("_styleInput"));b._innerOriginValue=null;b._innerDataValue=null;b._hInput=null;b.onBuildEditInput=FUiNumber3_onBuildEditInput;b.onBuildEditValue=FUiNumber3_onBuildEditValue;b.onInputKeyPress=
RClass.register(b,new AEventKeyPress("onInputKeyPress"),FUiNumber3_onInputKeyPress);b.onInputChanged=RClass.register(b,new AEventInputChanged("onInputChanged"),FUiNumber3_onInputChanged);b.construct=FUiNumber3_construct;b.get=FUiNumber3_get;b.set=FUiNumber3_set;return b}function FUiNumber3_onBuildEditInput(b,d){this.attachEvent("onInputKeyPress",d,this.onInputKeyPress);this.attachEvent("onInputChanged",d,this.onInputChanged)}
function FUiNumber3_onBuildEditValue(b){var d=this._hValuePanel;d.className=this.styleName("ValuePanel");d=this._hValueForm=RBuilder.appendTable(d);d=RBuilder.appendTableRow(d);this._hChangePanel=RBuilder.appendTableCell(d);this.onBuildEditChange(b);var f=RBuilder.appendTableCell(d,this.styleName("InputPanel"));f.style.borderRight="1px solid #666666";f=this._hInput1=RBuilder.appendEdit(f,this.styleName("Input"));this.onBuildEditInput(b,f);f=RBuilder.appendTableCell(d,this.styleName("InputPanel"));
f.style.borderLeft="1px solid #999999";f.style.borderRight="1px solid #666666";f=this._hInput2=RBuilder.appendEdit(f,this.styleName("Input"));this.onBuildEditInput(b,f);f=RBuilder.appendTableCell(d,this.styleName("InputPanel"));f.style.borderLeft="1px solid #999999";f=this._hInput3=RBuilder.appendEdit(f,this.styleName("Input"));this.onBuildEditInput(b,f)}function FUiNumber3_onInputKeyPress(b){EKeyCode.floatCodes[b.keyCode]||b.cancel()}
function FUiNumber3_onInputChanged(b){this.processDataChangedListener(this)}function FUiNumber3_construct(){this.__base.FUiEditControl.construct.call(this);this._inputSize=new SSize2(120,0);this._innerOriginValue=new SPoint3;this._innerDataValue=new SPoint3}
function FUiNumber3_get(b){this.__base.FUiEditControl.get.call(this,b);b=this._innerDataValue;var d=this._hInput1;d&&(b.x=RFloat.parse(d.value));if(d=this._hInput2)b.y=RFloat.parse(d.value);if(d=this._hInput3)b.z=RFloat.parse(d.value);return b}
function FUiNumber3_set(b){this.__base.FUiEditControl.set.call(this,b);var d=arguments,f=this._innerOriginValue,h=this._innerDataValue;if(1==d.length)if(b.constructor==SPoint3||b.constructor==SVector3)f.assign(b),h.assign(b);else throw new TError("Invalid value format.");else if(3==d.length)f.set(d[0],d[1],d[2]),h.assign(f);else throw new TError("Invalid value format.");if(d=this._hInput1)d.value=RFloat.format(h.x,0,null,3,null);if(d=this._hInput2)d.value=RFloat.format(h.y,0,null,3,null);if(d=this._hInput3)d.value=
RFloat.format(h.z,0,null,3,null);this.changeSet(!1)}function FUiNumber3_onDataKeyDown(b,d){this.__base.FUiEditControl.onDataKeyDown.call(this,b,d);this.editCase&&RKey.fixCase(d,this.editCase)}function FUiNumber3_formatValue(b){b=RString.nvl(b);ECase.Upper==this.editCase?b=RString.toUpper(b):ECase.Lower==this.editCase&&(b=RString.toLower(b));return b}
function FUiNumber3_setText(b){this.hEdit&&(this.hEdit.value="U"==this.editCase?RString.toUpper(b):"L"==this.editCase?RString.toLower(b):b,this.hEdit.style.textAlign="right"==this.editAlign?"right":"left"==this.editAlign?"left":"center")}
function FUiNumber3_validText(b){var d=this.__base.FUiEditControl.validText.call(this,b);if(!d){if(this.validLenmin&&this.validLenmin>b.length)return RContext.get("MDescEdit:ValidMinLength",this.validLenmin);if(this.validLenmax&&this.validLenmax<b.length)return RContext.get("MDescEdit:ValidMaxLength",this.validLenmax)}return d}
function FUiNumber3_findEditor(){if(this.editComplete){var b=this.editor;!b&&(this.dsControl=this.topControl(MDataset))&&(b=this.editor=RConsole.find(FUiNumber3Console).focus(this,FUiNumber3Editor));b&&b.linkControl(this);return this.editor}}function FUiNumber3_drop(){var b=this.findEditor();if(b){var d=this.reget();0<d.length&&(this.finded!=d&&(b.source!=this&&b.linkControl(this),b.search(d)),this.finded=d)}}
function FUiNumber3_clone(){var b=this._class.newInstance();GHtml_clone(b,this.hPanel);return b}function FUiNumber3_link(){}
function FUiNumber4(b){b=RClass.inherits(this,b,FUiEditControl);b._inputSize=RClass.register(b,new APtySize2("_inputSize"));b._styleInputPanel=RClass.register(b,new AStyle("_styleInputPanel"));b._styleInput=RClass.register(b,new AStyle("_styleInput"));b._hInput=null;b.onBuildEditValue=FUiNumber4_onBuildEditValue;b.construct=FUiNumber4_construct;b.get=FUiNumber4_get;b.set=FUiNumber4_set;return b}function FUiNumber4_oeDataLoad(b){alert(b);return EEventStatus.Stop}
function FUiNumber4_oeDataSave(b){return EEventStatus.Stop}
function FUiNumber4_onBuildEditValue(b){b=this._hValuePanel;b.className=this.styleName("InputPanel");b=this._hInputForm=RBuilder.appendTable(b);b=RBuilder.appendTableRow(b);var d=RBuilder.appendTableCell(b);d.style.borderRight="1px solid #666666";this._hInput1=RBuilder.appendEdit(d,this.styleName("Input"));d=RBuilder.appendTableCell(b);d.style.borderRight="1px solid #666666";d.style.borderLeft="1px solid #999999";this._hInput2=RBuilder.appendEdit(d,this.styleName("Input"));d=RBuilder.appendTableCell(b);
d.style.borderLeft="1px solid #999999";d.style.borderRight="1px solid #666666";this._hInput3=RBuilder.appendEdit(d,this.styleName("Input"));b=RBuilder.appendTableCell(b);b.style.borderLeft="1px solid #999999";this._hInput4=RBuilder.appendEdit(b,this.styleName("Input"))}function FUiNumber4_construct(){this.__base.FUiEditControl.construct.call(this);this._inputSize=new SSize2(120,0)}function FUiNumber4_get(b){b=this.__base.FUiEditControl.get.call(this,b);var d=this._hInput;d&&(b=d.value);return b}
function FUiNumber4_set(b){this.__base.FUiEditControl.set.call(this,b);var d=this._hInput;d&&(d.value=RString.nvl(b))}function FUiNumber4_onDataKeyDown(b,d){this.__base.FUiEditControl.onDataKeyDown.call(this,b,d);this.editCase&&RKey.fixCase(d,this.editCase)}function FUiNumber4_formatValue(b){b=RString.nvl(b);ECase.Upper==this.editCase?b=RString.toUpper(b):ECase.Lower==this.editCase&&(b=RString.toLower(b));return b}
function FUiNumber4_setText(b){this.hEdit&&(this.hEdit.value="U"==this.editCase?RString.toUpper(b):"L"==this.editCase?RString.toLower(b):b,this.hEdit.style.textAlign="right"==this.editAlign?"right":"left"==this.editAlign?"left":"center")}
function FUiNumber4_validText(b){var d=this.__base.FUiEditControl.validText.call(this,b);if(!d){if(this.validLenmin&&this.validLenmin>b.length)return RContext.get("MDescEdit:ValidMinLength",this.validLenmin);if(this.validLenmax&&this.validLenmax<b.length)return RContext.get("MDescEdit:ValidMaxLength",this.validLenmax)}return d}
function FUiNumber4_findEditor(){if(this.editComplete){var b=this.editor;!b&&(this.dsControl=this.topControl(MDataset))&&(b=this.editor=RConsole.find(FUiNumber4Console).focus(this,FUiNumber4Editor));b&&b.linkControl(this);return this.editor}}function FUiNumber4_drop(){var b=this.findEditor();if(b){var d=this.reget();0<d.length&&(this.finded!=d&&(b.source!=this&&b.linkControl(this),b.search(d)),this.finded=d)}}
function FUiNumber4_clone(){var b=this._class.newInstance();GHtml_clone(b,this.hPanel);return b}function FUiNumber4_link(){}
function FUiPanel(b){b=RClass.inherits(this,b,FUiLayout,MUiDesign,MUiFocus);b._sizeCd=EUiSize.Horizontal;b._stylePanel=RClass.register(b,new AStyle("_stylePanel","Panel"));b._styleLabel=RClass.register(b,new AStyle("_styleLabel","Label"));b._styleBody=RClass.register(b,new AStyle("_styleBody","Body"));b._hImage=null;b._imagePlus="control.panel.plus";b._imageMinus="control.panel.minus";b._statusBody=!0;b.onBuildPanel=FUiPanel_onBuildPanel;b.onTitleClick=RClass.register(b,new AEventClick("onTitleClick"),
FUiPanel_onTitleClick);return b}
function FUiPanel_onBuildPanel(b){b=this._hPanel=RBuilder.createDiv(b,this.styleName("Panel"));var d=RBuilder.appendTable(b,this.styleName("Label"));this.attachEvent("onTitleClick",d);d.width="100%";d=RBuilder.appendTableRow(d);d.vAlign="middle";var f=RBuilder.appendTableCell(d);f.width=20;this._hImage=RBuilder.appendIcon(f,null,this._imageMinus);RBuilder.appendTableCell(d).innerHTML=this._label;b=this._hBody=RBuilder.appendDiv(b,this.styleName("Body"));this._hPanelForm=RBuilder.appendTable(b,this.styleName("Form"))}
function FUiPanel_onTitleClick(b){this._statusBody=b=!this._statusBody;this._hImage.src=RResource.iconPath(b?this._imageMinus:this._imagePlus);RHtml.displaySet(this._hBody,b)}function FUiPanelHorizontal(b){b=RClass.inherits(this,b,FUiLayoutHorizontal);b._sizeCd=EUiSize.Horizontal;return b}function FUiPanelVertical(b){return b=RClass.inherits(this,b,FUiLayoutVertical)}
function FUiPicture(b){b=RClass.inherits(this,b,FEditControl,MEditBorder,MDescEdit);b.storeType=RClass.register(b,new TPtyStr("storeType"));b.storeCode=RClass.register(b,new TPtyStr("storeCode"));b.storeName=RClass.register(b,new TPtyStr("storeName"));b.editAdjust=RClass.register(b,new TPtyInt("editAdjust"));b.editMaxWidth=RClass.register(b,new TPtyInt("editMaxWidth"));b.editMaxHeight=RClass.register(b,new TPtyInt("editMaxHeight"));b.__seed=0;b.attributes=null;b.border=null;b.borderStyle=EUiBorder.Round;
b.onUploadMouseDown=RClass.register(b,new HMouseDown("onUploadMouseDown"),FUiPicture_onUploadMouseDown);b.onFileUploaded=FUiPicture_onFileUploaded;b.onBuildEdit=FUiPicture_onBuildEdit;b.construct=FUiPicture_construct;b.makeIconPath=FUiPicture_makeIconPath;b.setText=FUiPicture_setText;b.setEditable=FUiPicture_setEditable;b.dispose=FUiPicture_dispose;return b}
function FUiPicture_onUploadMouseDown(b){this._editable&&!this._disbaled&&(b=RConsole.find(FUploadConsole).findWindow(),b.lsnsUploaded.register(this,this.onFileUploaded),b.typeCode="P",b.fileEdit=!1,b.recordCode=this.recordCode,b.recordGuid=this.recordGuid,b.recordName=this.recordName,b.guid=this.guid,b.adjustWidth=this.editWidth,b.adjustHeight=this.editHeight,b.show())}
function FUiPicture_onFileUploaded(b,d){var f=d.attributes;this.guid=f.get("GUID");this.mime=f.get("MIME");this.networkCode=f.get("NETWORK_CODE");this.hImage.src=this.makeIconPath(this.guid,this.mime,this.networkCode)+"?"+RDate.format()+ ++this.__seed;this.hImage.style.display="block"}
function FUiPicture_onBuildEdit(b){b=this.hImageForm=this.hEdit=RBuilder.appendTable(b.hPanel);b.width="100%";b.border=1;b.height="100%";b=this.hImagePanel=b.insertRow().insertCell();b.align="center";b.style.cursor="hand";this.attachEvent("onUploadMouseDown",this.hImagePanel);b=this.hImage=RBuilder.append(b,"IMAGE");b.style.border="1 solid #CCCCCC";b.style.display="none";0<this.left&&0<this.top&&(this.hPanel.style.position="absolute")}
function FUiPicture_construct(){this.base.FEditControl.construct.call(this);this.attributes=new TAttributes}function FUiPicture_makeIconPath(b,d,f){b=this.recordCode+"/"+this.recordGuid+"/"+b+".icon."+d;return top.RContext.context("/svr/"+f.toLowerCase()+"/sys/"+RString.toLower(b))}
function FUiPicture_setText(b){var d=this.attributes;d.clear();var f=!1;RString.isEmpty(b)||(d.unpack(b),this.networkCode=d.get("nc"),this.recordCode=d.get("code"),this.recordGuid=d.get("guid"),this.recordName=d.get("name"),this.guid=d.get("ogid"),this.mime=d.get("mime"),this.guid&&this.mime&&(f=!0,this.hImage.src=this.makeIconPath(this.guid,this.mime,this.networkCode)));this.hImage.style.display=f?"block":"none"}
function FUiPicture_setEditable(b){this.base.FEditControl.setEditable.call(this,b);this.hImagePanel.style.cursor=b?"hand":"normal"}function FUiPicture_dispose(){this.base.FEditControl.dispose.call(this);this.hImage=null}
function FUiProgressBar(b){b=RClass.inherits(this,b,FUiControl);b._stylePanel=RClass.register(b,new AStyle("_stylePanel"));b._rate=0;b._hForm=null;b.onBuildPanel=FUiProgressBar_onBuildPanel;b.onBuild=FUiProgressBar_onBuild;b.get=FUiProgressBar_get;b.set=FUiProgressBar_set;b.dispose=FUiProgressBar_dispose;return b}function FUiProgressBar_onBuildPanel(b){this._hPanel=RBuilder.createTable(b,this.styleName("Panel"))}
function FUiProgressBar_onBuild(b){this.__base.FUiControl.onBuild.call(this,b);b=this._hLine=RBuilder.appendTableRow(this._hPanel);this.hProgress=RBuilder.appendTableCell(b);this.hEmpty=RBuilder.appendTableCell(b)}function FUiProgressBar_get(){return this._rate}function FUiProgressBar_set(b){this._rate=b}function FUiProgressBar_dispose(){this._hForm=RHtml.free(this._hForm);this.__base.FUiControl.dispose.call(this)}
function FUiRadio(b){b=RClass.inherits(this,b,FEditControl);b._groupName=RClass.register(b,new APtyString("_groupName"));b._styleInput=RClass.register(b,new AStyle("_styleInput","Input"));b._hInput=null;b.onBuildEditValue=FUiRadio_onBuildEditValue;return b}function FUiRadio_onBuildEditValue(b){this._hInput=RBuilder.appendRadio(this._hValuePanel,this.styleName("Input"))}function FUiRadio_clearValue(){this.hEdit.checked=!1}function FUiRadio_resetValue(){this.hEdit.checked=this._editChecked}
function FUiRadio_saveValue(b){this.hEdit.checked&&b.set(this.dataName,this.dataDefault)}function FUiRadio_text(){return this.hEdit.checked?this.dataDefault:""}function FUiRadio_setText(b){this.hEdit.checked=this.dataDefault==b}function FUiRadio_refreshStyle(){var b=this.panel(EPanel.Edit);b.disabled=!this._editable;b.style.cursor=this._editable?"hand":"normal"}
function FUiSelect(b){b=RClass.inherits(this,b,FUiEditControl,MUiContainer,MPropertySelect,MListenerDataChanged);b._styleValuePanel=RClass.register(b,new AStyle("_styleValuePanel"));b._styleInput=RClass.register(b,new AStyle("_styleInput"));b._hValueForm=null;b._hValueLine=null;b._hInputPanel=null;b._hInput=null;b.onBuildEditValue=FUiSelect_onBuildEditValue;b.onDoubleClick=RClass.register(b,new AEventDoubleClick("onDoubleClick"),FUiSelect_onDropClick);b.onDropClick=FUiSelect_onDropClick;b.onKeyDown=
RClass.register(b,new AEventKeyDown("onKeyDown"),FUiSelect_onKeyDown);b.construct=FUiSelect_construct;b.findItemByLabel=FUiSelect_findItemByLabel;b.findItemByData=FUiSelect_findItemByData;b.formatValue=FUiSelect_formatValue;b.formatDisplay=FUiSelect_formatDisplay;b.get=FUiSelect_get;b.set=FUiSelect_set;b.selectItem=FUiSelect_selectItem;b.refreshValue=FUiSelect_refreshValue;b.drop=FUiSelect_drop;b.dispose=FUiSelect_dispose;return b}
function FUiSelect_onBuildEditValue(b){var d=this._hValuePanel;d.className=this.styleName("ValuePanel");d=this._hValueForm=RBuilder.appendTable(d);d.width="100%";d=this._hValueLine=RBuilder.appendTableRow(d);this._hChangePanel=RBuilder.appendTableCell(d);this.onBuildEditChange(b);var f=this._hInputPanel=RBuilder.appendTableCell(d),f=this._hInput=RBuilder.appendEdit(f,this.styleName("Input"));this.attachEvent("onDoubleClick",f);this.attachEvent("onKeyDown",f);this._editLength&&(f.maxLength=this._editLength);
(this._hDropPanel=RBuilder.appendTableCell(d)).style.borderLeft="1px solid #666666";this.onBuildEditDrop(b);d=this._emptyItem=RClass.create(FUiSelectItem);d.build(b);this.push(d)}function FUiSelect_onDropClick(b){this.drop()}function FUiSelect_onKeyDown(b){var d=this._editor;if(d&&d._statusEditing&&d._source==this)d.onEditKeyDown(b);else b.keyCode==EKeyCode.Down&&this.drop()}function FUiSelect_construct(){this.__base.FUiEditControl.construct.call(this)}
function FUiSelect_findItemByLabel(b){var d=this._components;if(d)for(var f=d.count()-1;0<=f;f--){var h=d.valueAt(f);if(RString.equals(h._label,b,!0))return h}return null}function FUiSelect_findItemByData(b){var d=this._components;if(d)for(var f=d.count()-1;0<=f;f--){var h=d.valueAt(f);if(RString.equals(h._dataValue,b,!0))return h}return null}function FUiSelect_formatValue(b){var d=this.findItemByLabel(b);return d?RString.nvl(d._dataValue):b}
function FUiSelect_formatDisplay(b){var d=this.findItemByData(b);return d?RString.nvl(d._label):b}function FUiSelect_get(){return this.formatValue(this._hInput.value)}function FUiSelect_set(b){b=this.formatDisplay(b);this._hInput.value=RString.nvl(b)}function FUiSelect_selectItem(b){this._hInput.value=RString.nvl(b.label());this.refreshValue()}function FUiSelect_refreshValue(){this.processDataChangedListener(this)}
function FUiSelect_drop(){if(this.hasComponent()){var b=this._editor=RConsole.find(FUiEditorConsole).focus(this,FUiSelectEditor,this._name);b.buildItems(this);b.set(this.get());b.show()}}function FUiSelect_dispose(){this.__base.FUiEditControl.dispose.call(this)}function FUiSelect_onEditEnd(b){b&&(this.set(b.get()),this._invalidText=this.validText(this.text()),this.refreshStyle());this.onDataEditEnd(this)}
function FUiSelect_loadConfig(b){this.__base.FUiEditControl.loadConfig.call(this,b);this.dataEmpty&&this.items.create();this.editCheck||this.items.create("","");this.items.loadConfig(b);if(b=b.nodes)for(var d=b.count,f=0;f<d;f++){var h=b.get(f);if(h.isName("Event")){var q=RClass.create(FEvent);q.loadConfig(h);this.push(q)}}return EStatus.Stop}function FUiSelect_refreshStyle(){this.__base.FUiEditControl.refreshStyle.call(this);this.editCheck||(this.hEdit.readOnly="true")}
function FUiSelect_doBlur(){this.__base.FUiEditControl.doBlur.call(this);this._editor&&this._editor.hide()}
function FUiSelectEditor(b){b=RClass.inherits(this,b,FUiDropEditor,MListenerItemClick);b._items=null;b._position=null;b._hDropLayout=null;b._hItemsForm=null;b.onBuildDrop=FUiSelectEditor_onBuildDrop;b.onItemClick=FUiSelectEditor_onItemClick;b.onEditKeyDown=FUiSelectEditor_onEditKeyDown;b.onEditEnd=FUiSelectEditor_onEditEnd;b.construct=FUiSelectEditor_construct;b.testBlur=FUiSelectEditor_testBlur;b.buildItems=FUiSelectEditor_buildItems;b.clearItems=FUiSelectEditor_clearItems;b.get=FUiSelectEditor_get;
b.set=FUiSelectEditor_set;b.select=FUiSelectEditor_select;b.fetch=FUiSelectEditor_fetch;b.setVisible=FUiSelectEditor_setVisible;b.dispose=FUiSelectEditor_dispose;return b}function FUiSelectEditor_onBuildDrop(){var b=this._hDropLayout=RBuilder.appendDiv(this._hDropPanel),b=this._hItemsForm=RBuilder.appendTable(b);this._hItemsBody=RBuilder.append(b,"TBODY")}function FUiSelectEditor_onItemClick(b){this._position=this._items.indexOfValue(b);this.editEnd()}
function FUiSelectEditor_onEditKeyDown(b){switch(b.keyCode){case EKeyCode.Up:this.select(this._position-1);break;case EKeyCode.Down:this.select(this._position+1);break;case EKeyCode.Enter:this.editEnd();break;case EKeyCode.Esc:this.editCancel()}}function FUiSelectEditor_onEditEnd(){var b=this._source,d=this._items.value(this._position);b.selectItem(d);this.__base.FUiDropEditor.onEditEnd.call(this)}function FUiSelectEditor_construct(){this.__base.FUiDropEditor.construct.call(this)}
function FUiSelectEditor_testBlur(b){return this._source==b?!1:!this._items.contains(b)}function FUiSelectEditor_clearItems(){var b=this._hItemsBody,d=this._items;if(d)for(var f=d.count()-1;0<=f;f--){var h=d.value(f);h.removeClickListener(this,this.onItemClick);b.removeChild(h._hPanel)}this._position=0}
function FUiSelectEditor_buildItems(b){var d=this._hItemsBody;b=b.components();if(b!=this._items){this.clearItems();for(var f=b.count(),h=0;h<f;h++){var q=b.value(h);q.addClickListener(this,this.onItemClick);q.setPanel(d)}this._position=0;this._items=b}}function FUiSelectEditor_get(){return this._items.get(this._position).value}
function FUiSelectEditor_set(b){this._position=-1;for(var d=this._items,f=d.count(),h=0;h<f;h++){var q=d.value(h);RString.equals(q._dataValue,b,!0)?(this._position=h,q.setChecked(!0)):q.setChecked(!1)}}function FUiSelectEditor_select(b){var d=this._items,f=d.count();b=RInteger.toRange(b,0,f-1);for(var h=0;h<f;h++)d.value(h).setChecked(h==b);this._position=b}
function FUiSelectEditor_fetch(){if(!this.hasFetched){var b=new TCodeListServiceArg,d=this._source.topControl(MDataset);b.values=d.getCurrentRows();b.name=this._source.editRefer;if(b=RConsole.find(FCodeListConsole).fetch(b))d=this._source,d._items.clear(),d._items.loadConfig(b.root().nodes.get(0));this.hasFetched=!0}}
function FUiSelectEditor_setVisible(b){this.__base.FUiDropEditor.setVisible.call(this,b);var d=this._hPanel,f=this._hItemsForm;if(b){b=this._source.getValueRectangle(RValue.rectangle);f.width="";var h=f.offsetWidth;d.style.left=b.left()+"px";d.style.top=b.bottom()+"px";d.style.width=Math.max(h,b.width())+"px";f.width="100%";f.offsetHeight>this._minHeight&&(this._hDropLayout.style.overflowY="scroll",this._hDropLayout.style.height=this._minHeight+"px")}}
function FUiSelectEditor_dispose(){this._hDropLayout=RHtml.free(this._hDropLayout);this._hItemsForm=RHtml.free(this._hItemsForm);this.__base.FUiDropEditor.dispose.call(this)}
function FUiSelectItem(b){b=RClass.inherits(this,b,FUiControl,MListenerClick);b._icon=RClass.register(b,new APtyString("_icon"));b._note=RClass.register(b,new APtyString("_note"));b._dataValue=RClass.register(b,new APtyString("_dataValue"));b._styleNormal=RClass.register(b,new AStyle("_styleNormal"));b._styleHover=RClass.register(b,new AStyle("_styleHover"));b._styleSelect=RClass.register(b,new AStyle("_styleSelect"));b._styleIconChecked=RClass.register(b,new AStyle("_styleIcon"));b._styleLabel=RClass.register(b,
new AStyle("_styleLabel"));b._styleNote=RClass.register(b,new AStyle("_styleNote"));b._checked=!1;b._hIconPanel=null;b._hIcon=null;b._hLabelPanel=null;b._hNotePanel=null;b.onBuildPanel=FUiSelectItem_onBuildPanel;b.onBuild=FUiSelectItem_onBuild;b.onEnter=FUiSelectItem_onEnter;b.onLeave=FUiSelectItem_onLeave;b.onMouseDown=RClass.register(b,new AEventMouseDown("onMouseDown"),FUiSelectItem_onMouseDown);b.setChecked=FUiSelectItem_setChecked;b.set=FUiSelectItem_set;b.dispose=FUiSelectItem_dispose;return b}
function FUiSelectItem_onBuildPanel(b){this._hPanel=RBuilder.createTableRow(b,this.styleName("Normal"))}
function FUiSelectItem_onBuild(b){this.__base.FUiControl.onBuild.call(this,b);b=this._hPanel;this.attachEvent("onMouseDown",b);var d=this._hIconPanel=RBuilder.appendTableCell(b,this.styleName("Icon"));d.width=18;d.align="center";d=this._hLabelPanel=RBuilder.appendTableCell(b,this.styleName("Label"));d.innerHTML=this._label?this._label:"&nbsp;";this._hNotePanel=RBuilder.appendTableCell(b,this.styleName("Note"))}
function FUiSelectItem_onEnter(){this.__base.FUiControl.onEnter.call(this);this._hPanel.className=RBoolean.parse(this._checked)?this.styleName("Select"):this.styleName("Hover")}function FUiSelectItem_onLeave(){this._hPanel.className=RBoolean.parse(this._checked)?this.styleName("Select"):this.styleName("Normal");this.__base.FUiControl.onLeave.call(this)}function FUiSelectItem_onMouseDown(){this.processClickListener(this)}
function FUiSelectItem_setChecked(b){this._checked=b;this._hIcon?this._hIcon.style.display=b?"block":"none":this._hIconPanel.innerHTML=b?"O":"";this._hPanel.className=b?this.styleName("Select"):this.styleName("Normal")}
function FUiSelectItem_set(b,d,f,h){this._icon=RString.nvl(b);RString.isEmpty(this._icon)||(this._hIcon=RBuilder.appendIcon(this._hIconPanel,this.styleIcon(this._icon)));this._label=RString.nvl(d);this._value=RString.nvl(f);this._note=RString.nvl(h);this._hLabelPanel.innerText=this._label;this._hNotePanel.innerText=this._note}
function FUiSelectItem_dispose(){this._hIconPanel=RHtml.free(this._hIconPanel);this._hLabelPanel=RHtml.free(this._hLabelPanel);this._hNotePanel=RHtml.free(this._hNotePanel);this.__base.FUiControl.dispose.call(this)}
function FUiSlideNumber(b){b=RClass.inherits(this,b,FUiEditControl,MPropertyNumber,MListenerDataChanged,MMouseCapture);b._inputSize=RClass.register(b,new APtySize2("_inputSize"));b._styleSlidePanel=RClass.register(b,new AStyle("_styleSlidePanel"));b._styleValuePanel=RClass.register(b,new AStyle("_styleValuePanel"));b._styleInput=RClass.register(b,new AStyle("_styleInput"));b._styleAdjustForm=RClass.register(b,new AStyle("_styleAdjustForm"));b._styleUpPanel=RClass.register(b,new AStyle("_styleUpPanel"));
b._styleDownPanel=RClass.register(b,new AStyle("_styleDownPanel"));b._innerOriginValue=null;b._innerDataValue=null;b._slide=null;b._hInput=null;b._iconUp=null;b._iconDown=null;b.onBuildEditValue=FUiSlideNumber_onBuildEditValue;b.onMouseCaptureStart=FUiSlideNumber_onMouseCaptureStart;b.onMouseCapture=FUiSlideNumber_onMouseCapture;b.onMouseCaptureStop=FUiSlideNumber_onMouseCaptureStop;b.onSlideChange=FUiSlideNumber_onSlideChange;b.onInputKeyPress=RClass.register(b,new AEventKeyPress("onInputKeyPress"),
FUiSlideNumber_onInputKeyPress);b.onInputEdit=RClass.register(b,new AEventInputChanged("onInputEdit"),FUiSlideNumber_onInputEdit);b.onInputChange=RClass.register(b,new AEventChange("onInputChange"),FUiSlideNumber_onInputChange);b.construct=FUiSlideNumber_construct;b.get=FUiSlideNumber_get;b.set=FUiSlideNumber_set;b.setInputValue=FUiSlideNumber_setInputValue;b.refreshValue=FUiSlideNumber_refreshValue;return b}
function FUiSlideNumber_onBuildEditValue(b){var d=this._hValuePanel;d.className=this.styleName("ValuePanel");d=this._hValueForm=RBuilder.appendTable(d);d.__linker=this;d.width="100%";d=this._hValueLine=RBuilder.appendTableRow(d);this._hChangePanel=RBuilder.appendTableCell(d);this.onBuildEditChange(b);b=this._hSlidePanel=RBuilder.appendTableCell(d,this.styleName("SlidePanel"));var f=this._slide=new SUiSlide;f.control=this;f.hPanel=b;f.setRange(this._valueMin,this._valueMax);f.onSlideChange=this.onSlideChange;
f.build();b=this._hInputPanel=RBuilder.appendTableCell(d);f=this._hInput=RBuilder.appendEdit(b,this.styleName("Input"));this.attachEvent("onInputKeyPress",f,this.onInputKeyPress);this.attachEvent("onInputEdit",f,this.onInputEdit);this.attachEvent("onInputChange",f,this.onInputChange);RHtml.setSize(b,this._inputSize);this._editLength&&(f.maxLength=this._editLength);d=this._hAdjustPanel=RBuilder.appendTableCell(d);d.style.borderLeft="1px solid #666666";d.width=12;d=this.hAdjustForm=RBuilder.appendTable(d,
this.styleName("AdjustForm"));b=RBuilder.appendTableRowCell(d);b.className=this.styleName("UpPanel");(this._hUpIcon=RBuilder.appendIcon(b,null,"control.number.up")).align="center";b=RBuilder.appendTableRowCell(d);b.className=this.styleName("DownPanel");this._hDownIcon=RBuilder.appendIcon(b,null,"control.number.down")}function FUiSlideNumber_onMouseCaptureStart(b){var d=RHtml.searchObject(b.hSource,"__pcapture");if(d)d.onMouseDown(b)}
function FUiSlideNumber_onMouseCapture(b){var d=RHtml.searchObject(b.hSource,"__pcapture");if(d)d.onMouseMove(b)}function FUiSlideNumber_onMouseCaptureStop(b){var d=RHtml.searchObject(b.hSource,"__pcapture");if(d)d.onMouseUp(b)}function FUiSlideNumber_onSlideChange(b){this.setInputValue(b);this.refreshValue()}function FUiSlideNumber_onInputKeyPress(b){RKeyboard.isFloatKey(b.keyCode)||b.cancel()}function FUiSlideNumber_onInputEdit(b){this._slide.set(this._hInput.value);this.refreshValue()}
function FUiSlideNumber_onInputChange(b){b=this._hInput.value;this._slide.set(b);this.setInputValue(b);this.refreshValue()}function FUiSlideNumber_construct(){this.__base.FUiEditControl.construct.call(this);this._inputSize=new SSize2(120,0)}function FUiSlideNumber_get(b){b=RFloat.parse(this._hInput.value);return RFloat.toRange(b,this._valueMin,this._valueMax)}
function FUiSlideNumber_set(b){this.__base.FUiEditControl.set.call(this,b);this._innerDataValue=this._innerOriginValue=b=RString.nvl(b,"0");this._slide.set(b);this.setInputValue(b);this.changeSet(!1)}function FUiSlideNumber_setInputValue(b){b=RFloat.parse(b);isNaN(b)||(b=RFloat.toRange(b,this._valueMin,this._valueMax),this._dataDisplay=RFloat.format(b,0,null,2,null),this._hInput.value=this._dataDisplay)}function FUiSlideNumber_refreshValue(){this.processDataChangedListener(this)}
function FUiSplit(b){return b=RClass.inherits(this,b,FUiControl)}function FUiSplit_onSplitMouseEnter(b){this.hImage&&(this.hImage.src=RRes._iconPath(this.extended?"ctl.collapse_hvr":"ctl.expand_hvr"))}function FUiSplit_onSplitMouseLeave(b){this.hImage&&(this.hImage.src=RRes._iconPath(this.extended?"ctl.collapse_nor":"ctl.expand_nor"))}function FUiSplit_onMouseDown(){ESplitStyle.Normal==this._dispStyle&&this.extend(!this.extended)}
function FUiSplit_onBuildPanel(){this.hPanel=RBuilder.create(null,"DIV");this.hForm=RBuilder.appendTable(this.hPanel);this.hForm.width="100%"}
function FUiSplit_oeBuild(b){this.base.FUiControl.oeBuild.call(this,b);this.height=2;if(RString.equals(this._dispStyle,ESplitStyle.Normal)){b=this.hForm;var d=b.insertRow();this.attachEvent("onSplitMouseEnter",b);this.attachEvent("onSplitMouseLeave",b);b=d.insertCell();b.width="100%";b.height=25;b.style.padding="0 0";b.style.background="url("+RRes._iconPath("ctl.FUiSplit_Panel")+")";RBuilder.appendEmpty(b,4);this.hImage=RBuilder.appendIcon(b,this._iconMinus);this._icon&&(this.hIcon=RBuilder.appendIcon(b,
this._icon));this.hText=RBuilder.appendText(b,"&nbsp;&nbsp;"+this.label);this.hText.style.fontWeight="BOLD"}else RString.equals(this._dispStyle,ESplitStyle.BulgeLine)?(b=this.hForm.insertRow().insertCell(),b.style.borderBottom="1px solid #666666",b.style.borderTop="1px solid #DDDDDD",b.height=2):RString.equals(this._dispStyle,ESplitStyle.HollowLine)&&(b=this.hForm.insertRow().insertCell(),b.style.borderBottom="1px solid #DDDDDD",b.style.borderTop="1px solid #666666",b.height=2);return EEventStatus.Stop}
function FUiSplit_oeMode(b){var d=this.base.FUiControl.oeMode.call(this,b);this.base.MDisplay.oeMode.call(this,b);this.extend(this._editExtend);return d}function FUiSplit_construct(){this.__lines=new TList}
function FUiSplit_extend(b){if(EMode.Design!=this._emode&&this.extended!=b){this.extended=b;this.hImage&&(this.hImage.src=b?RResource._iconPath(this._iconMinus):RRes._iconPath(this._iconPlus));for(var d=this.__lines.count,f=0;f<d;f++)this.__lines.get(f).style.display=b?"block":"none";this.topControl().topResize(this)}}function FUiSplit_pushLine(b){this.__lines.push(b)}
function FUiSplit_dispose(){this.base.FUiControl.dispose.call(this);this.__lines&&(this.__lines.release(),this.__lines=null);this.hImage=this.hIcon=this.hText=this.hForm=null}
function FUiTemplate(b){b=RClass.inherits(this,b,FUiEditControl,MPropertyEdit,MListenerDataChanged);b._inputSize=RClass.register(b,new APtySize2("_inputSize"));b._unit=RClass.register(b,new APtyString("_unit"));b._styleValuePanel=RClass.register(b,new AStyle("_styleValuePanel"));b._styleInputPanel=RClass.register(b,new AStyle("_styleInputPanel"));b._styleInput=RClass.register(b,new AStyle("_styleInput"));b._hValueForm=null;b._hValueLine=null;b._hInputPanel=null;b._hInput=null;b.onBuildEditValue=FUiTemplate_onBuildEditValue;
b.onInputEdit=RClass.register(b,new AEventInputChanged("onInputEdit"),FUiTemplate_onInputEdit);b.construct=FUiTemplate_construct;b.formatDisplay=FUiTemplate_formatDisplay;b.formatValue=FUiTemplate_formatValue;b.get=FUiTemplate_get;b.set=FUiTemplate_set;b.refreshValue=FUiTemplate_refreshValue;return b}
function FUiTemplate_onBuildEditValue(b){var d=this._hValuePanel;d.className=this.styleName("ValuePanel");d=this._hValueForm=RBuilder.appendTable(d);d.width="100%";d=this._hValueLine=RBuilder.appendTableRow(d);this._hChangePanel=RBuilder.appendTableCell(d);this.onBuildEditChange(b);b=this._hInputPanel=RBuilder.appendTableCell(d);d=this._hInput=RBuilder.appendEdit(b,this.styleName("Input"));this.attachEvent("onInputEdit",d,this.onInputEdit);RHtml.setSize(b,this._inputSize);this._editLength&&(d.maxLength=
this._editLength)}function FUiTemplate_onInputEdit(b){this.refreshValue()}function FUiTemplate_construct(){this.__base.FUiEditControl.construct.call(this);this._inputSize=new SSize2(120,0)}function FUiTemplate_formatDisplay(b){return this._dataDisplay=b=RString.nvl(b)}function FUiTemplate_formatValue(b){return b}function FUiTemplate_get(){var b=this.__base.FUiEditControl.get.call(this);return b=this._hInput.value}
function FUiTemplate_set(b){this.__base.FUiEditControl.set.call(this,b);this._hInput.value=RString.nvl(b)}function FUiTemplate_refreshValue(){this.processDataChangedListener(this)}
function FUiText(b){b=RClass.inherits(this,b,FUiTextControl,MPropertyEdit,MListenerDataChanged);b._inputSize=RClass.register(b,new APtySize2("_inputSize"));b._unit=RClass.register(b,new APtyString("_unit"));b._styleValuePanel=RClass.register(b,new AStyle("_styleValuePanel"));b._styleInputPanel=RClass.register(b,new AStyle("_styleInputPanel"));b._styleInput=RClass.register(b,new AStyle("_styleInput"));b._hValueForm=null;b._hValueLine=null;b._hInputPanel=null;b._hInput=null;b.onBuildEditValue=FUiText_onBuildEditValue;
b.onInputEdit=RClass.register(b,new AEventInputChanged("onInputEdit"),FUiText_onInputEdit);b.construct=FUiText_construct;b.formatDisplay=FUiText_formatDisplay;b.formatValue=FUiText_formatValue;b.get=FUiText_get;b.set=FUiText_set;b.refreshValue=FUiText_refreshValue;return b}
function FUiText_onBuildEditValue(b){var d=this._hValuePanel;d.className=this.styleName("ValuePanel");d=this._hValueForm=RBuilder.appendTable(d);d.width="100%";d=this._hValueLine=RBuilder.appendTableRow(d);this._hChangePanel=RBuilder.appendTableCell(d);this.onBuildEditChange(b);b=this._hInputPanel=RBuilder.appendTableCell(d);d=this._hInput=RBuilder.appendEdit(b,this.styleName("Input"));this.attachEvent("onInputEdit",d,this.onInputEdit);RHtml.setSize(b,this._inputSize);this._editLength&&(d.maxLength=
this._editLength)}function FUiText_onInputEdit(b){this.refreshValue()}function FUiText_construct(){this.__base.FUiTextControl.construct.call(this);this._inputSize=new SSize2(120,0)}function FUiText_formatDisplay(b){return this._dataDisplay=b=RString.nvl(b)}function FUiText_formatValue(b){return b}function FUiText_get(){var b=this.__base.FUiTextControl.get.call(this);return b=this._hInput.value}function FUiText_set(b){this.__base.FUiTextControl.set.call(this,b);this._hInput.value=RString.nvl(b)}
function FUiText_refreshValue(){this.processDataChangedListener(this)}var EGridColumn=new function(){this.None=0;this.Size=1;this.Drag=2;return this},EGridDisplay=new function(){this.Title="T";this.Head="H";this.Search="S";this.Total="A";this.Navigator="N";return this};
function FCell(b){b=RClass.inherits(this,b,FControl,MEditValue,MDataValue);b._stylePanel=RClass.register(b,new AStyle("_stylePanel"));b._table=null;b._column=null;b._row=null;b.onBuildPanel=FCell_onBuildPanel;b.onBuild=FCell_onBuild;b.oeDataLoad=FCell_oeDataLoad;b.oeDataSave=FCell_oeDataSave;return b}function FCell_onBuildPanel(b){this._hPanel=RBuilder.create(b,"TD",this.styleName("Panel"))}
function FCell_onBuild(b){this.__base.FControl.onBuild.call(this,b);RHtml.linkSet(this._hPanel,"control",this)}function FCell_oeDataLoad(b){var d=this._column;b=b.source.currentRow().get(d._dataName);this.set(b);return EEventStatus.Stop}function FCell_oeDataSave(b){var d=this._column;b=b.source.currentRow();var f=this.get();b.set(d._dataName,f);return EEventStatus.Stop}
function FCell_doFocus(){this._table.__focusCell=this;if(this._column.isEditAble(this)){var b=this._hPanel.style;b.borderLeft="1px solid #666666";b.borderTop="1px solid #666666";b.borderRight="1px solid #CCCCCC";b.borderBottom="1px solid #CCCCCC";this.__focus=!0;this.refreshStyle()}}
function FCell_doBlur(){if(this._column.isEditAble(this)){var b=this._hPanel.style;b.borderLeft="0px solid #666666";b.borderTop="0px solid #666666";b.borderRight="1px solid #F0F0F0";b.borderBottom="1px dotted #CCCCCC";this.__focus=!1;this.refreshStyle()}}function FCell_descriptor(){return this._column}function FCell_text(){var b=this._column;return EEditFormat.Html==b.editFormat?this._hPanel.innerHTML:b._absEdit&&this._hEdit?this._hEdit.value:this._hEditPanel?this._hEditPanel.innerText:""}
function FCell_setText(b){var d=this._column;EEditFormat.Html==d.editFormat?this._hPanel.innerHTML=b:d._absEdit&&this._hEdit?this._hEdit.value=b:this._hEditPanel&&(this._hEditPanel.innerText=b)}function FCell_focus(b){var d=this._hEdit;d&&(this._column._table.selectRow(this._row,!0,!0),d.focus(),b&&d.select())}function FCell_setVisible(b){this._hPanel.style.display=b?"block":"none"}
function FCell_refreshStyle(){var b=this._table,d=this._row,f=d.isSelect,h=this._hEdit;h&&(h.readOnly=!0,h.style.color=EColor.TextReadonly,h.style.backgroundColor=q);var q=null,q=f?EColor._rowSelect:b.__hoverRow==d?EColor._rowHover:EColor._rows[d.index%EColor._rows.length];this.__focus&&(q=EColor._rowEditHover);this._hPanel.style.backgroundColor=q}
function FCell_dispose(){this.base.FControl.dispose.call(this);RMemory.freeHtml(this._hPanel);this.hDrop=this.hDropPanel=this._hEdit=this._hEditPanel=this.hIcon=this.hIconPanel=this.hFormLine=this.hForm=this._hPanel=null}function FCell_dump(b){b=RString.nvlStr(b);b.append(RClass.dump(this),"[");b.append(this.value);b.append("]");return b}
function FCellButton(b){b=RClass.inherits(this,b,FCell);b.buttons=null;b.attributes=null;b.onButtonEnter=RClass.register(b,new AEventMouseEnter("onButtonEnter"),FCellButton_onButtonEnter);b.onButtonLeave=RClass.register(b,new AEventMouseLeave("onButtonLeave"),FCellButton_onButtonLeave);b.onCellLeave=RClass.register(b,new AEventMouseLeave("onCellLeave"),FCellButton_onCellLeave);b.onHintEnter=RClass.register(b,new AEventMouseEnter("onHintEnter"),FCellButton_onHintEnter);b.onHintLeave=RClass.register(b,
new AEventMouseLeave("onHintLeave"),FCellButton_onHintLeave);b.onButtonClick=RClass.register(b,new AEventClick("onButtonClick"),FCellButton_onButtonClick);b.construct=FCellButton_construct;b.isDataChanged=RMethod.emptyFalse;b.findButtonByPanel=FCellButton_findButtonByPanel;b.buildForm=FCellButton_buildForm;b.set=FCellButton_set;b.modifyButton=FCellButton_modifyButton;b.refreshStyle=FCellButton_refreshStyle;return b}
function FCellButton_onButtonEnter(b){if(b=this.findButtonByPanel(b.hSource)){var d=b.hPanel.style;d.color="black";d.cursor="hand";b.hintBox&&(b.hintBox.style.display="block")}this.hHintPanel&&(this.hHintPanel.style.display="")}function FCellButton_onButtonLeave(b){if(b=this.findButtonByPanel(b.hSource))b=b.hPanel.style,b.color="#0661B0",b.cursor="normal"}function FCellButton_onHintEnter(b){b.hSource.style.backgroundColor="#eeeeee"}
function FCellButton_onCellLeave(b){b=this.buttons;for(var d=b.count,f=0;f<d;f++){var h=b.value(f);h.hintBox&&(h.hintBox.style.display="none")}}function FCellButton_onHintLeave(b){b.hSource.style.backgroundColor="#ffffff";b.hSource.style.display="none"}function FCellButton_onButtonClick(b){this.table.clickCell(this);var d=this.findButtonByPanel(b.hSource);d&&d.button.callEvent("onClick",this,b)}function FCellButton_construct(){this.base.FCell.construct.call(this);this.attributes=new TAttributes}
function FCellButton_findButtonByPanel(b){for(var d=this.buttons,f=0;f<d.count;f++){var h=d.value(f);if(h.hPanel==b)return h}}
function FCellButton_buildForm(){var b=this.column,d=this.hPanel;RControl.attachEvent(this,"onCellLeave",d,this.onCellLeave);d.align="left";d.padding=1;d=this.hFormLine=(this.hForm=RBuilder.appendTable(this.hPanel)).insertRow();if(b=b.components){this.buttons=new TMap;for(var f=0;f<b.count;f++){var h=b.value(f),q=d.insertCell();q.align="center";q.style.padding="0 3";var z=RBuilder.append(q,"DIV"),A=null;h.icon?A=RBuilder.appendIcon(z,h.icon):(z.style.padding="2 6",z.style.color="#0661B0",z.style.textDecoration=
"underline");this.attachEvent("onButtonEnter",z,this.onButtonEnter);this.attachEvent("onButtonLeave",z,this.onButtonLeave);this.attachEvent("onButtonClick",z,this.onButtonClick);var B=null;h.label&&(h.icon?A.title=h.label:B=RBuilder.appendText(z,h.label));var C=new TCellButton;C.button=h;C.hLayout=q;C.hPanel=z;C.hIcon=A;C.hText=B;this.buttons.set(h.name,C)}d=this.hHintPanel=this.hForm.insertRow().insertCell();d.height=1;d.style.position="relative"}}
function FCellButton_set(b){if(!RString.isEmpty(b)){var d=new TAttributes;d.unpack(b);for(b=0;b<d.count;b++){var f=this.buttons.get(d.name(b)),h=d.value(b);if(f&&!RString.isEmpty(h)){var q=this.attributes;q.clear();q.unpack(h);this.modifyButton(f,q)}}}}
function FCellButton_modifyButton(b,d){var f=!0;d.contains("visible")&&(f=RBoolean.isTrue(d.get("visible")));b.hLayout.style.display=f?"block":"none";if(f=d.get("disabled"))RBoolean.isTrue(f)?(hc.style.padding=3,hc.style.border=0):(hc.style.padding=2,hc.style.borderLeft="1 solid #DDDDDD",hc.style.borderTop="1 solid #DDDDDD",hc.style.borderRight="1 solid #999999",hc.style.borderBottom="1 solid #999999",hc.style.backgroundColor="#FFFFFF");if(f=d.get("label"))b.icon?b.hIcon.title=f:b.hText.innerText=
f;d.contains("hint")&&(hfd=this.hFloatDrop=RBuilder.append(this.hHintPanel,"DIV"),hfd.style.borderLeft="1 solid #CCCCCC",hfd.style.borderTop="1 solid #CCCCCC",hfd.style.borderRight="1 solid #666666",hfd.style.borderBottom="1 solid #666666",hfd.style.zIndex=4E4,hfd.style.backgroundColor="#FFFFFF",hfd.style.display="none",hfd.style.position="absolute",hfd.style.padding="4 8",hfd.style.width="300px",hfd.style.pixelTop=b.offsetHeight+1,hfd.style.pixelLeft=b.hPanel.offsetWidth+20,hfd.innerHTML=d.get("hint"),
this.attachEvent("onHintEnter",hfd,this.onHintEnter),this.attachEvent("onHintLeave",hfd,this.onHintLeave),b.hintBox=hfd)}function FCellButton_refreshStyle(){var b=this.row,d=null,d=b.isSelect?EColor.RowSelect:this.column.table.__hoverRow==b?EColor.RowHover:EColor.Rows[b.index%EColor.Rows.length];this.hPanel.style.backgroundColor=d}
function FCellEdit(b){b=RClass.inherits(this,b,FCellEditControl);b._styleInput=RClass.register(b,new AStyle("_styleInput"));b._hInput=null;b.onBuildEdit=FCellEdit_onBuildEdit;b.get=FCellEdit_get;b.set=FCellEdit_set;return b}function FCellEdit_onBuildEdit(b){this._hInput=RBuilder.appendEdit(this._hEditPanel,this.styleName("Input"))}function FCellEdit_get(){var b=o.__base.FCellEditControl.get.call(o,p),d=o._hInput;d&&(b=d.value);return b}
function FCellEdit_set(b){this.__base.FCellEditControl.set.call(this,b);var d=this._hInput;d&&(d.value=RString.nvl(b))}function FCellEdit_buildDrop(){var b=this.column;if(!RString.isEmpty(b.lovRefer)){var d=this.hDropPanel;d.align="right";d.style.paddingRight=2;d=this.hLovImage=RBuilder.appendIcon(d,"ctl.FCellEdit_Lov",null,16,16);d.style.borderLeft="1 solid #CCCCCC";d.style.cursor="hand";b.linkEvent(this,"onListClick",d)}}
function FCellEdit_setInfo(b){this.base.FCellEditControl.setInfo.call(this,b);var d=this.column.iconMap,f=this.hIcon;d&&d.get(b.icon)?(f.style.display="block",f.title=b.iconHint,f.src=RResource.iconPath(d.get(b.icon))):f&&(f.style.display="none")}function FCellEdit_text(){var b=this.column;return b.canZoom()?this.hEdit.innerText:b._absEdit?this.hEdit.value:this.hEditPanel.innerText}
function FCellEdit_setText(b){var d=this.column;d.canZoom()?this.hEdit.innerText=b:d._absEdit?this.hEdit.value=b:this.hEditPanel.innerText=b}function FCellEditControl(b){b=RClass.inherits(this,b,FCell);b.onBuildIcon=FCellEditControl_onBuildIcon;b.onBuildEdit=FCellEditControl_onBuildEdit;b.onBuildDrop=RMethod.empty;b.onBuildForm=FCellEditControl_onBuildForm;b.onBuild=FCellEditControl_onBuild;return b}function FCellEditControl_onBuildIcon(b){this.hIcon=RBuilder.append(this.hIconPanel,"IMG")}
function FCellEditControl_onBuildEdit(b){}
function FCellEditControl_onBuildForm(b){var d=this._column;if(d._hasIconArea||d._hasDropArea){var f=this.hForm=RBuilder.appendTable(this._hPanel);f.width="100%";f=this.hFormLine=f.insertRow();d.hasIconArea&&(this.hIconPanel=f.insertCell(),this.hIconPanel.width=18,this.onBuildIcon(b));this._hEditPanel=f.insertCell();this.onBuildEdit(b);d.hasDropArea&&(this.hDropPanel=f.insertCell(),this.hDropPanel.width=8,this.onBuildDrop(b))}else this._hEditPanel=this._hPanel,this.onBuildEdit(b)}
function FCellEditControl_onBuild(b){this.__base.FCell.onBuild.call(this,b);this.onBuildForm(b)}function FCellEditControl_getEditRange(){var b=this.hPanel,d=RHtml.offsetPosition(b);return new TRange(d.x,d.y,b.offsetWidth,b.offsetHeight)}
function FCellEditControl_select(b){var d=this.descriptor().isEditAble(this.row);b?RClass.isClass(this,FCellCalendar)?(this.setEditStyle(EStyle.ReadonlySelect),this.column.disable()):this.setEditStyle(d?EStyle.Select:EStyle.ReadonlySelect):RClass.isClass(this,FCellCalendar)?(this.setEditStyle(EStyle.Readonly),this.column.disable()):this.setEditStyle(d?EStyle.Normal:EStyle.Readonly)}
function FCellEditControl_setVisible(b){this.hPanel.style.display=b?"block":"none";b&&(RClass.isClass(this,FCellCalendar)?(this.setEditStyle(EStyle.Readonly),this.column.disable()):(b=this.descriptor().isEditAble(this.row),this.setEditStyle(b?EStyle.Normal:EStyle.Readonly)))}
function FCellEditControl_refreshStyle(){var b=this.table,d=this.column,f=this.row,h=this.hEditPanel,q=this.hEdit,z=this.hDrop,A=d.isEditAble(f),B=f.isSelect,C=A?EColor.TextEdit:EColor.TextReadonly;q&&(q.readOnly=!A,d.zoomRefer||(q.style.color=C),z&&(q.style.cursor=A?"hand":"normal",z.style.cursor=A?"hand":"normal"));h&&(h.style.color=C);d=null;d=B?EColor.RowSelect:b.__hoverRow==f?EColor.RowHover:EColor.Rows[f.index%EColor.Rows.length];this.__focus&&(d=EColor.RowEditHover);q&&(q.style.backgroundColor=
d);this.hPanel.style.backgroundColor=d}function FCellSelected(b){b=RClass.inherits(this,b,FCell);b._dataName="_select";b._styleEdit=RClass.register(b,new AStyle("_styleEdit"));b._hSelected=null;b.onBuild=FCellSelected_onBuild;b.onSelected=FCellSelected_onSelected;return b}function FCellSelected_onBuild(b){this.__base.FCell.onBuild.call(this,b);b=this._hPanel;b.align="center";b=this._hSelected=RBuilder.appendCheck(b,this.styleName("Edit"));b.parent=this;b.onclick=this.onSelected}
function FCellSelected_onSelected(b){}function FCellSelected_refreshStyle(){var b=this.row;b.table.dispSelected?(this.hPanel.style.display="block",b.isSelect?(this._hSelected.checked=!0,this.hPanel.style.backgroundColor="#CEE7FF"):(this._hSelected.checked=!1,this.hPanel.style.backgroundColor="#FFFFFF")):this.hPanel.style.display="none"}function FCellSelected_dispose(){this.base.FCellEditControl.dispose.call(this);this._hSelected=null}
function FCellStatus(b){b=RClass.inherits(this,b,FCell);b._dataName="_status";b._hStatus=null;b.onBuild=FCellStatus_onBuild;return b}function FCellStatus_onBuild(b){this.__base.FCell.onBuild.call(this,b);b=this._hPanel;b.align="center";b.style.paddingTop=2;b.style.paddingBottom=2;b.style.cursor="normal";this._hStatus=RBuilder.appendIcon(b,null,"n")}function FCellStatus_onStatusEnter(){this.row.table.getRowBar().linkCell(this)}function FCellStatus_setIcon(b){this._hStatus.src=b}
function FCellStatus_refreshStyle(){var b=this.row,d=b.table,f=null,f=b.isDataChanged()?"Changed":(d.isFormLinked(),"Normal");this.setIcon(this.column.styleIconPath(f))}function FCellStatus_dispose(){this.base.FCellEditControl.dispose.call(this);this._hStatus=null}
function FColumn(b){b=RClass.inherits(this,b,FControl,MDataField);b._displayList=!0;b._styleLabel=RClass.register(b,new AStyle("_styleLabel"));b._styleSearchPanel=RClass.register(b,new AStyle("_styleSearchPanel"));b._styleSearchEdit=RClass.register(b,new AStyle("_styleSearchEdit"));b._styleIconSortUp=RClass.register(b,new AStyleIcon("_styleIconSortUp"));b._styleIconSortDown=RClass.register(b,new AStyleIcon("_styleIconSortDown"));b._cellClass=FCell;b._hForm=null;b._hFormLine=null;b._hIconPanel=null;
b._hIcon=null;b._hLabel=null;b._hSortPanel=null;b._hSortUp=null;b._hSortDown=null;b._hSearchEditPanel=null;b._hSearchEdit=null;b.onBuildLabel=FColumn_onBuildLabel;b.onBuildSearchIcon=RMethod.empty;b.onBuildSearchEdit=FColumn_onBuildSearchEdit;b.onBuildSearchDrop=RMethod.empty;b.onBuildSearchForm=FColumn_onBuildSearchForm;b.onBuildSearch=FColumn_onBuildSearch;b.onBuildTotal=FColumn_onBuildTotal;b.onBuildPanel=FColumn_onBuildPanel;b.onBuild=FColumn_onBuild;b.onSearchEnter=RClass.register(b,new AEventMouseEnter("onSearchEnter"));
b.onSearchClick=RClass.register(b,new AEventClick("onSearchClick"));b.onSearchLeave=RClass.register(b,new AEventMouseLeave("onSearchLeave"));b.onSearchKeyDown=RClass.register(b,new AEventKeyDown("onSearchKeyDown"));b.createCell=FColumn_createCell;return b}
function FColumn_onBuildLabel(b){b=this._hFormLine;if(this._icon){var d=this._hIconPanel=RBuilder.appendTableCell(b);this._hIcon=RBuilder.appendIcon(d,this.icon)}(this._hLabel=RBuilder.appendTableCell(b)).innerHTML=RString.nvl(this.label());b=this._hSortPanel=RBuilder.appendTableCell(b);d=this._hSortUp=RBuilder.appendIcon(b,this.styleIcon("SortUp",FColumn));d.style.display="none";d=this._hSortDown=RBuilder.appendIcon(b,this.styleIcon("SortDown",FColumn));d.style.display="none"}
function FColumn_onBuildSearchEdit(b){b=this._hSearchEditPanel=RBuilder.appendTableCell(this._hSearchFormLine,this.styleName("SearchPanel"));this._hSearchEdit=RBuilder.appendEdit(b,this.styleName("SearchEdit"))}
function FColumn_onBuildSearchForm(b){b=this._hSearchForm=RBuilder.appendTable(this._hSearchPanel);b.width="100%";b.style.backgroundColor="#FFFFFF";this._hSearchFormLine=b.insertRow();RClass.isClass(this,FColumnButton)?(this._hSearchPanel.style.backgroundColor="#EEEFF1",this._hSearchPanel.style.borderLeft="1 solid #808080",this._hSearchPanel.style.borderTop="1 solid #808080",this._hSearchPanel.style.borderBottom="1 solid #9EC4EB"):(this.onBuildSearchIcon(),this.onBuildSearchEdit(),this.onBuildSearchDrop())}
function FColumn_onBuildSearch(b){var d=this._hSearchPanel=RBuilder.create(b,"TD",this.styleName("SearchPanel"));d.style.backgroundColor="#FFFFFF";d.style.borderBottom="1 solid #9EC4EB";RHtml.linkSet(d,"control",this);this.attachEvent("onSearchEnter",d);this.attachEvent("onSearchLeave",d);this.onBuildSearchForm(b)}
function FColumn_onBuildTotal(b){b=this._hTotalPanel=RBuilder.create(b,"TD");RHtml.linkSet(b,"control",this);b.align="right";b.style.color="#686860";b.style.backgroundColor="#F8F8F0";b.style.borderBottom="1 solid #B8B8B0";b.innerText=" "}function FColumn_onBuildPanel(b){this._hPanel=RBuilder.create(b,"TD",this.styleName("Label"))}
function FColumn_onBuild(b){this._absEdit=this._editInsert||this._editUpdate||this._editDelete;this._absEdit||(RString.isEmpty(this._lovReference)?this._hasDropArea=!1:this._hasDropArea=!0);if(!RString.isEmpty(this._viewIcons)){var d=this.iconMap=new TAttributes;d.split(this._viewIcons.replace(/\n/g,";"),"=",";");this.hasIconArea=0<d.count}this.__base.FControl.onBuild.call(this,b);d=this._hPanel;d.style.padding=4;d=this._hForm=RBuilder.appendTable(d);this._orderAble||(d.style.cursor="hand");this._hFormLine=
RBuilder.appendTableRow(this._hForm);this.onBuildLabel(b);this.onBuildSearch(b);this.onBuildTotal(b);b=this._hFixPanel=RBuilder.create(b,"TD");b.height=1;b.bgColor="#FFFFFF";40>this._size.width&&(this._size.width=40);RHtml.setSize(b,this._size);this._hPanel.style.pixelWidth=this.width;this._hFixPanel.style.pixelWidth=this.width}
function FColumn_createCell(b){b=RClass.create(this._cellClass);var d=b._table=this._table;b._name=this._name;b._column=this;b.build(d._hPanel);b.setVisible(this._displayList);return b}function FColumn_onCellMouseEnter(b,d){this.table.hoverRow(b.row,!0)}function FColumn_onCellMouseLeave(b,d){this.table.hoverRow(b.row,!1)}
function FColumn_onCellMouseDown(b,d){var f=b.table,h=b.row;f.__focusCell=b;f.selectRow(h,!d.ctrlKey,!0);f=RConsole.find(FFocusConsole).focusControl;RClass.isClass(f,FDropEditor)&&f.source==b||RConsole.find(FFocusConsole).focus(b)}function FColumn_onCellClick(b,d){this.table.clickRow(b.row)}function FColumn_onCellDoubleClick(b,d){var f=b.row;this.isEditAble(f)||this.table.doubleClickRow(f)}function FColumn_onCellKeyDown(b,d,f){if(f)this.table.onCellKeyDown(b,d,f)}
function FColumn_oeMode(b){if(b.isAfter()){var d=!1;this.inModeDisplay=d=EAction.Design==b.mode?this.dispDesign:this._displayList;this.setVisible(d)}return EEventStatus.Continue}function FColumn_oeRefresh(b){b.isBefore()&&this.setVisible(this._displayList)}function FColumn_onDataKeyDown(b,d){this.__base.MEditDescriptor.onDataKeyDown.call(this,b,d)}function FColumn_onDataChanged(b,d){this.table.setDataStatus(b.row,EDataStatus.Update)}
function FColumn_onEditBegin(b){var d=b.row;this.editor=b;this.table.editRow=d;this.table.editColumn=this;this.table.select(d,!0);RLogger.debug(this,"Edit begin (column={1} row={2} editor={3})",this.name,RClass.dump(d),RClass.dump(b))}
function FColumn_onEditEnd(b){b=editor.row;var d=editor.text();this.setValue(b,this.formatValue(d));this.setText(b,d);this.table.setDataStatus(b,b.isChanged()?EDataStatus.Update:EDataStatus.Unknown);this.editor=null;RLogger.debug(this,"{1}={2}\n{3}\n{4}",RClass.dump(editor),this.formatValue(d),this.dump(),b.dump())}function FColumn_onEditChanged(b){b.row.refresh()}
function FColumn_onHeadMouseDown(b){var d=this.table,f=d.dsViewer.count,h=b.x;if(!RClass.isClass(this,FColumnButton)){var q=this._hPanel.offsetWidth-6;if(0<h&&h<q&&0<f&&!RClass.isClass(b.source,FColumnStatus)){f=d.columns;h=f.count;for(b=0;b<h;b++)q=f.value(b),q._hSortUp.style.display="none",q._hSortDown.style.display="none";d.dsOrders.clear();f=new TOrderItem;b=this.dataName;this.sortType?(f.set(b,EOrder.Desc),this._hSortUp.style.display="none",this._hSortDown.style.display="block"):(this._hSortUp.style.display=
"block",this._hSortDown.style.display="none",f.set(b,EOrder.Asc));this.sortType=!this.sortType;d.dsOrders.push(f);d.dsSearch()}}}function FColumn_onRowClick(b,d){RConsole.find(FListenerConsole).process(FGridControl,EGridAction.RowClick,b.row,b.row)}
function FColumn_createMoveable(b){b=this.cloneMove;b||(b=RClass.create(this.constructor),b.buildMode=EColumnMode.Drag,b.assign(this,EAssign.Property),b.build(),this.cloneMove=b);var d=this.panel(EPanel.Move),f=b.panel(EPanel.Move);RHtml.setPixelRect(f,RHtml.rect(d));f.className=b.styleName("DesignMove");f.style.pixelLeft=d.offsetLeft;b.show();return b}function FColumn_searchValue(){if(this._hSearchEdit)return this._hSearchEdit.value}
function FColumn_setStyleStatus(b,d){var f=this.cell(b);if(f)switch(f=f.style,d){case EStyle.Normal:b.isDelete()?f.backgroundColor=EColor.Delete:this.isEditAble(b)?f.backgroundColor=EColor.Edit:f.backgroundColor=EColor.Readonly;break;case EStyle.Select:b.isDelete()?f.backgroundColor=EColor.Select:(f.textDecoration="none",this.isEditAble(b)?f.backgroundColor=EColor.RowEditSelect:f.backgroundColor=EColor.Select);break;case EStyle.Delete:f.textDecoration="line-through",f.backgroundColor=EColor.Select}}
function FColumn_cell(b){return b.cell(this.index)}function FColumn_equalsValue(b,d){return RString.nvl(b).replace(/\n/g,"\\n").replace(/\r/g,"\\r")==RString.nvl(d).replace(/\n/g,"\\n").replace(/\r/g,"\\r")}function FColumn_setWidth(b){this._hPanel.style.pixelWidth=b;this._hFixPanel.style.pixelWidth=b}function FColumn_setVisible(b){b=(this.isDisplay=b)?"block":"none";this._hPanel.style.display=b;this._hSearchPanel.style.display=b;this._hTotalPanel.style.display=b;this._hFixPanel.style.display=b}
function FColumn_moveCellFocus(b,d){var f=this.table,h=null,q=null,z=null;if(EPosition.Top==d)h=this,(q=f.rows.get(f.rows.indexOf(b)-1))&&(z=q.cell(h.index));else if(EPosition.Bottom==d)h=this,(q=f.rows.get(f.rows.indexOf(b)+1))&&(z=q.cell(h.index));else if(EPosition.Before==d)for(var A=this.index-1,B=f.rows.indexOf(b);0<=B;B--){for(var C=f.rows.get(B);0<=A;A--){var D=f.columns.value(A);if(RClass.isClass(D,FColumn)&&D._displayList){h=D;q=C;z=q.cell(h.index);break}}if(h)break;A=f.columns.count-1}else if(EPosition.After==
d)for(var A=this.index+1,B=f.rows.indexOf(b),E=f.columns.count,F=f.rows.count;B<F;B++){for(C=f.rows.get(B);A<E;A++)if(D=f.columns.value(A),RClass.isClass(D,FColumn)&&D._displayList){h=D;q=C;z=q.cell(h.index);break}if(h)break;A=0}h&&q&&z&&(z.focus(!0),RConsole.find(FFocusConsole).focus(z))}function FColumn_getEditRange(){var b=this._hSearchPanel,d=RHtml.offsetPosition(b);return new TRange(d.x,d.y,b.offsetWidth,b.offsetHeight)}
function FColumn_dispose(){this.__base.FControl.dispose.call(this);RMemory.freeHtml(this._hSearchPanel);RMemory.freeHtml(this._hFixPanel);this._hFixPanel=this._hSearchDrop=this._hSearchDropPanel=this._hSearchEdit=this._hSearchEditPanel=this._hSearchIcon=this._hSearchIconPanel=this._hSearchFormLine=this._hSearchForm=this._hSearchPanel=this._hSortDown=this._hSortUp=this._hSortPanel=this._hLabel=this._hHeadPanel=this._hIcon=this._hIconPanel=this._hFormLine=this._hForm=null}
function FColumn_dump(b){b=RString.nvlStr(b);b.append(RClass.dump(this),"[");b.append("name=",this.name);b.appendIf(this.icon,",icon=",this.icon);b.appendIf(this.label,",label=",this.label);b.appendIf(this.align,",align=",this.align);b.appendIf(this.valign,",valign=",this.valign);b.appendIf(this.dataName,",dataName=",this.dataName);b.appendIf(this.dataDefault,",dataDefault=",this.dataDefault);b.appendIf(this.index,",index=",this.index);b.append("]");b.append(" [editAccess=");b.append(this.editInsert?
"I":"_");b.append(this.editUpdate?"U":"_");b.append("]");return b}function FColumnButton(b){b=RClass.inherits(this,b,FColumn);b.__cellClass=FCellButton;return b}function FColumnEdit(b){b=RClass.inherits(this,b,FColumnEditControl,MPropertyEdit);b._cellClass=FCellEdit;return b}function FColumnEdit_onCellMouseEnter(b,d){}function FColumnEdit_onCellMouseLeave(b,d){}function FColumnEdit_onListClick(b,d){this.table.__focusCell=b;var f=b.row.saveRow().toAttributes();this.doListView(f)}
function FColumnEdit_onZoomHover(b,d){b.hEdit.style.color="black"}function FColumnEdit_onZoomLeave(b,d){b.hEdit.style.color="blue"}function FColumnEdit_onZoomClick(b,d){this.table.clickRow(b.row);var f=b.row.saveRow().get(this.zoomField);RString.isEmpty(f)||this.doZoom(f)}function FColumnEditControl(b){b=RClass.inherits(this,b,FColumn);b.isEditAble=FColumnEditControl_isEditAble;return b}
function FColumnEditControl_isEditAble(b){if(b)return ERowStatus.Insert==b.status?this.editInsert:this.editUpdate}function FColumnEmpty(b){b=RClass.inherits(this,b,FColumn);b._dispList=!0;b.onBuildSearchForm=RMethod.empty;return b}
function FColumnSelected(b){b=RClass.inherits(this,b,FColumnEditControl);b._dataName="_select";b._styleEdit=RClass.register(b,new AStyle("_styleEdit"));b._optionFixed=!0;b._cellClass=FCellSelected;b.onBuildSearchForm=FColumnSelected_onBuildSearchForm;b.onBuild=FColumnSelected_onBuild;b.createCell=FColumnSelected_createCell;b.dispose=FColumnSelected_dispose;return b}
function FColumnSelected_onBuildSearchForm(b){b=this._hSearchForm=RBuilder.appendTable(this._hSearchPanel);b.width="100%";b=this._hSearchFormLine=RBuilder.appendTableRow(b);b=RBuilder.appendTableCell(b);b.align="center";this._hSelected=RBuilder.appendCheck(b,this.styleName("Edit"));this._hSelected.column=this;this._hSelected.onclick=this.onSelectedClick}
function FColumnSelected_onBuild(b){b=this.__base.FColumnEditControl.onBuild.call(this,b);var d=this._hPanel;d.align="center";d.style.width="30px";d.style.height="22px";RBuilder.appendEmpty(this._hPanel,12,12);return b}function FColumnSelected_createCell(b){var d=this.__base.FColumnEditControl.createCell.call(this,b);b&&(b.cellSelect=d);return d}function FColumnSelected_dispose(){this._hSelect=null;this.__base.FColumnEditControl.dispose.call(this)}
function FColumnSelected_setVisible(){var b=this._table._displayColumnSelect?"block":"none";this._hPanel.style.display=b;this._hSelected.style.display=b;this._hSearchPanel.style.display=b;this._hTotalPanel.style.display=b;this._hFixPanel.style.display=b}function FColumnSelected_onCellClick(b,d){}
function FColumnSelected_onSelectedClick(b,d){for(var f=this.column,h=f.table.rows,q=h.count,z=0;z<q;z++){var A=h.get(z);A.selectAble&&(this.checked?f.table.selectRow(A,!1,!0):f.table.clearSelectRow(A))}}function FColumnStatus(b){b=RClass.inherits(this,b,FColumnEditControl);b._dataName="_status";b._optionFixed=!0;b._cellClass=FCellStatus;b.onBuildSearchForm=FColumnStatus_onBuildSearchForm;b.onBuild=FColumnStatus_onBuild;b.createCell=FColumnStatus_createCell;return b}
function FColumnStatus_onBuildSearchForm(b){b=this._hSearchForm=RBuilder.appendTable(this._hSearchPanel);b.height=18;b.width="100%";b=this._hSearchFormLine=RBuilder.appendTableRow(b);RBuilder.appendTableCell(b).align="center"}function FColumnStatus_onBuild(b){this.__base.FColumnEditControl.onBuild.call(this,b);b=this._hPanel;b.align="center";b.style.width="30px";b.style.height="22px";RBuilder.appendEmpty(b,12,12)}
function FColumnStatus_createCell(b){var d=this.__base.FColumnEditControl.createCell.call(this,b);b&&(b._statusCell=d);return d}function FColumnStatus_onCellClick(b,d){this.table.callEvent("onTableRowDoubleClick",b.row)||RConsole.find(FListenerConsole).process(FGridControl,EGridAction.RowClick,b.row,b.row)}
function FColumnStatus_setDataStatus(b,d){var f=this.table,h=b.getStatus(),q=null;switch(d){case EDataStatus.Insert:q="Insert";break;case EDataStatus.Delete:q="Delete";break;default:q=b.isDataChanged()?"Changed":f.isFormLinked()?"NormalEnter":"Normal"}h.setIcon(this.styleIconPath(q))}function FColumnStatus_ohCellMdclk(){this.lnkCol.table.insertRow(this.lnkRow.rowIndex())}function FColumnStatus_dispose(){this.__base.FColumnEditControl.dispose.call(this);this._hSelect=null}
function FGrid(b){b=RClass.inherits(this,b,FGridControl);b.onResizeAfter=FGrid_onResizeAfter;b.onBuildData=FGrid_onBuildData;b.oeResize=FGrid_oeResize;b.oeRefresh=FGrid_oeRefresh;b.pushColumn=FGrid_pushColumn;return b}function FGrid_onResizeAfter(){var b=this.hDataPanel,d=this.hFixPanel,f=RHtml.scrollWidth(b),h=RHtml.scrollHeight(b);this.hHeadPanel.style.pixelWidth=b.offsetWidth-d.offsetWidth-f;this.hColumnPanel.style.pixelHeight=b.offsetHeight-d.offsetHeight-h+1}
function FGrid_onBuildData(){var b=o.hFixPanel=RBuilder.appendDiv(hbp);b.style.zIndex=2;b.style.position="absolute";var b=o.hFixForm=RBuilder.appendTable(b,null,1),d=RBuilder.append(b,"TBODY");b.style.tableLayout="fixed";b.frame="rhs";b.borderColorLight="#29BAD5";b.borderColorDark="#EEEEEE";o.hFixHead=RBuilder.append(d,"TR");o.hFixSearch=RBuilder.append(d,"TR");b=o.hHeadPanel=RBuilder.appendDiv(hbp);b.style.zIndex=1;b.style.position="absolute";b.style.overflowX="hidden";b.style.width=1;b=o.hHeadForm=
RBuilder.appendTable(b,null,1);b.frame="rhs";b.style.tableLayout="fixed";b.borderColorLight="#29BAD5";b.borderColorDark="#EEEEEE";o.hHead=b.insertRow();o.hSearch=b.insertRow();b=o.hColumnPanel=RBuilder.appendDiv(hbp,o.style("DataPanel"));b.style.zIndex=1;b.style.position="absolute";b.style.overflowY="hidden";b=o.hColumnForm=RBuilder.appendTable(b,o.style("DataForm"),0,0,1);o.hFixRows=RBuilder.append(b,"TBODY");o.hFixRowLine=RBuilder.append(o.hFixRows,"TR");b=o.hDataPanel=RBuilder.appendDiv(hbp,o.style("DataPanel"));
b=o.hDataForm=RBuilder.appendTable(b,o.style("DataForm"),0,0,1);o.hRows=RBuilder.append(b,"TBODY");o.hRowLine=RBuilder.append(o.hRows,"TR");o.attachEvent("onHeadMouseDown",o.hHeadForm,o.onHeadMouseDown);o.attachEvent("onHeadMouseMove",o.hHeadForm,o.onHeadMouseMove);o.attachEvent("onHeadMouseUp",o.hHeadForm,o.onHeadMouseUp);o.attachEvent("onDataScroll",o.hDataPanel,o.onDataScroll)}
function FGrid_oeResize(b){b=this.hPanel;if(b.offsetWidth&&b.offsetHeight){b=this.hTitleForm;var d=this.hFixPanel,f=this.hHeadPanel,h=this.hColumnPanel,q=this.hDataPanel;f.style.display=h.style.display=q.style.display="none";var z=this.hBorderPanel.offsetWidth,A=this.hBorderPanel.offsetHeight;f.style.display=h.style.display=q.style.display="block";f.style.pixelWidth=z-d.offsetWidth;h.style.pixelHeight=A-d.offsetHeight-1-b.offsetHeight;q.style.pixelWidth=z;q.style.pixelHeight=A-b.offsetHeight;this.dpScrollLeft&&
(q.scrollLeft=this.dpScrollLeft,this.dpScrollLeft=null);RConsole.find(FEventConsole).push(this.eventResizeAfter);return EEventStatus.Stop}}
function FGrid_oeRefresh(b){this.base.FGridControl.oeRefresh.call(this,b);if(b.isAfter()){var d=this.hFixPanel,f=this.hHeadPanel,h=this.hColumnPanel,q=this.hDataPanel,z=this.hTitleForm.offsetHeight,A=d.offsetWidth,B=d.offsetHeight;h.style.display=q.style.display="none";b=this.hBorderPanel.offsetWidth;var C=this.hBorderPanel.offsetHeight;h.style.display=q.style.display="block";d.style.pixelTop=z;f.style.pixelTop=z;f.style.pixelLeft=A;f.style.pixelWidth=b-A;f.style.pixelHeight=B;this.hHead.style.pixelHeight=
this.hFixHead.offsetHeight;this.hSearch.style.pixelHeight=this.hFixSearch.offsetHeight;h.style.pixelTop=z+B;h.style.pixelHeight=C-z-B;q.style.paddingLeft=A;q.style.paddingTop=B;q.style.pixelWidth=b;q.style.pixelHeight=C-z;d=null;f=this.columns;for(h=0;h<f.count;h++)if(q=f.value(h),q.isDisplay)if(q.dispAuto){if(d)return RMessage.fatal(this,null,"Too many auto column! (name1={0},name2={1})",d.name,q.name);d=q}else b-=q.hPanel.offsetWidth;d&&d.setWidth(Math.max(b-2,d.width?d.width:120))}}
function FGrid_pushColumn(b){b.dispFixed?(this.hFixHead.appendChild(b.hPanel),this.hFixSearch.appendChild(b.hSearchPanel),this.hFixRowLine.appendChild(b.hFixPanel)):(this.hHead.appendChild(b.hPanel),this.hSearch.appendChild(b.hSearchPanel),this.hRowLine.appendChild(b.hFixPanel));this.push(b)}
function FGridRow(b){b=RClass.inherits(this,b,FGridRowControl);b._hFixPanel=null;b.onBuildPanel=FGridRow_onBuildPanel;b.setVisible=FGridRow_setVisible;b.appendChild=FGridRow_appendChild;b.dispose=FGridRow_dispose;return b}function FGridRow_onBuildPanel(b){this.__base.FGridRowControl.onBuildPanel.call(this,b);this._hFixPanel=RBuilder.createTableRow(b,this.styleName("Panel"))}
function FGridRow_setVisible(b){this._visible=b;var d=this._hFixPanel;d&&RHtml.displaySet(d,b);(d=this._hPanel)&&RHtml.displaySet(d,b)}function FGridRow_appendChild(b){this.__base.FGridRowControl.appendChild.call(this,b);b._column._optionFixed&&this._hFixPanel.appendChild(b._hPanel)}function FGridRow_dispose(){var b=this._hFixPanel;b&&(RMemory.free(b),this._hFixPanel=null);this.__base.FGridRowControl.dispose.call(this)}
function FGridRow_select(b){b=(this.isSelect=b)?EColor.RowSelect:EColor.Row;this._hFixPanel.style.backgroundColor=b;this.hPanel.style.backgroundColor=b;this.refreshStyle()}function FGridRow_refreshSize(){this.hPanel.style.pixelHeight=this._hFixPanel.offsetHeight}
function FGridRow_refreshStyle(){this.hPanel.offsetHeight>this._hFixPanel.offsetHeight?this._hFixPanel.style.pixelHeight=this.hPanel.offsetHeight:this.hPanel.style.pixelHeight=this._hFixPanel.offsetHeight;this.table.isLov&&(this._hFixPanel.style.cursor="hand");this.__base.FGridRowControl.refreshStyle.call(this)}
function FGridRowControl(b){b=RClass.inherits(this,b,FContainer,MDataContainer);b._cells=null;b._rows=null;b._clearProcess=null;b._resetProcess=null;b._loadProcess=null;b._saveProcess=null;b._recordProcess=null;b._statusCell=null;b.onBuildPanel=FGridRowControl_onBuildPanel;b.onBuild=FGridRowControl_onBuild;b.construct=FGridRowControl_construct;b.loadRow=FGridRowControl_loadRow;b.saveRow=FGridRowControl_saveRow;b.setVisible=FGridRowControl_setVisible;b.appendChild=FGridRowControl_appendChild;b.push=
FGridRowControl_push;return b}function FGridRowControl_onBuildPanel(b){this._hPanel=RBuilder.createTableRow(b,this.styleName("Panel"))}function FGridRowControl_onBuild(b){this.__base.FContainer.onBuild.call(this,b);b=this._table._columns;for(var d=b.count(),f=0;f<d;f++){var h=b.value(f).createCell();this.push(h)}}
function FGridRowControl_construct(){this.__base.FContainer.construct.call(this);this._cells=new TDictionary;this._rows=new TObjects;this._clearProcess=new TEventProcess(null,this,"oeClearValue",MEditValue);this._resetProcess=new TEventProcess(null,this,"oeResetValue",MEditValue);this._loadProcess=new TEventProcess(null,this,"oeLoadValue",MEditValue);this._saveProcess=new TEventProcess(null,this,"oeSaveValue",MEditValue);this._recordProcess=new TEventProcess(null,this,"oeRecordValue",MEditValue)}
function FGridRowControl_loadRow(b){var d=RClass.create(FDataSource);d.selectRow(b);this.dsDataLoad(d)}function FGridRowControl_saveRow(b){return r}function FGridRowControl_setVisible(b){this._visible=b;var d=this._hPanel;d&&RHtml.displaySet(d,b)}function FGridRowControl_appendChild(b){this.__base.FContainer.appendChild.call(this,b);b._column._optionFixed||this._hPanel.appendChild(b._hPanel)}
function FGridRowControl_push(b){this.__base.FContainer.push.call(this,b);b._row=this;this._cells.set(b._column._dataName,b);RClass.isClass(b,FCellStatus)&&(this._statusCell=b)}
function FGridRowControl_buildChildren(){var b=this.hFixPanel=hfp.insertRow(idx);b.className=this.style("Panel");var d=this._hPanel=hp.insertRow(idx);d.className=this.style("Panel");for(var f=this.table.columns,h=f.count,q=0;q<h;q++){var z=f.value(q),A=z.createCell(this);z.dispFixed?b.appendChild(A._hPanel):d.appendChild(A._hPanel);this._cells.set(z.dataName,A)}this.doRefresh()}
function FGridRowControl_isDataChanged(){for(var b=this._cells,d=b.count-1;0<=d;d--)if(b.value(d).isDataChanged())return!0;return!1}function FGridRowControl_isVisible(){return this._visible}function FGridRowControl_getIndex(){return this._hPanel.rowIndex}function FGridRowControl_getId(){var b=this._cells.get("ouid");return b?b.reget():""}function FGridRowControl_getVersion(){var b=this._cells.get("over");return b?b.reget():""}function FGridRowControl_getStatus(){return this._statusCell}
function FGridRowControl_cell(b){return this._cells.value(b)}function FGridRowControl_get(b){return this._cells.get(b).get()}function FGridRowControl_reget(b){return this._cells.get(b).reget()}function FGridRowControl_set(b,d){this._cells.get(b).set(d)}function FGridRowControl_loadValue(b){this.loadRow(b)}function FGridRowControl_saveValue(b){this.saveRow(b)}function FGridRowControl_recordValue(){this.process(this._recordProcess)}function FGridRowControl_toAttributes(b){this.saveRow(b)}
function FGridRowControl_toDeepAttributes(b){for(var d=new TList,f=this.table;f;){f!=this.table&&RClass.isClass(f,MDataset)&&d.push(f);if(!f.parent)break;f=f.topControl(MDataset)}for(f=d.count-1;0<=f;f--){var h=d.get(f);if(RClass.isClass(h,FForm))h.toAttributes(b);else if(RClass.isClass(h,FTable)){h=h.getSelectRows();if(1!=h.count)return RMessage.fatal(this,"Invalid selected rows. (count={0})",h.count);h.get(0).toAttributes(b)}}this.toAttributes(b)}
function FGridRowControl_select(b){this.isSelect=b;this._hPanel.style.backgroundColor=b?EColor._rowselect:EColor.Row;this.refreshStyle()}function FGridRowControl_extend(b){var d=this._rows;if(d&&d.count)for(var f=d.count,h=0;h<f;h++){var q=d.get(h);b?(q.setVisible(!0),q.extend(q.extended)):q.setVisible(!1);q.refresh()}this.extended=b}function FGridRowControl_doInsert(){this.row||(this.row=new TRow);this.status=ERowStatus.Insert;this.table.setDataStatus(this,ERowStatus.Insert)}
function FGridRowControl_doDelete(){this.status=ERowStatus.Delete;this.table.setDataStatus(this,ERowStatus.Delete)}function FGridRowControl_refresh(){this.table.setDataStatus(this,this.isDataChanged()?ERowStatus.Changed:ERowStatus.Normal)}function FGridRowControl_refreshStyle(){var b=this._cells;if(b)for(var d=b.count-1;0<=d;d--)b.value(d).refreshStyle()}
function FGridRowControl_dump(b){b=RString.nvlStr(b);b.append(RClass.dump(this),"[");b.append(this.isSelect?"S":"_");b.append("]");b.append(this.saveRow().dump());return b}
function FUiGridControl(b){b=RClass.inherits(this,b,FUiContainer);b._displayCount=RClass.register(b,new APtyInteger("_displayCount"),20);b._displayTitle=RClass.register(b,new APtySet("_displayTitle","display_title",EGridDisplay.Title),!0);b._displayColumnStatus=!0;b._displayColumnSelect=!0;b._rowHeight=RClass.register(b,new APtyInteger("rowHeight"),0);b._stylePanel=RClass.register(b,new AStyle("_stylePanel"));b._styleTitlePanel=RClass.register(b,new AStyle("_styleTitlePanel"));b._styleTitleForm=RClass.register(b,
new AStyle("_styleTitleForm"));b._styleCaption=RClass.register(b,new AStyle("_styleCaption"));b._styleContentPanel=RClass.register(b,new AStyle("_styleContentPanel"));b._styleContentForm=RClass.register(b,new AStyle("_styleContentForm"));b._styleHintPanel=RClass.register(b,new AStyle("_styleHintPanel"));b._styleHintForm=RClass.register(b,new AStyle("_styleHintForm"));b._styleHint=RClass.register(b,new AStyle("_styleHint"));b._styleButton=RClass.register(b,new AStyle("_styleButton"));b._minHeight=
80;b._buttons=null;b._columns=null;b._rowClass=FGridRow;b._rows=null;b._focusCell=null;b._focusRow=null;b._loadEvent=null;b._hTitlePanel=null;b._hTitleForm=null;b._hTitleLine=null;b._hCaption=null;b._hContentPanel=null;b._hHintPanel=null;b._hHintForm=null;b.lsnsRowClick=null;b.lsnsRowDblClick=null;b.onBuildTitle=FUiGridControl_onBuildTitle;b.onBuildContent=RMethod.virtual(b,"onBuildContent");b.onBuildHint=FUiGridControl_onBuildHint;b.onBuildPanel=FUiGridControl_onBuildPanel;b.onBuild=FUiGridControl_onBuild;
b.onDatasetLoadDelay=FUiGridControl_onDatasetLoadDelay;b.onDatasetLoad=FUiGridControl_onDatasetLoad;b.construct=FUiGridControl_construct;b.buildNavigatorButton=FUiGridControl_buildNavigatorButton;b.appendColumn=RMethod.virtual(b,"appendColumn");b.appendChild=FUiGridControl_appendChild;b.push=FUiGridControl_push;b.createRow=FUiGridControl_createRow;b.insertRow=FUiGridControl_insertRow;b.syncRow=FUiGridControl_syncRow;b.hideRows=FUiGridControl_hideRows;b.clickCell=FUiGridControl_clickCell;b.clickRow=
FUiGridControl_clickRow;b.doubleClickRow=FUiGridControl_doubleClickRow;return b}function FUiGridControl_onBuildPanel(b){this._hPanel=RBuilder.createTable(b,this.styleName("Panel"))}function FUiGridControl_onBuildTitle(b){b=this._hTitleForm=RBuilder.appendTable(this._hTitlePanel,this.styleName("TitleForm"));var d=this._hTitleLine=RBuilder.appendTableRow(b);(this._hCaption=RBuilder.appendTableCell(d,this.styleName("Caption"))).innerText=this.label();RHtml.displaySet(b,this._displayTitle)}
function FUiGridControl_onBuildHint(b){b=RBuilder.appendTableRow(this._hHintForm);var d=RBuilder.appendTableCell(b);d.width=60;this.hExtendButton=this.buildNavigatorButton(d,"control.grid.extend","&nbsp;\u5c55\u5f00",null,"hExtend");d=RBuilder.appendTableCell(b);d.width=60;this.hInsertButton=this.buildNavigatorButton(d,"control.grid.insert","&nbsp;\u65b0\u5efa",null,"hInsert");d=RBuilder.appendTableCell(b);d.width=10;d=RBuilder.appendTableCell(b);d.noWrap=!0;this._hHint=RBuilder.appendText(d,this.styleName("Hint"));
d=RBuilder.appendTableCell(b);d.noWrap=!0;d.align="right";this.hNavFirst=this.buildNavigatorButton(d,"control.grid.first","&nbsp;"+RContext.get("FUiGridControl:First"));this.hNavPrior=this.buildNavigatorButton(d,"control.grid.prior","&nbsp;"+RContext.get("FUiGridControl:Prior"));this.hNavPrior.style.paddingRight="20";this.hPage=RBuilder.appendEdit(d);this.hPage.style.width=40;this.hNavNext=this.buildNavigatorButton(d,null,RContext.get("FUiGridControl:Next")+"&nbsp;","control.grid.next");this.hNavLast=
this.buildNavigatorButton(d,null,RContext.get("FUiGridControl:Last")+"&nbsp;","control.grid.last")}
function FUiGridControl_onBuild(b){if(!this._size.height||160>this._size.height)this.height="100%";this.__base.FUiContainer.onBuild.call(this,b);this._hTitlePanel=RBuilder.appendTableRowCell(this._hPanel,this.styleName("TitlePanel"));this.onBuildTitle(b);this._hContentPanel=RBuilder.appendTableRowCell(this._hPanel,this.styleName("ContentPanel"));this.onBuildContent(b);this._hHintPanel=RBuilder.appendTableRowCell(this._hPanel,this.styleName("HintPanel"));this._hHintForm=RBuilder.appendTable(this._hHintPanel,
this.styleName("HintForm"));this.onBuildHint(b);var d=this._statusColumn=RClass.create(FColumnStatus);d._table=this;d._name="_s";d.build(b);this.push(d);d=this._selectColumn=RClass.create(FColumnSelected);d._table=this;d._name="_select";d.build(b);this.push(d)}
function FUiGridControl_onDatasetLoadDelay(b){var d=this._rowHeight,f=b.dataset,h=f.count(),q=b.index,z=q+b.acceleration;z>h-1&&(z=h-1);this._hHeadPanel&&(this._hHeadPanel.scrollLeft=0);this._hColumnPanel&&(this._hColumnPanel.scrollTop=0);for(;q<=z;q++){var A=this.syncRow(q);0<d&&(A._hFixPanel.height=d+"px");var B=f.row(q);A.loadRow(B);A.setVisible(!0)}z==h-1?(b.setValid(!1),this.psRefresh()):b.index+=a.acceleration}
function FUiGridControl_onDatasetLoad(b){this._hColumnPanel&&(this._hColumnPanel.scrollTop=0,this._hColumnPanel.scrollLeft=0);this._hDataPanel&&(this._hDataPanel.scrollTop=0,this._hDataPanel.scrollLeft=0);b.isEmpty()||(b=this._loadEvent,b.index=0,b.acceleration=5,b.dataset=this._dataset,b.setValid(!0),RConsole.find(FEventConsole).push(this._loadEvent))}
function FUiGridControl_construct(){this.__base.FUiContainer.construct.call(this);this._buttons=new TDictionary;this._columns=new TDictionary;this._rows=new TObjects;this.lsnsRowClick=new TListeners;this.lsnsRowDblClick=new TListeners;var b=this._loadEvent=RClass.create(FEvent);b.setOwner(this);b.setCallback(this.onDatasetLoadDelay);b.setValid(!1)}
function FUiGridControl_buildNavigatorButton(b,d,f,h,q){b=RBuilder.append(b,"SPAN",this.styleName("Button"));b.style.cursor="hand";b.style.paddingLeft="10";d&&RBuilder.appendIcon(b,null,d);f&&(q?this[q+"Text"]=RBuilder.appendText(b,null,f):RBuilder.appendText(b,null,f));h&&RBuilder.appendIcon(b,null,h);return b}function FUiGridControl_appendChild(b){this.__base.FUiContainer.appendChild.call(this,b);RClass.isClass(b,FColumn)&&this.appendColumn(b)}
function FUiGridControl_push(b){RClass.isClass(b,FColumn)?(b._table=this,this._columns.set(b.name(),b)):RClass.isClass(b,FTableButton)&&(b._table=this,this._buttons.set(b.name(),b));this.__base.FUiContainer.push.call(this,b)}function FUiGridControl_createRow(){var b=RClass.create(this._rowClass);b._table=b._parent=this;return b}
function FUiGridControl_insertRow(b,d){d.index=b;d.build();d._hFixPanel&&(this._hFixRows.appendChild(d._hFixPanel),RHtml.tableMoveRow(this._hColumnForm,d._hFixPanel.rowIndex,b+2));this._hRows.appendChild(d._hPanel);RHtml.tableMoveRow(this._hContentForm,d._hPanel.rowIndex,b+2);d.refreshStyle();this._rows.insert(b,d)}
function FUiGridControl_syncRow(b){var d=this._rows,f=d.get(b);if(!f)for(var h=d.count();h<=b;h++)f=this.createRow(),f._index=h,f.build(this._hPanel),f._hFixPanel&&this._hFixRows.appendChild(f._hFixPanel),this._hRows.appendChild(f._hPanel),f._hPanel.style.height=f._hFixPanel.offsetHeight+"px",d.push(f);f._extended=!1;f._childRows&&(f.hideChild(),f._childRows.clear());return f}function FUiGridControl_hideRows(){for(var b=this._rows,d=b.count()-1;0<=d;d--)b.get(d).setVisible(!1)}
function FUiGridControl_clickCell(b){this._focusCell=b}function FUiGridControl_clickRow(b){this.lsnsRowClick.process(b);this._focusRow=b}function FUiGridControl_doubleClickRow(b){this.lsnsRowDblClick.process(b);this._focusRow=b}function FUiGridControl_pushButton(b){var d=this._hButtons.insertCell();d.style.border="0 solid #C6D7FF";d.appendChild(b._hPanel);this.push(b)}function FUiGridControl_onMouseDown(b,d){}
function FUiGridControl_onHeadMouseDown(b){var d=this.getHeadMode(b);EGridColumn.Size==d&&(this.hoverMode=EGridColumn.Size,b.srcElement.status=EGridColumn.Size,this.hoverX=b.srcElement.offsetLeft+b.x,this.hoverDataCell=null,this._hContentForm._rows.length&&(this.hoverDataCell=this._hContentForm._rows[0].cells[this.hoverHead.index]),this._hHeadForm.setCapture())}
function FUiGridControl_onHeadMouseMove(b){if(EGridColumn.Size==this.hoverMode)b=b.srcElement.offsetLeft+b.x-this.hoverX+this.hoverCellLength,0<b&&(this.hoverHead._hPanel.style.pixelWidth=b,this.hoverHead._hFixPanel.style.pixelWidth=b);else if(EGridColumn.None==this.hoverMode){b=this.getHeadMode(b);var d="default";EGridColumn.Size==b?d="e-resize":EGridColumn.Drag==b&&(d="hand");this._hHeadForm.style.cursor=d}}
function FUiGridControl_onHeadMouseUp(b){EGridColumn.Size==this.hoverMode&&this._hHeadForm.releaseCapture();this.hoverMode=EGridColumn.None}function FUiGridControl_onDataScroll(){this._hHeadPanel.scrollLeft=this._hContentPanel.scrollLeft;this._hColumnPanel.scrollTop=this._hContentPanel.scrollTop}
function FUiGridControl_onCellKeyDown(b,d,f){var h=d.keyCode,q=b.column;b=b.row;EKey.Up==h?(q.moveCellFocus(b,EPosition.Top),RKey.eventClear(f)):EKey.Down==h?(q.moveCellFocus(b,EPosition.Bottom),RKey.eventClear(f)):EKey.Tab==h&&d.shiftKey?(q.moveCellFocus(b,EPosition.Before),RKey.eventClear(f)):EKey.Tab==h&&(q.moveCellFocus(b,EPosition.After),RKey.eventClear(f))}function FUiGridControl_onRowMouseEnter(b,d){this.hoverRow(b,!0)}function FUiGridControl_onRowMouseLeave(b,d){this.hoverRow(b,!1)}
function FUiGridControl_onRowClick(b,d){this.selectRow(b,!d.ctrlKey,!0);this.lsnsRowClick.process(b);d=this._eventRowClick;d||(d=this._eventRowClick=new TEvent,d.source=this);d.caller=b;d.handle="onTableRowClick";RConsole.find(FFormConsole).processEvent(d)}
function FUiGridControl_onColumnSearchKeyDown(b,d){EKey.Enter!=d.keyCode||this._isSearching&&this.table._isSearching||(this._isSearching=!0,this.table?(this.table.doSearch(),this.table.dpScrollLeft=this.table._hContentPanel.scrollLeft,this.table.callEvent("onSearchKeyDown",this,this._searchKeyDownEvent)):(this.doSearch(),this.dpScrollLeft=this._hContentPanel.scrollLeft,this.callEvent("onSearchKeyDown",this,this._searchKeyDownEvent)))}
function FUiGridControl_onButtonMouseDown(b){var d=this.dsViewer;if(d&&0!=d.dataset.pageCount)if(b=b.hSource,this.hInsertButton==b)this.onInsertButtonClick();else if(this.hExtendButton==b)this.onExtendButtonClick();else this.hNavFirst==b&&0!=d.pageIndex?this.dsMovePage(EDataAction.First):this.hNavPrior==b&&0!=d.pageIndex?this.dsMovePage(EDataAction.Prior):this.hNavNext==b&&d.pageIndex!=d.pageCount-1?this.dsMovePage(EDataAction.Next):this.hNavLast==b&&d.pageIndex!=d.pageCount-1&&this.dsMovePage(EDataAction.Last)}
function FUiGridControl_onPageCountDown(b){var d=this.dsViewer;if(!RString.isEmpty(this.hPage.value)&&d&&0!=d.dataset.pageCount){var f=RInt.parse(this.hPage.value);EKey.Enter==b.keyCode&&f!=d.pageIndex+1&&(1>f&&(f=1),f>d.pageCount&&(f=d.pageCount),this.dsMovePage(f-1))}}function FUiGridControl_onInsertButtonClick(){RFormSpace.doPrepare(this)}
function FUiGridControl_onExtendButtonClick(){400==this.dsPageSize?(this.dsPageSize=this.dsPageSizeStore,this.hExtendText.innerText=" \u5c55\u5f00"):(this.dsPageSizeStore=this.dsPageSize,this.dsPageSize=400,this.hExtendText.innerText=" \u6536\u7f29");this.dsSearch()}function FUiGridControl_oeMode(b){this.dispDelete=this.dispUpdate=!0;this.__base.FUiContainer.oeMode.call(this,b);this.__base.MDisplay.oeMode.call(this,b);this._editable=this.canEdit(b.mode);return EEventStatus.Stop}
function FUiGridControl_oeProgress(b){if("none"!=this._hPanel.currentStyle.display){var d=this._hDelayPanel;if(!d){var d=this._hDelayPanel=RBuilder.appendDiv(this.hBorderPanel),f=d.style;f.position="absolute";f.zIndex=RLayer.next();f.filter="progid:DXImageTransform.Microsoft.Alpha(opacity=100)";f.backgroundColor="#FFFFFF";f.top=0;f.width="100%";f.height="100%";f.display="none";f=this._hDelayForm=RBuilder.appendTable(d);f.style.width="100%";f.style.height="100%";f=f.insertRow().insertCell();f.align=
"center";f.vAlign="middle";RBuilder.appendIcon(f,"ctl.FUiGridControl_Loading");(this._hDelayText=RBuilder.append(f,"SPAN")).innerHTML="<BR><BR><FONT color='red'><B>"+RContext.get("FUiGridControl:Loading")+"</B></FONT>"}b.enable?(RHtml.setRect(d,this.calculateDataSize()),d.filters[0].opacity=100,d.style.display="block"):this._loadFinish&&(d.style.display="none");this.refreshHint();return EEventStatus.Stop}}function FUiGridControl_isFormLinked(){return this._formLinked||this._formName}
function FUiGridControl_isDataSelected(){for(var b=this._rows,d=b.count-1;0<=d;d--)if(b.get(d).isSelect)return!0}function FUiGridControl_isDataChanged(){for(var b=this._rows,d=b.count-1;0<=d;d--)if(b.get(d).isDataChanged())return!0}function FUiGridControl_hasAction(){for(var b=this.components,d=b.count,f=0;f<d;f++){var h=b.value(f);if(RClass.isClass(h,FDataAction))return this.isDataSelected()}}
function FUiGridControl_getFormLink(b){if(EFormLink.Form==b)return this._formName;if(EFormLink.Table==b)return this.name;RMessage.fatal(this,null,"Form link is invalid. (type={0})",b)}
function FUiGridControl_getHeadMode(b){var d=RHtml.point(this._hHeadForm);b=b.srcElement.offsetLeft+b.x-d.x;for(var f=this._columns,h=0;h<f.count;h++){var q=f.value(h);if(q.dispSize){var z=q._hPanel.offsetLeft+q._hPanel.offsetWidth-d.x;this.hoverCellLength=q._hPanel.offsetWidth;if(z-6<=b&&b<=z)return this.hoverHead=q,EGridColumn.Size}}return EGridColumn.None}
function FUiGridControl_getRowBar(){var b=this._rowBar;b||(b=this._rowBar=RClass.create(FGridRowBar),b.table=this,b.psBuild(this.hBorderPanel));return b}function FUiGridControl_calculateDataSize(){var b=this._dataRect;b||(b=this._dataRect=new TRect);var d=this.hTitleForm?this.hTitleForm.offsetHeight:0,f=this._hFixPanel?this._hFixPanel.offsetHeight:0;b.left=0;b.top=f+d;b.setWidth(this.hBorderPanel.offsetWidth);b.setHeight(this.hBorderPanel.offsetHeight-d-f);return b}
function FUiGridControl_hasVisibleRow(){for(var b=this._rows,d=0;d<b.count;d++)if(b.get(d)._visible)return!0;return!1}function FUiGridControl_getCurrentRow(){var b=this._focusCell;if(b)return b.row.saveRow()}function FUiGridControl_getSelectedRow(){for(var b=this._rows,d=b.count,f=0;f<d;f++){var h=b.get(f);if(h.isSelect)return h}}
function FUiGridControl_getSelectedRows(){for(var b=new TList,d=this._rows,f=d.count,h=0;h<f;h++){var q=d.get(h);q.isSelect&&q.isVisible()&&b.push(q.saveRow())}return b}function FUiGridControl_getChangedRows(){for(var b=new TList,d=this._rows,f=d.count,h=0;h<f;h++){var q=d.get(h);q.isVisible()&&q.isDataChanged()&&b.push(q.saveRow())}return b}function FUiGridControl_getRows(){for(var b=new TList,d=this._rows,f=d.count,h=0;h<f;h++){var q=d.get(h);q.isVisible()&&b.push(q.saveRow())}return b}
function FUiGridControl_refreshHint(){var b=this._hHint,d=this._dataset;if(d&&b){var f=0,h=this.getSelectedRow();h&&(f=this._rows.indexOf(h)+1);b.innerHTML="\u5171<FONT color='red' style='font-weight:BOLD '>"+d.pageCount+"</FONT>\u9875<FONT color='red' style='font-weight:BOLD '>"+d.total+"</FONT>\u6761\u8bb0\u5f55\uff0c\u5f53\u524d\u9009\u4e2d\u7b2c<FONT color='red' style='font-weight:BOLD '>"+(d.pageIndex+1)+"</FONT>\u9875\u7b2c<FONT color='red' style='font-weight:BOLD '>"+f+"</FONT>\u6761\u8bb0\u5f55";
this.hPage.value=d.pageIndex+1}}function FUiGridControl_refreshSelected(){this._columns.get("_select").hSelected.checked=!1;for(var b=this._rows,d=b.count,f=0;f<d;f++)b.get(f).isSelect=!1}function FUiGridControl_hoverRow(b,d){d?this._hoverRow=b:this._hoverRow==b&&(this._hoverRow=null);b.refreshStyle()}
function FUiGridControl_selectRow(b,d,f){var h=!1;if(d){d=this._rows;for(var q=d.count,z=0;z<q;z++){var A=d.get(z);A!=b&&A.isSelect&&(A.select(!1),h=!0)}}b.select(h||!b.isSelect||f);this.refreshHint()}function FUiGridControl_clearSelectRow(b){b.select(!1);this.refreshHint()}function FUiGridControl_clearSelectRows(){for(var b=this._rows,d=0;d<b.count;d++)b.get(d).isSelect=!1;this.refreshHint()}function FUiGridControl_setDataStatus(b,d){b.dataStatus=d;this._statusColumn.setDataStatus(b,d)}
function FUiGridControl_dsInsert(){}function FUiGridControl_dsUpdate(b){this.psMode(EMode.Update);this.dsFetch(!0)}function FUiGridControl_dsDelete(){}
function FUiGridControl_doSearch(){this.dsSearchs.clear();for(var b=this._columns,d=0;d<b.count;d++){var f=b.value(d),h=f.searchValue();if(RClass.isClass(f,FColumnCalendar)){if(h){var q=new TSearchItem;q.set(f.dataName,h.value,ESearch.Date,h.format);this.dsSearchs.push(q)}}else RString.isEmpty(h)||(q=new TSearchItem,q.set(f.dataName,h,ESearch.Like),this.dsSearchs.push(q))}this.dsValues=this.toDeepAttributes();this.dsSearch()}
function FUiGridControl_focus(){RConsole.find(FFocusConsole).focusClass(MDataset,this)}function FUiGridControl_pack(){for(var b=this._rows,d=b.count,f=new TNode("Dataset"),h=0;h<d;h++){var q=b.get(h);q.isDataChanged()&&(q=q.toAttrs(),q=new TNode("Row",q),f.push(q))}return f}function FUiGridControl_setVisible(b){this.__base.FUiContainer.setVisible.call(this,b);this.__base.MUiHorizontal.setVisible.call(this,b)}
function FUiGridControl_setButtonVisible(b,d){var f=this._buttons.get(b);f&&f.setVisible(d)}function FUiGridControl_refreshStyle(){for(var b=this._rows,d=b.count,f=0;f<d;f++)b.get(f).refreshStyle()}
function FUiGridControl_dispose(){this.__base.FUiContainer.dispose.call(this);this._hExtendText=this._hExtendButton=this._hInsertButton=this._hHintForm=this._hRowLine=this._hRows=this._hContentForm=this._hContentPanel=this._hFixRowLine=this._hFixRows=this._hColumnForm=this._hColumnPanel=this._hSearch=this._hHead=this._hHeadForm=this._hHeadPanel=this._hFixSearch=this._hFixHead=this._hFixForm=this._hFixPanel=this._hDelayForm=this._hDelayPanel=this.hBorderPanel=null}
function FUiGridControl_dump(b){b=RString.nvlStr(b);b.appendLine(RClass.name(this));for(var d=this._rows,f=0;f<d.count;f++)b.appendLine(d.get(f).dump());return b}function FUiGridControl_storeValues(b){b||(b=new TAttributes);var d=this.getSelectRows();d.count&&(1!=d.count&&RMessage.fatal(this,"Invalid selected rows. (count={0})",d.count),d.get(0).toAttributes(b));return b}
function FUiGridControl_buildRows(){var b=this._rows;if(!b.count)for(var d=this._displayCount,f=0;f<d;f++){var h=RClass.create(FGridRow);h.table=this;h.build();this._hRows.appendChild(h._hPanel);b.push(h)}}function FUiGridControl_createChild(b){var d=this.__base.FUiContainer.createChild.call(this,b);if(RClass.isClass(d,FGridRow))return d.table=this,d.row=this.dsLoadRowNode(b),this._rows.push(d),null;RClass.isClass(d,FColumnEditControl)&&(d.table=this);return d}
function FUiGridControl_setStyleStatus(b,d){if(b._hPanel)switch(d){case EStyle.Normal:b.select(!1);break;case EStyle.Select:b.select(!0)}}function FUiGridControl_buildRow(b){for(var d=this._columns,f=0;f<d.count;f++){var h=d.value(f),q=h.createCell(b);h.dataName&&q.set(RString.nvl(b.get(h.dataName),h.dataDefault));b.push(q)}return b}function FUiGridControl_clearSelectAll(){this._columns.get("_select").hSelected.checked=!1}
function FUiGridControl_appendRow(b){this._hRows.appendChild(b._hRow);this._rows.push(b)}function FUiGridControl_deleteRow(b){b=RObject.nvl(b,this.selectedRow);if(!b)return alert("Please select row.");b.isExist()?b.isDelete()?(b.doNormal(),this.setDataStatus(b,EDataStatus.Unknown),this.setStyleStatus(b,EStyle.Select)):(b.doDelete(),this.setDataStatus(b,EDataStatus.Delete),this.setStyleStatus(b,EStyle.Delete)):b.release()}
function FUiGridControl_clearRows(){for(var b=this._rows.count,d=0;d<b;d++){var f=this._rows.get(d);f&&f.dispose()}this._rows.clear();RHtml.clear(this._hRows)}
function FUiGridControl_onColumnTreeService(b){if((b=b.resultDatasets.get(b.path)._rows)&&0<b.count){var d=this.focusRow;d.extdStatus=!0;d.psResize();for(var f=d._hPanel.rowIndex+1,h=0;h<b.count;h++){var q=RClass.create(FGridRow);q.table=this;d.childRows.push(q);q.parentRow=d;q.buildChild(this._hFixRows,this._hRows,f+h);q.loadRow(b.get(h))}}}function FUiGridControl_getRowType(){for(var b=this.components,d=b.count,f=0;f<d;f++){var h=b.value(f);if(RClass.isClass(h,FGridRowType))return h}}
function FUiGridControl_onColumnTreeClick(b,d){if(this.getRowType()){var f=b.row;if(f.childRows&&0<f.childRows.count)f.extended?f.hideChild():f.showChild(),f.extended=!f.extended,b.hImg.src=f.extended?b.styleIconPath("Fold",FColumnTree):b.styleIconPath("Expend",FColumnTree);else if(this.focusRow=b.row,"Y"==this.focusRow.row.get("ochd")){b.row.extended=!0;b.hImg.src=b.styleIconPath("Fold",FColumnTree);var f=b.row.get("otyp"),h=b.row.table.component(f),q=this.topControl(MDataset),f=new TDatasetFetchArg(q.name,
q.formId,q.dsPageSize,q.dsPageIndex,null,null,this.fullPath(),h.formResearch);q.dsSearchs.clear();if(h&&h.formWhere){var z=new TSearchItem;z.set(h.dataName,h.formWhere,ESearch.Source);q.dsSearchs.push(z)}f.force=!0;f.reset=!0;f.searchs=q.dsSearchs;h=new TAttributes;b.row.toDeepAttributes(h);f.values=h;f.callback=new TInvoke(this,this.onColumnTreeService);RConsole.find(FDatasetConsole).fetch(f)}}}
function FUiTable(b){b=RClass.inherits(this,b,FGridControl,MDataset);b._detailFrameName=RClass.register(b,new APtyString("_detailFrameName"));b._styleFixPanel=RClass.register(b,new AStyle("_styleFixPanel"));b._styleFixForm=RClass.register(b,new AStyle("_styleFixForm"));b._styleHeadPanel=RClass.register(b,new AStyle("_styleHeadPanel"));b._styleHeadForm=RClass.register(b,new AStyle("_styleHeadForm"));b._styleColumnPanel=RClass.register(b,new AStyle("_styleColumnPanel"));b._styleColumnForm=RClass.register(b,
new AStyle("_styleColumnForm"));b._styleDataPanel=RClass.register(b,new AStyle("_styleDataPanel"));b._styleDataForm=RClass.register(b,new AStyle("_styleDataForm"));b._hFixPanel=null;b._hFixForm=null;b._hHeadPanel=null;b._hHeadForm=null;b._hColumnPanel=null;b._hColumnForm=null;b._hDataPanel=null;b._hDataForm=null;b.onBuildContent=FUiTable_onBuildContent;b.oeRefresh=FUiTable_oeRefresh;b.appendColumn=FUiTable_appendColumn;return b}
function FUiTable_onBuildContent(b){b=this._hContentPanel;var d=this._hFixPanel=RBuilder.appendDiv(b,this.styleName("FixPanel"));d.style.zIndex=2;d.style.position="absolute";d=this._hFixForm=RBuilder.appendTable(d,this.styleName("FixForm"),0,0,1);d.borderColorLight="#D0D0D0";d.borderColorDark="#EEEEEE";this._hFixHead=RBuilder.appendTableRow(d);this._hFixSearch=RBuilder.appendTableRow(d);this._hFixTotal=RBuilder.appendTableRow(d);this._hFixTotal.style.display="none";d=this._hHeadPanel=RBuilder.appendDiv(b,
this.styleName("HeadPanel"));d.style.zIndex=1;d.style.position="absolute";d.style.overflowX="hidden";d.style.width=1;d=this._hHeadForm=RBuilder.appendTable(d,this.styleName("HeadForm"),0,0,1);d.frame="rhs";d.style.tableLayout="fixed";d.borderColorLight="#D0D0D0";d.borderColorDark="#EEEEEE";this._hHead=d.insertRow();this._hSearch=d.insertRow();this._hTotal=d.insertRow();this._hTotal.style.display="none";d=this._hColumnPanel=RBuilder.appendDiv(b,this.styleName("ColumnPanel"));d.style.zIndex=1;d.style.position=
"absolute";d.style.overflowY="hidden";d=this._hColumnForm=RBuilder.appendTable(d,this.styleName("ColumnForm"),0,0,1);this._hFixRows=RBuilder.append(d,"TBODY");this._hFixRowLine=RBuilder.append(this._hFixRows,"TR");b=this._hDataPanel=RBuilder.appendDiv(b,this.styleName("DataPanel"));b.width="100%";b.height="100%";b=this._hDataForm=RBuilder.appendTable(b,this.styleName("DataForm"),0,0,1);this._hRows=RBuilder.append(b,"TBODY");this._hRowLine=RBuilder.append(this._hRows,"TR");this.panelNavigator=!0}
function FUiTable_oeRefresh(b){this.__base.FGridControl.oeRefresh.call(this,b);if(b.isAfter()){b=this._hFixPanel;var d=this._hHeadPanel,f=this._hColumnPanel,h=this._hDataPanel,q=b.offsetWidth,z=b.offsetHeight;f.style.display=h.style.display="none";var A=this._hContentPanel.offsetWidth,B=this._hContentPanel.offsetHeight;f.style.display=h.style.display="block";b.style.left="0px";b.style.top="0px";d.style.left=q+"px";d.style.top="0px";d.style.width=A-q+"px";this._hHead.style.height=this._hFixHead.offsetHeight+
"px";this._hSearch.style.height=this._hFixSearch.offsetHeight+"px";f.style.top=z+"px";f.style.width=q+"px";f.style.height=B-z+"px";h.style.left="0px";h.style.top="0px";h.style.width=A-q+"px";h.style.height=B-z+"px";h.style.paddingLeft=q;h.style.paddingTop=z}}
function FUiTable_appendColumn(b){b._optionFixed?(this._hFixHead.appendChild(b._hPanel),this._hFixSearch.appendChild(b._hSearchPanel),this._hFixTotal.appendChild(b._hTotalPanel),this._hFixRowLine.appendChild(b._hFixPanel)):(this._hHead.appendChild(b._hPanel),this._hSearch.appendChild(b._hSearchPanel),this._hTotal.appendChild(b._hTotalPanel),this._hRowLine.appendChild(b._hFixPanel))}
function FUiTable_onResizeAfter(){var b=this._hDataPanel,d=this._hFixPanel,f=RHtml.scrollWidth(b),h=RHtml.scrollHeight(b);this._hHeadPanel.style.pixelWidth=b.offsetWidth-d.offsetWidth-f;this._hColumnPanel.style.pixelHeight=b.offsetHeight-d.offsetHeight-h+1}
function FUiTable_oeResize(b){b=this._hPanel;if(b.offsetWidth&&b.offsetHeight){var d=this._hTitleForm,f=this._hFixPanel,h=this._hHeadPanel,q=this._hColumnPanel;b=this._hDataPanel;h.style.display=q.style.display=b.style.display="none";var z=this._hBorderPanel.offsetWidth,A=this._hBorderPanel.offsetHeight;h.style.display=q.style.display=b.style.display="block";h.style.pixelWidth=z-f.offsetWidth;q.style.pixelHeight=A-f.offsetHeight-1-d.offsetHeight;b.style.pixelWidth=z;b.style.pixelHeight=A-d.offsetHeight;
d=this.rows.count;for(f=0;f<d;f++)this.rows.get(f).refreshSize();this.dpScrollLeft&&(b.scrollLeft=this.dpScrollLeft,this.dpScrollLeft=null);RConsole.find(FEventConsole).push(this.eventResizeAfter);return EEventStatus.Stop}}function MUiMenuButton(b){return b=RClass.inherits(this,b)}
function FUiMenuBar(b){b=RClass.inherits(this,b,FUiContainer,MUiDescribeFrame);b._mergeCd=RClass.register(b,new APtyEnum("_mergeCd",null,EUiMerge,EUiMerge.Override));b._stylePanel=RClass.register(b,new AStyle("_stylePanel"));b._styleButtonPanel=RClass.register(b,new AStyle("_styleButtonPanel"));b._hLine=null;b.onBuildPanel=FUiMenuBar_onBuildPanel;b.onEnter=RMethod.empty;b.onLeave=RMethod.empty;b.appendChild=FUiMenuBar_appendChild;b.removeChild=FUiMenuBar_removeChild;b.dispose=FUiMenuBar_dispose;return b}
function FUiMenuBar_onBuildPanel(b){b=this._hPanel=RBuilder.createTable(b,this.styleName("Panel"));this._hLine=RBuilder.appendTableRow(b)}function FUiMenuBar_appendChild(b){this.__base.FUiContainer.appendChild.call(this,b);if(RClass.isClass(b,MUiMenuButton)){var d=this._hLine,f=RBuilder.appendTableCell(d,this.styleName("ButtonPanel"));f._hParentLine=d;b.setPanel(f)}}
function FUiMenuBar_removeChild(b){RClass.isClass(b,FUiMenuButton)&&(b._hParentLine.removeChild(b._hParent),b._hParentLine=null,b._hParent=null);this.__base.FUiContainer.removeChild.call(this,b)}function FUiMenuBar_dispose(){this._hLine=RHtml.free(this._hLine);this.__base.FUiContainer.dispose.call(this)}
function FUiMenuButton(b){b=RClass.inherits(this,b,FUiControl,MUiMenuButton,MListenerClick);b._icon=RClass.register(b,new APtyString("_icon"));b._iconDisable=RClass.register(b,new APtyString("_iconDisable"));b._hotkey=RClass.register(b,new APtyString("_hotkey"));b._action=RClass.register(b,new APtyString("_action"));b._styleNormal=RClass.register(b,new AStyle("_styleNormal"));b._styleHover=RClass.register(b,new AStyle("_styleHover"));b._stylePress=RClass.register(b,new AStyle("_stylePress"));b._styleDisable=
RClass.register(b,new AStyle("_styleDisable"));b._styleIconPanel=RClass.register(b,new AStyle("_styleIconPanel"));b._styleSpacePanel=RClass.register(b,new AStyle("_styleSpacePanel"));b._styleLabelPanel=RClass.register(b,new AStyle("_styleLabelPanel"));b._disabled=!1;b._hForm=null;b._hLine=null;b._hIconPanel=null;b._hIcon=null;b._hSpacePanel=null;b._hLabelPanel=null;b.onBuildPanel=FUiMenuButton_onBuildPanel;b.onBuild=FUiMenuButton_onBuild;b.onEnter=FUiMenuButton_onEnter;b.onLeave=FUiMenuButton_onLeave;
b.onMouseDown=RClass.register(b,new AEventMouseDown("onMouseDown"),FUiMenuButton_onMouseDown);b.onMouseUp=RClass.register(b,new AEventMouseDown("onMouseUp"),FUiMenuButton_onMouseUp);b.icon=FUiMenuButton_icon;b.setIcon=FUiMenuButton_setIcon;b.setLabel=FUiMenuButton_setLabel;b.setHint=FUiMenuButton_setHint;b.setEnable=FUiMenuButton_setEnable;b.click=FUiMenuButton_click;b.dispose=FUiMenuButton_dispose;return b}
function FUiMenuButton_onBuildPanel(b){this._hPanel=RBuilder.createDiv(b,this.styleName("Normal"))}
function FUiMenuButton_onBuild(b){this.__base.FUiControl.onBuild.call(this,b);b=this._hPanel;this.attachEvent("onMouseDown",b);this.attachEvent("onMouseUp",b);b=this._hForm=RBuilder.appendTable(b);b=this._hLine=RBuilder.appendTableRow(b);if(this._icon){var d=this._hIconPanel=RBuilder.appendTableCell(b,this.styleName("IconPanel"));this._hIcon=RBuilder.appendIcon(d,null,this._icon)}this._icon&&this._label&&(this._hSpacePanel=RBuilder.appendTableCell(b,this.styleName("SpacePanel")));this._label&&((this._hLabelPanel=
RBuilder.appendTableCell(b,this.styleName("LabelPanel"))).noWrap=!0,this.setLabel(this._label));this._hotkey&&RConsole.find(FKeyConsole).register(this._hotkey,this,this.onMouseDown);this._hint&&this.setHint(this._hint)}function FUiMenuButton_onEnter(b){this._disabled||(this._hPanel.className=this.styleName("Hover"))}function FUiMenuButton_onLeave(){this._disabled||(this._hPanel.className=this.styleName("Normal"))}
function FUiMenuButton_onMouseDown(){this._disabled||(this._hPanel.className=this.styleName("Press"),this.click())}function FUiMenuButton_onMouseUp(){this._disabled||(this._hPanel.className=this.styleName("Hover"))}function FUiMenuButton_icon(){return this._icon}function FUiMenuButton_setIcon(b){this._icon=b;this._hIcon&&(this._hIcon.src=this.styleIconPath(this._icon))}function FUiMenuButton_setLabel(b){this._label=b=RString.nvl(b);RHtml.textSet(this._hLabelPanel,b)}
function FUiMenuButton_setHint(b){this._hint=b;RString.nvl(b);this._hPanel.title=this._hint}function FUiMenuButton_setEnable(b){this.__base.FUiControl.setEnable.call(this,b);b?(this._hPanel.className=this.style("Button"),this._iconDisable&&this._icon&&(this._hIcon.src=RRes._iconPath(this._icon))):(this._hPanel.className=this.style("Disable"),this._iconDisable&&(this._hIcon.src=RRes._iconPath(this._iconDisable)))}
function FUiMenuButton_click(){if(!this._disabled){RConsole.find(FUiFocusConsole).blur();RLogger.debug(this,"Menu button click. (label={1})",this._label);var b=new SClickEvent(this);this.processClickListener(b);b.dispose();this._action&&eval(this._action)}}
function FUiMenuButton_dispose(){this._hForm=RHtml.free(this._hForm);this._hLine=RHtml.free(this._hLine);this._hIconPanel=RHtml.free(this._hIconPanel);this._hIcon=RHtml.free(this._hIcon);this._hSpacePanel=RHtml.free(this._hSpacePanel);this._hLabelPanel=RHtml.free(this._hLabelPanel);this.__base.FUiControl.dispose.call(this)}
function FUiMenuButtonMenu(b){b=RClass.inherits(this,b,FUiControl);b._action=RClass.register(b,new APtyString("action",null));b._target=RClass.register(b,new APtyString("target",null));b._page=RClass.register(b,new APtyString("page"));b._hotkey=RClass.register(b,new APtyString("hotkey"));b._method=RClass.register(b,new APtyString("method"));b._icon=RClass.register(b,new APtyString("icon",null));b._iconDisable=RClass.register(b,new APtyString("iconDisable",null));b._attributes=RClass.register(b,new APtyString("attributes"));
b._disabled=!1;b.hButton=null;b.hButtonLine=null;b.hButtonPanel=null;b.hIcon=null;b.hText=null;b.oeBuild=FUiMenuButtonMenu_oeBuild;b.oeEnable=FUiMenuButtonMenu_oeEnable;b.oeDisable=FUiMenuButtonMenu_oeDisable;b.onBuildPanel=FUiMenuButtonMenu_onBuildPanel;b.onEnter=FUiMenuButtonMenu_onEnter;b.onLeave=FUiMenuButtonMenu_onLeave;b.onMouseDown=FUiMenuButtonMenu_onMouseDown;b.onMouseUp=FUiMenuButtonMenu_onMouseUp;b.onClick=FUiMenuButtonMenu_onClick;b.construct=FUiMenuButtonMenu_construct;b.dispose=FUiMenuButtonMenu_dispose;
return b}function FUiMenuButtonMenu_oeBuild(b){this.base.FUiControl.oeBuild.call(this,b);this.hButton=RBuilder.appendTable(this.hPanel,this.style("Button"));this.linkClickEvent(this.hButton);b=(this.hButtonLine=this.hButton.insertRow()).insertCell();this._icon&&(this.hIcon=RBuilder.appendIcon(b,this._icon));this.label&&(this.hLabel=RBuilder.appendText(b,(this.hIcon?"&nbsp;":"")+this.label),this.hLabel.className=this.style("Label"));return EEventStatus.Stop}
function FUiMenuButtonMenu_onBuildPanel(){this.hPanel=RBuilder.create(null,"DIV")}function FUiMenuButtonMenu_oeEnable(b){this.base.FUiControl.oeEnable.call(this,b);this.hPanel.className=this.style("Button");this._iconDisable&&this._icon&&(this.hIcon.src=RRes._iconPath(this._icon));return EEventStatus.Stop}
function FUiMenuButtonMenu_oeDisable(b){this.base.FUiControl.oeDisable.call(this,b);this.hPanel.className=this.style("Disable");this._iconDisable&&(this.hIcon.src=RRes._iconPath(this._iconDisable));return EEventStatus.Stop}function FUiMenuButtonMenu_onEnter(){this._disabled||(this.hPanel.className=this.style("Hover"))}function FUiMenuButtonMenu_onLeave(){this._disabled||(this.hPanel.className=this.style("Panel"))}
function FUiMenuButtonMenu_onMouseDown(){this._disabled||(this.hPanel.className=this.style("Press"))}function FUiMenuButtonMenu_onMouseUp(){this._disabled||(this.hPanel.className=this.style("Hover"))}
function FUiMenuButtonMenu_onClick(){if(!this._disabled){RConsole.find(FFocusConsole).focus(this);this._action&&eval(this._action);if(this._page||this._method){var b=RHtml.form(this.hButton),d=RPage.parse(this._page);this._method&&(d._action=this._method);d.split(this._attributes);d.post(b,this._target)}this.processClick()}}function FUiMenuButtonMenu_construct(){this.base.FUiControl.construct.call(this)}
function FUiMenuButtonMenu_dispose(){this.base.FUiControl.dispose.call(this);RMemory.freeHtml(this.hPanel);RMemory.freeHtml(this.hButton);this.hLabel=this.hButtonLine=this.hButton=this.hIcon=this.hPanel=null}function FUiMenuButtonSplit(b){b=RClass.inherits(this,b,FUiControl,MUiMenuButton);b._stylePanelHorizontal=RClass.register(b,new AStyle("_stylePanelHorizontal"));b._stylePanelVertical=RClass.register(b,new AStyle("_stylePanelVertical"));b.onBuild=FUiMenuButtonSplit_onBuild;return b}
function FUiMenuButtonSplit_onBuild(b){this.__base.FUiControl.onBuild.call(this,b);b=this._hPanel;RClass.isClass(this._parent,FUiMenuBar)?b.className=this.styleName("PanelVertical"):b.className=this.styleName("PanelHorizontal")}
function FUiPopupMenu(b){b=RClass.inherits(this,b,FUiContainer,MUiPopup);b._stylePanel=RClass.register(b,new AStyle("_stylePanel"));b._styleForm=RClass.register(b,new AStyle("_styleForm"));b._styleContainer=RClass.register(b,new AStyle("_styleContainer"));b._styleLabel=RClass.register(b,new AStyle("_styleLabel"));b._styleButton=RClass.register(b,new AStyle("_styleButton"));b._opener=null;b._visible=!1;b._statusVisible=!1;b._hContainer=null;b._hLabel=null;b._hButtonPanel=null;b._hIcon=null;b._hText=
null;b.onBuild=FUiPopupMenu_onBuild;b.appendChild=FUiPopupMenu_appendChild;b.show=FUiPopupMenu_show;b.setVisible=FUiPopupMenu_setVisible;b.testInRange=FUiPopupMenu_testInRange;b.doBlur=FUiPopupMenu_doBlur;b.dispose=FUiPopupMenu_dispose;return b}
function FUiPopupMenu_onBuild(b){this.__base.FUiContainer.onBuild.call(this,b);b=this._hForm=RBuilder.appendTable(this._hPanel,this.styleName("Form"));var d=this._hLineTop=RBuilder.appendTableCell(b);d.bgColor="#666666";d.height="2px";d=this._hContainerPanel=RBuilder.appendTableCell(b);b=this._hLineBottom=RBuilder.appendTableCell(b);b.bgColor="#666666";b.height="2px";this._hContainer=RBuilder.appendTable(d,this.styleName("Container"))}function FUiPopupMenu_doBlur(){}
function FUiPopupMenu_appendChild(b){var d=RBuilder.appendTableRowCell(this._hContainer);d.className=this.styleName("Button");d.appendChild(b._hPanel)}function FUiPopupMenu_show(b,d,f){b=this._hPanel;d=this._opener;this.setVisible(!0);f=d._hPanel;d=f.offsetWidth;f=f.offsetHeight;var h=b.offsetWidth,q=b.offsetHeight;b=b.style;h<d&&(h=d);300<q&&(this._hFormPanel.style.overflowY="scroll",b.height=q+"px");b.left="3px";b.top=f+1+"px";b.width=h+"px";b.zIndex=RUiLayer.next()}
function FUiPopupMenu_setVisible(b){var d=this._opener;this._statusVisible=b;var d=d._hPanelCell,f=this.panel(EPanel.Container);b?d.appendChild(f):d.removeChild(f)}function FUiPopupMenu_testInRange(b){return this==RControl.htmlControl(b.srcElement,FUiPopupMenu)}
function FUiPopupMenu_dispose(b){this._hContainer=RMemory.free(this._hContainer);this._hPanel=RMemory.free(this._hPanel);this._hLabel=RMemory.free(this._hLabel);this._hLastRow=RMemory.free(this._hLastRow);this.__base.FUiContainer.dispose.call(this)}function MUiToolButton(b){return b=RClass.inherits(this,b)}
function FUiToolBar(b){b=RClass.inherits(this,b,FUiContainer,MUiDescribeFrame);b._alignCd=RClass.register(b,new APtyEnum("_alignCd",null,EUiAlign,EUiAlign.Left));b._directionCd=RClass.register(b,new APtyEnum("_directionCd",null,EUiDirection,EUiDirection.Horizontal));b._mergeCd=RClass.register(b,new APtyEnum("_mergeCd",null,EUiMerge,EUiMerge.Override));b._stylePanel=RClass.register(b,new AStyle("_stylePanel"));b._styleButtonPanel=RClass.register(b,new AStyle("_styleButtonPanel"));b._hLine=null;b.onBuildPanel=
FUiToolBar_onBuildPanel;b.onEnter=RMethod.empty;b.onLeave=RMethod.empty;b.appendChild=FUiToolBar_appendChild;b.removeChild=FUiToolBar_removeChild;b.dispose=FUiToolBar_dispose;return b}function FUiToolBar_onBuildPanel(b){this._hPanel=RBuilder.createTable(b,this.styleName("Panel"))}
function FUiToolBar_appendChild(b){this.__base.FUiContainer.appendChild.call(this,b);if(RClass.isClass(b,MUiToolButton)){var d=this._hPanel,f=this._hLine;this._directionCd!=EUiDirection.Horizontal||f||(f=this._hLine=RBuilder.appendTableRow(d));this._directionCd==EUiDirection.Vertical&&(f=this._hLine=RBuilder.appendTableRow(d));d=RBuilder.appendTableCell(f,this.styleName("ButtonPanel"));b._hPanelCell=d;b.setPanel(d)}}
function FUiToolBar_removeChild(b){RClass.isClass(b,MUiToolButton)&&(b._hParentLine.removeChild(b._hParent),b._hParent=null,b._hParentLine=null);this.__base.FUiContainer.removeChild.call(this,b)}function FUiToolBar_dispose(){this._hLine=RHtml.free(this._hLine);this.__base.FUiContainer.dispose.call(this)}
function FUiToolButton(b){b=RClass.inherits(this,b,FUiControl,MUiToolButton,MListenerClick);b._icon=RClass.register(b,new APtyString("_icon"));b._iconDisable=RClass.register(b,new APtyString("_iconDisable"));b._hotkey=RClass.register(b,new APtyString("_hotkey"));b._action=RClass.register(b,new APtyString("_action"));b._stylePanel=RClass.register(b,new AStyle("_stylePanel"));b._styleNormal=RClass.register(b,new AStyle("_styleNormal"));b._styleHover=RClass.register(b,new AStyle("_styleHover"));b._stylePress=
RClass.register(b,new AStyle("_stylePress"));b._styleDisable=RClass.register(b,new AStyle("_styleDisable"));b._styleIconPanel=RClass.register(b,new AStyle("_styleIconPanel"));b._styleSpacePanel=RClass.register(b,new AStyle("_styleSpacePanel"));b._styleLabelPanel=RClass.register(b,new AStyle("_styleLabelPanel"));b._disabled=!1;b._hForm=null;b._hLine=null;b._hIconPanel=null;b._hIcon=null;b._hSpacePanel=null;b._hLabelPanel=null;b.onBuildPanel=FUiToolButton_onBuildPanel;b.onBuildButton=FUiToolButton_onBuildButton;
b.onBuild=FUiToolButton_onBuild;b.onEnter=FUiToolButton_onEnter;b.onLeave=FUiToolButton_onLeave;b.onMouseDown=RClass.register(b,new AEventMouseDown("onMouseDown"),FUiToolButton_onMouseDown);b.onMouseUp=RClass.register(b,new AEventMouseDown("onMouseUp"),FUiToolButton_onMouseUp);b.icon=FUiToolButton_icon;b.setIcon=FUiToolButton_setIcon;b.setLabel=FUiToolButton_setLabel;b.setHint=FUiToolButton_setHint;b.setEnable=FUiToolButton_setEnable;b.doClick=FUiToolButton_doClick;b.dispose=FUiToolButton_dispose;
return b}function FUiToolButton_onBuildPanel(b){this._hPanel=RBuilder.createDiv(b,this.styleName("Panel"))}
function FUiToolButton_onBuildButton(b){b=this._hPanel;this.attachEvent("onMouseDown",b);this.attachEvent("onMouseUp",b);b=this._hForm=RBuilder.appendTable(b,this.styleName("Normal"));b=this._hLine=RBuilder.appendTableRow(b);if(this._icon){var d=this._hIconPanel=RBuilder.appendTableCell(b,this.styleName("IconPanel"));this._hIcon=RBuilder.appendIcon(d,null,this._icon)}this._icon&&this._label&&(this.hSpacePanel=RBuilder.appendTableCell(b,this.styleName("SpacePanel")));this._label&&((this._hLabelPanel=
RBuilder.appendTableCell(b,this.styleName("LabelPanel"))).noWrap=!0,this.setLabel(this._label));this._hotkey&&RConsole.find(FKeyConsole).register(this._hotkey,this,this.onMouseDown);this._hint&&this.setHint(this._hint)}function FUiToolButton_onBuild(b){this.__base.FUiControl.onBuild.call(this,b);this.onBuildButton(b)}function FUiToolButton_onEnter(b){this._disabled||(this._hForm.className=this.styleName("Hover"))}
function FUiToolButton_onLeave(b){this._disabled||(this._hForm.className=this.styleName("Normal"))}function FUiToolButton_onMouseDown(){this._disabled||(this._hForm.className=this.styleName("Press"),this.doClick())}function FUiToolButton_onMouseUp(b){this._disabled||(this._hForm.className=this.styleName("Hover"))}function FUiToolButton_icon(){return this._icon}function FUiToolButton_setIcon(b){this._icon=b;this._hIcon&&(this._hIcon.src=this.styleIconPath(this._icon))}
function FUiToolButton_setLabel(b){this._label=b=RString.nvl(b);var d=this._hLabelPanel;d&&RHtml.textSet(d,b)}function FUiToolButton_setHint(b){this._hint=b;RString.nvl(b);this._hPanel.title=this._hint}
function FUiToolButton_setEnable(b){this.__base.FUiControl.oeEnable.call(this,e);this._disabled=!e.enable;e.enable&&this._icon?(b=RResource.iconPath(this._icon),this._hIcon.src!=b&&(this._hIcon.src=b)):!e.enable&&this._iconDisable&&(b=RResource.iconPath(this._iconDisable),this._hIcon.src!=b&&(this._hIcon.src=b));b=this.styleName(e.enable?"Icon":"IconDisable");this._hIcon.className!=b&&(this._hIcon.className=b);b=this.styleName(e.enable?"Button":"Disable");this._hPanel.className!=b&&(this._hPanel.className=
b);b=this.styleIconPath(e.enable?"Button":"ButtonDisable");this._hButton.background!=b&&(this._hButton.background=b);return EEventStatus.Stop}function FUiToolButton_doClick(){if(!this._disabled){RConsole.find(FUiFocusConsole).blur();RLogger.debug(this,"Tool button click. (label={1})",this._label);var b=new SClickEvent(this);this.processClickListener(b);b.dispose();this._action&&eval(this._action)}}
function FUiToolButton_dispose(){this._hForm=RHtml.free(this._hForm);this._hLine=RHtml.free(this._hLine);this._hIconPanel=RHtml.free(this._hIconPanel);this._hIcon=RHtml.free(this._hIcon);this._hSpacePanel=RHtml.free(this._hSpacePanel);this._hLabelPanel=RHtml.free(this._hLabelPanel);this.__base.FUiControl.dispose.call(this)}
function FUiToolButtonCheck(b){b=RClass.inherits(this,b,FUiToolButton);b._optionChecked=RClass.register(b,new APtyBoolean("_optionChecked","check"));b._groupName=RClass.register(b,new APtyString("_groupName"));b._groupDefault=RClass.register(b,new APtyString("_groupDefault"));b._statusChecked=!1;b.onEnter=FUiToolButtonCheck_onEnter;b.onLeave=FUiToolButtonCheck_onLeave;b.onMouseDown=FUiToolButtonCheck_onMouseDown;b.onMouseUp=FUiToolButtonCheck_onMouseUp;b.groupName=FUiToolButtonCheck_groupName;b.setGroupName=
FUiToolButtonCheck_setGroupName;b.groupDefault=FUiToolButtonCheck_groupDefault;b.setGroupDefault=FUiToolButtonCheck_setGroupDefault;b.innerCheck=FUiToolButtonCheck_innerCheck;b.isCheck=FUiToolButtonCheck_isCheck;b.check=FUiToolButtonCheck_check;b.dispose=FUiToolButtonCheck_dispose;return b}function FUiToolButtonCheck_onEnter(b){this._statusChecked||(this._hForm.className=this.styleName("Hover"))}
function FUiToolButtonCheck_onLeave(b){this._statusChecked||(this._hForm.className=this.styleName("Normal"))}function FUiToolButtonCheck_onMouseDown(b){this.check(!this._statusChecked);b=new SClickEvent(this);b.checked=this._statusChecked;this.processClickListener(b,this._statusChecked);b.dispose()}function FUiToolButtonCheck_onMouseUp(){}function FUiToolButtonCheck_groupName(){return this._groupName}function FUiToolButtonCheck_setGroupName(b){this._groupName=b}
function FUiToolButtonCheck_groupDefault(){return this._groupDefault}function FUiToolButtonCheck_setGroupDefault(b){this._groupDefault=b}function FUiToolButtonCheck_innerCheck(b){this._statusChecked!=b&&(this._statusChecked=b,this._hForm.className=b?this.styleName("Press"):this.styleName("Normal"))}function FUiToolButtonCheck_isCheck(){return this._statusChecked}
function FUiToolButtonCheck_check(b){if(b||this._groupDefault!=this)if(this.innerCheck(b),this._parent)if(b){if(!RString.isEmpty(this._groupName)){b=this._parent.components();for(var d=b.count()-1;0<=d;d--){var f=b.value(d);f!=this&&RClass.isClass(f,FUiToolButtonCheck)&&f.innerCheck(!1)}}}else RString.isEmpty(this._groupDefault)||((b=this._parent.components().get(this._groupDefault))?b.innerCheck(!0):RLogger.error("Can't find group default control. (name={1})",this._groupDefault))}
function FUiToolButtonCheck_dispose(){this._groupName=this._statusChecked=null;this.__base.FUiToolButton.dispose.call(this)}
function FUiToolButtonEdit(b){b=RClass.inherits(this,b,FUiToolButton,MListenerDataChanged);b._editSize=RClass.register(b,new APtySize2("_editSize"));b._hEdit=null;b.onBuildButton=FUiToolButtonEdit_onBuildButton;b.onEnter=RMethod.empty;b.onLeave=RMethod.empty;b.onInputEdit=RClass.register(b,new AEventInputChanged("onInputEdit"),FUiToolButtonEdit_onInputEdit);b.onInputKeyDown=RClass.register(b,new AEventKeyDown("onInputKeyDown"),FUiToolButtonEdit_onInputKeyDown);b.construct=FUiToolButtonEdit_construct;
b.text=FUiToolButtonEdit_text;b.setText=FUiToolButtonEdit_setText;return b}
function FUiToolButtonEdit_onBuildButton(b){b=this._hForm=RBuilder.appendTable(this._hPanel);b=this._hLine=RBuilder.appendTableRow(b);var d=this._hEditPanel=RBuilder.appendTableCell(b),d=this._hEdit=RBuilder.appendEdit(d);d.style.width=this._editSize.width+"px";this.attachEvent("onInputEdit",d,this.onInputEdit);this.attachEvent("onInputKeyDown",d);this._hEditSpacePanel=RBuilder.appendTableCell(b,this.styleName("SpacePanel"));this._icon&&(d=this._hIconPanel=RBuilder.appendTableCell(b,this.styleName("IconPanel")),
this._hIcon=RBuilder.appendIcon(d,null,this._icon));this._icon&&this._label&&(this._hSpacePanel=RBuilder.appendTableCell(b,this.styleName("SpacePanel")));this._label&&(b=this._hLabelPanel=RBuilder.appendTableCell(b,this.styleName("LabelPanel")),this.attachEvent("onMouseDown",b),this.attachEvent("onMouseUp",b),b.noWrap=!0,this.setLabel(this._label));this._hotkey&&RConsole.find(FKeyConsole).register(this._hotkey,this,this.onMouseDown);this._hint&&this.setHint(this._hint)}
function FUiToolButtonEdit_onInputEdit(b){this.processDataChangedListener(this)}function FUiToolButtonEdit_onInputKeyDown(b){b.keyCode==EKeyCode.Enter&&this.doClick()}function FUiToolButtonEdit_construct(){this.__base.FUiToolButton.construct.call(this);this._editSize=new SSize2}function FUiToolButtonEdit_text(){return this._hEdit.value}function FUiToolButtonEdit_setText(b){this._hEdit.value=b}
function FUiToolButtonMenu(b){b=RClass.inherits(this,b,FUiToolButton,MUiContainer,MUiDropable,MUiFocus);b._menu=null;b._statusDrop=!1;b._hDropPanel=null;b._stylePanel=RClass.register(b,new AStyle("_stylePanel"));b._styleDropHover=RClass.register(b,new AStyleIcon("_styleDropHover"));b.onBuild=FUiToolButtonMenu_onBuild;b.onEnter=FUiToolButtonMenu_onEnter;b.onLeave=FUiToolButtonMenu_onLeave;b.onMouseDown=FUiToolButtonMenu_onMouseDown;b.onBlur=FUiToolButtonMenu_onBlur;b.onMouseUp=RMethod.empty;b.construct=
FUiToolButtonMenu_construct;b.push=FUiToolButtonMenu_push;b.drop=FUiToolButtonMenu_drop;b.doClick=FUiToolButtonMenu_doClick;b.dispose=FUiToolButtonMenu_dispose;return b}function FUiToolButtonMenu_onBuild(b){this.__base.FUiToolButton.onBuild.call(this,b);var d=this._hDropPanel=RBuilder.appendTableCell(this._hLine);this.onBuildDrop(d);this._menu.onBuild(b)}function FUiToolButtonMenu_onEnter(b){this._statusDrop||this.__base.FUiToolButton.onEnter.call(this,b)}
function FUiToolButtonMenu_onLeave(b){this._statusDrop||this.__base.FUiToolButton.onLeave.call(this,b)}function FUiToolButtonMenu_onMouseDown(){this._statusDrop||(this._hForm.className=this.styleName("Press"),this.doClick())}function FUiToolButtonMenu_onBlur(b){}function FUiToolButtonMenu_construct(){this.__base.FUiToolButton.construct.call(this);(this._menu=RClass.create(FUiPopupMenu))._opener=this}
function FUiToolButtonMenu_push(b){if(RClass.isClass(b,MUiMenuButton))return this._menu.push(b);this.__base.FUiToolButton.push.call(this,b)}function FUiToolButtonMenu_drop(b){this._disabled||((this._statusDrop=!this._statusDrop)?(this._hForm.className=this.styleName("Press"),this._menu.show(this._hDropPanel,EUiAlign.BottomRight),RConsole.find(FUiPopupConsole).show(this._menu)):(this._hForm.className=this.styleName("Normal"),this._menu.hide()))}
function FUiToolButtonMenu_doClick(){this.__base.FUiToolButton.doClick.call(this);this.drop(!this._statusDrop)}function FUiToolButtonMenu_dispose(){this._hDropIcon=RHtml.free(this._hDropIcon);this._hDropPanel=RHtml.free(this._hDropPanel);this.__base.FControl.dispose.call(this)}function FUiToolButtonSplit(b){b=RClass.inherits(this,b,FUiToolButton,MUiToolButton);b._stylePanel=RClass.register(b,new AStyle("_stylePanel"));b.onBuild=FUiToolButtonSplit_onBuild;return b}
function FUiToolButtonSplit_onBuild(b){this.__base.FUiControl.onBuild.call(this,b);this._hPanel.className=this.styleName("Panel")}function FUiToolButtonText(b){return b=RClass.inherits(this,b,FUiToolButton)}var RUiToolBar=new function(){this.fromNode=RUiToolBar_fromNode;return this};
function RUiToolBar_mergeNode(b,d,f){d=d.nodes;for(var h=0;h<d.count;h++){var q=d.get(h);if("ToolBar"==q.name&&q.nodes)for(var z=0;z<q.nodes.count;z++)b.push(q.nodes.get(z))}if(f)for(h=d.count-1;0<=h;h--)q=d.get(h),"ToolBar"==q.name&&d.removeItem(q);return b}
function RUiToolBar_fromNode(b,d,f,h){if(d&&d._nodes){var q=null;d=d._nodes;for(var z=d.count(),A=0;A<z;A++){var B=d.getAt(A);B.isName("ToolBar")&&(q?B.hasNode()&&q.nodes().append(B.nodes()):q=B)}if(h)for(h=0;h<d.count();h++)B=d.getAt(h),B.isName("ToolBar")&&d.erase(h--);q&&RControl.build(b,q,null,f)}}
function FUiPageControl(b){b=RClass.inherits(this,b,FUiContainer);b._sizeCd=EUiSize.Horizontal;b._stylePanel=RClass.register(b,new AStyle("_stylePanel"));b._styleTitlePanel=RClass.register(b,new AStyle("_styleTitlePanel"));b._styleTitleForm=RClass.register(b,new AStyle("_styleTitleForm"));b._styleDataPanel=RClass.register(b,new AStyle("_styleDataPanel"));b._styleDataForm=RClass.register(b,new AStyle("_styleDataForm"));b._styleTop=RClass.register(b,new AStyle("_styleTop"));b._styleBottom=RClass.register(b,
new AStyle("_styleBottom"));b._styleForm=RClass.register(b,new AStyle("_styleForm"));b._sheets=null;b._activeSheet=null;b._esize=EUiSize.Both;b._hTop=null;b._hLine=null;b._hBottom=null;b._hSheets=null;b.onBuildPanel=FUiPageControl_onBuildPanel;b.onBuild=FUiPageControl_onBuild;b.oeRefresh=FUiPageControl_oeRefresh;b.construct=FUiPageControl_construct;b.appendChild=FUiPageControl_appendChild;b.select=FUiPageControl_select;b.selectByIndex=FUiPageControl_selectByIndex;b.sheet=FUiPageControl_sheet;b.push=
FUiPageControl_push;b.dispose=FUiPageControl_dispose;return b}function FUiPageControl_onBuildPanel(b){(this._hPanel=RBuilder.createTable(b,this.styleName("Panel"))).width="100%"}
function FUiPageControl_onBuild(b){this.__base.FUiContainer.onBuild.call(this,b);b=RBuilder.appendTableRowCell(this._hPanel,this.styleName("TitlePanel"));b=this.hTitleForm=RBuilder.appendTable(b,this.styleName("TitleForm"));b.width="100%";var d=this._hTop=RBuilder.appendTableRow(b);d.height=1;this._hLine=RBuilder.appendTableRow(b);d=this._hBottom=RBuilder.appendTableRow(b);d.height=1;b=this._hFirstTop=RBuilder.appendTableCell(this._hTop);b.width=12;this._hFirst=RBuilder.appendTableCell(this._hLine);
(this._hFirstBottom=RBuilder.appendTableCell(this._hBottom)).className=this.styleName("Bottom",FUiPageSheet);this._hLastTop=RBuilder.appendTableCell(this._hTop);this._hLast=RBuilder.appendTableCell(this._hLine);b=this._hLastBottom=RBuilder.appendTableCell(this._hBottom);b.className=this.styleName("Bottom",FUiPageSheet)}
function FUiPageControl_oeRefresh(b){var d=this.__base.FUiContainer.oeRefresh.call(this,b);b.isBefore()&&this._sheets.count()&&(this._activeSheet?this._activeSheet.oeRefresh(e):(b=this._activeSheet=this._sheets.value(0))&&b.innerSelect(!0));return d}function FUiPageControl_construct(){this.__base.FUiContainer.construct.call(this);this._sheets=new TDictionary}
function FUiPageControl_appendChild(b){if(RClass.isClass(b,FUiPageSheet)){var d=this._hLast.cellIndex,f=b._hTopL=RBuilder.appendTableCell(this._hTop,null,d);f.width=1;f.className=b.styleName("Top");f=b._hTop=RBuilder.appendTableCell(this._hTop,null,d+1);f.className=b.styleName("Top");f=b._hTopR=RBuilder.appendTableCell(this._hTop,null,d+2);f.width=1;f.className=b.styleName("Top");f=b._hLeft=RBuilder.appendTableCell(this._hLine,null,d);f.width=1;f.className=b.styleName("Left");f=b._hButtonPanel=RBuilder.appendTableCell(this._hLine,
null,d+1);b.attachEvent("onButtonEnter",f);b.attachEvent("onButtonLeave",f);b.attachEvent("onHeadMouseDown",f);f.width=1;f=b._hButton=RBuilder.appendDiv(f,b.styleName("Button"));b.icon&&(b._hIcon=RBuilder.appendIcon(f,null,b.icon));b.label&&(b._hText=RBuilder.appendSpan(f,b.styleName("ButtonText")),b._hText.innerText=" "+b.label());f=b._hRight=RBuilder.appendTableCell(this._hLine,null,d+2);f.width=1;f.className=b.styleName("Right");f=b._hBottomL=RBuilder.appendTableCell(this._hBottom,null,d);f.width=
1;f.className=b.styleName("Bottom");f=b._hBottom=RBuilder.appendTableCell(this._hBottom,null,d+1);f.className=b.styleName("Bottom");f=b._hBottomR=RBuilder.appendTableCell(this._hBottom,null,d+2);f.width=1;f.className=b.styleName("Bottom");d=RBuilder.appendTableRow(this._hPanel);b.index&&(d.style.display="none");f=RBuilder.appendTableCell(d);b._hForm=d;f.style.verticalAlign="top";f.appendChild(b._hPanel);this.selectByIndex(0)}}function FUiPageControl_sheet(b){return this._sheets.get(b)}
function FUiPageControl_select(b){this._activeSheet=b;for(var d=this._sheets,f=d.count(),h=0;h<f;h++){var q=d.at(h);q!=b&&q.select(!1)}b.select(!0)}function FUiPageControl_selectByIndex(b){(b=this._sheets.value(b))&&this.select(b)}function FUiPageControl_push(b){if(RClass.isClass(b,FUiPageSheet)){var d=this._sheets;b._pageControl=this;b._index=d.count();d.set(b.name(),b)}this.__base.FUiContainer.push.call(this,b)}function FUiPageControl_dispose(){this.__base.FUiContainer.dispose.call(this)}
function FUiPageSheet(b){b=RClass.inherits(this,b,FUiLayout);b._icon=RClass.register(b,new APtyString("_icon"));b._formName=RClass.register(b,new APtyString("_formName"));b._formLink=RClass.register(b,new APtyString("_formLink"));b._formWhere=RClass.register(b,new APtyString("_formWhere"));b._formOrder=RClass.register(b,new APtyString("_formOrder"));b._stylePanel=RClass.register(b,new AStyle("_stylePanel"));b._styleTop=RClass.register(b,new AStyle("_styleTop"));b._styleTopSelect=RClass.register(b,
new AStyle("_styleTopSelect"));b._styleLeft=RClass.register(b,new AStyle("_styleLeft"));b._styleLeftSelect=RClass.register(b,new AStyle("_styleLeftSelect"));b._styleRight=RClass.register(b,new AStyle("_styleRight"));b._styleRightSelect=RClass.register(b,new AStyle("_styleRightSelect"));b._styleRightPrior=RClass.register(b,new AStyle("_styleRightPrior"));b._styleButtom=RClass.register(b,new AStyle("_styleBottom"));b._styleBottomSelect=RClass.register(b,new AStyle("_styleBottomSelect"));b._styleButtonText=
RClass.register(b,new AStyle("_styleButtonText"));b._styleButton=RClass.register(b,new AStyle("_styleButton"));b._styleButtonHover=RClass.register(b,new AStyle("_styleButtonHover"));b._styleButtonSelect=RClass.register(b,new AStyle("_styleButtonSelect"));b._styleDataPanel=RClass.register(b,new AStyle("_styleDataPanel"));b._top=0;b._pages=null;b._index=null;b._selected=!1;b._hasBuilded=!1;b.lsnsSelect=null;b._hTopL=null;b._hTop=null;b._hTopR=null;b._hLeft=null;b._hButton=null;b._hIcon=null;b._hText=
null;b._hBottomL=null;b._hBottom=null;b._hBottomR=null;b._hRight=null;b.onBuildPanel=FUiPageSheet_onBuildPanel;b.onButtonEnter=RClass.register(b,new AEventMouseEnter("onButtonEnter"),FUiPageSheet_onButtonEnter);b.onButtonLeave=RClass.register(b,new AEventMouseLeave("onButtonLeave"),FUiPageSheet_onButtonLeave);b.onHeadMouseDown=RClass.register(b,new AEventMouseDown("onHeadMouseDown"),FUiPageSheet_onHeadMouseDown);b.construct=FUiPageSheet_construct;b.innerSelect=FUiPageSheet_innerSelect;b.select=FUiPageSheet_select;
b.setVisible=FUiPageSheet_setVisible;b.dispose=FUiPageSheet_dispose;b.innerDump=FUiPageSheet_innerDump;return b}function FUiPageSheet_onBuildPanel(b){b=this._hPanel=this._hContainer=RBuilder.createDiv(b,this.styleName("Panel"));b.style.width="100%";b.style.height="100%";b=this._hPanelForm=RBuilder.appendTable(b);b.style.width="100%";b.style.height="100%"}function FUiPageSheet_onButtonEnter(b){this._selected||(this._hButton.className=this.styleName("ButtonHover"))}
function FUiPageSheet_onButtonLeave(b){this._selected||(this._hButton.className=this.styleName("Button"))}function FUiPageSheet_onHeadMouseDown(b){this._parent.select(this)}function FUiPageSheet_construct(){this.__base.FUiLayout.construct.call(this);this.lsnsSelect=new TListeners}
function FUiPageSheet_innerSelect(b){var d=this._parent;b&&!this._hasBuilded&&(this._hasBuilded=!0);var f=0==this._index,d=d._activeSheet._index-1==this._index;this._selected!=b&&(b&&this.lsnsSelect.process(),this._selected=b);this._hButton.className=b?this.styleName("ButtonSelect"):this.styleName("Button");this._hTop.className=b?this.styleName("TopSelect"):this.styleName("Top");this._hLeft.className=b?this.styleName("LeftSelect"):f?this.styleName("Right"):this.styleName("Left");this._hBottomL.className=
b?this.styleName("BottomSelect"):this.styleName("Bottom");this._hBottom.className=b?this.styleName("BottomSelect"):this.styleName("Bottom");this._hBottomR.className=b?this.styleName("BottomSelect"):this.styleName("Bottom");this._hRight.className=b?this.styleName("RightSelect"):d?this.styleName("RightPrior"):this.styleName("Right");RHtml.visibleSet(this._hForm,b)}function FUiPageSheet_select(b){this.innerSelect(b);b&&(this.psRefresh(),this.psResize())}
function FUiPageSheet_setVisible(b){RHtml.displaySet(this._hPanel,b)}function FUiPageSheet_dispose(){this._hButton=RMemory.free(this._hButton);this._hTop=RMemory.free(this._hTop);this._hLeft=RMemory.free(this._hLeft);this._hBottomL=RMemory.free(this._hBottomL);this._hBottom=RMemory.free(this._hBottom);this._hBottomR=RMemory.free(this._hBottomR);this._hRight=RMemory.free(this._hRight);this.__base.FUiLayout.dispose.call(this)}
function FUiPageSheet_innerDump(b,d){b.append(d,RClass.dump(this)," [");b.append("name=",this._name,", ");b.append("icon=",this._icon,", ");b.append("label=",this.label,", ");b.append("action=",this.action,"]")}
function FUiTabBar(b){b=RClass.inherits(this,b,FUiContainer,MUiDescribeFrame);b._sizeCd=EUiSize.Horizontal;b._stylePanel=RClass.register(b,new AStyle("_stylePanel"));b._styleTitlePanel=RClass.register(b,new AStyle("_styleTitlePanel"));b._styleTitleForm=RClass.register(b,new AStyle("_styleTitleForm"));b._styleDataPanel=RClass.register(b,new AStyle("_styleDataPanel"));b._styleDataForm=RClass.register(b,new AStyle("_styleDataForm"));b._styleTop=RClass.register(b,new AStyle("_styleTop"));b._styleBottom=
RClass.register(b,new AStyle("_styleBottom"));b._styleForm=RClass.register(b,new AStyle("_styleForm"));b._buttons=null;b._activeButton=null;b._esize=EUiSize.Both;b._hTop=null;b._hLine=null;b._hBottom=null;b._hSheets=null;b.onBuildPanel=FUiTabBar_onBuildPanel;b.onBuild=FUiTabBar_onBuild;b.oeRefresh=FUiTabBar_oeRefresh;b.construct=FUiTabBar_construct;b.activeButton=FUiTabBar_activeButton;b.appendChild=FUiTabBar_appendChild;b.select=FUiTabBar_select;b.selectByIndex=FUiTabBar_selectByIndex;b.selectByName=
FUiTabBar_selectByName;b.sheet=FUiTabBar_sheet;b.push=FUiTabBar_push;b.dispose=FUiTabBar_dispose;return b}function FUiTabBar_onBuildPanel(b){(this._hPanel=RBuilder.createTable(b,this.styleName("Panel"))).width="100%"}
function FUiTabBar_onBuild(b){this.__base.FUiContainer.onBuild.call(this,b);b=RBuilder.appendTableRowCell(this._hPanel,this.styleName("TitlePanel"));b.vAlign="bottom";b=this.hTitleForm=RBuilder.appendTable(b,this.styleName("TitleForm"));b.width="100%";var d=this._hTop=RBuilder.appendTableRow(b);d.height=1;this._hLine=RBuilder.appendTableRow(b);d=this._hBottom=RBuilder.appendTableRow(b);d.height=1;b=this._hFirstTop=RBuilder.appendTableCell(this._hTop);b.width=20;this._hFirst=RBuilder.appendTableCell(this._hLine);
(this._hFirstBottom=RBuilder.appendTableCell(this._hBottom)).className=this.styleName("Bottom",FUiTabButton);this._hLastTop=RBuilder.appendTableCell(this._hTop);this._hLast=RBuilder.appendTableCell(this._hLine);b=this._hLastBottom=RBuilder.appendTableCell(this._hBottom);b.className=this.styleName("Bottom",FUiTabButton)}
function FUiTabBar_oeRefresh(b){var d=this.__base.FUiContainer.oeRefresh.call(this,b);b.isBefore()&&this._buttons.count()&&(this._activeButton?this._activeButton.oeRefresh(e):(b=this._activeButton=this._buttons.value(0))&&b.innerSelect(!0));return d}function FUiTabBar_construct(){this.__base.FUiContainer.construct.call(this);this._buttons=new TDictionary}function FUiTabBar_activeButton(){return this._activeButton}
function FUiTabBar_appendChild(b){if(RClass.isClass(b,FUiTabButton)){var d=this._hLast.cellIndex,f=b._hTopL=RBuilder.appendTableCell(this._hTop,null,d);f.width=1;f.className=b.styleName("Top");f=b._hTop=RBuilder.appendTableCell(this._hTop,null,d+1);f.className=b.styleName("Top");f=b._hTopR=RBuilder.appendTableCell(this._hTop,null,d+2);f.width=1;f.className=b.styleName("Top");f=b._hLeft=RBuilder.appendTableCell(this._hLine,null,d);f.width=1;f.className=b.styleName("Left");f=b._hButtonPanel=RBuilder.appendTableCell(this._hLine,
null,d+1);b.attachEvent("onButtonEnter",f);b.attachEvent("onButtonLeave",f);b.attachEvent("onButtonClick",f);f.width=1;f=b._hButton=RBuilder.append(f,"DIV",b.styleName("Button"));b.icon&&(b._hIcon=RBuilder.appendIcon(f,null,b.icon));b.label&&(b._hText=RBuilder.appendSpan(f,b.styleName("ButtonText")),b._hText.innerText=" "+b.label());f=b._hRight=RBuilder.appendTableCell(this._hLine,null,d+2);f.width=1;f.className=b.styleName("Right");f=b._hBottomL=RBuilder.appendTableCell(this._hBottom,null,d);f.width=
1;f.className=b.styleName("Bottom");f=b._hBottom=RBuilder.appendTableCell(this._hBottom,null,d+1);f.className=b.styleName("Bottom");f=b._hBottomR=RBuilder.appendTableCell(this._hBottom,null,d+2);f.width=1;f.className=b.styleName("Bottom");this.selectByIndex(0)}}function FUiTabBar_sheet(b){return this._buttons.get(b)}function FUiTabBar_select(b){var d=this._buttons.count();this._activeButton=b;for(var f=0;f<d;f++){var h=this._buttons.value(f);h!=b&&h.select(!1)}b.select(!0)}
function FUiTabBar_selectByIndex(b){(b=this._buttons.value(b))&&this.select(b)}function FUiTabBar_selectByName(b){(b=this.findControl(b))&&this.select(b)}function FUiTabBar_push(b){if(RClass.isClass(b,FUiTabButton)){var d=this._buttons;b._index=d.count();d.set(b.name(),b)}this.__base.FUiContainer.push.call(this,b)}function FUiTabBar_dispose(){this.__base.FUiContainer.dispose.call(this)}
function FUiTabButton(b){b=RClass.inherits(this,b,FUiControl,MListenerClick);b._icon=RClass.register(b,new APtyString("_icon"));b._formName=RClass.register(b,new APtyString("_formName"));b._formLink=RClass.register(b,new APtyString("_formLink"));b._formWhere=RClass.register(b,new APtyString("_formWhere"));b._formOrder=RClass.register(b,new APtyString("_formOrder"));b._styleTop=RClass.register(b,new AStyle("_styleTop"));b._styleTopSelect=RClass.register(b,new AStyle("_styleTopSelect"));b._styleLeft=
RClass.register(b,new AStyle("_styleLeft"));b._styleLeftSelect=RClass.register(b,new AStyle("_styleLeftSelect"));b._styleRight=RClass.register(b,new AStyle("_styleRight"));b._styleRightSelect=RClass.register(b,new AStyle("_styleRightSelect"));b._styleRightPrior=RClass.register(b,new AStyle("_styleRightPrior"));b._styleButtom=RClass.register(b,new AStyle("_styleBottom"));b._styleBottomSelect=RClass.register(b,new AStyle("_styleBottomSelect"));b._styleButtonText=RClass.register(b,new AStyle("_styleButtonText"));
b._styleButton=RClass.register(b,new AStyle("_styleButton"));b._styleButtonHover=RClass.register(b,new AStyle("_styleButtonHover"));b._styleButtonSelect=RClass.register(b,new AStyle("_styleButtonSelect"));b._styleDataPanel=RClass.register(b,new AStyle("_styleDataPanel"));b._top=0;b._pages=null;b._index=null;b._selected=!1;b._hasBuilded=!1;b.lsnsSelect=null;b._hTopL=null;b._hTop=null;b._hTopR=null;b._hLeft=null;b._hButton=null;b._hIcon=null;b._hText=null;b._hBottomL=null;b._hBottom=null;b._hBottomR=
null;b._hRight=null;b.onBuildPanel=FUiTabButton_onBuildPanel;b.onButtonEnter=RClass.register(b,new AEventMouseEnter("onButtonEnter"),FUiTabButton_onButtonEnter);b.onButtonLeave=RClass.register(b,new AEventMouseLeave("onButtonLeave"),FUiTabButton_onButtonLeave);b.onButtonClick=RClass.register(b,new AEventClick("onButtonClick"),FUiTabButton_onButtonClick);b.construct=FUiTabButton_construct;b.innerSelect=FUiTabButton_innerSelect;b.select=FUiTabButton_select;b.setVisible=FUiTabButton_setVisible;b.doClick=
FUiTabButton_doClick;b.dispose=FUiTabButton_dispose;b.innerDump=FUiTabButton_innerDump;return b}function FUiTabButton_onBuildPanel(b){b=this._hContainer=this._hPanel=RBuilder.createDiv(b);b.width="100%";b.height="100%"}function FUiTabButton_onButtonEnter(b){this._selected||(this._hButton.className=this.styleName("ButtonHover"))}function FUiTabButton_onButtonLeave(b){this._selected||(this._hButton.className=this.styleName("Button"))}function FUiTabButton_onButtonClick(b){this.doClick()}
function FUiTabButton_construct(){this.__base.FUiControl.construct.call(this);this.lsnsSelect=new TListeners}
function FUiTabButton_innerSelect(b){var d=this._parent;b&&!this._hasBuilded&&(this._hasBuilded=!0);var f=0==this._index,d=d._activeButton._index-1==this._index;this._selected!=b&&(b&&this.lsnsSelect.process(),this._selected=b);this._hButton.className=b?this.styleName("ButtonSelect"):this.styleName("Button");this._hTop.className=b?this.styleName("TopSelect"):this.styleName("Top");this._hLeft.className=b?this.styleName("LeftSelect"):f?this.styleName("Right"):this.styleName("Left");this._hBottomL.className=
b?this.styleName("BottomSelect"):this.styleName("Bottom");this._hBottom.className=b?this.styleName("BottomSelect"):this.styleName("Bottom");this._hBottomR.className=b?this.styleName("BottomSelect"):this.styleName("Bottom");this._hRight.className=b?this.styleName("RightSelect"):d?this.styleName("RightPrior"):this.styleName("Right")}function FUiTabButton_select(b){this.innerSelect(b);b&&(this.psRefresh(),this.psResize())}function FUiTabButton_setVisible(b){RHtml.displaySet(this._hPanel,b)}
function FUiTabButton_doClick(){this._parent.select(this);var b=new SClickEvent(this);this.processClickListener(b);b.dispose()}function FUiTabButton_dispose(){this._hButton=RMemory.free(this._hButton);this._hTop=RMemory.free(this._hTop);this._hLeft=RMemory.free(this._hLeft);this._hBottomL=RMemory.free(this._hBottomL);this._hBottom=RMemory.free(this._hBottom);this._hBottomR=RMemory.free(this._hBottomR);this._hRight=RMemory.free(this._hRight);this.__base.FUiControl.dispose.call(this)}
function FUiTabButton_innerDump(b,d){b.append(d,RClass.dump(this)," [");b.append("name=",this._name,", ");b.append("icon=",this._icon,", ");b.append("label=",this.label,", ");b.append("action=",this.action,"]")}
function FUiTreeColumn(b){b=RClass.inherits(this,b,FUiControl);b._icon=RClass.register(b,new APtyString("_icon"));b._dataName=RClass.register(b,new APtyString("_dataName"));b._display=RClass.register(b,new APtyBoolean("_display"),EBoolean.False);b._config=RClass.register(b,new APtyConfig("_config"));b.oeBuild=FUiTreeColumn_oeBuild;b.onBuildPanel=FUiTreeColumn_onBuildPanel;return b}
function FUiTreeColumn_oeBuild(b){this.__base.FUiControl.oeBuild.call(this,b);b=this.hPanel;b.innerText=RString.nvl(this.label);b.noWrap=!0;this.display||(b.style.display="block");this.width&&(b.width=this.width);return EEventStatus.Stop}function FUiTreeColumn_onBuildPanel(){this.hPanel=RBuilder.create(null,"TD")}
function FUiTreeLevel(b){b=RClass.inherits(this,b,FUiControl);b._id=RClass.register(b,new APtyString("_id"));b._color=RClass.register(b,new APtyString("_color"));b._backColor=RClass.register(b,new APtyString("_backColor"));return b}
function FUiTreeNode(b){b=RClass.inherits(this,b,FUiContainer,MUiDataProperties);b._valid=RClass.register(b,new APtyBoolean("_valid","is_valid"),!0);b._child=RClass.register(b,new APtyBoolean("_child","has_child"),!1);b._typeCode=RClass.register(b,new APtyString("_typeCode"));b._guid=RClass.register(b,new APtyString("_guid"));b._code=RClass.register(b,new APtyString("_code"));b._icon=RClass.register(b,new APtyString("_icon"));b._checked=RClass.register(b,new APtyBoolean("_checked"),!1);b._extended=
RClass.register(b,new APtyBoolean("_extended"),!1);b._note=RClass.register(b,new APtyString("_note"));b._attributes=RClass.register(b,new APtyAttributes("_attributes"));b._styleNormal=RClass.register(b,new AStyle("_styleNormal"));b._styleHover=RClass.register(b,new AStyle("_styleHover"));b._styleSelect=RClass.register(b,new AStyle("_styleSelect"));b._styleImage=RClass.register(b,new AStyle("_styleImage"));b._styleIcon=RClass.register(b,new AStyle("_styleIcon"));b._styleIconDisable=RClass.register(b,
new AStyle("_styleIconDisable"));b._styleLabel=RClass.register(b,new AStyle("_styleLabel"));b._styleCell=RClass.register(b,new AStyle("_styleCell"));b._tree=null;b._level=0;b._nodes=null;b._cells=null;b._statusLinked=!1;b._statusDisplay=!0;b._statusSelected=!1;b._statusLoaded=!1;b._statusHover=!1;b._hNodePanel=null;b._hCheck=null;b._hImage=null;b._hIcon=null;b._hLabel=null;b.onBuildPanel=FUiTreeNode_onBuildPanel;b.onBuild=FUiTreeNode_onBuild;b.onNodeEnter=RClass.register(b,new AEventMouseEnter("onNodeEnter"),
FUiTreeNode_onNodeEnter);b.onNodeLeave=RClass.register(b,new AEventMouseLeave("onNodeLeave"),FUiTreeNode_onNodeLeave);b.onNodeClick=RClass.register(b,new AEventClick("onNodeClick"),FUiTreeNode_onNodeClick);b.construct=FUiTreeNode_construct;b.code=FUiTreeNode_code;b.setCode=FUiTreeNode_setCode;b.guid=FUiTreeNode_guid;b.setGuid=FUiTreeNode_setGuid;b.type=FUiTreeNode_type;b.typeCode=FUiTreeNode_typeCode;b.setTypeCode=FUiTreeNode_setTypeCode;b.setLabel=FUiTreeNode_setLabel;b.setNote=FUiTreeNode_setNote;
b.level=FUiTreeNode_level;b.setLevel=FUiTreeNode_setLevel;b.cell=FUiTreeNode_cell;b.cells=FUiTreeNode_cells;b.check=FUiTreeNode_check;b.setCheck=FUiTreeNode_setCheck;b.setImage=FUiTreeNode_setImage;b.calculateImage=FUiTreeNode_calculateImage;b.setIcon=FUiTreeNode_setIcon;b.get=FUiTreeNode_get;b.set=FUiTreeNode_set;b.isFolder=FUiTreeNode_isFolder;b.hasChild=FUiTreeNode_hasChild;b.topNode=FUiTreeNode_topNode;b.topNodeByType=FUiTreeNode_topNodeByType;b.nodeCount=FUiTreeNode_nodeCount;b.show=FUiTreeNode_show;
b.hide=FUiTreeNode_hide;b.select=FUiTreeNode_select;b.extend=FUiTreeNode_extend;b.extendAll=FUiTreeNode_extendAll;b.searchLast=FUiTreeNode_searchLast;b.createChild=FUiTreeNode_createChild;b.appendChild=FUiTreeNode_appendChild;b.appendNode=FUiTreeNode_appendNode;b.push=FUiTreeNode_push;b.remove=FUiTreeNode_remove;b.removeSelf=FUiTreeNode_removeSelf;b.removeChildren=FUiTreeNode_removeChildren;b.reset=FUiTreeNode_reset;b.click=FUiTreeNode_click;b.refreshStyle=FUiTreeNode_refreshStyle;b.propertyLoad=
FUiTreeNode_propertyLoad;b.propertySave=FUiTreeNode_propertySave;b.loadConfig=FUiTreeNode_loadConfig;b.dispose=FUiTreeNode_dispose;b.innerDump=FUiTreeNode_innerDump;return b}function FUiTreeNode_onBuildPanel(b){this._hPanel=RBuilder.createTableRow(b,this.styleName("Panel"))}
function FUiTreeNode_onBuild(b){var d=this._tree;this.__base.FUiContainer.onBuild.call(this,b);var f=this._hPanel;this.attachEvent("onNodeEnter",f,this.onNodeEnter);this.attachEvent("onNodeLeave",f,this.onNodeLeave);this.attachEvent("onNodeClick",f);f=this._hNodePanel=RBuilder.appendTableCell(f,this.styleName("Normal"));f.noWrap=!0;var h=this._hImage=RBuilder.appendIcon(f,this.styleName("Image"),null,16,16);h._linkType="image";this.setImage();h=this._hIcon=RBuilder.appendIcon(f,null,null,16,16);h._linkType=
"icon";this.setIcon(this._icon);d.dispChecked&&(h=this._hCheck=RBuilder.appendCheck(f),h.width=13,h.height=13,h.style.borderWidth=0,this.setCheck(this._checked),d.linkEvent(this,"onNodeCheckClick",h));this._hLabel=RBuilder.appendText(f,this.styleName("Label"));this.setLabel(this._label);if(d=d._nodeColumns)for(f=d.count(),h=0;h<f;h++){var q=d.value(h),z=RClass.create(FUiTreeNodeCell);z._column=q;z.build(b);this.push(z)}}
function FUiTreeNode_onNodeEnter(b){b=this._tree;if(!b._focusNode||b._focusNode&&b._focusNode!=this)this._statusHover=!0,this.refreshStyle(),b.lsnsEnter.process(b,this)}function FUiTreeNode_onNodeLeave(b){b=this._tree;if(!b._focusNode||b._focusNode&&b._focusNode!=this)this._statusHover=!1,this.refreshStyle(),b.lsnsLeave.process(b,this)}
function FUiTreeNode_onNodeClick(b){var d=this._tree,f=b.hSender.tagName;if("INPUT"!=f){var h=!1;"IMG"==f&&(h="image"==b.hSender._linkType);b=!1;for(f=d._focusNode;f;){if(f==this){b=!0;break}f=f.parent}h&&(!h||!b&&this._child)||d.selectNode(this,!0);!this._statusLoaded&&this._child?(this.extend(!0),h||d.lsnsClick.process(d,this)):(this._child&&(this.isFolder()?this.extend(!this._extended):h?this.extend(!this._extended):this.extend(!0)),(h&&b||h&&!this._child||!h)&&d.lsnsClick.process(d,this))}}
function FUiTreeNode_construct(){this.__base.FUiContainer.construct.call(this)}function FUiTreeNode_code(){return this._code}function FUiTreeNode_setCode(b){this._code=b}function FUiTreeNode_guid(){return this._guid}function FUiTreeNode_setGuid(b){this._guid=b}function FUiTreeNode_type(){var b=this._tree;return RString.isEmpty(this._typeCode)?null:b.findType(this._typeCode)}function FUiTreeNode_typeCode(){return this._typeCode}function FUiTreeNode_setTypeCode(b){this._typeCode=b;this.setIcon()}
function FUiTreeNode_setLabel(b){this.__base.FUiContainer.setLabel.call(this,b);if(b=this._hLabel){var d="";RString.isEmpty(this._label)||(d="&nbsp;"+this._label);RString.isEmpty(this._tag)||(d+="&nbsp;<FONT color=blue>("+this._tag+")</FONT>");RString.isEmpty(this._note)||(d+="&nbsp;<FONT color=green>[ "+this._note+" ]</FONT>");b.innerHTML=d}}function FUiTreeNode_setNote(b){this._note=RString.empty(b);this.setLabel(this._label)}function FUiTreeNode_level(){return this._level}
function FUiTreeNode_setLevel(b){this._level=b;var d=this._hNodePanel;d&&(d.style.paddingLeft=this._tree._indent*b+"px")}function FUiTreeNode_cell(b){return this._cells.get(b)}function FUiTreeNode_cells(){return this._cells}function FUiTreeNode_check(){return this._checked}function FUiTreeNode_setCheck(b){this._checked=b;if(b=this._attributes)b=b.get("checked"),RString.isEmpty(b)||(this._checked=RBoolean.isTrue(b),this._hCheck&&(this._hCheck._checked=this._checked))}
function FUiTreeNode_setImage(){var b=this._tree;this._hImage.src=RResource.iconPath(this._child?b._iconPlus:b._iconNode)}function FUiTreeNode_calculateImage(){var b=this._tree,d=this._hImage,f=null,f=this.nodeCount()?this._extended?b._iconMinus:b._iconPlus:b._iconNode;d.src=RResource.iconPath(f)}
function FUiTreeNode_setIcon(b){this._icon=b;var d=this._hIcon;if(d){var f=null;this._icon?f=b:(b=this.type())&&(f=b.icon());f?(RHtml.displaySet(d,!0),d.style.width=16,d.style.height=16,d.className=this._valid?this.styleName("Icon"):this.styleName("IconDisable"),d.src=RResource.iconPath(f)):RHtml.displaySet(d,!1)}}function FUiTreeNode_get(b){return this._attributes.get(b)}function FUiTreeNode_set(b,d){this._attributes.set(b,d)}
function FUiTreeNode_isFolder(){return"collections"==this.type().storage()}function FUiTreeNode_hasChild(){if(this._child){var b=this._nodes;if(b)return!b.isEmpty()}return!1}function FUiTreeNode_topNode(){for(var b=this;b._parent;)if(RClass.isClass(b._parent,FUiTreeNode))b=b._parent;else break;return b}function FUiTreeNode_topNodeByType(b){for(var d=this;d;){if(d._typeCode==b)return d;d=d._parent}return null}function FUiTreeNode_nodeCount(){var b=this._nodes;return b?b.count():0}
function FUiTreeNode_show(){var b=this._tree;RHtml.visibleSet(this._hPanel,!0);var d=this._nodes;if(d)for(var f=d.count(),h=0;h<f;h++){var q=d.at(h);q._statusLinked||b.appendNode(q,this);q._statusDisplay&&(RHtml.visibleSet(q._hPanel,!0),q._extended&&q.show())}}function FUiTreeNode_hide(){this._hPanel&&RHtml.visibleSet(this._hPanel,!1);var b=this._components;if(b)for(var d=b.count(),f=0;f<d;f++){var h=b.value(f);h&&h.hide()}}
function FUiTreeNode_select(b){if(this._statusSelected=b)this._statusHover=!1;this.refreshStyle()}
function FUiTreeNode_extend(b){var d=this._tree;if(!this._statusLoaded&&this._child){if(d.__loading)return;d.loadNode(this)}else{if(this._hImage&&!this.hasChild())return this._hImage.src=RResource.iconPath(d._iconNode),!1;this._extended=b;this._child&&this._hImage&&(this._hImage.src=RResource.iconPath(b?d._iconMinus:d._iconPlus));var f=this._nodes;if(b)this.show();else if(f)for(b=f.count()-1;0<=b;b--)f.get(b).hide()}d.refresh()}
function FUiTreeNode_extendAll(b){this.extend(b);var d=this._components;if(d)for(var f=d.count(),h=0;h<f;h++)d.value(h).extendAll(b)}function FUiTreeNode_searchLast(){var b=this._nodes;if(b)for(var d=b.count()-1;0<=d;d--){var f=b.get(d);if(f._statusLinked)return f.searchLast()}return this}function FUiTreeNode_createChild(b){var d=null;if(b.isName("Node")||b.isName("TreeNode"))d=RClass.create(FUiTreeNode),d._tree=this._tree;return d}
function FUiTreeNode_appendChild(b){RClass.isClass(b,FUiTreeNodeCell)&&this._hPanel.appendChild(b._hPanel)}function FUiTreeNode_appendNode(b){var d=this._tree;this.push(b);d.appendNode(b,this);this.extend(!0)}
function FUiTreeNode_push(b){var d=this._tree;this.__base.FUiContainer.push.call(this,b);if(RClass.isClass(b,FUiTreeNode)){this._statusLoaded=this._child=!0;var f=this._nodes;f||(f=this._nodes=new TObjects);b._tree=d;b._parent=this;f.push(b);d._allNodes.pushUnique(b)}RClass.isClass(b,FUiTreeNodeCell)&&(f=this._cells,f||(f=this._cells=new TDictionary),b._parent=this,b._tree=d,b._node=this,f.set(b._column._name,b))}
function FUiTreeNode_remove(b){RClass.isClass(b,FUiTreeNode)&&this._nodes.remove(b);this.__base.FUiContainer.remove.call(this,b)}function FUiTreeNode_removeSelf(){var b=this._tree;if(this._statusLinked){this.removeChildren();var d=this._parent;RClass.isClass(d,FUiTreeNode)&&(d.remove(this),d.calculateImage());b.freeNode(this)}}function FUiTreeNode_removeChildren(){var b=this._nodes;if(b){for(var d=b.count()-1;0<=d;d--){var f=b.get(d);f&&f.removeSelf()}b.clear()}}
function FUiTreeNode_reset(){this._guid=this._typeCode=null;this._valid=!0;this._note=this._tag=this._icon=null;this._checked=this._child=!1;this._extended=!0;this._statusLinked=!1;this._statusDisplay=!0;this._statusLoaded=this._statusSelected=this._extended=this._statusHover=!1;this._level=0}function FUiTreeNode_click(){var b=this._tree;b.selectNode(this,!0);b.lsnsClick.process(b,this)}
function FUiTreeNode_refreshStyle(){var b=this._hPanel.cells,d=b.length;if(this._statusSelected)for(var f=0;f<d;f++)b[f].className=this.styleName("Select");else if(this._statusHover)for(f=0;f<d;f++)b[f].className=this.styleName("Hover");else for(f=0;f<d;f++)b[f].className=this.styleName("Normal")}function FUiTreeNode_propertyLoad(b){this.__base.FUiContainer.propertyLoad.call(this,b);var d=this._attributes;d&&d.append(b.attrs);(b=b.get("attributes"))&&this._attributes.unpack(b)}
function FUiTreeNode_propertySave(b){this.__base.FUiContainer.propertySave.call(this,b);var d=this.type();b.set("type_code",d._code);b.set("storage",d._storage)}function FUiTreeNode_loadConfig(b){this.reset();this.propertyLoad(b);this.setLabel(this._label);this.setCheck(this._checked);this.setImage();this.setIcon(this._icon)}function FUiTreeNode_dispose(){this._hLabel=this._hCheck=this._hIcon=this._hImage=this._hNodePanel=null;this.__base.FUiContainer.dispose.call(this)}
function FUiTreeNode_innerDump(b){b.append(RClass.name(this));b.append("[level=",this._level);this._typeCode&&b.append(" type=",this._typeCode.name);b.append(", icon=",this._icon);b.append(", caption=",this._label);b.append(", child=",this._child);b.append("]")}function FUiTreeNode_reload(b){b?this._tree.reload():this._tree.reloadNode(this)}function FUiTreeNode_reloadParent(){this.parentNode?this._tree.reloadNode(this.parentNode):this._tree.reload()}
function FUiTreeNode_loadQuery(b){var d=RString.nvl(b.get("label"),this._label),f=RString.nvl(b.get("note"),this._note),d="&nbsp;"+d;RString.isEmpty(f)||(d+="&nbsp;<FONT color=green>[ "+f+" ]</FONT>");this._hLabel.innerHTML=d;b.contains("visible")&&(this._statusDisplay=RBool.isTrue(b.get("visible")),this.setVisible(this._statusDisplay))}
function FUiTreeNode_findByName(b){if(this.name==b)return this;var d=this.components;if(d)for(var f=d.count,h=0;h<f;h++){var q=d.value(h);if(q&&(q.name==b||q.components&&(q=q.findByName(b))))return q}return null}function FUiTreeNode_findByUuid(b){if(this._guid==b)return this;var d=this.components;if(d)for(var f=0;f<d.count;f++){var h=d.value(f);if(h&&(h._guid==b||h.components&&(h=h.findByUuid(b))))return h}return null}
function FUiTreeNode_pushChanged(b){var d=new TNode;d.attrs=this._attributes;d.attrs&&d.attrs.set("checked",RBoolean.toString(this.check()));b.push(d);if(this.components&&0<this.components.count)for(var d=this.components.count,f=0;f<d;f++){var h=this.components.value(f);RClass.isClass(h,FUiTreeNode)&&h.pushChanged(b)}}function FUiTreeNode_checkChanged(){return this._checked!=this.check()?!0:!1}
function FUiTreeNode_getFullPath(){var b="";this._label&&(b=this._label);if(this.parent){var d=this.parent.getFullPath();RString.isEmpty(d)||(b=d+"/"+b)}return b}
function FUiTreeNodeCell(b){b=RClass.inherits(this,b,FUiControl,MListenerClick,MListenerDoubleClick);b._stylePanel=RClass.register(b,new AStyle("_stylePanel"));b._styleCell=RClass.register(b,new AStyle("_styleCell","Cell"));b._tree=null;b._column=null;b._level=0;b._node=null;b._hImage=null;b._hIcon=null;b._hLabel=null;b.onBuildPanel=FUiTreeNodeCell_onBuildPanel;b.onBuild=FUiTreeNodeCell_onBuild;b.onClick=RClass.register(b,new AEventClick("onClick"),FUiTreeNodeCell_onClick);b.onDoubleClick=RClass.register(b,
new AEventDoubleClick("onDoubleClick"),FUiTreeNodeCell_onDoubleClick);b.construct=FUiTreeNodeCell_construct;b.icon=FUiTreeNodeCell_icon;b.setIcon=FUiTreeNodeCell_setIcon;b.get=FUiTreeNodeCell_get;b.set=FUiTreeNodeCell_set;return b}function FUiTreeNodeCell_onBuildPanel(b){this._hPanel=RBuilder.createTableCell(b,this.styleName("Panel"))}function FUiTreeNodeCell_onBuild(b){this.__base.FUiControl.onBuild.call(this,b);b=this._hPanel;this.attachEvent("onClick",b);this.attachEvent("onDoubleClick",b)}
function FUiTreeNodeCell_onClick(b){b.treeNode=this._node;b.treeColumn=this._column;b.treeNodeCell=this;this.processClickListener(b)}function FUiTreeNodeCell_onDoubleClick(b){b.treeNode=this._node;b.treeColumn=this._column;b.treeNodeCell=this;this.processDoubleClickListener(b)}function FUiTreeNodeCell_construct(){this.__base.FUiControl.construct.call(this);this._attributes=new TAttributes}function FUiTreeNodeCell_icon(){return o._icon}
function FUiTreeNodeCell_setIcon(b){var d=this._hIcon;d||(d=this._hIcon=RBuilder.appendIcon(this._hPanel,null,null,16,16));d.src=RResource.iconPath(b)}function FUiTreeNodeCell_get(){}function FUiTreeNodeCell_set(b){}
function FUiTreeNodeType(b){b=RClass.inherits(this,b,FUiComponent);b._code=RClass.register(b,new APtyString("_code"));b._storage=RClass.register(b,new APtyString("_storage"));b._icon=RClass.register(b,new APtyString("_icon"));b._service=RClass.register(b,new APtyString("_service"));b._action=RClass.register(b,new APtyString("_action"));b._attributes=RClass.register(b,new APtyAttributes("_attributes"));b.construct=FUiTreeNodeType_construct;b.code=FUiTreeNodeType_code;b.storage=FUiTreeNodeType_storage;
b.icon=FUiTreeNodeType_icon;b.service=FUiTreeNodeType_service;b.action=FUiTreeNodeType_action;b.get=FUiTreeNodeType_get;b.set=FUiTreeNodeType_set;b.innerDump=FUiTreeNodeType_innerDump;return b}function FUiTreeNodeType_construct(){this.__base.FUiComponent.construct.call(this)}function FUiTreeNodeType_code(){return this._code}function FUiTreeNodeType_storage(){return this._storage}function FUiTreeNodeType_icon(){return this._icon}function FUiTreeNodeType_service(){return this._service}
function FUiTreeNodeType_action(){return this._action}function FUiTreeNodeType_get(b){var d=this._attributes;return d?d.get(b):null}function FUiTreeNodeType_set(b,d){var f=this._attributes;f&&f.set(b,d)}function FUiTreeNodeType_innerDump(b){b.append(RClass.dump(this));b.append("[code=",this._code);b.append(", icon=",this._icon);b.append(", service=",this._service);b.append(", action=",this._action);b.append("]")}
function FUiTreeView(b){b=RClass.inherits(this,b,FUiContainer);b._optionCheck=RClass.register(b,new APtyBoolean("_optionCheck"),!1);b._indent=RClass.register(b,new APtyInteger("_indent"),16);b._stylePanel=RClass.register(b,new AStyle("_stylePanel","Panel"));b._styleNodePanel=RClass.register(b,new AStyle("_styleNodePanel","NodePanel"));b._styleNodeForm=RClass.register(b,new AStyle("_styleNodeForm","NodeForm"));b._attributes=null;b._nodeTypes=null;b._nodeColumns=null;b._nodeLevels=null;b._nodes=null;
b._allNodes=null;b._defaultNodeType=null;b._focusNode=null;b._loadingNode=null;b._freeNodes=null;b._iconPlus="control.treeview.plus";b._iconMinus="control.treeview.minus";b._iconNode="control.treeview.node";b._iconLoading="control.treeview.loading";b._hNodePanel=null;b._hNodeForm=null;b._hHeadLine=null;b._hNodeRows=null;b.lsnsEnter=new TListeners;b.lsnsLeave=new TListeners;b.lsnsClick=new TListeners;b.onBuildPanel=FUiTreeView_onBuildPanel;b.onBuild=FUiTreeView_onBuild;b.onClick=RClass.register(b,
new AEventClick("onClick"),FUiTreeView_onClick);b.onNodeCheckClick=RClass.register(b,new AEventClick("onNodeCheckClick"),FUiTreeView_onNodeCheckClick);b.construct=FUiTreeView_construct;b.attributes=FUiTreeView_attributes;b.nodeTypes=FUiTreeView_nodeTypes;b.nodeColumns=FUiTreeView_nodeColumns;b.nodeLevels=FUiTreeView_nodeLevels;b.hasNode=FUiTreeView_hasNode;b.focusNode=FUiTreeView_focusNode;b.nodes=FUiTreeView_nodes;b.findType=FUiTreeView_findType;b.findByName=FUiTreeView_findByName;b.findByGuid=FUiTreeView_findByGuid;
b.createChild=FUiTreeView_createChild;b.createNode=FUiTreeView_createNode;b.appendChild=FUiTreeView_appendChild;b.appendNode=FUiTreeView_appendNode;b.appendNodes=FUiTreeView_appendNodes;b.selectNode=FUiTreeView_selectNode;b.push=FUiTreeView_push;b.removeNode=FUiTreeView_removeNode;b.removeNodes=FUiTreeView_removeNodes;b.freeNode=FUiTreeView_freeNode;b.clearNodes=FUiTreeView_clearNodes;b.calculateHeight=FUiTreeView_calculateHeight;b.fetchChangedChecks=FUiTreeView_fetchChangedChecks;b.extendAuto=FUiTreeView_extendAuto;
b.extendAll=FUiTreeView_extendAll;b.loadNode=RMethod.empty;b.refresh=FUiTreeView_refresh;b.filterNode=FUiTreeView_filterNode;b.clearAllNodes=FUiTreeView_clearAllNodes;b.clear=FUiTreeView_clear;b.dispose=FUiTreeView_dispose;return b}function FUiTreeView_onBuildPanel(b){this._hPanel=RBuilder.createTable(b.hDocument,this.styleName("Panel"))}
function FUiTreeView_onBuild(b){this.__base.FUiContainer.onBuild.call(this,b);this.attachEvent("onClick",this._hPanel);var d=RBuilder.appendTableRow(this._hPanel),d=RBuilder.appendTableCell(d),d=this._hNodePanel=RBuilder.appendDiv(d,this.styleName("NodePanel")),d=this._hNodeForm=RBuilder.appendTable(d,this.styleName("NodeForm"));d.width="100%";this._hHeadLine=RBuilder.appendTableRow(d);this._hNodeRows=d.children[0];d=this._loadingNode=RClass.create(FUiTreeNode);d._tree=this;d._label=RContext.get("FUiTreeView:loading");
d._icon=this._iconLoading;d.build(b);b=this._nodes;if(!b.isEmpty())for(var d=b.count(),f=0;f<d;f++)this.appendNode(b.get(f));this.extendAuto()}function FUiTreeView_onClick(b,d){if(b.hSender==this._hNodePanel){var f=this._focusNode;f&&(f.select(!1),this._focusNode=null)}}
function FUiTreeView_onNodeCheckClick(b,d){if(b&&RClass.isClass(b,FUiTreeNode)){var f=b.check(),h=b.controls;if(h)for(var q=0;q<h.count;q++){var z=h.value(q);z&&RClass.isClass(z,FUiTreeNode)&&z.setCheck(f)}for(h=b.parentNode;h;){if(f)h.setCheck(f);else{for(var z=h.controls,A=z.count,q=0;q<A;q++){var B=z.value(q);if(B&&RClass.isClass(B,FUiTreeNode)&&B.check())return}h.setCheck(!1)}h=h.parentNode}}}
function FUiTreeView_construct(){this.__base.FUiContainer.construct.call(this);this._attributes=new TAttributes;this._nodeTypes=new TDictionary;this._nodeColumns=new TDictionary;this._nodeLevels=new TDictionary;this._nodes=new TObjects;this._allNodes=new TObjects;this._freeNodes=new TObjects;this._defaultNodeType=RClass.create(FUiTreeNodeType)}function FUiTreeView_attributes(){return this._attributes}function FUiTreeView_nodeTypes(){return this._nodeTypes}
function FUiTreeView_nodeColumns(){return this._nodeColumns}function FUiTreeView_nodeLevels(){return this._nodeLevels}function FUiTreeView_hasNode(){return this._rootNode.hasChild()}function FUiTreeView_focusNode(){return this._focusNode}function FUiTreeView_nodes(){return this._nodes}function FUiTreeView_findType(b){return this._nodeTypes.get(b)}function FUiTreeView_findByName(b){var d=this._allNodes,f=d.count();if(f)for(var h=0;h<f;h++){var q=d.get(h);if(q._name==b)return q}}
function FUiTreeView_findByGuid(b){var d=this._allNodes,f=d.count();if(f)for(var h=0;h<f;h++){var q=d.getAt(h);if(q._guid==b)return q}}
function FUiTreeView_createChild(b){var d=null;switch(b.name()){case "TreeColumn":d=RClass.create(FUiTreeColumn);break;case "TreeLevel":d=RClass.create(FUiTreeLevel);break;case "TreeNodeType":d=RClass.create(FUiTreeNodeType);break;case "TreeNode":d=RClass.create(FUiTreeNode);break;default:throw new TError(this,"Unknown child type. (config={1})",b.xml());}d._tree=this;return d}function FUiTreeView_appendChild(b){}
function FUiTreeView_createNode(){var b=this._freeNodes.pop();b||(b=RClass.create(FUiTreeNode),b._tree=this,b.build(this._hPanel));RHtml.visibleSet(b._hPanel,!0);this._allNodes.push(b);return b}
function FUiTreeView_appendNode(b,d){if(!b._statusLinked){var f=b._hPanel;if(d){var h=d.searchLast()._hPanel.rowIndex;f.parentElement?(f.rowIndex>h&&h++,RHtml.tableMoveRow(this._hNodeForm,f.rowIndex,h)):(this._hNodeRows.appendChild(f),RHtml.tableMoveRow(this._hNodeForm,f.rowIndex,h+1));b.setLevel(d._level+1)}else this._hNodeRows.appendChild(f),b.setLevel(0);b._statusLinked=!0}}
function FUiTreeView_appendNodes(b,d){b=RObject.nvl(b,this.workNode,this.rootNode);if(d&&d._nodes){var f=d._nodes.count;if(0<f){b.child=!0;b.loaded=!0;for(var h=0;h<f;h++){var q=d._nodes.get(h);if(q&&(q.isName("Node")||q.isName("TreeNode"))){var z=RClass.create(FUiTreeNode);z.parent=b;z._tree=this;z.loadConfig(q);z.icon=q._nodes?"ctl.FBrowser_Folder":"ctl.FBrowser_Txt";z.build(0);z.hide();q._nodes&&this.tempAppendNodes(z,q);b.push(z);this._allNodes.push(z)}}}}this.rootNode.extend(!0)}
function FUiTreeView_selectNode(b,d){var f=this._focusNode;if(d){if(b){if(f){if(f==b)return;b.isFolder()?f.select(!0):f.select(!1)}b.isFolder()||(b.select(!0),this._focusNode=b)}}else b&&b.select(!1),f&&f.select(!1)}
function FUiTreeView_push(b){this.__base.FUiContainer.push.call(this,b);b._tree=this;RClass.isClass(b,FUiTreeColumn)?this._nodeColumns.set(b.name(),b):RClass.isClass(b,FUiTreeLevel)?this._nodeLevels.set(b.id(),b):RClass.isClass(b,FUiTreeNodeType)?this._nodeTypes.set(b.code(),b):RClass.isClass(b,FUiTreeNode)&&(this._nodes.push(b),this._allNodes.push(b),this.appendNode(b))}
function FUiTreeView_removeNode(b){if(b){for(var d=[],f=null,h=this._allNodes.length,q=0;q<h;q++)f=this._allNodes[q],f!=b&&(d[d.length]=f);this._allNodes=d;var z=b.parent;if(z){d=[];h=z._nodes.length;for(q=0;q<h;q++)f=z._nodes[q],f!=b&&(d[d.length]=f);z._nodes=d;b.parent.childrenHTML.removeChild(b.ownerHTML)}0==z._nodes.length&&(z.imageHTML.src=this.imgEmpty);return!0}return!1}
function FUiTreeView_removeNodes(b){b=RObject.nvl(b,this.workNode,this.rootNode);b.hasChild()&&b.removeChildren();b.remove()}function FUiTreeView_freeNode(b){if(b._statusLinked){b._statusLinked=!1;this._hNodeRows.removeChild(b._hPanel);var d=b.cells();if(d)for(var f=d.count(),h=0;h<f;h++)d.at(h).clearAllListeners();this._allNodes.remove(b);this._freeNodes.push(b)}}
function FUiTreeView_clearNodes(b){b&&b.removeChildren();b=[];for(var d=null,f=this._allNodes.length,h=0;h<f;h++)d=this._allNodes[h],d.parent!=oNode?b[b.length]=d:oNode.childrenHTML.removeChild(d.ownerHTML);oNode.imageHTML.src=this.imgEmpty;this._allNodes=b;return!0}function FUiTreeView_calculateHeight(){for(var b=this._allNodes,d=b.count(),f=0;f<d;f++){var h=b.get(f);RHtml.displayGet(h._hPanel)&&d++}return 29*d}
function FUiTreeView_fetchChangedChecks(){var b=new TNode("TreeView");b.set("name",this.name);for(var d=RObject.nvl(this.rootNode,this).controls,f=0;f<d.count;f++)d.value(f).pushChanged(b);return b}function FUiTreeView_extendAuto(b){if(b=b?b._nodes:this._nodes){var d=b.count;if(d)for(var f=0;f<d;f++){var h=b.get(f);h.extend(h._extended);h._extended&&this.extendAuto(h)}}}
function FUiTreeView_extendAll(b,d){var f=b?b._nodes:this._nodes;if(f){var h=f.count();if(h)for(var q=0;q<h;q++){var z=f.get(q);z.extend(d);this.extendAll(z,d)}}}function FUiTreeView_refresh(){this.parentObj&&(this.parentObj.style.height=this.calculateHeight())}
function FUiTreeView_filterNode(b,d){var f=this._allNodes.count(),h=null,q=null;if(b){label=label.toLowerCase();var z=null,A=0;d&&(d=d.toLowerCase(),z=d.split("|"),A=z.length);for(C=0;C<f;C++)if(D=this._allNodes.get(C),!D.isDelete)if(h=D.label.toLowerCase(),z)for(var q=D.linkAttr.toLowerCase(),B=0;B<A;B++){if(-1!=q.indexOf(z[B])){D.show(-1!=h.indexOf(label));break}}else D.show(-1!=h.indexOf(label))}else for(var C=0;C<f;C++){var D=this._allNodes.get(C);D.isDelete||D.show(!0)}}
function FUiTreeView_clearAllNodes(){var b=this._nodes;if(b){for(var d=b.count()-1;0<=d;d--)b.get(d).removeSelf();b.clear()}this._allNodes.clear()}function FUiTreeView_clear(){this.clearAllNodes()}function FUiTreeView_dispose(){this.__base.FUiContainer.dispose.call(this);var b=this._nodes;b&&(b.dispose(),this._nodes=null);if(b=this._allNodes)b.dispose(),this._allNodes=null;this._hHeadLine=this._hNodeForm=this._hNodePanel=null;return!0}
function FUiDialog(b){b=RClass.inherits(this,b,FUiWindow,MUiDescribeFrame);b.construct=FUiDialog_construct;return b}function FUiDialog_construct(){this.__base.FUiWindow.construct.call(this)}
function FUiFramePage(b){b=RClass.inherits(this,b,FUiContainer);b._styleContainer=RClass.register(b,new AStyle("_styleContainer"));b._hContainer=null;b.onBuildPanel=FUiFramePage_onBuildPanel;b.onBuild=FUiFramePage_onBuild;b.oeResize=FUiFramePage_oeResize;b.appendChild=FUiFramePage_appendChild;b.removeChild=FUiFramePage_removeChild;return b}function FUiFramePage_onBuildPanel(b){b=this._hPanel=RBuilder.createTableCell(b,this.styleName("Panel"));b.vAlign="top";b.height="100%"}
function FUiFramePage_onBuild(b){this.__base.FUiContainer.onBuild.call(this,b);b=this._hPanel;this._scrollCd!=EUiScroll.None?(b=this._hContainer=RBuilder.appendDiv(b,this.styleName("Container")),RUiControl.setStyleScroll(b,this._scrollCd)):this._hContainer=b}
function FUiFramePage_oeResize(b){b=this._parent;if(b._directionCd!=EUiDirection.Horizontal&&b._directionCd!=EUiDirection.Vertical)throw new TError(this,"Unknown direcion type. (direction_cd={1})",this._directionCd);return EEventStatus.Continue}function FUiFramePage_appendChild(b){this._hContainer.appendChild(b._hPanel)}function FUiFramePage_removeChild(b){this._hContainer.removeChild(b._hPanel)}
function FUiFrameSet(b){b=RClass.inherits(this,b,FUiContainer,MUiDescribeFrame);b._sizeCd=EUiSize.Fill;b._directionCd=RClass.register(b,new APtyEnum("_directionCd",null,EUiDirection),EUiDirection.Vertical);b._stylePanel=RClass.register(b,new AStyle("_stylePanel"));b._frames=null;b._hLine=null;b.onBuildPanel=FUiFrameSet_onBuildPanel;b.construct=FUiFrameSet_construct;b.appendFrame=FUiFrameSet_appendFrame;b.appendSpliter=FUiFrameSet_appendSpliter;b.appendChild=FUiFrameSet_appendChild;b.dispose=FUiFrameSet_dispose;
return b}function FUiFrameSet_onBuildPanel(b){this._hPanel=RBuilder.createTable(b,this.styleName("Panel"))}function FUiFrameSet_construct(){this.__base.FUiContainer.construct.call(this);this._frames=new TObjects}
function FUiFrameSet_appendFrame(b){if(this._directionCd==EUiDirection.Horizontal){var d=this._hLine;d||(d=this._hLine=RBuilder.appendTableRow(this._hPanel));b.setPanel(d);if(d=b._size.width)b._hPanel.width=d}else if(this._directionCd==EUiDirection.Vertical){if(d=RBuilder.appendTableRow(this._hPanel),b.setPanel(d),d=b._size.height)b._hPanel.height=d}else throw new TError(this,"Unknown direcion type. (direction_cd={1})",this._directionCd);this._frames.push(b)}
function FUiFrameSet_appendSpliter(b){var d=null;b?d=b:(d=RClass.create(FUiFrameSpliter),d.build(this._hPanel));if(this._directionCd==EUiDirection.Horizontal)this._hLine.appendChild(d._hPanel),d._hPanel.style.width="4px";else if(this._directionCd==EUiDirection.Vertical)RBuilder.appendTableRow(this._hPanel).appendChild(d._hPanel),d._hPanel.style.height="4px";else throw new TError(this,"Unknown direcion type. (direction_cd={1})",this._directionCd);this._frames.push(d);return d}
function FUiFrameSet_appendChild(b){b._frameset=this;RClass.isClass(b,FUiFramePage)?this.appendFrame(b):RClass.isClass(b,FUiFrameSpliter)?this.appendSpliter(b):this.__base.FUiContainer.appendChild.call(this,b)}function FUiFrameSet_dispose(){this.__base.FUiContainer.dispose.call(this)}
function FUiFrameSpliter(b){b=RClass.inherits(this,b,FUiControl,MUiDragable);b._styleNormal=RClass.register(b,new AStyle("_styleNormal","Normal"));b._styleHover=RClass.register(b,new AStyle("_styleHover","Hover"));b._styleDraging=RClass.register(b,new AStyle("_styleDraging","Draging"));b._directionCd=EUiDirection.Horizontal;b._alignCd=EUiAlign.Left;b._dragClientX=0;b._dragClientY=0;b._dragPanelX=0;b._dragPanelY=0;b._dragSizeX=0;b._dragSizeY=0;b._sizeMin=40;b._hDrag=null;b._hSize=null;b._hIcon=null;
b.onBuildPanel=FUiFrameSpliter_onBuildPanel;b.onBuild=FUiFrameSpliter_onBuild;b.onMouseEnter=RClass.register(b,new AEventMouseEnter("onMouseEnter"),FUiFrameSpliter_onMouseEnter);b.onMouseLeave=RClass.register(b,new AEventMouseLeave("onMouseLeave"),FUiFrameSpliter_onMouseLeave);b.onDoubleClick=RClass.register(b,new AEventDoubleClick("onDoubleClick"),FUiFrameSpliter_onDoubleClick);b.onDragStart=FUiFrameSpliter_onDragStart;b.onDragMove=FUiFrameSpliter_onDragMove;b.onDragStop=FUiFrameSpliter_onDragStop;
b.construct=FUiFrameSpliter_construct;b.alignCd=FUiFrameSpliter_alignCd;b.setAlignCd=FUiFrameSpliter_setAlignCd;b.sizeHtml=FUiFrameSpliter_sizeHtml;b.setSizeHtml=FUiFrameSpliter_setSizeHtml;b.changeVisible=FUiFrameSpliter_changeVisible;b.dispose=FUiFrameSpliter_dispose;return b}function FUiFrameSpliter_onBuildPanel(b){this._hPanel=RBuilder.createTableCell(b,this.styleName("Normal"))}
function FUiFrameSpliter_onBuild(b){this.__base.FUiControl.onBuild.call(this,b);var d=this._hPanel;d.style.zIndex=EUiLayer.Drap;d.__linker=this;b=this._hDrag=RBuilder.createDiv(b,this.styleName("Draging"));b.__linker=this;b.style.position="absolute";RHtml.displaySet(b,!1);d.appendChild(b);d.style.cursor="e-resize";d._plinker=this;this.attachEvent("onMouseEnter",d,this.onMouseEnter);this.attachEvent("onMouseLeave",d,this.onMouseLeave);this.attachEvent("onDoubleClick",d);this._hIcon=RBuilder.appendIcon(d,
null,"control.FSpliter_Left");RConsole.find(FDragConsole).register(this)}function FUiFrameSpliter_onMouseEnter(b){this._hPanel.className=this.styleName("Hover")}function FUiFrameSpliter_onMouseLeave(b){this._hPanel.className=this.styleName("Normal")}function FUiFrameSpliter_onDoubleClick(b){this.changeVisible()}
function FUiFrameSpliter_onDragStart(b){var d=this._hPanel,f=this._hDrag,h=f.style;if(this._directionCd==EUiDirection.Horizontal)this._dragClientX=b.clientX,this._dragPanelX=RHtml.clientX(d),this._dragSizeX=this._hSize.offsetWidth,h.cursor=EMouseCursor.HSize;else if(this._directionCd==EUiDirection.Vertical)this._dragClientY=b.clientY,this._dragPanelY=RHtml.clientY(d),this._sizeY=this._hSize.offsetHeight,h.cursor=EMouseCursor.VSize;else throw new TError(this,"Unknown direction type. (direction_cd={1})",
this._directionCd);h.left=RHtml.clientX(d)+"px";h.top=RHtml.clientY(d)+"px";h.width=d.offsetWidth+"px";h.height=d.offsetHeight+"px";RHtml.visibleSet(f,!0);RWindow.setOptionSelect(!1);RWindow.disable()}
function FUiFrameSpliter_onDragMove(b){var d=this._hDrag;if(this._directionCd==EUiDirection.Horizontal)b=this._dragPanelX+(b.clientX-this._dragClientX),b>this._sizeMin&&(d.style.left=b+"px");else if(this._directionCd==EUiDirection.Vertical)b=this._dragPanelY+(b.clientY-this._dragClientY),b>this._sizeMin&&(d.style.top=b+"px");else throw new TError(this,"Unknown direction type. (direction_cd={1})",this._directionCd);}
function FUiFrameSpliter_onDragStop(b){var d=this._hDrag;if(this._directionCd==EUiDirection.Horizontal){b=b.clientX-this._dragClientX;var f=0;if(this._alignCd===EUiAlign.Left)f=this._dragSizeX+b;else if(this._alignCd===EUiAlign.Right)f=this._dragSizeX-b;else throw new TError(this,"Unknown align type. (align_cd={1})",this._alignCd);f>this._sizeMin&&(this._hSize.style.width=f+"px")}else if(this._directionCd==EUiDirection.Vertical){b=b.clientY-this._dragClientY;f=this._dragSizeY+b;if(this._alignCd===
EUiAlign.Top)f=this._dragSizeY+b;else if(this._alignCd===EUiAlign.Bottom)f=this._dragSizeY-b;else throw new TError(this,"Unknown align type. (align_cd={1})",this._alignCd);f>this._sizeMin&&(this._hSize.style.width=f+"px")}else throw new TError(this,"Unknown direction type. (direction_cd={1})",this._directionCd);RHtml.visibleSet(d,!1);RWindow.enable();RWindow.setOptionSelect(!0)}function FUiFrameSpliter_construct(){this.__base.FUiControl.construct.call(this)}
function FUiFrameSpliter_alignCd(){return this._alignCd}function FUiFrameSpliter_setAlignCd(b){if(b==EUiAlign.Left)this._hIcon.src=RResource.iconPath("control.FSpliter_Left");else if(b==EUiAlign.Right)this._hIcon.src=RResource.iconPath("control.FSpliter_Right");else throw new TError(this,"Align type is invalid.");this._alignCd=b}function FUiFrameSpliter_sizeHtml(){return this._hSize}function FUiFrameSpliter_setSizeHtml(b){this._hSize=b}
function FUiFrameSpliter_changeVisible(){var b=this._hSize;if(b){var d=null;RHtml.visibleGet(b)?(RHtml.visibleSet(b,!1),this._alignCd==EUiAlign.Left?d=EUiAlign.Right:this._alignCd==EUiAlign.Right&&(d=EUiAlign.Left)):(RHtml.visibleSet(b,!0),this._alignCd==EUiAlign.Left?d=EUiAlign.Left:this._alignCd==EUiAlign.Right&&(d=EUiAlign.Right));d==EUiAlign.Left?this._hIcon.src=RResource.iconPath("control.FSpliter_Left"):d==EUiAlign.Right&&(this._hIcon.src=RResource.iconPath("control.FSpliter_Right"));RConsole.find(FUiWorkspaceConsole).resize()}}
function FUiFrameSpliter_dispose(){var b=this._hDrag;b&&(RHtml.free(b),this._hDrag=null);if(b=this._hSize)RHtml.free(b),this._hSize=null;this.__base.FUiControl.dispose.call(this)}
function FUiWindow(b){b=RClass.inherits(this,b,FUiLayout,MMouseCapture);b._statusVisible=!1;b._stylePanel=RClass.register(b,new AStyle("_stylePanel"));b._styleBodyForm=RClass.register(b,new AStyle("_styleBodyForm"));b._styleTitleForm=RClass.register(b,new AStyle("_styleTitleForm"));b._styleTitlePanel=RClass.register(b,new AStyle("_styleTitlePanel"));b._styleBodyPanel=RClass.register(b,new AStyle("_styleBodyPanel"));b._styleStatusPanel=RClass.register(b,new AStyle("_styleStatusPanel"));b._mousePosition=
null;b._mouseControl=null;b.onBuildPanel=FUiWindow_onBuildPanel;b.onBuild=FUiWindow_onBuild;b.onMouseCaptureStart=FUiWindow_onMouseCaptureStart;b.onMouseCapture=FUiWindow_onMouseCapture;b.onMouseCaptureStop=FUiWindow_onMouseCaptureStop;b.construct=FUiWindow_construct;b.setVisible=FUiWindow_setVisible;b.setLabel=FUiWindow_setLabel;b.showPosition=FUiWindow_showPosition;return b}
function FUiWindow_onBuildPanel(b){this._hPanel=RBuilder.createDiv(b,this.styleName("Panel"));b=this._hPanelForm=RBuilder.createTable(b,this.styleName("Form"),null,0,1);b.style.width="100%";b.style.height="100%"}
function FUiWindow_onBuild(b){this.__base.FUiLayout.onBuild.call(this,b);var d=this._hBodyForm=RBuilder.appendTable(this._hPanel,this.styleName("BodyForm")),f=this._hTitlePanel=RBuilder.appendTableRowCell(d,this.styleName("TitlePanel"));f.__linker=this;b=this._hBodyPanel=RBuilder.appendTableRowCell(d,this.styleName("BodyPanel"));b.vAlign="top";this._hStatusPanel=RBuilder.appendTableRowCell(d,this.styleName("StatusPanel"));d=this._hTitleForm=RBuilder.appendTable(f,this.styleName("TitleForm"));d=RBuilder.appendTableRow(d);
f=this._hTitle=RBuilder.appendTableCell(d);f.align="center";RHtml.textSet(f,this._label);RBuilder.appendTableCell(d).width=20;b.appendChild(this._hPanelForm);this.refreshSize()}function FUiWindow_onMouseCaptureStart(b){this._mouseDraging=!0;this._mousePosition.set(b.x,b.y);this._mouseControl.set(this._hPanel.offsetLeft,this._hPanel.offsetTop);RHtml.cursorSet(this._hPanel,EUiCursor.Move)}
function FUiWindow_onMouseCapture(b){if(this._mouseDraging){var d=b.y-this._mousePosition.y;this._hPanel.style.left=this._mouseControl.x+(b.x-this._mousePosition.x)+"px";this._hPanel.style.top=this._mouseControl.y+d+"px"}}function FUiWindow_onMouseCaptureStop(b){this._mouseDraging=!1;RHtml.cursorSet(this._hPanel,EUiCursor.Auto)}
function FUiWindow_construct(){this.__base.FUiLayout.construct.call(this);this._mousePosition=new SPoint2;this._mouseControl=new SPoint2;RConsole.find(FMouseConsole).register(this)}function FUiWindow_setVisible(b){this._statusVisible=b;var d=this.panel(EPanel.Container);b?RWindow._hContainer.appendChild(d):RWindow._hContainer.removeChild(d)}function FUiWindow_setLabel(b){this.__base.FUiLayout.setLabel.call(this,b);RHtml.textSet(this._hTitle,this._label)}
function FUiWindow_showPosition(b){this.show();b==EUiPosition.Center&&(b=(window.document.body.offsetHeight-this._hPanel.offsetHeight)/2,this._hPanel.style.left=(window.document.body.offsetWidth-this._hPanel.offsetWidth)/2+"px",this._hPanel.style.top=b+"px")}function FUiWindow_doFocus(){if(this.searchControls&&0<this.searchControls.count)for(var b=this.searchControls,d=0;d<b.count;d++){var f=this.searchControls.get(0);RClass.isClass(f,MEditValue)&&f.focus()}}
function FUiWindow_oeVisible(b){this.__base.FUiLayout.oeVisible.call(this,b);b.isAfter()&&(this.hPanel.style.zIndex=RLayer.next(ELayer.Window),this.hPanel.style.display="block")}function FUiWindow_panel(b){return EPanel.Display==b||EPanel._border==b||EPanel.Size==b?this.hPanel:EPanel.Move==b?this.hTitleForm:this.__base.FUiLayout.panel.call(this,b)}
function FUiWindow_dump(b,d){var f;b||(b=this);d||(d="   ");f=""+(b.className+"\n");if(b.children)for(var h=b.children,q=0;q<h.length;q++)f+=d+this.dump(h[q],d+"   ");return f}function FUiWindow_pushAllControl(b){this.allControls||(this.allControls=[]);this.allControls.push(b)}function FUiWindow_control(b){if(this.allControls)for(var d=0;d<this.allControls.length;d++)if(this.allControls[d].name==b)return this.allControls[d];return null}function FUiWindow_restore(){this.max(!0)}
function FUiWindow_processResize(){if(!SystemManager.runMode){var b=this.rect();this.width=b.width();this.height=b.height()}this.processEvent(this,IWindowEvent.RESIZE)}function FUiWindow_fillAllControl(){for(var b=null,d=this.controls.size(),f=0;f<d;f++)b=this.controls.value(f),b.fill&&b.fill()}
function FUiWindow_refresh(b){this.loadConfig&&this.loadConfig();this.setCaption(this.label);this.setWidth(this.width);this.setHeight(this.height);if(this.allControls)for(var d=0;d<this.allControls.length;d++){var f=this.allControls[d];f.refresh&&(b&&f.reloadConfig&&f.reloadConfig(),f.refresh())}}function FUiWindow_initialize(){if(this.allControls)for(var b=0;b<this.allControls.length;b++){var d=this.allControls[b];d.initialize&&d.initialize();d.initializeControl&&d.initializeControl()}}
function FUiWindow_release(){if(this.allControls)for(var b=0;b<this.allControls.length;b++){var d=this.allControls[b];d.releaseControl&&d.releaseControl();d.release&&d.release()}this.htmlBorder.removeNode(!0);DatasetManager.focus(null,!0);WindowManager.releaseWindow(this)}
function FUiWindow_stopDropExecute(b){if(b.config&&b.rect){var d=b.rect();b.config.setAttribute("left",d.left);b.config.setAttribute("top",d.top);b.config.setAttribute("width",d.width());b.config.setAttribute("height",d.height())}if(this.owner.onStopDrop)this.owner.onStopDrop(b)}function FUiWindow_selectDsExecute(b){if(b&&b.constructor==FDatasetCtl){var d=DatasetManager.activeDsCtl!=b;DatasetManager.activeDsCtl=b;d&&DatasetManager.refreshToolbar()}}
function FUiWindow_dispose(){this.__base.FUiLayout.dispose.call(this);this.__base.MWinBorder.dispose.call(this);this.hBorderForm=null}
var EUiDataAction=new function(){this.Fetch="fetch";this.Search="search";this.Lov="lov";this.Zoom="zoom";this.Prepare="prepare";this.Insert="insert";this.Update="update";this.Delete="delete";this.First="first";this.Prior="prior";this.Next="next";this.Last="last";this.Action="action";this.FetchLov="fetchLov";this.EndFetch="endfetch";this.EndUpdate="endupdate";this.DsChanged="dschanged";this.Scalar="scalar";this.Complete="complete";this.Process="process";return this},EUiDataMode=new function(){this.Insert=
"insert";this.Update="update";this.Delete="delete";return this},EUiDataService=new function(){this.Dataset="database.dataset";this.List="design.list";this.WebForm="design.webform";this.Translate="design.translate";this.WebDataset="logic.dataset";return this},EUiDataStore=new function(){this.Full=0;this.Sort=1;this.Config=2;this.Value=3;this.Name=4;this.DataName=5;this.DataNvl=6;this.Reset=7;this.Prepare=8;return this};
function MUiDataAction(b){b=RClass.inherits(this,b);b.doAction=MUiDataAction_doAction;return b}function MUiDataAction_doAction(b){b=this.findComponent(b);if(RClass.isClass(b,MInvoke))b.invoke(this);else throw new TError(this,"Component is invalid.");}function MUiDataContainer(b){b=RClass.inherits(this,b,MUiContainer);b.dsDataLoad=MUiDataContainer_dsDataLoad;b.dsDataSave=MUiDataContainer_dsDataSave;b.dsLoadValue=MUiDataContainer_dsLoadValue;b.dsSaveValue=MUiDataContainer_dsSaveValue;return b}
function MUiDataContainer_dsDataLoad(b){var d=new TEventProcess(null,this,"oeDataLoad",MDataValue);d.source=b;this.process(d);d.dispose()}function MUiDataContainer_dsDataSave(b){var d=new TEventProcess(null,this,"oeDataSave",MDataValue);d.source=b;this.process(d);d.dispose()}function MUiDataContainer_dsLoadValue(b,d){var f=new TEventProcess(this,"oeDataLoadValue",MUiDataValue);f.viewer=this._dataViewer;f.store=d;f.values=b;this.process(f)}
function MUiDataContainer_dsSaveValue(b,d){b||(b=new TRow);var f=new TEventProcess(this,"oeDataSaveValue",MUiDataValue);f.viewer=this._dataViewer;f.store=d;f.values=b;this.process(f);b.set("_status",this._dataStatusCd);return b}
function MUiDataField(b){b=RClass.inherits(this,b,MUiValue,MUiDataValue);b._dataTypeCd=RClass.register(b,new APtyString("_dataTypeCd"));b._dataRequire=RClass.register(b,new APtyBoolean("_dataRequire"));b._dataName=RClass.register(b,new APtyString("_dataName"));b.oeDataLoadValue=MUiDataField_oeDataLoadValue;b.oeDataSaveValue=MUiDataField_oeDataSaveValue;b.formatLoad=MUiDataField_formatLoad;b.formatSave=MUiDataField_formatSave;return b}
function MUiDataField_oeDataLoadValue(b){b=b.values.get(this._dataName);this.set(this.formatLoad(b));return EEventStatus.Stop}function MUiDataField_oeDataSaveValue(b){b=this.get();dataSource.values.set(this._dataName,this.formatSave(b));return EEventStatus.Stop}function MUiDataField_formatLoad(b){return b}function MUiDataField_formatSave(b){return b}
function MUiDataset(b){b=RClass.inherits(this,b);b._dsDataset=RClass.register(b,new APtyString("_dsDataset","dataset"));b._dsPageSize=RClass.register(b,new APtyInteger("_dsPageSize","page_size"),20);b._dsPageIndex=0;b._dsInsertAction=RClass.register(b,new APtyString("_dsInsertAction","insert_action"));b._dsUpdateAction=RClass.register(b,new APtyString("_dsUpdateAction","update_action"));b._dsDeleteAction=RClass.register(b,new APtyString("_dsDeleteAction","delete_action"));b._dataSource=null;b._dataViewer=
null;b._dataValues=null;b._dataGlobalSearchs=null;b._dataSearchs=null;b._dataGlobalOrders=null;b._dataOrders=null;b.__progress=!1;b.lsnsUpdateBegin=null;b.lsnsUpdateEnd=null;b.onDatasetLoadBegin=RMethod.empty;b.onDatasetLoad=RMethod.empty;b.onDatasetLoadEnd=RMethod.empty;b.onStoreChanged=RMethod.empty;b.onDsFetchBegin=RMethod.empty;b.onDsFetchEnd=RMethod.empty;b.onDsUpdateBegin=RMethod.empty;b.onDsUpdateEnd=RMethod.empty;b.onDsFetch=MUiDataset_onDsFetch;b.onDsPrepareCheck=RMethod.emptyTrue;b.onDsCopy=
MUiDataset_onDsCopy;b.onDsPrepare=MUiDataset_onDsPrepare;b.onDsUpdateCheck=RMethod.emptyTrue;b.onDsUpdate=MUiDataset_onDsUpdate;b.onDsDoUpdate=MUiDataset_onDsDoUpdate;b.onDsDeleteCheck=RMethod.emptyTrue;b.onDsDelete=MUiDataset_onDsDelete;b.onDsProcess=MUiDataset_onDsProcess;b.oeDataLoad=MUiDataset_oeDataLoad;b.oeDataSave=MUiDataset_oeDataSave;b.oeDatasetLoad=MUiDataset_oeDatasetLoad;b.construct=MUiDataset_construct;b.loadDataset=MUiDataset_loadDataset;b.loadDatasets=MUiDataset_loadDatasets;b.toDeepAttributes=
MUiDataset_toDeepAttributes;b.dsDatasetLoad=MUiDataset_dsDatasetLoad;b.dsFetch=MUiDataset_dsFetch;b.dsInitialize=MUiDataset_dsInitialize;b.dsShow=MUiDataset_dsShow;b.dsLoaded=MUiDataset_dsLoaded;b.dsSearch=MUiDataset_dsSearch;b.dsCopy=MUiDataset_dsCopy;b.dsPrepare=MUiDataset_dsPrepare;b.dsUpdate=MUiDataset_dsUpdate;b.dsDelete=MUiDataset_dsDelete;b.dsMode=MUiDataset_dsMode;b.dsDoUpdate=MUiDataset_dsDoUpdate;b.dsProcess=MUiDataset_dsProcess;b.dsProcessCustom=MUiDataset_dsProcessCustom;b.dsProcessChanged=
MUiDataset_dsProcessChanged;b.dsProcessSelected=MUiDataset_dsProcessSelected;b.dsProcessAll=MUiDataset_dsProcessAll;b.psProgress=MUiDataset_psProgress;b.psValid=MUiDataset_psValid;b.dsIsChanged=MUiDataset_dsIsChanged;b.dsCount=MUiDataset_dsCount;b.dsCurrent=MUiDataset_dsCurrent;b.dsMove=MUiDataset_dsMove;b.dsMovePage=MUiDataset_dsMovePage;b.dsGet=MUiDataset_dsGet;b.dsSet=MUiDataset_dsSet;b.dsRefresh=MUiDataset_dsRefresh;b.doSearch=MUiDataset_doSearch;return b}
function MUiDataset_onDsFetch(b){this.dsDatasetLoad(b.datasets)}function MUiDataset_onDsCopy(b){this.loadDatasets(b.resultDatasets);this.onLoadDatasetEnd();this.focus()}function MUiDataset_onDsPrepare(b){b.resultDatasets.set("/",null);this.loadDatasets(b.resultDatasets);this.doPrepare(b.resultRow);b.invokeSuccess()||(this.onLoadDatasetEnd(),this.focus())}function MUiDataset_onDsUpdate(b){this.loadDatasets(b.resultDatasets);this.onLoadDatasetEnd();this.focus()}
function MUiDataset_onDsDoUpdate(b){b.invokeSuccess()||this.psRefresh();b.processFinish||(this.focus(),this.lsnsUpdateEnd.process(b));this.onLoadDatasetEnd()}function MUiDataset_onDsDelete(b){this.loadDatasets(b.resultDatasets);this.doDelete(b.resultRow);this.onLoadDatasetEnd();this.focus()}function MUiDataset_onDsProcess(b){var d=b.resultCallback;d&&d.invoke(this,b)}function MUiDataset_oeDataLoad(b){b.isBefore()&&(b=b.source,b.selectDataset(),b.selectRow());return EEventStatus.Contine}
function MUiDataset_oeDataSave(b){b.isBefore()&&(b=b.source,b.selectDataset(),b.selectRow());return EEventStatus.Contine}function MUiDataset_oeDatasetLoad(b){b.isBefore()&&(this._dataset=b=b.datasets.get(this._name),this.onDatasetLoad(b));return EEventStatus.Contine}function MUiDataset_construct(){this._dataViewer=new TDatasetViewer}function MUiDataset_loadDataset(b){this.dsStore=b;b.saveViewer(this._dataViewer);this.onLoadDataset(b)}
function MUiDataset_loadDatasets(b){for(var d=b.count(),f=0;f<d;f++){var h=b.value(n),q=this.findByPath(h.name);if(!q)return RMessage.fatal(this,null,"Load dataset failed. (dataset={1}",h.name);q.loadDataset(h)}}function MUiDataset_dsDatasetLoad(b){var d=new TEventProcess(null,this,"oeDatasetLoad",MUiDataset);d.datasets=b;this.process(d);d.dispose()}
function MUiDataset_toDeepAttributes(b,d){b||(b=new TAttributes);for(var f=new TList,h=this;h;){RClass.isClass(h,MUiDataset)&&f.push(h);if(!h.parent)break;h=h.topControl(MUiDataset)}for(var q=f.count;0<=q;q--)h=f.get(q),RClass.isClass(h,FForm)?h.toAttributes(b,d):RClass.isClass(d,FTable)&&(h=h.getCurrentRow())&&h.toAttributes(b,d);return b}function MUiDataset_dsFetch(){var b=new TDatasetFetchArg;b.owner=this;b.name=this._name;b.callback=this.onDsFetch;RConsole.find(FDatasetConsole).fetch(b)}
function MUiDataset_dsInitialize(){this.callEvent("onFormInitialize",this,this.__initializeEvent)}function MUiDataset_dsShow(){this.callEvent("onFormShow",this,this.__showEvent)}function MUiDataset_dsLoaded(){this.callEvent("onDatasetLoaded",this,this.__loadedEvent)}
function MUiDataset_dsSearch(b){this.psProgress(!0);var d=this.topControl(),f=this.fullPath();b&&(f=b.fullPath());b=new TDatasetFetchArg(d.name,d.formId,this.dsPageSize,0,!0,!1,f);b.mode=d._emode;b.searchs.append(this._dataGlobalSearchs);b.searchs.append(this._dataSearchs);b.orders.append(this._dataGlobalOrders);b.orders.append(this._dataOrders);this.toDeepAttributes(b.values);b.values.append(this._dataValues);b.callback=new TInvoke(this,this.onDsFetch);RConsole.find(FDatasetConsole).fetch(b)}
function MUiDataset_dsCopy(b){this.psProgress(!0);this.psMode(EMode.Insert);var d=new TDatasetFetchArg(this.name,this.formId,this.dsPageSize,0,!0);d.form=this;d.mode=EMode.Insert;this._dataSearchs.clear();this._dataSearchs.push(new TSearchItem("OUID",b.get("OUID")));d.searchs=this._dataSearchs;d.callback=new TInvoke(this,this.onDsCopy);this.onDsUpdateCheck(d)&&RConsole.find(FDatasetConsole).fetch(d)}
function MUiDataset_dsPrepare(b){this.psProgress(!0);this.psMode(EMode.Insert);var d=new TDatasetPrepareArg(this.name,this.formId);d.form=this;d.values.append(this._dataValues);d.callbackSuccess=b;this.onDsPrepareCheck(d)&&(d.callback=new TInvoke(this,this.onDsPrepare),RConsole.find(FDatasetConsole).prepare(d))}function MUiDataset_dsUpdate(b,d){this.psProgress(!0);this.psMode(EMode.Update);this.dsFetch(!0)}
function MUiDataset_dsDoUpdate(b,d){if(this.psValid()){var f=this.topControl(),f=new TDatasetUpdateArg(f.name,this.formId,this.dsName);f.form=this;f.path=this.fullPath();f.mode=this._emode;f.codes=this.getDataCodes();f.callback=new TInvoke(this,this.onDsDoUpdate);f.callbackSuccess=b;if(EMode.Insert==this._emode||EMode.Delete==this._emode)f.dataset.rows.append(this.getCurrentRows());else if(f.dataset.rows.append(this.getChangedRows()),!d&&!f.hasData())return RMessage.warn(this,RContext.get("MUiDataset:nochange"));
this.psProgress(!0);RConsole.find(FDatasetConsole).update(f)}}function MUiDataset_dsDelete(b,d){this.psProgress(!0);this.psMode(EMode.Delete);var f=new TDatasetFetchArg(this.name,this.formId,this.dsPageSize,0,!0);f.callback=new TInvoke(this,this.onDsDelete);f.form=this;f.mode=EMode.Delete;b&&f.searchs.push(new TSearchItem("OUID",b));d&&f.searchs.push(new TSearchItem("OVER",d));f.values=this._dataValues;this.onDsDeleteCheck(f)&&RConsole.find(FDatasetConsole).fetch(f)}
function MUiDataset_dsMode(b){switch(b){case EMode.Insert:this.dsPrepare();break;case EMode.Update:this.dsUpdate();break;case EMode.Delete:this.dsDelete()}}
function MUiDataset_dsProcess(b,d){if(this.psValid()){var f=new TDatasetServiceArg(this.topControl().name,b);f.form=this;f.controlName=this.name;this.toDeepAttributes(f.attributes);f.codes=this.getDataCodes();f.push(this.getCurrentRow());f.resultCallback=d;this.psProgress(!0);f.callback=new TInvoke(this,this.onDsProcess);RConsole.find(FFormConsole).process(f)}}
function MUiDataset_dsProcessCustom(b,d,f,h){if(h||this.psValid()){d=new TDatasetServiceArg(this.topControl().name,d);d.form=this;d.controlName=this.name;d.attributes=b;d.codes=this.getDataCodes();d.push(this.getCurrentRow());d.resultCallback=f;if(!h&&!d.hasData())return RMessage.warn(this,RContext.get("MUiDataset:nodata"));this.psProgress(!0);d.callback=new TInvoke(this,this.onDsProcess);RConsole.find(FFormConsole).process(d)}}
function MUiDataset_dsProcessSelected(b,d){if(this.psValid()){var f=new TDatasetServiceArg(this.topControl().name,b);f.form=this;f.controlName=this.name;this.toDeepAttributes(f.attributes);f.codes=this.getDataCodes();f.rows=this.getSelectedRows();if(0<f.rows.count)f.resultCallback=d,this.psProgress(!0),f.callback=new TInvoke(this,this.onDsProcess),RConsole.find(FFormConsole).process(f),this.clearSelectRows();else return RMessage.warn(this,RContext.get("MUiDataset:norows"))}}
function MUiDataset_dsProcessChanged(b,d){if(this.psValid()){var f=new TDatasetServiceArg(this.topControl().name,b);f.form=this;f.controlName=this.name;this.toDeepAttributes(f.attributes);f.codes=this.getDataCodes();f.rows=this.getChangedRows();f.resultCallback=d;if(!f.hasData())return RMessage.warn(this,RContext.get("MUiDataset:nochange"));this.psProgress(!0);f.callback=new TInvoke(this,this.onDsProcess);RConsole.find(FFormConsole).process(f)}}
function MUiDataset_dsProcessAll(b,d){if(this.psValid()){var f=new TDatasetServiceArg(this.topControl().name,b);f.form=this;f.controlName=this.name;this.toDeepAttributes(f.attributes);f.codes=this.getDataCodes();f.rows=this.getRows();f.resultCallback=d;this.psProgress(!0);f.callback=new TInvoke(this,this.onDsProcess);RConsole.find(FFormConsole).process(f)}}function MUiDataset_psProgress(b){if(this.__progress!=b){this.__progress=b;var d=this.__progressProcess;d.enable=b;this.process(d)}}
function MUiDataset_psValid(){var b=this.__validProcess,d=b.controls;d.clear();this.process(b);return d.isEmpty()?!0:(b=RConsole.find(FCheckWindowConsole).find(),b.set(d),b.show(),!1)}function MUiDataset_dsIsChanged(){var b=this.dsStore;return b?b.isChanged():!1}function MUiDataset_dsCount(){return this.dsStore?this.dsStore.count:0}function MUiDataset_dsCurrent(){}
function MUiDataset_dsMove(b){var d=this.dsStore;if(null!=b||d)RInt.isInt(b)?d.move(b):EDataAction.First==b?d.moveFirst():EDataAction.Prior==b?d.movePrior():EDataAction.Next==b?d.moveNext():EDataAction.Last==b?d.moveLast():RMessage.fatal(this,null,"Unknown position (postion={0})",b),RClass.isClass(this,MValue)&&this.loadValue(d.current())}
function MUiDataset_dsMovePage(b){var d=this.dsStore;RInt.isInt(b)||(EDataAction.First==b?b=0:EDataAction.Prior==b?(b=d.pageIndex,0<b&&b--):EDataAction.Next==b?(b=d.pageIndex,b<d.pageCount-1&&b++):EDataAction.Last==b?b=d.pageCount-1:RMessage.fatal(this,null,"Unknown page (page={0})",b));b!=d.pageIndex&&(this.psProgress(!0),d=this.topControl(MUiDataset),b=new TDatasetFetchArg(d.name,d.formId,this.dsPageSize,b,!0),b.path=this.fullPath(),b.mode=d._emode,b.searchs.append(this._dataGlobalSearchs),b.searchs.append(this._dataSearchs),
b.orders.append(this._dataGlobalOrders),b.orders.append(this._dataOrders),b.values=this.toDeepAttributes(),b.values.append(this._dataValues),b.callback=new TInvoke(this,this.onDsFetch),RConsole.find(FDatasetConsole).fetch(b))}function MUiDataset_dsGet(b){return this.dsStore?this.dsStore.get(b):""}function MUiDataset_dsSet(b,d){this.dsStore&&this.dsStore.set(b,d)}function MUiDataset_dsRefresh(){this._dsService&&this.dsMove(this.dsPage,!0)}
function MUiDataset_doSearch(){var b=this.dsSearchWindow;b||(b=this.dsSearchWindow=top.RControl.create(top.FSearchWindow),b.linkDsControl(this));b.show()}function MUiDataValue(b){b=RClass.inherits(this,b);b.oeDataLoadValue=RMethod.empty;b.oeDataSaveValue=RMethod.empty;return b}var RUiDataEvent=new function(){this.codeEvent=this.recordEvent=this.saveEvent=this.loadEvent=this.resetEvent=this.clearEvent=null;this.construct=RUiDataEvent_construct;this.construct();return this};
function RUiDataEvent_construct(b){this.clearEvent=new TEventProcess(this,"oeClearValue",MUiDataValue);this.resetEvent=new TEventProcess(this,"oeResetValue",MUiDataValue);this.loadEvent=new TEventProcess(this,"oeLoadValue",MUiDataValue);this.saveEvent=new TEventProcess(this,"oeSaveValue",MUiDataValue);this.recordEvent=new TEventProcess(this,"oeRecordValue",MUiDataValue);this.codeEvent=new TEventProcess(this,"oeSaveCode",MUiDataValue)}
function FDatasetConsole(b){b=RClass.inherits(this,b,FConsole);b._scopeCd=EScope.Local;b._service="cloud.data.frame";b._datasets=null;b.onFetch=FDatasetConsole_onFetch;b.construct=FDatasetConsole_construct;b.loadDataset=FDatasetConsole_loadDataset;b.loadDatasets=FDatasetConsole_loadDatasets;b.fetch=FDatasetConsole_fetch;return b}
function FDatasetConsole_onFetch(b){var d=b.parameter,f=b.outputNode;if(f.hasNode()){this.loadDatasets(f);b=d.datasets;for(var f=f.nodes(),h=f.count(),q=0;q<h;q++){var z=f.get(q).get("name"),A=this._datasets.get(z);b.set(z,A)}}d.process()}function FDatasetConsole_construct(){this.__base.FConsole.construct.call(this);this._datasets=new TDictionary}
function FDatasetConsole_loadDataset(b){var d=b.get("name");if(RString.isEmpty(d))throw new TError("Unknown dataset name.");var f=this._datasets.get(d);f||(f=new TDataset,f.name=d,this._datasets.set(d,f));f.clear();f.loadConfig(b);return f}function FDatasetConsole_loadDatasets(b){if(b.hasNode()){b=b.nodes();for(var d=b.count(),f=0;f<d;f++){var h=b.get(f);h.isName("Dataset")&&this.loadDataset(h)}}}
function FDatasetConsole_fetch(b){var d=new TXmlDocument,f=d.root();f.set("action","fetch");b.saveConfig(f.create("Frame"));f=new SXmlEvent;f.owner=this;f.url=RService.url(this._service);f.action=EDataAction.Fetch;f.parameter=b;f.inputDocument=d;f.callback=this.onFetch;RConsole.find(FXmlConsole).process(f)}function FDatasetConsole_onScalarLoaded(b,d){if(d.hasNode()){var f=b.resultConfig=d.find("Control");f&&(b.result=f.get("result"))}b.invoke()}
function FDatasetConsole_scalar(b){var d=new TXmlDocument,f=d.root();f.set("action",EDataAction.Scalar);f.push(b.toNode());f=new TEvent(this,EXmlEvent.Send,this.onLoaded);f.url=RService.url("logic.webform.dataset");f.action=EDataAction.Scalar;f.argument=b;f.document=d;RConsole.find(FXmlConsole).process(f)}function FDatasetConsole_onCompleteLoaded(b,d){if(d.hasNode()){var f=d.find("Control");f&&(b.resultConfig=f)}b.invoke()}function FDatasetConsole_onLovLoadeded(b,d){b.lovNode=d;b.invoke()}
function FDatasetConsole_onPrepareLoaded(b,d){var f=b.resultDatasets;if(d.hasNode())for(var h=d.nodes,q=h.count,z=0;z<q;z++){var A=h.get(z),B=A.get("id");RString.isEmpty(B)||this.loadDatasets(f,B,A)}if(!f.isEmpty())for(h=f.count,z=0;z<h;z++)if(q=f.value(z),"/"==q.name){b.resultRow=q.row(0);break}b.invoke()}
function FDatasetConsole_onUpdateLoaded(b,d){var f=d.find("Form");if(f){var h=f.get("id");if(f=f.find("Dataset"))h=b.resultDataset=this.loadDataset(h,f),b.resultRow=h.row(0),b.invoke(),RWindow.setEnable(!0)}}
function FDatasetConsole_onLoaded(b){var d=b.document.root(),f=b.argument;if(!b.messageChecked){var h=new TMessageArg;h.argument=f;h.form=f.form;h.config=d;h.invokeCaller=new TInvoke(this,this.onLoaded);h.invokeParam=b;h.event=b;if(!RConsole.find(FMessageConsole).checkResult(h))return}f.configResult=d;switch(b.action){case EDataAction.Fetch:this.onFetchLoaded(f,d);break;case EDataAction.Prepare:this.onPrepareLoaded(f,d);break;case EDataAction.Update:this.onUpdateLoaded(f,d);break;case EDataAction.Lov:this.onLovLoaded(f,
d);break;case EDataAction.Scalar:this.onScalarLoaded(f,d);break;case EDataAction.Complete:this.onCompleteLoaded(f,d)}RConsole.find(FListenerConsole).process(MDataset,EAction.Changed,b,b)}function FDatasetConsole_complete(b){var d=new TXmlDocument,f=d.root();f.set("action","complete");f.push(b.toNode());f=new TEvent(this,EXmlEvent.Send,this.onLoaded);f.url=RService.url("logic.webform.dataset");f.action=EDataAction.Complete;f.argument=b;f.document=d;RConsole.find(FXmlConsole).process(f)}
function FDatasetConsole_lov(b){var d=new TXmlDocument,f=d.root();f.set("action","lov");f.push(b.toNode());f=new TEvent(this,EXmlEvent.Send,this.onLoaded);f.url=RService.url("logic.webform.dataset");f.action=EDataAction.Lov;f.argument=b;f.document=d;RConsole.find(FXmlConsole).process(f)}
function FDatasetConsole_prepare(b){var d=new TXmlDocument,f=d.root();f.set("action","prepare");f.push(b.toNode());f=new TEvent(this,EXmlEvent.Send,this.onLoaded);f.url=RService.url("logic.webform.dataset");f.action=EDataAction.Prepare;f.argument=b;f.document=d;RConsole.find(FXmlConsole).process(f)}
function FDatasetConsole_update(b){var d=new TXmlDocument,f=d.root();f.set("action","update");b.checked&&f.set("checked",b.checked);f.push(b.toNode());f=new TEvent(this,EXmlEvent.Send,this.onLoaded);f.url=RService.url("logic.webform.dataset");f.action=EDataAction.Update;f.argument=b;f.document=d;RConsole.find(FXmlConsole).process(f)}function FDatasetConsole_get(b){return this.forms.get(b)}function FDatasetConsole_getById(b){return this._datasets.get(b)}
function FDatasetConsole_getByPath(b,d){var f=this.get(b);return f?f.get(d):null}function FDatasetConsole_onTreeLoaded(b){alert(1)}function FDatasetConsole_onColumnFetch(b){var d=b.document.root();if(RConsole.find(FMessageConsole).checkResult(d)){b=b.arg;if(d.hasNode())for(var d=d.nodes,f=d.count,h=0;h<f;h++){var q=d.get(h);if(q.hasNode()){var q=q.nodes,z=q.count;for(n=0;n<z;n++){var A=q.get(n);if("Data"==A.name){b.resultConfig=A;break}}}}b.invoke()}}
function FDatasetConsole_columnNodeFetch(b){var d=new TXmlDocument,f=d.root();f.set("action",b.action);var h=b.toNode();f.push(h);f=RService.url(b.service);h=new TEvent(this,EXmlEvent.Send,this.onColumnFetch);h.url=f;h.document=d;h.arg=b;h.action=EDataAction.Fetch;RConsole.find(FXmlConsole).process(h)}
function FDatasetConsole_treeUpdate(b){var d=new TXmlDocument,f=d.root();f.set("action",b.action);var h=b.toNode();f.push(h);f=RService.url(b.service);h=new TEvent(this,EXmlEvent.Send,this.onTreeLoaded);h.url=f;h.document=d;h.arg=b;h.action=EDataAction.TreeUpdate;RConsole.find(FXmlConsole).process(h)}
function FDataSource(b){b=RClass.inherits(this,b,FObject);b._currentRow=null;b._currentDataset=null;b._datasets=null;b.construct=FDataSource_construct;b.selectDataset=FDataSource_selectDataset;b.currentDataset=FDataSource_currentDataset;b.selectRow=FDataSource_selectRow;b.currentRow=FDataSource_currentRow;return b}function FDataSource_construct(){this.__base.FObject.construct.call(this);this._datasets=new TDictionary}
function FDataSource_selectDataset(b){b=RString.nvl(b,"default");var d=this._datasets.get(b);null==d&&(d=new TDataset,d._name=b,this._datasets.set(b,d));this._currentDataset=d}function FDataSource_currentDataset(){return this._currentDataset}function FDataSource_selectRow(b){if(b)this._currentRow=b;else{b=this._currentDataset;var d=b.rows().first();null==d&&(d=b.createRow());return this._currentRow=d}}function FDataSource_currentRow(){return this._currentRow}
function FDataSource_create(b){return this.dataset.create(b)}function FDataSource_count(){return this.dataset.count}function FDataSource_row(b){return this.dataset.get(b)}function FDataSource_current(){return this.row(this._position)}function FDataSource_isChanged(){for(var b=this.dataset,d=0;d<b.count;d++){var f=b.get(d);if(f&&f.isSave())return!0}return!1}function FDataSource_get(b){var d=this.current();return d?d.get(b):""}function FDataSource_set(b,d){var f=this.current();f&&f.set(b,d)}
function FDataSource_move(b){this._position=b}function FDataSource_moveToRow(b){b=this.dataset.indexOf(b);-1!=b&&(this._position=b)}function FDataSource_find(){return this.dataset.findByArgs(arguments)}function FDataSource_loadNode(b){if(b&&b.nodes){b=b.nodes;for(var d=0;d<b.count;d++){var f=b.get(d);if(f&&f.isName("Row")){var h=this.dataset.create();h.loadNode(f);h.store()}}}}function FDataSource_dump(b){b=RString.nvlStr(b);b.appendLine(RClass.dump(this));this.dataset.dump(b);return b}
function FUiDataAction(b){b=RClass.inherits(this,b,FUiComponent,MInvoke);b._action=RClass.register(b,new APtyString("_action"));b._service=RClass.register(b,new APtyString("_service"));b._execute=RClass.register(b,new APtyString("_execute"));b._loading=!1;b._dataContainer=null;b.onLoaded=FUiDataAction_onLoaded;b.invoke=FUiDataAction_invoke;return b}function FUiDataAction_onLoaded(b){RWindow.setEnable(!0);this._loading=!1}
function FUiDataAction_invoke(b){RAssert.debugTrue(RClass.isClass(b,MUiDataContainer));var d=RService.parse(this._service);if(!d)throw new TError(this,"Unknown service.");RWindow.setEnable(!1);var f=new TXmlDocument,h=f.root();h.set("action",d.action);RConsole.find(FEnvironmentConsole).build(h);b.dsSaveValue(h.create("Data"));RLogger.debug(this,f.dump());this._loading=!0;this._dataContainer=b;RConsole.find(FXmlConsole).sendAsync(d.url,f).addLoadListener(this,this.onLoaded)}
function FUiDataCheck(b){return b=RClass.inherits(this,b,FUiCheck,MUiDataField)}function FUiDataColorPicker(b){return b=RClass.inherits(this,b,FUiEdit,MUiDataField)}function FUiDataColorPicker_onDataKeyDown(b,d){this.__base.FUiEdit.onDataKeyDown.call(this,b,d);this.editCase&&RKey.fixCase(d,this.editCase);if(this._editable&&this.editComplete&&16!=d.keyCode&&17!=d.keyCode&&18!=d.keyCode&&20!=d.keyCode){var f=this.findEditor();if(f)f.onEditKeyDown(b,d)}}
function FUiDataColorPicker_formatValue(b){b=RString.nvl(b);ECase.Upper==this.editCase?b=RString.toUpper(b):ECase.Lower==this.editCase&&(b=RString.toLower(b));return b}function FUiDataColorPicker_setText(b){this.hEdit&&(this.hEdit.value="U"==this.editCase?RString.toUpper(b):"L"==this.editCase?RString.toLower(b):b,this.hEdit.style.textAlign="right"==this.editAlign?"right":"left"==this.editAlign?"left":"center")}
function FUiDataColorPicker_validText(b){var d=this.__base.FUiEdit.validText.call(this,b);if(!d){if(this.validLenmin&&this.validLenmin>b.length)return RContext.get("MDescEdit:ValidMinLength",this.validLenmin);if(this.validLenmax&&this.validLenmax<b.length)return RContext.get("MDescEdit:ValidMaxLength",this.validLenmax)}return d}
function FUiDataColorPicker_findEditor(){if(this.editComplete){var b=this.editor;!b&&(this.dsControl=this.topControl(MDataset))&&(b=this.editor=RConsole.find(FUiDataColorPickerConsole).focus(this,FUiDataColorPickerEditor));b&&b.linkControl(this);return this.editor}}function FUiDataColorPicker_drop(){var b=this.findEditor();if(b){var d=this.reget();0<d.length&&(this.finded!=d&&(b.source!=this&&b.linkControl(this),b.search(d)),this.finded=d)}}
function FUiDataEdit(b){return b=RClass.inherits(this,b,FUiEdit,MUiDataField)}function FUiDataEdit_onDataKeyDown(b,d){this.__base.FUiEdit.onDataKeyDown.call(this,b,d);this.editCase&&RKey.fixCase(d,this.editCase)}function FUiDataEdit_formatValue(b){b=RString.nvl(b);ECase.Upper==this.editCase?b=RString.toUpper(b):ECase.Lower==this.editCase&&(b=RString.toLower(b));return b}
function FUiDataEdit_setText(b){this.hEdit&&(this.hEdit.value="U"==this.editCase?RString.toUpper(b):"L"==this.editCase?RString.toLower(b):b,this.hEdit.style.textAlign="right"==this.editAlign?"right":"left"==this.editAlign?"left":"center")}
function FUiDataEdit_validText(b){var d=this.__base.FUiEdit.validText.call(this,b);if(!d){if(this.validLenmin&&this.validLenmin>b.length)return RContext.get("MDescEdit:ValidMinLength",this.validLenmin);if(this.validLenmax&&this.validLenmax<b.length)return RContext.get("MDescEdit:ValidMaxLength",this.validLenmax)}return d}
function FUiDataEdit_findEditor(){if(this.editComplete){var b=this.editor;!b&&(this.dsControl=this.topControl(MDataset))&&(b=this.editor=RConsole.find(FUiDataEditConsole).focus(this,FUiDataEditEditor));b&&b.linkControl(this);return this.editor}}function FUiDataEdit_drop(){var b=this.findEditor();if(b){var d=this.reget();0<d.length&&(this.finded!=d&&(b.source!=this&&b.linkControl(this),b.search(d)),this.finded=d)}}
function FUiDataEditControl(b){b=RClass.inherits(this,b,FUiEditControl,MUiEditValue,MUiEditChange,MUiEditDrop);b._labelModeCd=RClass.register(b,new APtyString("_labelModeCd"),EUiLabelMode.All);b._labelPositionCd=RClass.register(b,new APtyString("_labelPositionCd"),EUiLabelPosition.Left);b._labelSize=RClass.register(b,new APtySize2("_labelSize"));b._labelAlignCd=RClass.register(b,new APtyString("_labelAlignCd"),EUiAlign.Left);b._labelColor=RClass.register(b,new APtyString("_labelColor"));b._editSize=
RClass.register(b,new APtySize2("_editSize"));b._editColor=RClass.register(b,new APtyString("_editColor"));b._styleLabelPanel=RClass.register(b,new AStyle("_styleLabelPanel"));b._styleEditPanel=RClass.register(b,new AStyle("_styleEditPanel"));b._progressing=!1;b._hLabelPanel=null;b._hLabelForm=null;b._hIconPanel=null;b._hIcon=null;b._hTextPanel=null;b._hText=null;b._hEditPanel=null;b._hEditForm=null;b._hValuePanel=null;b.onBuildLabelIcon=FUiDataEditControl_onBuildLabelIcon;b.onBuildLabelText=FUiDataEditControl_onBuildLabelText;
b.onBuildLabel=FUiDataEditControl_onBuildLabel;b.onBuildEditValue=RMethod.virtual(b,"onBuildEditValue");b.onBuildEdit=FUiDataEditControl_onBuildEdit;b.onBuildPanel=FUiDataEditControl_onBuildPanel;b.onBuild=FUiDataEditControl_onBuild;b.oeMode=FUiDataEditControl_oeMode;b.oeProgress=FUiDataEditControl_oeProgress;b.construct=FUiDataEditControl_construct;b.panel=FUiDataEditControl_panel;b.label=FUiDataEditControl_label;b.setLabel=FUiDataEditControl_setLabel;b.text=FUiDataEditControl_text;b.setText=FUiDataEditControl_setText;
b.getValueRectangle=FUiDataEditControl_getValueRectangle;b.dispose=FUiDataEditControl_dispose;return b}function FUiDataEditControl_onBuildLabelIcon(b){this._hIcon=this._labelIcon?RBuilder.appendIcon(this._hIconPanel,null,this._labelIcon):RBuilder.appendIcon(this._hIconPanel,null,"n",16,16)}function FUiDataEditControl_onBuildLabelText(b){this._hText=RBuilder.appendSpan(this._hTextPanel,null,this._label)}
function FUiDataEditControl_onBuildLabel(b){var d=this._hLabelForm=RBuilder.appendTable(this._hLabelPanel,this.styleName("LabelPanel")),f=RBuilder.appendTableRow(d);(this._hIconPanel=RBuilder.appendTableCell(f)).width="20px";this.onBuildLabelIcon(b);f=this._hTextPanel=RBuilder.appendTableCell(f);f.noWrap=!0;this.onBuildLabelText(b);RHtml.setSize(d,this._labelSize);this._labelAlignCd&&(f.align=this._labelAlignCd,f.style.paddingRight=4);this._labelColor&&(this._hLabel.style.color=this._labelColor)}
function FUiDataEditControl_onBuildEdit(b){var d=this._hEditForm=RBuilder.appendTable(this._hEditPanel,this.styleName("EditPanel")),f=this._hEditLine=RBuilder.appendTableRow(d);this._hValuePanel=RBuilder.appendTableCell(f);this.onBuildEditValue(b);RHtml.setSize(d,this._editSize)}function FUiDataEditControl_onBuildPanel(b){this._hPanel=RBuilder.createTable(b,this.styleName("Panel"))}
function FUiDataEditControl_onBuild(b){this.__base.FUiEditControl.onBuild.call(this,b);var d=this._hPanel,f=null,h=null,q=this._labelModeCd;q==EUiLabelMode.Label?f=RBuilder.appendTableCell(RBuilder.appendTableRow(d)):q==EUiLabelMode.Hidden?h=RBuilder.appendTableCell(RBuilder.appendTableRow(d)):(f=this._labelPositionCd,f==EUiLabelPosition.Top?(f=RBuilder.appendTableRowCell(d),h=RBuilder.appendTableRowCell(d)):f==EUiLabelPosition.Right?(d=RBuilder.appendTableRow(d),h=RBuilder.appendTableCell(d),f=RBuilder.appendTableCell(d)):
f==EUiLabelPosition.Bottom?(h=RBuilder.appendTableRowCell(d),f=RBuilder.appendTableRowCell(d)):(d=RBuilder.appendTableRow(d),f=RBuilder.appendTableCell(d),h=RBuilder.appendTableCell(d)));this._hLabelPanel=f;this._hEditPanel=h;f&&(this.onBuildLabel(b),f.appendChild(this._hLabelForm),this.setLabel(this._label));if(h)this.onBuildEdit(b)}
function FUiDataEditControl_oeMode(b){this.__base.FUiEditControl.oeMode.call(this,b);this.__base.MDisplay.oeMode.call(this,b);this._editable=this.canEdit(b.mode);this._validable=this.canValid(b.mode);this._progressing||this.setEditable(this._editable);return EEventStatus.Stop}
function FUiDataEditControl_oeProgress(b){if(this._progressing&&b.enable)return EEventStatus.Stop;(this._progressing=b.enable)?(b=this._editable,this.setEditable(!1),this._editable=b):this.setEditable(this._editable);return EEventStatus.Stop}function FUiDataEditControl_construct(){this.__base.FUiEditControl.construct.call(this);this.__base.MUiEditChange.construct.call(this);this.__base.MUiEditDrop.construct.call(this);this._labelSize=new SSize2(100,20);this._editSize=new SSize2(200,20)}
function FUiDataEditControl_panel(b){return EPanel.Edit==b||EPanel.Focus==b?this.hEdit:this.__base.FUiEditControl.panel.call(this,b)}function FUiDataEditControl_label(b){return this._label}function FUiDataEditControl_setLabel(b){this._label=b;this._hText&&(this._hText.innerHTML=RString.nvl(b))}function FUiDataEditControl_text(){throw new TUnsupportError(o,"text");}function FUiDataEditControl_setText(b){throw new TUnsupportError(o,"setText");}
function FUiDataEditControl_getValueRectangle(b){b||(b=new SRectangle);var d=this._hValuePanel,f=RHtml.clientPosition(d);b.position.assign(f);b.setSize(d.offsetWidth,d.offsetHeight);return b}
function FUiDataEditControl_dispose(){this._dataTypeCd=this._labelAlignCd=this._labelPositionCd=this._labelModeCd=null;this._labelSize=RObject.dispose(this._labelSize);this._editSize=RObject.dispose(this._editSize);this._hLabelPanel=RHtml.free(this._hLabelPanel);this._hLabelForm=RHtml.free(this._hLabelForm);this._hIconPanel=RHtml.free(this._hIconPanel);this._hIcon=RHtml.free(this._hIcon);this._hTextPanel=RHtml.free(this._hTextPanel);this._hText=RHtml.free(this._hText);this._hEditPanel=RHtml.free(this._hEditPanel);
this._hEditForm=RHtml.free(this._hEditForm);this._hValuePanel=RHtml.free(this._hValuePanel);this._hDropPanel=RHtml.free(this._hDropPanel);this.__base.MUiEditDrop.dispose.call(this);this.__base.MUiEditChange.dispose.call(this);this.__base.FUiEditControl.dispose.call(this)}function FUiDataEditControl_onScalar(b){this.set(b.result)}function FUiDataEditControl_scalar(b){b=new TDatasetScalarArg(this,null,b);b.callback=new TInvoke(this,this.onScalar);RConsole.find(FDatasetConsole).scalar(b)}
function FUiDataEditControl_onDataDoubleClick(){if(RClass.isClass(this,MDropable))this.onDropDoubleClick();if(RClass.isClass(this,MListView))this.onListClick()}
function FUiDataEditControl_onDataKeyDown(b,d){this.__base.MEditDescriptor.onDataKeyDown.call(this,b,d);var f=this.hChangeIcon;f&&(f.style.display=this.isDataChanged()?"block":"none");if(RClass.isClass(this,MDropable)&&EKey.Down==d.keyCode)this.drop();else if(d.ctrlKey&&EKey.Enter==d.keyCode&&this.editSearch&&(f=this.dsControl)&&!this.isValid){var h=new TNode("Search"),q=h.create("Item");q.set("name",this.name);q.set("data_name",this.dataName);q.set("data_value",this.dataValue);q.set("search_type",
ESearch.Equals);q.set("search_order",EOrder.None);RConsole.find(FDatasetConsole).fetch(f,h)}}function FUiDataEditControl_onDesignBegin(){this.__base.MDesign.onDesignBegin.call(this);this._disbaled=!0;this.hEdit.disbaled=!0}function FUiDataEditControl_onDesignEnd(){this.__base.MDesign.onDesignEnd.call(this);this._disbaled=!1;this.hEdit.disbaled=!1}function FUiDataEditControl_oeDataLoad(b){b=b.source.currentRow().get(this._dataName);this.set(b);return EEventStatus.Stop}
function FUiDataEditControl_oeDataSave(b){b=b.source.currentRow();var d=this.get();b.set(this._dataName,d);return EEventStatus.Stop}
function FUiDataEditControl_oeDesign(b){this.__base.MDesign.oeDesign.call(this,e);b=this.hLabelForm;var d=this.hEditForm;switch(e.mode){case EDesign.Move:e.flag?(this.hForm.border=1,b&&(b.cellPadding=1),this.hEdit&&(this.hEdit.disabled=!0)):(this.hForm.border=0,b&&(b.border=0,b.cellPadding=0),this.hEdit&&(this.hEdit.disabled=!1));break;case EDesign.Border:e.flag?(this.hForm.border=1,d&&(d.border=1)):(this.hForm.border=0,d&&(d.border=0))}return EEventStatus.Stop}
function FUiDataEditControl_oeLoadValue(b){b=this.__base.MUiEditValue.oeLoadValue.call(this,b);var d=this.hChangeIcon;d&&(d.style.display="none");return b}function FUiDataEditControl_doFocus(b){this.__base.MUiFocus.doFocus.call(this,b);this.__base.MUiEditValue.doFocus.call(this,b)}function FUiDataEditControl_doBlur(b){this.__base.MUiFocus.doBlur.call(this,b);this.__base.MUiEditValue.doBlur.call(this,b)}function FUiDataEditControl_testFocus(){return this._visible&&this._editable&&!this._disbaled}
function FUiDataEditControl_setEditable(b){this.__base.MUiEditValue.setEditable.call(this,b);this.hEdit&&(this.hEdit.readOnly=!b);var d=this.hLabel;d&&(this.validRequire&&(this.hLabel.style.color=b?EUiColor.Require:EUiColor.Text),RClass.isClass(this,MListView)&&this.canListView()&&(d.style.cursor=b?"hand":"normal",d.className=b?"RLine_Underline":""))}function FUiDataEditControl_setVisible(b){this.__base.FUiEditControl.setVisible.call(this,b);this.refreshStyle()}
function FUiDataEditControl_focus(){this.__base.MUiFocus.focus.call(this);if(this.hEdit)try{this.hEdit.focus()}catch(b){}}
function FUiDataEditControl_refreshStyle(){if(this._visible){var b=EUiColor.TextReadonly,d=EUiColor.Readonly,f="normal";this._editable&&(b=EUiColor.TextEdit,d=EUiColor.Edit,f="hand",RString.isEmpty(this.editTip)||this.hEdit.innerText!=this.editTip||(b="#CCCCCC"));this._invalidText&&!RString.isEmpty(this.text())&&(b=EUiColor.TextInvalid,d=EUiColor.Invalid);this._textColor=b;this._backColor=d;var h=this.hEdit,q=this.hDrop;h&&(h.style.color=b,h.style.backgroundColor=d);q&&(h&&(h.style.cursor=f),q.style.cursor=
f);this.editBorder&&(b=EUiBorderStyle.Readonly,this._editable&&(b=EUiBorderStyle.Edit),this._hover&&(b=EUiBorderStyle.Hover),this.setEditBorderStyle(b,d))}}function FUiDataFrame(b){return b=RClass.inherits(this,b,FUiFrame,MUiDataset,MUiDataContainer,MUiDataAction)}function FUiDataIconPicker(b){return b=RClass.inherits(this,b,FUiEdit,MUiDataField)}function FUiDataIconPicker_onDataKeyDown(b,d){this.__base.FUiEdit.onDataKeyDown.call(this,b,d);this.editCase&&RKey.fixCase(d,this.editCase)}
function FUiDataIconPicker_formatValue(b){b=RString.nvl(b);ECase.Upper==this.editCase?b=RString.toUpper(b):ECase.Lower==this.editCase&&(b=RString.toLower(b));return b}function FUiDataIconPicker_setText(b){this.hEdit&&(this.hEdit.value="U"==this.editCase?RString.toUpper(b):"L"==this.editCase?RString.toLower(b):b,this.hEdit.style.textAlign="right"==this.editAlign?"right":"left"==this.editAlign?"left":"center")}
function FUiDataIconPicker_validText(b){var d=this.__base.FUiEdit.validText.call(this,b);if(!d){if(this.validLenmin&&this.validLenmin>b.length)return RContext.get("MDescEdit:ValidMinLength",this.validLenmin);if(this.validLenmax&&this.validLenmax<b.length)return RContext.get("MDescEdit:ValidMaxLength",this.validLenmax)}return d}
function FUiDataIconPicker_findEditor(){if(this.editComplete){var b=this.editor;!b&&(this.dsControl=this.topControl(MDataset))&&(b=this.editor=RConsole.find(FUiDataIconPickerConsole).focus(this,FUiDataIconPickerEditor));b&&b.linkControl(this);return this.editor}}function FUiDataIconPicker_drop(){var b=this.findEditor();if(b){var d=this.reget();0<d.length&&(this.finded!=d&&(b.source!=this&&b.linkControl(this),b.search(d)),this.finded=d)}}
function FUiDataMemo(b){return b=RClass.inherits(this,b,FUiMemo,MUiDataField)}function FUiDataNumber(b){return b=RClass.inherits(this,b,FUiNumber)}function FUiDataNumber_onEditFocus(b){this.setText(this.formatValue(this.text()))}function FUiDataNumber_onEditBlur(b){this.setText(this.formatText(this.text()))}
function FUiDataNumber_onBuildEdit(b){var d=RBuilder.appendTable(b.hPanel);d.style.tableLayout="fixed";d=this.hEdit=d.insertRow();this.onBuildChange(d.insertCell());if(this.canZoom()){var f=d.insertCell();this.hZoom=RBuilder.appendIcon(f,"ctl.zooms");f.width=16}f=d.insertCell();f.style.width="100%";d=this.hEdit=RBuilder.appendEdit(f,this.style("Edit"));this.attachEvent("onEditFocus",d,this.onEditFocus);this.attachEvent("onEditKeyPress",d,this.onEditKeyPress);this.attachEvent("onEditBlur",d,this.onEditBlur);
this.attachEvent("onDataKeyUp",d,this.ohEditKeyUp);this.editLength&&(d.maxLength=this.editLength);this.buildAdjustForm(b.hDrop)}function FUiDataNumber_setUnitIcon(b){this.hUnit.innerHTML="<IMG src="+b+">"}function FUiDataNumber_onDataKeyDown(b,d){this.canEdit&&(EKey.Up==d.keyCode?this.adjustValue(!0):EKey.Down==d.keyCode&&this.adjustValue(!1));this.base.FUiNumber.onDataKeyDown.call(this,b,d)}
function FUiDataNumber_ohEditKeyUp(b,d){EKey.Up==d.keyCode&&this.canEdit?this.hUpIcon.src=this.styleIconPath("UpSelect"):EKey.Down==d.keyCode&&this.canEdit&&(this.hDownIcon.src=this.styleIconPath("DownSelect"))}function FUiDataNumber_onEditKeyDown(b){this.canEdit&&(EKey.Up==b.keyCode?(b.source.hUpIcon.src=this.styleIconPath("up"),this.changeValue(b,"Y")):EKey.Down==b.keyCode&&(b.source.hDownIcon.src=this.styleIconPath("down"),this.changeValue(b,"N")))}
function FUiDataNumber_onEditKeyUp(b){this.canEdit&&(EKey.Up==b.keyCode?b.source.hUpIcon.src=this.styleIconPath("upSelect"):EKey.Down==b.keyCode&&(b.source.hDownIcon.src=this.styleIconPath("downSelect")))}function FUiDataNumber_onEditDoubleClick(){this.onListClick()}
function FUiDataNumber_validPattern(b){var d=!0;b=RString.nvl(b);if(!RRegExp.test(ERegExp.NUMBER,b))return!1;var f=null;if(this.dataType){for(n in ERegExp)if(RString.equals(n,this.dataType)){f=ERegExp[n];break}RString.equals(RClass.name(f),"RegExp")&&(d=RRegExp.test(f,b)?d&1:d&0)}this.editMaxvalue&&(d=parseFloat(b)<=parseFloat(this.editMaxvalue)?d&1:d&0);this.editMinvalue&&(d=parseFloat(b)>=parseFloat(this.editMinvalue)?d&1:d&0);return d}
function FUiDataNumber_refreshStyle(){this.base.FUiNumber.refreshStyle.call(this);this.hUpIcon.src=this.styleIconPath(this._hover?"UpSelect":"Up");this.hDownIcon.src=this.styleIconPath(this._hover?"DownSelect":"Down")}
function FUiDataNumber_splitValue(b){b=RString.nvl(b.toString());var d=RString.findChars(b,"-"),f=RString.findChars(b,"%");b=RString.removeChars(b,"'");b=RString.removeChars(b," ");b=RString.removeChars(b,"%");b=RString.removeChars(b,"-");if(!RString.isEmpty(b)){for(var h="",q=0,z=b.length;-1<z;z--)h=0!=z&&0!=q&&0==q%3?"'"+b.charAt(z)+h:b.charAt(z)+h,q++;-1!=d&&(h="-"+h);-1!=f&&(h+="%");return h}return b}
function FUiDataNumber_removeSplit(b){b=RString.nvl(b);b=RString.removeChars(b,"'");return b=RString.removeChars(b,"%")}
function FUiDataNumber_precisionValue(b){if(RString.isEmpty(b))return b;var d,f,h=RString.nvl(this.editPrecision);b=RString.nvl(b);RString.contains(h,".")?f=h.split(".")[1].length:d=h.length;if(RString.contains(b,"."))b=b.split("."),f&&(f>b[1].length?b[1]=RString.rpad(b[1],f-b[1].length,"0"):f<=b[1].length&&(b[1]=b[1].substring(0,f))),d&&(d>b[0].length?alert(d):d<b[0].length&&(b[0]=b[0].substring(0,b[0].length-d),b[0]=RString.rpad(b[0],d,"0")),b[1]=null),b=b[1]?b[0]+"."+RString.nvl(b[1]):b[0];else{if(d)if(d<=
b.length)for(b=b.substring(0,b.length-d+1),h=0;h<d-1;h++)b=b.concat("0");else d>b.length&&(b=0);if(f)for(b+=".",h=0;h<f;h++)b=b.concat("0")}return b}function FUiDataNumber_dispose(){this.base.FUiNumber.dispose.call(this);this.hChgIic=this.hDownIcon=this.hUpIcon=this.hLabel=null}function FUiDataNumber2(b){return b=RClass.inherits(this,b,FUiNumber2)}function FUiDataNumber2_onEditFocus(b){this.setText(this.formatValue(this.text()))}
function FUiDataNumber2_onEditBlur(b){this.setText(this.formatText(this.text()))}
function FUiDataNumber2_onBuildEdit(b){var d=RBuilder.appendTable(b.hPanel);d.style.tableLayout="fixed";d=this.hEdit=d.insertRow();this.onBuildChange(d.insertCell());if(this.canZoom()){var f=d.insertCell();this.hZoom=RBuilder.appendIcon(f,"ctl.zooms");f.width=16}f=d.insertCell();f.style.width="100%";d=this.hEdit=RBuilder.appendEdit(f,this.style("Edit"));this.attachEvent("onEditFocus",d,this.onEditFocus);this.attachEvent("onEditKeyPress",d,this.onEditKeyPress);this.attachEvent("onEditBlur",d,this.onEditBlur);
this.attachEvent("onDataKeyUp",d,this.ohEditKeyUp);this.editLength&&(d.maxLength=this.editLength);this.buildAdjustForm(b.hDrop)}function FUiDataNumber2_setUnitIcon(b){this.hUnit.innerHTML="<IMG src="+b+">"}function FUiDataNumber2_onDataKeyDown(b,d){this.canEdit&&(EKey.Up==d.keyCode?this.adjustValue(!0):EKey.Down==d.keyCode&&this.adjustValue(!1));this.base.FUiNumber2.onDataKeyDown.call(this,b,d)}
function FUiDataNumber2_ohEditKeyUp(b,d){EKey.Up==d.keyCode&&this.canEdit?this.hUpIcon.src=this.styleIconPath("UpSelect"):EKey.Down==d.keyCode&&this.canEdit&&(this.hDownIcon.src=this.styleIconPath("DownSelect"))}function FUiDataNumber2_onEditKeyDown(b){this.canEdit&&(EKey.Up==b.keyCode?(b.source.hUpIcon.src=this.styleIconPath("up"),this.changeValue(b,"Y")):EKey.Down==b.keyCode&&(b.source.hDownIcon.src=this.styleIconPath("down"),this.changeValue(b,"N")))}
function FUiDataNumber2_onEditKeyUp(b){this.canEdit&&(EKey.Up==b.keyCode?b.source.hUpIcon.src=this.styleIconPath("upSelect"):EKey.Down==b.keyCode&&(b.source.hDownIcon.src=this.styleIconPath("downSelect")))}function FUiDataNumber2_onEditDoubleClick(){this.onListClick()}
function FUiDataNumber2_validPattern(b){var d=!0;b=RString.nvl(b);if(!RRegExp.test(ERegExp.NUMBER,b))return!1;var f=null;if(this.dataType){for(n in ERegExp)if(RString.equals(n,this.dataType)){f=ERegExp[n];break}RString.equals(RClass.name(f),"RegExp")&&(d=RRegExp.test(f,b)?d&1:d&0)}this.editMaxvalue&&(d=parseFloat(b)<=parseFloat(this.editMaxvalue)?d&1:d&0);this.editMinvalue&&(d=parseFloat(b)>=parseFloat(this.editMinvalue)?d&1:d&0);return d}
function FUiDataNumber2_refreshStyle(){this.base.FUiNumber2.refreshStyle.call(this);this.hUpIcon.src=this.styleIconPath(this._hover?"UpSelect":"Up");this.hDownIcon.src=this.styleIconPath(this._hover?"DownSelect":"Down")}
function FUiDataNumber2_splitValue(b){b=RString.nvl(b.toString());var d=RString.findChars(b,"-"),f=RString.findChars(b,"%");b=RString.removeChars(b,"'");b=RString.removeChars(b," ");b=RString.removeChars(b,"%");b=RString.removeChars(b,"-");if(!RString.isEmpty(b)){for(var h="",q=0,z=b.length;-1<z;z--)h=0!=z&&0!=q&&0==q%3?"'"+b.charAt(z)+h:b.charAt(z)+h,q++;-1!=d&&(h="-"+h);-1!=f&&(h+="%");return h}return b}
function FUiDataNumber2_removeSplit(b){b=RString.nvl(b);b=RString.removeChars(b,"'");return b=RString.removeChars(b,"%")}
function FUiDataNumber2_precisionValue(b){if(RString.isEmpty(b))return b;var d,f,h=RString.nvl(this.editPrecision);b=RString.nvl(b);RString.contains(h,".")?f=h.split(".")[1].length:d=h.length;if(RString.contains(b,"."))b=b.split("."),f&&(f>b[1].length?b[1]=RString.rpad(b[1],f-b[1].length,"0"):f<=b[1].length&&(b[1]=b[1].substring(0,f))),d&&(d>b[0].length?alert(d):d<b[0].length&&(b[0]=b[0].substring(0,b[0].length-d),b[0]=RString.rpad(b[0],d,"0")),b[1]=null),b=b[1]?b[0]+"."+RString.nvl(b[1]):b[0];else{if(d)if(d<=
b.length)for(b=b.substring(0,b.length-d+1),h=0;h<d-1;h++)b=b.concat("0");else d>b.length&&(b=0);if(f)for(b+=".",h=0;h<f;h++)b=b.concat("0")}return b}function FUiDataNumber2_dispose(){this.base.FUiNumber2.dispose.call(this);this.hChgIic=this.hDownIcon=this.hUpIcon=this.hLabel=null}function FUiDataNumber3(b){return b=RClass.inherits(this,b,FUiNumber3)}function FUiDataNumber3_onEditFocus(b){this.setText(this.formatValue(this.text()))}
function FUiDataNumber3_onEditBlur(b){this.setText(this.formatText(this.text()))}
function FUiDataNumber3_onBuildEdit(b){var d=RBuilder.appendTable(b.hPanel);d.style.tableLayout="fixed";d=this.hEdit=d.insertRow();this.onBuildChange(d.insertCell());if(this.canZoom()){var f=d.insertCell();this.hZoom=RBuilder.appendIcon(f,"ctl.zooms");f.width=16}f=d.insertCell();f.style.width="100%";d=this.hEdit=RBuilder.appendEdit(f,this.style("Edit"));this.attachEvent("onEditFocus",d,this.onEditFocus);this.attachEvent("onEditKeyPress",d,this.onEditKeyPress);this.attachEvent("onEditBlur",d,this.onEditBlur);
this.attachEvent("onDataKeyUp",d,this.ohEditKeyUp);this.editLength&&(d.maxLength=this.editLength);this.buildAdjustForm(b.hDrop)}function FUiDataNumber3_setUnitIcon(b){this.hUnit.innerHTML="<IMG src="+b+">"}function FUiDataNumber3_onDataKeyDown(b,d){this.canEdit&&(EKey.Up==d.keyCode?this.adjustValue(!0):EKey.Down==d.keyCode&&this.adjustValue(!1));this.base.FUiNumber3.onDataKeyDown.call(this,b,d)}
function FUiDataNumber3_ohEditKeyUp(b,d){EKey.Up==d.keyCode&&this.canEdit?this.hUpIcon.src=this.styleIconPath("UpSelect"):EKey.Down==d.keyCode&&this.canEdit&&(this.hDownIcon.src=this.styleIconPath("DownSelect"))}function FUiDataNumber3_onEditKeyDown(b){this.canEdit&&(EKey.Up==b.keyCode?(b.source.hUpIcon.src=this.styleIconPath("up"),this.changeValue(b,"Y")):EKey.Down==b.keyCode&&(b.source.hDownIcon.src=this.styleIconPath("down"),this.changeValue(b,"N")))}
function FUiDataNumber3_onEditKeyUp(b){this.canEdit&&(EKey.Up==b.keyCode?b.source.hUpIcon.src=this.styleIconPath("upSelect"):EKey.Down==b.keyCode&&(b.source.hDownIcon.src=this.styleIconPath("downSelect")))}function FUiDataNumber3_onEditDoubleClick(){this.onListClick()}
function FUiDataNumber3_validPattern(b){var d=!0;b=RString.nvl(b);if(!RRegExp.test(ERegExp.NUMBER,b))return!1;var f=null;if(this.dataType){for(n in ERegExp)if(RString.equals(n,this.dataType)){f=ERegExp[n];break}RString.equals(RClass.name(f),"RegExp")&&(d=RRegExp.test(f,b)?d&1:d&0)}this.editMaxvalue&&(d=parseFloat(b)<=parseFloat(this.editMaxvalue)?d&1:d&0);this.editMinvalue&&(d=parseFloat(b)>=parseFloat(this.editMinvalue)?d&1:d&0);return d}
function FUiDataNumber3_refreshStyle(){this.base.FUiNumber3.refreshStyle.call(this);this.hUpIcon.src=this.styleIconPath(this._hover?"UpSelect":"Up");this.hDownIcon.src=this.styleIconPath(this._hover?"DownSelect":"Down")}
function FUiDataNumber3_splitValue(b){b=RString.nvl(b.toString());var d=RString.findChars(b,"-"),f=RString.findChars(b,"%");b=RString.removeChars(b,"'");b=RString.removeChars(b," ");b=RString.removeChars(b,"%");b=RString.removeChars(b,"-");if(!RString.isEmpty(b)){for(var h="",q=0,z=b.length;-1<z;z--)h=0!=z&&0!=q&&0==q%3?"'"+b.charAt(z)+h:b.charAt(z)+h,q++;-1!=d&&(h="-"+h);-1!=f&&(h+="%");return h}return b}
function FUiDataNumber3_removeSplit(b){b=RString.nvl(b);b=RString.removeChars(b,"'");return b=RString.removeChars(b,"%")}
function FUiDataNumber3_precisionValue(b){if(RString.isEmpty(b))return b;var d,f,h=RString.nvl(this.editPrecision);b=RString.nvl(b);RString.contains(h,".")?f=h.split(".")[1].length:d=h.length;if(RString.contains(b,"."))b=b.split("."),f&&(f>b[1].length?b[1]=RString.rpad(b[1],f-b[1].length,"0"):f<=b[1].length&&(b[1]=b[1].substring(0,f))),d&&(d>b[0].length?alert(d):d<b[0].length&&(b[0]=b[0].substring(0,b[0].length-d),b[0]=RString.rpad(b[0],d,"0")),b[1]=null),b=b[1]?b[0]+"."+RString.nvl(b[1]):b[0];else{if(d)if(d<=
b.length)for(b=b.substring(0,b.length-d+1),h=0;h<d-1;h++)b=b.concat("0");else d>b.length&&(b=0);if(f)for(b+=".",h=0;h<f;h++)b=b.concat("0")}return b}function FUiDataNumber3_dispose(){this.base.FUiNumber3.dispose.call(this);this.hChgIic=this.hDownIcon=this.hUpIcon=this.hLabel=null}function FUiDataNumber4(b){return b=RClass.inherits(this,b,FUiNumber4)}function FUiDataNumber4_onEditFocus(b){this.setText(this.formatValue(this.text()))}
function FUiDataNumber4_onEditBlur(b){this.setText(this.formatText(this.text()))}
function FUiDataNumber4_onBuildEdit(b){var d=RBuilder.appendTable(b.hPanel);d.style.tableLayout="fixed";d=this.hEdit=d.insertRow();this.onBuildChange(d.insertCell());if(this.canZoom()){var f=d.insertCell();this.hZoom=RBuilder.appendIcon(f,"ctl.zooms");f.width=16}f=d.insertCell();f.style.width="100%";d=this.hEdit=RBuilder.appendEdit(f,this.style("Edit"));this.attachEvent("onEditFocus",d,this.onEditFocus);this.attachEvent("onEditKeyPress",d,this.onEditKeyPress);this.attachEvent("onEditBlur",d,this.onEditBlur);
this.attachEvent("onDataKeyUp",d,this.ohEditKeyUp);this.editLength&&(d.maxLength=this.editLength);this.buildAdjustForm(b.hDrop)}function FUiDataNumber4_setUnitIcon(b){this.hUnit.innerHTML="<IMG src="+b+">"}function FUiDataNumber4_onDataKeyDown(b,d){this.canEdit&&(EKey.Up==d.keyCode?this.adjustValue(!0):EKey.Down==d.keyCode&&this.adjustValue(!1));this.base.FUiNumber4.onDataKeyDown.call(this,b,d)}
function FUiDataNumber4_ohEditKeyUp(b,d){EKey.Up==d.keyCode&&this.canEdit?this.hUpIcon.src=this.styleIconPath("UpSelect"):EKey.Down==d.keyCode&&this.canEdit&&(this.hDownIcon.src=this.styleIconPath("DownSelect"))}function FUiDataNumber4_onEditKeyDown(b){this.canEdit&&(EKey.Up==b.keyCode?(b.source.hUpIcon.src=this.styleIconPath("up"),this.changeValue(b,"Y")):EKey.Down==b.keyCode&&(b.source.hDownIcon.src=this.styleIconPath("down"),this.changeValue(b,"N")))}
function FUiDataNumber4_onEditKeyUp(b){this.canEdit&&(EKey.Up==b.keyCode?b.source.hUpIcon.src=this.styleIconPath("upSelect"):EKey.Down==b.keyCode&&(b.source.hDownIcon.src=this.styleIconPath("downSelect")))}function FUiDataNumber4_onEditDoubleClick(){this.onListClick()}
function FUiDataNumber4_validPattern(b){var d=!0;b=RString.nvl(b);if(!RRegExp.test(ERegExp.NUMBER,b))return!1;var f=null;if(this.dataType){for(n in ERegExp)if(RString.equals(n,this.dataType)){f=ERegExp[n];break}RString.equals(RClass.name(f),"RegExp")&&(d=RRegExp.test(f,b)?d&1:d&0)}this.editMaxvalue&&(d=parseFloat(b)<=parseFloat(this.editMaxvalue)?d&1:d&0);this.editMinvalue&&(d=parseFloat(b)>=parseFloat(this.editMinvalue)?d&1:d&0);return d}
function FUiDataNumber4_refreshStyle(){this.base.FUiNumber4.refreshStyle.call(this);this.hUpIcon.src=this.styleIconPath(this._hover?"UpSelect":"Up");this.hDownIcon.src=this.styleIconPath(this._hover?"DownSelect":"Down")}
function FUiDataNumber4_splitValue(b){b=RString.nvl(b.toString());var d=RString.findChars(b,"-"),f=RString.findChars(b,"%");b=RString.removeChars(b,"'");b=RString.removeChars(b," ");b=RString.removeChars(b,"%");b=RString.removeChars(b,"-");if(!RString.isEmpty(b)){for(var h="",q=0,z=b.length;-1<z;z--)h=0!=z&&0!=q&&0==q%3?"'"+b.charAt(z)+h:b.charAt(z)+h,q++;-1!=d&&(h="-"+h);-1!=f&&(h+="%");return h}return b}
function FUiDataNumber4_removeSplit(b){b=RString.nvl(b);b=RString.removeChars(b,"'");return b=RString.removeChars(b,"%")}
function FUiDataNumber4_precisionValue(b){if(RString.isEmpty(b))return b;var d,f,h=RString.nvl(this.editPrecision);b=RString.nvl(b);RString.contains(h,".")?f=h.split(".")[1].length:d=h.length;if(RString.contains(b,"."))b=b.split("."),f&&(f>b[1].length?b[1]=RString.rpad(b[1],f-b[1].length,"0"):f<=b[1].length&&(b[1]=b[1].substring(0,f))),d&&(d>b[0].length?alert(d):d<b[0].length&&(b[0]=b[0].substring(0,b[0].length-d),b[0]=RString.rpad(b[0],d,"0")),b[1]=null),b=b[1]?b[0]+"."+RString.nvl(b[1]):b[0];else{if(d)if(d<=
b.length)for(b=b.substring(0,b.length-d+1),h=0;h<d-1;h++)b=b.concat("0");else d>b.length&&(b=0);if(f)for(b+=".",h=0;h<f;h++)b=b.concat("0")}return b}function FUiDataNumber4_dispose(){this.base.FUiNumber4.dispose.call(this);this.hChgIic=this.hDownIcon=this.hUpIcon=this.hLabel=null}function FUiDataSelect(b){return b=RClass.inherits(this,b,FUiSelect,MUiDataField)}
function FUiDataColumn(b){b=RClass.inherits(this,b,FControl,MDataField);b._displayList=!0;b._styleLabel=RClass.register(b,new AStyle("_styleLabel"));b._styleSearchPanel=RClass.register(b,new AStyle("_styleSearchPanel"));b._styleSearchEdit=RClass.register(b,new AStyle("_styleSearchEdit"));b._styleIconSortUp=RClass.register(b,new AStyleIcon("_styleIconSortUp"));b._styleIconSortDown=RClass.register(b,new AStyleIcon("_styleIconSortDown"));b._cellClass=FCell;b._hForm=null;b._hFormLine=null;b._hIconPanel=
null;b._hIcon=null;b._hLabel=null;b._hSortPanel=null;b._hSortUp=null;b._hSortDown=null;b._hSearchEditPanel=null;b._hSearchEdit=null;b.onBuildLabel=FUiDataColumn_onBuildLabel;b.onBuildSearchIcon=RMethod.empty;b.onBuildSearchEdit=FUiDataColumn_onBuildSearchEdit;b.onBuildSearchDrop=RMethod.empty;b.onBuildSearchForm=FUiDataColumn_onBuildSearchForm;b.onBuildSearch=FUiDataColumn_onBuildSearch;b.onBuildTotal=FUiDataColumn_onBuildTotal;b.onBuildPanel=FUiDataColumn_onBuildPanel;b.onBuild=FUiDataColumn_onBuild;
b.onSearchEnter=RClass.register(b,new AEventMouseEnter("onSearchEnter"));b.onSearchClick=RClass.register(b,new AEventClick("onSearchClick"));b.onSearchLeave=RClass.register(b,new AEventMouseLeave("onSearchLeave"));b.onSearchKeyDown=RClass.register(b,new AEventKeyDown("onSearchKeyDown"));b.createCell=FUiDataColumn_createCell;return b}
function FUiDataColumn_onBuildLabel(b){b=this._hFormLine;if(this._icon){var d=this._hIconPanel=RBuilder.appendTableCell(b);this._hIcon=RBuilder.appendIcon(d,this.icon)}(this._hLabel=RBuilder.appendTableCell(b)).innerHTML=RString.nvl(this.label());b=this._hSortPanel=RBuilder.appendTableCell(b);d=this._hSortUp=RBuilder.appendIcon(b,this.styleIcon("SortUp",FUiDataColumn));d.style.display="none";d=this._hSortDown=RBuilder.appendIcon(b,this.styleIcon("SortDown",FUiDataColumn));d.style.display="none"}
function FUiDataColumn_onBuildSearchEdit(b){b=this._hSearchEditPanel=RBuilder.appendTableCell(this._hSearchFormLine,this.styleName("SearchPanel"));this._hSearchEdit=RBuilder.appendEdit(b,this.styleName("SearchEdit"))}
function FUiDataColumn_onBuildSearchForm(b){b=this._hSearchForm=RBuilder.appendTable(this._hSearchPanel);b.width="100%";b.style.backgroundColor="#FFFFFF";this._hSearchFormLine=b.insertRow();RClass.isClass(this,FUiDataColumnButton)?(this._hSearchPanel.style.backgroundColor="#EEEFF1",this._hSearchPanel.style.borderLeft="1 solid #808080",this._hSearchPanel.style.borderTop="1 solid #808080",this._hSearchPanel.style.borderBottom="1 solid #9EC4EB"):(this.onBuildSearchIcon(),this.onBuildSearchEdit(),this.onBuildSearchDrop())}
function FUiDataColumn_onBuildSearch(b){var d=this._hSearchPanel=RBuilder.create(b,"TD",this.styleName("SearchPanel"));d.style.backgroundColor="#FFFFFF";d.style.borderBottom="1 solid #9EC4EB";RHtml.linkSet(d,"control",this);this.attachEvent("onSearchEnter",d);this.attachEvent("onSearchLeave",d);this.onBuildSearchForm(b)}
function FUiDataColumn_onBuildTotal(b){b=this._hTotalPanel=RBuilder.create(b,"TD");RHtml.linkSet(b,"control",this);b.align="right";b.style.color="#686860";b.style.backgroundColor="#F8F8F0";b.style.borderBottom="1 solid #B8B8B0";b.innerText=" "}function FUiDataColumn_onBuildPanel(b){this._hPanel=RBuilder.create(b,"TD",this.styleName("Label"))}
function FUiDataColumn_onBuild(b){this._absEdit=this._editInsert||this._editUpdate||this._editDelete;this._absEdit||(RString.isEmpty(this._lovReference)?this._hasDropArea=!1:this._hasDropArea=!0);if(!RString.isEmpty(this._viewIcons)){var d=this.iconMap=new TAttributes;d.split(this._viewIcons.replace(/\n/g,";"),"=",";");this.hasIconArea=0<d.count}this.__base.FControl.onBuild.call(this,b);d=this._hPanel;d.style.padding=4;d=this._hForm=RBuilder.appendTable(d);this._orderAble||(d.style.cursor="hand");
this._hFormLine=RBuilder.appendTableRow(this._hForm);this.onBuildLabel(b);this.onBuildSearch(b);this.onBuildTotal(b);b=this._hFixPanel=RBuilder.create(b,"TD");b.height=1;b.bgColor="#FFFFFF";40>this._size.width&&(this._size.width=40);RHtml.setSize(b,this._size);this._hPanel.style.pixelWidth=this.width;this._hFixPanel.style.pixelWidth=this.width}
function FUiDataColumn_createCell(b){b=RClass.create(this._cellClass);var d=b._table=this._table;b._name=this._name;b._column=this;b.build(d._hPanel);b.setVisible(this._displayList);return b}function FUiDataColumn_onCellMouseEnter(b,d){this.table.hoverRow(b.row,!0)}function FUiDataColumn_onCellMouseLeave(b,d){this.table.hoverRow(b.row,!1)}
function FUiDataColumn_onCellMouseDown(b,d){var f=b.table,h=b.row;f.__focusCell=b;f.selectRow(h,!d.ctrlKey,!0);f=RConsole.find(FFocusConsole).focusControl;RClass.isClass(f,FDropEditor)&&f.source==b||RConsole.find(FFocusConsole).focus(b)}function FUiDataColumn_onCellClick(b,d){this.table.clickRow(b.row)}function FUiDataColumn_onCellDoubleClick(b,d){var f=b.row;this.isEditAble(f)||this.table.doubleClickRow(f)}function FUiDataColumn_onCellKeyDown(b,d,f){if(f)this.table.onCellKeyDown(b,d,f)}
function FUiDataColumn_oeMode(b){if(b.isAfter()){var d=!1;this.inModeDisplay=d=EAction.Design==b.mode?this.dispDesign:this._displayList;this.setVisible(d)}return EEventStatus.Continue}function FUiDataColumn_oeRefresh(b){b.isBefore()&&this.setVisible(this._displayList)}function FUiDataColumn_onDataKeyDown(b,d){this.__base.MEditDescriptor.onDataKeyDown.call(this,b,d)}function FUiDataColumn_onDataChanged(b,d){this.table.setDataStatus(b.row,EDataStatus.Update)}
function FUiDataColumn_onEditBegin(b){var d=b.row;this.editor=b;this.table.editRow=d;this.table.editColumn=this;this.table.select(d,!0);RLogger.debug(this,"Edit begin (column={1} row={2} editor={3})",this.name,RClass.dump(d),RClass.dump(b))}
function FUiDataColumn_onEditEnd(b){b=editor.row;var d=editor.text();this.setValue(b,this.formatValue(d));this.setText(b,d);this.table.setDataStatus(b,b.isChanged()?EDataStatus.Update:EDataStatus.Unknown);this.editor=null;RLogger.debug(this,"{1}={2}\n{3}\n{4}",RClass.dump(editor),this.formatValue(d),this.dump(),b.dump())}function FUiDataColumn_onEditChanged(b){b.row.refresh()}
function FUiDataColumn_onHeadMouseDown(b){var d=this.table,f=d.dsViewer.count,h=b.x;if(!RClass.isClass(this,FUiDataColumnButton)){var q=this._hPanel.offsetWidth-6;if(0<h&&h<q&&0<f&&!RClass.isClass(b.source,FUiDataColumnStatus)){f=d.columns;h=f.count;for(b=0;b<h;b++)q=f.value(b),q._hSortUp.style.display="none",q._hSortDown.style.display="none";d.dsOrders.clear();f=new TOrderItem;b=this.dataName;this.sortType?(f.set(b,EOrder.Desc),this._hSortUp.style.display="none",this._hSortDown.style.display="block"):
(this._hSortUp.style.display="block",this._hSortDown.style.display="none",f.set(b,EOrder.Asc));this.sortType=!this.sortType;d.dsOrders.push(f);d.dsSearch()}}}function FUiDataColumn_onRowClick(b,d){RConsole.find(FListenerConsole).process(FGridControl,EGridAction.RowClick,b.row,b.row)}
function FUiDataColumn_createMoveable(b){b=this.cloneMove;b||(b=RClass.create(this.constructor),b.buildMode=EColumnMode.Drag,b.assign(this,EAssign.Property),b.build(),this.cloneMove=b);var d=this.panel(EPanel.Move),f=b.panel(EPanel.Move);RHtml.setPixelRect(f,RHtml.rect(d));f.className=b.styleName("DesignMove");f.style.pixelLeft=d.offsetLeft;b.show();return b}function FUiDataColumn_searchValue(){if(this._hSearchEdit)return this._hSearchEdit.value}
function FUiDataColumn_setStyleStatus(b,d){var f=this.cell(b);if(f)switch(f=f.style,d){case EStyle.Normal:b.isDelete()?f.backgroundColor=EColor.Delete:this.isEditAble(b)?f.backgroundColor=EColor.Edit:f.backgroundColor=EColor.Readonly;break;case EStyle.Select:b.isDelete()?f.backgroundColor=EColor.Select:(f.textDecoration="none",this.isEditAble(b)?f.backgroundColor=EColor.RowEditSelect:f.backgroundColor=EColor.Select);break;case EStyle.Delete:f.textDecoration="line-through",f.backgroundColor=EColor.Select}}
function FUiDataColumn_cell(b){return b.cell(this.index)}function FUiDataColumn_equalsValue(b,d){return RString.nvl(b).replace(/\n/g,"\\n").replace(/\r/g,"\\r")==RString.nvl(d).replace(/\n/g,"\\n").replace(/\r/g,"\\r")}function FUiDataColumn_setWidth(b){this._hPanel.style.pixelWidth=b;this._hFixPanel.style.pixelWidth=b}
function FUiDataColumn_setVisible(b){b=(this.isDisplay=b)?"block":"none";this._hPanel.style.display=b;this._hSearchPanel.style.display=b;this._hTotalPanel.style.display=b;this._hFixPanel.style.display=b}
function FUiDataColumn_moveCellFocus(b,d){var f=this.table,h=null,q=null,z=null;if(EPosition.Top==d)h=this,(q=f.rows.get(f.rows.indexOf(b)-1))&&(z=q.cell(h.index));else if(EPosition.Bottom==d)h=this,(q=f.rows.get(f.rows.indexOf(b)+1))&&(z=q.cell(h.index));else if(EPosition.Before==d)for(var A=this.index-1,B=f.rows.indexOf(b);0<=B;B--){for(var C=f.rows.get(B);0<=A;A--){var D=f.columns.value(A);if(RClass.isClass(D,FUiDataColumn)&&D._displayList){h=D;q=C;z=q.cell(h.index);break}}if(h)break;A=f.columns.count-
1}else if(EPosition.After==d)for(var A=this.index+1,B=f.rows.indexOf(b),E=f.columns.count,F=f.rows.count;B<F;B++){for(C=f.rows.get(B);A<E;A++)if(D=f.columns.value(A),RClass.isClass(D,FUiDataColumn)&&D._displayList){h=D;q=C;z=q.cell(h.index);break}if(h)break;A=0}h&&q&&z&&(z.focus(!0),RConsole.find(FFocusConsole).focus(z))}function FUiDataColumn_getEditRange(){var b=this._hSearchPanel,d=RHtml.offsetPosition(b);return new TRange(d.x,d.y,b.offsetWidth,b.offsetHeight)}
function FUiDataColumn_dispose(){this.__base.FControl.dispose.call(this);RMemory.freeHtml(this._hSearchPanel);RMemory.freeHtml(this._hFixPanel);this._hFixPanel=this._hSearchDrop=this._hSearchDropPanel=this._hSearchEdit=this._hSearchEditPanel=this._hSearchIcon=this._hSearchIconPanel=this._hSearchFormLine=this._hSearchForm=this._hSearchPanel=this._hSortDown=this._hSortUp=this._hSortPanel=this._hLabel=this._hHeadPanel=this._hIcon=this._hIconPanel=this._hFormLine=this._hForm=null}
function FUiDataColumn_dump(b){b=RString.nvlStr(b);b.append(RClass.dump(this),"[");b.append("name=",this.name);b.appendIf(this.icon,",icon=",this.icon);b.appendIf(this.label,",label=",this.label);b.appendIf(this.align,",align=",this.align);b.appendIf(this.valign,",valign=",this.valign);b.appendIf(this.dataName,",dataName=",this.dataName);b.appendIf(this.dataDefault,",dataDefault=",this.dataDefault);b.appendIf(this.index,",index=",this.index);b.append("]");b.append(" [editAccess=");b.append(this.editInsert?
"I":"_");b.append(this.editUpdate?"U":"_");b.append("]");return b}function FUiDataToolBar(b){return b=RClass.inherits(this,b,FUiToolBar)}function FUiDataToolButton(b){b=RClass.inherits(this,b,FUiToolButton);b._serviceName=RClass.register(b,new APtyString("_serviceName"));return b}function FUiDataToolButton_click(){RLogger.debug(this,"Mouse button click. (label={1})"+this._label);this.processClickListener(this)}
function FUiDataToolButton_onShowHint(b){b.status=EActive.Finish;this.hintBox&&this.hintBox.show()}
function FUiDataTreeView(b){b=RClass.inherits(this,b,FUiTreeView);b._serviceCode=RClass.register(b,new APtyString("_serviceCode","service"));b._statusLoading=!1;b.lsnsLoaded=new TListeners;b.lsnsNodeLoad=new TListeners;b.lsnsNodeLoaded=new TListeners;b.onLoaded=FUiDataTreeView_onLoaded;b.onNodeLoaded=FUiDataTreeView_onNodeLoaded;b.construct=FUiDataTreeView_construct;b.innerBuildNode=FUiDataTreeView_innerBuildNode;b.loadNode=FUiDataTreeView_loadNode;b.loadUrl=FUiDataTreeView_loadUrl;b.loadService=
FUiDataTreeView_loadService;b.dispose=FUiDataTreeView_dispose;return b}function FUiDataTreeView_onLoaded(b){var d=b.root;if(null==d)throw new TError(this,"Load tree data failure.");d=d.find("TreeView");RUiControl.build(this,d,null,this._hPanel);this.lsnsLoaded.process(b);(b=d.get("service"))&&this.loadService(b)}
function FUiDataTreeView_onNodeLoaded(b){var d=b.root;if(!d)throw new TError(this,"Load tree data failure.");var f=b.connection.parentNode,h=this._loadingNode;h._hPanel.parentElement&&this._hNodeRows.removeChild(h._hPanel);this._statusLoading=!1;this.innerBuildNode(f,d);this.lsnsNodeLoaded.process(b)}function FUiDataTreeView_construct(){this.__base.FUiTreeView.construct.call(this)}
function FUiDataTreeView_innerBuildNode(b,d){var f=d._nodes;if(f)for(var h=f.count(),q=0;q<h;q++){var z=f.get(q);if(z.isName("TreeNode")){var A=this.createNode();A.loadConfig(z);b?b.push(A):this.push(A);this.appendNode(A,b);z.hasNode()&&(this.innerBuildNode(A,z),A.extend(!1))}}b&&b.calculateImage()}
function FUiDataTreeView_loadNode(b,d){this._statusLoading=!0;b.removeChildren();for(var f=null,h=b,q=this._serviceCode;RClass.isClass(h,FUiTreeNode);){if((f=h.type())&&f._service){q=f._service;break}h=h._parent}if(!q)throw new TError(this,"Unknown service code.");q=RUiService.parse(q);if(!q)throw new TError(this,"Unknown service.");for(h=b;RClass.isClass(B,FUiTreeNode)&&(!(f=h.type())||!f._action);)h=h._parent;var z=RString.nvl(f._action,q.action);if(!z)throw new TError(this,"Unknown service action.");
this.lsnsNodeLoad.process(this,b);var h=new TXmlDocument,A=h.root();A.set("action",z);A.set("type",f._linker);A.create("Attributes",this._attributes);for(var B=b;RClass.isClass(B,FUiTreeNode);)A=A.create("TreeNode"),B.propertySave(A),B=B._parent;b._extended=!0;b._child&&b._hImage&&(b._hImage.src=RResource.iconPath(this._iconMinus));f=this._loadingNode;B=b.searchLast()._hPanel.rowIndex;this._hNodeRows.appendChild(f._hPanel);RHtml.tableMoveRow(this._hNodeForm,f._hPanel.rowIndex,B+1);f.setLevel(b.level()+
1);q=RUiService.makeUrl(q.service,z);q=RConsole.find(FXmlConsole).sendAsync(q,h);q.parentNode=b;q.addLoadListener(this,this.onNodeLoaded)}function FUiDataTreeView_loadUrl(b,d){RConsole.find(FXmlConsole).sendAsync(b).addLoadListener(this,this.onLoaded)}
function FUiDataTreeView_loadService(b,d){this.clear();b||(b=this._serviceCode);var f=RUiService.parse(b);if(!f)return alert("Unknown service");d=RObject.nvl(d,this._attributes);var h=new TXmlDocument,q=h.root();q.set("action",f.action);RConsole.find(FUiEnvironmentConsole).build(q);d.isEmpty()||(RClass.isClass(d,TNode)&&xr.push(d),RClass.isClass(d,TAttributes)?(xr.create("Tree").attributes=d,xr.create("Attributes").attributes=d):(xr.create("Tree").value=d,xr.create("Attributes").value=d));this._focusNode=
null;RConsole.find(FXmlConsole).sendAsync(f.url,h).addLoadListener(this,this.onNodeLoaded)}function FUiDataTreeView_dispose(){this.__base.FUiTreeView.dispose.call(this)}function FUiDataTreeView_load(b){this.loadService(this._serviceCode)}function FUiDataTreeView_reload(){this.clear();this.loadUrl()}function FUiDataTreeView_loadNodeUrl(b,d){var f=RConsole.find(FXmlConsole).sendAsync(b);f.parentNode=RObject.nvl(d,this._focusNode);f.addLoadListener(this,this.onNodeLoaded)}
function FUiDataTreeView_reloadService(b,d){this.clear();return this.loadService(b,d)}
function FUiDataTreeView_loadNodeService(b,d){var f=RUiService.parse(RString.nvl(b,this._service));if(!f)throw new TError(this,"Unknown service.");var h=RObject.nvl(d,this._attributes),q=(new TXmlDocument).root();q.set("action",f.action);h.isEmpty()||(RClass.isClass(h,TNode)&&q.push(attrs),RClass.isClass(h,TAttributes));f=RConsole.find(FXmlConsole).sendAsync(f.url,q);f.parentNode=this._focusNode;f.addLoadListener(this,this.onNodeLoaded)}
function FUiDataTreeView_reloadNode(b){b=RObject.nvl(b,this._focusNode);if(!b)return this.reload();b.removeChildren();this.loadNode(b)}function FUiDataTreeView_onQueryLoaded(b){if((b=b.document)&&(b=b.root().find("TreeView"))&&b._nodes)for(var d=b._nodes.count,f=0;f<d;f++){var h=b._nodes.get(f);if(h.isName("TreeNode")){var q=h.get("name");(q=this.findByName(q))&&q.loadQuery(h)}}}
function FUiDataTreeView_doQuery(){var b=RUiService.parse(this._queryService);if(!b)return alert("Unknown query service");var d=new TXmlDocument,f=d.root();f.set("action",b.action);f.create("Attributes").attrs=this._attributes;f=new TEvent(this,EXmlEvent.Send,this.onQueryLoaded);f.url=b.url;f.document=d;RConsole.find(FXmlConsole).process(f)}
function FUiDataTreeView_fetchExtendsAll(b){b&&RClass.isClass(b,FUiTreeNode)&&(fmMain.target="frmMain",fmMain.form_search.value="",fmMain.form_order.value="",fmMain.form_values.value="",b=node.type.typeName,"table"==b||"form"==b?(fmMain.form_name.value=node.get("form"),fmMain.action=top.RContext.context("/ent/apl/logic/form/InnerForm.wa?do=update"),fmMain.submit()):"frameTree"==b&&(fmMain.action=top.RContext.context(node.get("redirect")),fmMain.submit()))}
var EDsCanvasDrag=new function(){this.Unknown=0;this.X=1;this.Y=2;this.Z=3;this.All=4;return this},EDsCanvasMode=new function(){this.Unknown=0;this.Drop=1;this.Select=2;this.Translate=3;this.Rotation=4;this.Scale=5;return this},EDsFrame=new function(){this.CommonSpacePropertyFrame="resource.common.property.SpaceFrame";this.CommonTechniquePropertyFrame="resource.common.property.TechniqueFrame";this.CommonRegionPropertyFrame="resource.common.property.RegionFrame";this.CommonCameraPropertyFrame="resource.common.property.CameraFrame";
this.CommonLightPropertyFrame="resource.common.property.LightFrame";this.CommonMaterialPropertyFrame="resource.common.property.MaterialFrame";this.CommonLayerPropertyFrame="resource.common.property.LayerFrame";this.CommonDisplayPropertyFrame="resource.common.property.DisplayFrame";this.CommonAnimationPropertyFrame="resource.common.property.AnimationFrame";this.CommonRenderablePropertyFrame="resource.common.property.RenderableFrame";this.SolutionProjectPropertyFrame="resource.solution.property.ProjectFrame";
this.ResourcePropertyFrame="resource.resource.property.SpaceFrame";this.BitmapPropertyFrame="resource.bitmap.property.Frame";this.MaterialPropertyFrame="resource.material.property.Frame";this.MeshSpacePropertyFrame="resource.mesh.property.SpaceFrame";this.MeshLayerPropertyFrame="resource.mesh.property.LayerFrame";this.MeshDisplayPropertyFrame="resource.mesh.property.DisplayFrame";this.MeshRenderablePropertyFrame="resource.mesh.property.RenderableFrame";this.ModelSpacePropertyFrame="resource.model.property.SpaceFrame";
this.ModelLayerPropertyFrame="resource.model.property.LayerFrame";this.ModelDisplayPropertyFrame="resource.model.property.DisplayFrame";this.ModelRenderablePropertyFrame="resource.model.property.RenderableFrame";this.SceneSpacePropertyFrame="resource.scene.property.SpaceFrame";this.SceneDisplayPropertyFrame="resource.scene.property.DisplayFrame";this.SceneMoviePropertyFrame="resource.scene.property.MovieFrame";this.SceneRenderablePropertyFrame="resource.scene.property.RenderableFrame";return this},
EDsFrameSet=new function(){this.PrivateSolutionFrameSet="resource.private.solution.FrameSet";this.PrivateProjectFrameSet="resource.private.project.FrameSet";this.PrivateResourceFrameSet="resource.private.resource.FrameSet";this.PrivateBitmapFrameSet="resource.private.bitmap.FrameSet";this.PrivateMaterialFrameSet="resource.private.material.FrameSet";this.PrivateModelFrameSet="resource.private.model.FrameSet";this.PrivateTemplateFrameSet="resource.private.template.FrameSet";this.PrivateSceneFrameSet=
"resource.private.scene.FrameSet";this.ShareResourceFrameSet="resource.share.resource.FrameSet";this.ShareBitmapFrameSet="resource.share.bitmap.FrameSet";this.ShareMaterialFrameSet="resource.share.material.FrameSet";this.ShareModelFrameSet="resource.share.model.FrameSet";this.ShareTemplateFrameSet="resource.share.template.FrameSet";this.ShareSceneFrameSet="resource.share.scene.FrameSet";return this};
function MDsBoundBox(b){b=RClass.inherits(this,b);b._boundVisible=!1;b._boundBox=null;b.boundBox=MDsBoundBox_boundBox;b.showBoundBox=MDsBoundBox_showBoundBox;b.hideBoundBox=MDsBoundBox_hideBoundBox;return b}function MDsBoundBox_boundBox(){var b=this._boundBox;b||(b=this._boundBox=RClass.create(FE3dBoundBox),b.linkGraphicContext(this),b._drawable=this,b._parent=this,b.setup());return b}
function MDsBoundBox_showBoundBox(){var b=this.boundBox(),d=this.resource().mesh().outline();b.outline().assign(d);b.upload();this._boundVisible=!0}function MDsBoundBox_hideBoundBox(){this._boundVisible=!1}
function FDsApplication(b){b=RClass.inherits(this,b,FObject);b._name=null;b._matrix=null;b._location=null;b._rotation=null;b._scale=null;b._visible=!0;b._renderables=null;b.construct=FDsApplication_construct;b.isName=FDsApplication_isName;b.name=FDsApplication_name;b.matrix=FDsApplication_matrix;b.location=FDsApplication_location;b.rotation=FDsApplication_rotation;b.scale=FDsApplication_scale;b.hasRenderable=FDsApplication_hasRenderable;b.filterRenderables=FDsApplication_filterRenderables;b.renderables=
FDsApplication_renderables;b.pushRenderable=FDsApplication_pushRenderable;b.process=FDsApplication_process;b.update=FDsApplication_update;b.dispose=FDsApplication_dispose;return b}function FDsApplication_construct(){this.__base.FObject.construct.call(this);this._matrix=new SMatrix3d;this._location=new SPoint3;this._rotation=new SVector3;this._scale=new SVector3;this._scale.set(1,1,1)}function FDsApplication_isName(b){return this._name==b}function FDsApplication_name(){return this._name}
function FDsApplication_matrix(){return this._matrix}function FDsApplication_location(){return this._location}function FDsApplication_rotation(){return this._rotation}function FDsApplication_scale(){return this._scale}function FDsApplication_hasRenderable(){var b=this._renderables;return null!=b?!b.isEmpty():!1}
function FDsApplication_filterRenderables(b){if(!this._visible)return!1;var d=this._renderables;if(null!=d)for(var f=d.count(),h=0;h<f;h++){var q=d.get(h);q.testVisible()&&b.pushRenderable(q)}return!0}function FDsApplication_renderables(){var b=this._renderables;null==b&&(b=this._renderables=new TObjects);return b}function FDsApplication_pushRenderable(b){this.renderables().push(b)}function FDsApplication_update(){var b=this._matrix;b.set(this._location,this._rotation,this._scale);b.update()}
function FDsApplication_process(){var b=this._renderables;if(null!=b)for(var d=b.count(),f=0;f<d;f++)b.get(f).process()}function FDsApplication_dispose(){this._scale=this._direction=this._position=this._matrix=null;var b=this._renderables;null!=b&&(b.dispose(),this._renderables=null);this.__base.FObject.dispose.call(this)}
function FDsBitmapCanvas(b){b=RClass.inherits(this,b,FDsCanvas);b._activeBitmap=null;b._capturePosition=null;b._captureMatrix=null;b._templateMatrix=null;b._templateRenderable=null;b._templateFace=null;b._templateTranslation=null;b._templateRotation=null;b._templateScale=null;b._templateViewScale=.05;b.onBuild=FDsBitmapCanvas_onBuild;b.onMouseCaptureStart=FDsBitmapCanvas_onMouseCaptureStart;b.onMouseCapture=FDsBitmapCanvas_onMouseCapture;b.onMouseCaptureStop=FDsBitmapCanvas_onMouseCaptureStop;b.onMouseWheel=
FDsBitmapCanvas_onMouseWheel;b.onLoaded=FDsBitmapCanvas_onLoaded;b.oeResize=FDsBitmapCanvas_oeResize;b.oeRefresh=FDsBitmapCanvas_oeRefresh;b.construct=FDsBitmapCanvas_construct;b.loadByGuid=FDsBitmapCanvas_loadByGuid;b.dispose=FDsBitmapCanvas_dispose;return b}
function FDsBitmapCanvas_onBuild(b){this.__base.FDsCanvas.onBuild.call(this,b);b=this._hPanel;var d=this._activeSpace=RClass.create(FE3dFlatStage);d.linkGraphicContext(this);d.selectTechnique(this,FE3dGeneralTechnique);d.region().backgroundColor().set(1,1,1,1);d.region().linkGraphicContext(this);RStage.register("space.bitmap",d);d=d.camera();d.setPosition(0,0,-10);d.lookAt(0,0,0);d.update();d=d.projection();d._angle=45;d.size().set(b.width,b.height);d.update();RWindow.lsnsMouseWheel.register(this,
this.onMouseWheel)}function FDsBitmapCanvas_onMouseCaptureStart(b){if(this._activeSpace){var d=this._activeBitmap;d&&(this._capturePosition.set(b.clientX,b.clientY),this._captureMatrix.assign(d.matrix()),RHtml.cursorSet(this._hPanel,EUiCursor.Pointer))}}
function FDsBitmapCanvas_onMouseCapture(b){if(this._activeSpace){var d=this._activeBitmap;if(d){var d=d.matrix(),f=b.clientY-this._capturePosition.y,h=this._captureMatrix;d.tx=h.tx+(b.clientX-this._capturePosition.x);d.ty=h.ty+f;d.updateForce()}}}function FDsBitmapCanvas_onMouseCaptureStop(b){RHtml.cursorSet(this._hPanel,EUiCursor.Auto)}
function FDsBitmapCanvas_onMouseWheel(b){var d=this._activeBitmap;if(d){var f=1;0>b.deltaY?f=1.1:0<b.deltaY&&(f=.9);b=d.matrix();b.sx*=f;b.sy*=f;b.updateForce()}}function FDsBitmapCanvas_onLoaded(b){RConsole.find(FUiDesktopConsole).hide()}function FDsBitmapCanvas_oeResize(b){this.__base.FDsCanvas.oeResize.call(this,b);return EEventStatus.Stop}function FDsBitmapCanvas_oeRefresh(b){return EEventStatus.Stop}
function FDsBitmapCanvas_construct(){this.__base.FDsCanvas.construct.call(this);this._captureMatrix=new SMatrix3d}
function FDsBitmapCanvas_loadByGuid(b){var d=this._graphicContext.size();RConsole.find(FUiDesktopConsole).showLoading();var f=this._activeResource=RConsole.find(FDrBitmapConsole).query(b),h="/cloud.resource.bitmap.wv?do=view&guid="+b;b=this._activeBitmap=RClass.create(FE3dBitmap);b.linkGraphicContext(this);b.setup();b.material().info().effectCode="flat";b.addLoadListener(this,this.onLoaded);b.loadUrl(h);var h=b.matrix(),q=Math.max((d.width-f.sizeWidth())/2,0),d=Math.max((d.height-f.sizeHeight())/
2,0);h.setTranslate(q,d);h.setScale(f.sizeWidth(),f.sizeHeight());h.update();f=this._activeSpace.layer();f.clearRenderables();f.pushRenderable(b)}function FDsBitmapCanvas_dispose(){this.__base.FDsCanvas.dispose.call(this)}
function FDsCanvas(b){b=RClass.inherits(this,b,FUiCanvas,MGraphicObject,MListenerLoad,MMouseCapture);b._servicePreview="cloud.resource.preview";b._resourceTypeCd=null;b._optionRotation=!1;b._activeSpace=null;b._canvasModeCd=EDsCanvasMode.Drop;b._canvasMoveCd=EDsCanvasDrag.Unknown;b._switchWidth="*";b._switchHeight="*";b._capturePosition=null;b._captureMatrix=null;b._captureRotation=null;b._cameraMoveRate=8;b._cameraKeyRotation=3;b._cameraMouseRotation=.005;b._dimensional=null;b._rotation=null;b.onBuild=
FDsCanvas_onBuild;b.onMouseCaptureStart=FDsCanvas_onMouseCaptureStart;b.onMouseCapture=FDsCanvas_onMouseCapture;b.onMouseCaptureStop=FDsCanvas_onMouseCaptureStop;b.onEnterFrame=FDsCanvas_onEnterFrame;b.oeResize=FDsCanvas_oeResize;b.oeRefresh=FDsCanvas_oeRefresh;b.construct=FDsCanvas_construct;b.activeSpace=FDsCanvas_activeSpace;b.switchSize=FDsCanvas_switchSize;b.switchRotation=FDsCanvas_switchRotation;b.reloadRegion=FDsCanvas_reloadRegion;b.capture=FDsCanvas_capture;b.dispose=FDsCanvas_dispose;return b}
function FDsCanvas_onBuild(b){this.__base.FUiCanvas.onBuild.call(this,b);b=this._hPanel;b.__linker=this;b.style.width="100%";b.style.height="100%";b=this._graphicContext=REngine3d.createContext(FWglContext,b,{alpha:!1,antialias:!0});var d=this._dimensional=RClass.create(FE3dDimensional);d.linkGraphicContext(b);d.setup();RStage.lsnsEnterFrame.register(this,this.onEnterFrame);RStage.start(1E3/60);RConsole.find(FMouseConsole).register(this)}
function FDsCanvas_onMouseCaptureStart(b){var d=this._activeSpace;d&&(d=d.camera(),this._capturePosition.set(b.clientX,b.clientY),this._captureRotation.assign(d._rotation),RHtml.cursorSet(this._hPanel,EUiCursor.Pointer))}
function FDsCanvas_onMouseCapture(b){var d=this._activeSpace;if(d){var f=d.camera(),d=b.clientX-this._capturePosition.x;b=b.clientY-this._capturePosition.y;switch(this._frameSet._canvasToolBar._canvasModeCd){case EDsCanvasMode.Drop:var f=f.rotation(),h=this._captureRotation;f.x=h.x-b*this._cameraMouseRotation;f.y=h.y-d*this._cameraMouseRotation}}}function FDsCanvas_onMouseCaptureStop(b){RHtml.cursorSet(this._hPanel,EUiCursor.Auto)}
function FDsCanvas_onEnterFrame(){var b=this._activeSpace;if(b){var d=b.camera(),f=b.timer().spanSecond(),h=this._cameraMoveRate*f,f=this._cameraKeyRotation*f,q=RKeyboard.isPress(EStageKey.Forward),z=RKeyboard.isPress(EStageKey.Back);q&&!z&&d.doWalk(h);!q&&z&&d.doWalk(-h);z=RKeyboard.isPress(EStageKey.Up);q=RKeyboard.isPress(EStageKey.Down);z&&!q&&d.doFly(h);!z&&q&&d.doFly(-h);h=RKeyboard.isPress(EStageKey.RotationLeft);q=RKeyboard.isPress(EStageKey.RotationRight);h&&!q&&d.doYaw(f);!h&&q&&d.doYaw(-f);
h=RKeyboard.isPress(EStageKey.RotationUp);q=RKeyboard.isPress(EStageKey.RotationDown);h&&!q&&d.doPitch(f);!h&&q&&d.doPitch(-f);d.update();if(this._optionRotation){d=this._rotation;b=b.layers();f=b.count();for(h=0;h<f;h++)q=b.at(h).matrix(),q.setRotation(0,d.y,0),q.update();d.y+=.01}}}
function FDsCanvas_oeResize(b){this.__base.FUiCanvas.oeResize.call(this,b);b=this._hPanel;var d=b.offsetWidth,f=b.offsetHeight-6;b.width=d;b.height=f;this._graphicContext.setViewport(0,0,d,f);return EEventStatus.Stop}function FDsCanvas_oeRefresh(b){return EEventStatus.Stop}function FDsCanvas_construct(){this.__base.FUiCanvas.construct.call(this);this._capturePosition=new SPoint2;this._captureMatrix=new SMatrix3d;this._rotation=new SVector3;this._captureRotation=new SVector3}
function FDsCanvas_activeSpace(){return this._activeSpace}function FDsCanvas_switchSize(b,d){this._switchWidth=b;this._switchHeight=d;var f=this._hPanel,h=this._hParent;"*"==b&&(b=h.offsetWidth);"*"==d&&(d=h.offsetHeight);f.width=b;f.style.width=b+"px";f.height=d;f.style.height=d+"px";this._graphicContext.setViewport(0,0,b,d);if(f=this._activeSpace)f=f.camera().projection(),f.size().set(b,d),f.update()}function FDsCanvas_switchRotation(b){this._optionRotation=b}
function FDsCanvas_reloadRegion(){var b=this._activeSpace.region().resource();this._cameraMoveRate=b.moveSpeed();this._cameraKeyRotation=b.rotationKeySpeed();this._cameraMouseRotation=b.rotationMouseSpeed()}
function FDsCanvas_capture(){var b=this._activeSpace.resource().guid(),d=this._switchWidth,f=this._switchHeight;this.switchSize(200,150);RStage.process();var h=this._graphicContext,q=h.size(),z=q.width,q=q.height,h=h.readPixels(0,0,z,q);this.switchSize(d,f);RStage.process();b="/"+this._servicePreview+".wv?do=upload&type_cd="+this._resourceTypeCd+"&guid="+b+"&width="+z+"&height="+q;return RConsole.find(FHttpConsole).send(b,h.buffer)}
function FDsCanvas_dispose(){this._rotation=RObject.dispose(this._rotation);this.__base.FUiCanvas.dispose.call(this)}
function FDsCatalog(b){b=RClass.inherits(this,b,FUiDataTreeView,MListenerSelected);b._iconView="resource.scene.view";b._iconViewNot="resource.scene.viewno";b._displayNodes=null;b._renderableNodes=null;b._materialNodes=null;b.onBuild=FDsCatalog_onBuild;b.onLoadDisplay=FDsCatalog_onLoadDisplay;b.onNodeClick=FDsCatalog_onNodeClick;b.onNodeViewClick=FDsCatalog_onNodeViewClick;b.onNodeViewDoubleClick=FDsCatalog_onNodeViewDoubleClick;b.construct=FDsCatalog_construct;b.buildNodeView=FDsCatalog_buildNodeView;
b.buildTechnique=FDsCatalog_buildTechnique;b.buildRegion=FDsCatalog_buildRegion;b.buildRenderable=FDsCatalog_buildRenderable;b.buildDisplay=FDsCatalog_buildDisplay;b.buildLayer=FDsCatalog_buildLayer;b.buildSpace=FDsCatalog_buildSpace;b.selectObject=FDsCatalog_selectObject;b.showObject=FDsCatalog_showObject;b.dispose=FDsCatalog_dispose;return b}function FDsCatalog_onBuild(b){this.__base.FUiDataTreeView.onBuild.call(this,b);this.lsnsClick.register(this,this.onNodeClick)}
function FDsCatalog_onLoadDisplay(b){this.buildRenderable(b._linkNode,b)}function FDsCatalog_onNodeClick(b,d){var f=d.dataPropertyGet("linker");f&&this.selectObject(f)}
function FDsCatalog_onNodeViewClick(b){var d=b.treeNodeCell,f=b.treeNode.dataPropertyGet("linker");if(RClass.isClass(f,FDisplay))if(b.ctrlKey){for(var h=this._displayNodes,q=h.count(),z=0;z<q;z++){var A=h.at(z);A.dataPropertyGet("linker")._visible=!1;A.cell("view").setIcon(this._iconViewNot)}f.setVisible(!0);d.setIcon(this._iconView)}else f.setVisible(!f.visible()),d.setIcon(f.visible()?this._iconView:this._iconViewNot);if(RClass.isClass(f,FDrawable))if(b.ctrlKey){h=this._renderableNodes;q=h.count();
for(z=0;z<q;z++)A=h.at(z),A.dataPropertyGet("linker")._visible=!1,A.cell("view").setIcon(this._iconViewNot);f.setVisible(!0);d.setIcon(this._iconView)}else f.setVisible(!f.visible()),d.setIcon(f.visible()?this._iconView:this._iconViewNot);if(RClass.isClass(f,FG3dMaterial))if(b.ctrlKey){b=this._materialNodes;h=b.count();for(z=0;z<h;z++)q=b.at(z),q.dataPropertyGet("linker").setVisible(!1),q.cell("view").setIcon(this._iconViewNot);f.setVisible(!0);d.setIcon(this._iconView)}else f.setVisible(!f.visible()),
d.setIcon(f.visible()?this._iconView:this._iconViewNot)}
function FDsCatalog_onNodeViewDoubleClick(b){var d=b.treeNode.dataPropertyGet("linker");if(RClass.isClass(d,FDisplay)){var f=this._displayNodes,h=f.count();for(b=0;b<h;b++){var q=f.at(b);q.dataPropertyGet("linker").setVisible(!0);q.cell("view").setIcon(this._iconView)}}if(RClass.isClass(d,FDrawable))for(f=this._renderableNodes,h=f.count(),b=0;b<h;b++)q=f.at(b),q.dataPropertyGet("linker").setVisible(!0),q.cell("view").setIcon(this._iconView);if(RClass.isClass(d,FG3dMaterial))for(d=this._materialNodes,
f=d.count(),b=0;b<f;b++)h=d.at(b),h.dataPropertyGet("linker").setVisible(!0),h.cell("view").setIcon(this._iconView)}function FDsCatalog_construct(){this.__base.FUiDataTreeView.construct.call(this);this._displayNodes=new TObjects;this._renderableNodes=new TObjects;this._materialNodes=new TObjects}function FDsCatalog_buildNodeView(b,d){var f=b.cell("view");f.setIcon(this._iconView);f.addClickListener(this,this.onNodeViewClick);f.addDoubleClickListener(this,this.onNodeViewDoubleClick)}
function FDsCatalog_buildTechnique(b,d){var f=this.createNode();f.setTypeCode("technique");f.setLabel("Technique");f.dataPropertySet("linker",d);b.appendNode(f)}
function FDsCatalog_buildRegion(b,d){var f=this.createNode();f.setTypeCode("Region");f.setLabel("Region");f.dataPropertySet("linker",d);b.appendNode(f);var h=this.createNode();h.setTypeCode("Camera");h.setLabel("Camera");h.dataPropertySet("linker",d.camera());f.appendNode(h);h=this.createNode();h.setTypeCode("Light");h.setLabel("Light");h.dataPropertySet("linker",d.directionalLight());f.appendNode(h)}
function FDsCatalog_buildRenderable(b,d){var f=d.materials();if(f)for(var h=f.count(),q=0;q<h;q++){var z=f.value(q),A=z.resource(),B=this.createNode();B.setLabel(A.code());B.setNote(A.label());B.setTypeCode("material");B.dataPropertySet("linker",z);this.buildNodeView(B,!0);this._materialNodes.push(B);b.appendNode(B)}if(f=d.animations())for(h=f.count(),q=0;q<h;q++)z=f.value(q),A=z.resource(),B=this.createNode(),B.setLabel(A.code()),B.setNote(A.label()),B.setTypeCode("animation"),B.dataPropertySet("linker",
z),this.buildNodeView(B,!0),b.appendNode(B);if(f=d.meshRenderables())for(h=f.count(),q=0;q<h;q++)z=f.get(q),B=z.resource(),B.model(),A=B.mesh(),B=this.createNode(),B.setLabel(A.code()),B.setTypeCode("renderable"),B.dataPropertySet("linker",z),this.buildNodeView(B,!0),this._renderableNodes.push(B),b.appendNode(B)}
function FDsCatalog_buildDisplay(b,d){var f=d.displays();if(f)for(var h=f.count(),q=0;q<h;q++){var z=f.get(q),A=z.resourceScene(),B=this.createNode();B.setLabel(A.code());B.setNote(A.label());B.setTypeCode("display");B.dataPropertySet("linker",z);this.buildNodeView(B,!0);this._displayNodes.push(B);b.appendNode(B);z.addLoadListener(this,this.onLoadDisplay);z._linkNode=B}}
function FDsCatalog_buildLayer(b,d){var f=this.createNode();f.setLabel("Layers");f.setTypeCode("layers");f.dataPropertySet("linker","layers");this.buildNodeView(f,!0);b.appendNode(f);for(var h=d.layers(),q=h.count(),z=0;z<q;z++){var A=h.value(z);if(!RClass.isClass(A,FDisplayUiLayer)){var B=A.resource(),C=this.createNode();C.setLabel("Layer:"+B.code());C.setTypeCode("layer");C.dataPropertySet("linker",A);this.buildNodeView(C,!0);f.appendNode(C);this.buildDisplay(C,A)}}}
function FDsCatalog_buildSpace(b){var d=b._resource,f=this.createNode();f.setLabel(d.code());f.setNote(d.label());f.setTypeCode("scene");f.dataPropertySet("linker",b);this.appendNode(f);this.buildTechnique(f,b.technique());this.buildRegion(f,b.region());this.buildLayer(f,b);f.click()}function FDsCatalog_selectObject(b){b&&this.processSelectedListener(b,!0)}
function FDsCatalog_showObject(b){if(RClass.isClass(b,FDsSceneRenderable))for(var d=this._renderableNodes,f=d.count(),h=0;h<f;h++)d.at(h).dataPropertyGet("linker")==b&&this.processSelectedListener(b,!1)}function FDsCatalog_dispose(){this._displayNodes=RObject.dispose(this._displayNodes);this._renderableNodes=RObject.dispose(this._renderableNodes);this._materialNodes=RObject.dispose(this._materialNodes);this.__base.FUiDataTreeView.dispose.call(this)}
function FDsFrameSet(b){b=RClass.inherits(this,b,FUiFrameSet);b._styleToolBarGround=RClass.register(b,new AStyle("_styleToolBarGround","ToolBar_Ground"));b._styleCatalogContent=RClass.register(b,new AStyle("_styleCatalogContent","Catalog_Content"));b._styleCanvasContent=RClass.register(b,new AStyle("_styleCanvasContent","Canvas_Content"));b._stylePropertyContent=RClass.register(b,new AStyle("_stylePropertyContent","Property_Content"));b._activeGuid=null;b._activeCode=null;b._activeSpace=null;b._propertyFrames=
null;b.construct=FDsFrameSet_construct;b.findPropertyFrame=FDsFrameSet_findPropertyFrame;b.propertyFrames=FDsFrameSet_propertyFrames;b.hidePropertyFrames=FDsFrameSet_hidePropertyFrames;b.dispose=FDsFrameSet_dispose;return b}function FDsFrameSet_construct(){this.__base.FUiFrameSet.construct.call(this);this._propertyFrames=new TDictionary}
function FDsFrameSet_findPropertyFrame(b){var d=this._propertyFrames.get(b);d||(d=RConsole.find(FUiFrameConsole).get(this,b,this._framePropertyContent._hContainer),d._frameSet=this,this._propertyFrames.set(b,d));return d}function FDsFrameSet_propertyFrames(){return this._propertyFrames}function FDsFrameSet_hidePropertyFrames(){for(var b=this._propertyFrames,d=b.count(),f=0;f<d;f++)b.at(f).hide()}
function FDsFrameSet_dispose(){this._activeSpace=null;for(var b=this._propertyFrames,d=b.count(),f=0;f<d;f++)b.at(f).dispose();this._propertyFrames=RObject.dispose(this._propertyFrames);this.__base.FUiFrameSet.dispose.call(this)}
function FDsMainCanvas(b){b=RClass.inherits(this,b,FCanvas);b._context=null;b._stage=null;b._layer=null;b._activeModel=null;b._rotationX=0;b._rotationY=0;b._rotationZ=0;b.onBuild=FDsMainCanvas_onBuild;b.onEnterFrame=FDsMainCanvas_onEnterFrame;b.onThemeLoad=FDsMainCanvas_onThemeLoad;b.oeRefresh=FDsMainCanvas_oeRefresh;b.construct=FDsMainCanvas_construct;b.selectModel=FDsMainCanvas_selectModel;b.dispose=FDsMainCanvas_dispose;return b}
function FDsMainCanvas_onEnterFrame(){var b=this._activeModel;b&&(b.location().set(0,-6,0),b.rotation().set(0,this._rotationY,0),b.scale().set(2,2,2),b.update(),this._rotationX+=.01,this._rotationY+=.01,this._rotationZ+=.03)}
function FDsMainCanvas_onThemeLoad(){var b=this._hPanel;b.width=this._hParent.offsetWidth;b.height=this._hParent.offsetHeight;this._context=REngine3d.createContext(FWglContext,b);var d=this._stage=RClass.create(FSimpleStage3d);d.backgroundColor().set(.5,.5,.5,1);d.selectTechnique(this._context,FG3dGeneralTechnique);this._layer=this._stage.spriteLayer();RStage.register("stage3d",this._stage);d=this._stage.camera();d.setPosition(0,3,-20);d.lookAt(0,0,0);d.update();this._stage.directionalLight().direction().set(.7,
-.7,0);d=this._stage.camera().projection();d.size().set(b.width,b.height);d.update();RStage.lsnsEnterFrame.register(this,this.onEnterFrame);RStage.start()}function FDsMainCanvas_onBuild(b){this.__base.FCanvas.onBuild.call(this,b);RConsole.find(FE3sThemeConsole).select("color").loadListener().register(this,this.onThemeLoad)}function FDsMainCanvas_oeRefresh(b){this.__base.FCanvas.oeRefresh.call(this,b);return EEventStatus.Stop}
function FDsMainCanvas_construct(){this.__base.FCanvas.construct.call(this)}function FDsMainCanvas_selectModel(b){var d=RConsole.find(FModel3dConsole);null!=this._activeModel&&d.free(this._activeModel);b=d.alloc(this._context,b);this._layer.pushDisplay(b);this._activeModel=b}function FDsMainCanvas_dispose(){this.__base.FCanvas.dispose.call(this)}
function FDsMainCatalog(b){b=RClass.inherits(this,b,FDataTreeView);b.onBuild=FDsMainCatalog_onBuild;b.onNodeClick=FDsMainCatalog_onNodeClick;b.construct=FDsMainCatalog_construct;b.dispose=FDsMainCatalog_dispose;return b}function FDsMainCatalog_onBuild(b){this.__base.FDataTreeView.onBuild.call(this,b);this.lsnsClick.register(this,this.onNodeClick)}function FDsMainCatalog_onNodeClick(b,d){this._worksapce._canvas.selectModel(d.name())}
function FDsMainCatalog_construct(){this.__base.FDataTreeView.construct.call(this)}function FDsMainCatalog_dispose(){this.__base.FDataTreeView.dispose.call(this)}function FDsMainMenuBar(b){b=RClass.inherits(this,b,FMenuBar);b.onBuild=FDsMainMenuBar_onBuild;b.construct=FDsMainMenuBar_construct;b.dispose=FDsMainMenuBar_dispose;return b}
function FDsMainMenuBar_onBuild(b){this.__base.FMenuBar.onBuild.call(this,b);var d=this._framesetMain=RClass.create(FMenuButton);d.setLabel("\u6587\u4ef6");d.setIcon("design.menu.build");d.build(b);this.appendButton(d);d=this._framesetMain=RClass.create(FMenuButton);d.setLabel("\u4fdd\u5b58");d.setIcon("design.menu.save");d.build(b);this.appendButton(d);d=this._framesetMain=RClass.create(FMenuButton);d.setLabel("\u5e2e\u52a9");d.setIcon("design.menu.help");d.build(b);this.appendButton(d)}
function FDsMainMenuBar_construct(){this.__base.FMenuBar.construct.call(this)}function FDsMainMenuBar_dispose(){this.__base.FMenuBar.dispose.call(this)}function FDsMainToolBar(b){b=RClass.inherits(this,b,FToolBar);b.onPersistenceClick=FDsMainToolBar_onPersistenceClick;b.onBuild=FDsMainToolBar_onBuild;b.construct=FDsMainToolBar_construct;b.dispose=FDsMainToolBar_dispose;return b}
function FDsMainToolBar_onPersistenceClick(b){this._worksapce._catalog.loadUrl("/cloud.describe.tree.ws?action=query&code=resource3d.model")}
function FDsMainToolBar_onBuild(b){this.__base.FToolBar.onBuild.call(this,b);var d=this._persistenceButton=RClass.create(FToolButton);d.setLabel("\u6a21\u578b\u7ba1\u7406");d.build(b);d.lsnsClick.register(this,this.onPersistenceClick);this.appendButton(d);d=this._framesetMain=RClass.create(FToolButton);d.setLabel("\u6750\u8d28\u7ba1\u7406");d.build(b);this.appendButton(d);d=this._framesetMain=RClass.create(FToolButton);d.setLabel("\u6a21\u677f\u7ba1\u7406");d.build(b);this.appendButton(d);d=this._framesetMain=
RClass.create(FToolButton);d.setLabel("\u573a\u666f\u7ba1\u7406");d.build(b);this.appendButton(d)}function FDsMainToolBar_construct(){this.__base.FToolBar.construct.call(this)}function FDsMainToolBar_dispose(){this.__base.FToolBar.dispose.call(this)}
function FDsMainWindow(b){b=RClass.inherits(this,b,FObject);b._name=null;b._matrix=null;b._location=null;b._rotation=null;b._scale=null;b._visible=!0;b._renderables=null;b.construct=FDsMainWindow_construct;b.isName=FDsMainWindow_isName;b.name=FDsMainWindow_name;b.matrix=FDsMainWindow_matrix;b.location=FDsMainWindow_location;b.rotation=FDsMainWindow_rotation;b.scale=FDsMainWindow_scale;b.hasRenderable=FDsMainWindow_hasRenderable;b.filterRenderables=FDsMainWindow_filterRenderables;b.renderables=FDsMainWindow_renderables;
b.pushRenderable=FDsMainWindow_pushRenderable;b.process=FDsMainWindow_process;b.update=FDsMainWindow_update;b.dispose=FDsMainWindow_dispose;return b}function FDsMainWindow_construct(){this.__base.FObject.construct.call(this);this._matrix=new SMatrix3d;this._location=new SPoint3;this._rotation=new SVector3;this._scale=new SVector3;this._scale.set(1,1,1)}function FDsMainWindow_isName(b){return this._name==b}function FDsMainWindow_name(){return this._name}
function FDsMainWindow_matrix(){return this._matrix}function FDsMainWindow_location(){return this._location}function FDsMainWindow_rotation(){return this._rotation}function FDsMainWindow_scale(){return this._scale}function FDsMainWindow_hasRenderable(){var b=this._renderables;return null!=b?!b.isEmpty():!1}
function FDsMainWindow_filterRenderables(b){if(!this._visible)return!1;var d=this._renderables;if(null!=d)for(var f=d.count(),h=0;h<f;h++){var q=d.get(h);q.testVisible()&&b.pushRenderable(q)}return!0}function FDsMainWindow_renderables(){var b=this._renderables;null==b&&(b=this._renderables=new TObjects);return b}function FDsMainWindow_pushRenderable(b){this.renderables().push(b)}function FDsMainWindow_update(){var b=this._matrix;b.set(this._location,this._rotation,this._scale);b.update()}
function FDsMainWindow_process(){var b=this._renderables;if(null!=b)for(var d=b.count(),f=0;f<d;f++)b.get(f).process()}function FDsMainWindow_dispose(){this._scale=this._direction=this._position=this._matrix=null;var b=this._renderables;null!=b&&(b.dispose(),this._renderables=null);this.__base.FObject.dispose.call(this)}
function FDsMainWorkspace(b){b=RClass.inherits(this,b,FWorkspace);b._styleToolbarGround=RClass.register(b,new AStyle("_styleToolbarGround","Toolbar_Ground"));b._styleStatusbarGround=RClass.register(b,new AStyle("_styleStatusbarGround","Statusbar_Ground"));b._styleCatalogGround=RClass.register(b,new AStyle("_styleCatalogGround","Catalog_Ground"));b._styleWorkspaceGround=RClass.register(b,new AStyle("_styleWorkspaceGround","Workspace_Ground"));b._stylePropertyGround=RClass.register(b,new AStyle("_stylePropertyGround",
"Property_Ground"));b._framesetMain=null;b._framesetBody=null;b._frameToolBar=null;b._frameBody=null;b._frameProperty=null;b._frameCatalog=null;b._frameWorkspace=null;b._frameStatusBar=null;b.onBuild=FDsMainWorkspace_onBuild;b.construct=FDsMainWorkspace_construct;b.dispose=FDsMainWorkspace_dispose;return b}function FDsMainWorkspace_construct(){this.__base.FWorkspace.construct.call(this)}
function FDsMainWorkspace_onBuild(b){this.__base.FWorkspace.onBuild.call(this,b);this._hPanel.style.width="100%";this._hPanel.style.height="100%";var d=this._framesetMain=RClass.create(FFrameSet);d.build(b);var f=this._frameToolBar=RClass.create(FFrame);f.setHeight(26);f.build(b);f._hPanel.className=this.styleName("Toolbar_Ground");d.appendFrame(f);f=this._frameBody=RClass.create(FFrame);f.build(b);d.appendFrame(f);f=this._frameProperty=RClass.create(FFrame);f.setHeight(18);f.build(b);f._hPanel.className=
this.styleName("Statusbar_Ground");d.appendFrame(f);d.setPanel(this._hPanel);d=RClass.create(FFrameSet);d._directionCd=EDirection.Horizontal;d.build(b);f=this._frameCatalog=RClass.create(FFrame);f.setWidth(300);f.build(b);f._hPanel.className=this.styleName("Catalog_Ground");d.appendFrame(f);var h=d.appendSpliter(),f=this._frameWorkspace=RClass.create(FFrame);f.build(b);f._hPanel.className=this.styleName("Workspace_Ground");d.appendFrame(f);var q=d.appendSpliter(),f=this._frameStatusBar=RClass.create(FFrame);
f.setWidth(360);f.build(b);f._hPanel.className=this.styleName("Property_Ground");d.appendFrame(f);d.setPanel(this._frameBody._hPanel);h._alignCd=EAlign.Left;h._hSize=this._frameCatalog._hPanel;q._alignCd=EAlign.Right;q._hSize=this._frameStatusBar._hPanel;d=this._catalog=RClass.create(FDsMainCatalog);d._worksapce=this;d.build(b);d.setPanel(this._frameCatalog._hPanel);this.push(d);d=this._toolbar=RClass.create(FDsMainToolBar);d._worksapce=this;d.build(b);d.setPanel(this._frameToolBar._hPanel);d._persistenceButton.click();
this.push(d);d=this._canvas=RClass.create(FDsMainCanvas);d._worksapce=this;d.build(b);d.setPanel(this._frameWorkspace._hPanel);this.push(d)}function FDsMainWorkspace_dispose(){this.__base.FWorkspace.dispose.call(this)}
function FDsSpaceCanvas(b){b=RClass.inherits(this,b,FDsCanvas);b._rotation=null;b._optionRotation=!1;b._capturePosition=null;b._captureMatrix=null;b._captureRotation=null;b._selectObject=null;b._selectRenderables=null;b._templateMatrix=null;b._templateRenderable=null;b.onBuild=FDsSpaceCanvas_onBuild;b.onMouseCaptureStart=FDsSpaceCanvas_onMouseCaptureStart;b.onMouseCapture=FDsSpaceCanvas_onMouseCapture;b.onMouseCaptureStop=FDsSpaceCanvas_onMouseCaptureStop;b.oeResize=FDsSpaceCanvas_oeResize;b.oeRefresh=
FDsSpaceCanvas_oeRefresh;b.construct=FDsSpaceCanvas_construct;b.innerSelectRenderable=FDsSpaceCanvas_innerSelectRenderable;b.innerSelectDisplay=FDsSpaceCanvas_innerSelectDisplay;b.innerSelectLayer=FDsSpaceCanvas_innerSelectLayer;b.selectNone=FDsSpaceCanvas_selectNone;b.selectLayers=FDsSpaceCanvas_selectLayers;b.selectLayer=FDsSpaceCanvas_selectLayer;b.selectDisplay=FDsSpaceCanvas_selectDisplay;b.selectMaterial=FDsSpaceCanvas_selectMaterial;b.selectRenderable=FDsSpaceCanvas_selectRenderable;b.switchPlay=
FDsSpaceCanvas_switchPlay;b.switchMovie=FDsSpaceCanvas_switchMovie;b.dispose=FDsSpaceCanvas_dispose;return b}function FDsSpaceCanvas_onBuild(b){this.__base.FDsCanvas.onBuild.call(this,b)}
function FDsSpaceCanvas_onMouseCaptureStart(b){this.__base.FDsCanvas.onMouseCaptureStart.call(this,b);var d=this._activeSpace;d&&(d=d.region(),b=RConsole.find(FG3dTechniqueConsole).find(this._graphicContext,FG3dSelectTechnique).test(d,b.offsetX,b.offsetY),this.selectRenderable(b),b&&(b=b.display(),this._captureMatrix.assign(b.matrix())))}function FDsSpaceCanvas_onMouseCapture(b){this.__base.FDsCanvas.onMouseCapture.call(this,b)}
function FDsSpaceCanvas_onMouseCaptureStop(b){this.__base.FDsCanvas.onMouseCaptureStop.call(this,b)}function FDsSpaceCanvas_oeResize(b){this.__base.FDsCanvas.oeResize.call(this,b);var d=this._hPanel;b=d.offsetWidth;var d=d.offsetHeight,f=this._activeSpace;f&&(f=f.camera().projection(),f.size().set(b,d),f.update());return EEventStatus.Stop}function FDsSpaceCanvas_oeRefresh(b){return EEventStatus.Stop}
function FDsSpaceCanvas_construct(){this.__base.FDsCanvas.construct.call(this);this._capturePosition=new SPoint2;this._captureMatrix=new SMatrix3d;this._templateMatrix=new SMatrix3d;this._templateFaceMatrix=new SMatrix3d;this._rotation=new SVector3;this._captureRotation=new SVector3;this._selectRenderables=new TObjects}function FDsSpaceCanvas_innerSelectRenderable(b){b._optionSelected=!0;RClass.isClass(b,MDsBoundBox)&&b.showBoundBox();this._selectRenderables.push(b)}
function FDsSpaceCanvas_innerSelectDisplay(b){for(var d=b.displays(),f=d.count(),h=0;h<f;h++){var q=d.at(h);this.innerSelectDisplay(q)}b=b.renderables();f=b.count();for(h=0;h<f;h++)d=b.at(h),RClass.isClass(d,FDsSceneRenderable)&&this.innerSelectRenderable(d)}function FDsSpaceCanvas_innerSelectLayer(b){b=b.displays();for(var d=b.count(),f=0;f<d;f++){var h=b.at(f);this.innerSelectDisplay(h)}}
function FDsSpaceCanvas_selectNone(){for(var b=this._selectRenderables,d=b.count(),f=0;f<d;f++){var h=b.at(f);h._optionSelected=!1;RClass.isClass(h,MDsBoundBox)&&h.hideBoundBox()}this._selectObject=null;this._selectRenderables.clear()}function FDsSpaceCanvas_selectLayers(){this.selectNone();for(var b=this._activeSpace.layers(),d=b.count(),f=0;f<d;f++){var h=b.at(f);this.innerSelectLayer(h)}}function FDsSpaceCanvas_selectLayer(b){this.selectNone();this._selectObject=b;this.innerSelectLayer(b)}
function FDsSpaceCanvas_selectDisplay(b){this.selectNone();this._selectObject=b;this.innerSelectDisplay(b)}function FDsSpaceCanvas_selectMaterial(b){this.selectNone();this._selectObject=b;for(var d=b._display._sprite.renderables(),f=d.count(),h=0;h<f;h++){var q=d.at(h);q.material()==b&&this.innerSelectRenderable(q)}}function FDsSpaceCanvas_selectRenderable(b){this.selectNone();b&&(this.innerSelectRenderable(b),this._frameSet._catalogContent.showObject(b))}
function FDsSpaceCanvas_switchPlay(b){for(var d=this._activeSpace.allDisplays(),f=d.count(),h=0;h<f;h++){var q=d.at(h);RClass.isClass(q,FE3dSceneDisplay)&&(q._sprite._optionPlay=b,q._optionPlay=b)}}function FDsSpaceCanvas_switchMovie(b){for(var d=this._activeSpace.allDisplays(),f=d.count(),h=0;h<f;h++){var q=d.at(h);if(RClass.isClass(q,FE3dSceneDisplay)){var z=q._sprite;z&&(z._optionMovie=b);q._optionMovie=b}}}
function FDsSpaceCanvas_dispose(){this._rotation=RObject.dispose(this._rotation);this.__base.FDsCanvas.dispose.call(this)}
function FDsSpaceDesignCanvas(b){b=RClass.inherits(this,b,FDsSpaceCanvas);b._templateMatrix=null;b._templateRenderable=null;b._templateFace=null;b._templateTranslation=null;b._templateRotation=null;b._templateScale=null;b._templateViewScale=.05;b.onBuild=FDsSpaceDesignCanvas_onBuild;b.onDataLoaded=FDsSpaceDesignCanvas_onDataLoaded;b.construct=FDsSpaceDesignCanvas_construct;b.selectRenderable=FDsSpaceDesignCanvas_selectRenderable;b.refreshOperationFace=FDsSpaceDesignCanvas_refreshOperationFace;b.switchMode=
FDsSpaceDesignCanvas_switchMode;b.dispose=FDsSpaceDesignCanvas_dispose;return b}
function FDsSpaceDesignCanvas_onBuild(b){this.__base.FDsSpaceCanvas.onBuild.call(this,b);b=RConsole.find(FE3dTemplateConsole);(this._templateTranslation=b.allocByCode(this,"com.design.translation")).addLoadListener(this,this.onDataLoaded);(this._templateRotation=b.allocByCode(this,"com.design.rotation")).addLoadListener(this,this.onDataLoaded);(this._templateScale=b.allocByCode(this,"com.design.scale")).addLoadListener(this,this.onDataLoaded)}
function FDsSpaceDesignCanvas_onDataLoaded(b){b=this._graphicContext;var d=this._activeSpace;if(this._templateTranslation.testReady()&&this._templateRotation.testReady()&&this._templateScale.testReady()&&d.testReady()){var f=this._translationSprite=this._templateTranslation.sprite();f.setVisible(!1);var h=this._rotationSprite=this._templateRotation.sprite();h.setVisible(!1);var q=this._scaleSprite=this._templateScale.sprite();q.setVisible(!1);var z=this._uiLayer=RClass.create(FDisplayUiLayer);z.selectTechnique(b,
FE3dControlTechnique);z.pushDisplay(f);z.pushDisplay(h);z.pushDisplay(q);d.registerLayer("ui",z);this.reloadRegion();this.processLoadListener(this);RConsole.find(FUiDesktopConsole).hide()}}
function FDsSpaceDesignCanvas_onMouseCaptureStart(b){this.__base.FDsSpaceCanvas.onMouseCaptureStart.call(this,b);var d=this._activeSpace;d&&(d=d.region(),b=RConsole.find(FG3dTechniqueConsole).find(this._graphicContext,FG3dSelectTechnique).test(d,b.offsetX,b.offsetY),this.selectRenderable(b),b&&(b=b.display(),this._captureMatrix.assign(b.matrix())))}function FDsSpaceDesignCanvas_onMouseCapture(b){this.__base.FDsSpaceCanvas.onMouseCapture.call(this,b)}
function FDsSpaceDesignCanvas_onMouseCaptureStop(b){this.__base.FDsSpaceCanvas.onMouseCaptureStop.call(this,b)}function FDsSpaceDesignCanvas_oeResize(b){this.__base.FDsSpaceCanvas.oeResize.call(this,b);var d=this._hPanel;b=d.offsetWidth;var d=d.offsetHeight,f=this._activeSpace;f&&(f=f.camera().projection(),f.size().set(b,d),f.update());return EEventStatus.Stop}function FDsSpaceDesignCanvas_oeRefresh(b){return EEventStatus.Stop}
function FDsSpaceDesignCanvas_construct(){this.__base.FDsSpaceCanvas.construct.call(this);this._templateMatrix=new SMatrix3d;this._templateFaceMatrix=new SMatrix3d}function FDsSpaceDesignCanvas_selectRenderable(b){this._activeSpace&&(this.selectNone(),b&&(this.innerSelectRenderable(b),this._frameSet._catalogContent.showObject(b)))}
function FDsSpaceDesignCanvas_refreshOperationFace(){var b=this._canvasModeCd,d=!this._selectRenderables.isEmpty(),f=this._translationSprite,h=this._rotationSprite,q=this._scaleSprite;this._templateFace=null;switch(b){case EDsCanvasMode.Translate:f.setVisible(d);h.setVisible(!1);q.setVisible(!1);this._templateFace=f;break;case EDsCanvasMode.Rotation:f.setVisible(!1);h.setVisible(d);q.setVisible(!1);this._templateFace=q;break;case EDsCanvasMode.Scale:f.setVisible(!1),h.setVisible(!1),q.setVisible(d),
this._templateFace=q}b=this._templateFace;d&&b&&(d=this._selectRenderables.first().display(),b=b.matrix(),b.assign(d.matrix()),b.update())}function FDsSpaceDesignCanvas_switchMode(b){this._canvasModeCd=b}function FDsSpaceDesignCanvas_dispose(){this._rotation=RObject.dispose(this._rotation);this.__base.FDsSpaceCanvas.dispose.call(this)}
function FDsModelRenderable(b){b=RClass.inherits(this,b,FE3dModelRenderable,MDsBoundBox);b._optionSelected=!1;b.filterDrawables=FDsModelRenderable_filterDrawables;return b}function FDsModelRenderable_filterDrawables(b){var d=this.__base.FE3dSceneDisplayRenderable.filterDrawables.call(this,b);d&&this._boundVisible&&b.pushRenderable(this._boundBox);return d}function FDsSceneDisplay(b){return b=RClass.inherits(this,b,FE3dSceneDisplay)}
function FDsSceneLayer(b){return b=RClass.inherits(this,b,FE3dSceneLayer)}function FDsSceneRenderable(b){b=RClass.inherits(this,b,FE3dSceneDisplayRenderable,MDsBoundBox);b._optionSelected=!1;b.filterDrawables=FDsSceneRenderable_filterDrawables;return b}function FDsSceneRenderable_filterDrawables(b){var d=this.__base.FE3dSceneDisplayRenderable.filterDrawables.call(this,b);d&&this._boundVisible&&b.pushRenderable(this._boundBox);return d}
function FDrAbsResourceConsole(b){b=RClass.inherits(this,b,FConsole);b._scopeCd=EScope.Local;b._serviceCode=null;b._classUnit=null;b._resources=null;b.construct=FDrAbsResourceConsole_construct;b.makeServiceUrl=FDrAbsResourceConsole_makeServiceUrl;b.loadResource=FDrAbsResourceConsole_loadResource;b.doList=FDrAbsResourceConsole_doList;b.doQuery=FDrAbsResourceConsole_doQuery;b.doCreate=FDrAbsResourceConsole_doCreate;b.doUpdate=FDrAbsResourceConsole_doUpdate;b.doDelete=FDrAbsResourceConsole_doDelete;
return b}function FDrAbsResourceConsole_construct(){this.__base.FConsole.construct.call(this);this._resources=new TDictionary}function FDrAbsResourceConsole_makeServiceUrl(b){b=RBrowser.hostPath("/"+this._serviceCode+".ws?action="+b);RRuntime.isDebug()&&(b+="&date="+RDate.format());return b}function FDrAbsResourceConsole_loadResource(b){var d=b.get("guid"),f=this._resources.get(d);f||(f=RClass.create(this._classUnit),this._resources.set(d,f));f.loadConfig(b);return f}
function FDrAbsResourceConsole_doList(b,d,f,h){var q="/"+this._serviceCode+".ws?action=list";RString.isEmpty(b)||(q+="&search="+b);RString.isEmpty(d)||(q+="&order="+d);0<=f&&(q+="&page_size="+f);0<=h&&(q+="&page="+h);return RConsole.find(FXmlConsole).sendAsync(q)}function FDrAbsResourceConsole_doQuery(b){b="/"+this._serviceCode+".ws?action=query&guid="+b;return RConsole.find(FXmlConsole).sendAsync(b)}
function FDrAbsResourceConsole_doCreate(b){var d=new TXmlDocument,f=d.root();f.set("action","create");f=f.create(b.classCode());b.saveConfig(f);return RConsole.find(FXmlConsole).sendAsync("/"+this._serviceCode+".ws",d)}function FDrAbsResourceConsole_doUpdate(b){var d=new TXmlDocument,f=d.root();f.set("action","update");f=f.create(b.classCode());b.saveConfig(f);return RConsole.find(FXmlConsole).sendAsync("/"+this._serviceCode+".ws",d)}
function FDrAbsResourceConsole_doDelete(b){b="/"+this._serviceCode+".ws?action=delete&guid="+b;return RConsole.find(FXmlConsole).sendAsync(b)}function FDrBitmap(b){b=RClass.inherits(this,b,FDrResource);b._classCode="Bitmap";b._sizeWidth=0;b._sizeHeight=0;b.sizeWidth=FDrBitmap_sizeWidth;b.setSizeWidth=FDrBitmap_setSizeWidth;b.sizeHeight=FDrBitmap_sizeHeight;b.setSizeHeight=FDrBitmap_setSizeHeight;b.loadConfig=FDrBitmap_loadConfig;b.saveConfig=FDrBitmap_saveConfig;return b}
function FDrBitmap_sizeWidth(){return this._sizeWidth}function FDrBitmap_setSizeWidth(b){this._sizeWidth=b}function FDrBitmap_sizeHeight(){return this._sizeHeight}function FDrBitmap_setSizeHeight(b){this._sizeHeight=b}function FDrBitmap_loadConfig(b){this.__base.FDrResource.loadConfig.call(this,b);this._sizeWidth=b.getInteger("size_width");this._sizeHeight=b.getInteger("size_height")}
function FDrBitmap_saveConfig(b){this.__base.FDrResource.saveConfig.call(this,b);b.set("size_width",this._sizeWidth);b.set("size_height",this._sizeHeight)}function FDrBitmapConsole(b){b=RClass.inherits(this,b,FDrAbsResourceConsole);b._serviceCode="cloud.resource.bitmap";b._classUnit=FDrBitmap;b.query=FDrBitmapConsole_query;b.update=FDrBitmapConsole_update;return b}
function FDrBitmapConsole_query(b){for(var d=RBrowser.hostPath("/"+this._serviceCode+".ws?action=query&guid="+b),d=RConsole.find(FXmlConsole).send(d),f=d.nodeCount(),h=0;h<f;h++){var q=d.node(h);q.isName("Bitmap")&&this.loadResource(q)}return this._resources.get(b)}function FDrBitmapConsole_update(b){var d=RBrowser.hostPath("/"+this._serviceCode+".ws?action=update");return RConsole.find(FXmlConsole).sendAsync(d,b)}
function FDrMaterial(b){b=RClass.inherits(this,b,FDrResource);b._classCode="Material";b.loadConfig=FDrMaterial_loadConfig;b.saveConfig=FDrMaterial_saveConfig;return b}function FDrMaterial_loadConfig(b){this.__base.FDrResource.loadConfig.call(this,b)}function FDrMaterial_saveConfig(b){this.__base.FDrResource.saveConfig.call(this,b)}
function FDrMaterialConsole(b){b=RClass.inherits(this,b,FDrAbsResourceConsole);b._serviceCode="cloud.resource.material";b._classUnit=FDrMaterial;b.query=FDrMaterialConsole_query;b.update=FDrMaterialConsole_update;b.deleteBitmap=FDrMaterialConsole_deleteBitmap;return b}
function FDrMaterialConsole_query(b){for(var d=RBrowser.hostPath("/"+this._serviceCode+".ws?action=query&guid="+b),d=RConsole.find(FXmlConsole).send(d),f=d.nodeCount(),h=0;h<f;h++){var q=d.node(h);q.isName("Material")&&this.loadResource(q)}return this._resources.get(b)}function FDrMaterialConsole_update(b){var d=RBrowser.hostPath("/"+this._serviceCode+".ws?action=update");return RConsole.find(FXmlConsole).sendAsync(d,b)}
function FDrMaterialConsole_deleteBitmap(b){b=RBrowser.hostPath("/"+this._serviceCode+".ws?action=deleteBitmap&guid="+b);return RConsole.find(FXmlConsole).sendAsync(b)}function FDrMesh(b){b=RClass.inherits(this,b,FDrResource);b._classCode="Mesh";return b}function FDrMeshConsole(b){b=RClass.inherits(this,b,FDrAbsResourceConsole);b._serviceCode="cloud.resource.mesh";b.update=FDrMeshConsole_update;return b}
function FDrMeshConsole_update(b){var d=RBrowser.hostPath("/"+this._serviceCode+".ws?action=update&date="+RDate.format());return RConsole.find(FXmlConsole).sendAsync(d,b)}function FDrModel(b){b=RClass.inherits(this,b,FDrResource);b._classCode="Model";return b}function FDrModelConsole(b){b=RClass.inherits(this,b,FDrAbsResourceConsole);b._serviceCode="cloud.resource.model";b.update=FDrModelConsole_update;return b}
function FDrModelConsole_update(b){var d=RBrowser.hostPath("/"+this._serviceCode+".ws?action=updateContent&date="+RDate.format());return RConsole.find(FXmlConsole).sendAsync(d,b)}function FDrObject(b){b=RClass.inherits(this,b,FObject);b._guid=null;b._code=null;b._label=null;b.guid=FDrObject_guid;b.code=FDrObject_code;b.setCode=FDrObject_setCode;b.label=FDrObject_label;b.setLabel=FDrObject_setLabel;b.unserialize=FDrObject_unserialize;b.saveConfig=FDrObject_saveConfig;return b}
function FDrObject_guid(){return this._guid}function FDrObject_code(){return this._code}function FDrObject_setCode(b){this._code=b}function FDrObject_label(){return this._label}function FDrObject_setLabel(b){this._label=b}function FDrObject_unserialize(b){this._guid=b.readString();this._code=b.readString();this._label=b.readString()}function FDrObject_saveConfig(b){b.setNvl("guid",this._guid);b.setNvl("code",this._code);b.setNvl("label",this._label)}
function FDrProject(b){b=RClass.inherits(this,b,FDrResource);b._classCode="Project";b._projectGuid=null;b.saveConfig=FDrProject_saveConfig;return b}function FDrProject_saveConfig(b){this.__base.FDrResource.saveConfig.call(this,b);b.setNvl("project_guid",this._projectGuid)}function FDrProjectConsole(b){b=RClass.inherits(this,b,FDrAbsResourceConsole);b._serviceCode="cloud.solution.project";return b}
function FDrResource(b){b=RClass.inherits(this,b,FDrObject,MAttributeGuid,MAttributeCode,MAttributeLabel);b._classCode=null;b.classCode=FDrResource_classCode;b.loadConfig=FDrResource_loadConfig;b.saveConfig=FDrResource_saveConfig;return b}function FDrResource_classCode(){return this._classCode}function FDrResource_loadConfig(b){this._guid=b.get("guid");this._code=b.get("code");this._label=b.get("label")}
function FDrResource_saveConfig(b){b.setName(this._classCode);b.set("guid",this._guid);b.set("code",this._code);b.set("label",this._label)}
function FDrResourceConsole(b){b=RClass.inherits(this,b,FDrAbsResourceConsole);b._serviceCode="cloud.resource";b._catalogCode="cloud.resource.catalog";b._resources=null;b.construct=FDrResourceConsole_construct;b.doList=FDrResourceConsole_doList;b.doShare=FDrResourceConsole_doShare;b.doDelete=FDrResourceConsole_doDelete;b.doListShare=FDrResourceConsole_doListShare;b.doFolderCreate=FDrResourceConsole_doFolderCreate;b.doFolderUpdate=FDrResourceConsole_doFolderUpdate;b.doFolderDelete=FDrResourceConsole_doFolderDelete;
return b}function FDrResourceConsole_construct(){this.__base.FDrAbsResourceConsole.construct.call(this);this._resources=new TDictionary}function FDrResourceConsole_doList(b,d,f,h,q){b="/"+this._serviceCode+".ws?action=list&type_cd="+b+"&serach="+d+"&order="+f+"&page_size="+h+"&page="+q;return RConsole.find(FXmlConsole).sendAsync(b)}function FDrResourceConsole_doShare(b,d){var f=this.makeServiceUrl("share")+"&guid="+b+"&share_cd="+d;return RConsole.find(FXmlConsole).sendAsync(f)}
function FDrResourceConsole_doDelete(b,d){var f="/"+this._serviceCode+".ws?action=delete&type_cd="+b+"&guid="+d;return RConsole.find(FXmlConsole).sendAsync(f)}function FDrResourceConsole_doListShare(b,d,f,h,q){b="/"+this._serviceCode+".ws?action=listShare&type_cd="+b+"&serach="+d+"&order="+f+"&page_size="+h+"&page="+q;return RConsole.find(FXmlConsole).sendAsync(b)}
function FDrResourceConsole_doFolderCreate(b,d,f){var h=new TXmlDocument,q=h.root();q.set("action","create");q=q.create("Folder");q.set("parent_guid",b);q.set("code",d);q.set("label",f);return RConsole.find(FXmlConsole).sendAsync("/"+this._catalogCode+".ws",h)}
function FDrResourceConsole_doFolderUpdate(b,d,f){var h=new TXmlDocument,q=h.root();q.set("action","update");q=q.create("Folder");q.set("guid",b);q.set("code",d);q.set("label",f);return RConsole.find(FXmlConsole).sendAsync("/"+this._catalogCode+".ws",h)}function FDrResourceConsole_doFolderDelete(b){b="/"+this._catalogCode+".ws?action=delete&guid="+b;return RConsole.find(FXmlConsole).sendAsync(b)}
function FDrScene(b){b=RClass.inherits(this,b,FDrResource);b._classCode="Scene";b._projectGuid=null;b.saveConfig=FDrScene_saveConfig;return b}function FDrScene_saveConfig(b){this.__base.FDrResource.saveConfig.call(this,b);b.setNvl("project_guid",this._projectGuid)}
function FDrSceneConsole(b){b=RClass.inherits(this,b,FDrAbsResourceConsole);b._serviceCode="cloud.resource.scene";b.createCamera=FDrSceneConsole_createCamera;b.createLayer=FDrSceneConsole_createLayer;b.createSprite=FDrSceneConsole_createSprite;b.copyNode=FDrSceneConsole_copyNode;b.deleteNode=FDrSceneConsole_deleteNode;b.update=FDrSceneConsole_update;return b}function FDrSceneConsole_createCamera(b){var d=this.makeServiceUrl("createCamera");return RConsole.find(FXmlConsole).sendAsync(d,b)}
function FDrSceneConsole_createLayer(b){var d=this.makeServiceUrl("createLayer");return RConsole.find(FXmlConsole).sendAsync(d,b)}function FDrSceneConsole_createSprite(b){var d=this.makeServiceUrl("createSprite");return RConsole.find(FXmlConsole).sendAsync(d,b)}function FDrSceneConsole_copyNode(b,d){var f=this.makeServiceUrl("copyNode")+"&space_guid="+b+"&node_guid="+d;return RConsole.find(FXmlConsole).sendAsync(f)}
function FDrSceneConsole_deleteNode(b,d){var f=this.makeServiceUrl("deleteNode")+"&space_guid="+b+"&node_guid="+d;return RConsole.find(FXmlConsole).sendAsync(f)}function FDrSceneConsole_update(b){var d=RBrowser.hostPath("/"+this._serviceCode+".ws?action=updateContent&date="+RDate.format());return RConsole.find(FXmlConsole).sendAsync(d,b)}function FDrTemplate(b){b=RClass.inherits(this,b,FDrResource);b._classCode="Template";return b}
function FDrTemplateConsole(b){b=RClass.inherits(this,b,FDrAbsResourceConsole);b._serviceCode="cloud.resource.template";b.selectMaterial=FDrTemplateConsole_selectMaterial;b.createDisplay=FDrTemplateConsole_createDisplay;b.update=FDrTemplateConsole_update;return b}function FDrTemplateConsole_selectMaterial(b){var d=this.makeServiceUrl("createMaterial");return RConsole.find(FXmlConsole).sendAsync(d,b)}
function FDrTemplateConsole_createDisplay(b){var d=this.makeServiceUrl("createDisplay");return RConsole.find(FXmlConsole).sendAsync(d,b)}function FDrTemplateConsole_update(b){var d=RBrowser.hostPath("/"+this._serviceCode+".ws?action=updateContent&date="+RDate.format());return RConsole.find(FXmlConsole).sendAsync(d,b)}
function FDsCommonAnimationPropertyFrame(b){b=RClass.inherits(this,b,FUiForm);b._visible=!1;b._activeSpace=null;b._activeAnimation=null;b._controlGuid=null;b._controlCode=null;b._controlLabel=null;b.onBuilded=FDsCommonAnimationPropertyFrame_onBuilded;b.onDataChanged=FDsCommonAnimationPropertyFrame_onDataChanged;b.construct=FDsCommonAnimationPropertyFrame_construct;b.loadObject=FDsCommonAnimationPropertyFrame_loadObject;b.dispose=FDsCommonAnimationPropertyFrame_dispose;return b}
function FDsCommonAnimationPropertyFrame_construct(){this.__base.FUiForm.construct.call(this)}function FDsCommonAnimationPropertyFrame_onBuilded(b){this.__base.FUiForm.onBuilded.call(this,b);this._controlCode.addDataChangedListener(this,this.onDataChanged);this._controlLabel.addDataChangedListener(this,this.onDataChanged);this._controlPlayRate.addDataChangedListener(this,this.onDataChanged)}
function FDsCommonAnimationPropertyFrame_onDataChanged(b){b=this._activeAnimation;var d=b.resource();d.setCode(this._controlCode.get());d.setLabel(this._controlLabel.get());d._playRate=this._controlPlayRate.get();b.reloadResource()}function FDsCommonAnimationPropertyFrame_loadObject(b,d){var f=d.resource();this._activeSpace=b;this._activeAnimation=d;this._controlGuid.set(f.guid());this._controlCode.set(f.code());this._controlLabel.set(f.label());this._controlPlayRate.set(f.playRate())}
function FDsCommonAnimationPropertyFrame_dispose(){this.__base.FUiForm.dispose.call(this)}function FDsCommonCameraFrame(b){b=RClass.inherits(this,b,FUiForm);b._workspace=null;b._camera=null;b._controlPosition=null;b._controlDirection=null;b.construct=FDsCommonCameraFrame_construct;b.loadObject=FDsCommonCameraFrame_loadObject;b.dispose=FDsCommonCameraFrame_dispose;return b}function FDsCommonCameraFrame_construct(){this.__base.FUiForm.construct.call(this)}
function FDsCommonCameraFrame_loadObject(b,d){this._camera=d;this._controlPosition.set(d.position());this._controlDirection.set(d.direction())}function FDsCommonCameraFrame_dispose(){this.__base.FUiForm.dispose.call(this)}
function FDsCommonCameraPropertyFrame(b){b=RClass.inherits(this,b,FUiForm);b._visible=!1;b._workspace=null;b._activeSpace=null;b._activeCamera=null;b._controlGuid=null;b._controlCode=null;b._controlLabel=null;b._controlPosition=null;b._controlDirection=null;b.onBuilded=FDsCommonCameraPropertyFrame_onBuilded;b.onDataChanged=FDsCommonCameraPropertyFrame_onDataChanged;b.construct=FDsCommonCameraPropertyFrame_construct;b.loadObject=FDsCommonCameraPropertyFrame_loadObject;b.dispose=FDsCommonCameraPropertyFrame_dispose;
return b}function FDsCommonCameraPropertyFrame_onBuilded(b){this.__base.FUiForm.onBuilded.call(this,b);this._controlPosition.addDataChangedListener(this,this.onDataChanged);this._controlDirection.addDataChangedListener(this,this.onDataChanged)}
function FDsCommonCameraPropertyFrame_onDataChanged(b){b=this._activeCamera;var d=b.resource();d.position().assign(this._controlPosition.get());d.direction().assign(this._controlDirection.get());b.position().assign(d.position());b.direction().assign(d.direction());b.update()}function FDsCommonCameraPropertyFrame_construct(){this.__base.FUiForm.construct.call(this)}
function FDsCommonCameraPropertyFrame_loadObject(b,d){var f=d.resource();this._activeSpace=b;this._activeCamera=d;this._controlGuid.set(f.guid());this._controlCode.set(f.code());this._controlLabel.set(f.label());this._controlPosition.set(d.position());this._controlDirection.set(d.direction());f.position().assign(d.position());f.direction().assign(d.direction())}function FDsCommonCameraPropertyFrame_dispose(){this.__base.FUiForm.dispose.call(this)}
function FDsCommonDisplayDialog(b){b=RClass.inherits(this,b,FUiDialog);b._frameName="resource.common.dialog.DisplayDialog";b._displayModeCd=null;b._controlLayerLabel=null;b._controlDisplayLabel=null;b._controlCode=null;b._controlLabel=null;b._controlTemplateCode=null;b._controlConfirmButton=null;b._controlCancelButton=null;b.onBuilded=FDsCommonDisplayDialog_onBuilded;b.onConfirmLoad=FDsCommonDisplayDialog_onConfirmLoad;b.onConfirmClick=FDsCommonDisplayDialog_onConfirmClick;b.onCancelClick=FDsCommonDisplayDialog_onCancelClick;
b.construct=FDsCommonDisplayDialog_construct;b.setSpace=FDsCommonDisplayDialog_setSpace;b.setDisplayLabel=FDsCommonDisplayDialog_setDisplayLabel;b.setContentCode=FDsCommonDisplayDialog_setContentCode;b.setContentLabel=FDsCommonDisplayDialog_setContentLabel;b.dispose=FDsCommonDisplayDialog_dispose;return b}
function FDsCommonDisplayDialog_onBuilded(b){this.__base.FUiDialog.onBuilded.call(this,b);this._controlSpaceGuid.setEditAble(!1);this._controlSpaceLabel.setEditAble(!1);this._controlConfirm.addClickListener(this,this.onConfirmClick);this._controlCancel.addClickListener(this,this.onCancelClick)}function FDsCommonDisplayDialog_onConfirmLoad(b){RConsole.find(FUiDesktopConsole).hide();this.hide()}
function FDsCommonDisplayDialog_onConfirmClick(b){RConsole.find(FUiDesktopConsole).showUploading();b=new TXmlNode("Action");var d=b.create("Display");d.set("space_guid",this._spaceGuid);d.set("code",this._controlCode.get());d.set("label",this._controlLabel.get());d.set("model_guid",this._controlModelGuid.get());d.set("model_code",this._controlModelCode.get());RConsole.find(FDrTemplateConsole).createDisplay(b).addLoadListener(this,this.onConfirmLoad)}
function FDsCommonDisplayDialog_onCancelClick(b){this.hide()}function FDsCommonDisplayDialog_construct(){this.__base.FUiDialog.construct.call(this)}function FDsCommonDisplayDialog_setSpace(b){b=b.resource();this._controlSpaceGuid.set(b.guid());this._controlSpaceLabel.set(b.makeLabel())}function FDsCommonDisplayDialog_setDisplayLabel(b){this._controlDisplayLabel.set(b)}function FDsCommonDisplayDialog_setContentCode(b){this._controlCode.set(b)}
function FDsCommonDisplayDialog_setContentLabel(b){this._controlLabel.set(b)}function FDsCommonDisplayDialog_dispose(){this.__base.FUiDialog.dispose.call(this)}
function FDsCommonDisplayFrame(b){b=RClass.inherits(this,b,FUiForm);b._activeSpace=null;b._activeDisplay=null;b.onBuilded=FDsCommonDisplayFrame_onBuilded;b.onDataChanged=FDsCommonDisplayFrame_onDataChanged;b.construct=FDsCommonDisplayFrame_construct;b.loadObject=FDsCommonDisplayFrame_loadObject;b.dispose=FDsCommonDisplayFrame_dispose;return b}
function FDsCommonDisplayFrame_onBuilded(b){this.__base.FUiForm.onBuilded.call(this,b);this._controlTranslate.addDataChangedListener(this,this.onDataChanged);this._controlRotation.addDataChangedListener(this,this.onDataChanged);this._controlScale.addDataChangedListener(this,this.onDataChanged)}
function FDsCommonDisplayFrame_onDataChanged(b){b=this._activeDisplay;var d=b.resource().matrix(),f=this._controlTranslate.get();d.setTranslate(f.x,f.y,f.z);f=this._controlRotation.get();d.setRotation(f.x,f.y,f.z);f=this._controlScale.get();d.setScale(f.x,f.y,f.z);d.update();b.matrix().assign(d)}function FDsCommonDisplayFrame_construct(){this.__base.FUiForm.construct.call(this)}
function FDsCommonDisplayFrame_loadObject(b,d){var f=d.resource();this._activeSpace=b;this._activeDisplay=d;f=f.matrix();this._controlTranslate.set(f.tx,f.ty,f.tz);this._controlRotation.set(f.rx,f.ry,f.rz);this._controlScale.set(f.sx,f.sy,f.sz)}function FDsCommonDisplayFrame_dispose(){this.__base.FUiForm.dispose.call(this)}
function FDsCommonDisplayPropertyFrame(b){b=RClass.inherits(this,b,FUiForm);b._visible=!1;b._workspace=null;b._activeDisplay=null;b._activeResource=null;b._controlGuid=null;b._controlCode=null;b._controlLabel=null;b._displayFrame=null;b._materialFrame=null;b.onBuilded=FDsCommonDisplayPropertyFrame_onBuilded;b.onDataChanged=FDsCommonDisplayPropertyFrame_onDataChanged;b.construct=FDsCommonDisplayPropertyFrame_construct;b.loadObject=FDsCommonDisplayPropertyFrame_loadObject;b.dispose=FDsCommonDisplayPropertyFrame_dispose;
return b}function FDsCommonDisplayPropertyFrame_onBuilded(b){this.__base.FUiForm.onBuilded.call(this,b);this._controlCode.addDataChangedListener(this,this.onDataChanged);this._controlLabel.addDataChangedListener(this,this.onDataChanged)}function FDsCommonDisplayPropertyFrame_onDataChanged(b){b=this._activeResource;b._code=this._controlCode.get();b._label=this._controlLabel.get()}function FDsCommonDisplayPropertyFrame_construct(){this.__base.FUiForm.construct.call(this)}
function FDsCommonDisplayPropertyFrame_loadObject(b,d){var f=d._resource;this._activeSpace=b;this._activeDisplay=d;this._controlGuid.set(f.guid());this._controlCode.set(f.code());this._controlLabel.set(f.label());this._frameDisplay.loadObject(b,d)}function FDsCommonDisplayPropertyFrame_dispose(){this.__base.FUiForm.dispose.call(this)}
function FDsCommonLayerDialog(b){b=RClass.inherits(this,b,FUiDialog);b._frameName="resource.common.dialog.LayerDialog";b._displayModeCd=null;b._controlSpaceGuid=null;b._controlSpaceLabel=null;b._controlCode=null;b._controlLabel=null;b._controlConfirmButton=null;b._controlCancelButton=null;b.onBuilded=FDsCommonLayerDialog_onBuilded;b.onConfirmLoad=FDsCommonLayerDialog_onConfirmLoad;b.onConfirmClick=FDsCommonLayerDialog_onConfirmClick;b.onCancelClick=FDsCommonLayerDialog_onCancelClick;b.construct=FDsCommonLayerDialog_construct;
b.setSpace=FDsCommonLayerDialog_setSpace;b.setDisplayLabel=FDsCommonLayerDialog_setDisplayLabel;b.setContentCode=FDsCommonLayerDialog_setContentCode;b.setContentLabel=FDsCommonLayerDialog_setContentLabel;b.dispose=FDsCommonLayerDialog_dispose;return b}
function FDsCommonLayerDialog_onBuilded(b){this.__base.FUiDialog.onBuilded.call(this,b);this._controlSpaceGuid.setEditAble(!1);this._controlSpaceLabel.setEditAble(!1);this._controlConfirm.addClickListener(this,this.onConfirmClick);this._controlCancel.addClickListener(this,this.onCancelClick)}function FDsCommonLayerDialog_onConfirmLoad(b){RConsole.find(FUiDesktopConsole).hide();this.hide()}
function FDsCommonLayerDialog_onConfirmClick(b){RConsole.find(FUiDesktopConsole).showUploading();b=new TXmlNode("Action");var d=b.create("Layer");d.set("space_guid",this._spaceGuid);d.set("code",this._controlCode.get());d.set("label",this._controlLabel.get());RConsole.find(FDrSceneConsole).createLayer(b).addLoadListener(this,this.onConfirmLoad)}function FDsCommonLayerDialog_onCancelClick(b){this.hide()}function FDsCommonLayerDialog_construct(){this.__base.FUiDialog.construct.call(this)}
function FDsCommonLayerDialog_setSpace(b){b=b.resource();this._controlSpaceGuid.set(b.guid());this._controlSpaceLabel.set(b.makeLabel())}function FDsCommonLayerDialog_setDisplayLabel(b){this._controlDisplayLabel.set(b)}function FDsCommonLayerDialog_setContentCode(b){this._controlCode.set(b)}function FDsCommonLayerDialog_setContentLabel(b){this._controlLabel.set(b)}function FDsCommonLayerDialog_dispose(){this.__base.FUiDialog.dispose.call(this)}
function FDsCommonLayerPropertyFrame(b){b=RClass.inherits(this,b,FUiForm);b._visible=!1;b._workspace=null;b._layer=null;b._layerResource=null;b._controlGuid=null;b._controlCode=null;b._controlLabel=null;b.onBuilded=FDsCommonLayerPropertyFrame_onBuilded;b.onDataChanged=FDsCommonLayerPropertyFrame_onDataChanged;b.construct=FDsCommonLayerPropertyFrame_construct;b.loadObject=FDsCommonLayerPropertyFrame_loadObject;b.dispose=FDsCommonLayerPropertyFrame_dispose;return b}
function FDsCommonLayerPropertyFrame_construct(){this.__base.FUiForm.construct.call(this)}function FDsCommonLayerPropertyFrame_onBuilded(b){this.__base.FUiForm.onBuilded.call(this,b);this._controlCode.addDataChangedListener(this,this.onDataChanged);this._controlLabel.addDataChangedListener(this,this.onDataChanged);this._controlTypeCd.addDataChangedListener(this,this.onDataChanged);this._controlTransformCd.addDataChangedListener(this,this.onDataChanged)}
function FDsCommonLayerPropertyFrame_onDataChanged(b){b=this._layerResource;b.setCode(this._controlCode.get());b.setLabel(this._controlLabel.get());b.setTypeCd(this._controlTypeCd.get());b.setTransformCd(this._controlTransformCd.get())}
function FDsCommonLayerPropertyFrame_loadObject(b,d){var f=d.resource();this._layer=d;this._layerResource=f;this._controlGuid.set(f.guid());this._controlCode.set(f.code());this._controlLabel.set(f.label());this._controlTypeCd.set(f.typeCd());this._controlTransformCd.set(f.transformCd())}function FDsCommonLayerPropertyFrame_dispose(){this.__base.FUiForm.dispose.call(this)}
function FDsCommonLightPropertyFrame(b){b=RClass.inherits(this,b,FUiForm);b._visible=!1;b._workspace=null;b._activeSpace=null;b._activeLight=null;b._controlGuid=null;b._controlCode=null;b._controlLabel=null;b.construct=FDsCommonLightPropertyFrame_construct;b.loadObject=FDsCommonLightPropertyFrame_loadObject;b.dispose=FDsCommonLightPropertyFrame_dispose;return b}function FDsCommonLightPropertyFrame_construct(){this.__base.FUiForm.construct.call(this)}
function FDsCommonLightPropertyFrame_loadObject(b,d){var f=d.resource();this._activeSpace=b;this._activeLight=d;this._controlGuid.set(f.guid());this._controlCode.set(f.code());this._controlLabel.set(f.label())}function FDsCommonLightPropertyFrame_dispose(){this.__base.FUiForm.dispose.call(this)}
function FDsCommonMaterial1Frame(b){b=RClass.inherits(this,b,FUiForm);b._activeSpace=null;b._activeMaterial=null;b._controlOptionDouble=null;b._controlEffectCode=null;b._controlOptionAlpha=null;b._controlAlphaBase=null;b._controlAlphaRate=null;b._controlOptionColor=null;b._controlColorMin=null;b._controlColorMax=null;b._controlColorBalance=null;b._controlColorRate=null;b._controlOptionVertex=null;b._controlVertexColor=null;b._controlOptionAmbient=null;b._controlAmbientColor=null;b._controlOptionDiffuse=
null;b._controlDiffuseColor=null;b._controlOptionSpecular=null;b._controlSpecularColor=null;b._controlSpecularBase=null;b._controlSpecularLevel=null;b._controlOptionReflect=null;b._controlReflectColor=null;b._controlReflectMerge=null;b._controlOptionEmissive=null;b._controlEmissiveColor=null;b.onBuilded=FDsCommonMaterial1Frame_onBuilded;b.onOptionChanged=FDsCommonMaterial1Frame_onOptionChanged;b.onDataChanged=FDsCommonMaterial1Frame_onDataChanged;b.construct=FDsCommonMaterial1Frame_construct;b.loadObject=
FDsCommonMaterial1Frame_loadObject;b.dispose=FDsCommonMaterial1Frame_dispose;return b}
function FDsCommonMaterial1Frame_onBuilded(b){this.__base.FUiForm.onBuilded.call(this,b);this._controlOptionDouble.addDataChangedListener(this,this.onDataChanged);this._controlEffectCode.addDataChangedListener(this,this.onDataChanged);this._controlOptionAlpha.addDataChangedListener(this,this.onDataChanged);this._controlAlphaBase.addDataChangedListener(this,this.onDataChanged);this._controlAlphaRate.addDataChangedListener(this,this.onDataChanged);this._controlOptionColor.addDataChangedListener(this,
this.onOptionChanged);this._controlColorMin.addDataChangedListener(this,this.onDataChanged);this._controlColorMax.addDataChangedListener(this,this.onDataChanged);this._controlColorBalance.addDataChangedListener(this,this.onDataChanged);this._controlColorRate.addDataChangedListener(this,this.onDataChanged);this._controlOptionVertex.addDataChangedListener(this,this.onOptionChanged);this._controlVertexColor.addDataChangedListener(this,this.onDataChanged);this._controlOptionAmbient.addDataChangedListener(this,
this.onOptionChanged);this._controlAmbientColor.addDataChangedListener(this,this.onDataChanged);this._controlOptionDiffuse.addDataChangedListener(this,this.onOptionChanged);this._controlDiffuseColor.addDataChangedListener(this,this.onDataChanged);this._controlOptionSpecular.addDataChangedListener(this,this.onOptionChanged);this._controlSpecularColor.addDataChangedListener(this,this.onDataChanged);this._controlSpecularBase.addDataChangedListener(this,this.onDataChanged);this._controlSpecularLevel.addDataChangedListener(this,
this.onDataChanged);this._controlOptionReflect.addDataChangedListener(this,this.onOptionChanged);this._controlReflectColor.addDataChangedListener(this,this.onDataChanged);this._controlReflectMerge.addDataChangedListener(this,this.onDataChanged);this._controlOptionEmissive.addDataChangedListener(this,this.onOptionChanged);this._controlEmissiveColor.addDataChangedListener(this,this.onDataChanged)}function FDsCommonMaterial1Frame_onOptionChanged(b){}
function FDsCommonMaterial1Frame_onDataChanged(b){b=this._activeMaterial;var d=b.resource().info();d.optionDouble=this._controlOptionDouble.get();d.effectCode=this._controlEffectCode.get();d.optionAlpha=this._controlOptionAlpha.get();d.alphaBase=this._controlAlphaBase.get();d.alphaRate=this._controlAlphaRate.get();d.colorMin=this._controlColorMin.get();d.colorMax=this._controlColorMax.get();d.colorBalance=this._controlColorBalance.get();d.colorRate=this._controlColorRate.get();d.vertexColor.assign(this._controlVertexColor.get());
d.ambientColor.assign(this._controlAmbientColor.get());d.diffuseColor.assign(this._controlDiffuseColor.get());d.specularColor.assign(this._controlSpecularColor.get());d.specularBase=this._controlSpecularBase.get();d.specularLevel=this._controlSpecularLevel.get();d.reflectColor.assign(this._controlReflectColor.get());d.reflectMerge=this._controlReflectMerge.get();d.emissiveColor.assign(this._controlEmissiveColor.get());b.reloadResource()}
function FDsCommonMaterial1Frame_construct(){this.__base.FUiForm.construct.call(this)}
function FDsCommonMaterial1Frame_loadObject(b,d){this._activeSpace=b;this._activeMaterial=d;var f=d.resource();f&&(f=f.info(),this._controlOptionDouble.set(f.optionDouble),this._controlEffectCode.set(f.effectCode),this._controlOptionAlpha.set(f.optionAlpha),this._controlAlphaBase.set(f.alphaBase),this._controlAlphaRate.set(f.alphaRate),this._controlOptionColor.set(f.optionColor),this._controlColorMin.set(f.colorMin),this._controlColorMax.set(f.colorMax),this._controlColorBalance.set(f.colorBalance),
this._controlColorRate.set(f.colorRate),this._controlOptionVertex.set(f.optionVertex),this._controlVertexColor.set(f.vertexColor),this._controlOptionAmbient.set(f.optionAmbient),this._controlAmbientColor.set(f.ambientColor),this._controlOptionDiffuse.set(f.optionDiffuse),this._controlDiffuseColor.set(f.diffuseColor),this._controlOptionSpecular.set(f.optionSpecular),this._controlSpecularColor.set(f.specularColor),this._controlSpecularBase.set(f.specularBase),this._controlSpecularLevel.set(f.specularLevel),
this._controlOptionReflect.set(f.optionReflect),this._controlReflectColor.set(f.reflectColor),this._controlReflectMerge.set(f.reflectMerge),this._controlOptionEmissive.set(f.optionEmissive),this._controlEmissiveColor.set(f.emissiveColor))}function FDsCommonMaterial1Frame_dispose(){this.__base.FUiForm.dispose.call(this)}
function FDsCommonMaterial2Frame(b){b=RClass.inherits(this,b,FUiForm);b._activeSpace=null;b._activeMaterial=null;b._controlDiffuseViewColor=null;b._controlSpecularViewColor=null;b._controlSpecularViewBase=null;b._controlSpecularViewLevel=null;b.onBuilded=FDsCommonMaterial2Frame_onBuilded;b.onDataChanged=FDsCommonMaterial2Frame_onDataChanged;b.construct=FDsCommonMaterial2Frame_construct;b.loadObject=FDsCommonMaterial2Frame_loadObject;b.dispose=FDsCommonMaterial2Frame_dispose;return b}
function FDsCommonMaterial2Frame_onBuilded(b){this.__base.FUiForm.onBuilded.call(this,b);this._controlOptionView.addDataChangedListener(this,this.onDataChanged);this._controlOptionNormalInvert.addDataChangedListener(this,this.onDataChanged);this._controlOptionShadow.addDataChangedListener(this,this.onDataChanged);this._controlOptionShadowSelf.addDataChangedListener(this,this.onDataChanged);this._controlDiffuseViewColor.addDataChangedListener(this,this.onDataChanged);this._controlSpecularViewColor.addDataChangedListener(this,
this.onDataChanged);this._controlSpecularViewBase.addDataChangedListener(this,this.onDataChanged);this._controlSpecularViewLevel.addDataChangedListener(this,this.onDataChanged)}
function FDsCommonMaterial2Frame_onDataChanged(b){b=this._activeMaterial;var d=b.resource().info();d.optionView=this._controlOptionView.get();d.optionNormalInvert=this._controlOptionNormalInvert.get();d.optionShadow=this._controlOptionShadow.get();d.optionShadowSelf=this._controlOptionShadowSelf.get();var f=this._controlDiffuseViewColor.get();d.diffuseViewColor.assign(f);f=this._controlSpecularViewColor.get();d.specularViewColor.assign(f);d.specularViewBase=this._controlSpecularViewBase.get();d.specularViewLevel=
this._controlSpecularViewLevel.get();b.reloadResource()}function FDsCommonMaterial2Frame_construct(){this.__base.FUiForm.construct.call(this)}
function FDsCommonMaterial2Frame_loadObject(b,d){this._activeSpace=b;this._activeMaterial=d;var f=d.resource();f&&(f=f.info(),this._controlOptionView.set(f.optionView),this._controlOptionNormalInvert.set(f.optionNormalInvert),this._controlOptionShadow.set(f.optionShadow),this._controlOptionShadowSelf.set(f.optionShadowSelf),this._controlDiffuseViewColor.set(f.diffuseViewColor),this._controlSpecularViewColor.set(f.specularViewColor),this._controlSpecularViewBase.set(f.specularViewBase),this._controlSpecularViewLevel.set(f.specularViewLevel))}
function FDsCommonMaterial2Frame_dispose(){this.__base.FUiForm.dispose.call(this)}
function FDsCommonMaterialDialog(b){b=RClass.inherits(this,b,FUiDialog);b._frameName="resource.common.dialog.MaterialDialog";b._displayModeCd=null;b._controlLayerLabel=null;b._controlDisplayLabel=null;b._controlCode=null;b._controlLabel=null;b._controlTemplateCode=null;b._controlConfirmButton=null;b._controlCancelButton=null;b.onBuilded=FDsCommonMaterialDialog_onBuilded;b.onConfirmLoad=FDsCommonMaterialDialog_onConfirmLoad;b.onConfirmClick=FDsCommonMaterialDialog_onConfirmClick;b.onCancelClick=FDsCommonMaterialDialog_onCancelClick;
b.construct=FDsCommonMaterialDialog_construct;b.setSpace=FDsCommonMaterialDialog_setSpace;b.setDisplayLabel=FDsCommonMaterialDialog_setDisplayLabel;b.setContentCode=FDsCommonMaterialDialog_setContentCode;b.setContentLabel=FDsCommonMaterialDialog_setContentLabel;b.dispose=FDsCommonMaterialDialog_dispose;return b}
function FDsCommonMaterialDialog_onBuilded(b){this.__base.FUiDialog.onBuilded.call(this,b);this._controlSpaceGuid.setEditAble(!1);this._controlSpaceLabel.setEditAble(!1);this._controlConfirm.addClickListener(this,this.onConfirmClick);this._controlCancel.addClickListener(this,this.onCancelClick)}function FDsCommonMaterialDialog_onConfirmLoad(b){RConsole.find(FUiDesktopConsole).hide();this.hide()}
function FDsCommonMaterialDialog_onConfirmClick(b){RConsole.find(FUiDesktopConsole).showUploading();b=new TXmlNode("Action");var d=b.create("Material");d.set("space_guid",this._spaceGuid);d.set("code",this._controlCode.get());d.set("label",this._controlLabel.get());d.set("material_guid",this._controlMaterialGuid.get());d.set("material_code",this._controlMaterialCode.get());RConsole.find(FDrTemplateConsole).selectMaterial(b).addLoadListener(this,this.onConfirmLoad)}
function FDsCommonMaterialDialog_onCancelClick(b){this.hide()}function FDsCommonMaterialDialog_construct(){this.__base.FUiDialog.construct.call(this)}function FDsCommonMaterialDialog_setSpace(b){b=b.resource();this._controlSpaceGuid.set(b.guid());this._controlSpaceLabel.set(b.makeLabel())}function FDsCommonMaterialDialog_setDisplayLabel(b){this._controlDisplayLabel.set(b)}function FDsCommonMaterialDialog_setContentCode(b){this._controlCode.set(b)}
function FDsCommonMaterialDialog_setContentLabel(b){this._controlLabel.set(b)}function FDsCommonMaterialDialog_dispose(){this.__base.FUiDialog.dispose.call(this)}
function FDsCommonMaterialPropertyFrame(b){b=RClass.inherits(this,b,FUiForm);b._visible=!1;b._workspace=null;b._activeMaterial=null;b._controlGuid=null;b._controlCode=null;b._controlLabel=null;b._frameMaterial1=null;b._frameMaterial2=null;b.onBuilded=FDsCommonMaterialPropertyFrame_onBuilded;b.onDataChanged=FDsCommonMaterialPropertyFrame_onDataChanged;b.construct=FDsCommonMaterialPropertyFrame_construct;b.loadObject=FDsCommonMaterialPropertyFrame_loadObject;b.dispose=FDsCommonMaterialPropertyFrame_dispose;
return b}function FDsCommonMaterialPropertyFrame_onBuilded(b){this.__base.FUiForm.onBuilded.call(this,b);this._controlLabel.addDataChangedListener(this,this.onDataChanged)}function FDsCommonMaterialPropertyFrame_onDataChanged(b){this._activeMaterial.resource().setLabel(this._controlLabel.get())}function FDsCommonMaterialPropertyFrame_construct(){this.__base.FUiForm.construct.call(this)}
function FDsCommonMaterialPropertyFrame_loadObject(b,d){var f=d.resource();this._activeSpace=b;this._activeMaterial=d;this._controlGuid.set(f.guid());this._controlCode.set(f.code());this._controlLabel.set(f.label());this._frameMaterial1.loadObject(b,d);this._frameMaterial2.loadObject(b,d)}function FDsCommonMaterialPropertyFrame_dispose(){this.__base.FUiForm.dispose.call(this)}
function FDsCommonMaterialReferDialog(b){b=RClass.inherits(this,b,FUiDialog);b._frameName="resource.common.dialog.MaterialReferDialog";b._displayModeCd=null;b._controlGuid=null;b._controlCode=null;b._controlLabel=null;b._controlConfirm=null;b._controlCancel=null;b.onBuilded=FDsCommonMaterialReferDialog_onBuilded;b.onConfirmLoad=FDsCommonMaterialReferDialog_onConfirmLoad;b.onConfirmClick=FDsCommonMaterialReferDialog_onConfirmClick;b.onCancelClick=FDsCommonMaterialReferDialog_onCancelClick;b.construct=
FDsCommonMaterialReferDialog_construct;b.setContentGuid=FDsCommonMaterialReferDialog_setContentGuid;b.setContentCode=FDsCommonMaterialReferDialog_setContentCode;b.setContentLabel=FDsCommonMaterialReferDialog_setContentLabel;b.dispose=FDsCommonMaterialReferDialog_dispose;return b}
function FDsCommonMaterialReferDialog_onBuilded(b){this.__base.FUiDialog.onBuilded.call(this,b);this._controlConfirm.addClickListener(this,this.onConfirmClick);this._controlCancel.addClickListener(this,this.onCancelClick)}function FDsCommonMaterialReferDialog_onConfirmLoad(b){RConsole.find(FUiDesktopConsole).hide();this.hide()}function FDsCommonMaterialReferDialog_onConfirmClick(b){this._materialRefer._guid=this._controlGuid.get();this.hide()}
function FDsCommonMaterialReferDialog_onCancelClick(b){this.hide()}function FDsCommonMaterialReferDialog_construct(){this.__base.FUiDialog.construct.call(this)}function FDsCommonMaterialReferDialog_setContentGuid(b){this._controlGuid.set(b)}function FDsCommonMaterialReferDialog_setContentCode(b){this._controlCode.set(b)}function FDsCommonMaterialReferDialog_setContentLabel(b){this._controlLabel.set(b)}function FDsCommonMaterialReferDialog_dispose(){this.__base.FUiDialog.dispose.call(this)}
function FDsCommonRegionPropertyFrame(b){b=RClass.inherits(this,b,FUiForm);b._visible=!1;b._workspace=null;b._activeSpace=null;b._activeRegion=null;b._controlMoveSpeed=null;b._controlRotationKeySpeed=null;b._controlRotationMouseSpeed=null;b._controlOptionBackground=null;b._controlBackgroundColor=null;b.onBuilded=FDsCommonRegionPropertyFrame_onBuilded;b.onDataChanged=FDsCommonRegionPropertyFrame_onDataChanged;b.construct=FDsCommonRegionPropertyFrame_construct;b.loadObject=FDsCommonRegionPropertyFrame_loadObject;
b.dispose=FDsCommonRegionPropertyFrame_dispose;return b}
function FDsCommonRegionPropertyFrame_onBuilded(b){this.__base.FUiForm.onBuilded.call(this,b);this._controlMoveSpeed.addDataChangedListener(this,this.onDataChanged);this._controlRotationKeySpeed.addDataChangedListener(this,this.onDataChanged);this._controlRotationMouseSpeed.addDataChangedListener(this,this.onDataChanged);this._controlOptionBackground.addDataChangedListener(this,this.onDataChanged);this._controlBackgroundColor.addDataChangedListener(this,this.onDataChanged)}
function FDsCommonRegionPropertyFrame_onDataChanged(b){b=this._activeRegion;var d=b.resource();d.setOptionBackground(this._controlOptionBackground.get());d.backgroundColor().assign(this._controlBackgroundColor.get());d.setMoveSpeed(this._controlMoveSpeed.get());d.setRotationKeySpeed(this._controlRotationKeySpeed.get());d.setRotationMouseSpeed(this._controlRotationMouseSpeed.get());b.reloadResource();this._frameSet._canvasContent.reloadRegion(b)}
function FDsCommonRegionPropertyFrame_construct(){this.__base.FUiForm.construct.call(this)}function FDsCommonRegionPropertyFrame_loadObject(b,d){var f=d.resource();this._activeSpace=b;this._activeRegion=d;this._controlMoveSpeed.set(f.moveSpeed());this._controlRotationKeySpeed.set(f.rotationKeySpeed());this._controlRotationMouseSpeed.set(f.rotationMouseSpeed());this._controlOptionBackground.set(f.optionBackground());this._controlBackgroundColor.set(f.backgroundColor())}
function FDsCommonRegionPropertyFrame_dispose(){this.__base.FUiForm.dispose.call(this)}
function FDsCommonRenderableFrame(b){b=RClass.inherits(this,b,FUiForm);b._activeSpace=null;b._activeRenderable=null;b.onBuilded=FDsCommonRenderableFrame_onBuilded;b.onDataChanged=FDsCommonRenderableFrame_onDataChanged;b.onMaterialClick=FDsCommonRenderableFrame_onMaterialClick;b.onEffectClick=FDsCommonRenderableFrame_onEffectClick;b.construct=FDsCommonRenderableFrame_construct;b.loadObject=FDsCommonRenderableFrame_loadObject;b.dispose=FDsCommonRenderableFrame_dispose;return b}
function FDsCommonRenderableFrame_onBuilded(b){this.__base.FUiForm.onBuilded.call(this,b);this._controlTranslate.addDataChangedListener(this,this.onDataChanged);this._controlRotation.addDataChangedListener(this,this.onDataChanged);this._controlScale.addDataChangedListener(this,this.onDataChanged);this._controlMaterials.addClickListener(this,this.onMaterialClick);this._controlEffects.addClickListener(this,this.onEffectClick)}
function FDsCommonRenderableFrame_onDataChanged(b){b=this._activeRenderable.matrix();var d=this._controlTranslate.get();b.setTranslate(d.x,d.y,d.z);d=this._controlRotation.get();b.setRotation(d.x,d.y,d.z);d=this._controlScale.get();b.setScale(d.x,d.y,d.z);b.update()}
function FDsCommonRenderableFrame_onMaterialClick(b,d){var f=d.tag(),h=RConsole.find(FUiWindowConsole).find(FDsCommonMaterialReferDialog);h._frame=this;h._materialRefer=f;h.setContentCode("");h.setContentLabel("");h.showPosition(EUiPosition.Center)}function FDsCommonRenderableFrame_onEffectClick(b,d){var f=d.tag()._program,h=f._vertexShader;alert(h._source);h=f._fragmentShader;alert(h._source)}function FDsCommonRenderableFrame_construct(){this.__base.FUiForm.construct.call(this)}
function FDsCommonRenderableFrame_loadObject(b,d){this._activeSpace=b;this._activeRenderable=d;var f=d.resource(),h=d.matrix();this._controlTranslate.set(h.tx,h.ty,h.tz);this._controlRotation.set(h.rx,h.ry,h.rz);this._controlScale.set(h.sx,h.sy,h.sz);if(f){var q=this._controlMaterials;q.clear();for(var h=d.indexBuffers().count(),z=0;z<h;z++){var A=f.syncMaterialRefer(z),B=q.createItem(null,z+": "+A.guid());B.setTag(A);q.push(B)}}f=this._controlEffects;f.clear();q=d.infos();h=q.count();for(z=0;z<h;z++)if(A=
q.at(z).effect)B=f.createItem(null,A.code()),B.setTag(A),f.push(B)}function FDsCommonRenderableFrame_dispose(){this.__base.FUiForm.dispose.call(this)}
function FDsCommonRenderablePropertyFrame(b){b=RClass.inherits(this,b,FUiForm);b._visible=!1;b._activeRenderable=null;b._activeMaterial=null;b._controlGuid=null;b._controlCode=null;b._controlLabel=null;b._frameRenderable=null;b._frameMaterial1=null;b._frameMaterial2=null;b.construct=FDsCommonRenderablePropertyFrame_construct;b.loadObject=FDsCommonRenderablePropertyFrame_loadObject;b.dispose=FDsCommonRenderablePropertyFrame_dispose;return b}
function FDsCommonRenderablePropertyFrame_construct(){this.__base.FUiForm.construct.call(this)}function FDsCommonRenderablePropertyFrame_loadObject(b,d){var f=d.material(),h=d.renderable().resource();this._activeRenderable=d;this._activeMaterial=f;this._controlGuid.set(h.guid());this._controlCode.set(h.code());this._controlLabel.set(h.label());this._frameRenderable.loadObject(b,d);this._frameMaterial1.loadObject(b,f);this._frameMaterial2.loadObject(b,f)}
function FDsCommonRenderablePropertyFrame_dispose(){this.__base.FUiForm.dispose.call(this)}
function FDsCommonSpacePropertyFrame(b){b=RClass.inherits(this,b,FUiForm);b._visible=!1;b._workspace=null;b._activeSpace=null;b._controlGuid=null;b._controlCode=null;b._controlLabel=null;b.onBuilded=FDsCommonSpacePropertyFrame_onBuilded;b.onDataChanged=FDsCommonSpacePropertyFrame_onDataChanged;b.construct=FDsCommonSpacePropertyFrame_construct;b.loadObject=FDsCommonSpacePropertyFrame_loadObject;b.dispose=FDsCommonSpacePropertyFrame_dispose;return b}
function FDsCommonSpacePropertyFrame_onBuilded(b){this.__base.FUiForm.onBuilded.call(this,b);this._controlLabel.addDataChangedListener(this,this.onDataChanged)}function FDsCommonSpacePropertyFrame_onDataChanged(b){this._activeSpace.resource().setLabel(this._controlLabel.get())}function FDsCommonSpacePropertyFrame_construct(){this.__base.FUiForm.construct.call(this)}
function FDsCommonSpacePropertyFrame_loadObject(b){var d=b.resource();this._activeSpace=b;this._controlGuid.set(d.guid());this._controlCode.set(d.code());this._controlLabel.set(d.label())}function FDsCommonSpacePropertyFrame_dispose(){this.__base.FUiForm.dispose.call(this)}
function FDsCommonSpriteDialog(b){b=RClass.inherits(this,b,FUiDialog);b._frameName="resource.common.dialog.SpriteDialog";b._displayModeCd=null;b._controlLayerLabel=null;b._controlDisplayLabel=null;b._controlCode=null;b._controlLabel=null;b._controlTemplateCode=null;b._controlConfirmButton=null;b._controlCancelButton=null;b.onBuilded=FDsCommonSpriteDialog_onBuilded;b.onConfirmLoad=FDsCommonSpriteDialog_onConfirmLoad;b.onConfirmClick=FDsCommonSpriteDialog_onConfirmClick;b.onCancelClick=FDsCommonSpriteDialog_onCancelClick;
b.construct=FDsCommonSpriteDialog_construct;b.setLayerLabel=FDsCommonSpriteDialog_setLayerLabel;b.setDisplayLabel=FDsCommonSpriteDialog_setDisplayLabel;b.setContentCode=FDsCommonSpriteDialog_setContentCode;b.setContentLabel=FDsCommonSpriteDialog_setContentLabel;b.dispose=FDsCommonSpriteDialog_dispose;return b}
function FDsCommonSpriteDialog_onBuilded(b){this.__base.FUiDialog.onBuilded.call(this,b);this._controlLayerLabel.setEditAble(!1);this._controlDisplayLabel.setEditAble(!1);this._controlConfirmButton.addClickListener(this,this.onConfirmClick);this._controlCancelButton.addClickListener(this,this.onCancelClick)}
function FDsCommonSpriteDialog_onConfirmLoad(b){RConsole.find(FUiDesktopConsole).hide();this.hide();b=this._frameSet._catalogContent;if(this._displayModeCd==EUiDataMode.Insert)if(this._parentGuid){var d=b.findByGuid(this._parentGuid);b.loadNode(d)}else b.loadService();else{var f=this._controlLabel.get(),d=b.focusNode();d.setLabel(f)}}
function FDsCommonSpriteDialog_onConfirmClick(b){RConsole.find(FUiDesktopConsole).showUploading();b=new TXmlNode("Action");var d=b.create("Sprite");d.set("space_guid",this._spaceGuid);d.set("layer_guid",this._layerGuid);d.set("display_guid",this._displayGuid);d.set("code",this._controlCode.get());d.set("label",this._controlLabel.get());d.set("template_guid",this._controlTemplateGuid.get());d.set("template_code",this._controlTemplateCode.get());d=null;d=RConsole.find(FDrSceneConsole).createSprite(b);
d.addLoadListener(this,this.onConfirmLoad)}function FDsCommonSpriteDialog_onCancelClick(b){this.hide()}function FDsCommonSpriteDialog_construct(){this.__base.FUiDialog.construct.call(this)}function FDsCommonSpriteDialog_setLayerLabel(b){this._controlLayerLabel.set(b)}function FDsCommonSpriteDialog_setDisplayLabel(b){this._controlDisplayLabel.set(b)}function FDsCommonSpriteDialog_setContentCode(b){this._controlCode.set(b)}
function FDsCommonSpriteDialog_setContentLabel(b){this._controlLabel.set(b)}function FDsCommonSpriteDialog_dispose(){this.__base.FUiDialog.dispose.call(this)}
function FDsCommonTechniquePropertyFrame(b){b=RClass.inherits(this,b,FUiForm);b._visible=!1;b._workspace=null;b._activeSpace=null;b._activeTechnique=null;b._controlTriangleCount=null;b._controlDrawCount=null;b._thread=null;b._interval=2E3;b.onBuilded=FDsCommonTechniquePropertyFrame_onBuilded;b.onDataChanged=FDsCommonTechniquePropertyFrame_onDataChanged;b.onModeClick=FDsCommonTechniquePropertyFrame_onModeClick;b.onRefresh=FDsCommonTechniquePropertyFrame_onRefresh;b.construct=FDsCommonTechniquePropertyFrame_construct;
b.loadObject=FDsCommonTechniquePropertyFrame_loadObject;b.dispose=FDsCommonTechniquePropertyFrame_dispose;return b}function FDsCommonTechniquePropertyFrame_onBuilded(b){this.__base.FUiForm.onBuilded.call(this,b);this._controlRenderModes.addClickListener(this,this.onModeClick)}function FDsCommonTechniquePropertyFrame_onDataChanged(b){b=this._activeTechnique;b._code=this._controlCode.get();b._label=this._controlLabel.get();b._activeTechniqueCode=this._controlTechniqueCode.get()}
function FDsCommonTechniquePropertyFrame_onModeClick(b,d){var f=d.tag();this._activeTechnique._activeMode=f;this._activeSpace.dirty()}
function FDsCommonTechniquePropertyFrame_onRefresh(){if(this._statusVisible){var b=this._activeSpace,d=b.statistics(),b=b._graphicContext.statistics();this._controlFrameTick.set(d._frame.toString());this._controlProcessTick.set(d._frameProcess.toString()+" | "+d._frameDrawRenderable.toString());this._controlDrawTick.set(d._frameDraw.toString()+" | "+d._frameDrawSort.toString());this._controlClearCount.set(b._frameClearCount);this._controlModeInfo.set("FIL:"+b._frameFillModeCount+" | DEP:"+b._frameDepthModeCount+
" | CUL:"+b._frameCullModeCount+" | BLD:"+b._frameBlendModeCount);this._controlProgramCount.set(b._frameProgramCount);this._controlConstInfo.set(b._frameConstCount+" : length="+b._frameConstLength);this._controlBufferCount.set(b._frameBufferCount);this._controlTextureCount.set(b._frameTextureCount);this._controlTargetCount.set(b._frameTargetCount);this._controlDrawInfo.set(b._frameDrawCount+" : triangle="+b._frameTriangleCount);this._controlProgramTotal.set(b._programTotal);this._controlLayoutTotal.set(b._layoutTotal);
this._controlBufferInfo.set("Vertex:"+b._vertexBufferTotal+" Index:"+b._indexBufferTotal);this._controlTextureInfo.set("Flat:"+b._flatTextureTotal+" Cube:"+b._cubeTextureTotal);this._controlTargetTotal.set(b._targetTotal)}}function FDsCommonTechniquePropertyFrame_construct(){this.__base.FUiForm.construct.call(this);var b=this._thread=RClass.create(FThread);b.setInterval(this._interval);b.addProcessListener(this,this.onRefresh);RConsole.find(FThreadConsole).start(b)}
function FDsCommonTechniquePropertyFrame_loadObject(b,d){this._activeSpace=b;this._activeTechnique=d;var f=this._controlRenderModes;f.clear();for(var h=d.modes(),q=h.count(),z=0;z<q;z++){var A=h.getAt(z),B=f.createItem(null,A.code());B.setTag(A);f.push(B)}this.onRefresh()}function FDsCommonTechniquePropertyFrame_dispose(){this.__base.FUiForm.dispose.call(this)}
function FDsCommonTemplateDialog(b){b=RClass.inherits(this,b,FUiDialog);b._frameName="resource.common.dialog.TemplateDialog";b._displayModeCd=null;b._controlLayerLabel=null;b._controlDisplayLabel=null;b._controlCode=null;b._controlLabel=null;b._controlTemplateCode=null;b._controlConfirmButton=null;b._controlCancelButton=null;b.onBuilded=FDsCommonTemplateDialog_onBuilded;b.onConfirmLoad=FDsCommonTemplateDialog_onConfirmLoad;b.onConfirmClick=FDsCommonTemplateDialog_onConfirmClick;b.onCancelClick=FDsCommonTemplateDialog_onCancelClick;
b.construct=FDsCommonTemplateDialog_construct;b.setSpace=FDsCommonTemplateDialog_setSpace;b.setDisplayLabel=FDsCommonTemplateDialog_setDisplayLabel;b.setContentCode=FDsCommonTemplateDialog_setContentCode;b.setContentLabel=FDsCommonTemplateDialog_setContentLabel;b.dispose=FDsCommonTemplateDialog_dispose;return b}
function FDsCommonTemplateDialog_onBuilded(b){this.__base.FUiDialog.onBuilded.call(this,b);this._controlConfirm.addClickListener(this,this.onConfirmClick);this._controlCancel.addClickListener(this,this.onCancelClick)}function FDsCommonTemplateDialog_onConfirmLoad(b){RConsole.find(FUiDesktopConsole).hide();this.hide()}
function FDsCommonTemplateDialog_onConfirmClick(b){RConsole.find(FUiDesktopConsole).showUploading();b=new TXmlNode("Action");var d=b.create("Display");d.set("space_guid",this._spaceGuid);d.set("code",this._controlCode.get());d.set("label",this._controlLabel.get());d.set("model_guid",this._controlModelGuid.get());d.set("model_code",this._controlModelCode.get());RConsole.find(FDrTemplateConsole).createDisplay(b).addLoadListener(this,this.onConfirmLoad)}
function FDsCommonTemplateDialog_onCancelClick(b){this.hide()}function FDsCommonTemplateDialog_construct(){this.__base.FUiDialog.construct.call(this)}function FDsCommonTemplateDialog_setSpace(b){b=b.resource();this._controlSpaceGuid.set(b.guid());this._controlSpaceLabel.set(b.makeLabel())}function FDsCommonTemplateDialog_setDisplayLabel(b){this._controlDisplayLabel.set(b)}function FDsCommonTemplateDialog_setContentCode(b){this._controlCode.set(b)}
function FDsCommonTemplateDialog_setContentLabel(b){this._controlLabel.set(b)}function FDsCommonTemplateDialog_dispose(){this.__base.FUiDialog.dispose.call(this)}
function FDsSolutionCatalogContent(b){b=RClass.inherits(this,b,FUiDataTreeView,MListenerSelected);b._iconView="resource.solution.view";b._iconViewNot="resource.solution.viewno";b._activeSpace=null;b._materials=null;b.onLoaded=FDsSolutionCatalogContent_onLoaded;b.onBuild=FDsSolutionCatalogContent_onBuild;b.onLoadDisplay=FDsSolutionCatalogContent_onLoadDisplay;b.onNodeClick=FDsSolutionCatalogContent_onNodeClick;b.onNodeViewClick=FDsSolutionCatalogContent_onNodeViewClick;b.onNodeViewDoubleClick=FDsSolutionCatalogContent_onNodeViewDoubleClick;
b.lsnsSelect=null;b.construct=FDsSolutionCatalogContent_construct;b.buildPrivate=FDsSolutionCatalogContent_buildPrivate;b.buildRecommend=FDsSolutionCatalogContent_buildRecommend;b.buildGroup=FDsSolutionCatalogContent_buildGroup;b.buildCatalog=FDsSolutionCatalogContent_buildCatalog;b.selectObject=FDsSolutionCatalogContent_selectObject;b.showObject=FDsSolutionCatalogContent_showObject;b.dispose=FDsSolutionCatalogContent_dispose;return b}
function FDsSolutionCatalogContent_onLoaded(b){this.__base.FUiDataTreeView.onLoaded.call(this,b);this.buildCatalog()}function FDsSolutionCatalogContent_onBuild(b){this.__base.FUiDataTreeView.onBuild.call(this,b);this.lsnsClick.register(this,this.onNodeClick);this.loadUrl("/cloud.describe.tree.ws?action=query&code=resource.solution")}function FDsSolutionCatalogContent_onLoadDisplay(b){this.buildRecommend(b._linkNode,b)}
function FDsSolutionCatalogContent_onNodeClick(b,d){var f=d.dataPropertyGet("linker");this.selectObject(f)}
function FDsSolutionCatalogContent_onNodeViewClick(b){var d=b.treeNodeCell,f=b.treeNode.dataPropertyGet("linker");if(RClass.isClass(f,FDisplay))if(b.ctrlKey){for(var h=this._displays,q=h.count()-1;0<=q;q--){var z=h.get(q);z.dataPropertyGet("linker")._visible=!1;z.cell("view").setIcon(this._iconViewNot)}f._visible=!0;d.setIcon(this._iconView)}else f._visible=!f._visible,d.setIcon(f._visible?this._iconView:this._iconViewNot);if(RClass.isClass(f,FDrawable))if(b.ctrlKey){h=this._renderables;for(q=h.count()-
1;0<=q;q--)z=h.get(q),z.dataPropertyGet("linker")._visible=!1,z.cell("view").setIcon(this._iconViewNot);f._visible=!0;d.setIcon(this._iconView)}else f._visible=!f._visible,d.setIcon(f._visible?this._iconView:this._iconViewNot);if(RClass.isClass(f,FG3dMaterial))if(b.ctrlKey){b=this._materials;for(q=b.count()-1;0<=q;q--)h=b.get(q),h.dataPropertyGet("linker")._visible=!1,h.cell("view").setIcon(this._iconViewNot);f._visible=!0;d.setIcon(this._iconView)}else f._visible=!f._visible,d.setIcon(f._visible?
this._iconView:this._iconViewNot)}
function FDsSolutionCatalogContent_onNodeViewDoubleClick(b){b=b.treeNode;var d=b.dataPropertyGet("linker");if(RClass.isClass(d,FDisplay))for(var d=this._displays,f=d.count()-1;0<=f;f--)b=d.get(f),b.dataPropertyGet("linker")._visible=!0,b.cell("view").setIcon(this._iconView);if(RClass.isClass(d,FDrawable))for(d=this._renderables,f=d.count()-1;0<=f;f--)b=d.get(f),b.dataPropertyGet("linker")._visible=!0,b.cell("view").setIcon(this._iconView);if(RClass.isClass(d,FG3dMaterial))for(d=this._materials,f=
d.count()-1;0<=f;f--)b=d.get(f),b.dataPropertyGet("linker")._visible=!0,b.cell("view").setIcon(this._iconView)}function FDsSolutionCatalogContent_construct(){this.__base.FUiDataTreeView.construct.call(this);this._renderables=new TObjects;this._materials=new TObjects}function FDsSolutionCatalogContent_buildTechnique(b,d){var f=this.createNode();f.setLabel("Technique");f.setTypeCode("technique");f.dataPropertySet("linker",d);b.appendNode(f)}
function FDsSolutionCatalogContent_buildPrivate(b){var d=this.createNode();d.setTypeCode("space");d.setLabel("\u5168\u90e8\u9879\u76ee");b.appendNode(d);d=this.createNode();d.setTypeCode("space");d.setLabel("\u6536\u85cf\u9879\u76ee");b.appendNode(d);d=this.createNode();d.setTypeCode("space");d.setLabel("\u6700\u8fd1\u4f7f\u7528");b.appendNode(d)}
function FDsSolutionCatalogContent_buildRecommend(b){var d=this.createNode();d.setTypeCode("space");d.setLabel("\u672c\u5468\u6392\u884c");b.appendNode(d);d=this.createNode();d.setTypeCode("space");d.setLabel("\u672c\u6708\u6392\u884c");b.appendNode(d);d=this.createNode();d.setTypeCode("space");d.setLabel("\u5168\u90e8\u6392\u884c");b.appendNode(d)}
function FDsSolutionCatalogContent_buildGroup(b){var d=this.createNode();d.setTypeCode("space");d.setLabel("\u6c7d\u8f66");b.appendNode(d);d=this.createNode();d.setTypeCode("space");d.setLabel("\u6559\u80b2");b.appendNode(d);d=this.createNode();d.setTypeCode("space");d.setLabel("\u4eba\u7269");b.appendNode(d)}
function FDsSolutionCatalogContent_buildCatalog(){var b=this.createNode();b.setTypeCode("space");b.setLabel("\u6211\u7684\u9879\u76ee");this.appendNode(b);this.buildPrivate(b);b=this.createNode();b.setTypeCode("space");b.setLabel("\u63a8\u8350\u9879\u76ee");this.appendNode(b);this.buildRecommend(b);b=this.createNode();b.setTypeCode("space");b.setLabel("\u9879\u76ee\u5206\u7c7b");this.appendNode(b);this.buildGroup(b)}
function FDsSolutionCatalogContent_selectObject(b){null!=b&&this.processSelectedListener(b,!0)}function FDsSolutionCatalogContent_showObject(b){if(RClass.isClass(b,FDsSceneRenderable))for(var d=this._renderables,f=d.count(),h=0;h<f;h++)d.getAt(h).dataPropertyGet("linker")==b&&this.processSelectedListener(b,!1)}
function FDsSolutionCatalogContent_dispose(){this._displays=RObject.dispose(this._displays);this._renderables=RObject.dispose(this._renderables);this._materials=RObject.dispose(this._materials);this.__base.FUiDataTreeView.dispose.call(this)}
function FDsSolutionCatalogToolBar(b){b=RClass.inherits(this,b,FUiToolBar);b._frameName="resource.private.solution.CatalogToolBar";b._canvasModeCd=EDsCanvasMode.Drop;b._dropButton=null;b._selectButton=null;b._translateButton=null;b._rotationButton=null;b._scaleButton=null;b._lookFrontButton=null;b._lookUpButton=null;b._lookLeftButton=null;b._playButton=null;b._viewButton=null;b.onBuilded=FDsSolutionCatalogToolBar_onBuilded;b.onModeClick=FDsSolutionCatalogToolBar_onModeClick;b.onRotationClick=FDsSolutionCatalogToolBar_onRotationClick;
b.construct=FDsSolutionCatalogToolBar_construct;b.dispose=FDsSolutionCatalogToolBar_dispose;return b}function FDsSolutionCatalogToolBar_onBuilded(b){this.__base.FUiToolBar.onBuilded.call(this,b)}function FDsSolutionCatalogToolBar_onModeClick(b){this._canvasModeCd=b._canvasModeCd;this._workspace._canvas.switchMode(b._canvasModeCd)}function FDsSolutionCatalogToolBar_onRotationClick(b,d){this._workspace._canvas.switchRotation(d)}
function FDsSolutionCatalogToolBar_construct(){this.__base.FUiToolBar.construct.call(this)}function FDsSolutionCatalogToolBar_dispose(){this.__base.FUiToolBar.dispose.call(this)}
function FDsSolutionFrameSet(b){b=RClass.inherits(this,b,FUiFrameSet,MUiStorage);b._frameName="resource.private.solution.FrameSet";b._storageCode=b._frameName;b._styleCatalogGround=RClass.register(b,new AStyle("_styleCatalogGround","Catalog_Ground"));b._styleCatalogToolbar=RClass.register(b,new AStyle("_styleCatalogToolbar","Catalog_Toolbar"));b._styleSearchGround=RClass.register(b,new AStyle("_styleSearchGround","List_Ground"));b._styleSearchToolbar=RClass.register(b,new AStyle("_styleCatalogToolbar",
"List_Toolbar"));b._stylePreviewGround=RClass.register(b,new AStyle("_stylePreviewGround","Property_Ground"));b._stylePreviewToolbar=RClass.register(b,new AStyle("_stylePreviewToolbar","Property_Toolbar"));b._stylePropertyGround=RClass.register(b,new AStyle("_stylePropertyGround","Property_Ground"));b._pageSize=40;b._activeResourceCd="private";b._activeProjectGuid=null;b._frameCatalog=null;b._frameCatalogToolbar=null;b._frameCatalogContent=null;b._frameList=null;b._frameListToolbar=null;b._frameListContent=
null;b._frameProperty=null;b._framePropertyToolbar=null;b._framePropertyContent=null;b._propertyFrames=null;b.onBuilded=FDsSolutionFrameSet_onBuilded;b.construct=FDsSolutionFrameSet_construct;b.findPropertyFrame=FDsSolutionFrameSet_findPropertyFrame;b.selectObject=FDsSolutionFrameSet_selectObject;b.switchContent=FDsSolutionFrameSet_switchContent;b.load=FDsSolutionFrameSet_load;b.dispose=FDsSolutionFrameSet_dispose;return b}
function FDsSolutionFrameSet_onBuilded(b){this.__base.FUiFrameSet.onBuilded.call(this,b);var d=this._frameCatalog=this.searchControl("catalogFrame");d._hPanel.className=this.styleName("Catalog_Ground");d=this._frameCatalogToolbar=this.searchControl("catalogToolbarFrame");d._hPanel.className=this.styleName("Catalog_Toolbar");this._frameCatalogContent=this.searchControl("catalogContentFrame");d=this._frameList=this.searchControl("listFrame");d._hPanel.className=this.styleName("List_Ground");d=this._frameListToolbar=
this.searchControl("listToolbarFrame");d._hPanel.className=this.styleName("List_Toolbar");this._frameListContent=this.searchControl("listContentFrame");d=this._catalogSplitter=this.searchControl("catalogSpliter");d.setAlignCd(EUiAlign.Left);d.setSizeHtml(this._frameCatalog._hPanel);d=this._catalogToolbar=RClass.create(FDsSolutionCatalogToolBar);d._frameSet=this;d.buildDefine(b);this._frameCatalogToolbar.push(d);d=this._catalogContent=RClass.create(FDsSolutionCatalogContent);d._frameSet=this;d.build(b);
this._frameCatalogContent.push(d);d=this._listToolbar=RClass.create(FDsSolutionListToolBar);d._frameSet=this;d.buildDefine(b);this._frameListToolbar.push(d);d=this._listContent=RClass.create(FDsSolutionListContent);d._frameSet=this;d.build(b);this._frameListContent.push(d);this.switchContent("private")}function FDsSolutionFrameSet_construct(){this.__base.FUiFrameSet.construct.call(this);this._propertyFrames=new TDictionary}
function FDsSolutionFrameSet_findPropertyFrame(b){var d=this._propertyFrames.get(b);d||(d=RConsole.find(FFrameConsole).get(this,b,this._framePropertyProperty._hContainer),d._workspace=this,this._propertyFrames.set(b,d));return d}
function FDsSolutionFrameSet_selectObject(b){for(var d=this._propertyFrames,f=d.count(),h=0;h<f;h++){var q=d.value(h);q.hide()}if(RClass.isClass(b,FDsSolutionListItem))q=this.findPropertyFrame(EDsFrame.SolutionProjectPropertyFrame),q.show(),q.loadObject(b),this._activeProjectGuid=b._guid;else throw new TError("Unknown select object type. (value={1})",p);}function FDsSolutionFrameSet_switchContent(b){this._activeResourceCd=b;this._listContent.serviceSearch(b,"",this._pageSize,0)}
function FDsSolutionFrameSet_load(){this._listContent.serviceSearch("private","",this._pageSize,0)}function FDsSolutionFrameSet_dispose(){this.__base.FUiFrameSet.dispose.call(this);this._propertyFrames.dispose();this._propertyFrames=null}
function FDsSolutionListContent(b){b=RClass.inherits(this,b,FUiListView);b._activeControl=null;b._activeGuid=null;b._refreshButton=null;b._saveButton=null;b._runButton=null;b.onBuilded=FDsSolutionListContent_onBuilded;b.onServiceLoad=FDsSolutionListContent_onServiceLoad;b.construct=FDsSolutionListContent_construct;b.doClickItem=FDsSolutionListContent_doClickItem;b.doDoubleClickItem=FDsSolutionListContent_doDoubleClickItem;b.serviceSearch=FDsSolutionListContent_serviceSearch;b.serviceResearch=FDsSolutionListContent_serviceResearch;
b.dispose=FDsSolutionListContent_dispose;return b}function FDsSolutionListContent_onBuilded(b){this.__base.FUiListView.onBuilded.call(this,b)}
function FDsSolutionListContent_onServiceLoad(b){b=b.root.findNode("ProjectCollection");var d=b.getInteger("page_size"),f=b.getInteger("page_count"),h=b.getInteger("page");this._frameSet._listToolbar.setNavigator(d,f,h);this.clear();b=b.nodes();d=b.count();for(f=0;f<d;f++)if(h=b.getAt(f),h.isName("Project")){var q=this.createItem(FDsSolutionListItem);q.propertyLoad(h);q._typeCd=h.get("type");q._guid=h.get("guid");q.setLabel(RString.nvl(h.get("label"),h.get("code")));q.refreshStyle();this.push(q)}RWindow.enable()}
function FDsSolutionListContent_construct(){this.__base.FUiListView.construct.call(this)}function FDsSolutionListContent_doClickItem(b){this.__base.FUiListView.doClickItem.call(this,b);this._activeControl=b;this._activeGuid=b._guid}function FDsSolutionListContent_doDoubleClickItem(b){this.__base.FUiListView.doDoubleClickItem.call(this,b);var d=b._guid;this._activeControl=b;this._activeGuid=d;this._frameSet._workspace.selectFrameSet(EDsFrameSet.PrivateProjectFrameSet,d)}
function FDsSolutionListContent_serviceSearch(b,d,f,h){this._typeCd=b;this._serach=d;this._pageSize=f;this._page=h;RWindow.disable();RConsole.find(FDrProjectConsole).doList(d,null,f,h).addLoadListener(this,this.onServiceLoad)}function FDsSolutionListContent_serviceResearch(){this.serviceSearch(this._typeCd,this._serach,this._pageSize,this._page)}function FDsSolutionListContent_dispose(){this.__base.FUiListView.dispose.call(this)}
function FDsSolutionListItem(b){b=RClass.inherits(this,b,FUiListViewItem);b.onBuild=FDsSolutionListItem_onBuild;b.refreshStyle=FDsSolutionListItem_refreshStyle;return b}function FDsSolutionListItem_onBuild(b){this.__base.FUiListViewItem.onBuild.call(this,b);b=this._hPanel;b.style.width="200px";b.style.height="150px"}function FDsSolutionListItem_refreshStyle(){this._hForm.style.backgroundImage='url("'+("/cloud.content.resource.preview.wv?type_cd="+this._typeCd+"&guid="+this._guid)+'")'}
function FDsSolutionListToolBar(b){b=RClass.inherits(this,b,FUiToolBar);b._frameName="resource.private.solution.ListToolBar";b._pageCount=0;b._page=0;b._serach=null;b._resourceTypeCd=null;b._dropButton=null;b._selectButton=null;b._translateButton=null;b._rotationButton=null;b._scaleButton=null;b._lookFrontButton=null;b._lookUpButton=null;b._lookLeftButton=null;b._playButton=null;b._viewButton=null;b.onBuilded=FDsSolutionListToolBar_onBuilded;b.onSearchClick=FDsSolutionListToolBar_onSearchClick;b.onNavigatorClick=
FDsSolutionListToolBar_onNavigatorClick;b.construct=FDsSolutionListToolBar_construct;b.setNavigator=FDsSolutionListToolBar_setNavigator;b.doNavigator=FDsSolutionListToolBar_doNavigator;b.dispose=FDsSolutionListToolBar_dispose;return b}
function FDsSolutionListToolBar_onBuilded(b){this.__base.FUiToolBar.onBuilded.call(this,b);this._controlSearchEdit.addClickListener(this,this.onSearchClick);this._controlFirstButton.addClickListener(this,this.onNavigatorClick);this._controlPriorButton.addClickListener(this,this.onNavigatorClick);this._controlNextButton.addClickListener(this,this.onNavigatorClick);this._controlLastButton.addClickListener(this,this.onNavigatorClick)}
function FDsSolutionListToolBar_onSearchClick(b){this.doNavigator(0)}function FDsSolutionListToolBar_onNavigatorClick(b){b=b.sender.name();var d=this._page;switch(b){case "firstButton":d=0;break;case "priorButton":d--;break;case "nextButton":d++;break;case "lastButton":d=this._pageCount}this.doNavigator(d)}function FDsSolutionListToolBar_construct(){this.__base.FUiToolBar.construct.call(this)}
function FDsSolutionListToolBar_setNavigator(b,d,f){this._pageSize=b;this._pageCount=d;this._page=f;this._controlPageEdit.setText(f)}function FDsSolutionListToolBar_doNavigator(b){b=RInteger.toRange(b,0,this._pageCount);var d=this._controlSearchEdit.text(),f=this._frameSet._resourceTypeCd;this._resourceTypeCd==f&&this._serach==d&&this._page==b||this._frameSet._searchContent.serviceSearch(f,d,this._pageSize,b);this._resourceTypeCd=f;this._serach=d}
function FDsSolutionListToolBar_dispose(){this.__base.FUiToolBar.dispose.call(this)}
function FDsSolutionMenuBar(b){b=RClass.inherits(this,b,FUiMenuBar);b._frameName="resource.private.solution.MenuBar";b._refreshButton=null;b._saveButton=null;b._runButton=null;b.onBuilded=FDsSolutionMenuBar_onBuilded;b.onCreateClick=FDsSolutionMenuBar_onCreateClick;b.onDeleteLoad=FDsSolutionMenuBar_onDeleteLoad;b.onDeleteExecute=FDsSolutionMenuBar_onDeleteExecute;b.onDeleteClick=FDsSolutionMenuBar_onDeleteClick;b.construct=FDsSolutionMenuBar_construct;b.dispose=FDsSolutionMenuBar_dispose;return b}
function FDsSolutionMenuBar_onBuilded(b){this.__base.FUiMenuBar.onBuilded.call(this,b);this._controlCreateButton.addClickListener(this,this.onCreateClick);this._controlDeleteButton.addClickListener(this,this.onDeleteClick)}function FDsSolutionMenuBar_onCreateClick(b){b=RConsole.find(FUiWindowConsole).find(FDsSolutionProjectDialog);b._frameSet=this._frameSet;b._workspace=this._workspace;b.showPosition(EUiPosition.Center)}
function FDsSolutionMenuBar_onDeleteLoad(b){RConsole.find(FUiDesktopConsole).hide();this._frameSet._listContent.serviceResearch()}function FDsSolutionMenuBar_onDeleteExecute(b){b.resultCd!=EResult.Success?RConsole.find(FUiDesktopConsole).hide():(b=this._frameSet._listContent._activeGuid,RConsole.find(FUiDesktopConsole).showUploading(),RConsole.find(FDrProjectConsole).doDelete(b).addLoadListener(this,this.onDeleteLoad))}
function FDsSolutionMenuBar_onDeleteClick(b){if(!this._frameSet._listContent.focusItem())return alert("\u8bf7\u9009\u4e2d\u540e\u518d\u70b9\u51fb\u5220\u9664");RConsole.find(FUiMessageConsole).showConfirm("\u8bf7\u786e\u8ba4\u662f\u5426\u5220\u9664\u5f53\u524d\u9879\u76ee\uff1f").addResultListener(this,this.onDeleteExecute)}function FDsSolutionMenuBar_construct(){this.__base.FUiMenuBar.construct.call(this)}function FDsSolutionMenuBar_dispose(){this.__base.FUiMenuBar.dispose.call(this)}
function FDsSolutionProjectDialog(b){b=RClass.inherits(this,b,FUiDialog);b._frameName="resource.private.solution.ProjectDialog";b._resourceTypeCd="private";b._controlPrivateButton=null;b._controlTeamButton=null;b._controlShareButton=null;b.onBuilded=FDsSolutionProjectDialog_onBuilded;b.onConfirmLoad=FDsSolutionProjectDialog_onConfirmLoad;b.onConfirmClick=FDsSolutionProjectDialog_onConfirmClick;b.onCancelClick=FDsSolutionProjectDialog_onCancelClick;b.construct=FDsSolutionProjectDialog_construct;b.dispose=
FDsSolutionProjectDialog_dispose;return b}function FDsSolutionProjectDialog_onBuilded(b){this.__base.FUiDialog.onBuilded.call(this,b);this._controlConfirmButton.addClickListener(this,this.onConfirmClick);this._controlCancelButton.addClickListener(this,this.onCancelClick)}function FDsSolutionProjectDialog_onConfirmLoad(b){this._frameSet._listContent.serviceResearch();this.hide();RWindow.enable()}
function FDsSolutionProjectDialog_onConfirmClick(b){RWindow.disable();b=this._controlCode.get();var d=this._controlLabel.get(),f=RClass.create(FDrProject);f.setCode(b);f.setLabel(d);RConsole.find(FDrProjectConsole).doCreate(f).addLoadListener(this,this.onConfirmLoad)}function FDsSolutionProjectDialog_onCancelClick(b){this.hide()}function FDsSolutionProjectDialog_construct(){this.__base.FUiDialog.construct.call(this)}
function FDsSolutionProjectDialog_dispose(){this.__base.FUiDialog.dispose.call(this)}
function FDsSolutionProjectProperty(b){b=RClass.inherits(this,b,FUiForm);b._visible=!1;b._workspace=null;b._activeSpace=null;b._activeCamera=null;b._controlGuid=null;b._controlCode=null;b._controlLabel=null;b._controlPosition=null;b._controlDirection=null;b.onBuilded=FDsSolutionProjectProperty_onBuilded;b.onDataChanged=FDsSolutionProjectProperty_onDataChanged;b.onLoadProject=FDsSolutionProjectProperty_onLoadProject;b.construct=FDsSolutionProjectProperty_construct;b.loadObject=FDsSolutionProjectProperty_loadObject;
b.dispose=FDsSolutionProjectProperty_dispose;return b}function FDsSolutionProjectProperty_onBuilded(b){this.__base.FUiForm.onBuilded.call(this,b)}function FDsSolutionProjectProperty_onDataChanged(b){b=this._activeCamera;var d=b.resource();d.position().assign(this._controlPosition.get());d.direction().assign(this._controlDirection.get());b.position().assign(d.position());b.direction().assign(d.direction());b.update()}
function FDsSolutionProjectProperty_onLoadProject(b){b=b.root.findNode("Project");this._controlCode.set(b.get("code"));this._controlLabel.set(b.get("label"))}function FDsSolutionProjectProperty_construct(){this.__base.FUiForm.construct.call(this)}function FDsSolutionProjectProperty_loadObject(b){b=b._guid;this._controlGuid.set(b);RConsole.find(FDrProjectConsole).doQuery(b).addLoadListener(this,this.onLoadProject)}
function FDsSolutionProjectProperty_dispose(){this.__base.FUiForm.dispose.call(this)}
function FDsSolutionPropertyContent(b){b=RClass.inherits(this,b,FDsCanvas);b._activeSpace=null;b._canvasModeCd=EDsCanvasMode.Drop;b._canvasMoveCd=EDsCanvasDrag.Unknown;b._optionRotation=!1;b._rotation=null;b._capturePosition=null;b._captureMatrix=null;b._captureRotation=null;b._dimensional=null;b._selectObject=null;b._selectBoundBox=null;b._selectRenderables=null;b._cameraMoveRate=8;b._cameraKeyRotation=3;b._cameraMouseRotation=.005;b._templateMatrix=null;b._templateRenderable=null;b._templateFace=
null;b._templateTranslation=null;b._templateRotation=null;b._templateScale=null;b._templateViewScale=.05;b.onBuild=FDsSolutionPropertyContent_onBuild;b.onMouseCaptureStart=FDsSolutionPropertyContent_onMouseCaptureStart;b.onMouseCapture=FDsSolutionPropertyContent_onMouseCapture;b.onMouseCaptureStop=FDsSolutionPropertyContent_onMouseCaptureStop;b.onEnterFrame=FDsSolutionPropertyContent_onEnterFrame;b.onMeshLoad=FDsSolutionPropertyContent_onMeshLoad;b.oeResize=FDsSolutionPropertyContent_oeResize;b.oeRefresh=
FDsSolutionPropertyContent_oeRefresh;b.construct=FDsSolutionPropertyContent_construct;b.innerSelectDisplay=FDsSolutionPropertyContent_innerSelectDisplay;b.innerSelectLayer=FDsSolutionPropertyContent_innerSelectLayer;b.switchRotation=FDsSolutionPropertyContent_switchRotation;b.reloadRegion=FDsSolutionPropertyContent_reloadRegion;b.loadMeshByGuid=FDsSolutionPropertyContent_loadMeshByGuid;b.loadMeshByCode=FDsSolutionPropertyContent_loadMeshByCode;b.dispose=FDsSolutionPropertyContent_dispose;return b}
function FDsSolutionPropertyContent_onBuild(b){this.__base.FDsCanvas.onBuild.call(this,b)}
function FDsSolutionPropertyContent_onMouseCaptureStart(b){var d=this._activeSpace;if(d){var f=this._activeSpace.region(),f=RConsole.find(FG3dTechniqueConsole).find(this._graphicContext,FG3dSelectTechnique).test(f,b.offsetX,b.offsetY);this.selectRenderable(f);this._capturePosition.set(b.clientX,b.clientY);this._captureRotation.assign(d.camera()._rotation);f&&(f=f.display(),this._captureMatrix.assign(f.matrix()));this._templateMatrix.identity();if(this._templateFace)for(this._templateFaceMatrix.assign(this._templateFace.matrix()),
b=this._selectRenderables,d=b.count()-1;0<=d;d--)f=b.getAt(d),f._dragMatrix||(f._dragMatrix=new SMatrix3d),f._dragMatrix.assign(f.matrix());RHtml.cursorSet(this._hPanel,EUiCursor.Pointer)}}
function FDsSolutionPropertyContent_onMouseCapture(b){if(this._activeSpace){var d=b.clientX-this._capturePosition.x,f=b.clientY-this._capturePosition.y,h=this._canvasMoveCd,q=this._templateFace;b=this._templateMatrix;switch(this._canvasModeCd){case EDsCanvasMode.Drop:var h=this._activeSpace.camera().rotation(),z=this._captureRotation;h.x=z.x-f*this._cameraMouseRotation;h.y=z.y-d*this._cameraMouseRotation;break;case EDsCanvasMode.Translate:q&&(h==EDsCanvasDrag.X?b.tx=d/10:h==EDsCanvasDrag.Y?b.ty=-f/
10:h==EDsCanvasDrag.Z&&(b.tz=d/10));break;case EDsCanvasMode.Rotation:q&&(h==EDsCanvasDrag.X?b.rx=d/10:h==EDsCanvasDrag.Y?b.ry=-f/10:h==EDsCanvasDrag.Z&&(b.rz=d/10));break;case EDsCanvasMode.Scale:q&&(h==EDsCanvasDrag.X?b.sx=d/10:h==EDsCanvasDrag.Y?b.sy=-f/10:h==EDsCanvasDrag.Z?b.sz=d/10:h==EDsCanvasDrag.All&&(b.sx=d/10,b.sy=d/10,b.sz=d/10))}if(q)for(q.matrix().merge(this._templateFaceMatrix,b),d=this._selectRenderables,f=d.count()-1;0<=f;f--)h=d.getAt(f),h._matrix.merge(h._dragMatrix,b)}}
function FDsSolutionPropertyContent_onMouseCaptureStop(b){RHtml.cursorSet(this._hPanel,EUiCursor.Auto)}
function FDsSolutionPropertyContent_onEnterFrame(){var b=this._activeSpace;if(b){var d=b.timer().spanSecond(),b=b.camera(),f=this._cameraMoveRate*d,d=this._cameraKeyRotation*d,h=RKeyboard.isPress(EStageKey.Forward),q=RKeyboard.isPress(EStageKey.Back);h&&!q&&b.doWalk(f);!h&&q&&b.doWalk(-f);h=RKeyboard.isPress(EStageKey.Up);q=RKeyboard.isPress(EStageKey.Down);h&&!q&&b.doFly(f);!h&&q&&b.doFly(-f);f=RKeyboard.isPress(EStageKey.RotationLeft);h=RKeyboard.isPress(EStageKey.RotationRight);f&&!h&&b.doYaw(d);
!f&&h&&b.doYaw(-d);f=RKeyboard.isPress(EStageKey.RotationUp);h=RKeyboard.isPress(EStageKey.RotationDown);f&&!h&&b.doPitch(d);!f&&h&&b.doPitch(-d);b.update();this._optionRotation&&(d=this._rotation,b=this._activeSpace._display.matrix(),b.setRotation(b.rx,b.ry+d.y,b.rz),b.update(),d.y=.01)}}
function FDsSolutionPropertyContent_onMeshLoad(b){b=this._activeSpace.region();var d=b.camera();d.setPosition(0,3,-10);d.lookAt(0,3,0);d.update();var f=this._hPanel,d=d.projection();d.size().set(f.width,f.height);d._angle=45;d.update();b=b.directionalLight().camera();b.setPosition(10,10,0);b.lookAt(0,0,0);b.update();this.processLoadListener(this)}
function FDsSolutionPropertyContent_oeResize(b){this.__base.FDsCanvas.oeResize.call(this,b);var d=this._hPanel;b=d.offsetWidth;var d=d.offsetHeight,f=this._activeSpace;f&&(f=f.camera().projection(),f.size().set(b,d),f.update());return EEventStatus.Stop}function FDsSolutionPropertyContent_oeRefresh(b){return EEventStatus.Stop}
function FDsSolutionPropertyContent_construct(){this.__base.FDsCanvas.construct.call(this);this._capturePosition=new SPoint2;this._captureMatrix=new SMatrix3d;this._templateMatrix=new SMatrix3d;this._templateFaceMatrix=new SMatrix3d;this._rotation=new SVector3;this._captureRotation=new SVector3;this._selectRenderables=new TObjects}
function FDsSolutionPropertyContent_innerSelectDisplay(b){b=b.renderables();for(var d=b.count(),f=0;f<d;f++){var h=b.getAt(f);RClass.isClass(h,FDsSceneRenderable)&&(this._selectRenderables.push(h),h.showBoundBox())}}function FDsSolutionPropertyContent_innerSelectLayer(b){b=b.displays();for(var d=b.count(),f=0;f<d;f++){var h=b.getAt(f);this.innerSelectDisplay(h)}}function FDsSolutionPropertyContent_switchMode(b){this._canvasModeCd=b}
function FDsSolutionPropertyContent_switchRotation(b){this._optionRotation=b}function FDsSolutionPropertyContent_reloadRegion(b){b=b.resource();this._cameraMoveRate=b.moveSpeed();this._cameraKeyRotation=b.rotationKeySpeed();this._cameraMouseRotation=b.rotationMouseSpeed()}
function FDsSolutionPropertyContent_loadMeshByGuid(b){var d=RConsole.find(FE3dMeshConsole);null!=this._activeSpace&&d.free(this._activeSpace);b=this._activeSpace=d.allocByGuid(this,b);b.addLoadListener(this,this.onMeshLoad);b._layer.pushRenderable(this._dimensional);RStage.register("mesh3d",b)}
function FDsSolutionPropertyContent_loadMeshByCode(b){var d=RConsole.find(FE3dMeshConsole);null!=this._activeSpace&&d.free(this._activeSpace);b=this._activeSpace=d.allocByCode(this,b);b.addLoadListener(this,this.onMeshLoad);b._layer.pushRenderable(this._dimensional);RStage.register("mesh3d",b)}function FDsSolutionPropertyContent_dispose(){this._rotation=RObject.dispose(this._rotation);this.__base.FDsCanvas.dispose.call(this)}
function FDsSolutionPropertyToolBar(b){b=RClass.inherits(this,b,FUiToolBar);b._frameName="resource.solution.PropertyToolBar";b._controlInsertButton=null;b._controlUpdateButton=null;b._controlDeleteButton=null;b.onBuilded=FDsSolutionPropertyToolBar_onBuilded;b.onUpdateClick=FDsSolutionPropertyToolBar_onUpdateClick;b.construct=FDsSolutionPropertyToolBar_construct;b.dispose=FDsSolutionPropertyToolBar_dispose;return b}
function FDsSolutionPropertyToolBar_onBuilded(b){this.__base.FUiToolBar.onBuilded.call(this,b);this._controlUpdateButton.addClickListener(this,this.onUpdateClick)}function FDsSolutionPropertyToolBar_onUpdateClick(b){window.location="Project.wa?do=detail&guid="+this._workspace._activeProjectGuid}function FDsSolutionPropertyToolBar_construct(){this.__base.FUiToolBar.construct.call(this)}function FDsSolutionPropertyToolBar_dispose(){this.__base.FUiToolBar.dispose.call(this)}
function FDsProjectCanvasContent(b){b=RClass.inherits(this,b,FUiListView);b._refreshButton=null;b._saveButton=null;b._runButton=null;b.onBuilded=FDsProjectCanvasContent_onBuilded;b.onServiceLoad=FDsProjectCanvasContent_onServiceLoad;b.construct=FDsProjectCanvasContent_construct;b.clickItem=FDsProjectCanvasContent_clickItem;b.serviceSearch=FDsProjectCanvasContent_serviceSearch;b.dispose=FDsProjectCanvasContent_dispose;return b}
function FDsProjectCanvasContent_onBuilded(b){this.__base.FUiListView.onBuilded.call(this,b)}
function FDsProjectCanvasContent_onServiceLoad(b){var d=b.root.findNode("ProjectCollection");b=d.getInteger("page_size");var f=d.getInteger("page_count"),d=d.getInteger("page");this._workspace._searchToolbar.setNavigator(b,f,d);this.clear();b=xitems.nodes();f=b.count();for(d=0;d<f;d++){var h=b.getAt(d);if(h.isName("Project")){var q=this.createItem(FDsProjectSearchItem);q.propertyLoad(h);q._typeCd=h.get("type");q._guid=h.get("guid");q.setLabel(RString.nvl(h.get("label"),h.get("code")));q.refreshStyle();
this.push(q)}}RWindow.enable()}function FDsProjectCanvasContent_construct(){this.__base.FUiListView.construct.call(this)}function FDsProjectCanvasContent_clickItem(b){var d=this._workspace._previewContent;d._activeItem=b;d.loadMeshByGuid(b._guid)}function FDsProjectCanvasContent_serviceSearch(b,d,f,h){RWindow.disable();RConsole.find(FDrResourceConsole).fetch(b,d,null,f,h).addLoadListener(this,this.onServiceLoad)}
function FDsProjectCanvasContent_dispose(){this.__base.FUiListView.dispose.call(this)}
function FDsProjectCanvasPreviewToolBar(b){b=RClass.inherits(this,b,FUiToolBar);b._frameName="resource.project.CanvasPreviewToolBar";b._pageCount=0;b._page=0;b._serach=null;b._resourceTypeCd=null;b._dropButton=null;b._selectButton=null;b._translateButton=null;b._rotationButton=null;b._scaleButton=null;b._lookFrontButton=null;b._lookUpButton=null;b._lookLeftButton=null;b._playButton=null;b._viewButton=null;b.onBuilded=FDsProjectCanvasPreviewToolBar_onBuilded;b.onSearchClick=FDsProjectCanvasPreviewToolBar_onSearchClick;
b.onNavigatorClick=FDsProjectCanvasPreviewToolBar_onNavigatorClick;b.construct=FDsProjectCanvasPreviewToolBar_construct;b.setNavigator=FDsProjectCanvasPreviewToolBar_setNavigator;b.doNavigator=FDsProjectCanvasPreviewToolBar_doNavigator;b.dispose=FDsProjectCanvasPreviewToolBar_dispose;return b}function FDsProjectCanvasPreviewToolBar_onBuilded(b){this.__base.FUiToolBar.onBuilded.call(this,b)}function FDsProjectCanvasPreviewToolBar_onSearchClick(b){this.doNavigator(0)}
function FDsProjectCanvasPreviewToolBar_onNavigatorClick(b){b=b.sender.name();var d=this._page;switch(b){case "firstButton":d=0;break;case "priorButton":d--;break;case "nextButton":d++;break;case "lastButton":d=this._pageCount}this.doNavigator(d)}function FDsProjectCanvasPreviewToolBar_construct(){this.__base.FUiToolBar.construct.call(this)}function FDsProjectCanvasPreviewToolBar_setNavigator(b,d,f){this._pageSize=b;this._pageCount=d;this._page=f;this._controlPageEdit.setText(f)}
function FDsProjectCanvasPreviewToolBar_doNavigator(b){b=RInteger.toRange(b,0,this._pageCount);var d=this._controlSearchEdit.text(),f=this._workspace._resourceTypeCd;this._resourceTypeCd==f&&this._serach==d&&this._page==b||this._workspace._searchContent.serviceSearch(f,d,this._pageSize,b);this._resourceTypeCd=f;this._serach=d}function FDsProjectCanvasPreviewToolBar_dispose(){this.__base.FUiToolBar.dispose.call(this)}
function FDsProjectCanvasSpaceToolBar(b){b=RClass.inherits(this,b,FUiToolBar);b._frameName="resource.project.CanvasSpaceToolBar";b._pageCount=0;b._page=0;b._serach=null;b._resourceTypeCd=null;b._dropButton=null;b._selectButton=null;b._translateButton=null;b._rotationButton=null;b._scaleButton=null;b._lookFrontButton=null;b._lookUpButton=null;b._lookLeftButton=null;b._playButton=null;b._viewButton=null;b.onBuilded=FDsProjectCanvasSpaceToolBar_onBuilded;b.onSearchClick=FDsProjectCanvasSpaceToolBar_onSearchClick;
b.onNavigatorClick=FDsProjectCanvasSpaceToolBar_onNavigatorClick;b.construct=FDsProjectCanvasSpaceToolBar_construct;b.setNavigator=FDsProjectCanvasSpaceToolBar_setNavigator;b.doNavigator=FDsProjectCanvasSpaceToolBar_doNavigator;b.dispose=FDsProjectCanvasSpaceToolBar_dispose;return b}function FDsProjectCanvasSpaceToolBar_onBuilded(b){this.__base.FUiToolBar.onBuilded.call(this,b)}function FDsProjectCanvasSpaceToolBar_onSearchClick(b){this.doNavigator(0)}
function FDsProjectCanvasSpaceToolBar_onNavigatorClick(b){b=b.sender.name();var d=this._page;switch(b){case "firstButton":d=0;break;case "priorButton":d--;break;case "nextButton":d++;break;case "lastButton":d=this._pageCount}this.doNavigator(d)}function FDsProjectCanvasSpaceToolBar_construct(){this.__base.FUiToolBar.construct.call(this)}function FDsProjectCanvasSpaceToolBar_setNavigator(b,d,f){this._pageSize=b;this._pageCount=d;this._page=f;this._controlPageEdit.setText(f)}
function FDsProjectCanvasSpaceToolBar_doNavigator(b){b=RInteger.toRange(b,0,this._pageCount);var d=this._controlSearchEdit.text(),f=this._workspace._resourceTypeCd;this._resourceTypeCd==f&&this._serach==d&&this._page==b||this._workspace._searchContent.serviceSearch(f,d,this._pageSize,b);this._resourceTypeCd=f;this._serach=d}function FDsProjectCanvasSpaceToolBar_dispose(){this.__base.FUiToolBar.dispose.call(this)}
function FDsProjectCatalogContent(b){b=RClass.inherits(this,b,FUiDataTreeView,MListenerSelected);b._iconView="design3d.mesh.view";b._iconViewNot="design3d.mesh.viewno";b._activeSpace=null;b._materials=null;b.onBuild=FDsProjectCatalogContent_onBuild;b.onLoadDisplay=FDsProjectCatalogContent_onLoadDisplay;b.onNodeClick=FDsProjectCatalogContent_onNodeClick;b.onNodeViewClick=FDsProjectCatalogContent_onNodeViewClick;b.onNodeViewDoubleClick=FDsProjectCatalogContent_onNodeViewDoubleClick;b.lsnsSelect=null;
b.construct=FDsProjectCatalogContent_construct;b.buildTechnique=FDsProjectCatalogContent_buildTechnique;b.buildRegion=FDsProjectCatalogContent_buildRegion;b.buildRenderable=FDsProjectCatalogContent_buildRenderable;b.buildDisplay=FDsProjectCatalogContent_buildDisplay;b.buildSpace=FDsProjectCatalogContent_buildSpace;b.selectObject=FDsProjectCatalogContent_selectObject;b.showObject=FDsProjectCatalogContent_showObject;b.dispose=FDsProjectCatalogContent_dispose;return b}
function FDsProjectCatalogContent_onBuild(b){this.__base.FUiDataTreeView.onBuild.call(this,b);this.lsnsClick.register(this,this.onNodeClick);this.loadUrl("/cloud.describe.tree.ws?action=query&code=resource.project")}function FDsProjectCatalogContent_onLoadDisplay(b){this.buildRenderable(b._linkNode,b)}function FDsProjectCatalogContent_onNodeClick(b,d){var f=d.dataPropertyGet("linker");this.selectObject(f)}
function FDsProjectCatalogContent_onNodeViewClick(b){var d=b.treeNodeCell,f=b.treeNode.dataPropertyGet("linker");if(RClass.isClass(f,FDisplay))if(b.ctrlKey){for(var h=this._displays,q=h.count()-1;0<=q;q--){var z=h.get(q);z.dataPropertyGet("linker")._visible=!1;z.cell("view").setIcon(this._iconViewNot)}f._visible=!0;d.setIcon(this._iconView)}else f._visible=!f._visible,d.setIcon(f._visible?this._iconView:this._iconViewNot);if(RClass.isClass(f,FDrawable))if(b.ctrlKey){h=this._renderables;for(q=h.count()-
1;0<=q;q--)z=h.get(q),z.dataPropertyGet("linker")._visible=!1,z.cell("view").setIcon(this._iconViewNot);f._visible=!0;d.setIcon(this._iconView)}else f._visible=!f._visible,d.setIcon(f._visible?this._iconView:this._iconViewNot);if(RClass.isClass(f,FG3dMaterial))if(b.ctrlKey){b=this._materials;for(q=b.count()-1;0<=q;q--)h=b.get(q),h.dataPropertyGet("linker")._visible=!1,h.cell("view").setIcon(this._iconViewNot);f._visible=!0;d.setIcon(this._iconView)}else f._visible=!f._visible,d.setIcon(f._visible?
this._iconView:this._iconViewNot)}
function FDsProjectCatalogContent_onNodeViewDoubleClick(b){b=b.treeNode;var d=b.dataPropertyGet("linker");if(RClass.isClass(d,FDisplay))for(var d=this._displays,f=d.count()-1;0<=f;f--)b=d.get(f),b.dataPropertyGet("linker")._visible=!0,b.cell("view").setIcon(this._iconView);if(RClass.isClass(d,FDrawable))for(d=this._renderables,f=d.count()-1;0<=f;f--)b=d.get(f),b.dataPropertyGet("linker")._visible=!0,b.cell("view").setIcon(this._iconView);if(RClass.isClass(d,FG3dMaterial))for(d=this._materials,f=d.count()-
1;0<=f;f--)b=d.get(f),b.dataPropertyGet("linker")._visible=!0,b.cell("view").setIcon(this._iconView)}function FDsProjectCatalogContent_construct(){this.__base.FUiDataTreeView.construct.call(this);this._renderables=new TObjects;this._materials=new TObjects}function FDsProjectCatalogContent_buildTechnique(b,d){var f=this.createNode();f.setLabel("Technique");f.setTypeCode("technique");f.dataPropertySet("linker",d);b.appendNode(f)}
function FDsProjectCatalogContent_buildRegion(b,d){var f=this.createNode();f.setLabel("Region");f.setTypeCode("region");f.dataPropertySet("linker",d);b.appendNode(f);var h=this.createNode();h.setLabel("Camera");h.setTypeCode("camera");h.dataPropertySet("linker",d.camera());f.appendNode(h);h=this.createNode();h.setLabel("Light");h.setTypeCode("light");h.dataPropertySet("linker",d.directionalLight());f.appendNode(h)}
function FDsProjectCatalogContent_buildRenderable(b,d){var f=d._renderable._material,h=this.createNode();h.setTypeCode("material");h.setLabel("Material");h.dataPropertySet("linker",f);this._materials.push(h);b.appendNode(h);f=d._renderable;h=this.createNode();h.setTypeCode("renderable");h.setLabel("Renderable");h.dataPropertySet("linker",f);this._renderables.push(h);b.appendNode(h)}
function FDsProjectCatalogContent_buildDisplay(b,d){var f=this.createNode();f.setTypeCode("display");f.setLabel("Mesh");f.dataPropertySet("linker",d);b.appendNode(f);this.buildRenderable(f,d)}
function FDsProjectCatalogContent_buildSpace(b){var d=b.resource();this._activeSpace=b;var f=this.createNode();f.setTypeCode("space");f.setLabel(d.code());f.setNote(d.label());f.dataPropertySet("linker",b);this.appendNode(f);this.buildTechnique(f,b.technique());this.buildRegion(f,b.region());this.buildDisplay(f,b._display);f.click()}function FDsProjectCatalogContent_selectObject(b){null!=b&&this.processSelectedListener(b,!0)}
function FDsProjectCatalogContent_showObject(b){if(RClass.isClass(b,FDsSceneRenderable))for(var d=this._renderables,f=d.count(),h=0;h<f;h++)d.getAt(h).dataPropertyGet("linker")==b&&this.processSelectedListener(b,!1)}function FDsProjectCatalogContent_dispose(){this._displays=RObject.dispose(this._displays);this._renderables=RObject.dispose(this._renderables);this._materials=RObject.dispose(this._materials);this.__base.FUiDataTreeView.dispose.call(this)}
function FDsProjectCatalogToolBar(b){b=RClass.inherits(this,b,FUiToolBar);b._frameName="resource.project.CatalogToolBar";b._canvasModeCd=EDsCanvasMode.Drop;b._dropButton=null;b._selectButton=null;b._translateButton=null;b._rotationButton=null;b._scaleButton=null;b._lookFrontButton=null;b._lookUpButton=null;b._lookLeftButton=null;b._playButton=null;b._viewButton=null;b.onBuilded=FDsProjectCatalogToolBar_onBuilded;b.onModeClick=FDsProjectCatalogToolBar_onModeClick;b.onRotationClick=FDsProjectCatalogToolBar_onRotationClick;
b.construct=FDsProjectCatalogToolBar_construct;b.dispose=FDsProjectCatalogToolBar_dispose;return b}function FDsProjectCatalogToolBar_onBuilded(b){this.__base.FUiToolBar.onBuilded.call(this,b)}function FDsProjectCatalogToolBar_onModeClick(b){this._canvasModeCd=b._canvasModeCd;this._workspace._canvas.switchMode(b._canvasModeCd)}function FDsProjectCatalogToolBar_onRotationClick(b,d){this._workspace._canvas.switchRotation(d)}
function FDsProjectCatalogToolBar_construct(){this.__base.FUiToolBar.construct.call(this)}function FDsProjectCatalogToolBar_dispose(){this.__base.FUiToolBar.dispose.call(this)}
function FDsProjectFrameSet(b){b=RClass.inherits(this,b,FUiFrameSet);b._frameName="resource.project.FrameSet";b._stylePageControl=RClass.register(b,new AStyle("_stylePageControl","PageControl"));b._styleToolbarGround=RClass.register(b,new AStyle("_styleToolbarGround","Toolbar_Ground"));b._styleStatusbarGround=RClass.register(b,new AStyle("_styleStatusbarGround","Statusbar_Ground"));b._styleCatalogGround=RClass.register(b,new AStyle("_styleCatalogGround","Catalog_Ground"));b._styleCatalogContent=RClass.register(b,
new AStyle("_styleCatalogContent","Catalog_Content"));b._styleCanvasGround=RClass.register(b,new AStyle("_styleCanvasGround","Canvas_Ground"));b._styleCanvasContent=RClass.register(b,new AStyle("_styleCanvasContent","Canvas_Content"));b._stylePropertyGround=RClass.register(b,new AStyle("_stylePropertyGround","Property_Ground"));b._stylePropertyContent=RClass.register(b,new AStyle("_stylePropertyContent","Property_Content"));b._activeSpace=null;b._activeMesh=null;b._framesetMain=null;b._framesetBody=
null;b._frameToolBar=null;b._frameBody=null;b._frameProperty=null;b._frameCatalog=null;b._frameCanvas=null;b._frameStatusBar=null;b._propertyFrames=null;b.onBuilded=FDsProjectFrameSet_onBuilded;b.onMeshLoad=FDsProjectFrameSet_onMeshLoad;b.onCatalogSelected=FDsProjectFrameSet_onCatalogSelected;b.construct=FDsProjectFrameSet_construct;b.findPropertyFrame=FDsProjectFrameSet_findPropertyFrame;b.loadByGuid=FDsProjectFrameSet_loadByGuid;b.dispose=FDsProjectFrameSet_dispose;return b}
function FDsProjectFrameSet_onBuilded(b){this.__base.FUiFrameSet.onBuilded.call(this,b);b=this._frameCatalog=this.searchControl("catalogFrame");b._hPanel.className=this.styleName("Catalog_Ground");b=this._frameCatalogPageControl=this.searchControl("catalogPageControl");b._hPanel.className=this.styleName("PageControl");b=this._frameSceneListToolBar=this.searchControl("sceneListToolbarFrame");b._hPanel.className=this.styleName("Toolbar_Ground");b=this._frameSceneListContent=this.searchControl("sceneListContentFrame");
b._hPanel.className=this.styleName("Catalog_Content");b=this._frameSceneCatalogToolBar=this.searchControl("sceneCatalogToolbarFrame");b._hPanel.className=this.styleName("Toolbar_Ground");b=this._frameSceneCatalogContent=this.searchControl("sceneCatalogContentFrame");b._hPanel.className=this.styleName("Catalog_Content");b=this._frameCanvas=this.searchControl("canvasFrame");b._hPanel.className=this.styleName("Canvas_Ground");b=this._frameCanvasPageControl=this.searchControl("canvasPageControl");b._hPanel.className=
this.styleName("PageControl");b=this._frameCanvasSpaceToolBar=this.searchControl("canvasSpaceToolbarFrame");b._hPanel.className=this.styleName("Toolbar_Ground");b=this._frameCanvasSpaceContent=this.searchControl("canvasSpaceContentFrame");b._hPanel.className=this.styleName("Canvas_Content");b=this._frameCanvasPreviewToolBar=this.searchControl("canvasPreviewToolbarFrame");b._hPanel.className=this.styleName("Toolbar_Ground");b=this._frameCanvasPreviewContent=this.searchControl("canvasPreviewContentFrame");
b._hPanel.className=this.styleName("Canvas_Content");b=this._frameProperty=this.searchControl("propertyFrame");b._hPanel.className=this.styleName("Property_Ground");b=this._framePropertyPageControl=this.searchControl("propertyPageControl");b._hPanel.className=this.styleName("PageControl");b=this._framePropertyAttributeToolBar=this.searchControl("propertyAttributeToolbarFrame");b._hPanel.className=this.styleName("Toolbar_Ground");b=this._framePropertyAttributeContent=this.searchControl("propertyAttributeContentFrame");
b._hPanel.className=this.styleName("Property_Content");b=this._catalogSplitter=this.searchControl("catalogSpliter");b.setAlignCd(EUiAlign.Left);b.setSizeHtml(this._frameCatalog._hPanel);b=this._propertySpliter=this.searchControl("propertySpliter");b.setAlignCd(EUiAlign.Right);b.setSizeHtml(this._frameProperty._hPanel)}function FDsProjectFrameSet_onMeshLoad(b){this._activeSpace=b._activeSpace;this._catalog.buildSpace(this._activeSpace)}
function FDsProjectFrameSet_onCatalogSelected(b,d){for(var f=this._activeSpace,h=this._propertyFrames,q=h.count(),z=0;z<q;z++){var A=h.value(z);A.hide()}if(RClass.isClass(b,FE3dStage))A=this.findPropertyFrame(EDsFrame.MeshSpacePropertyFrame),A.show(),A.loadObject(f,f);else if(RClass.isClass(b,FG3dTechnique))A=this.findPropertyFrame(EDsFrame.MeshTechniquePropertyFrame),A.show(),A.loadObject(f,b);else if(RClass.isClass(b,FE3dRegion))A=this.findPropertyFrame(EDsFrame.MeshRegionPropertyFrame),A.show(),
A.loadObject(f,b);else if(RClass.isClass(b,FE3dCamera))A=this.findPropertyFrame(EDsFrame.MeshCameraPropertyFrame),A.show(),A.loadObject(f,b);else if(RClass.isClass(b,FG3dDirectionalLight))A=this.findPropertyFrame(EDsFrame.MeshLightPropertyFrame),A.show(),A.loadObject(f,b);else if(RClass.isClass(b,FE3dMeshDisplay))A=this.findPropertyFrame(EDsFrame.MeshDisplayPropertyFrame),A.show(),A.loadObject(f,b);else if(RClass.isClass(b,FG3dMaterial))A=this.findPropertyFrame(EDsFrame.MeshMaterialPropertyFrame),
A.show(),A.loadObject(f,b);else if(RClass.isClass(b,FE3dMeshRenderable))A=this.findPropertyFrame(EDsFrame.MeshRenderablePropertyFrame),A.show(),A.loadObject(f,b);else throw new TError("Unknown select object type. (value={1})",b);}function FDsProjectFrameSet_construct(){this.__base.FUiFrameSet.construct.call(this);this._propertyFrames=new TDictionary}
function FDsProjectFrameSet_findPropertyFrame(b){var d=this._propertyFrames.get(b);d||(d=RConsole.find(FFrameConsole).get(this,b,this._frameProperty._hContainer),d._workspace=this,this._propertyFrames.set(b,d));return d}function FDsProjectFrameSet_loadByGuid(b){this._activeGuid=b;this._sceneListContent.serviceList(b)}function FDsProjectFrameSet_dispose(){this.__base.FUiFrameSet.dispose.call(this);this._propertyFrames.dispose();this._propertyFrames=null}
function FDsProjectMenuBar(b){b=RClass.inherits(this,b,FUiMenuBar);b._refreshButton=null;b._saveButton=null;b._runButton=null;b.onBuilded=FDsProjectMenuBar_onBuilded;b.onSaveClick=FDsProjectMenuBar_onSaveClick;b.construct=FDsProjectMenuBar_construct;b.dispose=FDsProjectMenuBar_dispose;return b}function FDsProjectMenuBar_onBuilded(b){this.__base.FUiMenuBar.onBuilded.call(this,b);this._controlSave.addClickListener(this,this.onSaveClick)}
function FDsProjectMenuBar_onSaveClick(b){b=this._workspace._activeSpace.resource();var d=new TXmlNode;b.saveConfig(d);RConsole.find(FE3sMeshConsole).update(d)}function FDsProjectMenuBar_construct(){this.__base.FUiMenuBar.construct.call(this)}function FDsProjectMenuBar_dispose(){this.__base.FUiMenuBar.dispose.call(this)}
function FDsProjectPropertyContent(b){b=RClass.inherits(this,b,FDsCanvas);b._activeSpace=null;b._canvasModeCd=EDsCanvasMode.Drop;b._canvasMoveCd=EDsCanvasDrag.Unknown;b._optionRotation=!1;b._rotation=null;b._capturePosition=null;b._captureMatrix=null;b._captureRotation=null;b._dimensional=null;b._selectObject=null;b._selectBoundBox=null;b._selectRenderables=null;b._cameraMoveRate=8;b._cameraKeyRotation=3;b._cameraMouseRotation=.005;b._templateMatrix=null;b._templateRenderable=null;b._templateFace=
null;b._templateTranslation=null;b._templateRotation=null;b._templateScale=null;b._templateViewScale=.05;b.onBuild=FDsProjectPropertyContent_onBuild;b.onMouseCaptureStart=FDsProjectPropertyContent_onMouseCaptureStart;b.onMouseCapture=FDsProjectPropertyContent_onMouseCapture;b.onMouseCaptureStop=FDsProjectPropertyContent_onMouseCaptureStop;b.onEnterFrame=FDsProjectPropertyContent_onEnterFrame;b.onMeshLoad=FDsProjectPropertyContent_onMeshLoad;b.oeResize=FDsProjectPropertyContent_oeResize;b.oeRefresh=
FDsProjectPropertyContent_oeRefresh;b.construct=FDsProjectPropertyContent_construct;b.innerSelectDisplay=FDsProjectPropertyContent_innerSelectDisplay;b.innerSelectLayer=FDsProjectPropertyContent_innerSelectLayer;b.selectNone=FDsProjectPropertyContent_selectNone;b.selectDisplay=FDsProjectPropertyContent_selectDisplay;b.selectMaterial=FDsProjectPropertyContent_selectMaterial;b.selectRenderable=FDsProjectPropertyContent_selectRenderable;b.switchRotation=FDsProjectPropertyContent_switchRotation;b.reloadRegion=
FDsProjectPropertyContent_reloadRegion;b.loadMeshByGuid=FDsProjectPropertyContent_loadMeshByGuid;b.loadMeshByCode=FDsProjectPropertyContent_loadMeshByCode;b.dispose=FDsProjectPropertyContent_dispose;return b}function FDsProjectPropertyContent_onBuild(b){this.__base.FDsCanvas.onBuild.call(this,b)}
function FDsProjectPropertyContent_onMouseCaptureStart(b){var d=this._activeSpace;if(d){var f=this._activeSpace.region(),f=RConsole.find(FG3dTechniqueConsole).find(this._graphicContext,FG3dSelectTechnique).test(f,b.offsetX,b.offsetY);this.selectRenderable(f);this._capturePosition.set(b.clientX,b.clientY);this._captureRotation.assign(d.camera()._rotation);f&&(f=f.display(),this._captureMatrix.assign(f.matrix()));this._templateMatrix.identity();if(this._templateFace)for(this._templateFaceMatrix.assign(this._templateFace.matrix()),
b=this._selectRenderables,d=b.count()-1;0<=d;d--)f=b.getAt(d),f._dragMatrix||(f._dragMatrix=new SMatrix3d),f._dragMatrix.assign(f.matrix());RHtml.cursorSet(this._hPanel,EUiCursor.Pointer)}}
function FDsProjectPropertyContent_onMouseCapture(b){if(this._activeSpace){var d=b.clientX-this._capturePosition.x,f=b.clientY-this._capturePosition.y,h=this._canvasMoveCd,q=this._templateFace;b=this._templateMatrix;switch(this._canvasModeCd){case EDsCanvasMode.Drop:var h=this._activeSpace.camera().rotation(),z=this._captureRotation;h.x=z.x-f*this._cameraMouseRotation;h.y=z.y-d*this._cameraMouseRotation;break;case EDsCanvasMode.Translate:q&&(h==EDsCanvasDrag.X?b.tx=d/10:h==EDsCanvasDrag.Y?b.ty=-f/
10:h==EDsCanvasDrag.Z&&(b.tz=d/10));break;case EDsCanvasMode.Rotation:q&&(h==EDsCanvasDrag.X?b.rx=d/10:h==EDsCanvasDrag.Y?b.ry=-f/10:h==EDsCanvasDrag.Z&&(b.rz=d/10));break;case EDsCanvasMode.Scale:q&&(h==EDsCanvasDrag.X?b.sx=d/10:h==EDsCanvasDrag.Y?b.sy=-f/10:h==EDsCanvasDrag.Z?b.sz=d/10:h==EDsCanvasDrag.All&&(b.sx=d/10,b.sy=d/10,b.sz=d/10))}if(q)for(q.matrix().merge(this._templateFaceMatrix,b),d=this._selectRenderables,f=d.count()-1;0<=f;f--)h=d.getAt(f),h._matrix.merge(h._dragMatrix,b)}}
function FDsProjectPropertyContent_onMouseCaptureStop(b){RHtml.cursorSet(this._hPanel,EUiCursor.Auto)}
function FDsProjectPropertyContent_onEnterFrame(){var b=this._activeSpace;if(b){var d=b.timer().spanSecond(),b=b.camera(),f=this._cameraMoveRate*d,d=this._cameraKeyRotation*d,h=RKeyboard.isPress(EStageKey.Forward),q=RKeyboard.isPress(EStageKey.Back);h&&!q&&b.doWalk(f);!h&&q&&b.doWalk(-f);h=RKeyboard.isPress(EStageKey.Up);q=RKeyboard.isPress(EStageKey.Down);h&&!q&&b.doFly(f);!h&&q&&b.doFly(-f);f=RKeyboard.isPress(EStageKey.RotationLeft);h=RKeyboard.isPress(EStageKey.RotationRight);f&&!h&&b.doYaw(d);
!f&&h&&b.doYaw(-d);f=RKeyboard.isPress(EStageKey.RotationUp);h=RKeyboard.isPress(EStageKey.RotationDown);f&&!h&&b.doPitch(d);!f&&h&&b.doPitch(-d);b.update();this._optionRotation&&(d=this._rotation,b=this._activeSpace._display.matrix(),b.setRotation(b.rx,b.ry+d.y,b.rz),b.update(),d.y=.01)}}
function FDsProjectPropertyContent_onMeshLoad(b){b=this._activeSpace.region();var d=b.camera();d.setPosition(0,3,-10);d.lookAt(0,3,0);d.update();var f=this._hPanel,d=d.projection();d.size().set(f.width,f.height);d._angle=45;d.update();b=b.directionalLight().camera();b.setPosition(10,10,0);b.lookAt(0,0,0);b.update();this.processLoadListener(this)}
function FDsProjectPropertyContent_oeResize(b){this.__base.FDsCanvas.oeResize.call(this,b);var d=this._hPanel;b=d.offsetWidth;var d=d.offsetHeight,f=this._activeSpace;f&&(f=f.camera().projection(),f.size().set(b,d),f.update());return EEventStatus.Stop}function FDsProjectPropertyContent_oeRefresh(b){return EEventStatus.Stop}
function FDsProjectPropertyContent_construct(){this.__base.FDsCanvas.construct.call(this);this._capturePosition=new SPoint2;this._captureMatrix=new SMatrix3d;this._templateMatrix=new SMatrix3d;this._templateFaceMatrix=new SMatrix3d;this._rotation=new SVector3;this._captureRotation=new SVector3;this._selectRenderables=new TObjects}
function FDsProjectPropertyContent_innerSelectDisplay(b){b=b.renderables();for(var d=b.count(),f=0;f<d;f++){var h=b.getAt(f);RClass.isClass(h,FDsSceneRenderable)&&(this._selectRenderables.push(h),h.showBoundBox())}}function FDsProjectPropertyContent_innerSelectLayer(b){b=b.displays();for(var d=b.count(),f=0;f<d;f++){var h=b.getAt(f);this.innerSelectDisplay(h)}}
function FDsProjectPropertyContent_selectNone(){this._selectObject=null;for(var b=this._selectRenderables,d=b.count(),f=0;f<d;f++)b.get(f).hideBoundBox();this._selectRenderables.clear()}function FDsProjectPropertyContent_selectDisplay(b){this.selectNone();this._selectObject=b;this.innerSelectDisplay(b)}
function FDsProjectPropertyContent_selectMaterial(b){this.selectNone();this._selectObject=b;for(var d=b._display.renderables(),f=d.count(),h=0;h<f;h++){var q=d.get(h);q._materialReference==b&&(this._selectRenderables.push(q),q._optionSelected=!0,q.showBoundBox())}}
function FDsProjectPropertyContent_selectRenderable(b){if(b)switch(b._renderable._resource._code){case "ms_translation_x":this._canvasMoveCd=EDsCanvasDrag.X;this._templateRenderable=b;return;case "ms_translation_y":this._canvasMoveCd=EDsCanvasDrag.Y;this._templateRenderable=b;return;case "ms_translation_z":this._canvasMoveCd=EDsCanvasDrag.Z;this._templateRenderable=b;return;case "ms_rotation_x":this._canvasMoveCd=EDsCanvasDrag.X;this._templateRenderable=b;return;case "ms_rotation_y":this._canvasMoveCd=
EDsCanvasDrag.Y;this._templateRenderable=b;return;case "ms_rotation_z":this._canvasMoveCd=EDsCanvasDrag.Z;this._templateRenderable=b;return;case "ms_scale_x":this._canvasMoveCd=EDsCanvasDrag.X;this._templateRenderable=b;return;case "ms_scale_y":this._canvasMoveCd=EDsCanvasDrag.Y;this._templateRenderable=b;return;case "ms_scale_z":this._canvasMoveCd=EDsCanvasDrag.Z;this._templateRenderable=b;return;case "ms_scale_all":this._canvasMoveCd=EDsCanvasDrag.All;this._templateRenderable=b;return;default:this._canvasMoveCd=
EDsCanvasDrag.Unknown,this._templateRenderable=null}this.selectNone();b&&(this._selectRenderables.push(b),b._optionSelected=!0,b.showBoundBox(),this._workspace._catalog.showObject(b));var d=this._templateTranslation,f=this._templateRotation,h=this._templateScale;switch(this._canvasModeCd){case EDsCanvasMode.Translate:d.setVisible(null!=b);f.hide();h.hide();this._templateFace=d;break;case EDsCanvasMode.Rotation:d.hide();f.setVisible(null!=b);h.hide();this._templateFace=f;break;case EDsCanvasMode.Scale:d.hide(),
f.hide(),h.setVisible(null!=b),this._templateFace=h}d=this._templateFace;b&&d&&(b=b.display(),d=d.matrix(),d.assign(b.matrix()),d.setScaleAll(this._templateViewScale),d.update())}function FDsProjectPropertyContent_switchMode(b){this._canvasModeCd=b;this.selectRenderable(this._selectRenderable)}function FDsProjectPropertyContent_switchRotation(b){this._optionRotation=b}
function FDsProjectPropertyContent_reloadRegion(b){b=b.resource();this._cameraMoveRate=b.moveSpeed();this._cameraKeyRotation=b.rotationKeySpeed();this._cameraMouseRotation=b.rotationMouseSpeed()}function FDsProjectPropertyContent_loadMeshByGuid(b){var d=RConsole.find(FE3dMeshConsole);null!=this._activeSpace&&d.free(this._activeSpace);b=this._activeSpace=d.allocByGuid(this,b);b.addLoadListener(this,this.onMeshLoad);b._layer.pushRenderable(this._dimensional);RStage.register("mesh3d",b)}
function FDsProjectPropertyContent_loadMeshByCode(b){var d=RConsole.find(FE3dMeshConsole);null!=this._activeSpace&&d.free(this._activeSpace);b=this._activeSpace=d.allocByCode(this,b);b.addLoadListener(this,this.onMeshLoad);b._layer.pushRenderable(this._dimensional);RStage.register("mesh3d",b)}function FDsProjectPropertyContent_dispose(){this._rotation=RObject.dispose(this._rotation);this.__base.FDsCanvas.dispose.call(this)}
function FDsProjectPropertyToolBar(b){b=RClass.inherits(this,b,FUiToolBar);b._frameName="resource.project.PropertyToolBar";b._controlInsertButton=null;b._controlUpdateButton=null;b._controlDeleteButton=null;b._controlRotationButton=null;b.onBuilded=FDsProjectPropertyToolBar_onBuilded;b.onInsertClick=FDsProjectPropertyToolBar_onInsertClick;b.onUpdateClick=FDsProjectPropertyToolBar_onUpdateClick;b.onDeleteClick=FDsProjectPropertyToolBar_onDeleteClick;b.onRotationClick=FDsProjectPropertyToolBar_onRotationClick;
b.construct=FDsProjectPropertyToolBar_construct;b.dispose=FDsProjectPropertyToolBar_dispose;return b}function FDsProjectPropertyToolBar_onBuilded(b){this.__base.FUiToolBar.onBuilded.call(this,b)}function FDsProjectPropertyToolBar_onInsertClick(b){}function FDsProjectPropertyToolBar_onUpdateClick(b){window.open("/script/design/mesh.html?guid="+this._workspace._previewContent._activeItem._guid,"_blank","")}function FDsProjectPropertyToolBar_onDeleteClick(b){}
function FDsProjectPropertyToolBar_onRotationClick(b){this._workspace._previewContent.switchRotation(b.checked)}function FDsProjectPropertyToolBar_construct(){this.__base.FUiToolBar.construct.call(this)}function FDsProjectPropertyToolBar_dispose(){this.__base.FUiToolBar.dispose.call(this)}
function FDsProjectSceneCatalogContent(b){b=RClass.inherits(this,b,FUiDataTreeView,MListenerSelected);b._iconView="design3d.mesh.view";b._iconViewNot="design3d.mesh.viewno";b._activeSpace=null;b._materials=null;b.onBuild=FDsProjectSceneCatalogContent_onBuild;b.onLoadDisplay=FDsProjectSceneCatalogContent_onLoadDisplay;b.onNodeClick=FDsProjectSceneCatalogContent_onNodeClick;b.onNodeViewClick=FDsProjectSceneCatalogContent_onNodeViewClick;b.onNodeViewDoubleClick=FDsProjectSceneCatalogContent_onNodeViewDoubleClick;
b.lsnsSelect=null;b.construct=FDsProjectSceneCatalogContent_construct;b.buildTechnique=FDsProjectSceneCatalogContent_buildTechnique;b.buildRegion=FDsProjectSceneCatalogContent_buildRegion;b.buildRenderable=FDsProjectSceneCatalogContent_buildRenderable;b.buildDisplay=FDsProjectSceneCatalogContent_buildDisplay;b.buildSpace=FDsProjectSceneCatalogContent_buildSpace;b.selectObject=FDsProjectSceneCatalogContent_selectObject;b.showObject=FDsProjectSceneCatalogContent_showObject;b.dispose=FDsProjectSceneCatalogContent_dispose;
return b}function FDsProjectSceneCatalogContent_onBuild(b){this.__base.FUiDataTreeView.onBuild.call(this,b);this.lsnsClick.register(this,this.onNodeClick);this.loadUrl("/cloud.describe.tree.ws?action=query&code=resource.project")}function FDsProjectSceneCatalogContent_onLoadDisplay(b){this.buildRenderable(b._linkNode,b)}function FDsProjectSceneCatalogContent_onNodeClick(b,d){var f=d.dataPropertyGet("linker");this.selectObject(f)}
function FDsProjectSceneCatalogContent_onNodeViewClick(b){var d=b.treeNodeCell,f=b.treeNode.dataPropertyGet("linker");if(RClass.isClass(f,FDisplay))if(b.ctrlKey){for(var h=this._displays,q=h.count()-1;0<=q;q--){var z=h.get(q);z.dataPropertyGet("linker")._visible=!1;z.cell("view").setIcon(this._iconViewNot)}f._visible=!0;d.setIcon(this._iconView)}else f._visible=!f._visible,d.setIcon(f._visible?this._iconView:this._iconViewNot);if(RClass.isClass(f,FDrawable))if(b.ctrlKey){h=this._renderables;for(q=
h.count()-1;0<=q;q--)z=h.get(q),z.dataPropertyGet("linker")._visible=!1,z.cell("view").setIcon(this._iconViewNot);f._visible=!0;d.setIcon(this._iconView)}else f._visible=!f._visible,d.setIcon(f._visible?this._iconView:this._iconViewNot);if(RClass.isClass(f,FG3dMaterial))if(b.ctrlKey){b=this._materials;for(q=b.count()-1;0<=q;q--)h=b.get(q),h.dataPropertyGet("linker")._visible=!1,h.cell("view").setIcon(this._iconViewNot);f._visible=!0;d.setIcon(this._iconView)}else f._visible=!f._visible,d.setIcon(f._visible?
this._iconView:this._iconViewNot)}
function FDsProjectSceneCatalogContent_onNodeViewDoubleClick(b){b=b.treeNode;var d=b.dataPropertyGet("linker");if(RClass.isClass(d,FDisplay))for(var d=this._displays,f=d.count()-1;0<=f;f--)b=d.get(f),b.dataPropertyGet("linker")._visible=!0,b.cell("view").setIcon(this._iconView);if(RClass.isClass(d,FDrawable))for(d=this._renderables,f=d.count()-1;0<=f;f--)b=d.get(f),b.dataPropertyGet("linker")._visible=!0,b.cell("view").setIcon(this._iconView);if(RClass.isClass(d,FG3dMaterial))for(d=this._materials,
f=d.count()-1;0<=f;f--)b=d.get(f),b.dataPropertyGet("linker")._visible=!0,b.cell("view").setIcon(this._iconView)}function FDsProjectSceneCatalogContent_construct(){this.__base.FUiDataTreeView.construct.call(this);this._renderables=new TObjects;this._materials=new TObjects}function FDsProjectSceneCatalogContent_buildTechnique(b,d){var f=this.createNode();f.setLabel("Technique");f.setTypeCode("technique");f.dataPropertySet("linker",d);b.appendNode(f)}
function FDsProjectSceneCatalogContent_buildRegion(b,d){var f=this.createNode();f.setLabel("Region");f.setTypeCode("region");f.dataPropertySet("linker",d);b.appendNode(f);var h=this.createNode();h.setLabel("Camera");h.setTypeCode("camera");h.dataPropertySet("linker",d.camera());f.appendNode(h);h=this.createNode();h.setLabel("Light");h.setTypeCode("light");h.dataPropertySet("linker",d.directionalLight());f.appendNode(h)}
function FDsProjectSceneCatalogContent_buildRenderable(b,d){var f=d._renderable._material,h=this.createNode();h.setTypeCode("material");h.setLabel("Material");h.dataPropertySet("linker",f);this._materials.push(h);b.appendNode(h);f=d._renderable;h=this.createNode();h.setTypeCode("renderable");h.setLabel("Renderable");h.dataPropertySet("linker",f);this._renderables.push(h);b.appendNode(h)}
function FDsProjectSceneCatalogContent_buildDisplay(b,d){var f=this.createNode();f.setTypeCode("display");f.setLabel("Mesh");f.dataPropertySet("linker",d);b.appendNode(f);this.buildRenderable(f,d)}
function FDsProjectSceneCatalogContent_buildSpace(b){var d=b.resource();this._activeSpace=b;var f=this.createNode();f.setTypeCode("space");f.setLabel(d.code());f.setNote(d.label());f.dataPropertySet("linker",b);this.appendNode(f);this.buildTechnique(f,b.technique());this.buildRegion(f,b.region());this.buildDisplay(f,b._display);f.click()}function FDsProjectSceneCatalogContent_selectObject(b){null!=b&&this.processSelectedListener(b,!0)}
function FDsProjectSceneCatalogContent_showObject(b){if(RClass.isClass(b,FDsSceneRenderable))for(var d=this._renderables,f=d.count(),h=0;h<f;h++)d.getAt(h).dataPropertyGet("linker")==b&&this.processSelectedListener(b,!1)}function FDsProjectSceneCatalogContent_dispose(){this._displays=RObject.dispose(this._displays);this._renderables=RObject.dispose(this._renderables);this._materials=RObject.dispose(this._materials);this.__base.FUiDataTreeView.dispose.call(this)}
function FDsProjectSceneCatalogToolBar(b){b=RClass.inherits(this,b,FUiToolBar);b._frameName="resource.project.SceneCatalogToolBar";b._canvasModeCd=EDsCanvasMode.Drop;b._dropButton=null;b._selectButton=null;b._translateButton=null;b._rotationButton=null;b._scaleButton=null;b._lookFrontButton=null;b._lookUpButton=null;b._lookLeftButton=null;b._playButton=null;b._viewButton=null;b.onBuilded=FDsProjectSceneCatalogToolBar_onBuilded;b.onModeClick=FDsProjectSceneCatalogToolBar_onModeClick;b.onRotationClick=
FDsProjectSceneCatalogToolBar_onRotationClick;b.construct=FDsProjectSceneCatalogToolBar_construct;b.dispose=FDsProjectSceneCatalogToolBar_dispose;return b}function FDsProjectSceneCatalogToolBar_onBuilded(b){this.__base.FUiToolBar.onBuilded.call(this,b)}function FDsProjectSceneCatalogToolBar_onModeClick(b){this._canvasModeCd=b._canvasModeCd;this._workspace._canvas.switchMode(b._canvasModeCd)}function FDsProjectSceneCatalogToolBar_onRotationClick(b,d){this._workspace._canvas.switchRotation(d)}
function FDsProjectSceneCatalogToolBar_construct(){this.__base.FUiToolBar.construct.call(this)}function FDsProjectSceneCatalogToolBar_dispose(){this.__base.FUiToolBar.dispose.call(this)}
function FDsProjectCatalogToolBar(b){b=RClass.inherits(this,b,FUiToolBar);b._frameName="resource.project.CatalogToolBar";b._canvasModeCd=EDsCanvasMode.Drop;b._dropButton=null;b._selectButton=null;b._translateButton=null;b._rotationButton=null;b._scaleButton=null;b._lookFrontButton=null;b._lookUpButton=null;b._lookLeftButton=null;b._playButton=null;b._viewButton=null;b.onBuilded=FDsProjectCatalogToolBar_onBuilded;b.onModeClick=FDsProjectCatalogToolBar_onModeClick;b.onRotationClick=FDsProjectCatalogToolBar_onRotationClick;
b.construct=FDsProjectCatalogToolBar_construct;b.dispose=FDsProjectCatalogToolBar_dispose;return b}function FDsProjectCatalogToolBar_onBuilded(b){var d=this;d.__base.FUiToolBar.onBuilded.call(d,b)}function FDsProjectCatalogToolBar_onModeClick(b){var d=this;d._canvasModeCd=b._canvasModeCd;d._workspace._canvas.switchMode(b._canvasModeCd)}function FDsProjectCatalogToolBar_onRotationClick(b,d){var f=this._workspace._canvas;f.switchRotation(d)}
function FDsProjectCatalogToolBar_construct(){var b=this;b.__base.FUiToolBar.construct.call(b)}function FDsProjectCatalogToolBar_dispose(){var b=this;b.__base.FUiToolBar.dispose.call(b)}
function FDsProjectSceneDialog(b){b=RClass.inherits(this,b,FUiDialog);b._frameName="design3d.project.SceneDialog";b._dataModeCd=null;b._controlParentLabel=null;b._controlLabel=null;b._controlConfirmButton=null;b._controlCancelButton=null;b.onBuilded=FDsProjectSceneDialog_onBuilded;b.onConfirmLoad=FDsProjectSceneDialog_onConfirmLoad;b.onConfirmClick=FDsProjectSceneDialog_onConfirmClick;b.onCancelClick=FDsProjectSceneDialog_onCancelClick;b.construct=FDsProjectSceneDialog_construct;b.setDataCode=FDsProjectSceneDialog_setDataCode;
b.setDataLabel=FDsProjectSceneDialog_setDataLabel;b.switchDataMode=FDsProjectSceneDialog_switchDataMode;b.dispose=FDsProjectSceneDialog_dispose;return b}function FDsProjectSceneDialog_onBuilded(b){this.__base.FUiDialog.onBuilded.call(this,b);this._controlConfirmButton.addClickListener(this,this.onConfirmClick);this._controlCancelButton.addClickListener(this,this.onCancelClick)}
function FDsProjectSceneDialog_onConfirmLoad(b){RConsole.find(FUiDesktopConsole).hide();this.hide();this._frameSet._sceneListContent.serviceRelist()}
function FDsProjectSceneDialog_onConfirmClick(b){RConsole.find(FUiDesktopConsole).showUploading();b=this._controlCode.get();var d=this._controlLabel.get(),f=RConsole.find(FDrSceneConsole),h=null;if(this._dataModeCd==EUiDataMode.Insert){var q=RClass.create(FDrScene);q._projectGuid=this._projectGuid;q._code=b;q._label=d;h=f.doCreate(q);q.dispose()}else throw new TError(this,"Unknown mode.");h.addLoadListener(this,this.onConfirmLoad)}function FDsProjectSceneDialog_onCancelClick(b){this.hide()}
function FDsProjectSceneDialog_construct(){this.__base.FUiDialog.construct.call(this)}function FDsProjectSceneDialog_setDataCode(b){this._controlCode.set(b)}function FDsProjectSceneDialog_setDataLabel(b){this._controlLabel.set(b)}function FDsProjectSceneDialog_switchDataMode(b){this._dataModeCd=b;b==EUiDataMode.Insert?this.setLabel("\u65b0\u5efa\u573a\u666f"):b==EUiDataMode.Update&&this.setLabel("\u573a\u666f\u5c5e\u6027")}
function FDsProjectSceneDialog_dispose(){this.__base.FUiDialog.dispose.call(this)}
function FDsProjectSceneListContent(b){b=RClass.inherits(this,b,FUiListView);b._activeItem=null;b._activeGuid=null;b._refreshButton=null;b._saveButton=null;b._runButton=null;b.onBuilded=FDsProjectSceneListContent_onBuilded;b.onServiceLoad=FDsProjectSceneListContent_onServiceLoad;b.construct=FDsProjectSceneListContent_construct;b.doClickItem=FDsProjectSceneListContent_doClickItem;b.doDoubleClickItem=FDsProjectSceneListContent_doDoubleClickItem;b.serviceList=FDsProjectSceneListContent_serviceList;b.serviceRelist=
FDsProjectSceneListContent_serviceRelist;b.dispose=FDsProjectSceneListContent_dispose;return b}function FDsProjectSceneListContent_onBuilded(b){this.__base.FUiListView.onBuilded.call(this,b)}
function FDsProjectSceneListContent_onServiceLoad(b){b=b.root.findNode("SceneCollection");this.clear();b=b.nodes();for(var d=b.count(),f=0;f<d;f++){var h=b.getAt(f);if(h.isName("Scene")){var q=this.createItem(FDsProjectSceneListItem);q.propertyLoad(h);q._guid=h.get("guid");q._code=h.get("code");q._updateDate=h.get("update_date");q.setLabel(RString.nvl(h.get("label"),h.get("code")));q.refreshStyle();this.push(q)}}RConsole.find(FUiDesktopConsole).hide()}
function FDsProjectSceneListContent_construct(){this.__base.FUiListView.construct.call(this)}function FDsProjectSceneListContent_doClickItem(b){this.__base.FUiListView.doClickItem.call(this,b);this._activeItem=b}function FDsProjectSceneListContent_doDoubleClickItem(b){this.__base.FUiListView.doDoubleClickItem.call(this,b);this._activeItem=b;this._activeGuid=b._guid}
function FDsProjectSceneListContent_serviceList(b){this._activeGuid=b;RConsole.find(FUiDesktopConsole).showLoading();b="/cloud.solution.project.ws?action=listProject&project_guid="+b;b=RConsole.find(FXmlConsole).sendAsync(b);b.addLoadListener(this,this.onServiceLoad);return b}function FDsProjectSceneListContent_serviceRelist(){return this.serviceList(this._activeGuid)}function FDsProjectSceneListContent_dispose(){this.__base.FUiListView.dispose.call(this)}
function FDsProjectSceneListItem(b){b=RClass.inherits(this,b,FUiListViewItem);b.onBuild=FDsProjectSceneListItem_onBuild;b.refreshStyle=FDsProjectSceneListItem_refreshStyle;return b}function FDsProjectSceneListItem_onBuild(b){this.__base.FUiListViewItem.onBuild.call(this,b);b=this._hPanel;b.style.width="260px";b.style.height="150px"}function FDsProjectSceneListItem_refreshStyle(){this._hForm.style.backgroundImage='url("/cloud.content.scene.wv?do=preview&guid='+this._guid+'")'}
function FDsProjectSceneListToolBar(b){b=RClass.inherits(this,b,FUiToolBar);b._frameName="resource.project.SceneListToolBar";b._controlSceneCreate=null;b._controlSceneDelete=null;b.onBuilded=FDsProjectSceneListToolBar_onBuilded;b.onSceneCreateClick=FDsProjectSceneListToolBar_onSceneCreateClick;b.onSceneDeleteLoad=FDsProjectSceneListToolBar_onSceneDeleteLoad;b.onSceneDeleteExecute=FDsProjectSceneListToolBar_onSceneDeleteExecute;b.onSceneDeleteClick=FDsProjectSceneListToolBar_onSceneDeleteClick;b.construct=
FDsProjectSceneListToolBar_construct;b.dispose=FDsProjectSceneListToolBar_dispose;return b}function FDsProjectSceneListToolBar_onBuilded(b){this.__base.FUiToolBar.onBuilded.call(this,b);this._controlSceneCreate.addClickListener(this,this.onSceneCreateClick);this._controlSceneDelete.addClickListener(this,this.onSceneDeleteClick)}
function FDsProjectSceneListToolBar_onSceneCreateClick(b){b=this._frameSet._activeGuid;if(RString.isEmpty(b))throw new TError(this,"Project guid is empty.");var d=RConsole.find(FUiWindowConsole).find(FDsProjectSceneDialog);d._frameSet=this._frameSet;d._projectGuid=b;d.setDataCode("");d.setDataLabel("");d.switchDataMode(EUiDataMode.Insert);d.showPosition(EUiPosition.Center)}
function FDsProjectSceneListToolBar_onSceneDeleteLoad(b){RConsole.find(FUiDesktopConsole).hide();this._frameSet._sceneListContent.serviceRelist()}function FDsProjectSceneListToolBar_onSceneDeleteExecute(b){b.resultCd==EResult.Success&&(b=this._frameSet._sceneListContent.focusItem(),RConsole.find(FUiDesktopConsole).showUploading(),RConsole.find(FDrSceneConsole).doDelete(b._guid).addLoadListener(this,this.onSceneDeleteLoad))}
function FDsProjectSceneListToolBar_onSceneDeleteClick(b){if(!this._frameSet._sceneListContent.focusItem())return RConsole.find(FUiMessageConsole).showInfo("\u8bf7\u9009\u4e2d\u573a\u666f\u540e\uff0c\u518d\u70b9\u51fb\u64cd\u4f5c\u3002");RConsole.find(FUiMessageConsole).showConfirm("\u8bf7\u786e\u8ba4\u662f\u5426\u5220\u9664\u5f53\u524d\u573a\u666f\uff1f").addResultListener(this,this.onSceneDeleteExecute)}
function FDsProjectSceneListToolBar_construct(){this.__base.FUiToolBar.construct.call(this)}function FDsProjectSceneListToolBar_dispose(){this.__base.FUiToolBar.dispose.call(this)}
function FDsProjectTabBar(b){b=RClass.inherits(this,b,FUiTabBar);b._frameName="design3d.project.TabBar";b._resourceTypeCd="mesh";b._controlProjectButton=null;b._controlResourceButton=null;b.onBuilded=FDsProjectTabBar_onBuilded;b.onButtonClick=FDsProjectTabBar_onButtonClick;b.construct=FDsProjectTabBar_construct;b.dispose=FDsProjectTabBar_dispose;return b}
function FDsProjectTabBar_onBuilded(b){this.__base.FUiTabBar.onBuilded.call(this,b);this._controlProjectButton.addClickListener(this,this.onButtonClick);this._controlResourceButton.addClickListener(this,this.onButtonClick)}function FDsProjectTabBar_onButtonClick(b){b=b.sender.name();"project"==b?this._workspace.selectFrameSet(EDsFrameSet.ProjectFrameSet):"resource"==b&&this._workspace.selectFrameSet(EDsFrameSet.ResourceFrameSet)}
function FDsProjectTabBar_construct(){this.__base.FUiTabBar.construct.call(this)}function FDsProjectTabBar_dispose(){this.__base.FUiTabBar.dispose.call(this)}
function FDsProjectWorkspace(b){b=RClass.inherits(this,b,FUiWorkspace);b._frameName="design3d.project.Workspace";b._styleToolbarGround=RClass.register(b,new AStyle("_styleToolbarGround","Toolbar_Ground"));b._styleStatusbarGround=RClass.register(b,new AStyle("_styleStatusbarGround","Statusbar_Ground"));b._styleCatalogGround=RClass.register(b,new AStyle("_styleCatalogGround","Catalog_Ground"));b._styleCatalogToolbar=RClass.register(b,new AStyle("_styleCatalogToolbar","Catalog_Toolbar"));b._styleSearchGround=
RClass.register(b,new AStyle("_styleSearchGround","Search_Ground"));b._styleSearchToolbar=RClass.register(b,new AStyle("_styleCatalogToolbar","Search_Toolbar"));b._stylePropertyGround=RClass.register(b,new AStyle("_stylePropertyGround","Property_Ground"));b._stylePropertyToolbar=RClass.register(b,new AStyle("_stylePropertyToolbar","Property_Toolbar"));b._stylePropertyContent=RClass.register(b,new AStyle("_stylePropertyContent","Property_Content"));b._styleWorkspaceGround=RClass.register(b,new AStyle("_styleWorkspaceGround",
"Workspace_Ground"));b._resourceTypeCd="project";b._frameToolBar=null;b._frameStatusBar=null;b._frameCatalog=null;b._frameCatalogToolbar=null;b._frameCatalogContent=null;b._frameSearch=null;b._frameSearchToolbar=null;b._frameSearchContent=null;b._framePreview=null;b._framePreviewToolbar=null;b._framePreviewContent=null;b._activeFrameSet=null;b._frameSets=null;b._propertyFrames=null;b.onBuilded=FDsProjectWorkspace_onBuilded;b.onMeshLoad=FDsProjectWorkspace_onMeshLoad;b.onCatalogSelected=FDsProjectWorkspace_onCatalogSelected;
b.construct=FDsProjectWorkspace_construct;b.selectFrameSet=FDsProjectWorkspace_selectFrameSet;b.findPropertyFrame=FDsProjectWorkspace_findPropertyFrame;b.switchContent=FDsProjectWorkspace_switchContent;b.load=FDsProjectWorkspace_load;b.dispose=FDsProjectWorkspace_dispose;return b}
function FDsProjectWorkspace_onBuilded(b){this.__base.FUiWorkspace.onBuilded.call(this,b);var d=this._frameToolBar=this.searchControl("toolbarFrame");d._hPanel.className=this.styleName("Toolbar_Ground");this._frameBody=this.searchControl("bodyFrame");d=this._frameStatusBar=this.searchControl("statusFrame");d._hPanel.className=this.styleName("Statusbar_Ground");d=RBuilder.createTable(b);d.width="100%";var f=RBuilder.appendTableRow(d);this._hMenuPanel=RBuilder.appendTableCell(f);var h=this._tabBar=
RClass.create(FDsProjectTabBar);h._workspace=this;h.buildDefine(b);b=RBuilder.appendTableCell(f);b.width="150px";b.align="right";b.vAlign="bottom";b.appendChild(h._hPanel);this._frameToolBar._hPanel.appendChild(d);this.selectFrameSet(EDsFrameSet.ProjectFrameSet)}function FDsProjectWorkspace_onMeshLoad(b){this._activeSpace=b._activeSpace;this._catalog.buildSpace(this._activeSpace)}
function FDsProjectWorkspace_onCatalogSelected(b,d){for(var f=this._activeSpace,h=this._propertyFrames,q=h.count(),z=0;z<q;z++){var A=h.value(z);A.hide()}if(RClass.isClass(b,FE3dStage))A=this.findPropertyFrame(EDsFrame.MeshSpacePropertyFrame),A.show(),A.loadObject(f,f);else if(RClass.isClass(b,FG3dTechnique))A=this.findPropertyFrame(EDsFrame.MeshTechniquePropertyFrame),A.show(),A.loadObject(f,b);else if(RClass.isClass(b,FE3dRegion))A=this.findPropertyFrame(EDsFrame.MeshRegionPropertyFrame),A.show(),
A.loadObject(f,b);else if(RClass.isClass(b,FE3dCamera))A=this.findPropertyFrame(EDsFrame.MeshCameraPropertyFrame),A.show(),A.loadObject(f,b);else if(RClass.isClass(b,FG3dDirectionalLight))A=this.findPropertyFrame(EDsFrame.MeshLightPropertyFrame),A.show(),A.loadObject(f,b);else if(RClass.isClass(b,FE3dMeshDisplay))A=this.findPropertyFrame(EDsFrame.MeshDisplayPropertyFrame),A.show(),A.loadObject(f,b);else if(RClass.isClass(b,FG3dMaterial))A=this.findPropertyFrame(EDsFrame.MeshMaterialPropertyFrame),
A.show(),A.loadObject(f,b);else if(RClass.isClass(b,FE3dMeshRenderable))A=this.findPropertyFrame(EDsFrame.MeshRenderablePropertyFrame),A.show(),A.loadObject(f,b);else throw new TError("Unknown select object type. (value={1})",b);}function FDsProjectWorkspace_construct(){this.__base.FUiWorkspace.construct.call(this);this._frameSets=new TDictionary;this._propertyFrames=new TDictionary}
function FDsProjectWorkspace_selectFrameSet(b,d){var f=this._frameSets.get(b);if(!f){if(b==EDsFrameSet.ProjectFrameSet){var h=RClass.create(FDsProjectMenuBar);h._workspace=this;h.buildDefine(this._hPanel);f=RConsole.find(FFrameConsole).findByClass(this,FDsProjectFrameSet);f._workspace=this;f._menuBar=h;h._frameSet=f}else if(b==EDsFrameSet.ResourceFrameSet)h=RClass.create(FDsResourceMenuBar),h._workspace=this,h.buildDefine(this._hPanel),f=RConsole.find(FFrameConsole).findByClass(this,FDsResourceFrameSet),
f._workspace=this,f._menuBar=h,h._frameSet=f;else if(b==EDsFrameSet.MeshFrameSet)h=RClass.create(FDsMeshMenuBar),h._workspace=this,h.buildDefine(this._hPanel),f=RConsole.find(FFrameConsole).findByClass(this,FDsMeshFrameSet),f._workspace=this,f._menuBar=h,h._frameSet=f;else throw new TError("Unknown frameset. (name={1})",b);this._frameSets.set(b,f)}h=this._activeFrameSet;h!=f&&(h&&(this._hMenuPanel.removeChild(h._menuBar._hPanel),this._frameBody.remove(h)),this._hMenuPanel.appendChild(f._menuBar._hPanel),
this._frameBody.push(f),f.psResize());this._activeFrameSet=f;if(b!=EDsFrameSet.ProjectFrameSet)if(b==EDsFrameSet.ResourceFrameSet)f.load();else if(b==EDsFrameSet.MeshFrameSet)f.loadByGuid(d);else throw new TError("Unknown frameset. (name={1})",b);return f}function FDsProjectWorkspace_findPropertyFrame(b){var d=this._propertyFrames.get(b);d||(d=RConsole.find(FFrameConsole).get(this,b,this._framePreview._hContainer),d._workspace=this,this._propertyFrames.set(b,d));return d}
function FDsProjectWorkspace_switchContent(b){this._resourceTypeCd=b;this._searchContent.serviceSearch(b,"",40,0)}function FDsProjectWorkspace_load(){}function FDsProjectWorkspace_dispose(){this.__base.FUiWorkspace.dispose.call(this);this._propertyFrames.dispose();this._propertyFrames=null}
function FDsResourceCatalogContent(b){b=RClass.inherits(this,b,FUiDataTreeView,MListenerSelected);b._activeSpace=null;b._materials=null;b.onBuild=FDsResourceCatalogContent_onBuild;b.onLoadDisplay=FDsResourceCatalogContent_onLoadDisplay;b.onNodeClick=FDsResourceCatalogContent_onNodeClick;b.onNodeViewClick=FDsResourceCatalogContent_onNodeViewClick;b.onNodeViewDoubleClick=FDsResourceCatalogContent_onNodeViewDoubleClick;b.lsnsSelect=null;b.construct=FDsResourceCatalogContent_construct;b.selectObject=
FDsResourceCatalogContent_selectObject;b.showObject=FDsResourceCatalogContent_showObject;b.dispose=FDsResourceCatalogContent_dispose;return b}function FDsResourceCatalogContent_onBuild(b){this.__base.FUiDataTreeView.onBuild.call(this,b);this.lsnsClick.register(this,this.onNodeClick);this.loadUrl("/cloud.describe.tree.ws?action=query&code=resource.catalog")}function FDsResourceCatalogContent_onLoadDisplay(b){this.buildRenderable(b._linkNode,b)}function FDsResourceCatalogContent_onNodeClick(b,d){}
function FDsResourceCatalogContent_onNodeViewClick(b){}function FDsResourceCatalogContent_onNodeViewDoubleClick(b){}function FDsResourceCatalogContent_construct(){this.__base.FUiDataTreeView.construct.call(this);this._renderables=new TObjects;this._materials=new TObjects}function FDsResourceCatalogContent_selectObject(b){null!=b&&this.processSelectedListener(b,!0)}function FDsResourceCatalogContent_showObject(b){}
function FDsResourceCatalogContent_dispose(){this.__base.FUiDataTreeView.dispose.call(this)}
function FDsResourceCatalogToolBar(b){b=RClass.inherits(this,b,FUiToolBar);b._frameName="resource.resource.CatalogToolBar";b._controlFolderCreateButton=null;b._controlFolderDeleteButton=null;b._controlFolderPropertyButton=null;b._controlFolderOpenButton=null;b._controlFolderCloseButton=null;b._activeNodeGuid=null;b.onBuilded=FDsResourceCatalogToolBar_onBuilded;b.onFolderCreateClick=FDsResourceCatalogToolBar_onFolderCreateClick;b.onFolderDeleteLoad=FDsResourceCatalogToolBar_onFolderDeleteLoad;b.onFolderDeleteExcute=
FDsResourceCatalogToolBar_onFolderDeleteExcute;b.onFolderDeleteClick=FDsResourceCatalogToolBar_onFolderDeleteClick;b.onFolderPropertyClick=FDsResourceCatalogToolBar_onFolderPropertyClick;b.onFolderOpenClick=FDsResourceCatalogToolBar_onFolderOpenClick;b.onFolderCloseClick=FDsResourceCatalogToolBar_onFolderCloseClick;b.construct=FDsResourceCatalogToolBar_construct;b.dispose=FDsResourceCatalogToolBar_dispose;return b}
function FDsResourceCatalogToolBar_onBuilded(b){this.__base.FUiToolBar.onBuilded.call(this,b);this._controlFolderCreateButton.addClickListener(this,this.onFolderCreateClick);this._controlFolderDeleteButton.addClickListener(this,this.onFolderDeleteClick);this._controlFolderPropertyButton.addClickListener(this,this.onFolderPropertyClick);this._controlFolderOpenButton.addClickListener(this,this.onFolderOpenClick);this._controlFolderCloseButton.addClickListener(this,this.onFolderCloseClick)}
function FDsResourceCatalogToolBar_onFolderCreateClick(b){var d=b=null,f=this._frameSet._catalogContent.focusNode();f&&(b=f.guid(),d=f.label());f=RConsole.find(FUiWindowConsole).find(FDsResourceFolderDialog);f._workspace=this._workspace;f._frameSet=this._frameSet;f._parentGuid=b;f.setNodeParentLabel(d);f.setNodeLabel("");f.switchDataMode(EUiDataMode.Insert);f.showPosition(EUiPosition.Center)}
function FDsResourceCatalogToolBar_onFolderDeleteLoad(b){RConsole.find(FUiDesktopConsole).hide();b=this._frameSet._catalogContent;var d=this._activeNodeGuid;d&&b.findByGuid(d).removeSelf();this._activeNodeGuid=null}
function FDsResourceCatalogToolBar_onFolderDeleteExcute(b){b.resultCd==EResult.Success&&(b=this._frameSet._catalogContent.focusNode(),RConsole.find(FUiDesktopConsole).showUploading(),this._activeNodeGuid=b._guid,RConsole.find(FDrResourceConsole).doFolderDelete(b._guid).addLoadListener(this,this.onFolderDeleteLoad))}
function FDsResourceCatalogToolBar_onFolderDeleteClick(b){if(!this._frameSet._catalogContent.focusNode())return RConsole.find(FUiMessageConsole).showInfo("\u8bf7\u9009\u4e2d\u76ee\u5f55\u8282\u70b9\u540e\uff0c\u518d\u70b9\u51fb\u64cd\u4f5c\u3002");RConsole.find(FUiMessageConsole).showConfirm("\u8bf7\u786e\u8ba4\u662f\u5426\u5220\u9664\u5f53\u524d\u76ee\u5f55\uff1f").addResultListener(this,this.onFolderDeleteExcute)}
function FDsResourceCatalogToolBar_onFolderPropertyClick(b){b=this._frameSet._catalogContent.focusNode();if(!b)return RConsole.find(FUiMessageConsole).showInfo("\u8bf7\u9009\u4e2d\u76ee\u5f55\u8282\u70b9\u540e\uff0c\u518d\u70b9\u51fb\u64cd\u4f5c\u3002");var d=null;b._parent&&(d=b._parent.label());var f=RConsole.find(FUiWindowConsole).find(FDsResourceFolderDialog);f._workspace=this._workspace;f._frameSet=this._frameSet;f._nodeGuid=b._guid;f.setNodeParentLabel(d);f.setNodeLabel(b.label());f.switchDataMode(EUiDataMode.Update);
f.showPosition(EUiPosition.Center)}function FDsResourceCatalogToolBar_onFolderOpenClick(b){}function FDsResourceCatalogToolBar_onFolderCloseClick(b){}function FDsResourceCatalogToolBar_construct(){this.__base.FUiToolBar.construct.call(this)}function FDsResourceCatalogToolBar_dispose(){this.__base.FUiToolBar.dispose.call(this)}
function FDsResourceCreateDialog(b){b=RClass.inherits(this,b,FUiDialog);b._frameName="resource.resource.CreateDialog";b._nodeGuid=null;b._controlNodeLabel=null;b._controlCode=null;b._controlLabel=null;b._controlConfirm=null;b._controlCancel=null;b.onBuilded=FDsResourceCreateDialog_onBuilded;b.onConfirmLoad=FDsResourceCreateDialog_onConfirmLoad;b.onConfirmClick=FDsResourceCreateDialog_onConfirmClick;b.onCancelClick=FDsResourceCreateDialog_onCancelClick;b.construct=FDsResourceCreateDialog_construct;
b.setNodeLabel=FDsResourceCreateDialog_setNodeLabel;b.switchMode=FDsResourceCreateDialog_switchMode;b.dispose=FDsResourceCreateDialog_dispose;return b}function FDsResourceCreateDialog_onBuilded(b){this.__base.FUiDialog.onBuilded.call(this,b);this._controlNodeLabel.setEditAble(!1);this._controlConfirm.addClickListener(this,this.onConfirmClick);this._controlCancel.addClickListener(this,this.onCancelClick)}
function FDsResourceCreateDialog_onConfirmLoad(b){this.hide();RConsole.find(FUiDesktopConsole).hide();RConsole.find(FUiResultConsole).checkEvent(b)&&this._frameSet._listContent.serviceResearch()}
function FDsResourceCreateDialog_onConfirmClick(b){RConsole.find(FUiDesktopConsole).showUploading();b=this._controlCode.get();var d=this._controlLabel.get(),f=null;switch(this._modeCd){case EE3sResource.Material:f=RClass.create(FDrMaterial);f.setCode(b);f.setLabel(d);f=RConsole.find(FDrMaterialConsole).doCreate(f);break;case EE3sResource.Template:f=RClass.create(FDrTemplate);f.setCode(b);f.setLabel(d);f=RConsole.find(FDrTemplateConsole).doCreate(f);break;case EE3sResource.Scene:f=RClass.create(FDrScene);
f.setCode(b);f.setLabel(d);f=RConsole.find(FDrSceneConsole).doCreate(f);break;default:throw new TError(this,"Unknown mode. (mode_cd={1})",modeCd);}f.addLoadListener(this,this.onConfirmLoad)}function FDsResourceCreateDialog_onCancelClick(b){this.hide()}function FDsResourceCreateDialog_construct(){this.__base.FUiDialog.construct.call(this)}function FDsResourceCreateDialog_setNodeLabel(b){this._controlNodeLabel.set(b)}
function FDsResourceCreateDialog_switchMode(b){this._modeCd=b;switch(b){case EE3sResource.Material:this.setLabel("\u521b\u5efa\u6750\u8d28");break;case EE3sResource.Template:this.setLabel("\u521b\u5efa\u6a21\u677f");break;case EE3sResource.Scene:this.setLabel("\u521b\u5efa\u573a\u666f");break;default:throw new TError(this,"Unknown mode. (mode_cd={1})",b);}this._controlCode.set("");this._controlLabel.set("")}function FDsResourceCreateDialog_dispose(){this.__base.FUiDialog.dispose.call(this)}
function FDsResourceFolderDialog(b){b=RClass.inherits(this,b,FUiDialog);b._frameName="resource.resource.FolderDialog";b._dataModeCd=null;b._controlParentLabel=null;b._controlLabel=null;b._controlConfirmButton=null;b._controlCancelButton=null;b.onBuilded=FDsResourceFolderDialog_onBuilded;b.onConfirmLoad=FDsResourceFolderDialog_onConfirmLoad;b.onConfirmClick=FDsResourceFolderDialog_onConfirmClick;b.onCancelClick=FDsResourceFolderDialog_onCancelClick;b.construct=FDsResourceFolderDialog_construct;b.setNodeParentLabel=
FDsResourceFolderDialog_setNodeParentLabel;b.setNodeLabel=FDsResourceFolderDialog_setNodeLabel;b.switchDataMode=FDsResourceFolderDialog_switchDataMode;b.dispose=FDsResourceFolderDialog_dispose;return b}function FDsResourceFolderDialog_onBuilded(b){this.__base.FUiDialog.onBuilded.call(this,b);this._controlParentLabel.setEditAble(!1);this._controlConfirmButton.addClickListener(this,this.onConfirmClick);this._controlCancelButton.addClickListener(this,this.onCancelClick)}
function FDsResourceFolderDialog_onConfirmLoad(b){RConsole.find(FUiDesktopConsole).hide();this.hide();b=this._frameSet._catalogContent;if(this._dataModeCd==EUiDataMode.Insert)if(this._parentGuid){var d=b.findByGuid(this._parentGuid);b.loadNode(d)}else b.loadService();else{var f=this._controlLabel.get(),d=b.focusNode();d.setLabel(f)}}
function FDsResourceFolderDialog_onConfirmClick(b){RConsole.find(FUiDesktopConsole).showUploading();b=this._controlLabel.get();var d=RConsole.find(FDrResourceConsole),f=null,f=this._dataModeCd==EUiDataMode.Insert?d.doFolderCreate(this._parentGuid,null,b):d.doFolderUpdate(this._nodeGuid,null,b);f.addLoadListener(this,this.onConfirmLoad)}function FDsResourceFolderDialog_onCancelClick(b){this.hide()}function FDsResourceFolderDialog_construct(){this.__base.FUiDialog.construct.call(this)}
function FDsResourceFolderDialog_setNodeParentLabel(b){this._controlParentLabel.set(b)}function FDsResourceFolderDialog_setNodeLabel(b){this._controlLabel.set(b)}function FDsResourceFolderDialog_switchDataMode(b){this._dataModeCd=b;b==EUiDataMode.Insert?this.setLabel("\u65b0\u5efa\u8d44\u6e90\u76ee\u5f55"):b==EUiDataMode.Update&&this.setLabel("\u8d44\u6e90\u76ee\u5f55\u5c5e\u6027")}function FDsResourceFolderDialog_dispose(){this.__base.FUiDialog.dispose.call(this)}
function FDsResourceFrameSet(b){b=RClass.inherits(this,b,FDsFrameSet);b._styleToolbarGround=RClass.register(b,new AStyle("_styleToolbarGround","Toolbar_Ground"));b._styleCatalogContent=RClass.register(b,new AStyle("_styleCatalogContent","Catalog_Content"));b._styleListContent=RClass.register(b,new AStyle("_styleListContent","List_Content"));b._stylePropertyContent=RClass.register(b,new AStyle("_stylePropertyContent","Property_Content"));b._resourceTypeCd="picture";b._frameCatalog=null;b._frameCatalogToolbar=
null;b._frameCatalogContent=null;b._frameSearch=null;b._frameSearchToolbar=null;b._frameSearchContent=null;b._framePreview=null;b._framePreviewToolbar=null;b._framePreviewContent=null;b.onBuilded=FDsResourceFrameSet_onBuilded;b.onCatalogSelected=FDsResourceFrameSet_onCatalogSelected;b.construct=FDsResourceFrameSet_construct;b.switchContent=FDsResourceFrameSet_switchContent;b.load=FDsResourceFrameSet_load;b.dispose=FDsResourceFrameSet_dispose;return b}
function FDsResourceFrameSet_onBuilded(b){this.__base.FDsFrameSet.onBuilded.call(this,b)}
function FDsResourceFrameSet_onCatalogSelected(b,d){var f=this._activeSpace;if(f)if(this.hidePropertyFrames(),RClass.isClass(b,FE3dStage)){var h=this.findPropertyFrame(EDsFrame.MeshSpacePropertyFrame);h.show();h.loadObject(f,b)}else if(RClass.isClass(b,FG3dTechnique))h=this.findPropertyFrame(EDsFrame.MeshTechniquePropertyFrame),h.show(),h.loadObject(f,b);else if(RClass.isClass(b,FE3dRegion))h=this.findPropertyFrame(EDsFrame.MeshRegionPropertyFrame),h.show(),h.loadObject(f,b);else if(RClass.isClass(b,
FE3dCamera))h=this.findPropertyFrame(EDsFrame.MeshCameraPropertyFrame),h.show(),h.loadObject(f,b);else if(RClass.isClass(b,FG3dDirectionalLight))h=this.findPropertyFrame(EDsFrame.MeshLightPropertyFrame),h.show(),h.loadObject(f,b);else if(RClass.isClass(b,FE3dMeshDisplay))h=this.findPropertyFrame(EDsFrame.MeshDisplayPropertyFrame),h.show(),h.loadObject(f,b);else if(RClass.isClass(b,FG3dMaterial))h=this.findPropertyFrame(EDsFrame.MeshMaterialPropertyFrame),h.show(),h.loadObject(f,b);else if(RClass.isClass(b,
FE3dMeshRenderable))h=this.findPropertyFrame(EDsFrame.MeshRenderablePropertyFrame),h.show(),h.loadObject(f,b);else throw new TError("Unknown select object type. (select={1})",b);}function FDsResourceFrameSet_construct(){this.__base.FDsFrameSet.construct.call(this)}function FDsResourceFrameSet_switchContent(b){this._resourceTypeCd=b;this._listContent.serviceSearch(b,"","",40,0)}function FDsResourceFrameSet_load(){this._listToolBar.storageLoad()}
function FDsResourceFrameSet_dispose(){this.__base.FDsFrameSet.dispose.call(this)}
function FDsResourceImportDialog(b){b=RClass.inherits(this,b,FUiDialog);b._frameName="resource.resource.ImportDialog";b._nodeGuid=null;b._controlPrivateButton=null;b._controlTeamButton=null;b._controlShareButton=null;b.onBuilded=FDsResourceImportDialog_onBuilded;b.onFileChange=FDsResourceImportDialog_onFileChange;b.onFileLoaded=FDsResourceImportDialog_onFileLoaded;b.onConfirmLoad=FDsResourceImportDialog_onConfirmLoad;b.onConfirmClick=FDsResourceImportDialog_onConfirmClick;b.onCancelClick=FDsResourceImportDialog_onCancelClick;
b.construct=FDsResourceImportDialog_construct;b.setNodeLabel=FDsResourceImportDialog_setNodeLabel;b.switchMode=FDsResourceImportDialog_switchMode;b.dispose=FDsResourceImportDialog_dispose;return b}
function FDsResourceImportDialog_onBuilded(b){this.__base.FUiDialog.onBuilded.call(this,b);this._controlNodeLabel.setEditAble(!1);this._controlFile.addDataChangedListener(this,this.onFileChange);this._controlConfirmButton.addClickListener(this,this.onConfirmClick);this._controlCancelButton.addClickListener(this,this.onCancelClick)}
function FDsResourceImportDialog_onFileChange(b){b=this._controlFile.get();b=RFile.name(b);RString.isEmpty(this._controlCode.get())&&this._controlCode.set(b);RString.isEmpty(this._controlLabel.get())&&this._controlLabel.set(b)}
function FDsResourceImportDialog_onFileLoaded(b){b=this._fileReader;var d=this._controlCode.get(),f=this._controlLabel.get(),h=null;if(this._modeCd==EE3sResource.Bitmap)h="/cloud.resource.bitmap.wv?do=importData";else if(this._modeCd==EE3sResource.Model)h="/cloud.resource.model.wv?do=importData";else throw new TError(this,"Type is invalid.");this._nodeGuid&&(h+="&node_guid="+this._nodeGuid);h+="&code="+d+"&label="+f+"&data_length="+b.length()+"&file_name="+b.fileName();h=RBrowser.urlEncode(h);RConsole.find(FHttpConsole).send(h,
b.data()).addLoadListener(this,this.onConfirmLoad);this._fileReader=RObject.dispose(b)}function FDsResourceImportDialog_onConfirmLoad(b){RConsole.find(FUiDesktopConsole).hide();this.hide();this._frameSet._listContent.serviceResearch()}function FDsResourceImportDialog_onConfirmClick(b){RConsole.find(FUiDesktopConsole).showUploading();b=this._controlFile._hInput.files[0];var d=this._fileReader=RClass.create(FFileReader);d.addLoadListener(this,this.onFileLoaded);d.loadFile(b)}
function FDsResourceImportDialog_onCancelClick(b){this.hide()}function FDsResourceImportDialog_construct(){this.__base.FUiDialog.construct.call(this)}function FDsResourceImportDialog_setNodeLabel(b){this._controlNodeLabel.set(b)}
function FDsResourceImportDialog_switchMode(b){this._modeCd=b;switch(b){case EE3sResource.Bitmap:this.setLabel("\u5bfc\u5165\u56fe\u7247\u8d44\u6e90");break;case EE3sResource.Model:this.setLabel("\u5bfc\u5165\u6a21\u578b\u8d44\u6e90");break;default:throw new TError(this,"Unknown mode. (mode_cd={1})",b);}this._controlCode.set("");this._controlLabel.set("")}function FDsResourceImportDialog_dispose(){this.__base.FUiDialog.dispose.call(this)}
function FDsResourceListContent(b){b=RClass.inherits(this,b,FUiListView);b._contentFlag=null;b._contentTypeCd=EE3sResource.All;b._contentSerach="";b._contentOrder="";b._contentPageSize=40;b._contentPageCount=0;b._contentPage=0;b._activeItem=null;b._activeGuid=null;b._refreshButton=null;b._saveButton=null;b._runButton=null;b.onServiceLoad=FDsResourceListContent_onServiceLoad;b.construct=FDsResourceListContent_construct;b.doClickItem=FDsResourceListContent_doClickItem;b.doDoubleClickItem=FDsResourceListContent_doDoubleClickItem;
b.serviceSearch=FDsResourceListContent_serviceSearch;b.serviceResearch=FDsResourceListContent_serviceResearch;b.dispose=FDsResourceListContent_dispose;return b}
function FDsResourceListContent_onServiceLoad(b){b=b.root.findNode("ResourceCollection");var d=b.getInteger("page_size"),f=b.getInteger("page_count"),h=b.getInteger("page");this._frameSet._listToolBar.setNavigator(d,f,h);this.clear();b=b.nodes();d=b.count();for(f=0;f<d;f++)if(h=b.getAt(f),h.isName("Resource")){var q=this.createItem(FDsResourceListItem);q.propertyLoad(h);q._guid=h.get("guid");q._typeCd=h.get("type_cd");q._shareCd=h.get("share_cd");q._code=h.get("code");q._updateDate=h.get("update_date");
q.setTypeLabel(q._typeCd);q.setLabel(h.get("code")+" - "+h.get("label"));q.refreshStyle();this.push(q)}RConsole.find(FUiDesktopConsole).hide()}function FDsResourceListContent_construct(){this.__base.FUiListView.construct.call(this)}function FDsResourceListContent_doClickItem(b){this.__base.FUiListView.doClickItem.call(this,b)}
function FDsResourceListContent_doDoubleClickItem(b){this.__base.FUiListView.doDoubleClickItem.call(this,b);var d=b._guid;this._activeItem=b;this._activeGuid=b._guid;var f=this._frameSet._workspace;b=b._typeCd;if(b==EE3sResource.Bitmap)f.selectFrameSet(EDsFrameSet.PrivateBitmapFrameSet,d);else if(b==EE3sResource.Material)f.selectFrameSet(EDsFrameSet.PrivateMaterialFrameSet,d);else if(b==EE3sResource.Model)f.selectFrameSet(EDsFrameSet.PrivateModelFrameSet,d);else if(b==EE3sResource.Template)f.selectFrameSet(EDsFrameSet.PrivateTemplateFrameSet,
d);else if(b==EE3sResource.Scene)f.selectFrameSet(EDsFrameSet.PrivateSceneFrameSet,d);else throw new TError(this,"Unsupport resource format.");}
function FDsResourceListContent_serviceSearch(b,d,f,h,q,z){null==b&&(b=this._contentTypeCd);null==d&&(d=this._contentSerach);null==f&&(f=this._contentOrder);null==h&&(h=this._contentPageSize);null==q&&(q=this._contentPage);if(!z){var A=b+"|"+d+"|"+f+"|"+h+"|"+q;if(this._contentFlag==A)return}this._contentFlag=A;this._contentTypeCd=b;this._contentSerach=d;this._contentOrder=f;this._contentPageSize=h;this._contentPage=q;RConsole.find(FUiDesktopConsole).showLoading();RConsole.find(FDrResourceConsole).doList(this._contentTypeCd,
this._contentSerach,this._contentOrder,this._contentPageSize,this._contentPage).addLoadListener(this,this.onServiceLoad)}function FDsResourceListContent_serviceResearch(){this.serviceSearch(this._contentTypeCd,this._contentSerach,this._contentOrder,this._contentPageSize,this._contentPage,!0)}function FDsResourceListContent_dispose(){this.__base.FUiListView.dispose.call(this)}
function FDsResourceListItem(b){b=RClass.inherits(this,b,FUiListViewItem);b._styleTypePanel=RClass.register(b,new AStyle("_styleTypePanel"));b._styleTypePrivateLabel=RClass.register(b,new AStyle("_styleTypePublicLabel"));b._styleTypePublicLabel=RClass.register(b,new AStyle("_styleTypePrivateLabel"));b.onBuild=FDsResourceListItem_onBuild;b.setTypeLabel=FDsResourceListItem_setTypeLabel;b.refreshStyle=FDsResourceListItem_refreshStyle;return b}
function FDsResourceListItem_onBuild(b){this.__base.FUiListViewItem.onBuild.call(this,b);b=this._hPanel;b.style.width="200px";b.style.height="150px";this._hLine1.className=this.styleName("TypePanel");this._hLine1.vAlign="top";this._hTypeLabel=RBuilder.appendDiv(this._hLine1,this.styleName("TypePrivateLabel"))}function FDsResourceListItem_setTypeLabel(b){this._hTypeLabel.innerHTML=b}
function FDsResourceListItem_refreshStyle(){this._hTypeLabel.className="Public"==this._shareCd?this.styleName("TypePublicLabel"):this.styleName("TypePrivateLabel");this._hForm.style.backgroundImage='url("'+("/cloud.resource.preview.wv?type_cd="+this._typeCd+"&guid="+this._guid+"&update_date="+this._updateDate)+'")'}
function FDsResourceListToolBar(b){b=RClass.inherits(this,b,FUiToolBar,MUiStorage);b._dropButton=null;b._selectButton=null;b._translateButton=null;b._rotationButton=null;b._scaleButton=null;b._lookFrontButton=null;b._lookUpButton=null;b._lookLeftButton=null;b._playButton=null;b._viewButton=null;b.onBuilded=FDsResourceListToolBar_onBuilded;b.onSearchClick=FDsResourceListToolBar_onSearchClick;b.onNavigatorClick=FDsResourceListToolBar_onNavigatorClick;b.onTypeClick=FDsResourceListToolBar_onTypeClick;
b.construct=FDsResourceListToolBar_construct;b.makeTypeCd=FDsResourceListToolBar_makeTypeCd;b.setNavigator=FDsResourceListToolBar_setNavigator;b.doNavigator=FDsResourceListToolBar_doNavigator;b.storageLoad=FDsResourceListToolBar_storageLoad;b.dispose=FDsResourceListToolBar_dispose;return b}
function FDsResourceListToolBar_onBuilded(b){this.__base.FUiToolBar.onBuilded.call(this,b);this._controlSearchEdit.addClickListener(this,this.onSearchClick);this._controlFirstButton.addClickListener(this,this.onNavigatorClick);this._controlPriorButton.addClickListener(this,this.onNavigatorClick);this._controlNextButton.addClickListener(this,this.onNavigatorClick);this._controlLastButton.addClickListener(this,this.onNavigatorClick);this._controlTypeAll.addClickListener(this,this.onTypeClick);this._controlTypeNone.addClickListener(this,
this.onTypeClick);this._controlTypeBitmap.addClickListener(this,this.onTypeClick);this._controlTypeBitmap.check(!0);this._controlTypeMaterial.addClickListener(this,this.onTypeClick);this._controlTypeMaterial.check(!0);this._controlTypeModel.addClickListener(this,this.onTypeClick);this._controlTypeModel.check(!0);this._controlTypeTemplate.addClickListener(this,this.onTypeClick);this._controlTypeTemplate.check(!0);this._controlTypeScene.addClickListener(this,this.onTypeClick);this._controlTypeScene.check(!0)}
function FDsResourceListToolBar_onSearchClick(b){this.doNavigator(0)}function FDsResourceListToolBar_onNavigatorClick(b){b=b.sender.name();var d=this._contentPage;switch(b){case "firstButton":d=0;break;case "priorButton":d--;break;case "nextButton":d++;break;case "lastButton":d=this._contentPageCount-1}this.doNavigator(d)}
function FDsResourceListToolBar_onTypeClick(b){switch(b.sender.name()){case "typeAll":this._controlTypeBitmap.check(!0);this._controlTypeMaterial.check(!0);this._controlTypeModel.check(!0);this._controlTypeTemplate.check(!0);this._controlTypeScene.check(!0);break;case "typeNone":this._controlTypeBitmap.check(!1),this._controlTypeMaterial.check(!1),this._controlTypeModel.check(!1),this._controlTypeTemplate.check(!1),this._controlTypeScene.check(!1)}b=this.makeTypeCd();var d=this._controlSearchEdit.text();
this._frameSet._listContent.serviceSearch(b,d,"",this._contentPageSize,0);this.storageSet("resource_type_cd",b);this.storageSet("control_type_bitmap:check",RBoolean.toString(this._controlTypeBitmap.isCheck()));this.storageSet("control_type_material:check",RBoolean.toString(this._controlTypeMaterial.isCheck()));this.storageSet("control_type_model:check",RBoolean.toString(this._controlTypeModel.isCheck()));this.storageSet("control_type_template:check",RBoolean.toString(this._controlTypeTemplate.isCheck()));
this.storageSet("control_type_scene:check",RBoolean.toString(this._controlTypeScene.isCheck()));this.storageUpdate()}function FDsResourceListToolBar_construct(){this.__base.FUiToolBar.construct.call(this)}
function FDsResourceListToolBar_makeTypeCd(){var b="";this._controlTypeBitmap.isCheck()&&(b+="|Bitmap");this._controlTypeMaterial.isCheck()&&(b+="|Material");this._controlTypeModel.isCheck()&&(b+="|Model");this._controlTypeTemplate.isCheck()&&(b+="|Template");this._controlTypeScene.isCheck()&&(b+="|Scene");""!=b&&(b=b.substring(1));RString.isEmpty(b)&&(b="All");return b}
function FDsResourceListToolBar_setNavigator(b,d,f){this._contentPageSize=b;this._contentPageCount=d;this._contentPage=f;this._controlPageEdit.setText(f)}function FDsResourceListToolBar_doNavigator(b){var d=this.makeTypeCd(),f=this._controlSearchEdit.text();b=RInteger.toRange(b,0,this._contentPageCount);this._contentTypeCd==d&&this._contentSerach==f&&this._contentPage==b||this._frameSet._listContent.serviceSearch(d,f,"",this._contentPageSize,b);this._contentTypeCd=d;this._contentSerach=f}
function FDsResourceListToolBar_storageLoad(){this._controlTypeBitmap.check(this.storageGetBoolean("control_type_bitmap:check",!0));this._controlTypeMaterial.check(this.storageGetBoolean("control_type_material:check",!0));this._controlTypeModel.check(this.storageGetBoolean("control_type_model:check",!0));this._controlTypeTemplate.check(this.storageGetBoolean("control_type_template:check",!0));this._controlTypeScene.check(this.storageGetBoolean("control_type_scene:check",!0));this.makeTypeCd();var b=
this.storageGet("resource_type_cd","All"),d=this._controlSearchEdit.text();this._frameSet._listContent.serviceSearch(b,d,"",this._contentPageSize,0)}function FDsResourceListToolBar_dispose(){this.__base.FUiToolBar.dispose.call(this)}
function FDsResourceMenuBar(b){b=RClass.inherits(this,b,FUiMenuBar);b._controlImportPicture=null;b._controlImportModel=null;b._controlCreateMaterial=null;b._controlCreateTemplate=null;b._controlCreateScene=null;b._controlDelete=null;b._controlShareOpen=null;b._controlShareClose=null;b.onImportPictureClick=FDsResourceMenuBar_onImportPictureClick;b.onImportModelClick=FDsResourceMenuBar_onImportModelClick;b.onCreateMaterialClick=FDsResourceMenuBar_onCreateMaterialClick;b.onCreateTemplateClick=FDsResourceMenuBar_onCreateTemplateClick;
b.onCreateSceneClick=FDsResourceMenuBar_onCreateSceneClick;b.onDeleteLoad=FDsResourceMenuBar_onDeleteLoad;b.onDeleteExecute=FDsResourceMenuBar_onDeleteExecute;b.onDeleteClick=FDsResourceMenuBar_onDeleteClick;b.onShareLoad=FDsResourceMenuBar_onShareLoad;b.onShareClick=FDsResourceMenuBar_onShareClick;b.construct=FDsResourceMenuBar_construct;b.dispose=FDsResourceMenuBar_dispose;return b}
function FDsResourceMenuBar_onImportPictureClick(b){var d=this._workspace._activeFrameSet._catalogContent.focusNode(),f=b=null;d&&(b=d.guid(),f=d.label());d=RConsole.find(FUiWindowConsole).find(FDsResourceImportDialog);d._frameSet=this._frameSet;d._workspace=this._workspace;d._nodeGuid=b;d.setNodeLabel(f);d.switchMode(EE3sResource.Bitmap);d.showPosition(EUiPosition.Center)}
function FDsResourceMenuBar_onImportModelClick(b){var d=this._workspace._activeFrameSet._catalogContent.focusNode(),f=b=null;d&&(b=d.guid(),f=d.label());d=RConsole.find(FUiWindowConsole).find(FDsResourceImportDialog);d._frameSet=this._frameSet;d._workspace=this._workspace;d._nodeGuid=b;d.setNodeLabel(f);d.switchMode(EE3sResource.Model);d.showPosition(EUiPosition.Center)}
function FDsResourceMenuBar_onCreateMaterialClick(){var b=this._workspace._activeFrameSet._catalogContent.focusNode(),d=null,f=null;b&&(d=b.guid(),f=b.label());b=RConsole.find(FUiWindowConsole).find(FDsResourceCreateDialog);b._frameSet=this._frameSet;b._workspace=this._workspace;b._nodeGuid=d;b.setNodeLabel(f);b.switchMode(EE3sResource.Material);b.showPosition(EUiPosition.Center)}
function FDsResourceMenuBar_onCreateTemplateClick(){var b=this._workspace._activeFrameSet._catalogContent.focusNode(),d=null,f=null;b&&(d=b.guid(),f=b.label());b=RConsole.find(FUiWindowConsole).find(FDsResourceCreateDialog);b._frameSet=this._frameSet;b._workspace=this._workspace;b._nodeGuid=d;b.setNodeLabel(f);b.switchMode(EE3sResource.Template);b.showPosition(EUiPosition.Center)}
function FDsResourceMenuBar_onCreateSceneClick(){var b=this._workspace._activeFrameSet._catalogContent.focusNode(),d=null,f=null;b&&(d=b.guid(),f=b.label());b=RConsole.find(FUiWindowConsole).find(FDsResourceCreateDialog);b._frameSet=this._frameSet;b._workspace=this._workspace;b._nodeGuid=d;b.setNodeLabel(f);b.switchMode(EE3sResource.Scene);b.showPosition(EUiPosition.Center)}
function FDsResourceMenuBar_onDeleteLoad(b){RConsole.find(FUiDesktopConsole).hide();this._frameSet._listContent.serviceResearch()}function FDsResourceMenuBar_onDeleteExecute(b){if(b.resultCd!=EResult.Success)RConsole.find(FUiDesktopConsole).hide();else{var d=this._frameSet._listContent.focusItem();b=d._typeCd;d=d._guid;RConsole.find(FUiDesktopConsole).showUploading();RConsole.find(FDrResourceConsole).doDelete(b,d).addLoadListener(this,this.onDeleteLoad)}}
function FDsResourceMenuBar_onDeleteClick(b){if(!this._frameSet._listContent.focusItem())return alert("\u8bf7\u9009\u4e2d\u540e\u518d\u70b9\u51fb\u5220\u9664");RConsole.find(FUiMessageConsole).showConfirm("\u8bf7\u786e\u8ba4\u662f\u5426\u5220\u9664\u5f53\u524d\u8d44\u6e90\uff1f").addResultListener(this,this.onDeleteExecute)}function FDsResourceMenuBar_onShareLoad(){RConsole.find(FUiDesktopConsole).hide()}
function FDsResourceMenuBar_onShareClick(b){var d=this._frameSet._listContent.focusItem();if(!d)return alert("\u8bf7\u9009\u4e2d\u540e\u518d\u70b9\u51fb\u5220\u9664");var f=null,f="shareOpen"==b.sender.name()?"Public":"Private";b=d._guid;RConsole.find(FUiDesktopConsole).showUploading();RConsole.find(FDrResourceConsole).doShare(b,f).addLoadListener(this,this.onShareLoad)}function FDsResourceMenuBar_construct(){this.__base.FUiMenuBar.construct.call(this)}
function FDsResourceMenuBar_dispose(){this.__base.FUiMenuBar.dispose.call(this)}
function FDsResourcePropertyContent(b){b=RClass.inherits(this,b,FDsCanvas);b._activeSpace=null;b._canvasModeCd=EDsCanvasMode.Drop;b._canvasMoveCd=EDsCanvasDrag.Unknown;b._optionRotation=!1;b._rotation=null;b._capturePosition=null;b._captureMatrix=null;b._captureRotation=null;b._dimensional=null;b._selectObject=null;b._selectBoundBox=null;b._selectRenderables=null;b._cameraMoveRate=8;b._cameraKeyRotation=3;b._cameraMouseRotation=.005;b._templateMatrix=null;b._templateRenderable=null;b._templateFace=
null;b._templateTranslation=null;b._templateRotation=null;b._templateScale=null;b._templateViewScale=.05;b.onBuild=FDsResourcePropertyContent_onBuild;b.onMouseCaptureStart=FDsResourcePropertyContent_onMouseCaptureStart;b.onMouseCapture=FDsResourcePropertyContent_onMouseCapture;b.onMouseCaptureStop=FDsResourcePropertyContent_onMouseCaptureStop;b.onEnterFrame=FDsResourcePropertyContent_onEnterFrame;b.onMeshLoad=FDsResourcePropertyContent_onMeshLoad;b.oeResize=FDsResourcePropertyContent_oeResize;b.oeRefresh=
FDsResourcePropertyContent_oeRefresh;b.construct=FDsResourcePropertyContent_construct;b.innerSelectDisplay=FDsResourcePropertyContent_innerSelectDisplay;b.innerSelectLayer=FDsResourcePropertyContent_innerSelectLayer;b.selectNone=FDsResourcePropertyContent_selectNone;b.selectDisplay=FDsResourcePropertyContent_selectDisplay;b.selectMaterial=FDsResourcePropertyContent_selectMaterial;b.selectRenderable=FDsResourcePropertyContent_selectRenderable;b.switchRotation=FDsResourcePropertyContent_switchRotation;
b.reloadRegion=FDsResourcePropertyContent_reloadRegion;b.loadMeshByGuid=FDsResourcePropertyContent_loadMeshByGuid;b.loadMeshByCode=FDsResourcePropertyContent_loadMeshByCode;b.dispose=FDsResourcePropertyContent_dispose;return b}function FDsResourcePropertyContent_onBuild(b){this.__base.FDsCanvas.onBuild.call(this,b)}
function FDsResourcePropertyContent_onMouseCaptureStart(b){var d=this._activeSpace;if(d){var f=this._activeSpace.region(),f=RConsole.find(FG3dTechniqueConsole).find(this._graphicContext,FG3dSelectTechnique).test(f,b.offsetX,b.offsetY);this.selectRenderable(f);this._capturePosition.set(b.clientX,b.clientY);this._captureRotation.assign(d.camera()._rotation);f&&(f=f.display(),this._captureMatrix.assign(f.matrix()));this._templateMatrix.identity();if(this._templateFace)for(this._templateFaceMatrix.assign(this._templateFace.matrix()),
b=this._selectRenderables,d=b.count()-1;0<=d;d--)f=b.getAt(d),f._dragMatrix||(f._dragMatrix=new SMatrix3d),f._dragMatrix.assign(f.matrix());RHtml.cursorSet(this._hPanel,EUiCursor.Pointer)}}
function FDsResourcePropertyContent_onMouseCapture(b){if(this._activeSpace){var d=b.clientX-this._capturePosition.x,f=b.clientY-this._capturePosition.y,h=this._canvasMoveCd,q=this._templateFace;b=this._templateMatrix;switch(this._canvasModeCd){case EDsCanvasMode.Drop:var h=this._activeSpace.camera().rotation(),z=this._captureRotation;h.x=z.x-f*this._cameraMouseRotation;h.y=z.y-d*this._cameraMouseRotation;break;case EDsCanvasMode.Translate:q&&(h==EDsCanvasDrag.X?b.tx=d/10:h==EDsCanvasDrag.Y?b.ty=-f/
10:h==EDsCanvasDrag.Z&&(b.tz=d/10));break;case EDsCanvasMode.Rotation:q&&(h==EDsCanvasDrag.X?b.rx=d/10:h==EDsCanvasDrag.Y?b.ry=-f/10:h==EDsCanvasDrag.Z&&(b.rz=d/10));break;case EDsCanvasMode.Scale:q&&(h==EDsCanvasDrag.X?b.sx=d/10:h==EDsCanvasDrag.Y?b.sy=-f/10:h==EDsCanvasDrag.Z?b.sz=d/10:h==EDsCanvasDrag.All&&(b.sx=d/10,b.sy=d/10,b.sz=d/10))}if(q)for(q.matrix().merge(this._templateFaceMatrix,b),d=this._selectRenderables,f=d.count()-1;0<=f;f--)h=d.getAt(f),h._matrix.merge(h._dragMatrix,b)}}
function FDsResourcePropertyContent_onMouseCaptureStop(b){RHtml.cursorSet(this._hPanel,EUiCursor.Auto)}
function FDsResourcePropertyContent_onEnterFrame(){var b=this._activeSpace;if(b){var d=b.timer().spanSecond(),b=b.camera(),f=this._cameraMoveRate*d,d=this._cameraKeyRotation*d,h=RKeyboard.isPress(EStageKey.Forward),q=RKeyboard.isPress(EStageKey.Back);h&&!q&&b.doWalk(f);!h&&q&&b.doWalk(-f);h=RKeyboard.isPress(EStageKey.Up);q=RKeyboard.isPress(EStageKey.Down);h&&!q&&b.doFly(f);!h&&q&&b.doFly(-f);f=RKeyboard.isPress(EStageKey.RotationLeft);h=RKeyboard.isPress(EStageKey.RotationRight);f&&!h&&b.doYaw(d);
!f&&h&&b.doYaw(-d);f=RKeyboard.isPress(EStageKey.RotationUp);h=RKeyboard.isPress(EStageKey.RotationDown);f&&!h&&b.doPitch(d);!f&&h&&b.doPitch(-d);b.update();this._optionRotation&&(d=this._rotation,b=this._activeSpace._display.matrix(),b.setRotation(b.rx,b.ry+d.y,b.rz),b.update(),d.y=.01)}}
function FDsResourcePropertyContent_onMeshLoad(b){b=this._activeSpace.region();var d=b.camera();d.setPosition(0,3,-10);d.lookAt(0,3,0);d.update();var f=this._hPanel,d=d.projection();d.size().set(f.width,f.height);d._angle=45;d.update();b=b.directionalLight().camera();b.setPosition(10,10,0);b.lookAt(0,0,0);b.update();this.processLoadListener(this)}
function FDsResourcePropertyContent_oeResize(b){this.__base.FDsCanvas.oeResize.call(this,b);var d=this._hPanel;b=d.offsetWidth;var d=d.offsetHeight,f=this._activeSpace;f&&(f=f.camera().projection(),f.size().set(b,d),f.update());return EEventStatus.Stop}function FDsResourcePropertyContent_oeRefresh(b){return EEventStatus.Stop}
function FDsResourcePropertyContent_construct(){this.__base.FDsCanvas.construct.call(this);this._capturePosition=new SPoint2;this._captureMatrix=new SMatrix3d;this._templateMatrix=new SMatrix3d;this._templateFaceMatrix=new SMatrix3d;this._rotation=new SVector3;this._captureRotation=new SVector3;this._selectRenderables=new TObjects}
function FDsResourcePropertyContent_innerSelectDisplay(b){b=b.renderables();for(var d=b.count(),f=0;f<d;f++){var h=b.getAt(f);RClass.isClass(h,FDsSceneRenderable)&&(this._selectRenderables.push(h),h.showBoundBox())}}function FDsResourcePropertyContent_innerSelectLayer(b){b=b.displays();for(var d=b.count(),f=0;f<d;f++){var h=b.getAt(f);this.innerSelectDisplay(h)}}
function FDsResourcePropertyContent_selectNone(){this._selectObject=null;for(var b=this._selectRenderables,d=b.count(),f=0;f<d;f++)b.get(f).hideBoundBox();this._selectRenderables.clear()}function FDsResourcePropertyContent_selectDisplay(b){this.selectNone();this._selectObject=b;this.innerSelectDisplay(b)}
function FDsResourcePropertyContent_selectMaterial(b){this.selectNone();this._selectObject=b;for(var d=b._display.renderables(),f=d.count(),h=0;h<f;h++){var q=d.get(h);q._materialReference==b&&(this._selectRenderables.push(q),q._optionSelected=!0,q.showBoundBox())}}
function FDsResourcePropertyContent_selectRenderable(b){if(b)switch(b._renderable._resource._code){case "ms_translation_x":this._canvasMoveCd=EDsCanvasDrag.X;this._templateRenderable=b;return;case "ms_translation_y":this._canvasMoveCd=EDsCanvasDrag.Y;this._templateRenderable=b;return;case "ms_translation_z":this._canvasMoveCd=EDsCanvasDrag.Z;this._templateRenderable=b;return;case "ms_rotation_x":this._canvasMoveCd=EDsCanvasDrag.X;this._templateRenderable=b;return;case "ms_rotation_y":this._canvasMoveCd=
EDsCanvasDrag.Y;this._templateRenderable=b;return;case "ms_rotation_z":this._canvasMoveCd=EDsCanvasDrag.Z;this._templateRenderable=b;return;case "ms_scale_x":this._canvasMoveCd=EDsCanvasDrag.X;this._templateRenderable=b;return;case "ms_scale_y":this._canvasMoveCd=EDsCanvasDrag.Y;this._templateRenderable=b;return;case "ms_scale_z":this._canvasMoveCd=EDsCanvasDrag.Z;this._templateRenderable=b;return;case "ms_scale_all":this._canvasMoveCd=EDsCanvasDrag.All;this._templateRenderable=b;return;default:this._canvasMoveCd=
EDsCanvasDrag.Unknown,this._templateRenderable=null}this.selectNone();b&&(this._selectRenderables.push(b),b._optionSelected=!0,b.showBoundBox(),this._workspace._catalog.showObject(b));var d=this._templateTranslation,f=this._templateRotation,h=this._templateScale;switch(this._canvasModeCd){case EDsCanvasMode.Translate:d.setVisible(null!=b);f.hide();h.hide();this._templateFace=d;break;case EDsCanvasMode.Rotation:d.hide();f.setVisible(null!=b);h.hide();this._templateFace=f;break;case EDsCanvasMode.Scale:d.hide(),
f.hide(),h.setVisible(null!=b),this._templateFace=h}d=this._templateFace;b&&d&&(b=b.display(),d=d.matrix(),d.assign(b.matrix()),d.setScaleAll(this._templateViewScale),d.update())}function FDsResourcePropertyContent_switchMode(b){this._canvasModeCd=b;this.selectRenderable(this._selectRenderable)}function FDsResourcePropertyContent_switchRotation(b){this._optionRotation=b}
function FDsResourcePropertyContent_reloadRegion(b){b=b.resource();this._cameraMoveRate=b.moveSpeed();this._cameraKeyRotation=b.rotationKeySpeed();this._cameraMouseRotation=b.rotationMouseSpeed()}function FDsResourcePropertyContent_loadMeshByGuid(b){var d=RConsole.find(FE3dMeshConsole);null!=this._activeSpace&&d.free(this._activeSpace);b=this._activeSpace=d.allocByGuid(this,b);b.addLoadListener(this,this.onMeshLoad);b._layer.pushRenderable(this._dimensional);RStage.register("mesh3d",b)}
function FDsResourcePropertyContent_loadMeshByCode(b){var d=RConsole.find(FE3dMeshConsole);null!=this._activeSpace&&d.free(this._activeSpace);b=this._activeSpace=d.allocByCode(this,b);b.addLoadListener(this,this.onMeshLoad);b._layer.pushRenderable(this._dimensional);RStage.register("mesh3d",b)}function FDsResourcePropertyContent_dispose(){this._rotation=RObject.dispose(this._rotation);this.__base.FDsCanvas.dispose.call(this)}
function FDsResourcePropertyToolBar(b){b=RClass.inherits(this,b,FUiToolBar);b._frameName="resource.resource.PropertyToolBar";b._controlInsertButton=null;b._controlUpdateButton=null;b._controlDeleteButton=null;b._controlRotationButton=null;b.onBuilded=FDsResourcePropertyToolBar_onBuilded;b.onUpdateClick=FDsResourcePropertyToolBar_onUpdateClick;b.onRotationClick=FDsResourcePropertyToolBar_onRotationClick;b.construct=FDsResourcePropertyToolBar_construct;b.dispose=FDsResourcePropertyToolBar_dispose;return b}
function FDsResourcePropertyToolBar_onBuilded(b){this.__base.FUiToolBar.onBuilded.call(this,b);this._controlUpdateButton.addClickListener(this,this.onUpdateClick);this._controlRotationButton.addClickListener(this,this.onRotationClick)}function FDsResourcePropertyToolBar_onUpdateClick(b){}function FDsResourcePropertyToolBar_onRotationClick(b){this._workspace._previewContent.switchRotation(b.checked)}function FDsResourcePropertyToolBar_construct(){this.__base.FUiToolBar.construct.call(this)}
function FDsResourcePropertyToolBar_dispose(){this.__base.FUiToolBar.dispose.call(this)}
function FDsResourceSelectCatalogToolBar(b){b=RClass.inherits(this,b,FUiToolBar);b._frameName="resource.resource.SelectCatalogToolBar";b._controlFolderOpen=null;b._controlFolderClose=null;b._activeNodeGuid=null;b.onBuilded=FDsResourceSelectCatalogToolBar_onBuilded;b.onFolderOpenClick=FDsResourceSelectCatalogToolBar_onFolderOpenClick;b.onFolderCloseClick=FDsResourceSelectCatalogToolBar_onFolderCloseClick;b.construct=FDsResourceSelectCatalogToolBar_construct;b.dispose=FDsResourceSelectCatalogToolBar_dispose;
return b}function FDsResourceSelectCatalogToolBar_onBuilded(b){this.__base.FUiToolBar.onBuilded.call(this,b);this._controlFolderOpen.addClickListener(this,this.onFolderOpenClick);this._controlFolderClose.addClickListener(this,this.onFolderCloseClick)}function FDsResourceSelectCatalogToolBar_onFolderOpenClick(b){}function FDsResourceSelectCatalogToolBar_onFolderCloseClick(b){}function FDsResourceSelectCatalogToolBar_construct(){this.__base.FUiToolBar.construct.call(this)}
function FDsResourceSelectCatalogToolBar_dispose(){this.__base.FUiToolBar.dispose.call(this)}
function FDsResourceSelectDialog(b){b=RClass.inherits(this,b,FUiDialog);b._frameName="resource.resource.SelectDialog";b._styleToolbarGround=RClass.register(b,new AStyle("_styleToolbarGround","Toolbar_Ground"));b._styleCatalogContent=RClass.register(b,new AStyle("_styleCatalogContent","Catalog_Content"));b._styleListContent=RClass.register(b,new AStyle("_styleListContent","List_Content"));b._dataModeCd=null;b._controlParentLabel=null;b._controlLabel=null;b._controlConfirmButton=null;b._controlCancelButton=
null;b.onBuilded=FDsResourceSelectDialog_onBuilded;b.onConfirmLoad=FDsResourceSelectDialog_onConfirmLoad;b.onConfirmClick=FDsResourceSelectDialog_onConfirmClick;b.onCancelClick=FDsResourceSelectDialog_onCancelClick;b.construct=FDsResourceSelectDialog_construct;b.setNodeParentLabel=FDsResourceSelectDialog_setNodeParentLabel;b.setNodeLabel=FDsResourceSelectDialog_setNodeLabel;b.switchDataMode=FDsResourceSelectDialog_switchDataMode;b.dispose=FDsResourceSelectDialog_dispose;return b}
function FDsResourceSelectDialog_onBuilded(b){this.__base.FUiDialog.onBuilded.call(this,b);this._controlConfirm.addClickListener(this,this.onConfirmClick);this._controlCancel.addClickListener(this,this.onCancelClick);this._frameCatalogToolBar._hPanel.className=this.styleName("Toolbar_Ground");this._frameCatalogContent._hPanel.className=this.styleName("Catalog_Content");this._frameListToolBar._hPanel.className=this.styleName("Toolbar_Ground");this._frameListContent._hPanel.className=this.styleName("List_Content");
var d=this._catalogSplitter=this.searchControl("catalogSpliter");d.setAlignCd(EUiAlign.Left);d.setSizeHtml(this._frameCatalog._hPanel);d=this._catalogToolbar=RClass.create(FDsResourceSelectCatalogToolBar);d._workspace=this._workspace;d._frameSet=this;d.buildDefine(b);this._frameCatalogToolBar.push(d);d=this._catalogContent=RClass.create(FDsResourceCatalogContent);d._workspace=this._workspace;d._frameSet=this;d.build(b);this._frameCatalogContent.push(d);d=this._listToolBar=RClass.create(FDsResourceSelectListToolBar);
d._workspace=this._workspace;d._frameSet=this;d.buildDefine(b);this._frameListToolBar.push(d);d=this._listContent=RClass.create(FDsResourceListContent);d._workspace=this._workspace;d._frameSet=this;d.build(b);this._frameListContent.push(d);this._listContent.serviceSearch()}
function FDsResourceSelectDialog_onConfirmLoad(b){RConsole.find(FUiDesktopConsole).hide();this.hide();b=this._frameSet._catalogContent;if(this._dataModeCd==EUiDataMode.Insert)if(this._parentGuid){var d=b.findByGuid(this._parentGuid);b.loadNode(d)}else b.loadService();else{var f=this._controlLabel.get(),d=b.focusNode();d.setLabel(f)}}
function FDsResourceSelectDialog_onConfirmClick(b){RConsole.find(FUiDesktopConsole).showUploading();b=this._controlLabel.get();var d=RConsole.find(FDrResourceConsole),f=null,f=this._dataModeCd==EUiDataMode.Insert?d.doFolderCreate(this._parentGuid,null,b):d.doFolderUpdate(this._nodeGuid,null,b);f.addLoadListener(this,this.onConfirmLoad)}function FDsResourceSelectDialog_onCancelClick(b){this.hide()}function FDsResourceSelectDialog_construct(){this.__base.FUiDialog.construct.call(this)}
function FDsResourceSelectDialog_setNodeParentLabel(b){this._controlParentLabel.set(b)}function FDsResourceSelectDialog_setNodeLabel(b){this._controlLabel.set(b)}function FDsResourceSelectDialog_switchDataMode(b){this._dataModeCd=b;b==EUiDataMode.Insert?this.setLabel("\u65b0\u5efa\u8d44\u6e90\u76ee\u5f55"):b==EUiDataMode.Update&&this.setLabel("\u8d44\u6e90\u76ee\u5f55\u5c5e\u6027")}function FDsResourceSelectDialog_dispose(){this.__base.FUiDialog.dispose.call(this)}
function FDsResourceSelectListToolBar(b){b=RClass.inherits(this,b,FUiToolBar,MUiStorage);b._frameName="resource.resource.SelectListToolBar";b._storageCode=b._frameName;b._dropButton=null;b._selectButton=null;b._translateButton=null;b._rotationButton=null;b._scaleButton=null;b._lookFrontButton=null;b._lookUpButton=null;b._lookLeftButton=null;b._playButton=null;b._viewButton=null;b.onBuilded=FDsResourceSelectListToolBar_onBuilded;b.onSearchClick=FDsResourceSelectListToolBar_onSearchClick;b.onNavigatorClick=
FDsResourceSelectListToolBar_onNavigatorClick;b.onTypeClick=FDsResourceSelectListToolBar_onTypeClick;b.construct=FDsResourceSelectListToolBar_construct;b.makeTypeCd=FDsResourceSelectListToolBar_makeTypeCd;b.setNavigator=FDsResourceSelectListToolBar_setNavigator;b.doNavigator=FDsResourceSelectListToolBar_doNavigator;b.storageLoad=FDsResourceSelectListToolBar_storageLoad;b.dispose=FDsResourceSelectListToolBar_dispose;return b}
function FDsResourceSelectListToolBar_onBuilded(b){this.__base.FUiToolBar.onBuilded.call(this,b);this._controlSearchEdit.addClickListener(this,this.onSearchClick);this._controlFirstButton.addClickListener(this,this.onNavigatorClick);this._controlPriorButton.addClickListener(this,this.onNavigatorClick);this._controlNextButton.addClickListener(this,this.onNavigatorClick);this._controlLastButton.addClickListener(this,this.onNavigatorClick)}
function FDsResourceSelectListToolBar_onSearchClick(b){this.doNavigator(0)}function FDsResourceSelectListToolBar_onNavigatorClick(b){b=b.sender.name();var d=this._contentPage;switch(b){case "firstButton":d=0;break;case "priorButton":d--;break;case "nextButton":d++;break;case "lastButton":d=this._contentPageCount-1}this.doNavigator(d)}
function FDsResourceSelectListToolBar_onTypeClick(b){switch(b.sender.name()){case "typeAll":this._controlTypeBitmap.check(!0);this._controlTypeMaterial.check(!0);this._controlTypeModel.check(!0);this._controlTypeTemplate.check(!0);break;case "typeNone":this._controlTypeBitmap.check(!1),this._controlTypeMaterial.check(!1),this._controlTypeModel.check(!1),this._controlTypeTemplate.check(!1)}b=this.makeTypeCd();var d=this._controlSearchEdit.text();this._frameSet._listContent.serviceSearch(b,d,"",this._contentPageSize,
0);this.storageSet("resource_type_cd",b);this.storageSet("control_type_bitmap:check",RBoolean.toString(this._controlTypeBitmap.isCheck()));this.storageSet("control_type_material:check",RBoolean.toString(this._controlTypeMaterial.isCheck()));this.storageSet("control_type_model:check",RBoolean.toString(this._controlTypeModel.isCheck()));this.storageSet("control_type_template:check",RBoolean.toString(this._controlTypeTemplate.isCheck()));this.storageSet("control_type_scene:check",RBoolean.toString(this._controlTypeScene.isCheck()));
this.storageUpdate()}function FDsResourceSelectListToolBar_construct(){this.__base.FUiToolBar.construct.call(this)}function FDsResourceSelectListToolBar_makeTypeCd(){var b="";this._controlTypeBitmap.isCheck()&&(b+="|Bitmap");this._controlTypeMaterial.isCheck()&&(b+="|Material");this._controlTypeModel.isCheck()&&(b+="|Model");this._controlTypeTemplate.isCheck()&&(b+="|Template");this._controlTypeScene.isCheck()&&(b+="|Scene");""!=b&&(b=b.substring(1));RString.isEmpty(b);return"All"}
function FDsResourceSelectListToolBar_setNavigator(b,d,f){this._contentPageSize=b;this._contentPageCount=d;this._contentPage=f;this._controlPageEdit.setText(f)}
function FDsResourceSelectListToolBar_doNavigator(b){var d=this.makeTypeCd(),f=this._controlSearchEdit.text();b=RInteger.toRange(b,0,this._contentPageCount);this._contentTypeCd==d&&this._contentSerach==f&&this._contentPage==b||this._frameSet._listContent.serviceSearch(d,f,"",this._contentPageSize,b);this._contentTypeCd=d;this._contentSerach=f}
function FDsResourceSelectListToolBar_storageLoad(){this._controlTypeBitmap.check(this.storageGetBoolean("control_type_bitmap:check",!0));this._controlTypeMaterial.check(this.storageGetBoolean("control_type_material:check",!0));this._controlTypeModel.check(this.storageGetBoolean("control_type_model:check",!0));this._controlTypeTemplate.check(this.storageGetBoolean("control_type_template:check",!0));this._controlTypeScene.check(this.storageGetBoolean("control_type_scene:check",!0));this.makeTypeCd();
var b=this.storageGet("resource_type_cd","All"),d=this._controlSearchEdit.text();this._frameSet._listContent.serviceSearch(b,d,"",this._contentPageSize,0)}function FDsResourceSelectListToolBar_dispose(){this.__base.FUiToolBar.dispose.call(this)}
function FDsResourceTabBar(b){b=RClass.inherits(this,b,FUiTabBar);b._frameName="design3d.resource.TabBar";b._resourceTypeCd="mesh";b._controlPictureButton=null;b._controlSoundButton=null;b._controlVidioButton=null;b._controlTextureButton=null;b._controlMaterialButton=null;b._controlMeshButton=null;b._controlModelButton=null;b._controlTemplateButton=null;b._controlSceneButton=null;b.onBuilded=FDsResourceTabBar_onBuilded;b.onButtonClick=FDsResourceTabBar_onButtonClick;b.construct=FDsResourceTabBar_construct;
b.dispose=FDsResourceTabBar_dispose;return b}
function FDsResourceTabBar_onBuilded(b){this.__base.FUiTabBar.onBuilded.call(this,b);this._controlPictureButton.addClickListener(this,this.onButtonClick);this._controlSoundButton.addClickListener(this,this.onButtonClick);this._controlVidioButton.addClickListener(this,this.onButtonClick);this._controlTextureButton.addClickListener(this,this.onButtonClick);this._controlMaterialButton.addClickListener(this,this.onButtonClick);this._controlMeshButton.addClickListener(this,this.onButtonClick);this._controlModelButton.addClickListener(this,
this.onButtonClick);this._controlTemplateButton.addClickListener(this,this.onButtonClick);this._controlSceneButton.addClickListener(this,this.onButtonClick)}function FDsResourceTabBar_onButtonClick(b){this._resourceTypeCd=b.sender.name()}function FDsResourceTabBar_construct(){this.__base.FUiTabBar.construct.call(this)}function FDsResourceTabBar_dispose(){this.__base.FUiTabBar.dispose.call(this)}
function FDsResourceWorkspace(b){b=RClass.inherits(this,b,FUiWorkspace);b._frameName="resource.resource.Workspace";b._styleToolbarGround=RClass.register(b,new AStyle("_styleToolbarGround","Toolbar_Ground"));b._styleStatusbarGround=RClass.register(b,new AStyle("_styleStatusbarGround","Statusbar_Ground"));b._styleCatalogGround=RClass.register(b,new AStyle("_styleCatalogGround","Catalog_Ground"));b._styleCatalogToolbar=RClass.register(b,new AStyle("_styleCatalogToolbar","Catalog_Toolbar"));b._styleSearchGround=
RClass.register(b,new AStyle("_styleSearchGround","Search_Ground"));b._styleSearchToolbar=RClass.register(b,new AStyle("_styleCatalogToolbar","Search_Toolbar"));b._stylePreviewGround=RClass.register(b,new AStyle("_stylePreviewGround","Preview_Ground"));b._stylePreviewToolbar=RClass.register(b,new AStyle("_stylePreviewToolbar","Preview_Toolbar"));b._stylePropertyGround=RClass.register(b,new AStyle("_stylePropertyGround","Property_Ground"));b._styleWorkspaceGround=RClass.register(b,new AStyle("_styleWorkspaceGround",
"Workspace_Ground"));b._resourceTypeCd="picture";b._frameToolBar=null;b._frameStatusBar=null;b._frameCatalog=null;b._frameCatalogToolbar=null;b._frameCatalogContent=null;b._frameSearch=null;b._frameSearchToolbar=null;b._frameSearchContent=null;b._framePreview=null;b._framePreviewToolbar=null;b._framePreviewContent=null;b._propertyFrames=null;b.onBuilded=FDsResourceWorkspace_onBuilded;b.onMeshLoad=FDsResourceWorkspace_onMeshLoad;b.onCatalogSelected=FDsResourceWorkspace_onCatalogSelected;b.construct=
FDsResourceWorkspace_construct;b.findPropertyFrame=FDsResourceWorkspace_findPropertyFrame;b.switchContent=FDsResourceWorkspace_switchContent;b.load=FDsResourceWorkspace_load;b.dispose=FDsResourceWorkspace_dispose;return b}
function FDsResourceWorkspace_onBuilded(b){this.__base.FUiWorkspace.onBuilded.call(this,b);var d=this._frameToolBar=this.searchControl("toolbarFrame");d._hPanel.className=this.styleName("Toolbar_Ground");d=this._frameBody=this.searchControl("bodyFrame");d._hPanel.className=this.styleName("Catalog_Ground");d=this._frameStatusBar=this.searchControl("statusFrame");d._hPanel.className=this.styleName("Statusbar_Ground");d=RBuilder.createTable(b);d.width="100%";var f=RBuilder.appendTableRow(d),h=this._toolbar=
RClass.create(FDsResourceMenuBar);h._workspace=this;h.buildDefine(b);var q=RBuilder.appendTableCell(f);q.appendChild(h._hPanel);h=this._tabBar=RClass.create(FDsResourceTabBar);h._workspace=this;h.buildDefine(b);q=RBuilder.appendTableCell(f);q.width="450px";q.align="right";q.vAlign="bottom";q.appendChild(h._hPanel);this._frameToolBar._hPanel.appendChild(d);d=this._frameSet=RClass.create(FDsResourceFrameSet);d._workspace=this;d.buildDefine(b);this._frameBody.push(d);d.switchContent(this._resourceTypeCd)}
function FDsResourceWorkspace_onMeshLoad(b){this._activeSpace=b._activeSpace;this._catalog.buildSpace(this._activeSpace)}
function FDsResourceWorkspace_onCatalogSelected(b,d){for(var f=this._activeSpace,h=this._propertyFrames,q=h.count(),z=0;z<q;z++){var A=h.value(z);A.hide()}if(RClass.isClass(b,FE3dStage))A=this.findPropertyFrame(EDsFrame.MeshSpacePropertyFrame),A.show(),A.loadObject(f,f);else if(RClass.isClass(b,FG3dTechnique))A=this.findPropertyFrame(EDsFrame.MeshTechniquePropertyFrame),A.show(),A.loadObject(f,b);else if(RClass.isClass(b,FE3dRegion))A=this.findPropertyFrame(EDsFrame.MeshRegionPropertyFrame),A.show(),
A.loadObject(f,b);else if(RClass.isClass(b,FE3dCamera))A=this.findPropertyFrame(EDsFrame.MeshCameraPropertyFrame),A.show(),A.loadObject(f,b);else if(RClass.isClass(b,FG3dDirectionalLight))A=this.findPropertyFrame(EDsFrame.MeshLightPropertyFrame),A.show(),A.loadObject(f,b);else if(RClass.isClass(b,FE3dMeshDisplay))A=this.findPropertyFrame(EDsFrame.MeshDisplayPropertyFrame),A.show(),A.loadObject(f,b);else if(RClass.isClass(b,FG3dMaterial))A=this.findPropertyFrame(EDsFrame.MeshMaterialPropertyFrame),
A.show(),A.loadObject(f,b);else if(RClass.isClass(b,FE3dMeshRenderable))A=this.findPropertyFrame(EDsFrame.MeshRenderablePropertyFrame),A.show(),A.loadObject(f,b);else throw new TError("Unknown select object type. (value={1})",b);}function FDsResourceWorkspace_construct(){this.__base.FUiWorkspace.construct.call(this);this._propertyFrames=new TDictionary}
function FDsResourceWorkspace_findPropertyFrame(b){var d=this._propertyFrames.get(b);d||(d=RConsole.find(FFrameConsole).get(this,b,this._framePreview._hContainer),d._workspace=this,this._propertyFrames.set(b,d));return d}function FDsResourceWorkspace_switchContent(b){this._frameSet.switchContent(b)}function FDsResourceWorkspace_load(){}function FDsResourceWorkspace_dispose(){this.__base.FUiWorkspace.dispose.call(this);this._propertyFrames.dispose();this._propertyFrames=null}
function FDsBitmapCanvasContent(b){return b=RClass.inherits(this,b,FDsBitmapCanvas)}
function FDsBitmapCanvasToolBar(b){b=RClass.inherits(this,b,FUiToolBar);b._canvasModeCd=EDsCanvasMode.Drop;b._controlSize1=null;b._controlSize2=null;b._controlSize3=null;b._controlSize4=null;b._controlSizeWidth=null;b._controlSizeHeight=null;b.onBuilded=FDsBitmapCanvasToolBar_onBuilded;b.onSizeClick=FDsBitmapCanvasToolBar_onSizeClick;b.construct=FDsBitmapCanvasToolBar_construct;b.dispose=FDsBitmapCanvasToolBar_dispose;return b}
function FDsBitmapCanvasToolBar_onBuilded(b){this.__base.FUiToolBar.onBuilded.call(this,b)}function FDsBitmapCanvasToolBar_onSizeClick(b){var d=b.sender,f=b="*",h=d.name(),d=d.label();"sizeAuto"!=h&&(f=d.split("x"),b=parseInt(f[0]),f=parseInt(f[1]));this._controlSizeWidth.setText(b);this._controlSizeHeight.setText(f);this._frameSet._canvas.switchSize(b,f)}function FDsBitmapCanvasToolBar_construct(){this.__base.FUiToolBar.construct.call(this)}
function FDsBitmapCanvasToolBar_dispose(){this.__base.FUiToolBar.dispose.call(this)}
function FDsBitmapFrameSet(b){b=RClass.inherits(this,b,FDsFrameSet);b._frameCanvas=null;b._frameCanvasToolBar=null;b._frameCanvasContent=null;b._frameProperty=null;b._framePropertyToolBar=null;b._framePropertyContent=null;b.onBuilded=FDsBitmapFrameSet_onBuilded;b.onDataLoaded=FDsBitmapFrameSet_onDataLoaded;b.construct=FDsBitmapFrameSet_construct;b.loadByGuid=FDsBitmapFrameSet_loadByGuid;b.loadByCode=FDsBitmapFrameSet_loadByCode;b.reload=FDsBitmapFrameSet_reload;b.dispose=FDsBitmapFrameSet_dispose;
return b}
function FDsBitmapFrameSet_onBuilded(b){this.__base.FDsFrameSet.onBuilded.call(this,b);this._frameCanvasToolBar._hPanel.className=this.styleName("ToolBar_Ground");this._frameCanvasContent._hPanel.className=this.styleName("Canvas_Content");this._framePropertyToolBar._hPanel.className=this.styleName("ToolBar_Ground");this._framePropertyContent._hPanel.className=this.styleName("Property_Content");b=this._spliterProperty;b.setAlignCd(EUiAlign.Right);b.setSizeHtml(this._frameProperty._hPanel)}
function FDsBitmapFrameSet_onDataLoaded(b){debugger;this._activeSpace=b._activeSpace}function FDsBitmapFrameSet_construct(){this.__base.FDsFrameSet.construct.call(this)}function FDsBitmapFrameSet_loadByGuid(b){this._activeGuid=b;var d=this._activeResource=RConsole.find(FDrBitmapConsole).query(b);this._canvasContent.loadByGuid(b);this.findPropertyFrame(EDsFrame.BitmapPropertyFrame).loadObject(d)}
function FDsBitmapFrameSet_loadByCode(b){this._activeCode=b;RConsole.find(FDrBitmapConsole).query(b).addLoadListener(this,this.onDataLoaded)}function FDsBitmapFrameSet_reload(){}function FDsBitmapFrameSet_dispose(){this.__base.FDsFrameSet.dispose.call(this)}
function FDsBitmapImportDialog(b){b=RClass.inherits(this,b,FUiDialog);b._frameName="resource.bitmap.ImportDialog";b._nodeGuid=null;b._controlPrivateButton=null;b._controlTeamButton=null;b._controlShareButton=null;b.onBuilded=FDsBitmapImportDialog_onBuilded;b.onFileLoaded=FDsBitmapImportDialog_onFileLoaded;b.onConfirmLoad=FDsBitmapImportDialog_onConfirmLoad;b.onConfirmClick=FDsBitmapImportDialog_onConfirmClick;b.onCancelClick=FDsBitmapImportDialog_onCancelClick;b.construct=FDsBitmapImportDialog_construct;
b.dispose=FDsBitmapImportDialog_dispose;return b}function FDsBitmapImportDialog_onBuilded(b){this.__base.FUiDialog.onBuilded.call(this,b);this._controlConfirmButton.addClickListener(this,this.onConfirmClick);this._controlCancelButton.addClickListener(this,this.onCancelClick)}
function FDsBitmapImportDialog_onFileLoaded(b){b=this._fileReader;var d="/cloud.resource.bitmap.wv?do=updateData&guid="+this._resource.guid()+"&data_length="+b.length()+"&file_name="+b.fileName(),d=RBrowser.urlEncode(d);RConsole.find(FHttpConsole).send(d,b.data()).addLoadListener(this,this.onConfirmLoad);this._fileReader=RObject.dispose(b)}function FDsBitmapImportDialog_onConfirmLoad(b){RConsole.find(FUiDesktopConsole).hide();this.hide();this._frameSet.reload()}
function FDsBitmapImportDialog_onConfirmClick(b){RConsole.find(FUiDesktopConsole).showUploading();b=this._controlFile._hInput.files[0];var d=this._fileReader=RClass.create(FFileReader);d.addLoadListener(this,this.onFileLoaded);d.loadFile(b)}function FDsBitmapImportDialog_onCancelClick(b){this.hide()}function FDsBitmapImportDialog_construct(){this.__base.FUiDialog.construct.call(this)}function FDsBitmapImportDialog_dispose(){this.__base.FUiDialog.dispose.call(this)}
function FDsBitmapMenuBar(b){b=RClass.inherits(this,b,FUiMenuBar);b._controlBack=null;b._controlSave=null;b._controlCapture=null;b.onBuilded=FDsBitmapMenuBar_onBuilded;b.onSaveLoad=FDsBitmapMenuBar_onSaveLoad;b.onSaveClick=FDsBitmapMenuBar_onSaveClick;b.onImportClick=FDsBitmapMenuBar_onImportClick;b.construct=FDsBitmapMenuBar_construct;b.dispose=FDsBitmapMenuBar_dispose;return b}function FDsBitmapMenuBar_onBuilded(b){this.__base.FUiMenuBar.onBuilded.call(this,b)}
function FDsBitmapMenuBar_onSaveLoad(b){RConsole.find(FUiDesktopConsole).hide()}function FDsBitmapMenuBar_onSaveClick(b){b=this._frameSet._activeResource;RConsole.find(FUiDesktopConsole).showUploading();RConsole.find(FDrBitmapConsole).doUpdate(b).addLoadListener(this,this.onSaveLoad)}
function FDsBitmapMenuBar_onImportClick(b){b=this._frameSet._activeResource;var d=RConsole.find(FUiWindowConsole).find(FDsBitmapImportDialog);d._resource=b;d._frameSet=this._frameSet;d.showPosition(EUiPosition.Center)}function FDsBitmapMenuBar_construct(){this.__base.FUiMenuBar.construct.call(this)}function FDsBitmapMenuBar_dispose(){this.__base.FUiMenuBar.dispose.call(this)}
function FDsBitmapPropertyFrame(b){b=RClass.inherits(this,b,FUiForm);b._activeBitmap=null;b._controlGuid=null;b._controlCode=null;b._controlLabel=null;b._controlSizeWidth=null;b._controlSizeHeight=null;b.onBuilded=FDsBitmapPropertyFrame_onBuilded;b.onDataChanged=FDsBitmapPropertyFrame_onDataChanged;b.construct=FDsBitmapPropertyFrame_construct;b.loadObject=FDsBitmapPropertyFrame_loadObject;b.dispose=FDsBitmapPropertyFrame_dispose;return b}
function FDsBitmapPropertyFrame_construct(){this.__base.FUiForm.construct.call(this)}function FDsBitmapPropertyFrame_onBuilded(b){this.__base.FUiForm.onBuilded.call(this,b);this._controlCode.addDataChangedListener(this,this.onDataChanged);this._controlLabel.addDataChangedListener(this,this.onDataChanged)}function FDsBitmapPropertyFrame_onDataChanged(b){b=this._activeBitmap;b.setCode(this._controlCode.get());b.setLabel(this._controlLabel.get())}
function FDsBitmapPropertyFrame_loadObject(b){this._activeBitmap=b;this._controlGuid.set(b.guid());this._controlCode.set(b.code());this._controlLabel.set(b.label());this._controlSizeWidth.set(b.sizeWidth());this._controlSizeHeight.set(b.sizeHeight())}function FDsBitmapPropertyFrame_dispose(){this.__base.FUiForm.dispose.call(this)}
function FDsBitmapPropertyToolBar(b){b=RClass.inherits(this,b,FUiToolBar);b._frameName="resource.bitmap.PropertyToolBar";b._controlRefresh=null;b.onBuilded=FDsBitmapPropertyToolBar_onBuilded;b.onRefreshClick=FDsBitmapPropertyToolBar_onRefreshClick;b.construct=FDsBitmapPropertyToolBar_construct;b.dispose=FDsBitmapPropertyToolBar_dispose;return b}
function FDsBitmapPropertyToolBar_onBuilded(b){this.__base.FUiToolBar.onBuilded.call(this,b);this._controlRefresh.addClickListener(this,this.onRefreshClick)}function FDsBitmapPropertyToolBar_onRefreshClick(b){}function FDsBitmapPropertyToolBar_construct(){this.__base.FUiToolBar.construct.call(this)}function FDsBitmapPropertyToolBar_dispose(){this.__base.FUiToolBar.dispose.call(this)}
function FDsBitmapWorkspace(b){b=RClass.inherits(this,b,FUiWorkspace);b._frameName="design2d.bitmap.Workspace";b._styleWorkspaceGround=RClass.register(b,new AStyle("_styleWorkspaceGround","Workspace_Ground"));b._styleToolbarGround=RClass.register(b,new AStyle("_styleToolbarGround","Toolbar_Ground"));b._styleBodyGround=RClass.register(b,new AStyle("_styleBodyGround","Body_Ground"));b._styleStatusbarGround=RClass.register(b,new AStyle("_styleStatusbarGround","Statusbar_Ground"));b._activeSpace=null;
b._activeMesh=null;b._framesetMain=null;b._framesetBody=null;b._frameToolBar=null;b._frameBody=null;b._frameProperty=null;b._frameSet=null;b._propertyFrames=null;b.onBuilded=FDsBitmapWorkspace_onBuilded;b.onMeshLoad=FDsBitmapWorkspace_onMeshLoad;b.onCatalogSelected=FDsBitmapWorkspace_onCatalogSelected;b.construct=FDsBitmapWorkspace_construct;b.findPropertyFrame=FDsBitmapWorkspace_findPropertyFrame;b.loadByGuid=FDsBitmapWorkspace_loadByGuid;b.loadByCode=FDsBitmapWorkspace_loadByCode;b.dispose=FDsBitmapWorkspace_dispose;
return b}
function FDsBitmapWorkspace_onBuilded(b){this.__base.FUiWorkspace.onBuilded.call(this,b);var d=this._frameToolBar=this.searchControl("toolbarFrame");d._hPanel.className=this.styleName("Toolbar_Ground");d=this._frameBody=this.searchControl("bodyFrame");d._hPanel.className=this.styleName("Body_Ground");d=this._frameStatusBar=this.searchControl("statusFrame");d._hPanel.className=this.styleName("Statusbar_Ground");d=this._menuBar=RClass.create(FDsBitmapMenuBar);d._workspace=this;d.buildDefine(b);this._frameToolBar.push(d);
var f=this._frameSet=RClass.create(FDsBitmapFrameSet);f._workspace=this;f.buildDefine(b);this._frameBody.push(f);d._frameSet=f}function FDsBitmapWorkspace_onMeshLoad(b){this._activeSpace=b._activeSpace;this._catalog.buildSpace(this._activeSpace)}
function FDsBitmapWorkspace_onCatalogSelected(b,d){for(var f=this._activeSpace,h=this._propertyFrames,q=h.count(),z=0;z<q;z++){var A=h.value(z);A.hide()}if(RClass.isClass(b,FE3dStage))A=this.findPropertyFrame(EDsFrame.MeshSpacePropertyFrame),A.show(),A.loadObject(f,f);else if(RClass.isClass(b,FG3dTechnique))A=this.findPropertyFrame(EDsFrame.MeshTechniquePropertyFrame),A.show(),A.loadObject(f,b);else if(RClass.isClass(b,FE3dRegion))A=this.findPropertyFrame(EDsFrame.MeshRegionPropertyFrame),A.show(),
A.loadObject(f,b);else if(RClass.isClass(b,FE3dCamera))A=this.findPropertyFrame(EDsFrame.MeshCameraPropertyFrame),A.show(),A.loadObject(f,b);else if(RClass.isClass(b,FG3dDirectionalLight))A=this.findPropertyFrame(EDsFrame.MeshLightPropertyFrame),A.show(),A.loadObject(f,b);else if(RClass.isClass(b,FE3dMeshDisplay))A=this.findPropertyFrame(EDsFrame.MeshDisplayPropertyFrame),A.show(),A.loadObject(f,b);else if(RClass.isClass(b,FG3dMaterial))A=this.findPropertyFrame(EDsFrame.MeshMaterialPropertyFrame),
A.show(),A.loadObject(f,b);else if(RClass.isClass(b,FE3dMeshRenderable))A=this.findPropertyFrame(EDsFrame.MeshRenderablePropertyFrame),A.show(),A.loadObject(f,b);else throw new TError("Unknown select object type. (value={1})",b);}function FDsBitmapWorkspace_construct(){this.__base.FUiWorkspace.construct.call(this);this._propertyFrames=new TDictionary}
function FDsBitmapWorkspace_findPropertyFrame(b){var d=this._propertyFrames.get(b);d||(d=RConsole.find(FFrameConsole).get(this,b,this._frameProperty._hContainer),d._workspace=this,this._propertyFrames.set(b,d));return d}function FDsBitmapWorkspace_loadByGuid(b){this._frameSet.loadByGuid(b)}function FDsBitmapWorkspace_loadByCode(b){this._frameSet.loadByCode(b)}
function FDsBitmapWorkspace_dispose(){this.__base.FUiWorkspace.dispose.call(this);this._propertyFrames.dispose();this._propertyFrames=null}function FDsMaterialCanvasBitmap(b){return b=RClass.inherits(this,b,FDsBitmapCanvas)}
function FDsMaterialCanvasContent(b){b=RClass.inherits(this,b,FDsCanvas);b._activeResource=null;b._activeMaterial=null;b._capturePosition=null;b._captureCameraPosition=null;b._templateMatrix=null;b._templateRenderable=null;b._templateFace=null;b._templateTranslation=null;b._templateRotation=null;b._templateScale=null;b._templateViewScale=.05;b.onBuild=FDsMaterialCanvasContent_onBuild;b.onLoaded=FDsMaterialCanvasContent_onLoaded;b.oeResize=FDsMaterialCanvasContent_oeResize;b.oeRefresh=FDsMaterialCanvasContent_oeRefresh;
b.construct=FDsMaterialCanvasContent_construct;b.reloadRegion=FDsMaterialCanvasContent_reloadRegion;b.loadByGuid=FDsMaterialCanvasContent_loadByGuid;b.dispose=FDsMaterialCanvasContent_dispose;return b}
function FDsMaterialCanvasContent_onBuild(b){this.__base.FDsCanvas.onBuild.call(this,b);b=this._hPanel;var d=this._activeSpace=RClass.create(FE3dSimpleStage);d.linkGraphicContext(this);d.selectTechnique(this,FE3dGeneralTechnique);d.region().backgroundColor().set(1,1,1,1);d.region().linkGraphicContext(this);RStage.register("space.material",d);d=d.camera();d.setPosition(0,0,-10);d.lookAt(0,0,0);d.update();d=d.projection();d.size().set(b.width,b.height);d._angle=45;d.update()}
function FDsMaterialCanvasContent_onLoaded(b){this._activeMaterial=this._activeResource.material();RConsole.find(FUiDesktopConsole).hide()}function FDsMaterialCanvasContent_oeResize(b){this.__base.FDsCanvas.oeResize.call(this,b);var d=this._hPanel;b=d.offsetWidth;var d=d.offsetHeight,f=this._activeSpace;f&&(f=f.camera().projection(),f.size().set(b,d),f.update());return EEventStatus.Stop}function FDsMaterialCanvasContent_oeRefresh(b){return EEventStatus.Stop}
function FDsMaterialCanvasContent_construct(){this.__base.FDsCanvas.construct.call(this);this._capturePosition=new SPoint2;this._captureCameraPosition=new SPoint3}function FDsMaterialCanvasContent_selectDisplay(b){this.selectNone();this._selectObject=b;this.innerSelectDisplay(b)}function FDsMaterialCanvasContent_switchMode(b){this._canvasModeCd=b}
function FDsMaterialCanvasContent_reloadRegion(b){b=b.resource();this._cameraMoveRate=b.moveSpeed();this._cameraKeyRotation=b.rotationKeySpeed();this._cameraMouseMove=b.rotationMouseSpeed()}function FDsMaterialCanvasContent_loadByGuid(b){RConsole.find(FUiDesktopConsole).showLoading();(this._activeResource=RConsole.find(FE3sMaterialConsole).loadByGuid(b)).addLoadListener(this,this.onLoaded)}function FDsMaterialCanvasContent_dispose(){this.__base.FDsCanvas.dispose.call(this)}
function FDsMaterialCanvasToolBar(b){b=RClass.inherits(this,b,FUiToolBar);b._controlSize1=null;b._controlSize2=null;b._controlSize3=null;b._controlSize4=null;b._controlSizeWidth=null;b._controlSizeHeight=null;b.onBuilded=FDsMaterialCanvasToolBar_onBuilded;b.onSizeClick=FDsMaterialCanvasToolBar_onSizeClick;b.construct=FDsMaterialCanvasToolBar_construct;b.dispose=FDsMaterialCanvasToolBar_dispose;return b}
function FDsMaterialCanvasToolBar_onBuilded(b){this.__base.FUiToolBar.onBuilded.call(this,b);this._controlSize1.addClickListener(this,this.onSizeClick);this._controlSize2.addClickListener(this,this.onSizeClick);this._controlSize3.addClickListener(this,this.onSizeClick);this._controlSize4.addClickListener(this,this.onSizeClick);this._controlSizeWidth.setText("*");this._controlSizeHeight.setText("*")}function FDsMaterialCanvasToolBar_onModeClick(b){}
function FDsMaterialCanvasToolBar_onSizeClick(b){var d=b.sender,f=b="*",h=d.name(),d=d.label();"sizeAuto"!=h&&(f=d.split("x"),b=parseInt(f[0]),f=parseInt(f[1]));this._controlSizeWidth.setText(b);this._controlSizeHeight.setText(f)}function FDsMaterialCanvasToolBar_construct(){this.__base.FUiToolBar.construct.call(this)}function FDsMaterialCanvasToolBar_dispose(){this.__base.FUiToolBar.dispose.call(this)}
function FDsMaterialCatalogContent(b){b=RClass.inherits(this,b,FUiListView);b._activeItem=null;b._activeGuid=null;b._refreshButton=null;b._saveButton=null;b._runButton=null;b.onBuilded=FDsMaterialCatalogContent_onBuilded;b.onServiceLoad=FDsMaterialCatalogContent_onServiceLoad;b.construct=FDsMaterialCatalogContent_construct;b.doClickItem=FDsMaterialCatalogContent_doClickItem;b.doDoubleClickItem=FDsMaterialCatalogContent_doDoubleClickItem;b.serviceList=FDsMaterialCatalogContent_serviceList;b.dispose=
FDsMaterialCatalogContent_dispose;return b}function FDsMaterialCatalogContent_onBuilded(b){this.__base.FUiListView.onBuilded.call(this,b)}
function FDsMaterialCatalogContent_onServiceLoad(b){b=b.root.findNode("BitmapCollection");this.clear();b=b.nodes();for(var d=b.count(),f=0;f<d;f++){var h=b.getAt(f);if(h.isName("Bitmap")){var q=h.get("code"),z=this.createItem(FDsMaterialCatalogItem);z.propertyLoad(h);z._guid=h.get("guid");z._linkGuid=h.get("link_guid");z._code=q;z._updateDate=h.get("update_date");z.setTypeLabel(q);z.setLabel(RString.nvl(h.get("label"),h.get("code")));z.refreshStyle();this.push(z)}}RConsole.find(FUiDesktopConsole).hide()}
function FDsMaterialCatalogContent_construct(){this.__base.FUiListView.construct.call(this)}function FDsMaterialCatalogContent_doClickItem(b){this.__base.FUiListView.doClickItem.call(this,b)}function FDsMaterialCatalogContent_doDoubleClickItem(b){this.__base.FUiListView.doDoubleClickItem.call(this,b);var d=b._guid;this._activeItem=b;this._activeGuid=d;this._frameSet.switchCanvas("Bitmap",d)}
function FDsMaterialCatalogContent_serviceList(b){RConsole.find(FUiDesktopConsole).showLoading();b="/cloud.resource.material.ws?action=listBitmap&guid="+b;RConsole.find(FXmlConsole).sendAsync(b).addLoadListener(this,this.onServiceLoad)}function FDsMaterialCatalogContent_dispose(){this.__base.FUiListView.dispose.call(this)}
function FDsMaterialCatalogItem(b){b=RClass.inherits(this,b,FUiListViewItem);b._styleTypePanel=RClass.register(b,new AStyle("_styleTypePanel"));b._styleTypeLabel=RClass.register(b,new AStyle("_styleTypeLabel"));b.onBuild=FDsMaterialCatalogItem_onBuild;b.setTypeLabel=FDsMaterialCatalogItem_setTypeLabel;b.refreshStyle=FDsMaterialCatalogItem_refreshStyle;return b}
function FDsMaterialCatalogItem_onBuild(b){this.__base.FUiListViewItem.onBuild.call(this,b);b=this._hPanel;b.style.width="200px";b.style.height="150px";this._hLine1.className=this.styleName("TypePanel");this._hLine1.vAlign="top";this._hTypeLabel=RBuilder.appendDiv(this._hLine1,this.styleName("TypeLabel"))}function FDsMaterialCatalogItem_setTypeLabel(b){this._hTypeLabel.innerHTML=b}
function FDsMaterialCatalogItem_refreshStyle(){this._hForm.style.backgroundImage='url("'+("/cloud.resource.bitmap.wv?do=preview&guid="+this._guid+"&update_date="+this._updateDate)+'")'}
function FDsMaterialCatalogToolBar(b){b=RClass.inherits(this,b,FUiToolBar);b._controlCreate=null;b._controlDelete=null;b._controlMoveUp=null;b._controlMoveDown=null;b.onBuilded=FDsMaterialCatalogToolBar_onBuilded;b.onCreateClick=FDsMaterialCatalogToolBar_onCreateClick;b.onDeleteClick=FDsMaterialCatalogToolBar_onDeleteClick;b.onMoveClick=FDsMaterialCatalogToolBar_onMoveClick;b.construct=FDsMaterialCatalogToolBar_construct;b.dispose=FDsMaterialCatalogToolBar_dispose;return b}
function FDsMaterialCatalogToolBar_onBuilded(b){this.__base.FUiToolBar.onBuilded.call(this,b);this._controlCreate.addClickListener(this,this.onCreateClick);this._controlDelete.addClickListener(this,this.onDeleteClick);this._controlMoveUp.addClickListener(this,this.onMoveClick);this._controlMoveDown.addClickListener(this,this.onMoveClick)}function FDsMaterialCatalogToolBar_onCreateClick(b){}function FDsMaterialCatalogToolBar_onDeleteClick(b){}function FDsMaterialCatalogToolBar_onMoveClick(b){}
function FDsMaterialCatalogToolBar_construct(){this.__base.FUiToolBar.construct.call(this)}function FDsMaterialCatalogToolBar_dispose(){this.__base.FUiToolBar.dispose.call(this)}
function FDsMaterialFrameSet(b){b=RClass.inherits(this,b,FDsFrameSet);b._frameCatalog=null;b._frameCatalogToolBar=null;b._frameCatalogContent=null;b._frameCanvas=null;b._frameCanvasToolBar=null;b._frameCanvasContent=null;b._frameProperty=null;b._framePropertyToolBar=null;b._framePropertyContent=null;b.onBuilded=FDsMaterialFrameSet_onBuilded;b.onDataLoaded=FDsMaterialFrameSet_onDataLoaded;b.onCatalogSelected=FDsMaterialFrameSet_onCatalogSelected;b.construct=FDsMaterialFrameSet_construct;b.switchCanvas=
FDsMaterialFrameSet_switchCanvas;b.loadByGuid=FDsMaterialFrameSet_loadByGuid;b.loadByCode=FDsMaterialFrameSet_loadByCode;b.dispose=FDsMaterialFrameSet_dispose;return b}
function FDsMaterialFrameSet_onBuilded(b){this.__base.FDsFrameSet.onBuilded.call(this,b);this._frameCatalogToolBar._hPanel.className=this.styleName("ToolBar_Ground");this._frameCatalogContent._hPanel.className=this.styleName("Catalog_Content");this._frameCanvasToolBar._hPanel.className=this.styleName("ToolBar_Ground");this._frameCanvasContent._hPanel.className=this.styleName("Canvas_Content");this._framePropertyToolBar._hPanel.className=this.styleName("ToolBar_Ground");this._framePropertyContent._hPanel.className=
this.styleName("Property_Content");var d=this._spliterCatalog;d.setAlignCd(EUiAlign.Left);d.setSizeHtml(this._frameCatalog._hPanel);d=this._spliterProperty;d.setAlignCd(EUiAlign.Right);d.setSizeHtml(this._frameProperty._hPanel);d=this._canvasContent=RClass.create(FDsMaterialCanvasContent);d._frameSet=this;d._hParent=this._frameCanvasContent._hPanel;d._hParent.style.scroll="auto";d.build(b);d=this._canvasBitmap=RClass.create(FDsMaterialCanvasBitmap);d._frameSet=this;d._hParent=this._frameCanvasContent._hPanel;
d._hParent.style.scroll="auto";d.build(b);this._frameCanvasContent.push(d)}function FDsMaterialFrameSet_onDataLoaded(b){this._activeSpace=b._activeSpace;this._catalog.buildSpace(this._activeSpace)}
function FDsMaterialFrameSet_onCatalogSelected(b,d){var f=this._activeSpace;if(f)if(this.hidePropertyFrames(),RClass.isClass(b,FE3dStage)){var h=this.findPropertyFrame(EDsFrame.MeshSpacePropertyFrame);h.show();h.loadObject(f,b)}else if(RClass.isClass(b,FG3dTechnique))h=this.findPropertyFrame(EDsFrame.MeshTechniquePropertyFrame),h.show(),h.loadObject(f,b);else if(RClass.isClass(b,FE3dRegion))h=this.findPropertyFrame(EDsFrame.MeshRegionPropertyFrame),h.show(),h.loadObject(f,b);else if(RClass.isClass(b,
FE3dCamera))h=this.findPropertyFrame(EDsFrame.MeshCameraPropertyFrame),h.show(),h.loadObject(f,b);else if(RClass.isClass(b,FG3dDirectionalLight))h=this.findPropertyFrame(EDsFrame.MeshLightPropertyFrame),h.show(),h.loadObject(f,b);else if(RClass.isClass(b,FE3dMeshDisplay))h=this.findPropertyFrame(EDsFrame.MeshDisplayPropertyFrame),h.show(),h.loadObject(f,b);else if(RClass.isClass(b,FG3dMaterial))h=this.findPropertyFrame(EDsFrame.MeshMaterialPropertyFrame),h.show(),h.loadObject(f,b);else if(RClass.isClass(b,
FE3dMeshRenderable))h=this.findPropertyFrame(EDsFrame.MeshRenderablePropertyFrame),h.show(),h.loadObject(f,b);else throw new TError("Unknown select object type. (select={1})",b);}function FDsMaterialFrameSet_construct(){this.__base.FDsFrameSet.construct.call(this)}function FDsMaterialFrameSet_switchCanvas(b,d){"Bitmap"==b&&this._canvasBitmap.loadByGuid(d)}
function FDsMaterialFrameSet_loadByGuid(b){this._activeGuid=b;var d=this._activeResource=RConsole.find(FDrMaterialConsole).query(b);this._catalogContent.serviceList(b);this._canvasContent.loadByGuid(b);this.findPropertyFrame(EDsFrame.MaterialPropertyFrame).loadObject(d)}function FDsMaterialFrameSet_loadByCode(b){this._activeCode=b;this._canvas.loadByCode(b)}function FDsMaterialFrameSet_dispose(){this.__base.FDsFrameSet.dispose.call(this)}
function FDsMaterialImportDialog(b){b=RClass.inherits(this,b,FUiDialog);b._frameName="resource.material.ImportDialog";b._modeCd=null;b._nodeGuid=null;b._controlPrivateButton=null;b._controlTeamButton=null;b._controlShareButton=null;b.onBuilded=FDsMaterialImportDialog_onBuilded;b.onFileLoaded=FDsMaterialImportDialog_onFileLoaded;b.onConfirmLoad=FDsMaterialImportDialog_onConfirmLoad;b.onConfirmClick=FDsMaterialImportDialog_onConfirmClick;b.onCancelClick=FDsMaterialImportDialog_onCancelClick;b.construct=
FDsMaterialImportDialog_construct;b.switchModeCd=FDsMaterialImportDialog_switchModeCd;b.dispose=FDsMaterialImportDialog_dispose;return b}function FDsMaterialImportDialog_onBuilded(b){this.__base.FUiDialog.onBuilded.call(this,b);this._controlConfirmButton.addClickListener(this,this.onConfirmClick);this._controlCancelButton.addClickListener(this,this.onCancelClick)}
function FDsMaterialImportDialog_onFileLoaded(b){b=this._activeItem;var d=this._frameSet._activeResource.guid(),f=this._controlTypeCode.get(),h=this._controlCode.get();RString.isEmpty(h)&&(h=f);var f=this._controlLabel.get(),q=null,z=this._fileReader;switch(this._modeCd){case "select":q="/cloud.resource.material.wv?do=replaceData&material_guid="+d+"&link_guid="+b._linkGuid+"&bitmap_guid="+b._guid+"&code="+h+"&label="+f+"&data_length="+z.length()+"&file_name="+z.fileName();break;case "import":q="/cloud.resource.material.wv?do=importData&material_guid="+
d+"&code="+h+"&label="+f+"&data_length="+z.length()+"&file_name="+z.fileName();break;default:throw new TError(this,"Unknown mode. (mode_cd={1})",modeCd);}q=RBrowser.urlEncode(q);RConsole.find(FHttpConsole).send(q,z.data()).addLoadListener(this,this.onConfirmLoad);this._fileReader=RObject.dispose(z)}function FDsMaterialImportDialog_onConfirmLoad(b){RConsole.find(FUiDesktopConsole).hide();this.hide()}
function FDsMaterialImportDialog_onConfirmClick(b){RConsole.find(FUiDesktopConsole).showUploading();b=this._controlFile._hInput.files[0];var d=this._fileReader=RClass.create(FFileReader);d.addLoadListener(this,this.onFileLoaded);d.loadFile(b)}function FDsMaterialImportDialog_onCancelClick(b){this.hide()}function FDsMaterialImportDialog_construct(){this.__base.FUiDialog.construct.call(this)}
function FDsMaterialImportDialog_switchModeCd(b){this._modeCd=b;switch(b){case "select":this.setLabel("\u66ff\u6362\u4f4d\u56fe\u8d44\u6e90");break;case "import":this.setLabel("\u5bfc\u5165\u4f4d\u56fe\u8d44\u6e90");break;default:throw new TError(this,"Unknown mode. (mode_cd={1})",b);}this._controlCode.set("");this._controlLabel.set("")}function FDsMaterialImportDialog_dispose(){this.__base.FUiDialog.dispose.call(this)}
function FDsMaterialMenuBar(b){b=RClass.inherits(this,b,FUiMenuBar);b._controlBack=null;b._controlSave=null;b._controlProperty=null;b._controlSelect=null;b._controlImport=null;b._controlCapture=null;b.onBuilded=FDsMaterialMenuBar_onBuilded;b.onBackClick=FDsMaterialMenuBar_onBackClick;b.onSaveLoad=FDsMaterialMenuBar_onSaveLoad;b.onSaveClick=FDsMaterialMenuBar_onSaveClick;b.onPropertyClick=FDsMaterialMenuBar_onPropertyClick;b.onSelectLoad=FDsMaterialMenuBar_onSelectLoad;b.onSelectConfirm=FDsMaterialMenuBar_onSelectConfirm;
b.onSelectClick=FDsMaterialMenuBar_onSelectClick;b.onImportClick=FDsMaterialMenuBar_onImportClick;b.onDeleteLoad=FDsMaterialMenuBar_onDeleteLoad;b.onDeleteExecute=FDsMaterialMenuBar_onDeleteExecute;b.onDeleteClick=FDsMaterialMenuBar_onDeleteClick;b.onCaptureLoad=FDsMaterialMenuBar_onCaptureLoad;b.onCaptureClick=FDsMaterialMenuBar_onCaptureClick;b.construct=FDsMaterialMenuBar_construct;b.dispose=FDsMaterialMenuBar_dispose;return b}
function FDsMaterialMenuBar_onBuilded(b){this.__base.FUiMenuBar.onBuilded.call(this,b);this._controlBack.addClickListener(this,this.onBackClick);this._controlSave.addClickListener(this,this.onSaveClick);this._controlProperty.addClickListener(this,this.onPropertyClick);this._controlSelect.addClickListener(this,this.onSelectClick);this._controlImport.addClickListener(this,this.onImportClick);this._controlDelete.addClickListener(this,this.onDeleteClick);this._controlCapture.addClickListener(this,this.onCaptureClick)}
function FDsMaterialMenuBar_onBackClick(b){}function FDsMaterialMenuBar_onSaveLoad(b){RConsole.find(FUiDesktopConsole).hide()}function FDsMaterialMenuBar_onSaveClick(b){b=this._frameSet._activeSpace.resource();RConsole.find(FUiDesktopConsole).showUploading();var d=new TXmlNode;b.saveConfig(d);RConsole.find(FE3sMeshConsole).update(d).addLoadListener(this,this.onSaveLoad)}function FDsMaterialMenuBar_onPropertyClick(b){}function FDsMaterialMenuBar_onSelectLoad(b){}
function FDsMaterialMenuBar_onSelectConfirm(b){}function FDsMaterialMenuBar_onSelectClick(b){b=this._frameSet._catalogContent.focusItem();if(!b)return alert("\u8bf7\u9009\u4e2d\u4f4d\u56fe");var d=RConsole.find(FUiWindowConsole).find(FDsMaterialImportDialog);d._frameSet=this._frameSet;d._activeItem=b;d.switchModeCd("select");d._controlTypeCode.set(b._code);d._controlCode.set(b._code);d._controlLabel.set(b._label);d.showPosition(EUiPosition.Center)}
function FDsMaterialMenuBar_onImportClick(b){b=RConsole.find(FUiWindowConsole).find(FDsMaterialImportDialog);b._frameSet=this._frameSet;b.switchModeCd("import");b._controlCode.set("");b._controlLabel.set("");b.showPosition(EUiPosition.Center)}function FDsMaterialMenuBar_onDeleteLoad(b){RConsole.find(FUiDesktopConsole).hide()}
function FDsMaterialMenuBar_onDeleteExecute(b){b=this._frameSet._catalogContent.focusItem();RConsole.find(FUiDesktopConsole).showUploading();RConsole.find(FDrMaterialConsole).deleteBitmap(b._linkGuid).addLoadListener(this,this.onDeleteLoad)}
function FDsMaterialMenuBar_onDeleteClick(b){if(!this._frameSet._catalogContent.focusItem())return alert("\u8bf7\u9009\u4e2d\u540e\u518d\u70b9\u51fb\u5220\u9664");RConsole.find(FUiMessageConsole).showConfirm("\u8bf7\u786e\u8ba4\u662f\u5426\u5220\u9664\u5f53\u524d\u8d44\u6e90\uff1f").addResultListener(this,this.onDeleteExecute)}function FDsMaterialMenuBar_onCaptureLoad(b){RConsole.find(FUiDesktopConsole).hide()}
function FDsMaterialMenuBar_onCaptureClick(b){RConsole.find(FUiDesktopConsole).showUploading();this._frameSet._canvas.capture().addLoadListener(this,this.onCaptureLoad)}function FDsMaterialMenuBar_construct(){this.__base.FUiMenuBar.construct.call(this)}function FDsMaterialMenuBar_dispose(){this.__base.FUiMenuBar.dispose.call(this)}
function FDsMaterialPropertyFrame(b){b=RClass.inherits(this,b,FUiForm);b._activeResource=null;b._controlGuid=null;b._controlCode=null;b._controlLabel=null;b.onBuilded=FDsMaterialPropertyFrame_onBuilded;b.onDataChanged=FDsMaterialPropertyFrame_onDataChanged;b.construct=FDsMaterialPropertyFrame_construct;b.loadObject=FDsMaterialPropertyFrame_loadObject;b.dispose=FDsMaterialPropertyFrame_dispose;return b}function FDsMaterialPropertyFrame_construct(){this.__base.FUiForm.construct.call(this)}
function FDsMaterialPropertyFrame_onBuilded(b){this.__base.FUiForm.onBuilded.call(this,b);this._controlCode.addDataChangedListener(this,this.onDataChanged);this._controlLabel.addDataChangedListener(this,this.onDataChanged)}function FDsMaterialPropertyFrame_onDataChanged(b){b=this._activeResource;b.setCode(this._controlCode.get());b.setLabel(this._controlLabel.get())}
function FDsMaterialPropertyFrame_loadObject(b){this._activeResource=b;this._controlGuid.set(b.guid());this._controlCode.set(b.code());this._controlLabel.set(b.label())}function FDsMaterialPropertyFrame_dispose(){this.__base.FUiForm.dispose.call(this)}
function FDsMaterialPropertyToolBar(b){b=RClass.inherits(this,b,FUiToolBar);b._frameName="resource.material.PropertyToolBar";b._controlRefresh=null;b.onBuilded=FDsMaterialPropertyToolBar_onBuilded;b.onRefreshClick=FDsMaterialPropertyToolBar_onRefreshClick;b.construct=FDsMaterialPropertyToolBar_construct;b.dispose=FDsMaterialPropertyToolBar_dispose;return b}
function FDsMaterialPropertyToolBar_onBuilded(b){this.__base.FUiToolBar.onBuilded.call(this,b);this._controlRefresh.addClickListener(this,this.onRefreshClick)}function FDsMaterialPropertyToolBar_onRefreshClick(b){}function FDsMaterialPropertyToolBar_onSizeClick(b){var d=b.sender,f=b="*",h=d.name(),d=d.label();"sizeAuto"!=h&&(f=d.split("x"),b=parseInt(f[0]),f=parseInt(f[1]));this._controlSizeWidth.setText(b);this._controlSizeHeight.setText(f);this._frameSet._canvas.switchSize(b,f)}
function FDsMaterialPropertyToolBar_onRotationChange(b){b=this._frameSet._canvas;var d=this._controlRotationVisible.isCheck(),f=RInteger.parse(this._controlRotationWidth.text()),h=RInteger.parse(this._controlRotationHeight.text());b.switchRotation(d,f,h)}
function FDsMaterialPropertyToolBar_onRotationAutoClick(b){var d=!1,f=!1,h=!1,q=!1,z=!1,A=!1;switch(b.sender.name()){case "dimensionalAuto":break;case "dimensionalFlipX":d=!0;break;case "dimensionalFlipY":f=!0;break;case "dimensionalFlipZ":h=!0;break;case "dimensionalX":q=!0;break;case "dimensionalY":z=!0;break;case "dimensionalZ":A=!0;break;default:throw new TError(this,"Unknown command.");}this._frameSet._canvas.viewAutoSize(d,f,h,q,z,A)}
function FDsMaterialPropertyToolBar_onRotationClick(b,d){this._frameSet._canvas.switchRotation(b.sender.isCheck())}function FDsMaterialPropertyToolBar_construct(){this.__base.FUiToolBar.construct.call(this)}function FDsMaterialPropertyToolBar_dispose(){this.__base.FUiToolBar.dispose.call(this)}
function FDsMaterialSelectDialog(b){b=RClass.inherits(this,b,FUiDialog);b._frameName="resource.material.SelectDialog";b._nodeGuid=null;b._controlPrivateButton=null;b._controlTeamButton=null;b._controlShareButton=null;b.onBuilded=FDsMaterialSelectDialog_onBuilded;b.onFileLoaded=FDsMaterialSelectDialog_onFileLoaded;b.onConfirmLoad=FDsMaterialSelectDialog_onConfirmLoad;b.onConfirmClick=FDsMaterialSelectDialog_onConfirmClick;b.onCancelClick=FDsMaterialSelectDialog_onCancelClick;b.construct=FDsMaterialSelectDialog_construct;
b.dispose=FDsMaterialSelectDialog_dispose;return b}function FDsMaterialSelectDialog_onBuilded(b){this.__base.FUiDialog.onBuilded.call(this,b);this._controlConfirmButton.addClickListener(this,this.onConfirmClick);this._controlCancelButton.addClickListener(this,this.onCancelClick)}
function FDsMaterialSelectDialog_onFileLoaded(b){b=this._fileReader;var d="/cloud.resource.material.wv?do=importData&guid="+this._resource.guid()+"&data_length="+b.length()+"&file_name="+b.fileName(),d=RBrowser.urlEncode(d);RConsole.find(FHttpConsole).send(d,b.data()).addLoadListener(this,this.onConfirmLoad);this._fileReader=RObject.dispose(b)}function FDsMaterialSelectDialog_onConfirmLoad(b){RConsole.find(FUiDesktopConsole).hide();this.hide();this._frameSet.reload()}
function FDsMaterialSelectDialog_onConfirmClick(b){RConsole.find(FUiDesktopConsole).showUploading();b=this._controlFile._hInput.files[0];var d=this._fileReader=RClass.create(FFileReader);d.addLoadListener(this,this.onFileLoaded);d.loadFile(b)}function FDsMaterialSelectDialog_onCancelClick(b){this.hide()}function FDsMaterialSelectDialog_construct(){this.__base.FUiDialog.construct.call(this)}function FDsMaterialSelectDialog_dispose(){this.__base.FUiDialog.dispose.call(this)}
function FDsMaterialWorkspace(b){b=RClass.inherits(this,b,FUiWorkspace);b._frameName="design2d.bitmap.Workspace";b._styleWorkspaceGround=RClass.register(b,new AStyle("_styleWorkspaceGround","Workspace_Ground"));b._styleToolbarGround=RClass.register(b,new AStyle("_styleToolbarGround","Toolbar_Ground"));b._styleBodyGround=RClass.register(b,new AStyle("_styleBodyGround","Body_Ground"));b._styleStatusbarGround=RClass.register(b,new AStyle("_styleStatusbarGround","Statusbar_Ground"));b._activeSpace=null;
b._activeMesh=null;b._framesetMain=null;b._framesetBody=null;b._frameToolBar=null;b._frameBody=null;b._frameProperty=null;b._frameSet=null;b._propertyFrames=null;b.onBuilded=FDsMaterialWorkspace_onBuilded;b.onMeshLoad=FDsMaterialWorkspace_onMeshLoad;b.onCatalogSelected=FDsMaterialWorkspace_onCatalogSelected;b.construct=FDsMaterialWorkspace_construct;b.findPropertyFrame=FDsMaterialWorkspace_findPropertyFrame;b.loadByGuid=FDsMaterialWorkspace_loadByGuid;b.loadByCode=FDsMaterialWorkspace_loadByCode;
b.dispose=FDsMaterialWorkspace_dispose;return b}
function FDsMaterialWorkspace_onBuilded(b){this.__base.FUiWorkspace.onBuilded.call(this,b);var d=this._frameToolBar=this.searchControl("toolbarFrame");d._hPanel.className=this.styleName("Toolbar_Ground");d=this._frameBody=this.searchControl("bodyFrame");d._hPanel.className=this.styleName("Body_Ground");d=this._frameStatusBar=this.searchControl("statusFrame");d._hPanel.className=this.styleName("Statusbar_Ground");d=this._menuBar=RClass.create(FDsMaterialMenuBar);d._workspace=this;d.buildDefine(b);
this._frameToolBar.push(d);var f=this._frameSet=RClass.create(FDsMaterialFrameSet);f._workspace=this;f.buildDefine(b);this._frameBody.push(f);d._frameSet=f}function FDsMaterialWorkspace_onMeshLoad(b){this._activeSpace=b._activeSpace;this._catalog.buildSpace(this._activeSpace)}
function FDsMaterialWorkspace_onCatalogSelected(b,d){for(var f=this._activeSpace,h=this._propertyFrames,q=h.count(),z=0;z<q;z++){var A=h.value(z);A.hide()}if(RClass.isClass(b,FE3dStage))A=this.findPropertyFrame(EDsFrame.MeshSpacePropertyFrame),A.show(),A.loadObject(f,f);else if(RClass.isClass(b,FG3dTechnique))A=this.findPropertyFrame(EDsFrame.MeshTechniquePropertyFrame),A.show(),A.loadObject(f,b);else if(RClass.isClass(b,FE3dRegion))A=this.findPropertyFrame(EDsFrame.MeshRegionPropertyFrame),A.show(),
A.loadObject(f,b);else if(RClass.isClass(b,FE3dCamera))A=this.findPropertyFrame(EDsFrame.MeshCameraPropertyFrame),A.show(),A.loadObject(f,b);else if(RClass.isClass(b,FG3dDirectionalLight))A=this.findPropertyFrame(EDsFrame.MeshLightPropertyFrame),A.show(),A.loadObject(f,b);else if(RClass.isClass(b,FE3dMeshDisplay))A=this.findPropertyFrame(EDsFrame.MeshDisplayPropertyFrame),A.show(),A.loadObject(f,b);else if(RClass.isClass(b,FG3dMaterial))A=this.findPropertyFrame(EDsFrame.MeshMaterialPropertyFrame),
A.show(),A.loadObject(f,b);else if(RClass.isClass(b,FE3dMeshRenderable))A=this.findPropertyFrame(EDsFrame.MeshRenderablePropertyFrame),A.show(),A.loadObject(f,b);else throw new TError("Unknown select object type. (value={1})",b);}function FDsMaterialWorkspace_construct(){this.__base.FUiWorkspace.construct.call(this);this._propertyFrames=new TDictionary}
function FDsMaterialWorkspace_findPropertyFrame(b){var d=this._propertyFrames.get(b);d||(d=RConsole.find(FFrameConsole).get(this,b,this._frameProperty._hContainer),d._workspace=this,this._propertyFrames.set(b,d));return d}function FDsMaterialWorkspace_loadByGuid(b){this._frameSet.loadByGuid(b)}function FDsMaterialWorkspace_loadByCode(b){this._frameSet.loadByCode(b)}
function FDsMaterialWorkspace_dispose(){this.__base.FUiWorkspace.dispose.call(this);this._propertyFrames.dispose();this._propertyFrames=null}
function FDsModelCanvasContent(b){b=RClass.inherits(this,b,FDsCanvas);b._resourceTypeCd=EE3sResource.Model;b._autoDistance=null;b._autoOutline=null;b._autoMatrix=null;b._optionRotation=!1;b._rotation=null;b._capturePosition=null;b._captureMatrix=null;b._captureRotation=null;b._selectObject=null;b._selectBoundBox=null;b._selectRenderables=null;b._templateMatrix=null;b._templateRenderable=null;b._templateFace=null;b._templateTranslation=null;b._templateRotation=null;b._templateScale=null;b._templateViewScale=
.05;b.onBuild=FDsModelCanvasContent_onBuild;b.onMouseCaptureStart=FDsModelCanvasContent_onMouseCaptureStart;b.onMouseCapture=FDsModelCanvasContent_onMouseCapture;b.onMouseCaptureStop=FDsModelCanvasContent_onMouseCaptureStop;b.onDataLoaded=FDsModelCanvasContent_onDataLoaded;b.oeResize=FDsModelCanvasContent_oeResize;b.oeRefresh=FDsModelCanvasContent_oeRefresh;b.construct=FDsModelCanvasContent_construct;b.innerSelectDisplay=FDsModelCanvasContent_innerSelectDisplay;b.innerSelectLayer=FDsModelCanvasContent_innerSelectLayer;
b.selectNone=FDsModelCanvasContent_selectNone;b.selectDisplay=FDsModelCanvasContent_selectDisplay;b.selectMaterial=FDsModelCanvasContent_selectMaterial;b.selectRenderable=FDsModelCanvasContent_selectRenderable;b.switchDimensional=FDsModelCanvasContent_switchDimensional;b.switchRotation=FDsModelCanvasContent_switchRotation;b.viewAutoSize=FDsModelCanvasContent_viewAutoSize;b.loadByGuid=FDsModelCanvasContent_loadByGuid;b.loadByCode=FDsModelCanvasContent_loadByCode;b.dispose=FDsModelCanvasContent_dispose;
return b}function FDsModelCanvasContent_onBuild(b){this.__base.FDsCanvas.onBuild.call(this,b)}
function FDsModelCanvasContent_onMouseCaptureStart(b){var d=this._activeSpace;if(d){var f=this._activeSpace.region(),f=RConsole.find(FG3dTechniqueConsole).find(this._graphicContext,FG3dSelectTechnique).test(f,b.offsetX,b.offsetY);this.selectRenderable(f);this._capturePosition.set(b.clientX,b.clientY);this._captureRotation.assign(d.camera()._rotation);f&&(f=f.display(),this._captureMatrix.assign(f.matrix()));this._templateMatrix.identity();if(this._templateFace)for(this._templateFaceMatrix.assign(this._templateFace.matrix()),
b=this._selectRenderables,d=b.count()-1;0<=d;d--)f=b.getAt(d),f._dragMatrix||(f._dragMatrix=new SMatrix3d),f._dragMatrix.assign(f.matrix());RHtml.cursorSet(this._hPanel,EUiCursor.Pointer)}}
function FDsModelCanvasContent_onMouseCapture(b){if(this._activeSpace){var d=b.clientX-this._capturePosition.x,f=b.clientY-this._capturePosition.y,h=this._canvasMoveCd,q=this._templateFace;b=this._templateMatrix;switch(this._canvasModeCd){case EDsCanvasMode.Drop:var h=this._activeSpace.camera().rotation(),z=this._captureRotation;h.x=z.x-f*this._cameraMouseRotation;h.y=z.y-d*this._cameraMouseRotation;break;case EDsCanvasMode.Translate:q&&(h==EDsCanvasDrag.X?b.tx=d/10:h==EDsCanvasDrag.Y?b.ty=-f/10:
h==EDsCanvasDrag.Z&&(b.tz=d/10));break;case EDsCanvasMode.Rotation:q&&(h==EDsCanvasDrag.X?b.rx=d/10:h==EDsCanvasDrag.Y?b.ry=-f/10:h==EDsCanvasDrag.Z&&(b.rz=d/10));break;case EDsCanvasMode.Scale:q&&(h==EDsCanvasDrag.X?b.sx=d/10:h==EDsCanvasDrag.Y?b.sy=-f/10:h==EDsCanvasDrag.Z?b.sz=d/10:h==EDsCanvasDrag.All&&(b.sx=d/10,b.sy=d/10,b.sz=d/10))}if(q)for(q.matrix().merge(this._templateFaceMatrix,b),d=this._selectRenderables,f=d.count()-1;0<=f;f--)h=d.getAt(f),h._matrix.merge(h._dragMatrix,b)}}
function FDsModelCanvasContent_onMouseCaptureStop(b){RHtml.cursorSet(this._hPanel,EUiCursor.Auto)}
function FDsModelCanvasContent_onDataLoaded(b){b=this._activeSpace.region();var d=b.camera();d.setPosition(0,3,-10);d.lookAt(0,3,0);d.update();var f=this._hPanel,d=d.projection();d.size().set(f.width,f.height);d._angle=45;d.update();b=b.directionalLight().camera();b.setPosition(10,10,0);b.lookAt(0,0,0);b.update();b=new SEvent(this);this.processLoadListener(b);b.dispose();RConsole.find(FUiDesktopConsole).hide()}
function FDsModelCanvasContent_oeResize(b){this.__base.FDsCanvas.oeResize.call(this,b);var d=this._hPanel;b=d.offsetWidth;var d=d.offsetHeight,f=this._activeSpace;f&&(f=f.camera().projection(),f.size().set(b,d),f.update());return EEventStatus.Stop}function FDsModelCanvasContent_oeRefresh(b){return EEventStatus.Stop}
function FDsModelCanvasContent_construct(){this.__base.FDsCanvas.construct.call(this);this._autoDistance=new SPoint3(6,6,6);this._autoOutline=new SOutline3d;this._autoMatrix=new SMatrix3d;this._capturePosition=new SPoint2;this._captureMatrix=new SMatrix3d;this._templateMatrix=new SMatrix3d;this._templateFaceMatrix=new SMatrix3d;this._rotation=new SVector3;this._captureRotation=new SVector3;this._selectRenderables=new TObjects}
function FDsModelCanvasContent_innerSelectDisplay(b){b=b.renderables();for(var d=b.count(),f=0;f<d;f++){var h=b.getAt(f);RClass.isClass(h,FDsSceneRenderable)&&(this._selectRenderables.push(h),h.showBoundBox())}}function FDsModelCanvasContent_innerSelectLayer(b){b=b.displays();for(var d=b.count(),f=0;f<d;f++){var h=b.getAt(f);this.innerSelectDisplay(h)}}
function FDsModelCanvasContent_selectNone(){this._selectObject=null;for(var b=this._selectRenderables,d=b.count(),f=0;f<d;f++)b.get(f).hideBoundBox();this._selectRenderables.clear()}function FDsModelCanvasContent_selectDisplay(b){this.selectNone();this._selectObject=b;this.innerSelectDisplay(b)}
function FDsModelCanvasContent_selectMaterial(b){this.selectNone();this._selectObject=b;for(var d=b._display.renderables(),f=d.count(),h=0;h<f;h++){var q=d.get(h);q._materialReference==b&&(this._selectRenderables.push(q),q._optionSelected=!0,q.showBoundBox())}}
function FDsModelCanvasContent_selectRenderable(b){if(b)switch(b._renderable._resource._code){case "ms_translation_x":this._canvasMoveCd=EDsCanvasDrag.X;this._templateRenderable=b;return;case "ms_translation_y":this._canvasMoveCd=EDsCanvasDrag.Y;this._templateRenderable=b;return;case "ms_translation_z":this._canvasMoveCd=EDsCanvasDrag.Z;this._templateRenderable=b;return;case "ms_rotation_x":this._canvasMoveCd=EDsCanvasDrag.X;this._templateRenderable=b;return;case "ms_rotation_y":this._canvasMoveCd=
EDsCanvasDrag.Y;this._templateRenderable=b;return;case "ms_rotation_z":this._canvasMoveCd=EDsCanvasDrag.Z;this._templateRenderable=b;return;case "ms_scale_x":this._canvasMoveCd=EDsCanvasDrag.X;this._templateRenderable=b;return;case "ms_scale_y":this._canvasMoveCd=EDsCanvasDrag.Y;this._templateRenderable=b;return;case "ms_scale_z":this._canvasMoveCd=EDsCanvasDrag.Z;this._templateRenderable=b;return;case "ms_scale_all":this._canvasMoveCd=EDsCanvasDrag.All;this._templateRenderable=b;return;default:this._canvasMoveCd=
EDsCanvasDrag.Unknown,this._templateRenderable=null}this.selectNone();b&&(this._selectRenderables.push(b),b._optionSelected=!0,b.showBoundBox(),this._frameSet._catalog.showObject(b));var d=this._templateTranslation,f=this._templateRotation,h=this._templateScale;switch(this._canvasModeCd){case EDsCanvasMode.Translate:d.setVisible(null!=b);f.hide();h.hide();this._templateFace=d;break;case EDsCanvasMode.Rotation:d.hide();f.setVisible(null!=b);h.hide();this._templateFace=f;break;case EDsCanvasMode.Scale:d.hide(),
f.hide(),h.setVisible(null!=b),this._templateFace=h}d=this._templateFace;b&&d&&(b=b.display(),d=d.matrix(),d.assign(b.matrix()),d.setScaleAll(this._templateViewScale),d.update())}function FDsModelCanvasContent_switchMode(b){this._canvasModeCd=b;this.selectRenderable(this._selectRenderable)}function FDsModelCanvasContent_switchDimensional(b,d,f){this._dimensional.setVisible(b);b=this._dimensional.matrix();0<d&&(b.sx=d);0<f&&(b.sz=f);b.updateForce()}
function FDsModelCanvasContent_switchRotation(b){this._optionRotation=b}
function FDsModelCanvasContent_viewAutoSize(b,d,f,h,q,z){var A=this._autoOutline,B=this._activeSpace.display(),C=B.resource(),D=C.matrix();h&&(D.rx+=RConst.PI_2);q&&(D.ry+=RConst.PI_2);z&&(D.rz+=RConst.PI_2);h=this._autoMatrix.identity();h.setRotation(D.rx,D.ry,D.rz);h.update();C=C.calculateOutline();A.calculateFrom(C,h);b&&(D.sx=-D.sx);d&&(D.sy=-D.sy);f&&(D.sz=-D.sz);f=this._autoDistance;b=f.x/A.distance.x;d=f.y/A.distance.y;f=f.z/A.distance.z;f=RMath.min(b,d,f);b=f*RMath.sign(D.sx);d=f*RMath.sign(D.sy);
f*=RMath.sign(D.sz);D.setTranslate(-A.center.x*b,-A.min.y*d,-A.center.z*f);D.setScale(b,d,f);D.update();B.reloadResource()}function FDsModelCanvasContent_loadByGuid(b){var d=this._activeSpace,f=RConsole.find(FE3dModelConsole);d&&(RStage.unregister(d),f.free(d));d=this._activeSpace=f.allocByGuid(this,b);d._linked||(RConsole.find(FUiDesktopConsole).showLoading(),d._layer.pushRenderable(this._dimensional),d.addLoadListener(this,this.onDataLoaded),d._linked=!0);RStage.register("space",d)}
function FDsModelCanvasContent_loadByCode(b){}function FDsModelCanvasContent_dispose(){this._rotation=RObject.dispose(this._rotation);this.__base.FDsCanvas.dispose.call(this)}
function FDsModelCanvasToolBar(b){b=RClass.inherits(this,b,FUiToolBar);b._frameName="resource.model.CanvasToolBar";b._canvasModeCd=EDsCanvasMode.Drop;b._controlDrop=null;b._controlSize1=null;b._controlSize2=null;b._controlSize3=null;b._controlSize4=null;b._controlSizeWidth=null;b._controlSizeHeight=null;b._controlDimensionalVisible=null;b._controlDimensionalWidth=null;b._controlDimensionalHeight=null;b._controlDimensionalAuto=null;b._controlDimensionalFlipX=null;b._controlDimensionalFlipY=null;b._controlDimensionalFlipZ=
null;b._controlDimensionalX=null;b._controlDimensionalY=null;b._controlDimensionalZ=null;b._controlRotation=null;b.onBuilded=FDsModelCanvasToolBar_onBuilded;b.onModeClick=FDsModelCanvasToolBar_onModeClick;b.onSizeClick=FDsModelCanvasToolBar_onSizeClick;b.onDimensionalChange=FDsModelCanvasToolBar_onDimensionalChange;b.onDimensionalAutoClick=FDsModelCanvasToolBar_onDimensionalAutoClick;b.onRotationClick=FDsModelCanvasToolBar_onRotationClick;b.construct=FDsModelCanvasToolBar_construct;b.dispose=FDsModelCanvasToolBar_dispose;
return b}
function FDsModelCanvasToolBar_onBuilded(b){this.__base.FUiToolBar.onBuilded.call(this,b);b=this._controlDrop;b._canvasModeCd=EDsCanvasMode.Drop;b.addClickListener(this,this.onModeClick);b.check(!0);this._controlSize1.addClickListener(this,this.onSizeClick);this._controlSize2.addClickListener(this,this.onSizeClick);this._controlSize3.addClickListener(this,this.onSizeClick);this._controlSize4.addClickListener(this,this.onSizeClick);this._controlSizeWidth.setText("*");this._controlSizeHeight.setText("*");this._controlDimensionalVisible.addClickListener(this,
this.onDimensionalChange);this._controlDimensionalVisible.check(!0);this._controlDimensionalWidth.addDataChangedListener(this,this.onDimensionalChange);this._controlDimensionalWidth.setText(1);this._controlDimensionalHeight.addDataChangedListener(this,this.onDimensionalChange);this._controlDimensionalHeight.setText(1);this._controlDimensionalAuto.addClickListener(this,this.onDimensionalAutoClick);this._controlDimensionalFlipX.addClickListener(this,this.onDimensionalAutoClick);this._controlDimensionalFlipY.addClickListener(this,
this.onDimensionalAutoClick);this._controlDimensionalFlipZ.addClickListener(this,this.onDimensionalAutoClick);this._controlDimensionalX.addClickListener(this,this.onDimensionalAutoClick);this._controlDimensionalY.addClickListener(this,this.onDimensionalAutoClick);this._controlDimensionalZ.addClickListener(this,this.onDimensionalAutoClick);this._controlRotation.addClickListener(this,this.onRotationClick)}function FDsModelCanvasToolBar_onModeClick(b){}
function FDsModelCanvasToolBar_onSizeClick(b){var d=b.sender,f=b="*",h=d.name(),d=d.label();"sizeAuto"!=h&&(f=d.split("x"),b=parseInt(f[0]),f=parseInt(f[1]));this._controlSizeWidth.setText(b);this._controlSizeHeight.setText(f);this._frameSet._canvasContent.switchSize(b,f)}
function FDsModelCanvasToolBar_onDimensionalChange(b){b=this._frameSet._canvasContent;var d=this._controlDimensionalVisible.isCheck(),f=RInteger.parse(this._controlDimensionalWidth.text()),h=RInteger.parse(this._controlDimensionalHeight.text());b.switchDimensional(d,f,h)}
function FDsModelCanvasToolBar_onDimensionalAutoClick(b){var d=!1,f=!1,h=!1,q=!1,z=!1,A=!1;switch(b.sender.name()){case "dimensionalAuto":break;case "dimensionalFlipX":d=!0;break;case "dimensionalFlipY":f=!0;break;case "dimensionalFlipZ":h=!0;break;case "dimensionalX":q=!0;break;case "dimensionalY":z=!0;break;case "dimensionalZ":A=!0;break;default:throw new TError(this,"Unknown command.");}this._frameSet._canvasContent.viewAutoSize(d,f,h,q,z,A)}
function FDsModelCanvasToolBar_onRotationClick(b,d){this._frameSet._canvasContent.switchRotation(b.sender.isCheck())}function FDsModelCanvasToolBar_construct(){this.__base.FUiToolBar.construct.call(this)}function FDsModelCanvasToolBar_dispose(){this.__base.FUiToolBar.dispose.call(this)}
function FDsModelCatalogContent(b){b=RClass.inherits(this,b,FDsCatalog);b._iconView="resource.tools.view";b._iconViewNot="resource.tools.viewno";b.onBuild=FDsModelCatalogContent_onBuild;b.onLoadDisplay=FDsModelCatalogContent_onLoadDisplay;b.onNodeViewClick=FDsModelCatalogContent_onNodeViewClick;b.onNodeViewDoubleClick=FDsModelCatalogContent_onNodeViewDoubleClick;b.lsnsSelect=null;b.construct=FDsModelCatalogContent_construct;b.buildRenderable=FDsModelCatalogContent_buildRenderable;b.buildDisplay=FDsModelCatalogContent_buildDisplay;
b.buildSpace=FDsModelCatalogContent_buildSpace;b.selectObject=FDsModelCatalogContent_selectObject;b.showObject=FDsModelCatalogContent_showObject;b.dispose=FDsModelCatalogContent_dispose;return b}function FDsModelCatalogContent_onBuild(b){this.__base.FDsCatalog.onBuild.call(this,b);this.loadUrl("/cloud.describe.tree.ws?action=query&code=resource.model")}function FDsModelCatalogContent_onLoadDisplay(b){this.buildRenderable(b._linkNode,b)}
function FDsModelCatalogContent_onNodeViewClick(b){var d=b.treeNodeCell,f=b.treeNode.dataPropertyGet("linker");if(RClass.isClass(f,FDisplay))if(b.ctrlKey){for(var h=this._displays,q=h.count()-1;0<=q;q--){var z=h.get(q);z.dataPropertyGet("linker")._visible=!1;z.cell("view").setIcon(this._iconViewNot)}f._visible=!0;d.setIcon(this._iconView)}else f._visible=!f._visible,d.setIcon(f._visible?this._iconView:this._iconViewNot);if(RClass.isClass(f,FDrawable))if(b.ctrlKey){b=this._renderables;for(q=b.count()-
1;0<=q;q--)h=b.get(q),h.dataPropertyGet("linker")._visible=!1,h.cell("view").setIcon(this._iconViewNot);f._visible=!0;d.setIcon(this._iconView)}else f._visible=!f._visible,d.setIcon(f._visible?this._iconView:this._iconViewNot)}
function FDsModelCatalogContent_onNodeViewDoubleClick(b){b=b.treeNode;var d=b.dataPropertyGet("linker");if(RClass.isClass(d,FDisplay))for(var d=this._displays,f=d.count()-1;0<=f;f--)b=d.get(f),b.dataPropertyGet("linker")._visible=!0,b.cell("view").setIcon(this._iconView);if(RClass.isClass(d,FDrawable))for(d=this._renderables,f=d.count()-1;0<=f;f--)b=d.get(f),b.dataPropertyGet("linker")._visible=!0,b.cell("view").setIcon(this._iconView)}
function FDsModelCatalogContent_construct(){this.__base.FDsCatalog.construct.call(this);this._renderables=new TObjects}function FDsModelCatalogContent_buildRenderable(b,d){var f=d._renderable.resource(),h=f.code(),f=f.label(),q=this.createNode();q.setTypeCode("renderable");q.setLabel(h);q.setNote(f);q.dataPropertySet("linker",d);b.appendNode(q)}
function FDsModelCatalogContent_buildDisplay(b,d){var f=d.resource(),h=d.shapes(),q=h.count(),z=this.createNode();z.setTypeCode("display");z.setLabel("Model ("+q+")");z.dataPropertySet("linker",d);b.appendNode(z);var A=d.material(),f=f.material(),B=this.createNode();B.setTypeCode("material");B.setLabel("Material");B.dataPropertySet("linker",A);B.dataPropertySet("resource",f);z.appendNode(B);for(A=0;A<q;A++)f=h.get(A),this.buildRenderable(z,f)}
function FDsModelCatalogContent_buildSpace(b){this.clearAllNodes();var d=b.resource();this.clear();var f=this.createNode();f.setTypeCode("space");f.setLabel(d.code());f.setNote(d.label());f.dataPropertySet("linker",b);this.appendNode(f);this.buildTechnique(f,b.technique());this.buildRegion(f,b.region());this.buildDisplay(f,b._display);f.click()}function FDsModelCatalogContent_selectObject(b){null!=b&&this.processSelectedListener(b,!0)}
function FDsModelCatalogContent_showObject(b){if(RClass.isClass(b,FDsSceneRenderable))for(var d=this._renderables,f=d.count(),h=0;h<f;h++)d.getAt(h).dataPropertyGet("linker")==b&&this.processSelectedListener(b,!1)}function FDsModelCatalogContent_dispose(){this._displays=RObject.dispose(this._displays);this._renderables=RObject.dispose(this._renderables);this._materials=RObject.dispose(this._materials);this.__base.FDsCatalog.dispose.call(this)}
function FDsModelCatalogToolBar(b){b=RClass.inherits(this,b,FUiToolBar);b._frameName="resource.model.CatalogToolBar";b._activeNodeGuid=null;b._controlCreateCamera=null;b._controlCreateLayer=null;b._controlCreateSprite=null;b._controlDelete=null;b._controlFolderOpen=null;b._controlFolderClose=null;b.onBuilded=FDsModelCatalogToolBar_onBuilded;b.onCreateCameraClick=FDsModelCatalogToolBar_onCreateCameraClick;b.onCreateLayerClick=FDsModelCatalogToolBar_onCreateLayerClick;b.onCreateSpriteClick=FDsModelCatalogToolBar_onCreateSpriteClick;
b.onDeleteLoad=FDsModelCatalogToolBar_onDeleteLoad;b.onDeleteExecute=FDsModelCatalogToolBar_onDeleteExecute;b.onCopyLoad=FDsModelCatalogToolBar_onCopyLoad;b.onCopyExecute=FDsModelCatalogToolBar_onCopyExecute;b.onCopyClick=FDsModelCatalogToolBar_onCopyClick;b.onDeleteClick=FDsModelCatalogToolBar_onDeleteClick;b.onFolderOpenClick=FDsModelCatalogToolBar_onFolderOpenClick;b.onFolderCloseClick=FDsModelCatalogToolBar_onFolderCloseClick;b.construct=FDsModelCatalogToolBar_construct;b.dispose=FDsModelCatalogToolBar_dispose;
return b}function FDsModelCatalogToolBar_onBuilded(b){this.__base.FUiToolBar.onBuilded.call(this,b);this._controlFolderOpen.addClickListener(this,this.onFolderOpenClick);this._controlFolderClose.addClickListener(this,this.onFolderCloseClick)}function FDsModelCatalogToolBar_onCreateCameraClick(b){}function FDsModelCatalogToolBar_onCreateLayerClick(b){}
function FDsModelCatalogToolBar_onCreateSpriteClick(b){b=this._frameSet._catalogContent.focusNode();if(!b)return alert("\u8bf7\u9009\u4e2d\u76ee\u5f55\u8282\u70b9\u3002");var d=b.dataPropertyGet("linker"),f=b=null;if(RClass.isClass(d,FDisplayLayer))b=d;else if(RClass.isClass(d,FE3dSprite))b=d.findParent(FDisplayLayer),f=d;else return alert("\u8bf7\u9009\u4e2d\u663e\u793a\u5c42\u6216\u8005\u7cbe\u7075\u8282\u70b9\u3002");var d=this._frameSet,h=RConsole.find(FUiWindowConsole).find(FDsCommonSpriteDialog);
h._frameSet=d;h._spaceGuid=d._activeSpace.resource().guid();h._layerGuid=b.resource().guid();h._displayGuid=f?f.resource().guid():null;b&&h.setLayerLabel(b.makeLabel());f&&h.setDisplayLabel(f.makeLabel());h.setContentCode("");h.setContentLabel("");h.showPosition(EUiPosition.Center)}function FDsModelCatalogToolBar_onCopyLoad(b){RConsole.find(FUiDesktopConsole).hide()}
function FDsModelCatalogToolBar_onCopyExecute(b){b.resultCd==EResult.Success&&(b=this._frameSet._activeSpace.resource().guid(),RConsole.find(FUiDesktopConsole).showUploading(),RConsole.find(FDrSceneConsole).copyNode(b,this._activeGuid).addLoadListener(this,this.onDeleteLoad))}
function FDsModelCatalogToolBar_onCopyClick(b){var d=this._frameSet._catalogContent.focusNode();if(!d)return RConsole.find(FUiMessageConsole).showInfo("\u8bf7\u9009\u4e2d\u8282\u70b9\u540e\uff0c\u518d\u70b9\u51fb\u64cd\u4f5c\u3002");this._activeNodeGuid=d.guid();b=null;d=d.dataPropertyGet("linker");if(RClass.isClass(d,FE3dSprite))b=d,this._activeGuid=d.resource().guid();else return alert("\u4e0d\u80fd\u590d\u5236\u5f53\u524d\u9009\u4e2d\u7684\u8282\u70b9.");var f=b.resource(),d=f.parent(),f=f.clone();
d.pushDisplay(f);d=RConsole.find(FE3dInstanceConsole).create(EE3dInstance.SceneDisplay);d.linkGraphicContext(b);d.loadResource(f);RConsole.find(FE3dSceneConsole).loadDisplay(d);b.parent().pushDisplay(d)}function FDsModelCatalogToolBar_onDeleteLoad(b){RConsole.find(FUiDesktopConsole).hide();b=this._frameSet._catalogContent;var d=this._activeNodeGuid;d&&b.findByGuid(d).removeSelf();this._activeNodeGuid=null}
function FDsModelCatalogToolBar_onDeleteExecute(b){b.resultCd==EResult.Success&&(b=this._frameSet._activeSpace.resource().guid(),RConsole.find(FUiDesktopConsole).showUploading(),RConsole.find(FDrSceneConsole).deleteNode(b,this._activeGuid).addLoadListener(this,this.onDeleteLoad))}
function FDsModelCatalogToolBar_onDeleteClick(b){b=this._frameSet._catalogContent.focusNode();if(!b)return RConsole.find(FUiMessageConsole).showInfo("\u8bf7\u9009\u4e2d\u8282\u70b9\u540e\uff0c\u518d\u70b9\u51fb\u64cd\u4f5c\u3002");this._activeNodeGuid=b.guid();b=b.dataPropertyGet("linker");if(RClass.isClass(b,FE3dSprite))this._activeGuid=b.resource().guid();else return alert("\u4e0d\u80fd\u5220\u9664\u5f53\u524d\u9009\u4e2d\u7684\u8282\u70b9.");RConsole.find(FUiMessageConsole).showConfirm("\u8bf7\u786e\u8ba4\u662f\u5426\u5220\u9664\u5f53\u524d\u8282\u70b9\uff1f").addResultListener(this,
this.onDeleteExecute)}function FDsModelCatalogToolBar_onFolderOpenClick(b){}function FDsModelCatalogToolBar_onFolderCloseClick(b){}function FDsModelCatalogToolBar_construct(){this.__base.FUiToolBar.construct.call(this)}function FDsModelCatalogToolBar_dispose(){this.__base.FUiToolBar.dispose.call(this)}
function FDsModelFrameSet(b){b=RClass.inherits(this,b,FDsFrameSet);b._frameCatalog=null;b._frameCatalogToolBar=null;b._frameCatalogContent=null;b._frameCanvas=null;b._frameCanvasToolBar=null;b._frameCanvasContent=null;b._frameProperty=null;b._framePropertyToolBar=null;b._framePropertyContent=null;b.onBuilded=FDsModelFrameSet_onBuilded;b.onDataLoaded=FDsModelFrameSet_onDataLoaded;b.onCatalogSelected=FDsModelFrameSet_onCatalogSelected;b.construct=FDsModelFrameSet_construct;b.loadByGuid=FDsModelFrameSet_loadByGuid;
b.loadByCode=FDsModelFrameSet_loadByCode;b.dispose=FDsModelFrameSet_dispose;return b}
function FDsModelFrameSet_onBuilded(b){this.__base.FDsFrameSet.onBuilded.call(this,b);this._frameCatalogToolBar._hPanel.className=this.styleName("ToolBar_Ground");this._frameCatalogContent._hPanel.className=this.styleName("Catalog_Content");this._frameCanvasToolBar._hPanel.className=this.styleName("ToolBar_Ground");this._frameCanvasContent._hPanel.className=this.styleName("Canvas_Content");this._framePropertyToolBar._hPanel.className=this.styleName("ToolBar_Ground");this._framePropertyContent._hPanel.className=
this.styleName("Property_Content");b=this._spliterCatalog;b.setAlignCd(EUiAlign.Left);b.setSizeHtml(this._frameCatalog._hPanel);b=this._spliterProperty;b.setAlignCd(EUiAlign.Right);b.setSizeHtml(this._frameProperty._hPanel)}function FDsModelFrameSet_onDataLoaded(b){b=this._activeSpace=b.sender.activeSpace();this._catalogContent.buildSpace(b)}
function FDsModelFrameSet_onCatalogSelected(b,d){var f=this._activeSpace;if(f)if(this.hidePropertyFrames(),RClass.isClass(b,FE3dSpace)){var h=this.findPropertyFrame(EDsFrame.CommonSpacePropertyFrame);h.show();h.loadObject(f,b)}else if(RClass.isClass(b,FG3dTechnique))h=this.findPropertyFrame(EDsFrame.CommonTechniquePropertyFrame),h.show(),h.loadObject(f,b);else if(RClass.isClass(b,FE3dRegion))h=this.findPropertyFrame(EDsFrame.CommonRegionPropertyFrame),h.show(),h.loadObject(f,b);else if(RClass.isClass(b,
FE3dCamera))h=this.findPropertyFrame(EDsFrame.CommonCameraPropertyFrame),h.show(),h.loadObject(f,b);else if(RClass.isClass(b,FG3dLight))h=this.findPropertyFrame(EDsFrame.CommonLightPropertyFrame),h.show(),h.loadObject(f,b);else if(RClass.isClass(b,FE3dModelDisplay))h=this.findPropertyFrame(EDsFrame.CommonDisplayPropertyFrame),h.show(),h.loadObject(f,b);else if(RClass.isClass(b,FG3dMaterial))h=this.findPropertyFrame(EDsFrame.CommonMaterialPropertyFrame),h.show(),h.loadObject(f,b);else if(RClass.isClass(b,
FE3dModelRenderable))h=this.findPropertyFrame(EDsFrame.CommonRenderablePropertyFrame),h.show(),h.loadObject(f,b);else throw new TError("Unknown select object type. (select={1})",b);}function FDsModelFrameSet_construct(){this.__base.FDsFrameSet.construct.call(this)}function FDsModelFrameSet_loadByGuid(b){this._activeGuid=b;this._canvasContent.loadByGuid(b)}function FDsModelFrameSet_loadByCode(b){this._activeCode=b;this._canvasContent.loadByCode(b)}
function FDsModelFrameSet_dispose(){this.__base.FDsFrameSet.dispose.call(this)}function FDsModelMenuBar(b){b=RClass.inherits(this,b,FUiMenuBar);b._controlSaveButton=null;b._controlCaptureButton=null;b.onSaveLoad=FDsModelMenuBar_onSaveLoad;b.onSaveClick=FDsModelMenuBar_onSaveClick;b.onCaptureLoad=FDsModelMenuBar_onCaptureLoad;b.onCaptureClick=FDsModelMenuBar_onCaptureClick;b.construct=FDsModelMenuBar_construct;b.dispose=FDsModelMenuBar_dispose;return b}
function FDsModelMenuBar_onSaveLoad(b){RConsole.find(FUiDesktopConsole).hide()}function FDsModelMenuBar_onSaveClick(b){b=this._frameSet._activeSpace.resource();RConsole.find(FUiDesktopConsole).showUploading();var d=new TXmlNode;b.saveConfig(d);RConsole.find(FDrModelConsole).update(d).addLoadListener(this,this.onSaveLoad)}function FDsModelMenuBar_onCaptureLoad(b){RConsole.find(FUiDesktopConsole).hide()}
function FDsModelMenuBar_onCaptureClick(b){RConsole.find(FUiDesktopConsole).showUploading();this._frameSet._canvasContent.capture().addLoadListener(this,this.onCaptureLoad)}function FDsModelMenuBar_construct(){this.__base.FUiMenuBar.construct.call(this)}function FDsModelMenuBar_dispose(){this.__base.FUiMenuBar.dispose.call(this)}
function FDsModelWorkspace(b){b=RClass.inherits(this,b,FUiWorkspace);b._frameName="design3d.mesh.Workspace";b._styleWorkspaceGround=RClass.register(b,new AStyle("_styleWorkspaceGround","Workspace_Ground"));b._styleToolbarGround=RClass.register(b,new AStyle("_styleToolbarGround","Toolbar_Ground"));b._styleBodyGround=RClass.register(b,new AStyle("_styleBodyGround","Body_Ground"));b._styleStatusbarGround=RClass.register(b,new AStyle("_styleStatusbarGround","Statusbar_Ground"));b._activeSpace=null;b._activeMesh=
null;b._framesetMain=null;b._framesetBody=null;b._frameToolBar=null;b._frameBody=null;b._frameProperty=null;b._frameSet=null;b._propertyFrames=null;b.onBuilded=FDsModelWorkspace_onBuilded;b.onMeshLoad=FDsModelWorkspace_onMeshLoad;b.onCatalogSelected=FDsModelWorkspace_onCatalogSelected;b.construct=FDsModelWorkspace_construct;b.findPropertyFrame=FDsModelWorkspace_findPropertyFrame;b.loadByGuid=FDsModelWorkspace_loadByGuid;b.loadByCode=FDsModelWorkspace_loadByCode;b.dispose=FDsModelWorkspace_dispose;
return b}
function FDsModelWorkspace_onBuilded(b){this.__base.FUiWorkspace.onBuilded.call(this,b);var d=this._frameToolBar=this.searchControl("toolbarFrame");d._hPanel.className=this.styleName("Toolbar_Ground");d=this._frameBody=this.searchControl("bodyFrame");d._hPanel.className=this.styleName("Body_Ground");d=this._frameStatusBar=this.searchControl("statusFrame");d._hPanel.className=this.styleName("Statusbar_Ground");d=this._menuBar=RClass.create(FDsModelMenuBar);d._workspace=this;d.buildDefine(b);this._frameToolBar.push(d);
var f=this._frameSet=RClass.create(FDsModelFrameSet);f._workspace=this;f.buildDefine(b);this._frameBody.push(f);d._frameSet=f}function FDsModelWorkspace_onMeshLoad(b){this._activeSpace=b._activeSpace;this._catalog.buildSpace(this._activeSpace)}
function FDsModelWorkspace_onCatalogSelected(b,d){for(var f=this._activeSpace,h=this._propertyFrames,q=h.count(),z=0;z<q;z++){var A=h.value(z);A.hide()}if(RClass.isClass(b,FE3dStage))A=this.findPropertyFrame(EDsFrame.MeshSpacePropertyFrame),A.show(),A.loadObject(f,f);else if(RClass.isClass(b,FG3dTechnique))A=this.findPropertyFrame(EDsFrame.MeshTechniquePropertyFrame),A.show(),A.loadObject(f,b);else if(RClass.isClass(b,FE3dRegion))A=this.findPropertyFrame(EDsFrame.MeshRegionPropertyFrame),A.show(),
A.loadObject(f,b);else if(RClass.isClass(b,FE3dCamera))A=this.findPropertyFrame(EDsFrame.MeshCameraPropertyFrame),A.show(),A.loadObject(f,b);else if(RClass.isClass(b,FG3dDirectionalLight))A=this.findPropertyFrame(EDsFrame.MeshLightPropertyFrame),A.show(),A.loadObject(f,b);else if(RClass.isClass(b,FE3dMeshDisplay))A=this.findPropertyFrame(EDsFrame.MeshDisplayPropertyFrame),A.show(),A.loadObject(f,b);else if(RClass.isClass(b,FG3dMaterial))A=this.findPropertyFrame(EDsFrame.MeshMaterialPropertyFrame),
A.show(),A.loadObject(f,b);else if(RClass.isClass(b,FE3dMeshRenderable))A=this.findPropertyFrame(EDsFrame.MeshRenderablePropertyFrame),A.show(),A.loadObject(f,b);else throw new TError("Unknown select object type. (value={1})",b);}function FDsModelWorkspace_construct(){this.__base.FUiWorkspace.construct.call(this);this._propertyFrames=new TDictionary}
function FDsModelWorkspace_findPropertyFrame(b){var d=this._propertyFrames.get(b);d||(d=RConsole.find(FFrameConsole).get(this,b,this._frameProperty._hContainer),d._workspace=this,this._propertyFrames.set(b,d));return d}function FDsModelWorkspace_loadByGuid(b){this._frameSet.loadByGuid(b)}function FDsModelWorkspace_loadByCode(b){this._frameSet.loadByCode(b)}function FDsModelWorkspace_dispose(){this.__base.FUiWorkspace.dispose.call(this);this._propertyFrames.dispose();this._propertyFrames=null}
function FDsTemplateCanvasContent(b){b=RClass.inherits(this,b,FDsSpaceCanvas);b._resourceTypeCd=EE3sResource.Template;b._context=null;b._stage=null;b._layer=null;b._rotation=null;b._rotationAble=!1;b._capturePosition=null;b._captureMatrix=null;b._captureRotation=null;b._dimensional=null;b._selectBoundBox=null;b.onBuild=FDsTemplateCanvasContent_onBuild;b.onDataLoaded=FDsTemplateCanvasContent_onDataLoaded;b.oeRefresh=FDsTemplateCanvasContent_oeRefresh;b.construct=FDsTemplateCanvasContent_construct;
b.loadByGuid=FDsTemplateCanvasContent_loadByGuid;b.loadByCode=FDsTemplateCanvasContent_loadByCode;b.dispose=FDsTemplateCanvasContent_dispose;return b}function FDsTemplateCanvasContent_onBuild(b){this.__base.FDsSpaceCanvas.onBuild.call(this,b)}function FDsTemplateCanvasContent_onMouseCaptureStart(b){if(b=this._activeSpace)b=b.camera(),this._captureRotation.assign(b._rotation)}
function FDsTemplateCanvasContent_onMouseCapture(b){if(this._activeSpace){var d=b.clientX-this._capturePosition.x;b=b.clientY-this._capturePosition.y;var f=t.renderables().get(0).matrix(),h=this._captureMatrix;switch(this._toolbar._canvasModeCd){case EDsCanvasMode.Drop:var h=this._stage.camera().rotation(),q=this._captureRotation;h.x=q.x+.003*b;h.y=q.y+.003*d;break;case EDsCanvasMode.Translate:f.tx=h.tx+d/360*3.14;f.ty=h.ty+b/360*3.14;break;case EDsCanvasMode.Rotation:f.ry=h.ry+d*RConst.DEGREE_RATE;
break;case EDsCanvasMode.Scale:f.sx=h.sx+d/100,f.sy=h.sy+d/100,f.sz=h.sz+d/100}f.updateForce()}}function FDsTemplateCanvasContent_onMouseCaptureStop(b){}
function FDsTemplateCanvasContent_onDataLoaded(b){b=this._activeSpace.region();var d=b.camera();d.setPosition(0,3,-10);d.lookAt(0,3,0);d.update();var f=this._hPanel,d=d.projection();d.size().set(f.width,f.height);d._angle=45;d.update();b=b.directionalLight().camera();b.setPosition(10,10,0);b.lookAt(0,0,0);b.update();b=new SEvent(this);this.processLoadListener(b);b.dispose();RConsole.find(FUiDesktopConsole).hide()}
function FDsTemplateCanvasContent_oeRefresh(b){var d=this._graphicContext;this.__base.FDsSpaceCanvas.oeRefresh.call(this,b);b=this._hParent.offsetWidth;var f=this._hParent.offsetHeight,h=this._hPanel;h.width=b;h.height=f;h=this._stage.camera().projection();h.size().set(b,f);h.update();d.setViewport(0,0,b,f);return EEventStatus.Stop}
function FDsTemplateCanvasContent_construct(){this.__base.FDsSpaceCanvas.construct.call(this);this._capturePosition=new SPoint2;this._captureMatrix=new SMatrix3d;this._rotation=new SVector3;this._captureRotation=new SVector3}
function FDsTemplateCanvasContent_loadByGuid(b){var d=this._activeSpace,f=RConsole.find(FE3dTemplateConsole);d&&(RStage.unregister(d),f.free(d));d=this._activeSpace=f.allocByGuid(this,b);d._linked||(RConsole.find(FUiDesktopConsole).showLoading(),d._layer.pushRenderable(this._dimensional),d.addLoadListener(this,this.onDataLoaded),d._linked=!0);RStage.register("space",d)}
function FDsTemplateCanvasContent_loadByCode(b){b=this._activeSpace;var d=RConsole.find(FE3dTemplateConsole);b&&(RStage.unregister(b),d.free(b));b=this._activeSpace=d.allocByGuid(this,guid);b._linked||(RConsole.find(FUiDesktopConsole).showLoading(),b._layer.pushRenderable(this._dimensional),b.addLoadListener(this,this.onDataLoaded),b._linked=!0);RStage.register("space",b)}
function FDsTemplateCanvasContent_dispose(){this._rotation=RObject.dispose(this._rotation);this.__base.FDsSpaceCanvas.dispose.call(this)}
function FDsTemplateCanvasToolBar(b){b=RClass.inherits(this,b,FUiToolBar);b._refreshButton=null;b._saveButton=null;b._canvasModeCd=EDsCanvasMode.Drop;b.onBuilded=FDsTemplateCanvasToolBar_onBuilded;b.onModeClick=FDsTemplateCanvasToolBar_onModeClick;b.onLookClick=FDsTemplateCanvasToolBar_onLookClick;b.onPlayClick=FDsTemplateCanvasToolBar_onPlayClick;b.onViewClick=FDsTemplateCanvasToolBar_onViewClick;b.construct=FDsTemplateCanvasToolBar_construct;b.dispose=FDsTemplateCanvasToolBar_dispose;return b}
function FDsTemplateCanvasToolBar_onBuilded(b){this.__base.FUiToolBar.onBuilded.call(this,b);this._controlModeDrop.addClickListener(this,this.onModeClick);this._controlModeSelect.addClickListener(this,this.onModeClick);this._controlTranslate.addClickListener(this,this.onModeClick);this._controlRotation.addClickListener(this,this.onModeClick);this._controlScale.addClickListener(this,this.onModeClick);this._controlLookFront.addClickListener(this,this.onLookClick);this._controlLookUp.addClickListener(this,
this.onLookClick);this._controlLookLeft.addClickListener(this,this.onLookClick);this._controlPlay.addClickListener(this,this.onPlayClick);this._controlView.addClickListener(this,this.onViewClick)}function FDsTemplateCanvasToolBar_onModeClick(b){this._canvasModeCd=b._canvasModeCd}function FDsTemplateCanvasToolBar_onLookClick(b){this._canvasModeCd=b._canvasModeCd}function FDsTemplateCanvasToolBar_onPlayClick(b,d){this._frameSet._canvasContent._rotationAble=d}
function FDsTemplateCanvasToolBar_onViewClick(b){this._frameSet._canvasContent.switchRotation(b.checked)}function FDsTemplateCanvasToolBar_construct(){this.__base.FUiToolBar.construct.call(this)}function FDsTemplateCanvasToolBar_dispose(){this.__base.FUiToolBar.dispose.call(this)}
function FDsTemplateCatalogContent(b){b=RClass.inherits(this,b,FDsCatalog);b.onBuild=FDsTemplateCatalogContent_onBuild;b.onNodeClick=FDsTemplateCatalogContent_onNodeClick;b.construct=FDsTemplateCatalogContent_construct;b.buildTechnique=FDsTemplateCatalogContent_buildTechnique;b.buildRegion=FDsTemplateCatalogContent_buildRegion;b.buildMaterial=FDsTemplateCatalogContent_buildMaterial;b.buildDisplay=FDsTemplateCatalogContent_buildDisplay;b.buildSpace=FDsTemplateCatalogContent_buildSpace;b.dispose=FDsTemplateCatalogContent_dispose;
return b}function FDsTemplateCatalogContent_onBuild(b){this.__base.FDsCatalog.onBuild.call(this,b);this.loadUrl("/cloud.describe.tree.ws?action=query&code=resource.template")}function FDsTemplateCatalogContent_onNodeClick(b,d){var f=d.dataPropertyGet("linker");this.selectObject(f)}function FDsTemplateCatalogContent_construct(){this.__base.FDsCatalog.construct.call(this)}
function FDsTemplateCatalogContent_buildTechnique(b,d){var f=this.createNode();f.setLabel("Technique");f.setTypeCode("technique");f.dataPropertySet("linker",d);b.appendNode(f)}
function FDsTemplateCatalogContent_buildRegion(b,d){var f=this.createNode();f.setLabel("Region");f.setTypeCode("region");f.dataPropertySet("linker",d);b.appendNode(f);var h=this.createNode();h.setLabel("Camera");h.setTypeCode("camera");h.dataPropertySet("linker",d.camera());f.appendNode(h);h=this.createNode();h.setLabel("Light");h.setTypeCode("light");h.dataPropertySet("linker",d.directionalLight());f.appendNode(h)}
function FDsTemplateCatalogContent_buildMaterial(b,d){var f=d.resource(),h=this.createNode();h.setTypeCode("Material");h.setLabel(f.code());h.setNote(f.label());h.dataPropertySet("linker",d);b.appendNode(h)}
function FDsTemplateCatalogContent_buildDisplay(b,d){var f=d.resource(),h=this.createNode();h.setTypeCode("Display");h.setLabel(RString.nvl(f.code(),"Display"));h.setNote(f.label());h.dataPropertySet("linker",d);b.appendNode(h);var f=d.renderables(),q=f.count();if(0<q)for(var z=0;z<q;z++){var A=f.at(z),B=A.resource(),C=this.createNode();C.setTypeCode("Renderable");C.setLabel(B.code());C.setNote(B.label());C.dataPropertySet("linker",A);h.appendNode(C)}}
function FDsTemplateCatalogContent_buildSpace(b){this.clearAllNodes();var d=b.resource(),f=this.createNode();f.setTypeCode("Space");f.setLabel(d.code());f.setNote(d.label());f.dataPropertySet("linker",b);this.appendNode(f);this.buildTechnique(f,b.technique());this.buildRegion(f,b.region());var h=this.createNode();h.setTypeCode("Region");h.setLabel("Materials");f.appendNode(h);for(var q=b.materials(),z=q.count(),d=0;d<z;d++){var A=q.at(d);this.buildMaterial(h,A)}h=this.createNode();h.setTypeCode("Region");
h.setLabel("Displays");f.appendNode(h);b=b._sprites;q=b.count();for(d=0;d<q;d++)z=b.at(d),this.buildDisplay(h,z);f.click()}function FDsTemplateCatalogContent_dispose(){this.__base.FDsCatalog.dispose.call(this)}
function FDsTemplateCatalogToolBar(b){b=RClass.inherits(this,b,FUiToolBar);b._frameName="resource.template.CatalogToolBar";b._activeNodeGuid=null;b._controlCreateCamera=null;b._controlCreateLayer=null;b._controlCreateSprite=null;b._controlDelete=null;b._controlFolderOpen=null;b._controlFolderClose=null;b.onBuilded=FDsTemplateCatalogToolBar_onBuilded;b.onCreateCameraClick=FDsTemplateCatalogToolBar_onCreateCameraClick;b.onCreateDisplayClick=FDsTemplateCatalogToolBar_onCreateDisplayClick;b.onDeleteLoad=
FDsTemplateCatalogToolBar_onDeleteLoad;b.onDeleteExecute=FDsTemplateCatalogToolBar_onDeleteExecute;b.onCopyLoad=FDsTemplateCatalogToolBar_onCopyLoad;b.onCopyExecute=FDsTemplateCatalogToolBar_onCopyExecute;b.onCopyClick=FDsTemplateCatalogToolBar_onCopyClick;b.onDeleteClick=FDsTemplateCatalogToolBar_onDeleteClick;b.onFolderOpenClick=FDsTemplateCatalogToolBar_onFolderOpenClick;b.onFolderCloseClick=FDsTemplateCatalogToolBar_onFolderCloseClick;b.construct=FDsTemplateCatalogToolBar_construct;b.dispose=
FDsTemplateCatalogToolBar_dispose;return b}
function FDsTemplateCatalogToolBar_onBuilded(b){this.__base.FUiToolBar.onBuilded.call(this,b);this._controlCreateCamera.addClickListener(this,this.onCreateCameraClick);this._controlCreateDisplay.addClickListener(this,this.onCreateDisplayClick);this._controlCopy.addClickListener(this,this.onCopyClick);this._controlDelete.addClickListener(this,this.onDeleteClick);this._controlFolderOpen.addClickListener(this,this.onFolderOpenClick);this._controlFolderClose.addClickListener(this,this.onFolderCloseClick)}
function FDsTemplateCatalogToolBar_onCreateCameraClick(b){}function FDsTemplateCatalogToolBar_onCreateDisplayClick(b){b=this._frameSet;var d=b._activeSpace,f=RConsole.find(FUiWindowConsole).find(FDsCommonSpriteDialog);f._frameSet=b;f._spaceGuid=d.resource().guid();f.setContentCode("");f.setContentLabel("");f.showPosition(EUiPosition.Center)}function FDsTemplateCatalogToolBar_onCopyLoad(b){RConsole.find(FUiDesktopConsole).hide()}
function FDsTemplateCatalogToolBar_onCopyExecute(b){b.resultCd==EResult.Success&&(b=this._frameSet._activeSpace.resource().guid(),RConsole.find(FUiDesktopConsole).showUploading(),RConsole.find(FDrSceneConsole).copyNode(b,this._activeGuid).addLoadListener(this,this.onDeleteLoad))}
function FDsTemplateCatalogToolBar_onCopyClick(b){var d=this._frameSet._catalogContent.focusNode();if(!d)return RConsole.find(FUiMessageConsole).showInfo("\u8bf7\u9009\u4e2d\u8282\u70b9\u540e\uff0c\u518d\u70b9\u51fb\u64cd\u4f5c\u3002");this._activeNodeGuid=d.guid();b=null;d=d.dataPropertyGet("linker");if(RClass.isClass(d,FE3dSprite))b=d,this._activeGuid=d.resource().guid();else return alert("\u4e0d\u80fd\u590d\u5236\u5f53\u524d\u9009\u4e2d\u7684\u8282\u70b9.");var f=b.resource(),d=f.parent(),f=f.clone();
d.pushDisplay(f);d=RConsole.find(FE3dInstanceConsole).create(EE3dInstance.SceneDisplay);d.linkGraphicContext(b);d.loadResource(f);RConsole.find(FE3dSceneConsole).loadDisplay(d);b.parent().pushDisplay(d)}function FDsTemplateCatalogToolBar_onDeleteLoad(b){RConsole.find(FUiDesktopConsole).hide();b=this._frameSet._catalogContent;var d=this._activeNodeGuid;d&&b.findByGuid(d).removeSelf();this._activeNodeGuid=null}
function FDsTemplateCatalogToolBar_onDeleteExecute(b){b.resultCd==EResult.Success&&(b=this._frameSet._activeSpace.resource().guid(),RConsole.find(FUiDesktopConsole).showUploading(),RConsole.find(FDrSceneConsole).deleteNode(b,this._activeGuid).addLoadListener(this,this.onDeleteLoad))}
function FDsTemplateCatalogToolBar_onDeleteClick(b){b=this._frameSet._catalogContent.focusNode();if(!b)return RConsole.find(FUiMessageConsole).showInfo("\u8bf7\u9009\u4e2d\u8282\u70b9\u540e\uff0c\u518d\u70b9\u51fb\u64cd\u4f5c\u3002");this._activeNodeGuid=b.guid();b=b.dataPropertyGet("linker");if(RClass.isClass(b,FE3dSprite))this._activeGuid=b.resource().guid();else return alert("\u4e0d\u80fd\u5220\u9664\u5f53\u524d\u9009\u4e2d\u7684\u8282\u70b9.");RConsole.find(FUiMessageConsole).showConfirm("\u8bf7\u786e\u8ba4\u662f\u5426\u5220\u9664\u5f53\u524d\u8282\u70b9\uff1f").addResultListener(this,
this.onDeleteExecute)}function FDsTemplateCatalogToolBar_onFolderOpenClick(b){}function FDsTemplateCatalogToolBar_onFolderCloseClick(b){}function FDsTemplateCatalogToolBar_construct(){this.__base.FUiToolBar.construct.call(this)}function FDsTemplateCatalogToolBar_dispose(){this.__base.FUiToolBar.dispose.call(this)}
function FDsTemplateFrameSet(b){b=RClass.inherits(this,b,FDsFrameSet);b._frameCatalog=null;b._frameCatalogToolBar=null;b._frameCatalogContent=null;b._frameCanvas=null;b._frameCanvasToolBar=null;b._frameCanvasContent=null;b._frameProperty=null;b._framePropertyToolBar=null;b._framePropertyContent=null;b.onBuilded=FDsTemplateFrameSet_onBuilded;b.onDataLoaded=FDsTemplateFrameSet_onDataLoaded;b.onCatalogSelected=FDsTemplateFrameSet_onCatalogSelected;b.construct=FDsTemplateFrameSet_construct;b.loadByGuid=
FDsTemplateFrameSet_loadByGuid;b.loadByCode=FDsTemplateFrameSet_loadByCode;b.dispose=FDsTemplateFrameSet_dispose;return b}
function FDsTemplateFrameSet_onBuilded(b){this.__base.FDsFrameSet.onBuilded.call(this,b);this._frameCatalogToolBar._hPanel.className=this.styleName("ToolBar_Ground");this._frameCatalogContent._hPanel.className=this.styleName("Catalog_Content");this._frameCanvasToolBar._hPanel.className=this.styleName("ToolBar_Ground");this._frameCanvasContent._hPanel.className=this.styleName("Canvas_Content");this._framePropertyToolBar._hPanel.className=this.styleName("ToolBar_Ground");this._framePropertyContent._hPanel.className=
this.styleName("Property_Content");b=this._spliterCatalog;b.setAlignCd(EUiAlign.Left);b.setSizeHtml(this._frameCatalog._hPanel);b=this._spliterProperty;b.setAlignCd(EUiAlign.Right);b.setSizeHtml(this._frameProperty._hPanel)}function FDsTemplateFrameSet_onDataLoaded(b){b=this._activeSpace=b.sender.activeSpace();this._catalogContent.buildSpace(b)}
function FDsTemplateFrameSet_onCatalogSelected(b,d){var f=this._activeSpace;if(f)if(this.hidePropertyFrames(),RClass.isClass(b,FE3dSpace)){var h=this.findPropertyFrame(EDsFrame.CommonSpacePropertyFrame);h.show();h.loadObject(f,b)}else if(RClass.isClass(b,FG3dTechnique))h=this.findPropertyFrame(EDsFrame.CommonTechniquePropertyFrame),h.show(),h.loadObject(f,b);else if(RClass.isClass(b,FE3dRegion))h=this.findPropertyFrame(EDsFrame.CommonRegionPropertyFrame),h.show(),h.loadObject(f,b);else if(RClass.isClass(b,
FE3dCamera))h=this.findPropertyFrame(EDsFrame.CommonCameraPropertyFrame),h.show(),h.loadObject(f,b);else if(RClass.isClass(b,FG3dDirectionalLight))h=this.findPropertyFrame(EDsFrame.CommonLightPropertyFrame),h.show(),h.loadObject(f,b);else if(RClass.isClass(b,FE3dTemplateDisplay))h=this.findPropertyFrame(EDsFrame.CommonDisplayPropertyFrame),h.show(),h.loadObject(f,b);else if(RClass.isClass(b,FG3dMaterial))h=this.findPropertyFrame(EDsFrame.CommonMaterialPropertyFrame),h.show(),h.loadObject(f,b);else if(RClass.isClass(b,
FE3dRenderable))h=this.findPropertyFrame(EDsFrame.CommonRenderablePropertyFrame),h.show(),h.loadObject(f,b);else throw new TError("Unknown select object type. (select={1})",b);}function FDsTemplateFrameSet_construct(){this.__base.FDsFrameSet.construct.call(this)}function FDsTemplateFrameSet_loadByGuid(b){this._activeGuid=b;this._canvasContent.loadByGuid(b)}function FDsTemplateFrameSet_loadByCode(b){this._activeCode=b;this._canvasContent.loadByCode(b)}
function FDsTemplateFrameSet_dispose(){this.__base.FDsFrameSet.dispose.call(this)}
function FDsTemplateMenuBar(b){b=RClass.inherits(this,b,FUiMenuBar);b._controlSave=null;b._controlCapture=null;b._controlSelectMaterial=null;b._controlCreateDisplay=null;b._controlDelete=null;b.onSaveLoad=FDsTemplateMenuBar_onSaveLoad;b.onSaveClick=FDsTemplateMenuBar_onSaveClick;b.onCaptureLoad=FDsTemplateMenuBar_onCaptureLoad;b.onCaptureClick=FDsTemplateMenuBar_onCaptureClick;b.onSelectMaterialClick=FDsTemplateMenuBar_onSelectMaterialClick;b.onCreateDisplayClick=FDsTemplateMenuBar_onCreateDisplayClick;
b.onDeleteClick=FDsTemplateMenuBar_onDeleteClick;b.construct=FDsTemplateMenuBar_construct;b.dispose=FDsTemplateMenuBar_dispose;return b}function FDsTemplateMenuBar_onSaveLoad(b){RConsole.find(FUiDesktopConsole).hide()}function FDsTemplateMenuBar_onSaveClick(b){b=this._frameSet._activeSpace.resource();RConsole.find(FUiDesktopConsole).showUploading();var d=new TXmlNode;b.saveConfig(d);RConsole.find(FDrTemplateConsole).update(d).addLoadListener(this,this.onSaveLoad)}
function FDsTemplateMenuBar_onCaptureLoad(b){RConsole.find(FUiDesktopConsole).hide()}function FDsTemplateMenuBar_onCaptureClick(b){RConsole.find(FUiDesktopConsole).showUploading();this._frameSet._canvasContent.capture().addLoadListener(this,this.onCaptureLoad)}
function FDsTemplateMenuBar_onSelectMaterialClick(b){b=this._frameSet;var d=b._activeSpace,f=RConsole.find(FUiWindowConsole).find(FDsCommonMaterialDialog);f._frameSet=b;f._spaceGuid=d.resource().guid();f.setSpace(d);f.setContentCode("");f.setContentLabel("");f.showPosition(EUiPosition.Center)}
function FDsTemplateMenuBar_onCreateDisplayClick(b){b=this._frameSet;var d=b._activeSpace,f=RConsole.find(FUiWindowConsole).find(FDsCommonDisplayDialog);f._frameSet=b;f._spaceGuid=d.resource().guid();f.setSpace(d);f.setContentCode("");f.setContentLabel("");f.showPosition(EUiPosition.Center)}
function FDsTemplateMenuBar_onDeleteClick(b){b=this._frameSet;var d=b._activeSpace,f=RConsole.find(FUiWindowConsole).find(FDsCommonDisplayDialog);f._frameSet=b;f._spaceGuid=d.resource().guid();f.setContentCode("");f.setContentLabel("");f.showPosition(EUiPosition.Center)}function FDsTemplateMenuBar_construct(){this.__base.FUiMenuBar.construct.call(this)}function FDsTemplateMenuBar_dispose(){this.__base.FUiMenuBar.dispose.call(this)}
function FDsTemplateToolBar(b){b=RClass.inherits(this,b,FUiToolBar);b._refreshButton=null;b._saveButton=null;b.onBuild=FDsTemplateToolBar_onBuild;b.onRefreshClick=FDsTemplateToolBar_onRefreshClick;b.onSaveClick=FDsTemplateToolBar_onSaveClick;b.construct=FDsTemplateToolBar_construct;b.dispose=FDsTemplateToolBar_dispose;return b}
function FDsTemplateToolBar_onBuild(b){this.__base.FUiToolBar.onBuild.call(this,b);var d=this._refreshButton=RClass.create(FUiToolButton);d.setLabel("\u5237\u65b0");d.setIcon("design3d.tools.refresh");d.build(b);d.addClickListener(this,this.onRefreshClick);this.push(d);d=this._saveButton=RClass.create(FUiToolButton);d.setLabel("\u4fdd\u5b58");d.setIcon("design3d.tools.save");d.build(b);d.addClickListener(this,this.onSaveClick);this.push(d)}function FDsTemplateToolBar_onRefreshClick(b){}
function FDsTemplateToolBar_onSaveClick(b){var d=this._workspace._activeTemplate;b=d._resource.themes();for(var f=b.count(),h=new TXmlNode,q=0;q<f;q++)for(var d=b.get(q),d=d.materials(),z=d.count(),A=0;A<z;A++)d.value(A).saveConfig(h.create("Material"));RConsole.find(FE3sTemplateConsole).update(h)}function FDsTemplateToolBar_construct(){this.__base.FUiToolBar.construct.call(this)}function FDsTemplateToolBar_dispose(){this.__base.FUiToolBar.dispose.call(this)}
function FDsTemplateWorkspace(b){b=RClass.inherits(this,b,FUiWorkspace);b._styleToolbarGround=RClass.register(b,new AStyle("_styleToolbarGround","Toolbar_Ground"));b._styleStatusbarGround=RClass.register(b,new AStyle("_styleStatusbarGround","Statusbar_Ground"));b._styleCatalogGround=RClass.register(b,new AStyle("_styleCatalogGround","Catalog_Ground"));b._styleWorkspaceGround=RClass.register(b,new AStyle("_styleWorkspaceGround","Workspace_Ground"));b._stylePropertyGround=RClass.register(b,new AStyle("_stylePropertyGround",
"Property_Ground"));b._framesetMain=null;b._framesetBody=null;b._frameToolBar=null;b._frameBody=null;b._frameProperty=null;b._frameCatalog=null;b._frameWorkspace=null;b._frameStatusBar=null;b._templatePropertyFrame=null;b._themePropertyFrame=null;b._materialPropertyFrame=null;b._displayPropertyFrame=null;b.onBuild=FDsTemplateWorkspace_onBuild;b.onTemplateLoad=FDsTemplateWorkspace_onTemplateLoad;b.onCatalogSelected=FDsTemplateWorkspace_onCatalogSelected;b.construct=FDsTemplateWorkspace_construct;b.templatePropertyFrame=
FDsTemplateWorkspace_templatePropertyFrame;b.themePropertyFrame=FDsTemplateWorkspace_themePropertyFrame;b.materialPropertyFrame=FDsTemplateWorkspace_materialPropertyFrame;b.displayPropertyFrame=FDsTemplateWorkspace_displayPropertyFrame;b.loadTemplate=FDsTemplateWorkspace_loadTemplate;b.dispose=FDsTemplateWorkspace_dispose;return b}
function FDsTemplateWorkspace_onBuild(b){this.__base.FUiWorkspace.onBuild.call(this,b);this._hPanel.style.width="100%";this._hPanel.style.height="100%";var d=this._framesetMain=RClass.create(FUiFrameSet);d.build(b);var f=this._frameToolBar=RClass.create(FUiFramePage);f.setHeight(26);f.build(b);f._hPanel.className=this.styleName("Toolbar_Ground");d.appendFrame(f);f=this._frameBody=RClass.create(FUiFramePage);f.build(b);d.appendFrame(f);f=this._frameStatusBar=RClass.create(FUiFramePage);f.setHeight(18);
f.build(b);f._hPanel.className=this.styleName("Statusbar_Ground");d.appendFrame(f);d.setPanel(this._hPanel);d=RClass.create(FUiFrameSet);d._directionCd=EUiDirection.Horizontal;d.build(b);f=this._frameCatalog=RClass.create(FUiFramePage);f.setWidth(400);f.build(b);f._hPanel.className=this.styleName("Catalog_Ground");d.appendFrame(f);var h=d.appendSpliter(),f=this._frameWorkspace=RClass.create(FUiFramePage);f.build(b);f._hPanel.className=this.styleName("Workspace_Ground");d.appendFrame(f);var q=d.appendSpliter(),
f=this._frameProperty=RClass.create(FUiFramePage);f.setWidth(240);f.build(b);f._hPanel.className=this.styleName("Property_Ground");d.appendFrame(f);d.setPanel(this._frameBody._hPanel);h._alignCd=EUiAlign.Left;h._hSize=this._frameCatalog._hPanel;q._alignCd=EUiAlign.Right;q._hSize=this._frameStatusBar._hPanel;d=this._catalog=RClass.create(FDsTemplateCatalog);d._workspace=this;d.build(b);d.setPanel(this._frameCatalog._hPanel);d.addSelectedListener(this,this.onCatalogSelected);this.push(d);d=this._toolbar=
RClass.create(FDsTemplateToolBar);d._workspace=this;d.build(b);d.setPanel(this._frameToolBar._hPanel);this.push(d);f=RBuilder.appendTable(this._frameWorkspace._hPanel);f.style.width="100%";f.style.height="100%";h=RBuilder.appendTableRowCell(f);h.height=20;d=this._canvasToolbar=RClass.create(FDsTemplateCanvasToolBar);d._workspace=this;d.build(b);d.setPanel(h);this.push(d);h=RBuilder.appendTableRowCell(f);h.vAlign="top";d=this._canvas=RClass.create(FDsTemplateCanvas);d.addLoadListener(this,this.onTemplateLoad);
d._workspace=this;d._toolbar=this._canvasToolbar;d.build(b);d.setPanel(h);this.push(d)}function FDsTemplateWorkspace_onTemplateLoad(b){b=this._activeTemplate=b._activeTemplate;this._catalog.buildTemplate(b);this.onCatalogSelected(b)}
function FDsTemplateWorkspace_onCatalogSelected(b){var d=this._activeTemplate;this._templatePropertyFrame&&this._templatePropertyFrame.hide();this._themePropertyFrame&&this._themePropertyFrame.hide();this._materialPropertyFrame&&this._materialPropertyFrame.hide();this._displayPropertyFrame&&this._displayPropertyFrame.hide();if(RClass.isClass(b,FE3dTemplate)){var f=this.templatePropertyFrame();f.show();f.loadObject(d)}else if(RClass.isClass(b,FE3sTemplateTheme))f=this.themePropertyFrame(),f.show(),
f.loadObject(d,b);else if(RClass.isClass(b,FE3sMaterial))f=this.materialPropertyFrame(),f.show(),f.loadObject(d,b);else if(RClass.isClass(b,MG3dRenderable))f=this.displayPropertyFrame(),f.show(),f.loadObject(d,b),this._canvas.selectRenderable(b);else throw new TError("Unknown select object type. (value={1})",b);}function FDsTemplateWorkspace_construct(){this.__base.FUiWorkspace.construct.call(this)}
function FDsTemplateWorkspace_templatePropertyFrame(){var b=this._templatePropertyFrame;b||(b=this._templatePropertyFrame=RClass.create(FDsTemplatePropertyFrame),b._workspace=this,b.buildDefine(this._hPanel),b.setPanel(this._frameProperty._hPanel));return b}
function FDsTemplateWorkspace_themePropertyFrame(){var b=this._themePropertyFrame;b||(b=this._themePropertyFrame=RClass.create(FDsTemplateThemePropertyFrame),b._workspace=this,b.buildDefine(this._hPanel),b.setPanel(this._frameProperty._hPanel));return b}
function FDsTemplateWorkspace_materialPropertyFrame(){var b=this._materialPropertyFrame;b||(b=this._materialPropertyFrame=RClass.create(FDsTemplateMaterialPropertyFrame),b._workspace=this,b.buildDefine(this._hPanel),b.setPanel(this._frameProperty._hPanel));return b}
function FDsTemplateWorkspace_displayPropertyFrame(){var b=this._displayPropertyFrame;b||(b=this._displayPropertyFrame=RClass.create(FDsTemplateDisplayPropertyFrame),b._workspace=this,b.buildDefine(this._hPanel),b.setPanel(this._frameProperty._hPanel));return b}function FDsTemplateWorkspace_loadTemplate(b){this._canvas.loadTemplate(b)}function FDsTemplateWorkspace_dispose(){this.__base.FUiWorkspace.dispose.call(this)}
function FDsSceneCanvasContent(b){b=RClass.inherits(this,b,FDsSpaceDesignCanvas);b._resourceTypeCd=EE3sResource.Scene;b.loadByGuid=FDsSceneCanvasContent_loadByGuid;b.dispose=FDsSceneCanvasContent_dispose;return b}function FDsSceneCanvasContent_onDataLoaded(b){this.reloadRegion();this.processLoadListener(this);RConsole.find(FUiDesktopConsole).hide()}
function FDsSceneCanvasContent_loadByGuid(b){var d=this._activeSpace,f=RConsole.find(FE3dSceneConsole);d&&(RStage.unregister(d),f.free(d));d=this._activeSpace=f.allocByGuid(this,b);d._linked||(RConsole.find(FUiDesktopConsole).showLoading(),d.addLoadListener(this,this.onDataLoaded),d._linked=!0);RStage.register("space",d)}function FDsSceneCanvasContent_dispose(){this.__base.FDsSpaceDesignCanvas.dispose.call(this)}
function FDsSceneCanvasToolBar(b){b=RClass.inherits(this,b,FUiToolBar);b._frameName="resource.scene.CanvasToolBar";b._canvasModeCd=EDsCanvasMode.Drop;b._controlModeDrop=null;b._controlModeSelect=null;b._controlTranslate=null;b._controlRotation=null;b._controlScale=null;b._controlLookFront=null;b._controlLookUp=null;b._controlLookLeft=null;b._controlPlay=null;b._controlView=null;b.onBuilded=FDsSceneCanvasToolBar_onBuilded;b.onModeClick=FDsSceneCanvasToolBar_onModeClick;b.onLookClick=FDsSceneCanvasToolBar_onLookClick;
b.onPlayClick=FDsSceneCanvasToolBar_onPlayClick;b.onRotationClick=FDsSceneCanvasToolBar_onRotationClick;b.construct=FDsSceneCanvasToolBar_construct;b.dispose=FDsSceneCanvasToolBar_dispose;return b}
function FDsSceneCanvasToolBar_onBuilded(b){this.__base.FUiToolBar.onBuilded.call(this,b);b=this._controlModeDrop;b._canvasModeCd=EDsCanvasMode.Drop;b.addClickListener(this,this.onModeClick);b.check(!0);b=this._controlModeSelect;b._canvasModeCd=EDsCanvasMode.Select;b.addClickListener(this,this.onModeClick);b=this._controlTranslate;b._canvasModeCd=EDsCanvasMode.Translate;b.addClickListener(this,this.onModeClick);b=this._controlRotation;b._canvasModeCd=EDsCanvasMode.Rotation;b.addClickListener(this,
this.onModeClick);b=this._controlScale;b._canvasModeCd=EDsCanvasMode.Scale;b.addClickListener(this,this.onModeClick);this._controlLookFront.addClickListener(this,this.onLookClick);this._controlLookUp.addClickListener(this,this.onLookClick);this._controlLookLeft.addClickListener(this,this.onLookClick);this._controlPlay.addClickListener(this,this.onPlayClick);this._controlView.addClickListener(this,this.onRotationClick)}
function FDsSceneCanvasToolBar_onModeClick(b){this._canvasModeCd=b=b.sender._canvasModeCd;this._frameSet._canvasContent.switchMode(b)}function FDsSceneCanvasToolBar_onLookClick(b){this._canvasModeCd=p._canvasModeCd}function FDsSceneCanvasToolBar_onPlayClick(b){this._frameSet._canvasContent.switchPlay(b.checked)}function FDsSceneCanvasToolBar_onRotationClick(b){this._frameSet._canvasContent.switchMovie(b.checked)}
function FDsSceneCanvasToolBar_construct(){this.__base.FUiToolBar.construct.call(this)}function FDsSceneCanvasToolBar_dispose(){this.__base.FUiToolBar.dispose.call(this)}
function FDsSceneCatalogContent(b){b=RClass.inherits(this,b,FDsCatalog);b._catalogCode="resource.scene";b.onBuild=FDsSceneCatalogContent_onBuild;b.onLoadDisplay=FDsSceneCatalogContent_onLoadDisplay;b.construct=FDsSceneCatalogContent_construct;b.buildRenderable=FDsSceneCatalogContent_buildRenderable;b.buildDisplay=FDsSceneCatalogContent_buildDisplay;b.buildLayer=FDsSceneCatalogContent_buildLayer;b.buildSpace=FDsSceneCatalogContent_buildSpace;b.dispose=FDsSceneCatalogContent_dispose;return b}
function FDsSceneCatalogContent_onBuild(b){var d=RClass.create(FUiTreeColumn);d.setName("view");this.push(d);this.__base.FDsCatalog.onBuild.call(this,b);this.loadUrl("/cloud.describe.tree.ws?action=query&code="+this._catalogCode)}function FDsSceneCatalogContent_onLoadDisplay(b){this.buildRenderable(b._linkNode,b)}function FDsSceneCatalogContent_construct(){this.__base.FDsCatalog.construct.call(this)}
function FDsSceneCatalogContent_buildRenderable(b,d){var f=d.materials();if(f)for(var h=f.count(),q=0;q<h;q++){var z=f.at(q),A=z.resource(),B=this.createNode();B.setTypeCode("Material");B.setLabel(A.code());B.setNote(A.label());B.dataPropertySet("linker",z);this.buildNodeView(B,!0);b.appendNode(B);this._materialNodes.push(B)}if(f=d.animations())for(h=f.count(),q=0;q<h;q++)z=f.at(q),A=z.resource(),B=this.createNode(),B.setTypeCode("Animation"),B.setLabel(A.code()),B.setNote(A.label()),B.dataPropertySet("linker",
z),b.appendNode(B),this.buildNodeView(B,!0);if(f=d.meshRenderables())for(h=f.count(),q=0;q<h;q++)z=f.at(q),A=z.resource(),A.model(),A=A.mesh(),B=this.createNode(),B.setTypeCode("Renderable"),B.setLabel(A.code()),B.dataPropertySet("linker",z),this.buildNodeView(B,!0),b.appendNode(B),this._renderableNodes.push(B)}
function FDsSceneCatalogContent_buildDisplay(b,d){var f=d.displays();if(f)for(var h=f.count(),q=0;q<h;q++){var z=f.at(q),A=z.resource(),B=this.createNode();B.setTypeCode("display");B.setLabel(A.code());B.setNote(A.label());B.dataPropertySet("linker",z);this.buildNodeView(B,!0);this._displayNodes.push(B);b.appendNode(B);z.addLoadListener(this,this.onLoadDisplay);z._linkNode=B}}
function FDsSceneCatalogContent_buildLayer(b,d){var f=this.createNode();f.setTypeCode("Layers");f.setLabel("Layers");f.dataPropertySet("linker","layers");this.buildNodeView(f,!0);b.appendNode(f);for(var h=d.layers(),q=h.count(),z=0;z<q;z++){var A=h.at(z);if(!RClass.isClass(A,FDisplayUiLayer)){var B=A.resource(),C=this.createNode();C.setTypeCode("Layer");C.setLabel("Layer:"+B.code());C.dataPropertySet("linker",A);this.buildNodeView(C,!0);f.appendNode(C);this.buildDisplay(C,A)}}}
function FDsSceneCatalogContent_buildSpace(b){this.clearAllNodes();var d=b.resource(),f=this.createNode();f.setTypeCode("Scene");f.setLabel(d.code());f.setNote(d.label());f.dataPropertySet("linker",b);this.push(f);this.buildTechnique(f,b.technique());this.buildRegion(f,b.region());this.buildLayer(f,b);f.click()}function FDsSceneCatalogContent_dispose(){this.__base.FDsCatalog.dispose.call(this)}
function FDsSceneCatalogToolBar(b){b=RClass.inherits(this,b,FUiToolBar);b._activeNodeGuid=null;b._controlCreateCamera=null;b._controlCreateLayer=null;b._controlCreateSprite=null;b._controlDelete=null;b._controlFolderOpen=null;b._controlFolderClose=null;b.onBuilded=FDsSceneCatalogToolBar_onBuilded;b.onCreateCameraClick=FDsSceneCatalogToolBar_onCreateCameraClick;b.onCreateLayerClick=FDsSceneCatalogToolBar_onCreateLayerClick;b.onCreateSpriteClick=FDsSceneCatalogToolBar_onCreateSpriteClick;b.onDeleteLoad=
FDsSceneCatalogToolBar_onDeleteLoad;b.onDeleteExecute=FDsSceneCatalogToolBar_onDeleteExecute;b.onCopyLoad=FDsSceneCatalogToolBar_onCopyLoad;b.onCopyExecute=FDsSceneCatalogToolBar_onCopyExecute;b.onCopyClick=FDsSceneCatalogToolBar_onCopyClick;b.onDeleteClick=FDsSceneCatalogToolBar_onDeleteClick;b.onFolderOpenClick=FDsSceneCatalogToolBar_onFolderOpenClick;b.onFolderCloseClick=FDsSceneCatalogToolBar_onFolderCloseClick;b.construct=FDsSceneCatalogToolBar_construct;b.dispose=FDsSceneCatalogToolBar_dispose;
return b}
function FDsSceneCatalogToolBar_onBuilded(b){this.__base.FUiToolBar.onBuilded.call(this,b);this._controlCreateCamera.addClickListener(this,this.onCreateCameraClick);this._controlCreateLayer.addClickListener(this,this.onCreateLayerClick);this._controlCreateSprite.addClickListener(this,this.onCreateSpriteClick);this._controlCopy.addClickListener(this,this.onCopyClick);this._controlDelete.addClickListener(this,this.onDeleteClick);this._controlFolderOpen.addClickListener(this,this.onFolderOpenClick);this._controlFolderClose.addClickListener(this,
this.onFolderCloseClick)}function FDsSceneCatalogToolBar_onCreateCameraClick(b){}function FDsSceneCatalogToolBar_onCreateLayerClick(b){}
function FDsSceneCatalogToolBar_onCreateSpriteClick(b){b=this._frameSet._catalogContent.focusNode();if(!b)return alert("\u8bf7\u9009\u4e2d\u76ee\u5f55\u8282\u70b9\u3002");var d=b.dataPropertyGet("linker"),f=b=null;if(RClass.isClass(d,FDisplayLayer))b=d;else if(RClass.isClass(d,FE3dSprite))b=d.findParent(FDisplayLayer),f=d;else return alert("\u8bf7\u9009\u4e2d\u663e\u793a\u5c42\u6216\u8005\u7cbe\u7075\u8282\u70b9\u3002");var d=this._frameSet,h=RConsole.find(FUiWindowConsole).find(FDsCommonSpriteDialog);
h._frameSet=d;h._spaceGuid=d._activeSpace.resource().guid();h._layerGuid=b.resource().guid();h._displayGuid=f?f.resource().guid():null;b&&h.setLayerLabel(b.makeLabel());f&&h.setDisplayLabel(f.makeLabel());h.setContentCode("");h.setContentLabel("");h.showPosition(EUiPosition.Center)}function FDsSceneCatalogToolBar_onCopyLoad(b){RConsole.find(FUiDesktopConsole).hide()}
function FDsSceneCatalogToolBar_onCopyExecute(b){b.resultCd==EResult.Success&&(b=this._frameSet._activeSpace.resource().guid(),RConsole.find(FUiDesktopConsole).showUploading(),RConsole.find(FDrSceneConsole).copyNode(b,this._activeGuid).addLoadListener(this,this.onDeleteLoad))}
function FDsSceneCatalogToolBar_onCopyClick(b){var d=this._frameSet._catalogContent.focusNode();if(!d)return RConsole.find(FUiMessageConsole).showInfo("\u8bf7\u9009\u4e2d\u8282\u70b9\u540e\uff0c\u518d\u70b9\u51fb\u64cd\u4f5c\u3002");this._activeNodeGuid=d.guid();b=null;d=d.dataPropertyGet("linker");if(RClass.isClass(d,FE3dSprite))b=d,this._activeGuid=d.resource().guid();else return alert("\u4e0d\u80fd\u590d\u5236\u5f53\u524d\u9009\u4e2d\u7684\u8282\u70b9.");var f=b.resource(),d=f.parent(),f=f.clone();
d.pushDisplay(f);d=RConsole.find(FE3dInstanceConsole).create(EE3dInstance.SceneDisplay);d.linkGraphicContext(b);d.loadResource(f);RConsole.find(FE3dSceneConsole).loadDisplay(d);b.parent().pushDisplay(d)}function FDsSceneCatalogToolBar_onDeleteLoad(b){RConsole.find(FUiDesktopConsole).hide();b=this._frameSet._catalogContent;var d=this._activeNodeGuid;d&&b.findByGuid(d).removeSelf();this._activeNodeGuid=null}
function FDsSceneCatalogToolBar_onDeleteExecute(b){b.resultCd==EResult.Success&&(b=this._frameSet._activeSpace.resource().guid(),RConsole.find(FUiDesktopConsole).showUploading(),RConsole.find(FDrSceneConsole).deleteNode(b,this._activeGuid).addLoadListener(this,this.onDeleteLoad))}
function FDsSceneCatalogToolBar_onDeleteClick(b){b=this._frameSet._catalogContent.focusNode();if(!b)return RConsole.find(FUiMessageConsole).showInfo("\u8bf7\u9009\u4e2d\u8282\u70b9\u540e\uff0c\u518d\u70b9\u51fb\u64cd\u4f5c\u3002");this._activeNodeGuid=b.guid();b=b.dataPropertyGet("linker");if(RClass.isClass(b,FE3dSprite))this._activeGuid=b.resource().guid();else return alert("\u4e0d\u80fd\u5220\u9664\u5f53\u524d\u9009\u4e2d\u7684\u8282\u70b9.");RConsole.find(FUiMessageConsole).showConfirm("\u8bf7\u786e\u8ba4\u662f\u5426\u5220\u9664\u5f53\u524d\u8282\u70b9\uff1f").addResultListener(this,
this.onDeleteExecute)}function FDsSceneCatalogToolBar_onFolderOpenClick(b){}function FDsSceneCatalogToolBar_onFolderCloseClick(b){}function FDsSceneCatalogToolBar_construct(){this.__base.FUiToolBar.construct.call(this)}function FDsSceneCatalogToolBar_dispose(){this.__base.FUiToolBar.dispose.call(this)}
function FDsSceneFrameSet(b){b=RClass.inherits(this,b,FDsFrameSet);b._frameCatalog=null;b._frameCatalogToolBar=null;b._frameCatalogContent=null;b._frameCanvas=null;b._frameCanvasToolBar=null;b._frameCanvasContent=null;b._frameProperty=null;b._framePropertyToolBar=null;b._framePropertyContent=null;b.onBuilded=FDsSceneFrameSet_onBuilded;b.onDataLoaded=FDsSceneFrameSet_onDataLoaded;b.onCatalogSelected=FDsSceneFrameSet_onCatalogSelected;b.construct=FDsSceneFrameSet_construct;b.loadByGuid=FDsSceneFrameSet_loadByGuid;
b.loadByCode=FDsSceneFrameSet_loadByCode;b.dispose=FDsSceneFrameSet_dispose;return b}
function FDsSceneFrameSet_onBuilded(b){this.__base.FDsFrameSet.onBuilded.call(this,b);this._frameCatalogToolBar._hPanel.className=this.styleName("ToolBar_Ground");this._frameCatalogContent._hPanel.className=this.styleName("Catalog_Content");this._frameCanvasToolBar._hPanel.className=this.styleName("ToolBar_Ground");this._frameCanvasContent._hPanel.className=this.styleName("Canvas_Content");this._framePropertyToolBar._hPanel.className=this.styleName("ToolBar_Ground");this._framePropertyContent._hPanel.className=
this.styleName("Property_Content");b=this._spliterCatalog;b.setAlignCd(EUiAlign.Left);b.setSizeHtml(this._frameCatalog._hPanel);b=this._spliterProperty;b.setAlignCd(EUiAlign.Right);b.setSizeHtml(this._frameProperty._hPanel);b=RConsole.find(FE3dInstanceConsole);b.register(EE3dInstance.TemplateRenderable,FDsSceneRenderable);b.register(EE3dInstance.SceneLayer,FDsSceneLayer);b.register(EE3dInstance.SceneDisplay,FDsSceneDisplay);b.register(EE3dInstance.SceneRenderable,FDsSceneRenderable)}
function FDsSceneFrameSet_onDataLoaded(b){b=this._activeSpace=b._activeSpace;this._catalogContent.buildSpace(b)}
function FDsSceneFrameSet_onCatalogSelected(b,d){var f=this._activeSpace;if(f){var h=this._canvasContent;this.hidePropertyFrames();if(RClass.isClass(b,FE3dScene))h=this.findPropertyFrame(EDsFrame.CommonSpacePropertyFrame),h.show(),h.loadObject(f,b);else if(RClass.isClass(b,FG3dTechnique))h=this.findPropertyFrame(EDsFrame.CommonTechniquePropertyFrame),h.show(),h.loadObject(f,b);else if(RClass.isClass(b,FE3dRegion))h=this.findPropertyFrame(EDsFrame.CommonRegionPropertyFrame),h.show(),h.loadObject(f,
b);else if(RClass.isClass(b,FE3dCamera))h=this.findPropertyFrame(EDsFrame.CommonCameraPropertyFrame),h.show(),h.loadObject(f,b);else if(RClass.isClass(b,FG3dDirectionalLight))h=this.findPropertyFrame(EDsFrame.CommonLightPropertyFrame),h.show(),h.loadObject(f,b);else if("layers"==b)d&&h.selectLayers(b);else if(RClass.isClass(b,FE3dSceneLayer))d&&h.selectLayer(b),h=this.findPropertyFrame(EDsFrame.CommonLayerPropertyFrame),h.show(),h.loadObject(f,b);else if(RClass.isClass(b,FE3dSceneDisplay))d&&h.selectDisplay(b),
h=this.findPropertyFrame(EDsFrame.CommonDisplayPropertyFrame),h.show(),h.loadObject(f,b);else if(RClass.isClass(b,FE3dSceneMaterial))d&&h.selectMaterial(b),h=this.findPropertyFrame(EDsFrame.CommonMaterialPropertyFrame),h.show(),h.loadObject(f,b);else if(RClass.isClass(b,FE3dAnimation))h=this.findPropertyFrame(EDsFrame.CommonAnimationPropertyFrame),h.show(),h.loadObject(f,b);else if(RClass.isClass(b,FE3dRenderable))d&&h.selectRenderable(b),h=this.findPropertyFrame(EDsFrame.CommonRenderablePropertyFrame),
h.show(),h.loadObject(f,b);else throw new TError("Unknown select type. (select={1})",b);}}function FDsSceneFrameSet_construct(){this.__base.FDsFrameSet.construct.call(this)}function FDsSceneFrameSet_loadByGuid(b){this._activeGuid=b;this._canvasContent.loadByGuid(b)}function FDsSceneFrameSet_loadByCode(b){this._avtiveCode=b;this._canvasContent.loadByCode(b)}function FDsSceneFrameSet_dispose(){this.__base.FDsFrameSet.dispose.call(this)}
function FDsSceneMenuBar(b){b=RClass.inherits(this,b,FUiMenuBar);b._refreshButton=null;b._saveButton=null;b._runButton=null;b.onBuilded=FDsSceneMenuBar_onBuilded;b.onSaveLoad=FDsSceneMenuBar_onSaveLoad;b.onSaveClick=FDsSceneMenuBar_onSaveClick;b.onCaptureLoad=FDsSceneMenuBar_onCaptureLoad;b.onCaptureClick=FDsSceneMenuBar_onCaptureClick;b.onCreateLayerClick=FDsSceneMenuBar_onCreateLayerClick;b.onImportTemplateClick=FDsSceneMenuBar_onImportTemplateClick;b.onExecuteClick=FDsSceneMenuBar_onExecuteClick;
b.construct=FDsSceneMenuBar_construct;b.dispose=FDsSceneMenuBar_dispose;return b}function FDsSceneMenuBar_onBuilded(b){this.__base.FUiMenuBar.onBuilded.call(this,b)}function FDsSceneMenuBar_onSaveLoad(b){RConsole.find(FUiDesktopConsole).hide()}
function FDsSceneMenuBar_onSaveClick(b){b=this._frameSet._activeSpace;b.commitResource();b=b.resource();RConsole.find(FUiDesktopConsole).showUploading();var d=new TXmlNode;b.saveConfig(d);RConsole.find(FDrSceneConsole).update(d).addLoadListener(this,this.onSaveLoad)}function FDsSceneMenuBar_onCaptureLoad(b){RConsole.find(FUiDesktopConsole).hide()}
function FDsSceneMenuBar_onCaptureClick(b){RConsole.find(FUiDesktopConsole).showUploading();this._frameSet._canvasContent.capture().addLoadListener(this,this.onCaptureLoad)}function FDsSceneMenuBar_onCreateLayerClick(b){b=this._frameSet;var d=b._activeSpace,f=RConsole.find(FUiWindowConsole).find(FDsCommonLayerDialog);f._frameSet=b;f._spaceGuid=d.resource().guid();f.setSpace(d);f.setContentCode("");f.setContentLabel("");f.showPosition(EUiPosition.Center)}
function FDsSceneMenuBar_onImportTemplateClick(){var b=this._frameSet,d=b._activeSpace,f=RConsole.find(FUiWindowConsole).find(FDsCommonTemplateDialog);f._frameSet=b;f._spaceGuid=d.resource().guid();f.setSpace(d);f.setContentCode("");f.setContentLabel("");f.showPosition(EUiPosition.Center)}function FDsSceneMenuBar_onExecuteClick(b){window.location="Space.wa?do=run&guid="+this._frameSet._activeGuid}function FDsSceneMenuBar_construct(){this.__base.FUiMenuBar.construct.call(this)}
function FDsSceneMenuBar_dispose(){this.__base.FUiMenuBar.dispose.call(this)}
function FDsScenePropertyToolBar(b){b=RClass.inherits(this,b,FUiToolBar);b._frameName="resource.scene.PropertyToolBar";b._controlRefresh=null;b._activeNodeGuid=null;b.onBuilded=FDsScenePropertyToolBar_onBuilded;b.onFolderCreateClick=FDsScenePropertyToolBar_onFolderCreateClick;b.onFolderDeleteLoad=FDsScenePropertyToolBar_onFolderDeleteLoad;b.onFolderDeleteExcute=FDsScenePropertyToolBar_onFolderDeleteExcute;b.onFolderDeleteClick=FDsScenePropertyToolBar_onFolderDeleteClick;b.onFolderPropertyClick=FDsScenePropertyToolBar_onFolderPropertyClick;
b.onFolderOpenClick=FDsScenePropertyToolBar_onFolderOpenClick;b.onFolderCloseClick=FDsScenePropertyToolBar_onFolderCloseClick;b.construct=FDsScenePropertyToolBar_construct;b.dispose=FDsScenePropertyToolBar_dispose;return b}function FDsScenePropertyToolBar_onBuilded(b){this.__base.FUiToolBar.onBuilded.call(this,b)}
function FDsScenePropertyToolBar_onFolderCreateClick(b){var d=b=null,f=this._frameSet._catalogContent.focusNode();f&&(b=f.guid(),d=f.label());f=RConsole.find(FUiWindowConsole).find(FDsResourceFolderDialog);f._workspace=this._workspace;f._frameSet=this._frameSet;f._parentGuid=b;f.setNodeParentLabel(d);f.setNodeLabel("");f.switchDataMode(EUiDataMode.Insert);f.showPosition(EUiPosition.Center)}
function FDsScenePropertyToolBar_onFolderDeleteLoad(b){RConsole.find(FUiDesktopConsole).hide();b=this._frameSet._catalogContent;var d=this._activeNodeGuid;d&&b.findByGuid(d).removeSelf();this._activeNodeGuid=null}
function FDsScenePropertyToolBar_onFolderDeleteExcute(b){b.resultCd==EResult.Success&&(b=this._frameSet._catalogContent.focusNode(),RConsole.find(FUiDesktopConsole).showUploading(),this._activeNodeGuid=b._guid,RConsole.find(FDrResourceConsole).doFolderDelete(b._guid).addLoadListener(this,this.onFolderDeleteLoad))}
function FDsScenePropertyToolBar_onFolderDeleteClick(b){if(!this._frameSet._catalogContent.focusNode())return RConsole.find(FUiMessageConsole).showInfo("\u8bf7\u9009\u4e2d\u76ee\u5f55\u8282\u70b9\u540e\uff0c\u518d\u70b9\u51fb\u64cd\u4f5c\u3002");RConsole.find(FUiMessageConsole).showConfirm("\u8bf7\u786e\u8ba4\u662f\u5426\u5220\u9664\u5f53\u524d\u76ee\u5f55\uff1f").addResultListener(this,this.onFolderDeleteExcute)}
function FDsScenePropertyToolBar_onFolderPropertyClick(b){b=this._frameSet._catalogContent.focusNode();if(!b)return RConsole.find(FUiMessageConsole).showInfo("\u8bf7\u9009\u4e2d\u76ee\u5f55\u8282\u70b9\u540e\uff0c\u518d\u70b9\u51fb\u64cd\u4f5c\u3002");var d=null;b._parent&&(d=b._parent.label());var f=RConsole.find(FUiWindowConsole).find(FDsResourceFolderDialog);f._workspace=this._workspace;f._frameSet=this._frameSet;f._nodeGuid=b._guid;f.setNodeParentLabel(d);f.setNodeLabel(b.label());f.switchDataMode(EUiDataMode.Update);
f.showPosition(EUiPosition.Center)}function FDsScenePropertyToolBar_onFolderOpenClick(b){}function FDsScenePropertyToolBar_onFolderCloseClick(b){}function FDsScenePropertyToolBar_construct(){this.__base.FUiToolBar.construct.call(this)}function FDsScenePropertyToolBar_dispose(){this.__base.FUiToolBar.dispose.call(this)}
function FDsSceneWorkspace(b){b=RClass.inherits(this,b,FUiWorkspace);b._frameName="resource.share.scene.Workspace";b._styleToolbarGround=RClass.register(b,new AStyle("_styleToolbarGround","Toolbar_Ground"));b._styleStatusbarGround=RClass.register(b,new AStyle("_styleStatusbarGround","Statusbar_Ground"));b._styleCatalogGround=RClass.register(b,new AStyle("_styleCatalogGround","Catalog_Ground"));b._styleWorkspaceGround=RClass.register(b,new AStyle("_styleWorkspaceGround","Workspace_Ground"));b._stylePropertyGround=
RClass.register(b,new AStyle("_stylePropertyGround","Property_Ground"));b._framesetMain=null;b._framesetBody=null;b._frameToolBar=null;b._frameBody=null;b._frameProperty=null;b._frameCatalog=null;b._frameWorkspace=null;b._frameStatusBar=null;b._propertyFrames=null;b.onBuilded=FDsSceneWorkspace_onBuilded;b.onSceneLoad=FDsSceneWorkspace_onSceneLoad;b.onCatalogSelected=FDsSceneWorkspace_onCatalogSelected;b.construct=FDsSceneWorkspace_construct;b.findPropertyFrame=FDsSceneWorkspace_findPropertyFrame;
b.loadScene=FDsSceneWorkspace_loadScene;b.dispose=FDsSceneWorkspace_dispose;return b}
function FDsSceneWorkspace_onBuilded(b){this.__base.FUiWorkspace.onBuilded.call(this,b);var d=this._frameToolBar=this.searchControl("toolbarFrame");d._hPanel.className=this.styleName("Toolbar_Ground");d=this._frameCatalog=this.searchControl("catalogFrame");d._hPanel.className=this.styleName("Catalog_Ground");d=this._frameWorkspace=this.searchControl("spaceFrame");d._hPanel.className=this.styleName("Workspace_Ground");d=this._frameProperty=this.searchControl("propertyFrame");d._hPanel.className=this.styleName("Property_Ground");
d=this._frameStatusBar=this.searchControl("statusFrame");d._hPanel.className=this.styleName("Statusbar_Ground");d=this._catalogSplitter=this.searchControl("catalogSpliter");d.setAlignCd(EUiAlign.Left);d.setSizeHtml(this._frameCatalog._hPanel);d=this._propertySpliter=this.searchControl("propertySpliter");d.setAlignCd(EUiAlign.Right);d.setSizeHtml(this._frameProperty._hPanel);var f=this._toolbar=RClass.create(FDsSceneMenuBar);f._workspace=this;f.buildDefine(b);this._frameToolBar.push(f);f=this._catalog=
RClass.create(FDsSceneCatalog);f._workspace=this;f.build(b);f.addSelectedListener(this,this.onCatalogSelected);this._frameCatalog.push(f);this._canvasToolbarFrame=this.searchControl("canvasToolbarFrame");f=this._canvasToolbar=RClass.create(FDsSceneCanvasToolBar);f._workspace=this;f.buildDefine(b);this._canvasToolbarFrame.push(f);d=this._canvasFrame=this.searchControl("canvasFrame");f=this._canvas=RClass.create(FDsSceneCanvas);f._workspace=this;f._toolbar=this._canvasToolbar;f.addLoadListener(this,
this.onSceneLoad);f._hParent=d._hPanel;f._hParent.style.backgroundColor="#000000";f.build(b);this._canvasFrame.push(f)}function FDsSceneWorkspace_onSceneLoad(b){b=this._activeScene=b._activeScene;this._catalog.buildScene(b)}
function FDsSceneWorkspace_onCatalogSelected(b,d){for(var f=this._activeScene,h=this._propertyFrames,q=h.count(),z=0;z<q;z++){var A=h.value(z);A.hide()}if(RClass.isClass(b,FE3dScene))A=this.findPropertyFrame(EDsFrame.SceneSpacePropertyFrame),A.show(),A.loadObject(f,b);else if(RClass.isClass(b,FG3dTechnique))A=this.findPropertyFrame(EDsFrame.SceneTechniquePropertyFrame),A.show(),A.loadObject(f,b);else if(RClass.isClass(b,FE3dRegion))A=this.findPropertyFrame(EDsFrame.SceneRegionPropertyFrame),A.show(),
A.loadObject(f,b);else if(RClass.isClass(b,FE3dCamera))A=this.findPropertyFrame(EDsFrame.SceneCameraPropertyFrame),A.show(),A.loadObject(f,b);else if(RClass.isClass(b,FG3dDirectionalLight))A=this.findPropertyFrame(EDsFrame.SceneLightPropertyFrame),A.show(),A.loadObject(f,b);else if("layers"==b)d&&this._canvas.selectLayers(b);else if(RClass.isClass(b,FE3dSceneLayer))d&&this._canvas.selectLayer(b),A=this.findPropertyFrame(EDsFrame.SceneLayerPropertyFrame),A.show(),A.loadObject(f,b);else if(RClass.isClass(b,
FE3dSceneDisplay))d&&this._canvas.selectDisplay(b),A=this.findPropertyFrame(EDsFrame.SceneDisplayPropertyFrame),A.show(),A.loadObject(f,b);else if(RClass.isClass(b,FE3dSceneMaterial))d&&this._canvas.selectMaterial(b),A=this.findPropertyFrame(EDsFrame.SceneMaterialPropertyFrame),A.show(),A.loadObject(f,b);else if(RClass.isClass(b,FE3rAnimation))A=this.findPropertyFrame(EDsFrame.SceneAnimationPropertyFrame),A.show(),A.loadObject(f,b);else if(RClass.isClass(b,FE3dRenderable))d&&this._canvas.selectRenderable(b),
A=this.findPropertyFrame(EDsFrame.SceneRenderablePropertyFrame),A.show(),A.loadObject(f,b);else throw new TError("Unknown select object type. (value={1})",b);}function FDsSceneWorkspace_construct(){this.__base.FUiWorkspace.construct.call(this);this._propertyFrames=new TDictionary}
function FDsSceneWorkspace_findPropertyFrame(b){var d=this._propertyFrames.get(b);d||(d=RConsole.find(FUiFrameConsole).get(this,b,this._frameProperty._hContainer),d._workspace=this,this._propertyFrames.set(b,d));return d}function FDsSceneWorkspace_loadScene(b){this._sceneCode=b;this._canvas.loadScene(b)}function FDsSceneWorkspace_dispose(){this.__base.FUiWorkspace.dispose.call(this);this._propertyFrames.dispose();this._propertyFrames=null}
function FDsPrivateTabBar(b){b=RClass.inherits(this,b,FUiTabBar);b._frameName="resource.private.TabBar";b._resourceTypeCd="private";b._controlPrivateButton=null;b._controlTeamButton=null;b._controlShareButton=null;b.onBuilded=FDsPrivateTabBar_onBuilded;b.onButtonClick=FDsPrivateTabBar_onButtonClick;b.construct=FDsPrivateTabBar_construct;b.dispose=FDsPrivateTabBar_dispose;return b}
function FDsPrivateTabBar_onBuilded(b){this.__base.FUiTabBar.onBuilded.call(this,b);this._controlProjectButton.addClickListener(this,this.onButtonClick);this._controlResourceButton.addClickListener(this,this.onButtonClick);this._controlTeamButton.addClickListener(this,this.onButtonClick);this._controlPublishButton.addClickListener(this,this.onButtonClick)}
function FDsPrivateTabBar_onButtonClick(b){b=b.sender.name();"solution"==b?this._workspace.selectFrameSet(EDsFrameSet.PrivateSolutionFrameSet):"project"==b?this._workspace.selectFrameSet(EDsFrameSet.PrivateProjectFrameSet):"resource"==b?this._workspace.selectFrameSet(EDsFrameSet.PrivateResourceFrameSet):alert("\u529f\u80fd\u672a\u5f00\u542f\uff0c\u8bf7\u4ee5\u540e\u5173\u6ce8\u3002")}function FDsPrivateTabBar_construct(){this.__base.FUiTabBar.construct.call(this)}
function FDsPrivateTabBar_dispose(){this.__base.FUiTabBar.dispose.call(this)}
function FDsPrivateWorkspace(b){b=RClass.inherits(this,b,FUiWorkspace,MUiStorage);b._frameName="resource.private.Workspace";b._storageCode=b._frameName;b._styleMenuBarGround=RClass.register(b,new AStyle("_styleMenuBarGround","MenuBar_Ground"));b._styleBodyGround=RClass.register(b,new AStyle("_styleBodyGround","Body_Ground"));b._styleStatusBarGround=RClass.register(b,new AStyle("_styleStatusBarGround","StatusBar_Ground"));b._activeFrameSetCode=null;b._activeProjectGuid=null;b._frameToolBar=null;b._frameStatusBar=
null;b._activeFrameSet=null;b._frameSets=null;b.onBuilded=FDsPrivateWorkspace_onBuilded;b.construct=FDsPrivateWorkspace_construct;b.selectFrameSet=FDsPrivateWorkspace_selectFrameSet;b.load=FDsPrivateWorkspace_load;b.dispose=FDsPrivateWorkspace_dispose;return b}
function FDsPrivateWorkspace_onBuilded(b){this.__base.FUiWorkspace.onBuilded.call(this,b);this._frameMenuBar._hPanel.className=this.styleName("MenuBar_Ground");this._frameBody._hPanel.className=this.styleName("Body_Ground");this._frameStatusBar._hPanel.className=this.styleName("StatusBar_Ground");var d=RBuilder.createTable(b);d.width="100%";var f=RBuilder.appendTableRow(d);this._hMenuPanel=RBuilder.appendTableCell(f);var h=this._tabBar=RClass.create(FDsPrivateTabBar);h._workspace=this;h.buildDefine(b);
b=RBuilder.appendTableCell(f);b.width="100px";b.align="right";b.vAlign="bottom";b.appendChild(h._hPanel);this._frameMenuBar._hPanel.appendChild(d)}function FDsPrivateWorkspace_construct(){this.__base.FUiWorkspace.construct.call(this);this._frameSets=new TDictionary}
function FDsPrivateWorkspace_selectFrameSet(b,d){var f=this._frameSets.get(b);if(!f){if(b==EDsFrameSet.PrivateSolutionFrameSet){var h=RClass.create(FDsSolutionMenuBar);h._workspace=this;h.buildDefine(this._hPanel);f=RConsole.find(FUiFrameConsole).findByClass(this,FDsSolutionFrameSet);f._workspace=this;f._menuBar=h;h._frameSet=f}else if(b==EDsFrameSet.PrivateProjectFrameSet)h=RClass.create(FDsPrivateProjectMenuBar),h._workspace=this,h.buildDefine(this._hPanel),f=RConsole.find(FUiFrameConsole).findByClass(this,
FDsPrivateProjectFrameSet),f._workspace=this,f._menuBar=h,h._frameSet=f;else if(b==EDsFrameSet.PrivateResourceFrameSet)h=RClass.create(FDsPrivateResourceMenuBar),h._workspace=this,h.buildDefine(this._hPanel),f=RConsole.find(FUiFrameConsole).findByClass(this,FDsPrivateResourceFrameSet),f._workspace=this,f._menuBar=h,h._frameSet=f;else if(b==EDsFrameSet.PrivateBitmapFrameSet)h=RClass.create(FDsPrivateBitmapMenuBar),h._workspace=this,h.buildDefine(this._hPanel),f=RConsole.find(FUiFrameConsole).findByClass(this,
FDsPrivateBitmapFrameSet),f._workspace=this,f._menuBar=h,h._frameSet=f;else if(b==EDsFrameSet.PrivateMaterialFrameSet)h=RClass.create(FDsPrivateMaterialMenuBar),h._workspace=this,h.buildDefine(this._hPanel),f=RConsole.find(FUiFrameConsole).findByClass(this,FDsPrivateMaterialFrameSet),f._workspace=this,f._menuBar=h,h._frameSet=f;else if(b==EDsFrameSet.PrivateModelFrameSet)h=RClass.create(FDsPrivateModelMenuBar),h._workspace=this,h.buildDefine(this._hPanel),f=RConsole.find(FUiFrameConsole).findByClass(this,
FDsPrivateModelFrameSet),f._workspace=this,f._menuBar=h,h._frameSet=f;else if(b==EDsFrameSet.PrivateTemplateFrameSet)h=RClass.create(FDsPrivateTemplateMenuBar),h._workspace=this,h.buildDefine(this._hPanel),f=RConsole.find(FUiFrameConsole).findByClass(this,FDsPrivateTemplateFrameSet),f._workspace=this,f._menuBar=h,h._frameSet=f;else if(b==EDsFrameSet.PrivateSceneFrameSet)h=RClass.create(FDsPrivateSceneMenuBar),h._workspace=this,h.buildDefine(this._hPanel),f=RConsole.find(FUiFrameConsole).findByClass(this,
FDsPrivateSceneFrameSet),f._workspace=this,f._menuBar=h,h._frameSet=f;else throw new TError("Unknown frameset. (name={1})",b);this._frameSets.set(b,f)}h=this._activeFrameSet;h!=f&&(h&&(this._hMenuPanel.removeChild(h._menuBar._hPanel),this._frameBody.remove(h)),this._hMenuPanel.appendChild(f._menuBar._hPanel),this._frameBody.push(f),f.psResize());this._activeFrameSet=f;switch(b){case EDsFrameSet.PrivateSolutionFrameSet:f.load();break;case EDsFrameSet.PrivateProjectFrameSet:f.loadByGuid(d);break;case EDsFrameSet.PrivateResourceFrameSet:f.load();
break;case EDsFrameSet.PrivateBitmapFrameSet:f.loadByGuid(d);break;case EDsFrameSet.PrivateMaterialFrameSet:f.loadByGuid(d);break;case EDsFrameSet.PrivateModelFrameSet:f.loadByGuid(d);break;case EDsFrameSet.PrivateTemplateFrameSet:f.loadByGuid(d);break;case EDsFrameSet.PrivateSceneFrameSet:f.loadByGuid(d);break;default:throw new TError("Unknown frameset. (name={1})",b);}this.storageSet("frameset_code",b);this.storageSet("frameset_guid",d);this.storageUpdate();return f}
function FDsPrivateWorkspace_load(){var b=this._activeFrameSetCode=this.storageGet("frameset_code",EDsFrameSet.SolutionFrameSet),d=this._activeFrameSetGuid=this.storageGet("frameset_guid"),f=null;b==EDsFrameSet.SolutionFrameSet?(f=this._tabBar.findControl("solution"),f.doClick()):b==EDsFrameSet.PrivateProjectFrameSet?(f=this._tabBar.findControl("solution"),this._tabBar.select(f),this.selectFrameSet(b,d)):b==EDsFrameSet.PrivateResourceFrameSet?(f=this._tabBar.findControl("resource"),f.doClick()):b==
EDsFrameSet.PrivateBitmapFrameSet?(f=this._tabBar.findControl("resource"),this._tabBar.select(f),this.selectFrameSet(b,d)):b==EDsFrameSet.PrivateMaterialFrameSet?(f=this._tabBar.findControl("resource"),this._tabBar.select(f),this.selectFrameSet(b,d)):b==EDsFrameSet.PrivateModelFrameSet?(f=this._tabBar.findControl("resource"),this._tabBar.select(f),this.selectFrameSet(b,d)):b==EDsFrameSet.PrivateTemplateFrameSet?(f=this._tabBar.findControl("resource"),this._tabBar.select(f),this.selectFrameSet(b,d)):
b==EDsFrameSet.PrivateSceneFrameSet?(f=this._tabBar.findControl("resource"),this._tabBar.select(f),this.selectFrameSet(b,d)):(f=this._tabBar.findControl("solution"),f.doClick())}function FDsPrivateWorkspace_dispose(){this._frameSets=RObject.dispose(this._frameSets);this.__base.FUiWorkspace.dispose.call(this)}function FDsPrivateProjectFrameSet(b){b=RClass.inherits(this,b,FDsProjectFrameSet);b._frameName="resource.private.project.FrameSet";b.onBuilded=FDsPrivateProjectFrameSet_onBuilded;return b}
function FDsPrivateProjectFrameSet_onBuilded(b){this.__base.FDsProjectFrameSet.onBuilded.call(this,b);var d=this._sceneListToolbar=RClass.create(FDsProjectSceneListToolBar);d._frameSet=this;d.buildDefine(b);this._frameSceneListToolBar.push(d);d=this._sceneListContent=RClass.create(FDsProjectSceneListContent);d._frameSet=this;d.build(b);this._frameSceneListContent.push(d);d=this._sceneCatalogToolbar=RClass.create(FDsProjectSceneCatalogToolBar);d._frameSet=this;d.buildDefine(b);this._frameSceneCatalogToolBar.push(d);
d=this._sceneCatalogContent=RClass.create(FDsProjectSceneCatalogContent);d._frameSet=this;d.build(b);this._frameSceneCatalogContent.push(d);d=this._canvasSpaceToolbar=RClass.create(FDsProjectCanvasSpaceToolBar);d._frameSet=this;d.buildDefine(b);this._frameCanvasSpaceToolBar.push(d);d=this._canvasPreviewToolbar=RClass.create(FDsProjectCanvasPreviewToolBar);d._frameSet=this;d.buildDefine(b);this._frameCanvasPreviewToolBar.push(d);d=this._propertyToolbar=RClass.create(FDsProjectPropertyToolBar);d._frameSet=
this;d.buildDefine(b);this._framePropertyAttributeToolBar.push(d)}function FDsPrivateProjectMenuBar(b){b=RClass.inherits(this,b,FDsProjectMenuBar);b._frameName="resource.private.project.MenuBar";b.onBuilded=FDsPrivateProjectMenuBar_onBuilded;return b}function FDsPrivateProjectMenuBar_onBuilded(b){this.__base.FDsProjectMenuBar.onBuilded.call(this,b)}
function FDsPrivateResourceCatalogToolBar(b){b=RClass.inherits(this,b,FDsResourceCatalogToolBar);b._frameName="resource.private.resource.CatalogToolBar";return b}function FDsPrivateResourceFrameSet(b){b=RClass.inherits(this,b,FDsResourceFrameSet);b._frameName="resource.share.resource.FrameSet";b.onBuilded=FDsPrivateResourceFrameSet_onBuilded;b.onCatalogSelected=FDsPrivateResourceFrameSet_onCatalogSelected;return b}
function FDsPrivateResourceFrameSet_onBuilded(b){this.__base.FDsResourceFrameSet.onBuilded.call(this,b);this._frameCatalogToolBar._hPanel.className=this.styleName("Toolbar_Ground");this._frameCatalogContent._hPanel.className=this.styleName("Catalog_Content");this._frameListToolBar._hPanel.className=this.styleName("Toolbar_Ground");this._frameListContent._hPanel.className=this.styleName("List_Content");var d=this._catalogSplitter=this.searchControl("catalogSpliter");d.setAlignCd(EUiAlign.Left);d.setSizeHtml(this._frameCatalog._hPanel);
d=this._catalogToolbar=RClass.create(FDsPrivateResourceCatalogToolBar);d._workspace=this._workspace;d._frameSet=this;d.buildDefine(b);this._frameCatalogToolBar.push(d);d=this._catalogContent=RClass.create(FDsResourceCatalogContent);d._workspace=this._workspace;d._frameSet=this;d.build(b);this._frameCatalogContent.push(d);d=this._listToolBar=RClass.create(FDsPrivateResourceListToolBar);d._workspace=this._workspace;d._frameSet=this;d.buildDefine(b);this._frameListToolBar.push(d);d=this._listContent=
RClass.create(FDsResourceListContent);d._workspace=this._workspace;d._frameSet=this;d.build(b);this._frameListContent.push(d)}
function FDsPrivateResourceFrameSet_onCatalogSelected(b,d){for(var f=this._activeSpace,h=this._propertyFrames,q=h.count(),z=0;z<q;z++){var A=h.value(z);A.hide()}if(RClass.isClass(b,FE3dStage))A=this.findPropertyFrame(EDsFrame.MeshSpacePropertyFrame),A.show(),A.loadObject(f,f);else if(RClass.isClass(b,FG3dTechnique))A=this.findPropertyFrame(EDsFrame.MeshTechniquePropertyFrame),A.show(),A.loadObject(f,b);else if(RClass.isClass(b,FE3dRegion))A=this.findPropertyFrame(EDsFrame.MeshRegionPropertyFrame),
A.show(),A.loadObject(f,b);else if(RClass.isClass(b,FE3dCamera))A=this.findPropertyFrame(EDsFrame.MeshCameraPropertyFrame),A.show(),A.loadObject(f,b);else if(RClass.isClass(b,FG3dDirectionalLight))A=this.findPropertyFrame(EDsFrame.MeshLightPropertyFrame),A.show(),A.loadObject(f,b);else if(RClass.isClass(b,FE3dMeshDisplay))A=this.findPropertyFrame(EDsFrame.MeshDisplayPropertyFrame),A.show(),A.loadObject(f,b);else if(RClass.isClass(b,FG3dMaterial))A=this.findPropertyFrame(EDsFrame.MeshMaterialPropertyFrame),
A.show(),A.loadObject(f,b);else if(RClass.isClass(b,FE3dMeshRenderable))A=this.findPropertyFrame(EDsFrame.MeshRenderablePropertyFrame),A.show(),A.loadObject(f,b);else throw new TError("Unknown select object type. (value={1})",b);}function FDsPrivateResourceListToolBar(b){b=RClass.inherits(this,b,FDsResourceListToolBar);b._frameName="resource.private.resource.ListToolBar";b._storageCode=b._frameName;return b}
function FDsPrivateResourceMenuBar(b){b=RClass.inherits(this,b,FDsResourceMenuBar);b._frameName="resource.private.resource.MenuBar";b._controlRefresh=null;b.onBuilded=FDsPrivateResourceMenuBar_onBuilded;b.onRefreshClick=FDsPrivateResourceMenuBar_onRefreshClick;return b}
function FDsPrivateResourceMenuBar_onBuilded(b){this.__base.FDsResourceMenuBar.onBuilded.call(this,b);this._controlImportPicture.addClickListener(this,this.onImportPictureClick);this._controlImportModel.addClickListener(this,this.onImportModelClick);this._controlCreateMaterial.addClickListener(this,this.onCreateMaterialClick);this._controlCreateTemplate.addClickListener(this,this.onCreateTemplateClick);this._controlCreateScene.addClickListener(this,this.onCreateSceneClick);this._controlDelete.addClickListener(this,
this.onDeleteClick);this._controlShareOpen.addClickListener(this,this.onShareClick);this._controlShareClose.addClickListener(this,this.onShareClick)}function FDsPrivateResourceMenuBar_onRefreshClick(b){}function FDsPrivateBitmapCanvasToolBar(b){b=RClass.inherits(this,b,FDsBitmapCanvasToolBar);b._frameName="resource.private.bitmap.CanvasToolBar";return b}
function FDsPrivateBitmapFrameSet(b){b=RClass.inherits(this,b,FDsBitmapFrameSet);b._frameName="resource.private.bitmap.FrameSet";b.onBuilded=FDsPrivateBitmapFrameSet_onBuilded;return b}
function FDsPrivateBitmapFrameSet_onBuilded(b){this.__base.FDsBitmapFrameSet.onBuilded.call(this,b);var d=this._canvasToolBar=RClass.create(FDsPrivateBitmapCanvasToolBar);d._frameSet=this;d.buildDefine(b);this._frameCanvasToolBar.push(d);d=this._canvasContent=RClass.create(FDsBitmapCanvasContent);d._frameSet=this;d._hParent=this._frameCanvasContent._hPanel;d._hParent.style.backgroundColor="#333333";d._hParent.style.scroll="auto";d.build(b);this._frameCanvasContent.push(d);d=this._propertyToolBar=
RClass.create(FDsBitmapPropertyToolBar);d._frameSet=this;d.buildDefine(b);this._framePropertyToolBar.push(d);b=this.findPropertyFrame(EDsFrame.BitmapPropertyFrame);this._framePropertyContent.push(b)}function FDsPrivateBitmapMenuBar(b){b=RClass.inherits(this,b,FDsBitmapMenuBar);b._frameName="resource.private.bitmap.MenuBar";b.onBuilded=FDsPrivateBitmapMenuBar_onBuilded;b.onBackClick=FDsPrivateBitmapMenuBar_onBackClick;return b}
function FDsPrivateBitmapMenuBar_onBuilded(b){this.__base.FDsBitmapMenuBar.onBuilded.call(this,b);this._controlBack.addClickListener(this,this.onBackClick);this._controlSave.addClickListener(this,this.onSaveClick);this._controlImport.addClickListener(this,this.onImportClick)}function FDsPrivateBitmapMenuBar_onBackClick(b){this._frameSet._workspace.selectFrameSet(EDsFrameSet.PrivateResourceFrameSet)}
function FDsPrivateMaterialCanvasToolBar(b){b=RClass.inherits(this,b,FDsMaterialCanvasToolBar);b._frameName="resource.private.material.CanvasToolBar";return b}function FDsPrivateMaterialCatalogToolBar(b){b=RClass.inherits(this,b,FDsMaterialCatalogToolBar);b._frameName="resource.private.material.CatalogToolBar";return b}
function FDsPrivateMaterialFrameSet(b){b=RClass.inherits(this,b,FDsMaterialFrameSet);b._frameName="resource.private.material.FrameSet";b.onBuilded=FDsPrivateMaterialFrameSet_onBuilded;return b}
function FDsPrivateMaterialFrameSet_onBuilded(b){this.__base.FDsMaterialFrameSet.onBuilded.call(this,b);var d=this._catalogToolBar=RClass.create(FDsPrivateMaterialCatalogToolBar);d._frameSet=this;d.buildDefine(b);this._frameCatalogToolBar.push(d);d=this._catalogContent=RClass.create(FDsMaterialCatalogContent);d._frameSet=this;d.build(b);this._frameCatalogContent.push(d);d=this._canvasToolBar=RClass.create(FDsPrivateMaterialCanvasToolBar);d._frameSet=this;d.buildDefine(b);this._frameCanvasToolBar.push(d);
d=this._propertyToolBar=RClass.create(FDsMaterialPropertyToolBar);d._frameSet=this;d.buildDefine(b);this._framePropertyToolBar.push(d)}function FDsPrivateMaterialMenuBar(b){b=RClass.inherits(this,b,FDsMaterialMenuBar);b._frameName="resource.private.material.MenuBar";return b}function FDsPrivateModelCanvasToolBar(b){b=RClass.inherits(this,b,FDsModelCanvasToolBar);b._frameName="resource.private.model.CanvasToolBar";return b}
function FDsPrivateModelCatalogToolBar(b){b=RClass.inherits(this,b,FDsModelCatalogToolBar);b._frameName="resource.private.model.CatalogToolBar";return b}function FDsPrivateModelFrameSet(b){b=RClass.inherits(this,b,FDsModelFrameSet);b._frameName="resource.private.model.FrameSet";b.onBuilded=FDsPrivateModelFrameSet_onBuilded;return b}
function FDsPrivateModelFrameSet_onBuilded(b){this.__base.FDsModelFrameSet.onBuilded.call(this,b);var d=this._catalogToolBar=RClass.create(FDsPrivateModelCatalogToolBar);d._frameSet=this;d.buildDefine(b);this._frameCatalogToolBar.push(d);d=this._catalogContent=RClass.create(FDsModelCatalogContent);d._frameSet=this;d.build(b);d.addSelectedListener(this,this.onCatalogSelected);this._frameCatalogContent.push(d);d=this._canvasToolBar=RClass.create(FDsPrivateModelCanvasToolBar);d._frameSet=this;d.buildDefine(b);
this._frameCanvasToolBar.push(d);d=this._canvasContent=RClass.create(FDsModelCanvasContent);d._frameSet=this;d._toolbar=this._canvasToolbar;d._hParent=this._frameCanvasContent._hPanel;d._hParent.style.backgroundColor="#333333";d._hParent.style.scroll="auto";d.addLoadListener(this,this.onDataLoaded);d.build(b);this._frameCanvasContent.push(d)}
function FDsPrivateModelMenuBar(b){b=RClass.inherits(this,b,FDsModelMenuBar);b._frameName="resource.private.model.MenuBar";b.onBuilded=FDsPrivateModelMenuBar_onBuilded;return b}function FDsPrivateModelMenuBar_onBuilded(b){this.__base.FDsModelMenuBar.onBuilded.call(this,b);this._controlSaveButton.addClickListener(this,this.onSaveClick);this._controlCaptureButton.addClickListener(this,this.onCaptureClick)}
function FDsPrivateTemplateCanvasToolBar(b){b=RClass.inherits(this,b,FDsTemplateCanvasToolBar);b._frameName="resource.private.template.CanvasToolBar";return b}function FDsPrivateTemplateCatalogToolBar(b){b=RClass.inherits(this,b,FDsTemplateCatalogToolBar);b._frameName="resource.private.template.CatalogToolBar";return b}
function FDsPrivateTemplateFrameSet(b){b=RClass.inherits(this,b,FDsTemplateFrameSet);b._frameName="resource.private.template.FrameSet";b.onBuilded=FDsPrivateTemplateFrameSet_onBuilded;b.onCatalogSelected=FDsPrivateTemplateFrameSet_onCatalogSelected;return b}
function FDsPrivateTemplateFrameSet_onBuilded(b){this.__base.FDsTemplateFrameSet.onBuilded.call(this,b);var d=this._catalogToolBar=RClass.create(FDsPrivateTemplateCatalogToolBar);d._frameSet=this;d.buildDefine(b);this._frameCatalogToolBar.push(d);d=this._catalogContent=RClass.create(FDsTemplateCatalogContent);d._frameSet=this;d.build(b);d.addSelectedListener(this,this.onCatalogSelected);this._frameCatalogContent.push(d);d=this._canvasToolBar=RClass.create(FDsPrivateTemplateCanvasToolBar);d._frameSet=
this;d.buildDefine(b);this._frameCanvasToolBar.push(d);d=this._canvasContent=RClass.create(FDsTemplateCanvasContent);d._frameSet=this;d._toolbar=this._canvasToolbar;d._hParent=this._frameCanvasContent._hPanel;d._hParent.style.scroll="auto";d.addLoadListener(this,this.onDataLoaded);d.build(b);this._frameCanvasContent.push(d)}
function FDsPrivateTemplateFrameSet_onCatalogSelected(b,d){var f=this._activeSpace;if(f)if(this.hidePropertyFrames(),RClass.isClass(b,FE3dSpace)){var h=this.findPropertyFrame(EDsFrame.CommonSpacePropertyFrame);h.show();h.loadObject(f,b)}else if(RClass.isClass(b,FG3dTechnique))h=this.findPropertyFrame(EDsFrame.CommonTechniquePropertyFrame),h.show(),h.loadObject(f,b);else if(RClass.isClass(b,FE3dRegion))h=this.findPropertyFrame(EDsFrame.CommonRegionPropertyFrame),h.show(),h.loadObject(f,b);else if(RClass.isClass(b,
FE3dCamera))h=this.findPropertyFrame(EDsFrame.CommonCameraPropertyFrame),h.show(),h.loadObject(f,b);else if(RClass.isClass(b,FG3dDirectionalLight))h=this.findPropertyFrame(EDsFrame.CommonLightPropertyFrame),h.show(),h.loadObject(f,b);else if(RClass.isClass(b,FE3dTemplateDisplay))h=this.findPropertyFrame(EDsFrame.CommonDisplayPropertyFrame),h.show(),h.loadObject(f,b);else if(RClass.isClass(b,FG3dMaterial))h=this.findPropertyFrame(EDsFrame.CommonMaterialPropertyFrame),h.show(),h.loadObject(f,b);else if(RClass.isClass(b,
FE3dRenderable))h=this.findPropertyFrame(EDsFrame.CommonRenderablePropertyFrame),h.show(),h.loadObject(f,b);else throw new TError("Unknown select object type. (select={1})",b);}function FDsPrivateTemplateMenuBar(b){b=RClass.inherits(this,b,FDsTemplateMenuBar);b._frameName="resource.private.template.MenuBar";b.onBuilded=FDsPrivateTemplateMenuBar_onBuilded;return b}
function FDsPrivateTemplateMenuBar_onBuilded(b){this.__base.FDsTemplateMenuBar.onBuilded.call(this,b);this._controlSave.addClickListener(this,this.onSaveClick);this._controlCapture.addClickListener(this,this.onCaptureClick);this._controlSelectMaterial.addClickListener(this,this.onSelectMaterialClick);this._controlCreateDisplay.addClickListener(this,this.onCreateDisplayClick);this._controlDelete.addClickListener(this,this.onDeleteClick)}
function FDsPrivateSceneCanvasToolBar(b){b=RClass.inherits(this,b,FDsSceneCanvasToolBar);b._frameName="resource.private.scene.CanvasToolBar";return b}function FDsPrivateSceneCatalogToolBar(b){b=RClass.inherits(this,b,FDsSceneCatalogToolBar);b._frameName="resource.private.scene.CatalogToolBar";return b}function FDsPrivateSceneFrameSet(b){b=RClass.inherits(this,b,FDsSceneFrameSet);b._frameName="resource.private.scene.FrameSet";b.onBuilded=FDsPrivateSceneFrameSet_onBuilded;return b}
function FDsPrivateSceneFrameSet_onBuilded(b){this.__base.FDsSceneFrameSet.onBuilded.call(this,b);var d=this._catalogToolbar=RClass.create(FDsPrivateSceneCatalogToolBar);d._frameSet=this;d.buildDefine(b);this._frameCatalogToolBar.push(d);d=this._catalogContent=RClass.create(FDsSceneCatalogContent);d._frameSet=this;d.build(b);d.addSelectedListener(this,this.onCatalogSelected);this._frameCatalogContent.push(d);d=this._canvasToolBar=RClass.create(FDsPrivateSceneCanvasToolBar);d._frameSet=this;d.buildDefine(b);
this._frameCanvasToolBar.push(d);d=this._canvasContent=RClass.create(FDsSceneCanvasContent);d._frameSet=this;d._toolbar=this._canvasToolbar;d._hParent=this._frameCanvasContent._hPanel;d._hParent.style.backgroundColor="#333333";d._hParent.style.scroll="auto";d.addLoadListener(this,this.onDataLoaded);d.build(b);this._frameCanvasContent.push(d);d=this._propertyToolbar=RClass.create(FDsScenePropertyToolBar);d._frameSet=this;d.buildDefine(b);this._framePropertyToolBar.push(d)}
function FDsPrivateSceneMenuBar(b){b=RClass.inherits(this,b,FDsSceneMenuBar);b._frameName="resource.private.scene.MenuBar";b.onBuilded=FDsPrivateSceneMenuBar_onBuilded;return b}
function FDsPrivateSceneMenuBar_onBuilded(b){this.__base.FDsSceneMenuBar.onBuilded.call(this,b);this._controlSave.addClickListener(this,this.onSaveClick);this._controlCapture.addClickListener(this,this.onCaptureClick);this._controlCreateLayer.addClickListener(this,this.onCreateLayerClick);this._controlImportTemplate.addClickListener(this,this.onImportTemplateClick);this._controlExecute.addClickListener(this,this.onExecuteClick)}
function FDsShareTabBar(b){b=RClass.inherits(this,b,FUiTabBar);b._frameName="resource.share.TabBar";b._resourceTypeCd="private";b._controlPrivateButton=null;b._controlTeamButton=null;b._controlShareButton=null;b.onBuilded=FDsShareTabBar_onBuilded;b.onButtonClick=FDsShareTabBar_onButtonClick;b.construct=FDsShareTabBar_construct;b.dispose=FDsShareTabBar_dispose;return b}
function FDsShareTabBar_onBuilded(b){this.__base.FUiTabBar.onBuilded.call(this,b);this._controlResource.addClickListener(this,this.onButtonClick)}function FDsShareTabBar_onButtonClick(b){"resource"==b.sender.name()?this._workspace.selectFrameSet(EDsFrameSet.ShareResourceFrameSet):alert("\u529f\u80fd\u672a\u5f00\u542f\uff0c\u8bf7\u4ee5\u540e\u5173\u6ce8\u3002")}function FDsShareTabBar_construct(){this.__base.FUiTabBar.construct.call(this)}
function FDsShareTabBar_dispose(){this.__base.FUiTabBar.dispose.call(this)}
function FDsShareWorkspace(b){b=RClass.inherits(this,b,FUiWorkspace,MUiStorage);b._frameName="resource.share.Workspace";b._storageCode=b._frameName;b._styleMenubarGround=RClass.register(b,new AStyle("_styleMenubarGround","Menubar_Ground"));b._styleBodyGround=RClass.register(b,new AStyle("_styleBodyGround","Body_Ground"));b._styleStatusbarGround=RClass.register(b,new AStyle("_styleStatusbarGround","Statusbar_Ground"));b._activeFrameSetCode=null;b._activeProjectGuid=null;b._frameToolBar=null;b._frameStatusBar=
null;b._activeFrameSet=null;b._frameSets=null;b.onBuilded=FDsShareWorkspace_onBuilded;b.construct=FDsShareWorkspace_construct;b.selectFrameSet=FDsShareWorkspace_selectFrameSet;b.load=FDsShareWorkspace_load;b.dispose=FDsShareWorkspace_dispose;return b}
function FDsShareWorkspace_onBuilded(b){this.__base.FUiWorkspace.onBuilded.call(this,b);this._frameMenuBar._hPanel.className=this.styleName("Menubar_Ground");this._frameBody._hPanel.className=this.styleName("Body_Ground");this._frameStatusBar._hPanel.className=this.styleName("Statusbar_Ground");var d=RBuilder.createTable(b);d.width="100%";var f=RBuilder.appendTableRow(d);this._hMenuPanel=RBuilder.appendTableCell(f);var h=this._tabBar=RClass.create(FDsShareTabBar);h._workspace=this;h.buildDefine(b);
b=RBuilder.appendTableCell(f);b.width="100px";b.align="right";b.vAlign="bottom";b.appendChild(h._hPanel);this._frameMenuBar._hPanel.appendChild(d)}function FDsShareWorkspace_construct(){this.__base.FUiWorkspace.construct.call(this);this._frameSets=new TDictionary}
function FDsShareWorkspace_selectFrameSet(b,d){var f=this._frameSets.get(b);if(!f){if(b==EDsFrameSet.ShareResourceFrameSet){var h=RClass.create(FDsShareResourceMenuBar);h._workspace=this;h.buildDefine(this._hPanel);f=RConsole.find(FUiFrameConsole).findByClass(this,FDsShareResourceFrameSet);f._workspace=this;f._menuBar=h;h._frameSet=f}else if(b==EDsFrameSet.ShareBitmapFrameSet)h=RClass.create(FDsShareBitmapMenuBar),h._workspace=this,h.buildDefine(this._hPanel),f=RConsole.find(FUiFrameConsole).findByClass(this,
FDsShareBitmapFrameSet),f._workspace=this,f._menuBar=h,h._frameSet=f;else if(b==EDsFrameSet.ShareMaterialFrameSet)h=RClass.create(FDsShareMaterialMenuBar),h._workspace=this,h.buildDefine(this._hPanel),f=RConsole.find(FUiFrameConsole).findByClass(this,FDsShareMaterialFrameSet),f._workspace=this,f._menuBar=h,h._frameSet=f;else if(b==EDsFrameSet.ShareModelFrameSet)h=RClass.create(FDsShareModelMenuBar),h._workspace=this,h.buildDefine(this._hPanel),f=RConsole.find(FUiFrameConsole).findByClass(this,FDsShareModelFrameSet),
f._workspace=this,f._menuBar=h,h._frameSet=f;else if(b==EDsFrameSet.ShareTemplateFrameSet)h=RClass.create(FDsShareTemplateMenuBar),h._workspace=this,h.buildDefine(this._hPanel),f=RConsole.find(FUiFrameConsole).findByClass(this,FDsShareTemplateFrameSet),f._workspace=this,f._menuBar=h,h._frameSet=f;else if(b==EDsFrameSet.ShareSceneFrameSet)h=RClass.create(FDsShareSceneMenuBar),h._workspace=this,h.buildDefine(this._hPanel),f=RConsole.find(FUiFrameConsole).findByClass(this,FDsShareSceneFrameSet),f._workspace=
this,f._menuBar=h,h._frameSet=f;else throw new TError("Unknown frameset. (name={1})",b);this._frameSets.set(b,f)}h=this._activeFrameSet;h!=f&&(h&&(this._hMenuPanel.removeChild(h._menuBar._hPanel),this._frameBody.remove(h)),this._hMenuPanel.appendChild(f._menuBar._hPanel),this._frameBody.push(f),f.psResize());this._activeFrameSet=f;switch(b){case EDsFrameSet.ShareResourceFrameSet:f.load();break;case EDsFrameSet.ShareBitmapFrameSet:case EDsFrameSet.ShareMaterialFrameSet:case EDsFrameSet.ShareModelFrameSet:case EDsFrameSet.ShareTemplateFrameSet:case EDsFrameSet.ShareSceneFrameSet:f.loadByGuid(d);
break;default:throw new TError("Unknown frameset. (name={1})",b);}this.storageSet("frameset_code",b);this.storageSet("frameset_guid",d);this.storageUpdate();return f}function FDsShareWorkspace_load(){this._activeFrameSetCode=this.storageGet("frameset_code",EDsFrameSet.ShareResourceFrameSet);this._activeFrameSetGuid=this.storageGet("frameset_guid");this._tabBar.findControl("resource").doClick()}
function FDsShareWorkspace_dispose(){this._frameSets=RObject.dispose(this._frameSets);this.__base.FUiWorkspace.dispose.call(this)}
function FDsShareResourceCatalogContent(b){b=RClass.inherits(this,b,FUiDataTreeView,MListenerSelected);b._activeSpace=null;b._materials=null;b.onBuild=FDsShareResourceCatalogContent_onBuild;b.onLoadDisplay=FDsShareResourceCatalogContent_onLoadDisplay;b.onNodeClick=FDsShareResourceCatalogContent_onNodeClick;b.onNodeViewClick=FDsShareResourceCatalogContent_onNodeViewClick;b.onNodeViewDoubleClick=FDsShareResourceCatalogContent_onNodeViewDoubleClick;b.lsnsSelect=null;b.construct=FDsShareResourceCatalogContent_construct;
b.selectObject=FDsShareResourceCatalogContent_selectObject;b.showObject=FDsShareResourceCatalogContent_showObject;b.dispose=FDsShareResourceCatalogContent_dispose;return b}function FDsShareResourceCatalogContent_onBuild(b){this.__base.FUiDataTreeView.onBuild.call(this,b);this.lsnsClick.register(this,this.onNodeClick);this.loadUrl("/cloud.describe.tree.ws?action=query&code=resource.catalog")}function FDsShareResourceCatalogContent_onLoadDisplay(b){this.buildRenderable(b._linkNode,b)}
function FDsShareResourceCatalogContent_onNodeClick(b,d){}function FDsShareResourceCatalogContent_onNodeViewClick(b){}function FDsShareResourceCatalogContent_onNodeViewDoubleClick(b){}function FDsShareResourceCatalogContent_construct(){this.__base.FUiDataTreeView.construct.call(this);this._renderables=new TObjects;this._materials=new TObjects}function FDsShareResourceCatalogContent_selectObject(b){null!=b&&this.processSelectedListener(b,!0)}function FDsShareResourceCatalogContent_showObject(b){}
function FDsShareResourceCatalogContent_dispose(){this.__base.FUiDataTreeView.dispose.call(this)}
function FDsShareResourceCatalogToolBar(b){b=RClass.inherits(this,b,FUiToolBar);b._frameName="resource.share.resource.CatalogToolBar";b._controlFolderOpenButton=null;b._controlFolderCloseButton=null;b._activeNodeGuid=null;b.onBuilded=FDsShareResourceCatalogToolBar_onBuilded;b.onFolderOpenClick=FDsShareResourceCatalogToolBar_onFolderOpenClick;b.onFolderCloseClick=FDsShareResourceCatalogToolBar_onFolderCloseClick;b.construct=FDsShareResourceCatalogToolBar_construct;b.dispose=FDsShareResourceCatalogToolBar_dispose;
return b}function FDsShareResourceCatalogToolBar_onBuilded(b){this.__base.FUiToolBar.onBuilded.call(this,b);this._controlFolderOpen.addClickListener(this,this.onFolderOpenClick);this._controlFolderClose.addClickListener(this,this.onFolderCloseClick)}function FDsShareResourceCatalogToolBar_onFolderOpenClick(b){}function FDsShareResourceCatalogToolBar_onFolderCloseClick(b){}function FDsShareResourceCatalogToolBar_construct(){this.__base.FUiToolBar.construct.call(this)}
function FDsShareResourceCatalogToolBar_dispose(){this.__base.FUiToolBar.dispose.call(this)}
function FDsShareResourceFrameSet(b){b=RClass.inherits(this,b,FUiFrameSet);b._frameName="resource.share.resource.FrameSet";b._styleToolbarGround=RClass.register(b,new AStyle("_styleToolbarGround","Toolbar_Ground"));b._styleCatalogContent=RClass.register(b,new AStyle("_styleCatalogContent","Catalog_Content"));b._styleListContent=RClass.register(b,new AStyle("_styleListContent","List_Content"));b._stylePropertyContent=RClass.register(b,new AStyle("_stylePropertyContent","Property_Content"));b._resourceTypeCd=
"picture";b._frameCatalog=null;b._frameCatalogToolbar=null;b._frameCatalogContent=null;b._frameSearch=null;b._frameSearchToolbar=null;b._frameSearchContent=null;b._framePreview=null;b._framePreviewToolbar=null;b._framePreviewContent=null;b._propertyFrames=null;b.onBuilded=FDsShareResourceFrameSet_onBuilded;b.onCatalogSelected=FDsShareResourceFrameSet_onCatalogSelected;b.construct=FDsShareResourceFrameSet_construct;b.findPropertyFrame=FDsShareResourceFrameSet_findPropertyFrame;b.switchContent=FDsShareResourceFrameSet_switchContent;
b.load=FDsShareResourceFrameSet_load;b.dispose=FDsShareResourceFrameSet_dispose;return b}
function FDsShareResourceFrameSet_onBuilded(b){this.__base.FUiFrameSet.onBuilded.call(this,b);this._frameCatalogToolBar._hPanel.className=this.styleName("Toolbar_Ground");this._frameCatalogContent._hPanel.className=this.styleName("Catalog_Content");this._frameListToolBar._hPanel.className=this.styleName("Toolbar_Ground");this._frameListContent._hPanel.className=this.styleName("List_Content");var d=this._catalogSplitter=this.searchControl("catalogSpliter");d.setAlignCd(EUiAlign.Left);d.setSizeHtml(this._frameCatalog._hPanel);
d=this._catalogToolbar=RClass.create(FDsShareResourceCatalogToolBar);d._workspace=this._workspace;d._frameSet=this;d.buildDefine(b);this._frameCatalogToolBar.push(d);d=this._catalogContent=RClass.create(FDsShareResourceCatalogContent);d._workspace=this._workspace;d._frameSet=this;d.build(b);this._frameCatalogContent.push(d);d=this._listToolBar=RClass.create(FDsShareResourceListToolBar);d._workspace=this._workspace;d._frameSet=this;d.buildDefine(b);this._frameListToolBar.push(d);d=this._listContent=
RClass.create(FDsShareResourceListContent);d._workspace=this._workspace;d._frameSet=this;d.build(b);this._frameListContent.push(d)}
function FDsShareResourceFrameSet_onCatalogSelected(b,d){for(var f=this._activeSpace,h=this._propertyFrames,q=h.count(),z=0;z<q;z++){var A=h.value(z);A.hide()}if(RClass.isClass(b,FE3dStage))A=this.findPropertyFrame(EDsFrame.MeshSpacePropertyFrame),A.show(),A.loadObject(f,f);else if(RClass.isClass(b,FG3dTechnique))A=this.findPropertyFrame(EDsFrame.MeshTechniquePropertyFrame),A.show(),A.loadObject(f,b);else if(RClass.isClass(b,FE3dRegion))A=this.findPropertyFrame(EDsFrame.MeshRegionPropertyFrame),A.show(),
A.loadObject(f,b);else if(RClass.isClass(b,FE3dCamera))A=this.findPropertyFrame(EDsFrame.MeshCameraPropertyFrame),A.show(),A.loadObject(f,b);else if(RClass.isClass(b,FG3dDirectionalLight))A=this.findPropertyFrame(EDsFrame.MeshLightPropertyFrame),A.show(),A.loadObject(f,b);else if(RClass.isClass(b,FE3dMeshDisplay))A=this.findPropertyFrame(EDsFrame.MeshDisplayPropertyFrame),A.show(),A.loadObject(f,b);else if(RClass.isClass(b,FG3dMaterial))A=this.findPropertyFrame(EDsFrame.MeshMaterialPropertyFrame),
A.show(),A.loadObject(f,b);else if(RClass.isClass(b,FE3dMeshRenderable))A=this.findPropertyFrame(EDsFrame.MeshRenderablePropertyFrame),A.show(),A.loadObject(f,b);else throw new TError("Unknown select object type. (value={1})",b);}function FDsShareResourceFrameSet_construct(){this.__base.FUiFrameSet.construct.call(this);this._propertyFrames=new TDictionary}
function FDsShareResourceFrameSet_findPropertyFrame(b){var d=this._propertyFrames.get(b);d||(d=RConsole.find(FFrameConsole).get(this,b,this._framePreview._hContainer),d._workspace=this,this._propertyFrames.set(b,d));return d}function FDsShareResourceFrameSet_switchContent(b){this._resourceTypeCd=b;this._listContent.serviceSearch(b,"","",40,0)}function FDsShareResourceFrameSet_load(){this._listToolBar.storageLoad()}
function FDsShareResourceFrameSet_dispose(){this.__base.FUiFrameSet.dispose.call(this);this._propertyFrames.dispose();this._propertyFrames=null}
function FDsShareResourceListContent(b){b=RClass.inherits(this,b,FUiListView);b._contentFlag=null;b._contentTypeCd=EE3sResource.All;b._contentSerach="";b._contentOrder="";b._contentPageSize=40;b._contentPageCount=0;b._contentPage=0;b._activeItem=null;b._activeGuid=null;b._refreshButton=null;b._saveButton=null;b._runButton=null;b.onServiceLoad=FDsShareResourceListContent_onServiceLoad;b.construct=FDsShareResourceListContent_construct;b.doClickItem=FDsShareResourceListContent_doClickItem;b.doDoubleClickItem=
FDsShareResourceListContent_doDoubleClickItem;b.serviceSearch=FDsShareResourceListContent_serviceSearch;b.serviceResearch=FDsShareResourceListContent_serviceResearch;b.dispose=FDsShareResourceListContent_dispose;return b}
function FDsShareResourceListContent_onServiceLoad(b){b=b.root.findNode("ResourceCollection");var d=b.getInteger("page_size"),f=b.getInteger("page_count"),h=b.getInteger("page");this._frameSet._listToolBar.setNavigator(d,f,h);this.clear();b=b.nodes();d=b.count();for(f=0;f<d;f++)if(h=b.getAt(f),h.isName("Resource")){var q=this.createItem(FDsShareResourceListItem);q.propertyLoad(h);q._guid=h.get("guid");q._typeCd=h.get("type_cd");q._shareCd=h.get("share_cd");q._code=h.get("code");q._updateDate=h.get("update_date");
q.setTypeLabel(q._typeCd);q.setLabel(h.get("code")+" - "+h.get("label"));q.refreshStyle();this.push(q)}RConsole.find(FUiDesktopConsole).hide()}function FDsShareResourceListContent_construct(){this.__base.FUiListView.construct.call(this)}function FDsShareResourceListContent_doClickItem(b){this.__base.FUiListView.doClickItem.call(this,b)}
function FDsShareResourceListContent_doDoubleClickItem(b){this.__base.FUiListView.doDoubleClickItem.call(this,b);var d=b._guid;this._activeItem=b;this._activeGuid=b._guid;var f=this._frameSet._workspace;b=b._typeCd;if(b==EE3sResource.Bitmap)f.selectFrameSet(EDsFrameSet.ShareBitmapFrameSet,d);else if(b==EE3sResource.Material)f.selectFrameSet(EDsFrameSet.ShareMaterialFrameSet,d);else if(b==EE3sResource.Model)f.selectFrameSet(EDsFrameSet.ShareModelFrameSet,d);else if(b==EE3sResource.Template)f.selectFrameSet(EDsFrameSet.ShareTemplateFrameSet,
d);else if(b==EE3sResource.Scene)f.selectFrameSet(EDsFrameSet.ShareSceneFrameSet,d);else throw new TError(this,"Unsupport resource format.");}
function FDsShareResourceListContent_serviceSearch(b,d,f,h,q){null==b&&(b=this._contentTypeCd);null==d&&(d=this._contentSerach);null==f&&(f=this._contentOrder);null==h&&(h=this._contentPageSize);null==q&&(q=this._contentPage);var z=b+"|"+d+"|"+f+"|"+h+"|"+q;this._contentFlag!=z&&(this._contentFlag=z,this._contentTypeCd=b,this._contentSerach=d,this._contentOrder=f,this._contentPageSize=h,this._contentPage=q,RConsole.find(FUiDesktopConsole).showLoading(),RConsole.find(FDrResourceConsole).doListShare(this._contentTypeCd,
this._contentSerach,this._contentOrder,this._contentPageSize,this._contentPage).addLoadListener(this,this.onServiceLoad))}function FDsShareResourceListContent_serviceResearch(){this.serviceSearch(this._contentTypeCd,this._contentSerach,this._contentOrder,this._contentPageSize,this._contentPage)}function FDsShareResourceListContent_dispose(){this.__base.FUiListView.dispose.call(this)}function FDsShareResourceListItem(b){return b=RClass.inherits(this,b,FDsResourceListItem)}
function FDsShareResourceListToolBar(b){b=RClass.inherits(this,b,FDsResourceListToolBar);b._frameName="resource.share.resource.ListToolBar";b._storageCode=b._frameName;return b}
function FDsShareResourceMenuBar(b){b=RClass.inherits(this,b,FUiMenuBar);b._frameName="resource.share.resource.MenuBar";b._controlRefresh=null;b.onBuilded=FDsShareResourceMenuBar_onBuilded;b.onRefreshClick=FDsShareResourceMenuBar_onRefreshClick;b.construct=FDsShareResourceMenuBar_construct;b.dispose=FDsShareResourceMenuBar_dispose;return b}function FDsShareResourceMenuBar_onBuilded(b){this.__base.FUiMenuBar.onBuilded.call(this,b);this._controlRefresh.addClickListener(this,this.onRefreshClick)}
function FDsShareResourceMenuBar_onRefreshClick(b){}function FDsShareResourceMenuBar_construct(){this.__base.FUiMenuBar.construct.call(this)}function FDsShareResourceMenuBar_dispose(){this.__base.FUiMenuBar.dispose.call(this)}function FDsShareResourcePropertyContent(b){return b=RClass.inherits(this,b,FDsResourcePropertyContent)}
function FDsShareResourcePropertyToolBar(b){b=RClass.inherits(this,b,FUiToolBar);b._frameName="resource.resource.PropertyToolBar";b._controlInsertButton=null;b._controlUpdateButton=null;b._controlDeleteButton=null;b._controlRotationButton=null;b.onBuilded=FDsShareResourcePropertyToolBar_onBuilded;b.onUpdateClick=FDsShareResourcePropertyToolBar_onUpdateClick;b.onRotationClick=FDsShareResourcePropertyToolBar_onRotationClick;b.construct=FDsShareResourcePropertyToolBar_construct;b.dispose=FDsShareResourcePropertyToolBar_dispose;
return b}function FDsShareResourcePropertyToolBar_onBuilded(b){this.__base.FUiToolBar.onBuilded.call(this,b);this._controlUpdateButton.addClickListener(this,this.onUpdateClick);this._controlRotationButton.addClickListener(this,this.onRotationClick)}function FDsShareResourcePropertyToolBar_onUpdateClick(b){}function FDsShareResourcePropertyToolBar_onRotationClick(b){this._workspace._previewContent.switchRotation(b.checked)}
function FDsShareResourcePropertyToolBar_construct(){this.__base.FUiToolBar.construct.call(this)}function FDsShareResourcePropertyToolBar_dispose(){this.__base.FUiToolBar.dispose.call(this)}
function FDsShareResourceTabBar(b){b=RClass.inherits(this,b,FUiTabBar);b._frameName="design3d.resource.TabBar";b._resourceTypeCd="mesh";b._controlPictureButton=null;b._controlSoundButton=null;b._controlVidioButton=null;b._controlTextureButton=null;b._controlMaterialButton=null;b._controlMeshButton=null;b._controlModelButton=null;b._controlTemplateButton=null;b._controlSceneButton=null;b.onBuilded=FDsShareResourceTabBar_onBuilded;b.onButtonClick=FDsShareResourceTabBar_onButtonClick;b.construct=FDsShareResourceTabBar_construct;
b.dispose=FDsShareResourceTabBar_dispose;return b}
function FDsShareResourceTabBar_onBuilded(b){this.__base.FUiTabBar.onBuilded.call(this,b);this._controlPictureButton.addClickListener(this,this.onButtonClick);this._controlSoundButton.addClickListener(this,this.onButtonClick);this._controlVidioButton.addClickListener(this,this.onButtonClick);this._controlTextureButton.addClickListener(this,this.onButtonClick);this._controlMaterialButton.addClickListener(this,this.onButtonClick);this._controlMeshButton.addClickListener(this,this.onButtonClick);this._controlModelButton.addClickListener(this,
this.onButtonClick);this._controlTemplateButton.addClickListener(this,this.onButtonClick);this._controlSceneButton.addClickListener(this,this.onButtonClick)}function FDsShareResourceTabBar_onButtonClick(b){this._resourceTypeCd=b.sender.name()}function FDsShareResourceTabBar_construct(){this.__base.FUiTabBar.construct.call(this)}function FDsShareResourceTabBar_dispose(){this.__base.FUiTabBar.dispose.call(this)}
function FDsShareResourceWorkspace(b){b=RClass.inherits(this,b,FUiWorkspace);b._frameName="resource.share.resource.Workspace";b._styleToolbarGround=RClass.register(b,new AStyle("_styleToolbarGround","Toolbar_Ground"));b._styleStatusbarGround=RClass.register(b,new AStyle("_styleStatusbarGround","Statusbar_Ground"));b._styleCatalogGround=RClass.register(b,new AStyle("_styleCatalogGround","Catalog_Ground"));b._styleCatalogToolbar=RClass.register(b,new AStyle("_styleCatalogToolbar","Catalog_Toolbar"));
b._styleSearchGround=RClass.register(b,new AStyle("_styleSearchGround","Search_Ground"));b._styleSearchToolbar=RClass.register(b,new AStyle("_styleCatalogToolbar","Search_Toolbar"));b._stylePreviewGround=RClass.register(b,new AStyle("_stylePreviewGround","Preview_Ground"));b._stylePreviewToolbar=RClass.register(b,new AStyle("_stylePreviewToolbar","Preview_Toolbar"));b._stylePropertyGround=RClass.register(b,new AStyle("_stylePropertyGround","Property_Ground"));b._styleWorkspaceGround=RClass.register(b,
new AStyle("_styleWorkspaceGround","Workspace_Ground"));b._resourceTypeCd="picture";b._frameToolBar=null;b._frameStatusBar=null;b._frameCatalog=null;b._frameCatalogToolbar=null;b._frameCatalogContent=null;b._frameSearch=null;b._frameSearchToolbar=null;b._frameSearchContent=null;b._framePreview=null;b._framePreviewToolbar=null;b._framePreviewContent=null;b._propertyFrames=null;b.onBuilded=FDsShareResourceWorkspace_onBuilded;b.onMeshLoad=FDsShareResourceWorkspace_onMeshLoad;b.onCatalogSelected=FDsShareResourceWorkspace_onCatalogSelected;
b.construct=FDsShareResourceWorkspace_construct;b.findPropertyFrame=FDsShareResourceWorkspace_findPropertyFrame;b.switchContent=FDsShareResourceWorkspace_switchContent;b.load=FDsShareResourceWorkspace_load;b.dispose=FDsShareResourceWorkspace_dispose;return b}
function FDsShareResourceWorkspace_onBuilded(b){this.__base.FUiWorkspace.onBuilded.call(this,b);var d=this._frameToolBar=this.searchControl("toolbarFrame");d._hPanel.className=this.styleName("Toolbar_Ground");d=this._frameBody=this.searchControl("bodyFrame");d._hPanel.className=this.styleName("Catalog_Ground");d=this._frameStatusBar=this.searchControl("statusFrame");d._hPanel.className=this.styleName("Statusbar_Ground");d=RBuilder.createTable(b);d.width="100%";var f=RBuilder.appendTableRow(d),h=this._toolbar=
RClass.create(FDsShareResourceMenuBar);h._workspace=this;h.buildDefine(b);var q=RBuilder.appendTableCell(f);q.appendChild(h._hPanel);h=this._tabBar=RClass.create(FDsShareResourceTabBar);h._workspace=this;h.buildDefine(b);q=RBuilder.appendTableCell(f);q.width="450px";q.align="right";q.vAlign="bottom";q.appendChild(h._hPanel);this._frameToolBar._hPanel.appendChild(d);d=this._frameSet=RClass.create(FDsShareResourceFrameSet);d._workspace=this;d.buildDefine(b);this._frameBody.push(d);d.switchContent(this._resourceTypeCd)}
function FDsShareResourceWorkspace_onMeshLoad(b){this._activeSpace=b._activeSpace;this._catalog.buildSpace(this._activeSpace)}
function FDsShareResourceWorkspace_onCatalogSelected(b,d){for(var f=this._activeSpace,h=this._propertyFrames,q=h.count(),z=0;z<q;z++){var A=h.value(z);A.hide()}if(RClass.isClass(b,FE3dStage))A=this.findPropertyFrame(EDsFrame.MeshSpacePropertyFrame),A.show(),A.loadObject(f,f);else if(RClass.isClass(b,FG3dTechnique))A=this.findPropertyFrame(EDsFrame.MeshTechniquePropertyFrame),A.show(),A.loadObject(f,b);else if(RClass.isClass(b,FE3dRegion))A=this.findPropertyFrame(EDsFrame.MeshRegionPropertyFrame),
A.show(),A.loadObject(f,b);else if(RClass.isClass(b,FE3dCamera))A=this.findPropertyFrame(EDsFrame.MeshCameraPropertyFrame),A.show(),A.loadObject(f,b);else if(RClass.isClass(b,FG3dDirectionalLight))A=this.findPropertyFrame(EDsFrame.MeshLightPropertyFrame),A.show(),A.loadObject(f,b);else if(RClass.isClass(b,FE3dMeshDisplay))A=this.findPropertyFrame(EDsFrame.MeshDisplayPropertyFrame),A.show(),A.loadObject(f,b);else if(RClass.isClass(b,FG3dMaterial))A=this.findPropertyFrame(EDsFrame.MeshMaterialPropertyFrame),
A.show(),A.loadObject(f,b);else if(RClass.isClass(b,FE3dMeshRenderable))A=this.findPropertyFrame(EDsFrame.MeshRenderablePropertyFrame),A.show(),A.loadObject(f,b);else throw new TError("Unknown select object type. (value={1})",b);}function FDsShareResourceWorkspace_construct(){this.__base.FUiWorkspace.construct.call(this);this._propertyFrames=new TDictionary}
function FDsShareResourceWorkspace_findPropertyFrame(b){var d=this._propertyFrames.get(b);d||(d=RConsole.find(FFrameConsole).get(this,b,this._framePreview._hContainer),d._workspace=this,this._propertyFrames.set(b,d));return d}function FDsShareResourceWorkspace_switchContent(b){this._frameSet.switchContent(b)}function FDsShareResourceWorkspace_load(){}function FDsShareResourceWorkspace_dispose(){this.__base.FUiWorkspace.dispose.call(this);this._propertyFrames.dispose();this._propertyFrames=null}
function FDsShareBitmapCanvasContent(b){return b=RClass.inherits(this,b,FDsBitmapCanvasContent)}function FDsShareBitmapCanvasToolBar(b){b=RClass.inherits(this,b,FDsBitmapCanvasToolBar);b._frameName="resource.share.bitmap.CanvasToolBar";return b}function FDsShareBitmapFrameSet(b){b=RClass.inherits(this,b,FDsBitmapFrameSet);b._frameName="resource.share.bitmap.FrameSet";b.onBuilded=FDsShareBitmapFrameSet_onBuilded;return b}
function FDsShareBitmapFrameSet_onBuilded(b){this.__base.FDsBitmapFrameSet.onBuilded.call(this,b);var d=this._canvasToolbar=RClass.create(FDsShareBitmapCanvasToolBar);d._frameSet=this;d.buildDefine(b);this._frameCanvasToolBar.push(d);d=this._canvasContent=RClass.create(FDsBitmapCanvasContent);d._frameSet=this;d._hParent=this._frameCanvasContent._hPanel;d._hParent.style.backgroundColor="#333333";d._hParent.style.scroll="auto";d.build(b);this._frameCanvasContent.push(d);d=this._propertyToolbar=RClass.create(FDsBitmapPropertyToolBar);
d._frameSet=this;d.buildDefine(b);this._framePropertyToolBar.push(d);b=this.findPropertyFrame(EDsFrame.BitmapPropertyFrame);this._framePropertyContent.push(b)}function FDsShareBitmapMenuBar(b){b=RClass.inherits(this,b,FDsBitmapMenuBar);b._frameName="resource.share.bitmap.MenuBar";b.onBuilded=FDsShareBitmapMenuBar_onBuilded;b.onBackClick=FDsShareBitmapMenuBar_onBackClick;return b}
function FDsShareBitmapMenuBar_onBuilded(b){this.__base.FDsBitmapMenuBar.onBuilded.call(this,b);this._controlBack.addClickListener(this,this.onBackClick)}function FDsShareBitmapMenuBar_onBackClick(b){this._frameSet._workspace.selectFrameSet(EDsFrameSet.ShareResourceFrameSet)}function FDsShareBitmapPropertyToolBar(b){b=RClass.inherits(this,b,FDsBitmapPropertyToolBar);b._frameName="resource.share.bitmap.PropertyToolBar";return b}
function FDsShareBitmapWorkspace(b){b=RClass.inherits(this,b,FDsBitmapWorkspace);b._frameName="resource.share.bitmap.Workspace";return b}function FDsShareMaterialCanvasToolBar(b){b=RClass.inherits(this,b,FDsMaterialCanvasToolBar);b._frameName="resource.share.materail.CanvasToolBar";return b}function FDsShareMaterialFrameSet(b){b=RClass.inherits(this,b,FDsMaterialFrameSet);b._frameName="resource.share.material.FrameSet";b.onBuilded=FDsShareMaterialFrameSet_onBuilded;return b}
function FDsShareMaterialFrameSet_onBuilded(b){this.__base.FDsMaterialFrameSet.onBuilded.call(this,b);var d=this._toolbar=RClass.create(FDsShareMaterialMenuBar);d._frameSet=this;d.buildDefine(b);this._frameToolBar.push(d);d=this._catalogContent=RClass.create(FDsMaterialCatalogContent);d._frameSet=this;d.build(b);d.addSelectedListener(this,this.onCatalogSelected);this._frameCatalogContent.push(d);d=this._canvasToolbar=RClass.create(FDsShareMaterialCanvasToolBar);d._frameSet=this;d.buildDefine(b);this._frameCanvasToolBar.push(d);
d=this._canvasContent=RClass.create(FDsMaterialCanvasContent);d._frameSet=this;d._toolbar=this._canvasToolbar;d._hParent=this._frameCanvasContent._hPanel;d._hParent.style.backgroundColor="#333333";d._hParent.style.scroll="auto";d.addLoadListener(this,this.onDataLoaded);d.build(b);this._frameCanvasContent.push(d)}function FDsShareMaterialMenuBar(b){b=RClass.inherits(this,b,FDsMaterialMenuBar);b._frameName="resource.share.material.MenuBar";return b}
function FDsShareModelCanvasToolBar(b){b=RClass.inherits(this,b,FDsModelCanvasToolBar);b._frameName="resource.share.model.CanvasToolBar";return b}function FDsShareModelCatalogToolBar(b){b=RClass.inherits(this,b,FDsModelCatalogToolBar);b._frameName="resource.share.model.CatalogToolBar";return b}function FDsShareModelFrameSet(b){b=RClass.inherits(this,b,FDsModelFrameSet);b._frameName="resource.share.model.FrameSet";b.onBuilded=FDsShareModelFrameSet_onBuilded;return b}
function FDsShareModelFrameSet_onBuilded(b){this.__base.FDsModelFrameSet.onBuilded.call(this,b);var d=this._catalogToolbar=RClass.create(FDsShareModelCatalogToolBar);d._frameSet=this;d.buildDefine(b);this._frameCatalogToolBar.push(d);d=this._catalogContent=RClass.create(FDsModelCatalogContent);d._frameSet=this;d.build(b);d.addSelectedListener(this,this.onCatalogSelected);this._frameCatalogContent.push(d);d=this._canvasToolbar=RClass.create(FDsShareModelCanvasToolBar);d._frameSet=this;d.buildDefine(b);
this._frameCanvasToolBar.push(d);d=this._canvasContent=RClass.create(FDsModelCanvasContent);d._frameSet=this;d._toolbar=this._canvasToolbar;d._hParent=this._frameCanvasContent._hPanel;d._hParent.style.backgroundColor="#333333";d._hParent.style.scroll="auto";d.addLoadListener(this,this.onDataLoaded);d.build(b);this._frameCanvasContent.push(d)}
function FDsShareModelMenuBar(b){b=RClass.inherits(this,b,FDsModelMenuBar);b._frameName="resource.share.model.MenuBar";b.onBuilded=FDsShareModelMenuBar_onBuilded;return b}function FDsShareModelMenuBar_onBuilded(b){this.__base.FDsModelMenuBar.onBuilded.call(this,b)}
function FDsShareTemplateCanvasToolBar(b){b=RClass.inherits(this,b,FUiToolBar);b._frameName="resource.share.template.CanvasToolBar";b._refreshButton=null;b._saveButton=null;b._canvasModeCd=EDsCanvasMode.Drop;b.onBuilded=FDsShareTemplateCanvasToolBar_onBuilded;b.onModeClick=FDsShareTemplateCanvasToolBar_onModeClick;b.onLookClick=FDsShareTemplateCanvasToolBar_onLookClick;b.onPlayClick=FDsShareTemplateCanvasToolBar_onPlayClick;b.onViewClick=FDsShareTemplateCanvasToolBar_onViewClick;b.construct=FDsShareTemplateCanvasToolBar_construct;
b.dispose=FDsShareTemplateCanvasToolBar_dispose;return b}
function FDsShareTemplateCanvasToolBar_onBuilded(b){this.__base.FUiToolBar.onBuilded.call(this,b);this._controlModeDrop.addClickListener(this,this.onModeClick);this._controlModeSelect.addClickListener(this,this.onModeClick);this._controlTranslate.addClickListener(this,this.onModeClick);this._controlRotation.addClickListener(this,this.onModeClick);this._controlScale.addClickListener(this,this.onModeClick);this._controlLookFront.addClickListener(this,this.onLookClick);this._controlLookUp.addClickListener(this,
this.onLookClick);this._controlLookLeft.addClickListener(this,this.onLookClick);this._controlPlay.addClickListener(this,this.onPlayClick);this._controlView.addClickListener(this,this.onViewClick)}function FDsShareTemplateCanvasToolBar_onModeClick(b){this._canvasModeCd=b._canvasModeCd}function FDsShareTemplateCanvasToolBar_onLookClick(b){this._canvasModeCd=b._canvasModeCd}function FDsShareTemplateCanvasToolBar_onPlayClick(b,d){this._frameSet._canvasContent._rotationAble=d}
function FDsShareTemplateCanvasToolBar_onViewClick(b,d){this._frameSet._canvasContent._rotationAble=d}function FDsShareTemplateCanvasToolBar_construct(){this.__base.FUiToolBar.construct.call(this)}function FDsShareTemplateCanvasToolBar_dispose(){this.__base.FUiToolBar.dispose.call(this)}function FDsShareTemplateCatalogToolBar(b){b=RClass.inherits(this,b,FDsTemplateCatalogToolBar);b._frameName="resource.share.template.CatalogToolBar";return b}
function FDsShareTemplateFrameSet(b){b=RClass.inherits(this,b,FDsTemplateFrameSet);b._frameName="resource.share.template.FrameSet";b.onBuilded=FDsShareTemplateFrameSet_onBuilded;return b}
function FDsShareTemplateFrameSet_onBuilded(b){this.__base.FDsTemplateFrameSet.onBuilded.call(this,b);var d=this._catalogToolbar=RClass.create(FDsShareTemplateCatalogToolBar);d._frameSet=this;d.buildDefine(b);this._frameCatalogToolBar.push(d);d=this._catalogContent=RClass.create(FDsTemplateCatalogContent);d._frameSet=this;d.build(b);d.addSelectedListener(this,this.onCatalogSelected);this._frameCatalogContent.push(d);d=this._canvasToolbar=RClass.create(FDsShareTemplateCanvasToolBar);d._frameSet=this;
d._workspace=this._worksapce;d.buildDefine(b);this._frameCanvasToolBar.push(d);d=this._canvasContent=RClass.create(FDsTemplateCanvasContent);d._frameSet=this;d._toolbar=this._canvasToolbar;d._hParent=this._frameCanvasContent._hPanel;d._hParent.style.backgroundColor="#333333";d._hParent.style.scroll="auto";d.addLoadListener(this,this.onDataLoaded);d.build(b);this._frameCanvasContent.push(d)}
function FDsShareTemplateMenuBar(b){b=RClass.inherits(this,b,FDsTemplateMenuBar);b._frameName="resource.share.template.MenuBar";b.onBuilded=FDsShareTemplateMenuBar_onBuilded;return b}function FDsShareTemplateMenuBar_onBuilded(b){this.__base.FDsTemplateMenuBar.onBuilded.call(this,b)}function FDsShareTemplateToolBar(b){return b=RClass.inherits(this,b,FDsTemplateToolBar)}
function FDsShareTemplateToolBar_onBuild(b){this.__base.FUiToolBar.onBuild.call(this,b);var d=this._refreshButton=RClass.create(FUiToolButton);d.setLabel("\u5237\u65b0");d.setIcon("design3d.tools.refresh");d.build(b);d.addClickListener(this,this.onRefreshClick);this.push(d);d=this._saveButton=RClass.create(FUiToolButton);d.setLabel("\u4fdd\u5b58");d.setIcon("design3d.tools.save");d.build(b);d.addClickListener(this,this.onSaveClick);this.push(d)}
function FDsShareTemplateToolBar_onRefreshClick(b){}function FDsShareTemplateToolBar_onSaveClick(b){var d=this._workspace._activeTemplate;b=d._resource.themes();for(var f=b.count(),h=new TXmlNode,q=0;q<f;q++)for(var d=b.get(q),d=d.materials(),z=d.count(),A=0;A<z;A++)d.value(A).saveConfig(h.create("Material"));RConsole.find(FE3sTemplateConsole).update(h)}function FDsShareTemplateToolBar_construct(){this.__base.FUiToolBar.construct.call(this)}
function FDsShareTemplateToolBar_dispose(){this.__base.FUiToolBar.dispose.call(this)}function FDsShareSceneCanvasToolBar(b){b=RClass.inherits(this,b,FDsSceneCanvasToolBar);b._frameName="resource.share.scene.CanvasToolBar";return b}function FDsShareSceneCatalogToolBar(b){b=RClass.inherits(this,b,FDsSceneCatalogToolBar);b._frameName="resource.share.scene.CatalogToolBar";return b}
function FDsShareSceneFrameSet(b){b=RClass.inherits(this,b,FDsSceneFrameSet);b._frameName="resource.share.scene.FrameSet";b.onBuilded=FDsShareSceneFrameSet_onBuilded;return b}
function FDsShareSceneFrameSet_onBuilded(b){this.__base.FDsSceneFrameSet.onBuilded.call(this,b);var d=this._catalogToolbar=RClass.create(FDsShareSceneCatalogToolBar);d._frameSet=this;d.buildDefine(b);this._frameCatalogToolBar.push(d);d=this._catalogContent=RClass.create(FDsSceneCatalogContent);d._frameSet=this;d.build(b);d.addSelectedListener(this,this.onCatalogSelected);this._frameCatalogContent.push(d);d=this._canvasToolbar=RClass.create(FDsShareSceneCanvasToolBar);d._frameSet=this;d.buildDefine(b);
this._frameCanvasToolBar.push(d);d=this._canvasContent=RClass.create(FDsSceneCanvasContent);d._frameSet=this;d._toolbar=this._canvasToolbar;d._hParent=this._frameCanvasContent._hPanel;d._hParent.style.backgroundColor="#333333";d._hParent.style.scroll="auto";d.addLoadListener(this,this.onDataLoaded);d.build(b);this._frameCanvasContent.push(d);d=this._propertyToolbar=RClass.create(FDsScenePropertyToolBar);d._frameSet=this;d.buildDefine(b);this._framePropertyToolBar.push(d)}
function FDsShareSceneMenuBar(b){b=RClass.inherits(this,b,FDsSceneMenuBar);b._frameName="resource.share.scene.MenuBar";b.onBuilded=FDsShareSceneMenuBar_onBuilded;return b}function FDsShareSceneMenuBar_onBuilded(b){this.__base.FDsSceneMenuBar.onBuilded.call(this,b);this._controlExecute.addClickListener(this,this.onExecuteClick)};
