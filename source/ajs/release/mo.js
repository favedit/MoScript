var MO=new function(){this.version="0.3.0";this.info={};this.Lang=new function(){return this};this.Stream=new function(){return this};this.Core=new function(){return this};this.Gui=new function(){return this};this.Dui=new function(){return this};return this};MO.initialize=function(){var b=this.info,d=0,f;for(f in this){var h=this[f];h&&h.constructor==Function&&(h.__name=f);d++}b.count=d};MO.release=function(){};
MO.ELogger=new function(){this.Unknown=0;this.Debug=1;this.Info=2;this.Warn=3;this.Error=4;this.Fatal=5;return this};MO.EPlatform=new function(){this.Unknown=0;this.Pc=1;this.Mobile=2;return this};MO.EProcess=new function(){this.Unknown=0;this.Release=1;this.Process=2;this.Debug=3;return this};MO.EScope=new function(){this.Unknown=0;this.Local=1;this.Session=2;this.Global=3;return this};MO.RSingleton=function(){this._singleton=!0;return this};
MO.RRuntime=function(){var b=MO.RSingleton.call(this);b._processCd=MO.EProcess.Release;b._platformCd=MO.EPlatform.Pc;return b};MO.RRuntime.prototype.isDebug=function(){return this._processCd==MO.EProcess.Debug};MO.RRuntime.prototype.isProcess=function(){return this._processCd==MO.EProcess.Process};MO.RRuntime.prototype.isRelease=function(){return this._processCd==MO.EProcess.Release};MO.RRuntime.prototype.processCd=function(){return this._processCd};
MO.RRuntime.prototype.setProcessCd=function(b){this._processCd=b};MO.RRuntime.prototype.isPlatformPc=function(){return this._platformCd==MO.EPlatform.Pc};MO.RRuntime.prototype.isPlatformMobile=function(){return this._platformCd==MO.EPlatform.Mobile};MO.RRuntime.prototype.platformCd=function(){return this._platformCd};MO.RRuntime.prototype.setPlatformCd=function(b){this._platformCd=b};MO.RRuntime.prototype.empty=function(){};MO.RRuntime.prototype.nvl=function(b,d){return null!=b?b:d};
MO.RRuntime.prototype.subString=function(b,d,f){if(null==b)return b;var h=0;if(null!=d){var q=b.indexOf(d);-1!=q&&(h=q+d.length)}d=b.length;null!=f&&(q=b.indexOf(f,length),-1!=q&&(d=q));return h>=d?"":b.substring(h,d)};MO.RRuntime.prototype.className=function(b){return b&&("function"==typeof b||(b=b.constructor))?this.subString(b.toString(),"function ","("):null};MO.Runtime=new MO.RRuntime;
MO.TArray=function(b){this._length=MO.Runtime.nvl(b,0);this._memory=[];this.isEmpty=MO.TArray_isEmpty;this.length=MO.TArray_length;this.setLength=MO.TArray_setLength;this.memory=MO.TArray_memory;this.contains=MO.TArray_contains;this.indexOf=MO.TArray_indexOf;this.get=MO.TArray_get;this.set=MO.TArray_set;this.push=MO.TArray_push;this.swap=MO.TArray_swap;this.sort=MO.TArray_sort;this.erase=MO.TArray_erase;this.remove=MO.TArray_remove;this.compress=MO.TArray_compress;this.clear=MO.TArray_clear;this.dispose=
MO.TArray_dispose;this.dump=MO.TArray_dump;return this};MO.TArray_isEmpty=function(){return 0==this._length};MO.TArray_length=function(){return this._length};MO.TArray_setLength=function(b){this._length=b};MO.TArray_memory=function(){return this._memory};MO.TArray_contains=function(b){return-1!=this.indexOf(b)};MO.TArray_indexOf=function(b){for(var d=this._length,f=0;f<d;f++)if(this._memory[f]==b)return f;return-1};MO.TArray_get=function(b){return 0<=b&&b<this._length?this._memory[b]:null};
MO.TArray_set=function(b,d){0<=b&&b<this._length&&(this._memory[b]=d)};MO.TArray_push=function(){for(var b=arguments.length,d=0;d<b;d++)this._memory[this._length++]=arguments[d]};MO.TArray_swap=function(b,d){if(0<=b&&b<this._length&&0<=d&&d<this._length&&b!=d){var f=this._memory[b];this._memory[b]=this._memory[d];this._memory[d]=f}};MO.TArray_sort=function(){this._memory.sort()};
MO.TArray_erase=function(b){var d=null,f=this._count;if(0<=b&&b<f){for(d=this._memory[b];b<f;b++)this._memory[b]=this._memory[b+1];this._length--}return d};MO.TArray_remove=function(b){for(var d=0,f=this._memory,h=this._length,q=0;q<h;q++)f[q]!=b&&(f[d++]=f[q]);this._length=d};MO.TArray_compress=function(){for(var b=0,d=this._length,f=this._memory,h=0;h<d;h++){var q=f[h];null!=q&&(f[b++]=q)}this._length=b};MO.TArray_clear=function(){this._length=0};
MO.TArray_dispose=function(){this._length=0;this._memory=null};MO.TArray_dump=function(){var b=new MO.TString,d=this._length;b.append(MO.Runtime.className(this),":",d);if(0<d)for(var f=this._memory,h=0;h<d;h++)b.append(" [",f[h],"]");return b.flush()};MO.TAttributes=function(){MO.TDictionary.call(this);this.join=MO.TAttributes_join;this.split=MO.TAttributes_split;this.pack=MO.TAttributes_pack;this.unpack=MO.TAttributes_unpack;this.dump=MO.TAttributes_dump;return this};
MO.TAttributes_join=function(b,d){var f=new MO.TString;b||(b="=");d||(d=",");for(var h=this._count,q=0;q<h;q++)0<q&&f.append(d),f.append(this.names[q]),f.append(b),f.append(this.values[q]);return f.flush()};MO.TAttributes_split=function(b,d,f){b=b.split(f);f=b.length;for(var h=0;h<f;h++){var q=b[h];if(q.length){var w=q.split(d);2==w.length?this.set(MO.Lang.String.trim(w[0]),MO.Lang.String.trim(w[1])):this.set(MO.Lang.String.trim(q),"")}}};
MO.TAttributes_pack=function(){for(var b=new MO.TString,d=this._count,f=this._names,h=this._values,q=0;q<d;q++){var w=f[q],z=h[q],A=w.length;b.append(A.toString().length,A,w);null!=z?(z+="",w=z.length,b.append(w.toString().length,w,z)):b.append("0")}return b.flush()};
MO.TAttributes_unpack=function(b){for(var d=this.count=0,f=b.length;d<f;){var h=parseInt(b.substr(d++,1)),q=parseInt(b.substr(d,h)),w=b.substr(d+h,q),d=d+(h+q),h=parseInt(b.substr(d++,1)),z=null;0<h&&(q=parseInt(b.substr(d,h)),z=b.substr(d+h,q),d+=h+q);this.set(w,z)}};MO.TAttributes_dump=function(){var b=new MO.TString,d=this._count;b.append(MO.Runtime.className(this)," : ",d);if(0<d){var f=this._names,h=this._values;b.append(" (");for(var q=0;q<d;q++)0<q&&b.append(", "),b.append(f[q],"=",h[q]);b.append(")")}return b.flush()};
MO.TDictionary=function(){MO.TMap.call(this);this.dump=MO.TDictionary_dump;return this};MO.TDictionary_dump=function(){var b=new MO.TString,d=this._count;b.append(MO.Runtime.className(o),": ",d);if(0<d){b.append(" {\n");for(var f=0;f<d;f++)b.append("   ",this._names[f],"=[",this._values[f],"]\n");b.append("}")}return b.flush()};
MO.TMap=function(){this._count=0;this._table={};this._names=[];this._values=[];this.isEmpty=MO.TMap_isEmpty;this.count=MO.TMap_count;this.contains=MO.TMap_contains;this.containsValue=MO.TMap_containsValue;this.indexOf=MO.TMap_indexOf;this.indexOfValue=MO.TMap_indexOfValue;this.first=MO.TMap_first;this.last=MO.TMap_last;this.nameAt=MO.TMap_nameAt;this.name=MO.TMap_name;this.at=this.valueAt=MO.TMap_valueAt;this.value=MO.TMap_value;this.setValueAt=MO.TMap_setValueAt;this.setValue=MO.TMap_setValue;this.get=
MO.TMap_get;this.set=MO.TMap_set;this.assign=MO.TMap_assign;this.append=MO.TMap_append;this.insert=MO.TMap_insert;this.remove=MO.TMap_remove;this.removeName=MO.TMap_removeName;this.removeValue=MO.TMap_removeValue;this.rebuild=MO.TMap_rebuild;this.clear=MO.TMap_clear;this.toString=MO.TMap_toString;this.dispose=MO.TMap_dispose;this.dump=MO.TMap_dump;return this};MO.TMap_isEmpty=function(){return 0==this._count};MO.TMap_count=function(){return this._count};
MO.TMap_contains=function(b){return null!=b&&null!=this._table[b.toString().toLowerCase()]?!0:!1};MO.TMap_containsValue=function(b){return-1!=this.indexOfValue(b)};MO.TMap_indexOf=function(b){return null!=b&&(b=this._table[b.toString().toLowerCase()],null!=b)?b:-1};MO.TMap_indexOfValue=function(b){var d=this._count;if(0<d)for(var f=this._values,h=0;h<d;h++)if(f[h]==b)return h;return-1};MO.TMap_first=function(){return 0<this._count?this._values[0]:null};
MO.TMap_last=function(){return 0<this._count?this._values[this._count-1]:null};MO.TMap_nameAt=function(b){return this._names[b]};MO.TMap_name=function(b){return 0<=b&&b<this._count?this._names[b]:null};MO.TMap_valueAt=function(b){return this._values[b]};MO.TMap_value=function(b){return 0<=b&&b<this._count?this._values[b]:null};MO.TMap_setValueAt=function(b,d){this._values[b]=d};MO.TMap_setValue=function(b,d){0<=b&&b<this._count&&(this._values[b]=d)};
MO.TMap_get=function(b,d){if(null!=b){var f=this._table[b.toString().toLowerCase()];if(null!=f)return this._values[f]}return d};MO.TMap_set=function(b,d){if(null!=b){var f=b.toString().toLowerCase(),h=this._table[f];if(null==h||h>=this._count)h=this._count++,this._names[h]=b,this._table[f]=h;this._values[h]=d}};MO.TMap_assign=function(b){this.clear();this.append(b)};MO.TMap_append=function(b){if(b)for(var d=b.count(),f=0;f<d;f++){var h=b.nameAt(f),q=b.valueAt(f);this.set(h,q)}};
MO.TMap_insert=function(b,d,f){var h=this._count;if(0<=b&&b<=h){for(var q=this._names,w=this._values;h>b;h--)q[h]=q[h-1],w[h]=w[h-1];q[b]=d;w[b]=f;this._count++;this.rebuild()}};MO.TMap_remove=function(b){var d=null,f=this._count;if(0<=b&&b<f){for(var h=this._names,q=this._values,d=q[b];b<f;b++)h[b]=h[b+1],q[b]=q[b+1];this._count--;this.rebuild()}return d};MO.TMap_removeName=function(b){b=this.indexOf(b);return-1!=b?this.remove(b):null};
MO.TMap_removeValue=function(b){for(var d=0,f=this._count,h=this._names,q=this._values,w=0;w<f;w++){var z=q[w];z!=b&&(d!=w&&(h[d]=h[w],q[d]=z),d++)}this._count=d;this.rebuild()};MO.TMap_rebuild=function(){var b=this._table,d;for(d in b)delete b[d];d=this._count;for(var f=this._names,h=0;h<d;h++){var q=f[h].toLowerCase();b[q]=h}};MO.TMap_clear=function(){this._count=0;var b=this._table,d;for(d in b)delete b[d]};MO.TMap_toString=function(){return this.dump().toString()};
MO.TMap_dispose=function(b){if(b){var d=this._count,f=this._values;for(b=0;b<d;b++)f[b]=MO.Lang.Object.dispose(f[b])}if(b=this._table){for(var h in b)b[h]=null;this._table=null}if(h=this._names){for(b=h.length-1;0<=b;b--)h[b]=null;this._names=null}if(f=this._values){for(b=f.length-1;0<=b;b--)f[b]=null;this._values=null}this._count=0};
MO.TMap_dump=function(){var b=new MO.TString,d=this._count,f=this._names,h=this._values;b.appendLine(MO.Runtime.className(this),": ",d);if(0<d){b.append(" {");for(var q=0;q<d;q++)b.appendLine(f[q],"=[",h[q],"]");b.append("}")}return b.flush()};
MO.TObjects=function(){this._count=0;this._items=[];this.isEmpty=MO.TObjects_isEmpty;this.count=MO.TObjects_count;this.items=MO.TObjects_items;this.contains=MO.TObjects_contains;this.indexOf=MO.TObjects_indexOf;this.first=MO.TObjects_first;this.last=MO.TObjects_last;this.at=this.getAt=MO.TObjects_getAt;this.get=MO.TObjects_get;this.setAt=MO.TObjects_setAt;this.set=MO.TObjects_set;this.assign=MO.TObjects_assign;this.append=MO.TObjects_append;this.insert=MO.TObjects_insert;this.shift=MO.TObjects_shift;
this.unshift=MO.TObjects_unshift;this.pop=MO.TObjects_pop;this.push=MO.TObjects_push;this.pushUnique=MO.TObjects_pushUnique;this.swap=MO.TObjects_swap;this.sort=MO.TObjects_sort;this.erase=MO.TObjects_erase;this.remove=MO.TObjects_remove;this.clear=MO.TObjects_clear;this.dispose=MO.TObjects_dispose;this.dump=MO.TObjects_dump;return this};MO.TObjects_isEmpty=function(){return 0==this._count};MO.TObjects_count=function(){return this._count};MO.TObjects_items=function(){return this._items};
MO.TObjects_contains=function(b){return-1!=this.indexOf(b)};MO.TObjects_indexOf=function(b){for(var d=this._count,f=this._items,h=0;h<d;h++)if(f[h]==b)return h;return-1};MO.TObjects_first=function(){return this._count?this._items[0]:null};MO.TObjects_last=function(){return this._count?this._items[this._count-1]:null};MO.TObjects_getAt=function(b){return this._items[b]};MO.TObjects_get=function(b){return 0<=b&&b<this._count?this._items[b]:null};MO.TObjects_setAt=function(b,d){this._items[b]=d};
MO.TObjects_set=function(b,d){var f=this._items;0<=b&&b<this._count&&(f[b]=d)};MO.TObjects_assign=function(b){var d=this._items,f=this._count=b.count();b=b.items();for(var h=0;h<f;h++)d[h]=b[h]};MO.TObjects_append=function(b){for(var d=b.count(),f=0;f<d;f++)this.push(b.at(f))};MO.TObjects_insert=function(b,d){var f=this._count,h=this._items;if(0<=b&&b<=f){for(;f>b;f--)h[f]=h[f-1];h[b]=d;this._count++}};MO.TObjects_shift=function(){return this.erase(0)};
MO.TObjects_unshift=function(b){return this.insert(0,b)};MO.TObjects_pop=function(){if(this._count)return this._items[--this._count]};MO.TObjects_push=function(b){var d=this._count++;this._items[d]=b;return d};MO.TObjects_pushUnique=function(b){for(var d=this._items,f=this._count-1;0<=f;f--)if(d[f]==b)return f;f=this._count++;d[f]=b;return f};MO.TObjects_swap=function(b,d){if(0<=b&&b<this._count&&0<=d&&d<this._count&&b!=d){var f=this._items,h=f[b];f[b]=f[d];f[d]=h}};
MO.TObjects_sort=function(b){var d=this._items;d.length!=this._count&&(d.length=this._count);d.sort(b)};MO.TObjects_erase=function(b){var d=null;if(0<=b&&b<this._count){for(var f=this._items,d=f[b],h=--this._count;b<h;b++)f[b]=f[b+1];f[h]=null}return d};MO.TObjects_remove=function(b){var d=this._count;if(d){for(var f=0,h=this._items,q=f;q<d;q++)h[q]!=b&&(h[f++]=h[q]);for(q=f;q<d;q++)h[q]=null;this._count=f}return b};MO.TObjects_clear=function(){this._count=0};
MO.TObjects_dispose=function(){var b=this._items,d;for(d in b)b[d]=null;this._count=0;this._items=null};MO.TObjects_dump=function(){var b=othis._count,d=new MO.TString;d.append(MO.Runtime.className(this),":",b);if(b)for(var f=0;f<b;f++)d.append(" [",this._items[f],"]");return d.flush()};
MO.TString=function(){this._count=0;this._memory=[];this.isEmpty=MO.TString_isEmpty;this.assign=MO.TString_assign;this.append=MO.TString_append;this.appendIf=MO.TString_appendIf;this.appendArray=MO.TString_appendArray;this.appendLine=MO.TString_appendLine;this.appendRepeat=MO.TString_appendRepeat;this.push=MO.TString_push;this.clear=MO.TString_clear;this.toString=MO.TString_toString;this.flush=MO.TString_flush;this.dispose=MO.TString_dispose;this.dump=MO.TString_dump;return this};
MO.TString_isEmpty=function(){return 0==this._count};MO.TString_assign=function(){this.clear();this.appendArray(arguments,0,arguments.length)};MO.TString_append=function(b){this.appendArray(arguments,0,arguments.length)};MO.TString_appendIf=function(b){b&&this.appendArray(arguments,1,arguments.length-1)};MO.TString_appendArray=function(b,d,f){for(var h=this._memory,q=0;q<f;q++){var w=b[d++];null!=w&&(h[this._count++]=w)}};
MO.TString_appendRepeat=function(b,d){for(var f=this._memory,h=0;h<d;h++)f[this._count++]=b};MO.TString_appendLine=function(){this.appendArray(arguments,0,arguments.length);this._memory[this._count++]="\r\n"};MO.TString_push=function(){this.appendArray(arguments,0,arguments.length)};MO.TString_clear=function(){this._count=0};MO.TString_toString=function(){var b=this._memory;b.length!=this._count&&(b=b.slice(0,this._count));return b.join("")};
MO.TString_flush=function(){var b=this.toString();this.dispose();return b};MO.TString_dispose=function(){this._count=0;var b=this._memory;if(b){for(var d=b.length-1;0<=d;d--)b[d]=null;this._memory=null}};MO.TString_dump=function(){var b=this.toString();return MO.Runtime.className(o)+":"+b.length+"["+b+"]"};MO.RAssert=function(){var b=MO.RSingleton.call(this);b.debugBegin=MO.Runtime.empty;b.debug=MO.Runtime.empty;b.debugEnd=MO.Runtime.empty;return b};
MO.RAssert.prototype.isTrue=function(b){if(!b)throw Error("Assert ture failure.");};MO.RAssert.prototype.isFalse=function(b){if(b)throw Error("Assert false failure.");};MO.RAssert.prototype.debugTrue=function(b){if(!b)throw Error("Assert true failure.");};MO.RAssert.prototype.debugFalse=function(b){if(b)throw Error("Assert false failure.");};MO.RAssert.prototype.debugNull=function(b){if(null!=b)throw Error("Assert null failure.");};
MO.RAssert.prototype.debugNotNull=function(b){if(null==b)throw Error("Assert not null failure.");};MO.RAssert.prototype.debugEmpty=function(b){if(null!=b)throw Error("Assert empty failure.");};MO.RAssert.prototype.debugNotEmpty=function(b){if(null==b)throw Error("Assert not empty failure.");};MO.Assert=new MO.RAssert;MO.RMemory=function(){var b=MO.RSingleton.call(this);b._entryUnused=null;b._pools={};return b};
MO.RMemory.prototype.entryAlloc=function(){var b=null,d=this._entryUnused;d?(b=d,this._entryUnused=d.next):b=new MO.SMemoryPoolEntry;return b};MO.RMemory.prototype.entryFree=function(b){b.next=this._entryUnused;this._entryUnused=b};MO.RMemory.prototype.alloc=function(b){var d=MO.Runtime.className(b),f=this._pools,h=f[d];h||(h=new MO.TMemoryPool,h._constructor=b,f[d]=h);return h.alloc()};MO.RMemory.prototype.free=function(b){b.__pool.free(b);b.free&&b.free()};MO.RMemory.prototype.refresh=function(){CollectGarbage()};
MO.Memory=new MO.RMemory;MO.SMemoryPoolEntry=function(){this.value=this.next=null;this.dispose=MO.SMemoryPoolEntry_dispose;return this};MO.SMemoryPoolEntry_dispose=function(){var b=this.value;b&&(b.__pool=null,b.dispose());this.value=this.next=null};MO.TMemoryPool=function(){this._unused=this._constructor=null;this._freeCount=this._allocCount=this._createCount=0;this.alloc=MO.TMemoryPool_alloc;this.free=MO.TMemoryPool_free;this.dispose=MO.TMemoryPool_dispose;this.dump=MO.TMemoryPool_dump;return this};
MO.TMemoryPool_alloc=function(){var b=null,d=this._unused;d?(b=d.value,this._unused=d.next,MO.Memory.entryFree(d)):(b=new this._constructor,b.__pool=this,this._createCount++);this._allocCount++;return b};MO.TMemoryPool_free=function(b){var d=MO.Memory.entryAlloc();d.value=b;d.next=this._unused;this._unused=d;this._freeCount++};MO.TMemoryPool_dispose=function(){for(var b=this._unused;b;){var d=b,b=d.next;d.dispose();MO.Memory.entryFree(d)}};
MO.TMemoryPool_dump=function(){var b=new MO.TString;b.append("Pool:");b.append("create=",this._createCount);b.append(", alloc=",this._allocCount);b.append(", free=",this._freeCount);return b.flush()};MO.SLooperEntry=function(){this.value=this.next=this.prior=null;this.dispose=MO.SLooperEntry_dispose;return this};MO.SLooperEntry_dispose=function(){this.value=this.next=this.prior=null};
MO.TLooper=function(){this._recordCount=this._count=0;this._current=null;this.innerPush=MO.TLooper_innerPush;this.innerRemove=MO.TLooper_innerRemove;this.innerRemoveCurrent=MO.TLooper_innerRemoveCurrent;this.innerRemoveValue=MO.TLooper_innerRemoveValue;this.isEmpty=MO.TLooper_isEmpty;this.count=MO.TLooper_count;this.record=MO.TLooper_record;this.unrecord=MO.TLooper_unrecord;this.contains=MO.TLooper_contains;this.current=MO.TLooper_current;this.next=MO.TLooper_next;this.push=MO.TLooper_push;this.pushUnique=
MO.TLooper_pushUnique;this.removeCurrent=MO.TLooper_removeCurrent;this.remove=MO.TLooper_remove;this.clear=MO.TLooper_clear;this.dispose=MO.TLooper_dispose;this.dump=MO.TLooper_dump;return this};MO.TLooper_innerPush=function(b){var d=this._current;if(d){var f=d.prior;b.prior=f;b.next=d;f.next=b;d.prior=b}else b.prior=b,this._current=b.next=b;this._count++};MO.TLooper_innerRemove=function(b){var d=b.prior,f=b.next;d.next=f;f.prior=d;this._count--;this._current=0<this._count?f:null;MO.Memory.free(b)};
MO.TLooper_innerRemoveCurrent=function(){var b=null;if(0<this._count){var d=this._current,b=d.value;this.innerRemove(d)}return b};MO.TLooper_innerRemoveValue=function(b){if(0<this._count)if(this._current.value==b)this.innerRemoveCurrent();else for(var d=this._current,f=d.next;f!=d;){if(f.value==b){this.innerRemove(f);this._current=d;break}f=f.next}};MO.TLooper_isEmpty=function(){return 0==this._count};MO.TLooper_count=function(){return this._count};MO.TLooper_record=function(){this._recordCount=this._count};
MO.TLooper_unrecord=function(b){this._recordCount=-1};MO.TLooper_contains=function(b){if(this._current)for(var d=this._current,f=this._count,h=0;h<f;h++){if(d.value==b)return!0;d=d.next}return!1};MO.TLooper_current=function(){var b=this._current;return b?b.value:null};MO.TLooper_next=function(){this._current&&(this._current=this._current.next);var b=this._recordCount;if(0<b)this._recordCount--;else if(0==b)return null;return this._current?this._current.value:null};
MO.TLooper_push=function(b){var d=MO.Memory.alloc(MO.SLooperEntry);d.value=b;this.innerPush(d)};MO.TLooper_pushUnique=function(b){this.contains(b)||this.push(b)};MO.TLooper_removeCurrent=function(){return this.innerRemoveCurrent()};MO.TLooper_remove=function(b){this.innerRemoveValue(b)};MO.TLooper_clear=function(){var b=this._current;if(b)for(b.prior.next=null;b;)b=b.next,MO.Memory.free(b);this._count=0;this._current=null};MO.TLooper_dispose=function(){this.clear()};
MO.TLooper_dump=function(){var b=this._count,d=new MO.TString;d.append(MO.Class.name(this),": ",b);if(0<b)for(var f=this._current,h=0;h<b;h++)d.append(" [",f.value,"]"),f=f.next;return d.flush()};MO.RGlobal=function(){var b=MO.RSingleton.call(this);b._instances=new MO.TDictionary;return b};MO.RGlobal.prototype.get=function(b){return this._instances.get(b)};MO.RGlobal.prototype.set=function(b,d){this._instances.set(b,d)};
MO.RGlobal.prototype.globalGet=function(b){var d=null;return d=top.MO.Global?top.MO.Global.get(b):this._instances.get(b)};MO.RGlobal.prototype.globalSet=function(b,d){top.MO.Global?top.MO.Global.set(b,d):this._instances.set(b,d)};MO.Global=new MO.RGlobal;MO.AAnnotation=function(b){this._annotationCd=null;this._duplicate=this._inherit=!1;this._name=b;this.annotationCd=MO.AAnnotation_annotationCd;this.name=MO.AAnnotation_name;this.code=MO.AAnnotation_code;this.value=MO.AAnnotation_value;return this};
MO.AAnnotation_annotationCd=function(){return this._annotationCd};MO.AAnnotation_name=function(){return this._name};MO.AAnnotation_code=function(){return this._name};MO.AAnnotation_value=function(){return null};MO.AEnum=function(b,d){this.inherit=!0;this.annotation=MO.EAnnotation.Enum;this.name=b;this.linker=d;return this};MO.AGetSet=function(b,d){MO.ASource.call(this,b,MO.ESource.GetSet,d);this.build=MO.AGetSet_build;return this};
MO.AGetSet_build=function(b,d){var f=this._code;d[f]=MO.Method.makePropertyGet(this._name,f);f="set"+this._linker;d[f]=MO.Method.makePropertySet(this._name,f)};MO.AGetter=function(b,d){MO.ASource.call(this,b,MO.ESource.Get,d);this._linker=d;this.build=MO.AGetter_build;return this};MO.AGetter_build=function(b,d){var f=this._linker?this._linker:this._code;d[f]=MO.Method.makePropertyGet(this._name,f)};
MO.AGetterSource=function(b,d){MO.ASource.call(this,b,MO.ESource.Get,d);this._linker=d;this.build=MO.AGetterSource_build;return this};MO.AGetterSource_build=function(b,d){var f=this._linker?this._linker:this._code;d[f]=MO.Method.makePropertyGetSource(this._name,f)};MO.ALinker=function(b,d){this.inherit=!0;this.annotation=MO.EAnnotation.Linker;this.name=b;this.linker=d;return this};
MO.AProperty=function(b,d){MO.AAnnotation.call(this,b);this._inherit=!0;this._annotationCd=MO.EAnnotation.Property;this._linker=null;this._force=!1;this.code=MO.AProperty_code;this.build=MO.AProperty_build;this.load=MO.AProperty_load;this.save=MO.AProperty_save;this.toString=MO.AProperty_toString;var f=null;null==d?(f=MO.Lang.String.startsWith(b,"_")?b.substring(1):b,f=MO.Lang.String.toUnderline(f)):f=d;this._linker=f;return this};MO.AProperty_code=function(){return this._linker};
MO.AProperty_build=function(){};MO.AProperty_load=function(b,d){b[this._name]=d.get(this._linker)};MO.AProperty_save=function(b,d){d.set(this._linker,b[this._name])};MO.AProperty_toString=function(){return"<"+this._annotationCd+",linker="+this._linker+">"};MO.ASetter=function(b,d){MO.ASource.call(this,b,MO.ESource.Set,d);this.build=MO.ASetter_build;return this};MO.ASetter_build=function(b,d){var f="set"+this._linker;d[f]=MO.Method.makePropertySet(this._name,f)};
MO.ASource=function(b,d,f){MO.AAnnotation.call(this,b);this._inherit=!1;this._annotationCd=MO.EAnnotation.Source;this._typeCd=d;this._linker=this._code=null;this.build=MO.ASource_build;this.toString=MO.ASource_toString;b=this._name;MO.Lang.String.startsWith(b,"_")&&(b=b.substring(1));this._code=b;this._linker=null==f?MO.Lang.String.firstUpper(b):f;return this};MO.ASource_build=function(){};MO.ASource_toString=function(){return"<"+this._annotationCd+",linker="+this._linker+">"};
MO.EAnnotation=new function(){this.Source="source";this.Property="property";this.Event="enum";this.Event="event";this.Linker="linker";this.Style="style";this.StyleIcon="icon";return this};MO.EBoolean=new function(){this.True="Y";this.False="N";return this};MO.ECharCase=new function(){this.Upper="U";this.Lower="L";this.Word="W";return this};
MO.EDataType=new function(){this.Unknown=0;this.Int8=1;this.Int16=2;this.Int32=3;this.Int64=4;this.Uint8=5;this.Uint16=6;this.Uint32=7;this.Uint64=8;this.Float16=9;this.Float32=10;this.Float64=11;this.String=12;return this};MO.EEndian=new function(){this.Big=0;this.Little=1;return this};MO.ENodeType=new function(){this.Node=1;this.Text=3;this.Data=4;return this};
MO.ENumber=new function(){this.Integer="I";this.PositiveInteger="PI";this.NegativeInteger="NI";this.Float="F";this.PositiveFloat="PF";this.NegativeFloat="NF";return this};MO.ERegExp=new function(){this.I=/^-?[1-9]\d*|0$/;this.PI=/^[1-9]\d*$/;this.NI=/^-[1-9]\d*$/;this.F=/^-?([1-9]\d*\.\d*|0\.\d*[1-9]\d*|0?\.0+|0)$/;this.PF=/^[1-9]\d*\.\d*|0\.\d*[1-9]\d*$/;this.NF=/^-([1-9]\d*\.\d*|0\.\d*[1-9]\d*)$/;this.U=/[1-9]{1}[0-9]/;this.E=/^\w{1,}[@]{1}[a-zA-Z]{1,}[.]{1}[a-zA-Z]{1,}$/;return this};
MO.EResult=new function(){this.Success=0;this.Continue=1;this.Skip=2;this.Finish=3;this.Failure=-1;this.Cancel=-2;return this};MO.ESource=new function(){this.Get="get";this.Set="set";this.GetSet="getset";this.Listener="listener";return this};MO.MInstance=function(b){b=MO.Class.inherits(this,b);b.__free=!1;b.instanceCreate=MO.Method.empty;b.instanceAlloc=MO.Method.empty;b.instanceFree=MO.Method.empty;b.instanceRelease=MO.Method.empty;return b};
MO.MInvoke=function(b){b=MO.Class.inherits(this,b);b.invoke=MO.Method.virtual(b,"invoke");return b};MO.MPoolAble=function(b){b=MO.Class.inherits(this,b);b._poolCode=MO.Class.register(b,new MO.AGetSet("_poolCode"));return b};MO.SArguments=function(){this.owner=null;return this};MO.SEnumItem=function(){this.name=null;this.value=0;return this};
MO.TClass=function(){this.__disposed=!0;this._unused=null;this._annotations={};this._attributes={};this.instance=this.clazz=this.base=this.parent=this.name=null;this._abstract=!1;this.styles=[];this.instances=[];this.register=MO.TClass_register;this.assign=MO.TClass_assign;this.annotations=MO.TClass_annotations;this.annotation=MO.TClass_annotation;this.annotationFind=MO.TClass_annotationFind;this.attributeFind=MO.TClass_attributeFind;this.style=MO.TClass_style;this.build=MO.TClass_build;this.newInstance=
MO.TClass_newInstance;this.free=MO.TClass_free;this.alloc=MO.TClass_alloc;return this};
MO.TClass_register=function(b){var d=b.annotationCd(),f=b.name(),h=b.code();if(!d||!h)throw new MO.TError(this,"Unknown annotation. (class={1},annotation={2},name={3},code={4})",MO.Class.dump(this),d,f,h);var q=this._annotations[d];q||(q=this._annotations[d]={});if(!b._duplicate&&q[h])throw new MO.TError(this,"Duplicate annotation. (class={1},annotation={2},name={3},code={4},value={5})",MO.Class.dump(this),d,f,h,b.toString());q[h]=b;this._attributes[f]=b};
MO.TClass_assign=function(b){for(var d in b._annotations){var f=this._annotations[d];f||(f=this._annotations[d]={});var h=b._annotations[d],q;for(q in h){var w=h[q];if(!w._duplicate&&f[q])throw new MO.TError(this,"Duplicate annotation. (annotation={1}, {2}.{3}={4}.{5}, source={6})",an,this.name,n,b.name,n,w.toString());w._inherit&&(f[q]=w)}}for(q in b._attributes)b._attributes[q].construct!=Function&&(this._attributes[q]=b._attributes[q])};
MO.TClass_annotations=function(b){var d=this._annotations[b];d||MO.Logger.fatal(this,null,"Can't find annotations. (annotation={1}, class={2})",b,this.name);return d};MO.TClass_annotation=function(b,d){var f=null,h=this._annotations[b];h&&(f=h[d]);f||MO.Logger.fatal(this,null,"Can't find annotation. (annotation={1}, name={2}, class={3})",b,d,this.name);return f};MO.TClass_annotationFind=function(b){for(var d in this._annotations){var f=this._annotations[d];if(f&&(f=f[b],null!=f&&f.constructor!=Function))return f}return null};
MO.TClass_attributeFind=function(b){return(b=this._attributes[b])&&b.constructor!=Function?b:null};MO.TClass_style=function(b){if(this.styles[b])return this.styles[b];for(var d=null,f=this;f;){var h=f._annotations[MO.EAnnotation.Style];if(h&&(d=h[b]))break;f=f.parent}d||MO.Logger.fatal(this,null,"No register style annotation. (name={1}, linker={2}, class={3})",this.name+"_"+b,this.liner,this.name);d=f.name+"_"+d.style();return this.styles[b]=d};
MO.TClass_build=function(){var b=this.instance,d;for(d in b){var f=b[d];if(null!=f&&f.constructor==Function&&f.__virtual){this._abstract=!0;break}}if(f=this._annotations[MO.EAnnotation.Property])for(d in f)f[d].build(b);if(f=this._annotations[MO.EAnnotation.Source])for(d in f)f[d].build(this,b)};
MO.TClass_newInstance=function(){var b=this.alloc();if(!b){if(this._abstract){var b=new MO.TString,d;for(d in this.instance){var f=this.instance[d];MO.Method.isVirtual(f)&&(b.isEmpty()||b.append(","),b.append(f._name))}throw new MO.TError(this,"Abstract Class can't be create.(name={1})\n[{2}]",this.name,b);}var h=this.instance;if(!h)return MO.Logger.fatal(this,null,"Class instance is empty. (name={1})",this.name);b=new h.constructor;for(d in h){f=h[d];if(null!=f){if("__base"==d||"__inherits"==d){b[d]=
h[d];continue}MO.Class.isBase(f)||(f=MO.Lang.Object.clone(f))}b[d]=f}b.__class=this;b.construct&&b.construct()}return b};MO.TClass_alloc=function(){var b=this._unused;b&&(this._unused=b.cnext,b.cnext=null,b._using=!0);return b};MO.TClass_free=function(b){if(b._using){b.cnext=this._unused;this._unused=b;b._using=!1;for(var d in b){var f=b[d];if(f&&!RClass.isBase(f))if(f._class)this.free(f);else if(this.isClass(f,Array))for(var h=0;h<f.length;h++){var q=f[h];q._class&&this.free(q)}}}};
MO.TClassBase=function(){this.__disposed=!0;return this};MO.TContext=function(b,d,f){this.name=b;this.code=d;this.text=f;return this};
MO.TDataset=function(){this._code=null;this._pageSize=20;this._total=this._pageCount=this._pageIndex=0;this._rows=new MO.TObjects;this.isEmpty=MO.TDataset_isEmpty;this.createRow=MO.TDataset_createRow;this.count=MO.TDataset_count;this.row=MO.TDataset_row;this.rows=MO.TDataset_rows;this.find=MO.TDataset_find;this.push=MO.TDataset_push;this.loadConfig=MO.TDataset_loadConfig;this.clear=MO.TDataset_clear;return this};MO.TDataset_isEmpty=function(){return this._rows.isEmpty()};
MO.TDataset_createRow=function(){var b=new MO.TRow;b._dataset=this;this._rows.push(b);return b};MO.TDataset_count=function(){return this._rows.count()};MO.TDataset_row=function(b){return this._rows.get(b)};MO.TDataset_rows=function(){return this._rows};MO.TDataset_find=function(b){var d=arguments,f=d.length;if(0!=f%2)throw new MO.TError(this,"Parameters must is pairs (length={1})",f);for(var h=this._rows,q=h.count(),w=0;w<q;w++){for(var z=h.get(w),A=!0,B=0;B<f;B+=2)if(z.get(d[w])!=d[w+1]){A=!1;break}if(A)return z}return null};
MO.TDataset_push=function(b){this._rows.push(b)};MO.TDataset_loadConfig=function(b){this._code=b.get("name");this._pageSize=MO.Lang.Integer.parse(b.get("page_size",1E3));this._pageIndex=MO.Lang.Integer.parse(b.get("page",0));this._pageCount=MO.Lang.Integer.parse(b.get("page_count",1));this._total=MO.Lang.Integer.parse(b.get("total"));if(b=b.nodes())for(var d=b.count(),f=0;f<d;f++){var h=b.get(f);h.isName("Row")&&this.createRow().loadConfig(h)}};
MO.TDataset_clear=function(){this._pageSize=20;this._total=this._pageCount=this._pageIndex=0;this._rows.clear()};MO.TDataset_findIndex=function(b){for(var d=this._rows,f=d.count(),h=0;h<f;h++){var q=d.get(h);if(q._index=b)return q}return null};MO.TDataset_remove=function(b){return this._rows.remove(b)};MO.TDataset_removeRow=function(b){b=this.indexOf(b);-1!=b&&this._rows.remove(b)};
MO.TDataset_saveViewer=function(b){b.datasetName=this._code;b.datasetId=this.id;b.position=0;b.start=0;b._count=this._rows._count;b._rows=this._rows;b.dataset=this};MO.TDataset_pack=function(){for(var b=this._rows,d=new MO.TStrings,f=0;f<b._count;f++)d.push(b.get(f).pack());return d.pack()};
MO.TDataset_dump=function(){var b=new MO.TString;b.append(MO.Class._code(this));b.append(" count=",this._count);b.append(" fields=",this.fieldCount);b.appendLine();if(this._rows)for(var d=this._count,f=0;f<d;f++)b.append("- "),this._rows.get(f).dump(s),f!=this._count-1&&b.appendLine();return b.toString()};
MO.TDatasetViewer=function(){this._datasetId=null;this._count=this._start=this._position=0;this._ouids=this._rows=e._values=null;this.isEmpty=MO.TDatasetViewer_isEmpty;this.count=MO.TDatasetViewer_count;this.current=MO.TDatasetViewer_current;this.reset=MO.TDatasetViewer_reset;this.move=MO.TDatasetViewer_move;this.moveToRow=MO.TDatasetViewer_moveToRow;this.first=MO.TDatasetViewer_first;this.prior=MO.TDatasetViewer_prior;this.next=MO.TDatasetViewer_next;this.last=MO.TDatasetViewer_last;return this};
MO.TDatasetViewer_isEmpty=function(){return null==this._count};MO.TDatasetViewer_count=function(){return this._count};MO.TDatasetViewer_current=function(){var b=this._rows;return b?b.get(this._position-this._start):null};MO.TDatasetViewer_reset=function(){this._position=-1};MO.TDatasetViewer_move=function(b){this._position=b};MO.TDatasetViewer_moveToRow=function(b){b=this._rows.indexOf(b);-1!=b&&(this._position=b-this._start)};MO.TDatasetViewer_first=function(b){this._position=b?-1:0};
MO.TDatasetViewer_prior=function(){return 0<this._position?(this._position--,!0):!1};MO.TDatasetViewer_next=function(){return this._position<this._count-1?(this._position++,!0):!1};MO.TDatasetViewer_last=function(){this._position=this._count-1};
MO.TDate=function(b){this.date=b?b:new Date;this.ms=this.second=this.minute=this.hour=this.day=this.month=this.year=null;this.equals=MO.TDate_equals;this.isBefore=MO.TDate_isBefore;this.isAfter=MO.TDate_isAfter;this.monthDays=MO.TDate_monthDays;this.monthWeekDay=MO.TDate_monthWeekDay;this.weekDay=MO.TDate_weekDay;this.assign=MO.TDate_assign;this.refresh=MO.TDate_refresh;this.setYear=MO.TDate_setYear;this.setMonth=MO.TDate_setMonth;this.setDay=MO.TDate_setDay;this.setHour=MO.TDate_setHour;this.setMinute=
MO.TDate_setMinute;this.setSecond=MO.TDate_setSecond;this.setDate=MO.TDate_setDate;this.setNow=MO.TDate_setNow;this.addYear=MO.TDate_addYear;this.addMonth=MO.TDate_addMonth;this.addDay=MO.TDate_addDay;this.addHour=MO.TDate_addHour;this.addMinute=MO.TDate_addMinute;this.addSecond=MO.TDate_addSecond;this.add=MO.TDate_add;this.truncDay=MO.TDate_truncDay;this.truncHour=MO.TDate_truncHour;this.truncMinute=MO.TDate_truncMinute;this.truncSecond=MO.TDate_truncSecond;this.trunc=MO.TDate_trunc;this.get=MO.TDate_get;
this.set=MO.TDate_set;this.parse=MO.TDate_parse;this.parseAuto=MO.TDate_parseAuto;this.format=MO.TDate_format;this.clone=MO.TDate_clone;this.dump=MO.TDate_dump;this.refresh();return this};MO.TDate_equals=function(b){return this.date.getTime()==b.date.getTime()};MO.TDate_isBefore=function(b){return this.date.getTime()<b.date.getTime()};MO.TDate_isAfter=function(b){return this.date.getTime()>b.date.getTime()};MO.TDate_monthDays=function(){return RDate.monthDays(this.year,this.month)};
MO.TDate_monthWeekDay=function(){return(8-(this.day-this.weekDay())%7)%7};MO.TDate_assign=function(b){this.date.setTime(b.date.getTime());this.refresh()};MO.TDate_refresh=function(){var b=this.date;b&&(this.year=b.getFullYear(),this.month=b.getMonth()+1,this.day=b.getDate(),this.hour=b.getHours(),this.minute=b.getMinutes(),this.second=b.getSeconds(),this.ms=b.getMilliseconds())};MO.TDate_weekDay=function(){return this.date.getDay()};MO.TDate_setYear=function(b){this.date.setFullYear(b);this.refresh()};
MO.TDate_setMonth=function(b){this.date.setMonth(parseInt(b,10)-1);this.refresh()};MO.TDate_setDay=function(b){this.date.setDate(b);this.refresh()};MO.TDate_setHour=function(b){this.date.setHours(b);this.refresh()};MO.TDate_setMinute=function(b){this.date.setMinutes(b);this.refresh()};MO.TDate_setSecond=function(b){this.date.setSeconds(b);this.refresh()};MO.TDate_setDate=function(b){this.date=b;this.refresh()};MO.TDate_setNow=function(){this.date=new Date;this.refresh()};
MO.TDate_addYear=function(b){var d=this.date.getFullYear();this.date.setFullYear(d+MO.Lang.Integer.nvl(b,1));this.refresh()};MO.TDate_addMonth=function(b){var d=this.date.getMonth();this.date.setMonth(d+MO.Lang.Integer.nvl(b,1));this.refresh()};MO.TDate_addDay=function(b){b=this.date.getTime()+864E5*MO.Lang.Integer.nvl(b,1);this.date.setTime(b);this.refresh()};MO.TDate_addHour=function(b){b=this.date.getTime()+36E5*MO.Lang.Integer.nvl(b,1);this.date.setTime(b);this.refresh()};
MO.TDate_addMinute=function(b){b=this.date.getTime()+6E4*MO.Lang.Integer.nvl(b,1);this.date.setTime(b);this.refresh()};MO.TDate_addSecond=function(b){b=this.date.getTime()+1E3*MO.Lang.Integer.nvl(b,1);this.date.setTime(b);this.refresh()};MO.TDate_add=function(b){b=this.date.getTime()+MO.Lang.Integer.nvl(b,1);this.date.setTime(b);this.refresh()};MO.TDate_truncDay=function(b){var d=this.date.getTime();b=d-d%(864E5*MO.Lang.Integer.nvl(b,1));this.date.setTime(b);this.refresh()};
MO.TDate_truncHour=function(b){var d=this.date.getTime();b=d-d%(36E5*MO.Lang.Integer.nvl(b,1));this.date.setTime(b);this.refresh()};MO.TDate_truncMinute=function(b){var d=this.date.getTime();b=d-d%(6E4*MO.Lang.Integer.nvl(b,1));this.date.setTime(b);this.refresh()};MO.TDate_truncSecond=function(b){var d=this.date.getTime();b=d-d%(1E3*MO.Lang.Integer.nvl(b,1));this.date.setTime(b);this.refresh()};
MO.TDate_trunc=function(b){var d=this.date.getTime();b=d-d%MO.Lang.Integer.nvl(b,1);this.date.setTime(b);this.refresh()};MO.TDate_get=function(b){return this.date.getTime()};MO.TDate_set=function(b){this.date.setTime(b);this.refresh()};MO.TDate_parse=function(b,d){return MO.Lang.Date.parse(this,b,d)};MO.TDate_parseAuto=function(b){return MO.Lang.Date.autoParse(this,b)};MO.TDate_format=function(b){return MO.Lang.Date.formatDate(this,b)};
MO.TDate_clone=function(){var b=new Date;b.setTime(this.date.getTime());return new MO.TDate(b)};MO.TDate_dump=function(){return MO.Class.dump(this)+" "+MO.Lang.Date.formatDate(this)};
MO.TError=function(b,d,f){for(var h=new MO.TString,q=MO.TError.caller,w=new MO.TString,z=[];q&&!MO.Lang.Array.contains(z,q);)z.push(q),q=q.caller;for(var A=z.length,B=0;B<A;B++)q=z[B],0<B&&w.appendLine(),w.append("   "+(A-B)+": "+MO.Method.name(q));q=arguments;A=q.length;for(B=2;B<A;B++){var z=q[B],C=null,C="function"==typeof z?MO.Method.name(z):z;d=d.replace("{"+(B-1)+"}",C)}h.appendLine(d);h.appendLine("------------------------------------------------------------");h.append(w);h=h.flush();alert(h)};
MO.TFatalError=function TFatalError(d,f,h,q){for(var w=new MO.TString,z=TFatalError.caller,A=new MO.TString,B=[];z&&!MO.Lang.Array.contains(B,z);)B.push(z),z=z.caller;for(var C=B.length,D=0;D<C;D++)z=B[D],0<D&&A.appendLine(),A.append("   "+(C-D)+": "+MO.Method.name(z));z=arguments;C=z.length;for(D=2;D<C;D++){var B=z[D],E=null,E="function"==typeof B?MO.Method.name(B):B;h=h.replace("{"+(D-1)+"}",E)}w.appendLine(h);w.appendLine("------------------------------------------------------------");w.append(A);
throw Error(w);};MO.TInstancePool=function(){MO.TObjects.call(this);this._instance=null;this.instance=MO.TInstancePool_instance;this.alloc=MO.TInstancePool_alloc;this.free=MO.TInstancePool_free;return this};MO.TInstancePool_instance=function(b){var d=this._instance;null==d&&(d=this._instance=MO.Class.create(b),d.instanceCreate());d.instanceAlloc();return d};MO.TInstancePool_alloc=function(b){var d=null;0==this._count?(d=MO.Class.create(b),d.instanceCreate()):d=this.pop();d.instanceAlloc();return d};
MO.TInstancePool_free=function(b){b.instanceFree();return this.push(b)};MO.TInvoke=function(){this.callback=this.owner=null;this.invoke=MO.TInvoke_invoke;return this};MO.TInvoke_invoke=function(b,d,f,h,q,w){if(this.callback){var z=this.owner?this.owner:this;try{this.callback.call(z,b,d,f,h,q,w)}catch(A){MO.Logger.fatal(this,A,"Call method failure. (owner={1}, callback={2})",z,this.callback)}}};
MO.TListener=function(){this._callback=this._owner=null;this.process=MO.TListener_process;this.toString=MO.TListener_toString;this.dispose=MO.TListener_dispose;return this};MO.TListener_process=function(b,d,f,h,q,w){this._callback.call(this._owner?this._owner:this,b,d,f,h,q,w)};MO.TListener_toString=function(){return MO.Class.name(this)+"(owner="+MO.Class.name(this._owner)+", callback="+MO.Method.name(this._callback)+")"};MO.TListener_dispose=function(){this._callback=this._owner=null;MO.Lang.Object.free(this)};
MO.TListeners=function(){this._listeners=null;this.isEmpty=MO.TListeners_isEmpty;this.find=MO.TListeners_find;this.register=MO.TListeners_register;this.unregister=MO.TListeners_unregister;this.push=MO.TListeners_push;this.remove=MO.TListeners_remove;this.process=MO.TListeners_process;this.clear=MO.TListeners_clear;this.dispose=MO.TListeners_dispose;this.dump=MO.TListeners_dump;return this};MO.TListeners_isEmpty=function(){var b=this._listeners;return b?b.isEmpty():!0};
MO.TListeners_find=function(b,d){var f=this._listeners;if(f)for(var h=f.count(),q=0;q<h;q++){var w=f.getAt(q);if(w._owner==b&&w._callback==d)return w}return null};MO.TListeners_register=function(b,d){var f=this.find(b,d);if(f)throw new MO.TError(this,"Listener is already register. (owner={1}, process={2})",b,d);f=new MO.TListener;f._owner=b;f._callback=d;this.push(f);return f};
MO.TListeners_unregister=function(b,d){var f=this.find(b,d);if(!f)throw new MO.TError(this,"Listener is not register. (owner={1}, process={2})",b,d);this.remove(f);f.dispose()};MO.TListeners_push=function(b){if(!b)throw new MO.TError(this,"Listener is null.");if(!b._callback)throw new MO.TError(this,"Listener process is null.");var d=this._listeners;d||(d=this._listeners=new MO.TObjects);d.push(b)};MO.TListeners_remove=function(b){if(!b)throw new MO.TError(this,"Listener is null.");this._listeners.remove(b)};
MO.TListeners_process=function(b,d,f,h,q,w){var z=this._listeners;if(z)for(var A=z.count(),B=0;B<A;B++)z.getAt(B).process(b,d,f,h,q,w)};MO.TListeners_clear=function(){var b=this._listeners;b&&b.clear()};MO.TListeners_dispose=function(){var b=this._listeners;if(b){for(var d=b.count()-1;0<=d;d--)b.getAt(d).dispose();this._listeners=MO.Lang.Object.dispose(b)}MO.Lang.Object.free(this)};
MO.TListeners_dump=function(){var b=new MO.TString;b.append(MO.Class.name(this));for(var d=this._listeners,f=d.count(),h=0;h<f;h++)b.append("\n   "+d.getAt(h));return b.flush()};MO.TLoaderListener=function(){this.invoke=null;this.ids=new MO.TArray;this.check=MO.TLoaderListener_check;return this};MO.TLoaderListener_check=function(b){var d=this.ids;if(!d.isEmpty())for(var f=d.length,h=0;h<f;h++)if(!b.contains(d.get(h)))return!1;return!0};
MO.TLocker=function(){this._lock=!1;this.enter=MO.TLocker_enter;this.leave=MO.TLocker_leave;return this};MO.TLocker_enter=function(){this._lock=!0};MO.TLocker_leave=function(){this._lock=!1};MO.TMessage=function(){this.typeCd=MO.EMessage.None;this.redirect=this.description=this.message=this.attrType=null;this.loadConfig=MO.TMessage_loadConfig;this.saveConfig=MO.TMessage_saveConfig;this.icon=MO.TMessage_icon;return this};
MO.TMessage_loadConfig=function(b){this.typeCd=RString.toLower(b.name);this.message=b.nvl("message");this.attrType=b.nvl("type");this.redirect=b.nvl("redirect");this.description=b.nvl("description").replace(/\\n/g,"\n")};MO.TMessage_saveConfig=function(b){b.name=this.typeCd;b.set("message",this.message);b.set("description",this.description)};MO.TMessage_icon=function(){return"sys.msg."+this.typeCd};
MO.TMessages=function(){this._items=new MO.TObjects;this.hasMessage=MO.TMessages_hasMessage;this.message=MO.TMessages_message;this.messages=MO.TMessages_messages;this.type=MO.TMessages_type;this.push=MO.TMessages_push;return this};MO.TMessages_hasMessage=function(b){for(var d=0;d<this._items.count;d++){var f=this._items.get(d);if(f&&f.type==b)return!0}return!1};MO.TMessages_message=function(b){for(var d=0;d<this._items.count;d++){var f=this._items.get(d);if(f&&f.type==b)return f}return null};
MO.TMessages_messages=function(b){for(var d=null,f=0;f<this._items.count;f++){var h=this._items.get(f);h&&h.type==b&&(d||(d=new TList),d.push(h))}return d};MO.TMessages_type=function(){return this.hasMessage(EMessage.Fatal)?EMessage.Fatal:this.hasMessage(EMessage.Error)?EMessage.Error:this.hasMessage(EMessage.Warn)?EMessage.Warn:this.hasMessage(EMessage.Valid)?EMessage.Valid:this.hasMessage(EMessage.Info)?EMessage.Info:EMessage.None};MO.TMessages_push=function(b){b&&this._items.push(b)};
MO.TNode=function(b){this._name=MO.Lang.String.nvl(b,"Node");this._nodes=this._attributes=this._value=null;this.isName=MO.TNode_isName;this.name=MO.TNode_name;this.setName=MO.TNode_setName;this.value=MO.TNode_value;this.setValue=MO.TNode_setValue;this.contains=MO.TNode_contains;this.hasAttribute=MO.TNode_hasAttribute;this.attributes=MO.TNode_attributes;this.hasNode=MO.TNode_hasNode;this.nodeCount=MO.TNode_nodeCount;this.node=MO.TNode_node;this.nodes=MO.TNode_nodes;this.get=MO.TNode_get;this.getInteger=
MO.TNode_getInteger;this.set=MO.TNode_set;this.setNvl=MO.TNode_setNvl;this.setBoolean=MO.TNode_setBoolean;this.setFloat=MO.TNode_setFloat;this.find=MO.TNode_find;this.findNode=MO.TNode_findNode;this.searchNode=MO.TNode_searchNode;this.push=MO.TNode_push;this.toString=MO.TNode_toString;this.innerDump=MO.TNode_innerDump;this.dump=MO.TNode_dump;return this};MO.TNode_isName=function(b){return MO.Lang.String.equals(this._name,b)};MO.TNode_name=function(){return this._name};
MO.TNode_setName=function(b){this._name=b};MO.TNode_value=function(){return this._value};MO.TNode_setValue=function(b){this._value=b};MO.TNode_contains=function(b){var d=this._attributes;return d?d.contains(b):!1};MO.TNode_hasAttribute=function(){var b=this._attributes;return b?!b.isEmpty():!1};MO.TNode_attributes=function(){var b=this._attributes;b||(b=this._attributes=new MO.TAttributes);return b};MO.TNode_hasNode=function(){var b=this._nodes;return b?!b.isEmpty():!1};
MO.TNode_nodeCount=function(){var b=this._nodes;return b?b.count():0};MO.TNode_node=function(b){var d=this._nodes;return d?d.at(b):null};MO.TNode_nodes=function(){var b=this._nodes;b||(b=this._nodes=new MO.TObjects);return b};MO.TNode_get=function(b,d){return this._attributes?this._attributes.get(b,d):null};MO.TNode_getInteger=function(b,d){return MO.Lang.Integer.parse(this.get(b,d))};MO.TNode_set=function(b,d){null!=d&&this.attributes().set(b,d)};
MO.TNode_setNvl=function(b,d){MO.Lang.String.isEmpty(d)||this.attributes().set(b,d)};MO.TNode_setBoolean=function(b,d){null!=d&&this.attributes().set(b,MO.Lang.Boolean.format(d))};MO.TNode_setFloat=function(b,d){null!=d&&this.attributes().set(b,MO.Lang.Float.format(d))};MO.TNode_find=function(b){if(this.hasNode())for(var d=this._nodes,f=d.count(),h=0;h<f;h++){var q=d.get(h);if(q.isName(b))return q}return null};
MO.TNode_findNode=function(b,d){if(this.hasNode()){var f=this._nodes,h=f.count(),q=arguments,w=q.length;if((w-1)%2)throw new MO.TError("Attributes is not pair. (length={1})",w);for(var z=0;z<h;z++){var A=f.get(z);if(null==b||A.isName(b)){for(var B=!0,C=1;C<w;C+=2)if(A.get(q[C])!=q[C+1]){B=!1;break}if(B)return A}}}return null};
MO.TNode_searchNode=function(b,d){if(this.hasAttribute()&&this._attributes.get(b)==d)return this;if(this.hasNode())for(var f=this._nodes,h=f.count();0<h;ni++){var q=f.get(q).searchNode(b,d);if(null!=q)return q}return null};MO.TNode_push=function(b){this.nodes().push(b)};MO.TNode_toString=function(){return this.dump()};
MO.TNode_innerDump=function(b,d,f){null==f&&(f="");b.append(f,d._name,"(",RClass.name(d),")");var h=d._attributes;if(h){var q=h.count();b.append(" [",q,":");for(var w=0;w<q;w++)0<w&&b.append(" "),b.append(h.name(w),"=",h.value(w)),w<q-1&&b.append(",");b.append("]")}d._value&&(q=d._value.toString(),MO.Lang.String.isEmpty(q)||b.append(" {",q.length,":",q,"}"));if(d=d._nodes)for(q=d.count(),b.append("\n"),w=0;w<q;w++)d.get(w).dump(b,f+"   "),w<q-1&&b.append("\n");return b};
MO.TNode_dump=function(b,d){return this.innerDump(MO.Lang.String.nvlString(b),this,d)};MO.TRow=function(){MO.TAttributes.call(this);this._statusCd=this._uniqueId=this._index=this._dataset=null;this.loadConfig=MO.TRow_loadConfig;this.saveConfig=MO.TRow_saveConfig;return this};MO.TRow_loadConfig=function(b){this._index=b.get("_id");this._statusCd=b.get("_status");this._uniqueId=b.get("ouid");b.hasAttribute()&&this.append(b.attributes())};
MO.TRow_saveConfig=function(b){b.set("_id",this._index);b.set("_status",this._statusCd);for(var d=this.count(),f=0;f<d;f++)b.set(this._names[f],this._values[f])};MO.TRow_copy=function(){var b=new TRow;b._dataset=this._dataset;b._index=this._index;b._statusCd=this._statusCd;b._uniqueId=this._uniqueId;for(var d=this.count,f=0;f<d;f++)b.set(this.names[f],this.values[f]);return b};MO.TRow_toAttributes=function(b){b||(b=new MO.TAttributes);b.set(RDataset.ROW_STATUS,this._statusCd);b.append(this);return b};
MO.TRow_dump=function(b){var d=this.count;b=MO.Lang.String.nvlStr(b);b.append(MO.Class.name(this)," [",this._statusCd,": ");for(var f=0;f<d;f++)0<f&&b.append(","),b.append(this.names[f],"=",this.values[f]);b.append("]");return b};
MO.TSpeed=function(){this.arguments=arguments;this._span=this._end=this._start=0;this._spanMin=Number.MAX_VALUE;this._spanMax=0;this.start=(new Date).getTime();this.callerName=MO.Method.name(MO.TSpeed.caller);this.reset=MO.TSpeed_reset;this.begin=MO.TSpeed_begin;this.end=MO.TSpeed_end;this.record=MO.TSpeed_record;this.toString=MO.TSpeed_toString;return this};MO.TSpeed_reset=function(){this._span=this._end=this._start=0};MO.TSpeed_begin=function(){this._start=(new Date).getTime()};
MO.TSpeed_end=function(){this._end=(new Date).getTime();this._span+=this._end-this._start;this._span<this._spanMin&&(this._spanMin=this._span);this._span>this._spanMax&&(this._spanMax=this._span)};MO.TSpeed_record=function(){(new Date).getTime();this.record=this.callerName=this.start=this.arguments=null};MO.TSpeed_toString=function(){return this._span+" ("+this._spanMin+" - "+this._spanMax+")"};MO.TTicker=function(b){this.interval=b;this.lastTick=0;this.process=MO.TTicker_process};
MO.TTicker_process=function(){var b=MO.Timer.current();return b-this.lastTick>this.interval?(this.lastTick=b,!0):!1};
MO.TUnsupportError=function TUnsupportError(d,f){for(var h="Unsupport method. (name={1})",q=new MO.TString,w=TUnsupportError.caller,z=new MO.TString,A=[];w&&!MO.Lang.Array.contains(A,w);)A.push(w),w=w.caller;for(var B=A.length,C=0;C<B;C++)w=A[C],0<C&&z.appendLine(),z.append("   "+(B-C)+": "+MO.Method.name(w));w=arguments;B=w.length;for(C=1;C<B;C++)var A=w[C],D=null,D="function"==typeof A?MO.Method.name(A):A,h=h.replace("{"+(C-1)+"}",D);q.appendLine(h);q.appendLine("------------------------------------------------------------");
q.append(z);throw Error(q);};MO.FConsole=function(b){b=MO.Class.inherits(this,b,MO.FObject);b._scopeCd=MO.Class.register(b,new MO.AGetter("_scopeCd"),MO.EScope.Global);b._statusSetup=!1;b.onSetup=MO.Method.empty;b.setup=MO.FConsole_setup;return b};MO.FConsole_setup=function(){this._statusSetup||(this.onSetup(),this._statusSetup=!0)};
MO.FObject=function(b){b||(b=this);b.__class=null;b.__dispose=!1;b.__hash=0;b.construct=MO.FObject_construct;b.hashCode=MO.FObject_hashCode;b.toString=MO.FObject_toString;b.dispose=MO.FObject_dispose;b.innerDump=MO.FObject_innerDump;b.dump=MO.FObject_dump;return b};MO.FObject_construct=function(){this.__dispose=!1};MO.FObject_hashCode=function(){var b=this.__hash;b||(b=this.__hash=MO.RObject.nextId());return b};MO.FObject_toString=function(){return MO.Class.dump(this)};
MO.FObject_dispose=function(){MO.RObject.free(this);this.__dispose=!0};MO.FObject_innerDump=function(b,d){b.append(MO.Class.dump(this))};MO.FObject_dump=function(){var b=new MO.TString;this.innerDump(b,0);return b.flush()};
MO.FObjectPool=function(b){b=MO.Class.inherits(this,b,MO.FObject);b._items=MO.Class.register(b,new MO.AGetter("_items"));b._frees=MO.Class.register(b,new MO.AGetter("_frees"));b._allocCount=0;b._freeCount=0;b.construct=MO.FObjectPool_construct;b.hasFree=MO.FObjectPool_hasFree;b.alloc=MO.FObjectPool_alloc;b.free=MO.FObjectPool_free;b.push=MO.FObjectPool_push;b.dispose=MO.FObjectPool_dispose;b.innerDump=MO.FObjectPool_innerDump;return b};
MO.FObjectPool_construct=function(){this.__base.FObject.construct.call(this);this._items=new MO.TObjects;this._frees=new MO.TObjects};MO.FObjectPool_hasFree=function(){return!this._frees.isEmpty()};MO.FObjectPool_alloc=function(){var b=null;this._frees.isEmpty()||(b=this._frees.pop());this._allocCount++;return b};MO.FObjectPool_free=function(b){this._frees.push(b);this._freeCount++};MO.FObjectPool_push=function(b){this._items.push(b);this._frees.push(b)};
MO.FObjectPool_dispose=function(){this._items=MO.RObject.dispose(this._items);this._frees=MO.RObject.dispose(this._frees);this.__base.FObject.dispose.call(this)};MO.FObjectPool_innerDump=function(b,d){b.append("Pool:");b.append("total=",this._items.count());b.append(", free=",this._frees.count());b.append(", alloc_count=",this._allocCount);b.append(", free_count=",this._freeCount)};
MO.FObjectPools=function(b){b=MO.Class.inherits(this,b,MO.FObject);b._pools=null;b.construct=MO.FObjectPools_construct;b.pool=MO.FObjectPools_pool;b.alloc=MO.FObjectPools_alloc;b.free=MO.FObjectPools_free;b.dispose=MO.FObjectPools_dispose;return b};MO.FObjectPools_construct=function(){this.__base.FObject.construct.call(this);this._pools=new MO.TDictionary};MO.FObjectPools_pool=function(b){var d=this._pools.get(b);d||(d=MO.Class.create(MO.FObjectPool),this._pools.set(b,d));return d};
MO.FObjectPools_alloc=function(b){return this.pool(b).alloc()};MO.FObjectPools_free=function(b,d){return this.pool(b).free(d)};MO.FObjectPools_push=function(b,d){return this.pool(b).push(d)};MO.FObjectPools_dispose=function(){for(var b=this._pools,d=b.count(),f=0;f<d;f++)b.at(f).dispose();b.dispose();this.__base.FObject.dispose.call(this)};
MO.FTimer=function(b){b=MO.Class.inherits(this,b,MO.FObject);b._count=0;b._startTime=0;b._beginTime=0;b._endTime=0;b._stopTime=0;b._span=MO.Class.register(b,new MO.AGetter("_span"),0);b._spanSecond=MO.Class.register(b,new MO.AGetter("_spanSecond"),0);b.setup=MO.FTimer_setup;b.current=MO.FTimer_current;b.rate=MO.FTimer_rate;b.update=MO.FTimer_update;return b};MO.FTimer_setup=function(){var b=(new Date).getTime();this._endTime=this._beginTime=this._startTime=b};MO.FTimer_current=function(){return this._lastTime};
MO.FTimer_rate=function(){return 0==this._count?0:parseInt(1E3*this._count/(this._lastTime-this._startTime))};MO.FTimer_update=function(){this._count++;var b=this._beginTime=this._endTime;this._spanSecond=(this._span=(this._endTime=(new Date).getTime())-b)/1E3};MO.RArray=function(){this.array1=Array(1);this.array2=Array(2);this.array3=Array(3);this.array4=Array(4);this.array9=Array(9);this.array12=Array(12);this.array16=Array(16);return this};
MO.RArray.prototype.equals=function(b,d){if(b&&d&&b.length==d.length){for(var f=b.length,h=0;h<f;h++)if(b[h]!=d[h])return!1;return!0}return!1};MO.RArray.prototype.count=function(b){var d=0,f;for(f in b)d++;return d};MO.RArray.prototype.contains=function(b,d){for(var f=b.length,h=0;h<f;h++)if(b[h]==d)return!0;return!1};MO.RArray.prototype.find=function(b,d){for(var f=b.length,h=0;h<f;h++)if(b[h]==d)return h;return-1};MO.RArray.prototype.search=function(b,d){for(var f in b)if(b[f]==d)return f;return null};
MO.RArray.prototype.reverse=function(b,d,f){for(var h=f+1-d>>1,q=0;q<h;q++){var w=b[d+q];b[d+q]=b[f-q];b[f-q]=w}};MO.RArray.prototype.copy=function(b,d,f,h,q){for(var w=0;w<f;w++)h[w+q]=b[w+d];return h};MO.RArray.prototype.move=function(b,d,f,h){if(d>h)for(var q=0;q<f;q++)b[h-q]=b[d+q];else if(d<h)for(q=0;q<f;q++)b[h+f-q-1]=b[d+f-q-1]};MO.RArray.prototype.remove=function(b,d){return b.slice(0,d).concat(b.slice(d+1))};
MO.RArray.prototype.sortPartition=function(b,d,f){var h=d;f+=1;for(var q=b[h];;){for(;b[++h]<q;);for(;b[--f]>q;);if(h>f)break;var w=b[h];b[h]=b[f];b[f]=w}b[d]=b[f];b[f]=q;return f};MO.RArray.prototype.sortArray=function(b,d,f){if(d<f){var h=this.sortPartition(b,d,f);this.sortArray(b,d,h-1);this.sortArray(b,h+1,f)}};MO.RArray.prototype.sort=function(b,d){var f=b.length-1;this.sortArray(b,0,f);d&&this.reverse(b,0,f);return b};
MO.RArray.prototype.nameMaxLength=function(b){for(var d in b)b=d.length,b>d&&(d=b);return 0};MO.RArray=new MO.RArray;MO.Lang.Array=MO.RArray;MO.RBlob=function(){return this};MO.RBlob.prototype.fromText=function(b){for(var d=b.length,f=new Uint8Array(d),h=0;h<d;h++)f[h]=b.charCodeAt(h);return new Blob([f])};MO.RBlob=new MO.RBlob;MO.Lang.Blob=MO.RBlob;MO.RBoolean=function(){return this};MO.RBoolean.prototype.format=function(b){return b?MO.EBoolean.True:MO.EBoolean.False};
MO.RBoolean.prototype.parse=function(b){if(null!=b){if(b.constructor==Boolean)return b;if(b.constructor==String)return b==MO.EBoolean.True;if(b.constructor==Number)return 0<b;throw new MO.TError(this,"Unknown type.");}return!1};MO.RBoolean.prototype.toString=function(b,d,f){null==d&&(d=MO.EBoolean.True);null==f&&(f=MO.EBoolean.False);return b?d:f};MO.RBoolean=new MO.RBoolean;MO.Lang.Boolean=MO.RBoolean;MO.RByte=function(){return this};
MO.RByte.prototype.copy=function(b,d,f,h,q){for(var w=0;w<q;w++)b[d++]=f[h++]};MO.RByte=new MO.RByte;MO.Lang.Byte=MO.RByte;MO.RChar=function(){return this};MO.RChar.prototype.parse=function(b){return String.fromCharCode(b)};MO.RChar.prototype.toString=function(b){return b};MO.RChar=new MO.RChar;MO.Lang.Char=MO.RChar;MO.RClass=function(){this._codes=[];this._classes={};return this};MO.RClass.prototype.isBase=function(b){return null!=b?MO.Class.isBaseName(typeof b):!1};
MO.RClass.prototype.isBaseName=function(b){return null==b||"boolean"!=b&&"number"!=b&&"date"!=b&&"string"!=b&&"function"!=b?!1:!0};MO.RClass.prototype.isBaseDataName=function(b){return null==b||"boolean"!=b&&"number"!=b&&"date"!=b&&"string"!=b?!1:!0};MO.RClass.prototype.isBaseType=function(b){return null==b||b!=Boolean&&b!=Number&&b!=Date&&b!=String&&b!=Function?!1:!0};MO.RClass.prototype.isBaseDataType=function(b){return null==b||b!=Boolean&&b!=Number&&b!=Date&&b!=String?!1:!0};
MO.RClass.prototype.isName=function(b,d){return this.name(b)==d};MO.RClass.prototype.isClass=function(b,d){if(b&&d){var f=this.name(d);return b.__base?null!=b.__base[f]:this.name(b)==f}return!1};MO.RClass.prototype.typeOf=function(b){return b&&b.constructor?MO.Lang.String.mid(b.constructor.toString(),"function ","("):"Null"};
MO.RClass.prototype.safeTypeOf=function(b,d){if(null==b)return"Null";try{var f=b.constructor;if(f==Boolean)return"Boolean";if(f==Number)return"Number";if(f==String)return"String";if(f==Function||f.constructor==Function)return MO.Lang.String.mid(f.toString(),"function ","(");if(b.__class)return b.__class.name;if(b.tagName)return"Html";for(var h in b)return"Object"}catch(q){}return"Unknown"};
MO.RClass.prototype.checkClass=function(b,d){if(!this.isClass(b,d))throw Error("Invalid class "+o.name(o)+"<>"+o.name(d));};MO.RClass.prototype.code=function(b){for(var d=this._codes,f=d.length,h=0;h<f;h++)if(d[h]==b)return h;d[f]=b;return f};MO.RClass.prototype.name=function(b){if(b){if(b.__name)return b.__name;if(b.__class)return b.__class.name;if("function"==typeof b)return MO.Method.name(b);if(b=b.constructor)return MO.Lang.String.mid(b.toString(),"function ","(")}return null};
MO.RClass.prototype.inherits=function(b,d){var f=MO.Runtime.nvl(d,b);f.__inherits=[];for(var h=arguments.length,q=2;q<h;q++)f.__inherits.push(MO.Method.name(arguments[q]));return f};MO.RClass.prototype.forName=function(b){var d=null;b&&(d=this._classes[b],d||(d=this.createClass(b),this.build(d)));return d};
MO.RClass.prototype.find=function(b){var d=null;null!=b&&(b.__class?d=b.__class.name:b.constructor==Function?d=MO.Method.name(b):b.constructor!=String&&MO.Logger.fatal(this,null,"Find class failure. (value={1})",b));return this._classes[d]};MO.RClass.prototype.register=function(b,d,f){b=MO.Method.name(b.constructor);b=this._classes[b];var h=null;if(d.constructor==Array)for(var q=d.length,w=0;w<q;w++)h=d[w],b.register(h);else h=d,b.register(h);d=h.value();return null!=f?f:d};
MO.RClass.prototype.createBase=function(b){var d=null;b&&(d=eval("function "+b+"(){return this;} new "+b+"();"));return d};MO.RClass.prototype.createClass=function(b){var d=this._classes[b]=new MO.TClass;d.name=b;d.base=this.createBase(b);d.clazz=new d.base.constructor;eval("MO."+b)(d.clazz);return d};MO.RClass.prototype.create=function(b){var d=null,d=typeof b;if("function"==d)d=MO.Method.name(b);else if("string"==d)d=b;else throw new MO.TError(this,"Param is invlid (clazz={1})",b);return this.createByName(d)};
MO.RClass.prototype.createByName=function(b){b=this.forName(b);if(!b)throw new MO.TError(this,"Cant find class. (name={1})",b);return b.newInstance()};
MO.RClass.prototype.innerCopy=function(b,d){if(null!=b&&null!=d)for(var f in b){var h=b[f];if(null!=h){var q=typeof h;if("function"==q){q=d[f];null==q?d[f]=h:MO.Method.isVirtual(q)?d[f]=h:!MO.Method.isVirtual(h)&&MO.Method.isEmpty(q)?d[f]=h:MO.Method.isVirtual(h)||MO.Method.isEmpty(h)||(d[f]=h);continue}else if(!MO.Class.isBaseName(q)){null==d[f]&&(d[f]=new h.constructor);this.innerCopy(h,d[f]);continue}}d[f]=h}};
MO.RClass.prototype.build=function(b){var d=b.clazz.__inherits;if(d&&d.constructor==Array)for(var f=!1,h=d.length,q=0;q<h;q++){var w=d[q];MO.Lang.String.startsWith(w,"F")&&(f&&MO.Logger.fatal(this,null,"Parent class is too many. (name={1})",w),b.parent=MO.Class.forName(w),f=!0)}f=b.instance=new b.base.constructor;if(d&&d.constructor==Array)for(h=d.length,q=0;q<h;q++)if(w=d[q],!MO.Lang.String.startsWith(w,"F")){var z=MO.Class.forName(w);null==z&&MO.Logger.fatal(this,null,"Parent class is not exists. (name={1})",
w);MO.Class.innerCopy(z.instance,f);b.assign(z)}b.parent&&(this.innerCopy(b.parent.instance,f),b.assign(b.parent));f.__base||(f.__base=new MO.TClassBase);f.__base[b.name]=new b.base.constructor;var A=b.clazz;for(w in A)"__base"!=w&&(null==A[w]&&null==f[w]?f[w]=null:null!=A[w]&&(null==f[w]||null!=f[w]&&A[w]!=f[w])&&(f[w]=A[w]));if(d&&d.constructor==Array)for(h=d.length,q=0;q<h;q++)for(w in w=d[q],A=MO.Class.forName(w),z=f.__base[w]=new A.base.constructor,A=A.instance,A)if("__base"!=w){var B=A[w],C=
f[w];null!=B&&null!=C&&B!=C&&B.constructor==Function&&C.constructor==Function&&(z[w]=A[w])}b.build();if(MO.Runtime.isRelease())for(w in f=b.instance,f)null==f[w]&&delete b.instance[w]};MO.RClass.prototype.free=function(b){var d=b.__class;d&&d.free(b)};
MO.RClass.prototype.dump=function(b){if(null==b)return"@null";var d=this.safeTypeOf(b);switch(d){case "Boolean":return"Boolean:"+b;case "Number":return"Number:"+b;case "String":return d+"<"+b.length+">:"+b;case "Function":return d+"<"+MO.Method.name(b)+">@"+this.code(b);case "Html":return d+"<"+b.tagName+">@"+this.code(b);default:if(b.__name)return d+"<"+b.__name+">@"+this.code(b)}return d+"@"+this.code(b)};MO.RClass=new MO.RClass;MO.Class=MO.RClass;
MO.RConsole=function(){this.ConsolePreFix="console:";this._registers=new MO.TObjects;this._consoles=new MO.TDictionary;this._localConsoles=new MO.TDictionary;return this};MO.RConsole.prototype.initialize=function(){for(var b=this._registers,d=0;d<b;d++){var f=b.get(d);f.force&&this.find(f.clazz)}};MO.RConsole.prototype.register=function(b){this._registers.push(b)};
MO.RConsole.prototype.create=function(b){var d=null;if(b){var d=MO.Class.create(b),f;for(f in d)if(MO.Lang.String.startsWith(f,"lnk")){var h=d[f];if("string"==typeof h&&MO.Lang.String.startsWith(h,"&")){var q=this.find(h.substr(1));if(!q)return MO.RMessage.fatal(this,null,"Can't link console. (name={0}, property={1}:{2})",b,f,h);d[f]=q}}}return d};
MO.RConsole.prototype.createByName=function(b){var d=null;if(b){var d=MO.Class.createByName(b),f;for(f in d)if(MO.Lang.String.startsWith(f,"lnk")){var h=d[f];if("string"==typeof h&&MO.Lang.String.startsWith(h,"&")){var q=this.find(h.substr(1));if(!q)return MO.Message.fatal(this,null,"Can't link console. (name={0}, property={1}:{2})",b,f,h);d[f]=q}}}return d};MO.RConsole.prototype.get=function(b){b=MO.Class.name(b);return this._consoles.get(b)};
MO.RConsole.prototype.find=function(b){var d=null;if(b.constructor==String)d=b;else if(b.constructor==Function)d=MO.Class.name(b);else return MO.Logger.fatal(this,null,"Parameter type is invalid. (console={1})",b);if((b=MO.Global.get(this.ConsolePreFix+d))||(b=this._consoles.get(d)))return b;var f=MO.Class.forName(d).instance.scopeCd();switch(f){case MO.EScope.Global:b=top.MO.Console.createByName(d);MO.Global.set(this.ConsolePreFix+d,b);this._consoles.set(d,b);break;case MO.EScope.Local:b=this.createByName(d);
this._localConsoles.set(d,b);this._consoles.set(d,b);break;default:return MO.Logger.fatal(this,"Unknown scope code. (name={1})",d)}MO.Logger.info(this,"Create console. (name={1}, scope={2})",d,MO.Lang.Enum.decode(MO.EScope,f));return b};
MO.RConsole.prototype.release=function(){this._registers&&(this._registers.dispose(),this._registers=null);var b=this._localConsoles;if(b){for(var d=b.count(),f=0;f<d;f++)b.value(f).dispose();b.dispose()}this._localConsoles=null;this._consoles&&this._consoles.dispose();this._consoles=null};MO.RConsole=new MO.RConsole;MO.Console=MO.RConsole;
MO.RConst=function(){this.PI_2=Math.PI/2;this.PI=Math.PI;this.PI2=2*Math.PI;this.RADIAN_RATE=180/Math.PI;this.DEGREE_RATE=Math.PI/180;this.PERCENT_10=.1;this.PERCENT_100=.01;this.PERCENT_1000=.001;this.identity3x3=[1,0,0,0,1,0,0,0,1];this.identity4x4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return this};MO.RConst=new MO.RConst;MO.Const=MO.RConst;MO.Lang.Const=MO.RConst;
MO.RDate=function(){this.MinYear=1800;this.MaxYear=2400;this.Pattern="n-: /";this.Chars="0123456789-:/";this.DisplayFormat="yyyy-mm-dd hh24:mi:ss";this.DataFormat="yyyymmddhh24miss";this.MonthDays=[0,31,28,31,30,31,30,31,31,30,31,30,31];this.Parts="YYYY MM DD HH24 MI SS".split(" ");this.PartsDefine={YYYY:["Year",4],MM:["Month",2],DD:["Day",2],HH24:["Hour",2],MI:["Minute",2],SS:["Second",2]};return this};MO.RDate.prototype.nvl=function(b){return b?b:new MO.TDate};
MO.RDate.prototype.format=function(b){return this.formatDate(new MO.TDate,b)};MO.RDate.prototype.formatText=function(b,d){if(!b)return!1;var f=d.toLowerCase(),f=f.replace(/yyyy/g,b.substring(0,4));b=b.substring(4);f=f.replace(/mm/g,b.substring(0,2));b=b.substring(2);f=f.replace(/dd/g,b.substring(0,2));b=b.substring(2);f=f.replace(/hh24/g,b.substring(0,4));b=b.substring(4);f=f.replace(/mi/g,b.substring(0,2));b=b.substring(2);f=f.replace(/ss/g,b.substring(0,2));b.substring(2);return f};
MO.RDate.prototype.formatDate=function(b,d){if(!b)return"";var f=d?d.toLowerCase():this.DataFormat,f=f.replace(/yyyy/g,MO.Lang.Integer.format(b.year,4)),f=f.replace(/yy/g,MO.Lang.Integer.format(b.year%100,2)),f=f.replace(/mm/g,MO.Lang.Integer.format(b.month,2)),f=f.replace(/dd/g,MO.Lang.Integer.format(b.day,2)),f=f.replace(/hh24/g,MO.Lang.Integer.format(b.hour,2)),f=f.replace(/mi/g,MO.Lang.Integer.format(b.minute,2)),f=f.replace(/ss/g,MO.Lang.Integer.format(b.second,2));return f=f.replace(/ms/g,MO.Lang.Integer.format(b.ms,
3))};MO.RDate.prototype.monthDays=function(b,d){if(!b||!d)return 0;b=parseInt(b);d=parseInt(d);this.MonthDays[2]=0!=b%4&&0!=b%400||0==b%100?28:29;return this.MonthDays[d]};
MO.RDate.prototype.splitFormat=function(b,d){if(!b)return!1;d=d.toLowerCase();for(var f=[];0<d.length;)0==d.indexOf("yyyy")?(f.year=b.substring(0,4),d=d.substring(4),b=b.substring(4)):0==d.indexOf("mm")?(f.month=b.substring(0,2),d=d.substring(2),b=b.substring(2)):0==d.indexOf("dd")?(f.day=b.substring(0,2),d=d.substring(2),b=b.substring(2)):0==d.indexOf("hh24")?(f.hour=b.substring(0,2),d=d.substring(4),b=b.substring(2)):0==d.indexOf("mi")?(f.minute=b.substring(0,2),d=d.substring(2),b=b.substring(2)):
0==d.indexOf("ss")?(f.second=b.substring(0,2),d=d.substring(2),b=b.substring(2)):0==d.indexOf("ms")?(f.ms=b.substring(0,2),d=d.substring(2),b=b.substring(3)):(d=d.substring(1),b=b.substring(1));return f};
MO.RDate.prototype.splitTime=function(b,d){if(d)if(-1!=d.indexOf(":")){var f=d.split(":");1<=f.length&&(b.hour=MO.Lang.Integer.parse(f[0]));2<=f.length&&(b.minute=MO.Lang.Integer.parse(f[1]));3<=f.length&&(b.second=MO.Lang.Integer.parse(f[2]))}else 6==d.length?(b.hour=MO.Lang.Integer.parse(d.substr(0,2)),b.minute=MO.Lang.Integer.parse(d.substr(2,2)),b.second=MO.Lang.Integer.parse(d.substr(4,2))):4==d.length?(b.hour=MO.Lang.Integer.parse(d.substr(0,2)),b.minute=MO.Lang.Integer.parse(d.substr(2,2))):
2==d.length&&(b.hour=MO.Lang.Integer.parse(d.substr(0,2)))};
MO.RDate.prototype.splitDate=function(b,d){if(d)if(-1!=d.indexOf("-")||-1!=d.indexOf("/")){var f=null;-1!=d.indexOf("-")?f=d.split("-"):-1!=d.indexOf("/")&&(f=d.split("/"));1<=f.length&&(b.year=MO.Lang.Integer.parse(f[0]));2<=f.length&&(b.month=MO.Lang.Integer.parse(f[1]));3<=f.length&&(b.day=MO.Lang.Integer.parse(f[2]))}else-1!=d.indexOf(":")?this.splitTime(b,d):14==d.length?(b.year=MO.Lang.Integer.parse(d.substr(0,4)),b.month=MO.Lang.Integer.parse(d.substr(4,2)),b.day=MO.Lang.Integer.parse(d.substr(6,
2)),b.hour=MO.Lang.Integer.parse(d.substr(8,2)),b.minute=MO.Lang.Integer.parse(d.substr(10,2)),b.second=MO.Lang.Integer.parse(d.substr(12,2))):8==d.length?(b.year=MO.Lang.Integer.parse(d.substr(0,4)),b.month=MO.Lang.Integer.parse(d.substr(4,2)),b.day=MO.Lang.Integer.parse(d.substr(6,2))):6==d.length?(b.year=MO.Lang.Integer.parse(d.substr(0,4)),b.month=MO.Lang.Integer.parse(d.substr(4,2))):4==d.length&&(b.year=MO.Lang.Integer.parse(d))};
MO.RDate.prototype.checkItems=function(b){if(!b)return!1;var d=MO.Lang.Integer.parse(b.year);if(d<this.MinYear||d>this.MaxYear)return!1;var f=MO.Lang.Integer.parse(b.month);if(1>f||12<f)return!1;var h=MO.Lang.Integer.parse(b.day);if(1>h||h>this.monthDays(d,f))return!1;d=MO.Lang.Integer.parse(b.hour);if(0>d||23<d)return!1;d=MO.Lang.Integer.parse(b.second);if(0>d||59<d)return!1;b=MO.Lang.Integer.parse(b.ms);return 0>b||99<b?!1:!0};
MO.RDate.prototype.check=function(b,d){return this.checkItems(this.splitFormat(b,d))};MO.RDate.prototype.make=function(b,d,f,h,q,w){return new MO.TDate(new Date(b,d,f))};MO.RDate.prototype.makeDate=function(b,d){var f=MO.Lang.Integer.parse(d.year),h=MO.Lang.Integer.parse(d.month)-1,q=MO.Lang.Integer.parse(d.day),w=MO.Lang.Integer.parse(d.hour),z=MO.Lang.Integer.parse(d.minute),A=MO.Lang.Integer.parse(d.second),B=MO.Lang.Integer.parse(d.ms),f=new Date(f,h,q,w,z,A,B);return b?(b.setDate(f),b):new MO.TDate(f)};
MO.RDate.prototype.parse=function(b,d,f){f||(f=this.DataFormat);d=this.splitFormat(d,f);return this.checkItems(d)?this.makeDate(b,d):null};MO.RDate.prototype.autoParse=function(b,d){if(!d)return null;b=this.nvl(b);var f=[];f.year=2E3;f.month=1;f.day=1;f.hour=0;f.minute=0;f.second=0;d=MO.Lang.String.trim(d);if(-1==d.indexOf(" "))this.splitDate(f,d);else{var h=d.split(" ");2==h.length&&(this.splitDate(f,h[0]),this.splitTime(f,h[1]))}return this.checkItems(f)?this.makeDate(b,f):null};MO.RDate=new MO.RDate;
MO.Lang.Date=MO.RDate;MO.REnum=function(){return this};MO.REnum.prototype.contains=function(){};MO.REnum.prototype.tryEncode=function(b,d,f){if(b)for(var h in b)if(h.toLowerCase()==d.toLowerCase())return b[h];return f};MO.REnum.prototype.encode=function(b,d){var f=this.tryEncode(b,d);if(null==f)throw new TError(this,"Invalid value (enum={1}, value={2})",RClass.dump(b),d);return f};MO.REnum.prototype.tryDecode=function(b,d,f){if(b)for(var h in b)if(b[h]==d)return h;return f};
MO.REnum.prototype.decode=function(b,d){var f=this.tryDecode(b,d);if(null==f)throw new MO.TError(this,"Invalid value (enum={1}, value={2})",MO.Class.dump(b),d);return f};MO.REnum.prototype.parse=MO.REnum.prototype.encode;MO.REnum=new MO.REnum;MO.Lang.Enum=MO.REnum;MO.RFile=function(){this.pictures=["jpg","png","gif","bmp"];this.knowns="jpg png gif bmp doc docx vsd xls xlsx".split(" ");return this};
MO.RFile.prototype.inPicture=function(b){if(b){b=b.toLowerCase();for(var d in this.pictures)if(this.pictures[d]==b)return!0}};MO.RFile.prototype.isPicture=function(b){return this.inPicture(this.extension(b))};MO.RFile.prototype.isKnown=function(b){b=this.extension(b).toLowerCase();for(var d in this.knowns)if(this.knowns[d]==b)return!0;return!1};
MO.RFile.prototype.name=function(b){if(b){b=b.replace(/\\/g,"/");var d=b.lastIndexOf("/");-1!=d&&(b=b.substring(d+1));d=b.lastIndexOf(".");return-1!=d?b.substring(0,d):b}return""};MO.RFile.prototype.extension=function(b){if(b){b=b.replace(/\\/g,"/");var d=b.lastIndexOf("/");-1!=d&&(b=b.substring(d+1));d=b.lastIndexOf(".");return-1!=d?b.substring(d+1):b}return""};MO.RFile=new MO.RFile;MO.Stream.File=MO.File;MO.RFloat=function(){this.NUMBER=this.Chars="0123456789-.%";this.LEFT_CHAR="0";return this};
MO.RFloat.prototype.isFloat=function(b){return MO.Lang.String.isPattern(b,"n")};MO.RFloat.prototype.parse=function(b){if(null==b||""==b)return 0;b=MO.Lang.String.trim(b.toString());if(null==b)return 0;for(;"0"==b.charAt(0);)b=b.substr(1);b=0<b.length?parseFloat(b):0;-1!=MO.Lang.String.findChars(b,"%")&&(b/=100);return isNaN(b)?0:b};
MO.RFloat.prototype.format=function(b,d,f,h,q){null==d&&(d=0);null==f&&(f=this.LEFT_CHAR);null==h&&(h=6);null==q&&(q=this.LEFT_CHAR);var w=b.toString(),z=w.indexOf(".");-1==z?(b=w,w=""):(b=w.substring(0,z),w=w.substring(z+1,z+h+1));d=MO.Lang.String.lpad(b,d,f);h=MO.Lang.String.rpad(w,h,q);return d+"."+h};
MO.RFloat.prototype.unitFormat=function(b,d,f,h,q,w,z){null==d&&(d=0);null==f&&(f=this.LEFT_CHAR);null==h&&(h=6);null==q&&(q=this.LEFT_CHAR);if(null==w||null==z)w=1,z="";b=(b/w).toString();var A=b.indexOf(".");-1==A?(w=b,b=""):(w=b.substring(0,A),b=b.substring(A+1,A+h+1));f=MO.Lang.String.lpad(w,d,f);d=new MO.TString;for(w=1;w-1<f.length;w++)d.append(f.substring(w-1,w)),0<f.length-w&&0==(f.length-w)%3&&d.append(",");h=MO.Lang.String.rpad(b,h,q);return d+"."+h+z};
MO.RFloat.prototype.nvl=function(b,d){return b?b:d?d:0};MO.RFloat.prototype.toRange=function(b,d,f){null==b&&(b=0);return Math.min(Math.max(b,d),f)};MO.RFloat.prototype.sum=function(){for(var b=arguments,d=0,f=b.length-1;0<=f;f--){var h=b[n];null!=h&&(d+=parseFloat(h))}return d};MO.RFloat.prototype.calculate=function(b,d,f){d=RFloat.nvl(d);f=RFloat.nvl(f);d=parseFloat(d);f=parseFloat(f);return b?(d+f).toString():(d-f).toString()};
MO.RFloat.prototype.attach=function(b,d,f){for(var h=!1,q=0;q<f;q++)b[q]!=d[q]&&(b[q]=d[q],h=!0);return h};MO.RFloat.prototype.fill=function(b,d,f,h){for(var q=0;q<f;q++)b[d++]=h};MO.RFloat.prototype.copy=function(b,d,f,h,q){for(var w=0;w<q;w++)b[d++]=f[h++]};MO.RFloat=new MO.RFloat;MO.Lang.Float=MO.RFloat;MO.RHex=function(){this.NUMBER="0x123456789ABCDEF";this.PAD="0";return this};MO.RHex.prototype.isValid=function(b){return MO.String.isPattern(b,this.NUMBER)};
MO.RHex.prototype.parse=function(b){return b?parseInt("0x"+b):0};MO.RHex.prototype.format=function(b,d){var f=null,f=b?b.toString(16):"0";return d?MO.String.lpad(f,d,this.PAD):f};MO.RHex=new MO.RHex;MO.Lang.Hex=MO.RHex;MO.RInstance=function(){this._pools=new MO.TDictionary;return this};MO.RInstance.prototype.pool=function(b){b=MO.Class.name(b);var d=this._pools.get(b);null==d&&(d=new MO.TInstancePool,this._pools.set(b,d));return d};MO.RInstance.prototype.get=function(b){return this.pool(b).instance(b)};
MO.RInstance.prototype.alloc=function(b){return this.pool(p).alloc(p)};MO.RInstance.prototype.free=function(b){this.pool(p).free(p)};MO.RInstance=new MO.RInstance;MO.Instance=MO.RInstance;MO.RInteger=function(){this.NUMBER=this.Chars="0123456789-%";this.LEFT_CHAR="0";this.MAX_UINT16=65535;this.MAX_UINT32=4294967295;return this};MO.RInteger.prototype.isInt=function(b){return MO.Lang.String.isPattern(b,"n")};MO.RInteger.prototype.nvl=function(b,d){return null!=b?parseInt(b):null!=d?d:0};
MO.RInteger.prototype.strideByte=function(b){return 65535<b?4:255<b?2:1};MO.RInteger.prototype.strideBit=function(b){return 65535<b?32:255<b?16:8};MO.RInteger.prototype.parse=function(b,d){null==d&&(d=0);if(null==b||""==b)return d;for(b=MO.Lang.String.trim(b.toString());"0"==b.charAt(0);)b=b.substr(1);var f=0<b.length?parseInt(b):d;return isNaN(f)?d:f};MO.RInteger.prototype.format=function(b,d,f){f||(f=this.LEFT_CHAR);b=b.toString();for(d=parseInt(d)-b.length-1;0<=d;d--)b=f+b;return b};
MO.RInteger.prototype.toRange=function(b,d,f){null==b&&(b=0);isNaN(b)&&(b=0);b<d&&(b=d);b>f&&(b=f);return b};MO.RInteger.prototype.pow2=function(b){return 4096<b?8192:2048<b?4096:1024<b?2048:512<b?1024:256<b?512:128<b?256:64<b?128:32<b?64:16<b?32:8<b?16:4<b?8:2<b?4:1<b?2:1};MO.RInteger.prototype.sum=function(){for(var b=0,d=arguments,f=d.length,h=0;h<f;h++)null!=d[h]&&(b+=parseInt(d[h]));return b};
MO.RInteger.prototype.calculate=function(b,d,f){d=RInteger.parse(d);f=RInteger.parse(f);var h="";"+"==b?h=d+f:"-"==b?h=d-f:"x"==b?h=d*f:"/"==b&&(h=d/f);return h.toString()};MO.RInteger.prototype.copy=function(b,d,f,h,q){for(var w=0;w<q;w++)b[d++]=f[h++]};MO.RInteger.prototype.toString=function(b){return null==b?"0":b.toString()};MO.RInteger=new MO.RInteger;MO.Lang.Integer=MO.RInteger;MO.RJson=function(){return this};
MO.RJson.prototype.parse=function(b,d){var f=null;try{f=JSON.parse(b)}catch(h){d&&(f=new d)}return f};MO.RJson.prototype.toString=function(b){return JSON.stringify(b)};MO.Json=new MO.RJson;MO.RLogger=function(){this._statusError=!1;this._labelLength=40;this.lsnsOutput=new MO.TListeners;return this};MO.RLogger.prototype.output=function(b,d){this.lsnsOutput.process(b,d)};
MO.RLogger.prototype.debug=function(b,d,f){var h=null,q=MO.Logger.debug.caller;q?h=MO.Method.name(q):arguments.caller&&(h=MO.Method.name(arguments.caller[0]));h=null==h?"unknown":h.replace("_",".");q=new MO.TString;q.append(MO.Lang.Date.format("yymmdd-hh24miss.ms"));q.append("|D ["+MO.Lang.String.rpad(h,this._labelLength)+"] ");for(var h=arguments,w=h.length,z=2;z<w;z++){var A=h[z],B="";null!=A&&(B="function"==typeof A?MO.Method.name(A):A.toString());d=d.replace("{"+(z-1)+"}",B)}q.append(d);this.output(b,
q.flush())};
MO.RLogger.prototype.info=function(b,d,f){var h=null,q=MO.Logger.info.caller;q?h=MO.Method.name(q):arguments.caller&&(h=MO.Method.name(arguments.caller[0]));h=null==h?"unknown":h.replace("_",".");q=new MO.TString;q.append(MO.Lang.Date.format("yymmdd-hh24miss.ms"));q.append("|I ["+MO.Lang.String.rpad(h,this._labelLength)+"] ");for(var h=arguments,w=h.length,z=2;z<w;z++){var A=h[z],B="";null!=A&&(B="function"==typeof A?MO.Method.name(A):A.toString());d=d.replace("{"+(z-1)+"}",B)}q.append(d);this.output(b,
q.flush())};
MO.RLogger.prototype.warn=function(b,d,f){var h=null,q=MO.Logger.warn.caller;q?h=MO.Method.name(q):arguments.caller&&(h=MO.Method.name(arguments.caller[0]));h=null==h?"unknown":h.replace("_",".");q=new MO.TString;q.append(MO.Lang.Date.format("yymmdd-hh24miss.ms"));q.append("|W ["+MO.Lang.String.rpad(h,this._labelLength)+"] ");for(var h=arguments,w=h.length,z=2;z<w;z++){var A=h[z],B="";null!=A&&(B="function"==typeof A?MO.Method.name(A):A.toString());d=d.replace("{"+(z-1)+"}",B)}q.append(d);this.output(b,
q.flush())};
MO.RLogger.prototype.error=function(b,d,f){var h=null,q=MO.Logger.error.caller;q?h=MO.Method.name(q):arguments.caller&&(h=MO.Method.name(arguments.caller[0]));h=null==h?"unknown":h.replace("_",".");q=new MO.TString;q.append(MO.Lang.Date.format("yymmdd-hh24miss.ms"));q.append("|E ["+MO.Lang.String.rpad(h,this._labelLength)+"] ");for(var h=arguments,w=h.length,z=2;z<w;z++){var A=h[z],B="";null!=A&&(B="function"==typeof A?MO.Method.name(A):A.toString());d=d.replace("{"+(z-1)+"}",B)}q.append(d);this.output(b,
q.flush())};
MO.RLogger.prototype.fatal=function(b,d,f,h){if(!this._statusError){this._statusError=!0;for(var q=new MO.TString,w=[],z=MO.Logger.fatal.caller;z&&!MO.Lang.Array.contains(w,z);)w.push(z),z=z.caller;for(var A=w.length,B=0;B<A;B++)z=w[B],0<B&&q.appendLine(),q.append("   "+(A-B)+": "+MO.Method.name(z));w=new MO.TString;w.appendLine(MO.RContext.get("RMessage:fatal"));w.appendLine(MO.Lang.String.repeat("-",60));w.append(MO.Class.dump(b),": ");if(f)for(z=arguments,A=z.length,B=3;B<A;B++){var C=z[B];"function"==
typeof C&&(C=MO.Method.name(C));f=f.replace("{"+(B-2)+"}",C)}w.appendLine(f);w.appendLine(MO.Lang.String.repeat("-",60));w.appendLine("Stack:");w.append(q);q=w.toString();if(!MO.Runtime.isRelease())throw Error(q);}};
MO.RLogger.prototype.show=function(b,d,f){var h=null,q=MO.Logger.show.caller;q?h=MO.Method.name(q):arguments.caller&&(h=MO.Method.name(arguments.caller[0]));h=null==h?"unknown":h.replace("_",".");q=new MO.TString;q.append(MO.Lang.Date.format("yymmdd-hh24miss.ms"));q.append("|I ["+MO.Lang.String.rpad(h,this._labelLength)+"] ");for(var h=arguments.length,w=2;w<h;w++){var z=arguments[w],A="";null!=z&&(A="function"==typeof z?MO.Method.name(z):z.toString());d=d.replace("{"+(w-1)+"}",A)}q.append(d);alert(q.flush())};
MO.Logger=new MO.RLogger;MO.RMethod=function(){this._virtuals={};this._properties={};return this};MO.RMethod.prototype.construct=function(){this.empty.__empty=!0;this.emptyTrue.__empty=!0;this.emptyFalse.__empty=!0};MO.RMethod.prototype.isFunction=function(b){return"function"==typeof b};MO.RMethod.prototype.isEmpty=function(b){return b&&b.__empty};MO.RMethod.prototype.isVirtual=function(b){return b&&b.__virtual};
MO.RMethod.prototype.name=function(b){return b&&"function"==typeof b?b.__name?b.__name:b.__name=MO.Lang.String.mid(b.toString(),"function ","("):null};MO.RMethod.prototype.fullName=function(b){return b&&b.constructor==Function?b.__fullname?b.__fullname:b.__fullname=MO.Lang.String.mid(b.toString(),"function ",")")+")":null};MO.RMethod.prototype.empty=function(){};MO.RMethod.prototype.emptyTrue=function(){return!0};MO.RMethod.prototype.emptyFalse=function(){return!1};
MO.RMethod.prototype.emptyCall=function(){};MO.RMethod.prototype.virtual=function(b,d){var f=null,h=MO.Class.name(b)+"."+d;this._virtuals[h]?f=this._virtuals[h]:(f=new Function("throw new Error('Virtual method be called.("+h+")');"),f.__virtual=!0,f.__name=h,this._virtuals[h]=f);return f};MO.RMethod.prototype.makePropertyGet=function(b,d){var f=b+"|"+d,h=null;this._properties[f]?h=this._properties[f]:(h=new Function("return this."+b+";"),this._properties[f]=h);return h};
MO.RMethod.prototype.makePropertyGetSource=function(b,d){return new Function("return this."+b+";")};MO.RMethod.prototype.makePropertySet=function(b,d){var f=b+"|"+d,h=null;this._properties[f]?h=this._properties[f]:(h=new Function("value","this."+b+"=value;"),this._properties[f]=h);return h};MO.RMethod=new MO.RMethod;MO.Method=MO.RMethod;MO.Method.construct();MO.RObject=function(){this._hash=1;return this};MO.RObject.prototype.nextId=function(b){return this._hash++};
MO.RObject.prototype.nvl=function(b){for(var d=arguments,f=d.length,h=0;h<f;h++)if(null!=d[h])return d[h];return null};MO.RObject.prototype.clone=function(b){var d=new b.constructor,f;for(f in b){var h=b[f];null!=h&&(MO.Class.isBaseType(h.constructor)||(h=MO.Lang.Object.clone(h)));d[f]=h}return d};MO.RObject.prototype.copy=function(b,d){if(null!=b&&null!=d)for(var f in b){var h=b[f];null==h||MO.Class.isBaseType(h.constructor)||(null==d[f]&&(d[f]=new c),MO.Lang.Object.copy(h,d[f]));d[f]=h}};
MO.RObject.prototype.free=function(b){if(b)if(MO.Runtime.isDebug())for(var d in b)if("__base"==d||"__inherits"==d||"__class"==d)b[d]=null;else{var f=b[d];if(null!=f){if(!MO.Class.isBaseType(f.constructor))throw new MO.TError(MO.Lang.Object,"Free object is not base object.");b[d]=null}}else for(d in b)b[d]=null};MO.RObject.prototype.dispose=function(b,d){if(b){if(b.__dispose)throw new MO.TError(MO.Lang.Object,"Object has disposed.");b.dispose(d);b.__dispose=!0}return null};
MO.RObject.prototype.release=function(b){if(b)for(var d in b){var f=b[d];"Object"==typeof f&&this.release(f);b[n]=null}return null};MO.RObject=new MO.RObject;MO.Lang.Object=MO.RObject;MO.RRect=function(){return this};MO.RRect.prototype.nvl=function(b){return b?b:new TRect};MO.RRect.prototype.pack=function(b){var d=null;b&&(d=b.left+","+b.top+","+b.right+","+b.bottom);return d};
MO.RRect.prototype.unpack=function(b,d){d=this.nvl(d);if(b){var f=b.split(",");4==f.length&&(d.left=RInt.parse(f[0]),d.top=RInt.parse(f[1]),d.right=RInt.parse(f[2]),d.bottom=RInt.parse(f[3]))}return d};MO.RRect=new MO.RRect;MO.RRegExp=function(){return this};MO.RRegExp.prototype.test=function(b,d){return b&&null!=d?b.test(d):!1};MO.RRegExp.prototype.testRgexp=function(b,d){return b&&d?(new R,b.test(d)):!1};MO.RRegExp=new MO.RRegExp;MO.RSet=function(){return this};
MO.RSet.prototype.contains=function(b,d){return(b&d)==d};MO.RSet.prototype.containsString=function(b,d){return null!=b&&null!=s?-1!=b.indexOf(s):!1};MO.RSet=new MO.RSet;MO.Lang.Set=MO.RSet;MO.RString=function(){this.EMPTY="";this.SPACE="   ";this.PAD=" ";this.TRIM=" \t\r\n";this.LOWER="abcdefghijklmnopqrstuvwxyz";this.UPPER="ABCDEFGHIJKLMNOPQRSTUVWXYZ";this.CodeLowerA=97;this.CodeLowerZ=122;this.CodeUpperA=65;this.CodeUpperZ=90;return this};
MO.RString.prototype.isEmpty=function(b){return null!=b?0==b.length:!0};MO.RString.prototype.isBlank=function(b){return null!=b?0==b.trim().length:!0};MO.RString.prototype.isAnsi=function(b){if(null!=b){for(var d=b.length,f=0;f<d;f++)if(255<b.charCodeAt(f))return!1;return!0}return!1};MO.RString.prototype.isDbcs=function(b){if(null==b){b=b.length;for(var d=0;d<b;d++)if(256>value.charCodeAt(d))return!1;return!0}return!1};
MO.RString.prototype.isPattern=function(b,d){if(null!=b){null==d&&(d="$a$A$f");d=d.replace(/\a/g,this.LOWER);d=d.replace(/\A/g,this.UPPER);d=d.replace(/\f/g,MO.Lang.Float.NUMBER);d=d.replace(/\n/g,MO.Lang.Integer.NUMBER);for(var f=b.length,h=0;h<f;h++)if(-1==d.indexOf(b.charAt(h)))return!1;return!0}return!1};MO.RString.prototype.inChars=function(b,d){return-1!=this.findChars(d,b)?!0:!1};MO.RString.prototype.contains=function(b,d){return null!=b&&null!=d?-1!=b.toString().indexOf(d):!1};
MO.RString.prototype.equals=function(b,d,f){null==b?b="":b.constructor!=String&&(b=b.toString());null==d?d="":d.constructor!=String&&(d=d.toString());return f?b==d:b.toLowerCase()==d.toLowerCase()};MO.RString.prototype.startsWith=function(b,d){return null==d?!0:null!=b?0==b.indexOf(d):!1};MO.RString.prototype.endsWith=function(b,d){if(null==d)return!0;var f=null!=b?b.indexOf(d):-1;return-1!=f?f==b.length-d.length:!1};
MO.RString.prototype.findChars=function(b,d){if(null!=b&&null!=d)for(var f=b.length,h=0;h<f;h++)if(-1!=d.indexOf(b.charAt(h)))return h;return-1};MO.RString.prototype.inRange=function(b,d,f){if(b&&d){f||(b=b.toLowerCase());for(var h=d.length,q=0;q<h;q++){var w=d[q];if(null!=w)if(f){if(b==w)return!0}else if(b==w.toLowerCase())return!0}}return!1};MO.RString.prototype.nvl=function(b,d){if(null!=b){var f=null,f=b.constructor!=String?b.toString():b;if(0<f.length)return f}return null!=d?d:this.EMPTY};
MO.RString.prototype.nvlString=function(b){null==b&&(b=new MO.TString);return b};MO.RString.prototype.empty=function(b){if(null!=b){var d=null,d=b.constructor!=String?b.toString():b;if(0<d.length)return d}return null};MO.RString.prototype.firstUpper=function(b){return null!=b?b.charAt(0).toUpperCase()+b.substr(1):b};MO.RString.prototype.firstLower=function(){return null!=v?v.charAt(0).toLowerCase()+v.substr(1):v};
MO.RString.prototype.firstLine=function(b){if(b){var d=Math.min(b.indexOf("\r"),b.indexOf("\n"));return-1!=d?b.substr(0,d):b}return""};MO.RString.prototype.format=function(b,d){for(var f=arguments.length,h=1;h<f;h++){var q=arguments[h];"function"==typeof q?q=MO.Method.name(q):null==q&&(q="");b=b.replace("{"+h+"}",q)}return b};
MO.RString.prototype.formatLines=function(b){b=b.replace(/\\r/g,"");b=b.split("\n");for(var d=b.length,f=new MO.TString,h=0;h<d;h++){var q=b[h],q=this.trim(q);this.isEmpty(q)||this.startsWith(q,"//")||f.appendLine(q)}return f.flush()};MO.RString.prototype.repeat=function(b,d){return Array(d+1).join(b)};MO.RString.prototype.pad=function(b,d,f){b=null!=b?b.toString():this.EMPTY;d-=b.length;if(0<d){null==f&&(f=this.PAD);var h=0==d%2?d/2:(d-1)/2;return Array(h+1).join(f)+b+Array(d-h+1).join(f)}return b};
MO.RString.prototype.lpad=function(b,d,f){b=null!=b?b.toString():this.EMPTY;d-=b.length;return 0<d?(null==f&&(f=this.PAD),d=Array(d),d[d.length]=b,d.join(f)):b};MO.RString.prototype.rpad=function(b,d,f){b=null!=b?b.toString():this.EMPTY;d-=b.length;return 0<d?(null==f&&(f=this.PAD),b+Array(d+1).join(f)):b};
MO.RString.prototype.trim=function(b,d){b=this.nvl(b);d=this.nvl(d,this.TRIM);for(var f=0,h=b.length-1;f<h&&-1!=d.indexOf(b.charAt(f));f++);for(;h>=f&&-1!=d.indexOf(b.charAt(h));h--);return f==h+1?null:0!=f||h!=b.length-1?b.substring(f,h+1):b};MO.RString.prototype.ltrim=function(b,d){b=this.nvl(value);d=this.nvl(trims,this.TRIM);for(var f=0,h=b.length-1;f<h&&-1!=d.indexOf(b.charAt(f));f++);return 0!=f?b.substring(f,h+1):b};
MO.RString.prototype.rtrim=function(b,d){b=this.nvl(b);d=this.nvl(d,this.TRIM);for(var f=b.length-1;0<=f&&-1!=d.indexOf(b.charAt(f));f--);return f!=b.length-1?b.substring(0,f+1):b};MO.RString.prototype.mid=function(b,d,f){if(null==b)return b;var h=0;if(null!=d){var q=b.indexOf(d);-1!=q&&(h=q+d.length)}d=b.length;null!=f&&(q=b.indexOf(f,h),-1!=q&&(d=q));return b.substring(h,d)};MO.RString.prototype.toLine=function(b){return b.replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\t/g,"\\t")};
MO.RString.prototype.toUnderline=function(b){var d=null;if(b){for(var d=new MO.TString,f=b.length,h=0;h<f;h++){var q=b.charAt(h);q.toUpperCase()==q?(0<h&&d.append("_"),d.append(q.toLowerCase())):d.append(q)}d=d.flush()}return d};MO.RString.prototype.toLower=function(b){return null!=b?b.toLowerCase():this.EMPTY};MO.RString.prototype.toUpper=function(b){return null!=b?b.toUpperCase():this.EMPTY};MO.RString.prototype.split=function(b,d){return b&&d?b.split(d):null};
MO.RString.prototype.splitTwo=function(b,d){if(b&&d){var f=[],h=b.indexOf(d);-1==h?f.push(b):(f.push(b.substring(0,h)),f.push(b.substring(h+d.length)));return f}return null};MO.RString.prototype.splitParts=function(b,d){for(var f=[],h=0,q=b.length,w=0;w<q;w++)for(var z in d)if(this.startsWith(d[z],b.charAt(w))&&this.equals(b.substr(w,d[z].length),d[z])){f[h++]=d[z];w=w+d[z].length-1;break}return f};
MO.RString.prototype.splitPattern=function(b,d){var f=[];if(b)for(var h=b.length,q=d.length,w="",z=0;z<h;z++){for(var A=!1,B=0;B<q;B++){var C=d[B];if(-1==b.indexOf(C)){w.length&&(f[f.length]=w,w="");f[f.length]=C;b=b.substring(C.length);A=!0;break}}A||(w+=b.charAt(0),b=b.substring(1))}return f};MO.RString.prototype.replace=function(b,d,f){return b.replace(new RegExp(d,"g"),f)};
MO.RString.prototype.replaceChar=function(b,d,f){if(null!=b){for(var h=b.length,q=[],w=0;w<h;w++){var z=b.charAt(w);q[q.length]=z==d?f:z}return q.join("")}return b};MO.RString.prototype.remove=function(b,d){return b.replace(d,"")};MO.RString.prototype.removeChars=function(b,d){if(null!=b){for(var f=b.length,h=[],q=0;q<f;q++){var w=b.charAt(q);-1==d.indexOf(w)&&(h[h.length]=w)}return h.join("")}return b};MO.RString=new MO.RString;MO.Lang.String=MO.RString;
MO.RTimer=function(){this._count=this._lastTime=this._startTime=0;return this};MO.RTimer.prototype.setup=function(){var b=(new Date).getTime();this._lastTime=this._startTime=b};MO.RTimer.prototype.now=function(){return(new Date).getTime()};MO.RTimer.prototype.current=function(){return this._lastTime};MO.RTimer.prototype.rate=function(){return 0==this._count?0:parseInt(1E3*this._count/(this._lastTime-this._startTime))};MO.RTimer.prototype.update=function(){this._count++;this._lastTime=(new Date).getTime()};
MO.RTimer=new MO.RTimer;MO.Timer=MO.RTimer;MO.EFrustumPlane=new function(){this.Near=0;this.Far=1;this.Left=2;this.Right=3;this.Top=4;this.Bottom=5;this.Count=6;return this};
MO.SColor4=function(b,d,f,h){this.red=b?b:0;this.green=d?d:0;this.blue=f?f:0;this.alpha=h?h:1;this.assign=MO.SColor4_assign;this.assignPower=MO.SColor4_assignPower;this.set=MO.SColor4_set;this.setInteger=MO.SColor4_setInteger;this.setIntAlpha=MO.SColor4_setIntAlpha;this.setHex=MO.SColor4_setHex;this.serialize=MO.SColor4_serialize;this.unserialize=MO.SColor4_unserialize;this.unserialize3=MO.SColor4_unserialize3;this.saveConfig=MO.SColor4_saveConfig;this.savePower=MO.SColor4_savePower;this.copyArray=
MO.SColor4_copyArray;this.toString=MO.SColor4_toString;return this};MO.SColor4_assign=function(b){this.red=b.red;this.green=b.green;this.blue=b.blue;this.alpha=b.alpha};MO.SColor4_assignPower=function(b){this.red=b.red*b.alpha;this.green=b.green*b.alpha;this.blue=b.blue*b.alpha;this.alpha=b.alpha};MO.SColor4_set=function(b,d,f,h){this.red=b;this.green=d;this.blue=f;this.alpha=h};
MO.SColor4_setInteger=function(b){this.red=(b>>16&255)/255;this.green=(b>>8&255)/255;this.blue=(b&255)/255;this.alpha=(b>>24&255)/255};MO.SColor4_setIntAlpha=function(b,d){this.red=(b>>16&255)/255;this.green=(b>>8&255)/255;this.blue=(b&255)/255;this.alpha=d};
MO.SColor4_setHex=function(b){0==b.indexOf("#")&&(b=b.substring(1));0==b.indexOf("0x")&&(b=b.substring(2));if(6==b.length)this.red=MO.Lang.Hex.parse(b.substring(0,2))/255,this.green=MO.Lang.Hex.parse(b.substring(2,4))/255,this.blue=MO.Lang.Hex.parse(b.substring(4,6))/255;else throw new MO.TError(this,"Invalid value.");};MO.SColor4_serialize=function(b){b.writeFloat(this.red);b.writeFloat(this.green);b.writeFloat(this.blue);b.writeFloat(this.alpha)};
MO.SColor4_unserialize=function(b){this.red=b.readFloat();this.green=b.readFloat();this.blue=b.readFloat();this.alpha=b.readFloat()};MO.SColor4_unserialize3=function(b){this.red=b.readFloat();this.green=b.readFloat();this.blue=b.readFloat();this.alpha=1};MO.SColor4_saveConfig=function(b){b.setFloat("r",this.red);b.setFloat("g",this.green);b.setFloat("b",this.blue);b.setFloat("a",this.alpha)};
MO.SColor4_savePower=function(b){b.setFloat("r",this.red);b.setFloat("g",this.green);b.setFloat("b",this.blue);b.setFloat("power",this.alpha)};MO.SColor4_copyArray=function(b,d){b[d++]=this.red;b[d++]=this.green;b[d++]=this.blue;b[d++]=this.alpha;return 4};MO.SColor4_toString=function(){return MO.Lang.Float.format(this.red)+","+MO.Lang.Float.format(this.green)+","+MO.Lang.Float.format(this.blue)+","+MO.Lang.Float.format(this.alpha)};
MO.SCorners=function(){this.blue=this.green=this.red=0;this.alpha=1;this.assign=MO.SCorners_assign;this.assignPower=MO.SCorners_assignPower;this.set=MO.SCorners_set;this.serialize=MO.SCorners_serialize;this.unserialize=MO.SCorners_unserialize;this.unserialize3=MO.SCorners_unserialize3;this.saveConfig=MO.SCorners_saveConfig;this.savePower=MO.SCorners_savePower;this.copyArray=MO.SCorners_copyArray;this.toString=MO.SCorners_toString;return this};
MO.SCorners_assign=function(b){this.red=b.red;this.green=b.green;this.blue=b.blue;this.alpha=b.alpha};MO.SCorners_assignPower=function(b){this.red=b.red*b.alpha;this.green=b.green*b.alpha;this.blue=b.blue*b.alpha;this.alpha=b.alpha};MO.SCorners_set=function(b,d,f,h){this.red=b;this.green=d;this.blue=f;this.alpha=h};MO.SCorners_serialize=function(b){b.writeFloat(this.red);b.writeFloat(this.green);b.writeFloat(this.blue);b.writeFloat(this.alpha)};
MO.SCorners_unserialize=function(b){this.red=b.readFloat();this.green=b.readFloat();this.blue=b.readFloat();this.alpha=b.readFloat()};MO.SCorners_unserialize3=function(b){this.red=b.readFloat();this.green=b.readFloat();this.blue=b.readFloat();this.alpha=1};MO.SCorners_saveConfig=function(b){b.setFloat("r",this.red);b.setFloat("g",this.green);b.setFloat("b",this.blue);b.setFloat("a",this.alpha)};
MO.SCorners_savePower=function(b){b.setFloat("r",this.red);b.setFloat("g",this.green);b.setFloat("b",this.blue);b.setFloat("power",this.alpha)};MO.SCorners_copyArray=function(b,d){b[d++]=this.red;b[d++]=this.green;b[d++]=this.blue;b[d++]=this.alpha;return 4};MO.SCorners_toString=function(){return MO.Lang.Float.format(this.red)+","+MO.Lang.Float.format(this.green)+","+MO.Lang.Float.format(this.blue)+","+MO.Lang.Float.format(this.alpha)};
MO.SFrustum=function(){this.center=new MO.SPoint3;this.maxZ=this.minZ=this.maxY=this.minY=this.maxX=this.minX=this.radius=null;this.points=Array(24);this.coners=Array(24);this.updateCenter=MO.SFrustum_updateCenter;this.update=MO.SFrustum_update;this.updateFlat=MO.SFrustum_updateFlat;return this};
MO.SFrustum_updateCenter=function(){var b=this.coners;this.minX=this.minY=this.minZ=Number.MAX_VALUE;this.maxX=this.maxY=this.maxZ=-Number.MAX_VALUE;for(var d=0;24>d;){var f=b[d++];f<this.minX&&(this.minX=f);f>this.maxX&&(this.maxX=f);f=b[d++];f<this.minY&&(this.minY=f);f>this.maxY&&(this.maxY=f);f=b[d++];f<this.minZ&&(this.minZ=f);f>this.maxZ&&(this.maxZ=f)}this.center.x=.5*(this.minX+this.maxX);this.center.y=.5*(this.minY+this.maxY);this.center.z=.5*(this.minZ+this.maxZ);b=this.maxX-this.minX;d=
this.maxY-this.minY;f=this.maxZ-this.minZ;this.radius=.5*Math.sqrt(b*b+d*d+f*f)};MO.SFrustum_update=function(b,d,f,h,q,w,z,A){f=d/f;w=Math.tan(MO.Const.DEGREE_RATE*b*.5);b=h*w;d=b*f;w*=q;z=w*f;f=this.points;f[0]=-d;f[1]=b;f[2]=h;f[3]=d;f[4]=b;f[5]=h;f[6]=d;f[7]=-b;f[8]=h;f[9]=-d;f[10]=-b;f[11]=h;f[12]=-z;f[13]=w;f[14]=q;f[15]=z;f[16]=w;f[17]=q;f[18]=z;f[19]=-w;f[20]=q;f[21]=-z;f[22]=-w;f[23]=q;h=MO.Lang.Math.matrix;h.assign(A);h.invert();h.transform(this.coners,f,8);this.updateCenter()};
MO.SFrustum_updateFlat=function(b,d,f,h,q,w,z,A){d/=f;h*=z;q*=w;z=Math.tan(MO.Const.DEGREE_RATE*b*.5);b=h*z;w=b*d;z*=q;f=z*d;d=this.points;d[0]=-w;d[1]=b;d[2]=h;d[3]=w;d[4]=b;d[5]=h;d[6]=w;d[7]=-b;d[8]=h;d[9]=-w;d[10]=-b;d[11]=h;d[12]=-f;d[13]=z;d[14]=q;d[15]=f;d[16]=z;d[17]=q;d[18]=f;d[19]=-z;d[20]=q;d[21]=-f;d[22]=-z;d[23]=q;h=MO.Lang.Math.matrix;h.assign(A);h.invert();h.transform(this.coners,0,d,0,8);this.coners[1]=0;this.coners[4]=0;this.coners[7]=0;this.coners[10]=0;this.coners[13]=0;this.coners[16]=
0;this.coners[19]=0;this.coners[22]=0;this.updateCenter()};MO.SFrustumPlanes=function(){this.planes=[];this.containsPoint=MO.SFrustumPlanes_containsPoint;this.containsCube=MO.SFrustumPlanes_containsCube;this.containsRectangle=MO.SFrustumPlanes_containsRectangle;this.containsCorners=MO.SFrustumPlanes_containsCorners;this.containsSphere=MO.SFrustumPlanes_containsSphere;this.updateVision=MO.SFrustumPlanes_updateVision;for(var b=0;b<MO.EFrustumPlane.Count;b++)this.planes.push(new MO.SPlane);return this};
MO.SFrustumPlanes_containsPoint=function(b,d,f){for(var h=this.planes,q=0;q<MO.EFrustumPlane.Count;q++)if(0>h[n].dot(b,d,f))return!1;return!0};MO.SFrustumPlanes_containsCube=function(b,d,f,h){h=this.planes;for(var q=0;q<MO.EFrustumPlane.Count;q++){var w=h[n];if(!(0<=w.dot(b-l,d-l,f-l)||0<=w.dot(b+l,d-l,f-l)||0<=w.dot(b-l,d+l,f-l)||0<=w.dot(b+l,d+l,f-l)||0<=w.dot(b-l,d-l,f+l)||0<=w.dot(b+l,d-l,f+l)||0<=w.dot(b-l,d+l,f+l)||0<=w.dot(b+l,d+l,f+l)))return!1}return!0};
MO.SFrustumPlanes_containsRectangle=function(b,d,f,h,q,w){for(var z=this.planes,A=0;A<MO.EFrustumPlane.Count;A++){var B=z[n];if(!(0<=B.dot(b-h,d-q,f-w)||0<=B.dot(b+h,d-q,f-w)||0<=B.dot(b-h,d+q,f-w)||0<=B.dot(b+h,d+q,f-w)||0<=B.dot(b-h,d-q,f+w)||0<=B.dot(b+h,d-q,f+w)||0<=B.dot(b-h,d+q,f+w)||0<=B.dot(b+h,d+q,f+w)))return!1}return!0};
MO.SFrustumPlanes_containsCorners=function(b){for(var d=this.planes,f=MO.EFrustumPlane.Count-1;0<=f;f--){var h=d[f];if(!(0<=h.dot(b[0],b[1],b[2])||0<=h.dot(b[3],b[4],b[5])||0<=h.dot(b[6],b[7],b[8])||0<=h.dot(b[9],b[10],b[11])||0<=h.dot(b[12],b[13],b[14])||0<=h.dot(b[15],b[16],b[17])||0<=h.dot(b[18],b[19],b[20])||0<=h.dot(b[21],b[22],b[23])))return!1}return!0};MO.SFrustumPlanes_containsSphere=function(b,d,f,h){for(var q=this.planes,w=0;w<MO.EFrustumPlane.Count;w++)if(q[n].dot(b,d,f)<-h)return!1;return!0};
MO.SFrustumPlanes_updateVision=function(b){var d=this.planes,f=d[MO.EFrustumPlane.Near];f.a=b[3]+b[2];f.b=b[7]+b[6];f.c=b[11]+b[10];f.d=b[15]+b[14];f.normalize();f=d[MO.EFrustumPlane.Far];f.a=b[3]-b[2];f.b=b[7]-b[6];f.c=b[11]-b[10];f.d=b[15]-b[14];f.normalize();f=d[MO.EFrustumPlane.Left];f.a=b[3]-b[0];f.b=b[7]-b[4];f.c=b[11]-b[8];f.d=b[15]-b[12];f.normalize();f=d[MO.EFrustumPlane.Right];f.a=b[3]+b[0];f.b=b[7]+b[4];f.c=b[11]+b[8];f.d=b[15]+b[12];f.normalize();f=d[MO.EFrustumPlane.Top];f.a=b[3]-b[1];
f.b=b[7]-b[5];f.c=b[11]-b[9];f.d=b[15]-b[13];f.normalize();d=d[MO.EFrustumPlane.Bottom];d.a=b[3]+b[1];d.b=b[7]+b[5];d.c=b[11]+b[9];d.d=b[15]+b[13];d.normalize()};
MO.SMatrix3d=function(){MO.SMatrix4x4.call(this);this._dirty=!1;this.rz=this.ry=this.rx=this.tz=this.ty=this.tx=0;this.sz=this.sy=this.sx=1;this.isIdentity=MO.SMatrix3d_isIdentity;this.identity=MO.SMatrix3d_identity;this.setTranslate=MO.SMatrix3d_setTranslate;this.setRotation=MO.SMatrix3d_setRotation;this.setScale=MO.SMatrix3d_setScale;this.setScaleAll=MO.SMatrix3d_setScaleAll;this.set=MO.SMatrix3d_set;this.setAll=MO.SMatrix3d_setAll;this.equals=MO.SMatrix3d_equals;this.assign=MO.SMatrix3d_assign;
this.attach=MO.SMatrix3d_attach;this.append=MO.SMatrix3d_append;this.updateForce=MO.SMatrix3d_updateForce;this.update=MO.SMatrix3d_update;this.merge=MO.SMatrix3d_merge;this.serialize=MO.SMatrix3d_serialize;this.unserialize=MO.SMatrix3d_unserialize;this.saveConfig=MO.SMatrix3d_saveConfig;this.identity();return this};MO.SMatrix3d_isIdentity=function(){return 0!=this.tx||0!=this.ty||0!=this.tz||0!=this.rx||0!=this.ry||0!=this.rz||1!=this.sx||1!=this.sy||1!=this.sz?!1:this.isIdentityData()};
MO.SMatrix3d_identity=function(){this.rx=this.ry=this.rz=this.tx=this.ty=this.tz=0;this.sx=this.sy=this.sz=1;return this.identityData()};MO.SMatrix3d_setTranslate=function(b,d,f){this.tx=b;this.ty=d;this.tz=f;this._dirty=!0};MO.SMatrix3d_setRotation=function(b,d,f){this.rx=b;this.ry=d;this.rz=f;this._dirty=!0};MO.SMatrix3d_setScale=function(b,d,f){this.sx=b;this.sy=d;this.sz=f;this._dirty=!0};MO.SMatrix3d_setScaleAll=function(b){this.sz=this.sy=this.sx=b;this._dirty=!0};
MO.SMatrix3d_set=function(b,d,f){this.tx=b.x;this.ty=b.y;this.tz=b.z;this.rx=d.x;this.ry=d.y;this.rz=d.z;this.sx=f.x;this.sy=f.y;this.sz=f.z;this._dirty=!0};MO.SMatrix3d_setAll=function(b,d,f,h,q,w,z,A,B){this.tx=b;this.ty=d;this.tz=f;this.rx=h;this.ry=q;this.rz=w;this.sx=z;this.sy=A;this.sz=B;this._dirty=!0};MO.SMatrix3d_equals=function(b){return this.equalsData(b._data)};
MO.SMatrix3d_assign=function(b){this.tx=b.tx;this.ty=b.ty;this.tz=b.tz;this.rx=b.rx;this.ry=b.ry;this.rz=b.rz;this.sx=b.sx;this.sy=b.sy;this.sz=b.sz;this.assignData(b._data)};MO.SMatrix3d_attach=function(b){this.tx=b.tx;this.ty=b.ty;this.tz=b.tz;this.rx=b.rx;this.ry=b.ry;this.rz=b.rz;this.sx=b.sx;this.sy=b.sy;this.sz=b.sz;return this.attachData(b._data)};MO.SMatrix3d_append=function(b){this.appendData(b._data)};
MO.SMatrix3d_updateForce=function(){var b=this._data,d=Math.sin(this.rx),f=Math.cos(this.rx),h=Math.sin(this.ry),q=Math.cos(this.ry),w=Math.sin(this.rz),z=Math.cos(this.rz);b[0]=q*z*this.sx;b[1]=q*w*this.sx;b[2]=-h*this.sx;b[3]=0;b[4]=(d*h*z-f*w)*this.sy;b[5]=(d*h*w+f*z)*this.sy;b[6]=d*q*this.sy;b[7]=0;b[8]=(f*h*z+d*w)*this.sz;b[9]=(f*h*w-d*z)*this.sz;b[10]=f*q*this.sz;b[11]=0;b[12]=this.tx;b[13]=this.ty;b[14]=this.tz;b[15]=1};
MO.SMatrix3d_update=function(){this._dirty&&(this.updateForce(),this._dirty=!1)};MO.SMatrix3d_merge=function(b,d){this.tx=b.tx+d.tx;this.ty=b.ty+d.ty;this.tz=b.tz+d.tz;this.rx=b.rx+d.rx;this.ry=b.ry+d.ry;this.rz=b.rz+d.rz;this.sx=b.sx*d.sx;this.sy=b.sy*d.sy;this.sz=b.sz*d.sz;this.updateForce()};
MO.SMatrix3d_serialize=function(b){b.writeFloat(this.tx);b.writeFloat(this.ty);b.writeFloat(this.tz);b.writeFloat(this.rx);b.writeFloat(this.ry);b.writeFloat(this.rz);b.writeFloat(this.sx);b.writeFloat(this.sy);b.writeFloat(this.sz)};MO.SMatrix3d_unserialize=function(b){this.tx=b.readFloat();this.ty=b.readFloat();this.tz=b.readFloat();this.rx=b.readFloat();this.ry=b.readFloat();this.rz=b.readFloat();this.sx=b.readFloat();this.sy=b.readFloat();this.sz=b.readFloat();this.updateForce()};
MO.SMatrix3d_saveConfig=function(b){b.set("tx",MO.Lang.Float.format(this.tx));b.set("ty",MO.Lang.Float.format(this.ty));b.set("tz",MO.Lang.Float.format(this.tz));b.set("rx",MO.Lang.Float.format(this.rx));b.set("ry",MO.Lang.Float.format(this.ry));b.set("rz",MO.Lang.Float.format(this.rz));b.set("sx",MO.Lang.Float.format(this.sx));b.set("sy",MO.Lang.Float.format(this.sy));b.set("sz",MO.Lang.Float.format(this.sz))};
MO.SMatrix3x3=function(){this._data=Array(9);this.data=MO.SMatrix3x3_data;this.equalsData=MO.SMatrix3x3_equalsData;this.assignData=MO.SMatrix3x3_assignData;this.appendData=MO.SMatrix3x3_appendData;this.rotationX=MO.SMatrix3x3_rotationX;this.rotationY=MO.SMatrix3x3_rotationY;this.rotationZ=MO.SMatrix3x3_rotationZ;this.rotation=MO.SMatrix3x3_rotation;this.invert=MO.SMatrix3x3_invert;this.transform=MO.SMatrix3x3_transform;this.transformPoint3=MO.SMatrix3x3_transformPoint3;this.build=MO.SMatrix3x3_build;
this.writeData=MO.SMatrix3x3_writeData;this.toString=MO.SMatrix3x3_toString;return this};MO.SMatrix3x3_data=function(){return this._data};MO.SMatrix3x3_equalsData=function(b){for(var d=this._data,f=0;9>f;f++)if(d[f]!=b[f])return!1;return!0};MO.SMatrix3x3_assignData=function(b){for(var d=this._data,f=0;9>f;f++)d[f]=b[f]};
MO.SMatrix3x3_appendData=function(b){var d=this._data,f=d[0]*b[1]+d[1]*b[4]+d[2]*b[7],h=d[0]*b[2]+d[1]*b[5]+d[2]*b[8],q=d[3]*b[0]+d[4]*b[3]+d[5]*b[6],w=d[3]*b[1]+d[4]*b[4]+d[5]*b[7],z=d[3]*b[2]+d[4]*b[5]+d[5]*b[8],A=d[6]*b[0]+d[7]*b[3]+d[8]*b[6],B=d[6]*b[1]+d[7]*b[4]+d[8]*b[7],C=d[6]*b[2]+d[7]*b[5]+d[8]*b[8];d[0]=d[0]*b[0]+d[1]*b[3]+d[2]*b[6];d[1]=f;d[2]=h;d[3]=q;d[4]=w;d[5]=z;d[6]=A;d[7]=B;d[8]=C};
MO.SMatrix3x3_rotationX=function(b){var d=Math.sin(b);b=Math.cos(b);var f=MO.Lang.Math.value9;f[0]=1;f[1]=0;f[2]=0;f[3]=0;f[4]=b;f[5]=d;f[6]=0;f[7]=-d;f[8]=b;this.appendData(f)};MO.SMatrix3x3_rotationY=function(b){var d=Math.sin(b);b=Math.cos(b);var f=RMath.value9;f[0]=b;f[1]=0;f[2]=d;f[3]=0;f[4]=1;f[5]=0;f[6]=-d;f[7]=0;f[8]=b;this.appendData(f)};MO.SMatrix3x3_rotationZ=function(b){var d=Math.sin(b);b=Math.cos(b);var f=RMath.value9;f[0]=b;f[1]=d;f[2]=0;f[3]=-d;f[4]=b;f[5]=1;f[6]=0;f[7]=0;f[8]=1;this.appendData(f)};
MO.SMatrix3x3_rotation=function(b,d,f){var h=Math.sin(b);b=Math.cos(b);var q=Math.sin(d);d=Math.cos(d);var w=Math.sin(f);f=Math.cos(f);var z=RMath.value9;z[0]=d*f;z[1]=d*w;z[2]=-q;z[3]=h*q*f-b*w;z[4]=h*q*w+b*f;z[5]=h*d;z[6]=b*q*f+h*w;z[7]=b*q*w-h*b;z[8]=b*d;this.appendData(z)};
MO.SMatrix3x3_invert=function(){var b=this._data,d=RValue.value9;d[0]=b[4]*b[8]-b[5]*b[7];d[1]=b[2]*b[7]-b[1]*b[8];d[2]=b[1]*b[5]-b[2]*b[4];d[3]=b[5]*b[6]-b[3]*b[8];d[4]=b[0]*b[8]-b[2]*b[6];d[5]=b[2]*b[3]-b[0]*b[5];d[6]=b[3]*b[7]-b[4]*b[6];d[7]=b[1]*b[6]-b[0]*b[7];d[8]=b[0]*b[4]-b[1]*b[3];var f=b[0]*d[0]+b[1]*d[3]+b[2]*d[6];if(0==f)return!1;for(var f=1/f,h=0;9>h;h++)b[h]=d[h]*f;return!0};
MO.SMatrix3x3_transform=function(b,d,f){for(var h=this._data,q=0;q<f;q++){var w=(q<<1)+q;b[w]=d[w]*h[0]+d[w+1]*h[3]+d[w+2]*h[6];b[w+1]=d[w]*h[1]+d[w+1]*h[4]+d[w+2]*h[7];b[w+2]=d[w]*h[2]+d[w+1]*h[5]+d[w+2]*h[8]}};MO.SMatrix3x3_transformPoint3=function(b,d){var f=this._data,h=b.x*f[0]+b.y*f[3]+b.z*f[6],q=b.x*f[1]+b.y*f[4]+b.z*f[7],f=b.x*f[2]+b.y*f[5]+b.z*f[8],w=null,w=d?d:new SPoint3;w.set(h,q,f);return w};
MO.SMatrix3x3_build=function(b){var d=this._data,f=b.x*b.x,h=b.y*b.y,q=b.z*b.z,w=b.x*b.y,z=b.x*b.z,A=b.y*b.z,B=b.w*b.x,C=b.w*b.y;b=b.w*b.z;d[0]=1-2*(h+q);d[1]=2*(w-b);d[2]=2*(z+C);d[3]=2*(w+b);d[4]=1-2*(f+q);d[5]=2*(A-B);d[6]=2*(z-C);d[7]=2*(A+B);d[8]=1-2*(f+h)};MO.SMatrix3x3_writeData=function(b,d){var f=this._data;b[d++]=f[0];b[d++]=f[3];b[d++]=f[6];b[d++]=f[1];b[d++]=f[4];b[d++]=f[7];b[d++]=f[2];b[d++]=f[5];b[d++]=f[8]};
MO.SMatrix3x3_toString=function(){for(var b=this._data,d=new MO.TString,f=0;3>f;f++){0<f&&d.append("|");for(var h=0;3>h;h++){var q=b[3*f+h];0<h&&d.append(",");d.append(MO.Lang.Float.format(q,0,null,3,null))}}return d.flush()};
MO.SMatrix4x4=function(){this._data=Array(16);this.data=MO.SMatrix4x4_data;this.isIdentityData=MO.SMatrix4x4_isIdentityData;this.identityData=MO.SMatrix4x4_identityData;this.equalsData=MO.SMatrix4x4_equalsData;this.assignData=MO.SMatrix4x4_assignData;this.attachData=MO.SMatrix4x4_attachData;this.appendData=MO.SMatrix4x4_appendData;this.addTranslate=MO.SMatrix4x4_addTranslate;this.addRotationX=MO.SMatrix4x4_addRotationX;this.addRotationY=MO.SMatrix4x4_addRotationY;this.addRotationZ=MO.SMatrix4x4_addRotationZ;
this.addRotation=MO.SMatrix4x4_addRotation;this.addScale=MO.SMatrix4x4_addScale;this.invert=MO.SMatrix4x4_invert;this.transform=MO.SMatrix4x4_transform;this.transformPoint3=MO.SMatrix4x4_transformPoint3;this.buildQuaternion=MO.SMatrix4x4_buildQuaternion;this.build=MO.SMatrix4x4_build;this.writeData=MO.SMatrix4x4_writeData;this.writeData4x3=MO.SMatrix4x4_writeData4x3;this.toString=MO.SMatrix4x4_toString;return this};MO.SMatrix4x4_data=function(){return this._data};
MO.SMatrix4x4_isIdentityData=function(){for(var b=this._data,d=MO.Const.identity4x4,f=0;16>f;f++)if(b[f]!=d[f])return!1;return!0};MO.SMatrix4x4_identityData=function(){for(var b=this._data,d=MO.Const.identity4x4,f=0;16>f;f++)b[f]=d[f];return this};MO.SMatrix4x4_equalsData=function(b){for(var d=this._data,f=0;16>f;f++)if(d[f]!=b[f])return!1;return!0};MO.SMatrix4x4_assignData=function(b){for(var d=this._data,f=0;16>f;f++)d[f]=b[f]};
MO.SMatrix4x4_attachData=function(b){for(var d=!1,f=this._data,h=0;16>h;h++){var q=b[h];d||f[h]!=q&&(d=!0);f[h]=q}return d};
MO.SMatrix4x4_appendData=function(b){var d=this._data,f=d[0]*b[1]+d[1]*b[5]+d[2]*b[9]+d[3]*b[13],h=d[0]*b[2]+d[1]*b[6]+d[2]*b[10]+d[3]*b[14],q=d[0]*b[3]+d[1]*b[7]+d[2]*b[11]+d[3]*b[15],w=d[4]*b[0]+d[5]*b[4]+d[6]*b[8]+d[7]*b[12],z=d[4]*b[1]+d[5]*b[5]+d[6]*b[9]+d[7]*b[13],A=d[4]*b[2]+d[5]*b[6]+d[6]*b[10]+d[7]*b[14],B=d[4]*b[3]+d[5]*b[7]+d[6]*b[11]+d[7]*b[15],C=d[8]*b[0]+d[9]*b[4]+d[10]*b[8]+d[11]*b[12],D=d[8]*b[1]+d[9]*b[5]+d[10]*b[9]+d[11]*b[13],E=d[8]*b[2]+d[9]*b[6]+d[10]*b[10]+d[11]*b[14],F=d[8]*
b[3]+d[9]*b[7]+d[10]*b[11]+d[11]*b[15],H=d[12]*b[0]+d[13]*b[4]+d[14]*b[8]+d[15]*b[12],I=d[12]*b[1]+d[13]*b[5]+d[14]*b[9]+d[15]*b[13],J=d[12]*b[2]+d[13]*b[6]+d[14]*b[10]+d[15]*b[14],G=d[12]*b[3]+d[13]*b[7]+d[14]*b[11]+d[15]*b[15];d[0]=d[0]*b[0]+d[1]*b[4]+d[2]*b[8]+d[3]*b[12];d[1]=f;d[2]=h;d[3]=q;d[4]=w;d[5]=z;d[6]=A;d[7]=B;d[8]=C;d[9]=D;d[10]=E;d[11]=F;d[12]=H;d[13]=I;d[14]=J;d[15]=G};
MO.SMatrix4x4_addTranslate=function(b,d,f){var h=MO.Lang.Array.array16;h[0]=1;h[1]=0;h[2]=0;h[3]=0;h[4]=0;h[5]=1;h[6]=0;h[7]=0;h[8]=0;h[9]=0;h[10]=1;h[11]=0;h[12]=b;h[13]=d;h[14]=f;h[15]=1;this.appendData(h)};MO.SMatrix4x4_addRotationX=function(b){var d=Math.sin(b);b=Math.cos(b);var f=MO.Lang.Array.array16;f[0]=1;f[1]=0;f[2]=0;f[3]=0;f[4]=0;f[5]=b;f[6]=d;f[7]=0;f[8]=0;f[9]=-d;f[10]=b;f[11]=0;f[12]=0;f[13]=0;f[14]=0;f[15]=1;this.appendData(f)};
MO.SMatrix4x4_addRotationY=function(b){var d=Math.sin(b);b=Math.cos(b);var f=MO.Lang.Array.array16;f[0]=b;f[1]=0;f[2]=d;f[3]=0;f[4]=0;f[5]=1;f[6]=0;f[7]=0;f[8]=-d;f[9]=0;f[10]=b;f[11]=0;f[12]=0;f[13]=0;f[14]=0;f[15]=1;this.appendData(f)};MO.SMatrix4x4_addRotationZ=function(b){var d=Math.sin(b);b=Math.cos(b);var f=MO.Lang.Array.array16;f[0]=b;f[1]=d;f[2]=0;f[3]=0;f[4]=-d;f[5]=b;f[6]=1;f[7]=0;f[8]=0;f[9]=0;f[10]=1;f[11]=0;f[12]=0;f[13]=0;f[14]=0;f[15]=1;this.appendData(f)};
MO.SMatrix4x4_addRotation=function(b,d,f){var h=Math.sin(b);b=Math.cos(b);var q=Math.sin(d);d=Math.cos(d);var w=Math.sin(f);f=Math.cos(f);var z=MO.Lang.Array.array16;z[0]=d*f;z[1]=d*w;z[2]=-q;z[3]=0;z[4]=h*q*f-b*w;z[5]=h*q*w+b*f;z[6]=h*d;z[7]=0;z[8]=b*q*f+h*w;z[9]=b*q*w-h*b;z[10]=b*d;z[11]=0;z[12]=0;z[13]=0;z[14]=0;z[15]=1;this.appendData(z)};
MO.SMatrix4x4_addScale=function(b,d,f){var h=MO.Lang.Array.array16;h[0]=b;h[1]=0;h[2]=0;h[3]=0;h[4]=0;h[5]=d;h[6]=0;h[7]=0;h[8]=0;h[9]=0;h[10]=f;h[11]=0;h[12]=0;h[13]=0;h[14]=0;h[15]=1;this.appendData(h)};
MO.SMatrix4x4_invert=function(){var b=this._data,d=MO.Lang.Array.array16;d[0]=b[5]*b[10]*b[15]-b[5]*b[11]*b[14]-b[9]*b[6]*b[15]+b[9]*b[7]*b[14]+b[13]*b[6]*b[11]-b[13]*b[7]*b[10];d[4]=-(b[4]*b[10]*b[15])+b[4]*b[11]*b[14]+b[8]*b[6]*b[15]-b[8]*b[7]*b[14]-b[12]*b[6]*b[11]+b[12]*b[7]*b[10];d[8]=b[4]*b[9]*b[15]-b[4]*b[11]*b[13]-b[8]*b[5]*b[15]+b[8]*b[7]*b[13]+b[12]*b[5]*b[11]-b[12]*b[7]*b[9];d[12]=-(b[4]*b[9]*b[14])+b[4]*b[10]*b[13]+b[8]*b[5]*b[14]-b[8]*b[6]*b[13]-b[12]*b[5]*b[10]+b[12]*b[6]*b[9];d[1]=
-(b[1]*b[10]*b[15])+b[1]*b[11]*b[14]+b[9]*b[2]*b[15]-b[9]*b[3]*b[14]-b[13]*b[2]*b[11]+b[13]*b[3]*b[10];d[5]=b[0]*b[10]*b[15]-b[0]*b[11]*b[14]-b[8]*b[2]*b[15]+b[8]*b[3]*b[14]+b[12]*b[2]*b[11]-b[12]*b[3]*b[10];d[9]=-(b[0]*b[9]*b[15])+b[0]*b[11]*b[13]+b[8]*b[1]*b[15]-b[8]*b[3]*b[13]-b[12]*b[1]*b[11]+b[12]*b[3]*b[9];d[13]=b[0]*b[9]*b[14]-b[0]*b[10]*b[13]-b[8]*b[1]*b[14]+b[8]*b[2]*b[13]+b[12]*b[1]*b[10]-b[12]*b[2]*b[9];d[2]=b[1]*b[6]*b[15]-b[1]*b[7]*b[14]-b[5]*b[2]*b[15]+b[5]*b[3]*b[14]+b[13]*b[2]*b[7]-
b[13]*b[3]*b[6];d[6]=-(b[0]*b[6]*b[15])+b[0]*b[7]*b[14]+b[4]*b[2]*b[15]-b[4]*b[3]*b[14]-b[12]*b[2]*b[7]+b[12]*b[3]*b[6];d[10]=b[0]*b[5]*b[15]-b[0]*b[7]*b[13]-b[4]*b[1]*b[15]+b[4]*b[3]*b[13]+b[12]*b[1]*b[7]-b[12]*b[3]*b[5];d[14]=-(b[0]*b[5]*b[14])+b[0]*b[6]*b[13]+b[4]*b[1]*b[14]-b[4]*b[2]*b[13]-b[12]*b[1]*b[6]+b[12]*b[2]*b[5];d[3]=-(b[1]*b[6]*b[11])+b[1]*b[7]*b[10]+b[5]*b[2]*b[11]-b[5]*b[3]*b[10]-b[9]*b[2]*b[7]+b[9]*b[3]*b[6];d[7]=b[0]*b[6]*b[11]-b[0]*b[7]*b[10]-b[4]*b[2]*b[11]+b[4]*b[3]*b[10]+b[8]*
b[2]*b[7]-b[8]*b[3]*b[6];d[11]=-(b[0]*b[5]*b[11])+b[0]*b[7]*b[9]+b[4]*b[1]*b[11]-b[4]*b[3]*b[9]-b[8]*b[1]*b[7]+b[8]*b[3]*b[5];d[15]=b[0]*b[5]*b[10]-b[0]*b[6]*b[9]-b[4]*b[1]*b[10]+b[4]*b[2]*b[9]+b[8]*b[1]*b[6]-b[8]*b[2]*b[5];var f=b[0]*d[0]+b[1]*d[4]+b[2]*d[8]+b[3]*d[12];if(0==f)return!1;for(var f=1/f,h=0;16>h;h++)b[h]=d[h]*f;return!0};
MO.SMatrix4x4_transform=function(b,d,f,h,q){for(var w=this._data,z=0;z<q;z++){var A=f[h++],B=f[h++],C=f[h++];b[d++]=A*w[0]+B*w[4]+C*w[8]+w[12];b[d++]=A*w[1]+B*w[5]+C*w[9]+w[13];b[d++]=A*w[2]+B*w[6]+C*w[10]+w[14]}};MO.SMatrix4x4_transformPoint3=function(b,d){var f=this._data,h=b.x*f[0]+b.y*f[4]+b.z*f[8]+f[12],q=b.x*f[1]+b.y*f[5]+b.z*f[9]+f[13],f=b.x*f[2]+b.y*f[6]+b.z*f[10]+f[14],w=null,w=d?d:new MO.SPoint3;w.set(h,q,f);return w};
MO.SMatrix4x4_build=function(b,d,f){var h=this._data,q=d.x*d.x,w=d.y*d.y,z=d.z*d.z,A=d.x*d.y,B=d.x*d.z,C=d.y*d.z,D=d.w*d.x,E=d.w*d.y;d=d.w*d.z;h[0]=(1-2*(w+z))*f.x;h[1]=2*(A-d)*f.x;h[2]=2*(B+E)*f.x;h[3]=0;h[4]=2*(A+d)*f.y;h[5]=(1-2*(q+z))*f.y;h[6]=2*(C-D)*f.y;h[7]=0;h[8]=2*(B-E)*f.z;h[9]=2*(C+D)*f.z;h[10]=(1-2*(q+w))*f.z;h[11]=0;h[12]=b.x;h[13]=b.y;h[14]=b.z;h[15]=1};
MO.SMatrix4x4_buildQuaternion=function(b){var d=this._data,f=b.x*b.x,h=b.y*b.y,q=b.z*b.z,w=b.x*b.y,z=b.x*b.z,A=b.y*b.z,B=b.w*b.x,C=b.w*b.y;b=b.w*b.z;d[0]=1-2*(h+q);d[1]=2*(w-b);d[2]=2*(z+C);d[3]=0;d[4]=2*(w+b);d[5]=1-2*(f+q);d[6]=2*(A-B);d[7]=0;d[8]=2*(z-C);d[9]=2*(A+B);d[10]=1-2*(f+h);d[11]=0;d[12]=0;d[13]=0;d[14]=0;d[15]=1};
MO.SMatrix4x4_writeData=function(b,d){var f=this._data;b[d++]=f[0];b[d++]=f[4];b[d++]=f[8];b[d++]=f[12];b[d++]=f[1];b[d++]=f[5];b[d++]=f[9];b[d++]=f[13];b[d++]=f[2];b[d++]=f[6];b[d++]=f[10];b[d++]=f[14];b[d++]=f[3];b[d++]=f[7];b[d++]=f[11];b[d++]=f[15]};MO.SMatrix4x4_writeData4x3=function(b,d){var f=this._data;b[d++]=f[0];b[d++]=f[4];b[d++]=f[8];b[d++]=f[12];b[d++]=f[1];b[d++]=f[5];b[d++]=f[9];b[d++]=f[13];b[d++]=f[2];b[d++]=f[6];b[d++]=f[10];b[d++]=f[14]};
MO.SMatrix4x4_toString=function(){for(var b=this._data,d=new MO.TString,f=0;4>f;f++){0<f&&d.append("|");for(var h=0;4>h;h++){var q=b[4*f+h];0<h&&d.append(",");d.append(MO.Lang.Float.format(q,0,null,3,null))}}return d.flush()};
MO.SOutline3=function(){this.min=new MO.SPoint3;this.max=new MO.SPoint3;this.isEmpty=MO.SOutline3_isEmpty;this.assign=MO.SOutline3_assign;this.setMin=MO.SOutline3_setMin;this.setMax=MO.SOutline3_setMax;this.set=MO.SOutline3_set;this.mergeMin=MO.SOutline3_mergeMin;this.mergeMax=MO.SOutline3_mergeMax;this.mergePoint=MO.SOutline3_mergePoint;this.serialize=MO.SOutline3_serialize;this.unserialize=MO.SOutline3_unserialize;this.toString=MO.SOutline3_toString;return this};
MO.SOutline3_isEmpty=function(b){return this.min.isEmpty()&&this.max.isEmpty()};MO.SOutline3_assign=function(b){this.min.assign(b.min);this.max.assign(b.max)};MO.SOutline3_setMin=function(){this.min.setMax();this.max.setMin()};MO.SOutline3_setMax=function(){this.min.setMin();this.max.setMax()};MO.SOutline3_set=function(b,d,f,h,q,w){this.min.set(b,d,f);this.max.set(h,q,w)};MO.SOutline3_mergeMin=function(b){this.min.mergeMax(b.min);this.max.mergeMin(b.max)};
MO.SOutline3_mergeMax=function(b){this.min.mergeMin(b.min);this.max.mergeMax(b.max)};MO.SOutline3_mergePoint=function(b,d,f){this.min.mergeMin3(b,d,f);this.max.mergeMax3(b,d,f)};MO.SOutline3_serialize=function(b){this.min.serialize(b);this.max.serialize(b)};MO.SOutline3_unserialize=function(b){this.min.unserialize(b);this.max.unserialize(b)};MO.SOutline3_toString=function(){return"("+this.min+")-("+this.max+")"};
MO.SOutline3d=function(){MO.SOutline3.call(this);this.center=new MO.SPoint3;this.distance=new MO.SPoint3;this.radius=0;this.points=Array(24);this.assign=MO.SOutline3d_assign;this.update=MO.SOutline3d_update;this.calculateFrom=MO.SOutline3d_calculateFrom;this.calculate=MO.SOutline3d_calculate;return this};MO.SOutline3d_assign=function(b){this.center.assign(b.center);this.distance.assign(b.distance);this.radius=b.radius;for(var d=0;24>d;d++)this.points[d]=b.points[d]};
MO.SOutline3d_update=function(){var b=this.min,d=b.x,f=b.y,b=b.z,h=this.max,q=h.x,w=h.y,h=h.z,z=this.points;z[0]=d;z[1]=w;z[2]=b;z[3]=q;z[4]=w;z[5]=b;z[6]=q;z[7]=f;z[8]=b;z[9]=d;z[10]=f;z[11]=b;z[12]=d;z[13]=w;z[14]=h;z[15]=q;z[16]=w;z[17]=h;z[18]=q;z[19]=f;z[20]=h;z[21]=d;z[22]=f;z[23]=h;z=this.center;z.x=.5*(d+q);z.y=.5*(f+w);z.z=.5*(b+h);z=this.distance;z.x=q-d;z.y=w-f;z.z=h-b;d=q-d;f=w-f;b=h-b;this.radius=.5*Math.sqrt(d*d+f*f+b*b)};
MO.SOutline3d_calculateFrom=function(b,d){var f=this.points;d.transform(f,0,b.points,0,8);for(var h=minY=minZ=Number.MAX_VALUE,q=maxY=maxZ=-Number.MAX_VALUE,w=0;24>w;){var z=f[w++];z<h&&(h=z);z>q&&(q=z);z=f[w++];z<minY&&(minY=z);z>maxY&&(maxY=z);z=f[w++];z<minZ&&(minZ=z);z>maxZ&&(maxZ=z)}this.min.set(h,minY,minZ);this.max.set(q,maxY,maxZ);this.update()};
MO.SOutline3d_calculate=function(b){b=viy=viz=Number.MAX_VALUE;for(var d=vay=vaz=-Number.MAX_VALUE,f=0,h=this.points;24>f;){var q=h[f++];q<b&&(b=q);q>d&&(d=q);q=h[f++];q<viy&&(viy=q);q>vay&&(vay=q);q=h[f++];q<viz&&(viz=q);q>vaz&&(vaz=q)}this.min.set(b,viy,viz);this.max.set(d,vay,vaz);this.center.x=.5*(b+d);this.center.y=.5*(viy+vay);this.center.z=.5*(viz+vaz);b=d-b;d=vay-viy;f=vaz-viz;this.radius=.5*Math.sqrt(b*b+d*d+f*f)};
MO.SPadding=function(b,d,f,h){this.left=MO.Lang.Integer.nvl(b);this.top=MO.Lang.Integer.nvl(d);this.right=MO.Lang.Integer.nvl(f);this.bottom=MO.Lang.Integer.nvl(h);this.isEmpty=MO.SPadding_isEmpty;this.reset=MO.SPadding_reset;this.assign=MO.SPadding_assign;this.set=MO.SPadding_set;this.parse=MO.SPadding_parse;this.toString=MO.SPadding_toString;this.dispose=MO.SPadding_dispose;this.dump=MO.SPadding_dump;return this};
MO.SPadding_isEmpty=function(){return 0==this.left&&0==this.top&&0==this.right&&0==this.bottom};MO.SPadding_reset=function(){this.bottom=this.right=this.top=this.left=0};MO.SPadding_assign=function(b){this.left=b.left;this.top=b.top;this.right=b.right;this.bottom=b.bottom};MO.SPadding_set=function(b,d,f,h){this.left=b;this.top=d;this.right=f;this.bottom=h};
MO.SPadding_parse=function(b){var d=b.split(",");if(4==d.length)this.left=parseInt(d[0]),this.top=parseInt(d[1]),this.right=parseInt(d[2]),this.bottom=parseInt(d[3]);else throw new MO.TError(this,"Parse value failure. (value={1})",b);};MO.SPadding_toString=function(){return this.left+","+this.top+","+this.right+","+this.bottom};MO.SPadding_dispose=function(){this.bottom=this.right=this.top=this.left=null};
MO.SPadding_dump=function(b){return MO.Class.dump(this)+" ["+this.left+","+this.top+","+this.right+","+this.bottom+"]"};MO.SPlane=function(){this.d=this.c=this.b=this.a=0;this.assign=MO.SPlane_assign;this.set=MO.SPlane_set;this.normalize=MO.SPlane_normalize;this.dot=MO.SPlane_dot;this.toString=MO.SPlane_toString;this.dump=MO.SPlane_dump;return this};MO.SPlane_assign=function(b){this.a=b.a;this.b=b.b;this.c=b.c;this.d=b.d};MO.SPlane_set=function(b,d,f,h){this.a=b;this.b=d;this.c=f;this.d=h};
MO.SPlane_normalize=function(){var b=1/Math.sqrt(this.a*this.a+this.b*this.b+this.c*this.c);this.a*=b;this.b*=b;this.c*=b;this.d*=b};MO.SPlane_dot=function(b,d,f){return b*this.a+d*this.b+f*this.c+this.d};MO.SPlane_toString=function(){return this.a+","+this.b+","+this.c+","+this.d};MO.SPlane_dump=function(){return MO.Class.dump(this)+" ["+this.toString()+"]"};
MO.SPoint2=function(b,d){this.x=MO.Lang.Integer.nvl(b);this.y=MO.Lang.Integer.nvl(d);this.isEmpty=MO.SPoint2_isEmpty;this.equals=MO.SPoint2_equals;this.assign=MO.SPoint2_assign;this.set=MO.SPoint2_set;this.serialize=MO.SPoint2_serialize;this.unserialize=MO.SPoint2_unserialize;this.parse=MO.SPoint2_parse;this.toString=MO.SPoint2_toString;this.dispose=MO.SPoint2_dispose;this.dump=MO.SPoint2_dump;return this};MO.SPoint2_isEmpty=function(){return 0==this.x&&0==this.y};
MO.SPoint2_equals=function(b){return b?this.x==b.x&&this.y==b.y:!1};MO.SPoint2_assign=function(b){this.x=b.x;this.y=b.y};MO.SPoint2_set=function(b,d){this.x=b;this.y=d};MO.SPoint2_serialize=function(b){b.writeFloat(this.x);b.writeFloat(this.y)};MO.SPoint2_unserialize=function(b){this.x=b.readFloat();this.y=b.readFloat()};MO.SPoint2_parse=function(b){var d=b.split(",");if(2==d.length)this.x=parseInt(d[0]),this.y=parseInt(d[1]);else throw new TError(this,"Parse value failure. (value={1})",b);};
MO.SPoint2_toString=function(){return this.x+","+this.y};MO.SPoint2_dispose=function(){this.y=this.x=null};MO.SPoint2_dump=function(){return MO.Class.dump(this)+" ["+this.x+","+this.y+"]"};MO.SPoint3=function(b,d,f){MO.SValue3.call(this,b,d,f);this.conjugate=MO.SPoint3_conjugate;this.mergeMin=MO.SPoint3_mergeMin;this.mergeMin3=MO.SPoint3_mergeMin3;this.mergeMax=MO.SPoint3_mergeMax;this.mergeMax3=MO.SPoint3_mergeMax3;this.resize=MO.SPoint3_resize;this.slerp=MO.SPoint3_slerp;return this};
MO.SPoint3_conjugate=function(b){var d=null,d=b?b:new MO.SPoint3;d.x=-this.x;d.y=-this.y;d.z=-this.z;return d};MO.SPoint3_mergeMin=function(b){this.x=Math.min(this.x,b.x);this.y=Math.min(this.y,b.y);this.z=Math.min(this.z,b.z)};MO.SPoint3_mergeMin3=function(b,d,f){this.x=Math.min(this.x,b);this.y=Math.min(this.y,d);this.z=Math.min(this.z,f)};MO.SPoint3_mergeMax=function(b){this.x=Math.max(this.x,b.x);this.y=Math.max(this.y,b.y);this.z=Math.max(this.z,b.z)};
MO.SPoint3_mergeMax3=function(b,d,f){this.x=Math.max(this.x,b);this.y=Math.max(this.y,d);this.z=Math.max(this.z,f)};MO.SPoint3_resize=function(b,d,f){null!=b&&(this.x+=b);null!=d&&(this.y+=d);null!=f&&(this.z+=f)};MO.SPoint3_slerp=function(b,d,f){this.x=(d.x-b.x)*f+b.x;this.y=(d.y-b.y)*f+b.y;this.z=(d.z-b.z)*f+b.z};MO.SPoint4=function(b,d,f,h){MO.SValue4.call(this,b,d,f,h);this.serialize3=MO.SPoint4_serialize3;this.unserialize3=MO.SPoint4_unserialize3;return this};
MO.SPoint4_serialize3=function(b){b.writeFloat(this.x);b.writeFloat(this.y);b.writeFloat(this.z)};MO.SPoint4_unserialize3=function(b){this.x=b.readFloat();this.y=b.readFloat();this.z=b.readFloat()};
MO.SQuaternion=function(){this.z=this.y=this.x=0;this.w=1;this.identity=MO.SQuaternion_identity;this.assign=MO.SQuaternion_assign;this.set=MO.SQuaternion_set;this.absolute=MO.SQuaternion_absolute;this.normalize=MO.SQuaternion_normalize;this.conjugate=MO.SQuaternion_conjugate;this.mul=MO.SQuaternion_mul;this.mul2=MO.SQuaternion_mul2;this.translate=MO.SQuaternion_translate;this.slerp=MO.SQuaternion_slerp;this.fromAxisAngle=MO.SQuaternion_fromAxisAngle;this.fromEuler=MO.SQuaternion_fromEuler;this.parseEuler=
MO.SQuaternion_parseEuler;this.serialize=MO.SQuaternion_serialize;this.unserialize=MO.SQuaternion_unserialize;this.clone=MO.SQuaternion_clone;this.toString=MO.SQuaternion_toString;return this};MO.SQuaternion_identity=function(){this.x=this.y=this.z=0;this.w=1;return this};MO.SQuaternion_assign=function(b){this.x=b.x;this.y=b.y;this.z=b.z;this.w=b.w};MO.SQuaternion_set=function(b,d,f,h){this.x=b;this.y=d;this.z=f;this.w=h};
MO.SQuaternion_absolute=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)};MO.SQuaternion_normalize=function(){var b=this.absolute();0!=b&&(b=1/b,this.x*=b,this.y*=b,this.z*=b,this.w*=b)};MO.SQuaternion_conjugate=function(b){var d=null,d=b?b:new MO.SQuaternion;d.x=-this.x;d.y=-this.y;d.z=-this.z;d.w=this.w;return d};
MO.SQuaternion_mul=function(b){var d=this.x,f=this.y,h=this.z,q=this.w;this.x=q*b.x+d*b.w+f*b.z-h*b.y;this.y=q*b.y+f*b.w+h*b.x-d*b.z;this.z=q*b.z+h*b.w+d*b.y-f*b.x;this.w=q*b.w-d*b.x-f*b.y-h*b.z};MO.SQuaternion_mul2=function(b,d){this.x=b.w*d.x+b.x*d.w+b.y*d.z-b.z*d.y;this.y=b.w*d.y+b.y*d.w+b.z*d.x-b.x*d.z;this.z=b.w*d.z+b.z*d.w+b.x*d.y-b.y*d.x;this.w=b.w*d.w-b.x*d.x-b.y*d.y-b.z*d.z};
MO.SQuaternion_translate=function(b,d){var f=new MO.SQuaternion;f.set(b.x,b.y,b.z,0);f.normalize();var h=this.conjugate();f.mul(h);h=this.clone();h.mul(f);f=null;f=d?d:new MO.SVector3;f.set(h.x,h.y,h.z);return f};
MO.SQuaternion_slerp=function(b,d,f){var h=b.x*d.x+b.y*d.y+b.z*d.z+b.w*d.w,q=!1;0>h&&(q=!0,h=-h);var w=0,z=0;.999999<h?(w=1-f,z=q?-f:f):(h=Math.acos(h),z=1/Math.sin(h),w=Math.sin((1-f)*h)*z,z=q?-Math.sin(f*h)*z:Math.sin(f*h)*z);this.x=w*b.x+z*d.x;this.y=w*b.y+z*d.y;this.z=w*b.z+z*d.z;this.w=w*b.w+z*d.w};MO.SQuaternion_fromAxisAngle=function(b,d){var f=.5*d,h=Math.sin(f);this.x=b.x*h;this.y=b.y*h;this.z=b.z*h;this.w=Math.cos(f)};
MO.SQuaternion_fromEuler=function(b,d,f){var h=Math.sin(.5*f);f=Math.cos(.5*f);var q=Math.sin(.5*b);b=Math.cos(.5*b);var w=Math.sin(.5*d);d=Math.cos(.5*d);this.x=f*q*d+h*b*w;this.y=f*b*w-h*q*d;this.z=h*b*d-f*q*w;this.w=f*b*d+h*q*w};
MO.SQuaternion_parseEuler=function(b){var d=this.x*this.x,f=this.y*this.y,h=this.z*this.z,q=null,q=b?b:new MO.SVector3;q.x=Math.asin(RFloat.toRange(2*(this.w*this.x-this.y*this.z),-1,1));q.y=Math.atan2(2*(this.w*this.y+this.z*this.x),1-2*(d+f));q.z=Math.atan2(2*(this.w*this.z+this.x*this.y),1-2*(h+d));return q};MO.SQuaternion_serialize=function(b){b.writeFloat(this.x);b.writeFloat(this.y);b.writeFloat(this.z);b.writeFloat(this.w)};
MO.SQuaternion_unserialize=function(b){this.x=b.readFloat();this.y=b.readFloat();this.z=b.readFloat();this.w=b.readFloat()};MO.SQuaternion_clone=function(){var b=new MO.SQuaternion;b.x=this.x;b.y=this.y;b.z=this.z;b.w=this.w;return b};MO.SQuaternion_toString=function(){return this.x+","+this.y+","+this.z+","+this.w};MO.SRange=function(b,d,f,h){this.x=b;this.y=d;this.width=f;this.height=h;this.dump=SRange_dump;return this};MO.SRange_reset=function(){this.bottom=this.right=this.top=this.left=0};
MO.SRange_assign=function(b){this.left=b.left;this.top=b.top;this.right=b.right;this.bottom=b.bottom};MO.SRange_set=function(b,d,f,h){this.left=b;this.top=d;this.right=f;this.bottom=h};MO.SRange_setBounds=function(b,d,f,h){this.left=b;this.top=d;this.right=this.left+f-1;this.bottom=this.top+h-1};MO.SRange_width=function(){return this.right-this.left+1};MO.SRange_setWidth=function(b){b&&(this.right=this.left+b-1)};MO.SRange_height=function(){return this.bottom-this.top+1};
MO.SRange_setHeight=function(b){b&&(this.bottom=this.top+b-1)};MO.SRange_move=function(b,d){this.left+=b;this.top+=d;this.right+=b;this.bottom+=d};MO.SRange_inc=function(b){b=RInt.nvl(b,1);this.left-=b;this.top-=b;this.right+=b;this.bottom+=b};MO.SRange_dec=function(b){b=RInt.nvl(b,1);this.left+=b;this.top+=b;this.right-=b;this.bottom-=b};MO.SRange_dump=function(b){b=RString.nvlStr(b);b.append(RClass.name(this));b.append(" [",this.x,",",this.y,"-",this.width,",",this.height,"] ");return b};
MO.SRectangle=function(b,d,f,h){this.left=MO.Lang.Integer.nvl(b);this.top=MO.Lang.Integer.nvl(d);this.width=MO.Lang.Integer.nvl(f);this.height=MO.Lang.Integer.nvl(h);this.right=MO.SRectangle_right;this.bottom=MO.SRectangle_bottom;this.isEmpty=MO.SRectangle_isEmpty;this.testRange=MO.SRectangle_testRange;this.testRectangle=MO.SRectangle_testRectangle;this.reset=MO.SRectangle_reset;this.assign=MO.SRectangle_assign;this.setLocation=MO.SRectangle_setLocation;this.setSize=MO.SRectangle_setSize;this.setLocationSize=
MO.SRectangle_setLocationSize;this.set=MO.SRectangle_set;this.toString=MO.SRectangle_toString;this.dispose=MO.SRectangle_dispose;return this};MO.SRectangle_right=function(){return this.left+this.width};MO.SRectangle_bottom=function(){return this.top+this.height};MO.SRectangle_isEmpty=function(){return 0<this.width&&0<this.height?!1:!0};MO.SRectangle_testRange=function(b,d){return b<this.left||d<this.top||b-this.left>this.width||d-this.top>this.height?!1:!0};
MO.SRectangle_testRectangle=function(b){return this.left<b.left+b.width&&this.left+this.width>b.left&&this.top<b.top+b.height&&this.top+this.height>b.top};MO.SRectangle_reset=function(){this.height=this.width=this.top=this.left=0};MO.SRectangle_assign=function(b){this.left=b.left;this.top=b.top;this.width=b.width;this.height=b.height};MO.SRectangle_setLocation=function(b,d){this.left=b;this.top=d};MO.SRectangle_setSize=function(b,d){this.width=b;this.height=d};
MO.SRectangle_setLocationSize=function(b,d){this.left=b.x;this.top=b.y;this.width=d.width;this.height=d.height};MO.SRectangle_set=function(b,d,f,h){this.left=b;this.top=d;this.width=f;this.height=h};MO.SRectangle_toString=function(){return this.left+","+this.top+","+this.width+","+this.height};MO.SRectangle_dispose=function(){this.height=this.width=this.top=this.left=null};
MO.SSize2=function(b,d){this.width=MO.Lang.Integer.nvl(b);this.height=MO.Lang.Integer.nvl(d);this.isEmpty=MO.SSize2_isEmpty;this.equalsData=MO.SSize2_equalsData;this.equals=MO.SSize2_equals;this.square=MO.SSize2_square;this.assign=MO.SSize2_assign;this.set=MO.SSize2_set;this.serialize=MO.SSize2_serialize;this.unserialize=MO.SSize2_unserialize;this.parse=MO.SSize2_parse;this.toDisplay=MO.SSize2_toDisplay;this.toString=MO.SSize2_toString;this.dispose=MO.SSize2_dispose;this.dump=MO.SSize2_dump;return this};
MO.SSize2_isEmpty=function(){return 0==this.width&&0==this.height};MO.SSize2_equalsData=function(b,d){return this.width!=b||this.height!=d?!1:!0};MO.SSize2_equals=function(b){return this.width!=b.width||this.height!=b.height?!1:!0};MO.SSize2_square=function(){return this.width*this.height};MO.SSize2_assign=function(b){this.width=b.width;this.height=b.height};MO.SSize2_set=function(b,d){this.width=b;this.height=d};MO.SSize2_serialize=function(b){b.writeFloat(this.width);b.writeFloat(this.height)};
MO.SSize2_unserialize=function(b,d){d||(d=MO.EDataType.Float16);this.width=b.readData(d);this.height=b.readData(d)};MO.SSize2_parse=function(b){var d=b.split(",");if(2==d.length)this.width=parseInt(d[0]),this.height=parseInt(d[1]);else throw new TError(this,"Parse value failure. (value={1})",b);};MO.SSize2_toDisplay=function(){return this.width+"x"+this.height};MO.SSize2_toString=function(){return this.width+","+this.height};MO.SSize2_dispose=function(){this.height=this.width=null};
MO.SSize2_dump=function(){return MO.Class.dump(this)+" ["+this.width+","+this.height+"]"};MO.SSize3=function(b,d,f){this.width=MO.Lang.Integer.nvl(b);this.height=MO.Lang.Integer.nvl(d);this.deep=MO.Lang.Integer.nvl(f);this.assign=MO.SSize3_assign;this.set=MO.SSize3_set;this.parse=MO.SSize3_parse;this.toString=MO.SSize3_toString;this.dump=MO.SSize3_dump;return this};MO.SSize3_assign=function(b){this.width=b.width;this.height=b.height;this.deep=b.deep};
MO.SSize3_set=function(b,d,f){this.width=b;this.height=d;this.deep=f};MO.SSize3_parse=function(b){var d=b.split(",");if(3==d.length)this.width=parseInt(d[0]),this.height=parseInt(d[1]),this.deep=parseInt(d[2]);else throw new MO.TError(this,"Parse value failure. (value={1})",b);};MO.SSize3_toString=function(){return this.width+","+this.height+","+this.deep};MO.SSize3_dump=function(){return MO.Lang.Class.dump(this)+" ["+this.width+","+this.height+","+this.deep+"]"};
MO.SSquare=function(b,d,f,h){this.left=MO.Lang.Integer.nvl(left);this.top=MO.Lang.Integer.nvl(top);this.right=MO.Lang.Integer.nvl(right);this.bottom=MO.Lang.Integer.nvl(bottom);this.reset=MO.SSquare_reset;this.assign=MO.SSquare_assign;this.set=MO.SSquare_set;this.setBounds=MO.SSquare_setBounds;this.width=MO.SSquare_width;this.setWidth=MO.SSquare_setWidth;this.height=MO.SSquare_height;this.setHeight=MO.SSquare_setHeight;this.move=MO.SSquare_move;this.inc=MO.SSquare_inc;this.dec=MO.SSquare_dec;this.dump=
this.unpack=this.pack=MO.SSquare_dump;return this};MO.SSquare_reset=function(){this.bottom=this.right=this.top=this.left=0};MO.SSquare_assign=function(b){this.left=b.left;this.top=b.top;this.right=b.right;this.bottom=b.bottom};MO.SSquare_set=function(b,d,f,h){this.left=b;this.top=d;this.right=f;this.bottom=h};MO.SSquare_setBounds=function(b,d,f,h){this.left=b;this.top=d;this.right=this.left+f-1;this.bottom=this.top+h-1};MO.SSquare_width=function(){return this.right-this.left+1};
MO.SSquare_setWidth=function(b){b&&(this.right=this.left+b-1)};MO.SSquare_height=function(){return this.bottom-this.top+1};MO.SSquare_setHeight=function(b){b&&(this.bottom=this.top+b-1)};MO.SSquare_move=function(b,d){this.left+=b;this.top+=d;this.right+=b;this.bottom+=d};MO.SSquare_inc=function(b){b=RInt.nvl(b,1);this.left-=b;this.top-=b;this.right+=b;this.bottom+=b};MO.SSquare_dec=function(b){b=RInt.nvl(b,1);this.left+=b;this.top+=b;this.right-=b;this.bottom-=b};
MO.SSquare_dump=function(b){b=MO.Lang.String.nvlStr(b);b.append(MO.Class.name(this));b.append(" [",this.left,",",this.top,"-",this.right,",",this.bottom,"] ");b.append("(",this.width(),"-",this.height(),")");return b};
MO.SValue3=function(b,d,f){this.x=MO.Runtime.nvl(b,0);this.y=MO.Runtime.nvl(d,0);this.z=MO.Runtime.nvl(f,0);this.isEmpty=MO.SValue3_isEmpty;this.equals=MO.SValue3_equals;this.equalsData=MO.SValue3_equalsData;this.assign=MO.SValue3_assign;this.setMin=MO.SValue3_setMin;this.setMax=MO.SValue3_setMax;this.set=MO.SValue3_set;this.setAll=MO.SValue3_setAll;this.absolute=this.length=MO.SValue3_absolute;this.normalize=MO.SValue3_normalize;this.negative=MO.SValue3_negative;this.serialize=MO.SValue3_serialize;
this.unserialize=MO.SValue3_unserialize3;this.unserialize2=MO.SValue3_unserialize2;this.unserialize3=MO.SValue3_unserialize3;this.parse=MO.SValue3_parse;this.toString=MO.SValue3_toString;return this};MO.SValue3_isEmpty=function(b){return 0==this.x&&0==this.y&&0==this.z};MO.SValue3_equals=function(b){return this.x==b.x&&this.y==b.y&&this.z==b.z};MO.SValue3_equalsData=function(b,d,f){return this.x==b&&this.y==d&&this.z==f};MO.SValue3_assign=function(b){this.x=b.x;this.y=b.y;this.z=b.z};
MO.SValue3_setMin=function(){this.z=this.y=this.x=Number.MIN_VALUE};MO.SValue3_setMax=function(){this.z=this.y=this.x=Number.MAX_VALUE};MO.SValue3_set=function(b,d,f){this.x=b;this.y=d;this.z=f};MO.SValue3_setAll=function(b){this.z=this.y=this.x=b};MO.SValue3_normalize=function(){var b=this.absolute();0!=b&&(b=1/b,this.x*=b,this.y*=b,this.z*=b);return this};MO.SValue3_absolute=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)};
MO.SValue3_negative=function(b){var d=null,d=p?b:new this.constructor;d.x=-this.x;d.y=-this.y;d.z=-this.z;return d};MO.SValue3_serialize=function(b){b.writeFloat(this.x);b.writeFloat(this.y);b.writeFloat(this.z)};MO.SValue3_unserialize2=function(b){this.x=b.readFloat();this.y=b.readFloat()};MO.SValue3_unserialize3=function(b){this.x=b.readFloat();this.y=b.readFloat();this.z=b.readFloat()};
MO.SValue3_parse=function(b){var d=b.split(",");if(3==d.length)this.x=parseFloat(d[0]),this.y=parseFloat(d[1]),this.z=parseFloat(d[2]);else throw new MO.TError(o,"Parse value failure. (value={1})",b);};MO.SValue3_toString=function(){return this.x+","+this.y+","+this.z};
MO.SValue4=function(b,d,f,h){this.x=MO.Runtime.nvl(b,0);this.y=MO.Runtime.nvl(d,0);this.z=MO.Runtime.nvl(f,0);this.w=MO.Runtime.nvl(h,1);this.assign=MO.SValue4_assign;this.set=MO.SValue4_set;this.absolute=MO.SValue4_absolute;this.normalize=MO.SValue4_normalize;this.negative=MO.SValue4_negative;this.serialize=MO.SValue4_serialize;this.unserialize=MO.SValue4_unserialize;this.parse=MO.SValue4_parse;this.toString=MO.SValue4_toString;return this};
MO.SValue4_assign=function(b){this.x=b.x;this.y=b.y;this.z=b.z;this.w=b.w};MO.SValue4_set=function(b,d,f,h){this.x=b;this.y=d;this.z=f;this.w=h};MO.SValue4_absolute=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)};MO.SValue4_normalize=function(){var b=this.absolute();0!=b&&(b=1/b,this.x*=b,this.y*=b,this.z*=b,this.w*=b)};MO.SValue4_negative=function(b){var d=null,d=b?b:new this.constructor;d.x=-this.x;d.y=-this.y;d.z=-this.z;d.w=-this.w;return d};
MO.SValue4_serialize=function(b){b.writeFloat(this.x);b.writeFloat(this.y);b.writeFloat(this.z);b.writeFloat(this.w)};MO.SValue4_unserialize=function(b){this.x=b.readFloat();this.y=b.readFloat();this.z=b.readFloat();this.w=b.readFloat()};MO.SValue4_parse=function(b){var d=b.split(",");if(4==d.length)this.x=parseFloat(d[0]),this.y=parseFloat(d[1]),this.z=parseFloat(d[2]),this.w=parseFloat(d[3]);else throw new MO.TError(o,"Parse value failure. (value={1})",b);};
MO.SValue4_toString=function(){return this.x+","+this.y+","+this.z+","+this.w};MO.SVector3=function(b,d,f){MO.SValue3.call(this,b,d,f);this.length=this.absolute;this.direction=MO.SVector3_direction;this.conjugate=MO.SVector3_conjugate;this.dotPoint3=MO.SVector3_dotPoint3;this.cross=MO.SVector3_cross;this.cross2=MO.SVector3_cross2;this.slerp=MO.SVector3_slerp;this.clone=MO.SVector3_clone;return this};MO.SVector3_direction=function(b,d){this.x=d.x-b.x;this.y=d.y-b.y;this.z=d.z-b.z;return this};
MO.SVector3_conjugate=function(b){var d=null,d=b?b:new MO.SVector3;d.x=-this.x;d.y=-this.y;d.z=-this.z;return d};MO.SVector3_dotPoint3=function(b){return this.x*b.x+this.y*b.y+this.z*b.z};MO.SVector3_cross=function(b){var d=this.z*b.x-this.x*b.z,f=this.x*b.y-this.y*b.x;this.x=this.y*b.z-this.z*b.y;this.y=d;this.z=f};MO.SVector3_cross2=function(b,d){b.x=this.y*d.z-this.z*d.y;b.y=this.z*d.x-this.x*d.z;b.z=this.x*d.y-this.y*d.x};
MO.SVector3_slerp=function(b,d,f){this.x=(d.x-b.x)*f+b.x;this.y=(d.y-b.y)*f+b.y;this.z=(d.z-b.z)*f+b.z};MO.SVector3_clone=function(){var b=new MO.SVector3;b.x=this.x;b.y=this.y;b.z=this.z;return b};MO.SVector4=function(b,d,f,h){MO.SValue4.call(this,b,d,f,h);this.serialize3=MO.SVector4_serialize3;this.unserialize3=MO.SVector4_unserialize3;return this};MO.SVector4_serialize3=function(b){b.writeFloat(this.x);b.writeFloat(this.y);b.writeFloat(this.z)};
MO.SVector4_unserialize3=function(b){this.x=b.readFloat();this.y=b.readFloat();this.z=b.readFloat()};MO.RMath=function(){this.value1=Array(1);this.value2=Array(2);this.value3=Array(3);this.value4=Array(4);this.value9=Array(9);this.value12=Array(12);this.value16=Array(16);this.matrix=this.rectangle=this.vector3=this.vectorBackward=this.vectorForward=this.vectorScale=this.vectorAxisZ=this.vectorAxisY=this.vectorAxisX=null;this.faceCenterPositions=[-1,1,0,1,1,0,1,-1,0,-1,-1,0];return this};
MO.RMath.prototype.construct=function(){this.vectorAxisX=new MO.SVector3(1,0,0);this.vectorAxisY=new MO.SVector3(0,1,0);this.vectorAxisZ=new MO.SVector3(0,0,1);this.vectorScale=new MO.SVector3(1,1,1);this.vectorForward=new MO.SVector3(0,0,1);this.vectorBackward=new MO.SVector3(0,0,-1);this.vector3=new MO.SVector3;this.rectangle=new MO.SRectangle;this.matrix=new MO.SMatrix3d};
MO.RMath.prototype.min=function(){var b=0,d=arguments.length;if(1<d)for(var b=Number.MAX_VALUE,f=0;f<d;f++){var h=arguments[f];h<b&&(b=h)}return b};MO.RMath.prototype.max=function(){var b=0,d=arguments.length;if(1<d)for(var b=Number.MIN_VALUE,f=0;f<d;f++){var h=arguments[f];h>b&&(b=h)}return b};MO.RMath.prototype.sign=function(b){return 0<b?1:0>b?-1:0};MO.RMath=new MO.RMath;MO.RMath.construct();MO.Lang.Math=MO.RMath;
MO.RMatrix=function(){this.identity3x3=[1,0,0,0,1,0,0,0,1];this.identity4x4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return this};MO.RMatrix.prototype.perspectiveLH=function(b,d,f,h,q){b=b.data();b[0]=2*h/d;b[1]=0;b[2]=0;b[3]=0;b[4]=0;b[5]=2*h/f;b[6]=0;b[7]=0;b[8]=0;b[9]=0;b[10]=q/(q-h);b[11]=1;b[12]=0;b[13]=0;b[14]=h*q/(h-q);b[15]=0};
MO.RMatrix.prototype.perspectiveRH=function(b,d,f,h,q){b=b.data();b[0]=2*h/d;b[1]=0;b[2]=0;b[3]=0;b[4]=0;b[5]=2*h/f;b[6]=0;b[7]=0;b[8]=0;b[9]=0;b[10]=q/(h-q);b[11]=1;b[12]=0;b[13]=0;b[14]=h*q/(h-q);b[15]=0};MO.RMatrix.prototype.perspectiveFieldOfViewLH=function(b,d,f,h,q){b=b.data();d=1/Math.tan(.5*d);b[0]=d/f;b[1]=0;b[2]=0;b[3]=0;b[4]=0;b[5]=d;b[6]=0;b[7]=0;b[8]=0;b[9]=0;b[10]=q/(q-h);b[11]=1;b[12]=0;b[13]=0;b[14]=h*q/(h-q);b[15]=0};
MO.RMatrix.prototype.perspectiveFieldOfViewRH=function(b,d,f,h,q){b=b.data();d=1/Math.tan(.5*d);b[0]=d/f;b[1]=0;b[2]=0;b[3]=0;b[4]=0;b[5]=d;b[6]=0;b[7]=0;b[8]=0;b[9]=0;b[10]=q/(h-q);b[11]=1;b[12]=0;b[13]=0;b[14]=h*q/(q-h);b[15]=0};MO.RMatrix.prototype.orthoLH=function(b,d,f,h,q,w,z){z-=w;d=(d+(d+h))/h;f=(f+(f+q))/q;w/=z;b=MO.Lang.Array.copy(this.identity4x4,0,16,b.data(),0);b[0]=2/h;b[5]=2/q;b[10]=1/z;b[12]=-d;b[13]=-f;b[14]=-w};
MO.RMatrix.prototype.orthoRH=function(b,d,f,h,q,w,z){var A=z-w;d=(d+(d+h))/h;f=(f+(f+q))/q;w=(w+z)/A;b=MO.Lang.Array.copy(this.identity4x4,0,16,b.data(),0);b[0]=2/h;b[5]=2/q;b[10]=-2/A;b[12]=-d;b[13]=-f;b[14]=-w};MO.Lang.Matrix=new MO.RMatrix;MO.RRandom=function(){this._seed=(new Date).getTime();return this};MO.RRandom.prototype.get=function(){this._seed=(9301*this._seed+49297)%233280;return this._seed/233280};MO.RRandom.prototype.rand=function(b){b*=this.get();return Math.ceil(b)};MO.RRandom=new MO.RRandom;
MO.Lang.Random=MO.RRandom;MO.AListener=function(b,d){MO.ASource.call(this,b,MO.ESource.Listener,d);this.build=MO.AListener_build;return this};
MO.AListener_build=function(b,d){var f="add"+this._linker+"Listener";d[f]=MO.RListener.makeAddListener(f,this._linker);f="set"+this._linker+"Listener";d[f]=MO.RListener.makeSetListener(f,this._linker);f="remove"+this._linker+"Listener";d[f]=MO.RListener.makeRemoveListener(f,this._linker);f="clear"+this._linker+"Listeners";d[f]=MO.RListener.makeClearListener(f,this._linker);f="process"+this._linker+"Listener";d[f]=MO.RListener.makeProcessListener(f,this._linker)};
MO.AStyle=function(b,d){MO.AAnnotation.call(this,b);this._annotationCd=MO.EAnnotation.Style;this._duplicate=!0;this._style=d;this.code=MO.AStyle_code;this.style=MO.AStyle_style;this.build=MO.AStyle_build;this.toString=MO.AStyle_toString;if(null==d){var f=null;MO.Lang.String.startsWith(b,"_style")?f=b.substring(6):MO.Lang.String.startsWith(b,"style")&&(f=b.substring(5));if(null==f)throw new MO.TError("Style name is empty.");this._style=f}return this};MO.AStyle_code=function(){return this._style};
MO.AStyle_style=function(){return this._style};MO.AStyle_build=function(b){b[this._name]=null};MO.AStyle_toString=function(){return"style="+this._style};
MO.AStyleIcon=function(b,d){MO.AAnnotation.call(this,b);this._annotationCd=MO.EAnnotation.Style;this._style=d;this.code=MO.AStyleIcon_code;this.style=MO.AStyleIcon_style;this.build=MO.AStyleIcon_build;this.toString=MO.AStyleIcon_toString;if(null==d){var f=null;MO.Lang.String.startsWith(b,"_style")?f=b.substring(6):MO.Lang.String.startsWith(b,"style")&&(f=b.substring(5));if(null==f)throw new MO.TError("Style name is empty.");this._style=f}return this};MO.AStyleIcon_code=function(){return this._style};
MO.AStyleIcon_style=function(){return this._style};MO.AStyleIcon_build=function(b){b[this._name]=null};MO.AStyleIcon_toString=function(){return"style="+this._style};
MO.EEvent=new function(){this.Unknown="Unknown";this.Load="Load";this.Process="Process";this.Complete="Complete";this.EnterFrame="EnterFrame";this.LeaveFrame="LeaveFrame";this.Enter="Enter";this.Leave="Leave";this.Resize="Reisze";this.Focus="Focus";this.Blur="Blur";this.MouseDown="MouseDown";this.MouseMove="MouseMove";this.MouseUp="MouseUp";this.MouseWheel="MouseWheel";this.KeyDown="KeyDown";this.KeyPress="KeyPress";this.KeyUp="KeyUp";this.Click="Click";this.DoubleClick="DoubleClick";this.NodeClick=
"NodeClick";this.ItemClick="ItemClick";this.Selected="Selected";this.DataChanged="DataChanged";this.Result="Result";this.TouchZoom="TouchZoom";this.Visibility="Visibility";this.Orientation="Orientation";return this};MO.EEventInvoke=new function(){this.Unknown=0;this.Before=1;this.After=2;return this};MO.EEventStatus=new function(){this.Unknown=0;this.Continue=1;this.Stop=2;this.Cancel=3;this.Failure=4;return this};MO.EHttpContent=new function(){this.Binary=1;this.Text=2;return this};
MO.EHttpMethod=new function(){this.Get="GET";this.Post="POST";return this};MO.EHttpStatus=new function(){this.Uninitialized=0;this.Open=1;this.Send=2;this.Receiving=3;this.Loaded=4;return this};
MO.EKeyCode=new function(){this.None=0;this.Esc=27;this.Tab=9;this.Enter=13;this.Shift=16;this.Alt=18;this.Ctrl=17;this.BackSpace=8;this.Space=32;this.Left=37;this.Up=38;this.Right=39;this.Down=40;this.Insert=45;this.Delete=46;this.Home=36;this.End=35;this.PageUp=33;this.PageDown=34;this.F1=112;this.F2=113;this.F3=114;this.F4=115;this.F5=116;this.F6=117;this.F7=118;this.F8=119;this.F9=120;this.F10=121;this.F11=122;this.F12=123;this.N0=48;this.N1=49;this.N2=50;this.N3=51;this.N4=52;this.N5=53;this.N6=
54;this.N7=55;this.N8=56;this.N9=57;this.A=65;this.B=66;this.C=67;this.D=68;this.E=69;this.F=70;this.G=71;this.H=72;this.I=73;this.J=74;this.K=75;this.L=76;this.M=77;this.N=78;this.O=79;this.P=80;this.Q=81;this.R=82;this.S=83;this.T=84;this.U=85;this.V=86;this.W=87;this.X=88;this.Y=89;this.Z=90;this.ControlKeys=[this.Tab,this.Enter,this.BackSpace,this.Left,this.Up,this.Right,this.Down,this.Insert,this.Delete,this.Home,this.End,this.PageUp,this.PageDown,this.F1,this.F2,this.F3,this.F4,this.F5,this.F6,
this.F7,this.F8,this.F9,this.F10,this.F11,this.F12];var b=this.integerCodes={};b[45]=!0;b[190]=!0;for(var d=this.N0;d<=this.N9;d++)b[d]=!0;b=this.floatCodes={};b[45]=!0;b[190]=!0;b[46]=!0;b[189]=!0;for(d=this.N0;d<=this.N9;d++)b[d]=!0;return this};MO.EKeyStatus=new function(){this.Normal=0;this.Press=1;return this};MO.EMouseButton=new function(){this.Left=0;this.Right=2;this.Middle=3;return this};MO.EMouseCursor=new function(){this.HSize="E-resize";this.VSize="N-resize";return this};
MO.EOrientation=new function(){this.Unknown=0;this.Horizontal="H";this.Vertical="V";return this};MO.MClone=function(b){b=MO.Class.inherits(this,b);b.clone=MO.MClone_clone;return b};MO.MClone_clone=function(){var b=MO.Class.create(this.constructor),d;for(d in this){var f=this[d];null!=f&&(MO.Class.isBaseDataType(f.constructor)||(b[d]=f.clone()));b[d]=f}return b};
MO.MDataStream=function(b){b=MO.Class.inherits(this,b);b._viewer=null;b._endianCd=!1;b._position=0;b.testString=MO.MDataStream_testString;b.readBoolean=MO.MDataStream_readBoolean;b.readInt8=MO.MDataStream_readInt8;b.readInt16=MO.MDataStream_readInt16;b.readInt32=MO.MDataStream_readInt32;b.readInt64=MO.MDataStream_readInt64;b.readUint8=MO.MDataStream_readUint8;b.readUint16=MO.MDataStream_readUint16;b.readUint32=MO.MDataStream_readUint32;b.readUint64=MO.MDataStream_readUint64;b.readFloat=MO.MDataStream_readFloat;
b.readDouble=MO.MDataStream_readDouble;b.readString=MO.MDataStream_readString;b.readData=MO.MDataStream_readData;b.readBytes=MO.MDataStream_readBytes;b.writeBoolean=MO.MDataStream_writeBoolean;b.writeInt8=MO.MDataStream_writeInt8;b.writeInt16=MO.MDataStream_writeInt16;b.writeInt32=MO.MDataStream_writeInt32;b.writeInt64=MO.MDataStream_writeInt64;b.writeUint8=MO.MDataStream_writeUint8;b.writeUint16=MO.MDataStream_writeUint16;b.writeUint32=MO.MDataStream_writeUint32;b.writeUint64=MO.MDataStream_writeUint64;
b.writeFloat=MO.MDataStream_writeFloat;b.writeDouble=MO.MDataStream_writeDouble;b.writeString=MO.MDataStream_writeString;b.writeBytes=MO.MDataStream_writeBytes;return b};MO.MDataStream_testString=function(){for(var b=this._position,d=this._viewer.getUint16(b,this._endianCd),b=b+2,f=new MO.TString,h=0;h<d;h++){var q=this._viewer.getUint16(b,this._endianCd),b=b+2;f.push(String.fromCharCode(q))}return f.flush()};
MO.MDataStream_readBoolean=function(){var b=this._viewer.getInt8(this._position,this._endianCd);this._position++;return 0<b};MO.MDataStream_readInt8=function(){var b=this._viewer.getInt8(this._position,this._endianCd);this._position++;return b};MO.MDataStream_readInt16=function(){var b=this._viewer.getInt16(this._position,this._endianCd);this._position+=2;return b};MO.MDataStream_readInt32=function(){var b=this._viewer.getInt32(this._position,this._endianCd);this._position+=4;return b};
MO.MDataStream_readInt64=function(){var b=this._viewer.getInt64(this._position,this._endianCd);this._position+=8;return b};MO.MDataStream_readUint8=function(){var b=this._viewer.getUint8(this._position,this._endianCd);this._position+=1;return b};MO.MDataStream_readUint16=function(){var b=this._viewer.getUint16(this._position,this._endianCd);this._position+=2;return b};MO.MDataStream_readUint32=function(){var b=this._viewer.getUint32(this._position,this._endianCd);this._position+=4;return b};
MO.MDataStream_readUint64=function(){var b=this._viewer.getUint64(this._position,this._endianCd);this._position+=8;return b};MO.MDataStream_readFloat=function(){var b=this._viewer.getFloat32(this._position,this._endianCd);this._position+=4;return b};MO.MDataStream_readDouble=function(){var b=this._viewer.getFloat64(this._position,this._endianCd);this._position+=8;return b};
MO.MDataStream_readString=function(){for(var b=this._viewer,d=this._endianCd,f=this._position,h=b.getUint16(f,d),f=f+2,q=new MO.TString,w=0;w<h;w++){var z=b.getUint16(f,d);q.push(String.fromCharCode(z));f+=2}this._position=f;return q.flush()};
MO.MDataStream_readData=function(b){switch(b){case EDataType.Int8:return this.readInt8();case EDataType.Int16:return this.readInt16();case EDataType.Int32:return this.readInt32();case EDataType.Int64:return this.readInt64();case EDataType.Uint8:return this.readUint8();case EDataType.Uint16:return this.readUint16();case EDataType.Uint32:return this.readUint32();case EDataType.Uint64:return this.readUint64();case EDataType.Float32:return this.readFloat();case EDataType.Float64:return this.readDouble();
case EDataType.String:return this.readString()}throw new TError(this,"Unknown data cd. (data_cd={1})",b);};
MO.MDataStream_readBytes=function(b,d,f){var h=this._viewer;if(!(0>=f)){if(0!=d)throw new MO.TError(this,"Unsupport.");d=this._position;var q=this._endianCd;if(0==f%8){b=new Float64Array(b);f>>=3;for(var w=0;w<f;w++)b[w]=h.getFloat64(d,q),d+=8}else if(0==f%4)for(b=new Uint32Array(b),f>>=2,w=0;w<f;w++)b[w]=h.getUint32(d,q),d+=4;else if(0==f%2)for(b=new Uint16Array(b),f>>=1,w=0;w<f;w++)b[w]=h.getUint16(d,q),d+=2;else for(b=new Uint8Array(b),w=0;w<f;w++)b[w]=h.getUint8(d++,q);this._position=d}};
MO.MDataStream_writeBoolean=function(b){this._viewer.setInt8(this._position,0<b?1:0,this._endianCd);this._position++};MO.MDataStream_writeInt8=function(b){this._viewer.setInt8(this._position,b,this._endianCd);this._position++};MO.MDataStream_writeInt16=function(b){this._viewer.setInt16(this._position,b,this._endianCd);this._position+=2};MO.MDataStream_writeInt32=function(b){this._viewer.setInt32(this._position,b,this._endianCd);this._position+=4};
MO.MDataStream_writeInt64=function(b){this._viewer.setInt64(this._position,b,this._endianCd);this._position+=8};MO.MDataStream_writeUint8=function(b){this._viewer.setUint8(this._position,b,this._endianCd);this._position+=1};MO.MDataStream_writeUint16=function(b){this._viewer.setUint16(this._position,b,this._endianCd);this._position+=2};MO.MDataStream_writeUint32=function(b){this._viewer.setUint32(this._position,b,this._endianCd);this._position+=4};
MO.MDataStream_writeUint64=function(b){this._viewer.setUint64(this._position,b,this._endianCd);this._position+=8};MO.MDataStream_writeFloat=function(b){this._viewer.setFloat32(this._position,b,this._endianCd);this._position+=4};MO.MDataStream_writeDouble=function(b){this._viewer.setDouble(this._position,b,this._endianCd);this._position+=8};
MO.MDataStream_writeString=function(b){var d=this._viewer,f=v.length,h=this._endianCd,q=this._position;d.setUint16(q,f,h);for(var q=q+2,w=0;w<f;w++)d.setUint16(q,b.charCodeAt(w),h),q+=2;this._position=q};
MO.MDataStream_writeBytes=function(b,d,f){var h=this._viewer;if(!(0>=f)){if(0!=d)throw new MO.TError("Unsupport.");d=this._position;var q=this._endianCd;if(0==f%8){b=new Float64Array(b);f>>=3;for(var w=0;w<f;w++)h.setFloat64(d,b[w],q),d+=8}else if(0==f%4)for(b=new Uint32Array(b),f>>=2,w=0;w<f;w++)h.setUint32(d,b[w],q),d+=4;else if(0==f%2)for(b=new Uint16Array(b),f>>=1,w=0;w<f;w++)h.setUint16(d,b[w],q),d+=2;else for(b=new Uint8Array(b),w=0;w<f;w++)h.setUint8(d++,b[w],q);this._position=d}};
MO.MDataView=function(b){b=MO.Class.inherits(this,b);b._viewer=null;b._endianCd=0;b.endianCd=MO.MDataView_endianCd;b.setEndianCd=MO.MDataView_setEndianCd;b.getInt8=MO.MDataView_getInt8;b.getInt16=MO.MDataView_getInt16;b.getInt32=MO.MDataView_getInt32;b.getInt64=MO.MDataView_getInt64;b.getUint8=MO.MDataView_getUint8;b.getUint16=MO.MDataView_getUint16;b.getUint32=MO.MDataView_getUint32;b.getUint64=MO.MDataView_getUint64;b.getFloat=MO.MDataView_getFloat;b.getDouble=MO.MDataView_getDouble;b.setInt8=MO.MDataView_setInt8;
b.setInt16=MO.MDataView_setInt16;b.setInt32=MO.MDataView_setInt32;b.setInt64=MO.MDataView_setInt64;b.setUint8=MO.MDataView_setUint8;b.setUint16=MO.MDataView_setUint16;b.setUint32=MO.MDataView_setUint32;b.setUint64=MO.MDataView_setUint64;b.setFloat=MO.MDataView_setFloat;b.setDouble=MO.MDataView_setDouble;return b};MO.MDataView_endianCd=function(b){return this._endianCd};MO.MDataView_setEndianCd=function(b){this._endianCd=b};MO.MDataView_getInt8=function(b){return this._viewer.getInt8(b,this._endianCd)};
MO.MDataView_getInt16=function(b){return this._viewer.getInt16(b,this._endianCd)};MO.MDataView_getInt32=function(b){return this._viewer.getInt32(b,this._endianCd)};MO.MDataView_getInt64=function(b){return this._viewer.getInt64(b,this._endianCd)};MO.MDataView_getUint8=function(b){return this._viewer.getUint8(b,this._endianCd)};MO.MDataView_getUint16=function(b){return this._viewer.getUint16(b,this._endianCd)};MO.MDataView_getUint32=function(b){return this._viewer.getUint32(b,this._endianCd)};
MO.MDataView_getUint64=function(b){return this._viewer.getUint64(b,this._endianCd)};MO.MDataView_getFloat=function(b){return this._viewer.getFloat32(b,this._endianCd)};MO.MDataView_getDouble=function(b){return this._viewer.getFloat64(b,this._endianCd)};MO.MDataView_setInt8=function(b,d){this._viewer.setInt8(b,d,this._endianCd)};MO.MDataView_setInt16=function(b,d){this._viewer.setInt16(b,d,this._endianCd)};MO.MDataView_setInt32=function(b,d){this._viewer.setInt32(b,d,this._endianCd)};
MO.MDataView_setInt64=function(b,d){this._viewer.setInt64(b,d,this._endianCd)};MO.MDataView_setUint8=function(b,d){this._viewer.setUint8(b,d,this._endianCd)};MO.MDataView_setUint16=function(b,d){this._viewer.setUint16(b,d,this._endianCd)};MO.MDataView_setUint32=function(b,d){this._viewer.setUint32(b,d,this._endianCd)};MO.MDataView_setUint64=function(b,d){this._viewer.setUint64(b,d,this._endianCd)};MO.MDataView_setFloat=function(b,d){this._viewer.setFloat32(b,d,this._endianCd)};
MO.MDataView_setDouble=function(b,d){this._viewer.setDouble(b,d,this._endianCd)};MO.MListener=function(b){b=MO.Class.inherits(this,b);b._listenerss=null;b.addListener=MO.MListener_addListener;b.setListener=MO.MListener_setListener;b.removeListener=MO.MListener_removeListener;b.clearListeners=MO.MListener_clearListeners;b.clearAllListeners=MO.MListener_clearAllListeners;b.processListener=MO.MListener_processListener;b.dispose=MO.MListener_dispose;return b};
MO.MListener_addListener=function(b,d,f){var h=this._listenerss;h||(h=this._listenerss=new MO.TDictionary);var q=h.get(b);q||(q=new MO.TListeners,h.set(b,q));return q.register(d,f)};MO.MListener_setListener=function(b,d,f){var h=this._listenerss;h&&(h=h.get(b))&&h.clear();return this.addListener(b,d,f)};MO.MListener_removeListener=function(b,d,f){return this._listenerss.get(b).unregister(d,f)};MO.MListener_clearListeners=function(b){var d=this._listenerss;d&&(b=d.get(b))&&b.clear()};
MO.MListener_clearAllListeners=function(){var b=this._listenerss;if(b)for(var d=b.count(),f=0;f<d;f++){var h=b.at(f);h&&h.clear()}};MO.MListener_processListener=function(b,d,f,h,q,w){var z=this._listenerss;z&&(b=z.get(b))&&b.process(d,f,h,q,w)};MO.MListener_dispose=function(){var b=this._listenerss;if(b){for(var d=b.count()-1;0<=d;d--)b.at(d).dispose();this._listenerss=MO.Lang.Object.dispose(b)}};
MO.MListenerLoad=function(b){b=MO.Class.inherits(this,b,MO.MListener);b.addLoadListener=MO.MListenerLoad_addLoadListener;b.removeLoadListener=MO.MListenerLoad_removeLoadListener;b.clearLoadListeners=MO.MListenerLoad_clearLoadListeners;b.processLoadListener=MO.MListenerLoad_processLoadListener;return b};MO.MListenerLoad_addLoadListener=function(b,d){return this.addListener(MO.EEvent.Load,b,d)};MO.MListenerLoad_removeLoadListener=function(b,d){this.removeListener(MO.EEvent.Load,b,d)};
MO.MListenerLoad_clearLoadListeners=function(){this.clearListeners(MO.EEvent.Load)};MO.MListenerLoad_processLoadListener=function(b,d,f,h,q){this.processListener(MO.EEvent.Load,b,d,f,h,q)};
MO.MListenerProcess=function(b){b=MO.Class.inherits(this,b,MO.MListener);b.addProcessListener=MO.MListenerProcess_addProcessListener;b.removeProcessListener=MO.MListenerProcess_removeProcessListener;b.clearProcessListeners=MO.MListenerProcess_clearProcessListeners;b.processProcessListener=MO.MListenerProcess_processProcessListener;return b};MO.MListenerProcess_addProcessListener=function(b,d){return this.addListener(MO.EEvent.Process,b,d)};
MO.MListenerProcess_removeProcessListener=function(b,d){this.removeListener(MO.EEvent.Process,b,d)};MO.MListenerProcess_clearProcessListeners=function(){this.clearListeners(MO.EEvent.Process)};MO.MListenerProcess_processProcessListener=function(b,d,f,h,q){this.processListener(MO.EEvent.Process,b,d,f,h,q)};
MO.MListenerTouchZoom=function(b){b=MO.Class.inherits(this,b,MO.MListener);b.addTouchZoomListener=MO.MListenerTouchZoom_addTouchZoomListener;b.removeTouchZoomListener=MO.MListenerTouchZoom_removeTouchZoomListener;b.clearTouchZoomListeners=MO.MListenerTouchZoom_clearTouchZoomListeners;b.processTouchZoomListener=MO.MListenerTouchZoom_processTouchZoomListener;return b};MO.MListenerTouchZoom_addTouchZoomListener=function(b,d){return this.addListener(MO.EEvent.TouchZoom,b,d)};
MO.MListenerTouchZoom_removeTouchZoomListener=function(b,d){this.removeListener(MO.EEvent.TouchZoom,b,d)};MO.MListenerTouchZoom_clearTouchZoomListeners=function(){this.clearListeners(MO.EEvent.TouchZoom)};MO.MListenerTouchZoom_processTouchZoomListener=function(b,d,f,h,q){this.processListener(MO.EEvent.TouchZoom,b,d,f,h,q)};
MO.MMouseCapture=function(b){b=MO.Class.inherits(this,b);b.onMouseCaptureStart=MO.Method.virtual(b,"onMouseCaptureStart");b.onMouseCapture=MO.Method.virtual(b,"onMouseCapture");b.onMouseCaptureStop=MO.Method.virtual(b,"onMouseCaptureStop");b.testMouseCapture=MO.Method.emptyTrue;return b};MO.MMouseWheel=function(b){b=MO.Class.inherits(this,b);b.onMouseWheel=MO.Class.register(b,new MO.AEventMouseWheel("onMouseWheel"),MO.Method.empty);return b};
MO.MParent=function(b){b=MO.Class.inherits(this,b);b._parent=MO.Class.register(b,new MO.AGetSet("_parent"));b.isParent=MO.MParent_isParent;b.findParent=MO.MParent_findParent;b.dispose=MO.MParent_dispose;return b};MO.MParent_isParent=function(b){for(;b;){if(b==this)return!0;b=b.parent()}};MO.MParent_findParent=function(b){var d=this;if(b)for(;MO.Class.isClass(d._parent,b);)d=d.parent();else for(;d._parent;)d=d.parent();return d};MO.MParent_dispose=function(){this._parent=null};
MO.MProperty=function(b){b=MO.Class.inherits(this,b);b.propertyAssign=MO.MProperty_propertyAssign;b.propertyLoad=MO.MProperty_propertyLoad;b.propertySave=MO.MProperty_propertySave;return b};MO.MProperty_propertyAssign=function(b){var d=MO.Class.find(this.constructor).annotations(MO.EAnnotation.Property),f;for(f in d){var h=d[f];h.constructor!=Function&&(this[h._name]=b[h._name])}};
MO.MProperty_propertyLoad=function(b){var d=MO.Class.find(this.constructor).annotations(MO.EAnnotation.Property),f;for(f in d){var h=d[f];h.constructor!=Function&&(h._force?h.load(this,b):b.contains(h._linker)?h.load(this,b):null==this[h._name]&&(this[h._name]=h._value))}};MO.MProperty_propertySave=function(b){var d=MO.Class.find(this.constructor).annotations(MO.EAnnotation.Property),f;for(f in d){var h=d[f];h.constructor!=Function&&h.save(this,b)}};
MO.SClickEvent=function(b){MO.SEvent.call(this,b);return this};MO.SEvent=function(b){this.listener=this.annotation=this.code=null;this.sender=b;this.process=this.onProcess=this.ohProcess=this.hSource=this.hSender=this.hEvent=this.source=null;this.dispose=MO.SEvent_dispose;return this};MO.SEvent_dispose=function(){for(var b in this)this[b]=null};
MO.SKeyboardEvent=function(){MO.SEvent.call(this);this.ctrlKey=this.shiftKey=this.altKey=!1;this.keyCode=0;this.attachEvent=MO.SKeyboardEvent_attachEvent;this.cancel=MO.SKeyboardEvent_cancel;return this};MO.SKeyboardEvent_attachEvent=function(b){this.altKey=b.altKey;this.shiftKey=b.shiftKey;this.ctrlKey=b.ctrlKey;this.keyCode=b.keyCode};MO.SKeyboardEvent_cancel=function(){this.hEvent.returnValue=!1};
MO.SMouseEvent=function(){MO.SEvent.call(this);this.button=null;this.ctrlKey=this.altKey=this.mouseRight=this.mouseMiddle=this.mouseLeft=!1;this.deltaZ=this.deltaY=this.deltaX=this.clientY=this.clientX=this.offsetY=this.offsetX=this.y=this.x=0;this.attachEvent=MO.SMouseEvent_attachEvent;return this};
MO.SMouseEvent_attachEvent=function(b){var d=this.hSource=MO.RHtml.eventSource(b);d&&(this.source=d.__linker);this.button=b.button;this.mouseLeft=b.button==MO.EMouseButton.Left;this.mouseMiddle=b.button==MO.EMouseButton.Middle;this.mouseRight=b.button==MO.EMouseButton.Right;this.altKey=b.altKey;this.ctrlKey=b.ctrlKey;MO.RBrowser.isBrowser(MO.EBrowser.FireFox)?(this.x=b.pageX,this.y=b.pageY,this.offsetX=b.layerX,this.offsetY=b.layerY):(this.x=b.x,this.y=b.y,this.offsetX=b.offsetX,this.offsetY=b.offsetY);
this.clientX=b.clientX;this.clientY=b.clientY;this.deltaX=b.deltaX;this.deltaY=b.deltaY;this.deltaZ=b.deltaZ};MO.SResizeEvent=function(){MO.SEvent.call(this);this.height=this.width=null;this.attachEvent=MO.SResizeEvent_attachEvent;return this};MO.SResizeEvent_attachEvent=function(b){if(b=this.hSource=MO.RHtml.eventSource(b))this.source=b.__linker};MO.SXmlEvent=function(){MO.SEvent.call(this);this.root=this.document=this.connection=null;return this};
MO.THtmlItem=function(){this._link=null;this._links={};this.get=MO.THtmlItem_get;this.set=MO.THtmlItem_set;return this};MO.THtmlItem_get=function(b){return this._links[b]};MO.THtmlItem_set=function(b,d){this._links[b]=d};MO.TXmlDocument=function(){this._root=null;this.create=MO.TXmlDocument_create;this.root=MO.TXmlDocument_root;this.setRoot=MO.TXmlDocument_setRoot;this.xml=MO.TXmlDocument_xml;this.dump=MO.TXmlDocument_dump;return this};
MO.TXmlDocument_create=function(b,d,f){var h=new MO.TXmlNode;h._name=b;h._attributes=d;h._value=f;return h};MO.TXmlDocument_root=function(){var b=this._root;b||(b=this._root=new MO.TXmlNode,b._name="Configuration");return b};MO.TXmlDocument_setRoot=function(b){if(this._root)throw new MO.TError(this,"Root node is already exists.");this._root=b};MO.TXmlDocument_xml=function(){var b=new MO.TString;b.append("<?xml version='1.0' encoding='UTF-8'?>");this.root().innerXml(b,0);return b.flush()};
MO.TXmlDocument_dump=function(){var b=new MO.TString;b.appendLine(MO.RClass.name(this));this.root().dump(b);return b.flush()};MO.TXmlNode=function(b){MO.TNode.call(this,b);this.create=MO.TXmlNode_create;this.innerXml=MO.TXmlNode_innerXml;this.xml=MO.TXmlNode_xml;this.toString=MO.TXmlNode_toString;return this};
MO.TXmlNode_create=function(b,d){var f=new MO.TXmlNode;f._name=b;f._attributes=d;if(!MO.Class.isClass(d,MO.TAttributes))for(var h=arguments,q=h.length,w=1;w<q;w+=2)w+1<q?f.set(h[w],h[w+1]):f.setValue(h[w]);this.push(f);return f};
MO.TXmlNode_innerXml=function(b,d){b.appendRepeat("   ",d);b.append("<",this._name);var f=this._attributes;if(f)for(var h=f.count(),q=0;q<h;q++)b.append(" ",f.name(q),'="'),MO.RXml.buildText(b,f.value(q)),b.append('"');this._nodes||null!=this._value||b.append("/");b.append(">\n");if(f=this._nodes)for(h=f.count(),q=0;q<h;q++)f.get(q).innerXml(b,d+1);MO.RXml.buildText(b,this._value);if(this._nodes||null!=this._value)b.appendRepeat("   ",d),b.append("</",this._name,">"),b.append("\n");return b};
MO.TXmlNode_xml=function(){var b=new MO.TString;this.innerXml(b,0);return b.flush()};MO.TXmlNode_toString=function(){return this.xml().toString()};MO.FBytes=function(b){b=MO.Class.inherits(this,b,MO.FObject,MO.MDataView);b._memory=MO.Class.register(b,new MO.AGetter("_memory"));b.construct=MO.FBytes_construct;b.dispose=MO.FBytes_dispose;return b};MO.FBytes_construct=function(){this.__base.FObject.construct.call(this);this._memory=new ArrayBuffer;this._viewer=new DataView(this._memory)};
MO.FBytes_dispose=function(){this._viewer=this._memory=null;this.__base.FObject.dispose.call(this)};MO.FClassFactory=function(b){b=MO.Class.inherits(this,b,MO.FObject);b._classes=null;b.construct=MO.FClassFactory_construct;b.register=MO.FClassFactory_register;b.unregister=MO.FClassFactory_unregister;b.create=MO.FClassFactory_create;b.dispose=MO.FClassFactory_dispose;return b};MO.FClassFactory_construct=function(){this.__base.FObject.construct.call(this);this._classes=new MO.TDictionary};
MO.FClassFactory_register=function(b,d){this._classes.set(b,d)};MO.FClassFactory_unregister=function(b){this._classes.set(b,null)};MO.FClassFactory_create=function(b){var d=this._classes.get(b);if(!d)throw new MO.TError("Create unregister class. (name={1})",b);return MO.Class.create(d)};MO.FClassFactory_dispose=function(){this._classes=MO.Lang.Object.dispose(this._classes);this.__base.FObject.dispose.call(this)};
MO.FComponent=function(b){b=MO.Class.inherits(this,b,MO.FObject,MO.MParent);b._code=MO.Class.register(b,new MO.AGetSet("_code"));b.dispose=MO.FComponent_dispose;return b};MO.FComponent_dispose=function(){this.__base.MParent.dispose.call(this);this.__base.FObject.dispose.call(this)};
MO.FDataStream=function(b){b=MO.Class.inherits(this,b,MO.FObject,MO.MDataView,MO.MDataStream);b._length=MO.Class.register(b,new MO.AGetter("_length"),0);b._memory=MO.Class.register(b,new MO.AGetter("_memory"));b._viewer=null;b.construct=MO.FDataStream_construct;b.setLength=MO.FDataStream_setLength;b.flip=MO.FDataStream_flip;b.dispose=MO.FDataStream_dispose;return b};MO.FDataStream_construct=function(){this.__base.FObject.construct.call(this)};
MO.FDataStream_setLength=function(b){this._length=b;this._memory=new ArrayBuffer(b);this._viewer=new DataView(this._memory)};MO.FDataStream_flip=function(){this._length=this._position;this._position=0};MO.FDataStream_dispose=function(){this._memory=this._viewer=null;this.__base.FObject.dispose.call(this)};MO.FDataView=function(b){b=MO.Class.inherits(this,b,MO.FObject,MO.MDataView,MO.MDataStream);b.link=MO.FDataView_link;b.dispose=MO.FDataView_dispose;return b};
MO.FDataView_link=function(b){this._memory=b;this._viewer=new DataView(b)};MO.FDataView_dispose=function(){this._memory=this._viewer=null;this.__base.FObject.dispose.call(this)};
MO.FFileReader=function(b){b=RClass.inherits(this,b,MO.FObject,MO.MListenerLoad);b._reader=null;b._fileName=MO.Class.register(b,new MO.AGetter("_fileName"));b._length=MO.Class.register(b,new MO.AGetter("_length"),0);b._data=MO.Class.register(b,new MO.AGetter("_data"));b._statusLoading=!1;b.ohloadStart=MO.FFileReader_ohLoadStart;b.ohLoad=MO.FFileReader_ohLoad;b.ohLoadEnd=MO.FFileReader_ohLoadEnd;b.ohProgress=MO.FFileReader_ohProgress;b.construct=MO.FFileReader_construct;b.loadFile=MO.FFileReader_loadFile;
b.dispose=MO.FFileReader_dispose;return b};MO.FFileReader_ohLoadStart=function(){};MO.FFileReader_ohLoad=function(){};MO.FFileReader_ohLoadEnd=function(){var b=this.__linker,d=b._reader;b._statusFree=!0;d.error?MO.Logger.error(b,"Load file failure. (error={1])",d.error):(b._length=d.result.byteLength,b._data=d.result,d=new MO.SEvent(b),b.processLoadListener(d),d.dispose())};MO.FFileReader_ohProgress=function(){};
MO.FFileReader_construct=function(){this.__base.FObject.construct.call(this);var b=this._reader=new FileReader;b.__linker=this;b.onloadstart=this.ohLoadStart;b.onload=this.ohLoad;b.onloadend=this.ohLoadEnd;b.onprogress=this.ohProgress};MO.FFileReader_loadFile=function(b){this._fileName=b.name;this._length=b.size;this._reader.readAsArrayBuffer(b)};
MO.FFileReader_dispose=function(){var b=this._reader=new FileReader;b.__linker=null;b.onloadstart=null;b.onload=null;b.onloadend=null;this._data=this._fileName=this._reader=b.onprogress=null;this.__base.MListenerLoad.dispose.call(this);this.__base.FObject.dispose.call(this)};
MO.FHttpConnection=function(b){b=MO.Class.inherits(this,b,MO.FObject,MO.MListenerLoad,MO.MListenerProcess);b._asynchronous=!1;b._methodCd=MO.EHttpMethod.Get;b._contentCd=MO.EHttpContent.Binary;b._url=null;b._input=null;b._inputData=MO.Class.register(b,new MO.AGetSet("_inputData"));b._output=null;b._outputData=MO.Class.register(b,new MO.AGetter("_outputData"));b._connection=null;b._contentLength=0;b._statusFree=!0;b.onConnectionSend=MO.FHttpConnection_onConnectionSend;b.onConnectionReady=MO.FHttpConnection_onConnectionReady;
b.onConnectionComplete=MO.FHttpConnection_onConnectionComplete;b.construct=MO.FHttpConnection_construct;b.setHeaders=MO.FHttpConnection_setHeaders;b.setOutputData=MO.FHttpConnection_setOutputData;b.content=MO.FHttpConnection_content;b.sendSync=MO.FHttpConnection_sendSync;b.sendAsync=MO.FHttpConnection_sendAsync;b.send=MO.FHttpConnection_send;b.dispose=MO.FHttpConnection_dispose;return b};
MO.FHttpConnection_onConnectionSend=function(){var b=this._input;if(b)if(b.constructor==String)this._inputData=b,this._contentLength=b.length;else if(b.constructor==ArrayBuffer)this._inputData=b,this._contentLength=b.byteLength;else throw new MO.TError("Unknown send data type.");};
MO.FHttpConnection_onConnectionReady=function(){var b=this._linker;if(b._asynchronous){var d=b._connection;d.readyState==MO.EHttpStatus.Loaded&&(200==d.status?(b.setOutputData(),b.onConnectionComplete()):MO.Logger.fatal(b,"Connection failure. (url={1})",b._url))}};MO.FHttpConnection_onConnectionComplete=function(){this._statusFree=!0;this.processLoadListener(this)};MO.FHttpConnection_construct=function(){var b=this._connection=MO.RXml.createConnection();b._linker=this;b.onreadystatechange=this.onConnectionReady};
MO.FHttpConnection_setHeaders=function(){var b=this._connection;this._contentCd==MO.EHttpContent.Binary?MO.RBrowser.isBrowser(MO.EBrowser.Explorer)?(b.setRequestHeader("Accept-Charset","x-user-defined"),b.responseType="arraybuffer"):(b.overrideMimeType("text/plain; charset=x-user-defined"),this._asynchronous&&(b.responseType="arraybuffer")):b.setRequestHeader("content-type","application/x-www-form-urlencoded");MO.RBrowser.isBrowser(MO.EBrowser.Chrome)||0<this._contentLength&&b.setRequestHeader("content-length",
this._contentLength)};MO.FHttpConnection_setOutputData=function(){var b=this._connection;this._outputData=this._contentCd==MO.EHttpContent.Binary?b.response:b.responseText};MO.FHttpConnection_content=function(){return this._outputData};
MO.FHttpConnection_sendSync=function(){var b=this._connection;b.open(this._methodCd,this._url,!1);this.setHeaders(b,0);b.send(this._inputData);this.setOutputData();this.onConnectionComplete();MO.Logger.info(this,"Send http sync request. (method={1}, url={2})",this._methodCd,this._url)};
MO.FHttpConnection_sendAsync=function(){var b=this._connection;b.open(this._methodCd,this._url,!0);this.setHeaders(b,0);b.send(this._inputData);MO.Logger.info(this,"Send http asynchronous request. (method={1}, url={2})",this._methodCd,this._url)};MO.FHttpConnection_send=function(b,d){this._url=b;this._input=d;this._methodCd=null!=d?MO.EHttpMethod.Post:MO.EHttpMethod.Get;this._statusFree=!1;this.onConnectionSend();this._asynchronous?this.sendAsync():this.sendSync();return this.content()};
MO.FHttpConnection_dispose=function(){this._outputData=this._output=this._inputData=this._input=null;var b=this._connection;b&&(this._connection=b.onreadystatechange=null);this.__base.MListenerLoad.dispose.call(this);this.__base.FObject.dispose.call(this)};
MO.FXmlConnection=function(b){b=MO.Class.inherits(this,b,MO.FHttpConnection);b._contentCd=MO.EHttpContent.Text;b._inputNode=null;b._outputNode=null;b.onConnectionSend=MO.FXmlConnection_onConnectionSend;b.onConnectionComplete=MO.FXmlConnection_onConnectionComplete;b.content=MO.FXmlConnection_content;return b};
MO.FXmlConnection_onConnectionSend=function(){var b=this._input;if(b){var d=null;if(b.constructor==String)d=b,this._inputNode=null;else if(b.constructor==MO.TXmlNode)d=new MO.TXmlDocument,d.setRoot(b),d=d.xml(),this._inputNode=b;else if(b.constructor==MO.TXmlDocument)d=b.xml(),this._inputNode=b.root();else throw new MO.TError("Unknown send data type.");this._inputData=d;this._contentLength=d.length}};
MO.FXmlConnection_onConnectionComplete=function(){var b=this._connection,d=null;if(b.responseXML)d=b.responseXML.documentElement;else if(b.responseXml)d=b.responseXml.documentElement;else throw new MO.TError(this,"Fetch xml data failure.");if(!d)return MO.RMessage.fatal(this,null,"Read xml error. (url={1})\n{2}",this._url,b._outputText);b=new MO.TXmlDocument;MO.RXml.buildNode(b,null,d);var f=this._outputNode=b.root();this._statusFree=!0;d=new MO.SXmlEvent;d.connection=this;d.document=b;d.root=f;d.parameters=
this._parameters;this.processLoadListener(d);d.dispose();this._asynchronous&&(this._parameters=this._outputNode=this._output=this._inputNode=this._input=null)};MO.FXmlConnection_content=function(){return this._outputNode};MO.FXmlData=function(b){b=MO.Class.inherits(this,b,MO.FObject);b._ready=null;b._config=null;b.testReady=MO.FXmlData_testReady;return b};MO.FXmlData_testReady=function(){return this._ready};
MO.REngine=function(){this._spaces={};this.Global={};this.Top={};this.Local={};this.onRelease=MO.REngine_onRelease;this.register=MO.REngine_register;this.initialize=MO.REngine_initialize;this.connect=MO.REngine_connect;this.buildSpace=MO.REngine_buildSpace;this.find=MO.REngine_find;this.findGlobal=MO.REngine_findGlobal;this.findTop=MO.REngine_findTop;this.findLocal=MO.REngine_findLocal;return this};MO.REngine_onRelease=function(){MO.RConsole.release();MO.REvent.release();CollectGarbage()};
MO.REngine_register=function(b){var d=this._spaces[b.space];d||(d=this._spaces[b.space]={});d[b.name]=b};MO.REngine_initialize=function(){MO.RConsole.initialize()};MO.REngine_connect=function(){MO.RConsole.initialize()};MO.REngine_buildSpace=function(b,d){for(var f in d)MO.Lang.String.startsWith(f,"R")&&(b[f.substring(1)]=d[f].instance)};MO.REngine_find=function(b,d){var f=null;if(b=this._spaces[b])if(f=b[d])return f.instance;return null};
MO.REngine_findGlobal=function(b){return this.find(MO.ESpace.Global,b)};MO.REngine_findTop=function(b){return top.MO.REngine.find(MO.ESpace.Top,b)};MO.REngine_findLocal=function(b){return this.find(MO.ESpace.Local,b)};MO.REngine=new MO.REngine;
MO.RLoader=function(){this._loading=new MO.TArray;this._loaded=new MO.TArray;this._waits=new MO.TArray;this.hWindow=this._intervalId=null;this.onInterval=MO.RLoader_onInterval;this.intervalStart=MO.RLoader_intervalStart;this.intervalStop=MO.RLoader_intervalStop;this.loadJsFile=MO.RLoader_loadJsFile;this.loadJs=MO.RLoader_loadJs;this.loaded=MO.RLoader_loaded;this.wait=MO.RLoader_wait;this.waitJs=MO.RLoader_waitJs;this.dispose=MO.RLoader_dispose;return this};
MO.RLoader_dispose=function(){this.intervalStop();this.hWindow=null};MO.RLoader_onInterval=function(){for(var b=this._waits,d=b.length,f=0;f<d;f++){var h=b.get(f);h&&h.check(this._loaded)&&(h.invoke.invoke(),b.set(f,null))}b.compress();b.isEmpty()&&this.intervalStop()};MO.RLoader_intervalStart=function(){var b=this;b._intervalId||(b.hWindow=window,b._intervalId=window.setInterval(function(){b.onInterval()},10))};
MO.RLoader_intervalStop=function(){var b=this.hWindow;b&&this._intervalId&&(b.clearInterval(this._intervalId),this._intervalId=this.hWindow=null)};
MO.RLoader_loadJsFile=function(b,d){var f=this,h=MO.RWindow.hDocument,q=h.getElementsByTagName("head")[0];if(null==document.getElementById(b)){var w=top.MO.RContext.location(d),z=MO.RWindow.createElement("SCRIPT");z.id=b;z.type="text/javascript";z.src=w;h.attachEvent?z.onreadystatechange=function(){var d=z.readyState;if("loaded"==d||"complete"==d)z.onreadystatechange=null,f._loading.extract(b),f._loaded.push(b)}:z.onload=function(){"complete"==h.readyState&&(z.onload=null,f._loading.extract(b),f._loaded.push(b))};
q.appendChild(z)}};MO.RLoader_loadJs=function(b){for(var d=arguments,f=d.length,h=0;h<f;h++){var q=d[h];this.loadJsFile("js:"+q,"/ajs/"+q.replace(/\./g,"/")+".js")}};MO.RLoader_loaded=function(b){this._loading.extract(b);this._loaded.push(b)};MO.RLoader_wait=function(b,d){var f=new MO.TLoaderListener;f.invoke=b;for(var h=arguments.length,q=1;q<h;q++)f.ids.push(arguments[q]);this._waits.push(f);this.intervalStart()};
MO.RLoader_waitJs=function(b,d){var f=new MO.TLoaderListener;f.invoke=b;for(var h=arguments,q=h.length,w=1;w<q;w++)f.ids.push("js:"+h[w]);this._waits.push(f);this.intervalStart()};MO.RLoader=new MO.RLoader;
MO.RMessage=function(){this._hasError=!1;this._messages=null;this.push=MO.RMessage_push;this.fatal=MO.RMessage_fatal;this.confirmResult=!1;this.error=MO.RMessage_error;this.warn=MO.RMessage_warn;this.onWindowClose=MO.RMessage_onWindowClose;this.confirm=MO.RMessage_confirm;this.info=MO.RMessage_info;return this};MO.RMessage_push=function(b){this._messages||(this._messages=new FLoopList);this._messages.push(b)};
MO.RMessage_fatal=function(b,d,f,h){if(!this._hasError){this._hasError=!0;for(var q=new MO.TString,w=[],z=MO.RMessage_fatal.caller;z&&!MO.Lang.Array.contains(w,z);)w.push(z),z=z.caller;for(var A=w.length,B=0;B<A;B++)z=w[B],0<B&&q.appendLine(),q.append("   "+(A-B)+": "+MO.Method.name(z));w=new MO.TString;w.appendLine(MO.RContext.get("RMessage:fatal"));w.appendLine(MO.Lang.String.repeat("-",60));w.append(MO.Class.dump(b),": ");if(f)for(z=arguments,A=z.length,B=3;B<A;B++){var C=z[B];"function"==typeof C&&
(C=MO.Method.name(C));f=f.replace("{"+(B-2)+"}",C)}w.appendLine(f);w.appendLine(MO.String.repeat("-",60));w.appendLine("Stack:");w.append(q);alert(w)}};MO.RMessage_error=function(b,d,f,h){if(!this._hasError)throw this._hasError=!0,Error(f);};MO.RMessage_warn=function(b,d,f){new MO.TString;b=top.MO.RControl.create(MO.FAlertWindow);b.setText(d);b.show()};MO.RMessage_info=function(b,d,f){new MO.TString;b=top.MO.RControl.create(MO.FInfoWindow);b.setText(d);b.show()};
MO.RMessage_confirm=function(b,d){var f=top.MO.RControl.create(MO.FConfirmWindow);f.setText(b);f.lsns.register(this,d);f.show()};MO.RMessage_onWindowClose=function(b){this.confirmResult=b};MO.RMessage=new MO.RMessage;MO.RListener=function(){this._listeners={};return this};MO.RListener.prototype.makeAddListener=function(b,d){var f=null;this._listeners[b]?f=this._listeners[b]:(f=new Function("owner","callback","return this.addListener('"+d+"',owner,callback);"),this._listeners[b]=f);return f};
MO.RListener.prototype.makeSetListener=function(b,d){var f=null;this._listeners[b]?f=this._listeners[b]:(f=new Function("owner","callback","return this.setListener('"+d+"',owner,callback);"),this._listeners[b]=f);return f};MO.RListener.prototype.makeRemoveListener=function(b,d){var f=null;this._listeners[b]?f=this._listeners[b]:(f=new Function("owner","callback","return this.removeListener('"+d+"',owner,callback);"),this._listeners[b]=f);return f};
MO.RListener.prototype.makeClearListener=function(b,d){var f=null;this._listeners[b]?f=this._listeners[b]:(f=new Function("return this.clearListeners('"+d+"');"),this._listeners[b]=f);return f};MO.RListener.prototype.makeProcessListener=function(b,d){var f=null;this._listeners[b]?f=this._listeners[b]:(f=new Function("p1","p2","p3","p4","p5","p6","return this.processListener('"+d+"', p1, p2, p3, p4, p5, p6);"),this._listeners[b]=f);return f};MO.RListener=new MO.RListener;
MO.RResource=function(){this.uriIcon="/ars/icon/";this.uriImage="/ars/img/";return this};MO.RResource.prototype.iconPath=function(b,d){b=MO.Lang.String.nvl(b,"n").replace(/\./g,"/")+"."+MO.Lang.String.nvl(d,"gif");return MO.RBrowser.contentPath("/ars/icon/"+b)};MO.RResource.prototype.iconUrlPath=function(b,d){b=MO.Lang.String.nvl(b,"n").replace(/\./g,"/")+"."+MO.Lang.String.nvl(d,"gif");return MO.RBrowser.contentPath("/ars/icon/"+b)};MO.RResource.prototype.imagePath=function(b,d){};MO.RResource=new MO.RResource;
MO.RStyle=function(){this._connected=!1;this._rules=new MO.TMap;this.connect=MO.RStyle_connect;this.has=MO.RStyle_has;this.nvl=MO.RStyle_nvl;this.style=MO.RStyle_style;return this};MO.RStyle_connect=function(){if(!this._connected){for(var b=this._rules,d=document.styleSheets,f=d.length,h=0;h<f;h++){var q=d[h].cssRules;if(q)for(var w=q.length,z=0;z<w;z++){var A=q[z];b.set(A.selectorText,A)}}this._connected=!0}};
MO.RStyle_has=function(b){this._connected||this.connect();return b?this._rules.contains("."+b.toLowerCase()):!1};MO.RStyle_nvl=function(b,d){this.connect();var f=arguments,h=f.length;for(d=0;d<h;d++)if((b=f[d])&&this._rules.contains("."+b.toLowerCase()))return b;return null};MO.RStyle_style=function(b,d){return MO.Class.name(b)+"_"+d};MO.RStyle=new MO.RStyle;MO.RTypeArray=function(){this._float4=this._float3=null;this._data={};return this};
MO.RTypeArray.prototype.float3=function(){var b=this._float3;null==b&&(b=this._float3=new Float32Array(3));return b};MO.RTypeArray.prototype.float4=function(){var b=this._float4;null==b&&(b=this._float4=new Float32Array(4));return b};
MO.RTypeArray.prototype.createArray=function(b,d){switch(b){case MO.EDataType.Boolean:case MO.EDataType.Int8:return new Int8Array(d);case MO.EDataType.Int16:return new Int16Array(d);case MO.EDataType.Int32:return new Int32Array(d);case MO.EDataType.Int64:return new Int64Array(d);case MO.EDataType.Uint8:return new Uint8Array(d);case MO.EDataType.Uint16:return new Uint16Array(d);case MO.EDataType.Uint32:return new Uint32Array(d);case MO.EDataType.Float32:return new Float32Array(d);case MO.EDataType.Float64:return new Float64Array(d)}throw new TError("Create unknown type array. (type={1}, length={2})",
b,d);};MO.RTypeArray.prototype.findTemp=function(b,d){var f=this._data,h=f[b];null==h&&(h=f[b]={});f=h[d];null==f&&(f=h[d]=this.createArray(b,d));return f};MO.Lang.TypeArray=new MO.RTypeArray;MO.RXml=function(){return this};MO.RXml.prototype.isNode=function(b){return MO.Class.isName(b,"TNode")};MO.RXml.prototype.formatText=function(b){null!=b&&(b=b.replace(/\\n/g,"\n"));return b};
MO.RXml.prototype.buildText=function(b,d){if(null!=d){d=d.toString();for(var f=d.length,h=0;h<f;h++){var q=d.charAt(h);switch(q){case "<":b.append("&lt;");break;case ">":b.append("&gt;");break;case "&":b.append("&amp;");break;case "'":b.append("&apos;");break;case '"':b.append("&quot;");break;case "\r":continue;case "\n":b.append("\\n");break;default:b.append(q)}}}return b};
MO.RXml.prototype.buildNode=function(b,d,f){var h=null,q=f.attributes;if(q){var w=q.length;if(0<w)for(var h=new MO.TAttributes,z=0;z<w;z++){var A=q[z];A.nodeName&&h.set(A.nodeName,this.formatText(A.value))}}w=new MO.TString;w.append(f.value);if(q=f.childNodes)for(A=q.length,z=0;z<A;z++){var B=q[z],C=B.nodeType;C==MO.ENodeType.Text?w.append(B.nodeValue):C==MO.ENodeType.Data&&w.append(B.data)}f=b.create(f.nodeName,h,MO.Lang.String.trim(w.toString()));d?d.push(f):b._root=f;if(q)for(d=q.length,z=0;z<
d;z++)q[z].nodeType==MO.ENodeType.Node&&this.buildNode(b,f,q[z])};MO.RXml.prototype.makeNode=function(b){if(b.documentElement){var d=new MO.TXmlDocument;this.buildNode(d,null,b.documentElement);return d.root()}if("SCRIPT"==b.tagName){var f=b.textContent;f||(f=b.text);if(f)return d=new MO.TXmlDocument,b=this.makeString(f),this.buildNode(d,null,b.documentElement),d.root()}return null};
MO.RXml.prototype.makeDocument=function(b){var d=new MO.TXmlDocument;b.documentElement&&this.buildNode(d,null,b.documentElement);return d};
MO.RXml.prototype.unpack=function(b,d){if(MO.Lang.String.isEmpty(b))return null;d||(d=new MO.TNode);var f=new MO.TAttributes;f.unpack(b);d.name=f.get("name");d.value=f.get("value");f.contains("attributes")&&d.attributes().unpack(f.get("attributes"));if(f.contains("nodes")){var h=new MO.TStrings;h.unpack(f.get("nodes"));for(f=0;f<h.count;f++)this.unpack(h.get(f),d.create())}return d};
MO.RXml.prototype.saveObject=function(b,d,f){for(var h in f){var q=f[h];if(null!=q){var w=b.create(d);w.set("name",h);switch(typeof q){case "boolean":case "number":case "date":case "string":w.setValue(q);break;case "function":w.setValue(MO.Method.name(q));break;case "object":this.saveObject(w,"Property",q);break;default:throw new MO.TError("Invalid object.");}}}};MO.Lang.Xml=new MO.RXml;
MO.FTag=function(b){b=MO.Class.inherits(this,b,MO.FObject);b._name="Tag";b._children=null;b._trimLeft=!1;b._trimRight=!1;b.onBegin=MO.FTag_onBegin;b.onEnd=MO.FTag_onEnd;b.name=MO.FTag_name;b.set=MO.FTag_set;b.push=MO.FTag_push;b.parse=MO.FTag_parse;b.toString=MO.FTag_toString;b.innerDump=MO.FTag_innerDump;b.dump=MO.FTag_dump;return b};MO.FTag_onBegin=function(b){return MO.EResult.Continue};MO.FTag_onEnd=function(b){return MO.EResult.Continue};MO.FTag_name=function(){return this._name};
MO.FTag_set=function(b,d){throw new MO.TError(this,"Unknown attribute name. (name={1}, value={2})",b,d);};MO.FTag_push=function(b){var d=this._children;null==d&&(d=this._children=new MO.TObjects);d.push(b)};MO.FTag_parse=function(b){var d=this.onBegin(b);if(d==MO.EResult.Continue){var f=this._children;if(f)for(var h=f.count(),q=0;q<h;q++){var w=f.get(q),d=w.parse(b);if(d==MO.EResult.Cancel)return d;b._trimLeft=w._trimLeft;b._trimRight=w._trimRight}return this.onEnd(b)}return d};MO.FTag_toString=function(){return null};
MO.FTag_innerDump=function(b,d,f){b.appendRepeat("   ",f);b.append(MO.Class.dump(d));var h=d.toString();MO.RString.isEmpty(h)||b.append(" [",h,"]");if(d=d._children){b.append("\n");for(var h=d.count(),q=0;q<h;q++){var w=d.get(q);this.innerDump(b,w,f+1);q<h-1&&b.append("\n")}}};MO.FTag_dump=function(){var b=new MO.TString;this.innerDump(b,this,0);return b.toString()};
MO.FTagContext=function(b){b=MO.Class.inherits(this,b,MO.FObject,MO.MInstance);b._trimLeft=!1;b._trimRight=!1;b._attributes=MO.Class.register(b,new MO.AGetter("_attributes"));b._source=null;b.construct=MO.FTagContext_construct;b.instanceAlloc=MO.FTagContext_instanceAlloc;b.get=MO.FTagContext_get;b.set=MO.FTagContext_set;b.setBoolean=MO.FTagContext_setBoolean;b.source=MO.FTagContext_source;b.write=MO.FTagContext_write;b.resetSource=MO.FTagContext_resetSource;b.dispose=MO.FTagContext_dispose;return b};
MO.FTagContext_construct=function(){this.__base.FObject.construct.call(this);this._attributes=new MO.TAttributes;this._source=new MO.TString};MO.FTagContext_instanceAlloc=function(){this._attributes.clear()};MO.FTagContext_get=function(b,d){return this._attributes.get(b,d)};MO.FTagContext_set=function(b,d){this._attributes.set(b,d)};MO.FTagContext_setBoolean=function(b,d){this._attributes.set(b,MO.RBoolean.toString(d))};MO.FTagContext_source=function(){return this._source.toString()};
MO.FTagContext_write=function(b){MO.Lang.String.isEmpty(b)||this._source.append(b)};MO.FTagContext_resetSource=function(b){this._source.clear()};MO.FTagContext_dispose=function(){this._attributes=RObject.dispose(this._attributes);this._source=RObject.dispose(this._source);this.__base.FObject.dispose.call(this)};
MO.FTagDocument=function(b){b=MO.Class.inherits(this,b,MO.FObject);b._space=MO.Class.register(b,MO.AGetSet("_space"));b._root=MO.Class.register(b,MO.AGetter("_root"));b.create=MO.FTagDocument_create;b.loadNode=MO.FTagDocument_loadNode;b.load=MO.FTagDocument_load;b.parse=MO.FTagDocument_parse;b.dump=MO.FTagDocument_dump;return b};
MO.FTagDocument_create=function(b){var d=this._space+"_",f=null,f=MO.RString.startsWith(b,d)?b.substring(d.length):b;b=null;switch(f){case "source":b=MO.Class.create(MO.FTag);break;case "write":b=MO.Class.create(MO.FTagWrite);break;case "true":b=MO.Class.create(MO.FTagTrue);break;case "false":b=MO.Class.create(MO.FTagFalse);break;case "equals":b=MO.Class.create(MO.FTagEquals);break;case "notEquals":b=MO.Class.create(MO.FTagNotEquals);break;default:throw new MO.TError(this,"Unknown tag type. (name={1})",
f);}return b};
MO.FTagDocument_loadNode=function(b,d){var f=this.create(d.nodeName);b?b.push(f):this._root=f;var h=d.attributes;if(h)for(var q=h.length,w=0;w<q;w++){var z=h[w];z.nodeName&&f.set(z.nodeName,MO.RXml.formatText(z.value))}if(h=d.childNodes)for(q=h.length,w=0;w<q;w++)switch(z=h[w],z.nodeType){case MO.ENodeType.Text:var A=MO.Class.create(MO.FTagText);A.setText(z.nodeValue);f.push(A);break;case MO.ENodeType.Data:A=MO.Class.create(MO.FTagText);A.setText(z.data);f.push(A);break;case MO.ENodeType.Node:this.loadNode(f,z)}};
MO.FTagDocument_load=function(b){b=("<source>"+b+"</source>").replace(new RegExp("<"+this._space+":","g"),"<"+this._space+"_");b=b.replace(new RegExp("</"+this._space+":","g"),"</"+this._space+"_");b=b.replace(RegExp(" & ","g")," &amp; ");b=b.replace(RegExp(" < ","g")," &lt; ");b=b.replace(RegExp(" > ","g")," &gt; ");b=MO.RXml.makeString(b);this.loadNode(null,b.firstChild)};MO.FTagDocument_parse=function(b){b.resetSource();this._root.parse(b);return b.source()};
MO.FTagDocument_dump=function(){var b=new MO.TString;b.appendLine(MO.Class.dump(this));b.appendLine(this.root().dump(b));return b.toString()};MO.FTagEquals=function(b){b=MO.Class.inherits(this,b,MO.FTag);b._trimLeft=!0;b._source=null;b._value=null;b.onBegin=MO.FTagEquals_onBegin;b.set=MO.FTagEquals_set;b.toString=MO.FTagEquals_toString;return b};
MO.FTagEquals_onBegin=function(b){var d=!1;b=b.get(this._source);for(var f=this._value.split("|"),h=f.length,q=0;q<h;q++)if(b==f[q]){d=!0;break}return d?MO.EResult.Continue:MO.EResult.Skip};MO.FTagEquals_set=function(b,d){switch(b){case "source":this._source=d;return;case "value":this._value=d;return}this.__base.FTag.set.call(this,b,d)};MO.FTagEquals_toString=function(){return"source="+this._source+", value="+this._value};
MO.FTagFalse=function(b){b=MO.Class.inherits(this,b,MO.FTag);b._trimLeft=!0;b._source=null;b.onBegin=MO.FTagFalse_onBegin;b.set=MO.FTagFalse_set;b.toString=MO.FTagFalse_toString;return b};MO.FTagFalse_onBegin=function(b){b=b.get(this._source);return MO.RBoolean.parse(b)?MO.EResult.Skip:MO.EResult.Continue};MO.FTagFalse_set=function(b,d){switch(b){case "source":this._source=d;return}this.__base.FTag.set.call(this,b,d)};MO.FTagFalse_toString=function(){return"source="+this._source};
MO.FTagNotEquals=function(b){b=MO.Class.inherits(this,b,MO.FTag);b._trimLeft=!0;b._source=null;b._value=null;b.onBegin=MO.FTagNotEquals_onBegin;b.set=MO.FTagNotEquals_set;b.toString=MO.FTagNotEquals_toString;return b};MO.FTagNotEquals_onBegin=function(b){var d=!0;b=b.get(this._source);for(var f=this._value.split("|"),h=f.length,q=0;q<h;q++)if(b==f[q]){d=!1;break}return d?MO.EResult.Continue:MO.EResult.Skip};
MO.FTagNotEquals_set=function(b,d){switch(b){case "source":this._source=d;return;case "value":this._value=d;return}this.__base.FTag.set.call(this,b,d)};MO.FTagNotEquals_toString=function(){return"source="+this._source+", value="+this._value};MO.FTagText=function(b){b=MO.Class.inherits(this,b,MO.FTag);b._text=MO.Class.register(b,new MO.AGetSet("_text"));b.onBegin=MO.FTagText_onBegin;b.toString=MO.FTagText_toString;return b};
MO.FTagText_onBegin=function(b){var d=this._text;b._trimLeft&&(MO.RString.startsWith(d,"\r")&&(d=d.substring(1)),MO.RString.startsWith(d,"\n")&&(d=d.substring(1)));b._trimRight&&(MO.RString.endsWith(d,"\r")&&(d=d.substring(0,d.length-1)),MO.RString.endsWith(d,"\n")&&(d=d.substring(0,d.length-1)));b.write(d);return MO.EResult.Skip};MO.FTagText_toString=function(){return"{"+this._text+"}"};
MO.FTagTrue=function(b){b=MO.Class.inherits(this,b,MO.FTag);b._trimLeft=!0;b._source=null;b.onBegin=MO.FTagTrue_onBegin;b.set=MO.FTagTrue_set;b.toString=MO.FTagTrue_toString;return b};MO.FTagTrue_onBegin=function(b){for(var d=!1,f=this._source.split("|"),h=f.length,q=0;q<h;q++){var w=b.get(f[q]);if(MO.Lang.Boolean.parse(w)){d=!0;break}}return d?MO.EResult.Continue:MO.EResult.Skip};MO.FTagTrue_set=function(b,d){switch(b){case "source":this._source=d;return}this.__base.FTag.set.call(this,b,d)};
MO.FTagTrue_toString=function(){return"source="+this._source};MO.FTagWrite=function(b){b=MO.Class.inherits(this,b,MO.FTag);b._source=null;b.onBegin=MO.FTagWrite_onBegin;b.set=MO.FTagWrite_set;b.toString=MO.FTagWrite_toString;return b};MO.FTagWrite_onBegin=function(b){var d=b.get(this._source);b.write(d);return MO.EResult.Skip};MO.FTagWrite_set=function(b,d){switch(b){case "source":this._source=d;return}this.__base.FTag.set.call(this,b,d)};MO.FTagWrite_toString=function(){return"source="+this._source};
MO.EThreadStatus=new function(){this.Sleep=0;this.Active=1;this.Finish=2;return this};MO.SProcessEvent=function(){this.data=this.code=this.index=null;return this};MO.SXmlEvent=function(){this.callback=this.outputDocument=this.inputDocument=this.parameter=this.action=this.url=this.owner=null;this.process=MO.SXmlEvent_process;this.dispose=MO.SXmlEvent_dispose;return this};
MO.SXmlEvent_process=function(b){this.outputDocument=b.document;this.outputNode=b.root;this.owner?this.callback.call(this.owner,this):this.callback(this)};MO.SXmlEvent_dispose=function(){this.callback=this.outputDocument=this.inputDocument=this.parameter=this.action=this.url=this.owner=null};MO.FContent=function(b){b=MO.Class.inherits(this,b,MO.FObject);b._name=MO.Class.register(b,new MO.AGetter("_name"));return b};
MO.FContentConsole=function(b){b=MO.Class.inherits(this,b,MO.FConsole);b._scopeCd=MO.EScope.Local;b._connections=null;b.onLoad=MO.FContentConsole_onLoad;b.construct=MO.FContentConsole_construct;b.alloc=MO.FContentConsole_alloc;b.process=MO.FContentConsole_process;b.send=MO.FContentConsole_send;return b};MO.FContentConsole_construct=function(){this.__base.FConsole.construct.call(this);this._connections=new MO.TObjects};
MO.FContentConsole_onLoad=function(){var b=this.event;b.document=this.document;b.process();this.document=this.event=null;this._statusFree=!0};MO.FContentConsole_alloc=function(){for(var b=null,d=this._connections,f=d.count-1;0<=f;f--){var h=d.get(f);if(h._statusFree){b=h;break}}b||(b=MO.Class.create(MO.FXmlConnection),d.push(b),b.onLoad=this.onLoad);b._statusFree=!1;return b};
MO.FContentConsole_process=function(b){var d=this.alloc();d.event=b;switch(b.code){case MO.EXmlEvent.Send:d.send(b.url,b.document);break;case MO.EXmlEvent.Receive:d.receive(b.url,b.document);break;case MO.EXmlEvent.SyncSend:return d.syncSend(b.url,b.document);case MO.EXmlEvent.SyncReceive:return d.syncReceive(b.url,b.document)}};MO.FContentConsole_send=function(b,d){var f=this.alloc(),h=f.syncSend(b,d);f._statusFree=!0;return h};
MO.FContentPipeline=function(b){b=MO.Class.inherits(this,b,MO.FPipeline);b._scopeCd=MO.Class.register(b,new MO.AGetter("_scopeCd"),MO.EScope.Global);return b};
MO.FDragConsole=function(b){b=MO.Class.inherits(this,b,MO.FConsole);b._scopeCd=MO.EScope.Local;b._activeDragable=null;b._dragables=null;b.onMouseDown=MO.FDragConsole_onMouseDown;b.onMouseMove=MO.FDragConsole_onMouseMove;b.onMouseUp=MO.FDragConsole_onMouseUp;b.construct=MO.FDragConsole_construct;b.register=MO.FDragConsole_register;b.unregister=MO.FDragConsole_unregister;b.clear=MO.FDragConsole_clear;return b};
MO.FDragConsole_onMouseDown=function(b){var d=b.source;d&&MO.Class.isClass(d,MO.MUiDragable)&&(MO.RWindow.setOptionSelect(!1),this._activeDragable=d,d.onDragStart(b))};MO.FDragConsole_onMouseMove=function(b){if(this._activeDragable)this._activeDragable.onDragMove(b)};MO.FDragConsole_onMouseUp=function(b){this._activeDragable&&(MO.RWindow.setOptionSelect(!0),this._activeDragable.onDragStop(b),this._activeDragable=null)};
MO.FDragConsole_construct=function(){this.__base.FConsole.construct.call(this);this._dragables=new MO.TObjects;MO.RWindow.lsnsMouseDown.register(this,this.onMouseDown);MO.RWindow.lsnsMouseMove.register(this,this.onMouseMove);MO.RWindow.lsnsMouseUp.register(this,this.onMouseUp)};MO.FDragConsole_register=function(b){this._dragables.push(b)};MO.FDragConsole_unregister=function(b,d){this._dragables.remove(p)};MO.FDragConsole_clear=function(){this._dragables.clear()};
MO.FEnvironment=function(b){b=MO.Class.inherits(this,b,MO.FObject);b._name=MO.Class.register(b,new MO.AGetSet("_name"));b._value=MO.Class.register(b,new MO.AGetSet("_value"));b.set=MO.FEnvironment_set;return b};MO.FEnvironment_set=function(b,d){this._name=b;this._value=d};
MO.FEnvironmentConsole=function(b){b=MO.Class.inherits(this,b,MO.FConsole);b._scopeCd=MO.EScope.Local;b._environments=MO.Class.register(b,new MO.AGetSet("_environments"));b.construct=MO.FEnvironmentConsole_construct;b.register=MO.FEnvironmentConsole_register;b.registerValue=MO.FEnvironmentConsole_registerValue;b.find=MO.FEnvironmentConsole_find;b.findValue=MO.FEnvironmentConsole_findValue;b.parse=MO.FEnvironmentConsole_parse;b.dispose=MO.FEnvironmentConsole_dispose;return b};
MO.FEnvironmentConsole_construct=function(){this.__base.FConsole.construct.call(this);this._environments=new MO.TDictionary};MO.FEnvironmentConsole_register=function(b){var d=b.name();this._environments.set(d,b)};MO.FEnvironmentConsole_registerValue=function(b,d){var f=MO.RClass.create(MO.FEnvironment);f.set(b,d);this._environments.set(b,f);return f};MO.FEnvironmentConsole_find=function(b){return this._environments.get(b)};
MO.FEnvironmentConsole_findValue=function(b){var d=null;(b=this._environments.get(b))&&(d=b.value());return d};MO.FEnvironmentConsole_parse=function(b){for(var d=this._environments,f=d.count(),h=0;h<f;h++){var q=d.at(h);b=MO.Lang.String.replace(b,"{"+q.name()+"}",q.value())}return b};MO.FEnvironmentConsole_dispose=function(){this._environments=new TDictionary;this.__base.FConsole.dispose.call(this)};
MO.FEvent=function(b){b=MO.Class.inherits(this,b,MO.FObject);b._owner=MO.Class.register(b,new MO.AGetSet("_owner"));b._callback=MO.Class.register(b,new MO.AGetSet("_callback"));b._valid=MO.Class.register(b,new MO.AGetSet("_valid"),!0);b.process=MO.FEvent_process;return b};MO.FEvent_process=function(){if(this._valid){var b=this._owner;b?this._callback.call(b,this):this._callback(this)}};
MO.FEventConsole=function(b){b=MO.Class.inherits(this,b,MO.FConsole);b._scopeCd=MO.EScope.Local;b._thread=null;b._interval=100;b._processEvents=null;b._events=null;b.onProcess=MO.FEventConsole_onProcess;b.construct=MO.FEventConsole_construct;b.register=MO.FEventConsole_register;b.push=MO.FEventConsole_push;b.clear=MO.FEventConsole_clear;return b};
MO.FEventConsole_onProcess=function(){var b=this._events;if(!b.isEmpty()){var d=this._processEvents;d.assign(b);b.clear();b=d.count();if(0<b){for(var f=0;f<b;f++)d.get(f).process();d.clear()}}};MO.FEventConsole_construct=function(){this.__base.FConsole.construct.call(this);this._processEvents=new MO.TObjects;this._events=new MO.TObjects;var b=this._thread=MO.Class.create(MO.FThread);b.setInterval(this._interval);b.lsnsProcess.register(this,this.onProcess);MO.Console.find(MO.FThreadConsole).start(b)};
MO.FEventConsole_register=function(b,d){var f=MO.Class.create(FEvent);f.owner=b;f.callback=d;this._events.push(f)};MO.FEventConsole_push=function(b){var d=this._events;d.contains(b)||d.push(b)};MO.FEventConsole_clear=function(){this._events.clear()};
MO.FHttpConsole=function(b){b=MO.Class.inherits(this,b,MO.FConsole);b._scopeCd=MO.EScope.Local;b._pool=null;b.onLoad=MO.FHttpConsole_onLoad;b.construct=MO.FHttpConsole_construct;b.alloc=MO.FHttpConsole_alloc;b.free=MO.FHttpConsole_free;b.send=MO.FHttpConsole_send;b.sendAsync=MO.FHttpConsole_sendAsync;b.fetch=MO.FHttpConsole_fetch;b.dispose=MO.FHttpConsole_dispose;return b};MO.FHttpConsole_onLoad=function(b){this._pool.free(b)};
MO.FHttpConsole_construct=function(){this.__base.FConsole.construct.call(this);this._pool=MO.Class.create(MO.FObjectPool)};MO.FHttpConsole_alloc=function(){var b=this._pool;if(!b.hasFree()){var d=MO.Class.create(MO.FHttpConnection);d._asynchronous=!0;this._pool.push(d)}d=b.alloc();d.clearLoadListeners();d.clearProcessListeners();d.addLoadListener(this,this.onLoad);return d};MO.FHttpConsole_free=function(b){this._pool.free(b)};MO.FHttpConsole_send=function(b,d){var f=this.alloc();f.send(b,d);return f};
MO.FHttpConsole_sendAsync=function(b,d){var f=this.alloc();f._asynchronous=!0;f.send(b,d);return f};MO.FHttpConsole_fetch=function(b,d){var f=this.alloc();f._contentCd=MO.EHttpContent.Text;f.send(b,d);return f};MO.FHttpConsole_dispose=function(){this.__base.FConsole.dispose.call(this)};MO.FIdleConsole=function(b){b=RClass.inherits(this,b,FConsole);b.scope=MO.EScope.Page;b.register=MO.FIdleConsole_register;return b};
MO.FIdleConsole_register=function(b,d){this.active=new TActive(b,d);this.active.interval=100;RConsole.find(FActiveConsole).push(this.active)};MO.FIdleConsole_construct=function(){};MO.FJsonConsole=function(b){b=MO.Class.inherits(this,b,MO.FHttpConsole);b._scopeCd=MO.EScope.Local;b.onLoad=MO.FJsonConsole_onLoad;b.send=MO.FJsonConsole_send;b.sendAsync=MO.FJsonConsole_sendAsync;return b};
MO.FJsonConsole_onLoad=function(b){this.__base.FHttpConsole.onLoad.call(this,b);var d=b.outputData(),d=JSON.parse(d),f=MO.Memory.alloc(MO.SEvent);f.connection=b;f.content=d;b.processProcessListener(f);MO.Memory.free(f)};MO.FJsonConsole_send=function(b,d){var f=this.alloc();f._asynchronous=!1;f._contentCd=MO.EHttpContent.Text;var h=f.send(b,data);console.free(f);return h};MO.FJsonConsole_sendAsync=function(b,d){var f=this.alloc();f._asynchronous=!0;f._contentCd=MO.EHttpContent.Text;f.send(b,d);return f};
MO.FLoggerConsole=function(b){b=MO.Class.inherits(this,b,MO.FConsole);b._scopeCd=MO.EScope.Page;b.iLogger=null;b.onKeyDown=MO.FLoggerConsole_onKeyDown;b.construct=MO.FLoggerConsole_construct;b.connect=MO.FLoggerConsole_connect;b.disconnect=MO.FLoggerConsole_disconnect;b.output=MO.FLoggerConsole_output;return b};MO.FLoggerConsole_onKeyDown=function(b){b.shiftKey&&b.ctrlKey&&EKey.L==b.keyCode&&this.connect()};
MO.FLoggerConsole_construct=function(){this.base.FConsole.construct.call(this);MO.RWindow.lsnsKeyDown.register(this,this.onKeyDown)};MO.FLoggerConsole_connect=function(){};MO.FLoggerConsole_disconnect=function(){this.iLogger=null};MO.FLoggerConsole_output=function(b,d,f,h,q,w){this.iLogger&&(d=MO.Class.dump(d),h&&(d+=" ("+h+"ms)"),b=b+" ["+MO.Lang.String.rpad(d,36)+"] ",b=w?b+(MO.Lang.String.rpad(q,120)+" ["+w+"]"):b+q,this.iLogger.Output(b))};
MO.FLoggerConsole_xml=function(){this.environment||this.connect();return this.environment?this.environment.xml():null};
MO.FMonitorConsole=function(b){b=MO.Class.inherits(this,b,MO.FConsole);b.scope=MO.EScope.Global;b.working=!1;b.interval=10;b.intervalId=null;b.monitors=new MO.TList;b.hWindow=null;b.doInterval=MO.FMonitorConsole_doInterval;b.push=MO.FMonitorConsole_push;b.process=MO.FMonitorConsole_process;b.processAll=MO.FMonitorConsole_processAll;b.startup=MO.FMonitorConsole_startup;b.wait=MO.FMonitorConsole_wait;b.release=MO.FMonitorConsole_release;return b};
MO.FMonitorConsole_push=function(b){this.startup();b.id=this.monitors.sync(b);b.name="T:"+MO.Lang.String.lpad(b.id,4,"0");b.status=EMonitor.Active};MO.FMonitorConsole_process=function(b){if(b)switch(b.status){case MO.EMonitor.Active:b.process(this.interval);break;case MO.EMonitor.Cancel:this.monitors.removeItem(b)}};MO.FMonitorConsole_processAll=function(){this.working=!0;for(var b=this.monitors,d=0;d<b.count;d++)this.process(b.get(d));this.working=!1};
MO.FMonitorConsole_doInterval=function(){var b=MO.RGlobal.get(FMonitorConsole);b&&!b.working&&b.processAll()};MO.FMonitorConsole_startup=function(){if(!this.hWindow){this.hWindow=window;debugger;this.intervalId=this.hWindow.setInterval(this.doInterval,this.interval)}};MO.FMonitorConsole_wait=function(b){};MO.FMonitorConsole_release=function(){this.hWindow&&this.intervalId&&this.hWindow.clearInterval(this.intervalId)};
MO.FMouseConsole=function(b){b=MO.Class.inherits(this,b,MO.FConsole);b._scopeCd=MO.EScope.Local;b._activeCapture=null;b.onMouseDown=MO.FMouseConsole_onMouseDown;b.onMouseMove=MO.FMouseConsole_onMouseMove;b.onMouseUp=MO.FMouseConsole_onMouseUp;b.construct=MO.FMouseConsole_construct;b.captureStart=MO.FMouseConsole_captureStart;b.capture=MO.FMouseConsole_capture;b.captureStop=MO.FMouseConsole_captureStop;b.register=MO.FMouseConsole_register;b.unregister=MO.FMouseConsole_unregister;b.clear=MO.FMouseConsole_clear;
return b};MO.FMouseConsole_onMouseDown=function(b){var d=MO.RHtml.searchLinker(b.hSource,MO.MMouseCapture);d&&d.testMouseCapture()&&(this._activeCapture=d,this.captureStart(b))};MO.FMouseConsole_onMouseMove=function(b){this._activeCapture&&this.capture(b)};MO.FMouseConsole_onMouseUp=function(b){this._activeCapture&&this.captureStop(b)};
MO.FMouseConsole_construct=function(){this.__base.FConsole.construct.call(this);MO.RWindow.lsnsMouseDown.register(this,this.onMouseDown);MO.RWindow.lsnsMouseMove.register(this,this.onMouseMove);MO.RWindow.lsnsMouseUp.register(this,this.onMouseUp)};MO.FMouseConsole_captureStart=function(b){var d=this._activeCapture;d&&(MO.RWindow.setOptionSelect(!1),d.onMouseCaptureStart(b))};MO.FMouseConsole_capture=function(b){var d=this._activeCapture;if(d)if(d.testMouseCapture())d.onMouseCapture(b);else this.captureStop(b)};
MO.FMouseConsole_captureStop=function(b){var d=this._activeCapture;d&&(d.onMouseCaptureStop(b),this._activeCapture=null);MO.RWindow.setOptionSelect(!0)};MO.FMouseConsole_register=function(b){};MO.FMouseConsole_unregister=function(b){};MO.FMouseConsole_clear=function(){};MO.FPipeline=function(b){b=MO.Class.inherits(this,b,MO.FObject);b._code=MO.Class.register(b,new MO.AGetter("_code"));return b};
MO.FProcess=function(b){b=MO.Class.inherits(this,b,MO.FObject);b._name=MO.Class.register(b,new MO.AGetter("_name"));b._source=null;b._worker=null;b._events=null;b.ohMessage=MO.FProcess_ohMessage;b.onMessage=MO.FProcess_onMessage;b.construct=MO.FProcess_construct;b.name=MO.FProcess_name;b.start=MO.FProcess_start;b.process=MO.FProcess_process;return b};MO.FProcess_ohMessage=function(){this.__linker.onMessage(this)};MO.FProcess_onMessage=function(b){};
MO.FProcess_construct=function(){this.__base.FObject.construct.call(this);this._events=new MO.TObjects};MO.FProcess_start=function(b){if(this._worker)throw new MO.TError(this,"Process is already start.");this._source=b;b=this._worker=new Worker(b);b.__linker=this;b.onmessage=this.ohMessage};MO.FProcess_process=function(b){var d=this._events,f=d.count();d.push(b);d=new MO.SProcessEvent;d.index=f;d.code=b.code();d.data=b.data();this._worker.postMessage(d)};
MO.FProcessConsole=function(b){b=RClass.inherits(this,b,FConsole);b._scopeCd=MO.EScope.Local;b._connections=null;b.onLoad=MO.FProcessConsole_onLoad;b.construct=MO.FProcessConsole_construct;b.alloc=MO.FProcessConsole_alloc;b.process=MO.FProcessConsole_process;b.send=MO.FProcessConsole_send;return b};MO.FProcessConsole_construct=function(){this._connections=new MO.TObjects};
MO.FProcessConsole_onLoad=function(){var b=this.event;b.document=this.document;b.process();this.document=this.event=null;this._statusFree=!0};MO.FProcessConsole_alloc=function(){for(var b=null,d=this._connections,f=d.count-1;0<=f;f--){var h=d.get(f);if(h._statusFree){b=h;break}}b||(b=MO.Class.create(MO.FXmlConnection),d.push(b),b.onLoad=this.onLoad);b._statusFree=!1;return b};
MO.FProcessConsole_process=function(b){var d=this.alloc();d.event=b;switch(b.code){case MO.EXmlEvent.Send:d.send(b.url,b.document);break;case MO.EXmlEvent.Receive:d.receive(b.url,b.document);break;case MO.EXmlEvent.SyncSend:return d.syncSend(b.url,b.document);case MO.EXmlEvent.SyncReceive:return d.syncReceive(b.url,b.document)}};MO.FProcessConsole_send=function(b,d){var f=this.alloc(),h=f.syncSend(b,d);f._statusFree=!0;return h};
MO.FProcessEvent=function(b){b=MO.Class.inherits(this,b,MO.FObject);b._code=MO.Class.register(b,new MO.AGetSet("_code"));b._data=MO.Class.register(b,new MO.AGetSet("_data"));b._listeners=null;b.register=MO.FProcessEvent_register;return b};MO.FProcessEvent_register=function(b,d){this._listeners||(this._listeners=new MO.TListeners);this._listeners.register(b,d)};
MO.FProcessor=function(b){b=MO.Class.inherits(this,b,MO.FObject);b._name=MO.Class.register(b,new MO.AGetter("_name"));b._source=null;b._worker=null;b._events=null;b.ohMessage=MO.FProcessor_ohMessage;b.onMessage=MO.FProcessor_onMessage;b.construct=MO.FProcessor_construct;b.start=MO.FProcessor_start;b.process=MO.FProcessor_process;return b};MO.FProcessor_ohMessage=function(){this.__linker.onMessage(this)};MO.FProcessor_onMessage=function(b){};
MO.FProcessor_construct=function(){this.__base.FObject.construct.call(this);this._events=new MO.TObjects};MO.FProcessor_start=function(b){if(this._worker)throw new MO.TError(this,"Process is already start.");this._source=b;b=this._worker=new Worker(b);b.__linker=this;b.onmessage=this.ohMessage};MO.FProcessor_process=function(b){var d=this._events,f=d.count();d.push(b);d=new MO.SProcessEvent;d.index=f;d.code=b.code();d.data=b.data();this._worker.postMessage(d)};
MO.FProcessServer=function(b){b=MO.Class.inherits(this,b,MO.FObject);b._name=MO.Class.register(b,new MO.AGetSet("_name"));b._handle=null;b._processors=null;b.ohInterval=MO.FProcessServer_ohInterval;b.onInterval=MO.FProcessServer_onInterval;b.ohMessage=MO.FProcessServer_ohMessage;b.onMessage=MO.FProcessServer_onMessage;b.construct=MO.FProcessServer_construct;b.registerProcessor=MO.FProcessServer_registerProcessor;b.unregisterProcessor=MO.FProcessServer_unregisterProcessor;b.send=MO.FProcessServer_send;
b.process=MO.FProcessServer_process;return b};MO.FProcessServer_ohInterval=function(){MO.FProcessServer.__linker.onInterval()};MO.FProcessServer_onInterval=function(){};MO.FProcessServer_ohMessage=function(b){MO.FProcessServer.__linker.onMessage(b.data)};MO.FProcessServer_onMessage=function(b){console.log("messgae",this,b)};MO.FProcessServer_construct=function(){this.__base.FObject.construct.call(this);this._processors=new MO.TDictionary};
MO.FProcessServer_registerProcessor=function(b,d){this._processors.set(b,d)};MO.FProcessServer_unregisterProcessor=function(b){this._processors.set(b,null)};MO.FProcessServer_send=function(b){postMessage(b)};MO.FProcessServer_process=function(){onmessage=this.ohMessage;FProcessServer.__linker=this};
MO.FServiceConsole=function(b){b=MO.Class.inherits(this,b,MO.FConsole);b._scopeCd=MO.EScope.Global;b.construct=MO.FServiceConsole_construct;b.send=MO.FServiceConsole_send;b.dispose=MO.FServiceConsole_dispose;return b};MO.FServiceConsole_onLoad=function(b){this._pool.free(b)};MO.FServiceConsole_construct=function(){this.__base.FConsole.construct.call(this)};
MO.FServiceConsole_send=function(b,d,f){b=MO.Window.Browser.hostPath("/"+b+".ws?action="+d);return MO.Console.find(MO.FXmlConsole).sendAsync(b,f)};MO.FServiceConsole_dispose=function(){this.__base.FConsole.dispose.call(this)};MO.FStatistics=function(b){b=MO.Class.inherits(this,b,MO.FObject);b._code=null;b.reset=MO.FStatistics_reset;b.resetFrame=MO.FStatistics_resetFrame;return b};MO.FStatistics_reset=function(){};MO.FStatistics_resetFrame=function(){};
MO.FStatisticsConsole=function(b){b=MO.Class.inherits(this,b,MO.FConsole);b._scopeCd=MO.EScope.Local;b._statisticses=MO.Class.register(b,new MO.AGetter("_statisticses"));b.construct=MO.FStatisticsConsole_construct;b.register=MO.FStatisticsConsole_register;b.unregister=MO.FStatisticsConsole_unregister;b.find=MO.FStatisticsConsole_find;b.reset=MO.FStatisticsConsole_reset;b.resetFrame=MO.FStatisticsConsole_resetFrame;return b};MO.FStatisticsConsole_construct=function(){this._statisticses=new MO.TDictionary};
MO.FStatisticsConsole_register=function(b,d){this._statisticses.set(b,d)};MO.FStatisticsConsole_unregister=function(b){return this._statisticses.remove(b)};MO.FStatisticsConsole_find=function(b){return this._statisticses.get(b)};MO.FStatisticsConsole_reset=function(b){b=this._statisticses;for(var d=b.count()-1;0<=d;d--)b.at(d).reset()};MO.FStatisticsConsole_resetFrame=function(b,d){for(var f=this._statisticses,h=f.count()-1;0<=h;h--)f.at(h).resetFrame()};
MO.FThread=function(b){b=MO.Class.inherits(this,b,MO.FObject,MO.MListenerProcess);b._name=MO.Class.register(b,new MO.AGetter("_name"));b._statusCd=MO.Class.register(b,new MO.AGetter("_statusCd"),MO.EThreadStatus.Sleep);b._interval=MO.Class.register(b,new MO.AGetSet("_interval"),100);b._delay=0;b.construct=MO.FThread_construct;b.start=MO.FThread_start;b.stop=MO.FThread_stop;b.process=MO.FThread_process;return b};MO.FThread_construct=function(){this.__base.FObject.construct.call(this)};
MO.FThread_start=function(){this._statusCd=MO.EThreadStatus.Active};MO.FThread_stop=function(){this._statusCd=MO.EThreadStatus.Finish};MO.FThread_process=function(b){0>=this._delay?(this.processProcessListener(this),this._delay=this._interval):this._delay-=b};
MO.FThreadConsole=function(b){b=MO.Class.inherits(this,b,MO.FConsole);b._scopeCd=MO.EScope.Local;b._active=!0;b._interval=5;b._threads=MO.Class.register(b,new MO.AGetter("_threads"));b._hWindow=null;b._requestFlag=!1;b._hIntervalId=null;b._intervalHandle=MO.FThreadConsole_onInterval;b.onInterval=MO.FThreadConsole_onInterval;b.construct=MO.FThreadConsole_construct;b.push=MO.FThreadConsole_push;b.start=MO.FThreadConsole_start;b.process=MO.FThreadConsole_process;b.processAll=MO.FThreadConsole_processAll;
b.dispose=MO.FThreadConsole_dispose;return b};MO.FThreadConsole_onInterval=function(){this.processAll();this._requestFlag&&MO.Window.requestAnimationFrame(this._intervalHandle)};MO.FThreadConsole_push=function(b){this._threads.push(b)};MO.FThreadConsole_start=function(b){b.start();this._threads.push(b)};
MO.FThreadConsole_construct=function(){this.__base.FConsole.construct.call(this);this._threads=new MO.TObjects;this._hWindow=window;var b=this._intervalHandle=this.onInterval.bind(this);this._hIntervalId=this._hWindow.setInterval(b,this._interval)};MO.FThreadConsole_process=function(b){if(b)switch(b.statusCd()){case MO.EThreadStatus.Active:b.process(this._interval);break;case MO.EThreadStatus.Finish:this._threads.remove(b),b.dispose()}};
MO.FThreadConsole_processAll=function(){if(this._active)for(var b=this._threads,d=b.count(),f=0;f<d;f++){var h=b.at(f);this.process(h)}};MO.FThreadConsole_dispose=function(){if(this._requestFlag)MO.Window.cancelRequestAnimationFrame(this._intervalHandle);else{var b=this._hWindow;if(b){var d=this._hIntervalId;d&&(b.clearInterval(d),this._hIntervalId=null);this._hWindow=null}}this._threads=MO.Lang.Object.dispose(this._threads);this.__base.FConsole.dispose.call(this)};
MO.FTimeConsole=function(b){b=MO.Class.inherits(this,b,MO.FConsole);b._scopeCd=MO.EScope.Global;b._date=null;b.construct=MO.FTimeConsole_construct;b.dispose=MO.FTimeConsole_dispose;return b};MO.FTimeConsole_construct=function(){this.__base.FConsole.construct.call(this)};MO.FTimeConsole_dispose=function(){this.__base.FConsole.dispose.call(this)};
MO.FXmlConsole=function(b){b=MO.Class.inherits(this,b,MO.FConsole);b._scopeCd=MO.EScope.Local;b._connections=null;b._caches=null;b.onLoad=MO.FXmlConsole_onLoad;b.construct=MO.FXmlConsole_construct;b.alloc=MO.FXmlConsole_alloc;b.send=MO.FXmlConsole_send;b.sendAsync=MO.FXmlConsole_sendAsync;b.load=MO.FXmlConsole_load;b.process=MO.FXmlConsole_process;return b};MO.FXmlConsole_construct=function(){this._connections=new MO.TObjects;this._caches=new MO.TDictionary};MO.FXmlConsole_onLoad=function(b){debugger};
MO.FXmlConsole_alloc=function(){for(var b=null,d=this._connections,f=d.count-1;0<=f;f--){var h=d.get(f);if(h._statusFree){b=h;break}}b||(b=MO.Class.create(MO.FXmlConnection),d.push(b),b.onLoad=this.onLoad);b._statusFree=!1;b.clearLoadListeners();return b};MO.FXmlConsole_send=function(b,d){var f=this.alloc();f._asynchronous=!1;var h=f.send(b,d);f._statusFree=!0;return h};MO.FXmlConsole_sendAsync=function(b,d,f){var h=this.alloc();h._asynchronous=!0;h._parameters=f;h.send(b,d);return h};
MO.FXmlConsole_load=function(b,d,f){var h=this._caches.get(b);if(h)return h;var q=this.alloc();q._asynchronous=!0;q._parameters=f;h=q._cache=MO.Class.create(FXmlData);q.send(b,d);this._caches.set(b,h);return h};MO.FXmlConsole_process=function(b){if(b.constructor!=MO.SXmlEvent)throw new MO.TError("Parameter type is invalid.");var d=this.alloc();d._asynchronous=!0;d.send(b.url,b.inputDocument);d.addLoadListener(b,b.process);return d};
MO.EBrowser=new function(){this.Unknown="unknown";this.Explorer="explorer";this.FireFox="firefox";this.Chrome="chrome";this.Safari="safari";return this};MO.EDevice=new function(){this.Unknown="unknown";this.Pc="pc";this.Mobile="mobile";return this};MO.ESoftware=new function(){this.Unknown="unknown";this.Window="window";this.Linux="linux";this.Android="android";this.Apple="apple";return this};
MO.RWindow=function(){this._optionSelect=!0;this._statusError=!1;this._statusEnable=!0;this._disableDeep=0;this._hContainer=this._hDocument=this._hWindow=this._sessionStorage=this._localStorage=null;this._eventMouse=new MO.SMouseEvent;this._eventKey=new MO.SKeyboardEvent;this._eventResize=new MO.SResizeEvent;this._eventVisibility=new MO.SEvent;this._eventOrientation=new MO.SEvent;this._eventUnload=new MO.SEvent;this._hDisableImage=this._hDisablePanel=this._hContainer=this._hDocument=this._hWindow=
null;this.lsnsLoad=new MO.TListeners;this.lsnsLoaded=new MO.TListeners;this.lsnsUnload=new MO.TListeners;this.lsnsMouseDown=new MO.TListeners;this.lsnsMouseUp=new MO.TListeners;this.lsnsMouseOver=new MO.TListeners;this.lsnsMouseMove=new MO.TListeners;this.lsnsMouseWheel=new MO.TListeners;this.lsnsKeyDown=new MO.TListeners;this.lsnsKeyUp=new MO.TListeners;this.lsnsKeyPress=new MO.TListeners;this.lsnsResize=new MO.TListeners;this.lsnsVisibility=new MO.TListeners;this.lsnsOrientation=new MO.TListeners;
this.lsnsDeviceError=new MO.TListeners;return this};MO.RWindow.prototype.ohMouseDown=function(b){var d=MO.Window;b||(b=d._hWindow.event);var f=d._eventMouse;f.code=MO.EEvent.MouseDown;f.attachEvent(b);d.lsnsMouseDown.process(f)};MO.RWindow.prototype.ohMouseMove=function(b){var d=MO.Window;b||(b=d._hWindow.event);var f=d._eventMouse;f.code=MO.EEvent.MouseMove;f.attachEvent(b);d.lsnsMouseMove.process(f)};
MO.RWindow.prototype.ohMouseUp=function(b){var d=MO.Window;b||(b=d._hWindow.event);var f=d._eventMouse;f.code=MO.EEvent.MouseUp;f.attachEvent(b);d.lsnsMouseUp.process(f)};MO.RWindow.prototype.ohMouseWheel=function(b){var d=MO.Window;b||(b=d._hWindow.event);var f=d._eventMouse;f.code=MO.EEvent.MouseWheel;f.attachEvent(b);d.lsnsMouseWheel.process(f)};MO.RWindow.prototype.ohKeyDown=function(b){var d=MO.Window;b||(b=d._hWindow.event);var f=d._eventKey;f.code=MO.EEvent.KeyDown;f.attachEvent(b);d.lsnsKeyDown.process(f)};
MO.RWindow.prototype.ohKeyUp=function(b){var d=MO.Window;b||(b=d._hWindow.event);var f=d._eventKey;f.code=MO.EEvent.KeyUp;f.attachEvent(b);d.lsnsKeyUp.process(f)};MO.RWindow.prototype.ohKeyPress=function(b){var d=MO.Window;b||(b=d._hWindow.event);var f=d._eventKey;f.code=MO.EEvent.KeyPress;f.attachEvent(b);d.lsnsKeyPress.process(f)};MO.RWindow.prototype.ohResize=function(b){var d=MO.Window;b||(b=d._hWindow.event);var f=d._eventResize;f.code=MO.EEvent.Resize;f.attachEvent(b);d.lsnsResize.process(f)};
MO.RWindow.prototype.ohSelect=function(b){return MO.Window._optionSelect};MO.RWindow.prototype.ohVisibility=function(b){b=MO.Window;var d=MO.Window.Browser.isVisibility(),f=b._eventVisibility;f.visibility=d;b.lsnsVisibility.process(f)};MO.RWindow.prototype.ohOrientation=function(b){b=MO.Window;var d=b.Browser.refreshOrientation(),f=b._eventOrientation;f.orientationCd=d;b.lsnsOrientation.process(f)};
MO.RWindow.prototype.ohUnload=function(b){var d=MO.Window;b=d._eventUnload;d.lsnsUnload.process(b);d.dispose()};
MO.RWindow.prototype.connect=function(b){this._eventVisibility.code=MO.EEvent.Visibility;this._eventOrientation.code=MO.EEvent.Orientation;b=this._hWindow=b;var d=this._hDocument=b.document,f=this._hContainer=d.body,h=MO.Window.Browser.defineEventGet("visibilitychange");MO.Window.Browser.supportHtml5()?(f.addEventListener("mousedown",this.ohMouseDown,!0),f.addEventListener("mousemove",this.ohMouseMove,!0),f.addEventListener("mouseup",this.ohMouseUp,!0),f.addEventListener("mousewheel",this.ohMouseWheel,
!0),f.addEventListener("keydown",this.ohKeyDown,!0),f.addEventListener("keyup",this.ohKeyUp,!0),f.addEventListener("keypress",this.ohKeyPress,!0),d.addEventListener(h,this.ohVisibility,!0)):(f.onmousedown=this.ohMouseDown,f.onmousemove=this.ohMouseMove,f.onmouseup=this.ohMouseUp,f.onmousewheel=this.ohMouseWheel,f.onkeydown=this.ohKeyDown,f.onkeyup=this.ohKeyUp,f.onkeypress=this.ohKeyPress,d["on"+h]=this.ohVisibility);b.onorientationchange=this.ohOrientation;f.onresize=this.ohResize;f.onselectstart=
this.ohSelect;f.onunload=this.ohUnload;this._requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame;this._cancelAnimationFrame=window.cancelRequestAnimationFrame||window.webkitCancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.mozCancelAnimationFrame||window.mozCancelRequestAnimationFrame||window.msCancelAnimationFrame||window.msCancelRequestAnimationFrame};
MO.RWindow.prototype.optionSelect=function(){return this._optionSelect};MO.RWindow.prototype.setOptionSelect=function(b){this._optionSelect=b;MO.Window.Browser.isBrowser(MO.EBrowser.FireFox)&&(this._hContainer.style.MozUserSelect=b?"":"none")};MO.RWindow.prototype.statusError=function(){return this._statusError};MO.RWindow.prototype.setStatusError=function(b){this._statusError=b};MO.RWindow.prototype.processDeviceError=function(b){this._statusError=!0;this.lsnsDeviceError.process(b)};
MO.RWindow.prototype.setCaption=function(b){top.document.title=MO.Lang.String.nvl(b)};MO.RWindow.prototype.setStatus=function(b){window.status=MO.Lang.String.nvl(b)};
MO.RWindow.prototype.storage=function(b){switch(b){case MO.EScope.Local:return b=this._localStorage,b||(b=this._localStorage=MO.Class.create(MO.FWindowStorage),b.link(window.localStorage)),b;case MO.EScope.Session:return b=this._sessionStorage,b||(b=this._sessionStorage=MO.Class.create(MO.FWindowStorage),b.link(window.sessionStorage)),b}throw new TError(this,"Unknown scope. (scope_cd={1})",b);};
MO.RWindow.prototype.makeDisablePanel=function(b){var d=this._hDisablePanel;d||(d=this._hDisablePanel=MO.RBuilder.createDiv(this._hDocument,"RWindow_Disable"),d.style.zIndex=5E3);var f=this._hDisableImage;f||(f=this._hDisableImage=MO.RBuilder.appendIcon(d),f.src=MO.RResource.iconPath("control.RWindow_Loading"),f.style.margin=this._hContainer.offsetHeight/2,f.style.display="none");MO.RHtml.visibleSet(f,b);return d};MO.RWindow.prototype.windowDisable=function(){this._hContainer.disabled=!0};
MO.RWindow.prototype.windowEnable=function(){this._hContainer.disabled=!1};MO.RWindow.prototype.isEnable=function(){return this._statusEnable};MO.RWindow.prototype.enable=function(){this._disableDeep--;0==this._disableDeep&&this.setEnable(!0)};MO.RWindow.prototype.disable=function(){0==this._disableDeep&&this.setEnable(!1);this._disableDeep++};
MO.RWindow.prototype.setEnable=function(b,d){var f=this.makeDisablePanel(d);if(b)this.windowEnable(),f._linked&&(this._hContainer.removeChild(f),f._linked=!1);else{var h=this._hDocument,q=this._hDisablePanel.style;q.left="0px";q.top="0px";q.width=(h.all?this._hContainer.scrollWidth:h.documentElement.scrollWidth)+"px";q.height=(h.all?this._hContainer.scrollHeight:h.documentElement.scrollHeight)+"px";f._linked||(this._hContainer.appendChild(f),f._linked=!0)}this._statusEnable=b};
MO.RWindow.prototype.appendElement=function(b){this._hContainer.appendChild(b)};MO.RWindow.prototype.requestAnimationFrame=function(b){var d=this._requestAnimationFrame;return d?(d(b),!0):!1};MO.RWindow.prototype.cancelRequestAnimationFrame=function(b){var d=this._cancelAnimationFrame;return d?(d(b),!0):!1};MO.RWindow.prototype.redirect=function(){};MO.RWindow.prototype.historyForward=function(){};MO.RWindow.prototype.historyBack=function(){};
MO.RWindow.prototype.dispose=function(){var b=this._hWindow,d=this._hContainer;MO.Window.Browser.supportHtml5()?(d.removeEventListener("mousedown",this.onMouseDown,!0),d.removeEventListener("mousemove",this.onMouseMove,!0),d.removeEventListener("mouseup",this.onMouseUp,!0),d.removeEventListener("mousewheel",this.onMouseWheel,!0),d.removeEventListener("keydown",this.onKeyDown,!0),d.removeEventListener("keyup",this.onKeyUp,!0),d.removeEventListener("keypress",this.onKeyPress,!0),b.removeEventListener("orientationchange",
this.onOrientation)):(d.onmousedown=null,d.onmousemove=null,d.onmouseup=null,d.onmousewheel=null,d.onkeydown=null,d.onkeyup=null,d.onkeypress=null,b.onorientationchange=null);d.onresize=null;d.onselectstart=null;d.onunload=null;this._localStorage=MO.Lang.Object.dispose(this._localStorage);this._sessionStorage=MO.Lang.Object.dispose(this._sessionStorage);this._hContainer=this._hDocument=this._hWindow=null;this._eventMouse=MO.Lang.Object.dispose(this._eventMouse);this._eventKey=MO.Lang.Object.dispose(this._eventKey);
this._eventResize=MO.Lang.Object.dispose(this._eventResize);this._eventOrientation=MO.Lang.Object.dispose(this._eventOrientation);this._eventUnload=MO.Lang.Object.dispose(this._eventUnload)};MO.RWindow=new MO.RWindow;MO.Window=MO.RWindow;MO.SBrowserCapability=function(){this.canvasAutoScale=this.optionStorage=this.optionProcess=!1;this.soundFinish=!0;this.blobCreate=!1;this.pixelRatio=1;return this};MO.STouchEvent=function(){this.dispose=MO.STouchEvent_dispose;return this};
MO.STouchEvent_dispose=function(){};MO.TDumpItem=function(){this.link=this.hRow=this.hText=this.hTable=this.hDocument=this.hPanel=this.hParent=null;this.level=0;this.caption=null;this.children=[];this.items=[];this.display=this.innerDisplay=this.loaded=!1;this.create=MO.TDumpItem_create;this.push=MO.TDumpItem_push;this.innerShow=MO.TDumpItem_innerShow;this.show=MO.TDumpItem_show;return this};MO.TDumpItem_create=function(){return this.children[this.children.length]=new MO.TDumpItem};
MO.TDumpItem_push=function(b){this.items[this.items.length]=b};MO.TDumpItem_innerShow=function(b){for(var d=this.items.length,f=0;f<d;f++)MO.RHtml.visibleSet(this.items[f],b);d=this.children.length;for(f=0;f<d;f++){var h=this.children[f];MO.RHtml.visibleSet(h.hRow,b);b?h.show(h.innerDisplay):(h.innerDisplay=h.display,h.show(!1))}};MO.TDumpItem_show=function(b){this.display=b;var d=MO.Lang.String.repeat("   ",this.level-1)+(b?" -":" +")+" "+this.caption;this.hText.innerHTML=MO.RHtml.toHtml(d);this.innerShow(b)};
MO.FImage=function(b){b=MO.Class.inherits(this,b,MO.FObject,MO.MListenerLoad);b._optionAlpha=MO.Class.register(b,new MO.AGetter("_optionAlpha"),!0);b._ready=!1;b._size=MO.Class.register(b,new MO.AGetter("_size"));b._url=MO.Class.register(b,new MO.AGetter("_url"));b._hImage=null;b.ohLoad=MO.FImage_ohLoad;b.ohError=MO.FImage_ohError;b.construct=MO.FImage_construct;b.image=MO.FImage_image;b.testReady=MO.FImage_testReady;b.loadUrl=MO.FImage_loadUrl;b.dispose=MO.FImage_dispose;return b};
MO.FImage_ohLoad=function(){var b=this.__linker,d=b._hImage;b._size.set(d.naturalWidth,d.naturalHeight);b._ready=!0;d=new MO.SEvent(b);b.processLoadListener(d);d.dispose()};MO.FImage_ohError=function(b){b=this.__linker;MO.Logger.error(b,"Load image failure. (url={1})",b._url)};MO.FImage_construct=function(){this.__base.FObject.construct.call(this);this._size=new MO.SSize2};MO.FImage_image=function(){return this._hImage};MO.FImage_testReady=function(){return this._ready};
MO.FImage_loadUrl=function(b){b=MO.Console.find(MO.FEnvironmentConsole).parse(b);var d=this._hImage;d||(d=this._hImage=new Image,d.__linker=this,d.onload=this.ohLoad,d.onerror=this.ohError);this._url=b;d.src=b};MO.FImage_dispose=function(){this._size=MO.Lang.Object.dispose(this._size);this._hImage=MO.RHtml.free(this._hImage);this.__base.MListenerLoad.dispose.call(this);this.__base.FObject.dispose.call(this)};
MO.FTouchTracker=function(b){b=MO.Class.inherits(this,b,MO.FObject,MO.MListenerTouchZoom);b._touchsLength=null;b._touchs=null;b._touchPool=null;b._touchZoomEvent=null;b.construct=MO.FTouchTracker_construct;b.calculateLength=MO.FTouchTracker_calculateLength;b.eventStart=MO.FTouchTracker_eventStart;b.eventMove=MO.FTouchTracker_eventMove;b.eventStop=MO.FTouchTracker_eventStop;b.dispose=MO.FTouchTracker_dispose;return b};
MO.FTouchTracker_construct=function(){this.__base.FObject.construct.call(this);this._touchs=new MO.TObjects;this._touchPool=MO.Class.create(MO.FObjectPool);this._touchZoomEvent=new MO.SEvent(this)};MO.FTouchTracker_calculateLength=function(b){var d=0;b=b.touches;var f=b.length;if(0<f)for(var h=0;h<f;h++)var q=b[h],w=h==f-1?b[0]:b[h+1],z=q.clientX-w.clientX,q=q.clientY-w.clientY,z=Math.sqrt(z*z+q*q),d=d+z;return d};
MO.FTouchTracker_eventStart=function(b){var d=this._touchs;d.clear();for(var f=b.touches,h=f.length,q=0;q<h;q++){var w=f[q],z=new STouchEvent;z.clientX=w.clientX;z.clientY=w.clientY;d.push(z)}this._touchsLength=this.calculateLength(b)};
MO.FTouchTracker_eventMove=function(b){for(var d=this._touchs,f=b.touches,h=f.length,q=0;q<h;q++){var w=f[q],z=d.at(q);z.clientX=w.clientX;z.clientY=w.clientY}b=this.calculateLength(b);this._touchsLength!=b&&(d=this._touchZoomEvent,d.touchsLength=b,d.delta=b-this._touchsLength,this.processTouchZoomListener(d),this._touchsLength=b)};MO.FTouchTracker_eventStop=function(b){};
MO.FTouchTracker_dispose=function(){this._touchs=MO.Lang.Object.dispose(this._touchs);this._touchZoomEvent=MO.Lang.Object.dispose(this._touchZoomEvent);this.__base.MListenerTouchZoom.dispose.call(this);this.__base.FObject.dispose.call(this)};
MO.FWindowStorage=function(b){b=MO.Class.inherits(this,b,MO.FObject);b._scopeCd=MO.Class.register(b,new MO.AGetter("_scopeCd"));b._storage=null;b.link=MO.FWindowStorage_link;b.get=MO.FWindowStorage_get;b.set=MO.FWindowStorage_set;b.remove=MO.FWindowStorage_remove;b.clear=MO.FWindowStorage_clear;b.dispose=MO.FWindowStorage_dispose;b.innerDump=MO.FWindowStorage_innerDump;return b};MO.FWindowStorage_link=function(b){this._storage=b};MO.FWindowStorage_get=function(b){return this._storage.getItem(b)};
MO.FWindowStorage_set=function(b,d){this._storage.setItem(b,d)};MO.FWindowStorage_remove=function(b){this._storage.removeItem(b)};MO.FWindowStorage_clear=function(){this._storage.clear()};MO.FWindowStorage_dispose=function(){this._storage=null;this.__base.FObject.dispose.call(this)};MO.FWindowStorage_innerDump=function(b,d){for(var f=this._storage,h=f.length,q=0;q<h;q++){var w=f.key(q),z=f.getItem(w);0<q&&b.append(";");b.append(w+"="+z)}};
MO.RBrowser=function(){this._defineMethods=this._defineEvents=this._defineProperties=this._capability=this._agent=null;this._deviceCd=MO.EDevice.Unknown;this._softwareCd=MO.ESoftware.Unknown;this._typeCd=MO.EBrowser.Unknown;this._orientationCd=MO.EOrientation.Horizontal;this._supportHtml5=!1;this._contentPath=this._hostPath="";return this};MO.RBrowser.prototype.onLog=function(b,d){console.log(d)};
MO.RBrowser.prototype.construct=function(){var b=(this._agent=window.navigator.userAgent.toString()).toLowerCase(),d=this._capability=new MO.SBrowserCapability,f=this._defineProperties={},h=this._defineEvents={};this._defineMethods={};-1!=b.indexOf("android")&&(this._typeCd=MO.EDevice.Mobile,this._softwareCd=MO.ESoftware.Android);if(-1!=b.indexOf("chrome"))this._typeCd=MO.EBrowser.Chrome;else if(-1!=b.indexOf("firefox"))this._typeCd=MO.EBrowser.FireFox;else if(-1!=b.indexOf("msie")||-1!=b.indexOf("windows"))this._typeCd=
MO.EBrowser.Explorer;else if(-1!=b.indexOf("safari")||-1!=b.indexOf("applewebkit"))this._typeCd=MO.EBrowser.Safari,d.canvasAutoScale=!0;else{alert("Unknown browser.\n"+b);return}this._typeCd==MO.EBrowser.Chrome&&MO.Logger.lsnsOutput.register(this,this.onLog);MO.Logger.info(this,"Parse browser agent. (type_cd={1})",MO.Lang.Enum.decode(MO.EBrowser,this._typeCd));window.applicationCache&&(this._supportHtml5=!0);var q="ipad"==b.match(/ipad/i),w="iphone os"==b.match(/iphone os/i),z="midp"==b.match(/midp/i),
A="rv:1.2.3.4"==b.match(/rv:1.2.3.4/i),B="ucweb"==b.match(/ucweb/i),C="android"==b.match(/android/i),D="windows ce"==b.match(/windows ce/i),E="windows mobile"==b.match(/windows mobile/i);(q||w||z||A||B||C||D||E)&&MO.Runtime.setPlatformCd(MO.EPlatform.Mobile);(q=window.external)&&q.twGetRunPath&&(-1!=b.indexOf("360chrome")||-1!=b.indexOf("360se")?d.soundFinish=!1:-1!=q.twGetRunPath().toLowerCase().indexOf("360se")&&(d.soundFinish=!1));(b=window.devicePixelRatio)&&MO.Runtime.isPlatformMobile()&&(d.pixelRatio=
Math.min(b,3));window.Worker&&(d.optionProcess=!0);window.localStorage&&(d.optionStorage=!0);try{new Blob(["Test"],{type:"text/plain"}),d.blobCreate=!0}catch(F){MO.Logger.warn(this,"Browser blob not support.")}d=window.document;"undefined"!==typeof d.hidden?(f.hidden="hidden",h.visibilitychange="visibilitychange"):"undefined"!==typeof d.mozHidden?(f.hidden="mozHidden",h.visibilitychange="mozvisibilitychange"):"undefined"!==typeof d.msHidden?(f.hidden="msHidden",h.visibilitychange="msvisibilitychange"):
"undefined"!==typeof d.webkitHidden&&(f.hidden="webkitHidden",h.visibilitychange="webkitvisibilitychange");this.refreshOrientation()};MO.RBrowser.prototype.agent=function(){return this._agent};MO.RBrowser.prototype.capability=function(){return this._capability};MO.RBrowser.prototype.defineProperties=function(){return this._defineProperties};MO.RBrowser.prototype.definePropertyGet=function(b){return this._defineProperties[b]};MO.RBrowser.prototype.defineEvents=function(){return this._defineEvents};
MO.RBrowser.prototype.defineEventGet=function(b){return this._defineEvents[b]};MO.RBrowser.prototype.defineMethods=function(){return this._defineMethods};MO.RBrowser.prototype.defineMethodGet=function(b){return this._defineMethods[b]};MO.RBrowser.prototype.supportHtml5=function(){return this._supportHtml5};MO.RBrowser.prototype.hostPath=function(b){return b?this._hostPath+b:this._hostPath};MO.RBrowser.prototype.setHostPath=function(b){this._hostPath=b};
MO.RBrowser.prototype.contentPath=function(b){return b?this._contentPath+b:this._contentPath};MO.RBrowser.prototype.setContentPath=function(b){this._contentPath=b};MO.RBrowser.prototype.typeCd=function(){return this._typeCd};MO.RBrowser.prototype.isBrowser=function(b){return this._typeCd==b};MO.RBrowser.prototype.orientationCd=function(){return this._orientationCd};MO.RBrowser.prototype.setOrientationCd=function(b){this._orientationCd=b};
MO.RBrowser.prototype.isOrientationHorizontal=function(){return this._orientationCd==MO.EOrientation.Horizontal};MO.RBrowser.prototype.isOrientationVertical=function(){return this._orientationCd==MO.EOrientation.Vertical};
MO.RBrowser.prototype.refreshOrientation=function(){if(null!=window.orientation)if(180==window.orientation||0==window.orientation)this._orientationCd=MO.EOrientation.Vertical;else if(90==window.orientation||-90==window.orientation)this._orientationCd=MO.EOrientation.Horizontal;else throw new TError(this,"Unknown orientation mode.");return this._orientationCd};MO.RBrowser.prototype.isVisibility=function(){var b=this.definePropertyGet("hidden");return!window.document[b]};
MO.RBrowser.prototype.encode=function(b){return escape(b)};MO.RBrowser.prototype.decode=function(b){return unescape(b)};MO.RBrowser.prototype.urlEncode=function(b,d){return d?encodeURIComponent(b):encodeURI(b)};MO.RBrowser.prototype.urlDecode=function(b,d){return d?decodeURIComponent(b):decodeURI(b)};
MO.RBrowser.prototype.fullscreen=function(b,d){d?b.requestFullscreen?b.requestFullscreen():b.mozRequestFullScreen?b.mozRequestFullScreen():b.webkitRequestFullScreen?b.webkitRequestFullScreen():b.msRequestFullscreen&&b.msRequestFullscreen():b.exitFullscreen?b.exitFullscreen():b.mozCancelFullScreen?b.mozCancelFullScreen():b.webkitCancelFullScreen?b.webkitCancelFullScreen():b.msExitFullscreen&&b.msExitFullscreen()};
MO.RBrowser.prototype.downloadBlob=function(b,d){var f=document.createElement("A"),h=document.createEvent("MouseEvents");h.initEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null);f.download=b;f.href=URL.createObjectURL(d);f.dispatchEvent(h)};MO.RBrowser.prototype.downloadText=function(b,d){var f=MO.RBlob.fromText(d);this.downloadBlob(b,f)};MO.RBrowser.prototype.saveConfig=function(b){b.create("Agent").setValue(this._agent)};MO.RBrowser=new MO.RBrowser;MO.Window.Browser=MO.RBrowser;
MO.RBuilder=function(){return this};MO.RBuilder.prototype.create=function(b,d,f){var h=null,h=b.ownerDocument?b.ownerDocument:b.hDocument?b.hDocument:b;b=h.createElement(d);f&&(b.className=f);return b};MO.RBuilder.prototype.createIcon=function(b,d,f,h,q){b=this.create(b,"IMG",MO.Lang.String.nvl(d,"Tag_Icon"));b.align="absmiddle";f&&(b.src=MO.RResource.iconPath(f));h&&(b.style.width=h+"px");q&&(b.style.height=q+"px");return b};
MO.RBuilder.prototype.createImage=function(b,d,f,h,q){b=this.create(b,"IMG",f);f&&(b.src=MO.RResource.imagePath(f));h&&(b.style.width=h);q&&(b.style.height=q);return b};MO.RBuilder.prototype.createText=function(b,d,f){b=this.create(b,"SPAN",d);f&&(b.innerHTML=f);return b};MO.RBuilder.prototype.createButton=function(b,d){var f=this.create(b,"INPUT",d);f.type="button";return f};MO.RBuilder.prototype.createCheck=function(b,d){var f=this.create(b,"INPUT",d);f.type="checkbox";return f};
MO.RBuilder.prototype.createRadio=function(b,d){var f=this.create(b,"INPUT",d);f.type="radio";return f};MO.RBuilder.prototype.createEdit=function(b,d){var f=this.create(b,"INPUT",d);f.type="text";return f};MO.RBuilder.prototype.createFile=function(b,d){var f=this.create(b,"INPUT",d);f.type="file";return f};MO.RBuilder.prototype.createSpan=function(b,d){return this.create(b,"SPAN",d)};MO.RBuilder.prototype.createDiv=function(b,d){return this.create(b,"DIV",d)};
MO.RBuilder.prototype.createTable=function(b,d,f,h,q){b=this.create(b,"TABLE",d);f&&(b.border=MO.Lang.Integer.nvl(f));b.cellSpacing=MO.Lang.Integer.nvl(h);b.cellPadding=MO.Lang.Integer.nvl(q);return b};MO.RBuilder.prototype.createTableRow=function(b,d){return this.create(b,"TR",d)};MO.RBuilder.prototype.createTableCell=function(b,d){return this.create(b,"TD",d)};
MO.RBuilder.prototype.createFragment=function(b){var d=null,d=b.ownerDocument?b.ownerDocument:b.hDocument?b.hDocument:b;b=d.createDocumentFragment();b.__fragment=!0;return b};MO.RBuilder.prototype.append=function(b,d,f){d=this.create(b.ownerDocument,d,f);b?b.appendChild(d):this.hDocument.body.appendChild(d);return d};MO.RBuilder.prototype.appendIcon=function(b,d,f,h,q){d=this.createIcon(b.ownerDocument,d,f,h,q);b.appendChild(d);return d};
MO.RBuilder.prototype.appendImage=function(b,d,f,h,q){d=this.createImage(b.ownerDocument,d,f,h,q);b.appendChild(d);return d};MO.RBuilder.prototype.appendEmpty=function(b,d,f){d=this.createIcon(b.ownerDocument,null,"n",d,f);b.appendChild(d);return d};MO.RBuilder.prototype.appendText=function(b,d,f){d=this.createText(b.ownerDocument,d,f);b.appendChild(d);return d};MO.RBuilder.prototype.appendButton=function(b,d){var f=this.createButton(b.ownerDocument,d);b.appendChild(f);return f};
MO.RBuilder.prototype.appendCheck=function(b,d){var f=this.createCheck(b.ownerDocument,d);b.appendChild(f);return f};MO.RBuilder.prototype.appendRadio=function(b,d){var f=this.createRadio(b.ownerDocument,d);b.appendChild(f);return f};MO.RBuilder.prototype.appendEdit=function(b,d){var f=this.createEdit(b.ownerDocument,d);b.appendChild(f);return f};MO.RBuilder.prototype.appendFile=function(b,d){var f=this.createFile(b.ownerDocument,d);b.appendChild(f);return f};
MO.RBuilder.prototype.appendSpan=function(b,d){var f=this.createSpan(b.ownerDocument,d);b.appendChild(f);return f};MO.RBuilder.prototype.appendDiv=function(b,d){var f=this.createDiv(b.ownerDocument,d);b.appendChild(f);return f};MO.RBuilder.prototype.appendTable=function(b,d,f,h,q){d=this.createTable(b.ownerDocument,d,f,h,q);b?b.appendChild(d):this.hDocument.body.appendChild(d);return d};
MO.RBuilder.prototype.appendTableRow=function(b,d,f,h){var q=null,q=null==f?MO.RBrowser.isBrowser(MO.EBrowser.Explorer)?b.insertRow():b.insertRow(-1):b.insertRow(f);d&&(q.className=d);h&&(q.height=h);return q};MO.RBuilder.prototype.appendTableRowCell=function(b,d,f,h){b=this.appendTableRow(b,null,null,f);return this.appendTableCell(b,d,null,h)};
MO.RBuilder.prototype.appendTableCell=function(b,d,f,h){var q=null;null==f?(q=this.create(b,"TD",d),b.appendChild(q)):q=b.insertCell(f);d&&(q.className=d);h&&(q.width=h);return q};MO.RBuilder=new MO.RBuilder;MO.Window.Builder=MO.RBuilder;MO.RContext=function(){this._location=null;this._contexts={};this.languageId=this.themeId=this.contextTag=this.contextPath=null;return this};
MO.RContext.prototype.location=function(b){var d=this._location;if(null==d){var d=window.location,f=d.href,d=f.substring(0,f.indexOf(d.pathname));this.contextPath&&(d+=this.contextPath);this._location=d}b&&(d+=b);return d};MO.RContext.prototype.context=function(b){return null!=b?MO.Lang.String.endsWith(b,".wv")?this.contextPath+"/"+b:MO.Lang.String.startsWith(b,"#")?this.contextPath+this.contextTag+b.substr(1):this.contextPath+b:this.contextPath};
MO.RContext.prototype.initialize=function(b){for(var d in b){var f=b[d],h;for(h in f)this._contexts[d+":"+h]=new MO.TContext(d,h,f[h])}};MO.RContext.prototype.get=function(b,d,f,h,q,w){var z=this._contexts[b];return z?MO.Lang.String.format(z.text,d,f,h,q,w):MO.Logger.fatal(this,null,"Can not find context (path={1})",b)};MO.RContext.prototype.find=function(b,d){var f=b+":"+d,h=this._contexts[f];return h?h.text:MO.Logger.fatal(this,null,"Can not find context (id={1})",f)};MO.RContext=new MO.RContext;
MO.RDump=function(){this.LINE_SINGLE="------------------------------";this.LINE_DOUBLE="==============================";this.LINE_DOT="..............................";this.LINE_STAR="******************************";return this};MO.RDump.prototype.onclick=function(){var b=this.link;this.link&&(b.loaded?b.show(!b.display):(MO.RDump.dumpInner(this.link),b.loaded=!0,b.show(!0)))};
MO.RDump.prototype.nameInfo=function(b){switch(RClass.typeOf(b)){case "Unknown":return"@unknown";case "Function":return MO.Method.name(b)+"@Function";case "Array":return"@<Array>"}return b};
MO.RDump.prototype.typeInfo=function(b,d){if(null==b)return"null";switch(d){case "Unknown":return"unknown";case "Undefined":return"undefined";case "Boolean":case "Number":return b.toString();case "String":return b.length+":'"+MO.Lang.String.toLine(b)+"'";case "Function":return b.__virtual?"virtual":MO.Method.name(b,!0);case "Array":return"@<Array@"+MO.Class.code(b)+"> length="+b.length;case "Html":return"@<"+b.tagName+">";default:if(b.constructor==MO.TClass)return"@<"+b.name+"@"+MO.Class.code(b)+
">";if(b.constructor==Function)return"@"+b.toString();try{for(var f in b)return"@<Object@"+MO.Class.code(b)+">"}catch(h){}return"<Object@"+MO.Class.code(b)+">"}};
MO.RDump.prototype.dumpInner=function(b){var d=b.hTable,f=b.hRow,h=b.level,q=b.link,w=MO.Class.typeOf(q,!0),z=q.__class,A=[],B;for(B in q)A[A.length]=B;MO.Lang.String.endsWith(w,"Array")?MO.Lang.Array.reverse(A,0,A.length-1):MO.Lang.Array.sort(A,!0);var C=A.length;2E3<C&&(C=2E3);for(var D=0;D<C;D++){B=A[D];var E="{error}";try{E=q[B]}catch(F){}MO.Class.safeTypeOf(E,!0);var w=MO.Class.safeTypeOf(E,!0),H=null,I=!0;if(z){var J=z.attributeFind(B);J&&(w="Annotation<"+MO.Method.name(J.constructor)+">",H=
E&&E.constructor==Function?"<FONT color='green'>"+MO.Method.name(E)+"</FONT>":E+"<FONT color='green'> - ("+MO.RHtml.toHtml(J.toString())+")</FONT>",I=!1)}null==H&&(H=this.typeInfo(E,w));var J=null,G=MO.RBuilder.appendTableRow(d,null,f?f.rowIndex+1:0);G.bgColor="#FFFFFF";MO.Lang.String.startsWith(H,"@")?(G.style.cursor="pointer",G.onclick=this.onclick,G.bgColor="#FFF0E0",J=G.link=b.create(),J.link=E,J.level=h,J.caption=B,J.hTable=d,J.level=h+1,J.hRow=G):b.push(G);"Function"==w&&"virtual"==H&&(G.bgColor=
"#E0F0FF");var E=MO.RBuilder.appendTableCell(G),K=MO.Lang.String.startsWith(H,"@")?" +":"  ";B=MO.Lang.String.repeat("   ",h)+K+" "+B;E.innerHTML=MO.RHtml.toHtml(B);E.style.borderBottom="1px solid #F0F0F0";E.width="240px";J&&(J.hText=E);E=MO.RBuilder.appendTableCell(G);E.innerHTML=MO.RHtml.toHtml(w);E.style.borderBottom="1px solid #F0F0F0";E.style.color="Function"==w?"#3333FF":"#FF3333";E.width="200px";E=MO.RBuilder.appendTableCell(G);MO.Lang.String.startsWith(H,"@")&&(H=H.substr(1));E.innerHTML=
I?MO.RHtml.toHtml(H):H;E.style.borderBottom="1px solid #F0F0F0"}d.width="100%"};
MO.RDump.prototype.dump=function(b,d){d||(d=MO.RBuilder.append(null,"DIV"));var f=new MO.TString;f.append("<",MO.Class.safeTypeOf(b));b&&b.tagName&&f.append(" - ",b.tagName);f.appendLine("@"+MO.Class.code(b)+">");d=MO.RBuilder.append(d,"DIV");d.style.border="1px solid #BBBBBB";d.style.backgroundColor="#E0E0EB";var h=MO.RBuilder.appendTable(d,null,null,0,1,0),q=MO.RBuilder.appendTableRow(h),q=MO.RBuilder.appendTableCell(q);h.width="100%";q.style.padding=2;q.style.borderBottom="1px solid gray";q.style.backgroundColor=
"#E0E0EB";MO.RHtml.textSet(q,f.toString());f=MO.RBuilder.appendTable(d,null,null,0,1,0);f.style.width="100%";h=new MO.TDumpItem;h.hTable=f;h.hRow=null;h.hParent=d;h.link=b;h.level=0;this.dumpInner(h)};MO.RDump.prototype.appendLevel=function(b,d){for(var f=0;f<d;f++)b.append("   ")};MO.RDump.prototype.stack=function RDump_stack(){for(var d=RDump_stack.caller,f=new MO.TString;d;)f.append(MO.Method.name(d)),(d=d.caller)&&f.appendLine()};MO.RDump=new MO.RDump;
MO.RHtml=function(){this._nextUid=1;this._links={};this._clientPosition=new MO.SPoint2;return this};MO.RHtml.prototype.uid=function(b){var d=b.__puuid;null==d&&(d=b.__puuid=this._nextUid++);return d};MO.RHtml.prototype.displayGet=function(b){var d=null;b=b.style.display;return d=MO.RBrowser.isBrowser(MO.EBrowser.Explorer)?"inline"==b:"none"!=b};MO.RHtml.prototype.displaySet=function(b,d){var f=null,f=MO.RBrowser.isBrowser(MO.EBrowser.Explorer)?d?"inline":"none":d?null:"none";b.style.display=f};
MO.RHtml.prototype.visibleGet=function(b){var d=null;b=b.style.display;return d=MO.RBrowser.isBrowser(MO.EBrowser.Explorer)?"block"==b:"none"!=b};MO.RHtml.prototype.visibleSet=function(b,d){var f=null,f=MO.RBrowser.isBrowser(MO.EBrowser.Explorer)?d?"":"none":d?null:"none";b.style.display=f};MO.RHtml.prototype.textGet=function(b,d){var f=null;return f=MO.RBrowser.isBrowser(EBrowser.FireFox)?b.textContent:b.innerText};
MO.RHtml.prototype.textSet=function(b,d){MO.RBrowser.isBrowser(MO.EBrowser.FireFox)?b.textContent=d:b.innerText=d};MO.RHtml.prototype.checkGet=function(b){return MO.Lang.Bool.toString(b.checked)};MO.RHtml.prototype.checkSet=function(b,d){b.checked=MO.Lang.Bool.isTrue(d)};MO.RHtml.prototype.radioGet=function(b){if(b)for(var d=b.length,f=0;f<d;f++){var h=b[f];if(h.checked)return h.value}return null};
MO.RHtml.prototype.radioSet=function(b,d){if(b)for(var f=b.length,h=0;h<f;h++){var q=b[h];if(q.value==d){q.checked=!0;break}}};MO.RHtml.prototype.cursorSet=function(b,d){b&&(b.style.cursor=d)};MO.RHtml.prototype.linkGet=function(b,d){var f=this.uid(b);return(f=this._links[f])?f.get(d):null};MO.RHtml.prototype.linkSet=function(b,d,f){var h=this._links,q=this.uid(b),w=h[q];w||(w=h[q]=new MO.THtmlItem,w._link=b);w.set(d,f)};
MO.RHtml.prototype.clientPosition=function(b,d){var f=this._clientPosition;for(f.set(0,0);b!=d;)f.x+=b.offsetLeft+b.clientLeft-b.scrollLeft,f.y+=b.offsetTop+b.clientTop-b.scrollTop,b=b.offsetParent;return f};MO.RHtml.prototype.clientX=function(b,d){for(var f=0;b!=d;)f+=b.offsetLeft-b.scrollLeft,b=b.offsetParent;return f};MO.RHtml.prototype.clientY=function(b,d){for(var f=0;b!=d;)f+=b.offsetTop-b.scrollTop,b=b.offsetParent;return f};
MO.RHtml.prototype.setSize=function(b,d){d.width&&(b.style.width=d.width+"px");d.height&&(b.style.height=d.height+"px")};MO.RHtml.prototype.toText=function(b){null!=b&&(b=b.toString(),b=b.replace(/&lt;/,"<"),b=b.replace(/&gt;/g,">"),b=b.replace(/&nbsp;/g," "),b=b.replace(/<BR>/g,"\n"));return b};
MO.RHtml.prototype.toHtml=function(b){null!=b&&(b=b.toString(),b=b.replace(/</g,"&lt;"),b=b.replace(/>/g,"&gt;"),b=b.replace(/ /g,"&nbsp;"),b=b.replace(/\n/g,"<BR>"),b=b.replace(/\\n/g,"<BR>"),b=b.replace(/\r/g,""),b=b.replace(/\\r/g,""));return b};MO.RHtml.prototype.eventSource=function(b){return b.srcElement?b.srcElement:b.target};MO.RHtml.prototype.get=function(b){return document.getElementById(b)};
MO.RHtml.prototype.parent=function(b,d){if(b&&t)for(d=d.toLowerCase();b;){if(b.tagName.toLowerCase()==d)return b;b=b.parentElement}return null};MO.RHtml.prototype.searchLinker=function(b,d){for(;b;){var f=b.__linker;if(f&&MO.Class.isClass(f,d))return f;b=b.parentElement}return null};MO.RHtml.prototype.searchObject=function(b,d){for(;b;){var f=b[d];if(f)return f;b=b.parentElement}return null};
MO.RHtml.prototype.tableMoveRow=function(b,d,f){if("TABLE"!=b.tagName)throw new MO.TError("Html table is invalid.");if(d==f)return!1;if(b.moveRow)b.moveRow(d,f);else{b=b.getElementsByTagName("tbody")[0];var h=b.rows[d],q=b.rows[f];if(null==h||null==q)return!1;var w=null;if(d<=f)for(w=q;(w=w.nextSibling)&&"TR"!=w.tagName;);null==w?b.insertBefore(h,q):null==w?b.appendChild(h):b.insertBefore(h,w)}return!0};MO.RHtml.prototype.free=function(b){return null};MO.RHtml=new MO.RHtml;MO.Window.Html=MO.RHtml;
MO.RKeyboard=function(){this._status=[];return this};MO.RKeyboard.prototype.onKeyDown=function(b){this._status[b.keyCode]=MO.EKeyStatus.Press};MO.RKeyboard.prototype.onKeyUp=function(b){this._status[b.keyCode]=MO.EKeyStatus.Normal};MO.RKeyboard.prototype.construct=function(){for(var b=this._status,d=0;256>d;d++)b[d]=MO.EKeyStatus.Normal;MO.RWindow.lsnsKeyDown.register(this,this.onKeyDown);MO.RWindow.lsnsKeyUp.register(this,this.onKeyUp)};
MO.RKeyboard.prototype.isControlKey=function(b){for(var d=MO.EKeyCode.ControlKeys,f=d.length-1;0<=f;f--)if(d[f]==b)return!0;return!1};MO.RKeyboard.prototype.isIntegerKey=function(b){return MO.EKeyCode.integerCodes[b]};MO.RKeyboard.prototype.isFloatKey=function(b){return MO.EKeyCode.floatCodes[b]};MO.RKeyboard.prototype.isNumKey=function(b){return 96<=p&&105>=p?!0:!1};MO.RKeyboard.prototype.isPress=function(b){return this._status[b]==MO.EKeyStatus.Press};
MO.RKeyboard.prototype.fixCase=function(b,d){if(b&&d){var f=b.keyCode;ECase.Upper==d?f=String.fromCharCode(f).toUpperCase().charCodeAt(0):ECase.Lower==d&&(f=String.fromCharCode(f).toLowerCase().charCodeAt(0));b.keyCode=f}};MO.RKeyboard.prototype.fixPattern=function(b,d){if(d){var f=b.keyCode;if(!this.isControlKeyPress(f)&&!MO.Lang.String.isPattern(String.fromCharCode(f),d))return b.keyCode=0,!1}return!0};
MO.RKeyboard.prototype.fixChars=function(b,d){if(d){var f=b.keyCode;this.isNumKey(f)&&(f=b.keyCode-=48);if(!this.isControlKeyPress(f)&&!MO.Lang.String.inChars(String.fromCharCode(f),d))return b.keyCode=0,b.returnValue=!1}return!0};MO.Window.Keyboard=new MO.RKeyboard;MO.RValue=function(){this.double64=this.double16=this.double16=this.double4=this.double3=this.double2=this.double1=this.float16=this.float12=this.float9=this.float4=this.float3=this.float2=this.float1=null;this.construct();return this};
MO.RValue.prototype.construct=function(){MO.RBrowser.supportHtml5()&&(this.float1=new Float32Array(1),this.float2=new Float32Array(2),this.float3=new Float32Array(3),this.float4=new Float32Array(4),this.float9=new Float32Array(9),this.float12=new Float32Array(12),this.float16=new Float32Array(16),this.double1=new Float64Array(1),this.double2=new Float64Array(2),this.double3=new Float64Array(3),this.double4=new Float64Array(4),this.double9=new Float64Array(9),this.double12=new Float64Array(12),this.double16=
new Float64Array(16))};MO.RValue=new MO.RValue;MO.RXmlUtil=function(){this.httpActiveX=!1;this.httpVendor=null;this.domActiveX=!1;this.domVendor=null;this.construct();return this};
MO.RXmlUtil.prototype.construct=function(){var b=window.document;if(window.ActiveXObject&&!window.XMLHttpRequest)for(var d=["MSXml2.XmlHTTP","Microsoft.XmlHTTP","MSXml.XmlHTTP","MSXml3.XmlHTTP"],f=d.length,h=0;h<f;h++){var q=d[h];try{new ActiveXObject(q);this.httpActiveX=!0;this.httpVendor=q;break}catch(w){m=w}}else if(window.XMLHttpRequest)try{this.httpActiveX=!1}catch(z){m=z}else alert("Unknown http vendor.");if(window.ActiveXObject||!window.DOMParser)for(d=["MSXml2.DOMDocument","Microsoft.XmlDOM",
"MSXml.DOMDocument","MSXml3.XmlDOM"],f=d.length,h=0;h<f;h++){q=d[h];try{new ActiveXObject(q);this.domActiveX=!0;this.domVendor=q;break}catch(A){m=A}}else if(window.DOMParser&&b&&b.implementation&&b.implementation.createDocument)try{document.implementation.createDocument("","",null),this.domActiveX=!1}catch(B){m=B}else alert("Unknown dom vendor.")};MO.RXmlUtil.prototype.isNode=function(b){return RClass.isName(b,"TNode")};
MO.RXmlUtil.prototype.createConnection=function(){var b=null;(b=this.httpActiveX?new ActiveXObject(this.httpVendor):new XMLHttpRequest)||alert("Create xml connection failure. (message="+m+")");return b};MO.RXmlUtil.prototype.createDocument=function(){var b=null;(b=this.domActiveX?new ActiveXObject(this.domVendor):document.implementation.createDocument("","",null))||alert("Create xml document failure. (message="+m+")");return b};
MO.RXmlUtil.prototype.formatText=function(b){null!=b&&(b=b.replace(/\\n/g,"\n"));return b};MO.RXmlUtil.prototype.buildText=function(b,d){if(null!=d){d=d.toString();for(var f=d.length,h=0;h<f;h++){var q=d.charAt(h);switch(q){case "<":b.append("&lt;");break;case ">":b.append("&gt;");break;case "&":b.append("&amp;");break;case "'":b.append("&apos;");break;case '"':b.append("&quot;");break;case "\r":continue;case "\n":b.append("\\n");break;default:b.append(q)}}}return b};
MO.RXmlUtil.prototype.buildNode=function(b,d,f){var h=null,q=f.attributes;if(q){var w=q.length;if(0<w)for(var h=new MO.TAttributes,z=0;z<w;z++){var A=q[z];A.nodeName&&h.set(A.nodeName,this.formatText(A.value))}}w=new MO.TString;w.append(f.value);if(q=f.childNodes)for(A=q.length,z=0;z<A;z++){var B=q[z],C=B.nodeType;C==MO.ENodeType.Text?w.append(B.nodeValue):C==MO.ENodeType.Data&&w.append(B.data)}f=b.create(f.nodeName,h,MO.Lang.String.trim(w.toString()));d?d.push(f):b._root=f;if(q)for(d=q.length,z=
0;z<d;z++)q[z].nodeType==MO.ENodeType.Node&&this.buildNode(b,f,q[z])};MO.RXmlUtil.prototype.makeString=function(b){var d=null;this.domActiveX?(d=new ActiveXObject(this.domVendor),d.async=!1,d.loadXML(b)):d=(new DOMParser).parseFromString(b,"text/xml");return d};
MO.RXmlUtil.prototype.makeNode=function(b){if(b.documentElement){var d=new MO.TXmlDocument;this.buildNode(d,null,b.documentElement);return d.root()}if("SCRIPT"==b.tagName){var f=b.textContent;f||(f=b.text);if(f)return d=new MO.TXmlDocument,b=this.makeString(f),this.buildNode(d,null,b.documentElement),d.root()}return null};MO.RXmlUtil.prototype.makeDocument=function(b){var d=new MO.TXmlDocument;b.documentElement&&this.buildNode(d,null,b.documentElement);return d};
MO.RXmlUtil.prototype.unpack=function(b,d){if(MO.Lang.String.isEmpty(b))return null;d||(d=new MO.TNode);var f=new MO.TAttributes;f.unpack(b);d.name=f.get("name");d.value=f.get("value");f.contains("attributes")&&d.attributes().unpack(f.get("attributes"));if(f.contains("nodes")){var h=new MO.TStrings;h.unpack(f.get("nodes"));for(f=0;f<h.count;f++)this.unpack(h.get(f),d.create())}return d};MO.RXml=new MO.RXmlUtil;MO.Window.Xml=MO.RXml;
MO.EGraphicError=new function(){this.Unsupport2d="unsupport.2d";this.UnsupportWebGL="unsupport.webgL";return this};MO.MCanvasObject=function(b){b=MO.Class.inherits(this,b);b.htmlCanvas=MO.Method.virtual(b,"htmlCanvas");return b};MO.MGraphicObject=function(b){b=MO.Class.inherits(this,b);b._graphicContext=MO.Class.register(b,new MO.AGetter("_graphicContext"));b.linkGraphicContext=MO.MGraphicObject_linkGraphicContext;b.dispose=MO.MGraphicObject_dispose;return b};
MO.MGraphicObject_linkGraphicContext=function(b){if(MO.Class.isClass(b,MO.FGraphicContext))this._graphicContext=b;else if(MO.Class.isClass(b,MO.MGraphicObject))this._graphicContext=b.graphicContext();else throw new MO.TError(this,"Link graphic context failure. (context={1})",b);};MO.MGraphicObject_dispose=function(){this._graphicContext=null};MO.MGraphicRenderable=function(b){b=MO.Class.inherits(this,b,MO.FObject);b.process=MO.Method.empty;return b};MO.Graphic=new function(){return this};
MO.FFloatStream=function(b){b=MO.Class.inherits(this,b,MO.FObject);b._length=MO.Class.register(b,new MO.AGetter("_length"),0);b._memory=MO.Class.register(b,new MO.AGetter("_memory"),null);b._position=0;b.construct=MO.FFloatStream_construct;b.setLength=MO.FFloatStream_setLength;b.writeFloat4=MO.FFloatStream_writeFloat4;b.writeColor4=MO.FFloatStream_writeColor4;b.reset=MO.FFloatStream_reset;b.clear=MO.FFloatStream_clear;b.dispose=MO.FFloatStream_dispose;return b};MO.FFloatStream_construct=function(){this.__base.FObject.construct.call(this)};
MO.FFloatStream_setLength=function(b){this._length=b;this._memory=new Float32Array(b)};MO.FFloatStream_writeFloat4=function(b,d,f,h){this._memory[this._position++]=b;this._memory[this._position++]=d;this._memory[this._position++]=f;this._memory[this._position++]=h};MO.FFloatStream_writeColor4=function(b){this.writeFloat4(b.red,b.green,b.blue,b.alpha)};MO.FFloatStream_reset=function(){this._position=0};MO.FFloatStream_clear=function(){this._position=0};
MO.FFloatStream_dispose=function(){this._memory=null;this.__base.FObject.dispose.call(this)};MO.FGraphicContext=function(b){b=MO.Class.inherits(this,b,MO.FObject,MO.MGraphicObject);b._size=MO.Class.register(b,new MO.AGetter("_size"));b._hCanvas=MO.Class.register(b,new MO.AGetter("_hCanvas","htmlCanvas"));b.construct=MO.FGraphicContext_construct;b.linkCanvas=MO.Method.virtual(b,"linkCanvas");b.dispose=MO.FGraphicContext_dispose;return b};
MO.FGraphicContext_construct=function(){this.__base.FObject.construct.call(this);this._size=new MO.SSize2(1280,720)};MO.FGraphicContext_dispose=function(){this._size=MO.Lang.Object.dispose(this._size);this._hCanvas=null;this.__base.FObject.dispose.call(this)};
MO.SBorder=function(){this.valid=!1;this.left=new MO.SBorderLine;this.top=new MO.SBorderLine;this.right=new MO.SBorderLine;this.bottom=new MO.SBorderLine;this.parse=MO.SBorder_parse;this.toString=MO.SBorder_toString;this.dispose=MO.SBorder_dispose;return this};MO.SBorder_parse=function(b){var d=b.split(",");if(4==d.length)this.left.parse(d[0]),this.top.parse(d[1]),this.right.parse(d[2]),this.bottom.parse(d[3]);else throw new MO.TError(this,"Parse value failure. (source={1})",b);};
MO.SBorder_toString=function(){return this.left+","+this.top+","+this.right+","+this.bottom};MO.SBorder_dispose=function(){this.left=MO.RObject.dispose(this.left);this.top=MO.RObject.dispose(this.top);this.right=MO.RObject.dispose(this.right);this.bottom=MO.RObject.dispose(this.bottom)};
MO.SBorderLine=function(b,d,f){this.width=MO.Runtime.nvl(b,1);this.style=MO.Runtime.nvl(d,"solid");this.color=MO.Runtime.nvl(f,"#FFFFFF");this.parse=MO.SBorderLine_parse;this.toString=MO.SBorderLine_toString;this.dispose=MO.SBorderLine_dispose;return this};MO.SBorderLine_parse=function(b){var d=b.split(" ");if(3==d.length)this.width=parseInt(d[0]),this.style=d[1],this.color=d[2];else throw new TError(this,"Parse value failure. (source={1})",b);};
MO.SBorderLine_toString=function(){return this.width+" "+this.style+" "+this.color};MO.SBorderLine_dispose=function(){this.color=this.style=this.width=null};MO.FG2dObject=function(b){b=MO.Class.inherits(this,b,MO.FObject,MO.MGraphicObject);b.setup=MO.FG2dObject_setup;b.dispose=MO.FG2dObject_dispose;return b};MO.FG2dObject_setup=function(){};MO.FG2dObject_dispose=function(){this.__base.MGraphicObject.dispose.call(this);this.__base.FObject.dispose.call(this)};
MO.FG2dContext=function(b){b=MO.Class.inherits(this,b,MO.FGraphicContext);b._globalScale=MO.Class.register(b,new MO.AGetter("_globalScale"));b._scale=MO.Class.register(b,new MO.AGetter("_scale"));b.construct=MO.FG2dContext_construct;b.linkCanvas=MO.FG2dContext_linkCanvas;b.dispose=MO.FG2dContext_dispose;return b};MO.FG2dContext_construct=function(){this.__base.FGraphicContext.construct.call(this);this._globalScale=new MO.SSize2(1,1);this._scale=new MO.SSize2(1,1)};
MO.FG2dContext_linkCanvas=function(b){this._size.set(b.width,b.height)};MO.FG2dContext_dispose=function(){this._globalScale=MO.Lang.Object.dispose(this._globalScale);this._scale=MO.Lang.Object.dispose(this._scale);this.__base.FGraphicContext.dispose.call(this)};
MO.FG2dCanvasContext=function(b){b=MO.Class.inherits(this,b,MO.FG2dContext);b._handle=null;b._gridSourceX=null;b._gridSourceY=null;b._gridSourceWidth=null;b._gridSourceHeight=null;b._gridDrawX=null;b._gridDrawY=null;b._gridDrawWidth=null;b._gridDrawHeight=null;b.construct=MO.FG2dCanvasContext_construct;b.linkCanvas=MO.FG2dCanvasContext_linkCanvas;b.setGlobalScale=MO.FG2dCanvasContext_setGlobalScale;b.setScale=MO.FG2dCanvasContext_setScale;b.setAlpha=MO.FG2dCanvasContext_setAlpha;b.setFont=MO.FG2dCanvasContext_setFont;
b.store=MO.FG2dCanvasContext_store;b.restore=MO.FG2dCanvasContext_restore;b.prepare=MO.FG2dCanvasContext_prepare;b.clear=MO.FG2dCanvasContext_clear;b.clearRectangle=MO.FG2dCanvasContext_clearRectangle;b.clip=MO.FG2dCanvasContext_clip;b.textWidth=MO.FG2dCanvasContext_textWidth;b.createLinearGradient=MO.FG2dCanvasContext_createLinearGradient;b.drawLine=MO.FG2dCanvasContext_drawLine;b.drawRectangle=MO.FG2dCanvasContext_drawRectangle;b.drawTriangle=MO.FG2dCanvasContext_drawTriangle;b.drawCircle=MO.FG2dCanvasContext_drawCircle;
b.drawText=MO.FG2dCanvasContext_drawText;b.drawImage=MO.FG2dCanvasContext_drawImage;b.drawGridImage=MO.FG2dCanvasContext_drawGridImage;b.drawQuadrilateral=MO.FG2dCanvasContext_drawQuadrilateral;b.drawBorderLine=MO.FG2dCanvasContext_drawBorderLine;b.drawBorder=MO.FG2dCanvasContext_drawBorder;b.fillRectangle=MO.FG2dCanvasContext_fillRectangle;b.toBytes=MO.FG2dCanvasContext_toBytes;return b};
MO.FG2dCanvasContext_construct=function(){this.__base.FG2dContext.construct.call(this);this._gridSourceX=Array(3);this._gridSourceY=Array(3);this._gridSourceWidth=Array(3);this._gridSourceHeight=Array(3);this._gridDrawX=Array(3);this._gridDrawY=Array(3);this._gridDrawWidth=Array(3);this._gridDrawHeight=Array(3)};
MO.FG2dCanvasContext_linkCanvas=function(b){this.__base.FG2dContext.linkCanvas.call(this,b);if(b.getContext){var d=b.getContext("2d");if(!d)throw new MO.TError(this,"Current browser can't support Context2D technique.");this._handle=d}this._hCanvas=b};MO.FG2dCanvasContext_setGlobalScale=function(b,d){this._globalScale.set(b,d);this._handle.scale(b,d)};MO.FG2dCanvasContext_setScale=function(b,d){this._scale.equalsData(b,d)||(this._handle.scale(b,d),this._scale.set(b,d))};
MO.FG2dCanvasContext_setAlpha=function(b){this._handle.globalAlpha=b};MO.FG2dCanvasContext_setFont=function(b){this._handle.font=b};MO.FG2dCanvasContext_store=function(){this._handle.save()};MO.FG2dCanvasContext_restore=function(){this._handle.restore()};MO.FG2dCanvasContext_prepare=function(){var b=this._globalScale;this._handle.setTransform(b.width,0,0,b.height,0,0)};
MO.FG2dCanvasContext_clear=function(){var b=this._size,d=this._handle;d.save();d.setTransform(1,0,0,1,0,0);this._handle.clearRect(0,0,b.width,b.height);d.restore()};MO.FG2dCanvasContext_clearRectangle=function(b){this._handle.clearRect(b.left,b.top,b.width,b.height)};MO.FG2dCanvasContext_clip=function(b,d,f,h){var q=this._handle;q.beginPath();q.rect(b,d,f,h);q.clip()};MO.FG2dCanvasContext_textWidth=function(b){return this._handle.measureText(b).width};
MO.FG2dCanvasContext_createLinearGradient=function(b,d,f,h){return this._handle.createLinearGradient(b,d,f,h)};MO.FG2dCanvasContext_drawLine=function(b,d,f,h,q,w){var z=this._handle;z.strokeStyle=q;z.lineWidth=w;z.beginPath();z.moveTo(b,d);z.lineTo(f,h);z.closePath();z.stroke()};MO.FG2dCanvasContext_drawRectangle=function(b,d,f,h,q,w){var z=this._handle;z.strokeStyle=q;z.lineWidth=w;z.strokeRect(b,d,f,h)};
MO.FG2dCanvasContext_drawText=function(b,d,f,h){var q=this._handle;q.fillStyle=h;q.fillText(b,d,f)};MO.FG2dCanvasContext_drawImage=function(b,d,f,h,q){var w=this._handle,z=null;if("IMG"==b.tagName)z=b;else if(MO.Class.isClass(b,MO.FImage)){if(!b.testReady())return;z=b.image();null==h&&(h=z.size().width);null==q&&(q=z.size().height)}else throw new MO.TError(this,"Unknown content type");w.drawImage(z,d,f,h,q)};
MO.FG2dCanvasContext_drawGridImage=function(b,d,f,h,q,w){var z=this._handle,A=null;if(MO.Class.isClass(b,MO.FImage)){if(!b.testReady())return;A=b.image()}else throw new TError(this,"Unknown content type");var B=b.size();b=this._gridSourceX;b[0]=0;b[1]=w.left;b[2]=B.width-w.right;var C=this._gridSourceY;C[0]=0;C[1]=w.top;C[2]=B.height-w.bottom;var D=this._gridDrawX;D[0]=d;D[1]=d+w.left;D[2]=d+h-w.right;d=this._gridDrawY;d[0]=f;d[1]=f+w.top;d[2]=f+q-w.bottom;f=this._gridSourceWidth;f[0]=w.left;f[1]=
B.width-w.left-w.right;f[2]=w.right;var E=this._gridSourceHeight;E[0]=w.top;E[1]=B.height-w.top-w.bottom;E[2]=w.bottom;B=this._gridDrawWidth;B[0]=w.left;B[1]=h-w.left-w.right;B[2]=w.right;h=this._gridDrawHeight;h[0]=w.top;h[1]=q-w.top-w.bottom;h[2]=w.bottom;for(q=0;9>q;q++){w=parseInt(q/3);var F=q%3;0<h[w]&&0<B[F]&&z.drawImage(A,b[F],C[w],f[F],E[w],D[F],d[w],B[F],h[w])}};MO.FG2dCanvasContext_drawImageRectangle=function(b,d){return this.drawImage(b,d.left,d.top,d.width,d.height)};
MO.FG2dCanvasContext_drawBorderLine=function(b,d,f,h,q){var w=this._handle;w.strokeStyle=q.color;w.lineWidth=q.width;w.beginPath();w.moveTo(b+.5,d+.5);w.lineTo(f+.5,h+.5);w.closePath();w.stroke()};MO.FG2dCanvasContext_drawBorder=function(b,d){var f=b.left,h=b.top,q=b.left+b.width-1,w=b.top+b.height-1;this.drawBorderLine(f,w,f,h,d.left);this.drawBorderLine(f-.5,h,q+.5,h,d.top);this.drawBorderLine(q,h,q,w,d.right);this.drawBorderLine(f-.5,w,q+.5,w,d.bottom)};
MO.FG2dCanvasContext_fillRectangle=function(b,d,f,h,q){var w=this._handle;w.fillStyle=q;w.beginPath();w.fillRect(b,d,f,h);w.closePath()};MO.FG2dCanvasContext_drawQuadrilateral=function(b,d,f,h,q,w,z,A,B,C,D){var E=this._handle;E.beginPath();E.lineWidth=B;E.strokeStyle=C;E.fillStyle=D;E.moveTo(b+.5,d+.5);E.lineTo(f+.5,h+.5);E.lineTo(q+.5,w+.5);E.lineTo(z+.5,A+.5);E.lineTo(b+.5,d+.5);E.closePath();null!=B&&null!=C&&E.stroke();null!=D&&E.fill()};
MO.FG2dCanvasContext_drawTriangle=function(b,d,f,h,q,w,z,A,B){var C=this._handle;C.lineWidth=z;C.strokeStyle=A;C.fillStyle=B;C.beginPath();C.moveTo(b+.5,d+.5);C.lineTo(f+.5,h+.5);C.lineTo(q+.5,w+.5);C.closePath();C.fill();C.stroke()};MO.FG2dCanvasContext_drawCircle=function(b,d,f,h,q,w){var z=this._handle;z.lineWidth=h;z.strokeStyle=q;z.fillStyle=w;z.beginPath();z.arc(b,d,f,0,2*Math.PI,!1);z.closePath();z.fill();z.stroke()};
MO.FG2dCanvasContext_toBytes=function(){var b=this._size;return this._handle.getImageData(0,0,b.width,b.height)};MO.EG3dMaterialMap=new function(){this.AmbientColor=0;this.DiffuseColor=1;this.SpecularColor=2;this.ReflectColor=3;this.EmissiveColor=4;this.Count=8;return this};
MO.EG3dRegionParameter=new function(){this.Unknown=0;this.CameraPosition=1;this.CameraDirection=2;this.CameraViewMatrix=3;this.CameraProjectionMatrix=4;this.CameraViewProjectionMatrix=5;this.LightPosition=6;this.LightDirection=7;this.LightViewMatrix=8;this.LightProjectionMatrix=9;this.LightViewProjectionMatrix=10;this.LightInfo=11;return this};
MO.EG3dTechniqueMode=new function(){this.Color="color";this.Ambient="ambient";this.DiffuseLevel="diffuse.level";this.DiffuseColor="diffuse.color";this.SpecularLevel="specular.level";this.SpecularColor="specular.color";this.Reflect="reflect";this.Emissive="emissive";this.Result="result";return this};
MO.MG3dRegion=function(b){b=MO.Class.inherits(this,b);b._changed=!1;b._spaceName=MO.Class.register(b,new MO.AGetter("_spaceName"));b._technique=MO.Class.register(b,new MO.AGetSet("_technique"));b._techniquePass=MO.Class.register(b,new MO.AGetter("_techniquePass"));b._camera=MO.Class.register(b,new MO.AGetter("_camera"));b._projection=null;b._directionalLight=MO.Class.register(b,new MO.AGetter("_directionalLight"));b._lights=MO.Class.register(b,new MO.AGetter("_lights"));b._allRenderables=MO.Class.register(b,
new MO.AGetter("_allRenderables"));b._renderables=MO.Class.register(b,new MO.AGetter("_renderables"));b._ratioMatrix=null;b._cameraPosition=null;b._cameraDirection=null;b._cameraViewMatrix=null;b._cameraProjectionMatrix=null;b._cameraViewProjectionMatrix=null;b._lightPosition=null;b._lightDirection=null;b._lightViewMatrix=null;b._lightProjectionMatrix=null;b._lightViewProjectionMatrix=null;b._lightInfo=null;b.construct=MO.MG3dRegion_construct;b.isChanged=MO.MG3dRegion_isChanged;b.setTechniquePass=
MO.MG3dRegion_setTechniquePass;b.pushRenderable=MO.MG3dRegion_pushRenderable;b.setup=MO.MG3dRegion_setup;b.change=MO.MG3dRegion_change;b.prepare=MO.MG3dRegion_prepare;b.reset=MO.MG3dRegion_reset;b.calculate=MO.MG3dRegion_calculate;b.update=MO.MG3dRegion_update;b.dispose=MO.MG3dRegion_dispose;return b};
MO.MG3dRegion_construct=function(){this._lights=new MO.TObjects;this._renderables=new MO.TObjects;this._allRenderables=new MO.TObjects;this._ratioMatrix=new MO.SMatrix3d;this._cameraPosition=new MO.SPoint3;this._cameraDirection=new MO.SVector3;this._cameraViewMatrix=new MO.SMatrix3d;this._cameraProjectionMatrix=new MO.SMatrix3d;this._cameraViewProjectionMatrix=new MO.SMatrix3d;this._lightPosition=new MO.SPoint3;this._lightDirection=new MO.SVector3;this._lightViewMatrix=new MO.SMatrix3d;this._lightProjectionMatrix=
new MO.SMatrix3d;this._lightViewProjectionMatrix=new MO.SMatrix3d;this._lightInfo=new MO.SVector4};MO.MG3dRegion_isChanged=function(){return this._changed};MO.MG3dRegion_setTechniquePass=function(b,d){this._techniquePass=b;this._spaceName=b.fullCode();this._finish=d};MO.MG3dRegion_pushRenderable=function(b){this._renderables.push(b);this._allRenderables.push(b)};MO.MG3dRegion_setup=function(){};MO.MG3dRegion_change=function(){this._changed=!0};
MO.MG3dRegion_prepare=function(){this._changed=!1;var b=this._camera,d=b.projection();b.updateFrustum();MO.Window.Browser.capability();this._ratioMatrix.identity();this._cameraPosition.assign(b.position());this._cameraDirection.assign(b.direction());this._cameraViewMatrix.assign(b.matrix());this._cameraProjectionMatrix.assign(d.matrix());this._cameraViewProjectionMatrix.assign(b.matrix());this._cameraViewProjectionMatrix.append(d.matrix());b=this._directionalLight.camera();b.position();this._lightPosition.assign(b.position());
this._lightDirection.assign(b.direction());this._lightViewMatrix.assign(b.matrix());this._allRenderables.clear()};MO.MG3dRegion_reset=function(){this._renderables.clear()};
MO.MG3dRegion_calculate=function(b){switch(b){case MO.EG3dRegionParameter.CameraPosition:return this._cameraPosition;case MO.EG3dRegionParameter.CameraDirection:return this._cameraDirection;case MO.EG3dRegionParameter.CameraViewMatrix:return this._cameraViewMatrix;case MO.EG3dRegionParameter.CameraProjectionMatrix:return this._cameraProjectionMatrix;case MO.EG3dRegionParameter.CameraViewProjectionMatrix:return this._cameraViewProjectionMatrix;case MO.EG3dRegionParameter.LightPosition:return this._lightPosition;
case MO.EG3dRegionParameter.LightDirection:return this._lightDirection;case MO.EG3dRegionParameter.LightViewMatrix:return this._lightViewMatrix;case MO.EG3dRegionParameter.LightProjectionMatrix:return this._lightProjectionMatrix;case MO.EG3dRegionParameter.LightViewProjectionMatrix:return this._lightViewProjectionMatrix;case MO.EG3dRegionParameter.LightInfo:return this._lightInfo}throw new MO.TError(this,"Unknown parameter type. (type_cd={1})",b);};
MO.MG3dRegion_update=function(){for(var b=this._renderables,d=b.count(),f=0;f<d;f++)b.at(f).update(this)};MO.MG3dRegion_dispose=function(){this._ratioMatrix=MO.Lang.Object.free(this._ratioMatrix);this._renderables=MO.Lang.Object.free(this._renderables);this._allRenderables=MO.Lang.Object.free(this._allRenderables)};
MO.MG3dRenderable=function(b){b=MO.Class.inherits(this,b,MO.MGraphicRenderable);b._optionMerge=!1;b._currentMatrix=MO.Class.register(b,new MO.AGetter("_currentMatrix"));b._matrix=MO.Class.register(b,new MO.AGetter("_matrix"));b._material=MO.Class.register(b,new MO.AGetSet("_material"));b._activeInfo=MO.Class.register(b,new MO.AGetter("_activeInfo"));b._infos=null;b.construct=MO.MG3dRenderable_construct;b.activeEffect=MO.MG3dRenderable_activeEffect;b.effectFind=MO.MG3dRenderable_effectFind;b.effectSet=
MO.MG3dRenderable_effectSet;b.infos=MO.MG3dRenderable_infos;b.selectInfo=MO.MG3dRenderable_selectInfo;b.resetInfos=MO.MG3dRenderable_resetInfos;b.testVisible=MO.Method.emptyTrue;b.update=MO.Method.empty;b.dispose=MO.MG3dRenderable_dispose;return b};MO.MG3dRenderable_construct=function(){this._currentMatrix=new MO.SMatrix3d;this._matrix=new MO.SMatrix3d};MO.MG3dRenderable_activeEffect=function(){var b=this._activeInfo;return b?b.effect:null};
MO.MG3dRenderable_effectFind=function(b){var d=this._infos;return d&&(b=d.get(b))?b.effect:null};MO.MG3dRenderable_effectSet=function(b,d){var f=this.infos(),h=f.get(b);h||(h=new MO.SG3dRenderableInfo,f.set(b,h));h.effect=d};MO.MG3dRenderable_infos=function(){var b=this._infos;b||(b=this._infos=new MO.TDictionary);return b};MO.MG3dRenderable_selectInfo=function(b){var d=this.infos(),f=d.get(b);f||(f=new MO.SG3dRenderableInfo,d.set(b,f));return this._activeInfo=f};
MO.MG3dRenderable_resetInfos=function(){var b=this._infos;if(b)for(var d=b.count(),f=0;f<d;f++)b.at(f).reset()};MO.MG3dRenderable_dispose=function(){this._currentMatrix=MO.Lang.Object.dispose(this._currentMatrix);this._matrix=MO.Lang.Object.dispose(this._matrix);this._material=MO.Lang.Object.dispose(this._material);this._activeInfo=null;this._infos=MO.Lang.Object.dispose(this._infos)};
MO.SG3dEffectInfo=function(){this.supportInstance=this.optionNormalCompress=this.optionNormalInvert=this.optionAlphaTest=this.blendTargetMode=this.blendSourceMode=this.optionBlendMode=this.optionDepthWrite=this.depthModeCd=this.optionDepthTest=this.cullModeCd=this.optionCullMode=this.fillModeCd=this.mergeCount=this.optionMerge=this.techniqueModeCode=this.techniqueCode=this.code=null;this.vertexCount=0;this.vertexSkeleton=this.vertexNormalFull=this.vertexNormal=this.vertexCoord=this.vertexColor=null;
this.vertexBoneCount=0;this.fragmentHeight=this.fragmentEmissive=this.fragmentRefract=this.fragmentReflect=this.fragmentLight=this.fragmentEnvironment=this.fragmentSpecularView=this.fragmentSpecularLevel=this.fragmentSpecularColor=this.fragmentDiffuseView=this.fragmentDiffuse=this.fragmentAmbient=this.fragmentBump=this.fragmentAlpha=null;this.attributes=new MO.TArray;this.samplers=new MO.TArray;this.attributeContains=MO.SG3dEffectInfo_attributeContains;this.samplerContains=MO.SG3dEffectInfo_samplerContains;
this.reset=MO.SG3dEffectInfo_reset;this.reset();return this};MO.SG3dEffectInfo_attributeContains=function(b){return this.attributes.contains(b)};MO.SG3dEffectInfo_samplerContains=function(b){return this.samplers.contains(b)};
MO.SG3dEffectInfo_reset=function(){this.code=null;this.optionMerge=!1;this.mergeCount=0;this.fillModeCd=MO.EG3dFillMode.Fill;this.optionCullMode=!0;this.cullModeCd=MO.EG3dCullMode.Front;this.optionDepthTest=!0;this.depthModeCd=MO.EG3dDepthMode.Less;this.optionDepthWrite=!0;this.optionBlendMode=!1;this.blendSourceMode=MO.EG3dBlendMode.SourceAlpha;this.blendTargetMode=MO.EG3dBlendMode.OneMinusSourceAlpha;this.optionNormalInvert=this.optionAlphaTest=!1;this.optionNormalCompress=!0;this.supportInstance=
!1;this.vertexCount=0;this.vertexSkeleton=this.vertexNormalFull=this.vertexNormal=this.vertexCoord=this.vertexColor=!1;this.vertexBoneCount=0;this.fragmentHeight=this.fragmentEmissive=this.fragmentRefract=this.fragmentReflect=this.fragmentLight=this.fragmentEnvironment=this.fragmentSpecularView=this.fragmentSpecularLevel=this.fragmentSpecularColor=this.fragmentDiffuseView=this.fragmentDiffuse=this.fragmentAmbient=this.fragmentBump=this.fragmentAlpha=!1;this.attributes.clear();this.samplers.clear()};
MO.SG3dMaterialInfo=function(){this.effectCode="automatic";this.optionAlpha=this.optionShadowSelf=this.optionShadow=this.optionNormalInvert=this.optionDouble=this.optionDepth=null;this.alphaMerge=this.alphaLevel=this.alphaRate=this.alphaBase=1;this.optionColor=null;this.colorMin=0;this.colorMax=1;this.colorBalance=.5;this.colorRate=1;this.optionVertex=null;this.vertexColor=new MO.SColor4;this.optionAmbient=null;this.ambientColor=new MO.SColor4;this.ambientShadow=1;this.optionDiffuse=null;this.diffuseColor=
new MO.SColor4;this.diffuseShadow=1;this.optionDiffuseView=null;this.diffuseViewColor=new MO.SColor4;this.diffuseViewShadow=1;this.optionSpecular=null;this.specularColor=new MO.SColor4;this.specularShadow=this.specularAverage=this.specularLevel=this.specularBase=1;this.optionSpecularView=this.specularInfo=null;this.specularViewColor=new MO.SColor4;this.specularViewShadow=this.specularViewAverage=this.specularViewRate=this.specularViewBase=1;this.optionReflect=this.specularViewShadow=null;this.reflectColor=
new MO.SColor4;this.reflectShadow=this.reflectMerge=1;this.optionRefract=null;this.refractFrontColor=new MO.SColor4;this.refractBackColor=new MO.SColor4;this.optionOpacity=null;this.opacityColor=new MO.SColor4;this.opacityTransmittance=this.opacityDepth=this.opacityAlpha=this.opacityRate=1;this.optionEmissive=null;this.emissiveColor=new MO.SColor4;this.assign=MO.SG3dMaterialInfo_assign;this.calculate=MO.SG3dMaterialInfo_calculate;this.reset=MO.SG3dMaterialInfo_reset;this.reset();return this};
MO.SG3dMaterialInfo_assign=function(b){this.effectCode=b.effectCode;this.transformName=b.transformName;this.optionDepth=b.optionDepth;this.optionDouble=b.optionDouble;this.optionNormalInvert=b.optionNormalInvert;this.optionShadow=b.optionShadow;this.optionShadowSelf=b.optionShadowSelf;this.optionAlpha=b.optionAlpha;this.alphaBase=b.alphaBase;this.alphaRate=b.alphaRate;this.alphaLevel=b.alphaLevel;this.alphaMerge=b.alphaMerge;this.optionColor=b.optionColor;this.colorMin=b.colorMin;this.colorMax=b.colorMax;
this.colorBalance=b.colorBalance;this.colorRate=b.colorRate;this.optionVertex=b.optionVertex;this.vertexColor.assign(b.vertexColor);this.optionAmbient=b.optionAmbient;this.ambientColor.assign(b.ambientColor);this.ambientShadow=b.ambientShadow;this.optionDiffuse=b.optionDiffuse;this.diffuseColor.assign(b.diffuseColor);this.diffuseShadow=b.diffuseShadow;this.optionDiffuseView=b.optionDiffuseView;this.diffuseViewColor.assign(b.diffuseViewColor);this.diffuseViewShadow=b.diffuseViewShadow;this.optionSpecular=
b.optionSpecular;this.specularColor.assign(b.specularColor);this.specularBase=b.specularBase;this.specularLevel=b.specularLevel;this.specularAverage=b.specularAverage;this.specularShadow=b.specularShadow;this.optionSpecularView=b.optionSpecularView;this.specularViewColor.assign(b.specularViewColor);this.specularViewBase=b.specularViewBase;this.specularViewRate=b.specularViewRate;this.specularViewAverage=b.specularViewAverage;this.specularViewShadow=b.specularViewShadow;this.optionReflect=b.optionReflect;
this.reflectColor.assign(b.reflectColor);this.reflectMerge=MO.Lang.Float.toRange(b.reflectMerge,0,2);this.reflectShadow=b.reflectShadow;this.optionRefract=b.optionRefract;this.refractFrontColor.assign(b.refractFrontColor);this.refractFrontMerge=b.refractFrontMerge;this.refractFrontShadow=b.refractFrontShadow;this.refractBackColor.assign(b.refractBackColor);this.refractBackMerge=b.refractBackMerge;this.refractBackShadow=b.refractBackShadow;this.optionOpacity=b.optionOpacity;this.opacityColor.assign(b.opacityColor);
this.opacityRate=b.opacityRate;this.opacityAlpha=b.optionAlpha;this.opacityDepth=b.optionDepth;this.opacityTransmittance=b.optionTransmittance;this.optionEmissive=b.optionEmissive;this.emissiveColor.assign(b.emissiveColor)};
MO.SG3dMaterialInfo_calculate=function(b){this.effectCode=b.effectCode;this.transformName=b.transformName;this.optionDepth=b.optionDepth;this.optionDouble=b.optionDouble;this.optionNormalInvert=b.optionNormalInvert;this.optionShadow=b.optionShadow;this.optionShadowSelf=b.optionShadowSelf;this.optionAlpha=b.optionAlpha;this.alphaBase=b.alphaBase;this.alphaRate=b.alphaRate;this.alphaLevel=b.alphaLevel;this.alphaMerge=b.alphaMerge;this.optionColor=b.optionColor;this.colorMin=b.colorMin;this.colorMax=
b.colorMax;this.colorBalance=b.colorBalance;this.colorRate=b.colorRate;this.optionVertex=b.optionVertex;this.vertexColor.assignPower(b.vertexColor);this.optionAmbient=b.optionAmbient;this.ambientColor.assignPower(b.ambientColor);this.ambientShadow=b.ambientShadow;this.optionDiffuse=b.optionDiffuse;this.diffuseColor.assignPower(b.diffuseColor);this.diffuseShadow=b.diffuseShadow;this.optionDiffuseView=b.optionDiffuseView;this.diffuseViewColor.assignPower(b.diffuseViewColor);this.diffuseViewShadow=b.diffuseViewShadow;
this.optionSpecular=b.optionSpecular;this.specularColor.assignPower(b.specularColor);this.specularBase=b.specularBase;this.specularLevel=b.specularLevel;this.specularAverage=b.specularAverage;this.specularShadow=b.specularShadow;this.optionSpecularView=b.optionSpecularView;this.specularViewColor.assignPower(b.specularViewColor);this.specularViewBase=b.specularViewBase;this.specularViewRate=b.specularViewRate;this.specularViewAverage=b.specularViewAverage;this.specularViewShadow=b.specularViewShadow;
this.optionReflect=b.optionReflect;this.reflectColor.assignPower(b.reflectColor);this.reflectMerge=MO.Lang.Float.toRange(b.reflectMerge,0,2);this.reflectShadow=b.reflectShadow;this.optionRefract=b.optionRefract;this.refractFrontColor.assignPower(b.refractFrontColor);this.refractFrontMerge=b.refractFrontMerge;this.refractFrontShadow=b.refractFrontShadow;this.refractBackColor.assignPower(b.refractBackColor);this.refractBackMerge=b.refractBackMerge;this.refractBackShadow=b.refractBackShadow;this.optionOpacity=
b.optionOpacity;this.opacityColor.assignPower(b.opacityColor);this.opacityRate=b.opacityRate;this.opacityAlpha=b.optionAlpha;this.opacityDepth=b.optionDepth;this.opacityTransmittance=b.optionTransmittance;this.optionEmissive=b.optionEmissive;this.emissiveColor.assignPower(b.emissiveColor)};
MO.SG3dMaterialInfo_reset=function(){this.optionDepth=!0;this.optionNormalInvert=this.optionDouble=!1;this.optionShadowSelf=this.optionShadow=!0;this.optionAlpha=!1;this.alphaBase=.2;this.alphaMerge=this.alphaLevel=this.alphaRate=1;this.optionColor=!0;this.colorMin=0;this.colorMax=1;this.colorBalance=.5;this.colorRate=1;this.optionVertex=!0;this.vertexColor.set(1,1,1,1);this.optionAmbient=!0;this.ambientColor.set(.5,.5,.5,1);this.ambientShadow=1;this.optionDiffuse=!0;this.diffuseColor.set(.5,.5,.5,
1);this.diffuseShadow=1;this.optionDiffuseView=!0;this.diffuseViewColor.set(1,1,1,1);this.diffuseViewShadow=1;this.optionSpecular=!0;this.specularColor.set(.5,.5,.5,1);this.specularBase=0;this.specularLevel=16;this.specularShadow=this.specularAverage=1;this.optionSpecularView=!0;this.specularViewColor.set(1,1,1,1);this.specularViewBase=0;this.specularViewRate=16;this.specularViewShadow=this.specularViewAverage=1;this.optionReflect=!0;this.reflectColor.set(1,1,1,1);this.reflectShadow=this.reflectMerge=
1;this.optionRefract=!0;this.refractFrontColor.set(1,1,1,1);this.refractFrontShadow=this.refractFrontMerge=1;this.refractBackColor.set(1,1,1,1);this.refractBackShadow=this.refractBackMerge=1;this.optionOpacity=!0;this.opacityColor.set(1,1,1,1);this.opacityTransmittance=this.opacityDepth=this.opacityAlpha=this.opacityRate=1;this.optionEmissive=!0;this.emissiveColor.set(1,1,1,1)};MO.SG3dRenderableInfo=function(){this.material=this.layout=this.effect=null;this.reset=MO.SG3dRenderableInfo_reset;return this};
MO.SG3dRenderableInfo_reset=function(){this.effect=null;this.layout=MO.Lang.Object.dispose(this.layout)};MO.FG3dAnimation=function(b){b=MO.Class.inherits(this,b,MO.FObject);b._baseTick=0;b._currentTick=0;b._lastTick=0;b._bones=null;b.construct=MO.FG3dAnimation_construct;b.findBone=MO.FG3dAnimation_findBone;b.process=MO.FG3dAnimation_process;b.dispose=MO.FG3dAnimation_dispose;return b};MO.FG3dAnimation_construct=function(){this.__base.FObject.construct.call(this);this._bones=new MO.TObjects};
MO.FG3dAnimation_findBone=function(b){for(var d=this._bones,f=d.count(),h=0;h<f;h++){var q=d.get(h);if(q.boneId()==b)return q}return null};MO.FG3dAnimation_process=function(){var b=MO.Timer.current();0==this._lastTick&&(this._lastTick=b);this._currentTick=(b-this._lastTick+this._baseTick)/1E3;for(var b=this._bones,d=b.count(),f=0;f<d;f++)b.get(f).update(this._currentTick);return!0};MO.FG3dAnimation_dispose=function(){this._bones.dispose();this._bones=null;this.__base.FObject.dispose.call(this)};
MO.FG3dBaseMaterial=function(b){b=MO.Class.inherits(this,b,MO.FObject);b._name=null;b._info=MO.Class.register(b,new MO.AGetter("_info"));b.construct=MO.FG3dBaseMaterial_construct;b.assignInfo=MO.FG3dBaseMaterial_assignInfo;b.assign=MO.FG3dBaseMaterial_assign;b.calculate=MO.FG3dBaseMaterial_calculate;return b};MO.FG3dBaseMaterial_construct=function(){this.__base.FObject.construct.call(this);this._info=new MO.SG3dMaterialInfo};MO.FG3dBaseMaterial_assignInfo=function(b){this._info.assign(b)};
MO.FG3dBaseMaterial_assign=function(b){this._info.assign(b.info())};MO.FG3dBaseMaterial_calculate=function(b){this._info.calculate(b.info())};MO.FG3dBone=function(b){b=MO.Class.inherits(this,b,MO.FObject);b._boneId=0;b._modeId=null;b.update=MO.FG3dBone_update;return b};MO.FG3dBone_update=function(b){};
MO.FG3dCamera=function(b){b=MO.Class.inherits(this,b,MO.FObject);b._matrix=MO.Class.register(b,new MO.AGetter("_matrix"));b._position=MO.Class.register(b,new MO.AGetter("_position"));b._target=null;b._direction=MO.Class.register(b,new MO.AGetter("_direction"));b._directionTarget=null;b._centerFront=.6;b._centerBack=1;b._focalNear=.1;b._focalFar=200;b._frustum=MO.Class.register(b,new MO.AGetter("_frustum"));b._planes=MO.Class.register(b,new MO.AGetter("_planes"));b._viewport=null;b.__axisUp=null;b.__axisX=
null;b.__axisY=null;b.__axisZ=null;b.construct=MO.FG3dCamera_construct;b.setPosition=MO.FG3dCamera_setPosition;b.setDirection=MO.FG3dCamera_setDirection;b.doWalk=MO.FG3dCamera_doWalk;b.doStrafe=MO.FG3dCamera_doStrafe;b.doFly=MO.FG3dCamera_doFly;b.doPitch=MO.FG3dCamera_doPitch;b.doYaw=MO.FG3dCamera_doYaw;b.doRoll=MO.FG3dCamera_doRoll;b.lookAt=MO.FG3dCamera_lookAt;b.update=MO.FG3dCamera_update;b.updateFrustum=MO.FG3dCamera_updateFrustum;b.dispose=MO.FG3dCamera_dispose;return b};
MO.FG3dCamera_construct=function(){this.__base.FObject.construct.call(this);this._matrix=new MO.SMatrix3d;this._position=new MO.SPoint3;this._target=new MO.SPoint3;this._direction=new MO.SVector3;this._directionTarget=new MO.SVector3;this._frustum=new MO.SFrustum;this._planes=new MO.SFrustumPlanes;this._viewport=MO.Class.create(MO.FG3dViewport);this.__axisUp=new MO.SVector3(0,1,0);this.__axisX=new MO.SVector3;this.__axisY=new MO.SVector3;this.__axisZ=new MO.SVector3};
MO.FG3dCamera_setPosition=function(b,d,f){this._position.set(b,d,f)};MO.FG3dCamera_setDirection=function(b,d,f){this._direction.set(b,d,f);this._directionTarget.set(b,d,f)};MO.FG3dCamera_doWalk=function(b){this._position.x+=this._direction.x*b;this._position.z+=this._direction.z*b};MO.FG3dCamera_doStrafe=function(b){this._position.x+=this.__axisY.x*b;this._position.z+=this.__axisY.z*b};MO.FG3dCamera_doFly=function(b){this._position.y+=b};
MO.FG3dCamera_doPitch=function(b){throw new MO.TFatal(o,"Unsupport.");};MO.FG3dCamera_doYaw=function(b){throw new MO.TFatal(o,"Unsupport.");};MO.FG3dCamera_doRoll=function(b){throw new MO.TFatal(o,"Unsupport.");};MO.FG3dCamera_lookAt=function(b,d,f){var h=this._position,q=this._direction;this._target.set(b,d,f);q.set(b-h.x,d-h.y,f-h.z);q.normalize();this._directionTarget.assign(q)};
MO.FG3dCamera_update=function(){var b=this.__axisX,d=this.__axisY,f=this.__axisZ;f.assign(this._direction);f.normalize();this.__axisUp.cross2(b,f);b.normalize();f.cross2(d,b);d.normalize();var h=this._matrix.data();h[0]=b.x;h[1]=d.x;h[2]=f.x;h[3]=0;h[4]=b.y;h[5]=d.y;h[6]=f.y;h[7]=0;h[8]=b.z;h[9]=d.z;h[10]=f.z;h[11]=0;h[12]=-b.dotPoint3(this._position);h[13]=-d.dotPoint3(this._position);h[14]=-f.dotPoint3(this._position);h[15]=1};
MO.FG3dCamera_updateFrustum=function(){var b=MO.Lang.Math.matrix;b.assign(this._matrix);b.append(this._projection.matrix());this._planes.updateVision(b.data())};MO.FG3dCamera_dispose=function(){this._matrix=MO.Lang.Obejct.dispose(this._matrix);this.__base.FObject.dispose.call(this)};
MO.FG3dDirectionalLight=function(b){b=MO.Class.inherits(this,b,MO.FG3dLight);b._camera=MO.Class.register(b,new MO.AGetter("_camera"));b._viewport=MO.Class.register(b,new MO.AGetter("_viewport"));b._direction=MO.Class.register(b,new MO.AGetter("_direction"));b.construct=MO.FG3dDirectionalLight_construct;b.dispose=MO.FG3dDirectionalLight_dispose;return b};
MO.FG3dDirectionalLight_construct=function(){this.__base.FG3dLight.construct.call(this);this._camera=MO.Class.create(MO.FG3dCamera);this._direction=new MO.SVector3};MO.FG3dDirectionalLight_dispose=function(){this._camera=MO.Lang.Object.dispose(this._camera);this.__base.FG3dLight.dispose.call(this)};
MO.FG3dEffect=function(b){b=MO.Class.inherits(this,b,MO.FG3dObject);b._ready=null;b._code=MO.Class.register(b,new MO.AGetter("_code"));b._stateFillCd=MO.EG3dFillMode.Face;b._stateCullCd=MO.EG3dCullMode.Front;b._stateDepth=!0;b._stateDepthCd=MO.EG3dDepthMode.LessEqual;b._stateDepthWrite=!0;b._stateBlend=!0;b._stateBlendSourceCd=MO.EG3dBlendMode.SourceAlpha;b._stateBlendTargetCd=MO.EG3dBlendMode.OneMinusSourceAlpha;b._stateAlphaTest=!1;b._optionShadow=!1;b._optionLightMap=!1;b._optionFog=!1;b._program=
MO.Class.register(b,new MO.AGetter("_program"));b._vertexTemplate=null;b._fragmentTemplate=null;b.setup=MO.Method.empty;b.testReady=MO.FG3dEffect_testReady;b.setParameter=MO.FG3dEffect_setParameter;b.setSampler=MO.FG3dEffect_setSampler;b.drawRenderable=MO.FG3dEffect_drawRenderable;b.drawRenderables=MO.FG3dEffect_drawRenderables;b.drawGroup=MO.FG3dEffect_drawGroup;b.drawRegion=MO.FG3dEffect_drawRegion;b.buildInfo=MO.FG3dEffect_buildInfo;b.loadConfig=MO.FG3dEffect_loadConfig;b.load=MO.FG3dEffect_load;
b.build=MO.FG3dEffect_build;return b};MO.FG3dEffect_testReady=function(){return this._ready};MO.FG3dEffect_setParameter=function(b,d,f){this._program.setParameter(b,d,f)};MO.FG3dEffect_setSampler=function(b,d){this._program.setSampler(b,d)};MO.FG3dEffect_buildInfo=function(b,d){};
MO.FG3dEffect_drawRenderable=function(b,d){var f=this._graphicContext,h=this._program;if(h.hasAttribute())for(var q=h.attributes(),w=q.count(),z=0;z<w;z++){var A=q.value(z);if(A._statusUsed){var B=A._linker,C=d.findVertexBuffer(B);if(!C)throw new MO.TError("Can't find renderable vertex buffer. (linker={1})",B);h.setAttribute(A._name,C,C._formatCd)}}h=d.indexBuffer();f.drawTriangles(h,0,h.count())};
MO.FG3dEffect_drawRenderables=function(b,d,f,h){this._graphicContext.setProgram(this._program);for(var q=0;q<h;q++){var w=d.at(f+q);this.drawRenderable(b,w)}};MO.FG3dEffect_drawGroup=function(b,d,f,h){this.drawRenderables(b,d,f,h)};MO.FG3dEffect_drawRegion=function(b,d,f){for(var h=b.renderables(),q=0;q<f;){for(var w=q,z=f,A=h.at(d+w).materialReference(),B=q;B<f;B++){var C=h.at(d+B).materialReference();if(A!=C){z=B;break}q++}this.drawGroup(b,h,d+w,z-w)}};
MO.FG3dEffect_loadConfig=function(b){var d=this._program=this._graphicContext.createProgram();b=b.nodes();for(var f=b.count(),h=0;h<f;h++){var q=b.get(h);if(q.isName("State")){var w=q.get("name"),z=q.get("value");if("fill_mode"==w)this._stateFillCd=MO.Lang.Enum.parse(MO.EG3dFillMode,z);else if("cull_mode"==w)this._stateCullCd=MO.Lang.Enum.parse(MO.EG3dCullMode,z);else if("depth_mode"==w)this._stateDepth=!0,this._stateDepthCd=MO.Lang.Enum.parse(MO.EG3dDepthMode,z);else if("depth_write"==w)this._stateDepthWrite=
MO.Lang.Boolean.parse(z);else if("blend_mode"==w){if(this._stateBlend=MO.Lang.Boolean.parse(z))this._stateBlendSourceCd=MO.Lang.Enum.parse(MO.EG3dBlendMode,q.get("source")),this._stateBlendTargetCd=MO.Lang.Enum.parse(MO.EG3dBlendMode,q.get("target"))}else"alpha_test"==w&&(this._stateAlphaTest=MO.RBoolean.parse(z))}else if(q.isName("Option"))w=q.get("name"),z=q.get("value"),"shadow"==w?this._optionShadow=MO.Lang.Boolean.parse(z):"lightmap"==w?this._optionLightMap=MO.Lang.Boolean.parse(z):"fog"==w&&
(this._optionFog=MO.Lang.Boolean.parse(z));else if(q.isName("Parameter"))w=MO.Class.create(MO.FG3dProgramParameter),w.loadConfig(q),d.parameters().set(w.name(),w);else if(q.isName("Attribute"))w=MO.Class.create(MO.FG3dProgramAttribute),w.loadConfig(q),d.attributes().set(w.name(),w);else if(q.isName("Sampler"))w=MO.Class.create(MO.FG3dProgramSampler),w.loadConfig(q),d.samplers().set(w.name(),w);else if(q.isName("Source"))if(w=q.get("name"),"vertex"==w)this._vertexSource=q.value();else if("fragment"==
w)this._fragmentSource=q.value();else throw new MO.TError(this,"Unknown source type. (name={1})",w);else throw new MO.TError(this,"Unknown config type. (name={1})",q.name());}(this._vertexTemplate=MO.Class.create(MO.FG3dShaderTemplate)).load(this._vertexSource);(this._fragmentTemplate=MO.Class.create(MO.FG3dShaderTemplate)).load(this._fragmentSource)};
MO.FG3dEffect_build=function(b){var d=this._program,f=d.parameters(),h=f.count(),q=MO.RInstance.get(MO.FTagContext);this.buildInfo(q,b);b=this._vertexTemplate.parse(q);b=MO.Lang.String.formatLines(b);d.upload(MO.EG3dShader.Vertex,b);b=this._fragmentTemplate.parse(q);for(q=0;q<h;q++){var w=f.at(q),z=w.name();(w=w.define())&&(b=b.replace(new RegExp(z,"g"),w))}b=MO.Lang.String.formatLines(b);d.upload(MO.EG3dShader.Fragment,b);d.build();d.link()};
MO.FG3dEffect_load=function(){var b=MO.Console.find(MO.FG3dEffectConsole).loadConfig(this._code);this.loadConfig(b)};
MO.FG3dEffectConsole=function(b){b=MO.Class.inherits(this,b,MO.FConsole);b._scopeCd=MO.EScope.Local;b._configs=null;b._loadEffects=null;b._registerEffects=null;b._templateEffects=null;b._effects=null;b._path=MO.Class.register(b,MO.AGetter("_path"),"/ars/shader/");b._effectInfo=null;b._tagContext=null;b._thread=null;b._interval=300;b.onProcess=MO.FG3dEffectConsole_onProcess;b.construct=MO.FG3dEffectConsole_construct;b.register=MO.FG3dEffectConsole_register;b.unregister=MO.FG3dEffectConsole_unregister;
b.create=MO.FG3dEffectConsole_create;b.buildEffectInfo=MO.FG3dEffectConsole_buildEffectInfo;b.findTemplate=MO.FG3dEffectConsole_findTemplate;b.find=MO.FG3dEffectConsole_find;b.loadConfig=MO.FG3dEffectConsole_loadConfig;return b};MO.FG3dEffectConsole_onProcess=function(){var b=this._loadEffects;for(b.record();b.next();)b.current().processLoad()&&b.removeCurrent()};
MO.FG3dEffectConsole_construct=function(){this.__base.FConsole.construct.call(this);this._configs=new MO.TDictionary;this._loadEffects=new MO.TLooper;this._registerEffects=new MO.TDictionary;this._templateEffects=new MO.TDictionary;this._effects=new MO.TDictionary;this._effectInfo=new MO.SG3dEffectInfo;this._tagContext=MO.Class.create(MO.FTagContext)};MO.FG3dEffectConsole_register=function(b,d){this._registerEffects.set(b,d)};
MO.FG3dEffectConsole_unregister=function(b){this._registerEffects.set(b,null)};MO.FG3dEffectConsole_create=function(b,d){var f=this._registerEffects.get(d);if(!f)throw new MO.TError(this,"Unknown effect type name. (type={1})",f);f=MO.Class.create(f);f.linkGraphicContext(b);f.setup();return f};
MO.FG3dEffectConsole_buildEffectInfo=function(b,d,f,h){b=b.capability();f=f.technique();d.techniqueModeCode=f.activeMode().code();d.optionMerge=h._optionMerge;d.optionMerge&&(d.mergeCount=h.mergeMaxCount(),d.mergeStride=h.mergeStride());f=h.material().info();d.optionNormalInvert=f.optionNormalInvert;d.optionColor=f.optionColor;d.optionAmbient=f.optionAmbient;d.optionDiffuse=f.optionDiffuse;d.optionSpecular=f.optionSpecular;d.optionReflect=f.optionReflect;d.optionRefract=f.optionRefract;d.vertexCount=
h.vertexCount();var q=h.vertexBuffers();f=q.count();for(var w=0;w<f;w++){var z=q.at(w),A=z.code();"normal"==A&&(4==z.stride()?d.optionNormalCompress=!0:d.optionNormalCompress=!1);if(MO.Lang.String.isEmpty(A))throw new MO.TError(this,"Vertex buffer code is empty.");d.attributes.push(A)}if(q=h.textures())for(f=q.count(),w=0;w<f;w++){z=q.name(w);if(MO.Lang.String.isEmpty(z))throw new MO.TError(this,"Texture code is empty.");d.samplers.push(z)}if(f=h.bones())f=f.count(),d.vertexBoneCount=f,b=b.calculateBoneCount(d.vertexBoneCount,
d.vertexCount),f>b&&(f=b),h._boneLimit=f,d.vertexBoneLimit=f};MO.FG3dEffectConsole_findTemplate=function(b,d){var f=this._templateEffects,h=f.get(d);null==h&&(h=this.create(b,d),h.load(),MO.Logger.info(this,"Create effect template. (code={1}, instance={2})",d,h),f.set(d,h));return h};
MO.FG3dEffectConsole_find=function(b,d,f){MO.Class.isClass(b,MO.FGraphicContext)||(b=b.graphicContext());if(!MO.Class.isClass(b,MO.FGraphicContext))throw new MO.TError(this,"Unknown context.");var h=f.material().info().effectCode;MO.Lang.String.isEmpty(h)&&(h="automatic");"skeleton"!=h&&"skeleton.4"!=h||null!=f.bones()||(h="automatic");var q=d.spaceName()+"."+h,w=this.findTemplate(b,q);if(w){var z=this._effectInfo;z.reset();this.buildEffectInfo(b,z,d,f);w.buildInfo(this._tagContext,z);d=q+this._tagContext.code;
f=this._effects;z=f.get(d);z||(z=this.create(b,q),z._flag=d,z.load(),z.build(this._effectInfo),MO.Logger.info(this,"Create effect. (name={1}, instance={2})",h,z));f.set(d,z)}return z};MO.FG3dEffectConsole_loadConfig=function(b){var d=this._configs.get(b);if(d)return d;d=MO.RBrowser.contentPath(this._path+b+".xml");MO.Runtime.isDebug()&&(d+="?"+MO.Lang.Date.format());d=MO.Class.create(MO.FXmlConnection).send(d);this._configs.set(b,d);return d};
MO.FG3dLight=function(b){return b=MO.Class.inherits(this,b,MO.FObject)};MO.FG3dLightMaterial=function(b){return b=MO.Class.inherits(this,b,MO.FG3dBaseMaterial)};MO.FG3dMaterial=function(b){b=MO.Class.inherits(this,b,MO.FG3dBaseMaterial);b._dirty=!0;b._textures=MO.Class.register(b,new MO.AGetter("_textures"));b.setTexture=MO.FG3dMaterial_setTexture;b.update=MO.FG3dMaterial_update;return b};
MO.FG3dMaterial_setTexture=function(b,d){var f=this._textures;f||(f=this._textures=new MO.TDictionary);f.set(b,d)};MO.FG3dMaterial_update=function(){this._dirty=!0};
MO.FG3dMaterialMap=function(b){b=MO.Class.inherits(this,b,MO.FObject,MO.MGraphicObject);b._size=MO.Class.register(b,new MO.AGetter("_size"));b._data=MO.Class.register(b,new MO.AGetter("_data"));b._texture=MO.Class.register(b,new MO.AGetter("_texture"));b._stride=null;b._dirty=!1;b.construct=MO.FG3dMaterialMap_construct;b.setup=MO.FG3dMaterialMap_setup;b.resize=MO.FG3dMaterialMap_resize;b.setUint8=MO.FG3dMaterialMap_setUint8;b.setUint16=MO.FG3dMaterialMap_setUint16;b.setUint32=MO.FG3dMaterialMap_setUint32;
b.setFloat16=MO.FG3dMaterialMap_setFloat16;b.setFloat32=MO.FG3dMaterialMap_setFloat32;b.update=MO.FG3dMaterialMap_update;return b};MO.FG3dMaterialMap_construct=function(){this.__base.FObject.construct.call(this);this._size=new MO.SSize2};MO.FG3dMaterialMap_setup=function(b,d){var f=this._texture=this._graphicContext.createFlatTexture();this.resize(b,d);f.setFilterCd(MO.EG3dSamplerFilter.Nearest,MO.EG3dSamplerFilter.Nearest);f.uploadData(this._data,b,d)};
MO.FG3dMaterialMap_resize=function(b,d){var f=this._size;2048<d?d=4096:1024<d?d=2048:512<d?d=1024:256<d?d=512:128<d?d=256:64<d?d=128:32<d?d=64:16<d&&(d=32);d<f.height&&(d=f.height);if(f.width!=b||f.height!=d)f.set(b,d),this._stride=4*b,this._data=new Uint8Array(4*b*d)};
MO.FG3dMaterialMap_setUint8=function(b,d,f,h,q,w){var z=this._data;b=this._stride*b+(d<<2);f.constructor==MO.SColor4?(h=255*f.red,z[b]!=h&&(this._dirty=!0),z[b++]=h,h=255*f.green,z[b]!=h&&(this._dirty=!0),z[b++]=h,h=255*f.blue,z[b]!=h&&(this._dirty=!0),z[b++]=h,h=255*f.alpha,z[b]!=h&&(this._dirty=!0),z[b++]=h):(z[b++]=f,z[b++]=h,z[b++]=q,z[b++]=w)};
MO.FG3dMaterialMap_setUint16=function(b,d,f,h){var q=this._data;b=this._stride*b+(d<<2);q[b++]=f>>8&255;q[b++]=f&255;q[b++]=h>>8&255;q[b++]=h&255;this._dirty=!0};MO.FG3dMaterialMap_setUint32=function(b,d,f){var h=this._data;b=this._stride*b+(d<<2);h[b++]=f>>24&255;h[b++]=f>>16&255;h[b++]=f>>8&255;h[b++]=f&255;this._dirty=!0};
MO.FG3dMaterialMap_setFloat16=function(b,d,f,h){var q=this._data;b=this._stride*b+(d<<2);parseInt(256*f);q[b++]=parseInt(f)&255;q[b++]=parseInt(256*f)&255;q[b++]=parseInt(h)&255;q[b++]=parseInt(256*h)&255;this._dirty=!0};MO.FG3dMaterialMap_setFloat32=function(b,d,f){var h=this._data;b=this._stride*b+(d<<2);h[b++]=parseInt(.00390625*f)&255;h[b++]=parseInt(f)&255;h[b++]=parseInt(256*f)&255;h[b++]=parseInt(65536*f)&255;this._dirty=!0};
MO.FG3dMaterialMap_update=function(){if(this._dirty){var b=this._size;this._texture.uploadData(this._data,b.width,b.height);this._dirty=!1}};MO.FG3dMaterialTexture=function(b){b=MO.Class.inherits(this,b,MO.FG3dMaterial);b._texture=null;return b};MO.FG3dObject=function(b){b=MO.Class.inherits(this,b,MO.FObject,MO.MGraphicObject);b.setup=MO.FG3dObject_setup;b.dispose=MO.FG3dObject_dispose;return b};MO.FG3dObject_setup=function(){};
MO.FG3dObject_dispose=function(){this.__base.MGraphicObject.dispose.call(this);this.__base.FObject.dispose.call(this)};MO.FG3dOrthoProjection=function(b){b=MO.Class.inherits(this,b,MO.FG3dProjection);b.construct=MO.FG3dOrthoProjection_construct;b.update=MO.FG3dOrthoProjection_update;b.updateFrustum=MO.FG3dOrthoProjection_updateFrustum;b.dispose=MO.FG3dOrthoProjection_dispose;return b};MO.FG3dOrthoProjection_construct=function(){this.__base.FG3dProjection.construct.call(this)};
MO.FG3dOrthoProjection_update=function(){var b=this._size;MO.Lang.Matrix.orthoLH(this._matrix,.5*-b.width,.5*-b.height,b.width,b.height,this._znear,this._zfar)};MO.FG3dOrthoProjection_updateFrustum=function(b){this._znear=b.minZ;this._zfar=b.maxZ;this.update()};MO.FG3dOrthoProjection_dispose=function(){this.__base.FG3dProjection.dispose.call(this)};
MO.FG3dPerspectiveProjection=function(b){b=MO.Class.inherits(this,b,MO.FG3dProjection);b.construct=MO.FG3dPerspectiveProjection_construct;b.update=MO.FG3dPerspectiveProjection_update;b.updateFrustum=MO.FG3dPerspectiveProjection_updateFrustum;b.dispose=MO.FG3dPerspectiveProjection_dispose;return b};MO.FG3dPerspectiveProjection_construct=function(){this.__base.FG3dProjection.construct.call(this)};
MO.FG3dPerspectiveProjection_update=function(){var b=this._size;this._fieldOfView=MO.RConst.DEGREE_RATE*this._angle;MO.Lang.Matrix.perspectiveFieldOfViewLH(this._matrix,this._fieldOfView,b.width/b.height,this._znear,this._zfar)};MO.FG3dPerspectiveProjection_updateFrustum=function(b){this._znear=b.minZ;this._zfar=b.maxZ;this.update()};MO.FG3dPerspectiveProjection_dispose=function(){this.__base.FG3dProjection.dispose.call(this)};MO.FG3dPointLight=function(b){return b=MO.Class.inherits(this,b,MO.FG3dLight)};
MO.FG3dProjection=function(b){b=MO.Class.inherits(this,b,MO.FObject);b._matrix=MO.Class.register(b,new MO.AGetter("_matrix"));b._size=MO.Class.register(b,new MO.AGetter("_size"));b._angle=MO.Class.register(b,new MO.AGetSet("_angle"),60);b._fieldOfView=MO.Class.register(b,new MO.AGetSet("_fieldOfView"),0);b._znear=MO.Class.register(b,new MO.AGetSet("_znear"),.1);b._zfar=MO.Class.register(b,new MO.AGetSet("_zfar"),200);b._zoom=MO.Class.register(b,new MO.AGetSet("_zoom"),1);b.construct=MO.FG3dProjection_construct;
b.distance=MO.FG3dProjection_distance;b.dispose=MO.FG3dProjection_dispose;return b};MO.FG3dProjection_construct=function(){this.__base.FObject.construct.call(this);this._matrix=new MO.SMatrix3d;this._size=new MO.SSize2};MO.FG3dProjection_distance=function(){return this._zfar-this._znear};MO.FG3dProjection_dispose=function(){this._matrix=MO.Lang.Object.dispose(this._matrix);this._size=MO.Lang.Object.dispose(this._size);this.__base.FObject.dispose.call(this)};
MO.FG3dShaderTemplate=function(b){b=MO.Class.inherits(this,b,MO.FTagDocument);b._space="shader";return b};MO.FG3dSpotLight=function(b){return b=MO.Class.inherits(this,b,MO.FG3dLight)};
MO.FG3dTechnique=function(b){b=MO.Class.inherits(this,b,MO.FG3dObject);b._code=MO.Class.register(b,new MO.AGetter("_code"));b._activeMode=MO.Class.register(b,new MO.AGetter("_activeMode"));b._modes=MO.Class.register(b,new MO.AGetter("_modes"));b._passes=MO.Class.register(b,new MO.AGetter("_passes"));b.construct=MO.FG3dTechnique_construct;b.registerMode=MO.FG3dTechnique_registerMode;b.selectMode=MO.FG3dTechnique_selectMode;b.updateRegion=MO.Method.empty;b.clear=MO.FG3dTechnique_clear;b.clearDepth=
MO.FG3dTechnique_clearDepth;b.sortRenderables=MO.FG3dTechnique_sortRenderables;b.drawRegion=MO.FG3dTechnique_drawRegion;b.present=MO.FG3dTechnique_present;return b};MO.FG3dTechnique_construct=function(){this.__base.FG3dObject.construct.call(this);this._modes=new MO.TObjects;this._passes=new MO.TObjects};MO.FG3dTechnique_registerMode=function(b){var d=MO.Class.create(MO.FG3dTechniqueMode);d.setCode(b);this._modes.push(d);return this._activeMode=d};MO.FG3dTechnique_selectMode=function(b){};
MO.FG3dTechnique_clear=function(b){var d=this._graphicContext;d.setRenderTarget(null);d.clear(b.red,b.green,b.blue,b.alpha,1)};MO.FG3dTechnique_clearDepth=function(b){null==b&&(b=1);this._graphicContext.clearDepth(b)};MO.FG3dTechnique_sortRenderables=function(b,d){};MO.FG3dTechnique_drawRegion=function(b){b.setTechnique(this);for(var d=this._passes,f=d.count(),h=0;h<f;h++){var q=d.at(h);b.setTechniquePass(q,h==f-1);q.drawRegion(b)}};MO.FG3dTechnique_present=function(b){this._graphicContext.present()};
MO.FG3dTechniqueConsole=function(b){b=MO.Class.inherits(this,b,MO.FConsole);b._scopeCd=MO.EScope.Local;b._techniques=MO.Class.register(b,new MO.AGetter("_techniques"));b.construct=MO.FG3dTechniqueConsole_construct;b.find=MO.FG3dTechniqueConsole_find;return b};MO.FG3dTechniqueConsole_construct=function(){this.__base.FConsole.construct.call(this);this._techniques=new MO.TDictionary};
MO.FG3dTechniqueConsole_find=function(b,d){MO.Class.isClass(b,MO.FGraphicContext)||(b=b.graphicContext());if(!MO.Class.isClass(b,MO.FGraphicContext))throw new MO.TError(this,"Unknown context.");var f=b.hashCode()+"|"+MO.Class.name(d),h=this._techniques,q=h.get(f);if(!q){q=MO.Class.create(d);q.linkGraphicContext(b);q.setup();for(var w=q.code(),z=q.passes(),A=z.count(),B=0;B<A;B++){var C=z.at(B),D=C.code();C.setFullCode(w+"."+D)}h.set(f,q)}return q};
MO.FG3dTechniqueMode=function(b){b=MO.Class.inherits(this,b,MO.FObject);b._code=MO.Class.register(b,new MO.AGetSet("_code"));return b};
MO.FG3dTechniquePass=function(b){b=MO.Class.inherits(this,b,MO.FG3dObject);b._fullCode=MO.Class.register(b,new MO.AGetSet("_fullCode"));b._code=MO.Class.register(b,new MO.AGetter("_code"));b._index=null;b._finish=!1;b._materialMap=null;b.setup=MO.FG3dTechniquePass_setup;b.activeEffects=MO.FG3dTechniquePass_activeEffects;b.sortRenderables=MO.FG3dTechniquePass_sortRenderables;b.drawRegion=MO.FG3dTechniquePass_drawRegion;return b};
MO.FG3dTechniquePass_setup=function(){var b=this._materialMap=MO.Class.create(MO.FG3dMaterialMap);b.linkGraphicContext(this);b.setup(MO.EG3dMaterialMap.Count,32)};
MO.FG3dTechniquePass_sortRenderables=function(b,d){var f=b.material().info(),h=d.material().info();if(f.optionAlpha&&h.optionAlpha){f=b.activeEffect();h=d.activeEffect();if(f==h){var q=b.materialReference(),w=d.materialReference();if(q&&w)return q.hashCode()-w.hashCode()}return f.hashCode()-h.hashCode()}if(f.optionAlpha&&!h.optionAlpha)return 1;if(!f.optionAlpha&&h.optionAlpha)return-1;f=b.activeEffect();h=d.activeEffect();return f==h&&(q=b.materialReference(),w=d.materialReference(),q&&w)?q.hashCode()-
w.hashCode():f.hashCode()-h.hashCode()};MO.FG3dTechniquePass_activeEffects=function(b,d){for(var f=b.spaceName(),h=d.count(),q=0;q<h;q++){var w=d.at(q),z=w.selectInfo(f);z.effect||(z.effect=MO.Console.find(MO.FG3dEffectConsole).find(this._graphicContext,b,w))}};
MO.FG3dTechniquePass_drawRegion=function(b){var d=b.renderables(),f=d.count();if(0!=f){var h=b._statistics;h._frameDrawSort.begin();this.activeEffects(b,d);d.sort(this.sortRenderables);h._frameDrawSort.end();if(this._graphicContext.capability().optionMaterialMap){var q=this._materialMap;q.resize(MO.EG3dMaterialMap.Count,f);for(h=0;h<f;h++){var w=d.get(h);w._materialId=h;w=w.material().info();q.setUint8(h,MO.EG3dMaterialMap.AmbientColor,w.ambientColor);q.setUint8(h,MO.EG3dMaterialMap.DiffuseColor,
w.diffuseColor);q.setUint8(h,MO.EG3dMaterialMap.SpecularColor,w.specularColor);q.setUint8(h,MO.EG3dMaterialMap.ReflectColor,w.reflectColor);q.setUint8(h,MO.EG3dMaterialMap.EmissiveColor,w.emissiveColor)}q.update();b._materialMap=q}for(q=0;q<f;){for(var w=q,z=f,A=d.at(w).activeEffect(),h=q;h<f;h++){var B=d.at(h).activeEffect();if(A!=B){z=h;break}q++}A.drawRegion(b,w,z-w)}}};
MO.FG3dTrack=function(b){b=MO.Class.inherits(this,b,MO.FObject);b._frames=null;b.construct=MO.FG3dTrack_construct;b.calculate=MO.FG3dTrack_calculate;return b};MO.FG3dTrack_construct=function(){this.__base.FObject.construct.call(this)};MO.FG3dTrack_update=function(b){b=new MO.SG3dFrameInfo;this._trackResource.calculateFrameInfo(b,tick);b.update();this._matrix.assign(this._trackResource.matrixInvert());this._matrix.append(b.matrix);return!0};
MO.FG3dTrack_calculate=function(b){var d=this._frames.count();if(0==d)return!1;0>b&&(b=-b);var f=this._frames.Get(index),h=null,h=index<d-1?this._frames.Get(index+1):this._frames.Get(0);info.tick=b;info.currentFrame=f;info.nextFrame=h;return!0};MO.FG3dViewport=function(b){b=MO.Class.inherits(this,b,MO.FObject);b.left=0;b.top=0;b.width=0;b.height=0;b.set=MO.FG3dViewport_set;return b};MO.FG3dViewport_set=function(b,d,f,h){this.left=b;this.top=d;this.width=f;this.height=h};
MO.REngine3d=function(){this._setuped=!1;this._contexts=null;return this};MO.REngine3d.prototype.onUnload=function(b){this.dispose()};MO.REngine3d.prototype.setup=function(){this._setuped||(this._contexts=new MO.TObjects,MO.Window.lsnsUnload.register(this,this.onUnload),this._setuped=!0)};MO.REngine3d.prototype.contexts=function(){return this._contexts};
MO.REngine3d.prototype.createContext=function(b,d,f){this.setup();b=MO.Class.create(b);f&&(b._optionAlpha=f.alpha,b._optionAntialias=f.antialias);if(!b.linkCanvas(d))return null;this._contexts.push(b);return b};MO.REngine3d.prototype.dispose=function(){var b=this._contexts;if(b){for(var d=b.count(),f=0;f<d;f++)b.at(f).dispose();this._contexts=MO.Lang.Object.dispose(b)}};MO.REngine3d=new MO.REngine3d;MO.Graphic.Context3d=MO.REngine3d;MO.Engine3d=MO.REngine3d;
MO.EG3dAttribute=new function(){this.Position="position";this.Color="color";this.Coord="coord";this.Normal="normal";this.Binormal="binormal";this.Tangent="tangent";this.BoneIndex="bone_index";this.BoneWeight="bone_weight";return this};MO.EG3dAttributeFormat=new function(){this.Unknown=0;this.Float1=1;this.Float2=2;this.Float3=3;this.Float4=4;this.Byte4=5;this.Byte4Normal=6;return this};
MO.EG3dBlendMode=new function(){this.Zero=0;this.One=1;this.SrcColor=2;this.OneMinusSrcColor=3;this.DstColor=4;this.OneMinusDstColor=5;this.SrcAlpha=6;this.OneMinusSrcAlpha=7;this.DstAlpha=8;this.OneMinusDstAlpha=9;this.SrcAlphaSaturate=10;return this};MO.EG3dCullMode=new function(){this.None=0;this.Front=1;this.Back=2;this.Both=3;return this};MO.EG3dDepthMode=new function(){this.None=0;this.Equal=1;this.NotEqual=2;this.Less=3;this.LessEqual=4;this.Greater=5;this.GreaterEqual=6;this.Always=7;return this};
MO.EG3dDrawMode=new function(){this.Unknown=0;this.Points=1;this.Lines=2;this.LineStrip=3;this.LineLoop=4;this.Triangles=5;this.TriangleStrip=6;this.TriangleFan=7;this.Quads=8;this.QuadStrip=9;return this};MO.EG3dFillMode=new function(){this.Unknown=0;this.Point=1;this.Line=2;this.Face=3;return this};MO.EG3dIndexStride=new function(){this.Unknown=0;this.Uint16=1;this.Uint32=2;return this};
MO.EG3dParameterFormat=new function(){this.Unknown=0;this.Float1=1;this.Float2=2;this.Float3=3;this.Float4=4;this.Float3x3=5;this.Float4x3=6;this.Float4x4=7;return this};MO.EG3dSampler=new function(){this.Diffuse="diffuse";this.Alpha="alpha";this.Normal="normal";this.SpecularColor="specular.color";this.SpecularLevel="specular.level";this.Light="light";this.Reflect="reflect";this.Refract="refract";this.Emissive="emissive";this.Height="height";this.Environment="environment";return this};
MO.EG3dSamplerFilter=new function(){this.Unknown=0;this.Nearest=1;this.Linear=2;this.Repeat=3;this.ClampToEdge=4;this.ClampToBorder=5;return this};MO.EG3dShader=new function(){this.Unknown=0;this.Vertex=1;this.Fragment=2;return this};MO.EG3dTexture=new function(){this.Unknown=0;this.Flat2d=1;this.Flat3d=2;this.Cube=3;return this};
MO.SG3dContextCapability=function(){this.shaderVersion=this.version=this.vendor=null;this.optionShaderSource=this.optionIndex32=this.optionMaterialMap=this.optionLayout=this.optionInstance=this.optionDebug=!1;this.mergeCount=0;this.attributeCount=null;this.vertexCount=65536;this.shader=this.samplerCompressRgba=this.samplerCompressRgb=this.samplerSize=this.samplerCount=this.varyingCount=this.fragmentConst=this.vertexConst=null;return this};
MO.SG3dContextCapability.prototype.calculateBoneCount=function(b,d){var f=0,f=b%4,f=0!=f?b+4-f:b,h=(this.vertexConst-16)/4;return f>h?h:f};MO.SG3dContextCapability.prototype.calculateInstanceCount=function(b,d){var f=(this.vertexConst-16)/(4*b+4),h=cl;0<d&&(h=Math.min(f,this.vertexCount/d));64<h&&(h=64);return h};MO.SG3dContextCapability.prototype.dispose=function(){this.shader=null;MO.RObject.free(this)};
MO.SG3dLayoutBuffer=function(){this.formatCd=this.index=this.buffer=this.slot=null;this.dispose=MO.SG3dLayoutBuffer_dispose;return this};MO.SG3dLayoutBuffer_dispose=function(){this.formatCd=this.index=this.buffer=this.slot=null};MO.SG3dLayoutSampler=function(){this.slot=null;this.index=-1;this.texture=null;this.dispose=MO.SG3dLayoutSampler_dispose;return this};MO.SG3dLayoutSampler_dispose=function(){this.slot=null;this.index=-1;this.texture=null};
MO.FG3dBuffer=function(b){b=MO.Class.inherits(this,b,MO.FG3dObject);b._code=MO.Class.register(b,new MO.AGetSet("_code"));b._data=MO.Class.register(b,new MO.AGetSet("_data"));b.isValid=MO.Method.virtual(b,"isValid");b.dispose=MO.FG3dBuffer_dispose;return b};MO.FG3dBuffer_dispose=function(){this._data=null;this.__base.FG3dObject.dispose.call(this)};
MO.FG3dContext=function(b){b=MO.Class.inherits(this,b,MO.FGraphicContext);b._optionAlpha=!0;b._optionAntialias=!1;b._viewportRectangle=MO.Class.register(b,new MO.AGetter("_viewportRectangle"));b._capability=MO.Class.register(b,new MO.AGetter("_capability"));b._statistics=MO.Class.register(b,new MO.AGetter("_statistics"));b._fillModeCd=MO.EG3dFillMode.Face;b._optionDepth=!1;b._optionCull=!1;b._depthModeCd=0;b._cullModeCd=0;b._statusBlend=!1;b._blendSourceCd=0;b._blendTargetCd=0;b._program=null;b._storePrograms=
null;b._storeLayouts=null;b._storeBuffers=null;b._storeTextures=null;b._storeTargets=null;b.construct=MO.FG3dContext_construct;b.linkCanvas=MO.FG3dContext_linkCanvas;b.createObject=MO.FG3dContext_createObject;b.createProgram=MO.Method.virtual(b,"createProgram");b.createLayout=MO.Method.virtual(b,"createLayout");b.createVertexBuffer=MO.Method.virtual(b,"createVertexBuffer");b.createIndexBuffer=MO.Method.virtual(b,"createIndexBuffer");b.createFlatTexture=MO.Method.virtual(b,"createFlatTexture");b.createCubeTexture=
MO.Method.virtual(b,"createCubeTexture");b.createRenderTarget=MO.Method.virtual(b,"createRenderTarget");b.setViewport=MO.Method.virtual(b,"setViewport");b.setFillMode=MO.Method.virtual(b,"setFillMode");b.setDepthMode=MO.Method.virtual(b,"setDepthMode");b.setCullingMode=MO.Method.virtual(b,"setCullingMode");b.setBlendFactors=MO.Method.virtual(b,"setBlendFactors");b.setScissorRectangle=MO.Method.virtual(b,"setScissorRectangle");b.setRenderTarget=MO.Method.virtual(b,"setRenderTarget");b.setProgram=MO.Method.virtual(b,
"setProgram");b.bindVertexBuffer=MO.Method.virtual(b,"bindVertexBuffer");b.bindTexture=MO.Method.virtual(b,"bindTexture");b.prepare=MO.FG3dContext_prepare;b.clear=MO.Method.virtual(b,"clear");b.clearColor=MO.Method.virtual(b,"clearColor");b.clearDepth=MO.Method.virtual(b,"clearDepth");b.drawTriangles=MO.Method.virtual(b,"drawTriangles");b.present=MO.Method.virtual(b,"present");b.dispose=MO.FG3dContext_dispose;return b};
MO.FG3dContext_construct=function(){this.__base.FGraphicContext.construct.call(this);this._viewportRectangle=new MO.SRectangle;this._statistics=MO.Class.create(MO.FG3dStatistics);MO.Console.find(MO.FStatisticsConsole).register("graphic3d.context",this._statistics);this._storePrograms=new MO.TObjects;this._storeLayouts=new MO.TObjects;this._storeBuffers=new MO.TObjects;this._storeTextures=new MO.TObjects;this._storeTargets=new MO.TObjects};
MO.FG3dContext_linkCanvas=function(b){this._size.set(b.width,b.height)};MO.FG3dContext_createObject=function(b){b=MO.Class.create(b);b.linkGraphicContext(this);b.setup();return b};MO.FG3dContext_prepare=function(){this._statistics.resetFrame()};
MO.FG3dContext_dispose=function(){var b=this._storePrograms;if(b){for(var d=b.count(),f=0;f<d;f++)b.at(f).dispose();this._storePrograms=MO.Lang.Object.dispose(b)}if(b=this._storeLayouts){d=b.count();for(f=0;f<d;f++)b.at(f).dispose();this._storeLayouts=MO.Lang.Object.dispose(b)}if(b=this._storeBuffers){d=b.count();for(f=0;f<d;f++)b.at(f).dispose();this._storeBuffers=MO.Lang.Object.dispose(b)}if(b=this._storeTextures){d=b.count();for(f=0;f<d;f++)b.at(f).dispose();this._storeTextures=MO.Lang.Object.dispose(b)}if(b=
this._storeTargets){d=b.count();for(f=0;f<d;f++)b.at(f).dispose();this._storeTargets=MO.Lang.Object.dispose(b)}this._program=null;this._viewportRectangle=MO.Lang.Object.dispose(this._viewportRectangle);this._capability=MO.Lang.Object.dispose(this._capability);this._statistics=MO.Lang.Object.dispose(this._statistics);this._handle=this._handleLayout=this._handleInstance=null;this.__base.FGraphicContext.dispose.call(this)};
MO.FG3dCubeTexture=function(b){b=MO.Class.inherits(this,b,MO.FG3dTexture);b.size=0;b.construct=MO.FG3dTexture_construct;b.upload=MO.Method.virtual(b,"upload");b.update=MO.Method.empty;return b};MO.FG3dTexture_construct=function(){this.__base.FG3dTexture.construct();this._textureCd=MO.EG3dTexture.Cube};
MO.FG3dFlatTexture=function(b){b=MO.Class.inherits(this,b,MO.FG3dTexture);b._optionFlipY=MO.Class.register(b,new MO.AGetSet("_optionFlipY"),!1);b._size=MO.Class.register(b,new MO.AGetter("_size"));b.construct=MO.FG3dFlatTexture_construct;b.uploadData=MO.Method.virtual(b,"uploadData");b.upload=MO.Method.virtual(b,"upload");b.update=MO.Method.empty;return b};MO.FG3dFlatTexture_construct=function(){this.__base.FG3dTexture.construct();this._textureCd=MO.EG3dTexture.Flat2d};
MO.FG3dFragmentShader=function(b){return b=MO.Class.inherits(this,b,MO.FG3dShader)};MO.FG3dIndexBuffer=function(b){b=MO.Class.inherits(this,b,MO.FG3dBuffer);b._strideCd=MO.Class.register(b,new MO.AGetSet("_strideCd"),MO.EG3dIndexStride.Uint16);b._count=MO.Class.register(b,new MO.AGetSet("_count"),0);b._drawModeCd=MO.Class.register(b,new MO.AGetSet("_drawModeCd"),MO.EG3dDrawMode.Triangles);b._lineWidth=MO.Class.register(b,new MO.AGetSet("_lineWidth"),1);b.upload=MO.Method.virtual(b,"upload");return b};
MO.FG3dLayout=function(b){b=MO.Class.inherits(this,b,MO.FG3dObject);b._buffers=MO.Class.register(b,new MO.AGetter("_buffers"));b._samplers=MO.Class.register(b,new MO.AGetter("_samplers"));b.linkBuffers=MO.FG3dLayout_linkBuffers;b.bindBuffers=MO.FG3dLayout_bindBuffers;b.linkSamplers=MO.FG3dLayout_linkSamplers;b.bindSamplers=MO.FG3dLayout_bindSamplers;b.unbindSamplers=MO.FG3dLayout_unbindSamplers;b.dispose=MO.FG3dLayout_dispose;return b};MO.FG3dLayout_construct=function(){this.__base.FG3dObject.construct.call(this)};
MO.FG3dLayout_linkBuffers=function(b){if(!b.isEmpty()){var d=this._buffers;d||(d=this._buffers=new MO.TObjects);d.assign(b)}};MO.FG3dLayout_bindBuffers=function(){var b=this._graphicContext,d=this._buffers;if(d)for(var f=d.count(),h=0;h<f;h++){var q=d.at(h);b.bindVertexBuffer(q.slot,q.buffer,q.index,q.formatCd)}};MO.FG3dLayout_linkSamplers=function(b){if(!b.isEmpty()){var d=this._samplers;d||(d=this._samplers=new MO.TObjects);d.assign(b)}};
MO.FG3dLayout_bindSamplers=function(){var b=this._graphicContext,d=this._samplers;if(d)for(var f=d.count(),h=0;h<f;h++){var q=d.at(h);b.bindTexture(q.slot,q.index,q.texture)}};MO.FG3dLayout_unbindSamplers=function(){var b=this._graphicContext,d=this._samplers;if(d)for(var f=d.count(),h=0;h<f;h++){var q=d.at(h);b.bindTexture(q.slot,q.index,null)}};MO.FG3dLayout_dispose=function(){this._buffers=MO.Lang.Object.dispose(this._buffers);this._samplers=MO.Lang.Object.dispose(this._samplers);this.__base.FG3dObject.dispose.call(this)};
MO.FG3dProgram=function(b){b=MO.Class.inherits(this,b,MO.FG3dObject);b._attributes=null;b._parameters=null;b._samplers=null;b._vertexShader=null;b._fragmentShader=null;b.hasAttribute=MO.FG3dProgram_hasAttribute;b.registerAttribute=MO.FG3dProgram_registerAttribute;b.findAttribute=MO.FG3dProgram_findAttribute;b.attributes=MO.FG3dProgram_attributes;b.hasParameter=MO.FG3dProgram_hasParameter;b.registerParameter=MO.FG3dProgram_registerParameter;b.findParameter=MO.FG3dProgram_findParameter;b.parameters=
MO.FG3dProgram_parameters;b.hasSampler=MO.FG3dProgram_hasSampler;b.registerSampler=MO.FG3dProgram_registerSampler;b.findSampler=MO.FG3dProgram_findSampler;b.samplers=MO.FG3dProgram_samplers;b.vertexShader=MO.Method.virtual(b,"vertexShader");b.fragmentShader=MO.Method.virtual(b,"fragmentShader");b.setAttribute=MO.FG3dProgram_setAttribute;b.setParameter=MO.FG3dProgram_setParameter;b.setParameter4=MO.FG3dProgram_setParameter4;b.setSampler=MO.FG3dProgram_setSampler;b.upload=MO.Method.virtual(b,"upload");
b.dispose=MO.FG3dProgram_dispose;return b};MO.FG3dProgram_hasAttribute=function(){var b=this._attributes;return b?!b.isEmpty():!1};MO.FG3dProgram_registerAttribute=function(b){var d=MO.Class.create(MO.FG3dProgramAttribute);d._name=b;this.attributes().set(b,d);return d};MO.FG3dProgram_findAttribute=function(b){return this._attributes?this._attributes.get(b):null};MO.FG3dProgram_attributes=function(){var b=this._attributes;null==b&&(b=this._attributes=new MO.TDictionary);return b};
MO.FG3dProgram_hasParameter=function(){var b=this._parameters;return b?!b.isEmpty():!1};MO.FG3dProgram_registerParameter=function(b,d){var f=MO.Class.create(MO.FG3dProgramParameter);f._name=b;f.formatCd=d;this.parameters().set(b,f);return f};MO.FG3dProgram_findParameter=function(b){return this._parameters?this._parameters.get(b):null};MO.FG3dProgram_parameters=function(){var b=this._parameters;null==b&&(b=this._parameters=new MO.TDictionary);return b};
MO.FG3dProgram_hasSampler=function(){var b=this._samplers;return b?!b.isEmpty():!1};MO.FG3dProgram_registerSampler=function(b){var d=MO.Class.create(MO.FG3dProgramSampler);d._name=b;this.samplers().set(b,d);return d};MO.FG3dProgram_findSampler=function(b){return this._samplers?this._samplers.get(b):null};MO.FG3dProgram_samplers=function(){var b=this._samplers;null==b&&(b=this._samplers=new MO.TDictionary);return b};
MO.FG3dProgram_setAttribute=function(b,d,f){var h=this.findAttribute(b);if(null==h)throw new MO.TError(this,"Bind invalid attribute. (name={1})",b);this._graphicContext.bindVertexBuffer(h._slot,d,0,f)};
MO.FG3dProgram_setParameter=function(b,d,f){var h=this.findParameter(b);if(null==h)throw new MO.TError(this,"Bind invalid parameter. (name={1})",b);var q=null,q=d.constructor;if(q==Float32Array||q==MO.SMatrix3d||q==MO.SPerspectiveMatrix3d)q=d;else if(q==MO.SColor4)q=MO.Lang.TypeArray.float4(),q[0]=d.red,q[1]=d.green,q[2]=d.blue,q[3]=d.alpha;else if(q==MO.SPoint3||q==MO.SVector3)q=MO.Lang.TypeArray.float3(),q[0]=d.x,q[1]=d.y,q[2]=d.z;else if(q==MO.SPoint4||q==MO.SVector4)q=MO.Lang.TypeArray.float4(),
q[0]=d.x,q[1]=d.y,q[2]=d.z,q[3]=d.w;else throw new MO.TError(this,"Bind invalid parameter type. (name={1}, type={2})",b,q);h.attachData(q)&&this._graphicContext.bindConst(null,h._slot,h._formatCd,q,f)};MO.FG3dProgram_setParameter4=function(b,d,f,h,q){var w=MO.Lang.TypeArray.float4();w[0]=d;w[1]=f;w[2]=h;w[3]=q;this.setParameter(b,w,1)};
MO.FG3dProgram_setSampler=function(b,d){var f=this.findSampler(b);if(null==f)throw new MO.TError(this,"Bind invalid sampler. (name={1})",b);this._graphicContext.bindTexture(f._slot,f._index,d)};
MO.FG3dProgram_dispose=function(){this._attributes=MO.Lang.Object.dispose(this._attributes,!0);this._parameters=MO.Lang.Object.dispose(this._parameters,!0);this._samplers=MO.Lang.Object.dispose(this._samplers,!0);this._vertexShader=MO.Lang.Object.dispose(this._vertexShader);this._fragmentShader=MO.Lang.Object.dispose(this._fragmentShader);this.__base.FG3dObject.dispose.call(this)};
MO.FG3dProgramAttribute=function(b){b=MO.Class.inherits(this,b,MO.FObject);b._name=MO.Class.register(b,new MO.AGetter("_name"));b._linker=MO.Class.register(b,new MO.AGetter("_linker"));b._statusUsed=!1;b._slot=null;b._index=-1;b._formatCd=MO.EG3dAttributeFormat.Unknown;b.loadConfig=MO.FG3dProgramAttribute_loadConfig;b.dispose=MO.FG3dProgramAttribute_dispose;return b};
MO.FG3dProgramAttribute_loadConfig=function(b){this._name=b.get("name");this._linker=b.get("linker");this._formatCd=MO.REnum.encode(MO.EG3dAttributeFormat,b.get("format"))};MO.FG3dProgramAttribute_dispose=function(){this._slot=null;this.__base.FObject.dispose.call(this)};
MO.FG3dProgramParameter=function(b){b=MO.Class.inherits(this,b,MO.FObject);b._name=MO.Class.register(b,new MO.AGetter("_name"));b._linker=MO.Class.register(b,new MO.AGetter("_linker"));b._formatCd=MO.EG3dParameterFormat.Unknown;b._define=MO.Class.register(b,new MO.AGetter("_define"));b._statusUsed=!1;b._slot=null;b._size=0;b._buffer=null;b._memory=null;b.attachData=MO.FG3dProgramParameter_attachData;b.loadConfig=MO.FG3dProgramParameter_loadConfig;b.dispose=MO.FG3dProgramParameter_dispose;return b};
MO.FG3dProgramParameter_attachData=function(b){var d=!1,d=b.constructor;if(d==MO.SMatrix3d)d=this._memory,d||(d=this._memory=new Float32Array(16)),d=MO.Lang.Float.attach(d,b._data,16);else if(d==Float32Array){var f=b.length,d=this._memory;d||(d=this._memory=new Float32Array(f));d=MO.Lang.Float.attach(d,b,f)}else throw new MO.TError(this,"Unknown data type.");return d};
MO.FG3dProgramParameter_loadConfig=function(b){this._name=b.get("name");this._linker=b.get("linker");this._formatCd=MO.Lang.Enum.encode(MO.EG3dParameterFormat,b.get("format"));this._define=b.get("define")};MO.FG3dProgramParameter_dispose=function(){this._memory=this._slot=null;this.__base.FObject.dispose.call(this)};
MO.FG3dProgramSampler=function(b){b=MO.Class.inherits(this,b,MO.FObject);b._name=MO.Class.register(b,new MO.AGetter("_name"));b._linker=MO.Class.register(b,new MO.AGetter("_linker"));b._statusUsed=!1;b._formatCd=MO.Class.register(b,new MO.AGetter("_formatCd"),MO.EG3dTexture.Flat2d);b._bind=!0;b._slot=-1;b._index=0;b._source=null;b.loadConfig=MO.FG3dProgramSampler_loadConfig;b.dispose=MO.FG3dProgramSampler_dispose;return b};
MO.FG3dProgramSampler_loadConfig=function(b){this._name=b.get("name");this._linker=b.get("linker");this._bind=MO.Lang.Boolean.parse(b.get("bind","Y"));this._formatCd=MO.Lang.Enum.encode(MO.EG3dTexture,b.get("format","Flat2d"))};MO.FG3dProgramSampler_dispose=function(){this._slot=null;this.__base.FObject.dispose.call(this)};
MO.FG3dRenderTarget=function(b){b=MO.Class.inherits(this,b,MO.FG3dObject);b._size=MO.Class.register(b,new MO.AGetter("_size"));b._color=MO.Class.register(b,new MO.AGetter("_color"));b._textures=null;b.construct=MO.FG3dRenderTarget_construct;b.textures=MO.FG3dRenderTarget_textures;b.dispose=MO.FG3dRenderTarget_dispose;return b};MO.FG3dRenderTarget_construct=function(){this.__base.FG3dObject.construct();this._size=new SSize2;this._color=new SColor4;this._color.set(0,0,0,1)};
MO.FG3dRenderTarget_textures=function(){var b=this._textures;null==b&&(b=this._textures=new TObjects);return b};MO.FG3dRenderTarget_dispose=function(){this._size=RObject.dispose(this._size);this._color=RObject.dispose(this._color);this.__base.dispose.construct()};MO.FG3dShader=function(b){b=MO.Class.inherits(this,b,MO.FG3dObject);b._source=MO.Class.register(b,new MO.AGetter("_source"));b.upload=MO.Method.virtual(b,"upload");return b};
MO.FG3dStatistics=function(b){b=MO.Class.inherits(this,b,MO.FStatistics);b._frameClearCount=MO.Class.register(b,new MO.AGetter("_frameClearCount"),0);b._frameFillModeCount=MO.Class.register(b,new MO.AGetter("_frameFillModeCount"),0);b._frameDepthModeCount=MO.Class.register(b,new MO.AGetter("_frameDepthModeCount"),0);b._frameCullModeCount=MO.Class.register(b,new MO.AGetter("_frameCullModeCount"),0);b._frameBlendModeCount=MO.Class.register(b,new MO.AGetter("_frameBlendModeCount"),0);b._frameProgramCount=
MO.Class.register(b,new MO.AGetter("_frameProgramCount"),0);b._frameConstCount=MO.Class.register(b,new MO.AGetter("_frameConstCount"),0);b._frameConstLength=MO.Class.register(b,new MO.AGetter("_frameConstLength"),0);b._frameBufferCount=MO.Class.register(b,new MO.AGetter("_frameBufferCount"),0);b._frameTextureCount=MO.Class.register(b,new MO.AGetter("_frameTextureCount"),0);b._frameTargetCount=MO.Class.register(b,new MO.AGetter("_frameTargetCount"),0);b._frameDrawCount=MO.Class.register(b,new MO.AGetter("_frameDrawCount"),
0);b._frameTriangleCount=MO.Class.register(b,new MO.AGetter("_frameTriangleCount"),0);b._programTotal=MO.Class.register(b,new MO.AGetter("_programTotal"),0);b._layoutTotal=MO.Class.register(b,new MO.AGetter("_layoutTotal"),0);b._vertexBufferTotal=MO.Class.register(b,new MO.AGetter("_vertexBufferTotal"),0);b._indexBufferTotal=MO.Class.register(b,new MO.AGetter("_indexBufferTotal"),0);b._flatTextureTotal=MO.Class.register(b,new MO.AGetter("_flatTextureTotal"),0);b._cubeTextureTotal=MO.Class.register(b,
new MO.AGetter("_cubeTextureTotal"),0);b._targetTotal=MO.Class.register(b,new MO.AGetter("_targetTotal"),0);b.reset=MO.FG3dStatistics_reset;b.resetFrame=MO.FG3dStatistics_resetFrame;return b};MO.FG3dStatistics_reset=function(){o._programTotal=0;o._layoutTotal=0;o._vertexBufferTotal=0;o._indexBufferTotal=0;o._flatTextureTotal=0;o._cubeTextureTotal=0;o._targetTotal=0};
MO.FG3dStatistics_resetFrame=function(){this._frameDrawCount=this._frameTriangleCount=this._frameTargetCount=this._frameTextureCount=this._frameBufferCount=this._frameConstLength=this._frameConstCount=this._frameProgramCount=this._frameBlendModeCount=this._frameCullModeCount=this._frameDepthModeCount=this._frameFillModeCount=this._frameClearCount=0};
MO.FG3dTexture=function(b){b=MO.Class.inherits(this,b,MO.FG3dObject);b._textureCd=MO.Class.register(b,new MO.AGetter("_textureCd"),MO.EG3dTexture.Unknown);b._filterMinCd=MO.Class.register(b,new MO.AGetSet("_filterMinCd"),MO.EG3dSamplerFilter.Linear);b._filterMagCd=MO.Class.register(b,new MO.AGetSet("_filterMagCd"),MO.EG3dSamplerFilter.Linear);b._wrapS=MO.Class.register(b,new MO.AGetSet("_wrapS"),MO.EG3dSamplerFilter.Unknown);b._wrapT=MO.Class.register(b,new MO.AGetSet("_wrapT"),MO.EG3dSamplerFilter.Unknown);
b._statusLoad=!1;b.isValid=MO.Method.virtual(b,"isValid");b.setFilterCd=MO.FG3dTexture_setFilterCd;b.setWrapCd=MO.FG3dTexture_setWrapCd;return b};MO.FG3dTexture_setFilterCd=function(b,d){this._filterMinCd=b;this._filterMagCd=d};MO.FG3dTexture_setWrapCd=function(b,d){this._wrapS=b;this._wrapT=d};
MO.FG3dVertexBuffer=function(b){b=MO.Class.inherits(this,b,MO.FG3dBuffer);b._formatCd=MO.Class.register(b,new MO.AGetSet("_formatCd"),MO.EG3dAttributeFormat.Unknown);b._stride=MO.Class.register(b,new MO.AGetSet("_stride"),0);b._count=MO.Class.register(b,new MO.AGetSet("_count"),0);b.upload=MO.Method.virtual(b,"upload");return b};MO.FG3dVertexShader=function(b){return b=MO.Class.inherits(this,b,MO.FG3dShader)};
MO.FG3dAutomaticEffect=function(b){b=MO.Class.inherits(this,b,MO.FG3dEffect);b._optionMerge=!1;b._optionBlendMode=!0;b._supportInstance=!1;b._supportLayout=!1;b._supportMaterialMap=!1;b._supportVertexColor=!0;b._supportVertexCoord=!0;b._supportVertexNormal=!0;b._supportVertexNormalFull=!0;b._supportVertexNormalCompress=!1;b._supportSkeleton=!1;b._supportAlpha=!0;b._supportAmbient=!0;b._supportDiffuse=!0;b._supportDiffuseView=!0;b._supportSpecularColor=!0;b._supportSpecularLevel=!0;b._supportSpecularView=
!0;b._supportLight=!0;b._supportReflect=!0;b._supportRefract=!0;b._supportEmissive=!0;b._supportHeight=!0;b._supportEnvironment=!0;b._dynamicSkeleton=!0;b.setup=MO.FG3dAutomaticEffect_setup;b.buildInfo=MO.FG3dAutomaticEffect_buildInfo;b.bindAttributes=MO.FG3dAutomaticEffect_bindAttributes;b.bindSamplers=MO.FG3dAutomaticEffect_bindSamplers;b.bindMaterialSamplers=MO.FG3dAutomaticEffect_bindMaterialSamplers;b.bindMaterial=MO.FG3dAutomaticEffect_bindMaterial;b.drawRenderable=MO.FG3dAutomaticEffect_drawRenderable;
return b};MO.FG3dAutomaticEffect_setup=function(){this._supportLayout=this._graphicContext.capability().optionLayout};
MO.FG3dAutomaticEffect_buildInfo=function(b,d){var f=this._graphicContext.capability(),h=new MO.TString;h.append(d.techniqueModeCode);b.set("technique.mode",d.techniqueModeCode);if(this._optionMerge=d.optionMerge){var q=d.mergeCount,w=d.mergeStride;h.append("|OI"+q);b.setBoolean("option.instance",!0);b.set("instance.count",q);b.set("instance.length",w*q)}f.optionMaterialMap&&(h.append("|OM"),b.setBoolean("option.material.map",!0),this._supportMaterialMap=!0);d.optionNormalInvert&&(h.append("|ON"),
b.setBoolean("option.normal.invert",!0),this._supportNormalInvert=!0);d.optionColor&&(h.append("|OC"),b.setBoolean("option.color",!0),this.optionAmbient=!0);d.optionAmbient&&(h.append("|OA"),b.setBoolean("option.ambient",!0),this.optionAmbient=!0);d.optionDiffuse&&(h.append("|OD"),b.setBoolean("option.diffuse",!0),this.optionDiffuse=!0);d.optionSpecular&&(h.append("|OS"),b.setBoolean("option.specular",!0),this.optionSpecular=!0);d.optionReflect&&(h.append("|ORL"),b.setBoolean("option.reflect",!0),
this.optionReflect=!0);d.optionRefract&&(h.append("|ORF"),b.setBoolean("option.refract",!0),this.optionRefract=!0);q=d.attributeContains(MO.EG3dAttribute.Color);if(this._dynamicVertexColor=this._supportVertexColor&&q)h.append("|AC"),b.setBoolean("vertex.attribute.color",!0);q=d.attributeContains(MO.EG3dAttribute.Coord);if(this._dynamicVertexCoord=this._supportVertexCoord&&q)h.append("|AD"),b.setBoolean("vertex.attribute.coord",!0);q=d.attributeContains(MO.EG3dAttribute.Normal);if(this._dynamicVertexNormal=
this._supportVertexNormal&&q)h.append("|AN"),b.setBoolean("vertex.attribute.normal",!0);var w=d.attributeContains(MO.EG3dAttribute.Binormal),z=d.attributeContains(MO.EG3dAttribute.Tangent);if(this._dynamicVertexNormalFull=this._supportVertexNormalFull&&q&&w&&z)h.append("|ANF"),b.setBoolean("vertex.attribute.normal.full",!0);if(this._dynamicVertexNormalCompress=d.optionNormalCompress)h.append("|ANC"),b.setBoolean("vertex.attribute.normal.compress",!0);if(this._dynamicInstance=this._supportInstance&&
f.optionInstance)h.append("|SI"),d&&b.setBoolean("support.instance",!0);if(this._dynamicSkeleton=this._supportSkeleton)h.append("|SS"),d&&b.setBoolean("support.skeleton",!0);q=d.samplerContains(MO.EG3dSampler.Diffuse);(this._dynamicAlpha=this._supportAlpha)?(h.append("|RA"),d&&b.setBoolean("support.alpha",!0),this._optionBlendMode=!0):this._optionBlendMode=!1;if(this._dynamicAmbient=this._supportAmbient)h.append("|TA"),d&&b.setBoolean("support.ambient",!0),q&&(h.append("|TAS"),d&&b.setBoolean("support.ambient.sampler",
!0));d.samplerContains(MO.EG3dSampler.Alpha)&&b.setBoolean("support.alpha.sampler",!0);q=d.samplerContains(MO.EG3dSampler.Normal);this._dynamicDiffuse=this._supportDiffuse&&(this._dynamicVertexNormal||q);this._supportDiffuse&&(d&&b.setBoolean("support.diffuse",!0),q?(h.append("|TDD"),d&&(b.setBoolean("support.dump",!0),b.setBoolean("support.diffuse.dump",!0))):this._dynamicVertexNormal&&(h.append("|TDN"),d&&b.setBoolean("support.diffuse.normal",!0)));this._dynamicDiffuseView=this._supportDiffuseView&&
(this._dynamicVertexNormal||q);this._supportDiffuseView&&(d&&b.setBoolean("support.diffuse.view",!0),q?(h.append("|TDVD"),d&&(b.setBoolean("support.dump",!0),b.setBoolean("support.diffuse.view.dump",!0))):this._dynamicVertexNormal&&(h.append("|TDVN"),d&&b.setBoolean("support.diffuse.view.normal",!0)));q=d.samplerContains(MO.EG3dSampler.SpecularColor);w=d.samplerContains(MO.EG3dSampler.SpecularLevel);this._dynamicSpecularColor=this._supportSpecularColor&&q;this._dynamicSpecularLevel=this._supportSpecularLevel&&
w;(this._dynamicSpecularColor||this._dynamicSpecularLevel)&&this._dynamicVertexNormal&&(h.append("|TS"),d&&b.setBoolean("support.specular",!0),this._dynamicSpecularColor&&(h.append("|TSC"),d&&b.setBoolean("support.specular.color",!0)),this._dynamicSpecularLevel?(h.append("|TSL"),d&&b.setBoolean("support.specular.level",!0)):(h.append("|NSL"),d&&b.setBoolean("support.specular.normal",!0)));(this._dynamicSpecularView=this._supportSpecularView)&&this._dynamicVertexNormal&&(h.append("|TSV"),d&&b.setBoolean("support.specular.view",
!0),this._dynamicSpecularColor&&(h.append("|TSVC"),d&&b.setBoolean("support.specular.view.color",!0)),this._dynamicSpecularLevel?(h.append("|TSVL"),d&&b.setBoolean("support.specular.view.level",!0)):(h.append("|NSVL"),d&&b.setBoolean("support.specular.view.normal",!0)));q=d.samplerContains(MO.EG3dSampler.Light);if(this._dynamicLight=this._supportLight&&q)h.append("|TL"),d&&(b.setBoolean("support.sampler.light",!0),b.setBoolean("support.light",!0));q=d.samplerContains(MO.EG3dSampler.Reflect);if(this._dynamicReflect=
this._supportReflect&&q)h.append("|TRL"),d&&(b.setBoolean("support.sampler.light",!0),b.setBoolean("support.reflect",!0));q=d.samplerContains(MO.EG3dSampler.Refract);if(this._dynamicRefract=this._supportRefract&&q)h.append("|TRF"),d&&(b.setBoolean("support.sampler.light",!0),b.setBoolean("support.refract",!0));q=d.samplerContains(MO.EG3dSampler.Emissive);if(this._dynamicEmissive=this._supportEmissive&&q)h.append("|TLE"),d&&(b.setBoolean("support.sampler.light",!0),b.setBoolean("support.emissive",
!0));q=d.samplerContains(MO.EG3dSampler.Height);if(this._dynamicHeight=this._supportHeight&&q)h.append("|TH"),d&&b.setBoolean("support.height",!0);q=d.samplerContains(MO.EG3dSampler.Environment);if(this._dynamicEnvironment=this._supportEnvironment&&q)h.append("|TE"),d&&b.setBoolean("support.environment",!0);this._dynamicSkeleton&&(f=f.calculateBoneCount(d.vertexBoneCount,d.vertexCount),h.append("|B"+f),b.set("bone.count",f),b.set("bone.array.count",3*f),b.setBoolean("support.bone.weight.1",!0),b.setBoolean("support.bone.weight.2",
!0),b.setBoolean("support.bone.weight.3",!0),b.setBoolean("support.bone.weight.4",!0));b.code=h.flush()};MO.FG3dAutomaticEffect_bindAttributes=function(b){var d=this._program;if(d.hasAttribute())for(var f=d.attributes(),h=f.count(),q=0;q<h;q++){var w=f.at(q);if(w._statusUsed){var z=b.findVertexBuffer(w._linker);d.setAttribute(w._name,z,z._formatCd)}}};
MO.FG3dAutomaticEffect_bindSamplers=function(b){var d=this._program;this._supportMaterialMap&&d.setSampler("fs_material",region.materialMap().texture());if(d.hasSampler())for(var f=d.samplers(),h=f.count(),q=0;q<h;q++){var w=f.at(q);if(w._bind&&w._statusUsed){var z=w.linker(),z=b.findTexture(z);d.setSampler(w.name(),z.texture())}}};
MO.FG3dAutomaticEffect_bindMaterialSamplers=function(b,d){var f=this._program;if(f.hasSampler())for(var h=f.samplers(),q=h.count(),w=0;w<q;w++){var z=h.at(w);if(z._bind&&z._statusUsed){var A=z.linker(),A=d.findBitmap(A);f.setSampler(z.name(),A.texture())}}};
MO.FG3dAutomaticEffect_bindMaterial=function(b){var d=this._graphicContext;b=b.info();b.optionDepth?d.setDepthMode(this._stateDepth,this._stateDepthCd):d.setDepthMode(!1);b.optionAlpha?d.setBlendFactors(this._stateBlend,this._stateBlendSourceCd,this._stateBlendTargetCd):d.setBlendFactors(!1);b.optionDouble?d.setCullingMode(!1):d.setCullingMode(this._stateDepth,this._stateCullCd)};
MO.FG3dAutomaticEffect_drawRenderable=function(b,d){var f=this._graphicContext,h=d.activeInfo(),q=h.layout;q?(this._supportLayout?q.active():q.bindBuffers(),q.bindSamplers()):(q=h.layout=f.createLayout(),this._supportLayout?(q.bind(),this.bindAttributes(d),q.unbind(),q.active()):(f.recordBegin(),this.bindAttributes(d),f.recordEnd(),q.linkBuffers(f.recordBuffers())),f.recordBegin(),this.bindSamplers(d),f.recordEnd(),q.linkSamplers(f.recordSamplers()));var h=0,w=d.indexBuffers();w&&(h=w.count());if(1<
h)for(var z=d.materials(),A=0;A<h;A++){var B=w.at(A);if(z){var C=z.at(A);C&&this.bindMaterialSamplers(d,C)}f.drawTriangles(B)}else if(1==h)B=w.first(),f.drawTriangles(B);else throw new MO.TError(this,"Index buffer is not found.");this._supportLayout&&q.deactive()};MO.FG3dSelectAutomaticEffect=function(b){b=MO.Class.inherits(this,b,MO.FG3dAutomaticEffect);b._code="select.automatic";b.drawRenderable=MO.FG3dSelectAutomaticEffect_drawRenderable;return b};
MO.FG3dSelectAutomaticEffect_drawRenderable=function(b,d,f){var h=this._graphicContext,q=h.size(),w=this._program,z=b._selectX,A=b._selectY,B=d.material(),C=B.info();this.bindMaterial(B);w.setParameter("vc_model_matrix",d.currentMatrix());w.setParameter("vc_vp_matrix",b.calculate(MO.EG3dRegionParameter.CameraViewProjectionMatrix));w.setParameter4("vc_offset",q.width,q.height,1-z/q.width*2,A/q.height*2-1);b=f+1;w.setParameter4("fc_index",(b&255)/255,(b>>8&255)/255,(b>>16&255)/255,C.alphaBase);this.bindAttributes(d);
this.bindSamplers(d);d=d.indexBuffers();w=d.count();for(b=0;b<w;b++)C=d.at(b),h.drawTriangles(C)};MO.FG3dSelectPass=function(b){b=MO.Class.inherits(this,b,MO.FG3dTechniquePass);b._code="select";b._texture=MO.Class.register(b,new MO.AGetter("_texture"));b._renderTarget=null;b._position=null;b._data=null;b.construct=MO.FG3dSelectPass_construct;b.setup=MO.FG3dSelectPass_setup;b.drawRegion=MO.FG3dSelectPass_drawRegion;return b};
MO.FG3dSelectPass_construct=function(){this.__base.FG3dTechniquePass.construct.call(this);this._data=new Uint8Array(4);this._position=new MO.SPoint2};
MO.FG3dSelectPass_setup=function(){this.__base.FG3dTechniquePass.setup.call(this);var b=this._graphicContext,d=this._texture=b.createFlatTexture();d.setFilterCd(MO.EG3dSamplerFilter.Nearest,MO.EG3dSamplerFilter.Nearest);d.setWrapCd(MO.EG3dSamplerFilter.ClampToEdge,MO.EG3dSamplerFilter.ClampToEdge);b=this._renderTarget=b.createRenderTarget();b.size().set(1,1);b.textures().push(d);b.build()};
MO.FG3dSelectPass_drawRegion=function(b){var d=this._graphicContext,f=d.handle();d.setRenderTarget(this._renderTarget);d.clear(0,0,0,0,1,1);var h=b.allRenderables();this.activeEffects(b,h);for(var q=h.count(),w=0;w<q;w++){var z=h.get(w),A=z.activeEffect();d.setProgram(A.program());var B=z.display();B?B._optionFace||A.drawRenderable(b,z,w):A.drawRenderable(b,z,w)}d.clearDepth(1);for(w=0;w<q;w++)z=h.get(w),A=z.activeEffect(),d.setProgram(A.program()),(B=z.display())&&B._optionFace&&A.drawRenderable(b,
z,w);f.readPixels(0,0,1,1,f.RGBA,f.UNSIGNED_BYTE,this._data);b=this._data[0]+(this._data[1]<<8)+(this._data[2]<<16);this._selectRenderable=null;0!=b&&(this._selectRenderable=h.get(b-1))};MO.FG3dSelectSkeletonEffect=function(b){b=MO.Class.inherits(this,b,MO.FG3dAutomaticEffect);b._code="select.automatic";b.drawRenderable=MO.FG3dSelectSkeletonEffect_drawRenderable;return b};
MO.FG3dSelectSkeletonEffect_drawRenderable=function(b,d,f){var h=this._graphicContext,q=h.size(),w=this._program,z=b._selectX,A=b._selectY,B=d.material(),C=B.info();this.bindMaterial(B);w.setParameter("vc_model_matrix",d.currentMatrix());w.setParameter("vc_vp_matrix",b.calculate(MO.EG3dRegionParameter.CameraViewProjectionMatrix));w.setParameter4("vc_offset",q.width,q.height,1-z/q.width*2,A/q.height*2-1);b=f+1;w.setParameter4("fc_index",(b&255)/255,(b>>8&255)/255,(b>>16&255)/255,C.alphaBase);this.bindAttributes(d);
this.bindSamplers(d);h.drawTriangles(d.indexBuffer())};MO.FG3dSelectTechnique=function(b){b=RClass.inherits(this,b,FG3dTechnique);b._code="select";b._passSelect=MO.Class.register(b,new MO.AGetter("_passSelect"));b.setup=MO.FG3dSelectTechnique_setup;b.test=MO.FG3dSelectTechnique_test;return b};
MO.FG3dSelectTechnique_setup=function(){this.__base.FG3dTechnique.setup.call(this);this.registerMode(MO.EG3dTechniqueMode.Result);var b=this._passSelect=MO.Class.create(MO.FG3dSelectPass);b.linkGraphicContext(this);b.setup();this._passes.push(b)};MO.FG3dSelectTechnique_test=function(b,d,f){b._selectX=d;b._selectY=f;b.setTechnique(this);this.drawRegion(b);return this._passSelect._selectRenderable};
MO.FWglContext=function(b){b=MO.Class.inherits(this,b,MO.FG3dContext);b._handle=MO.Class.register(b,new MO.AGetter("_handle"));b._handleInstance=null;b._handleLayout=null;b._handleSamplerS3tc=null;b._handleDebugShader=null;b._activeRenderTarget=null;b._activeTextureSlot=null;b._parameters=null;b._extensions=null;b._statusRecord=!1;b._recordBuffers=MO.Class.register(b,new MO.AGetter("_recordBuffers"));b._recordSamplers=MO.Class.register(b,new MO.AGetter("_recordSamplers"));b._statusScissor=!1;b._data9=
null;b._data16=null;b.construct=MO.FWglContext_construct;b.isValid=MO.FWglContext_isValid;b.linkCanvas=MO.FWglContext_linkCanvas;b.parameter=MO.FWglContext_parameter;b.parameters=MO.FWglContext_parameters;b.extension=MO.FWglContext_extension;b.extensions=MO.FWglContext_extensions;b.recordBegin=MO.FWglContext_recordBegin;b.recordEnd=MO.FWglContext_recordEnd;b.createProgram=MO.FWglContext_createProgram;b.createLayout=MO.FWglContext_createLayout;b.createVertexBuffer=MO.FWglContext_createVertexBuffer;
b.createIndexBuffer=MO.FWglContext_createIndexBuffer;b.createFlatTexture=MO.FWglContext_createFlatTexture;b.createCubeTexture=MO.FWglContext_createCubeTexture;b.createRenderTarget=MO.FWglContext_createRenderTarget;b.setViewport=MO.FWglContext_setViewport;b.setFillMode=MO.FWglContext_setFillMode;b.setDepthMode=MO.FWglContext_setDepthMode;b.setCullingMode=MO.FWglContext_setCullingMode;b.setBlendFactors=MO.FWglContext_setBlendFactors;b.setScissorRectangle=MO.FWglContext_setScissorRectangle;b.setRenderTarget=
MO.FWglContext_setRenderTarget;b.setProgram=MO.FWglContext_setProgram;b.bindConst=MO.FWglContext_bindConst;b.bindVertexBuffer=MO.FWglContext_bindVertexBuffer;b.bindTexture=MO.FWglContext_bindTexture;b.clear=MO.FWglContext_clear;b.clearColor=MO.FWglContext_clearColor;b.clearDepth=MO.FWglContext_clearDepth;b.readPixels=MO.FWglContext_readPixels;b.drawTriangles=MO.FWglContext_drawTriangles;b.present=MO.FWglContext_present;b.checkError=MO.FWglContext_checkError;b.saveConfig=MO.FWglContext_saveConfig;
b.dispose=MO.FWglContext_dispose;return b};MO.FWglContext_construct=function(){this.__base.FG3dContext.construct.call(this);this._capability=new MO.SG3dContextCapability;this._data9=new Float32Array(9);this._data16=new Float32Array(16);this._recordBuffers=new MO.TObjects;this._recordSamplers=new MO.TObjects};MO.FWglContext_isValid=function(){return this._handle};
MO.FWglContext_linkCanvas=function(b){this.__base.FG3dContext.linkCanvas.call(this,b);this._hCanvas=b;if(b.getContext){var d={};d.alpha=this._optionAlpha;d.antialias=this._optionAntialias;for(var f=null,h=["experimental-webgl2","experimental-webgl","webgl","webkit-3d","moz-webgl"],q=h.length,w=0;w<q&&!(f=b.getContext(h[w],d));w++);if(!f)return f=new MO.SEvent(this),f.code=MO.EGraphicError.UnsupportWebGL,f.message="Current browser can't support WebGL technique.",MO.Window.processDeviceError(f),f.dispose(),
!1;this._handle=f;this._contextAttributes=f.getContextAttributes()}else return f=new MO.SEvent(this),f.code=MO.EGraphicError.UnsupportWebGL,f.message="Canvas can't support WebGL technique.",MO.Window.processDeviceError(f),f.dispose(),!1;f=this._handle;this.setDepthMode(!0,MO.EG3dDepthMode.LessEqual);this.setCullingMode(!0,MO.EG3dCullMode.Front);b=this._capability;b.vendor=f.getParameter(f.VENDOR);b.version=f.getParameter(f.VERSION);b.shaderVersion=f.getParameter(f.SHADING_LANGUAGE_VERSION);b.attributeCount=
f.getParameter(f.MAX_VERTEX_ATTRIBS);b.vertexConst=f.getParameter(f.MAX_VERTEX_UNIFORM_VECTORS);b.varyingCount=f.getParameter(f.MAX_VARYING_VECTORS);b.fragmentConst=f.getParameter(f.MAX_FRAGMENT_UNIFORM_VECTORS);b.samplerCount=f.getParameter(f.MAX_VERTEX_TEXTURE_IMAGE_UNITS);b.samplerSize=f.getParameter(f.MAX_TEXTURE_SIZE);if(d=this._handleInstance=f.getExtension("ANGLE_instanced_arrays"))b.optionInstance=!0;b.mergeCount=parseInt((b.vertexConst-32)/4);if(d=this._handleLayout=f.getExtension("OES_vertex_array_object"))b.optionLayout=
!0;if(d=f.getExtension("OES_element_index_uint"))b.optionIndex32=!0;if(d=this._handleSamplerS3tc=f.getExtension("WEBGL_compressed_texture_s3tc"))b.samplerCompressRgb=d.COMPRESSED_RGB_S3TC_DXT1_EXT,b.samplerCompressRgba=d.COMPRESSED_RGBA_S3TC_DXT5_EXT;d=b.shader={};h=d.vertexPrecision={};f.getShaderPrecisionFormat&&(h.floatLow=f.getShaderPrecisionFormat(f.VERTEX_SHADER,f.LOW_FLOAT),h.floatMedium=f.getShaderPrecisionFormat(f.VERTEX_SHADER,f.MEDIUM_FLOAT),h.floatHigh=f.getShaderPrecisionFormat(f.VERTEX_SHADER,
f.HIGH_FLOAT),h.intLow=f.getShaderPrecisionFormat(f.VERTEX_SHADER,f.LOW_INT),h.intMedium=f.getShaderPrecisionFormat(f.VERTEX_SHADER,f.MEDIUM_INT),h.intHigh=f.getShaderPrecisionFormat(f.VERTEX_SHADER,f.HIGH_INT));d=d.fragmentPrecision={};f.getShaderPrecisionFormat&&(d.floatLow=f.getShaderPrecisionFormat(f.FRAGMENT_SHADER,f.LOW_FLOAT),d.floatMedium=f.getShaderPrecisionFormat(f.FRAGMENT_SHADER,f.MEDIUM_FLOAT),d.floatHigh=f.getShaderPrecisionFormat(f.FRAGMENT_SHADER,f.HIGH_FLOAT),d.intLow=f.getShaderPrecisionFormat(f.FRAGMENT_SHADER,
f.LOW_INT),d.intMedium=f.getShaderPrecisionFormat(f.FRAGMENT_SHADER,f.MEDIUM_INT),d.intHigh=f.getShaderPrecisionFormat(f.FRAGMENT_SHADER,f.HIGH_INT));if(d=this._handleDebugShader=f.getExtension("WEBGL_debug_shaders"))b.optionShaderSource=!0;return!0};MO.FWglContext_parameter=function(b){return this.parameters()[b]};
MO.FWglContext_parameters=function(){var b=this._parameters;if(b)return b;for(var d="ACTIVE_TEXTURE ALIASED_LINE_WIDTH_RANGE ALIASED_POINT_SIZE_RANGE ALPHA_BITS ARRAY_BUFFER_BINDING BLEND BLEND_COLOR BLEND_DST_ALPHA BLEND_DST_RGB BLEND_EQUATION_ALPHA BLEND_EQUATION_RGB BLEND_SRC_ALPHA BLEND_SRC_RGB BLUE_BITS COLOR_CLEAR_VALUE COLOR_WRITEMASK COMPRESSED_TEXTURE_FORMATS CULL_FACE CULL_FACE_MODE CURRENT_PROGRAM DEPTH_BITS DEPTH_CLEAR_VALUE DEPTH_FUNC DEPTH_RANGE DEPTH_TEST DEPTH_WRITEMASK DITHER ELEMENT_ARRAY_BUFFER_BINDING FRAMEBUFFER_BINDING FRONT_FACE GENERATE_MIPMAP_HINT GREEN_BITS IMPLEMENTATION_COLOR_READ_FORMAT IMPLEMENTATION_COLOR_READ_TYPE LINE_WIDTH MAX_COMBINED_TEXTURE_IMAGE_UNITS MAX_CUBE_MAP_TEXTURE_SIZE MAX_FRAGMENT_UNIFORM_VECTORS MAX_RENDERBUFFER_SIZE MAX_TEXTURE_IMAGE_UNITS MAX_TEXTURE_SIZE MAX_VARYING_VECTORS MAX_VERTEX_ATTRIBS MAX_VERTEX_TEXTURE_IMAGE_UNITS MAX_VERTEX_UNIFORM_VECTORS MAX_VIEWPORT_DIMS PACK_ALIGNMENT POLYGON_OFFSET_FACTOR POLYGON_OFFSET_FILL POLYGON_OFFSET_UNITS RED_BITS RENDERBUFFER_BINDING RENDERER SAMPLE_BUFFERS SAMPLE_COVERAGE_INVERT SAMPLE_COVERAGE_VALUE SAMPLES SCISSOR_BOX SCISSOR_TEST SHADING_LANGUAGE_VERSION STENCIL_BACK_FAIL STENCIL_BACK_FUNC STENCIL_BACK_PASS_DEPTH_FAIL STENCIL_BACK_PASS_DEPTH_PASS STENCIL_BACK_REF STENCIL_BACK_VALUE_MASK STENCIL_BACK_WRITEMASK STENCIL_BITS STENCIL_CLEAR_VALUE STENCIL_FAIL STENCIL_FUNC STENCIL_PASS_DEPTH_FAIL STENCIL_PASS_DEPTH_PASS STENCIL_REF STENCIL_TEST STENCIL_VALUE_MASK STENCIL_WRITEMASK SUBPIXEL_BITS TEXTURE_BINDING_2D TEXTURE_BINDING_CUBE_MAP UNPACK_ALIGNMENT UNPACK_COLORSPACE_CONVERSION_WEBGL UNPACK_FLIP_Y_WEBGL UNPACK_PREMULTIPLY_ALPHA_WEBGL VENDOR VERSION VIEWPORT".split(" "),f=
this._handle,h=d.length,b={},q=0;q<h;q++){var w=d[q];b[w]=f.getParameter(f[w])}if(d=f.getExtension("WEBGL_debug_renderer_info"))b.UNMASKED_RENDERER_WEBGL=f.getParameter(d.UNMASKED_RENDERER_WEBGL),b.UNMASKED_VENDOR_WEBGL=f.getParameter(d.UNMASKED_VENDOR_WEBGL);return this._parameters=b};MO.FWglContext_extension=function(b){return this.extensions()[b]};
MO.FWglContext_extensions=function(){var b=this._extensions;if(!b)for(var b=this._extensions={},d=this._handle,f=d.getSupportedExtensions(),h=f.length,q=0;q<h;q++){var w=f[q];b[w]=d.getExtension(w)}return b};MO.FWglContext_recordBegin=function(){this._recordBuffers.clear();this._recordSamplers.clear();this._statusRecord=!0};MO.FWglContext_recordEnd=function(){this._statusRecord=!1};
MO.FWglContext_createProgram=function(){var b=this.createObject(MO.FWglProgram);this._storePrograms.push(b);this._statistics._programTotal++;return b};MO.FWglContext_createLayout=function(){var b=MO.Class.create(MO.FWglLayout);b.linkGraphicContext(this);this._capability.optionLayout&&b.setup();this._storeLayouts.push(b);this._statistics._layoutTotal++;return b};
MO.FWglContext_createVertexBuffer=function(b){b=this.createObject(MO.Runtime.nvl(b,MO.FWglVertexBuffer));b.linkGraphicContext(this);b.setup();this._storeBuffers.push(b);this._statistics._vertexBufferTotal++;return b};MO.FWglContext_createIndexBuffer=function(b){b=this.createObject(MO.Runtime.nvl(b,MO.FWglIndexBuffer));this._storeBuffers.push(b);this._statistics._indexBufferTotal++;return b};
MO.FWglContext_createFlatTexture=function(b){b=this.createObject(MO.Runtime.nvl(b,MO.FWglFlatTexture));this._storeTextures.push(b);this._statistics._flatTextureTotal++;return b};MO.FWglContext_createCubeTexture=function(b){b=this.createObject(MO.Runtime.nvl(b,MO.FWglCubeTexture));this._storeTextures.push(b);this._statistics._cubeTextureTotal++;return b};
MO.FWglContext_createRenderTarget=function(b){this.createObject(MO.Runtime.nvl(b,MO.FWglRenderTarget));this._storeTargets.push(target);this._statistics._targetTotal++;return target};MO.FWglContext_setViewport=function(b,d,f,h){this._size.set(f,h);this._viewportRectangle.set(b,d,f,h);this._handle.viewport(b,d,f,h)};
MO.FWglContext_setFillMode=function(b){var d=this._handle;if(this._fillModeCd==b)return!1;this._statistics._frameFillModeCount++;switch(b){case EG3dFillMode.Point:d.polygonMode(d.FRONT_AND_BACK,d.POINT);break;case EG3dFillMode.Line:d.polygonMode(d.FRONT_AND_BACK,d.LINE);break;case EG3dFillMode.Face:d.polygonMode(d.FRONT,d.FILL);break;default:throw new MO.TError("Invalid parameter. (fill_mode={1})",b);}this._fillModeCd=b;return!0};
MO.FWglContext_setDepthMode=function(b,d){var f=this._handle;if(this._optionDepth==b&&this._depthModeCd==d)return!1;this._statistics._frameDepthModeCount++;this._optionDepth!=b&&(b?f.enable(f.DEPTH_TEST):f.disable(f.DEPTH_TEST),this._optionDepth=b);if(b&&this._depthModeCd!=d){var h=MO.RWglUtility.convertDepthMode(f,d);f.depthFunc(h);this._depthModeCd=d}return!0};
MO.FWglContext_setCullingMode=function(b,d){var f=this._handle;if(this._optionCull==b&&this._cullModeCd==d)return!1;this._statistics._frameCullModeCount++;this._optionCull!=b&&(b?f.enable(f.CULL_FACE):f.disable(f.CULL_FACE),this._optionCull=b);if(b&&this._cullModeCd!=d){var h=MO.RWglUtility.convertCullMode(f,d);f.cullFace(h);this._cullModeCd=d}return!0};
MO.FWglContext_setBlendFactors=function(b,d,f){var h=this._handle;if(this._statusBlend==b&&this._blendSourceCd==d&&this._blendTargetCd==f)return!1;this._statistics._frameBlendModeCount++;this._statusBlend!=b&&(b?h.enable(h.BLEND):(h.disable(h.BLEND),this._blendTargetCd=this._blendSourceCd=0),this._statusBlend=b);if(b&&(this._blendSourceCd!=d||this._blendTargetCd!=f)){b=MO.RWglUtility.convertBlendFactors(h,d);var q=MO.RWglUtility.convertBlendFactors(h,f);h.blendFunc(b,q);this._blendSourceCd=d;this._blendTargetCd=
f}return!0};MO.FWglContext_setScissorRectangle=function(b,d,f,h){var q=this._handle,w=0<f&&0<h;this._statusScissor!=w&&(w?q.enable(q.SCISSOR_TEST):q.disable(q.SCISSOR_TEST),this._statusScissor=w);w&&q.scissor(b,d,f,h)};
MO.FWglContext_setRenderTarget=function(b){var d=this._handle;if(this._activeRenderTarget!=b){this._statistics._frameTargetCount++;var f=!0;if(null==b){d.bindFramebuffer(d.FRAMEBUFFER,null);f=this.checkError("glBindFramebuffer","Bind frame buffer. (frame_buffer={1})",null);if(!f)return f;d.viewport(0,0,this._size.width,this._size.height)}else{d.bindFramebuffer(d.FRAMEBUFFER,b._handle);f=this.checkError("glBindFramebuffer","Bind frame buffer. (frame_buffer={1})",b._handle);if(!f)return f;var h=b.size();
d.viewport(0,0,h.width,h.height)}this._activeRenderTarget=b;return f}};MO.FWglContext_setProgram=function(b){var d=this._handle;if(this._program!=b)return this._statistics._frameProgramCount++,b?d.useProgram(b._handle):d.useProgram(null),this._program=b,this.checkError("useProgram","Set program failure. (program={1}, program_native={2})",b,b._handle)};
MO.FWglContext_bindConst=function(b,d,f,h,q){var w=this._handle,z=!0;this._statistics._frameConstCount++;switch(f){case MO.EG3dParameterFormat.Float1:w.uniform1fv(d,h);this._statistics._frameConstLength+=h.byteLength;z=this.checkError("uniform1fv","Bind const data failure. (shader_cd={1}, slot={2}, data={3}, count={4})",b,d,h,q);break;case MO.EG3dParameterFormat.Float2:w.uniform2fv(d,h);this._statistics._frameConstLength+=h.byteLength;z=this.checkError("uniform2fv","Bind const data failure. (shader_cd={1}, slot={2}, data={3}, count={4})",
b,d,h,q);break;case MO.EG3dParameterFormat.Float3:w.uniform3fv(d,h);this._statistics._frameConstLength+=h.byteLength;z=this.checkError("uniform3fv","Bind const data failure. (shader_cd={1}, slot={2}, data={3}, count={4})",b,d,h,q);break;case MO.EG3dParameterFormat.Float4:w.uniform4fv(d,h);this._statistics._frameConstLength+=h.byteLength;z=this.checkError("uniform4fv","Bind const data failure. (shader_cd={1}, slot={2}, data={3}, count={4})",b,d,h,q);break;case MO.EG3dParameterFormat.Float3x3:f=this._data9;
f[0]=h[0];f[1]=h[4];f[2]=h[8];f[3]=h[1];f[4]=h[5];f[5]=h[9];f[6]=h[2];f[7]=h[6];f[8]=h[10];w.uniformMatrix3fv(d,w.FALSE,f);this._statistics._frameConstLength+=f.byteLength;z=this.checkError("uniformMatrix3fv","Bind const matrix3x3 failure. (shader_cd={1}, slot={2}, data={3}, count={4})",b,d,h,q);break;case MO.EG3dParameterFormat.Float4x4:if(h.constructor==Float32Array)f=h;else if(h.writeData)f=this._data16,h.writeData(f,0);else throw new MO.TError("Unknown data type.");w.uniformMatrix4fv(d,w.FALSE,
f);this._statistics._frameConstLength+=f.byteLength;z=this.checkError("uniformMatrix4fv","Bind const matrix4x4 failure. (shader_cd={1}, slot={2}, data={3}, count={4})",b,d,h,q);break;default:throw new MO.TError(this,"Unknown format type. (format_cd={1})",f);}return z};
MO.FWglContext_bindVertexBuffer=function(b,d,f,h){var q=this._handle,w=!0;this._statistics._frameBufferCount++;this._statusRecord&&(w=new MO.SG3dLayoutBuffer,w.slot=b,w.buffer=d,w.index=f,w.formatCd=h,this._recordBuffers.push(w));w=null;null!=d&&(w=d._handle);q.bindBuffer(q.ARRAY_BUFFER,w);w=this.checkError("bindBuffer","Bind buffer. (buffer_id=%d)",w);if(!w)return w;if(d){if(q.enableVertexAttribArray(b),w=this.checkError("enableVertexAttribArray","Enable vertex attribute array. (slot=%d)",b),!w)return w}else return q.disableVertexAttribArray(b),
w=this.checkError("disableVertexAttribArray","Disable vertex attribute array. (slot=%d)",b);d=d._stride;switch(h){case MO.EG3dAttributeFormat.Float1:q.vertexAttribPointer(b,1,q.FLOAT,!1,d,f);break;case MO.EG3dAttributeFormat.Float2:q.vertexAttribPointer(b,2,q.FLOAT,!1,d,f);break;case MO.EG3dAttributeFormat.Float3:q.vertexAttribPointer(b,3,q.FLOAT,!1,d,f);break;case MO.EG3dAttributeFormat.Float4:q.vertexAttribPointer(b,4,q.FLOAT,!1,d,f);break;case MO.EG3dAttributeFormat.Byte4:q.vertexAttribPointer(b,
4,q.UNSIGNED_BYTE,!1,d,f);break;case MO.EG3dAttributeFormat.Byte4Normal:q.vertexAttribPointer(b,4,q.UNSIGNED_BYTE,!0,d,f);break;default:throw new MO.TError(this,"Unknown vertex format. (format_cd=%d)",h);}return w=this.checkError("glVertexAttribPointer","Bind vertex attribute pointer. (slot=%d, format_cd=%d)",b,h)};
MO.FWglContext_bindTexture=function(b,d,f){var h=this._handle,q=!0;this._statistics._frameTextureCount++;this._statusRecord&&(q=new MO.SG3dLayoutSampler,q.slot=b,q.index=d,q.texture=f,this._recordSamplers.push(q));if(this._activeTextureSlot!=b){h.uniform1i(b,d);h.activeTexture(h.TEXTURE0+d);q=this.checkError("activeTexture","Active texture failure. (slot=%d, index=%d)",b,d);if(!q)return q;this._activeTextureSlot=b}if(null==f)return h.bindTexture(h.TEXTURE_2D,null),q=this.checkError("bindTexture",
"Bind texture clear failure. (slot=%d)",b);b=f._handle;switch(f.textureCd()){case MO.EG3dTexture.Flat2d:h.bindTexture(h.TEXTURE_2D,b);q=this.checkError("glBindTexture","Bind flag texture failure. (texture_id=%d)",b);if(!q)break;break;case MO.EG3dTexture.Cube:h.bindTexture(h.TEXTURE_CUBE_MAP,b);q=this.checkError("glBindTexture","Bind cube texture failure. (texture_id=%d)",b);if(!q)break;break;default:throw new MO.TError(this,"Unknown texture type.");}return q};
MO.FWglContext_clear=function(b,d,f,h,q){var w=this._handle;w.clearColor(b,d,f,h);w.clearDepth(q);w.clear(w.COLOR_BUFFER_BIT|w.DEPTH_BUFFER_BIT);this._statistics._frameClearCount++};MO.FWglContext_clearColor=function(b,d,f,h){var q=this._handle;q.clearColor(b,d,f,h);q.clear(q.COLOR_BUFFER_BIT);this._statistics._frameClearCount++};MO.FWglContext_clearDepth=function(b){var d=this._handle;d.clearDepth(b);d.clear(d.DEPTH_BUFFER_BIT);this._statistics._frameClearCount++};
MO.FWglContext_readPixels=function(b,d,f,h){var q=this._handle,w=new Uint8Array(4*f*h);q.readPixels(b,d,f,h,q.RGBA,q.UNSIGNED_BYTE,w);return w};
MO.FWglContext_drawTriangles=function(b,d,f){var h=this._handle,q=!0;null==d&&(d=0);null==f&&(f=b.count());h.bindBuffer(h.ELEMENT_ARRAY_BUFFER,b._handle);q=this.checkError("bindBuffer","Bind element array buffer failure. (index=0x%08X, offset=%d, count=%d, buffer_id)",b,d,f,b._handle);if(!q)return q;var w=b.strideCd(),q=MO.RWglUtility.convertIndexStride(h,w),z=0;switch(w){case MO.EG3dIndexStride.Uint16:z=d<<1;break;case MO.EG3dIndexStride.Uint32:z=d<<2}w=b.drawModeCd();w=MO.RWglUtility.convertDrawMode(h,
w);h.drawElements(w,f,q,z);this._statistics._frameTriangleCount+=f;this._statistics._frameDrawCount++;q=this.checkError("drawElements","Draw triangles failure. (index={1}, offset={2}, count={3})",b,d,f);if(!q)return q;h.bindBuffer(h.ELEMENT_ARRAY_BUFFER,null);return q=this.checkError("bindBuffer","Bind element array buffer failure. (index={1}, offset={2}, count={3})",b,d,f)};MO.FWglContext_present=function(){};
MO.FWglContext_checkError=function(b,d,f){if(!this._capability.optionDebug||!MO.Runtime.isDebug())return!0;b=this._handle;d=!1;for(var h=f=null;;){f=b.getError();if(f==b.NO_ERROR){d=!0;break}switch(f){case b.INVALID_OPERATION:h="Invalid operation.";break;case b.INVALID_ENUM:h="Invalid enum.";break;case b.INVALID_VALUE:h="Invalid value.";break;case b.INVALID_FRAMEBUFFER_OPERATION:h="Invalid paramebuffer opeartion.";break;case b.OUT_OF_MEMORY:h="Out of memory.";break;default:h="Unknown"}}d||MO.Logger.fatal(this,
null,"OpenGL check failure. (code={1}, description={2})",f,h);return d};MO.FWglContext_saveConfig=function(b){var d=this.parameters(),f=b.create("Parameters");MO.Lang.Xml.saveObject(f,"Parameter",d);d=this.extensions();b=b.create("Extensions");MO.Lang.Xml.saveObject(b,"Extension",d)};
MO.FWglContext_dispose=function(){this._data16=this._data9=null;this._recordBuffers=MO.Lang.Object.dispose(this._recordBuffers);this._recordSamplers=MO.Lang.Object.dispose(this._recordSamplers);this._handleDebugShader=this._handleSamplerS3tc=this._activeTextureSlot=this._extensions=this._parameters=this._contextAttributes=null;this.__base.FG3dContext.dispose.call(this)};
MO.FWglCubeTexture=function(b){b=MO.Class.inherits(this,b,MO.FG3dCubeTexture);b._handle=null;b.setup=MO.FWglCubeTexture_setup;b.isValid=MO.FWglCubeTexture_isValid;b.makeMipmap=MO.FWglCubeTexture_makeMipmap;b.upload=MO.FWglCubeTexture_upload;b.update=MO.FWglCubeTexture_update;b.dispose=MO.FWglCubeTexture_dispose;return b};MO.FWglCubeTexture_setup=function(){var b=this._graphicContext._handle;this.__base.FG3dCubeTexture.setup.call(this);this._handle=b.createTexture()};MO.FWglCubeTexture_isValid=function(){return this._graphicContext._handle.isTexture(this._handle)};
MO.FWglCubeTexture_makeMipmap=function(){var b=this._graphicContext._handle;b.bindTexture(b.TEXTURE_CUBE_MAP,this._handle);b.generateMipmap(b.TEXTURE_CUBE_MAP)};
MO.FWglCubeTexture_upload=function(b,d,f,h,q,w){var z=this._graphicContext,A=z._handle;A.bindTexture(A.TEXTURE_CUBE_MAP,this._handle);A.texImage2D(A.TEXTURE_CUBE_MAP_POSITIVE_X,0,A.RGB,A.RGB,A.UNSIGNED_BYTE,b.image());A.texImage2D(A.TEXTURE_CUBE_MAP_NEGATIVE_X,0,A.RGB,A.RGB,A.UNSIGNED_BYTE,d.image());A.texImage2D(A.TEXTURE_CUBE_MAP_POSITIVE_Y,0,A.RGB,A.RGB,A.UNSIGNED_BYTE,f.image());A.texImage2D(A.TEXTURE_CUBE_MAP_NEGATIVE_Y,0,A.RGB,A.RGB,A.UNSIGNED_BYTE,h.image());A.texImage2D(A.TEXTURE_CUBE_MAP_POSITIVE_Z,
0,A.RGB,A.RGB,A.UNSIGNED_BYTE,q.image());A.texImage2D(A.TEXTURE_CUBE_MAP_NEGATIVE_Z,0,A.RGB,A.RGB,A.UNSIGNED_BYTE,w.image());this._statusLoad=z.checkError("texImage2D","Upload cube image failure.");this.update()};
MO.FWglCubeTexture_update=function(){this.__base.FG3dCubeTexture.update.call(this);var b=this._graphicContext._handle;b.bindTexture(b.TEXTURE_CUBE_MAP,this._handle);var d=MO.RWglUtility.convertSamplerFilter(b,this._filterMinCd);d&&b.texParameteri(b.TEXTURE_CUBE_MAP,b.TEXTURE_MIN_FILTER,d);(d=MO.RWglUtility.convertSamplerFilter(b,this._filterMagCd))&&b.texParameteri(b.TEXTURE_CUBE_MAP,b.TEXTURE_MAG_FILTER,d)};
MO.FWglCubeTexture_dispose=function(){var b=this._graphicContext,d=this._handle;d&&(b._handle.deleteTexture(d),this._handle=null);this.__base.FG3dCubeTexture.dispose.call(this)};
MO.FWglFlatTexture=function(b){b=MO.Class.inherits(this,b,MO.FG3dFlatTexture);b._handle=null;b.setup=MO.FWglFlatTexture_setup;b.isValid=MO.FWglFlatTexture_isValid;b.texture=MO.FWglFlatTexture_texture;b.makeMipmap=MO.FWglFlatTexture_makeMipmap;b.uploadData=MO.FWglFlatTexture_uploadData;b.upload=MO.FWglFlatTexture_upload;b.update=MO.FWglFlatTexture_update;b.dispose=MO.FWglFlatTexture_dispose;return b};
MO.FWglFlatTexture_setup=function(){var b=this._graphicContext._handle;this.__base.FG3dFlatTexture.setup.call(this);this._handle=b.createTexture()};MO.FWglFlatTexture_isValid=function(){return this._graphicContext._handle.isTexture(this._handle)};MO.FWglFlatTexture_texture=function(){return this};MO.FWglFlatTexture_makeMipmap=function(){var b=this._graphicContext._handle;b.bindTexture(b.TEXTURE_2D,this._handle);b.generateMipmap(b.TEXTURE_2D)};
MO.FWglFlatTexture_uploadData=function(b,d,f){var h=this._graphicContext,q=h._handle,w=null;if(b.constructor==ArrayBuffer)w=new Uint8Array(b);else if(b.constructor==Uint8Array)w=b;else throw new MO.TError("Invalid content format.");this.width=d;this.height=f;q.bindTexture(q.TEXTURE_2D,this._handle);q.texImage2D(q.TEXTURE_2D,0,q.RGBA,d,f,0,q.RGBA,q.UNSIGNED_BYTE,w);this._statusLoad=h.checkError("texImage2D","Upload content failure.");this.update()};
MO.FWglFlatTexture_upload=function(b){var d=this._graphicContext;d.capability();var f=d._handle,h=null,h=b.tagName;if("IMG"==h||"VIDEO"==h||"CANVAS"==h)h=b;else if(MO.Class.isClass(b,MO.FImage))h=b.image();else if(MO.Class.isClass(b,MO.MCanvasObject))h=b.htmlCanvas();else throw new TError("Invalid image format.");f.bindTexture(f.TEXTURE_2D,this._handle);this._optionFlipY&&f.pixelStorei(f.UNPACK_FLIP_Y_WEBGL,!0);f.texImage2D(f.TEXTURE_2D,0,f.RGBA,f.RGBA,f.UNSIGNED_BYTE,h);this.update();this._statusLoad=
d.checkError("texImage2D","Upload image failure.")};
MO.FWglFlatTexture_update=function(){this.__base.FG3dFlatTexture.update.call(this);var b=this._graphicContext._handle;b.bindTexture(b.TEXTURE_2D,this._handle);var d=MO.RWglUtility.convertSamplerFilter(b,this._filterMinCd);d&&b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,d);(d=MO.RWglUtility.convertSamplerFilter(b,this._filterMagCd))&&b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,d);(d=MO.RWglUtility.convertSamplerFilter(b,this._wrapS))&&b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,d);(d=
MO.RWglUtility.convertSamplerFilter(b,this._wrapT))&&b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,d)};MO.FWglFlatTexture_dispose=function(){var b=this._graphicContext,d=this._handle;d&&(b._handle.deleteTexture(d),this._handle=null);this.__base.FG3dFlatTexture.dispose.call(this)};
MO.FWglFragmentShader=function(b){b=MO.Class.inherits(this,b,MO.FG3dFragmentShader);b._handle=null;b.setup=MO.FWglFragmentShader_setup;b.targetSource=MO.FWglFragmentShader_targetSource;b.upload=MO.FWglFragmentShader_upload;b.dispose=MO.FWglFragmentShader_dispose;return b};MO.FWglFragmentShader_setup=function(){this.__base.FG3dFragmentShader.setup.call(this);var b=this._graphicContext._handle;this._handle=b.createShader(b.FRAGMENT_SHADER)};
MO.FWglFragmentShader_targetSource=function(){var b=null,b=this._graphicContext;return b=b.capability().optionShaderSource?b._handleDebugShader.getTranslatedShaderSource(this._handle):this._source};
MO.FWglFragmentShader_upload=function(b){var d=this._graphicContext._handle,f=this._handle;d.shaderSource(f,b);d.compileShader(f);if(!d.getShaderParameter(f,d.COMPILE_STATUS)){var h=d.getShaderInfoLog(f);d.deleteShader(f);this._handle=null;throw new MO.TError(this,"Upload fragment shader source failure. (error={1})\n{2}",h,b);}this._source=b;return!0};MO.FWglFragmentShader_dispose=function(){var b=this._graphicContext,d=this._handle;d&&(b._handle.deleteShader(d),this._handle=null);this.__base.FG3dFragmentShader.dispose.call(this)};
MO.FWglIndexBuffer=function(b){b=MO.Class.inherits(this,b,MO.FG3dIndexBuffer);b._handle=null;b.setup=MO.FWglIndexBuffer_setup;b.isValid=MO.FWglIndexBuffer_isValid;b.upload=MO.FWglIndexBuffer_upload;b.dispose=MO.FWglIndexBuffer_dispose;return b};MO.FWglIndexBuffer_setup=function(){this.__base.FG3dIndexBuffer.setup.call(this);this._handle=this._graphicContext._handle.createBuffer()};MO.FWglIndexBuffer_isValid=function(){return this._graphicContext._handle.isBuffer(this._handle)};
MO.FWglIndexBuffer_upload=function(b,d,f){var h=this._graphicContext,q=h._handle;f&&(this._data=b);this._count=d;f=null;if(b.constructor==Array||b.constructor==ArrayBuffer)if(this._strideCd==MO.EG3dIndexStride.Uint16)f=new Uint16Array(b);else if(this._strideCd==MO.EG3dIndexStride.Uint32)f=new Uint32Array(b);else throw new TError(this,"Index stride is invalid.");else if(b.constructor==Uint16Array){if(this._strideCd!=MO.EG3dIndexStride.Uint16)throw new TError(this,"Index stride16 is invalid.");f=b}else if(b.constructor==
Uint32Array){if(this._strideCd!=MO.EG3dIndexStride.Uint32)throw new TError(this,"Index stride16 is invalid.");f=b}else throw new TError(this,"Upload index data type is invalid. (value={1})",b);q.bindBuffer(q.ELEMENT_ARRAY_BUFFER,this._handle);h.checkError("bindBuffer","Bind buffer failure.");q.bufferData(q.ELEMENT_ARRAY_BUFFER,f,q.STATIC_DRAW);h.checkError("bufferData","Upload buffer data. (count={1})",d)};
MO.FWglIndexBuffer_dispose=function(){var b=this._graphicContext;this._resource=null;var d=this._handle;d&&(b._handle.deleteBuffer(d),this._handle=null);this.__base.FG3dIndexBuffer.dispose.call(this)};MO.FWglLayout=function(b){b=MO.Class.inherits(this,b,MO.FG3dLayout);b._handle=null;b.setup=MO.FWglLayout_setup;b.bind=MO.FWglLayout_bind;b.unbind=MO.FWglLayout_unbind;b.active=MO.FWglLayout_active;b.deactive=MO.FWglLayout_deactive;b.dispose=MO.FWglLayout_dispose;return b};
MO.FWglLayout_setup=function(){this.__base.FG3dLayout.setup.call(this);this._handle=this._graphicContext._handleLayout.createVertexArrayOES()};MO.FWglLayout_bind=function(){this._graphicContext._handleLayout.bindVertexArrayOES(this._handle)};MO.FWglLayout_unbind=function(){this._graphicContext._handleLayout.bindVertexArrayOES(null)};MO.FWglLayout_active=function(){this._graphicContext._handleLayout.bindVertexArrayOES(this._handle)};MO.FWglLayout_deactive=function(){this._graphicContext._handleLayout.bindVertexArrayOES(null)};
MO.FWglLayout_dispose=function(){var b=this._graphicContext,d=this._handle;d&&(b._handleLayout.deleteVertexArrayOES(d),this._handle=null);this.__base.FG3dLayout.dispose.call(this)};
MO.FWglProgram=function(b){b=MO.Class.inherits(this,b,MO.FG3dProgram);b._handle=null;b.setup=MO.FWglProgram_setup;b.vertexShader=MO.FWglProgram_vertexShader;b.fragmentShader=MO.FWglProgram_fragmentShader;b.upload=MO.FWglProgram_upload;b.build=MO.FWglProgram_build;b.link=MO.FWglProgram_link;b.dispose=MO.FWglProgram_dispose;return b};MO.FWglProgram_setup=function(){this._handle=(g=this._graphicContext)._handle.createProgram()};
MO.FWglProgram_vertexShader=function(){var b=this._vertexShader;b||(b=this._vertexShader=MO.Class.create(MO.FWglVertexShader),b.linkGraphicContext(this),b.setup());return b};MO.FWglProgram_fragmentShader=function(){var b=this._fragmentShader;b||(b=this._fragmentShader=MO.Class.create(MO.FWglFragmentShader),b.linkGraphicContext(this),b.setup());return b};
MO.FWglProgram_upload=function(b,d){if(b==MO.EG3dShader.Vertex)this.vertexShader().upload(d);else if(b==MO.EG3dShader.Fragment)this.fragmentShader().upload(d);else throw Error("Unknown type");};
MO.FWglProgram_build=function(){var b=this._graphicContext,d=b._handle,f=this._handle,h=this.vertexShader();d.attachShader(f,h._handle);var q=b.checkError("attachShader","Attach shader failure. (program_id=%d, shader_id=%d)",f,h._handle);if(!q)return q;h=this.fragmentShader();d.attachShader(f,h._handle);q=b.checkError("attachShader","Attach shader failure. (program_id=%d, shader_id=%d)",f,h._handle);if(!q)return q;if(this.hasAttribute())for(var h=this.attributes(),w=h.count(),z=0;z<w;z++)if(q=h.at(z).name(),
d.bindAttribLocation(f,z,q),q=b.checkError("bindAttribLocation","Bind attribute location. (program_id=%d, slot=%d, name=%s)",f,z,q),!q)return q};
MO.FWglProgram_link=function(){var b=this._graphicContext,d=b._handle,f=!1,h=this._handle;d.linkProgram(h);f=d.getProgramParameter(h,d.LINK_STATUS);if(!f)return b=d.getProgramInfoLog(h),MO.Logger.fatal(this,null,"Link program failure. (status={1}, reason={2})",f,b),d.deleteProgram(this._handle),this._handle=null,!1;d.validateProgram(h);(f=d.getProgramParameter(h,d.VALIDATE_STATUS))||d.getProgramInfoLog(h);d.finish();f=b.checkError("finish","Finish program link faliure. (program_id={1})",h);if(!f)return f;
if(this.hasParameter())for(var q=this._parameters.count(),w=0;w<q;w++){var z=this._parameters.at(w),A=d.getUniformLocation(h,z.name()),f=b.checkError("getUniformLocation","Find parameter slot. (program_id=%d, name=%s, slot=%d)",h,z.name(),A);if(!f)return f;z._slot=A;null!=A&&(z._statusUsed=!0)}if(this.hasAttribute())for(q=this._attributes.count(),w=0;w<q;w++){z=this._attributes.at(w);A=d.getAttribLocation(h,z.name());f=b.checkError("getAttribLocation","Find attribute slot. (program_id=%d, name=%s, slot=%d)",
h,z.name(),A);if(!f)return f;z._slot=A;-1!=A&&(z._statusUsed=!0)}if(this.hasSampler()){q=this._samplers.count();for(w=0;w<q;w++){z=this._samplers.at(w);A=d.getUniformLocation(h,z.name());f=b.checkError("getUniformLocation","Find sampler slot. (program_id=%d, name=%s, slot=%d)",h,z.name(),A);if(!f)return f;z._slot=A;null!=A&&(z._statusUsed=!0)}for(w=d=0;w<q;w++)z=this._samplers.value(w),z._statusUsed&&(z._index=d++)}return f};
MO.FWglProgram_dispose=function(){var b=this._graphicContext,d=this._handle;d&&(b._handle.deleteProgram(d),this._handle=null);this.__base.FG3dProgram.dispose.call(this)};MO.FWglRenderTarget=function(b){b=MO.Class.inherits(this,b,MO.FG3dRenderTarget);b._optionDepth=!0;b._handle=null;b._handleDepth=null;b.setup=MO.FWglRenderTarget_setup;b.build=MO.FWglRenderTarget_build;b.dispose=MO.FWglRenderTarget_dispose;return b};
MO.FWglRenderTarget_setup=function(){this.__base.FG3dRenderTarget.setup.call(this);var b=this._graphicContext;this._handle=b._handle.createFramebuffer();return b.checkError("createFramebuffer","Create frame buffer failure.")};
MO.FWglRenderTarget_build=function(){var b=this._size,d=this._graphicContext,f=d._handle;f.bindFramebuffer(f.FRAMEBUFFER,this._handle);var h=d.checkError("bindFramebuffer","Bind frame buffer failure.");if(!h)return h;if(this._optionDepth){var q=this._handleDepth=f.createRenderbuffer(),h=d.checkError("createRenderbuffer","Create render buffer failure.");if(!h)return h;f.bindRenderbuffer(f.RENDERBUFFER,q);h=d.checkError("bindRenderbuffer","Bind render buffer failure.");if(!h)return h;f.renderbufferStorage(f.RENDERBUFFER,
f.DEPTH_COMPONENT16,b.width,b.height);h=d.checkError("renderbufferStorage","Set render buffer storage format failure.");if(!h)return h;f.framebufferRenderbuffer(f.FRAMEBUFFER,f.DEPTH_ATTACHMENT,f.RENDERBUFFER,q);h=d.checkError("framebufferRenderbuffer","Set depth buffer to frame buffer failure. (framebuffer=%d, depthbuffer=%d)",this._handle,q);if(!h)return h}for(var q=this._textures,w=q.count(),z=0;z<w;z++){var A=q.get(z);f.bindTexture(f.TEXTURE_2D,A._handle);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,
f.LINEAR);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,f.LINEAR);f.texImage2D(f.TEXTURE_2D,0,f.RGBA,b.width,b.height,0,f.RGBA,f.UNSIGNED_BYTE,null);h=d.checkError("texImage2D","Alloc texture storage. (texture_id, size=%dx%d)",A._handle,this._size.width,this._size.height);if(!h)return h;f.framebufferTexture2D(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0+z,f.TEXTURE_2D,A._handle,0);h=d.checkError("framebufferTexture2D","Set color buffer into frame buffer failure. (framebuffer_id=%d, texture_id=%d)",this._handle,
A._handle);if(!h)return h}};MO.FWglRenderTarget_dispose=function(){var b=this._graphicContext,d=this._handleDepth;d&&(b._handle.deleteRenderbuffer(d),this._handleDepth=null);if(d=this._handle)b._handle.deleteFramebuffer(d),this._handle=null;this.__base.FG3dRenderTarget.dispose.call(this)};
MO.FWglVertexBuffer=function(b){b=MO.Class.inherits(this,b,MO.FG3dVertexBuffer);b._handle=null;b.setup=MO.FWglVertexBuffer_setup;b.isValid=MO.FWglVertexBuffer_isValid;b.upload=MO.FWglVertexBuffer_upload;b.dispose=MO.FWglVertexBuffer_dispose;return b};MO.FWglVertexBuffer_setup=function(){this.__base.FG3dVertexBuffer.setup.call(this);this._handle=this._graphicContext._handle.createBuffer()};MO.FWglVertexBuffer_isValid=function(){return this._graphicContext._handle.isBuffer(this._handle)};
MO.FWglVertexBuffer_upload=function(b,d,f,h){var q=this._graphicContext,w=q._handle;h&&(this._data=b);this._stride=d;this._count=f;d=null;if(b.constructor==Array||b.constructor==ArrayBuffer)switch(this._formatCd){case MO.EG3dAttributeFormat.Float1:case MO.EG3dAttributeFormat.Float2:case MO.EG3dAttributeFormat.Float3:case MO.EG3dAttributeFormat.Float4:d=new Float32Array(b);break;case MO.EG3dAttributeFormat.Byte4:case MO.EG3dAttributeFormat.Byte4Normal:d=new Uint8Array(b);break;default:throw new MO.TError(this,
"Unknown data type.");}else if(b.constructor==Uint8Array)d=b;else if(b.constructor==Float32Array)d=b;else throw new MO.TError(this,"Upload vertex data type is invalid. (data={1})",b);w.bindBuffer(w.ARRAY_BUFFER,this._handle);q.checkError("bindBuffer","Bindbuffer");w.bufferData(w.ARRAY_BUFFER,d,w.STATIC_DRAW);q.checkError("bufferData","bufferData")};
MO.FWglVertexBuffer_dispose=function(){var b=this._graphicContext;this._resource=null;var d=this._handle;d&&(b._handle.deleteBuffer(d),this._handle=null);this.__base.FG3dVertexBuffer.dispose.call(this)};MO.FWglVertexShader=function(b){b=MO.Class.inherits(this,b,MO.FG3dVertexShader);b._handle=null;b.setup=MO.FWglVertexShader_setup;b.targetSource=MO.FWglVertexShader_targetSource;b.upload=MO.FWglVertexShader_upload;b.dispose=MO.FWglVertexShader_dispose;return b};
MO.FWglVertexShader_setup=function(){this.__base.FG3dVertexShader.setup.call(this);var b=this._graphicContext._handle;this._handle=b.createShader(b.VERTEX_SHADER)};MO.FWglVertexShader_targetSource=function(){var b=null,b=this._graphicContext;return b=b.capability().optionShaderSource?b._handleDebugShader.getTranslatedShaderSource(this._handle):this._source};
MO.FWglVertexShader_upload=function(b){var d=this._graphicContext._handle,f=this._handle;d.shaderSource(f,b);d.compileShader(f);if(!d.getShaderParameter(f,d.COMPILE_STATUS)){var h=d.getShaderInfoLog(f);d.deleteShader(f);this._handle=null;throw new MO.TError(this,"Upload vertex shader source failure. (error={1})\n{2}",h,b);}this._source=b;return!0};MO.FWglVertexShader_dispose=function(){var b=this._graphicContext,d=this._handle;d&&(b._handle.deleteShader(d),this._handle=null);this.__base.FG3dVertexShader.dispose.call(this)};
MO.RWglUtility=function(){return this};MO.RWglUtility.prototype.convertFillMode=function(b,d){switch(d){case MO.EG3dFillMode.Point:return b.POINT;case MO.EG3dFillMode.Line:return b.LINE;case MO.EG3dFillMode.Face:return b.FILL}throw new TError(this,"Convert fill mode failure. (fill_cd={1})",d);};
MO.RWglUtility.prototype.convertDrawMode=function(b,d){switch(d){case MO.EG3dDrawMode.Point:return b.POINTS;case MO.EG3dDrawMode.Lines:return b.LINES;case MO.EG3dDrawMode.LineStrip:return b.LINE_STRIP;case MO.EG3dDrawMode.LineLoop:return b.LINE_LOOP;case MO.EG3dDrawMode.Triangles:return b.TRIANGLES;case MO.EG3dDrawMode.TriangleStrip:return b.TRIANGLE_STRIP;case MO.EG3dDrawMode.TriangleFan:return b.TRIANGLE_FAN;case MO.EG3dDrawMode.Quads:return b.QUADS;case MO.EG3dDrawMode.QuadStrip:return b.QUAD_STRIP}throw new TError(this,
"Convert draw mode failure. (draw_cd={1})",d);};MO.RWglUtility.prototype.convertCullMode=function(b,d){switch(d){case MO.EG3dCullMode.Front:return b.FRONT;case MO.EG3dCullMode.Back:return b.BACK;case MO.EG3dCullMode.Both:return b.FRONT_AND_BACK}throw new TError(this,"Convert cull mode failure. (cull_cd={1})",d);};
MO.RWglUtility.prototype.convertDepthMode=function(b,d){switch(d){case MO.EG3dDepthMode.Equal:return b.EQUAL;case MO.EG3dDepthMode.NotEqual:return b.NOTEQUAL;case MO.EG3dDepthMode.Less:return b.LESS;case MO.EG3dDepthMode.LessEqual:return b.LEQUAL;case MO.EG3dDepthMode.Greater:return b.GREATER;case MO.EG3dDepthMode.GreaterEqual:return b.GEQUAL;case MO.EG3dDepthMode.Always:return b.ALWAYS}throw new TError(this,"Convert depth mode failure. (depth_cd={1})",d);};
MO.RWglUtility.prototype.convertBlendFactors=function(b,d){switch(d){case MO.EG3dBlendMode.Zero:return b.ZERO;case MO.EG3dBlendMode.One:return b.ONE;case MO.EG3dBlendMode.SrcColor:return b.SRC_COLOR;case MO.EG3dBlendMode.OneMinusSrcColor:return b.ONE_MINUS_SRC_COLOR;case MO.EG3dBlendMode.DstColor:return b.DST_COLOR;case MO.EG3dBlendMode.OneMinusDstColor:return b.ONE_MINUS_DST_COLOR;case MO.EG3dBlendMode.SrcAlpha:return b.SRC_ALPHA;case MO.EG3dBlendMode.OneMinusSrcAlpha:return b.ONE_MINUS_SRC_ALPHA;
case MO.EG3dBlendMode.DstAlpha:return b.DST_ALPHA;case MO.EG3dBlendMode.OneMinusDstAlpha:return b.ONE_MINUS_DST_ALPHA;case MO.EG3dBlendMode.SrcAlphaSaturate:return b.SRC_ALPHA_SATURATE}throw new TError(this,"Convert blend factors failure. (blend_cd={1})",d);};
MO.RWglUtility.prototype.convertIndexStride=function(b,d){switch(d){case MO.EG3dIndexStride.Uint16:return b.UNSIGNED_SHORT;case MO.EG3dIndexStride.Uint32:return b.UNSIGNED_INT}throw new TError(this,"Convert index stride failure. (stride_cd={1})",d);};
MO.RWglUtility.prototype.convertSamplerFilter=function(b,d){switch(d){case MO.EG3dSamplerFilter.Unknown:return 0;case MO.EG3dSamplerFilter.Nearest:return b.NEAREST;case MO.EG3dSamplerFilter.Linear:return b.LINEAR;case MO.EG3dSamplerFilter.Repeat:return b.REPEAT;case MO.EG3dSamplerFilter.ClampToEdge:return b.CLAMP_TO_EDGE;case MO.EG3dSamplerFilter.ClampToBorder:return b.CLAMP_TO_BORDER}throw new TError(this,"Convert sampler filter failure. (filter_cd={1})",d);};MO.RWglUtility=new MO.RWglUtility;
MO.EDisplayTransform=new function(){this.CameraPosition="camera.position";this.CameraDirection="camera.direction";this.BilboardedSphere="bilboarded.sphere";this.BilboardedCylinder="bilboarded.cylinder";return this};MO.EResourceCompress=new function(){this.None="none";this.Deflate="deflate";this.Lzma="lzma";return this};
MO.EStageKey=new function(){this.Forward=MO.EKeyCode.W;this.Back=MO.EKeyCode.S;this.Up=MO.EKeyCode.Q;this.Down=MO.EKeyCode.E;this.RotationLeft=MO.EKeyCode.A;this.RotationRight=MO.EKeyCode.D;this.RotationUp=MO.EKeyCode.Z;this.RotationDown=MO.EKeyCode.X;this.FocusForward=MO.EKeyCode.I;this.FocusBack=MO.EKeyCode.K;this.FocusLeft=MO.EKeyCode.J;this.FocusRight=MO.EKeyCode.L;return this};
MO.MEventDispatcher=function(b){b=MO.Class.inherits(this,b);b.onOperationDown=MO.Method.empty;b.onOperationMove=MO.Method.empty;b.onOperationUp=MO.Method.empty;b.onOperationWheel=MO.Method.empty;b.onOperationKeyDown=MO.Method.empty;b.onOperationKeyPress=MO.Method.empty;b.onOperationKeyUp=MO.Method.empty;b.onOperationResize=MO.Method.empty;b.onOperationVisibility=MO.Method.empty;b.onOperationOrientation=MO.Method.empty;b.dispatcherEvent=MO.MEventDispatcher_dispatcherEvent;return b};
MO.MEventDispatcher_dispatcherEvent=function(b,d){switch(b.code){case MO.EEvent.MouseDown:this.onOperationDown(b);break;case MO.EEvent.MouseMove:this.onOperationMove(b);break;case MO.EEvent.MouseUp:this.onOperationUp(b);break;case MO.EEvent.MouseWheel:this.onOperationWheel(b);break;case MO.EEvent.KeyDown:this.onOperationKeyDown(b);break;case MO.EEvent.KeyPress:this.onOperationKeyPress(b);break;case MO.EEvent.KeyUp:this.onOperationKeyUp(b);break;case MO.EEvent.Resize:this.onOperationResize(b);break;
case MO.EEvent.Visibility:this.onOperationVisibility(b);break;case MO.EEvent.Orientation:this.onOperationOrientation(b);break;default:throw new MO.TError("Unknown event type.");}};MO.MRenderableLinker=function(b){b=MO.Class.inherits(this,b);b._renderable=MO.RClass.register(b,new MO.AGetter("_renderable"));b.dispose=MO.MRenderableLinker_dispose;return b};MO.MRenderableLinker_dispose=function(){this._renderable=null};
MO.MResourceData=function(b){b=MO.Class.inherits(this,b);b._ready=!1;b._guid=null;b._index=-1;b._compressData=MO.Class.register(b,new MO.AGetSet("_compressData"));b._data=null;b.testReady=MO.MResourceData_testReady;b.completeData=MO.MResourceData_completeData;b.dispose=MO.MResourceData_dispose;return b};MO.MResourceData_testReady=function(){return this._ready};MO.MResourceData_completeData=function(b){this._data=b;this._ready=!0};MO.MResourceData_dispose=function(){this._data=this._compressData=null};
MO.MTimeline=function(b){return b=MO.Class.inherits(this,b,MO.MTimelineWorker)};MO.MTimelineAction=function(b){return b=MO.Class.inherits(this,b,MO.MTimelineWorker)};MO.MTimelineActions=function(b){b=MO.Class.inherits(this,b);b._actions=MO.Class.register(b,new MO.AGetter("_actions"));b.construct=MO.MTimelineActions_construct;b.setup=MO.MTimelineActions_setup;b.pushAction=MO.MTimelineActions_pushAction;b.process=MO.MTimelineActions_process;b.dispose=MO.MTimelineActions_dispose;return b};
MO.MTimelineActions_construct=function(){this.__base.FObject.construct.call(this);this._actions=new MO.TObjects};MO.MTimelineActions_setup=function(){};MO.MTimelineActions_pushAction=function(b){this._actions.push(b)};MO.MTimelineActions_process=function(b){for(var d=b.tick,f=this._actions,h=f.count()-1;0<=h;h--){var q=f.at(h),w=d-q.tick;if(!(0>w))if(q.statusStart())if(q.statusStop())f.erase(h),q.dispose();else{var z=q.duration();0!=z&&w>z?q.stop():(b.tick=w,q.process(b))}else q.start()}b.tick=d};
MO.MTimelineActions_dispose=function(){this._actions=MO.Lang.Obejct.dispose(this._actions);this.__base.FObject.dispose.call(this)};MO.MTimelines=function(b){b=MO.Class.inherits(this,b);b._timelines=MO.Class.register(b,new MO.AGetter("_timelines"));b.construct=MO.MTimelines_construct;b.setup=MO.MTimelines_setup;b.pushTimeline=MO.MTimelines_pushTimeline;b.process=MO.MTimelines_process;b.dispose=MO.MTimelines_dispose;return b};
MO.MTimelines_construct=function(){this.__base.FObject.construct.call(this);this._timelines=new MO.TObjects};MO.MTimelines_setup=function(){};MO.MTimelines_pushTimeline=function(b){this._timelines.push(b)};MO.MTimelines_process=function(b){for(var d=b.tick,f=this._timelines,h=f.count()-1;0<=h;h--){var q=f.at(h),w=d-q.tick;if(!(0>w))if(q.statusStart())if(q.statusStop())f.erase(h),q.dispose();else{var z=q.duration();0!=z&&w>z?q.stop():(b.tick=w,q.process(b))}else q.start()}b.tick=d};
MO.MTimelines_dispose=function(){this._timelines=MO.Lang.Obejct.dispose(this._timelines);this.__base.FObject.dispose.call(this)};
MO.MTimelineWorker=function(b){b=MO.Class.inherits(this,b);b._code=MO.Class.register(b,new MO.AGetSet("_code"));b._tick=MO.Class.register(b,new MO.AGetSet("_tick"),0);b._duration=MO.Class.register(b,new MO.AGetSet("_duration"),0);b._statusStart=MO.Class.register(b,new MO.AGetter("_statusStart"),!1);b._statusStop=MO.Class.register(b,new MO.AGetter("_statusStop"),!1);b.onStart=MO.MTimelineWorker_onStart;b.onStop=MO.MTimelineWorker_onStop;b.construct=MO.MTimelineWorker_construct;b.setup=MO.MTimelineWorker_setup;
b.start=MO.MTimelineWorker_start;b.process=MO.MTimelineWorker_process;b.stop=MO.MTimelineWorker_stop;b.dispose=MO.MTimelineWorker_dispose;return b};MO.MTimelineWorker_onStart=function(){};MO.MTimelineWorker_onStop=function(){};MO.MTimelineWorker_construct=function(){};MO.MTimelineWorker_setup=function(){this._statusStart=!1};MO.MTimelineWorker_start=function(){this._statusStart||(this.onStart(),this._statusStart=!0);this._statusStop=!1};MO.MTimelineWorker_process=function(){};
MO.MTimelineWorker_stop=function(){this._statusStop||(this.onStop(),this._statusStop=!0)};MO.MTimelineWorker_dispose=function(){};MO.STimelineContext=function(){this._action=this._timeline=this._mainTimeline=null;return this};MO.FCanvas=function(b){b=MO.Class.inherits(this,b,MO.FObject);b._desktop=MO.Class.register(b,new MO.AGetSet("_desktop"));b._activeStage=MO.Class.register(b,new MO.AGetter("_activeStage"));b.construct=MO.FCanvas_construct;b.dispose=MO.FCanvas_dispose;return b};
MO.FCanvas_construct=function(){this.__base.FObject.construct.call(this)};MO.FCanvas_dispose=function(){this._desktop=null;this.__base.FObject.dispose.call(this)};
MO.FDesktop=function(b){b=MO.Class.inherits(this,b,MO.FObject,MO.MEventDispatcher);b._size=MO.Class.register(b,new MO.AGetter("_size"));b._sizeRate=MO.Class.register(b,new MO.AGetter("_sizeRate"),1);b._calculateSize=MO.Class.register(b,new MO.AGetter("_calculateSize"));b._calculateRate=MO.Class.register(b,new MO.AGetter("_calculateRate"));b._logicSize=MO.Class.register(b,new MO.AGetter("_logicSize"));b._logicRate=MO.Class.register(b,new MO.AGetter("_logicRate"));b._screenSize=MO.Class.register(b,
new MO.AGetter("_screenSize"));b._canvases=MO.Class.register(b,new MO.AGetter("_canvases"));b.construct=MO.FDesktop_construct;b.canvasRegister=MO.FDesktop_canvasRegister;b.canvasUnregister=MO.FDesktop_canvasUnregister;b.setup=MO.FDesktop_setup;b.build=MO.FDesktop_build;b.resize=MO.FDesktop_resize;b.processEvent=MO.FDesktop_processEvent;b.process=MO.FDesktop_process;b.dispose=MO.FDesktop_dispose;return b};
MO.FDesktop_construct=function(){this.__base.FObject.construct.call(this);this._size=new MO.SSize2(1280,720);this._calculateSize=new MO.SSize2(1280,720);this._calculateRate=new MO.SSize2(1,1);this._logicSize=new MO.SSize2(1280,720);this._logicRate=new MO.SSize2(1,1);this._screenSize=new MO.SSize2(1280,720);this._canvases=new MO.TObjects};MO.FDesktop_canvasRegister=function(b){this._canvases.push(b)};MO.FDesktop_canvasUnregister=function(b){this._canvases.remove(b)};MO.FDesktop_setup=function(b){};
MO.FDesktop_build=function(b){};MO.FDesktop_resize=function(){};MO.FDesktop_processEvent=function(b){this.dispatcherEvent(b)};MO.FDesktop_process=function(){};
MO.FDesktop_dispose=function(){this._size=MO.Lang.Object.dispose(this._size);this._calculateSize=MO.Lang.Object.dispose(this._calculateSize);this._logicSize=MO.Lang.Object.dispose(this._logicSize);this._logicRate=MO.Lang.Object.dispose(this._logicRate);this._screenSize=MO.Lang.Object.dispose(this._screenSize);this._canvases=MO.Lang.Object.dispose(this._canvases);this.__base.FObject.dispose.call(this)};
MO.FDisplay=function(b){b=MO.Class.inherits(this,b,MO.FComponent,MO.MGraphicObject);b._currentMatrix=MO.Class.register(b,new MO.AGetter("_currentMatrix"));b._matrix=MO.Class.register(b,new MO.AGetter("_matrix"));b._location=MO.Class.register(b,new MO.AGetter("_location"));b._rotation=MO.Class.register(b,new MO.AGetter("_rotation"));b._scale=MO.Class.register(b,new MO.AGetter("_scale"));b._visible=!0;b._renderables=null;b.construct=MO.FDisplay_construct;b.hasRenderable=MO.FDisplay_hasRenderable;b.renderables=
MO.FDisplay_renderables;b.pushRenderable=MO.FDisplay_pushRenderable;b.removeRenderable=MO.FDisplay_removeRenderable;b.clearRenderables=MO.FDisplay_clearRenderables;b.push=MO.FDisplay_push;b.remove=MO.FDisplay_remove;b.filterDisplays=MO.FDisplay_filterDisplays;b.filterRenderables=MO.FDisplay_filterRenderables;b.show=MO.FDisplay_show;b.hide=MO.FDisplay_hide;b.setVisible=MO.FDisplay_setVisible;b.update=MO.FDisplay_update;b.updateMatrix=MO.FDisplay_updateMatrix;b.process=MO.FDisplay_process;b.dispose=
MO.FDisplay_dispose;return b};MO.FDisplay_construct=function(){this.__base.FComponent.construct.call(this);this._currentMatrix=new MO.SMatrix3d;this._matrix=new MO.SMatrix3d;this._location=new MO.SPoint3;this._rotation=new MO.SVector3;this._scale=new MO.SVector3(1,1,1)};MO.FDisplay_hasRenderable=function(){var b=this._renderables;return b?!b.isEmpty():!1};MO.FDisplay_renderables=function(){var b=this._renderables;b||(b=this._renderables=new MO.TObjects);return b};
MO.FDisplay_pushRenderable=function(b){b._display=this;this.renderables().push(b)};MO.FDisplay_removeRenderable=function(b){var d=this._renderables;d&&d.remove(b)};MO.FDisplay_clearRenderables=function(){var b=this._renderables;b&&b.clear()};
MO.FDisplay_push=function(b){if(MO.Class.isClass(b,MO.FRenderable))this.pushRenderable(b);else if(MO.Class.isClass(b,MO.MRenderableLinker))this.pushRenderable(b.renderable());else if(MO.Class.isClass(b,MO.FDisplay))this.pushDisplay(b);else throw new MO.TError(this,"Unknown item type.");};MO.FDisplay_remove=function(){var b=this._parent;b&&(b.removeDisplay(this),this._parent=null)};MO.FDisplay_filterDisplays=function(b){this._visible&&b.push(this)};
MO.FDisplay_filterRenderables=function(b){if(!this._visible)return!1;var d=this._renderables;if(d)for(var f=d.count(),h=0;h<f;h++)d.getAt(h).filterDrawables(b);return!0};MO.FDisplay_show=function(){this.setVisible(!0)};MO.FDisplay_hide=function(){this.setVisible(!1)};MO.FDisplay_setVisible=function(b){this._visible=b};MO.FDisplay_update=function(){var b=this._matrix;b.set(this._location,this._rotation,this._scale);b.update()};
MO.FDisplay_updateMatrix=function(b){this._currentMatrix.assign(this._matrix);(b=this._parent)&&this._currentMatrix.append(b._currentMatrix)};MO.FDisplay_process=function(b){this.updateMatrix(b);var d=this._renderables;if(d)for(var f=d.count(),h=0;h<f;h++)d.at(h).process(b)};
MO.FDisplay_dispose=function(){this._currentMatrix=MO.Lang.Object.dispose(this._currentMatrix);this._matrix=MO.Lang.Object.dispose(this._matrix);this._position=MO.Lang.Object.dispose(this._position);this._direction=MO.Lang.Object.dispose(this._direction);this._scale=MO.Lang.Object.dispose(this._scale);this._renderables=MO.Lang.Object.dispose(this._renderables);this.__base.FComponent.dispose.call(this)};
MO.FDisplayContainer=function(b){b=MO.Class.inherits(this,b,MO.FDisplay);b._displays=null;b.hasDisplay=MO.FDisplayContainer_hasDisplay;b.findDisplay=MO.FDisplayContainer_findDisplay;b.searchDisplay=MO.FDisplayContainer_searchDisplay;b.displays=MO.FDisplayContainer_displays;b.pushDisplay=MO.FDisplayContainer_pushDisplay;b.removeDisplay=MO.FDisplayContainer_removeDisplay;b.filterDisplays=MO.FDisplayContainer_filterDisplays;b.filterRenderables=MO.FDisplayContainer_filterRenderables;b.process=MO.FDisplayContainer_process;
b.dispose=MO.FDisplayContainer_dispose;return b};MO.FDisplayContainer_hasDisplay=function(){var b=this._displays;return b?!b.isEmpty():!1};MO.FDisplayContainer_findDisplay=function(b){var d=this._displays;if(d)for(var f=d.count(),h=0;h<f;h++){var q=d.at(h);if(q.code()==b)return q}return null};MO.FDisplayContainer_searchDisplay=function(b){var d=this._displays;if(d)for(var f=d.count(),h=0;h<f;h++){var q=d.at(h);if(q.isName(b)||(q=q.searchDisplay(b)))return q}return null};
MO.FDisplayContainer_displays=function(){var b=this._displays;b||(b=this._displays=new MO.TObjects);return b};MO.FDisplayContainer_pushDisplay=function(b){b.setParent(this);this.displays().push(b)};MO.FDisplayContainer_removeDisplay=function(b){this.displays().remove(b);b.setParent(null)};MO.FDisplayContainer_filterDisplays=function(b){this.__base.FDisplay.filterDisplays.call(this,b);if(!this._visible)return!1;var d=this._displays;if(d)for(var f=d.count(),h=0;h<f;h++)d.at(h).filterDisplays(b)};
MO.FDisplayContainer_filterRenderables=function(b){this.__base.FDisplay.filterRenderables.call(this,b);if(!this._visible)return!1;var d=this._displays;if(d)for(var f=d.count(),h=0;h<f;h++)d.at(h).filterRenderables(b);return!0};MO.FDisplayContainer_process=function(b){this.__base.FDisplay.process.call(this,b);var d=this._displays;if(d)for(var f=d.count(),h=0;h<f;h++)d.at(h).process(b)};
MO.FDisplayContainer_dispose=function(){var b=this._displays;if(b){for(var d=v.count()-1;0<=d;d--)b.at(d).dispose();this._displays=MO.Lang.Object.dispose(b)}this.__base.FDisplay.dispose.call(this)};
MO.FDisplayLayer=function(b){b=MO.Class.inherits(this,b,MO.FDisplayContainer);b._optionClearDepth=MO.Class.register(b,new MO.AGetSet("_optionClearDepth"),!1);b._statusActive=!1;b._technique=MO.Class.register(b,new MO.AGetSet("_technique"));b._visibleRenderables=MO.Class.register(b,new MO.AGetter("_visibleRenderables"));b.construct=MO.FDisplayLayer_construct;b.selectTechnique=MO.FDisplayLayer_selectTechnique;b.filterRenderables=MO.FDisplayLayer_filterRenderables;b.active=MO.FDisplayLayer_active;b.deactive=
MO.FDisplayLayer_deactive;return b};MO.FDisplayLayer_construct=function(){this.__base.FDisplayContainer.construct.call(this);this._visibleRenderables=new MO.TObjects};MO.FDisplayLayer_selectTechnique=function(b,d){var f=MO.Console.find(MO.FG3dTechniqueConsole).find(b,d);this.selectTechnique(f)};MO.FDisplayLayer_filterRenderables=function(b){this.__base.FDisplayContainer.filterRenderables.call(this,b);this._visibleRenderables.assign(b.renderables())};
MO.FDisplayLayer_active=function(){this._statusActive=!0};MO.FDisplayLayer_deactive=function(){this._statusActive=!1};MO.FDisplayUiLayer=function(b){return b=MO.Class.inherits(this,b,MO.FDisplayLayer)};MO.FDrawable=function(b){b=MO.Class.inherits(this,b,MO.FObject);b._visible=MO.Class.register(b,new MO.AGetSet("_visible"),!0);b.testVisible=MO.FDrawable_testVisible;b.process=MO.Method.empty;return b};MO.FDrawable_testVisible=function(){return this._visible};
MO.FMainTimeline=function(b){b=MO.Class.inherits(this,b,MO.FObject,MO.MListener,MO.MTimelineActions,MO.MTimeline,MO.MTimelines);b._context=null;b._startTick=0;b._lastTick=0;b._interval=0;b.construct=MO.FMainTimeline_construct;b.setup=MO.FMainTimeline_setup;b.start=MO.FMainTimeline_start;b.process=MO.FMainTimeline_process;b.dispose=MO.FMainTimeline_dispose;return b};
MO.FMainTimeline_construct=function(){this.__base.FObject.construct.call(this);this.__base.MTimelineActions.construct.call(this);this._context=new MO.STimelineContext;this._timelines=new MO.TObjects};MO.FMainTimeline_setup=function(){};MO.FMainTimeline_start=function(){};
MO.FMainTimeline_process=function(){var b=MO.Timer.current();if(b-this._lastTick<this._interval)return!1;this._lastTick=b;0==this._startTick&&(this._startTick=b);var d=this._context;d.tick=this._startTick-b;this.__base.MTimelineActions.process.call(this,d);this.__base.MTimelines.process.call(this,d)};MO.FMainTimeline_dispose=function(){this._timelines=MO.Lang.Object.dispose(this._timelines);this._context=MO.Lang.Object.dispose(this._context);this.__base.MTimelineActions.dispose.call(this);this.__base.FObject.dispose.call(this)};
MO.FRegion=function(b){return b=MO.Class.inherits(this,b,MO.FObject)};MO.FRenderable=function(b){b=MO.Class.inherits(this,b,MO.FDrawable);b._drawables=null;b.hasDrawable=MO.FRenderable_hasDrawable;b.drawables=MO.FRenderable_drawables;b.pushDrawable=MO.FRenderable_pushDrawable;b.removeDrawable=MO.FRenderable_removeDrawable;b.filterDrawables=MO.FRenderable_filterDrawables;b.process=MO.FRenderable_process;return b};MO.FRenderable_hasDrawable=function(){var b=this._drawables;return b?!b.isEmpty():!1};
MO.FRenderable_drawables=function(){var b=this._drawables;b||(b=this._drawables=new MO.TObjects);return b};MO.FRenderable_pushDrawable=function(b){b._drawable=this;b._parent=this;this.drawables().push(b)};MO.FRenderable_removeDrawable=function(b){this._drawables.remove(b)};MO.FRenderable_filterDrawables=function(b){if(!this.testVisible())return!1;b.pushRenderable(this);var d=this._drawables;if(d)for(var f=d.count(),h=0;h<f;h++){var q=d.getAt(h);q.testVisible()&&b.pushRenderable(q)}return!0};
MO.FRenderable_process=function(b){this.__base.FDrawable.process.call(this,b);var d=this._drawables;if(d)for(var f=d.count(),h=0;h<f;h++)d.getAt(h).process(b)};
MO.FStage=function(b){b=MO.Class.inherits(this,b,MO.FComponent,MO.MListener);b._code="stage";b._statusActive=!1;b._size=MO.Class.register(b,new MO.AGetter("_size"));b._timer=MO.Class.register(b,new MO.AGetter("_timer"));b._layers=MO.Class.register(b,new MO.AGetter("_layers"));b._enterFrameListeners=MO.Class.register(b,new MO.AListener("_enterFrameListeners",MO.EEvent.EnterFrame));b._leaveFrameListeners=MO.Class.register(b,new MO.AListener("_leaveFrameListeners",MO.EEvent.LeaveFrame));b.onProcess=
MO.FStage_onProcess;b.construct=MO.FStage_construct;b.registerLayer=MO.FStage_registerLayer;b.unregisterLayer=MO.FStage_unregisterLayer;b.active=MO.FStage_active;b.deactive=MO.FStage_deactive;b.process=MO.FStage_process;b.dispose=MO.FStage_dispose;return b};MO.FStage_onProcess=function(){for(var b=this._layers,d=b.count(),f=0;f<d;f++)b.at(f).process()};
MO.FStage_construct=function(){this.__base.FComponent.construct.call(this);this._size=new MO.SSize2(1920,1080);this._timer=MO.Class.create(MO.FTimer);this._layers=new MO.TDictionary};MO.FStage_registerLayer=function(b,d){d.setCode(b);this._layers.set(b,d)};MO.FStage_unregisterLayer=function(b){this._layers.set(b,null)};MO.FStage_active=function(){this._statusActive=!0;for(var b=this._layers,d=b.count(),f=0;f<d;f++)b.at(f).active()};
MO.FStage_deactive=function(){for(var b=this._layers,d=b.count(),f=0;f<d;f++)b.at(f).deactive();this._statusActive=!1};MO.FStage_process=function(){var b=this._timer;b||(b=MO.Class.create(MO.FTimer),b.setup());this.processEnterFrameListener(this);this.onProcess();this.processLeaveFrameListener(this);b.update()};MO.FStage_dispose=function(){this._timer=MO.Lang.Object.dispose(this._timer);this._layers=MO.Lang.Object.dispose(this._layers);this.__base.MListener.dispose.call(this);this.__base.FComponent.dispose.call(this)};
MO.FTimeline=function(b){b=MO.Class.inherits(this,b,MO.FObject,MO.MListener,MO.MTimelineActions,MO.MTimeline,MO.MTimelines);b._mainTimeline=MO.Class.register(b,new MO.AGetter("_mainTimeline"));b.construct=MO.FTimeline_construct;b.setup=MO.FTimeline_setup;b.process=MO.FTimeline_process;b.dispose=MO.FTimeline_dispose;return b};MO.FTimeline_construct=function(){this.__base.FObject.construct.call(this);this.__base.MTimelineActions.construct.call(this);this._actions=new MO.TObejcts};
MO.FTimeline_setup=function(){};MO.FTimeline_process=function(b){this.__base.MTimelineActions.process.call(this,b);this.__base.MTimelines.process.call(this,b)};MO.FTimeline_dispose=function(){this._actions=MO.Lang.Obejct.dispose(this._actions);this.__base.MTimelineActions.dispose.call(this);this.__base.FObject.dispose.call(this)};MO.RStage=function(){this._started=!1;this._thread=null;this._active=!0;this._interval=10;this.lsnsLeaveFrame=this.lsnsEnterFrame=this._stages=null;this.construct();return this};
MO.RStage.prototype.onProcess=function(b){if(this._active)try{this.lsnsEnterFrame.process(this);var d=this._stages;if(d){var f=d.count();for(b=0;b<f;b++)d.at(b).process()}this.lsnsLeaveFrame.process(this);MO.Timer.update()}catch(h){alert(h)}};MO.RStage.prototype.construct=function(){this.lsnsEnterFrame=new MO.TListeners;this.lsnsLeaveFrame=new MO.TListeners};MO.RStage.prototype.register=function(b,d){var f=this._stages;f||(f=this._stages=new MO.TDictionary);f.set(b,d)};
MO.RStage.prototype.unregister=function(b){this._stages.removeValue(b)};MO.RStage.prototype.active=function(){var b=this._stages;if(b)for(var d=b.count(),f=0;f<d;f++)b.at(f).active()};MO.RStage.prototype.process=function(){this.onProcess()};MO.RStage.prototype.deactive=function(){var b=this._stages;if(b)for(var d=b.count(),f=0;f<d;f++)b.at(f).deactive()};
MO.RStage.prototype.start=function(b){this._started||(MO.RE3dEngine.setup(),this.active(),MO.Timer.setup(),null==b&&(b=this._interval),this._interval=parseInt(b),b=this._thread=MO.Class.create(MO.FThread),b.setInterval(this._interval),b.addProcessListener(this,this.onProcess),MO.Console.find(MO.FThreadConsole).start(b),this._started=!0)};MO.RStage=new MO.RStage;
MO.MAudio=function(b){b=MO.Class.inherits(this,b,MO.MListener);b._ready=MO.Class.register(b,new MO.AGetterSource("_ready","testReady"),!1);b._loaded=MO.Class.register(b,new MO.AGetterSource("_loaded","testLoaded"),!1);b._finish=MO.Class.register(b,new MO.AGetterSource("_finish","testFinish"),!1);b._listenersLoad=MO.Class.register(b,new MO.AListener("_listenersLoad",MO.EEvent.Load));b.construct=MO.MAudio_construct;b.volume=MO.MAudio_volume;b.setVolume=MO.MAudio_setVolume;b.loop=MO.MAudio_loop;b.setLoop=
MO.MAudio_setLoop;b.play=MO.MAudio_play;b.pause=MO.MAudio_pause;b.dispose=MO.MAudio_dispose;return b};MO.MAudio_construct=function(){this.__base.FObject.construct.call(this)};MO.MAudio_volume=function(){return 0};MO.MAudio_setVolume=function(b){};MO.MAudio_loop=function(){return!1};MO.MAudio_setLoop=function(b){};MO.MAudio_play=function(b){};MO.MAudio_pause=function(){};MO.MAudio_dispose=function(){this.__base.MListener.dispose.call(this)};
MO.MLinkerResource=function(b){b=MO.Class.inherits(this,b);b._resource=MO.Class.register(b,new MO.AGetSet("_resource"));b.loadResource=MO.MLinkerResource_loadResource;b.reloadResource=MO.MLinkerResource_reloadResource;b.dispose=MO.MLinkerResource_dispose;return b};MO.MLinkerResource_loadResource=function(b){this._resource=b};MO.MLinkerResource_reloadResource=function(){this.loadResource(this._resource)};MO.MLinkerResource_dispose=function(){this._resource=null};
MO.FAudio=function(b){b=MO.Class.inherits(this,b,MO.FObject,MO.MAudio);b._url=MO.Class.register(b,new MO.AGetter("_url"));b._hAudio=null;b.onLoad=MO.FAudio_onLoad;b.onLoaded=MO.FAudio_onLoaded;b.onError=MO.FAudio_onError;b.construct=MO.FAudio_construct;b.volume=MO.FAudio_volume;b.setVolume=MO.FAudio_setVolume;b.loop=MO.FAudio_loop;b.setLoop=MO.FAudio_setLoop;b.play=MO.FAudio_play;b.pause=MO.FAudio_pause;b.loadUrl=MO.FAudio_loadUrl;b.dispose=MO.FAudio_dispose;return b};
MO.FAudio_onLoad=function(){this._ready=!0;MO.Logger.info(this,"Audio load success. (url={1})",this._url)};MO.FAudio_onLoaded=function(b){this._finish=this._loaded=this._ready=!0;MO.Logger.info(this,"Audio loaded success. (url={1})",this._url)};MO.FAudio_onError=function(b){this._finish=!0;MO.Logger.error(this,"Load image failure. (url={1})",this._url)};MO.FAudio_construct=function(){this.__base.FObject.construct.call(this);this.__base.MAudio.construct.call(this)};MO.FAudio_volume=function(){return this._hAudio.volume};
MO.FAudio_setVolume=function(b){this._hAudio.volume=b};MO.FAudio_loop=function(){return this._hAudio.loop};MO.FAudio_setLoop=function(b){this._hAudio.loop=b};MO.FAudio_play=function(b){var d=this._hAudio;null!=b&&d.currentTime!=b&&(d.currentTime=b);d.play()};MO.FAudio_pause=function(){this._hAudio.pause()};
MO.FAudio_loadUrl=function(b){b=MO.Console.find(MO.FEnvironmentConsole).parse(b);var d=this._hAudio;d||(d=this._hAudio=new Audio,d.loop=!1,d.oncanplay=this.onLoad.bind(this),d.oncanplaythrough=this.onLoaded.bind(this),d.onerror=this.onError.bind(this));MO.Window.Browser.capability.soundFinish||(this._finish=this._loaded=this._ready=!0);this._url=b;d.src=b};
MO.FAudio_dispose=function(){this._hAudio=MO.Window.Html.free(this._hAudio);this.__base.MListenerLoad.dispose.call(this);this.__base.MAudio.dispose.call(this);this.__base.FObject.dispose.call(this)};
MO.FAudioBuffer=function(b){b=MO.Class.inherits(this,b,MO.FObject,MO.MAudio);b._context=MO.Class.register(b,new MO.AGetSet("_context"));b._url=MO.Class.register(b,new MO.AGetSet("_url"));b._handle=MO.Class.register(b,new MO.AGetter("_handle"));b._buffer=MO.Class.register(b,new MO.AGetter("_buffer"));b.onDecodeSuccess=MO.FAudioBuffer_onDecodeSuccess;b.onDecodeFailure=MO.FAudioBuffer_onDecodeFailure;b.onLoad=MO.FAudioBuffer_onLoad;b.construct=MO.FAudioBuffer_construct;b.testReady=MO.FAudioBuffer_testReady;
b.loadUrl=MO.FAudioBuffer_loadUrl;b.play=MO.FAudioBuffer_play;b.dispose=MO.FAudioBuffer_dispose;return b};MO.FAudioBuffer_onDecodeSuccess=function(b){var d=this._context.handle(),f=this._buffer=d.createBufferSource();f.buffer=b;f.connect(d.destination);this._finish=this._loaded=this._ready=!0;b=new MO.SEvent(this);this.processLoadListener(b);b.dispose()};MO.FAudioBuffer_onDecodeFailure=function(b){this._finish=!0;MO.Logger.error(this,"Decode audio buffer failure. (url={1})",this._url)};
MO.FAudioBuffer_onLoad=function(b){b=b.outputData();this._context.handle().decodeAudioData(b,this.onDecodeSuccess.bind(this),this.onDecodeFailure.bind(this))};MO.FAudioBuffer_construct=function(){this.__base.FObject.construct.call(this);this.__base.MAudio.construct.call(this)};MO.FAudioBuffer_testReady=function(){return this._ready};
MO.FAudioBuffer_loadUrl=function(b){this._url=MO.Console.find(MO.FEnvironmentConsole).parse(b);MO.Console.find(MO.FHttpConsole).sendAsync(this._url).addLoadListener(this,this.onLoad)};MO.FAudioBuffer_play=function(b){this._buffer.start(MO.Lang.Integer.nvl(b))};MO.FAudioBuffer_dispose=function(){this.__base.MAudio.dispose.call(this);this.__base.FObject.dispose.call(this)};
MO.FAudioConsole=function(b){b=MO.Class.inherits(this,b,MO.FConsole);b._scopeCd=MO.EScope.Global;b._audios=null;b.construct=MO.FAudioConsole_construct;b.create=MO.FAudioConsole_create;b.load=MO.FAudioConsole_load;b.dispose=MO.FAudioConsole_dispose;return b};MO.FAudioConsole_construct=function(){this.__base.FConsole.construct.call(this);this._audios=new MO.TDictionary};
MO.FAudioConsole_create=function(b){b=MO.Console.find(MO.FEnvironmentConsole).parse(b);var d=MO.Class.create(MO.FAudioResource);d.loadUrl(b);return d};MO.FAudioConsole_load=function(b){var d=this._audios,f=d.get(b);f||(f=this.create(b),d.set(b,f));return f};MO.FAudioConsole_dispose=function(){this._audios=MO.Lang.Object.dispose(this._audios);this.__base.FConsole.dispose.call(this)};
MO.FAudioContext=function(b){b=MO.Class.inherits(this,b,MO.FObject);b._handle=MO.Class.register(b,new MO.AGetter("_handle"));b._buffers=MO.Class.register(b,new MO.AGetter("_buffers"));b.construct=MO.FAudioContext_construct;b.setup=MO.FAudioContext_setup;b.createBuffer=MO.FAudioContext_createBuffer;b.dispose=MO.FAudioContext_dispose;return b};MO.FAudioContext_construct=function(){this.__base.FObject.construct.call(this);this._buffers=new MO.TDictionary};
MO.FAudioContext_setup=function(b){this._audioBuffers=new MO.TDictionary;b=null;window.AudioContext?b=new AudioContext:window.webkitAudioContext&&(b=new webkitAudioContext);if(!b)return MO.Logger.error(this,"Invalid audio context.");this._handle=b};MO.FAudioContext_createBuffer=function(b){b=MO.Console.find(MO.FEnvironmentConsole).parse(b);var d=null;this._handle=null,d=MO.Class.create(MO.FAudio);d.loadUrl(b);return d};
MO.FAudioContext_dispose=function(){this._buffers=MO.Lang.Object.dispose(this._buffers);this.__base.FObject.dispose.call(this)};MO.FAudioContextConsole=function(b){b=MO.Class.inherits(this,b,MO.FConsole);b._scopeCd=MO.EScope.Global;b._contexts=null;b.construct=MO.FAudioContextConsole_construct;b.create=MO.FAudioContextConsole_create;b.dispose=MO.FAudioContextConsole_dispose;return b};MO.FAudioContextConsole_construct=function(){this.__base.FConsole.construct.call(this);this._contexts=new MO.TObjects};
MO.FAudioContextConsole_create=function(b){b=MO.Class.create(MO.FAudioContext);b.setup();this._contexts.push(b);return b};MO.FAudioContextConsole_dispose=function(){this._contexts=MO.Lang.Object.dispose(this._contexts);this.__base.FConsole.dispose.call(this)};MO.FAudioResource=function(b){return b=MO.Class.inherits(this,b,MO.FAudio)};
MO.FImageConsole=function(b){b=MO.Class.inherits(this,b,MO.FConsole);b._scopeCd=MO.EScope.Global;b._images=null;b.construct=MO.FImageConsole_construct;b.create=MO.FImageConsole_create;b.load=MO.FImageConsole_load;b.dispose=MO.FImageConsole_dispose;return b};MO.FImageConsole_construct=function(){this.__base.FConsole.construct.call(this);this._images=new MO.TDictionary};
MO.FImageConsole_create=function(b){b=MO.Console.find(MO.FEnvironmentConsole).parse(b);var d=MO.Class.create(MO.FImageResource);d.loadUrl(b);return d};MO.FImageConsole_load=function(b){var d=this._images,f=d.get(b);f||(f=this.create(b),d.set(b,f));return f};MO.FImageConsole_dispose=function(){this._images=MO.Lang.Object.dispose(this._images);this.__base.FConsole.dispose.call(this)};MO.FImageResource=function(b){return b=MO.Class.inherits(this,b,MO.FImage)};
MO.FResource=function(b){b=MO.Class.inherits(this,b,MO.FObject);b._typeCode=MO.Class.register(b,new MO.AGetter("_typeCode"));b._type=MO.Class.register(b,new MO.AGetter("_type"));b._guid=MO.Class.register(b,new MO.AGetSet("_guid"));b._code=MO.Class.register(b,new MO.AGetSet("_code"));b._label=MO.Class.register(b,new MO.AGetSet("_label"));b._sourceUrl=MO.Class.register(b,new MO.AGetSet("_sourceUrl"));b._dataCompress=!1;b._dataBlock=!1;return b};
MO.FResourceBlockStorage=function(b){b=MO.Class.inherits(this,b,MO.FResourceStorage);b._ready=!1;b._dataLength=0;b._blockSize=0;b._blockCount=0;b._blocks=MO.Class.register(b,new MO.AGetter("_blocks"));b._resource=null;b.construct=MO.FResourceBlockStorage_construct;b.testReady=MO.FResourceBlockStorage_testReady;b.load=MO.FResourceBlockStorage_load;b.complete=MO.FResourceBlockStorage_complete;b.dispose=MO.FResourceBlockStorage_dispose;return b};
MO.FResourceBlockStorage_construct=function(){this.__base.FResourceStorage.construct.call(this);this._blocks=new MO.TObjects};MO.FResourceBlockStorage_testReady=function(){if(!this._ready){for(var b=this._blocks,d=b.count(),f=0;f<d;f++)if(!b.at(f).testReady())return!1;this._ready=!0}return this._ready};
MO.FResourceBlockStorage_load=function(b){var d=this._resource;this._compressLength=b.byteLength;var f=MO.Class.create(MO.FDataView);f.setEndianCd(!0);f.link(b);f.readString();this._dataLength=f.readInt32();this._blockSize=f.readInt32();b=this._blockCount=f.readInt32();for(var h=this._blocks,q=0;q<b;q++){var w=f.readInt32(),z=new ArrayBuffer(w);f.readBytes(z,0,w);w=MO.Class.create(MO.FResourceBlockStorageData);w._guid=d.guid();w._index=q;w.setCompressData(z);h.push(w)}f.dispose()};
MO.FResourceBlockStorage_complete=function(){var b=this._resource,d=MO.Class.create(MO.FDataStream);d.setEndianCd(!0);d.setLength(this._dataLength);for(var f=this._blocks,h=f.count(),q=0;q<h;q++){var w=f.at(q)._data;d.writeBytes(w.buffer,0,w.byteLength)}d.flip();f=MO.Timer.current()-b._compressStartTick;MO.Logger.info(this,"Process resource storage. (guid={1}, block_count={2}, length={3}, total={4}, tick={5})",b.guid(),h,this._compressLength,this._dataLength,f);b.onComplete(d);d.dispose()};
MO.FResourceBlockStorage_dispose=function(){this._resource=null;var b=this._blocks;if(b){for(var d=b.count(),f=0;f<d;f++)b.at(f).dispose();this._blocks=MO.Lang.Object.dispose(b)}this.__base.FResourceStorage.dispose.call(this)};MO.FResourceBlockStorageData=function(b){b=MO.Class.inherits(this,b,MO.FObject,MO.MResourceData);b.dispose=MO.FResourceBlockStorageData_dispose;return b};MO.FResourceBlockStorageData_dispose=function(){this.__base.MResourceData.dispose.call(this);this.__base.FObject.dispose.call(this)};
MO.FResourceConsole=function(b){b=MO.Class.inherits(this,b,MO.FConsole);b._scopeCd=MO.EScope.Global;b._factory=null;b._types=null;b._resources=null;b._loadResources=null;b._loadingResources=null;b._processStorages=null;b._thread=null;b._loadLimit=8;b._interval=150;b.onComplete=MO.FResourceConsole_onComplete;b.onLoad=MO.FResourceConsole_onLoad;b.onBlockLoad=MO.FResourceConsole_onBlockLoad;b.onProcess=MO.FResourceConsole_onProcess;b.construct=MO.FResourceConsole_construct;b.registerType=MO.FResourceConsole_registerType;
b.factory=MO.FResourceConsole_factory;b.load=MO.FResourceConsole_load;return b};MO.FResourceConsole_onComplete=function(b,d){b._data=null;this._loadingResources.remove(b);b.onComplete(d)};MO.FResourceConsole_onLoad=function(b){var d=b.outputData();b=b._resource;var f=MO.Class.create(MO.FResourceSingleStorage);f.setResource(b);f.load(d);MO.Console.find(MO.FResourceDataConsole).load(f);this._loadingResources.remove(b);this._processStorages.push(f)};
MO.FResourceConsole_onBlockLoad=function(b){var d=b.outputData();b=b._resource;b._compressLength=d.byteLength;b._compressStartTick=RTimer.current();var f=MO.Class.create(MO.FResourceBlockStorage);f.setResource(b);f.load(d);for(var d=MO.Console.find(MO.FResourceDataConsole),h=f.blocks(),q=h.count(),w=0;w<q;w++){var z=h.at(w);d.load(z)}this._loadingResources.remove(b);this._processStorages.push(f)};
MO.FResourceConsole_onProcess=function(){var b=MO.Console.find(MO.FHttpConsole),d=this._loadResources,f=this._loadingResources,h=f.count();if(!d.isEmpty())for(h=this._loadLimit-h;0<h;h--){var q=d.shift(),w=q.sourceUrl(),w=b.send(w);w._resource=q;q._dataCompress?q._dataBlock?w.addLoadListener(this,this.onBlockLoad):w.addLoadListener(this,this.onLoad):w.addLoadListener(this,this.onComplete);q._dataLoad=!0;f.push(q);if(d.isEmpty())break}b=this._processStorages;for(b.record();b.next();)d=b.current(),
d.testReady()&&(b.removeCurrent(),d.complete(),d.dispose())};MO.FResourceConsole_construct=function(){this.__base.FConsole.construct.call(this);this._factory=MO.Class.create(MO.FClassFactory);this._types=new MO.TDictionary;this._resources=new MO.TDictionary;this._loadResources=new MO.TObjects;this._loadingResources=new MO.TObjects;this._processStorages=new MO.TLooper;var b=this._thread=MO.Class.create(MO.FThread);b.setInterval(this._interval);b.addProcessListener(this,this.onProcess);MO.Console.find(MO.FThreadConsole).start(b)};
MO.FResourceConsole_registerType=function(b){var d=b.code();return this._types.set(d,b)};MO.FResourceConsole_factory=function(){return this._factory};MO.FResourceConsole_load=function(b){var d=b.guid(),f=this._resources;if(f.contains(d))throw new MO.TError(this,"Resource is already loaded. (guid={1})",d);f.set(d,b);this._loadResources.push(b);b._dataLoad=!0};
MO.FResourceDataConsole=function(b){b=MO.Class.inherits(this,b,MO.FConsole);b._scopeCd=MO.EScope.Global;b._loadDatas=null;b._processDatas=null;b._pipeline=null;b._pipelinePool=null;b._thread=null;b._processLimit=4;b._interval=200;b.onPipelineComplete=MO.FResourceDataConsole_onPipelineComplete;b.onProcess=MO.FResourceDataConsole_onProcess;b.construct=MO.FResourceDataConsole_construct;b.allocPipeline=MO.FResourceDataConsole_allocPipeline;b.freePipeline=MO.FResourceDataConsole_freePipeline;b.load=MO.FResourceDataConsole_load;
return b};MO.FResourceDataConsole_onPipelineComplete=function(b,d){b&&this.freePipeline(b);this._processDatas.remove(d)};MO.FResourceDataConsole_onProcess=function(){var b=this._loadDatas,d=b.count();if(0!=d){var f=this._pipeline;if(f)f.testBusy()||(d=b.shift(),f.decompress(d));else{var h=this._processDatas,f=h.count(),f=this._processLimit-f;if(!(0>=f))for(var q=Math.min(d,f),w=0;w<q;w++)d=b.shift(),f=this.allocPipeline(),f.decompress(d),h.push(d)}}};
MO.FResourceDataConsole_construct=function(){this.__base.FConsole.construct.call(this);this._loadDatas=new MO.TObjects;this._processDatas=new MO.TObjects;this._pipelinePool=MO.Class.create(MO.FObjectPool);MO.Window.Browser.capability().optionProcess||(this._pipeline=MO.Class.create(FResourceSinglePipeline)).setConsole(this);var b=this._thread=MO.Class.create(MO.FThread);b.setInterval(this._interval);b.addProcessListener(this,this.onProcess);MO.Console.find(MO.FThreadConsole).start(b)};
MO.FResourceDataConsole_allocPipeline=function(){var b=this._pipelinePool;if(!b.hasFree()){var d=MO.Class.create(MO.FResourceThreadPipeline);d.setConsole(this);b.push(d)}return b.alloc()};MO.FResourceDataConsole_freePipeline=function(b){this._pipelinePool.free(b)};MO.FResourceDataConsole_load=function(b){this._loadDatas.push(b)};MO.FResourceGroup=function(b){b=RClass.inherits(this,b,FObject);b._code=MO.Class.register(b,new MO.AGetter("_code"));b._resources=null;return b};
MO.FResourceObject=function(b){b=MO.Class.inherits(this,b,MO.FObject);b._typeCode=MO.Class.register(b,new MO.AGetter("_typeCode"));b._guid=MO.Class.register(b,new MO.AGetSet("_guid"));b._code=MO.Class.register(b,new MO.AGetSet("_code"));b._label=MO.Class.register(b,new MO.AGetSet("_label"));return b};
MO.FResourcePipeline=function(b){b=MO.Class.inherits(this,b,MO.FPipeline);b._console=MO.Class.register(b,new MO.AGetSet("_console"));b._compressCd=MO.Class.register(b,new MO.AGetter("_compressCd"));b._resource=MO.Class.register(b,new MO.AGetSet("_resource"));b.dispose=MO.FResourcePipeline_dispose;return b};MO.FResourcePipeline_dispose=function(){this._resource=this._console=null;this.__base.FPipeline.dispose.call(this)};
MO.FResourceSinglePipeline=function(b){b=MO.Class.inherits(this,b,MO.FResourcePipeline);b._startTime=0;b._statusBusy=!1;b._data=0;b._dataLength=0;b._worker=null;b.onComplete=MO.FResourceSinglePipeline_onComplete;b.construct=MO.FResourceSinglePipeline_construct;b.testBusy=MO.FResourceSinglePipeline_testBusy;b.decompress=MO.FResourceSinglePipeline_decompress;b.dispose=MO.FResourceSinglePipeline_dispose;return b};
MO.FResourceSinglePipeline_onComplete=function(b){var d=this._data,f=null;if(b.constructor==Array)f=new Uint8Array(b);else if(b.constructor==ArrayBuffer)f=b;else throw new MO.TError(this,"Unknown buffer type.");d.completeData(f);b=MO.Timer.now()-this._startTime;MO.Logger.info(this,"Process resource data decompress. (guid={1}, block={2}, length={3}, total={4}, tick={5})",d._guid,d._index,this._dataLength,f.byteLength,b);this._console.onPipelineComplete(null,d);this._data=null;this._statusBusy=!1};
MO.FResourceSinglePipeline_construct=function(){this.__base.FResourcePipeline.construct.call(this)};MO.FResourceSinglePipeline_testBusy=function(){return this._statusBusy};
MO.FResourceSinglePipeline_decompress=function(b){var d=this;d._statusBusy=!0;d._startTime=MO.Timer.current();var f=b.compressData();d._data=b;d._dataLength=f.byteLength;b=null;if(f.constructor==ArrayBuffer)b=new Uint8Array(f);else if(f.constructor==Uint8Array)b=f;else throw new MO.TError(d,"Unknown data type.");LZMAD.decompress(b,function(b){d.onComplete(b)},null)};MO.FResourceSinglePipeline_dispose=function(){this._worker=this._data=null;this.__base.FPipeline.dispose.call(this)};
MO.FResourceSingleStorage=function(b){b=MO.Class.inherits(this,b,MO.FResourceStorage,MO.MResourceData);b.construct=MO.FResourceSingleStorage_construct;b.load=MO.FResourceSingleStorage_load;b.complete=MO.FResourceSingleStorage_complete;b.dispose=MO.FResourceSingleStorage_dispose;return b};MO.FResourceSingleStorage_construct=function(){this.__base.FResourceStorage.construct.call(this)};MO.FResourceSingleStorage_load=function(b){this._compressLength=b.byteLength;this._compressData=new Uint8Array(b)};
MO.FResourceSingleStorage_complete=function(){this._resource.onComplete(this._data)};MO.FResourceSingleStorage_dispose=function(){this.__base.MResourceData.dispose.call(this);this.__base.FResourceStorage.dispose.call(this)};
MO.FResourceStorage=function(b){b=MO.Class.inherits(this,b,MO.FObject);b._ready=!1;b._dataLength=0;b._resource=MO.Class.register(b,new MO.AGetSet("_resource"));b.construct=MO.FResourceStorage_construct;b.testReady=MO.FResourceStorage_testReady;b.load=MO.FResourceStorage_load;b.complete=MO.FResourceStorage_complete;b.dispose=MO.FResourceStorage_dispose;return b};MO.FResourceStorage_construct=function(){this.__base.FObject.construct.call(this)};MO.FResourceStorage_testReady=function(){return this._ready};
MO.FResourceStorage_load=function(b){};MO.FResourceStorage_complete=function(){};MO.FResourceStorage_dispose=function(){this._resource=null;this.__base.FObject.dispose.call(this)};
MO.FResourceThreadPipeline=function(b){b=MO.Class.inherits(this,b,MO.FResourcePipeline);b._startTime=0;b._data=0;b._dataLength=0;b._worker=null;b.onComplete=MO.FResourceThreadPipeline_onComplete;b.construct=MO.FResourceThreadPipeline_construct;b.worker=MO.FResourceThreadPipeline_worker;b.decompress=MO.FResourceThreadPipeline_decompress;b.dispose=MO.FResourceThreadPipeline_dispose;return b};
MO.FResourceThreadPipeline_onComplete=function(b){var d=null;if(b.constructor==Array)d=new Uint8Array(b);else if(b.constructor==Uint8Array)d=b;else throw new MO.TError(this,"Unknown buffer type.");var f=this._data;f.completeData(d);d=MO.Timer.now()-this._startTime;MO.Logger.info(this,"Process resource data decompress. (guid={1}, block={2}, length={3}, total={4}, tick={5})",f._guid,f._index,this._dataLength,b.byteLength,d);this._console.onPipelineComplete(this,f);this._data=null};
MO.FResourceThreadPipeline_construct=function(){this.__base.FResourcePipeline.construct.call(this)};MO.FResourceThreadPipeline_worker=function(){var b=this._worker;b||(b=MO.RBrowser.contentPath("/ajs/lzma_worker.js"),b=this._worker=new LZMA_WORKER(b));return b};MO.FResourceThreadPipeline_decompress=function(b){var d=this;d._startTime=MO.Timer.current();var f=b.compressData();d._data=b;d._dataLength=f.byteLength;d.worker().decompress(f,function(b){d.onComplete(b)},null)};
MO.FResourceThreadPipeline_dispose=function(){this._worker=this._data=null;this.__base.FPipeline.dispose.call(this)};MO.FResourceType=function(b){b=MO.Class.inherits(this,b,MO.FObject);b._code=MO.Class.register(b,new MO.AGetSet("_code"));b._pipeline=MO.Class.register(b,new MO.AGetSet("_pipeline"));b._resources=MO.Class.register(b,new MO.AGetter("_resources"));b.construct=MO.FResourceType_construct;b.findResource=MO.FResourceType_findResource;b.dispose=MO.FResourceType_dispose;return b};
MO.FResourceType_construct=function(){this.__base.FObject.construct.call(this);this._resources=new MO.TDictionary};MO.FResourceType_findResource=function(b){return this._resources.get(b)};MO.FResourceType_dispose=function(){this._resources=MO.Lang.Object.dispose(this._resources);this.__base.FObject.dispose.call(this)};
MO.FE2dCanvas=function(b){b=MO.Class.inherits(this,b,MO.FCanvas,MO.MCanvasObject,MO.MGraphicObject);b._size=MO.Class.register(b,new MO.AGetter("_size"));b._hCanvas=null;b.onResize=MO.FE2dCanvas_onResize;b.construct=MO.FE2dCanvas_construct;b.htmlCanvas=MO.FE2dCanvas_htmlCanvas;b.build=MO.FE2dCanvas_build;b.setPanel=MO.FE2dCanvas_setPanel;b.resize=MO.FE2dCanvas_resize;b.show=MO.FE2dCanvas_show;b.hide=MO.FE2dCanvas_hide;b.setVisible=MO.FE2dCanvas_setVisible;b.reset=MO.FE2dCanvas_reset;b.dispose=MO.FE2dCanvas_dispose;
return b};MO.FE2dCanvas_onResize=function(b){};MO.FE2dCanvas_construct=function(){this.__base.FCanvas.construct.call(this);this._size=new MO.SSize2(1280,720)};MO.FE2dCanvas_htmlCanvas=function(){return this._hCanvas};MO.FE2dCanvas_build=function(b){var d=this._size,f=d.width,d=d.height;b=this._hCanvas=MO.RBuilder.create(b,"CANVAS");b.__linker=this;b.width=f;b.height=d;f=b.style;f.left="0px";f.top="0px";f.width="100%";f.height="100%";(this._graphicContext=MO.Class.create(MO.FG2dCanvasContext)).linkCanvas(b)};
MO.FE2dCanvas_setPanel=function(b){var d=this._hCanvas;this._hPanel=b;b.appendChild(d);this.onResize()};MO.FE2dCanvas_resize=function(b,d){this._size.set(b,d);this._graphicContext.size().set(b,d);var f=this._hCanvas;f.width=b;f.height=d};MO.FE2dCanvas_show=function(){this.setVisible(!0)};MO.FE2dCanvas_hide=function(){this.setVisible(!1)};MO.FE2dCanvas_setVisible=function(b){MO.Window.Html.visibleSet(this._hCanvas,b)};MO.FE2dCanvas_reset=function(){this._graphicContext.clear()};
MO.FE2dCanvas_dispose=function(){this._size=MO.RObject.dispose(this._size);this._graphicContext=MO.RObject.dispose(this._graphicContext);this._hPanel=MO.RHtml.free(this._hPanel);this._hCanvas=MO.RHtml.free(this._hCanvas);this.__base.FCanvas.dispose.call(this)};MO.FE2dCanvasConsole=function(b){b=MO.Class.inherits(this,b,MO.FConsole);b._scopeCd=MO.EScope.Local;b._pools=null;b.construct=MO.FE2dCanvasConsole_construct;b.allocBySize=MO.FE2dCanvasConsole_allocBySize;b.free=MO.FE2dCanvasConsole_free;return b};
MO.FE2dCanvasConsole_construct=function(){this.__base.FConsole.construct.call(this);this._pools=MO.Class.create(MO.FObjectPools)};MO.FE2dCanvasConsole_allocBySize=function(b,d){var f=this._pools.alloc(b+"x"+d);f||(f=MO.Class.create(FE2dCanvas),f.size().set(b,d),f.build(MO.RWindow._hDocument));f.reset();return f};MO.FE2dCanvasConsole_free=function(b){var d=this._pools,f=b.size();d.free(f.width+"x"+f.height,b)};MO.FE2dDrawable=function(b){return b=MO.Class.inherits(this,b,MO.FDrawable)};
MO.ME3dObject=function(b){b=MO.Class.inherits(this,b,MO.MGraphicObject,MO.MAttributeCode);b._guid=MO.Class.register(b,new MO.AGetSet("_guid"));return b};
MO.FE3dCanvas=function(b){b=MO.Class.inherits(this,b,MO.FCanvas,MO.MGraphicObject,MO.MMouseCapture);b._optionAlpha=!0;b._optionAntialias=!0;b._optionStageProcess=!0;b._optionResize=!0;b._optionMouseCapture=!0;b._listenerLoad=MO.Class.register(b,new MO.AListener("_listenerLoad",MO.EEvent.Load));b._scaleRate=1;b._size=MO.Class.register(b,new MO.AGetter("_size"));b._logicSize=MO.Class.register(b,new MO.AGetter("_logicSize"));b._screenSize=MO.Class.register(b,new MO.AGetter("_screenSize"));b._interval=
10;b._hPanel=null;b._hCanvas=null;b.onEnterFrame=MO.Method.empty;b.ohTouchStart=MO.FE3dCanvas_ohTouchStart;b.ohTouchMove=MO.FE3dCanvas_ohTouchMove;b.ohTouchStop=MO.FE3dCanvas_ohTouchStop;b.onMouseCaptureStart=MO.Method.empty;b.onMouseCapture=MO.Method.empty;b.onMouseCaptureStop=MO.Method.empty;b.onTouchStart=MO.Method.empty;b.onTouchMove=MO.Method.empty;b.onTouchStop=MO.Method.empty;b.onResize=MO.FE3dCanvas_onResize;b.construct=MO.FE3dCanvas_construct;b.build=MO.FE3dCanvas_build;b.resize=MO.FE3dCanvas_resize;
b.show=MO.FE3dCanvas_show;b.hide=MO.FE3dCanvas_hide;b.setVisible=MO.FE3dCanvas_setVisible;b.setPanel=MO.FE3dCanvas_setPanel;b.dispose=MO.FE3dCanvas_dispose;return b};MO.FE3dCanvas_ohTouchStart=function(b){this.__linker.onTouchStart(b)};MO.FE3dCanvas_ohTouchMove=function(b){this.__linker.onTouchMove(b)};MO.FE3dCanvas_ohTouchStop=function(b){this.__linker.onTouchStop(b)};MO.FE3dCanvas_onResize=function(b){this.resize()};
MO.FE3dCanvas_construct=function(){this.__base.FCanvas.construct.call(this);this._size=new MO.SSize2(1280,720);this._logicSize=new MO.SSize2(1280,720);this._screenSize=new MO.SSize2(1280,720)};
MO.FE3dCanvas_build=function(b){var d=this._size,f=d.width,d=d.height;b=this._hCanvas=MO.RBuilder.create(b,"CANVAS");b.__linker=this;b.width=f;b.height=d;f=b.style;f.left="0px";f.top="0px";f.width="100%";f.height="100%";MO.Method.isEmpty(this.onTouchStart)||b.addEventListener("touchstart",this.ohTouchStart,!1);MO.Method.isEmpty(this.onTouchMove)||b.addEventListener("touchmove",this.ohTouchMove,!1);MO.Method.isEmpty(this.onTouchStop)||b.addEventListener("touchend",this.ohTouchStop,!1);f={};f.alpha=
this._optionAlpha;f.antialias=this._optionAntialias;this._graphicContext=MO.REngine3d.createContext(MO.FWglContext,b,f);this._optionStageProcess&&(RStage.lsnsEnterFrame.register(this,this.onEnterFrame),RStage.start(this._interval));this._optionResize&&(MO.RWindow.lsnsResize.register(this,this.onResize),MO.RWindow.lsnsOrientation.register(this,this.onResize));this._optionMouseCapture&&MO.Console.find(MO.FMouseConsole).register(this)};
MO.FE3dCanvas_resize=function(b,d){if(!b||!d)throw new MO.TError(this,"Invalid canvas size.");this._screenSize.set(b,d);var f=parseInt(b*this._scaleRate),h=parseInt(d*this._scaleRate),q=this._hCanvas;q.width=f;q.height=h;this._size.set(f,h);this._graphicContext.setViewport(0,0,f,h)};MO.FE3dCanvas_show=function(){this.setVisible(!0)};MO.FE3dCanvas_hide=function(){this.setVisible(!1)};MO.FE3dCanvas_setVisible=function(b){MO.Window.Html.visibleSet(this._hCanvas,b)};
MO.FE3dCanvas_setPanel=function(b){b.appendChild(this._hCanvas);this._hPanel=b;this.resize()};
MO.FE3dCanvas_dispose=function(){var b=this._hCanvas;b&&(b.__linker=null,b.removeEventListener("touchstart",this.ohTouchStart),b.removeEventListener("touchmove",this.ohTouchMove),b.removeEventListener("touchend",this.ohTouchStop));this._graphicContext=MO.Lang.Object.dispose(this._graphicContext);this._size=MO.Lang.Object.dispose(this._size);this._screenSize=MO.Lang.Object.dispose(this._screenSize);this._logicSize=MO.Lang.Object.dispose(this._logicSize);this._hPanel=MO.RHtml.free(this._hPanel);this._hCanvas=
MO.RHtml.free(this._hCanvas);this.__base.FCanvas.dispose.call(this)};MO.FE3dDisplay=function(b){b=MO.Class.inherits(this,b,MO.FDisplay);b._outline=null;b._materials=MO.Class.register(b,new MO.AGetter("_materials"));b.construct=MO.FE3dDisplay_construct;b.calculateOutline=MO.FE3dDisplay_calculateOutline;b.dispose=MO.FE3dDisplay_dispose;return b};MO.FE3dDisplay_construct=function(){this.__base.FDisplay.construct.call(this);this._outline=new MO.SOutline3};MO.FE3dDisplay_calculateOutline=function(){return this._outline};
MO.FE3dDisplay_dispose=function(){this._materials=MO.Lang.Object.free(this._materials);this.__base.FDisplay.dispose.call(this)};MO.FE3dDisplayContainer=function(b){b=MO.Class.inherits(this,b,MO.FDisplayContainer);b._outline=null;b._materials=MO.Class.register(b,new MO.AGetter("_materials"));b.construct=MO.FE3dDisplayContainer_construct;b.calculateOutline=MO.FE3dDisplayContainer_calculateOutline;b.dispose=MO.FE3dDisplayContainer_dispose;return b};
MO.FE3dDisplayContainer_construct=function(){this.__base.FDisplayContainer.construct.call(this);this._outline=new MO.SOutline3d};MO.FE3dDisplayContainer_calculateOutline=function(){var b=this._outline;if(b.isEmpty()){b.setMin();var d=this._renderables;if(d)for(var f=d.count(),h=0;h<f;h++){var q=d.at(h).calculateOutline();b.mergeMax(q)}}return b};MO.FE3dDisplayContainer_dispose=function(){this._materials=RObject.dispose(this._materials);this.__base.FDisplayContainer.dispose.call(this)};
MO.FE3dRenderable=function(b){b=MO.Class.inherits(this,b,MO.FRenderable,MO.MG3dRenderable,MO.MGraphicObject,MO.MLinkerResource);b._display=MO.Class.register(b,new MO.AGetSet("_display"));b._outline=null;b._outlineVisible=!0;b._calculateMatrix=null;b._vertexCount=MO.Class.register(b,new MO.AGetSet("_vertexCount"));b._vertexBuffers=MO.Class.register(b,new MO.AGetter("_vertexBuffers"));b._indexBuffers=MO.Class.register(b,new MO.AGetter("_indexBuffers"));b._materialReference=MO.Class.register(b,new MO.AGetSet("_materialReference"));
b._materials=MO.Class.register(b,new MO.AGetter("_materials"));b._bones=MO.Class.register(b,new MO.AGetter("_bones"));b._textures=MO.Class.register(b,new MO.AGetter("_textures"));b.construct=MO.FE3dRenderable_construct;b.setup=MO.Method.empty;b.testReady=MO.Method.emptyTrue;b.testVisible=MO.FE3dRenderable_testVisible;b.findVertexBuffer=MO.FE3dRenderable_findVertexBuffer;b.pushVertexBuffer=MO.FE3dRenderable_pushVertexBuffer;b.pushIndexBuffer=MO.FE3dRenderable_pushIndexBuffer;b.pushMaterial=MO.FE3dRenderable_pushMaterial;
b.findTexture=MO.FE3dRenderable_findTexture;b.pushTexture=MO.FE3dRenderable_pushTexture;b.processDelay=MO.Method.empty;b.update=MO.FE3dRenderable_update;b.remove=MO.FE3dRenderable_remove;return b};MO.FE3dRenderable_construct=function(){this.__base.FRenderable.construct.call(this);this.__base.MG3dRenderable.construct.call(this);this._outline=new MO.SOutline3d;this._calculateMatrix=new MO.SMatrix3d;this._vertexBuffers=new MO.TDictionary;this._materialReference=this};
MO.FE3dRenderable_testVisible=function(){if(!this.testReady()||!this.__base.FRenderable.testVisible.call(this)||!this._outlineVisible)return!1;var b=this._material;return b&&!b.testVisible()?!1:!0};MO.FE3dRenderable_findVertexBuffer=function(b){return this._vertexBuffers.get(b)};MO.FE3dRenderable_pushVertexBuffer=function(b){var d=b.code();if(MO.Lang.String.isEmpty(d))throw new MO.TError("Buffer code is empty.");var f=this._vertexBuffers;f||(f=this._vertexBuffers=new MO.TDictionary);f.set(d,b)};
MO.FE3dRenderable_pushIndexBuffer=function(b){var d=this._indexBuffers;d||(d=this._indexBuffers=new MO.TObjects);d.push(b)};MO.FE3dRenderable_pushMaterial=function(b){var d=this._materials;d||(d=this._materials=new MO.TObjects);d.push(b)};MO.FE3dRenderable_findTexture=function(b){return this._textures.get(b)};MO.FE3dRenderable_pushTexture=function(b,d){var f=this._textures;f||(f=this._textures=new MO.TDictionary);null!=d?f.set(d,b):b._name?f.set(b._name,b):f.set(b.code(),b)};
MO.FE3dRenderable_update=function(b){var d=this._calculateMatrix;d.assign(this._matrix);var f=this._drawable;f&&d.append(f.currentMatrix());(f=this._display)&&d.append(f.currentMatrix());this._currentMatrix.attachData(d.data())&&b&&b.change()};MO.FE3dRenderable_remove=function(){var b=this._display;b&&(b.removeRenderable(this),this._display=null)};
MO.FE3dStage=function(b){b=MO.Class.inherits(this,b,MO.FStage,MO.MGraphicObject);b._statistics=MO.Class.register(b,new MO.AGetter("_statistics"));b._technique=MO.Class.register(b,new MO.AGetter("_technique"));b._region=MO.Class.register(b,new MO.AGetter("_region"));b._allDisplays=null;b.onProcess=MO.FE3dStage_onProcess;b.construct=MO.FE3dStage_construct;b.createRegion=MO.FE3dStage_createRegion;b.linkGraphicContext=MO.FE3dStage_linkGraphicContext;b.setup=MO.FE3dStage_setup;b.camera=MO.FE3dStage_camera;
b.projection=MO.FE3dStage_projection;b.directionalLight=MO.FE3dStage_directionalLight;b.selectTechnique=MO.FE3dStage_selectTechnique;b.filterDisplays=MO.FE3dStage_filterDisplays;b.allDisplays=MO.FE3dStage_allDisplays;return b};
MO.FE3dStage_onProcess=function(){var b=this._region;if(b){var d=this._technique;if(d){var f=d._graphicContext,h=b._statistics=this._statistics;h.resetFrame();h._frame.begin();h._frameProcess.begin();f.prepare();d.updateRegion(b);b.prepare();b.change();for(var f=this._layers,q=f.count(),w=0;w<q;w++){var z=f.at(w);b.reset();z.process(b);z.filterRenderables(b);b.update()}MO.Console.find(MO.FE3dStageConsole).process(b);h._frameProcess.end();h._frameDraw.begin();if(b.isChanged()){d.clear(b.backgroundColor());
for(w=0;w<q;w++){var z=f.at(w),A=z.technique();A||(A=d);b.reset();b.renderables().assign(z.visibleRenderables());z.optionClearDepth()&&A.clearDepth();A.drawRegion(b)}d.present(b)}h._frameDraw.end();h._frame.end()}}};
MO.FE3dStage_construct=function(){this.__base.FStage.construct.call(this);this._statistics=MO.Class.create(MO.FE3dStageStatistics);MO.Console.find(MO.FStatisticsConsole).register("engine.stage",this._statistics);this._allDisplays=new MO.TObjects;(this._region=this.createRegion())._timer=this._timer};MO.FE3dStage_createRegion=function(){return MO.Class.create(MO.FE3dRegion)};
MO.FE3dStage_linkGraphicContext=function(b){this.__base.MGraphicObject.linkGraphicContext.call(this,b);var d=this._region;d&&d.linkGraphicContext(b)};MO.FE3dStage_setup=function(){this.__base.FStage.construct.call(this);this._region.linkGraphicContext(this);this._region.setup()};MO.FE3dStage_camera=function(){return this._region.camera()};MO.FE3dStage_projection=function(){return this._region.camera().projection()};MO.FE3dStage_directionalLight=function(){return this._region.directionalLight()};
MO.FE3dStage_selectTechnique=function(b,d){return this._technique=MO.Console.find(MO.FG3dTechniqueConsole).find(b,d)};MO.FE3dStage_filterDisplays=function(b){for(var d=this._layers,f=d.count(),h=0;h<f;h++)d.at(h).filterDisplays(b)};MO.FE3dStage_allDisplays=function(){var b=this._allDisplays;b.clear();this.filterDisplays(b);return b};
MO.FE3dStageConsole=function(b){b=MO.Class.inherits(this,b,MO.FConsole);b._scopeCd=MO.EScope.Local;b._looper=null;b._thread=null;b._interval=25;b._limit=8;b.onProcess=MO.FE3dStageConsole_onProcess;b.construct=MO.FE3dStageConsole_construct;b.process=MO.FE3dStageConsole_process;return b};MO.FE3dStageConsole_onProcess=function(){var b=this._looper;b.record();for(var d=this._limit-1;0<=d;d--){var f=b.next();if(f)f.processDelay(f._linkRegion);else break}};
MO.FE3dStageConsole_construct=function(){this.__base.FConsole.construct.call(this);this._looper=new MO.TLooper;this._renderables=new MO.TDictionary;var b=this._thread=MO.Class.create(MO.FThread);b.setInterval(this._interval);b.addProcessListener(this,this.onProcess);MO.Console.find(MO.FThreadConsole).start(b)};MO.FE3dStageConsole_process=function(b){for(var d=b.allRenderables(),f=d.count()-1;0<=f;f--){var h=d.at(f);h._linkStageLooper||(h._linkRegion=b,h._linkStageLooper=this._looper,this._looper.push(h))}};
MO.FE3dStageStatistics=function(b){b=MO.Class.inherits(this,b,MO.FStatistics);b._frame=null;b._frameProcess=null;b._frameDraw=null;b._frameDrawSort=null;b._frameDrawRenderable=null;b.construct=MO.FE3dStageStatistics_construct;b.reset=MO.FE3dStageStatistics_reset;b.resetFrame=MO.FE3dStageStatistics_resetFrame;return b};
MO.FE3dStageStatistics_construct=function(){this.__base.FStatistics.construct.call(this);this._frame=new MO.TSpeed;this._frameProcess=new MO.TSpeed;this._frameDraw=new MO.TSpeed;this._frameDrawSort=new MO.TSpeed;this._frameDrawRenderable=new MO.TSpeed};MO.FE3dStageStatistics_reset=function(){};MO.FE3dStageStatistics_resetFrame=function(){this._frame.reset();this._frameProcess.reset();this._frameDraw.reset();this._frameDrawSort.reset();this._frameDrawRenderable.reset()};
MO.FE3dTechnique=function(b){return b=MO.Class.inherits(this,b,MO.FG3dTechnique,MO.MLinkerResource)};MO.RE3dEngine=function(){this._setuped=!1;return this};
MO.RE3dEngine.prototype.onSetup=function(){var b=MO.Console.find(MO.FG3dEffectConsole);b.register("select.select.flat",MO.FG3dSelectAutomaticEffect);b.register("select.select.control",MO.FG3dSelectAutomaticEffect);b.register("select.select.automatic",MO.FG3dSelectAutomaticEffect);b.register("select.select.skeleton",MO.FG3dSelectSkeletonEffect);b.register("select.select.skeleton.4",MO.FG3dSelectSkeletonEffect);b.register("control.control.automatic",MO.FE3dControlAutomaticEffect);b.register("control.control.control",
MO.FE3dControlAutomaticEffect);b.register("general.color.control",MO.FE3dControlAutomaticEffect);b.register("general.color.flat",MO.FE3dGeneralColorFlatEffect);b.register("general.color.automatic",MO.FE3dGeneralColorAutomaticEffect);b.register("general.color.skin",MO.FE3dGeneralColorAutomaticEffect);b.register("general.color.parallax",MO.FE3dGeneralColorAutomaticEffect);b.register("general.color.skeleton",MO.FE3dGeneralColorSkeletonEffect);b.register("general.color.skeleton.4",MO.FE3dGeneralColorSkeletonEffect);
b.register("general.color.fur.skeleton",MO.FE3dGeneralColorSkeletonEffect);b.register("general.color.fur.skeleton.4",MO.FE3dGeneralColorSkeletonEffect);b.register("shadow.depth.automatic",MO.FE3dShadowDepthAutomaticEffect);b.register("shadow.depth.skeleton",MO.FE3dShadowDepthSkeletonEffect);b.register("shadow.color.automatic",MO.FE3dShadowColorAutomaticEffect);b.register("shadow.color.skeleton",MO.FE3dShadowColorSkeletonEffect)};
MO.RE3dEngine.prototype.setup=function(){this._setuped||(this.onSetup(),this._setuped=!0)};MO.RE3dEngine=new MO.RE3dEngine;MO.EE3sResource=new function(){this.Unknown="Unknown";this.Bitmap="Bitmap";this.Material="Material";this.Mesh="Mesh";this.Model="Model";this.Template="Template";this.Scene="Scene";this.Project="Project";this.All="All";return this};
MO.ME3sGeometry=function(b){b=MO.Class.inherits(this,b);b._outline=MO.Class.register(b,new MO.AGetter("_outline"));b._streams=MO.Class.register(b,new MO.AGetter("_streams"));b.construct=MO.ME3sGeometry_construct;b.findStream=MO.ME3sGeometry_findStream;b.calculateOutline=MO.ME3sGeometry_calculateOutline;b.dispose=MO.ME3sGeometry_dispose;return b};MO.ME3sGeometry_construct=function(){this._outline=new MO.SOutline3d};
MO.ME3sGeometry_findStream=function(b){var d=this._streams,f=d.count();for(n=0;n<f;n++){var h=d.getAt(n);if(h.code()==b)return h}return null};MO.ME3sGeometry_calculateOutline=function(){var b=this._outline;if(b.isEmpty()){b.setMin();for(var d=this.findStream("position"),f=d.dataCount(),d=new Float32Array(d.data()),h=0,q=0;q<f;q++){var w=d[h++],z=d[h++],A=d[h++];b.mergePoint(w,z,A)}b.update()}return b};MO.ME3sGeometry_dispose=function(){this._outline=MO.Lang.Object.dispose(this._outline);this.__base.FE3sSpace.dispose.call(this)};
MO.SE3sCompressEvent=function(b,d,f){this.owner=b;this.process=d;this.data=f;return this};MO.SE3sMaterialInfo=function(){MO.SG3dMaterialInfo.call(this);this.unserialize=MO.SE3sMaterialInfo_unserialize;this.saveConfig=MO.SE3sMaterialInfo_saveConfig;return this};
MO.SE3sMaterialInfo_unserialize=function(b){this.effectCode=b.readString();this.optionDepth=b.readBoolean();this.optionDouble=b.readBoolean();this.optionNormalInvert=b.readBoolean();this.optionShadow=b.readBoolean();this.optionShadowSelf=b.readBoolean();this.optionAlpha=b.readBoolean();this.alphaBase=b.readFloat();this.alphaRate=b.readFloat();this.optionColor=b.readBoolean();this.colorMin=b.readFloat();this.colorMax=b.readFloat();this.colorBalance=b.readFloat();this.colorRate=b.readFloat();this.optionVertex=
b.readBoolean();this.vertexColor.unserialize(b);this.optionAmbient=b.readBoolean();this.ambientColor.unserialize(b);this.optionDiffuse=b.readBoolean();this.diffuseColor.unserialize(b);this.optionDiffuseView=b.readBoolean();this.diffuseViewColor.unserialize(b);this.optionSpecular=b.readBoolean();this.specularColor.unserialize(b);this.specularBase=b.readFloat();this.specularLevel=b.readFloat();this.optionSpecularView=b.readBoolean();this.specularViewColor.unserialize(b);this.specularViewBase=b.readFloat();
this.specularViewLevel=b.readFloat();this.optionReflect=b.readBoolean();this.reflectColor.unserialize(b);this.reflectMerge=b.readFloat();this.optionRefract=b.readBoolean();this.refractFrontColor.unserialize(b);this.refractBackColor.unserialize(b);this.optionOpacity=b.readBoolean();this.opacityColor.unserialize(b);this.opacityRate=b.readFloat();this.opacityAlpha=b.readFloat();this.opacityDepth=b.readFloat();this.opacityTransmittance=b.readFloat();this.optionEmissive=b.readBoolean();this.emissiveColor.unserialize(b)};
MO.SE3sMaterialInfo_saveConfig=function(b){b.set("effect_code",this.effectCode);b.setBoolean("option_double",this.optionDouble);b.setBoolean("option_alpha",this.optionAlpha);b.setBoolean("option_normal_invert",this.optionNormalInvert);b.setBoolean("option_shadow",this.optionShadow);b.setBoolean("option_shadow_self",this.optionShadowSelf);var d=b.create("Alpha");d.setBoolean("valid",this.optionAlpha);d.setFloat("base",this.alphaBase);d.setFloat("rate",this.alphaRate);d=b.create("Color");d.setBoolean("valid",
this.optionColor);d.setFloat("min",this.colorMin);d.setFloat("max",this.colorMax);d.setFloat("balance",this.colorBalance);d.setFloat("rate",this.colorRate);d=b.create("Vertex");d.setBoolean("valid",this.optionVertex);this.vertexColor.savePower(d);d=b.create("Ambient");d.setBoolean("valid",this.optionAmbient);this.ambientColor.savePower(d);d=b.create("Diffuse");d.setBoolean("valid",this.optionDiffuse);this.diffuseColor.savePower(d);d=b.create("DiffuseView");d.setBoolean("valid",this.optionDiffuseView);
this.diffuseViewColor.savePower(d);d=b.create("Specular");d.setBoolean("valid",this.optionSpecular);this.specularColor.savePower(d);d.setFloat("base",this.specularBase);d.setFloat("level",this.specularLevel);d=b.create("SpecularView");d.setBoolean("valid",this.optionSpecularView);this.specularViewColor.savePower(d);d.setFloat("base",this.specularViewBase);d.setFloat("level",this.specularViewLevel);d=b.create("Reflect");d.setBoolean("valid",this.optionReflect);this.reflectColor.savePower(d);d.setFloat("merge",
this.reflectMerge);d=b.create("Refract");d.setBoolean("valid",this.optionRefract);this.refractFrontColor.savePower(d.create("Front"));this.refractBackColor.savePower(d.create("Back"));d=b.create("Opacity");d.setBoolean("valid",this.optionOpacity);this.opacityColor.savePower(d);d.setFloat("rate",this.opacityRate);d.setFloat("alpha",this.opacityAlpha);d.setFloat("depth",this.opacityDepth);d.setFloat("transmittance",this.opacityTransmittance);d=b.create("Emissive");d.setBoolean("valid",this.optionEmissive);
this.emissiveColor.savePower(d)};MO.SE3sSceneShadow=function(){this.range=this.level=this.rate=this.base=null;this.unserialize=MO.SE3sSceneShadow_unserialize;return this};MO.SE3sSceneShadow_unserialize=function(b){this.base=b.readFloat();this.rate=b.readFloat();this.level=b.readFloat();this.range=b.readFloat()};
MO.FE3sAnimation=function(b){b=MO.Class.inherits(this,b,MO.FE3sObject);b._model=null;b._skeletonGuid=MO.Class.register(b,new MO.AGetter("_skeletonGuid"));b._skeleton=null;b._frameCount=MO.Class.register(b,new MO.AGetter("_frameCount"),0);b._frameTick=MO.Class.register(b,new MO.AGetter("_frameTick"),0);b._frameSpan=MO.Class.register(b,new MO.AGetter("_frameSpan"),0);b._frameTranslates=null;b._frameRotations=null;b._frameScales=null;b._tracks=MO.Class.register(b,new MO.AGetter("_tracks"));b.skeleton=
MO.FE3sAnimation_skeleton;b.tracks=MO.FE3sAnimation_tracks;b.unserialize=MO.FE3sAnimation_unserialize;return b};MO.FE3sAnimation_skeleton=function(){var b=this._skeleton;if(!b){var d=this._skeletonGuid;d&&(b=this._skeleton=MO.Console.find(MO.FE3sModelConsole).findSkeleton(d))}return b};
MO.FE3sAnimation_unserialize=function(b){this.__base.FE3sObject.unserialize.call(this,b);this._skeletonGuid=b.readString();this._frameCount=b.readUint16();this._frameTick=b.readUint16();this._frameSpan=b.readUint32();var d=b.readUint32(),f=MO.Lang.Integer.strideByte(d);if(0<d)for(var h=this._frameTranslates=new MO.TObjects,q=0;q<d;q++){var w=new MO.SPoint3;w.unserialize(b);h.push(w)}w=b.readUint32();d=MO.Lang.Integer.strideByte(w);if(0<w)for(var z=this._frameRotations=new MO.TObjects,q=0;q<w;q++){var A=
new MO.SQuaternion;A.unserialize(b);z.push(A)}A=b.readUint32();w=MO.Lang.Integer.strideByte(A);if(0<A)for(var B=this._frameScales=new MO.TObjects,q=0;q<A;q++){var C=new MO.SVector3;C.unserialize(b);B.push(C)}A=null;C=b.readUint16();if(0<C)for(var A=this._tracks=new MO.TObjects,D=0;D<C;D++){var E=MO.Class.create(MO.FE3sTrack);E.unserialize(b);A.push(E);for(var F=E._frameCount,E=E._frames,q=0;q<F;q++){var H=MO.Class.create(MO.FE3sFrame),I=0,I=4==f?b.readUint32():2==f?b.readUint16():b.readUint8();H._translation=
h.at(I);I=0;I=4==d?b.readUint32():2==d?b.readUint16():b.readUint8();H._quaternion=z.at(I);I=0;I=4==w?b.readUint32():2==w?b.readUint16():b.readUint8();H._scale=B.at(I);E.push(H)}}if(A&&this._skeletonGuid){b=this.skeleton();for(q=0;q<C;q++)E=A.at(q),f=E.boneIndex(),b.findBone(f).setTrack(E);b.pushAnimation(this)}};
MO.FE3sBone=function(b){b=MO.Class.inherits(this,b,MO.FObject);b._index=MO.Class.register(b,new MO.AGetter("_index"));b._track=MO.Class.register(b,new MO.AGetSet("_track"));b._bones=MO.Class.register(b,new MO.AGetter("_bones"));b.unserialize=MO.FE3sBone_unserialize;return b};MO.FE3sBone_unserialize=function(b){this._index=b.readUint8();var d=b.readUint8();if(0<d)for(var f=this._bones=new MO.TObjects,h=0;h<d;h++){var q=MO.Class.create(MO.FE3sBone);q.unserialize(b);f.push(q)}};
MO.FE3sBoneRefer=function(b){b=MO.Class.inherits(this,b,MO.FObject);b._index=MO.Class.register(b,new MO.AGetter("_index"));b._bone=MO.Class.register(b,new MO.AGetSet("_bone"));b._track=MO.Class.register(b,new MO.AGetSet("_track"));b.unserialize=MO.FE3sBoneRefer_unserialize;return b};MO.FE3sBoneRefer_unserialize=function(b){this._index=b.readUint8()};
MO.FE3sCamera=function(b){b=MO.Class.inherits(this,b,MO.FE3sObject);b._typeCd=MO.Class.register(b,new MO.AGetter("_typeCd"));b._position=MO.Class.register(b,new MO.AGetter("_position"));b._direction=MO.Class.register(b,new MO.AGetter("_direction"));b._projection=MO.Class.register(b,new MO.AGetter("_projection"));b.construct=MO.FE3sCamera_construct;b.unserialize=MO.FE3sCamera_unserialize;b.saveConfig=MO.FE3sCamera_saveConfig;return b};
MO.FE3sCamera_construct=function(){this.__base.FE3sObject.construct.call(this);this._position=new MO.SPoint3;this._direction=new MO.SVector3;this._projection=MO.Class.create(MO.FE3sProjection)};MO.FE3sCamera_unserialize=function(b){this.__base.FE3sObject.unserialize.call(this,b);this._typeCd=b.readString();this._position.unserialize(b);this._direction.unserialize(b);this._projection.unserialize(b)};
MO.FE3sCamera_saveConfig=function(b){this.__base.FE3sObject.saveConfig.call(this,b);b.set("position",this._position.toString());b.set("direction",this._direction.toString());this._projection.saveConfig(b.create("Projection"))};MO.FE3sComponent=function(b){return b=MO.Class.inherits(this,b,MO.FE3sObject)};
MO.FE3sDisplay=function(b){b=MO.Class.inherits(this,b,MO.FE3sDrawable);b._outline=null;b._renderables=MO.Class.register(b,new MO.AGetter("_renderables"));b.construct=MO.FE3sDisplay_construct;b.calculateOutline=MO.FE3sDisplay_calculateOutline;b.unserialize=MO.FE3sDisplay_unserialize;b.saveConfig=MO.FE3sDisplay_saveConfig;b.clone=MO.FE3sDisplay_clone;return b};MO.FE3sDisplay_construct=function(){this.__base.FE3sDrawable.construct.call(this);this._outline=new MO.SOutline3d};
MO.FE3sDisplay_calculateOutline=function(){var b=this._outline;if(b.isEmpty()){var d=this._renderables;if(d){b.setMin();for(var f=d.count(),h=0;h<f;h++){var q=d.at(h).calculateOutline();b.mergeMax(q)}b.update()}}return b};MO.FE3sDisplay_unserialize=function(b){this.__base.FE3sDrawable.unserialize.call(this,b);var d=MO.Console.find(MO.FE3sResourceConsole),f=b.readUint16();if(0<f)for(var h=this._renderables=new MO.TObjects,q=0;q<f;q++){var w=d.unserialize(b);h.push(w)}};
MO.FE3sDisplay_saveConfig=function(b){this.__base.FE3sDrawable.saveConfig.call(this,b);var d=this._renderables;if(d){b=b.create("RenderableCollection");for(var f=d.count(),h=0;h<f;h++)d.at(h).saveConfig(b.create("Renderable"))}};MO.FE3sDisplay_clone=function(b){b=this.__base.FE3sDrawable.clone.call(this,b);b._outline.assign(this._outline);return b};
MO.FE3sDisplayContainer=function(b){b=MO.Class.inherits(this,b,MO.FE3sDisplay);b._displays=MO.Class.register(b,new MO.AGetter("_displays"));b.construct=MO.FE3sDisplayContainer_construct;b.pushDisplay=MO.FE3sDisplayContainer_pushDisplay;b.calculateOutline=MO.FE3sDisplayContainer_calculateOutline;b.unserialize=MO.FE3sDisplayContainer_unserialize;b.saveConfig=MO.FE3sDisplayContainer_saveConfig;b.clone=MO.FE3sDisplayContainer_clone;return b};MO.FE3sDisplayContainer_construct=function(){this.__base.FE3sDisplay.construct.call(this)};
MO.FE3sDisplayContainer_pushDisplay=function(b){var d=this._displays;d||(d=this._displays=new MO.TObjects);b.setParent(this);d.push(b)};MO.FE3sDisplayContainer_calculateOutline=function(){var b=this._outline;if(b.isEmpty()){var d=this._renderables;if(d){b.setMin();for(var f=d.count(),h=0;h<f;h++){var q=d.getAt(h).calculateOutline();b.mergeMax(q)}b.update()}}return b};
MO.FE3sDisplayContainer_unserialize=function(b){this.__base.FE3sDisplay.unserialize.call(this,b);var d=b.readUint16();if(0<d){this._displays=new MO.TObjects;for(var f=0;f<d;f++){var h=MO.Class.create(MO.FE3sSceneDisplay);h.unserialize(b);this.pushDisplay(h)}}};MO.FE3sDisplayContainer_saveConfig=function(b){this.__base.FE3sDisplay.saveConfig.call(this,b);var d=this._displays;if(d){b=b.create("DisplayCollection");for(var f=d.count(),h=0;h<f;h++)d.at(h).saveConfig(b.create("Display"))}};
MO.FE3sDisplayContainer_clone=function(b){return this.__base.FE3sDisplay.clone.call(this,b)};MO.FE3sDisplayLayer=function(b){b=MO.Class.inherits(this,b,MO.FE3sDisplayContainer);b._typeCd=MO.Class.register(b,new MO.AGetSet("_typeCd"));b._transformCd=MO.Class.register(b,new MO.AGetSet("_transformCd"));b.unserialize=MO.FE3sDisplayLayer_unserialize;b.saveConfig=MO.FE3sDisplayLayer_saveConfig;return b};
MO.FE3sDisplayLayer_unserialize=function(b){this.__base.FE3sDisplayContainer.unserialize.call(this,b);this._typeCd=b.readString();this._transformCd=b.readString()};MO.FE3sDisplayLayer_saveConfig=function(b){this.__base.FE3sDisplayContainer.saveConfig.call(this,b);b.set("type_cd",this._typeCd);b.set("transform_cd",this._transformCd)};
MO.FE3sDisplayMaterial=function(b){b=MO.Class.inherits(this,b,MO.FObject);b._groupGuid=MO.Class.register(b,new MO.AGetter("_groupGuid"));b._material=MO.Class.register(b,new MO.AGetter("_material"));b.unserialize=MO.FE3sDisplayMaterial_unserialize;return b};MO.FE3sDisplayMaterial_unserialize=function(b){this._groupGuid=b.readString();this._material=this._template._activeTheme.findMaterial(this._groupGuid)};
MO.FE3sDrawable=function(b){b=MO.Class.inherits(this,b,MO.FE3sComponent);b._matrix=MO.Class.register(b,new MO.AGetter("_matrix"));b.construct=MO.FE3sDrawable_construct;b.matrix=MO.FE3sDrawable_matrix;b.unserialize=MO.FE3sDrawable_unserialize;b.saveConfig=MO.FE3sDrawable_saveConfig;b.clone=MO.FE3sDrawable_clone;return b};MO.FE3sDrawable_construct=function(){this.__base.FE3sComponent.construct.call(this);this._matrix=new MO.SMatrix3d};
MO.FE3sDrawable_unserialize=function(b){this.__base.FE3sComponent.unserialize.call(this,b);this._matrix.unserialize(b)};MO.FE3sDrawable_saveConfig=function(b){this.__base.FE3sComponent.saveConfig.call(this,b);this._matrix.saveConfig(b.create("Matrix"))};MO.FE3sDrawable_clone=function(b){b=this.__base.FE3sComponent.clone.call(this,b);b._matrix.assign(this._matrix);return b};
MO.FE3sFrame=function(b){b=MO.Class.inherits(this,b,MO.FObject);b._tick=MO.Class.register(b,new MO.AGetter("_tick"));b._translation=MO.Class.register(b,new MO.AGetter("_translation"));b._quaternion=MO.Class.register(b,new MO.AGetter("_quaternion"));b._scale=MO.Class.register(b,new MO.AGetter("_scale"));return b};
MO.FE3sGeometry=function(b){b=MO.Class.inherits(this,b,MO.FE3sRenderable,MO.ME3sGeometry);b.construct=MO.FE3sGeometry_construct;b.unserialize=MO.FE3sGeometry_unserialize;b.dispose=MO.FE3sGeometry_dispose;return b};MO.FE3sGeometry_construct=function(){this.__base.FE3sRenderable.construct.call(this);this.__base.ME3sGeometry.construct.call(this)};
MO.FE3sGeometry_unserialize=function(b){this.__base.FE3sRenderable.unserialize.call(this,b);var d=this._outline;d.unserialize(b);var f=b.readInt8();if(0<f)for(var h=this._streams=new MO.TObjects,q=0;q<f;q++){var w=MO.Class.create(MO.FE3sStream);w.unserialize(b);h.push(w)}d.isEmpty()&&this.calculateOutline();d.update()};MO.FE3sGeometry_dispose=function(){this.__base.ME3sGeometry.dispose.call(this);this.__base.FE3sRenderable.dispose.call(this)};
MO.FE3sLight=function(b){b=MO.Class.inherits(this,b,MO.FE3sObject);b._typeName=MO.Class.register(b,new MO.AGetter("_typeName"));b._material=MO.Class.register(b,new MO.AGetter("_material"));b._camera=MO.Class.register(b,new MO.AGetter("_camera"));b.construct=MO.FE3sLight_construct;b.unserialize=MO.FE3sLight_unserialize;return b};MO.FE3sLight_construct=function(){this.__base.FE3sObject.construct.call(this);this._material=MO.Class.create(MO.FE3sMaterial);this._camera=MO.Class.create(MO.FE3sCamera)};
MO.FE3sLight_unserialize=function(b){this.__base.FE3sObject.unserialize.call(this,b);this._typeName=b.readString();this._material.unserialize(b);this._camera.unserialize(b)};
MO.FE3sMaterial=function(b){b=MO.Class.inherits(this,b,MO.FE3sObject);b._parentGuid=MO.Class.register(b,new MO.AGetter("_parentGuid"));b._info=MO.Class.register(b,new MO.AGetter("_info"));b._bitmaps=MO.Class.register(b,new MO.AGetter("_bitmaps"));b._bitmapPacks=MO.Class.register(b,new MO.AGetter("_bitmapPacks"));b.construct=MO.FE3sMaterial_construct;b.effectCode=MO.FE3sMaterial_effectCode;b.unserialize=MO.FE3sMaterial_unserialize;b.saveConfig=MO.FE3sMaterial_saveConfig;b.clone=MO.FE3sMaterial_clone;
return b};MO.FE3sMaterial_construct=function(){this.__base.FE3sObject.construct.call(this);this._info=new MO.SE3sMaterialInfo};MO.FE3sMaterial_effectCode=function(){return this._info.effectCode};
MO.FE3sMaterial_unserialize=function(b){this.__base.FE3sObject.unserialize.call(this,b);this._parentGuid=b.readString();this._info.unserialize(b);var d=b.readInt16();if(0<d)for(var f=this._bitmapPacks=new MO.TDictionary,h=0;h<d;h++){var q=MO.Class.create(MO.FE3sMaterialBitmapPack);q.unserialize(b);f.set(q.guid(),q)}d=b.readInt16();if(0<d)for(q=this._bitmaps=new MO.TObjects,h=0;h<d;h++){var w=MO.Class.create(MO.FE3sMaterialBitmap);w.unserialize(b);q.push(w);var z=f.get(w.bitmapPackGuid());w.setBitmapPack(z)}};
MO.FE3sMaterial_saveConfig=function(b){this.__base.FE3sObject.saveConfig.call(this,b);b.set("parent_guid",this._parentGuid);this._info.saveConfig(b)};MO.FE3sMaterial_clone=function(b){b=this.__base.FE3sObject.clone.call(this,b);b._parentGuid=this._parentGuid;b._info.assign(this._info);return b};
MO.FE3sMaterialBitmap=function(b){b=MO.Class.inherits(this,b,MO.FE3sObject);b._bitmapPackGuid=MO.Class.register(b,new MO.AGetter("_bitmapPackGuid"));b._bitmapPack=MO.Class.register(b,new MO.AGetSet("_bitmapPack"));b._bitmapGuid=MO.Class.register(b,new MO.AGetter("_bitmapGuid"));b._index=0;b.unserialize=MO.FE3sMaterialBitmap_unserialize;return b};
MO.FE3sMaterialBitmap_unserialize=function(b){this.__base.FE3sObject.unserialize.call(this,b);this._bitmapPackGuid=b.readString();this._bitmapGuid=b.readString();this._index=b.readUint16()};
MO.FE3sMaterialBitmapPack=function(b){b=MO.Class.inherits(this,b,MO.FE3sObject);b._typeName=MO.Class.register(b,new MO.AGetter("_typeName"));b._formatName=MO.Class.register(b,new MO.AGetter("_formatName"));b._size=MO.Class.register(b,new MO.AGetter("_size"));b.construct=MO.FE3sMaterialBitmapPack_construct;b.unserialize=MO.FE3sMaterialBitmapPack_unserialize;b.dispose=MO.FE3sMaterialBitmapPack_dispose;return b};
MO.FE3sMaterialBitmapPack_construct=function(){this.__base.FE3sObject.construct.call(this);this._size=new MO.SSize2};MO.FE3sMaterialBitmapPack_unserialize=function(b){this.__base.FE3sObject.unserialize.call(this,b);this._typeName=b.readString();this._formatName=b.readString();this._size.unserialize(b,MO.EDataType.Uint16)};MO.FE3sMaterialBitmapPack_dispose=function(){this._size=MO.Lang.Object.dispose(this._size);this.__base.FE3sObject.dispose.call(this)};
MO.FE3sMaterialConsole=function(b){b=MO.Class.inherits(this,b,MO.FConsole);b._resources=null;b._materials=null;b.construct=MO.FE3sMaterialConsole_construct;b.find=MO.FE3sMaterialConsole_find;b.unserialize=MO.FE3sMaterialConsole_unserialize;b.loadByGuid=MO.FE3sMaterialConsole_loadByGuid;b.dispose=MO.FE3sMaterialConsole_dispose;return b};MO.FE3sMaterialConsole_construct=function(){this.__base.FConsole.construct.call(this);this._resources=new MO.TDictionary;this._materials=new MO.TDictionary};
MO.FE3sMaterialConsole_find=function(b){return this._materials.get(b)};MO.FE3sMaterialConsole_unserialize=function(b){var d=MO.Class.create(MO.FE3sMaterial);d.unserialize(b);b=d.guid();if(this._materials.contains(b))throw new MO.TError(this,"Material is already exists.");this._materials.set(b,d);return d};
MO.FE3sMaterialConsole_loadByGuid=function(b){var d=this._resources,f=d.get(b);if(f)return f;var h=MO.Console.find(MO.FE3sVendorConsole).find("material");h.set("guid",b);var q=h.makeUrl(),f=MO.Class.create(MO.FE3sMaterialResource);f.setGuid(b);f.setVendor(h);f.setSourceUrl(q);MO.Console.find(MO.FResourceConsole).load(f);d.set(b,f);return f};MO.FE3sMaterialConsole_dispose=function(){this._resources=MO.Lang.Object.free(this._resources);this._materials=MO.Lang.Object.free(this._materials);this.__base.FConsole.dispose.call(this)};
MO.FE3sMaterialRefer=function(b){return b=MO.Class.inherits(this,b,MO.FE3sObject)};MO.FE3sMaterialResource=function(b){b=MO.Class.inherits(this,b,MO.FE3sResource);b._typeName="Material";b._dataCompress=!0;b._material=MO.Class.register(b,new MO.AGetter("_material"));b.unserialize=MO.FE3sMaterialResource_unserialize;return b};
MO.FE3sMaterialResource_unserialize=function(b){this.__base.FE3sResource.unserialize.call(this,b);this._material=MO.Console.find(MO.FE3sMaterialConsole).unserialize(b);MO.Logger.info(this,"Unserialize material success. (guid={1}, code={2})",this._guid,this._code)};
MO.FE3sMesh=function(b){b=MO.Class.inherits(this,b,MO.FE3sSpace,MO.ME3sGeometry);b._dataCompress=!0;b._typeName="Mesh";b._display=null;b._renderable=null;b.construct=MO.FE3sMesh_construct;b.unserialize=MO.FE3sMesh_unserialize;b.saveConfig=MO.FE3sMesh_saveConfig;b.dispose=MO.FE3sMesh_dispose;return b};MO.FE3sMesh_construct=function(){this.__base.FE3sSpace.construct.call(this);this.__base.ME3sGeometry.construct.call(this);this._display=MO.Class.create(MO.FE3sMeshDisplay)};
MO.FE3sMesh_unserialize=function(b){this.__base.FE3sSpace.unserialize.call(this,b);this._outline.unserialize(b);this._outline.update();var d=b.readInt8();if(0<d)for(var f=this._streams=new MO.TObjects,h=0;h<d;h++){var q=MO.Class.create(MO.FE3sStream);q.unserialize(b);f.push(q)}this._display.unserialize(b);this._renderable=this._display._renderable};MO.FE3sMesh_saveConfig=function(b){this.__base.FE3sSpace.saveConfig.call(this,b);this._display.saveConfig(b.create("Display"))};
MO.FE3sMesh_dispose=function(){this._outline=MO.Lang.Object.dispose(this._outline);this._display=MO.Lang.Object.dispose(this._display);this.__base.ME3sGeometry.dispose.call(this);this.__base.FE3sSpace.dispose.call(this)};
MO.FE3sMeshConsole=function(b){b=MO.Class.inherits(this,b,MO.FConsole);b._venderCode="mesh";b._serviceUrl="/cloud.content.mesh.ws";b._dataUrl="/cloud.content.mesh.wv";b._meshs=MO.Class.register(b,new MO.AGetter("_meshs"));b.construct=MO.FE3sMeshConsole_construct;b.find=MO.FE3sMeshConsole_find;b.loadByGuid=MO.FE3sMeshConsole_loadByGuid;b.loadByCode=MO.FE3sMeshConsole_loadByCode;b.dispose=MO.FE3sMeshConsole_dispose;return b};
MO.FE3sMeshConsole_construct=function(){this.__base.FConsole.construct.call(this);this._meshs=new MO.TDictionary};MO.FE3sMeshConsole_find=function(b){return this._meshs.get(b)};MO.FE3sMeshConsole_loadByGuid=function(b){var d=this._meshs,f=d.get(b);if(f)return f;var h=MO.Console.find(MO.FE3sVendorConsole).find(this._venderCode);h.set("guid",b);var q=h.makeUrl(),f=MO.Class.create(MO.FE3sMesh);f.setGuid(b);f.setVendor(h);f.setSourceUrl(q);MO.Console.find(MO.FResourceConsole).load(f);d.set(b,f);return f};
MO.FE3sMeshConsole_loadByCode=function(b){var d=this._meshs,f=d.get(b);if(f)return f;var h=MO.Console.find(MO.FE3sVendorConsole).find(this._venderCode);h.set("code",b);var q=h.makeUrl(),f=MO.Class.create(MO.FE3sMesh);f.setGuid(b);f.setVendor(h);f.setSourceUrl(q);MO.Console.find(MO.FResourceConsole).load(f);d.set(b,f);return f};MO.FE3sMeshConsole_dispose=function(){this._meshs=MO.Lang.Object.free(this._meshs);this.__base.FConsole.dispose.call(this)};
MO.FE3sMeshDisplay=function(b){b=MO.Class.inherits(this,b,MO.FE3sObject);b._matrix=MO.Class.register(b,new MO.AGetter("_matrix"));b._material=MO.Class.register(b,new MO.AGetter("_material"));b._renderable=MO.Class.register(b,new MO.AGetter("_renderable"));b.construct=MO.FE3sMeshDisplay_construct;b.unserialize=MO.FE3sMeshDisplay_unserialize;b.saveConfig=MO.FE3sMeshDisplay_saveConfig;return b};
MO.FE3sMeshDisplay_construct=function(){this.__base.FE3sObject.construct.call(this);this._matrix=new MO.SMatrix3d;this._material=MO.Class.create(MO.FE3sMaterial);this._renderable=MO.Class.create(MO.FE3sRenderable)};MO.FE3sMeshDisplay_unserialize=function(b){this.__base.FE3sObject.unserialize.call(this,b);this._matrix.unserialize(b);this._material.unserialize(b);this._renderable.unserialize(b)};
MO.FE3sMeshDisplay_saveConfig=function(b){this.__base.FE3sObject.saveConfig.call(this,b);this._matrix.saveConfig(b.create("Matrix"));this._material.saveConfig(b.create("Material"));this._renderable.saveConfig(b.create("Renderable"))};
MO.FE3sModel=function(b){b=MO.Class.inherits(this,b,MO.FE3sSpace);b._typeName="Model";b._dataCompress=!0;b._dataBlock=!0;b._meshes=MO.Class.register(b,new MO.AGetter("_meshes"));b._skeletons=MO.Class.register(b,new MO.AGetter("_skeletons"));b._animations=MO.Class.register(b,new MO.AGetter("_animations"));b._display=MO.Class.register(b,new MO.AGetter("_display"));b.construct=MO.FE3sModel_construct;b.findMeshByCode=MO.FE3sModel_findMeshByCode;b.unserialize=MO.FE3sModel_unserialize;b.saveConfig=MO.FE3sModel_saveConfig;
return b};MO.FE3sModel_construct=function(){this.__base.FE3sSpace.construct.call(this);(this._display=MO.Class.create(MO.FE3sModelDisplay))._model=this};MO.FE3sModel_findMeshByCode=function(b){for(var d=this._meshes,f=d.count()-1;0<=f;f--){var h=d.at(f);if(h._code==b)return h}return null};
MO.FE3sModel_unserialize=function(b){this.__base.FE3sSpace.unserialize.call(this,b);var d=MO.Console.find(MO.FE3sModelConsole);d.models().set(this.guid(),this);var f=b.readInt16();if(0<f)for(var h=this._meshes=new MO.TDictionary,q=0;q<f;q++){var w=d.unserialMesh(b),z=w.guid();h.set(z,w)}w=b.readInt16();if(0<w)for(z=this._skeletons=new MO.TObjects,q=0;q<w;q++)f=d.unserialSkeleton(b),z.push(f);w=b.readInt16();if(0<w)for(z=this._animations=new MO.TObjects,q=0;q<w;q++)f=d.unserialAnimation(this,b),z.push(f);
q=this._display;q.unserialize(b);if(b=q.renderables())for(d=b.count(),q=0;q<d;q++)f=b.get(q),z=f.meshGuid(),w=h.get(z),f.setMesh(w);MO.Logger.info(this,"Unserialize model success. (guid={1}, code={2})",this._guid,this._code)};MO.FE3sModel_saveConfig=function(b){this.__base.FE3sSpace.saveConfig.call(this,b);this._display.saveConfig(b.create("Display"))};
MO.FE3sModelConsole=function(b){b=MO.Class.inherits(this,b,MO.FConsole);b._models=MO.Class.register(b,new MO.AGetter("_models"));b._meshs=MO.Class.register(b,new MO.AGetter("_meshs"));b._skeletons=MO.Class.register(b,new MO.AGetter("_skeletons"));b._animations=MO.Class.register(b,new MO.AGetter("_animations"));b.construct=MO.FE3sModelConsole_construct;b.findModel=MO.FE3sModelConsole_findModel;b.findMesh=MO.FE3sModelConsole_findMesh;b.findSkeleton=MO.FE3sModelConsole_findSkeleton;b.findAnimation=MO.FE3sModelConsole_findAnimation;
b.unserialMesh=MO.FE3sModelConsole_unserialMesh;b.unserialSkeleton=MO.FE3sModelConsole_unserialSkeleton;b.unserialAnimation=MO.FE3sModelConsole_unserialAnimation;b.load=MO.FE3sModelConsole_load;b.dispose=MO.FE3sModelConsole_dispose;return b};
MO.FE3sModelConsole_construct=function(){this.__base.FConsole.construct.call(this);this._models=new MO.TDictionary;this._meshs=new MO.TDictionary;this._skeletons=new MO.TDictionary;this._animations=new MO.TDictionary;var b=MO.Console.find(MO.FResourceConsole),d=MO.Class.create(MO.FResourcePipeline),f=MO.Class.create(MO.FResourceType);f.setCode("resource3d.model");f._pipeline=d;b.registerType(f)};MO.FE3sModelConsole_findModel=function(b){return this._models.get(b)};MO.FE3sModelConsole_findMesh=function(b){return this._meshs.get(b)};
MO.FE3sModelConsole_findSkeleton=function(b){return this._skeletons.get(b)};MO.FE3sModelConsole_findAnimation=function(b){return this._animations.get(b)};MO.FE3sModelConsole_unserialMesh=function(b){var d=MO.Class.create(MO.FE3sModelMesh);d.unserialize(b);this._meshs.set(d.guid(),d);return d};MO.FE3sModelConsole_unserialSkeleton=function(b){var d=MO.Class.create(MO.FE3sSkeleton);d.unserialize(b);this._skeletons.set(d.guid(),d);return d};
MO.FE3sModelConsole_unserialAnimation=function(b,d){var f=MO.Class.create(MO.FE3sAnimation);f._model=b;f.unserialize(d);this._animations.set(f.guid(),f);return f};MO.FE3sModelConsole_load=function(b){var d=this._models,f=d.get(b);if(f)return f;var h=MO.Console.find(MO.FE3sVendorConsole).find("model");h.set("guid",b);var q=h.makeUrl(),f=MO.Class.create(MO.FE3sModel);f.setGuid(b);f.setVendor(h);f.setSourceUrl(q);MO.Console.find(MO.FResourceConsole).load(f);d.set(b,f);return f};
MO.FE3sModelConsole_dispose=function(){this._materials=MO.Lang.Object.free(this._materials);this.__base.FConsole.dispose.call(this)};MO.FE3sModelDisplay=function(b){b=MO.Class.inherits(this,b,MO.FE3sDisplay);b._model=null;b._material=null;b.construct=MO.FE3sModelDisplay_construct;b.material=MO.FE3sModelDisplay_material;b.calculateOutline=MO.FE3sModelDisplay_calculateOutline;b.unserialize=MO.FE3sModelDisplay_unserialize;b.saveConfig=MO.FE3sModelDisplay_saveConfig;return b};
MO.FE3sModelDisplay_construct=function(){this.__base.FE3sDisplay.construct.call(this);this._material=MO.Class.create(MO.FE3sMaterial)};MO.FE3sModelDisplay_material=function(){return this._material};MO.FE3sModelDisplay_calculateOutline=function(){var b=this._outline;if(b.isEmpty()){var d=this._model.meshes();if(d){b.setMin();for(var f=d.count(),h=0;h<f;h++){var q=d.at(h).calculateOutline();b.mergeMax(q)}b.update()}}return b};
MO.FE3sModelDisplay_unserialize=function(b){this.__base.FE3sDisplay.unserialize.call(this,b);this._material.unserialize(b)};MO.FE3sModelDisplay_saveConfig=function(b){this.__base.FE3sDisplay.saveConfig.call(this,b);this._material.saveConfig(b.create("Material"))};MO.FE3sModelMesh=function(b){return b=MO.Class.inherits(this,b,MO.FE3sGeometry)};
MO.FE3sModelRenderable=function(b){b=MO.Class.inherits(this,b,MO.FE3sRenderable);b._meshGuid=MO.Class.register(b,new MO.AGetter("_meshGuid"));b._mesh=MO.Class.register(b,new MO.AGetSet("_mesh"));b.construct=MO.FE3sModelRenderable_construct;b.unserialize=MO.FE3sModelRenderable_unserialize;b.saveConfig=MO.FE3sModelRenderable_saveConfig;return b};MO.FE3sModelRenderable_construct=function(){this.__base.FE3sRenderable.construct.call(this)};
MO.FE3sModelRenderable_unserialize=function(b){this.__base.FE3sRenderable.unserialize.call(this,b);this._meshGuid=b.readString()};MO.FE3sModelRenderable_saveConfig=function(b){this.__base.FE3sRenderable.saveConfig.call(this,b);b.set("mesh_guid",this._meshGuid)};
MO.FE3sMovie=function(b){b=MO.Class.inherits(this,b,MO.FE3sObject);b._interval=MO.Class.register(b,new MO.AGetSet("_interval"));b._rotation=MO.Class.register(b,new MO.AGetter("_rotation"));b.construct=MO.FE3sMovie_construct;b.unserialize=MO.FE3sMovie_unserialize;b.saveConfig=MO.FE3sMovie_saveConfig;b.dispose=MO.FE3sMovie_dispose;return b};MO.FE3sMovie_construct=function(){this.__base.FE3sObject.construct.call(this);this._rotation=new MO.SVector3};
MO.FE3sMovie_unserialize=function(b){this.__base.FE3sObject.unserialize.call(this,b);this._interval=b.readInt32();this._rotation.unserialize(b)};MO.FE3sMovie_saveConfig=function(b){this.__base.FE3sObject.saveConfig.call(this,b);b.set("interval",this._interval);b.set("rotation",this._rotation)};MO.FE3sMovie_dispose=function(){this._rotation=MO.Lang.Object.dispose(this._rotation);this.__base.FE3sObject.disposet.call(this)};
MO.FE3sObject=function(b){b=MO.Class.inherits(this,b,MO.FObject,MO.MParent);b._typeName=null;b._guid=MO.Class.register(b,new MO.AGetSet("_guid"));b._code=MO.Class.register(b,new MO.AGetSet("_code"));b._label=MO.Class.register(b,new MO.AGetSet("_label"));b._isClone=!1;b.makeLabel=MO.FE3sObject_makeLabel;b.unserialize=MO.FE3sObject_unserialize;b.saveConfig=MO.FE3sObject_saveConfig;b.clone=MO.FE3sObject_clone;b.dispose=MO.FE3sObject_dispose;return b};
MO.FE3sObject_makeLabel=function(){var b="";MO.Lang.String.isEmpty(this._code)||(b+=this._code);MO.Lang.String.isEmpty(this._label)||(b+=" ["+this._label+"]");return b};MO.FE3sObject_unserialize=function(b){this._typeName=b.readString();this._guid=b.readString();this._code=b.readString();this._label=b.readString()};
MO.FE3sObject_saveConfig=function(b){MO.Lang.String.isEmpty(this._typeName)||b.setName(this._typeName);b.set("guid",this._guid);b.set("code",this._code);b.set("label",this._label);this._isClone&&b.set("is_clone","Y")};MO.FE3sObject_clone=function(b){var d=null,d=b?b:MO.Class.create(this.constructor);d._isClone=!0;d._typeName=this._typeName;d._guid=this._guid;d._code=this._code;d._label=this._label;return d};MO.FE3sObject_dispose=function(){this.__base.MAttributeParent.dispose.call(this);this.__base.FComponent.dispose.call(this)};
MO.FE3sProjection=function(b){b=MO.Class.inherits(this,b,MO.FE3sObject);b._angle=MO.Class.register(b,MO.AGetter("_angle"),90);b._znear=MO.Class.register(b,MO.AGetter("_znear"),1);b._zfar=MO.Class.register(b,MO.AGetter("_zfar"),200);b.unserialize=MO.FE3sProjection_unserialize;b.saveConfig=MO.FE3sProjection_saveConfig;return b};MO.FE3sProjection_unserialize=function(b){this.__base.FE3sObject.unserialize.call(this,b);this._angle=b.readFloat();this._znear=b.readFloat();this._zfar=b.readFloat()};
MO.FE3sProjection_saveConfig=function(b){this.__base.FE3sObject.saveConfig.call(this,b);b.setFloat("angle",this._angle);b.setFloat("znear",this._znear);b.setFloat("zfar",this._zfar)};
MO.FE3sRegion=function(b){b=MO.Class.inherits(this,b,MO.FE3sObject);b._optionBackground=MO.Class.register(b,new MO.AGetSet("_optionBackground"),!0);b._backgroundColor=MO.Class.register(b,new MO.AGetter("_backgroundColor"));b._moveSpeed=MO.Class.register(b,new MO.AGetSet("_moveSpeed"),.1);b._rotationKeySpeed=MO.Class.register(b,new MO.AGetSet("_rotationKeySpeed"),.005);b._rotationMouseSpeed=MO.Class.register(b,new MO.AGetSet("_rotationMouseSpeed"),.003);b._material=null;b._camera=MO.Class.register(b,
new MO.AGetter("_camera"));b._light=MO.Class.register(b,new MO.AGetter("_light"));b.construct=MO.FE3sRegion_construct;b.unserialize=MO.FE3sRegion_unserialize;b.saveConfig=MO.FE3sRegion_saveConfig;return b};MO.FE3sRegion_construct=function(){this.__base.FE3sObject.construct.call(this);this._backgroundColor=new MO.SColor4;this._material=MO.Class.create(MO.FE3sMaterial);this._camera=MO.Class.create(MO.FE3sCamera);this._light=MO.Class.create(MO.FE3sLight)};
MO.FE3sRegion_unserialize=function(b){this.__base.FE3sObject.unserialize.call(this,b);this._backgroundColor.unserialize(b);this._moveSpeed=b.readFloat();this._rotationKeySpeed=b.readFloat();this._rotationMouseSpeed=b.readFloat();this._material.unserialize(b);this._camera.unserialize(b);this._light.unserialize(b)};
MO.FE3sRegion_saveConfig=function(b){this.__base.FE3sObject.saveConfig.call(this,b);b.set("color",this._backgroundColor.toString());b.setFloat("move_speed",this._moveSpeed);b.setFloat("rotation_key_speed",this._rotationKeySpeed);b.setFloat("rotation_mouse_speed",this._rotationMouseSpeed);this._camera.saveConfig(b.create("Camera"))};
MO.FE3sRenderable=function(b){b=MO.Class.inherits(this,b,MO.FE3sDrawable);b._materialRefers=MO.Class.register(b,new MO.AGetter("_materialRefers"));b.construct=MO.FE3sRenderable_construct;b.syncMaterialRefer=MO.FE3sRenderable_syncMaterialRefer;b.pushMaterialRefer=MO.FE3sRenderable_pushMaterialRefer;b.unserialize=MO.FE3sRenderable_unserialize;b.saveConfig=MO.FE3sRenderable_saveConfig;b.clone=MO.FE3sRenderable_clone;return b};MO.FE3sRenderable_construct=function(){this.__base.FE3sDrawable.construct.call(this)};
MO.FE3sRenderable_syncMaterialRefer=function(b){var d=this._materialRefers;d||(d=this._materialRefers=new MO.TObjects);for(var f=d.count();f<=b;f++)d.push(MO.Class.create(MO.FE3sMaterialRefer));return d.at(b)};MO.FE3sRenderable_pushMaterialRefer=function(b){var d=this._materialRefers;d||(d=this._materialRefers=new MO.Objects);d.push(b)};
MO.FE3sRenderable_unserialize=function(b){this.__base.FE3sDrawable.unserialize.call(this,b);var d=b.readUint16();if(0<d)for(var f=0;f<d;f++){var h=MO.Class.create(MO.FE3sMaterialRefer);h.unserialize(b);this.pushMaterialRefer(h)}};MO.FE3sRenderable_saveConfig=function(b){this.__base.FE3sDrawable.saveConfig.call(this,b);var d=this._materialRefers;if(d){var f=d.count();b=b.create("MaterialReferCollection");for(var h=0;h<f;h++)d.at(h).saveConfig(b.create("MaterialRefer"))}};
MO.FE3sRenderable_clone=function(b){b=this.__base.FE3sDrawable.clone.call(this,b);var d=this._materialRefers;if(d)for(var f=d.count(),h=0;h<f;h++){var q=d.at(h);b.pushMaterialRefer(q.clone())}return b};
MO.FE3sResource=function(b){b=MO.Class.inherits(this,b,MO.FResource,MO.MListener);b._dataLoad=!1;b._dataReady=!1;b._dataSize=0;b._blockSize=0;b._blockCount=0;b._vendor=MO.Class.register(b,new MO.AGetSet("_vendor"));b._loadListeners=MO.Class.register(b,new MO.AListener("_loadListeners",MO.EEvent.Load));b.onComplete=MO.FE3sResource_onComplete;b.makeLabel=MO.FE3sResource_makeLabel;b.testReady=MO.FE3sResource_testReady;b.unserialize=MO.FE3sResource_unserialize;b.saveConfig=MO.FE3sResource_saveConfig;
b.dispose=MO.FE3sResource_dispose;return b};MO.FE3sResource_onComplete=function(b){if(MO.Class.isClass(b,MO.MDataStream))this.unserialize(b);else{var d=MO.Class.create(MO.FDataView);d.setEndianCd(!0);b.constructor==Array?(b=new Uint8Array(b),d.link(b.buffer)):b.constructor==Uint8Array?d.link(b.buffer):d.link(b.outputData());this.unserialize(d);d.dispose()}this._dataReady=!0;this.processLoadListener()};
MO.FE3sResource_makeLabel=function(){var b="";MO.Lang.String.isEmpty(this._code)||(b+=this._code);MO.Lang.String.isEmpty(this._label)||(b+=" ["+this._label+"]");return b};MO.FE3sResource_testReady=function(){return this._dataReady};MO.FE3sResource_unserialize=function(b){this._typeName=b.readString();this._guid=b.readString();this._code=b.readString();this._label=b.readString()};
MO.FE3sResource_saveConfig=function(b){MO.String.isEmpty(this._typeName)||b.setName(this._typeName);b.set("guid",this._guid);b.set("code",this._code);b.set("label",this._label)};MO.FE3sResource_dispose=function(){this._vendor=null;this.__base.MListener.dispose.call(this);this.__base.FConsole.dispose.call(this)};
MO.FE3sResourceConsole=function(b){b=MO.Class.inherits(this,b,MO.FConsole);b._factory=MO.Class.register(b,new MO.AGetter("_factory"));b.construct=MO.FE3sResourceConsole_construct;b.create=MO.FE3sResourceConsole_create;b.unserializeResource=MO.FE3sResourceConsole_unserializeResource;b.unserialize=MO.FE3sResourceConsole_unserialize;return b};
MO.FE3sResourceConsole_construct=function(){this.__base.FConsole.construct.call(this);var b=this._factory=MO.Class.create(MO.FClassFactory);b.register("Shape",MO.FE3sShape);b.register("Sprite",MO.FE3sSprite);b.register("ModelMesh",MO.FE3sModelMesh);b.register("ModelRenderable",MO.FE3sModelRenderable)};MO.FE3sResourceConsole_create=function(b){return this._factory.create(b)};MO.FE3sResourceConsole_unserializeResource=function(b,d){b.unserialize(d)};
MO.FE3sResourceConsole_unserialize=function(b){var d=b.testString(),d=this._factory.create(d);d.unserialize(b);return d};MO.FE3sScene=function(b){b=MO.Class.inherits(this,b,MO.FE3sSpace);b._typeName="Scene";b._dataCompress=!0;b._templates=null;b.construct=MO.FE3sScene_construct;b.unserialize=MO.FE3sScene_unserialize;b.saveConfig=MO.FE3sScene_saveConfig;return b};MO.FE3sScene_construct=function(){this.__base.FE3sSpace.construct.call(this)};
MO.FE3sScene_unserialize=function(b){this.__base.FE3sSpace.unserialize.call(this,b);b=b.readInt16();if(0<b)for(var d=MO.Console.find(MO.FE3sTemplateConsole),f=this._templates=new MO.TDictionary,h=0;h<b;h++){var q=d.unserialize(p);f.set(ttemplate.guid(),q)}};MO.FE3sScene_saveConfig=function(b){this.__base.FE3sSpace.saveConfig.call(this,b)};
MO.FE3sSceneAnimation=function(b){b=MO.Class.inherits(this,b,MO.FE3sObject);b._playRate=MO.Class.register(b,new MO.AGetSet("_playRate"),1);b.construct=MO.FE3sSceneAnimation_construct;b.unserialize=MO.FE3sSceneAnimation_unserialize;b.saveConfig=MO.FE3sSceneAnimation_saveConfig;return b};MO.FE3sSceneAnimation_construct=function(){this.__base.FE3sObject.construct.call(this)};MO.FE3sSceneAnimation_unserialize=function(b){this.__base.FE3sObject.unserialize.call(this,b);this._playRate=b.readFloat()};
MO.FE3sSceneAnimation_saveConfig=function(b){this.__base.FE3sObject.saveConfig.call(this,b);b.set("play_rate",this._playRate)};MO.FE3sSceneConsole=function(b){b=MO.Class.inherits(this,b,MO.FConsole);b._vendorCode="scene";b._dataUrl="/cloud.content.scene.wv";b._scenes=null;b.construct=MO.FE3sSceneConsole_construct;b.loadByGuid=MO.FE3sSceneConsole_loadByGuid;b.loadByCode=MO.FE3sSceneConsole_loadByCode;return b};
MO.FE3sSceneConsole_construct=function(){this.__base.FConsole.construct.call(this);this._scenes=new MO.TDictionary};MO.FE3sSceneConsole_loadByGuid=function(b){var d=this._scenes,f=d.get(b);if(f)return f;var h=MO.Console.find(MO.FE3sVendorConsole).find(this._vendorCode);h.set("guid",b);var q=h.makeUrl(),f=MO.Class.create(MO.FE3sScene);f.setGuid(b);f.setVendor(h);f.setSourceUrl(q);MO.Console.find(MO.FResourceConsole).load(f);d.set(b,f);return f};
MO.FE3sSceneConsole_loadByCode=function(b){var d=this._scenes,f=d.get(b);if(f)return f;var h=MO.Console.find(MO.FE3sVendorConsole).find(this._vendorCode);h.set("code",b);var q=h.makeUrl(),f=MO.Class.create(MO.FE3sScene);f.setCode(b);f.setVendor(h);f.setSourceUrl(q);MO.Console.find(MO.FResourceConsole).load(f);d.set(b,f);return f};
MO.FE3sSceneDisplay=function(b){b=MO.Class.inherits(this,b,MO.FE3sSprite);b._templateGuid=MO.Class.register(b,new MO.AGetter("_templateGuid"));b._animations=MO.Class.register(b,new MO.AGetter("_animations"));b._movies=MO.Class.register(b,new MO.AGetter("_movies"));b._renderables=MO.Class.register(b,new MO.AGetter("_renderables"));b.construct=MO.FE3sSceneDisplay_construct;b.findAnimation=MO.FE3sSceneDisplay_findAnimation;b.syncAnimation=MO.FE3sSceneDisplay_syncAnimation;b.unserialize=MO.FE3sSceneDisplay_unserialize;
b.saveConfig=MO.FE3sSceneDisplay_saveConfig;b.clone=MO.FE3sSceneDisplay_clone;return b};MO.FE3sSceneDisplay_construct=function(){this.__base.FE3sSprite.construct.call(this)};MO.FE3sSceneDisplay_findAnimation=function(b){var d=this._animations;return d?d.get(b):null};MO.FE3sSceneDisplay_syncAnimation=function(b){var d=this._animations;d||(d=this._animations=new MO.TDictionary);var f=d.get(b);f||(f=MO.Class.create(MO.FE3sSceneAnimation),f._guid=b,d.set(b,f));return f};
MO.FE3sSceneDisplay_unserialize=function(b){this.__base.FE3sSprite.unserialize.call(this,b);this._templateGuid=b.readString();var d=b.readUint16();if(0<d)for(var f=this._animations=new MO.TDictionary,h=0;h<d;h++){var q=MO.Class.create(MO.FE3sSceneAnimation);q.unserialize(b);f.set(q.guid(),q)}d=b.readUint16();if(0<d)for(f=this._movies=new MO.TObjects,h=0;h<d;h++)q=MO.Class.create(MO.FE3sMovie),q.unserialize(b),f.push(q)};
MO.FE3sSceneDisplay_saveConfig=function(b){this.__base.FE3sSprite.saveConfig.call(this,b);b.set("template_guid",this._templateGuid);var d=this._animations;if(d){var f=d.count();b=b.create("AnimationCollection");for(var h=0;h<f;h++)d.at(h).saveConfig(b.create("Animation"))}};MO.FE3sSceneDisplay_clone=function(b){b=this.__base.FE3sSprite.clone.call(this,b);b._templateGuid=this._templateGuid;return b};MO.FE3sSceneLayer=function(b){return b=MO.Class.inherits(this,b,MO.FE3sDisplayLayer)};
MO.FE3sSceneRenderable=function(b){b=MO.Class.inherits(this,b,MO.FE3sObject);b.unserialize=MO.FE3sSceneRenderable_unserialize;return b};MO.FE3sSceneRenderable_unserialize=function(b){this.__base.FE3sObject.unserialize.call(this,b)};
MO.FE3sShape=function(b){b=RClass.inherits(this,b,FE3sRenderable);b._modelGuid=MO.Class.register(b,new MO.AGetter("_modelGuid"));b._model=null;b._meshGuid=MO.Class.register(b,new MO.AGetter("_meshGuid"));b._mesh=null;b._materialGuid=MO.Class.register(b,new MO.AGetter("_materialGuid"));b._material=null;b.construct=FE3sShape_construct;b.model=FE3sShape_model;b.mesh=FE3sShape_mesh;b.material=FE3sShape_material;b.unserialize=FE3sShape_unserialize;return b};MO.FE3sShape_construct=function(){this.__base.FE3sRenderable.construct.call(this)};
MO.FE3sShape_model=function(){var b=this._model;b||(b=this._model=MO.Console.find(MO.FE3sModelConsole).findModel(this._modelGuid));return b};MO.FE3sShape_mesh=function(){var b=this._mesh;b||(b=this._mesh=MO.Console.find(MO.FE3sModelConsole).findMesh(this._meshGuid));return b};MO.FE3sShape_material=function(){var b=this._material;b||(b=this._material=MO.Console.find(MO.FE3sMaterialConsole).find(this._materialGuid));return b};
MO.FE3sShape_unserialize=function(b){this.__base.FE3sRenderable.unserialize.call(this,b);this._modelGuid=b.readString();this._meshGuid=b.readString();this._materialGuid=b.readString()};
MO.FE3sSkeleton=function(b){b=MO.Class.inherits(this,b,MO.FE3sObject);b._bones=MO.Class.register(b,new MO.AGetter("_bones"));b._roots=MO.Class.register(b,new MO.AGetter("_roots"));b._skins=MO.Class.register(b,new MO.AGetter("_skins"));b._animations=MO.Class.register(b,new MO.AGetter("_animations"));b.findBone=MO.FE3sSkeleton_findBone;b.pushAnimation=MO.FE3sSkeleton_pushAnimation;b.innerFilter=MO.FE3sSkeleton_innerFilter;b.unserialize=MO.FE3sSkeleton_unserialize;return b};
MO.FE3sSkeleton_findBone=function(b){return this._bones.get(b)};MO.FE3sSkeleton_pushAnimation=function(b){var d=this._animations;d||(d=this._animations=new MO.TObjects);d.push(b)};MO.FE3sSkeleton_innerFilter=function(b){this._bones.set(b.index(),b);if(b=b.bones())for(var d=b.count(),f=0;f<d;f++){var h=b.get(f);this.innerFilter(h)}};
MO.FE3sSkeleton_unserialize=function(b){this.__base.FE3sObject.unserialize.call(this,b);var d=b.readUint8();if(0<d){this._bones=new MO.TDictionary;for(var f=this._roots=new MO.TObjects,h=0;h<d;h++){var q=MO.Class.create(MO.FE3sBone);q.unserialize(b);this.innerFilter(q);f.push(q)}}d=b.readUint8();if(0<d)for(f=this._skins=new MO.TObjects,h=0;h<d;h++)q=MO.Class.create(MO.FE3sSkeletonSkin),q.unserialize(b),f.push(q)};
MO.FE3sSkeletonSkin=function(b){b=MO.Class.inherits(this,b,MO.FE3sObject);b._meshGuid=MO.Class.register(b,new MO.AGetter("_meshGuid"));b._streams=MO.Class.register(b,new MO.AGetter("_streams"));b._boneRefers=MO.Class.register(b,new MO.AGetter("_boneRefers"));b.find=MO.FE3sSkeletonSkin_find;b.unserialize=MO.FE3sSkeletonSkin_unserialize;return b};MO.FE3sSkeletonSkin_find=function(b){return this._streams.get(b)};
MO.FE3sSkeletonSkin_unserialize=function(b){this.__base.FE3sObject.unserialize.call(this,b);this._meshGuid=b.readString();var d=b.readUint8();if(0<d)for(var f=this._streams=new MO.TObjects,h=0;h<d;h++){var q=MO.Class.create(MO.FE3sStream);q.unserialize(b);f.push(q)}d=b.readUint8();if(0<d)for(f=this._boneRefers=new MO.TObjects,h=0;h<d;h++)q=MO.Class.create(MO.FE3sBoneRefer),q.unserialize(b),f.push(q)};
MO.FE3sSpace=function(b){b=MO.Class.inherits(this,b,MO.FE3sResource);b._typeName=null;b._technique=MO.Class.register(b,new MO.AGetter("_technique"));b._region=MO.Class.register(b,new MO.AGetter("_region"));b._materials=MO.Class.register(b,new MO.AGetter("_materials"));b._displays=MO.Class.register(b,new MO.AGetter("_displays"));b._layers=MO.Class.register(b,new MO.AGetter("_layers"));b.construct=MO.FE3sSpace_construct;b.unserialize=MO.FE3sSpace_unserialize;b.saveConfig=MO.FE3sSpace_saveConfig;return b};
MO.FE3sSpace_construct=function(){this.__base.FE3sResource.construct.call(this);this._technique=MO.Class.create(MO.FE3sTechnique);this._region=MO.Class.create(MO.FE3sRegion)};
MO.FE3sSpace_unserialize=function(b){this.__base.FE3sResource.unserialize.call(this,b);var d=MO.Console.find(MO.FE3sResourceConsole),f=MO.Console.find(MO.FE3sMaterialConsole);this._technique.unserialize(b);this._region.unserialize(b);var h=b.readInt16();if(0<h)for(var q=this._materials=new MO.TDictionary,w=0;w<h;w++){var z=f.unserialize(b);q.set(z.guid(),z)}f=b.readInt16();if(0<f)for(h=this._displays=new MO.TObjects,w=0;w<f;w++)q=d.unserialize(b),h.push(q);d=b.readInt16();if(0<d)for(f=this._layers=
new MO.TDictionary,w=0;w<d;w++)h=MO.Class.create(MO.FE3sDisplayLayer),h.unserialize(b),f.set(h.code(),h)};
MO.FE3sSpace_saveConfig=function(b){this.__base.FE3sResource.saveConfig.call(this,b);this._technique.saveConfig(b.create("Technique"));this._region.saveConfig(b.create("Region"));var d=this._materials;if(d)for(var f=b.create("MaterialCollection"),h=d.count(),q=0;q<h;q++)d.at(q).saveConfig(f.create("Material"));if(d=this._displays)for(f=b.create("DisplayCollection"),h=d.count(),q=0;q<h;q++)d.at(q).saveConfig(f.create("Display"));if(d=this._layers)for(b=b.create("LayerCollection"),f=d.count(),q=0;q<
f;q++)d.valueAt(q).saveConfig(b.create("Layer"))};MO.FE3sSprite=function(b){b=MO.Class.inherits(this,b,MO.FE3sDisplayContainer);b._materials=MO.Class.register(b,new MO.AGetter("_materials"));b.construct=MO.FE3sSprite_construct;b.pushMaterial=MO.FE3sSprite_pushMaterial;b.unserialize=MO.FE3sSprite_unserialize;b.saveConfig=MO.FE3sSprite_saveConfig;b.clone=MO.FE3sSprite_clone;return b};MO.FE3sSprite_construct=function(){this.__base.FE3sDisplayContainer.construct.call(this)};
MO.FE3sSprite_pushMaterial=function(b){var d=this._materials;d||(d=this._materials=new MO.TDictionary);d.set(b.guid(),b)};MO.FE3sSprite_unserialize=function(b){this.__base.FE3sDisplayContainer.unserialize.call(this,b);var d=b.readUint16();if(0<d)for(var f=MO.Console.find(MO.FE3sMaterialConsole),h=0;h<d;h++){var q=f.unserialize(b);this.pushMaterial(q)}};
MO.FE3sSprite_saveConfig=function(b){this.__base.FE3sDisplayContainer.saveConfig.call(this,b);var d=this._materials;if(d)for(var f=d.count(),h=b.create("MaterialCollection"),q=0;q<f;q++)d.at(q).saveConfig(h.create("Material"));if(d=this._movies)for(f=d.count(),b=b.create("MovieCollection"),q=0;q<f;q++)d.at(q).saveConfig(b.create("Movie"))};
MO.FE3sSprite_clone=function(b){b=this.__base.FE3sDisplayContainer.clone.call(this,b);var d=this._materials;if(d)for(var f=d.count(),h=0;h<f;h++){var q=d.at(h);b.pushMaterial(q.clone())}return b};
MO.FE3sStream=function(b){b=MO.Class.inherits(this,b,MO.FObject);b._code=MO.Class.register(b,new MO.AGetSet("_code"));b._elementDataCd=MO.Class.register(b,new MO.AGetSet("_elementDataCd"),0);b._elementCount=MO.Class.register(b,new MO.AGetSet("_elementCount"),0);b._elementNormalize=MO.Class.register(b,new MO.AGetSet("_elementNormalize"),!1);b._dataStride=MO.Class.register(b,new MO.AGetSet("_dataStride"),0);b._dataCount=MO.Class.register(b,new MO.AGetSet("_dataCount"),0);b._dataLength=MO.Class.register(b,
new MO.AGetSet("_dataLength"),0);b._data=MO.Class.register(b,new MO.AGetSet("_data"));b._formatCd=MO.Class.register(b,new MO.AGetSet("_formatCd"),MO.EG3dAttributeFormat.Unknown);b.unserialize=MO.FE3sStream_unserialize;b.dispose=MO.FE3sStream_dispose;return b};
MO.FE3sStream_unserialize=function(b){this._code=b.readString();this._elementDataCd=b.readUint8();this._elementCount=b.readUint8();this._elementNormalize=b.readBoolean();var d=this._dataStride=b.readUint8(),f=this._dataCount=b.readInt32(),d=this._dataLength=d*f,f=this._data=new ArrayBuffer(d);b.readBytes(f,0,d)};MO.FE3sStream_dispose=function(){this.data=null;this.__base.FObject.dispose.call(this)};
MO.FE3sTechnique=function(b){b=MO.Class.inherits(this,b,MO.FE3sObject);b._techniqueCode=MO.Class.register(b,new MO.AGetter("_techniqueCode"));b._passes=MO.Class.register(b,new MO.AGetter("_passes"));b.passes=MO.FE3sTechnique_passes;b.unserialize=MO.FE3sTechnique_unserialize;b.saveConfig=MO.FE3sTechnique_saveConfig;return b};
MO.FE3sTechnique_unserialize=function(b){this.__base.FE3sObject.unserialize.call(this,b);var d=b.readInt16();if(0<d)for(var f=this._passes=new MO.TObjects,h=0;h<d;h++){var q=MO.Class.create(MO.FE3sTechniquePass);q.unserialize(b);f.push(q)}};MO.FE3sTechnique_saveConfig=function(b){this.__base.FE3sObject.saveConfig.call(this,b);b.set("technique_code",this._techniqueCode)};
MO.FE3sTechniquePass=function(b){b=MO.Class.inherits(this,b,MO.FE3sObject);b._targetWidth=MO.Class.register(b,new MO.AGetter("_targetWidth"));b._targetHeight=MO.Class.register(b,new MO.AGetter("_targetHeight"));b.unserialize=MO.FE3sTechniquePass_unserialize;return b};MO.FE3sTechniquePass_unserialize=function(b){this.__base.FE3sObject.unserialize.call(this,b);this._targetWidth=b.readUint16();this._targetHeight=b.readUint16()};
MO.FE3sTemplate=function(b){b=MO.Class.inherits(this,b,MO.FE3sSpace);b._typeName="Template";b._dataCompress=!0;return b};MO.FE3sTemplateConsole=function(b){b=MO.Class.inherits(this,b,MO.FConsole);b._templates=null;b._serviceUrl="/cloud.content.template.ws";b.construct=MO.FE3sTemplateConsole_construct;b.unserialize=MO.FE3sTemplateConsole_unserialize;b.loadByGuid=MO.FE3sTemplateConsole_loadByGuid;b.loadByCode=MO.FE3sTemplateConsole_loadByCode;b.update=MO.FE3sTemplateConsole_update;return b};
MO.FE3sTemplateConsole_construct=function(){this.__base.FConsole.construct.call(this);this._templates=new MO.TDictionary};MO.FE3sTemplateConsole_unserialize=function(b){var d=MO.Class.create(MO.FE3sTemplate);d._dataReady=!0;d.unserialize(b);this._templates.set(d.guid(),d);return d};
MO.FE3sTemplateConsole_loadByGuid=function(b){var d=this._templates,f=d.get(b);if(f)return f;var h=MO.Console.find(MO.FE3sVendorConsole).find("template");h.set("guid",b);var q=h.makeUrl(),f=MO.Class.create(MO.FE3sTemplate);f.setGuid(b);f.setVendor(h);f.setSourceUrl(q);MO.Console.find(MO.FResourceConsole).load(f);d.set(b,f);return f};
MO.FE3sTemplateConsole_loadByCode=function(b){var d=this._templates,f=d.get(b);if(f)return f;var h=MO.Console.find(MO.FE3sVendorConsole).find("template");h.set("code",b);var q=h.makeUrl(),f=MO.Class.create(MO.FE3sTemplate);f.setCode(b);f.setVendor(h);f.setSourceUrl(q);MO.Console.find(MO.FResourceConsole).load(f);d.set(b,f);return f};MO.FE3sTemplateConsole_update=function(b){var d=MO.RBrowser.hostPath(this._serviceUrl+"?action=update");MO.Console.find(MO.FXmlConsole).send(d,b)};
MO.FE3sTemplateTheme=function(b){b=MO.Class.inherits(this,b,MO.FE3sObject);b._materials=MO.Class.register(b,new MO.AGetter("_materials"));b.findMaterial=MO.FE3sTemplateTheme_findMaterial;b.materials=MO.FE3sTemplateTheme_materials;b.unserialize=MO.FE3sTemplateTheme_unserialize;return b};MO.FE3sTemplateTheme_findMaterial=function(b){return this._materials.get(b)};
MO.FE3sTemplateTheme_unserialize=function(b){this.__base.FE3sObject.unserialize.call(this,b);var d=b.readUint16();if(0<d)for(var f=MO.Console.find(MO.FE3sMaterialConsole),h=this._materials=new MO.TDictionary,q=0;q<d;q++){var w=f.unserialize(b);h.set(w.groupGuid(),w)}};
MO.FE3sTexture=function(b){b=MO.Class.inherits(this,b,MO.FE3sResource);b._dataCompress=!0;b._bitmaps=MO.Class.register(b,new MO.AGetter("_bitmaps"));b._bitmapPacks=MO.Class.register(b,new MO.AGetter("_bitmapPacks"));b.construct=MO.FE3sTexture_construct;b.unserialize=MO.FE3sTexture_unserialize;b.dispose=MO.FE3sTexture_dispose;return b};MO.FE3sTexture_construct=function(){this.__base.FE3sResource.construct.call(this)};
MO.FE3sTexture_unserialize=function(b){this.__base.FE3sResource.unserialize.call(this,b);var d=b.readInt16();if(0<d)for(var f=this._bitmaps=new MO.TDictionary,h=0;h<d;h++){var q=MO.Class.create(FE3sTextureBitmap);q.unserialize(b);f.set(q.code(),q)}d=b.readInt16();if(0<d)for(f=this._bitmapPacks=new MO.TDictionary,h=0;h<d;h++)q=MO.Class.create(FE3sTextureBitmapPack),q._texture=this,q.unserialize(b),f.set(q.code(),q)};
MO.FE3sTexture_dispose=function(){this._bitmaps=MO.Lang.Object.free(this._bitmaps);this._bitmapPacks=MO.Lang.Object.free(this._bitmapPacks);this.__base.FE3sResource.dispose.call(this)};MO.FE3sTextureBitmap=function(b){b=MO.Class.inherits(this,b,MO.FE3sObject);b._packCode=MO.Class.register(b,new MO.AGetter("_packCode"));b.packCode=MO.FE3sTextureBitmap_packCode;b.unserialize=MO.FE3sTextureBitmap_unserialize;return b};
MO.FE3sTextureBitmap_unserialize=function(b){this.__base.FE3sObject.unserialize.call(this,b);this._packCode=b.readString()};
MO.FE3sTextureBitmapPack=function(b){b=MO.Class.inherits(this,b,MO.FE3sObject);b._optionCompress=MO.Class.register(b,new MO.AGetter("_optionCompress"));b._size=MO.Class.register(b,new MO.AGetter("_size"));b._data=MO.Class.register(b,new MO.AGetter("_data"));b._typeName=null;b._formatName=null;b.construct=MO.FE3sTextureBitmapPack_construct;b.unserialize=MO.FE3sTextureBitmapPack_unserialize;b.dispose=MO.FE3sTextureBitmapPack_dispose;return b};
MO.FE3sTextureBitmapPack_construct=function(){this.__base.FE3sObject.construct.call(this);this._size=new MO.SSize2};
MO.FE3sTextureBitmapPack_unserialize=function(b){this.__base.FE3sObject.unserialize.call(this,b);this._typeName=b.readString();this._formatName=b.readString();this._size.width=b.readUint16();this._size.height=b.readUint16();if("flat"==this._typeName)var d=b.readInt32();else if("cube"==this._typeName){this._data=[];for(var f=0;6>f;f++){var d=b.readInt32(),h=this._data[f]=new ArrayBuffer(d);b.readBytes(h,0,d)}}else throw new MO.TError(this,"Unserial texture failure ");};
MO.FE3sTextureBitmapPack_dispose=function(){this._data=null;this.__base.FE3sObject.dispose.call(this)};MO.FE3sTextureConsole=function(b){b=MO.Class.inherits(this,b,MO.FConsole);b._textures=null;b.construct=MO.FE3sTextureConsole_construct;b.unserialize=MO.FE3sTextureConsole_unserialize;b.load=MO.FE3sTextureConsole_load;b.loadBitmap=MO.FE3sTextureConsole_loadBitmap;b.dispose=MO.FE3sModelConsole_dispose;return b};
MO.FE3sTextureConsole_construct=function(){this.__base.FConsole.construct.call(this);this._textures=new MO.TDictionary};MO.FE3sTextureConsole_unserialize=function(b){var d=MO.Class.create(MO.FE3sTexture);d._dataReady=!0;d.unserialize(b);this._textures.set(d.guid(),d);return d};
MO.FE3sTextureConsole_load=function(b){var d=this._textures,f=d.get(b);if(f)return f;var h=MO.Console.find(MO.FE3sVendorConsole).find("texture"),q=h.makeUrl(b),f=MO.Class.create(MO.FE3sTexture);f.setGuid(b);f.setVendor(h);f.setSourceUrl(q);MO.Console.find(MO.FResourceConsole).load(f);d.set(b,f);return f};
MO.FE3sTextureConsole_loadBitmap=function(b,d,f){var h=MO.Console.find(MO.FE3sVendorConsole).find("texture.bitmap");h.set("guid",b);h.set("code",d);h.set("format",f);b=h.makeUrl();d=this._image=MO.Class.create(MO.FImage);d.loadUrl(b);return d};MO.FE3sTextureConsole_dispose=function(){this._textures=MO.Lang.Object.free(this._textures);this.__base.FConsole.dispose.call(this)};
MO.FE3sTheme=function(b){b=MO.Class.inherits(this,b,MO.FE3sResource);b._materials=MO.Class.register(b,new MO.AGetter("_materials"));b.find=MO.FE3sTheme_find;b.unserialize=MO.FE3sTheme_unserialize;return b};MO.FE3sTheme_find=function(b){var d=this._materials;return d?d.get(b):null};MO.FE3sTheme_unserialize=function(b){if(0<b.readInt32())for(var d=this._materials=new MO.TDictionary,f=0;f<c;f++){var h=RClass.create(FE3sMaterial);h.unserialize(b);d.set(h.code(),h)}};
MO.FE3sThemeConsole=function(b){b=MO.Class.inherits(this,b,MO.FConsole);b._path="/assets/theme/";b._activeTheme=MO.Class.register(b,new MO.AGetter("_activeTheme"));b._themes=null;b.construct=MO.FE3sThemeConsole_construct;b.find=MO.FE3sThemeConsole_find;b.select=MO.FE3sThemeConsole_select;return b};MO.FE3sThemeConsole_construct=function(){this.__base.FConsole.construct.call(this);this._themes=new MO.TDictionary};
MO.FE3sThemeConsole_find=function(b){var d=this._activeTheme;if(null==d)throw new MO.TError("Active theme is empty.");return d.find(b)};MO.FE3sThemeConsole_select=function(b){var d=this._themes.get(b);if(null==d){var f=MO.RBrowser.contentPath(this._path+b+".ser"),d=MO.Class.create(MO.FE3sTheme);d.load(f);this._themes.set(b,d)}return this._activeTheme=d};
MO.FE3sTrack=function(b){b=MO.Class.inherits(this,b,MO.FObject);b._meshCode=MO.Class.register(b,new MO.AGetter("_meshCode"));b._boneIndex=MO.Class.register(b,new MO.AGetter("_boneIndex"),0);b._frameTick=MO.Class.register(b,new MO.AGetter("_frameTick"),0);b._matrix=MO.Class.register(b,new MO.AGetter("_matrix"));b._matrixInvert=MO.Class.register(b,new MO.AGetter("_matrixInvert"));b._frameCount=MO.Class.register(b,new MO.AGetter("_frameCount"));b._frames=MO.Class.register(b,new MO.AGetter("_frames"));
b.construct=MO.FE3sTrack_construct;b.calculate=MO.FE3sTrack_calculate;b.unserialize=MO.FE3sTrack_unserialize;return b};MO.FE3sTrack_construct=function(){this.__base.FObject.construct.call(this);this._matrix=new MO.SMatrix3d;this._matrixInvert=new MO.SMatrix3d};
MO.FE3sTrack_calculate=function(b,d){var f=b.frameCount;if(0==f)throw new MO.TError("Frame count is invalid.");var h=b.beginIndex,q=this._frameTick,w=parseInt(d/q)%f,z=this._frames,A=z.get(h+w),B=null,B=w<f-1?z.get(h+w+1):z.get(h);b.tick=d;b.rate=d%q/q;b.currentFrame=A;b.nextFrame=B;return!0};
MO.FE3sTrack_unserialize=function(b){this._meshCode=b.readString();this._boneIndex=b.readUint16();this._frameTick=b.readUint16();this._matrix.unserialize(b);this._matrixInvert.assign(this._matrix);this._matrixInvert.invert();this._frameCount=b.readInt16();this._frames=new MO.TObjects};
MO.FE3sVendor=function(b){b=MO.Class.inherits(this,b,MO.FObject);b._contentUrl=MO.Class.register(b,new MO.AGetSet("_contentUrl"));b._parameters=null;b.construct=MO.FE3sVendor_construct;b.get=MO.FE3sVendor_get;b.set=MO.FE3sVendor_set;b.makeSource=MO.Method.virtual(b,"makeSource");b.makeUrl=MO.FE3sVendor_makeUrl;b.reset=MO.FE3sVendor_reset;b.dispose=MO.FE3sVendor_dispose;return b};MO.FE3sVendor_construct=function(){this.__base.FObject.construct.call(this);this._parameters=new MO.TAttributes};
MO.FE3sVendor_get=function(b){return this._parameters.get(b)};MO.FE3sVendor_set=function(b,d){this._parameters.set(b,d)};MO.FE3sVendor_makeUrl=function(){var b=this.makeSource();MO.Runtime.isDebug()&&(b=-1==b.indexOf("?")?b+"?":b+"&",b+="date="+MO.Lang.Date.format());return b};MO.FE3sVendor_reset=function(){this._parameters.clear()};MO.FE3sVendor_dispose=function(){this._parameters=MO.Lang.Object.dispose(this._parameters);this.__base.FObject.dispose.call(this)};
MO.FE3sVendorConsole=function(b){b=MO.Class.inherits(this,b,MO.FConsole);b._setuped=!1;b._vendors=null;b.construct=MO.FE3sVendorConsole_construct;b.createVendor=MO.FE3sVendorConsole_createVendor;b.register=MO.FE3sVendorConsole_register;b.find=MO.FE3sVendorConsole_find;b.setup=MO.FE3sVendorConsole_setup;return b};MO.FE3sVendorConsole_construct=function(){this.__base.FConsole.construct.call(this);this._vendors=new MO.TDictionary};
MO.FE3sVendorConsole_createVendor=function(b,d){var f=MO.Class.create(b);f.setContentUrl(d);return f};MO.FE3sVendorConsole_register=function(b,d){this._vendors.set(b,d)};MO.FE3sVendorConsole_find=function(b){this._setuped||this.setup("net");b=this._vendors.get(b);b.reset();return b};
MO.FE3sVendorConsole_setup=function(b){if("net"==b)this._vendors.set("bitmap",this.createVendor(MO.FE3sVendorNet,MO.RBrowser.hostPath("/cloud.resource.bitmap.wv"),"guid")),this._vendors.set("material",this.createVendor(MO.FE3sVendorNet,MO.RBrowser.hostPath("/cloud.resource.material.wv?do=data"),"guid")),this._vendors.set("mesh",this.createVendor(MO.FE3sVendorNet,MO.RBrowser.hostPath("/cloud.resource.mesh.wv"),"guid")),this._vendors.set("model",this.createVendor(MO.FE3sVendorNet,MO.RBrowser.hostPath("/cloud.resource.model.wv"),
"guid")),this._vendors.set("template",this.createVendor(MO.FE3sVendorNet,MO.RBrowser.hostPath("/cloud.resource.template.wv"),"guid")),this._vendors.set("scene",this.createVendor(MO.FE3sVendorNet,MO.RBrowser.hostPath("/cloud.resource.scene.wv"),"guid|code"));else if("local"==b)this._vendors.set("bitmap",this.createVendor(MO.FE3sVendorLocal,MO.RBrowser.contentPath("/ar3/bitmap/{guid}.bin"))),this._vendors.set("material",this.createVendor(MO.FE3sVendorLocal,MO.RBrowser.contentPath("/ar3/material/{guid}.bin"))),
this._vendors.set("mesh",this.createVendor(MO.FE3sVendorLocal,MO.RBrowser.contentPath("/ar3/mesh/{guid}.bin"))),this._vendors.set("model",this.createVendor(MO.FE3sVendorLocal,MO.RBrowser.contentPath("/ar3/model/{guid}.bin"))),this._vendors.set("template",this.createVendor(MO.FE3sVendorLocal,MO.RBrowser.contentPath("/ar3/template/{guid}.bin"))),this._vendors.set("scene",this.createVendor(MO.FE3sVendorLocal,MO.RBrowser.contentPath("/ar3/scene/{guid}.bin")));else throw new MO.TError(this,"Unknown setup code. (code={1})",
b);this._setuped=!0};MO.FE3sVendorLocal=function(b){b=MO.Class.inherits(this,b,MO.FE3sVendor);b.makeSource=MO.FE3sVendorLocal_makeSource;return b};MO.FE3sVendorLocal_makeSource=function(){for(var b=this._contentUrl,d=this._parameters,f=d.count(),h=0;h<f;h++)var q=d.name(h),w=d.value(h),b=MO.Lang.String.replace(b,"{"+q+"}",w);return b};MO.FE3sVendorNet=function(b){b=MO.Class.inherits(this,b,MO.FE3sVendor);b.makeSource=MO.FE3sVendorNet_makeSource;return b};
MO.FE3sVendorNet_makeSource=function(){for(var b=this._contentUrl,b=-1==b.indexOf("?")?b+"?":b+"&",d=this._parameters,f=d.count(),h=!1,q=0;q<f;q++){var w=d.name(q),z=d.value(q);MO.Lang.String.isEmpty(z)||(h?b+="&":h=!0,b+=w+"="+z)}return b};
MO.SE3rPlayInfo=function(){this.tick=0;this.playRate=1;this.frameCount=this.endIndex=this.beginIndex=0;this.nextFrame=this.currentFrame=null;this.alpha=this.rate=1;this.translation=new MO.SPoint3;this.quaternion=new MO.SQuaternion;this.scale=new MO.SVector3;this.matrix=new MO.SMatrix3d;this.update=MO.SE3rPlayInfo_update;return this};
MO.SE3rPlayInfo_update=function(){var b=this.currentFrame;if(!b)return!1;var d=this.nextFrame;if(!d)return!1;var f=this.matrix,h=b.translation(),q=b.quaternion(),b=b.scale(),w=this.rate;0<w&&1>w?(this.translation.slerp(h,d.translation(),w),this.quaternion.slerp(q,d.quaternion(),w),this.scale.slerp(b,d.scale(),w),f.build(this.translation,this.quaternion,this.scale)):f.build(h,q,b);return!0};
MO.FE3rAnimation=function(b){b=MO.Class.inherits(this,b,MO.FObject);b._valid=!1;b._baseTick=0;b._currentTick=0;b._lastTick=0;b._playRate=1;b._tracks=MO.Class.register(b,new AGetter("_tracks"));b._resource=MO.Class.register(b,new AGetter("_resource"));b._playInfo=null;b.construct=MO.FE3rAnimation_construct;b.findTrack=MO.FE3rAnimation_findTrack;b.loadResource=MO.FE3rAnimation_loadResource;b.record=MO.FE3rAnimation_record;b.process=MO.Method.virtual(b,"process");b.dispose=MO.FE3rAnimation_dispose;return b};
MO.FE3rAnimation_construct=function(){this.__base.FObject.construct.call(this);this._playInfo=new MO.SE3rPlayInfo};MO.FE3rAnimation_findTrack=function(b){for(var d=this._tracks,f=d.count(),h=0;h<f;h++){var q=d.get(h);if(q.boneIndex()==b)return q}return null};
MO.FE3rAnimation_loadResource=function(b){var d=b.frameCount();this._resource=b;if(b=b.tracks())for(var f=this._tracks=new MO.TObjects,h=b.count(),q=0;q<h;q++){var w=b.at(q),z=MO.Class.create(MO.FE3rTrack);z._animation=this;z.loadResource(w);f.push(z)}0<d&&(b=this._playInfo,b.beginIndex=0,b.endIndex=0<d?d-1:0,b.frameCount=d,this._valid=!0)};MO.FE3rAnimation_record=function(){var b=RTimer.current();0==this._lastTick&&(this._lastTick=b);this._currentTick=(b-this._lastTick+this._baseTick)*this._playRate};
MO.FE3rAnimation_dispose=function(){this._resource=this._tracks=null;this.__base.FObject.dispose.call(this)};MO.FE3rBitmap=function(b){b=MO.Class.inherits(this,b,MO.FE3rObject);b._pack=null;b.construct=MO.FE3rBitmap_construct;b.testReady=MO.FE3rBitmap_testReady;b.texture=MO.FE3rBitmap_texture;b.loadResource=MO.FE3rBitmap_loadResource;b.dispose=MO.FE3rBitmap_dispose;return b};MO.FE3rBitmap_construct=function(){this.__base.FE3rObject.construct.call(this)};MO.FE3rBitmap_testReady=function(){return this._pack.testReady()};
MO.FE3rBitmap_texture=function(){return this._pack.texture()};MO.FE3rBitmap_loadResource=function(b){this._resource=b;this._guid=b.guid();this._code=b.code()};MO.FE3rBitmap_dispose=function(){this.__base.FE3rObject.dispose.call(this)};
MO.FE3rBitmapConsole=function(b){b=MO.Class.inherits(this,b,MO.FConsole);b._scopeCd=MO.EScope.Local;b._bitmaps=MO.Class.register(b,new AGetter("_bitmaps"));b._dataUrl="/cloud.resource.material.wv";b.construct=MO.FE3rBitmapConsole_construct;b.load=MO.FE3rBitmapConsole_load;b.loadUrl=MO.FE3rBitmapConsole_loadUrl;return b};MO.FE3rBitmapConsole_construct=function(){this.__base.FConsole.construct.call(this);this._bitmaps=new MO.TDictionary};
MO.FE3rBitmapConsole_load=function(b,d,f){var h=d+"|"+f,q=this._bitmaps.get(h);if(q)return q;d=MO.Window.Browser.hostPath(this._dataUrl+"?guid="+d+"&code="+f);MO.Logger.info(this,"Load bitmap. (url={1})",d);q="environment"==f?MO.Class.create(MO.FE3rBitmapCubePack):MO.Class.create(MO.FE3rBitmapFlatPack);q.linkGraphicContext(b);q.loadUrl(d);this._bitmaps.set(h,q);return q};
MO.FE3rBitmapConsole_loadUrl=function(b,d){var f=this._bitmaps.get(d);if(f)return f;f=MO.Window.Browser.contentPath(d);MO.Logger.info(this,"Load bitmap from url. (url={1})",f);f=MO.Window.Class.create(MO.FE3rBitmap);f.linkGraphicContext(b);f.setup();f.loadUrl(d);this._bitmaps.set(d,f);return f};
MO.FE3rBitmapCubePack=function(b){b=MO.Class.inherits(this,b,MO.FE3rBitmapPack);b._resource=null;b._images=null;b.onLoad=MO.FE3rBitmapCubePack_onLoad;b.construct=MO.FE3rBitmapCubePack_construct;b.loadUrl=MO.FE3rBitmapCubePack_loadUrl;b.dispose=MO.FE3rBitmapCubePack_dispose;return b};
MO.FE3rBitmapCubePack_onLoad=function(b){b=this._graphicContext;var d=this._images;MO.Window.Browser.capability();for(var f=0;6>f;f++)if(!d.at(f).testReady())return;(this._texture=b.createCubeTexture()).upload(d.at(0),d.at(1),d.at(2),d.at(3),d.at(4),d.at(5));for(f=0;6>f;f++)d.at(f).dispose();this._images=MO.Lang.Object.dispose(this._images);this._ready=this._dataReady=!0};MO.FE3rBitmapCubePack_construct=function(){this.__base.FE3rBitmapPack.construct.call(this)};
MO.FE3rBitmapCubePack_loadUrl=function(b){this._images=new MO.TObjects;for(var d=0;6>d;d++){var f=MO.Class.create(MO.FImage);f._index=d;f.setOptionAlpha(!1);f.loadUrl(b+"&index="+d);f.addLoadListener(this,this.onLoad);this._images.push(f)}};MO.FE3rBitmapCubePack_dispose=function(){this._images=MO.Lang.Object.dispose(this._images);this.__base.FE3rBitmapPack.dispose.call(this)};
MO.FE3rBitmapFlatPack=function(b){b=MO.Class.inherits(this,b,MO.FE3rBitmapPack);b._resource=null;b._image=null;b.onLoad=MO.FE3rBitmapFlatPack_onLoad;b.construct=MO.FE3rBitmapFlatPack_construct;b.loadUrl=MO.FE3rBitmapFlatPack_loadUrl;b.dispose=MO.FE3rBitmapFlatPack_dispose;return b};MO.FE3rBitmapFlatPack_onLoad=function(b){b=this._texture=this._graphicContext.createFlatTexture();b.upload(this._image);b.makeMipmap();this._image=MO.Lang.Object.dispose(this._image);this._dataReady=!0};
MO.FE3rBitmapFlatPack_construct=function(){this.__base.FE3rBitmapPack.construct.call(this)};MO.FE3rBitmapFlatPack_loadUrl=function(b){var d=this._image=MO.Class.create(MO.FImage);d.addLoadListener(this,this.onLoad);d.loadUrl(b)};MO.FE3rBitmapFlatPack_dispose=function(){this._image=MO.Lang.Object.dispose(this._image);this.__base.FE3rBitmapPack.dispose.call(this)};
MO.FE3rBitmapPack=function(b){b=MO.Class.inherits(this,b,MO.FObject,MO.MGraphicObject);b._resource=null;b._image=null;b._texture=MO.Class.register(b,new AGetter("_texture"));b._ready=!1;b._dataReady=!1;b.onLoad=MO.Method.virtual(b,"onLoad");b.construct=MO.FE3rBitmapPack_construct;b.testReady=MO.FE3rBitmapPack_testReady;b.loadUrl=MO.Method.virtual(b,"loadUrl");b.dispose=MO.FE3rBitmapPack_dispose;return b};MO.FE3rBitmapPack_construct=function(){this.__base.FObject.construct.call(this)};
MO.FE3rBitmapPack_testReady=function(){this._dataReady&&(this._ready=this._texture.isValid());return this._ready};MO.FE3rBitmapPack_dispose=function(){this._dataReady=this._ready=!1;this.__base.FObject.dispose.call(this)};
MO.FE3rBone=function(b){b=MO.Class.inherits(this,b,MO.FObject);b._matrix=MO.Class.register(b,new AGetter("_matrix"));b._boneResource=MO.Class.register(b,new AGetter("_boneResource"));b._trackResource=MO.Class.register(b,new AGetter("_trackResource"));b.construct=MO.FE3rBone_construct;b.loadResource=MO.FE3rBone_loadResource;b.update=MO.FE3rBone_update;b.dispose=MO.FE3rBone_dispose;return b};MO.FE3rBone_construct=function(){this.__base.FObject.construct.call(this);this._matrix=new MO.SMatrix3d};
MO.FE3rBone_loadResource=function(b){this._boneResource=b;this._trackResource=b.track()};MO.FE3rBone_update=function(b,d){var f=this._trackResource;f.calculate(b,d);b.update();var h=this._matrix;h.assign(f.matrixInvert());h.append(b.matrix)};MO.FE3rBone_dispose=function(){this._trackResource=this._boneResource=null;this.__base.FG3dBone.dispose.call(this)};
MO.FE3rDynamicMesh=function(b){b=MO.Class.inherits(this,b,MO.FE3dRenderable);b._model=null;b._optionMerge=!0;b._vertexPosition=0;b._vertexTotal=0;b._indexPosition=0;b._indexTotal=0;b._mergeRenderables=null;b.construct=MO.FE3rDynamicMesh_construct;b.mergeCount=MO.FE3rDynamicMesh_mergeCount;b.mergeMaxCount=MO.FE3rDynamicMesh_mergeMaxCount;b.mergeRenderables=MO.FE3rDynamicMesh_mergeRenderables;b.syncVertexBuffer=MO.FE3rDynamicMesh_syncVertexBuffer;b.mergeRenderable=MO.FE3rDynamicMesh_mergeRenderable;
b.mergeVertexBuffer=MO.FE3rDynamicMesh_mergeVertexBuffer;b.mergeIndexBuffer=MO.FE3rDynamicMesh_mergeIndexBuffer;b.build=MO.FE3rDynamicMesh_build;return b};MO.FE3rDynamicMesh_construct=function(){this.__base.FE3dRenderable.construct.call(this);this._mergeRenderables=new TObjects};MO.FE3rDynamicMesh_mergeCount=function(){return this._mergeRenderables.count()};MO.FE3rDynamicMesh_mergeMaxCount=function(){return this._model._mergeMaxCount};MO.FE3rDynamicMesh_mergeRenderables=function(){return this._mergeRenderables};
MO.FE3rDynamicMesh_syncVertexBuffer=function(b){var d=b._resource.code(),f=this._vertexBuffers.get(d);if(!f){var h=b.formatCd(),q=this._vertexTotal,f=this._graphicContext.createVertexBuffer();f.setCode(d);f.setFormatCd(h);f.setStride(b.stride());switch(h){case MO.EG3dAttributeFormat.Float1:f._data=new Float32Array(1*q);break;case MO.EG3dAttributeFormat.Float2:f._data=new Float32Array(2*q);break;case MO.EG3dAttributeFormat.Float3:f._data=new Float32Array(3*q);break;case MO.EG3dAttributeFormat.Float4:f._data=
new Float32Array(4*q);break;case MO.EG3dAttributeFormat.Byte4:case MO.EG3dAttributeFormat.Byte4Normal:f._data=new Uint8Array(4*q);break;default:throw new MO.TError("Unknown code");}this._vertexBuffers.set(d,f)}return f};
MO.FE3rDynamicMesh_mergeRenderable=function(b){var d=this._graphicContext.capability(),f=b.vertexCount(),h=b.indexBuffers().first().count(),q=d.mergeCount;if(this._mergeRenderables.count()>=q)return!1;q=this._vertexTotal+f;if(d.optionIndex32){if(q>MO.Lang.Integer.MAX_UINT32)return!1}else if(q>MO.Lang.Integer.MAX_UINT16)return!1;this._vertexTotal+=f;this._indexTotal+=h;this._mergeRenderables.push(b);return!0};
MO.FE3rDynamicMesh_mergeVertexBuffer=function(b,d,f,h){b=this._vertexPosition;f=f._data;var q=h._dataCount;switch(d){case "position":d=new Float32Array(h._data);MO.Lang.Float.copy(f,3*b,d,0,3*q);break;case "coord":d=new Float32Array(h._data);MO.Lang.Float.copy(f,2*b,d,0,2*q);break;case "color":case "normal":case "binormal":case "tangent":case "bone_index":case "bone_weight":d=new Uint8Array(h._data);MO.Lang.Byte.copy(f,4*b,d,0,4*q);break;default:throw new MO.TError("Unknown code");}};
MO.FE3rDynamicMesh_mergeIndexBuffer=function(b){var d=this._vertexPosition,f=this._indexPosition,h=this._indexBuffer._data,q=new Uint16Array(b._data);b=3*b._dataCount;for(var w=0;w<b;w++)h[f++]=d+q[w]};
MO.FE3rDynamicMesh_build=function(){var b=this._graphicContext,d=b.capability(),f=this._vertexTotal,h=this._indexTotal,q=this._mergeRenderables,w=q.count(),z=q.first();this._material=z.material();this._textures=z.textures();var A=this._instanceVertexBuffer=this._graphicContext.createVertexBuffer();A.setCode("instance");A.setStride(4);A.setFormatCd(EG3dAttributeFormat.Float1);z=A._data=new Float32Array(f);this._vertexBuffers.set(A.code(),A);A=this._indexBuffer=b.createIndexBuffer(FE3rIndexBuffer);
d.optionIndex32?(A.setStrideCd(MO.EG3dIndexStride.Uint32),A._data=new Uint32Array(h)):(A.setSstrideCd(MO.EG3dIndexStride.Uint16),A._data=new Uint16Array(h));A._count=h;this.pushIndexBuffer(A);for(d=0;d<w;d++){for(var A=q.getAt(d),b=A.vertexCount(),B=A.vertexBuffers(),C=B.count(),D=0;D<C;D++){var E=B.at(D),F=E._resource,H=F.code(),E=this.syncVertexBuffer(E);this.mergeVertexBuffer(A,H,E,F)}RFloat.fill(z,this._vertexPosition,b,d);A=A.indexBuffers().first();B=A.count();this.mergeIndexBuffer(A._resource);
this._vertexPosition+=b;this._indexPosition+=B}B=this._vertexBuffers;C=B.count();for(d=0;d<C;d++)E=B.at(d),E.upload(E._data,E.stride(),f),E._data=null;this._indexBuffer.upload(this._indexBuffer._data,h);this._indexBuffer._data=null};
MO.FE3rDynamicModel=function(b){b=MO.Class.inherits(this,b,MO.FE3rObject);b._renderables=MO.Class.register(b,new AGetter("_renderables"));b._mergeMaxCount=MO.Class.register(b,new AGetter("_mergeMaxCount"));b._mergeStride=MO.Class.register(b,new AGetter("_mergeStride"),4);b._meshes=MO.Class.register(b,new AGetter("_meshes"));b._updateDate=0;b.construct=MO.FE3rDynamicModel_construct;b.createMesh=MO.FE3rDynamicModel_createMesh;b.pushRenderable=MO.FE3rDynamicModel_pushRenderable;b.build=MO.FE3rDynamicModel_build;
b.update=MO.FE3rDynamicModel_update;return b};MO.FE3rDynamicModel_construct=function(){this.__base.FE3rObject.construct.call(this);this._renderables=new MO.TObjects;this._meshes=new MO.TObjects};MO.FE3rDynamicModel_createMesh=function(){var b=MO.Class.create(MO.FE3rDynamicMesh);b._model=this;b.linkGraphicContext(this);this._meshes.push(b);return b};MO.FE3rDynamicModel_pushRenderable=function(b){this._renderables.push(b)};
MO.FE3rDynamicModel_build=function(){var b=this._renderables,d=this._meshes,f=b.count();if(0<f)for(var h=this.createMesh(),q=0;q<f;q++){var w=b.at(q);if(!h.mergeRenderable(w)&&(h=this.createMesh(),!h.mergeRenderable(w)))throw new MO.TError(this,"Merge renderable failure.");}b=0;f=d.count();for(q=0;q<f;q++)h=d.at(q),h.build(),b=Math.max(b,h.mergeCount());this._mergeMaxCount=b};MO.FE3rDynamicModel_update=function(b){this._updateDate=MO.Timer.current()};
MO.FE3rGeometry=function(b){b=MO.Class.inherits(this,b,MO.FE3rObject);b._ready=!1;b._resource=MO.Class.register(b,new AGetSet("_resource"));b._vertexCount=MO.Class.register(b,new AGetter("_vertexCount"),0);b._vertexBuffers=MO.Class.register(b,new AGetter("_vertexBuffers"));b._indexBuffer=MO.Class.register(b,new AGetter("_indexBuffer"));b._indexBuffers=MO.Class.register(b,new AGetter("_indexBuffers"));b._resourceMaterial=MO.Class.register(b,new AGetter("_resourceMaterial"));b._material=MO.Class.register(b,
new AGetter("_material"));b._textures=MO.Class.register(b,new AGetter("_textures"));b.construct=MO.FE3rGeometry_construct;b.testReady=MO.FE3rGeometry_testReady;b.findVertexBuffer=MO.FE3rGeometry_findVertexBuffer;b.findTexture=MO.FE3rGeometry_findTexture;b.loadResource=MO.FE3rGeometry_loadResource;b.processLoad=MO.FE3rGeometry_processLoad;return b};MO.FE3rGeometry_construct=function(){this.__base.FE3rObject.construct.call(this);this._vertexBuffers=new MO.TDictionary;this._indexBuffers=new MO.TObjects};
MO.FE3rGeometry_testReady=function(){if(!this._ready){if(!this._resource.testReady())return!1;var b=this._textures;if(null!=b)for(var d=b.count(),f=0;f<d;f++)if(!b.value(f).testReady())return!1}return this._ready};MO.FE3rGeometry_guid=function(){return this._resource.guid()};MO.FE3rGeometry_findVertexBuffer=function(b){return this._vertexBuffers.get(b)};MO.FE3rGeometry_findTexture=function(b){return this._textures.get(b)};
MO.FE3rGeometry_loadResource=function(b){var d=this._graphicContext;this._resource=b;b=b.streams();for(var f=b.count(),h=0;h<f;h++){var q=b.at(h),w=q.code(),z=q.dataCount(),A=q.data();if("index16"==w||"index32"==w){var B=this._indexBuffer=d.createIndexBuffer(FE3rIndexBuffer);B._resource=q;q=q.elementDataCd();if(q==MO.EDataType.Uint16)B.setStrideCd(MO.EG3dIndexStride.Uint16);else if(q==MO.EDataType.Uint32)B.setStrideCd(MO.EG3dIndexStride.Uint32);else throw new MO.TError(this,"Unknown data type.");
B.upload(A,3*z);this._indexBuffers.push(B)}else{B=d.createVertexBuffer(FE3rVertexBuffer);B.setCode(w);B._resource=q;B._vertexCount=z;var C=null;switch(w){case "position":C=new Float32Array(A);B.setFormatCd(EG3dAttributeFormat.Float3);this._vertexCount=z;break;case "coord":C=new Float32Array(A);B.setFormatCd(EG3dAttributeFormat.Float2);break;case "color":C=new Uint8Array(A);B.setFormatCd(EG3dAttributeFormat.Byte4Normal);break;case "normal":case "binormal":case "tangent":C=new Uint8Array(A);B.setFormatCd(EG3dAttributeFormat.Byte4Normal);
break;default:throw new TError(this,"Unknown code");}B.upload(C,q._dataStride,z);this._vertexBuffers.set(w,B)}}this._ready=!0};MO.FE3rGeometry_processLoad=function(){if(this._dataReady)return!0;if(!this._resource.testReady())return!1;this.loadResource(this._resource);return!0};MO.FE3rIndexBuffer=function(b){b=MO.Class.inherits(this,b,MO.FWglIndexBuffer,MO.MLinkerResource);b.dispose=MO.FE3rIndexBuffer_dispose;return b};
MO.FE3rIndexBuffer_dispose=function(){this.__base.MLinkerResource.dispose.call(this);this.__base.FWglIndexBuffer.dispose.call(this)};MO.FE3rInstanceMesh=function(b){b=MO.Class.inherits(this,b,MO.FE3rMesh);b._merges=null;b.construct=MO.FE3rInstanceMesh_construct;b.mergeRenderable=MO.FE3rInstanceMesh_mergeRenderable;b.build=MO.FE3rInstanceMesh_build;return b};MO.FE3rInstanceMesh_construct=function(){this.__base.FE3rMesh.construct.call(this);this._merges=new MO.TObjects};
MO.FE3rInstanceMesh_mergeRenderable=function(b){this._merges.push(b)};MO.FE3rInstanceMesh_build=function(){};
MO.FE3rMaterial=function(b){b=MO.Class.inherits(this,b,MO.FG3dMaterial,MO.MGraphicObject,MO.MLinkerResource);b._ready=!1;b._visible=MO.Class.register(b,new MO.AGetSet("_visible"),!0);b._guid=MO.Class.register(b,new MO.AGetSet("_guid"));b._bitmaps=MO.Class.register(b,new MO.AGetter("_bitmaps"));b._reference=MO.Class.register(b,new MO.AGetter("_reference"));b.findBitmap=MO.FE3rMaterial_findBitmap;b.testReady=MO.FE3rMaterial_testReady;b.testVisible=MO.FE3rMaterial_testVisible;b.loadResource=MO.FE3rMaterial_loadResource;
b.reloadResource=MO.FE3rMaterial_reloadResource;b.load=MO.FE3rMaterial_load;return b};MO.FE3rMaterial_findBitmap=function(b){return this._bitmaps.get(b)};MO.FE3rMaterial_testReady=function(){if(!this._ready){var b=this._bitmaps;if(b)for(var d=b.count(),f=0;f<d;f++)if(!b.at(f).testReady())return!1;this._ready=!0}return this._ready};MO.FE3rMaterial_testVisible=function(){var b=this._visible;b&&this._reference&&(b=this._reference.testVisible());return b};
MO.FE3rMaterial_loadResource=function(b){this._guid=b.guid();this._resource=b;this._info.calculate(b.info());this._dirty=!0};MO.FE3rMaterial_reloadResource=function(){this._info.calculate(this._resource.info());this._dirty=!0};
MO.FE3rMaterial_load=function(){var b=this._resource.bitmaps();if(b)for(var d=MO.Console.find(MO.FE3rBitmapConsole),f=this._bitmaps=new MO.TDictionary,h=b.count(),q=0;q<h;q++){var w=b.at(q),z=w.code(),A=w.bitmapPack().code(),A=d.load(this,this._guid,A),B=MO.Class.create(MO.FE3rBitmap);B._pack=A;B.loadResource(w);f.set(z,B)}};
MO.FE3rMaterialConsole=function(b){b=MO.Class.inherits(this,b,MO.FConsole);b._scopeCd=MO.EScope.Local;b._materials=null;b.construct=MO.FE3rMaterialConsole_construct;b.load=MO.FE3rMaterialConsole_load;return b};MO.FE3rMaterialConsole_construct=function(){this.__base.FConsole.construct.call(this);this._materials=new MO.TDictionary};
MO.FE3rMaterialConsole_load=function(b,d){if(!b)throw new MO.TError("Graphics context is empty");if(!d)throw new MO.TError("Material guid is empty");var f=this._materials.get(d);if(f)return f;var h=MO.Console.find(MO.FE3sMaterialConsole).find(d),f=MO.Class.create(MO.FE3rMaterial);f.linkGraphicContext(b);f.loadResource(h);f.load();this._materials.set(d,f);return f};
MO.FE3rMesh=function(b){b=MO.Class.inherits(this,b,MO.FE3rObject);b._ready=!1;b._resource=MO.Class.register(b,new AGetSet("_resource"));b._vertexCount=MO.Class.register(b,new AGetter("_vertexCount"),0);b._vertexBuffers=MO.Class.register(b,new AGetter("_vertexBuffers"));b._indexBuffer=MO.Class.register(b,new AGetter("_indexBuffer"));b._resourceMaterial=MO.Class.register(b,new AGetter("_resourceMaterial"));b._material=MO.Class.register(b,new AGetter("_material"));b._textures=MO.Class.register(b,new AGetter("_textures"));
b.construct=MO.FE3rMesh_construct;b.testReady=MO.FE3rMesh_testReady;b.findVertexBuffer=MO.FE3rMesh_findVertexBuffer;b.findTexture=MO.FE3rMesh_findTexture;b.loadResource=MO.FE3rMesh_loadResource;b.processLoad=MO.FE3rMesh_processLoad;return b};MO.FE3rMesh_construct=function(){this.__base.FE3rObject.construct.call(this);this._vertexBuffers=new TObjects};
MO.FE3rMesh_testReady=function(){if(!this._ready){if(!this._resource.testReady())return!1;var b=this._textures;if(null!=b)for(var d=b.count(),f=0;f<d;f++)if(!b.value(f).testReady())return!1}return this._ready};MO.FE3rMesh_guid=function(){return this._resource.guid()};MO.FE3rMesh_findVertexBuffer=function(b){for(var d=this._vertexBuffers,f=d.count(),h=0;h<f;h++){var q=d.get(h);if(q.name()==b)return q}return null};MO.FE3rMesh_findTexture=function(b){return this._textures.get(b)};
MO.FE3rMesh_loadResource=function(b){var d=this._graphicContext;this._resource=b;b=b.streams();for(var f=b.count(),h=0;h<f;h++){var q=b.get(h),w=q._code,z=q._dataCount,A=q._data;if("index16"==w||"index32"==w){var B=this._indexBuffer=d.createIndexBuffer();B._resource=q;q=q.elementDataCd();if(q==EDataType.Uint16)B._strideCd=EG3dIndexStride.Uint16;else if(q==EDataType.Uint32)B._strideCd=EG3dIndexStride.Uint32;else throw new TError(this,"Unknown data type.");B.upload(A,3*z)}else{B=d.createVertexBuffer();
B._name=w;B._resource=q;B._vertexCount=z;var C=null;switch(w){case "position":C=new Float32Array(A);B._formatCd=EG3dAttributeFormat.Float3;break;case "coord":C=new Float32Array(A);B._formatCd=EG3dAttributeFormat.Float2;break;case "color":C=new Uint8Array(A);B._formatCd=EG3dAttributeFormat.Byte4Normal;break;case "normal":case "binormal":case "tangent":C=new Uint8Array(A);B._formatCd=EG3dAttributeFormat.Byte4Normal;break;default:throw new TError(this,"Unknown code");}B.upload(C,q._dataStride,z);this._vertexBuffers.push(B)}}this._ready=
!0};MO.FE3rMesh_processLoad=function(){if(this._dataReady)return!0;if(!this._resource.testReady())return!1;this.loadResource(this._resource);return!0};MO.FE3rMeshAnimation=function(b){b=MO.Class.inherits(this,b,MO.FE3rAnimation);b.process=MO.FE3rMeshAnimation_process;return b};MO.FE3rMeshAnimation_process=function(b){if(this._valid){var d=Math.abs(this._currentTick),f=b._resource,h=this._playInfo;f.calculate(h,d);h.update();b=b._matrix;b.assign(f.matrixInvert());b.append(h.matrix)}};
MO.FE3rMeshConsole=function(b){b=MO.Class.inherits(this,b,MO.FConsole);b._scopeCd=MO.EScope.Local;b._loadMeshs=null;b._meshs=MO.Class.register(b,new AGetter("_meshs"));b._thread=null;b._interval=200;b.onProcess=MO.FE3rMeshConsole_onProcess;b.construct=MO.FE3rMeshConsole_construct;b.findMesh=MO.FE3rMeshConsole_findMesh;b.loadByGuid=MO.FE3rMeshConsole_loadByGuid;b.loadByCode=MO.FE3rMeshConsole_loadByCode;return b};
MO.FE3rMeshConsole_onProcess=function(){var b=this._loadMeshs;for(b.record();b.next();)b.current().processLoad()&&b.removeCurrent()};MO.FE3rMeshConsole_construct=function(){this.__base.FConsole.construct.call(this);this._loadMeshs=new MO.TLooper;this._meshs=new MO.TDictionary;var b=this._thread=MO.Class.create(MO.FThread);b.setInterval(this._interval);b.addProcessListener(this,this.onProcess);MO.Console.find(MO.FThreadConsole).start(b)};MO.FE3rMeshConsole_findMesh=function(b){return this._meshs.get(b)};
MO.FE3rMeshConsole_loadByGuid=function(b,d){if(!MO.Class.isClass(b,MO.MGraphicObject))throw new MO.TError("Graphics context is empty");if(MO.Lang.String.isEmpty(d))throw new MO.TError("Mesh guid is empty");var f=this._meshs.get(d);if(f)return f;var h=MO.Console.find(MO.FE3sMeshConsole).loadByGuid(d),f=MO.Class.create(MO.FE3rMesh);f.linkGraphicContext(b);f.setCode(d);f.setResource(h);this._meshs.set(d,f);h.testReady()?f.loadResource(h):this._loadMeshs.push(f);return f};
MO.FE3rMeshConsole_loadByCode=function(b,d){if(!MO.Class.isClass(b,MO.MGraphicObject))throw new MO.TError("Graphics context is empty");if(MO.Lang.String.isEmpty(d))throw new MO.TError("Mesh code is empty");var f=this._meshs.get(d);if(f)return f;var h=MO.Console.find(MO.FE3sMeshConsole).loadByCode(d),f=MO.Class.create(MO.FE3rMesh);f.linkGraphicContext(b);f.setCode(d);f.setResource(h);this._meshs.set(d,f);h.testReady()?f.loadResource(h):this._loadMeshs.push(f);return f};
MO.FE3rModel=function(b){b=MO.Class.inherits(this,b,MO.FE3rObject);b._resource=MO.Class.register(b,new AGetSet("_resource"));b._meshes=MO.Class.register(b,new AGetter("_meshes"));b._skeletons=MO.Class.register(b,new AGetter("_skeletons"));b._dataReady=!1;b.findMeshByGuid=MO.FE3rModel_findMeshByGuid;b.testReady=MO.FE3rModel_testReady;b.loadResource=MO.FE3rModel_loadResource;b.loadSkeletonResource=MO.FE3rModel_loadSkeletonResource;b.processLoad=MO.FE3rModel_processLoad;b.dispose=MO.FE3rModel_dispose;
return b};MO.FE3rModel_findMeshByGuid=function(b){for(var d=this._meshes,f=d.count(),h=0;h<f;h++){var q=d.get(h);if(q._guid==b)return q}return null};MO.FE3rModel_testReady=function(){return this._dataReady};MO.FE3rModel_loadSkeletonResource=function(b){var d=MO.Console.find(MO.FE3rModelConsole);if(b=b.skins())for(var f=b.count(),h=0;h<f;h++){var q=b.at(h),w=MO.Class.create(MO.FE3rSkin);w.linkGraphicContext(this);w.loadResource(q);q=q.meshGuid();d.findMesh(q).pushSkin(w)}};
MO.FE3rModel_loadResource=function(b){var d=MO.Console.find(MO.FE3rModelConsole),f=b.meshes();if(f)for(var h=this._meshes=new MO.TObjects,q=f.count(),w=0;w<q;w++){var z=f.valueAt(w),A=MO.Class.create(MO.FE3rModelMesh);A.linkGraphicContext(this);A.loadResource(z);h.push(A);d.meshs().set(A.guid(),A)}if(b=b.skeletons())for(d=b.count(),w=0;w<d;w++)f=b.get(w),this.loadSkeletonResource(f);this._dataReady=!0};
MO.FE3rModel_processLoad=function(){if(this._dataReady)return!0;if(!this._resource.testReady())return!1;this.loadResource(this._resource);return!0};MO.FE3rModel_dispose=function(){this._ready=!1;this._resource=null;this._meshes=MO.Lang.Object.dispose(this._meshes);this._skeletons=MO.Lang.Object.dispose(this._skeletons);this.__base.FObject.dispose.call(this)};
MO.FE3rModelConsole=function(b){b=MO.Class.inherits(this,b,MO.FConsole);b._scopeCd=MO.EScope.Local;b._loadModels=null;b._models=MO.Class.register(b,new MO.AGetter("_models"));b._meshs=MO.Class.register(b,new MO.AGetter("_meshs"));b._dynamicMeshs=null;b._thread=null;b._interval=200;b.onProcess=MO.FE3rModelConsole_onProcess;b.construct=MO.FE3rModelConsole_construct;b.findModel=MO.FE3rModelConsole_findModel;b.findMesh=MO.FE3rModelConsole_findMesh;b.load=MO.FE3rModelConsole_load;b.loadMeshByGuid=MO.FE3rModelConsole_loadMeshByGuid;
b.loadMeshByCode=MO.FE3rModelConsole_loadMeshByCode;b.merge=MO.FE3rModelConsole_merge;return b};MO.FE3rModelConsole_onProcess=function(){var b=this._loadModels;for(b.record();b.next();)b.current().processLoad()&&b.removeCurrent()};
MO.FE3rModelConsole_construct=function(){this.__base.FConsole.construct.call(this);this._loadModels=new MO.TLooper;this._models=new MO.TDictionary;this._meshs=new MO.TDictionary;this._dynamicMeshs=new MO.TDictionary;var b=this._thread=MO.Class.create(MO.FThread);b.setInterval(this._interval);b.addProcessListener(this,this.onProcess);MO.Console.find(MO.FThreadConsole).start(b)};MO.FE3rModelConsole_findModel=function(b){return this._models.get(b)};MO.FE3rModelConsole_findMesh=function(b){return this._meshs.get(b)};
MO.FE3rModelConsole_load=function(b,d){if(!b)throw new MO.TError("Graphics context is empty");if(!d)throw new MO.TError("Model guid is empty");var f=this._models.get(d);if(f)return f;var h=MO.Console.find(MO.FE3sModelConsole).load(d),f=MO.Class.create(MO.FE3rModel);f.linkGraphicContext(b);f.setCode(d);f.setResource(h);this._models.set(d,f);this._loadModels.push(f);return f};
MO.FE3rModelConsole_loadMeshByGuid=function(b,d){if(!b)throw new MO.TError("Graphics context is empty");if(!guid)throw new MO.TError("Model guid is empty");var f=this._models.get(d);if(f)return f;MO.Console.find(MO.FE3sModelConsole).load(guid);f=MO.Class.create(MO.FE3rModel);f.linkGraphicContext(pc);f.setCode(d);f.setResource(rm);this._models.set(d,f);rm.testReady()?f.loadResource(rm):this._loadModels.push(f);return f};
MO.FE3rModelConsole_loadMeshByCode=function(b,d){if(!MO.Class.isClass(b,MO.MGraphicObject))throw new MO.TError("Graphics context is empty");if(MO.Lang.String.isEmpty(d))throw new MO.TError("Model guid is empty");var f=this._models.get(d);if(f)return f;var h=MO.Console.find(MO.FE3sModelConsole).load(guid),f=MO.Class.create(MO.FE3rModel);f.linkGraphicContext(pc);f.setCode(d);f.setResource(h);this._models.set(d,f);rm.testReady()?m.loadResource(rm):this._loadModels.push(m);return m};
MO.FE3rModelConsole_merge=function(b,d,f,h){b="merge";for(var q=d.renderables(),w=0;w<h;w++){var z=q.getAt(f+w);b+="|"+z.hashCode()}var A=this._dynamicMeshs.get(b);if(!A){A=MO.Class.create(MO.FE3rDynamicModel);A.linkGraphicContext(d);for(w=0;w<h;w++)z=q.getAt(f+w),A.pushRenderable(z);A.build();this._dynamicMeshs.set(b,A);MO.Logger.info(this,"Create merge model. (mesh={1}, renderables={2})",A.meshes().count(),A.renderables().count())}A.update();return A};
MO.FE3rModelMesh=function(b){b=MO.Class.inherits(this,b,MO.FE3rGeometry);b._ready=!1;b._resourceMaterial=null;b._skins=MO.Class.register(b,new AGetter("_skins"));b._boneIds=MO.Class.register(b,new AGetter("_boneIds"));b.construct=MO.FE3rModelMesh_construct;b.testReady=MO.FE3rModelMesh_testReady;b.guid=MO.FE3rModelMesh_guid;b.pushSkin=MO.FE3rModelMesh_pushSkin;return b};MO.FE3rModelMesh_construct=function(){this.__base.FE3rGeometry.construct.call(this)};
MO.FE3rModelMesh_testReady=function(){if(!this._ready){var b=this._textures;if(b)for(var d=b.count(),f=0;f<d;f++)if(!b.at(f).testReady())return!1;this._ready=!0}return this._ready};MO.FE3rModelMesh_guid=function(){return this._resource.guid()};MO.FE3rModelMesh_pushSkin=function(b){var d=this._skins;d||(d=this._skins=new MO.TObjects);d.push(b)};
MO.FE3rObject=function(b){b=MO.Class.inherits(this,b,MO.FObject,MO.MGraphicObject);b._guid=MO.Class.register(b,new MO.AGetSet("_guid"));b._code=MO.Class.register(b,new MO.AGetSet("_code"));return b};MO.FE3rPipeline=function(b){b=MO.Class.inherits(this,b,MO.FObject);b._vertexBuffers=null;b._indexBuffer=null;b.construct=MO.FE3rPipeline_construct;b.findVertexBuffer=MO.FE3rPipeline_findVertexBuffer;b.loadResource=MO.FE3rPipeline_loadResource;return b};
MO.FE3rPipeline_construct=function(){this.__base.FRenderable.construct.call(this);this._vertexBuffers=new MO.TObjects};MO.FE3rPipeline_findVertexBuffer=function(b){for(var d=this._vertexBuffers,f=d.count(),h=0;h<f;h++){var q=d.get(h);if(q.name()==b)return q}return null};
MO.FE3rPipeline_loadResource=function(b){for(var d=this._context,f=b.vertexBuffers(),h=f.count(),q=0;q<h;q++){var w=f.get(q),z=context.createVertexBuffer();z._name=w.name();z.upload(new Float32Array(w._data),w._stride,w._vertexCount);this._vertexBuffers.push(z)}b=b.indexBuffer();(this._indexBuffer=d.createIndexBuffer()).upload(b.data(),b.count())};
MO.FE3rSkeleton=function(b){b=MO.Class.inherits(this,b,MO.FE3rObject,MO.MLinkerResource);b._bones=MO.Class.register(b,new AGetter("_bones"));b._skins=MO.Class.register(b,new AGetter("_skins"));b.loadResource=MO.FE3rSkeleton_loadResource;return b};MO.FE3rSkeleton_loadResource=function(b){this._resource=b;b=b._bones;var d=b.count();if(0<d)for(var f=this._bones=new MO.TObjects,h=0;h<d;h++){var q=b.at(h),w=MO.Class.create(MO.FE3rBone);w.loadResource(q);f.push(w)}};
MO.FE3rSkeletonAnimation=function(b){b=MO.Class.inherits(this,b,MO.FE3rAnimation);b.process=MO.FE3rSkeletonAnimation_process;return b};MO.FE3rSkeletonAnimation_process=function(b){if(this._valid){var d=Math.abs(this._currentTick);b=b.bones();for(var f=b.count(),h=0;h<f;h++)b.at(h).update(this._playInfo,d)}};
MO.FE3rSkin=function(b){b=MO.Class.inherits(this,b,MO.FE3rObject);b._resource=MO.Class.register(b,new AGetter("_resource"));b._streams=MO.Class.register(b,new AGetter("_streams"));b.loadResource=MO.FE3rSkin_loadResource;return b};MO.FE3rSkin_loadResource=function(b){this._resource=b;if(b=b.streams()){var d=b.count();if(0<d)for(var f=this._streams=new MO.TObjects,h=0;h<d;h++){var q=b.at(h),w=MO.Class.create(MO.FE3rStream);w.linkGraphicContext(this);w.loadResource(q);f.push(w)}}};
MO.FE3rStream=function(b){b=MO.Class.inherits(this,b,MO.FE3rObject);b._resource=MO.Class.register(b,new MO.AGetter("_resource"));b._buffer=MO.Class.register(b,new MO.AGetter("_buffer"));b.loadResource=MO.FE3rStream_loadResource;return b};
MO.FE3rStream_loadResource=function(b){var d=b.code(),f=b._dataCount;this._resource=b;this._vertexCount=f;var h=this._buffer=this._graphicContext.createVertexBuffer(FE3rVertexBuffer);h.setCode(d);h.setResource(b);switch(d){case "bone_index":h.setFormatCd(EG3dAttributeFormat.Byte4);break;case "bone_weight":h.setFormatCd(EG3dAttributeFormat.Byte4Normal);break;default:throw new MO.TError("Unknown code");}h.upload(b._data,b._dataStride,f)};
MO.FE3rTexture=function(b){b=MO.Class.inherits(this,b,MO.FObject,MO.MGraphicObject);b._resource=MO.Class.register(b,new MO.AGetSet("_resource"));b._bitmaps=MO.Class.register(b,new MO.AGetter("_bitmaps"));b._bitmapPacks=MO.Class.register(b,new MO.AGetter("_bitmapPacks"));b._ready=!1;b._dataReady=!1;b.construct=MO.FE3rTexture_construct;b.testReady=MO.FE3rTexture_testReady;b.loadBitmap=MO.FE3rTexture_loadBitmap;b.loadResource=MO.FE3rTexture_loadResource;b.load=MO.FE3rTexture_load;b.processLoad=MO.FE3rTexture_processLoad;
b.dispose=MO.FE3rTexture_dispose;return b};MO.FE3rTexture_construct=function(){this.__base.FObject.construct.call(this);this._bitmaps=new MO.TDictionary};MO.FE3rTexture_testReady=function(){return this._ready};MO.FE3rTexture_loadBitmap=function(b){var d=this._bitmaps,f=d.get(b);f||(f=MO.Class.create(MO.FE3rTextureBitmap),d.set(b,f));return f};
MO.FE3rTexture_loadResource=function(b){if(b=b.bitmapPacks()){this._bitmapPacks=new MO.TDictionary;for(var d=b.count(),f=0;f<d;f++){var h=b.valueAt(f),q=null;if("flat"==h._typeName)q=MO.Class.create(MO.FE3rTextureBitmapFlatPack);else if("cube"==h._typeName)q=MO.Class.create(MO.FE3rTextureBitmapCubePack);else throw new MO.TError(this,"Load resource failure.");q.linkGraphicContext(this);q.loadResource(h);this._bitmapPacks.set(h.code(),q)}}this._dataReady=!0};
MO.FE3rTexture_load=function(){for(var b=this._resource.bitmaps(),d=b.count()-1;0<=d;d--){var f=b.valueAt(d),h=this.loadBitmap(f.guid()),f=this._bitmapPacks.get(f.packCode());if(!f)throw new MO.TError("Link pack is not eists.");h.load(f)}this._ready=!0};MO.FE3rTexture_processLoad=function(){if(this._dataReady){for(var b=this._bitmapPacks,d=b.count()-1;0<=d;d--)if(!b.valueAt(d).testReady())return!1;this.load()}else{if(!this._resource.testReady())return!1;this.loadResource(this._resource)}return this._ready};
MO.FE3rTexture_dispose=function(){this._ready=!1;this._resource=null;this._bitmaps=MO.Lang.Object.dispose(this._bitmaps);this.__base.FObject.dispose.call(this)};MO.FE3rTextureBitmap=function(b){b=MO.Class.inherits(this,b,MO.FObject,MO.MGraphicObject);b._ready=!1;b._bitmapPack=null;b.construct=MO.FE3rTextureBitmap_construct;b.texture=MO.FE3rTextureBitmap_texture;b.testReady=MO.FE3rTextureBitmap_testReady;b.load=MO.FE3rTextureBitmap_load;b.dispose=MO.FE3rTextureBitmap_dispose;return b};
MO.FE3rTextureBitmap_construct=function(){this.__base.FObject.construct.call(this)};MO.FE3rTextureBitmap_texture=function(){return this._bitmapPack.texture()};MO.FE3rTextureBitmap_testReady=function(){return this._ready};MO.FE3rTextureBitmap_load=function(b){this._bitmapPack=b;this._ready=!0};MO.FE3rTextureBitmap_dispose=function(){this._context=null;this._ready=!1;this._bitmapPack=null;this.__base.FObject.dispose.call(this)};
MO.FE3rTextureBitmapCubePack=function(b){b=MO.Class.inherits(this,b,MO.FE3rTextureBitmapPack);b._resource=null;b._images=null;b.onLoad=MO.FE3rTextureBitmapCubePack_onLoad;b.construct=MO.FE3rTextureBitmapCubePack_construct;b.loadResource=MO.FE3rTextureBitmapCubePack_loadResource;b.dispose=MO.FE3rTextureBitmapCubePack_dispose;return b};
MO.FE3rTextureBitmapCubePack_onLoad=function(b){var d=this._graphicContext;b=this._images;for(var f=MO.Window.Browser.capability(),h=0;6>h;h++)if(!b[h].testReady())return;(this._texture=d.createCubeTexture()).upload(b[0],b[1],b[2],b[3],b[4],b[5]);if(f.blobCreate)for(h=0;6>h;h++)d=b[h],window.URL.revokeObjectURL(d.url()),b[h]=MO.Lang.Object.dispose(d);this._images=MO.Lang.Object.dispose(this._images);this._dataReady=!0};MO.FE3rTextureBitmapCubePack_construct=function(){this.__base.FE3rTextureBitmapPack.construct.call(this)};
MO.FE3rTextureBitmapCubePack_loadResource=function(b){this._resource=b;var d=b._texture,f=MO.Window.Browser.capability(),h=b.data(),q=b._formatName;this._images=new MO.TObjects;for(var w=0;6>w;w++){var z=this._images[w]=MO.Class.create(FImage);z._index=w;z.setOptionAlpha(!1);if(f.blobCreate)var A=new Blob([h[w]],{type:"image/"+q}),A=window.URL.createObjectURL(A);else A=MO.Window.Browser.hostPath("/cloud.content.texture.bitmap.wv")+"?guid="+d._guid+"&code="+b._code+"&index="+w;z.loadUrl(A);z.addLoadListener(this,
this.onLoad)}};MO.FE3rTextureBitmapCubePack_dispose=function(){this._images=MO.Lang.Object.dispose(this._images);this.__base.FE3rTextureBitmapPack.dispose.call(this)};MO.FE3rTextureBitmapFlatPack=function(b){b=MO.Class.inherits(this,b,MO.FE3rTextureBitmapPack);b._resource=null;b._image=null;b.onLoad=MO.FE3rTextureBitmapFlatPack_onLoad;b.construct=MO.FE3rTextureBitmapFlatPack_construct;b.loadResource=MO.FE3rTextureBitmapFlatPack_loadResource;b.dispose=MO.FE3rTextureBitmapFlatPack_dispose;return b};
MO.FE3rTextureBitmapFlatPack_onLoad=function(b){b=this._texture=this._graphicContext.createFlatTexture();b.upload(this._image);b.makeMipmap();this._image=MO.Lang.Object.dispose(this._image);this._dataReady=!0};MO.FE3rTextureBitmapFlatPack_construct=function(){this.__base.FE3rTextureBitmapPack.construct.call(this)};
MO.FE3rTextureBitmapFlatPack_loadResource=function(b){this._resource=b;var d=b._texture,f=b.code();(this._image=MO.Console.find(MO.FE3sTextureConsole).loadBitmap(d._guid,f,b._formatName)).addLoadListener(this,this.onLoad)};MO.FE3rTextureBitmapFlatPack_dispose=function(){this._image=MO.Lang.Object.dispose(this._image);this.__base.FE3rTextureBitmapPack.dispose.call(this)};
MO.FE3rTextureBitmapPack=function(b){b=MO.Class.inherits(this,b,MO.FObject,MO.MGraphicObject);b._resource=null;b._image=null;b._texture=MO.Class.register(b,new AGetter("_texture"));b._ready=!1;b._dataReady=!1;b.onLoad=MO.Method.virtual(b,"onLoad");b.construct=MO.FE3rTextureBitmapPack_construct;b.testReady=MO.FE3rTextureBitmapPack_testReady;b.loadResource=MO.Method.virtual(b,"loadResource");b.dispose=MO.FE3rTextureBitmapPack_dispose;return b};MO.FE3rTextureBitmapPack_construct=function(){this.__base.FObject.construct.call(this)};
MO.FE3rTextureBitmapPack_testReady=function(){this._dataReady&&(this._ready=this._texture.isValid());return this._ready};MO.FE3rTextureBitmapPack_dispose=function(){this._dataReady=this._ready=!1;this.__base.FObject.dispose.call(this)};
MO.FE3rTextureConsole=function(b){b=MO.Class.inherits(this,b,MO.FConsole);b._scopeCd=MO.EScope.Local;b._loadTextures=null;b._bitmaps=MO.Class.register(b,new AGetter("_bitmaps"));b._textures=MO.Class.register(b,new AGetter("_textures"));b._thread=null;b._interval=200;b.onProcess=MO.FE3rTextureConsole_onProcess;b.construct=MO.FE3rTextureConsole_construct;b.load=MO.FE3rTextureConsole_load;b.loadBitmap=MO.FE3rTextureConsole_loadBitmap;return b};
MO.FE3rTextureConsole_onProcess=function(){var b=this._loadTextures;for(b.record();b.next();)b.current().processLoad()&&b.removeCurrent()};MO.FE3rTextureConsole_construct=function(){this.__base.FConsole.construct.call(this);this._loadTextures=new MO.TLooper;this._bitmaps=new MO.TDictionary;this._textures=new MO.TDictionary;var b=this._thread=MO.Class.create(MO.FThread);b.setInterval(this._interval);b.addProcessListener(this,this.onProcess);MO.Console.find(MO.FThreadConsole).start(b)};
MO.FE3rTextureConsole_load=function(b,d,f){if(b=this._textures.get(d+"|"+f))return b;d=MO.Window.Browser.hostPath(this._dataUrl+"?guid="+d+"&code="+f);MO.Logger.info(this,"Load bitmap. (url={1})",d);bitmap="environment"==f?MO.Window.Class.create(MO.FE3rTextureCube):MO.Window.Class.create(MO.FE3rTexture);t._name=pg;t.linkGraphicContext(pc);t.load(u);this._bitmaps.set(pg,t);return t};
MO.FE3rTextureConsole_load2=function(b,d){var f=this._textures,h=f.get(d);if(h)return h;var q=MO.Console.find(MO.FE3sTextureConsole).load(d),h=MO.Class.create(MO.FE3rTexture);h.linkGraphicContext(b);h.setResource(q);f.set(d,h);this._loadTextures.push(h);return h};MO.FE3rTextureConsole_loadBitmap=function(b,d,f){var h=this._bitmaps.get(f);return h?h:this.load(b,d).loadBitmap(f)};
MO.FE3rTrack=function(b){b=MO.Class.inherits(this,b,MO.FObject);b._matrix=MO.Class.register(b,new AGetter("_matrix"));b._resource=MO.Class.register(b,new AGetter("_resource"));b.construct=MO.FE3rTrack_construct;b.loadResource=MO.FE3rTrack_loadResource;b.dispose=MO.FE3rTrack_dispose;return b};MO.FE3rTrack_construct=function(){this.__base.FObject.construct.call(this);this._matrix=new MO.SMatrix3d};
MO.FE3rTrack_loadResource=function(b){this._resource=b;var d=b.frames();null!=d&&(this._frameCount=d.count());this._frameTick=b.frameTick()};MO.FE3rTrack_dispose=function(){this._resource=null;this.__base.FG3dTrack.dispose.call(this)};MO.FE3rVertexBuffer=function(b){b=MO.Class.inherits(this,b,MO.FWglVertexBuffer,MO.MLinkerResource);b.dispose=MO.FE3rVertexBuffer_dispose;return b};MO.FE3rVertexBuffer_dispose=function(){this.__base.MLinkerResource.dispose.call(this);this.__base.FWglVertexBuffer.dispose.call(this)};
MO.FE3dAutomaticEffect=function(b){b=MO.Class.inherits(this,b,MO.FG3dAutomaticEffect);b.drawGroup=MO.FE3dAutomaticEffect_drawGroup;return b};
MO.FE3dAutomaticEffect_drawGroup=function(b,d,f,h){if(1<h){var q=MO.Console.find(MO.FE3rModelConsole).merge(this,b,f,h);if(q){d=this._graphicContext;q=q.meshes();f=q.count();h=b.spaceName();var w=q.first(),z=w.selectInfo(h),A=z.effect;A||(A=z.effect=MO.Console.find(MO.FG3dEffectConsole).find(d,b,w));for(d=1;d<f;d++)w=q.getAt(d),z=w.selectInfo(h),z.effect=A;return A.drawRenderables(b,q,0,f)}}this.drawRenderables(b,d,f,h)};
MO.FE3dControlAutomaticEffect=function(b){b=MO.Class.inherits(this,b,MO.FG3dAutomaticEffect);b._code="control.automatic";b.drawRenderable=MO.FE3dControlAutomaticEffect_drawRenderable;return b};
MO.FE3dControlAutomaticEffect_drawRenderable=function(b,d){var f=this._graphicContext,h=this._program,q=d.currentMatrix(),w=b.calculate(MO.EG3dRegionParameter.CameraViewProjectionMatrix),z=d.material(),A=z.info();this.bindMaterial(z);h.setParameter("vc_model_matrix",q);h.setParameter("vc_vp_matrix",w);h.setParameter4("fc_alpha",A.alphaBase,A.alphaRate,A.alphaLevel,A.alphaMerge);h.setParameter("fc_ambient_color",A.ambientColor);this.bindAttributes(d);this.bindSamplers(d);h=d.indexBuffers().first();
f.drawTriangles(h)};MO.FE3dControlFrameEffect=function(b){b=MO.Class.inherits(this,b,MO.FG3dAutomaticEffect);b._code="control.frame";b.drawRenderable=MO.FE3dControlFrameEffect_drawRenderable;return b};
MO.FE3dControlFrameEffect_drawRenderable=function(b,d){var f=this._graphicContext,h=this._program,q=b.calculate(MO.EG3dRegionParameter.CameraPosition),w=b.calculate(MO.EG3dRegionParameter.LightDirection),z=d.material(),A=z.info();this.bindMaterial(z);h.setParameter("vc_model_matrix",d.currentMatrix());h.setParameter("vc_vp_matrix",b.calculate(MO.EG3dRegionParameter.CameraViewProjectionMatrix));h.setParameter("vc_camera_position",q);h.setParameter("vc_light_direction",w);h.setParameter("fc_camera_position",
q);h.setParameter("fc_light_direction",w);h.setParameter("fc_color",A.ambientColor);h.setParameter4("fc_vertex_color",A.colorMin,A.colorMax,A.colorRate,A.colorMerge);h.setParameter4("fc_alpha",A.alphaBase,A.alphaRate,A.alphaLevel,A.alphaMerge);h.setParameter("fc_ambient_color",A.ambientColor);h.setParameter("fc_diffuse_color",A.diffuseColor);h.setParameter("fc_specular_color",A.specularColor);h.setParameter4("fc_specular",A.specularBase,A.specularLevel,A.specularAverage,A.specularShadow);h.setParameter("fc_specular_view_color",
A.specularViewColor);h.setParameter4("fc_specular_view",A.specularViewBase,A.specularViewRate,A.specularViewAverage,A.specularViewShadow);h.setParameter("fc_reflect_color",A.reflectColor);h.setParameter4("fc_reflect",0,0,1-A.reflectMerge,A.reflectMerge);h.setParameter("fc_emissive_color",A.emissiveColor);this.bindAttributes(d);this.bindSamplers(d);f.drawTriangles(d.indexBuffer())};MO.FE3dControlPass=function(b){b=MO.Class.inherits(this,b,MO.FG3dTechniquePass);b._code="control";return b};
MO.FE3dControlTechnique=function(b){b=MO.Class.inherits(this,b,MO.FG3dTechnique);b._code="control";b._passControl=MO.Class.register(b,new MO.AGetter("_passControl"));b.setup=MO.FE3dControlTechnique_setup;b.drawRegion=MO.FE3dControlTechnique_drawRegion;return b};MO.FE3dControlTechnique_setup=function(){this.__base.FG3dTechnique.setup.call(this);this.registerMode(MO.EG3dTechniqueMode.Result);var b=this._passControl=MO.Class.create(MO.FE3dControlPass);b.linkGraphicContext(this);b.setup();this._passes.push(b)};
MO.FE3dControlTechnique_drawRegion=function(b){b.renderables().isEmpty()||(this._graphicContext.clearDepth(1),this.__base.FG3dTechnique.drawRegion.call(this,b))};MO.FE3dGeneralColorAutomaticEffect=function(b){b=MO.Class.inherits(this,b,MO.FE3dAutomaticEffect);b._code="general.color.automatic";b.buildMaterial=MO.FE3dGeneralColorAutomaticEffect_buildMaterial;b.drawRenderable=MO.FE3dGeneralColorAutomaticEffect_drawRenderable;return b};
MO.FE3dGeneralColorAutomaticEffect_buildMaterial=function(b,d){var f=d.material(),h=b.material;h||(h=b.material=MO.Class.create(MO.FFloatStream),h.setLength(40),f._dirty=!0);if(f._dirty){var q=f.info();h.reset();q.optionAlpha?h.writeFloat4(q.alphaBase,q.alphaRate,0,0):h.writeFloat4(q.alphaBase,1,0,0);h.writeFloat4(q.colorMin,q.colorMax,q.colorBalance,q.colorRate);h.writeColor4(q.vertexColor);h.writeColor4(q.ambientColor);h.writeColor4(q.diffuseColor);h.writeColor4(q.specularColor);h.writeFloat4(q.specularBase,
q.specularLevel,q.specularAverage,q.specularShadow);h.writeColor4(q.reflectColor);h.writeFloat4(0,0,1-q.reflectMerge,q.reflectMerge);h.writeColor4(q.emissiveColor);f._dirty=!1}};
MO.FE3dGeneralColorAutomaticEffect_drawRenderable=function(b,d){var f=this._program,h=b.calculate(MO.EG3dRegionParameter.CameraPosition),q=b.calculate(MO.EG3dRegionParameter.LightDirection),w=b.calculate(MO.EG3dRegionParameter.CameraViewProjectionMatrix),z=d.material();this.bindMaterial(z);if(d._optionMerge){for(var z=d.mergeRenderables(),A=z.count(),B=MO.Lang.TypeArray.findTemp(MO.EDataType.Float32,16*A),C=0;C<A;C++){var D=z.at(C).currentMatrix();D.writeData(B,16*C)}f.setParameter("vc_model_matrix",
B)}else D=d.currentMatrix(),f.setParameter("vc_model_matrix",D);f.setParameter("vc_vp_matrix",w);f.setParameter("vc_camera_position",h);f.setParameter("vc_light_direction",q);f.setParameter("fc_camera_position",h);f.setParameter("fc_light_direction",q);this._supportMaterialMap?f.setParameter4("fc_material",.03125,d._materialId/512,0,0):(h=d.activeInfo(),this.buildMaterial(h,d),f.setParameter("fc_materials",h.material.memory()));this.__base.FE3dAutomaticEffect.drawRenderable.call(this,b,d)};
MO.FE3dGeneralColorFlatEffect=function(b){b=MO.Class.inherits(this,b,MO.FE3dAutomaticEffect);b._code="general.color.flat";b.drawRenderable=MO.FE3dGeneralColorFlatEffect_drawRenderable;return b};
MO.FE3dGeneralColorFlatEffect_drawRenderable=function(b,d){var f=this._graphicContext,h=f.size(),q=f.ratio(),f=f.sizeRatio(),w=h.width*q,z=h.height*q,q=h.width*f.width,A=h.height*f.height,h=this._program,f=d.material();this.bindMaterial(f);if(d._optionMerge){for(var q=d.mergeRenderables(),w=q.count(),z=MO.Lang.TypeArray.findTemp(MO.EDataType.Float32,4*w),B=A=0;B<w;B++){var C=q.at(B),f=C.matrix();z[A++]=f.sx/contextWidth*2;z[A++]=f.sy/contextHeight*2;z[A++]=f.tx/contextWidth*2-1;z[A++]=1-f.ty/contextHeight*
2;C.currentMatrix().writeData(z,4*B)}h.setParameter("vc_position",z)}else f=d.matrix(),d._optionFull?(w=f.sx/q*2,z=f.sy/A*2):(w=f.sx/w*2,z=f.sy/z*2),q=f.tx/q*2-1,f=1-f.ty/A*2,h.setParameter4("vc_position",w,z,q,f);this.__base.FE3dAutomaticEffect.drawRenderable.call(this,b,d)};MO.FE3dGeneralColorPass=function(b){b=MO.Class.inherits(this,b,MO.FG3dTechniquePass);b._code="color";return b};
MO.FE3dGeneralColorSkeletonEffect=function(b){b=MO.Class.inherits(this,b,MO.FE3dAutomaticEffect);b._code="general.color.skeleton";b._supportSkeleton=!0;b.drawRenderable=MO.FE3dGeneralColorSkeletonEffect_drawRenderable;return b};
MO.FE3dGeneralColorSkeletonEffect_drawRenderable=function(b,d){var f=this._program,h=b.calculate(MO.EG3dRegionParameter.CameraPosition),q=b.calculate(MO.EG3dRegionParameter.LightDirection),w=d.material(),z=w.info();this.bindMaterial(w);f.setParameter("vc_model_matrix",d.currentMatrix());f.setParameter("vc_vp_matrix",b.calculate(MO.EG3dRegionParameter.CameraViewProjectionMatrix));f.setParameter("vc_camera_position",h);f.setParameter("vc_light_direction",q);f.setParameter("fc_camera_position",h);f.setParameter("fc_light_direction",
q);f.setParameter("fc_color",z.ambientColor);f.setParameter4("fc_vertex_color",z.colorMin,z.colorMax,z.colorRate,z.colorMerge);f.setParameter4("fc_alpha",z.alphaBase,z.alphaRate,z.alphaLevel,z.alphaMerge);f.setParameter("fc_ambient_color",z.ambientColor);f.setParameter("fc_diffuse_color",z.diffuseColor);f.setParameter("fc_specular_color",z.specularColor);f.setParameter4("fc_specular",z.specularBase,z.specularLevel,z.specularAverage,z.specularShadow);f.setParameter("fc_specular_view_color",z.specularViewColor);
f.setParameter4("fc_specular_view",z.specularViewBase,z.specularViewRate,z.specularViewAverage,z.specularViewShadow);f.setParameter("fc_reflect_color",z.reflectColor);if(h=d.bones()){q=d._boneLimit;w=MO.Lang.TypeArray.findTemp(MO.EDataType.Float32,12*q);for(z=0;z<q;z++)h.at(z).matrix().writeData4x3(w,12*z);f.setParameter("vc_bone_matrix",w)}this.__base.FE3dAutomaticEffect.drawRenderable.call(this,b,d)};
MO.FE3dGeneralTechnique=function(b){b=MO.Class.inherits(this,b,MO.FE3dTechnique);b._code="general";b._passColor=MO.Class.register(b,new MO.AGetter("_passColor"));b.setup=MO.FE3dGeneralTechnique_setup;return b};
MO.FE3dGeneralTechnique_setup=function(){this.__base.FE3dTechnique.setup.call(this);this.registerMode(MO.EG3dTechniqueMode.Ambient);this.registerMode(MO.EG3dTechniqueMode.DiffuseLevel);this.registerMode(MO.EG3dTechniqueMode.DiffuseColor);this.registerMode(MO.EG3dTechniqueMode.SpecularLevel);this.registerMode(MO.EG3dTechniqueMode.SpecularColor);this.registerMode(MO.EG3dTechniqueMode.Result);var b=this._passColor=MO.Class.create(MO.FE3dGeneralColorPass);b.linkGraphicContext(this);b.setup();this._passes.push(b)};
MO.FE3dShadowColorAutomaticEffect=function(b){b=MO.Class.inherits(this,b,MO.FG3dAutomaticEffect);b._code="shadow.color.automatic";b.drawRenderable=MO.FE3dShadowColorAutomaticEffect_drawRenderable;return b};
MO.FE3dShadowColorAutomaticEffect_drawRenderable=function(b,d){var f=this._graphicContext,h=this._program,q=b.calculate(MO.EG3dRegionParameter.CameraPosition),w=b.calculate(MO.EG3dRegionParameter.CameraViewProjectionMatrix),z=b.calculate(MO.EG3dRegionParameter.LightDirection),A=b.calculate(MO.EG3dRegionParameter.LightViewMatrix),B=b.calculate(MO.EG3dRegionParameter.LightViewProjectionMatrix),C=b.calculate(MO.EG3dRegionParameter.LightInfo),D=b.techniquePass(),E=d.material();this.bindMaterial(E);h.setParameter("vc_light_depth",
C);h.setParameter("vc_model_matrix",d.currentMatrix());h.setParameter("vc_vp_matrix",w);h.setParameter("vc_camera_position",q);h.setParameter("vc_light_direction",z);h.setParameter("vc_light_view_matrix",A);h.setParameter("vc_light_vp_matrix",B);h.setParameter("fc_camera_position",q);h.setParameter("fc_light_direction",z);h.setParameter4("fc_light_depth",1/4096,0,-1/4096,C.w);q=E.info();h.setParameter("fc_color",q.ambientColor);h.setParameter4("fc_vertex_color",q.colorMin,q.colorMax,q.colorRate,q.colorMerge);
h.setParameter4("fc_alpha",q.alphaBase,q.alphaRate,q.alphaLevel,q.alphaMerge);h.setParameter("fc_ambient_color",q.ambientColor);h.setParameter("fc_diffuse_color",q.diffuseColor);h.setParameter("fc_specular_color",q.specularColor);h.setParameter4("fc_specular",q.specularBase,q.specularLevel,q.specularAverage,q.specularShadow);h.setParameter("fc_specular_view_color",q.specularViewColor);h.setParameter4("fc_specular_view",q.specularViewBase,q.specularViewRate,q.specularViewAverage,q.specularViewShadow);
h.setParameter("fc_reflect_color",q.reflectColor);this.bindAttributes(d);h.setSampler("fs_light_depth",D.textureDepth());this.bindSamplers(d);f.drawTriangles(d.indexBuffer())};MO.FE3dShadowColorPass=function(b){b=MO.Class.inherits(this,b,MO.FG3dTechniquePass);b._code="color";b._textureDepth=MO.Class.register(b,new MO.AGetSet("_textureDepth"));b.drawRegion=MO.FE3dShadowColorPass_drawRegion;return b};
MO.FE3dShadowColorPass_drawRegion=function(b){var d=this._graphicContext;d.setRenderTarget(null);var f=b._backgroundColor;d.clear(f.red,f.green,f.blue,f.alpha,1);this.__base.FG3dTechniquePass.drawRegion.call(this,b)};MO.FE3dShadowColorSkeletonEffect=function(b){b=MO.Class.inherits(this,b,MO.FG3dAutomaticEffect);b._code="shadow.color.skeleton";b._supportSkeleton=!0;b.drawRenderable=MO.FE3dShadowColorSkeletonEffect_drawRenderable;return b};
MO.FE3dShadowColorSkeletonEffect_drawRenderable=function(b,d){var f=this._graphicContext,h=this._program,q=b.matrixViewProjection(),w=b.cameraPosition(),z=b.lightDirection();if(h.hasAttribute())for(var A=h.attributes(),B=A.count(),C=0;C<B;C++){var D=A.value(C);if(D._statusUsed){var E=d.findVertexBuffer(D._linker);if(null==E)throw new MO.TError("Can't find renderable vertex buffer. (linker={1})",D._linker);h.setAttribute(D._name,E,E._formatCd)}}if(h.hasSampler())for(A=h.samplers(),B=A.count(),C=0;C<
B;C++)if(D=A.value(C),D._statusUsed){var E=D.linker(),F=d.findTexture(E);if(null!=F)h.setSampler(D.name(),F.texture());else throw new MO.TError("Can't find sampler. (linker={1})",E);}h.setParameter("vc_model_matrix",d.currentMatrix());h.setParameter("vc_vp_matrix",q);h.setParameter("vc_camera_position",w);h.setParameter("vc_light_direction",z);h.setParameter("fc_camera_position",w);h.setParameter("fc_light_direction",z);q=d.material();q=q.info();h.setParameter("fc_color",q.ambientColor);h.setParameter4("fc_vertex_color",
q.colorMin,q.colorMax,q.colorRate,q.colorMerge);h.setParameter4("fc_alpha",q.alphaBase,q.alphaRate,q.alphaLevel,q.alphaMerge);h.setParameter("fc_ambient_color",q.ambientColor);h.setParameter("fc_diffuse_color",q.diffuseColor);h.setParameter("fc_specular_color",q.specularColor);h.setParameter4("fc_specular",q.specularBase,q.specularLevel,q.specularAverage,q.specularShadow);h.setParameter("fc_specular_view_color",q.specularViewColor);h.setParameter4("fc_specular_view",q.specularViewBase,q.specularViewRate,
q.specularViewAverage,q.specularViewShadow);h.setParameter("fc_reflect_color",q.reflectColor);if(w=d.bones()){z=w.count();32<z&&(z=32);C=MO.Lang.TypeArray.findTemp(MO.EDataType.Float32,16*z);for(A=0;A<z;A++)q=w.get(A).matrix(),q.writeData(C,16*A);h.setParameter("vc_bone_matrix",C)}h=d.indexBuffer();f.drawTriangles(h,0,h._count)};
MO.FE3dShadowDepthAutomaticEffect=function(b){b=MO.Class.inherits(this,b,MO.FG3dAutomaticEffect);b._code="shadow.depth.automatic";b.drawRenderable=MO.FE3dShadowDepthAutomaticEffect_drawRenderable;return b};
MO.FE3dShadowDepthAutomaticEffect_drawRenderable=function(b,d){var f=this._graphicContext,h=this._program,q=b.calculate(MO.EG3dRegionParameter.LightViewMatrix),w=b.calculate(MO.EG3dRegionParameter.LightViewProjectionMatrix),z=b.calculate(MO.EG3dRegionParameter.LightInfo);f.setBlendFactors(!1);h.setParameter("vc_camera",z);h.setParameter("vc_model_matrix",d.currentMatrix());h.setParameter("vc_view_matrix",q);h.setParameter("vc_vp_matrix",w);h.setParameter("fc_camera",z);h.setParameter4("fc_alpha",
0,0,0,.1);this.bindAttributes(d);this.bindSamplers(d);f.drawTriangles(d.indexBuffer())};MO.FE3dShadowDepthPass=function(b){b=MO.Class.inherits(this,b,MO.FG3dTechniquePass);b._code="depth";b._renderTarget=null;b._textureDepth=MO.Class.register(b,new MO.AGetter("_textureDepth"));b._renderTarget=null;b.setup=MO.FE3dShadowDepthPass_setup;b.drawRegion=MO.FE3dShadowDepthPass_drawRegion;return b};
MO.FE3dShadowDepthPass_setup=function(){this.__base.FG3dTechniquePass.setup.call(this);var b=this._graphicContext,d=this._textureDepth=b.createFlatTexture();d.setFilter(EG3dSamplerFilter.Linear,EG3dSamplerFilter.Linear);d.setWrap(EG3dSamplerFilter.ClampToEdge,EG3dSamplerFilter.ClampToEdge);b=this._renderTarget=b.createRenderTarget();b.size().set(2048,2048);b.textures().push(d);b.build()};
MO.FE3dShadowDepthPass_drawRegion=function(b){var d=this._graphicContext;this._finish?(d.setRenderTarget(null),d=b._backgroundColor,this._context.clear(d.red,d.green,d.blue,d.alpha,1)):(d.setRenderTarget(this._renderTarget),d.clear(0,0,0,1,1,1));b._textureDepth=this._textureDepth;this.__base.FG3dTechniquePass.drawRegion.call(this,b)};
MO.FE3dShadowDepthSkeletonEffect=function(b){b=MO.Class.inherits(this,b,MO.FG3dAutomaticEffect);b._code="shadow.depth.skeleton";b._supportSkeleton=!0;b.drawRenderable=MO.FE3dShadowDepthSkeletonEffect_drawRenderable;return b};
MO.FE3dShadowDepthSkeletonEffect_drawRenderable=function(b,d){var f=this._graphicContext,h=this._program;h.setParameter("vc_model_matrix",r.currentMatrix());h.setParameter("vc_vp_matrix",prvp);h.setParameter("vc_camera_position",prcp);h.setParameter("vc_light_direction",prld);h.setParameter("fc_camera_position",prcp);h.setParameter("fc_light_direction",prld);var q=r.material(),q=q.info();h.setParameter("fc_color",q.ambientColor);h.setParameter4("fc_vertex_color",q.colorMin,q.colorMax,q.colorRate,
q.colorMerge);h.setParameter4("fc_alpha",q.alphaBase,q.alphaRate,q.alphaLevel,q.alphaMerge);h.setParameter("fc_ambient_color",q.ambientColor);h.setParameter("fc_diffuse_color",q.diffuseColor);h.setParameter("fc_specular_color",q.specularColor);h.setParameter4("fc_specular",q.specularBase,q.specularRate,q.specularAverage,q.specularShadow);h.setParameter("fc_specular_view_color",q.specularViewColor);h.setParameter4("fc_specular_view",q.specularViewBase,q.specularViewRate,q.specularViewAverage,q.specularViewShadow);
h.setParameter("fc_reflect_color",q.reflectColor);var w=d.bones();if(w){var z=w.count();32<z&&(z=32);for(var A=MO.Lang.TypeArray.findTemp(MO.EDataType.Float32,16*z),B=0;B<z;B++)q=w.get(B).matrix(),q.writeData(A,16*B);h.setParameter("vc_bone_matrix",A)}this.bindAttributes(d);this.bindSamplers(d);f.drawTriangles(d.indexBuffer())};
MO.FE3dShadowTechnique=function(b){b=MO.Class.inherits(this,b,MO.FE3dTechnique);b._code="shadow";b._passDepth=MO.Class.register(b,new MO.AGetter("_passDepth"));b._passColor=MO.Class.register(b,new MO.AGetter("_passColor"));b.setup=MO.FE3dShadowTechnique_setup;b.updateRegion=MO.FE3dShadowTechnique_updateRegion;return b};
MO.FE3dShadowTechnique_setup=function(){this.__base.FE3dTechnique.setup.call(this);this.registerMode(MO.EG3dTechniqueMode.Ambient);this.registerMode(MO.EG3dTechniqueMode.DiffuseLevel);this.registerMode(MO.EG3dTechniqueMode.DiffuseColor);this.registerMode(MO.EG3dTechniqueMode.SpecularLevel);this.registerMode(MO.EG3dTechniqueMode.SpecularColor);this.registerMode(MO.EG3dTechniqueMode.Result);var b=this._passes,d=this._passDepth=MO.Class.create(MO.FE3dShadowDepthPass);d.linkGraphicContext(this);d.setup();
var f=this._passColor=MO.Class.create(MO.FE3dShadowColorPass);f.linkGraphicContext(this);f.setup();b.push(f);f.setTextureDepth(d.textureDepth())};MO.FE3dShadowTechnique_updateRegion=function(b){this.__base.FE3dTechnique.updateRegion.call(this,b);this._graphicContext.size();b.camera();b.directionalLight().camera()};
MO.EE3dInstance=new function(){this.ModelRenderable="model.renderable";this.TemplateRenderable="template.renderable";this.Scene="scene";this.SceneLayer="scene.layer";this.SceneDisplay="scene.display";this.SceneMaterial="scene.material";this.SceneMovie="scene.movie";this.SceneRenderable="scene.renderable";return this};MO.FE3dAnimation=function(b){return b=MO.Class.inherits(this,b,MO.FObject,MO.ME3dObject,MO.MLinkerResource)};
MO.FE3dCamera=function(b){b=MO.Class.inherits(this,b,MO.FG3dCamera,MO.MLinkerResource);b._projection=MO.Class.register(b,new MO.AGetter("_projection"));b._rotation=MO.Class.register(b,new MO.AGetter("_rotation"));b._rotationMatrix=null;b._quaternion=null;b._quaternionX=null;b._quaternionY=null;b._quaternionZ=null;b.construct=MO.FE3dCamera_construct;b.doMoveX=MO.FE3dCamera_doMoveX;b.doMoveY=MO.FE3dCamera_doMoveY;b.doMoveZ=MO.FE3dCamera_doMoveZ;b.doForward=MO.FE3dCamera_doForward;b.doPitch=MO.FE3dCamera_doPitch;
b.doYaw=MO.FE3dCamera_doYaw;b.doRoll=MO.FE3dCamera_doRoll;b.loadResource=MO.FE3dCamera_loadResource;b.commitResource=MO.FE3dCamera_commitResource;b.update=MO.FE3dCamera_update;return b};MO.FE3dCamera_construct=function(){this.__base.FG3dCamera.construct.call(this);this._rotation=new MO.SVector3;this._rotationMatrix=new MO.SMatrix3x3;this._quaternion=new MO.SQuaternion;this._quaternionX=new MO.SQuaternion;this._quaternionY=new MO.SQuaternion;this._quaternionZ=new MO.SQuaternion};
MO.FE3dCamera_doMoveX=function(b){this._position.x+=b};MO.FE3dCamera_doMoveY=function(b){this._position.y+=b};MO.FE3dCamera_doMoveZ=function(b){this._position.z+=b};MO.FE3dCamera_doForward=function(b){this._position.x+=this._direction.x*b;this._position.y+=this._direction.y*b;this._position.z+=this._direction.z*b};MO.FE3dCamera_doPitch=function(b){this._rotation.x+=b};MO.FE3dCamera_doYaw=function(b){this._rotation.y+=b};MO.FE3dCamera_doRoll=function(b){this._rotation.z+=b};
MO.FE3dCamera_loadResource=function(b){var d=b.projection();this._resource=b;this.position().assign(b.position());this.setDirection(b.direction().x,b.direction().y,b.direction().z);this.update();b=this.projection();b._angle=d.angle();b._znear=d.znear();b._zfar=d.zfar();b.update()};MO.FE3dCamera_commitResource=function(){var b=this._resource;b._position.assign(this._position);b._direction.assign(this._direction)};
MO.FE3dCamera_update=function(){var b=this._rotation;this._quaternionX.fromAxisAngle(MO.Lang.Math.vectorAxisX,b.x);this._quaternionY.fromAxisAngle(MO.Lang.Math.vectorAxisY,b.y);this._quaternionZ.fromAxisAngle(MO.Lang.Math.vectorAxisZ,b.z);var d=this._quaternion.identity();d.mul(this._quaternionX);d.mul(this._quaternionY);d.mul(this._quaternionZ);b=this._rotationMatrix;b.build(d);d=this._direction;b.transformPoint3(this._directionTarget,d);d.normalize();this.__base.FG3dCamera.update.call(this)};
MO.FG3dCamera_dispose=function(){this._projection=MO.Lang.Obejct.dispose(this._projection);this.__base.FObject.dispose.call(this)};MO.FE3dDirectionalLight=function(b){b=MO.Class.inherits(this,b,MO.FG3dDirectionalLight,MO.MLinkerResource);b._material=MO.Class.register(b,new MO.AGetter("_material"));b.construct=MO.FE3dDirectionalLight_construct;b.loadResource=MO.FE3dDirectionalLight_loadResource;b.dispose=MO.FE3dDirectionalLight_dispose;return b};
MO.FE3dDirectionalLight_construct=function(){this.__base.FG3dDirectionalLight.construct.call(this);this._material=MO.Class.create(MO.FE3dMaterial)};MO.FE3dDirectionalLight_loadResource=function(b){this.__base.MLinkerResource.loadResource.call(this,b);this._material.loadResource(b.material())};MO.FE3dDirectionalLight_dispose=function(){this._material=MO.Lang.Object.dispose(this._material);this.__base.FG3dDirectionalLight.dispose.call(this)};
MO.FE3dFlatStage=function(b){b=MO.Class.inherits(this,b,MO.FE3dStage);b._layer=MO.Class.register(b,new MO.AGetter("_layer"));b.construct=MO.FE3dFlatStage_construct;return b};MO.FE3dFlatStage_construct=function(){this.__base.FE3dStage.construct.call(this);var b=this._layer=MO.Class.create(MO.FDisplayLayer);this.registerLayer("Layer",b)};
MO.FE3dInstanceConsole=function(b){b=MO.Class.inherits(this,b,MO.FConsole);b._scopeCd=MO.EScope.Local;b._factory=MO.Class.register(b,new MO.AGetter("_factory"));b.construct=MO.FE3dInstanceConsole_construct;b.register=MO.FE3dInstanceConsole_register;b.unregister=MO.FE3dInstanceConsole_unregister;b.create=MO.FE3dInstanceConsole_create;return b};
MO.FE3dInstanceConsole_construct=function(){var b=this._factory=MO.Class.create(MO.FClassFactory);b.register(MO.EE3dInstance.ModelRenderable,MO.FE3dModelRenderable);b.register(MO.EE3dInstance.TemplateRenderable,MO.FE3dTemplateRenderable);b.register(MO.EE3dInstance.Scene,MO.FE3dScene);b.register(MO.EE3dInstance.SceneLayer,MO.FE3dSceneLayer);b.register(MO.EE3dInstance.SceneDisplay,MO.FE3dSceneDisplay);b.register(MO.EE3dInstance.SceneMaterial,MO.FE3dSceneMaterial);b.register(MO.EE3dInstance.SceneMovie,
MO.FE3dMovie);b.register(MO.EE3dInstance.SceneRenderable,MO.FE3dSceneDisplayRenderable)};MO.FE3dInstanceConsole_register=function(b,d){this._factory.register(b,d)};MO.FE3dInstanceConsole_unregister=function(b){this._factory.unregister(b,clazz)};MO.FE3dInstanceConsole_create=function(b){return this._factory.create(b)};MO.FE3dMaterial=function(b){b=MO.Class.inherits(this,b,MO.FE3rMaterial);b._parent=null;b.loadParent=MO.FE3dRenderable_loadParent;return b};
MO.FE3dRenderable_loadParent=function(b){this._parent=b};MO.FE3dMesh=function(b){b=MO.Class.inherits(this,b,MO.FE3dSpace,MO.MLinkerResource,MO.MListenerLoad);b._ready=!1;b._display=null;b._renderable=null;b._layer=null;b.construct=MO.FE3dMesh_construct;b.testReady=MO.FE3dMesh_testReady;b.loadRenderable=MO.FE3dMesh_loadRenderable;b.processLoad=MO.FE3dMesh_processLoad;b.process=MO.FE3dMesh_process;return b};
MO.FE3dMesh_construct=function(){this.__base.FE3dSpace.construct.call(this);var b=this._layer=MO.Class.create(MO.FDisplayLayer);this.registerLayer("Layer",b)};MO.FE3dMesh_testReady=function(){return this._ready};
MO.FE3dMesh_loadRenderable=function(b){var d=b.resource();this.selectTechnique(this,FE3dGeneralTechnique).setResource(d.technique());this.loadResource(d);var f=MO.Class.create(MO.FE3dMeshRenderable);f.setResource(d._renderable);f._material.loadResource(d._display._material);f._renderable=b;for(var h=b._vertexBuffers,q=h.count(),w=0;w<q;w++){var z=h.getAt(w);f._vertexBuffers.set(z._name,z)}f._indexBuffer=b._indexBuffer;f.matrix().assign(f.resource().matrix());b=this._display=MO.Class.create(MO.FE3dMeshDisplay);
b._renderable=f;b.load(d._display);b.pushRenderable(f);this._layer.pushDisplay(b);this._ready=!0;this.processLoadListener(this)};MO.FE3dMesh_processLoad=function(){if(!this._renderable.testReady())return!1;this.loadRenderable(this._renderable);return!0};MO.FE3dMesh_process=function(){this.__base.FE3dSpace.process.call(this)};
MO.FE3dMeshConsole=function(b){b=MO.Class.inherits(this,b,MO.FConsole);b._scopeCd=MO.EScope.Local;b._loadMeshs=null;b._meshs=MO.Class.register(b,new MO.AGetter("_meshs"));b._thread=null;b._interval=100;b.onProcess=MO.FE3dMeshConsole_onProcess;b.construct=MO.FE3dMeshConsole_construct;b.meshs=MO.FE3dMeshConsole_meshs;b.allocByGuid=MO.FE3dMeshConsole_allocByGuid;b.allocByCode=MO.FE3dMeshConsole_allocByCode;b.free=MO.FE3dMeshConsole_free;return b};
MO.FE3dMeshConsole_onProcess=function(){var b=this._loadMeshs;for(b.record();b.next();)b.current().processLoad()&&b.removeCurrent()};MO.FE3dMeshConsole_construct=function(){this._loadMeshs=new MO.TLooper;this._meshs=new MO.TDictionary;var b=this._thread=MO.Class.create(MO.FThread);b.setInterval(this._interval);b.addProcessListener(this,this.onProcess);MO.Console.find(MO.FThreadConsole).start(b)};MO.FE3dMeshConsole_meshs=function(){return this._meshs};
MO.FE3dMeshConsole_allocByGuid=function(b,d){var f=this._meshs.get(d);if(f&&!f.isEmpty())return f.pop();var f=MO.Console.find(MO.FE3rMeshConsole).loadByGuid(b,d),h=MO.Class.create(MO.FE3dMesh);h.linkGraphicContext(b);h._name=d;h._renderable=f;this._loadMeshs.push(h);return h};
MO.FE3dMeshConsole_allocByCode=function(b,d){var f=this._meshs.get(d);if(f&&!f.isEmpty())return f.pop();var f=MO.Console.find(MO.FE3rMeshConsole).loadByCode(b,d),h=MO.Class.create(MO.FE3dMesh);h.linkGraphicContext(b);h._name=d;h._renderable=f;this._loadMeshs.push(h);return h};MO.FE3dMeshConsole_free=function(b){b._display.remove()};
MO.FE3dMeshDisplay=function(b){b=MO.Class.inherits(this,b,MO.FE3dDisplay,MO.MLinkerResource);b._material=MO.Class.register(b,new MO.AGetter("_material"));b._renderable=MO.Class.register(b,new MO.AGetter("_renderable"));b.load=MO.FE3dMeshDisplay_load;b.reloadResource=MO.FE3dMeshDisplay_reloadResource;return b};MO.FE3dMeshDisplay_load=function(b){this._resource=b;this._matrix.assign(b.matrix())};MO.FE3dMeshDisplay_reloadResource=function(){this._matrix.assign(this._resource.matrix())};
MO.FE3dMeshRenderable=function(b){b=MO.Class.inherits(this,b,MO.FE3dRenderable);b._renderable=MO.Class.register(b,MO.AGetSet("_renderable"));b._activeTrack=null;b.vertexCount=MO.FE3dMeshRenderable_vertexCount;b.findVertexBuffer=MO.FE3dMeshRenderable_findVertexBuffer;b.vertexBuffers=MO.FE3dMeshRenderable_vertexBuffers;b.indexBuffers=MO.FE3dMeshRenderable_indexBuffers;b.findTexture=MO.FE3dMeshRenderable_findTexture;b.textures=MO.FE3dMeshRenderable_textures;b.reloadResource=MO.FE3dMeshRenderable_reloadResource;
b.process=MO.FE3dMeshRenderable_process;b.processDelay=MO.FE3dMeshRenderable_processDelay;b.update=MO.FE3dMeshRenderable_update;b.dispose=MO.FE3dMeshRenderable_dispose;return b};MO.FE3dMeshRenderable_vertexCount=function(){return this._renderable.vertexCount()};MO.FE3dMeshRenderable_findVertexBuffer=function(b){var d=this._vertexBuffers.get(b);return d?d:this._renderable.findVertexBuffer(b)};MO.FE3dMeshRenderable_vertexBuffers=function(){return this._renderable.vertexBuffers()};
MO.FE3dMeshRenderable_indexBuffers=function(){return this._renderable.indexBuffers()};MO.FE3dMeshRenderable_findTexture=function(b){return(b=this._textures.get(b))?b:this._renderable.findTexture(p)};MO.FE3dMeshRenderable_textures=function(){var b=this._textures;return b?b:this._renderable.textures()};MO.FE3dMeshRenderable_reloadResource=function(){this._matrix.assign(this._resource.matrix())};
MO.FE3dMeshRenderable_process=function(b){this.__base.FE3dRenderable.process.call(this,b);if((b=this._activeTrack)&&this._display._optionPlay){var d=b._animation;d&&d.process(b)}};MO.FE3dMeshRenderable_processDelay=function(b){this.__base.FE3dRenderable.processDelay.call(this,b)};
MO.FE3dMeshRenderable_update=function(b){var d=this._display,f=this._matrix,h=this._activeTrack,q=this._calculateMatrix;h?(q.assign(h.matrix()),q.append(f)):q.assign(f);d&&(d=this._display.currentMatrix(),q.append(d));this._currentMatrix.attachData(q.data())&&b.change()};MO.FE3dMeshRenderable_dispose=function(){this._modelMatrix=MO.Lang.Object.dispose(this._modelMatrix);this._vertexBuffers=MO.Lang.Object.dispose(this._vertexBuffers);this.__base.FE3dRenderable.dispose.call(this)};
MO.FE3dModel=function(b){b=MO.Class.inherits(this,b,MO.FE3dSpace,MO.MPoolAble,MO.MLinkerResource,MO.MListenerLoad);b._dataReady=!1;b._display=MO.Class.register(b,new MO.AGetter("_display"));b._renderable=MO.Class.register(b,new MO.AGetSet("_renderable"));b.construct=MO.FE3dModel_construct;b.testReady=MO.FE3dModel_testReady;b.loadRenderable=MO.FE3dModel_loadRenderable;b.processLoad=MO.FE3dModel_processLoad;return b};
MO.FE3dModel_construct=function(){this.__base.FE3dSpace.construct.call(this);var b=this._layer=MO.Class.create(MO.FDisplayLayer);this.registerLayer("sprite",b);var d=this._display=MO.Class.create(MO.FE3dModelDisplay);b.pushDisplay(d)};MO.FE3dModel_testReady=function(){return this._dataReady};MO.FE3dModel_loadRenderable=function(b){this._renderable=b;var d=b.resource();this.selectTechnique(this,FE3dGeneralTechnique);this.loadResource(d);this._display.load(b);this._dataReady=!0};
MO.FE3dModel_processLoad=function(){if(this._dataReady)return!0;var b=this._renderable;if(!b.testReady())return!1;this.loadRenderable(b);this.processLoadListener(this);return!0};
MO.FE3dModelConsole=function(b){b=MO.Class.inherits(this,b,MO.FConsole);b._scopeCd=MO.EScope.Local;b._looper=null;b._pools=MO.Class.register(b,new MO.AGetter("_pools"));b._thread=null;b._interval=100;b.onProcess=MO.FE3dModelConsole_onProcess;b.construct=MO.FE3dModelConsole_construct;b.pools=MO.FE3dModelConsole_pools;b.allocByGuid=MO.FE3dModelConsole_allocByGuid;b.allocByCode=MO.FE3dModelConsole_allocByCode;b.free=MO.FE3dModelConsole_free;return b};
MO.FE3dModelConsole_onProcess=function(){var b=this._looper;for(b.record();b.next();)b.current().processLoad()&&b.removeCurrent()};MO.FE3dModelConsole_construct=function(){this._looper=new MO.TLooper;this._pools=MO.Class.create(MO.FObjectPools);var b=this._thread=MO.Class.create(MO.FThread);b.setInterval(this._interval);b.addProcessListener(this,this.onProcess);MO.Console.find(MO.FThreadConsole).start(b)};
MO.FE3dModelConsole_allocByGuid=function(b,d){var f=this._pools.alloc(d);if(f)return f;var h=MO.Console.find(MO.FE3rModelConsole).load(b,d),f=MO.Class.create(MO.FE3dModel);f.linkGraphicContext(b);f.setPoolCode(d);f.setRenderable(h);this._looper.push(f);return f};MO.FE3dModelConsole_allocByCode=function(b,d){return this._pools.alloc(d)};MO.FE3dModelConsole_free=function(b){var d=b.poolCode();this._pools.free(d,b)};
MO.FE3dModelDisplay=function(b){b=MO.Class.inherits(this,b,MO.FE3dDisplay,MO.MLinkerResource);b._material=MO.Class.register(b,new MO.AGetter("_material"));b._shapes=MO.Class.register(b,new MO.AGetter("_shapes"));b.construct=MO.FE3dModelDisplay_construct;b.load=MO.FE3dModelDisplay_load;b.reloadResource=MO.FE3dModelDisplay_reloadResource;b.dispose=MO.FE3dModelDisplay_dispose;return b};MO.FE3dModelDisplay_construct=function(){this.__base.FE3dDisplay.construct.call(this);this._material=RClass.create(FE3dMaterial)};
MO.FE3dModelDisplay_load=function(b){var d=this._material,f=RConsole.find(FE3dInstanceConsole),h=this._resource=b.resource().display();this._matrix.assign(h.matrix());d.loadResource(h.material());if(b=b.geometrys())for(var h=b.count(),q=this._shapes=new MO.TObjects,w=0;w<h;w++){var z=b.get(w),A=f.create(MO.EE3dInstance.ModelRenderable);A.setDisplay(this);A.setMaterial(d);A.load(z);q.push(A);this.pushRenderable(A)}};
MO.FE3dModelDisplay_reloadResource=function(){var b=this._resource;this._matrix.assign(b.matrix());this._material.loadResource(b.material())};MO.FE3dModelDisplay_dispose=function(){this._material=MO.Lang.Object.dispose(this._material);this.__base.FE3dDisplay.dispose.call(this)};MO.FE3dModelRenderable=function(b){b=MO.Class.inherits(this,b,MO.FE3dMeshRenderable);b._ready=!1;b._materialResource=null;b.testVisible=MO.FE3dModelRenderable_testVisible;b.load=MO.FE3dModelRenderable_load;return b};
MO.FE3dModelRenderable_testVisible=function(b){!this._ready&&(b=this._renderable)&&(this._ready=b.testReady());return this._ready};MO.FE3dModelRenderable_load=function(b){var d=this._material,f=this._materialResource=b.material();f&&d.assignInfo(f.info());this._effectCode=d.info().effectCode;this._renderable=b};
MO.FE3dMovie=function(b){b=MO.Class.inherits(this,b,MO.FObject,MO.MLinkerResource);b._interval=null;b._firstTick=0;b._lastTick=0;b._matrix=null;b.construct=MO.FE3dMovie_construct;b.loadResource=MO.FE3dMovie_loadResource;b.reloadResource=MO.FE3dMovie_reloadResource;b.process=MO.FE3dMovie_process;return b};MO.FE3dMovie_construct=function(){this.__base.FObject.construct.call(this);this._matrix=new MO.SMatrix3d};
MO.FE3dMovie_loadResource=function(b){this._resource=b;this._interval=b._interval;this._matrix.setRotation(b._rotation.x,b._rotation.y*Math.PI/180,b._rotation.z);this._matrix.update()};MO.FE3dMovie_reloadResource=function(){this.loadResource(this._resource)};
MO.FE3dMovie_process=function(b){0==this._firstTick&&(this._firstTick=MO.Timer.current());0==this._lastTick&&(this._lastTick=MO.Timer.current());var d=RTimer.current(),f=d-this._lastTick;if(f>this._interval){var h=this._resource,f=f/1E3;"rotation"==this._resource.code()&&(b.ry+=h._rotation.y*f,b.updateForce());this._lastTick=d}};
MO.FE3dOrthoCamera=function(b){b=MO.Class.inherits(this,b,MO.FE3dCamera);b.construct=MO.FE3dOrthoCamera_construct;b.updateFrustum=MO.FE3dOrthoCamera_updateFrustum;b.updateFromCamera=MO.FE3dOrthoCamera_updateFromCamera;b.updateFlatCamera=MO.FE3dOrthoCamera_updateFlatCamera;return b};MO.FE3dOrthoCamera_construct=function(){this.__base.FE3dCamera.construct.call(this);this._projection=MO.Class.create(MO.FG3dOrthoProjection)};
MO.FE3dOrthoCamera_updateFrustum=function(){this.__base.FE3dCamera.updateFrustum.call(this);var b=this._projection,d=b._size,f=this._frustum;f.update(b._angle,d.width,d.height,b._znear,b._zfar,this._centerFront,this._centerBack,this._matrix);return f};
MO.FE3dOrthoCamera_updateFromCamera=function(b){b=b.updateFrustum();var d=this._direction;d.normalize();this._position.set(b.center.x-d.x*b.radius,b.center.y-d.y*b.radius,b.center.z-d.z*b.radius);this.lookAt(b.center.x,b.center.y,b.center.z);this.update();d=this._frustum;this._matrix.transform(d.coners,b.coners,8);d.updateCenter();this._projection.updateFrustum(d)};
MO.FE3dOrthoCamera_updateFlatCamera=function(b){var d=b.updateFlatFrustum(),f=MO.RConst.DEGREE_RATE*this._projection.angle(),f=d.radius/Math.sin(.5*f),f=Math.max(f,b._projection._zfar);b=this._direction;b.normalize();this._position.set(d.center.x-b.x*f,d.center.y-b.y*f,d.center.z-b.z*f);this.lookAt(d.center.x,d.center.y,d.center.z);this.update();this._projection._znear=.3;this._projection._zfar=1.5*f;this._projection.update()};
MO.FE3dPerspectiveCamera=function(b){b=MO.Class.inherits(this,b,MO.FE3dCamera,MO.MLinkerResource);b._centerFront=.4;b.construct=MO.FE3dPerspectiveCamera_construct;b.updateFrustum=MO.FE3dPerspectiveCamera_updateFrustum;b.updateFlatFrustum=MO.FE3dPerspectiveCamera_updateFlatFrustum;b.updateFromCamera=MO.FE3dPerspectiveCamera_updateFromCamera;b.updateFlatCamera=MO.FE3dPerspectiveCamera_updateFlatCamera;return b};
MO.FE3dPerspectiveCamera_construct=function(){this.__base.FE3dCamera.construct.call(this);this._projection=MO.Class.create(MO.FG3dPerspectiveProjection);this._rotation=new MO.SVector3;this._rotationMatrix=new MO.SMatrix3x3;this._quaternion=new MO.SQuaternion;this._quaternionX=new MO.SQuaternion;this._quaternionY=new MO.SQuaternion;this._quaternionZ=new MO.SQuaternion};
MO.FE3dPerspectiveCamera_updateFrustum=function(){this.__base.FE3dCamera.updateFrustum.call(this);var b=this._projection,d=b._size,f=this._frustum;f.update(b._angle,d.width,d.height,b._znear,b._zfar,this._centerFront,this._centerBack,this._matrix);return f};MO.FE3dPerspectiveCamera_updateFlatFrustum=function(){var b=this._projection,d=b._size,f=this._frustum;f.updateFlat(b._angle,d.width,d.height,b._znear,b._zfar,this._centerFront,this._centerBack,this._matrix);return f};
MO.FE3dPerspectiveCamera_updateFromCamera=function(b){var d=this._frustum,f=b.updateFrustum(),h=MO.RConst.DEGREE_RATE*this._projection.angle(),h=f.radius/Math.sin(.5*h),h=Math.max(h,b._projection._zfar);b=this._direction;b.normalize();this._position.set(f.center.x-b.x*h,f.center.y-b.y*h,f.center.z-b.z*h);this.lookAt(f.center.x,f.center.y,f.center.z);this.update();this._matrix.transform(d.coners,0,f.coners,0,8);d.updateCenter();this._projection.updateFrustum(d)};
MO.FE3dPerspectiveCamera_updateFlatCamera=function(b){var d=b.updateFlatFrustum(),f=MO.RConst.DEGREE_RATE*this._projection.angle(),f=d.radius/Math.sin(.5*f),f=Math.max(f,b._projection._zfar);b=this._direction;b.normalize();this._position.set(d.center.x-b.x*f*this._centerFront,d.center.y-b.y*f*this._centerFront,d.center.z-b.z*f*this._centerFront);this.lookAt(d.center.x,d.center.y,d.center.z);this.update();this._projection._znear=.1;this._projection._zfar=f;this._projection.update()};
MO.FE3dRegion=function(b){b=MO.Class.inherits(this,b,MO.FRegion,MO.MGraphicObject,MO.MG3dRegion,MO.MLinkerResource);b._backgroundColor=MO.Class.register(b,new MO.AGetter("_backgroundColor"));b.construct=MO.FE3dRegion_construct;b.selectCamera=MO.FE3dRegion_selectCamera;b.loadResource=MO.FE3dRegion_loadResource;b.reloadResource=MO.FE3dRegion_reloadResource;b.prepare=MO.FE3dRegion_prepare;b.dispose=MO.FE3dRegion_dispose;return b};
MO.FE3dRegion_construct=function(){this.__base.FRegion.construct.call(this);this.__base.MG3dRegion.construct.call(this);var b=this._camera=MO.Class.create(MO.FE3dPerspectiveCamera);b.position().set(0,0,-100);b.lookAt(0,0,0);b.update();b.projection().update();b=this._directionalLight=MO.Class.create(MO.FE3dDirectionalLight);b.direction().set(0,-1,0);b=b.camera();b.position().set(10,10,-10);b.lookAt(0,0,0);(this._backgroundColor=new MO.SColor4).set(0,0,0,1);this._calculateCameraMatrix=new MO.SMatrix3d};
MO.FE3dRegion_selectCamera=function(b){this._camera=b};MO.FE3dRegion_loadResource=function(b){this._resource=b;this._camera.loadResource(b.camera());this._directionalLight.loadResource(b.light());this.reloadResource()};MO.FE3dRegion_reloadResource=function(){var b=this._resource;b.optionBackground()?(this._backgroundColor.assignPower(b.backgroundColor()),this._backgroundColor.alpha=1):this._backgroundColor.set(0,0,0,0)};
MO.FE3dRegion_prepare=function(){this.__base.MG3dRegion.prepare.call(this);this._calculateCameraMatrix.attach(this._camera.matrix())&&(this._changed=!0)};MO.FE3dRegion_dispose=function(){this.__base.FRegion.dispose.call(this);this.__base.MG3dRegion.dispose.call(this)};
MO.FE3dScene=function(b){b=MO.Class.inherits(this,b,MO.FE3dSpace,MO.MLinkerResource,MO.MListenerLoad);b._ready=!1;b._dataReady=!1;b._resource=MO.Class.register(b,new MO.AGetter("_resource"));b._dirty=!1;b.onProcess=MO.FE3dScene_onProcess;b.construct=MO.FE3dScene_construct;b.createRegion=MO.FE3dScene_createRegion;b.loadTechniqueResource=MO.FE3dScene_loadTechniqueResource;b.loadRegionResource=MO.FE3dScene_loadRegionResource;b.loadDisplayResource=MO.FE3dScene_loadDisplayResource;b.loadLayerResource=
MO.FE3dScene_loadLayerResource;b.loadResource=MO.FE3dScene_loadResource;b.testReady=MO.FE3dScene_testReady;b.dirty=MO.FE3dScene_dirty;b.processLoad=MO.FE3dScene_processLoad;b.active=MO.FE3dScene_active;b.deactive=MO.FE3dScene_deactive;return b};MO.FE3dScene_onProcess=function(){this.__base.FE3dSpace.onProcess.call(this);if(this._dirty){for(var b=this._region.allRenderables(),d=b.count()-1;0<=d;d--)b.getAt(d).resetInfos();this._dirty=!1}};MO.FE3dScene_construct=function(){this.__base.FE3dSpace.construct.call(this)};
MO.FE3dScene_createRegion=function(){return MO.Class.create(MO.FE3dSceneRegion)};MO.FE3dScene_loadTechniqueResource=function(b){this._technique._resource=b};
MO.FE3dScene_loadRegionResource=function(b){this._region.loadResource(b);var d=b.camera(),f=d.projection(),h=this.camera();h._resource=d;var q=h.projection();h.position().assign(d.position());h.setDirection(d.direction().x,d.direction().y,d.direction().z);h.update();q.size().assign(this._graphicContext.size());q._angle=f.angle();q._znear=f.znear();q._zfar=f.zfar();q.update();f=b.light();b=f.camera();d=b.projection();h=this.directionalLight();h._resource=f;f=h._camera;h=f._projection;f.position().set(1,
1,-1);f.lookAt(0,0,0);f.position().assign(b.position());f.update();h.size().set(1024,1024);h._angle=60;h._znear=d.znear();h._zfar=d.zfar();h.update()};MO.FE3dScene_loadDisplayResource=function(b,d){var f=MO.Console.find(MO.FE3dInstanceConsole).create(MO.EE3dInstance.SceneDisplay);f.linkGraphicContext(this);f.loadResource(d);MO.Console.find(MO.FE3dSceneConsole).loadDisplay(f);b.pushDisplay(f)};
MO.FE3dScene_loadLayerResource=function(b){var d=MO.Console.find(MO.FE3dInstanceConsole).create(MO.EE3dInstance.SceneLayer);d.loadResource(b);var f=b.displays();if(f)for(var h=f.count(),q=0;q<h;q++){var w=f.at(q);this.loadDisplayResource(d,w)}this.registerLayer(b.code(),d)};
MO.FE3dScene_loadResource=function(b){this.selectTechnique(this,MO.FE3dGeneralTechnique);this.loadTechniqueResource(b.technique());this.loadRegionResource(b.region());if(b=b.layers())for(var d=b.count(),f=0;f<d;f++){var h=b.at(f);this.loadLayerResource(h)}};MO.FE3dScene_testReady=function(){return this._ready};MO.FE3dScene_dirty=function(){this._dirty=!0};
MO.FE3dScene_processLoad=function(){if(this._dataReady)return!0;if(!this._resource.testReady())return!1;this.loadResource(this._resource);this._ready=!0;this.processLoadListener(this);return!0};MO.FE3dScene_active=function(){this.__base.FE3dSpace.active.call(this)};MO.FE3dScene_deactive=function(){this.__base.FE3dSpace.deactive.call(this)};
MO.FE3dSceneAnimation=function(b){b=MO.Class.inherits(this,b,MO.FE3dAnimation);b._animation=null;b._activeClip=null;b._clips=null;b.clips=MO.FE3dSceneAnimation_clips;b.pushClip=MO.FE3dSceneAnimation_pushClip;b.record=MO.Method.empty;b.process=MO.Method.empty;b.selectClip=MO.FE3dSceneAnimation_selectClip;b.loadAnimation=MO.FE3dSceneAnimation_loadAnimation;b.loadSceneResource=MO.FE3dSceneAnimation_loadSceneResource;b.reloadResource=MO.FE3dSceneAnimation_reloadResource;return b};
MO.FE3dSceneAnimation_clips=function(){return this._clips};MO.FE3dSceneAnimation_pushClip=function(b){var d=this._clips;d||(d=this._clips=new MO.TDictionary);d.set(b.code(),b)};MO.FE3dSceneAnimation_selectClip=function(b){b=this._clips.get(b);if(this._activeClip!=b){var d=this._animation._playInfo;d.beginIndex=b.beginIndex();d.endIndex=b.endIndex();d.frameCount=d.endIndex-d.beginIndex+1;this._animation._playRate=b.playRate();this._activeClip=b}};
MO.FE3dSceneAnimation_loadAnimation=function(b){this._animation=b};MO.FE3dSceneAnimation_loadSceneResource=function(b){this._resource=b};MO.FE3dSceneAnimation_reloadResource=function(){this._animation._playRate=this._resource._playRate};
MO.FE3dSceneAnimationClip=function(b){b=MO.Class.inherits(this,b,MO.FObject,MO.MAttributeCode);b._animation=null;b._beginIndex=MO.Class.register(b,new MO.AGetSet("_beginIndex"),0);b._endIndex=MO.Class.register(b,new MO.AGetSet("_endIndex"),0);b._playRate=MO.Class.register(b,new MO.AGetSet("_playRate"),1);b.setRange=MO.FE3dSceneAnimationClip_setRange;return b};MO.FE3dSceneAnimationClip_setRange=function(b,d){this._beginIndex=b;this._endIndex=d};
MO.FE3dSceneCanvas=function(b){b=MO.Class.inherits(this,b,MO.FE3dCanvas);b._activeSpace=null;b._captureStatus=!1;b._capturePosition=null;b._captureCameraPosition=null;b._captureCameraRotation=null;b._actionFullScreen=!1;b._actionPlay=!1;b._actionMovie=!1;b._actionUp=!1;b._actionDown=!1;b._actionForward=!1;b._actionBack=!1;b._cameraMoveRate=.4;b._cameraKeyRotation=.03;b._cameraMouseRotation=.005;b._touchTracker=null;b.onEnterFrame=MO.FE3dSceneCanvas_onEnterFrame;b.onMouseCaptureStart=MO.FE3dSceneCanvas_onMouseCaptureStart;
b.onMouseCapture=MO.FE3dSceneCanvas_onMouseCapture;b.onMouseCaptureStop=MO.FE3dSceneCanvas_onMouseCaptureStop;b.onTouchStart=MO.FE3dSceneCanvas_onTouchStart;b.onTouchMove=MO.FE3dSceneCanvas_onTouchMove;b.onTouchStop=MO.FE3dSceneCanvas_onTouchStop;b.onTouchZoom=MO.FE3dSceneCanvas_onTouchZoom;b.onDataLoaded=MO.FE3dSceneCanvas_onDataLoaded;b.onResize=MO.FE3dSceneCanvas_onResize;b.construct=MO.FE3dSceneCanvas_construct;b.testPlay=MO.FE3dSceneCanvas_testPlay;b.switchPlay=MO.FE3dSceneCanvas_switchPlay;
b.testMovie=MO.FE3dSceneCanvas_testMovie;b.switchMovie=MO.FE3dSceneCanvas_switchMovie;b.doAction=MO.FE3dSceneCanvas_doAction;b.loadByGuid=MO.FE3dSceneCanvas_loadByGuid;b.loadByCode=MO.FE3dSceneCanvas_loadByCode;b.dispose=MO.FE3dSceneCanvas_dispose;return b};
MO.FE3dSceneCanvas_onEnterFrame=function(){var b=this._activeSpace;if(b){var d=b.timer().spanSecond(),f=b.camera(),h=this._cameraMoveRate*d,d=this._cameraKeyRotation*d,q=RKeyboard.isPress(MO.EStageKey.Forward),w=RKeyboard.isPress(MO.EStageKey.Back);(q&&!w||this._actionForward)&&f.doWalk(h);(!q&&w||this._actionBack)&&f.doWalk(-h);q=RKeyboard.isPress(MO.EStageKey.Up);w=RKeyboard.isPress(MO.EStageKey.Down);(q&&!w||this._actionUp)&&f.doFly(h);(!q&&w||this._actionDown)&&f.doFly(-h);h=RKeyboard.isPress(MO.EStageKey.RotationLeft);
q=RKeyboard.isPress(MO.EStageKey.RotationRight);h&&!q&&f.doYaw(d);!h&&q&&f.doYaw(-d);h=RKeyboard.isPress(MO.EStageKey.RotationUp);q=RKeyboard.isPress(MO.EStageKey.RotationDown);h&&!q&&f.doPitch(d);!h&&q&&f.doPitch(-d);f.update();if(this._optionRotation){d=this._rotation;b=b.layers();f=b.count();for(h=0;h<f;h++)q=b.at(h).matrix(),q.setRotation(0,d.y,0),q.update();d.y+=.01}}};
MO.FE3dSceneCanvas_onMouseCaptureStart=function(b){var d=this._activeSpace;if(d){var f=this._activeSpace.region();RConsole.find(FG3dTechniqueConsole).find(this._graphicContext,FG3dSelectTechnique).test(f,b.offsetX,b.offsetY);this._capturePosition.set(b.clientX,b.clientY);this._captureCameraRotation.assign(d.camera()._rotation)}};
MO.FE3dSceneCanvas_onMouseCapture=function(b){if(this._activeSpace){var d=b.clientX-this._capturePosition.x;b=b.clientY-this._capturePosition.y;var f=this._activeSpace.camera().rotation(),h=this._captureCameraRotation;f.x=h.x+b*this._cameraMouseRotation;f.y=h.y+d*this._cameraMouseRotation}};MO.FE3dSceneCanvas_onMouseCaptureStop=function(b){};
MO.FE3dSceneCanvas_onTouchStart=function(b){var d=this._activeSpace;if(d){this._activeSpace.region();var f=b.touches;1==f.length?(b.preventDefault(),b=f[0],this._captureStatus=!0,this._capturePosition.set(b.clientX,b.clientY),this._captureCameraPosition.assign(d.camera().position()),this._captureCameraRotation.assign(d.camera().rotation())):this._touchTracker.eventStart(b)}};
MO.FE3dSceneCanvas_onTouchMove=function(b){if(this._captureStatus){var d=b.touches,f=d.length;1==f?(b.preventDefault(),b=d[0],d=this._activeSpace.camera().rotation(),f=b.clientX-this._capturePosition.x,d.x=this._captureCameraRotation.x+-(b.clientY-this._capturePosition.y)*this._cameraMouseRotation,d.y=this._captureCameraRotation.y+-f*this._cameraMouseRotation):1<f&&this._touchTracker.eventMove(b)}};MO.FE3dSceneCanvas_onTouchStop=function(b){this._touchTracker.eventStop(b);this._captureStatus=!1};
MO.FE3dSceneCanvas_onTouchZoom=function(b){b=b.delta;var d=this._activeSpace;d&&d.camera().doForward(.006*b)};MO.FE3dSceneCanvas_onDataLoaded=function(b){var d=this._activeSpace;b=this._graphicContext.size();var f=d.camera().projection();f.size().set(b.width,b.height);f.update();b=d._region._resource;this._cameraMoveRate=b.moveSpeed();this._cameraKeyRotation=b.rotationKeySpeed();this._cameraMouseRotation=b.rotationMouseSpeed();b=new MO.SEvent(this);b.space=d;this.processLoadListener(b);b.dispose()};
MO.FE3dSceneCanvas_onResize=function(b){this.__base.FE3dCanvas.onResize.call(this,b);b=this._graphicContext.size();var d=this._activeSpace;d&&(d=d.camera().projection(),d.size().set(b.width,b.height),d.update())};
MO.FE3dSceneCanvas_construct=function(){this.__base.FE3dCanvas.construct.call(this);this._rotation=new MO.SVector3;this._capturePosition=new MO.SPoint2;this._captureCameraPosition=new MO.SPoint3;this._captureCameraRotation=new MO.SVector3;this._touchTracker=MO.Class.create(MO.FTouchTracker);this._touchTracker.addTouchZoomListener(this,this.onTouchZoom)};MO.FE3dSceneCanvas_testPlay=function(){return this._actionPlay};
MO.FE3dSceneCanvas_switchPlay=function(b){for(var d=this._activeSpace.allDisplays(),f=d.count(),h=0;h<f;h++){var q=d.at(h);if(RClass.isClass(q,FE3dSceneDisplay)){var w=q._sprite;w&&(w._optionPlay=b);q._optionPlay=b}}this._actionPlay=b};MO.FE3dSceneCanvas_testMovie=function(){return this._actionMovie};MO.FE3dSceneCanvas_switchMovie=function(b){for(var d=this._activeSpace.allDisplays(),f=d.count(),h=0;h<f;h++){var q=d.get(h);q._movies&&(q._optionMovie=b)}this._actionMovie=b};
MO.FE3dSceneCanvas_doAction=function(b,d,f){if(this._activeSpace)switch(b.preventDefault(),this._actionBack=this._actionForward=this._actionDown=this._actionUp=!1,d){case "fullscreen":b=this._actionFullScreen=!this._actionFullScreen;MO.RHtml.fullscreen(this._hPanel,b);break;case "play":this.switchMovie(!this._actionMovie);this.switchPlay(this._actionMovie);break;case "up":this._actionUp=f;break;case "down":this._actionDown=f;break;case "forward":this._actionForward=f;break;case "back":this._actionBack=
f}};MO.FE3dSceneCanvas_loadByGuid=function(b){var d=MO.Console.find(MO.FE3dSceneConsole);this._activeSpace&&d.free(this._activeSpace);b=this._activeSpace=d.allocByGuid(this._graphicContext,b);b.addLoadListener(this,this.onDataLoaded);RStage.register("canvas.space",b)};
MO.FE3dSceneCanvas_loadByCode=function(b){var d=MO.Console.find(MO.FE3dSceneConsole);this._activeSpace&&d.free(this._activeSpace);b=this._activeSpace=d.allocByCode(this._graphicContext,b);b.addLoadListener(this,this.onDataLoaded);RStage.register("canvas.space",b)};MO.FE3dSceneCanvas_dispose=function(){var b=this._rotation;b&&(b.dispose(),this._rotation=null);this.__base.FE3dCanvas.dispose.call(this)};
MO.FE3dSceneConsole=function(b){b=MO.Class.inherits(this,b,MO.FConsole);b._scopeCd=MO.EScope.Local;b._loadDisplays=null;b._loadScenes=null;b._pools=null;b._thread=null;b._interval=100;b.onProcess=MO.FE3dSceneConsole_onProcess;b.construct=MO.FE3dSceneConsole_construct;b.scenes=MO.FE3dSceneConsole_scenes;b.loadDisplay=MO.FE3dSceneConsole_loadDisplay;b.allocByGuid=MO.FE3dSceneConsole_allocByGuid;b.allocByCode=MO.FE3dSceneConsole_allocByCode;b.free=MO.FE3dSceneConsole_free;return b};
MO.FE3dSceneConsole_onProcess=function(){var b=this._loadDisplays;for(b.record();b.next();)b.current().processLoad()&&b.removeCurrent();b=this._loadScenes;for(b.record();b.next();)b.current().processLoad()&&b.removeCurrent()};MO.FE3dSceneConsole_construct=function(){this._loadDisplays=new MO.TLooper;this._loadScenes=new MO.TLooper;this._pools=MO.Class.create(MO.FObjectPools);var b=this._thread=MO.Class.create(MO.FThread);b.setInterval(this._interval);b.addProcessListener(this,this.onProcess);MO.Console.find(MO.FThreadConsole).start(b)};
MO.FE3dSceneConsole_scenes=function(){return this._scenes};MO.FE3dSceneConsole_loadDisplay=function(b){this._loadDisplays.push(b)};MO.FE3dSceneConsole_allocByGuid=function(b,d){var f=this._pools.alloc(d);if(f)return f;var h=MO.Console.find(MO.FE3sSceneConsole).loadByGuid(d),f=MO.Class.create(MO.FE3dScene);f.linkGraphicContext(b);f.setResource(h);f._poolCode=d;f.setup();this._loadScenes.push(f);return f};
MO.FE3dSceneConsole_allocByCode=function(b,d){var f=this._pools.alloc(d);if(f)return f;var h=MO.Console.find(MO.FE3sSceneConsole).loadByCode(d),f=MO.Class.create(MO.FE3dScene);f.linkGraphicContext(b);f.setResource(h);f._poolCode=d;f.setup();this._loadScenes.push(f);return f};MO.FE3dSceneConsole_free=function(b){this._pools.free(b._poolCode,b)};
MO.FE3dSceneDisplay=function(b){b=MO.Class.inherits(this,b,MO.FE3dSprite,MO.MListenerLoad);b._dataReady=!1;b._optionPlay=!1;b._optionMovie=!1;b._movieMatrix=null;b._resource=null;b._materials=null;b._parentMaterials=null;b._template=null;b._sprite=null;b.construct=MO.FE3dSceneDisplay_construct;b.calculateOutline=MO.FE3dSceneDisplay_calculateOutline;b.meshRenderables=MO.FE3dSceneDisplay_meshRenderables;b.loadResource=MO.FE3dSceneDisplay_loadResource;b.loadTemplate=MO.FE3dSceneDisplay_loadTemplate;
b.processLoad=MO.FE3dSceneDisplay_processLoad;b.clone=MO.FE3dSceneDisplay_clone;return b};MO.FE3dSceneDisplay_construct=function(){this.__base.FE3dSprite.construct.call(this);this._movieMatrix=new MO.SMatrix3d};MO.FE3dSceneDisplay_calculateOutline=function(){return this._sprite.calculateOutline()};MO.FE3dSceneDisplay_meshRenderables=function(){return this._template.sprite().meshRenderables()};
MO.FE3dSceneDisplay_loadResource=function(b){var d=MO.Console.find(MO.FE3dInstanceConsole);this._resource=b;this._code=b.code();this._matrix.assign(b.matrix());var f=b.movies();if(f)for(var h=f.count(),q=0;q<h;q++){var w=f.at(q),z=d.create(MO.EE3dInstance.SceneMovie);z.loadResource(w);this.pushMovie(z)}if(f=b.materials())for(h=f.count(),w=this._materials=new MO.TDictionary,z=this._parentMaterials=new MO.TDictionary,q=0;q<h;q++){var A=f.at(q),B=d.create(MO.EE3dInstance.SceneMaterial);B._display=this;
B.loadSceneResource(A);w.set(A.guid(),B);z.set(A.parentGuid(),B)}b=b.templateGuid();this._template=MO.Console.find(MO.FE3dTemplateConsole).allocByGuid(this,b)};
MO.FE3dSceneDisplay_loadTemplate=function(b){var d=this._resource,f=b._sprites;if(f)for(var h=this._optionPlay,q=f.count(),w=0;w<q;w++){var z=f.at(w);z._optionPlay=h;z.matrix().identity()}f=this._parentMaterials;z=this._sprite=b.sprite();h=z.renderables();q=h.count();for(b=0;b<q;b++){var w=h.at(b),A=w.material(),B=A.guid();f&&(B=f.get(B))&&(B.loadParent(A),B.reloadResource(),w.setMaterial(B))}this.pushDisplay(z);if(q=z.animations())for(z=q.count(),b=0;b<z;b++)f=q.at(b),w=f.resource(),A=w.guid(),h=
d.findAnimation(A),h||(h=d.syncAnimation(A),h._guid=w._guid,h._code=w._code,h._label=w._label),w=MO.Class.create(MO.FE3dSceneAnimation),w.loadAnimation(f),w.loadSceneResource(h),w.reloadResource(),this.pushAnimation(w)};MO.FE3dSceneDisplay_processLoad=function(){if(this._ready)return!0;var b=this._template;if(!b.testReady())return!1;this.loadTemplate(b);this._ready=!0;this.processLoadListener(this);return!0};MO.FE3dSceneDisplay_clone=function(){};
MO.FE3dSceneDisplayRenderable=function(b){b=MO.Class.inherits(this,b,MO.FE3dTemplateRenderable);b.loadMaterial=MO.FE3dSceneDisplayRenderable_loadMaterial;b.reloadResource=MO.FE3dSceneDisplayRenderable_reloadResource;return b};MO.FE3dSceneDisplayRenderable_loadMaterial=function(b){this._materialReference=b;this._material.calculate(b)};MO.FE3dSceneDisplayRenderable_reloadResource=function(){var b=this._material;b.calculate(this._materialReference);b.update()};
MO.FE3dSceneLayer=function(b){b=MO.Class.inherits(this,b,MO.FDisplayLayer,MO.MLinkerResource);b.makeLabel=MO.FE3dSceneLayer_makeLabel;b.loadResource=MO.FE3dSceneLayer_loadResource;b.process=MO.FE3dSceneLayer_process;return b};MO.FE3dSceneLayer_makeLabel=function(){var b=this.resource(),d=b.code();return(b=b.label())?d+"["+b+"]":d};MO.FE3dSceneLayer_loadResource=function(b){this._resource=b};
MO.FE3dSceneLayer_process=function(b){this.__base.FDisplayLayer.process.call(this,b);var d=this._resource.transformCd();d&&d==MO.EDisplayTransform.CameraPosition&&(b=b.camera().position(),this._matrix.setTranslate(b.x,b.y,b.z),this._matrix.update())};MO.FE3dSceneMaterial=function(b){b=MO.Class.inherits(this,b,MO.FE3dMaterial);b._display=null;b._parentMaterial=null;b.loadSceneResource=MO.FE3dSceneMaterial_loadSceneResource;b.reloadResource=MO.FE3dSceneMaterial_reloadResource;return b};
MO.FE3dSceneMaterial_loadSceneResource=function(b){this._resource=b;this.reloadResource()};MO.FE3dSceneMaterial_reloadResource=function(){this.calculate(this._resource);this.update()};MO.FE3dSceneRegion=function(b){b=MO.Class.inherits(this,b,MO.FE3dRegion);b._resource=MO.Class.register(b,new MO.AGetter("_resource"));b.construct=MO.FE3dSceneRegion_construct;b.loadResource=MO.FE3dSceneRegion_loadResource;b.reloadResource=MO.FE3dSceneRegion_reloadResource;b.dispose=MO.FE3dSceneRegion_dispose;return b};
MO.FE3dSceneRegion_construct=function(){this.__base.FE3dRegion.construct.call(this)};MO.FE3dSceneRegion_loadResource=function(b){this._resource=b;this.reloadResource()};MO.FE3dSceneRegion_reloadResource=function(){var b=this._resource;b.optionBackground()?(this._backgroundColor.assignPower(b.backgroundColor()),this._backgroundColor.alpha=1):this._backgroundColor.set(0,0,0,0)};MO.FE3dSceneRegion_dispose=function(){this._resource=null;this.__base.FE3dRegion.dispose.call(this)};
MO.FE3dSimpleCanvas=function(b){b=MO.Class.inherits(this,b,MO.FE3dCanvas);b._activeSpace=null;b._captureStatus=!1;b._capturePosition=null;b._captureCameraPosition=null;b._captureCameraRotation=null;b._actionFullScreen=!1;b._actionPlay=!1;b._actionMovie=!1;b._actionUp=!1;b._actionDown=!1;b._actionForward=!1;b._actionBack=!1;b._cameraMoveRate=.4;b._cameraKeyRotation=.03;b._cameraMouseRotation=.005;b._stage=MO.Class.register(b,new MO.AGetter("_stage"));b.onEnterFrame=MO.FE3dSimpleCanvas_onEnterFrame;
b.onMouseCaptureStart=MO.FE3dSimpleCanvas_onMouseCaptureStart;b.onMouseCapture=MO.FE3dSimpleCanvas_onMouseCapture;b.onMouseCaptureStop=MO.FE3dSimpleCanvas_onMouseCaptureStop;b.onTouchStart=MO.FE3dSimpleCanvas_onTouchStart;b.onTouchMove=MO.FE3dSimpleCanvas_onTouchMove;b.onTouchStop=MO.FE3dSimpleCanvas_onTouchStop;b.onSceneLoad=MO.FE3dSimpleCanvas_onSceneLoad;b.onResize=MO.FE3dSimpleCanvas_onResize;b.construct=MO.FE3dSimpleCanvas_construct;b.build=MO.FE3dSimpleCanvas_build;b.setPanel=MO.FE3dSimpleCanvas_setPanel;
b.switchPlay=MO.FE3dSimpleCanvas_switchPlay;b.switchMovie=MO.FE3dSimpleCanvas_switchMovie;b.doAction=MO.FE3dSimpleCanvas_doAction;b.dispose=MO.FE3dSimpleCanvas_dispose;return b};
MO.FE3dSimpleCanvas_onEnterFrame=function(){var b=this._activeSpace;if(b){var d=b.camera(),f=this._cameraMoveRate,h=this._cameraKeyRotation,q=MO.Window.Keyboard.isPress(MO.EKeyCode.W),w=MO.Window.Keyboard.isPress(MO.EKeyCode.S);(q&&!w||this._actionForward)&&d.doWalk(f);(!q&&w||this._actionBack)&&d.doWalk(-f);q=MO.Window.Keyboard.isPress(MO.EKeyCode.A);w=MO.Window.Keyboard.isPress(MO.EKeyCode.D);q&&!w&&d.doYaw(h);!q&&w&&d.doYaw(-h);q=MO.Window.Keyboard.isPress(MO.EKeyCode.Q);w=MO.Window.Keyboard.isPress(MO.EKeyCode.E);
(q&&!w||this._actionUp)&&d.doFly(f);(!q&&w||this._actionDown)&&d.doFly(-f);f=MO.Window.Keyboard.isPress(MO.EKeyCode.Z);q=MO.Window.Keyboard.isPress(MO.EKeyCode.X);f&&!q&&d.doPitch(h);!f&&q&&d.doPitch(-h);d.update();if(this._optionRotation){h=this._rotation;b=b.layers();d=b.count();for(f=0;f<d;f++)q=b.value(f).matrix(),q.setRotation(0,h.y,0),q.update();h.y+=.01}}};MO.FE3dSimpleCanvas_onMouseCaptureStart=function(b){var d=this._activeSpace;d&&(this._capturePosition.set(b.clientX,b.clientY),this._captureCameraRotation.assign(d.camera()._rotation))};
MO.FE3dSimpleCanvas_onMouseCapture=function(b){if(this._activeSpace){var d=b.clientX-this._capturePosition.x;b=b.clientY-this._capturePosition.y;var f=this._activeSpace.camera().rotation(),h=this._captureCameraRotation;f.x=h.x+b*this._cameraMouseRotation;f.y=h.y+d*this._cameraMouseRotation}};MO.FE3dSimpleCanvas_onMouseCaptureStop=function(b){};
MO.FE3dSimpleCanvas_onTouchStart=function(b){var d=this._activeSpace;if(d){this._activeSpace.region();var f=b.touches;1==f.length&&(b.preventDefault(),b=f[0],this._captureStatus=!0,this._capturePosition.set(b.clientX,b.clientY),this._captureCameraPosition.assign(d.camera().position()),this._captureCameraRotation.assign(d.camera().rotation()))}};
MO.FE3dSimpleCanvas_onTouchMove=function(b){if(this._captureStatus){var d=b.touches;if(1==d.length){b.preventDefault();b=d[0];var d=this._activeSpace.camera().rotation(),f=b.clientX-this._capturePosition.x;d.x=this._captureCameraRotation.x+-(b.clientY-this._capturePosition.y)*this._cameraMouseRotation;d.y=this._captureCameraRotation.y+-f*this._cameraMouseRotation}}};MO.FE3dSimpleCanvas_onTouchStop=function(b){this._captureStatus=!1};
MO.FE3dSimpleCanvas_onSceneLoad=function(b){b=this._activeSpace;var d=this._graphicContext.size(),f=b.camera().projection();f.size().set(d.width,d.height);f.update();d=b._region._resource;this._cameraMoveRate=d.moveSpeed();this._cameraKeyRotation=d.rotationKeySpeed();this._cameraMouseRotation=d.rotationMouseSpeed();this.processLoadListener(this,b)};
MO.FE3dSimpleCanvas_onResize=function(b){this.__base.FE3dCanvas.onResize.call(this,b);b=this._graphicContext.size();var d=this._activeSpace;d&&(d=d.camera().projection(),d.size().set(b.width,b.height),d.update())};MO.FE3dSimpleCanvas_construct=function(){this.__base.FE3dCanvas.construct.call(this);this._rotation=new MO.SVector3;this._capturePosition=new MO.SPoint2;this._captureCameraPosition=new MO.SPoint3;this._captureCameraRotation=new MO.SVector3};
MO.FE3dSimpleCanvas_build=function(b){this.__base.FE3dCanvas.build.call(this,b);b=this._stage=this._activeSpace=MO.Class.create(MO.FE3dSimpleStage);b.linkGraphicContext(this);b.region().linkGraphicContext(this);b.selectTechnique(this,FE3dGeneralTechnique);MO.RStage.register("simple.stage",b)};
MO.FE3dSimpleCanvas_setPanel=function(b){this.__base.FE3dCanvas.setPanel.call(this,b);b=this._stage.region().camera();var d=b.projection();d.size().set(this._hCanvas.offsetWidth,this._hCanvas.offsetHeight);d.update();b.position().set(0,0,-10);b.lookAt(0,0,0);b.update()};MO.FE3dSimpleCanvas_switchPlay=function(b){for(var d=this._activeSpace.allDisplays(),f=d.count(),h=0;h<f;h++){var q=d.get(h);q._movies&&(q._optionPlay=b)}this._actionPlay=b};
MO.FE3dSimpleCanvas_switchMovie=function(b){for(var d=this._activeSpace.allDisplays(),f=d.count(),h=0;h<f;h++){var q=d.get(h);q._movies&&(q._optionMovie=b)}this._actionMovie=b};
MO.FE3dSimpleCanvas_doAction=function(b,d,f){if(this._activeSpace)switch(b.preventDefault(),this._actionBack=this._actionForward=this._actionDown=this._actionUp=!1,d){case "fullscreen":b=this._actionFullScreen=!this._actionFullScreen;RHtml.fullscreen(this._hPanel,b);break;case "play":this.switchMovie(!this._actionMovie);this.switchPlay(this._actionMovie);break;case "up":this._actionUp=f;break;case "down":this._actionDown=f;break;case "forward":this._actionForward=f;break;case "back":this._actionBack=
f}};MO.FE3dSimpleCanvas_dispose=function(){var b=this._rotation;b&&(b.dispose(),this._rotation=null);this.__base.FE3dCanvas.dispose.call(this)};MO.FE3dSimpleDesktop=function(b){b=MO.Class.inherits(this,b,MO.FDesktop);b._canvas3d=MO.Class.register(b,new MO.AGetter("_canvas3d"));b._canvas2d=MO.Class.register(b,new MO.AGetter("_canvas2d"));b.onResize=MO.FE3dSimpleDesktop_onResize;b.construct=MO.FE3dSimpleDesktop_construct;b.build=MO.FE3dSimpleDesktop_build;b.dispose=MO.FE3dSimpleDesktop_dispose;return b};
MO.FE3dSimpleDesktop_onResize=function(b){};MO.FE3dSimpleDesktop_construct=function(){this.__base.FDesktop.construct.call(this)};
MO.FE3dSimpleDesktop_build=function(b){this.__base.FDesktop.build.call(this,b);MO.RWindow.lsnsResize.register(this,this.onResize);var d=this._canvas3d=MO.RClass.create(MO.FE3dSimpleCanvas);d.build(b);d.setPanel(b);var f=d.size(),h=d._hCanvas,d=this._canvas2d=MO.RClass.create(MO.FE2dCanvas);d.size().assign(f);d.build(b);d.setPanel(b);b=d._hCanvas;b.style.position="absolute";b.style.left=h.offsetLeft+"px";b.style.top=h.offsetTop+"px"};MO.FE3dSimpleDesktop_dispose=function(){this.__base.FDesktop.dispose.call(this)};
MO.FE3dSimpleStage=function(b){b=MO.RClass.inherits(this,b,MO.FE3dStage);b._optionKeyboard=!0;b._skyLayer=MO.RClass.register(b,new MO.AGetter("_skyLayer"));b._mapLayer=MO.RClass.register(b,new MO.AGetter("_mapLayer"));b._spriteLayer=MO.RClass.register(b,new MO.AGetter("_spriteLayer"));b._faceLayer=MO.RClass.register(b,new MO.AGetter("_faceLayer"));b.construct=MO.FE3dSimpleStage_construct;b.active=MO.FE3dSimpleStage_active;b.deactive=MO.FE3dSimpleStage_deactive;return b};
MO.FE3dSimpleStage_construct=function(){this.__base.FE3dStage.construct.call(this);var b=this._skyLayer=MO.RClass.create(MO.FDisplayLayer);this.registerLayer("SkyLayer",b);b=this._mapLayer=MO.RClass.create(MO.FDisplayLayer);this.registerLayer("MapLayer",b);b=this._spriteLayer=MO.RClass.create(MO.FDisplayLayer);this.registerLayer("SpriteLayer",b);b=this._faceLayer=MO.RClass.create(MO.FDisplayLayer);this.registerLayer("FaceLayer",b)};MO.FE3dSimpleStage_active=function(){this.__base.FE3dStage.active.call(this)};
MO.FE3dSimpleStage_deactive=function(){this.__base.FE3dStage.deactive.call(this)};
MO.FE3dSpace=function(b){b=MO.Class.inherits(this,b,MO.FE3dStage,MO.MListener);b._dataReady=!1;b._resource=MO.Class.register(b,new MO.AGetSet("_resource"));b._materials=MO.Class.register(b,new MO.AGetter("_materials"));b._dirty=!1;b._loadListeners=MO.Class.register(b,new MO.AListener("_loadListeners",MO.EEvent.Load));b.onProcess=MO.FE3dSpace_onProcess;b.construct=MO.FE3dSpace_construct;b.linkGraphicContext=MO.FE3dSpace_linkGraphicContext;b.createRegion=MO.FE3dSpace_createRegion;b.findMaterial=MO.FE3dSpace_findMaterial;
b.loadTechniqueResource=MO.FE3dSpace_loadTechniqueResource;b.loadRegionResource=MO.FE3dSpace_loadRegionResource;b.loadDisplayResource=MO.FE3dSpace_loadDisplayResource;b.loadLayerResource=MO.FE3dSpace_loadLayerResource;b.loadResource=MO.FE3dSpace_loadResource;b.commitResource=MO.FE3dSpace_commitResource;b.dirty=MO.FE3dSpace_dirty;b.processLoad=MO.FE3dSpace_processLoad;b.active=MO.FE3dSpace_active;b.deactive=MO.FE3dSpace_deactive;return b};
MO.FE3dSpace_onProcess=function(){this.__base.FE3dStage.onProcess.call(this);if(this._dirty){for(var b=this._region.allRenderables(),d=b.count(),f=0;f<d;f++)b.at(f).resetInfos();this._dirty=!1}};MO.FE3dSpace_construct=function(){this.__base.FE3dStage.construct.call(this);this._materials=new MO.TDictionary};MO.FE3dSpace_linkGraphicContext=function(b){this.__base.FE3dStage.linkGraphicContext.call(this,b);this._region.linkGraphicContext(b)};MO.FE3dSpace_createRegion=function(){return MO.Class.create(MO.FE3dRegion)};
MO.FE3dSpace_findMaterial=function(b){return this._materials.get(b)};MO.FE3dSpace_loadTechniqueResource=function(b){this._technique._resource=b};
MO.FE3dSpace_loadRegionResource=function(b){this._region.loadResource(b);var d=b.camera();d.projection();var f=this.camera();f.projection().size().assign(this._graphicContext.size());f.loadResource(d);f=b.light();b=f.camera();var d=b.projection(),h=this.directionalLight();h._resource=f;f=h._camera;h=f._projection;f.position().set(1,1,-1);f.lookAt(0,0,0);f.position().assign(b.position());f.update();h.size().set(1024,1024);h._angle=60;h._znear=d.znear();h._zfar=d.zfar();h.update()};
MO.FE3dSpace_loadDisplayResource=function(b,d){var f=MO.Console.find(MO.FE3dSpaceConsole).factory().create(EE3dScene.Display);f.linkGraphicContext(this);f.loadSceneResource(d);MO.Console.find(MO.FE3dTemplateConsole).loadByGuid(f,d.templateGuid());b.pushDisplay(f)};
MO.FE3dSpace_loadLayerResource=function(b){var d=MO.Console.find(MO.FE3dSpaceConsole).factory().create(EE3dScene.Layer);d.loadResource(b);var f=b.displays();if(f)for(var h=f.count(),q=0;q<h;q++){var w=f.get(q);this.loadDisplayResource(d,w)}this.registerLayer(b.code(),d)};
MO.FE3dSpace_loadResource=function(b){this._resource=b;this.loadTechniqueResource(b.technique());this.loadRegionResource(b.region());var d=b.materials();if(d)for(var f=d.count(),h=MO.Console.find(MO.FE3rMaterialConsole),q=0;q<f;q++){var w=d.at(q).guid(),z=h.load(this,w);this._materials.set(w,z)}if(b=b.layers())for(d=b.count(),q=0;q<d;q++)f=b.at(q),this.loadLayerResource(f)};MO.FE3dSpace_commitResource=function(){this._region.camera().commitResource()};MO.FE3dSpace_dirty=function(){this._dirty=!0};
MO.FE3dSpace_processLoad=function(){if(this._dataReady)return!0;if(!this._resource.testReady())return!1;this.loadResource(this._resource);this.processLoadListener(this);return!0};MO.FE3dSpace_active=function(){this.__base.FE3dStage.active.call(this)};MO.FE3dSpace_deactive=function(){this.__base.FE3dStage.deactive.call(this)};
MO.FE3dSprite=function(b){b=MO.Class.inherits(this,b,MO.FE3dDisplayContainer,MO.MGraphicObject,MO.MLinkerResource);b._dataReady=!1;b._ready=!1;b._shapes=null;b._skeletons=null;b._animations=null;b._movies=null;b._resource=null;b.construct=MO.FE3dSprite_construct;b.testReady=MO.FE3dSprite_testReady;b.makeLabel=MO.FE3dSprite_makeLabel;b.findMeshByCode=MO.FE3dSprite_findMeshByCode;b.meshRenderables=MO.FE3dSprite_shapes;b.skeletons=MO.FE3dSprite_skeletons;b.pushSkeleton=MO.FE3dSprite_pushSkeleton;b.findAnimation=
MO.FE3dSprite_findAnimation;b.animations=MO.FE3dSprite_animations;b.pushAnimation=MO.FE3dSprite_pushAnimation;b.movies=MO.FE3dSprite_movies;b.pushMovie=MO.FE3dSprite_pushMovie;b.loadSkeletons=MO.FE3dSprite_loadSkeletons;b.linkAnimation=MO.FE3dSprite_linkAnimation;b.loadAnimations=MO.FE3dSprite_loadAnimations;b.loadResource=MO.FE3dSprite_loadResource;b.reloadResource=MO.FE3dSprite_reloadResource;b.load=MO.FE3dSprite_load;b.updateMatrix=MO.FE3dSprite_updateMatrix;b.selectClip=MO.FE3dSprite_selectClip;
b.process=MO.FE3dSprite_process;b.dispose=MO.FE3dSprite_dispose;return b};MO.FE3dSprite_construct=function(){this.__base.FE3dDisplayContainer.construct.call(this);this._shapes=new TObjects};MO.FE3dSprite_testReady=function(){var b=this._shapes;if(b)for(var d=b.count(),f=0;f<d;f++)if(!b.at(f).testReady())return!1;return!0};MO.FE3dSprite_makeLabel=function(){var b=this.resource(),d=b.code();return(b=b.label())?d+"["+b+"]":d};
MO.FE3dSprite_findMeshByCode=function(b){for(var d=this._shapes,f=d.count()-1;0<=f;f--){var h=d.getAt(f);if(h._renderable._resource._code==b)return h}return null};MO.FE3dSprite_shapes=function(){return this._shapes};MO.FE3dSprite_skeletons=function(){return this._skeletons};MO.FE3dSprite_pushSkeleton=function(b){var d=this._skeletons;d||(d=this._skeletons=new MO.TDictionary);this._activeSkeleton||(this._activeSkeleton=b);d.set(b._resource.guid(),b)};
MO.FE3dSprite_findAnimation=function(b){var d=this._animations;return d?d.get(b):null};MO.FE3dSprite_animations=function(){return this._animations};MO.FE3dSprite_pushAnimation=function(b){var d=this._animations;d||(d=this._animations=new MO.TDictionary);var f=b.resource();d.set(f.guid(),b)};MO.FE3dSprite_movies=function(){return this._movies};MO.FE3dSprite_pushMovie=function(b){var d=this._movies;d||(d=this._movies=new MO.TObjects);d.push(b)};
MO.FE3dSprite_loadSkeletons=function(b){var d=b.count();if(0<d){this.skeletons();for(var f=0;f<d;f++){var h=b.getAt(f),q=MO.Class.create(MO.FE3rSkeleton);q.loadResource(h);this.pushSkeleton(q)}}};MO.FE3dSprite_linkAnimation=function(b){b=b.tracks();for(var d=b.count(),f=0;f<d;f++){var h=b.getAt(f),q=h._resource._meshCode;q&&(this.findMeshByCode(q)._activeTrack=h)}};
MO.FE3dSprite_loadAnimations=function(b){var d=b.count();if(0<d)for(var f=0;f<d;f++){var h=b.getAt(f),q=this.findAnimation(h.guid());q||(q=h.skeleton()?MO.Class.create(MO.FE3rSkeletonAnimation):MO.Class.create(MO.FE3rMeshAnimation),q._display=this,q.loadResource(h),this.pushAnimation(q))}};
MO.FE3dSprite_loadResource=function(b){this._resource=b;this._matrix.assign(b.matrix());b=b.renderables();var d=b.count();if(0<d)for(var f=this._shapes,h=0;h<d;h++){var q=b.at(h),w=MO.Class.create(MO.FE3dTemplateRenderable);w._display=this;w.linkGraphicContext(this);w.loadResource(q);f.push(w);this.pushRenderable(w)}};MO.FE3dSprite_reloadResource=function(){var b=this._shapes;if(b)for(var d=b.count(),f=0;f<d;f++)b.getAt(f).reloadResource()};
MO.FE3dSprite_load=function(){var b=this._shapes;if(b)for(var d=b.count(),f=0;f<d;f++)b.at(f).load()};MO.FE3dSprite_updateMatrix=function(b){b=this._currentMatrix.identity();var d=this._movies;if(d){if(this._optionMovie)for(var f=d.count(),h=0;h<f;h++)d.at(h).process(this._movieMatrix);b.append(this._movieMatrix)}b.append(this._matrix);(b=this._parent)&&this._currentMatrix.append(b._currentMatrix)};MO.FE3dSprite_selectClip=function(b){var d=this._animations;if(d)for(var f=d.count(),h=0;h<f;h++)d.at(h).selectClip(b)};
MO.FE3dSprite_process=function(b){var d=this._animations;if(d)for(var f=d.count(),h=0;h<f;h++){var q=d.at(h);q.record()}this.__base.FE3dDisplayContainer.process.call(this,b);if((b=this._activeSkeleton)&&d)for(f=d.count(),h=0;h<f;h++)q=d.at(h),q.process(b)};MO.FE3dSprite_dispose=function(){this._shapes=MO.Lang.Object.dispose(this._shapes);this.__base.FE3dDisplayContainer.dispose.call(this)};
MO.FE3dTemplate=function(b){b=MO.Class.inherits(this,b,MO.FE3dSpace,MO.MGraphicObject,MO.MListenerLoad);b._dataReady=!1;b._ready=!1;b._sprites=MO.Class.register(b,new MO.AGetter("_sprites"));b._skeletons=MO.Class.register(b,new MO.AGetter("_skeletons"));b._animations=MO.Class.register(b,new MO.AGetter("_animations"));b.construct=MO.FE3dTemplate_construct;b.testReady=MO.FE3dTemplate_testReady;b.sprite=MO.FE3dTemplate_sprite;b.findMeshByCode=MO.FE3dTemplate_findMeshByCode;b.meshRenderables=MO.FE3dTemplate_sprites;
b.pushSkeleton=MO.FE3dTemplate_pushSkeleton;b.findAnimation=MO.FE3dTemplate_findAnimation;b.pushAnimation=MO.FE3dTemplate_pushAnimation;b.visible=MO.FE3dTemplate_visible;b.setVisible=MO.FE3dTemplate_setVisible;b.loadSkeletons=MO.FE3dTemplate_loadSkeletons;b.linkAnimation=MO.FE3dTemplate_linkAnimation;b.loadAnimations=MO.FE3dTemplate_loadAnimations;b.loadResource=MO.FE3dTemplate_loadResource;b.reloadResource=MO.FE3dTemplate_reloadResource;b.processLoad=MO.FE3dTemplate_processLoad;b.process=MO.FE3dTemplate_process;
b.dispose=MO.FE3dTemplate_dispose;return b};MO.FE3dTemplate_construct=function(){this.__base.FE3dSpace.construct.call(this);var b=this._layer=MO.Class.create(MO.FDisplayLayer);this.registerLayer("Layer",b);this._sprites=new MO.TObjects};MO.FE3dTemplate_testReady=function(){return this._ready};MO.FE3dTemplate_sprite=function(){return this._sprites.first()};MO.FE3dTemplate_findMeshByCode=function(b){for(var d=this._sprites,f=d.count()-1;0<=f;f--){var h=d.getAt(f);if(h._renderable._resource._code==b)return h}return null};
MO.FE3dTemplate_pushSkeleton=function(b){var d=this._skeletons;d||(d=this._skeletons=new MO.TDictionary);this._activeSkeleton||(this._activeSkeleton=b);d.set(b._resource.guid(),b)};MO.FE3dTemplate_sprites=function(){return this._sprites};MO.FE3dTemplate_findAnimation=function(b){var d=this._animations;return d?d.get(b):null};MO.FE3dTemplate_pushAnimation=function(b){var d=this._animations;d||(d=this._animations=new MO.TDictionary);var f=b.resource();d.set(f.guid(),b)};MO.FE3dTemplate_visible=function(){return this.sprite().visible()};
MO.FE3dTemplate_setVisible=function(b){this.sprite().setVisible(b)};MO.FE3dTemplate_loadSkeletons=function(b){var d=b.count();if(0<d){this.skeletons();for(var f=0;f<d;f++){var h=b.at(f),q=MO.Class.create(MO.FE3rSkeleton);q.loadResource(h);this.pushSkeleton(q)}}};MO.FE3dTemplate_linkAnimation=function(b){b=b.tracks();for(var d=b.count(),f=0;f<d;f++){var h=b.getAt(f),q=h._resource._meshCode;q&&(this.findMeshByCode(q)._activeTrack=h)}};
MO.FE3dTemplate_loadAnimations=function(b){var d=b.count();if(0<d)for(var f=0;f<d;f++){var h=b.getAt(f),q=this.findAnimation(h.guid());q||(q=h.skeleton()?MO.Class.create(MO.FE3rSkeletonAnimation):MO.Class.create(MO.FE3rMeshAnimation),q._display=this,q.loadResource(h),this.pushAnimation(q))}};
MO.FE3dTemplate_loadResource=function(b){this.selectTechnique(this,FE3dGeneralTechnique).setResource(b.technique());this.__base.FE3dSpace.loadResource.call(this,b);if(b=b.displays()){var d=b.count();if(0<d)for(var f=0;f<d;f++){var h=b.at(f),q=MO.Class.create(MO.FE3dTemplateDisplay);q._parent=this;q.linkGraphicContext(this);q.loadResource(h);this._sprites.push(q)}}};MO.FE3dTemplate_reloadResource=function(){var b=this._sprites;if(b)for(var d=b.count(),f=0;f<d;f++)b.at(f).reloadResource()};
MO.FE3dTemplate_processLoad=function(){if(this._ready)return!0;if(!this._dataReady){var b=this._resource;if(!b.testReady())return!1;this.loadResource(b);this._dataReady=!0}var d=this._sprites;if(d){for(var f=d.count(),b=0;b<f;b++){var h=d.at(b);if(!h.testReady())return!1}for(b=0;b<f;b++)h=d.at(b),h.load(),this._layer.pushDisplay(h)}if(d=this._animations)for(f=d.count(),b=0;b<f;b++)h=d.at(b),null==h.resource().skeleton()&&this.linkAnimation(h);this._ready=!0;b=MO.Memory.alloc(SEvent);b.sender=this;
b.template=this;this.processLoadListener(b);MO.Memory.free(b);return this._ready};MO.FE3dTemplate_process=function(b){this.__base.FE3dSpace.process.call(this)};MO.FE3dTemplate_dispose=function(){this._sprites=MO.Lang.Object.dispose(this._sprites);this.__base.FE3dSpace.dispose.call(this)};
MO.FE3dTemplateCanvas=function(b){b=MO.Class.inherits(this,b,MO.FE3dCanvas);b._activeTemplate=null;b._capturePosition=null;b._captureRotation=null;b.onEnterFrame=MO.FE3dTemplateCanvas_onEnterFrame;b.onMouseCaptureStart=MO.FE3dTemplateCanvas_onMouseCaptureStart;b.onMouseCapture=MO.FE3dTemplateCanvas_onMouseCapture;b.onMouseCaptureStop=MO.FE3dTemplateCanvas_onMouseCaptureStop;b.onResize=MO.FE3dTemplateCanvas_onResize;b.onTemplateLoad=MO.FE3dTemplateCanvas_onTemplateLoad;b.construct=MO.FE3dTemplateCanvas_construct;
b.loadByGuid=MO.FE3dTemplateCanvas_loadByGuid;b.loadByCode=MO.FE3dTemplateCanvas_loadByCode;b.dispose=MO.FE3dTemplateCanvas_dispose;return b};
MO.FE3dTemplateCanvas_onEnterFrame=function(){var b=this._activeTemplate;if(b){var d=b.camera(),f=.05,h=RKeyboard.isPress(EKeyCode.W),q=RKeyboard.isPress(EKeyCode.S);h&&!q&&d.doWalk(.5);!h&&q&&d.doWalk(-.5);h=RKeyboard.isPress(EKeyCode.A);q=RKeyboard.isPress(EKeyCode.D);h&&!q&&d.doYaw(f);!h&&q&&d.doYaw(-f);h=RKeyboard.isPress(EKeyCode.Q);q=RKeyboard.isPress(EKeyCode.E);h&&!q&&d.doFly(.5);!h&&q&&d.doFly(-.5);q=RKeyboard.isPress(EKeyCode.Z);h=RKeyboard.isPress(EKeyCode.X);q&&!h&&d.doPitch(f);!q&&h&&
d.doPitch(-f);d.update();if(this._optionRotation){f=this._rotation;b=b.layers();d=b.count();for(h=0;h<d;h++)q=b.value(h).matrix(),q.setRotation(0,f.y,0),q.update();f.y+=.01}}};MO.FE3dTemplateCanvas_onMouseCaptureStart=function(b){var d=this._activeTemplate;if(d){var f=this._activeTemplate.region();MO.Console.find(MO.FG3dTechniqueConsole).find(this._graphicContext,FG3dSelectTechnique).test(f,b.offsetX,b.offsetY);this._capturePosition.set(b.clientX,b.clientY);this._captureRotation.assign(d.camera()._rotation)}};
MO.FE3dTemplateCanvas_onMouseCapture=function(b){if(this._activeTemplate){var d=b.clientX-this._capturePosition.x;b=b.clientY-this._capturePosition.y;var f=this._activeTemplate.camera().rotation(),h=this._captureRotation;f.x=h.x+.003*b;f.y=h.y+.003*d}};MO.FE3dTemplateCanvas_onMouseCaptureStop=function(b){};
MO.FE3dTemplateCanvas_onResize=function(){this.__base.FE3dCanvas.onResize.call(this,event);var b=this._graphicContext.size(),d=this._activeSpace;d&&(d=d.camera().projection(),d.size().set(b.width,b.height),d.update())};MO.FE3dTemplateCanvas_onTemplateLoad=function(b){b=this._activeTemplate;var d=this._graphicContext.size(),f=b.camera().projection();f.size().set(d.width,d.height);f.update();this.processLoadListener(this,b)};
MO.FE3dTemplateCanvas_construct=function(){this.__base.FE3dCanvas.construct.call(this);this._rotation=new MO.SVector3;this._capturePosition=new MO.SPoint2;this._captureRotation=new MO.SVector3};
MO.FE3dTemplateCanvas_loadByGuid=function(b){var d=this._graphicContext,f=MO.Console.find(MO.FE3dSceneConsole);null!=this._activeTemplate&&f.free(this._activeTemplate);b=f.alloc(this,b);b.addLoadListener(this,this.onTemplateLoad);b.selectTechnique(d,FG3dGeneralTechnique);this._stage=this._activeTemplate=b;RStage.register("stage3d",b)};
MO.FE3dTemplateCanvas_loadByCode=function(b){var d=this._graphicContext,f=MO.Console.find(MO.FE3dTemplateConsole);null!=this._activeTemplate&&f.free(this._activeTemplate);b=f.allocByCode(d,b);b.addLoadListener(this,this.onTemplateLoad);b.selectTechnique(d,FE3dGeneralTechnique);this._stage=this._activeTemplate=b;MO.RStage.register("stage.template",b)};MO.FE3dTemplateCanvas_dispose=function(){var b=this._rotation;b&&(b.dispose(),this._rotation=null);this.__base.FE3dCanvas.dispose.call(this)};
MO.FE3dTemplateConsole=function(b){b=MO.Class.inherits(this,b,MO.FConsole);b._scopeCd=MO.EScope.Local;b._loadQueue=null;b._pools=null;b._thread=null;b._interval=200;b.onProcess=MO.FE3dTemplateConsole_onProcess;b.construct=MO.FE3dTemplateConsole_construct;b.allocByGuid=MO.FE3dTemplateConsole_allocByGuid;b.allocByCode=MO.FE3dTemplateConsole_allocByCode;b.free=MO.FE3dTemplateConsole_free;return b};
MO.FE3dTemplateConsole_onProcess=function(){var b=this._loadQueue;for(b.record();b.next();)b.current().processLoad()&&b.removeCurrent()};MO.FE3dTemplateConsole_construct=function(){this._loadQueue=new MO.TLooper;this._pools=MO.Class.create(MO.FObjectPools);var b=this._thread=MO.Class.create(MO.FThread);b.setInterval(this._interval);b.addProcessListener(this,this.onProcess);MO.Console.find(MO.FThreadConsole).start(b)};
MO.FE3dTemplateConsole_allocByGuid=function(b,d){var f=this._pools.alloc(d);if(f)return f;var h=MO.Console.find(MO.FE3sTemplateConsole).loadByGuid(d),f=MO.Class.create(MO.FE3dTemplate);f.linkGraphicContext(b);f.setResource(h);f._poolCode=d;this._loadQueue.push(f);return f};
MO.FE3dTemplateConsole_allocByCode=function(b,d){var f=this._pools.alloc(d);if(f)return f;var h=MO.Console.find(MO.FE3sTemplateConsole).loadByCode(d),f=MO.Class.create(MO.FE3dTemplate);f.linkGraphicContext(b);f.setResource(h);f._poolCode=d;this._loadQueue.push(f);return f};MO.FE3dTemplateConsole_free=function(b){this._pools.free(b._poolCode,b)};
MO.FE3dTemplateDisplay=function(b){b=MO.Class.inherits(this,b,MO.FE3dSprite,MO.MListenerLoad);b._dataReady=!1;b._ready=!1;b._shapes=MO.Class.register(b,new MO.AGetter("_shapes"));b._skeletons=MO.Class.register(b,new MO.AGetter("_skeletons"));b.construct=MO.FE3dTemplateDisplay_construct;b.testReady=MO.FE3dTemplateDisplay_testReady;b.findMeshByCode=MO.FE3dTemplateDisplay_findMeshByCode;b.pushSkeleton=MO.FE3dTemplateDisplay_pushSkeleton;b.loadSkeletons=MO.FE3dTemplateDisplay_loadSkeletons;b.linkAnimation=
MO.FE3dTemplateDisplay_linkAnimation;b.loadAnimations=MO.FE3dTemplateDisplay_loadAnimations;b.loadResource=MO.FE3dTemplateDisplay_loadResource;b.reloadResource=MO.FE3dTemplateDisplay_reloadResource;b.load=MO.FE3dTemplateDisplay_load;b.dispose=MO.FE3dTemplateDisplay_dispose;return b};MO.FE3dTemplateDisplay_construct=function(){this.__base.FE3dSprite.construct.call(this);this._shapes=new MO.TObjects};
MO.FE3dTemplateDisplay_testReady=function(){var b=this._shapes;if(b)for(var d=b.count(),f=0;f<d;f++)if(!b.at(f).testReady())return!1;return!0};MO.FE3dTemplateDisplay_findMeshByCode=function(b){for(var d=this._shapes,f=d.count()-1;0<=f;f--){var h=d.at(f);if(h._renderable._resource._code==b)return h}return null};
MO.FE3dTemplateDisplay_pushSkeleton=function(b){var d=b.resource().guid(),f=this._skeletons;f||(f=this._skeletons=new MO.TDictionary);this._activeSkeleton||(this._activeSkeleton=b);f.set(d,b)};MO.FE3dTemplateDisplay_loadSkeletons=function(b){var d=b.count();if(0<d)for(var f=0;f<d;f++){var h=b.at(f),q=MO.Class.create(MO.FE3rSkeleton);q.loadResource(h);this.pushSkeleton(q)}};
MO.FE3dTemplateDisplay_linkAnimation=function(b){b=b.tracks();for(var d=b.count(),f=0;f<d;f++){var h=b.at(f),q=h._resource._meshCode;q&&(this.findMeshByCode(q)._activeTrack=h)}};MO.FE3dTemplateDisplay_loadAnimations=function(b){for(var d=b.count(),f=0;f<d;f++){var h=b.at(f),q=h.guid(),q=this.findAnimation(q);q||(q=h.skeleton()?MO.Class.create(MO.FE3rSkeletonAnimation):MO.Class.create(MO.FE3rMeshAnimation),q._display=this,q.loadResource(h),this.pushAnimation(q))}};
MO.FE3dTemplateDisplay_loadResource=function(b){this._resource=b;var d=MO.Console.find(MO.FE3dInstanceConsole);this._matrix.assign(b.matrix());if(b=b.renderables())for(var f=this._shapes,h=b.count(),q=0;q<h;q++){var w=b.at(q),z=d.create(MO.EE3dInstance.TemplateRenderable);z._display=this;z.linkGraphicContext(this);z.loadResource(w);f.push(z);this.pushRenderable(z)}};MO.FE3dTemplateDisplay_reloadResource=function(){var b=this._shapes;if(b)for(var d=b.count(),f=0;f<d;f++)b.at(f).reloadResource()};
MO.FE3dTemplateDisplay_load=function(){var b=this._shapes;if(b)for(var d=b.count(),f=0;f<d;f++)b.at(f).load();if(b=this._animations)for(d=b.count(),f=0;f<d;f++){var h=b.at(f);null==h.resource().skeleton()&&this.linkAnimation(h)}};MO.FE3dTemplateDisplay_dispose=function(){this._shapes=MO.Lang.Object.dispose(this._shapes);this.__base.FE3dSprite.dispose.call(this)};
MO.FE3dTemplateRenderable=function(b){b=MO.Class.inherits(this,b,MO.FE3dMeshRenderable,MO.MLinkerResource);b._ready=!1;b._model=null;b._materialCode=null;b._materialResource=null;b.construct=MO.FE3dTemplateRenderable_construct;b.testReady=MO.FE3dTemplateRenderable_testReady;b.testVisible=MO.FE3dTemplateRenderable_testVisible;b.calculateOutline=MO.FE3dTemplateRenderable_calculateOutline;b.loadResource=MO.FE3dTemplateRenderable_loadResource;b.reloadResource=MO.FE3dTemplateRenderable_reloadResource;
b.load=MO.FE3dTemplateRenderable_load;b.dispose=MO.FE3dTemplateRenderable_dispose;return b};MO.FE3dTemplateRenderable_construct=function(){this.__base.FE3dMeshRenderable.construct.call(this)};MO.FE3dTemplateRenderable_testReady=function(){if(!this._ready){if(!this._model.testReady())return!1;var b=this._materials;if(b)for(var d=b.count(),f=0;f<d;f++){var h=b.at(f);if(h&&!h.testReady())return!1}this._ready=!0}return this._ready};
MO.FE3dTemplateRenderable_testVisible=function(b){b=!1;this._ready&&(b=this.__base.FE3dMeshRenderable.testVisible.call(this));return b};MO.FE3dTemplateRenderable_calculateOutline=function(b){var d=this._outline;if(d.isEmpty()||b)b=this._resource.mesh().outline(),d.calculateFrom(b,this._currentMatrix);return d};
MO.FE3dTemplateRenderable_loadResource=function(b){this._resource=b;this._matrix.assign(b.matrix());var d=b.modelGuid();this._model=MO.Console.find(MO.FE3rModelConsole).load(this,d);var f=b.materialGuid();MO.Lang.String.isEmpty(f)||(f=this._material=this._materialReference=MO.Console.find(MO.FE3rMaterialConsole).load(this,f),this._materialResource=f.resource(),this.pushMaterial(f));d=this._display._parent;if(b=b.materialRefers())for(var h=b.count(),q=0;q<h;q++)f=b.at(q).guid(),f=d.findMaterial(f),
this.pushMaterial(f),this._material=f;this._material||(this._material=this._materialReference=MO.Class.create(MO.FE3dMaterial))};MO.FE3dTemplateRenderable_reloadResource=function(){var b=this._material;b.calculate(this._materialResource);b.update()};
MO.FE3dTemplateRenderable_load=function(){var b=this._display,d=this._resource,f=d.model(),h=this._material.bitmaps();if(h)for(var q=h.count(),w=0;w<q;w++){var z=h.at(w);this.pushTexture(z)}(w=f.skeletons())&&b.loadSkeletons(w);(w=f.animations())&&b.loadAnimations(w);d.mesh();w=d.meshGuid();d=this._renderable=MO.Console.find(MO.FE3rModelConsole).findMesh(w);f=d.vertexBuffers();h=f.count();for(w=0;w<h;w++)q=f.at(w),this._vertexBuffers.set(q.code(),q);if(w=d.skins()){b=b._activeSkeleton;d=this._activeSkin=
w.first();f=d.streams();h=f.count();for(w=0;w<h;w++)q=f.at(w).buffer(),this._vertexBuffers.set(q.code(),q);d=d.resource().boneRefers();f=d.count();if(0<f)for(h=this._bones=new MO.TObjects,w=0;w<f;w++){q=d.at(w).index();q=b.bones().get(q);if(!q)throw new MO.TError(this,"Bone is not exist.");h.push(q)}}this._ready=!0};MO.FE3dTemplateRenderable_dispose=function(){this.__base.FE3dMeshRenderable.dispose.call(this)};
MO.ME3dBoundaryPolygon=function(b){b=MO.Class.inherits(this,b);b._positionCount=MO.Class.register(b,new MO.AGetter("_positionCount"));b._positions=MO.Class.register(b,new MO.AGetter("_positions"));b._indexCount=MO.Class.register(b,new MO.AGetter("_indexCount"));b._indexes=MO.Class.register(b,new MO.AGetter("_indexes"));b.construct=MO.ME3dBoundaryPolygon_construct;b.dispose=MO.ME3dBoundaryPolygon_dispose;return b};MO.ME3dBoundaryPolygon_construct=function(){};
MO.ME3dBoundaryPolygon_dispose=function(){this._indexes=this._positions=null};MO.ME3dDynamicRenderable=function(b){b=MO.Class.inherits(this,b);b._color=MO.Class.register(b,new MO.AGetter("_color"));b.construct=MO.ME3dDynamicRenderable_construct;b.dispose=MO.ME3dDynamicRenderable_dispose;return b};MO.ME3dDynamicRenderable_construct=function(){this._color=new MO.SColor4(1,1,1,1)};MO.ME3dDynamicRenderable_dispose=function(){this._color=MO.Lang.Object.dispose(this._color)};
MO.SE3dRulerPrecision=function(b){b=this;b.interval=1;b.length=.5;b.color=new MO.SColor4(255,255,255,255);return b};MO.SE3dRulerPrecision_assign=function(b){this.interval.assign(b.interval);this.color.assign(b.color)};MO.SE3dRulerStyle=function(b){b=this;b.lineColor=new MO.SColor4(255,255,255,255);b.bothLength=.5;b.bothColor=new MO.SColor4(255,255,255,255);b.tickInterval=1;b.tickLength=.3;b.tickColor=new MO.SColor4(255,255,255,255);b.precisions=new MO.TObjects;b.assign=MO.SE3dRulerStyle_assign;return b};
MO.SE3dRulerStyle=function(b){this.lineColor.assign(b.lineColor);this.bothLength=b.bothLength;this.bothColor.assign(b.lineColor);this.tickInterval=b.tickInterval;this.tickLength=b.tickLength;this.tickColor.assign(b.lineColor);this.precisions.assign(b.precisions)};MO.FE3dBitmap=function(b){b=MO.Class.inherits(this,b,MO.FE3dFace);b.construct=MO.FE3dBitmap_construct;b.testReady=MO.FE3dBitmap_testReady;b.loadUrl=MO.FE3dBitmap_loadUrl;b.dispose=MO.FE3dBitmap_dispose;return b};MO.FE3dBitmap_construct=function(){this.__base.FE3dFace.construct.call(this)};
MO.FE3dBitmap_testReady=function(){if(!this._ready){var b=this._renderable;if(b){if(this._ready=b.testReady()){var d=b.size(),f=b.adjustSize(),h=this.matrix();h.sz=f.height/d.height;h.updateForce();d=new MO.SEvent(this);this.processLoadListener(d);d.dispose()}this._materialReference=b}}return this._ready};MO.FE3dBitmap_loadUrl=function(b){this._renderable=MO.Console.find(MO.FE3dBitmapConsole).loadDataByUrl(this,b);this._ready=!1};MO.FE3dBitmap_dispose=function(){this.__base.FE3dFace.dispose.call(this)};
MO.FE3dBitmapConsole=function(b){b=MO.Class.inherits(this,b,MO.FConsole);b._scopeCd=MO.EScope.Local;b._bitmaps=MO.Class.register(b,new MO.AGetter("_bitmaps"));b._bitmapDatas=MO.Class.register(b,new MO.AGetter("_bitmapDatas"));b._dataUrl="/cloud.resource.bitmap.wv";b.construct=MO.FE3dBitmapConsole_construct;b.loadByUrl=MO.FE3dBitmapConsole_loadByUrl;b.loadByGuid=MO.FE3dBitmapConsole_loadByGuid;b.loadDataByUrl=MO.FE3dBitmapConsole_loadDataByUrl;b.loadDataByGuid=MO.FE3dBitmapConsole_loadDataByGuid;b.dispose=
MO.FE3dBitmapConsole_dispose;return b};MO.FE3dBitmapConsole_construct=function(){this.__base.FConsole.construct.call(this);this._bitmaps=new MO.TDictionary;this._bitmapDatas=new MO.TDictionary};MO.FE3dBitmapConsole_loadByUrl=function(b,d){var f=this._bitmaps.get(d);if(f)return f;f=MO.Window.Browser.contentPath(d);MO.Logger.info(this,"Load bitmap from url. (url={1})",f);f=MO.Class.create(MO.FE3dBitmap);f.linkGraphicContext(b);f.setup();f.loadUrl(d);this._bitmaps.set(d,f);return f};
MO.FE3dBitmapConsole_loadByGuid=function(b,d){var f=MO.Window.Browser.hostPath(this._dataUrl+"?do=view&guid="+d);return this.loadByUrl(b,f)};MO.FE3dBitmapConsole_loadDataByUrl=function(b,d){var f=MO.Window.Browser.contentPath(d);MO.Logger.info(this,"Load bitmap data from url. (url={1})",f);f=this._bitmapDatas.get(d);f||(f=MO.Class.create(MO.FE3dBitmapData),f.linkGraphicContext(b),f.setup(),f.loadUrl(d),this._bitmapDatas.set(d,f));return f};
MO.FE3dBitmapConsole_loadDataByGuid=function(b,d){var f=MO.Window.Browser.hostPath(this._dataUrl+"?do=view&guid="+d);return this.loadDataByUrl(b,f)};MO.FE3dBitmapConsole_dispose=function(){this._bitmaps=MO.Lang.Object.dispose(this._bitmaps);this._bitmapDatas=MO.Lang.Object.dispose(this._bitmapDatas);this.__base.FConsole.dispose.call(this)};
MO.FE3dBitmapData=function(b){b=MO.Class.inherits(this,b,MO.FE3dFaceData);b._image=null;b.onImageLoad=MO.FE3dBitmapData_onImageLoad;b.construct=MO.FE3dBitmapData_construct;b.loadUrl=MO.FE3dBitmapData_loadUrl;b.dispose=MO.FE3dBitmapData_dispose;return b};
MO.FE3dBitmapData_onImageLoad=function(b){b=b.sender;var d=b.size(),f=d.width,d=d.height;this._size.set(f,d);var h=MO.Lang.Integer.pow2(f),q=MO.Lang.Integer.pow2(d);this._adjustSize.set(h,q);var w=MO.Console.find(MO.FE2dCanvasConsole),h=w.allocBySize(h,q);h.context().drawImage(b,0,0,f,d);this._texture.upload(h);w.free(h);b.dispose();this._ready=!0};MO.FE3dBitmapData_construct=function(){this.__base.FE3dFaceData.construct.call(this)};
MO.FE3dBitmapData_loadUrl=function(b){var d=MO.Class.create(MO.FImage);d.addLoadListener(this,this.onImageLoad);d.loadUrl(b);this._ready=!1};MO.FE3dBitmapData_dispose=function(){this.__base.FE3dFaceData.dispose.call(this)};
MO.EE3dBoundaryShape=function(b){b=MO.Class.inherits(this,b,MO.FObject,MO.MGraphicObject);b._optionSphere=!1;b._color=MO.Class.register(b,new MO.AGetter("_color"));b._polygons=MO.Class.register(b,new MO.AGetter("_polygons"));b._faceEffectCode=MO.Class.register(b,new MO.AGetSet("_faceEffectCode"));b._faceRenderable=MO.Class.register(b,new MO.AGetter("_faceRenderable"));b._borderEffectCode=MO.Class.register(b,new MO.AGetSet("_borderEffectCode"));b._borderRenderable=MO.Class.register(b,new MO.AGetter("_borderRenderable"));
b.construct=MO.EE3dBoundaryShape_construct;b.pushPolygon=MO.EE3dBoundaryShape_pushPolygon;b.buildFace=MO.EE3dBoundaryShape_buildFace;b.buildBorder=MO.EE3dBoundaryShape_buildBorder;b.build=MO.EE3dBoundaryShape_build;b.buildFlat=MO.EE3dBoundaryShape_buildFlat;b.buildSphere=MO.EE3dBoundaryShape_buildSphere;b.dispose=MO.EE3dBoundaryShape_dispose;return b};MO.EE3dBoundaryShape_construct=function(){this.__base.FObject.construct.call(this);this._color=new MO.SColor4(.3,.3,.3);this._polygons=new MO.TObjects};
MO.EE3dBoundaryShape_pushPolygon=function(b){this._polygons.push(b)};
MO.EE3dBoundaryShape_buildFace=function(){for(var b=this._graphicContext,d=this._polygons,f=d.count(),h=this._vertexTotal,q=this._indexTotal,w=0,z=0,A=new Float32Array(6*h),B=0,C=new Float32Array(4*h),D=0,q=new Uint32Array(q+6*h),E=0;E<f;E++){for(var F=d.at(E),H=F.positionCount(),I=F.positions(),J=0,G=0;G<H;G++){var K=I[J++],N=I[J++],M=K*MO.Lang.Const.DEGREE_RATE,L=N*MO.Lang.Const.DEGREE_RATE;A[z++]=Math.sin(M)*Math.cos(L);A[z++]=Math.sin(L);A[z++]=-Math.cos(M)*Math.cos(L);C[B++]=K/360+.5;C[B++]=
.5-N/180}F=F.indexes();I=F.length/3;for(G=0;G<I;G++)J=3*G,q[D++]=w+F[J+2],q[D++]=w+F[J+1],q[D++]=w+F[J];w+=H}K=w;for(E=0;E<f;E++)for(F=d.at(E),H=F.positionCount(),I=F.positions(),G=J=0;G<H;G++)M=I[J++]*MO.Lang.Const.DEGREE_RATE,L=I[J++]*MO.Lang.Const.DEGREE_RATE,A[z++]=Math.sin(M)*Math.cos(L)*.9,A[z++]=.9*Math.sin(L),A[z++]=-Math.cos(M)*Math.cos(L)*.9,C[B++]=M,C[B++]=L;for(E=w=0;E<f;E++){F=d.at(E);H=F.positionCount();for(G=0;G<H;G++)G==H-1?(q[D++]=w+G,q[D++]=w+0,q[D++]=w+G+K,q[D++]=w+0,q[D++]=w+K):
(q[D++]=w+G,q[D++]=w+G+1,q[D++]=w+G+K,q[D++]=w+G+1,q[D++]=w+G+K+1),q[D++]=w+G+K;w+=H}f=0;d=this.colorsData=new Uint8Array(8*h);w=2*h;for(G=0;G<w;G++)d[f++]=255,d[f++]=255,d[f++]=255,d[f++]=255;G=this._faceRenderable=MO.Class.create(MO.FE3dDataBox);G.linkGraphicContext(b);G.setOptionColor(!0);G.setOptionCoord(!0);G.setVertexCount(2*h);G.setup();G.color().setHex("#0a5294");G.vertexPositionBuffer().upload(A,12,2*h,!0);G.vertexColorBuffer().upload(d,4,2*h,!0);G.vertexCoordBuffer().upload(C,8,2*h,!0);
G.indexBuffer().setStrideCd(MO.EG3dIndexStride.Uint32);G.indexBuffer().upload(q,D,!0)};
MO.EE3dBoundaryShape_buildBorder=function(){for(var b=this._graphicContext,d=this._polygons,f=d.count(),h=this._vertexTotal,q=0,w=0,z=new Float32Array(6*h),A=0,B=new Uint32Array(2*h+2*h),C=0;C<f;C++){for(var D=d.at(C),E=D.positionCount(),F=D.positions(),H=0,D=0;D<E;D++){var I=F[H++]/180*Math.PI,J=F[H++]/180*Math.PI;z[w++]=Math.sin(I)*Math.cos(J)*1.001;z[w++]=1.001*Math.sin(J);z[w++]=-Math.cos(I)*Math.cos(J)*1.001}for(D=0;D<E;D++)B[A++]=q+D,D==E-1?B[A++]=q:B[A++]=q+D+1;q+=E}for(var G=q,C=0;C<f;C++){D=
d.at(C);E=D.positionCount();F=D.positions();for(D=H=0;D<E;D++)I=F[H++]/180*Math.PI,J=F[H++]/180*Math.PI,z[w++]=Math.sin(I)*Math.cos(J)*.98,z[w++]=.98*Math.sin(J),z[w++]=-Math.cos(I)*Math.cos(J)*.98;q+=E}for(C=q=0;C<f;C++){D=d.at(C);E=D.positionCount();for(D=0;D<E;D++)B[A++]=q+D,B[A++]=q+D+G;q+=E}f=0;d=this.colorsData=new Uint8Array(8*h);for(D=0;D<h;D++)d[f++]=34,d[f++]=169,d[f++]=255,d[f++]=255;for(D=0;D<h;D++)d[f++]=150,d[f++]=176,d[f++]=214,d[f++]=255;D=this._borderRenderable=MO.Class.create(MO.FE3dDataBox);
D.linkGraphicContext(b);D.setup();D.setVertexCount(2*h);D.vertexPositionBuffer().upload(z,12,2*h,!0);D.vertexColorBuffer().upload(d,4,2*h,!0);D.indexBuffer().setDrawModeCd(MO.EG3dDrawMode.Lines);D.indexBuffer().setStrideCd(MO.EG3dIndexStride.Uint32);D.indexBuffer().setLineWidth(1);D.indexBuffer().upload(B,A,!0);D.material().info().effectCode="eai.map.face"};
MO.EE3dBoundaryShape_build=function(b){for(var d=0,f=0,h=this._polygons,q=h.count(),w=0;w<q;w++)var z=h.at(w),d=d+z.positionCount(),f=f+z.indexes().length;this._vertexTotal=d;this._indexTotal=f;this.buildFace(b);this.buildBorder(b)};MO.EE3dBoundaryShape_buildFlat=function(b){this._optionSphere=!1;this.build(b)};MO.EE3dBoundaryShape_buildSphere=function(b){this._optionSphere=!0;this.build(b)};MO.EE3dBoundaryShape_dispose=function(){this._polygons=MO.Lang.Obejct.dispose(this._polygons);this.__base.FObject.dispose.call(this)};
MO.FE3dBoundBox=function(b){b=MO.Class.inherits(this,b,MO.FE3dRenderable);b._outline=MO.Class.create(b,new MO.AGetter("_outline"));b._rate=.2;b._vertexPositionBuffer=null;b._vertexColorBuffer=null;b.construct=MO.FE3dBoundBox_construct;b.setup=MO.FE3dBoundBox_setup;b.upload=MO.FE3dBoundBox_upload;return b};MO.FE3dBoundBox_construct=function(){this.__base.FE3dRenderable.construct.call(this);this._material=MO.Class.create(MO.FE3dMaterial);this._outline=new MO.SOutline3};
MO.FE3dBoundBox_setup=function(){var b=this._graphicContext,d=this._vertexPositionBuffer=b.createVertexBuffer();d.setCode("position");d.setFormatCd(MO.EG3dAttributeFormat.Float3);this.pushVertexBuffer(d);for(var f=new Uint8Array(128),d=127;0<=d;d--)f[d]=255;d=this._vertexColorBuffer=b.createVertexBuffer();d.setCode("color");d.setFormatCd(MO.EG3dAttributeFormat.Byte4Normal);d.upload(f,4,32);this.pushVertexBuffer(d);this._vertexCount=32;d=this._indexBuffer=b.createIndexBuffer();d.setDrawModeCd(MO.EG3dDrawMode.Lines);
d.setLineWidth(1);d.upload([0,1,0,4,0,12,3,2,3,5,3,13,8,6,8,9,8,14,11,7,11,10,11,15,20,16,20,21,20,24,23,17,23,22,23,25,28,18,28,26,28,29,31,19,31,27,31,30],48);this.pushIndexBuffer(d);this.update();b=this.material().info();b.effectCode="control";b.ambientColor.set(1,1,1,1)};
MO.FE3dBoundBox_upload=function(){var b=this._outline,d=b.max,f=d.x,h=d.y,d=d.z,q=b.min,b=q.x,w=q.y,q=q.z,z=this._rate,A=(f-b)*z,B=(h-w)*z,z=(d-q)*z;this._vertexPositionBuffer.upload([b,h,q,b+A,h,q,f-A,h,q,f,h,q,b,h-B,q,f,h-B,q,b,w+B,q,f,w+B,q,b,w,q,b+A,w,q,f-A,w,q,f,w,q,b,h,q+z,f,h,q+z,b,w,q+z,f,w,q+z,b,h,d-z,f,h,d-z,b,w,d-z,f,w,d-z,b,h,d,b+A,h,d,f-A,h,d,f,h,d,b,h-B,d,f,h-B,d,b,w+B,d,f,w+B,d,b,w,d,b+A,w,d,f-A,w,d,f,w,d],12,32)};
MO.FE3dCube=function(b){b=MO.Class.inherits(this,b,MO.FE3dRenderable);b.vertexPositionBuffer=null;b.vertexColorBuffer=null;b.indexBuffer=null;b.setup=MO.FE3dCube_setup;return b};
MO.FE3dCube_setup=function(b){var d=this.vertexPositionBuffer=b.createVertexBuffer();d.upload([-1,1,-1,1,1,-1,1,-1,-1,-1,-1,-1,-1,1,1,1,1,1,1,-1,1,-1,-1,1],12,8);this.pushVertexBuffer(d);d=this.vertexColorBuffer=b.createVertexBuffer();d.upload([0,1,0,1,1,0,0,1,1,0,0,1,0,0,0,1,0,1,0,1,1,0,1,1,1,0,1,1,0,0,1,1],16,8);this.pushVertexBuffer(d);d=context.createIndexBuffer();d.upload([0,1,2,0,2,3,1,5,6,1,6,2,5,4,7,5,7,6,4,0,3,4,3,7,0,4,5,0,5,1,3,2,6,3,6,7],36);this.pushIndexBuffer(d);b=this.material().info();
b.effectCode="control";b.ambientColor.set(1,1,1,1)};
MO.FE3dDataBox=function(b){b=MO.Class.inherits(this,b,MO.FE3dRenderable,MO.ME3dDynamicRenderable);b._optionColor=MO.Class.register(b,new MO.AGetSet("_optionColor"),!0);b._optionCoord=MO.Class.register(b,new MO.AGetSet("_optionCoord"),!1);b._optionNormal=MO.Class.register(b,new MO.AGetSet("_optionNormal"),!1);b._vertexPositionBuffer=MO.Class.register(b,new MO.AGetter("_vertexPositionBuffer"));b._vertexColorBuffer=MO.Class.register(b,new MO.AGetter("_vertexColorBuffer"));b._vertexCoordBuffer=MO.Class.register(b,
new MO.AGetter("_vertexCoordBuffer"));b._vertexNormalBuffer=MO.Class.register(b,new MO.AGetter("_vertexNormalBuffer"));b._indexBuffer=MO.Class.register(b,new MO.AGetter("_indexBuffer"));b.construct=MO.FE3dDataBox_construct;b.setup=MO.FE3dDataBox_setup;b.dispose=MO.FE3dDataBox_dispose;return b};MO.FE3dDataBox_construct=function(){this.__base.FE3dRenderable.construct.call(this);this.__base.ME3dDynamicRenderable.construct.call(this);this._material=MO.Class.create(MO.FE3dMaterial)};
MO.FE3dDataBox_setup=function(b,d,f){b=this._graphicContext;d=this._vertexPositionBuffer=b.createVertexBuffer();d.setCode("position");d.setFormatCd(MO.EG3dAttributeFormat.Float3);this.pushVertexBuffer(d);this._optionColor&&(d=this._vertexColorBuffer=b.createVertexBuffer(),d.setCode("color"),d.setFormatCd(MO.EG3dAttributeFormat.Byte4Normal),this.pushVertexBuffer(d));this._optionCoord&&(d=this._vertexCoordBuffer=b.createVertexBuffer(),d.setCode("coord"),d.setFormatCd(MO.EG3dAttributeFormat.Float2),
this.pushVertexBuffer(d));this._optionNormal&&(d=this._vertexNormalBuffer=b.createVertexBuffer(),d.setCode("normal"),d.setFormatCd(MO.EG3dAttributeFormat.Byte4Normal),this.pushVertexBuffer(d));d=this._indexBuffer=b.createIndexBuffer();this.pushIndexBuffer(d);b=this.material().info();b.effectCode="control";b.ambientColor.set(1,1,1,1)};MO.FE3dDataBox_dispose=function(){this._material=MO.Class.create(MO.FE3dMaterial);this.__base.ME3dDynamicRenderable.dispose.call(this);this.__base.FE3dRenderable.dispose.call(this)};
MO.FE3dDimensional=function(b){b=MO.Class.inherits(this,b,MO.FE3dRenderable);b._cellSize=null;b._size=null;b._lineColor=null;b._lineCenterColor=null;b._vertexPositionBuffer=null;b._vertexColorBuffer=null;b.construct=MO.FE3dDimensional_construct;b.setup=MO.FE3dDimensional_setup;return b};
MO.FE3dDimensional_construct=function(){this.__base.FE3dRenderable.construct.call(this);this._material=MO.Class.create(MO.FE3dMaterial);this._cellSize=new MO.SSize2;this._cellSize.set(1,1);this._size=new MO.SSize2;this._size.set(16,16)};
MO.FE3dDimensional_setup=function(){for(var b=this._graphicContext,d=this._cellSize.width,f=this._cellSize.height,h=this._size.width,q=h/2,w=this._size.height,z=w/2,A=2*(h+2+(w+2)),B=0,C=0,D=new Float32Array(3*A),E=0,F=new Uint8Array(4*A),H=0,I=new Uint16Array(A),J=0;J<=w;J++){var G=1;0==J-z&&(G=0);D[B++]=d*-q*G;D[B++]=0;D[B++]=f*(J-z);D[B++]=d*q*G;D[B++]=0;D[B++]=f*(J-z);for(G=0;8>G;G++)F[E++]=255;I[H++]=C++;I[H++]=C++}D[B++]=d*-q;D[B++]=0;D[B++]=0;D[B++]=d*q;D[B++]=0;for(G=D[B++]=0;2>G;G++)F[E++]=
255,F[E++]=0,F[E++]=0,F[E++]=255;I[H++]=C++;I[H++]=C++;for(w=0;w<=h;w++){G=1;0==w-q&&(G=0);D[B++]=d*(w-q);D[B++]=0;D[B++]=f*-z*G;D[B++]=d*(w-q);D[B++]=0;D[B++]=f*z*G;for(G=0;8>G;G++)F[E++]=255;I[H++]=C++;I[H++]=C++}D[B++]=0;D[B++]=0;D[B++]=f*-z;D[B++]=0;D[B++]=0;D[B++]=f*z;for(G=0;2>G;G++)F[E++]=255,F[E++]=0,F[E++]=0,F[E++]=255;I[H++]=C++;I[H++]=C++;this._vertexCount=A;d=this._vertexPositionBuffer=b.createVertexBuffer();d.setCode("position");d.setFormatCd(MO.EG3dAttributeFormat.Float3);d.upload(D,
12,A);this.pushVertexBuffer(d);d=this._vertexColorBuffer=b.createVertexBuffer();d.setCode("color");d.setFormatCd(MO.EG3dAttributeFormat.Byte4Normal);d.upload(F,4,A);this.pushVertexBuffer(d);d=b.createIndexBuffer();d.setDrawModeCd(MO.EG3dDrawMode.Lines);d.upload(I,A);this.pushIndexBuffer(d);b=this.material().info();b.effectCode="control";b.ambientColor.set(1,1,1,1)};
MO.FE3dDynamicMesh=function(b){b=MO.Class.inherits(this,b,MO.FE3dRenderable);b._shape=MO.Class.register(b,new MO.AGetSet("_shape"));b._optionMerge=!0;b._vertexPosition=0;b._vertexTotal=0;b._indexPosition=0;b._indexTotal=0;b._mergeRenderables=MO.Class.register(b,new MO.AGetter("_mergeRenderables"));b.construct=MO.FE3dDynamicMesh_construct;b.mergeCount=MO.FE3dDynamicMesh_mergeCount;b.mergeMaxCount=MO.FE3dDynamicMesh_mergeMaxCount;b.mergeStride=MO.FE3dDynamicMesh_mergeStride;b.syncVertexBuffer=MO.FE3dDynamicMesh_syncVertexBuffer;
b.mergeRenderable=MO.FE3dDynamicMesh_mergeRenderable;b.mergeVertexBuffer=MO.FE3dDynamicMesh_mergeVertexBuffer;b.mergeIndexBuffer=MO.FE3dDynamicMesh_mergeIndexBuffer;b.build=MO.FE3dDynamicMesh_build;b.dispose=MO.FE3dDynamicMesh_dispose;return b};MO.FE3dDynamicMesh_construct=function(){this.__base.FE3dRenderable.construct.call(this);this._mergeRenderables=new MO.TObjects};MO.FE3dDynamicMesh_mergeCount=function(){return this._mergeRenderables.count()};MO.FE3dDynamicMesh_mergeMaxCount=function(){return this._shape.mergeMaxCount()};
MO.FE3dDynamicMesh_mergeStride=function(){return this._shape.mergeStride()};
MO.FE3dDynamicMesh_syncVertexBuffer=function(b){var d=b.code(),f=this._vertexBuffers.get(d);if(!f){var h=b.formatCd(),q=this._vertexTotal,f=this._graphicContext.createVertexBuffer();f.setCode(d);f.setFormatCd(h);f.setStride(b.stride());b=null;switch(h){case MO.EG3dAttributeFormat.Float1:b=new Float32Array(1*q);break;case MO.EG3dAttributeFormat.Float2:b=new Float32Array(2*q);break;case MO.EG3dAttributeFormat.Float3:b=new Float32Array(3*q);break;case MO.EG3dAttributeFormat.Float4:b=new Float32Array(4*
q);break;case MO.EG3dAttributeFormat.Byte4:case MO.EG3dAttributeFormat.Byte4Normal:b=new Uint8Array(4*q);break;default:throw new MO.TError("Unknown code");}f.setData(b);this.pushVertexBuffer(f)}return f};
MO.FE3dDynamicMesh_mergeRenderable=function(b){var d=this._graphicContext.capability(),f=b.vertexCount(),h=b.indexBuffers().first().count(),q=d.mergeCount;if(this._mergeRenderables.count()>=q)return!1;q=this._vertexTotal+f;if(d.optionIndex32){if(q>MO.Lang.Integer.MAX_UINT32)return!1}else if(q>MO.Lang.Integer.MAX_UINT16)return!1;this._vertexTotal+=f;this._indexTotal+=h;this._mergeRenderables.push(b);return!0};
MO.FE3dDynamicMesh_mergeVertexBuffer=function(b){var d=this._vertexPosition,f=b.count(),h=b.formatCd(),q=b.stride(),w=b.data();b=this.syncVertexBuffer(b).data();switch(h){case MO.EG3dAttributeFormat.Float1:case MO.EG3dAttributeFormat.Float2:case MO.EG3dAttributeFormat.Float3:case MO.EG3dAttributeFormat.Float4:MO.Lang.Float.copy(b,q/4*d,w,0,q/4*f);break;case MO.EG3dAttributeFormat.Byte4:case MO.EG3dAttributeFormat.Byte4Normal:MO.Lang.Byte.copy(b,q*d,w,0,q*f);break;default:throw new MO.TError("Unknown code");
}};MO.FE3dDynamicMesh_mergeIndexBuffer=function(b){var d=this._vertexPosition,f=this._indexPosition,h=b.drawModeCd(),q=b.data(),w=this._indexBuffer.data();b=b.count();for(var z=0;z<b;z++)w[f++]=d+q[z];this._indexBuffer.setDrawModeCd(h)};
MO.FE3dDynamicMesh_build=function(){var b=this._graphicContext,d=b.capability(),f=this._vertexTotal,h=this._indexTotal,q=this._mergeRenderables,w=q.count(),z=q.first();this._material=z.material();this._textures=z.textures();var A=new Float32Array(f),z=this._instanceVertexBuffer=b.createVertexBuffer();z.setCode("instance");z.setStride(4);z.setFormatCd(MO.EG3dAttributeFormat.Float1);z.setData(A);this.pushVertexBuffer(z);b=this._indexBuffer=b.createIndexBuffer(MO.FE3rIndexBuffer);d.optionIndex32?(b.setStrideCd(MO.EG3dIndexStride.Uint32),
b.setData(new Uint32Array(h))):(b.setStrideCd(MO.EG3dIndexStride.Uint16),b.setData(new Uint16Array(h)));b.setCount(h);this.pushIndexBuffer(b);for(d=0;d<w;d++){var z=q.at(d),B=z.vertexCount();MO.Lang.Float.fill(A,this._vertexPosition,B,d);for(var C=z.vertexBuffers(),D=C.count(),E=0;E<D;E++){var F=C.at(E);this.mergeVertexBuffer(F)}z=z.indexBuffers().first();C=z.count();this.mergeIndexBuffer(z);this._vertexPosition+=B;this._indexPosition+=C}C=this._vertexBuffers;D=C.count();for(E=0;E<D;E++)F=C.at(E),
q=F.data(),w=F.stride(),F.upload(q,w,f),F.setData(null);f=b.data();b.upload(f,h);b.setData(null)};MO.FE3dDynamicMesh_dispose=function(){this._mergeRenderables=MO.Lang.Object.dispose(this._mergeRenderables);this.__base.FE3dRenderable.dispose.call(this)};
MO.FE3dDynamicShape=function(b){b=MO.Class.inherits(this,b,MO.FE3dDisplay);b._mergeMaxCount=MO.Class.register(b,new MO.AGetter("_mergeMaxCount"));b._mergeStride=MO.Class.register(b,new MO.AGetter("_mergeStride"),4);b._sourceRenderables=MO.Class.register(b,new MO.AGetter("_sourceRenderables"));b._meshes=MO.Class.register(b,new MO.AGetter("_meshes"));b.construct=MO.FE3dDynamicShape_construct;b.createMesh=MO.FE3dDynamicShape_createMesh;b.pushMergeRenderable=MO.FE3dDynamicShape_pushMergeRenderable;b.build=
MO.FE3dDynamicShape_build;b.dispose=MO.FE3dDynamicShape_dispose;return b};MO.FE3dDynamicShape_construct=function(){this.__base.FE3dDisplay.construct.call(this);this._sourceRenderables=new MO.TObjects;this._meshes=new MO.TObjects;this._material=MO.Class.create(MO.FE3dMaterial)};MO.FE3dDynamicShape_createMesh=function(){var b=MO.Class.create(MO.FE3dDynamicMesh);b.linkGraphicContext(this);b.setShape(this);this._meshes.push(b);this.pushRenderable(b);return b};MO.FE3dDynamicShape_pushMergeRenderable=function(b){this._sourceRenderables.push(b)};
MO.FE3dDynamicShape_build=function(){var b=this._sourceRenderables,d=this.renderables(),f=b.count();if(0<f)for(var h=this.createMesh(),q=0;q<f;q++){var w=b.at(q);if(!h.mergeRenderable(w)&&(h=this.createMesh(),!h.mergeRenderable(w)))throw new MO.TError(this,"Merge renderable failure.");}b=0;f=d.count();for(q=0;q<f;q++)h=d.at(q),h.build(),b=Math.max(b,h.mergeCount());this._mergeMaxCount=b};
MO.FE3dDynamicShape_dispose=function(){this._sourceRenderables=MO.Lang.Object.dispose(this._sourceRenderables);this._meshes=MO.Lang.Object.dispose(this._meshes);this.__base.FE3dDisplay.dispose.call(this)};
MO.FE3dFace=function(b){b=MO.Class.inherits(this,b,MO.FE3dMeshRenderable,MO.MListener);b._ready=!1;b._size=MO.Class.register(b,new MO.AGetter("_size"));b._loadListeners=MO.Class.register(b,new MO.AListener("_loadListeners",MO.EEvent.Load));b._statusDirty=!0;b.construct=MO.FE3dFace_construct;b.setSize=MO.FE3dFace_setSize;b.setData=MO.FE3dFace_setData;b.findVertexBuffer=MO.FE3dFace_findVertexBuffer;b.vertexBuffers=MO.FE3dFace_vertexBuffers;b.findTexture=MO.FE3dFace_findTexture;b.textures=MO.FE3dFace_textures;
b.material=MO.FE3dFace_material;b.dirty=MO.FE3dFace_dirty;b.processLoad=MO.FE3dFace_processLoad;b.process=MO.FE3dFace_process;b.dispose=MO.FE3dFace_dispose;return b};MO.FE3dFace_construct=function(){this.__base.FE3dMeshRenderable.construct.call(this);this._size=new MO.SSize2};MO.FE3dFace_setSize=function(b,d){this._size.set(b,d);this._matrix.setScale(b,d,1)};MO.FE3dFace_setData=function(b){this._renderable=b};MO.FE3dFace_findVertexBuffer=function(b){return this._renderable.findVertexBuffer(b)};
MO.FE3dFace_vertexBuffers=function(){return this._renderable.vertexBuffers()};MO.FE3dFace_findTexture=function(b){return this._renderable.findTexture(b)};MO.FE3dFace_textures=function(){return this._renderable.textures()};MO.FE3dFace_material=function(){return this._renderable.material()};MO.FE3dFace_dirty=function(){this._statusDirty=!0};MO.FE3dFace_processLoad=function(){return!0};MO.FE3dFace_process=function(){this.__base.FE3dMeshRenderable.process.call(this)};
MO.FE3dFace_dispose=function(){this._material=RObject.dispoe(this._material);this.__base.FE3dMeshRenderable.dispose.call(this)};
MO.FE3dFaceData=function(b){b=MO.Class.inherits(this,b,MO.FE3dRenderable);b._ready=!1;b._optionCenter=MO.Class.register(b,new MO.AGetSet("_optionCenter"),!1);b._size=MO.Class.register(b,new MO.AGetter("_size"));b._adjustSize=MO.Class.register(b,new MO.AGetter("_adjustSize"));b._vertexPositionBuffer=null;b._vertexCoordBuffer=null;b._indexBuffer=null;b._texture=null;b.construct=MO.FE3dFaceData_construct;b.testReady=MO.FE3dFaceData_testReady;b.setup=MO.FE3dFaceData_setup;b.dispose=MO.FE3dFaceData_dispose;
return b};MO.FE3dFaceData_construct=function(){this.__base.FE3dRenderable.construct.call(this);this._size=new MO.SSize2;this._adjustSize=new MO.SSize2;this._material=MO.Class.create(MO.FE3dMaterial)};MO.FE3dFaceData_testReady=function(){return this._ready};
MO.FE3dFaceData_setup=function(){var b=this._graphicContext;this._vertexCount=4;var d=null,d=this._optionCenter?[-1,1,0,1,1,0,1,-1,0,-1,-1,0]:[0,0,0,1,0,0,1,-1,0,0,-1,0],f=this._vertexPositionBuffer=b.createVertexBuffer();f.setCode("position");f.setFormatCd(MO.EG3dAttributeFormat.Float3);f.upload(d,12,4);var h=MO.Class.create(MO.FE3sStream);h.setCode("position");h.setDataCount(4);h.setData(d);f._resource=h;this.pushVertexBuffer(f);d=[0,1,1,1,1,0,0,0];f=this._vertexCoordBuffer=b.createVertexBuffer();
f.setCode("coord");f.setFormatCd(MO.EG3dAttributeFormat.Float2);f.upload(d,8,4);h=MO.Class.create(MO.FE3sStream);h.setCode("coord");h.setDataCount(4);h.setData(d);f._resource=h;this.pushVertexBuffer(f);d=[0,1,2,0,2,3];f=this._indexBuffer=b.createIndexBuffer();f.upload(d,6);h=MO.Class.create(MO.FE3sStream);h.setCode("index16");h.setDataCount(2);h.setData(d);f._resource=h;this.pushIndexBuffer(f);b=this._texture=b.createFlatTexture();b.setOptionFlipY(!0);b.setWrapCd(MO.EG3dSamplerFilter.ClampToEdge,
MO.EG3dSamplerFilter.ClampToEdge);this.pushTexture(b,"diffuse");this._material.info().optionDouble=!0;this._material._textures=this._textures};
MO.FE3dFaceData_dispose=function(){this._size=MO.Lang.Object.dispose(this._size);this._adjustSize=MO.Lang.Object.dispose(this._adjustSize);this._texture=MO.Lang.Object.dispose(this._texture);this._vertexPositionBuffer=MO.Lang.Object.dispose(this._vertexPositionBuffer);this._vertexCoordBuffer=MO.Lang.Object.dispose(this._vertexCoordBuffer);this._indexBuffer=MO.Lang.Object.dispose(this._indexBuffer);this.__base.FE3dRenderable.dispose.call(this)};
MO.FE3dPolygon=function(b){return b=MO.Class.inherits(this,b,MO.FE3dRenderable)};MO.FE3dRectangle=function(b){b=MO.Class.inherits(this,b,MO.FE3dRenderable);b._vertexPositionBuffer=null;b._vertexColorBuffer=null;b._indexBuffer=null;b.setup=MO.FE3dRectangle_setup;return b};
MO.FE3dRectangle_setup=function(b){var d=this._vertexPositionBuffer=b.createVertexBuffer();d.upload([-1,1,0,1,1,0,1,-1,0,-1,-1,0],12,4);this.pushVertexBuffer(d);d=this._vertexColorBuffer=b.createVertexBuffer();d.upload([0,1,0,1,1,0,0,1,1,0,0,1,0,0,0,1],16,4);this.pushVertexBuffer(d);d=context.createIndexBuffer();d.upload([0,1,2,0,2,3],6);this.pushIndexBuffer(d)};
MO.FE3dRuler=function(b){b=MO.Class.inherits(this,b,MO.FE3dRenderable);b._style=MO.Class.register(b,new MO.AGetter("_style"));b._beginPoint=MO.Class.register(b,new MO.AGetter("_beginPoint"));b._endPoint=MO.Class.register(b,new MO.AGetter("_endPoint"));b._direction=MO.Class.register(b,new MO.AGetter("_direction"));b._directionLine=null;b._vertexPositionBuffer=null;b._vertexColorBuffer=null;b._vertexPositionData=null;b._vertexColorData=null;b._indexData=null;b.construct=MO.FE3dRuler_construct;b.setup=
MO.FE3dRuler_setup;b.upload=MO.FE3dRuler_upload;return b};MO.FE3dRuler_construct=function(){this.__base.FE3dRenderable.construct.call(this);this._material=MO.Class.create(MO.FE3dMaterial);this._style=new MO.SE3dRulerStyle;this._beginPoint=new MO.SPoint3(0,0,0);this._endPoint=new MO.SPoint3(0,10,0);this._direction=new MO.SVector3(1,0,0);this._directionLine=new MO.SVector3;this._vertexPositionData=new MO.TArray;this._vertexColorData=new MO.TArray;this._indexData=new MO.TArray};
MO.FE3dRuler_setup=function(){var b=this._graphicContext,d=this._vertexPositionBuffer=b.createVertexBuffer();d.setCode("position");d.setFormatCd(MO.EG3dAttributeFormat.Float3);this.pushVertexBuffer(d);d=this._vertexColorBuffer=b.createVertexBuffer();d.setCode("color");d.setFormatCd(MO.EG3dAttributeFormat.Byte4Normal);this.pushVertexBuffer(d);b=this._indexBuffer=b.createIndexBuffer();b.setFillModeCd(MO.EG3dFillMode.Line);b.setLineWidth(1);this.pushIndexBuffer(b);this.upload();this.update();b=this.material().info();
b.effectCode="control";b.ambientColor.set(1,1,1,1)};
MO.FE3dRuler_upload=function(){var b=0,d=this._style,f=this._vertexPositionData;f.clear();var h=this._vertexColorData;h.clear();var q=this._indexData;q.clear();var w=this._beginPoint,z=this._endPoint;f.push(w.x,w.y,w.z);h.push(255,255,255,255);b++;f.push(z.x,z.y,z.z);h.push(255,255,255,255);b++;q.push(0,1);var A=d.bothLength,B=d.bothColor,C=this._direction,D=new SPoint3,E=new SPoint3;f.push(w.x,w.y,w.z);h.push(B.red,B.green,B.blue,B.alpha);E.x=C.x*A+w.x;E.y=C.y*A+w.y;E.z=C.z*A+w.z;f.push(E.x,E.y,
E.z);h.push(B.red,B.green,B.blue,B.alpha);q.push(b,b+1);b+=2;f.push(z.x,z.y,z.z);h.push(B.red,B.green,B.blue,B.alpha);E.x=C.x*A+z.x;E.y=C.y*A+z.y;E.z=C.z*A+z.z;f.push(E.x,E.y,E.z);h.push(B.red,B.green,B.blue,B.alpha);q.push(b,b+1);b+=2;z=this._directionLine.direction(w,this._endPoint);A=z.length();z.normalize();for(var d=d.precisions,B=d.count(),F=0;F<B;F++)for(var H=d.at(F),I=H.interval,J=H.length,H=H.color,G=I;G<A;G+=I)D.x=z.x*G+w.x,D.y=z.y*G+w.y,D.z=z.z*G+w.z,f.push(D.x,D.y,D.z),h.push(H.red,H.green,
H.blue,H.alpha),E.x=C.x*J+D.x,E.y=C.y*J+D.y,E.z=C.z*J+D.z,f.push(E.x,E.y,E.z),h.push(H.red,H.green,H.blue,H.alpha),q.push(b,b+1),b+=2;this._vertexPositionBuffer.upload(f.memory(),12,b);this._vertexColorBuffer.upload(h.memory(),4,b);indexBuffer.upload(q.memory(),q.length())};
MO.FE3dRulerBox=function(b){b=MO.Class.inherits(this,b,MO.FE3dSprite);b._outline=MO.Class.register(b,new MO.AGetter("_outline"));b._style=MO.Class.register(b,new MO.AGetter("_style"));b._rulerX=null;b._rulerY=null;b._rulerZ=null;b.construct=MO.FE3dRulerBox_construct;b.setup=MO.FE3dRulerBox_setup;b.upload=MO.FE3dRulerBox_upload;return b};
MO.FE3dRulerBox_construct=function(){this.__base.FE3dSprite.construct.call(this);this._material=MO.Class.create(MO.FE3dMaterial);this._style=new SE3dRulerStyle;this._outline=new MO.SOutline3;var b=this._rulerX=MO.Class.create(MO.FE3dRuler);this.pushRenderable(b);b=this._rulerY=MO.Class.create(MO.FE3dRuler);this.pushRenderable(b);b=this._rulerZ=MO.Class.create(MO.FE3dRuler);this.pushRenderable(b)};
MO.FE3dRulerBox_setup=function(){var b=this._graphicContext,d=this._style;this.matrix().setScaleAll(.1);this.matrix().update();var f=this._outline,h=f.min,f=f.max,q=this._rulerX;q.linkGraphicContext(b);q.style().assign(d);q.beginPoint().assign(h);q.endPoint().set(f.x,h.y,h.z);q.direction().set(0,0,-1);q.setup();q=this._rulerY;q.linkGraphicContext(b);q.style().assign(d);q.beginPoint().assign(h);q.endPoint().set(h.x,f.y,h.z);q.direction().set(-1,0,0);q.setup();q=this._rulerZ;q.linkGraphicContext(b);
q.style().assign(d);q.beginPoint().assign(h);q.endPoint().set(h.x,h.y,f.z);q.direction().set(-1,0,0);q.setup()};MO.FE3dRulerBox_upload=function(){this._rulerX.upload();this._rulerY.upload();this._rulerZ.upload()};MO.FE3dShape=function(b){b=MO.Class.inherits(this,b,MO.FE3dFace);b._ready=!0;b.construct=MO.FE3dShape_construct;b.dispose=MO.FE3dShape_dispose;return b};MO.FE3dShape_construct=function(){this.__base.FE3dFace.construct.call(this)};MO.FE3dShape_dispose=function(){this.__base.FE3dFace.dispose.call(this)};
MO.FE3dShapeConsole=function(b){b=MO.Class.inherits(this,b,MO.FConsole);b._scopeCd=MO.EScope.Local;b._bitmaps=MO.Class.register(b,new MO.AGetter("_bitmaps"));b.construct=MO.FE3dShapeConsole_construct;b.load=MO.FE3dShapeConsole_load;b.loadUrl=MO.FE3dShapeConsole_loadUrl;return b};MO.FE3dShapeConsole_construct=function(){this.__base.FConsole.construct.call(this);this._bitmaps=new MO.TDictionary};
MO.FE3dShapeConsole_load=function(b,d,f){var h=d+"|"+f,q=this._bitmaps.get(h);if(q)return q;d=MO.Window.Browser.hostPath(this._dataUrl+"?guid="+d+"&code="+f);MO.Logger.info(this,"Load bitmap. (url={1})",d);q="environment"==f?MO.Class.create(MO.FE3rBitmapCubePack):MO.Class.create(MO.FE3rBitmapFlatPack);q.linkGraphicContext(b);q.loadUrl(d);this._bitmaps.set(h,q);return q};
MO.FE3dShapeConsole_loadUrl=function(b,d){var f=this._bitmaps.get(d);if(f)return f;f=MO.Window.Browser.contentPath(d);MO.Logger.info(this,"Load bitmap from url. (url={1})",f);f=MO.Class.create(MO.FE3dBitmapData);f.linkGraphicContext(b);f.setup();f.loadUrl(d);this._bitmaps.set(d,f);return f};
MO.FE3dShapeData=function(b){b=MO.Class.inherits(this,b,MO.FE3dFaceData);b._graphic=null;b._texture=null;b.construct=MO.FE3dShapeData_construct;b.beginDraw=MO.FE3dShapeData_beginDraw;b.endDraw=MO.FE3dShapeData_endDraw;b.dispose=MO.FE3dShapeData_dispose;return b};MO.FE3dShapeData_construct=function(){this.__base.FE3dFaceData.construct.call(this)};
MO.FE3dShapeData_beginDraw=function(){var b=this._size,d=MO.Lang.Integer.pow2(b.width),b=MO.Lang.Integer.pow2(b.height);this._adjustSize.set(d,b);return this._graphic=(this._canvas=MO.Console.find(FE2dCanvasConsole).allocBySize(d,b)).context()};MO.FE3dShapeData_endDraw=function(){this._texture.upload(this._canvas);MO.Console.find(MO.FE2dCanvasConsole).free(this._canvas);this._graphic=this._canvas=null;this._ready=!0};MO.FE3dShapeData_dispose=function(){this.__base.FE3dFaceData.dispose.call(this)};
MO.FE3dSphere=function(b){b=MO.Class.inherits(this,b,MO.FE3dRenderable);b._outline=null;b._splitCount=MO.Class.register(b,new MO.AGetSet("_splitCount"),8);b._vertexPositionBuffer=null;b._vertexColorBuffer=null;b.construct=MO.FE3dSphere_construct;b.setup=MO.FE3dSphere_setup;return b};MO.FE3dSphere_construct=function(){this.__base.FE3dRenderable.construct.call(this);this._material=MO.Class.create(MO.FE3dMaterial);this._outline=new MO.SOutline3};
MO.FE3dSphere_setup=function(){for(var b=this._graphicContext,d=new MO.TArray,f=new MO.TArray,h=2*this._splitCount,q=this._splitCount,w=2*Math.PI/h,z=Math.PI/q,A=0,B=0;B<=q;B++)for(var C=0;C<h;C++){var D=w*C-Math.PI,E=z*B-MO.RConst.PI_2,F=Math.sin(D)*Math.cos(E),H=Math.sin(E),D=-Math.cos(D)*Math.cos(E);d.push(F,H,D);f.push(F,H,D);A++}this._vertexCount=A;B=this._vertexPositionBuffer=b.createVertexBuffer();B.setCode("position");B.setFormatCd(MO.EG3dAttributeFormat.Float3);B.upload(new Float32Array(d.memory()),
12,A);this.pushVertexBuffer(B);B=this._vertexColorBuffer=b.createVertexBuffer();B.setCode("normal");B.setFormatCd(MO.EG3dAttributeFormat.Float3);B.upload(new Float32Array(f.memory()),12,A);this.pushVertexBuffer(B);d=new MO.TArray;for(B=0;B<q;B++)for(C=0;C<h;C++)f=h*B,A=f+C,w=f+C+h,C==h-1?(d.push(A,w,f),d.push(w,f+h,f)):(d.push(A,w,A+1),d.push(w,w+1,A+1));B=b.createIndexBuffer();B.upload(new Uint16Array(d.memory()),d.length());this.pushIndexBuffer(B);this.update();b=this.material().info();b.ambientColor.set(.2,
.2,.2,1);b.diffuseColor.set(.8,.8,.8,1);b.specularColor.set(.8,.8,.8,1);b.specularLevel=64};MO.FE3dVideo=function(b){b=MO.Class.inherits(this,b,MO.FE3dFace);b.construct=MO.FE3dVideo_construct;b.testReady=MO.FE3dVideo_testReady;b.loadUrl=MO.FE3dVideo_loadUrl;b.dispose=MO.FE3dVideo_dispose;return b};MO.FE3dVideo_construct=function(){this.__base.FE3dFace.construct.call(this)};
MO.FE3dVideo_testReady=function(){if(!this._ready){var b=this._renderable;if(b){if(this._ready=b.testReady()){var d=new SEvent(this);this.processLoadListener(d);d.dispose()}this._materialReference=b}}return this._ready};MO.FE3dVideo_loadUrl=function(b){var d=this._graphicContext;this._renderable=MO.Console.find(MO.FE3dVideoConsole).loadUrl(d,b);this._ready=!1};MO.FE3dVideo_dispose=function(){this.__base.FE3dFace.dispose.call(this)};
MO.FE3dVideoConsole=function(b){b=MO.Class.inherits(this,b,MO.FConsole);b._scopeCd=MO.EScope.Local;b._videos=null;b._dataUrl="/cloud.resource.bitmap.wv";b.construct=MO.FE3dVideoConsole_construct;b.videos=MO.FE3dVideoConsole_videos;b.load=MO.FE3dVideoConsole_load;b.loadUrl=MO.FE3dVideoConsole_loadUrl;return b};MO.FE3dVideoConsole_construct=function(){this.__base.FConsole.construct.call(this);this._videos=new MO.TDictionary};MO.FE3dVideoConsole_videos=function(){return this._videos};
MO.FE3dVideoConsole_load=function(b,d,f){var h=d+"|"+f,q=this._videos.get(h);if(q)return q;d=MO.Window.Browser.hostPath(this._dataUrl+"?guid="+d+"&code="+f);MO.Logger.info(this,"Load bitmap. (url={1})",d);q="environment"==f?MO.Class.create(MO.FE3rBitmapCubePack):MO.Class.create(MO.FE3rBitmapFlatPack);q.linkGraphicContext(b);q.loadUrl(d);this._videos.set(h,q);return q};
MO.FE3dVideoConsole_loadUrl=function(b,d){var f=this._videos.get(d);if(f)return f;f=MO.Window.Browser.contentPath(d);MO.Logger.info(this,"Load bitmap from url. (url={1})",f);f=MO.Class.create(MO.FE3dVideoData);f.linkGraphicContext(b);f.setup();f.loadUrl(d);this._videos.set(d,f);return f};
MO.FE3dVideoData=function(b){b=MO.Class.inherits(this,b,MO.FE3dFaceData);b._hVideo=null;b.ohVideoLoad=MO.FE3dVideoData_ohVideoLoad;b.ohVideoEnded=MO.FE3dVideoData_ohVideoEnded;b.construct=MO.FE3dVideoData_construct;b.loadUrl=MO.FE3dVideoData_loadUrl;b.process=MO.FE3dVideoData_process;b.dispose=MO.FE3dVideoData_dispose;return b};MO.FE3dVideoData_ohVideoLoad=function(b){this.__linker._ready=!0};MO.FE3dVideoData_ohVideoEnded=function(){};MO.FE3dVideoData_construct=function(){this.__base.FE3dFaceData.construct.call(this)};
MO.FE3dVideoData_loadUrl=function(b){var d=this._hVideo=document.createElement("VIDEO");d.__linker=this;d.autoplay=!0;d.loop=!0;d.src=b;d.addEventListener("canplay",this.ohVideoLoad);d.load();this._ready=!1};MO.FE3dVideoData_process=function(){this._ready&&this._texture.upload(this._hVideo)};MO.FE3dVideoData_dispose=function(){this._hVideo=null;this.__base.FE3dFaceData.dispose.call(this)};
MO.FE3dFireworksParticle=function(b){b=MO.Class.inherits(this,b,MO.FE3dParticle);b._angle=MO.Class.register(b,new MO.AGetSet("_angle"),0);b._itemCount=MO.Class.register(b,new MO.AGetSet("_itemCount"),0);b._itemDelay=MO.Class.register(b,new MO.AGetSet("_itemDelay"),0);b._itemColor=MO.Class.register(b,new MO.AGetter("_itemColor"));b._itemPosition=MO.Class.register(b,new MO.AGetter("_itemPosition"));b._itemRotation=MO.Class.register(b,new MO.AGetter("_itemRotation"));b._itemScale=MO.Class.register(b,
new MO.AGetter("_itemScale"));b._itemSpeed=MO.Class.register(b,new MO.AGetSet("_itemSpeed"),0);b._itemAcceleration=MO.Class.register(b,new MO.AGetSet("_itemAcceleration"));b._itemAttenuation=MO.Class.register(b,new MO.AGetSet("_itemAttenuation"),0);b._itemSplittingNumber=MO.Class.register(b,new MO.AGetSet("_itemSplittingNumber"),0);b._vertexPositionBuffer=null;b._vertexCoordBuffer=null;b._indexBuffer=null;b.construct=MO.FE3dFireworksParticle_construct;b.setup=MO.FE3dFireworksParticle_setup;b.testInRange=
MO.FE3dFireworksParticle_testInRange;b.start=MO.FE3dFireworksParticle_start;b.dispose=MO.FE3dFireworksParticle_dispose;return b};MO.FE3dFireworksParticle_construct=function(){this.__base.FE3dParticle.construct.call(this);this._itemColor=new MO.SColor4(1,1,1,1);this._itemPosition=new MO.SPoint3(0,0,0);this._itemRotation=new MO.SVector3(0,0,0);this._itemScale=new MO.SVector3(1,1,1);this._itemAcceleration=new MO.SVector3(0,0,0)};MO.FE3dFireworksParticle_setup=function(){this.__base.FE3dParticle.setup.call(this)};
MO.FE3dFireworksParticle_testInRange=function(b,d){var f=parseInt((b+17)/20*220),f=4*(360*(60-parseInt(6*(d+3)))+f),h=this._data.data;if(0<=f&&f<h.length)var q=h[f];return 0<q};
MO.FE3dFireworksParticle_start=function(){for(var b=MO.Console.find(MO.FE3dParticleConsole),d=this._itemCount,f=2*Math.PI/d,h=0;h<d;h++){var q=this._angle+f*h,w=b.itemAlloc(MO.FE3dFireworksParticleItem);w.setParticle(this);w.setDelay(this._itemDelay);w.position().assign(this._itemPosition);w.direction().set(Math.sin(q),Math.cos(q),0);w.scale().assign(this._itemScale);w.color().assign(this._itemColor);w.setSpeed(this._itemSpeed);w.acceleration().assign(this._itemAcceleration);w.setAttenuation(this._itemAttenuation);
w.setSplittingDistance(3+Math.random());w.setSplittingNumber(this._itemSplittingNumber);w.start();this.pushItem(w)}};MO.FE3dFireworksParticle_dispose=function(){this._itemColor=MO.Lang.Object.dispose(this._itemColor);this._itemPosition=MO.Lang.Object.dispose(this._itemPosition);this._itemRotation=MO.Lang.Object.dispose(this._itemRotation);this._itemScale=MO.Lang.Object.dispose(this._itemScale);this._itemAcceleration=MO.Lang.Object.dispose(this._itemAcceleration);this.__base.FE3dParticle.dispose.call(this)};
MO.FE3dFireworksParticleItem=function(b){b=MO.Class.inherits(this,b,MO.FE3dParticleItem);b._priorPosition=MO.Class.register(b,new MO.AGetter("_priorPosition"));b._direction=MO.Class.register(b,new MO.AGetter("_direction"));b._speed=MO.Class.register(b,new MO.AGetSet("_speed"),0);b._acceleration=MO.Class.register(b,new MO.AGetter("_acceleration"));b._attenuation=MO.Class.register(b,new MO.AGetSet("_attenuation"),0);b._splittingDistance=MO.Class.register(b,new MO.AGetSet("_splittingDistance"),1);b._splittingNumber=
MO.Class.register(b,new MO.AGetSet("_splittingNumber"),0);b._currentDistance=null;b._currentSpeed=null;b._currentDirection=null;b._statusInRange=!1;b._storeSpeed=null;b.construct=MO.FE3dFireworksParticleItem_construct;b.start=MO.FE3dFireworksParticleItem_start;b.processSplit=MO.FE3dFireworksParticleItem_processSplit;b.processFrame=MO.FE3dFireworksParticleItem_processFrame;b.dispose=MO.FE3dFireworksParticleItem_dispose;return b};
MO.FE3dFireworksParticleItem_construct=function(){this.__base.FE3dParticleItem.construct.call(this);this._priorPosition=new MO.SPoint3;this._direction=new MO.SVector3;this._acceleration=new MO.SVector3;this._currentSpeed=new MO.SVector3;this._currentDirection=new MO.SVector3;this._storeSpeed=new MO.SVector3};
MO.FE3dFireworksParticleItem_start=function(){this.__base.FE3dParticleItem.start.call(this);this._priorPosition.assign(this._position);this._currentDistance=0;this._currentAlpha=1;var b=this._direction,d=this._speed;this._currentSpeed.x=b.x*d;this._currentSpeed.y=b.y*d;this._currentSpeed.z=b.z*d};
MO.FE3dFireworksParticleItem_processSplit=function(){for(var b=this._particle,d=MO.Console.find(MO.FE3dParticleConsole),f=0;4>f;f++)for(var h=2*Math.PI/16,q=0;16>q;q++){var w=h*q,z=d.itemAlloc(MO.FE3dFireworksParticleItem);z.setSplittingNumber(0);z.setParticle(b);z.direction().set(Math.sin(w),Math.cos(w),0);z.position().assign(position);z.color().assign(this._color);z.scale().setAll(.2);z.setDelay(.02*f);z.setSpeed(this._speed);z.acceleration().assign(this._acceleration);z.setAttenuation(1);z.start();
b.pushItem(z)}};
MO.FE3dFireworksParticleItem_processFrame=function(b){var d=this._priorPosition;d.assign(this._position);var f=this._position,h=this._particle.testInRange(f.x,f.y);this._statusInRange!=h&&(h?(this._storeSpeed.assign(this._currentSpeed),this._currentSpeed.setAll(.01),this._color.set(1,0,0,1)):(this._color.set(1,1,1,1),this._currentSpeed.assign(this._storeSpeed)),this._statusInRange=h);var h=this._currentSpeed,q=h.x*b,w=h.y*b,z=h.z*b,f=this._position;f.x+=q;f.y+=w;f.z+=z;q=this._direction;q.x=f.x-d.x;
q.y=f.y-d.y;q.z=f.z-d.z;this._currentDistance+=q.length();q.normalize();d=Math.acos(q.x);this._rotation.z=0<q.y?d:2*Math.PI-d;d=this._acceleration;h.x+=d.x*b;h.y+=d.y*b;h.z+=d.z*b;b*=this._attenuation;b>this._currentAlpha?(this._currentAlpha=0,this._currentFinish=!0):this._currentAlpha-=b;0<this._splittingNumber&&this._currentDistance>this._splittingDistance&&(this.processSplit(),this._splittingNumber--,0==this._splittingNumber&&(this._currentFinish=!0));this.dirty()};
MO.FE3dFireworksParticleItem_dispose=function(){this._priorPosition=MO.Lang.Object.dispose(this._priorPosition);this._direction=MO.Lang.Object.dispose(this._direction);this.__base.FE3dParticleItem.dispose.call(this)};
MO.FE3dParticle=function(b){b=MO.Class.inherits(this,b,MO.FE3dRenderable);b._items=MO.Class.register(b,new MO.AGetter("_items"));b._vertexPositionBuffer=null;b._vertexCoordBuffer=null;b._vertexColorBuffer=null;b._indexBuffer=null;b.construct=MO.FE3dParticle_construct;b.setup=MO.FE3dParticle_setup;b.testReady=MO.FE3dParticle_testReady;b.findTexture=MO.FE3dParticle_findTexture;b.textures=MO.FE3dParticle_textures;b.material=MO.FE3dParticle_material;b.setSize=MO.FE3dParticle_setSize;b.setData=MO.FE3dParticle_setData;
b.loadUrl=MO.FE3dParticle_loadUrl;b.createItem=MO.FE3dParticle_createItem;b.pushItem=MO.FE3dParticle_pushItem;b.process=MO.FE3dParticle_process;b.upload=MO.FE3dParticle_upload;b.dispose=MO.FE3dParticle_dispose;return b};MO.FE3dParticle_construct=function(){this.__base.FE3dRenderable.construct.call(this);this._items=new MO.TLooper};
MO.FE3dParticle_setup=function(){var b=this._graphicContext;this._vertexCount=0;var d=this._vertexPositionBuffer=b.createVertexBuffer();d.setCode("position");d.setFormatCd(MO.EG3dAttributeFormat.Float3);this.pushVertexBuffer(d);d=this._vertexCoordBuffer=b.createVertexBuffer();d.setCode("coord");d.setFormatCd(MO.EG3dAttributeFormat.Float2);this.pushVertexBuffer(d);d=this._vertexColorBuffer=b.createVertexBuffer();d.setCode("color");d.setFormatCd(MO.EG3dAttributeFormat.Byte4Normal);this.pushVertexBuffer(d);
d=this._indexBuffer=b.createIndexBuffer();this.pushIndexBuffer(d)};MO.FE3dParticle_testReady=function(){this._ready||(this._ready=this._renderable.testReady());return this._ready};MO.FE3dParticle_findTexture=function(b){return this._renderable.findTexture(b)};MO.FE3dParticle_textures=function(){return this._renderable.textures()};MO.FE3dParticle_material=function(){return this._renderable.material()};MO.FE3dParticle_setSize=function(b,d){};MO.FE3dParticle_setData=function(b){this._renderable=b};
MO.FE3dParticle_loadUrl=function(b){var d=this._graphicContext;this._renderable=RConsole.find(FE3dParticleConsole).loadUrl(d,b);this._ready=!1};MO.FE3dParticle_createItem=function(){var b=MO.Class.create(MO.FE3dParticleItem);this.pushItem(b);return this};MO.FE3dParticle_pushItem=function(b){this._items.push(b)};
MO.FE3dParticle_process=function(){this.__base.FE3dRenderable.process.call(this);var b=MO.Console.find(MO.FE3dParticleConsole),d=this._items;for(d.record();d.next();){var f=d.current();f.currentFinish()&&(d.removeCurrent(),b.itemFree(f));f.process()}d.isEmpty()||this.upload()};
MO.FE3dParticle_upload=function(){var b=this._items,d=b.count(),f=this._vertexCount=4*d,h=new Float32Array(3*f),q=0,w=new Float32Array(2*f),z=0,f=new Uint8Array(4*f),A=0,d=new Uint16Array(12*d);b.record();for(var B=0;b.next();){var C=b.current();if(C.visible()){var D=C.currentMatrix(),E=C.color(),F=parseInt(255*MO.Lang.Float.toRange(E.red,0,1)),H=parseInt(255*E.green),E=parseInt(255*E.blue),C=parseInt(255*C.currentAlpha());D.transform(h,12*B,MO.Lang.Math.faceCenterPositions,0,4);w[q++]=0;w[q++]=1;
w[q++]=1;w[q++]=1;w[q++]=1;w[q++]=0;w[q++]=0;for(D=w[q++]=0;4>D;D++)f[z++]=F,f[z++]=H,f[z++]=E,f[z++]=C;F=4*B;d[A++]=F+0;d[A++]=F+1;d[A++]=F+2;d[A++]=F+0;d[A++]=F+2;d[A++]=F+3;B++}}this._vertexPositionBuffer.upload(h,12,B);this._vertexCoordBuffer.upload(w,8,B);this._vertexColorBuffer.upload(f,4,B);this._indexBuffer.upload(d,6*B)};MO.FE3dParticle_dispose=function(){this._items=MO.Lang.Object.dispose(this._items);this.__base.FE3dRenderable.dispose.call(this)};
MO.FE3dParticleConsole=function(b){b=MO.Class.inherits(this,b,MO.FConsole);b._scopeCd=MO.EScope.Local;b._pools=MO.Class.register(b,new MO.AGetter("_pools"));b.onLoad=MO.FE3dParticleConsole_onLoad;b.construct=MO.FE3dParticleConsole_construct;b.itemAlloc=MO.FE3dParticleConsole_itemAlloc;b.itemFree=MO.FE3dParticleConsole_itemFree;b.dispose=MO.FE3dParticleConsole_dispose;return b};MO.FE3dParticleConsole_construct=function(){this.__base.FConsole.construct.call(this);this._pools=MO.Class.create(MO.FObjectPools)};
MO.FE3dParticleConsole_itemAlloc=function(b){var d=MO.Class.name(b);(d=this._pools.alloc(d))||(d=MO.Class.create(b));return d};MO.FE3dParticleConsole_itemFree=function(b){var d=MO.Class.name(b);this._pools.free(d,b)};MO.FE3dParticleConsole_dispose=function(){this._pools=MO.Lang.Object.dispose(this._pools);this.__base.FConsole.dispose.call(this)};
MO.FE3dParticleData=function(b){b=MO.Class.inherits(this,b,MO.FE3dFaceData);b.onImageLoad=MO.FE3dParticleData_onImageLoad;b.construct=MO.FE3dParticleData_construct;b.loadUrl=MO.FE3dParticleData_loadUrl;b.dispose=MO.FE3dParticleData_dispose;return b};MO.FE3dParticleData_onImageLoad=function(b){b=b.sender;this._size.assign(b.size());this._texture.upload(b);b.dispose();this._ready=!0};
MO.FE3dParticleData_construct=function(){this.__base.FE3dFaceData.construct.call(this);var b=this._material.info();b.effectCode="control";b.optionAlpha=!0;b.ambientColor.set(1,1,1,1)};MO.FE3dParticleData_loadUrl=function(b){var d=MO.Class.create(MO.FImage);d.addLoadListener(this,this.onImageLoad);d.loadUrl(b);this._ready=!1};MO.FE3dParticleData_dispose=function(){this._hVideo=null;this.__base.FE3dFaceData.dispose.call(this)};
MO.FE3dParticleItem=function(b){b=MO.Class.inherits(this,b,MO.FObject);b._particle=MO.Class.register(b,new MO.AGetSet("_particle"));b._visible=MO.Class.register(b,new MO.AGetSet("_visible"),!1);b._delay=MO.Class.register(b,new MO.AGetSet("_delay"),0);b._interval=MO.Class.register(b,new MO.AGetter("_interval"),1);b._position=MO.Class.register(b,new MO.AGetter("_position"));b._rotation=MO.Class.register(b,new MO.AGetter("_rotation"));b._scale=MO.Class.register(b,new MO.AGetter("_scale"));b._color=MO.Class.register(b,
new MO.AGetter("_color"));b._currentMatrix=MO.Class.register(b,new MO.AGetter("_currentMatrix"));b._currentAlpha=MO.Class.register(b,new MO.AGetSet("_currentAlpha"),0);b._currentFinish=MO.Class.register(b,new MO.AGetSet("_currentFinish"),!1);b._startTick=0;b._lastTick=0;b._statusDirty=!1;b.construct=MO.FE3dParticleItem_construct;b.start=MO.FE3dParticleItem_start;b.processFrame=MO.FE3dParticleItem_processFrame;b.process=MO.FE3dParticleItem_process;b.dirty=MO.FE3dParticleItem_dirty;b.dispose=MO.FE3dParticleItem_dispose;
return b};MO.FE3dParticleItem_construct=function(){this.__base.FObject.construct.call(this);this._currentMatrix=new MO.SMatrix3d;this._position=new MO.SPoint3(0,0,0);this._rotation=new MO.SVector3(0,0,0);this._scale=new MO.SVector3(1,1,1);this._color=new MO.SColor4(1,1,1,1)};MO.FE3dParticleItem_start=function(){this._visible=!1;this._currentAlpha=1;this._currentFinish=!1;this._startTick=MO.Timer.current();this._lastTick=0};MO.FE3dParticleItem_processFrame=function(b){};
MO.FE3dParticleItem_process=function(){var b=MO.Timer.current();if(this._visible||!(b-this._startTick<this._delay)){if(0==this._lastTick)return this._lastTick=b,!1;var d=b-this._lastTick;if(d<=this._interval)return!1;this.processFrame(d/1E3);this._lastTick=b;this._statusDirty&&(b=this._currentMatrix,b.tx=this._position.x,b.ty=this._position.y,b.tz=this._position.z,b.rx=this._rotation.x,b.ry=this._rotation.y,b.rz=this._rotation.z,b.sx=this._scale.x,b.sy=this._scale.y,b.sz=this._scale.z,b.updateForce(),
this._visible=!0,this._statusDirty=!1)}};MO.FE3dParticleItem_dirty=function(){this._statusDirty=!0};MO.FE3dParticleItem_dispose=function(){this._currentMatrix=MO.Lang.Object.dispose(this._currentMatrix);this._position=MO.Lang.Object.dispose(this._position);this._rotation=MO.Lang.Object.dispose(this._rotation);this._scale=MO.Lang.Object.dispose(this._scale);this.__base.FObject.dispose.call(this)};
MO.FE3dRainFontParticle=function(b){b=MO.Class.inherits(this,b,MO.FE3dParticle);b._itemCount=MO.Class.register(b,new MO.AGetSet("_itemCount"),0);b._delay=MO.Class.register(b,new MO.AGetSet("_delay"),0);b._speed=MO.Class.register(b,new MO.AGetSet("_speed"),1);b._angle=MO.Class.register(b,new MO.AGetSet("_angle"),0);b._acceleration=MO.Class.register(b,new MO.AGetSet("_acceleration"),0);b._attenuation=MO.Class.register(b,new MO.AGetSet("_attenuation"),0);b._vertexPositionBuffer=null;b._vertexCoordBuffer=
null;b._indexBuffer=null;b.construct=MO.FE3dRainFontParticle_construct;b.setup=MO.FE3dRainFontParticle_setup;b.testInRange=MO.FE3dRainFontParticle_testInRange;b.start=MO.FE3dRainFontParticle_start;b.dispose=MO.FE3dRainFontParticle_dispose;return b};MO.FE3dRainFontParticle_construct=function(){this.__base.FE3dParticle.construct.call(this)};MO.FE3dRainFontParticle_setup=function(){this.__base.FE3dParticle.setup.call(this)};
MO.FE3dRainFontParticle_testInRange=function(b,d){var f=parseInt((b+17)/20*220),f=4*(360*(60-parseInt(6*(d+3)))+f),h=this._data.data;if(0<=f&&f<h.length)var q=h[f];return 0<q};
MO.FE3dRainFontParticle_start=function(){for(var b=MO.Console.find(MO.FE3dParticleConsole),d=this._itemCount,f=0;f<d;f++){var h=parseInt(360*MO.Random.get())%360,q=b.itemAlloc(MO.FE3dRainFontParticleItem);q.setParticle(this);q.direction().set(0,-1,0);q.position().set(.1*h-12,5,0);q.rotation().set(0,0,-Math.PI/2);q.scale().set(.1,.1,.1);q.setDelay(this._delay);q.setSpeed(this._speed);q.setAcceleration(this._acceleration);q.setAttenuation(this._attenuation);q.start();this.pushItem(q)}};
MO.FE3dRainFontParticle_dispose=function(){this.__base.FE3dParticle.dispose.call(this)};
MO.FE3dRainFontParticleItem=function(b){b=MO.Class.inherits(this,b,MO.FE3dParticleItem);b._direction=MO.Class.register(b,new MO.AGetter("_direction"));b._speed=MO.Class.register(b,new MO.AGetSet("_speed"));b._acceleration=MO.Class.register(b,new MO.AGetSet("_acceleration"),1);b._attenuation=MO.Class.register(b,new MO.AGetSet("_attenuation"),0);b._statusInRange=!1;b._currentSpeed=0;b._storeSpeed=0;b.construct=MO.FE3dRainFontParticleItem_construct;b.start=MO.FE3dRainFontParticleItem_start;b.processFrame=
MO.FE3dRainFontParticleItem_processFrame;b.dispose=MO.FE3dRainFontParticleItem_dispose;return b};MO.FE3dRainFontParticleItem_construct=function(){this.__base.FE3dParticleItem.construct.call(this);this._direction=new MO.SVector3};MO.FE3dRainFontParticleItem_start=function(){this.__base.FE3dParticleItem.start.call(this);this._statusInRange=!1;this._currentSpeed=this._speed;this._storeSpeed=0;this._currentAlpha=.2;this._color.set(.5,.5,.5,1)};
MO.FE3dRainFontParticleItem_processFrame=function(b){this._particle._graphicContext.size();var d=this._position,f=this._particle.testInRange(d.x,d.y);this._statusInRange!=f&&(f?(this._storeSpeed=this._currentSpeed,this._currentSpeed=.2,this._color.set(1,0,0,1),this._currentAlpha=1):(this._color.set(1,1,1,1),this._currentAlpha=.2,this._currentSpeed=this._storeSpeed),this._statusInRange=f);b*=this._currentSpeed;f=this._direction;d.x+=f.x*b;d.y+=f.y*b;d.z+=f.z*b;this.dirty()};
MO.FE3dRainFontParticleItem_dispose=function(){this._direction=MO.Lang.Object.dispose(this._direction);this.__base.FE3dParticleItem.dispose.call(this)};
MO.AEvent=function(b,d,f){MO.AAnnotation.call(this,b);this._annotationCd=MO.EAnnotation.Event;this._logger=this._inherit=!0;this._linker=d;this._handle=f;this._process=null;this.linker=MO.AEvent_linker;this.handle=MO.AEvent_handle;this.value=MO.AEvent_value;this.create=MO.AEvent_create;this.attach=MO.Method.empty;this.bind=MO.AEvent_bind;this.toString=MO.AEvent_toString;return this};MO.AEvent_linker=function(){return this._linker};MO.AEvent_handle=function(){return this._handle};MO.AEvent_value=function(){return this._process};
MO.AEvent_create=function(){return new MO.SEvent};MO.AEvent_bind=function(b,d){d?b.addEventListener(this._linker,MO.RUiEvent.ohEvent,!0):b[this._handle]=MO.RUiEvent.ohEvent};MO.AEvent_toString=function(){return"linker="+this._linker+",handle="+this._handle};MO.AEventBlur=function(b,d){MO.AEvent.call(this,b,"blur","onblur");this.attach=MO.AEventBlur_attach;return this};MO.AEventBlur_attach=function(b,d){};
MO.AEventChange=function(b){MO.AEvent.call(this,b,"change","onchange");this.attach=MO.AEventChange_attach;return this};MO.AEventChange_attach=function(b,d){};MO.AEventClick=function(b){MO.AEvent.call(this,b,"click","onclick");this.attach=MO.AEventClick_attach;return this};MO.AEventClick_attach=function(b,d){b.altKey=d.altKey;b.ctrlKey=d.ctrlKey;b.shiftKey=d.shiftKey};MO.AEventDoubleClick=function(b){MO.AEvent.call(this,b,"dblclick","ondblclick");this.attach=MO.AEventDoubleClick_attach;return this};
MO.AEventDoubleClick_attach=function(b,d){b.altKey=d.altKey;b.ctrlKey=d.ctrlKey;b.shiftKey=d.shiftKey};MO.AEventFocus=function(b){MO.AEvent.call(this,b,"focus","onfocus");this.attach=MO.AEventFocus_attach;return this};MO.AEventFocus_attach=function(b,d){};MO.AEventInputChanged=function(b){MO.AEvent.call(this,b,"input","oninput");this.attach=MO.AEventInputChanged_attach;this.bind=MO.AEventInputChanged_bind;return this};MO.AEventInputChanged_attach=function(b,d){};
MO.AEventInputChanged_bind=function(b,d){MO.Window.Browser.isBrowser(MO.EBrowser.Explorer)?b.onpropertychange=MO.RUiEvent.ohEvent:b.addEventListener("input",MO.RUiEvent.ohEvent)};MO.AEventKeyDown=function(b){MO.AEvent.call(this,b,"keydown","onkeydown");this.attach=MO.AEventKeyDown_attach;return this};MO.AEventKeyDown_attach=function(b,d){b.altKey=d.altKey;b.shiftKey=d.shiftKey;b.ctrlKey=d.ctrlKey;b.keyCode=d.keyCode};
MO.AEventKeyPress=function(b){MO.AEvent.call(this,b,"keypress","onkeypress");this.create=MO.AEventKeyPress_create;this.attach=MO.AEventKeyPress_attach;return this};MO.AEventKeyPress_create=function(){return new MO.SKeyboardEvent};MO.AEventKeyPress_attach=function(b,d){b.hEvent=d;b.attachEvent(d)};MO.AEventKeyUp=function(b){MO.AEvent.call(this,b,"keyup","onkeyup");this.attach=MO.AEventKeyUp_attach;return this};
MO.AEventKeyUp_attach=function(b,d){b.altKey=d.altKey;b.shiftKey=d.shiftKey;b.ctrlKey=d.ctrlKey;b.keyCode=d.keyCode};MO.AEventLoad=function(b){MO.AEvent.call(this,b,"load","onload");this.attach=MO.AEventLoad_attach;return this};MO.AEventLoad_attach=function(b,d){};MO.AEventMouse=function(b,d,f){MO.AEvent.call(this,b,d,f);this.attach=MO.AEventMouse_attach;return this};
MO.AEventMouse_attach=function(b,d){b.button=d.button;b.mouseLeft=d.button==MO.EMouseButton.Left;b.mouseMiddle=d.button==MO.EMouseButton.Middle;b.mouseRight=d.button==MO.EMouseButton.Right;b.altKey=d.altKey;b.ctrlKey=d.ctrlKey;MO.Window.Browser.isBrowser(MO.EBrowser.FireFox)?(b.x=d.pageX,b.y=d.pageY,b.offsetX=d.layerX,b.offsetY=d.layerY):(b.x=d.x,b.y=d.y,b.offsetX=d.offsetX,b.offsetY=d.offsetY);b.clientX=d.clientX;b.clientY=d.clientY};
MO.AEventMouseDown=function(b){MO.AEventMouse.call(this,b,"mousedown","onmousedown");return this};MO.AEventMouseEnter=function(b){MO.AEvent.call(this,b,"mouseenter","onmouseenter");this._logger=!1;this.attach=MO.AEventMouseEnter_attach;return this};MO.AEventMouseEnter_attach=function(b,d){};MO.AEventMouseLeave=function(b){MO.AEvent.call(this,b,"mouseleave","onmouseleave");this._logger=!1;this.attach=MO.AEventMouseLeave_attach;return this};MO.AEventMouseLeave_attach=function(b,d){};
MO.AEventMouseMove=function(b){MO.AEventMouse.call(this,b,"mousemove","onmousemove");this._logger=!1;return this};MO.AEventMouseOut=function(b){MO.AEvent.call(this,b,"mouseout","onmouseout");this._y=this._x=this._ctrlKey=this._altKey=this._hSource=null;this.attach=MO.AEventMouseOut_attach;return this};
MO.AEventMouseOut_attach=function(b){this._hSource=b.srcElement;this._altKey=b.altKey;this._ctrlKey=b.ctrlKey;MO.Window.Browser.isBrowser(MO.EBrowser.FireFox)?(this._x=b.pageX,this._y=b.pageY):(this._x=b.x,this._y=b.y)};MO.AEventMouseOver=function(b){MO.AEvent.call(this,b,"mouseover","onmouseover");this._y=this._x=this._ctrlKey=this._altKey=this._hSource=null;this.attach=MO.AEventMouseOver_attach;return this};
MO.AEventMouseOver_attach=function(b){this._hSource=b.srcElement;this._altKey=b.altKey;this._ctrlKey=b.ctrlKey;MO.Window.Browser.isBrowser(MO.EBrowser.FireFox)?(this._x=b.pageX,this._y=b.pageY):(this._x=b.x,this._y=b.y)};MO.AEventMouseUp=function(b){MO.AEventMouse.call(this,b,"mouseup","onmouseup");return this};MO.AEventMouseWheel=function(b){MO.AEvent.call(this,b,"mousewheel","onmousewheel");this.attach=MO.AEventMouseWheel_attach;return this};
MO.AEventMouseWheel_attach=function(b,d){b.altKey=d.altKey;b.ctrlKey=d.ctrlKey;b.delta=d.wheelDelta;MO.Window.Browser.isBrowser(MO.EBrowser.FireFox)?(b.x=d.pageX,b.y=d.pageY):(b.x=d.x,b.y=d.y)};MO.AEventReadyStateChange=function(b){MO.AEvent.call(this,b,"readystatechange","onreadystatechange");this.attach=MO.AEventReadyStateChange_attach;return this};MO.AEventReadyStateChange_attach=function(b,d){};
MO.AEventResize=function(b){MO.AEvent.call(this,b,"resize","onresize");this.attach=MO.AEventResize_attach;return this};MO.AEventResize_attach=function(b,d){b.x=d.x;b.y=d.y};MO.AEventScroll=function(b){MO.AEvent.call(this,b,"scroll","onscroll");this.attach=MO.AEventScroll_attach;return this};MO.AEventScroll_attach=function(b,d){};MO.AEventTouchEnd=function(b){MO.AEvent.call(this,b,"touchstart","ontouchstart");this.attach=MO.AEventTouchEnd_attach;return this};MO.AEventTouchEnd_attach=function(b,d){};
MO.AEventTouchMove=function(b){MO.AEvent.call(this,b,"touchstart","ontouchstart");this.attach=MO.AEventTouchMove_attach;return this};MO.AEventTouchMove_attach=function(b,d){};MO.AEventTouchStart=function(b){MO.AEvent.call(this,b,"touchstart","ontouchstart");this.attach=MO.AEventTouchStart_attach;return this};MO.AEventTouchStart_attach=function(b,d){};
MO.APtyAttributes=function(b,d,f,h,q,w){MO.AProperty.call(this,b,d);this._left=MO.Lang.Integer.nvl(f);this._top=MO.Lang.Integer.nvl(h);this._right=MO.Lang.Integer.nvl(q);this._bottom=MO.Lang.Integer.nvl(w);this.load=MO.APtyAttributes_load;this.save=MO.APtyAttributes_save;this.toString=MO.APtyAttributes_toString;return this};MO.APtyAttributes_load=function(b,d){var f=b[this._name];f||(f=b[this._name]=new MO.TAttributes);f.split(d.get(this._linker),"=","\n")};
MO.APtyAttributes_save=function(b,d){var f=b[this._name];f&&(f.isEmpty()||d.set(this._linker,f.join("=","\n")))};MO.APtyAttributes_toString=function(){return"linker="+this._linker+",value="+this._left+","+this._top+","+this._right+","+this._bottom};MO.APtyBoolean=function(b,d,f){MO.AProperty.call(this,b,d);this._value=f?f:!1;this.build=MO.APtyBoolean_build;this.load=MO.APtyBoolean_load;this.save=MO.APtyBoolean_save;this.toString=MO.APtyBoolean_toString;return this};
MO.APtyBoolean_build=function(b){null==b[this._name]&&(b[this._name]=this._value)};MO.APtyBoolean_load=function(b,d){b[this._name]=MO.Lang.Boolean.parse(d.get(this._linker))};MO.APtyBoolean_save=function(b,d){var f=b[this._name];f&&d.set(this._linker,MO.Lang.Boolean.toString(f))};MO.APtyBoolean_toString=function(){return"linker="+this._linker+",value="+this._value};
MO.APtyBorder=function(b,d){MO.AProperty.call(this,b,d);this.load=MO.APtyBorder_load;this.save=MO.APtyBorder_save;this.toString=MO.APtyBorder_toString;return this};MO.APtyBorder_load=function(b,d){var f=d.get(this._linker);b[this._name].parse(f)};MO.APtyBorder_save=function(b,d){};MO.APtyBorder_toString=function(){return"linker="+this._linker+",value="+this._x+","+this._y};
MO.APtyConfig=function(b,d){MO.AProperty.call(this,b,d);this.force=!0;this.load=MO.APtyConfig_load;this.save=MO.Method.empty;return this};MO.APtyConfig_load=function(b,d){b[this.name]=d};MO.APtyEnum=function(b,d,f,h){MO.AProperty.call(this,b,d);this._enum=f;this._default=h;this.build=MO.APtyEnum_build;this.load=MO.APtyEnum_load;this.save=MO.APtyEnum_save;this.toString=MO.APtyEnum_toString;return this};MO.APtyEnum_build=function(b){null==b[this._name]&&(b[this._name]=this._default)};
MO.APtyEnum_load=function(b,d){b[this._name]=d.get(this._linker)};MO.APtyEnum_save=function(b,d){d.set(this._linker,b[this._name])};MO.APtyEnum_toString=function(){return"linker="+this._linker+",enum="+this._enum+",default="+this._default};MO.APtyInteger=function(b,d,f){MO.AProperty.call(this,b,d);this._value=MO.Lang.Integer.nvl(f);this.build=MO.APtyInteger_build;this.load=MO.APtyInteger_load;this.save=MO.APtyInteger_save;this.toString=MO.APtyInteger_toString;return this};
MO.APtyInteger_build=function(b){null==b[this._name]&&(b[this._name]=this._value)};MO.APtyInteger_load=function(b,d){b[this._name]=MO.Lang.Integer.parse(d.get(this._linker))};MO.APtyInteger_save=function(b,d){d.set(this._linker,MO.Lang.Integer.toString(b[this._name]))};MO.APtyInteger_toString=function(){return"linker="+this._linker+",value="+this._value};
MO.APtyNumber=function(b,d,f){MO.AProperty.call(this,b,d);this._value=MO.Lang.Integer.nvl(f);this.build=MO.APtyNumber_build;this.toString=MO.APtyNumber_toString;return this};MO.APtyNumber_build=function(b){null==b[this._name]&&(b[this._name]=this._value)};MO.APtyNumber_toString=function(){return"linker="+this._linker+",value="+this._value};
MO.APtyPadding=function(b,d,f,h,q,w){MO.AProperty.call(this,b,d);this._left=MO.Lang.Integer.nvl(f);this._top=MO.Lang.Integer.nvl(h);this._right=MO.Lang.Integer.nvl(q);this._bottom=MO.Lang.Integer.nvl(w);this.load=MO.APtyPadding_load;this.save=MO.APtyPadding_save;this.toString=MO.APtyPadding_toString;return this};MO.APtyPadding_load=function(b,d){var f=this._name,h=d.get(this._linker),q=b[f];q||(q=b[f]=new MO.SPadding);q.parse(h)};
MO.APtyPadding_save=function(b,d){var f=b[this._name];f&&(f.isEmpty()||d.set(this._linker,f.toString()))};MO.APtyPadding_toString=function(){return"linker="+this._linker+",value="+this._left+","+this._top+","+this._right+","+this._bottom};MO.APtyPoint2=function(b,d,f,h){MO.AProperty.call(this,b,d);this._x=MO.Lang.Integer.nvl(f);this._y=MO.Lang.Integer.nvl(h);this.load=MO.APtyPoint2_load;this.save=MO.APtyPoint2_save;this.toString=MO.APtyPoint2_toString;return this};
MO.APtyPoint2_load=function(b,d){var f=d.get(this._linker);b[this._name].parse(f)};MO.APtyPoint2_save=function(b,d){var f=b[this._name];f.isEmpty()||d.set(this._linker,f.toString())};MO.APtyPoint2_toString=function(){return"linker="+this._linker+",value="+this._x+","+this._y};MO.APtySet=function(b,d,f,h){MO.AProperty.call(this,b,d);this._search=f;this._value=h;this.build=MO.APtySet_build;this.load=MO.APtySet_load;this.save=MO.APtySet_save;this.toString=MO.APtySet_toString;return this};
MO.APtySet_build=function(b){null==b[this.name]&&(b[this.name]=this._value)};MO.APtySet_load=function(b,d){b[this.name]=MO.Lang.Set.containsString(d.get(this.linker),this.search)};MO.APtySet_save=function(b,d){var f=this.name,h=b[f],q=d.get(this.linker),q=MO.Lang.Set.containsString(q,this._search);h&&!q?d.set(f,h+this._search):!b&&q&&d.set(f,MO.Lang.String.remove(h,this._search))};MO.APtySet_toString=function(){return"linker="+this.linker+",value="+this._value+",search="+this._search};
MO.APtySize2=function(b,d,f,h){MO.AProperty.call(this,b,d);this._width=MO.Lang.Integer.nvl(f);this._height=MO.Lang.Integer.nvl(h);this.load=MO.APtySize2_load;this.save=MO.APtySize2_save;this.toString=MO.APtySize2_toString;return this};MO.APtySize2_load=function(b,d){var f=d.get(this._linker);b[this._name].parse(f)};MO.APtySize2_save=function(b,d){var f=b[this._name];f.isEmpty()||d.set(this._linker,f.toString())};
MO.APtySize2_toString=function(){return"linker="+this._linker+",value="+this._width+","+this._height};MO.APtyString=function(b,d,f){MO.AProperty.call(this,b,d);this._value=f?f:null;this.build=MO.APtyString_build;this.toString=MO.APtyString_toString;return this};MO.APtyString_build=function(b){null==b[this._name]&&(b[this._name]=this._value)};MO.APtyString_toString=function(){return"linker="+this._linker+",value="+this._value};
MO.EUiAlign=new function(){this.Left="left";this.Center="center";this.Right="right";this.Top="up";this.Middle="middle";this.Bottom="down";this.BottomLeft="bl";this.BottomRight="br";return this};MO.EUiAnchor=new function(){this.None=0;this.Left=1;this.Top=2;this.Right=4;this.Bottom=8;return this};MO.EUiBorder=new function(){this.None=0;this.Square=1;this.Round=2;this.RoundIcon=3;this.RoundDrop=4;this.RoundTitle=5;this.RoundIconDrop=6;return this};
MO.EUiBorderStyle=new function(){this.Readonly=1;this.Edit=2;this.Hover=3;return this};
MO.EUiColor=new function(){this.ReadonlyBackgroundColor="#FEFECB";this.Normal="#FFFFFF";this.Select="#F8C59A";this.Invalid=this.Valid="#FFCCCC";this.Edit="#FFFFFF";this.EditHover="#EBFFFF";this.Require="#FF0000";this.Text="#000000";this.TextEdit="#0066FF";this.TextReadonly="#333333";this.TextInvalid="red";this.Delete="#DDDDDD";this.ColumnReadonly="#FFFFFF";this.Rows=["#FFFFFF","#FAFAFA"];this.RowSelect="#cde5ff";this.RowHover="#E8E8FF";this.RowEdit="#FFFFFF";this.RowEditSelect="#FDEBDB";this.RowEditHover=
"#F8F8E0";return this};MO.EUiCursor=new function(){this.Default="default";this.Auto="auto";this.NorthWest="NW";this.SouthWest="SW";this.SouthEast="SE";this.NorthEast="NE";this.West="W";this.South="S";this.East="E";this.North="N";this.Pointer="pointer";this.Cross="crosshair";this.Move="move";return this};MO.EUiDialog=new function(){this.Confirm=1;this.Info=2;this.Warn=3;this.Error=4;return this};MO.EUiDirection=new function(){this.Horizontal="H";this.Vertical="V";return this};
MO.EUiDock=new function(){this.None="None";this.LeftTop="LeftTop";this.Left="Left";this.LeftBottom="LeftBottom";this.Top="Top";this.RightTop="RightTop";this.Right="Right";this.RightBottom="RightBottom";this.Bottom="Bottom";this.Center="Center";this.Fill="Fill";return this};MO.EUiLabelMode=new function(){this.All="A";this.Label="L";this.Hidden="H";return this};MO.EUiLabelPosition=new function(){this.Left="left";this.Right="right";this.Top="top";this.Bottom="bottom";return this};
MO.EUiLayer=new function(){this.Default=2E4;this.Shadow=6E3;this.Disable=5E3;this.Drap=1E4;this.Window=2E4;this.Drop=4E4;this.Editor=1E4;this.Border=2E4;this.Move=25E3;this.Message=this.Search=45E3;return this};MO.EUiLayout=new function(){this.Display="P";this.Search="S";this.Design="G";this.Insert="I";this.Update="U";this.Delete="D";this.Zoom="Z";return this};MO.EUiMerge=new function(){this.Append="append";this.Override="override";this.Disable="disable";return this};
MO.EPanel=new function(){this.Container=0;this.Parent=1;this.Size=8;this.Border=2;this.Edit=3;this.Focus=4;this.Design=5;this.Scroll=6;this.Shadow=7;this.Move=9;this.Disable=10;this.Drop=11;return this};MO.EUiPosition=new function(){this.Left="left";this.Right="right";this.Top="top";this.Bottom="bottom";this.Center="center";this.Before=1;this.After=2;this.LineBefore=3;this.LineAfter=4;return this};
MO.EUiScroll=new function(){this.None="N";this.Horizontal="H";this.HorizontalAuto="HA";this.Vertical="V";this.VerticalAuto="VA";this.Both="B";this.BothAuto="BA";return this};MO.EUiSize=new function(){this.Normal=0;this.Horizontal=1;this.Vertical=2;this.Fill=3;this.Both=4;return this};MO.EUiTimeUnit=new function(){this.Second="second";this.Minute="minute";this.Hour="hour";this.Day="day";this.Week="week";this.Month="month";this.Year="year";return this};
MO.EUiWrap=new function(){this.NextLine=0;this.SameLine=1;return this};MO.MPropertyCheck=function(b){b=MO.Class.inherits(this,b);b._valueTrue=MO.Class.register(b,new MO.APtyString("_valueTrue"),MO.EBoolean.True);b._valueFalse=MO.Class.register(b,new MO.APtyString("_valueFalse"),MO.EBoolean.False);return b};
MO.MPropertyEdit=function(b){b=MO.Class.inherits(this,b,MO.MUiEditValidator,MO.MUiEditReference,MO.MUiEditZoom);b._editCaseCd=MO.Class.register(b,new MO.APtyString("_editCaseCd"));b._editPattern=MO.Class.register(b,new MO.APtyString("_editPattern"));b._editLength=MO.Class.register(b,new MO.APtyInteger("_editLength"));b._editComplete=MO.Class.register(b,new MO.APtyBoolean("_editComplete"));b._validLengthMin=MO.Class.register(b,new MO.APtyInteger("_validLengthMin"));b._validLengthMax=MO.Class.register(b,
new MO.APtyInteger("_validLengthMax"));b.oeValid=MO.MPropertyEdit_oeValid;return b};MO.MPropertyEdit_oeValid=function(b){var d=MO.EEventStatus.Stop;if(this._visible&&this._validable){var f=this.text();if(this.validRequire&&!MO.RValidator.validRequire(this,f))return b.controls.push(this),d;this.editLength&&!MO.RValidator.validTextLength(this,f,this.editLength)&&b.controls.push(this)}return d};
MO.MPropertyNumber=function(b){b=MO.Class.inherits(this,b);b._valueMin=MO.Class.register(b,new MO.APtyNumber("_valueMin"));b._valueMax=MO.Class.register(b,new MO.APtyNumber("_valueMax"));b._valuePrecision=MO.Class.register(b,new MO.APtyInteger("_valuePrecision"),3);return b};
MO.MPropertySelect=function(b){b=MO.Class.inherits(this,b,MO.MUiEditValidator,MO.MUiEditReference,MO.MUiEditZoom);b._editCaseCd=MO.Class.register(b,new MO.APtyString("_editCaseCd"));b._editPattern=MO.Class.register(b,new MO.APtyString("_editPattern"));b._editLength=MO.Class.register(b,new MO.APtyInteger("_editLength"));b._editComplete=MO.Class.register(b,new MO.APtyBoolean("_editComplete"));b._validLengthMin=MO.Class.register(b,new MO.APtyInteger("_validLengthMin"));b._validLengthMax=MO.Class.register(b,
new MO.APtyInteger("_validLengthMax"));b.oeValid=MO.MPropertySelect_oeValid;return b};MO.MPropertySelect_oeValid=function(b){var d=MO.EEventStatus.Stop;if(this._visible&&this._validable){var f=this.text();if(this.validRequire&&!MO.RValidator.validRequire(this,f))return b.controls.push(this),d;this.editLength&&!MO.RValidator.validTextLength(this,f,this.editLength)&&b.controls.push(this)}return d};
MO.MUiComponent=function(b){b=MO.Class.inherits(this,b);b._guid=MO.Class.register(b,[new MO.APtyString("_guid"),new MO.AGetSet("_guid")]);b._name=MO.Class.register(b,[new MO.APtyString("_name"),new MO.AGetSet("_name")]);b._label=MO.Class.register(b,[new MO.APtyString("_label"),new MO.AGetSet("_label")]);b._components=null;b._tag=MO.Class.register(b,new MO.AGetSet("_tag"));b.oeInitialize=MO.MUiComponent_oeInitialize;b.oeRelease=MO.MUiComponent_oeRelease;b.topComponent=MO.MUiComponent_topComponent;
b.hasComponent=MO.MUiComponent_hasComponent;b.findComponent=MO.MUiComponent_findComponent;b.components=MO.MUiComponent_components;b.push=MO.MUiComponent_push;b.remove=MO.MUiComponent_remove;b.clear=MO.MUiComponent_clear;b.process=MO.MUiComponent_process;b.psInitialize=MO.MUiComponent_psInitialize;b.psRelease=MO.MUiComponent_psRelease;b.toString=MO.MUiComponent_toString;b.dispose=MO.MUiComponent_dispose;b.innerDumpInfo=MO.MUiComponent_innerDumpInfo;b.innerDump=MO.MUiComponent_innerDump;return b};
MO.MUiComponent_oeInitialize=function(b){return MO.EEventStatus.Continue};MO.MUiComponent_oeRelease=function(b){return MO.EEventStatus.Continue};MO.MUiComponent_topComponent=function(b){var d=this;if(b)for(;MO.Class.isClass(d._parent,b);)d=d._parent;else for(;d._parent;)d=d._parent;return d};MO.MUiComponent_hasComponent=function(){var b=this._components;return b?!b.isEmpty():!1};MO.MUiComponent_findComponent=function(b){var d=this._components;return d?d.get(b):null};
MO.MUiComponent_components=function(){var b=this._components;null==b&&(this._components=b=new MO.TDictionary);return b};MO.MUiComponent_push=function(b){if(MO.Class.isClass(b,MO.MUiComponent)){var d=this.components(),f=b.name();b.setParent(this);null==f&&(f=d.count(),b.setName(f));d.set(f,b)}};
MO.MUiComponent_remove=function(b){if(!MO.Class.isClass(b,MO.MUiComponent))throw new MO.TError(this,"Parameter is not componet. (component={1})",b);var d=this._components;if(!d.contains(b.name()))throw new MO.TError(this,"Parameter component is not in this component. (name={1})",b.name());d.removeValue(b)};MO.MUiComponent_clear=function(){var b=this._components;b&&b.clear()};
MO.MUiComponent_process=function(b){var d=this.__base[b.clazz];if(d){b.invokeCd=MO.EEventInvoke.Before;var f=this[b.invoke];if(f&&(f=f.call(this,b),f==MO.EEventStatus.Stop||f==MO.EEventStatus.Cancel))return f}var h=this._components;if(h){var q=h.count();if(q)for(var w=0;w<q;w++)if(f=h.at(w).process(b),f==MO.EEventStatus.Cancel)return f}return d&&(b.invokeCd=MO.EEventInvoke.After,f=this[b.invoke])&&(f=f.call(this,b),f==MO.EEventStatus.Stop||f==MO.EEventStatus.Cancel)?f:MO.EEventStatus.Continue};
MO.MUiComponent_psInitialize=function(){var b=new MO.SUiDispatchEvent(this,"oeInitialize",MO.MUiComponent);this.process(b);b.dispose()};MO.MUiComponent_psRelease=function(){var b=new MO.SUiDispatchEvent(this,"oeRelease",MO.MUiComponent);this.process(b);b.dispose()};MO.MUiComponent_toString=function(){return MO.Class.dump(this)+":label="+this._label};MO.MUiComponent_dispose=function(){this._components=MO.Lang.Object.dispose(this._components,!0);this._tag=null};
MO.MUiComponent_innerDumpInfo=function(b){b.append(MO.Class.dump(this));b.append(",name=",this._name);b.append(",label=",this._label)};MO.MUiComponent_innerDump=function(b,d){this.innerdumpInfo(b);var f=this.components;if(f){b.appendLine();for(var h=f.count(),q=0;q<h;q++){var w=f.at(q);w&&w.innerDump(b,d+1)}}return b};
MO.MUiControl=function(b){b=MO.Class.inherits(this,b);b._visible=MO.Class.register(b,[new MO.APtyString("_visible"),new MO.AGetter("_visible")],!0);b._disable=MO.Class.register(b,[new MO.APtyString("_disable"),new MO.AGetter("_disable")],!1);b._dockCd=MO.Class.register(b,[new MO.APtyString("_dockCd"),new MO.AGetSet("_dockCd")],MO.EUiDock.LeftTop);b._anchorCd=MO.Class.register(b,[new MO.APtyString("_anchorCd"),new MO.AGetSet("_anchorCd")],MO.EUiAnchor.None);b._hint=MO.Class.register(b,[new MO.APtyString("_hint"),
new MO.AGetSet("_hint")]);b._eventEnable=null;b._eventVisible=null;b._eventResize=null;b._eventRefresh=null;b._eventFrame=null;b.oeEnable=MO.MUiControl_oeEnable;b.oeVisible=MO.MUiControl_oeVisible;b.oeResize=MO.MUiControl_oeResize;b.oeRefresh=MO.MUiControl_oeRefresh;b.oeFrame=MO.MUiControl_oeFrame;b.psEnable=MO.MUiControl_psEnable;b.psVisible=MO.MUiControl_psVisible;b.psResize=MO.MUiControl_psResize;b.psRefresh=MO.MUiControl_psRefresh;b.psFrame=MO.MUiControl_psFrame;b.dispose=MO.MUiControl_dispose;
return b};MO.MUiControl_oeEnable=function(b){b.isBefore()&&this.setEnable(b.enable);return MO.EEventStatus.Continue};MO.MUiControl_oeVisible=function(b){b.isBefore()&&this.setVisible(b.visible);return MO.EEventStatus.Continue};MO.MUiControl_oeResize=function(b){return MO.EEventStatus.Continue};MO.MUiControl_oeRefresh=function(b){return MO.EEventStatus.Continue};MO.MUiControl_oeFrame=function(b){return MO.EEventStatus.Continue};
MO.MUiControl_psEnable=function(b){var d=this._eventEnable;d||(d=this._eventEnable=new MO.SUiDispatchEvent(this,"oeEnable",MO.MUiControl));d.enable=b;this.process(d)};MO.MUiControl_psVisible=function(b){var d=this._eventVisible;d||(d=this._eventVisible=new MO.SUiDispatchEvent(this,"oeVisible",MO.MUiControl));d.visible=b;this.process(d)};MO.MUiControl_psResize=function(){var b=this._eventResize;b||(b=this._eventResize=new MO.SUiDispatchEvent(this,"oeResize",MO.MUiControl));this.process(b)};
MO.MUiControl_psRefresh=function(){var b=this._eventRefresh;b||(b=this._eventRefresh=new MO.SUiDispatchEvent(this,"oeRefresh",MO.MUiControl));this.process(b)};MO.MUiControl_psFrame=function(){var b=this._eventFrame;b||(b=this._eventFrame=new MO.SUiDispatchEvent(this,"oeFrame",MO.MUiControl));this.process(b)};
MO.MUiControl_dispose=function(){this._eventEnable=MO.Lang.Object.dispose(this._eventEnable);this._eventVisible=MO.Lang.Object.dispose(this._eventVisible);this._eventResize=MO.Lang.Object.dispose(this._eventResize);this._eventRefresh=MO.Lang.Object.dispose(this._eventRefresh);this._eventFrame=MO.Lang.Object.dispose(this._eventFrame)};
MO.MUiMargin=function(b){b=MO.RClass.inherits(this,b);b._margin=MO.RClass.register(b,[new MO.APtyPadding("_margin"),new MO.AGetter("_margin")]);b.construct=MO.MUiMargin_construct;b.setMargin=MO.MUiMargin_setMargin;b.dispose=MO.MUiMargin_dispose;return b};MO.MUiMargin_construct=function(){this._margin=new MO.SPadding};MO.MUiMargin_setMargin=function(b,d,f,h){this._margin.set(b,d,f,h)};MO.MUiMargin_dispose=function(){this._margin=MO.Lang.Object.dispose(this._margin)};
MO.MUiPadding=function(b){b=MO.RClass.inherits(this,b);b._padding=MO.RClass.register(b,[new MO.APtyPadding("_padding"),new MO.AGetter("_padding")]);b.construct=MO.MUiPadding_construct;b.setPadding=MO.MUiPadding_setPadding;b.dispose=MO.MUiPadding_dispose;return b};MO.MUiPadding_construct=function(){this._padding=new MO.SPadding};MO.MUiPadding_setPadding=function(b,d,f,h){this._padding.set(b,d,f,h)};MO.MUiPadding_dispose=function(){this._padding=MO.Lang.Object.dispose(this._padding)};
MO.MUiStorage=function(b){b=MO.Class.inherits(this,b);b._storageCode=null;b._storageObject=null;b.storageGet=MO.MUiStorage_storageGet;b.storageGetBoolean=MO.MUiStorage_storageGetBoolean;b.storageSet=MO.MUiStorage_storageSet;b.storageUpdate=MO.MUiStorage_storageUpdate;b.dispose=MO.MUiStorage_dispose;return b};
MO.MUiStorage_storageGet=function(b,d){if(null==b)throw new MO.TError(this,"Name is empty.");var f=this._storageObject;f||(f=MO.Window.storage(MO.EScope.Local).get(this._storageCode),f=this._storageObject=MO.Json.parse(f,Object));return f&&(f=f[b],null!=f)?f:d};MO.MUiStorage_storageGetBoolean=function(b,d){var f=this.storageGet(b,d);return MO.Lang.Boolean.parse(f)};
MO.MUiStorage_storageSet=function(b,d){if(null==b)throw new TError(this,"Name is empty.");var f=this._storageObject;f||(f=this._storageObject={});f[b]=d};MO.MUiStorage_storageUpdate=function(){var b=this._storageObject;if(b){var d=MO.Window.storage(MO.EScope.Local),b=MO.Json.toString(b);d.set(this._storageCode,b)}};MO.MUiStorage_dispose=function(){this._storageObject=this._storageCode=null};MO.MUiValue=function(b){b=MO.Class.inherits(this,b);b.get=MO.Method.empty;b.set=MO.Method.empty;return b};
MO.Ui=new function(){return this};MO.Gui=new function(){return this};MO.Dui=new function(){return this};MO.SUiDispatchEvent=function(b,d,f){MO.SEvent.call(this);this.owner=b;this.invoke=d;this.clazz=MO.Class.name(f);this.invokeCd=MO.EEventInvoke.Unknown;this.isBefore=MO.SUiDispatchEvent_isBefore;this.isAfter=MO.SUiDispatchEvent_isAfter;this.dispose=MO.SUiDispatchEvent_dispose;this.dump=MO.SUiDispatchEvent_dump;return this};MO.SUiDispatchEvent_isBefore=function(){return this.invokeCd==MO.EEventInvoke.Before};
MO.SUiDispatchEvent_isAfter=function(){return this.invokeCd==MO.EEventInvoke.After};MO.SUiDispatchEvent_dispose=function(){this.invokeCd=this.clazz=this.invoke=this.owner=null};MO.SUiDispatchEvent_dump=function(){return MO.Class.dump(this)+":owner="+this.owner+",type="+this.type+".invoke="+MO.Method.name(this.invoke)};MO.EApplicationConstant=new function(){this.Resource="resource";return this};
MO.FApplication=function(b){b=MO.Class.inherits(this,b,MO.FObject,MO.MListener,MO.MGraphicObject,MO.MEventDispatcher);b._activeChapter=MO.Class.register(b,new MO.AGetter("_activeChapter"));b._chapters=MO.Class.register(b,new MO.AGetter("_chapters"));b._eventEnterFrame=null;b._enterFrameListeners=MO.Class.register(b,new MO.AListener("_enterFrameListeners",MO.EEvent.EnterFrame));b._eventLeaveFrame=null;b._leaveFrameListeners=MO.Class.register(b,new MO.AListener("_leaveFrameListeners",MO.EEvent.LeaveFrame));
b.onProcess=MO.FApplication_onProcess;b.construct=MO.FApplication_construct;b.registerChapter=MO.FApplication_registerChapter;b.unregisterChapter=MO.FApplication_unregisterChapter;b.selectChapter=MO.FApplication_selectChapter;b.selectChapterByCode=MO.FApplication_selectChapterByCode;b.processResize=MO.FApplication_processResize;b.processEvent=MO.FApplication_processEvent;b.process=MO.FApplication_process;b.dispose=MO.FApplication_dispose;return b};
MO.FApplication_onProcess=function(b){(b=this._activeChapter)&&b.process()};MO.FApplication_construct=function(){this.__base.FObject.construct.call(this);this._chapters=new MO.TDictionary;this._eventEnterFrame=new MO.SEvent;this._eventLeaveFrame=new MO.SEvent};MO.FApplication_registerChapter=function(b){var d=b.code();b.setApplication(this);this._chapters.set(d,b)};MO.FApplication_unregisterChapter=function(b){b=b.code();this._chapters.set(b,null)};
MO.FApplication_selectChapter=function(b){if(this._activeChapter!=b){var d=this._activeChapter;d&&(d.deactive(),this._activeChapter=null);b&&(b.active(),this._activeChapter=b)}};MO.FApplication_selectChapterByCode=function(b){b=this._chapters.get(b);this.selectChapter(b);return b};MO.FApplication_processResize=function(){};MO.FApplication_processEvent=function(b){this.dispatcherEvent(b);var d=this._activeChapter;d&&d.processEvent(b)};
MO.FApplication_process=function(){this.processEnterFrameListener(this._eventEnterFrame);this.onProcess();this.processLeaveFrameListener(this._eventLeaveFrame)};MO.FApplication_dispose=function(){this._activeChapter=null;this._chapters=MO.Lang.Object.dispose(this._chapters,!0);this._eventEnterFrame=MO.Lang.Object.dispose(this._eventEnterFrame);this._eventLeaveFrame=MO.Lang.Object.dispose(this._eventLeaveFrame);this.__base.MListener.dispose.call(this);this.__base.FObject.dispose.call(this)};
MO.FChapter=function(b){b=MO.Class.inherits(this,b,MO.FObject,MO.MListener,MO.MGraphicObject,MO.MEventDispatcher);b._code=MO.Class.register(b,new MO.AGetSet("_code"));b._application=MO.Class.register(b,new MO.AGetSet("_application"));b._scenes=MO.Class.register(b,new MO.AGetter("_scenes"));b._activeScene=MO.Class.register(b,new MO.AGetter("_activeScene"));b._statusSetup=!1;b._statusActive=!1;b._eventEnterFrame=null;b._enterFrameListeners=MO.Class.register(b,new MO.AListener("_enterFrameListeners",
MO.EEvent.EnterFrame));b._eventLeaveFrame=null;b._leaveFrameListeners=MO.Class.register(b,new MO.AListener("_leaveFrameListeners",MO.EEvent.LeaveFrame));b.construct=MO.FChapter_construct;b.registerScene=MO.FChapter_registerScene;b.unregisterScene=MO.FChapter_unregisterScene;b.selectScene=MO.FChapter_selectScene;b.selectSceneByCode=MO.FChapter_selectSceneByCode;b.setup=MO.Method.empty;b.active=MO.FChapter_active;b.deactive=MO.FChapter_deactive;b.processEvent=MO.FChapter_processEvent;b.process=MO.FChapter_process;
b.dispose=MO.FChapter_dispose;return b};MO.FChapter_construct=function(){this.__base.FObject.construct.call(this);this._scenes=new MO.TDictionary;this._eventEnterFrame=new MO.SEvent;this._eventLeaveFrame=new MO.SEvent};MO.FChapter_registerScene=function(b){var d=b.code();b.setApplication(this._application);b.setChapter(this);this._scenes.set(d,b)};MO.FChapter_unregisterScene=function(b){b=b.code();this._scenes.set(b,null)};
MO.FChapter_selectScene=function(b){if(this._activeScene!=b){var d=this._activeScene;d&&(d.deactive(),this._activeScene=null);b&&(b.active(),this._activeScene=b)}};MO.FChapter_selectSceneByCode=function(b){b=this._scenes.get(b);this.selectScene(b);return b};MO.FChapter_active=function(){this._statusSetup||(this.setup(),this._statusSetup=!0);this._statusActive=!0};MO.FChapter_deactive=function(){this._statusActive=!1};
MO.FChapter_processEvent=function(b){this.dispatcherEvent(b);var d=this._activeScene;d&&d.processEvent(b)};MO.FChapter_process=function(){this.processEnterFrameListener(this._eventEnterFrame);var b=this._activeScene;b&&b.visible()&&b.process();this.processLeaveFrameListener(this._eventLeaveFrame)};
MO.FChapter_dispose=function(){this._scenes=MO.Lang.Object.dispose(this._scenes);this._eventEnterFrame=MO.Lang.Object.dispose(this._eventEnterFrame);this._eventLeaveFrame=MO.Lang.Object.dispose(this._eventLeaveFrame);this.__base.MListener.dispose.call(this);this.__base.FObject.dispose.call(this)};
MO.FGuiApplication=function(b){b=MO.Class.inherits(this,b,MO.FApplication);b._canvas=MO.Class.register(b,new MO.AGetter("_canvas"));b._manager=MO.Class.register(b,new MO.AGetter("_manager"));b._desktop=MO.Class.register(b,new MO.AGetter("_desktop"));b.construct=MO.FGuiApplication_construct;b.setup=MO.FGuiApplication_setup;b.process=MO.FGuiApplication_process;b.dispose=MO.FGuiApplication_dispose;return b};
MO.FGuiApplication_construct=function(){this.__base.FApplication.construct.call(this);this._chapters=new MO.TDictionary;this._eventEnterFrame=new MO.SEvent;this._eventLeaveFrame=new MO.SEvent};MO.FGuiApplication_setup=function(b){var d=this._desktop=MO.Class.create(MO.FGuiDesktop);d.build(b);b=this._canvas=d.canvas();var f=this._manager=MO.Class.create(MO.FGuiCanvasManager);f.setDesktop(d);f.setCanvas(b)};MO.FGuiApplication_process=function(){this.__base.FApplication.process.call(this);this._manager.process()};
MO.FGuiApplication_dispose=function(){this.__base.FApplication.dispose.call(this)};MO.FGuiDesktop=function(b){b=MO.Class.inherits(this,b,MO.FDesktop);b._canvas=MO.Class.register(b,new MO.AGetter("_canvas"));b.onOperationResize=MO.FGuiDesktop_onOperationResize;b.onOperationOrientation=MO.FGuiDesktop_onOperationOrientation;b.construct=MO.FGuiDesktop_construct;b.build=MO.FGuiDesktop_build;b.resize=MO.FGuiDesktop_resize;b.dispose=MO.FGuiDesktop_dispose;return b};
MO.FGuiDesktop_onOperationResize=function(b){this.__base.FDesktop.onOperationResize.call(this,b);this.resize()};MO.FGuiDesktop_onOperationOrientation=function(){this.__base.FDesktop.onOperationOrientation.call(this,event);this.resize()};MO.FGuiDesktop_construct=function(){this.__base.FDesktop.construct.call(this);this._size.set(1920,1080);this._logicSize.set(1920,1080);this._screenSize.set(0,0)};
MO.FGuiDesktop_build=function(b){this.__base.FDesktop.build.call(this,b);var d=this._canvas=MO.RClass.create(MO.FE2dCanvas);d.setDesktop(this);d.build(b);d.setPanel(b);d._hCanvas.style.position="absolute";this.canvasRegister(d);MO.RE3dEngine.setup()};
MO.FGuiDesktop_resize=function(b,d){var f=null!=b?b:window.innerWidth,h=null!=d?d:window.innerHeight;if(!this._screenSize.equalsData(f,h)){this._screenSize.set(f,h);var q=MO.Browser.capability().pixelRatio;MO.Logger.info(this,"Change screen size. (size={1}x{2}, pixel_ratio={3})",f,h,q);var f=f*q,h=h*q,w=q=1,z=this._logicSize;MO.Browser.isOrientationHorizontal()?(q=f/z.width,w=h/z.height,this._calculateSize.set(z.width,z.height)):(q=f/z.height,w=h/z.width,this._calculateSize.set(z.height,z.width));
z=this._sizeRate=Math.min(q,w);this._logicRate.set(q,w);q>w?this._calculateRate.set(q/z,1):q<w?this._calculateRate.set(1,w/z):this._calculateRate.set(1,1);this._canvas3d.resize(f,h);q=this._canvas;q.resize(f,h);q.context().setGlobalScale(z,z)}};MO.FGuiDesktop_dispose=function(){this._canvas3d=MO.RObject.dispose(this._canvas3d);this._canvas=MO.RObject.dispose(this._canvas);this.__base.FDesktop.dispose.call(this)};
MO.FScene=function(b){b=MO.Class.inherits(this,b,MO.FObject,MO.MListener,MO.MGraphicObject,MO.MEventDispatcher);b._visible=MO.Class.register(b,new MO.AGetSet("_visible"),!0);b._code=MO.Class.register(b,new MO.AGetSet("_code"));b._application=MO.Class.register(b,new MO.AGetSet("_application"));b._chapter=MO.Class.register(b,new MO.AGetSet("_chapter"));b._activeStage=MO.Class.register(b,new MO.AGetSet("_activeStage"));b._statusSetup=!1;b._statusActive=!1;b._eventEnterFrame=null;b._enterFrameListeners=
MO.Class.register(b,new MO.AListener("_enterFrameListeners",MO.EEvent.EnterFrame));b._eventLeaveFrame=null;b._leaveFrameListeners=MO.Class.register(b,new MO.AListener("_leaveFrameListeners",MO.EEvent.LeaveFrame));b.onProcessBefore=MO.Method.empty;b.onProcess=MO.FScene_onProcess;b.onProcessAfter=MO.Method.empty;b.construct=MO.FScene_construct;b.setup=MO.FScene_setup;b.active=MO.FScene_active;b.deactive=MO.FScene_deactive;b.processEvent=MO.FScene_processEvent;b.process=MO.FScene_process;b.dispose=MO.FScene_dispose;
return b};MO.FScene_onProcess=function(){this.processEnterFrameListener(this._eventEnterFrame);this._activeStage&&this._activeStage.process();this.processLeaveFrameListener(this._eventLeaveFrame)};MO.FScene_construct=function(){this.__base.FObject.construct.call(this);this._eventEnterFrame=new MO.SEvent;this._eventLeaveFrame=new MO.SEvent};MO.FScene_setup=function(){};MO.FScene_active=function(){this._statusSetup||(this.setup(),this._statusSetup=!0);this._statusActive=!0};
MO.FScene_deactive=function(){this._statusActive=!1};MO.FScene_process=function(){this._statusActive&&(this.processEnterFrameListener(this._eventEnterFrame),this.onProcessBefore(),this.onProcess(),this._activeStage&&this._activeStage.process(),this.onProcessAfter(),this.processLeaveFrameListener(this._eventLeaveFrame))};MO.FScene_processEvent=function(b){this.dispatcherEvent(b)};
MO.FScene_dispose=function(){this._eventEnterFrame=MO.Lang.Object.dispose(this._eventEnterFrame);this._eventLeaveFrame=MO.Lang.Object.dispose(this._eventLeaveFrame);this.__base.MListener.dispose.call(this);this.__base.FObject.dispose.call(this)};MO.FTestApplication=function(b){b=MO.Class.inherits(this,b,MO.FApplication);b.setup=MO.FTestApplication_setup;return b};
MO.FTestApplication_setup=function(b){var d=new MO.TXmlNode("Configuration"),f=MO.Window.Browser.agent(),h=d.create("Browser"),q=h.create("Desktop");q.create("Context2d");q=q.create("Context3d");MO.Window.Browser.saveConfig(h);b=MO.Window.Builder.create(b,"CANVAS");if(b=MO.Graphic.Context3d.createContext(MO.FWglContext,b))(h=b.parameter("VERSION"))&&(f+="|"+h),(h=b.parameter("SHADING_LANGUAGE_VERSION"))&&(f+="|"+h),(h=b.parameter("UNMASKED_RENDERER_WEBGL"))&&(f+="|"+h),b.saveConfig(q);d.set("identity_code",
f);MO.Console.find(MO.FServiceConsole).send("cloud.info.device","access",d)};MO.RApplication=function(){this._workspaces=new MO.TDictionary;return this};MO.RApplication.prototype.initialize=function(){MO.Window.Browser.construct();MO.Window.connect(window);MO.Window.Keyboard.construct()};MO.RApplication.prototype.findWorkspace=function(b){var d=MO.Class.name(b),f=this._workspaces,h=f.get(d);null==h&&(h=MO.Class.create(b),f.set(d,h));return h};MO.RApplication.prototype.release=function(){try{CollectGarbage()}catch(b){MO.Logger.error(b)}};
MO.RApplication=new MO.RApplication;MO.RDesktop=function(){this._application=null;this._workspaces=new MO.TDictionary;this._thread=null;this._interval=20;return this};MO.RDesktop.prototype.onProcessEvent=function(b){var d=this._application;d&&d.processEvent(b)};MO.RDesktop.prototype.onProcess=function(b){(b=this._application)&&b.process()};MO.RDesktop.prototype.application=function(){return this._application};
MO.RDesktop.prototype.initialize=function(b){MO.Window.Browser.construct();MO.Window.connect(window);MO.Window.Keyboard.construct();MO.Window.lsnsMouseDown.register(this,this.onProcessEvent);MO.Window.lsnsMouseMove.register(this,this.onProcessEvent);MO.Window.lsnsMouseUp.register(this,this.onProcessEvent);MO.Window.lsnsMouseWheel.register(this,this.onProcessEvent);MO.Window.lsnsKeyDown.register(this,this.onProcessEvent);MO.Window.lsnsKeyPress.register(this,this.onProcessEvent);MO.Window.lsnsKeyUp.register(this,
this.onProcessEvent);MO.Window.lsnsResize.register(this,this.onProcessEvent);MO.Window.lsnsVisibility.register(this,this.onProcessEvent);MO.Window.lsnsOrientation.register(this,this.onProcessEvent);var d=this._thread=MO.Class.create(MO.FThread);d.setInterval(this._interval);d.addProcessListener(this,this.process);MO.Console.find(MO.FThreadConsole).start(d);MO.Timer.setup();return MO.Application=this._application=MO.Class.create(b)};
MO.RDesktop.prototype.findWorkspace=function(b){var d=MO.Class.name(b),f=this._workspaces,h=f.get(d);null==h&&(h=MO.Class.create(b),f.set(d,h));return h};MO.RDesktop.prototype.process=function(){this.onProcess();MO.Timer.update()};MO.RDesktop.prototype.release=function(){try{CollectGarbage()}catch(b){MO.Logger.error(b)}};MO.Desktop=new MO.RDesktop;
MO.MGuiBorder=function(b){b=MO.RClass.inherits(this,b);b._borderInner=MO.RClass.register(b,[new MO.APtyBorder("_borderInner"),new MO.AGetter("_borderInner")]);b._borderOuter=MO.RClass.register(b,[new MO.APtyBorder("_borderOuter"),new MO.AGetter("_borderOuter")]);b.construct=MO.MGuiBorder_construct;b.dispose=MO.MGuiBorder_dispose;return b};MO.MGuiBorder_construct=function(){this._borderInner=new MO.SBorder;this._borderOuter=new MO.SBorder};
MO.MGuiBorder_dispose=function(){this._borderInner=MO.Lang.Object.dispose(this._borderInner);this._borderOuter=MO.Lang.Object.dispose(this._borderOuter)};MO.MGuiContainer=function(b){b=MO.Class.inherits(this,b);b.createChild=MO.MGuiContainer_createChild;b.appendChild=MO.Method.empty;b.removeChild=MO.Method.empty;return b};MO.MGuiContainer_createChild=function(b){b=MO.RGuiControl.newInstance(b);b._parent=this;return b};
MO.MGuiDispatcher=function(b){b=MO.Class.inherits(this,b);b.onOperationDown=MO.MGuiDispatcher_onOperationDown;b.onOperationMove=MO.MGuiDispatcher_onOperationMove;b.onOperationUp=MO.MGuiDispatcher_onOperationUp;b.onOperationResize=MO.MGuiDispatcher_onOperationResize;b.dispatcherEvent=MO.MGuiDispatcher_dispatcherEvent;return b};MO.MGuiDispatcher_onOperationDown=function(b){};MO.MGuiDispatcher_onOperationMove=function(b){};MO.MGuiDispatcher_onOperationUp=function(b){};
MO.MGuiDispatcher_onOperationResize=function(b){};MO.MGuiDispatcher_dispatcherEvent=function(b){switch(b.code){case MO.EEvent.MouseDown:this.onOperationDown(b);break;case MO.EEvent.MouseMove:this.onOperationMove(b);break;case MO.EEvent.MouseUp:this.onOperationUp(b);break;case MO.EEvent.Resize:this.onOperationResize(b);break;default:throw new MO.TError("Unknown event type.");}};
MO.MGuiLocation=function(b){b=MO.Class.inherits(this,b);b._left=MO.Class.register(b,[new MO.APtyInteger("_left"),new MO.AGetSet("_left")]);b._right=MO.Class.register(b,[new MO.APtyInteger("_right"),new MO.AGetSet("_right")]);b._top=MO.Class.register(b,[new MO.APtyInteger("_top"),new MO.AGetSet("_top")]);b._bottom=MO.Class.register(b,[new MO.APtyInteger("_bottom"),new MO.AGetSet("_bottom")]);return b};
MO.MGuiSize=function(b){b=MO.Class.inherits(this,b);b._location=MO.Class.register(b,[new MO.APtyPoint2("_location"),new MO.AGetter("_location")]);b._right=MO.Class.register(b,[new MO.APtyInteger("_right"),new MO.AGetSet("_right")],0);b._bottom=MO.Class.register(b,[new MO.APtyInteger("_bottom"),new MO.AGetSet("_bottom")],0);b._size=MO.Class.register(b,[new MO.APtySize2("_size"),new MO.AGetter("_size")]);b._scale=MO.Class.register(b,[new MO.APtySize2("_scale"),new MO.AGetter("_scale")]);b.construct=
MO.MGuiSize_construct;b.left=MO.MGuiSize_left;b.setLeft=MO.MGuiSize_setLeft;b.top=MO.MGuiSize_top;b.setTop=MO.MGuiSize_setTop;b.setLocation=MO.MGuiSize_setLocation;b.width=MO.MGuiSize_width;b.setWidth=MO.MGuiSize_setWidth;b.height=MO.MGuiSize_height;b.setHeight=MO.MGuiSize_setHeight;b.setSize=MO.MGuiSize_setSize;b.setScale=MO.MGuiSize_setScale;b.setBounds=MO.MGuiSize_setBounds;b.dispose=MO.MGuiSize_dispose;return b};
MO.MGuiSize_construct=function(){this._location=new MO.SPoint2(0,0);this._size=new MO.SSize2(128,128);this._scale=new MO.SSize2(1,1)};MO.MGuiSize_left=function(){return this._location.x};MO.MGuiSize_setLeft=function(b){this.setLocation(b,this._location.y)};MO.MGuiSize_top=function(){return this._location.y};MO.MGuiSize_setTop=function(b){this.setLocation(this._location.x,b)};MO.MGuiSize_setLocation=function(b,d){this._location.set(b,d)};MO.MGuiSize_width=function(){return this._size.width};
MO.MGuiSize_setWidth=function(b){this.setSize(b,this._size.height)};MO.MGuiSize_height=function(){return this._size.height};MO.MGuiSize_setHeight=function(b){this.setSize(this._size.width,b)};MO.MGuiSize_setSize=function(b,d){this._size.set(b,d)};MO.MGuiSize_setScale=function(b,d){this._scale.set(b,d)};MO.MGuiSize_setBounds=function(b,d,f,h){this.setLocation(b,d);this.setSize(f,h)};
MO.MGuiSize_dispose=function(){this._location=RObject.dispose(this._location);this._size=RObject.dispose(this._size);this._scale=RObject.dispose(this._scale)};MO.SGuiImage=function(){this.ready=!1;this.resource=this.bitmap=null;this.onImageLoad=MO.SGuiImage_onImageLoad;this.testReady=MO.SGuiImage_testReady;this.load=MO.SGuiImage_load;this.dispose=MO.SGuiImage_dispose;return this};MO.SGuiImage_onImageLoad=function(b){this.ready=!0};MO.SGuiImage_testReady=function(){return this.ready};
MO.SGuiImage_load=function(){this.ready=!1;var b=null;if(MO.Lang.String.startsWith(this.resource,"url:"))b=this.resource.substring(4),b=MO.Console.find(MO.FEnvironmentConsole).parse(b);else throw new MO.TError("Invalid url.");var d=this.bitmap=MO.Class.create(MO.FImage);d.addLoadListener(this,this.onImageLoad);d.loadUrl(b)};MO.SGuiImage_dispose=function(){this.bitmap=MO.RObject.dispose(this.bitmap);return this};
MO.SGuiPaintEvent=function(){this.graphic=null;this.parentRectangle=new MO.SRectangle;this.rectangle=new MO.SRectangle;this.free=MO.SGuiPaintEvent_free;this.dispose=MO.SGuiPaintEvent_dispose;return this};MO.SGuiPaintEvent_free=function(){this.graphic=null;return this};MO.SGuiPaintEvent_dispose=function(){this.parentRectangle=MO.RObject.dispose(this.parentRectangle);this.rectangle=MO.RObject.dispose(this.rectangle);return this};
MO.SGuiUpdateEvent=function(){this.flag=!1;this.rectangle=new MO.SRectangle;this.isBefore=MO.SGuiUpdateEvent_isBefore;this.isAfter=MO.SGuiUpdateEvent_isAfter;this.dispose=MO.SGuiUpdateEvent_dispose;return this};MO.SGuiUpdateEvent_isBefore=function(){return this.flag};MO.SGuiUpdateEvent_isAfter=function(){return!this.flag};MO.SGuiUpdateEvent_dispose=function(){this.rectangle=MO.RObject.dispose(this.rectangle);return this};
MO.FGuiAction=function(b){b=MO.Class.inherits(this,b,MO.FObject,MO.MListener,MO.MTimelineAction);b._controls=MO.Class.register(b,[new MO.AGetter("_controls")]);b._listenersProcess=MO.Class.register(b,new MO.AListener("_listenersProcess",MO.EEvent.Process));b._listenersComplete=MO.Class.register(b,new MO.AListener("_listenersComplete",MO.EEvent.Complete));b.construct=MO.FGuiAction_construct;b.push=MO.FGuiAction_push;b.startControl=MO.FGuiAction_startControl;b.start=MO.FGuiAction_start;b.processControl=
MO.FGuiAction_processControl;b.process=MO.FGuiAction_process;b.dispose=MO.FGuiAction_dispose;return b};MO.FGuiAction_construct=function(){this.__base.FObject.construct.call(this);this.__base.MTimelineAction.construct.call(this);this._controls=new MO.TObjects};MO.FGuiAction_push=function(b){this._controls.push(b)};MO.FGuiAction_startControl=function(b,d){};
MO.FGuiAction_start=function(b){this.__base.MTimelineAction.start.call(this);for(var d=this._controls,f=d.count(),h=0;h<f;h++){var q=d.at(h);this.startControl(b,q)}};MO.FGuiAction_processControl=function(b,d){};MO.FGuiAction_process=function(b){this.__base.MTimelineAction.process.call(this);for(var d=this._controls,f=d.count(),h=0;h<f;h++){var q=d.at(h);this.processControl(b,q)}};
MO.FGuiAction_dispose=function(){this._controls=MO.Lang.Object.dispose(this._controls);this.__base.MTimelineAction.dispose.call(this);this.__base.MListener.dispose.call(this);this.__base.FObject.dispose.call(this)};
MO.FGuiActionAlpha=function(b){b=MO.Class.inherits(this,b,MO.FGuiAction);b._alphaBegin=MO.Class.register(b,[new MO.AGetSet("_alphaBegin")],0);b._alphaEnd=MO.Class.register(b,[new MO.AGetSet("_alphaEnd")],1);b._alphaInterval=MO.Class.register(b,[new MO.AGetSet("_alphaInterval")],.1);b._alphaCurrent=0;b._eventProcess=null;b._eventFinish=null;b.construct=MO.FGuiActionAlpha_construct;b.doComplete=MO.FGuiActionAlpha_doComplete;b.startControl=MO.FGuiActionAlpha_startControl;b.processControl=MO.FGuiActionAlpha_processControl;
b.dispose=MO.FGuiActionAlpha_dispose;return b};MO.FGuiActionAlpha_construct=function(){this.__base.FGuiAction.construct.call(this);this._eventProcess=new MO.SEvent;this._eventFinish=new MO.SEvent};MO.FGuiActionAlpha_doComplete=function(){this.processCompleteListener(this._eventProcess);this._alphaCurrent=this._alphaEnd;this._statusStop=!0};MO.FGuiActionAlpha_startControl=function(b,d){this.__base.FGuiAction.startControl.call(this);this._alphaCurrent=this._alphaBegin};
MO.FGuiActionAlpha_processControl=function(b,d){this.__base.FGuiAction.processControl.call(this);this._alphaCurrent+=this._alphaInterval;0<this._alphaInterval?this._alphaCurrent>=this._alphaEnd&&this.doComplete():0>this._alphaInterval?this._alphaCurrent<=this._alphaEnd&&this.doComplete():this.doComplete();if(!this._statusStop){var f=this._eventProcess;f.alpha=this._alphaCurrent;this.processProcessListener(f)}d.doActionAlpha(this._alphaCurrent)};
MO.FGuiActionAlpha_dispose=function(){this._eventProcess=MO.Lang.Object.dispose(this._eventProcess);this._eventFinish=MO.Lang.Object.dispose(this._eventFinish);this.__base.FGuiAction.dispose.call(this)};MO.FGuiComponent=function(b){b=MO.Class.inherits(this,b,MO.FComponent,MO.MUiComponent,MO.MProperty);b.dispose=MO.FGuiComponent_dispose;return b};MO.FGuiComponent_dispose=function(){this.__base.MUiComponent.dispose.call(this);this.__base.FComponent.dispose.call(this)};
MO.FGuiContainer=function(b){return b=MO.Class.inherits(this,b,MO.FGuiControl,MO.MGuiContainer)};
MO.FGuiControl=function(b){b=MO.Class.inherits(this,b,MO.FGuiComponent,MO.MUiControl,MO.MGraphicObject,MO.MRenderableLinker,MO.MListener,MO.MGuiSize,MO.MUiMargin,MO.MUiPadding,MO.MGuiBorder);b._optionScale=MO.Class.register(b,[new MO.AGetter("_optionScale")],!0);b._alpha=MO.Class.register(b,[new MO.APtyString("_alpha"),new MO.AGetSet("_alpha")],1);b._displayOrder=MO.Class.register(b,[new MO.APtyString("_displayOrder"),new MO.AGetSet("_displayOrder")],0);b._foreColor=MO.Class.register(b,[new MO.APtyString("_foreColor"),
new MO.AGetSet("_foreColor")],"#FFFFFF");b._foreFont=MO.Class.register(b,[new MO.APtyString("_foreFont"),new MO.AGetSet("_foreFont")]);b._backColor=MO.Class.register(b,[new MO.APtyString("_backColor"),new MO.AGetSet("_backColor")]);b._backResource=MO.Class.register(b,[new MO.APtyString("_backResource"),new MO.AGetSet("_backResource")]);b._backGrid=MO.Class.register(b,[new MO.APtyPadding("_backGrid"),new MO.AGetter("_backGrid")]);b._backHoverColor=MO.Class.register(b,[new MO.APtyString("_backHoverColor"),
new MO.AGetSet("_backHoverColor")]);b._backHoverResource=MO.Class.register(b,[new MO.APtyString("_backHoverResource"),new MO.AGetSet("_backHoverResource")]);b._backHoverGrid=MO.Class.register(b,[new MO.APtyPadding("_backHoverGrid"),new MO.AGetter("_backHoverGrid")]);b._manager=MO.Class.register(b,new MO.AGetSet("_manager"));b._statusReady=!1;b._statusDirty=!0;b._statusHover=!1;b._backImage=null;b._backHoverResource=null;b._clientRectangle=MO.Class.register(b,new MO.AGetter("_clientRectangle"));b._eventRectangle=
null;b._operationDownListeners=MO.Class.register(b,new MO.AListener("_operationDownListeners",MO.EEvent.OperationDown));b._operationMoveListeners=MO.Class.register(b,new MO.AListener("_operationMoveListeners",MO.EEvent.OperationMove));b._operationUpListeners=MO.Class.register(b,new MO.AListener("_operationUpListeners",MO.EEvent.OperationUp));b.onUpdate=MO.FGuiControl_onUpdate;b.onPaintBegin=MO.FGuiControl_onPaintBegin;b.onPaintEnd=MO.FGuiControl_onPaintEnd;b.onOperationDown=MO.FGuiControl_onOperationDown;
b.onOperationMove=MO.FGuiControl_onOperationMove;b.onOperationUp=MO.FGuiControl_onOperationUp;b.onEvent=MO.FGuiControl_onEvent;b.oeInitialize=MO.FGuiControl_oeInitialize;b.oeResize=MO.FGuiControl_oeResize;b.oeUpdate=MO.FGuiControl_oeUpdate;b.construct=MO.FGuiControl_construct;b.isReady=MO.FGuiControl_isReady;b.isDirty=MO.FGuiControl_isDirty;b.setVisible=MO.FGuiControl_setVisible;b.setSize=MO.FGuiControl_setSize;b.testReady=MO.FGuiControl_testReady;b.testDirty=MO.FGuiControl_testDirty;b.testInRange=
MO.FGuiControl_testInRange;b.paint=MO.FGuiControl_paint;b.update=MO.FGuiControl_update;b.build=MO.FGuiControl_build;b.processReady=MO.FGuiControl_processReady;b.processEvent=MO.FGuiControl_processEvent;b.dirty=MO.FGuiControl_dirty;b.psPaint=MO.FGuiControl_psPaint;b.psUpdate=MO.FGuiControl_psUpdate;b.dispose=MO.FGuiControl_dispose;return b};MO.FGuiControl_onUpdate=function(b){var d=this._components;if(d)for(var f=d.count(),h=0;h<f;h++){var q=d.at(h);if(MO.Class.isClass(q,MO.FGuiControl))q.onUpdate(b)}};
MO.FGuiControl_onPaintBegin=function(b){var d=b.graphic;b=b.rectangle;this._backColor&&d.fillRectangle(b.left,b.top,b.width,b.height,this._styleBackcolor,1);var f=null,h=null;this._statusHover?(f=this._backHoverImage,h=this._backHoverGrid):(f=this._backImage,h=this._backGrid);f&&(h&&!h.isEmpty()?d.drawGridImage(f.bitmap,b.left,b.top,b.width,b.height,h):d.drawImage(f.bitmap,b.left,b.top,b.width,b.height));this._borderOuter.valid&&d.drawBorder(b,this._borderOuter);this._borderInner.valid&&d.drawBorder(b,
this._borderInner)};MO.FGuiControl_onPaintEnd=function(b){};MO.FGuiControl_onOperationDown=function(b){b.flag&&this.processOperationDownListener(b)};MO.FGuiControl_onOperationMove=function(b){b.flag&&this.processOperationMoveListener(b)};MO.FGuiControl_onOperationUp=function(b){b.flag&&this.processOperationUpListener(b)};
MO.FGuiControl_onEvent=function(b,d){b.flag=d;switch(b.code){case MO.EEvent.MouseDown:this.onOperationDown(b);break;case MO.EEvent.MouseMove:this.onOperationMove(b);break;case MO.EEvent.MouseUp:this.onOperationUp(b);break;default:throw new TError("Unknown event type.");}};
MO.FGuiControl_oeInitialize=function(b){var d=this.__base.FGuiComponent.oeInitialize.call(this,b);b.isBefore()&&(this._backResource&&(b=this._backImage=new MO.SGuiImage,b.resource=this._backResource,b.load()),this._backHoverResource&&(b=this._backHoverImage=new MO.SGuiImage,b.resource=this._backHoverResource,b.load()));return d};MO.FGuiControl_oeResize=function(b){return MO.EEventStatus.Continue};MO.FGuiControl_oeUpdate=function(b){return MO.EEventStatus.Continue};
MO.FGuiControl_construct=function(){this.__base.FGuiComponent.construct.call(this);this.__base.MGuiSize.construct.call(this);this.__base.MUiMargin.construct.call(this);this.__base.MUiPadding.construct.call(this);this.__base.MGuiBorder.construct.call(this);this._clientRectangle=new MO.SRectangle;this._eventRectangle=new MO.SRectangle};MO.FGuiControl_isReady=function(){return this._statusReady};MO.FGuiControl_isDirty=function(){return this._statusDirty};
MO.FGuiControl_setVisible=function(b){this._visible=b;(b=this._manager)&&b.dirty()};MO.FGuiControl_setSize=function(b,d){this.__base.MGuiSize.setSize.call(this,b,d);var f=this._renderable;f&&f.setSize(b,d)};MO.FGuiControl_testReady=function(){var b=this._backImage;return b&&!b.testReady()?!1:(b=this._backHoverImage)&&!b.testReady()?!1:!0};
MO.FGuiControl_testDirty=function(){var b=this._components;if(b)for(var d=b.count(),f=0;f<d;f++){var h=b.at(f);if(MO.Class.isClass(h,MO.FGuiControl)&&h.testDirty()){this._statusDirty=!0;break}}return this._statusDirty};MO.FGuiControl_testInRange=function(b,d){};
MO.FGuiControl_paint=function(b){var d=this._location,f=this._size,h=b.graphic,q=b.parentRectangle,w=b.calculateRate,z=b.rectangle;this._eventRectangle.assign(z);var A=this._dockCd,B=this._anchorCd,C=z.left+d.x,d=z.top+d.y,D=f.width,f=f.height,E=q.right(),q=q.bottom(),F=E-this._right,H=q-this._bottom;b.optionContainer&&(C*=w.width,d*=w.height,F*=w.width,H*=w.height);if(A==MO.EUiDock.LeftBottom||A==MO.EUiDock.Bottom||A==MO.EUiDock.RightBottom)d=H-f;if(A==MO.EUiDock.RightTop||A==MO.EUiDock.Right||A==
MO.EUiDock.RightBottom)C=F-D;B&MO.EUiAnchor.Left&&B&MO.EUiAnchor.Right?D=F-C:this._anchorCd&MO.EUiAnchor.Left&&(C=(E-D-this._right)*w.width,D=F-C);B&MO.EUiAnchor.Top&&this._anchorCd&MO.EUiAnchor.Bottom?f=H-d:this._anchorCd&MO.EUiAnchor.Top&&(d=(q-f-this._bottom)*w.height,f=H-d);b.optionContainer=!1;h.store();z.set(C,d,Math.max(D,0),Math.max(f,0));h.scale();this._clientRectangle.assign(z);h.setScale(this._scale.width,this._scale.height);this.onPaintBegin(b);if(w=this._components)for(A=w.count(),B=
0;B<A;B++)C=w.at(B),MO.Class.isClass(C,MO.FGuiControl)&&C.paint(b);this.onPaintEnd(b);h.restore();z.assign(this._eventRectangle);this._statusDirty=!1};MO.FGuiControl_update=function(){var b=this._size,d=MO.Memory.alloc(SGuiUpdateEvent);d.rectangle.set(0,0,b.width,b.height);this.onUpdate(d);MO.Memory.free(d)};MO.FGuiControl_dirty=function(){this._statusDirty=!0};MO.FGuiControl_build=function(){};MO.FGuiControl_processReady=function(){this._statusReady||(this._statusReady=this.testReady());return this._statusReady};
MO.FGuiControl_processEvent=function(b){if(this.testInRange(b.locationX,b.locationY)){this.onEvent(b,!0);var d=this._components;if(d)for(var f=d.count(),h=0;h<f&&!d.at(h).processEvent(b);h++);this.onEvent(b,!1);return!0}return!1};MO.FGuiControl_psPaint=function(b){b=new MO.SUiDispatchEvent(this,"oeParint",MO.FGuiControl);this.process(b);b.dispose()};MO.FGuiControl_psUpdate=function(){var b=new MO.SUiDispatchEvent(this,"oeUpdate",MO.FGuiControl);this.process(b);b.dispose()};
MO.FGuiControl_dispose=function(){this._backImage=MO.RObject.dispose(this._backImage);this._backHoverImage=MO.RObject.dispose(this._backHoverImage);this._clientRectangle=MO.RObject.dispose(this._clientRectangle);this.__base.MGuiBorder.dispose.call(this);this.__base.MUiPadding.dispose.call(this);this.__base.MUiMargin.dispose.call(this);this.__base.MGuiSize.dispose.call(this);this.__base.MRenderableLinker.dispose.call(this);this.__base.MGraphicObject.dispose.call(this);this.__base.MUiControl.dispose.call(this);
this.__base.FGuiComponent.dispose.call(this)};
MO.FGuiControlRenderable=function(b){b=MO.Class.inherits(this,b,MO.FE3dFaceData);b._optionFull=MO.Class.register(b,new MO.AGetSet("_optionFull"));b._control=MO.Class.register(b,new MO.AGetSet("_control"));b._graphic=null;b.construct=MO.FGuiControlRenderable_construct;b.setup=MO.FGuiControlRenderable_setup;b.setLocation=MO.FGuiControlRenderable_setLocation;b.setSize=MO.FGuiControlRenderable_setSize;b.beginDraw=MO.FGuiControlRenderable_beginDraw;b.endDraw=MO.FGuiControlRenderable_endDraw;b.dispose=
MO.FGuiControlRenderable_dispose;return b};MO.FGuiControlRenderable_construct=function(){this.__base.FE3dFaceData.construct.call(this)};MO.FGuiControlRenderable_setup=function(){this.__base.FE3dFaceData.setup.call(this);var b=this._material.info();b.effectCode="gui";b.optionAlpha=!0;b.optionDepth=!1;b.optionDouble=!0};MO.FGuiControlRenderable_setLocation=function(b,d){this._matrix.setTranslate(b,d,0)};MO.FGuiControlRenderable_setSize=function(b,d){this._size.set(b,d)};
MO.FGuiControlRenderable_beginDraw=function(){var b=this._size,d=MO.Lang.Integer.pow2(b.width),b=MO.Lang.Integer.pow2(b.height);this._adjustSize.set(d,b);this._matrix.setScale(d,b,1);return this._graphic=(this._canvas=MO.Console.find(MO.FE2dCanvasConsole).allocBySize(d,b)).context()};MO.FGuiControlRenderable_endDraw=function(){this._texture.upload(this._canvas);MO.Console.find(MO.FE2dCanvasConsole).free(this._canvas);this._graphic=this._canvas=null;this._ready=!0};
MO.FGuiControlRenderable_dispose=function(){this.__base.FE3dFaceData.dispose.call(this)};MO.FGuiFrame=function(b){return b=MO.Class.inherits(this,b,MO.FGuiContainer)};
MO.FGuiSpriteMultimage=function(b){b=MO.Class.inherits(this,b,MO.FGuiControl);b._sequenceImages=null;b._frameTime=MO.Class.register(b,new MO.AGetSet("_frameTime"));b._ready=MO.Class.register(b,new MO.AGetSet("_ready"),!1);b._imageCount=0;b._imageToLoad=0;b._lastTick=0;b._currentFrame=0;b.setup=MO.FGuiSpriteMultimage_setup;b.onPaintBegin=MO.FGuiSpriteMultimage_onPaintBegin;b.onImageLoad=MO.FGuiSpriteMultimage_onImageLoad;return b};
MO.FGuiSpriteMultimage_setup=function(b,d,f){this._imageToLoad=this._imageCount=d;for(var h=this._sequenceImages=Array(d),q=0;q<d;q++)h[q]=MO.Class.create(MO.FImage),h[q].addLoadListener(this,this.onImageLoad),h[q].loadUrl(b+q+f)};MO.FGuiSpriteMultimage_onImageLoad=function(){0==--this._imageToLoad&&(this._ready=!0,this._lastTick=MO.Timer.current(),this.dirty())};
MO.FGuiSpriteMultimage_onPaintBegin=function(b){if(this._ready){this.__base.FGuiControl.onPaintBegin.call(this,b);var d=b.graphic;b=b.rectangle;MO.Timer.current()-this._lastTick>this._frameTime&&(++this._currentFrame>this._imageCount-1&&(this._currentFrame=0),this._lastTick=MO.Timer.current());d._handle.drawImage(this._sequenceImages[this._currentFrame].image(),b.left,b.top,b.width,b.height)}};MO.RGuiColor=function(){return this};
MO.RGuiColor.prototype.makeRgbString=function(b,d){var f=b.substring(2,4),h=b.substring(4,6),q=b.substring(6,8);return"rgba("+MO.Lang.Hex.parse(f)+","+MO.Lang.Hex.parse(h)+","+MO.Lang.Hex.parse(q)+","+d+")"};MO.GuiColor=new MO.RGuiColor;MO.RGuiControl=function(){this.PREFIX="FGui";return this};
MO.RGuiControl.prototype.newInstance=function(b){var d=null;if(b){var f=d=null;if(b.constructor==String)MO.Lang.String.startsWith(b,this.PREFIX)||(d=this.PREFIX+b);else if(b.constructor==MO.TXmlNode)d=b.get("type"),MO.Lang.String.isEmpty(d)?(d=b.name(),MO.Lang.String.startsWith(d,this.PREFIX)||(d=this.PREFIX+d)):f=d;else throw new MO.TError(this,"Unknown parameter. (type={1})",b);d=MO.Class.create(d);f&&(d.__typed=!0)}if(null==d)throw new MO.TError(this,"Create instance failure. (type={1})",b);return d};
MO.RGuiControl.prototype.attachEvent=function(b,d,f,h,q){var w=null;d=b[d];if(!MO.Method.isEmpty(d)||h){var z=MO.Class.find(b.constructor).annotation(EAnnotation.Event,n),w=z.create();w.annotation=z;w.source=b;w.hSource=f;w.ohProcess=h;w.onProcess=d;w.process=MO.RUiEvent.onProcess;MO.RUiEvent.find(f).push(z.linker(),w);MO.RHtml.linkSet(f,"_plink",c);z.bind(f,q)}return w};
MO.RGuiControl.prototype.innerbuild=function(b,d,f,h){if(null!=d&&null!=f){MO.Class.isClass(d,MO.MProperty)&&d.propertyLoad(f);var q=f.get("linker");q&&b&&(b[q]=d);MO.Class.isClass(d,MO.FGuiControl);d.__typed&&(b=d);if(MO.Class.isClass(d,MO.MGuiContainer)&&f.hasNode()){f=f.nodes();for(var q=f.count(),w=0;w<q;w++){var z=f.at(w),A=d.createChild(z);if(!A)throw new MO.TError("Invalid create child.");this.innerbuild(b,A,z,h);d.push(A)}}MO.Class.isClass(d,MO.FGuiControl)}};
MO.RGuiControl.prototype.build=function(b,d,f){b||(b=this.newInstance(d));this.innerbuild(b,b,d,f);return b};MO.RGuiControl.prototype.saveConfig=function(b,d){b.propertySave(d);if(b.hasComponent())for(var f=b.components(),h=f.count(),q=0;q<h;q++){var w=f.at(q),z=MO.Class.name(w);MO.Lang.String.startsWith(z,"FGui")&&(z=z.substring(4));z=d.create(z);this.saveConfig(w,z)}return d};MO.RGuiControl=new MO.RGuiControl;
MO.FGuiCanvasManager=function(b){b=MO.Class.inherits(this,b,MO.FGuiManager);b._desktop=MO.Class.register(b,new MO.AGetSet("_desktop"));b._canvas=MO.Class.register(b,new MO.AGetSet("_canvas"));b._readyControls=null;b._dirtyControls=null;b._paintEvent=null;b.onSortControl=MO.FGuiCanvasManager_onSortControl;b.construct=MO.FGuiCanvasManager_construct;b.filterByRectangle=MO.FGuiCanvasManager_filterByRectangle;b.doActionAlpha=MO.FGuiCanvasManager_doActionAlpha;b.processResize=MO.FGuiCanvasManager_processResize;
b.processControl=MO.FGuiCanvasManager_processControl;b.process=MO.FGuiCanvasManager_process;b.dispose=MO.FGuiCanvasManager_dispose;return b};MO.FGuiCanvasManager_onSortControl=function(b,d){var f=b.displayOrder(),h=d.displayOrder();return f-h};MO.FGuiCanvasManager_construct=function(){this.__base.FGuiManager.construct.call(this);this._readyControls=new MO.TObjects;this._dirtyControls=new MO.TObjects;this._paintEvent=new MO.SGuiPaintEvent};
MO.FGuiCanvasManager_filterByRectangle=function(b,d){for(var f=this._readyControls,h=f.count(),q=0;q<h;q++){var w=f.at(q),z=w.clientRectangle();d.testRectangle(z)&&(w._flagDirty||(w._flagDirty=!0,this.filterByRectangle(b,z)),w.dirty(),b.pushUnique(w))}};MO.FGuiCanvasManager_doActionAlpha=function(b){this._canvas.graphicContext().setAlpha(b);this.dirty()};MO.FGuiCanvasManager_processResize=function(b){};
MO.FGuiCanvasManager_processControl=function(b){this.__base.FGuiManager.process.call(this);var d=this._canvas.graphicContext(),f=this._desktop,h=f.calculateSize(),f=f.calculateRate(),q=this._paintEvent;q.optionContainer=!0;q.graphic=d;q.parentRectangle.set(0,0,h.width,h.height);q.calculateRate=f;q.rectangle.reset();b.paint(q)};
MO.FGuiCanvasManager_process=function(){this.__base.FGuiManager.process.call(this);var b=this._readyControls;b.clear();for(var d=this._controls,f=d.count(),h=0;h<f;h++){var q=d.at(h);q.processReady()&&this._visible&&q.visible()&&(q._flagDirty=!1,b.push(q))}d=this._canvas.graphicContext();if(this._statusDirty){d.prepare();d.clear();b.sort(this.onSortControl);d=b.count();for(h=0;h<d;h++)q=b.at(h),this.processControl(q);this._statusDirty=!1}else{f=this._dirtyControls;f.clear();for(var w=b.count(),h=
0;h<w;h++)if(q=b.at(h),q.testDirty()){var z=q.clientRectangle();f.push(q);q._flagDirty=!0;this.filterByRectangle(f,z)}f.sort(this.onSortControl);if(b=f.count()){d.prepare();for(h=0;h<b;h++)q=f.at(h),q=q.clientRectangle(),q.isEmpty()||d.clearRectangle(q);for(h=0;h<b;h++)q=f.at(h),this.processControl(q)}}};
MO.FGuiCanvasManager_dispose=function(){this._readyControls=MO.Lang.Object.dispose(this._readyControls);this._dirtyControls=MO.Lang.Object.dispose(this._dirtyControls);this._paintEvent=MO.Lang.Object.dispose(this._paintEvent);this.__base.FGuiManager.dispose.call(this)};
MO.FGuiChangeTransform=function(b){b=MO.Class.inherits(this,b,MO.FGuiTransform);b._changeCd=MO.Class.register(b,new MO.AGetSet("_changeCd"));b._interval=MO.Class.register(b,new MO.AGetSet("_interval"));b._scale=MO.Class.register(b,new MO.AGetSet("_scale"));b._sourceControl=MO.Class.register(b,new MO.AGetSet("_sourceControl"));b._targetControl=MO.Class.register(b,new MO.AGetSet("_targetControl"));b._sourceRectangle=null;b._targetRectangle=null;b._current=0;b._middleCount=100;b._endCount=200;b.construct=
MO.FGuiChangeTransform_construct;b.start=MO.FGuiChangeTransform_start;b.process=MO.FGuiChangeTransform_process;b.dispose=MO.FGuiChangeTransform_dispose;return b};MO.FGuiChangeTransform_construct=function(){this.__base.FGuiTransform.construct.call(this);this._sourceRectangle=new MO.SRectangle;this._targetRectangle=new MO.SRectangle};
MO.FGuiChangeTransform_start=function(){this.__base.FGuiTransform.start.call(this);this._current=0;var b=this._sourceControl;this._sourceRectangle.set(b.location().x,b.location().y,b.size().width,b.size().height);b=this._targetControl;this._targetRectangle.set(b.location().x,b.location().y,b.size().width,b.size().height)};
MO.FGuiChangeTransform_process=function(){var b=this._sourceControl,d=this._targetControl;if(this._current<this._middleCount){var f=this._middleCount-this._current,f=f/this._middleCount;b.size().set(this._sourceRectangle.width*f,this._sourceRectangle.height*f)}else this._current==this._middleCount?(b.setVisible(!1),d.setVisible(!0)):this._current>this._middleCount?(f=this._endCount-this._current,f/=this._middleCount,d.size().set(this._sourceRectangle.width*f,this._sourceRectangle.height*f)):this._current==
this._endCount&&(b.setLocation(this._targetRectangle.left,this._targetRectangle.top),b.setSize(this._targetRectangle.width,this._targetRectangle.height),d.setLocation(this._sourceRectangle.left,this._sourceRectangle.top),d.setSize(this._sourceRectangle.width,this._sourceRectangle.height),this._finish=!0);this._current++};MO.FGuiChangeTransform_dispose=function(){this.__base.FGuiTransform.dispose.call(this)};
MO.FGuiFrameConsole=function(b){b=MO.Class.inherits(this,b,MO.FConsole);b._scopeCd=MO.EScope.Local;b._frames=null;b.construct=MO.FGuiFrameConsole_construct;b.createFrame=MO.FGuiFrameConsole_createFrame;b.create=MO.FGuiFrameConsole_create;b.find=MO.FGuiFrameConsole_find;b.get=MO.FGuiFrameConsole_get;b.alloc=MO.FGuiFrameConsole_alloc;b.free=MO.FGuiFrameConsole_free;b.dispose=MO.FGuiFrameConsole_dispose;return b};
MO.FGuiFrameConsole_construct=function(){this.__base.FConsole.construct.call(this);this._frames=new MO.TDictionary};MO.FGuiFrameConsole_createFrame=function(b,d,f){d=MO.Console.find(MO.FGuiFrameDescribeConsole).load(f);d=MO.RGuiControl.build(null,d,null,null);d.linkGraphicContext(b);d.psInitialize();d.build();return d};MO.FGuiFrameConsole_create=function(b,d){return this.createFrame(b,null,d)};MO.FGuiFrameConsole_find=function(b){return this._frames.get(b)};
MO.FGuiFrameConsole_get=function(b,d){var f=this._frames,h=f.get(d);h||(h=this.createFrame(b,null,d),f.set(d,h));return h};MO.FGuiFrameConsole_alloc=function(b){};MO.FGuiFrameConsole_free=function(b){b.setVisible(!1);this._freeFrames.push(b)};MO.FGuiFrameConsole_dispose=function(){this._frames=MO.Lang.Object.dispose(this._frames,!0);this.__base.FConsole.construct.call(this)};
MO.FGuiFrameDescribeConsole=function(b){b=MO.Class.inherits(this,b,MO.FConsole);b._scopeCd=MO.EScope.Global;b._serviceCode="cloud.describe.frame";b._defines=MO.Class.register(b,new MO.AGetter("_defines"));b.construct=MO.FGuiFrameDescribeConsole_construct;b.load=MO.FGuiFrameDescribeConsole_load;b.dispose=MO.FGuiFrameDescribeConsole_dispose;return b};MO.FGuiFrameDescribeConsole_construct=function(){this.__base.FConsole.construct.call(this);this._defines=new MO.TDictionary};
MO.FGuiFrameDescribeConsole_load=function(b){var d=this._defines,f=d.get(b);if(f)return f;var h=new MO.TXmlDocument,f=h.root();f.set("action","query");f=f.create("Frame");f.set("name",b);for(var f=MO.Window.Browser.hostPath("/"+this._serviceCode+".ws"),h=MO.Console.find(MO.FXmlConsole).send(f,h).nodes(),q=h.count(),w=0;w<q;w++){var f=h.at(w),z=f.get("name");d.set(z,f)}f=d.get(b);if(!f)throw new MO.TError(this,"Unknown frame. (name={1})",b);return f};
MO.FGuiFrameDescribeConsole_dispose=function(){this._defines=MO.Lang.Object.dispose(this._defines,!0);this.__base.FConsole.dispose.call(this)};MO.FGuiGeneralColorEffect=function(b){b=MO.Class.inherits(this,b,MO.FE3dAutomaticEffect);b._code="general.color.gui";b.drawRenderable=MO.FGuiGeneralColorEffect_drawRenderable;return b};
MO.FGuiGeneralColorEffect_drawRenderable=function(b,d){if(!MO.Class.isClass(d,MO.FGuiControlRenderable))throw new MO.TError("Invalid renderable.");var f=d.control(),h=d.adjustSize(),q=f.location(),w=f.size(),f=f.dockCd(),z=this._graphicContext,A=z.logicSize(),B=z.size(),C=z.ratio(),D=z.sizeRatio(),z=B.width*C,C=B.height*C,E=B.width*D.width,B=B.height*D.height,F=d.material();this.bindMaterial(F);F=width=height=0;if(d._optionFull)F=q.x/E*2-1,I=1-q.y/B*2,width=h.width/E*2,height=h.height/B*2;else{var H=
D.width>D.height?1:D.height/D.width;if(f==MO.EGuiDock.LeftTop||f==MO.EGuiDock.Left||f==MO.EGuiDock.LeftBottom||f==MO.EGuiDock.Fill)F=q.x/E*2-1;else if(f==MO.EGuiDock.RightTop||f==MO.EGuiDock.Right||f==MO.EGuiDock.RightBottom)F=(A.width-q.x-w.width/H)/E*2-1;else throw new MO.TError(this,"Invalid dock.");var I=0,D=D.width>D.height?1:D.height/D.width;if(f==MO.EGuiDock.LeftTop||f==MO.EGuiDock.Top||f==MO.EGuiDock.RightTop||f==MO.EGuiDock.Fill)I=1-q.y/B*2;else if(f==MO.EGuiDock.LeftBottom||f==MO.EGuiDock.Bottom||
f==MO.EGuiDock.RightBottom)I=1-(A.height-q.y-w.height/D)/B*2;else throw new MO.TError(this,"Invalid dock.");width=f==MO.EGuiDock.Fill?(A.width-q.x-w.width/H)/E*2-1-(q.x/E*2-1):h.width/z*2;height=h.height/C*2}this._program.setParameter4("vc_position",F,I,width,height);this.__base.FE3dAutomaticEffect.drawRenderable.call(this,b,d)};
MO.FGuiManager=function(b){b=MO.Class.inherits(this,b,MO.FObject,MO.MGraphicObject,MO.MEventDispatcher);b._visible=MO.Class.register(b,new MO.AGetter("_visible"),!0);b._controls=MO.Class.register(b,new MO.AGetter("_controls"));b._mainTimeline=MO.Class.register(b,new MO.AGetter("_mainTimeline"));b._transforms=MO.Class.register(b,new MO.AGetter("_transforms"));b._statusDirty=!1;b._visibleControls=null;b.construct=MO.FGuiManager_construct;b.register=MO.FGuiManager_register;b.unregister=MO.FGuiManager_unregister;
b.transformStart=MO.FGuiManager_transformStart;b.setup=MO.FGuiManager_setup;b.isDirty=MO.FGuiManager_isDirty;b.setVisible=MO.FGuiManager_setVisible;b.show=MO.FGuiManager_show;b.hide=MO.FGuiManager_hide;b.processResize=MO.FGuiManager_processResize;b.processEvent=MO.FGuiManager_processEvent;b.processTransforms=MO.FGuiManager_processTransforms;b.process=MO.FGuiManager_process;b.dirty=MO.FGuiManager_dirty;b.dispose=MO.FGuiManager_dispose;return b};
MO.FGuiManager_construct=function(){this.__base.FObject.construct.call(this);this._controls=new MO.TObjects;this._mainTimeline=MO.Class.create(MO.FMainTimeline);this._transforms=new MO.TLooper;this._visibleControls=new MO.TObjects};MO.FGuiManager_register=function(b){b.setManager(this);this._controls.push(b);this._statusDirty=!0};MO.FGuiManager_unregister=function(b){b.setManager(null);this._controls.remove(b);this._statusDirty=!0};MO.FGuiManager_transformStart=function(b){b.start();this._transforms.pushUnique(b)};
MO.FGuiManager_setup=function(){MO.Console.find(MO.FG3dEffectConsole).register("general.color.gui",MO.FGuiGeneralColorEffect)};MO.FGuiManager_isDirty=function(){return this._statusDirty};MO.FGuiManager_setVisible=function(b){this._visible=b;this._statusDirty=!0};MO.FGuiManager_show=function(){this.setVisible(!0)};MO.FGuiManager_hide=function(){this.setVisible(!1)};MO.FGuiManager_processResize=function(b){b=this._controls;for(var d=b.count(),f=0;f<d;f++)b.at(f).psResize()};
MO.FGuiManager_processEvent=function(b){this.dispatcherEvent(b)};MO.FGuiManager_processTransforms=function(){var b=this._transforms;for(b.record();b.next();){var d=b.current();d.process();d.isFinish()&&b.removeCurrent()}};MO.FGuiManager_process=function(){for(var b=this._controls,d=b.count(),f=0;f<d;f++)b.at(f).psUpdate();this._mainTimeline.process();this.processTransforms()};MO.FGuiManager_dirty=function(){this._statusDirty=!0};
MO.FGuiManager_dispose=function(){this._controls=MO.RObject.dispose(this._controls);this._mainTimeline=MO.RObject.dispose(this._mainTimeline);this._transforms=MO.RObject.dispose(this._transforms);this._visibleControls=MO.RObject.dispose(this._visibleControls);this.__base.FObject.dispose.call(this)};
MO.FGuiTransform=function(b){b=MO.Class.inherits(this,b,MO.FObject);b._finish=!1;b.construct=MO.FGuiTransform_construct;b.isFinish=MO.FGuiTransform_isFinish;b.start=MO.FGuiTransform_start;b.process=MO.FGuiTransform_process;b.dispose=MO.FGuiTransform_dispose;return b};MO.FGuiTransform_construct=function(){this.__base.FObject.construct.call(this)};MO.FGuiTransform_isFinish=function(){return this._finish};MO.FGuiTransform_start=function(){this._finish=!1};MO.FGuiTransform_process=function(){};
MO.FGuiTransform_dispose=function(){this.__base.FObject.dispose.call(this)};MO.FGuiButton=function(b){b=MO.Class.inherits(this,b,MO.FGuiControl);b.onPaintBegin=MO.FGuiButton_onPaintBegin;return b};MO.FGuiButton_onPaintBegin=function(b){this.__base.FGuiControl.onPaintBegin.call(this,b);var d=b.graphic;b=b.rectangle;if(this._label){this._foreFont&&d.setFont(this._foreFont);var f=d.textWidth(this._label);d.drawText(this._label,b.left+.5*b.width-.5*f,b.top+.5*b.height+3,this._foreColor)}};
MO.FGuiLabel=function(b){b=MO.Class.inherits(this,b,MO.FGuiControl);b.onPaintLabel=MO.FGuiLabel_onPaintLabel;b.onPaintBegin=MO.FGuiLabel_onPaintBegin;b.setLabel=MO.FGuiLabel_setLabel;return b};MO.FGuiLabel_onPaintLabel=function(b){this.__base.FGuiControl.onPaintBegin.call(this,b);var d=b.graphic;b=b.rectangle;this._foreFont&&d.setFont(this._foreFont);var f=d.textWidth(this._label);d.drawText(this._label,b.left+.5*b.width-.5*f,b.top+.5*b.height+3,this._foreColor)};
MO.FGuiLabel_onPaintBegin=function(b){this.__base.FGuiControl.onPaintBegin.call(this,b);if(this._label)this.onPaintLabel(b)};MO.FGuiLabel_setLabel=function(b){this._label!=b&&this.dirty();this.__base.FGuiControl.setLabel.call(this,b)};MO.FGuiPanel=function(b){return b=MO.Class.inherits(this,b,MO.FGuiControl)};MO.FGuiPicture=function(b){return b=MO.Class.inherits(this,b,MO.FGuiControl)};
MO.FGuiTimeline=function(b){b=MO.Class.inherits(this,b,MO.FGuiControl);b._timeUnit=MO.Class.register(b,new MO.AGetSet("_timeUnit"));b._startTime=MO.Class.register(b,new MO.AGetSet("_startTime"));b._endTime=MO.Class.register(b,new MO.AGetSet("_endTime"));b._degreeTime=MO.Class.register(b,new MO.AGetSet("_degreeTime"));b._progress=MO.Class.register(b,new MO.AGetSet("_progress"));b._unitms=MO.Class.register(b,new MO.AGetSet("_unitms"),864E5);b._degreeLineHeight=MO.Class.register(b,new MO.AGetSet("_degreeLineHeight"),
15);b._degreeLineWidth=MO.Class.register(b,new MO.AGetSet("_degreeLineWidth"),3);b._mainLineWidth=MO.Class.register(b,new MO.AGetSet("_mainLineWidth"),5);b._triangleWidth=MO.Class.register(b,new MO.AGetSet("_triangleWidth"),10);b._triangleHeight=MO.Class.register(b,new MO.AGetSet("_triangleHeight"),12);b._decoLineGap=MO.Class.register(b,new MO.AGetSet("_decoLineGap"),10);b._decoLineWidth=MO.Class.register(b,new MO.AGetSet("_decoLineWidth"),40);b._timeFontColor="#FFFFFF";b._cursorFontColor="#FFFFFF";
b._listenersDataChanged=MO.Class.register(b,new MO.AListener("_listenersDataChanged",MO.EEvent.DataChanged));b.onPaintBegin=MO.FGuiTimeline_onPaintBegin;b.onOperationDown=MO.FGuiTimeline_onOperationDown;return b};
MO.FGuiTimeline_onPaintBegin=function(b){this.__base.FGuiControl.onPaintBegin.call(this,b);var d=b.graphic,f=b.rectangle;b=f.top+f.height-50;var h=f.left+5,f=f.left+f.width-5,q=this.triangleWidth()+this.decoLineGap();d.drawTriangle(h,b,h+this.triangleWidth(),b+this.triangleHeight()/2,h+this.triangleWidth(),b-this.triangleHeight()/2,1,"#FFFFFF","#FFFFFF");d.drawTriangle(f,b,f-this.triangleWidth(),b+this.triangleHeight()/2,f-this.triangleWidth(),b-this.triangleHeight()/2,1,"#FFFFFF","#FFFFFF");d.drawLine(h+
q,b,h+q+this.decoLineWidth(),b,"#25E8FF",this._mainLineWidth);d.drawLine(f-q,b,f-q-this.decoLineWidth(),b,"#25E8FF",this._mainLineWidth);h=h+q+this.decoLineWidth();f=f-q-this.decoLineWidth();d.drawLine(h,b,f,b,"#25E8FF",this._mainLineWidth);var q=this.startTime(),w=this.endTime(),z=this.degreeTime(),A,B;switch(this.timeUnit()){case MO.EUiTimeUnit.Second:B=q.format("MI:SS.MISS");A=z.format("MI:SS.MISS");break;case MO.EUiTimeUnit.Minute:B=q.format("HH24:MI:SS");A=z.format("HH24:MI:SS");break;case MO.EUiTimeUnit.Hour:B=
q.format("HH24:MI");A=z.format("HH24:MI");break;case MO.EUiTimeUnit.Day:B=q.format("MM-DD:HH24");A=z.format("MM-DD:HH24");break;case MO.EUiTimeUnit.Week:B=q.format("MM-DD");A=z.format("MM-DD");break;case MO.EUiTimeUnit.Month:B=q.format("YYYY-MM-DD");A=z.format("YYYY-MM-DD");break;case MO.EUiTimeUnit.Year:B=q.format("YYYY-MM");A=z.format("YYYY-MM");break;default:return}var C=w.date.getTime()-q.date.getTime(),D=z.date.getTime()-q.date.getTime()+this.unitms()*this.progress(),D=h+D/C*(f-h);d.drawTriangle(D,
b+2,D-this.triangleWidth()/2,b+2+this.triangleHeight(),D+this.triangleWidth()/2,b+2+this.triangleHeight(),1,"#FFFFFF","#FFFFFF");d.setFont("bold 22px Microsoft YaHei");var E=d.textWidth(A);d.drawText(A,D-E/2,b+50,this._cursorFontColor);A=q.date.getTime();d.drawLine(h,b-this.degreeLineHeight(),h,b,"#FFFFFF",this._degreeLineWidth);D=d.textWidth(B);d.drawText(B,h-D/2,b+50,this._cursorFontColor);switch(this.timeUnit()){case MO.EUiTimeUnit.Second:q.addMseconds(1E3);q.parseAuto(q.format("YYYYMMDDHH24MISS"));
break;case MO.EUiTimeUnit.Minute:q.addMseconds(6E4);q.parseAuto(q.format("YYYYMMDDHH24MISS"));break;case MO.EUiTimeUnit.Hour:q.addMseconds(36E5);q.parseAuto(q.format("YYYYMMDDHH24MISS"));break;case MO.EUiTimeUnit.Day:q.addDay(1);q.parseAuto(q.format("YYYYMMDD"));break;case MO.EUiTimeUnit.Week:q.addDay(7);q.parseAuto(q.format("YYYYMMDD"));break;case MO.EUiTimeUnit.Month:q.addMonth(1);q.parseAuto(q.format("YYYYMM"));break;case MO.EUiTimeUnit.Year:q.addYear(1);q.parseAuto(q.format("YYYY"));break;default:return}for(D=
0;!q.isAfter(z);){B=q.date.getTime()-A;E=h+B/C*(f-h);d.drawLine(E,b-this.degreeLineHeight(),E,b,"#FFFFFF",this._degreeLineWidth);switch(this.timeUnit()){case MO.EUiTimeUnit.Second:B=q.format("MI:SS");q.addMseconds(1E3);break;case MO.EUiTimeUnit.Minute:B=q.format("HH24:MI");q.addMseconds(6E4);break;case MO.EUiTimeUnit.Hour:B=q.format("HH24:00");q.addMseconds(36E5);break;case MO.EUiTimeUnit.Day:B=q.format("MM-DD");q.addDay(1);break;case MO.EUiTimeUnit.Week:B=q.format("MM-DD");q.addDay(7);break;case MO.EUiTimeUnit.Month:B=
q.format("YYYY-MM");q.addMonth(1);break;case MO.EUiTimeUnit.Year:B=q.format("YYYY");q.addYear(1);break;default:return}d.setFont("bold 22px Microsoft YaHei");var F=d.textWidth(B),D=b+26;d.drawText(B,E-F/2,D,this._timeFontColor)}B=w.date.getTime()-A;E=h+B/C*(f-h);d.drawLine(E,b-this.degreeLineHeight(),E,b,this._cursorFontColor,this._degreeLineWidth);q.date.setTime(A);q.refresh()};
MO.FGuiTimeline_onOperationDown=function(b){if(b.flag){this.__base.FGuiControl.onOperationDown.call(this,b);var d=b.rectangle,f=d.top+d.height,h=d.left+5,d=d.left+d.width-5,q=this.triangleWidth()+this.decoLineGap(),h=h+q+this.decoLineWidth(),d=d-q-this.decoLineWidth(),q=b.locationX;b.locationY>f-30&&q>h&&q<d&&(b=(q-h)/(d-h),b=this.startTime().date.getTime()+(this.endTime().date.getTime()-this.startTime().date.getTime())*b,f=MO.Memory.alloc(SEvent),f.sender=this,h=MO.Memory.alloc(TDate),h.date.setTime(b),
h.refresh(),f.date=h.parseAuto(h.format("YYYYMMDD")),this.processDataChangedListener(f),MO.Memory.free(f))}};MO.FGuiGridControl=function(b){b=MO.Class.inherits(this,b,MO.FProcessServer);b._typeName=null;b._groupName=null;b._name=null;b.name=MO.FGuiGridControl_name;return b};MO.FGuiGridControl_name=function(){return this._name};MO.FGuiBar=function(b){return b=MO.Class.inherits(this,b,MO.FGuiFrame)};
MO.FGuiChartTotal=function(b){b=MO.Class.inherits(this,b,MO.FGuiControl);b._ready=MO.Class.register(b,new MO.AGetSet("_ready"),!1);b._numImages=null;b._yuanImage=null;b._wanImage=null;b._yiImage=null;b._imageToLoad=0;b._value=MO.Class.register(b,new MO.AGetter("_value"));b._originValue="0";b._nextValue=null;b._startTick=0;b._rolling=MO.Class.register(b,new MO.AGetSet("_rolling"),!1);b._rollingDuration=MO.Class.register(b,new MO.AGetSet("_rollingDuration"),1E3);b._rollingPages=null;b._noRolling=MO.Class.register(b,
new MO.AGetSet("_noRolling"),!1);b.construct=MO.FGuiChartTotal_construct;b.setup=MO.FGuiChartTotal_setup;b.onImageLoad=MO.FGuiChartTotal_onImageLoad;b.onPaintBegin=MO.FGuiChartTotal_onPaintBegin;b.setValue=MO.FGuiChartTotal_setValue;b.dispose=MO.FGuiChartTotal_dispose;return b};MO.FGuiChartTotal_construct=function(){this.__base.FGuiControl.construct.call(this);this._rollingPages=new MO.TArray};
MO.FGuiChartTotal_setup=function(){this._yuanImage=MO.Class.create(MO.FImage);this._yuanImage.addLoadListener(this,this.onImageLoad);this._yuanImage.loadUrl("{eai.resource}/number/yuan.png");this._imageToLoad++;this._wanImage=MO.Class.create(MO.FImage);this._wanImage.addLoadListener(this,this.onImageLoad);this._wanImage.loadUrl("{eai.resource}/number/wan.png");this._imageToLoad++;this._yiImage=MO.Class.create(MO.FImage);this._yiImage.addLoadListener(this,this.onImageLoad);this._yiImage.loadUrl("{eai.resource}/number/yi.png");
this._imageToLoad++;this._numImages=Array(10);this._imageToLoad+=10;for(var b=0;10>b;b++){var d=MO.Class.create(MO.FImage);d.addLoadListener(this,this.onImageLoad);d.loadUrl("{eai.resource}/number/"+b+".png");this._numImages[b]=d}};
MO.FGuiChartTotal_onImageLoad=function(){if(0==--this._imageToLoad){var b=MO.Eai.Canvas.logicSize(),d=this._numImages[0]._size,f=this._yiImage._size;this.setLeft((b.width-4*d.width-f.width)/2);this.setTop((b.height-3*f.height)/2);this.setWidth(4*d.width+f.width);this.setHeight(3*f.height);this._ready=!0}};
MO.FGuiChartTotal_setValue=function(b){if(this._value!=b){this._rolling&&(this._nextValue=this._value);this._value=b;for(var d=this._originValue,f=b.length-d.length;0<f;)d="0"+d,f--;this._originValue=d;this._rollingPages.clear();this._rollingPages._length=b.length;for(f=0;f<b.length;f++){var h=parseInt(b.substring(f,f+1))-parseInt(d.substring(f,f+1)),h=0>h?h+10:h;this._rollingPages.set(f,h)}this._startTick=MO.Timer.current();this._rolling=!0}};
MO.FGuiChartTotal_onPaintBegin=function(b){this.__base.FGuiControl.onPaintBegin.call(this,b);if(this._value){var d=b.graphic;b=b.rectangle;var f=MO.Timer.current()-this._startTick;if(f>this._rollingDuration||this._noRolling)f=this._rollingDuration,this._rolling=!1;var h=this._numImages[0]._size,q=this._yiImage._size,w=4*h.width+q.width,z=b.left+(b.width-w)/2,A=b.top;d.store();d.clip(z,A,w,q.height);for(var z=z+h.width,B=0;B<this._value.length;B++){var C=this._rollingPages.get(B)*(f/this._rollingDuration),
D=(parseInt(this._originValue.charAt(B))+parseInt(C)).toString(),D=parseInt(D.charAt(D.length-1)),E=9==D?0:D+1,C=C-parseInt(C);d.drawImage(this._numImages[D],z,A-h.height*C,h.width,h.height);d.drawImage(this._numImages[E],z,A+h.height-h.height*C,h.width,h.height);z+=h.width;B==this._originValue.length-9?(d.drawImage(this._yiImage,z,A,q.width,q.height),z=b.left+(b.width-w)/2,A+=q.height,d.restore(),d.store(),d.clip(z,A,w,q.height)):B==this._originValue.length-5?(d.drawImage(this._wanImage,z,A,q.width,
q.height),z=b.left+(b.width-w)/2,A+=q.height,d.restore(),d.store(),d.clip(z,A,w,q.height)):B==this._originValue.length-1&&d.drawImage(this._yuanImage,z,A,q.width,q.height)}0==this._rolling&&(this._originValue=this._value,this._rollingPages.clear())}};MO.FGuiChartTotal_dispose=function(){this.__base.FGuiControl.dispose.call(this)};MO.FGuiWindow=function(b){return b=MO.Class.inherits(this,b,MO.FGuiFrame)};
MO.FGuiDesignAnchor=function(b){b=MO.Class.inherits(this,b,MO.FGuiControl);b.construct=MO.FGuiDesignAnchor_construct;b.onPaintBegin=FGuiDesignAnchor_onPaintBegin;b.dispose=MO.FGuiDesignAnchor_dispose;return b};MO.FGuiDesignAnchor_construct=function(){this.__base.FGuiControl.construct.call(this)};MO.FGuiDesignAnchor_onPaintBegin=function(b){this.__base.FGuiControl.onPaintBegin.call(this,b)};MO.FGuiDesignAnchor_dispose=function(){this.__base.FGuiControl.dispose.call(this)};
MO.FGuiDesignRule=function(b){b=MO.Class.inherits(this,b,MO.FGuiControl);b.construct=MO.FGuiDesignRule_construct;b.dispose=MO.FGuiDesignRule_dispose;return b};MO.FGuiDesignRule_construct=function(){this.__base.FGuiControl.construct.call(this)};MO.FGuiDesignRule_dispose=function(){this.__base.FGuiControl.dispose.call(this)};
MO.FGuiEngineInfo=function(b){b=MO.Class.inherits(this,b,MO.FGuiControl);b._lastTick=0;b._name="EngineInfo";b._stage=MO.Class.register(b,new MO.AGetSet("_stage"));b._context=MO.Class.register(b,new MO.AGetSet("_context"));b._ticker=null;b.onPaintBegin=MO.FGuiEngineInfo_onPaintBegin;b.oeUpdate=MO.FGuiEngineInfo_oeUpdate;b.construct=MO.FGuiEngineInfo_construct;return b};
MO.FGuiEngineInfo_onPaintBegin=function(b){this.__base.FGuiControl.onPaintBegin.call(this,b);if(null!=this._stage&&null!=this._context){var d=b.graphic,f=b.rectangle;this._stage.timer();b=this._stage.statistics();var h=this._context.statistics(),f=f.top+20;d.setFont("16px sans-serif");d.drawText("Frame         : "+MO.Timer.rate(),10,f,"#FFFFFF");f+=20;d.drawText("Frame Span    : "+b._frame.toString(),10,f,"#FFFFFF");f+=20;d.drawText("Frame Process : "+b._frameProcess.toString(),10,f,"#FFFFFF");f+=
20;d.drawText("Frame Draw    : "+b._frameDraw.toString()+" | "+b._frameDrawSort.toString(),10,f,"#FFFFFF");f+=20;d.drawText("Draw          : "+h.frameDrawCount(),10,f,"#FFFFFF");f+=20;d.drawText("Draw Const    : "+h.frameConstCount()+" Length="+h.frameConstLength(),10,f,"#FFFFFF");f+=20;d.drawText("Draw Buffer   : "+h.frameBufferCount(),10,f,"#FFFFFF");f+=20;d.drawText("Draw Texture  : "+h.frameTextureCount(),10,f,"#FFFFFF");f+=20;d.drawText("Draw Triangle : "+h.frameTriangleCount(),10,f,"#FFFFFF");
f+=20;d.drawText("Total Program : "+h.programTotal(),10,f,"#FFFFFF");f+=20;d.drawText("Total Layout  : "+h.layoutTotal(),10,f,"#FFFFFF");f+=20;d.drawText("Total Buffer  : Vertex="+h.vertexBufferTotal()+" Index="+h.indexBufferTotal(),10,f,"#FFFFFF")}};MO.FGuiEngineInfo_oeUpdate=function(b){this._ticker.process()&&this.dirty();return MO.EEventStatus.Stop};MO.FGuiEngineInfo_construct=function(){this.__base.FGuiControl.construct.call(this);this._size.set(512,256);this._ticker=new MO.TTicker(1E3)};
MO.EEditConfig=new function(){this.Search="S";this.Copy="C";return this};MO.EEditStatus=new function(b){b||(b=this);b.Blur=0;b.Cancel=1;b.Ok=2;return b};MO.EEventType=new function(){this.Unknown=0;this.Construct=1;this.Initialize=2;this.Build=3;this.Refresh=4;this.Resize=5;this.Visible=6;this.Show=7;this.Hidden=8;this.Enable=9;this.Disable=10;this.Release=11;this.Design=12;this.Action=13;this.Valid=14;this.Mode=15;return this};
MO.ERowStatus=new function(){this.Normal="N";this.Insert="I";this.Update="U";this.Delete="D";return this};MO.MUiContainer=function(b){b=MO.Class.inherits(this,b);b.createChild=MO.MUiContainer_createChild;b.appendChild=MO.Method.empty;b.removeChild=MO.Method.empty;return b};MO.MUiContainer_createChild=function(b){b=MO.RUiControl.newInstance(b);b._parent=this;return b};
MO.MUiDataProperties=function(b){b=MO.Class.inherits(this,b);b._dataProperties=null;b.dataProperties=MO.MUiDataProperties_dataProperties;b.dataPropertyGet=MO.MUiDataProperties_dataPropertyGet;b.dataPropertySet=MO.MUiDataProperties_dataPropertySet;return b};MO.MUiDataProperties_dataProperties=function(b,d){var f=this._dataProperties;null==f&&(f=this._dataProperties=new MO.TDictionary);return f};MO.MUiDataProperties_dataPropertyGet=function(b){var d=this._dataProperties;return d?d.get(b):null};
MO.MUiDataProperties_dataPropertySet=function(b,d){this.dataProperties().set(b,d)};MO.MUiDescribeFrame=function(b){b=MO.Class.inherits(this,b);b._frameName=null;b.buildDefine=MO.MUiDescribeFrame_buildDefine;return b};MO.MUiDescribeFrame_buildDefine=function(b,d){MO.Lang.String.isEmpty(d)&&(d=this._frameName);var f=MO.Console.find(MO.FUiDescribeFrameConsole).load(d);MO.RUiControl.build(this,f,null,b)};
MO.MUiDesign=function(b){b=MO.Class.inherits(this,b);b._statusDesign=!1;b._storage=null;b.oeDesign=MO.MUiDesign_oeDesign;b.onDesignEnter=MO.Class.register(b,new MO.AEventMouseEnter("onDesignEnter"),MO.MUiDesign_onDesignEnter);b.onDesignLeave=MO.Class.register(b,new MO.AEventMouseEnter("onDesignLeave"),MO.MUiDesign_onDesignLeave);b.onDesignBegin=MO.Class.register(b,new MO.AEventMouseEnter("onDesignBegin"),MO.MUiDesign_onDesignBegin);b.onDesignEnd=MO.Class.register(b,new MO.AEventMouseEnter("onDesignEnd"),
MO.MUiDesign_onDesignEnd);return b};
MO.MUiDesign_oeDesign=function(b){if(b.isBefore())switch(b.mode){case MO.EDesign.Move:var d=this,f=d._hPanel;if(b.flag)d.isDesign=!0,MO.RHtml.link(f,"className",f.className),MO.RHtml.link(f,"onmousedown",f.onmousedown),f.onmousedown=null,d.onDesignEnter();else if(d.isDesign=!1,f.className=MO.RHtml.findLink(f,"className"),b=MO.RHtml.findLink(f,"onmousedown"))f.onmousedown=b;break;case MO.EDesign.Border:f=this._hPanel,b.flag?(MO.RHtml.link(f,"styleBorder",f.style.border),f.style.border="1 solid red"):
f.style.border=MO.RHtml.findLink(f,"styleBorder")}};MO.MUiDesign_onDesignEnter=function(b){this._hPanel.className=this.style("Design")};MO.MUiDesign_onDesignLeave=function(b){};MO.MUiDesign_onDesignBegin=function(b){b=this._storage=MO.Lang.Object.nvlObj(this._storage);b.designStyle=this._hPanel.className;b.designLayer=this._hPanel.zIndex;this._hPanel.className=this.style("DesignDrag");this._statusDesign=!0};
MO.MUiDesign_onDesignEnd=function(b){b=this._storage=MO.Lang.Object.nvlObj(this._storage);this._hPanel.className=b.designStyle;this._hPanel.zIndex=b.designLayer;this._statusDesign=!1};
MO.MUiDisplay=function(b){b=MO.Class.inherits(this,b);b._dispDisplay=MO.Class.register(b,new MO.APtySet(null,"_dispDisplay","disp_mode",MO.EDisplayMode.Display,!1));b._dispSearch=MO.Class.register(b,new MO.APtySet(null,"_dispSearch","disp_mode",MO.EDisplayMode.Search,!1));b._dispInsert=MO.Class.register(b,new MO.APtySet(null,"_dispInsert","disp_mode",MO.EDisplayMode.Insert,!1));b._dispUpdate=MO.Class.register(b,new MO.APtySet(null,"_dispUpdate","disp_mode",MO.EDisplayMode.Update,!1));b._dispDelete=
MO.Class.register(b,new MO.APtySet(null,"_dispDelete","disp_mode",MO.EDisplayMode.Delete,!1));b._dispZoom=MO.Class.register(b,new MO.APtySet(null,"_dispZoom","disp_mode",MO.EDisplayMode.Zoom,!1));b._dispAlign=MO.Class.register(b,new MO.APtyString(null,"_dispAlign",null,MO.EAlign.Left));b._visible=!0;b.oeMode=MO.MUiDisplay_oeMode;b.canVisible=MO.MUiDisplay_canVisible;return b};MO.MUiDisplay_oeMode=function(b){if(b.isBefore()){var d=!0;this.base.MUiDisplayAble||(d=this.canVisible(b.mode));this.setVisible(d)}};
MO.MUiDisplay_canVisible=function(b){switch(RString.nvl(b,this._emode)){case MO.EMode.Display:return this.dispList;case MO.EMode.Search:return this.dispSearch;case MO.EMode.Insert:return this.dispInsert;case MO.EMode.Update:return this.dispUpdate;case MO.EMode.Delete:return this.dispDelete;case MO.EMode.Zoom:return this.dispZoom}};
MO.MUiDragable=function(b){b=MO.Class.inherits(this,b);b.onDragStart=MO.Method.virtual(b,"onDragStart");b.onDragMove=MO.Method.virtual(b,"onDragMove");b.onDragStop=MO.Method.virtual(b,"onDragStop");return b};
MO.MUiDropable=function(b){b=MO.Class.inherits(this,b);b._styleDrop=MO.Class.register(b,new MO.AStyle("_styleDrop"));b._styleIconDrop=MO.Class.register(b,new MO.AStyleIcon("_styleIconDrop"));b._hDropPanel=null;b._hDrop=null;b.onBuildDrop=MO.MUiDropable_onBuildDrop;b.onDropEnter=MO.Class.register(b,new MO.AEventMouseEnter("onDropEnter"));b.onDropLeave=MO.Class.register(b,new MO.AEventMouseLeave("onDropLeave"));b.onDropClick=MO.Class.register(b,new MO.AEventClick("onDropClick"),MO.MUiDropable_onDropClick);
b.onDropDoubleClick=MO.Class.register(b,new MO.AEventDoubleClick("onDropDoubleClick"),MO.MUiDropable_onDropDoubleClick);b.canDrop=MO.MUiDropable_canDrop;return b};MO.MUiDropable_onBuildDrop=function(b){this._hDropPanel=b;b.className=this.styleName("Drop",MO.MUiDropable);b=this.hDrop=MO.RBuilder.appendIcon(b,null,"control.drop");b.style.width=16;b.style.borderLeft="1 solid #CCCCCC";b.style.cursor="hand"};MO.MUiDropable_onDropClick=function(){this._editable&&this.drop()};
MO.MUiDropable_onDropDoubleClick=function(){this._editable&&this.drop()};MO.MUiDropable_canDrop=function(){return MO.Class.isClass(this,MO.MUiDesign)?!MO.Console.find(MO.FUiDesignConsole).canDesignMove:!0};MO.MUiEditable=function(b){return b=MO.Class.inherits(this,b)};MO.MUiEditable_testEdit=function(b){switch(MO.Lang.String.nvl(b,this._emode)){case MO.EMode.Insert:return this.editInsert;case MO.EMode.Update:return this.editUpdate;case MO.EMode.Delete:return this.editDelete;case MO.EMode.Zoom:return this.editZoom}};
MO.MUiEditChange=function(b){b=MO.Class.inherits(this,b);b._styleChangePanel=MO.Class.register(b,new MO.AStyle("_styleChangePanel"));b._styleChangeIcon=MO.Class.register(b,new MO.AStyle("_styleChangeIcon"));b._hChangePanel=null;b._hChangeIcon=null;b.onBuildEditChange=MO.MUiEditChange_onBuildEditChange;b.onChangeEnter=MO.Class.register(b,new MO.AEventMouseEnter("onChangeEnter"),MO.MUiEditChange_onChangeEnter);b.onChangeLeave=MO.Class.register(b,new MO.AEventMouseLeave("onChangeLeave"),MO.MUiEditChange_onChangeLeave);
b.onChangeClick=MO.Class.register(b,new MO.AEventClick("onChangeClick"),MO.MUiEditChange_onChangeClick);b.construct=MO.MUiEditChange_construct;b.changeSet=MO.MUiEditChange_changeSet;b.dispose=MO.MUiEditChange_dispose;return b};
MO.MUiEditChange_onBuildEditChange=function(b){b=this._hChangePanel;b.className=this.styleName("ChangePanel",MO.MUiEditChange);b.style.verticalAlign="top";b.width=5;this.attachEvent("onChangeEnter",b,this.onChangeEnter);this.attachEvent("onChangeLeave",b,this.onChangeLeave);this.attachEvent("onChangeClick",b,this.onChangeClick);(this._hChangeIcon=MO.RBuilder.appendIcon(b,this.styleName("ChangeIcon",MO.MUiEditChange),"control.change"))._pname="change.icon"};MO.MUiEditChange_onChangeEnter=function(b){};
MO.MUiEditChange_onChangeLeave=function(b){};MO.MUiEditChange_onChangeClick=function(b){};MO.MUiEditChange_construct=function(){};MO.MUiEditChange_changeSet=function(b){};MO.MUiEditChange_dispose=function(){this._hChangeIcon=MO.Window.Html.free(this._hChangeIcon);this._hChangePanel=MO.Window.Html.free(this._hChangePanel)};
MO.MUiEditDescriptor=function(b){b=MO.Class.inherits(this,b,MO.MEditable);b._dataName=MO.Class.register(b,new MO.APtyString(null,"_dataName"));b._dataCode=MO.Class.register(b,new MO.APtyString(null,"_dataCode"));b._dataDefault=MO.Class.register(b,new MO.APtyString(null,"_dataDefault"));b._labelIcon=MO.Class.register(b,new MO.APtyString(null,"_labelIcon"));b._labelIconDisable=MO.Class.register(b,new MO.APtyString(null,"_labelIconDisable"));b._labelColor=MO.Class.register(b,new MO.APtyString(null,"_labelColor"));
b._labelAlign=MO.Class.register(b,new MO.APtyString(null,"_labelAlign",null,MO.EAlign.Left));b._labelValign=MO.Class.register(b,new MO.APtyString(null,"_labelValign",null,MO.EAlign.Middle));b._editSearch=MO.Class.register(b,new MO.APtySet(null,"_editSearch","editAccess",MO.EEditConfig.Search,!1));b._editCopy=MO.Class.register(b,new MO.APtySet(null,"_editCopy","editAccess",MO.EEditConfig.Copy,!1));b._editAlign=MO.Class.register(b,new MO.APtyString(null,"_editAlign",null,MO.EAlign.Left));b._editValign=
MO.Class.register(b,new MO.APtyString(null,"_editValign",null,MO.EAlign.Middle));b._editFormat=MO.Class.register(b,new MO.APtyString(null,"_editFormat"));b._editUnit=MO.Class.register(b,new MO.APtyString(null,"_editUnit"));b._editTip=MO.Class.register(b,new MO.APtyString(null,"_editTip"));b._validInsert=MO.Class.register(b,new MO.APtySet(null,"_validInsert","validAccess",MO.EDisplayMode.Insert,!1));b._validUpdate=MO.Class.register(b,new MO.APtySet(null,"_validUpdate","validAccess",MO.EDisplayMode.Update,
!1));b._validDelete=MO.Class.register(b,new MO.APtySet(null,"_validDelete","validAccess",MO.EDisplayMode.Delete,!1));b._validRequire=MO.Class.register(b,new MO.APtyBoolean(null,"_validRequire",null,!1));return b};MO.MUiEditDescriptor_onDataEnter=function(b,d){b.__progress||(b._editable&&(b._hover=!0,b.refreshStyle()),this.editTip&&(this.__tip=window.status))};
MO.MUiEditDescriptor_onDataLeave=function(b,d){b.__progress||(b._editable&&(this._hover=!1,this.refreshStyle()),this.editTip&&(window.status=this.__tip))};MO.MUiEditDescriptor_onDataKeyDown=function(b,d){b._editable&&!b._disabled&&(b._invalidText=this.validText(b.text()),b.refreshStyle())};MO.MUiEditDescriptor_onDataChange=function(b,d){if(b._editable&&!b._disabled&&b.isTextChanged()){var f=b.text();(b._invalidText=this.validText(f))&&b.refreshStyle();this.callEvent("onDataChange",this,this.__changedEvent)}};
MO.MUiEditDescriptor_onDataEditEnd=function(b,d){(b._invalidText=this.validText(b.text()))||b.commitValue();b.isTextChanged()&&this.callEvent("onDataChange",this,this.__changedEvent);b.refreshStyle()};MO.MUiEditDescriptor_oeSaveCode=function(b){RString.isEmpty(this.dataName)||RString.isEmpty(this.dataCode)||b.values.set(this.dataName,this.dataCode);return EEventStatus.Stop};
MO.MUiEditDescriptor_canValid=function(b){switch(MO.Lang.String.nvl(b,this._emode)){case MO.EMode.Insert:return this.validInsert;case MO.EMode.Update:return this.validUpdate;case MO.EMode.Delete:return this.validDelete}};MO.MUiEditDescriptor_formatValue=function(b){return MO.Lang.String.nvl(b)};MO.MUiEditDescriptor_formatText=function(b){return MO.Lang.String.nvl(b)};MO.MUiEditDescriptor_validText=function(b){};
MO.MUiEditDrop=function(b){b=MO.Class.inherits(this,b);b._styleDropPanel=MO.Class.register(b,new MO.AStyle("_styleDropPanel"));b._styleDropIcon=MO.Class.register(b,new MO.AStyle("_styleDropIcon"));b._hDropPanel=null;b._hDropIcon=null;b.onBuildEditDrop=MO.MUiEditDrop_onBuildEditDrop;b.onDropEnter=MO.Class.register(b,new MO.AEventMouseEnter("onDropEnter"),MO.MUiEditDrop_onDropEnter);b.onDropLeave=MO.Class.register(b,new MO.AEventMouseLeave("onDropLeave"),MO.MUiEditDrop_onDropLeave);b.onDropClick=MO.Class.register(b,
new MO.AEventClick("onDropClick"),MO.MUiEditDrop_onDropClick);b.construct=MO.MUiEditDrop_construct;b.dispose=MO.MUiEditDrop_dispose;return b};MO.MUiEditDrop_onBuildEditDrop=function(b){b=this._hDropPanel;b.className=this.styleName("DropPanel",MUiEditDrop);b.width=11;this.attachEvent("onDropEnter",b);this.attachEvent("onDropLeave",b);this.attachEvent("onDropClick",b);(this._hDropIcon=MO.RBuilder.appendIcon(b,this.styleName("DropIcon",MO.MUiEditDrop),"control.drop")).align="center"};
MO.MUiEditDrop_onDropEnter=function(b){};MO.MUiEditDrop_onDropLeave=function(b){};MO.MUiEditDrop_onDropClick=function(b){};MO.MUiEditDrop_construct=function(){};MO.MUiEditDrop_dispose=function(){this._hDropIcon=MO.Window.Html.free(this._hDropIcon);this._hDropPanel=MO.Window.Html.free(this._hDropPanel)};MO.MUiEditFormator=function(b){b=MO.Class.inherits(this,b);b.formatText=MO.MUiEditFormator_formatText;b.formatValue=MO.MUiEditFormator_formatValue;return b};MO.MUiEditFormator_formatText=function(b){return b};
MO.MUiEditFormator_formatValue=function(b){return b};
MO.MUiEditReference=function(b){b=MO.Class.inherits(this,b);b._lovService=MO.Class.register(b,new MO.APtyString("_lovService"));b._lovReference=MO.Class.register(b,new MO.APtyString("_lovReference"));b._lovFields=MO.Class.register(b,new MO.APtyString("_lovFields"));b._lovWhere=MO.Class.register(b,new MO.APtyString("_lovWhere"));b._lovOrder=MO.Class.register(b,new MO.APtyString("_lovOrder"));b._listView=null;b.onListSelected=MO.Method.empty;b.canListView=MO.MUiEditReference_canListView;b.setLabelStyle=
MO.MUiEditReference_setLabelStyle;b.doListView=MO.MUiEditReference_doListView;return b};MO.MUiEditReference_onListClick=function(b){this.canListView()&&this.doListView()};MO.MUiEditReference_canListView=function(){return!MO.Lang.String.isEmpty(this._lovReference)&&this._editable};MO.MUiEditReference_setLabelStyle=function(){MO.Lang.String.isEmpty(this.lovRefer)||(this.hLabel.style.cursor="hand",this.attachEvent("onListClick",this.hLabel),this.hLabel.className="RLine_Underline")};
MO.MUiEditReference_doListView=function(b){var d=this._listView;d||(d=this._listView=top.MO.RControl.create(top.MO.FListWindow));d.linkConsole=MO.RConsole;d.linkLovControl(this);d.show();d.fetch(b)};MO.MUiEditValidator=function(b){b=MO.Class.inherits(this,b);b._validable=!1;b._valid=!0;b._validText=null;b.oeValid=MO.Method.empty;return b};
MO.MUiEditValue=function(b){b=MO.Class.inherits(this,b,MO.MUiEditFormator);b._dataValue=MO.Class.register(b,new MO.APtyString("_dataValue"));b._statusEditable=!0;b._statusEditing=!1;b._statusInvalid=!0;b._recordText=null;b._recordValue=null;b.isTextChanged=MO.MUiEditValue_isTextChanged;b.isValueChanged=MO.MUiEditValue_isValueChanged;b.formator=MO.MUiEditValue_formator;b.text=MO.MUiEditValue_text;b.setText=MO.MUiEditValue_setText;b.get=MO.MUiEditValue_get;b.set=MO.MUiEditValue_set;b.clearValue=MO.MUiEditValue_clearValue;
b.resetValue=MO.MUiEditValue_resetValue;b.loadValue=MO.MUiEditValue_loadValue;b.saveValue=MO.MUiEditValue_saveValue;b.recordValue=MO.MUiEditValue_recordValue;b.validValue=MO.Method.empty;b.setEditAble=MO.MUiEditValue_setEditAble;b.doFocus=MO.MUiEditValue_doFocus;b.doBlur=MO.MUiEditValue_doBlur;return b};MO.MUiEditValue_isTextChanged=function(){var b=this.text();return MO.Lang.String.equals(this._recordText,b)};
MO.MUiEditValue_isValueChanged=function(){var b=this.get();return MO.Lang.String.equals(this._recordValue,b)};MO.MUiEditValue_formator=function(){return this};MO.MUiEditValue_text=function(){};MO.MUiEditValue_setText=function(b){};MO.MUiEditValue_get=function(){var b=this.text();return this._dataValue=this.formator().formatValue(b)};MO.MUiEditValue_set=function(b){this._dataValue=MO.Lang.String.nvl(b);b=this.formator().formatText(b);this.setText(b)};
MO.MUiEditValue_clearValue=function(){this._dataValue=MO.Lang.String.EMPTY;this.set(MO.Lang.String.EMPTY)};MO.MUiEditValue_resetValue=function(){this._dataValue=value;this.set(value)};MO.MUiEditValue_loadValue=function(b,d){};MO.MUiEditValue_saveValue=function(b,d){};MO.MUiEditValue_recordValue=function(){this._recordText=this.text();this._recordValue=this.get()};MO.MUiEditValue_setEditAble=function(b){this._statusEditable=b};
MO.MUiEditValue_doFocus=function(){this._statusEditable&&(this._statusEditing=!0)};MO.MUiEditValue_doBlur=function(){this._statusEditable&&this._statusEditing&&(this._statusEditing=!1)};MO.MUiEditValue_oeClearValue=function(b){b=this.descriptor();MO.Lang.String.isEmpty(b.dataName)||(this.clearValue(),this.dataValue=this.reget());return EEventStatus.Stop};
MO.MUiEditValue_oeResetValue=function(b){b=this.descriptor();MO.Lang.String.isEmpty(b.dataName)||(this.resetValue(),this.dataValue=this.reget());return EEventStatus.Stop};MO.MUiEditValue_oeLoadValue=function(b){var d=this.descriptor();b=b.values;d=d.dataName;!MO.Lang.String.isEmpty(d)&&b.contains(d)&&(d=b.nvl(d),RControl.isInfo(d)?this.setInfoPack(d):RControl.isGroup(d)?this.setGroupPack(d):this.loadValue(b),this.recordValue(),this.dataValue=this.reget());return EEventStatus.Stop};
MO.MUiEditValue_oeSaveValue=function(b){var d=this.descriptor();MO.Lang.String.isEmpty(d.dataName)||this.saveValue(b.values);return EEventStatus.Stop};MO.MUiEditValue_oeRecordValue=function(){var b=this.descriptor();MO.Lang.String.isEmpty(b.dataName)||this.recordValue();return EEventStatus.Stop};MO.MUiEditValue_commitValue=function(){this.__commitValue=MO.Lang.String.nvl(this.reget())};MO.MUiEditValue_reget=function(){return this.descriptor().formatValue(this.text())};
MO.MUiEditValue_setInfoPack=function(b){var d=this._info;d||(d=this._info=new MO.TControlInfo);d.unpack(b);b=this.descriptor();b.setInfo(d);b!=this&&this.setInfo(d)};MO.MUiEditValue_setInfo=function(b){this.set(b.value)};MO.MUiEditZoom=function(b){b=MO.Class.inherits(this,b);b._zoomReference=MO.Class.register(b,new MO.APtyString("_zoomReference"));b._zoomField=MO.Class.register(b,new MO.APtyString("_zoomField"));b.testZoom=MO.MUiEditZoom_testZoom;b.doZoom=MO.MUiEditZoom_doZoom;return b};
MO.MUiEditZoom_testZoom=function(){return!MO.Lang.String.isEmpty(this._zoomReference)};MO.MUiEditZoom_doZoom=function(b){MO.RFormSpace.doZoom(this,b)};
MO.MUiFocus=function(b){b=MO.Class.inherits(this,b);b.onFocus=MO.Class.register(b,new MO.AEventFocus("onFocus"),MO.MUiFocus_onFocus);b.onBlur=MO.Class.register(b,new MO.AEventBlur("onBlur"));b.testFocus=MO.Method.emptyTrue;b.testBlur=MO.Method.emptyTrue;b.doFocus=MO.Method.empty;b.doBlur=MO.Method.empty;b.focus=MO.MUiFocus_focus;b.blur=MO.MUiFocus_blur;return b};MO.MUiFocus_onFocus=function(b){MO.Console.find(MO.FUiFocusConsole).focus(this,b)};MO.MUiFocus_focus=function(){MO.Console.find(MO.FUiFocusConsole).focus(this)};
MO.MUiFocus_blur=function(){MO.Console.find(MO.FUiFocusConsole).blur(this)};MO.MUiHorizontal=function(b){b=MO.Class.inherits(this,b);b.setVisible=MO.MUiHorizontal_setVisible;return b};MO.MUiHorizontal_setVisible=function(b){var d=this.hPanelLine;d&&MO.RHtml.displaySet(d,b)};MO.MUiPopup=function(b){b=MO.Class.inherits(this,b);b._opener=null;b.opener=MO.MUiPopup_opener};MO.MUiPopup_opener=function(){return this._opener};
MO.MUiProgress=function(b){b=MO.Class.inherits(this,b);b.oeProgress=MO.Method.virtual(b,"oeProgress");return b};
MO.MUiSize=function(b){b=MO.Class.inherits(this,b);b._location=MO.Class.register(b,new MO.APtyPoint2("_location"));b._size=MO.Class.register(b,new MO.APtySize2("_size"));b.construct=MO.MUiSize_construct;b.dockCd=MO.MUiSize_dockCd;b.setDockCd=MO.MUiSize_setDockCd;b.left=MO.MUiSize_left;b.setLeft=MO.MUiSize_setLeft;b.top=MO.MUiSize_top;b.setTop=MO.MUiSize_setTop;b.location=MO.MUiSize_location;b.setLocation=MO.MUiSize_setLocation;b.refreshLocation=MO.MUiSize_refreshLocation;b.width=MO.MUiSize_width;
b.setWidth=MO.MUiSize_setWidth;b.height=MO.MUiSize_height;b.setHeight=MO.MUiSize_setHeight;b.size=MO.MUiSize_size;b.setSize=MO.MUiSize_setSize;b.refreshSize=MO.MUiSize_refreshSize;b.setBounds=MO.MUiSize_setBounds;b.refreshBounds=MO.MUiSize_refreshBounds;b.dispose=MO.MUiSize_dispose;b.innerDump=MO.MUiSize_innerDump;return b};MO.MUiSize_construct=function(){this._location=new MO.SPoint2;this._size=new MO.SUiSize2};MO.MUiSize_dockCd=function(){return this._dockCd};
MO.MUiSize_setDockCd=function(b){this._dockCd=b};MO.MUiSize_left=function(){return this._location.x};MO.MUiSize_setLeft=function(b){this.setLocation(b,null)};MO.MUiSize_top=function(){return this._location.y};MO.MUiSize_setTop=function(b){this.setLocation(null,b)};MO.MUiSize_location=function(){return this._location};
MO.MUiSize_setLocation=function(b,d){var f=this.panel(MO.EPanel.Size);null!=b&&(this._location.x=b,f&&!f.__fragment&&(f.style.left=0==b?null:b+"px"));null!=d&&(this._location.y=d,f&&!f.__fragment&&(f.style.top=0==d?null:d+"px"))};MO.MUiSize_refreshLocation=function(){this.setLocation(this._location.x,this._location.y)};MO.MUiSize_width=function(){return this._size.width};MO.MUiSize_setWidth=function(b){this.setSize(b,null)};MO.MUiSize_height=function(){return this._size.width};
MO.MUiSize_setHeight=function(b){this.setSize(null,b)};MO.MUiSize_size=function(){return this._size};MO.MUiSize_setSize=function(b,d){var f=this.panel(MO.EPanel.Size);null!=b&&(this._size.width=b,f&&!f.__fragment&&("TD"==f.tagName?0!=b&&(f.width=b):MO.Lang.String.contains(b,"%")?f.style.width=b:f.style.width=0==b?null:b+"px"));null!=d&&(this._size.height=d,f&&!f.__fragment&&("TD"==f.tagName?0!=d&&(f.height=d):MO.Lang.String.contains(d,"%")?f.style.height=d:f.style.height=0==d?null:d+"px"))};
MO.MUiSize_refreshSize=function(){this.setSize(this._size.width,this._size.height)};MO.MUiSize_setBounds=function(b,d,f,h){this.setLocation(b,d);this.setSize(f,h)};MO.MUiSize_refreshBounds=function(){this.refreshLocation();this.refreshSize()};MO.MUiSize_dispose=function(){var b=this._location;b&&(b.dispose(),this._location=null);if(b=this._size)b.dispose(),this._size=null};MO.MUiSize_innerDump=function(b,d){b.append("MUiSize:");b.append(this.left,",",this.top,"-",this.width,",",this.height,"]")};
MO.MUiSizeable=function(b){b=MO.Class.inherits(this,b);b.isSizeable=!0;b.onSize=null;b.inSizeRange=MO.Method.virtual(b,"inSizeRange");b.cursor=MO.MUiSizeable_cursor;b.setCursor=MO.MUiSizeable_setCursor;b.resize=MO.MUiSizeable_resize;b.setBounds=MO.MUiSizeable_setBounds;b.startDrag=MO.MUiSizeable_startDrag;b.stopDrag=MO.MUiSizeable_stopDrag;return b};
MO.MUiSizeable_cursor=function(){var b=MO.Window.source();if(!this.inSizeRange(b))return MO.ECursor.Default;for(var d=this.panel(MO.EPanel.Border),f=MO.Window.Html.rect(d),h=MO.Window.offsetPos(),h=new MO.TPoint(h.x-f.left,h.y-f.top);b;){h.x+=b.offsetLeft+b.clientLeft;h.y+=b.offsetTop+b.clientTop;if(b==d)break;b=b.offsetParent}b=MO.EMoveSize.Border;d=MO.EMoveSize.Range;x=h.x;y=h.y;h=f.width();f=f.height();return 0<=x&&x<=d&&0<=y&&y<=d?MO.ECursor.NorthWest:0<=x&&x<=d&&y>=f-d&&y<=f?MO.ECursor.SouthWest:
x>=h-d&&x<=h&&y>=f-d&&y<=f?MO.ECursor.SouthEast:x>=h-d&&x<=h&&0<=y&&y<=d?MO.ECursor.NorthEast:0<=x&&x<b&&y>d&&y<f-d?MO.ECursor.West:x>d&&x<h-d&&y>=f-b&&y<=f?MO.ECursor.South:x>=h-b&&x<=h&&y>d&&y<f-d?MO.ECursor.East:x>d&&x<h-d&&0<=y&&y<b?MO.ECursor.North:ECursor.Default};MO.MUiSizeable_setCursor=function(b){b||(b=this.cursor());var d=this.panel(MO.EPanel.Size);d&&(d.style.cursor=null==b||"default"==b?"default":b+"-resize")};
MO.MUiSizeable_resize=function(b,d){var f=!1,h=this.htmlPanel(EPanel.Border).style;null!=b&&(b=Math.max(parseInt(b),EMoveSize.MinWidth),this.width!=b&&(this.width=b,h.pixelWidth=b,f=!0));null!=d&&(d=Math.max(parseInt(d),EMoveSize.MinHeight),this.height!=d&&(this.height=d,h.pixelHeight=d,f=!0));if(f&&this.onSize)this.onSize()};
MO.MUiSizeable_setBounds=function(b,d,f,h,q){var w=!1,z=this.htmlPanel(EPanel.Border).style;null!=b&&(b=null==f||null!=f&&f-b>EMoveSize.MinWidth?Math.max(b,0):this.left,q||this.left!=b)&&(this.left=b,z.pixelLeft=b,w=!0);null!=d&&(d=null==h||null!=h&&h-d>EMoveSize.MinHeight?Math.max(d,0):this.top,q||this.top!=d)&&(this.top=d,z.pixelTop=d,w=!0);null!=f&&(b=Math.max(f-this.left+1,EMoveSize.MinWidth),q||this.width!=b)&&(this.width=b,z.pixelWidth=this.width,w=!0);null!=h&&(h=Math.max(h-this.top+1,EMoveSize.MinHeight),
q||this.height!=h)&&(this.height=h,z.pixelHeight=this.height,w=!0);if(w&&this.onSize)this.onSize()};MO.MUiSizeable_startDrag=function(){};MO.MUiSizeable_stopDrag=function(){};MO.MUiStyle=function(b){b=MO.Class.inherits(this,b);b.construct=MO.Method.empty;b.styleName=MO.MUiStyle_styleName;b.styleIcon=MO.MUiStyle_styleIcon;b.styleIconPath=MO.MUiStyle_styleIconPath;b.dispose=MO.Method.empty;return b};MO.MUiStyle_styleName=function(b,d){var f=MO.Class.name(d?d:this);return MO.Class.forName(f).style(b)};
MO.MUiStyle_styleIcon=function(b,d){return MO.Class.name(d?d:this,!0)+"_"+b};MO.MUiStyle_styleIconPath=function(b,d){return MO.RResource.iconPath(MO.Class.name(d?d:this,!0)+"_"+b)};MO.MUiVertical=function(b){b=MO.Class.inherits(this,b);b.setVisible=MO.MUiHorizontal_setVisible;return b};MO.MUiHorizontal_setVisible=function(b){var d=this.hPanelLine;d&&MO.Window.Html.displaySet(d,b)};
MO.MListenerBlur=function(b){b=MO.Class.inherits(this,b,MO.MListener);b.addBlurListener=MO.MListenerBlur_addBlurListener;b.processBlurListener=MO.MListenerBlur_processBlurListener;return b};MO.MListenerBlur_addBlurListener=function(b,d){return this.addListener(MO.EEvent.Blur,b,d)};MO.MListenerBlur_processBlurListener=function(b,d,f,h,q){this.processListener(MO.EEvent.Blur,b,d,f,h,q)};
MO.MListenerClick=function(b){b=MO.Class.inherits(this,b,MO.MListener);b.addClickListener=MO.MListenerClick_addClickListener;b.setClickListener=MO.MListenerClick_setClickListener;b.removeClickListener=MO.MListenerClick_removeClickListener;b.processClickListener=MO.MListenerClick_processClickListener;return b};MO.MListenerClick_addClickListener=function(b,d){return this.addListener(MO.EEvent.Click,b,d)};MO.MListenerClick_setClickListener=function(b,d){return this.setListener(MO.EEvent.Click,b,d)};
MO.MListenerClick_removeClickListener=function(b,d){return this.removeListener(MO.EEvent.Click,b,d)};MO.MListenerClick_processClickListener=function(b,d,f,h,q){this.processListener(MO.EEvent.Click,b,d,f,h,q)};MO.MListenerDataChanged=function(b){b=MO.Class.inherits(this,b,MO.MListener);b.addDataChangedListener=MO.MListenerDataChanged_addDataChangedListener;b.processDataChangedListener=MO.MListenerDataChanged_processDataChangedListener;return b};
MO.MListenerDataChanged_addDataChangedListener=function(b,d){return this.addListener(MO.EEvent.DataChanged,b,d)};MO.MListenerDataChanged_processDataChangedListener=function(b,d,f,h,q){this.processListener(MO.EEvent.DataChanged,b,d,f,h,q)};
MO.MListenerDoubleClick=function(b){b=MO.Class.inherits(this,b,MO.MListener);b.addDoubleClickListener=MO.MListenerDoubleClick_addDoubleClickListener;b.setDoubleClickListener=MO.MListenerDoubleClick_setDoubleClickListener;b.processDoubleClickListener=MO.MListenerDoubleClick_processDoubleClickListener;return b};MO.MListenerDoubleClick_addDoubleClickListener=function(b,d){return this.addListener(MO.EEvent.DoubleClick,b,d)};
MO.MListenerDoubleClick_setDoubleClickListener=function(b,d){return this.setListener(MO.EEvent.DoubleClick,b,d)};MO.MListenerDoubleClick_processDoubleClickListener=function(b,d,f,h,q){this.processListener(MO.EEvent.DoubleClick,b,d,f,h,q)};MO.MListenerEnter=function(b){b=MO.Class.inherits(this,b,MO.MListener);b.addEnterListener=MO.MListenerEnter_addEnterListener;b.processEnterListener=MO.MListenerEnter_processEnterListener;return b};
MO.MListenerEnter_addEnterListener=function(b,d){return this.addListener(MO.EEvent.Enter,b,d)};MO.MListenerEnter_processEnterListener=function(b,d,f,h,q){this.processListener(MO.EEvent.Enter,b,d,f,h,q)};MO.MListenerFocus=function(b){b=MO.Class.inherits(this,b,MO.MListener);b.addFocusListener=MO.MListenerFocus_addFocusListener;b.processFocusListener=MO.MListenerFocus_processFocusListener;return b};MO.MListenerFocus_addFocusListener=function(b,d){return this.addListener(MO.EEvent.Focus,b,d)};
MO.MListenerFocus_processFocusListener=function(b,d,f,h,q){this.processListener(MO.EEvent.Focus,b,d,f,h,q)};MO.MListenerItemClick=function(b){b=MO.Class.inherits(this,b,MO.MListener);b.addItemClickListener=MListenerItemClick_addItemClickListener;b.processItemClickListener=MListenerItemClick_processItemClickListener;return b};MO.MListenerItemClick_addItemClickListener=function(b,d){return this.addListener(MO.EEvent.ItemClick,b,d)};
MO.MListenerItemClick_processItemClickListener=function(b,d,f,h,q){this.processListener(MO.EEvent.ItemClick,b,d,f,h,q)};MO.MListenerLeave=function(b){b=MO.Class.inherits(this,b,MO.MListener);b.addLeaveListener=MO.MListenerLeave_addLeaveListener;b.processLeaveListener=MO.MListenerLeave_processLeaveListener;return b};MO.MListenerLeave_addLeaveListener=function(b,d){return this.addListener(MO.EEvent.Leave,b,d)};
MO.MListenerLeave_processLeaveListener=function(b,d,f,h,q){this.processListener(MO.EEvent.Leave,b,d,f,h,q)};MO.MListenerResult=function(b){b=MO.Class.inherits(this,b,MO.MListener);b.addResultListener=MO.MListenerResult_addResultListener;b.removeResultListener=MO.MListenerResult_removeResultListener;b.processResultListener=MO.MListenerResult_processResultListener;b.clearResultListeners=MO.MListenerResult_clearResultListeners;return b};
MO.MListenerResult_addResultListener=function(b,d){return this.addListener(MO.EEvent.Result,b,d)};MO.MListenerResult_removeResultListener=function(b,d){return this.removeListener(MO.EEvent.Result,b,d)};MO.MListenerResult_processResultListener=function(b,d,f,h,q){this.processListener(MO.EEvent.Result,b,d,f,h,q)};MO.MListenerResult_clearResultListeners=function(){return this.clearListeners(MO.EEvent.Result)};
MO.MListenerSelected=function(b){b=MO.Class.inherits(this,b,MO.MListener);b.addSelectedListener=MO.MListenerSelected_addSelectedListener;b.processSelectedListener=MO.MListenerSelected_processSelectedListener;return b};MO.MListenerSelected_addSelectedListener=function(b,d){return this.addListener(MO.EEvent.Selected,b,d)};MO.MListenerSelected_processSelectedListener=function(b,d,f,h,q){this.processListener(MO.EEvent.Selected,b,d,f,h,q)};
MO.SServiceInfo=function(){this.url=this.action=this.service=null;return this};MO.SUiSize2=function(b,d){MO.SSize2.call(this,b,d);this.parse=MO.SUiSize2_parse;return this};MO.SUiSize2_parse=function(b){b=b.split(",");if(2==b.length){var d=b[0];MO.Lang.String.contains(d,"%")?this.width=d:this.width=parseInt(d);b=b[1];MO.Lang.String.contains(b,"%")?this.height=b:this.height=parseInt(b)}else throw new MO.TError(this,"Parse value failure. (value={1})",b);};
MO.TDatasetFetchArg=function(b){b||(b=this);b.datasets=new MO.TDictionary;b.saveConfig=MO.TDatasetFetchArg_saveConfig;b.process=MO.TDatasetFetchArg_process;return b};MO.TDatasetFetchArg_saveConfig=function(b){b.set("name",this.name)};MO.TDatasetFetchArg_process=function(){this.owner?this.callback.call(this.owner,this):this.callback(this)};MO.TDatasetFetchArg_push=function(b){RClass.isClass(b,TSearchItem)?this.searchs.push(b):RClass.isClass(b,TOrderItem)&&this.orders.push(b)};
MO.TDatasetFetchArg_invoke=function(){this.callback&&this.callback.invoke(this)};MO.TEvent=function(b,d,f){this.owner=b;this.code=d;this.type=null;this.onProcess=f;this.isBefore=MO.TEvent_isBefore;this.isAfter=MO.TEvent_isAfter;this.process=MO.TEvent_process;this.dump=MO.TEvent_dump;return this};MO.TEvent_isBefore=function(){return EEventType.Before==this.type};MO.TEvent_isAfter=function(){return EEventType.After==this.type};
MO.TEvent_process=function(){if(!this.onProcess)return RMessage.fatal(this,null,"Process event is null. (owner={1})",RClass.dump(this.owner));var b=new TSpeed(this,"Process event (owner={0}, process={1})",this.owner,RMethod.name(this.onProcess));if(this.owner)this.onProcess.call(this.owner,this);else this.onProcess();b.record()};MO.TEvent_dump=function(){return RClass.typeOf(this)+" ["+this.owner+","+this.type+"-"+this.code+"]"};
MO.TEventProcess=function(b,d,f){this.owner=b;this.invoke=d;this.clazz=MO.Class.name(f);this.invokeCd=MO.EEventInvoke.Unknown;this.isBefore=MO.TEventProcess_isBefore;this.isAfter=MO.TEventProcess_isAfter;this.dispose=MO.TEventProcess_dispose;this.dump=MO.TEventProcess_dump;return this};MO.TEventProcess_isBefore=function(){return this.invokeCd==MO.EEventInvoke.Before};MO.TEventProcess_isAfter=function(){return this.invokeCd==MO.EEventInvoke.After};
MO.TEventProcess_dispose=function(){this.invokeCd=this.clazz=this.invoke=this.owner=null};MO.TEventProcess_dump=function(){return RClass.dump(this)+":owner="+this.owner+",type="+this.type+".invoke="+RMethod.name(this.invoke)};MO.THtmlEvent=function(){this.linker=null;this.events={};this.push=MO.THtmlEvent_push;this.dispose=MO.THtmlEvent_dispose;this.dump=MO.THtmlEvent_dump;return this};
MO.THtmlEvent_push=function(b,d){var f=this.events,h=f[b];h||(h=[],h.handle=d.handle,f[b]=h);f=h.length;if(0<f)for(var q=d.annotation.name(),w=0;w<f;w++){var z=h[w].annotation.name();if(z==q)throw new TError(this,"Duplicate event for same control. (name={1}, source={2}, event={3})\n{4}\n{5}",z,RClass.dump(d.source),RClass.dump(d),RString.repeat("-",60),this.dump());}h[h.length]=d};
MO.THtmlEvent_dispose=function(){for(var b in this.events){var d=this.events[b];d.length&&(this.linker[d.handle]=null)}this.linker.linker&&this.linker.removeAttribute("link")};MO.THtmlEvent_dump=function(){var b=this.events,d=new TString,f;for(f in b){var h=b[f],q=h.length;d.append("event="+f+" (count="+q+")\n");for(var w=0;w<q;w++){var z=h[w];d.append("   "+w+" source="+RClass.dump(z.source)+", event="+RClass.dump(z)+"\n")}}return d.flush()};
MO.THtmlEvent_load=function(b){this.ctrlKey=b.ctrlKey;this.keyCode=b.keyCode};MO.TOrderItem=function(b){return this};MO.TOrderItem_set=function(b,d){this.name=b;this.type=d};MO.TOrderItem_toNode=function(){var b=new MO.TNode("OrderItem");b.set("name",this.name);b.set("type",this.type);return b};MO.TOrderItem_pack=function(){var b=new MO.TAttributes;b.set("name",this.name);b.set("type",this.type);return b.pack()};
MO.TOrderItem_unpack=function(b){var d=new MO.TAttributes;d.unpack(b);this.name=d.get("name");this.type=d.get("type")};MO.TOrderItems=function(){MO.TObjects.call(this)};MO.TOrderItems_pack=function(){for(var b=new MO.TStrings,d=this.count,f=0;f<d;f++){var h=this.get(f).pack();b.push(h)}return b.pack()};MO.TOrderItems_unpack=function(b){this.clear();var d=new MO.TStrings;d.unpack(b);for(b=0;b<d.count;b++){t=d.get(b);var f=new TOrderItem;f.unpack(t);this.push(f)}};MO.TSearchItem=function(){return this};
MO.TSearchItem_set=function(b,d,f,h){this.name=b;this.type=MO.Lang.String.nvl(f,MO.ESearch.Equals);this.value=d;this.format=h};MO.TSearchItem_toNode=function(){var b=new MO.TNode("SearchItem");b.set("name",this.name);b.set("type",this.type);b.set("value",this.value);b.set("format",this.format);return b};MO.TSearchItem_equals=function(b){return this.name==b.name&&this.type==b.type&&this.value==b.value?!0:!1};
MO.TSearchItem_pack=function(){var b=new MO.TAttributes;b.set("name",this.name);b.set("type",this.type);b.set("value",this.value);b.set("format",this.format);return b.pack()};MO.TSearchItem_unpack=function(b){var d=new MO.TAttributes;d.unpack(b);this.name=d.get("name");this.type=d.get("type");this.value=d.get("value");this.format=d.get("format")};MO.TSearchItems=function(){MO.TObjects.call(this)};
MO.TSearchItems_pack=function(){for(var b=new MO.TStrings,d=this.count,f=0;f<d;f++){var h=this.get(f).pack();b.push(h)}return b.pack()};MO.TSearchItems_removeAll=function(b){if(null!=b){for(var d=0,f=this.count,h=d;h<f;h++)this.memory[h].equals(b)||(this.memory[d++]=this.memory[h]);this.count=d}};
MO.TSearchItems_unpack=function(b){this.clear();var d=new MO.TStrings;d.unpack(b);for(var f=0;f<d.count;f++){t=d.get(f);var h=new TSearchItem;h.unpack(t);MO.Lang.String.isEmpty(h.name)?(this.clear(),MO.RMessage.fatal(this,"unpack","Invalid value (value={1})",b)):this.push(h)}};
MO.FDuiCanvas=function(b){b=MO.Class.inherits(this,b,MO.FDuiControl);b._styleCanvas=MO.Class.register(b,new MO.AStyle("_styleCanvas"));b.onBuildPanel=MO.FDuiCanvas_onBuildPanel;b.construct=MO.FDuiCanvas_construct;b.dispose=MO.FDuiCanvas_dispose;return b};MO.FDuiCanvas_onBuildPanel=function(b){this._hPanel=MO.Window.Builder.create(b,"CANVAS",this.styleName("Canvas"))};MO.FDuiCanvas_construct=function(){this.__base.FDuiControl.construct.call(this)};MO.FDuiCanvas_dispose=function(){this.__base.FDuiControl.dispose.call(this)};
MO.FDuiComponent=function(b){b=MO.Class.inherits(this,b,MO.FComponent,MO.MUiComponent,MO.MProperty,MO.MClone);b.dispose=MO.FDuiComponent_dispose;return b};MO.FDuiComponent_dispose=function(){this.__base.MUiComponent.dispose.call(this);this.__base.FComponent.dispose.call(this)};
MO.FDuiContainer=function(b){b=MO.Class.inherits(this,b,MO.FDuiControl,MO.MUiContainer);b._scrollCd=MO.Class.register(b,new MO.APtyEnum("_scrollCd",null,MO.EUiScroll,MO.EUiScroll.None));b._controls=null;b.oeDesign=MO.Method.empty;b.construct=MO.FDuiContainer_construct;b.hasControl=MO.FDuiContainer_hasControl;b.findControl=MO.FDuiContainer_findControl;b.searchControl=MO.FDuiContainer_searchControl;b.controls=MO.FDuiContainer_controls;b.panel=MO.FDuiContainer_panel;b.focusFirstControl=MO.FDuiContainer_focusFirstControl;
b.setControlsProperty=MO.FDuiContainer_setControlsProperty;b.storeConfig=MO.FDuiContainer_storeConfig;b.push=MO.FDuiContainer_push;b.remove=MO.FDuiContainer_remove;b.clear=MO.FDuiContainer_clear;b.dispose=MO.FDuiContainer_dispose;return b};MO.FDuiContainer_construct=function(){this.__base.FDuiControl.construct.call(this)};MO.FDuiContainer_hasControl=function(){var b=this._controls;return b?!b.isEmpty():!1};
MO.FDuiContainer_findControl=function(b){var d=this._controls;if(d)for(var f=d.count(),h=0;h<f;h++){var q=d.value(h);if(q.name()==b)return q}return null};MO.FDuiContainer_searchControl=function(b){var d=this._controls;if(d)for(var f=d.count(),h=0;h<f;h++){var q=d.value(h);if(q.name()==b||MO.Class.isClass(q,MO.FDuiContainer)&&(q=q.searchControl(b)))return q}return null};MO.FDuiContainer_controls=function(){var b=this._controls;null==b&&(this._controls=b=new MO.TDictionary);return b};
MO.FDuiContainer_panel=function(b){return b==MO.EPanel.Container?this._hPanel:this.__base.FDuiControl.panel.call(this,b)};MO.FDuiContainer_focusFirstControl=function(){var b=this._components;if(b){for(var d=b.count(),f=0;f<d;f++)if(b.valueAt(f),MO.Class.isClass(d,MO.MUiFocus)&&d.testFocus()&&!MO.Class.isClass(d,MO.FCalendar)&&!MO.Class.isClass(d,MO.FSelect)&&!MO.Class.isClass(d,MO.FNumber))return d.focus();MO.Console.find(MO.FFocusConsole).focus(this)}};
MO.FDuiContainer_setControlsProperty=function(b,d){var f=this._controls;if(f)for(var h=f.count()-1;0<=h;h--)f.value(h)[b]=d[n]};MO.FDuiContainer_storeConfig=function(b){b.name=MO.Class.name(this);this.saveConfig(b);var d=this._components;if(d)for(var f=d.count(),h=0;h<f;h++){var q=d.value(h),w=b.create(MO.Class.name(q));MO.Class.isClass(q,MO.FDuiContainer)?q.storeConfig(w):q.saveConfig(w)}};
MO.FDuiContainer_push=function(b){this.__base.FDuiControl.push.call(this,b);MO.Class.isClass(b,MO.FDuiControl)&&(this.controls().set(b._name,b),this.appendChild(b))};MO.FDuiContainer_remove=function(b){if(MO.Class.isClass(b,MO.FDuiControl)){var d=this._controls;if(!d.contains(b.name()))throw new MO.TError(this,"Parameter component is not in this component. (name={1})",b.name());d.removeValue(b);this.removeChild(b)}this.__base.FDuiControl.remove.call(this,b)};
MO.FDuiContainer_clear=function(){var b=this._controls;if(b){for(var d=b.count()-1;0<=d;d--)this.removeChild(b.at(d));b.clear()}this.__base.FDuiControl.clear.call(this)};MO.FDuiContainer_dispose=function(){var b=this._controls;b&&(b.dispose(),this._controls=null);this.__base.FDuiControl.dispose.call(this)};
MO.FDuiControl=function(b){b=MO.Class.inherits(this,b,MO.FDuiComponent,MO.MUiControl,MO.MListener,MO.MUiSize,MO.MUiMargin,MO.MUiPadding,MO.MUiStyle);b._wrapCd=MO.Class.register(b,[new MO.APtyEnum("_wrapCd",null,MO.EUiWrap,MO.EUiWrap.NextLine),new MO.AGetSet("_wrapCd")]);b._stylePanel=MO.Class.register(b,new MO.AStyle("_stylePanel"));b._layoutCd=MO.EUiLayout.Display;b._sizeCd=MO.EUiSize.Normal;b._statusVisible=!0;b._statusEnable=!0;b._statusBuild=!1;b._statusBuilded=!1;b._storage=null;b._hParent=null;
b._hPanel=null;b.onEnter=MO.Class.register(b,new MO.AEventMouseEnter("onEnter"),MO.FDuiControl_onEnter);b.onLeave=MO.Class.register(b,new MO.AEventMouseLeave("onLeave"),MO.FDuiControl_onLeave);b.onBuildPanel=MO.FDuiControl_onBuildPanel;b.onBuild=MO.FDuiControl_onBuild;b.onBuilded=MO.Method.empty;b.oeMode=MO.FDuiControl_oeMode;b.construct=MO.FDuiControl_construct;b.topControl=MO.FDuiControl_topControl;b.panel=MO.FDuiControl_panel;b.isVisible=MO.FDuiControl_isVisible;b.setVisible=MO.FDuiControl_setVisible;
b.show=MO.FDuiControl_show;b.hide=MO.FDuiControl_hide;b.isEnable=MO.FDuiControl_isEnable;b.setEnable=MO.FDuiControl_setEnable;b.enable=MO.FDuiControl_enable;b.disable=MO.FDuiControl_disable;b.setMargin=MO.FDuiControl_setMargin;b.refreshMargin=MO.FDuiControl_refreshMargin;b.setPadding=MO.FDuiControl_setPadding;b.refreshPadding=MO.FDuiControl_refreshPadding;b.attachEvent=MO.FDuiControl_attachEvent;b.linkEvent=MO.FDuiControl_linkEvent;b.callEvent=MO.FDuiControl_callEvent;b.psMode=MO.FDuiControl_psMode;
b.psDesign=MO.FDuiControl_psDesign;b.isBuild=MO.FDuiControl_isBuild;b.build=MO.FDuiControl_build;b.builded=MO.FDuiControl_builded;b.refresh=MO.FDuiControl_refresh;b.setPanel=MO.FDuiControl_setPanel;b.dispose=MO.FDuiControl_dispose;return b};MO.FDuiControl_onEnter=function(b){MO.Console.find(MO.FUiFocusConsole).enter(this);this._hint&&MO.RWindow.setStatus(this._hint)};MO.FDuiControl_onLeave=function(b){MO.Console.find(MO.FUiFocusConsole).leave(this);this._hint&&MO.RWindow.setStatus()};
MO.FDuiControl_onBuildPanel=function(b){this._hPanel=MO.RBuilder.createDiv(b,this.styleName("Panel"))};MO.FDuiControl_onBuild=function(b){this.onBuildPanel(b);this._statusVisible!=this._visible&&this.setVisible(this._visible);b=this._hPanel;MO.RHtml.linkSet(b,"control",this);this.attachEvent("onEnter",b);this.attachEvent("onLeave",b);this.refreshBounds();this.refreshPadding();this.refreshMargin()};MO.FDuiControl_oeMode=function(b){this._displayCd=b.displayCd;return MO.EEventStatus.Continue};
MO.FDuiControl_construct=function(){this.__base.FDuiComponent.construct.call(this);this.__base.MUiSize.construct.call(this);this.__base.MUiMargin.construct.call(this);this.__base.MUiPadding.construct.call(this);this.__base.MUiStyle.construct.call(this)};MO.FDuiControl_topControl=function(b){var d=this;if(b){for(;d._parent;){if(MO.Class.isClass(d._parent,b))return d._parent;d=d._parent}if(!MO.Class.isClass(d,b))return null}else for(;d._parent&&MO.Class.isClass(d._parent,FDuiControl);)d=d._parent;return d};
MO.FDuiControl_panel=function(b){switch(b){case MO.EPanel.Parent:return this._hParent;case MO.EPanel.Container:case MO.EPanel.Size:return this._hPanel}return null};MO.FDuiControl_isVisible=function(){return this._statusVisible};MO.FDuiControl_setVisible=function(b){this._statusVisible=b;var d=this.panel(MO.EPanel.Container);d&&MO.RHtml.visibleSet(d,b)};MO.FDuiControl_show=function(){this._statusVisible||this.setVisible(!0)};MO.FDuiControl_hide=function(){this._statusVisible&&this.setVisible(!1)};
MO.FDuiControl_isEnable=function(){return this._statusEnable};MO.FDuiControl_setEnable=function(b){this._statusEnable=b;var d=this.panel(EPanel.Container);d&&(d.style.disabled=!b)};MO.FDuiControl_enable=function(){this._statusEnable||this.setEnable(!0)};MO.FDuiControl_disable=function(){this._statusEnable&&this.setEnable(!1)};
MO.FDuiControl_setMargin=function(b,d,f,h){var q=this._padding,w=this.panel(MO.EPanel.Container),z=null;w&&!w.__fragment&&(z=w.style);null!=b&&(q.left=b,z&&(z.marginLeft=0==b?null:b+"px"));null!=d&&(q.top=d,z&&(z.marginTop=0==d?null:d+"px"));null!=f&&(q.right=f,z&&(z.marginRight=0==f?null:f+"px"));null!=h&&(q.bottom=h,z&&(z.marginBottom=0==h?null:h+"px"))};MO.FDuiControl_refreshMargin=function(){var b=this._margin;this.setMargin(b.left,b.top,b.right,b.bottom)};
MO.FDuiControl_setPadding=function(b,d,f,h){var q=this._padding,w=this.panel(MO.EPanel.Container),z=null;w&&!w.__fragment&&(z=w.style);null!=b&&(q.left=b,z&&(z.paddingLeft=0==b?null:b+"px"));null!=d&&(q.top=d,z&&(z.paddingTop=0==d?null:d+"px"));null!=f&&(q.right=f,z&&(z.paddingRight=0==f?null:f+"px"));null!=h&&(q.bottom=h,z&&(z.paddingBottom=0==h?null:h+"px"))};MO.FDuiControl_refreshPadding=function(){var b=this._padding;this.setPadding(b.left,b.top,b.right,b.bottom)};
MO.FDuiControl_attachEvent=function(b,d,f,h){return MO.RUiControl.attachEvent(this,b,d,f,h)};MO.FDuiControl_linkEvent=function(b,d,f,h){return MO.RUiControl.linkEvent(this,b,d,f,h)};MO.FDuiControl_callEvent=function(b,d,f){var h=this._events;h&&(b=h.get(b))&&b.invoke(d,d,f)};MO.FDuiControl_psMode=function(b){var d=new MO.TEventProcess(this,"oeMode",MO.FDuiControl);d.displayCd=b;this.process(d);d.dispose()};
MO.FDuiControl_psDesign=function(b,d){MO.Console.find(FDesignConsole).setFlag(b,d,this);var f=new MO.TEventProcess(this,"oeDesign",MO.MDesign);f.mode=b;f.flag=d;this.process(f);f.dispose()};MO.FDuiControl_isBuild=function(){return this._statusBuild};
MO.FDuiControl_build=function(b){if(this._statusBuild)throw new MO.TError(this,"Current control is already builded.");var d=null;if(b.createElement)d=b;else if(b.ownerDocument&&b.ownerDocument.createElement)d=b.ownerDocument;else if(b.hDocument)d=b.hDocument;else throw new MO.TError("Build document is invalid. (document={1})",b);b=new MO.SArguments;b.owner=this;b.hDocument=d;this.onBuild(b);b.owner=null;b.hDocument=null;MO.Lang.Object.free(b);this._statusBuild=!0};
MO.FDuiControl_builded=function(b){if(!this._statusBuild)throw new MO.TError(this,"Current control is not build.");if(this._statusBuilded)throw new MO.TError(this,"Current control is already builded.");this.onBuilded(b);this._statusBuilded=!0};MO.FDuiControl_refresh=function(){if(!this._statusBuild)throw new MO.TError(this,"Current control is not build.");};MO.FDuiControl_setPanel=function(b){this._hParent=b;b.appendChild(this._hPanel)};
MO.FDuiControl_dispose=function(){this._hParent=this._statusBuild=this._statusEnable=this._statusVisible=this._styleContainer=this._hint=this._wrapCd=this._disable=null;this._hPanel=MO.RHtml.free(this._hPanel);this.__base.MUiStyle.dispose.call(this);this.__base.MUiPadding.dispose.call(this);this.__base.MUiMargin.dispose.call(this);this.__base.MUiSize.dispose.call(this);this.__base.MUiControl.dispose.call(this);this.__base.FDuiComponent.dispose.call(this)};
MO.FDuiWorkspace=function(b){b=MO.Class.inherits(this,b,MO.FDuiContainer,MO.MUiDescribeFrame);b._stylePanel=MO.Class.register(b,new MO.AStyle("_stylePanel"));b._frames=null;b._hContainer=null;b.onBuildPanel=MO.FDuiWorkspace_onBuildPanel;b.appendChild=MO.FDuiWorkspace_appendChild;return b};MO.FDuiWorkspace_onBuildPanel=function(b){this._hPanel=MO.RBuilder.createDiv(b,this.styleName("Panel"))};
MO.FDuiWorkspace_appendChild=function(b){if(MO.Class.isClass(b,MO.FUiFrameSet))this._hPanel.appendChild(b._hPanel);else throw new MO.TError(this,"Unknown child type.");};MO.RUiControl=function(){this.PREFIX="FUi";this.inDesign=this.inSizing=this.inMoving=!1;this.instances=new MO.TObjects;this.events=new MO.TMap;this.controls=new MO.TMap;return this};
MO.RUiControl.prototype.newInstance=function(b){var d=null;if(b){var f=d=null;if(b.constructor==String)RString.startsWith(b,this.PREFIX)||(d=this.PREFIX+b);else if(b.constructor==MO.TXmlNode)d=b.get("type"),MO.Lang.String.isEmpty(d)?(d=b.name(),MO.Lang.String.startsWith(d,this.PREFIX)||(d=this.PREFIX+d)):f=d;else throw new TError(this,"Unknown parameter. (name={p})",b);d=MO.Class.create(d);f&&(d.__typed=!0)}if(null==d)throw new MO.TError(this,"Create instance failure. (name={p})",b);return d};
MO.RUiControl.prototype.attachEvent=function(b,d,f,h,q){var w=null,z=b[d];if(!MO.Method.isEmpty(z)||h)d=MO.Class.find(b.constructor).annotation(MO.EAnnotation.Event,d),w=d.create(),w.annotation=d,w.source=b,w.hSource=f,w.ohProcess=h,w.onProcess=z,w.process=MO.RUiEvent.onProcess,MO.RUiEvent.find(f).push(d.linker(),w),MO.RHtml.linkSet(f,"_plink",b),d.bind(f,q);return w};
MO.RUiControl.prototype.innerCreate=function(b,d,f){if(null!=b&&null!=d&&(MO.Class.isClass(b,MO.MProperty)&&b.propertyLoad(d),MO.Class.isClass(b,MO.MUiContainer)&&d.hasNode())){d=d.nodes();for(var h=d.count(),q=0;q<h;q++){var w=d.get(q),z=b.createChild(w,f);z&&(this.innerCreate(z,w,f),b.push(z))}}};MO.RUiControl.prototype.create=function(b,d,f){var h=null,h=b?b:MO.RUiControl.newInstance(d.name());this.innerCreate(h,d,f);return h};
MO.RUiControl.prototype.innerbuild=function(b,d,f,h,q){if(null!=d&&null!=f){MO.Class.isClass(d,MO.MProperty)&&d.propertyLoad(f);var w=f.get("linker");w&&b&&(b[w]=d);MO.Class.isClass(d,MO.FDuiControl)&&(d.isBuild()?d.refresh():d.build(q));d.__typed&&(b=d);if(MO.Class.isClass(d,MO.MUiContainer)&&f.hasNode()){f=f.nodes();for(var w=f.count(),z=0;z<w;z++){var A=f.get(z),B=d.createChild(A);if(!B)throw new MO.TError("Invalid create child.");this.innerbuild(b,B,A,h,q);d.push(B)}}MO.Class.isClass(d,MO.FDuiControl)&&
d.builded(q)}};MO.RUiControl.prototype.build=function(b,d,f,h){b||(b=MO.RUiControl.newInstance(d));this.innerbuild(b,b,d,f,h);return b};
MO.RUiControl.prototype.setStyleScroll=function(b,d){var f=b.style;switch(d){case MO.EUiScroll.None:f.overflowX="";f.overflowY="";break;case MO.EUiScroll.Horizontal:f.overflowX="scroll";break;case MO.EUiScroll.HorizontalAuto:f.overflowX="auto";break;case MO.EUiScroll.Vertical:f.overflowY="scroll";break;case MO.EUiScroll.VerticalAuto:f.overflowY="auto";break;case MO.EUiScroll.Both:f.overflow="scroll";break;case MO.EUiScroll.BothAuto:f.overflow="auto";break;default:throw new MO.TError(o,"Unknown scroll type. (scroll_cd={1})",
d);}};MO.RUiControl.prototype.linkEvent=function(b,d,f,h,q){var w=b[f];if(!RMethod.isEmpty(w)||q){f=RClass.find(c.constructor).annotation(MO.EAnnotation.Event,f);var z=new f.constructor;z.name=f.name;z.source=b;z.sender=d;z.hSource=h;z.ohProcess=q;z.onProcess=w;z.process=RUiEvent.onProcess;RUiEvent.find(h).push(z.type,z);h[z.handle]=RUiEvent.ohEvent;RHtml.linkSet(h,"_plink",b);return z}};
MO.RUiControl.prototype.find=function(b){var d=null;if(b){b.constructor==Function?b=RMethod.name(b):b.constructor!=String&&RMsg.fatal(this,null,"Param invlid (class={0})",b);var f=this.controls,d=f.get(b);d||(d=new TControl(b),f.set(b,d))}return d};MO.RUiControl.prototype.fromNode=function(b,d){if(b)return this.create(b,d)};MO.RUiControl.prototype.fromXml=function(b,d,f){var h=null;(b=RXml.makeNode(b))&&(h=this.create(b,d,f));return h};MO.RUiControl.prototype.toNode=function(){};
MO.RUiControl.prototype.toXml=function(){};MO.RUiControl.prototype.store=function(b,d){var f=new TNode;f.name=RClass.name(b).substr(1);RClass.isClass(b,FContainer)?b.storeConfig(f):b.saveConfig(f);return f};MO.RUiControl.prototype.htmlControl=function(b,d){if(d)for(;b;){var f=RHtml.linkGet(b,"control");if(f&&RClass.isClass(f,d))return f;b=b.parentElement}else for(;b;){if(f=RHtml.linkGet(b,"control"))return f;b=b.parentElement}return null};
MO.RUiControl.prototype.psDesign=function(b,d,f,h){var q=this.instances;if(q&&q.count)for(var w=q.count,z=0;z<w;z++)q.get(z).psDesign(b,d,f,h)};MO.RUiControl.prototype.psMode=function(b,d,f,h){var q=this.instances;if(q&&q.count)for(var w=q.count,z=0;z<w;z++)q.get(z).psMode(b,d,f,h)};MO.RUiControl.prototype.isInfo=function(b){return b?0==b.indexOf("C#"):!1};MO.RUiControl.prototype.isGroup=function(b){return b?0==b.indexOf("G#"):!1};MO.RUiControl=new MO.RUiControl;MO.Dui.Control=MO.RUiControl;
MO.RUiEvent=function(){this._objects=[];this.current=0;this.events=[];return this};MO.RUiEvent.prototype.ohEvent=function(b){MO.RUiEvent.process(this,b?b:window.event)};MO.RUiEvent.prototype.onProcess=function(b){b=this;b.sender?b.onProcess.call(b.source,b.sender,b):b.onProcess.call(b.source,b)};MO.RUiEvent.prototype.find=function(b){var d=MO.RHtml.uid(b),f=this._objects,h=f[d];null==h&&(h=f[d]=new MO.THtmlEvent,h.linker=b);return h};
MO.RUiEvent.prototype.process=function(b,d){if(b&&d){var f=this.find(b);if(f&&(f=f.events[d.type])){for(var h=f.length,q=0;q<h;q++){var w=f[q],z=w.annotation;w.source=MO.RHtml.linkGet(b,"_plink");w.hSender=MO.RHtml.eventSource(d);w.sender=w.hSender._plinker;w.hSource=b;z.attach(w,d);w.ohProcess?w.ohProcess.call(w.source,w):w.onProcess&&MO.Console.find(MO.FUiFrameEventConsole).push(w)}return!0}return!1}};
MO.RUiEvent.prototype.release=function(){var b=this._objects;b&&(MO.RMemory.free(b),this._objects=null)};MO.RUiEvent.prototype.nvl=function(b,d,f){b||(b=new MO.TEvent);b.sender=d;b.code=f;return b};MO.RUiEvent.prototype.alloc=function(b,d){for(var f=null,h=this.events,q=0;q<h.length;q++)if(!h[q].inUsing){f=h[q];break}f||(f=h[h.length]=new MO.TEvent);f.inUsing=!0;f.sender=b;f.code=d;return f};MO.RUiEvent.prototype.free=function(b){b.inUsing=!1};MO.RUiEvent=new MO.RUiEvent;
MO.RUiLayer=function(){this._layers=[];return this};MO.RUiLayer.prototype.next=function(b){b=MO.Lang.Integer.nvl(b,EUiLayer.Default);var d=MO.Lang.Integer.nvl(this._layers[b],b);this._layers[b]=++d;return d};MO.RUiLayer.prototype.free=function(b,d){var f=MO.Lang.Integer.nvl(b,EUiLayer.Default),h=MO.Lang.Integer.nvl(this._layers[f],f);--h;h>f&&(this._layers[f]=h);return h};MO.RUiLayer=new MO.RUiLayer;MO.RUiService=function(){this._services=new MO.TDictionary;return this};
MO.RUiService.prototype.url=function(b){if(MO.Lang.String.startsWith(b,"http://"))return b;if(MO.Lang.String.startsWith(b,"#"))return b.substr(1);MO.Lang.String.startsWith(b,"/")||(b="/"+b);return b+".ws"};MO.RUiService.prototype.makeUrl=function(b,d){return this.url(b)+"?action="+d};
MO.RUiService.prototype.parse=function(b){var d=null,f=this._services;if(b){d=f.get(b);if(null==d){var h=b.split("@");1==h.length?h[0]&&(d=new MO.SServiceInfo,d.service=h[0],d.action=null,d.url=this.url(h[0])):2==h.length&&h[0]&&h[1]&&(d=new MO.SServiceInfo,d.service=h[1],d.action=h[0],d.url=this.url(h[1])+"?action="+h[0])}if(null==d)throw new MO.TError(this,"Unknown service format. (source={1})",b);f.set(b,d)}return d};MO.RUiService=new MO.RUiService;
MO.FUiConfirmDialog=function(b){b=MO.Class.inherits(this,b,MO.FUiDialog,MO.MListenerResult);b._styleText=MO.Class.register(b,new MO.AStyle("_styleText"));b._frameName="system.dialog.ConfirmDialog";b._controlText=null;b._controlConfirmButton=null;b._controlCancelButton=null;b.onBuilded=MO.FUiConfirmDialog_onBuilded;b.onConfirmClick=MO.FUiConfirmDialog_onConfirmClick;b.onCancelClick=MO.FUiConfirmDialog_onCancelClick;b.construct=MO.FUiConfirmDialog_construct;b.setText=MO.FUiConfirmDialog_setText;b.dispose=
MO.FUiConfirmDialog_dispose;return b};MO.FUiConfirmDialog_onBuilded=function(b){this.__base.FUiDialog.onBuilded.call(this,b);this._controlText._hPanel.className=this.styleName("Text");this._controlConfirmButton.addClickListener(this,this.onConfirmClick);this._controlCancelButton.addClickListener(this,this.onCancelClick)};MO.FUiConfirmDialog_onConfirmClick=function(b){b=new MO.SEvent;b.sender=this;b.resultCd=MO.EResult.Success;this.processResultListener(b);b.dispose();this.hide()};
MO.FUiConfirmDialog_onCancelClick=function(b){b=new MO.SEvent;b.sender=this;b.resultCd=MO.EResult.Cancel;this.processResultListener(b);b.dispose();this.hide()};MO.FUiConfirmDialog_construct=function(){this.__base.FUiDialog.construct.call(this)};MO.FUiConfirmDialog_setText=function(b){this._controlText.set(b)};MO.FUiConfirmDialog_dispose=function(){this.__base.FUiDialog.dispose.call(this)};
MO.FUiDescribeFrameConsole=function(b){b=MO.Class.inherits(this,b,MO.FConsole);b._scopeCd=MO.EScope.Global;b._service="cloud.describe.frame";b._defines=null;b.lsnsLoaded=null;b.construct=MO.FUiDescribeFrameConsole_construct;b.load=MO.FUiDescribeFrameConsole_load;b.events=null;b.formId=0;b.createFromName=MO.FUiDescribeFrameConsole_createFromName;b.loadNode=MO.FUiDescribeFrameConsole_loadNode;b.loadService=MO.FUiDescribeFrameConsole_loadService;b.nextFormId=MO.FUiDescribeFrameConsole_nextFormId;b.get=
MO.FUiDescribeFrameConsole_get;b.find=MO.FUiDescribeFrameConsole_find;b.getLov=MO.FUiDescribeFrameConsole_getLov;b.findLov=MO.FUiDescribeFrameConsole_findLov;b.getEvents=MO.FUiDescribeFrameConsole_getEvents;return b};MO.FUiDescribeFrameConsole_construct=function(){this._defines=new MO.TDictionary;this.lsnsLoaded=new MO.TListeners};
MO.FUiDescribeFrameConsole_load=function(b){var d=this._defines,f=d.get(b);if(f)return f;var h=new MO.TXmlDocument,f=h.root();f.set("action","query");f=f.create("Frame");f.set("name",b);for(var f=MO.RUiService.url(this._service),h=MO.Console.find(MO.FXmlConsole).send(f,h).nodes(),q=h.count(),w=0;w<q;w++){var f=h.at(w),z=f.get("name");d.set(z,f)}f=d.get(b);if(!f)throw new MO.TError(this,"Unknown frame. (name={1])",b);return f};
MO.FUiDescribeFrameConsole_createFromName=function(b,d){var f=this.loadService(b,d);this.loadNode(f);return MO.EForm.Lov==d?this.getLov(b):this.get(b)};
MO.FUiDescribeFrameConsole_loadNode=function(b){b=b.root();if(b.hasNode()){b=b.nodes;for(var d=b.count,f=0;f<d;f++){var h=b.get(f),q=h.get("name"),w=h.get("type");if(h.hasNode())for(var h=h.nodes,z=0;z<h.count;z++){var A=h.get(z);if(A.isName("Define")){if(A.hasNode())for(var A=A.nodes,B=0;B<A.count;B++){var C=A.get(B);this._defines.get(w).set(q,C)}}else A.isName("Events")&&this.events.set(q,A)}}}};
MO.FUiDescribeFrameConsole_loadService=function(b,d){d||(d=MO.EForm.Form);var f=new MO.TXmlDocument,h=f.root();h.set("action","loadDefine");h=h.create("WebForm");h.set("name",b);h.set("type",d);h=MO.RUiService.url("logic.webform");f=MO.Console.find(MO.FXmlConsole).send(h,f);h=f.root();return MO.Console.find(MO.FMessageConsole).checkResult(new TMessageArg(h))?f:null};MO.FUiDescribeFrameConsole_nextFormId=function(){return++this.formId};MO.FUiDescribeFrameConsole_get=function(b){return this._defines.get(EForm.Form).get(b)};
MO.FUiDescribeFrameConsole_find=function(b,d){if(EForm.Lov==d)return this.findLov(b);var f=this.get(b);MO.Class.isMode(MO.ERun.Debug)&&(MO.Memory.free(f),f=null,this._defines.get(EForm.Form).set(b,null));f||(f=this.createFromName(b));return f};MO.FUiDescribeFrameConsole_getLov=function(b){return this._defines.get(EForm.Lov).get(b)};MO.FUiDescribeFrameConsole_findLov=function(b){var d=this.getLov(b);d||(d=this.createFromName(b,EForm.Lov));return d};MO.FUiDescribeFrameConsole_getEvents=function(b){return this.events.get(b)};
MO.FUiDesktopConsole=function(b){b=MO.Class.inherits(this,b,MO.FConsole);b._scopeCd=MO.EScope.Local;b._maskVisible=!1;b._statusEnable=!0;b._loadingVisible=!1;b._progressVisible=!1;b._progressBar=null;b._hMaskPanel=null;b._hLoadingPanel=null;b._hLoadingLabel=null;b.construct=MO.FUiDesktopConsole_construct;b.getMaskPanel=MO.FUiDesktopConsole_getMaskPanel;b.getProgressBar=MO.FUiDesktopConsole_getProgressBar;b.getLoadingPanel=MO.FUiDesktopConsole_getLoadingPanel;b.setMaskVisible=MO.FUiDesktopConsole_setMaskVisible;
b.isEnable=MO.FUiDesktopConsole_isEnable;b.enable=MO.FUiDesktopConsole_enable;b.disable=MO.FUiDesktopConsole_disable;b.showLoading=MO.FUiDesktopConsole_showLoading;b.showUploading=MO.FUiDesktopConsole_showUploading;b.showProgress=MO.FUiDesktopConsole_showProgress;b.hide=MO.FUiDesktopConsole_hide;return b};MO.FUiDesktopConsole_construct=function(){this.__base.FConsole.construct.call(this)};
MO.FUiDesktopConsole_getMaskPanel=function(){var b=top.MO.RWindow._hDocument,d=this._hMaskPanel;d||(d=this._hMaskPanel=MO.Window.Builder.createTable(b,"FUiDesktopConsole_MaskPanel"),d.style.zIndex=5E3,b=this._hMaskInnerPanel=MO.Window.Builder.appendTableRowCell(d),b.align="center",b.vAlign="middle");return d};
MO.FUiDesktopConsole_getLoadingPanel=function(){var b=top.MO.RWindow._hDocument,d=this._hLoadingPanel;d||(d=this._hLoadingPanel=MO.Window.Builder.createTable(b),b=MO.Window.Builder.appendTableRowCell(d),(this._hLoadingIcon=MO.Window.Builder.appendIcon(b)).src=MO.RResource.iconPath("control.RWindow_Loading"),b=this._hLoadingLabel=MO.Window.Builder.appendTableRowCell(d),b.align="center",b.style.color="#FFFFFF");return d};
MO.FUiDesktopConsole_getProgressBar=function(){var b=this._progressBar;b||(b=this._progressBar=MO.Class.create(FUiProgressBar),b.build(top.MO.Window._hDocument));return b};MO.FUiDesktopConsole_setMaskVisible=function(b){if(this._maskVisible!=b){var d=top.MO.Window._hDocument.body,f=this.getMaskPanel();if(b){var h=f.style;h.left="0px";h.top="0px";d.appendChild(f)}else d.removeChild(f)}this._maskVisible=b};MO.FUiDesktopConsole_isEnable=function(){return this._statusEnable};
MO.FUiDesktopConsole_enable=function(){this._disableDeep--;0==this._disableDeep&&this.setEnable(!0)};MO.FUiDesktopConsole_disable=function(){0==this._disableDeep&&this.setEnable(!1);this._disableDeep++};MO.FUiDesktopConsole_showLoading=function(){this.setMaskVisible(!0);if(!this._loadingVisible){var b=this.getLoadingPanel();RHtml.textSet(this._hLoadingLabel,"\u6b63\u5728\u52aa\u529b\u52a0\u8f7d\u4e2d\uff0c\u8bf7\u7a0d\u7b49 ...");this._hMaskInnerPanel.appendChild(b);this._loadingVisible=!0}};
MO.FUiDesktopConsole_showUploading=function(){this.setMaskVisible(!0);if(!this._loadingVisible){var b=this.getLoadingPanel();RHtml.textSet(this._hLoadingLabel,"\u6b63\u5728\u52aa\u529b\u4e0a\u4f20\u4e2d\uff0c\u8bf7\u7a0d\u7b49 ...");this._hMaskInnerPanel.appendChild(b);this._loadingVisible=!0}};MO.FUiDesktopConsole_showProgress=function(b){this.setMaskVisible(!0);if(!this._progressVisible){b=this.getMaskPanel();var d=this.getProgressBar();b.appendChild(d._hPanel);this._progressVisible=!0}};
MO.FUiDesktopConsole_hide=function(){if(this._loadingVisible){var b=this.getLoadingPanel();this._hMaskInnerPanel.removeChild(b);this._loadingVisible=!1}this.setMaskVisible(!1)};
MO.FUiEditorConsole=function(b){b=MO.Class.inherits(this,b,MO.FConsole);b._scopeCd=MO.EScope.Local;b._hoverEditor=null;b._focusEditor=null;b._editors=null;b.construct=MO.FUiEditorConsole_construct;b.makeName=MO.FUiEditorConsole_makeName;b.enter=MO.FUiEditorConsole_enter;b.leave=MO.FUiEditorConsole_leave;b.focus=MO.FUiEditorConsole_focus;b.blur=MO.FUiEditorConsole_blur;b.lost=MO.FUiEditorConsole_lost;return b};
MO.FUiEditorConsole_construct=function(){this.__base.FConsole.construct.call(this);this._editors=new MO.TDictionary};MO.FUiEditorConsole_makeName=function(b,d){return d?d+"@"+MO.Class.name(b):MO.Class.name(b)};MO.FUiEditorConsole_enter=function(b,d){var f=MO.Class.name(d),h=this._hoverEditors.get(f);h||(h=MO.Class.create(d),h.psBuild(),this._hoverEditors.set(f,h));this._hoverEditor=h;h.editable=b;h.show();return h};
MO.FUiEditorConsole_leave=function(b){this._hoverEditor!=this._focusEditor&&(b=MO.Lang.Object.nvl(b,this._hoverEditor),this._hoverEditor=null,RLog.debug(this,"Leave {1}",MO.Class.dump(b)))};MO.FUiEditorConsole_focus=function(b,d,f){this.makeName(d,f);var h=this._editors.get(f);h||(h=MO.Class.create(d),h.build(b._hPanel),this._editors.set(f,h));h.reset();MO.Class.isClass(h,MO.FUiDropEditor)&&(h.linkControl(b),this._focusEditor=h);return h};
MO.FUiEditorConsole_blur=function(b){if(this._focusEditor){if(b=MO.Lang.Object.nvl(b,this._focusEditor))b.onEditEnd();this._focusEditor=null}};MO.FUiEditorConsole_lost=function(b){this.leave(b);this.blur(b)};
MO.FUiEnvironmentConsole=function(b){b=MO.Class.inherits(this,b,MO.FConsole);b.scope=MO.EScope.Local;b.environment=null;b.connect=MO.FUiEnvironmentConsole_connect;b.build=MO.FUiEnvironmentConsole_build;b.buildValue=MO.FUiEnvironmentConsole_buildValue;b.load=MO.FUiEnvironmentConsole_load;b.xml=MO.FUiEnvironmentConsole_xml;return b};MO.FUiEnvironmentConsole_connect=function(){};MO.FUiEnvironmentConsole_build=function(b){this.environment||this.connect();this.environment&&b.create("Environment").attributes().append(this.environment.attributes())};
MO.FUiEnvironmentConsole_buildValue=function(){this.environment||this.connect();if(this.environment){var b=RHtml.get("_environment");b&&(b.value=this.environment.xml())}};MO.FUiEnvironmentConsole_load=function(b){this.environment=RXml.makeNode(b)};MO.FUiEnvironmentConsole_xml=function(){this.environment||this.connect();return this.environment?this.environment.xml():null};
MO.FUiErrorDialog=function(b){b=MO.Class.inherits(this,b,MO.FUiDialog,MO.MListenerResult);b._styleText=MO.Class.register(b,new MO.AStyle("_styleText"));b._frameName="system.dialog.ErrorDialog";b._controlText=null;b._controlConfirmButton=null;b._controlCancelButton=null;b.onBuilded=MO.FUiErrorDialog_onBuilded;b.onConfirmClick=MO.FUiErrorDialog_onConfirmClick;b.construct=MO.FUiErrorDialog_construct;b.setCode=MO.FUiErrorDialog_setCode;b.setDescription=MO.FUiErrorDialog_setDescription;b.dispose=MO.FUiErrorDialog_dispose;
return b};MO.FUiErrorDialog_onBuilded=function(b){this.__base.FUiDialog.onBuilded.call(this,b);this._controlConfirm.addClickListener(this,this.onConfirmClick)};MO.FUiErrorDialog_onConfirmClick=function(b){b=new MO.SEvent;b.sender=this;b.resultCd=MO.EResult.Success;this.processResultListener(b);b.dispose();this.hide()};MO.FUiErrorDialog_construct=function(){this.__base.FUiDialog.construct.call(this)};MO.FUiErrorDialog_setCode=function(b){this._controlCode.set(b)};MO.FUiErrorDialog_setDescription=function(b){this._controlDescription.set(b)};
MO.FUiErrorDialog_dispose=function(){this.__base.FUiDialog.dispose.call(this)};
MO.FUiFocusConsole=function(b){b=MO.Class.inherits(this,b,MO.FConsole);b.scope=MO.EScope.Page;b._blurAble=!0;b._focusAble=!0;b._focusClasses=null;b._storeControl=null;b._hoverContainer=null;b._hoverControl=null;b._focusControl=null;b._blurControl=null;b._activeControl=null;b.lsnsFocus=null;b.lsnsBlur=null;b.lsnsFocusClass=null;b.onMouseDown=MO.FUiFocusConsole_onMouseDown;b.onMouseWheel=MO.FUiFocusConsole_onMouseWheel;b.construct=MO.FUiFocusConsole_construct;b.enter=MO.FUiFocusConsole_enter;b.leave=
MO.FUiFocusConsole_leave;b.isFocus=MO.FUiFocusConsole_isFocus;b.focus=MO.FUiFocusConsole_focus;b.blur=MO.FUiFocusConsole_blur;b.findClass=MO.FUiFocusConsole_findClass;b.focusClass=MO.FUiFocusConsole_focusClass;b.focusHtml=MO.FUiFocusConsole_focusHtml;b.lockBlur=MO.FUiFocusConsole_lockBlur;b.unlockBlur=MO.FUiFocusConsole_unlockBlur;b.storeFocus=MO.FUiFocusConsole_storeFocus;b.restoreFocus=MO.FUiFocusConsole_restoreFocus;b.dispose=MO.FUiFocusConsole_dispose;return b};
MO.FUiFocusConsole_onMouseDown=function(b){this.focusHtml(b.hSource)};MO.FUiFocusConsole_onMouseWheel=function(b,d){};MO.FUiFocusConsole_construct=function(){this.__base.FConsole.construct.call(this);this._focusClasses={};this.lsnsFocus=new MO.TListeners;this.lsnsBlur=new MO.TListeners;this.lsnsFocusClass=new MO.TListeners;MO.Logger.info(this,"Add listener for window mouse down and wheel.");MO.Window.lsnsMouseDown.register(this,this.onMouseDown);MO.Window.lsnsMouseWheel.register(this,this.onMouseWheel)};
MO.FUiFocusConsole_enter=function(b){MO.Class.isClass(b,MO.MUiContainer)?this._hoverContainer=b:this._hoverControl=b};MO.FUiFocusConsole_leave=function(b){this._hoverContainer==b&&(this._hoverContainer=null);this._hoverControl==b&&(this._hoverControl=null)};MO.FUiFocusConsole_isFocus=function(b){return this._focusControl==b};
MO.FUiFocusConsole_focus=function(b,d){if(MO.Class.isClass(b,MO.MUiFocus)){var f=this._focusControl;f!=b&&(this._blurControl!=f&&this._blurAble&&f&&f.testBlur(b)&&(this._blurControl=f,f.doBlur(d),this.lsnsBlur.process(f)),this._focusAble&&(b.doFocus(d),this._focusControl=this._activeControl=b,this.lsnsFocus.process(b)))}};
MO.FUiFocusConsole_blur=function(b,d){var f=this._focusControl,h=this._blurControl;f&&b&&!f.testBlur(b)||(h!=b&&MO.Class.isClass(b,MO.MUiFocus)&&(this._blurControl=b,b.doBlur(d)),f&&(f.doBlur(d),this._focusControl=null))};MO.FUiFocusConsole_findClass=function(b){var d=MO.Class.name(b);if(this._focusClasses[d])return this._focusClasses[d];d=this._activeControl;MO.Class.isClass(d,MO.FEditor)&&(d=d.source);if(d)return d.topControl(b)};
MO.FUiFocusConsole_focusClass=function(b,d){var f=MO.Class.name(b);this._focusClasses[f]!=d&&(this._focusClasses[f]=d,this.lsnsFocusClass.process(d,b))};MO.FUiFocusConsole_focusHtml=function(b){var d=MO.Window.Html.searchLinker(b,MO.FDuiControl);d?this._focusControl!=d&&this.blur(d,b):this.blur(null,b)};MO.FUiFocusConsole_lockBlur=function(){this._blurAble=!1};MO.FUiFocusConsole_unlockBlur=function(){this._blurAble=!0};MO.FUiFocusConsole_storeFocus=function(){this._storeControl=this._focusControl};
MO.FUiFocusConsole_restoreFocus=function(){this._storeControl&&(this._storeControl.focus(),this._storeControl=null)};MO.FUiFocusConsole_dispose=function(){this.__base.FConsole.dispose.call(this);this._focusClasses=null};
MO.FUiFrameConsole=function(b){b=MO.Class.inherits(this,b,MO.FConsole);b._scopeCd=MO.EScope.Local;b._frames=null;b.construct=MO.FUiFrameConsole_construct;b.create=MO.FUiFrameConsole_create;b.find=MO.FUiFrameConsole_find;b.findByClass=MO.FUiFrameConsole_findByClass;b.get=MO.FUiFrameConsole_get;return b};MO.FUiFrameConsole_construct=function(){this._frames=new MO.TMap};
MO.FUiFrameConsole_create=function(b,d){var f=MO.Console.find(MO.FUiDescribeFrameConsole).load(d);return MO.RUiControl.build(null,f,null,b._hPanel)};MO.FUiFrameConsole_find=function(b){return this._frames.get(b)};MO.FUiFrameConsole_findByClass=function(b,d){var f=MO.Class.name(d),h=this._frames,q=h.get(f);q||(q=MO.Class.create(d),q.buildDefine(b._hPanel),h.set(f,q));return q};MO.FUiFrameConsole_get=function(b,d,f){var h=this._frames,q=h.get(d);q||(q=this.create(b,d),f&&q.setPanel(f),h.set(d,q));return q};
MO.FUiFrameConsole_hiddenAll=function(){for(var b=this._frames,d=b.count,f=0;f<d;f++)b.value(f).setVisible(!1)};
MO.FUiFrameConsole_onProcessLoaded=function(b){var d=b.document.root(),f=b.argument;if(!b.messageChecked){var h=new MO.TMessageArg;h.argument=f;h.form=f.form;h.config=d;h.invokeCaller=new MO.TInvoke(this,this.onLoaded);h.invokeParam=b;h.event=b;if(!MO.Console.find(MO.FMessageConsole).checkResult(h))return}f=b.argument;if(b=d.find("Form"))b=MO.RDataset.make(b),f.resultDataset=b,f.resultRow=b.rows.get(0);f.invoke()};
MO.FUiFrameConsole_process=function(b){var d=new MO.TXmlDocument,f=d.root();f.set("action","process");b.checked&&f.set("checked",b.checked);f.push(b.toNode());f=new MO.TEvent(this,EXmlEvent.Send,this.onProcessLoaded);f.url=MO.RService.url(MO.Lang.String.nvl(b.url,"logic.webform"));f.action=MO.EDataAction.Process;f.argument=b;f.document=d;MO.Console.find(MO.FXmlConsole).process(f)};MO.FUiFrameConsole_loadEvents=function(b){};
MO.FUiFrameConsole_processEvent=function(b){var d=this.events;if(!d.isEmpty()){var f=b.source;if(MO.Class.isClass(f,FControl)){var h=f.topControl();h&&(h=MO.Lang.String.nvl(b.name,b.handle)+"@"+f.name+"@"+h.name,d=d.get(h),f=b.caller?b.caller:f,d&&d.code&&(d.event||(d.event=new Function("o","e",d.code)),d.event.call(f,f,b)))}}};MO.FUiFrameConsole_free=function(b){b.setVisible(!1);this._freeFrames.push(b)};
MO.FUiFrameConsole_dispose=function(){MO.Memory.free(this._frames);MO.Memory.free(this._formIds);MO.Memory.free(this._framesLoaded);this._framesLoaded=this._formIds=this._frames=null};
MO.FUiFrameEventConsole=function(b){b=MO.Class.inherits(this,b,MO.FConsole);b._scopeCd=MO.EScope.Local;b._thread=null;b._interval=20;b._allow=!0;b._allows=new MO.TAttributes;b._events=new MO.TObjects;b._listeners=new MO.TAttributes;b.onProcess=MO.FUiFrameEventConsole_onProcess;b.construct=MO.FUiFrameEventConsole_construct;b.register=MO.FUiFrameEventConsole_register;b.push=MO.FUiFrameEventConsole_push;b.clear=MO.FUiFrameEventConsole_clear;return b};
MO.FUiFrameEventConsole_onProcess=function(){var b=this._events,d=b.count();if(0<d){for(;;){for(var f=!1,h=0;h<d;h++){var q=b.get(h);if(q){f=!0;q.process();var w=this._listeners.get(MO.Method.name(q));w&&w.process(q);b.set(h,null)}}if(!f)break}b.clear()}};MO.FUiFrameEventConsole_construct=function(){this.__base.FConsole.construct.call(this);var b=this._thread=MO.Class.create(MO.FThread);b.setInterval(this._interval);b.addProcessListener(this,this.onProcess);MO.Console.find(MO.FThreadConsole).start(b)};
MO.FUiFrameEventConsole_register=function(b,d){this._events.push(new MO.TEvent(b,null,d))};MO.FUiFrameEventConsole_push=function(b){var d=MO.Class.name(b);if(this._allow){var f=!0;this._allows.contains(d)&&(f=MO.Lang.Boolean.isTrue(this._allows.get(d)));if(f){for(var f=this._events,h=f.count(),q=0;q<h;q++)f.get(d)==b&&f.set(d,null);f.push(b)}}};MO.FUiFrameEventConsole_clear=function(){this._events.clear()};MO.FUiFrameEventConsole_add=function(b,d){this._events.push(new MO.TEvent(b,null,d))};
MO.FUiFrameEventConsole_allowEvent=function(b){this._allows.set(MO.Method.name(b),EBool.True)};MO.FUiFrameEventConsole_skipEvent=function(b){this._allows.set(MO.Method.name(b),EBool.False)};MO.FUiFrameEventConsole_allowAll=function(){this._allow=!0};MO.FUiFrameEventConsole_skipAll=function(){this._allow=!1};MO.FUiFrameEventConsole_onlyCall=function(b,d){this._allow=!1;d.call(b);this._allow=!0};
MO.FUiInfoDialog=function(b){b=MO.Class.inherits(this,b,MO.FUiDialog,MO.MListenerResult);b._styleText=MO.Class.register(b,new MO.AStyle("_styleText"));b._frameName="system.dialog.InfoDialog";b._controlText=null;b._controlConfirmButton=null;b._controlCancelButton=null;b.onBuilded=MO.FUiInfoDialog_onBuilded;b.onConfirmClick=MO.FUiInfoDialog_onConfirmClick;b.construct=MO.FUiInfoDialog_construct;b.setText=MO.FUiInfoDialog_setText;b.dispose=MO.FUiInfoDialog_dispose;return b};
MO.FUiInfoDialog_onBuilded=function(b){this.__base.FUiDialog.onBuilded.call(this,b);this._controlText._hPanel.className=this.styleName("Text");this._controlConfirmButton.addClickListener(this,this.onConfirmClick)};MO.FUiInfoDialog_onConfirmClick=function(b){b=new MO.SEvent;b.sender=this;b.resultCd=MO.EResult.Success;this.processResultListener(b);b.dispose();this.hide()};MO.FUiInfoDialog_construct=function(){this.__base.FUiDialog.construct.call(this)};MO.FUiInfoDialog_setText=function(b){this._controlText.set(b)};
MO.FUiInfoDialog_dispose=function(){this.__base.FUiDialog.dispose.call(this)};
MO.FUiKeyConsole=function(b){b=MO.Class.inherits(this,b,MO.FConsole);b._scopeCd=EScope.Local;b._enable=!0;b._enableRegister=!0;b._listeners={};b._disableKeys={};b.onKeyDown=MO.FUiKeyConsole_onKeyDown;b.construct=MO.FUiKeyConsole_construct;b.enable=MO.FUiKeyConsole_enable;b.disable=MO.FUiKeyConsole_disable;b.enableRegister=MO.FUiKeyConsole_enableRegister;b.disableRegister=MO.FUiKeyConsole_disableRegister;b.register=MO.FUiKeyConsole_register;return b};
MO.FUiKeyConsole_onKeyDown=function(b){var d=MO.REnum.tryDecode(MO.EKeyCode,b.keyCode);if(d&&this._enable){var f=this._listeners[d];f&&(f.process(this,b),b.keyCode=null,b.returnValue=!1)}d&&this._disableKeys[d]&&(b.keyCode=null,b.returnValue=!1)};MO.FUiKeyConsole_construct=function(){this.__base.FConsole.construct.call(this);MO.Window.lsnsKeyDown.register(this,this.onKeyDown)};MO.FUiKeyConsole_enable=function(){this._enable=!0};MO.FUiKeyConsole_disable=function(){this._enable=!1};
MO.FUiKeyConsole_enableRegister=function(){this._enableRegister=!0};MO.FUiKeyConsole_disableRegister=function(){this._enableRegister=!1};MO.FUiKeyConsole_register=function(b,d,f){if(this._enableRegister){MO.Lang.Integer.isInteger(b)&&(b=MO.REnum.decode(EKeyCode,b));var h=this._listeners,q=h[b];q||(q=h[b]=new MO.TListeners);q.clear();q.register(d,f)}};
MO.FUiMessageConsole=function(b){b=MO.Class.inherits(this,b,MO.FConsole,MO.MUiStyle);b._scopeCd=MO.EScope.Global;b._result=[];b._attributes=[];b._messageBox=null;b._messageWindow=null;b.showInfo=MO.FUiMessageConsole_showInfo;b.showConfirm=MO.FUiMessageConsole_showConfirm;b.showError=MO.FUiMessageConsole_showError;b.popup=MO.FUiMessageConsole_popup;b.close=MO.FUiMessageConsole_close;b.parse=MO.FUiMessageConsole_parse;b.check=MO.FUiMessageConsole_check;return b};
MO.FUiMessageConsole_showInfo=function(b){var d=MO.Console.find(MO.FUiWindowConsole).find(MO.FUiInfoDialog);d.clearResultListeners();d.setText(b);d.showPosition(MO.EUiPosition.Center);return d};MO.FUiMessageConsole_showConfirm=function(b){var d=MO.Console.find(MO.FUiWindowConsole).find(MO.FUiConfirmDialog);d.clearResultListeners();d.setText(b);d.showPosition(MO.EUiPosition.Center);return d};
MO.FUiMessageConsole_showError=function(b,d,f){b=MO.Console.find(MO.FUiWindowConsole).find(MO.FUiErrorDialog);b.clearResultListeners();b.setCode(d);b.setDescription(f);b.showPosition(MO.EUiPosition.Center);return b};MO.FUiMessageConsole_popup=function(b){var d=this._messageWindow;d||(d=this._messageWindow=RControl.create(FUiMessageWindow));d.loadMessages(b);d.show()};MO.FUiMessageConsole_close=function(){RWindow.setEnable(!0)};
MO.FUiMessageConsole_parse=function(b){var d=null;if((b=b.find("Messages"))&&b.nodes&&b.nodes.count)for(var d=new MO.TMessages,f=0;f<b.nodes.count;f++){b.node(f);var h=new TMessage;h.loadConfig(b.node(f));d.push(h)}return d};
MO.FUiMessageConsole_check=function(b){var d=b.messages=this.parse(b.config);return d?((d=d.message(MO.EMessage.Fatal))&&"session.timeout"==d.attrType?(b=RString.splitTwo(d.redirect,"@"),b=RContext.context(b[1]+"?do="+b[0]),fmMain.action=b,fmMain.target="_self",fmMain.submit()):this.popupMessage(b),!1):!0};
MO.FUiMessageDialog=function(b){b=MO.Class.inherits(this,b,MO.FUiWindow);b._styleMsgPanel=MO.Class.register(b,new MO.AStyle("_styleMsgPanel"));b._styleButtonPanel=MO.Class.register(b,new MO.AStyle("_styleButtonPanel"));b._styleItmeForm=MO.Class.register(b,new MO.AStyle("_styleItmeForm"));b._styleItemTitle=MO.Class.register(b,new MO.AStyle("_styleItemTitle"));b._styleItemBodyForm=MO.Class.register(b,new MO.AStyle("_styleItemBodyForm"));b._styleRowItem=MO.Class.register(b,new MO.AStyle("_styleRowItem"));
b._styleDescForm=MO.Class.register(b,new MO.AStyle("_styleDescForm"));b._styleDescTitle=MO.Class.register(b,new MO.AStyle("_styleDescTitle"));b._styleDescBody=MO.Class.register(b,new MO.AStyle("_styleDescBody"));b._type=null;b._isDialog=!1;b._titleBlur=!1;b._messageArg=null;b._hMessagePanel=null;b._hMessages=null;b._hDescription=null;b._hButtonPanel=null;b._hBlank=null;b.onBuild=MO.FUiMessageDialog_onBuild;b.onItemOver=MO.Class.register(b,new MO.AEventMouseOver("onItemOver"),MO.FUiMessageDialog_onItemOver);
b.onItemClick=MO.Class.register(b,new MO.AEventClick("onItemClick"),MO.FUiMessageDialog_onItemClick);b.onDescClick=MO.Class.register(b,new MO.AEventClick("onDescClick"),MO.FUiMessageDialog_onDescClick);b.onBuildMessages=MO.FUiMessageDialog_onBuildMessages;b.onBuildButtons=MO.FUiMessageDialog_onBuildButtons;b.onOk=MO.FUiMessageDialog_onOk;b.onCancel=MO.FUiMessageDialog_onCancel;b.onClose=MO.FUiMessageDialog_onClose;b.loadMessages=MO.FUiMessageDialog_loadMessages;b.show=MO.FUiMessageDialog_show;b.hide=
MO.FUiMessageDialog_hide;b.dispose=MO.FUiMessageDialog_dispose;return b};
MO.FUiMessageDialog_onBuild=function(b){this.__base.FUiWindow.oeBuild.call(this,e);this.setIcon("Icon");b=MO.RBuilder.appendTable(this.hBodyPanel,0,0,0);b.style.vAlign="top";b.width="100%";b.height="100%";var d=this.hTitlePanel=b.insertRow().insertCell();d.style.height="100%";d.style.vAlign="top";(this.hMsgPanel=b.insertRow().insertCell()).style.height="100%";this.onBuildMessages();b=this._hButtonPanel=b.insertRow().insertCell();b.style.align="right";this.onBuildButtons();b.height=20;MO.Console.find(FKeyConsole).register(MO.EKey.Esc,
new MO.TListener(this,this.onClose));return r};MO.FUiMessageDialog_onItemOver=function(b){};MO.FUiMessageDialog_onItemClick=function(b){b=this.hItemBodyForm;for(var d=0;d<b.rows.count;d++);};MO.FUiMessageDialog_onDescClick=function(b){};
MO.FUiMessageDialog_onBuildMessages=function(){if(!this._type){var b=this.hItmeForm=MO.RBuilder.appendTable(this.hTitlePanel);b.style.height="100%";b.style.width="100%";b.style.vAlign="top";var d=this.hItemTitle=b.insertRow().insertCell();d.height=25;d=MO.RBuilder.appendTable(d);d.height="100%";d.width="100%";d.style.backgroundColor="#F5F5F5";var d=d.insertRow(),f=d.insertCell();f.width="20";f=MO.RBuilder.appendIcon(f,null,null,16,14);f.style.paddingLeft=20;f.src=this.styleIconPath("TitleIcon");d.insertCell().innerText=
" "+MO.Context.get("FUiMessageDialog:MessageContext");b=this.hItemBody=b.insertRow().insertCell();b.height=100;this.hItemBody.style.borderBottom="2 solid #F5F5F5";b.style.padding="5";b.vAlign="top";b=MO.RBuilder.appendDiv(b);b.style.height="100px";b.style.overflow="auto";b=this.hItemBodyForm=MO.RBuilder.appendTable(b);b.style.border="2px solid #FFFFFF";b.width="100%";b.style.vAlign="top";b=this.hDescForm=MO.RBuilder.appendTable(this.hMsgPanel);b.style.tableLayout="fixed";b.style.border="2px solid #EEEDED";
b.style.borderTopWidth=0}this.hItmeForm.style.display="none";this.hDescForm.style.display="none";this.hMsgPanel.style.height="100%";EMessage.Fatal==this._type||EMessage.Error==this._type?(this.hItmeForm.style.display="block",this.hDescForm.style.display="block"):this.hItmeForm.style.display="block"};
MO.FUiMessageDialog_onBuildButtons=function(b){if(!this._type){var d=MO.Window.Builder.appendTable(this._hButtonPanel,null,0,0,2).insertRow();(this._hBlank=d.insertCell()).width="72%";b=this.btnOk=MO.Class.create(MO.FButton);b.icon="tool.ok";b.label=RContext.get("FToolButton:ok");b.width="100%";b.lsnsClick.register(this,this.onOk);var f=d.insertCell();f.style.align="right";f.width="15%";b.psBuild(f);b=this.btnCancel=MO.Class.create(MO.FButton);b.icon="tool.cancel";b.label=MO.RContext.get("FToolButton:cancel");
b.width="100%";b.lsnsClick.register(this,this.onCancel);d=d.insertCell();d.width="15%";b.psBuild(d)}this.btnOk.hPanel.style.display="none";this.btnCancel.hPanel.style.display="none";EMessage.Warn==this._type?(this.btnOk.hPanel.style.display="block",this.btnCancel.hPanel.style.display="block",this._hBlank.width="72%"):(this.btnOk.hPanel.style.display="block",this._hBlank.width="87%")};
MO.FUiMessageDialog_onOk=function(){var b=this._messageArg,d=b.argument,f=this.msgs.get(0)._type;EMessage.Warn==f&&d&&(d.checked=EBoolean.True,"process"==d.actionType?RConsole.find(FFormConsole).process(d):"update"==d.actionType&&RConsole.find(FDatasetConsole).update(d));f==EMessage.Info&&b.invokeCaller&&(b.invokeParam.messageChecked=!0,b.invokeCaller.invoke(b.invokeParam));this.hide()};MO.FUiMessageDialog_onCancel=function(){this.hide()};MO.FUiMessageDialog_onClose=function(){this.hide()};
MO.FUiMessageDialog_loadMessages=function(b){this._messageArg=b;var d=b.messages;this._type=d._type();this.onBuildButtons();this.onBuildMessages();RHtml.clear(this.hItemBodyForm);RHtml.clear(this.hDescDiv);b=!0;for(var d=this.msgs=d.items,f=EMessage.Info,h=0;h<d.count;h++){var q=d.get(h),w=q.message,z=q._type,q=this.hItemBodyForm.insertRow();q.height=12;var A=q.insertCell();A.width=20;A=MO.Window.Builder.appendIcon(A,null,h,16,16);EMessage.Error==z?(this.setIcon("TitleError"),A.src=this.styleIconPath("ItemError"),
f=EMessage.Error):EMessage.Warn==z?(this.setIcon("TitleWarn"),A.src=this.styleIconPath("ItemWarn"),f=EMessage.Warn):EMessage.Info==z?(this.setIcon("TitleInfo"),f=EMessage.Info,A.src=this.styleIconPath("ItemInfo")):EMessage.Fatal==z&&(f=EMessage.Fatal,A.src=this.styleIconPath("ItemError"));z=q.insertCell();z.style.textOverflow="ellipsis";z.style.overflow="hidden";z.innerText=" "+w;z.style.cursor="hand";this.attachEvent("onItemClick",q);this.attachEvent("onItemOver",q);b&&(b=!1)}EMessage.Error==f?this.setCaption(" "+
RContext.get("FUiMessageDialog:Error")):EMessage.Warn==f?this.setCaption(" "+RContext.get("FUiMessageDialog:Warn")):EMessage.Info==f?this.setCaption(" "+RContext.get("FUiMessageDialog:Info")):EMessage.Fatal==f&&this.setCaption(" "+RContext.get("FUiMessageDialog:Fatal"))};
MO.FUiMessageDialog_show=function(){this.__base.FUiWindow.show.call(this);this.panel().style.zIndex=RLayer.next(ELayer.Message);RWindow.moveCenter(this.panel());this.psMode(EMode.Update);RConsole.find(FFocusConsole).blur();RWindow.setEnable(!1,!0);this.focus()};MO.FUiMessageDialog_hide=function(){this.__base.FUiWindow.hide.call(this);var b=this._messageArg.argument.form;RClass.isClass(b,MDataset)&&b.psProgress(!1);RWindow.setEnable(!0)};
MO.FUiMessageDialog_dispose=function(){this.__base.FUiWindow.dispose.call(this);this._hButtonPanel=this.hItemBodyForm=this.hDescTitle=this.hDescDiv=this.hDescBody=this.hItmeForm=null};
MO.FUiPopupConsole=function(b){b=MO.Class.inherits(this,b,MO.FConsole);b._scopeCd=MO.EScope.Local;b._activeControl=null;b.onMouseDown=MO.FUiPopupConsole_onMouseDown;b.onMouseWheel=MO.FUiPopupConsole_onMouseWheel;b.construct=MO.FUiPopupConsole_construct;b.show=MO.FUiPopupConsole_show;b.hide=MO.FUiPopupConsole_hide;b.dispose=MO.FUiPopupConsole_dispose;return b};MO.FUiPopupConsole_onMouseDown=function(b){this.hide()};MO.FUiPopupConsole_onMouseWheel=function(b,d){this.hide()};
MO.FUiPopupConsole_construct=function(){this.__base.FConsole.construct.call(this);MO.Logger.info(this,"Add listener for control popup.");MO.Window.lsnsMouseDown.register(this,this.onMouseDown);MO.Window.lsnsMouseWheel.register(this,this.onMouseWheel)};MO.FUiPopupConsole_show=function(b){this.hide();MO.Class.isClass(b,MO.MUiPopup)&&(this._activeControl=b)};MO.FUiPopupConsole_hide=function(b){this._activeControl&&this._activeControl.opener().drop(!1);this._activeControl=null};
MO.FUiPopupConsole_dispose=function(){this._activeControl=null;this.__base.FConsole.dispose.call(this)};MO.FUiResultConsole=function(b){b=MO.Class.inherits(this,b,MO.FConsole);b.scope=MO.EScope.Page;b.executeCommand=MO.FUiResultConsole_executeCommand;b.checkService=MO.FUiResultConsole_checkService;b.checkEvent=MO.FUiResultConsole_checkEvent;return b};
MO.FUiResultConsole_executeCommand=function(b){var d=b.get("name");if(EResultCommand.TreeReload==d)(d=MO.RGlobal.get("catalog.tree"))&&d.reload();else if(EResultCommand.TreeNodeRefresh==d){if(d=MO.RGlobal.get("catalog.tree"))if(b=b.get("uuid")){var f=d.findByUuid(b);if(f)d.reloadNode(f);else return alert("Can't find tree node. (uuid="+b+")")}else d.reloadNode()}else EResultCommand.TreeParentRefresh==d?(d=MO.RGlobal.get("catalog.tree"))&&(f=d.focusNode)&&d.reloadNode(f.parentNode):EResultCommand.PageRedirect==
d&&(d=b.get("action"),b=top.MO.RContext.context(b.get("page")),d&&(b+="?do="+d),fmMain.action=b,fmMain.target="",fmMain.submit())};MO.FUiResultConsole_checkService=function(b){if(b){if(!MO.Console.find(MO.FMessageConsole).checkResult(new MO.TMessageArg(b)))return!1;if((b=b.find("Commands"))&&b.nodes&&b.nodes.count)for(var d=0;d<b.nodes.count;d++){var f=b.node(d);f.isName("Command")&&this.executeCommand(f)}MO.Console.find(MO.FFocusConsole).restoreFocus()}return!0};
MO.FUiResultConsole_checkEvent=function(b){if(b=b.root){if("success"==b.get("result_cd"))return!0;b.get("message_cd");var d=b.find("Messages");if(d)for(var f=d.nodeCount(),h=0;h<f;h++)if(b=d.node(h),b.isName("Message"))return d=b.get("code"),f=b.get("message"),b=b.get("description"),MO.Console.find(MO.FUiMessageConsole).showError(d,f,b),!1}return!0};
MO.FUiWindowConsole=function(b){b=MO.Class.inherits(this,b,MO.FConsole);b._scopeCd=MO.EScope.Local;b._activeWindow=null;b._windows=null;b.construct=MO.FUiWindowConsole_construct;b.create=MO.FUiWindowConsole_create;b.find=MO.FUiWindowConsole_find;return this};MO.FUiWindowConsole_construct=function(){this.__base.FConsole.construct.call(this);this._windows=new MO.TDictionary};MO.FUiWindowConsole_create=function(b){b=MO.Class.create(b);b.buildDefine(MO.Window._hDocument);return b};
MO.FUiWindowConsole_find=function(b){var d=MO.Class.name(b),f=this._windows.get(d);if(f)return f;b=this.create(b);this._windows.set(d,b);return b};MO.FUiWindowConsole_loadDefine=function(b){if(null==b)return null;var d=this.defines.find(b);if(null==d){var f=new MO.TXmlDocument,h=f.root();h.create("Action").value="window.config.load";h.create("Window","name",b);f=(new MO.TXmlCnn).syncSend("window.xml",f);f.root()}return d?d:MO.Logger.fatal(this,"loadDefine","Not find window define: "+sWinName)};
MO.FUiWindowConsole_dump=function(){var b=this.className,b=b+("\n\nDefine:\n"+this.m_oDefinePool.dump());return b+="\n\nWindow:\n"+this.windowList.dump()};MO.FUiWindowConsole_clear=function(){this.activeControl=this.activeForm=this._activeWindow=this.focusWinCtl=null;this.m_oDefinePool=new FList;for(var b=this.windowList.size()-1;0<=b;b--)this.windowList.value(b).release();this.windowList=new FList;IEngine.process(this,this.EVENT_CLOSEALL)};
MO.FUiWindowConsole_hideAll=function(b,d){for(var f=this.windowList.size()-1;0<=f;f--){var h=this.windowList.value(f);h!=b&&h.hide(d)}};MO.FUiWindowConsole_setMaxWindow=function(b){this.maxFlag=!0;this.hideAll(b)};MO.FUiWindowConsole_restore=function(){var b=this.windowList.size();this.hideAll(null,!0);for(var d=0;d<b;d++)this.windowList.value(d).maxFlag&&this.windowList.value(d).restore();this.maxFlag=!1};MO.FUiWindowConsole_initialize=function(b){this.clientWindow=b};
MO.FUiWindowConsole_hasWindow=function(){return!this.windowList.isEmpty()};MO.FUiWindowConsole_focus=function(b){this.focusWinCtl=b;this.maxFlag&&(b.show(),this.hideAll(b,!0),b.max())};
MO.FUiWindowConsole_saveDefine=function(b,d){d&&(this.clientWindow.document.body.disabled=!0);if(!b)return LoggerUtil.fatal(this,"saveDefine","Window node is null.");if(!b.attribute("full_name"))return ILogger.fatal(this,"saveDefine","Window full name is null.");var f=new FXMLDocument("Config");f.rootNode.createNode("Action").setAttribute("name","define.save");f.rootNode.push(b);f=new FXMLConnect(SystemManager.serviceURL("window"),f);f.clientWindow=d;f.onload=this.onSaveDefineAfter;f.send()};
MO.FUiWindowConsole_onEventMousedown=function(b){};MO.FUiWindowConsole_onSaveDefineAfter=function(){ILogger.info(this,"saveDefine","Save Ok.");this.clientWindow&&(this.clientWindow.document.body.disabled=!1)};MO.FUiWindowConsole_releaseWindowName=function(b){b=this.windowList.removeName(b);IEngine.process(this,this.EVENT_CLOSE,b)};MO.FUiWindowConsole_releaseWindow=function(b){this.windowList.removeValue(b);IEngine.process(this,this.EVENT_CLOSE,b)};
MO.FUiWindowConsole_doFrameAction=function(b){if(!this.activeForm)return ILogger.fatal(this,"doFrameAction","Not active form!");this.activeForm.doAction(b)};MO.FUiWindowConsole_doProperties=function(){TrackManager.push(this,"Do properties.");if(WindowManager.focusWinCtl){var b=[];b.WindowManager=WindowManager;window.showModalDialog(SystemManager.actionURL("window"),b,"dialogWidth:500px;dialogHeight:360px;resizable:no;scroll:no;edge:sunken")}};
MO.FUiWindowConsole_onEventRelease=function(b){if(b){for(var d=null,f=[],h=this.windowList.size(),q=0;q<h;q++)d=this.windowList.value(q),d.clientWindow==b&&(d==MoveManager.focusBorder&&MoveManager.focus(null),f.push(d));for(q=0;q<f.length;q++)this.windowList.removeValue(f[q])}else this.windowList.clear(),MoveManager.focus(null)};
MO.FDuiWorkspaceApplication=function(b){b=MO.Class.inherits(this,b,MO.FApplication);b._workspaces=MO.Class.register(b,new MO.AGetter("_workspaces"));b._activeWorkspace=MO.Class.register(b,new MO.AGetter("_activeWorkspace"));b.onProcess=MO.FDuiWorkspaceApplication_onProcess;b.selectWorkspace=MO.FDuiWorkspaceApplication_selectWorkspace;b.processResize=MO.FDuiWorkspaceApplication_processResize;b.processEvent=MO.FDuiWorkspaceApplication_processEvent;return b};
MO.FDuiWorkspaceApplication_onProcess=function(){var b=this._activeWorkspace;b&&b.psFrame()};MO.FDuiWorkspaceApplication_selectWorkspace=function(b){return this._activeWorkspace=MO.Class.create(b)};MO.FDuiWorkspaceApplication_processResize=function(){};MO.FDuiWorkspaceApplication_processEvent=function(b){};
MO.FDuiWorkspaceConsole=function(b){b=MO.Class.inherits(this,b,MO.FConsole);b._scopeCd=MO.EScope.Local;b._activeWorkspace=null;b._workspaces=null;b._thread=null;b._interval=100;b.onResize=MO.FDuiWorkspaceConsole_onResize;b.onProcess=MO.FDuiWorkspaceConsole_onProcess;b.construct=MO.FDuiWorkspaceConsole_construct;b.active=MO.FDuiWorkspaceConsole_active;b.resize=MO.FDuiWorkspaceConsole_resize;b.dispose=MO.FDuiWorkspaceConsole_dispose;return b};
MO.FDuiWorkspaceConsole_onResize=function(b){(b=this._activeWorkspace)&&b.psResize()};MO.FDuiWorkspaceConsole_onProcess=function(b){var d=this._activeWorkspace;d&&d.psFrame(b)};MO.FDuiWorkspaceConsole_construct=function(){this.__base.FConsole.construct.call(this);this._workspaces=new MO.TDictionary;var b=this._thread=MO.Class.create(MO.FThread);b.setInterval(this._interval);b.addProcessListener(this,this.onProcess);MO.Console.find(MO.FThreadConsole).start(b);MO.RWindow.lsnsResize.register(this,this.onResize)};
MO.FDuiWorkspaceConsole_active=function(b){this._activeWorkspace=b};MO.FDuiWorkspaceConsole_resize=function(){this.onResize()};MO.FDuiWorkspaceConsole_dispose=function(){this.__base.FConsole.dispose.call(this)};MO.EUiSplitStyle=new function(){this.Normal="N";this.BulgeLine="B";this.HollowLine="H";return this};
with(MO)MO.MUiShadow=function(b){b=RClass.inherits(this,b);b._hShadow=null;b.show=MUiShadow_show;b.hide=MUiShadow_hide;b.setVisible=MUiShadow_setVisible;return b},MO.MUiShadow_show=function(b){this._hShadow||(this._hShadow=RBuilder.createDiv(this._hPanel,"RWindow_Shadow"));this._hShadow.style.zIndex=RUiLayer.next();if(0==b)this.hide();else{if(b=this.panel(EPanel.Shadow)){var d=this._hShadow.style;d.pixelLeft=b.offsetLeft+2;d.pixelTop=b.offsetTop+2;d.pixelWidth=b.offsetWidth;d.pixelHeight=b.offsetHeight;
d.display="block"}if(b=this.panel(EPanel.Panel))b.style.zIndex=RUiLayer.next()}},MO.MUiShadow_hide=function(){this._hShadow&&(this._hShadow.style.display="none")},MO.MUiShadow_setVisible=function(b){if(b){this._hShadow||(this._hShadow=RBuilder.createDiv(this._hPanel,"RWindow_Shadow"));this._hShadow.style.zIndex=RUiLayer.next();if(b=this.panel(EPanel.Shadow)){b=RHtml.rect(b);var d=this._hShadow.style;d.pixelLeft=b.left+2;d.pixelTop=b.top+2;d.pixelWidth=b.width();d.pixelHeight=b.height();d.display=
"block"}if(b=this.panel(EPanel.Panel))b.style.zIndex=RUiLayer.next()}else this._hShadow&&(this._hShadow.style.display="none")};
with(MO)MO.SUiColorBar=function(){this._draging=!1;this.typeCd=this.control=null;this.minValue=0;this.maxValue=1;this.hInput=this.hInputPanel=this.hSlideRowBR=this.hSlideRowBM=this.hSlideRowBL=this.hSlideRowMR=this.hSlideRowMM=this.hSlideRowML=this.hSlideRowUR=this.hSlideRowUM=this.hSlideRowUL=this.hSlideForm=this.hSlidePanel=this.hColorImage=this.hColorPanel=this.hPanel=null;this.onMouseDown=SUiColorBar_onMouseDown;this.onMouseMove=SUiColorBar_onMouseMove;this.onMouseUp=SUiColorBar_onMouseUp;this.build=
SUiColorBar_build;this.setRange=SUiColorBar_setRange;this.setColorValue=SUiColorBar_setColorValue;this.setSlideValue=SUiColorBar_setSlideValue;this.setInputValue=SUiColorBar_setInputValue;this.convertSlide=SUiColorBar_convertSlide;this.convertGet=SUiColorBar_convertGet;this.convertSet=SUiColorBar_convertSet;this.get=SUiColorBar_get;this.set=SUiColorBar_set;this.changeSlide=SUiColorBar_changeSlide;this.changeInputEdit=SUiColorBar_changeInputEdit;this.changeInputChange=SUiColorBar_changeInputChange;
return this},MO.SUiColorBar_onMouseDown=function(b){b=RHtml.clientX(b.hSource,this.hSlideForm)+b.offsetX;this._draging=!0;RWindow.setOptionSelect(!1);this.changeSlide(b)},MO.SUiColorBar_onMouseMove=function(b){this._draging&&(b=RHtml.clientX(b.hSource,this.hSlideForm)+b.offsetX,this.changeSlide(b))},MO.SUiColorBar_onMouseUp=function(b){this._draging=!1;RWindow.setOptionSelect(!0)},MO.SUiColorBar_build=function(b){b=this.control;var d=RBuilder.appendTableRow(this.hPanel),f=this.hColorPanel=RBuilder.appendTableCell(d);
f.width=13;f.style.padding="2px";this.hColorImage=RBuilder.appendIcon(f,null,"n",11,11);f=this.hSlidePanel=RBuilder.appendTableCell(d);f.style.padding="2px";f.vAlign="middle";var h=this.hSlideForm=RBuilder.appendTable(f);h.__pbar=this;h.width="100%";h.style.height="9px";h.style.cursor="pointer";var q=this.hSlideRowUp=RBuilder.appendTableRow(h);q.style.height="3px";this.hSlideRowUL=RBuilder.appendTableCell(q);f=this.hSlideRowUM=RBuilder.appendTableCell(q);f.width=2;f.bgColor="#EEEEEE";this.hSlideRowUR=
RBuilder.appendTableCell(q);q=this.hSlideRow=RBuilder.appendTableRow(h);q.style.height="3px";f=this.hSlideRowML=RBuilder.appendTableCell(q);f.bgColor="#999999";f=this.hSlideRowMM=RBuilder.appendTableCell(q);f.width=2;f.bgColor="#EEEEEE";f=this.hSlideRowMR=RBuilder.appendTableCell(q);f.bgColor="#999999";q=this.hSlideRowDown=RBuilder.appendTableRow(h);q.style.height="3px";this.hSlideRowBL=RBuilder.appendTableCell(q);f=this.hSlideRowBM=RBuilder.appendTableCell(q);f.width=2;f.bgColor="#EEEEEE";this.hSlideRowBR=
RBuilder.appendTableCell(q);f=this.hInputPanel=RBuilder.appendTableCell(d,this.control.styleName("InputPanel"));f.width=36;d=this.hInput=RBuilder.appendEdit(f,this.control.styleName("Input"));d._pbar=this;b.attachEvent("onInputKeyPress",d,b.onInputKeyPress);b.attachEvent("onInputEdit",d,b.onInputEdit);b.attachEvent("onInputChange",d,b.onInputChange)},MO.SUiColorBar_setRange=function(b,d){null!=b&&(this.minValue=b);null!=d&&(this.maxValue=d)},MO.SUiColorBar_setColorValue=function(b){b=RHex.format(b,
2);var d=null;switch(this.typeCd){case "red":d=b+"0000";break;case "green":d="00"+b+"00";break;case "blue":d="0000"+b;break;default:throw new TError(this,"Invalid type.");}this.hColorImage.style.backgroundColor="#"+d},MO.SUiColorBar_setSlideValue=function(b){var d=this.hSlideForm.offsetWidth;0<d&&(this.hSlideRowML.width=RInteger.toRange(b/this.maxValue*d,1,d-1))},MO.SUiColorBar_setInputValue=function(b){this.hInput.value=b},MO.SUiColorBar_convertGet=function(b){return b},MO.SUiColorBar_get=function(){return this.convertGet(this.hInput.value)},
MO.SUiColorBar_convertSet=function(b){return b},MO.SUiColorBar_set=function(b){b=this.convertSet(b);this.setColorValue(b);this.setSlideValue(b);this.setInputValue(b)},MO.SUiColorBar_convertSlide=function(b){return b},MO.SUiColorBar_changeSlide=function(b){b=this.convertSlide(b/(this.hSlideForm.offsetWidth-3));this.set(b);this.control.refreshValue()},MO.SUiColorBar_changeInputEdit=function(){var b=this.convertGet(this.hInput.value);this.setColorValue(b);this.setSlideValue(b);this.control.refreshValue()},
MO.SUiColorBar_changeInputChange=function(){var b=this.convertGet(this.hInput.value);this.set(b);this.control.refreshValue()};
with(MO)MO.SUiColorChannel=function(){SUiColorBar.call(this);this.minValue=0;this.maxValue=255;this.setInputValue=SUiColorChannel_setInputValue;this.convertGet=SUiColorChannel_convertGet;this.convertSet=SUiColorChannel_convertSet;return this},MO.SUiColorChannel_setInputValue=function(b){b=RInteger.toRange(b,this.minValue,this.maxValue);b=RInteger.format(b);var d=this.hInput;d.value!=b&&(d.value=b)},MO.SUiColorChannel_convertGet=function(b){b=RInteger.parse(RString.nvl(b,"0"));return RInteger.toRange(b,
this.minValue,this.maxValue)/255},MO.SUiColorChannel_convertSet=function(b){return parseInt(255*b)};
with(MO)MO.SUiColorPower=function(){SUiColorBar.call(this);this.minValue=0;this.maxValue=4;this.setColorValue=SUiColorPower_setColorValue;this.setSlideValue=SUiColorPower_setSlideValue;this.setInputValue=SUiColorPower_setInputValue;this.convertGet=SUiColorPower_convertGet;this.convertSet=SUiColorPower_convertSet;this.convertSlide=SUiColorPower_convertSlide;return this},MO.SUiColorPower_setColorValue=function(b){b=RInteger.toRange(parseInt(255*b),0,255);b=RHex.format(b,2);this.hColorImage.style.backgroundColor=
"#"+b+b+b},MO.SUiColorPower_setSlideValue=function(b){var d=this.hSlideForm.offsetWidth;0<d&&(this.hSlideRowML.width=RInteger.toRange(b/this.maxValue*d,1,d-1))},MO.SUiColorPower_setInputValue=function(b){var d=this.hInput;b=RFloat.toRange(b,this.minValue,this.maxValue);b=RFloat.format(b,0,null,2,null);d.value!=b&&(d.value=b)},MO.SUiColorPower_convertGet=function(b){return RFloat.parse(b)},MO.SUiColorPower_convertSet=function(b){return b},MO.SUiColorPower_convertSlide=function(b){return b*this.maxValue};
with(MO)MO.SUiSlide=function(){this._draging=!1;this.control=null;this.stepValue=1;this.minValue=0;this.range=this.maxValue=100;this.hSlideBR=this.hSlideBM=this.hSlideBL=this.hSlideB=this.hSlideMR=this.hSlideMM=this.hSlideML=this.hSlideM=this.hSlideUR=this.hSlideUM=this.hSlideUL=this.hSlideU=this.hSlideForm=this.hSlidePanel=this.hPanel=null;this.onMouseDown=SUiSlide_onMouseDown;this.onMouseMove=SUiSlide_onMouseMove;this.onMouseUp=SUiSlide_onMouseUp;this.onSlideChange=RMethod.empty;this.build=SUiSlide_build;
this.setRange=SUiSlide_setRange;this.setSlideValue=SUiSlide_setSlideValue;this.get=SUiSlide_get;this.set=SUiSlide_set;this.changeSlide=SUiSlide_changeSlide;return this},MO.SUiSlide_onMouseDown=function(b){b=RHtml.clientX(b.hSource,this.hSlideForm)+b.offsetX;this._draging=!0;RWindow.setOptionSelect(!1);this.changeSlide(b)},MO.SUiSlide_onMouseMove=function(b){this._draging&&(b=RHtml.clientX(b.hSource,this.hSlideForm)+b.offsetX,this.changeSlide(b))},MO.SUiSlide_onMouseUp=function(b){this._draging=!1;
RWindow.setOptionSelect(!0)},MO.SUiSlide_build=function(b){b=this.hSlideForm=RBuilder.appendTable(this.hPanel);b.__pcapture=this;b.width="100%";b.style.height="9px";b.style.cursor="pointer";var d=this.hSlideU=RBuilder.appendTableRow(b);d.style.height="3px";this.hSlideUL=RBuilder.appendTableCell(d);var f=this.hSlideUM=RBuilder.appendTableCell(d);f.width=2;f.bgColor="#EEEEEE";this.hSlideUR=RBuilder.appendTableCell(d);d=this.hSlideM=RBuilder.appendTableRow(b);d.style.height="3px";f=this.hSlideML=RBuilder.appendTableCell(d);
f.bgColor="#999999";f=this.hSlideMM=RBuilder.appendTableCell(d);f.width=2;f.bgColor="#EEEEEE";f=this.hSlideMR=RBuilder.appendTableCell(d);f.bgColor="#999999";d=this.hSlideB=RBuilder.appendTableRow(b);d.style.height="3px";this.hSlideBL=RBuilder.appendTableCell(d);f=this.hSlideBM=RBuilder.appendTableCell(d);f.width=2;f.bgColor="#EEEEEE";this.hSlideBR=RBuilder.appendTableCell(d)},MO.SUiSlide_setRange=function(b,d){null!=b&&(this.minValue=RFloat.parse(b));null!=d&&(this.maxValue=RFloat.parse(d));this.range=
this.maxValue-this.minValue},MO.SUiSlide_setSlideValue=function(b){var d=this.hSlideForm.offsetWidth;0<d&&(this.hSlideML.width=RInteger.toRange((b-this.minValue)/this.range*d,1,d-1))},MO.SUiSlide_get=function(){return p/(this.hSlideForm.offsetWidth-3)*this.range+this.minValue},MO.SUiSlide_set=function(b){this.setSlideValue(b)},MO.SUiSlide_changeSlide=function(b){var d=this.control,f=this.hSlideForm.offsetWidth-3;this.hSlideML.width=RInteger.toRange(b,1,f-1);b=b/f*this.range+this.minValue;b=RFloat.toRange(b,
this.minValue,this.maxValue);this.onSlideChange.call(d,b)};
with(MO)MO.FUiButton=function(b){b=RClass.inherits(this,b,FDuiControl,MListenerClick);b._labelPositionCd=RClass.register(b,new APtyString("_labelPositionCd"),EUiPosition.Left);b._icon=RClass.register(b,new APtyString("_icon"));b._action=RClass.register(b,new APtyString("_action"));b._stylePanel=RClass.register(b,new AStyle("_stylePanel"));b._styleForm=RClass.register(b,new AStyle("_styleForm"));b._styleIcon=RClass.register(b,new AStyle("_styleIcon"));b._styleLabel=RClass.register(b,new AStyle("_styleLabel"));
b._styleIconPanel=RClass.register(b,new AStyleIcon("_styleIconPanel"));b._hForm=null;b._hLeftButton=null;b._hMiddleButton=null;b._hRightButton=null;b._hLabelPanel=null;b._hLabel=null;b.onBuild=FUiButton_onBuild;b.onClick=RClass.register(b,new AEventClick("onClick"),FUiButton_onClick);b.doClick=FUiButton_doClick;return b},MO.FUiButton_onBuild=function(b){this.__base.FDuiControl.onBuild.call(this,b);b=this._hPanel;this.attachEvent("onClick",b);b=RBuilder.appendTable(b,this.styleName("Form"));b=RBuilder.appendTableRow(b);
if(this._icon){var d=RBuilder.appendTableCell(b);d.width=16;this._hIcon=RBuilder.appendIcon(d,this.styleName("Icon"),this._icon)}this.label&&(d=RBuilder.appendTableCell(b),d.align="center",d.noWrap=!0,this._hLabel=RBuilder.appendText(d,this.styleName("Label"),this._label))},MO.FUiButton_onButtonEnter=function(b){this._disabled||(this._hLeftButton.background=this.styleIconPath("HoverLeft"),this._hMiddleButton.background=this.styleIconPath("HoverMiddle"),this._hRightButton.background=this.styleIconPath("HoverRight"))},
MO.FUiButton_onButtonLeave=function(b){this._disabled||(this._hLeftButton.background=this.styleIconPath("ButtonLeft"),this._hMiddleButton.background=this.styleIconPath("Button"),this._hRightButton.background=this.styleIconPath("ButtonRight"))},MO.FUiButton_onButtonDown=function(b){this._disabled||(this._hLeftButton.background=this.styleIconPath("PressLeft"),this._hMiddleButton.background=this.styleIconPath("PressMiddle"),this._hRightButton.background=this.styleIconPath("PressRight"))},MO.FUiButton_onButtonUp=
function(b){this._disabled||(this._hLeftButton.background=this.styleIconPath("ButtonLeft"),this._hMiddleButton.background=this.styleIconPath("Button"),this._hRightButton.background=this.styleIconPath("ButtonRight"))},MO.FUiButton_onButtonClickDelay=function(b){this.__process=!1;this.clickActive.status=EActive.Sleep},MO.FUiButton_onClick=function(b){this.doClick()},MO.FUiButton_onButtonClick=function(b){this.doClick()},MO.FUiButton_oeMode=function(b){this.__base.FDuiControl.oeMode.call(this,b);this.__base.MDisplay.oeMode.call(this,
b);return EEventStatus.Stop},MO.FUiButton_setLabel=function(b){this.label=b;this._hLabel.innerText=b;this._hLabel.noWrap=!0},MO.FUiButton_setLabelColor=function(b){this._hLabel.style.color="#FF0000"},MO.FUiButton_setLabelStyle=function(b,d,f){this._hLabel.style.color="#FF0000";this._hLabel.style.fontWeight="bold";this._hLabel.style.fontSize="12"},MO.FUiButton_doClick=function(){if(!this._disabled){RConsole.find(FUiFocusConsole).blur();var b=new SClickEvent(this);this.processClickListener(b);b.dispose();
this._action&&eval(this._action)}},MO.FUiButton_dispose=function(){this.__base.FDuiControl.dispose.call(this);this._hLabel=this._hFormEnd=this._hForm=null};
with(MO)MO.FUiCalendar=function(b){b=RClass.inherits(this,b,FEditControl,MEditBorder,MDropable,MDescCalendar);b.editFormat=RDate.DisplayFormat;b.editHour=RClass.register(b,new TPtyBoolSet("editHour","editDate",EDateTimeMode.Hour));b.editMinute=RClass.register(b,new TPtyBoolSet("editMinute","editDate",EDateTimeMode.Minute));b.editSecond=RClass.register(b,new TPtyBoolSet("editSecond","editDate",EDateTimeMode.Second));b.borderStyle=EUiBorder.RoundDrop;b.date=null;b.lsnEditEnd=null;b.hForm=null;b.hDrop=
null;b.hForm=null;b.onKeyPress=FUiCalendar_onKeyPress;b.onDataClick=FUiCalendar_onDataClick;b.refreshStyle=FUiCalendar_refreshStyle;b.onEditEnd=FUiCalendar_onEditEnd;b.onBuildEdit=FUiCalendar_onBuildEdit;b.construct=FUiCalendar_construct;b.formatValue=FUiCalendar_formatValue;b.formatText=FUiCalendar_formatText;b.drop=FUiCalendar_drop;b.doBlur=FUiCalendar_doBlur;return b},MO.FUiCalendar_onDataClick=function(){this.editCheck||this.drop()},MO.FUiCalendar_onBuildEdit=function(b){b=RBuilder.appendTable(b.hPanel);
b.style.tableLayout="fixed";b=this.hEdit=b.insertRow();this.onBuildChange(b.insertCell());b=b.insertCell();b=this.hEdit=RBuilder.appendEdit(b,this.style("Edit"));b.style.disabled="true";this.editLength&&(b.maxLength=this.editLength)},MO.FUiCalendar_onEditEnd=function(b){b&&(this.set(b.get()),this._invalidText=this.validText(this.text()),this.refreshStyle());this.onDataEditEnd(this)},MO.FUiCalendar_onKeyPress=function(b){RString.inChars(String.fromCharCode(b.keyCode),RDate.Chars)||RKey.eventClear(b)},
MO.FUiCalendar_construct=function(){this.base.FEditControl.construct.call(this);this.date=new TDate;this.lsnEditEnd=new TListener(this,this.onEditEnd)},MO.FUiCalendar_formatValue=function(b){return b?("@now"==b.toLowerCase()?this.date.now():RDate.autoParse(this.date,b),RDate.formatDate(this.date)):RString.nvl(b)},MO.FUiCalendar_formatText=function(b){return b?(RDate.autoParse(this.date,b),RDate.formatDate(this.date,this.editFormat)):RString.nvl(b)},MO.FUiCalendar_refreshStyle=function(){this.base.FEditControl.refreshStyle.call(this);
this.editCheck||(this.hEdit.readOnly="true")},MO.FUiCalendar_drop=function(){if(this.canDrop()&&this._editable){var b=this.editor=RConsole.find(FEditConsole).focus(this,FUiCalendarEditor,this.name);b.set(this.reget(),this.editFormat);b.setHourEditable(this.editHour);b.setMinuteEditable(this.editMinute);b.setSecondEditable(this.editSecond);b.lsnEditEnd=this.lsnEditEnd;b.show()}},MO.FUiCalendar_doBlur=function(){this.base.FEditControl.doBlur.call(this);this.editor&&this.editor.hide()};
with(MO)MO.FUiCalendarEditor=function(b){b=RClass.inherits(this,b,FDropEditor,MUiFocusLooper);b.editFormat=null;b.dataValue=null;b.date=new TDate;b.hTitlePanel=null;b.hYearPrior=null;b.hYear=null;b.hYearNext=null;b.hMonthPrior=null;b.hMonth=null;b.hMonthNext=null;b.hDaysPanel=null;b.hTimePanel=null;b.hTime=null;b.hNow=null;b.hOk=null;b.hCancel=null;b.hHour=null;b.hMinute=null;b.hSecond=null;b.hSelect=null;b.editFormat=RDate.DisplayFormat;b.dateOrg=new TDate;b.dateOrgValue=null;b.dayCells=new TList;
b.focusObject=null;b.skipBlur=!1;b.styleYearMonth=RClass.register(b,new TStyle("YearMonth"));b.styleButton=RClass.register(b,new TStyle("Button"));b.styleButtonHover=RClass.register(b,new TStyle("ButtonHover"));b.styleDay=RClass.register(b,new TStyle("Day"));b.styleDaySel=RClass.register(b,new TStyle("DaySel"));b.styleDayHover=RClass.register(b,new TStyle("DayHover"));b.styleDayFree=RClass.register(b,new TStyle("DayFree"));b.styleDayNone=RClass.register(b,new TStyle("DayNone"));b.styleTitlePanel=
RClass.register(b,new TStyle("TitlePanel"));b.styleDaysPanel=RClass.register(b,new TStyle("DaysPanel"));b.styleTimePanel=RClass.register(b,new TStyle("TimePanel"));b.styleMonth=RClass.register(b,new TStyle("Year"));b.styleMonth=RClass.register(b,new TStyle("Month"));b.styleWeek=RClass.register(b,new TStyle("Week"));b.styleTime=RClass.register(b,new TStyle("Time"));b.styleHour=RClass.register(b,new TStyle("Hour"));b.styleSplit=RClass.register(b,new TStyle("Split"));b.styleMinute=RClass.register(b,
new TStyle("Minute"));b.styleSecond=RClass.register(b,new TStyle("Second"));b.styleNow=RClass.register(b,new TStyle("Now"));b.styleOk=RClass.register(b,new TStyle("Ok"));b.onDaySelect=RClass.register(b,new HMouseDown("onDaySelect"),FUiCalendarEditor_onDaySelect);b.onButtonNow=RClass.register(b,new HMouseDown("onButtonNow"),FUiCalendarEditor_onButtonNow);b.onDateKeyDown=RClass.register(b,new HKeyDown("onDateKeyDown"),FUiCalendarEditor_onDateKeyDown);b.onDateBlur=RClass.register(b,new HBlur("onDateBlur"),
FUiCalendarEditor_onDateBlur);b.onTimeBlur=RClass.register(b,new HBlur("onTimeBlur"),FUiCalendarEditor_onTimeBlur);b.onTimeClick=RClass.register(b,new HClick("onTimeClick"),FUiCalendarEditor_onTimeClick);b.onDayDbClick=RClass.register(b,new HDoubleClick("onDayDbClick"),FUiCalendarEditor_onDayDbClick);b.onDayEnter=RClass.register(b,new HMouseEnter("onDayEnter"),FUiCalendarEditor_onDayEnter);b.onDayOut=RClass.register(b,new HMouseOut("onDayOut"),FUiCalendarEditor_onDayOut);b.onButtonOk=RClass.register(b,
new HMouseDown("onButtonOk"),FUiCalendarEditor_onButtonOk);b.onButtonCancel=RClass.register(b,new HMouseDown("onButtonCancel"),FUiCalendarEditor_onButtonCancel);b.onButtonOver=RClass.register(b,new HMouseEnter("onButtonOver"),FUiCalendarEditor_onButtonOver);b.onButtonOut=RClass.register(b,new HMouseOut("onButtonOut"),FUiCalendarEditor_onButtonOut);b.onMdown=RClass.register(b,new HMouseDown("onMdown"),FUiCalendarEditor_onMdown);b.onMup=RClass.register(b,new HMouseUp("onMup"),FUiCalendarEditor_onMup);
b.onBuildDrop=FUiCalendarEditor_onBuildDrop;b.show=FUiCalendarEditor_show;b.setMinuteEditable=FUiCalendarEditor_setMinuteEditable;b.setHourEditable=FUiCalendarEditor_setHourEditable;b.setSecondEditable=FUiCalendarEditor_setSecondEditable;b.buildTitle=FUiCalendarEditor_buildTitle;b.buildDays=FUiCalendarEditor_buildDays;b.buildTime=FUiCalendarEditor_buildTime;b.testBlur=FUiCalendarEditor_testBlur;b.get=FUiCalendarEditor_get;b.set=FUiCalendarEditor_set;b.setDate=FUiCalendarEditor_setDate;b.storeChange=
FUiCalendarEditor_storeChange;b.daySelectLsns=new TListeners;b.onBuildButton=FUiCalendarEditor_onBuildButton;b.ohKdown=FUiCalendarEditor_ohKdown;b.ohDaysChange=FUiCalendarEditor_ohDaysChange;b.ohKeyCheck=FUiCalendarEditor_ohKeyCheck;b.onDateAction=FUiCalendarEditor_onDateAction;b.panel=FUiCalendarEditor_panel;b.dispose=FUiCalendarEditor_dispose;return b},MO.FUiCalendarEditor_onTimeClick=function(b){b=b.hSource;b.editAble&&b.select()},MO.FUiCalendarEditor_onTimeBlur=function(b){b=b.hSource;b==this.hHour?
b.value=Math.min(RInteger.parse(b.value),23):b==this.hMinute?b.value=Math.min(RInteger.parse(b.value),59):b==this.hSecond&&(b.value=Math.min(RInteger.parse(b.value),59));this.storeChange();this.setDate(this.date)},MO.FUiCalendarEditor_onDayDbClick=function(b){var d=b.source;RClass.isClass(d,FUiCalendarEditor)&&0!=RInteger.parse(b.hSource.innerText)&&(d.date.setDay(b.hSource.innerText),d.dataValue=RDate.formatDate(d.date),d.editEnd())},MO.FUiCalendarEditor_onDaySelect=function(b){RClass.isClass(this,
FUiCalendarEditor)&&0!=RInteger.parse(b.hSource.innerText)&&(b=b.hSource,this.hSelect&&(this.hSelect.style.border="1 solid #FFFFFF"),this.hSelect=b,b.style.border="1 solid #2BD6F0",this.date.setDay(b.innerText))},MO.FUiCalendarEditor_onButtonNow=function(b){b=b.source;RClass.isClass(b,FUiCalendarEditor)&&(b.dataValue=RDate.format(),b.editEnd())},MO.FUiCalendarEditor_onDateKeyDown=function(b,d){var f=b.hSource,h=f.value;EKey.Enter==b.keyCode?(this.storeChange(),this.setDate(this.date)):EKey.Up==b.keyCode?
(f==this.hYear?this.hYear.value=RInteger.parse(this.hYear.value)+1:f==this.hMonth?this.hMonth.value=RInteger.parse(this.hMonth.value)+1:f==this.hHour?this.hHour.editAble&&23>h&&(f.value=RInteger.parse(f.value)+1):f==this.hMinute?this.hMinute.editAble&&59>h&&(f.value=RInteger.parse(f.value)+1):this.hSecond.editAble&&59>h&&(f.value=RInteger.parse(f.value)+1),this.storeChange(),this.setDate(this.date)):EKey.Down==b.keyCode?(f==this.hYear?this.hYear.value=RInteger.parse(this.hYear.value)-1:f==this.hMonth?
this.hMonth.value=RInteger.parse(this.hMonth.value)-1:f==this.hHour?this.hHour.editAble&&0<h&&(f.value=RInteger.parse(f.value)-1):f==this.hMinute?this.hMinute.editAble&&0<h&&(f.value=RInteger.parse(f.value)-1):this.hSecond.editAble&&0<h&&(f.value=RInteger.parse(f.value)-1),this.storeChange(),this.setDate(this.date),f.select()):f==this.hHour||f==this.hMinute||f==this.hSecond?f.editAble?RKey.fixChars(d,RDate.Chars):(d.keyCode=0,d.returnValue=!1):RKey.fixChars(d,RDate.Chars)},MO.FUiCalendarEditor_onDateBlur=
function(){this.storeChange();this.setDate(this.date)},MO.FUiCalendarEditor_onBuildDrop=function(){this.hDatePanel=RBuilder.appendTable(this.hDropPanel);this.hDropPanel.align="center";this.hDatePanel.width="100%";var b=this.hDatePanel.insertRow(),b=this.hTitlePanel=b.insertCell();b.colSpan=2;b.className=this.style("TitlePanel");this.buildTitle();b=this.hDatePanel.insertRow();b=this.hDaysPanel=b.insertCell();b.colSpan=2;b.className=this.style("DaysPanel");this.buildDays();b=this.hDatePanel.insertRow();
this.hTimePanel=b.insertCell();this.buildTime();this.pushFocus(this.hYear);this.pushFocus(this.hMonth)},MO.FUiCalendarEditor_show=function(b){this.base.FDropEditor.show.call(this,b);b=this.hPanel;var d=this.source.getEditRange();b.style.pixelLeft=d.x;b.style.pixelTop=d.y+d.height;b.style.pixelWidth=273;this.base.MShadow.show.call(this)},MO.FUiCalendarEditor_buildTitle=function(){var b=RBuilder.appendTable(this.hTitlePanel,null,0,5,1);b.align="center";b.width="100%";b.style.filter="progid:DXImageTransform.Microsoft.Gradient(startColorStr='#E5FAFE', endColorStr='#FFFFFF', gradientType='0')";
var b=b.insertRow(),d=b.insertCell(),d=this.hYearPrior=RBuilder.append(d,"SPAN",this.style("Button"));d.link=this;d.linkAction=this.onDateAction;d.innerText="3";this.attachEvent("onButtonOver",d);this.attachEvent("onButtonOut",d);this.attachEvent("onMdown",d);this.attachEvent("onMup",d);d=b.insertCell();d=this.hYear=RBuilder.append(d,"INPUT",this.style("Year"));d.maxLength="4";this.attachEvent("onDateBlur",d,this.onDateBlur);this.attachEvent("onDateKeyDown",d,this.onDateKeyDown);d=b.insertCell();
d.innerText=RContext.get("FUiCalendarEditor:year");d.className=this.style("YearMonth");d=b.insertCell();d=this.hYearNext=RBuilder.append(d,"SPAN",this.style("Button"));d.link=this;d.linkAction=this.onDateAction;d.innerText="4";this.attachEvent("onButtonOver",d);this.attachEvent("onButtonOut",d);this.attachEvent("onMdown",d);this.attachEvent("onMup",d);b.insertCell().width="10";d=b.insertCell();d=this.hMonthPrior=RBuilder.append(d,"SPAN",this.style("Button"));d.link=this;d.linkAction=this.onDateAction;
d.innerText="3";this.attachEvent("onButtonOver",d);this.attachEvent("onButtonOut",d);this.attachEvent("onMdown",d);this.attachEvent("onMup",d);d=b.insertCell();d=this.hMonth=RBuilder.append(d,"INPUT",this.style("Month"));d.maxLength="2";this.attachEvent("onDateBlur",d,this.onDateBlur);this.attachEvent("onDateKeyDown",d,this.onDateKeyDown);d=b.insertCell();d.innerText=RContext.get("FUiCalendarEditor:month");d.className=this.style("YearMonth");d=b.insertCell();d=this.hMonthNext=RBuilder.append(d,"SPAN",
this.style("Button"));d.link=this;d.linkAction=this.onDateAction;d.innerText="4";this.attachEvent("onButtonOver",d);this.attachEvent("onButtonOut",d);this.attachEvent("onMdown",d);this.attachEvent("onMup",d)},MO.FUiCalendarEditor_buildDays=function(){var b=RBuilder.appendTable(this.hDaysPanel,null,0,0,1);b.width="100%";for(var d=RContext.get("FUiCalendarEditor:weekdays").split(","),f=d.length,h=b.insertRow(),q=0;q<f;q++){var w=h.insertCell();w.className=this.style("Week");w.align="center";w.innerText=
d[q]}for(q=0;6>q;q++)for(d=b.insertRow(),h=0;h<f;h++)w=d.insertCell(),w.link=this,w.className=this.style("DayNone"),this.attachEvent("onDayEnter",w),this.attachEvent("onDayOut",w),this.attachEvent("onDaySelect",w),this.attachEvent("onDayDbClick",w),w.innerText=".",this.dayCells.push(w)},MO.FUiCalendarEditor_buildTime=function(){var b=RBuilder.appendTable(this.hTimePanel,null,0,1,1);this.hTimePanel.style.filter="progid:DXImageTransform.Microsoft.Gradient(startColorStr='#FFFFFF', endColorStr='#E5FAFE', gradientType='0')";
b=b.insertRow();b.insertCell().width=5;var d=b.insertCell();d.width=50;d.style.color="#1F8FB7";d.style.fontWeight="BOLD";d.innerText="\u65f6\u95f4:";var d=b.insertCell(),f=RBuilder.appendTable(d,null,0,0,0);d.style.border="1 solid #2BD6F0";d.style.backgroundColor="#FFFFFF";d=f.insertRow();f=d.insertCell();f=this.hHour=RBuilder.appendEdit(f,this.style("Hour"));f.maxLength=2;this.attachEvent("onTimeClick",f);this.attachEvent("onDateKeyDown",f,this.onDateKeyDown);this.attachEvent("onTimeBlur",f,this.onTimeBlur);
d.insertCell().innerText=":";f=d.insertCell();f=this.hMinute=RBuilder.appendEdit(f,this.style("Minute"));f.maxLength=2;this.attachEvent("onTimeClick",f);this.attachEvent("onDateKeyDown",f,this.onDateKeyDown);this.attachEvent("onTimeBlur",f,this.onTimeBlur);d.insertCell().innerText=":";d=d.insertCell();d=this.hSecond=RBuilder.appendEdit(d,this.style("Second"));d.maxLength=2;this.attachEvent("onTimeClick",d);this.attachEvent("onDateKeyDown",d,this.onDateKeyDown);this.attachEvent("onTimeBlur",d,this.onTimeBlur);
b.insertCell().width=50;d=b.insertCell();d.style.display="none";f=this.hNow=RBuilder.append(d,"SPAN",this.style("Now"));f.style.width=50;d.style.border="1 solid #2BD6F0";f.innerText=RContext.get("FUiCalendarEditor:now");f.style.display="none";f.link=this;this.attachEvent("onButtonNow",f);d=b.insertCell();f=this.hCancel=RBuilder.append(d,"SPAN",this.style("Ok"));f.style.width=50;d.style.border="1 solid #2BD6F0";f.link=this;this.attachEvent("onButtonCancel",f);f.innerText=RContext.get("FUiCalendarEditor:cancel");
b=b.insertCell();d=this.hOk=RBuilder.append(b,"SPAN",this.style("Ok"));d.style.width=50;b.style.border="1 solid #2BD6F0";d.link=this;this.attachEvent("onButtonOk",d);d.innerText=RContext.get("FUiCalendarEditor:ok")},MO.FUiCalendarEditor_testBlur=function(b){return this.source!=b},MO.FUiCalendarEditor_get=function(){return this.dataValue},MO.FUiCalendarEditor_set=function(b,d){this.changed=!1;this.skipBlur=0;this.dateOrgValue=this.dataValue=b;this.editFormat=d;RDate.parse(this.date,b);RDate.parse(this.dateOrg,
b);b||(this.date.now(),RDate.parse(this.date,b),RDate.parse(this.dateOrg,b));this.setDate(this.date)},MO.FUiCalendarEditor_setDate=function(b){this.hYear.value=b.year;this.hMonth.value=b.month;this.hHour.value=RString.lpad(b.hour,2,"0");this.hMinute.value=RString.lpad(b.minute,2,"0");this.hSecond.value=RString.lpad(b.second,2,"0");var d=b.day;if(this.dateOrg.year!=b.year||this.dateOrg.month!=b.month)d=-1;this.hSelect&&(this.hSelect.style.border="1 solid #FFFFFF");b=this.date.monthWeekDay();for(var f=
this.date.monthDays(),h=b,q=0;q<this.dayCells.count;q++){var w=this.dayCells.get(q);if(q<b)w.className=this.style("DayNone"),w.innerText=".";else if(q<f+b){7==h&&(h=0);var z=q-b+1;z==d?(w.className=this.style("DaySel"),w.isCurrent=!0,this.hSelect=w,w.style.border="1 solid #2BD6F0"):(w.isFree=0==h||6==h,w.className=w.isFree?this.style("DayFree"):this.style("Day"),w.isCurrent=!1);w.innerText=z;h++}else w.className=this.style("DayNone"),w.innerText="."}},MO.FUiCalendarEditor_setHourEditable=function(b){b?
this.hHour.editAble=!0:(this.hHour.value="00",this.hHour.style.cursor="default",this.hHour.style.color="gray",this.hHour.editAble=!1)},MO.FUiCalendarEditor_setMinuteEditable=function(b){b?this.hMinute.editAble=!0:(this.hMinute.value="00",this.hMinute.style.cursor="default",this.hMinute.style.color="gray",this.hMinute.editAble=!1)},MO.FUiCalendarEditor_setSecondEditable=function(b){b?this.hSecond.editAble=!0:(this.hSecond.value="00",this.hSecond.style.cursor="default",this.hSecond.style.color="gray",
this.hSecond.editAble=!1)},MO.FUiCalendarEditor_storeChange=function(){this.date.setYear(this.hYear.value);this.date.setMonth(this.hMonth.value);this.date.setHour(Math.min(RInteger.parse(this.hHour.value),23));this.date.setMinute(Math.min(RInteger.parse(this.hMinute.value),59));this.date.setSecond(Math.min(RInteger.parse(this.hSecond.value),59))},MO.FUiCalendarEditor_onBuildButton=function(){},MO.FUiCalendarEditor_onMdown=function(b){var d=b.source;RClass.isClass(d,FUiCalendarEditor)&&(d.isSkipBlur=
!0,b.hSource.linkAction&&b.hSource.linkAction.call(d,b.hSource))},MO.FUiCalendarEditor_onMup=function(b){b=b.source;RClass.isClass(b,FUiCalendarEditor)&&(b=b.focusObject)&&b.focus&&b.select&&(b.focus(),b.select())},MO.FUiCalendarEditor_ohKdown=function(){var b=this.link;if(RClass.isClass(b,FUiCalendarEditor)){var d=RWindow.event(this);EKey.Esc==d.keyCode?(b.dataValue=b.dateOrgValue,b.editStatus=EEditStatus.Cancel,b.endEdit()):event.ctrlKey&&EKey.Enter==d.keyCode?(b.storeChange(),b.editStatus=EEditStatus.Ok,
b.endEdit()):EKey.Enter==d.keyCode?(b.storeChange(),b.setDate(b.date)):EKey.Tab==d.keyCode&&(b.isSkipBlur=!0,d.shiftKey?b.focusPrior():b.focusNext(),d.returnValue=0)}},MO.FUiCalendarEditor_onButtonOver=function(b){var d=b.source;RClass.isClass(d,FUiCalendarEditor)&&(b.hSource.className=d.style("ButtonHover"))},MO.FUiCalendarEditor_onButtonOut=function(b){var d=b.source;RClass.isClass(d,FUiCalendarEditor)&&(b.hSource.className=d.style("Button"))},MO.FUiCalendarEditor_onButtonOk=function(b){b=b.source;
RClass.isClass(b,FUiCalendarEditor)&&(b.editStatus=EEditStatus.Ok,b.dataValue=RDate.formatDate(b.date),b.editEnd())},MO.FUiCalendarEditor_onButtonCancel=function(b){b=b.source;RClass.isClass(b,FUiCalendarEditor)&&(b.editStatus=EEditStatus.Cancel,b.dataValue="",b.editEnd())},MO.FUiCalendarEditor_ohDaysChange=function(){var b=this.link;RClass.isClass(b,FUiCalendarEditor)&&(b.date.setYear(b.hYear.value),b.date.setMonth(b.hMonth.value),b.setDate(b.date))},MO.FUiCalendarEditor_ohKeyCheck=function(){var b=
RWindow.event(this);RString.inChars(String.fromCharCode(b.keyCode),RDate.Chars)||(b.keyCode=0)},MO.FUiCalendarEditor_onDayEnter=function(b){var d=b.source;RClass.isClass(d,FUiCalendarEditor)&&"."!=b.hSource.innerText&&!b.hSource.isCurrent&&(b.hSource.className=d.style("DayHover"))},MO.FUiCalendarEditor_onDayOut=function(b){var d=b.source;RClass.isClass(d,FUiCalendarEditor)&&"."!=b.hSource.innerText&&!b.hSource.isCurrent&&(b.hSource.className=b.hSource.isFree?d.style("DayFree"):d.style("Day"))},MO.FUiCalendarEditor_onDateAction=
function(b){this.hYearPrior==b?(this.date.addYear(-1),this.setDate(this.date),this.focusObject!=this.hYear&&(this.focusObject=this.hYear,this.hYear.focus(),this.hYear.select())):this.hYearNext==b?(this.date.addYear(1),this.setDate(this.date),this.focusObject!=this.hYear&&(this.focusObject=this.hYear,this.hYear.focus(),this.hYear.select())):this.hMonthPrior==b?(this.date.addMonth(-1),this.setDate(this.date),this.focusObject!=this.hMonth&&(this.focusObject=this.hMonth,this.hMonth.focus())):this.hMonthNext==
b&&(this.date.addMonth(1),this.setDate(this.date),this.focusObject!=this.hMonth&&(this.focusObject=this.hMonth,this.hMonth.focus()))},MO.FUiCalendarEditor_panel=function(b){return EPanel.Shadow==b?this.hPanel:this.base.FDropEditor.panel.call(this,b)},MO.FUiCalendarEditor_dispose=function(){this.base.FDropEditor.dispose.call(this);this.hTimePanel=this.hTime=this.hMonth=this.hYear=this.hMonthNext=this.hButtonPanel=this.hNow=this.hOk=this.hTitlePanel=this.hDropPanel=this.hDatePanel=null};
with(MO)MO.FUiCheck=function(b){b=RClass.inherits(this,b,FUiEditControl,MPropertyCheck,MListenerDataChanged);b._styleInput=RClass.register(b,new AStyle("_styleInput"));b._hInput=null;b.onBuildEditValue=FUiCheck_onBuildEditValue;b.onInputClick=RClass.register(b,new AEventClick("onInputClick"),FUiCheck_onInputClick);b.oeSaveValue=FUiCheck_oeSaveValue;b.construct=FUiCheck_construct;b.formatLoad=FUiCheck_formatLoad;b.formatSave=FUiCheck_formatSave;b.get=FUiCheck_get;b.set=FUiCheck_set;b.refreshValue=
FUiCheck_refreshValue;b.refreshStyle=FUiCheck_refreshStyle;return b},MO.FUiCheck_onBuildEditValue=function(b){b=this._hInput=RBuilder.appendCheck(this._hValuePanel,this.styleName("Input"));this.attachEvent("onInputClick",b)},MO.FUiCheck_onInputClick=function(b){this.refreshValue()},MO.FUiCheck_oeSaveValue=function(b){return EStore.Prepare==b.store?(RBoolean.isTrue(this.reget())&&b.values.set(this.dataName,EBoolean.True),EEventStatus.Stop):this.base.FUiEditControl.oeSaveValue.call(this,b)},MO.FUiCheck_construct=
function(){this.__base.FUiEditControl.construct.call(this);this._editSize.set(60,20)},MO.FUiCheck_formatLoad=function(b){return b==this._valueTrue},MO.FUiCheck_formatSave=function(b){return RBoolean.toString(b,this._valueTrue,this._valueFalse)},MO.FUiCheck_get=function(){return this._hInput.checked},MO.FUiCheck_set=function(b){this._hInput.checked=b},MO.FUiCheck_refreshValue=function(){this.processDataChangedListener(this)},MO.FUiCheck_refreshStyle=function(){this.panel(EPanel.Edit).disabled=!this._editable;
this._editable||(this.hEdit.style.cursor="normal")};
with(MO)MO.FCheckPicker=function(b){b=RClass.inherits(this,b,FEditControl,MEditBorder,MDescCheckPicker,MDropable);b.stIconDropSelect=RClass.register(b,new TStyleIcon("DropSelect"));b.items=new TItems;b.borderStyle=EUiBorder.RoundDrop;b.onBuildEdit=FCheckPicker_onBuildEdit;b.onEditEnd=FCheckPicker_onEditEnd;b.onDataKeyDown=FCheckPicker_onDataKeyDown;b.loadConfig=FCheckPicker_loadConfig;b.formatValue=FCheckPicker_formatValue;b.validText=FCheckPicker_validText;b.formatText=FCheckPicker_formatText;b.refreshStyle=
FCheckPicker_refreshStyle;b.drop=FCheckPicker_drop;b.dispose=FCheckPicker_dispose;return b},MO.FCheckPicker_onBuildEdit=function(b){b=this.hEdit=RBuilder.appendEdit(b.hPanel,this.style("Edit"));this.editLength&&(b.maxLength=this.editLength)},MO.FCheckPicker_onEditEnd=function(b){RLog.debug(this,"Begin (editor={1}:{2} value={3})",b,b?b.value():"",this.dataValue);b&&this.set(b.values);this.onDataEditEnd(this);RLog.debug(this,"End (editor={1} value={2})",b,this.dataValue)},MO.FCheckPicker_loadConfig=
function(b){this.base.FEditControl.loadConfig.call(this,b);this.dataEmpty&&this.items.create();this.items.loadConfig(b);return EStatus.Stop},MO.FCheckPicker_text=function(){return this.hEdit.value},MO.FCheckPicker_setText=function(b){this.hEdit.value=b},MO.FCheckPicker_formatValue=function(b){if(RString.isEmpty(b))return"";ta=RString.split(b,",");b=[];for(var d=this.items.items,f=0;f<ta.length;f++)for(var h=0;h<d.count;h++){var q=d.value(h);q.label==ta[f]&&b.push(q.value)}return RString.toUpper(b.join())},
MO.FCheckPicker_validText=function(b){return RString.isEmpty(b)?!0:!RString.isEmpty(this.formatValue(b))},MO.FCheckPicker_formatText=function(b){if(RString.isEmpty(b))return"";va=RString.split(b,",");b=[];for(var d=this.items.items,f=0;f<va.length;f++){var h=d.values[d.indexOf(va[f])];h&&b.push(h.label)}return RString.toUpper(b.join())},MO.FCheckPicker_refreshStyle=function(){this.base.FEditControl.refreshStyle.call(this);this.hDrop.src=this.styleIconPath(this._hover?"DropSelect":"Drop")},MO.FCheckPicker_drop=
function(){if(this.canDrop()&&this.canEdit&&0<this.items.count()){var b=this.editor=RConsole.find(FEditConsole).focus(this,FCheckPickerEditor,this.editRefer);b.linkControl(this)&&(b.setItems(this.items),b.set(this.reget()));b.show()}},MO.FCheckPicker_onDataKeyDown=function(b,d){this.base.FEditControl.onDataKeyDown.call(this,b,d);if(this.items.count()&&this.editor&&this.editor.source==this)this.editor.onEditKeyDown(b,d)},MO.FCheckPicker_dispose=function(){this.base.FEditControl.dispose.call(this);
RMemory.freeHtml(this.hEdit);this.hEdit=null};
with(MO)MO.FCheckPickerEditor=function(b){b=RClass.inherits(this,b,FDropEditor,MShadow);b.MinWidth=120;b.onEditFocus=RClass.register(b,new HFocus("onEditFocus"));b.onEditBlur=RClass.register(b,new HBlur("onEditBlur"));b.stIconDropSelect=RClass.register(b,new TStyleIcon("DropSelect"));b.stFlag=RClass.register(b,new TStyle("Flag"));b.stEditForm=RClass.register(b,new TStyle("EditForm"));b.pattern=null;b.originItem=null;b.selectItem=null;b.items=null;b.itemClickListener=null;b.values=[];b.hBtnTextSpan=
null;b.onBuildDrop=FCheckPickerEditor_onBuildDrop;b.onBuildButton=FCheckPickerEditor_onBuildButton;b.onItemClick=FCheckPickerEditor_onItemClick;b.onEditKeyDown=FCheckPickerEditor_onEditKeyDown;b.construct=FCheckPickerEditor_construct;b.set=FCheckPickerEditor_set;b.setItems=FCheckPickerEditor_setItems;b.select=FCheckPickerEditor_select;b.linkControl=FCheckPickerEditor_linkControl;b.show=FCheckPickerEditor_show;b.hide=FCheckPickerEditor_hide;b.dispose=FCheckPickerEditor_dispose;return b},MO.FCheckPickerEditor_construct=
function(){this.itemClickListener=new TListener(this,this.onItemClick)},MO.FCheckPickerEditor_onBuildDrop=function(){this.hItemsForm=RBuilder.appendTable(this.hDropPanel);this.hItemsForm.width="100%";this.hItemsPanel=RBuilder.append(this.hItemsForm,"TBODY");this.onBuildButton()},MO.FCheckPickerEditor_onBuildButton=function(){this.base.FDropEditor.onBuildButton.call(this);(this.hBtnTextSpan=RBuilder.newSpan(this.hButtonPanel,null)).innerText="colse"},MO.FCheckPickerEditor_onItemClick=function(b){b.setChecked(!b.checked);
b=this.items.items;for(var d=this.components,f=[],h=0;h<b.count;h++){var q=d.value(h);q.checked&&f.push(q.value)}this.source.set(f.join())},MO.FCheckPickerEditor_select=function(b){var d=this.components;b=Math.min(Math.max(0,b),d.count-1);for(var f=0;f<d.count;f++)this.components.value(f).setChecked(f==b);this.position=b},MO.FCheckPickerEditor_onEditKeyDown=function(b,d){},MO.FCheckPickerEditor_set=function(b){for(var d=this.components,f=d.count,h=0;h<f;h++)d.value(h).setChecked(!1);if(!RString.isEmpty(b))for(this.values=
b,va=RString.split(b,","),h=0;h<va.length;h++)(b=d.get(va[h]))&&b.setChecked(!0)},MO.FCheckPickerEditor_setItems=function(b){if(!this.components){var d=this.hItemsPanel;this.items=b;for(var f=b.count(),h=0;h<f;h++){if(0<h){var q=RBuilder.append(d,"TR");q.height=1;q=RBuilder.append(q,"TD");q.colSpan=3;q.style.borderTop="1 dashed #24c2db";RBuilder.appendEmpty(q)}var q=b.get(h),w=RControl.create(FSelectItem);w.name=q.value;w.lsnsClick.push(this.itemClickListener);w.set(q.icon,q.label,q.value);w.setPanel(d);
this.push(w)}this.position=0}},MO.FCheckPickerEditor_linkControl=function(b){if(this.source==b)return!1;this.source=b;RLog.debug(this,"link Panel (panel={0}, edit={1})",RClass.dump(b.hEditCell),RClass.dump(b.hEdit));RHtml.toRect(this.rect,b.hEditCell);RHtml.setPixelRect(this.hPanel,this.rect);this.hPanel.style.pixelTop=this.rect.bottom;var d=this.border.hForm;d.style.pixelWidth=b.editBorder.hForm.width;d.style.pixelHeight=b.editBorder.hForm.height;return!0},MO.FCheckPickerEditor_show=function(b){this.base.FDropEditor.show.call(this,
b);RConsole.find(FFocusConsole).focus(this);this.border.hForm.offsetWidth<this.MinWidth&&(this.border.hForm.style.pixelWidth=this.MinWidth);this.base.MShadow.show.call(this,b);this.isSkipBlur=!1},MO.FCheckPickerEditor_hide=function(){this.source=null;this.base.FDropEditor.hide.call(this);this.base.MShadow.hide.call(this)},MO.FCheckPickerEditor_dispose=function(){this.base.FDropEditor.dispose.call(this);RMemory.freeHtml(this.hPanel);RMemory.freeHtml(this.hItemsForm);RMemory.freeHtml(this.hItemsPanel);
RMemory.freeHtml(this.hBtnTextSpan);RMemory.freeHtml(this.hDropPanel);RMemory.freeHtml(this.hButtonPanel);this.hButtonPanel=this.hDropPanel=this.hBtnTextSpan=this.hItemsPanel=this.hItemsForm=this.hPanel=null};
with(MO)MO.FUiColor=function(b){b=RClass.inherits(this,b,FEditControl);b._inputSize=RClass.register(b,new APtySize2("_inputSize"));b._styleInputPanel=RClass.register(b,new AStyle("_styleInputPanel"));b._styleInput=RClass.register(b,new AStyle("_styleInput"));b._hInput=null;b.onBuildEditValue=FUiColor_onBuildEditValue;b.construct=FUiColor_construct;b.get=FUiColor_get;b.set=FUiColor_set;return b},MO.FUiColor_oeDataLoad=function(b){alert(b);return EEventStatus.Stop},MO.FUiColor_oeDataSave=function(b){return EEventStatus.Stop},
MO.FUiColor_onBuildEditValue=function(b){b=this._hValuePanel;b.className=this.styleName("InputPanel");b=this._hInput=RBuilder.appendEdit(b,this.styleName("Input"));this._editLength&&(b.maxLength=this._editLength)},MO.FUiColor_construct=function(){this.__base.FEditControl.construct.call(this);this._inputSize=new SSize2(120,0)},MO.FUiColor_get=function(b){b=this.__base.FEditControl.get.call(this,b);var d=this._hInput;d&&(b=d.value);return b},MO.FUiColor_set=function(b){this.__base.FEditControl.set.call(this,
b);var d=this._hInput;d&&(d.value=RString.nvl(b))},MO.FUiColor_onDataKeyDown=function(b,d){this.__base.FEditControl.onDataKeyDown.call(this,b,d);this.editCase&&RKey.fixCase(d,this.editCase)},MO.FUiColor_formatValue=function(b){b=RString.nvl(b);ECase.Upper==this.editCase?b=RString.toUpper(b):ECase.Lower==this.editCase&&(b=RString.toLower(b));return b},MO.FUiColor_setText=function(b){this.hEdit&&(this.hEdit.value="U"==this.editCase?RString.toUpper(b):"L"==this.editCase?RString.toLower(b):b,this.hEdit.style.textAlign=
"right"==this.editAlign?"right":"left"==this.editAlign?"left":"center")},MO.FUiColor_validText=function(b){var d=this.__base.FEditControl.validText.call(this,b);if(!d){if(this.validLenmin&&this.validLenmin>b.length)return RContext.get("MDescEdit:ValidMinLength",this.validLenmin);if(this.validLenmax&&this.validLenmax<b.length)return RContext.get("MDescEdit:ValidMaxLength",this.validLenmax)}return d},MO.FUiColor_findEditor=function(){if(this.editComplete){var b=this.editor;!b&&(this.dsControl=this.topControl(MDataset))&&
(b=this.editor=RConsole.find(FUiColorConsole).focus(this,FUiColorEditor));b&&b.linkControl(this);return this.editor}},MO.FUiColor_drop=function(){var b=this.findEditor();if(b){var d=this.reget();0<d.length&&(this.finded!=d&&(b.source!=this&&b.linkControl(this),b.search(d)),this.finded=d)}},MO.FUiColor_clone=function(){var b=this._class.newInstance();GHtml_clone(b,this.hPanel);return b},MO.FUiColor_link=function(){};
with(MO)MO.FUiColor3Tpl=function(b){b=RClass.inherits(this,b,FEditControl,MListenerDataChanged);b._inputSize=RClass.register(b,new APtySize2("_inputSize"));b._styleValuePanel=RClass.register(b,new AStyle("_styleValuePanel"));b._styleInput=RClass.register(b,new AStyle("_styleInput"));b._innerOriginValue=null;b._innerDataValue=null;b._hInputRed=null;b._hInputGreen=null;b._hInputBlue=null;b.onBuildEditValue=FUiColor3Tpl_onBuildEditValue;b.onInputKeyPress=RClass.register(b,new AEventKeyPress("onInputKeyPress"),
FUiColor3Tpl_onInputKeyPress);b.onInputChanged=RClass.register(b,new AEventInputChanged("onInputChanged"),FUiColor3Tpl_onInputChanged);b.construct=FUiColor3Tpl_construct;b.get=FUiColor3Tpl_get;b.set=FUiColor3Tpl_set;return b},MO.FUiColor3Tpl_onBuildEditValue=function(b){var d=this._hValuePanel;d.className=this.styleName("ValuePanel");d=this._hValueForm=RBuilder.appendTable(d);d.width="100%";d=this._hValueLine=RBuilder.appendTableRow(d);this._hChangePanel=RBuilder.appendTableCell(d);this.onBuildEditChange(b);
var f=RBuilder.appendTableCell(d);f.style.borderRight="1px solid #666666";f=this._hInputRed=RBuilder.appendEdit(f,this.styleName("Input"));this.attachEvent("onInputKeyPress",f,this.onInputKeyPress);this.attachEvent("onInputChanged",f,this.onInputChanged);f=RBuilder.appendTableCell(d);f.style.borderLeft="1px solid #999999";f.style.borderRight="1px solid #666666";f=this._hInputGreen=RBuilder.appendEdit(f,this.styleName("Input"));this.attachEvent("onInputKeyPress",f,this.onInputKeyPress);this.attachEvent("onInputChanged",
f,this.onInputChanged);f=RBuilder.appendTableCell(d);f.style.borderLeft="1px solid #999999";f=this._hInputBlue=RBuilder.appendEdit(f,this.styleName("Input"));this.attachEvent("onInputKeyPress",f,this.onInputKeyPress);this.attachEvent("onInputChanged",f,this.onInputChanged);(this._hDropPanel=RBuilder.appendTableCell(d)).style.borderLeft="1px solid #666666";this.onBuildEditDrop(b)},MO.FUiColor3Tpl_onInputKeyPress=function(b){EKeyCode.floatCodes[b.keyCode]||b.cancel()},MO.FUiColor3Tpl_onInputChanged=
function(b){this.processDataChangedListener(this)},MO.FUiColor3Tpl_construct=function(){this.__base.FEditControl.construct.call(this);this._inputSize=new SSize2(120,0);this._innerOriginValue=new SColor4;this._innerDataValue=new SColor4},MO.FUiColor3Tpl_get=function(b){b=this._innerDataValue;var d=this._hInputRed;d&&(b.red=RFloat.parse(d.value));if(d=this._hInputGreen)b.green=RFloat.parse(d.value);if(d=this._hInputBlue)b.blue=RFloat.parse(d.value);return b},MO.FUiColor3Tpl_set=function(b){this.__base.FEditControl.set.call(this,
b);if(b.constructor==SColor4)this._innerOriginValue.assign(b),this._innerDataValue.assign(b);else throw new TError("Invalid value format.");b=this._innerDataValue;var d=this._hInputRed;d&&(d.value=RFloat.format(b.red,0,null,2,null));if(d=this._hInputGreen)d.value=RFloat.format(b.green,0,null,2,null);if(d=this._hInputBlue)d.value=RFloat.format(b.blue,0,null,2,null);this.changeSet(!1)},MO.FUiColor3Tpl_onDataKeyDown=function(b,d){this.__base.FEditControl.onDataKeyDown.call(this,b,d);this.editCase&&RKey.fixCase(d,
this.editCase)},MO.FUiColor3Tpl_formatValue=function(b){b=RString.nvl(b);ECase.Upper==this.editCase?b=RString.toUpper(b):ECase.Lower==this.editCase&&(b=RString.toLower(b));return b},MO.FUiColor3Tpl_setText=function(b){this.hEdit&&(this.hEdit.value="U"==this.editCase?RString.toUpper(b):"L"==this.editCase?RString.toLower(b):b,this.hEdit.style.textAlign="right"==this.editAlign?"right":"left"==this.editAlign?"left":"center")},MO.FUiColor3Tpl_validText=function(b){var d=this.__base.FEditControl.validText.call(this,
b);if(!d){if(this.validLenmin&&this.validLenmin>b.length)return RContext.get("MDescEdit:ValidMinLength",this.validLenmin);if(this.validLenmax&&this.validLenmax<b.length)return RContext.get("MDescEdit:ValidMaxLength",this.validLenmax)}return d},MO.FUiColor3Tpl_findEditor=function(){if(this.editComplete){var b=this.editor;!b&&(this.dsControl=this.topControl(MDataset))&&(b=this.editor=RConsole.find(FUiColor3TplConsole).focus(this,FUiColor3TplEditor));b&&b.linkControl(this);return this.editor}},MO.FUiColor3Tpl_drop=
function(){var b=this.findEditor();if(b){var d=this.reget();0<d.length&&(this.finded!=d&&(b.source!=this&&b.linkControl(this),b.search(d)),this.finded=d)}},MO.FUiColor3Tpl_clone=function(){var b=this._class.newInstance();GHtml_clone(b,this.hPanel);return b},MO.FUiColor3Tpl_link=function(){};
with(MO)MO.FUiColor4=function(b){b=RClass.inherits(this,b,FEditControl);b._inputSize=RClass.register(b,new APtySize2("_inputSize"));b._styleInputPanel=RClass.register(b,new AStyle("_styleInputPanel"));b._styleInput=RClass.register(b,new AStyle("_styleInput"));b._hInput=null;b.onBuildEditValue=FUiColor4_onBuildEditValue;b.construct=FUiColor4_construct;b.get=FUiColor4_get;b.set=FUiColor4_set;return b},MO.FUiColor4_oeDataLoad=function(b){alert(b);return EEventStatus.Stop},MO.FUiColor4_oeDataSave=function(b){return EEventStatus.Stop},
MO.FUiColor4_onBuildEditValue=function(b){b=this._hValuePanel;b.className=this.styleName("InputPanel");b=this._hInput=RBuilder.appendEdit(b,this.styleName("Input"));this._editLength&&(b.maxLength=this._editLength)},MO.FUiColor4_construct=function(){this.__base.FEditControl.construct.call(this);this._inputSize=new SSize2(120,0)},MO.FUiColor4_get=function(b){b=this.__base.FEditControl.get.call(this,b);var d=this._hInput;d&&(b=d.value);return b},MO.FUiColor4_set=function(b){this.__base.FEditControl.set.call(this,
b);var d=null;if(b.constructor==SColor4){var d=RFloat.format(b.red,0,null,3,null),f=RFloat.format(b.green,0,null,3,null);b=RFloat.format(b.blue,0,null,3,null);d=d+","+f+","+b}if(b=this._hInput)b.value=d},MO.FUiColor4_onDataKeyDown=function(b,d){this.__base.FEditControl.onDataKeyDown.call(this,b,d);this.editCase&&RKey.fixCase(d,this.editCase)},MO.FUiColor4_formatValue=function(b){b=RString.nvl(b);ECase.Upper==this.editCase?b=RString.toUpper(b):ECase.Lower==this.editCase&&(b=RString.toLower(b));return b},
MO.FUiColor4_setText=function(b){this.hEdit&&(this.hEdit.value="U"==this.editCase?RString.toUpper(b):"L"==this.editCase?RString.toLower(b):b,this.hEdit.style.textAlign="right"==this.editAlign?"right":"left"==this.editAlign?"left":"center")},MO.FUiColor4_validText=function(b){var d=this.__base.FEditControl.validText.call(this,b);if(!d){if(this.validLenmin&&this.validLenmin>b.length)return RContext.get("MDescEdit:ValidMinLength",this.validLenmin);if(this.validLenmax&&this.validLenmax<b.length)return RContext.get("MDescEdit:ValidMaxLength",
this.validLenmax)}return d},MO.FUiColor4_findEditor=function(){if(this.editComplete){var b=this.editor;!b&&(this.dsControl=this.topControl(MDataset))&&(b=this.editor=RConsole.find(FUiColor4Console).focus(this,FUiColor4Editor));b&&b.linkControl(this);return this.editor}},MO.FUiColor4_drop=function(){var b=this.findEditor();if(b){var d=this.reget();0<d.length&&(this.finded!=d&&(b.source!=this&&b.linkControl(this),b.search(d)),this.finded=d)}},MO.FUiColor4_clone=function(){var b=this._class.newInstance();
GHtml_clone(b,this.hPanel);return b},MO.FUiColor4_link=function(){};
with(MO)MO.FUiColorPicker=function(b){b=RClass.inherits(this,b,FEditControl,MEditBorder,MDescColor,MDropable);b.borderStyle=EUiBorder.RoundDrop;b.onBuildEdit=FUiColorPicker_onBuildEdit;b.onEditEnd=FUiColorPicker_onEditEnd;b.onDataKeyDown=FUiColorPicker_onDataKeyDown;b.checkColor=FUiColorPicker_checkColor;b.setText=FUiColorPicker_setText;b.drop=FUiColorPicker_drop;b.dispose=FUiColorPicker_dispose;return b},MO.FUiColorPicker_onBuildEdit=function(b){(this.hEdit=RBuilder.appendEdit(b.hPanel,this.style("Edit"))).maxLength=
20},MO.FUiColorPicker_onEditEnd=function(b){RLog.debug(this,"Begin (editor={0}:{1} value={2})",b,b?b.color:"",this.dataValue);b&&(this.set(b.color),this.hDrop.style.backgroundColor=b.color);this.onDataEditEnd(this);RLog.debug(this,"End (editor={0} value={1})",b,this.dataValue)},MO.FUiColorPicker_setText=function(b){this.base.FEditControl.setText.call(this,RString.toUpper(b));this.hDrop.style.backgroundColor=b},MO.FUiColorPicker_checkColor=function(b){return""!=document.createElement("<span style='color:"+
b+";'></span>").style.color?!0:!1},MO.FUiColorPicker_onDataKeyDown=function(b){this.base.FEditControl.onDataKeyDown.call(this,this,b);this.checkColor(this.text())?this.hDrop.style.backgroundColor=this.text():this.hDrop.style.backgroundColor=""},MO.FUiColorPicker_drop=function(){if(this.canDrop()&&this.canEdit){var b=this.editor=RConsole.find(FEditConsole).focus(this,FUiColorPickerEditor,this.name);b.linkControl(this)&&b.set(this.reget());b.show()}},MO.FUiColorPicker_dispose=function(){this.base.FEditControl.dispose.call(this);
RMemory.freeHtml(this.hEdit);RMemory.freeHtml(this.hDrop);this.hDrop=this.hEdit=null};
with(MO)MO.FColorPickerEditor=function(b){b=RClass.inherits(this,b,FDropEditor,MShadow);b.MinWidth=240;b.ColorHex="00 33 66 99 CC FF".split(" ");b.SpColorHex="FF0000 00FF00 0000FF FFFF00 00FFFF FF00FF".split(" ");b.onCellEnter=RClass.register(b,new HMouseOver("onCellEnter"),FColorPickerEditor_onCellEnter);b.onCellSelect=RClass.register(b,new HMouseDown("onCellSelect"),FColorPickerEditor_onCellSelect);b.color=null;b.hTable=null;b.cellWidth=16;b.cellHeight=10;b.onBuildDrop=FColorPickerEditor_onBuildDrop;
b.onKeyDown=FColorPickerEditor_onKeyDown;b.onCellSelect=FColorPickerEditor_onCellSelect;b.onEditEnd=FColorPickerEditor_onEditEnd;b.makeCell=FColorPickerEditor_makeCell;b.set=FColorPickerEditor_set;b.show=FColorPickerEditor_show;b.hide=FColorPickerEditor_hide;b.linkControl=FColorPickerEditor_linkControl;b.dispose=FColorPickerEditor_dispose;return b},MO.FColorPickerEditor_onBuildDrop=function(){this.hTable=RBuilder.appendTable(this.hDropPanel);for(var b=0;2>b;b++)for(var d=0;6>d;d++){var f=this.hTable.insertRow();
this.makeCell(f,"#000000");0==b?this.makeCell(f,"#"+this.ColorHex[d]+this.ColorHex[d]+this.ColorHex[d]):this.makeCell(f,"#"+this.SpColorHex[d]);this.makeCell(f,"#000000");for(k=0;3>k;k++)for(l=0;6>l;l++)this.makeCell(f,"#"+this.ColorHex[k+3*b]+this.ColorHex[l]+this.ColorHex[d])}},MO.FColorPickerEditor_linkControl=function(b){if(this.source==b)return!1;this.source=b;RLog.debug(this,"link Panel (panel={0}, edit={1})",RClass.dump(b.hEditCell),RClass.dump(b.hEdit));RHtml.toRect(this.rect,b.hEditCell);
RHtml.setPixelRect(this.hPanel,this.rect);this.hPanel.style.pixelTop=this.rect.bottom;var d=this.border.hForm;d.style.pixelWidth=b.editBorder.hForm.width;d.style.pixelHeight=b.editBorder.hForm.height;return!0},MO.FColorPickerEditor_onCellEnter=function(b){this.editable.hDrop.style.backgroundColor=b.hSource.style.backgroundColor},MO.FColorPickerEditor_onCellSelect=function(b){this.color=b.srcElement.style.backgroundColor;this.editStatus=EEditStatus.Ok;this.blur()},MO.FColorPickerEditor_makeCell=function(b,
d){var f=b.insertCell();f.link=this;f.width=this.cellWidth;f.height=this.cellHeight;f.style.backgroundColor=d;this.attachEvent("onCellEnter",f);this.attachEvent("onCellSelect",f);return f},MO.FColorPickerEditor_onKeyDown=function FColorPickerEditor_onKeyDown(d){alert(FColorPickerEditor_onKeyDown);var f=d.keyCode;EKey.Up==f?this.select(this.selectIndex-1):EKey.Down==f?this.select(this.selectIndex+1):EKey.Esc==f?(this.editStatus=EEditStatus.Cancel,this.selectIndex=this.originIndex,RKey.eventClear(d),
this.inEdit=!1,this.hEdit.blur()):EKey.Enter==f&&(this.editStatus=EEditStatus.Ok,RKey.eventClear(d),this.inEdit=!1,this.hEdit.blur())},MO.FColorPickerEditor_set=function(b){this.color=b},MO.FColorPickerEditor_show=function(b){this.base.FDropEditor.show.call(this,b);RConsole.find(FFocusConsole).focus(this);this.border.hForm.offsetWidth<this.MinWidth&&(this.border.hForm.style.pixelWidth=this.MinWidth);this.base.MShadow.show.call(this,b);this.isSkipBlur=!1},MO.FColorPickerEditor_onEditEnd=function(){var b=
this.editable;RLog.debug(this,"Edit end (editable={0}, status={1})",RClass.dump(b),REnum.decode(EEditStatus,this.editStatus));if(b){b.hDrop.style.backgroundColor=this.color;var d=RConsole.find(FEventConsole);EEditStatus.Cancel==this.editStatus?d.add(b,b.focus):EEditStatus.Ok==this.editStatus&&(b.onEditEnd(this),d.add(b,b.focus))}this.editable=null;this.inEdit=!1},MO.FColorPickerEditor_hide=function(){this.source=null;this.base.FDropEditor.hide.call(this);this.base.MShadow.hide.call(this)},MO.FColorPickerEditor_dispose=
function(){this.base.FDropEditor.dispose.call(this);RMemory.freeHtml(this.hTable);RMemory.freeHtml(this.hDropPanel);RMemory.freeHtml(this.hEdit);this.hEdit=this.hDropPanel=this.hTable=null};
with(MO)MO.FUiColorPower=function(b){b=RClass.inherits(this,b,FUiEditControl,MListenerDataChanged,MMouseCapture);b._inputSize=RClass.register(b,new APtySize2("_inputSize"));b._valueMin=RClass.register(b,new APtyNumber("_valueMin"));b._valueMax=RClass.register(b,new APtyNumber("_valueMax"));b._styleValuePanel=RClass.register(b,new AStyle("_styleValuePanel"));b._styleInputPanel=RClass.register(b,new AStyle("_styleInputPanel"));b._styleInput=RClass.register(b,new AStyle("_styleInput"));b._innerOriginValue=
null;b._innerDataValue=null;b._barRed=null;b._barGreen=null;b._barBlue=null;b._barPower=null;b._hColorPanel=null;b._hColorImage=null;b._hChannelPanel=null;b._hChannelForm=null;b.onBuildEditValue=FUiColorPower_onBuildEditValue;b.onMouseCaptureStart=FUiColorPower_onMouseCaptureStart;b.onMouseCapture=FUiColorPower_onMouseCapture;b.onMouseCaptureStop=FUiColorPower_onMouseCaptureStop;b.onInputKeyPress=RClass.register(b,new AEventKeyPress("onInputKeyPress"),FUiColorPower_onInputKeyPress);b.onInputEdit=
RClass.register(b,new AEventInputChanged("onInputEdit"),FUiColorPower_onInputEdit);b.onInputChange=RClass.register(b,new AEventChange("onInputChange"),FUiColorPower_onInputChange);b.construct=FUiColorPower_construct;b.get=FUiColorPower_get;b.set=FUiColorPower_set;b.setDisplayColor=FUiColorPower_setDisplayColor;b.setDisplay=FUiColorPower_setDisplay;b.refreshValue=FUiColorPower_refreshValue;b.dispose=FUiColorPower_dispose;return b},MO.FUiColorPower_onBuildEditValue=function(b){var d=this._hValuePanel;
d.className=this.styleName("ValuePanel");d=this._hValueForm=RBuilder.appendTable(d);d.width="100%";d=this._hValueLine=RBuilder.appendTableRow(d);this._hChangePanel=RBuilder.appendTableCell(d);this.onBuildEditChange(b);b=this._hColorPanel=RBuilder.appendTableCell(d);b.width=16;b.style.padding="2px";this._hColorImage=RBuilder.appendIcon(b,null,"n",14,65);b=this._hChannelPanel=RBuilder.appendTableCell(d);b=this._hChannelForm=RBuilder.appendTable(b,null,0,1,0);b.__linker=this;b.width="100%";d=this._barRed=
new SUiColorChannel;d.control=this;d.typeCd="red";d.hPanel=b;d.build();d=this._barGreen=new SUiColorChannel;d.control=this;d.typeCd="green";d.hPanel=b;d.build();d=this._barBlue=new SUiColorChannel;d.control=this;d.typeCd="blue";d.hPanel=b;d.build();d=this._barPower=new SUiColorPower;d.control=this;d.typeCd="power";d.setRange(this._valueMin,this._valueMax);d.hPanel=b;d.build()},MO.FUiColorPower_onMouseCaptureStart=function(b){var d=RHtml.searchObject(b.hSource,"__pbar");if(d)d.onMouseDown(b)},MO.FUiColorPower_onMouseCapture=
function(b){var d=RHtml.searchObject(b.hSource,"__pbar");if(d)d.onMouseMove(b)},MO.FUiColorPower_onMouseCaptureStop=function(b){var d=RHtml.searchObject(b.hSource,"__pbar");if(d)d.onMouseUp(b)},MO.FUiColorPower_onInputKeyPress=function(b){var d=b.keyCode;RKeyboard.isControlKey(d)||RKeyboard.isFloatKey(d)||b.cancel()},MO.FUiColorPower_onInputEdit=function(b){(b=b.hSender._pbar)&&b.changeInputEdit();this.processDataChangedListener(this)},MO.FUiColorPower_onInputChange=function(b){(b=b.hSender._pbar)&&
b.changeInputChange();this.processDataChangedListener(this)},MO.FUiColorPower_construct=function(){this.__base.FUiEditControl.construct.call(this);this._inputSize=new SSize2(120,0);this._innerOriginValue=new SColor4;this._innerDataValue=new SColor4},MO.FUiColorPower_get=function(b){b=this._innerDataValue;b.red=this._barRed.get();b.green=this._barGreen.get();b.blue=this._barBlue.get();b.alpha=this._barPower.get();return b},MO.FUiColorPower_set=function(b){this.__base.FUiEditControl.set.call(this,b);
if(b.constructor==SColor4)this._innerOriginValue.assign(b),this._innerDataValue.assign(b);else throw new TError("Invalid value format.");this.setDisplayColor();b=this._innerDataValue;this._barRed.set(b.red);this._barGreen.set(b.green);this._barBlue.set(b.blue);this._barPower.set(b.alpha);this.changeSet(!1)},MO.FUiColorPower_setDisplayColor=function(){var b=this._innerDataValue,d=b.alpha,f=RHex.format(RInteger.toRange(parseInt(b.red*d*255),0,255),2),h=RHex.format(RInteger.toRange(parseInt(b.green*
d*255),0,255),2),b=RHex.format(RInteger.toRange(parseInt(b.blue*d*255),0,255),2);this._hColorImage.style.backgroundColor="#"+f+h+b},MO.FUiColorPower_setDisplay=function(){this.setDisplayColor();var b=this._innerDataValue;this._barRed.set(b.red);this._barGreen.set(b.green);this._barBlue.set(b.blue);this._barPower.set(b.alpha)},MO.FUiColorPower_refreshValue=function(){this.get();this.setDisplayColor();this.processDataChangedListener(this)},MO.FUiColorPower_dispose=function(b){this.__base.FUiEditControl.dispose.call(this,
b)};
with(MO)MO.FUiDateTime=function(b){b=RClass.inherits(this,b,FUiEditControl,MUiDropable);b.editDispMode=RClass.register(b,new APtySet("editDisplay","editDate",EDateTimeMode.Display));b.editYear=RClass.register(b,new APtySet("editYear","editDate",EDateTimeMode.Year));b.editMonth=RClass.register(b,new APtySet("editMonth","editDate",EDateTimeMode.Month));b.editDay=RClass.register(b,new APtySet("editDay","editDate",EDateTimeMode.Day));b._date=null;b.borderStyle=EUiBorder.RoundDrop;b.lsnEditEnd=null;b.hYearPanel=
null;b.hYear=null;b.hMonthPanel=null;b.hMonth=null;b.hDayPanel=null;b.hDay=null;b.onKeyPress=FUiDateTime_onKeyPress;b.onEditEnd=FUiDateTime_onEditEnd;b.onBuildEdit=FUiDateTime_onBuildEdit;b.oeSaveValue=FUiDateTime_oeSaveValue;b.construct=FUiDateTime_construct;b.formatValue=FUiDateTime_formatValue;b.text=FUiDateTime_text;b.setText=FUiDateTime_setText;b.validText=FUiDateTime_validText;b.setEditable=FUiDateTime_setEditable;b.refreshStyle=FUiDateTime_refreshStyle;b.drop=FUiDateTime_drop;b.dispose=FUiDateTime_dispose;
return b},MO.FUiDateTime_onKeyPress=function(b){RString.inChars(String.fromCharCode(b.keyCode),RDate.Chars)||RKey.eventClear(b)},MO.FUiDateTime_onEditEnd=function(b){b&&this.set(b.get());this.onDataEditEnd(this)},MO.FUiDateTime_onBuildEdit=function(b){b=RBuilder.appendTable(b.hPanel);b.width="100%";b.style.tableLayout="fixed";b=this.hEdit=b.insertRow();this.onBuildChange(b.insertCell());var d=oonDateDoubleClickPanel=b.insertCell();d.width="40%";d.style.padding="0 1";d=this.hYear=RBuilder.appendEdit(d);
d.maxLength=4;d.style.border=0;d.style.width="100%";d.style.textAlign="right";d=this.hYearSplit=b.insertCell();d.width=5;d.innerText="-";this.hYear.style.display=this.editYear?"block":"none";this.hYearSplit.style.display=this.editYear?"block":"none";d=this.hMonthPanel=b.insertCell();d.width="20%";d.style.padding="0 1";d=this.hMonth=RBuilder.appendEdit(d);d.maxLength=2;d.style.border=0;d.style.width="100%";d.style.textAlign="right";d=this.hMonthSplit=b.insertCell();d.width=5;d.innerText="-";this.hMonth.style.display=
this.editMonth?"block":"none";this.hMonthSplit.style.display=this.editDay?"block":"none";d=this.hDayPanel=b.insertCell();d.width="20%";d.style.padding="0 1";d=this.hDay=RBuilder.appendEdit(d);d.maxLength=2;d.style.border=0;d.style.width="100%";d.style.textAlign="right";this.hDay.style.display=this.editDay?"block":"none"},MO.FUiDateTime_oeSaveValue=function(b){var d=RString.nvl(this.dataCode,this.dataName);if(!RString.isEmpty(d)){b=b.values;var f=b.get(d);f?b.set(d,this.reget().substring(0,8)+f.substring(8)):
b.set(d,this.reget())}return EEventStatus.Stop},MO.FUiDateTime_construct=function(){this.base.FUiEditControl.construct.call(this);this._date=new TDate;this.lsnEditEnd=new TListener(this,this.onEditEnd)},MO.FUiDateTime_formatValue=function(b){return b?("@now"==b.toLowerCase()?this._date.now():RDate.autoParse(this._date,b),RDate.formatDate(this._date)):RString.nvl(b)},MO.FUiDateTime_text=function(){this._date.setYear(this._date.year);this._date.setMonth(this._date.month);this._date.setDay(this._date.day);
return RDate.formatDate(this._date)},MO.FUiDateTime_setText=function(b){b?(RDate.autoParse(this._date,b),this.hYear.value=RInteger.format(this._date.year,4),this.hMonth.value=RInteger.format(this._date.month,2),this.hDay.value=RInteger.format(this._date.day,2)):(this.hYear.value="",this.hMonth.value="",this.hDay.value="")},MO.FUiDateTime_validText=function(b){return null},MO.FUiDateTime_setEditable=function(b){this.base.FUiEditControl.setEditable.call(this,b);this.hYear.readOnly=!b;this.hMonth.readOnly=
!b;this.hDay.readOnly=!b},MO.FUiDateTime_refreshStyle=function(){this.base.FUiEditControl.refreshStyle.call(this);this.hYear.style.color=this._textColor;this.hYear.style.backgroundColor=this._backColor;this.hMonth.style.color=this._textColor;this.hMonth.style.backgroundColor=this._backColor;this.hDay.style.color=this._textColor;this.hDay.style.backgroundColor=this._backColor},MO.FUiDateTime_drop=function(){if(this.canDrop()&&this._editable){var b=this.editor=RConsole.find(FEditConsole).focus(this,
FUiDateTimeEditor,this.editRefer);b.set(RDate.formatDate(this._date));b.setYearVisible(this.editYear);b.setMonthVisible(this.editMonth);b.setDayVisible(this.editDay);b.lsnEditEnd=this.lsnEditEnd;b.show()}},MO.FUiDateTime_dispose=function(){this.base.FUiEditControl.dispose.call(this);this._date=null};
with(MO)MO.FUiDateTimeEditor=function(b){b=RClass.inherits(this,b,FUiDropEditor);b.date=null;b.years=null;b.months=null;b.days=null;b.hPanelDay=null;b.hPanelMonth=null;b.hPanelYear=null;b.hTitleDay=null;b.hTitleMonth=null;b.hTitleYear=null;b.onButtonEnter=RClass.register(b,new AEventMouseEnter("onButtonEnter"),FUiDateTimeEditor_onButtonEnter);b.onButtonLeave=RClass.register(b,new AEventMouseLeave("onButtonLeave"),FUiDateTimeEditor_onButtonLeave);b.onYearClick=RClass.register(b,new AEventMouseDown("onYearClick"),
FUiDateTimeEditor_onYearClick);b.onMonthClick=RClass.register(b,new AEventMouseDown("onMonthClick"),FUiDateTimeEditor_onMonthClick);b.onDayClick=RClass.register(b,new AEventMouseDown("onDayClick"),FUiDateTimeEditor_onDayClick);b.onDateDoubleClick=RClass.register(b,new AEventDoubleClick("onDateDoubleClick"),FUiDateTimeEditor_onDateDoubleClick);b.onNowClick=RClass.register(b,new AEventMouseDown("onNowClick"),FUiDateTimeEditor_onNowClick);b.onConfirmClick=RClass.register(b,new AEventMouseDown("onConfirmClick"),
FUiDateTimeEditor_onConfirmClick);b.onBuildDrop=FUiDateTimeEditor_onBuildDrop;b.onBuildButton=FUiDateTimeEditor_onBuildButton;b.construct=FUiDateTimeEditor_construct;b.buildTitle=FUiDateTimeEditor_buildTitle;b.get=FUiDateTimeEditor_get;b.set=FUiDateTimeEditor_set;b.resetDay=FUiDateTimeEditor_resetDay;b.setYearVisible=FUiDateTimeEditor_setYearVisible;b.setMonthVisible=FUiDateTimeEditor_setMonthVisible;b.setDayVisible=FUiDateTimeEditor_setDayVisible;b.selectCell=FUiDateTimeEditor_selectCell;b.restore=
FUiDateTimeEditor_restore;b.show=FUiDateTimeEditor_show;b.dispose=FUiDateTimeEditor_dispose;return b},MO.FUiDateTimeEditor_onButtonEnter=function(b){!b.hSource.isSelect&&RString.isEmpty(b.hSource.innerText)&&(b.hSource.style.backgroundColor="#CCCCFF")},MO.FUiDateTimeEditor_onButtonLeave=function(b){b.hSource.isSelect||(b.hSource.style.backgroundColor="#FFFFFF")},MO.FUiDateTimeEditor_onYearClick=function(b){this.date.setYear(b.hSource.innerText);this.restore();this.resetDay()},MO.FUiDateTimeEditor_onMonthClick=
function(b){this.date.setMonth(b.hSource.innerText);this.restore();this.resetDay()},MO.FUiDateTimeEditor_onDayClick=function(b){RString.equals(b.hSource.innerText,".")||(this.date.setDay(b.hSource.innerText),this.restore())},MO.FUiDateTimeEditor_onDateDoubleClick=function(){this.onConfirmClick()},MO.FUiDateTimeEditor_onNowClick=function(){this.date=new TDate;this.editEnd()},MO.FUiDateTimeEditor_onConfirmClick=function(){this.date.setYear(this.hYear.value);this.date.setMonth(this.hMonth.value);this.date.setDay(this.hDay.value);
this.editEnd()},MO.FUiDateTimeEditor_onBuildDrop=function(){var b=this.hDropPanel;b.width=220;this.attachEvent("onDateDoubleClick",b);this.hTitleYear=this.buildTitle("Year",4);var d=this.hPanelYear=this.hSelectPanel=RBuilder.appendTable(b);d.width="100%";for(var f=0;4>f;f++)for(var h=d.insertRow(),q=0;4>q;q++){var w=h.insertCell();w.innerText=RInteger.format(2E3+4*f+q,2);w.align="center";w.style.padding="1 6";w.style.cursor="hand";w.style.borderBottom="1 solid #EEEEEE";5>q&&(w.style.borderRight="1 solid #EEEEEE");
this.attachEvent("onButtonEnter",w);this.attachEvent("onButtonLeave",w);this.attachEvent("onYearClick",w);this.years.push(w)}this.hTitleMonth=this.buildTitle("Month",2);d=this.hPanelMonth=this.hSelectPanel=RBuilder.appendTable(b);d.width="100%";for(f=0;2>f;f++)for(h=d.insertRow(),q=0;6>q;q++)w=h.insertCell(),w.innerText=RInteger.format(6*f+q+1,2),w.align="center",w.style.cursor="hand",w.style.borderBottom="1 solid #EEEEEE",5>q&&(w.style.borderRight="1 solid #EEEEEE"),this.attachEvent("onButtonEnter",
w),this.attachEvent("onButtonLeave",w),this.attachEvent("onMonthClick",w),this.months.push(w);this.hTitleDay=this.buildTitle("Day",2);d=this.hPanelDay=this.hSelectPanel=RBuilder.appendTable(b);d.width="100%";for(f=0;5>f;f++)for(h=d.insertRow(),q=0;7>q;q++)b=7*f+q+1,31<b||(w=h.insertCell(),w.innerText=RInteger.format(b,2),w.align="center",w.style.borderBottom="1 solid #EEEEEE",w.style.cursor="hand",5>q&&(w.style.borderRight="1 solid #EEEEEE"),this.attachEvent("onButtonEnter",w),this.attachEvent("onButtonLeave",
w),this.attachEvent("onDayClick",w),this.days.push(w))},MO.FUiDateTimeEditor_onBuildButton=function(){this.base.FUiDropEditor.onBuildButton.call(this);var b=RBuilder.appendTable(this.hButtonPanel);b.width="100%";b.height=20;b.style.filter="progid:DXImageTransform.Microsoft.Gradient(startColorStr='#EEEEEE', endColorStr='#FFFFFF', gradientType='0')";var b=b.insertRow(),d=b.insertCell();d.style.padding="0 6";d=this.hNow=RBuilder.append(d,"SPAN");d.style.cursor="hand";this.attachEvent("onNowClick",d);
d.innerText=RContext.get("FDate:Now");d=b.insertCell();d.style.padding="0 6";d.align="right";d=this.hNow=RBuilder.append(d,"SPAN");d.style.cursor="hand";this.attachEvent("onConfirmClick",d);d.innerText=RContext.get("FDate:Confirm")},MO.FUiDateTimeEditor_construct=function(){this.base.FUiDropEditor.construct.call(this);this.date=new TDate;this.years=new TList;this.months=new TList;this.days=new TList},MO.FUiDateTimeEditor_buildTitle=function(b,d){var f=RBuilder.appendTable(this.hDropPanel);f.width=
"100%";f.style.borderBottom="1 solid #999999";f.style.filter="progid:DXImageTransform.Microsoft.Gradient(startColorStr='#FFFFFF', endColorStr='#E5FAFE', gradientType='0')";f.style.backgroundColor="#F8F8F8";f.style.padding="2 6";var h=f.insertRow(),q=h.insertCell();q.width=60;q=this["h"+b]=RBuilder.appendEdit(q);q.style.width="100%";q.style.textAlign="right";q.style.border="1 solid #CCCCCC";q.maxLength=d;q=h.insertCell();q.innerText=RContext.get("FDate:"+b);return f},MO.FUiDateTimeEditor_get=function(){return RDate.formatDate(this.date)},
MO.FUiDateTimeEditor_set=function(b){RDate.autoParse(this.date,b);this.restore()},MO.FUiDateTimeEditor_setYearVisible=function(b){this.hPanelYear.style.display=b?"block":"none";this.hTitleYear.style.display=b?"block":"none"},MO.FUiDateTimeEditor_setMonthVisible=function(b){this.hPanelMonth.style.display=b?"block":"none";this.hTitleMonth.style.display=b?"block":"none"},MO.FUiDateTimeEditor_setDayVisible=function(b){this.hPanelDay.style.display=b?"block":"none";this.hTitleDay.style.display=b?"block":
"none"},MO.FUiDateTimeEditor_show=function(b){this.base.FUiDropEditor.show.call(this,b);b=this.hPanel;var d=this.source.getEditRange();b.style.pixelLeft=d.x;b.style.pixelTop=d.y+d.height;b.style.pixelWidth=220;this.base.MShadow.show.call(this)},MO.FUiDateTimeEditor_resetDay=function(){for(var b=this.date.monthDays(),d=0;d<this.days.count;d++)this.days.get(d).innerText=d>=b?".":RInteger.format(d+1,2)},MO.FUiDateTimeEditor_selectCell=function(b,d){for(var f=b.count,h=0;h<f;h++){var q=b.get(h);q.innerText==
d?(q.style.color="#FFFFFF",q.style.backgroundColor="#9999EE",q.isSelect=!0):(q.style.color="#000000",q.style.backgroundColor="#FFFFFF",q.isSelect=!1)}},MO.FUiDateTimeEditor_restore=function(){this.hYear.value=this.date.year;this.hMonth.value=this.date.month;this.hDay.value=this.date.day;this.selectCell(this.years,this.date.year);this.selectCell(this.months,this.date.month);this.selectCell(this.days,this.date.day)},MO.FUiDateTimeEditor_dispose=function(){this.base.FUiDropEditor.dispose.call(this);
this.hPanel=null};
with(MO)MO.FUiDropEditor=function(b){b=RClass.inherits(this,b,FUiEditor,MUiShadow);b._stylePanel=RClass.register(b,new AStyle("_stylePanel"));b._styleDropForm=RClass.register(b,new AStyle("_styleDropForm"));b._styleDropPanel=RClass.register(b,new AStyle("_styleDropPanel"));b._styleButtonPanel=RClass.register(b,new AStyle("_styleButtonPanel"));b._minWidth=160;b._minHeight=300;b._hDropForm=null;b._hDropPanel=null;b._hButtonPanel=null;b.onBuildDrop=RMethod.virtual(b,"onBuildDrop");b.onBuildButton=RMethod.empty;
b.onBuild=FUiDropEditor_onBuild;b.onDropMouseDown=RClass.register(b,new AEventMouseDown("onDropMouseDown"));b.onDropMouseUp=RClass.register(b,new AEventMouseUp("onDropMouseUp"));b.panel=FUiDropEditor_panel;b.setVisible=FUiDropEditor_setVisible;b.dispose=FUiDropEditor_dispose;return b},MO.FUiDropEditor_onBuild=function(b){this.__base.FUiEditor.onBuild.call(this,b);b=this._hPanel;b.className=this.styleName("Panel");b=this._hDropForm=RBuilder.appendTable(b,this.styleName("DropForm"));this._hDropPanel=
RBuilder.appendTableRowCell(b,this.styleName("DropPanel"));this._hButtonPanel=RBuilder.appendTableRowCell(b,this.styleName("ButtonPanel"));this.onBuildDrop();this.onBuildButton()},MO.FUiDropEditor_panel=function(b){return b==EPanel.Shadow?this.hPanel:this.__base.FUiEditor.panel.call(this,b)},MO.FUiDropEditor_setVisible=function(b){var d=this._hPanel,f=this._hPanel.ownerDocument;b?f.body.appendChild(d):f.body.removeChild(d);this.__base.FUiEditor.setVisible.call(this,b)},MO.FUiDropEditor_dispose=function(){this._hButtonPanel=
RHtml.free(this._hButtonPanel);this._hDropPanel=RHtml.free(this._hDropPanel);this._hDropForm=RHtml.free(this._hDropForm);this.__base.FControl.dispose.call(this)};
with(MO)MO.FUiEdit=function(b){b=RClass.inherits(this,b,FUiEditControl,MPropertyEdit,MListenerDataChanged);b._inputSize=RClass.register(b,new APtySize2("_inputSize"));b._unit=RClass.register(b,new APtyString("_unit"));b._styleValuePanel=RClass.register(b,new AStyle("_styleValuePanel"));b._styleInputPanel=RClass.register(b,new AStyle("_styleInputPanel"));b._styleInput=RClass.register(b,new AStyle("_styleInput"));b._hValueForm=null;b._hValueLine=null;b._hInputPanel=null;b._hInput=null;b.onBuildEditValue=
FUiEdit_onBuildEditValue;b.onInputEdit=RClass.register(b,new AEventInputChanged("onInputEdit"),FUiEdit_onInputEdit);b.construct=FUiEdit_construct;b.formatText=FUiEdit_formatText;b.formatValue=FUiEdit_formatValue;b.text=FUiEdit_text;b.setText=FUiEdit_setText;b.setEditAble=FUiEdit_setEditAble;b.refreshValue=FUiEdit_refreshValue;return b},MO.FUiEdit_onBuildEditValue=function(b){var d=this._hValuePanel;d.className=this.styleName("ValuePanel");d=this._hValueForm=RBuilder.appendTable(d);d.width="100%";
d=this._hValueLine=RBuilder.appendTableRow(d);this._hChangePanel=RBuilder.appendTableCell(d);this.onBuildEditChange(b);b=this._hInputPanel=RBuilder.appendTableCell(d);d=this._hInput=RBuilder.appendEdit(b,this.styleName("Input"));this.attachEvent("onInputEdit",d,this.onInputEdit);RHtml.setSize(b,this._inputSize);this._editLength&&(d.maxLength=this._editLength)},MO.FUiEdit_onInputEdit=function(b){this.refreshValue()},MO.FUiEdit_construct=function(){this.__base.FUiEditControl.construct.call(this);this._inputSize=
new SSize2(120,0)},MO.FUiEdit_formatText=function(b){return this._dataDisplay=b=RString.nvl(b)},MO.FUiEdit_formatValue=function(b){return b},MO.FUiEdit_text=function(){return this._hInput.value},MO.FUiEdit_setText=function(b){this._hInput.value=b},MO.FUiEdit_setEditAble=function(b){this.__base.FUiEditControl.setEditAble.call(this,b);this._hInput.readOnly=!b},MO.FUiEdit_refreshValue=function(){this.processDataChangedListener(this)};
with(MO)MO.FUiEditControl=function(b){b=RClass.inherits(this,b,FDuiControl,MUiEditValue,MUiEditChange,MUiEditDrop);b._labelModeCd=RClass.register(b,new APtyString("_labelModeCd"),EUiLabelMode.All);b._labelPositionCd=RClass.register(b,new APtyString("_labelPositionCd"),EUiLabelPosition.Left);b._labelSize=RClass.register(b,new APtySize2("_labelSize"));b._labelAlignCd=RClass.register(b,new APtyString("_labelAlignCd"),EUiAlign.Left);b._labelColor=RClass.register(b,new APtyString("_labelColor"));b._editSize=
RClass.register(b,new APtySize2("_editSize"));b._editColor=RClass.register(b,new APtyString("_editColor"));b._styleLabelPanel=RClass.register(b,new AStyle("_styleLabelPanel"));b._styleEditPanel=RClass.register(b,new AStyle("_styleEditPanel"));b._progressing=!1;b._hLabelPanel=null;b._hLabelForm=null;b._hIconPanel=null;b._hIcon=null;b._hTextPanel=null;b._hText=null;b._hEditPanel=null;b._hEditForm=null;b._hValuePanel=null;b.onBuildLabelIcon=FUiEditControl_onBuildLabelIcon;b.onBuildLabelText=FUiEditControl_onBuildLabelText;
b.onBuildLabel=FUiEditControl_onBuildLabel;b.onBuildEditValue=RMethod.virtual(b,"onBuildEditValue");b.onBuildEdit=FUiEditControl_onBuildEdit;b.onBuildPanel=FUiEditControl_onBuildPanel;b.onBuild=FUiEditControl_onBuild;b.oeMode=FUiEditControl_oeMode;b.oeProgress=FUiEditControl_oeProgress;b.construct=FUiEditControl_construct;b.panel=FUiEditControl_panel;b.label=FUiEditControl_label;b.setLabel=FUiEditControl_setLabel;b.getValueRectangle=FUiEditControl_getValueRectangle;b.dispose=FUiEditControl_dispose;
return b},MO.FUiEditControl_onBuildLabelIcon=function(b){this._hIcon=this._labelIcon?RBuilder.appendIcon(this._hIconPanel,null,this._labelIcon):RBuilder.appendIcon(this._hIconPanel,null,"n",16,16)},MO.FUiEditControl_onBuildLabelText=function(b){this._hText=RBuilder.appendSpan(this._hTextPanel,null,this._label)},MO.FUiEditControl_onBuildLabel=function(b){var d=this._hLabelForm=RBuilder.appendTable(this._hLabelPanel,this.styleName("LabelPanel")),f=RBuilder.appendTableRow(d);(this._hIconPanel=RBuilder.appendTableCell(f)).width=
"20px";this.onBuildLabelIcon(b);f=this._hTextPanel=RBuilder.appendTableCell(f);f.noWrap=!0;this.onBuildLabelText(b);RHtml.setSize(d,this._labelSize);this._labelAlignCd&&(f.align=this._labelAlignCd,f.style.paddingRight=4);this._labelColor&&(this._hLabel.style.color=this._labelColor)},MO.FUiEditControl_onBuildEdit=function(b){var d=this._hEditForm=RBuilder.appendTable(this._hEditPanel,this.styleName("EditPanel")),f=this._hEditLine=RBuilder.appendTableRow(d);this._hValuePanel=RBuilder.appendTableCell(f);
this.onBuildEditValue(b);RHtml.setSize(d,this._editSize)},MO.FUiEditControl_onBuildPanel=function(b){this._hPanel=RBuilder.createTable(b,this.styleName("Panel"))},MO.FUiEditControl_onBuild=function(b){this.__base.FDuiControl.onBuild.call(this,b);var d=this._hPanel,f=null,h=null,q=this._labelModeCd;q==EUiLabelMode.Label?f=RBuilder.appendTableCell(RBuilder.appendTableRow(d)):q==EUiLabelMode.Hidden?h=RBuilder.appendTableCell(RBuilder.appendTableRow(d)):(f=this._labelPositionCd,f==EUiLabelPosition.Top?
(f=RBuilder.appendTableRowCell(d),h=RBuilder.appendTableRowCell(d)):f==EUiLabelPosition.Right?(d=RBuilder.appendTableRow(d),h=RBuilder.appendTableCell(d),f=RBuilder.appendTableCell(d)):f==EUiLabelPosition.Bottom?(h=RBuilder.appendTableRowCell(d),f=RBuilder.appendTableRowCell(d)):(d=RBuilder.appendTableRow(d),f=RBuilder.appendTableCell(d),h=RBuilder.appendTableCell(d)));this._hLabelPanel=f;this._hEditPanel=h;f&&(this.onBuildLabel(b),f.appendChild(this._hLabelForm),this.setLabel(this._label));if(h)this.onBuildEdit(b)},
MO.FUiEditControl_oeMode=function(b){this.__base.FDuiControl.oeMode.call(this,b);this.__base.MDisplay.oeMode.call(this,b);this._editable=this.canEdit(b.mode);this._validable=this.canValid(b.mode);this._progressing||this.setEditable(this._editable);return EEventStatus.Stop},MO.FUiEditControl_oeProgress=function(b){if(this._progressing&&b.enable)return EEventStatus.Stop;(this._progressing=b.enable)?(b=this._editable,this.setEditable(!1),this._editable=b):this.setEditable(this._editable);return EEventStatus.Stop},
MO.FUiEditControl_construct=function(){this.__base.FDuiControl.construct.call(this);this.__base.MUiEditChange.construct.call(this);this.__base.MUiEditDrop.construct.call(this);this._labelSize=new SSize2(100,20);this._editSize=new SSize2(200,20)},MO.FUiEditControl_panel=function(b){return EPanel.Edit==b||EPanel.Focus==b?this.hEdit:this.__base.FDuiControl.panel.call(this,b)},MO.FUiEditControl_label=function(b){return this._label},MO.FUiEditControl_setLabel=function(b){this._label=b;this._hText&&(this._hText.innerHTML=
RString.nvl(b))},MO.FUiEditControl_getValueRectangle=function(b){b||(b=new SRectangle);var d=this._hValuePanel,f=RHtml.clientPosition(d);b.position.assign(f);b.setSize(d.offsetWidth,d.offsetHeight);return b},MO.FUiEditControl_dispose=function(){this._dataTypeCd=this._labelAlignCd=this._labelPositionCd=this._labelModeCd=null;this._labelSize=RObject.dispose(this._labelSize);this._editSize=RObject.dispose(this._editSize);this._hLabelPanel=RHtml.free(this._hLabelPanel);this._hLabelForm=RHtml.free(this._hLabelForm);
this._hIconPanel=RHtml.free(this._hIconPanel);this._hIcon=RHtml.free(this._hIcon);this._hTextPanel=RHtml.free(this._hTextPanel);this._hText=RHtml.free(this._hText);this._hEditPanel=RHtml.free(this._hEditPanel);this._hEditForm=RHtml.free(this._hEditForm);this._hValuePanel=RHtml.free(this._hValuePanel);this._hDropPanel=RHtml.free(this._hDropPanel);this.__base.MUiEditDrop.dispose.call(this);this.__base.MUiEditChange.dispose.call(this);this.__base.FDuiControl.dispose.call(this)};
with(MO)MO.FUiEditor=function(b){b=RClass.inherits(this,b,FDuiControl,MUiFocus);b._visible=!1;b._statusVisible=!1;b._styleEdit=RClass.register(b,new AStyle("_styleEdit"));b._statusEditing=!1;b._source=null;b._hEdit=null;b.lsnEditBegin=null;b.lsnEditCancel=null;b.lsnEditEnd=null;b.onEditKeyDown=RClass.register(b,new AEventKeyDown("onEditKeyDown"));b.onEditKeyPress=RClass.register(b,new AEventKeyPress("onEditKeyPress"));b.onEditKeyUp=RClass.register(b,new AEventKeyUp("onEditKeyUp"));b.onEditChange=
RClass.register(b,new AEventChange("onEditChange"));b.onEditBegin=FUiEditor_onEditBegin;b.onEditChanged=FUiEditor_onEditChanged;b.onEditEnd=FUiEditor_onEditEnd;b.onBuildPanel=FUiEditor_onBuildPanel;b.onBuild=FUiEditor_onBuild;b.get=RMethod.virtual(b,"get");b.set=RMethod.virtual(b,"set");b.doBlur=FUiEditor_doBlur;b.panel=FUiEditor_panel;b.linkControl=FUiEditor_linkControl;b.editBegin=FUiEditor_editBegin;b.editCancel=FUiEditor_editCancel;b.editEnd=FUiEditor_editEnd;b.reset=FUiEditor_reset;b.setVisible=
FUiEditor_setVisible;b.dispose=FUiEditor_dispose;return b},MO.FUiEditor_onEditBegin=function(){this.editBegin()},MO.FUiEditor_onEditChanged=function(){(this.storage=RObject.nvlObj(this.storage)).value==this.value()?this.changed&&(this.changed=!1):this.changed||(this.changed=!0)},MO.FUiEditor_onEditEnd=function(){var b=this._source;this.hide();this.lsnEditEnd&&this.lsnEditEnd.process(this);this._source=b._editor=null;this._statusEditing=!1},MO.FUiEditor_onBuildPanel=function(b){(this._hPanel=RBuilder.createSpan(b)).__linker=
this},MO.FUiEditor_onBuild=function(b){this.__base.FDuiControl.onBuild.call(this,b);this._hPanel.style.zIndex=EUiLayer.Editor},MO.FUiEditor_get=function(b){},MO.FUiEditor_set=function(b,d){},MO.FUiEditor_doBlur=function(){var b=this._source;b&&(this.editCancel(),RClass.isClass(b,MUiFocus)&&b.doBlur())},MO.FUiEditor_panel=function(b){return b==EPanel.Edit||b==EPanel.Focus?this._hEdit:this.__base.FDuiControl.panel.call(this,b)},MO.FUiEditor_linkControl=function(b){this._source=b},MO.FUiEditor_editBegin=
function(){var b=this._source;this.lsnEditCancel&&this.lsnEditCancel.process(this);b._editor=this;this._statusEditing=!0},MO.FUiEditor_editCancel=function(){var b=this._source;this.hide();this.lsnEditCancel&&this.lsnEditCancel.process(this);this._source=b._editor=null;this._statusEditing=!1},MO.FUiEditor_editEnd=function(){this.onEditEnd()},MO.FUiEditor_reset=function(){this.lsnEditEnd=this.lsnEditCancel=this.lsnEditBegin=null},MO.FUiEditor_setVisible=function(b){this.__base.FDuiControl.setVisible.call(this,
b);b&&(this.editBegin(),this.focus())},MO.FUiEditor_dispose=function(){this.__base.FDuiControl.dispose.call(this);this._hEdit=null};
with(MO)MO.FUiFile=function(b){b=RClass.inherits(this,b,FUiEditControl,MListenerDataChanged);b._inputSize=RClass.register(b,new APtySize2("_inputSize"));b._unit=RClass.register(b,new APtyString("_unit"));b._styleValuePanel=RClass.register(b,new AStyle("_styleValuePanel"));b._styleInputPanel=RClass.register(b,new AStyle("_styleInputPanel"));b._styleInput=RClass.register(b,new AStyle("_styleInput"));b._styleFile=RClass.register(b,new AStyle("_styleFile"));b._styleBrowser=RClass.register(b,new AStyle("_styleBrowser"));
b._hValueForm=null;b._hValueLine=null;b._hInputPanel=null;b._hInput=null;b.onBuildEditValue=FUiFile_onBuildEditValue;b.onFileChange=RClass.register(b,new AEventChange("onFileChange"),FUiFile_onFileChange);b.construct=FUiFile_construct;b.formatDisplay=FUiFile_formatDisplay;b.formatValue=FUiFile_formatValue;b.get=FUiFile_get;b.set=FUiFile_set;b.refreshValue=FUiFile_refreshValue;return b},MO.FUiFile_onBuildEditValue=function(b){var d=this._hValuePanel;d.className=this.styleName("ValuePanel");d=this._hValueForm=
RBuilder.appendTable(d);d.width="100%";d=this._hValueLine=RBuilder.appendTableRow(d);this._hChangePanel=RBuilder.appendTableCell(d);this.onBuildEditChange(b);b=this._hInputPanel=RBuilder.appendTableCell(d,this.styleName("InputPanel"));var d=this._hInputEdit=RBuilder.appendEdit(b,this.styleName("Input")),f=this._hInput=RBuilder.appendFile(b,this.styleName("File"));this.attachEvent("onFileChange",f);var h=this._hBrowserPanel=RBuilder.appendTableCell(this._hEditLine);h.style.paddingLeft="4px";(this._hBrowser=
RBuilder.appendButton(h,this.styleName("Browser"))).value="\u6d4f\u89c8...";RHtml.setSize(b,this._inputSize);RHtml.setSize(f,this._inputSize);this._editLength&&(d.maxLength=this._editLength)},MO.FUiFile_onFileChange=function(b){var d=this._hInput;d.files&&d.files.length&&(d=d.files[0],this._hInputEdit.value=d.name+" ("+d.size+"byte)",this.processDataChangedListener(b))},MO.FUiFile_construct=function(){this.__base.FUiEditControl.construct.call(this);this._inputSize=new SSize2(120,0)},MO.FUiFile_formatDisplay=
function(b){return this._dataDisplay=b=RString.nvl(b)},MO.FUiFile_formatValue=function(b){return b},MO.FUiFile_get=function(){var b=this.__base.FUiEditControl.get.call(this);return b=this._hInput.value},MO.FUiFile_set=function(b){this.__base.FUiEditControl.set.call(this,b);this._hInput.value=RString.nvl(b)},MO.FUiFile_refreshValue=function(){this.processDataChangedListener(this)};
with(MO)MO.FUiForm=function(b){b=RClass.inherits(this,b,FUiLayout,MUiDescribeFrame);b.onMouseDown=FUiForm_onMouseDown;b.construct=FUiForm_construct;b._dataStatusCd=ERowStatus.Update;b._dataComponents=null;b.lsnsLoaded=null;b.lsnsClick=null;b.onLoadDataset=FUiForm_onLoadDataset;b.onLoadDatasetEnd=FUiForm_onLoadDatasetEnd;b.isDataChanged=FUiForm_isDataChanged;b.getFormLink=FUiForm_getFormLink;b.allDataComponents=FUiForm_allDataComponents;b.get=FUiForm_get;b.set=FUiForm_set;b.getDataCodes=FUiForm_getDataCodes;
b.getCurrentRow=FUiForm_getCurrentRow;b.getSelectedRows=FUiForm_getSelectedRows;b.getCurrentRows=FUiForm_getCurrentRows;b.getChangedRows=FUiForm_getChangedRows;b.getRows=FUiForm_getRows;b.clearValue=FUiForm_clearValue;b.resetValue=FUiForm_resetValue;b.loadValue=FUiForm_loadValue;b.saveValue=FUiForm_saveValue;b.recordValue=FUiForm_recordValue;b.toAttributes=FUiForm_toAttributes;b.focus=FUiForm_focus;b.dsUpdate=FUiForm_dsUpdate;b.doPrepare=FUiForm_doPrepare;b.doUpdate=FUiForm_doUpdate;b.doDelete=FUiForm_doDelete;
b.dispose=FUiForm_dispose;return b},MO.FUiForm_onMouseDown=function(b){},MO.FUiForm_construct=function(){this.__base.FUiLayout.construct.call(this)},MO.FUiForm_onLoadDataset=function(b){this.doUpdate(this.dsViewer.current())},MO.FUiForm_onLoadDatasetEnd=function(){this.topControl().topResize();this.psProgress(!1)},MO.FUiForm_isDataChanged=function(){var b=this.allDataComponents();if(!b.isEmpty())for(var d=b.count,f=0;f<d;f++)if(b.value(f).isDataChanged())return!0},MO.FUiForm_getFormLink=function(b){if(EFormLink.Form==
b)return this.name;if(EFormLink.Table==b)return this.formName;RMessage.fatal(this,null,"Form link is invalid. (type={0})",b)},MO.FUiForm_allDataComponents=function(b,d){b||(b=this);d||(d=this._dataComponents);var f=b.components;if(f)for(var h=f.count,q=0;q<h;q++){var w=f.value(q);RClass.isClass(w,MDataset)||(RClass.isClass(w,MValue)&&d.set(w.dataName,w),this.allDataComponents(w,d))}return d},MO.FUiForm_get=function(b){var d=this.allDataComponents();if(d&&(b=d.get(b)))return b.get()},MO.FUiForm_set=
function(b){var d=this.allDataComponents();if(d&&(b=d.get(b)))return b.reget()},MO.FUiForm_set=function(b,d){var f=this.allDataComponents();f&&(f=f.get(b))&&f.set(d)},MO.FUiForm_getDataCodes=function(){var b=this._codeEvent;b.values=new TAttributes;this.process(b);return b.values},MO.FUiForm_getCurrentRow=function(){return this.saveValue()},MO.FUiForm_getSelectedRows=function(){var b=new TList;b.push(this.saveValue());return b},MO.FUiForm_getCurrentRows=function(){var b=new TList,d=new TRow;this.toDeepAttributes(d);
this.saveValue(d);b.push(d);return b},MO.FUiForm_getChangedRows=function(){var b=new TList;if(this.isDataChanged()){var d=new TRow;this.toDeepAttributes(d);this.saveValue(d);b.push(d)}return b},MO.FUiForm_getRows=function(){var b=new TList;b.push(this.saveValue());return b},MO.FUiForm_clearValue=function(){this.process(this._clearEvent)},MO.FUiForm_resetValue=function(){this.process(this._resetEvent)},MO.FUiForm_loadValue=function(b,d){if(b){var f=this._loadEvent;f.viewer=this.dsViewer;f.store=d;
f.values=b;this.process(f)}},MO.FUiForm_saveValue=function(b,d){b||(b=new TRow);var f=this._saveEvent;f.viewer=this.dsViewer;f.store=d;f.values=b;this.process(f);b.set("_status",this._dataStatusCd);return b},MO.FUiForm_recordValue=function(){this.process(this._recordEvent)},MO.FUiForm_toAttributes=function(b,d){return this.saveValue(b,d)},MO.FUiForm_focus=function(){this.__base.MUiFocus.focus.call(this);this.focusControl();RConsole.find(FFocusConsole).focusClass(MDataset,this)},MO.FUiForm_dsUpdate=
function(b,d){if(b){this.psProgress(!0);this.psMode(EMode.Update);var f=new TDatasetFetchArg(this.name,this.formId,this.dsPageSize,0);f.form=this;f.reset=!0;this.dsSearchs.clear();b&&this.dsSearchs.push(new TSearchItem("OUID",b));d&&this.dsSearchs.push(new TSearchItem("OVER",d));f.searchs=this.dsSearchs;f.values.append(this.dsValues);f.callback=new TInvoke(this,this.onDsUpdate);this.onDsUpdateCheck(f)&&RConsole.find(FDatasetConsole).fetch(f)}else return this.__base.MDataset.dsUpdate.call(this,b,d)},
MO.FUiForm_setEditable=function(b){var d=this.allDataComponents();if(d)for(var f=d.count,h=0;h<f;h++)d.value(h).setEditable(b)},MO.FUiForm_doPrepare=function(b){this._dataStatusCd=ERowStatus.Insert;this.resetValue();this.loadValue(b);this.recordValue();this.dsLoaded()},MO.FUiForm_doUpdate=function(b){this._dataStatusCd=ERowStatus.Update;this.clearValue();this.loadValue(b);this.recordValue();this.dsLoaded()},MO.FUiForm_doDelete=function(b){this._dataStatusCd=ERowStatus.Delete;this.clearValue();this.loadValue(b);
this.recordValue();this.dsLoaded()},MO.FUiForm_dispose=function(){this.__base.FUiLayout.dispose.call(this);RMemory.freeHtml(this.hEdit);RMemory.freeHtml(this.hDrop);this.hDrop=this.hEdit=null},MO.FUiForm_allNameComponents=function(b,d,f){var h=this._nameComponents;if(!b&&h)return h;h||(h=this._nameComponents=new TMap);b&&h.clear();d||(d=this);f||(f=h);if(b=d.components){d=b.count;for(var q=0;q<d;q++){var w=b.value(q);RClass.isClass(w,MDataset)||(RClass.isClass(w,MValue)&&f.set(w.name,w),this.allNameComponents(!1,
w,f))}}return h},MO.FUiForm_onLoaded=function(){var b=this.form,d=this.document;b&&d&&(RControl.build(b,d.root()),b.isLoading=!1,b.lsnsLoaded.process(b))},MO.FUiForm_onDsFetchEnd=function(){var b=this.dsCurrent();b&&this.loadValue(b)},MO.FUiForm_onDsUpdateBegin=function(){var b=this.dsCurrent();b&&this.saveValue(b)},MO.FUiForm_onDsUpdateEnd=function(){var b=this.dsCurrent();b&&this.loadValue(b)},MO.FUiForm_connect=function(b,d,f,h){var q=new TXmlDocument,w=q.root();w.set("type",d);w.set("name",this.name);
w.set("action",f);w.create("Attributes").value=h;d=new TEvent(this,EXmlEvent.Send);d.url=b;d.document=q;d.form=this;d.onLoad=this.onLoaded;RConsole.find(FXmlConsole).process(d)},MO.FUiForm_loadDocument=function(b){b&&(b=b.root(),b.isName("Table")&&(this.loadConfig(b),this.buildColumns(b),this.buildRows(b)))},MO.FUiForm_testStatus=function(b){var d=this.__base.MDataset.testStatus.call(this,b);return EDataAction.Fetch==b||EDataAction.Fetch==b||EDataAction.Search==b?!0:EDataAction.First==b||EDataAction.Prior==
b||EDataAction.Next==b||EDataAction.Last==b?!1:EDataAction.Action==b?!0:d},MO.FUiForm_hasAction=function(){for(var b=this.components,d=b.count,f=0;f<d;f++){var h=b.value(f);if(RClass.isClass(h,FDataAction))return!0}return!1};with(MO)MO.FUiFrame=function(b){return b=RClass.inherits(this,b,FUiLayout)};
with(MO)MO.FUiIconPicker=function(b){return b=RClass.inherits(this,b,FUiEdit)},MO.FUiIconPicker_onEditKeyDown=function(b){this.base.FUiEditControl.onEditKeyDown.call(this,b);this.hEditIcon.src=RRes.iconPath(RString.nvl(this.text(),this.styleIcon("Default")))},MO.FUiIconPicker_onEditKeyPress=function(b){this.base.FUiEditControl.onEditKeyPress.call(this,b);this.editCase&&RKey.fixCase(b,this.editCase)},MO.FUiIconPicker_onBuildEdit=function(b){var d=b.hPanel;b.hIcon.width=1;d.align="center";d.noWrap=
"true";b=RString.nvl(this.iconDefault,this.styleIcon("Default"));this.hEditIcon=RBuilder.appendIcon(d,b);d=this.hEdit=RBuilder.appendEdit(d,this.style("Edit"));d.autocomplete=RBool.isTrue(this.editComplete)?"on":"off";this.editLength&&(d.maxLength=this.editLength)},MO.FUiIconPicker_setText=function(b){this.base.FUiEditControl.setText.call(this,b);this.hEditIcon.src=RResource.iconPath(RString.nvl(this.text(),this.styleIcon("Default")))},MO.FUiIconPicker_dispose=function(){this.base.FUiEditControl.dispose.call(this);
this.hEdit=this.hEditIcon=null};with(MO)MO.FUiLabel=function(b){b=RClass.inherits(this,b,FDuiControl);b.onBuild=FUiLabel_onBuild;b.get=FUiLabel_get;b.set=FUiLabel_set;return b},MO.FUiLabel_onBuild=function(b){this.__base.FDuiControl.onBuild.call(this,b)},MO.FUiLabel_get=function(){return this._hPanel.innerHTML},MO.FUiLabel_set=function(b){this._hPanel.innerHTML=b};
with(MO)MO.FUiLayout=function(b){b=RClass.inherits(this,b,FDuiContainer);b._styleForm=RClass.register(b,new AStyle("_styleForm","Form"));b._lastSplit=null;b._hPanelForm=null;b._hContainer=null;b._hPanelTable=null;b._hPanelLine=null;b.onBuildPanel=FUiLayout_onBuildPanel;b.onDesignBegin=FUiLayout_onDesignBegin;b.onDesignEnd=FUiLayout_onDesignEnd;b.oeDesign=FUiLayout_oeDesign;b.oeResize=FUiLayout_oeResize;b.oeRefresh=FUiLayout_oeRefresh;b.insertPosition=FUiLayout_insertPosition;b.moveChild=FUiLayout_moveChild;
b.innerAppendLine=FUiLayout_innerAppendLine;b.appendChild=FUiLayout_appendChild;b.resize=FUiLayout_resize;b.dispose=FUiLayout_dispose;return b},MO.FUiLayout_onBuildPanel=function(b){b=this._hPanel=this._hPanelForm=RBuilder.createTable(b,this.styleName("Form"),null,0,1);this._layoutCd==EUiLayout.Design&&(b=RBuilder.appendTableRow(b),this._hContainer=RBuilder.appendTableCell(b))},MO.FUiLayout_onDesignBegin=function(){this.__base.MDesign.onDesignBegin.call(this)},MO.FUiLayout_onDesignEnd=function(){this.__base.MDesign.onDesignEnd.call(this)},
MO.FUiLayout_oeDesign=function(b){this.__base.FDuiContainer.oeDesign.call(this,b);if(b.isAfter())switch(b.layoutCd){case EDesign.Border:event.flag?(this._hPanel.border=1,this._hPanel.style.border="1 solid red"):(this._hPanel.border=0,this._hPanel.style.border=null)}},MO.FUiLayout_oeResize=function(b){this.__base.FDuiContainer.oeResize.call(this,b);b.isAfter()&&this.resize()},MO.FUiLayout_oeRefresh=function(b){this.__base.FDuiContainer.oeDesign.call(this,b);b.isAfter()&&this.resize()},MO.FUiLayout_insertPosition=
function(b,d,f,h){h=this._components;var q=this.controls;h.removeValue(b);q.removeValue(b);if(d){var w=h.indexOfValue(d);h.insert(w+f,b.name,b);w=q.indexOfValue(d);q.insert(w+f,b.name,b)}else h.set(b.name,b),q.set(b.name,b)},MO.FUiLayout_moveChild=function(b,d,f,h){if(b&&d&&f&&b!=d){var q=!1,w=RClass.isClass(b,MUiHorizontal),z=RHtml.parent(b._hPanel,"TD"),A=RHtml.parent(b._hPanel,"TABLE"),B=RClass.isClass(d,MUiHorizontal),C=RHtml.parent(d._hPanel,"TD"),D=RHtml.parent(C,"TABLE");switch(f){case EPosition.Before:w=
D.rows[0];for(f=0;f<w.cells.length;f++)if(w.cells[f]==C){w=RBuilder.appendTableCell(w,null,C.cellIndex);w.appendChild(b._hPanel);this.insertPosition(b,d,0,h);b.nowrap=!0;b._hPanelLine=D;q=!0;break}break;case EPosition.After:w=D.rows[0];for(f=0;f<w.cells.length;f++)if(w.cells[f]==C){z=RHtml.parent(b._hPanel,"TD");w=RBuilder.appendTableCell(w,null,C.cellIndex+1);w.appendChild(b._hPanel);this.insertPosition(b,d,1,h);b.nowrap=!1;b._hPanelLine=D;q=d.nowrap=!0;break}break;case EPosition.LineBefore:if(B)w?
this._hContainer.insertBefore(b._hPanel,d._hPanel):(C=this.innerAppendLine(),this._hContainer.insertBefore(C,d._hPanel),w=RBuilder.appendTableCell(this._hPanelLine),w.appendChild(b._hPanel),b._hPanelLine=C),this.insertPosition(b,d,0,h);else for(C=this._hContainer.children.length,f=0;f<C;f++)if(this._hContainer.children[f]==D){w?this._hContainer.insertBefore(b._hPanel,D):(C=this.innerAppendLine(),this._hContainer.insertBefore(C,D),w=RBuilder.appendTableCell(this._hPanelLine),w.appendChild(b._hPanel),
b._hPanelLine=C,q=!0);this.insertPosition(b,d,0,h);b.nowrap=!1;break}break;case EPosition.LineAfter:w?this._hContainer.appendChild(b._hPanel):(this.innerAppendLine(),w=RBuilder.appendTableCell(this._hPanelLine),w.appendChild(b._hPanel),w.appendChild(b._hPanel),q=!0),this.insertPosition(b,null,0,h),d.nowrap=!1,b.nowrap=!1}q&&(z.removeNode(!0),0==A.rows[0].cells.length&&A.removeNode(!0))}},MO.FUiLayout_innerAppendLine=function(){var b=null;this._layoutCd==EUiLayout.Design?(b=this._hPanelTable=RBuilder.appendTable(this._hContainer),
b.style.paddingBottom=4,this._hPanelLine=RBuilder.appendTableRow(b)):this._hPanelLine=this._hPanelTable=null;return b},MO.FUiLayout_appendChild=function(b){if(this._layoutCd==EUiLayout.Design)if(this._hPanelLine||this.innerAppendLine(),RClass.isClass(b,MUiHorizontal))0==this._hPanelTable.rows[0].cells.length?this._hContainer.insertBefore(b._hPanel,this._hPanelTable):(this._hContainer.appendChild(b._hPanel),this.innerAppendLine());else{var d=RBuilder.appendTableCell(this._hPanelLine);RClass.isClass(b,
FUiLayout)||(b._hPanelLine=this._hPanelTable);d.appendChild(b._hPanel);b._hLayoutCell=d;b.wrapCd()==EUiWrap.NextLine&&this.controls.last()!=b&&this.innerAppendLine()}else if(b._hPanel.style.paddingTop=2,b._hPanel.style.paddingBottom=2,b.dockCd()==EUiDock.Fill)d=RBuilder.appendTableRowCell(this._hPanelForm),d.appendChild(b._hPanel);else if(b._sizeCd==EUiSize.Fill)d=RBuilder.appendTableRowCell(this._hPanelForm),d.appendChild(b._hPanel);else if(RSet.contains(b._sizeCd,EUiSize.Horizontal)||"100%"==b.width){RClass.isClass(b,
FUiSplit)&&(this._lastSplit=b);var d=RBuilder.appendTableRow(this._hPanelForm),f=RBuilder.appendTableCell(d);f.vAlign="top";f.appendChild(b._hPanel);b._hLayoutRow=d;this._hPanelLast=f;RSet.contains(b._sizeCd,EUiSize.Vertical)?b.height&&(f.height=b.height):f.height=1;this._hPanelLine=null}else this._hPanelLine||(d=RBuilder.appendTableRow(this._hPanelForm),d.height=1,this._lastSplit&&this._lastSplit.pushLine(d),f=RBuilder.appendTableCell(d),f.vAlign="top",d=this._hPanelTable=RBuilder.appendTable(f),
this._hPanelLine=RBuilder.appendTableRow(d)),f=RBuilder.appendTableCell(this._hPanelLine),b._hLayoutRow=this._hPanelLine,this._hPanelLast=f,f.appendChild(b._hPanel),b._hLayoutCell=f,b.wrapCd()==EUiWrap.NextLine&&(this._hPanelLine=null)},MO.FUiLayout_resize=function(){var b=this._components;if(b)for(var b=b.count(),d=0;d<b;d++){var f=this._components.at(d);if(RClass.isClass(f,FUiTable)||RClass.isClass(f,FUiPageControl))break}},MO.FUiLayout_dispose=function(){this._hContainer=this._hPanel=this._hPanelTable=
this._hPanelCurrent=null;this.__base.FDuiContainer.dispose.call(this)};
with(MO)MO.FUiLayoutHorizontal=function(b){b=RClass.inherits(this,b,FDuiContainer);b._stylePanel=RClass.register(b,new AStyle("_stylePanel"));b._hLine=null;b.onBuildPanel=FUiLayoutHorizontal_onBuildPanel;b.onBuild=FUiLayoutHorizontal_onBuild;b.appendChild=FUiLayoutHorizontal_appendChild;b.dispose=FUiLayoutHorizontal_dispose;return b},MO.FUiLayoutHorizontal_onBuildPanel=function(b){this._hPanel=RBuilder.createTable(b,this.styleName("Panel"))},MO.FUiLayoutHorizontal_onBuild=function(b){this.__base.FDuiContainer.onBuild.call(this,
b);this._hLine=RBuilder.appendTableRow(this._hPanel)},MO.FUiLayoutHorizontal_appendChild=function(b){var d=RBuilder.appendTableCell(this._hLine);d.appendChild(b._hPanel);b=b.dockCd();"left"==b?d.align="left":"center"==b?d.align="center":"right"==b&&(d.align="right")},MO.FUiLayoutHorizontal_dispose=function(){this._hLine=RHtml.free(this._hLine);this.__base.FDuiContainer.dispose.call(this)};
with(MO)MO.FUiLayoutVertical=function(b){b=RClass.inherits(this,b,FDuiContainer);b._stylePanel=RClass.register(b,new AStyle("_stylePanel"));b._hLine=null;b.onBuildPanel=FUiLayoutVertical_onBuildPanel;b.appendChild=FUiLayoutVertical_appendChild;b.dispose=FUiLayoutVertical_dispose;return b},MO.FUiLayoutVertical_onBuildPanel=function(b){this._hPanel=RBuilder.createTable(b,this.styleName("Panel"))},MO.FUiLayoutVertical_appendChild=function(b){var d=RBuilder.appendTableRowCell(this._hPanel);d.appendChild(b._hPanel);
if(b=b.size().height)d.style.height=b+"px"},MO.FUiLayoutVertical_dispose=function(){this.__base.FDuiContainer.dispose.call(this)};
with(MO)MO.FUiListBox=function(b){b=RClass.inherits(this,b,FDuiContainer,MUiHorizontal,MListenerClick);b._sizeCd=EUiSize.Horizontal;b._stylePanel=RClass.register(b,new AStyle("_stylePanel"));b._hForm=null;b.onBuildPanel=FUiListBox_onBuildPanel;b.createItem=FUiListBox_createItem;b.appendChild=FUiListBox_appendChild;b.clickItem=FUiListBox_clickItem;b.clear=FUiListBox_clear;b.dispose=FUiListBox_dispose;return b},MO.FUiListBox_onBuildPanel=function(b){this._hPanel=RBuilder.createTable(b,this.styleName("Panel"))},
MO.FUiListBox_createItem=function(b,d){var f=RClass.create(FUiListItem);f.build(this._hPanel);f.setLabel(d);return f},MO.FUiListBox_appendChild=function(b){this._hPanel.appendChild(b._hPanel)},MO.FUiListBox_clickItem=function(b){var d=this._components;if(d)for(var f=d.count(),h=0;h<f;h++){var q=d.at(h);RClass.isClass(q,FUiListItem)&&q.setChecked(q==b)}d=new SEvent(this);d.item=b;this.processClickListener(d);d.dispose()},MO.FUiListBox_clear=function(){var b=this._components;if(b){for(var d=b.count(),
f=0;f<d;f++){var h=b.at(f);RClass.isClass(h,FUiListItem)&&this._hPanel.removeChild(h._hPanel);h.dispose()}b.clear();this._controls.clear()}},MO.FUiListBox_dispose=function(){this.__base.FContainer.dispose.call(this)};
with(MO)MO.FUiListItem=function(b){b=RClass.inherits(this,b,FDuiControl);b._styleNormal=RClass.register(b,new AStyle("_styleNormal"));b._styleHover=RClass.register(b,new AStyle("_styleHover"));b._styleSelect=RClass.register(b,new AStyle("_styleSelect"));b._styleIconPanel=RClass.register(b,new AStyle("_styleIconPanel"));b._styleIcon=RClass.register(b,new AStyle("_styleIcon"));b._styleLabel=RClass.register(b,new AStyle("_styleLabel"));b._checked=!1;b._hPanel=null;b._hIconPanel=null;b._hIcon=null;b._hLabel=
null;b.onBuildPanel=FUiListItem_onBuildPanel;b.onBuild=FUiListItem_onBuild;b.onEnter=FUiListItem_onEnter;b.onLeave=FUiListItem_onLeave;b.onClick=RClass.register(b,new AEventClick("onClick"),FUiListItem_onClick);b.label=FUiListItem_label;b.setLabel=FUiListItem_setLabel;b.setChecked=FUiListItem_setChecked;b.dispose=FUiListItem_dispose;return b},MO.FUiListItem_onBuildPanel=function(b){this._hPanel=RBuilder.createTableRow(b,this.styleName("Normal"))},MO.FUiListItem_onBuild=function(b){this.__base.FDuiControl.onBuild.call(this,
b);b=this._hPanel;this._hIconPanel=RBuilder.appendTableCell(b,this.styleName("IconPanel"));this._icon&&(this._hIcon=RBuilder.appendIcon(this._hIconPanel,this.styleName("Icon"),this._icon));this._hLabel=RBuilder.appendTableCell(b,this.styleName("Label"));this._label&&this.setLabel(this._label);this.attachEvent("onClick",b)},MO.FUiListItem_onEnter=function(){this.__base.FDuiControl.onEnter.call(this);this._hPanel.className=RBoolean.parse(this._checked)?this.styleName("Select"):this.styleName("Hover")},
MO.FUiListItem_onLeave=function(){this._hPanel.className=RBoolean.parse(this._checked)?this.styleName("Select"):this.styleName("Normal");this.__base.FDuiControl.onLeave.call(this)},MO.FUiListItem_onClick=function(b){this._parent.clickItem(this)},MO.FUiListItem_label=function(b){return this._label},MO.FUiListItem_setLabel=function(b){this._label=b;this._hLabel.innerHTML=RString.nvl(b)},MO.FUiListItem_setChecked=function(b){this._checked=b;this._hIcon?this._hIcon.style.display=b?"block":"none":this._hIconPanel.innerHTML=
b?"O":"";this._hPanel.className=b?this.styleName("Select"):this.styleName("Normal")},MO.FUiListItem_dispose=function(){this._hPanel=RHtml.free(this._hPanel);this._hIconPanel=RHtml.free(this._hIconPanel);this._hIcon=RHtml.free(this._hIcon);this._hLabel=RHtml.free(this._hLabel);this.__base.FDuiControl.dispose.call(this)};
with(MO)MO.FUiListView=function(b){b=RClass.inherits(this,b,FDuiContainer,MUiHorizontal,MListenerClick,MListenerDoubleClick);b._sizeCd=EUiSize.Horizontal;b._stylePanel=RClass.register(b,new AStyle("_stylePanel"));b._focusItem=null;b._itemPool=null;b._hForm=null;b.onBuildPanel=FUiListView_onBuildPanel;b.onBuild=FUiListView_onBuild;b.onClick=RClass.register(b,new AEventClick("onClick"),FUiListView_onClick);b.construct=FUiListView_construct;b.focusItem=FUiListView_focusItem;b.createItem=FUiListView_createItem;
b.appendChild=FUiListView_appendChild;b.selectItem=FUiListView_selectItem;b.doClickItem=FUiListView_doClickItem;b.doDoubleClickItem=FUiListView_doDoubleClickItem;b.clear=FUiListView_clear;b.dispose=FUiListView_dispose;return b},MO.FUiListView_onBuildPanel=function(b){this._hPanel=RBuilder.createDiv(b,this.styleName("Panel"))},MO.FUiListView_onBuild=function(b){this.__base.FDuiContainer.onBuild.call(this,b);this.attachEvent("onClick",this._hPanel)},MO.FUiListView_onClick=function(b,d){if(b.hSender==
this._hNodePanel){var f=this._focusNode;f&&(f.select(!1),this._focusNode=null)}},MO.FUiListView_construct=function(){this.__base.FDuiContainer.construct.call(this);this._itemPool=RClass.create(FObjectPool)},MO.FUiListView_focusItem=function(){return this._focusItem},MO.FUiListView_createItem=function(b,d,f){d=this._itemPool.alloc();d||(d=b?RClass.create(b):RClass.create(FUiListViewItem),d.build(this._hPanel));return d},MO.FUiListView_appendChild=function(b){this._hPanel.appendChild(b._hPanel)},MO.FUiListView_selectItem=
function(b){var d=this._components;if(d)for(var f=d.count(),h=0;h<f;h++){var q=d.valueAt(h);RClass.isClass(q,FUiListViewItem)&&q.setChecked(q==b)}this._focusItem=b},MO.FUiListView_doClickItem=function(b){this.selectItem(b);var d=new SClickEvent(this);d.item=b;this.processClickListener(d);d.dispose()},MO.FUiListView_doDoubleClickItem=function(b){this.selectItem(b);var d=new SClickEvent(this);d.item=b;this.processDoubleClickListener(d);d.dispose()},MO.FUiListView_clear=function(){var b=this._components;
if(b){for(var d=b.count(),f=0;f<d;f++){var h=b.value(f);RClass.isClass(h,FUiListViewItem)?(this._hPanel.removeChild(h._hPanel),this._itemPool.free(h)):h.dispose()}b.clear();this._controls.clear()}},MO.FUiListView_dispose=function(){this.__base.FContainer.dispose.call(this)};
with(MO)MO.FUiListViewItem=function(b){b=RClass.inherits(this,b,FDuiControl);b._stylePanel=RClass.register(b,new AStyle("_stylePanel"));b._styleNormal=RClass.register(b,new AStyle("_styleNormal"));b._styleHover=RClass.register(b,new AStyle("_styleHover"));b._styleSelect=RClass.register(b,new AStyle("_styleSelect"));b._styleForm=RClass.register(b,new AStyle("_styleForm"));b._styleContent=RClass.register(b,new AStyle("_styleContent"));b._styleIconPanel=RClass.register(b,new AStyle("_styleIconPanel"));
b._styleIcon=RClass.register(b,new AStyle("_styleIcon"));b._styleLabel=RClass.register(b,new AStyle("_styleLabel"));b._checked=!1;b._contentHeight=28;b._hPanel=null;b._hBorder=null;b._hForm=null;b._hContentForm=null;b._hContentLine=null;b._hIconPanel=null;b._hIcon=null;b._hLabel=null;b.onBuildPanel=FUiListViewItem_onBuildPanel;b.onBuild=FUiListViewItem_onBuild;b.onEnter=FUiListViewItem_onEnter;b.onLeave=FUiListViewItem_onLeave;b.onClick=RClass.register(b,new AEventClick("onClick"),FUiListViewItem_onClick);
b.onDoubleClick=RClass.register(b,new AEventDoubleClick("onDoubleClick"),FUiListViewItem_onDoubleClick);b.label=FUiListViewItem_label;b.setLabel=FUiListViewItem_setLabel;b.setChecked=FUiListViewItem_setChecked;b.dispose=FUiListViewItem_dispose;return b},MO.FUiListViewItem_onBuildPanel=function(b){this._hPanel=RBuilder.createDiv(b,this.styleName("Panel"))},MO.FUiListViewItem_onBuild=function(b){this.__base.FDuiControl.onBuild.call(this,b);b=this._hPanel;var d=this._hBorder=RBuilder.appendDiv(b,this.styleName("Normal")),
d=this._hForm=RBuilder.appendTable(d,this.styleName("Form"));this._hLine1=RBuilder.appendTableRowCell(d);d=this._hLine2=RBuilder.appendTableRowCell(d);d.height=this._contentHeight;d=this._hContentForm=RBuilder.appendTable(d,this.styleName("Content"));d=this._hContentLine=RBuilder.appendTableRow(d);this._hIconPanel=RBuilder.appendTableCell(d,this.styleName("IconPanel"));this._hIcon=RBuilder.appendIcon(this._hIconPanel,this.styleName("Icon"),RString.nvl(this._icon,"tools.select"));RHtml.displaySet(this._hIcon,
!1);this._hLabel=RBuilder.appendTableCell(d,this.styleName("Label"));this._label&&this.setLabel(this._label);this.attachEvent("onClick",b);this.attachEvent("onDoubleClick",b)},MO.FUiListViewItem_onEnter=function(){this.__base.FDuiControl.onEnter.call(this);this._hBorder.className=RBoolean.parse(this._checked)?this.styleName("Select"):this.styleName("Hover")},MO.FUiListViewItem_onLeave=function(){this._hBorder.className=RBoolean.parse(this._checked)?this.styleName("Select"):this.styleName("Normal");
this.__base.FDuiControl.onLeave.call(this)},MO.FUiListViewItem_onClick=function(b){this._checked?this._parent.doDoubleClickItem(this):this._parent.doClickItem(this)},MO.FUiListViewItem_onDoubleClick=function(b){this._parent.doDoubleClickItem(this)},MO.FUiListViewItem_label=function(b){return this._label},MO.FUiListViewItem_setLabel=function(b){this._label=b;this._hLabel.innerHTML=RString.nvl(b)},MO.FUiListViewItem_setChecked=function(b){this._checked=b;this._hIcon?this._hIcon.style.display=b?"block":
"none":this._hIconPanel.innerHTML=b?"O":"";this._hBorder.className=b?this.styleName("Select"):this.styleName("Normal")},MO.FUiListViewItem_dispose=function(){this._hPanel=RHtml.free(this._hPanel);this._hBorder=RHtml.free(this._hBorder);this._hForm=RHtml.free(this._hForm);this._hLine1=RHtml.free(this._hLine1);this._hLine2=RHtml.free(this._hLine2);this._hContentForm=RHtml.free(this._hContentForm);this._hContentLine=RHtml.free(this._hContentLine);this._hIconPanel=RHtml.free(this._hIconPanel);this._hIcon=
RHtml.free(this._hIcon);this._hLabel=RHtml.free(this._hLabel);this.__base.FDuiControl.dispose.call(this)};
with(MO)MO.FUiMemo=function(b){b=RClass.inherits(this,b,FUiEditControl,MPropertyEdit,MListenerDataChanged);b._inputSize=RClass.register(b,new APtySize2("_inputSize"));b._styleValuePanel=RClass.register(b,new AStyle("_styleValuePanel"));b._styleInputPanel=RClass.register(b,new AStyle("_styleInputPanel"));b._styleInput=RClass.register(b,new AStyle("_styleInput"));b._hValueForm=null;b._hValueLine=null;b._hInputPanel=null;b._hInput=null;b.onBuildEditValue=FUiMemo_onBuildEditValue;b.onInputEdit=RClass.register(b,
new AEventInputChanged("onInputEdit"),FUiMemo_onInputEdit);b.construct=FUiMemo_construct;b.formatDisplay=FUiMemo_formatDisplay;b.formatValue=FUiMemo_formatValue;b.get=FUiMemo_get;b.set=FUiMemo_set;b.refreshValue=FUiMemo_refreshValue;return b},MO.FUiMemo_onBuildEditValue=function(b){var d=this._hValuePanel;d.className=this.styleName("ValuePanel");d=this._hValueForm=RBuilder.appendTable(d);d.width="100%";d=this._hValueLine=RBuilder.appendTableRow(d);this._hChangePanel=RBuilder.appendTableCell(d);this.onBuildEditChange(b);
b=this._hInputPanel=RBuilder.appendTableCell(d);d=this._hInput=RBuilder.append(b,"TEXTAREA",this.styleName("Input"));d.wrap="off";this.attachEvent("onInputEdit",d,this.onInputEdit);RHtml.setSize(b,this._inputSize);this._editLength&&(d.maxLength=this._editLength)},MO.FUiMemo_onInputEdit=function(b){this.refreshValue()},MO.FUiMemo_construct=function(){this.__base.FUiEditControl.construct.call(this);this._inputSize=new SSize2(120,0)},MO.FUiMemo_formatDisplay=function(b){return this._dataDisplay=b=RString.nvl(b)},
MO.FUiMemo_formatValue=function(b){return b},MO.FUiMemo_get=function(){this.__base.FUiEditControl.get.call(this);return this._hInput.value},MO.FUiMemo_set=function(b){this.__base.FUiEditControl.set.call(this,b);this._hInput.value=RString.nvl(b)},MO.FUiMemo_refreshValue=function(){this.processDataChangedListener(this)};
with(MO)MO.FUiNumber=function(b){b=RClass.inherits(this,b,FUiEditControl,MListenerDataChanged,MPropertyNumber);b._inputSize=RClass.register(b,new APtySize2("_inputSize"));b._styleValuePanel=RClass.register(b,new AStyle("_styleValuePanel"));b._styleInput=RClass.register(b,new AStyle("_styleInput"));b._styleAdjustForm=RClass.register(b,new AStyle("_styleAdjustForm"));b._styleUpPanel=RClass.register(b,new AStyle("_styleUpPanel"));b._styleDownPanel=RClass.register(b,new AStyle("_styleDownPanel"));b._innerOriginValue=
null;b._innerDataValue=null;b._hInput=null;b._iconUp=null;b._iconDown=null;b.onBuildEditValue=FUiNumber_onBuildEditValue;b.onInputKeyPress=RClass.register(b,new AEventKeyPress("onInputKeyPress"),FUiNumber_onInputKeyPress);b.onInputChanged=RClass.register(b,new AEventInputChanged("onInputChanged"),FUiNumber_onInputChanged);b.construct=FUiNumber_construct;b.formatDisplay=FUiNumber_formatDisplay;b.formatValue=FUiNumber_formatValue;b.get=FUiNumber_get;b.set=FUiNumber_set;return b},MO.FUiNumber_onBuildEditValue=
function(b){var d=this._hValuePanel;d.className=this.styleName("ValuePanel");d=this._hValueForm=RBuilder.appendTable(d);d.width="100%";d=this._hValueLine=RBuilder.appendTableRow(d);this._hChangePanel=RBuilder.appendTableCell(d);this.onBuildEditChange(b);b=this._hInputPanel=RBuilder.appendTableCell(d);b=this._hInput=RBuilder.appendEdit(b,this.styleName("Input"));this.attachEvent("onInputKeyPress",b,this.onInputKeyPress);this.attachEvent("onInputChanged",b,this.onInputChanged);this._editLength&&(b.maxLength=
this._editLength);b=this._hAdjustPanel=RBuilder.appendTableCell(d);b.style.borderLeft="1px solid #666666";b.width=12;b=this.hAdjustForm=RBuilder.appendTable(b,this.styleName("AdjustForm"));d=RBuilder.appendTableRowCell(b);d.className=this.styleName("UpPanel");(this._hUpIcon=RBuilder.appendIcon(d,null,"control.number.up")).align="center";d=RBuilder.appendTableRowCell(b);d.className=this.styleName("DownPanel");this._hDownIcon=RBuilder.appendIcon(d,null,"control.number.down")},MO.FUiNumber_onInputKeyPress=
function(b){RKeyboard.isFloatKey(b.keyCode)||b.cancel()},MO.FUiNumber_onInputChanged=function(b){this.processDataChangedListener(this)},MO.FUiNumber_construct=function(){this.__base.FUiEditControl.construct.call(this);this._editSize.set(100,20);this._inputSize=new SSize2(80,0)},MO.FUiNumber_formatDisplay=function(b){return this._dataDisplay=RFloat.format(b,0,null,this._valuePrecision,null)},MO.FUiNumber_formatValue=function(b){return b},MO.FUiNumber_get=function(b){b=this.__base.FUiEditControl.get.call(this,
b);var d=this._hInput;d&&(b=this.formatValue(d.value));return b},MO.FUiNumber_set=function(b){this.__base.FUiEditControl.set.call(this,b);var d=RString.nvl(b,"0");this._innerDataValue=this._innerOriginValue=d;if(d=this._hInput)d.value=this.formatDisplay(b);this.changeSet(!1)},MO.FUiNumber_onDataKeyDown=function(b,d){this.__base.FUiEditControl.onDataKeyDown.call(this,b,d);this.editCase&&RKey.fixCase(d,this.editCase)},MO.FUiNumber_setText=function(b){this.hEdit&&(this.hEdit.value="U"==this.editCase?
RString.toUpper(b):"L"==this.editCase?RString.toLower(b):b,this.hEdit.style.textAlign="right"==this.editAlign?"right":"left"==this.editAlign?"left":"center")},MO.FUiNumber_validText=function(b){var d=this.__base.FUiEditControl.validText.call(this,b);if(!d){if(this.validLenmin&&this.validLenmin>b.length)return RContext.get("MDescEdit:ValidMinLength",this.validLenmin);if(this.validLenmax&&this.validLenmax<b.length)return RContext.get("MDescEdit:ValidMaxLength",this.validLenmax)}return d},MO.FUiNumber_findEditor=
function(){if(this.editComplete){var b=this.editor;!b&&(this.dsControl=this.topControl(MDataset))&&(b=this.editor=RConsole.find(FUiNumberConsole).focus(this,FUiNumberEditor));b&&b.linkControl(this);return this.editor}},MO.FUiNumber_drop=function(){var b=this.findEditor();if(b){var d=this.reget();0<d.length&&(this.finded!=d&&(b.source!=this&&b.linkControl(this),b.search(d)),this.finded=d)}};
with(MO)MO.FUiNumber2=function(b){b=RClass.inherits(this,b,FUiEditControl,MListenerDataChanged);b._inputSize=RClass.register(b,new APtySize2("_inputSize"));b._styleInputPanel=RClass.register(b,new AStyle("_styleInputPanel"));b._styleInput=RClass.register(b,new AStyle("_styleInput"));b._innerOriginValue=null;b._innerDataValue=null;b._hInput=null;b.onBuildEditInput=FUiNumber3_onBuildEditInput;b.onBuildEditValue=FUiNumber2_onBuildEditValue;b.onInputKeyPress=RClass.register(b,new AEventKeyPress("onInputKeyPress"),
FUiNumber2_onInputKeyPress);b.onInputChanged=RClass.register(b,new AEventInputChanged("onInputChanged"),FUiNumber2_onInputChanged);b.construct=FUiNumber2_construct;b.get=FUiNumber2_get;b.set=FUiNumber2_set;return b},MO.FUiNumber2_oeDataLoad=function(b){alert(b);return EEventStatus.Stop},MO.FUiNumber2_oeDataSave=function(b){return EEventStatus.Stop},MO.FUiNumber3_onBuildEditInput=function(b,d){this.attachEvent("onInputKeyPress",d,this.onInputKeyPress);this.attachEvent("onInputChanged",d,this.onInputChanged)},
MO.FUiNumber2_onBuildEditValue=function(b){var d=this._hValuePanel;d.className=this.styleName("InputPanel");var d=this._hInputForm=RBuilder.appendTable(d),d=RBuilder.appendTableRow(d),f=RBuilder.appendTableCell(d);f.style.borderRight="1px solid #666666";f=this._hInput1=RBuilder.appendEdit(f,this.styleName("Input"));this.onBuildEditInput(b,f);f=RBuilder.appendTableCell(d);f.style.borderLeft="1px solid #999999";f=this._hInput2=RBuilder.appendEdit(f,this.styleName("Input"));this.onBuildEditInput(b,f)},
MO.FUiNumber2_onInputKeyPress=function(b){EKeyCode.floatCodes[b.keyCode]||b.cancel()},MO.FUiNumber2_onInputChanged=function(b){this.processDataChangedListener(this)},MO.FUiNumber2_construct=function(){this.__base.FUiEditControl.construct.call(this);this._inputSize=new SSize2(120,0);this._innerOriginValue=new SPoint2;this._innerDataValue=new SPoint2},MO.FUiNumber2_get=function(b){this.__base.FUiEditControl.get.call(this,b);b=this._innerDataValue;var d=this._hInput1;d&&(b.x=RFloat.parse(d.value));if(d=
this._hInput2)b.y=RFloat.parse(d.value);return b},MO.FUiNumber2_set=function(b){this.__base.FUiEditControl.set.call(this,b);var d=this._innerOriginValue,f=this._innerDataValue;if(1==arguments.length)if(b=arguments[0],b.constructor==SPoint2)d.assign(b),f.assign(b);else if(b.constructor==SSize2)d.set(b.width,b.height),f.set(b.width,b.height);else throw new TError("Invalid value format.");else if(2==arguments.length)d.set(arguments[0],arguments[1]),f.assign(d);else throw new TError("Invalid value format.");
if(d=this._hInput1)d.value=RFloat.format(f.x,0,null,2,null);if(d=this._hInput2)d.value=RFloat.format(f.y,0,null,2,null);this.changeSet(!1)},MO.FUiNumber2_onDataKeyDown=function(b,d){this.__base.FUiEditControl.onDataKeyDown.call(this,b,d);this.editCase&&RKey.fixCase(d,this.editCase)},MO.FUiNumber2_formatValue=function(b){b=RString.nvl(b);ECase.Upper==this.editCase?b=RString.toUpper(b):ECase.Lower==this.editCase&&(b=RString.toLower(b));return b},MO.FUiNumber2_setText=function(b){this.hEdit&&(this.hEdit.value=
"U"==this.editCase?RString.toUpper(b):"L"==this.editCase?RString.toLower(b):b,this.hEdit.style.textAlign="right"==this.editAlign?"right":"left"==this.editAlign?"left":"center")},MO.FUiNumber2_validText=function(b){var d=this.__base.FUiEditControl.validText.call(this,b);if(!d){if(this.validLenmin&&this.validLenmin>b.length)return RContext.get("MDescEdit:ValidMinLength",this.validLenmin);if(this.validLenmax&&this.validLenmax<b.length)return RContext.get("MDescEdit:ValidMaxLength",this.validLenmax)}return d},
MO.FUiNumber2_findEditor=function(){if(this.editComplete){var b=this.editor;!b&&(this.dsControl=this.topControl(MDataset))&&(b=this.editor=RConsole.find(FUiNumber2Console).focus(this,FUiNumber2Editor));b&&b.linkControl(this);return this.editor}},MO.FUiNumber2_drop=function(){var b=this.findEditor();if(b){var d=this.reget();0<d.length&&(this.finded!=d&&(b.source!=this&&b.linkControl(this),b.search(d)),this.finded=d)}},MO.FUiNumber2_clone=function(){var b=this._class.newInstance();GHtml_clone(b,this.hPanel);
return b},MO.FUiNumber2_link=function(){};
with(MO)MO.FUiNumber3=function(b){b=RClass.inherits(this,b,FUiEditControl,MListenerDataChanged);b._inputSize=RClass.register(b,new APtySize2("_inputSize"));b._styleValuePanel=RClass.register(b,new AStyle("_styleValuePanel"));b._styleInputPanel=RClass.register(b,new AStyle("_styleInputPanel"));b._styleInput=RClass.register(b,new AStyle("_styleInput"));b._innerOriginValue=null;b._innerDataValue=null;b._hInput=null;b.onBuildEditInput=FUiNumber3_onBuildEditInput;b.onBuildEditValue=FUiNumber3_onBuildEditValue;
b.onInputKeyPress=RClass.register(b,new AEventKeyPress("onInputKeyPress"),FUiNumber3_onInputKeyPress);b.onInputChanged=RClass.register(b,new AEventInputChanged("onInputChanged"),FUiNumber3_onInputChanged);b.construct=FUiNumber3_construct;b.get=FUiNumber3_get;b.set=FUiNumber3_set;return b},MO.FUiNumber3_onBuildEditInput=function(b,d){this.attachEvent("onInputKeyPress",d,this.onInputKeyPress);this.attachEvent("onInputChanged",d,this.onInputChanged)},MO.FUiNumber3_onBuildEditValue=function(b){var d=
this._hValuePanel;d.className=this.styleName("ValuePanel");d=this._hValueForm=RBuilder.appendTable(d);d=RBuilder.appendTableRow(d);this._hChangePanel=RBuilder.appendTableCell(d);this.onBuildEditChange(b);var f=RBuilder.appendTableCell(d,this.styleName("InputPanel"));f.style.borderRight="1px solid #666666";f=this._hInput1=RBuilder.appendEdit(f,this.styleName("Input"));this.onBuildEditInput(b,f);f=RBuilder.appendTableCell(d,this.styleName("InputPanel"));f.style.borderLeft="1px solid #999999";f.style.borderRight=
"1px solid #666666";f=this._hInput2=RBuilder.appendEdit(f,this.styleName("Input"));this.onBuildEditInput(b,f);f=RBuilder.appendTableCell(d,this.styleName("InputPanel"));f.style.borderLeft="1px solid #999999";f=this._hInput3=RBuilder.appendEdit(f,this.styleName("Input"));this.onBuildEditInput(b,f)},MO.FUiNumber3_onInputKeyPress=function(b){EKeyCode.floatCodes[b.keyCode]||b.cancel()},MO.FUiNumber3_onInputChanged=function(b){this.processDataChangedListener(this)},MO.FUiNumber3_construct=function(){this.__base.FUiEditControl.construct.call(this);
this._inputSize=new SSize2(120,0);this._innerOriginValue=new SPoint3;this._innerDataValue=new SPoint3},MO.FUiNumber3_get=function(b){this.__base.FUiEditControl.get.call(this,b);b=this._innerDataValue;var d=this._hInput1;d&&(b.x=RFloat.parse(d.value));if(d=this._hInput2)b.y=RFloat.parse(d.value);if(d=this._hInput3)b.z=RFloat.parse(d.value);return b},MO.FUiNumber3_set=function(b){this.__base.FUiEditControl.set.call(this,b);var d=arguments,f=this._innerOriginValue,h=this._innerDataValue;if(1==d.length)if(b.constructor==
SPoint3||b.constructor==SVector3)f.assign(b),h.assign(b);else throw new TError("Invalid value format.");else if(3==d.length)f.set(d[0],d[1],d[2]),h.assign(f);else throw new TError("Invalid value format.");if(d=this._hInput1)d.value=RFloat.format(h.x,0,null,3,null);if(d=this._hInput2)d.value=RFloat.format(h.y,0,null,3,null);if(d=this._hInput3)d.value=RFloat.format(h.z,0,null,3,null);this.changeSet(!1)},MO.FUiNumber3_onDataKeyDown=function(b,d){this.__base.FUiEditControl.onDataKeyDown.call(this,b,d);
this.editCase&&RKey.fixCase(d,this.editCase)},MO.FUiNumber3_formatValue=function(b){b=RString.nvl(b);ECase.Upper==this.editCase?b=RString.toUpper(b):ECase.Lower==this.editCase&&(b=RString.toLower(b));return b},MO.FUiNumber3_setText=function(b){this.hEdit&&(this.hEdit.value="U"==this.editCase?RString.toUpper(b):"L"==this.editCase?RString.toLower(b):b,this.hEdit.style.textAlign="right"==this.editAlign?"right":"left"==this.editAlign?"left":"center")},MO.FUiNumber3_validText=function(b){var d=this.__base.FUiEditControl.validText.call(this,
b);if(!d){if(this.validLenmin&&this.validLenmin>b.length)return RContext.get("MDescEdit:ValidMinLength",this.validLenmin);if(this.validLenmax&&this.validLenmax<b.length)return RContext.get("MDescEdit:ValidMaxLength",this.validLenmax)}return d},MO.FUiNumber3_findEditor=function(){if(this.editComplete){var b=this.editor;!b&&(this.dsControl=this.topControl(MDataset))&&(b=this.editor=RConsole.find(FUiNumber3Console).focus(this,FUiNumber3Editor));b&&b.linkControl(this);return this.editor}},MO.FUiNumber3_drop=
function(){var b=this.findEditor();if(b){var d=this.reget();0<d.length&&(this.finded!=d&&(b.source!=this&&b.linkControl(this),b.search(d)),this.finded=d)}},MO.FUiNumber3_clone=function(){var b=this._class.newInstance();GHtml_clone(b,this.hPanel);return b},MO.FUiNumber3_link=function(){};
with(MO)MO.FUiNumber4=function(b){b=RClass.inherits(this,b,FUiEditControl);b._inputSize=RClass.register(b,new APtySize2("_inputSize"));b._styleInputPanel=RClass.register(b,new AStyle("_styleInputPanel"));b._styleInput=RClass.register(b,new AStyle("_styleInput"));b._hInput=null;b.onBuildEditValue=FUiNumber4_onBuildEditValue;b.construct=FUiNumber4_construct;b.get=FUiNumber4_get;b.set=FUiNumber4_set;return b},MO.FUiNumber4_oeDataLoad=function(b){alert(b);return EEventStatus.Stop},MO.FUiNumber4_oeDataSave=
function(b){return EEventStatus.Stop},MO.FUiNumber4_onBuildEditValue=function(b){b=this._hValuePanel;b.className=this.styleName("InputPanel");b=this._hInputForm=RBuilder.appendTable(b);b=RBuilder.appendTableRow(b);var d=RBuilder.appendTableCell(b);d.style.borderRight="1px solid #666666";this._hInput1=RBuilder.appendEdit(d,this.styleName("Input"));d=RBuilder.appendTableCell(b);d.style.borderRight="1px solid #666666";d.style.borderLeft="1px solid #999999";this._hInput2=RBuilder.appendEdit(d,this.styleName("Input"));
d=RBuilder.appendTableCell(b);d.style.borderLeft="1px solid #999999";d.style.borderRight="1px solid #666666";this._hInput3=RBuilder.appendEdit(d,this.styleName("Input"));b=RBuilder.appendTableCell(b);b.style.borderLeft="1px solid #999999";this._hInput4=RBuilder.appendEdit(b,this.styleName("Input"))},MO.FUiNumber4_construct=function(){this.__base.FUiEditControl.construct.call(this);this._inputSize=new SSize2(120,0)},MO.FUiNumber4_get=function(b){b=this.__base.FUiEditControl.get.call(this,b);var d=
this._hInput;d&&(b=d.value);return b},MO.FUiNumber4_set=function(b){this.__base.FUiEditControl.set.call(this,b);var d=this._hInput;d&&(d.value=RString.nvl(b))},MO.FUiNumber4_onDataKeyDown=function(b,d){this.__base.FUiEditControl.onDataKeyDown.call(this,b,d);this.editCase&&RKey.fixCase(d,this.editCase)},MO.FUiNumber4_formatValue=function(b){b=RString.nvl(b);ECase.Upper==this.editCase?b=RString.toUpper(b):ECase.Lower==this.editCase&&(b=RString.toLower(b));return b},MO.FUiNumber4_setText=function(b){this.hEdit&&
(this.hEdit.value="U"==this.editCase?RString.toUpper(b):"L"==this.editCase?RString.toLower(b):b,this.hEdit.style.textAlign="right"==this.editAlign?"right":"left"==this.editAlign?"left":"center")},MO.FUiNumber4_validText=function(b){var d=this.__base.FUiEditControl.validText.call(this,b);if(!d){if(this.validLenmin&&this.validLenmin>b.length)return RContext.get("MDescEdit:ValidMinLength",this.validLenmin);if(this.validLenmax&&this.validLenmax<b.length)return RContext.get("MDescEdit:ValidMaxLength",
this.validLenmax)}return d},MO.FUiNumber4_findEditor=function(){if(this.editComplete){var b=this.editor;!b&&(this.dsControl=this.topControl(MDataset))&&(b=this.editor=RConsole.find(FUiNumber4Console).focus(this,FUiNumber4Editor));b&&b.linkControl(this);return this.editor}},MO.FUiNumber4_drop=function(){var b=this.findEditor();if(b){var d=this.reget();0<d.length&&(this.finded!=d&&(b.source!=this&&b.linkControl(this),b.search(d)),this.finded=d)}},MO.FUiNumber4_clone=function(){var b=this._class.newInstance();
GHtml_clone(b,this.hPanel);return b},MO.FUiNumber4_link=function(){};
with(MO)MO.FUiPanel=function(b){b=RClass.inherits(this,b,FUiLayout,MUiDesign,MUiFocus);b._sizeCd=EUiSize.Horizontal;b._stylePanel=RClass.register(b,new AStyle("_stylePanel","Panel"));b._styleLabel=RClass.register(b,new AStyle("_styleLabel","Label"));b._styleBody=RClass.register(b,new AStyle("_styleBody","Body"));b._hImage=null;b._imagePlus="control.panel.plus";b._imageMinus="control.panel.minus";b._statusBody=!0;b.onBuildPanel=FUiPanel_onBuildPanel;b.onTitleClick=RClass.register(b,new AEventClick("onTitleClick"),
FUiPanel_onTitleClick);return b},MO.FUiPanel_onBuildPanel=function(b){b=this._hPanel=RBuilder.createDiv(b,this.styleName("Panel"));var d=RBuilder.appendTable(b,this.styleName("Label"));this.attachEvent("onTitleClick",d);d.width="100%";d=RBuilder.appendTableRow(d);d.vAlign="middle";var f=RBuilder.appendTableCell(d);f.width=20;this._hImage=RBuilder.appendIcon(f,null,this._imageMinus);RBuilder.appendTableCell(d).innerHTML=this._label;b=this._hBody=RBuilder.appendDiv(b,this.styleName("Body"));this._hPanelForm=
RBuilder.appendTable(b,this.styleName("Form"))},MO.FUiPanel_onTitleClick=function(b){this._statusBody=b=!this._statusBody;this._hImage.src=RResource.iconPath(b?this._imageMinus:this._imagePlus);RHtml.displaySet(this._hBody,b)};with(MO)MO.FUiPanelHorizontal=function(b){b=RClass.inherits(this,b,FUiLayoutHorizontal);b._sizeCd=EUiSize.Horizontal;return b};with(MO)MO.FUiPanelVertical=function(b){return b=RClass.inherits(this,b,FUiLayoutVertical)};
with(MO)MO.FUiPicture=function(b){b=RClass.inherits(this,b,FEditControl,MEditBorder,MDescEdit);b.storeType=RClass.register(b,new TPtyStr("storeType"));b.storeCode=RClass.register(b,new TPtyStr("storeCode"));b.storeName=RClass.register(b,new TPtyStr("storeName"));b.editAdjust=RClass.register(b,new TPtyInt("editAdjust"));b.editMaxWidth=RClass.register(b,new TPtyInt("editMaxWidth"));b.editMaxHeight=RClass.register(b,new TPtyInt("editMaxHeight"));b.__seed=0;b.attributes=null;b.border=null;b.borderStyle=
EUiBorder.Round;b.onUploadMouseDown=RClass.register(b,new HMouseDown("onUploadMouseDown"),FUiPicture_onUploadMouseDown);b.onFileUploaded=FUiPicture_onFileUploaded;b.onBuildEdit=FUiPicture_onBuildEdit;b.construct=FUiPicture_construct;b.makeIconPath=FUiPicture_makeIconPath;b.setText=FUiPicture_setText;b.setEditable=FUiPicture_setEditable;b.dispose=FUiPicture_dispose;return b},MO.FUiPicture_onUploadMouseDown=function(b){this._editable&&!this._disbaled&&(b=RConsole.find(FUploadConsole).findWindow(),b.lsnsUploaded.register(this,
this.onFileUploaded),b.typeCode="P",b.fileEdit=!1,b.recordCode=this.recordCode,b.recordGuid=this.recordGuid,b.recordName=this.recordName,b.guid=this.guid,b.adjustWidth=this.editWidth,b.adjustHeight=this.editHeight,b.show())},MO.FUiPicture_onFileUploaded=function(b,d){var f=d.attributes;this.guid=f.get("GUID");this.mime=f.get("MIME");this.networkCode=f.get("NETWORK_CODE");this.hImage.src=this.makeIconPath(this.guid,this.mime,this.networkCode)+"?"+RDate.format()+ ++this.__seed;this.hImage.style.display=
"block"},MO.FUiPicture_onBuildEdit=function(b){b=this.hImageForm=this.hEdit=RBuilder.appendTable(b.hPanel);b.width="100%";b.border=1;b.height="100%";b=this.hImagePanel=b.insertRow().insertCell();b.align="center";b.style.cursor="hand";this.attachEvent("onUploadMouseDown",this.hImagePanel);b=this.hImage=RBuilder.append(b,"IMAGE");b.style.border="1 solid #CCCCCC";b.style.display="none";0<this.left&&0<this.top&&(this.hPanel.style.position="absolute")},MO.FUiPicture_construct=function(){this.base.FEditControl.construct.call(this);
this.attributes=new TAttributes},MO.FUiPicture_makeIconPath=function(b,d,f){b=this.recordCode+"/"+this.recordGuid+"/"+b+".icon."+d;return top.RContext.context("/svr/"+f.toLowerCase()+"/sys/"+RString.toLower(b))},MO.FUiPicture_setText=function(b){var d=this.attributes;d.clear();var f=!1;RString.isEmpty(b)||(d.unpack(b),this.networkCode=d.get("nc"),this.recordCode=d.get("code"),this.recordGuid=d.get("guid"),this.recordName=d.get("name"),this.guid=d.get("ogid"),this.mime=d.get("mime"),this.guid&&this.mime&&
(f=!0,this.hImage.src=this.makeIconPath(this.guid,this.mime,this.networkCode)));this.hImage.style.display=f?"block":"none"},MO.FUiPicture_setEditable=function(b){this.base.FEditControl.setEditable.call(this,b);this.hImagePanel.style.cursor=b?"hand":"normal"},MO.FUiPicture_dispose=function(){this.base.FEditControl.dispose.call(this);this.hImage=null};
with(MO)MO.FUiProgressBar=function(b){b=RClass.inherits(this,b,FDuiControl);b._stylePanel=RClass.register(b,new AStyle("_stylePanel"));b._rate=0;b._hForm=null;b.onBuildPanel=FUiProgressBar_onBuildPanel;b.onBuild=FUiProgressBar_onBuild;b.get=FUiProgressBar_get;b.set=FUiProgressBar_set;b.dispose=FUiProgressBar_dispose;return b},MO.FUiProgressBar_onBuildPanel=function(b){this._hPanel=RBuilder.createTable(b,this.styleName("Panel"))},MO.FUiProgressBar_onBuild=function(b){this.__base.FDuiControl.onBuild.call(this,
b);b=this._hLine=RBuilder.appendTableRow(this._hPanel);this.hProgress=RBuilder.appendTableCell(b);this.hEmpty=RBuilder.appendTableCell(b)},MO.FUiProgressBar_get=function(){return this._rate},MO.FUiProgressBar_set=function(b){this._rate=b},MO.FUiProgressBar_dispose=function(){this._hForm=RHtml.free(this._hForm);this.__base.FDuiControl.dispose.call(this)};
with(MO)MO.FUiRadio=function(b){b=RClass.inherits(this,b,FEditControl);b._groupName=RClass.register(b,new APtyString("_groupName"));b._styleInput=RClass.register(b,new AStyle("_styleInput","Input"));b._hInput=null;b.onBuildEditValue=FUiRadio_onBuildEditValue;return b},MO.FUiRadio_onBuildEditValue=function(b){this._hInput=RBuilder.appendRadio(this._hValuePanel,this.styleName("Input"))},MO.FUiRadio_clearValue=function(){this.hEdit.checked=!1},MO.FUiRadio_resetValue=function(){this.hEdit.checked=this._editChecked},
MO.FUiRadio_saveValue=function(b){this.hEdit.checked&&b.set(this.dataName,this.dataDefault)},MO.FUiRadio_text=function(){return this.hEdit.checked?this.dataDefault:""},MO.FUiRadio_setText=function(b){this.hEdit.checked=this.dataDefault==b},MO.FUiRadio_refreshStyle=function(){var b=this.panel(EPanel.Edit);b.disabled=!this._editable;b.style.cursor=this._editable?"hand":"normal"};
with(MO)MO.FUiSelect=function(b){b=RClass.inherits(this,b,FUiEditControl,MUiContainer,MPropertySelect,MListenerDataChanged);b._styleValuePanel=RClass.register(b,new AStyle("_styleValuePanel"));b._styleInput=RClass.register(b,new AStyle("_styleInput"));b._hValueForm=null;b._hValueLine=null;b._hInputPanel=null;b._hInput=null;b.onBuildEditValue=FUiSelect_onBuildEditValue;b.onDoubleClick=RClass.register(b,new AEventDoubleClick("onDoubleClick"),FUiSelect_onDropClick);b.onDropClick=FUiSelect_onDropClick;
b.onKeyDown=RClass.register(b,new AEventKeyDown("onKeyDown"),FUiSelect_onKeyDown);b.construct=FUiSelect_construct;b.findItemByLabel=FUiSelect_findItemByLabel;b.findItemByData=FUiSelect_findItemByData;b.formatValue=FUiSelect_formatValue;b.formatDisplay=FUiSelect_formatDisplay;b.get=FUiSelect_get;b.set=FUiSelect_set;b.selectItem=FUiSelect_selectItem;b.refreshValue=FUiSelect_refreshValue;b.drop=FUiSelect_drop;b.dispose=FUiSelect_dispose;return b},MO.FUiSelect_onBuildEditValue=function(b){var d=this._hValuePanel;
d.className=this.styleName("ValuePanel");d=this._hValueForm=RBuilder.appendTable(d);d.width="100%";d=this._hValueLine=RBuilder.appendTableRow(d);this._hChangePanel=RBuilder.appendTableCell(d);this.onBuildEditChange(b);var f=this._hInputPanel=RBuilder.appendTableCell(d),f=this._hInput=RBuilder.appendEdit(f,this.styleName("Input"));this.attachEvent("onDoubleClick",f);this.attachEvent("onKeyDown",f);this._editLength&&(f.maxLength=this._editLength);(this._hDropPanel=RBuilder.appendTableCell(d)).style.borderLeft=
"1px solid #666666";this.onBuildEditDrop(b);d=this._emptyItem=RClass.create(FUiSelectItem);d.build(b);this.push(d)},MO.FUiSelect_onDropClick=function(b){this.drop()},MO.FUiSelect_onKeyDown=function(b){var d=this._editor;if(d&&d._statusEditing&&d._source==this)d.onEditKeyDown(b);else b.keyCode==EKeyCode.Down&&this.drop()},MO.FUiSelect_construct=function(){this.__base.FUiEditControl.construct.call(this)},MO.FUiSelect_findItemByLabel=function(b){var d=this._components;if(d)for(var f=d.count()-1;0<=f;f--){var h=
d.valueAt(f);if(RString.equals(h._label,b,!0))return h}return null},MO.FUiSelect_findItemByData=function(b){var d=this._components;if(d)for(var f=d.count()-1;0<=f;f--){var h=d.valueAt(f);if(RString.equals(h._dataValue,b,!0))return h}return null},MO.FUiSelect_formatValue=function(b){var d=this.findItemByLabel(b);return d?RString.nvl(d._dataValue):b},MO.FUiSelect_formatDisplay=function(b){var d=this.findItemByData(b);return d?RString.nvl(d._label):b},MO.FUiSelect_get=function(){return this.formatValue(this._hInput.value)},
MO.FUiSelect_set=function(b){b=this.formatDisplay(b);this._hInput.value=RString.nvl(b)},MO.FUiSelect_selectItem=function(b){this._hInput.value=RString.nvl(b.label());this.refreshValue()},MO.FUiSelect_refreshValue=function(){this.processDataChangedListener(this)},MO.FUiSelect_drop=function(){if(this.hasComponent()){var b=this._editor=RConsole.find(FUiEditorConsole).focus(this,FUiSelectEditor,this._name);b.buildItems(this);b.set(this.get());b.show()}},MO.FUiSelect_dispose=function(){this.__base.FUiEditControl.dispose.call(this)},
MO.FUiSelect_onEditEnd=function(b){b&&(this.set(b.get()),this._invalidText=this.validText(this.text()),this.refreshStyle());this.onDataEditEnd(this)},MO.FUiSelect_loadConfig=function(b){this.__base.FUiEditControl.loadConfig.call(this,b);this.dataEmpty&&this.items.create();this.editCheck||this.items.create("","");this.items.loadConfig(b);if(b=b.nodes)for(var d=b.count,f=0;f<d;f++){var h=b.get(f);if(h.isName("Event")){var q=RClass.create(FEvent);q.loadConfig(h);this.push(q)}}return EStatus.Stop},MO.FUiSelect_refreshStyle=
function(){this.__base.FUiEditControl.refreshStyle.call(this);this.editCheck||(this.hEdit.readOnly="true")},MO.FUiSelect_doBlur=function(){this.__base.FUiEditControl.doBlur.call(this);this._editor&&this._editor.hide()};
with(MO)MO.FUiSelectEditor=function(b){b=RClass.inherits(this,b,FUiDropEditor,MListenerItemClick);b._items=null;b._position=null;b._hDropLayout=null;b._hItemsForm=null;b.onBuildDrop=FUiSelectEditor_onBuildDrop;b.onItemClick=FUiSelectEditor_onItemClick;b.onEditKeyDown=FUiSelectEditor_onEditKeyDown;b.onEditEnd=FUiSelectEditor_onEditEnd;b.construct=FUiSelectEditor_construct;b.testBlur=FUiSelectEditor_testBlur;b.buildItems=FUiSelectEditor_buildItems;b.clearItems=FUiSelectEditor_clearItems;b.get=FUiSelectEditor_get;
b.set=FUiSelectEditor_set;b.select=FUiSelectEditor_select;b.fetch=FUiSelectEditor_fetch;b.setVisible=FUiSelectEditor_setVisible;b.dispose=FUiSelectEditor_dispose;return b},MO.FUiSelectEditor_onBuildDrop=function(){var b=this._hDropLayout=RBuilder.appendDiv(this._hDropPanel),b=this._hItemsForm=RBuilder.appendTable(b);this._hItemsBody=RBuilder.append(b,"TBODY")},MO.FUiSelectEditor_onItemClick=function(b){this._position=this._items.indexOfValue(b);this.editEnd()},MO.FUiSelectEditor_onEditKeyDown=function(b){switch(b.keyCode){case EKeyCode.Up:this.select(this._position-
1);break;case EKeyCode.Down:this.select(this._position+1);break;case EKeyCode.Enter:this.editEnd();break;case EKeyCode.Esc:this.editCancel()}},MO.FUiSelectEditor_onEditEnd=function(){var b=this._source,d=this._items.value(this._position);b.selectItem(d);this.__base.FUiDropEditor.onEditEnd.call(this)},MO.FUiSelectEditor_construct=function(){this.__base.FUiDropEditor.construct.call(this)},MO.FUiSelectEditor_testBlur=function(b){return this._source==b?!1:!this._items.contains(b)},MO.FUiSelectEditor_clearItems=
function(){var b=this._hItemsBody,d=this._items;if(d)for(var f=d.count()-1;0<=f;f--){var h=d.value(f);h.removeClickListener(this,this.onItemClick);b.removeChild(h._hPanel)}this._position=0},MO.FUiSelectEditor_buildItems=function(b){var d=this._hItemsBody;b=b.components();if(b!=this._items){this.clearItems();for(var f=b.count(),h=0;h<f;h++){var q=b.value(h);q.addClickListener(this,this.onItemClick);q.setPanel(d)}this._position=0;this._items=b}},MO.FUiSelectEditor_get=function(){return this._items.get(this._position).value},
MO.FUiSelectEditor_set=function(b){this._position=-1;for(var d=this._items,f=d.count(),h=0;h<f;h++){var q=d.value(h);RString.equals(q._dataValue,b,!0)?(this._position=h,q.setChecked(!0)):q.setChecked(!1)}},MO.FUiSelectEditor_select=function(b){var d=this._items,f=d.count();b=RInteger.toRange(b,0,f-1);for(var h=0;h<f;h++)d.value(h).setChecked(h==b);this._position=b},MO.FUiSelectEditor_fetch=function(){if(!this.hasFetched){var b=new TCodeListServiceArg,d=this._source.topControl(MDataset);b.values=d.getCurrentRows();
b.name=this._source.editRefer;if(b=RConsole.find(FCodeListConsole).fetch(b))d=this._source,d._items.clear(),d._items.loadConfig(b.root().nodes.get(0));this.hasFetched=!0}},MO.FUiSelectEditor_setVisible=function(b){this.__base.FUiDropEditor.setVisible.call(this,b);var d=this._hPanel,f=this._hItemsForm;if(b){b=this._source.getValueRectangle(RValue.rectangle);f.width="";var h=f.offsetWidth;d.style.left=b.left()+"px";d.style.top=b.bottom()+"px";d.style.width=Math.max(h,b.width())+"px";f.width="100%";
f.offsetHeight>this._minHeight&&(this._hDropLayout.style.overflowY="scroll",this._hDropLayout.style.height=this._minHeight+"px")}},MO.FUiSelectEditor_dispose=function(){this._hDropLayout=RHtml.free(this._hDropLayout);this._hItemsForm=RHtml.free(this._hItemsForm);this.__base.FUiDropEditor.dispose.call(this)};
with(MO)MO.FUiSelectItem=function(b){b=RClass.inherits(this,b,FDuiControl,MListenerClick);b._icon=RClass.register(b,new APtyString("_icon"));b._note=RClass.register(b,new APtyString("_note"));b._dataValue=RClass.register(b,new APtyString("_dataValue"));b._styleNormal=RClass.register(b,new AStyle("_styleNormal"));b._styleHover=RClass.register(b,new AStyle("_styleHover"));b._styleSelect=RClass.register(b,new AStyle("_styleSelect"));b._styleIconChecked=RClass.register(b,new AStyle("_styleIcon"));b._styleLabel=
RClass.register(b,new AStyle("_styleLabel"));b._styleNote=RClass.register(b,new AStyle("_styleNote"));b._checked=!1;b._hIconPanel=null;b._hIcon=null;b._hLabelPanel=null;b._hNotePanel=null;b.onBuildPanel=FUiSelectItem_onBuildPanel;b.onBuild=FUiSelectItem_onBuild;b.onEnter=FUiSelectItem_onEnter;b.onLeave=FUiSelectItem_onLeave;b.onMouseDown=RClass.register(b,new AEventMouseDown("onMouseDown"),FUiSelectItem_onMouseDown);b.setChecked=FUiSelectItem_setChecked;b.set=FUiSelectItem_set;b.dispose=FUiSelectItem_dispose;
return b},MO.FUiSelectItem_onBuildPanel=function(b){this._hPanel=RBuilder.createTableRow(b,this.styleName("Normal"))},MO.FUiSelectItem_onBuild=function(b){this.__base.FDuiControl.onBuild.call(this,b);b=this._hPanel;this.attachEvent("onMouseDown",b);var d=this._hIconPanel=RBuilder.appendTableCell(b,this.styleName("Icon"));d.width=18;d.align="center";d=this._hLabelPanel=RBuilder.appendTableCell(b,this.styleName("Label"));d.innerHTML=this._label?this._label:"&nbsp;";this._hNotePanel=RBuilder.appendTableCell(b,
this.styleName("Note"))},MO.FUiSelectItem_onEnter=function(){this.__base.FDuiControl.onEnter.call(this);this._hPanel.className=RBoolean.parse(this._checked)?this.styleName("Select"):this.styleName("Hover")},MO.FUiSelectItem_onLeave=function(){this._hPanel.className=RBoolean.parse(this._checked)?this.styleName("Select"):this.styleName("Normal");this.__base.FDuiControl.onLeave.call(this)},MO.FUiSelectItem_onMouseDown=function(){this.processClickListener(this)},MO.FUiSelectItem_setChecked=function(b){this._checked=
b;this._hIcon?this._hIcon.style.display=b?"block":"none":this._hIconPanel.innerHTML=b?"O":"";this._hPanel.className=b?this.styleName("Select"):this.styleName("Normal")},MO.FUiSelectItem_set=function(b,d,f,h){this._icon=RString.nvl(b);RString.isEmpty(this._icon)||(this._hIcon=RBuilder.appendIcon(this._hIconPanel,this.styleIcon(this._icon)));this._label=RString.nvl(d);this._value=RString.nvl(f);this._note=RString.nvl(h);this._hLabelPanel.innerText=this._label;this._hNotePanel.innerText=this._note},
MO.FUiSelectItem_dispose=function(){this._hIconPanel=RHtml.free(this._hIconPanel);this._hLabelPanel=RHtml.free(this._hLabelPanel);this._hNotePanel=RHtml.free(this._hNotePanel);this.__base.FDuiControl.dispose.call(this)};
with(MO)MO.FUiSlideNumber=function(b){b=RClass.inherits(this,b,FUiEditControl,MPropertyNumber,MListenerDataChanged,MMouseCapture);b._inputSize=RClass.register(b,new APtySize2("_inputSize"));b._styleSlidePanel=RClass.register(b,new AStyle("_styleSlidePanel"));b._styleValuePanel=RClass.register(b,new AStyle("_styleValuePanel"));b._styleInput=RClass.register(b,new AStyle("_styleInput"));b._styleAdjustForm=RClass.register(b,new AStyle("_styleAdjustForm"));b._styleUpPanel=RClass.register(b,new AStyle("_styleUpPanel"));
b._styleDownPanel=RClass.register(b,new AStyle("_styleDownPanel"));b._innerOriginValue=null;b._innerDataValue=null;b._slide=null;b._hInput=null;b._iconUp=null;b._iconDown=null;b.onBuildEditValue=FUiSlideNumber_onBuildEditValue;b.onMouseCaptureStart=FUiSlideNumber_onMouseCaptureStart;b.onMouseCapture=FUiSlideNumber_onMouseCapture;b.onMouseCaptureStop=FUiSlideNumber_onMouseCaptureStop;b.onSlideChange=FUiSlideNumber_onSlideChange;b.onInputKeyPress=RClass.register(b,new AEventKeyPress("onInputKeyPress"),
FUiSlideNumber_onInputKeyPress);b.onInputEdit=RClass.register(b,new AEventInputChanged("onInputEdit"),FUiSlideNumber_onInputEdit);b.onInputChange=RClass.register(b,new AEventChange("onInputChange"),FUiSlideNumber_onInputChange);b.construct=FUiSlideNumber_construct;b.get=FUiSlideNumber_get;b.set=FUiSlideNumber_set;b.setInputValue=FUiSlideNumber_setInputValue;b.refreshValue=FUiSlideNumber_refreshValue;return b},MO.FUiSlideNumber_onBuildEditValue=function(b){var d=this._hValuePanel;d.className=this.styleName("ValuePanel");
d=this._hValueForm=RBuilder.appendTable(d);d.__linker=this;d.width="100%";d=this._hValueLine=RBuilder.appendTableRow(d);this._hChangePanel=RBuilder.appendTableCell(d);this.onBuildEditChange(b);b=this._hSlidePanel=RBuilder.appendTableCell(d,this.styleName("SlidePanel"));var f=this._slide=new SUiSlide;f.control=this;f.hPanel=b;f.setRange(this._valueMin,this._valueMax);f.onSlideChange=this.onSlideChange;f.build();b=this._hInputPanel=RBuilder.appendTableCell(d);f=this._hInput=RBuilder.appendEdit(b,this.styleName("Input"));
this.attachEvent("onInputKeyPress",f,this.onInputKeyPress);this.attachEvent("onInputEdit",f,this.onInputEdit);this.attachEvent("onInputChange",f,this.onInputChange);RHtml.setSize(b,this._inputSize);this._editLength&&(f.maxLength=this._editLength);d=this._hAdjustPanel=RBuilder.appendTableCell(d);d.style.borderLeft="1px solid #666666";d.width=12;d=this.hAdjustForm=RBuilder.appendTable(d,this.styleName("AdjustForm"));b=RBuilder.appendTableRowCell(d);b.className=this.styleName("UpPanel");(this._hUpIcon=
RBuilder.appendIcon(b,null,"control.number.up")).align="center";b=RBuilder.appendTableRowCell(d);b.className=this.styleName("DownPanel");this._hDownIcon=RBuilder.appendIcon(b,null,"control.number.down")},MO.FUiSlideNumber_onMouseCaptureStart=function(b){var d=RHtml.searchObject(b.hSource,"__pcapture");if(d)d.onMouseDown(b)},MO.FUiSlideNumber_onMouseCapture=function(b){var d=RHtml.searchObject(b.hSource,"__pcapture");if(d)d.onMouseMove(b)},MO.FUiSlideNumber_onMouseCaptureStop=function(b){var d=RHtml.searchObject(b.hSource,
"__pcapture");if(d)d.onMouseUp(b)},MO.FUiSlideNumber_onSlideChange=function(b){this.setInputValue(b);this.refreshValue()},MO.FUiSlideNumber_onInputKeyPress=function(b){RKeyboard.isFloatKey(b.keyCode)||b.cancel()},MO.FUiSlideNumber_onInputEdit=function(b){this._slide.set(this._hInput.value);this.refreshValue()},MO.FUiSlideNumber_onInputChange=function(b){b=this._hInput.value;this._slide.set(b);this.setInputValue(b);this.refreshValue()},MO.FUiSlideNumber_construct=function(){this.__base.FUiEditControl.construct.call(this);
this._inputSize=new SSize2(120,0)},MO.FUiSlideNumber_get=function(b){b=RFloat.parse(this._hInput.value);return RFloat.toRange(b,this._valueMin,this._valueMax)},MO.FUiSlideNumber_set=function(b){this.__base.FUiEditControl.set.call(this,b);this._innerDataValue=this._innerOriginValue=b=RString.nvl(b,"0");this._slide.set(b);this.setInputValue(b);this.changeSet(!1)},MO.FUiSlideNumber_setInputValue=function(b){b=RFloat.parse(b);isNaN(b)||(b=RFloat.toRange(b,this._valueMin,this._valueMax),this._dataDisplay=
RFloat.format(b,0,null,2,null),this._hInput.value=this._dataDisplay)},MO.FUiSlideNumber_refreshValue=function(){this.processDataChangedListener(this)};
with(MO)MO.FUiSplit=function(b){return b=RClass.inherits(this,b,FDuiControl)},MO.FUiSplit_onSplitMouseEnter=function(b){this.hImage&&(this.hImage.src=RRes._iconPath(this.extended?"ctl.collapse_hvr":"ctl.expand_hvr"))},MO.FUiSplit_onSplitMouseLeave=function(b){this.hImage&&(this.hImage.src=RRes._iconPath(this.extended?"ctl.collapse_nor":"ctl.expand_nor"))},MO.FUiSplit_onMouseDown=function(){ESplitStyle.Normal==this._dispStyle&&this.extend(!this.extended)},MO.FUiSplit_onBuildPanel=function(){this.hPanel=
RBuilder.create(null,"DIV");this.hForm=RBuilder.appendTable(this.hPanel);this.hForm.width="100%"},MO.FUiSplit_oeBuild=function(b){this.base.FDuiControl.oeBuild.call(this,b);this.height=2;if(RString.equals(this._dispStyle,ESplitStyle.Normal)){b=this.hForm;var d=b.insertRow();this.attachEvent("onSplitMouseEnter",b);this.attachEvent("onSplitMouseLeave",b);b=d.insertCell();b.width="100%";b.height=25;b.style.padding="0 0";b.style.background="url("+RRes._iconPath("ctl.FUiSplit_Panel")+")";RBuilder.appendEmpty(b,
4);this.hImage=RBuilder.appendIcon(b,this._iconMinus);this._icon&&(this.hIcon=RBuilder.appendIcon(b,this._icon));this.hText=RBuilder.appendText(b,"&nbsp;&nbsp;"+this.label);this.hText.style.fontWeight="BOLD"}else RString.equals(this._dispStyle,ESplitStyle.BulgeLine)?(b=this.hForm.insertRow().insertCell(),b.style.borderBottom="1px solid #666666",b.style.borderTop="1px solid #DDDDDD",b.height=2):RString.equals(this._dispStyle,ESplitStyle.HollowLine)&&(b=this.hForm.insertRow().insertCell(),b.style.borderBottom=
"1px solid #DDDDDD",b.style.borderTop="1px solid #666666",b.height=2);return EEventStatus.Stop},MO.FUiSplit_oeMode=function(b){var d=this.base.FDuiControl.oeMode.call(this,b);this.base.MDisplay.oeMode.call(this,b);this.extend(this._editExtend);return d},MO.FUiSplit_construct=function(){this.__lines=new TList},MO.FUiSplit_extend=function(b){if(EMode.Design!=this._emode&&this.extended!=b){this.extended=b;this.hImage&&(this.hImage.src=b?RResource._iconPath(this._iconMinus):RRes._iconPath(this._iconPlus));
for(var d=this.__lines.count,f=0;f<d;f++)this.__lines.get(f).style.display=b?"block":"none";this.topControl().topResize(this)}},MO.FUiSplit_pushLine=function(b){this.__lines.push(b)},MO.FUiSplit_dispose=function(){this.base.FDuiControl.dispose.call(this);this.__lines&&(this.__lines.release(),this.__lines=null);this.hImage=this.hIcon=this.hText=this.hForm=null};
with(MO)MO.FUiTemplate=function(b){b=RClass.inherits(this,b,FUiEditControl,MPropertyEdit,MListenerDataChanged);b._inputSize=RClass.register(b,new APtySize2("_inputSize"));b._unit=RClass.register(b,new APtyString("_unit"));b._styleValuePanel=RClass.register(b,new AStyle("_styleValuePanel"));b._styleInputPanel=RClass.register(b,new AStyle("_styleInputPanel"));b._styleInput=RClass.register(b,new AStyle("_styleInput"));b._hValueForm=null;b._hValueLine=null;b._hInputPanel=null;b._hInput=null;b.onBuildEditValue=
FUiTemplate_onBuildEditValue;b.onInputEdit=RClass.register(b,new AEventInputChanged("onInputEdit"),FUiTemplate_onInputEdit);b.construct=FUiTemplate_construct;b.formatDisplay=FUiTemplate_formatDisplay;b.formatValue=FUiTemplate_formatValue;b.get=FUiTemplate_get;b.set=FUiTemplate_set;b.refreshValue=FUiTemplate_refreshValue;return b},MO.FUiTemplate_onBuildEditValue=function(b){var d=this._hValuePanel;d.className=this.styleName("ValuePanel");d=this._hValueForm=RBuilder.appendTable(d);d.width="100%";d=
this._hValueLine=RBuilder.appendTableRow(d);this._hChangePanel=RBuilder.appendTableCell(d);this.onBuildEditChange(b);b=this._hInputPanel=RBuilder.appendTableCell(d);d=this._hInput=RBuilder.appendEdit(b,this.styleName("Input"));this.attachEvent("onInputEdit",d,this.onInputEdit);RHtml.setSize(b,this._inputSize);this._editLength&&(d.maxLength=this._editLength)},MO.FUiTemplate_onInputEdit=function(b){this.refreshValue()},MO.FUiTemplate_construct=function(){this.__base.FUiEditControl.construct.call(this);
this._inputSize=new SSize2(120,0)},MO.FUiTemplate_formatDisplay=function(b){return this._dataDisplay=b=RString.nvl(b)},MO.FUiTemplate_formatValue=function(b){return b},MO.FUiTemplate_get=function(){var b=this.__base.FUiEditControl.get.call(this);return b=this._hInput.value},MO.FUiTemplate_set=function(b){this.__base.FUiEditControl.set.call(this,b);this._hInput.value=RString.nvl(b)},MO.FUiTemplate_refreshValue=function(){this.processDataChangedListener(this)};
with(MO)MO.FUiText=function(b){b=RClass.inherits(this,b,FUiTextControl,MPropertyEdit,MListenerDataChanged);b._inputSize=RClass.register(b,new APtySize2("_inputSize"));b._unit=RClass.register(b,new APtyString("_unit"));b._styleValuePanel=RClass.register(b,new AStyle("_styleValuePanel"));b._styleInputPanel=RClass.register(b,new AStyle("_styleInputPanel"));b._styleInput=RClass.register(b,new AStyle("_styleInput"));b._hValueForm=null;b._hValueLine=null;b._hInputPanel=null;b._hInput=null;b.onBuildEditValue=
FUiText_onBuildEditValue;b.onInputEdit=RClass.register(b,new AEventInputChanged("onInputEdit"),FUiText_onInputEdit);b.construct=FUiText_construct;b.formatDisplay=FUiText_formatDisplay;b.formatValue=FUiText_formatValue;b.get=FUiText_get;b.set=FUiText_set;b.refreshValue=FUiText_refreshValue;return b},MO.FUiText_onBuildEditValue=function(b){var d=this._hValuePanel;d.className=this.styleName("ValuePanel");d=this._hValueForm=RBuilder.appendTable(d);d.width="100%";d=this._hValueLine=RBuilder.appendTableRow(d);
this._hChangePanel=RBuilder.appendTableCell(d);this.onBuildEditChange(b);b=this._hInputPanel=RBuilder.appendTableCell(d);d=this._hInput=RBuilder.appendEdit(b,this.styleName("Input"));this.attachEvent("onInputEdit",d,this.onInputEdit);RHtml.setSize(b,this._inputSize);this._editLength&&(d.maxLength=this._editLength)},MO.FUiText_onInputEdit=function(b){this.refreshValue()},MO.FUiText_construct=function(){this.__base.FUiTextControl.construct.call(this);this._inputSize=new SSize2(120,0)},MO.FUiText_formatDisplay=
function(b){return this._dataDisplay=b=RString.nvl(b)},MO.FUiText_formatValue=function(b){return b},MO.FUiText_get=function(){var b=this.__base.FUiTextControl.get.call(this);return b=this._hInput.value},MO.FUiText_set=function(b){this.__base.FUiTextControl.set.call(this,b);this._hInput.value=RString.nvl(b)},MO.FUiText_refreshValue=function(){this.processDataChangedListener(this)};MO.EUiGridColumn=new function(){this.None=0;this.Size=1;this.Drag=2;return this};
MO.EUiGridDisplay=new function(){this.Title="T";this.Head="H";this.Search="S";this.Total="A";this.Navigator="N";return this};
with(MO)MO.FUiCell=function(b){b=RClass.inherits(this,b,FControl,MEditValue,MDataValue);b._stylePanel=RClass.register(b,new AStyle("_stylePanel"));b._table=null;b._column=null;b._row=null;b.onBuildPanel=FUiCell_onBuildPanel;b.onBuild=FUiCell_onBuild;b.oeDataLoad=FUiCell_oeDataLoad;b.oeDataSave=FUiCell_oeDataSave;return b},MO.FUiCell_onBuildPanel=function(b){this._hPanel=RBuilder.create(b,"TD",this.styleName("Panel"))},MO.FUiCell_onBuild=function(b){this.__base.FControl.onBuild.call(this,b);RHtml.linkSet(this._hPanel,
"control",this)},MO.FUiCell_oeDataLoad=function(b){var d=this._column;b=b.source.currentRow().get(d._dataName);this.set(b);return EEventStatus.Stop},MO.FUiCell_oeDataSave=function(b){var d=this._column;b=b.source.currentRow();var f=this.get();b.set(d._dataName,f);return EEventStatus.Stop},MO.FUiCell_doFocus=function(){this._table.__focusCell=this;if(this._column.isEditAble(this)){var b=this._hPanel.style;b.borderLeft="1px solid #666666";b.borderTop="1px solid #666666";b.borderRight="1px solid #CCCCCC";
b.borderBottom="1px solid #CCCCCC";this.__focus=!0;this.refreshStyle()}},MO.FUiCell_doBlur=function(){if(this._column.isEditAble(this)){var b=this._hPanel.style;b.borderLeft="0px solid #666666";b.borderTop="0px solid #666666";b.borderRight="1px solid #F0F0F0";b.borderBottom="1px dotted #CCCCCC";this.__focus=!1;this.refreshStyle()}},MO.FUiCell_descriptor=function(){return this._column},MO.FUiCell_text=function(){var b=this._column;return EEditFormat.Html==b.editFormat?this._hPanel.innerHTML:b._absEdit&&
this._hEdit?this._hEdit.value:this._hEditPanel?this._hEditPanel.innerText:""},MO.FUiCell_setText=function(b){var d=this._column;EEditFormat.Html==d.editFormat?this._hPanel.innerHTML=b:d._absEdit&&this._hEdit?this._hEdit.value=b:this._hEditPanel&&(this._hEditPanel.innerText=b)},MO.FUiCell_focus=function(b){var d=this._hEdit;d&&(this._column._table.selectRow(this._row,!0,!0),d.focus(),b&&d.select())},MO.FUiCell_setVisible=function(b){this._hPanel.style.display=b?"block":"none"},MO.FUiCell_refreshStyle=
function(){var b=this._table,d=this._row,f=d.isSelect,h=this._hEdit;h&&(h.readOnly=!0,h.style.color=EColor.TextReadonly,h.style.backgroundColor=q);var q=null,q=f?EColor._rowSelect:b.__hoverRow==d?EColor._rowHover:EColor._rows[d.index%EColor._rows.length];this.__focus&&(q=EColor._rowEditHover);this._hPanel.style.backgroundColor=q},MO.FUiCell_dispose=function(){this.base.FControl.dispose.call(this);RMemory.freeHtml(this._hPanel);this.hDrop=this.hDropPanel=this._hEdit=this._hEditPanel=this.hIcon=this.hIconPanel=
this.hFormLine=this.hForm=this._hPanel=null},MO.FUiCell_dump=function(b){b=RString.nvlStr(b);b.append(RClass.dump(this),"[");b.append(this.value);b.append("]");return b};
with(MO)MO.FUiCellButton=function(b){b=RClass.inherits(this,b,FCell);b.buttons=null;b.attributes=null;b.onButtonEnter=RClass.register(b,new AEventMouseEnter("onButtonEnter"),FUiCellButton_onButtonEnter);b.onButtonLeave=RClass.register(b,new AEventMouseLeave("onButtonLeave"),FUiCellButton_onButtonLeave);b.onCellLeave=RClass.register(b,new AEventMouseLeave("onCellLeave"),FUiCellButton_onCellLeave);b.onHintEnter=RClass.register(b,new AEventMouseEnter("onHintEnter"),FUiCellButton_onHintEnter);b.onHintLeave=
RClass.register(b,new AEventMouseLeave("onHintLeave"),FUiCellButton_onHintLeave);b.onButtonClick=RClass.register(b,new AEventClick("onButtonClick"),FUiCellButton_onButtonClick);b.construct=FUiCellButton_construct;b.isDataChanged=RMethod.emptyFalse;b.findButtonByPanel=FUiCellButton_findButtonByPanel;b.buildForm=FUiCellButton_buildForm;b.set=FUiCellButton_set;b.modifyButton=FUiCellButton_modifyButton;b.refreshStyle=FUiCellButton_refreshStyle;return b},MO.FUiCellButton_onButtonEnter=function(b){if(b=
this.findButtonByPanel(b.hSource)){var d=b.hPanel.style;d.color="black";d.cursor="hand";b.hintBox&&(b.hintBox.style.display="block")}this.hHintPanel&&(this.hHintPanel.style.display="")},MO.FUiCellButton_onButtonLeave=function(b){if(b=this.findButtonByPanel(b.hSource))b=b.hPanel.style,b.color="#0661B0",b.cursor="normal"},MO.FUiCellButton_onHintEnter=function(b){b.hSource.style.backgroundColor="#eeeeee"},MO.FUiCellButton_onCellLeave=function(b){b=this.buttons;for(var d=b.count,f=0;f<d;f++){var h=b.value(f);
h.hintBox&&(h.hintBox.style.display="none")}},MO.FUiCellButton_onHintLeave=function(b){b.hSource.style.backgroundColor="#ffffff";b.hSource.style.display="none"},MO.FUiCellButton_onButtonClick=function(b){this.table.clickCell(this);var d=this.findButtonByPanel(b.hSource);d&&d.button.callEvent("onClick",this,b)},MO.FUiCellButton_construct=function(){this.base.FCell.construct.call(this);this.attributes=new TAttributes},MO.FUiCellButton_findButtonByPanel=function(b){for(var d=this.buttons,f=0;f<d.count;f++){var h=
d.value(f);if(h.hPanel==b)return h}},MO.FUiCellButton_buildForm=function(){var b=this.column,d=this.hPanel;RControl.attachEvent(this,"onCellLeave",d,this.onCellLeave);d.align="left";d.padding=1;d=this.hFormLine=(this.hForm=RBuilder.appendTable(this.hPanel)).insertRow();if(b=b.components){this.buttons=new TMap;for(var f=0;f<b.count;f++){var h=b.value(f),q=d.insertCell();q.align="center";q.style.padding="0 3";var w=RBuilder.append(q,"DIV"),z=null;h.icon?z=RBuilder.appendIcon(w,h.icon):(w.style.padding=
"2 6",w.style.color="#0661B0",w.style.textDecoration="underline");this.attachEvent("onButtonEnter",w,this.onButtonEnter);this.attachEvent("onButtonLeave",w,this.onButtonLeave);this.attachEvent("onButtonClick",w,this.onButtonClick);var A=null;h.label&&(h.icon?z.title=h.label:A=RBuilder.appendText(w,h.label));var B=new TCellButton;B.button=h;B.hLayout=q;B.hPanel=w;B.hIcon=z;B.hText=A;this.buttons.set(h.name,B)}d=this.hHintPanel=this.hForm.insertRow().insertCell();d.height=1;d.style.position="relative"}},
MO.FUiCellButton_set=function(b){if(!RString.isEmpty(b)){var d=new TAttributes;d.unpack(b);for(b=0;b<d.count;b++){var f=this.buttons.get(d.name(b)),h=d.value(b);if(f&&!RString.isEmpty(h)){var q=this.attributes;q.clear();q.unpack(h);this.modifyButton(f,q)}}}},MO.FUiCellButton_modifyButton=function(b,d){var f=!0;d.contains("visible")&&(f=RBoolean.isTrue(d.get("visible")));b.hLayout.style.display=f?"block":"none";if(f=d.get("disabled"))RBoolean.isTrue(f)?(hc.style.padding=3,hc.style.border=0):(hc.style.padding=
2,hc.style.borderLeft="1 solid #DDDDDD",hc.style.borderTop="1 solid #DDDDDD",hc.style.borderRight="1 solid #999999",hc.style.borderBottom="1 solid #999999",hc.style.backgroundColor="#FFFFFF");if(f=d.get("label"))b.icon?b.hIcon.title=f:b.hText.innerText=f;d.contains("hint")&&(hfd=this.hFloatDrop=RBuilder.append(this.hHintPanel,"DIV"),hfd.style.borderLeft="1 solid #CCCCCC",hfd.style.borderTop="1 solid #CCCCCC",hfd.style.borderRight="1 solid #666666",hfd.style.borderBottom="1 solid #666666",hfd.style.zIndex=
4E4,hfd.style.backgroundColor="#FFFFFF",hfd.style.display="none",hfd.style.position="absolute",hfd.style.padding="4 8",hfd.style.width="300px",hfd.style.pixelTop=b.offsetHeight+1,hfd.style.pixelLeft=b.hPanel.offsetWidth+20,hfd.innerHTML=d.get("hint"),this.attachEvent("onHintEnter",hfd,this.onHintEnter),this.attachEvent("onHintLeave",hfd,this.onHintLeave),b.hintBox=hfd)},MO.FUiCellButton_refreshStyle=function(){var b=this.row,d=null,d=b.isSelect?EColor.RowSelect:this.column.table.__hoverRow==b?EColor.RowHover:
EColor.Rows[b.index%EColor.Rows.length];this.hPanel.style.backgroundColor=d};
with(MO)MO.FUiCellEdit=function(b){b=RClass.inherits(this,b,FUiCellEditControl);b._styleInput=RClass.register(b,new AStyle("_styleInput"));b._hInput=null;b.onBuildEdit=FUiCellEdit_onBuildEdit;b.get=FUiCellEdit_get;b.set=FUiCellEdit_set;return b},MO.FUiCellEdit_onBuildEdit=function(b){this._hInput=RBuilder.appendEdit(this._hEditPanel,this.styleName("Input"))},MO.FUiCellEdit_get=function(){var b=o.__base.FUiCellEditControl.get.call(o,p),d=o._hInput;d&&(b=d.value);return b},MO.FUiCellEdit_set=function(b){this.__base.FUiCellEditControl.set.call(this,
b);var d=this._hInput;d&&(d.value=RString.nvl(b))},MO.FUiCellEdit_buildDrop=function(){var b=this.column;if(!RString.isEmpty(b.lovRefer)){var d=this.hDropPanel;d.align="right";d.style.paddingRight=2;d=this.hLovImage=RBuilder.appendIcon(d,"ctl.FUiCellEdit_Lov",null,16,16);d.style.borderLeft="1 solid #CCCCCC";d.style.cursor="hand";b.linkEvent(this,"onListClick",d)}},MO.FUiCellEdit_setInfo=function(b){this.base.FUiCellEditControl.setInfo.call(this,b);var d=this.column.iconMap,f=this.hIcon;d&&d.get(b.icon)?
(f.style.display="block",f.title=b.iconHint,f.src=RResource.iconPath(d.get(b.icon))):f&&(f.style.display="none")},MO.FUiCellEdit_text=function(){var b=this.column;return b.canZoom()?this.hEdit.innerText:b._absEdit?this.hEdit.value:this.hEditPanel.innerText},MO.FUiCellEdit_setText=function(b){var d=this.column;d.canZoom()?this.hEdit.innerText=b:d._absEdit?this.hEdit.value=b:this.hEditPanel.innerText=b};
with(MO)MO.FUiCellEditControl=function(b){b=RClass.inherits(this,b,FCell);b.onBuildIcon=FUiCellEditControl_onBuildIcon;b.onBuildEdit=FUiCellEditControl_onBuildEdit;b.onBuildDrop=RMethod.empty;b.onBuildForm=FUiCellEditControl_onBuildForm;b.onBuild=FUiCellEditControl_onBuild;return b},MO.FUiCellEditControl_onBuildIcon=function(b){this.hIcon=RBuilder.append(this.hIconPanel,"IMG")},MO.FUiCellEditControl_onBuildEdit=function(b){},MO.FUiCellEditControl_onBuildForm=function(b){var d=this._column;if(d._hasIconArea||
d._hasDropArea){var f=this.hForm=RBuilder.appendTable(this._hPanel);f.width="100%";f=this.hFormLine=f.insertRow();d.hasIconArea&&(this.hIconPanel=f.insertCell(),this.hIconPanel.width=18,this.onBuildIcon(b));this._hEditPanel=f.insertCell();this.onBuildEdit(b);d.hasDropArea&&(this.hDropPanel=f.insertCell(),this.hDropPanel.width=8,this.onBuildDrop(b))}else this._hEditPanel=this._hPanel,this.onBuildEdit(b)},MO.FUiCellEditControl_onBuild=function(b){this.__base.FCell.onBuild.call(this,b);this.onBuildForm(b)},
MO.FUiCellEditControl_getEditRange=function(){var b=this.hPanel,d=RHtml.offsetPosition(b);return new TRange(d.x,d.y,b.offsetWidth,b.offsetHeight)},MO.FUiCellEditControl_select=function(b){var d=this.descriptor().isEditAble(this.row);b?RClass.isClass(this,FCellCalendar)?(this.setEditStyle(EStyle.ReadonlySelect),this.column.disable()):this.setEditStyle(d?EStyle.Select:EStyle.ReadonlySelect):RClass.isClass(this,FCellCalendar)?(this.setEditStyle(EStyle.Readonly),this.column.disable()):this.setEditStyle(d?
EStyle.Normal:EStyle.Readonly)},MO.FUiCellEditControl_setVisible=function(b){this.hPanel.style.display=b?"block":"none";b&&(RClass.isClass(this,FCellCalendar)?(this.setEditStyle(EStyle.Readonly),this.column.disable()):(b=this.descriptor().isEditAble(this.row),this.setEditStyle(b?EStyle.Normal:EStyle.Readonly)))},MO.FUiCellEditControl_refreshStyle=function(){var b=this.table,d=this.column,f=this.row,h=this.hEditPanel,q=this.hEdit,w=this.hDrop,z=d.isEditAble(f),A=f.isSelect,B=z?EColor.TextEdit:EColor.TextReadonly;
q&&(q.readOnly=!z,d.zoomRefer||(q.style.color=B),w&&(q.style.cursor=z?"hand":"normal",w.style.cursor=z?"hand":"normal"));h&&(h.style.color=B);d=null;d=A?EColor.RowSelect:b.__hoverRow==f?EColor.RowHover:EColor.Rows[f.index%EColor.Rows.length];this.__focus&&(d=EColor.RowEditHover);q&&(q.style.backgroundColor=d);this.hPanel.style.backgroundColor=d};
with(MO)MO.FUiCellSelected=function(b){b=RClass.inherits(this,b,FCell);b._dataName="_select";b._styleEdit=RClass.register(b,new AStyle("_styleEdit"));b._hSelected=null;b.onBuild=FUiCellSelected_onBuild;b.onSelected=FUiCellSelected_onSelected;return b},MO.FUiCellSelected_onBuild=function(b){this.__base.FCell.onBuild.call(this,b);b=this._hPanel;b.align="center";b=this._hSelected=RBuilder.appendCheck(b,this.styleName("Edit"));b.parent=this;b.onclick=this.onSelected},MO.FUiCellSelected_onSelected=function(b){},
MO.FUiCellSelected_refreshStyle=function(){var b=this.row;b.table.dispSelected?(this.hPanel.style.display="block",b.isSelect?(this._hSelected.checked=!0,this.hPanel.style.backgroundColor="#CEE7FF"):(this._hSelected.checked=!1,this.hPanel.style.backgroundColor="#FFFFFF")):this.hPanel.style.display="none"},MO.FUiCellSelected_dispose=function(){this.base.FCellEditControl.dispose.call(this);this._hSelected=null};
with(MO)MO.FUiCellStatus=function(b){b=RClass.inherits(this,b,FCell);b._dataName="_status";b._hStatus=null;b.onBuild=FUiCellStatus_onBuild;return b},MO.FUiCellStatus_onBuild=function(b){this.__base.FCell.onBuild.call(this,b);b=this._hPanel;b.align="center";b.style.paddingTop=2;b.style.paddingBottom=2;b.style.cursor="normal";this._hStatus=RBuilder.appendIcon(b,null,"n")},MO.FUiCellStatus_onStatusEnter=function(){this.row.table.getRowBar().linkCell(this)},MO.FUiCellStatus_setIcon=function(b){this._hStatus.src=
b},MO.FUiCellStatus_refreshStyle=function(){var b=this.row,d=b.table,f=null,f=b.isDataChanged()?"Changed":(d.isFormLinked(),"Normal");this.setIcon(this.column.styleIconPath(f))},MO.FUiCellStatus_dispose=function(){this.base.FCellEditControl.dispose.call(this);this._hStatus=null};
with(MO)MO.FUiColumn=function(b){b=RClass.inherits(this,b,FControl,MDataField);b._displayList=!0;b._styleLabel=RClass.register(b,new AStyle("_styleLabel"));b._styleSearchPanel=RClass.register(b,new AStyle("_styleSearchPanel"));b._styleSearchEdit=RClass.register(b,new AStyle("_styleSearchEdit"));b._styleIconSortUp=RClass.register(b,new AStyleIcon("_styleIconSortUp"));b._styleIconSortDown=RClass.register(b,new AStyleIcon("_styleIconSortDown"));b._cellClass=FCell;b._hForm=null;b._hFormLine=null;b._hIconPanel=
null;b._hIcon=null;b._hLabel=null;b._hSortPanel=null;b._hSortUp=null;b._hSortDown=null;b._hSearchEditPanel=null;b._hSearchEdit=null;b.onBuildLabel=FUiColumn_onBuildLabel;b.onBuildSearchIcon=RMethod.empty;b.onBuildSearchEdit=FUiColumn_onBuildSearchEdit;b.onBuildSearchDrop=RMethod.empty;b.onBuildSearchForm=FUiColumn_onBuildSearchForm;b.onBuildSearch=FUiColumn_onBuildSearch;b.onBuildTotal=FUiColumn_onBuildTotal;b.onBuildPanel=FUiColumn_onBuildPanel;b.onBuild=FUiColumn_onBuild;b.onSearchEnter=RClass.register(b,
new AEventMouseEnter("onSearchEnter"));b.onSearchClick=RClass.register(b,new AEventClick("onSearchClick"));b.onSearchLeave=RClass.register(b,new AEventMouseLeave("onSearchLeave"));b.onSearchKeyDown=RClass.register(b,new AEventKeyDown("onSearchKeyDown"));b.createCell=FUiColumn_createCell;return b},MO.FUiColumn_onBuildLabel=function(b){b=this._hFormLine;if(this._icon){var d=this._hIconPanel=RBuilder.appendTableCell(b);this._hIcon=RBuilder.appendIcon(d,this.icon)}(this._hLabel=RBuilder.appendTableCell(b)).innerHTML=
RString.nvl(this.label());b=this._hSortPanel=RBuilder.appendTableCell(b);d=this._hSortUp=RBuilder.appendIcon(b,this.styleIcon("SortUp",FUiColumn));d.style.display="none";d=this._hSortDown=RBuilder.appendIcon(b,this.styleIcon("SortDown",FUiColumn));d.style.display="none"},MO.FUiColumn_onBuildSearchEdit=function(b){b=this._hSearchEditPanel=RBuilder.appendTableCell(this._hSearchFormLine,this.styleName("SearchPanel"));this._hSearchEdit=RBuilder.appendEdit(b,this.styleName("SearchEdit"))},MO.FUiColumn_onBuildSearchForm=
function(b){b=this._hSearchForm=RBuilder.appendTable(this._hSearchPanel);b.width="100%";b.style.backgroundColor="#FFFFFF";this._hSearchFormLine=b.insertRow();RClass.isClass(this,FUiColumnButton)?(this._hSearchPanel.style.backgroundColor="#EEEFF1",this._hSearchPanel.style.borderLeft="1 solid #808080",this._hSearchPanel.style.borderTop="1 solid #808080",this._hSearchPanel.style.borderBottom="1 solid #9EC4EB"):(this.onBuildSearchIcon(),this.onBuildSearchEdit(),this.onBuildSearchDrop())},MO.FUiColumn_onBuildSearch=
function(b){var d=this._hSearchPanel=RBuilder.create(b,"TD",this.styleName("SearchPanel"));d.style.backgroundColor="#FFFFFF";d.style.borderBottom="1 solid #9EC4EB";RHtml.linkSet(d,"control",this);this.attachEvent("onSearchEnter",d);this.attachEvent("onSearchLeave",d);this.onBuildSearchForm(b)},MO.FUiColumn_onBuildTotal=function(b){b=this._hTotalPanel=RBuilder.create(b,"TD");RHtml.linkSet(b,"control",this);b.align="right";b.style.color="#686860";b.style.backgroundColor="#F8F8F0";b.style.borderBottom=
"1 solid #B8B8B0";b.innerText=" "},MO.FUiColumn_onBuildPanel=function(b){this._hPanel=RBuilder.create(b,"TD",this.styleName("Label"))},MO.FUiColumn_onBuild=function(b){this._absEdit=this._editInsert||this._editUpdate||this._editDelete;this._absEdit||(RString.isEmpty(this._lovReference)?this._hasDropArea=!1:this._hasDropArea=!0);if(!RString.isEmpty(this._viewIcons)){var d=this.iconMap=new TAttributes;d.split(this._viewIcons.replace(/\n/g,";"),"=",";");this.hasIconArea=0<d.count}this.__base.FControl.onBuild.call(this,
b);d=this._hPanel;d.style.padding=4;d=this._hForm=RBuilder.appendTable(d);this._orderAble||(d.style.cursor="hand");this._hFormLine=RBuilder.appendTableRow(this._hForm);this.onBuildLabel(b);this.onBuildSearch(b);this.onBuildTotal(b);b=this._hFixPanel=RBuilder.create(b,"TD");b.height=1;b.bgColor="#FFFFFF";40>this._size.width&&(this._size.width=40);RHtml.setSize(b,this._size);this._hPanel.style.pixelWidth=this.width;this._hFixPanel.style.pixelWidth=this.width},MO.FUiColumn_createCell=function(b){b=RClass.create(this._cellClass);
var d=b._table=this._table;b._name=this._name;b._column=this;b.build(d._hPanel);b.setVisible(this._displayList);return b},MO.FUiColumn_onCellMouseEnter=function(b,d){this.table.hoverRow(b.row,!0)},MO.FUiColumn_onCellMouseLeave=function(b,d){this.table.hoverRow(b.row,!1)},MO.FUiColumn_onCellMouseDown=function(b,d){var f=b.table,h=b.row;f.__focusCell=b;f.selectRow(h,!d.ctrlKey,!0);f=RConsole.find(FFocusConsole).focusControl;RClass.isClass(f,FDropEditor)&&f.source==b||RConsole.find(FFocusConsole).focus(b)},
MO.FUiColumn_onCellClick=function(b,d){this.table.clickRow(b.row)},MO.FUiColumn_onCellDoubleClick=function(b,d){var f=b.row;this.isEditAble(f)||this.table.doubleClickRow(f)},MO.FUiColumn_onCellKeyDown=function(b,d,f){if(f)this.table.onCellKeyDown(b,d,f)},MO.FUiColumn_oeMode=function(b){if(b.isAfter()){var d=!1;this.inModeDisplay=d=EAction.Design==b.mode?this.dispDesign:this._displayList;this.setVisible(d)}return EEventStatus.Continue},MO.FUiColumn_oeRefresh=function(b){b.isBefore()&&this.setVisible(this._displayList)},
MO.FUiColumn_onDataKeyDown=function(b,d){this.__base.MEditDescriptor.onDataKeyDown.call(this,b,d)},MO.FUiColumn_onDataChanged=function(b,d){this.table.setDataStatus(b.row,EDataStatus.Update)},MO.FUiColumn_onEditBegin=function(b){var d=b.row;this.editor=b;this.table.editRow=d;this.table.editColumn=this;this.table.select(d,!0)},MO.FUiColumn_onEditEnd=function(b){b=editor.row;var d=editor.text();this.setValue(b,this.formatValue(d));this.setText(b,d);this.table.setDataStatus(b,b.isChanged()?EDataStatus.Update:
EDataStatus.Unknown);this.editor=null},MO.FUiColumn_onEditChanged=function(b){b.row.refresh()},MO.FUiColumn_onHeadMouseDown=function(b){var d=this.table,f=d.dsViewer.count,h=b.x;if(!RClass.isClass(this,FUiColumnButton)){var q=this._hPanel.offsetWidth-6;if(0<h&&h<q&&0<f&&!RClass.isClass(b.source,FUiColumnStatus)){f=d.columns;h=f.count;for(b=0;b<h;b++)q=f.value(b),q._hSortUp.style.display="none",q._hSortDown.style.display="none";d.dsOrders.clear();f=new TOrderItem;b=this.dataName;this.sortType?(f.set(b,
EOrder.Desc),this._hSortUp.style.display="none",this._hSortDown.style.display="block"):(this._hSortUp.style.display="block",this._hSortDown.style.display="none",f.set(b,EOrder.Asc));this.sortType=!this.sortType;d.dsOrders.push(f);d.dsSearch()}}},MO.FUiColumn_onRowClick=function(b,d){RConsole.find(FListenerConsole).process(FGridControl,EGridAction.RowClick,b.row,b.row)},MO.FUiColumn_createMoveable=function(b){b=this.cloneMove;b||(b=RClass.create(this.constructor),b.buildMode=EColumnMode.Drag,b.assign(this,
EAssign.Property),b.build(),this.cloneMove=b);var d=this.panel(EPanel.Move),f=b.panel(EPanel.Move);RHtml.setPixelRect(f,RHtml.rect(d));f.className=b.styleName("DesignMove");f.style.pixelLeft=d.offsetLeft;b.show();return b},MO.FUiColumn_searchValue=function(){if(this._hSearchEdit)return this._hSearchEdit.value},MO.FUiColumn_setStyleStatus=function(b,d){var f=this.cell(b);if(f)switch(f=f.style,d){case EStyle.Normal:b.isDelete()?f.backgroundColor=EColor.Delete:this.isEditAble(b)?f.backgroundColor=EColor.Edit:
f.backgroundColor=EColor.Readonly;break;case EStyle.Select:b.isDelete()?f.backgroundColor=EColor.Select:(f.textDecoration="none",this.isEditAble(b)?f.backgroundColor=EColor.RowEditSelect:f.backgroundColor=EColor.Select);break;case EStyle.Delete:f.textDecoration="line-through",f.backgroundColor=EColor.Select}},MO.FUiColumn_cell=function(b){return b.cell(this.index)},MO.FUiColumn_equalsValue=function(b,d){return RString.nvl(b).replace(/\n/g,"\\n").replace(/\r/g,"\\r")==RString.nvl(d).replace(/\n/g,
"\\n").replace(/\r/g,"\\r")},MO.FUiColumn_setWidth=function(b){this._hPanel.style.pixelWidth=b;this._hFixPanel.style.pixelWidth=b},MO.FUiColumn_setVisible=function(b){b=(this.isDisplay=b)?"block":"none";this._hPanel.style.display=b;this._hSearchPanel.style.display=b;this._hTotalPanel.style.display=b;this._hFixPanel.style.display=b},MO.FUiColumn_moveCellFocus=function(b,d){var f=this.table,h=null,q=null,w=null;if(EPosition.Top==d)h=this,(q=f.rows.get(f.rows.indexOf(b)-1))&&(w=q.cell(h.index));else if(EPosition.Bottom==
d)h=this,(q=f.rows.get(f.rows.indexOf(b)+1))&&(w=q.cell(h.index));else if(EPosition.Before==d)for(var z=this.index-1,A=f.rows.indexOf(b);0<=A;A--){for(var B=f.rows.get(A);0<=z;z--){var C=f.columns.value(z);if(RClass.isClass(C,FUiColumn)&&C._displayList){h=C;q=B;w=q.cell(h.index);break}}if(h)break;z=f.columns.count-1}else if(EPosition.After==d)for(var z=this.index+1,A=f.rows.indexOf(b),D=f.columns.count,E=f.rows.count;A<E;A++){for(B=f.rows.get(A);z<D;z++)if(C=f.columns.value(z),RClass.isClass(C,FUiColumn)&&
C._displayList){h=C;q=B;w=q.cell(h.index);break}if(h)break;z=0}h&&q&&w&&(w.focus(!0),RConsole.find(FFocusConsole).focus(w))},MO.FUiColumn_getEditRange=function(){var b=this._hSearchPanel,d=RHtml.offsetPosition(b);return new TRange(d.x,d.y,b.offsetWidth,b.offsetHeight)},MO.FUiColumn_dispose=function(){this.__base.FControl.dispose.call(this);RMemory.freeHtml(this._hSearchPanel);RMemory.freeHtml(this._hFixPanel);this._hFixPanel=this._hSearchDrop=this._hSearchDropPanel=this._hSearchEdit=this._hSearchEditPanel=
this._hSearchIcon=this._hSearchIconPanel=this._hSearchFormLine=this._hSearchForm=this._hSearchPanel=this._hSortDown=this._hSortUp=this._hSortPanel=this._hLabel=this._hHeadPanel=this._hIcon=this._hIconPanel=this._hFormLine=this._hForm=null},MO.FUiColumn_dump=function(b){b=RString.nvlStr(b);b.append(RClass.dump(this),"[");b.append("name=",this.name);b.appendIf(this.icon,",icon=",this.icon);b.appendIf(this.label,",label=",this.label);b.appendIf(this.align,",align=",this.align);b.appendIf(this.valign,
",valign=",this.valign);b.appendIf(this.dataName,",dataName=",this.dataName);b.appendIf(this.dataDefault,",dataDefault=",this.dataDefault);b.appendIf(this.index,",index=",this.index);b.append("]");b.append(" [editAccess=");b.append(this.editInsert?"I":"_");b.append(this.editUpdate?"U":"_");b.append("]");return b};with(MO)MO.FUiColumnButton=function(b){b=RClass.inherits(this,b,FColumn);b.__cellClass=FCellButton;return b};
with(MO)MO.FUiColumnEdit=function(b){b=RClass.inherits(this,b,FUiColumnEditControl,MPropertyEdit);b._cellClass=FCellEdit;return b},MO.FUiColumnEdit_onCellMouseEnter=function(b,d){},MO.FUiColumnEdit_onCellMouseLeave=function(b,d){},MO.FUiColumnEdit_onListClick=function(b,d){this.table.__focusCell=b;var f=b.row.saveRow().toAttributes();this.doListView(f)},MO.FUiColumnEdit_onZoomHover=function(b,d){b.hEdit.style.color="black"},MO.FUiColumnEdit_onZoomLeave=function(b,d){b.hEdit.style.color="blue"},MO.FUiColumnEdit_onZoomClick=
function(b,d){this.table.clickRow(b.row);var f=b.row.saveRow().get(this.zoomField);RString.isEmpty(f)||this.doZoom(f)};with(MO)MO.FUiColumnEditControl=function(b){b=RClass.inherits(this,b,FColumn);b.isEditAble=FUiColumnEditControl_isEditAble;return b},MO.FUiColumnEditControl_isEditAble=function(b){if(b)return ERowStatus.Insert==b.status?this.editInsert:this.editUpdate};with(MO)MO.FUiColumnEmpty=function(b){b=RClass.inherits(this,b,FColumn);b._dispList=!0;b.onBuildSearchForm=RMethod.empty;return b};
with(MO)MO.FUiColumnSelected=function(b){b=RClass.inherits(this,b,FColumnEditControl);b._dataName="_select";b._styleEdit=RClass.register(b,new AStyle("_styleEdit"));b._optionFixed=!0;b._cellClass=FCellSelected;b.onBuildSearchForm=FUiColumnSelected_onBuildSearchForm;b.onBuild=FUiColumnSelected_onBuild;b.createCell=FUiColumnSelected_createCell;b.dispose=FUiColumnSelected_dispose;return b},MO.FUiColumnSelected_onBuildSearchForm=function(b){b=this._hSearchForm=RBuilder.appendTable(this._hSearchPanel);
b.width="100%";b=this._hSearchFormLine=RBuilder.appendTableRow(b);b=RBuilder.appendTableCell(b);b.align="center";this._hSelected=RBuilder.appendCheck(b,this.styleName("Edit"));this._hSelected.column=this;this._hSelected.onclick=this.onSelectedClick},MO.FUiColumnSelected_onBuild=function(b){b=this.__base.FColumnEditControl.onBuild.call(this,b);var d=this._hPanel;d.align="center";d.style.width="30px";d.style.height="22px";RBuilder.appendEmpty(this._hPanel,12,12);return b},MO.FUiColumnSelected_createCell=
function(b){var d=this.__base.FColumnEditControl.createCell.call(this,b);b&&(b.cellSelect=d);return d},MO.FUiColumnSelected_dispose=function(){this._hSelect=null;this.__base.FColumnEditControl.dispose.call(this)},MO.FUiColumnSelected_setVisible=function(){var b=this._table._displayColumnSelect?"block":"none";this._hPanel.style.display=b;this._hSelected.style.display=b;this._hSearchPanel.style.display=b;this._hTotalPanel.style.display=b;this._hFixPanel.style.display=b},MO.FUiColumnSelected_onCellClick=
function(b,d){},MO.FUiColumnSelected_onSelectedClick=function(b,d){for(var f=this.column,h=f.table.rows,q=h.count,w=0;w<q;w++){var z=h.get(w);z.selectAble&&(this.checked?f.table.selectRow(z,!1,!0):f.table.clearSelectRow(z))}};
with(MO)MO.FUiColumnStatus=function(b){b=RClass.inherits(this,b,FColumnEditControl);b._dataName="_status";b._optionFixed=!0;b._cellClass=FCellStatus;b.onBuildSearchForm=FUiColumnStatus_onBuildSearchForm;b.onBuild=FUiColumnStatus_onBuild;b.createCell=FUiColumnStatus_createCell;return b},MO.FUiColumnStatus_onBuildSearchForm=function(b){b=this._hSearchForm=RBuilder.appendTable(this._hSearchPanel);b.height=18;b.width="100%";b=this._hSearchFormLine=RBuilder.appendTableRow(b);RBuilder.appendTableCell(b).align=
"center"},MO.FUiColumnStatus_onBuild=function(b){this.__base.FColumnEditControl.onBuild.call(this,b);b=this._hPanel;b.align="center";b.style.width="30px";b.style.height="22px";RBuilder.appendEmpty(b,12,12)},MO.FUiColumnStatus_createCell=function(b){var d=this.__base.FColumnEditControl.createCell.call(this,b);b&&(b._statusCell=d);return d},MO.FUiColumnStatus_onCellClick=function(b,d){this.table.callEvent("onTableRowDoubleClick",b.row)||RConsole.find(FListenerConsole).process(FGridControl,EGridAction.RowClick,
b.row,b.row)},MO.FUiColumnStatus_setDataStatus=function(b,d){var f=this.table,h=b.getStatus(),q=null;switch(d){case EDataStatus.Insert:q="Insert";break;case EDataStatus.Delete:q="Delete";break;default:q=b.isDataChanged()?"Changed":f.isFormLinked()?"NormalEnter":"Normal"}h.setIcon(this.styleIconPath(q))},MO.FUiColumnStatus_ohCellMdclk=function(){this.lnkCol.table.insertRow(this.lnkRow.rowIndex())},MO.FUiColumnStatus_dispose=function(){this.__base.FColumnEditControl.dispose.call(this);this._hSelect=
null};
with(MO)MO.FUiGrid=function(b){b=RClass.inherits(this,b,FUiGridControl);b.onResizeAfter=FUiGrid_onResizeAfter;b.onBuildData=FUiGrid_onBuildData;b.oeResize=FUiGrid_oeResize;b.oeRefresh=FUiGrid_oeRefresh;b.pushColumn=FUiGrid_pushColumn;return b},MO.FUiGrid_onResizeAfter=function(){var b=this.hDataPanel,d=this.hFixPanel,f=RHtml.scrollWidth(b),h=RHtml.scrollHeight(b);this.hHeadPanel.style.pixelWidth=b.offsetWidth-d.offsetWidth-f;this.hColumnPanel.style.pixelHeight=b.offsetHeight-d.offsetHeight-h+1},MO.FUiGrid_onBuildData=
function(){var b=o.hFixPanel=RBuilder.appendDiv(hbp);b.style.zIndex=2;b.style.position="absolute";var b=o.hFixForm=RBuilder.appendTable(b,null,1),d=RBuilder.append(b,"TBODY");b.style.tableLayout="fixed";b.frame="rhs";b.borderColorLight="#29BAD5";b.borderColorDark="#EEEEEE";o.hFixHead=RBuilder.append(d,"TR");o.hFixSearch=RBuilder.append(d,"TR");b=o.hHeadPanel=RBuilder.appendDiv(hbp);b.style.zIndex=1;b.style.position="absolute";b.style.overflowX="hidden";b.style.width=1;b=o.hHeadForm=RBuilder.appendTable(b,
null,1);b.frame="rhs";b.style.tableLayout="fixed";b.borderColorLight="#29BAD5";b.borderColorDark="#EEEEEE";o.hHead=b.insertRow();o.hSearch=b.insertRow();b=o.hColumnPanel=RBuilder.appendDiv(hbp,o.style("DataPanel"));b.style.zIndex=1;b.style.position="absolute";b.style.overflowY="hidden";b=o.hColumnForm=RBuilder.appendTable(b,o.style("DataForm"),0,0,1);o.hFixRows=RBuilder.append(b,"TBODY");o.hFixRowLine=RBuilder.append(o.hFixRows,"TR");b=o.hDataPanel=RBuilder.appendDiv(hbp,o.style("DataPanel"));b=o.hDataForm=
RBuilder.appendTable(b,o.style("DataForm"),0,0,1);o.hRows=RBuilder.append(b,"TBODY");o.hRowLine=RBuilder.append(o.hRows,"TR");o.attachEvent("onHeadMouseDown",o.hHeadForm,o.onHeadMouseDown);o.attachEvent("onHeadMouseMove",o.hHeadForm,o.onHeadMouseMove);o.attachEvent("onHeadMouseUp",o.hHeadForm,o.onHeadMouseUp);o.attachEvent("onDataScroll",o.hDataPanel,o.onDataScroll)},MO.FUiGrid_oeResize=function(b){b=this.hPanel;if(b.offsetWidth&&b.offsetHeight){b=this.hTitleForm;var d=this.hFixPanel,f=this.hHeadPanel,
h=this.hColumnPanel,q=this.hDataPanel;f.style.display=h.style.display=q.style.display="none";var w=this.hBorderPanel.offsetWidth,z=this.hBorderPanel.offsetHeight;f.style.display=h.style.display=q.style.display="block";f.style.pixelWidth=w-d.offsetWidth;h.style.pixelHeight=z-d.offsetHeight-1-b.offsetHeight;q.style.pixelWidth=w;q.style.pixelHeight=z-b.offsetHeight;this.dpScrollLeft&&(q.scrollLeft=this.dpScrollLeft,this.dpScrollLeft=null);RConsole.find(FEventConsole).push(this.eventResizeAfter);return EEventStatus.Stop}},
MO.FUiGrid_oeRefresh=function(b){this.base.FUiGridControl.oeRefresh.call(this,b);if(b.isAfter()){var d=this.hFixPanel,f=this.hHeadPanel,h=this.hColumnPanel,q=this.hDataPanel,w=this.hTitleForm.offsetHeight,z=d.offsetWidth,A=d.offsetHeight;h.style.display=q.style.display="none";b=this.hBorderPanel.offsetWidth;var B=this.hBorderPanel.offsetHeight;h.style.display=q.style.display="block";d.style.pixelTop=w;f.style.pixelTop=w;f.style.pixelLeft=z;f.style.pixelWidth=b-z;f.style.pixelHeight=A;this.hHead.style.pixelHeight=
this.hFixHead.offsetHeight;this.hSearch.style.pixelHeight=this.hFixSearch.offsetHeight;h.style.pixelTop=w+A;h.style.pixelHeight=B-w-A;q.style.paddingLeft=z;q.style.paddingTop=A;q.style.pixelWidth=b;q.style.pixelHeight=B-w;d=null;f=this.columns;for(h=0;h<f.count;h++)if(q=f.value(h),q.isDisplay)if(q.dispAuto){if(d)return RMessage.fatal(this,null,"Too many auto column! (name1={0},name2={1})",d.name,q.name);d=q}else b-=q.hPanel.offsetWidth;d&&d.setWidth(Math.max(b-2,d.width?d.width:120))}},MO.FUiGrid_pushColumn=
function(b){b.dispFixed?(this.hFixHead.appendChild(b.hPanel),this.hFixSearch.appendChild(b.hSearchPanel),this.hFixRowLine.appendChild(b.hFixPanel)):(this.hHead.appendChild(b.hPanel),this.hSearch.appendChild(b.hSearchPanel),this.hRowLine.appendChild(b.hFixPanel));this.push(b)};
with(MO)MO.FUiGridControl=function(b){b=RClass.inherits(this,b,FDuiContainer);b._displayCount=RClass.register(b,new APtyInteger("_displayCount"),20);b._displayTitle=RClass.register(b,new APtySet("_displayTitle","display_title",EGridDisplay.Title),!0);b._displayColumnStatus=!0;b._displayColumnSelect=!0;b._rowHeight=RClass.register(b,new APtyInteger("rowHeight"),0);b._stylePanel=RClass.register(b,new AStyle("_stylePanel"));b._styleTitlePanel=RClass.register(b,new AStyle("_styleTitlePanel"));b._styleTitleForm=
RClass.register(b,new AStyle("_styleTitleForm"));b._styleCaption=RClass.register(b,new AStyle("_styleCaption"));b._styleContentPanel=RClass.register(b,new AStyle("_styleContentPanel"));b._styleContentForm=RClass.register(b,new AStyle("_styleContentForm"));b._styleHintPanel=RClass.register(b,new AStyle("_styleHintPanel"));b._styleHintForm=RClass.register(b,new AStyle("_styleHintForm"));b._styleHint=RClass.register(b,new AStyle("_styleHint"));b._styleButton=RClass.register(b,new AStyle("_styleButton"));
b._minHeight=80;b._buttons=null;b._columns=null;b._rowClass=FGridRow;b._rows=null;b._focusCell=null;b._focusRow=null;b._loadEvent=null;b._hTitlePanel=null;b._hTitleForm=null;b._hTitleLine=null;b._hCaption=null;b._hContentPanel=null;b._hHintPanel=null;b._hHintForm=null;b.lsnsRowClick=null;b.lsnsRowDblClick=null;b.onBuildTitle=FUiGridControl_onBuildTitle;b.onBuildContent=RMethod.virtual(b,"onBuildContent");b.onBuildHint=FUiGridControl_onBuildHint;b.onBuildPanel=FUiGridControl_onBuildPanel;b.onBuild=
FUiGridControl_onBuild;b.onDatasetLoadDelay=FUiGridControl_onDatasetLoadDelay;b.onDatasetLoad=FUiGridControl_onDatasetLoad;b.construct=FUiGridControl_construct;b.buildNavigatorButton=FUiGridControl_buildNavigatorButton;b.appendColumn=RMethod.virtual(b,"appendColumn");b.appendChild=FUiGridControl_appendChild;b.push=FUiGridControl_push;b.createRow=FUiGridControl_createRow;b.insertRow=FUiGridControl_insertRow;b.syncRow=FUiGridControl_syncRow;b.hideRows=FUiGridControl_hideRows;b.clickCell=FUiGridControl_clickCell;
b.clickRow=FUiGridControl_clickRow;b.doubleClickRow=FUiGridControl_doubleClickRow;return b},MO.FUiGridControl_onBuildPanel=function(b){this._hPanel=RBuilder.createTable(b,this.styleName("Panel"))},MO.FUiGridControl_onBuildTitle=function(b){b=this._hTitleForm=RBuilder.appendTable(this._hTitlePanel,this.styleName("TitleForm"));var d=this._hTitleLine=RBuilder.appendTableRow(b);(this._hCaption=RBuilder.appendTableCell(d,this.styleName("Caption"))).innerText=this.label();RHtml.displaySet(b,this._displayTitle)},
MO.FUiGridControl_onBuildHint=function(b){b=RBuilder.appendTableRow(this._hHintForm);var d=RBuilder.appendTableCell(b);d.width=60;this.hExtendButton=this.buildNavigatorButton(d,"control.grid.extend","&nbsp;\u5c55\u5f00",null,"hExtend");d=RBuilder.appendTableCell(b);d.width=60;this.hInsertButton=this.buildNavigatorButton(d,"control.grid.insert","&nbsp;\u65b0\u5efa",null,"hInsert");d=RBuilder.appendTableCell(b);d.width=10;d=RBuilder.appendTableCell(b);d.noWrap=!0;this._hHint=RBuilder.appendText(d,this.styleName("Hint"));
d=RBuilder.appendTableCell(b);d.noWrap=!0;d.align="right";this.hNavFirst=this.buildNavigatorButton(d,"control.grid.first","&nbsp;"+RContext.get("FUiGridControl:First"));this.hNavPrior=this.buildNavigatorButton(d,"control.grid.prior","&nbsp;"+RContext.get("FUiGridControl:Prior"));this.hNavPrior.style.paddingRight="20";this.hPage=RBuilder.appendEdit(d);this.hPage.style.width=40;this.hNavNext=this.buildNavigatorButton(d,null,RContext.get("FUiGridControl:Next")+"&nbsp;","control.grid.next");this.hNavLast=
this.buildNavigatorButton(d,null,RContext.get("FUiGridControl:Last")+"&nbsp;","control.grid.last")},MO.FUiGridControl_onBuild=function(b){if(!this._size.height||160>this._size.height)this.height="100%";this.__base.FDuiContainer.onBuild.call(this,b);this._hTitlePanel=RBuilder.appendTableRowCell(this._hPanel,this.styleName("TitlePanel"));this.onBuildTitle(b);this._hContentPanel=RBuilder.appendTableRowCell(this._hPanel,this.styleName("ContentPanel"));this.onBuildContent(b);this._hHintPanel=RBuilder.appendTableRowCell(this._hPanel,
this.styleName("HintPanel"));this._hHintForm=RBuilder.appendTable(this._hHintPanel,this.styleName("HintForm"));this.onBuildHint(b);var d=this._statusColumn=RClass.create(FColumnStatus);d._table=this;d._name="_s";d.build(b);this.push(d);d=this._selectColumn=RClass.create(FColumnSelected);d._table=this;d._name="_select";d.build(b);this.push(d)},MO.FUiGridControl_onDatasetLoadDelay=function(b){var d=this._rowHeight,f=b.dataset,h=f.count(),q=b.index,w=q+b.acceleration;w>h-1&&(w=h-1);this._hHeadPanel&&
(this._hHeadPanel.scrollLeft=0);this._hColumnPanel&&(this._hColumnPanel.scrollTop=0);for(;q<=w;q++){var z=this.syncRow(q);0<d&&(z._hFixPanel.height=d+"px");var A=f.row(q);z.loadRow(A);z.setVisible(!0)}w==h-1?(b.setValid(!1),this.psRefresh()):b.index+=a.acceleration},MO.FUiGridControl_onDatasetLoad=function(b){this._hColumnPanel&&(this._hColumnPanel.scrollTop=0,this._hColumnPanel.scrollLeft=0);this._hDataPanel&&(this._hDataPanel.scrollTop=0,this._hDataPanel.scrollLeft=0);b.isEmpty()||(b=this._loadEvent,
b.index=0,b.acceleration=5,b.dataset=this._dataset,b.setValid(!0),RConsole.find(FEventConsole).push(this._loadEvent))},MO.FUiGridControl_construct=function(){this.__base.FDuiContainer.construct.call(this);this._buttons=new TDictionary;this._columns=new TDictionary;this._rows=new TObjects;this.lsnsRowClick=new TListeners;this.lsnsRowDblClick=new TListeners;var b=this._loadEvent=RClass.create(FEvent);b.setOwner(this);b.setCallback(this.onDatasetLoadDelay);b.setValid(!1)},MO.FUiGridControl_buildNavigatorButton=
function(b,d,f,h,q){b=RBuilder.append(b,"SPAN",this.styleName("Button"));b.style.cursor="hand";b.style.paddingLeft="10";d&&RBuilder.appendIcon(b,null,d);f&&(q?this[q+"Text"]=RBuilder.appendText(b,null,f):RBuilder.appendText(b,null,f));h&&RBuilder.appendIcon(b,null,h);return b},MO.FUiGridControl_appendChild=function(b){this.__base.FDuiContainer.appendChild.call(this,b);RClass.isClass(b,FColumn)&&this.appendColumn(b)},MO.FUiGridControl_push=function(b){RClass.isClass(b,FColumn)?(b._table=this,this._columns.set(b.name(),
b)):RClass.isClass(b,FTableButton)&&(b._table=this,this._buttons.set(b.name(),b));this.__base.FDuiContainer.push.call(this,b)},MO.FUiGridControl_createRow=function(){var b=RClass.create(this._rowClass);b._table=b._parent=this;return b},MO.FUiGridControl_insertRow=function(b,d){d.index=b;d.build();d._hFixPanel&&(this._hFixRows.appendChild(d._hFixPanel),RHtml.tableMoveRow(this._hColumnForm,d._hFixPanel.rowIndex,b+2));this._hRows.appendChild(d._hPanel);RHtml.tableMoveRow(this._hContentForm,d._hPanel.rowIndex,
b+2);d.refreshStyle();this._rows.insert(b,d)},MO.FUiGridControl_syncRow=function(b){var d=this._rows,f=d.get(b);if(!f)for(var h=d.count();h<=b;h++)f=this.createRow(),f._index=h,f.build(this._hPanel),f._hFixPanel&&this._hFixRows.appendChild(f._hFixPanel),this._hRows.appendChild(f._hPanel),f._hPanel.style.height=f._hFixPanel.offsetHeight+"px",d.push(f);f._extended=!1;f._childRows&&(f.hideChild(),f._childRows.clear());return f},MO.FUiGridControl_hideRows=function(){for(var b=this._rows,d=b.count()-1;0<=
d;d--)b.get(d).setVisible(!1)},MO.FUiGridControl_clickCell=function(b){this._focusCell=b},MO.FUiGridControl_clickRow=function(b){this.lsnsRowClick.process(b);this._focusRow=b},MO.FUiGridControl_doubleClickRow=function(b){this.lsnsRowDblClick.process(b);this._focusRow=b},MO.FUiGridControl_pushButton=function(b){var d=this._hButtons.insertCell();d.style.border="0 solid #C6D7FF";d.appendChild(b._hPanel);this.push(b)},MO.FUiGridControl_onMouseDown=function(b,d){},MO.FUiGridControl_onHeadMouseDown=function(b){var d=
this.getHeadMode(b);EGridColumn.Size==d&&(this.hoverMode=EGridColumn.Size,b.srcElement.status=EGridColumn.Size,this.hoverX=b.srcElement.offsetLeft+b.x,this.hoverDataCell=null,this._hContentForm._rows.length&&(this.hoverDataCell=this._hContentForm._rows[0].cells[this.hoverHead.index]),this._hHeadForm.setCapture())},MO.FUiGridControl_onHeadMouseMove=function(b){if(EGridColumn.Size==this.hoverMode)b=b.srcElement.offsetLeft+b.x-this.hoverX+this.hoverCellLength,0<b&&(this.hoverHead._hPanel.style.pixelWidth=
b,this.hoverHead._hFixPanel.style.pixelWidth=b);else if(EGridColumn.None==this.hoverMode){b=this.getHeadMode(b);var d="default";EGridColumn.Size==b?d="e-resize":EGridColumn.Drag==b&&(d="hand");this._hHeadForm.style.cursor=d}},MO.FUiGridControl_onHeadMouseUp=function(b){EGridColumn.Size==this.hoverMode&&this._hHeadForm.releaseCapture();this.hoverMode=EGridColumn.None},MO.FUiGridControl_onDataScroll=function(){this._hHeadPanel.scrollLeft=this._hContentPanel.scrollLeft;this._hColumnPanel.scrollTop=this._hContentPanel.scrollTop},
MO.FUiGridControl_onCellKeyDown=function(b,d,f){var h=d.keyCode,q=b.column;b=b.row;EKey.Up==h?(q.moveCellFocus(b,EPosition.Top),RKey.eventClear(f)):EKey.Down==h?(q.moveCellFocus(b,EPosition.Bottom),RKey.eventClear(f)):EKey.Tab==h&&d.shiftKey?(q.moveCellFocus(b,EPosition.Before),RKey.eventClear(f)):EKey.Tab==h&&(q.moveCellFocus(b,EPosition.After),RKey.eventClear(f))},MO.FUiGridControl_onRowMouseEnter=function(b,d){this.hoverRow(b,!0)},MO.FUiGridControl_onRowMouseLeave=function(b,d){this.hoverRow(b,
!1)},MO.FUiGridControl_onRowClick=function(b,d){this.selectRow(b,!d.ctrlKey,!0);this.lsnsRowClick.process(b);d=this._eventRowClick;d||(d=this._eventRowClick=new TEvent,d.source=this);d.caller=b;d.handle="onTableRowClick";RConsole.find(FFormConsole).processEvent(d)},MO.FUiGridControl_onColumnSearchKeyDown=function(b,d){EKey.Enter!=d.keyCode||this._isSearching&&this.table._isSearching||(this._isSearching=!0,this.table?(this.table.doSearch(),this.table.dpScrollLeft=this.table._hContentPanel.scrollLeft,
this.table.callEvent("onSearchKeyDown",this,this._searchKeyDownEvent)):(this.doSearch(),this.dpScrollLeft=this._hContentPanel.scrollLeft,this.callEvent("onSearchKeyDown",this,this._searchKeyDownEvent)))},MO.FUiGridControl_onButtonMouseDown=function(b){var d=this.dsViewer;if(d&&0!=d.dataset.pageCount)if(b=b.hSource,this.hInsertButton==b)this.onInsertButtonClick();else if(this.hExtendButton==b)this.onExtendButtonClick();else this.hNavFirst==b&&0!=d.pageIndex?this.dsMovePage(EDataAction.First):this.hNavPrior==
b&&0!=d.pageIndex?this.dsMovePage(EDataAction.Prior):this.hNavNext==b&&d.pageIndex!=d.pageCount-1?this.dsMovePage(EDataAction.Next):this.hNavLast==b&&d.pageIndex!=d.pageCount-1&&this.dsMovePage(EDataAction.Last)},MO.FUiGridControl_onPageCountDown=function(b){var d=this.dsViewer;if(!RString.isEmpty(this.hPage.value)&&d&&0!=d.dataset.pageCount){var f=RInt.parse(this.hPage.value);EKey.Enter==b.keyCode&&f!=d.pageIndex+1&&(1>f&&(f=1),f>d.pageCount&&(f=d.pageCount),this.dsMovePage(f-1))}},MO.FUiGridControl_onInsertButtonClick=
function(){RFormSpace.doPrepare(this)},MO.FUiGridControl_onExtendButtonClick=function(){400==this.dsPageSize?(this.dsPageSize=this.dsPageSizeStore,this.hExtendText.innerText=" \u5c55\u5f00"):(this.dsPageSizeStore=this.dsPageSize,this.dsPageSize=400,this.hExtendText.innerText=" \u6536\u7f29");this.dsSearch()},MO.FUiGridControl_oeMode=function(b){this.dispDelete=this.dispUpdate=!0;this.__base.FDuiContainer.oeMode.call(this,b);this.__base.MDisplay.oeMode.call(this,b);this._editable=this.canEdit(b.mode);
return EEventStatus.Stop},MO.FUiGridControl_oeProgress=function(b){if("none"!=this._hPanel.currentStyle.display){var d=this._hDelayPanel;if(!d){var d=this._hDelayPanel=RBuilder.appendDiv(this.hBorderPanel),f=d.style;f.position="absolute";f.zIndex=RLayer.next();f.filter="progid:DXImageTransform.Microsoft.Alpha(opacity=100)";f.backgroundColor="#FFFFFF";f.top=0;f.width="100%";f.height="100%";f.display="none";f=this._hDelayForm=RBuilder.appendTable(d);f.style.width="100%";f.style.height="100%";f=f.insertRow().insertCell();
f.align="center";f.vAlign="middle";RBuilder.appendIcon(f,"ctl.FUiGridControl_Loading");(this._hDelayText=RBuilder.append(f,"SPAN")).innerHTML="<BR><BR><FONT color='red'><B>"+RContext.get("FUiGridControl:Loading")+"</B></FONT>"}b.enable?(RHtml.setRect(d,this.calculateDataSize()),d.filters[0].opacity=100,d.style.display="block"):this._loadFinish&&(d.style.display="none");this.refreshHint();return EEventStatus.Stop}},MO.FUiGridControl_isFormLinked=function(){return this._formLinked||this._formName},
MO.FUiGridControl_isDataSelected=function(){for(var b=this._rows,d=b.count-1;0<=d;d--)if(b.get(d).isSelect)return!0},MO.FUiGridControl_isDataChanged=function(){for(var b=this._rows,d=b.count-1;0<=d;d--)if(b.get(d).isDataChanged())return!0},MO.FUiGridControl_hasAction=function(){for(var b=this.components,d=b.count,f=0;f<d;f++){var h=b.value(f);if(RClass.isClass(h,FDataAction))return this.isDataSelected()}},MO.FUiGridControl_getFormLink=function(b){if(EFormLink.Form==b)return this._formName;if(EFormLink.Table==
b)return this.name;RMessage.fatal(this,null,"Form link is invalid. (type={0})",b)},MO.FUiGridControl_getHeadMode=function(b){var d=RHtml.point(this._hHeadForm);b=b.srcElement.offsetLeft+b.x-d.x;for(var f=this._columns,h=0;h<f.count;h++){var q=f.value(h);if(q.dispSize){var w=q._hPanel.offsetLeft+q._hPanel.offsetWidth-d.x;this.hoverCellLength=q._hPanel.offsetWidth;if(w-6<=b&&b<=w)return this.hoverHead=q,EGridColumn.Size}}return EGridColumn.None},MO.FUiGridControl_getRowBar=function(){var b=this._rowBar;
b||(b=this._rowBar=RClass.create(FGridRowBar),b.table=this,b.psBuild(this.hBorderPanel));return b},MO.FUiGridControl_calculateDataSize=function(){var b=this._dataRect;b||(b=this._dataRect=new TRect);var d=this.hTitleForm?this.hTitleForm.offsetHeight:0,f=this._hFixPanel?this._hFixPanel.offsetHeight:0;b.left=0;b.top=f+d;b.setWidth(this.hBorderPanel.offsetWidth);b.setHeight(this.hBorderPanel.offsetHeight-d-f);return b},MO.FUiGridControl_hasVisibleRow=function(){for(var b=this._rows,d=0;d<b.count;d++)if(b.get(d)._visible)return!0;
return!1},MO.FUiGridControl_getCurrentRow=function(){var b=this._focusCell;if(b)return b.row.saveRow()},MO.FUiGridControl_getSelectedRow=function(){for(var b=this._rows,d=b.count,f=0;f<d;f++){var h=b.get(f);if(h.isSelect)return h}},MO.FUiGridControl_getSelectedRows=function(){for(var b=new TList,d=this._rows,f=d.count,h=0;h<f;h++){var q=d.get(h);q.isSelect&&q.isVisible()&&b.push(q.saveRow())}return b},MO.FUiGridControl_getChangedRows=function(){for(var b=new TList,d=this._rows,f=d.count,h=0;h<f;h++){var q=
d.get(h);q.isVisible()&&q.isDataChanged()&&b.push(q.saveRow())}return b},MO.FUiGridControl_getRows=function(){for(var b=new TList,d=this._rows,f=d.count,h=0;h<f;h++){var q=d.get(h);q.isVisible()&&b.push(q.saveRow())}return b},MO.FUiGridControl_refreshHint=function(){var b=this._hHint,d=this._dataset;if(d&&b){var f=0,h=this.getSelectedRow();h&&(f=this._rows.indexOf(h)+1);b.innerHTML="\u5171<FONT color='red' style='font-weight:BOLD '>"+d.pageCount+"</FONT>\u9875<FONT color='red' style='font-weight:BOLD '>"+
d.total+"</FONT>\u6761\u8bb0\u5f55\uff0c\u5f53\u524d\u9009\u4e2d\u7b2c<FONT color='red' style='font-weight:BOLD '>"+(d.pageIndex+1)+"</FONT>\u9875\u7b2c<FONT color='red' style='font-weight:BOLD '>"+f+"</FONT>\u6761\u8bb0\u5f55";this.hPage.value=d.pageIndex+1}},MO.FUiGridControl_refreshSelected=function(){this._columns.get("_select").hSelected.checked=!1;for(var b=this._rows,d=b.count,f=0;f<d;f++)b.get(f).isSelect=!1},MO.FUiGridControl_hoverRow=function(b,d){d?this._hoverRow=b:this._hoverRow==b&&(this._hoverRow=
null);b.refreshStyle()},MO.FUiGridControl_selectRow=function(b,d,f){var h=!1;if(d){d=this._rows;for(var q=d.count,w=0;w<q;w++){var z=d.get(w);z!=b&&z.isSelect&&(z.select(!1),h=!0)}}b.select(h||!b.isSelect||f);this.refreshHint()},MO.FUiGridControl_clearSelectRow=function(b){b.select(!1);this.refreshHint()},MO.FUiGridControl_clearSelectRows=function(){for(var b=this._rows,d=0;d<b.count;d++)b.get(d).isSelect=!1;this.refreshHint()},MO.FUiGridControl_setDataStatus=function(b,d){b.dataStatus=d;this._statusColumn.setDataStatus(b,
d)},MO.FUiGridControl_dsInsert=function(){},MO.FUiGridControl_dsUpdate=function(b){this.psMode(EMode.Update);this.dsFetch(!0)},MO.FUiGridControl_dsDelete=function(){},MO.FUiGridControl_doSearch=function(){this.dsSearchs.clear();for(var b=this._columns,d=0;d<b.count;d++){var f=b.value(d),h=f.searchValue();if(RClass.isClass(f,FColumnCalendar)){if(h){var q=new TSearchItem;q.set(f.dataName,h.value,ESearch.Date,h.format);this.dsSearchs.push(q)}}else RString.isEmpty(h)||(q=new TSearchItem,q.set(f.dataName,
h,ESearch.Like),this.dsSearchs.push(q))}this.dsValues=this.toDeepAttributes();this.dsSearch()},MO.FUiGridControl_focus=function(){RConsole.find(FFocusConsole).focusClass(MDataset,this)},MO.FUiGridControl_pack=function(){for(var b=this._rows,d=b.count,f=new TNode("Dataset"),h=0;h<d;h++){var q=b.get(h);q.isDataChanged()&&(q=q.toAttrs(),q=new TNode("Row",q),f.push(q))}return f},MO.FUiGridControl_setVisible=function(b){this.__base.FDuiContainer.setVisible.call(this,b);this.__base.MUiHorizontal.setVisible.call(this,
b)},MO.FUiGridControl_setButtonVisible=function(b,d){var f=this._buttons.get(b);f&&f.setVisible(d)},MO.FUiGridControl_refreshStyle=function(){for(var b=this._rows,d=b.count,f=0;f<d;f++)b.get(f).refreshStyle()},MO.FUiGridControl_dispose=function(){this.__base.FDuiContainer.dispose.call(this);this._hExtendText=this._hExtendButton=this._hInsertButton=this._hHintForm=this._hRowLine=this._hRows=this._hContentForm=this._hContentPanel=this._hFixRowLine=this._hFixRows=this._hColumnForm=this._hColumnPanel=
this._hSearch=this._hHead=this._hHeadForm=this._hHeadPanel=this._hFixSearch=this._hFixHead=this._hFixForm=this._hFixPanel=this._hDelayForm=this._hDelayPanel=this.hBorderPanel=null},MO.FUiGridControl_dump=function(b){b=RString.nvlStr(b);b.appendLine(RClass.name(this));for(var d=this._rows,f=0;f<d.count;f++)b.appendLine(d.get(f).dump());return b},MO.FUiGridControl_storeValues=function(b){b||(b=new TAttributes);var d=this.getSelectRows();d.count&&(1!=d.count&&RMessage.fatal(this,"Invalid selected rows. (count={0})",
d.count),d.get(0).toAttributes(b));return b},MO.FUiGridControl_buildRows=function(){var b=this._rows;if(!b.count)for(var d=this._displayCount,f=0;f<d;f++){var h=RClass.create(FGridRow);h.table=this;h.build();this._hRows.appendChild(h._hPanel);b.push(h)}},MO.FUiGridControl_createChild=function(b){var d=this.__base.FDuiContainer.createChild.call(this,b);if(RClass.isClass(d,FGridRow))return d.table=this,d.row=this.dsLoadRowNode(b),this._rows.push(d),null;RClass.isClass(d,FColumnEditControl)&&(d.table=
this);return d},MO.FUiGridControl_setStyleStatus=function(b,d){if(b._hPanel)switch(d){case EStyle.Normal:b.select(!1);break;case EStyle.Select:b.select(!0)}},MO.FUiGridControl_buildRow=function(b){for(var d=this._columns,f=0;f<d.count;f++){var h=d.value(f),q=h.createCell(b);h.dataName&&q.set(RString.nvl(b.get(h.dataName),h.dataDefault));b.push(q)}return b},MO.FUiGridControl_clearSelectAll=function(){this._columns.get("_select").hSelected.checked=!1},MO.FUiGridControl_appendRow=function(b){this._hRows.appendChild(b._hRow);
this._rows.push(b)},MO.FUiGridControl_deleteRow=function(b){b=RObject.nvl(b,this.selectedRow);if(!b)return alert("Please select row.");b.isExist()?b.isDelete()?(b.doNormal(),this.setDataStatus(b,EDataStatus.Unknown),this.setStyleStatus(b,EStyle.Select)):(b.doDelete(),this.setDataStatus(b,EDataStatus.Delete),this.setStyleStatus(b,EStyle.Delete)):b.release()},MO.FUiGridControl_clearRows=function(){for(var b=this._rows.count,d=0;d<b;d++){var f=this._rows.get(d);f&&f.dispose()}this._rows.clear();RHtml.clear(this._hRows)},
MO.FUiGridControl_onColumnTreeService=function(b){if((b=b.resultDatasets.get(b.path)._rows)&&0<b.count){var d=this.focusRow;d.extdStatus=!0;d.psResize();for(var f=d._hPanel.rowIndex+1,h=0;h<b.count;h++){var q=RClass.create(FGridRow);q.table=this;d.childRows.push(q);q.parentRow=d;q.buildChild(this._hFixRows,this._hRows,f+h);q.loadRow(b.get(h))}}},MO.FUiGridControl_getRowType=function(){for(var b=this.components,d=b.count,f=0;f<d;f++){var h=b.value(f);if(RClass.isClass(h,FGridRowType))return h}},MO.FUiGridControl_onColumnTreeClick=
function(b,d){if(this.getRowType()){var f=b.row;if(f.childRows&&0<f.childRows.count)f.extended?f.hideChild():f.showChild(),f.extended=!f.extended,b.hImg.src=f.extended?b.styleIconPath("Fold",FColumnTree):b.styleIconPath("Expend",FColumnTree);else if(this.focusRow=b.row,"Y"==this.focusRow.row.get("ochd")){b.row.extended=!0;b.hImg.src=b.styleIconPath("Fold",FColumnTree);var f=b.row.get("otyp"),h=b.row.table.component(f),q=this.topControl(MDataset),f=new TDatasetFetchArg(q.name,q.formId,q.dsPageSize,
q.dsPageIndex,null,null,this.fullPath(),h.formResearch);q.dsSearchs.clear();if(h&&h.formWhere){var w=new TSearchItem;w.set(h.dataName,h.formWhere,ESearch.Source);q.dsSearchs.push(w)}f.force=!0;f.reset=!0;f.searchs=q.dsSearchs;h=new TAttributes;b.row.toDeepAttributes(h);f.values=h;f.callback=new TInvoke(this,this.onColumnTreeService);RConsole.find(FDatasetConsole).fetch(f)}}};
with(MO)MO.FUiGridRow=function(b){b=RClass.inherits(this,b,FUiGridRowControl);b._hFixPanel=null;b.onBuildPanel=FUiGridRow_onBuildPanel;b.setVisible=FUiGridRow_setVisible;b.appendChild=FUiGridRow_appendChild;b.dispose=FUiGridRow_dispose;return b},MO.FUiGridRow_onBuildPanel=function(b){this.__base.FUiGridRowControl.onBuildPanel.call(this,b);this._hFixPanel=RBuilder.createTableRow(b,this.styleName("Panel"))},MO.FUiGridRow_setVisible=function(b){this._visible=b;var d=this._hFixPanel;d&&RHtml.displaySet(d,
b);(d=this._hPanel)&&RHtml.displaySet(d,b)},MO.FUiGridRow_appendChild=function(b){this.__base.FUiGridRowControl.appendChild.call(this,b);b._column._optionFixed&&this._hFixPanel.appendChild(b._hPanel)},MO.FUiGridRow_dispose=function(){var b=this._hFixPanel;b&&(RMemory.free(b),this._hFixPanel=null);this.__base.FUiGridRowControl.dispose.call(this)},MO.FUiGridRow_select=function(b){b=(this.isSelect=b)?EColor.RowSelect:EColor.Row;this._hFixPanel.style.backgroundColor=b;this.hPanel.style.backgroundColor=
b;this.refreshStyle()},MO.FUiGridRow_refreshSize=function(){this.hPanel.style.pixelHeight=this._hFixPanel.offsetHeight},MO.FUiGridRow_refreshStyle=function(){this.hPanel.offsetHeight>this._hFixPanel.offsetHeight?this._hFixPanel.style.pixelHeight=this.hPanel.offsetHeight:this.hPanel.style.pixelHeight=this._hFixPanel.offsetHeight;this.table.isLov&&(this._hFixPanel.style.cursor="hand");this.__base.FUiGridRowControl.refreshStyle.call(this)};
with(MO)MO.FUiGridRowControl=function(b){b=RClass.inherits(this,b,FContainer,MDataContainer);b._cells=null;b._rows=null;b._clearProcess=null;b._resetProcess=null;b._loadProcess=null;b._saveProcess=null;b._recordProcess=null;b._statusCell=null;b.onBuildPanel=FUiGridRowControl_onBuildPanel;b.onBuild=FUiGridRowControl_onBuild;b.construct=FUiGridRowControl_construct;b.loadRow=FUiGridRowControl_loadRow;b.saveRow=FUiGridRowControl_saveRow;b.setVisible=FUiGridRowControl_setVisible;b.appendChild=FUiGridRowControl_appendChild;
b.push=FUiGridRowControl_push;return b},MO.FUiGridRowControl_onBuildPanel=function(b){this._hPanel=RBuilder.createTableRow(b,this.styleName("Panel"))},MO.FUiGridRowControl_onBuild=function(b){this.__base.FContainer.onBuild.call(this,b);b=this._table._columns;for(var d=b.count(),f=0;f<d;f++){var h=b.value(f).createCell();this.push(h)}},MO.FUiGridRowControl_construct=function(){this.__base.FContainer.construct.call(this);this._cells=new TDictionary;this._rows=new TObjects;this._clearProcess=new TEventProcess(null,
this,"oeClearValue",MEditValue);this._resetProcess=new TEventProcess(null,this,"oeResetValue",MEditValue);this._loadProcess=new TEventProcess(null,this,"oeLoadValue",MEditValue);this._saveProcess=new TEventProcess(null,this,"oeSaveValue",MEditValue);this._recordProcess=new TEventProcess(null,this,"oeRecordValue",MEditValue)},MO.FUiGridRowControl_loadRow=function(b){var d=RClass.create(FDataSource);d.selectRow(b);this.dsDataLoad(d)},MO.FUiGridRowControl_saveRow=function(b){return r},MO.FUiGridRowControl_setVisible=
function(b){this._visible=b;var d=this._hPanel;d&&RHtml.displaySet(d,b)},MO.FUiGridRowControl_appendChild=function(b){this.__base.FContainer.appendChild.call(this,b);b._column._optionFixed||this._hPanel.appendChild(b._hPanel)},MO.FUiGridRowControl_push=function(b){this.__base.FContainer.push.call(this,b);b._row=this;this._cells.set(b._column._dataName,b);RClass.isClass(b,FCellStatus)&&(this._statusCell=b)},MO.FUiGridRowControl_buildChildren=function(){var b=this.hFixPanel=hfp.insertRow(idx);b.className=
this.style("Panel");var d=this._hPanel=hp.insertRow(idx);d.className=this.style("Panel");for(var f=this.table.columns,h=f.count,q=0;q<h;q++){var w=f.value(q),z=w.createCell(this);w.dispFixed?b.appendChild(z._hPanel):d.appendChild(z._hPanel);this._cells.set(w.dataName,z)}this.doRefresh()},MO.FUiGridRowControl_isDataChanged=function(){for(var b=this._cells,d=b.count-1;0<=d;d--)if(b.value(d).isDataChanged())return!0;return!1},MO.FUiGridRowControl_isVisible=function(){return this._visible},MO.FUiGridRowControl_getIndex=
function(){return this._hPanel.rowIndex},MO.FUiGridRowControl_getId=function(){var b=this._cells.get("ouid");return b?b.reget():""},MO.FUiGridRowControl_getVersion=function(){var b=this._cells.get("over");return b?b.reget():""},MO.FUiGridRowControl_getStatus=function(){return this._statusCell},MO.FUiGridRowControl_cell=function(b){return this._cells.value(b)},MO.FUiGridRowControl_get=function(b){return this._cells.get(b).get()},MO.FUiGridRowControl_reget=function(b){return this._cells.get(b).reget()},
MO.FUiGridRowControl_set=function(b,d){this._cells.get(b).set(d)},MO.FUiGridRowControl_loadValue=function(b){this.loadRow(b)},MO.FUiGridRowControl_saveValue=function(b){this.saveRow(b)},MO.FUiGridRowControl_recordValue=function(){this.process(this._recordProcess)},MO.FUiGridRowControl_toAttributes=function(b){this.saveRow(b)},MO.FUiGridRowControl_toDeepAttributes=function(b){for(var d=new TList,f=this.table;f;){f!=this.table&&RClass.isClass(f,MDataset)&&d.push(f);if(!f.parent)break;f=f.topControl(MDataset)}for(f=
d.count-1;0<=f;f--){var h=d.get(f);if(RClass.isClass(h,FForm))h.toAttributes(b);else if(RClass.isClass(h,FTable)){h=h.getSelectRows();if(1!=h.count)return RMessage.fatal(this,"Invalid selected rows. (count={0})",h.count);h.get(0).toAttributes(b)}}this.toAttributes(b)},MO.FUiGridRowControl_select=function(b){this.isSelect=b;this._hPanel.style.backgroundColor=b?EColor._rowselect:EColor.Row;this.refreshStyle()},MO.FUiGridRowControl_extend=function(b){var d=this._rows;if(d&&d.count)for(var f=d.count,
h=0;h<f;h++){var q=d.get(h);b?(q.setVisible(!0),q.extend(q.extended)):q.setVisible(!1);q.refresh()}this.extended=b},MO.FUiGridRowControl_doInsert=function(){this.row||(this.row=new TRow);this.status=ERowStatus.Insert;this.table.setDataStatus(this,ERowStatus.Insert)},MO.FUiGridRowControl_doDelete=function(){this.status=ERowStatus.Delete;this.table.setDataStatus(this,ERowStatus.Delete)},MO.FUiGridRowControl_refresh=function(){this.table.setDataStatus(this,this.isDataChanged()?ERowStatus.Changed:ERowStatus.Normal)},
MO.FUiGridRowControl_refreshStyle=function(){var b=this._cells;if(b)for(var d=b.count-1;0<=d;d--)b.value(d).refreshStyle()},MO.FUiGridRowControl_dump=function(b){b=RString.nvlStr(b);b.append(RClass.dump(this),"[");b.append(this.isSelect?"S":"_");b.append("]");b.append(this.saveRow().dump());return b};
with(MO)MO.FUiTable=function(b){b=RClass.inherits(this,b,FGridControl,MDataset);b._detailFrameName=RClass.register(b,new APtyString("_detailFrameName"));b._styleFixPanel=RClass.register(b,new AStyle("_styleFixPanel"));b._styleFixForm=RClass.register(b,new AStyle("_styleFixForm"));b._styleHeadPanel=RClass.register(b,new AStyle("_styleHeadPanel"));b._styleHeadForm=RClass.register(b,new AStyle("_styleHeadForm"));b._styleColumnPanel=RClass.register(b,new AStyle("_styleColumnPanel"));b._styleColumnForm=
RClass.register(b,new AStyle("_styleColumnForm"));b._styleDataPanel=RClass.register(b,new AStyle("_styleDataPanel"));b._styleDataForm=RClass.register(b,new AStyle("_styleDataForm"));b._hFixPanel=null;b._hFixForm=null;b._hHeadPanel=null;b._hHeadForm=null;b._hColumnPanel=null;b._hColumnForm=null;b._hDataPanel=null;b._hDataForm=null;b.onBuildContent=FUiTable_onBuildContent;b.oeRefresh=FUiTable_oeRefresh;b.appendColumn=FUiTable_appendColumn;return b},MO.FUiTable_onBuildContent=function(b){b=this._hContentPanel;
var d=this._hFixPanel=RBuilder.appendDiv(b,this.styleName("FixPanel"));d.style.zIndex=2;d.style.position="absolute";d=this._hFixForm=RBuilder.appendTable(d,this.styleName("FixForm"),0,0,1);d.borderColorLight="#D0D0D0";d.borderColorDark="#EEEEEE";this._hFixHead=RBuilder.appendTableRow(d);this._hFixSearch=RBuilder.appendTableRow(d);this._hFixTotal=RBuilder.appendTableRow(d);this._hFixTotal.style.display="none";d=this._hHeadPanel=RBuilder.appendDiv(b,this.styleName("HeadPanel"));d.style.zIndex=1;d.style.position=
"absolute";d.style.overflowX="hidden";d.style.width=1;d=this._hHeadForm=RBuilder.appendTable(d,this.styleName("HeadForm"),0,0,1);d.frame="rhs";d.style.tableLayout="fixed";d.borderColorLight="#D0D0D0";d.borderColorDark="#EEEEEE";this._hHead=d.insertRow();this._hSearch=d.insertRow();this._hTotal=d.insertRow();this._hTotal.style.display="none";d=this._hColumnPanel=RBuilder.appendDiv(b,this.styleName("ColumnPanel"));d.style.zIndex=1;d.style.position="absolute";d.style.overflowY="hidden";d=this._hColumnForm=
RBuilder.appendTable(d,this.styleName("ColumnForm"),0,0,1);this._hFixRows=RBuilder.append(d,"TBODY");this._hFixRowLine=RBuilder.append(this._hFixRows,"TR");b=this._hDataPanel=RBuilder.appendDiv(b,this.styleName("DataPanel"));b.width="100%";b.height="100%";b=this._hDataForm=RBuilder.appendTable(b,this.styleName("DataForm"),0,0,1);this._hRows=RBuilder.append(b,"TBODY");this._hRowLine=RBuilder.append(this._hRows,"TR");this.panelNavigator=!0},MO.FUiTable_oeRefresh=function(b){this.__base.FGridControl.oeRefresh.call(this,
b);if(b.isAfter()){b=this._hFixPanel;var d=this._hHeadPanel,f=this._hColumnPanel,h=this._hDataPanel,q=b.offsetWidth,w=b.offsetHeight;f.style.display=h.style.display="none";var z=this._hContentPanel.offsetWidth,A=this._hContentPanel.offsetHeight;f.style.display=h.style.display="block";b.style.left="0px";b.style.top="0px";d.style.left=q+"px";d.style.top="0px";d.style.width=z-q+"px";this._hHead.style.height=this._hFixHead.offsetHeight+"px";this._hSearch.style.height=this._hFixSearch.offsetHeight+"px";
f.style.top=w+"px";f.style.width=q+"px";f.style.height=A-w+"px";h.style.left="0px";h.style.top="0px";h.style.width=z-q+"px";h.style.height=A-w+"px";h.style.paddingLeft=q;h.style.paddingTop=w}},MO.FUiTable_appendColumn=function(b){b._optionFixed?(this._hFixHead.appendChild(b._hPanel),this._hFixSearch.appendChild(b._hSearchPanel),this._hFixTotal.appendChild(b._hTotalPanel),this._hFixRowLine.appendChild(b._hFixPanel)):(this._hHead.appendChild(b._hPanel),this._hSearch.appendChild(b._hSearchPanel),this._hTotal.appendChild(b._hTotalPanel),
this._hRowLine.appendChild(b._hFixPanel))},MO.FUiTable_onResizeAfter=function(){var b=this._hDataPanel,d=this._hFixPanel,f=RHtml.scrollWidth(b),h=RHtml.scrollHeight(b);this._hHeadPanel.style.pixelWidth=b.offsetWidth-d.offsetWidth-f;this._hColumnPanel.style.pixelHeight=b.offsetHeight-d.offsetHeight-h+1},MO.FUiTable_oeResize=function(b){b=this._hPanel;if(b.offsetWidth&&b.offsetHeight){var d=this._hTitleForm,f=this._hFixPanel,h=this._hHeadPanel,q=this._hColumnPanel;b=this._hDataPanel;h.style.display=
q.style.display=b.style.display="none";var w=this._hBorderPanel.offsetWidth,z=this._hBorderPanel.offsetHeight;h.style.display=q.style.display=b.style.display="block";h.style.pixelWidth=w-f.offsetWidth;q.style.pixelHeight=z-f.offsetHeight-1-d.offsetHeight;b.style.pixelWidth=w;b.style.pixelHeight=z-d.offsetHeight;d=this.rows.count;for(f=0;f<d;f++)this.rows.get(f).refreshSize();this.dpScrollLeft&&(b.scrollLeft=this.dpScrollLeft,this.dpScrollLeft=null);RConsole.find(FEventConsole).push(this.eventResizeAfter);
return EEventStatus.Stop}};with(MO)MO.MUiMenuButton=function(b){return b=RClass.inherits(this,b)};
with(MO)MO.FUiMenuBar=function(b){b=RClass.inherits(this,b,FDuiContainer,MUiDescribeFrame);b._mergeCd=RClass.register(b,new APtyEnum("_mergeCd",null,EUiMerge,EUiMerge.Override));b._stylePanel=RClass.register(b,new AStyle("_stylePanel"));b._styleButtonPanel=RClass.register(b,new AStyle("_styleButtonPanel"));b._hLine=null;b.onBuildPanel=FUiMenuBar_onBuildPanel;b.onEnter=RMethod.empty;b.onLeave=RMethod.empty;b.appendChild=FUiMenuBar_appendChild;b.removeChild=FUiMenuBar_removeChild;b.dispose=FUiMenuBar_dispose;
return b},MO.FUiMenuBar_onBuildPanel=function(b){b=this._hPanel=RBuilder.createTable(b,this.styleName("Panel"));this._hLine=RBuilder.appendTableRow(b)},MO.FUiMenuBar_appendChild=function(b){this.__base.FDuiContainer.appendChild.call(this,b);if(RClass.isClass(b,MUiMenuButton)){var d=this._hLine,f=RBuilder.appendTableCell(d,this.styleName("ButtonPanel"));f._hParentLine=d;b.setPanel(f)}},MO.FUiMenuBar_removeChild=function(b){RClass.isClass(b,FUiMenuButton)&&(b._hParentLine.removeChild(b._hParent),b._hParentLine=
null,b._hParent=null);this.__base.FDuiContainer.removeChild.call(this,b)},MO.FUiMenuBar_dispose=function(){this._hLine=RHtml.free(this._hLine);this.__base.FDuiContainer.dispose.call(this)};
with(MO)MO.FUiMenuButton=function(b){b=RClass.inherits(this,b,FDuiControl,MUiMenuButton,MListenerClick);b._icon=RClass.register(b,new APtyString("_icon"));b._iconDisable=RClass.register(b,new APtyString("_iconDisable"));b._hotkey=RClass.register(b,new APtyString("_hotkey"));b._action=RClass.register(b,new APtyString("_action"));b._styleNormal=RClass.register(b,new AStyle("_styleNormal"));b._styleHover=RClass.register(b,new AStyle("_styleHover"));b._stylePress=RClass.register(b,new AStyle("_stylePress"));
b._styleDisable=RClass.register(b,new AStyle("_styleDisable"));b._styleIconPanel=RClass.register(b,new AStyle("_styleIconPanel"));b._styleSpacePanel=RClass.register(b,new AStyle("_styleSpacePanel"));b._styleLabelPanel=RClass.register(b,new AStyle("_styleLabelPanel"));b._disabled=!1;b._hForm=null;b._hLine=null;b._hIconPanel=null;b._hIcon=null;b._hSpacePanel=null;b._hLabelPanel=null;b.onBuildPanel=FUiMenuButton_onBuildPanel;b.onBuild=FUiMenuButton_onBuild;b.onEnter=FUiMenuButton_onEnter;b.onLeave=FUiMenuButton_onLeave;
b.onMouseDown=RClass.register(b,new AEventMouseDown("onMouseDown"),FUiMenuButton_onMouseDown);b.onMouseUp=RClass.register(b,new AEventMouseDown("onMouseUp"),FUiMenuButton_onMouseUp);b.icon=FUiMenuButton_icon;b.setIcon=FUiMenuButton_setIcon;b.setLabel=FUiMenuButton_setLabel;b.setHint=FUiMenuButton_setHint;b.setEnable=FUiMenuButton_setEnable;b.click=FUiMenuButton_click;b.dispose=FUiMenuButton_dispose;return b},MO.FUiMenuButton_onBuildPanel=function(b){this._hPanel=RBuilder.createDiv(b,this.styleName("Normal"))},
MO.FUiMenuButton_onBuild=function(b){this.__base.FDuiControl.onBuild.call(this,b);b=this._hPanel;this.attachEvent("onMouseDown",b);this.attachEvent("onMouseUp",b);b=this._hForm=RBuilder.appendTable(b);b=this._hLine=RBuilder.appendTableRow(b);if(this._icon){var d=this._hIconPanel=RBuilder.appendTableCell(b,this.styleName("IconPanel"));this._hIcon=RBuilder.appendIcon(d,null,this._icon)}this._icon&&this._label&&(this._hSpacePanel=RBuilder.appendTableCell(b,this.styleName("SpacePanel")));this._label&&
((this._hLabelPanel=RBuilder.appendTableCell(b,this.styleName("LabelPanel"))).noWrap=!0,this.setLabel(this._label));this._hotkey&&RConsole.find(FKeyConsole).register(this._hotkey,this,this.onMouseDown);this._hint&&this.setHint(this._hint)},MO.FUiMenuButton_onEnter=function(b){this._disabled||(this._hPanel.className=this.styleName("Hover"))},MO.FUiMenuButton_onLeave=function(){this._disabled||(this._hPanel.className=this.styleName("Normal"))},MO.FUiMenuButton_onMouseDown=function(){this._disabled||
(this._hPanel.className=this.styleName("Press"),this.click())},MO.FUiMenuButton_onMouseUp=function(){this._disabled||(this._hPanel.className=this.styleName("Hover"))},MO.FUiMenuButton_icon=function(){return this._icon},MO.FUiMenuButton_setIcon=function(b){this._icon=b;this._hIcon&&(this._hIcon.src=this.styleIconPath(this._icon))},MO.FUiMenuButton_setLabel=function(b){this._label=b=RString.nvl(b);RHtml.textSet(this._hLabelPanel,b)},MO.FUiMenuButton_setHint=function(b){this._hint=b;RString.nvl(b);this._hPanel.title=
this._hint},MO.FUiMenuButton_setEnable=function(b){this.__base.FDuiControl.setEnable.call(this,b);b?(this._hPanel.className=this.style("Button"),this._iconDisable&&this._icon&&(this._hIcon.src=RRes._iconPath(this._icon))):(this._hPanel.className=this.style("Disable"),this._iconDisable&&(this._hIcon.src=RRes._iconPath(this._iconDisable)))},MO.FUiMenuButton_click=function(){if(!this._disabled){RConsole.find(FUiFocusConsole).blur();var b=new SClickEvent(this);this.processClickListener(b);b.dispose();
this._action&&eval(this._action)}},MO.FUiMenuButton_dispose=function(){this._hForm=RHtml.free(this._hForm);this._hLine=RHtml.free(this._hLine);this._hIconPanel=RHtml.free(this._hIconPanel);this._hIcon=RHtml.free(this._hIcon);this._hSpacePanel=RHtml.free(this._hSpacePanel);this._hLabelPanel=RHtml.free(this._hLabelPanel);this.__base.FDuiControl.dispose.call(this)};
with(MO)MO.FUiMenuButtonMenu=function(b){b=RClass.inherits(this,b,FDuiControl);b._action=RClass.register(b,new APtyString("action",null));b._target=RClass.register(b,new APtyString("target",null));b._page=RClass.register(b,new APtyString("page"));b._hotkey=RClass.register(b,new APtyString("hotkey"));b._method=RClass.register(b,new APtyString("method"));b._icon=RClass.register(b,new APtyString("icon",null));b._iconDisable=RClass.register(b,new APtyString("iconDisable",null));b._attributes=RClass.register(b,
new APtyString("attributes"));b._disabled=!1;b.hButton=null;b.hButtonLine=null;b.hButtonPanel=null;b.hIcon=null;b.hText=null;b.oeBuild=FUiMenuButtonMenu_oeBuild;b.oeEnable=FUiMenuButtonMenu_oeEnable;b.oeDisable=FUiMenuButtonMenu_oeDisable;b.onBuildPanel=FUiMenuButtonMenu_onBuildPanel;b.onEnter=FUiMenuButtonMenu_onEnter;b.onLeave=FUiMenuButtonMenu_onLeave;b.onMouseDown=FUiMenuButtonMenu_onMouseDown;b.onMouseUp=FUiMenuButtonMenu_onMouseUp;b.onClick=FUiMenuButtonMenu_onClick;b.construct=FUiMenuButtonMenu_construct;
b.dispose=FUiMenuButtonMenu_dispose;return b},MO.FUiMenuButtonMenu_oeBuild=function(b){this.base.FDuiControl.oeBuild.call(this,b);this.hButton=RBuilder.appendTable(this.hPanel,this.style("Button"));this.linkClickEvent(this.hButton);b=(this.hButtonLine=this.hButton.insertRow()).insertCell();this._icon&&(this.hIcon=RBuilder.appendIcon(b,this._icon));this.label&&(this.hLabel=RBuilder.appendText(b,(this.hIcon?"&nbsp;":"")+this.label),this.hLabel.className=this.style("Label"));return EEventStatus.Stop},
MO.FUiMenuButtonMenu_onBuildPanel=function(){this.hPanel=RBuilder.create(null,"DIV")},MO.FUiMenuButtonMenu_oeEnable=function(b){this.base.FDuiControl.oeEnable.call(this,b);this.hPanel.className=this.style("Button");this._iconDisable&&this._icon&&(this.hIcon.src=RRes._iconPath(this._icon));return EEventStatus.Stop},MO.FUiMenuButtonMenu_oeDisable=function(b){this.base.FDuiControl.oeDisable.call(this,b);this.hPanel.className=this.style("Disable");this._iconDisable&&(this.hIcon.src=RRes._iconPath(this._iconDisable));
return EEventStatus.Stop},MO.FUiMenuButtonMenu_onEnter=function(){this._disabled||(this.hPanel.className=this.style("Hover"))},MO.FUiMenuButtonMenu_onLeave=function(){this._disabled||(this.hPanel.className=this.style("Panel"))},MO.FUiMenuButtonMenu_onMouseDown=function(){this._disabled||(this.hPanel.className=this.style("Press"))},MO.FUiMenuButtonMenu_onMouseUp=function(){this._disabled||(this.hPanel.className=this.style("Hover"))},MO.FUiMenuButtonMenu_onClick=function(){if(!this._disabled){RConsole.find(FFocusConsole).focus(this);
this._action&&eval(this._action);if(this._page||this._method){var b=RHtml.form(this.hButton),d=RPage.parse(this._page);this._method&&(d._action=this._method);d.split(this._attributes);d.post(b,this._target)}this.processClick()}},MO.FUiMenuButtonMenu_construct=function(){this.base.FDuiControl.construct.call(this)},MO.FUiMenuButtonMenu_dispose=function(){this.base.FDuiControl.dispose.call(this);RMemory.freeHtml(this.hPanel);RMemory.freeHtml(this.hButton);this.hLabel=this.hButtonLine=this.hButton=this.hIcon=
this.hPanel=null};
with(MO)MO.FUiMenuButtonSplit=function(b){b=RClass.inherits(this,b,FDuiControl,MUiMenuButton);b._stylePanelHorizontal=RClass.register(b,new AStyle("_stylePanelHorizontal"));b._stylePanelVertical=RClass.register(b,new AStyle("_stylePanelVertical"));b.onBuild=FUiMenuButtonSplit_onBuild;return b},MO.FUiMenuButtonSplit_onBuild=function(b){this.__base.FDuiControl.onBuild.call(this,b);b=this._hPanel;RClass.isClass(this._parent,FUiMenuBar)?b.className=this.styleName("PanelVertical"):b.className=this.styleName("PanelHorizontal")};
with(MO)MO.FUiPopupMenu=function(b){b=RClass.inherits(this,b,FDuiContainer,MUiPopup);b._stylePanel=RClass.register(b,new AStyle("_stylePanel"));b._styleForm=RClass.register(b,new AStyle("_styleForm"));b._styleContainer=RClass.register(b,new AStyle("_styleContainer"));b._styleLabel=RClass.register(b,new AStyle("_styleLabel"));b._styleButton=RClass.register(b,new AStyle("_styleButton"));b._opener=null;b._visible=!1;b._statusVisible=!1;b._hContainer=null;b._hLabel=null;b._hButtonPanel=null;b._hIcon=
null;b._hText=null;b.onBuild=FUiPopupMenu_onBuild;b.appendChild=FUiPopupMenu_appendChild;b.show=FUiPopupMenu_show;b.setVisible=FUiPopupMenu_setVisible;b.testInRange=FUiPopupMenu_testInRange;b.doBlur=FUiPopupMenu_doBlur;b.dispose=FUiPopupMenu_dispose;return b},MO.FUiPopupMenu_onBuild=function(b){this.__base.FDuiContainer.onBuild.call(this,b);b=this._hForm=RBuilder.appendTable(this._hPanel,this.styleName("Form"));var d=this._hLineTop=RBuilder.appendTableCell(b);d.bgColor="#666666";d.height="2px";d=
this._hContainerPanel=RBuilder.appendTableCell(b);b=this._hLineBottom=RBuilder.appendTableCell(b);b.bgColor="#666666";b.height="2px";this._hContainer=RBuilder.appendTable(d,this.styleName("Container"))},MO.FUiPopupMenu_doBlur=function(){},MO.FUiPopupMenu_appendChild=function(b){var d=RBuilder.appendTableRowCell(this._hContainer);d.className=this.styleName("Button");d.appendChild(b._hPanel)},MO.FUiPopupMenu_show=function(b,d,f){b=this._hPanel;d=this._opener;this.setVisible(!0);f=d._hPanel;d=f.offsetWidth;
f=f.offsetHeight;var h=b.offsetWidth,q=b.offsetHeight;b=b.style;h<d&&(h=d);300<q&&(this._hFormPanel.style.overflowY="scroll",b.height=q+"px");b.left="3px";b.top=f+1+"px";b.width=h+"px";b.zIndex=RUiLayer.next()},MO.FUiPopupMenu_setVisible=function(b){var d=this._opener;this._statusVisible=b;var d=d._hPanelCell,f=this.panel(EPanel.Container);b?d.appendChild(f):d.removeChild(f)},MO.FUiPopupMenu_testInRange=function(b){return this==RControl.htmlControl(b.srcElement,FUiPopupMenu)},MO.FUiPopupMenu_dispose=
function(b){this._hContainer=RMemory.free(this._hContainer);this._hPanel=RMemory.free(this._hPanel);this._hLabel=RMemory.free(this._hLabel);this._hLastRow=RMemory.free(this._hLastRow);this.__base.FDuiContainer.dispose.call(this)};with(MO)MO.MUiToolButton=function(b){return b=RClass.inherits(this,b)};
with(MO)MO.FUiToolBar=function(b){b=RClass.inherits(this,b,FDuiContainer,MUiDescribeFrame);b._alignCd=RClass.register(b,new APtyEnum("_alignCd",null,EUiAlign,EUiAlign.Left));b._directionCd=RClass.register(b,new APtyEnum("_directionCd",null,EUiDirection,EUiDirection.Horizontal));b._mergeCd=RClass.register(b,new APtyEnum("_mergeCd",null,EUiMerge,EUiMerge.Override));b._stylePanel=RClass.register(b,new AStyle("_stylePanel"));b._styleButtonPanel=RClass.register(b,new AStyle("_styleButtonPanel"));b._hLine=
null;b.onBuildPanel=FUiToolBar_onBuildPanel;b.onEnter=RMethod.empty;b.onLeave=RMethod.empty;b.appendChild=FUiToolBar_appendChild;b.removeChild=FUiToolBar_removeChild;b.dispose=FUiToolBar_dispose;return b},MO.FUiToolBar_onBuildPanel=function(b){this._hPanel=RBuilder.createTable(b,this.styleName("Panel"))},MO.FUiToolBar_appendChild=function(b){this.__base.FDuiContainer.appendChild.call(this,b);if(RClass.isClass(b,MUiToolButton)){var d=this._hPanel,f=this._hLine;this._directionCd!=EUiDirection.Horizontal||
f||(f=this._hLine=RBuilder.appendTableRow(d));this._directionCd==EUiDirection.Vertical&&(f=this._hLine=RBuilder.appendTableRow(d));d=RBuilder.appendTableCell(f,this.styleName("ButtonPanel"));b._hPanelCell=d;b.setPanel(d)}},MO.FUiToolBar_removeChild=function(b){RClass.isClass(b,MUiToolButton)&&(b._hParentLine.removeChild(b._hParent),b._hParent=null,b._hParentLine=null);this.__base.FDuiContainer.removeChild.call(this,b)},MO.FUiToolBar_dispose=function(){this._hLine=RHtml.free(this._hLine);this.__base.FDuiContainer.dispose.call(this)};
with(MO)MO.FUiToolButton=function(b){b=RClass.inherits(this,b,FDuiControl,MUiToolButton,MListenerClick);b._icon=RClass.register(b,new APtyString("_icon"));b._iconDisable=RClass.register(b,new APtyString("_iconDisable"));b._hotkey=RClass.register(b,new APtyString("_hotkey"));b._action=RClass.register(b,new APtyString("_action"));b._stylePanel=RClass.register(b,new AStyle("_stylePanel"));b._styleNormal=RClass.register(b,new AStyle("_styleNormal"));b._styleHover=RClass.register(b,new AStyle("_styleHover"));
b._stylePress=RClass.register(b,new AStyle("_stylePress"));b._styleDisable=RClass.register(b,new AStyle("_styleDisable"));b._styleIconPanel=RClass.register(b,new AStyle("_styleIconPanel"));b._styleSpacePanel=RClass.register(b,new AStyle("_styleSpacePanel"));b._styleLabelPanel=RClass.register(b,new AStyle("_styleLabelPanel"));b._disabled=!1;b._hForm=null;b._hLine=null;b._hIconPanel=null;b._hIcon=null;b._hSpacePanel=null;b._hLabelPanel=null;b.onBuildPanel=FUiToolButton_onBuildPanel;b.onBuildButton=
FUiToolButton_onBuildButton;b.onBuild=FUiToolButton_onBuild;b.onEnter=FUiToolButton_onEnter;b.onLeave=FUiToolButton_onLeave;b.onMouseDown=RClass.register(b,new AEventMouseDown("onMouseDown"),FUiToolButton_onMouseDown);b.onMouseUp=RClass.register(b,new AEventMouseDown("onMouseUp"),FUiToolButton_onMouseUp);b.icon=FUiToolButton_icon;b.setIcon=FUiToolButton_setIcon;b.setLabel=FUiToolButton_setLabel;b.setHint=FUiToolButton_setHint;b.setEnable=FUiToolButton_setEnable;b.doClick=FUiToolButton_doClick;b.dispose=
FUiToolButton_dispose;return b},MO.FUiToolButton_onBuildPanel=function(b){this._hPanel=RBuilder.createDiv(b,this.styleName("Panel"))},MO.FUiToolButton_onBuildButton=function(b){b=this._hPanel;this.attachEvent("onMouseDown",b);this.attachEvent("onMouseUp",b);b=this._hForm=RBuilder.appendTable(b,this.styleName("Normal"));b=this._hLine=RBuilder.appendTableRow(b);if(this._icon){var d=this._hIconPanel=RBuilder.appendTableCell(b,this.styleName("IconPanel"));this._hIcon=RBuilder.appendIcon(d,null,this._icon)}this._icon&&
this._label&&(this.hSpacePanel=RBuilder.appendTableCell(b,this.styleName("SpacePanel")));this._label&&((this._hLabelPanel=RBuilder.appendTableCell(b,this.styleName("LabelPanel"))).noWrap=!0,this.setLabel(this._label));this._hotkey&&RConsole.find(FKeyConsole).register(this._hotkey,this,this.onMouseDown);this._hint&&this.setHint(this._hint)},MO.FUiToolButton_onBuild=function(b){this.__base.FDuiControl.onBuild.call(this,b);this.onBuildButton(b)},MO.FUiToolButton_onEnter=function(b){this._disabled||(this._hForm.className=
this.styleName("Hover"))},MO.FUiToolButton_onLeave=function(b){this._disabled||(this._hForm.className=this.styleName("Normal"))},MO.FUiToolButton_onMouseDown=function(){this._disabled||(this._hForm.className=this.styleName("Press"),this.doClick())},MO.FUiToolButton_onMouseUp=function(b){this._disabled||(this._hForm.className=this.styleName("Hover"))},MO.FUiToolButton_icon=function(){return this._icon},MO.FUiToolButton_setIcon=function(b){this._icon=b;this._hIcon&&(this._hIcon.src=this.styleIconPath(this._icon))},
MO.FUiToolButton_setLabel=function(b){this._label=b=RString.nvl(b);var d=this._hLabelPanel;d&&RHtml.textSet(d,b)},MO.FUiToolButton_setHint=function(b){this._hint=b;RString.nvl(b);this._hPanel.title=this._hint},MO.FUiToolButton_setEnable=function(b){this.__base.FDuiControl.oeEnable.call(this,e);this._disabled=!e.enable;e.enable&&this._icon?(b=RResource.iconPath(this._icon),this._hIcon.src!=b&&(this._hIcon.src=b)):!e.enable&&this._iconDisable&&(b=RResource.iconPath(this._iconDisable),this._hIcon.src!=
b&&(this._hIcon.src=b));b=this.styleName(e.enable?"Icon":"IconDisable");this._hIcon.className!=b&&(this._hIcon.className=b);b=this.styleName(e.enable?"Button":"Disable");this._hPanel.className!=b&&(this._hPanel.className=b);b=this.styleIconPath(e.enable?"Button":"ButtonDisable");this._hButton.background!=b&&(this._hButton.background=b);return EEventStatus.Stop},MO.FUiToolButton_doClick=function(){if(!this._disabled){RConsole.find(FUiFocusConsole).blur();var b=new SClickEvent(this);this.processClickListener(b);
b.dispose();this._action&&eval(this._action)}},MO.FUiToolButton_dispose=function(){this._hForm=RHtml.free(this._hForm);this._hLine=RHtml.free(this._hLine);this._hIconPanel=RHtml.free(this._hIconPanel);this._hIcon=RHtml.free(this._hIcon);this._hSpacePanel=RHtml.free(this._hSpacePanel);this._hLabelPanel=RHtml.free(this._hLabelPanel);this.__base.FDuiControl.dispose.call(this)};
with(MO)MO.FUiToolButtonCheck=function(b){b=RClass.inherits(this,b,FUiToolButton);b._optionChecked=RClass.register(b,new APtyBoolean("_optionChecked","check"));b._groupName=RClass.register(b,new APtyString("_groupName"));b._groupDefault=RClass.register(b,new APtyString("_groupDefault"));b._statusChecked=!1;b.onEnter=FUiToolButtonCheck_onEnter;b.onLeave=FUiToolButtonCheck_onLeave;b.onMouseDown=FUiToolButtonCheck_onMouseDown;b.onMouseUp=FUiToolButtonCheck_onMouseUp;b.groupName=FUiToolButtonCheck_groupName;
b.setGroupName=FUiToolButtonCheck_setGroupName;b.groupDefault=FUiToolButtonCheck_groupDefault;b.setGroupDefault=FUiToolButtonCheck_setGroupDefault;b.innerCheck=FUiToolButtonCheck_innerCheck;b.isCheck=FUiToolButtonCheck_isCheck;b.check=FUiToolButtonCheck_check;b.dispose=FUiToolButtonCheck_dispose;return b},MO.FUiToolButtonCheck_onEnter=function(b){this._statusChecked||(this._hForm.className=this.styleName("Hover"))},MO.FUiToolButtonCheck_onLeave=function(b){this._statusChecked||(this._hForm.className=
this.styleName("Normal"))},MO.FUiToolButtonCheck_onMouseDown=function(b){this.check(!this._statusChecked);b=new SClickEvent(this);b.checked=this._statusChecked;this.processClickListener(b,this._statusChecked);b.dispose()},MO.FUiToolButtonCheck_onMouseUp=function(){},MO.FUiToolButtonCheck_groupName=function(){return this._groupName},MO.FUiToolButtonCheck_setGroupName=function(b){this._groupName=b},MO.FUiToolButtonCheck_groupDefault=function(){return this._groupDefault},MO.FUiToolButtonCheck_setGroupDefault=
function(b){this._groupDefault=b},MO.FUiToolButtonCheck_innerCheck=function(b){this._statusChecked!=b&&(this._statusChecked=b,this._hForm.className=b?this.styleName("Press"):this.styleName("Normal"))},MO.FUiToolButtonCheck_isCheck=function(){return this._statusChecked},MO.FUiToolButtonCheck_check=function(b){if(b||this._groupDefault!=this)if(this.innerCheck(b),this._parent)if(b){if(!RString.isEmpty(this._groupName)){b=this._parent.components();for(var d=b.count()-1;0<=d;d--){var f=b.value(d);f!=this&&
RClass.isClass(f,FUiToolButtonCheck)&&f.innerCheck(!1)}}}else RString.isEmpty(this._groupDefault)||((b=this._parent.components().get(this._groupDefault))?b.innerCheck(!0):MO.Logger.error("Can't find group default control. (name={1})",this._groupDefault))},MO.FUiToolButtonCheck_dispose=function(){this._groupName=this._statusChecked=null;this.__base.FUiToolButton.dispose.call(this)};
with(MO)MO.FUiToolButtonEdit=function(b){b=RClass.inherits(this,b,FUiToolButton,MListenerDataChanged);b._editSize=RClass.register(b,new APtySize2("_editSize"));b._hEdit=null;b.onBuildButton=FUiToolButtonEdit_onBuildButton;b.onEnter=RMethod.empty;b.onLeave=RMethod.empty;b.onInputEdit=RClass.register(b,new AEventInputChanged("onInputEdit"),FUiToolButtonEdit_onInputEdit);b.onInputKeyDown=RClass.register(b,new AEventKeyDown("onInputKeyDown"),FUiToolButtonEdit_onInputKeyDown);b.construct=FUiToolButtonEdit_construct;
b.text=FUiToolButtonEdit_text;b.setText=FUiToolButtonEdit_setText;return b},MO.FUiToolButtonEdit_onBuildButton=function(b){b=this._hForm=RBuilder.appendTable(this._hPanel);b=this._hLine=RBuilder.appendTableRow(b);var d=this._hEditPanel=RBuilder.appendTableCell(b),d=this._hEdit=RBuilder.appendEdit(d);d.style.width=this._editSize.width+"px";this.attachEvent("onInputEdit",d,this.onInputEdit);this.attachEvent("onInputKeyDown",d);this._hEditSpacePanel=RBuilder.appendTableCell(b,this.styleName("SpacePanel"));
this._icon&&(d=this._hIconPanel=RBuilder.appendTableCell(b,this.styleName("IconPanel")),this._hIcon=RBuilder.appendIcon(d,null,this._icon));this._icon&&this._label&&(this._hSpacePanel=RBuilder.appendTableCell(b,this.styleName("SpacePanel")));this._label&&(b=this._hLabelPanel=RBuilder.appendTableCell(b,this.styleName("LabelPanel")),this.attachEvent("onMouseDown",b),this.attachEvent("onMouseUp",b),b.noWrap=!0,this.setLabel(this._label));this._hotkey&&RConsole.find(FKeyConsole).register(this._hotkey,
this,this.onMouseDown);this._hint&&this.setHint(this._hint)},MO.FUiToolButtonEdit_onInputEdit=function(b){this.processDataChangedListener(this)},MO.FUiToolButtonEdit_onInputKeyDown=function(b){b.keyCode==EKeyCode.Enter&&this.doClick()},MO.FUiToolButtonEdit_construct=function(){this.__base.FUiToolButton.construct.call(this);this._editSize=new SSize2},MO.FUiToolButtonEdit_text=function(){return this._hEdit.value},MO.FUiToolButtonEdit_setText=function(b){this._hEdit.value=b};
with(MO)MO.FUiToolButtonMenu=function(b){b=RClass.inherits(this,b,FUiToolButton,MUiContainer,MUiDropable,MUiFocus);b._menu=null;b._statusDrop=!1;b._hDropPanel=null;b._stylePanel=RClass.register(b,new AStyle("_stylePanel"));b._styleDropHover=RClass.register(b,new AStyleIcon("_styleDropHover"));b.onBuild=FUiToolButtonMenu_onBuild;b.onEnter=FUiToolButtonMenu_onEnter;b.onLeave=FUiToolButtonMenu_onLeave;b.onMouseDown=FUiToolButtonMenu_onMouseDown;b.onBlur=FUiToolButtonMenu_onBlur;b.onMouseUp=RMethod.empty;
b.construct=FUiToolButtonMenu_construct;b.push=FUiToolButtonMenu_push;b.drop=FUiToolButtonMenu_drop;b.doClick=FUiToolButtonMenu_doClick;b.dispose=FUiToolButtonMenu_dispose;return b},MO.FUiToolButtonMenu_onBuild=function(b){this.__base.FUiToolButton.onBuild.call(this,b);var d=this._hDropPanel=RBuilder.appendTableCell(this._hLine);this.onBuildDrop(d);this._menu.onBuild(b)},MO.FUiToolButtonMenu_onEnter=function(b){this._statusDrop||this.__base.FUiToolButton.onEnter.call(this,b)},MO.FUiToolButtonMenu_onLeave=
function(b){this._statusDrop||this.__base.FUiToolButton.onLeave.call(this,b)},MO.FUiToolButtonMenu_onMouseDown=function(){this._statusDrop||(this._hForm.className=this.styleName("Press"),this.doClick())},MO.FUiToolButtonMenu_onBlur=function(b){},MO.FUiToolButtonMenu_construct=function(){this.__base.FUiToolButton.construct.call(this);(this._menu=RClass.create(FUiPopupMenu))._opener=this},MO.FUiToolButtonMenu_push=function(b){if(RClass.isClass(b,MUiMenuButton))return this._menu.push(b);this.__base.FUiToolButton.push.call(this,
b)},MO.FUiToolButtonMenu_drop=function(b){this._disabled||((this._statusDrop=!this._statusDrop)?(this._hForm.className=this.styleName("Press"),this._menu.show(this._hDropPanel,EUiAlign.BottomRight),RConsole.find(FUiPopupConsole).show(this._menu)):(this._hForm.className=this.styleName("Normal"),this._menu.hide()))},MO.FUiToolButtonMenu_doClick=function(){this.__base.FUiToolButton.doClick.call(this);this.drop(!this._statusDrop)},MO.FUiToolButtonMenu_dispose=function(){this._hDropIcon=RHtml.free(this._hDropIcon);
this._hDropPanel=RHtml.free(this._hDropPanel);this.__base.FControl.dispose.call(this)};with(MO)MO.FUiToolButtonSplit=function(b){b=RClass.inherits(this,b,FUiToolButton,MUiToolButton);b._stylePanel=RClass.register(b,new AStyle("_stylePanel"));b.onBuild=FUiToolButtonSplit_onBuild;return b},MO.FUiToolButtonSplit_onBuild=function(b){this.__base.FDuiControl.onBuild.call(this,b);this._hPanel.className=this.styleName("Panel")};with(MO)MO.FUiToolButtonText=function(b){return b=RClass.inherits(this,b,FUiToolButton)};
with(MO)MO.RUiToolBar=function(){this.fromNode=RUiToolBar_fromNode;return this},MO.RUiToolBar_mergeNode=function(b,d,f){d=d.nodes;for(var h=0;h<d.count;h++){var q=d.get(h);if("ToolBar"==q.name&&q.nodes)for(var w=0;w<q.nodes.count;w++)b.push(q.nodes.get(w))}if(f)for(h=d.count-1;0<=h;h--)q=d.get(h),"ToolBar"==q.name&&d.removeItem(q);return b},MO.RUiToolBar_fromNode=function(b,d,f,h){if(d&&d._nodes){var q=null;d=d._nodes;for(var w=d.count(),z=0;z<w;z++){var A=d.getAt(z);A.isName("ToolBar")&&(q?A.hasNode()&&
q.nodes().append(A.nodes()):q=A)}if(h)for(h=0;h<d.count();h++)A=d.getAt(h),A.isName("ToolBar")&&d.erase(h--);q&&RControl.build(b,q,null,f)}},MO.RUiToolBar=new RUiToolBar;
with(MO)MO.FUiPageControl=function(b){b=RClass.inherits(this,b,FDuiContainer);b._sizeCd=EUiSize.Horizontal;b._stylePanel=RClass.register(b,new AStyle("_stylePanel"));b._styleTitlePanel=RClass.register(b,new AStyle("_styleTitlePanel"));b._styleTitleForm=RClass.register(b,new AStyle("_styleTitleForm"));b._styleDataPanel=RClass.register(b,new AStyle("_styleDataPanel"));b._styleDataForm=RClass.register(b,new AStyle("_styleDataForm"));b._styleTop=RClass.register(b,new AStyle("_styleTop"));b._styleBottom=
RClass.register(b,new AStyle("_styleBottom"));b._styleForm=RClass.register(b,new AStyle("_styleForm"));b._sheets=null;b._activeSheet=null;b._esize=EUiSize.Both;b._hTop=null;b._hLine=null;b._hBottom=null;b._hSheets=null;b.onBuildPanel=FUiPageControl_onBuildPanel;b.onBuild=FUiPageControl_onBuild;b.oeRefresh=FUiPageControl_oeRefresh;b.construct=FUiPageControl_construct;b.appendChild=FUiPageControl_appendChild;b.select=FUiPageControl_select;b.selectByIndex=FUiPageControl_selectByIndex;b.sheet=FUiPageControl_sheet;
b.push=FUiPageControl_push;b.dispose=FUiPageControl_dispose;return b},MO.FUiPageControl_onBuildPanel=function(b){(this._hPanel=RBuilder.createTable(b,this.styleName("Panel"))).width="100%"},MO.FUiPageControl_onBuild=function(b){this.__base.FDuiContainer.onBuild.call(this,b);b=RBuilder.appendTableRowCell(this._hPanel,this.styleName("TitlePanel"));b=this.hTitleForm=RBuilder.appendTable(b,this.styleName("TitleForm"));b.width="100%";var d=this._hTop=RBuilder.appendTableRow(b);d.height=1;this._hLine=RBuilder.appendTableRow(b);
d=this._hBottom=RBuilder.appendTableRow(b);d.height=1;b=this._hFirstTop=RBuilder.appendTableCell(this._hTop);b.width=12;this._hFirst=RBuilder.appendTableCell(this._hLine);(this._hFirstBottom=RBuilder.appendTableCell(this._hBottom)).className=this.styleName("Bottom",FUiPageSheet);this._hLastTop=RBuilder.appendTableCell(this._hTop);this._hLast=RBuilder.appendTableCell(this._hLine);b=this._hLastBottom=RBuilder.appendTableCell(this._hBottom);b.className=this.styleName("Bottom",FUiPageSheet)},MO.FUiPageControl_oeRefresh=
function(b){var d=this.__base.FDuiContainer.oeRefresh.call(this,b);b.isBefore()&&this._sheets.count()&&(this._activeSheet?this._activeSheet.oeRefresh(e):(b=this._activeSheet=this._sheets.value(0))&&b.innerSelect(!0));return d},MO.FUiPageControl_construct=function(){this.__base.FDuiContainer.construct.call(this);this._sheets=new TDictionary},MO.FUiPageControl_appendChild=function(b){if(RClass.isClass(b,FUiPageSheet)){var d=this._hLast.cellIndex,f=b._hTopL=RBuilder.appendTableCell(this._hTop,null,d);
f.width=1;f.className=b.styleName("Top");f=b._hTop=RBuilder.appendTableCell(this._hTop,null,d+1);f.className=b.styleName("Top");f=b._hTopR=RBuilder.appendTableCell(this._hTop,null,d+2);f.width=1;f.className=b.styleName("Top");f=b._hLeft=RBuilder.appendTableCell(this._hLine,null,d);f.width=1;f.className=b.styleName("Left");f=b._hButtonPanel=RBuilder.appendTableCell(this._hLine,null,d+1);b.attachEvent("onButtonEnter",f);b.attachEvent("onButtonLeave",f);b.attachEvent("onHeadMouseDown",f);f.width=1;f=
b._hButton=RBuilder.appendDiv(f,b.styleName("Button"));b.icon&&(b._hIcon=RBuilder.appendIcon(f,null,b.icon));b.label&&(b._hText=RBuilder.appendSpan(f,b.styleName("ButtonText")),b._hText.innerText=" "+b.label());f=b._hRight=RBuilder.appendTableCell(this._hLine,null,d+2);f.width=1;f.className=b.styleName("Right");f=b._hBottomL=RBuilder.appendTableCell(this._hBottom,null,d);f.width=1;f.className=b.styleName("Bottom");f=b._hBottom=RBuilder.appendTableCell(this._hBottom,null,d+1);f.className=b.styleName("Bottom");
f=b._hBottomR=RBuilder.appendTableCell(this._hBottom,null,d+2);f.width=1;f.className=b.styleName("Bottom");d=RBuilder.appendTableRow(this._hPanel);b.index&&(d.style.display="none");f=RBuilder.appendTableCell(d);b._hForm=d;f.style.verticalAlign="top";f.appendChild(b._hPanel);this.selectByIndex(0)}},MO.FUiPageControl_sheet=function(b){return this._sheets.get(b)},MO.FUiPageControl_select=function(b){this._activeSheet=b;for(var d=this._sheets,f=d.count(),h=0;h<f;h++){var q=d.at(h);q!=b&&q.select(!1)}b.select(!0)},
MO.FUiPageControl_selectByIndex=function(b){(b=this._sheets.value(b))&&this.select(b)},MO.FUiPageControl_push=function(b){if(RClass.isClass(b,FUiPageSheet)){var d=this._sheets;b._pageControl=this;b._index=d.count();d.set(b.name(),b)}this.__base.FDuiContainer.push.call(this,b)},MO.FUiPageControl_dispose=function(){this.__base.FDuiContainer.dispose.call(this)};
with(MO)MO.FUiPageSheet=function(b){b=RClass.inherits(this,b,FUiLayout);b._icon=RClass.register(b,new APtyString("_icon"));b._formName=RClass.register(b,new APtyString("_formName"));b._formLink=RClass.register(b,new APtyString("_formLink"));b._formWhere=RClass.register(b,new APtyString("_formWhere"));b._formOrder=RClass.register(b,new APtyString("_formOrder"));b._stylePanel=RClass.register(b,new AStyle("_stylePanel"));b._styleTop=RClass.register(b,new AStyle("_styleTop"));b._styleTopSelect=RClass.register(b,
new AStyle("_styleTopSelect"));b._styleLeft=RClass.register(b,new AStyle("_styleLeft"));b._styleLeftSelect=RClass.register(b,new AStyle("_styleLeftSelect"));b._styleRight=RClass.register(b,new AStyle("_styleRight"));b._styleRightSelect=RClass.register(b,new AStyle("_styleRightSelect"));b._styleRightPrior=RClass.register(b,new AStyle("_styleRightPrior"));b._styleButtom=RClass.register(b,new AStyle("_styleBottom"));b._styleBottomSelect=RClass.register(b,new AStyle("_styleBottomSelect"));b._styleButtonText=
RClass.register(b,new AStyle("_styleButtonText"));b._styleButton=RClass.register(b,new AStyle("_styleButton"));b._styleButtonHover=RClass.register(b,new AStyle("_styleButtonHover"));b._styleButtonSelect=RClass.register(b,new AStyle("_styleButtonSelect"));b._styleDataPanel=RClass.register(b,new AStyle("_styleDataPanel"));b._top=0;b._pages=null;b._index=null;b._selected=!1;b._hasBuilded=!1;b.lsnsSelect=null;b._hTopL=null;b._hTop=null;b._hTopR=null;b._hLeft=null;b._hButton=null;b._hIcon=null;b._hText=
null;b._hBottomL=null;b._hBottom=null;b._hBottomR=null;b._hRight=null;b.onBuildPanel=FUiPageSheet_onBuildPanel;b.onButtonEnter=RClass.register(b,new AEventMouseEnter("onButtonEnter"),FUiPageSheet_onButtonEnter);b.onButtonLeave=RClass.register(b,new AEventMouseLeave("onButtonLeave"),FUiPageSheet_onButtonLeave);b.onHeadMouseDown=RClass.register(b,new AEventMouseDown("onHeadMouseDown"),FUiPageSheet_onHeadMouseDown);b.construct=FUiPageSheet_construct;b.innerSelect=FUiPageSheet_innerSelect;b.select=FUiPageSheet_select;
b.setVisible=FUiPageSheet_setVisible;b.dispose=FUiPageSheet_dispose;b.innerDump=FUiPageSheet_innerDump;return b},MO.FUiPageSheet_onBuildPanel=function(b){b=this._hPanel=this._hContainer=RBuilder.createDiv(b,this.styleName("Panel"));b.style.width="100%";b.style.height="100%";b=this._hPanelForm=RBuilder.appendTable(b);b.style.width="100%";b.style.height="100%"},MO.FUiPageSheet_onButtonEnter=function(b){this._selected||(this._hButton.className=this.styleName("ButtonHover"))},MO.FUiPageSheet_onButtonLeave=
function(b){this._selected||(this._hButton.className=this.styleName("Button"))},MO.FUiPageSheet_onHeadMouseDown=function(b){this._parent.select(this)},MO.FUiPageSheet_construct=function(){this.__base.FUiLayout.construct.call(this);this.lsnsSelect=new TListeners},MO.FUiPageSheet_innerSelect=function(b){var d=this._parent;b&&!this._hasBuilded&&(this._hasBuilded=!0);var f=0==this._index,d=d._activeSheet._index-1==this._index;this._selected!=b&&(b&&this.lsnsSelect.process(),this._selected=b);this._hButton.className=
b?this.styleName("ButtonSelect"):this.styleName("Button");this._hTop.className=b?this.styleName("TopSelect"):this.styleName("Top");this._hLeft.className=b?this.styleName("LeftSelect"):f?this.styleName("Right"):this.styleName("Left");this._hBottomL.className=b?this.styleName("BottomSelect"):this.styleName("Bottom");this._hBottom.className=b?this.styleName("BottomSelect"):this.styleName("Bottom");this._hBottomR.className=b?this.styleName("BottomSelect"):this.styleName("Bottom");this._hRight.className=
b?this.styleName("RightSelect"):d?this.styleName("RightPrior"):this.styleName("Right");RHtml.visibleSet(this._hForm,b)},MO.FUiPageSheet_select=function(b){this.innerSelect(b);b&&(this.psRefresh(),this.psResize())},MO.FUiPageSheet_setVisible=function(b){RHtml.displaySet(this._hPanel,b)},MO.FUiPageSheet_dispose=function(){this._hButton=RMemory.free(this._hButton);this._hTop=RMemory.free(this._hTop);this._hLeft=RMemory.free(this._hLeft);this._hBottomL=RMemory.free(this._hBottomL);this._hBottom=RMemory.free(this._hBottom);
this._hBottomR=RMemory.free(this._hBottomR);this._hRight=RMemory.free(this._hRight);this.__base.FUiLayout.dispose.call(this)},MO.FUiPageSheet_innerDump=function(b,d){b.append(d,RClass.dump(this)," [");b.append("name=",this._name,", ");b.append("icon=",this._icon,", ");b.append("label=",this.label,", ");b.append("action=",this.action,"]")};
with(MO)MO.FUiTabBar=function(b){b=RClass.inherits(this,b,FDuiContainer,MUiDescribeFrame);b._sizeCd=EUiSize.Horizontal;b._stylePanel=RClass.register(b,new AStyle("_stylePanel"));b._styleTitlePanel=RClass.register(b,new AStyle("_styleTitlePanel"));b._styleTitleForm=RClass.register(b,new AStyle("_styleTitleForm"));b._styleDataPanel=RClass.register(b,new AStyle("_styleDataPanel"));b._styleDataForm=RClass.register(b,new AStyle("_styleDataForm"));b._styleTop=RClass.register(b,new AStyle("_styleTop"));
b._styleBottom=RClass.register(b,new AStyle("_styleBottom"));b._styleForm=RClass.register(b,new AStyle("_styleForm"));b._buttons=null;b._activeButton=null;b._esize=EUiSize.Both;b._hTop=null;b._hLine=null;b._hBottom=null;b._hSheets=null;b.onBuildPanel=FUiTabBar_onBuildPanel;b.onBuild=FUiTabBar_onBuild;b.oeRefresh=FUiTabBar_oeRefresh;b.construct=FUiTabBar_construct;b.activeButton=FUiTabBar_activeButton;b.appendChild=FUiTabBar_appendChild;b.select=FUiTabBar_select;b.selectByIndex=FUiTabBar_selectByIndex;
b.selectByName=FUiTabBar_selectByName;b.sheet=FUiTabBar_sheet;b.push=FUiTabBar_push;b.dispose=FUiTabBar_dispose;return b},MO.FUiTabBar_onBuildPanel=function(b){(this._hPanel=RBuilder.createTable(b,this.styleName("Panel"))).width="100%"},MO.FUiTabBar_onBuild=function(b){this.__base.FDuiContainer.onBuild.call(this,b);b=RBuilder.appendTableRowCell(this._hPanel,this.styleName("TitlePanel"));b.vAlign="bottom";b=this.hTitleForm=RBuilder.appendTable(b,this.styleName("TitleForm"));b.width="100%";var d=this._hTop=
RBuilder.appendTableRow(b);d.height=1;this._hLine=RBuilder.appendTableRow(b);d=this._hBottom=RBuilder.appendTableRow(b);d.height=1;b=this._hFirstTop=RBuilder.appendTableCell(this._hTop);b.width=20;this._hFirst=RBuilder.appendTableCell(this._hLine);(this._hFirstBottom=RBuilder.appendTableCell(this._hBottom)).className=this.styleName("Bottom",FUiTabButton);this._hLastTop=RBuilder.appendTableCell(this._hTop);this._hLast=RBuilder.appendTableCell(this._hLine);b=this._hLastBottom=RBuilder.appendTableCell(this._hBottom);
b.className=this.styleName("Bottom",FUiTabButton)},MO.FUiTabBar_oeRefresh=function(b){var d=this.__base.FDuiContainer.oeRefresh.call(this,b);b.isBefore()&&this._buttons.count()&&(this._activeButton?this._activeButton.oeRefresh(e):(b=this._activeButton=this._buttons.value(0))&&b.innerSelect(!0));return d},MO.FUiTabBar_construct=function(){this.__base.FDuiContainer.construct.call(this);this._buttons=new TDictionary},MO.FUiTabBar_activeButton=function(){return this._activeButton},MO.FUiTabBar_appendChild=
function(b){if(RClass.isClass(b,FUiTabButton)){var d=this._hLast.cellIndex,f=b._hTopL=RBuilder.appendTableCell(this._hTop,null,d);f.width=1;f.className=b.styleName("Top");f=b._hTop=RBuilder.appendTableCell(this._hTop,null,d+1);f.className=b.styleName("Top");f=b._hTopR=RBuilder.appendTableCell(this._hTop,null,d+2);f.width=1;f.className=b.styleName("Top");f=b._hLeft=RBuilder.appendTableCell(this._hLine,null,d);f.width=1;f.className=b.styleName("Left");f=b._hButtonPanel=RBuilder.appendTableCell(this._hLine,
null,d+1);b.attachEvent("onButtonEnter",f);b.attachEvent("onButtonLeave",f);b.attachEvent("onButtonClick",f);f.width=1;f=b._hButton=RBuilder.append(f,"DIV",b.styleName("Button"));b.icon&&(b._hIcon=RBuilder.appendIcon(f,null,b.icon));b.label&&(b._hText=RBuilder.appendSpan(f,b.styleName("ButtonText")),b._hText.innerText=" "+b.label());f=b._hRight=RBuilder.appendTableCell(this._hLine,null,d+2);f.width=1;f.className=b.styleName("Right");f=b._hBottomL=RBuilder.appendTableCell(this._hBottom,null,d);f.width=
1;f.className=b.styleName("Bottom");f=b._hBottom=RBuilder.appendTableCell(this._hBottom,null,d+1);f.className=b.styleName("Bottom");f=b._hBottomR=RBuilder.appendTableCell(this._hBottom,null,d+2);f.width=1;f.className=b.styleName("Bottom");this.selectByIndex(0)}},MO.FUiTabBar_sheet=function(b){return this._buttons.get(b)},MO.FUiTabBar_select=function(b){var d=this._buttons.count();this._activeButton=b;for(var f=0;f<d;f++){var h=this._buttons.value(f);h!=b&&h.select(!1)}b.select(!0)},MO.FUiTabBar_selectByIndex=
function(b){(b=this._buttons.value(b))&&this.select(b)},MO.FUiTabBar_selectByName=function(b){(b=this.findControl(b))&&this.select(b)},MO.FUiTabBar_push=function(b){if(RClass.isClass(b,FUiTabButton)){var d=this._buttons;b._index=d.count();d.set(b.name(),b)}this.__base.FDuiContainer.push.call(this,b)},MO.FUiTabBar_dispose=function(){this.__base.FDuiContainer.dispose.call(this)};
with(MO)MO.FUiTabButton=function(b){b=RClass.inherits(this,b,FDuiControl,MListenerClick);b._icon=RClass.register(b,new APtyString("_icon"));b._formName=RClass.register(b,new APtyString("_formName"));b._formLink=RClass.register(b,new APtyString("_formLink"));b._formWhere=RClass.register(b,new APtyString("_formWhere"));b._formOrder=RClass.register(b,new APtyString("_formOrder"));b._styleTop=RClass.register(b,new AStyle("_styleTop"));b._styleTopSelect=RClass.register(b,new AStyle("_styleTopSelect"));
b._styleLeft=RClass.register(b,new AStyle("_styleLeft"));b._styleLeftSelect=RClass.register(b,new AStyle("_styleLeftSelect"));b._styleRight=RClass.register(b,new AStyle("_styleRight"));b._styleRightSelect=RClass.register(b,new AStyle("_styleRightSelect"));b._styleRightPrior=RClass.register(b,new AStyle("_styleRightPrior"));b._styleButtom=RClass.register(b,new AStyle("_styleBottom"));b._styleBottomSelect=RClass.register(b,new AStyle("_styleBottomSelect"));b._styleButtonText=RClass.register(b,new AStyle("_styleButtonText"));
b._styleButton=RClass.register(b,new AStyle("_styleButton"));b._styleButtonHover=RClass.register(b,new AStyle("_styleButtonHover"));b._styleButtonSelect=RClass.register(b,new AStyle("_styleButtonSelect"));b._styleDataPanel=RClass.register(b,new AStyle("_styleDataPanel"));b._top=0;b._pages=null;b._index=null;b._selected=!1;b._hasBuilded=!1;b.lsnsSelect=null;b._hTopL=null;b._hTop=null;b._hTopR=null;b._hLeft=null;b._hButton=null;b._hIcon=null;b._hText=null;b._hBottomL=null;b._hBottom=null;b._hBottomR=
null;b._hRight=null;b.onBuildPanel=FUiTabButton_onBuildPanel;b.onButtonEnter=RClass.register(b,new AEventMouseEnter("onButtonEnter"),FUiTabButton_onButtonEnter);b.onButtonLeave=RClass.register(b,new AEventMouseLeave("onButtonLeave"),FUiTabButton_onButtonLeave);b.onButtonClick=RClass.register(b,new AEventClick("onButtonClick"),FUiTabButton_onButtonClick);b.construct=FUiTabButton_construct;b.innerSelect=FUiTabButton_innerSelect;b.select=FUiTabButton_select;b.setVisible=FUiTabButton_setVisible;b.doClick=
FUiTabButton_doClick;b.dispose=FUiTabButton_dispose;b.innerDump=FUiTabButton_innerDump;return b},MO.FUiTabButton_onBuildPanel=function(b){b=this._hContainer=this._hPanel=RBuilder.createDiv(b);b.width="100%";b.height="100%"},MO.FUiTabButton_onButtonEnter=function(b){this._selected||(this._hButton.className=this.styleName("ButtonHover"))},MO.FUiTabButton_onButtonLeave=function(b){this._selected||(this._hButton.className=this.styleName("Button"))},MO.FUiTabButton_onButtonClick=function(b){this.doClick()},
MO.FUiTabButton_construct=function(){this.__base.FDuiControl.construct.call(this);this.lsnsSelect=new TListeners},MO.FUiTabButton_innerSelect=function(b){var d=this._parent;b&&!this._hasBuilded&&(this._hasBuilded=!0);var f=0==this._index,d=d._activeButton._index-1==this._index;this._selected!=b&&(b&&this.lsnsSelect.process(),this._selected=b);this._hButton.className=b?this.styleName("ButtonSelect"):this.styleName("Button");this._hTop.className=b?this.styleName("TopSelect"):this.styleName("Top");this._hLeft.className=
b?this.styleName("LeftSelect"):f?this.styleName("Right"):this.styleName("Left");this._hBottomL.className=b?this.styleName("BottomSelect"):this.styleName("Bottom");this._hBottom.className=b?this.styleName("BottomSelect"):this.styleName("Bottom");this._hBottomR.className=b?this.styleName("BottomSelect"):this.styleName("Bottom");this._hRight.className=b?this.styleName("RightSelect"):d?this.styleName("RightPrior"):this.styleName("Right")},MO.FUiTabButton_select=function(b){this.innerSelect(b);b&&(this.psRefresh(),
this.psResize())},MO.FUiTabButton_setVisible=function(b){RHtml.displaySet(this._hPanel,b)},MO.FUiTabButton_doClick=function(){this._parent.select(this);var b=new SClickEvent(this);this.processClickListener(b);b.dispose()},MO.FUiTabButton_dispose=function(){this._hButton=RMemory.free(this._hButton);this._hTop=RMemory.free(this._hTop);this._hLeft=RMemory.free(this._hLeft);this._hBottomL=RMemory.free(this._hBottomL);this._hBottom=RMemory.free(this._hBottom);this._hBottomR=RMemory.free(this._hBottomR);
this._hRight=RMemory.free(this._hRight);this.__base.FDuiControl.dispose.call(this)},MO.FUiTabButton_innerDump=function(b,d){b.append(d,RClass.dump(this)," [");b.append("name=",this._name,", ");b.append("icon=",this._icon,", ");b.append("label=",this.label,", ");b.append("action=",this.action,"]")};MO.EUiTreeNodeGroup=new function(){this.Container="container";this.Item="item";return this};
with(MO)MO.FUiTreeColumn=function(b){b=RClass.inherits(this,b,FDuiControl);b._icon=RClass.register(b,new APtyString("_icon"));b._dataName=RClass.register(b,new APtyString("_dataName"));b._display=RClass.register(b,new APtyBoolean("_display"),EBoolean.False);b._config=RClass.register(b,new APtyConfig("_config"));b.oeBuild=FUiTreeColumn_oeBuild;b.onBuildPanel=FUiTreeColumn_onBuildPanel;return b},MO.FUiTreeColumn_oeBuild=function(b){this.__base.FDuiControl.oeBuild.call(this,b);b=this.hPanel;b.innerText=
RString.nvl(this.label);b.noWrap=!0;this.display||(b.style.display="block");this.width&&(b.width=this.width);return EEventStatus.Stop},MO.FUiTreeColumn_onBuildPanel=function(){this.hPanel=RBuilder.create(null,"TD")};with(MO)MO.FUiTreeLevel=function(b){b=RClass.inherits(this,b,FDuiControl);b._id=RClass.register(b,new APtyString("_id"));b._color=RClass.register(b,new APtyString("_color"));b._backColor=RClass.register(b,new APtyString("_backColor"));return b};
with(MO)MO.FUiTreeNode=function(b){b=RClass.inherits(this,b,FDuiContainer,MUiDataProperties);b._valid=RClass.register(b,new APtyBoolean("_valid","is_valid"),!0);b._child=RClass.register(b,new APtyBoolean("_child","has_child"),!1);b._typeGroup=RClass.register(b,[new APtyString("_typeGroup"),new AGetSet("_typeGroup")]);b._typeCode=RClass.register(b,[new APtyString("_typeCode"),new AGetter("_typeCode")]);b._code=RClass.register(b,[new APtyString("_code"),new AGetSet("_code")]);b._icon=RClass.register(b,
new APtyString("_icon"));b._checked=RClass.register(b,new APtyBoolean("_checked"),!1);b._extended=RClass.register(b,new APtyBoolean("_extended"),!1);b._note=RClass.register(b,new APtyString("_note"));b._attributes=RClass.register(b,new APtyAttributes("_attributes"));b._styleNormal=RClass.register(b,new AStyle("_styleNormal"));b._styleHover=RClass.register(b,new AStyle("_styleHover"));b._styleSelect=RClass.register(b,new AStyle("_styleSelect"));b._styleImage=RClass.register(b,new AStyle("_styleImage"));
b._styleIcon=RClass.register(b,new AStyle("_styleIcon"));b._styleIconDisable=RClass.register(b,new AStyle("_styleIconDisable"));b._styleLabel=RClass.register(b,new AStyle("_styleLabel"));b._styleCell=RClass.register(b,new AStyle("_styleCell"));b._tree=RClass.register(b,new AGetSet("_tree"));b._level=RClass.register(b,new AGetter("_level"),0);b._nodes=RClass.register(b,new AGetter("_nodes"));b._cells=RClass.register(b,new AGetter("_cells"));b._statusLinked=!1;b._statusDisplay=!0;b._statusSelected=
!1;b._statusLoaded=!1;b._statusHover=!1;b._hNodePanel=null;b._hCheck=null;b._hImage=null;b._hIcon=null;b._hLabel=null;b.onBuildPanel=FUiTreeNode_onBuildPanel;b.onBuild=FUiTreeNode_onBuild;b.onNodeEnter=RClass.register(b,new AEventMouseEnter("onNodeEnter"),FUiTreeNode_onNodeEnter);b.onNodeLeave=RClass.register(b,new AEventMouseLeave("onNodeLeave"),FUiTreeNode_onNodeLeave);b.onNodeClick=RClass.register(b,new AEventClick("onNodeClick"),FUiTreeNode_onNodeClick);b.construct=FUiTreeNode_construct;b.type=
FUiTreeNode_type;b.setTypeCode=FUiTreeNode_setTypeCode;b.setLabel=FUiTreeNode_setLabel;b.setNote=FUiTreeNode_setNote;b.setLevel=FUiTreeNode_setLevel;b.cell=FUiTreeNode_cell;b.check=FUiTreeNode_check;b.setCheck=FUiTreeNode_setCheck;b.setImage=FUiTreeNode_setImage;b.calculateImage=FUiTreeNode_calculateImage;b.setIcon=FUiTreeNode_setIcon;b.get=FUiTreeNode_get;b.set=FUiTreeNode_set;b.isFolder=FUiTreeNode_isFolder;b.hasChild=FUiTreeNode_hasChild;b.topNode=FUiTreeNode_topNode;b.topNodeByType=FUiTreeNode_topNodeByType;
b.nodeCount=FUiTreeNode_nodeCount;b.show=FUiTreeNode_show;b.hide=FUiTreeNode_hide;b.select=FUiTreeNode_select;b.extend=FUiTreeNode_extend;b.extendAll=FUiTreeNode_extendAll;b.searchLast=FUiTreeNode_searchLast;b.createChild=FUiTreeNode_createChild;b.appendChild=FUiTreeNode_appendChild;b.appendNode=FUiTreeNode_appendNode;b.push=FUiTreeNode_push;b.remove=FUiTreeNode_remove;b.removeSelf=FUiTreeNode_removeSelf;b.removeChildren=FUiTreeNode_removeChildren;b.reset=FUiTreeNode_reset;b.click=FUiTreeNode_click;
b.refreshStyle=FUiTreeNode_refreshStyle;b.propertyLoad=FUiTreeNode_propertyLoad;b.propertySave=FUiTreeNode_propertySave;b.loadConfig=FUiTreeNode_loadConfig;b.dispose=FUiTreeNode_dispose;b.innerDump=FUiTreeNode_innerDump;return b},MO.FUiTreeNode_onBuildPanel=function(b){this._hPanel=RBuilder.createTableRow(b,this.styleName("Panel"))},MO.FUiTreeNode_onBuild=function(b){var d=this._tree;this.__base.FDuiContainer.onBuild.call(this,b);var f=this._hPanel;this.attachEvent("onNodeEnter",f,this.onNodeEnter);
this.attachEvent("onNodeLeave",f,this.onNodeLeave);this.attachEvent("onNodeClick",f);f=this._hNodePanel=RBuilder.appendTableCell(f,this.styleName("Normal"));f.noWrap=!0;var h=this._hImage=RBuilder.appendIcon(f,this.styleName("Image"),null,16,16);h._linkType="image";this.setImage();h=this._hIcon=RBuilder.appendIcon(f,null,null,16,16);h._linkType="icon";this.setIcon(this._icon);d.dispChecked&&(h=this._hCheck=RBuilder.appendCheck(f),h.width=13,h.height=13,h.style.borderWidth=0,this.setCheck(this._checked),
d.linkEvent(this,"onNodeCheckClick",h));this._hLabel=RBuilder.appendText(f,this.styleName("Label"));this.setLabel(this._label);if(d=d._nodeColumns)for(f=d.count(),h=0;h<f;h++){var q=d.value(h),w=RClass.create(FUiTreeNodeCell);w._column=q;w.build(b);this.push(w)}},MO.FUiTreeNode_onNodeEnter=function(b){b=this._tree;if(!b._focusNode||b._focusNode&&b._focusNode!=this)this._statusHover=!0,this.refreshStyle(),b.lsnsEnter.process(b,this)},MO.FUiTreeNode_onNodeLeave=function(b){b=this._tree;if(!b._focusNode||
b._focusNode&&b._focusNode!=this)this._statusHover=!1,this.refreshStyle(),b.lsnsLeave.process(b,this)},MO.FUiTreeNode_onNodeClick=function(b){var d=this._tree,f=b.hSender.tagName;if("INPUT"!=f){var h=!1;"IMG"==f&&(h="image"==b.hSender._linkType);b=!1;for(f=d._focusNode;f;){if(f==this){b=!0;break}f=f.parent}h&&(!h||!b&&this._child)||d.selectNode(this,!0);!this._statusLoaded&&this._child?(this.extend(!0),h||d.nodeClick(this)):(this._child&&(this.isFolder()?this.extend(!this._extended):h?this.extend(!this._extended):
this.extend(!0)),(h&&b||h&&!this._child||!h)&&d.nodeClick(this))}},MO.FUiTreeNode_construct=function(){this.__base.FDuiContainer.construct.call(this)},MO.FUiTreeNode_type=function(){var b=this._tree;return RString.isEmpty(this._typeCode)?null:b.findType(this._typeCode)},MO.FUiTreeNode_setTypeCode=function(b){this._typeCode=b;this.setIcon()},MO.FUiTreeNode_setLabel=function(b){this.__base.FDuiContainer.setLabel.call(this,b);if(b=this._hLabel){var d="";RString.isEmpty(this._label)||(d="&nbsp;"+this._label);
RString.isEmpty(this._tag)||(d+="&nbsp;<FONT color=blue>("+this._tag+")</FONT>");RString.isEmpty(this._note)||(d+="&nbsp;<FONT color=green>[ "+this._note+" ]</FONT>");b.innerHTML=d}},MO.FUiTreeNode_setNote=function(b){this._note=RString.empty(b);this.setLabel(this._label)},MO.FUiTreeNode_setLevel=function(b){this._level=b;var d=this._hNodePanel;d&&(d.style.paddingLeft=this._tree._indent*b+"px")},MO.FUiTreeNode_cell=function(b){return this._cells.get(b)},MO.FUiTreeNode_check=function(){return this._checked},
MO.FUiTreeNode_setCheck=function(b){this._checked=b;if(b=this._attributes)b=b.get("checked"),RString.isEmpty(b)||(this._checked=RBoolean.isTrue(b),this._hCheck&&(this._hCheck._checked=this._checked))},MO.FUiTreeNode_setImage=function(){var b=this._tree;this._hImage.src=RResource.iconPath(this._child?b._iconPlus:b._iconNode)},MO.FUiTreeNode_calculateImage=function(){var b=this._tree,d=this._hImage,f=null,f=this.nodeCount()?this._extended?b._iconMinus:b._iconPlus:b._iconNode;d.src=RResource.iconPath(f)},
MO.FUiTreeNode_setIcon=function(b){this._icon=b;var d=this._hIcon;if(d){var f=null;this._icon?f=b:(b=this.type())&&(f=b.icon());f?(RHtml.displaySet(d,!0),d.style.width=16,d.style.height=16,d.className=this._valid?this.styleName("Icon"):this.styleName("IconDisable"),d.src=RResource.iconPath(f)):RHtml.displaySet(d,!1)}},MO.FUiTreeNode_get=function(b){return this._attributes.get(b)},MO.FUiTreeNode_set=function(b,d){this._attributes.set(b,d)},MO.FUiTreeNode_isFolder=function(){return"collections"==this.type().storage()},
MO.FUiTreeNode_hasChild=function(){if(this._child){var b=this._nodes;if(b)return!b.isEmpty()}return!1},MO.FUiTreeNode_topNode=function(){for(var b=this;b._parent;)if(RClass.isClass(b._parent,FUiTreeNode))b=b._parent;else break;return b},MO.FUiTreeNode_topNodeByType=function(b){for(var d=this;d;){if(d._typeCode==b)return d;d=d._parent}return null},MO.FUiTreeNode_nodeCount=function(){var b=this._nodes;return b?b.count():0},MO.FUiTreeNode_show=function(){var b=this._tree;RHtml.visibleSet(this._hPanel,
!0);var d=this._nodes;if(d)for(var f=d.count(),h=0;h<f;h++){var q=d.at(h);q._statusLinked||b.appendNode(q,this);q._statusDisplay&&(RHtml.visibleSet(q._hPanel,!0),q._extended&&q.show())}},MO.FUiTreeNode_hide=function(){this._hPanel&&RHtml.visibleSet(this._hPanel,!1);var b=this._components;if(b)for(var d=b.count(),f=0;f<d;f++){var h=b.value(f);h&&h.hide()}},MO.FUiTreeNode_select=function(b){if(this._statusSelected=b)this._statusHover=!1;this.refreshStyle()},MO.FUiTreeNode_extend=function(b){var d=this._tree;
if(!this._statusLoaded&&this._child){if(d.__loading)return;d.loadNode(this)}else{if(this._hImage&&!this.hasChild())return this._hImage.src=RResource.iconPath(d._iconNode),!1;this._extended=b;this._child&&this._hImage&&(this._hImage.src=RResource.iconPath(b?d._iconMinus:d._iconPlus));var f=this._nodes;if(b)this.show();else if(f)for(b=f.count()-1;0<=b;b--)f.get(b).hide()}d.refresh()},MO.FUiTreeNode_extendAll=function(b){this.extend(b);var d=this._components;if(d)for(var f=d.count(),h=0;h<f;h++)d.value(h).extendAll(b)},
MO.FUiTreeNode_searchLast=function(){var b=this._nodes;if(b)for(var d=b.count()-1;0<=d;d--){var f=b.get(d);if(f._statusLinked)return f.searchLast()}return this},MO.FUiTreeNode_createChild=function(b){var d=null;if(b.isName("Node")||b.isName("TreeNode"))d=RClass.create(FUiTreeNode),d._tree=this._tree;return d},MO.FUiTreeNode_appendChild=function(b){RClass.isClass(b,FUiTreeNodeCell)&&this._hPanel.appendChild(b._hPanel)},MO.FUiTreeNode_appendNode=function(b){var d=this._tree;this.push(b);d.appendNode(b,
this);this.extend(!0)},MO.FUiTreeNode_push=function(b){var d=this._tree;this.__base.FDuiContainer.push.call(this,b);if(RClass.isClass(b,FUiTreeNode)){this._statusLoaded=this._child=!0;var f=this._nodes;f||(f=this._nodes=new TObjects);b._tree=d;b._parent=this;f.push(b);d._allNodes.pushUnique(b)}RClass.isClass(b,FUiTreeNodeCell)&&(f=this._cells,f||(f=this._cells=new TDictionary),b._parent=this,b._tree=d,b._node=this,f.set(b._column._name,b))},MO.FUiTreeNode_remove=function(b){RClass.isClass(b,FUiTreeNode)&&
this._nodes.remove(b);this.__base.FDuiContainer.remove.call(this,b)},MO.FUiTreeNode_removeSelf=function(){var b=this._tree;if(this._statusLinked){this.removeChildren();var d=this._parent;RClass.isClass(d,FUiTreeNode)&&(d.remove(this),d.calculateImage());b.freeNode(this)}},MO.FUiTreeNode_removeChildren=function(){var b=this._nodes;if(b){for(var d=b.count()-1;0<=d;d--){var f=b.get(d);f&&f.removeSelf()}b.clear()}},MO.FUiTreeNode_reset=function(){this._guid=this._typeCode=null;this._valid=!0;this._note=
this._tag=this._icon=null;this._checked=this._child=!1;this._extended=!0;this._statusLinked=!1;this._statusDisplay=!0;this._statusLoaded=this._statusSelected=this._extended=this._statusHover=!1;this._level=0},MO.FUiTreeNode_click=function(){var b=this._tree;b.selectNode(this,!0);b.nodeClick(this)},MO.FUiTreeNode_refreshStyle=function(){var b=this._hPanel.cells,d=b.length;if(this._statusSelected)for(var f=0;f<d;f++)b[f].className=this.styleName("Select");else if(this._statusHover)for(f=0;f<d;f++)b[f].className=
this.styleName("Hover");else for(f=0;f<d;f++)b[f].className=this.styleName("Normal")},MO.FUiTreeNode_propertyLoad=function(b){this.__base.FDuiContainer.propertyLoad.call(this,b);var d=this._attributes;d&&d.append(b.attrs);(b=b.get("attributes"))&&this._attributes.unpack(b)},MO.FUiTreeNode_propertySave=function(b){this.__base.FDuiContainer.propertySave.call(this,b);var d=this.type();b.set("type_code",d._code);b.set("storage",d._storage)},MO.FUiTreeNode_loadConfig=function(b){this.reset();this.propertyLoad(b);
this.setLabel(this._label);this.setCheck(this._checked);this.setImage();this.setIcon(this._icon)},MO.FUiTreeNode_dispose=function(){this._hLabel=this._hCheck=this._hIcon=this._hImage=this._hNodePanel=null;this.__base.FDuiContainer.dispose.call(this)},MO.FUiTreeNode_innerDump=function(b){b.append(RClass.name(this));b.append("[level=",this._level);this._typeCode&&b.append(" type=",this._typeCode.name);b.append(", icon=",this._icon);b.append(", caption=",this._label);b.append(", child=",this._child);
b.append("]")},MO.FUiTreeNode_reload=function(b){b?this._tree.reload():this._tree.reloadNode(this)},MO.FUiTreeNode_reloadParent=function(){this.parentNode?this._tree.reloadNode(this.parentNode):this._tree.reload()},MO.FUiTreeNode_loadQuery=function(b){var d=RString.nvl(b.get("label"),this._label),f=RString.nvl(b.get("note"),this._note),d="&nbsp;"+d;RString.isEmpty(f)||(d+="&nbsp;<FONT color=green>[ "+f+" ]</FONT>");this._hLabel.innerHTML=d;b.contains("visible")&&(this._statusDisplay=RBool.isTrue(b.get("visible")),
this.setVisible(this._statusDisplay))},MO.FUiTreeNode_findByName=function(b){if(this.name==b)return this;var d=this.components;if(d)for(var f=d.count,h=0;h<f;h++){var q=d.value(h);if(q&&(q.name==b||q.components&&(q=q.findByName(b))))return q}return null},MO.FUiTreeNode_findByUuid=function(b){if(this._guid==b)return this;var d=this.components;if(d)for(var f=0;f<d.count;f++){var h=d.value(f);if(h&&(h._guid==b||h.components&&(h=h.findByUuid(b))))return h}return null},MO.FUiTreeNode_pushChanged=function(b){var d=
new TNode;d.attrs=this._attributes;d.attrs&&d.attrs.set("checked",RBoolean.toString(this.check()));b.push(d);if(this.components&&0<this.components.count)for(var d=this.components.count,f=0;f<d;f++){var h=this.components.value(f);RClass.isClass(h,FUiTreeNode)&&h.pushChanged(b)}},MO.FUiTreeNode_checkChanged=function(){return this._checked!=this.check()?!0:!1},MO.FUiTreeNode_getFullPath=function(){var b="";this._label&&(b=this._label);if(this.parent){var d=this.parent.getFullPath();RString.isEmpty(d)||
(b=d+"/"+b)}return b};
with(MO)MO.FUiTreeNodeCell=function(b){b=RClass.inherits(this,b,FDuiControl,MListenerClick,MListenerDoubleClick);b._stylePanel=RClass.register(b,new AStyle("_stylePanel"));b._styleCell=RClass.register(b,new AStyle("_styleCell","Cell"));b._tree=null;b._column=null;b._level=0;b._node=null;b._hImage=null;b._hIcon=null;b._hLabel=null;b.onBuildPanel=FUiTreeNodeCell_onBuildPanel;b.onBuild=FUiTreeNodeCell_onBuild;b.onClick=RClass.register(b,new AEventClick("onClick"),FUiTreeNodeCell_onClick);b.onDoubleClick=
RClass.register(b,new AEventDoubleClick("onDoubleClick"),FUiTreeNodeCell_onDoubleClick);b.construct=FUiTreeNodeCell_construct;b.icon=FUiTreeNodeCell_icon;b.setIcon=FUiTreeNodeCell_setIcon;b.get=FUiTreeNodeCell_get;b.set=FUiTreeNodeCell_set;return b},MO.FUiTreeNodeCell_onBuildPanel=function(b){this._hPanel=RBuilder.createTableCell(b,this.styleName("Panel"))},MO.FUiTreeNodeCell_onBuild=function(b){this.__base.FDuiControl.onBuild.call(this,b);b=this._hPanel;this.attachEvent("onClick",b);this.attachEvent("onDoubleClick",
b)},MO.FUiTreeNodeCell_onClick=function(b){b.treeNode=this._node;b.treeColumn=this._column;b.treeNodeCell=this;this.processClickListener(b)},MO.FUiTreeNodeCell_onDoubleClick=function(b){b.treeNode=this._node;b.treeColumn=this._column;b.treeNodeCell=this;this.processDoubleClickListener(b)},MO.FUiTreeNodeCell_construct=function(){this.__base.FDuiControl.construct.call(this);this._attributes=new TAttributes},MO.FUiTreeNodeCell_icon=function(){return o._icon},MO.FUiTreeNodeCell_setIcon=function(b){var d=
this._hIcon;d||(d=this._hIcon=RBuilder.appendIcon(this._hPanel,null,null,16,16));d.src=RResource.iconPath(b)},MO.FUiTreeNodeCell_get=function(){},MO.FUiTreeNodeCell_set=function(b){};
with(MO)MO.FUiTreeNodeType=function(b){b=RClass.inherits(this,b,FDuiComponent);b._code=RClass.register(b,[new APtyString("_code"),new AGetSet("_code")]);b._storage=RClass.register(b,[new APtyString("_storage"),new AGetSet("_storage")]);b._icon=RClass.register(b,[new APtyString("_icon"),new AGetSet("_icon")]);b._service=RClass.register(b,[new APtyString("_service"),new AGetSet("_service")]);b._action=RClass.register(b,[new APtyString("_action"),new AGetSet("_action")]);b._attributes=RClass.register(b,
[new APtyAttributes("_attributes"),AGetter("_attributes")]);b.construct=FUiTreeNodeType_construct;b.get=FUiTreeNodeType_get;b.set=FUiTreeNodeType_set;b.innerDump=FUiTreeNodeType_innerDump;return b},MO.FUiTreeNodeType_construct=function(){this.__base.FDuiComponent.construct.call(this)},MO.FUiTreeNodeType_get=function(b){var d=this._attributes;return d?d.get(b):null},MO.FUiTreeNodeType_set=function(b,d){var f=this._attributes;f&&f.set(b,d)},MO.FUiTreeNodeType_innerDump=function(b){b.append(RClass.dump(this));
b.append("[code=",this._code);b.append(", icon=",this._icon);b.append(", service=",this._service);b.append(", action=",this._action);b.append("]")};
with(MO)MO.FUiTreeView=function(b){b=RClass.inherits(this,b,FDuiContainer);b._optionCheck=RClass.register(b,new APtyBoolean("_optionCheck"),!1);b._indent=RClass.register(b,new APtyInteger("_indent"),16);b._stylePanel=RClass.register(b,new AStyle("_stylePanel","Panel"));b._styleNodePanel=RClass.register(b,new AStyle("_styleNodePanel","NodePanel"));b._styleNodeForm=RClass.register(b,new AStyle("_styleNodeForm","NodeForm"));b._attributes=null;b._nodeTypes=null;b._nodeColumns=null;b._nodeLevels=null;
b._nodes=null;b._allNodes=null;b._defaultNodeType=null;b._focusNode=null;b._loadingNode=null;b._freeNodes=null;b._iconPlus="control.treeview.plus";b._iconMinus="control.treeview.minus";b._iconNode="control.treeview.node";b._iconLoading="control.treeview.loading";b._hNodePanel=null;b._hNodeForm=null;b._hHeadLine=null;b._hNodeRows=null;b.lsnsEnter=new TListeners;b.lsnsLeave=new TListeners;b._listenersNodeClick=RClass.register(b,new AListener("_listenersNodeClick",EEvent.NodeClick));b.onBuildPanel=FUiTreeView_onBuildPanel;
b.onBuild=FUiTreeView_onBuild;b.onNodeClick=FUiTreeView_onNodeClick;b.onClick=RClass.register(b,new AEventClick("onClick"),FUiTreeView_onClick);b.onNodeCheckClick=RClass.register(b,new AEventClick("onNodeCheckClick"),FUiTreeView_onNodeCheckClick);b.construct=FUiTreeView_construct;b.attributes=FUiTreeView_attributes;b.nodeTypes=FUiTreeView_nodeTypes;b.nodeColumns=FUiTreeView_nodeColumns;b.nodeLevels=FUiTreeView_nodeLevels;b.hasNode=FUiTreeView_hasNode;b.focusNode=FUiTreeView_focusNode;b.nodes=FUiTreeView_nodes;
b.findType=FUiTreeView_findType;b.findByName=FUiTreeView_findByName;b.findByGuid=FUiTreeView_findByGuid;b.createChild=FUiTreeView_createChild;b.createNode=FUiTreeView_createNode;b.appendChild=FUiTreeView_appendChild;b.appendNode=FUiTreeView_appendNode;b.appendNodes=FUiTreeView_appendNodes;b.selectNode=FUiTreeView_selectNode;b.push=FUiTreeView_push;b.removeNode=FUiTreeView_removeNode;b.removeNodes=FUiTreeView_removeNodes;b.freeNode=FUiTreeView_freeNode;b.clearNodes=FUiTreeView_clearNodes;b.nodeClick=
FUiTreeView_nodeClick;b.calculateHeight=FUiTreeView_calculateHeight;b.fetchChangedChecks=FUiTreeView_fetchChangedChecks;b.extendAuto=FUiTreeView_extendAuto;b.extendAll=FUiTreeView_extendAll;b.loadNode=RMethod.empty;b.refresh=FUiTreeView_refresh;b.filterNode=FUiTreeView_filterNode;b.clearAllNodes=FUiTreeView_clearAllNodes;b.clear=FUiTreeView_clear;b.dispose=FUiTreeView_dispose;return b},MO.FUiTreeView_onBuildPanel=function(b){this._hPanel=RBuilder.createTable(b.hDocument,this.styleName("Panel"))},
MO.FUiTreeView_onBuild=function(b){this.__base.FDuiContainer.onBuild.call(this,b);this.attachEvent("onClick",this._hPanel);var d=RBuilder.appendTableRow(this._hPanel),d=RBuilder.appendTableCell(d),d=this._hNodePanel=RBuilder.appendDiv(d,this.styleName("NodePanel")),d=this._hNodeForm=RBuilder.appendTable(d,this.styleName("NodeForm"));d.width="100%";this._hHeadLine=RBuilder.appendTableRow(d);this._hNodeRows=d.children[0];d=this._loadingNode=RClass.create(FUiTreeNode);d._tree=this;d._label=RContext.get("FUiTreeView:loading");
d._icon=this._iconLoading;d.build(b);b=this._nodes;if(!b.isEmpty())for(var d=b.count(),f=0;f<d;f++)this.appendNode(b.get(f));this.extendAuto()},MO.FUiTreeView_onNodeClick=function(b){},MO.FUiTreeView_onClick=function(b,d){if(b.hSender==this._hNodePanel){var f=this._focusNode;f&&(f.select(!1),this._focusNode=null)}},MO.FUiTreeView_onNodeCheckClick=function(b,d){if(b&&RClass.isClass(b,FUiTreeNode)){var f=b.check(),h=b.controls;if(h)for(var q=0;q<h.count;q++){var w=h.value(q);w&&RClass.isClass(w,FUiTreeNode)&&
w.setCheck(f)}for(h=b.parentNode;h;){if(f)h.setCheck(f);else{for(var w=h.controls,z=w.count,q=0;q<z;q++){var A=w.value(q);if(A&&RClass.isClass(A,FUiTreeNode)&&A.check())return}h.setCheck(!1)}h=h.parentNode}}},MO.FUiTreeView_construct=function(){this.__base.FDuiContainer.construct.call(this);this._attributes=new TAttributes;this._nodeTypes=new TDictionary;this._nodeColumns=new TDictionary;this._nodeLevels=new TDictionary;this._nodes=new TObjects;this._allNodes=new TObjects;this._freeNodes=new TObjects;
this._defaultNodeType=RClass.create(FUiTreeNodeType)},MO.FUiTreeView_attributes=function(){return this._attributes},MO.FUiTreeView_nodeTypes=function(){return this._nodeTypes},MO.FUiTreeView_nodeColumns=function(){return this._nodeColumns},MO.FUiTreeView_nodeLevels=function(){return this._nodeLevels},MO.FUiTreeView_hasNode=function(){return this._rootNode.hasChild()},MO.FUiTreeView_focusNode=function(){return this._focusNode},MO.FUiTreeView_nodes=function(){return this._nodes},MO.FUiTreeView_findType=
function(b){return this._nodeTypes.get(b)},MO.FUiTreeView_findByName=function(b){var d=this._allNodes,f=d.count();if(f)for(var h=0;h<f;h++){var q=d.get(h);if(q._name==b)return q}},MO.FUiTreeView_findByGuid=function(b){var d=this._allNodes,f=d.count();if(f)for(var h=0;h<f;h++){var q=d.getAt(h);if(q._guid==b)return q}},MO.FUiTreeView_createChild=function(b){var d=null;switch(b.name()){case "TreeColumn":d=RClass.create(FUiTreeColumn);break;case "TreeLevel":d=RClass.create(FUiTreeLevel);break;case "TreeNodeType":d=
RClass.create(FUiTreeNodeType);break;case "TreeNode":d=RClass.create(FUiTreeNode);break;default:throw new TError(this,"Unknown child type. (config={1})",b.xml());}d._tree=this;return d},MO.FUiTreeView_appendChild=function(b){},MO.FUiTreeView_createNode=function(){var b=this._freeNodes.pop();b||(b=RClass.create(FUiTreeNode),b._tree=this,b.build(this._hPanel));RHtml.visibleSet(b._hPanel,!0);this._allNodes.push(b);return b},MO.FUiTreeView_appendNode=function(b,d){if(!b._statusLinked){var f=b._hPanel;
if(d){var h=d.searchLast()._hPanel.rowIndex;f.parentElement?(f.rowIndex>h&&h++,RHtml.tableMoveRow(this._hNodeForm,f.rowIndex,h)):(this._hNodeRows.appendChild(f),RHtml.tableMoveRow(this._hNodeForm,f.rowIndex,h+1));b.setLevel(d._level+1)}else this._hNodeRows.appendChild(f),b.setLevel(0);b._statusLinked=!0}},MO.FUiTreeView_appendNodes=function(b,d){b=RObject.nvl(b,this.workNode,this.rootNode);if(d&&d._nodes){var f=d._nodes.count;if(0<f){b.child=!0;b.loaded=!0;for(var h=0;h<f;h++){var q=d._nodes.get(h);
if(q&&(q.isName("Node")||q.isName("TreeNode"))){var w=RClass.create(FUiTreeNode);w.parent=b;w._tree=this;w.loadConfig(q);w.icon=q._nodes?"ctl.FBrowser_Folder":"ctl.FBrowser_Txt";w.build(0);w.hide();q._nodes&&this.tempAppendNodes(w,q);b.push(w);this._allNodes.push(w)}}}}this.rootNode.extend(!0)},MO.FUiTreeView_selectNode=function(b,d){var f=this._focusNode;if(d){if(b){if(f){if(f==b)return;b.isFolder()?f.select(!0):f.select(!1)}b.isFolder()||(b.select(!0),this._focusNode=b)}}else b&&b.select(!1),f&&
f.select(!1)},MO.FUiTreeView_push=function(b){this.__base.FDuiContainer.push.call(this,b);b._tree=this;RClass.isClass(b,FUiTreeColumn)?this._nodeColumns.set(b.name(),b):RClass.isClass(b,FUiTreeLevel)?this._nodeLevels.set(b.id(),b):RClass.isClass(b,FUiTreeNodeType)?this._nodeTypes.set(b.code(),b):RClass.isClass(b,FUiTreeNode)&&(this._nodes.push(b),this._allNodes.push(b),this.appendNode(b))},MO.FUiTreeView_removeNode=function(b){if(b){for(var d=[],f=null,h=this._allNodes.length,q=0;q<h;q++)f=this._allNodes[q],
f!=b&&(d[d.length]=f);this._allNodes=d;var w=b.parent;if(w){d=[];h=w._nodes.length;for(q=0;q<h;q++)f=w._nodes[q],f!=b&&(d[d.length]=f);w._nodes=d;b.parent.childrenHTML.removeChild(b.ownerHTML)}0==w._nodes.length&&(w.imageHTML.src=this.imgEmpty);return!0}return!1},MO.FUiTreeView_removeNodes=function(b){b=RObject.nvl(b,this.workNode,this.rootNode);b.hasChild()&&b.removeChildren();b.remove()},MO.FUiTreeView_freeNode=function(b){if(b._statusLinked){b._statusLinked=!1;this._hNodeRows.removeChild(b._hPanel);
var d=b.cells();if(d)for(var f=d.count(),h=0;h<f;h++)d.at(h).clearAllListeners();this._allNodes.remove(b);this._freeNodes.push(b)}},MO.FUiTreeView_clearNodes=function(b){b&&b.removeChildren();b=[];for(var d=null,f=this._allNodes.length,h=0;h<f;h++)d=this._allNodes[h],d.parent!=oNode?b[b.length]=d:oNode.childrenHTML.removeChild(d.ownerHTML);oNode.imageHTML.src=this.imgEmpty;this._allNodes=b;return!0},MO.FUiTreeView_nodeClick=function(b){var d=new SEvent;d.tree=this;d.node=b;this.onNodeClick(d);this.processNodeClickListener(d);
d.dispose()},MO.FUiTreeView_calculateHeight=function(){for(var b=this._allNodes,d=b.count(),f=0;f<d;f++){var h=b.get(f);RHtml.displayGet(h._hPanel)&&d++}return 29*d},MO.FUiTreeView_fetchChangedChecks=function(){var b=new TNode("TreeView");b.set("name",this.name);for(var d=RObject.nvl(this.rootNode,this).controls,f=0;f<d.count;f++)d.value(f).pushChanged(b);return b},MO.FUiTreeView_extendAuto=function(b){if(b=b?b._nodes:this._nodes){var d=b.count;if(d)for(var f=0;f<d;f++){var h=b.get(f);h.extend(h._extended);
h._extended&&this.extendAuto(h)}}},MO.FUiTreeView_extendAll=function(b,d){var f=b?b._nodes:this._nodes;if(f){var h=f.count();if(h)for(var q=0;q<h;q++){var w=f.get(q);w.extend(d);this.extendAll(w,d)}}},MO.FUiTreeView_refresh=function(){this.parentObj&&(this.parentObj.style.height=this.calculateHeight())},MO.FUiTreeView_filterNode=function(b,d){var f=this._allNodes.count(),h=null,q=null;if(b){label=label.toLowerCase();var w=null,z=0;d&&(d=d.toLowerCase(),w=d.split("|"),z=w.length);for(B=0;B<f;B++)if(C=
this._allNodes.get(B),!C.isDelete)if(h=C.label.toLowerCase(),w)for(var q=C.linkAttr.toLowerCase(),A=0;A<z;A++){if(-1!=q.indexOf(w[A])){C.show(-1!=h.indexOf(label));break}}else C.show(-1!=h.indexOf(label))}else for(var B=0;B<f;B++){var C=this._allNodes.get(B);C.isDelete||C.show(!0)}},MO.FUiTreeView_clearAllNodes=function(){var b=this._nodes;if(b){for(var d=b.count()-1;0<=d;d--)b.get(d).removeSelf();b.clear()}this._allNodes.clear()},MO.FUiTreeView_clear=function(){this.clearAllNodes()},MO.FUiTreeView_dispose=
function(){this.__base.FDuiContainer.dispose.call(this);var b=this._nodes;b&&(b.dispose(),this._nodes=null);if(b=this._allNodes)b.dispose(),this._allNodes=null;this._hHeadLine=this._hNodeForm=this._hNodePanel=null;return!0};MO.FUiDialog=function(b){b=MO.Class.inherits(this,b,MO.FUiWindow,MO.MUiDescribeFrame);b.construct=MO.FUiDialog_construct;return b};MO.FUiDialog_construct=function(){this.__base.FUiWindow.construct.call(this)};
MO.FUiFramePage=function(b){b=MO.Class.inherits(this,b,MO.FDuiContainer);b._styleContainer=MO.Class.register(b,new MO.AStyle("_styleContainer"));b._hContainer=null;b.onBuildPanel=MO.FUiFramePage_onBuildPanel;b.onBuild=MO.FUiFramePage_onBuild;b.oeResize=MO.FUiFramePage_oeResize;b.appendChild=MO.FUiFramePage_appendChild;b.removeChild=MO.FUiFramePage_removeChild;return b};
MO.FUiFramePage_onBuildPanel=function(b){b=this._hPanel=MO.Window.Builder.createTableCell(b,this.styleName("Panel"));b.vAlign="top";b.height="100%"};MO.FUiFramePage_onBuild=function(b){this.__base.FDuiContainer.onBuild.call(this,b);b=this._hPanel;this._scrollCd!=MO.EUiScroll.None?(b=this._hContainer=MO.Window.Builder.appendDiv(b,this.styleName("Container")),MO.RUiControl.setStyleScroll(b,this._scrollCd)):this._hContainer=b};
MO.FUiFramePage_oeResize=function(b){b=this._parent;if(b._directionCd!=MO.EUiDirection.Horizontal&&b._directionCd!=MO.EUiDirection.Vertical)throw new MO.TError(this,"Unknown direcion type. (direction_cd={1})",this._directionCd);return MO.EEventStatus.Continue};MO.FUiFramePage_appendChild=function(b){b._hPanel&&this._hContainer.appendChild(b._hPanel)};MO.FUiFramePage_removeChild=function(b){this._hContainer.removeChild(b._hPanel)};
MO.FUiFrameSet=function(b){b=MO.Class.inherits(this,b,MO.FDuiContainer,MO.MUiDescribeFrame);b._sizeCd=MO.EUiSize.Fill;b._directionCd=MO.Class.register(b,new MO.APtyEnum("_directionCd",null,MO.EUiDirection),MO.EUiDirection.Vertical);b._stylePanel=MO.Class.register(b,new MO.AStyle("_stylePanel"));b._frames=null;b._hLine=null;b.onBuildPanel=MO.FUiFrameSet_onBuildPanel;b.construct=MO.FUiFrameSet_construct;b.appendFrame=MO.FUiFrameSet_appendFrame;b.appendSpliter=MO.FUiFrameSet_appendSpliter;b.appendChild=
MO.FUiFrameSet_appendChild;b.dispose=MO.FUiFrameSet_dispose;return b};MO.FUiFrameSet_onBuildPanel=function(b){this._hPanel=MO.Window.Builder.createTable(b,this.styleName("Panel"))};MO.FUiFrameSet_construct=function(){this.__base.FDuiContainer.construct.call(this);this._frames=new MO.TObjects};
MO.FUiFrameSet_appendFrame=function(b){if(this._directionCd==MO.EUiDirection.Horizontal){var d=this._hLine;d||(d=this._hLine=MO.Window.Builder.appendTableRow(this._hPanel));b.setPanel(d);if(d=b._size.width)b._hPanel.width=d}else if(this._directionCd==MO.EUiDirection.Vertical){if(d=MO.Window.Builder.appendTableRow(this._hPanel),b.setPanel(d),d=b._size.height)b._hPanel.height=d}else throw new MO.TError(this,"Unknown direcion type. (direction_cd={1})",this._directionCd);this._frames.push(b)};
MO.FUiFrameSet_appendSpliter=function(b){var d=null;b?d=b:(d=MO.Class.create(MO.FUiFrameSpliter),d.build(this._hPanel));if(this._directionCd==MO.EUiDirection.Horizontal)this._hLine.appendChild(d._hPanel),d._hPanel.style.width="4px";else if(this._directionCd==MO.EUiDirection.Vertical)MO.Window.Builder.appendTableRow(this._hPanel).appendChild(d._hPanel),d._hPanel.style.height="4px";else throw new MO.TError(this,"Unknown direcion type. (direction_cd={1})",this._directionCd);this._frames.push(d);return d};
MO.FUiFrameSet_appendChild=function(b){b._frameset=this;MO.Class.isClass(b,MO.FUiFramePage)?this.appendFrame(b):MO.Class.isClass(b,MO.FUiFrameSpliter)?this.appendSpliter(b):this.__base.FDuiContainer.appendChild.call(this,b)};MO.FUiFrameSet_dispose=function(){this.__base.FDuiContainer.dispose.call(this)};
MO.FUiFrameSpliter=function(b){b=MO.Class.inherits(this,b,MO.FDuiControl,MO.MUiDragable);b._styleNormal=MO.Class.register(b,new MO.AStyle("_styleNormal","Normal"));b._styleHover=MO.Class.register(b,new MO.AStyle("_styleHover","Hover"));b._styleDraging=MO.Class.register(b,new MO.AStyle("_styleDraging","Draging"));b._directionCd=MO.EUiDirection.Horizontal;b._alignCd=MO.EUiAlign.Left;b._dragClientX=0;b._dragClientY=0;b._dragPanelX=0;b._dragPanelY=0;b._dragSizeX=0;b._dragSizeY=0;b._sizeMin=40;b._hDrag=
null;b._hSize=null;b._hIcon=null;b.onBuildPanel=MO.FUiFrameSpliter_onBuildPanel;b.onBuild=MO.FUiFrameSpliter_onBuild;b.onMouseEnter=MO.Class.register(b,new MO.AEventMouseEnter("onMouseEnter"),MO.FUiFrameSpliter_onMouseEnter);b.onMouseLeave=MO.Class.register(b,new MO.AEventMouseLeave("onMouseLeave"),MO.FUiFrameSpliter_onMouseLeave);b.onDoubleClick=MO.Class.register(b,new MO.AEventDoubleClick("onDoubleClick"),MO.FUiFrameSpliter_onDoubleClick);b.onDragStart=MO.FUiFrameSpliter_onDragStart;b.onDragMove=
MO.FUiFrameSpliter_onDragMove;b.onDragStop=MO.FUiFrameSpliter_onDragStop;b.construct=MO.FUiFrameSpliter_construct;b.alignCd=MO.FUiFrameSpliter_alignCd;b.setAlignCd=MO.FUiFrameSpliter_setAlignCd;b.sizeHtml=MO.FUiFrameSpliter_sizeHtml;b.setSizeHtml=MO.FUiFrameSpliter_setSizeHtml;b.changeVisible=MO.FUiFrameSpliter_changeVisible;b.dispose=MO.FUiFrameSpliter_dispose;return b};MO.FUiFrameSpliter_onBuildPanel=function(b){this._hPanel=MO.Window.Builder.createTableCell(b,this.styleName("Normal"))};
MO.FUiFrameSpliter_onBuild=function(b){this.__base.FDuiControl.onBuild.call(this,b);var d=this._hPanel;d.style.zIndex=MO.EUiLayer.Drap;d.__linker=this;b=this._hDrag=MO.Window.Builder.createDiv(b,this.styleName("Draging"));b.__linker=this;b.style.position="absolute";MO.Window.Html.displaySet(b,!1);d.appendChild(b);d.style.cursor="e-resize";d._plinker=this;this.attachEvent("onMouseEnter",d,this.onMouseEnter);this.attachEvent("onMouseLeave",d,this.onMouseLeave);this.attachEvent("onDoubleClick",d);this._hIcon=
MO.Window.Builder.appendIcon(d,null,"control.FSpliter_Left");MO.Console.find(MO.FDragConsole).register(this)};MO.FUiFrameSpliter_onMouseEnter=function(b){this._hPanel.className=this.styleName("Hover")};MO.FUiFrameSpliter_onMouseLeave=function(b){this._hPanel.className=this.styleName("Normal")};MO.FUiFrameSpliter_onDoubleClick=function(b){this.changeVisible()};
MO.FUiFrameSpliter_onDragStart=function(b){var d=this._hPanel,f=this._hDrag,h=f.style;if(this._directionCd==MO.EUiDirection.Horizontal)this._dragClientX=b.clientX,this._dragPanelX=MO.Window.Html.clientX(d),this._dragSizeX=this._hSize.offsetWidth,h.cursor=MO.EMouseCursor.HSize;else if(this._directionCd==MO.EUiDirection.Vertical)this._dragClientY=b.clientY,this._dragPanelY=MO.Window.Html.clientY(d),this._sizeY=this._hSize.offsetHeight,h.cursor=MO.EMouseCursor.VSize;else throw new MO.TError(this,"Unknown direction type. (direction_cd={1})",
this._directionCd);h.left=MO.Window.Html.clientX(d)+"px";h.top=MO.Window.Html.clientY(d)+"px";h.width=d.offsetWidth+"px";h.height=d.offsetHeight+"px";MO.Window.Html.visibleSet(f,!0);MO.Window.setOptionSelect(!1);MO.Window.disable()};
MO.FUiFrameSpliter_onDragMove=function(b){var d=this._hDrag;if(this._directionCd==MO.EUiDirection.Horizontal)b=this._dragPanelX+(b.clientX-this._dragClientX),b>this._sizeMin&&(d.style.left=b+"px");else if(this._directionCd==MO.EUiDirection.Vertical)b=this._dragPanelY+(b.clientY-this._dragClientY),b>this._sizeMin&&(d.style.top=b+"px");else throw new MO.TError(this,"Unknown direction type. (direction_cd={1})",this._directionCd);};
MO.FUiFrameSpliter_onDragStop=function(b){var d=this._hDrag;if(this._directionCd==MO.EUiDirection.Horizontal){b=b.clientX-this._dragClientX;var f=0;if(this._alignCd===MO.EUiAlign.Left)f=this._dragSizeX+b;else if(this._alignCd===MO.EUiAlign.Right)f=this._dragSizeX-b;else throw new MO.TError(this,"Unknown align type. (align_cd={1})",this._alignCd);f>this._sizeMin&&(this._hSize.style.width=f+"px")}else if(this._directionCd==MO.EUiDirection.Vertical){b=b.clientY-this._dragClientY;f=this._dragSizeY+b;
if(this._alignCd===MO.EUiAlign.Top)f=this._dragSizeY+b;else if(this._alignCd===MO.EUiAlign.Bottom)f=this._dragSizeY-b;else throw new MO.TError(this,"Unknown align type. (align_cd={1})",this._alignCd);f>this._sizeMin&&(this._hSize.style.width=f+"px")}else throw new MO.TError(this,"Unknown direction type. (direction_cd={1})",this._directionCd);MO.Window.Html.visibleSet(d,!1);MO.Window.enable();MO.Window.setOptionSelect(!0)};MO.FUiFrameSpliter_construct=function(){this.__base.FDuiControl.construct.call(this)};
MO.FUiFrameSpliter_alignCd=function(){return this._alignCd};MO.FUiFrameSpliter_setAlignCd=function(b){if(b==MO.EUiAlign.Left)this._hIcon.src=MO.RResource.iconPath("control.FSpliter_Left");else if(b==MO.EUiAlign.Right)this._hIcon.src=MO.RResource.iconPath("control.FSpliter_Right");else throw new MO.TError(this,"Align type is invalid.");this._alignCd=b};MO.FUiFrameSpliter_sizeHtml=function(){return this._hSize};MO.FUiFrameSpliter_setSizeHtml=function(b){this._hSize=b};
MO.FUiFrameSpliter_changeVisible=function(){var b=this._hSize;if(b){var d=null;MO.Window.Html.visibleGet(b)?(MO.Window.Html.visibleSet(b,!1),this._alignCd==MO.EUiAlign.Left?d=MO.EUiAlign.Right:this._alignCd==MO.EUiAlign.Right&&(d=MO.EUiAlign.Left)):(RHtml.visibleSet(b,!0),this._alignCd==MO.EUiAlign.Left?d=MO.EUiAlign.Left:this._alignCd==MO.EUiAlign.Right&&(d=MO.EUiAlign.Right));d==MO.EUiAlign.Left?this._hIcon.src=MO.RResource.iconPath("control.FSpliter_Left"):d==MO.EUiAlign.Right&&(this._hIcon.src=
MO.RResource.iconPath("control.FSpliter_Right"));MO.Console.find(MO.FDuiWorkspaceConsole).resize()}};MO.FUiFrameSpliter_dispose=function(){this._hDrag=MO.Window.Html.free(this._hDrag);this._hSize=MO.Window.Html.free(this._hSize);this.__base.FDuiControl.dispose.call(this)};
MO.FUiWindow=function(b){b=MO.Class.inherits(this,b,MO.FUiLayout,MO.MMouseCapture);b._statusVisible=!1;b._stylePanel=MO.Class.register(b,new MO.AStyle("_stylePanel"));b._styleBodyForm=MO.Class.register(b,new MO.AStyle("_styleBodyForm"));b._styleTitleForm=MO.Class.register(b,new MO.AStyle("_styleTitleForm"));b._styleTitlePanel=MO.Class.register(b,new MO.AStyle("_styleTitlePanel"));b._styleBodyPanel=MO.Class.register(b,new MO.AStyle("_styleBodyPanel"));b._styleStatusPanel=MO.Class.register(b,new MO.AStyle("_styleStatusPanel"));
b._mousePosition=null;b._mouseControl=null;b.onBuildPanel=MO.FUiWindow_onBuildPanel;b.onBuild=MO.FUiWindow_onBuild;b.onMouseCaptureStart=MO.FUiWindow_onMouseCaptureStart;b.onMouseCapture=MO.FUiWindow_onMouseCapture;b.onMouseCaptureStop=MO.FUiWindow_onMouseCaptureStop;b.construct=MO.FUiWindow_construct;b.setVisible=MO.FUiWindow_setVisible;b.setLabel=MO.FUiWindow_setLabel;b.showPosition=MO.FUiWindow_showPosition;return b};
MO.FUiWindow_onBuildPanel=function(b){this._hPanel=MO.Window.Builder.createDiv(b,this.styleName("Panel"));b=this._hPanelForm=MO.Window.Builder.createTable(b,this.styleName("Form"),null,0,1);b.style.width="100%";b.style.height="100%"};
MO.FUiWindow_onBuild=function(b){this.__base.FUiLayout.onBuild.call(this,b);var d=this._hBodyForm=MO.Window.Builder.appendTable(this._hPanel,this.styleName("BodyForm")),f=this._hTitlePanel=MO.Window.Builder.appendTableRowCell(d,this.styleName("TitlePanel"));f.__linker=this;b=this._hBodyPanel=MO.Window.Builder.appendTableRowCell(d,this.styleName("BodyPanel"));b.vAlign="top";this._hStatusPanel=MO.Window.Builder.appendTableRowCell(d,this.styleName("StatusPanel"));d=this._hTitleForm=MO.Window.Builder.appendTable(f,
this.styleName("TitleForm"));d=MO.Window.Builder.appendTableRow(d);f=this._hTitle=MO.Window.Builder.appendTableCell(d);f.align="center";MO.Window.Html.textSet(f,this._label);MO.Window.Builder.appendTableCell(d).width=20;b.appendChild(this._hPanelForm);this.refreshSize()};MO.FUiWindow_onMouseCaptureStart=function(b){this._mouseDraging=!0;this._mousePosition.set(b.x,b.y);this._mouseControl.set(this._hPanel.offsetLeft,this._hPanel.offsetTop);MO.Window.Html.cursorSet(this._hPanel,EUiCursor.Move)};
MO.FUiWindow_onMouseCapture=function(b){if(this._mouseDraging){var d=b.y-this._mousePosition.y;this._hPanel.style.left=this._mouseControl.x+(b.x-this._mousePosition.x)+"px";this._hPanel.style.top=this._mouseControl.y+d+"px"}};MO.FUiWindow_onMouseCaptureStop=function(b){this._mouseDraging=!1;RHtml.cursorSet(this._hPanel,EUiCursor.Auto)};MO.FUiWindow_construct=function(){this.__base.FUiLayout.construct.call(this);this._mousePosition=new SPoint2;this._mouseControl=new SPoint2;RConsole.find(FMouseConsole).register(this)};
MO.FUiWindow_setVisible=function(b){this._statusVisible=b;var d=this.panel(EPanel.Container);b?RWindow._hContainer.appendChild(d):RWindow._hContainer.removeChild(d)};MO.FUiWindow_setLabel=function(b){this.__base.FUiLayout.setLabel.call(this,b);RHtml.textSet(this._hTitle,this._label)};
MO.FUiWindow_showPosition=function(b){this.show();b==EUiPosition.Center&&(b=(window.document.body.offsetHeight-this._hPanel.offsetHeight)/2,this._hPanel.style.left=(window.document.body.offsetWidth-this._hPanel.offsetWidth)/2+"px",this._hPanel.style.top=b+"px")};MO.FUiWindow_doFocus=function(){if(this.searchControls&&0<this.searchControls.count)for(var b=this.searchControls,d=0;d<b.count;d++){var f=this.searchControls.get(0);RClass.isClass(f,MEditValue)&&f.focus()}};
MO.FUiWindow_oeVisible=function(b){this.__base.FUiLayout.oeVisible.call(this,b);b.isAfter()&&(this.hPanel.style.zIndex=RLayer.next(ELayer.Window),this.hPanel.style.display="block")};MO.FUiWindow_panel=function(b){return EPanel.Display==b||EPanel._border==b||EPanel.Size==b?this.hPanel:EPanel.Move==b?this.hTitleForm:this.__base.FUiLayout.panel.call(this,b)};
MO.FUiWindow_dump=function(b,d){var f;b||(b=this);d||(d="   ");f=""+(b.className+"\n");if(b.children)for(var h=b.children,q=0;q<h.length;q++)f+=d+this.dump(h[q],d+"   ");return f};MO.FUiWindow_pushAllControl=function(b){this.allControls||(this.allControls=[]);this.allControls.push(b)};MO.FUiWindow_control=function(b){if(this.allControls)for(var d=0;d<this.allControls.length;d++)if(this.allControls[d].name==b)return this.allControls[d];return null};MO.FUiWindow_restore=function(){this.max(!0)};
MO.FUiWindow_processResize=function(){if(!SystemManager.runMode){var b=this.rect();this.width=b.width();this.height=b.height()}this.processEvent(this,IWindowEvent.RESIZE)};MO.FUiWindow_fillAllControl=function(){for(var b=null,d=this.controls.size(),f=0;f<d;f++)b=this.controls.value(f),b.fill&&b.fill()};
MO.FUiWindow_refresh=function(b){this.loadConfig&&this.loadConfig();this.setCaption(this.label);this.setWidth(this.width);this.setHeight(this.height);if(this.allControls)for(var d=0;d<this.allControls.length;d++){var f=this.allControls[d];f.refresh&&(b&&f.reloadConfig&&f.reloadConfig(),f.refresh())}};MO.FUiWindow_initialize=function(){if(this.allControls)for(var b=0;b<this.allControls.length;b++){var d=this.allControls[b];d.initialize&&d.initialize();d.initializeControl&&d.initializeControl()}};
MO.FUiWindow_release=function(){if(this.allControls)for(var b=0;b<this.allControls.length;b++){var d=this.allControls[b];d.releaseControl&&d.releaseControl();d.release&&d.release()}this.htmlBorder.removeNode(!0);DatasetManager.focus(null,!0);WindowManager.releaseWindow(this)};MO.FUiWindow_stopDropExecute=function(b){if(b.config&&b.rect){var d=b.rect();b.config.setAttribute("left",d.left);b.config.setAttribute("top",d.top);b.config.setAttribute("width",d.width());b.config.setAttribute("height",d.height())}if(this.owner.onStopDrop)this.owner.onStopDrop(b)};
MO.FUiWindow_selectDsExecute=function(b){if(b&&b.constructor==FDatasetCtl){var d=DatasetManager.activeDsCtl!=b;DatasetManager.activeDsCtl=b;d&&DatasetManager.refreshToolbar()}};MO.FUiWindow_dispose=function(){this.__base.FUiLayout.dispose.call(this);this.__base.MWinBorder.dispose.call(this);this.hBorderForm=null};
MO.EUiDataAction=new function(){this.Fetch="fetch";this.Search="search";this.Lov="lov";this.Zoom="zoom";this.Prepare="prepare";this.Insert="insert";this.Update="update";this.Delete="delete";this.First="first";this.Prior="prior";this.Next="next";this.Last="last";this.Action="action";this.FetchLov="fetchLov";this.EndFetch="endfetch";this.EndUpdate="endupdate";this.DsChanged="dschanged";this.Scalar="scalar";this.Complete="complete";this.Process="process";return this};
MO.EUiDataMode=new function(){this.Insert="insert";this.Update="update";this.Delete="delete";return this};MO.EUiDataService=new function(){this.Dataset="database.dataset";this.List="design.list";this.WebForm="design.webform";this.Translate="design.translate";this.WebDataset="logic.dataset";return this};MO.EUiDataStore=new function(){this.Full=0;this.Sort=1;this.Config=2;this.Value=3;this.Name=4;this.DataName=5;this.DataNvl=6;this.Reset=7;this.Prepare=8;return this};
with(MO)MO.MUiDataAction=function(b){b=RClass.inherits(this,b);b.doAction=MUiDataAction_doAction;return b},MO.MUiDataAction_doAction=function(b){b=this.findComponent(b);if(RClass.isClass(b,MInvoke))b.invoke(this);else throw new TError(this,"Component is invalid.");};
with(MO)MO.MUiDataContainer=function(b){b=RClass.inherits(this,b,MUiContainer);b.dsDataLoad=MUiDataContainer_dsDataLoad;b.dsDataSave=MUiDataContainer_dsDataSave;b.dsLoadValue=MUiDataContainer_dsLoadValue;b.dsSaveValue=MUiDataContainer_dsSaveValue;return b},MO.MUiDataContainer_dsDataLoad=function(b){var d=new TEventProcess(null,this,"oeDataLoad",MDataValue);d.source=b;this.process(d);d.dispose()},MO.MUiDataContainer_dsDataSave=function(b){var d=new TEventProcess(null,this,"oeDataSave",MDataValue);
d.source=b;this.process(d);d.dispose()},MO.MUiDataContainer_dsLoadValue=function(b,d){var f=new TEventProcess(this,"oeDataLoadValue",MUiDataValue);f.viewer=this._dataViewer;f.store=d;f.values=b;this.process(f)},MO.MUiDataContainer_dsSaveValue=function(b,d){b||(b=new TRow);var f=new TEventProcess(this,"oeDataSaveValue",MUiDataValue);f.viewer=this._dataViewer;f.store=d;f.values=b;this.process(f);b.set("_status",this._dataStatusCd);return b};
with(MO)MO.MUiDataField=function(b){b=RClass.inherits(this,b,MUiValue,MUiDataValue);b._dataTypeCd=RClass.register(b,new APtyString("_dataTypeCd"));b._dataRequire=RClass.register(b,new APtyBoolean("_dataRequire"));b._dataName=RClass.register(b,new APtyString("_dataName"));b.oeDataLoadValue=MUiDataField_oeDataLoadValue;b.oeDataSaveValue=MUiDataField_oeDataSaveValue;b.formatLoad=MUiDataField_formatLoad;b.formatSave=MUiDataField_formatSave;return b},MO.MUiDataField_oeDataLoadValue=function(b){b=b.values.get(this._dataName);
this.set(this.formatLoad(b));return EEventStatus.Stop},MO.MUiDataField_oeDataSaveValue=function(b){b=this.get();dataSource.values.set(this._dataName,this.formatSave(b));return EEventStatus.Stop},MO.MUiDataField_formatLoad=function(b){return b},MO.MUiDataField_formatSave=function(b){return b};
with(MO)MO.MUiDataset=function(b){b=RClass.inherits(this,b);b._dsDataset=RClass.register(b,new APtyString("_dsDataset","dataset"));b._dsPageSize=RClass.register(b,new APtyInteger("_dsPageSize","page_size"),20);b._dsPageIndex=0;b._dsInsertAction=RClass.register(b,new APtyString("_dsInsertAction","insert_action"));b._dsUpdateAction=RClass.register(b,new APtyString("_dsUpdateAction","update_action"));b._dsDeleteAction=RClass.register(b,new APtyString("_dsDeleteAction","delete_action"));b._dataSource=
null;b._dataViewer=null;b._dataValues=null;b._dataGlobalSearchs=null;b._dataSearchs=null;b._dataGlobalOrders=null;b._dataOrders=null;b.__progress=!1;b.lsnsUpdateBegin=null;b.lsnsUpdateEnd=null;b.onDatasetLoadBegin=RMethod.empty;b.onDatasetLoad=RMethod.empty;b.onDatasetLoadEnd=RMethod.empty;b.onStoreChanged=RMethod.empty;b.onDsFetchBegin=RMethod.empty;b.onDsFetchEnd=RMethod.empty;b.onDsUpdateBegin=RMethod.empty;b.onDsUpdateEnd=RMethod.empty;b.onDsFetch=MUiDataset_onDsFetch;b.onDsPrepareCheck=RMethod.emptyTrue;
b.onDsCopy=MUiDataset_onDsCopy;b.onDsPrepare=MUiDataset_onDsPrepare;b.onDsUpdateCheck=RMethod.emptyTrue;b.onDsUpdate=MUiDataset_onDsUpdate;b.onDsDoUpdate=MUiDataset_onDsDoUpdate;b.onDsDeleteCheck=RMethod.emptyTrue;b.onDsDelete=MUiDataset_onDsDelete;b.onDsProcess=MUiDataset_onDsProcess;b.oeDataLoad=MUiDataset_oeDataLoad;b.oeDataSave=MUiDataset_oeDataSave;b.oeDatasetLoad=MUiDataset_oeDatasetLoad;b.construct=MUiDataset_construct;b.loadDataset=MUiDataset_loadDataset;b.loadDatasets=MUiDataset_loadDatasets;
b.toDeepAttributes=MUiDataset_toDeepAttributes;b.dsDatasetLoad=MUiDataset_dsDatasetLoad;b.dsFetch=MUiDataset_dsFetch;b.dsInitialize=MUiDataset_dsInitialize;b.dsShow=MUiDataset_dsShow;b.dsLoaded=MUiDataset_dsLoaded;b.dsSearch=MUiDataset_dsSearch;b.dsCopy=MUiDataset_dsCopy;b.dsPrepare=MUiDataset_dsPrepare;b.dsUpdate=MUiDataset_dsUpdate;b.dsDelete=MUiDataset_dsDelete;b.dsMode=MUiDataset_dsMode;b.dsDoUpdate=MUiDataset_dsDoUpdate;b.dsProcess=MUiDataset_dsProcess;b.dsProcessCustom=MUiDataset_dsProcessCustom;
b.dsProcessChanged=MUiDataset_dsProcessChanged;b.dsProcessSelected=MUiDataset_dsProcessSelected;b.dsProcessAll=MUiDataset_dsProcessAll;b.psProgress=MUiDataset_psProgress;b.psValid=MUiDataset_psValid;b.dsIsChanged=MUiDataset_dsIsChanged;b.dsCount=MUiDataset_dsCount;b.dsCurrent=MUiDataset_dsCurrent;b.dsMove=MUiDataset_dsMove;b.dsMovePage=MUiDataset_dsMovePage;b.dsGet=MUiDataset_dsGet;b.dsSet=MUiDataset_dsSet;b.dsRefresh=MUiDataset_dsRefresh;b.doSearch=MUiDataset_doSearch;return b},MO.MUiDataset_onDsFetch=
function(b){this.dsDatasetLoad(b.datasets)},MO.MUiDataset_onDsCopy=function(b){this.loadDatasets(b.resultDatasets);this.onLoadDatasetEnd();this.focus()},MO.MUiDataset_onDsPrepare=function(b){b.resultDatasets.set("/",null);this.loadDatasets(b.resultDatasets);this.doPrepare(b.resultRow);b.invokeSuccess()||(this.onLoadDatasetEnd(),this.focus())},MO.MUiDataset_onDsUpdate=function(b){this.loadDatasets(b.resultDatasets);this.onLoadDatasetEnd();this.focus()},MO.MUiDataset_onDsDoUpdate=function(b){b.invokeSuccess()||
this.psRefresh();b.processFinish||(this.focus(),this.lsnsUpdateEnd.process(b));this.onLoadDatasetEnd()},MO.MUiDataset_onDsDelete=function(b){this.loadDatasets(b.resultDatasets);this.doDelete(b.resultRow);this.onLoadDatasetEnd();this.focus()},MO.MUiDataset_onDsProcess=function(b){var d=b.resultCallback;d&&d.invoke(this,b)},MO.MUiDataset_oeDataLoad=function(b){b.isBefore()&&(b=b.source,b.selectDataset(),b.selectRow());return EEventStatus.Contine},MO.MUiDataset_oeDataSave=function(b){b.isBefore()&&(b=
b.source,b.selectDataset(),b.selectRow());return EEventStatus.Contine},MO.MUiDataset_oeDatasetLoad=function(b){b.isBefore()&&(this._dataset=b=b.datasets.get(this._name),this.onDatasetLoad(b));return EEventStatus.Contine},MO.MUiDataset_construct=function(){this._dataViewer=new TDatasetViewer},MO.MUiDataset_loadDataset=function(b){this.dsStore=b;b.saveViewer(this._dataViewer);this.onLoadDataset(b)},MO.MUiDataset_loadDatasets=function(b){for(var d=b.count(),f=0;f<d;f++){var h=b.value(n),q=this.findByPath(h.name);
if(!q)return RMessage.fatal(this,null,"Load dataset failed. (dataset={1}",h.name);q.loadDataset(h)}},MO.MUiDataset_dsDatasetLoad=function(b){var d=new TEventProcess(null,this,"oeDatasetLoad",MUiDataset);d.datasets=b;this.process(d);d.dispose()},MO.MUiDataset_toDeepAttributes=function(b,d){b||(b=new TAttributes);for(var f=new TList,h=this;h;){RClass.isClass(h,MUiDataset)&&f.push(h);if(!h.parent)break;h=h.topControl(MUiDataset)}for(var q=f.count;0<=q;q--)h=f.get(q),RClass.isClass(h,FForm)?h.toAttributes(b,
d):RClass.isClass(d,FTable)&&(h=h.getCurrentRow())&&h.toAttributes(b,d);return b},MO.MUiDataset_dsFetch=function(){var b=new TDatasetFetchArg;b.owner=this;b.name=this._name;b.callback=this.onDsFetch;RConsole.find(FDatasetConsole).fetch(b)},MO.MUiDataset_dsInitialize=function(){this.callEvent("onFormInitialize",this,this.__initializeEvent)},MO.MUiDataset_dsShow=function(){this.callEvent("onFormShow",this,this.__showEvent)},MO.MUiDataset_dsLoaded=function(){this.callEvent("onDatasetLoaded",this,this.__loadedEvent)},
MO.MUiDataset_dsSearch=function(b){this.psProgress(!0);var d=this.topControl(),f=this.fullPath();b&&(f=b.fullPath());b=new TDatasetFetchArg(d.name,d.formId,this.dsPageSize,0,!0,!1,f);b.mode=d._emode;b.searchs.append(this._dataGlobalSearchs);b.searchs.append(this._dataSearchs);b.orders.append(this._dataGlobalOrders);b.orders.append(this._dataOrders);this.toDeepAttributes(b.values);b.values.append(this._dataValues);b.callback=new TInvoke(this,this.onDsFetch);RConsole.find(FDatasetConsole).fetch(b)},
MO.MUiDataset_dsCopy=function(b){this.psProgress(!0);this.psMode(EMode.Insert);var d=new TDatasetFetchArg(this.name,this.formId,this.dsPageSize,0,!0);d.form=this;d.mode=EMode.Insert;this._dataSearchs.clear();this._dataSearchs.push(new TSearchItem("OUID",b.get("OUID")));d.searchs=this._dataSearchs;d.callback=new TInvoke(this,this.onDsCopy);this.onDsUpdateCheck(d)&&RConsole.find(FDatasetConsole).fetch(d)},MO.MUiDataset_dsPrepare=function(b){this.psProgress(!0);this.psMode(EMode.Insert);var d=new TDatasetPrepareArg(this.name,
this.formId);d.form=this;d.values.append(this._dataValues);d.callbackSuccess=b;this.onDsPrepareCheck(d)&&(d.callback=new TInvoke(this,this.onDsPrepare),RConsole.find(FDatasetConsole).prepare(d))},MO.MUiDataset_dsUpdate=function(b,d){this.psProgress(!0);this.psMode(EMode.Update);this.dsFetch(!0)},MO.MUiDataset_dsDoUpdate=function(b,d){if(this.psValid()){var f=this.topControl(),f=new TDatasetUpdateArg(f.name,this.formId,this.dsName);f.form=this;f.path=this.fullPath();f.mode=this._emode;f.codes=this.getDataCodes();
f.callback=new TInvoke(this,this.onDsDoUpdate);f.callbackSuccess=b;if(EMode.Insert==this._emode||EMode.Delete==this._emode)f.dataset.rows.append(this.getCurrentRows());else if(f.dataset.rows.append(this.getChangedRows()),!d&&!f.hasData())return RMessage.warn(this,RContext.get("MUiDataset:nochange"));this.psProgress(!0);RConsole.find(FDatasetConsole).update(f)}},MO.MUiDataset_dsDelete=function(b,d){this.psProgress(!0);this.psMode(EMode.Delete);var f=new TDatasetFetchArg(this.name,this.formId,this.dsPageSize,
0,!0);f.callback=new TInvoke(this,this.onDsDelete);f.form=this;f.mode=EMode.Delete;b&&f.searchs.push(new TSearchItem("OUID",b));d&&f.searchs.push(new TSearchItem("OVER",d));f.values=this._dataValues;this.onDsDeleteCheck(f)&&RConsole.find(FDatasetConsole).fetch(f)},MO.MUiDataset_dsMode=function(b){switch(b){case EMode.Insert:this.dsPrepare();break;case EMode.Update:this.dsUpdate();break;case EMode.Delete:this.dsDelete()}},MO.MUiDataset_dsProcess=function(b,d){if(this.psValid()){var f=new TDatasetServiceArg(this.topControl().name,
b);f.form=this;f.controlName=this.name;this.toDeepAttributes(f.attributes);f.codes=this.getDataCodes();f.push(this.getCurrentRow());f.resultCallback=d;this.psProgress(!0);f.callback=new TInvoke(this,this.onDsProcess);RConsole.find(FFormConsole).process(f)}},MO.MUiDataset_dsProcessCustom=function(b,d,f,h){if(h||this.psValid()){d=new TDatasetServiceArg(this.topControl().name,d);d.form=this;d.controlName=this.name;d.attributes=b;d.codes=this.getDataCodes();d.push(this.getCurrentRow());d.resultCallback=
f;if(!h&&!d.hasData())return RMessage.warn(this,RContext.get("MUiDataset:nodata"));this.psProgress(!0);d.callback=new TInvoke(this,this.onDsProcess);RConsole.find(FFormConsole).process(d)}},MO.MUiDataset_dsProcessSelected=function(b,d){if(this.psValid()){var f=new TDatasetServiceArg(this.topControl().name,b);f.form=this;f.controlName=this.name;this.toDeepAttributes(f.attributes);f.codes=this.getDataCodes();f.rows=this.getSelectedRows();if(0<f.rows.count)f.resultCallback=d,this.psProgress(!0),f.callback=
new TInvoke(this,this.onDsProcess),RConsole.find(FFormConsole).process(f),this.clearSelectRows();else return RMessage.warn(this,RContext.get("MUiDataset:norows"))}},MO.MUiDataset_dsProcessChanged=function(b,d){if(this.psValid()){var f=new TDatasetServiceArg(this.topControl().name,b);f.form=this;f.controlName=this.name;this.toDeepAttributes(f.attributes);f.codes=this.getDataCodes();f.rows=this.getChangedRows();f.resultCallback=d;if(!f.hasData())return RMessage.warn(this,RContext.get("MUiDataset:nochange"));
this.psProgress(!0);f.callback=new TInvoke(this,this.onDsProcess);RConsole.find(FFormConsole).process(f)}},MO.MUiDataset_dsProcessAll=function(b,d){if(this.psValid()){var f=new TDatasetServiceArg(this.topControl().name,b);f.form=this;f.controlName=this.name;this.toDeepAttributes(f.attributes);f.codes=this.getDataCodes();f.rows=this.getRows();f.resultCallback=d;this.psProgress(!0);f.callback=new TInvoke(this,this.onDsProcess);RConsole.find(FFormConsole).process(f)}},MO.MUiDataset_psProgress=function(b){if(this.__progress!=
b){this.__progress=b;var d=this.__progressProcess;d.enable=b;this.process(d)}},MO.MUiDataset_psValid=function(){var b=this.__validProcess,d=b.controls;d.clear();this.process(b);return d.isEmpty()?!0:(b=RConsole.find(FCheckWindowConsole).find(),b.set(d),b.show(),!1)},MO.MUiDataset_dsIsChanged=function(){var b=this.dsStore;return b?b.isChanged():!1},MO.MUiDataset_dsCount=function(){return this.dsStore?this.dsStore.count:0},MO.MUiDataset_dsCurrent=function(){},MO.MUiDataset_dsMove=function(b){var d=
this.dsStore;if(null!=b||d)RInt.isInt(b)?d.move(b):EDataAction.First==b?d.moveFirst():EDataAction.Prior==b?d.movePrior():EDataAction.Next==b?d.moveNext():EDataAction.Last==b?d.moveLast():RMessage.fatal(this,null,"Unknown position (postion={0})",b),RClass.isClass(this,MValue)&&this.loadValue(d.current())},MO.MUiDataset_dsMovePage=function(b){var d=this.dsStore;RInt.isInt(b)||(EDataAction.First==b?b=0:EDataAction.Prior==b?(b=d.pageIndex,0<b&&b--):EDataAction.Next==b?(b=d.pageIndex,b<d.pageCount-1&&
b++):EDataAction.Last==b?b=d.pageCount-1:RMessage.fatal(this,null,"Unknown page (page={0})",b));b!=d.pageIndex&&(this.psProgress(!0),d=this.topControl(MUiDataset),b=new TDatasetFetchArg(d.name,d.formId,this.dsPageSize,b,!0),b.path=this.fullPath(),b.mode=d._emode,b.searchs.append(this._dataGlobalSearchs),b.searchs.append(this._dataSearchs),b.orders.append(this._dataGlobalOrders),b.orders.append(this._dataOrders),b.values=this.toDeepAttributes(),b.values.append(this._dataValues),b.callback=new TInvoke(this,
this.onDsFetch),RConsole.find(FDatasetConsole).fetch(b))},MO.MUiDataset_dsGet=function(b){return this.dsStore?this.dsStore.get(b):""},MO.MUiDataset_dsSet=function(b,d){this.dsStore&&this.dsStore.set(b,d)},MO.MUiDataset_dsRefresh=function(){this._dsService&&this.dsMove(this.dsPage,!0)},MO.MUiDataset_doSearch=function(){var b=this.dsSearchWindow;b||(b=this.dsSearchWindow=top.RControl.create(top.FSearchWindow),b.linkDsControl(this));b.show()};
with(MO)MO.MUiDataValue=function(b){b=RClass.inherits(this,b);b.oeDataLoadValue=RMethod.empty;b.oeDataSaveValue=RMethod.empty;return b};
with(MO)MO.RUiDataEvent=function(){this.codeEvent=this.recordEvent=this.saveEvent=this.loadEvent=this.resetEvent=this.clearEvent=null;this.construct=RUiDataEvent_construct;this.construct();return this},MO.RUiDataEvent_construct=function(b){this.clearEvent=new TEventProcess(this,"oeClearValue",MUiDataValue);this.resetEvent=new TEventProcess(this,"oeResetValue",MUiDataValue);this.loadEvent=new TEventProcess(this,"oeLoadValue",MUiDataValue);this.saveEvent=new TEventProcess(this,"oeSaveValue",MUiDataValue);
this.recordEvent=new TEventProcess(this,"oeRecordValue",MUiDataValue);this.codeEvent=new TEventProcess(this,"oeSaveCode",MUiDataValue)},MO.RUiDataEvent=new RUiDataEvent;
with(MO)MO.FDatasetConsole=function(b){b=RClass.inherits(this,b,FConsole);b._scopeCd=EScope.Local;b._service="cloud.data.frame";b._datasets=null;b.onFetch=FDatasetConsole_onFetch;b.construct=FDatasetConsole_construct;b.loadDataset=FDatasetConsole_loadDataset;b.loadDatasets=FDatasetConsole_loadDatasets;b.fetch=FDatasetConsole_fetch;return b},MO.FDatasetConsole_onFetch=function(b){var d=b.parameter,f=b.outputNode;if(f.hasNode()){this.loadDatasets(f);b=d.datasets;for(var f=f.nodes(),h=f.count(),q=0;q<
h;q++){var w=f.get(q).get("name"),z=this._datasets.get(w);b.set(w,z)}}d.process()},MO.FDatasetConsole_construct=function(){this.__base.FConsole.construct.call(this);this._datasets=new TDictionary},MO.FDatasetConsole_loadDataset=function(b){var d=b.get("name");if(RString.isEmpty(d))throw new TError("Unknown dataset name.");var f=this._datasets.get(d);f||(f=new TDataset,f.name=d,this._datasets.set(d,f));f.clear();f.loadConfig(b);return f},MO.FDatasetConsole_loadDatasets=function(b){if(b.hasNode()){b=
b.nodes();for(var d=b.count(),f=0;f<d;f++){var h=b.get(f);h.isName("Dataset")&&this.loadDataset(h)}}},MO.FDatasetConsole_fetch=function(b){var d=new TXmlDocument,f=d.root();f.set("action","fetch");b.saveConfig(f.create("Frame"));f=new SXmlEvent;f.owner=this;f.url=RService.url(this._service);f.action=EDataAction.Fetch;f.parameter=b;f.inputDocument=d;f.callback=this.onFetch;RConsole.find(FXmlConsole).process(f)},MO.FDatasetConsole_onScalarLoaded=function(b,d){if(d.hasNode()){var f=b.resultConfig=d.find("Control");
f&&(b.result=f.get("result"))}b.invoke()},MO.FDatasetConsole_scalar=function(b){var d=new TXmlDocument,f=d.root();f.set("action",EDataAction.Scalar);f.push(b.toNode());f=new TEvent(this,EXmlEvent.Send,this.onLoaded);f.url=RService.url("logic.webform.dataset");f.action=EDataAction.Scalar;f.argument=b;f.document=d;RConsole.find(FXmlConsole).process(f)},MO.FDatasetConsole_onCompleteLoaded=function(b,d){if(d.hasNode()){var f=d.find("Control");f&&(b.resultConfig=f)}b.invoke()},MO.FDatasetConsole_onLovLoadeded=
function(b,d){b.lovNode=d;b.invoke()},MO.FDatasetConsole_onPrepareLoaded=function(b,d){var f=b.resultDatasets;if(d.hasNode())for(var h=d.nodes,q=h.count,w=0;w<q;w++){var z=h.get(w),A=z.get("id");RString.isEmpty(A)||this.loadDatasets(f,A,z)}if(!f.isEmpty())for(h=f.count,w=0;w<h;w++)if(q=f.value(w),"/"==q.name){b.resultRow=q.row(0);break}b.invoke()},MO.FDatasetConsole_onUpdateLoaded=function(b,d){var f=d.find("Form");if(f){var h=f.get("id");if(f=f.find("Dataset"))h=b.resultDataset=this.loadDataset(h,
f),b.resultRow=h.row(0),b.invoke(),RWindow.setEnable(!0)}},MO.FDatasetConsole_onLoaded=function(b){var d=b.document.root(),f=b.argument;if(!b.messageChecked){var h=new TMessageArg;h.argument=f;h.form=f.form;h.config=d;h.invokeCaller=new TInvoke(this,this.onLoaded);h.invokeParam=b;h.event=b;if(!RConsole.find(FMessageConsole).checkResult(h))return}f.configResult=d;switch(b.action){case EDataAction.Fetch:this.onFetchLoaded(f,d);break;case EDataAction.Prepare:this.onPrepareLoaded(f,d);break;case EDataAction.Update:this.onUpdateLoaded(f,
d);break;case EDataAction.Lov:this.onLovLoaded(f,d);break;case EDataAction.Scalar:this.onScalarLoaded(f,d);break;case EDataAction.Complete:this.onCompleteLoaded(f,d)}RConsole.find(FListenerConsole).process(MDataset,EAction.Changed,b,b)},MO.FDatasetConsole_complete=function(b){var d=new TXmlDocument,f=d.root();f.set("action","complete");f.push(b.toNode());f=new TEvent(this,EXmlEvent.Send,this.onLoaded);f.url=RService.url("logic.webform.dataset");f.action=EDataAction.Complete;f.argument=b;f.document=
d;RConsole.find(FXmlConsole).process(f)},MO.FDatasetConsole_lov=function(b){var d=new TXmlDocument,f=d.root();f.set("action","lov");f.push(b.toNode());f=new TEvent(this,EXmlEvent.Send,this.onLoaded);f.url=RService.url("logic.webform.dataset");f.action=EDataAction.Lov;f.argument=b;f.document=d;RConsole.find(FXmlConsole).process(f)},MO.FDatasetConsole_prepare=function(b){var d=new TXmlDocument,f=d.root();f.set("action","prepare");f.push(b.toNode());f=new TEvent(this,EXmlEvent.Send,this.onLoaded);f.url=
RService.url("logic.webform.dataset");f.action=EDataAction.Prepare;f.argument=b;f.document=d;RConsole.find(FXmlConsole).process(f)},MO.FDatasetConsole_update=function(b){var d=new TXmlDocument,f=d.root();f.set("action","update");b.checked&&f.set("checked",b.checked);f.push(b.toNode());f=new TEvent(this,EXmlEvent.Send,this.onLoaded);f.url=RService.url("logic.webform.dataset");f.action=EDataAction.Update;f.argument=b;f.document=d;RConsole.find(FXmlConsole).process(f)},MO.FDatasetConsole_get=function(b){return this.forms.get(b)},
MO.FDatasetConsole_getById=function(b){return this._datasets.get(b)},MO.FDatasetConsole_getByPath=function(b,d){var f=this.get(b);return f?f.get(d):null},MO.FDatasetConsole_onTreeLoaded=function(b){alert(1)},MO.FDatasetConsole_onColumnFetch=function(b){var d=b.document.root();if(RConsole.find(FMessageConsole).checkResult(d)){b=b.arg;if(d.hasNode())for(var d=d.nodes,f=d.count,h=0;h<f;h++){var q=d.get(h);if(q.hasNode()){var q=q.nodes,w=q.count;for(n=0;n<w;n++){var z=q.get(n);if("Data"==z.name){b.resultConfig=
z;break}}}}b.invoke()}},MO.FDatasetConsole_columnNodeFetch=function(b){var d=new TXmlDocument,f=d.root();f.set("action",b.action);var h=b.toNode();f.push(h);f=RService.url(b.service);h=new TEvent(this,EXmlEvent.Send,this.onColumnFetch);h.url=f;h.document=d;h.arg=b;h.action=EDataAction.Fetch;RConsole.find(FXmlConsole).process(h)},MO.FDatasetConsole_treeUpdate=function(b){var d=new TXmlDocument,f=d.root();f.set("action",b.action);var h=b.toNode();f.push(h);f=RService.url(b.service);h=new TEvent(this,
EXmlEvent.Send,this.onTreeLoaded);h.url=f;h.document=d;h.arg=b;h.action=EDataAction.TreeUpdate;RConsole.find(FXmlConsole).process(h)};
with(MO)MO.FDataSource=function(b){b=RClass.inherits(this,b,FObject);b._currentRow=null;b._currentDataset=null;b._datasets=null;b.construct=FDataSource_construct;b.selectDataset=FDataSource_selectDataset;b.currentDataset=FDataSource_currentDataset;b.selectRow=FDataSource_selectRow;b.currentRow=FDataSource_currentRow;return b},MO.FDataSource_construct=function(){this.__base.FObject.construct.call(this);this._datasets=new TDictionary},MO.FDataSource_selectDataset=function(b){b=RString.nvl(b,"default");
var d=this._datasets.get(b);null==d&&(d=new TDataset,d._name=b,this._datasets.set(b,d));this._currentDataset=d},MO.FDataSource_currentDataset=function(){return this._currentDataset},MO.FDataSource_selectRow=function(b){if(b)this._currentRow=b;else{b=this._currentDataset;var d=b.rows().first();null==d&&(d=b.createRow());return this._currentRow=d}},MO.FDataSource_currentRow=function(){return this._currentRow},MO.FDataSource_create=function(b){return this.dataset.create(b)},MO.FDataSource_count=function(){return this.dataset.count},
MO.FDataSource_row=function(b){return this.dataset.get(b)},MO.FDataSource_current=function(){return this.row(this._position)},MO.FDataSource_isChanged=function(){for(var b=this.dataset,d=0;d<b.count;d++){var f=b.get(d);if(f&&f.isSave())return!0}return!1},MO.FDataSource_get=function(b){var d=this.current();return d?d.get(b):""},MO.FDataSource_set=function(b,d){var f=this.current();f&&f.set(b,d)},MO.FDataSource_move=function(b){this._position=b},MO.FDataSource_moveToRow=function(b){b=this.dataset.indexOf(b);
-1!=b&&(this._position=b)},MO.FDataSource_find=function(){return this.dataset.findByArgs(arguments)},MO.FDataSource_loadNode=function(b){if(b&&b.nodes){b=b.nodes;for(var d=0;d<b.count;d++){var f=b.get(d);if(f&&f.isName("Row")){var h=this.dataset.create();h.loadNode(f);h.store()}}}},MO.FDataSource_dump=function(b){b=RString.nvlStr(b);b.appendLine(RClass.dump(this));this.dataset.dump(b);return b};
with(MO)MO.FUiDataAction=function(b){b=RClass.inherits(this,b,FDuiComponent,MInvoke);b._action=RClass.register(b,new APtyString("_action"));b._service=RClass.register(b,new APtyString("_service"));b._execute=RClass.register(b,new APtyString("_execute"));b._loading=!1;b._dataContainer=null;b.onLoaded=FUiDataAction_onLoaded;b.invoke=FUiDataAction_invoke;return b},MO.FUiDataAction_onLoaded=function(b){RWindow.setEnable(!0);this._loading=!1},MO.FUiDataAction_invoke=function(b){var d=RService.parse(this._service);
if(!d)throw new TError(this,"Unknown service.");RWindow.setEnable(!1);var f=new TXmlDocument,h=f.root();h.set("action",d.action);RConsole.find(FEnvironmentConsole).build(h);b.dsSaveValue(h.create("Data"));this._loading=!0;this._dataContainer=b;RConsole.find(FXmlConsole).sendAsync(d.url,f).addLoadListener(this,this.onLoaded)};with(MO)MO.FUiDataCheck=function(b){return b=RClass.inherits(this,b,FUiCheck,MUiDataField)};
with(MO)MO.FUiDataColorPicker=function(b){return b=RClass.inherits(this,b,FUiEdit,MUiDataField)},MO.FUiDataColorPicker_onDataKeyDown=function(b,d){this.__base.FUiEdit.onDataKeyDown.call(this,b,d);this.editCase&&RKey.fixCase(d,this.editCase);if(this._editable&&this.editComplete&&16!=d.keyCode&&17!=d.keyCode&&18!=d.keyCode&&20!=d.keyCode){var f=this.findEditor();if(f)f.onEditKeyDown(b,d)}},MO.FUiDataColorPicker_formatValue=function(b){b=RString.nvl(b);ECase.Upper==this.editCase?b=RString.toUpper(b):
ECase.Lower==this.editCase&&(b=RString.toLower(b));return b},MO.FUiDataColorPicker_setText=function(b){this.hEdit&&(this.hEdit.value="U"==this.editCase?RString.toUpper(b):"L"==this.editCase?RString.toLower(b):b,this.hEdit.style.textAlign="right"==this.editAlign?"right":"left"==this.editAlign?"left":"center")},MO.FUiDataColorPicker_validText=function(b){var d=this.__base.FUiEdit.validText.call(this,b);if(!d){if(this.validLenmin&&this.validLenmin>b.length)return RContext.get("MDescEdit:ValidMinLength",
this.validLenmin);if(this.validLenmax&&this.validLenmax<b.length)return RContext.get("MDescEdit:ValidMaxLength",this.validLenmax)}return d},MO.FUiDataColorPicker_findEditor=function(){if(this.editComplete){var b=this.editor;!b&&(this.dsControl=this.topControl(MDataset))&&(b=this.editor=RConsole.find(FUiDataColorPickerConsole).focus(this,FUiDataColorPickerEditor));b&&b.linkControl(this);return this.editor}},MO.FUiDataColorPicker_drop=function(){var b=this.findEditor();if(b){var d=this.reget();0<d.length&&
(this.finded!=d&&(b.source!=this&&b.linkControl(this),b.search(d)),this.finded=d)}};
with(MO)MO.FUiDataEdit=function(b){return b=RClass.inherits(this,b,FUiEdit,MUiDataField)},MO.FUiDataEdit_onDataKeyDown=function(b,d){this.__base.FUiEdit.onDataKeyDown.call(this,b,d);this.editCase&&RKey.fixCase(d,this.editCase)},MO.FUiDataEdit_formatValue=function(b){b=RString.nvl(b);ECase.Upper==this.editCase?b=RString.toUpper(b):ECase.Lower==this.editCase&&(b=RString.toLower(b));return b},MO.FUiDataEdit_setText=function(b){this.hEdit&&(this.hEdit.value="U"==this.editCase?RString.toUpper(b):"L"==
this.editCase?RString.toLower(b):b,this.hEdit.style.textAlign="right"==this.editAlign?"right":"left"==this.editAlign?"left":"center")},MO.FUiDataEdit_validText=function(b){var d=this.__base.FUiEdit.validText.call(this,b);if(!d){if(this.validLenmin&&this.validLenmin>b.length)return RContext.get("MDescEdit:ValidMinLength",this.validLenmin);if(this.validLenmax&&this.validLenmax<b.length)return RContext.get("MDescEdit:ValidMaxLength",this.validLenmax)}return d},MO.FUiDataEdit_findEditor=function(){if(this.editComplete){var b=
this.editor;!b&&(this.dsControl=this.topControl(MDataset))&&(b=this.editor=RConsole.find(FUiDataEditConsole).focus(this,FUiDataEditEditor));b&&b.linkControl(this);return this.editor}},MO.FUiDataEdit_drop=function(){var b=this.findEditor();if(b){var d=this.reget();0<d.length&&(this.finded!=d&&(b.source!=this&&b.linkControl(this),b.search(d)),this.finded=d)}};
with(MO)MO.FUiDataEditControl=function(b){b=RClass.inherits(this,b,FUiEditControl,MUiEditValue,MUiEditChange,MUiEditDrop);b._labelModeCd=RClass.register(b,new APtyString("_labelModeCd"),EUiLabelMode.All);b._labelPositionCd=RClass.register(b,new APtyString("_labelPositionCd"),EUiLabelPosition.Left);b._labelSize=RClass.register(b,new APtySize2("_labelSize"));b._labelAlignCd=RClass.register(b,new APtyString("_labelAlignCd"),EUiAlign.Left);b._labelColor=RClass.register(b,new APtyString("_labelColor"));
b._editSize=RClass.register(b,new APtySize2("_editSize"));b._editColor=RClass.register(b,new APtyString("_editColor"));b._styleLabelPanel=RClass.register(b,new AStyle("_styleLabelPanel"));b._styleEditPanel=RClass.register(b,new AStyle("_styleEditPanel"));b._progressing=!1;b._hLabelPanel=null;b._hLabelForm=null;b._hIconPanel=null;b._hIcon=null;b._hTextPanel=null;b._hText=null;b._hEditPanel=null;b._hEditForm=null;b._hValuePanel=null;b.onBuildLabelIcon=FUiDataEditControl_onBuildLabelIcon;b.onBuildLabelText=
FUiDataEditControl_onBuildLabelText;b.onBuildLabel=FUiDataEditControl_onBuildLabel;b.onBuildEditValue=RMethod.virtual(b,"onBuildEditValue");b.onBuildEdit=FUiDataEditControl_onBuildEdit;b.onBuildPanel=FUiDataEditControl_onBuildPanel;b.onBuild=FUiDataEditControl_onBuild;b.oeMode=FUiDataEditControl_oeMode;b.oeProgress=FUiDataEditControl_oeProgress;b.construct=FUiDataEditControl_construct;b.panel=FUiDataEditControl_panel;b.label=FUiDataEditControl_label;b.setLabel=FUiDataEditControl_setLabel;b.text=FUiDataEditControl_text;
b.setText=FUiDataEditControl_setText;b.getValueRectangle=FUiDataEditControl_getValueRectangle;b.dispose=FUiDataEditControl_dispose;return b},MO.FUiDataEditControl_onBuildLabelIcon=function(b){this._hIcon=this._labelIcon?RBuilder.appendIcon(this._hIconPanel,null,this._labelIcon):RBuilder.appendIcon(this._hIconPanel,null,"n",16,16)},MO.FUiDataEditControl_onBuildLabelText=function(b){this._hText=RBuilder.appendSpan(this._hTextPanel,null,this._label)},MO.FUiDataEditControl_onBuildLabel=function(b){var d=
this._hLabelForm=RBuilder.appendTable(this._hLabelPanel,this.styleName("LabelPanel")),f=RBuilder.appendTableRow(d);(this._hIconPanel=RBuilder.appendTableCell(f)).width="20px";this.onBuildLabelIcon(b);f=this._hTextPanel=RBuilder.appendTableCell(f);f.noWrap=!0;this.onBuildLabelText(b);RHtml.setSize(d,this._labelSize);this._labelAlignCd&&(f.align=this._labelAlignCd,f.style.paddingRight=4);this._labelColor&&(this._hLabel.style.color=this._labelColor)},MO.FUiDataEditControl_onBuildEdit=function(b){var d=
this._hEditForm=RBuilder.appendTable(this._hEditPanel,this.styleName("EditPanel")),f=this._hEditLine=RBuilder.appendTableRow(d);this._hValuePanel=RBuilder.appendTableCell(f);this.onBuildEditValue(b);RHtml.setSize(d,this._editSize)},MO.FUiDataEditControl_onBuildPanel=function(b){this._hPanel=RBuilder.createTable(b,this.styleName("Panel"))},MO.FUiDataEditControl_onBuild=function(b){this.__base.FUiEditControl.onBuild.call(this,b);var d=this._hPanel,f=null,h=null,q=this._labelModeCd;q==EUiLabelMode.Label?
f=RBuilder.appendTableCell(RBuilder.appendTableRow(d)):q==EUiLabelMode.Hidden?h=RBuilder.appendTableCell(RBuilder.appendTableRow(d)):(f=this._labelPositionCd,f==EUiLabelPosition.Top?(f=RBuilder.appendTableRowCell(d),h=RBuilder.appendTableRowCell(d)):f==EUiLabelPosition.Right?(d=RBuilder.appendTableRow(d),h=RBuilder.appendTableCell(d),f=RBuilder.appendTableCell(d)):f==EUiLabelPosition.Bottom?(h=RBuilder.appendTableRowCell(d),f=RBuilder.appendTableRowCell(d)):(d=RBuilder.appendTableRow(d),f=RBuilder.appendTableCell(d),
h=RBuilder.appendTableCell(d)));this._hLabelPanel=f;this._hEditPanel=h;f&&(this.onBuildLabel(b),f.appendChild(this._hLabelForm),this.setLabel(this._label));if(h)this.onBuildEdit(b)},MO.FUiDataEditControl_oeMode=function(b){this.__base.FUiEditControl.oeMode.call(this,b);this.__base.MDisplay.oeMode.call(this,b);this._editable=this.canEdit(b.mode);this._validable=this.canValid(b.mode);this._progressing||this.setEditable(this._editable);return EEventStatus.Stop},MO.FUiDataEditControl_oeProgress=function(b){if(this._progressing&&
b.enable)return EEventStatus.Stop;(this._progressing=b.enable)?(b=this._editable,this.setEditable(!1),this._editable=b):this.setEditable(this._editable);return EEventStatus.Stop},MO.FUiDataEditControl_construct=function(){this.__base.FUiEditControl.construct.call(this);this.__base.MUiEditChange.construct.call(this);this.__base.MUiEditDrop.construct.call(this);this._labelSize=new SSize2(100,20);this._editSize=new SSize2(200,20)},MO.FUiDataEditControl_panel=function(b){return EPanel.Edit==b||EPanel.Focus==
b?this.hEdit:this.__base.FUiEditControl.panel.call(this,b)},MO.FUiDataEditControl_label=function(b){return this._label},MO.FUiDataEditControl_setLabel=function(b){this._label=b;this._hText&&(this._hText.innerHTML=RString.nvl(b))},MO.FUiDataEditControl_text=function(){throw new TUnsupportError(o,"text");},MO.FUiDataEditControl_setText=function(b){throw new TUnsupportError(o,"setText");},MO.FUiDataEditControl_getValueRectangle=function(b){b||(b=new SRectangle);var d=this._hValuePanel,f=RHtml.clientPosition(d);
b.position.assign(f);b.setSize(d.offsetWidth,d.offsetHeight);return b},MO.FUiDataEditControl_dispose=function(){this._dataTypeCd=this._labelAlignCd=this._labelPositionCd=this._labelModeCd=null;this._labelSize=RObject.dispose(this._labelSize);this._editSize=RObject.dispose(this._editSize);this._hLabelPanel=RHtml.free(this._hLabelPanel);this._hLabelForm=RHtml.free(this._hLabelForm);this._hIconPanel=RHtml.free(this._hIconPanel);this._hIcon=RHtml.free(this._hIcon);this._hTextPanel=RHtml.free(this._hTextPanel);
this._hText=RHtml.free(this._hText);this._hEditPanel=RHtml.free(this._hEditPanel);this._hEditForm=RHtml.free(this._hEditForm);this._hValuePanel=RHtml.free(this._hValuePanel);this._hDropPanel=RHtml.free(this._hDropPanel);this.__base.MUiEditDrop.dispose.call(this);this.__base.MUiEditChange.dispose.call(this);this.__base.FUiEditControl.dispose.call(this)},MO.FUiDataEditControl_onScalar=function(b){this.set(b.result)},MO.FUiDataEditControl_scalar=function(b){b=new TDatasetScalarArg(this,null,b);b.callback=
new TInvoke(this,this.onScalar);RConsole.find(FDatasetConsole).scalar(b)},MO.FUiDataEditControl_onDataDoubleClick=function(){if(RClass.isClass(this,MDropable))this.onDropDoubleClick();if(RClass.isClass(this,MListView))this.onListClick()},MO.FUiDataEditControl_onDataKeyDown=function(b,d){this.__base.MEditDescriptor.onDataKeyDown.call(this,b,d);var f=this.hChangeIcon;f&&(f.style.display=this.isDataChanged()?"block":"none");if(RClass.isClass(this,MDropable)&&EKey.Down==d.keyCode)this.drop();else if(d.ctrlKey&&
EKey.Enter==d.keyCode&&this.editSearch&&(f=this.dsControl)&&!this.isValid){var h=new TNode("Search"),q=h.create("Item");q.set("name",this.name);q.set("data_name",this.dataName);q.set("data_value",this.dataValue);q.set("search_type",ESearch.Equals);q.set("search_order",EOrder.None);RConsole.find(FDatasetConsole).fetch(f,h)}},MO.FUiDataEditControl_onDesignBegin=function(){this.__base.MDesign.onDesignBegin.call(this);this._disbaled=!0;this.hEdit.disbaled=!0},MO.FUiDataEditControl_onDesignEnd=function(){this.__base.MDesign.onDesignEnd.call(this);
this._disbaled=!1;this.hEdit.disbaled=!1},MO.FUiDataEditControl_oeDataLoad=function(b){b=b.source.currentRow().get(this._dataName);this.set(b);return EEventStatus.Stop},MO.FUiDataEditControl_oeDataSave=function(b){b=b.source.currentRow();var d=this.get();b.set(this._dataName,d);return EEventStatus.Stop},MO.FUiDataEditControl_oeDesign=function(b){this.__base.MDesign.oeDesign.call(this,e);b=this.hLabelForm;var d=this.hEditForm;switch(e.mode){case EDesign.Move:e.flag?(this.hForm.border=1,b&&(b.cellPadding=
1),this.hEdit&&(this.hEdit.disabled=!0)):(this.hForm.border=0,b&&(b.border=0,b.cellPadding=0),this.hEdit&&(this.hEdit.disabled=!1));break;case EDesign.Border:e.flag?(this.hForm.border=1,d&&(d.border=1)):(this.hForm.border=0,d&&(d.border=0))}return EEventStatus.Stop},MO.FUiDataEditControl_oeLoadValue=function(b){b=this.__base.MUiEditValue.oeLoadValue.call(this,b);var d=this.hChangeIcon;d&&(d.style.display="none");return b},MO.FUiDataEditControl_doFocus=function(b){this.__base.MUiFocus.doFocus.call(this,
b);this.__base.MUiEditValue.doFocus.call(this,b)},MO.FUiDataEditControl_doBlur=function(b){this.__base.MUiFocus.doBlur.call(this,b);this.__base.MUiEditValue.doBlur.call(this,b)},MO.FUiDataEditControl_testFocus=function(){return this._visible&&this._editable&&!this._disbaled},MO.FUiDataEditControl_setEditable=function(b){this.__base.MUiEditValue.setEditable.call(this,b);this.hEdit&&(this.hEdit.readOnly=!b);var d=this.hLabel;d&&(this.validRequire&&(this.hLabel.style.color=b?EUiColor.Require:EUiColor.Text),
RClass.isClass(this,MListView)&&this.canListView()&&(d.style.cursor=b?"hand":"normal",d.className=b?"RLine_Underline":""))},MO.FUiDataEditControl_setVisible=function(b){this.__base.FUiEditControl.setVisible.call(this,b);this.refreshStyle()},MO.FUiDataEditControl_focus=function(){this.__base.MUiFocus.focus.call(this);if(this.hEdit)try{this.hEdit.focus()}catch(b){}},MO.FUiDataEditControl_refreshStyle=function(){if(this._visible){var b=EUiColor.TextReadonly,d=EUiColor.Readonly,f="normal";this._editable&&
(b=EUiColor.TextEdit,d=EUiColor.Edit,f="hand",RString.isEmpty(this.editTip)||this.hEdit.innerText!=this.editTip||(b="#CCCCCC"));this._invalidText&&!RString.isEmpty(this.text())&&(b=EUiColor.TextInvalid,d=EUiColor.Invalid);this._textColor=b;this._backColor=d;var h=this.hEdit,q=this.hDrop;h&&(h.style.color=b,h.style.backgroundColor=d);q&&(h&&(h.style.cursor=f),q.style.cursor=f);this.editBorder&&(b=EUiBorderStyle.Readonly,this._editable&&(b=EUiBorderStyle.Edit),this._hover&&(b=EUiBorderStyle.Hover),
this.setEditBorderStyle(b,d))}};with(MO)MO.FUiDataFrame=function(b){return b=RClass.inherits(this,b,FUiFrame,MUiDataset,MUiDataContainer,MUiDataAction)};
with(MO)MO.FUiDataIconPicker=function(b){return b=RClass.inherits(this,b,FUiEdit,MUiDataField)},MO.FUiDataIconPicker_onDataKeyDown=function(b,d){this.__base.FUiEdit.onDataKeyDown.call(this,b,d);this.editCase&&RKey.fixCase(d,this.editCase)},MO.FUiDataIconPicker_formatValue=function(b){b=RString.nvl(b);ECase.Upper==this.editCase?b=RString.toUpper(b):ECase.Lower==this.editCase&&(b=RString.toLower(b));return b},MO.FUiDataIconPicker_setText=function(b){this.hEdit&&(this.hEdit.value="U"==this.editCase?
RString.toUpper(b):"L"==this.editCase?RString.toLower(b):b,this.hEdit.style.textAlign="right"==this.editAlign?"right":"left"==this.editAlign?"left":"center")},MO.FUiDataIconPicker_validText=function(b){var d=this.__base.FUiEdit.validText.call(this,b);if(!d){if(this.validLenmin&&this.validLenmin>b.length)return RContext.get("MDescEdit:ValidMinLength",this.validLenmin);if(this.validLenmax&&this.validLenmax<b.length)return RContext.get("MDescEdit:ValidMaxLength",this.validLenmax)}return d},MO.FUiDataIconPicker_findEditor=
function(){if(this.editComplete){var b=this.editor;!b&&(this.dsControl=this.topControl(MDataset))&&(b=this.editor=RConsole.find(FUiDataIconPickerConsole).focus(this,FUiDataIconPickerEditor));b&&b.linkControl(this);return this.editor}},MO.FUiDataIconPicker_drop=function(){var b=this.findEditor();if(b){var d=this.reget();0<d.length&&(this.finded!=d&&(b.source!=this&&b.linkControl(this),b.search(d)),this.finded=d)}};with(MO)MO.FUiDataMemo=function(b){return b=RClass.inherits(this,b,FUiMemo,MUiDataField)};
with(MO)MO.FUiDataNumber=function(b){return b=RClass.inherits(this,b,FUiNumber)},MO.FUiDataNumber_onEditFocus=function(b){this.setText(this.formatValue(this.text()))},MO.FUiDataNumber_onEditBlur=function(b){this.setText(this.formatText(this.text()))},MO.FUiDataNumber_onBuildEdit=function(b){var d=RBuilder.appendTable(b.hPanel);d.style.tableLayout="fixed";d=this.hEdit=d.insertRow();this.onBuildChange(d.insertCell());if(this.canZoom()){var f=d.insertCell();this.hZoom=RBuilder.appendIcon(f,"ctl.zooms");
f.width=16}f=d.insertCell();f.style.width="100%";d=this.hEdit=RBuilder.appendEdit(f,this.style("Edit"));this.attachEvent("onEditFocus",d,this.onEditFocus);this.attachEvent("onEditKeyPress",d,this.onEditKeyPress);this.attachEvent("onEditBlur",d,this.onEditBlur);this.attachEvent("onDataKeyUp",d,this.ohEditKeyUp);this.editLength&&(d.maxLength=this.editLength);this.buildAdjustForm(b.hDrop)},MO.FUiDataNumber_setUnitIcon=function(b){this.hUnit.innerHTML="<IMG src="+b+">"},MO.FUiDataNumber_onDataKeyDown=
function(b,d){this.canEdit&&(EKey.Up==d.keyCode?this.adjustValue(!0):EKey.Down==d.keyCode&&this.adjustValue(!1));this.base.FUiNumber.onDataKeyDown.call(this,b,d)},MO.FUiDataNumber_ohEditKeyUp=function(b,d){EKey.Up==d.keyCode&&this.canEdit?this.hUpIcon.src=this.styleIconPath("UpSelect"):EKey.Down==d.keyCode&&this.canEdit&&(this.hDownIcon.src=this.styleIconPath("DownSelect"))},MO.FUiDataNumber_onEditKeyDown=function(b){this.canEdit&&(EKey.Up==b.keyCode?(b.source.hUpIcon.src=this.styleIconPath("up"),
this.changeValue(b,"Y")):EKey.Down==b.keyCode&&(b.source.hDownIcon.src=this.styleIconPath("down"),this.changeValue(b,"N")))},MO.FUiDataNumber_onEditKeyUp=function(b){this.canEdit&&(EKey.Up==b.keyCode?b.source.hUpIcon.src=this.styleIconPath("upSelect"):EKey.Down==b.keyCode&&(b.source.hDownIcon.src=this.styleIconPath("downSelect")))},MO.FUiDataNumber_onEditDoubleClick=function(){this.onListClick()},MO.FUiDataNumber_validPattern=function(b){var d=!0;b=RString.nvl(b);if(!RRegExp.test(ERegExp.NUMBER,b))return!1;
var f=null;if(this.dataType){for(n in ERegExp)if(RString.equals(n,this.dataType)){f=ERegExp[n];break}RString.equals(RClass.name(f),"RegExp")&&(d=RRegExp.test(f,b)?d&1:d&0)}this.editMaxvalue&&(d=parseFloat(b)<=parseFloat(this.editMaxvalue)?d&1:d&0);this.editMinvalue&&(d=parseFloat(b)>=parseFloat(this.editMinvalue)?d&1:d&0);return d},MO.FUiDataNumber_refreshStyle=function(){this.base.FUiNumber.refreshStyle.call(this);this.hUpIcon.src=this.styleIconPath(this._hover?"UpSelect":"Up");this.hDownIcon.src=
this.styleIconPath(this._hover?"DownSelect":"Down")},MO.FUiDataNumber_splitValue=function(b){b=RString.nvl(b.toString());var d=RString.findChars(b,"-"),f=RString.findChars(b,"%");b=RString.removeChars(b,"'");b=RString.removeChars(b," ");b=RString.removeChars(b,"%");b=RString.removeChars(b,"-");if(!RString.isEmpty(b)){for(var h="",q=0,w=b.length;-1<w;w--)h=0!=w&&0!=q&&0==q%3?"'"+b.charAt(w)+h:b.charAt(w)+h,q++;-1!=d&&(h="-"+h);-1!=f&&(h+="%");return h}return b},MO.FUiDataNumber_removeSplit=function(b){b=
RString.nvl(b);b=RString.removeChars(b,"'");return b=RString.removeChars(b,"%")},MO.FUiDataNumber_precisionValue=function(b){if(RString.isEmpty(b))return b;var d,f,h=RString.nvl(this.editPrecision);b=RString.nvl(b);RString.contains(h,".")?f=h.split(".")[1].length:d=h.length;if(RString.contains(b,"."))b=b.split("."),f&&(f>b[1].length?b[1]=RString.rpad(b[1],f-b[1].length,"0"):f<=b[1].length&&(b[1]=b[1].substring(0,f))),d&&(d>b[0].length?alert(d):d<b[0].length&&(b[0]=b[0].substring(0,b[0].length-d),
b[0]=RString.rpad(b[0],d,"0")),b[1]=null),b=b[1]?b[0]+"."+RString.nvl(b[1]):b[0];else{if(d)if(d<=b.length)for(b=b.substring(0,b.length-d+1),h=0;h<d-1;h++)b=b.concat("0");else d>b.length&&(b=0);if(f)for(b+=".",h=0;h<f;h++)b=b.concat("0")}return b},MO.FUiDataNumber_dispose=function(){this.base.FUiNumber.dispose.call(this);this.hChgIic=this.hDownIcon=this.hUpIcon=this.hLabel=null};
with(MO)MO.FUiDataNumber2=function(b){return b=RClass.inherits(this,b,FUiNumber2)},MO.FUiDataNumber2_onEditFocus=function(b){this.setText(this.formatValue(this.text()))},MO.FUiDataNumber2_onEditBlur=function(b){this.setText(this.formatText(this.text()))},MO.FUiDataNumber2_onBuildEdit=function(b){var d=RBuilder.appendTable(b.hPanel);d.style.tableLayout="fixed";d=this.hEdit=d.insertRow();this.onBuildChange(d.insertCell());if(this.canZoom()){var f=d.insertCell();this.hZoom=RBuilder.appendIcon(f,"ctl.zooms");
f.width=16}f=d.insertCell();f.style.width="100%";d=this.hEdit=RBuilder.appendEdit(f,this.style("Edit"));this.attachEvent("onEditFocus",d,this.onEditFocus);this.attachEvent("onEditKeyPress",d,this.onEditKeyPress);this.attachEvent("onEditBlur",d,this.onEditBlur);this.attachEvent("onDataKeyUp",d,this.ohEditKeyUp);this.editLength&&(d.maxLength=this.editLength);this.buildAdjustForm(b.hDrop)},MO.FUiDataNumber2_setUnitIcon=function(b){this.hUnit.innerHTML="<IMG src="+b+">"},MO.FUiDataNumber2_onDataKeyDown=
function(b,d){this.canEdit&&(EKey.Up==d.keyCode?this.adjustValue(!0):EKey.Down==d.keyCode&&this.adjustValue(!1));this.base.FUiNumber2.onDataKeyDown.call(this,b,d)},MO.FUiDataNumber2_ohEditKeyUp=function(b,d){EKey.Up==d.keyCode&&this.canEdit?this.hUpIcon.src=this.styleIconPath("UpSelect"):EKey.Down==d.keyCode&&this.canEdit&&(this.hDownIcon.src=this.styleIconPath("DownSelect"))},MO.FUiDataNumber2_onEditKeyDown=function(b){this.canEdit&&(EKey.Up==b.keyCode?(b.source.hUpIcon.src=this.styleIconPath("up"),
this.changeValue(b,"Y")):EKey.Down==b.keyCode&&(b.source.hDownIcon.src=this.styleIconPath("down"),this.changeValue(b,"N")))},MO.FUiDataNumber2_onEditKeyUp=function(b){this.canEdit&&(EKey.Up==b.keyCode?b.source.hUpIcon.src=this.styleIconPath("upSelect"):EKey.Down==b.keyCode&&(b.source.hDownIcon.src=this.styleIconPath("downSelect")))},MO.FUiDataNumber2_onEditDoubleClick=function(){this.onListClick()},MO.FUiDataNumber2_validPattern=function(b){var d=!0;b=RString.nvl(b);if(!RRegExp.test(ERegExp.NUMBER,
b))return!1;var f=null;if(this.dataType){for(n in ERegExp)if(RString.equals(n,this.dataType)){f=ERegExp[n];break}RString.equals(RClass.name(f),"RegExp")&&(d=RRegExp.test(f,b)?d&1:d&0)}this.editMaxvalue&&(d=parseFloat(b)<=parseFloat(this.editMaxvalue)?d&1:d&0);this.editMinvalue&&(d=parseFloat(b)>=parseFloat(this.editMinvalue)?d&1:d&0);return d},MO.FUiDataNumber2_refreshStyle=function(){this.base.FUiNumber2.refreshStyle.call(this);this.hUpIcon.src=this.styleIconPath(this._hover?"UpSelect":"Up");this.hDownIcon.src=
this.styleIconPath(this._hover?"DownSelect":"Down")},MO.FUiDataNumber2_splitValue=function(b){b=RString.nvl(b.toString());var d=RString.findChars(b,"-"),f=RString.findChars(b,"%");b=RString.removeChars(b,"'");b=RString.removeChars(b," ");b=RString.removeChars(b,"%");b=RString.removeChars(b,"-");if(!RString.isEmpty(b)){for(var h="",q=0,w=b.length;-1<w;w--)h=0!=w&&0!=q&&0==q%3?"'"+b.charAt(w)+h:b.charAt(w)+h,q++;-1!=d&&(h="-"+h);-1!=f&&(h+="%");return h}return b},MO.FUiDataNumber2_removeSplit=function(b){b=
RString.nvl(b);b=RString.removeChars(b,"'");return b=RString.removeChars(b,"%")},MO.FUiDataNumber2_precisionValue=function(b){if(RString.isEmpty(b))return b;var d,f,h=RString.nvl(this.editPrecision);b=RString.nvl(b);RString.contains(h,".")?f=h.split(".")[1].length:d=h.length;if(RString.contains(b,"."))b=b.split("."),f&&(f>b[1].length?b[1]=RString.rpad(b[1],f-b[1].length,"0"):f<=b[1].length&&(b[1]=b[1].substring(0,f))),d&&(d>b[0].length?alert(d):d<b[0].length&&(b[0]=b[0].substring(0,b[0].length-d),
b[0]=RString.rpad(b[0],d,"0")),b[1]=null),b=b[1]?b[0]+"."+RString.nvl(b[1]):b[0];else{if(d)if(d<=b.length)for(b=b.substring(0,b.length-d+1),h=0;h<d-1;h++)b=b.concat("0");else d>b.length&&(b=0);if(f)for(b+=".",h=0;h<f;h++)b=b.concat("0")}return b},MO.FUiDataNumber2_dispose=function(){this.base.FUiNumber2.dispose.call(this);this.hChgIic=this.hDownIcon=this.hUpIcon=this.hLabel=null};
with(MO)MO.FUiDataNumber3=function(b){return b=RClass.inherits(this,b,FUiNumber3)},MO.FUiDataNumber3_onEditFocus=function(b){this.setText(this.formatValue(this.text()))},MO.FUiDataNumber3_onEditBlur=function(b){this.setText(this.formatText(this.text()))},MO.FUiDataNumber3_onBuildEdit=function(b){var d=RBuilder.appendTable(b.hPanel);d.style.tableLayout="fixed";d=this.hEdit=d.insertRow();this.onBuildChange(d.insertCell());if(this.canZoom()){var f=d.insertCell();this.hZoom=RBuilder.appendIcon(f,"ctl.zooms");
f.width=16}f=d.insertCell();f.style.width="100%";d=this.hEdit=RBuilder.appendEdit(f,this.style("Edit"));this.attachEvent("onEditFocus",d,this.onEditFocus);this.attachEvent("onEditKeyPress",d,this.onEditKeyPress);this.attachEvent("onEditBlur",d,this.onEditBlur);this.attachEvent("onDataKeyUp",d,this.ohEditKeyUp);this.editLength&&(d.maxLength=this.editLength);this.buildAdjustForm(b.hDrop)},MO.FUiDataNumber3_setUnitIcon=function(b){this.hUnit.innerHTML="<IMG src="+b+">"},MO.FUiDataNumber3_onDataKeyDown=
function(b,d){this.canEdit&&(EKey.Up==d.keyCode?this.adjustValue(!0):EKey.Down==d.keyCode&&this.adjustValue(!1));this.base.FUiNumber3.onDataKeyDown.call(this,b,d)},MO.FUiDataNumber3_ohEditKeyUp=function(b,d){EKey.Up==d.keyCode&&this.canEdit?this.hUpIcon.src=this.styleIconPath("UpSelect"):EKey.Down==d.keyCode&&this.canEdit&&(this.hDownIcon.src=this.styleIconPath("DownSelect"))},MO.FUiDataNumber3_onEditKeyDown=function(b){this.canEdit&&(EKey.Up==b.keyCode?(b.source.hUpIcon.src=this.styleIconPath("up"),
this.changeValue(b,"Y")):EKey.Down==b.keyCode&&(b.source.hDownIcon.src=this.styleIconPath("down"),this.changeValue(b,"N")))},MO.FUiDataNumber3_onEditKeyUp=function(b){this.canEdit&&(EKey.Up==b.keyCode?b.source.hUpIcon.src=this.styleIconPath("upSelect"):EKey.Down==b.keyCode&&(b.source.hDownIcon.src=this.styleIconPath("downSelect")))},MO.FUiDataNumber3_onEditDoubleClick=function(){this.onListClick()},MO.FUiDataNumber3_validPattern=function(b){var d=!0;b=RString.nvl(b);if(!RRegExp.test(ERegExp.NUMBER,
b))return!1;var f=null;if(this.dataType){for(n in ERegExp)if(RString.equals(n,this.dataType)){f=ERegExp[n];break}RString.equals(RClass.name(f),"RegExp")&&(d=RRegExp.test(f,b)?d&1:d&0)}this.editMaxvalue&&(d=parseFloat(b)<=parseFloat(this.editMaxvalue)?d&1:d&0);this.editMinvalue&&(d=parseFloat(b)>=parseFloat(this.editMinvalue)?d&1:d&0);return d},MO.FUiDataNumber3_refreshStyle=function(){this.base.FUiNumber3.refreshStyle.call(this);this.hUpIcon.src=this.styleIconPath(this._hover?"UpSelect":"Up");this.hDownIcon.src=
this.styleIconPath(this._hover?"DownSelect":"Down")},MO.FUiDataNumber3_splitValue=function(b){b=RString.nvl(b.toString());var d=RString.findChars(b,"-"),f=RString.findChars(b,"%");b=RString.removeChars(b,"'");b=RString.removeChars(b," ");b=RString.removeChars(b,"%");b=RString.removeChars(b,"-");if(!RString.isEmpty(b)){for(var h="",q=0,w=b.length;-1<w;w--)h=0!=w&&0!=q&&0==q%3?"'"+b.charAt(w)+h:b.charAt(w)+h,q++;-1!=d&&(h="-"+h);-1!=f&&(h+="%");return h}return b},MO.FUiDataNumber3_removeSplit=function(b){b=
RString.nvl(b);b=RString.removeChars(b,"'");return b=RString.removeChars(b,"%")},MO.FUiDataNumber3_precisionValue=function(b){if(RString.isEmpty(b))return b;var d,f,h=RString.nvl(this.editPrecision);b=RString.nvl(b);RString.contains(h,".")?f=h.split(".")[1].length:d=h.length;if(RString.contains(b,"."))b=b.split("."),f&&(f>b[1].length?b[1]=RString.rpad(b[1],f-b[1].length,"0"):f<=b[1].length&&(b[1]=b[1].substring(0,f))),d&&(d>b[0].length?alert(d):d<b[0].length&&(b[0]=b[0].substring(0,b[0].length-d),
b[0]=RString.rpad(b[0],d,"0")),b[1]=null),b=b[1]?b[0]+"."+RString.nvl(b[1]):b[0];else{if(d)if(d<=b.length)for(b=b.substring(0,b.length-d+1),h=0;h<d-1;h++)b=b.concat("0");else d>b.length&&(b=0);if(f)for(b+=".",h=0;h<f;h++)b=b.concat("0")}return b},MO.FUiDataNumber3_dispose=function(){this.base.FUiNumber3.dispose.call(this);this.hChgIic=this.hDownIcon=this.hUpIcon=this.hLabel=null};
with(MO)MO.FUiDataNumber4=function(b){return b=RClass.inherits(this,b,FUiNumber4)},MO.FUiDataNumber4_onEditFocus=function(b){this.setText(this.formatValue(this.text()))},MO.FUiDataNumber4_onEditBlur=function(b){this.setText(this.formatText(this.text()))},MO.FUiDataNumber4_onBuildEdit=function(b){var d=RBuilder.appendTable(b.hPanel);d.style.tableLayout="fixed";d=this.hEdit=d.insertRow();this.onBuildChange(d.insertCell());if(this.canZoom()){var f=d.insertCell();this.hZoom=RBuilder.appendIcon(f,"ctl.zooms");
f.width=16}f=d.insertCell();f.style.width="100%";d=this.hEdit=RBuilder.appendEdit(f,this.style("Edit"));this.attachEvent("onEditFocus",d,this.onEditFocus);this.attachEvent("onEditKeyPress",d,this.onEditKeyPress);this.attachEvent("onEditBlur",d,this.onEditBlur);this.attachEvent("onDataKeyUp",d,this.ohEditKeyUp);this.editLength&&(d.maxLength=this.editLength);this.buildAdjustForm(b.hDrop)},MO.FUiDataNumber4_setUnitIcon=function(b){this.hUnit.innerHTML="<IMG src="+b+">"},MO.FUiDataNumber4_onDataKeyDown=
function(b,d){this.canEdit&&(EKey.Up==d.keyCode?this.adjustValue(!0):EKey.Down==d.keyCode&&this.adjustValue(!1));this.base.FUiNumber4.onDataKeyDown.call(this,b,d)},MO.FUiDataNumber4_ohEditKeyUp=function(b,d){EKey.Up==d.keyCode&&this.canEdit?this.hUpIcon.src=this.styleIconPath("UpSelect"):EKey.Down==d.keyCode&&this.canEdit&&(this.hDownIcon.src=this.styleIconPath("DownSelect"))},MO.FUiDataNumber4_onEditKeyDown=function(b){this.canEdit&&(EKey.Up==b.keyCode?(b.source.hUpIcon.src=this.styleIconPath("up"),
this.changeValue(b,"Y")):EKey.Down==b.keyCode&&(b.source.hDownIcon.src=this.styleIconPath("down"),this.changeValue(b,"N")))},MO.FUiDataNumber4_onEditKeyUp=function(b){this.canEdit&&(EKey.Up==b.keyCode?b.source.hUpIcon.src=this.styleIconPath("upSelect"):EKey.Down==b.keyCode&&(b.source.hDownIcon.src=this.styleIconPath("downSelect")))},MO.FUiDataNumber4_onEditDoubleClick=function(){this.onListClick()},MO.FUiDataNumber4_validPattern=function(b){var d=!0;b=RString.nvl(b);if(!RRegExp.test(ERegExp.NUMBER,
b))return!1;var f=null;if(this.dataType){for(n in ERegExp)if(RString.equals(n,this.dataType)){f=ERegExp[n];break}RString.equals(RClass.name(f),"RegExp")&&(d=RRegExp.test(f,b)?d&1:d&0)}this.editMaxvalue&&(d=parseFloat(b)<=parseFloat(this.editMaxvalue)?d&1:d&0);this.editMinvalue&&(d=parseFloat(b)>=parseFloat(this.editMinvalue)?d&1:d&0);return d},MO.FUiDataNumber4_refreshStyle=function(){this.base.FUiNumber4.refreshStyle.call(this);this.hUpIcon.src=this.styleIconPath(this._hover?"UpSelect":"Up");this.hDownIcon.src=
this.styleIconPath(this._hover?"DownSelect":"Down")},MO.FUiDataNumber4_splitValue=function(b){b=RString.nvl(b.toString());var d=RString.findChars(b,"-"),f=RString.findChars(b,"%");b=RString.removeChars(b,"'");b=RString.removeChars(b," ");b=RString.removeChars(b,"%");b=RString.removeChars(b,"-");if(!RString.isEmpty(b)){for(var h="",q=0,w=b.length;-1<w;w--)h=0!=w&&0!=q&&0==q%3?"'"+b.charAt(w)+h:b.charAt(w)+h,q++;-1!=d&&(h="-"+h);-1!=f&&(h+="%");return h}return b},MO.FUiDataNumber4_removeSplit=function(b){b=
RString.nvl(b);b=RString.removeChars(b,"'");return b=RString.removeChars(b,"%")},MO.FUiDataNumber4_precisionValue=function(b){if(RString.isEmpty(b))return b;var d,f,h=RString.nvl(this.editPrecision);b=RString.nvl(b);RString.contains(h,".")?f=h.split(".")[1].length:d=h.length;if(RString.contains(b,"."))b=b.split("."),f&&(f>b[1].length?b[1]=RString.rpad(b[1],f-b[1].length,"0"):f<=b[1].length&&(b[1]=b[1].substring(0,f))),d&&(d>b[0].length?alert(d):d<b[0].length&&(b[0]=b[0].substring(0,b[0].length-d),
b[0]=RString.rpad(b[0],d,"0")),b[1]=null),b=b[1]?b[0]+"."+RString.nvl(b[1]):b[0];else{if(d)if(d<=b.length)for(b=b.substring(0,b.length-d+1),h=0;h<d-1;h++)b=b.concat("0");else d>b.length&&(b=0);if(f)for(b+=".",h=0;h<f;h++)b=b.concat("0")}return b},MO.FUiDataNumber4_dispose=function(){this.base.FUiNumber4.dispose.call(this);this.hChgIic=this.hDownIcon=this.hUpIcon=this.hLabel=null};with(MO)MO.FUiDataSelect=function(b){return b=RClass.inherits(this,b,FUiSelect,MUiDataField)};
with(MO)MO.FUiDataColumn=function(b){b=RClass.inherits(this,b,FControl,MDataField);b._displayList=!0;b._styleLabel=RClass.register(b,new AStyle("_styleLabel"));b._styleSearchPanel=RClass.register(b,new AStyle("_styleSearchPanel"));b._styleSearchEdit=RClass.register(b,new AStyle("_styleSearchEdit"));b._styleIconSortUp=RClass.register(b,new AStyleIcon("_styleIconSortUp"));b._styleIconSortDown=RClass.register(b,new AStyleIcon("_styleIconSortDown"));b._cellClass=FCell;b._hForm=null;b._hFormLine=null;
b._hIconPanel=null;b._hIcon=null;b._hLabel=null;b._hSortPanel=null;b._hSortUp=null;b._hSortDown=null;b._hSearchEditPanel=null;b._hSearchEdit=null;b.onBuildLabel=FUiDataColumn_onBuildLabel;b.onBuildSearchIcon=RMethod.empty;b.onBuildSearchEdit=FUiDataColumn_onBuildSearchEdit;b.onBuildSearchDrop=RMethod.empty;b.onBuildSearchForm=FUiDataColumn_onBuildSearchForm;b.onBuildSearch=FUiDataColumn_onBuildSearch;b.onBuildTotal=FUiDataColumn_onBuildTotal;b.onBuildPanel=FUiDataColumn_onBuildPanel;b.onBuild=FUiDataColumn_onBuild;
b.onSearchEnter=RClass.register(b,new AEventMouseEnter("onSearchEnter"));b.onSearchClick=RClass.register(b,new AEventClick("onSearchClick"));b.onSearchLeave=RClass.register(b,new AEventMouseLeave("onSearchLeave"));b.onSearchKeyDown=RClass.register(b,new AEventKeyDown("onSearchKeyDown"));b.createCell=FUiDataColumn_createCell;return b},MO.FUiDataColumn_onBuildLabel=function(b){b=this._hFormLine;if(this._icon){var d=this._hIconPanel=RBuilder.appendTableCell(b);this._hIcon=RBuilder.appendIcon(d,this.icon)}(this._hLabel=
RBuilder.appendTableCell(b)).innerHTML=RString.nvl(this.label());b=this._hSortPanel=RBuilder.appendTableCell(b);d=this._hSortUp=RBuilder.appendIcon(b,this.styleIcon("SortUp",FUiDataColumn));d.style.display="none";d=this._hSortDown=RBuilder.appendIcon(b,this.styleIcon("SortDown",FUiDataColumn));d.style.display="none"},MO.FUiDataColumn_onBuildSearchEdit=function(b){b=this._hSearchEditPanel=RBuilder.appendTableCell(this._hSearchFormLine,this.styleName("SearchPanel"));this._hSearchEdit=RBuilder.appendEdit(b,
this.styleName("SearchEdit"))},MO.FUiDataColumn_onBuildSearchForm=function(b){b=this._hSearchForm=RBuilder.appendTable(this._hSearchPanel);b.width="100%";b.style.backgroundColor="#FFFFFF";this._hSearchFormLine=b.insertRow();RClass.isClass(this,FUiDataColumnButton)?(this._hSearchPanel.style.backgroundColor="#EEEFF1",this._hSearchPanel.style.borderLeft="1 solid #808080",this._hSearchPanel.style.borderTop="1 solid #808080",this._hSearchPanel.style.borderBottom="1 solid #9EC4EB"):(this.onBuildSearchIcon(),
this.onBuildSearchEdit(),this.onBuildSearchDrop())},MO.FUiDataColumn_onBuildSearch=function(b){var d=this._hSearchPanel=RBuilder.create(b,"TD",this.styleName("SearchPanel"));d.style.backgroundColor="#FFFFFF";d.style.borderBottom="1 solid #9EC4EB";RHtml.linkSet(d,"control",this);this.attachEvent("onSearchEnter",d);this.attachEvent("onSearchLeave",d);this.onBuildSearchForm(b)},MO.FUiDataColumn_onBuildTotal=function(b){b=this._hTotalPanel=RBuilder.create(b,"TD");RHtml.linkSet(b,"control",this);b.align=
"right";b.style.color="#686860";b.style.backgroundColor="#F8F8F0";b.style.borderBottom="1 solid #B8B8B0";b.innerText=" "},MO.FUiDataColumn_onBuildPanel=function(b){this._hPanel=RBuilder.create(b,"TD",this.styleName("Label"))},MO.FUiDataColumn_onBuild=function(b){this._absEdit=this._editInsert||this._editUpdate||this._editDelete;this._absEdit||(RString.isEmpty(this._lovReference)?this._hasDropArea=!1:this._hasDropArea=!0);if(!RString.isEmpty(this._viewIcons)){var d=this.iconMap=new TAttributes;d.split(this._viewIcons.replace(/\n/g,
";"),"=",";");this.hasIconArea=0<d.count}this.__base.FControl.onBuild.call(this,b);d=this._hPanel;d.style.padding=4;d=this._hForm=RBuilder.appendTable(d);this._orderAble||(d.style.cursor="hand");this._hFormLine=RBuilder.appendTableRow(this._hForm);this.onBuildLabel(b);this.onBuildSearch(b);this.onBuildTotal(b);b=this._hFixPanel=RBuilder.create(b,"TD");b.height=1;b.bgColor="#FFFFFF";40>this._size.width&&(this._size.width=40);RHtml.setSize(b,this._size);this._hPanel.style.pixelWidth=this.width;this._hFixPanel.style.pixelWidth=
this.width},MO.FUiDataColumn_createCell=function(b){b=RClass.create(this._cellClass);var d=b._table=this._table;b._name=this._name;b._column=this;b.build(d._hPanel);b.setVisible(this._displayList);return b},MO.FUiDataColumn_onCellMouseEnter=function(b,d){this.table.hoverRow(b.row,!0)},MO.FUiDataColumn_onCellMouseLeave=function(b,d){this.table.hoverRow(b.row,!1)},MO.FUiDataColumn_onCellMouseDown=function(b,d){var f=b.table,h=b.row;f.__focusCell=b;f.selectRow(h,!d.ctrlKey,!0);f=RConsole.find(FFocusConsole).focusControl;
RClass.isClass(f,FDropEditor)&&f.source==b||RConsole.find(FFocusConsole).focus(b)},MO.FUiDataColumn_onCellClick=function(b,d){this.table.clickRow(b.row)},MO.FUiDataColumn_onCellDoubleClick=function(b,d){var f=b.row;this.isEditAble(f)||this.table.doubleClickRow(f)},MO.FUiDataColumn_onCellKeyDown=function(b,d,f){if(f)this.table.onCellKeyDown(b,d,f)},MO.FUiDataColumn_oeMode=function(b){if(b.isAfter()){var d=!1;this.inModeDisplay=d=EAction.Design==b.mode?this.dispDesign:this._displayList;this.setVisible(d)}return EEventStatus.Continue},
MO.FUiDataColumn_oeRefresh=function(b){b.isBefore()&&this.setVisible(this._displayList)},MO.FUiDataColumn_onDataKeyDown=function(b,d){this.__base.MEditDescriptor.onDataKeyDown.call(this,b,d)},MO.FUiDataColumn_onDataChanged=function(b,d){this.table.setDataStatus(b.row,EDataStatus.Update)},MO.FUiDataColumn_onEditBegin=function(b){var d=b.row;this.editor=b;this.table.editRow=d;this.table.editColumn=this;this.table.select(d,!0)},MO.FUiDataColumn_onEditEnd=function(b){b=editor.row;var d=editor.text();
this.setValue(b,this.formatValue(d));this.setText(b,d);this.table.setDataStatus(b,b.isChanged()?EDataStatus.Update:EDataStatus.Unknown);this.editor=null},MO.FUiDataColumn_onEditChanged=function(b){b.row.refresh()},MO.FUiDataColumn_onHeadMouseDown=function(b){var d=this.table,f=d.dsViewer.count,h=b.x;if(!RClass.isClass(this,FUiDataColumnButton)){var q=this._hPanel.offsetWidth-6;if(0<h&&h<q&&0<f&&!RClass.isClass(b.source,FUiDataColumnStatus)){f=d.columns;h=f.count;for(b=0;b<h;b++)q=f.value(b),q._hSortUp.style.display=
"none",q._hSortDown.style.display="none";d.dsOrders.clear();f=new TOrderItem;b=this.dataName;this.sortType?(f.set(b,EOrder.Desc),this._hSortUp.style.display="none",this._hSortDown.style.display="block"):(this._hSortUp.style.display="block",this._hSortDown.style.display="none",f.set(b,EOrder.Asc));this.sortType=!this.sortType;d.dsOrders.push(f);d.dsSearch()}}},MO.FUiDataColumn_onRowClick=function(b,d){RConsole.find(FListenerConsole).process(FGridControl,EGridAction.RowClick,b.row,b.row)},MO.FUiDataColumn_createMoveable=
function(b){b=this.cloneMove;b||(b=RClass.create(this.constructor),b.buildMode=EColumnMode.Drag,b.assign(this,EAssign.Property),b.build(),this.cloneMove=b);var d=this.panel(EPanel.Move),f=b.panel(EPanel.Move);RHtml.setPixelRect(f,RHtml.rect(d));f.className=b.styleName("DesignMove");f.style.pixelLeft=d.offsetLeft;b.show();return b},MO.FUiDataColumn_searchValue=function(){if(this._hSearchEdit)return this._hSearchEdit.value},MO.FUiDataColumn_setStyleStatus=function(b,d){var f=this.cell(b);if(f)switch(f=
f.style,d){case EStyle.Normal:b.isDelete()?f.backgroundColor=EColor.Delete:this.isEditAble(b)?f.backgroundColor=EColor.Edit:f.backgroundColor=EColor.Readonly;break;case EStyle.Select:b.isDelete()?f.backgroundColor=EColor.Select:(f.textDecoration="none",this.isEditAble(b)?f.backgroundColor=EColor.RowEditSelect:f.backgroundColor=EColor.Select);break;case EStyle.Delete:f.textDecoration="line-through",f.backgroundColor=EColor.Select}},MO.FUiDataColumn_cell=function(b){return b.cell(this.index)},MO.FUiDataColumn_equalsValue=
function(b,d){return RString.nvl(b).replace(/\n/g,"\\n").replace(/\r/g,"\\r")==RString.nvl(d).replace(/\n/g,"\\n").replace(/\r/g,"\\r")},MO.FUiDataColumn_setWidth=function(b){this._hPanel.style.pixelWidth=b;this._hFixPanel.style.pixelWidth=b},MO.FUiDataColumn_setVisible=function(b){b=(this.isDisplay=b)?"block":"none";this._hPanel.style.display=b;this._hSearchPanel.style.display=b;this._hTotalPanel.style.display=b;this._hFixPanel.style.display=b},MO.FUiDataColumn_moveCellFocus=function(b,d){var f=
this.table,h=null,q=null,w=null;if(EPosition.Top==d)h=this,(q=f.rows.get(f.rows.indexOf(b)-1))&&(w=q.cell(h.index));else if(EPosition.Bottom==d)h=this,(q=f.rows.get(f.rows.indexOf(b)+1))&&(w=q.cell(h.index));else if(EPosition.Before==d)for(var z=this.index-1,A=f.rows.indexOf(b);0<=A;A--){for(var B=f.rows.get(A);0<=z;z--){var C=f.columns.value(z);if(RClass.isClass(C,FUiDataColumn)&&C._displayList){h=C;q=B;w=q.cell(h.index);break}}if(h)break;z=f.columns.count-1}else if(EPosition.After==d)for(var z=
this.index+1,A=f.rows.indexOf(b),D=f.columns.count,E=f.rows.count;A<E;A++){for(B=f.rows.get(A);z<D;z++)if(C=f.columns.value(z),RClass.isClass(C,FUiDataColumn)&&C._displayList){h=C;q=B;w=q.cell(h.index);break}if(h)break;z=0}h&&q&&w&&(w.focus(!0),RConsole.find(FFocusConsole).focus(w))},MO.FUiDataColumn_getEditRange=function(){var b=this._hSearchPanel,d=RHtml.offsetPosition(b);return new TRange(d.x,d.y,b.offsetWidth,b.offsetHeight)},MO.FUiDataColumn_dispose=function(){this.__base.FControl.dispose.call(this);
RMemory.freeHtml(this._hSearchPanel);RMemory.freeHtml(this._hFixPanel);this._hFixPanel=this._hSearchDrop=this._hSearchDropPanel=this._hSearchEdit=this._hSearchEditPanel=this._hSearchIcon=this._hSearchIconPanel=this._hSearchFormLine=this._hSearchForm=this._hSearchPanel=this._hSortDown=this._hSortUp=this._hSortPanel=this._hLabel=this._hHeadPanel=this._hIcon=this._hIconPanel=this._hFormLine=this._hForm=null},MO.FUiDataColumn_dump=function(b){b=RString.nvlStr(b);b.append(RClass.dump(this),"[");b.append("name=",
this.name);b.appendIf(this.icon,",icon=",this.icon);b.appendIf(this.label,",label=",this.label);b.appendIf(this.align,",align=",this.align);b.appendIf(this.valign,",valign=",this.valign);b.appendIf(this.dataName,",dataName=",this.dataName);b.appendIf(this.dataDefault,",dataDefault=",this.dataDefault);b.appendIf(this.index,",index=",this.index);b.append("]");b.append(" [editAccess=");b.append(this.editInsert?"I":"_");b.append(this.editUpdate?"U":"_");b.append("]");return b};
with(MO)MO.FUiDataToolBar=function(b){return b=RClass.inherits(this,b,FUiToolBar)};with(MO)MO.FUiDataToolButton=function(b){b=RClass.inherits(this,b,FUiToolButton);b._serviceName=RClass.register(b,new APtyString("_serviceName"));return b},MO.FUiDataToolButton_click=function(){this.processClickListener(this)},MO.FUiDataToolButton_onShowHint=function(b){b.status=EActive.Finish;this.hintBox&&this.hintBox.show()};
with(MO)MO.FUiDataTreeView=function(b){b=RClass.inherits(this,b,FUiTreeView);b._serviceCode=RClass.register(b,new APtyString("_serviceCode","service"));b._statusLoading=!1;b.lsnsLoaded=new TListeners;b.lsnsNodeLoad=new TListeners;b.lsnsNodeLoaded=new TListeners;b.onLoaded=FUiDataTreeView_onLoaded;b.onNodeLoaded=FUiDataTreeView_onNodeLoaded;b.construct=FUiDataTreeView_construct;b.innerBuildNode=FUiDataTreeView_innerBuildNode;b.loadNode=FUiDataTreeView_loadNode;b.loadUrl=FUiDataTreeView_loadUrl;b.loadService=
FUiDataTreeView_loadService;b.dispose=FUiDataTreeView_dispose;return b},MO.FUiDataTreeView_onLoaded=function(b){var d=b.root;if(null==d)throw new TError(this,"Load tree data failure.");d=d.find("TreeView");RUiControl.build(this,d,null,this._hPanel);this.lsnsLoaded.process(b);(b=d.get("service"))&&this.loadService(b)},MO.FUiDataTreeView_onNodeLoaded=function(b){var d=b.root;if(!d)throw new TError(this,"Load tree data failure.");var f=b.connection.parentNode,h=this._loadingNode;h._hPanel.parentElement&&
this._hNodeRows.removeChild(h._hPanel);this._statusLoading=!1;this.innerBuildNode(f,d);this.lsnsNodeLoaded.process(b)},MO.FUiDataTreeView_construct=function(){this.__base.FUiTreeView.construct.call(this)},MO.FUiDataTreeView_innerBuildNode=function(b,d){var f=d._nodes;if(f)for(var h=f.count(),q=0;q<h;q++){var w=f.get(q);if(w.isName("TreeNode")){var z=this.createNode();z.loadConfig(w);b?b.push(z):this.push(z);this.appendNode(z,b);w.hasNode()&&(this.innerBuildNode(z,w),z.extend(!1))}}b&&b.calculateImage()},
MO.FUiDataTreeView_loadNode=function(b,d){this._statusLoading=!0;b.removeChildren();for(var f=null,h=b,q=this._serviceCode;RClass.isClass(h,FUiTreeNode);){if((f=h.type())&&f._service){q=f._service;break}h=h._parent}if(!q)throw new TError(this,"Unknown service code.");q=RUiService.parse(q);if(!q)throw new TError(this,"Unknown service.");for(h=b;RClass.isClass(A,FUiTreeNode)&&(!(f=h.type())||!f._action);)h=h._parent;var w=RString.nvl(f._action,q.action);if(!w)throw new TError(this,"Unknown service action.");
this.lsnsNodeLoad.process(this,b);var h=new TXmlDocument,z=h.root();z.set("action",w);z.set("type",f._linker);z.create("Attributes",this._attributes);for(var A=b;RClass.isClass(A,FUiTreeNode);)z=z.create("TreeNode"),A.propertySave(z),A=A._parent;b._extended=!0;b._child&&b._hImage&&(b._hImage.src=RResource.iconPath(this._iconMinus));f=this._loadingNode;A=b.searchLast()._hPanel.rowIndex;this._hNodeRows.appendChild(f._hPanel);RHtml.tableMoveRow(this._hNodeForm,f._hPanel.rowIndex,A+1);f.setLevel(b.level()+
1);q=RUiService.makeUrl(q.service,w);q=RConsole.find(FXmlConsole).sendAsync(q,h);q.parentNode=b;q.addLoadListener(this,this.onNodeLoaded)},MO.FUiDataTreeView_loadUrl=function(b,d){RConsole.find(FXmlConsole).sendAsync(b).addLoadListener(this,this.onLoaded)},MO.FUiDataTreeView_loadService=function(b,d){this.clear();b||(b=this._serviceCode);var f=RUiService.parse(b);if(!f)return alert("Unknown service");d=RObject.nvl(d,this._attributes);var h=new TXmlDocument,q=h.root();q.set("action",f.action);RConsole.find(FUiEnvironmentConsole).build(q);
d.isEmpty()||(RClass.isClass(d,TNode)&&xr.push(d),RClass.isClass(d,TAttributes)?(xr.create("Tree").attributes=d,xr.create("Attributes").attributes=d):(xr.create("Tree").value=d,xr.create("Attributes").value=d));this._focusNode=null;RConsole.find(FXmlConsole).sendAsync(f.url,h).addLoadListener(this,this.onNodeLoaded)},MO.FUiDataTreeView_dispose=function(){this.__base.FUiTreeView.dispose.call(this)},MO.FUiDataTreeView_load=function(b){this.loadService(this._serviceCode)},MO.FUiDataTreeView_reload=function(){this.clear();
this.loadUrl()},MO.FUiDataTreeView_loadNodeUrl=function(b,d){var f=RConsole.find(FXmlConsole).sendAsync(b);f.parentNode=RObject.nvl(d,this._focusNode);f.addLoadListener(this,this.onNodeLoaded)},MO.FUiDataTreeView_reloadService=function(b,d){this.clear();return this.loadService(b,d)},MO.FUiDataTreeView_loadNodeService=function(b,d){var f=RUiService.parse(RString.nvl(b,this._service));if(!f)throw new TError(this,"Unknown service.");var h=RObject.nvl(d,this._attributes),q=(new TXmlDocument).root();q.set("action",
f.action);h.isEmpty()||(RClass.isClass(h,TNode)&&q.push(attrs),RClass.isClass(h,TAttributes));f=RConsole.find(FXmlConsole).sendAsync(f.url,q);f.parentNode=this._focusNode;f.addLoadListener(this,this.onNodeLoaded)},MO.FUiDataTreeView_reloadNode=function(b){b=RObject.nvl(b,this._focusNode);if(!b)return this.reload();b.removeChildren();this.loadNode(b)},MO.FUiDataTreeView_onQueryLoaded=function(b){if((b=b.document)&&(b=b.root().find("TreeView"))&&b._nodes)for(var d=b._nodes.count,f=0;f<d;f++){var h=
b._nodes.get(f);if(h.isName("TreeNode")){var q=h.get("name");(q=this.findByName(q))&&q.loadQuery(h)}}},MO.FUiDataTreeView_doQuery=function(){var b=RUiService.parse(this._queryService);if(!b)return alert("Unknown query service");var d=new TXmlDocument,f=d.root();f.set("action",b.action);f.create("Attributes").attrs=this._attributes;f=new TEvent(this,EXmlEvent.Send,this.onQueryLoaded);f.url=b.url;f.document=d;RConsole.find(FXmlConsole).process(f)},MO.FUiDataTreeView_fetchExtendsAll=function(b){b&&RClass.isClass(b,
FUiTreeNode)&&(fmMain.target="frmMain",fmMain.form_search.value="",fmMain.form_order.value="",fmMain.form_values.value="",b=node.type.typeName,"table"==b||"form"==b?(fmMain.form_name.value=node.get("form"),fmMain.action=top.RContext.context("/ent/apl/logic/form/InnerForm.wa?do=update"),fmMain.submit()):"frameTree"==b&&(fmMain.action=top.RContext.context(node.get("redirect")),fmMain.submit()))};MO.EDsCanvasDrag=new function(){this.Unknown=0;this.X=1;this.Y=2;this.Z=3;this.All=4;return this};
MO.EDsCanvasMode=new function(){this.Unknown=0;this.Drop=1;this.Select=2;this.Translate=3;this.Rotation=4;this.Scale=5;return this};
MO.EDsFrame=new function(){this.CommonSpacePropertyFrame="resource.common.property.SpaceFrame";this.CommonTechniquePropertyFrame="resource.common.property.TechniqueFrame";this.CommonRegionPropertyFrame="resource.common.property.RegionFrame";this.CommonCameraPropertyFrame="resource.common.property.CameraFrame";this.CommonLightPropertyFrame="resource.common.property.LightFrame";this.CommonMaterialPropertyFrame="resource.common.property.MaterialFrame";this.CommonLayerPropertyFrame="resource.common.property.LayerFrame";
this.CommonDisplayPropertyFrame="resource.common.property.DisplayFrame";this.CommonAnimationPropertyFrame="resource.common.property.AnimationFrame";this.CommonMoviePropertyFrame="resource.common.property.MovieFrame";this.CommonRenderablePropertyFrame="resource.common.property.RenderableFrame";this.SolutionProjectPropertyFrame="resource.solution.property.ProjectFrame";this.ResourcePropertyFrame="resource.resource.property.SpaceFrame";this.BitmapPropertyFrame="resource.bitmap.property.Frame";this.MaterialPropertyFrame=
"resource.material.property.Frame";this.MeshSpacePropertyFrame="resource.mesh.property.SpaceFrame";this.MeshLayerPropertyFrame="resource.mesh.property.LayerFrame";this.MeshDisplayPropertyFrame="resource.mesh.property.DisplayFrame";this.MeshRenderablePropertyFrame="resource.mesh.property.RenderableFrame";this.ModelSpacePropertyFrame="resource.model.property.SpaceFrame";this.ModelLayerPropertyFrame="resource.model.property.LayerFrame";this.ModelDisplayPropertyFrame="resource.model.property.DisplayFrame";
this.ModelRenderablePropertyFrame="resource.model.property.RenderableFrame";this.SceneSpacePropertyFrame="resource.scene.property.SpaceFrame";this.SceneDisplayPropertyFrame="resource.scene.property.DisplayFrame";this.SceneMoviePropertyFrame="resource.scene.property.MovieFrame";this.SceneRenderablePropertyFrame="resource.scene.property.RenderableFrame";return this};
MO.EDsFrameSet=new function(){this.PrivateSolutionFrameSet="resource.private.solution.FrameSet";this.PrivateProjectFrameSet="resource.private.project.FrameSet";this.PrivateResourceFrameSet="resource.private.resource.FrameSet";this.PrivateBitmapFrameSet="resource.private.bitmap.FrameSet";this.PrivateMaterialFrameSet="resource.private.material.FrameSet";this.PrivateModelFrameSet="resource.private.model.FrameSet";this.PrivateTemplateFrameSet="resource.private.template.FrameSet";this.PrivateSceneFrameSet=
"resource.private.scene.FrameSet";this.ShareResourceFrameSet="resource.share.resource.FrameSet";this.ShareBitmapFrameSet="resource.share.bitmap.FrameSet";this.ShareMaterialFrameSet="resource.share.material.FrameSet";this.ShareModelFrameSet="resource.share.model.FrameSet";this.ShareTemplateFrameSet="resource.share.template.FrameSet";this.ShareSceneFrameSet="resource.share.scene.FrameSet";this.SystemDesignPersistenceFrameSet="system.design.persistence.FrameSet";this.SystemDesignListFrameSet="system.design.list.FrameSet";
this.SystemDesignTreeFrameSet="system.design.tree.FrameSet";this.SystemDesignFrameFrameSet="system.design.frame.FrameSet";return this};
with(MO)MO.MDsBoundBox=function(b){b=RClass.inherits(this,b);b._boundVisible=!1;b._boundBox=null;b.boundBox=MDsBoundBox_boundBox;b.showBoundBox=MDsBoundBox_showBoundBox;b.hideBoundBox=MDsBoundBox_hideBoundBox;return b},MO.MDsBoundBox_boundBox=function(){var b=this._boundBox;b||(b=this._boundBox=RClass.create(FE3dBoundBox),b.linkGraphicContext(this),b._drawable=this,b._parent=this,b.setup());return b},MO.MDsBoundBox_showBoundBox=function(){var b=this.boundBox(),d=this.resource().mesh().outline();b.outline().assign(d);
b.upload();this._boundVisible=!0},MO.MDsBoundBox_hideBoundBox=function(){this._boundVisible=!1};
with(MO)MO.FDsApplication=function(b){b=RClass.inherits(this,b,FObject);b._name=null;b._matrix=null;b._location=null;b._rotation=null;b._scale=null;b._visible=!0;b._renderables=null;b.construct=FDsApplication_construct;b.isName=FDsApplication_isName;b.name=FDsApplication_name;b.matrix=FDsApplication_matrix;b.location=FDsApplication_location;b.rotation=FDsApplication_rotation;b.scale=FDsApplication_scale;b.hasRenderable=FDsApplication_hasRenderable;b.filterRenderables=FDsApplication_filterRenderables;
b.renderables=FDsApplication_renderables;b.pushRenderable=FDsApplication_pushRenderable;b.process=FDsApplication_process;b.update=FDsApplication_update;b.dispose=FDsApplication_dispose;return b},MO.FDsApplication_construct=function(){this.__base.FObject.construct.call(this);this._matrix=new SMatrix3d;this._location=new SPoint3;this._rotation=new SVector3;this._scale=new SVector3;this._scale.set(1,1,1)},MO.FDsApplication_isName=function(b){return this._name==b},MO.FDsApplication_name=function(){return this._name},
MO.FDsApplication_matrix=function(){return this._matrix},MO.FDsApplication_location=function(){return this._location},MO.FDsApplication_rotation=function(){return this._rotation},MO.FDsApplication_scale=function(){return this._scale},MO.FDsApplication_hasRenderable=function(){var b=this._renderables;return null!=b?!b.isEmpty():!1},MO.FDsApplication_filterRenderables=function(b){if(!this._visible)return!1;var d=this._renderables;if(null!=d)for(var f=d.count(),h=0;h<f;h++){var q=d.get(h);q.testVisible()&&
b.pushRenderable(q)}return!0},MO.FDsApplication_renderables=function(){var b=this._renderables;null==b&&(b=this._renderables=new TObjects);return b},MO.FDsApplication_pushRenderable=function(b){this.renderables().push(b)},MO.FDsApplication_update=function(){var b=this._matrix;b.set(this._location,this._rotation,this._scale);b.update()},MO.FDsApplication_process=function(){var b=this._renderables;if(null!=b)for(var d=b.count(),f=0;f<d;f++)b.get(f).process()},MO.FDsApplication_dispose=function(){this._scale=
this._direction=this._position=this._matrix=null;var b=this._renderables;null!=b&&(b.dispose(),this._renderables=null);this.__base.FObject.dispose.call(this)};
with(MO)MO.FDsBitmapCanvas=function(b){b=RClass.inherits(this,b,FDsCanvas);b._activeBitmap=null;b._capturePosition=null;b._captureMatrix=null;b._templateMatrix=null;b._templateRenderable=null;b._templateFace=null;b._templateTranslation=null;b._templateRotation=null;b._templateScale=null;b._templateViewScale=.05;b.onBuild=FDsBitmapCanvas_onBuild;b.onMouseCaptureStart=FDsBitmapCanvas_onMouseCaptureStart;b.onMouseCapture=FDsBitmapCanvas_onMouseCapture;b.onMouseCaptureStop=FDsBitmapCanvas_onMouseCaptureStop;
b.onMouseWheel=FDsBitmapCanvas_onMouseWheel;b.onLoaded=FDsBitmapCanvas_onLoaded;b.oeResize=FDsBitmapCanvas_oeResize;b.oeRefresh=FDsBitmapCanvas_oeRefresh;b.construct=FDsBitmapCanvas_construct;b.loadByGuid=FDsBitmapCanvas_loadByGuid;b.dispose=FDsBitmapCanvas_dispose;return b},MO.FDsBitmapCanvas_onBuild=function(b){this.__base.FDsCanvas.onBuild.call(this,b);b=this._hPanel;var d=this._activeSpace=RClass.create(FE3dFlatStage);d.linkGraphicContext(this);d.selectTechnique(this,FE3dGeneralTechnique);d.region().backgroundColor().set(1,
1,1,1);d.region().linkGraphicContext(this);RStage.register("space.bitmap",d);d=d.camera();d.setPosition(0,0,-10);d.lookAt(0,0,0);d.update();d=d.projection();d._angle=45;d.size().set(b.width,b.height);d.update();RWindow.lsnsMouseWheel.register(this,this.onMouseWheel)},MO.FDsBitmapCanvas_onMouseCaptureStart=function(b){if(this._activeSpace){var d=this._activeBitmap;d&&(this._capturePosition.set(b.clientX,b.clientY),this._captureMatrix.assign(d.matrix()),RHtml.cursorSet(this._hPanel,EUiCursor.Pointer))}},
MO.FDsBitmapCanvas_onMouseCapture=function(b){if(this._activeSpace){var d=this._activeBitmap;if(d){var d=d.matrix(),f=b.clientY-this._capturePosition.y,h=this._captureMatrix;d.tx=h.tx+(b.clientX-this._capturePosition.x);d.ty=h.ty+f;d.updateForce()}}},MO.FDsBitmapCanvas_onMouseCaptureStop=function(b){RHtml.cursorSet(this._hPanel,EUiCursor.Auto)},MO.FDsBitmapCanvas_onMouseWheel=function(b){var d=this._activeBitmap;if(d){var f=1;0>b.deltaY?f=1.1:0<b.deltaY&&(f=.9);b=d.matrix();b.sx*=f;b.sy*=f;b.updateForce()}},
MO.FDsBitmapCanvas_onLoaded=function(b){RConsole.find(FUiDesktopConsole).hide()},MO.FDsBitmapCanvas_oeResize=function(b){this.__base.FDsCanvas.oeResize.call(this,b);return EEventStatus.Stop},MO.FDsBitmapCanvas_oeRefresh=function(b){return EEventStatus.Stop},MO.FDsBitmapCanvas_construct=function(){this.__base.FDsCanvas.construct.call(this);this._captureMatrix=new SMatrix3d},MO.FDsBitmapCanvas_loadByGuid=function(b){var d=this._graphicContext.size();RConsole.find(FUiDesktopConsole).showLoading();var f=
this._activeResource=RConsole.find(FDrBitmapConsole).query(b),h="/cloud.resource.bitmap.wv?do=view&guid="+b;b=this._activeBitmap=RConsole.find(FE3dBitmapConsole).loadByGuid(this,b);b.material().info().effectCode="flat";b.setLoadListener(this,this.onLoaded);b.loadUrl(h);var h=b.matrix(),q=Math.max((d.width-f.sizeWidth())/2,0),d=Math.max((d.height-f.sizeHeight())/2,0);h.setTranslate(q,d);h.setScale(f.sizeWidth(),f.sizeHeight());h.update();f=this._activeSpace.layer();f.clearRenderables();f.pushRenderable(b)},
MO.FDsBitmapCanvas_dispose=function(){this.__base.FDsCanvas.dispose.call(this)};
MO.FDsCanvas=function(b){b=MO.Class.inherits(this,b,MO.FDuiCanvas,MO.MGraphicObject,MO.MListenerLoad,MO.MMouseCapture);b._servicePreview="cloud.resource.preview";b._resourceTypeCd=null;b._optionRotation=!1;b._activeSpace=null;b._canvasModeCd=MO.EDsCanvasMode.Drop;b._canvasMoveCd=MO.EDsCanvasDrag.Unknown;b._switchWidth="*";b._switchHeight="*";b._capturePosition=null;b._captureMatrix=null;b._captureRotation=null;b._cameraMoveRate=8;b._cameraKeyRotation=3;b._cameraMouseRotation=.005;b._dimensional=null;
b._rotation=null;b.onBuild=MO.FDsCanvas_onBuild;b.onMouseCaptureStart=MO.FDsCanvas_onMouseCaptureStart;b.onMouseCapture=MO.FDsCanvas_onMouseCapture;b.onMouseCaptureStop=MO.FDsCanvas_onMouseCaptureStop;b.onEnterFrame=MO.FDsCanvas_onEnterFrame;b.oeResize=MO.FDsCanvas_oeResize;b.oeRefresh=MO.FDsCanvas_oeRefresh;b.construct=MO.FDsCanvas_construct;b.activeSpace=MO.FDsCanvas_activeSpace;b.switchSize=MO.FDsCanvas_switchSize;b.switchRotation=MO.FDsCanvas_switchRotation;b.reloadRegion=MO.FDsCanvas_reloadRegion;
b.capture=MO.FDsCanvas_capture;b.dispose=MO.FDsCanvas_dispose;return b};MO.FDsCanvas_onBuild=function(b){this.__base.FDuiCanvas.onBuild.call(this,b);b=this._hPanel;b.__linker=this;b.style.width="100%";b.style.height="100%";b=this._graphicContext=MO.REngine3d.createContext(MO.FWglContext,b,{alpha:!1,antialias:!0});var d=this._dimensional=MO.Class.create(MO.FE3dDimensional);d.linkGraphicContext(b);d.setup();MO.RStage.lsnsEnterFrame.register(this,this.onEnterFrame);MO.RStage.start(1E3/60);MO.Console.find(MO.FMouseConsole).register(this)};
MO.FDsCanvas_onMouseCaptureStart=function(b){var d=this._activeSpace;d&&(d=d.camera(),this._capturePosition.set(b.clientX,b.clientY),this._captureRotation.assign(d._rotation),MO.RHtml.cursorSet(this._hPanel,MO.EUiCursor.Pointer))};
MO.FDsCanvas_onMouseCapture=function(b){var d=this._activeSpace;if(d){var f=d.camera(),d=b.clientX-this._capturePosition.x;b=b.clientY-this._capturePosition.y;switch(this._frameSet._canvasToolBar._canvasModeCd){case EDsCanvasMode.Drop:var f=f.rotation(),h=this._captureRotation;f.x=h.x-b*this._cameraMouseRotation;f.y=h.y-d*this._cameraMouseRotation}}};MO.FDsCanvas_onMouseCaptureStop=function(b){MO.RHtml.cursorSet(this._hPanel,EUiCursor.Auto)};
MO.FDsCanvas_onEnterFrame=function(){var b=this._activeSpace;if(b){var d=b.camera(),f=b.timer().spanSecond(),h=this._cameraMoveRate*f,f=this._cameraKeyRotation*f,q=MO.Window.Keyboard.isPress(MO.EStageKey.Forward),w=MO.Window.Keyboard.isPress(MO.EStageKey.Back);q&&!w&&d.doWalk(h);!q&&w&&d.doWalk(-h);w=MO.Window.Keyboard.isPress(MO.EStageKey.Up);q=MO.Window.Keyboard.isPress(MO.EStageKey.Down);w&&!q&&d.doFly(h);!w&&q&&d.doFly(-h);h=MO.Window.Keyboard.isPress(MO.EStageKey.RotationLeft);q=MO.Window.Keyboard.isPress(MO.EStageKey.RotationRight);
h&&!q&&d.doYaw(f);!h&&q&&d.doYaw(-f);h=MO.Window.Keyboard.isPress(MO.EStageKey.RotationUp);q=MO.Window.Keyboard.isPress(MO.EStageKey.RotationDown);h&&!q&&d.doPitch(f);!h&&q&&d.doPitch(-f);d.update();if(this._optionRotation){d=this._rotation;b=b.layers();f=b.count();for(h=0;h<f;h++)q=b.at(h).matrix(),q.setRotation(0,d.y,0),q.update();d.y+=.01}}};
MO.FDsCanvas_oeResize=function(b){this.__base.FDuiCanvas.oeResize.call(this,b);b=this._hPanel;var d=b.offsetWidth,f=b.offsetHeight-6;b.width=d;b.height=f;this._graphicContext.setViewport(0,0,d,f);return MO.EEventStatus.Stop};MO.FDsCanvas_oeRefresh=function(b){return MO.EEventStatus.Stop};MO.FDsCanvas_construct=function(){this.__base.FDuiCanvas.construct.call(this);this._capturePosition=new MO.SPoint2;this._captureMatrix=new MO.SMatrix3d;this._rotation=new MO.SVector3;this._captureRotation=new MO.SVector3};
MO.FDsCanvas_activeSpace=function(){return this._activeSpace};MO.FDsCanvas_switchSize=function(b,d){this._switchWidth=b;this._switchHeight=d;var f=this._hPanel,h=this._hParent;"*"==b&&(b=h.offsetWidth);"*"==d&&(d=h.offsetHeight);f.width=b;f.style.width=b+"px";f.height=d;f.style.height=d+"px";this._graphicContext.setViewport(0,0,b,d);if(f=this._activeSpace)f=f.camera().projection(),f.size().set(b,d),f.update()};MO.FDsCanvas_switchRotation=function(b){this._optionRotation=b};
MO.FDsCanvas_reloadRegion=function(){var b=this._activeSpace.region().resource();this._cameraMoveRate=b.moveSpeed();this._cameraKeyRotation=b.rotationKeySpeed();this._cameraMouseRotation=b.rotationMouseSpeed()};
MO.FDsCanvas_capture=function(){var b=this._activeSpace.resource().guid(),d=this._switchWidth,f=this._switchHeight;this.switchSize(200,150);MO.RStage.process();var h=this._graphicContext,q=h.size(),w=q.width,q=q.height,h=h.readPixels(0,0,w,q);this.switchSize(d,f);MO.RStage.process();b="/"+this._servicePreview+".wv?do=upload&type_cd="+this._resourceTypeCd+"&guid="+b+"&width="+w+"&height="+q;return MO.Console.find(MO.FHttpConsole).send(b,h.buffer)};
MO.FDsCanvas_dispose=function(){this._rotation=MO.Lang.Object.dispose(this._rotation);this.__base.FDuiCanvas.dispose.call(this)};
with(MO)MO.FDsCatalog=function(b){b=RClass.inherits(this,b,FUiDataTreeView,MListenerSelected);b._iconView="resource.scene.view";b._iconViewNot="resource.scene.viewno";b._displayNodes=null;b._renderableNodes=null;b._materialNodes=null;b.onBuild=FDsCatalog_onBuild;b.onLoadDisplay=FDsCatalog_onLoadDisplay;b.onNodeClick=FDsCatalog_onNodeClick;b.onNodeViewClick=FDsCatalog_onNodeViewClick;b.onNodeViewDoubleClick=FDsCatalog_onNodeViewDoubleClick;b.construct=FDsCatalog_construct;b.buildNodeView=FDsCatalog_buildNodeView;
b.buildTechnique=FDsCatalog_buildTechnique;b.buildRegion=FDsCatalog_buildRegion;b.buildRenderable=FDsCatalog_buildRenderable;b.buildDisplay=FDsCatalog_buildDisplay;b.buildLayer=FDsCatalog_buildLayer;b.buildSpace=FDsCatalog_buildSpace;b.selectObject=FDsCatalog_selectObject;b.showObject=FDsCatalog_showObject;b.dispose=FDsCatalog_dispose;return b},MO.FDsCatalog_onBuild=function(b){this.__base.FUiDataTreeView.onBuild.call(this,b);this.addNodeClickListener(this,this.onNodeClick)},MO.FDsCatalog_onLoadDisplay=
function(b){this.buildRenderable(b._linkNode,b)},MO.FDsCatalog_onNodeClick=function(b){(b=b.node.dataPropertyGet("linker"))&&this.selectObject(b)},MO.FDsCatalog_onNodeViewClick=function(b){var d=b.treeNodeCell,f=b.treeNode.dataPropertyGet("linker");if(RClass.isClass(f,FDisplay))if(b.ctrlKey){for(var h=this._displayNodes,q=h.count(),w=0;w<q;w++){var z=h.at(w);z.dataPropertyGet("linker")._visible=!1;z.cell("view").setIcon(this._iconViewNot)}f.setVisible(!0);d.setIcon(this._iconView)}else f.setVisible(!f.visible()),
d.setIcon(f.visible()?this._iconView:this._iconViewNot);if(RClass.isClass(f,FDrawable))if(b.ctrlKey){h=this._renderableNodes;q=h.count();for(w=0;w<q;w++)z=h.at(w),z.dataPropertyGet("linker")._visible=!1,z.cell("view").setIcon(this._iconViewNot);f.setVisible(!0);d.setIcon(this._iconView)}else f.setVisible(!f.visible()),d.setIcon(f.visible()?this._iconView:this._iconViewNot);if(RClass.isClass(f,FG3dMaterial))if(b.ctrlKey){b=this._materialNodes;h=b.count();for(w=0;w<h;w++)q=b.at(w),q.dataPropertyGet("linker").setVisible(!1),
q.cell("view").setIcon(this._iconViewNot);f.setVisible(!0);d.setIcon(this._iconView)}else f.setVisible(!f.visible()),d.setIcon(f.visible()?this._iconView:this._iconViewNot)},MO.FDsCatalog_onNodeViewDoubleClick=function(b){var d=b.treeNode.dataPropertyGet("linker");if(RClass.isClass(d,FDisplay)){var f=this._displayNodes,h=f.count();for(b=0;b<h;b++){var q=f.at(b);q.dataPropertyGet("linker").setVisible(!0);q.cell("view").setIcon(this._iconView)}}if(RClass.isClass(d,FDrawable))for(f=this._renderableNodes,
h=f.count(),b=0;b<h;b++)q=f.at(b),q.dataPropertyGet("linker").setVisible(!0),q.cell("view").setIcon(this._iconView);if(RClass.isClass(d,FG3dMaterial))for(d=this._materialNodes,f=d.count(),b=0;b<f;b++)h=d.at(b),h.dataPropertyGet("linker").setVisible(!0),h.cell("view").setIcon(this._iconView)},MO.FDsCatalog_construct=function(){this.__base.FUiDataTreeView.construct.call(this);this._displayNodes=new TObjects;this._renderableNodes=new TObjects;this._materialNodes=new TObjects},MO.FDsCatalog_buildNodeView=
function(b,d){var f=b.cell("view");f.setIcon(this._iconView);f.addClickListener(this,this.onNodeViewClick);f.addDoubleClickListener(this,this.onNodeViewDoubleClick)},MO.FDsCatalog_buildTechnique=function(b,d){var f=this.createNode();f.setTypeCode("technique");f.setLabel("Technique");f.dataPropertySet("linker",d);b.appendNode(f)},MO.FDsCatalog_buildRegion=function(b,d){var f=this.createNode();f.setTypeCode("Region");f.setLabel("Region");f.dataPropertySet("linker",d);b.appendNode(f);var h=this.createNode();
h.setTypeCode("Camera");h.setLabel("Camera");h.dataPropertySet("linker",d.camera());f.appendNode(h);h=this.createNode();h.setTypeCode("Light");h.setLabel("Light");h.dataPropertySet("linker",d.directionalLight());f.appendNode(h)},MO.FDsCatalog_buildRenderable=function(b,d){var f=d.materials();if(f)for(var h=f.count(),q=0;q<h;q++){var w=f.value(q),z=w.resource(),A=this.createNode();A.setLabel(z.code());A.setNote(z.label());A.setTypeCode("material");A.dataPropertySet("linker",w);this.buildNodeView(A,
!0);this._materialNodes.push(A);b.appendNode(A)}if(f=d.animations())for(h=f.count(),q=0;q<h;q++)w=f.value(q),z=w.resource(),A=this.createNode(),A.setLabel(z.code()),A.setNote(z.label()),A.setTypeCode("animation"),A.dataPropertySet("linker",w),this.buildNodeView(A,!0),b.appendNode(A);if(f=d.meshRenderables())for(h=f.count(),q=0;q<h;q++)w=f.get(q),A=w.resource(),A.model(),z=A.mesh(),A=this.createNode(),A.setLabel(z.code()),A.setTypeCode("renderable"),A.dataPropertySet("linker",w),this.buildNodeView(A,
!0),this._renderableNodes.push(A),b.appendNode(A)},MO.FDsCatalog_buildDisplay=function(b,d){var f=d.displays();if(f)for(var h=f.count(),q=0;q<h;q++){var w=f.get(q),z=w.resourceScene(),A=this.createNode();A.setLabel(z.code());A.setNote(z.label());A.setTypeCode("display");A.dataPropertySet("linker",w);this.buildNodeView(A,!0);this._displayNodes.push(A);b.appendNode(A);w.addLoadListener(this,this.onLoadDisplay);w._linkNode=A}},MO.FDsCatalog_buildLayer=function(b,d){var f=this.createNode();f.setLabel("Layers");
f.setTypeCode("layers");f.dataPropertySet("linker","layers");this.buildNodeView(f,!0);b.appendNode(f);for(var h=d.layers(),q=h.count(),w=0;w<q;w++){var z=h.value(w);if(!RClass.isClass(z,FDisplayUiLayer)){var A=z.resource(),B=this.createNode();B.setLabel("Layer:"+A.code());B.setTypeCode("layer");B.dataPropertySet("linker",z);this.buildNodeView(B,!0);f.appendNode(B);this.buildDisplay(B,z)}}},MO.FDsCatalog_buildSpace=function(b){var d=b._resource,f=this.createNode();f.setLabel(d.code());f.setNote(d.label());
f.setTypeCode("scene");f.dataPropertySet("linker",b);this.appendNode(f);this.buildTechnique(f,b.technique());this.buildRegion(f,b.region());this.buildLayer(f,b);f.click()},MO.FDsCatalog_selectObject=function(b){b&&this.processSelectedListener(b,!0)},MO.FDsCatalog_showObject=function(b){if(RClass.isClass(b,FDsSceneRenderable))for(var d=this._renderableNodes,f=d.count(),h=0;h<f;h++)d.at(h).dataPropertyGet("linker")==b&&this.processSelectedListener(b,!1)},MO.FDsCatalog_dispose=function(){this._displayNodes=
RObject.dispose(this._displayNodes);this._renderableNodes=RObject.dispose(this._renderableNodes);this._materialNodes=RObject.dispose(this._materialNodes);this.__base.FUiDataTreeView.dispose.call(this)};
with(MO)MO.FDsFrameSet=function(b){b=RClass.inherits(this,b,FUiFrameSet);b._styleToolBarGround=RClass.register(b,new AStyle("_styleToolBarGround","ToolBar_Ground"));b._styleCatalogContent=RClass.register(b,new AStyle("_styleCatalogContent","Catalog_Content"));b._styleCanvasContent=RClass.register(b,new AStyle("_styleCanvasContent","Canvas_Content"));b._stylePropertyContent=RClass.register(b,new AStyle("_stylePropertyContent","Property_Content"));b._activeGuid=null;b._activeCode=null;b._activeSpace=
null;b._propertyFrames=null;b.construct=FDsFrameSet_construct;b.findPropertyFrame=FDsFrameSet_findPropertyFrame;b.propertyFrames=FDsFrameSet_propertyFrames;b.hidePropertyFrames=FDsFrameSet_hidePropertyFrames;b.dispose=FDsFrameSet_dispose;return b},MO.FDsFrameSet_construct=function(){this.__base.FUiFrameSet.construct.call(this);this._propertyFrames=new TDictionary},MO.FDsFrameSet_findPropertyFrame=function(b){var d=this._propertyFrames.get(b);d||(d=RConsole.find(FUiFrameConsole).get(this,b,this._framePropertyContent._hContainer),
d._frameSet=this,this._propertyFrames.set(b,d));return d},MO.FDsFrameSet_propertyFrames=function(){return this._propertyFrames},MO.FDsFrameSet_hidePropertyFrames=function(){for(var b=this._propertyFrames,d=b.count(),f=0;f<d;f++)b.at(f).hide()},MO.FDsFrameSet_dispose=function(){this._activeSpace=null;for(var b=this._propertyFrames,d=b.count(),f=0;f<d;f++)b.at(f).dispose();this._propertyFrames=RObject.dispose(this._propertyFrames);this.__base.FUiFrameSet.dispose.call(this)};
with(MO)MO.FDsMainCanvas=function(b){b=RClass.inherits(this,b,FCanvas);b._context=null;b._stage=null;b._layer=null;b._activeModel=null;b._rotationX=0;b._rotationY=0;b._rotationZ=0;b.onBuild=FDsMainCanvas_onBuild;b.onEnterFrame=FDsMainCanvas_onEnterFrame;b.onThemeLoad=FDsMainCanvas_onThemeLoad;b.oeRefresh=FDsMainCanvas_oeRefresh;b.construct=FDsMainCanvas_construct;b.selectModel=FDsMainCanvas_selectModel;b.dispose=FDsMainCanvas_dispose;return b},MO.FDsMainCanvas_onEnterFrame=function(){var b=this._activeModel;
b&&(b.location().set(0,-6,0),b.rotation().set(0,this._rotationY,0),b.scale().set(2,2,2),b.update(),this._rotationX+=.01,this._rotationY+=.01,this._rotationZ+=.03)},MO.FDsMainCanvas_onThemeLoad=function(){var b=this._hPanel;b.width=this._hParent.offsetWidth;b.height=this._hParent.offsetHeight;this._context=REngine3d.createContext(FWglContext,b);var d=this._stage=RClass.create(FSimpleStage3d);d.backgroundColor().set(.5,.5,.5,1);d.selectTechnique(this._context,FG3dGeneralTechnique);this._layer=this._stage.spriteLayer();
RStage.register("stage3d",this._stage);d=this._stage.camera();d.setPosition(0,3,-20);d.lookAt(0,0,0);d.update();this._stage.directionalLight().direction().set(.7,-.7,0);d=this._stage.camera().projection();d.size().set(b.width,b.height);d.update();RStage.lsnsEnterFrame.register(this,this.onEnterFrame);RStage.start()},MO.FDsMainCanvas_onBuild=function(b){this.__base.FCanvas.onBuild.call(this,b);RConsole.find(FE3sThemeConsole).select("color").loadListener().register(this,this.onThemeLoad)},MO.FDsMainCanvas_oeRefresh=
function(b){this.__base.FCanvas.oeRefresh.call(this,b);return EEventStatus.Stop},MO.FDsMainCanvas_construct=function(){this.__base.FCanvas.construct.call(this)},MO.FDsMainCanvas_selectModel=function(b){var d=RConsole.find(FModel3dConsole);null!=this._activeModel&&d.free(this._activeModel);b=d.alloc(this._context,b);this._layer.pushDisplay(b);this._activeModel=b},MO.FDsMainCanvas_dispose=function(){this.__base.FCanvas.dispose.call(this)};
with(MO)MO.FDsMainCatalog=function(b){b=RClass.inherits(this,b,FDataTreeView);b.onBuild=FDsMainCatalog_onBuild;b.onNodeClick=FDsMainCatalog_onNodeClick;b.construct=FDsMainCatalog_construct;b.dispose=FDsMainCatalog_dispose;return b},MO.FDsMainCatalog_onBuild=function(b){this.__base.FDataTreeView.onBuild.call(this,b);this.lsnsClick.register(this,this.onNodeClick)},MO.FDsMainCatalog_onNodeClick=function(b,d){this._worksapce._canvas.selectModel(d.name())},MO.FDsMainCatalog_construct=function(){this.__base.FDataTreeView.construct.call(this)},
MO.FDsMainCatalog_dispose=function(){this.__base.FDataTreeView.dispose.call(this)};
with(MO)MO.FDsMainMenuBar=function(b){b=RClass.inherits(this,b,FMenuBar);b.onBuild=FDsMainMenuBar_onBuild;b.construct=FDsMainMenuBar_construct;b.dispose=FDsMainMenuBar_dispose;return b},MO.FDsMainMenuBar_onBuild=function(b){this.__base.FMenuBar.onBuild.call(this,b);var d=this._framesetMain=RClass.create(FMenuButton);d.setLabel("\u6587\u4ef6");d.setIcon("design.menu.build");d.build(b);this.appendButton(d);d=this._framesetMain=RClass.create(FMenuButton);d.setLabel("\u4fdd\u5b58");d.setIcon("design.menu.save");
d.build(b);this.appendButton(d);d=this._framesetMain=RClass.create(FMenuButton);d.setLabel("\u5e2e\u52a9");d.setIcon("design.menu.help");d.build(b);this.appendButton(d)},MO.FDsMainMenuBar_construct=function(){this.__base.FMenuBar.construct.call(this)},MO.FDsMainMenuBar_dispose=function(){this.__base.FMenuBar.dispose.call(this)};
with(MO)MO.FDsMainToolBar=function(b){b=RClass.inherits(this,b,FToolBar);b.onPersistenceClick=FDsMainToolBar_onPersistenceClick;b.onBuild=FDsMainToolBar_onBuild;b.construct=FDsMainToolBar_construct;b.dispose=FDsMainToolBar_dispose;return b},MO.FDsMainToolBar_onPersistenceClick=function(b){this._worksapce._catalog.loadUrl("/cloud.describe.tree.ws?action=query&code=resource3d.model")},MO.FDsMainToolBar_onBuild=function(b){this.__base.FToolBar.onBuild.call(this,b);var d=this._persistenceButton=RClass.create(FToolButton);
d.setLabel("\u6a21\u578b\u7ba1\u7406");d.build(b);d.lsnsClick.register(this,this.onPersistenceClick);this.appendButton(d);d=this._framesetMain=RClass.create(FToolButton);d.setLabel("\u6750\u8d28\u7ba1\u7406");d.build(b);this.appendButton(d);d=this._framesetMain=RClass.create(FToolButton);d.setLabel("\u6a21\u677f\u7ba1\u7406");d.build(b);this.appendButton(d);d=this._framesetMain=RClass.create(FToolButton);d.setLabel("\u573a\u666f\u7ba1\u7406");d.build(b);this.appendButton(d)},MO.FDsMainToolBar_construct=
function(){this.__base.FToolBar.construct.call(this)},MO.FDsMainToolBar_dispose=function(){this.__base.FToolBar.dispose.call(this)};
with(MO)MO.FDsMainWindow=function(b){b=RClass.inherits(this,b,FObject);b._name=null;b._matrix=null;b._location=null;b._rotation=null;b._scale=null;b._visible=!0;b._renderables=null;b.construct=FDsMainWindow_construct;b.isName=FDsMainWindow_isName;b.name=FDsMainWindow_name;b.matrix=FDsMainWindow_matrix;b.location=FDsMainWindow_location;b.rotation=FDsMainWindow_rotation;b.scale=FDsMainWindow_scale;b.hasRenderable=FDsMainWindow_hasRenderable;b.filterRenderables=FDsMainWindow_filterRenderables;b.renderables=
FDsMainWindow_renderables;b.pushRenderable=FDsMainWindow_pushRenderable;b.process=FDsMainWindow_process;b.update=FDsMainWindow_update;b.dispose=FDsMainWindow_dispose;return b},MO.FDsMainWindow_construct=function(){this.__base.FObject.construct.call(this);this._matrix=new SMatrix3d;this._location=new SPoint3;this._rotation=new SVector3;this._scale=new SVector3;this._scale.set(1,1,1)},MO.FDsMainWindow_isName=function(b){return this._name==b},MO.FDsMainWindow_name=function(){return this._name},MO.FDsMainWindow_matrix=
function(){return this._matrix},MO.FDsMainWindow_location=function(){return this._location},MO.FDsMainWindow_rotation=function(){return this._rotation},MO.FDsMainWindow_scale=function(){return this._scale},MO.FDsMainWindow_hasRenderable=function(){var b=this._renderables;return null!=b?!b.isEmpty():!1},MO.FDsMainWindow_filterRenderables=function(b){if(!this._visible)return!1;var d=this._renderables;if(null!=d)for(var f=d.count(),h=0;h<f;h++){var q=d.get(h);q.testVisible()&&b.pushRenderable(q)}return!0},
MO.FDsMainWindow_renderables=function(){var b=this._renderables;null==b&&(b=this._renderables=new TObjects);return b},MO.FDsMainWindow_pushRenderable=function(b){this.renderables().push(b)},MO.FDsMainWindow_update=function(){var b=this._matrix;b.set(this._location,this._rotation,this._scale);b.update()},MO.FDsMainWindow_process=function(){var b=this._renderables;if(null!=b)for(var d=b.count(),f=0;f<d;f++)b.get(f).process()},MO.FDsMainWindow_dispose=function(){this._scale=this._direction=this._position=
this._matrix=null;var b=this._renderables;null!=b&&(b.dispose(),this._renderables=null);this.__base.FObject.dispose.call(this)};
with(MO)MO.FDsMainWorkspace=function(b){b=RClass.inherits(this,b,FWorkspace);b._styleToolbarGround=RClass.register(b,new AStyle("_styleToolbarGround","Toolbar_Ground"));b._styleStatusbarGround=RClass.register(b,new AStyle("_styleStatusbarGround","Statusbar_Ground"));b._styleCatalogGround=RClass.register(b,new AStyle("_styleCatalogGround","Catalog_Ground"));b._styleWorkspaceGround=RClass.register(b,new AStyle("_styleWorkspaceGround","Workspace_Ground"));b._stylePropertyGround=RClass.register(b,new AStyle("_stylePropertyGround",
"Property_Ground"));b._framesetMain=null;b._framesetBody=null;b._frameToolBar=null;b._frameBody=null;b._frameProperty=null;b._frameCatalog=null;b._frameWorkspace=null;b._frameStatusBar=null;b.onBuild=FDsMainWorkspace_onBuild;b.construct=FDsMainWorkspace_construct;b.dispose=FDsMainWorkspace_dispose;return b},MO.FDsMainWorkspace_construct=function(){this.__base.FWorkspace.construct.call(this)},MO.FDsMainWorkspace_onBuild=function(b){this.__base.FWorkspace.onBuild.call(this,b);this._hPanel.style.width=
"100%";this._hPanel.style.height="100%";var d=this._framesetMain=RClass.create(FFrameSet);d.build(b);var f=this._frameToolBar=RClass.create(FFrame);f.setHeight(26);f.build(b);f._hPanel.className=this.styleName("Toolbar_Ground");d.appendFrame(f);f=this._frameBody=RClass.create(FFrame);f.build(b);d.appendFrame(f);f=this._frameProperty=RClass.create(FFrame);f.setHeight(18);f.build(b);f._hPanel.className=this.styleName("Statusbar_Ground");d.appendFrame(f);d.setPanel(this._hPanel);d=RClass.create(FFrameSet);
d._directionCd=EDirection.Horizontal;d.build(b);f=this._frameCatalog=RClass.create(FFrame);f.setWidth(300);f.build(b);f._hPanel.className=this.styleName("Catalog_Ground");d.appendFrame(f);var h=d.appendSpliter(),f=this._frameWorkspace=RClass.create(FFrame);f.build(b);f._hPanel.className=this.styleName("Workspace_Ground");d.appendFrame(f);var q=d.appendSpliter(),f=this._frameStatusBar=RClass.create(FFrame);f.setWidth(360);f.build(b);f._hPanel.className=this.styleName("Property_Ground");d.appendFrame(f);
d.setPanel(this._frameBody._hPanel);h._alignCd=EAlign.Left;h._hSize=this._frameCatalog._hPanel;q._alignCd=EAlign.Right;q._hSize=this._frameStatusBar._hPanel;d=this._catalog=RClass.create(FDsMainCatalog);d._worksapce=this;d.build(b);d.setPanel(this._frameCatalog._hPanel);this.push(d);d=this._toolbar=RClass.create(FDsMainToolBar);d._worksapce=this;d.build(b);d.setPanel(this._frameToolBar._hPanel);d._persistenceButton.click();this.push(d);d=this._canvas=RClass.create(FDsMainCanvas);d._worksapce=this;
d.build(b);d.setPanel(this._frameWorkspace._hPanel);this.push(d)},MO.FDsMainWorkspace_dispose=function(){this.__base.FWorkspace.dispose.call(this)};
with(MO)MO.FDsSpaceCanvas=function(b){b=RClass.inherits(this,b,FDsCanvas);b._rotation=null;b._optionRotation=!1;b._capturePosition=null;b._captureMatrix=null;b._captureRotation=null;b._selectObject=null;b._selectRenderables=null;b._templateMatrix=null;b._templateRenderable=null;b.onBuild=FDsSpaceCanvas_onBuild;b.onMouseCaptureStart=FDsSpaceCanvas_onMouseCaptureStart;b.onMouseCapture=FDsSpaceCanvas_onMouseCapture;b.onMouseCaptureStop=FDsSpaceCanvas_onMouseCaptureStop;b.oeResize=FDsSpaceCanvas_oeResize;
b.oeRefresh=FDsSpaceCanvas_oeRefresh;b.construct=FDsSpaceCanvas_construct;b.innerSelectRenderable=FDsSpaceCanvas_innerSelectRenderable;b.innerSelectDisplay=FDsSpaceCanvas_innerSelectDisplay;b.innerSelectLayer=FDsSpaceCanvas_innerSelectLayer;b.selectNone=FDsSpaceCanvas_selectNone;b.selectLayers=FDsSpaceCanvas_selectLayers;b.selectLayer=FDsSpaceCanvas_selectLayer;b.selectDisplay=FDsSpaceCanvas_selectDisplay;b.selectMaterial=FDsSpaceCanvas_selectMaterial;b.selectRenderable=FDsSpaceCanvas_selectRenderable;
b.switchPlay=FDsSpaceCanvas_switchPlay;b.switchMovie=FDsSpaceCanvas_switchMovie;b.dispose=FDsSpaceCanvas_dispose;return b},MO.FDsSpaceCanvas_onBuild=function(b){this.__base.FDsCanvas.onBuild.call(this,b)},MO.FDsSpaceCanvas_onMouseCaptureStart=function(b){this.__base.FDsCanvas.onMouseCaptureStart.call(this,b);var d=this._activeSpace;d&&(d=d.region(),b=RConsole.find(FG3dTechniqueConsole).find(this._graphicContext,FG3dSelectTechnique).test(d,b.offsetX,b.offsetY),this.selectRenderable(b),b&&(b=b.display(),
this._captureMatrix.assign(b.matrix())))},MO.FDsSpaceCanvas_onMouseCapture=function(b){this.__base.FDsCanvas.onMouseCapture.call(this,b)},MO.FDsSpaceCanvas_onMouseCaptureStop=function(b){this.__base.FDsCanvas.onMouseCaptureStop.call(this,b)},MO.FDsSpaceCanvas_oeResize=function(b){this.__base.FDsCanvas.oeResize.call(this,b);var d=this._hPanel;b=d.offsetWidth;var d=d.offsetHeight,f=this._activeSpace;f&&(f=f.camera().projection(),f.size().set(b,d),f.update());return EEventStatus.Stop},MO.FDsSpaceCanvas_oeRefresh=
function(b){return EEventStatus.Stop},MO.FDsSpaceCanvas_construct=function(){this.__base.FDsCanvas.construct.call(this);this._capturePosition=new SPoint2;this._captureMatrix=new SMatrix3d;this._templateMatrix=new SMatrix3d;this._templateFaceMatrix=new SMatrix3d;this._rotation=new SVector3;this._captureRotation=new SVector3;this._selectRenderables=new TObjects},MO.FDsSpaceCanvas_innerSelectRenderable=function(b){b._optionSelected=!0;RClass.isClass(b,MDsBoundBox)&&b.showBoundBox();this._selectRenderables.push(b)},
MO.FDsSpaceCanvas_innerSelectDisplay=function(b){for(var d=b.displays(),f=d.count(),h=0;h<f;h++){var q=d.at(h);this.innerSelectDisplay(q)}b=b.renderables();f=b.count();for(h=0;h<f;h++)d=b.at(h),RClass.isClass(d,FDsSceneRenderable)&&this.innerSelectRenderable(d)},MO.FDsSpaceCanvas_innerSelectLayer=function(b){b=b.displays();for(var d=b.count(),f=0;f<d;f++){var h=b.at(f);this.innerSelectDisplay(h)}},MO.FDsSpaceCanvas_selectNone=function(){for(var b=this._selectRenderables,d=b.count(),f=0;f<d;f++){var h=
b.at(f);h._optionSelected=!1;RClass.isClass(h,MDsBoundBox)&&h.hideBoundBox()}this._selectObject=null;this._selectRenderables.clear()},MO.FDsSpaceCanvas_selectLayers=function(){this.selectNone();for(var b=this._activeSpace.layers(),d=b.count(),f=0;f<d;f++){var h=b.at(f);this.innerSelectLayer(h)}},MO.FDsSpaceCanvas_selectLayer=function(b){this.selectNone();this._selectObject=b;this.innerSelectLayer(b)},MO.FDsSpaceCanvas_selectDisplay=function(b){this.selectNone();this._selectObject=b;this.innerSelectDisplay(b)},
MO.FDsSpaceCanvas_selectMaterial=function(b){this.selectNone();this._selectObject=b;for(var d=b._display._sprite.renderables(),f=d.count(),h=0;h<f;h++){var q=d.at(h);q.material()==b&&this.innerSelectRenderable(q)}},MO.FDsSpaceCanvas_selectRenderable=function(b){this.selectNone();b&&(this.innerSelectRenderable(b),this._frameSet._catalogContent.showObject(b))},MO.FDsSpaceCanvas_switchPlay=function(b){for(var d=this._activeSpace.allDisplays(),f=d.count(),h=0;h<f;h++){var q=d.at(h);RClass.isClass(q,FE3dSceneDisplay)&&
(q._sprite._optionPlay=b,q._optionPlay=b)}},MO.FDsSpaceCanvas_switchMovie=function(b){for(var d=this._activeSpace.allDisplays(),f=d.count(),h=0;h<f;h++){var q=d.at(h);if(RClass.isClass(q,FE3dSceneDisplay)){var w=q._sprite;w&&(w._optionMovie=b);q._optionMovie=b}}},MO.FDsSpaceCanvas_dispose=function(){this._rotation=RObject.dispose(this._rotation);this.__base.FDsCanvas.dispose.call(this)};
with(MO)MO.FDsSpaceDesignCanvas=function(b){b=RClass.inherits(this,b,FDsSpaceCanvas);b._templateMatrix=null;b._templateRenderable=null;b._templateFace=null;b._templateTranslation=null;b._templateRotation=null;b._templateScale=null;b._templateViewScale=.05;b.onBuild=FDsSpaceDesignCanvas_onBuild;b.onDataLoaded=FDsSpaceDesignCanvas_onDataLoaded;b.construct=FDsSpaceDesignCanvas_construct;b.selectRenderable=FDsSpaceDesignCanvas_selectRenderable;b.refreshOperationFace=FDsSpaceDesignCanvas_refreshOperationFace;
b.switchMode=FDsSpaceDesignCanvas_switchMode;b.dispose=FDsSpaceDesignCanvas_dispose;return b},MO.FDsSpaceDesignCanvas_onBuild=function(b){this.__base.FDsSpaceCanvas.onBuild.call(this,b);b=RConsole.find(FE3dTemplateConsole);(this._templateTranslation=b.allocByCode(this,"com.design.translation")).addLoadListener(this,this.onDataLoaded);(this._templateRotation=b.allocByCode(this,"com.design.rotation")).addLoadListener(this,this.onDataLoaded);(this._templateScale=b.allocByCode(this,"com.design.scale")).addLoadListener(this,
this.onDataLoaded)},MO.FDsSpaceDesignCanvas_onDataLoaded=function(b){b=this._graphicContext;var d=this._activeSpace;if(this._templateTranslation.testReady()&&this._templateRotation.testReady()&&this._templateScale.testReady()&&d.testReady()){var f=this._translationSprite=this._templateTranslation.sprite();f.setVisible(!1);var h=this._rotationSprite=this._templateRotation.sprite();h.setVisible(!1);var q=this._scaleSprite=this._templateScale.sprite();q.setVisible(!1);var w=this._uiLayer=RClass.create(FDisplayUiLayer);
w.selectTechnique(b,FE3dControlTechnique);w.pushDisplay(f);w.pushDisplay(h);w.pushDisplay(q);d.registerLayer("ui",w);this.reloadRegion();this.processLoadListener(this);RConsole.find(FUiDesktopConsole).hide()}},MO.FDsSpaceDesignCanvas_onMouseCaptureStart=function(b){this.__base.FDsSpaceCanvas.onMouseCaptureStart.call(this,b);var d=this._activeSpace;d&&(d=d.region(),b=RConsole.find(FG3dTechniqueConsole).find(this._graphicContext,FG3dSelectTechnique).test(d,b.offsetX,b.offsetY),this.selectRenderable(b),
b&&(b=b.display(),this._captureMatrix.assign(b.matrix())))},MO.FDsSpaceDesignCanvas_onMouseCapture=function(b){this.__base.FDsSpaceCanvas.onMouseCapture.call(this,b)},MO.FDsSpaceDesignCanvas_onMouseCaptureStop=function(b){this.__base.FDsSpaceCanvas.onMouseCaptureStop.call(this,b)},MO.FDsSpaceDesignCanvas_oeResize=function(b){this.__base.FDsSpaceCanvas.oeResize.call(this,b);var d=this._hPanel;b=d.offsetWidth;var d=d.offsetHeight,f=this._activeSpace;f&&(f=f.camera().projection(),f.size().set(b,d),f.update());
return EEventStatus.Stop},MO.FDsSpaceDesignCanvas_oeRefresh=function(b){return EEventStatus.Stop},MO.FDsSpaceDesignCanvas_construct=function(){this.__base.FDsSpaceCanvas.construct.call(this);this._templateMatrix=new SMatrix3d;this._templateFaceMatrix=new SMatrix3d},MO.FDsSpaceDesignCanvas_selectRenderable=function(b){this._activeSpace&&(this.selectNone(),b&&(this.innerSelectRenderable(b),this._frameSet._catalogContent.showObject(b)))},MO.FDsSpaceDesignCanvas_refreshOperationFace=function(){var b=
this._canvasModeCd,d=!this._selectRenderables.isEmpty(),f=this._translationSprite,h=this._rotationSprite,q=this._scaleSprite;this._templateFace=null;switch(b){case EDsCanvasMode.Translate:f.setVisible(d);h.setVisible(!1);q.setVisible(!1);this._templateFace=f;break;case EDsCanvasMode.Rotation:f.setVisible(!1);h.setVisible(d);q.setVisible(!1);this._templateFace=q;break;case EDsCanvasMode.Scale:f.setVisible(!1),h.setVisible(!1),q.setVisible(d),this._templateFace=q}b=this._templateFace;d&&b&&(d=this._selectRenderables.first().display(),
b=b.matrix(),b.assign(d.matrix()),b.update())},MO.FDsSpaceDesignCanvas_switchMode=function(b){this._canvasModeCd=b},MO.FDsSpaceDesignCanvas_dispose=function(){this._rotation=RObject.dispose(this._rotation);this.__base.FDsSpaceCanvas.dispose.call(this)};
with(MO)MO.FDsStage=function(b){b=RClass.inherits(this,b,FE3dStage);b._mapLayer=RClass.register(b,new AGetter("_mapLayer"));b._spriteLayer=RClass.register(b,new AGetter("_spriteLayer"));b._faceLayer=RClass.register(b,new AGetter("_faceLayer"));b.construct=FDsStage_construct;b.active=FDsStage_active;b.deactive=FDsStage_deactive;return b},MO.FDsStage_construct=function(){this.__base.FE3dStage.construct.call(this);var b=this._mapLayer=RClass.create(FDisplayLayer);this.registerLayer("MapLayer",b);b=this._spriteLayer=
RClass.create(FDisplayLayer);this.registerLayer("SpriteLayer",b);b=this._faceLayer=RClass.create(FDisplayLayer);this.registerLayer("FaceLayer",b)},MO.FDsStage_active=function(){this.__base.FE3dStage.active.call(this)},MO.FDsStage_deactive=function(){this.__base.FE3dStage.deactive.call(this)};
with(MO)MO.FDsModelRenderable=function(b){b=RClass.inherits(this,b,FE3dModelRenderable,MDsBoundBox);b._optionSelected=!1;b.filterDrawables=FDsModelRenderable_filterDrawables;return b},MO.FDsModelRenderable_filterDrawables=function(b){var d=this.__base.FE3dSceneDisplayRenderable.filterDrawables.call(this,b);d&&this._boundVisible&&b.pushRenderable(this._boundBox);return d};with(MO)MO.FDsSceneDisplay=function(b){return b=RClass.inherits(this,b,FE3dSceneDisplay)};
with(MO)MO.FDsSceneLayer=function(b){return b=RClass.inherits(this,b,FE3dSceneLayer)};with(MO)MO.FDsSceneRenderable=function(b){b=RClass.inherits(this,b,FE3dSceneDisplayRenderable,MDsBoundBox);b._optionSelected=!1;b.filterDrawables=FDsSceneRenderable_filterDrawables;return b},MO.FDsSceneRenderable_filterDrawables=function(b){var d=this.__base.FE3dSceneDisplayRenderable.filterDrawables.call(this,b);d&&this._boundVisible&&b.pushRenderable(this._boundBox);return d};
with(MO)MO.FDrAbsResourceConsole=function(b){b=RClass.inherits(this,b,FConsole);b._scopeCd=EScope.Local;b._serviceCode=null;b._classUnit=null;b._resources=null;b.construct=FDrAbsResourceConsole_construct;b.makeServiceUrl=FDrAbsResourceConsole_makeServiceUrl;b.loadResource=FDrAbsResourceConsole_loadResource;b.doList=FDrAbsResourceConsole_doList;b.doQuery=FDrAbsResourceConsole_doQuery;b.doCreate=FDrAbsResourceConsole_doCreate;b.doUpdate=FDrAbsResourceConsole_doUpdate;b.doDelete=FDrAbsResourceConsole_doDelete;
return b},MO.FDrAbsResourceConsole_construct=function(){this.__base.FConsole.construct.call(this);this._resources=new TDictionary},MO.FDrAbsResourceConsole_makeServiceUrl=function(b){b=RBrowser.hostPath("/"+this._serviceCode+".ws?action="+b);MO.Runtime.isDebug()&&(b+="&date="+RDate.format());return b},MO.FDrAbsResourceConsole_loadResource=function(b){var d=b.get("guid"),f=this._resources.get(d);f||(f=RClass.create(this._classUnit),this._resources.set(d,f));f.loadConfig(b);return f},MO.FDrAbsResourceConsole_doList=
function(b,d,f,h){var q="/"+this._serviceCode+".ws?action=list";RString.isEmpty(b)||(q+="&search="+b);RString.isEmpty(d)||(q+="&order="+d);0<=f&&(q+="&page_size="+f);0<=h&&(q+="&page="+h);return RConsole.find(FXmlConsole).sendAsync(q)},MO.FDrAbsResourceConsole_doQuery=function(b){b="/"+this._serviceCode+".ws?action=query&guid="+b;return RConsole.find(FXmlConsole).sendAsync(b)},MO.FDrAbsResourceConsole_doCreate=function(b){var d=new TXmlDocument,f=d.root();f.set("action","create");f=f.create(b.classCode());
b.saveConfig(f);return RConsole.find(FXmlConsole).sendAsync("/"+this._serviceCode+".ws",d)},MO.FDrAbsResourceConsole_doUpdate=function(b){var d=new TXmlDocument,f=d.root();f.set("action","update");f=f.create(b.classCode());b.saveConfig(f);return RConsole.find(FXmlConsole).sendAsync("/"+this._serviceCode+".ws",d)},MO.FDrAbsResourceConsole_doDelete=function(b){b="/"+this._serviceCode+".ws?action=delete&guid="+b;return RConsole.find(FXmlConsole).sendAsync(b)};
with(MO)MO.FDrBitmap=function(b){b=RClass.inherits(this,b,FDrResource);b._classCode="Bitmap";b._sizeWidth=0;b._sizeHeight=0;b.sizeWidth=FDrBitmap_sizeWidth;b.setSizeWidth=FDrBitmap_setSizeWidth;b.sizeHeight=FDrBitmap_sizeHeight;b.setSizeHeight=FDrBitmap_setSizeHeight;b.loadConfig=FDrBitmap_loadConfig;b.saveConfig=FDrBitmap_saveConfig;return b},MO.FDrBitmap_sizeWidth=function(){return this._sizeWidth},MO.FDrBitmap_setSizeWidth=function(b){this._sizeWidth=b},MO.FDrBitmap_sizeHeight=function(){return this._sizeHeight},
MO.FDrBitmap_setSizeHeight=function(b){this._sizeHeight=b},MO.FDrBitmap_loadConfig=function(b){this.__base.FDrResource.loadConfig.call(this,b);this._sizeWidth=b.getInteger("size_width");this._sizeHeight=b.getInteger("size_height")},MO.FDrBitmap_saveConfig=function(b){this.__base.FDrResource.saveConfig.call(this,b);b.set("size_width",this._sizeWidth);b.set("size_height",this._sizeHeight)};
with(MO)MO.FDrBitmapConsole=function(b){b=RClass.inherits(this,b,FDrAbsResourceConsole);b._serviceCode="cloud.resource.bitmap";b._classUnit=FDrBitmap;b.query=FDrBitmapConsole_query;b.update=FDrBitmapConsole_update;return b},MO.FDrBitmapConsole_query=function(b){for(var d=RBrowser.hostPath("/"+this._serviceCode+".ws?action=query&guid="+b),d=RConsole.find(FXmlConsole).send(d),f=d.nodeCount(),h=0;h<f;h++){var q=d.node(h);q.isName("Bitmap")&&this.loadResource(q)}return this._resources.get(b)},MO.FDrBitmapConsole_update=
function(b){var d=RBrowser.hostPath("/"+this._serviceCode+".ws?action=update");return RConsole.find(FXmlConsole).sendAsync(d,b)};with(MO)MO.FDrMaterial=function(b){b=RClass.inherits(this,b,FDrResource);b._classCode="Material";b.loadConfig=FDrMaterial_loadConfig;b.saveConfig=FDrMaterial_saveConfig;return b},MO.FDrMaterial_loadConfig=function(b){this.__base.FDrResource.loadConfig.call(this,b)},MO.FDrMaterial_saveConfig=function(b){this.__base.FDrResource.saveConfig.call(this,b)};
with(MO)MO.FDrMaterialConsole=function(b){b=RClass.inherits(this,b,FDrAbsResourceConsole);b._serviceCode="cloud.resource.material";b._classUnit=FDrMaterial;b.query=FDrMaterialConsole_query;b.update=FDrMaterialConsole_update;b.deleteBitmap=FDrMaterialConsole_deleteBitmap;return b},MO.FDrMaterialConsole_query=function(b){for(var d=RBrowser.hostPath("/"+this._serviceCode+".ws?action=query&guid="+b),d=RConsole.find(FXmlConsole).send(d),f=d.nodeCount(),h=0;h<f;h++){var q=d.node(h);q.isName("Material")&&
this.loadResource(q)}return this._resources.get(b)},MO.FDrMaterialConsole_update=function(b){var d=RBrowser.hostPath("/"+this._serviceCode+".ws?action=update");return RConsole.find(FXmlConsole).sendAsync(d,b)},MO.FDrMaterialConsole_deleteBitmap=function(b){b=RBrowser.hostPath("/"+this._serviceCode+".ws?action=deleteBitmap&guid="+b);return RConsole.find(FXmlConsole).sendAsync(b)};with(MO)MO.FDrMesh=function(b){b=RClass.inherits(this,b,FDrResource);b._classCode="Mesh";return b};
with(MO)MO.FDrMeshConsole=function(b){b=RClass.inherits(this,b,FDrAbsResourceConsole);b._serviceCode="cloud.resource.mesh";b.update=FDrMeshConsole_update;return b},MO.FDrMeshConsole_update=function(b){var d=RBrowser.hostPath("/"+this._serviceCode+".ws?action=update&date="+RDate.format());return RConsole.find(FXmlConsole).sendAsync(d,b)};with(MO)MO.FDrModel=function(b){b=RClass.inherits(this,b,FDrResource);b._classCode="Model";return b};
with(MO)MO.FDrModelConsole=function(b){b=RClass.inherits(this,b,FDrAbsResourceConsole);b._serviceCode="cloud.resource.model";b.update=FDrModelConsole_update;return b},MO.FDrModelConsole_update=function(b){var d=RBrowser.hostPath("/"+this._serviceCode+".ws?action=updateContent&date="+RDate.format());return RConsole.find(FXmlConsole).sendAsync(d,b)};
with(MO)MO.FDrObject=function(b){b=RClass.inherits(this,b,FObject);b._guid=null;b._code=null;b._label=null;b.guid=FDrObject_guid;b.code=FDrObject_code;b.setCode=FDrObject_setCode;b.label=FDrObject_label;b.setLabel=FDrObject_setLabel;b.unserialize=FDrObject_unserialize;b.saveConfig=FDrObject_saveConfig;return b},MO.FDrObject_guid=function(){return this._guid},MO.FDrObject_code=function(){return this._code},MO.FDrObject_setCode=function(b){this._code=b},MO.FDrObject_label=function(){return this._label},
MO.FDrObject_setLabel=function(b){this._label=b},MO.FDrObject_unserialize=function(b){this._guid=b.readString();this._code=b.readString();this._label=b.readString()},MO.FDrObject_saveConfig=function(b){b.setNvl("guid",this._guid);b.setNvl("code",this._code);b.setNvl("label",this._label)};
with(MO)MO.FDrProject=function(b){b=RClass.inherits(this,b,FDrResource);b._classCode="Project";b._projectGuid=null;b.saveConfig=FDrProject_saveConfig;return b},MO.FDrProject_saveConfig=function(b){this.__base.FDrResource.saveConfig.call(this,b);b.setNvl("project_guid",this._projectGuid)};with(MO)MO.FDrProjectConsole=function(b){b=RClass.inherits(this,b,FDrAbsResourceConsole);b._serviceCode="cloud.solution.project";return b};
with(MO)MO.FDrResource=function(b){b=RClass.inherits(this,b,FDrObject);b._classCode=RClass.register(b,new AGetter("_classCode"));b._guid=RClass.register(b,new AGetSet("_guid"));b._code=RClass.register(b,new AGetSet("_code"));b._label=RClass.register(b,new AGetSet("_label"));b.loadConfig=FDrResource_loadConfig;b.saveConfig=FDrResource_saveConfig;return b},MO.FDrResource_loadConfig=function(b){this._guid=b.get("guid");this._code=b.get("code");this._label=b.get("label")},MO.FDrResource_saveConfig=function(b){b.setName(this._classCode);
b.set("guid",this._guid);b.set("code",this._code);b.set("label",this._label)};
with(MO)MO.FDrResourceConsole=function(b){b=RClass.inherits(this,b,FDrAbsResourceConsole);b._serviceCode="cloud.resource";b._catalogCode="cloud.resource.catalog";b._resources=null;b.construct=FDrResourceConsole_construct;b.doList=FDrResourceConsole_doList;b.doShare=FDrResourceConsole_doShare;b.doDelete=FDrResourceConsole_doDelete;b.doListShare=FDrResourceConsole_doListShare;b.doFolderCreate=FDrResourceConsole_doFolderCreate;b.doFolderUpdate=FDrResourceConsole_doFolderUpdate;b.doFolderDelete=FDrResourceConsole_doFolderDelete;
return b},MO.FDrResourceConsole_construct=function(){this.__base.FDrAbsResourceConsole.construct.call(this);this._resources=new TDictionary},MO.FDrResourceConsole_doList=function(b,d,f,h,q){b="/"+this._serviceCode+".ws?action=list&type_cd="+b+"&serach="+d+"&order="+f+"&page_size="+h+"&page="+q;return RConsole.find(FXmlConsole).sendAsync(b)},MO.FDrResourceConsole_doShare=function(b,d){var f=this.makeServiceUrl("share")+"&guid="+b+"&share_cd="+d;return RConsole.find(FXmlConsole).sendAsync(f)},MO.FDrResourceConsole_doDelete=
function(b,d){var f="/"+this._serviceCode+".ws?action=delete&type_cd="+b+"&guid="+d;return RConsole.find(FXmlConsole).sendAsync(f)},MO.FDrResourceConsole_doListShare=function(b,d,f,h,q){b="/"+this._serviceCode+".ws?action=listShare&type_cd="+b+"&serach="+d+"&order="+f+"&page_size="+h+"&page="+q;return RConsole.find(FXmlConsole).sendAsync(b)},MO.FDrResourceConsole_doFolderCreate=function(b,d,f){var h=new TXmlDocument,q=h.root();q.set("action","create");q=q.create("Folder");q.set("parent_guid",b);q.set("code",
d);q.set("label",f);return RConsole.find(FXmlConsole).sendAsync("/"+this._catalogCode+".ws",h)},MO.FDrResourceConsole_doFolderUpdate=function(b,d,f){var h=new TXmlDocument,q=h.root();q.set("action","update");q=q.create("Folder");q.set("guid",b);q.set("code",d);q.set("label",f);return RConsole.find(FXmlConsole).sendAsync("/"+this._catalogCode+".ws",h)},MO.FDrResourceConsole_doFolderDelete=function(b){b="/"+this._catalogCode+".ws?action=delete&guid="+b;return RConsole.find(FXmlConsole).sendAsync(b)};
with(MO)MO.FDrScene=function(b){b=RClass.inherits(this,b,FDrResource);b._classCode="Scene";b._projectGuid=null;b.saveConfig=FDrScene_saveConfig;return b},MO.FDrScene_saveConfig=function(b){this.__base.FDrResource.saveConfig.call(this,b);b.setNvl("project_guid",this._projectGuid)};
with(MO)MO.FDrSceneConsole=function(b){b=RClass.inherits(this,b,FDrAbsResourceConsole);b._serviceCode="cloud.resource.scene";b.createCamera=FDrSceneConsole_createCamera;b.createLayer=FDrSceneConsole_createLayer;b.createSprite=FDrSceneConsole_createSprite;b.createMovie=FDrSceneConsole_createMovie;b.copyNode=FDrSceneConsole_copyNode;b.deleteNode=FDrSceneConsole_deleteNode;b.update=FDrSceneConsole_update;return b},MO.FDrSceneConsole_createCamera=function(b){var d=this.makeServiceUrl("createCamera");
return RConsole.find(FXmlConsole).sendAsync(d,b)},MO.FDrSceneConsole_createLayer=function(b){var d=this.makeServiceUrl("createLayer");return RConsole.find(FXmlConsole).sendAsync(d,b)},MO.FDrSceneConsole_createSprite=function(b){var d=this.makeServiceUrl("createSprite");return RConsole.find(FXmlConsole).sendAsync(d,b)},MO.FDrSceneConsole_createMovie=function(b){var d=this.makeServiceUrl("createMovie");return RConsole.find(FXmlConsole).sendAsync(d,b)},MO.FDrSceneConsole_copyNode=function(b,d){var f=
this.makeServiceUrl("copyNode")+"&space_guid="+b+"&node_guid="+d;return RConsole.find(FXmlConsole).sendAsync(f)},MO.FDrSceneConsole_deleteNode=function(b,d){var f=this.makeServiceUrl("deleteNode")+"&space_guid="+b+"&node_guid="+d;return RConsole.find(FXmlConsole).sendAsync(f)},MO.FDrSceneConsole_update=function(b){var d=RBrowser.hostPath("/"+this._serviceCode+".ws?action=updateContent&date="+RDate.format());return RConsole.find(FXmlConsole).sendAsync(d,b)};
with(MO)MO.FDrTemplate=function(b){b=RClass.inherits(this,b,FDrResource);b._classCode="Template";return b};
with(MO)MO.FDrTemplateConsole=function(b){b=RClass.inherits(this,b,FDrAbsResourceConsole);b._serviceCode="cloud.resource.template";b.selectMaterial=FDrTemplateConsole_selectMaterial;b.createDisplay=FDrTemplateConsole_createDisplay;b.update=FDrTemplateConsole_update;return b},MO.FDrTemplateConsole_selectMaterial=function(b){var d=this.makeServiceUrl("createMaterial");return RConsole.find(FXmlConsole).sendAsync(d,b)},MO.FDrTemplateConsole_createDisplay=function(b){var d=this.makeServiceUrl("createDisplay");
return RConsole.find(FXmlConsole).sendAsync(d,b)},MO.FDrTemplateConsole_update=function(b){var d=RBrowser.hostPath("/"+this._serviceCode+".ws?action=updateContent&date="+RDate.format());return RConsole.find(FXmlConsole).sendAsync(d,b)};
with(MO)MO.FDsCommonAnimationPropertyFrame=function(b){b=RClass.inherits(this,b,FUiForm);b._visible=!1;b._activeSpace=null;b._activeAnimation=null;b._controlGuid=null;b._controlCode=null;b._controlLabel=null;b.onBuilded=FDsCommonAnimationPropertyFrame_onBuilded;b.onDataChanged=FDsCommonAnimationPropertyFrame_onDataChanged;b.construct=FDsCommonAnimationPropertyFrame_construct;b.loadObject=FDsCommonAnimationPropertyFrame_loadObject;b.dispose=FDsCommonAnimationPropertyFrame_dispose;return b},MO.FDsCommonAnimationPropertyFrame_construct=
function(){this.__base.FUiForm.construct.call(this)},MO.FDsCommonAnimationPropertyFrame_onBuilded=function(b){this.__base.FUiForm.onBuilded.call(this,b);this._controlCode.addDataChangedListener(this,this.onDataChanged);this._controlLabel.addDataChangedListener(this,this.onDataChanged);this._controlPlayRate.addDataChangedListener(this,this.onDataChanged)},MO.FDsCommonAnimationPropertyFrame_onDataChanged=function(b){b=this._activeAnimation;var d=b.resource();d.setCode(this._controlCode.get());d.setLabel(this._controlLabel.get());
d._playRate=this._controlPlayRate.get();b.reloadResource()},MO.FDsCommonAnimationPropertyFrame_loadObject=function(b,d){var f=d.resource();this._activeSpace=b;this._activeAnimation=d;this._controlGuid.set(f.guid());this._controlCode.set(f.code());this._controlLabel.set(f.label());this._controlPlayRate.set(f.playRate())},MO.FDsCommonAnimationPropertyFrame_dispose=function(){this.__base.FUiForm.dispose.call(this)};
with(MO)MO.FDsCommonCameraFrame=function(b){b=RClass.inherits(this,b,FUiForm);b._workspace=null;b._camera=null;b._controlPosition=null;b._controlDirection=null;b.construct=FDsCommonCameraFrame_construct;b.loadObject=FDsCommonCameraFrame_loadObject;b.dispose=FDsCommonCameraFrame_dispose;return b},MO.FDsCommonCameraFrame_construct=function(){this.__base.FUiForm.construct.call(this)},MO.FDsCommonCameraFrame_loadObject=function(b,d){this._camera=d;this._controlPosition.set(d.position());this._controlDirection.set(d.direction())},
MO.FDsCommonCameraFrame_dispose=function(){this.__base.FUiForm.dispose.call(this)};
with(MO)MO.FDsCommonCameraPropertyFrame=function(b){b=RClass.inherits(this,b,FUiForm);b._visible=!1;b._workspace=null;b._activeSpace=null;b._activeCamera=null;b._controlGuid=null;b._controlCode=null;b._controlLabel=null;b._controlPosition=null;b._controlDirection=null;b.onBuilded=FDsCommonCameraPropertyFrame_onBuilded;b.onDataChanged=FDsCommonCameraPropertyFrame_onDataChanged;b.construct=FDsCommonCameraPropertyFrame_construct;b.loadObject=FDsCommonCameraPropertyFrame_loadObject;b.dispose=FDsCommonCameraPropertyFrame_dispose;
return b},MO.FDsCommonCameraPropertyFrame_onBuilded=function(b){this.__base.FUiForm.onBuilded.call(this,b);this._controlPosition.addDataChangedListener(this,this.onDataChanged);this._controlDirection.addDataChangedListener(this,this.onDataChanged)},MO.FDsCommonCameraPropertyFrame_onDataChanged=function(b){b=this._activeCamera;var d=b.resource();d.position().assign(this._controlPosition.get());d.direction().assign(this._controlDirection.get());b.position().assign(d.position());b.direction().assign(d.direction());
b.update()},MO.FDsCommonCameraPropertyFrame_construct=function(){this.__base.FUiForm.construct.call(this)},MO.FDsCommonCameraPropertyFrame_loadObject=function(b,d){var f=d.resource();this._activeSpace=b;this._activeCamera=d;this._controlGuid.set(f.guid());this._controlCode.set(f.code());this._controlLabel.set(f.label());this._controlPosition.set(d.position());this._controlDirection.set(d.direction());f.position().assign(d.position());f.direction().assign(d.direction())},MO.FDsCommonCameraPropertyFrame_dispose=
function(){this.__base.FUiForm.dispose.call(this)};
with(MO)MO.FDsCommonDisplayDialog=function(b){b=RClass.inherits(this,b,FUiDialog);b._frameName="resource.common.dialog.DisplayDialog";b._displayModeCd=null;b._controlLayerLabel=null;b._controlDisplayLabel=null;b._controlCode=null;b._controlLabel=null;b._controlTemplateCode=null;b._controlConfirmButton=null;b._controlCancelButton=null;b.onBuilded=FDsCommonDisplayDialog_onBuilded;b.onConfirmLoad=FDsCommonDisplayDialog_onConfirmLoad;b.onConfirmClick=FDsCommonDisplayDialog_onConfirmClick;b.onCancelClick=
FDsCommonDisplayDialog_onCancelClick;b.construct=FDsCommonDisplayDialog_construct;b.setSpace=FDsCommonDisplayDialog_setSpace;b.setDisplayLabel=FDsCommonDisplayDialog_setDisplayLabel;b.setContentCode=FDsCommonDisplayDialog_setContentCode;b.setContentLabel=FDsCommonDisplayDialog_setContentLabel;b.dispose=FDsCommonDisplayDialog_dispose;return b},MO.FDsCommonDisplayDialog_onBuilded=function(b){this.__base.FUiDialog.onBuilded.call(this,b);this._controlSpaceGuid.setEditAble(!1);this._controlSpaceLabel.setEditAble(!1);
this._controlConfirm.addClickListener(this,this.onConfirmClick);this._controlCancel.addClickListener(this,this.onCancelClick)},MO.FDsCommonDisplayDialog_onConfirmLoad=function(b){RConsole.find(FUiDesktopConsole).hide();this.hide()},MO.FDsCommonDisplayDialog_onConfirmClick=function(b){RConsole.find(FUiDesktopConsole).showUploading();b=new TXmlNode("Action");var d=b.create("Display");d.set("space_guid",this._spaceGuid);d.set("code",this._controlCode.get());d.set("label",this._controlLabel.get());d.set("model_guid",
this._controlModelGuid.get());d.set("model_code",this._controlModelCode.get());RConsole.find(FDrTemplateConsole).createDisplay(b).addLoadListener(this,this.onConfirmLoad)},MO.FDsCommonDisplayDialog_onCancelClick=function(b){this.hide()},MO.FDsCommonDisplayDialog_construct=function(){this.__base.FUiDialog.construct.call(this)},MO.FDsCommonDisplayDialog_setSpace=function(b){b=b.resource();this._controlSpaceGuid.set(b.guid());this._controlSpaceLabel.set(b.makeLabel())},MO.FDsCommonDisplayDialog_setDisplayLabel=
function(b){this._controlDisplayLabel.set(b)},MO.FDsCommonDisplayDialog_setContentCode=function(b){this._controlCode.set(b)},MO.FDsCommonDisplayDialog_setContentLabel=function(b){this._controlLabel.set(b)},MO.FDsCommonDisplayDialog_dispose=function(){this.__base.FUiDialog.dispose.call(this)};
with(MO)MO.FDsCommonDisplayFrame=function(b){b=RClass.inherits(this,b,FUiForm);b._activeSpace=null;b._activeDisplay=null;b.onBuilded=FDsCommonDisplayFrame_onBuilded;b.onDataChanged=FDsCommonDisplayFrame_onDataChanged;b.construct=FDsCommonDisplayFrame_construct;b.loadObject=FDsCommonDisplayFrame_loadObject;b.dispose=FDsCommonDisplayFrame_dispose;return b},MO.FDsCommonDisplayFrame_onBuilded=function(b){this.__base.FUiForm.onBuilded.call(this,b);this._controlTranslate.addDataChangedListener(this,this.onDataChanged);
this._controlRotation.addDataChangedListener(this,this.onDataChanged);this._controlScale.addDataChangedListener(this,this.onDataChanged)},MO.FDsCommonDisplayFrame_onDataChanged=function(b){b=this._activeDisplay;var d=b.resource().matrix(),f=this._controlTranslate.get();d.setTranslate(f.x,f.y,f.z);f=this._controlRotation.get();d.setRotation(f.x,f.y,f.z);f=this._controlScale.get();d.setScale(f.x,f.y,f.z);d.update();b.matrix().assign(d)},MO.FDsCommonDisplayFrame_construct=function(){this.__base.FUiForm.construct.call(this)},
MO.FDsCommonDisplayFrame_loadObject=function(b,d){var f=d.resource();this._activeSpace=b;this._activeDisplay=d;f=f.matrix();this._controlTranslate.set(f.tx,f.ty,f.tz);this._controlRotation.set(f.rx,f.ry,f.rz);this._controlScale.set(f.sx,f.sy,f.sz)},MO.FDsCommonDisplayFrame_dispose=function(){this.__base.FUiForm.dispose.call(this)};
with(MO)MO.FDsCommonDisplayPropertyFrame=function(b){b=RClass.inherits(this,b,FUiForm);b._visible=!1;b._workspace=null;b._activeDisplay=null;b._activeResource=null;b._controlGuid=null;b._controlCode=null;b._controlLabel=null;b._displayFrame=null;b._materialFrame=null;b.onBuilded=FDsCommonDisplayPropertyFrame_onBuilded;b.onDataChanged=FDsCommonDisplayPropertyFrame_onDataChanged;b.construct=FDsCommonDisplayPropertyFrame_construct;b.loadObject=FDsCommonDisplayPropertyFrame_loadObject;b.dispose=FDsCommonDisplayPropertyFrame_dispose;
return b},MO.FDsCommonDisplayPropertyFrame_onBuilded=function(b){this.__base.FUiForm.onBuilded.call(this,b);this._controlCode.addDataChangedListener(this,this.onDataChanged);this._controlLabel.addDataChangedListener(this,this.onDataChanged)},MO.FDsCommonDisplayPropertyFrame_onDataChanged=function(b){b=this._activeResource;b._code=this._controlCode.get();b._label=this._controlLabel.get()},MO.FDsCommonDisplayPropertyFrame_construct=function(){this.__base.FUiForm.construct.call(this)},MO.FDsCommonDisplayPropertyFrame_loadObject=
function(b,d){var f=d._resource;this._activeSpace=b;this._activeDisplay=d;this._controlGuid.set(f.guid());this._controlCode.set(f.code());this._controlLabel.set(f.label());this._frameDisplay.loadObject(b,d)},MO.FDsCommonDisplayPropertyFrame_dispose=function(){this.__base.FUiForm.dispose.call(this)};
with(MO)MO.FDsCommonLayerDialog=function(b){b=RClass.inherits(this,b,FUiDialog);b._frameName="resource.common.dialog.LayerDialog";b._displayModeCd=null;b._controlSpaceGuid=null;b._controlSpaceLabel=null;b._controlCode=null;b._controlLabel=null;b._controlConfirmButton=null;b._controlCancelButton=null;b.onBuilded=FDsCommonLayerDialog_onBuilded;b.onConfirmLoad=FDsCommonLayerDialog_onConfirmLoad;b.onConfirmClick=FDsCommonLayerDialog_onConfirmClick;b.onCancelClick=FDsCommonLayerDialog_onCancelClick;b.construct=
FDsCommonLayerDialog_construct;b.setSpace=FDsCommonLayerDialog_setSpace;b.setDisplayLabel=FDsCommonLayerDialog_setDisplayLabel;b.setContentCode=FDsCommonLayerDialog_setContentCode;b.setContentLabel=FDsCommonLayerDialog_setContentLabel;b.dispose=FDsCommonLayerDialog_dispose;return b},MO.FDsCommonLayerDialog_onBuilded=function(b){this.__base.FUiDialog.onBuilded.call(this,b);this._controlSpaceGuid.setEditAble(!1);this._controlSpaceLabel.setEditAble(!1);this._controlConfirm.addClickListener(this,this.onConfirmClick);
this._controlCancel.addClickListener(this,this.onCancelClick)},MO.FDsCommonLayerDialog_onConfirmLoad=function(b){RConsole.find(FUiDesktopConsole).hide();this.hide()},MO.FDsCommonLayerDialog_onConfirmClick=function(b){RConsole.find(FUiDesktopConsole).showUploading();b=new TXmlNode("Action");var d=b.create("Layer");d.set("space_guid",this._spaceGuid);d.set("code",this._controlCode.get());d.set("label",this._controlLabel.get());RConsole.find(FDrSceneConsole).createLayer(b).addLoadListener(this,this.onConfirmLoad)},
MO.FDsCommonLayerDialog_onCancelClick=function(b){this.hide()},MO.FDsCommonLayerDialog_construct=function(){this.__base.FUiDialog.construct.call(this)},MO.FDsCommonLayerDialog_setSpace=function(b){b=b.resource();this._controlSpaceGuid.set(b.guid());this._controlSpaceLabel.set(b.makeLabel())},MO.FDsCommonLayerDialog_setDisplayLabel=function(b){this._controlDisplayLabel.set(b)},MO.FDsCommonLayerDialog_setContentCode=function(b){this._controlCode.set(b)},MO.FDsCommonLayerDialog_setContentLabel=function(b){this._controlLabel.set(b)},
MO.FDsCommonLayerDialog_dispose=function(){this.__base.FUiDialog.dispose.call(this)};
with(MO)MO.FDsCommonLayerPropertyFrame=function(b){b=RClass.inherits(this,b,FUiForm);b._visible=!1;b._workspace=null;b._layer=null;b._layerResource=null;b._controlGuid=null;b._controlCode=null;b._controlLabel=null;b.onBuilded=FDsCommonLayerPropertyFrame_onBuilded;b.onDataChanged=FDsCommonLayerPropertyFrame_onDataChanged;b.construct=FDsCommonLayerPropertyFrame_construct;b.loadObject=FDsCommonLayerPropertyFrame_loadObject;b.dispose=FDsCommonLayerPropertyFrame_dispose;return b},MO.FDsCommonLayerPropertyFrame_construct=
function(){this.__base.FUiForm.construct.call(this)},MO.FDsCommonLayerPropertyFrame_onBuilded=function(b){this.__base.FUiForm.onBuilded.call(this,b);this._controlCode.addDataChangedListener(this,this.onDataChanged);this._controlLabel.addDataChangedListener(this,this.onDataChanged);this._controlTypeCd.addDataChangedListener(this,this.onDataChanged);this._controlTransformCd.addDataChangedListener(this,this.onDataChanged)},MO.FDsCommonLayerPropertyFrame_onDataChanged=function(b){b=this._layerResource;
b.setCode(this._controlCode.get());b.setLabel(this._controlLabel.get());b.setTypeCd(this._controlTypeCd.get());b.setTransformCd(this._controlTransformCd.get())},MO.FDsCommonLayerPropertyFrame_loadObject=function(b,d){var f=d.resource();this._layer=d;this._layerResource=f;this._controlGuid.set(f.guid());this._controlCode.set(f.code());this._controlLabel.set(f.label());this._controlTypeCd.set(f.typeCd());this._controlTransformCd.set(f.transformCd())},MO.FDsCommonLayerPropertyFrame_dispose=function(){this.__base.FUiForm.dispose.call(this)};
with(MO)MO.FDsCommonLightPropertyFrame=function(b){b=RClass.inherits(this,b,FUiForm);b._visible=!1;b._workspace=null;b._activeSpace=null;b._activeLight=null;b._controlGuid=null;b._controlCode=null;b._controlLabel=null;b.construct=FDsCommonLightPropertyFrame_construct;b.loadObject=FDsCommonLightPropertyFrame_loadObject;b.dispose=FDsCommonLightPropertyFrame_dispose;return b},MO.FDsCommonLightPropertyFrame_construct=function(){this.__base.FUiForm.construct.call(this)},MO.FDsCommonLightPropertyFrame_loadObject=
function(b,d){var f=d.resource();this._activeSpace=b;this._activeLight=d;this._controlGuid.set(f.guid());this._controlCode.set(f.code());this._controlLabel.set(f.label())},MO.FDsCommonLightPropertyFrame_dispose=function(){this.__base.FUiForm.dispose.call(this)};
with(MO)MO.FDsCommonMaterial1Frame=function(b){b=RClass.inherits(this,b,FUiForm);b._activeSpace=null;b._activeMaterial=null;b._controlOptionDouble=null;b._controlEffectCode=null;b._controlOptionAlpha=null;b._controlAlphaBase=null;b._controlAlphaRate=null;b._controlOptionColor=null;b._controlColorMin=null;b._controlColorMax=null;b._controlColorBalance=null;b._controlColorRate=null;b._controlOptionVertex=null;b._controlVertexColor=null;b._controlOptionAmbient=null;b._controlAmbientColor=null;b._controlOptionDiffuse=
null;b._controlDiffuseColor=null;b._controlOptionSpecular=null;b._controlSpecularColor=null;b._controlSpecularBase=null;b._controlSpecularLevel=null;b._controlOptionReflect=null;b._controlReflectColor=null;b._controlReflectMerge=null;b._controlOptionEmissive=null;b._controlEmissiveColor=null;b.onBuilded=FDsCommonMaterial1Frame_onBuilded;b.onOptionChanged=FDsCommonMaterial1Frame_onOptionChanged;b.onDataChanged=FDsCommonMaterial1Frame_onDataChanged;b.construct=FDsCommonMaterial1Frame_construct;b.loadObject=
FDsCommonMaterial1Frame_loadObject;b.dispose=FDsCommonMaterial1Frame_dispose;return b},MO.FDsCommonMaterial1Frame_onBuilded=function(b){this.__base.FUiForm.onBuilded.call(this,b);this._controlOptionDouble.addDataChangedListener(this,this.onDataChanged);this._controlEffectCode.addDataChangedListener(this,this.onDataChanged);this._controlOptionAlpha.addDataChangedListener(this,this.onDataChanged);this._controlAlphaBase.addDataChangedListener(this,this.onDataChanged);this._controlAlphaRate.addDataChangedListener(this,
this.onDataChanged);this._controlOptionColor.addDataChangedListener(this,this.onOptionChanged);this._controlColorMin.addDataChangedListener(this,this.onDataChanged);this._controlColorMax.addDataChangedListener(this,this.onDataChanged);this._controlColorBalance.addDataChangedListener(this,this.onDataChanged);this._controlColorRate.addDataChangedListener(this,this.onDataChanged);this._controlOptionVertex.addDataChangedListener(this,this.onOptionChanged);this._controlVertexColor.addDataChangedListener(this,
this.onDataChanged);this._controlOptionAmbient.addDataChangedListener(this,this.onOptionChanged);this._controlAmbientColor.addDataChangedListener(this,this.onDataChanged);this._controlOptionDiffuse.addDataChangedListener(this,this.onOptionChanged);this._controlDiffuseColor.addDataChangedListener(this,this.onDataChanged);this._controlOptionSpecular.addDataChangedListener(this,this.onOptionChanged);this._controlSpecularColor.addDataChangedListener(this,this.onDataChanged);this._controlSpecularBase.addDataChangedListener(this,
this.onDataChanged);this._controlSpecularLevel.addDataChangedListener(this,this.onDataChanged);this._controlOptionReflect.addDataChangedListener(this,this.onOptionChanged);this._controlReflectColor.addDataChangedListener(this,this.onDataChanged);this._controlReflectMerge.addDataChangedListener(this,this.onDataChanged);this._controlOptionEmissive.addDataChangedListener(this,this.onOptionChanged);this._controlEmissiveColor.addDataChangedListener(this,this.onDataChanged)},MO.FDsCommonMaterial1Frame_onOptionChanged=
function(b){},MO.FDsCommonMaterial1Frame_onDataChanged=function(b){b=this._activeMaterial;var d=b.resource().info();d.optionDouble=this._controlOptionDouble.get();d.effectCode=this._controlEffectCode.get();d.optionAlpha=this._controlOptionAlpha.get();d.alphaBase=this._controlAlphaBase.get();d.alphaRate=this._controlAlphaRate.get();d.colorMin=this._controlColorMin.get();d.colorMax=this._controlColorMax.get();d.colorBalance=this._controlColorBalance.get();d.colorRate=this._controlColorRate.get();d.vertexColor.assign(this._controlVertexColor.get());
d.ambientColor.assign(this._controlAmbientColor.get());d.diffuseColor.assign(this._controlDiffuseColor.get());d.specularColor.assign(this._controlSpecularColor.get());d.specularBase=this._controlSpecularBase.get();d.specularLevel=this._controlSpecularLevel.get();d.reflectColor.assign(this._controlReflectColor.get());d.reflectMerge=this._controlReflectMerge.get();d.emissiveColor.assign(this._controlEmissiveColor.get());b.reloadResource()},MO.FDsCommonMaterial1Frame_construct=function(){this.__base.FUiForm.construct.call(this)},
MO.FDsCommonMaterial1Frame_loadObject=function(b,d){this._activeSpace=b;this._activeMaterial=d;var f=d.resource();f&&(f=f.info(),this._controlOptionDouble.set(f.optionDouble),this._controlEffectCode.set(f.effectCode),this._controlOptionAlpha.set(f.optionAlpha),this._controlAlphaBase.set(f.alphaBase),this._controlAlphaRate.set(f.alphaRate),this._controlOptionColor.set(f.optionColor),this._controlColorMin.set(f.colorMin),this._controlColorMax.set(f.colorMax),this._controlColorBalance.set(f.colorBalance),
this._controlColorRate.set(f.colorRate),this._controlOptionVertex.set(f.optionVertex),this._controlVertexColor.set(f.vertexColor),this._controlOptionAmbient.set(f.optionAmbient),this._controlAmbientColor.set(f.ambientColor),this._controlOptionDiffuse.set(f.optionDiffuse),this._controlDiffuseColor.set(f.diffuseColor),this._controlOptionSpecular.set(f.optionSpecular),this._controlSpecularColor.set(f.specularColor),this._controlSpecularBase.set(f.specularBase),this._controlSpecularLevel.set(f.specularLevel),
this._controlOptionReflect.set(f.optionReflect),this._controlReflectColor.set(f.reflectColor),this._controlReflectMerge.set(f.reflectMerge),this._controlOptionEmissive.set(f.optionEmissive),this._controlEmissiveColor.set(f.emissiveColor))},MO.FDsCommonMaterial1Frame_dispose=function(){this.__base.FUiForm.dispose.call(this)};
with(MO)MO.FDsCommonMaterial2Frame=function(b){b=RClass.inherits(this,b,FUiForm);b._activeSpace=null;b._activeMaterial=null;b._controlDiffuseViewColor=null;b._controlSpecularViewColor=null;b._controlSpecularViewBase=null;b._controlSpecularViewLevel=null;b.onBuilded=FDsCommonMaterial2Frame_onBuilded;b.onDataChanged=FDsCommonMaterial2Frame_onDataChanged;b.construct=FDsCommonMaterial2Frame_construct;b.loadObject=FDsCommonMaterial2Frame_loadObject;b.dispose=FDsCommonMaterial2Frame_dispose;return b},MO.FDsCommonMaterial2Frame_onBuilded=
function(b){this.__base.FUiForm.onBuilded.call(this,b);this._controlOptionView.addDataChangedListener(this,this.onDataChanged);this._controlOptionNormalInvert.addDataChangedListener(this,this.onDataChanged);this._controlOptionShadow.addDataChangedListener(this,this.onDataChanged);this._controlOptionShadowSelf.addDataChangedListener(this,this.onDataChanged);this._controlDiffuseViewColor.addDataChangedListener(this,this.onDataChanged);this._controlSpecularViewColor.addDataChangedListener(this,this.onDataChanged);
this._controlSpecularViewBase.addDataChangedListener(this,this.onDataChanged);this._controlSpecularViewLevel.addDataChangedListener(this,this.onDataChanged)},MO.FDsCommonMaterial2Frame_onDataChanged=function(b){b=this._activeMaterial;var d=b.resource().info();d.optionView=this._controlOptionView.get();d.optionNormalInvert=this._controlOptionNormalInvert.get();d.optionShadow=this._controlOptionShadow.get();d.optionShadowSelf=this._controlOptionShadowSelf.get();var f=this._controlDiffuseViewColor.get();
d.diffuseViewColor.assign(f);f=this._controlSpecularViewColor.get();d.specularViewColor.assign(f);d.specularViewBase=this._controlSpecularViewBase.get();d.specularViewLevel=this._controlSpecularViewLevel.get();b.reloadResource()},MO.FDsCommonMaterial2Frame_construct=function(){this.__base.FUiForm.construct.call(this)},MO.FDsCommonMaterial2Frame_loadObject=function(b,d){this._activeSpace=b;this._activeMaterial=d;var f=d.resource();f&&(f=f.info(),this._controlOptionView.set(f.optionView),this._controlOptionNormalInvert.set(f.optionNormalInvert),
this._controlOptionShadow.set(f.optionShadow),this._controlOptionShadowSelf.set(f.optionShadowSelf),this._controlDiffuseViewColor.set(f.diffuseViewColor),this._controlSpecularViewColor.set(f.specularViewColor),this._controlSpecularViewBase.set(f.specularViewBase),this._controlSpecularViewLevel.set(f.specularViewLevel))},MO.FDsCommonMaterial2Frame_dispose=function(){this.__base.FUiForm.dispose.call(this)};
with(MO)MO.FDsCommonMaterialDialog=function(b){b=RClass.inherits(this,b,FUiDialog);b._frameName="resource.common.dialog.MaterialDialog";b._displayModeCd=null;b._controlLayerLabel=null;b._controlDisplayLabel=null;b._controlCode=null;b._controlLabel=null;b._controlTemplateCode=null;b._controlConfirmButton=null;b._controlCancelButton=null;b.onBuilded=FDsCommonMaterialDialog_onBuilded;b.onConfirmLoad=FDsCommonMaterialDialog_onConfirmLoad;b.onConfirmClick=FDsCommonMaterialDialog_onConfirmClick;b.onCancelClick=
FDsCommonMaterialDialog_onCancelClick;b.construct=FDsCommonMaterialDialog_construct;b.setSpace=FDsCommonMaterialDialog_setSpace;b.setDisplayLabel=FDsCommonMaterialDialog_setDisplayLabel;b.setContentCode=FDsCommonMaterialDialog_setContentCode;b.setContentLabel=FDsCommonMaterialDialog_setContentLabel;b.dispose=FDsCommonMaterialDialog_dispose;return b},MO.FDsCommonMaterialDialog_onBuilded=function(b){this.__base.FUiDialog.onBuilded.call(this,b);this._controlSpaceGuid.setEditAble(!1);this._controlSpaceLabel.setEditAble(!1);
this._controlConfirm.addClickListener(this,this.onConfirmClick);this._controlCancel.addClickListener(this,this.onCancelClick)},MO.FDsCommonMaterialDialog_onConfirmLoad=function(b){RConsole.find(FUiDesktopConsole).hide();this.hide()},MO.FDsCommonMaterialDialog_onConfirmClick=function(b){RConsole.find(FUiDesktopConsole).showUploading();b=new TXmlNode("Action");var d=b.create("Material");d.set("space_guid",this._spaceGuid);d.set("code",this._controlCode.get());d.set("label",this._controlLabel.get());
d.set("material_guid",this._controlMaterialGuid.get());d.set("material_code",this._controlMaterialCode.get());RConsole.find(FDrTemplateConsole).selectMaterial(b).addLoadListener(this,this.onConfirmLoad)},MO.FDsCommonMaterialDialog_onCancelClick=function(b){this.hide()},MO.FDsCommonMaterialDialog_construct=function(){this.__base.FUiDialog.construct.call(this)},MO.FDsCommonMaterialDialog_setSpace=function(b){b=b.resource();this._controlSpaceGuid.set(b.guid());this._controlSpaceLabel.set(b.makeLabel())},
MO.FDsCommonMaterialDialog_setDisplayLabel=function(b){this._controlDisplayLabel.set(b)},MO.FDsCommonMaterialDialog_setContentCode=function(b){this._controlCode.set(b)},MO.FDsCommonMaterialDialog_setContentLabel=function(b){this._controlLabel.set(b)},MO.FDsCommonMaterialDialog_dispose=function(){this.__base.FUiDialog.dispose.call(this)};
with(MO)MO.FDsCommonMaterialPropertyFrame=function(b){b=RClass.inherits(this,b,FUiForm);b._visible=!1;b._workspace=null;b._activeMaterial=null;b._controlGuid=null;b._controlCode=null;b._controlLabel=null;b._frameMaterial1=null;b._frameMaterial2=null;b.onBuilded=FDsCommonMaterialPropertyFrame_onBuilded;b.onDataChanged=FDsCommonMaterialPropertyFrame_onDataChanged;b.construct=FDsCommonMaterialPropertyFrame_construct;b.loadObject=FDsCommonMaterialPropertyFrame_loadObject;b.dispose=FDsCommonMaterialPropertyFrame_dispose;
return b},MO.FDsCommonMaterialPropertyFrame_onBuilded=function(b){this.__base.FUiForm.onBuilded.call(this,b);this._controlLabel.addDataChangedListener(this,this.onDataChanged)},MO.FDsCommonMaterialPropertyFrame_onDataChanged=function(b){this._activeMaterial.resource().setLabel(this._controlLabel.get())},MO.FDsCommonMaterialPropertyFrame_construct=function(){this.__base.FUiForm.construct.call(this)},MO.FDsCommonMaterialPropertyFrame_loadObject=function(b,d){var f=d.resource();this._activeSpace=b;this._activeMaterial=
d;this._controlGuid.set(f.guid());this._controlCode.set(f.code());this._controlLabel.set(f.label());this._frameMaterial1.loadObject(b,d);this._frameMaterial2.loadObject(b,d)},MO.FDsCommonMaterialPropertyFrame_dispose=function(){this.__base.FUiForm.dispose.call(this)};
with(MO)MO.FDsCommonMaterialReferDialog=function(b){b=RClass.inherits(this,b,FUiDialog);b._frameName="resource.common.dialog.MaterialReferDialog";b._displayModeCd=null;b._controlGuid=null;b._controlCode=null;b._controlLabel=null;b._controlConfirm=null;b._controlCancel=null;b.onBuilded=FDsCommonMaterialReferDialog_onBuilded;b.onConfirmLoad=FDsCommonMaterialReferDialog_onConfirmLoad;b.onConfirmClick=FDsCommonMaterialReferDialog_onConfirmClick;b.onCancelClick=FDsCommonMaterialReferDialog_onCancelClick;
b.construct=FDsCommonMaterialReferDialog_construct;b.setContentGuid=FDsCommonMaterialReferDialog_setContentGuid;b.setContentCode=FDsCommonMaterialReferDialog_setContentCode;b.setContentLabel=FDsCommonMaterialReferDialog_setContentLabel;b.dispose=FDsCommonMaterialReferDialog_dispose;return b},MO.FDsCommonMaterialReferDialog_onBuilded=function(b){this.__base.FUiDialog.onBuilded.call(this,b);this._controlConfirm.addClickListener(this,this.onConfirmClick);this._controlCancel.addClickListener(this,this.onCancelClick)},
MO.FDsCommonMaterialReferDialog_onConfirmLoad=function(b){RConsole.find(FUiDesktopConsole).hide();this.hide()},MO.FDsCommonMaterialReferDialog_onConfirmClick=function(b){this._materialRefer._guid=this._controlGuid.get();this.hide()},MO.FDsCommonMaterialReferDialog_onCancelClick=function(b){this.hide()},MO.FDsCommonMaterialReferDialog_construct=function(){this.__base.FUiDialog.construct.call(this)},MO.FDsCommonMaterialReferDialog_setContentGuid=function(b){this._controlGuid.set(b)},MO.FDsCommonMaterialReferDialog_setContentCode=
function(b){this._controlCode.set(b)},MO.FDsCommonMaterialReferDialog_setContentLabel=function(b){this._controlLabel.set(b)},MO.FDsCommonMaterialReferDialog_dispose=function(){this.__base.FUiDialog.dispose.call(this)};
with(MO)MO.FDsCommonMovieDialog=function(b){b=RClass.inherits(this,b,FUiDialog);b._frameName="resource.common.dialog.MovieDialog";b._displayModeCd=null;b._controlLayerLabel=null;b._controlDisplayLabel=null;b._controlCode=null;b._controlLabel=null;b._controlTemplateCode=null;b._controlConfirmButton=null;b._controlCancelButton=null;b.onBuilded=FDsCommonMovieDialog_onBuilded;b.onConfirmLoad=FDsCommonMovieDialog_onConfirmLoad;b.onConfirmClick=FDsCommonMovieDialog_onConfirmClick;b.onCancelClick=FDsCommonMovieDialog_onCancelClick;
b.construct=FDsCommonMovieDialog_construct;b.setLayerLabel=FDsCommonMovieDialog_setLayerLabel;b.setDisplayLabel=FDsCommonMovieDialog_setDisplayLabel;b.setContentCode=FDsCommonMovieDialog_setContentCode;b.setContentLabel=FDsCommonMovieDialog_setContentLabel;b.dispose=FDsCommonMovieDialog_dispose;return b},MO.FDsCommonMovieDialog_onBuilded=function(b){this.__base.FUiDialog.onBuilded.call(this,b);this._controlLayerLabel.setEditAble(!1);this._controlDisplayLabel.setEditAble(!1);this._controlConfirmButton.addClickListener(this,
this.onConfirmClick);this._controlCancelButton.addClickListener(this,this.onCancelClick)},MO.FDsCommonMovieDialog_onConfirmLoad=function(b){RConsole.find(FUiDesktopConsole).hide();this.hide()},MO.FDsCommonMovieDialog_onConfirmClick=function(b){RConsole.find(FUiDesktopConsole).showUploading();b=new TXmlNode("Action");var d=b.create("Movie");d.set("space_guid",this._spaceGuid);d.set("layer_guid",this._layerGuid);d.set("display_guid",this._displayGuid);d.set("code",this._controlCode.get());d.set("label",
this._controlLabel.get());d.set("interval",this._controlInterval.get());d.set("rotation",this._controlRotation.get());d=null;d=RConsole.find(FDrSceneConsole).createMovie(b);d.addLoadListener(this,this.onConfirmLoad)},MO.FDsCommonMovieDialog_onCancelClick=function(b){this.hide()},MO.FDsCommonMovieDialog_construct=function(){this.__base.FUiDialog.construct.call(this)},MO.FDsCommonMovieDialog_setLayerLabel=function(b){this._controlLayerLabel.set(b)},MO.FDsCommonMovieDialog_setDisplayLabel=function(b){this._controlDisplayLabel.set(b)},
MO.FDsCommonMovieDialog_setContentCode=function(b){this._controlCode.set(b)},MO.FDsCommonMovieDialog_setContentLabel=function(b){this._controlLabel.set(b)},MO.FDsCommonMovieDialog_dispose=function(){this.__base.FUiDialog.dispose.call(this)};
with(MO)MO.FDsCommonMoviePropertyFrame=function(b){b=RClass.inherits(this,b,FUiForm);b._visible=!1;b._activeSpace=null;b._activeMovie=null;b._controlGuid=null;b._controlCode=null;b._controlLabel=null;b.onBuilded=FDsCommonMoviePropertyFrame_onBuilded;b.onDataChanged=FDsCommonMoviePropertyFrame_onDataChanged;b.construct=FDsCommonMoviePropertyFrame_construct;b.loadObject=FDsCommonMoviePropertyFrame_loadObject;b.dispose=FDsCommonMoviePropertyFrame_dispose;return b},MO.FDsCommonMoviePropertyFrame_construct=
function(){this.__base.FUiForm.construct.call(this)},MO.FDsCommonMoviePropertyFrame_onBuilded=function(b){this.__base.FUiForm.onBuilded.call(this,b);this._controlCode.addDataChangedListener(this,this.onDataChanged);this._controlLabel.addDataChangedListener(this,this.onDataChanged);this._controlInterval.addDataChangedListener(this,this.onDataChanged);this._controlRotation.addDataChangedListener(this,this.onDataChanged)},MO.FDsCommonMoviePropertyFrame_onDataChanged=function(b){b=this._activeMovie;var d=
b.resource();d.setCode(this._controlCode.get());d.setLabel(this._controlLabel.get());d.setInterval(this._controlInterval.get());d.rotation().assign(this._controlRotation.get());b.reloadResource()},MO.FDsCommonMoviePropertyFrame_loadObject=function(b,d){var f=d.resource();this._activeSpace=b;this._activeMovie=d;this._controlGuid.set(f.guid());this._controlCode.set(f.code());this._controlLabel.set(f.label());this._controlInterval.set(f.interval());this._controlRotation.set(f.rotation())},MO.FDsCommonMoviePropertyFrame_dispose=
function(){this.__base.FUiForm.dispose.call(this)};
with(MO)MO.FDsCommonProgramDialog=function(b){b=RClass.inherits(this,b,FUiDialog);b._frameName="resource.common.dialog.ProgramDialog";b._displayModeCd=null;b._controlLayerLabel=null;b._controlDisplayLabel=null;b._controlCode=null;b._controlLabel=null;b._controlTemplateCode=null;b._controlConfirmButton=null;b._controlCancelButton=null;b.onBuilded=FDsCommonProgramDialog_onBuilded;b.onConfirmClick=FDsCommonProgramDialog_onConfirmClick;b.construct=FDsCommonProgramDialog_construct;b.setProgramCode=FDsCommonProgramDialog_setProgramCode;
b.setVertexSource=FDsCommonProgramDialog_setVertexSource;b.setFragmentSource=FDsCommonProgramDialog_setFragmentSource;b.dispose=FDsCommonProgramDialog_dispose;return b},MO.FDsCommonProgramDialog_onBuilded=function(b){this.__base.FUiDialog.onBuilded.call(this,b);this._controlConfirm.addClickListener(this,this.onConfirmClick)},MO.FDsCommonProgramDialog_onConfirmClick=function(b){this.hide()},MO.FDsCommonProgramDialog_construct=function(){this.__base.FUiDialog.construct.call(this)},MO.FDsCommonProgramDialog_setProgramCode=
function(b){this._controlCode.set(b)},MO.FDsCommonProgramDialog_setVertexSource=function(b,d){this._controlVertexSource.set(b);this._controlVertexTargetSource.set(d)},MO.FDsCommonProgramDialog_setFragmentSource=function(b,d){this._controlFragmentSource.set(b);this._controlFragmentTargetSource.set(d)},MO.FDsCommonProgramDialog_dispose=function(){this.__base.FUiDialog.dispose.call(this)};
with(MO)MO.FDsCommonRegionPropertyFrame=function(b){b=RClass.inherits(this,b,FUiForm);b._visible=!1;b._workspace=null;b._activeSpace=null;b._activeRegion=null;b._controlMoveSpeed=null;b._controlRotationKeySpeed=null;b._controlRotationMouseSpeed=null;b._controlOptionBackground=null;b._controlBackgroundColor=null;b.onBuilded=FDsCommonRegionPropertyFrame_onBuilded;b.onDataChanged=FDsCommonRegionPropertyFrame_onDataChanged;b.construct=FDsCommonRegionPropertyFrame_construct;b.loadObject=FDsCommonRegionPropertyFrame_loadObject;
b.dispose=FDsCommonRegionPropertyFrame_dispose;return b},MO.FDsCommonRegionPropertyFrame_onBuilded=function(b){this.__base.FUiForm.onBuilded.call(this,b);this._controlMoveSpeed.addDataChangedListener(this,this.onDataChanged);this._controlRotationKeySpeed.addDataChangedListener(this,this.onDataChanged);this._controlRotationMouseSpeed.addDataChangedListener(this,this.onDataChanged);this._controlOptionBackground.addDataChangedListener(this,this.onDataChanged);this._controlBackgroundColor.addDataChangedListener(this,
this.onDataChanged)},MO.FDsCommonRegionPropertyFrame_onDataChanged=function(b){b=this._activeRegion;var d=b.resource();d.setOptionBackground(this._controlOptionBackground.get());d.backgroundColor().assign(this._controlBackgroundColor.get());d.setMoveSpeed(this._controlMoveSpeed.get());d.setRotationKeySpeed(this._controlRotationKeySpeed.get());d.setRotationMouseSpeed(this._controlRotationMouseSpeed.get());b.reloadResource();this._frameSet._canvasContent.reloadRegion(b)},MO.FDsCommonRegionPropertyFrame_construct=
function(){this.__base.FUiForm.construct.call(this)},MO.FDsCommonRegionPropertyFrame_loadObject=function(b,d){var f=d.resource();this._activeSpace=b;this._activeRegion=d;this._controlMoveSpeed.set(f.moveSpeed());this._controlRotationKeySpeed.set(f.rotationKeySpeed());this._controlRotationMouseSpeed.set(f.rotationMouseSpeed());this._controlOptionBackground.set(f.optionBackground());this._controlBackgroundColor.set(f.backgroundColor())},MO.FDsCommonRegionPropertyFrame_dispose=function(){this.__base.FUiForm.dispose.call(this)};
with(MO)MO.FDsCommonRenderableFrame=function(b){b=RClass.inherits(this,b,FUiForm);b._activeSpace=null;b._activeRenderable=null;b.onBuilded=FDsCommonRenderableFrame_onBuilded;b.onDataChanged=FDsCommonRenderableFrame_onDataChanged;b.onMaterialClick=FDsCommonRenderableFrame_onMaterialClick;b.onEffectClick=FDsCommonRenderableFrame_onEffectClick;b.construct=FDsCommonRenderableFrame_construct;b.loadObject=FDsCommonRenderableFrame_loadObject;b.dispose=FDsCommonRenderableFrame_dispose;return b},MO.FDsCommonRenderableFrame_onBuilded=
function(b){this.__base.FUiForm.onBuilded.call(this,b);this._controlTranslate.addDataChangedListener(this,this.onDataChanged);this._controlRotation.addDataChangedListener(this,this.onDataChanged);this._controlScale.addDataChangedListener(this,this.onDataChanged);this._controlMaterials.addClickListener(this,this.onMaterialClick);this._controlEffects.addClickListener(this,this.onEffectClick)},MO.FDsCommonRenderableFrame_onDataChanged=function(b){b=this._activeRenderable.matrix();var d=this._controlTranslate.get();
b.setTranslate(d.x,d.y,d.z);d=this._controlRotation.get();b.setRotation(d.x,d.y,d.z);d=this._controlScale.get();b.setScale(d.x,d.y,d.z);b.update()},MO.FDsCommonRenderableFrame_onMaterialClick=function(b){b=b.item.tag();var d=RConsole.find(FUiWindowConsole).find(FDsCommonMaterialReferDialog);d._frame=this;d._materialRefer=b;d.setContentCode("");d.setContentLabel("");d.showPosition(EUiPosition.Center)},MO.FDsCommonRenderableFrame_onEffectClick=function(b){b=b.item.tag();var d=b._program,f=d.vertexShader(),
d=d.fragmentShader(),h=RConsole.find(FUiWindowConsole).find(FDsCommonProgramDialog);h._frameSet=this._frameSet;h.setProgramCode(b._code);h.setVertexSource(f.source(),f.targetSource());h.setFragmentSource(d.source(),d.targetSource());h.showPosition(EUiPosition.Center)},MO.FDsCommonRenderableFrame_construct=function(){this.__base.FUiForm.construct.call(this)},MO.FDsCommonRenderableFrame_loadObject=function(b,d){this._activeSpace=b;this._activeRenderable=d;var f=d.resource(),h=d.matrix();this._controlTranslate.set(h.tx,
h.ty,h.tz);this._controlRotation.set(h.rx,h.ry,h.rz);this._controlScale.set(h.sx,h.sy,h.sz);if(f){var q=this._controlMaterials;q.clear();for(var h=d.indexBuffers().count(),w=0;w<h;w++){var z=f.syncMaterialRefer(w),A=q.createItem(null,w+": "+z.guid());A.setTag(z);q.push(A)}}f=this._controlEffects;f.clear();q=d.infos();h=q.count();for(w=0;w<h;w++)if(z=q.at(w).effect)A=f.createItem(null,z.code()),A.setTag(z),f.push(A)},MO.FDsCommonRenderableFrame_dispose=function(){this.__base.FUiForm.dispose.call(this)};
with(MO)MO.FDsCommonRenderablePropertyFrame=function(b){b=RClass.inherits(this,b,FUiForm);b._visible=!1;b._activeRenderable=null;b._activeMaterial=null;b._controlGuid=null;b._controlCode=null;b._controlLabel=null;b._frameRenderable=null;b._frameMaterial1=null;b._frameMaterial2=null;b.construct=FDsCommonRenderablePropertyFrame_construct;b.loadObject=FDsCommonRenderablePropertyFrame_loadObject;b.dispose=FDsCommonRenderablePropertyFrame_dispose;return b},MO.FDsCommonRenderablePropertyFrame_construct=
function(){this.__base.FUiForm.construct.call(this)},MO.FDsCommonRenderablePropertyFrame_loadObject=function(b,d){var f=d.material(),h=d.renderable().resource();this._activeRenderable=d;this._activeMaterial=f;this._controlGuid.set(h.guid());this._controlCode.set(h.code());this._controlLabel.set(h.label());this._frameRenderable.loadObject(b,d);this._frameMaterial1.loadObject(b,f);this._frameMaterial2.loadObject(b,f)},MO.FDsCommonRenderablePropertyFrame_dispose=function(){this.__base.FUiForm.dispose.call(this)};
with(MO)MO.FDsCommonShaderDialog=function(b){b=RClass.inherits(this,b,FUiDialog);b._frameName="resource.common.dialog.ShaderDialog";b._displayModeCd=null;b._controlLayerLabel=null;b._controlDisplayLabel=null;b._controlCode=null;b._controlLabel=null;b._controlTemplateCode=null;b._controlConfirmButton=null;b._controlCancelButton=null;b.onBuilded=FDsCommonShaderDialog_onBuilded;b.onConfirmLoad=FDsCommonShaderDialog_onConfirmLoad;b.onConfirmClick=FDsCommonShaderDialog_onConfirmClick;b.onCancelClick=FDsCommonShaderDialog_onCancelClick;
b.construct=FDsCommonShaderDialog_construct;b.setSpace=FDsCommonShaderDialog_setSpace;b.setDisplayLabel=FDsCommonShaderDialog_setDisplayLabel;b.setVertexSource=FDsCommonShaderDialog_setVertexSource;b.setFragmentSource=FDsCommonShaderDialog_setFragmentSource;b.dispose=FDsCommonShaderDialog_dispose;return b},MO.FDsCommonShaderDialog_onBuilded=function(b){this.__base.FUiDialog.onBuilded.call(this,b);this._controlConfirm.addClickListener(this,this.onConfirmClick)},MO.FDsCommonShaderDialog_onConfirmClick=
function(b){this.hide()},MO.FDsCommonShaderDialog_construct=function(){this.__base.FUiDialog.construct.call(this)},MO.FDsCommonShaderDialog_setSpace=function(b){},MO.FDsCommonShaderDialog_setDisplayLabel=function(b){},MO.FDsCommonShaderDialog_setVertexSource=function(b){},MO.FDsCommonShaderDialog_setFragmentSource=function(b){},MO.FDsCommonShaderDialog_dispose=function(){this.__base.FUiDialog.dispose.call(this)};
with(MO)MO.FDsCommonSpacePropertyFrame=function(b){b=RClass.inherits(this,b,FUiForm);b._visible=!1;b._workspace=null;b._activeSpace=null;b._controlGuid=null;b._controlCode=null;b._controlLabel=null;b.onBuilded=FDsCommonSpacePropertyFrame_onBuilded;b.onDataChanged=FDsCommonSpacePropertyFrame_onDataChanged;b.construct=FDsCommonSpacePropertyFrame_construct;b.loadObject=FDsCommonSpacePropertyFrame_loadObject;b.dispose=FDsCommonSpacePropertyFrame_dispose;return b},MO.FDsCommonSpacePropertyFrame_onBuilded=
function(b){this.__base.FUiForm.onBuilded.call(this,b);this._controlLabel.addDataChangedListener(this,this.onDataChanged)},MO.FDsCommonSpacePropertyFrame_onDataChanged=function(b){this._activeSpace.resource().setLabel(this._controlLabel.get())},MO.FDsCommonSpacePropertyFrame_construct=function(){this.__base.FUiForm.construct.call(this)},MO.FDsCommonSpacePropertyFrame_loadObject=function(b){var d=b.resource();this._activeSpace=b;this._controlGuid.set(d.guid());this._controlCode.set(d.code());this._controlLabel.set(d.label())},
MO.FDsCommonSpacePropertyFrame_dispose=function(){this.__base.FUiForm.dispose.call(this)};
with(MO)MO.FDsCommonSpriteDialog=function(b){b=RClass.inherits(this,b,FUiDialog);b._frameName="resource.common.dialog.SpriteDialog";b._displayModeCd=null;b._controlLayerLabel=null;b._controlDisplayLabel=null;b._controlCode=null;b._controlLabel=null;b._controlTemplateCode=null;b._controlConfirmButton=null;b._controlCancelButton=null;b.onBuilded=FDsCommonSpriteDialog_onBuilded;b.onConfirmLoad=FDsCommonSpriteDialog_onConfirmLoad;b.onConfirmClick=FDsCommonSpriteDialog_onConfirmClick;b.onCancelClick=FDsCommonSpriteDialog_onCancelClick;
b.construct=FDsCommonSpriteDialog_construct;b.setLayerLabel=FDsCommonSpriteDialog_setLayerLabel;b.setDisplayLabel=FDsCommonSpriteDialog_setDisplayLabel;b.setContentCode=FDsCommonSpriteDialog_setContentCode;b.setContentLabel=FDsCommonSpriteDialog_setContentLabel;b.dispose=FDsCommonSpriteDialog_dispose;return b},MO.FDsCommonSpriteDialog_onBuilded=function(b){this.__base.FUiDialog.onBuilded.call(this,b);this._controlLayerLabel.setEditAble(!1);this._controlDisplayLabel.setEditAble(!1);this._controlConfirmButton.addClickListener(this,
this.onConfirmClick);this._controlCancelButton.addClickListener(this,this.onCancelClick)},MO.FDsCommonSpriteDialog_onConfirmLoad=function(b){RConsole.find(FUiDesktopConsole).hide();this.hide();b=this._frameSet._catalogContent;if(this._displayModeCd==EUiDataMode.Insert)if(this._parentGuid){var d=b.findByGuid(this._parentGuid);b.loadNode(d)}else b.loadService();else{var f=this._controlLabel.get(),d=b.focusNode();d.setLabel(f)}},MO.FDsCommonSpriteDialog_onConfirmClick=function(b){RConsole.find(FUiDesktopConsole).showUploading();
b=new TXmlNode("Action");var d=b.create("Sprite");d.set("space_guid",this._spaceGuid);d.set("layer_guid",this._layerGuid);d.set("display_guid",this._displayGuid);d.set("code",this._controlCode.get());d.set("label",this._controlLabel.get());d.set("template_guid",this._controlTemplateGuid.get());d.set("template_code",this._controlTemplateCode.get());d=null;d=RConsole.find(FDrSceneConsole).createSprite(b);d.addLoadListener(this,this.onConfirmLoad)},MO.FDsCommonSpriteDialog_onCancelClick=function(b){this.hide()},
MO.FDsCommonSpriteDialog_construct=function(){this.__base.FUiDialog.construct.call(this)},MO.FDsCommonSpriteDialog_setLayerLabel=function(b){this._controlLayerLabel.set(b)},MO.FDsCommonSpriteDialog_setDisplayLabel=function(b){this._controlDisplayLabel.set(b)},MO.FDsCommonSpriteDialog_setContentCode=function(b){this._controlCode.set(b)},MO.FDsCommonSpriteDialog_setContentLabel=function(b){this._controlLabel.set(b)},MO.FDsCommonSpriteDialog_dispose=function(){this.__base.FUiDialog.dispose.call(this)};
with(MO)MO.FDsCommonTechniquePropertyFrame=function(b){b=RClass.inherits(this,b,FUiForm);b._visible=!1;b._workspace=null;b._activeSpace=null;b._activeTechnique=null;b._controlTriangleCount=null;b._controlDrawCount=null;b._thread=null;b._interval=2E3;b.onBuilded=FDsCommonTechniquePropertyFrame_onBuilded;b.onDataChanged=FDsCommonTechniquePropertyFrame_onDataChanged;b.onModeClick=FDsCommonTechniquePropertyFrame_onModeClick;b.onRefresh=FDsCommonTechniquePropertyFrame_onRefresh;b.construct=FDsCommonTechniquePropertyFrame_construct;
b.loadObject=FDsCommonTechniquePropertyFrame_loadObject;b.dispose=FDsCommonTechniquePropertyFrame_dispose;return b},MO.FDsCommonTechniquePropertyFrame_onBuilded=function(b){this.__base.FUiForm.onBuilded.call(this,b);this._controlRenderModes.addClickListener(this,this.onModeClick)},MO.FDsCommonTechniquePropertyFrame_onDataChanged=function(b){b=this._activeTechnique;b._code=this._controlCode.get();b._label=this._controlLabel.get();b._activeTechniqueCode=this._controlTechniqueCode.get()},MO.FDsCommonTechniquePropertyFrame_onModeClick=
function(b,d){var f=d.tag();this._activeTechnique._activeMode=f;this._activeSpace.dirty()},MO.FDsCommonTechniquePropertyFrame_onRefresh=function(){if(this._statusVisible){var b=this._activeSpace,d=b.statistics(),b=b._graphicContext.statistics();this._controlFrameTick.set(d._frame.toString());this._controlProcessTick.set(d._frameProcess.toString()+" | "+d._frameDrawRenderable.toString());this._controlDrawTick.set(d._frameDraw.toString()+" | "+d._frameDrawSort.toString());this._controlClearCount.set(b._frameClearCount);
this._controlModeInfo.set("FIL:"+b._frameFillModeCount+" | DEP:"+b._frameDepthModeCount+" | CUL:"+b._frameCullModeCount+" | BLD:"+b._frameBlendModeCount);this._controlProgramCount.set(b._frameProgramCount);this._controlConstInfo.set(b._frameConstCount+" : length="+b._frameConstLength);this._controlBufferCount.set(b._frameBufferCount);this._controlTextureCount.set(b._frameTextureCount);this._controlTargetCount.set(b._frameTargetCount);this._controlDrawInfo.set(b._frameDrawCount+" : triangle="+b._frameTriangleCount);
this._controlProgramTotal.set(b._programTotal);this._controlLayoutTotal.set(b._layoutTotal);this._controlBufferInfo.set("Vertex:"+b._vertexBufferTotal+" Index:"+b._indexBufferTotal);this._controlTextureInfo.set("Flat:"+b._flatTextureTotal+" Cube:"+b._cubeTextureTotal);this._controlTargetTotal.set(b._targetTotal)}},MO.FDsCommonTechniquePropertyFrame_construct=function(){this.__base.FUiForm.construct.call(this);var b=this._thread=RClass.create(FThread);b.setInterval(this._interval);b.addProcessListener(this,
this.onRefresh);RConsole.find(FThreadConsole).start(b)},MO.FDsCommonTechniquePropertyFrame_loadObject=function(b,d){this._activeSpace=b;this._activeTechnique=d;var f=this._controlRenderModes;f.clear();for(var h=d.modes(),q=h.count(),w=0;w<q;w++){var z=h.getAt(w),A=f.createItem(null,z.code());A.setTag(z);f.push(A)}this.onRefresh()},MO.FDsCommonTechniquePropertyFrame_dispose=function(){this.__base.FUiForm.dispose.call(this)};
with(MO)MO.FDsCommonTemplateDialog=function(b){b=RClass.inherits(this,b,FUiDialog);b._frameName="resource.common.dialog.TemplateDialog";b._displayModeCd=null;b._controlLayerLabel=null;b._controlDisplayLabel=null;b._controlCode=null;b._controlLabel=null;b._controlTemplateCode=null;b._controlConfirmButton=null;b._controlCancelButton=null;b.onBuilded=FDsCommonTemplateDialog_onBuilded;b.onConfirmLoad=FDsCommonTemplateDialog_onConfirmLoad;b.onConfirmClick=FDsCommonTemplateDialog_onConfirmClick;b.onCancelClick=
FDsCommonTemplateDialog_onCancelClick;b.construct=FDsCommonTemplateDialog_construct;b.setSpace=FDsCommonTemplateDialog_setSpace;b.setDisplayLabel=FDsCommonTemplateDialog_setDisplayLabel;b.setContentCode=FDsCommonTemplateDialog_setContentCode;b.setContentLabel=FDsCommonTemplateDialog_setContentLabel;b.dispose=FDsCommonTemplateDialog_dispose;return b},MO.FDsCommonTemplateDialog_onBuilded=function(b){this.__base.FUiDialog.onBuilded.call(this,b);this._controlConfirm.addClickListener(this,this.onConfirmClick);
this._controlCancel.addClickListener(this,this.onCancelClick)},MO.FDsCommonTemplateDialog_onConfirmLoad=function(b){RConsole.find(FUiDesktopConsole).hide();this.hide()},MO.FDsCommonTemplateDialog_onConfirmClick=function(b){RConsole.find(FUiDesktopConsole).showUploading();b=new TXmlNode("Action");var d=b.create("Display");d.set("space_guid",this._spaceGuid);d.set("code",this._controlCode.get());d.set("label",this._controlLabel.get());d.set("model_guid",this._controlModelGuid.get());d.set("model_code",
this._controlModelCode.get());RConsole.find(FDrTemplateConsole).createDisplay(b).addLoadListener(this,this.onConfirmLoad)},MO.FDsCommonTemplateDialog_onCancelClick=function(b){this.hide()},MO.FDsCommonTemplateDialog_construct=function(){this.__base.FUiDialog.construct.call(this)},MO.FDsCommonTemplateDialog_setSpace=function(b){b=b.resource();this._controlSpaceGuid.set(b.guid());this._controlSpaceLabel.set(b.makeLabel())},MO.FDsCommonTemplateDialog_setDisplayLabel=function(b){this._controlDisplayLabel.set(b)},
MO.FDsCommonTemplateDialog_setContentCode=function(b){this._controlCode.set(b)},MO.FDsCommonTemplateDialog_setContentLabel=function(b){this._controlLabel.set(b)},MO.FDsCommonTemplateDialog_dispose=function(){this.__base.FUiDialog.dispose.call(this)};
with(MO)MO.FDsSolutionCatalogContent=function(b){b=RClass.inherits(this,b,FUiDataTreeView,MListenerSelected);b._iconView="resource.solution.view";b._iconViewNot="resource.solution.viewno";b._activeSpace=null;b._materials=null;b.onLoaded=FDsSolutionCatalogContent_onLoaded;b.onBuild=FDsSolutionCatalogContent_onBuild;b.onLoadDisplay=FDsSolutionCatalogContent_onLoadDisplay;b.onNodeClick=FDsSolutionCatalogContent_onNodeClick;b.onNodeViewClick=FDsSolutionCatalogContent_onNodeViewClick;b.onNodeViewDoubleClick=
FDsSolutionCatalogContent_onNodeViewDoubleClick;b.lsnsSelect=null;b.construct=FDsSolutionCatalogContent_construct;b.buildPrivate=FDsSolutionCatalogContent_buildPrivate;b.buildRecommend=FDsSolutionCatalogContent_buildRecommend;b.buildGroup=FDsSolutionCatalogContent_buildGroup;b.buildCatalog=FDsSolutionCatalogContent_buildCatalog;b.selectObject=FDsSolutionCatalogContent_selectObject;b.showObject=FDsSolutionCatalogContent_showObject;b.dispose=FDsSolutionCatalogContent_dispose;return b},MO.FDsSolutionCatalogContent_onLoaded=
function(b){this.__base.FUiDataTreeView.onLoaded.call(this,b);this.buildCatalog()},MO.FDsSolutionCatalogContent_onBuild=function(b){this.__base.FUiDataTreeView.onBuild.call(this,b);this.addNodeClickListener(this,this.onNodeClick);this.loadUrl("/cloud.describe.tree.ws?action=query&code=resource.solution")},MO.FDsSolutionCatalogContent_onLoadDisplay=function(b){this.buildRecommend(b._linkNode,b)},MO.FDsSolutionCatalogContent_onNodeClick=function(b,d){var f=d.dataPropertyGet("linker");this.selectObject(f)},
MO.FDsSolutionCatalogContent_onNodeViewClick=function(b){var d=b.treeNodeCell,f=b.treeNode.dataPropertyGet("linker");if(RClass.isClass(f,FDisplay))if(b.ctrlKey){for(var h=this._displays,q=h.count()-1;0<=q;q--){var w=h.get(q);w.dataPropertyGet("linker")._visible=!1;w.cell("view").setIcon(this._iconViewNot)}f._visible=!0;d.setIcon(this._iconView)}else f._visible=!f._visible,d.setIcon(f._visible?this._iconView:this._iconViewNot);if(RClass.isClass(f,FDrawable))if(b.ctrlKey){h=this._renderables;for(q=
h.count()-1;0<=q;q--)w=h.get(q),w.dataPropertyGet("linker")._visible=!1,w.cell("view").setIcon(this._iconViewNot);f._visible=!0;d.setIcon(this._iconView)}else f._visible=!f._visible,d.setIcon(f._visible?this._iconView:this._iconViewNot);if(RClass.isClass(f,FG3dMaterial))if(b.ctrlKey){b=this._materials;for(q=b.count()-1;0<=q;q--)h=b.get(q),h.dataPropertyGet("linker")._visible=!1,h.cell("view").setIcon(this._iconViewNot);f._visible=!0;d.setIcon(this._iconView)}else f._visible=!f._visible,d.setIcon(f._visible?
this._iconView:this._iconViewNot)},MO.FDsSolutionCatalogContent_onNodeViewDoubleClick=function(b){b=b.treeNode;var d=b.dataPropertyGet("linker");if(RClass.isClass(d,FDisplay))for(var d=this._displays,f=d.count()-1;0<=f;f--)b=d.get(f),b.dataPropertyGet("linker")._visible=!0,b.cell("view").setIcon(this._iconView);if(RClass.isClass(d,FDrawable))for(d=this._renderables,f=d.count()-1;0<=f;f--)b=d.get(f),b.dataPropertyGet("linker")._visible=!0,b.cell("view").setIcon(this._iconView);if(RClass.isClass(d,
FG3dMaterial))for(d=this._materials,f=d.count()-1;0<=f;f--)b=d.get(f),b.dataPropertyGet("linker")._visible=!0,b.cell("view").setIcon(this._iconView)},MO.FDsSolutionCatalogContent_construct=function(){this.__base.FUiDataTreeView.construct.call(this);this._renderables=new TObjects;this._materials=new TObjects},MO.FDsSolutionCatalogContent_buildTechnique=function(b,d){var f=this.createNode();f.setLabel("Technique");f.setTypeCode("technique");f.dataPropertySet("linker",d);b.appendNode(f)},MO.FDsSolutionCatalogContent_buildPrivate=
function(b){var d=this.createNode();d.setTypeCode("space");d.setLabel("\u5168\u90e8\u9879\u76ee");b.appendNode(d);d=this.createNode();d.setTypeCode("space");d.setLabel("\u6536\u85cf\u9879\u76ee");b.appendNode(d);d=this.createNode();d.setTypeCode("space");d.setLabel("\u6700\u8fd1\u4f7f\u7528");b.appendNode(d)},MO.FDsSolutionCatalogContent_buildRecommend=function(b){var d=this.createNode();d.setTypeCode("space");d.setLabel("\u672c\u5468\u6392\u884c");b.appendNode(d);d=this.createNode();d.setTypeCode("space");
d.setLabel("\u672c\u6708\u6392\u884c");b.appendNode(d);d=this.createNode();d.setTypeCode("space");d.setLabel("\u5168\u90e8\u6392\u884c");b.appendNode(d)},MO.FDsSolutionCatalogContent_buildGroup=function(b){var d=this.createNode();d.setTypeCode("space");d.setLabel("\u6c7d\u8f66");b.appendNode(d);d=this.createNode();d.setTypeCode("space");d.setLabel("\u6559\u80b2");b.appendNode(d);d=this.createNode();d.setTypeCode("space");d.setLabel("\u4eba\u7269");b.appendNode(d)},MO.FDsSolutionCatalogContent_buildCatalog=
function(){var b=this.createNode();b.setTypeCode("space");b.setLabel("\u6211\u7684\u9879\u76ee");this.appendNode(b);this.buildPrivate(b);b=this.createNode();b.setTypeCode("space");b.setLabel("\u63a8\u8350\u9879\u76ee");this.appendNode(b);this.buildRecommend(b);b=this.createNode();b.setTypeCode("space");b.setLabel("\u9879\u76ee\u5206\u7c7b");this.appendNode(b);this.buildGroup(b)},MO.FDsSolutionCatalogContent_selectObject=function(b){null!=b&&this.processSelectedListener(b,!0)},MO.FDsSolutionCatalogContent_showObject=
function(b){if(RClass.isClass(b,FDsSceneRenderable))for(var d=this._renderables,f=d.count(),h=0;h<f;h++)d.getAt(h).dataPropertyGet("linker")==b&&this.processSelectedListener(b,!1)},MO.FDsSolutionCatalogContent_dispose=function(){this._displays=RObject.dispose(this._displays);this._renderables=RObject.dispose(this._renderables);this._materials=RObject.dispose(this._materials);this.__base.FUiDataTreeView.dispose.call(this)};
with(MO)MO.FDsSolutionCatalogToolBar=function(b){b=RClass.inherits(this,b,FUiToolBar);b._frameName="resource.private.solution.CatalogToolBar";b._canvasModeCd=EDsCanvasMode.Drop;b._dropButton=null;b._selectButton=null;b._translateButton=null;b._rotationButton=null;b._scaleButton=null;b._lookFrontButton=null;b._lookUpButton=null;b._lookLeftButton=null;b._playButton=null;b._viewButton=null;b.onBuilded=FDsSolutionCatalogToolBar_onBuilded;b.onModeClick=FDsSolutionCatalogToolBar_onModeClick;b.onRotationClick=
FDsSolutionCatalogToolBar_onRotationClick;b.construct=FDsSolutionCatalogToolBar_construct;b.dispose=FDsSolutionCatalogToolBar_dispose;return b},MO.FDsSolutionCatalogToolBar_onBuilded=function(b){this.__base.FUiToolBar.onBuilded.call(this,b)},MO.FDsSolutionCatalogToolBar_onModeClick=function(b){this._canvasModeCd=b._canvasModeCd;this._workspace._canvas.switchMode(b._canvasModeCd)},MO.FDsSolutionCatalogToolBar_onRotationClick=function(b,d){this._workspace._canvas.switchRotation(d)},MO.FDsSolutionCatalogToolBar_construct=
function(){this.__base.FUiToolBar.construct.call(this)},MO.FDsSolutionCatalogToolBar_dispose=function(){this.__base.FUiToolBar.dispose.call(this)};
with(MO)MO.FDsSolutionFrameSet=function(b){b=RClass.inherits(this,b,FUiFrameSet,MUiStorage);b._frameName="resource.private.solution.FrameSet";b._storageCode=b._frameName;b._styleCatalogGround=RClass.register(b,new AStyle("_styleCatalogGround","Catalog_Ground"));b._styleCatalogToolbar=RClass.register(b,new AStyle("_styleCatalogToolbar","Catalog_Toolbar"));b._styleSearchGround=RClass.register(b,new AStyle("_styleSearchGround","List_Ground"));b._styleSearchToolbar=RClass.register(b,new AStyle("_styleCatalogToolbar",
"List_Toolbar"));b._stylePreviewGround=RClass.register(b,new AStyle("_stylePreviewGround","Property_Ground"));b._stylePreviewToolbar=RClass.register(b,new AStyle("_stylePreviewToolbar","Property_Toolbar"));b._stylePropertyGround=RClass.register(b,new AStyle("_stylePropertyGround","Property_Ground"));b._pageSize=40;b._activeResourceCd="private";b._activeProjectGuid=null;b._frameCatalog=null;b._frameCatalogToolbar=null;b._frameCatalogContent=null;b._frameList=null;b._frameListToolbar=null;b._frameListContent=
null;b._frameProperty=null;b._framePropertyToolbar=null;b._framePropertyContent=null;b._propertyFrames=null;b.onBuilded=FDsSolutionFrameSet_onBuilded;b.construct=FDsSolutionFrameSet_construct;b.findPropertyFrame=FDsSolutionFrameSet_findPropertyFrame;b.selectObject=FDsSolutionFrameSet_selectObject;b.switchContent=FDsSolutionFrameSet_switchContent;b.load=FDsSolutionFrameSet_load;b.dispose=FDsSolutionFrameSet_dispose;return b},MO.FDsSolutionFrameSet_onBuilded=function(b){this.__base.FUiFrameSet.onBuilded.call(this,
b);var d=this._frameCatalog=this.searchControl("catalogFrame");d._hPanel.className=this.styleName("Catalog_Ground");d=this._frameCatalogToolbar=this.searchControl("catalogToolbarFrame");d._hPanel.className=this.styleName("Catalog_Toolbar");this._frameCatalogContent=this.searchControl("catalogContentFrame");d=this._frameList=this.searchControl("listFrame");d._hPanel.className=this.styleName("List_Ground");d=this._frameListToolbar=this.searchControl("listToolbarFrame");d._hPanel.className=this.styleName("List_Toolbar");
this._frameListContent=this.searchControl("listContentFrame");d=this._catalogSplitter=this.searchControl("catalogSpliter");d.setAlignCd(EUiAlign.Left);d.setSizeHtml(this._frameCatalog._hPanel);d=this._catalogToolbar=RClass.create(FDsSolutionCatalogToolBar);d._frameSet=this;d.buildDefine(b);this._frameCatalogToolbar.push(d);d=this._catalogContent=RClass.create(FDsSolutionCatalogContent);d._frameSet=this;d.build(b);this._frameCatalogContent.push(d);d=this._listToolbar=RClass.create(FDsSolutionListToolBar);
d._frameSet=this;d.buildDefine(b);this._frameListToolbar.push(d);d=this._listContent=RClass.create(FDsSolutionListContent);d._frameSet=this;d.build(b);this._frameListContent.push(d);this.switchContent("private")},MO.FDsSolutionFrameSet_construct=function(){this.__base.FUiFrameSet.construct.call(this);this._propertyFrames=new TDictionary},MO.FDsSolutionFrameSet_findPropertyFrame=function(b){var d=this._propertyFrames.get(b);d||(d=RConsole.find(FFrameConsole).get(this,b,this._framePropertyProperty._hContainer),
d._workspace=this,this._propertyFrames.set(b,d));return d},MO.FDsSolutionFrameSet_selectObject=function(b){for(var d=this._propertyFrames,f=d.count(),h=0;h<f;h++){var q=d.value(h);q.hide()}if(RClass.isClass(b,FDsSolutionListItem))q=this.findPropertyFrame(EDsFrame.SolutionProjectPropertyFrame),q.show(),q.loadObject(b),this._activeProjectGuid=b._guid;else throw new TError("Unknown select object type. (value={1})",p);},MO.FDsSolutionFrameSet_switchContent=function(b){this._activeResourceCd=b;this._listContent.serviceSearch(b,
"",this._pageSize,0)},MO.FDsSolutionFrameSet_load=function(){this._listContent.serviceSearch("private","",this._pageSize,0)},MO.FDsSolutionFrameSet_dispose=function(){this.__base.FUiFrameSet.dispose.call(this);this._propertyFrames.dispose();this._propertyFrames=null};
with(MO)MO.FDsSolutionListContent=function(b){b=RClass.inherits(this,b,FUiListView);b._activeControl=null;b._activeGuid=null;b._refreshButton=null;b._saveButton=null;b._runButton=null;b.onBuilded=FDsSolutionListContent_onBuilded;b.onServiceLoad=FDsSolutionListContent_onServiceLoad;b.construct=FDsSolutionListContent_construct;b.doClickItem=FDsSolutionListContent_doClickItem;b.doDoubleClickItem=FDsSolutionListContent_doDoubleClickItem;b.serviceSearch=FDsSolutionListContent_serviceSearch;b.serviceResearch=
FDsSolutionListContent_serviceResearch;b.dispose=FDsSolutionListContent_dispose;return b},MO.FDsSolutionListContent_onBuilded=function(b){this.__base.FUiListView.onBuilded.call(this,b)},MO.FDsSolutionListContent_onServiceLoad=function(b){b=b.root.findNode("ProjectCollection");var d=b.getInteger("page_size"),f=b.getInteger("page_count"),h=b.getInteger("page");this._frameSet._listToolbar.setNavigator(d,f,h);this.clear();b=b.nodes();d=b.count();for(f=0;f<d;f++)if(h=b.getAt(f),h.isName("Project")){var q=
this.createItem(FDsSolutionListItem);q.propertyLoad(h);q._typeCd=h.get("type");q._guid=h.get("guid");q.setLabel(RString.nvl(h.get("label"),h.get("code")));q.refreshStyle();this.push(q)}RWindow.enable()},MO.FDsSolutionListContent_construct=function(){this.__base.FUiListView.construct.call(this)},MO.FDsSolutionListContent_doClickItem=function(b){this.__base.FUiListView.doClickItem.call(this,b);this._activeControl=b;this._activeGuid=b._guid},MO.FDsSolutionListContent_doDoubleClickItem=function(b){this.__base.FUiListView.doDoubleClickItem.call(this,
b);var d=b._guid;this._activeControl=b;this._activeGuid=d;this._frameSet._workspace.selectFrameSet(EDsFrameSet.PrivateProjectFrameSet,d)},MO.FDsSolutionListContent_serviceSearch=function(b,d,f,h){this._typeCd=b;this._serach=d;this._pageSize=f;this._page=h;RWindow.disable();RConsole.find(FDrProjectConsole).doList(d,null,f,h).addLoadListener(this,this.onServiceLoad)},MO.FDsSolutionListContent_serviceResearch=function(){this.serviceSearch(this._typeCd,this._serach,this._pageSize,this._page)},MO.FDsSolutionListContent_dispose=
function(){this.__base.FUiListView.dispose.call(this)};
with(MO)MO.FDsSolutionListItem=function(b){b=RClass.inherits(this,b,FUiListViewItem);b.onBuild=FDsSolutionListItem_onBuild;b.refreshStyle=FDsSolutionListItem_refreshStyle;return b},MO.FDsSolutionListItem_onBuild=function(b){this.__base.FUiListViewItem.onBuild.call(this,b);b=this._hPanel;b.style.width="200px";b.style.height="150px"},MO.FDsSolutionListItem_refreshStyle=function(){this._hForm.style.backgroundImage='url("'+("/cloud.content.resource.preview.wv?type_cd="+this._typeCd+"&guid="+this._guid)+
'")'};
with(MO)MO.FDsSolutionListToolBar=function(b){b=RClass.inherits(this,b,FUiToolBar);b._frameName="resource.private.solution.ListToolBar";b._pageCount=0;b._page=0;b._serach=null;b._resourceTypeCd=null;b._dropButton=null;b._selectButton=null;b._translateButton=null;b._rotationButton=null;b._scaleButton=null;b._lookFrontButton=null;b._lookUpButton=null;b._lookLeftButton=null;b._playButton=null;b._viewButton=null;b.onBuilded=FDsSolutionListToolBar_onBuilded;b.onSearchClick=FDsSolutionListToolBar_onSearchClick;b.onNavigatorClick=
FDsSolutionListToolBar_onNavigatorClick;b.construct=FDsSolutionListToolBar_construct;b.setNavigator=FDsSolutionListToolBar_setNavigator;b.doNavigator=FDsSolutionListToolBar_doNavigator;b.dispose=FDsSolutionListToolBar_dispose;return b},MO.FDsSolutionListToolBar_onBuilded=function(b){this.__base.FUiToolBar.onBuilded.call(this,b);this._controlSearchEdit.addClickListener(this,this.onSearchClick);this._controlFirstButton.addClickListener(this,this.onNavigatorClick);this._controlPriorButton.addClickListener(this,
this.onNavigatorClick);this._controlNextButton.addClickListener(this,this.onNavigatorClick);this._controlLastButton.addClickListener(this,this.onNavigatorClick)},MO.FDsSolutionListToolBar_onSearchClick=function(b){this.doNavigator(0)},MO.FDsSolutionListToolBar_onNavigatorClick=function(b){b=b.sender.name();var d=this._page;switch(b){case "firstButton":d=0;break;case "priorButton":d--;break;case "nextButton":d++;break;case "lastButton":d=this._pageCount}this.doNavigator(d)},MO.FDsSolutionListToolBar_construct=
function(){this.__base.FUiToolBar.construct.call(this)},MO.FDsSolutionListToolBar_setNavigator=function(b,d,f){this._pageSize=b;this._pageCount=d;this._page=f;this._controlPageEdit.setText(f)},MO.FDsSolutionListToolBar_doNavigator=function(b){b=RInteger.toRange(b,0,this._pageCount);var d=this._controlSearchEdit.text(),f=this._frameSet._resourceTypeCd;this._resourceTypeCd==f&&this._serach==d&&this._page==b||this._frameSet._searchContent.serviceSearch(f,d,this._pageSize,b);this._resourceTypeCd=f;this._serach=
d},MO.FDsSolutionListToolBar_dispose=function(){this.__base.FUiToolBar.dispose.call(this)};
with(MO)MO.FDsSolutionMenuBar=function(b){b=RClass.inherits(this,b,FUiMenuBar);b._frameName="resource.private.solution.MenuBar";b._refreshButton=null;b._saveButton=null;b._runButton=null;b.onBuilded=FDsSolutionMenuBar_onBuilded;b.onCreateClick=FDsSolutionMenuBar_onCreateClick;b.onDeleteLoad=FDsSolutionMenuBar_onDeleteLoad;b.onDeleteExecute=FDsSolutionMenuBar_onDeleteExecute;b.onDeleteClick=FDsSolutionMenuBar_onDeleteClick;b.construct=FDsSolutionMenuBar_construct;b.dispose=FDsSolutionMenuBar_dispose;
return b},MO.FDsSolutionMenuBar_onBuilded=function(b){this.__base.FUiMenuBar.onBuilded.call(this,b);this._controlCreateButton.addClickListener(this,this.onCreateClick);this._controlDeleteButton.addClickListener(this,this.onDeleteClick)},MO.FDsSolutionMenuBar_onCreateClick=function(b){b=RConsole.find(FUiWindowConsole).find(FDsSolutionProjectDialog);b._frameSet=this._frameSet;b._workspace=this._workspace;b.showPosition(EUiPosition.Center)},MO.FDsSolutionMenuBar_onDeleteLoad=function(b){RConsole.find(FUiDesktopConsole).hide();
this._frameSet._listContent.serviceResearch()},MO.FDsSolutionMenuBar_onDeleteExecute=function(b){b.resultCd!=EResult.Success?RConsole.find(FUiDesktopConsole).hide():(b=this._frameSet._listContent._activeGuid,RConsole.find(FUiDesktopConsole).showUploading(),RConsole.find(FDrProjectConsole).doDelete(b).addLoadListener(this,this.onDeleteLoad))},MO.FDsSolutionMenuBar_onDeleteClick=function(b){if(!this._frameSet._listContent.focusItem())return alert("\u8bf7\u9009\u4e2d\u540e\u518d\u70b9\u51fb\u5220\u9664");
RConsole.find(FUiMessageConsole).showConfirm("\u8bf7\u786e\u8ba4\u662f\u5426\u5220\u9664\u5f53\u524d\u9879\u76ee\uff1f").addResultListener(this,this.onDeleteExecute)},MO.FDsSolutionMenuBar_construct=function(){this.__base.FUiMenuBar.construct.call(this)},MO.FDsSolutionMenuBar_dispose=function(){this.__base.FUiMenuBar.dispose.call(this)};
with(MO)MO.FDsSolutionProjectDialog=function(b){b=RClass.inherits(this,b,FUiDialog);b._frameName="resource.private.solution.ProjectDialog";b._resourceTypeCd="private";b._controlPrivateButton=null;b._controlTeamButton=null;b._controlShareButton=null;b.onBuilded=FDsSolutionProjectDialog_onBuilded;b.onConfirmLoad=FDsSolutionProjectDialog_onConfirmLoad;b.onConfirmClick=FDsSolutionProjectDialog_onConfirmClick;b.onCancelClick=FDsSolutionProjectDialog_onCancelClick;b.construct=FDsSolutionProjectDialog_construct;
b.dispose=FDsSolutionProjectDialog_dispose;return b},MO.FDsSolutionProjectDialog_onBuilded=function(b){this.__base.FUiDialog.onBuilded.call(this,b);this._controlConfirmButton.addClickListener(this,this.onConfirmClick);this._controlCancelButton.addClickListener(this,this.onCancelClick)},MO.FDsSolutionProjectDialog_onConfirmLoad=function(b){this._frameSet._listContent.serviceResearch();this.hide();RWindow.enable()},MO.FDsSolutionProjectDialog_onConfirmClick=function(b){RWindow.disable();b=this._controlCode.get();
var d=this._controlLabel.get(),f=RClass.create(FDrProject);f.setCode(b);f.setLabel(d);RConsole.find(FDrProjectConsole).doCreate(f).addLoadListener(this,this.onConfirmLoad)},MO.FDsSolutionProjectDialog_onCancelClick=function(b){this.hide()},MO.FDsSolutionProjectDialog_construct=function(){this.__base.FUiDialog.construct.call(this)},MO.FDsSolutionProjectDialog_dispose=function(){this.__base.FUiDialog.dispose.call(this)};
with(MO)MO.FDsSolutionProjectProperty=function(b){b=RClass.inherits(this,b,FUiForm);b._visible=!1;b._workspace=null;b._activeSpace=null;b._activeCamera=null;b._controlGuid=null;b._controlCode=null;b._controlLabel=null;b._controlPosition=null;b._controlDirection=null;b.onBuilded=FDsSolutionProjectProperty_onBuilded;b.onDataChanged=FDsSolutionProjectProperty_onDataChanged;b.onLoadProject=FDsSolutionProjectProperty_onLoadProject;b.construct=FDsSolutionProjectProperty_construct;b.loadObject=FDsSolutionProjectProperty_loadObject;
b.dispose=FDsSolutionProjectProperty_dispose;return b},MO.FDsSolutionProjectProperty_onBuilded=function(b){this.__base.FUiForm.onBuilded.call(this,b)},MO.FDsSolutionProjectProperty_onDataChanged=function(b){b=this._activeCamera;var d=b.resource();d.position().assign(this._controlPosition.get());d.direction().assign(this._controlDirection.get());b.position().assign(d.position());b.direction().assign(d.direction());b.update()},MO.FDsSolutionProjectProperty_onLoadProject=function(b){b=b.root.findNode("Project");
this._controlCode.set(b.get("code"));this._controlLabel.set(b.get("label"))},MO.FDsSolutionProjectProperty_construct=function(){this.__base.FUiForm.construct.call(this)},MO.FDsSolutionProjectProperty_loadObject=function(b){b=b._guid;this._controlGuid.set(b);RConsole.find(FDrProjectConsole).doQuery(b).addLoadListener(this,this.onLoadProject)},MO.FDsSolutionProjectProperty_dispose=function(){this.__base.FUiForm.dispose.call(this)};
with(MO)MO.FDsSolutionPropertyContent=function(b){b=RClass.inherits(this,b,FDsCanvas);b._activeSpace=null;b._canvasModeCd=EDsCanvasMode.Drop;b._canvasMoveCd=EDsCanvasDrag.Unknown;b._optionRotation=!1;b._rotation=null;b._capturePosition=null;b._captureMatrix=null;b._captureRotation=null;b._dimensional=null;b._selectObject=null;b._selectBoundBox=null;b._selectRenderables=null;b._cameraMoveRate=8;b._cameraKeyRotation=3;b._cameraMouseRotation=.005;b._templateMatrix=null;b._templateRenderable=null;b._templateFace=
null;b._templateTranslation=null;b._templateRotation=null;b._templateScale=null;b._templateViewScale=.05;b.onBuild=FDsSolutionPropertyContent_onBuild;b.onMouseCaptureStart=FDsSolutionPropertyContent_onMouseCaptureStart;b.onMouseCapture=FDsSolutionPropertyContent_onMouseCapture;b.onMouseCaptureStop=FDsSolutionPropertyContent_onMouseCaptureStop;b.onEnterFrame=FDsSolutionPropertyContent_onEnterFrame;b.onMeshLoad=FDsSolutionPropertyContent_onMeshLoad;b.oeResize=FDsSolutionPropertyContent_oeResize;b.oeRefresh=
FDsSolutionPropertyContent_oeRefresh;b.construct=FDsSolutionPropertyContent_construct;b.innerSelectDisplay=FDsSolutionPropertyContent_innerSelectDisplay;b.innerSelectLayer=FDsSolutionPropertyContent_innerSelectLayer;b.switchRotation=FDsSolutionPropertyContent_switchRotation;b.reloadRegion=FDsSolutionPropertyContent_reloadRegion;b.loadMeshByGuid=FDsSolutionPropertyContent_loadMeshByGuid;b.loadMeshByCode=FDsSolutionPropertyContent_loadMeshByCode;b.dispose=FDsSolutionPropertyContent_dispose;return b},
MO.FDsSolutionPropertyContent_onBuild=function(b){this.__base.FDsCanvas.onBuild.call(this,b)},MO.FDsSolutionPropertyContent_onMouseCaptureStart=function(b){var d=this._activeSpace;if(d){var f=this._activeSpace.region(),f=RConsole.find(FG3dTechniqueConsole).find(this._graphicContext,FG3dSelectTechnique).test(f,b.offsetX,b.offsetY);this.selectRenderable(f);this._capturePosition.set(b.clientX,b.clientY);this._captureRotation.assign(d.camera()._rotation);f&&(f=f.display(),this._captureMatrix.assign(f.matrix()));
this._templateMatrix.identity();if(this._templateFace)for(this._templateFaceMatrix.assign(this._templateFace.matrix()),b=this._selectRenderables,d=b.count()-1;0<=d;d--)f=b.getAt(d),f._dragMatrix||(f._dragMatrix=new SMatrix3d),f._dragMatrix.assign(f.matrix());RHtml.cursorSet(this._hPanel,EUiCursor.Pointer)}},MO.FDsSolutionPropertyContent_onMouseCapture=function(b){if(this._activeSpace){var d=b.clientX-this._capturePosition.x,f=b.clientY-this._capturePosition.y,h=this._canvasMoveCd,q=this._templateFace;
b=this._templateMatrix;switch(this._canvasModeCd){case EDsCanvasMode.Drop:var h=this._activeSpace.camera().rotation(),w=this._captureRotation;h.x=w.x-f*this._cameraMouseRotation;h.y=w.y-d*this._cameraMouseRotation;break;case EDsCanvasMode.Translate:q&&(h==EDsCanvasDrag.X?b.tx=d/10:h==EDsCanvasDrag.Y?b.ty=-f/10:h==EDsCanvasDrag.Z&&(b.tz=d/10));break;case EDsCanvasMode.Rotation:q&&(h==EDsCanvasDrag.X?b.rx=d/10:h==EDsCanvasDrag.Y?b.ry=-f/10:h==EDsCanvasDrag.Z&&(b.rz=d/10));break;case EDsCanvasMode.Scale:q&&
(h==EDsCanvasDrag.X?b.sx=d/10:h==EDsCanvasDrag.Y?b.sy=-f/10:h==EDsCanvasDrag.Z?b.sz=d/10:h==EDsCanvasDrag.All&&(b.sx=d/10,b.sy=d/10,b.sz=d/10))}if(q)for(q.matrix().merge(this._templateFaceMatrix,b),d=this._selectRenderables,f=d.count()-1;0<=f;f--)h=d.getAt(f),h._matrix.merge(h._dragMatrix,b)}},MO.FDsSolutionPropertyContent_onMouseCaptureStop=function(b){RHtml.cursorSet(this._hPanel,EUiCursor.Auto)},MO.FDsSolutionPropertyContent_onEnterFrame=function(){var b=this._activeSpace;if(b){var d=b.timer().spanSecond(),
b=b.camera(),f=this._cameraMoveRate*d,d=this._cameraKeyRotation*d,h=RKeyboard.isPress(EStageKey.Forward),q=RKeyboard.isPress(EStageKey.Back);h&&!q&&b.doWalk(f);!h&&q&&b.doWalk(-f);h=RKeyboard.isPress(EStageKey.Up);q=RKeyboard.isPress(EStageKey.Down);h&&!q&&b.doFly(f);!h&&q&&b.doFly(-f);f=RKeyboard.isPress(EStageKey.RotationLeft);h=RKeyboard.isPress(EStageKey.RotationRight);f&&!h&&b.doYaw(d);!f&&h&&b.doYaw(-d);f=RKeyboard.isPress(EStageKey.RotationUp);h=RKeyboard.isPress(EStageKey.RotationDown);f&&
!h&&b.doPitch(d);!f&&h&&b.doPitch(-d);b.update();this._optionRotation&&(d=this._rotation,b=this._activeSpace._display.matrix(),b.setRotation(b.rx,b.ry+d.y,b.rz),b.update(),d.y=.01)}},MO.FDsSolutionPropertyContent_onMeshLoad=function(b){b=this._activeSpace.region();var d=b.camera();d.setPosition(0,3,-10);d.lookAt(0,3,0);d.update();var f=this._hPanel,d=d.projection();d.size().set(f.width,f.height);d._angle=45;d.update();b=b.directionalLight().camera();b.setPosition(10,10,0);b.lookAt(0,0,0);b.update();
this.processLoadListener(this)},MO.FDsSolutionPropertyContent_oeResize=function(b){this.__base.FDsCanvas.oeResize.call(this,b);var d=this._hPanel;b=d.offsetWidth;var d=d.offsetHeight,f=this._activeSpace;f&&(f=f.camera().projection(),f.size().set(b,d),f.update());return EEventStatus.Stop},MO.FDsSolutionPropertyContent_oeRefresh=function(b){return EEventStatus.Stop},MO.FDsSolutionPropertyContent_construct=function(){this.__base.FDsCanvas.construct.call(this);this._capturePosition=new SPoint2;this._captureMatrix=
new SMatrix3d;this._templateMatrix=new SMatrix3d;this._templateFaceMatrix=new SMatrix3d;this._rotation=new SVector3;this._captureRotation=new SVector3;this._selectRenderables=new TObjects},MO.FDsSolutionPropertyContent_innerSelectDisplay=function(b){b=b.renderables();for(var d=b.count(),f=0;f<d;f++){var h=b.getAt(f);RClass.isClass(h,FDsSceneRenderable)&&(this._selectRenderables.push(h),h.showBoundBox())}},MO.FDsSolutionPropertyContent_innerSelectLayer=function(b){b=b.displays();for(var d=b.count(),
f=0;f<d;f++){var h=b.getAt(f);this.innerSelectDisplay(h)}},MO.FDsSolutionPropertyContent_switchMode=function(b){this._canvasModeCd=b},MO.FDsSolutionPropertyContent_switchRotation=function(b){this._optionRotation=b},MO.FDsSolutionPropertyContent_reloadRegion=function(b){b=b.resource();this._cameraMoveRate=b.moveSpeed();this._cameraKeyRotation=b.rotationKeySpeed();this._cameraMouseRotation=b.rotationMouseSpeed()},MO.FDsSolutionPropertyContent_loadMeshByGuid=function(b){var d=RConsole.find(FE3dMeshConsole);
null!=this._activeSpace&&d.free(this._activeSpace);b=this._activeSpace=d.allocByGuid(this,b);b.addLoadListener(this,this.onMeshLoad);b._layer.pushRenderable(this._dimensional);RStage.register("mesh3d",b)},MO.FDsSolutionPropertyContent_loadMeshByCode=function(b){var d=RConsole.find(FE3dMeshConsole);null!=this._activeSpace&&d.free(this._activeSpace);b=this._activeSpace=d.allocByCode(this,b);b.addLoadListener(this,this.onMeshLoad);b._layer.pushRenderable(this._dimensional);RStage.register("mesh3d",b)},
MO.FDsSolutionPropertyContent_dispose=function(){this._rotation=RObject.dispose(this._rotation);this.__base.FDsCanvas.dispose.call(this)};
with(MO)MO.FDsSolutionPropertyToolBar=function(b){b=RClass.inherits(this,b,FUiToolBar);b._frameName="resource.solution.PropertyToolBar";b._controlInsertButton=null;b._controlUpdateButton=null;b._controlDeleteButton=null;b.onBuilded=FDsSolutionPropertyToolBar_onBuilded;b.onUpdateClick=FDsSolutionPropertyToolBar_onUpdateClick;b.construct=FDsSolutionPropertyToolBar_construct;b.dispose=FDsSolutionPropertyToolBar_dispose;return b},MO.FDsSolutionPropertyToolBar_onBuilded=function(b){this.__base.FUiToolBar.onBuilded.call(this,
b);this._controlUpdateButton.addClickListener(this,this.onUpdateClick)},MO.FDsSolutionPropertyToolBar_onUpdateClick=function(b){window.location="Project.wa?do=detail&guid="+this._workspace._activeProjectGuid},MO.FDsSolutionPropertyToolBar_construct=function(){this.__base.FUiToolBar.construct.call(this)},MO.FDsSolutionPropertyToolBar_dispose=function(){this.__base.FUiToolBar.dispose.call(this)};
with(MO)MO.FDsProjectCanvasContent=function(b){b=RClass.inherits(this,b,FUiListView);b._refreshButton=null;b._saveButton=null;b._runButton=null;b.onBuilded=FDsProjectCanvasContent_onBuilded;b.onServiceLoad=FDsProjectCanvasContent_onServiceLoad;b.construct=FDsProjectCanvasContent_construct;b.clickItem=FDsProjectCanvasContent_clickItem;b.serviceSearch=FDsProjectCanvasContent_serviceSearch;b.dispose=FDsProjectCanvasContent_dispose;return b},MO.FDsProjectCanvasContent_onBuilded=function(b){this.__base.FUiListView.onBuilded.call(this,
b)},MO.FDsProjectCanvasContent_onServiceLoad=function(b){var d=b.root.findNode("ProjectCollection");b=d.getInteger("page_size");var f=d.getInteger("page_count"),d=d.getInteger("page");this._workspace._searchToolbar.setNavigator(b,f,d);this.clear();b=xitems.nodes();f=b.count();for(d=0;d<f;d++){var h=b.getAt(d);if(h.isName("Project")){var q=this.createItem(FDsProjectSearchItem);q.propertyLoad(h);q._typeCd=h.get("type");q._guid=h.get("guid");q.setLabel(RString.nvl(h.get("label"),h.get("code")));q.refreshStyle();
this.push(q)}}RWindow.enable()},MO.FDsProjectCanvasContent_construct=function(){this.__base.FUiListView.construct.call(this)},MO.FDsProjectCanvasContent_clickItem=function(b){var d=this._workspace._previewContent;d._activeItem=b;d.loadMeshByGuid(b._guid)},MO.FDsProjectCanvasContent_serviceSearch=function(b,d,f,h){RWindow.disable();RConsole.find(FDrResourceConsole).fetch(b,d,null,f,h).addLoadListener(this,this.onServiceLoad)},MO.FDsProjectCanvasContent_dispose=function(){this.__base.FUiListView.dispose.call(this)};
with(MO)MO.FDsProjectCanvasPreviewToolBar=function(b){b=RClass.inherits(this,b,FUiToolBar);b._frameName="resource.project.CanvasPreviewToolBar";b._pageCount=0;b._page=0;b._serach=null;b._resourceTypeCd=null;b._dropButton=null;b._selectButton=null;b._translateButton=null;b._rotationButton=null;b._scaleButton=null;b._lookFrontButton=null;b._lookUpButton=null;b._lookLeftButton=null;b._playButton=null;b._viewButton=null;b.onBuilded=FDsProjectCanvasPreviewToolBar_onBuilded;b.onSearchClick=FDsProjectCanvasPreviewToolBar_onSearchClick;
b.onNavigatorClick=FDsProjectCanvasPreviewToolBar_onNavigatorClick;b.construct=FDsProjectCanvasPreviewToolBar_construct;b.setNavigator=FDsProjectCanvasPreviewToolBar_setNavigator;b.doNavigator=FDsProjectCanvasPreviewToolBar_doNavigator;b.dispose=FDsProjectCanvasPreviewToolBar_dispose;return b},MO.FDsProjectCanvasPreviewToolBar_onBuilded=function(b){this.__base.FUiToolBar.onBuilded.call(this,b)},MO.FDsProjectCanvasPreviewToolBar_onSearchClick=function(b){this.doNavigator(0)},MO.FDsProjectCanvasPreviewToolBar_onNavigatorClick=
function(b){b=b.sender.name();var d=this._page;switch(b){case "firstButton":d=0;break;case "priorButton":d--;break;case "nextButton":d++;break;case "lastButton":d=this._pageCount}this.doNavigator(d)},MO.FDsProjectCanvasPreviewToolBar_construct=function(){this.__base.FUiToolBar.construct.call(this)},MO.FDsProjectCanvasPreviewToolBar_setNavigator=function(b,d,f){this._pageSize=b;this._pageCount=d;this._page=f;this._controlPageEdit.setText(f)},MO.FDsProjectCanvasPreviewToolBar_doNavigator=function(b){b=
RInteger.toRange(b,0,this._pageCount);var d=this._controlSearchEdit.text(),f=this._workspace._resourceTypeCd;this._resourceTypeCd==f&&this._serach==d&&this._page==b||this._workspace._searchContent.serviceSearch(f,d,this._pageSize,b);this._resourceTypeCd=f;this._serach=d},MO.FDsProjectCanvasPreviewToolBar_dispose=function(){this.__base.FUiToolBar.dispose.call(this)};
with(MO)MO.FDsProjectCanvasSpaceToolBar=function(b){b=RClass.inherits(this,b,FUiToolBar);b._frameName="resource.project.CanvasSpaceToolBar";b._pageCount=0;b._page=0;b._serach=null;b._resourceTypeCd=null;b._dropButton=null;b._selectButton=null;b._translateButton=null;b._rotationButton=null;b._scaleButton=null;b._lookFrontButton=null;b._lookUpButton=null;b._lookLeftButton=null;b._playButton=null;b._viewButton=null;b.onBuilded=FDsProjectCanvasSpaceToolBar_onBuilded;b.onSearchClick=FDsProjectCanvasSpaceToolBar_onSearchClick;
b.onNavigatorClick=FDsProjectCanvasSpaceToolBar_onNavigatorClick;b.construct=FDsProjectCanvasSpaceToolBar_construct;b.setNavigator=FDsProjectCanvasSpaceToolBar_setNavigator;b.doNavigator=FDsProjectCanvasSpaceToolBar_doNavigator;b.dispose=FDsProjectCanvasSpaceToolBar_dispose;return b},MO.FDsProjectCanvasSpaceToolBar_onBuilded=function(b){this.__base.FUiToolBar.onBuilded.call(this,b)},MO.FDsProjectCanvasSpaceToolBar_onSearchClick=function(b){this.doNavigator(0)},MO.FDsProjectCanvasSpaceToolBar_onNavigatorClick=
function(b){b=b.sender.name();var d=this._page;switch(b){case "firstButton":d=0;break;case "priorButton":d--;break;case "nextButton":d++;break;case "lastButton":d=this._pageCount}this.doNavigator(d)},MO.FDsProjectCanvasSpaceToolBar_construct=function(){this.__base.FUiToolBar.construct.call(this)},MO.FDsProjectCanvasSpaceToolBar_setNavigator=function(b,d,f){this._pageSize=b;this._pageCount=d;this._page=f;this._controlPageEdit.setText(f)},MO.FDsProjectCanvasSpaceToolBar_doNavigator=function(b){b=RInteger.toRange(b,
0,this._pageCount);var d=this._controlSearchEdit.text(),f=this._workspace._resourceTypeCd;this._resourceTypeCd==f&&this._serach==d&&this._page==b||this._workspace._searchContent.serviceSearch(f,d,this._pageSize,b);this._resourceTypeCd=f;this._serach=d},MO.FDsProjectCanvasSpaceToolBar_dispose=function(){this.__base.FUiToolBar.dispose.call(this)};
with(MO)MO.FDsProjectCatalogContent=function(b){b=RClass.inherits(this,b,FUiDataTreeView,MListenerSelected);b._iconView="design3d.mesh.view";b._iconViewNot="design3d.mesh.viewno";b._activeSpace=null;b._materials=null;b.onBuild=FDsProjectCatalogContent_onBuild;b.onLoadDisplay=FDsProjectCatalogContent_onLoadDisplay;b.onNodeClick=FDsProjectCatalogContent_onNodeClick;b.onNodeViewClick=FDsProjectCatalogContent_onNodeViewClick;b.onNodeViewDoubleClick=FDsProjectCatalogContent_onNodeViewDoubleClick;b.lsnsSelect=
null;b.construct=FDsProjectCatalogContent_construct;b.buildTechnique=FDsProjectCatalogContent_buildTechnique;b.buildRegion=FDsProjectCatalogContent_buildRegion;b.buildRenderable=FDsProjectCatalogContent_buildRenderable;b.buildDisplay=FDsProjectCatalogContent_buildDisplay;b.buildSpace=FDsProjectCatalogContent_buildSpace;b.selectObject=FDsProjectCatalogContent_selectObject;b.showObject=FDsProjectCatalogContent_showObject;b.dispose=FDsProjectCatalogContent_dispose;return b},MO.FDsProjectCatalogContent_onBuild=
function(b){this.__base.FUiDataTreeView.onBuild.call(this,b);this.lsnsClick.register(this,this.onNodeClick);this.loadUrl("/cloud.describe.tree.ws?action=query&code=resource.project")},MO.FDsProjectCatalogContent_onLoadDisplay=function(b){this.buildRenderable(b._linkNode,b)},MO.FDsProjectCatalogContent_onNodeClick=function(b,d){var f=d.dataPropertyGet("linker");this.selectObject(f)},MO.FDsProjectCatalogContent_onNodeViewClick=function(b){var d=b.treeNodeCell,f=b.treeNode.dataPropertyGet("linker");
if(RClass.isClass(f,FDisplay))if(b.ctrlKey){for(var h=this._displays,q=h.count()-1;0<=q;q--){var w=h.get(q);w.dataPropertyGet("linker")._visible=!1;w.cell("view").setIcon(this._iconViewNot)}f._visible=!0;d.setIcon(this._iconView)}else f._visible=!f._visible,d.setIcon(f._visible?this._iconView:this._iconViewNot);if(RClass.isClass(f,FDrawable))if(b.ctrlKey){h=this._renderables;for(q=h.count()-1;0<=q;q--)w=h.get(q),w.dataPropertyGet("linker")._visible=!1,w.cell("view").setIcon(this._iconViewNot);f._visible=
!0;d.setIcon(this._iconView)}else f._visible=!f._visible,d.setIcon(f._visible?this._iconView:this._iconViewNot);if(RClass.isClass(f,FG3dMaterial))if(b.ctrlKey){b=this._materials;for(q=b.count()-1;0<=q;q--)h=b.get(q),h.dataPropertyGet("linker")._visible=!1,h.cell("view").setIcon(this._iconViewNot);f._visible=!0;d.setIcon(this._iconView)}else f._visible=!f._visible,d.setIcon(f._visible?this._iconView:this._iconViewNot)},MO.FDsProjectCatalogContent_onNodeViewDoubleClick=function(b){b=b.treeNode;var d=
b.dataPropertyGet("linker");if(RClass.isClass(d,FDisplay))for(var d=this._displays,f=d.count()-1;0<=f;f--)b=d.get(f),b.dataPropertyGet("linker")._visible=!0,b.cell("view").setIcon(this._iconView);if(RClass.isClass(d,FDrawable))for(d=this._renderables,f=d.count()-1;0<=f;f--)b=d.get(f),b.dataPropertyGet("linker")._visible=!0,b.cell("view").setIcon(this._iconView);if(RClass.isClass(d,FG3dMaterial))for(d=this._materials,f=d.count()-1;0<=f;f--)b=d.get(f),b.dataPropertyGet("linker")._visible=!0,b.cell("view").setIcon(this._iconView)},
MO.FDsProjectCatalogContent_construct=function(){this.__base.FUiDataTreeView.construct.call(this);this._renderables=new TObjects;this._materials=new TObjects},MO.FDsProjectCatalogContent_buildTechnique=function(b,d){var f=this.createNode();f.setLabel("Technique");f.setTypeCode("technique");f.dataPropertySet("linker",d);b.appendNode(f)},MO.FDsProjectCatalogContent_buildRegion=function(b,d){var f=this.createNode();f.setLabel("Region");f.setTypeCode("region");f.dataPropertySet("linker",d);b.appendNode(f);
var h=this.createNode();h.setLabel("Camera");h.setTypeCode("camera");h.dataPropertySet("linker",d.camera());f.appendNode(h);h=this.createNode();h.setLabel("Light");h.setTypeCode("light");h.dataPropertySet("linker",d.directionalLight());f.appendNode(h)},MO.FDsProjectCatalogContent_buildRenderable=function(b,d){var f=d._renderable._material,h=this.createNode();h.setTypeCode("material");h.setLabel("Material");h.dataPropertySet("linker",f);this._materials.push(h);b.appendNode(h);f=d._renderable;h=this.createNode();
h.setTypeCode("renderable");h.setLabel("Renderable");h.dataPropertySet("linker",f);this._renderables.push(h);b.appendNode(h)},MO.FDsProjectCatalogContent_buildDisplay=function(b,d){var f=this.createNode();f.setTypeCode("display");f.setLabel("Mesh");f.dataPropertySet("linker",d);b.appendNode(f);this.buildRenderable(f,d)},MO.FDsProjectCatalogContent_buildSpace=function(b){var d=b.resource();this._activeSpace=b;var f=this.createNode();f.setTypeCode("space");f.setLabel(d.code());f.setNote(d.label());
f.dataPropertySet("linker",b);this.appendNode(f);this.buildTechnique(f,b.technique());this.buildRegion(f,b.region());this.buildDisplay(f,b._display);f.click()},MO.FDsProjectCatalogContent_selectObject=function(b){null!=b&&this.processSelectedListener(b,!0)},MO.FDsProjectCatalogContent_showObject=function(b){if(RClass.isClass(b,FDsSceneRenderable))for(var d=this._renderables,f=d.count(),h=0;h<f;h++)d.getAt(h).dataPropertyGet("linker")==b&&this.processSelectedListener(b,!1)},MO.FDsProjectCatalogContent_dispose=
function(){this._displays=RObject.dispose(this._displays);this._renderables=RObject.dispose(this._renderables);this._materials=RObject.dispose(this._materials);this.__base.FUiDataTreeView.dispose.call(this)};
with(MO)MO.FDsProjectCatalogToolBar=function(b){b=RClass.inherits(this,b,FUiToolBar);b._frameName="resource.project.CatalogToolBar";b._canvasModeCd=EDsCanvasMode.Drop;b._dropButton=null;b._selectButton=null;b._translateButton=null;b._rotationButton=null;b._scaleButton=null;b._lookFrontButton=null;b._lookUpButton=null;b._lookLeftButton=null;b._playButton=null;b._viewButton=null;b.onBuilded=FDsProjectCatalogToolBar_onBuilded;b.onModeClick=FDsProjectCatalogToolBar_onModeClick;b.onRotationClick=FDsProjectCatalogToolBar_onRotationClick;
b.construct=FDsProjectCatalogToolBar_construct;b.dispose=FDsProjectCatalogToolBar_dispose;return b},MO.FDsProjectCatalogToolBar_onBuilded=function(b){this.__base.FUiToolBar.onBuilded.call(this,b)},MO.FDsProjectCatalogToolBar_onModeClick=function(b){this._canvasModeCd=b._canvasModeCd;this._workspace._canvas.switchMode(b._canvasModeCd)},MO.FDsProjectCatalogToolBar_onRotationClick=function(b,d){this._workspace._canvas.switchRotation(d)},MO.FDsProjectCatalogToolBar_construct=function(){this.__base.FUiToolBar.construct.call(this)},
MO.FDsProjectCatalogToolBar_dispose=function(){this.__base.FUiToolBar.dispose.call(this)};
with(MO)MO.FDsProjectFrameSet=function(b){b=RClass.inherits(this,b,FUiFrameSet);b._frameName="resource.project.FrameSet";b._stylePageControl=RClass.register(b,new AStyle("_stylePageControl","PageControl"));b._styleToolbarGround=RClass.register(b,new AStyle("_styleToolbarGround","Toolbar_Ground"));b._styleStatusbarGround=RClass.register(b,new AStyle("_styleStatusbarGround","Statusbar_Ground"));b._styleCatalogGround=RClass.register(b,new AStyle("_styleCatalogGround","Catalog_Ground"));b._styleCatalogContent=
RClass.register(b,new AStyle("_styleCatalogContent","Catalog_Content"));b._styleCanvasGround=RClass.register(b,new AStyle("_styleCanvasGround","Canvas_Ground"));b._styleCanvasContent=RClass.register(b,new AStyle("_styleCanvasContent","Canvas_Content"));b._stylePropertyGround=RClass.register(b,new AStyle("_stylePropertyGround","Property_Ground"));b._stylePropertyContent=RClass.register(b,new AStyle("_stylePropertyContent","Property_Content"));b._activeSpace=null;b._activeMesh=null;b._framesetMain=
null;b._framesetBody=null;b._frameToolBar=null;b._frameBody=null;b._frameProperty=null;b._frameCatalog=null;b._frameCanvas=null;b._frameStatusBar=null;b._propertyFrames=null;b.onBuilded=FDsProjectFrameSet_onBuilded;b.onMeshLoad=FDsProjectFrameSet_onMeshLoad;b.onCatalogSelected=FDsProjectFrameSet_onCatalogSelected;b.construct=FDsProjectFrameSet_construct;b.findPropertyFrame=FDsProjectFrameSet_findPropertyFrame;b.loadByGuid=FDsProjectFrameSet_loadByGuid;b.dispose=FDsProjectFrameSet_dispose;return b},
MO.FDsProjectFrameSet_onBuilded=function(b){this.__base.FUiFrameSet.onBuilded.call(this,b);b=this._frameCatalog=this.searchControl("catalogFrame");b._hPanel.className=this.styleName("Catalog_Ground");b=this._frameCatalogPageControl=this.searchControl("catalogPageControl");b._hPanel.className=this.styleName("PageControl");b=this._frameSceneListToolBar=this.searchControl("sceneListToolbarFrame");b._hPanel.className=this.styleName("Toolbar_Ground");b=this._frameSceneListContent=this.searchControl("sceneListContentFrame");
b._hPanel.className=this.styleName("Catalog_Content");b=this._frameSceneCatalogToolBar=this.searchControl("sceneCatalogToolbarFrame");b._hPanel.className=this.styleName("Toolbar_Ground");b=this._frameSceneCatalogContent=this.searchControl("sceneCatalogContentFrame");b._hPanel.className=this.styleName("Catalog_Content");b=this._frameCanvas=this.searchControl("canvasFrame");b._hPanel.className=this.styleName("Canvas_Ground");b=this._frameCanvasPageControl=this.searchControl("canvasPageControl");b._hPanel.className=
this.styleName("PageControl");b=this._frameCanvasSpaceToolBar=this.searchControl("canvasSpaceToolbarFrame");b._hPanel.className=this.styleName("Toolbar_Ground");b=this._frameCanvasSpaceContent=this.searchControl("canvasSpaceContentFrame");b._hPanel.className=this.styleName("Canvas_Content");b=this._frameCanvasPreviewToolBar=this.searchControl("canvasPreviewToolbarFrame");b._hPanel.className=this.styleName("Toolbar_Ground");b=this._frameCanvasPreviewContent=this.searchControl("canvasPreviewContentFrame");
b._hPanel.className=this.styleName("Canvas_Content");b=this._frameProperty=this.searchControl("propertyFrame");b._hPanel.className=this.styleName("Property_Ground");b=this._framePropertyPageControl=this.searchControl("propertyPageControl");b._hPanel.className=this.styleName("PageControl");b=this._framePropertyAttributeToolBar=this.searchControl("propertyAttributeToolbarFrame");b._hPanel.className=this.styleName("Toolbar_Ground");b=this._framePropertyAttributeContent=this.searchControl("propertyAttributeContentFrame");
b._hPanel.className=this.styleName("Property_Content");b=this._catalogSplitter=this.searchControl("catalogSpliter");b.setAlignCd(EUiAlign.Left);b.setSizeHtml(this._frameCatalog._hPanel);b=this._propertySpliter=this.searchControl("propertySpliter");b.setAlignCd(EUiAlign.Right);b.setSizeHtml(this._frameProperty._hPanel)},MO.FDsProjectFrameSet_onMeshLoad=function(b){this._activeSpace=b._activeSpace;this._catalog.buildSpace(this._activeSpace)},MO.FDsProjectFrameSet_onCatalogSelected=function(b,d){for(var f=
this._activeSpace,h=this._propertyFrames,q=h.count(),w=0;w<q;w++){var z=h.value(w);z.hide()}if(RClass.isClass(b,FE3dStage))z=this.findPropertyFrame(EDsFrame.MeshSpacePropertyFrame),z.show(),z.loadObject(f,f);else if(RClass.isClass(b,FG3dTechnique))z=this.findPropertyFrame(EDsFrame.MeshTechniquePropertyFrame),z.show(),z.loadObject(f,b);else if(RClass.isClass(b,FE3dRegion))z=this.findPropertyFrame(EDsFrame.MeshRegionPropertyFrame),z.show(),z.loadObject(f,b);else if(RClass.isClass(b,FE3dCamera))z=this.findPropertyFrame(EDsFrame.MeshCameraPropertyFrame),
z.show(),z.loadObject(f,b);else if(RClass.isClass(b,FG3dDirectionalLight))z=this.findPropertyFrame(EDsFrame.MeshLightPropertyFrame),z.show(),z.loadObject(f,b);else if(RClass.isClass(b,FE3dMeshDisplay))z=this.findPropertyFrame(EDsFrame.MeshDisplayPropertyFrame),z.show(),z.loadObject(f,b);else if(RClass.isClass(b,FG3dMaterial))z=this.findPropertyFrame(EDsFrame.MeshMaterialPropertyFrame),z.show(),z.loadObject(f,b);else if(RClass.isClass(b,FE3dMeshRenderable))z=this.findPropertyFrame(EDsFrame.MeshRenderablePropertyFrame),
z.show(),z.loadObject(f,b);else throw new TError("Unknown select object type. (value={1})",b);},MO.FDsProjectFrameSet_construct=function(){this.__base.FUiFrameSet.construct.call(this);this._propertyFrames=new TDictionary},MO.FDsProjectFrameSet_findPropertyFrame=function(b){var d=this._propertyFrames.get(b);d||(d=RConsole.find(FFrameConsole).get(this,b,this._frameProperty._hContainer),d._workspace=this,this._propertyFrames.set(b,d));return d},MO.FDsProjectFrameSet_loadByGuid=function(b){this._activeGuid=
b;this._sceneListContent.serviceList(b)},MO.FDsProjectFrameSet_dispose=function(){this.__base.FUiFrameSet.dispose.call(this);this._propertyFrames.dispose();this._propertyFrames=null};
with(MO)MO.FDsProjectMenuBar=function(b){b=RClass.inherits(this,b,FUiMenuBar);b._refreshButton=null;b._saveButton=null;b._runButton=null;b.onBuilded=FDsProjectMenuBar_onBuilded;b.onSaveClick=FDsProjectMenuBar_onSaveClick;b.construct=FDsProjectMenuBar_construct;b.dispose=FDsProjectMenuBar_dispose;return b},MO.FDsProjectMenuBar_onBuilded=function(b){this.__base.FUiMenuBar.onBuilded.call(this,b);this._controlSave.addClickListener(this,this.onSaveClick)},MO.FDsProjectMenuBar_onSaveClick=function(b){b=
this._workspace._activeSpace.resource();var d=new TXmlNode;b.saveConfig(d);RConsole.find(FE3sMeshConsole).update(d)},MO.FDsProjectMenuBar_construct=function(){this.__base.FUiMenuBar.construct.call(this)},MO.FDsProjectMenuBar_dispose=function(){this.__base.FUiMenuBar.dispose.call(this)};
with(MO)MO.FDsProjectPropertyContent=function(b){b=RClass.inherits(this,b,FDsCanvas);b._activeSpace=null;b._canvasModeCd=EDsCanvasMode.Drop;b._canvasMoveCd=EDsCanvasDrag.Unknown;b._optionRotation=!1;b._rotation=null;b._capturePosition=null;b._captureMatrix=null;b._captureRotation=null;b._dimensional=null;b._selectObject=null;b._selectBoundBox=null;b._selectRenderables=null;b._cameraMoveRate=8;b._cameraKeyRotation=3;b._cameraMouseRotation=.005;b._templateMatrix=null;b._templateRenderable=null;b._templateFace=
null;b._templateTranslation=null;b._templateRotation=null;b._templateScale=null;b._templateViewScale=.05;b.onBuild=FDsProjectPropertyContent_onBuild;b.onMouseCaptureStart=FDsProjectPropertyContent_onMouseCaptureStart;b.onMouseCapture=FDsProjectPropertyContent_onMouseCapture;b.onMouseCaptureStop=FDsProjectPropertyContent_onMouseCaptureStop;b.onEnterFrame=FDsProjectPropertyContent_onEnterFrame;b.onMeshLoad=FDsProjectPropertyContent_onMeshLoad;b.oeResize=FDsProjectPropertyContent_oeResize;b.oeRefresh=
FDsProjectPropertyContent_oeRefresh;b.construct=FDsProjectPropertyContent_construct;b.innerSelectDisplay=FDsProjectPropertyContent_innerSelectDisplay;b.innerSelectLayer=FDsProjectPropertyContent_innerSelectLayer;b.selectNone=FDsProjectPropertyContent_selectNone;b.selectDisplay=FDsProjectPropertyContent_selectDisplay;b.selectMaterial=FDsProjectPropertyContent_selectMaterial;b.selectRenderable=FDsProjectPropertyContent_selectRenderable;b.switchRotation=FDsProjectPropertyContent_switchRotation;b.reloadRegion=
FDsProjectPropertyContent_reloadRegion;b.loadMeshByGuid=FDsProjectPropertyContent_loadMeshByGuid;b.loadMeshByCode=FDsProjectPropertyContent_loadMeshByCode;b.dispose=FDsProjectPropertyContent_dispose;return b},MO.FDsProjectPropertyContent_onBuild=function(b){this.__base.FDsCanvas.onBuild.call(this,b)},MO.FDsProjectPropertyContent_onMouseCaptureStart=function(b){var d=this._activeSpace;if(d){var f=this._activeSpace.region(),f=RConsole.find(FG3dTechniqueConsole).find(this._graphicContext,FG3dSelectTechnique).test(f,
b.offsetX,b.offsetY);this.selectRenderable(f);this._capturePosition.set(b.clientX,b.clientY);this._captureRotation.assign(d.camera()._rotation);f&&(f=f.display(),this._captureMatrix.assign(f.matrix()));this._templateMatrix.identity();if(this._templateFace)for(this._templateFaceMatrix.assign(this._templateFace.matrix()),b=this._selectRenderables,d=b.count()-1;0<=d;d--)f=b.getAt(d),f._dragMatrix||(f._dragMatrix=new SMatrix3d),f._dragMatrix.assign(f.matrix());RHtml.cursorSet(this._hPanel,EUiCursor.Pointer)}},
MO.FDsProjectPropertyContent_onMouseCapture=function(b){if(this._activeSpace){var d=b.clientX-this._capturePosition.x,f=b.clientY-this._capturePosition.y,h=this._canvasMoveCd,q=this._templateFace;b=this._templateMatrix;switch(this._canvasModeCd){case EDsCanvasMode.Drop:var h=this._activeSpace.camera().rotation(),w=this._captureRotation;h.x=w.x-f*this._cameraMouseRotation;h.y=w.y-d*this._cameraMouseRotation;break;case EDsCanvasMode.Translate:q&&(h==EDsCanvasDrag.X?b.tx=d/10:h==EDsCanvasDrag.Y?b.ty=
-f/10:h==EDsCanvasDrag.Z&&(b.tz=d/10));break;case EDsCanvasMode.Rotation:q&&(h==EDsCanvasDrag.X?b.rx=d/10:h==EDsCanvasDrag.Y?b.ry=-f/10:h==EDsCanvasDrag.Z&&(b.rz=d/10));break;case EDsCanvasMode.Scale:q&&(h==EDsCanvasDrag.X?b.sx=d/10:h==EDsCanvasDrag.Y?b.sy=-f/10:h==EDsCanvasDrag.Z?b.sz=d/10:h==EDsCanvasDrag.All&&(b.sx=d/10,b.sy=d/10,b.sz=d/10))}if(q)for(q.matrix().merge(this._templateFaceMatrix,b),d=this._selectRenderables,f=d.count()-1;0<=f;f--)h=d.getAt(f),h._matrix.merge(h._dragMatrix,b)}},MO.FDsProjectPropertyContent_onMouseCaptureStop=
function(b){RHtml.cursorSet(this._hPanel,EUiCursor.Auto)},MO.FDsProjectPropertyContent_onEnterFrame=function(){var b=this._activeSpace;if(b){var d=b.timer().spanSecond(),b=b.camera(),f=this._cameraMoveRate*d,d=this._cameraKeyRotation*d,h=RKeyboard.isPress(EStageKey.Forward),q=RKeyboard.isPress(EStageKey.Back);h&&!q&&b.doWalk(f);!h&&q&&b.doWalk(-f);h=RKeyboard.isPress(EStageKey.Up);q=RKeyboard.isPress(EStageKey.Down);h&&!q&&b.doFly(f);!h&&q&&b.doFly(-f);f=RKeyboard.isPress(EStageKey.RotationLeft);
h=RKeyboard.isPress(EStageKey.RotationRight);f&&!h&&b.doYaw(d);!f&&h&&b.doYaw(-d);f=RKeyboard.isPress(EStageKey.RotationUp);h=RKeyboard.isPress(EStageKey.RotationDown);f&&!h&&b.doPitch(d);!f&&h&&b.doPitch(-d);b.update();this._optionRotation&&(d=this._rotation,b=this._activeSpace._display.matrix(),b.setRotation(b.rx,b.ry+d.y,b.rz),b.update(),d.y=.01)}},MO.FDsProjectPropertyContent_onMeshLoad=function(b){b=this._activeSpace.region();var d=b.camera();d.setPosition(0,3,-10);d.lookAt(0,3,0);d.update();
var f=this._hPanel,d=d.projection();d.size().set(f.width,f.height);d._angle=45;d.update();b=b.directionalLight().camera();b.setPosition(10,10,0);b.lookAt(0,0,0);b.update();this.processLoadListener(this)},MO.FDsProjectPropertyContent_oeResize=function(b){this.__base.FDsCanvas.oeResize.call(this,b);var d=this._hPanel;b=d.offsetWidth;var d=d.offsetHeight,f=this._activeSpace;f&&(f=f.camera().projection(),f.size().set(b,d),f.update());return EEventStatus.Stop},MO.FDsProjectPropertyContent_oeRefresh=function(b){return EEventStatus.Stop},
MO.FDsProjectPropertyContent_construct=function(){this.__base.FDsCanvas.construct.call(this);this._capturePosition=new SPoint2;this._captureMatrix=new SMatrix3d;this._templateMatrix=new SMatrix3d;this._templateFaceMatrix=new SMatrix3d;this._rotation=new SVector3;this._captureRotation=new SVector3;this._selectRenderables=new TObjects},MO.FDsProjectPropertyContent_innerSelectDisplay=function(b){b=b.renderables();for(var d=b.count(),f=0;f<d;f++){var h=b.getAt(f);RClass.isClass(h,FDsSceneRenderable)&&
(this._selectRenderables.push(h),h.showBoundBox())}},MO.FDsProjectPropertyContent_innerSelectLayer=function(b){b=b.displays();for(var d=b.count(),f=0;f<d;f++){var h=b.getAt(f);this.innerSelectDisplay(h)}},MO.FDsProjectPropertyContent_selectNone=function(){this._selectObject=null;for(var b=this._selectRenderables,d=b.count(),f=0;f<d;f++)b.get(f).hideBoundBox();this._selectRenderables.clear()},MO.FDsProjectPropertyContent_selectDisplay=function(b){this.selectNone();this._selectObject=b;this.innerSelectDisplay(b)},
MO.FDsProjectPropertyContent_selectMaterial=function(b){this.selectNone();this._selectObject=b;for(var d=b._display.renderables(),f=d.count(),h=0;h<f;h++){var q=d.get(h);q._materialReference==b&&(this._selectRenderables.push(q),q._optionSelected=!0,q.showBoundBox())}},MO.FDsProjectPropertyContent_selectRenderable=function(b){if(b)switch(b._renderable._resource._code){case "ms_translation_x":this._canvasMoveCd=EDsCanvasDrag.X;this._templateRenderable=b;return;case "ms_translation_y":this._canvasMoveCd=
EDsCanvasDrag.Y;this._templateRenderable=b;return;case "ms_translation_z":this._canvasMoveCd=EDsCanvasDrag.Z;this._templateRenderable=b;return;case "ms_rotation_x":this._canvasMoveCd=EDsCanvasDrag.X;this._templateRenderable=b;return;case "ms_rotation_y":this._canvasMoveCd=EDsCanvasDrag.Y;this._templateRenderable=b;return;case "ms_rotation_z":this._canvasMoveCd=EDsCanvasDrag.Z;this._templateRenderable=b;return;case "ms_scale_x":this._canvasMoveCd=EDsCanvasDrag.X;this._templateRenderable=b;return;case "ms_scale_y":this._canvasMoveCd=
EDsCanvasDrag.Y;this._templateRenderable=b;return;case "ms_scale_z":this._canvasMoveCd=EDsCanvasDrag.Z;this._templateRenderable=b;return;case "ms_scale_all":this._canvasMoveCd=EDsCanvasDrag.All;this._templateRenderable=b;return;default:this._canvasMoveCd=EDsCanvasDrag.Unknown,this._templateRenderable=null}this.selectNone();b&&(this._selectRenderables.push(b),b._optionSelected=!0,b.showBoundBox(),this._workspace._catalog.showObject(b));var d=this._templateTranslation,f=this._templateRotation,h=this._templateScale;
switch(this._canvasModeCd){case EDsCanvasMode.Translate:d.setVisible(null!=b);f.hide();h.hide();this._templateFace=d;break;case EDsCanvasMode.Rotation:d.hide();f.setVisible(null!=b);h.hide();this._templateFace=f;break;case EDsCanvasMode.Scale:d.hide(),f.hide(),h.setVisible(null!=b),this._templateFace=h}d=this._templateFace;b&&d&&(b=b.display(),d=d.matrix(),d.assign(b.matrix()),d.setScaleAll(this._templateViewScale),d.update())},MO.FDsProjectPropertyContent_switchMode=function(b){this._canvasModeCd=
b;this.selectRenderable(this._selectRenderable)},MO.FDsProjectPropertyContent_switchRotation=function(b){this._optionRotation=b},MO.FDsProjectPropertyContent_reloadRegion=function(b){b=b.resource();this._cameraMoveRate=b.moveSpeed();this._cameraKeyRotation=b.rotationKeySpeed();this._cameraMouseRotation=b.rotationMouseSpeed()},MO.FDsProjectPropertyContent_loadMeshByGuid=function(b){var d=RConsole.find(FE3dMeshConsole);null!=this._activeSpace&&d.free(this._activeSpace);b=this._activeSpace=d.allocByGuid(this,
b);b.addLoadListener(this,this.onMeshLoad);b._layer.pushRenderable(this._dimensional);RStage.register("mesh3d",b)},MO.FDsProjectPropertyContent_loadMeshByCode=function(b){var d=RConsole.find(FE3dMeshConsole);null!=this._activeSpace&&d.free(this._activeSpace);b=this._activeSpace=d.allocByCode(this,b);b.addLoadListener(this,this.onMeshLoad);b._layer.pushRenderable(this._dimensional);RStage.register("mesh3d",b)},MO.FDsProjectPropertyContent_dispose=function(){this._rotation=RObject.dispose(this._rotation);
this.__base.FDsCanvas.dispose.call(this)};
with(MO)MO.FDsProjectPropertyToolBar=function(b){b=RClass.inherits(this,b,FUiToolBar);b._frameName="resource.project.PropertyToolBar";b._controlInsertButton=null;b._controlUpdateButton=null;b._controlDeleteButton=null;b._controlRotationButton=null;b.onBuilded=FDsProjectPropertyToolBar_onBuilded;b.onInsertClick=FDsProjectPropertyToolBar_onInsertClick;b.onUpdateClick=FDsProjectPropertyToolBar_onUpdateClick;b.onDeleteClick=FDsProjectPropertyToolBar_onDeleteClick;b.onRotationClick=FDsProjectPropertyToolBar_onRotationClick;
b.construct=FDsProjectPropertyToolBar_construct;b.dispose=FDsProjectPropertyToolBar_dispose;return b},MO.FDsProjectPropertyToolBar_onBuilded=function(b){this.__base.FUiToolBar.onBuilded.call(this,b)},MO.FDsProjectPropertyToolBar_onInsertClick=function(b){},MO.FDsProjectPropertyToolBar_onUpdateClick=function(b){window.open("/script/design/mesh.html?guid="+this._workspace._previewContent._activeItem._guid,"_blank","")},MO.FDsProjectPropertyToolBar_onDeleteClick=function(b){},MO.FDsProjectPropertyToolBar_onRotationClick=
function(b){this._workspace._previewContent.switchRotation(b.checked)},MO.FDsProjectPropertyToolBar_construct=function(){this.__base.FUiToolBar.construct.call(this)},MO.FDsProjectPropertyToolBar_dispose=function(){this.__base.FUiToolBar.dispose.call(this)};
with(MO)MO.FDsProjectSceneCatalogContent=function(b){b=RClass.inherits(this,b,FUiDataTreeView,MListenerSelected);b._iconView="design3d.mesh.view";b._iconViewNot="design3d.mesh.viewno";b._activeSpace=null;b._materials=null;b.onBuild=FDsProjectSceneCatalogContent_onBuild;b.onLoadDisplay=FDsProjectSceneCatalogContent_onLoadDisplay;b.onNodeClick=FDsProjectSceneCatalogContent_onNodeClick;b.onNodeViewClick=FDsProjectSceneCatalogContent_onNodeViewClick;b.onNodeViewDoubleClick=FDsProjectSceneCatalogContent_onNodeViewDoubleClick;
b.lsnsSelect=null;b.construct=FDsProjectSceneCatalogContent_construct;b.buildTechnique=FDsProjectSceneCatalogContent_buildTechnique;b.buildRegion=FDsProjectSceneCatalogContent_buildRegion;b.buildRenderable=FDsProjectSceneCatalogContent_buildRenderable;b.buildDisplay=FDsProjectSceneCatalogContent_buildDisplay;b.buildSpace=FDsProjectSceneCatalogContent_buildSpace;b.selectObject=FDsProjectSceneCatalogContent_selectObject;b.showObject=FDsProjectSceneCatalogContent_showObject;b.dispose=FDsProjectSceneCatalogContent_dispose;
return b},MO.FDsProjectSceneCatalogContent_onBuild=function(b){this.__base.FUiDataTreeView.onBuild.call(this,b);this.lsnsClick.register(this,this.onNodeClick);this.loadUrl("/cloud.describe.tree.ws?action=query&code=resource.project")},MO.FDsProjectSceneCatalogContent_onLoadDisplay=function(b){this.buildRenderable(b._linkNode,b)},MO.FDsProjectSceneCatalogContent_onNodeClick=function(b,d){var f=d.dataPropertyGet("linker");this.selectObject(f)},MO.FDsProjectSceneCatalogContent_onNodeViewClick=function(b){var d=
b.treeNodeCell,f=b.treeNode.dataPropertyGet("linker");if(RClass.isClass(f,FDisplay))if(b.ctrlKey){for(var h=this._displays,q=h.count()-1;0<=q;q--){var w=h.get(q);w.dataPropertyGet("linker")._visible=!1;w.cell("view").setIcon(this._iconViewNot)}f._visible=!0;d.setIcon(this._iconView)}else f._visible=!f._visible,d.setIcon(f._visible?this._iconView:this._iconViewNot);if(RClass.isClass(f,FDrawable))if(b.ctrlKey){h=this._renderables;for(q=h.count()-1;0<=q;q--)w=h.get(q),w.dataPropertyGet("linker")._visible=
!1,w.cell("view").setIcon(this._iconViewNot);f._visible=!0;d.setIcon(this._iconView)}else f._visible=!f._visible,d.setIcon(f._visible?this._iconView:this._iconViewNot);if(RClass.isClass(f,FG3dMaterial))if(b.ctrlKey){b=this._materials;for(q=b.count()-1;0<=q;q--)h=b.get(q),h.dataPropertyGet("linker")._visible=!1,h.cell("view").setIcon(this._iconViewNot);f._visible=!0;d.setIcon(this._iconView)}else f._visible=!f._visible,d.setIcon(f._visible?this._iconView:this._iconViewNot)},MO.FDsProjectSceneCatalogContent_onNodeViewDoubleClick=
function(b){b=b.treeNode;var d=b.dataPropertyGet("linker");if(RClass.isClass(d,FDisplay))for(var d=this._displays,f=d.count()-1;0<=f;f--)b=d.get(f),b.dataPropertyGet("linker")._visible=!0,b.cell("view").setIcon(this._iconView);if(RClass.isClass(d,FDrawable))for(d=this._renderables,f=d.count()-1;0<=f;f--)b=d.get(f),b.dataPropertyGet("linker")._visible=!0,b.cell("view").setIcon(this._iconView);if(RClass.isClass(d,FG3dMaterial))for(d=this._materials,f=d.count()-1;0<=f;f--)b=d.get(f),b.dataPropertyGet("linker")._visible=
!0,b.cell("view").setIcon(this._iconView)},MO.FDsProjectSceneCatalogContent_construct=function(){this.__base.FUiDataTreeView.construct.call(this);this._renderables=new TObjects;this._materials=new TObjects},MO.FDsProjectSceneCatalogContent_buildTechnique=function(b,d){var f=this.createNode();f.setLabel("Technique");f.setTypeCode("technique");f.dataPropertySet("linker",d);b.appendNode(f)},MO.FDsProjectSceneCatalogContent_buildRegion=function(b,d){var f=this.createNode();f.setLabel("Region");f.setTypeCode("region");
f.dataPropertySet("linker",d);b.appendNode(f);var h=this.createNode();h.setLabel("Camera");h.setTypeCode("camera");h.dataPropertySet("linker",d.camera());f.appendNode(h);h=this.createNode();h.setLabel("Light");h.setTypeCode("light");h.dataPropertySet("linker",d.directionalLight());f.appendNode(h)},MO.FDsProjectSceneCatalogContent_buildRenderable=function(b,d){var f=d._renderable._material,h=this.createNode();h.setTypeCode("material");h.setLabel("Material");h.dataPropertySet("linker",f);this._materials.push(h);
b.appendNode(h);f=d._renderable;h=this.createNode();h.setTypeCode("renderable");h.setLabel("Renderable");h.dataPropertySet("linker",f);this._renderables.push(h);b.appendNode(h)},MO.FDsProjectSceneCatalogContent_buildDisplay=function(b,d){var f=this.createNode();f.setTypeCode("display");f.setLabel("Mesh");f.dataPropertySet("linker",d);b.appendNode(f);this.buildRenderable(f,d)},MO.FDsProjectSceneCatalogContent_buildSpace=function(b){var d=b.resource();this._activeSpace=b;var f=this.createNode();f.setTypeCode("space");
f.setLabel(d.code());f.setNote(d.label());f.dataPropertySet("linker",b);this.appendNode(f);this.buildTechnique(f,b.technique());this.buildRegion(f,b.region());this.buildDisplay(f,b._display);f.click()},MO.FDsProjectSceneCatalogContent_selectObject=function(b){null!=b&&this.processSelectedListener(b,!0)},MO.FDsProjectSceneCatalogContent_showObject=function(b){if(RClass.isClass(b,FDsSceneRenderable))for(var d=this._renderables,f=d.count(),h=0;h<f;h++)d.getAt(h).dataPropertyGet("linker")==b&&this.processSelectedListener(b,
!1)},MO.FDsProjectSceneCatalogContent_dispose=function(){this._displays=RObject.dispose(this._displays);this._renderables=RObject.dispose(this._renderables);this._materials=RObject.dispose(this._materials);this.__base.FUiDataTreeView.dispose.call(this)};
with(MO)MO.FDsProjectSceneCatalogToolBar=function(b){b=RClass.inherits(this,b,FUiToolBar);b._frameName="resource.project.SceneCatalogToolBar";b._canvasModeCd=EDsCanvasMode.Drop;b._dropButton=null;b._selectButton=null;b._translateButton=null;b._rotationButton=null;b._scaleButton=null;b._lookFrontButton=null;b._lookUpButton=null;b._lookLeftButton=null;b._playButton=null;b._viewButton=null;b.onBuilded=FDsProjectSceneCatalogToolBar_onBuilded;b.onModeClick=FDsProjectSceneCatalogToolBar_onModeClick;b.onRotationClick=
FDsProjectSceneCatalogToolBar_onRotationClick;b.construct=FDsProjectSceneCatalogToolBar_construct;b.dispose=FDsProjectSceneCatalogToolBar_dispose;return b},MO.FDsProjectSceneCatalogToolBar_onBuilded=function(b){this.__base.FUiToolBar.onBuilded.call(this,b)},MO.FDsProjectSceneCatalogToolBar_onModeClick=function(b){this._canvasModeCd=b._canvasModeCd;this._workspace._canvas.switchMode(b._canvasModeCd)},MO.FDsProjectSceneCatalogToolBar_onRotationClick=function(b,d){this._workspace._canvas.switchRotation(d)},
MO.FDsProjectSceneCatalogToolBar_construct=function(){this.__base.FUiToolBar.construct.call(this)},MO.FDsProjectSceneCatalogToolBar_dispose=function(){this.__base.FUiToolBar.dispose.call(this)};
with(MO)MO.FDsProjectCatalogToolBar=function(b){b=RClass.inherits(this,b,FUiToolBar);b._frameName="resource.project.CatalogToolBar";b._canvasModeCd=EDsCanvasMode.Drop;b._dropButton=null;b._selectButton=null;b._translateButton=null;b._rotationButton=null;b._scaleButton=null;b._lookFrontButton=null;b._lookUpButton=null;b._lookLeftButton=null;b._playButton=null;b._viewButton=null;b.onBuilded=FDsProjectCatalogToolBar_onBuilded;b.onModeClick=FDsProjectCatalogToolBar_onModeClick;b.onRotationClick=FDsProjectCatalogToolBar_onRotationClick;
b.construct=FDsProjectCatalogToolBar_construct;b.dispose=FDsProjectCatalogToolBar_dispose;return b},MO.FDsProjectCatalogToolBar_onBuilded=function(b){this.__base.FUiToolBar.onBuilded.call(this,b)},MO.FDsProjectCatalogToolBar_onModeClick=function(b){this._canvasModeCd=b._canvasModeCd;this._workspace._canvas.switchMode(b._canvasModeCd)},MO.FDsProjectCatalogToolBar_onRotationClick=function(b,d){this._workspace._canvas.switchRotation(d)},MO.FDsProjectCatalogToolBar_construct=function(){this.__base.FUiToolBar.construct.call(this)},
MO.FDsProjectCatalogToolBar_dispose=function(){this.__base.FUiToolBar.dispose.call(this)};
with(MO)MO.FDsProjectSceneDialog=function(b){b=RClass.inherits(this,b,FUiDialog);b._frameName="design3d.project.SceneDialog";b._dataModeCd=null;b._controlParentLabel=null;b._controlLabel=null;b._controlConfirmButton=null;b._controlCancelButton=null;b.onBuilded=FDsProjectSceneDialog_onBuilded;b.onConfirmLoad=FDsProjectSceneDialog_onConfirmLoad;b.onConfirmClick=FDsProjectSceneDialog_onConfirmClick;b.onCancelClick=FDsProjectSceneDialog_onCancelClick;b.construct=FDsProjectSceneDialog_construct;b.setDataCode=
FDsProjectSceneDialog_setDataCode;b.setDataLabel=FDsProjectSceneDialog_setDataLabel;b.switchDataMode=FDsProjectSceneDialog_switchDataMode;b.dispose=FDsProjectSceneDialog_dispose;return b},MO.FDsProjectSceneDialog_onBuilded=function(b){this.__base.FUiDialog.onBuilded.call(this,b);this._controlConfirmButton.addClickListener(this,this.onConfirmClick);this._controlCancelButton.addClickListener(this,this.onCancelClick)},MO.FDsProjectSceneDialog_onConfirmLoad=function(b){RConsole.find(FUiDesktopConsole).hide();
this.hide();this._frameSet._sceneListContent.serviceRelist()},MO.FDsProjectSceneDialog_onConfirmClick=function(b){RConsole.find(FUiDesktopConsole).showUploading();b=this._controlCode.get();var d=this._controlLabel.get(),f=RConsole.find(FDrSceneConsole),h=null;if(this._dataModeCd==EUiDataMode.Insert){var q=RClass.create(FDrScene);q._projectGuid=this._projectGuid;q._code=b;q._label=d;h=f.doCreate(q);q.dispose()}else throw new TError(this,"Unknown mode.");h.addLoadListener(this,this.onConfirmLoad)},
MO.FDsProjectSceneDialog_onCancelClick=function(b){this.hide()},MO.FDsProjectSceneDialog_construct=function(){this.__base.FUiDialog.construct.call(this)},MO.FDsProjectSceneDialog_setDataCode=function(b){this._controlCode.set(b)},MO.FDsProjectSceneDialog_setDataLabel=function(b){this._controlLabel.set(b)},MO.FDsProjectSceneDialog_switchDataMode=function(b){this._dataModeCd=b;b==EUiDataMode.Insert?this.setLabel("\u65b0\u5efa\u573a\u666f"):b==EUiDataMode.Update&&this.setLabel("\u573a\u666f\u5c5e\u6027")},
MO.FDsProjectSceneDialog_dispose=function(){this.__base.FUiDialog.dispose.call(this)};
with(MO)MO.FDsProjectSceneListContent=function(b){b=RClass.inherits(this,b,FUiListView);b._activeItem=null;b._activeGuid=null;b._refreshButton=null;b._saveButton=null;b._runButton=null;b.onBuilded=FDsProjectSceneListContent_onBuilded;b.onServiceLoad=FDsProjectSceneListContent_onServiceLoad;b.construct=FDsProjectSceneListContent_construct;b.doClickItem=FDsProjectSceneListContent_doClickItem;b.doDoubleClickItem=FDsProjectSceneListContent_doDoubleClickItem;b.serviceList=FDsProjectSceneListContent_serviceList;
b.serviceRelist=FDsProjectSceneListContent_serviceRelist;b.dispose=FDsProjectSceneListContent_dispose;return b},MO.FDsProjectSceneListContent_onBuilded=function(b){this.__base.FUiListView.onBuilded.call(this,b)},MO.FDsProjectSceneListContent_onServiceLoad=function(b){b=b.root.findNode("SceneCollection");this.clear();b=b.nodes();for(var d=b.count(),f=0;f<d;f++){var h=b.getAt(f);if(h.isName("Scene")){var q=this.createItem(FDsProjectSceneListItem);q.propertyLoad(h);q._guid=h.get("guid");q._code=h.get("code");
q._updateDate=h.get("update_date");q.setLabel(RString.nvl(h.get("label"),h.get("code")));q.refreshStyle();this.push(q)}}RConsole.find(FUiDesktopConsole).hide()},MO.FDsProjectSceneListContent_construct=function(){this.__base.FUiListView.construct.call(this)},MO.FDsProjectSceneListContent_doClickItem=function(b){this.__base.FUiListView.doClickItem.call(this,b);this._activeItem=b},MO.FDsProjectSceneListContent_doDoubleClickItem=function(b){this.__base.FUiListView.doDoubleClickItem.call(this,b);this._activeItem=
b;this._activeGuid=b._guid},MO.FDsProjectSceneListContent_serviceList=function(b){this._activeGuid=b;RConsole.find(FUiDesktopConsole).showLoading();b="/cloud.solution.project.ws?action=listProject&project_guid="+b;b=RConsole.find(FXmlConsole).sendAsync(b);b.addLoadListener(this,this.onServiceLoad);return b},MO.FDsProjectSceneListContent_serviceRelist=function(){return this.serviceList(this._activeGuid)},MO.FDsProjectSceneListContent_dispose=function(){this.__base.FUiListView.dispose.call(this)};
with(MO)MO.FDsProjectSceneListItem=function(b){b=RClass.inherits(this,b,FUiListViewItem);b.onBuild=FDsProjectSceneListItem_onBuild;b.refreshStyle=FDsProjectSceneListItem_refreshStyle;return b},MO.FDsProjectSceneListItem_onBuild=function(b){this.__base.FUiListViewItem.onBuild.call(this,b);b=this._hPanel;b.style.width="260px";b.style.height="150px"},MO.FDsProjectSceneListItem_refreshStyle=function(){this._hForm.style.backgroundImage='url("/cloud.content.scene.wv?do=preview&guid='+this._guid+'")'};
with(MO)MO.FDsProjectSceneListToolBar=function(b){b=RClass.inherits(this,b,FUiToolBar);b._frameName="resource.project.SceneListToolBar";b._controlSceneCreate=null;b._controlSceneDelete=null;b.onBuilded=FDsProjectSceneListToolBar_onBuilded;b.onSceneCreateClick=FDsProjectSceneListToolBar_onSceneCreateClick;b.onSceneDeleteLoad=FDsProjectSceneListToolBar_onSceneDeleteLoad;b.onSceneDeleteExecute=FDsProjectSceneListToolBar_onSceneDeleteExecute;b.onSceneDeleteClick=FDsProjectSceneListToolBar_onSceneDeleteClick;
b.construct=FDsProjectSceneListToolBar_construct;b.dispose=FDsProjectSceneListToolBar_dispose;return b},MO.FDsProjectSceneListToolBar_onBuilded=function(b){this.__base.FUiToolBar.onBuilded.call(this,b);this._controlSceneCreate.addClickListener(this,this.onSceneCreateClick);this._controlSceneDelete.addClickListener(this,this.onSceneDeleteClick)},MO.FDsProjectSceneListToolBar_onSceneCreateClick=function(b){b=this._frameSet._activeGuid;if(RString.isEmpty(b))throw new TError(this,"Project guid is empty.");
var d=RConsole.find(FUiWindowConsole).find(FDsProjectSceneDialog);d._frameSet=this._frameSet;d._projectGuid=b;d.setDataCode("");d.setDataLabel("");d.switchDataMode(EUiDataMode.Insert);d.showPosition(EUiPosition.Center)},MO.FDsProjectSceneListToolBar_onSceneDeleteLoad=function(b){RConsole.find(FUiDesktopConsole).hide();this._frameSet._sceneListContent.serviceRelist()},MO.FDsProjectSceneListToolBar_onSceneDeleteExecute=function(b){b.resultCd==EResult.Success&&(b=this._frameSet._sceneListContent.focusItem(),
RConsole.find(FUiDesktopConsole).showUploading(),RConsole.find(FDrSceneConsole).doDelete(b._guid).addLoadListener(this,this.onSceneDeleteLoad))},MO.FDsProjectSceneListToolBar_onSceneDeleteClick=function(b){if(!this._frameSet._sceneListContent.focusItem())return RConsole.find(FUiMessageConsole).showInfo("\u8bf7\u9009\u4e2d\u573a\u666f\u540e\uff0c\u518d\u70b9\u51fb\u64cd\u4f5c\u3002");RConsole.find(FUiMessageConsole).showConfirm("\u8bf7\u786e\u8ba4\u662f\u5426\u5220\u9664\u5f53\u524d\u573a\u666f\uff1f").addResultListener(this,
this.onSceneDeleteExecute)},MO.FDsProjectSceneListToolBar_construct=function(){this.__base.FUiToolBar.construct.call(this)},MO.FDsProjectSceneListToolBar_dispose=function(){this.__base.FUiToolBar.dispose.call(this)};
with(MO)MO.FDsProjectTabBar=function(b){b=RClass.inherits(this,b,FUiTabBar);b._frameName="design3d.project.TabBar";b._resourceTypeCd="mesh";b._controlProjectButton=null;b._controlResourceButton=null;b.onBuilded=FDsProjectTabBar_onBuilded;b.onButtonClick=FDsProjectTabBar_onButtonClick;b.construct=FDsProjectTabBar_construct;b.dispose=FDsProjectTabBar_dispose;return b},MO.FDsProjectTabBar_onBuilded=function(b){this.__base.FUiTabBar.onBuilded.call(this,b);this._controlProjectButton.addClickListener(this,
this.onButtonClick);this._controlResourceButton.addClickListener(this,this.onButtonClick)},MO.FDsProjectTabBar_onButtonClick=function(b){b=b.sender.name();"project"==b?this._workspace.selectFrameSet(EDsFrameSet.ProjectFrameSet):"resource"==b&&this._workspace.selectFrameSet(EDsFrameSet.ResourceFrameSet)},MO.FDsProjectTabBar_construct=function(){this.__base.FUiTabBar.construct.call(this)},MO.FDsProjectTabBar_dispose=function(){this.__base.FUiTabBar.dispose.call(this)};
with(MO)MO.FDsProjectWorkspace=function(b){b=RClass.inherits(this,b,FDuiWorkspace);b._frameName="design3d.project.Workspace";b._styleToolbarGround=RClass.register(b,new AStyle("_styleToolbarGround","Toolbar_Ground"));b._styleStatusbarGround=RClass.register(b,new AStyle("_styleStatusbarGround","Statusbar_Ground"));b._styleCatalogGround=RClass.register(b,new AStyle("_styleCatalogGround","Catalog_Ground"));b._styleCatalogToolbar=RClass.register(b,new AStyle("_styleCatalogToolbar","Catalog_Toolbar"));
b._styleSearchGround=RClass.register(b,new AStyle("_styleSearchGround","Search_Ground"));b._styleSearchToolbar=RClass.register(b,new AStyle("_styleCatalogToolbar","Search_Toolbar"));b._stylePropertyGround=RClass.register(b,new AStyle("_stylePropertyGround","Property_Ground"));b._stylePropertyToolbar=RClass.register(b,new AStyle("_stylePropertyToolbar","Property_Toolbar"));b._stylePropertyContent=RClass.register(b,new AStyle("_stylePropertyContent","Property_Content"));b._styleWorkspaceGround=RClass.register(b,
new AStyle("_styleWorkspaceGround","Workspace_Ground"));b._resourceTypeCd="project";b._frameToolBar=null;b._frameStatusBar=null;b._frameCatalog=null;b._frameCatalogToolbar=null;b._frameCatalogContent=null;b._frameSearch=null;b._frameSearchToolbar=null;b._frameSearchContent=null;b._framePreview=null;b._framePreviewToolbar=null;b._framePreviewContent=null;b._activeFrameSet=null;b._frameSets=null;b._propertyFrames=null;b.onBuilded=FDsProjectWorkspace_onBuilded;b.onMeshLoad=FDsProjectWorkspace_onMeshLoad;
b.onCatalogSelected=FDsProjectWorkspace_onCatalogSelected;b.construct=FDsProjectWorkspace_construct;b.selectFrameSet=FDsProjectWorkspace_selectFrameSet;b.findPropertyFrame=FDsProjectWorkspace_findPropertyFrame;b.switchContent=FDsProjectWorkspace_switchContent;b.load=FDsProjectWorkspace_load;b.dispose=FDsProjectWorkspace_dispose;return b},MO.FDsProjectWorkspace_onBuilded=function(b){this.__base.FDuiWorkspace.onBuilded.call(this,b);var d=this._frameToolBar=this.searchControl("toolbarFrame");d._hPanel.className=
this.styleName("Toolbar_Ground");this._frameBody=this.searchControl("bodyFrame");d=this._frameStatusBar=this.searchControl("statusFrame");d._hPanel.className=this.styleName("Statusbar_Ground");d=RBuilder.createTable(b);d.width="100%";var f=RBuilder.appendTableRow(d);this._hMenuPanel=RBuilder.appendTableCell(f);var h=this._tabBar=RClass.create(FDsProjectTabBar);h._workspace=this;h.buildDefine(b);b=RBuilder.appendTableCell(f);b.width="150px";b.align="right";b.vAlign="bottom";b.appendChild(h._hPanel);
this._frameToolBar._hPanel.appendChild(d);this.selectFrameSet(EDsFrameSet.ProjectFrameSet)},MO.FDsProjectWorkspace_onMeshLoad=function(b){this._activeSpace=b._activeSpace;this._catalog.buildSpace(this._activeSpace)},MO.FDsProjectWorkspace_onCatalogSelected=function(b,d){for(var f=this._activeSpace,h=this._propertyFrames,q=h.count(),w=0;w<q;w++){var z=h.value(w);z.hide()}if(RClass.isClass(b,FE3dStage))z=this.findPropertyFrame(EDsFrame.MeshSpacePropertyFrame),z.show(),z.loadObject(f,f);else if(RClass.isClass(b,
FG3dTechnique))z=this.findPropertyFrame(EDsFrame.MeshTechniquePropertyFrame),z.show(),z.loadObject(f,b);else if(RClass.isClass(b,FE3dRegion))z=this.findPropertyFrame(EDsFrame.MeshRegionPropertyFrame),z.show(),z.loadObject(f,b);else if(RClass.isClass(b,FE3dCamera))z=this.findPropertyFrame(EDsFrame.MeshCameraPropertyFrame),z.show(),z.loadObject(f,b);else if(RClass.isClass(b,FG3dDirectionalLight))z=this.findPropertyFrame(EDsFrame.MeshLightPropertyFrame),z.show(),z.loadObject(f,b);else if(RClass.isClass(b,
FE3dMeshDisplay))z=this.findPropertyFrame(EDsFrame.MeshDisplayPropertyFrame),z.show(),z.loadObject(f,b);else if(RClass.isClass(b,FG3dMaterial))z=this.findPropertyFrame(EDsFrame.MeshMaterialPropertyFrame),z.show(),z.loadObject(f,b);else if(RClass.isClass(b,FE3dMeshRenderable))z=this.findPropertyFrame(EDsFrame.MeshRenderablePropertyFrame),z.show(),z.loadObject(f,b);else throw new TError("Unknown select object type. (value={1})",b);},MO.FDsProjectWorkspace_construct=function(){this.__base.FDuiWorkspace.construct.call(this);
this._frameSets=new TDictionary;this._propertyFrames=new TDictionary},MO.FDsProjectWorkspace_selectFrameSet=function(b,d){var f=this._frameSets.get(b);if(!f){if(b==EDsFrameSet.ProjectFrameSet){var h=RClass.create(FDsProjectMenuBar);h._workspace=this;h.buildDefine(this._hPanel);f=RConsole.find(FFrameConsole).findByClass(this,FDsProjectFrameSet);f._workspace=this;f._menuBar=h;h._frameSet=f}else if(b==EDsFrameSet.ResourceFrameSet)h=RClass.create(FDsResourceMenuBar),h._workspace=this,h.buildDefine(this._hPanel),
f=RConsole.find(FFrameConsole).findByClass(this,FDsResourceFrameSet),f._workspace=this,f._menuBar=h,h._frameSet=f;else if(b==EDsFrameSet.MeshFrameSet)h=RClass.create(FDsMeshMenuBar),h._workspace=this,h.buildDefine(this._hPanel),f=RConsole.find(FFrameConsole).findByClass(this,FDsMeshFrameSet),f._workspace=this,f._menuBar=h,h._frameSet=f;else throw new TError("Unknown frameset. (name={1})",b);this._frameSets.set(b,f)}h=this._activeFrameSet;h!=f&&(h&&(this._hMenuPanel.removeChild(h._menuBar._hPanel),
this._frameBody.remove(h)),this._hMenuPanel.appendChild(f._menuBar._hPanel),this._frameBody.push(f),f.psResize());this._activeFrameSet=f;if(b!=EDsFrameSet.ProjectFrameSet)if(b==EDsFrameSet.ResourceFrameSet)f.load();else if(b==EDsFrameSet.MeshFrameSet)f.loadByGuid(d);else throw new TError("Unknown frameset. (name={1})",b);return f},MO.FDsProjectWorkspace_findPropertyFrame=function(b){var d=this._propertyFrames.get(b);d||(d=RConsole.find(FFrameConsole).get(this,b,this._framePreview._hContainer),d._workspace=
this,this._propertyFrames.set(b,d));return d},MO.FDsProjectWorkspace_switchContent=function(b){this._resourceTypeCd=b;this._searchContent.serviceSearch(b,"",40,0)},MO.FDsProjectWorkspace_load=function(){},MO.FDsProjectWorkspace_dispose=function(){this.__base.FDuiWorkspace.dispose.call(this);this._propertyFrames.dispose();this._propertyFrames=null};
with(MO)MO.FDsResourceCatalogContent=function(b){b=RClass.inherits(this,b,FUiDataTreeView,MListenerSelected);b._activeSpace=null;b._materials=null;b.onBuild=FDsResourceCatalogContent_onBuild;b.onLoadDisplay=FDsResourceCatalogContent_onLoadDisplay;b.onNodeClick=FDsResourceCatalogContent_onNodeClick;b.onNodeViewClick=FDsResourceCatalogContent_onNodeViewClick;b.onNodeViewDoubleClick=FDsResourceCatalogContent_onNodeViewDoubleClick;b.lsnsSelect=null;b.construct=FDsResourceCatalogContent_construct;b.selectObject=
FDsResourceCatalogContent_selectObject;b.showObject=FDsResourceCatalogContent_showObject;b.dispose=FDsResourceCatalogContent_dispose;return b},MO.FDsResourceCatalogContent_onBuild=function(b){this.__base.FUiDataTreeView.onBuild.call(this,b);this.addNodeClickListener(this,this.onNodeClick);this.loadUrl("/cloud.describe.tree.ws?action=query&code=resource.catalog")},MO.FDsResourceCatalogContent_onLoadDisplay=function(b){this.buildRenderable(b._linkNode,b)},MO.FDsResourceCatalogContent_onNodeClick=function(b,
d){},MO.FDsResourceCatalogContent_onNodeViewClick=function(b){},MO.FDsResourceCatalogContent_onNodeViewDoubleClick=function(b){},MO.FDsResourceCatalogContent_construct=function(){this.__base.FUiDataTreeView.construct.call(this);this._renderables=new TObjects;this._materials=new TObjects},MO.FDsResourceCatalogContent_selectObject=function(b){null!=b&&this.processSelectedListener(b,!0)},MO.FDsResourceCatalogContent_showObject=function(b){},MO.FDsResourceCatalogContent_dispose=function(){this.__base.FUiDataTreeView.dispose.call(this)};
with(MO)MO.FDsResourceCatalogToolBar=function(b){b=RClass.inherits(this,b,FUiToolBar);b._frameName="resource.resource.CatalogToolBar";b._controlFolderCreateButton=null;b._controlFolderDeleteButton=null;b._controlFolderPropertyButton=null;b._controlFolderOpenButton=null;b._controlFolderCloseButton=null;b._activeNodeGuid=null;b.onBuilded=FDsResourceCatalogToolBar_onBuilded;b.onFolderCreateClick=FDsResourceCatalogToolBar_onFolderCreateClick;b.onFolderDeleteLoad=FDsResourceCatalogToolBar_onFolderDeleteLoad;
b.onFolderDeleteExcute=FDsResourceCatalogToolBar_onFolderDeleteExcute;b.onFolderDeleteClick=FDsResourceCatalogToolBar_onFolderDeleteClick;b.onFolderPropertyClick=FDsResourceCatalogToolBar_onFolderPropertyClick;b.onFolderOpenClick=FDsResourceCatalogToolBar_onFolderOpenClick;b.onFolderCloseClick=FDsResourceCatalogToolBar_onFolderCloseClick;b.construct=FDsResourceCatalogToolBar_construct;b.dispose=FDsResourceCatalogToolBar_dispose;return b},MO.FDsResourceCatalogToolBar_onBuilded=function(b){this.__base.FUiToolBar.onBuilded.call(this,
b);this._controlFolderCreateButton.addClickListener(this,this.onFolderCreateClick);this._controlFolderDeleteButton.addClickListener(this,this.onFolderDeleteClick);this._controlFolderPropertyButton.addClickListener(this,this.onFolderPropertyClick);this._controlFolderOpenButton.addClickListener(this,this.onFolderOpenClick);this._controlFolderCloseButton.addClickListener(this,this.onFolderCloseClick)},MO.FDsResourceCatalogToolBar_onFolderCreateClick=function(b){var d=b=null,f=this._frameSet._catalogContent.focusNode();
f&&(b=f.guid(),d=f.label());f=RConsole.find(FUiWindowConsole).find(FDsResourceFolderDialog);f._workspace=this._workspace;f._frameSet=this._frameSet;f._parentGuid=b;f.setNodeParentLabel(d);f.setNodeLabel("");f.switchDataMode(EUiDataMode.Insert);f.showPosition(EUiPosition.Center)},MO.FDsResourceCatalogToolBar_onFolderDeleteLoad=function(b){RConsole.find(FUiDesktopConsole).hide();b=this._frameSet._catalogContent;var d=this._activeNodeGuid;d&&b.findByGuid(d).removeSelf();this._activeNodeGuid=null},MO.FDsResourceCatalogToolBar_onFolderDeleteExcute=
function(b){b.resultCd==EResult.Success&&(b=this._frameSet._catalogContent.focusNode(),RConsole.find(FUiDesktopConsole).showUploading(),this._activeNodeGuid=b._guid,RConsole.find(FDrResourceConsole).doFolderDelete(b._guid).addLoadListener(this,this.onFolderDeleteLoad))},MO.FDsResourceCatalogToolBar_onFolderDeleteClick=function(b){if(!this._frameSet._catalogContent.focusNode())return RConsole.find(FUiMessageConsole).showInfo("\u8bf7\u9009\u4e2d\u76ee\u5f55\u8282\u70b9\u540e\uff0c\u518d\u70b9\u51fb\u64cd\u4f5c\u3002");
RConsole.find(FUiMessageConsole).showConfirm("\u8bf7\u786e\u8ba4\u662f\u5426\u5220\u9664\u5f53\u524d\u76ee\u5f55\uff1f").addResultListener(this,this.onFolderDeleteExcute)},MO.FDsResourceCatalogToolBar_onFolderPropertyClick=function(b){b=this._frameSet._catalogContent.focusNode();if(!b)return RConsole.find(FUiMessageConsole).showInfo("\u8bf7\u9009\u4e2d\u76ee\u5f55\u8282\u70b9\u540e\uff0c\u518d\u70b9\u51fb\u64cd\u4f5c\u3002");var d=null;b._parent&&(d=b._parent.label());var f=RConsole.find(FUiWindowConsole).find(FDsResourceFolderDialog);
f._workspace=this._workspace;f._frameSet=this._frameSet;f._nodeGuid=b._guid;f.setNodeParentLabel(d);f.setNodeLabel(b.label());f.switchDataMode(EUiDataMode.Update);f.showPosition(EUiPosition.Center)},MO.FDsResourceCatalogToolBar_onFolderOpenClick=function(b){},MO.FDsResourceCatalogToolBar_onFolderCloseClick=function(b){},MO.FDsResourceCatalogToolBar_construct=function(){this.__base.FUiToolBar.construct.call(this)},MO.FDsResourceCatalogToolBar_dispose=function(){this.__base.FUiToolBar.dispose.call(this)};
with(MO)MO.FDsResourceCreateDialog=function(b){b=RClass.inherits(this,b,FUiDialog);b._frameName="resource.resource.CreateDialog";b._nodeGuid=null;b._controlNodeLabel=null;b._controlCode=null;b._controlLabel=null;b._controlConfirm=null;b._controlCancel=null;b.onBuilded=FDsResourceCreateDialog_onBuilded;b.onConfirmLoad=FDsResourceCreateDialog_onConfirmLoad;b.onConfirmClick=FDsResourceCreateDialog_onConfirmClick;b.onCancelClick=FDsResourceCreateDialog_onCancelClick;b.construct=FDsResourceCreateDialog_construct;
b.setNodeLabel=FDsResourceCreateDialog_setNodeLabel;b.switchMode=FDsResourceCreateDialog_switchMode;b.dispose=FDsResourceCreateDialog_dispose;return b},MO.FDsResourceCreateDialog_onBuilded=function(b){this.__base.FUiDialog.onBuilded.call(this,b);this._controlNodeLabel.setEditAble(!1);this._controlConfirm.addClickListener(this,this.onConfirmClick);this._controlCancel.addClickListener(this,this.onCancelClick)},MO.FDsResourceCreateDialog_onConfirmLoad=function(b){this.hide();RConsole.find(FUiDesktopConsole).hide();
RConsole.find(FUiResultConsole).checkEvent(b)&&this._frameSet._listContent.serviceResearch()},MO.FDsResourceCreateDialog_onConfirmClick=function(b){RConsole.find(FUiDesktopConsole).showUploading();b=this._controlCode.get();var d=this._controlLabel.get(),f=null;switch(this._modeCd){case EE3sResource.Material:f=RClass.create(FDrMaterial);f.setCode(b);f.setLabel(d);f=RConsole.find(FDrMaterialConsole).doCreate(f);break;case EE3sResource.Template:f=RClass.create(FDrTemplate);f.setCode(b);f.setLabel(d);
f=RConsole.find(FDrTemplateConsole).doCreate(f);break;case EE3sResource.Scene:f=RClass.create(FDrScene);f.setCode(b);f.setLabel(d);f=RConsole.find(FDrSceneConsole).doCreate(f);break;default:throw new TError(this,"Unknown mode. (mode_cd={1})",modeCd);}f.addLoadListener(this,this.onConfirmLoad)},MO.FDsResourceCreateDialog_onCancelClick=function(b){this.hide()},MO.FDsResourceCreateDialog_construct=function(){this.__base.FUiDialog.construct.call(this)},MO.FDsResourceCreateDialog_setNodeLabel=function(b){this._controlNodeLabel.set(b)},
MO.FDsResourceCreateDialog_switchMode=function(b){this._modeCd=b;switch(b){case EE3sResource.Material:this.setLabel("\u521b\u5efa\u6750\u8d28");break;case EE3sResource.Template:this.setLabel("\u521b\u5efa\u6a21\u677f");break;case EE3sResource.Scene:this.setLabel("\u521b\u5efa\u573a\u666f");break;default:throw new TError(this,"Unknown mode. (mode_cd={1})",b);}this._controlCode.set("");this._controlLabel.set("")},MO.FDsResourceCreateDialog_dispose=function(){this.__base.FUiDialog.dispose.call(this)};
with(MO)MO.FDsResourceFolderDialog=function(b){b=RClass.inherits(this,b,FUiDialog);b._frameName="resource.resource.FolderDialog";b._dataModeCd=null;b._controlParentLabel=null;b._controlLabel=null;b._controlConfirmButton=null;b._controlCancelButton=null;b.onBuilded=FDsResourceFolderDialog_onBuilded;b.onConfirmLoad=FDsResourceFolderDialog_onConfirmLoad;b.onConfirmClick=FDsResourceFolderDialog_onConfirmClick;b.onCancelClick=FDsResourceFolderDialog_onCancelClick;b.construct=FDsResourceFolderDialog_construct;
b.setNodeParentLabel=FDsResourceFolderDialog_setNodeParentLabel;b.setNodeLabel=FDsResourceFolderDialog_setNodeLabel;b.switchDataMode=FDsResourceFolderDialog_switchDataMode;b.dispose=FDsResourceFolderDialog_dispose;return b},MO.FDsResourceFolderDialog_onBuilded=function(b){this.__base.FUiDialog.onBuilded.call(this,b);this._controlParentLabel.setEditAble(!1);this._controlConfirmButton.addClickListener(this,this.onConfirmClick);this._controlCancelButton.addClickListener(this,this.onCancelClick)},MO.FDsResourceFolderDialog_onConfirmLoad=
function(b){RConsole.find(FUiDesktopConsole).hide();this.hide();b=this._frameSet._catalogContent;if(this._dataModeCd==EUiDataMode.Insert)if(this._parentGuid){var d=b.findByGuid(this._parentGuid);b.loadNode(d)}else b.loadService();else{var f=this._controlLabel.get(),d=b.focusNode();d.setLabel(f)}},MO.FDsResourceFolderDialog_onConfirmClick=function(b){RConsole.find(FUiDesktopConsole).showUploading();b=this._controlLabel.get();var d=RConsole.find(FDrResourceConsole),f=null,f=this._dataModeCd==EUiDataMode.Insert?
d.doFolderCreate(this._parentGuid,null,b):d.doFolderUpdate(this._nodeGuid,null,b);f.addLoadListener(this,this.onConfirmLoad)},MO.FDsResourceFolderDialog_onCancelClick=function(b){this.hide()},MO.FDsResourceFolderDialog_construct=function(){this.__base.FUiDialog.construct.call(this)},MO.FDsResourceFolderDialog_setNodeParentLabel=function(b){this._controlParentLabel.set(b)},MO.FDsResourceFolderDialog_setNodeLabel=function(b){this._controlLabel.set(b)},MO.FDsResourceFolderDialog_switchDataMode=function(b){this._dataModeCd=
b;b==EUiDataMode.Insert?this.setLabel("\u65b0\u5efa\u8d44\u6e90\u76ee\u5f55"):b==EUiDataMode.Update&&this.setLabel("\u8d44\u6e90\u76ee\u5f55\u5c5e\u6027")},MO.FDsResourceFolderDialog_dispose=function(){this.__base.FUiDialog.dispose.call(this)};
with(MO)MO.FDsResourceFrameSet=function(b){b=RClass.inherits(this,b,FDsFrameSet);b._styleToolbarGround=RClass.register(b,new AStyle("_styleToolbarGround","Toolbar_Ground"));b._styleCatalogContent=RClass.register(b,new AStyle("_styleCatalogContent","Catalog_Content"));b._styleListContent=RClass.register(b,new AStyle("_styleListContent","List_Content"));b._stylePropertyContent=RClass.register(b,new AStyle("_stylePropertyContent","Property_Content"));b._resourceTypeCd="picture";b._frameCatalog=null;
b._frameCatalogToolbar=null;b._frameCatalogContent=null;b._frameSearch=null;b._frameSearchToolbar=null;b._frameSearchContent=null;b._framePreview=null;b._framePreviewToolbar=null;b._framePreviewContent=null;b.onBuilded=FDsResourceFrameSet_onBuilded;b.onCatalogSelected=FDsResourceFrameSet_onCatalogSelected;b.construct=FDsResourceFrameSet_construct;b.switchContent=FDsResourceFrameSet_switchContent;b.load=FDsResourceFrameSet_load;b.dispose=FDsResourceFrameSet_dispose;return b},MO.FDsResourceFrameSet_onBuilded=
function(b){this.__base.FDsFrameSet.onBuilded.call(this,b)},MO.FDsResourceFrameSet_onCatalogSelected=function(b,d){var f=this._activeSpace;if(f)if(this.hidePropertyFrames(),RClass.isClass(b,FE3dStage)){var h=this.findPropertyFrame(EDsFrame.MeshSpacePropertyFrame);h.show();h.loadObject(f,b)}else if(RClass.isClass(b,FG3dTechnique))h=this.findPropertyFrame(EDsFrame.MeshTechniquePropertyFrame),h.show(),h.loadObject(f,b);else if(RClass.isClass(b,FE3dRegion))h=this.findPropertyFrame(EDsFrame.MeshRegionPropertyFrame),
h.show(),h.loadObject(f,b);else if(RClass.isClass(b,FE3dCamera))h=this.findPropertyFrame(EDsFrame.MeshCameraPropertyFrame),h.show(),h.loadObject(f,b);else if(RClass.isClass(b,FG3dDirectionalLight))h=this.findPropertyFrame(EDsFrame.MeshLightPropertyFrame),h.show(),h.loadObject(f,b);else if(RClass.isClass(b,FE3dMeshDisplay))h=this.findPropertyFrame(EDsFrame.MeshDisplayPropertyFrame),h.show(),h.loadObject(f,b);else if(RClass.isClass(b,FG3dMaterial))h=this.findPropertyFrame(EDsFrame.MeshMaterialPropertyFrame),
h.show(),h.loadObject(f,b);else if(RClass.isClass(b,FE3dMeshRenderable))h=this.findPropertyFrame(EDsFrame.MeshRenderablePropertyFrame),h.show(),h.loadObject(f,b);else throw new TError("Unknown select object type. (select={1})",b);},MO.FDsResourceFrameSet_construct=function(){this.__base.FDsFrameSet.construct.call(this)},MO.FDsResourceFrameSet_switchContent=function(b){this._resourceTypeCd=b;this._listContent.serviceSearch(b,"","",40,0)},MO.FDsResourceFrameSet_load=function(){this._listToolBar.storageLoad()},
MO.FDsResourceFrameSet_dispose=function(){this.__base.FDsFrameSet.dispose.call(this)};
with(MO)MO.FDsResourceImportDialog=function(b){b=RClass.inherits(this,b,FUiDialog);b._frameName="resource.resource.ImportDialog";b._nodeGuid=null;b._controlPrivateButton=null;b._controlTeamButton=null;b._controlShareButton=null;b.onBuilded=FDsResourceImportDialog_onBuilded;b.onFileChange=FDsResourceImportDialog_onFileChange;b.onFileLoaded=FDsResourceImportDialog_onFileLoaded;b.onConfirmLoad=FDsResourceImportDialog_onConfirmLoad;b.onConfirmClick=FDsResourceImportDialog_onConfirmClick;b.onCancelClick=
FDsResourceImportDialog_onCancelClick;b.construct=FDsResourceImportDialog_construct;b.setNodeLabel=FDsResourceImportDialog_setNodeLabel;b.switchMode=FDsResourceImportDialog_switchMode;b.dispose=FDsResourceImportDialog_dispose;return b},MO.FDsResourceImportDialog_onBuilded=function(b){this.__base.FUiDialog.onBuilded.call(this,b);this._controlNodeLabel.setEditAble(!1);this._controlFile.addDataChangedListener(this,this.onFileChange);this._controlConfirmButton.addClickListener(this,this.onConfirmClick);
this._controlCancelButton.addClickListener(this,this.onCancelClick)},MO.FDsResourceImportDialog_onFileChange=function(b){b=this._controlFile.get();b=RFile.name(b);RString.isEmpty(this._controlCode.get())&&this._controlCode.set(b);RString.isEmpty(this._controlLabel.get())&&this._controlLabel.set(b)},MO.FDsResourceImportDialog_onFileLoaded=function(b){b=this._fileReader;var d=this._controlCode.get(),f=this._controlLabel.get(),h=null;if(this._modeCd==EE3sResource.Bitmap)h="/cloud.resource.bitmap.wv?do=importData";
else if(this._modeCd==EE3sResource.Model)h="/cloud.resource.model.wv?do=importData";else throw new TError(this,"Type is invalid.");this._nodeGuid&&(h+="&node_guid="+this._nodeGuid);h+="&code="+d+"&label="+f+"&data_length="+b.length()+"&file_name="+b.fileName();h=RBrowser.urlEncode(h);RConsole.find(FHttpConsole).send(h,b.data()).addLoadListener(this,this.onConfirmLoad);this._fileReader=RObject.dispose(b)},MO.FDsResourceImportDialog_onConfirmLoad=function(b){RConsole.find(FUiDesktopConsole).hide();
this.hide();this._frameSet._listContent.serviceResearch()},MO.FDsResourceImportDialog_onConfirmClick=function(b){RConsole.find(FUiDesktopConsole).showUploading();b=this._controlFile._hInput.files[0];var d=this._fileReader=RClass.create(FFileReader);d.addLoadListener(this,this.onFileLoaded);d.loadFile(b)},MO.FDsResourceImportDialog_onCancelClick=function(b){this.hide()},MO.FDsResourceImportDialog_construct=function(){this.__base.FUiDialog.construct.call(this)},MO.FDsResourceImportDialog_setNodeLabel=
function(b){this._controlNodeLabel.set(b)},MO.FDsResourceImportDialog_switchMode=function(b){this._modeCd=b;switch(b){case EE3sResource.Bitmap:this.setLabel("\u5bfc\u5165\u56fe\u7247\u8d44\u6e90");break;case EE3sResource.Model:this.setLabel("\u5bfc\u5165\u6a21\u578b\u8d44\u6e90");break;default:throw new TError(this,"Unknown mode. (mode_cd={1})",b);}this._controlCode.set("");this._controlLabel.set("")},MO.FDsResourceImportDialog_dispose=function(){this.__base.FUiDialog.dispose.call(this)};
with(MO)MO.FDsResourceListContent=function(b){b=RClass.inherits(this,b,FUiListView);b._contentFlag=null;b._contentTypeCd=EE3sResource.All;b._contentSerach="";b._contentOrder="";b._contentPageSize=40;b._contentPageCount=0;b._contentPage=0;b._activeItem=null;b._activeGuid=null;b._refreshButton=null;b._saveButton=null;b._runButton=null;b.onServiceLoad=FDsResourceListContent_onServiceLoad;b.construct=FDsResourceListContent_construct;b.doClickItem=FDsResourceListContent_doClickItem;b.doDoubleClickItem=
FDsResourceListContent_doDoubleClickItem;b.serviceSearch=FDsResourceListContent_serviceSearch;b.serviceResearch=FDsResourceListContent_serviceResearch;b.dispose=FDsResourceListContent_dispose;return b},MO.FDsResourceListContent_onServiceLoad=function(b){b=b.root.findNode("ResourceCollection");var d=b.getInteger("page_size"),f=b.getInteger("page_count"),h=b.getInteger("page");this._frameSet._listToolBar.setNavigator(d,f,h);this.clear();b=b.nodes();d=b.count();for(f=0;f<d;f++)if(h=b.getAt(f),h.isName("Resource")){var q=
this.createItem(FDsResourceListItem);q.propertyLoad(h);q._guid=h.get("guid");q._typeCd=h.get("type_cd");q._shareCd=h.get("share_cd");q._code=h.get("code");q._updateDate=h.get("update_date");q.setTypeLabel(q._typeCd);q.setLabel(h.get("code")+" - "+h.get("label"));q.refreshStyle();this.push(q)}RConsole.find(FUiDesktopConsole).hide()},MO.FDsResourceListContent_construct=function(){this.__base.FUiListView.construct.call(this)},MO.FDsResourceListContent_doClickItem=function(b){this.__base.FUiListView.doClickItem.call(this,
b)},MO.FDsResourceListContent_doDoubleClickItem=function(b){this.__base.FUiListView.doDoubleClickItem.call(this,b);var d=b._guid;this._activeItem=b;this._activeGuid=b._guid;var f=this._frameSet._workspace;b=b._typeCd;if(b==EE3sResource.Bitmap)f.selectFrameSet(EDsFrameSet.PrivateBitmapFrameSet,d);else if(b==EE3sResource.Material)f.selectFrameSet(EDsFrameSet.PrivateMaterialFrameSet,d);else if(b==EE3sResource.Model)f.selectFrameSet(EDsFrameSet.PrivateModelFrameSet,d);else if(b==EE3sResource.Template)f.selectFrameSet(EDsFrameSet.PrivateTemplateFrameSet,
d);else if(b==EE3sResource.Scene)f.selectFrameSet(EDsFrameSet.PrivateSceneFrameSet,d);else throw new TError(this,"Unsupport resource format.");},MO.FDsResourceListContent_serviceSearch=function(b,d,f,h,q,w){null==b&&(b=this._contentTypeCd);null==d&&(d=this._contentSerach);null==f&&(f=this._contentOrder);null==h&&(h=this._contentPageSize);null==q&&(q=this._contentPage);if(!w){var z=b+"|"+d+"|"+f+"|"+h+"|"+q;if(this._contentFlag==z)return}this._contentFlag=z;this._contentTypeCd=b;this._contentSerach=
d;this._contentOrder=f;this._contentPageSize=h;this._contentPage=q;RConsole.find(FUiDesktopConsole).showLoading();RConsole.find(FDrResourceConsole).doList(this._contentTypeCd,this._contentSerach,this._contentOrder,this._contentPageSize,this._contentPage).addLoadListener(this,this.onServiceLoad)},MO.FDsResourceListContent_serviceResearch=function(){this.serviceSearch(this._contentTypeCd,this._contentSerach,this._contentOrder,this._contentPageSize,this._contentPage,!0)},MO.FDsResourceListContent_dispose=
function(){this.__base.FUiListView.dispose.call(this)};
with(MO)MO.FDsResourceListItem=function(b){b=RClass.inherits(this,b,FUiListViewItem);b._styleTypePanel=RClass.register(b,new AStyle("_styleTypePanel"));b._styleTypePrivateLabel=RClass.register(b,new AStyle("_styleTypePublicLabel"));b._styleTypePublicLabel=RClass.register(b,new AStyle("_styleTypePrivateLabel"));b.onBuild=FDsResourceListItem_onBuild;b.setTypeLabel=FDsResourceListItem_setTypeLabel;b.refreshStyle=FDsResourceListItem_refreshStyle;return b},MO.FDsResourceListItem_onBuild=function(b){this.__base.FUiListViewItem.onBuild.call(this,
b);b=this._hPanel;b.style.width="200px";b.style.height="150px";this._hLine1.className=this.styleName("TypePanel");this._hLine1.vAlign="top";this._hTypeLabel=RBuilder.appendDiv(this._hLine1,this.styleName("TypePrivateLabel"))},MO.FDsResourceListItem_setTypeLabel=function(b){this._hTypeLabel.innerHTML=b},MO.FDsResourceListItem_refreshStyle=function(){this._hTypeLabel.className="Public"==this._shareCd?this.styleName("TypePublicLabel"):this.styleName("TypePrivateLabel");this._hForm.style.backgroundImage=
'url("'+("/cloud.resource.preview.wv?type_cd="+this._typeCd+"&guid="+this._guid+"&update_date="+this._updateDate)+'")'};
with(MO)MO.FDsResourceListToolBar=function(b){b=RClass.inherits(this,b,FUiToolBar,MUiStorage);b._dropButton=null;b._selectButton=null;b._translateButton=null;b._rotationButton=null;b._scaleButton=null;b._lookFrontButton=null;b._lookUpButton=null;b._lookLeftButton=null;b._playButton=null;b._viewButton=null;b.onBuilded=FDsResourceListToolBar_onBuilded;b.onSearchClick=FDsResourceListToolBar_onSearchClick;b.onNavigatorClick=FDsResourceListToolBar_onNavigatorClick;b.onTypeClick=FDsResourceListToolBar_onTypeClick;
b.construct=FDsResourceListToolBar_construct;b.makeTypeCd=FDsResourceListToolBar_makeTypeCd;b.setNavigator=FDsResourceListToolBar_setNavigator;b.doNavigator=FDsResourceListToolBar_doNavigator;b.storageLoad=FDsResourceListToolBar_storageLoad;b.dispose=FDsResourceListToolBar_dispose;return b},MO.FDsResourceListToolBar_onBuilded=function(b){this.__base.FUiToolBar.onBuilded.call(this,b);this._controlSearchEdit.addClickListener(this,this.onSearchClick);this._controlFirstButton.addClickListener(this,this.onNavigatorClick);
this._controlPriorButton.addClickListener(this,this.onNavigatorClick);this._controlNextButton.addClickListener(this,this.onNavigatorClick);this._controlLastButton.addClickListener(this,this.onNavigatorClick);this._controlTypeAll.addClickListener(this,this.onTypeClick);this._controlTypeNone.addClickListener(this,this.onTypeClick);this._controlTypeBitmap.addClickListener(this,this.onTypeClick);this._controlTypeBitmap.check(!0);this._controlTypeMaterial.addClickListener(this,this.onTypeClick);this._controlTypeMaterial.check(!0);
this._controlTypeModel.addClickListener(this,this.onTypeClick);this._controlTypeModel.check(!0);this._controlTypeTemplate.addClickListener(this,this.onTypeClick);this._controlTypeTemplate.check(!0);this._controlTypeScene.addClickListener(this,this.onTypeClick);this._controlTypeScene.check(!0)},MO.FDsResourceListToolBar_onSearchClick=function(b){this.doNavigator(0)},MO.FDsResourceListToolBar_onNavigatorClick=function(b){b=b.sender.name();var d=this._contentPage;switch(b){case "firstButton":d=0;break;
case "priorButton":d--;break;case "nextButton":d++;break;case "lastButton":d=this._contentPageCount-1}this.doNavigator(d)},MO.FDsResourceListToolBar_onTypeClick=function(b){switch(b.sender.name()){case "typeAll":this._controlTypeBitmap.check(!0);this._controlTypeMaterial.check(!0);this._controlTypeModel.check(!0);this._controlTypeTemplate.check(!0);this._controlTypeScene.check(!0);break;case "typeNone":this._controlTypeBitmap.check(!1),this._controlTypeMaterial.check(!1),this._controlTypeModel.check(!1),
this._controlTypeTemplate.check(!1),this._controlTypeScene.check(!1)}b=this.makeTypeCd();var d=this._controlSearchEdit.text();this._frameSet._listContent.serviceSearch(b,d,"",this._contentPageSize,0);this.storageSet("resource_type_cd",b);this.storageSet("control_type_bitmap:check",RBoolean.toString(this._controlTypeBitmap.isCheck()));this.storageSet("control_type_material:check",RBoolean.toString(this._controlTypeMaterial.isCheck()));this.storageSet("control_type_model:check",RBoolean.toString(this._controlTypeModel.isCheck()));
this.storageSet("control_type_template:check",RBoolean.toString(this._controlTypeTemplate.isCheck()));this.storageSet("control_type_scene:check",RBoolean.toString(this._controlTypeScene.isCheck()));this.storageUpdate()},MO.FDsResourceListToolBar_construct=function(){this.__base.FUiToolBar.construct.call(this)},MO.FDsResourceListToolBar_makeTypeCd=function(){var b="";this._controlTypeBitmap.isCheck()&&(b+="|Bitmap");this._controlTypeMaterial.isCheck()&&(b+="|Material");this._controlTypeModel.isCheck()&&
(b+="|Model");this._controlTypeTemplate.isCheck()&&(b+="|Template");this._controlTypeScene.isCheck()&&(b+="|Scene");""!=b&&(b=b.substring(1));RString.isEmpty(b)&&(b="All");return b},MO.FDsResourceListToolBar_setNavigator=function(b,d,f){this._contentPageSize=b;this._contentPageCount=d;this._contentPage=f;this._controlPageEdit.setText(f)},MO.FDsResourceListToolBar_doNavigator=function(b){var d=this.makeTypeCd(),f=this._controlSearchEdit.text();b=RInteger.toRange(b,0,this._contentPageCount);this._contentTypeCd==
d&&this._contentSerach==f&&this._contentPage==b||this._frameSet._listContent.serviceSearch(d,f,"",this._contentPageSize,b);this._contentTypeCd=d;this._contentSerach=f},MO.FDsResourceListToolBar_storageLoad=function(){this._controlTypeBitmap.check(this.storageGetBoolean("control_type_bitmap:check",!0));this._controlTypeMaterial.check(this.storageGetBoolean("control_type_material:check",!0));this._controlTypeModel.check(this.storageGetBoolean("control_type_model:check",!0));this._controlTypeTemplate.check(this.storageGetBoolean("control_type_template:check",
!0));this._controlTypeScene.check(this.storageGetBoolean("control_type_scene:check",!0));this.makeTypeCd();var b=this.storageGet("resource_type_cd","All"),d=this._controlSearchEdit.text();this._frameSet._listContent.serviceSearch(b,d,"",this._contentPageSize,0)},MO.FDsResourceListToolBar_dispose=function(){this.__base.FUiToolBar.dispose.call(this)};
with(MO)MO.FDsResourceMenuBar=function(b){b=RClass.inherits(this,b,FUiMenuBar);b._controlImportPicture=null;b._controlImportModel=null;b._controlCreateMaterial=null;b._controlCreateTemplate=null;b._controlCreateScene=null;b._controlDelete=null;b._controlShareOpen=null;b._controlShareClose=null;b.onImportPictureClick=FDsResourceMenuBar_onImportPictureClick;b.onImportModelClick=FDsResourceMenuBar_onImportModelClick;b.onCreateMaterialClick=FDsResourceMenuBar_onCreateMaterialClick;b.onCreateTemplateClick=
FDsResourceMenuBar_onCreateTemplateClick;b.onCreateSceneClick=FDsResourceMenuBar_onCreateSceneClick;b.onDeleteLoad=FDsResourceMenuBar_onDeleteLoad;b.onDeleteExecute=FDsResourceMenuBar_onDeleteExecute;b.onDeleteClick=FDsResourceMenuBar_onDeleteClick;b.onShareLoad=FDsResourceMenuBar_onShareLoad;b.onShareClick=FDsResourceMenuBar_onShareClick;b.construct=FDsResourceMenuBar_construct;b.dispose=FDsResourceMenuBar_dispose;return b},MO.FDsResourceMenuBar_onImportPictureClick=function(b){var d=this._workspace._activeFrameSet._catalogContent.focusNode(),
f=b=null;d&&(b=d.guid(),f=d.label());d=RConsole.find(FUiWindowConsole).find(FDsResourceImportDialog);d._frameSet=this._frameSet;d._workspace=this._workspace;d._nodeGuid=b;d.setNodeLabel(f);d.switchMode(EE3sResource.Bitmap);d.showPosition(EUiPosition.Center)},MO.FDsResourceMenuBar_onImportModelClick=function(b){var d=this._workspace._activeFrameSet._catalogContent.focusNode(),f=b=null;d&&(b=d.guid(),f=d.label());d=RConsole.find(FUiWindowConsole).find(FDsResourceImportDialog);d._frameSet=this._frameSet;
d._workspace=this._workspace;d._nodeGuid=b;d.setNodeLabel(f);d.switchMode(EE3sResource.Model);d.showPosition(EUiPosition.Center)},MO.FDsResourceMenuBar_onCreateMaterialClick=function(){var b=this._workspace._activeFrameSet._catalogContent.focusNode(),d=null,f=null;b&&(d=b.guid(),f=b.label());b=RConsole.find(FUiWindowConsole).find(FDsResourceCreateDialog);b._frameSet=this._frameSet;b._workspace=this._workspace;b._nodeGuid=d;b.setNodeLabel(f);b.switchMode(EE3sResource.Material);b.showPosition(EUiPosition.Center)},
MO.FDsResourceMenuBar_onCreateTemplateClick=function(){var b=this._workspace._activeFrameSet._catalogContent.focusNode(),d=null,f=null;b&&(d=b.guid(),f=b.label());b=RConsole.find(FUiWindowConsole).find(FDsResourceCreateDialog);b._frameSet=this._frameSet;b._workspace=this._workspace;b._nodeGuid=d;b.setNodeLabel(f);b.switchMode(EE3sResource.Template);b.showPosition(EUiPosition.Center)},MO.FDsResourceMenuBar_onCreateSceneClick=function(){var b=this._workspace._activeFrameSet._catalogContent.focusNode(),
d=null,f=null;b&&(d=b.guid(),f=b.label());b=RConsole.find(FUiWindowConsole).find(FDsResourceCreateDialog);b._frameSet=this._frameSet;b._workspace=this._workspace;b._nodeGuid=d;b.setNodeLabel(f);b.switchMode(EE3sResource.Scene);b.showPosition(EUiPosition.Center)},MO.FDsResourceMenuBar_onDeleteLoad=function(b){RConsole.find(FUiDesktopConsole).hide();this._frameSet._listContent.serviceResearch()},MO.FDsResourceMenuBar_onDeleteExecute=function(b){if(b.resultCd!=EResult.Success)RConsole.find(FUiDesktopConsole).hide();
else{var d=this._frameSet._listContent.focusItem();b=d._typeCd;d=d._guid;RConsole.find(FUiDesktopConsole).showUploading();RConsole.find(FDrResourceConsole).doDelete(b,d).addLoadListener(this,this.onDeleteLoad)}},MO.FDsResourceMenuBar_onDeleteClick=function(b){if(!this._frameSet._listContent.focusItem())return alert("\u8bf7\u9009\u4e2d\u540e\u518d\u70b9\u51fb\u5220\u9664");RConsole.find(FUiMessageConsole).showConfirm("\u8bf7\u786e\u8ba4\u662f\u5426\u5220\u9664\u5f53\u524d\u8d44\u6e90\uff1f").addResultListener(this,
this.onDeleteExecute)},MO.FDsResourceMenuBar_onShareLoad=function(){RConsole.find(FUiDesktopConsole).hide()},MO.FDsResourceMenuBar_onShareClick=function(b){var d=this._frameSet._listContent.focusItem();if(!d)return alert("\u8bf7\u9009\u4e2d\u540e\u518d\u70b9\u51fb\u5220\u9664");var f=null,f="shareOpen"==b.sender.name()?"Public":"Private";b=d._guid;RConsole.find(FUiDesktopConsole).showUploading();RConsole.find(FDrResourceConsole).doShare(b,f).addLoadListener(this,this.onShareLoad)},MO.FDsResourceMenuBar_construct=
function(){this.__base.FUiMenuBar.construct.call(this)},MO.FDsResourceMenuBar_dispose=function(){this.__base.FUiMenuBar.dispose.call(this)};
with(MO)MO.FDsResourcePropertyContent=function(b){b=RClass.inherits(this,b,FDsCanvas);b._activeSpace=null;b._canvasModeCd=EDsCanvasMode.Drop;b._canvasMoveCd=EDsCanvasDrag.Unknown;b._optionRotation=!1;b._rotation=null;b._capturePosition=null;b._captureMatrix=null;b._captureRotation=null;b._dimensional=null;b._selectObject=null;b._selectBoundBox=null;b._selectRenderables=null;b._cameraMoveRate=8;b._cameraKeyRotation=3;b._cameraMouseRotation=.005;b._templateMatrix=null;b._templateRenderable=null;b._templateFace=
null;b._templateTranslation=null;b._templateRotation=null;b._templateScale=null;b._templateViewScale=.05;b.onBuild=FDsResourcePropertyContent_onBuild;b.onMouseCaptureStart=FDsResourcePropertyContent_onMouseCaptureStart;b.onMouseCapture=FDsResourcePropertyContent_onMouseCapture;b.onMouseCaptureStop=FDsResourcePropertyContent_onMouseCaptureStop;b.onEnterFrame=FDsResourcePropertyContent_onEnterFrame;b.onMeshLoad=FDsResourcePropertyContent_onMeshLoad;b.oeResize=FDsResourcePropertyContent_oeResize;b.oeRefresh=
FDsResourcePropertyContent_oeRefresh;b.construct=FDsResourcePropertyContent_construct;b.innerSelectDisplay=FDsResourcePropertyContent_innerSelectDisplay;b.innerSelectLayer=FDsResourcePropertyContent_innerSelectLayer;b.selectNone=FDsResourcePropertyContent_selectNone;b.selectDisplay=FDsResourcePropertyContent_selectDisplay;b.selectMaterial=FDsResourcePropertyContent_selectMaterial;b.selectRenderable=FDsResourcePropertyContent_selectRenderable;b.switchRotation=FDsResourcePropertyContent_switchRotation;
b.reloadRegion=FDsResourcePropertyContent_reloadRegion;b.loadMeshByGuid=FDsResourcePropertyContent_loadMeshByGuid;b.loadMeshByCode=FDsResourcePropertyContent_loadMeshByCode;b.dispose=FDsResourcePropertyContent_dispose;return b},MO.FDsResourcePropertyContent_onBuild=function(b){this.__base.FDsCanvas.onBuild.call(this,b)},MO.FDsResourcePropertyContent_onMouseCaptureStart=function(b){var d=this._activeSpace;if(d){var f=this._activeSpace.region(),f=RConsole.find(FG3dTechniqueConsole).find(this._graphicContext,
FG3dSelectTechnique).test(f,b.offsetX,b.offsetY);this.selectRenderable(f);this._capturePosition.set(b.clientX,b.clientY);this._captureRotation.assign(d.camera()._rotation);f&&(f=f.display(),this._captureMatrix.assign(f.matrix()));this._templateMatrix.identity();if(this._templateFace)for(this._templateFaceMatrix.assign(this._templateFace.matrix()),b=this._selectRenderables,d=b.count()-1;0<=d;d--)f=b.getAt(d),f._dragMatrix||(f._dragMatrix=new SMatrix3d),f._dragMatrix.assign(f.matrix());RHtml.cursorSet(this._hPanel,
EUiCursor.Pointer)}},MO.FDsResourcePropertyContent_onMouseCapture=function(b){if(this._activeSpace){var d=b.clientX-this._capturePosition.x,f=b.clientY-this._capturePosition.y,h=this._canvasMoveCd,q=this._templateFace;b=this._templateMatrix;switch(this._canvasModeCd){case EDsCanvasMode.Drop:var h=this._activeSpace.camera().rotation(),w=this._captureRotation;h.x=w.x-f*this._cameraMouseRotation;h.y=w.y-d*this._cameraMouseRotation;break;case EDsCanvasMode.Translate:q&&(h==EDsCanvasDrag.X?b.tx=d/10:h==
EDsCanvasDrag.Y?b.ty=-f/10:h==EDsCanvasDrag.Z&&(b.tz=d/10));break;case EDsCanvasMode.Rotation:q&&(h==EDsCanvasDrag.X?b.rx=d/10:h==EDsCanvasDrag.Y?b.ry=-f/10:h==EDsCanvasDrag.Z&&(b.rz=d/10));break;case EDsCanvasMode.Scale:q&&(h==EDsCanvasDrag.X?b.sx=d/10:h==EDsCanvasDrag.Y?b.sy=-f/10:h==EDsCanvasDrag.Z?b.sz=d/10:h==EDsCanvasDrag.All&&(b.sx=d/10,b.sy=d/10,b.sz=d/10))}if(q)for(q.matrix().merge(this._templateFaceMatrix,b),d=this._selectRenderables,f=d.count()-1;0<=f;f--)h=d.getAt(f),h._matrix.merge(h._dragMatrix,
b)}},MO.FDsResourcePropertyContent_onMouseCaptureStop=function(b){RHtml.cursorSet(this._hPanel,EUiCursor.Auto)},MO.FDsResourcePropertyContent_onEnterFrame=function(){var b=this._activeSpace;if(b){var d=b.timer().spanSecond(),b=b.camera(),f=this._cameraMoveRate*d,d=this._cameraKeyRotation*d,h=RKeyboard.isPress(EStageKey.Forward),q=RKeyboard.isPress(EStageKey.Back);h&&!q&&b.doWalk(f);!h&&q&&b.doWalk(-f);h=RKeyboard.isPress(EStageKey.Up);q=RKeyboard.isPress(EStageKey.Down);h&&!q&&b.doFly(f);!h&&q&&b.doFly(-f);
f=RKeyboard.isPress(EStageKey.RotationLeft);h=RKeyboard.isPress(EStageKey.RotationRight);f&&!h&&b.doYaw(d);!f&&h&&b.doYaw(-d);f=RKeyboard.isPress(EStageKey.RotationUp);h=RKeyboard.isPress(EStageKey.RotationDown);f&&!h&&b.doPitch(d);!f&&h&&b.doPitch(-d);b.update();this._optionRotation&&(d=this._rotation,b=this._activeSpace._display.matrix(),b.setRotation(b.rx,b.ry+d.y,b.rz),b.update(),d.y=.01)}},MO.FDsResourcePropertyContent_onMeshLoad=function(b){b=this._activeSpace.region();var d=b.camera();d.setPosition(0,
3,-10);d.lookAt(0,3,0);d.update();var f=this._hPanel,d=d.projection();d.size().set(f.width,f.height);d._angle=45;d.update();b=b.directionalLight().camera();b.setPosition(10,10,0);b.lookAt(0,0,0);b.update();this.processLoadListener(this)},MO.FDsResourcePropertyContent_oeResize=function(b){this.__base.FDsCanvas.oeResize.call(this,b);var d=this._hPanel;b=d.offsetWidth;var d=d.offsetHeight,f=this._activeSpace;f&&(f=f.camera().projection(),f.size().set(b,d),f.update());return EEventStatus.Stop},MO.FDsResourcePropertyContent_oeRefresh=
function(b){return EEventStatus.Stop},MO.FDsResourcePropertyContent_construct=function(){this.__base.FDsCanvas.construct.call(this);this._capturePosition=new SPoint2;this._captureMatrix=new SMatrix3d;this._templateMatrix=new SMatrix3d;this._templateFaceMatrix=new SMatrix3d;this._rotation=new SVector3;this._captureRotation=new SVector3;this._selectRenderables=new TObjects},MO.FDsResourcePropertyContent_innerSelectDisplay=function(b){b=b.renderables();for(var d=b.count(),f=0;f<d;f++){var h=b.getAt(f);
RClass.isClass(h,FDsSceneRenderable)&&(this._selectRenderables.push(h),h.showBoundBox())}},MO.FDsResourcePropertyContent_innerSelectLayer=function(b){b=b.displays();for(var d=b.count(),f=0;f<d;f++){var h=b.getAt(f);this.innerSelectDisplay(h)}},MO.FDsResourcePropertyContent_selectNone=function(){this._selectObject=null;for(var b=this._selectRenderables,d=b.count(),f=0;f<d;f++)b.get(f).hideBoundBox();this._selectRenderables.clear()},MO.FDsResourcePropertyContent_selectDisplay=function(b){this.selectNone();
this._selectObject=b;this.innerSelectDisplay(b)},MO.FDsResourcePropertyContent_selectMaterial=function(b){this.selectNone();this._selectObject=b;for(var d=b._display.renderables(),f=d.count(),h=0;h<f;h++){var q=d.get(h);q._materialReference==b&&(this._selectRenderables.push(q),q._optionSelected=!0,q.showBoundBox())}},MO.FDsResourcePropertyContent_selectRenderable=function(b){if(b)switch(b._renderable._resource._code){case "ms_translation_x":this._canvasMoveCd=EDsCanvasDrag.X;this._templateRenderable=
b;return;case "ms_translation_y":this._canvasMoveCd=EDsCanvasDrag.Y;this._templateRenderable=b;return;case "ms_translation_z":this._canvasMoveCd=EDsCanvasDrag.Z;this._templateRenderable=b;return;case "ms_rotation_x":this._canvasMoveCd=EDsCanvasDrag.X;this._templateRenderable=b;return;case "ms_rotation_y":this._canvasMoveCd=EDsCanvasDrag.Y;this._templateRenderable=b;return;case "ms_rotation_z":this._canvasMoveCd=EDsCanvasDrag.Z;this._templateRenderable=b;return;case "ms_scale_x":this._canvasMoveCd=
EDsCanvasDrag.X;this._templateRenderable=b;return;case "ms_scale_y":this._canvasMoveCd=EDsCanvasDrag.Y;this._templateRenderable=b;return;case "ms_scale_z":this._canvasMoveCd=EDsCanvasDrag.Z;this._templateRenderable=b;return;case "ms_scale_all":this._canvasMoveCd=EDsCanvasDrag.All;this._templateRenderable=b;return;default:this._canvasMoveCd=EDsCanvasDrag.Unknown,this._templateRenderable=null}this.selectNone();b&&(this._selectRenderables.push(b),b._optionSelected=!0,b.showBoundBox(),this._workspace._catalog.showObject(b));
var d=this._templateTranslation,f=this._templateRotation,h=this._templateScale;switch(this._canvasModeCd){case EDsCanvasMode.Translate:d.setVisible(null!=b);f.hide();h.hide();this._templateFace=d;break;case EDsCanvasMode.Rotation:d.hide();f.setVisible(null!=b);h.hide();this._templateFace=f;break;case EDsCanvasMode.Scale:d.hide(),f.hide(),h.setVisible(null!=b),this._templateFace=h}d=this._templateFace;b&&d&&(b=b.display(),d=d.matrix(),d.assign(b.matrix()),d.setScaleAll(this._templateViewScale),d.update())},
MO.FDsResourcePropertyContent_switchMode=function(b){this._canvasModeCd=b;this.selectRenderable(this._selectRenderable)},MO.FDsResourcePropertyContent_switchRotation=function(b){this._optionRotation=b},MO.FDsResourcePropertyContent_reloadRegion=function(b){b=b.resource();this._cameraMoveRate=b.moveSpeed();this._cameraKeyRotation=b.rotationKeySpeed();this._cameraMouseRotation=b.rotationMouseSpeed()},MO.FDsResourcePropertyContent_loadMeshByGuid=function(b){var d=RConsole.find(FE3dMeshConsole);null!=
this._activeSpace&&d.free(this._activeSpace);b=this._activeSpace=d.allocByGuid(this,b);b.addLoadListener(this,this.onMeshLoad);b._layer.pushRenderable(this._dimensional);RStage.register("mesh3d",b)},MO.FDsResourcePropertyContent_loadMeshByCode=function(b){var d=RConsole.find(FE3dMeshConsole);null!=this._activeSpace&&d.free(this._activeSpace);b=this._activeSpace=d.allocByCode(this,b);b.addLoadListener(this,this.onMeshLoad);b._layer.pushRenderable(this._dimensional);RStage.register("mesh3d",b)},MO.FDsResourcePropertyContent_dispose=
function(){this._rotation=RObject.dispose(this._rotation);this.__base.FDsCanvas.dispose.call(this)};
with(MO)MO.FDsResourcePropertyToolBar=function(b){b=RClass.inherits(this,b,FUiToolBar);b._frameName="resource.resource.PropertyToolBar";b._controlInsertButton=null;b._controlUpdateButton=null;b._controlDeleteButton=null;b._controlRotationButton=null;b.onBuilded=FDsResourcePropertyToolBar_onBuilded;b.onUpdateClick=FDsResourcePropertyToolBar_onUpdateClick;b.onRotationClick=FDsResourcePropertyToolBar_onRotationClick;b.construct=FDsResourcePropertyToolBar_construct;b.dispose=FDsResourcePropertyToolBar_dispose;
return b},MO.FDsResourcePropertyToolBar_onBuilded=function(b){this.__base.FUiToolBar.onBuilded.call(this,b);this._controlUpdateButton.addClickListener(this,this.onUpdateClick);this._controlRotationButton.addClickListener(this,this.onRotationClick)},MO.FDsResourcePropertyToolBar_onUpdateClick=function(b){},MO.FDsResourcePropertyToolBar_onRotationClick=function(b){this._workspace._previewContent.switchRotation(b.checked)},MO.FDsResourcePropertyToolBar_construct=function(){this.__base.FUiToolBar.construct.call(this)},
MO.FDsResourcePropertyToolBar_dispose=function(){this.__base.FUiToolBar.dispose.call(this)};
with(MO)MO.FDsResourceSelectCatalogToolBar=function(b){b=RClass.inherits(this,b,FUiToolBar);b._frameName="resource.resource.SelectCatalogToolBar";b._controlFolderOpen=null;b._controlFolderClose=null;b._activeNodeGuid=null;b.onBuilded=FDsResourceSelectCatalogToolBar_onBuilded;b.onFolderOpenClick=FDsResourceSelectCatalogToolBar_onFolderOpenClick;b.onFolderCloseClick=FDsResourceSelectCatalogToolBar_onFolderCloseClick;b.construct=FDsResourceSelectCatalogToolBar_construct;b.dispose=FDsResourceSelectCatalogToolBar_dispose;
return b},MO.FDsResourceSelectCatalogToolBar_onBuilded=function(b){this.__base.FUiToolBar.onBuilded.call(this,b);this._controlFolderOpen.addClickListener(this,this.onFolderOpenClick);this._controlFolderClose.addClickListener(this,this.onFolderCloseClick)},MO.FDsResourceSelectCatalogToolBar_onFolderOpenClick=function(b){},MO.FDsResourceSelectCatalogToolBar_onFolderCloseClick=function(b){},MO.FDsResourceSelectCatalogToolBar_construct=function(){this.__base.FUiToolBar.construct.call(this)},MO.FDsResourceSelectCatalogToolBar_dispose=
function(){this.__base.FUiToolBar.dispose.call(this)};
with(MO)MO.FDsResourceSelectDialog=function(b){b=RClass.inherits(this,b,FUiDialog);b._frameName="resource.resource.SelectDialog";b._styleToolbarGround=RClass.register(b,new AStyle("_styleToolbarGround","Toolbar_Ground"));b._styleCatalogContent=RClass.register(b,new AStyle("_styleCatalogContent","Catalog_Content"));b._styleListContent=RClass.register(b,new AStyle("_styleListContent","List_Content"));b._dataModeCd=null;b._controlParentLabel=null;b._controlLabel=null;b._controlConfirmButton=null;b._controlCancelButton=
null;b.onBuilded=FDsResourceSelectDialog_onBuilded;b.onConfirmLoad=FDsResourceSelectDialog_onConfirmLoad;b.onConfirmClick=FDsResourceSelectDialog_onConfirmClick;b.onCancelClick=FDsResourceSelectDialog_onCancelClick;b.construct=FDsResourceSelectDialog_construct;b.setNodeParentLabel=FDsResourceSelectDialog_setNodeParentLabel;b.setNodeLabel=FDsResourceSelectDialog_setNodeLabel;b.switchDataMode=FDsResourceSelectDialog_switchDataMode;b.dispose=FDsResourceSelectDialog_dispose;return b},MO.FDsResourceSelectDialog_onBuilded=
function(b){this.__base.FUiDialog.onBuilded.call(this,b);this._controlConfirm.addClickListener(this,this.onConfirmClick);this._controlCancel.addClickListener(this,this.onCancelClick);this._frameCatalogToolBar._hPanel.className=this.styleName("Toolbar_Ground");this._frameCatalogContent._hPanel.className=this.styleName("Catalog_Content");this._frameListToolBar._hPanel.className=this.styleName("Toolbar_Ground");this._frameListContent._hPanel.className=this.styleName("List_Content");var d=this._catalogSplitter=
this.searchControl("catalogSpliter");d.setAlignCd(EUiAlign.Left);d.setSizeHtml(this._frameCatalog._hPanel);d=this._catalogToolbar=RClass.create(FDsResourceSelectCatalogToolBar);d._workspace=this._workspace;d._frameSet=this;d.buildDefine(b);this._frameCatalogToolBar.push(d);d=this._catalogContent=RClass.create(FDsResourceCatalogContent);d._workspace=this._workspace;d._frameSet=this;d.build(b);this._frameCatalogContent.push(d);d=this._listToolBar=RClass.create(FDsResourceSelectListToolBar);d._workspace=
this._workspace;d._frameSet=this;d.buildDefine(b);this._frameListToolBar.push(d);d=this._listContent=RClass.create(FDsResourceListContent);d._workspace=this._workspace;d._frameSet=this;d.build(b);this._frameListContent.push(d);this._listContent.serviceSearch()},MO.FDsResourceSelectDialog_onConfirmLoad=function(b){RConsole.find(FUiDesktopConsole).hide();this.hide();b=this._frameSet._catalogContent;if(this._dataModeCd==EUiDataMode.Insert)if(this._parentGuid){var d=b.findByGuid(this._parentGuid);b.loadNode(d)}else b.loadService();
else{var f=this._controlLabel.get(),d=b.focusNode();d.setLabel(f)}},MO.FDsResourceSelectDialog_onConfirmClick=function(b){RConsole.find(FUiDesktopConsole).showUploading();b=this._controlLabel.get();var d=RConsole.find(FDrResourceConsole),f=null,f=this._dataModeCd==EUiDataMode.Insert?d.doFolderCreate(this._parentGuid,null,b):d.doFolderUpdate(this._nodeGuid,null,b);f.addLoadListener(this,this.onConfirmLoad)},MO.FDsResourceSelectDialog_onCancelClick=function(b){this.hide()},MO.FDsResourceSelectDialog_construct=
function(){this.__base.FUiDialog.construct.call(this)},MO.FDsResourceSelectDialog_setNodeParentLabel=function(b){this._controlParentLabel.set(b)},MO.FDsResourceSelectDialog_setNodeLabel=function(b){this._controlLabel.set(b)},MO.FDsResourceSelectDialog_switchDataMode=function(b){this._dataModeCd=b;b==EUiDataMode.Insert?this.setLabel("\u65b0\u5efa\u8d44\u6e90\u76ee\u5f55"):b==EUiDataMode.Update&&this.setLabel("\u8d44\u6e90\u76ee\u5f55\u5c5e\u6027")},MO.FDsResourceSelectDialog_dispose=function(){this.__base.FUiDialog.dispose.call(this)};
with(MO)MO.FDsResourceSelectListToolBar=function(b){b=RClass.inherits(this,b,FUiToolBar,MUiStorage);b._frameName="resource.resource.SelectListToolBar";b._storageCode=b._frameName;b._dropButton=null;b._selectButton=null;b._translateButton=null;b._rotationButton=null;b._scaleButton=null;b._lookFrontButton=null;b._lookUpButton=null;b._lookLeftButton=null;b._playButton=null;b._viewButton=null;b.onBuilded=FDsResourceSelectListToolBar_onBuilded;b.onSearchClick=FDsResourceSelectListToolBar_onSearchClick;
b.onNavigatorClick=FDsResourceSelectListToolBar_onNavigatorClick;b.onTypeClick=FDsResourceSelectListToolBar_onTypeClick;b.construct=FDsResourceSelectListToolBar_construct;b.makeTypeCd=FDsResourceSelectListToolBar_makeTypeCd;b.setNavigator=FDsResourceSelectListToolBar_setNavigator;b.doNavigator=FDsResourceSelectListToolBar_doNavigator;b.storageLoad=FDsResourceSelectListToolBar_storageLoad;b.dispose=FDsResourceSelectListToolBar_dispose;return b},MO.FDsResourceSelectListToolBar_onBuilded=function(b){this.__base.FUiToolBar.onBuilded.call(this,
b);this._controlSearchEdit.addClickListener(this,this.onSearchClick);this._controlFirstButton.addClickListener(this,this.onNavigatorClick);this._controlPriorButton.addClickListener(this,this.onNavigatorClick);this._controlNextButton.addClickListener(this,this.onNavigatorClick);this._controlLastButton.addClickListener(this,this.onNavigatorClick)},MO.FDsResourceSelectListToolBar_onSearchClick=function(b){this.doNavigator(0)},MO.FDsResourceSelectListToolBar_onNavigatorClick=function(b){b=b.sender.name();
var d=this._contentPage;switch(b){case "firstButton":d=0;break;case "priorButton":d--;break;case "nextButton":d++;break;case "lastButton":d=this._contentPageCount-1}this.doNavigator(d)},MO.FDsResourceSelectListToolBar_onTypeClick=function(b){switch(b.sender.name()){case "typeAll":this._controlTypeBitmap.check(!0);this._controlTypeMaterial.check(!0);this._controlTypeModel.check(!0);this._controlTypeTemplate.check(!0);break;case "typeNone":this._controlTypeBitmap.check(!1),this._controlTypeMaterial.check(!1),
this._controlTypeModel.check(!1),this._controlTypeTemplate.check(!1)}b=this.makeTypeCd();var d=this._controlSearchEdit.text();this._frameSet._listContent.serviceSearch(b,d,"",this._contentPageSize,0);this.storageSet("resource_type_cd",b);this.storageSet("control_type_bitmap:check",RBoolean.toString(this._controlTypeBitmap.isCheck()));this.storageSet("control_type_material:check",RBoolean.toString(this._controlTypeMaterial.isCheck()));this.storageSet("control_type_model:check",RBoolean.toString(this._controlTypeModel.isCheck()));
this.storageSet("control_type_template:check",RBoolean.toString(this._controlTypeTemplate.isCheck()));this.storageSet("control_type_scene:check",RBoolean.toString(this._controlTypeScene.isCheck()));this.storageUpdate()},MO.FDsResourceSelectListToolBar_construct=function(){this.__base.FUiToolBar.construct.call(this)},MO.FDsResourceSelectListToolBar_makeTypeCd=function(){var b="";this._controlTypeBitmap.isCheck()&&(b+="|Bitmap");this._controlTypeMaterial.isCheck()&&(b+="|Material");this._controlTypeModel.isCheck()&&
(b+="|Model");this._controlTypeTemplate.isCheck()&&(b+="|Template");this._controlTypeScene.isCheck()&&(b+="|Scene");""!=b&&(b=b.substring(1));RString.isEmpty(b);return"All"},MO.FDsResourceSelectListToolBar_setNavigator=function(b,d,f){this._contentPageSize=b;this._contentPageCount=d;this._contentPage=f;this._controlPageEdit.setText(f)},MO.FDsResourceSelectListToolBar_doNavigator=function(b){var d=this.makeTypeCd(),f=this._controlSearchEdit.text();b=RInteger.toRange(b,0,this._contentPageCount);this._contentTypeCd==
d&&this._contentSerach==f&&this._contentPage==b||this._frameSet._listContent.serviceSearch(d,f,"",this._contentPageSize,b);this._contentTypeCd=d;this._contentSerach=f},MO.FDsResourceSelectListToolBar_storageLoad=function(){this._controlTypeBitmap.check(this.storageGetBoolean("control_type_bitmap:check",!0));this._controlTypeMaterial.check(this.storageGetBoolean("control_type_material:check",!0));this._controlTypeModel.check(this.storageGetBoolean("control_type_model:check",!0));this._controlTypeTemplate.check(this.storageGetBoolean("control_type_template:check",
!0));this._controlTypeScene.check(this.storageGetBoolean("control_type_scene:check",!0));this.makeTypeCd();var b=this.storageGet("resource_type_cd","All"),d=this._controlSearchEdit.text();this._frameSet._listContent.serviceSearch(b,d,"",this._contentPageSize,0)},MO.FDsResourceSelectListToolBar_dispose=function(){this.__base.FUiToolBar.dispose.call(this)};
with(MO)MO.FDsResourceTabBar=function(b){b=RClass.inherits(this,b,FUiTabBar);b._frameName="design3d.resource.TabBar";b._resourceTypeCd="mesh";b._controlPictureButton=null;b._controlSoundButton=null;b._controlVidioButton=null;b._controlTextureButton=null;b._controlMaterialButton=null;b._controlMeshButton=null;b._controlModelButton=null;b._controlTemplateButton=null;b._controlSceneButton=null;b.onBuilded=FDsResourceTabBar_onBuilded;b.onButtonClick=FDsResourceTabBar_onButtonClick;b.construct=FDsResourceTabBar_construct;
b.dispose=FDsResourceTabBar_dispose;return b},MO.FDsResourceTabBar_onBuilded=function(b){this.__base.FUiTabBar.onBuilded.call(this,b);this._controlPictureButton.addClickListener(this,this.onButtonClick);this._controlSoundButton.addClickListener(this,this.onButtonClick);this._controlVidioButton.addClickListener(this,this.onButtonClick);this._controlTextureButton.addClickListener(this,this.onButtonClick);this._controlMaterialButton.addClickListener(this,this.onButtonClick);this._controlMeshButton.addClickListener(this,
this.onButtonClick);this._controlModelButton.addClickListener(this,this.onButtonClick);this._controlTemplateButton.addClickListener(this,this.onButtonClick);this._controlSceneButton.addClickListener(this,this.onButtonClick)},MO.FDsResourceTabBar_onButtonClick=function(b){this._resourceTypeCd=b.sender.name()},MO.FDsResourceTabBar_construct=function(){this.__base.FUiTabBar.construct.call(this)},MO.FDsResourceTabBar_dispose=function(){this.__base.FUiTabBar.dispose.call(this)};
with(MO)MO.FDsResourceWorkspace=function(b){b=RClass.inherits(this,b,FDuiWorkspace);b._frameName="resource.resource.Workspace";b._styleToolbarGround=RClass.register(b,new AStyle("_styleToolbarGround","Toolbar_Ground"));b._styleStatusbarGround=RClass.register(b,new AStyle("_styleStatusbarGround","Statusbar_Ground"));b._styleCatalogGround=RClass.register(b,new AStyle("_styleCatalogGround","Catalog_Ground"));b._styleCatalogToolbar=RClass.register(b,new AStyle("_styleCatalogToolbar","Catalog_Toolbar"));
b._styleSearchGround=RClass.register(b,new AStyle("_styleSearchGround","Search_Ground"));b._styleSearchToolbar=RClass.register(b,new AStyle("_styleCatalogToolbar","Search_Toolbar"));b._stylePreviewGround=RClass.register(b,new AStyle("_stylePreviewGround","Preview_Ground"));b._stylePreviewToolbar=RClass.register(b,new AStyle("_stylePreviewToolbar","Preview_Toolbar"));b._stylePropertyGround=RClass.register(b,new AStyle("_stylePropertyGround","Property_Ground"));b._styleWorkspaceGround=RClass.register(b,
new AStyle("_styleWorkspaceGround","Workspace_Ground"));b._resourceTypeCd="picture";b._frameToolBar=null;b._frameStatusBar=null;b._frameCatalog=null;b._frameCatalogToolbar=null;b._frameCatalogContent=null;b._frameSearch=null;b._frameSearchToolbar=null;b._frameSearchContent=null;b._framePreview=null;b._framePreviewToolbar=null;b._framePreviewContent=null;b._propertyFrames=null;b.onBuilded=FDsResourceWorkspace_onBuilded;b.onMeshLoad=FDsResourceWorkspace_onMeshLoad;b.onCatalogSelected=FDsResourceWorkspace_onCatalogSelected;
b.construct=FDsResourceWorkspace_construct;b.findPropertyFrame=FDsResourceWorkspace_findPropertyFrame;b.switchContent=FDsResourceWorkspace_switchContent;b.load=FDsResourceWorkspace_load;b.dispose=FDsResourceWorkspace_dispose;return b},MO.FDsResourceWorkspace_onBuilded=function(b){this.__base.FDuiWorkspace.onBuilded.call(this,b);var d=this._frameToolBar=this.searchControl("toolbarFrame");d._hPanel.className=this.styleName("Toolbar_Ground");d=this._frameBody=this.searchControl("bodyFrame");d._hPanel.className=
this.styleName("Catalog_Ground");d=this._frameStatusBar=this.searchControl("statusFrame");d._hPanel.className=this.styleName("Statusbar_Ground");d=RBuilder.createTable(b);d.width="100%";var f=RBuilder.appendTableRow(d),h=this._toolbar=RClass.create(FDsResourceMenuBar);h._workspace=this;h.buildDefine(b);var q=RBuilder.appendTableCell(f);q.appendChild(h._hPanel);h=this._tabBar=RClass.create(FDsResourceTabBar);h._workspace=this;h.buildDefine(b);q=RBuilder.appendTableCell(f);q.width="450px";q.align="right";
q.vAlign="bottom";q.appendChild(h._hPanel);this._frameToolBar._hPanel.appendChild(d);d=this._frameSet=RClass.create(FDsResourceFrameSet);d._workspace=this;d.buildDefine(b);this._frameBody.push(d);d.switchContent(this._resourceTypeCd)},MO.FDsResourceWorkspace_onMeshLoad=function(b){this._activeSpace=b._activeSpace;this._catalog.buildSpace(this._activeSpace)},MO.FDsResourceWorkspace_onCatalogSelected=function(b,d){for(var f=this._activeSpace,h=this._propertyFrames,q=h.count(),w=0;w<q;w++){var z=h.value(w);
z.hide()}if(RClass.isClass(b,FE3dStage))z=this.findPropertyFrame(EDsFrame.MeshSpacePropertyFrame),z.show(),z.loadObject(f,f);else if(RClass.isClass(b,FG3dTechnique))z=this.findPropertyFrame(EDsFrame.MeshTechniquePropertyFrame),z.show(),z.loadObject(f,b);else if(RClass.isClass(b,FE3dRegion))z=this.findPropertyFrame(EDsFrame.MeshRegionPropertyFrame),z.show(),z.loadObject(f,b);else if(RClass.isClass(b,FE3dCamera))z=this.findPropertyFrame(EDsFrame.MeshCameraPropertyFrame),z.show(),z.loadObject(f,b);else if(RClass.isClass(b,
FG3dDirectionalLight))z=this.findPropertyFrame(EDsFrame.MeshLightPropertyFrame),z.show(),z.loadObject(f,b);else if(RClass.isClass(b,FE3dMeshDisplay))z=this.findPropertyFrame(EDsFrame.MeshDisplayPropertyFrame),z.show(),z.loadObject(f,b);else if(RClass.isClass(b,FG3dMaterial))z=this.findPropertyFrame(EDsFrame.MeshMaterialPropertyFrame),z.show(),z.loadObject(f,b);else if(RClass.isClass(b,FE3dMeshRenderable))z=this.findPropertyFrame(EDsFrame.MeshRenderablePropertyFrame),z.show(),z.loadObject(f,b);else throw new TError("Unknown select object type. (value={1})",
b);},MO.FDsResourceWorkspace_construct=function(){this.__base.FDuiWorkspace.construct.call(this);this._propertyFrames=new TDictionary},MO.FDsResourceWorkspace_findPropertyFrame=function(b){var d=this._propertyFrames.get(b);d||(d=RConsole.find(FFrameConsole).get(this,b,this._framePreview._hContainer),d._workspace=this,this._propertyFrames.set(b,d));return d},MO.FDsResourceWorkspace_switchContent=function(b){this._frameSet.switchContent(b)},MO.FDsResourceWorkspace_load=function(){},MO.FDsResourceWorkspace_dispose=
function(){this.__base.FDuiWorkspace.dispose.call(this);this._propertyFrames.dispose();this._propertyFrames=null};with(MO)MO.FDsBitmapCanvasContent=function(b){return b=RClass.inherits(this,b,FDsBitmapCanvas)};
with(MO)MO.FDsBitmapCanvasToolBar=function(b){b=RClass.inherits(this,b,FUiToolBar);b._canvasModeCd=EDsCanvasMode.Drop;b._controlSize1=null;b._controlSize2=null;b._controlSize3=null;b._controlSize4=null;b._controlSizeWidth=null;b._controlSizeHeight=null;b.onBuilded=FDsBitmapCanvasToolBar_onBuilded;b.onSizeClick=FDsBitmapCanvasToolBar_onSizeClick;b.construct=FDsBitmapCanvasToolBar_construct;b.dispose=FDsBitmapCanvasToolBar_dispose;return b},MO.FDsBitmapCanvasToolBar_onBuilded=function(b){this.__base.FUiToolBar.onBuilded.call(this,
b)},MO.FDsBitmapCanvasToolBar_onSizeClick=function(b){var d=b.sender,f=b="*",h=d.name(),d=d.label();"sizeAuto"!=h&&(f=d.split("x"),b=parseInt(f[0]),f=parseInt(f[1]));this._controlSizeWidth.setText(b);this._controlSizeHeight.setText(f);this._frameSet._canvas.switchSize(b,f)},MO.FDsBitmapCanvasToolBar_construct=function(){this.__base.FUiToolBar.construct.call(this)},MO.FDsBitmapCanvasToolBar_dispose=function(){this.__base.FUiToolBar.dispose.call(this)};
with(MO)MO.FDsBitmapFrameSet=function(b){b=RClass.inherits(this,b,FDsFrameSet);b._frameCanvas=null;b._frameCanvasToolBar=null;b._frameCanvasContent=null;b._frameProperty=null;b._framePropertyToolBar=null;b._framePropertyContent=null;b.onBuilded=FDsBitmapFrameSet_onBuilded;b.onDataLoaded=FDsBitmapFrameSet_onDataLoaded;b.construct=FDsBitmapFrameSet_construct;b.loadByGuid=FDsBitmapFrameSet_loadByGuid;b.loadByCode=FDsBitmapFrameSet_loadByCode;b.reload=FDsBitmapFrameSet_reload;b.dispose=FDsBitmapFrameSet_dispose;
return b},MO.FDsBitmapFrameSet_onBuilded=function(b){this.__base.FDsFrameSet.onBuilded.call(this,b);this._frameCanvasToolBar._hPanel.className=this.styleName("ToolBar_Ground");this._frameCanvasContent._hPanel.className=this.styleName("Canvas_Content");this._framePropertyToolBar._hPanel.className=this.styleName("ToolBar_Ground");this._framePropertyContent._hPanel.className=this.styleName("Property_Content");b=this._spliterProperty;b.setAlignCd(EUiAlign.Right);b.setSizeHtml(this._frameProperty._hPanel)},
MO.FDsBitmapFrameSet_onDataLoaded=function(b){debugger;this._activeSpace=b._activeSpace},MO.FDsBitmapFrameSet_construct=function(){this.__base.FDsFrameSet.construct.call(this)},MO.FDsBitmapFrameSet_loadByGuid=function(b){this._activeGuid=b;var d=this._activeResource=RConsole.find(FDrBitmapConsole).query(b);this._canvasContent.loadByGuid(b);this.findPropertyFrame(EDsFrame.BitmapPropertyFrame).loadObject(d)},MO.FDsBitmapFrameSet_loadByCode=function(b){this._activeCode=b;RConsole.find(FDrBitmapConsole).query(b).addLoadListener(this,
this.onDataLoaded)},MO.FDsBitmapFrameSet_reload=function(){},MO.FDsBitmapFrameSet_dispose=function(){this.__base.FDsFrameSet.dispose.call(this)};
with(MO)MO.FDsBitmapImportDialog=function(b){b=RClass.inherits(this,b,FUiDialog);b._frameName="resource.bitmap.ImportDialog";b._nodeGuid=null;b._controlPrivateButton=null;b._controlTeamButton=null;b._controlShareButton=null;b.onBuilded=FDsBitmapImportDialog_onBuilded;b.onFileLoaded=FDsBitmapImportDialog_onFileLoaded;b.onConfirmLoad=FDsBitmapImportDialog_onConfirmLoad;b.onConfirmClick=FDsBitmapImportDialog_onConfirmClick;b.onCancelClick=FDsBitmapImportDialog_onCancelClick;b.construct=FDsBitmapImportDialog_construct;
b.dispose=FDsBitmapImportDialog_dispose;return b},MO.FDsBitmapImportDialog_onBuilded=function(b){this.__base.FUiDialog.onBuilded.call(this,b);this._controlConfirmButton.addClickListener(this,this.onConfirmClick);this._controlCancelButton.addClickListener(this,this.onCancelClick)},MO.FDsBitmapImportDialog_onFileLoaded=function(b){b=this._fileReader;var d="/cloud.resource.bitmap.wv?do=updateData&guid="+this._resource.guid()+"&data_length="+b.length()+"&file_name="+b.fileName(),d=RBrowser.urlEncode(d);
RConsole.find(FHttpConsole).send(d,b.data()).addLoadListener(this,this.onConfirmLoad);this._fileReader=RObject.dispose(b)},MO.FDsBitmapImportDialog_onConfirmLoad=function(b){RConsole.find(FUiDesktopConsole).hide();this.hide();this._frameSet.reload()},MO.FDsBitmapImportDialog_onConfirmClick=function(b){RConsole.find(FUiDesktopConsole).showUploading();b=this._controlFile._hInput.files[0];var d=this._fileReader=RClass.create(FFileReader);d.addLoadListener(this,this.onFileLoaded);d.loadFile(b)},MO.FDsBitmapImportDialog_onCancelClick=
function(b){this.hide()},MO.FDsBitmapImportDialog_construct=function(){this.__base.FUiDialog.construct.call(this)},MO.FDsBitmapImportDialog_dispose=function(){this.__base.FUiDialog.dispose.call(this)};
with(MO)MO.FDsBitmapMenuBar=function(b){b=RClass.inherits(this,b,FUiMenuBar);b._controlBack=null;b._controlSave=null;b._controlCapture=null;b.onBuilded=FDsBitmapMenuBar_onBuilded;b.onSaveLoad=FDsBitmapMenuBar_onSaveLoad;b.onSaveClick=FDsBitmapMenuBar_onSaveClick;b.onImportClick=FDsBitmapMenuBar_onImportClick;b.construct=FDsBitmapMenuBar_construct;b.dispose=FDsBitmapMenuBar_dispose;return b},MO.FDsBitmapMenuBar_onBuilded=function(b){this.__base.FUiMenuBar.onBuilded.call(this,b)},MO.FDsBitmapMenuBar_onSaveLoad=
function(b){RConsole.find(FUiDesktopConsole).hide()},MO.FDsBitmapMenuBar_onSaveClick=function(b){b=this._frameSet._activeResource;RConsole.find(FUiDesktopConsole).showUploading();RConsole.find(FDrBitmapConsole).doUpdate(b).addLoadListener(this,this.onSaveLoad)},MO.FDsBitmapMenuBar_onImportClick=function(b){b=this._frameSet._activeResource;var d=RConsole.find(FUiWindowConsole).find(FDsBitmapImportDialog);d._resource=b;d._frameSet=this._frameSet;d.showPosition(EUiPosition.Center)},MO.FDsBitmapMenuBar_construct=
function(){this.__base.FUiMenuBar.construct.call(this)},MO.FDsBitmapMenuBar_dispose=function(){this.__base.FUiMenuBar.dispose.call(this)};
with(MO)MO.FDsBitmapPropertyFrame=function(b){b=RClass.inherits(this,b,FUiForm);b._activeBitmap=null;b._controlGuid=null;b._controlCode=null;b._controlLabel=null;b._controlSizeWidth=null;b._controlSizeHeight=null;b.onBuilded=FDsBitmapPropertyFrame_onBuilded;b.onDataChanged=FDsBitmapPropertyFrame_onDataChanged;b.construct=FDsBitmapPropertyFrame_construct;b.loadObject=FDsBitmapPropertyFrame_loadObject;b.dispose=FDsBitmapPropertyFrame_dispose;return b},MO.FDsBitmapPropertyFrame_construct=function(){this.__base.FUiForm.construct.call(this)},
MO.FDsBitmapPropertyFrame_onBuilded=function(b){this.__base.FUiForm.onBuilded.call(this,b);this._controlCode.addDataChangedListener(this,this.onDataChanged);this._controlLabel.addDataChangedListener(this,this.onDataChanged)},MO.FDsBitmapPropertyFrame_onDataChanged=function(b){b=this._activeBitmap;b.setCode(this._controlCode.get());b.setLabel(this._controlLabel.get())},MO.FDsBitmapPropertyFrame_loadObject=function(b){this._activeBitmap=b;this._controlGuid.set(b.guid());this._controlCode.set(b.code());
this._controlLabel.set(b.label());this._controlSizeWidth.set(b.sizeWidth());this._controlSizeHeight.set(b.sizeHeight())},MO.FDsBitmapPropertyFrame_dispose=function(){this.__base.FUiForm.dispose.call(this)};
with(MO)MO.FDsBitmapPropertyToolBar=function(b){b=RClass.inherits(this,b,FUiToolBar);b._frameName="resource.bitmap.PropertyToolBar";b._controlRefresh=null;b.onBuilded=FDsBitmapPropertyToolBar_onBuilded;b.onRefreshClick=FDsBitmapPropertyToolBar_onRefreshClick;b.construct=FDsBitmapPropertyToolBar_construct;b.dispose=FDsBitmapPropertyToolBar_dispose;return b},MO.FDsBitmapPropertyToolBar_onBuilded=function(b){this.__base.FUiToolBar.onBuilded.call(this,b);this._controlRefresh.addClickListener(this,this.onRefreshClick)},
MO.FDsBitmapPropertyToolBar_onRefreshClick=function(b){},MO.FDsBitmapPropertyToolBar_construct=function(){this.__base.FUiToolBar.construct.call(this)},MO.FDsBitmapPropertyToolBar_dispose=function(){this.__base.FUiToolBar.dispose.call(this)};
with(MO)MO.FDsBitmapWorkspace=function(b){b=RClass.inherits(this,b,FDuiWorkspace);b._frameName="design2d.bitmap.Workspace";b._styleWorkspaceGround=RClass.register(b,new AStyle("_styleWorkspaceGround","Workspace_Ground"));b._styleToolbarGround=RClass.register(b,new AStyle("_styleToolbarGround","Toolbar_Ground"));b._styleBodyGround=RClass.register(b,new AStyle("_styleBodyGround","Body_Ground"));b._styleStatusbarGround=RClass.register(b,new AStyle("_styleStatusbarGround","Statusbar_Ground"));b._activeSpace=
null;b._activeMesh=null;b._framesetMain=null;b._framesetBody=null;b._frameToolBar=null;b._frameBody=null;b._frameProperty=null;b._frameSet=null;b._propertyFrames=null;b.onBuilded=FDsBitmapWorkspace_onBuilded;b.onMeshLoad=FDsBitmapWorkspace_onMeshLoad;b.onCatalogSelected=FDsBitmapWorkspace_onCatalogSelected;b.construct=FDsBitmapWorkspace_construct;b.findPropertyFrame=FDsBitmapWorkspace_findPropertyFrame;b.loadByGuid=FDsBitmapWorkspace_loadByGuid;b.loadByCode=FDsBitmapWorkspace_loadByCode;b.dispose=
FDsBitmapWorkspace_dispose;return b},MO.FDsBitmapWorkspace_onBuilded=function(b){this.__base.FDuiWorkspace.onBuilded.call(this,b);var d=this._frameToolBar=this.searchControl("toolbarFrame");d._hPanel.className=this.styleName("Toolbar_Ground");d=this._frameBody=this.searchControl("bodyFrame");d._hPanel.className=this.styleName("Body_Ground");d=this._frameStatusBar=this.searchControl("statusFrame");d._hPanel.className=this.styleName("Statusbar_Ground");d=this._menuBar=RClass.create(FDsBitmapMenuBar);
d._workspace=this;d.buildDefine(b);this._frameToolBar.push(d);var f=this._frameSet=RClass.create(FDsBitmapFrameSet);f._workspace=this;f.buildDefine(b);this._frameBody.push(f);d._frameSet=f},MO.FDsBitmapWorkspace_onMeshLoad=function(b){this._activeSpace=b._activeSpace;this._catalog.buildSpace(this._activeSpace)},MO.FDsBitmapWorkspace_onCatalogSelected=function(b,d){for(var f=this._activeSpace,h=this._propertyFrames,q=h.count(),w=0;w<q;w++){var z=h.value(w);z.hide()}if(RClass.isClass(b,FE3dStage))z=
this.findPropertyFrame(EDsFrame.MeshSpacePropertyFrame),z.show(),z.loadObject(f,f);else if(RClass.isClass(b,FG3dTechnique))z=this.findPropertyFrame(EDsFrame.MeshTechniquePropertyFrame),z.show(),z.loadObject(f,b);else if(RClass.isClass(b,FE3dRegion))z=this.findPropertyFrame(EDsFrame.MeshRegionPropertyFrame),z.show(),z.loadObject(f,b);else if(RClass.isClass(b,FE3dCamera))z=this.findPropertyFrame(EDsFrame.MeshCameraPropertyFrame),z.show(),z.loadObject(f,b);else if(RClass.isClass(b,FG3dDirectionalLight))z=
this.findPropertyFrame(EDsFrame.MeshLightPropertyFrame),z.show(),z.loadObject(f,b);else if(RClass.isClass(b,FE3dMeshDisplay))z=this.findPropertyFrame(EDsFrame.MeshDisplayPropertyFrame),z.show(),z.loadObject(f,b);else if(RClass.isClass(b,FG3dMaterial))z=this.findPropertyFrame(EDsFrame.MeshMaterialPropertyFrame),z.show(),z.loadObject(f,b);else if(RClass.isClass(b,FE3dMeshRenderable))z=this.findPropertyFrame(EDsFrame.MeshRenderablePropertyFrame),z.show(),z.loadObject(f,b);else throw new TError("Unknown select object type. (value={1})",
b);},MO.FDsBitmapWorkspace_construct=function(){this.__base.FDuiWorkspace.construct.call(this);this._propertyFrames=new TDictionary},MO.FDsBitmapWorkspace_findPropertyFrame=function(b){var d=this._propertyFrames.get(b);d||(d=RConsole.find(FFrameConsole).get(this,b,this._frameProperty._hContainer),d._workspace=this,this._propertyFrames.set(b,d));return d},MO.FDsBitmapWorkspace_loadByGuid=function(b){this._frameSet.loadByGuid(b)},MO.FDsBitmapWorkspace_loadByCode=function(b){this._frameSet.loadByCode(b)},
MO.FDsBitmapWorkspace_dispose=function(){this.__base.FDuiWorkspace.dispose.call(this);this._propertyFrames.dispose();this._propertyFrames=null};with(MO)MO.FDsMaterialCanvasBitmap=function(b){return b=RClass.inherits(this,b,FDsBitmapCanvas)};
with(MO)MO.FDsMaterialCanvasContent=function(b){b=RClass.inherits(this,b,FDsCanvas);b._activeResource=null;b._activeMaterial=null;b._capturePosition=null;b._captureCameraPosition=null;b._templateMatrix=null;b._templateRenderable=null;b._templateFace=null;b._templateTranslation=null;b._templateRotation=null;b._templateScale=null;b._templateViewScale=.05;b.onBuild=FDsMaterialCanvasContent_onBuild;b.onLoaded=FDsMaterialCanvasContent_onLoaded;b.oeResize=FDsMaterialCanvasContent_oeResize;b.oeRefresh=FDsMaterialCanvasContent_oeRefresh;
b.construct=FDsMaterialCanvasContent_construct;b.reloadRegion=FDsMaterialCanvasContent_reloadRegion;b.loadByGuid=FDsMaterialCanvasContent_loadByGuid;b.dispose=FDsMaterialCanvasContent_dispose;return b},MO.FDsMaterialCanvasContent_onBuild=function(b){this.__base.FDsCanvas.onBuild.call(this,b);b=this._hPanel;var d=this._activeSpace=RClass.create(FE3dSimpleStage);d.linkGraphicContext(this);d.selectTechnique(this,FE3dGeneralTechnique);d.region().backgroundColor().set(1,1,1,1);d.region().linkGraphicContext(this);
RStage.register("space.material",d);d=d.camera();d.setPosition(0,0,-10);d.lookAt(0,0,0);d.update();d=d.projection();d.size().set(b.width,b.height);d._angle=45;d.update()},MO.FDsMaterialCanvasContent_onLoaded=function(b){this._activeMaterial=this._activeResource.material();RConsole.find(FUiDesktopConsole).hide()},MO.FDsMaterialCanvasContent_oeResize=function(b){this.__base.FDsCanvas.oeResize.call(this,b);var d=this._hPanel;b=d.offsetWidth;var d=d.offsetHeight,f=this._activeSpace;f&&(f=f.camera().projection(),
f.size().set(b,d),f.update());return EEventStatus.Stop},MO.FDsMaterialCanvasContent_oeRefresh=function(b){return EEventStatus.Stop},MO.FDsMaterialCanvasContent_construct=function(){this.__base.FDsCanvas.construct.call(this);this._capturePosition=new SPoint2;this._captureCameraPosition=new SPoint3},MO.FDsMaterialCanvasContent_selectDisplay=function(b){this.selectNone();this._selectObject=b;this.innerSelectDisplay(b)},MO.FDsMaterialCanvasContent_switchMode=function(b){this._canvasModeCd=b},MO.FDsMaterialCanvasContent_reloadRegion=
function(b){b=b.resource();this._cameraMoveRate=b.moveSpeed();this._cameraKeyRotation=b.rotationKeySpeed();this._cameraMouseMove=b.rotationMouseSpeed()},MO.FDsMaterialCanvasContent_loadByGuid=function(b){RConsole.find(FUiDesktopConsole).showLoading();b=this._activeResource=RConsole.find(FE3sMaterialConsole).loadByGuid(b);b.clearLoadListeners();b.addLoadListener(this,this.onLoaded)},MO.FDsMaterialCanvasContent_dispose=function(){this.__base.FDsCanvas.dispose.call(this)};
with(MO)MO.FDsMaterialCanvasToolBar=function(b){b=RClass.inherits(this,b,FUiToolBar);b._controlSize1=null;b._controlSize2=null;b._controlSize3=null;b._controlSize4=null;b._controlSizeWidth=null;b._controlSizeHeight=null;b.onBuilded=FDsMaterialCanvasToolBar_onBuilded;b.onSizeClick=FDsMaterialCanvasToolBar_onSizeClick;b.construct=FDsMaterialCanvasToolBar_construct;b.dispose=FDsMaterialCanvasToolBar_dispose;return b},MO.FDsMaterialCanvasToolBar_onBuilded=function(b){this.__base.FUiToolBar.onBuilded.call(this,
b);this._controlSize1.addClickListener(this,this.onSizeClick);this._controlSize2.addClickListener(this,this.onSizeClick);this._controlSize3.addClickListener(this,this.onSizeClick);this._controlSize4.addClickListener(this,this.onSizeClick);this._controlSizeWidth.setText("*");this._controlSizeHeight.setText("*")},MO.FDsMaterialCanvasToolBar_onModeClick=function(b){},MO.FDsMaterialCanvasToolBar_onSizeClick=function(b){var d=b.sender,f=b="*",h=d.name(),d=d.label();"sizeAuto"!=h&&(f=d.split("x"),b=parseInt(f[0]),
f=parseInt(f[1]));this._controlSizeWidth.setText(b);this._controlSizeHeight.setText(f)},MO.FDsMaterialCanvasToolBar_construct=function(){this.__base.FUiToolBar.construct.call(this)},MO.FDsMaterialCanvasToolBar_dispose=function(){this.__base.FUiToolBar.dispose.call(this)};
with(MO)MO.FDsMaterialCatalogContent=function(b){b=RClass.inherits(this,b,FUiListView);b._activeItem=null;b._activeGuid=null;b._refreshButton=null;b._saveButton=null;b._runButton=null;b.onBuilded=FDsMaterialCatalogContent_onBuilded;b.onServiceLoad=FDsMaterialCatalogContent_onServiceLoad;b.construct=FDsMaterialCatalogContent_construct;b.doClickItem=FDsMaterialCatalogContent_doClickItem;b.doDoubleClickItem=FDsMaterialCatalogContent_doDoubleClickItem;b.serviceList=FDsMaterialCatalogContent_serviceList;
b.dispose=FDsMaterialCatalogContent_dispose;return b},MO.FDsMaterialCatalogContent_onBuilded=function(b){this.__base.FUiListView.onBuilded.call(this,b)},MO.FDsMaterialCatalogContent_onServiceLoad=function(b){b=b.root.findNode("BitmapCollection");this.clear();b=b.nodes();for(var d=b.count(),f=0;f<d;f++){var h=b.getAt(f);if(h.isName("Bitmap")){var q=h.get("code"),w=this.createItem(FDsMaterialCatalogItem);w.propertyLoad(h);w._guid=h.get("guid");w._linkGuid=h.get("link_guid");w._code=q;w._updateDate=
h.get("update_date");w.setTypeLabel(q);w.setLabel(RString.nvl(h.get("label"),h.get("code")));w.refreshStyle();this.push(w)}}RConsole.find(FUiDesktopConsole).hide()},MO.FDsMaterialCatalogContent_construct=function(){this.__base.FUiListView.construct.call(this)},MO.FDsMaterialCatalogContent_doClickItem=function(b){this.__base.FUiListView.doClickItem.call(this,b)},MO.FDsMaterialCatalogContent_doDoubleClickItem=function(b){this.__base.FUiListView.doDoubleClickItem.call(this,b);var d=b._guid;this._activeItem=
b;this._activeGuid=d;this._frameSet.switchCanvas("Bitmap",d)},MO.FDsMaterialCatalogContent_serviceList=function(b){RConsole.find(FUiDesktopConsole).showLoading();b="/cloud.resource.material.ws?action=listBitmap&guid="+b;RConsole.find(FXmlConsole).sendAsync(b).addLoadListener(this,this.onServiceLoad)},MO.FDsMaterialCatalogContent_dispose=function(){this.__base.FUiListView.dispose.call(this)};
with(MO)MO.FDsMaterialCatalogItem=function(b){b=RClass.inherits(this,b,FUiListViewItem);b._styleTypePanel=RClass.register(b,new AStyle("_styleTypePanel"));b._styleTypeLabel=RClass.register(b,new AStyle("_styleTypeLabel"));b.onBuild=FDsMaterialCatalogItem_onBuild;b.setTypeLabel=FDsMaterialCatalogItem_setTypeLabel;b.refreshStyle=FDsMaterialCatalogItem_refreshStyle;return b},MO.FDsMaterialCatalogItem_onBuild=function(b){this.__base.FUiListViewItem.onBuild.call(this,b);b=this._hPanel;b.style.width="200px";
b.style.height="150px";this._hLine1.className=this.styleName("TypePanel");this._hLine1.vAlign="top";this._hTypeLabel=RBuilder.appendDiv(this._hLine1,this.styleName("TypeLabel"))},MO.FDsMaterialCatalogItem_setTypeLabel=function(b){this._hTypeLabel.innerHTML=b},MO.FDsMaterialCatalogItem_refreshStyle=function(){this._hForm.style.backgroundImage='url("'+("/cloud.resource.bitmap.wv?do=preview&guid="+this._guid+"&update_date="+this._updateDate)+'")'};
with(MO)MO.FDsMaterialCatalogToolBar=function(b){b=RClass.inherits(this,b,FUiToolBar);b._controlCreate=null;b._controlDelete=null;b._controlMoveUp=null;b._controlMoveDown=null;b.onBuilded=FDsMaterialCatalogToolBar_onBuilded;b.onCreateClick=FDsMaterialCatalogToolBar_onCreateClick;b.onDeleteClick=FDsMaterialCatalogToolBar_onDeleteClick;b.onMoveClick=FDsMaterialCatalogToolBar_onMoveClick;b.construct=FDsMaterialCatalogToolBar_construct;b.dispose=FDsMaterialCatalogToolBar_dispose;return b},MO.FDsMaterialCatalogToolBar_onBuilded=
function(b){this.__base.FUiToolBar.onBuilded.call(this,b);this._controlCreate.addClickListener(this,this.onCreateClick);this._controlDelete.addClickListener(this,this.onDeleteClick);this._controlMoveUp.addClickListener(this,this.onMoveClick);this._controlMoveDown.addClickListener(this,this.onMoveClick)},MO.FDsMaterialCatalogToolBar_onCreateClick=function(b){},MO.FDsMaterialCatalogToolBar_onDeleteClick=function(b){},MO.FDsMaterialCatalogToolBar_onMoveClick=function(b){},MO.FDsMaterialCatalogToolBar_construct=
function(){this.__base.FUiToolBar.construct.call(this)},MO.FDsMaterialCatalogToolBar_dispose=function(){this.__base.FUiToolBar.dispose.call(this)};
with(MO)MO.FDsMaterialFrameSet=function(b){b=RClass.inherits(this,b,FDsFrameSet);b._frameCatalog=null;b._frameCatalogToolBar=null;b._frameCatalogContent=null;b._frameCanvas=null;b._frameCanvasToolBar=null;b._frameCanvasContent=null;b._frameProperty=null;b._framePropertyToolBar=null;b._framePropertyContent=null;b.onBuilded=FDsMaterialFrameSet_onBuilded;b.onDataLoaded=FDsMaterialFrameSet_onDataLoaded;b.onCatalogSelected=FDsMaterialFrameSet_onCatalogSelected;b.construct=FDsMaterialFrameSet_construct;
b.switchCanvas=FDsMaterialFrameSet_switchCanvas;b.loadByGuid=FDsMaterialFrameSet_loadByGuid;b.loadByCode=FDsMaterialFrameSet_loadByCode;b.dispose=FDsMaterialFrameSet_dispose;return b},MO.FDsMaterialFrameSet_onBuilded=function(b){this.__base.FDsFrameSet.onBuilded.call(this,b);this._frameCatalogToolBar._hPanel.className=this.styleName("ToolBar_Ground");this._frameCatalogContent._hPanel.className=this.styleName("Catalog_Content");this._frameCanvasToolBar._hPanel.className=this.styleName("ToolBar_Ground");
this._frameCanvasContent._hPanel.className=this.styleName("Canvas_Content");this._framePropertyToolBar._hPanel.className=this.styleName("ToolBar_Ground");this._framePropertyContent._hPanel.className=this.styleName("Property_Content");var d=this._spliterCatalog;d.setAlignCd(EUiAlign.Left);d.setSizeHtml(this._frameCatalog._hPanel);d=this._spliterProperty;d.setAlignCd(EUiAlign.Right);d.setSizeHtml(this._frameProperty._hPanel);d=this._canvasContent=RClass.create(FDsMaterialCanvasContent);d._frameSet=
this;d._hParent=this._frameCanvasContent._hPanel;d._hParent.style.scroll="auto";d.build(b);d=this._canvasBitmap=RClass.create(FDsMaterialCanvasBitmap);d._frameSet=this;d._hParent=this._frameCanvasContent._hPanel;d._hParent.style.scroll="auto";d.build(b);this._frameCanvasContent.push(d)},MO.FDsMaterialFrameSet_onDataLoaded=function(b){this._activeSpace=b._activeSpace;this._catalog.buildSpace(this._activeSpace)},MO.FDsMaterialFrameSet_onCatalogSelected=function(b,d){var f=this._activeSpace;if(f)if(this.hidePropertyFrames(),
RClass.isClass(b,FE3dStage)){var h=this.findPropertyFrame(EDsFrame.MeshSpacePropertyFrame);h.show();h.loadObject(f,b)}else if(RClass.isClass(b,FG3dTechnique))h=this.findPropertyFrame(EDsFrame.MeshTechniquePropertyFrame),h.show(),h.loadObject(f,b);else if(RClass.isClass(b,FE3dRegion))h=this.findPropertyFrame(EDsFrame.MeshRegionPropertyFrame),h.show(),h.loadObject(f,b);else if(RClass.isClass(b,FE3dCamera))h=this.findPropertyFrame(EDsFrame.MeshCameraPropertyFrame),h.show(),h.loadObject(f,b);else if(RClass.isClass(b,
FG3dDirectionalLight))h=this.findPropertyFrame(EDsFrame.MeshLightPropertyFrame),h.show(),h.loadObject(f,b);else if(RClass.isClass(b,FE3dMeshDisplay))h=this.findPropertyFrame(EDsFrame.MeshDisplayPropertyFrame),h.show(),h.loadObject(f,b);else if(RClass.isClass(b,FG3dMaterial))h=this.findPropertyFrame(EDsFrame.MeshMaterialPropertyFrame),h.show(),h.loadObject(f,b);else if(RClass.isClass(b,FE3dMeshRenderable))h=this.findPropertyFrame(EDsFrame.MeshRenderablePropertyFrame),h.show(),h.loadObject(f,b);else throw new TError("Unknown select object type. (select={1})",
b);},MO.FDsMaterialFrameSet_construct=function(){this.__base.FDsFrameSet.construct.call(this)},MO.FDsMaterialFrameSet_switchCanvas=function(b,d){"Bitmap"==b&&this._canvasBitmap.loadByGuid(d)},MO.FDsMaterialFrameSet_loadByGuid=function(b){this._activeGuid=b;var d=this._activeResource=RConsole.find(FDrMaterialConsole).query(b);this._catalogContent.serviceList(b);this._canvasContent.loadByGuid(b);this.findPropertyFrame(EDsFrame.MaterialPropertyFrame).loadObject(d)},MO.FDsMaterialFrameSet_loadByCode=
function(b){this._activeCode=b;this._canvas.loadByCode(b)},MO.FDsMaterialFrameSet_dispose=function(){this.__base.FDsFrameSet.dispose.call(this)};
with(MO)MO.FDsMaterialImportDialog=function(b){b=RClass.inherits(this,b,FUiDialog);b._frameName="resource.material.ImportDialog";b._modeCd=null;b._nodeGuid=null;b._controlPrivateButton=null;b._controlTeamButton=null;b._controlShareButton=null;b.onBuilded=FDsMaterialImportDialog_onBuilded;b.onFileLoaded=FDsMaterialImportDialog_onFileLoaded;b.onConfirmLoad=FDsMaterialImportDialog_onConfirmLoad;b.onConfirmClick=FDsMaterialImportDialog_onConfirmClick;b.onCancelClick=FDsMaterialImportDialog_onCancelClick;
b.construct=FDsMaterialImportDialog_construct;b.switchModeCd=FDsMaterialImportDialog_switchModeCd;b.dispose=FDsMaterialImportDialog_dispose;return b},MO.FDsMaterialImportDialog_onBuilded=function(b){this.__base.FUiDialog.onBuilded.call(this,b);this._controlConfirmButton.addClickListener(this,this.onConfirmClick);this._controlCancelButton.addClickListener(this,this.onCancelClick)},MO.FDsMaterialImportDialog_onFileLoaded=function(b){b=this._activeItem;var d=this._frameSet._activeResource.guid(),f=this._controlTypeCode.get(),
h=this._controlCode.get();RString.isEmpty(h)&&(h=f);var f=this._controlLabel.get(),q=null,w=this._fileReader;switch(this._modeCd){case "select":q="/cloud.resource.material.wv?do=replaceData&material_guid="+d+"&link_guid="+b._linkGuid+"&bitmap_guid="+b._guid+"&code="+h+"&label="+f+"&data_length="+w.length()+"&file_name="+w.fileName();break;case "import":q="/cloud.resource.material.wv?do=importData&material_guid="+d+"&code="+h+"&label="+f+"&data_length="+w.length()+"&file_name="+w.fileName();break;
default:throw new TError(this,"Unknown mode. (mode_cd={1})",modeCd);}q=RBrowser.urlEncode(q);RConsole.find(FHttpConsole).send(q,w.data()).addLoadListener(this,this.onConfirmLoad);this._fileReader=RObject.dispose(w)},MO.FDsMaterialImportDialog_onConfirmLoad=function(b){RConsole.find(FUiDesktopConsole).hide();this.hide()},MO.FDsMaterialImportDialog_onConfirmClick=function(b){RConsole.find(FUiDesktopConsole).showUploading();b=this._controlFile._hInput.files[0];var d=this._fileReader=RClass.create(FFileReader);
d.addLoadListener(this,this.onFileLoaded);d.loadFile(b)},MO.FDsMaterialImportDialog_onCancelClick=function(b){this.hide()},MO.FDsMaterialImportDialog_construct=function(){this.__base.FUiDialog.construct.call(this)},MO.FDsMaterialImportDialog_switchModeCd=function(b){this._modeCd=b;switch(b){case "select":this.setLabel("\u66ff\u6362\u4f4d\u56fe\u8d44\u6e90");break;case "import":this.setLabel("\u5bfc\u5165\u4f4d\u56fe\u8d44\u6e90");break;default:throw new TError(this,"Unknown mode. (mode_cd={1})",b);
}this._controlCode.set("");this._controlLabel.set("")},MO.FDsMaterialImportDialog_dispose=function(){this.__base.FUiDialog.dispose.call(this)};
with(MO)MO.FDsMaterialMenuBar=function(b){b=RClass.inherits(this,b,FUiMenuBar);b._controlBack=null;b._controlSave=null;b._controlProperty=null;b._controlSelect=null;b._controlImport=null;b._controlCapture=null;b.onBuilded=FDsMaterialMenuBar_onBuilded;b.onBackClick=FDsMaterialMenuBar_onBackClick;b.onSaveLoad=FDsMaterialMenuBar_onSaveLoad;b.onSaveClick=FDsMaterialMenuBar_onSaveClick;b.onPropertyClick=FDsMaterialMenuBar_onPropertyClick;b.onSelectLoad=FDsMaterialMenuBar_onSelectLoad;b.onSelectConfirm=
FDsMaterialMenuBar_onSelectConfirm;b.onSelectClick=FDsMaterialMenuBar_onSelectClick;b.onImportClick=FDsMaterialMenuBar_onImportClick;b.onDeleteLoad=FDsMaterialMenuBar_onDeleteLoad;b.onDeleteExecute=FDsMaterialMenuBar_onDeleteExecute;b.onDeleteClick=FDsMaterialMenuBar_onDeleteClick;b.onCaptureLoad=FDsMaterialMenuBar_onCaptureLoad;b.onCaptureClick=FDsMaterialMenuBar_onCaptureClick;b.construct=FDsMaterialMenuBar_construct;b.dispose=FDsMaterialMenuBar_dispose;return b},MO.FDsMaterialMenuBar_onBuilded=
function(b){this.__base.FUiMenuBar.onBuilded.call(this,b);this._controlBack.addClickListener(this,this.onBackClick);this._controlSave.addClickListener(this,this.onSaveClick);this._controlProperty.addClickListener(this,this.onPropertyClick);this._controlSelect.addClickListener(this,this.onSelectClick);this._controlImport.addClickListener(this,this.onImportClick);this._controlDelete.addClickListener(this,this.onDeleteClick);this._controlCapture.addClickListener(this,this.onCaptureClick)},MO.FDsMaterialMenuBar_onBackClick=
function(b){},MO.FDsMaterialMenuBar_onSaveLoad=function(b){RConsole.find(FUiDesktopConsole).hide()},MO.FDsMaterialMenuBar_onSaveClick=function(b){b=this._frameSet._activeSpace.resource();RConsole.find(FUiDesktopConsole).showUploading();var d=new TXmlNode;b.saveConfig(d);RConsole.find(FE3sMeshConsole).update(d).addLoadListener(this,this.onSaveLoad)},MO.FDsMaterialMenuBar_onPropertyClick=function(b){},MO.FDsMaterialMenuBar_onSelectLoad=function(b){},MO.FDsMaterialMenuBar_onSelectConfirm=function(b){},
MO.FDsMaterialMenuBar_onSelectClick=function(b){b=this._frameSet._catalogContent.focusItem();if(!b)return alert("\u8bf7\u9009\u4e2d\u4f4d\u56fe");var d=RConsole.find(FUiWindowConsole).find(FDsMaterialImportDialog);d._frameSet=this._frameSet;d._activeItem=b;d.switchModeCd("select");d._controlTypeCode.set(b._code);d._controlCode.set(b._code);d._controlLabel.set(b._label);d.showPosition(EUiPosition.Center)},MO.FDsMaterialMenuBar_onImportClick=function(b){b=RConsole.find(FUiWindowConsole).find(FDsMaterialImportDialog);
b._frameSet=this._frameSet;b.switchModeCd("import");b._controlCode.set("");b._controlLabel.set("");b.showPosition(EUiPosition.Center)},MO.FDsMaterialMenuBar_onDeleteLoad=function(b){RConsole.find(FUiDesktopConsole).hide()},MO.FDsMaterialMenuBar_onDeleteExecute=function(b){b=this._frameSet._catalogContent.focusItem();RConsole.find(FUiDesktopConsole).showUploading();RConsole.find(FDrMaterialConsole).deleteBitmap(b._linkGuid).addLoadListener(this,this.onDeleteLoad)},MO.FDsMaterialMenuBar_onDeleteClick=
function(b){if(!this._frameSet._catalogContent.focusItem())return alert("\u8bf7\u9009\u4e2d\u540e\u518d\u70b9\u51fb\u5220\u9664");RConsole.find(FUiMessageConsole).showConfirm("\u8bf7\u786e\u8ba4\u662f\u5426\u5220\u9664\u5f53\u524d\u8d44\u6e90\uff1f").addResultListener(this,this.onDeleteExecute)},MO.FDsMaterialMenuBar_onCaptureLoad=function(b){RConsole.find(FUiDesktopConsole).hide()},MO.FDsMaterialMenuBar_onCaptureClick=function(b){RConsole.find(FUiDesktopConsole).showUploading();this._frameSet._canvas.capture().addLoadListener(this,
this.onCaptureLoad)},MO.FDsMaterialMenuBar_construct=function(){this.__base.FUiMenuBar.construct.call(this)},MO.FDsMaterialMenuBar_dispose=function(){this.__base.FUiMenuBar.dispose.call(this)};
with(MO)MO.FDsMaterialPropertyFrame=function(b){b=RClass.inherits(this,b,FUiForm);b._activeResource=null;b._controlGuid=null;b._controlCode=null;b._controlLabel=null;b.onBuilded=FDsMaterialPropertyFrame_onBuilded;b.onDataChanged=FDsMaterialPropertyFrame_onDataChanged;b.construct=FDsMaterialPropertyFrame_construct;b.loadObject=FDsMaterialPropertyFrame_loadObject;b.dispose=FDsMaterialPropertyFrame_dispose;return b},MO.FDsMaterialPropertyFrame_construct=function(){this.__base.FUiForm.construct.call(this)},
MO.FDsMaterialPropertyFrame_onBuilded=function(b){this.__base.FUiForm.onBuilded.call(this,b);this._controlCode.addDataChangedListener(this,this.onDataChanged);this._controlLabel.addDataChangedListener(this,this.onDataChanged)},MO.FDsMaterialPropertyFrame_onDataChanged=function(b){b=this._activeResource;b.setCode(this._controlCode.get());b.setLabel(this._controlLabel.get())},MO.FDsMaterialPropertyFrame_loadObject=function(b){this._activeResource=b;this._controlGuid.set(b.guid());this._controlCode.set(b.code());
this._controlLabel.set(b.label())},MO.FDsMaterialPropertyFrame_dispose=function(){this.__base.FUiForm.dispose.call(this)};
with(MO)MO.FDsMaterialPropertyToolBar=function(b){b=RClass.inherits(this,b,FUiToolBar);b._frameName="resource.material.PropertyToolBar";b._controlRefresh=null;b.onBuilded=FDsMaterialPropertyToolBar_onBuilded;b.onRefreshClick=FDsMaterialPropertyToolBar_onRefreshClick;b.construct=FDsMaterialPropertyToolBar_construct;b.dispose=FDsMaterialPropertyToolBar_dispose;return b},MO.FDsMaterialPropertyToolBar_onBuilded=function(b){this.__base.FUiToolBar.onBuilded.call(this,b);this._controlRefresh.addClickListener(this,
this.onRefreshClick)},MO.FDsMaterialPropertyToolBar_onRefreshClick=function(b){},MO.FDsMaterialPropertyToolBar_onSizeClick=function(b){var d=b.sender,f=b="*",h=d.name(),d=d.label();"sizeAuto"!=h&&(f=d.split("x"),b=parseInt(f[0]),f=parseInt(f[1]));this._controlSizeWidth.setText(b);this._controlSizeHeight.setText(f);this._frameSet._canvas.switchSize(b,f)},MO.FDsMaterialPropertyToolBar_onRotationChange=function(b){b=this._frameSet._canvas;var d=this._controlRotationVisible.isCheck(),f=RInteger.parse(this._controlRotationWidth.text()),
h=RInteger.parse(this._controlRotationHeight.text());b.switchRotation(d,f,h)},MO.FDsMaterialPropertyToolBar_onRotationAutoClick=function(b){var d=!1,f=!1,h=!1,q=!1,w=!1,z=!1;switch(b.sender.name()){case "dimensionalAuto":break;case "dimensionalFlipX":d=!0;break;case "dimensionalFlipY":f=!0;break;case "dimensionalFlipZ":h=!0;break;case "dimensionalX":q=!0;break;case "dimensionalY":w=!0;break;case "dimensionalZ":z=!0;break;default:throw new TError(this,"Unknown command.");}this._frameSet._canvas.viewAutoSize(d,
f,h,q,w,z)},MO.FDsMaterialPropertyToolBar_onRotationClick=function(b,d){this._frameSet._canvas.switchRotation(b.sender.isCheck())},MO.FDsMaterialPropertyToolBar_construct=function(){this.__base.FUiToolBar.construct.call(this)},MO.FDsMaterialPropertyToolBar_dispose=function(){this.__base.FUiToolBar.dispose.call(this)};
with(MO)MO.FDsMaterialSelectDialog=function(b){b=RClass.inherits(this,b,FUiDialog);b._frameName="resource.material.SelectDialog";b._nodeGuid=null;b._controlPrivateButton=null;b._controlTeamButton=null;b._controlShareButton=null;b.onBuilded=FDsMaterialSelectDialog_onBuilded;b.onFileLoaded=FDsMaterialSelectDialog_onFileLoaded;b.onConfirmLoad=FDsMaterialSelectDialog_onConfirmLoad;b.onConfirmClick=FDsMaterialSelectDialog_onConfirmClick;b.onCancelClick=FDsMaterialSelectDialog_onCancelClick;b.construct=
FDsMaterialSelectDialog_construct;b.dispose=FDsMaterialSelectDialog_dispose;return b},MO.FDsMaterialSelectDialog_onBuilded=function(b){this.__base.FUiDialog.onBuilded.call(this,b);this._controlConfirmButton.addClickListener(this,this.onConfirmClick);this._controlCancelButton.addClickListener(this,this.onCancelClick)},MO.FDsMaterialSelectDialog_onFileLoaded=function(b){b=this._fileReader;var d="/cloud.resource.material.wv?do=importData&guid="+this._resource.guid()+"&data_length="+b.length()+"&file_name="+
b.fileName(),d=RBrowser.urlEncode(d);RConsole.find(FHttpConsole).send(d,b.data()).addLoadListener(this,this.onConfirmLoad);this._fileReader=RObject.dispose(b)},MO.FDsMaterialSelectDialog_onConfirmLoad=function(b){RConsole.find(FUiDesktopConsole).hide();this.hide();this._frameSet.reload()},MO.FDsMaterialSelectDialog_onConfirmClick=function(b){RConsole.find(FUiDesktopConsole).showUploading();b=this._controlFile._hInput.files[0];var d=this._fileReader=RClass.create(FFileReader);d.addLoadListener(this,
this.onFileLoaded);d.loadFile(b)},MO.FDsMaterialSelectDialog_onCancelClick=function(b){this.hide()},MO.FDsMaterialSelectDialog_construct=function(){this.__base.FUiDialog.construct.call(this)},MO.FDsMaterialSelectDialog_dispose=function(){this.__base.FUiDialog.dispose.call(this)};
with(MO)MO.FDsMaterialWorkspace=function(b){b=RClass.inherits(this,b,FDuiWorkspace);b._frameName="design2d.bitmap.Workspace";b._styleWorkspaceGround=RClass.register(b,new AStyle("_styleWorkspaceGround","Workspace_Ground"));b._styleToolbarGround=RClass.register(b,new AStyle("_styleToolbarGround","Toolbar_Ground"));b._styleBodyGround=RClass.register(b,new AStyle("_styleBodyGround","Body_Ground"));b._styleStatusbarGround=RClass.register(b,new AStyle("_styleStatusbarGround","Statusbar_Ground"));b._activeSpace=
null;b._activeMesh=null;b._framesetMain=null;b._framesetBody=null;b._frameToolBar=null;b._frameBody=null;b._frameProperty=null;b._frameSet=null;b._propertyFrames=null;b.onBuilded=FDsMaterialWorkspace_onBuilded;b.onMeshLoad=FDsMaterialWorkspace_onMeshLoad;b.onCatalogSelected=FDsMaterialWorkspace_onCatalogSelected;b.construct=FDsMaterialWorkspace_construct;b.findPropertyFrame=FDsMaterialWorkspace_findPropertyFrame;b.loadByGuid=FDsMaterialWorkspace_loadByGuid;b.loadByCode=FDsMaterialWorkspace_loadByCode;
b.dispose=FDsMaterialWorkspace_dispose;return b},MO.FDsMaterialWorkspace_onBuilded=function(b){this.__base.FDuiWorkspace.onBuilded.call(this,b);var d=this._frameToolBar=this.searchControl("toolbarFrame");d._hPanel.className=this.styleName("Toolbar_Ground");d=this._frameBody=this.searchControl("bodyFrame");d._hPanel.className=this.styleName("Body_Ground");d=this._frameStatusBar=this.searchControl("statusFrame");d._hPanel.className=this.styleName("Statusbar_Ground");d=this._menuBar=RClass.create(FDsMaterialMenuBar);
d._workspace=this;d.buildDefine(b);this._frameToolBar.push(d);var f=this._frameSet=RClass.create(FDsMaterialFrameSet);f._workspace=this;f.buildDefine(b);this._frameBody.push(f);d._frameSet=f},MO.FDsMaterialWorkspace_onMeshLoad=function(b){this._activeSpace=b._activeSpace;this._catalog.buildSpace(this._activeSpace)},MO.FDsMaterialWorkspace_onCatalogSelected=function(b,d){for(var f=this._activeSpace,h=this._propertyFrames,q=h.count(),w=0;w<q;w++){var z=h.value(w);z.hide()}if(RClass.isClass(b,FE3dStage))z=
this.findPropertyFrame(EDsFrame.MeshSpacePropertyFrame),z.show(),z.loadObject(f,f);else if(RClass.isClass(b,FG3dTechnique))z=this.findPropertyFrame(EDsFrame.MeshTechniquePropertyFrame),z.show(),z.loadObject(f,b);else if(RClass.isClass(b,FE3dRegion))z=this.findPropertyFrame(EDsFrame.MeshRegionPropertyFrame),z.show(),z.loadObject(f,b);else if(RClass.isClass(b,FE3dCamera))z=this.findPropertyFrame(EDsFrame.MeshCameraPropertyFrame),z.show(),z.loadObject(f,b);else if(RClass.isClass(b,FG3dDirectionalLight))z=
this.findPropertyFrame(EDsFrame.MeshLightPropertyFrame),z.show(),z.loadObject(f,b);else if(RClass.isClass(b,FE3dMeshDisplay))z=this.findPropertyFrame(EDsFrame.MeshDisplayPropertyFrame),z.show(),z.loadObject(f,b);else if(RClass.isClass(b,FG3dMaterial))z=this.findPropertyFrame(EDsFrame.MeshMaterialPropertyFrame),z.show(),z.loadObject(f,b);else if(RClass.isClass(b,FE3dMeshRenderable))z=this.findPropertyFrame(EDsFrame.MeshRenderablePropertyFrame),z.show(),z.loadObject(f,b);else throw new TError("Unknown select object type. (value={1})",
b);},MO.FDsMaterialWorkspace_construct=function(){this.__base.FDuiWorkspace.construct.call(this);this._propertyFrames=new TDictionary},MO.FDsMaterialWorkspace_findPropertyFrame=function(b){var d=this._propertyFrames.get(b);d||(d=RConsole.find(FFrameConsole).get(this,b,this._frameProperty._hContainer),d._workspace=this,this._propertyFrames.set(b,d));return d},MO.FDsMaterialWorkspace_loadByGuid=function(b){this._frameSet.loadByGuid(b)},MO.FDsMaterialWorkspace_loadByCode=function(b){this._frameSet.loadByCode(b)},
MO.FDsMaterialWorkspace_dispose=function(){this.__base.FDuiWorkspace.dispose.call(this);this._propertyFrames.dispose();this._propertyFrames=null};
with(MO)MO.FDsModelCanvasContent=function(b){b=RClass.inherits(this,b,FDsCanvas);b._resourceTypeCd=EE3sResource.Model;b._autoDistance=null;b._autoOutline=null;b._autoMatrix=null;b._optionRotation=!1;b._rotation=null;b._capturePosition=null;b._captureMatrix=null;b._captureRotation=null;b._selectObject=null;b._selectBoundBox=null;b._selectRenderables=null;b._templateMatrix=null;b._templateRenderable=null;b._templateFace=null;b._templateTranslation=null;b._templateRotation=null;b._templateScale=null;
b._templateViewScale=.05;b.onBuild=FDsModelCanvasContent_onBuild;b.onMouseCaptureStart=FDsModelCanvasContent_onMouseCaptureStart;b.onMouseCapture=FDsModelCanvasContent_onMouseCapture;b.onMouseCaptureStop=FDsModelCanvasContent_onMouseCaptureStop;b.onDataLoaded=FDsModelCanvasContent_onDataLoaded;b.oeResize=FDsModelCanvasContent_oeResize;b.oeRefresh=FDsModelCanvasContent_oeRefresh;b.construct=FDsModelCanvasContent_construct;b.innerSelectDisplay=FDsModelCanvasContent_innerSelectDisplay;b.innerSelectLayer=
FDsModelCanvasContent_innerSelectLayer;b.selectNone=FDsModelCanvasContent_selectNone;b.selectDisplay=FDsModelCanvasContent_selectDisplay;b.selectMaterial=FDsModelCanvasContent_selectMaterial;b.selectRenderable=FDsModelCanvasContent_selectRenderable;b.switchDimensional=FDsModelCanvasContent_switchDimensional;b.switchRotation=FDsModelCanvasContent_switchRotation;b.viewAutoSize=FDsModelCanvasContent_viewAutoSize;b.loadByGuid=FDsModelCanvasContent_loadByGuid;b.loadByCode=FDsModelCanvasContent_loadByCode;
b.dispose=FDsModelCanvasContent_dispose;return b},MO.FDsModelCanvasContent_onBuild=function(b){this.__base.FDsCanvas.onBuild.call(this,b)},MO.FDsModelCanvasContent_onMouseCaptureStart=function(b){var d=this._activeSpace;if(d){var f=this._activeSpace.region(),f=RConsole.find(FG3dTechniqueConsole).find(this._graphicContext,FG3dSelectTechnique).test(f,b.offsetX,b.offsetY);this.selectRenderable(f);this._capturePosition.set(b.clientX,b.clientY);this._captureRotation.assign(d.camera()._rotation);f&&(f=
f.display(),this._captureMatrix.assign(f.matrix()));this._templateMatrix.identity();if(this._templateFace)for(this._templateFaceMatrix.assign(this._templateFace.matrix()),b=this._selectRenderables,d=b.count()-1;0<=d;d--)f=b.getAt(d),f._dragMatrix||(f._dragMatrix=new SMatrix3d),f._dragMatrix.assign(f.matrix());RHtml.cursorSet(this._hPanel,EUiCursor.Pointer)}},MO.FDsModelCanvasContent_onMouseCapture=function(b){if(this._activeSpace){var d=b.clientX-this._capturePosition.x,f=b.clientY-this._capturePosition.y,
h=this._canvasMoveCd,q=this._templateFace;b=this._templateMatrix;switch(this._canvasModeCd){case EDsCanvasMode.Drop:var h=this._activeSpace.camera().rotation(),w=this._captureRotation;h.x=w.x-f*this._cameraMouseRotation;h.y=w.y-d*this._cameraMouseRotation;break;case EDsCanvasMode.Translate:q&&(h==EDsCanvasDrag.X?b.tx=d/10:h==EDsCanvasDrag.Y?b.ty=-f/10:h==EDsCanvasDrag.Z&&(b.tz=d/10));break;case EDsCanvasMode.Rotation:q&&(h==EDsCanvasDrag.X?b.rx=d/10:h==EDsCanvasDrag.Y?b.ry=-f/10:h==EDsCanvasDrag.Z&&
(b.rz=d/10));break;case EDsCanvasMode.Scale:q&&(h==EDsCanvasDrag.X?b.sx=d/10:h==EDsCanvasDrag.Y?b.sy=-f/10:h==EDsCanvasDrag.Z?b.sz=d/10:h==EDsCanvasDrag.All&&(b.sx=d/10,b.sy=d/10,b.sz=d/10))}if(q)for(q.matrix().merge(this._templateFaceMatrix,b),d=this._selectRenderables,f=d.count()-1;0<=f;f--)h=d.getAt(f),h._matrix.merge(h._dragMatrix,b)}},MO.FDsModelCanvasContent_onMouseCaptureStop=function(b){RHtml.cursorSet(this._hPanel,EUiCursor.Auto)},MO.FDsModelCanvasContent_onDataLoaded=function(b){b=this._activeSpace.region();
var d=b.camera();d.setPosition(0,3,-10);d.lookAt(0,3,0);d.update();var f=this._hPanel,d=d.projection();d.size().set(f.width,f.height);d._angle=45;d.update();b=b.directionalLight().camera();b.setPosition(10,10,0);b.lookAt(0,0,0);b.update();b=new SEvent(this);this.processLoadListener(b);b.dispose();RConsole.find(FUiDesktopConsole).hide()},MO.FDsModelCanvasContent_oeResize=function(b){this.__base.FDsCanvas.oeResize.call(this,b);var d=this._hPanel;b=d.offsetWidth;var d=d.offsetHeight,f=this._activeSpace;
f&&(f=f.camera().projection(),f.size().set(b,d),f.update());return EEventStatus.Stop},MO.FDsModelCanvasContent_oeRefresh=function(b){return EEventStatus.Stop},MO.FDsModelCanvasContent_construct=function(){this.__base.FDsCanvas.construct.call(this);this._autoDistance=new SPoint3(6,6,6);this._autoOutline=new SOutline3d;this._autoMatrix=new SMatrix3d;this._capturePosition=new SPoint2;this._captureMatrix=new SMatrix3d;this._templateMatrix=new SMatrix3d;this._templateFaceMatrix=new SMatrix3d;this._rotation=
new SVector3;this._captureRotation=new SVector3;this._selectRenderables=new TObjects},MO.FDsModelCanvasContent_innerSelectDisplay=function(b){b=b.renderables();for(var d=b.count(),f=0;f<d;f++){var h=b.getAt(f);RClass.isClass(h,FDsSceneRenderable)&&(this._selectRenderables.push(h),h.showBoundBox())}},MO.FDsModelCanvasContent_innerSelectLayer=function(b){b=b.displays();for(var d=b.count(),f=0;f<d;f++){var h=b.getAt(f);this.innerSelectDisplay(h)}},MO.FDsModelCanvasContent_selectNone=function(){this._selectObject=
null;for(var b=this._selectRenderables,d=b.count(),f=0;f<d;f++)b.get(f).hideBoundBox();this._selectRenderables.clear()},MO.FDsModelCanvasContent_selectDisplay=function(b){this.selectNone();this._selectObject=b;this.innerSelectDisplay(b)},MO.FDsModelCanvasContent_selectMaterial=function(b){this.selectNone();this._selectObject=b;for(var d=b._display.renderables(),f=d.count(),h=0;h<f;h++){var q=d.get(h);q._materialReference==b&&(this._selectRenderables.push(q),q._optionSelected=!0,q.showBoundBox())}},
MO.FDsModelCanvasContent_selectRenderable=function(b){if(b)switch(b._renderable._resource._code){case "ms_translation_x":this._canvasMoveCd=EDsCanvasDrag.X;this._templateRenderable=b;return;case "ms_translation_y":this._canvasMoveCd=EDsCanvasDrag.Y;this._templateRenderable=b;return;case "ms_translation_z":this._canvasMoveCd=EDsCanvasDrag.Z;this._templateRenderable=b;return;case "ms_rotation_x":this._canvasMoveCd=EDsCanvasDrag.X;this._templateRenderable=b;return;case "ms_rotation_y":this._canvasMoveCd=
EDsCanvasDrag.Y;this._templateRenderable=b;return;case "ms_rotation_z":this._canvasMoveCd=EDsCanvasDrag.Z;this._templateRenderable=b;return;case "ms_scale_x":this._canvasMoveCd=EDsCanvasDrag.X;this._templateRenderable=b;return;case "ms_scale_y":this._canvasMoveCd=EDsCanvasDrag.Y;this._templateRenderable=b;return;case "ms_scale_z":this._canvasMoveCd=EDsCanvasDrag.Z;this._templateRenderable=b;return;case "ms_scale_all":this._canvasMoveCd=EDsCanvasDrag.All;this._templateRenderable=b;return;default:this._canvasMoveCd=
EDsCanvasDrag.Unknown,this._templateRenderable=null}this.selectNone();b&&(this._selectRenderables.push(b),b._optionSelected=!0,b.showBoundBox(),this._frameSet._catalog.showObject(b));var d=this._templateTranslation,f=this._templateRotation,h=this._templateScale;switch(this._canvasModeCd){case EDsCanvasMode.Translate:d.setVisible(null!=b);f.hide();h.hide();this._templateFace=d;break;case EDsCanvasMode.Rotation:d.hide();f.setVisible(null!=b);h.hide();this._templateFace=f;break;case EDsCanvasMode.Scale:d.hide(),
f.hide(),h.setVisible(null!=b),this._templateFace=h}d=this._templateFace;b&&d&&(b=b.display(),d=d.matrix(),d.assign(b.matrix()),d.setScaleAll(this._templateViewScale),d.update())},MO.FDsModelCanvasContent_switchMode=function(b){this._canvasModeCd=b;this.selectRenderable(this._selectRenderable)},MO.FDsModelCanvasContent_switchDimensional=function(b,d,f){this._dimensional.setVisible(b);b=this._dimensional.matrix();0<d&&(b.sx=d);0<f&&(b.sz=f);b.updateForce()},MO.FDsModelCanvasContent_switchRotation=
function(b){this._optionRotation=b},MO.FDsModelCanvasContent_viewAutoSize=function(b,d,f,h,q,w){var z=this._autoOutline,A=this._activeSpace.display(),B=A.resource(),C=B.matrix();h&&(C.rx+=RConst.PI_2);q&&(C.ry+=RConst.PI_2);w&&(C.rz+=RConst.PI_2);h=this._autoMatrix.identity();h.setRotation(C.rx,C.ry,C.rz);h.update();B=B.calculateOutline();z.calculateFrom(B,h);b&&(C.sx=-C.sx);d&&(C.sy=-C.sy);f&&(C.sz=-C.sz);f=this._autoDistance;b=f.x/z.distance.x;d=f.y/z.distance.y;f=f.z/z.distance.z;f=RMath.min(b,
d,f);b=f*RMath.sign(C.sx);d=f*RMath.sign(C.sy);f*=RMath.sign(C.sz);C.setTranslate(-z.center.x*b,-z.min.y*d,-z.center.z*f);C.setScale(b,d,f);C.update();A.reloadResource()},MO.FDsModelCanvasContent_loadByGuid=function(b){var d=this._activeSpace,f=RConsole.find(FE3dModelConsole);d&&(RStage.unregister(d),f.free(d));d=this._activeSpace=f.allocByGuid(this,b);d._linked||(RConsole.find(FUiDesktopConsole).showLoading(),d._layer.pushRenderable(this._dimensional),d.addLoadListener(this,this.onDataLoaded),d._linked=
!0);RStage.register("space",d)},MO.FDsModelCanvasContent_loadByCode=function(b){},MO.FDsModelCanvasContent_dispose=function(){this._rotation=RObject.dispose(this._rotation);this.__base.FDsCanvas.dispose.call(this)};
with(MO)MO.FDsModelCanvasToolBar=function(b){b=RClass.inherits(this,b,FUiToolBar);b._frameName="resource.model.CanvasToolBar";b._canvasModeCd=EDsCanvasMode.Drop;b._controlDrop=null;b._controlSize1=null;b._controlSize2=null;b._controlSize3=null;b._controlSize4=null;b._controlSizeWidth=null;b._controlSizeHeight=null;b._controlDimensionalVisible=null;b._controlDimensionalWidth=null;b._controlDimensionalHeight=null;b._controlDimensionalAuto=null;b._controlDimensionalFlipX=null;b._controlDimensionalFlipY=
null;b._controlDimensionalFlipZ=null;b._controlDimensionalX=null;b._controlDimensionalY=null;b._controlDimensionalZ=null;b._controlRotation=null;b.onBuilded=FDsModelCanvasToolBar_onBuilded;b.onModeClick=FDsModelCanvasToolBar_onModeClick;b.onSizeClick=FDsModelCanvasToolBar_onSizeClick;b.onDimensionalChange=FDsModelCanvasToolBar_onDimensionalChange;b.onDimensionalAutoClick=FDsModelCanvasToolBar_onDimensionalAutoClick;b.onRotationClick=FDsModelCanvasToolBar_onRotationClick;b.construct=FDsModelCanvasToolBar_construct;
b.dispose=FDsModelCanvasToolBar_dispose;return b},MO.FDsModelCanvasToolBar_onBuilded=function(b){this.__base.FUiToolBar.onBuilded.call(this,b);b=this._controlDrop;b._canvasModeCd=EDsCanvasMode.Drop;b.addClickListener(this,this.onModeClick);b.check(!0);this._controlSize1.addClickListener(this,this.onSizeClick);this._controlSize2.addClickListener(this,this.onSizeClick);this._controlSize3.addClickListener(this,this.onSizeClick);this._controlSize4.addClickListener(this,this.onSizeClick);this._controlSizeWidth.setText("*");
this._controlSizeHeight.setText("*");this._controlDimensionalVisible.addClickListener(this,this.onDimensionalChange);this._controlDimensionalVisible.check(!0);this._controlDimensionalWidth.addDataChangedListener(this,this.onDimensionalChange);this._controlDimensionalWidth.setText(1);this._controlDimensionalHeight.addDataChangedListener(this,this.onDimensionalChange);this._controlDimensionalHeight.setText(1);this._controlDimensionalAuto.addClickListener(this,this.onDimensionalAutoClick);this._controlDimensionalFlipX.addClickListener(this,
this.onDimensionalAutoClick);this._controlDimensionalFlipY.addClickListener(this,this.onDimensionalAutoClick);this._controlDimensionalFlipZ.addClickListener(this,this.onDimensionalAutoClick);this._controlDimensionalX.addClickListener(this,this.onDimensionalAutoClick);this._controlDimensionalY.addClickListener(this,this.onDimensionalAutoClick);this._controlDimensionalZ.addClickListener(this,this.onDimensionalAutoClick);this._controlRotation.addClickListener(this,this.onRotationClick)},MO.FDsModelCanvasToolBar_onModeClick=
function(b){},MO.FDsModelCanvasToolBar_onSizeClick=function(b){var d=b.sender,f=b="*",h=d.name(),d=d.label();"sizeAuto"!=h&&(f=d.split("x"),b=parseInt(f[0]),f=parseInt(f[1]));this._controlSizeWidth.setText(b);this._controlSizeHeight.setText(f);this._frameSet._canvasContent.switchSize(b,f)},MO.FDsModelCanvasToolBar_onDimensionalChange=function(b){b=this._frameSet._canvasContent;var d=this._controlDimensionalVisible.isCheck(),f=RInteger.parse(this._controlDimensionalWidth.text()),h=RInteger.parse(this._controlDimensionalHeight.text());
b.switchDimensional(d,f,h)},MO.FDsModelCanvasToolBar_onDimensionalAutoClick=function(b){var d=!1,f=!1,h=!1,q=!1,w=!1,z=!1;switch(b.sender.name()){case "dimensionalAuto":break;case "dimensionalFlipX":d=!0;break;case "dimensionalFlipY":f=!0;break;case "dimensionalFlipZ":h=!0;break;case "dimensionalX":q=!0;break;case "dimensionalY":w=!0;break;case "dimensionalZ":z=!0;break;default:throw new TError(this,"Unknown command.");}this._frameSet._canvasContent.viewAutoSize(d,f,h,q,w,z)},MO.FDsModelCanvasToolBar_onRotationClick=
function(b,d){this._frameSet._canvasContent.switchRotation(b.sender.isCheck())},MO.FDsModelCanvasToolBar_construct=function(){this.__base.FUiToolBar.construct.call(this)},MO.FDsModelCanvasToolBar_dispose=function(){this.__base.FUiToolBar.dispose.call(this)};
with(MO)MO.FDsModelCatalogContent=function(b){b=RClass.inherits(this,b,FDsCatalog);b._iconView="resource.tools.view";b._iconViewNot="resource.tools.viewno";b.onBuild=FDsModelCatalogContent_onBuild;b.onLoadDisplay=FDsModelCatalogContent_onLoadDisplay;b.onNodeViewClick=FDsModelCatalogContent_onNodeViewClick;b.onNodeViewDoubleClick=FDsModelCatalogContent_onNodeViewDoubleClick;b.lsnsSelect=null;b.construct=FDsModelCatalogContent_construct;b.buildRenderable=FDsModelCatalogContent_buildRenderable;b.buildDisplay=
FDsModelCatalogContent_buildDisplay;b.buildSpace=FDsModelCatalogContent_buildSpace;b.selectObject=FDsModelCatalogContent_selectObject;b.showObject=FDsModelCatalogContent_showObject;b.dispose=FDsModelCatalogContent_dispose;return b},MO.FDsModelCatalogContent_onBuild=function(b){this.__base.FDsCatalog.onBuild.call(this,b);this.loadUrl("/cloud.describe.tree.ws?action=query&code=resource.model")},MO.FDsModelCatalogContent_onLoadDisplay=function(b){this.buildRenderable(b._linkNode,b)},MO.FDsModelCatalogContent_onNodeViewClick=
function(b){var d=b.treeNodeCell,f=b.treeNode.dataPropertyGet("linker");if(RClass.isClass(f,FDisplay))if(b.ctrlKey){for(var h=this._displays,q=h.count()-1;0<=q;q--){var w=h.get(q);w.dataPropertyGet("linker")._visible=!1;w.cell("view").setIcon(this._iconViewNot)}f._visible=!0;d.setIcon(this._iconView)}else f._visible=!f._visible,d.setIcon(f._visible?this._iconView:this._iconViewNot);if(RClass.isClass(f,FDrawable))if(b.ctrlKey){b=this._renderables;for(q=b.count()-1;0<=q;q--)h=b.get(q),h.dataPropertyGet("linker")._visible=
!1,h.cell("view").setIcon(this._iconViewNot);f._visible=!0;d.setIcon(this._iconView)}else f._visible=!f._visible,d.setIcon(f._visible?this._iconView:this._iconViewNot)},MO.FDsModelCatalogContent_onNodeViewDoubleClick=function(b){b=b.treeNode;var d=b.dataPropertyGet("linker");if(RClass.isClass(d,FDisplay))for(var d=this._displays,f=d.count()-1;0<=f;f--)b=d.get(f),b.dataPropertyGet("linker")._visible=!0,b.cell("view").setIcon(this._iconView);if(RClass.isClass(d,FDrawable))for(d=this._renderables,f=
d.count()-1;0<=f;f--)b=d.get(f),b.dataPropertyGet("linker")._visible=!0,b.cell("view").setIcon(this._iconView)},MO.FDsModelCatalogContent_construct=function(){this.__base.FDsCatalog.construct.call(this);this._renderables=new TObjects},MO.FDsModelCatalogContent_buildRenderable=function(b,d){var f=d._renderable.resource(),h=f.code(),f=f.label(),q=this.createNode();q.setTypeCode("renderable");q.setLabel(h);q.setNote(f);q.dataPropertySet("linker",d);b.appendNode(q)},MO.FDsModelCatalogContent_buildDisplay=
function(b,d){var f=d.resource(),h=d.shapes(),q=h.count(),w=this.createNode();w.setTypeCode("display");w.setLabel("Model ("+q+")");w.dataPropertySet("linker",d);b.appendNode(w);var z=d.material(),f=f.material(),A=this.createNode();A.setTypeCode("material");A.setLabel("Material");A.dataPropertySet("linker",z);A.dataPropertySet("resource",f);w.appendNode(A);for(z=0;z<q;z++)f=h.get(z),this.buildRenderable(w,f)},MO.FDsModelCatalogContent_buildSpace=function(b){this.clearAllNodes();var d=b.resource();
this.clear();var f=this.createNode();f.setTypeCode("space");f.setLabel(d.code());f.setNote(d.label());f.dataPropertySet("linker",b);this.appendNode(f);this.buildTechnique(f,b.technique());this.buildRegion(f,b.region());this.buildDisplay(f,b._display);f.click()},MO.FDsModelCatalogContent_selectObject=function(b){null!=b&&this.processSelectedListener(b,!0)},MO.FDsModelCatalogContent_showObject=function(b){if(RClass.isClass(b,FDsSceneRenderable))for(var d=this._renderables,f=d.count(),h=0;h<f;h++)d.getAt(h).dataPropertyGet("linker")==
b&&this.processSelectedListener(b,!1)},MO.FDsModelCatalogContent_dispose=function(){this._displays=RObject.dispose(this._displays);this._renderables=RObject.dispose(this._renderables);this._materials=RObject.dispose(this._materials);this.__base.FDsCatalog.dispose.call(this)};
with(MO)MO.FDsModelCatalogToolBar=function(b){b=RClass.inherits(this,b,FUiToolBar);b._frameName="resource.model.CatalogToolBar";b._activeNodeGuid=null;b._controlCreateCamera=null;b._controlCreateLayer=null;b._controlCreateSprite=null;b._controlDelete=null;b._controlFolderOpen=null;b._controlFolderClose=null;b.onBuilded=FDsModelCatalogToolBar_onBuilded;b.onCreateCameraClick=FDsModelCatalogToolBar_onCreateCameraClick;b.onCreateLayerClick=FDsModelCatalogToolBar_onCreateLayerClick;b.onCreateSpriteClick=
FDsModelCatalogToolBar_onCreateSpriteClick;b.onDeleteLoad=FDsModelCatalogToolBar_onDeleteLoad;b.onDeleteExecute=FDsModelCatalogToolBar_onDeleteExecute;b.onCopyLoad=FDsModelCatalogToolBar_onCopyLoad;b.onCopyExecute=FDsModelCatalogToolBar_onCopyExecute;b.onCopyClick=FDsModelCatalogToolBar_onCopyClick;b.onDeleteClick=FDsModelCatalogToolBar_onDeleteClick;b.onFolderOpenClick=FDsModelCatalogToolBar_onFolderOpenClick;b.onFolderCloseClick=FDsModelCatalogToolBar_onFolderCloseClick;b.construct=FDsModelCatalogToolBar_construct;
b.dispose=FDsModelCatalogToolBar_dispose;return b},MO.FDsModelCatalogToolBar_onBuilded=function(b){this.__base.FUiToolBar.onBuilded.call(this,b);this._controlFolderOpen.addClickListener(this,this.onFolderOpenClick);this._controlFolderClose.addClickListener(this,this.onFolderCloseClick)},MO.FDsModelCatalogToolBar_onCreateCameraClick=function(b){},MO.FDsModelCatalogToolBar_onCreateLayerClick=function(b){},MO.FDsModelCatalogToolBar_onCreateSpriteClick=function(b){b=this._frameSet._catalogContent.focusNode();
if(!b)return alert("\u8bf7\u9009\u4e2d\u76ee\u5f55\u8282\u70b9\u3002");var d=b.dataPropertyGet("linker"),f=b=null;if(RClass.isClass(d,FDisplayLayer))b=d;else if(RClass.isClass(d,FE3dSprite))b=d.findParent(FDisplayLayer),f=d;else return alert("\u8bf7\u9009\u4e2d\u663e\u793a\u5c42\u6216\u8005\u7cbe\u7075\u8282\u70b9\u3002");var d=this._frameSet,h=RConsole.find(FUiWindowConsole).find(FDsCommonSpriteDialog);h._frameSet=d;h._spaceGuid=d._activeSpace.resource().guid();h._layerGuid=b.resource().guid();h._displayGuid=
f?f.resource().guid():null;b&&h.setLayerLabel(b.makeLabel());f&&h.setDisplayLabel(f.makeLabel());h.setContentCode("");h.setContentLabel("");h.showPosition(EUiPosition.Center)},MO.FDsModelCatalogToolBar_onCopyLoad=function(b){RConsole.find(FUiDesktopConsole).hide()},MO.FDsModelCatalogToolBar_onCopyExecute=function(b){b.resultCd==EResult.Success&&(b=this._frameSet._activeSpace.resource().guid(),RConsole.find(FUiDesktopConsole).showUploading(),RConsole.find(FDrSceneConsole).copyNode(b,this._activeGuid).addLoadListener(this,
this.onDeleteLoad))},MO.FDsModelCatalogToolBar_onCopyClick=function(b){var d=this._frameSet._catalogContent.focusNode();if(!d)return RConsole.find(FUiMessageConsole).showInfo("\u8bf7\u9009\u4e2d\u8282\u70b9\u540e\uff0c\u518d\u70b9\u51fb\u64cd\u4f5c\u3002");this._activeNodeGuid=d.guid();b=null;d=d.dataPropertyGet("linker");if(RClass.isClass(d,FE3dSprite))b=d,this._activeGuid=d.resource().guid();else return alert("\u4e0d\u80fd\u590d\u5236\u5f53\u524d\u9009\u4e2d\u7684\u8282\u70b9.");var f=b.resource(),
d=f.parent(),f=f.clone();d.pushDisplay(f);d=RConsole.find(FE3dInstanceConsole).create(EE3dInstance.SceneDisplay);d.linkGraphicContext(b);d.loadResource(f);RConsole.find(FE3dSceneConsole).loadDisplay(d);b.parent().pushDisplay(d)},MO.FDsModelCatalogToolBar_onDeleteLoad=function(b){RConsole.find(FUiDesktopConsole).hide();b=this._frameSet._catalogContent;var d=this._activeNodeGuid;d&&b.findByGuid(d).removeSelf();this._activeNodeGuid=null},MO.FDsModelCatalogToolBar_onDeleteExecute=function(b){b.resultCd==
EResult.Success&&(b=this._frameSet._activeSpace.resource().guid(),RConsole.find(FUiDesktopConsole).showUploading(),RConsole.find(FDrSceneConsole).deleteNode(b,this._activeGuid).addLoadListener(this,this.onDeleteLoad))},MO.FDsModelCatalogToolBar_onDeleteClick=function(b){b=this._frameSet._catalogContent.focusNode();if(!b)return RConsole.find(FUiMessageConsole).showInfo("\u8bf7\u9009\u4e2d\u8282\u70b9\u540e\uff0c\u518d\u70b9\u51fb\u64cd\u4f5c\u3002");this._activeNodeGuid=b.guid();b=b.dataPropertyGet("linker");
if(RClass.isClass(b,FE3dSprite))this._activeGuid=b.resource().guid();else return alert("\u4e0d\u80fd\u5220\u9664\u5f53\u524d\u9009\u4e2d\u7684\u8282\u70b9.");RConsole.find(FUiMessageConsole).showConfirm("\u8bf7\u786e\u8ba4\u662f\u5426\u5220\u9664\u5f53\u524d\u8282\u70b9\uff1f").addResultListener(this,this.onDeleteExecute)},MO.FDsModelCatalogToolBar_onFolderOpenClick=function(b){},MO.FDsModelCatalogToolBar_onFolderCloseClick=function(b){},MO.FDsModelCatalogToolBar_construct=function(){this.__base.FUiToolBar.construct.call(this)},
MO.FDsModelCatalogToolBar_dispose=function(){this.__base.FUiToolBar.dispose.call(this)};
with(MO)MO.FDsModelFrameSet=function(b){b=RClass.inherits(this,b,FDsFrameSet);b._frameCatalog=null;b._frameCatalogToolBar=null;b._frameCatalogContent=null;b._frameCanvas=null;b._frameCanvasToolBar=null;b._frameCanvasContent=null;b._frameProperty=null;b._framePropertyToolBar=null;b._framePropertyContent=null;b.onBuilded=FDsModelFrameSet_onBuilded;b.onDataLoaded=FDsModelFrameSet_onDataLoaded;b.onCatalogSelected=FDsModelFrameSet_onCatalogSelected;b.construct=FDsModelFrameSet_construct;b.loadByGuid=FDsModelFrameSet_loadByGuid;
b.loadByCode=FDsModelFrameSet_loadByCode;b.dispose=FDsModelFrameSet_dispose;return b},MO.FDsModelFrameSet_onBuilded=function(b){this.__base.FDsFrameSet.onBuilded.call(this,b);this._frameCatalogToolBar._hPanel.className=this.styleName("ToolBar_Ground");this._frameCatalogContent._hPanel.className=this.styleName("Catalog_Content");this._frameCanvasToolBar._hPanel.className=this.styleName("ToolBar_Ground");this._frameCanvasContent._hPanel.className=this.styleName("Canvas_Content");this._framePropertyToolBar._hPanel.className=
this.styleName("ToolBar_Ground");this._framePropertyContent._hPanel.className=this.styleName("Property_Content");b=this._spliterCatalog;b.setAlignCd(EUiAlign.Left);b.setSizeHtml(this._frameCatalog._hPanel);b=this._spliterProperty;b.setAlignCd(EUiAlign.Right);b.setSizeHtml(this._frameProperty._hPanel)},MO.FDsModelFrameSet_onDataLoaded=function(b){b=this._activeSpace=b.sender.activeSpace();this._catalogContent.buildSpace(b)},MO.FDsModelFrameSet_onCatalogSelected=function(b,d){var f=this._activeSpace;
if(f)if(this.hidePropertyFrames(),RClass.isClass(b,FE3dSpace)){var h=this.findPropertyFrame(EDsFrame.CommonSpacePropertyFrame);h.show();h.loadObject(f,b)}else if(RClass.isClass(b,FG3dTechnique))h=this.findPropertyFrame(EDsFrame.CommonTechniquePropertyFrame),h.show(),h.loadObject(f,b);else if(RClass.isClass(b,FE3dRegion))h=this.findPropertyFrame(EDsFrame.CommonRegionPropertyFrame),h.show(),h.loadObject(f,b);else if(RClass.isClass(b,FE3dCamera))h=this.findPropertyFrame(EDsFrame.CommonCameraPropertyFrame),
h.show(),h.loadObject(f,b);else if(RClass.isClass(b,FG3dLight))h=this.findPropertyFrame(EDsFrame.CommonLightPropertyFrame),h.show(),h.loadObject(f,b);else if(RClass.isClass(b,FE3dModelDisplay))h=this.findPropertyFrame(EDsFrame.CommonDisplayPropertyFrame),h.show(),h.loadObject(f,b);else if(RClass.isClass(b,FG3dMaterial))h=this.findPropertyFrame(EDsFrame.CommonMaterialPropertyFrame),h.show(),h.loadObject(f,b);else if(RClass.isClass(b,FE3dModelRenderable))h=this.findPropertyFrame(EDsFrame.CommonRenderablePropertyFrame),
h.show(),h.loadObject(f,b);else throw new TError("Unknown select object type. (select={1})",b);},MO.FDsModelFrameSet_construct=function(){this.__base.FDsFrameSet.construct.call(this)},MO.FDsModelFrameSet_loadByGuid=function(b){this._activeGuid=b;this._canvasContent.loadByGuid(b)},MO.FDsModelFrameSet_loadByCode=function(b){this._activeCode=b;this._canvasContent.loadByCode(b)},MO.FDsModelFrameSet_dispose=function(){this.__base.FDsFrameSet.dispose.call(this)};
with(MO)MO.FDsModelMenuBar=function(b){b=RClass.inherits(this,b,FUiMenuBar);b._controlSaveButton=null;b._controlCaptureButton=null;b.onSaveLoad=FDsModelMenuBar_onSaveLoad;b.onSaveClick=FDsModelMenuBar_onSaveClick;b.onCaptureLoad=FDsModelMenuBar_onCaptureLoad;b.onCaptureClick=FDsModelMenuBar_onCaptureClick;b.construct=FDsModelMenuBar_construct;b.dispose=FDsModelMenuBar_dispose;return b},MO.FDsModelMenuBar_onSaveLoad=function(b){RConsole.find(FUiDesktopConsole).hide()},MO.FDsModelMenuBar_onSaveClick=
function(b){b=this._frameSet._activeSpace.resource();RConsole.find(FUiDesktopConsole).showUploading();var d=new TXmlNode;b.saveConfig(d);RConsole.find(FDrModelConsole).update(d).addLoadListener(this,this.onSaveLoad)},MO.FDsModelMenuBar_onCaptureLoad=function(b){RConsole.find(FUiDesktopConsole).hide()},MO.FDsModelMenuBar_onCaptureClick=function(b){RConsole.find(FUiDesktopConsole).showUploading();this._frameSet._canvasContent.capture().addLoadListener(this,this.onCaptureLoad)},MO.FDsModelMenuBar_construct=
function(){this.__base.FUiMenuBar.construct.call(this)},MO.FDsModelMenuBar_dispose=function(){this.__base.FUiMenuBar.dispose.call(this)};
with(MO)MO.FDsModelWorkspace=function(b){b=RClass.inherits(this,b,FDuiWorkspace);b._frameName="design3d.mesh.Workspace";b._styleWorkspaceGround=RClass.register(b,new AStyle("_styleWorkspaceGround","Workspace_Ground"));b._styleToolbarGround=RClass.register(b,new AStyle("_styleToolbarGround","Toolbar_Ground"));b._styleBodyGround=RClass.register(b,new AStyle("_styleBodyGround","Body_Ground"));b._styleStatusbarGround=RClass.register(b,new AStyle("_styleStatusbarGround","Statusbar_Ground"));b._activeSpace=
null;b._activeMesh=null;b._framesetMain=null;b._framesetBody=null;b._frameToolBar=null;b._frameBody=null;b._frameProperty=null;b._frameSet=null;b._propertyFrames=null;b.onBuilded=FDsModelWorkspace_onBuilded;b.onMeshLoad=FDsModelWorkspace_onMeshLoad;b.onCatalogSelected=FDsModelWorkspace_onCatalogSelected;b.construct=FDsModelWorkspace_construct;b.findPropertyFrame=FDsModelWorkspace_findPropertyFrame;b.loadByGuid=FDsModelWorkspace_loadByGuid;b.loadByCode=FDsModelWorkspace_loadByCode;b.dispose=FDsModelWorkspace_dispose;
return b},MO.FDsModelWorkspace_onBuilded=function(b){this.__base.FDuiWorkspace.onBuilded.call(this,b);var d=this._frameToolBar=this.searchControl("toolbarFrame");d._hPanel.className=this.styleName("Toolbar_Ground");d=this._frameBody=this.searchControl("bodyFrame");d._hPanel.className=this.styleName("Body_Ground");d=this._frameStatusBar=this.searchControl("statusFrame");d._hPanel.className=this.styleName("Statusbar_Ground");d=this._menuBar=RClass.create(FDsModelMenuBar);d._workspace=this;d.buildDefine(b);
this._frameToolBar.push(d);var f=this._frameSet=RClass.create(FDsModelFrameSet);f._workspace=this;f.buildDefine(b);this._frameBody.push(f);d._frameSet=f},MO.FDsModelWorkspace_onMeshLoad=function(b){this._activeSpace=b._activeSpace;this._catalog.buildSpace(this._activeSpace)},MO.FDsModelWorkspace_onCatalogSelected=function(b,d){for(var f=this._activeSpace,h=this._propertyFrames,q=h.count(),w=0;w<q;w++){var z=h.value(w);z.hide()}if(RClass.isClass(b,FE3dStage))z=this.findPropertyFrame(EDsFrame.MeshSpacePropertyFrame),
z.show(),z.loadObject(f,f);else if(RClass.isClass(b,FG3dTechnique))z=this.findPropertyFrame(EDsFrame.MeshTechniquePropertyFrame),z.show(),z.loadObject(f,b);else if(RClass.isClass(b,FE3dRegion))z=this.findPropertyFrame(EDsFrame.MeshRegionPropertyFrame),z.show(),z.loadObject(f,b);else if(RClass.isClass(b,FE3dCamera))z=this.findPropertyFrame(EDsFrame.MeshCameraPropertyFrame),z.show(),z.loadObject(f,b);else if(RClass.isClass(b,FG3dDirectionalLight))z=this.findPropertyFrame(EDsFrame.MeshLightPropertyFrame),
z.show(),z.loadObject(f,b);else if(RClass.isClass(b,FE3dMeshDisplay))z=this.findPropertyFrame(EDsFrame.MeshDisplayPropertyFrame),z.show(),z.loadObject(f,b);else if(RClass.isClass(b,FG3dMaterial))z=this.findPropertyFrame(EDsFrame.MeshMaterialPropertyFrame),z.show(),z.loadObject(f,b);else if(RClass.isClass(b,FE3dMeshRenderable))z=this.findPropertyFrame(EDsFrame.MeshRenderablePropertyFrame),z.show(),z.loadObject(f,b);else throw new TError("Unknown select object type. (value={1})",b);},MO.FDsModelWorkspace_construct=
function(){this.__base.FDuiWorkspace.construct.call(this);this._propertyFrames=new TDictionary},MO.FDsModelWorkspace_findPropertyFrame=function(b){var d=this._propertyFrames.get(b);d||(d=RConsole.find(FFrameConsole).get(this,b,this._frameProperty._hContainer),d._workspace=this,this._propertyFrames.set(b,d));return d},MO.FDsModelWorkspace_loadByGuid=function(b){this._frameSet.loadByGuid(b)},MO.FDsModelWorkspace_loadByCode=function(b){this._frameSet.loadByCode(b)},MO.FDsModelWorkspace_dispose=function(){this.__base.FDuiWorkspace.dispose.call(this);
this._propertyFrames.dispose();this._propertyFrames=null};
with(MO)MO.FDsTemplateCanvasContent=function(b){b=RClass.inherits(this,b,FDsSpaceCanvas);b._resourceTypeCd=EE3sResource.Template;b._context=null;b._stage=null;b._layer=null;b._rotation=null;b._rotationAble=!1;b._capturePosition=null;b._captureMatrix=null;b._captureRotation=null;b._dimensional=null;b._selectBoundBox=null;b.onBuild=FDsTemplateCanvasContent_onBuild;b.onDataLoaded=FDsTemplateCanvasContent_onDataLoaded;b.oeRefresh=FDsTemplateCanvasContent_oeRefresh;b.construct=FDsTemplateCanvasContent_construct;
b.loadByGuid=FDsTemplateCanvasContent_loadByGuid;b.loadByCode=FDsTemplateCanvasContent_loadByCode;b.dispose=FDsTemplateCanvasContent_dispose;return b},MO.FDsTemplateCanvasContent_onBuild=function(b){this.__base.FDsSpaceCanvas.onBuild.call(this,b)},MO.FDsTemplateCanvasContent_onMouseCaptureStart=function(b){if(b=this._activeSpace)b=b.camera(),this._captureRotation.assign(b._rotation)},MO.FDsTemplateCanvasContent_onMouseCapture=function(b){if(this._activeSpace){var d=b.clientX-this._capturePosition.x;
b=b.clientY-this._capturePosition.y;var f=t.renderables().get(0).matrix(),h=this._captureMatrix;switch(this._toolbar._canvasModeCd){case EDsCanvasMode.Drop:var h=this._stage.camera().rotation(),q=this._captureRotation;h.x=q.x+.003*b;h.y=q.y+.003*d;break;case EDsCanvasMode.Translate:f.tx=h.tx+d/360*3.14;f.ty=h.ty+b/360*3.14;break;case EDsCanvasMode.Rotation:f.ry=h.ry+d*RConst.DEGREE_RATE;break;case EDsCanvasMode.Scale:f.sx=h.sx+d/100,f.sy=h.sy+d/100,f.sz=h.sz+d/100}f.updateForce()}},MO.FDsTemplateCanvasContent_onMouseCaptureStop=
function(b){},MO.FDsTemplateCanvasContent_onDataLoaded=function(b){b=this._activeSpace.region();var d=b.camera();d.setPosition(0,3,-10);d.lookAt(0,3,0);d.update();var f=this._hPanel,d=d.projection();d.size().set(f.width,f.height);d._angle=45;d.update();b=b.directionalLight().camera();b.setPosition(10,10,0);b.lookAt(0,0,0);b.update();b=new SEvent(this);this.processLoadListener(b);b.dispose();RConsole.find(FUiDesktopConsole).hide()},MO.FDsTemplateCanvasContent_oeRefresh=function(b){var d=this._graphicContext;
this.__base.FDsSpaceCanvas.oeRefresh.call(this,b);b=this._hParent.offsetWidth;var f=this._hParent.offsetHeight,h=this._hPanel;h.width=b;h.height=f;h=this._stage.camera().projection();h.size().set(b,f);h.update();d.setViewport(0,0,b,f);return EEventStatus.Stop},MO.FDsTemplateCanvasContent_construct=function(){this.__base.FDsSpaceCanvas.construct.call(this);this._capturePosition=new SPoint2;this._captureMatrix=new SMatrix3d;this._rotation=new SVector3;this._captureRotation=new SVector3},MO.FDsTemplateCanvasContent_loadByGuid=
function(b){var d=this._activeSpace,f=RConsole.find(FE3dTemplateConsole);d&&(RStage.unregister(d),f.free(d));d=this._activeSpace=f.allocByGuid(this,b);d._linked||(RConsole.find(FUiDesktopConsole).showLoading(),d._layer.pushRenderable(this._dimensional),d._linked=!0,d.addLoadListener(this,this.onDataLoaded));RStage.register("space",d)},MO.FDsTemplateCanvasContent_loadByCode=function(b){b=this._activeSpace;var d=RConsole.find(FE3dTemplateConsole);b&&(RStage.unregister(b),d.free(b));b=this._activeSpace=
d.allocByGuid(this,guid);b._linked||(RConsole.find(FUiDesktopConsole).showLoading(),b._layer.pushRenderable(this._dimensional),b.addLoadListener(this,this.onDataLoaded),b._linked=!0);RStage.register("space",b)},MO.FDsTemplateCanvasContent_dispose=function(){this._rotation=RObject.dispose(this._rotation);this.__base.FDsSpaceCanvas.dispose.call(this)};
with(MO)MO.FDsTemplateCanvasToolBar=function(b){b=RClass.inherits(this,b,FUiToolBar);b._refreshButton=null;b._saveButton=null;b._canvasModeCd=EDsCanvasMode.Drop;b.onBuilded=FDsTemplateCanvasToolBar_onBuilded;b.onModeClick=FDsTemplateCanvasToolBar_onModeClick;b.onLookClick=FDsTemplateCanvasToolBar_onLookClick;b.onPlayClick=FDsTemplateCanvasToolBar_onPlayClick;b.onViewClick=FDsTemplateCanvasToolBar_onViewClick;b.construct=FDsTemplateCanvasToolBar_construct;b.dispose=FDsTemplateCanvasToolBar_dispose;
return b},MO.FDsTemplateCanvasToolBar_onBuilded=function(b){this.__base.FUiToolBar.onBuilded.call(this,b);this._controlModeDrop.addClickListener(this,this.onModeClick);this._controlModeSelect.addClickListener(this,this.onModeClick);this._controlTranslate.addClickListener(this,this.onModeClick);this._controlRotation.addClickListener(this,this.onModeClick);this._controlScale.addClickListener(this,this.onModeClick);this._controlLookFront.addClickListener(this,this.onLookClick);this._controlLookUp.addClickListener(this,
this.onLookClick);this._controlLookLeft.addClickListener(this,this.onLookClick);this._controlPlay.addClickListener(this,this.onPlayClick);this._controlView.addClickListener(this,this.onViewClick)},MO.FDsTemplateCanvasToolBar_onModeClick=function(b){this._canvasModeCd=b._canvasModeCd},MO.FDsTemplateCanvasToolBar_onLookClick=function(b){this._canvasModeCd=b._canvasModeCd},MO.FDsTemplateCanvasToolBar_onPlayClick=function(b,d){this._frameSet._canvasContent._rotationAble=d},MO.FDsTemplateCanvasToolBar_onViewClick=
function(b){this._frameSet._canvasContent.switchRotation(b.checked)},MO.FDsTemplateCanvasToolBar_construct=function(){this.__base.FUiToolBar.construct.call(this)},MO.FDsTemplateCanvasToolBar_dispose=function(){this.__base.FUiToolBar.dispose.call(this)};
with(MO)MO.FDsTemplateCatalogContent=function(b){b=RClass.inherits(this,b,FDsCatalog);b.onBuild=FDsTemplateCatalogContent_onBuild;b.onNodeClick=FDsTemplateCatalogContent_onNodeClick;b.construct=FDsTemplateCatalogContent_construct;b.buildTechnique=FDsTemplateCatalogContent_buildTechnique;b.buildRegion=FDsTemplateCatalogContent_buildRegion;b.buildMaterial=FDsTemplateCatalogContent_buildMaterial;b.buildDisplay=FDsTemplateCatalogContent_buildDisplay;b.buildSpace=FDsTemplateCatalogContent_buildSpace;b.dispose=
FDsTemplateCatalogContent_dispose;return b},MO.FDsTemplateCatalogContent_onBuild=function(b){this.__base.FDsCatalog.onBuild.call(this,b);this.loadUrl("/cloud.describe.tree.ws?action=query&code=resource.template")},MO.FDsTemplateCatalogContent_onNodeClick=function(b){b=b.node.dataPropertyGet("linker");this.selectObject(b)},MO.FDsTemplateCatalogContent_construct=function(){this.__base.FDsCatalog.construct.call(this)},MO.FDsTemplateCatalogContent_buildTechnique=function(b,d){var f=this.createNode();
f.setLabel("Technique");f.setTypeCode("technique");f.dataPropertySet("linker",d);b.appendNode(f)},MO.FDsTemplateCatalogContent_buildRegion=function(b,d){var f=this.createNode();f.setLabel("Region");f.setTypeCode("region");f.dataPropertySet("linker",d);b.appendNode(f);var h=this.createNode();h.setLabel("Camera");h.setTypeCode("camera");h.dataPropertySet("linker",d.camera());f.appendNode(h);h=this.createNode();h.setLabel("Light");h.setTypeCode("light");h.dataPropertySet("linker",d.directionalLight());
f.appendNode(h)},MO.FDsTemplateCatalogContent_buildMaterial=function(b,d){var f=d.resource(),h=this.createNode();h.setTypeCode("Material");h.setLabel(f.code());h.setNote(f.label());h.dataPropertySet("linker",d);b.appendNode(h)},MO.FDsTemplateCatalogContent_buildDisplay=function(b,d){var f=d.resource(),h=this.createNode();h.setTypeCode("Display");h.setLabel(RString.nvl(f.code(),"Display"));h.setNote(f.label());h.dataPropertySet("linker",d);b.appendNode(h);var f=d.renderables(),q=f.count();if(0<q)for(var w=
0;w<q;w++){var z=f.at(w),A=z.resource(),B=this.createNode();B.setTypeCode("Renderable");B.setLabel(A.code());B.setNote(A.label());B.dataPropertySet("linker",z);h.appendNode(B)}},MO.FDsTemplateCatalogContent_buildSpace=function(b){this.clearAllNodes();var d=b.resource(),f=this.createNode();f.setTypeCode("Space");f.setLabel(d.code());f.setNote(d.label());f.dataPropertySet("linker",b);this.appendNode(f);this.buildTechnique(f,b.technique());this.buildRegion(f,b.region());var h=this.createNode();h.setTypeCode("Region");
h.setLabel("Materials");f.appendNode(h);for(var q=b.materials(),w=q.count(),d=0;d<w;d++){var z=q.at(d);this.buildMaterial(h,z)}h=this.createNode();h.setTypeCode("Region");h.setLabel("Displays");f.appendNode(h);b=b._sprites;q=b.count();for(d=0;d<q;d++)w=b.at(d),this.buildDisplay(h,w);f.click()},MO.FDsTemplateCatalogContent_dispose=function(){this.__base.FDsCatalog.dispose.call(this)};
with(MO)MO.FDsTemplateCatalogToolBar=function(b){b=RClass.inherits(this,b,FUiToolBar);b._frameName="resource.template.CatalogToolBar";b._activeNodeGuid=null;b._controlCreateCamera=null;b._controlCreateLayer=null;b._controlCreateSprite=null;b._controlDelete=null;b._controlFolderOpen=null;b._controlFolderClose=null;b.onBuilded=FDsTemplateCatalogToolBar_onBuilded;b.onCreateCameraClick=FDsTemplateCatalogToolBar_onCreateCameraClick;b.onCreateDisplayClick=FDsTemplateCatalogToolBar_onCreateDisplayClick;
b.onDeleteLoad=FDsTemplateCatalogToolBar_onDeleteLoad;b.onDeleteExecute=FDsTemplateCatalogToolBar_onDeleteExecute;b.onCopyLoad=FDsTemplateCatalogToolBar_onCopyLoad;b.onCopyExecute=FDsTemplateCatalogToolBar_onCopyExecute;b.onCopyClick=FDsTemplateCatalogToolBar_onCopyClick;b.onDeleteClick=FDsTemplateCatalogToolBar_onDeleteClick;b.onFolderOpenClick=FDsTemplateCatalogToolBar_onFolderOpenClick;b.onFolderCloseClick=FDsTemplateCatalogToolBar_onFolderCloseClick;b.construct=FDsTemplateCatalogToolBar_construct;
b.dispose=FDsTemplateCatalogToolBar_dispose;return b},MO.FDsTemplateCatalogToolBar_onBuilded=function(b){this.__base.FUiToolBar.onBuilded.call(this,b);this._controlCreateCamera.addClickListener(this,this.onCreateCameraClick);this._controlCreateDisplay.addClickListener(this,this.onCreateDisplayClick);this._controlCopy.addClickListener(this,this.onCopyClick);this._controlDelete.addClickListener(this,this.onDeleteClick);this._controlFolderOpen.addClickListener(this,this.onFolderOpenClick);this._controlFolderClose.addClickListener(this,
this.onFolderCloseClick)},MO.FDsTemplateCatalogToolBar_onCreateCameraClick=function(b){},MO.FDsTemplateCatalogToolBar_onCreateDisplayClick=function(b){b=this._frameSet;var d=b._activeSpace,f=RConsole.find(FUiWindowConsole).find(FDsCommonSpriteDialog);f._frameSet=b;f._spaceGuid=d.resource().guid();f.setContentCode("");f.setContentLabel("");f.showPosition(EUiPosition.Center)},MO.FDsTemplateCatalogToolBar_onCopyLoad=function(b){RConsole.find(FUiDesktopConsole).hide()},MO.FDsTemplateCatalogToolBar_onCopyExecute=
function(b){b.resultCd==EResult.Success&&(b=this._frameSet._activeSpace.resource().guid(),RConsole.find(FUiDesktopConsole).showUploading(),RConsole.find(FDrSceneConsole).copyNode(b,this._activeGuid).addLoadListener(this,this.onDeleteLoad))},MO.FDsTemplateCatalogToolBar_onCopyClick=function(b){var d=this._frameSet._catalogContent.focusNode();if(!d)return RConsole.find(FUiMessageConsole).showInfo("\u8bf7\u9009\u4e2d\u8282\u70b9\u540e\uff0c\u518d\u70b9\u51fb\u64cd\u4f5c\u3002");this._activeNodeGuid=
d.guid();b=null;d=d.dataPropertyGet("linker");if(RClass.isClass(d,FE3dSprite))b=d,this._activeGuid=d.resource().guid();else return alert("\u4e0d\u80fd\u590d\u5236\u5f53\u524d\u9009\u4e2d\u7684\u8282\u70b9.");var f=b.resource(),d=f.parent(),f=f.clone();d.pushDisplay(f);d=RConsole.find(FE3dInstanceConsole).create(EE3dInstance.SceneDisplay);d.linkGraphicContext(b);d.loadResource(f);RConsole.find(FE3dSceneConsole).loadDisplay(d);b.parent().pushDisplay(d)},MO.FDsTemplateCatalogToolBar_onDeleteLoad=function(b){RConsole.find(FUiDesktopConsole).hide();
b=this._frameSet._catalogContent;var d=this._activeNodeGuid;d&&b.findByGuid(d).removeSelf();this._activeNodeGuid=null},MO.FDsTemplateCatalogToolBar_onDeleteExecute=function(b){b.resultCd==EResult.Success&&(b=this._frameSet._activeSpace.resource().guid(),RConsole.find(FUiDesktopConsole).showUploading(),RConsole.find(FDrSceneConsole).deleteNode(b,this._activeGuid).addLoadListener(this,this.onDeleteLoad))},MO.FDsTemplateCatalogToolBar_onDeleteClick=function(b){b=this._frameSet._catalogContent.focusNode();
if(!b)return RConsole.find(FUiMessageConsole).showInfo("\u8bf7\u9009\u4e2d\u8282\u70b9\u540e\uff0c\u518d\u70b9\u51fb\u64cd\u4f5c\u3002");this._activeNodeGuid=b.guid();b=b.dataPropertyGet("linker");if(RClass.isClass(b,FE3dSprite))this._activeGuid=b.resource().guid();else return alert("\u4e0d\u80fd\u5220\u9664\u5f53\u524d\u9009\u4e2d\u7684\u8282\u70b9.");RConsole.find(FUiMessageConsole).showConfirm("\u8bf7\u786e\u8ba4\u662f\u5426\u5220\u9664\u5f53\u524d\u8282\u70b9\uff1f").addResultListener(this,this.onDeleteExecute)},
MO.FDsTemplateCatalogToolBar_onFolderOpenClick=function(b){},MO.FDsTemplateCatalogToolBar_onFolderCloseClick=function(b){},MO.FDsTemplateCatalogToolBar_construct=function(){this.__base.FUiToolBar.construct.call(this)},MO.FDsTemplateCatalogToolBar_dispose=function(){this.__base.FUiToolBar.dispose.call(this)};
with(MO)MO.FDsTemplateFrameSet=function(b){b=RClass.inherits(this,b,FDsFrameSet);b._frameCatalog=null;b._frameCatalogToolBar=null;b._frameCatalogContent=null;b._frameCanvas=null;b._frameCanvasToolBar=null;b._frameCanvasContent=null;b._frameProperty=null;b._framePropertyToolBar=null;b._framePropertyContent=null;b.onBuilded=FDsTemplateFrameSet_onBuilded;b.onDataLoaded=FDsTemplateFrameSet_onDataLoaded;b.onCatalogSelected=FDsTemplateFrameSet_onCatalogSelected;b.construct=FDsTemplateFrameSet_construct;
b.loadByGuid=FDsTemplateFrameSet_loadByGuid;b.loadByCode=FDsTemplateFrameSet_loadByCode;b.dispose=FDsTemplateFrameSet_dispose;return b},MO.FDsTemplateFrameSet_onBuilded=function(b){this.__base.FDsFrameSet.onBuilded.call(this,b);this._frameCatalogToolBar._hPanel.className=this.styleName("ToolBar_Ground");this._frameCatalogContent._hPanel.className=this.styleName("Catalog_Content");this._frameCanvasToolBar._hPanel.className=this.styleName("ToolBar_Ground");this._frameCanvasContent._hPanel.className=
this.styleName("Canvas_Content");this._framePropertyToolBar._hPanel.className=this.styleName("ToolBar_Ground");this._framePropertyContent._hPanel.className=this.styleName("Property_Content");b=this._spliterCatalog;b.setAlignCd(EUiAlign.Left);b.setSizeHtml(this._frameCatalog._hPanel);b=this._spliterProperty;b.setAlignCd(EUiAlign.Right);b.setSizeHtml(this._frameProperty._hPanel)},MO.FDsTemplateFrameSet_onDataLoaded=function(b){b=this._activeSpace=b.sender.activeSpace();this._catalogContent.buildSpace(b)},
MO.FDsTemplateFrameSet_onCatalogSelected=function(b,d){var f=this._activeSpace;if(f)if(this.hidePropertyFrames(),RClass.isClass(b,FE3dSpace)){var h=this.findPropertyFrame(EDsFrame.CommonSpacePropertyFrame);h.show();h.loadObject(f,b)}else if(RClass.isClass(b,FG3dTechnique))h=this.findPropertyFrame(EDsFrame.CommonTechniquePropertyFrame),h.show(),h.loadObject(f,b);else if(RClass.isClass(b,FE3dRegion))h=this.findPropertyFrame(EDsFrame.CommonRegionPropertyFrame),h.show(),h.loadObject(f,b);else if(RClass.isClass(b,
FE3dCamera))h=this.findPropertyFrame(EDsFrame.CommonCameraPropertyFrame),h.show(),h.loadObject(f,b);else if(RClass.isClass(b,FG3dDirectionalLight))h=this.findPropertyFrame(EDsFrame.CommonLightPropertyFrame),h.show(),h.loadObject(f,b);else if(RClass.isClass(b,FE3dTemplateDisplay))h=this.findPropertyFrame(EDsFrame.CommonDisplayPropertyFrame),h.show(),h.loadObject(f,b);else if(RClass.isClass(b,FG3dMaterial))h=this.findPropertyFrame(EDsFrame.CommonMaterialPropertyFrame),h.show(),h.loadObject(f,b);else if(RClass.isClass(b,
FE3dRenderable))h=this.findPropertyFrame(EDsFrame.CommonRenderablePropertyFrame),h.show(),h.loadObject(f,b);else throw new TError("Unknown select object type. (select={1})",b);},MO.FDsTemplateFrameSet_construct=function(){this.__base.FDsFrameSet.construct.call(this)},MO.FDsTemplateFrameSet_loadByGuid=function(b){this._activeGuid=b;this._canvasContent.loadByGuid(b)},MO.FDsTemplateFrameSet_loadByCode=function(b){this._activeCode=b;this._canvasContent.loadByCode(b)},MO.FDsTemplateFrameSet_dispose=function(){this.__base.FDsFrameSet.dispose.call(this)};
with(MO)MO.FDsTemplateMenuBar=function(b){b=RClass.inherits(this,b,FUiMenuBar);b._controlSave=null;b._controlCapture=null;b._controlSelectMaterial=null;b._controlCreateDisplay=null;b._controlDelete=null;b.onSaveLoad=FDsTemplateMenuBar_onSaveLoad;b.onSaveClick=FDsTemplateMenuBar_onSaveClick;b.onCaptureLoad=FDsTemplateMenuBar_onCaptureLoad;b.onCaptureClick=FDsTemplateMenuBar_onCaptureClick;b.onSelectMaterialClick=FDsTemplateMenuBar_onSelectMaterialClick;b.onCreateDisplayClick=FDsTemplateMenuBar_onCreateDisplayClick;
b.onDeleteClick=FDsTemplateMenuBar_onDeleteClick;b.construct=FDsTemplateMenuBar_construct;b.dispose=FDsTemplateMenuBar_dispose;return b},MO.FDsTemplateMenuBar_onSaveLoad=function(b){RConsole.find(FUiDesktopConsole).hide()},MO.FDsTemplateMenuBar_onSaveClick=function(b){b=this._frameSet._activeSpace.resource();RConsole.find(FUiDesktopConsole).showUploading();var d=new TXmlNode;b.saveConfig(d);RConsole.find(FDrTemplateConsole).update(d).addLoadListener(this,this.onSaveLoad)},MO.FDsTemplateMenuBar_onCaptureLoad=
function(b){RConsole.find(FUiDesktopConsole).hide()},MO.FDsTemplateMenuBar_onCaptureClick=function(b){RConsole.find(FUiDesktopConsole).showUploading();this._frameSet._canvasContent.capture().addLoadListener(this,this.onCaptureLoad)},MO.FDsTemplateMenuBar_onSelectMaterialClick=function(b){b=this._frameSet;var d=b._activeSpace,f=RConsole.find(FUiWindowConsole).find(FDsCommonMaterialDialog);f._frameSet=b;f._spaceGuid=d.resource().guid();f.setSpace(d);f.setContentCode("");f.setContentLabel("");f.showPosition(EUiPosition.Center)},
MO.FDsTemplateMenuBar_onCreateDisplayClick=function(b){b=this._frameSet;var d=b._activeSpace,f=RConsole.find(FUiWindowConsole).find(FDsCommonDisplayDialog);f._frameSet=b;f._spaceGuid=d.resource().guid();f.setSpace(d);f.setContentCode("");f.setContentLabel("");f.showPosition(EUiPosition.Center)},MO.FDsTemplateMenuBar_onDeleteClick=function(b){b=this._frameSet;var d=b._activeSpace,f=RConsole.find(FUiWindowConsole).find(FDsCommonDisplayDialog);f._frameSet=b;f._spaceGuid=d.resource().guid();f.setContentCode("");
f.setContentLabel("");f.showPosition(EUiPosition.Center)},MO.FDsTemplateMenuBar_construct=function(){this.__base.FUiMenuBar.construct.call(this)},MO.FDsTemplateMenuBar_dispose=function(){this.__base.FUiMenuBar.dispose.call(this)};
with(MO)MO.FDsTemplateToolBar=function(b){b=RClass.inherits(this,b,FUiToolBar);b._refreshButton=null;b._saveButton=null;b.onBuild=FDsTemplateToolBar_onBuild;b.onRefreshClick=FDsTemplateToolBar_onRefreshClick;b.onSaveClick=FDsTemplateToolBar_onSaveClick;b.construct=FDsTemplateToolBar_construct;b.dispose=FDsTemplateToolBar_dispose;return b},MO.FDsTemplateToolBar_onBuild=function(b){this.__base.FUiToolBar.onBuild.call(this,b);var d=this._refreshButton=RClass.create(FUiToolButton);d.setLabel("\u5237\u65b0");
d.setIcon("design3d.tools.refresh");d.build(b);d.addClickListener(this,this.onRefreshClick);this.push(d);d=this._saveButton=RClass.create(FUiToolButton);d.setLabel("\u4fdd\u5b58");d.setIcon("design3d.tools.save");d.build(b);d.addClickListener(this,this.onSaveClick);this.push(d)},MO.FDsTemplateToolBar_onRefreshClick=function(b){},MO.FDsTemplateToolBar_onSaveClick=function(b){var d=this._workspace._activeTemplate;b=d._resource.themes();for(var f=b.count(),h=new TXmlNode,q=0;q<f;q++)for(var d=b.get(q),
d=d.materials(),w=d.count(),z=0;z<w;z++)d.value(z).saveConfig(h.create("Material"));RConsole.find(FE3sTemplateConsole).update(h)},MO.FDsTemplateToolBar_construct=function(){this.__base.FUiToolBar.construct.call(this)},MO.FDsTemplateToolBar_dispose=function(){this.__base.FUiToolBar.dispose.call(this)};
with(MO)MO.FDsTemplateWorkspace=function(b){b=RClass.inherits(this,b,FDuiWorkspace);b._styleToolbarGround=RClass.register(b,new AStyle("_styleToolbarGround","Toolbar_Ground"));b._styleStatusbarGround=RClass.register(b,new AStyle("_styleStatusbarGround","Statusbar_Ground"));b._styleCatalogGround=RClass.register(b,new AStyle("_styleCatalogGround","Catalog_Ground"));b._styleWorkspaceGround=RClass.register(b,new AStyle("_styleWorkspaceGround","Workspace_Ground"));b._stylePropertyGround=RClass.register(b,
new AStyle("_stylePropertyGround","Property_Ground"));b._framesetMain=null;b._framesetBody=null;b._frameToolBar=null;b._frameBody=null;b._frameProperty=null;b._frameCatalog=null;b._frameWorkspace=null;b._frameStatusBar=null;b._templatePropertyFrame=null;b._themePropertyFrame=null;b._materialPropertyFrame=null;b._displayPropertyFrame=null;b.onBuild=FDsTemplateWorkspace_onBuild;b.onTemplateLoad=FDsTemplateWorkspace_onTemplateLoad;b.onCatalogSelected=FDsTemplateWorkspace_onCatalogSelected;b.construct=
FDsTemplateWorkspace_construct;b.templatePropertyFrame=FDsTemplateWorkspace_templatePropertyFrame;b.themePropertyFrame=FDsTemplateWorkspace_themePropertyFrame;b.materialPropertyFrame=FDsTemplateWorkspace_materialPropertyFrame;b.displayPropertyFrame=FDsTemplateWorkspace_displayPropertyFrame;b.loadTemplate=FDsTemplateWorkspace_loadTemplate;b.dispose=FDsTemplateWorkspace_dispose;return b},MO.FDsTemplateWorkspace_onBuild=function(b){this.__base.FDuiWorkspace.onBuild.call(this,b);this._hPanel.style.width=
"100%";this._hPanel.style.height="100%";var d=this._framesetMain=RClass.create(FUiFrameSet);d.build(b);var f=this._frameToolBar=RClass.create(FUiFramePage);f.setHeight(26);f.build(b);f._hPanel.className=this.styleName("Toolbar_Ground");d.appendFrame(f);f=this._frameBody=RClass.create(FUiFramePage);f.build(b);d.appendFrame(f);f=this._frameStatusBar=RClass.create(FUiFramePage);f.setHeight(18);f.build(b);f._hPanel.className=this.styleName("Statusbar_Ground");d.appendFrame(f);d.setPanel(this._hPanel);
d=RClass.create(FUiFrameSet);d._directionCd=EUiDirection.Horizontal;d.build(b);f=this._frameCatalog=RClass.create(FUiFramePage);f.setWidth(400);f.build(b);f._hPanel.className=this.styleName("Catalog_Ground");d.appendFrame(f);var h=d.appendSpliter(),f=this._frameWorkspace=RClass.create(FUiFramePage);f.build(b);f._hPanel.className=this.styleName("Workspace_Ground");d.appendFrame(f);var q=d.appendSpliter(),f=this._frameProperty=RClass.create(FUiFramePage);f.setWidth(240);f.build(b);f._hPanel.className=
this.styleName("Property_Ground");d.appendFrame(f);d.setPanel(this._frameBody._hPanel);h._alignCd=EUiAlign.Left;h._hSize=this._frameCatalog._hPanel;q._alignCd=EUiAlign.Right;q._hSize=this._frameStatusBar._hPanel;d=this._catalog=RClass.create(FDsTemplateCatalog);d._workspace=this;d.build(b);d.setPanel(this._frameCatalog._hPanel);d.addSelectedListener(this,this.onCatalogSelected);this.push(d);d=this._toolbar=RClass.create(FDsTemplateToolBar);d._workspace=this;d.build(b);d.setPanel(this._frameToolBar._hPanel);
this.push(d);f=RBuilder.appendTable(this._frameWorkspace._hPanel);f.style.width="100%";f.style.height="100%";h=RBuilder.appendTableRowCell(f);h.height=20;d=this._canvasToolbar=RClass.create(FDsTemplateCanvasToolBar);d._workspace=this;d.build(b);d.setPanel(h);this.push(d);h=RBuilder.appendTableRowCell(f);h.vAlign="top";d=this._canvas=RClass.create(FDsTemplateCanvas);d.addLoadListener(this,this.onTemplateLoad);d._workspace=this;d._toolbar=this._canvasToolbar;d.build(b);d.setPanel(h);this.push(d)},MO.FDsTemplateWorkspace_onTemplateLoad=
function(b){b=this._activeTemplate=b._activeTemplate;this._catalog.buildTemplate(b);this.onCatalogSelected(b)},MO.FDsTemplateWorkspace_onCatalogSelected=function(b){var d=this._activeTemplate;this._templatePropertyFrame&&this._templatePropertyFrame.hide();this._themePropertyFrame&&this._themePropertyFrame.hide();this._materialPropertyFrame&&this._materialPropertyFrame.hide();this._displayPropertyFrame&&this._displayPropertyFrame.hide();if(RClass.isClass(b,FE3dTemplate)){var f=this.templatePropertyFrame();
f.show();f.loadObject(d)}else if(RClass.isClass(b,FE3sTemplateTheme))f=this.themePropertyFrame(),f.show(),f.loadObject(d,b);else if(RClass.isClass(b,FE3sMaterial))f=this.materialPropertyFrame(),f.show(),f.loadObject(d,b);else if(RClass.isClass(b,MG3dRenderable))f=this.displayPropertyFrame(),f.show(),f.loadObject(d,b),this._canvas.selectRenderable(b);else throw new TError("Unknown select object type. (value={1})",b);},MO.FDsTemplateWorkspace_construct=function(){this.__base.FDuiWorkspace.construct.call(this)},
MO.FDsTemplateWorkspace_templatePropertyFrame=function(){var b=this._templatePropertyFrame;b||(b=this._templatePropertyFrame=RClass.create(FDsTemplatePropertyFrame),b._workspace=this,b.buildDefine(this._hPanel),b.setPanel(this._frameProperty._hPanel));return b},MO.FDsTemplateWorkspace_themePropertyFrame=function(){var b=this._themePropertyFrame;b||(b=this._themePropertyFrame=RClass.create(FDsTemplateThemePropertyFrame),b._workspace=this,b.buildDefine(this._hPanel),b.setPanel(this._frameProperty._hPanel));
return b},MO.FDsTemplateWorkspace_materialPropertyFrame=function(){var b=this._materialPropertyFrame;b||(b=this._materialPropertyFrame=RClass.create(FDsTemplateMaterialPropertyFrame),b._workspace=this,b.buildDefine(this._hPanel),b.setPanel(this._frameProperty._hPanel));return b},MO.FDsTemplateWorkspace_displayPropertyFrame=function(){var b=this._displayPropertyFrame;b||(b=this._displayPropertyFrame=RClass.create(FDsTemplateDisplayPropertyFrame),b._workspace=this,b.buildDefine(this._hPanel),b.setPanel(this._frameProperty._hPanel));
return b},MO.FDsTemplateWorkspace_loadTemplate=function(b){this._canvas.loadTemplate(b)},MO.FDsTemplateWorkspace_dispose=function(){this.__base.FDuiWorkspace.dispose.call(this)};
with(MO)MO.FDsSceneCanvasContent=function(b){b=RClass.inherits(this,b,FDsSpaceDesignCanvas);b._resourceTypeCd=EE3sResource.Scene;b.loadByGuid=FDsSceneCanvasContent_loadByGuid;b.dispose=FDsSceneCanvasContent_dispose;return b},MO.FDsSceneCanvasContent_onDataLoaded=function(b){this.reloadRegion();this.processLoadListener(this);RConsole.find(FUiDesktopConsole).hide()},MO.FDsSceneCanvasContent_loadByGuid=function(b){var d=this._activeSpace,f=RConsole.find(FE3dSceneConsole);d&&(RStage.unregister(d),f.free(d));
d=this._activeSpace=f.allocByGuid(this,b);d._linked||(RConsole.find(FUiDesktopConsole).showLoading(),d.addLoadListener(this,this.onDataLoaded),d._linked=!0);RStage.register("space",d)},MO.FDsSceneCanvasContent_dispose=function(){this.__base.FDsSpaceDesignCanvas.dispose.call(this)};
with(MO)MO.FDsSceneCanvasToolBar=function(b){b=RClass.inherits(this,b,FUiToolBar);b._frameName="resource.scene.CanvasToolBar";b._canvasModeCd=EDsCanvasMode.Drop;b._controlModeDrop=null;b._controlModeSelect=null;b._controlTranslate=null;b._controlRotation=null;b._controlScale=null;b._controlLookFront=null;b._controlLookUp=null;b._controlLookLeft=null;b._controlPlay=null;b._controlView=null;b.onBuilded=FDsSceneCanvasToolBar_onBuilded;b.onModeClick=FDsSceneCanvasToolBar_onModeClick;b.onLookClick=FDsSceneCanvasToolBar_onLookClick;
b.onPlayClick=FDsSceneCanvasToolBar_onPlayClick;b.onRotationClick=FDsSceneCanvasToolBar_onRotationClick;b.construct=FDsSceneCanvasToolBar_construct;b.dispose=FDsSceneCanvasToolBar_dispose;return b},MO.FDsSceneCanvasToolBar_onBuilded=function(b){this.__base.FUiToolBar.onBuilded.call(this,b);b=this._controlModeDrop;b._canvasModeCd=EDsCanvasMode.Drop;b.addClickListener(this,this.onModeClick);b.check(!0);b=this._controlModeSelect;b._canvasModeCd=EDsCanvasMode.Select;b.addClickListener(this,this.onModeClick);
b=this._controlTranslate;b._canvasModeCd=EDsCanvasMode.Translate;b.addClickListener(this,this.onModeClick);b=this._controlRotation;b._canvasModeCd=EDsCanvasMode.Rotation;b.addClickListener(this,this.onModeClick);b=this._controlScale;b._canvasModeCd=EDsCanvasMode.Scale;b.addClickListener(this,this.onModeClick);this._controlLookFront.addClickListener(this,this.onLookClick);this._controlLookUp.addClickListener(this,this.onLookClick);this._controlLookLeft.addClickListener(this,this.onLookClick);this._controlPlay.addClickListener(this,
this.onPlayClick);this._controlView.addClickListener(this,this.onRotationClick)},MO.FDsSceneCanvasToolBar_onModeClick=function(b){this._canvasModeCd=b=b.sender._canvasModeCd;this._frameSet._canvasContent.switchMode(b)},MO.FDsSceneCanvasToolBar_onLookClick=function(b){this._canvasModeCd=p._canvasModeCd},MO.FDsSceneCanvasToolBar_onPlayClick=function(b){this._frameSet._canvasContent.switchPlay(b.checked)},MO.FDsSceneCanvasToolBar_onRotationClick=function(b){this._frameSet._canvasContent.switchMovie(b.checked)},
MO.FDsSceneCanvasToolBar_construct=function(){this.__base.FUiToolBar.construct.call(this)},MO.FDsSceneCanvasToolBar_dispose=function(){this.__base.FUiToolBar.dispose.call(this)};
with(MO)MO.FDsSceneCatalogContent=function(b){b=RClass.inherits(this,b,FDsCatalog);b._catalogCode="resource.scene";b.onBuild=FDsSceneCatalogContent_onBuild;b.onLoadDisplay=FDsSceneCatalogContent_onLoadDisplay;b.construct=FDsSceneCatalogContent_construct;b.buildRenderable=FDsSceneCatalogContent_buildRenderable;b.buildDisplay=FDsSceneCatalogContent_buildDisplay;b.buildLayer=FDsSceneCatalogContent_buildLayer;b.buildSpace=FDsSceneCatalogContent_buildSpace;b.dispose=FDsSceneCatalogContent_dispose;return b},
MO.FDsSceneCatalogContent_onBuild=function(b){var d=RClass.create(FUiTreeColumn);d.setName("view");this.push(d);this.__base.FDsCatalog.onBuild.call(this,b);this.loadUrl("/cloud.describe.tree.ws?action=query&code="+this._catalogCode)},MO.FDsSceneCatalogContent_onLoadDisplay=function(b){this.buildRenderable(b._linkNode,b)},MO.FDsSceneCatalogContent_construct=function(){this.__base.FDsCatalog.construct.call(this)},MO.FDsSceneCatalogContent_buildRenderable=function(b,d){var f=d.movies();if(f)for(var h=
f.count(),q=0;q<h;q++){var w=f.at(q),z=w.resource(),A=this.createNode();A.setTypeCode("Movie");A.setLabel(z.code());A.setNote(z.label());A.dataPropertySet("linker",w);b.appendNode(A)}if(f=d.materials())for(h=f.count(),q=0;q<h;q++)w=f.at(q),z=w.resource(),A=this.createNode(),A.setTypeCode("Material"),A.setLabel(z.code()),A.setNote(z.label()),A.dataPropertySet("linker",w),this.buildNodeView(A,!0),b.appendNode(A),this._materialNodes.push(A);if(f=d.animations())for(h=f.count(),q=0;q<h;q++)w=f.at(q),z=
w.resource(),A=this.createNode(),A.setTypeCode("Animation"),A.setLabel(z.code()),A.setNote(z.label()),A.dataPropertySet("linker",w),b.appendNode(A),this.buildNodeView(A,!0);if(f=d.meshRenderables())for(h=f.count(),q=0;q<h;q++)w=f.at(q),z=w.resource(),z.model(),z=z.mesh(),A=this.createNode(),A.setTypeCode("Renderable"),A.setLabel(z.code()),A.dataPropertySet("linker",w),this.buildNodeView(A,!0),b.appendNode(A),this._renderableNodes.push(A)},MO.FDsSceneCatalogContent_buildDisplay=function(b,d){var f=
d.displays();if(f)for(var h=f.count(),q=0;q<h;q++){var w=f.at(q),z=w.resource(),A=this.createNode();A.setTypeCode("display");A.setLabel(z.code());A.setNote(z.label());A.dataPropertySet("linker",w);this.buildNodeView(A,!0);this._displayNodes.push(A);b.appendNode(A);w.addLoadListener(this,this.onLoadDisplay);w._linkNode=A}},MO.FDsSceneCatalogContent_buildLayer=function(b,d){var f=this.createNode();f.setTypeCode("Layers");f.setLabel("Layers");f.dataPropertySet("linker","layers");this.buildNodeView(f,
!0);b.appendNode(f);for(var h=d.layers(),q=h.count(),w=0;w<q;w++){var z=h.at(w);if(!RClass.isClass(z,FDisplayUiLayer)){var A=z.resource(),B=this.createNode();B.setTypeCode("Layer");B.setLabel("Layer:"+A.code());B.dataPropertySet("linker",z);this.buildNodeView(B,!0);f.appendNode(B);this.buildDisplay(B,z)}}},MO.FDsSceneCatalogContent_buildSpace=function(b){this.clearAllNodes();var d=b.resource(),f=this.createNode();f.setTypeCode("Scene");f.setLabel(d.code());f.setNote(d.label());f.dataPropertySet("linker",
b);this.push(f);this.buildTechnique(f,b.technique());this.buildRegion(f,b.region());this.buildLayer(f,b);f.click()},MO.FDsSceneCatalogContent_dispose=function(){this.__base.FDsCatalog.dispose.call(this)};
with(MO)MO.FDsSceneCatalogToolBar=function(b){b=RClass.inherits(this,b,FUiToolBar);b._activeNodeGuid=null;b._controlCreateCamera=null;b._controlCreateLayer=null;b._controlCreateSprite=null;b._controlCreateMovie=null;b._controlDelete=null;b._controlFolderOpen=null;b._controlFolderClose=null;b.onBuilded=FDsSceneCatalogToolBar_onBuilded;b.onCreateCameraClick=FDsSceneCatalogToolBar_onCreateCameraClick;b.onCreateLayerClick=FDsSceneCatalogToolBar_onCreateLayerClick;b.onCreateSpriteClick=FDsSceneCatalogToolBar_onCreateSpriteClick;
b.onCreateMovieClick=FDsSceneCatalogToolBar_onCreateMovieClick;b.onDeleteLoad=FDsSceneCatalogToolBar_onDeleteLoad;b.onDeleteExecute=FDsSceneCatalogToolBar_onDeleteExecute;b.onCopyLoad=FDsSceneCatalogToolBar_onCopyLoad;b.onCopyExecute=FDsSceneCatalogToolBar_onCopyExecute;b.onCopyClick=FDsSceneCatalogToolBar_onCopyClick;b.onDeleteClick=FDsSceneCatalogToolBar_onDeleteClick;b.onFolderOpenClick=FDsSceneCatalogToolBar_onFolderOpenClick;b.onFolderCloseClick=FDsSceneCatalogToolBar_onFolderCloseClick;b.construct=
FDsSceneCatalogToolBar_construct;b.dispose=FDsSceneCatalogToolBar_dispose;return b},MO.FDsSceneCatalogToolBar_onBuilded=function(b){this.__base.FUiToolBar.onBuilded.call(this,b);this._controlCreateCamera.addClickListener(this,this.onCreateCameraClick);this._controlCreateLayer.addClickListener(this,this.onCreateLayerClick);this._controlCreateSprite.addClickListener(this,this.onCreateSpriteClick);this._controlCreateMovie.addClickListener(this,this.onCreateMovieClick);this._controlCopy.addClickListener(this,
this.onCopyClick);this._controlDelete.addClickListener(this,this.onDeleteClick);this._controlFolderOpen.addClickListener(this,this.onFolderOpenClick);this._controlFolderClose.addClickListener(this,this.onFolderCloseClick)},MO.FDsSceneCatalogToolBar_onCreateCameraClick=function(b){},MO.FDsSceneCatalogToolBar_onCreateLayerClick=function(b){},MO.FDsSceneCatalogToolBar_onCreateSpriteClick=function(b){b=this._frameSet._catalogContent.focusNode();if(!b)return alert("\u8bf7\u9009\u4e2d\u76ee\u5f55\u8282\u70b9\u3002");
var d=b.dataPropertyGet("linker"),f=b=null;if(RClass.isClass(d,FDisplayLayer))b=d;else if(RClass.isClass(d,FE3dSprite))b=d.findParent(FDisplayLayer),f=d;else return alert("\u8bf7\u9009\u4e2d\u663e\u793a\u5c42\u6216\u8005\u7cbe\u7075\u8282\u70b9\u3002");var d=this._frameSet,h=RConsole.find(FUiWindowConsole).find(FDsCommonSpriteDialog);h._frameSet=d;h._spaceGuid=d._activeSpace.resource().guid();h._layerGuid=b.resource().guid();h._displayGuid=f?f.resource().guid():null;b&&h.setLayerLabel(b.makeLabel());
f&&h.setDisplayLabel(f.makeLabel());h.setContentCode("");h.setContentLabel("");h.showPosition(EUiPosition.Center)},MO.FDsSceneCatalogToolBar_onCreateMovieClick=function(b){b=this._frameSet._catalogContent.focusNode();if(!b)return alert("\u8bf7\u9009\u4e2d\u76ee\u5f55\u8282\u70b9\u3002");var d=b.dataPropertyGet("linker"),f=b=null;if(RClass.isClass(d,FE3dSprite))b=d.findParent(FDisplayLayer),f=d;else return alert("\u8bf7\u9009\u4e2d\u7cbe\u7075\u8282\u70b9\u3002");var d=this._frameSet,h=RConsole.find(FUiWindowConsole).find(FDsCommonMovieDialog);
h._frameSet=d;h._spaceGuid=d._activeSpace.resource().guid();h._layerGuid=b.resource().guid();h._displayGuid=f.resource().guid();b&&h.setLayerLabel(b.makeLabel());f&&h.setDisplayLabel(f.makeLabel());h.setContentCode("");h.setContentLabel("");h.showPosition(EUiPosition.Center)},MO.FDsSceneCatalogToolBar_onCopyLoad=function(b){RConsole.find(FUiDesktopConsole).hide()},MO.FDsSceneCatalogToolBar_onCopyExecute=function(b){b.resultCd==EResult.Success&&(b=this._frameSet._activeSpace.resource().guid(),RConsole.find(FUiDesktopConsole).showUploading(),
RConsole.find(FDrSceneConsole).copyNode(b,this._activeGuid).addLoadListener(this,this.onDeleteLoad))},MO.FDsSceneCatalogToolBar_onCopyClick=function(b){var d=this._frameSet._catalogContent.focusNode();if(!d)return RConsole.find(FUiMessageConsole).showInfo("\u8bf7\u9009\u4e2d\u8282\u70b9\u540e\uff0c\u518d\u70b9\u51fb\u64cd\u4f5c\u3002");this._activeNodeGuid=d.guid();b=null;d=d.dataPropertyGet("linker");if(RClass.isClass(d,FE3dSprite))b=d,this._activeGuid=d.resource().guid();else return alert("\u4e0d\u80fd\u590d\u5236\u5f53\u524d\u9009\u4e2d\u7684\u8282\u70b9.");
var f=b.resource(),d=f.parent(),f=f.clone();d.pushDisplay(f);d=RConsole.find(FE3dInstanceConsole).create(EE3dInstance.SceneDisplay);d.linkGraphicContext(b);d.loadResource(f);RConsole.find(FE3dSceneConsole).loadDisplay(d);b.parent().pushDisplay(d)},MO.FDsSceneCatalogToolBar_onDeleteLoad=function(b){RConsole.find(FUiDesktopConsole).hide();b=this._frameSet._catalogContent;var d=this._activeNodeGuid;d&&b.findByGuid(d).removeSelf();this._activeNodeGuid=null},MO.FDsSceneCatalogToolBar_onDeleteExecute=function(b){b.resultCd==
EResult.Success&&(b=this._frameSet._activeSpace.resource().guid(),RConsole.find(FUiDesktopConsole).showUploading(),RConsole.find(FDrSceneConsole).deleteNode(b,this._activeGuid).addLoadListener(this,this.onDeleteLoad))},MO.FDsSceneCatalogToolBar_onDeleteClick=function(b){b=this._frameSet._catalogContent.focusNode();if(!b)return RConsole.find(FUiMessageConsole).showInfo("\u8bf7\u9009\u4e2d\u8282\u70b9\u540e\uff0c\u518d\u70b9\u51fb\u64cd\u4f5c\u3002");this._activeNodeGuid=b.guid();b=b.dataPropertyGet("linker");
if(RClass.isClass(b,FE3dSprite))this._activeGuid=b.resource().guid();else return alert("\u4e0d\u80fd\u5220\u9664\u5f53\u524d\u9009\u4e2d\u7684\u8282\u70b9.");RConsole.find(FUiMessageConsole).showConfirm("\u8bf7\u786e\u8ba4\u662f\u5426\u5220\u9664\u5f53\u524d\u8282\u70b9\uff1f").addResultListener(this,this.onDeleteExecute)},MO.FDsSceneCatalogToolBar_onFolderOpenClick=function(b){},MO.FDsSceneCatalogToolBar_onFolderCloseClick=function(b){},MO.FDsSceneCatalogToolBar_construct=function(){this.__base.FUiToolBar.construct.call(this)},
MO.FDsSceneCatalogToolBar_dispose=function(){this.__base.FUiToolBar.dispose.call(this)};
with(MO)MO.FDsSceneFrameSet=function(b){b=RClass.inherits(this,b,FDsFrameSet);b._frameCatalog=null;b._frameCatalogToolBar=null;b._frameCatalogContent=null;b._frameCanvas=null;b._frameCanvasToolBar=null;b._frameCanvasContent=null;b._frameProperty=null;b._framePropertyToolBar=null;b._framePropertyContent=null;b.onBuilded=FDsSceneFrameSet_onBuilded;b.onDataLoaded=FDsSceneFrameSet_onDataLoaded;b.onCatalogSelected=FDsSceneFrameSet_onCatalogSelected;b.construct=FDsSceneFrameSet_construct;b.loadByGuid=FDsSceneFrameSet_loadByGuid;
b.loadByCode=FDsSceneFrameSet_loadByCode;b.dispose=FDsSceneFrameSet_dispose;return b},MO.FDsSceneFrameSet_onBuilded=function(b){this.__base.FDsFrameSet.onBuilded.call(this,b);this._frameCatalogToolBar._hPanel.className=this.styleName("ToolBar_Ground");this._frameCatalogContent._hPanel.className=this.styleName("Catalog_Content");this._frameCanvasToolBar._hPanel.className=this.styleName("ToolBar_Ground");this._frameCanvasContent._hPanel.className=this.styleName("Canvas_Content");this._framePropertyToolBar._hPanel.className=
this.styleName("ToolBar_Ground");this._framePropertyContent._hPanel.className=this.styleName("Property_Content");b=this._spliterCatalog;b.setAlignCd(EUiAlign.Left);b.setSizeHtml(this._frameCatalog._hPanel);b=this._spliterProperty;b.setAlignCd(EUiAlign.Right);b.setSizeHtml(this._frameProperty._hPanel);b=RConsole.find(FE3dInstanceConsole);b.register(EE3dInstance.TemplateRenderable,FDsSceneRenderable);b.register(EE3dInstance.SceneLayer,FDsSceneLayer);b.register(EE3dInstance.SceneDisplay,FDsSceneDisplay);
b.register(EE3dInstance.SceneRenderable,FDsSceneRenderable)},MO.FDsSceneFrameSet_onDataLoaded=function(b){b=this._activeSpace=b._activeSpace;this._catalogContent.buildSpace(b)},MO.FDsSceneFrameSet_onCatalogSelected=function(b,d){var f=this._activeSpace;if(f){var h=this._canvasContent;this.hidePropertyFrames();if(RClass.isClass(b,FE3dScene))h=this.findPropertyFrame(EDsFrame.CommonSpacePropertyFrame),h.show(),h.loadObject(f,b);else if(RClass.isClass(b,FG3dTechnique))h=this.findPropertyFrame(EDsFrame.CommonTechniquePropertyFrame),
h.show(),h.loadObject(f,b);else if(RClass.isClass(b,FE3dRegion))h=this.findPropertyFrame(EDsFrame.CommonRegionPropertyFrame),h.show(),h.loadObject(f,b);else if(RClass.isClass(b,FE3dCamera))h=this.findPropertyFrame(EDsFrame.CommonCameraPropertyFrame),h.show(),h.loadObject(f,b);else if(RClass.isClass(b,FG3dDirectionalLight))h=this.findPropertyFrame(EDsFrame.CommonLightPropertyFrame),h.show(),h.loadObject(f,b);else if("layers"==b)d&&h.selectLayers(b);else if(RClass.isClass(b,FE3dSceneLayer))d&&h.selectLayer(b),
h=this.findPropertyFrame(EDsFrame.CommonLayerPropertyFrame),h.show(),h.loadObject(f,b);else if(RClass.isClass(b,FE3dSceneDisplay))d&&h.selectDisplay(b),h=this.findPropertyFrame(EDsFrame.CommonDisplayPropertyFrame),h.show(),h.loadObject(f,b);else if(RClass.isClass(b,FE3dSceneMaterial))d&&h.selectMaterial(b),h=this.findPropertyFrame(EDsFrame.CommonMaterialPropertyFrame),h.show(),h.loadObject(f,b);else if(RClass.isClass(b,FE3dAnimation))h=this.findPropertyFrame(EDsFrame.CommonAnimationPropertyFrame),
h.show(),h.loadObject(f,b);else if(RClass.isClass(b,FE3dMovie))h=this.findPropertyFrame(EDsFrame.CommonMoviePropertyFrame),h.show(),h.loadObject(f,b);else if(RClass.isClass(b,FE3dRenderable))d&&h.selectRenderable(b),h=this.findPropertyFrame(EDsFrame.CommonRenderablePropertyFrame),h.show(),h.loadObject(f,b);else throw new TError("Unknown select type. (select={1})",b);}},MO.FDsSceneFrameSet_construct=function(){this.__base.FDsFrameSet.construct.call(this)},MO.FDsSceneFrameSet_loadByGuid=function(b){this._activeGuid=
b;this._canvasContent.loadByGuid(b)},MO.FDsSceneFrameSet_loadByCode=function(b){this._avtiveCode=b;this._canvasContent.loadByCode(b)},MO.FDsSceneFrameSet_dispose=function(){this.__base.FDsFrameSet.dispose.call(this)};
with(MO)MO.FDsSceneMenuBar=function(b){b=RClass.inherits(this,b,FUiMenuBar);b._refreshButton=null;b._saveButton=null;b._runButton=null;b.onBuilded=FDsSceneMenuBar_onBuilded;b.onSaveLoad=FDsSceneMenuBar_onSaveLoad;b.onSaveClick=FDsSceneMenuBar_onSaveClick;b.onCaptureLoad=FDsSceneMenuBar_onCaptureLoad;b.onCaptureClick=FDsSceneMenuBar_onCaptureClick;b.onCreateLayerClick=FDsSceneMenuBar_onCreateLayerClick;b.onImportTemplateClick=FDsSceneMenuBar_onImportTemplateClick;b.onExecuteClick=FDsSceneMenuBar_onExecuteClick;
b.construct=FDsSceneMenuBar_construct;b.dispose=FDsSceneMenuBar_dispose;return b},MO.FDsSceneMenuBar_onBuilded=function(b){this.__base.FUiMenuBar.onBuilded.call(this,b)},MO.FDsSceneMenuBar_onSaveLoad=function(b){RConsole.find(FUiDesktopConsole).hide()},MO.FDsSceneMenuBar_onSaveClick=function(b){b=this._frameSet._activeSpace;b.commitResource();b=b.resource();RConsole.find(FUiDesktopConsole).showUploading();var d=new TXmlNode;b.saveConfig(d);RConsole.find(FDrSceneConsole).update(d).addLoadListener(this,
this.onSaveLoad)},MO.FDsSceneMenuBar_onCaptureLoad=function(b){RConsole.find(FUiDesktopConsole).hide()},MO.FDsSceneMenuBar_onCaptureClick=function(b){RConsole.find(FUiDesktopConsole).showUploading();this._frameSet._canvasContent.capture().addLoadListener(this,this.onCaptureLoad)},MO.FDsSceneMenuBar_onCreateLayerClick=function(b){b=this._frameSet;var d=b._activeSpace,f=RConsole.find(FUiWindowConsole).find(FDsCommonLayerDialog);f._frameSet=b;f._spaceGuid=d.resource().guid();f.setSpace(d);f.setContentCode("");
f.setContentLabel("");f.showPosition(EUiPosition.Center)},MO.FDsSceneMenuBar_onImportTemplateClick=function(){var b=this._frameSet,d=b._activeSpace,f=RConsole.find(FUiWindowConsole).find(FDsCommonTemplateDialog);f._frameSet=b;f._spaceGuid=d.resource().guid();f.setSpace(d);f.setContentCode("");f.setContentLabel("");f.showPosition(EUiPosition.Center)},MO.FDsSceneMenuBar_onExecuteClick=function(b){window.location="Space.wa?do=run&guid="+this._frameSet._activeGuid},MO.FDsSceneMenuBar_construct=function(){this.__base.FUiMenuBar.construct.call(this)},
MO.FDsSceneMenuBar_dispose=function(){this.__base.FUiMenuBar.dispose.call(this)};
with(MO)MO.FDsScenePropertyToolBar=function(b){b=RClass.inherits(this,b,FUiToolBar);b._frameName="resource.scene.PropertyToolBar";b._controlRefresh=null;b._activeNodeGuid=null;b.onBuilded=FDsScenePropertyToolBar_onBuilded;b.onFolderCreateClick=FDsScenePropertyToolBar_onFolderCreateClick;b.onFolderDeleteLoad=FDsScenePropertyToolBar_onFolderDeleteLoad;b.onFolderDeleteExcute=FDsScenePropertyToolBar_onFolderDeleteExcute;b.onFolderDeleteClick=FDsScenePropertyToolBar_onFolderDeleteClick;b.onFolderPropertyClick=
FDsScenePropertyToolBar_onFolderPropertyClick;b.onFolderOpenClick=FDsScenePropertyToolBar_onFolderOpenClick;b.onFolderCloseClick=FDsScenePropertyToolBar_onFolderCloseClick;b.construct=FDsScenePropertyToolBar_construct;b.dispose=FDsScenePropertyToolBar_dispose;return b},MO.FDsScenePropertyToolBar_onBuilded=function(b){this.__base.FUiToolBar.onBuilded.call(this,b)},MO.FDsScenePropertyToolBar_onFolderCreateClick=function(b){var d=b=null,f=this._frameSet._catalogContent.focusNode();f&&(b=f.guid(),d=f.label());
f=RConsole.find(FUiWindowConsole).find(FDsResourceFolderDialog);f._workspace=this._workspace;f._frameSet=this._frameSet;f._parentGuid=b;f.setNodeParentLabel(d);f.setNodeLabel("");f.switchDataMode(EUiDataMode.Insert);f.showPosition(EUiPosition.Center)},MO.FDsScenePropertyToolBar_onFolderDeleteLoad=function(b){RConsole.find(FUiDesktopConsole).hide();b=this._frameSet._catalogContent;var d=this._activeNodeGuid;d&&b.findByGuid(d).removeSelf();this._activeNodeGuid=null},MO.FDsScenePropertyToolBar_onFolderDeleteExcute=
function(b){b.resultCd==EResult.Success&&(b=this._frameSet._catalogContent.focusNode(),RConsole.find(FUiDesktopConsole).showUploading(),this._activeNodeGuid=b._guid,RConsole.find(FDrResourceConsole).doFolderDelete(b._guid).addLoadListener(this,this.onFolderDeleteLoad))},MO.FDsScenePropertyToolBar_onFolderDeleteClick=function(b){if(!this._frameSet._catalogContent.focusNode())return RConsole.find(FUiMessageConsole).showInfo("\u8bf7\u9009\u4e2d\u76ee\u5f55\u8282\u70b9\u540e\uff0c\u518d\u70b9\u51fb\u64cd\u4f5c\u3002");
RConsole.find(FUiMessageConsole).showConfirm("\u8bf7\u786e\u8ba4\u662f\u5426\u5220\u9664\u5f53\u524d\u76ee\u5f55\uff1f").addResultListener(this,this.onFolderDeleteExcute)},MO.FDsScenePropertyToolBar_onFolderPropertyClick=function(b){b=this._frameSet._catalogContent.focusNode();if(!b)return RConsole.find(FUiMessageConsole).showInfo("\u8bf7\u9009\u4e2d\u76ee\u5f55\u8282\u70b9\u540e\uff0c\u518d\u70b9\u51fb\u64cd\u4f5c\u3002");var d=null;b._parent&&(d=b._parent.label());var f=RConsole.find(FUiWindowConsole).find(FDsResourceFolderDialog);
f._workspace=this._workspace;f._frameSet=this._frameSet;f._nodeGuid=b._guid;f.setNodeParentLabel(d);f.setNodeLabel(b.label());f.switchDataMode(EUiDataMode.Update);f.showPosition(EUiPosition.Center)},MO.FDsScenePropertyToolBar_onFolderOpenClick=function(b){},MO.FDsScenePropertyToolBar_onFolderCloseClick=function(b){},MO.FDsScenePropertyToolBar_construct=function(){this.__base.FUiToolBar.construct.call(this)},MO.FDsScenePropertyToolBar_dispose=function(){this.__base.FUiToolBar.dispose.call(this)};
with(MO)MO.FDsSceneWorkspace=function(b){b=RClass.inherits(this,b,FDuiWorkspace);b._frameName="resource.share.scene.Workspace";b._styleToolbarGround=RClass.register(b,new AStyle("_styleToolbarGround","Toolbar_Ground"));b._styleStatusbarGround=RClass.register(b,new AStyle("_styleStatusbarGround","Statusbar_Ground"));b._styleCatalogGround=RClass.register(b,new AStyle("_styleCatalogGround","Catalog_Ground"));b._styleWorkspaceGround=RClass.register(b,new AStyle("_styleWorkspaceGround","Workspace_Ground"));
b._stylePropertyGround=RClass.register(b,new AStyle("_stylePropertyGround","Property_Ground"));b._framesetMain=null;b._framesetBody=null;b._frameToolBar=null;b._frameBody=null;b._frameProperty=null;b._frameCatalog=null;b._frameWorkspace=null;b._frameStatusBar=null;b._propertyFrames=null;b.onBuilded=FDsSceneWorkspace_onBuilded;b.onSceneLoad=FDsSceneWorkspace_onSceneLoad;b.onCatalogSelected=FDsSceneWorkspace_onCatalogSelected;b.construct=FDsSceneWorkspace_construct;b.findPropertyFrame=FDsSceneWorkspace_findPropertyFrame;
b.loadScene=FDsSceneWorkspace_loadScene;b.dispose=FDsSceneWorkspace_dispose;return b},MO.FDsSceneWorkspace_onBuilded=function(b){this.__base.FDuiWorkspace.onBuilded.call(this,b);var d=this._frameToolBar=this.searchControl("toolbarFrame");d._hPanel.className=this.styleName("Toolbar_Ground");d=this._frameCatalog=this.searchControl("catalogFrame");d._hPanel.className=this.styleName("Catalog_Ground");d=this._frameWorkspace=this.searchControl("spaceFrame");d._hPanel.className=this.styleName("Workspace_Ground");
d=this._frameProperty=this.searchControl("propertyFrame");d._hPanel.className=this.styleName("Property_Ground");d=this._frameStatusBar=this.searchControl("statusFrame");d._hPanel.className=this.styleName("Statusbar_Ground");d=this._catalogSplitter=this.searchControl("catalogSpliter");d.setAlignCd(EUiAlign.Left);d.setSizeHtml(this._frameCatalog._hPanel);d=this._propertySpliter=this.searchControl("propertySpliter");d.setAlignCd(EUiAlign.Right);d.setSizeHtml(this._frameProperty._hPanel);var f=this._toolbar=
RClass.create(FDsSceneMenuBar);f._workspace=this;f.buildDefine(b);this._frameToolBar.push(f);f=this._catalog=RClass.create(FDsSceneCatalog);f._workspace=this;f.build(b);f.addSelectedListener(this,this.onCatalogSelected);this._frameCatalog.push(f);this._canvasToolbarFrame=this.searchControl("canvasToolbarFrame");f=this._canvasToolbar=RClass.create(FDsSceneCanvasToolBar);f._workspace=this;f.buildDefine(b);this._canvasToolbarFrame.push(f);d=this._canvasFrame=this.searchControl("canvasFrame");f=this._canvas=
RClass.create(FDsSceneCanvas);f._workspace=this;f._toolbar=this._canvasToolbar;f.addLoadListener(this,this.onSceneLoad);f._hParent=d._hPanel;f._hParent.style.backgroundColor="#000000";f.build(b);this._canvasFrame.push(f)},MO.FDsSceneWorkspace_onSceneLoad=function(b){b=this._activeScene=b._activeScene;this._catalog.buildScene(b)},MO.FDsSceneWorkspace_onCatalogSelected=function(b,d){for(var f=this._activeScene,h=this._propertyFrames,q=h.count(),w=0;w<q;w++){var z=h.value(w);z.hide()}if(RClass.isClass(b,
FE3dScene))z=this.findPropertyFrame(EDsFrame.SceneSpacePropertyFrame),z.show(),z.loadObject(f,b);else if(RClass.isClass(b,FG3dTechnique))z=this.findPropertyFrame(EDsFrame.SceneTechniquePropertyFrame),z.show(),z.loadObject(f,b);else if(RClass.isClass(b,FE3dRegion))z=this.findPropertyFrame(EDsFrame.SceneRegionPropertyFrame),z.show(),z.loadObject(f,b);else if(RClass.isClass(b,FE3dCamera))z=this.findPropertyFrame(EDsFrame.SceneCameraPropertyFrame),z.show(),z.loadObject(f,b);else if(RClass.isClass(b,FG3dDirectionalLight))z=
this.findPropertyFrame(EDsFrame.SceneLightPropertyFrame),z.show(),z.loadObject(f,b);else if("layers"==b)d&&this._canvas.selectLayers(b);else if(RClass.isClass(b,FE3dSceneLayer))d&&this._canvas.selectLayer(b),z=this.findPropertyFrame(EDsFrame.SceneLayerPropertyFrame),z.show(),z.loadObject(f,b);else if(RClass.isClass(b,FE3dSceneDisplay))d&&this._canvas.selectDisplay(b),z=this.findPropertyFrame(EDsFrame.SceneDisplayPropertyFrame),z.show(),z.loadObject(f,b);else if(RClass.isClass(b,FE3dSceneMaterial))d&&
this._canvas.selectMaterial(b),z=this.findPropertyFrame(EDsFrame.SceneMaterialPropertyFrame),z.show(),z.loadObject(f,b);else if(RClass.isClass(b,FE3rAnimation))z=this.findPropertyFrame(EDsFrame.SceneAnimationPropertyFrame),z.show(),z.loadObject(f,b);else if(RClass.isClass(b,FE3dRenderable))d&&this._canvas.selectRenderable(b),z=this.findPropertyFrame(EDsFrame.SceneRenderablePropertyFrame),z.show(),z.loadObject(f,b);else throw new TError("Unknown select object type. (value={1})",b);},MO.FDsSceneWorkspace_construct=
function(){this.__base.FDuiWorkspace.construct.call(this);this._propertyFrames=new TDictionary},MO.FDsSceneWorkspace_findPropertyFrame=function(b){var d=this._propertyFrames.get(b);d||(d=RConsole.find(FUiFrameConsole).get(this,b,this._frameProperty._hContainer),d._workspace=this,this._propertyFrames.set(b,d));return d},MO.FDsSceneWorkspace_loadScene=function(b){this._sceneCode=b;this._canvas.loadScene(b)},MO.FDsSceneWorkspace_dispose=function(){this.__base.FDuiWorkspace.dispose.call(this);this._propertyFrames.dispose();
this._propertyFrames=null};
with(MO)MO.FDsPrivateTabBar=function(b){b=RClass.inherits(this,b,FUiTabBar);b._frameName="resource.private.TabBar";b._resourceTypeCd="private";b._controlPrivateButton=null;b._controlTeamButton=null;b._controlShareButton=null;b.onBuilded=FDsPrivateTabBar_onBuilded;b.onButtonClick=FDsPrivateTabBar_onButtonClick;b.construct=FDsPrivateTabBar_construct;b.dispose=FDsPrivateTabBar_dispose;return b},MO.FDsPrivateTabBar_onBuilded=function(b){this.__base.FUiTabBar.onBuilded.call(this,b);this._controlProjectButton.addClickListener(this,
this.onButtonClick);this._controlResourceButton.addClickListener(this,this.onButtonClick);this._controlTeamButton.addClickListener(this,this.onButtonClick);this._controlPublishButton.addClickListener(this,this.onButtonClick)},MO.FDsPrivateTabBar_onButtonClick=function(b){b=b.sender.name();"solution"==b?this._workspace.selectFrameSet(EDsFrameSet.PrivateSolutionFrameSet):"project"==b?this._workspace.selectFrameSet(EDsFrameSet.PrivateProjectFrameSet):"resource"==b?this._workspace.selectFrameSet(EDsFrameSet.PrivateResourceFrameSet):
alert("\u529f\u80fd\u672a\u5f00\u542f\uff0c\u8bf7\u4ee5\u540e\u5173\u6ce8\u3002")},MO.FDsPrivateTabBar_construct=function(){this.__base.FUiTabBar.construct.call(this)},MO.FDsPrivateTabBar_dispose=function(){this.__base.FUiTabBar.dispose.call(this)};
with(MO)MO.FDsPrivateWorkspace=function(b){b=RClass.inherits(this,b,FDuiWorkspace,MUiStorage);b._frameName="resource.private.Workspace";b._storageCode=b._frameName;b._styleMenuBarGround=RClass.register(b,new AStyle("_styleMenuBarGround","MenuBar_Ground"));b._styleBodyGround=RClass.register(b,new AStyle("_styleBodyGround","Body_Ground"));b._styleStatusBarGround=RClass.register(b,new AStyle("_styleStatusBarGround","StatusBar_Ground"));b._activeFrameSetCode=null;b._activeProjectGuid=null;b._frameToolBar=
null;b._frameStatusBar=null;b._activeFrameSet=null;b._frameSets=null;b.onBuilded=FDsPrivateWorkspace_onBuilded;b.construct=FDsPrivateWorkspace_construct;b.selectFrameSet=FDsPrivateWorkspace_selectFrameSet;b.load=FDsPrivateWorkspace_load;b.dispose=FDsPrivateWorkspace_dispose;return b},MO.FDsPrivateWorkspace_onBuilded=function(b){this.__base.FDuiWorkspace.onBuilded.call(this,b);this._frameMenuBar._hPanel.className=this.styleName("MenuBar_Ground");this._frameBody._hPanel.className=this.styleName("Body_Ground");
this._frameStatusBar._hPanel.className=this.styleName("StatusBar_Ground");var d=RBuilder.createTable(b);d.width="100%";var f=RBuilder.appendTableRow(d);this._hMenuPanel=RBuilder.appendTableCell(f);var h=this._tabBar=RClass.create(FDsPrivateTabBar);h._workspace=this;h.buildDefine(b);b=RBuilder.appendTableCell(f);b.width="100px";b.align="right";b.vAlign="bottom";b.appendChild(h._hPanel);this._frameMenuBar._hPanel.appendChild(d)},MO.FDsPrivateWorkspace_construct=function(){this.__base.FDuiWorkspace.construct.call(this);
this._frameSets=new TDictionary},MO.FDsPrivateWorkspace_selectFrameSet=function(b,d){var f=this._frameSets.get(b);if(!f){if(b==EDsFrameSet.PrivateSolutionFrameSet){var h=RClass.create(FDsSolutionMenuBar);h._workspace=this;h.buildDefine(this._hPanel);f=RConsole.find(FUiFrameConsole).findByClass(this,FDsSolutionFrameSet);f._workspace=this;f._menuBar=h;h._frameSet=f}else if(b==EDsFrameSet.PrivateProjectFrameSet)h=RClass.create(FDsPrivateProjectMenuBar),h._workspace=this,h.buildDefine(this._hPanel),f=
RConsole.find(FUiFrameConsole).findByClass(this,FDsPrivateProjectFrameSet),f._workspace=this,f._menuBar=h,h._frameSet=f;else if(b==EDsFrameSet.PrivateResourceFrameSet)h=RClass.create(FDsPrivateResourceMenuBar),h._workspace=this,h.buildDefine(this._hPanel),f=RConsole.find(FUiFrameConsole).findByClass(this,FDsPrivateResourceFrameSet),f._workspace=this,f._menuBar=h,h._frameSet=f;else if(b==EDsFrameSet.PrivateBitmapFrameSet)h=RClass.create(FDsPrivateBitmapMenuBar),h._workspace=this,h.buildDefine(this._hPanel),
f=RConsole.find(FUiFrameConsole).findByClass(this,FDsPrivateBitmapFrameSet),f._workspace=this,f._menuBar=h,h._frameSet=f;else if(b==EDsFrameSet.PrivateMaterialFrameSet)h=RClass.create(FDsPrivateMaterialMenuBar),h._workspace=this,h.buildDefine(this._hPanel),f=RConsole.find(FUiFrameConsole).findByClass(this,FDsPrivateMaterialFrameSet),f._workspace=this,f._menuBar=h,h._frameSet=f;else if(b==EDsFrameSet.PrivateModelFrameSet)h=RClass.create(FDsPrivateModelMenuBar),h._workspace=this,h.buildDefine(this._hPanel),
f=RConsole.find(FUiFrameConsole).findByClass(this,FDsPrivateModelFrameSet),f._workspace=this,f._menuBar=h,h._frameSet=f;else if(b==EDsFrameSet.PrivateTemplateFrameSet)h=RClass.create(FDsPrivateTemplateMenuBar),h._workspace=this,h.buildDefine(this._hPanel),f=RConsole.find(FUiFrameConsole).findByClass(this,FDsPrivateTemplateFrameSet),f._workspace=this,f._menuBar=h,h._frameSet=f;else if(b==EDsFrameSet.PrivateSceneFrameSet)h=RClass.create(FDsPrivateSceneMenuBar),h._workspace=this,h.buildDefine(this._hPanel),
f=RConsole.find(FUiFrameConsole).findByClass(this,FDsPrivateSceneFrameSet),f._workspace=this,f._menuBar=h,h._frameSet=f;else throw new TError("Unknown frameset. (name={1})",b);this._frameSets.set(b,f)}h=this._activeFrameSet;h!=f&&(h&&(this._hMenuPanel.removeChild(h._menuBar._hPanel),this._frameBody.remove(h)),this._hMenuPanel.appendChild(f._menuBar._hPanel),this._frameBody.push(f),f.psResize());this._activeFrameSet=f;switch(b){case EDsFrameSet.PrivateSolutionFrameSet:f.load();break;case EDsFrameSet.PrivateProjectFrameSet:f.loadByGuid(d);
break;case EDsFrameSet.PrivateResourceFrameSet:f.load();break;case EDsFrameSet.PrivateBitmapFrameSet:f.loadByGuid(d);break;case EDsFrameSet.PrivateMaterialFrameSet:f.loadByGuid(d);break;case EDsFrameSet.PrivateModelFrameSet:f.loadByGuid(d);break;case EDsFrameSet.PrivateTemplateFrameSet:f.loadByGuid(d);break;case EDsFrameSet.PrivateSceneFrameSet:f.loadByGuid(d);break;default:throw new TError("Unknown frameset. (name={1})",b);}this.storageSet("frameset_code",b);this.storageSet("frameset_guid",d);this.storageUpdate();
return f},MO.FDsPrivateWorkspace_load=function(){var b=this._activeFrameSetCode=this.storageGet("frameset_code",EDsFrameSet.SolutionFrameSet),d=this._activeFrameSetGuid=this.storageGet("frameset_guid"),f=null;b==EDsFrameSet.SolutionFrameSet?(f=this._tabBar.findControl("solution"),f.doClick()):b==EDsFrameSet.PrivateProjectFrameSet?(f=this._tabBar.findControl("solution"),this._tabBar.select(f),this.selectFrameSet(b,d)):b==EDsFrameSet.PrivateResourceFrameSet?(f=this._tabBar.findControl("resource"),f.doClick()):
b==EDsFrameSet.PrivateBitmapFrameSet?(f=this._tabBar.findControl("resource"),this._tabBar.select(f),this.selectFrameSet(b,d)):b==EDsFrameSet.PrivateMaterialFrameSet?(f=this._tabBar.findControl("resource"),this._tabBar.select(f),this.selectFrameSet(b,d)):b==EDsFrameSet.PrivateModelFrameSet?(f=this._tabBar.findControl("resource"),this._tabBar.select(f),this.selectFrameSet(b,d)):b==EDsFrameSet.PrivateTemplateFrameSet?(f=this._tabBar.findControl("resource"),this._tabBar.select(f),this.selectFrameSet(b,
d)):b==EDsFrameSet.PrivateSceneFrameSet?(f=this._tabBar.findControl("resource"),this._tabBar.select(f),this.selectFrameSet(b,d)):(f=this._tabBar.findControl("solution"),f.doClick())},MO.FDsPrivateWorkspace_dispose=function(){this._frameSets=RObject.dispose(this._frameSets);this.__base.FDuiWorkspace.dispose.call(this)};
with(MO)MO.FDsPrivateProjectFrameSet=function(b){b=RClass.inherits(this,b,FDsProjectFrameSet);b._frameName="resource.private.project.FrameSet";b.onBuilded=FDsPrivateProjectFrameSet_onBuilded;return b},MO.FDsPrivateProjectFrameSet_onBuilded=function(b){this.__base.FDsProjectFrameSet.onBuilded.call(this,b);var d=this._sceneListToolbar=RClass.create(FDsProjectSceneListToolBar);d._frameSet=this;d.buildDefine(b);this._frameSceneListToolBar.push(d);d=this._sceneListContent=RClass.create(FDsProjectSceneListContent);
d._frameSet=this;d.build(b);this._frameSceneListContent.push(d);d=this._sceneCatalogToolbar=RClass.create(FDsProjectSceneCatalogToolBar);d._frameSet=this;d.buildDefine(b);this._frameSceneCatalogToolBar.push(d);d=this._sceneCatalogContent=RClass.create(FDsProjectSceneCatalogContent);d._frameSet=this;d.build(b);this._frameSceneCatalogContent.push(d);d=this._canvasSpaceToolbar=RClass.create(FDsProjectCanvasSpaceToolBar);d._frameSet=this;d.buildDefine(b);this._frameCanvasSpaceToolBar.push(d);d=this._canvasPreviewToolbar=
RClass.create(FDsProjectCanvasPreviewToolBar);d._frameSet=this;d.buildDefine(b);this._frameCanvasPreviewToolBar.push(d);d=this._propertyToolbar=RClass.create(FDsProjectPropertyToolBar);d._frameSet=this;d.buildDefine(b);this._framePropertyAttributeToolBar.push(d)};
with(MO)MO.FDsPrivateProjectMenuBar=function(b){b=RClass.inherits(this,b,FDsProjectMenuBar);b._frameName="resource.private.project.MenuBar";b.onBuilded=FDsPrivateProjectMenuBar_onBuilded;return b},MO.FDsPrivateProjectMenuBar_onBuilded=function(b){this.__base.FDsProjectMenuBar.onBuilded.call(this,b)};with(MO)MO.FDsPrivateResourceCatalogToolBar=function(b){b=RClass.inherits(this,b,FDsResourceCatalogToolBar);b._frameName="resource.private.resource.CatalogToolBar";return b};
with(MO)MO.FDsPrivateResourceFrameSet=function(b){b=RClass.inherits(this,b,FDsResourceFrameSet);b._frameName="resource.share.resource.FrameSet";b.onBuilded=FDsPrivateResourceFrameSet_onBuilded;b.onCatalogSelected=FDsPrivateResourceFrameSet_onCatalogSelected;return b},MO.FDsPrivateResourceFrameSet_onBuilded=function(b){this.__base.FDsResourceFrameSet.onBuilded.call(this,b);this._frameCatalogToolBar._hPanel.className=this.styleName("Toolbar_Ground");this._frameCatalogContent._hPanel.className=this.styleName("Catalog_Content");
this._frameListToolBar._hPanel.className=this.styleName("Toolbar_Ground");this._frameListContent._hPanel.className=this.styleName("List_Content");var d=this._catalogSplitter=this.searchControl("catalogSpliter");d.setAlignCd(EUiAlign.Left);d.setSizeHtml(this._frameCatalog._hPanel);d=this._catalogToolbar=RClass.create(FDsPrivateResourceCatalogToolBar);d._workspace=this._workspace;d._frameSet=this;d.buildDefine(b);this._frameCatalogToolBar.push(d);d=this._catalogContent=RClass.create(FDsResourceCatalogContent);
d._workspace=this._workspace;d._frameSet=this;d.build(b);this._frameCatalogContent.push(d);d=this._listToolBar=RClass.create(FDsPrivateResourceListToolBar);d._workspace=this._workspace;d._frameSet=this;d.buildDefine(b);this._frameListToolBar.push(d);d=this._listContent=RClass.create(FDsResourceListContent);d._workspace=this._workspace;d._frameSet=this;d.build(b);this._frameListContent.push(d)},MO.FDsPrivateResourceFrameSet_onCatalogSelected=function(b,d){for(var f=this._activeSpace,h=this._propertyFrames,
q=h.count(),w=0;w<q;w++){var z=h.value(w);z.hide()}if(RClass.isClass(b,FE3dStage))z=this.findPropertyFrame(EDsFrame.MeshSpacePropertyFrame),z.show(),z.loadObject(f,f);else if(RClass.isClass(b,FG3dTechnique))z=this.findPropertyFrame(EDsFrame.MeshTechniquePropertyFrame),z.show(),z.loadObject(f,b);else if(RClass.isClass(b,FE3dRegion))z=this.findPropertyFrame(EDsFrame.MeshRegionPropertyFrame),z.show(),z.loadObject(f,b);else if(RClass.isClass(b,FE3dCamera))z=this.findPropertyFrame(EDsFrame.MeshCameraPropertyFrame),
z.show(),z.loadObject(f,b);else if(RClass.isClass(b,FG3dDirectionalLight))z=this.findPropertyFrame(EDsFrame.MeshLightPropertyFrame),z.show(),z.loadObject(f,b);else if(RClass.isClass(b,FE3dMeshDisplay))z=this.findPropertyFrame(EDsFrame.MeshDisplayPropertyFrame),z.show(),z.loadObject(f,b);else if(RClass.isClass(b,FG3dMaterial))z=this.findPropertyFrame(EDsFrame.MeshMaterialPropertyFrame),z.show(),z.loadObject(f,b);else if(RClass.isClass(b,FE3dMeshRenderable))z=this.findPropertyFrame(EDsFrame.MeshRenderablePropertyFrame),
z.show(),z.loadObject(f,b);else throw new TError("Unknown select object type. (value={1})",b);};with(MO)MO.FDsPrivateResourceListToolBar=function(b){b=RClass.inherits(this,b,FDsResourceListToolBar);b._frameName="resource.private.resource.ListToolBar";b._storageCode=b._frameName;return b};
with(MO)MO.FDsPrivateResourceMenuBar=function(b){b=RClass.inherits(this,b,FDsResourceMenuBar);b._frameName="resource.private.resource.MenuBar";b._controlRefresh=null;b.onBuilded=FDsPrivateResourceMenuBar_onBuilded;b.onRefreshClick=FDsPrivateResourceMenuBar_onRefreshClick;return b},MO.FDsPrivateResourceMenuBar_onBuilded=function(b){this.__base.FDsResourceMenuBar.onBuilded.call(this,b);this._controlImportPicture.addClickListener(this,this.onImportPictureClick);this._controlImportModel.addClickListener(this,
this.onImportModelClick);this._controlCreateMaterial.addClickListener(this,this.onCreateMaterialClick);this._controlCreateTemplate.addClickListener(this,this.onCreateTemplateClick);this._controlCreateScene.addClickListener(this,this.onCreateSceneClick);this._controlDelete.addClickListener(this,this.onDeleteClick);this._controlShareOpen.addClickListener(this,this.onShareClick);this._controlShareClose.addClickListener(this,this.onShareClick)},MO.FDsPrivateResourceMenuBar_onRefreshClick=function(b){};
with(MO)MO.FDsPrivateBitmapCanvasToolBar=function(b){b=RClass.inherits(this,b,FDsBitmapCanvasToolBar);b._frameName="resource.private.bitmap.CanvasToolBar";return b};
with(MO)MO.FDsPrivateBitmapFrameSet=function(b){b=RClass.inherits(this,b,FDsBitmapFrameSet);b._frameName="resource.private.bitmap.FrameSet";b.onBuilded=FDsPrivateBitmapFrameSet_onBuilded;return b},MO.FDsPrivateBitmapFrameSet_onBuilded=function(b){this.__base.FDsBitmapFrameSet.onBuilded.call(this,b);var d=this._canvasToolBar=RClass.create(FDsPrivateBitmapCanvasToolBar);d._frameSet=this;d.buildDefine(b);this._frameCanvasToolBar.push(d);d=this._canvasContent=RClass.create(FDsBitmapCanvasContent);d._frameSet=
this;d._hParent=this._frameCanvasContent._hPanel;d._hParent.style.backgroundColor="#333333";d._hParent.style.scroll="auto";d.build(b);this._frameCanvasContent.push(d);d=this._propertyToolBar=RClass.create(FDsBitmapPropertyToolBar);d._frameSet=this;d.buildDefine(b);this._framePropertyToolBar.push(d);b=this.findPropertyFrame(EDsFrame.BitmapPropertyFrame);this._framePropertyContent.push(b)};
with(MO)MO.FDsPrivateBitmapMenuBar=function(b){b=RClass.inherits(this,b,FDsBitmapMenuBar);b._frameName="resource.private.bitmap.MenuBar";b.onBuilded=FDsPrivateBitmapMenuBar_onBuilded;b.onBackClick=FDsPrivateBitmapMenuBar_onBackClick;return b},MO.FDsPrivateBitmapMenuBar_onBuilded=function(b){this.__base.FDsBitmapMenuBar.onBuilded.call(this,b);this._controlBack.addClickListener(this,this.onBackClick);this._controlSave.addClickListener(this,this.onSaveClick);this._controlImport.addClickListener(this,
this.onImportClick)},MO.FDsPrivateBitmapMenuBar_onBackClick=function(b){this._frameSet._workspace.selectFrameSet(EDsFrameSet.PrivateResourceFrameSet)};with(MO)MO.FDsPrivateMaterialCanvasToolBar=function(b){b=RClass.inherits(this,b,FDsMaterialCanvasToolBar);b._frameName="resource.private.material.CanvasToolBar";return b};with(MO)MO.FDsPrivateMaterialCatalogToolBar=function(b){b=RClass.inherits(this,b,FDsMaterialCatalogToolBar);b._frameName="resource.private.material.CatalogToolBar";return b};
with(MO)MO.FDsPrivateMaterialFrameSet=function(b){b=RClass.inherits(this,b,FDsMaterialFrameSet);b._frameName="resource.private.material.FrameSet";b.onBuilded=FDsPrivateMaterialFrameSet_onBuilded;return b},MO.FDsPrivateMaterialFrameSet_onBuilded=function(b){this.__base.FDsMaterialFrameSet.onBuilded.call(this,b);var d=this._catalogToolBar=RClass.create(FDsPrivateMaterialCatalogToolBar);d._frameSet=this;d.buildDefine(b);this._frameCatalogToolBar.push(d);d=this._catalogContent=RClass.create(FDsMaterialCatalogContent);
d._frameSet=this;d.build(b);this._frameCatalogContent.push(d);d=this._canvasToolBar=RClass.create(FDsPrivateMaterialCanvasToolBar);d._frameSet=this;d.buildDefine(b);this._frameCanvasToolBar.push(d);d=this._propertyToolBar=RClass.create(FDsMaterialPropertyToolBar);d._frameSet=this;d.buildDefine(b);this._framePropertyToolBar.push(d)};with(MO)MO.FDsPrivateMaterialMenuBar=function(b){b=RClass.inherits(this,b,FDsMaterialMenuBar);b._frameName="resource.private.material.MenuBar";return b};
with(MO)MO.FDsPrivateModelCanvasToolBar=function(b){b=RClass.inherits(this,b,FDsModelCanvasToolBar);b._frameName="resource.private.model.CanvasToolBar";return b};with(MO)MO.FDsPrivateModelCatalogToolBar=function(b){b=RClass.inherits(this,b,FDsModelCatalogToolBar);b._frameName="resource.private.model.CatalogToolBar";return b};
with(MO)MO.FDsPrivateModelFrameSet=function(b){b=RClass.inherits(this,b,FDsModelFrameSet);b._frameName="resource.private.model.FrameSet";b.onBuilded=FDsPrivateModelFrameSet_onBuilded;return b},MO.FDsPrivateModelFrameSet_onBuilded=function(b){this.__base.FDsModelFrameSet.onBuilded.call(this,b);var d=this._catalogToolBar=RClass.create(FDsPrivateModelCatalogToolBar);d._frameSet=this;d.buildDefine(b);this._frameCatalogToolBar.push(d);d=this._catalogContent=RClass.create(FDsModelCatalogContent);d._frameSet=
this;d.build(b);d.addSelectedListener(this,this.onCatalogSelected);this._frameCatalogContent.push(d);d=this._canvasToolBar=RClass.create(FDsPrivateModelCanvasToolBar);d._frameSet=this;d.buildDefine(b);this._frameCanvasToolBar.push(d);d=this._canvasContent=RClass.create(FDsModelCanvasContent);d._frameSet=this;d._toolbar=this._canvasToolbar;d._hParent=this._frameCanvasContent._hPanel;d._hParent.style.backgroundColor="#333333";d._hParent.style.scroll="auto";d.addLoadListener(this,this.onDataLoaded);
d.build(b);this._frameCanvasContent.push(d)};with(MO)MO.FDsPrivateModelMenuBar=function(b){b=RClass.inherits(this,b,FDsModelMenuBar);b._frameName="resource.private.model.MenuBar";b.onBuilded=FDsPrivateModelMenuBar_onBuilded;return b},MO.FDsPrivateModelMenuBar_onBuilded=function(b){this.__base.FDsModelMenuBar.onBuilded.call(this,b);this._controlSaveButton.addClickListener(this,this.onSaveClick);this._controlCaptureButton.addClickListener(this,this.onCaptureClick)};
with(MO)MO.FDsPrivateTemplateCanvasToolBar=function(b){b=RClass.inherits(this,b,FDsTemplateCanvasToolBar);b._frameName="resource.private.template.CanvasToolBar";return b};with(MO)MO.FDsPrivateTemplateCatalogToolBar=function(b){b=RClass.inherits(this,b,FDsTemplateCatalogToolBar);b._frameName="resource.private.template.CatalogToolBar";return b};
with(MO)MO.FDsPrivateTemplateFrameSet=function(b){b=RClass.inherits(this,b,FDsTemplateFrameSet);b._frameName="resource.private.template.FrameSet";b.onBuilded=FDsPrivateTemplateFrameSet_onBuilded;b.onCatalogSelected=FDsPrivateTemplateFrameSet_onCatalogSelected;return b},MO.FDsPrivateTemplateFrameSet_onBuilded=function(b){this.__base.FDsTemplateFrameSet.onBuilded.call(this,b);var d=this._catalogToolBar=RClass.create(FDsPrivateTemplateCatalogToolBar);d._frameSet=this;d.buildDefine(b);this._frameCatalogToolBar.push(d);
d=this._catalogContent=RClass.create(FDsTemplateCatalogContent);d._frameSet=this;d.build(b);d.addSelectedListener(this,this.onCatalogSelected);this._frameCatalogContent.push(d);d=this._canvasToolBar=RClass.create(FDsPrivateTemplateCanvasToolBar);d._frameSet=this;d.buildDefine(b);this._frameCanvasToolBar.push(d);d=this._canvasContent=RClass.create(FDsTemplateCanvasContent);d._frameSet=this;d._toolbar=this._canvasToolbar;d._hParent=this._frameCanvasContent._hPanel;d._hParent.style.scroll="auto";d.addLoadListener(this,
this.onDataLoaded);d.build(b);this._frameCanvasContent.push(d)},MO.FDsPrivateTemplateFrameSet_onCatalogSelected=function(b,d){var f=this._activeSpace;if(f)if(this.hidePropertyFrames(),RClass.isClass(b,FE3dSpace)){var h=this.findPropertyFrame(EDsFrame.CommonSpacePropertyFrame);h.show();h.loadObject(f,b)}else if(RClass.isClass(b,FG3dTechnique))h=this.findPropertyFrame(EDsFrame.CommonTechniquePropertyFrame),h.show(),h.loadObject(f,b);else if(RClass.isClass(b,FE3dRegion))h=this.findPropertyFrame(EDsFrame.CommonRegionPropertyFrame),
h.show(),h.loadObject(f,b);else if(RClass.isClass(b,FE3dCamera))h=this.findPropertyFrame(EDsFrame.CommonCameraPropertyFrame),h.show(),h.loadObject(f,b);else if(RClass.isClass(b,FG3dDirectionalLight))h=this.findPropertyFrame(EDsFrame.CommonLightPropertyFrame),h.show(),h.loadObject(f,b);else if(RClass.isClass(b,FE3dTemplateDisplay))h=this.findPropertyFrame(EDsFrame.CommonDisplayPropertyFrame),h.show(),h.loadObject(f,b);else if(RClass.isClass(b,FG3dMaterial))h=this.findPropertyFrame(EDsFrame.CommonMaterialPropertyFrame),
h.show(),h.loadObject(f,b);else if(RClass.isClass(b,FE3dRenderable))h=this.findPropertyFrame(EDsFrame.CommonRenderablePropertyFrame),h.show(),h.loadObject(f,b);else throw new TError("Unknown select object type. (select={1})",b);};
with(MO)MO.FDsPrivateTemplateMenuBar=function(b){b=RClass.inherits(this,b,FDsTemplateMenuBar);b._frameName="resource.private.template.MenuBar";b.onBuilded=FDsPrivateTemplateMenuBar_onBuilded;return b},MO.FDsPrivateTemplateMenuBar_onBuilded=function(b){this.__base.FDsTemplateMenuBar.onBuilded.call(this,b);this._controlSave.addClickListener(this,this.onSaveClick);this._controlCapture.addClickListener(this,this.onCaptureClick);this._controlSelectMaterial.addClickListener(this,this.onSelectMaterialClick);
this._controlCreateDisplay.addClickListener(this,this.onCreateDisplayClick);this._controlDelete.addClickListener(this,this.onDeleteClick)};with(MO)MO.FDsPrivateSceneCanvasToolBar=function(b){b=RClass.inherits(this,b,FDsSceneCanvasToolBar);b._frameName="resource.private.scene.CanvasToolBar";return b};with(MO)MO.FDsPrivateSceneCatalogToolBar=function(b){b=RClass.inherits(this,b,FDsSceneCatalogToolBar);b._frameName="resource.private.scene.CatalogToolBar";return b};
with(MO)MO.FDsPrivateSceneFrameSet=function(b){b=RClass.inherits(this,b,FDsSceneFrameSet);b._frameName="resource.private.scene.FrameSet";b.onBuilded=FDsPrivateSceneFrameSet_onBuilded;return b},MO.FDsPrivateSceneFrameSet_onBuilded=function(b){this.__base.FDsSceneFrameSet.onBuilded.call(this,b);var d=this._catalogToolbar=RClass.create(FDsPrivateSceneCatalogToolBar);d._frameSet=this;d.buildDefine(b);this._frameCatalogToolBar.push(d);d=this._catalogContent=RClass.create(FDsSceneCatalogContent);d._frameSet=
this;d.build(b);d.addSelectedListener(this,this.onCatalogSelected);this._frameCatalogContent.push(d);d=this._canvasToolBar=RClass.create(FDsPrivateSceneCanvasToolBar);d._frameSet=this;d.buildDefine(b);this._frameCanvasToolBar.push(d);d=this._canvasContent=RClass.create(FDsSceneCanvasContent);d._frameSet=this;d._toolbar=this._canvasToolbar;d._hParent=this._frameCanvasContent._hPanel;d._hParent.style.backgroundColor="#333333";d._hParent.style.scroll="auto";d.addLoadListener(this,this.onDataLoaded);
d.build(b);this._frameCanvasContent.push(d);d=this._propertyToolbar=RClass.create(FDsScenePropertyToolBar);d._frameSet=this;d.buildDefine(b);this._framePropertyToolBar.push(d)};
with(MO)MO.FDsPrivateSceneMenuBar=function(b){b=RClass.inherits(this,b,FDsSceneMenuBar);b._frameName="resource.private.scene.MenuBar";b.onBuilded=FDsPrivateSceneMenuBar_onBuilded;return b},MO.FDsPrivateSceneMenuBar_onBuilded=function(b){this.__base.FDsSceneMenuBar.onBuilded.call(this,b);this._controlSave.addClickListener(this,this.onSaveClick);this._controlCapture.addClickListener(this,this.onCaptureClick);this._controlCreateLayer.addClickListener(this,this.onCreateLayerClick);this._controlImportTemplate.addClickListener(this,
this.onImportTemplateClick);this._controlExecute.addClickListener(this,this.onExecuteClick)};
with(MO)MO.FDsShareTabBar=function(b){b=RClass.inherits(this,b,FUiTabBar);b._frameName="resource.share.TabBar";b._resourceTypeCd="private";b._controlPrivateButton=null;b._controlTeamButton=null;b._controlShareButton=null;b.onBuilded=FDsShareTabBar_onBuilded;b.onButtonClick=FDsShareTabBar_onButtonClick;b.construct=FDsShareTabBar_construct;b.dispose=FDsShareTabBar_dispose;return b},MO.FDsShareTabBar_onBuilded=function(b){this.__base.FUiTabBar.onBuilded.call(this,b);this._controlResource.addClickListener(this,
this.onButtonClick)},MO.FDsShareTabBar_onButtonClick=function(b){"resource"==b.sender.name()?this._workspace.selectFrameSet(EDsFrameSet.ShareResourceFrameSet):alert("\u529f\u80fd\u672a\u5f00\u542f\uff0c\u8bf7\u4ee5\u540e\u5173\u6ce8\u3002")},MO.FDsShareTabBar_construct=function(){this.__base.FUiTabBar.construct.call(this)},MO.FDsShareTabBar_dispose=function(){this.__base.FUiTabBar.dispose.call(this)};
with(MO)MO.FDsShareWorkspace=function(b){b=RClass.inherits(this,b,FDuiWorkspace,MUiStorage);b._frameName="resource.share.Workspace";b._storageCode=b._frameName;b._styleMenubarGround=RClass.register(b,new AStyle("_styleMenubarGround","Menubar_Ground"));b._styleBodyGround=RClass.register(b,new AStyle("_styleBodyGround","Body_Ground"));b._styleStatusbarGround=RClass.register(b,new AStyle("_styleStatusbarGround","Statusbar_Ground"));b._activeFrameSetCode=null;b._activeProjectGuid=null;b._frameToolBar=
null;b._frameStatusBar=null;b._activeFrameSet=null;b._frameSets=null;b.onBuilded=FDsShareWorkspace_onBuilded;b.construct=FDsShareWorkspace_construct;b.selectFrameSet=FDsShareWorkspace_selectFrameSet;b.load=FDsShareWorkspace_load;b.dispose=FDsShareWorkspace_dispose;return b},MO.FDsShareWorkspace_onBuilded=function(b){this.__base.FDuiWorkspace.onBuilded.call(this,b);this._frameMenuBar._hPanel.className=this.styleName("Menubar_Ground");this._frameBody._hPanel.className=this.styleName("Body_Ground");
this._frameStatusBar._hPanel.className=this.styleName("Statusbar_Ground");var d=RBuilder.createTable(b);d.width="100%";var f=RBuilder.appendTableRow(d);this._hMenuPanel=RBuilder.appendTableCell(f);var h=this._tabBar=RClass.create(FDsShareTabBar);h._workspace=this;h.buildDefine(b);b=RBuilder.appendTableCell(f);b.width="100px";b.align="right";b.vAlign="bottom";b.appendChild(h._hPanel);this._frameMenuBar._hPanel.appendChild(d)},MO.FDsShareWorkspace_construct=function(){this.__base.FDuiWorkspace.construct.call(this);
this._frameSets=new TDictionary},MO.FDsShareWorkspace_selectFrameSet=function(b,d){var f=this._frameSets.get(b);if(!f){if(b==EDsFrameSet.ShareResourceFrameSet){var h=RClass.create(FDsShareResourceMenuBar);h._workspace=this;h.buildDefine(this._hPanel);f=RConsole.find(FUiFrameConsole).findByClass(this,FDsShareResourceFrameSet);f._workspace=this;f._menuBar=h;h._frameSet=f}else if(b==EDsFrameSet.ShareBitmapFrameSet)h=RClass.create(FDsShareBitmapMenuBar),h._workspace=this,h.buildDefine(this._hPanel),f=
RConsole.find(FUiFrameConsole).findByClass(this,FDsShareBitmapFrameSet),f._workspace=this,f._menuBar=h,h._frameSet=f;else if(b==EDsFrameSet.ShareMaterialFrameSet)h=RClass.create(FDsShareMaterialMenuBar),h._workspace=this,h.buildDefine(this._hPanel),f=RConsole.find(FUiFrameConsole).findByClass(this,FDsShareMaterialFrameSet),f._workspace=this,f._menuBar=h,h._frameSet=f;else if(b==EDsFrameSet.ShareModelFrameSet)h=RClass.create(FDsShareModelMenuBar),h._workspace=this,h.buildDefine(this._hPanel),f=RConsole.find(FUiFrameConsole).findByClass(this,
FDsShareModelFrameSet),f._workspace=this,f._menuBar=h,h._frameSet=f;else if(b==EDsFrameSet.ShareTemplateFrameSet)h=RClass.create(FDsShareTemplateMenuBar),h._workspace=this,h.buildDefine(this._hPanel),f=RConsole.find(FUiFrameConsole).findByClass(this,FDsShareTemplateFrameSet),f._workspace=this,f._menuBar=h,h._frameSet=f;else if(b==EDsFrameSet.ShareSceneFrameSet)h=RClass.create(FDsShareSceneMenuBar),h._workspace=this,h.buildDefine(this._hPanel),f=RConsole.find(FUiFrameConsole).findByClass(this,FDsShareSceneFrameSet),
f._workspace=this,f._menuBar=h,h._frameSet=f;else throw new TError("Unknown frameset. (name={1})",b);this._frameSets.set(b,f)}h=this._activeFrameSet;h!=f&&(h&&(this._hMenuPanel.removeChild(h._menuBar._hPanel),this._frameBody.remove(h)),this._hMenuPanel.appendChild(f._menuBar._hPanel),this._frameBody.push(f),f.psResize());this._activeFrameSet=f;switch(b){case EDsFrameSet.ShareResourceFrameSet:f.load();break;case EDsFrameSet.ShareBitmapFrameSet:case EDsFrameSet.ShareMaterialFrameSet:case EDsFrameSet.ShareModelFrameSet:case EDsFrameSet.ShareTemplateFrameSet:case EDsFrameSet.ShareSceneFrameSet:f.loadByGuid(d);
break;default:throw new TError("Unknown frameset. (name={1})",b);}this.storageSet("frameset_code",b);this.storageSet("frameset_guid",d);this.storageUpdate();return f},MO.FDsShareWorkspace_load=function(){this._activeFrameSetCode=this.storageGet("frameset_code",EDsFrameSet.ShareResourceFrameSet);this._activeFrameSetGuid=this.storageGet("frameset_guid");this._tabBar.findControl("resource").doClick()},MO.FDsShareWorkspace_dispose=function(){this._frameSets=RObject.dispose(this._frameSets);this.__base.FDuiWorkspace.dispose.call(this)};
with(MO)MO.FDsShareResourceCatalogContent=function(b){b=RClass.inherits(this,b,FUiDataTreeView,MListenerSelected);b._activeSpace=null;b._materials=null;b.onBuild=FDsShareResourceCatalogContent_onBuild;b.onLoadDisplay=FDsShareResourceCatalogContent_onLoadDisplay;b.onNodeClick=FDsShareResourceCatalogContent_onNodeClick;b.onNodeViewClick=FDsShareResourceCatalogContent_onNodeViewClick;b.onNodeViewDoubleClick=FDsShareResourceCatalogContent_onNodeViewDoubleClick;b.lsnsSelect=null;b.construct=FDsShareResourceCatalogContent_construct;
b.selectObject=FDsShareResourceCatalogContent_selectObject;b.showObject=FDsShareResourceCatalogContent_showObject;b.dispose=FDsShareResourceCatalogContent_dispose;return b},MO.FDsShareResourceCatalogContent_onBuild=function(b){this.__base.FUiDataTreeView.onBuild.call(this,b);this.addNodeClickListener(this,this.onNodeClick);this.loadUrl("/cloud.describe.tree.ws?action=query&code=resource.catalog")},MO.FDsShareResourceCatalogContent_onLoadDisplay=function(b){this.buildRenderable(b._linkNode,b)},MO.FDsShareResourceCatalogContent_onNodeClick=
function(b,d){},MO.FDsShareResourceCatalogContent_onNodeViewClick=function(b){},MO.FDsShareResourceCatalogContent_onNodeViewDoubleClick=function(b){},MO.FDsShareResourceCatalogContent_construct=function(){this.__base.FUiDataTreeView.construct.call(this);this._renderables=new TObjects;this._materials=new TObjects},MO.FDsShareResourceCatalogContent_selectObject=function(b){null!=b&&this.processSelectedListener(b,!0)},MO.FDsShareResourceCatalogContent_showObject=function(b){},MO.FDsShareResourceCatalogContent_dispose=
function(){this.__base.FUiDataTreeView.dispose.call(this)};
with(MO)MO.FDsShareResourceCatalogToolBar=function(b){b=RClass.inherits(this,b,FUiToolBar);b._frameName="resource.share.resource.CatalogToolBar";b._controlFolderOpenButton=null;b._controlFolderCloseButton=null;b._activeNodeGuid=null;b.onBuilded=FDsShareResourceCatalogToolBar_onBuilded;b.onFolderOpenClick=FDsShareResourceCatalogToolBar_onFolderOpenClick;b.onFolderCloseClick=FDsShareResourceCatalogToolBar_onFolderCloseClick;b.construct=FDsShareResourceCatalogToolBar_construct;b.dispose=FDsShareResourceCatalogToolBar_dispose;
return b},MO.FDsShareResourceCatalogToolBar_onBuilded=function(b){this.__base.FUiToolBar.onBuilded.call(this,b);this._controlFolderOpen.addClickListener(this,this.onFolderOpenClick);this._controlFolderClose.addClickListener(this,this.onFolderCloseClick)},MO.FDsShareResourceCatalogToolBar_onFolderOpenClick=function(b){},MO.FDsShareResourceCatalogToolBar_onFolderCloseClick=function(b){},MO.FDsShareResourceCatalogToolBar_construct=function(){this.__base.FUiToolBar.construct.call(this)},MO.FDsShareResourceCatalogToolBar_dispose=
function(){this.__base.FUiToolBar.dispose.call(this)};
with(MO)MO.FDsShareResourceFrameSet=function(b){b=RClass.inherits(this,b,FUiFrameSet);b._frameName="resource.share.resource.FrameSet";b._styleToolbarGround=RClass.register(b,new AStyle("_styleToolbarGround","Toolbar_Ground"));b._styleCatalogContent=RClass.register(b,new AStyle("_styleCatalogContent","Catalog_Content"));b._styleListContent=RClass.register(b,new AStyle("_styleListContent","List_Content"));b._stylePropertyContent=RClass.register(b,new AStyle("_stylePropertyContent","Property_Content"));
b._resourceTypeCd="picture";b._frameCatalog=null;b._frameCatalogToolbar=null;b._frameCatalogContent=null;b._frameSearch=null;b._frameSearchToolbar=null;b._frameSearchContent=null;b._framePreview=null;b._framePreviewToolbar=null;b._framePreviewContent=null;b._propertyFrames=null;b.onBuilded=FDsShareResourceFrameSet_onBuilded;b.onCatalogSelected=FDsShareResourceFrameSet_onCatalogSelected;b.construct=FDsShareResourceFrameSet_construct;b.findPropertyFrame=FDsShareResourceFrameSet_findPropertyFrame;b.switchContent=
FDsShareResourceFrameSet_switchContent;b.load=FDsShareResourceFrameSet_load;b.dispose=FDsShareResourceFrameSet_dispose;return b},MO.FDsShareResourceFrameSet_onBuilded=function(b){this.__base.FUiFrameSet.onBuilded.call(this,b);this._frameCatalogToolBar._hPanel.className=this.styleName("Toolbar_Ground");this._frameCatalogContent._hPanel.className=this.styleName("Catalog_Content");this._frameListToolBar._hPanel.className=this.styleName("Toolbar_Ground");this._frameListContent._hPanel.className=this.styleName("List_Content");
var d=this._catalogSplitter=this.searchControl("catalogSpliter");d.setAlignCd(EUiAlign.Left);d.setSizeHtml(this._frameCatalog._hPanel);d=this._catalogToolbar=RClass.create(FDsShareResourceCatalogToolBar);d._workspace=this._workspace;d._frameSet=this;d.buildDefine(b);this._frameCatalogToolBar.push(d);d=this._catalogContent=RClass.create(FDsShareResourceCatalogContent);d._workspace=this._workspace;d._frameSet=this;d.build(b);this._frameCatalogContent.push(d);d=this._listToolBar=RClass.create(FDsShareResourceListToolBar);
d._workspace=this._workspace;d._frameSet=this;d.buildDefine(b);this._frameListToolBar.push(d);d=this._listContent=RClass.create(FDsShareResourceListContent);d._workspace=this._workspace;d._frameSet=this;d.build(b);this._frameListContent.push(d)},MO.FDsShareResourceFrameSet_onCatalogSelected=function(b,d){for(var f=this._activeSpace,h=this._propertyFrames,q=h.count(),w=0;w<q;w++){var z=h.value(w);z.hide()}if(RClass.isClass(b,FE3dStage))z=this.findPropertyFrame(EDsFrame.MeshSpacePropertyFrame),z.show(),
z.loadObject(f,f);else if(RClass.isClass(b,FG3dTechnique))z=this.findPropertyFrame(EDsFrame.MeshTechniquePropertyFrame),z.show(),z.loadObject(f,b);else if(RClass.isClass(b,FE3dRegion))z=this.findPropertyFrame(EDsFrame.MeshRegionPropertyFrame),z.show(),z.loadObject(f,b);else if(RClass.isClass(b,FE3dCamera))z=this.findPropertyFrame(EDsFrame.MeshCameraPropertyFrame),z.show(),z.loadObject(f,b);else if(RClass.isClass(b,FG3dDirectionalLight))z=this.findPropertyFrame(EDsFrame.MeshLightPropertyFrame),z.show(),
z.loadObject(f,b);else if(RClass.isClass(b,FE3dMeshDisplay))z=this.findPropertyFrame(EDsFrame.MeshDisplayPropertyFrame),z.show(),z.loadObject(f,b);else if(RClass.isClass(b,FG3dMaterial))z=this.findPropertyFrame(EDsFrame.MeshMaterialPropertyFrame),z.show(),z.loadObject(f,b);else if(RClass.isClass(b,FE3dMeshRenderable))z=this.findPropertyFrame(EDsFrame.MeshRenderablePropertyFrame),z.show(),z.loadObject(f,b);else throw new TError("Unknown select object type. (value={1})",b);},MO.FDsShareResourceFrameSet_construct=
function(){this.__base.FUiFrameSet.construct.call(this);this._propertyFrames=new TDictionary},MO.FDsShareResourceFrameSet_findPropertyFrame=function(b){var d=this._propertyFrames.get(b);d||(d=RConsole.find(FFrameConsole).get(this,b,this._framePreview._hContainer),d._workspace=this,this._propertyFrames.set(b,d));return d},MO.FDsShareResourceFrameSet_switchContent=function(b){this._resourceTypeCd=b;this._listContent.serviceSearch(b,"","",40,0)},MO.FDsShareResourceFrameSet_load=function(){this._listToolBar.storageLoad()},
MO.FDsShareResourceFrameSet_dispose=function(){this.__base.FUiFrameSet.dispose.call(this);this._propertyFrames.dispose();this._propertyFrames=null};
with(MO)MO.FDsShareResourceListContent=function(b){b=RClass.inherits(this,b,FUiListView);b._contentFlag=null;b._contentTypeCd=EE3sResource.All;b._contentSerach="";b._contentOrder="";b._contentPageSize=40;b._contentPageCount=0;b._contentPage=0;b._activeItem=null;b._activeGuid=null;b._refreshButton=null;b._saveButton=null;b._runButton=null;b.onServiceLoad=FDsShareResourceListContent_onServiceLoad;b.construct=FDsShareResourceListContent_construct;b.doClickItem=FDsShareResourceListContent_doClickItem;
b.doDoubleClickItem=FDsShareResourceListContent_doDoubleClickItem;b.serviceSearch=FDsShareResourceListContent_serviceSearch;b.serviceResearch=FDsShareResourceListContent_serviceResearch;b.dispose=FDsShareResourceListContent_dispose;return b},MO.FDsShareResourceListContent_onServiceLoad=function(b){b=b.root.findNode("ResourceCollection");var d=b.getInteger("page_size"),f=b.getInteger("page_count"),h=b.getInteger("page");this._frameSet._listToolBar.setNavigator(d,f,h);this.clear();b=b.nodes();d=b.count();
for(f=0;f<d;f++)if(h=b.getAt(f),h.isName("Resource")){var q=this.createItem(FDsShareResourceListItem);q.propertyLoad(h);q._guid=h.get("guid");q._typeCd=h.get("type_cd");q._shareCd=h.get("share_cd");q._code=h.get("code");q._updateDate=h.get("update_date");q.setTypeLabel(q._typeCd);q.setLabel(h.get("code")+" - "+h.get("label"));q.refreshStyle();this.push(q)}RConsole.find(FUiDesktopConsole).hide()},MO.FDsShareResourceListContent_construct=function(){this.__base.FUiListView.construct.call(this)},MO.FDsShareResourceListContent_doClickItem=
function(b){this.__base.FUiListView.doClickItem.call(this,b)},MO.FDsShareResourceListContent_doDoubleClickItem=function(b){this.__base.FUiListView.doDoubleClickItem.call(this,b);var d=b._guid;this._activeItem=b;this._activeGuid=b._guid;var f=this._frameSet._workspace;b=b._typeCd;if(b==EE3sResource.Bitmap)f.selectFrameSet(EDsFrameSet.ShareBitmapFrameSet,d);else if(b==EE3sResource.Material)f.selectFrameSet(EDsFrameSet.ShareMaterialFrameSet,d);else if(b==EE3sResource.Model)f.selectFrameSet(EDsFrameSet.ShareModelFrameSet,
d);else if(b==EE3sResource.Template)f.selectFrameSet(EDsFrameSet.ShareTemplateFrameSet,d);else if(b==EE3sResource.Scene)f.selectFrameSet(EDsFrameSet.ShareSceneFrameSet,d);else throw new TError(this,"Unsupport resource format.");},MO.FDsShareResourceListContent_serviceSearch=function(b,d,f,h,q){null==b&&(b=this._contentTypeCd);null==d&&(d=this._contentSerach);null==f&&(f=this._contentOrder);null==h&&(h=this._contentPageSize);null==q&&(q=this._contentPage);var w=b+"|"+d+"|"+f+"|"+h+"|"+q;this._contentFlag!=
w&&(this._contentFlag=w,this._contentTypeCd=b,this._contentSerach=d,this._contentOrder=f,this._contentPageSize=h,this._contentPage=q,RConsole.find(FUiDesktopConsole).showLoading(),RConsole.find(FDrResourceConsole).doListShare(this._contentTypeCd,this._contentSerach,this._contentOrder,this._contentPageSize,this._contentPage).addLoadListener(this,this.onServiceLoad))},MO.FDsShareResourceListContent_serviceResearch=function(){this.serviceSearch(this._contentTypeCd,this._contentSerach,this._contentOrder,
this._contentPageSize,this._contentPage)},MO.FDsShareResourceListContent_dispose=function(){this.__base.FUiListView.dispose.call(this)};with(MO)MO.FDsShareResourceListItem=function(b){return b=RClass.inherits(this,b,FDsResourceListItem)};with(MO)MO.FDsShareResourceListToolBar=function(b){b=RClass.inherits(this,b,FDsResourceListToolBar);b._frameName="resource.share.resource.ListToolBar";b._storageCode=b._frameName;return b};
with(MO)MO.FDsShareResourceMenuBar=function(b){b=RClass.inherits(this,b,FUiMenuBar);b._frameName="resource.share.resource.MenuBar";b._controlRefresh=null;b.onBuilded=FDsShareResourceMenuBar_onBuilded;b.onRefreshClick=FDsShareResourceMenuBar_onRefreshClick;b.construct=FDsShareResourceMenuBar_construct;b.dispose=FDsShareResourceMenuBar_dispose;return b},MO.FDsShareResourceMenuBar_onBuilded=function(b){this.__base.FUiMenuBar.onBuilded.call(this,b);this._controlRefresh.addClickListener(this,this.onRefreshClick)},
MO.FDsShareResourceMenuBar_onRefreshClick=function(b){},MO.FDsShareResourceMenuBar_construct=function(){this.__base.FUiMenuBar.construct.call(this)},MO.FDsShareResourceMenuBar_dispose=function(){this.__base.FUiMenuBar.dispose.call(this)};with(MO)MO.FDsShareResourcePropertyContent=function(b){return b=RClass.inherits(this,b,FDsResourcePropertyContent)};
with(MO)MO.FDsShareResourcePropertyToolBar=function(b){b=RClass.inherits(this,b,FUiToolBar);b._frameName="resource.resource.PropertyToolBar";b._controlInsertButton=null;b._controlUpdateButton=null;b._controlDeleteButton=null;b._controlRotationButton=null;b.onBuilded=FDsShareResourcePropertyToolBar_onBuilded;b.onUpdateClick=FDsShareResourcePropertyToolBar_onUpdateClick;b.onRotationClick=FDsShareResourcePropertyToolBar_onRotationClick;b.construct=FDsShareResourcePropertyToolBar_construct;b.dispose=
FDsShareResourcePropertyToolBar_dispose;return b},MO.FDsShareResourcePropertyToolBar_onBuilded=function(b){this.__base.FUiToolBar.onBuilded.call(this,b);this._controlUpdateButton.addClickListener(this,this.onUpdateClick);this._controlRotationButton.addClickListener(this,this.onRotationClick)},MO.FDsShareResourcePropertyToolBar_onUpdateClick=function(b){},MO.FDsShareResourcePropertyToolBar_onRotationClick=function(b){this._workspace._previewContent.switchRotation(b.checked)},MO.FDsShareResourcePropertyToolBar_construct=
function(){this.__base.FUiToolBar.construct.call(this)},MO.FDsShareResourcePropertyToolBar_dispose=function(){this.__base.FUiToolBar.dispose.call(this)};
with(MO)MO.FDsShareResourceTabBar=function(b){b=RClass.inherits(this,b,FUiTabBar);b._frameName="design3d.resource.TabBar";b._resourceTypeCd="mesh";b._controlPictureButton=null;b._controlSoundButton=null;b._controlVidioButton=null;b._controlTextureButton=null;b._controlMaterialButton=null;b._controlMeshButton=null;b._controlModelButton=null;b._controlTemplateButton=null;b._controlSceneButton=null;b.onBuilded=FDsShareResourceTabBar_onBuilded;b.onButtonClick=FDsShareResourceTabBar_onButtonClick;b.construct=
FDsShareResourceTabBar_construct;b.dispose=FDsShareResourceTabBar_dispose;return b},MO.FDsShareResourceTabBar_onBuilded=function(b){this.__base.FUiTabBar.onBuilded.call(this,b);this._controlPictureButton.addClickListener(this,this.onButtonClick);this._controlSoundButton.addClickListener(this,this.onButtonClick);this._controlVidioButton.addClickListener(this,this.onButtonClick);this._controlTextureButton.addClickListener(this,this.onButtonClick);this._controlMaterialButton.addClickListener(this,this.onButtonClick);
this._controlMeshButton.addClickListener(this,this.onButtonClick);this._controlModelButton.addClickListener(this,this.onButtonClick);this._controlTemplateButton.addClickListener(this,this.onButtonClick);this._controlSceneButton.addClickListener(this,this.onButtonClick)},MO.FDsShareResourceTabBar_onButtonClick=function(b){this._resourceTypeCd=b.sender.name()},MO.FDsShareResourceTabBar_construct=function(){this.__base.FUiTabBar.construct.call(this)},MO.FDsShareResourceTabBar_dispose=function(){this.__base.FUiTabBar.dispose.call(this)};
with(MO)MO.FDsShareResourceWorkspace=function(b){b=RClass.inherits(this,b,FDuiWorkspace);b._frameName="resource.share.resource.Workspace";b._styleToolbarGround=RClass.register(b,new AStyle("_styleToolbarGround","Toolbar_Ground"));b._styleStatusbarGround=RClass.register(b,new AStyle("_styleStatusbarGround","Statusbar_Ground"));b._styleCatalogGround=RClass.register(b,new AStyle("_styleCatalogGround","Catalog_Ground"));b._styleCatalogToolbar=RClass.register(b,new AStyle("_styleCatalogToolbar","Catalog_Toolbar"));
b._styleSearchGround=RClass.register(b,new AStyle("_styleSearchGround","Search_Ground"));b._styleSearchToolbar=RClass.register(b,new AStyle("_styleCatalogToolbar","Search_Toolbar"));b._stylePreviewGround=RClass.register(b,new AStyle("_stylePreviewGround","Preview_Ground"));b._stylePreviewToolbar=RClass.register(b,new AStyle("_stylePreviewToolbar","Preview_Toolbar"));b._stylePropertyGround=RClass.register(b,new AStyle("_stylePropertyGround","Property_Ground"));b._styleWorkspaceGround=RClass.register(b,
new AStyle("_styleWorkspaceGround","Workspace_Ground"));b._resourceTypeCd="picture";b._frameToolBar=null;b._frameStatusBar=null;b._frameCatalog=null;b._frameCatalogToolbar=null;b._frameCatalogContent=null;b._frameSearch=null;b._frameSearchToolbar=null;b._frameSearchContent=null;b._framePreview=null;b._framePreviewToolbar=null;b._framePreviewContent=null;b._propertyFrames=null;b.onBuilded=FDsShareResourceWorkspace_onBuilded;b.onMeshLoad=FDsShareResourceWorkspace_onMeshLoad;b.onCatalogSelected=FDsShareResourceWorkspace_onCatalogSelected;
b.construct=FDsShareResourceWorkspace_construct;b.findPropertyFrame=FDsShareResourceWorkspace_findPropertyFrame;b.switchContent=FDsShareResourceWorkspace_switchContent;b.load=FDsShareResourceWorkspace_load;b.dispose=FDsShareResourceWorkspace_dispose;return b},MO.FDsShareResourceWorkspace_onBuilded=function(b){this.__base.FDuiWorkspace.onBuilded.call(this,b);var d=this._frameToolBar=this.searchControl("toolbarFrame");d._hPanel.className=this.styleName("Toolbar_Ground");d=this._frameBody=this.searchControl("bodyFrame");
d._hPanel.className=this.styleName("Catalog_Ground");d=this._frameStatusBar=this.searchControl("statusFrame");d._hPanel.className=this.styleName("Statusbar_Ground");d=RBuilder.createTable(b);d.width="100%";var f=RBuilder.appendTableRow(d),h=this._toolbar=RClass.create(FDsShareResourceMenuBar);h._workspace=this;h.buildDefine(b);var q=RBuilder.appendTableCell(f);q.appendChild(h._hPanel);h=this._tabBar=RClass.create(FDsShareResourceTabBar);h._workspace=this;h.buildDefine(b);q=RBuilder.appendTableCell(f);
q.width="450px";q.align="right";q.vAlign="bottom";q.appendChild(h._hPanel);this._frameToolBar._hPanel.appendChild(d);d=this._frameSet=RClass.create(FDsShareResourceFrameSet);d._workspace=this;d.buildDefine(b);this._frameBody.push(d);d.switchContent(this._resourceTypeCd)},MO.FDsShareResourceWorkspace_onMeshLoad=function(b){this._activeSpace=b._activeSpace;this._catalog.buildSpace(this._activeSpace)},MO.FDsShareResourceWorkspace_onCatalogSelected=function(b,d){for(var f=this._activeSpace,h=this._propertyFrames,
q=h.count(),w=0;w<q;w++){var z=h.value(w);z.hide()}if(RClass.isClass(b,FE3dStage))z=this.findPropertyFrame(EDsFrame.MeshSpacePropertyFrame),z.show(),z.loadObject(f,f);else if(RClass.isClass(b,FG3dTechnique))z=this.findPropertyFrame(EDsFrame.MeshTechniquePropertyFrame),z.show(),z.loadObject(f,b);else if(RClass.isClass(b,FE3dRegion))z=this.findPropertyFrame(EDsFrame.MeshRegionPropertyFrame),z.show(),z.loadObject(f,b);else if(RClass.isClass(b,FE3dCamera))z=this.findPropertyFrame(EDsFrame.MeshCameraPropertyFrame),
z.show(),z.loadObject(f,b);else if(RClass.isClass(b,FG3dDirectionalLight))z=this.findPropertyFrame(EDsFrame.MeshLightPropertyFrame),z.show(),z.loadObject(f,b);else if(RClass.isClass(b,FE3dMeshDisplay))z=this.findPropertyFrame(EDsFrame.MeshDisplayPropertyFrame),z.show(),z.loadObject(f,b);else if(RClass.isClass(b,FG3dMaterial))z=this.findPropertyFrame(EDsFrame.MeshMaterialPropertyFrame),z.show(),z.loadObject(f,b);else if(RClass.isClass(b,FE3dMeshRenderable))z=this.findPropertyFrame(EDsFrame.MeshRenderablePropertyFrame),
z.show(),z.loadObject(f,b);else throw new TError("Unknown select object type. (value={1})",b);},MO.FDsShareResourceWorkspace_construct=function(){this.__base.FDuiWorkspace.construct.call(this);this._propertyFrames=new TDictionary},MO.FDsShareResourceWorkspace_findPropertyFrame=function(b){var d=this._propertyFrames.get(b);d||(d=RConsole.find(FFrameConsole).get(this,b,this._framePreview._hContainer),d._workspace=this,this._propertyFrames.set(b,d));return d},MO.FDsShareResourceWorkspace_switchContent=
function(b){this._frameSet.switchContent(b)},MO.FDsShareResourceWorkspace_load=function(){},MO.FDsShareResourceWorkspace_dispose=function(){this.__base.FDuiWorkspace.dispose.call(this);this._propertyFrames.dispose();this._propertyFrames=null};with(MO)MO.FDsShareBitmapCanvasContent=function(b){return b=RClass.inherits(this,b,FDsBitmapCanvasContent)};
with(MO)MO.FDsShareBitmapCanvasToolBar=function(b){b=RClass.inherits(this,b,FDsBitmapCanvasToolBar);b._frameName="resource.share.bitmap.CanvasToolBar";return b};
with(MO)MO.FDsShareBitmapFrameSet=function(b){b=RClass.inherits(this,b,FDsBitmapFrameSet);b._frameName="resource.share.bitmap.FrameSet";b.onBuilded=FDsShareBitmapFrameSet_onBuilded;return b},MO.FDsShareBitmapFrameSet_onBuilded=function(b){this.__base.FDsBitmapFrameSet.onBuilded.call(this,b);var d=this._canvasToolbar=RClass.create(FDsShareBitmapCanvasToolBar);d._frameSet=this;d.buildDefine(b);this._frameCanvasToolBar.push(d);d=this._canvasContent=RClass.create(FDsBitmapCanvasContent);d._frameSet=this;
d._hParent=this._frameCanvasContent._hPanel;d._hParent.style.backgroundColor="#333333";d._hParent.style.scroll="auto";d.build(b);this._frameCanvasContent.push(d);d=this._propertyToolbar=RClass.create(FDsBitmapPropertyToolBar);d._frameSet=this;d.buildDefine(b);this._framePropertyToolBar.push(d);b=this.findPropertyFrame(EDsFrame.BitmapPropertyFrame);this._framePropertyContent.push(b)};
with(MO)MO.FDsShareBitmapMenuBar=function(b){b=RClass.inherits(this,b,FDsBitmapMenuBar);b._frameName="resource.share.bitmap.MenuBar";b.onBuilded=FDsShareBitmapMenuBar_onBuilded;b.onBackClick=FDsShareBitmapMenuBar_onBackClick;return b},MO.FDsShareBitmapMenuBar_onBuilded=function(b){this.__base.FDsBitmapMenuBar.onBuilded.call(this,b);this._controlBack.addClickListener(this,this.onBackClick)},MO.FDsShareBitmapMenuBar_onBackClick=function(b){this._frameSet._workspace.selectFrameSet(EDsFrameSet.ShareResourceFrameSet)};
with(MO)MO.FDsShareBitmapPropertyToolBar=function(b){b=RClass.inherits(this,b,FDsBitmapPropertyToolBar);b._frameName="resource.share.bitmap.PropertyToolBar";return b};with(MO)MO.FDsShareBitmapWorkspace=function(b){b=RClass.inherits(this,b,FDsBitmapWorkspace);b._frameName="resource.share.bitmap.Workspace";return b};with(MO)MO.FDsShareMaterialCanvasToolBar=function(b){b=RClass.inherits(this,b,FDsMaterialCanvasToolBar);b._frameName="resource.share.materail.CanvasToolBar";return b};
with(MO)MO.FDsShareMaterialFrameSet=function(b){b=RClass.inherits(this,b,FDsMaterialFrameSet);b._frameName="resource.share.material.FrameSet";b.onBuilded=FDsShareMaterialFrameSet_onBuilded;return b},MO.FDsShareMaterialFrameSet_onBuilded=function(b){this.__base.FDsMaterialFrameSet.onBuilded.call(this,b);var d=this._toolbar=RClass.create(FDsShareMaterialMenuBar);d._frameSet=this;d.buildDefine(b);this._frameToolBar.push(d);d=this._catalogContent=RClass.create(FDsMaterialCatalogContent);d._frameSet=this;
d.build(b);d.addSelectedListener(this,this.onCatalogSelected);this._frameCatalogContent.push(d);d=this._canvasToolbar=RClass.create(FDsShareMaterialCanvasToolBar);d._frameSet=this;d.buildDefine(b);this._frameCanvasToolBar.push(d);d=this._canvasContent=RClass.create(FDsMaterialCanvasContent);d._frameSet=this;d._toolbar=this._canvasToolbar;d._hParent=this._frameCanvasContent._hPanel;d._hParent.style.backgroundColor="#333333";d._hParent.style.scroll="auto";d.addLoadListener(this,this.onDataLoaded);d.build(b);
this._frameCanvasContent.push(d)};with(MO)MO.FDsShareMaterialMenuBar=function(b){b=RClass.inherits(this,b,FDsMaterialMenuBar);b._frameName="resource.share.material.MenuBar";return b};with(MO)MO.FDsShareModelCanvasToolBar=function(b){b=RClass.inherits(this,b,FDsModelCanvasToolBar);b._frameName="resource.share.model.CanvasToolBar";return b};with(MO)MO.FDsShareModelCatalogToolBar=function(b){b=RClass.inherits(this,b,FDsModelCatalogToolBar);b._frameName="resource.share.model.CatalogToolBar";return b};
with(MO)MO.FDsShareModelFrameSet=function(b){b=RClass.inherits(this,b,FDsModelFrameSet);b._frameName="resource.share.model.FrameSet";b.onBuilded=FDsShareModelFrameSet_onBuilded;return b},MO.FDsShareModelFrameSet_onBuilded=function(b){this.__base.FDsModelFrameSet.onBuilded.call(this,b);var d=this._catalogToolbar=RClass.create(FDsShareModelCatalogToolBar);d._frameSet=this;d.buildDefine(b);this._frameCatalogToolBar.push(d);d=this._catalogContent=RClass.create(FDsModelCatalogContent);d._frameSet=this;
d.build(b);d.addSelectedListener(this,this.onCatalogSelected);this._frameCatalogContent.push(d);d=this._canvasToolbar=RClass.create(FDsShareModelCanvasToolBar);d._frameSet=this;d.buildDefine(b);this._frameCanvasToolBar.push(d);d=this._canvasContent=RClass.create(FDsModelCanvasContent);d._frameSet=this;d._toolbar=this._canvasToolbar;d._hParent=this._frameCanvasContent._hPanel;d._hParent.style.backgroundColor="#333333";d._hParent.style.scroll="auto";d.addLoadListener(this,this.onDataLoaded);d.build(b);
this._frameCanvasContent.push(d)};with(MO)MO.FDsShareModelMenuBar=function(b){b=RClass.inherits(this,b,FDsModelMenuBar);b._frameName="resource.share.model.MenuBar";b.onBuilded=FDsShareModelMenuBar_onBuilded;return b},MO.FDsShareModelMenuBar_onBuilded=function(b){this.__base.FDsModelMenuBar.onBuilded.call(this,b)};
with(MO)MO.FDsShareTemplateCanvasToolBar=function(b){b=RClass.inherits(this,b,FUiToolBar);b._frameName="resource.share.template.CanvasToolBar";b._refreshButton=null;b._saveButton=null;b._canvasModeCd=EDsCanvasMode.Drop;b.onBuilded=FDsShareTemplateCanvasToolBar_onBuilded;b.onModeClick=FDsShareTemplateCanvasToolBar_onModeClick;b.onLookClick=FDsShareTemplateCanvasToolBar_onLookClick;b.onPlayClick=FDsShareTemplateCanvasToolBar_onPlayClick;b.onViewClick=FDsShareTemplateCanvasToolBar_onViewClick;b.construct=
FDsShareTemplateCanvasToolBar_construct;b.dispose=FDsShareTemplateCanvasToolBar_dispose;return b},MO.FDsShareTemplateCanvasToolBar_onBuilded=function(b){this.__base.FUiToolBar.onBuilded.call(this,b);this._controlModeDrop.addClickListener(this,this.onModeClick);this._controlModeSelect.addClickListener(this,this.onModeClick);this._controlTranslate.addClickListener(this,this.onModeClick);this._controlRotation.addClickListener(this,this.onModeClick);this._controlScale.addClickListener(this,this.onModeClick);
this._controlLookFront.addClickListener(this,this.onLookClick);this._controlLookUp.addClickListener(this,this.onLookClick);this._controlLookLeft.addClickListener(this,this.onLookClick);this._controlPlay.addClickListener(this,this.onPlayClick);this._controlView.addClickListener(this,this.onViewClick)},MO.FDsShareTemplateCanvasToolBar_onModeClick=function(b){this._canvasModeCd=b._canvasModeCd},MO.FDsShareTemplateCanvasToolBar_onLookClick=function(b){this._canvasModeCd=b._canvasModeCd},MO.FDsShareTemplateCanvasToolBar_onPlayClick=
function(b,d){this._frameSet._canvasContent._rotationAble=d},MO.FDsShareTemplateCanvasToolBar_onViewClick=function(b,d){this._frameSet._canvasContent._rotationAble=d},MO.FDsShareTemplateCanvasToolBar_construct=function(){this.__base.FUiToolBar.construct.call(this)},MO.FDsShareTemplateCanvasToolBar_dispose=function(){this.__base.FUiToolBar.dispose.call(this)};
with(MO)MO.FDsShareTemplateCatalogToolBar=function(b){b=RClass.inherits(this,b,FDsTemplateCatalogToolBar);b._frameName="resource.share.template.CatalogToolBar";return b};
with(MO)MO.FDsShareTemplateFrameSet=function(b){b=RClass.inherits(this,b,FDsTemplateFrameSet);b._frameName="resource.share.template.FrameSet";b.onBuilded=FDsShareTemplateFrameSet_onBuilded;return b},MO.FDsShareTemplateFrameSet_onBuilded=function(b){this.__base.FDsTemplateFrameSet.onBuilded.call(this,b);var d=this._catalogToolbar=RClass.create(FDsShareTemplateCatalogToolBar);d._frameSet=this;d.buildDefine(b);this._frameCatalogToolBar.push(d);d=this._catalogContent=RClass.create(FDsTemplateCatalogContent);
d._frameSet=this;d.build(b);d.addSelectedListener(this,this.onCatalogSelected);this._frameCatalogContent.push(d);d=this._canvasToolbar=RClass.create(FDsShareTemplateCanvasToolBar);d._frameSet=this;d._workspace=this._worksapce;d.buildDefine(b);this._frameCanvasToolBar.push(d);d=this._canvasContent=RClass.create(FDsTemplateCanvasContent);d._frameSet=this;d._toolbar=this._canvasToolbar;d._hParent=this._frameCanvasContent._hPanel;d._hParent.style.backgroundColor="#333333";d._hParent.style.scroll="auto";
d.addLoadListener(this,this.onDataLoaded);d.build(b);this._frameCanvasContent.push(d)};with(MO)MO.FDsShareTemplateMenuBar=function(b){b=RClass.inherits(this,b,FDsTemplateMenuBar);b._frameName="resource.share.template.MenuBar";b.onBuilded=FDsShareTemplateMenuBar_onBuilded;return b},MO.FDsShareTemplateMenuBar_onBuilded=function(b){this.__base.FDsTemplateMenuBar.onBuilded.call(this,b)};
with(MO)MO.FDsShareTemplateToolBar=function(b){return b=RClass.inherits(this,b,FDsTemplateToolBar)},MO.FDsShareTemplateToolBar_onBuild=function(b){this.__base.FUiToolBar.onBuild.call(this,b);var d=this._refreshButton=RClass.create(FUiToolButton);d.setLabel("\u5237\u65b0");d.setIcon("design3d.tools.refresh");d.build(b);d.addClickListener(this,this.onRefreshClick);this.push(d);d=this._saveButton=RClass.create(FUiToolButton);d.setLabel("\u4fdd\u5b58");d.setIcon("design3d.tools.save");d.build(b);d.addClickListener(this,
this.onSaveClick);this.push(d)},MO.FDsShareTemplateToolBar_onRefreshClick=function(b){},MO.FDsShareTemplateToolBar_onSaveClick=function(b){var d=this._workspace._activeTemplate;b=d._resource.themes();for(var f=b.count(),h=new TXmlNode,q=0;q<f;q++)for(var d=b.get(q),d=d.materials(),w=d.count(),z=0;z<w;z++)d.value(z).saveConfig(h.create("Material"));RConsole.find(FE3sTemplateConsole).update(h)},MO.FDsShareTemplateToolBar_construct=function(){this.__base.FUiToolBar.construct.call(this)},MO.FDsShareTemplateToolBar_dispose=
function(){this.__base.FUiToolBar.dispose.call(this)};with(MO)MO.FDsShareSceneCanvasToolBar=function(b){b=RClass.inherits(this,b,FDsSceneCanvasToolBar);b._frameName="resource.share.scene.CanvasToolBar";return b};with(MO)MO.FDsShareSceneCatalogToolBar=function(b){b=RClass.inherits(this,b,FDsSceneCatalogToolBar);b._frameName="resource.share.scene.CatalogToolBar";return b};
with(MO)MO.FDsShareSceneFrameSet=function(b){b=RClass.inherits(this,b,FDsSceneFrameSet);b._frameName="resource.share.scene.FrameSet";b.onBuilded=FDsShareSceneFrameSet_onBuilded;return b},MO.FDsShareSceneFrameSet_onBuilded=function(b){this.__base.FDsSceneFrameSet.onBuilded.call(this,b);var d=this._catalogToolbar=RClass.create(FDsShareSceneCatalogToolBar);d._frameSet=this;d.buildDefine(b);this._frameCatalogToolBar.push(d);d=this._catalogContent=RClass.create(FDsSceneCatalogContent);d._frameSet=this;
d.build(b);d.addSelectedListener(this,this.onCatalogSelected);this._frameCatalogContent.push(d);d=this._canvasToolbar=RClass.create(FDsShareSceneCanvasToolBar);d._frameSet=this;d.buildDefine(b);this._frameCanvasToolBar.push(d);d=this._canvasContent=RClass.create(FDsSceneCanvasContent);d._frameSet=this;d._toolbar=this._canvasToolbar;d._hParent=this._frameCanvasContent._hPanel;d._hParent.style.backgroundColor="#333333";d._hParent.style.scroll="auto";d.addLoadListener(this,this.onDataLoaded);d.build(b);
this._frameCanvasContent.push(d);d=this._propertyToolbar=RClass.create(FDsScenePropertyToolBar);d._frameSet=this;d.buildDefine(b);this._framePropertyToolBar.push(d)};with(MO)MO.FDsShareSceneMenuBar=function(b){b=RClass.inherits(this,b,FDsSceneMenuBar);b._frameName="resource.share.scene.MenuBar";b.onBuilded=FDsShareSceneMenuBar_onBuilded;return b},MO.FDsShareSceneMenuBar_onBuilded=function(b){this.__base.FDsSceneMenuBar.onBuilded.call(this,b);this._controlExecute.addClickListener(this,this.onExecuteClick)};
MO.FDssCanvas=function(b){b=MO.Class.inherits(this,b,MO.FE3dCanvas);b._optionStageProcess=!1;b._optionResize=!1;b._optionMouseCapture=!1;b._optionAlpha=!0;b._optionAntialias=!1;b._capturePosition=null;b._cameraPosition=null;b._scaleRate=1;b._activeStage=MO.Class.register(b,new MO.AGetter("_activeStage"));b._capturePosition=null;b._captureRotation=null;b.construct=MO.FDssCanvas_construct;b.setPanel=MO.FDssCanvas_setPanel;b.resize=MO.FDssCanvas_resize;b.selectStage=MO.FDssCanvas_selectStage;b.dispose=
MO.FDssCanvas_dispose;return b};MO.FDssCanvas_construct=function(){this.__base.FE3dCanvas.construct.call(this);this._rotation=new MO.SVector3;this._capturePosition=new MO.SPoint2;this._captureRotation=new MO.SVector3;this._logicSize=new MO.SSize2(1920,1080);this._cameraPosition=new MO.SPoint3};MO.FDssCanvas_setPanel=function(b){this._hPanel=b;b.appendChild(this._hCanvas)};
MO.FDssCanvas_resize=function(b,d){this.__base.FE3dCanvas.resize.call(this,b,d);var f=this._graphicContext.size(),h=this._activeStage;h&&(h=h.camera().projection(),h.size().set(f.width,f.height),h.update())};
MO.FDssCanvas_selectStage=function(b){if(b){b.linkGraphicContext(this);b.region().linkGraphicContext(this);b.selectTechnique(this,MO.FE3dGeneralTechnique);var d=b.region().camera(),f=d.projection();f.setAngle(80);f.size().set(this._hCanvas.offsetWidth,this._hCanvas.offsetHeight);f.update();d.position().set(0,0,-10);d.lookAt(0,0,0);d.update()}this._activeStage=b};
MO.FDssCanvas_dispose=function(){this._rotation=MO.Lang.Object.dispose(this._rotation);this._capturePosition=MO.Lang.Object.dispose(this._capturePosition);this._captureRotation=MO.Lang.Object.dispose(this._captureRotation);this.__base.FE3dCanvas.dispose.call(this)};
MO.FDssDesktop=function(b){b=MO.Class.inherits(this,b,MO.FDesktop);b._canvas3d=MO.Class.register(b,new MO.AGetter("_canvas3d"));b._canvas2d=MO.Class.register(b,new MO.AGetter("_canvas2d"));b.onOperationResize=MO.FDssDesktop_onOperationResize;b.onOperationOrientation=MO.FDssDesktop_onOperationOrientation;b.construct=MO.FDssDesktop_construct;b.build=MO.FDssDesktop_build;b.resize=MO.FDssDesktop_resize;b.dispose=MO.FDssDesktop_dispose;return b};
MO.FDssDesktop_onOperationResize=function(b){this.__base.FDesktop.onOperationResize.call(this,b);this.resize()};MO.FDssDesktop_onOperationOrientation=function(){this.__base.FDesktop.onOperationOrientation.call(this,event);this.resize()};MO.FDssDesktop_construct=function(){this.__base.FDesktop.construct.call(this)};
MO.FDssDesktop_build=function(b){this.__base.FDesktop.build.call(this,b);var d=this._canvas3d=MO.RClass.create(MO.FDssCanvas);d.setDesktop(this);d.build(b);d.setPanel(b);this.canvasRegister(d);d=this._canvas2d=MO.RClass.create(MO.FE2dCanvas);d.setDesktop(this);d.build(b);d.setPanel(b);d._hCanvas.style.position="absolute";this.canvasRegister(d);MO.RE3dEngine.setup()};
MO.FDssDesktop_resize=function(b,d){var f=null!=b?b:window.innerWidth,h=null!=d?d:window.innerHeight;if(!this._screenSize.equalsData(f,h)){this._screenSize.set(f,h);var q=MO.Browser.capability().pixelRatio;MO.Logger.info(this,"Change screen size. (size={1}x{2}, pixel_ratio={3})",f,h,q);var f=f*q,h=h*q,w=q=1,z=this._logicSize;MO.Browser.isOrientationHorizontal()?(q=f/z.width,w=h/z.height,this._calculateSize.set(z.width,z.height)):(q=f/z.height,w=h/z.width,this._calculateSize.set(z.height,z.width));
z=this._sizeRate=Math.min(q,w);this._logicRate.set(q,w);q>w?this._calculateRate.set(q/z,1):q<w?this._calculateRate.set(1,w/z):this._calculateRate.set(1,1);this._canvas3d.resize(f,h);q=this._canvas2d;q.resize(f,h);q.graphicContext().setScale(z,z)}};MO.FDssDesktop_dispose=function(){this._canvas3d=MO.RObject.dispose(this._canvas3d);this._canvas2d=MO.RObject.dispose(this._canvas2d);this.__base.FDesktop.dispose.call(this)};
MO.FDssGuiManage=function(b){b=MO.Class.inherits(this,b,MO.FGuiCanvasManage);b.construct=MO.FDssGuiManage_construct;b.dispose=MO.FDssGuiManage_dispose;return b};MO.FDssGuiManage_construct=function(){this.__base.FGuiCanvasManage.construct.call(this)};MO.FDssGuiManage_dispose=function(){this.__base.FGuiCanvasManage.dispose.call(this)};
with(MO)MO.FDsSystemTabBar=function(b){b=RClass.inherits(this,b,FUiTabBar);b._frameName="system.design.TabBar";b._resourceTypeCd="private";b._controlPrivateButton=null;b._controlTeamButton=null;b._controlShareButton=null;b.onBuilded=FDsSystemTabBar_onBuilded;b.onButtonClick=FDsSystemTabBar_onButtonClick;b.construct=FDsSystemTabBar_construct;b.dispose=FDsSystemTabBar_dispose;return b},MO.FDsSystemTabBar_onBuilded=function(b){this.__base.FUiTabBar.onBuilded.call(this,b);this._controlPersistence.addClickListener(this,
this.onButtonClick);this._controlList.addClickListener(this,this.onButtonClick);this._controlTree.addClickListener(this,this.onButtonClick);this._controlFrame.addClickListener(this,this.onButtonClick)},MO.FDsSystemTabBar_onButtonClick=function(b){var d=this._workspace;b=b.sender.name();"persistence"==b?d.selectFrameSet(EDsFrameSet.SystemDesignPersistenceFrameSet):"list"==b?d.selectFrameSet(EDsFrameSet.SystemDesignListFrameSet):"tree"==b?d.selectFrameSet(EDsFrameSet.SystemDesignTreeFrameSet):"frame"==
b?d.selectFrameSet(EDsFrameSet.SystemDesignFrameFrameSet):alert("\u529f\u80fd\u672a\u5f00\u542f\uff0c\u8bf7\u4ee5\u540e\u5173\u6ce8\u3002")},MO.FDsSystemTabBar_construct=function(){this.__base.FUiTabBar.construct.call(this)},MO.FDsSystemTabBar_dispose=function(){this.__base.FUiTabBar.dispose.call(this)};
with(MO)MO.FDsSystemWorkspace=function(b){b=RClass.inherits(this,b,FDuiWorkspace,MUiStorage);b._frameName="system.design.Workspace";b._storageCode=b._frameName;b._styleMenuBarGround=RClass.register(b,new AStyle("_styleMenuBarGround","MenuBar_Ground"));b._styleBodyGround=RClass.register(b,new AStyle("_styleBodyGround","Body_Ground"));b._styleStatusBarGround=RClass.register(b,new AStyle("_styleStatusBarGround","StatusBar_Ground"));b._activeFrameSetCode=null;b._activeProjectGuid=null;b._frameToolBar=
null;b._frameStatusBar=null;b._activeFrameSet=null;b._frameSets=null;b.onBuilded=FDsSystemWorkspace_onBuilded;b.construct=FDsSystemWorkspace_construct;b.selectFrameSet=FDsSystemWorkspace_selectFrameSet;b.load=FDsSystemWorkspace_load;b.dispose=FDsSystemWorkspace_dispose;return b},MO.FDsSystemWorkspace_onBuilded=function(b){this.__base.FDuiWorkspace.onBuilded.call(this,b);this._frameMenuBar._hPanel.className=this.styleName("MenuBar_Ground");this._frameBody._hPanel.className=this.styleName("Body_Ground");
this._frameStatusBar._hPanel.className=this.styleName("StatusBar_Ground");var d=RBuilder.createTable(b);d.width="100%";var f=RBuilder.appendTableRow(d);this._hMenuPanel=RBuilder.appendTableCell(f);var h=this._tabBar=RClass.create(FDsSystemTabBar);h._workspace=this;h.buildDefine(b);b=RBuilder.appendTableCell(f);b.width="240px";b.align="right";b.vAlign="bottom";b.appendChild(h._hPanel);this._frameMenuBar._hPanel.appendChild(d)},MO.FDsSystemWorkspace_construct=function(){this.__base.FDuiWorkspace.construct.call(this);
this._frameSets=new TDictionary},MO.FDsSystemWorkspace_selectFrameSet=function(b,d){var f=this._frameSets.get(b);if(!f){if(b==EDsFrameSet.SystemDesignPersistenceFrameSet){var h=RClass.create(FDsSystemPersistenceMenuBar);h._workspace=this;h.buildDefine(this._hPanel);f=RConsole.find(FUiFrameConsole).findByClass(this,FDsSystemPersistenceFrameSet);f._workspace=this;f._menuBar=h;h._frameSet=f}else if(b==EDsFrameSet.SystemDesignListFrameSet)h=RClass.create(FDsSystemListMenuBar),h._workspace=this,h.buildDefine(this._hPanel),
f=RConsole.find(FUiFrameConsole).findByClass(this,FDsSystemListFrameSet),f._workspace=this,f._menuBar=h,h._frameSet=f;else if(b==EDsFrameSet.SystemDesignTreeFrameSet)h=RClass.create(FDsSystemTreeMenuBar),h._workspace=this,h.buildDefine(this._hPanel),f=RConsole.find(FUiFrameConsole).findByClass(this,FDsSystemTreeFrameSet),f._workspace=this,f._menuBar=h,h._frameSet=f;else if(b==EDsFrameSet.SystemDesignFrameFrameSet)h=RClass.create(FDsSystemFrameMenuBar),h._workspace=this,h.buildDefine(this._hPanel),
f=RConsole.find(FUiFrameConsole).findByClass(this,FDsSystemFrameFrameSet),f._workspace=this,f._menuBar=h,h._frameSet=f;else throw new TError("Unknown frameset. (name={1})",b);this._frameSets.set(b,f)}h=this._activeFrameSet;h!=f&&(h&&(this._hMenuPanel.removeChild(h._menuBar._hPanel),this._frameBody.remove(h)),this._hMenuPanel.appendChild(f._menuBar._hPanel),this._frameBody.push(f),f.psResize());this._activeFrameSet=f;switch(b){case EDsFrameSet.SystemDesignPersistenceFrameSet:f.load();break;case EDsFrameSet.SystemDesignListFrameSet:f.load();
break;case EDsFrameSet.SystemDesignTreeFrameSet:f.load();break;case EDsFrameSet.SystemDesignFrameFrameSet:f.load();break;default:throw new TError("Unknown frameset. (name={1})",b);}this.storageSet("frameset_code",b);this.storageSet("frameset_guid",d);this.storageUpdate();return f},MO.FDsSystemWorkspace_load=function(){var b=this._activeFrameSetCode=this.storageGet("frameset_code",EDsFrameSet.SolutionFrameSet),d=this._activeFrameSetGuid=this.storageGet("frameset_guid"),f=null;b==EDsFrameSet.SystemDesignPersistenceFrameSet?
(f=this._tabBar.findControl("persistence"),f.doClick()):b==EDsFrameSet.SystemDesignListFrameSet?(f=this._tabBar.findControl("list"),this._tabBar.select(f),this.selectFrameSet(b,d)):b==EDsFrameSet.SystemDesignTreeFrameSet?(f=this._tabBar.findControl("tree"),f.doClick()):b==EDsFrameSet.SystemDesignFrameFrameSet?(f=this._tabBar.findControl("frame"),this._tabBar.select(f),this.selectFrameSet(b,d)):(f=this._tabBar.findControl("frame"),f.doClick())},MO.FDsSystemWorkspace_dispose=function(){this._frameSets=
RObject.dispose(this._frameSets,!0);this.__base.FDuiWorkspace.dispose.call(this)};
with(MO)MO.FDsSystemDesignFrameSet=function(b){b=RClass.inherits(this,b,FDsFrameSet);b._styleToolbarGround=RClass.register(b,new AStyle("_styleToolbarGround","Toolbar_Ground"));b._styleCatalogContent=RClass.register(b,new AStyle("_styleCatalogContent","Catalog_Content"));b._styleSpaceContent=RClass.register(b,new AStyle("_styleSpaceContent","Space_Content"));b._stylePropertyContent=RClass.register(b,new AStyle("_stylePropertyContent","Property_Content"));b._frameCatalog=null;b._frameCatalogToolbar=
null;b._frameCatalogContent=null;b._frameSpace=null;b._frameSpaceToolbar=null;b._frameSpaceContent=null;b._frameProperty=null;b._framePropertyToolbar=null;b._framePropertyContent=null;b.construct=FDsSystemDesignFrameSet_construct;b.dispose=FDsSystemDesignFrameSet_dispose;return b},MO.FDsSystemDesignFrameSet_construct=function(){this.__base.FDsFrameSet.construct.call(this)},MO.FDsSystemDesignFrameSet_dispose=function(){this.__base.FDsFrameSet.dispose.call(this)};
with(MO)MO.FDsSystemPersistenceCatalogContent=function(b){b=RClass.inherits(this,b,FUiDataTreeView,MListenerSelected);b._activeFrame=null;b.onNodeClick=FDsSystemPersistenceCatalogContent_onNodeClick;b.construct=FDsSystemPersistenceCatalogContent_construct;b.selectObject=FDsSystemPersistenceCatalogContent_selectObject;b.showObject=FDsSystemPersistenceCatalogContent_showObject;b.dispose=FDsSystemPersistenceCatalogContent_dispose;return b},MO.FDsSystemPersistenceCatalogContent_onNodeClick=function(b){var d=
b.node;b=d.typeGroup();var f=d.type();d.typeCode();f=f.get("property_frame");d=d.label();b==EUiTreeNodeGroup.Container?(this._frameSet.load(d),this._frameSet.selectObject(b,f,null)):b==EUiTreeNodeGroup.Item&&this._frameSet.selectObject(b,f,d)},MO.FDsSystemPersistenceCatalogContent_construct=function(){this.__base.FUiDataTreeView.construct.call(this);this.loadUrl("/cloud.describe.tree.ws?action=query&code=system.design.persistence")},MO.FDsSystemPersistenceCatalogContent_selectObject=function(b){b&&
this.processSelectedListener(b,!0)},MO.FDsSystemPersistenceCatalogContent_showObject=function(b){if(RClass.isClass(b,FDsSceneRenderable))for(var d=this._renderableNodes,f=d.count(),h=0;h<f;h++)d.at(h).dataPropertyGet("linker")==b&&this.processSelectedListener(b,!1)},MO.FDsSystemPersistenceCatalogContent_dispose=function(){this._activeFrame=null;this.__base.FUiDataTreeView.dispose.call(this)};
with(MO)MO.FDsSystemPersistenceCatalogToolBar=function(b){b=RClass.inherits(this,b,FUiToolBar);b._frameName="system.design.frame.CatalogToolBar";b._controlFolderCreateButton=null;b._controlFolderDeleteButton=null;b._controlFolderPropertyButton=null;b._controlFolderOpenButton=null;b._controlFolderCloseButton=null;b._activeNodeGuid=null;b.onBuilded=FDsSystemPersistenceCatalogToolBar_onBuilded;b.onFolderCreateClick=FDsSystemPersistenceCatalogToolBar_onFolderCreateClick;b.onFolderDeleteLoad=FDsSystemPersistenceCatalogToolBar_onFolderDeleteLoad;
b.onFolderDeleteExcute=FDsSystemPersistenceCatalogToolBar_onFolderDeleteExcute;b.onFolderDeleteClick=FDsSystemPersistenceCatalogToolBar_onFolderDeleteClick;b.onFolderPropertyClick=FDsSystemPersistenceCatalogToolBar_onFolderPropertyClick;b.onFolderOpenClick=FDsSystemPersistenceCatalogToolBar_onFolderOpenClick;b.onFolderCloseClick=FDsSystemPersistenceCatalogToolBar_onFolderCloseClick;b.construct=FDsSystemPersistenceCatalogToolBar_construct;b.dispose=FDsSystemPersistenceCatalogToolBar_dispose;return b},
MO.FDsSystemPersistenceCatalogToolBar_onBuilded=function(b){this.__base.FUiToolBar.onBuilded.call(this,b)},MO.FDsSystemPersistenceCatalogToolBar_onFolderCreateClick=function(b){var d=b=null,f=this._frameSet._catalogContent.focusNode();f&&(b=f.guid(),d=f.label());f=RConsole.find(FUiWindowConsole).find(FDsResourceFolderDialog);f._workspace=this._workspace;f._frameSet=this._frameSet;f._parentGuid=b;f.setNodeParentLabel(d);f.setNodeLabel("");f.switchDataMode(EUiDataMode.Insert);f.showPosition(EUiPosition.Center)},
MO.FDsSystemPersistenceCatalogToolBar_onFolderDeleteLoad=function(b){RConsole.find(FUiDesktopConsole).hide();b=this._frameSet._catalogContent;var d=this._activeNodeGuid;d&&b.findByGuid(d).removeSelf();this._activeNodeGuid=null},MO.FDsSystemPersistenceCatalogToolBar_onFolderDeleteExcute=function(b){b.resultCd==EResult.Success&&(b=this._frameSet._catalogContent.focusNode(),RConsole.find(FUiDesktopConsole).showUploading(),this._activeNodeGuid=b._guid,RConsole.find(FDrResourceConsole).doFolderDelete(b._guid).addLoadListener(this,
this.onFolderDeleteLoad))},MO.FDsSystemPersistenceCatalogToolBar_onFolderDeleteClick=function(b){if(!this._frameSet._catalogContent.focusNode())return RConsole.find(FUiMessageConsole).showInfo("\u8bf7\u9009\u4e2d\u76ee\u5f55\u8282\u70b9\u540e\uff0c\u518d\u70b9\u51fb\u64cd\u4f5c\u3002");RConsole.find(FUiMessageConsole).showConfirm("\u8bf7\u786e\u8ba4\u662f\u5426\u5220\u9664\u5f53\u524d\u76ee\u5f55\uff1f").addResultListener(this,this.onFolderDeleteExcute)},MO.FDsSystemPersistenceCatalogToolBar_onFolderPropertyClick=
function(b){b=this._frameSet._catalogContent.focusNode();if(!b)return RConsole.find(FUiMessageConsole).showInfo("\u8bf7\u9009\u4e2d\u76ee\u5f55\u8282\u70b9\u540e\uff0c\u518d\u70b9\u51fb\u64cd\u4f5c\u3002");var d=null;b._parent&&(d=b._parent.label());var f=RConsole.find(FUiWindowConsole).find(FDsResourceFolderDialog);f._workspace=this._workspace;f._frameSet=this._frameSet;f._nodeGuid=b._guid;f.setNodeParentLabel(d);f.setNodeLabel(b.label());f.switchDataMode(EUiDataMode.Update);f.showPosition(EUiPosition.Center)},
MO.FDsSystemPersistenceCatalogToolBar_onFolderOpenClick=function(b){},MO.FDsSystemPersistenceCatalogToolBar_onFolderCloseClick=function(b){},MO.FDsSystemPersistenceCatalogToolBar_construct=function(){this.__base.FUiToolBar.construct.call(this)},MO.FDsSystemPersistenceCatalogToolBar_dispose=function(){this.__base.FUiToolBar.dispose.call(this)};
with(MO)MO.FDsSystemPersistenceFrameSet=function(b){b=RClass.inherits(this,b,FDsSystemDesignFrameSet);b._frameName="system.design.persistence.FrameSet";b.onBuilded=FDsSystemPersistenceFrameSet_onBuilded;b.construct=FDsSystemPersistenceFrameSet_construct;b.selectObject=FDsSystemPersistenceFrameSet_selectObject;b.load=FDsSystemPersistenceFrameSet_load;b.dispose=FDsSystemPersistenceFrameSet_dispose;return b},MO.FDsSystemPersistenceFrameSet_onBuilded=function(b){this.__base.FDsSystemDesignFrameSet.onBuilded.call(this,
b);this._frameCatalogToolBar._hPanel.className=this.styleName("Toolbar_Ground");this._frameCatalogContent._hPanel.className=this.styleName("Catalog_Content");this._framePropertyToolBar._hPanel.className=this.styleName("Toolbar_Ground");this._framePropertyContent._hPanel.className=this.styleName("Property_Content");var d=this._catalogSplitter=this.searchControl("catalogSpliter");d.setAlignCd(EUiAlign.Left);d.setSizeHtml(this._frameCatalog._hPanel);d=this._catalogToolbar=RClass.create(FDsSystemPersistenceCatalogToolBar);
d._workspace=this._workspace;d._frameSet=this;d.buildDefine(b);this._frameCatalogToolBar.push(d);d=this._catalogContent=RClass.create(FDsSystemPersistenceCatalogContent);d._workspace=this._workspace;d._frameSet=this;d.build(b);this._frameCatalogContent.push(d);d=this._propertyToolbar=RClass.create(FDsSystemPersistencePropertyToolBar);d._workspace=this._workspace;d._frameSet=this;d.buildDefine(b);this._framePropertyToolBar.push(d)},MO.FDsSystemPersistenceFrameSet_construct=function(){this.__base.FDsSystemDesignFrameSet.construct.call(this)},
MO.FDsSystemPersistenceFrameSet_selectObject=function(b,d,f){for(var h=this._spaceContent._activeFrame,q=this._propertyFrames,w=q.count(),z=0;z<w;z++){var A=q.at(z);A.hide()}A=this.findPropertyFrame(d);A.show();b==EUiTreeNodeGroup.Container?A.loadObject(h,h):(b=h.findComponent(f),A.loadObject(h,b),this._spaceContent.selectControl(b))},MO.FDsSystemPersistenceFrameSet_load=function(b){b&&this._spaceContent.loadFrame(b)},MO.FDsSystemPersistenceFrameSet_dispose=function(){this.__base.FDsSystemDesignFrameSet.dispose.call(this)};
with(MO)MO.FDsSystemPersistenceMenuBar=function(b){b=RClass.inherits(this,b,FUiMenuBar);b._frameName="system.design.frame.MenuBar";b._controlRefresh=null;b.onBuilded=FDsSystemPersistenceMenuBar_onBuilded;b.onCreateClick=FDsSystemPersistenceMenuBar_onCreateClick;b.onUpdateClick=FDsSystemPersistenceMenuBar_onUpdateClick;b.onDeleteClick=FDsSystemPersistenceMenuBar_onDeleteClick;return b},MO.FDsSystemPersistenceMenuBar_onBuilded=function(b){this.__base.FUiMenuBar.onBuilded.call(this,b);this._controlCreate.addClickListener(this,
this.onCreateClick);this._controlUpdate.addClickListener(this,this.onUpdateClick);this._controlDelete.addClickListener(this,this.onDeleteClick)},MO.FDsSystemPersistenceMenuBar_onCreateClick=function(b){},MO.FDsSystemPersistenceMenuBar_onUpdateClick=function(b){b=this._frameSet._spaceContent._activeFrame;var d=new TXmlDocument,f=d.root();f.set("action","update");f=f.create("Frame");RGuiControl.saveConfig(b,f);return RConsole.find(FXmlConsole).sendAsync("/cloud.describe.frame.ws?do=update",d)},MO.FDsSystemPersistenceMenuBar_onDeleteClick=
function(b){};
with(MO)MO.FDsSystemPersistencePropertyContent=function(b){b=RClass.inherits(this,b,FDsCatalog);b.onBuild=FDsSystemPersistencePropertyContent_onBuild;b.onNodeClick=FDsSystemPersistencePropertyContent_onNodeClick;b.construct=FDsSystemPersistencePropertyContent_construct;b.buildTechnique=FDsSystemPersistencePropertyContent_buildTechnique;b.buildRegion=FDsSystemPersistencePropertyContent_buildRegion;b.buildMaterial=FDsSystemPersistencePropertyContent_buildMaterial;b.buildDisplay=FDsSystemPersistencePropertyContent_buildDisplay;b.buildSpace=
FDsSystemPersistencePropertyContent_buildSpace;b.dispose=FDsSystemPersistencePropertyContent_dispose;return b},MO.FDsSystemPersistencePropertyContent_onBuild=function(b){this.__base.FDsCatalog.onBuild.call(this,b);this.loadUrl("/cloud.describe.tree.ws?action=query&code=resource.template")},MO.FDsSystemPersistencePropertyContent_onNodeClick=function(b,d){var f=d.dataPropertyGet("linker");this.selectObject(f)},MO.FDsSystemPersistencePropertyContent_construct=function(){this.__base.FDsCatalog.construct.call(this)},
MO.FDsSystemPersistencePropertyContent_buildTechnique=function(b,d){var f=this.createNode();f.setLabel("Technique");f.setTypeCode("technique");f.dataPropertySet("linker",d);b.appendNode(f)},MO.FDsSystemPersistencePropertyContent_buildRegion=function(b,d){var f=this.createNode();f.setLabel("Region");f.setTypeCode("region");f.dataPropertySet("linker",d);b.appendNode(f);var h=this.createNode();h.setLabel("Camera");h.setTypeCode("camera");h.dataPropertySet("linker",d.camera());f.appendNode(h);h=this.createNode();
h.setLabel("Light");h.setTypeCode("light");h.dataPropertySet("linker",d.directionalLight());f.appendNode(h)},MO.FDsSystemPersistencePropertyContent_buildMaterial=function(b,d){var f=d.resource(),h=this.createNode();h.setTypeCode("Material");h.setLabel(f.code());h.setNote(f.label());h.dataPropertySet("linker",d);b.appendNode(h)},MO.FDsSystemPersistencePropertyContent_buildDisplay=function(b,d){var f=d.resource(),h=this.createNode();h.setTypeCode("Display");h.setLabel(RString.nvl(f.code(),"Display"));
h.setNote(f.label());h.dataPropertySet("linker",d);b.appendNode(h);var f=d.renderables(),q=f.count();if(0<q)for(var w=0;w<q;w++){var z=f.at(w),A=z.resource(),B=this.createNode();B.setTypeCode("Renderable");B.setLabel(A.code());B.setNote(A.label());B.dataPropertySet("linker",z);h.appendNode(B)}},MO.FDsSystemPersistencePropertyContent_buildSpace=function(b){this.clearAllNodes();var d=b.resource(),f=this.createNode();f.setTypeCode("Space");f.setLabel(d.code());f.setNote(d.label());f.dataPropertySet("linker",
b);this.appendNode(f);this.buildTechnique(f,b.technique());this.buildRegion(f,b.region());var h=this.createNode();h.setTypeCode("Region");h.setLabel("Materials");f.appendNode(h);for(var q=b.materials(),w=q.count(),d=0;d<w;d++){var z=q.at(d);this.buildMaterial(h,z)}h=this.createNode();h.setTypeCode("Region");h.setLabel("Displays");f.appendNode(h);b=b._sprites;q=b.count();for(d=0;d<q;d++)w=b.at(d),this.buildDisplay(h,w);f.click()},MO.FDsSystemPersistencePropertyContent_dispose=function(){this.__base.FDsCatalog.dispose.call(this)};
with(MO)MO.FDsSystemPersistencePropertyToolBar=function(b){b=RClass.inherits(this,b,FUiToolBar);b._frameName="system.design.frame.PropertyToolBar";b._controlInsertButton=null;b._controlUpdateButton=null;b._controlDeleteButton=null;b.onBuilded=FDsSystemPersistencePropertyToolBar_onBuilded;b.onUpdateClick=FDsSystemPersistencePropertyToolBar_onUpdateClick;b.construct=FDsSystemPersistencePropertyToolBar_construct;b.dispose=FDsSystemPersistencePropertyToolBar_dispose;return b},MO.FDsSystemPersistencePropertyToolBar_onBuilded=
function(b){this.__base.FUiToolBar.onBuilded.call(this,b)},MO.FDsSystemPersistencePropertyToolBar_onUpdateClick=function(b){window.location="Project.wa?do=detail&guid="+this._workspace._activeProjectGuid},MO.FDsSystemPersistencePropertyToolBar_construct=function(){this.__base.FUiToolBar.construct.call(this)},MO.FDsSystemPersistencePropertyToolBar_dispose=function(){this.__base.FUiToolBar.dispose.call(this)};
with(MO)MO.FDsSystemListCatalogContent=function(b){b=RClass.inherits(this,b,FUiDataTreeView,MListenerSelected);b._activeFrame=null;b.onNodeClick=FDsSystemListCatalogContent_onNodeClick;b.construct=FDsSystemListCatalogContent_construct;b.selectObject=FDsSystemListCatalogContent_selectObject;b.showObject=FDsSystemListCatalogContent_showObject;b.dispose=FDsSystemListCatalogContent_dispose;return b},MO.FDsSystemListCatalogContent_onNodeClick=function(b){var d=b.node;b=d.typeGroup();var f=d.type();d.typeCode();
f=f.get("property_frame");d=d.label();b==EUiTreeNodeGroup.Container?(this._frameSet.load(d),this._frameSet.selectObject(b,f,null)):b==EUiTreeNodeGroup.Item&&this._frameSet.selectObject(b,f,d)},MO.FDsSystemListCatalogContent_construct=function(){this.__base.FUiDataTreeView.construct.call(this);this.loadUrl("/cloud.describe.tree.ws?action=query&code=system.design.list")},MO.FDsSystemListCatalogContent_selectObject=function(b){b&&this.processSelectedListener(b,!0)},MO.FDsSystemListCatalogContent_showObject=
function(b){if(RClass.isClass(b,FDsSceneRenderable))for(var d=this._renderableNodes,f=d.count(),h=0;h<f;h++)d.at(h).dataPropertyGet("linker")==b&&this.processSelectedListener(b,!1)},MO.FDsSystemListCatalogContent_dispose=function(){this._activeFrame=null;this.__base.FUiDataTreeView.dispose.call(this)};
with(MO)MO.FDsSystemListCatalogToolBar=function(b){b=RClass.inherits(this,b,FUiToolBar);b._frameName="system.design.frame.CatalogToolBar";b._controlFolderCreateButton=null;b._controlFolderDeleteButton=null;b._controlFolderPropertyButton=null;b._controlFolderOpenButton=null;b._controlFolderCloseButton=null;b._activeNodeGuid=null;b.onBuilded=FDsSystemListCatalogToolBar_onBuilded;b.onFolderCreateClick=FDsSystemListCatalogToolBar_onFolderCreateClick;b.onFolderDeleteLoad=FDsSystemListCatalogToolBar_onFolderDeleteLoad;
b.onFolderDeleteExcute=FDsSystemListCatalogToolBar_onFolderDeleteExcute;b.onFolderDeleteClick=FDsSystemListCatalogToolBar_onFolderDeleteClick;b.onFolderPropertyClick=FDsSystemListCatalogToolBar_onFolderPropertyClick;b.onFolderOpenClick=FDsSystemListCatalogToolBar_onFolderOpenClick;b.onFolderCloseClick=FDsSystemListCatalogToolBar_onFolderCloseClick;b.construct=FDsSystemListCatalogToolBar_construct;b.dispose=FDsSystemListCatalogToolBar_dispose;return b},MO.FDsSystemListCatalogToolBar_onBuilded=function(b){this.__base.FUiToolBar.onBuilded.call(this,
b)},MO.FDsSystemListCatalogToolBar_onFolderCreateClick=function(b){var d=b=null,f=this._frameSet._catalogContent.focusNode();f&&(b=f.guid(),d=f.label());f=RConsole.find(FUiWindowConsole).find(FDsResourceFolderDialog);f._workspace=this._workspace;f._frameSet=this._frameSet;f._parentGuid=b;f.setNodeParentLabel(d);f.setNodeLabel("");f.switchDataMode(EUiDataMode.Insert);f.showPosition(EUiPosition.Center)},MO.FDsSystemListCatalogToolBar_onFolderDeleteLoad=function(b){RConsole.find(FUiDesktopConsole).hide();
b=this._frameSet._catalogContent;var d=this._activeNodeGuid;d&&b.findByGuid(d).removeSelf();this._activeNodeGuid=null},MO.FDsSystemListCatalogToolBar_onFolderDeleteExcute=function(b){b.resultCd==EResult.Success&&(b=this._frameSet._catalogContent.focusNode(),RConsole.find(FUiDesktopConsole).showUploading(),this._activeNodeGuid=b._guid,RConsole.find(FDrResourceConsole).doFolderDelete(b._guid).addLoadListener(this,this.onFolderDeleteLoad))},MO.FDsSystemListCatalogToolBar_onFolderDeleteClick=function(b){if(!this._frameSet._catalogContent.focusNode())return RConsole.find(FUiMessageConsole).showInfo("\u8bf7\u9009\u4e2d\u76ee\u5f55\u8282\u70b9\u540e\uff0c\u518d\u70b9\u51fb\u64cd\u4f5c\u3002");
RConsole.find(FUiMessageConsole).showConfirm("\u8bf7\u786e\u8ba4\u662f\u5426\u5220\u9664\u5f53\u524d\u76ee\u5f55\uff1f").addResultListener(this,this.onFolderDeleteExcute)},MO.FDsSystemListCatalogToolBar_onFolderPropertyClick=function(b){b=this._frameSet._catalogContent.focusNode();if(!b)return RConsole.find(FUiMessageConsole).showInfo("\u8bf7\u9009\u4e2d\u76ee\u5f55\u8282\u70b9\u540e\uff0c\u518d\u70b9\u51fb\u64cd\u4f5c\u3002");var d=null;b._parent&&(d=b._parent.label());var f=RConsole.find(FUiWindowConsole).find(FDsResourceFolderDialog);
f._workspace=this._workspace;f._frameSet=this._frameSet;f._nodeGuid=b._guid;f.setNodeParentLabel(d);f.setNodeLabel(b.label());f.switchDataMode(EUiDataMode.Update);f.showPosition(EUiPosition.Center)},MO.FDsSystemListCatalogToolBar_onFolderOpenClick=function(b){},MO.FDsSystemListCatalogToolBar_onFolderCloseClick=function(b){},MO.FDsSystemListCatalogToolBar_construct=function(){this.__base.FUiToolBar.construct.call(this)},MO.FDsSystemListCatalogToolBar_dispose=function(){this.__base.FUiToolBar.dispose.call(this)};
with(MO)MO.FDsSystemListFrameSet=function(b){b=RClass.inherits(this,b,FDsSystemDesignFrameSet);b._frameName="system.design.list.FrameSet";b.onBuilded=FDsSystemListFrameSet_onBuilded;b.construct=FDsSystemListFrameSet_construct;b.selectObject=FDsSystemListFrameSet_selectObject;b.load=FDsSystemListFrameSet_load;b.dispose=FDsSystemListFrameSet_dispose;return b},MO.FDsSystemListFrameSet_onBuilded=function(b){this.__base.FDsSystemDesignFrameSet.onBuilded.call(this,b);this._frameCatalogToolBar._hPanel.className=
this.styleName("Toolbar_Ground");this._frameCatalogContent._hPanel.className=this.styleName("Catalog_Content");this._framePropertyToolBar._hPanel.className=this.styleName("Toolbar_Ground");this._framePropertyContent._hPanel.className=this.styleName("Property_Content");var d=this._catalogSplitter=this.searchControl("catalogSpliter");d.setAlignCd(EUiAlign.Left);d.setSizeHtml(this._frameCatalog._hPanel);d=this._catalogToolbar=RClass.create(FDsSystemListCatalogToolBar);d._workspace=this._workspace;d._frameSet=
this;d.buildDefine(b);this._frameCatalogToolBar.push(d);d=this._catalogContent=RClass.create(FDsSystemListCatalogContent);d._workspace=this._workspace;d._frameSet=this;d.build(b);this._frameCatalogContent.push(d);d=this._propertyToolbar=RClass.create(FDsSystemListPropertyToolBar);d._workspace=this._workspace;d._frameSet=this;d.buildDefine(b);this._framePropertyToolBar.push(d)},MO.FDsSystemListFrameSet_construct=function(){this.__base.FDsSystemDesignFrameSet.construct.call(this)},MO.FDsSystemListFrameSet_selectObject=
function(b,d,f){for(var h=this._spaceContent._activeFrame,q=this._propertyFrames,w=q.count(),z=0;z<w;z++){var A=q.at(z);A.hide()}A=this.findPropertyFrame(d);A.show();b==EUiTreeNodeGroup.Container?A.loadObject(h,h):(b=h.findComponent(f),A.loadObject(h,b),this._spaceContent.selectControl(b))},MO.FDsSystemListFrameSet_load=function(b){b&&this._spaceContent.loadFrame(b)},MO.FDsSystemListFrameSet_dispose=function(){this.__base.FDsSystemDesignFrameSet.dispose.call(this)};
with(MO)MO.FDsSystemListMenuBar=function(b){b=RClass.inherits(this,b,FUiMenuBar);b._frameName="system.design.frame.MenuBar";b._controlRefresh=null;b.onBuilded=FDsSystemListMenuBar_onBuilded;b.onCreateClick=FDsSystemListMenuBar_onCreateClick;b.onUpdateClick=FDsSystemListMenuBar_onUpdateClick;b.onDeleteClick=FDsSystemListMenuBar_onDeleteClick;return b},MO.FDsSystemListMenuBar_onBuilded=function(b){this.__base.FUiMenuBar.onBuilded.call(this,b);this._controlCreate.addClickListener(this,this.onCreateClick);
this._controlUpdate.addClickListener(this,this.onUpdateClick);this._controlDelete.addClickListener(this,this.onDeleteClick)},MO.FDsSystemListMenuBar_onCreateClick=function(b){},MO.FDsSystemListMenuBar_onUpdateClick=function(b){b=this._frameSet._spaceContent._activeFrame;var d=new TXmlDocument,f=d.root();f.set("action","update");f=f.create("Frame");RGuiControl.saveConfig(b,f);return RConsole.find(FXmlConsole).sendAsync("/cloud.describe.frame.ws?do=update",d)},MO.FDsSystemListMenuBar_onDeleteClick=
function(b){};
with(MO)MO.FDsSystemListPropertyContent=function(b){b=RClass.inherits(this,b,FDsCatalog);b.onBuild=FDsSystemListPropertyContent_onBuild;b.onNodeClick=FDsSystemListPropertyContent_onNodeClick;b.construct=FDsSystemListPropertyContent_construct;b.buildTechnique=FDsSystemListPropertyContent_buildTechnique;b.buildRegion=FDsSystemListPropertyContent_buildRegion;b.buildMaterial=FDsSystemListPropertyContent_buildMaterial;b.buildDisplay=FDsSystemListPropertyContent_buildDisplay;b.buildSpace=FDsSystemListPropertyContent_buildSpace;
b.dispose=FDsSystemListPropertyContent_dispose;return b},MO.FDsSystemListPropertyContent_onBuild=function(b){this.__base.FDsCatalog.onBuild.call(this,b);this.loadUrl("/cloud.describe.tree.ws?action=query&code=resource.template")},MO.FDsSystemListPropertyContent_onNodeClick=function(b,d){var f=d.dataPropertyGet("linker");this.selectObject(f)},MO.FDsSystemListPropertyContent_construct=function(){this.__base.FDsCatalog.construct.call(this)},MO.FDsSystemListPropertyContent_buildTechnique=function(b,d){var f=
this.createNode();f.setLabel("Technique");f.setTypeCode("technique");f.dataPropertySet("linker",d);b.appendNode(f)},MO.FDsSystemListPropertyContent_buildRegion=function(b,d){var f=this.createNode();f.setLabel("Region");f.setTypeCode("region");f.dataPropertySet("linker",d);b.appendNode(f);var h=this.createNode();h.setLabel("Camera");h.setTypeCode("camera");h.dataPropertySet("linker",d.camera());f.appendNode(h);h=this.createNode();h.setLabel("Light");h.setTypeCode("light");h.dataPropertySet("linker",
d.directionalLight());f.appendNode(h)},MO.FDsSystemListPropertyContent_buildMaterial=function(b,d){var f=d.resource(),h=this.createNode();h.setTypeCode("Material");h.setLabel(f.code());h.setNote(f.label());h.dataPropertySet("linker",d);b.appendNode(h)},MO.FDsSystemListPropertyContent_buildDisplay=function(b,d){var f=d.resource(),h=this.createNode();h.setTypeCode("Display");h.setLabel(RString.nvl(f.code(),"Display"));h.setNote(f.label());h.dataPropertySet("linker",d);b.appendNode(h);var f=d.renderables(),
q=f.count();if(0<q)for(var w=0;w<q;w++){var z=f.at(w),A=z.resource(),B=this.createNode();B.setTypeCode("Renderable");B.setLabel(A.code());B.setNote(A.label());B.dataPropertySet("linker",z);h.appendNode(B)}},MO.FDsSystemListPropertyContent_buildSpace=function(b){this.clearAllNodes();var d=b.resource(),f=this.createNode();f.setTypeCode("Space");f.setLabel(d.code());f.setNote(d.label());f.dataPropertySet("linker",b);this.appendNode(f);this.buildTechnique(f,b.technique());this.buildRegion(f,b.region());
var h=this.createNode();h.setTypeCode("Region");h.setLabel("Materials");f.appendNode(h);for(var q=b.materials(),w=q.count(),d=0;d<w;d++){var z=q.at(d);this.buildMaterial(h,z)}h=this.createNode();h.setTypeCode("Region");h.setLabel("Displays");f.appendNode(h);b=b._sprites;q=b.count();for(d=0;d<q;d++)w=b.at(d),this.buildDisplay(h,w);f.click()},MO.FDsSystemListPropertyContent_dispose=function(){this.__base.FDsCatalog.dispose.call(this)};
with(MO)MO.FDsSystemListPropertyToolBar=function(b){b=RClass.inherits(this,b,FUiToolBar);b._frameName="system.design.frame.PropertyToolBar";b._controlInsertButton=null;b._controlUpdateButton=null;b._controlDeleteButton=null;b.onBuilded=FDsSystemListPropertyToolBar_onBuilded;b.onUpdateClick=FDsSystemListPropertyToolBar_onUpdateClick;b.construct=FDsSystemListPropertyToolBar_construct;b.dispose=FDsSystemListPropertyToolBar_dispose;return b},MO.FDsSystemListPropertyToolBar_onBuilded=function(b){this.__base.FUiToolBar.onBuilded.call(this,
b)},MO.FDsSystemListPropertyToolBar_onUpdateClick=function(b){window.location="Project.wa?do=detail&guid="+this._workspace._activeProjectGuid},MO.FDsSystemListPropertyToolBar_construct=function(){this.__base.FUiToolBar.construct.call(this)},MO.FDsSystemListPropertyToolBar_dispose=function(){this.__base.FUiToolBar.dispose.call(this)};
with(MO)MO.FDsSystemTreeCatalogContent=function(b){b=RClass.inherits(this,b,FUiDataTreeView,MListenerSelected);b._activeFrame=null;b.onNodeClick=FDsSystemTreeCatalogContent_onNodeClick;b.construct=FDsSystemTreeCatalogContent_construct;b.selectObject=FDsSystemTreeCatalogContent_selectObject;b.showObject=FDsSystemTreeCatalogContent_showObject;b.dispose=FDsSystemTreeCatalogContent_dispose;return b},MO.FDsSystemTreeCatalogContent_onNodeClick=function(b){var d=b.node;b=d.typeGroup();var f=d.type();d.typeCode();
f=f.get("property_frame");d=d.label();b==EUiTreeNodeGroup.Container?(this._frameSet.load(d),this._frameSet.selectObject(b,f,null)):b==EUiTreeNodeGroup.Item&&this._frameSet.selectObject(b,f,d)},MO.FDsSystemTreeCatalogContent_construct=function(){this.__base.FUiDataTreeView.construct.call(this);this.loadUrl("/cloud.describe.tree.ws?action=query&code=system.design.tree")},MO.FDsSystemTreeCatalogContent_selectObject=function(b){b&&this.processSelectedListener(b,!0)},MO.FDsSystemTreeCatalogContent_showObject=
function(b){if(RClass.isClass(b,FDsSceneRenderable))for(var d=this._renderableNodes,f=d.count(),h=0;h<f;h++)d.at(h).dataPropertyGet("linker")==b&&this.processSelectedListener(b,!1)},MO.FDsSystemTreeCatalogContent_dispose=function(){this._activeFrame=null;this.__base.FUiDataTreeView.dispose.call(this)};
with(MO)MO.FDsSystemTreeCatalogToolBar=function(b){b=RClass.inherits(this,b,FUiToolBar);b._frameName="system.design.frame.CatalogToolBar";b._controlFolderCreateButton=null;b._controlFolderDeleteButton=null;b._controlFolderPropertyButton=null;b._controlFolderOpenButton=null;b._controlFolderCloseButton=null;b._activeNodeGuid=null;b.onBuilded=FDsSystemTreeCatalogToolBar_onBuilded;b.onFolderCreateClick=FDsSystemTreeCatalogToolBar_onFolderCreateClick;b.onFolderDeleteLoad=FDsSystemTreeCatalogToolBar_onFolderDeleteLoad;
b.onFolderDeleteExcute=FDsSystemTreeCatalogToolBar_onFolderDeleteExcute;b.onFolderDeleteClick=FDsSystemTreeCatalogToolBar_onFolderDeleteClick;b.onFolderPropertyClick=FDsSystemTreeCatalogToolBar_onFolderPropertyClick;b.onFolderOpenClick=FDsSystemTreeCatalogToolBar_onFolderOpenClick;b.onFolderCloseClick=FDsSystemTreeCatalogToolBar_onFolderCloseClick;b.construct=FDsSystemTreeCatalogToolBar_construct;b.dispose=FDsSystemTreeCatalogToolBar_dispose;return b},MO.FDsSystemTreeCatalogToolBar_onBuilded=function(b){this.__base.FUiToolBar.onBuilded.call(this,
b)},MO.FDsSystemTreeCatalogToolBar_onFolderCreateClick=function(b){var d=b=null,f=this._frameSet._catalogContent.focusNode();f&&(b=f.guid(),d=f.label());f=RConsole.find(FUiWindowConsole).find(FDsResourceFolderDialog);f._workspace=this._workspace;f._frameSet=this._frameSet;f._parentGuid=b;f.setNodeParentLabel(d);f.setNodeLabel("");f.switchDataMode(EUiDataMode.Insert);f.showPosition(EUiPosition.Center)},MO.FDsSystemTreeCatalogToolBar_onFolderDeleteLoad=function(b){RConsole.find(FUiDesktopConsole).hide();
b=this._frameSet._catalogContent;var d=this._activeNodeGuid;d&&b.findByGuid(d).removeSelf();this._activeNodeGuid=null},MO.FDsSystemTreeCatalogToolBar_onFolderDeleteExcute=function(b){b.resultCd==EResult.Success&&(b=this._frameSet._catalogContent.focusNode(),RConsole.find(FUiDesktopConsole).showUploading(),this._activeNodeGuid=b._guid,RConsole.find(FDrResourceConsole).doFolderDelete(b._guid).addLoadListener(this,this.onFolderDeleteLoad))},MO.FDsSystemTreeCatalogToolBar_onFolderDeleteClick=function(b){if(!this._frameSet._catalogContent.focusNode())return RConsole.find(FUiMessageConsole).showInfo("\u8bf7\u9009\u4e2d\u76ee\u5f55\u8282\u70b9\u540e\uff0c\u518d\u70b9\u51fb\u64cd\u4f5c\u3002");
RConsole.find(FUiMessageConsole).showConfirm("\u8bf7\u786e\u8ba4\u662f\u5426\u5220\u9664\u5f53\u524d\u76ee\u5f55\uff1f").addResultListener(this,this.onFolderDeleteExcute)},MO.FDsSystemTreeCatalogToolBar_onFolderPropertyClick=function(b){b=this._frameSet._catalogContent.focusNode();if(!b)return RConsole.find(FUiMessageConsole).showInfo("\u8bf7\u9009\u4e2d\u76ee\u5f55\u8282\u70b9\u540e\uff0c\u518d\u70b9\u51fb\u64cd\u4f5c\u3002");var d=null;b._parent&&(d=b._parent.label());var f=RConsole.find(FUiWindowConsole).find(FDsResourceFolderDialog);
f._workspace=this._workspace;f._frameSet=this._frameSet;f._nodeGuid=b._guid;f.setNodeParentLabel(d);f.setNodeLabel(b.label());f.switchDataMode(EUiDataMode.Update);f.showPosition(EUiPosition.Center)},MO.FDsSystemTreeCatalogToolBar_onFolderOpenClick=function(b){},MO.FDsSystemTreeCatalogToolBar_onFolderCloseClick=function(b){},MO.FDsSystemTreeCatalogToolBar_construct=function(){this.__base.FUiToolBar.construct.call(this)},MO.FDsSystemTreeCatalogToolBar_dispose=function(){this.__base.FUiToolBar.dispose.call(this)};
with(MO)MO.FDsSystemTreeFrameSet=function(b){b=RClass.inherits(this,b,FDsSystemDesignFrameSet);b._frameName="system.design.tree.FrameSet";b.onBuilded=FDsSystemTreeFrameSet_onBuilded;b.construct=FDsSystemTreeFrameSet_construct;b.selectObject=FDsSystemTreeFrameSet_selectObject;b.load=FDsSystemTreeFrameSet_load;b.dispose=FDsSystemTreeFrameSet_dispose;return b},MO.FDsSystemTreeFrameSet_onBuilded=function(b){this.__base.FDsSystemDesignFrameSet.onBuilded.call(this,b);this._frameCatalogToolBar._hPanel.className=
this.styleName("Toolbar_Ground");this._frameCatalogContent._hPanel.className=this.styleName("Catalog_Content");this._framePropertyToolBar._hPanel.className=this.styleName("Toolbar_Ground");this._framePropertyContent._hPanel.className=this.styleName("Property_Content");var d=this._catalogSplitter=this.searchControl("catalogSpliter");d.setAlignCd(EUiAlign.Left);d.setSizeHtml(this._frameCatalog._hPanel);d=this._catalogToolbar=RClass.create(FDsSystemTreeCatalogToolBar);d._workspace=this._workspace;d._frameSet=
this;d.buildDefine(b);this._frameCatalogToolBar.push(d);d=this._catalogContent=RClass.create(FDsSystemTreeCatalogContent);d._workspace=this._workspace;d._frameSet=this;d.build(b);this._frameCatalogContent.push(d);d=this._propertyToolbar=RClass.create(FDsSystemTreePropertyToolBar);d._workspace=this._workspace;d._frameSet=this;d.buildDefine(b);this._framePropertyToolBar.push(d)},MO.FDsSystemTreeFrameSet_construct=function(){this.__base.FDsSystemDesignFrameSet.construct.call(this)},MO.FDsSystemTreeFrameSet_selectObject=
function(b,d,f){for(var h=this._spaceContent._activeFrame,q=this._propertyFrames,w=q.count(),z=0;z<w;z++){var A=q.at(z);A.hide()}A=this.findPropertyFrame(d);A.show();b==EUiTreeNodeGroup.Container?A.loadObject(h,h):(b=h.findComponent(f),A.loadObject(h,b),this._spaceContent.selectControl(b))},MO.FDsSystemTreeFrameSet_load=function(b){b&&this._spaceContent.loadFrame(b)},MO.FDsSystemTreeFrameSet_dispose=function(){this.__base.FDsSystemDesignFrameSet.dispose.call(this)};
with(MO)MO.FDsSystemTreeMenuBar=function(b){b=RClass.inherits(this,b,FUiMenuBar);b._frameName="system.design.frame.MenuBar";b._controlRefresh=null;b.onBuilded=FDsSystemTreeMenuBar_onBuilded;b.onCreateClick=FDsSystemTreeMenuBar_onCreateClick;b.onUpdateClick=FDsSystemTreeMenuBar_onUpdateClick;b.onDeleteClick=FDsSystemTreeMenuBar_onDeleteClick;return b},MO.FDsSystemTreeMenuBar_onBuilded=function(b){this.__base.FUiMenuBar.onBuilded.call(this,b);this._controlCreate.addClickListener(this,this.onCreateClick);
this._controlUpdate.addClickListener(this,this.onUpdateClick);this._controlDelete.addClickListener(this,this.onDeleteClick)},MO.FDsSystemTreeMenuBar_onCreateClick=function(b){},MO.FDsSystemTreeMenuBar_onUpdateClick=function(b){b=this._frameSet._spaceContent._activeFrame;var d=new TXmlDocument,f=d.root();f.set("action","update");f=f.create("Frame");RGuiControl.saveConfig(b,f);return RConsole.find(FXmlConsole).sendAsync("/cloud.describe.frame.ws?do=update",d)},MO.FDsSystemTreeMenuBar_onDeleteClick=
function(b){};
with(MO)MO.FDsSystemTreePropertyContent=function(b){b=RClass.inherits(this,b,FDsCatalog);b.onBuild=FDsSystemTreePropertyContent_onBuild;b.onNodeClick=FDsSystemTreePropertyContent_onNodeClick;b.construct=FDsSystemTreePropertyContent_construct;b.buildTechnique=FDsSystemTreePropertyContent_buildTechnique;b.buildRegion=FDsSystemTreePropertyContent_buildRegion;b.buildMaterial=FDsSystemTreePropertyContent_buildMaterial;b.buildDisplay=FDsSystemTreePropertyContent_buildDisplay;b.buildSpace=FDsSystemTreePropertyContent_buildSpace;
b.dispose=FDsSystemTreePropertyContent_dispose;return b},MO.FDsSystemTreePropertyContent_onBuild=function(b){this.__base.FDsCatalog.onBuild.call(this,b);this.loadUrl("/cloud.describe.tree.ws?action=query&code=resource.template")},MO.FDsSystemTreePropertyContent_onNodeClick=function(b,d){var f=d.dataPropertyGet("linker");this.selectObject(f)},MO.FDsSystemTreePropertyContent_construct=function(){this.__base.FDsCatalog.construct.call(this)},MO.FDsSystemTreePropertyContent_buildTechnique=function(b,d){var f=
this.createNode();f.setLabel("Technique");f.setTypeCode("technique");f.dataPropertySet("linker",d);b.appendNode(f)},MO.FDsSystemTreePropertyContent_buildRegion=function(b,d){var f=this.createNode();f.setLabel("Region");f.setTypeCode("region");f.dataPropertySet("linker",d);b.appendNode(f);var h=this.createNode();h.setLabel("Camera");h.setTypeCode("camera");h.dataPropertySet("linker",d.camera());f.appendNode(h);h=this.createNode();h.setLabel("Light");h.setTypeCode("light");h.dataPropertySet("linker",
d.directionalLight());f.appendNode(h)},MO.FDsSystemTreePropertyContent_buildMaterial=function(b,d){var f=d.resource(),h=this.createNode();h.setTypeCode("Material");h.setLabel(f.code());h.setNote(f.label());h.dataPropertySet("linker",d);b.appendNode(h)},MO.FDsSystemTreePropertyContent_buildDisplay=function(b,d){var f=d.resource(),h=this.createNode();h.setTypeCode("Display");h.setLabel(RString.nvl(f.code(),"Display"));h.setNote(f.label());h.dataPropertySet("linker",d);b.appendNode(h);var f=d.renderables(),
q=f.count();if(0<q)for(var w=0;w<q;w++){var z=f.at(w),A=z.resource(),B=this.createNode();B.setTypeCode("Renderable");B.setLabel(A.code());B.setNote(A.label());B.dataPropertySet("linker",z);h.appendNode(B)}},MO.FDsSystemTreePropertyContent_buildSpace=function(b){this.clearAllNodes();var d=b.resource(),f=this.createNode();f.setTypeCode("Space");f.setLabel(d.code());f.setNote(d.label());f.dataPropertySet("linker",b);this.appendNode(f);this.buildTechnique(f,b.technique());this.buildRegion(f,b.region());
var h=this.createNode();h.setTypeCode("Region");h.setLabel("Materials");f.appendNode(h);for(var q=b.materials(),w=q.count(),d=0;d<w;d++){var z=q.at(d);this.buildMaterial(h,z)}h=this.createNode();h.setTypeCode("Region");h.setLabel("Displays");f.appendNode(h);b=b._sprites;q=b.count();for(d=0;d<q;d++)w=b.at(d),this.buildDisplay(h,w);f.click()},MO.FDsSystemTreePropertyContent_dispose=function(){this.__base.FDsCatalog.dispose.call(this)};
with(MO)MO.FDsSystemTreePropertyToolBar=function(b){b=RClass.inherits(this,b,FUiToolBar);b._frameName="system.design.frame.PropertyToolBar";b._controlInsertButton=null;b._controlUpdateButton=null;b._controlDeleteButton=null;b.onBuilded=FDsSystemTreePropertyToolBar_onBuilded;b.onUpdateClick=FDsSystemTreePropertyToolBar_onUpdateClick;b.construct=FDsSystemTreePropertyToolBar_construct;b.dispose=FDsSystemTreePropertyToolBar_dispose;return b},MO.FDsSystemTreePropertyToolBar_onBuilded=function(b){this.__base.FUiToolBar.onBuilded.call(this,
b)},MO.FDsSystemTreePropertyToolBar_onUpdateClick=function(b){window.location="Project.wa?do=detail&guid="+this._workspace._activeProjectGuid},MO.FDsSystemTreePropertyToolBar_construct=function(){this.__base.FUiToolBar.construct.call(this)},MO.FDsSystemTreePropertyToolBar_dispose=function(){this.__base.FUiToolBar.dispose.call(this)};
with(MO)MO.FDsSystemFrameBarProperty=function(b){b=RClass.inherits(this,b,FDsSystemFrameControlProperty);b._activeSpace=null;b._activeRenderable=null;b.onBuilded=FDsSystemFrameBarProperty_onBuilded;b.onDataChanged=FDsSystemFrameBarProperty_onDataChanged;b.construct=FDsSystemFrameBarProperty_construct;b.loadObject=FDsSystemFrameBarProperty_loadObject;b.dispose=FDsSystemFrameBarProperty_dispose;return b},MO.FDsSystemFrameBarProperty_onBuilded=function(b){this.__base.FDsSystemFrameControlProperty.onBuilded.call(this,
b)},MO.FDsSystemFrameBarProperty_onDataChanged=function(b){this.__base.FDsSystemFrameControlProperty.onDataChanged.call(this,b)},MO.FDsSystemFrameBarProperty_construct=function(){this.__base.FDsSystemFrameControlProperty.construct.call(this)},MO.FDsSystemFrameBarProperty_loadObject=function(b,d){this.__base.FDsSystemFrameControlProperty.loadObject.call(this,b,d)},MO.FDsSystemFrameBarProperty_dispose=function(){this.__base.FDsSystemFrameControlProperty.dispose.call(this)};
with(MO)MO.FDsSystemFrameButtonProperty=function(b){b=RClass.inherits(this,b,FDsSystemFrameControlProperty);b._activeSpace=null;b._activeRenderable=null;b.onBuilded=FDsSystemFrameButtonProperty_onBuilded;b.onDataChanged=FDsSystemFrameButtonProperty_onDataChanged;b.construct=FDsSystemFrameButtonProperty_construct;b.loadObject=FDsSystemFrameButtonProperty_loadObject;b.dispose=FDsSystemFrameButtonProperty_dispose;return b},MO.FDsSystemFrameButtonProperty_onBuilded=function(b){this.__base.FDsSystemFrameControlProperty.onBuilded.call(this,
b)},MO.FDsSystemFrameButtonProperty_onDataChanged=function(b){this.__base.FDsSystemFrameControlProperty.onDataChanged.call(this,b)},MO.FDsSystemFrameButtonProperty_construct=function(){this.__base.FDsSystemFrameControlProperty.construct.call(this)},MO.FDsSystemFrameButtonProperty_loadObject=function(b,d){this.__base.FDsSystemFrameControlProperty.loadObject.call(this,b,d)},MO.FDsSystemFrameButtonProperty_dispose=function(){this.__base.FDsSystemFrameControlProperty.dispose.call(this)};
with(MO)MO.FDsSystemFrameCatalogContent=function(b){b=RClass.inherits(this,b,FUiDataTreeView,MListenerSelected);b._activeFrame=null;b.onNodeClick=FDsSystemFrameCatalogContent_onNodeClick;b.construct=FDsSystemFrameCatalogContent_construct;b.selectObject=FDsSystemFrameCatalogContent_selectObject;b.showObject=FDsSystemFrameCatalogContent_showObject;b.dispose=FDsSystemFrameCatalogContent_dispose;return b},MO.FDsSystemFrameCatalogContent_onNodeClick=function(b){var d=b.node;b=d.typeGroup();var f=d.type();
d.typeCode();f=f.get("property_frame");d=d.label();b==EUiTreeNodeGroup.Container?(this._frameSet.load(d),this._frameSet.selectObject(b,f,null)):b==EUiTreeNodeGroup.Item&&this._frameSet.selectObject(b,f,d)},MO.FDsSystemFrameCatalogContent_construct=function(){this.__base.FUiDataTreeView.construct.call(this);this.loadUrl("/cloud.describe.tree.ws?action=query&code=system.design.frame")},MO.FDsSystemFrameCatalogContent_selectObject=function(b){b&&this.processSelectedListener(b,!0)},MO.FDsSystemFrameCatalogContent_showObject=
function(b){if(RClass.isClass(b,FDsSceneRenderable))for(var d=this._renderableNodes,f=d.count(),h=0;h<f;h++)d.at(h).dataPropertyGet("linker")==b&&this.processSelectedListener(b,!1)},MO.FDsSystemFrameCatalogContent_dispose=function(){this._activeFrame=null;this.__base.FUiDataTreeView.dispose.call(this)};
with(MO)MO.FDsSystemFrameCatalogToolBar=function(b){b=RClass.inherits(this,b,FUiToolBar);b._frameName="system.design.frame.CatalogToolBar";b._controlFolderCreateButton=null;b._controlFolderDeleteButton=null;b._controlFolderPropertyButton=null;b._controlFolderOpenButton=null;b._controlFolderCloseButton=null;b._activeNodeGuid=null;b.onBuilded=FDsSystemFrameCatalogToolBar_onBuilded;b.onFolderCreateClick=FDsSystemFrameCatalogToolBar_onFolderCreateClick;b.onFolderDeleteLoad=FDsSystemFrameCatalogToolBar_onFolderDeleteLoad;
b.onFolderDeleteExcute=FDsSystemFrameCatalogToolBar_onFolderDeleteExcute;b.onFolderDeleteClick=FDsSystemFrameCatalogToolBar_onFolderDeleteClick;b.onFolderPropertyClick=FDsSystemFrameCatalogToolBar_onFolderPropertyClick;b.onFolderOpenClick=FDsSystemFrameCatalogToolBar_onFolderOpenClick;b.onFolderCloseClick=FDsSystemFrameCatalogToolBar_onFolderCloseClick;b.construct=FDsSystemFrameCatalogToolBar_construct;b.dispose=FDsSystemFrameCatalogToolBar_dispose;return b},MO.FDsSystemFrameCatalogToolBar_onBuilded=
function(b){this.__base.FUiToolBar.onBuilded.call(this,b)},MO.FDsSystemFrameCatalogToolBar_onFolderCreateClick=function(b){var d=b=null,f=this._frameSet._catalogContent.focusNode();f&&(b=f.guid(),d=f.label());f=RConsole.find(FUiWindowConsole).find(FDsResourceFolderDialog);f._workspace=this._workspace;f._frameSet=this._frameSet;f._parentGuid=b;f.setNodeParentLabel(d);f.setNodeLabel("");f.switchDataMode(EUiDataMode.Insert);f.showPosition(EUiPosition.Center)},MO.FDsSystemFrameCatalogToolBar_onFolderDeleteLoad=
function(b){RConsole.find(FUiDesktopConsole).hide();b=this._frameSet._catalogContent;var d=this._activeNodeGuid;d&&b.findByGuid(d).removeSelf();this._activeNodeGuid=null},MO.FDsSystemFrameCatalogToolBar_onFolderDeleteExcute=function(b){b.resultCd==EResult.Success&&(b=this._frameSet._catalogContent.focusNode(),RConsole.find(FUiDesktopConsole).showUploading(),this._activeNodeGuid=b._guid,RConsole.find(FDrResourceConsole).doFolderDelete(b._guid).addLoadListener(this,this.onFolderDeleteLoad))},MO.FDsSystemFrameCatalogToolBar_onFolderDeleteClick=
function(b){if(!this._frameSet._catalogContent.focusNode())return RConsole.find(FUiMessageConsole).showInfo("\u8bf7\u9009\u4e2d\u76ee\u5f55\u8282\u70b9\u540e\uff0c\u518d\u70b9\u51fb\u64cd\u4f5c\u3002");RConsole.find(FUiMessageConsole).showConfirm("\u8bf7\u786e\u8ba4\u662f\u5426\u5220\u9664\u5f53\u524d\u76ee\u5f55\uff1f").addResultListener(this,this.onFolderDeleteExcute)},MO.FDsSystemFrameCatalogToolBar_onFolderPropertyClick=function(b){b=this._frameSet._catalogContent.focusNode();if(!b)return RConsole.find(FUiMessageConsole).showInfo("\u8bf7\u9009\u4e2d\u76ee\u5f55\u8282\u70b9\u540e\uff0c\u518d\u70b9\u51fb\u64cd\u4f5c\u3002");
var d=null;b._parent&&(d=b._parent.label());var f=RConsole.find(FUiWindowConsole).find(FDsResourceFolderDialog);f._workspace=this._workspace;f._frameSet=this._frameSet;f._nodeGuid=b._guid;f.setNodeParentLabel(d);f.setNodeLabel(b.label());f.switchDataMode(EUiDataMode.Update);f.showPosition(EUiPosition.Center)},MO.FDsSystemFrameCatalogToolBar_onFolderOpenClick=function(b){},MO.FDsSystemFrameCatalogToolBar_onFolderCloseClick=function(b){},MO.FDsSystemFrameCatalogToolBar_construct=function(){this.__base.FUiToolBar.construct.call(this)},
MO.FDsSystemFrameCatalogToolBar_dispose=function(){this.__base.FUiToolBar.dispose.call(this)};
with(MO)MO.FDsSystemFrameComponentProperty=function(b){b=RClass.inherits(this,b,FUiForm);b._activeFrame=null;b._activeComponent=null;b.onBuilded=FDsSystemFrameComponentProperty_onBuilded;b.onDataChanged=FDsSystemFrameComponentProperty_onDataChanged;b.construct=FDsSystemFrameComponentProperty_construct;b.loadObject=FDsSystemFrameComponentProperty_loadObject;b.dispose=FDsSystemFrameComponentProperty_dispose;return b},MO.FDsSystemFrameComponentProperty_onBuilded=function(b){this.__base.FUiForm.onBuilded.call(this,
b)},MO.FDsSystemFrameComponentProperty_onDataChanged=function(b){b=this._activeFrame;var d=this._activeControl,f=this._controlSize.get();d.size().set(f.x,f.y);b.build()},MO.FDsSystemFrameComponentProperty_construct=function(){this.__base.FUiForm.construct.call(this)},MO.FDsSystemFrameComponentProperty_loadObject=function(b,d){this._activeFrame=b;this._activeComponent=d;this._controlType.set(RClass.name(d));this._controlName.set(d.name());this._controlLabel.set(d.label())},MO.FDsSystemFrameComponentProperty_dispose=
function(){this.__base.FUiForm.dispose.call(this)};
with(MO)MO.FDsSystemFrameControlProperty=function(b){b=RClass.inherits(this,b,FDsSystemFrameComponentProperty);b._activeFrame=null;b._activeControl=null;b.onBuilded=FDsSystemFrameControlProperty_onBuilded;b.onDataChanged=FDsSystemFrameControlProperty_onDataChanged;b.construct=FDsSystemFrameControlProperty_construct;b.loadObject=FDsSystemFrameControlProperty_loadObject;b.dispose=FDsSystemFrameControlProperty_dispose;return b},MO.FDsSystemFrameControlProperty_onBuilded=function(b){this.__base.FDsSystemFrameComponentProperty.onBuilded.call(this,
b);this._controlSize.addDataChangedListener(this,this.onDataChanged)},MO.FDsSystemFrameControlProperty_onDataChanged=function(b){this.__base.FDsSystemFrameComponentProperty.onDataChanged.call(this,b);b=this._activeFrame;var d=this._activeControl,f=this._controlSize.get();d.size().set(f.x,f.y);b.build()},MO.FDsSystemFrameControlProperty_construct=function(){this.__base.FDsSystemFrameComponentProperty.construct.call(this)},MO.FDsSystemFrameControlProperty_loadObject=function(b,d){this.__base.FDsSystemFrameComponentProperty.loadObject.call(this,
b,d);this._activeFrame=b;this._activeControl=d;var f=d.location();this._controlLocation.set(f);f=d.size();this._controlSize.set(f);this._controlForeColor.set(d.foreColor());this._controlBackColor.set(d.backColor());this._controlBackResource.set(d.backResource());this._controlBackGrid.set(d.backGrid())},MO.FDsSystemFrameControlProperty_dispose=function(){this.__base.FDsSystemFrameComponentProperty.dispose.call(this)};
MO.FDsSystemFrameFrameSet=function(b){b=MO.Class.inherits(this,b,MO.FDsSystemDesignFrameSet);b._frameName="system.design.frame.FrameSet";b.onBuilded=MO.FDsSystemFrameFrameSet_onBuilded;b.construct=MO.FDsSystemFrameFrameSet_construct;b.selectObject=MO.FDsSystemFrameFrameSet_selectObject;b.load=MO.FDsSystemFrameFrameSet_load;b.dispose=MO.FDsSystemFrameFrameSet_dispose;return b};
MO.FDsSystemFrameFrameSet_onBuilded=function(b){this.__base.FDsSystemDesignFrameSet.onBuilded.call(this,b);this._frameCatalogToolBar._hPanel.className=this.styleName("Toolbar_Ground");this._frameCatalogContent._hPanel.className=this.styleName("Catalog_Content");this._frameSpaceToolBar._hPanel.className=this.styleName("Toolbar_Ground");this._frameSpaceContent._hPanel.className=this.styleName("Space_Content");this._framePropertyToolBar._hPanel.className=this.styleName("Toolbar_Ground");this._framePropertyContent._hPanel.className=
this.styleName("Property_Content");var d=this._catalogSplitter=this.searchControl("catalogSpliter");d.setAlignCd(MO.EUiAlign.Left);d.setSizeHtml(this._frameCatalog._hPanel);d=this._propertySpliter=this.searchControl("propertySpliter");d.setAlignCd(MO.EUiAlign.Right);d.setSizeHtml(this._frameProperty._hPanel);d=this._catalogToolbar=MO.Class.create(MO.FDsSystemFrameCatalogToolBar);d._workspace=this._workspace;d._frameSet=this;d.buildDefine(b);this._frameCatalogToolBar.push(d);d=this._catalogContent=
MO.Class.create(MO.FDsSystemFrameCatalogContent);d._workspace=this._workspace;d._frameSet=this;d.build(b);this._frameCatalogContent.push(d);d=this._spaceToolBar=MO.Class.create(MO.FDsSystemFrameSpaceToolBar);d._workspace=this._workspace;d._frameSet=this;d.buildDefine(b);this._frameSpaceToolBar.push(d);d=this._spaceContent=MO.Class.create(MO.FDsSystemFrameSpaceContent);d._workspace=this._workspace;d._frameSet=this;d.build(this._frameSpaceContent._hPanel);this._frameSpaceContent.push(d);d=this._propertyToolbar=
MO.Class.create(MO.FDsSystemFramePropertyToolBar);d._workspace=this._workspace;d._frameSet=this;d.buildDefine(b);this._framePropertyToolBar.push(d)};MO.FDsSystemFrameFrameSet_construct=function(){this.__base.FDsSystemDesignFrameSet.construct.call(this)};
MO.FDsSystemFrameFrameSet_selectObject=function(b,d,f){for(var h=this._spaceContent._activeFrame,q=this._propertyFrames,w=q.count(),z=0;z<w;z++){var A=q.at(z);A.hide()}A=this.findPropertyFrame(d);A.show();b==MO.EUiTreeNodeGroup.Container?A.loadObject(h,h):(b=h.findComponent(f),A.loadObject(h,b),this._spaceContent.selectControl(b))};MO.FDsSystemFrameFrameSet_load=function(b){b&&this._spaceContent.loadFrame(b)};MO.FDsSystemFrameFrameSet_dispose=function(){this.__base.FDsSystemDesignFrameSet.dispose.call(this)};
with(MO)MO.FDsSystemFrameMenuBar=function(b){b=RClass.inherits(this,b,FUiMenuBar);b._frameName="system.design.frame.MenuBar";b._controlRefresh=null;b.onBuilded=FDsSystemFrameMenuBar_onBuilded;b.onCreateClick=FDsSystemFrameMenuBar_onCreateClick;b.onUpdateClick=FDsSystemFrameMenuBar_onUpdateClick;b.onDeleteClick=FDsSystemFrameMenuBar_onDeleteClick;return b},MO.FDsSystemFrameMenuBar_onBuilded=function(b){this.__base.FUiMenuBar.onBuilded.call(this,b);this._controlCreate.addClickListener(this,this.onCreateClick);
this._controlUpdate.addClickListener(this,this.onUpdateClick);this._controlDelete.addClickListener(this,this.onDeleteClick)},MO.FDsSystemFrameMenuBar_onCreateClick=function(b){},MO.FDsSystemFrameMenuBar_onUpdateClick=function(b){b=this._frameSet._spaceContent._activeFrame;var d=new TXmlDocument,f=d.root();f.set("action","update");f=f.create("Frame");RGuiControl.saveConfig(b,f);return RConsole.find(FXmlConsole).sendAsync("/cloud.describe.frame.ws?do=update",d)},MO.FDsSystemFrameMenuBar_onDeleteClick=
function(b){};
with(MO)MO.FDsSystemFramePictureProperty=function(b){b=RClass.inherits(this,b,FDsSystemFrameControlProperty);b._activeSpace=null;b._activeRenderable=null;b.onBuilded=FDsSystemFramePictureProperty_onBuilded;b.onDataChanged=FDsSystemFramePictureProperty_onDataChanged;b.construct=FDsSystemFramePictureProperty_construct;b.loadObject=FDsSystemFramePictureProperty_loadObject;b.dispose=FDsSystemFramePictureProperty_dispose;return b},MO.FDsSystemFramePictureProperty_onBuilded=function(b){this.__base.FDsSystemFrameControlProperty.onBuilded.call(this,b)},
MO.FDsSystemFramePictureProperty_onDataChanged=function(b){this.__base.FDsSystemFrameControlProperty.onDataChanged.call(this,b)},MO.FDsSystemFramePictureProperty_construct=function(){this.__base.FDsSystemFrameControlProperty.construct.call(this)},MO.FDsSystemFramePictureProperty_loadObject=function(b,d){this.__base.FDsSystemFrameControlProperty.loadObject.call(this,b,d)},MO.FDsSystemFramePictureProperty_dispose=function(){this.__base.FDsSystemFrameControlProperty.dispose.call(this)};
with(MO)MO.FDsSystemFramePropertyContent=function(b){b=RClass.inherits(this,b,FDsCatalog);b.onBuild=FDsSystemFramePropertyContent_onBuild;b.onNodeClick=FDsSystemFramePropertyContent_onNodeClick;b.construct=FDsSystemFramePropertyContent_construct;b.buildTechnique=FDsSystemFramePropertyContent_buildTechnique;b.buildRegion=FDsSystemFramePropertyContent_buildRegion;b.buildMaterial=FDsSystemFramePropertyContent_buildMaterial;b.buildDisplay=FDsSystemFramePropertyContent_buildDisplay;b.buildSpace=FDsSystemFramePropertyContent_buildSpace;
b.dispose=FDsSystemFramePropertyContent_dispose;return b},MO.FDsSystemFramePropertyContent_onBuild=function(b){this.__base.FDsCatalog.onBuild.call(this,b);this.loadUrl("/cloud.describe.tree.ws?action=query&code=resource.template")},MO.FDsSystemFramePropertyContent_onNodeClick=function(b,d){var f=d.dataPropertyGet("linker");this.selectObject(f)},MO.FDsSystemFramePropertyContent_construct=function(){this.__base.FDsCatalog.construct.call(this)},MO.FDsSystemFramePropertyContent_buildTechnique=function(b,
d){var f=this.createNode();f.setLabel("Technique");f.setTypeCode("technique");f.dataPropertySet("linker",d);b.appendNode(f)},MO.FDsSystemFramePropertyContent_buildRegion=function(b,d){var f=this.createNode();f.setLabel("Region");f.setTypeCode("region");f.dataPropertySet("linker",d);b.appendNode(f);var h=this.createNode();h.setLabel("Camera");h.setTypeCode("camera");h.dataPropertySet("linker",d.camera());f.appendNode(h);h=this.createNode();h.setLabel("Light");h.setTypeCode("light");h.dataPropertySet("linker",
d.directionalLight());f.appendNode(h)},MO.FDsSystemFramePropertyContent_buildMaterial=function(b,d){var f=d.resource(),h=this.createNode();h.setTypeCode("Material");h.setLabel(f.code());h.setNote(f.label());h.dataPropertySet("linker",d);b.appendNode(h)},MO.FDsSystemFramePropertyContent_buildDisplay=function(b,d){var f=d.resource(),h=this.createNode();h.setTypeCode("Display");h.setLabel(RString.nvl(f.code(),"Display"));h.setNote(f.label());h.dataPropertySet("linker",d);b.appendNode(h);var f=d.renderables(),
q=f.count();if(0<q)for(var w=0;w<q;w++){var z=f.at(w),A=z.resource(),B=this.createNode();B.setTypeCode("Renderable");B.setLabel(A.code());B.setNote(A.label());B.dataPropertySet("linker",z);h.appendNode(B)}},MO.FDsSystemFramePropertyContent_buildSpace=function(b){this.clearAllNodes();var d=b.resource(),f=this.createNode();f.setTypeCode("Space");f.setLabel(d.code());f.setNote(d.label());f.dataPropertySet("linker",b);this.appendNode(f);this.buildTechnique(f,b.technique());this.buildRegion(f,b.region());
var h=this.createNode();h.setTypeCode("Region");h.setLabel("Materials");f.appendNode(h);for(var q=b.materials(),w=q.count(),d=0;d<w;d++){var z=q.at(d);this.buildMaterial(h,z)}h=this.createNode();h.setTypeCode("Region");h.setLabel("Displays");f.appendNode(h);b=b._sprites;q=b.count();for(d=0;d<q;d++)w=b.at(d),this.buildDisplay(h,w);f.click()},MO.FDsSystemFramePropertyContent_dispose=function(){this.__base.FDsCatalog.dispose.call(this)};
with(MO)MO.FDsSystemFramePropertyToolBar=function(b){b=RClass.inherits(this,b,FUiToolBar);b._frameName="system.design.frame.PropertyToolBar";b._controlInsertButton=null;b._controlUpdateButton=null;b._controlDeleteButton=null;b.onBuilded=FDsSystemFramePropertyToolBar_onBuilded;b.onUpdateClick=FDsSystemFramePropertyToolBar_onUpdateClick;b.construct=FDsSystemFramePropertyToolBar_construct;b.dispose=FDsSystemFramePropertyToolBar_dispose;return b},MO.FDsSystemFramePropertyToolBar_onBuilded=function(b){this.__base.FUiToolBar.onBuilded.call(this,
b)},MO.FDsSystemFramePropertyToolBar_onUpdateClick=function(b){window.location="Project.wa?do=detail&guid="+this._workspace._activeProjectGuid},MO.FDsSystemFramePropertyToolBar_construct=function(){this.__base.FUiToolBar.construct.call(this)},MO.FDsSystemFramePropertyToolBar_dispose=function(){this.__base.FUiToolBar.dispose.call(this)};
MO.FDsSystemFrameSpaceContent=function(b){b=MO.Class.inherits(this,b,MO.FDuiControl,MO.MGraphicObject);b._scaleRate=1;b._optionAlpha=!1;b._desktop=MO.Class.register(b,new MO.AGetter("_desktop"));b._guiManager=MO.Class.register(b,new MO.AGetter("_guiManager"));b._activeStage=MO.Class.register(b,new MO.AGetter("_activeStage"));b._activeFrame=null;b._activeControls=null;b._capturePosition=null;b._captureRotation=null;b.onEnterFrame=MO.FDsSystemFrameSpaceContent_onEnterFrame;b.onMouseCaptureStart=MO.FDsSystemFrameSpaceContent_onMouseCaptureStart;
b.onMouseCapture=MO.FDsSystemFrameSpaceContent_onMouseCapture;b.onMouseCaptureStop=MO.FDsSystemFrameSpaceContent_onMouseCaptureStop;b.onResize=MO.FDsSystemFrameSpaceContent_onResize;b.onProcess=MO.FDsSystemFrameSpaceContent_onProcess;b.onKeyDown=MO.FDsSystemFrameSpaceContent_onKeyDown;b.oeResize=MO.FDsSystemFrameSpaceContent_oeResize;b.oeFrame=MO.FDsSystemFrameSpaceContent_oeFrame;b.construct=MO.FDsSystemFrameSpaceContent_construct;b.build=MO.FDsSystemFrameSpaceContent_build;b.controlAction=MO.FDsSystemFrameSpaceContent_controlAction;
b.selectControl=MO.FDsSystemFrameSpaceContent_selectControl;b.loadFrame=MO.FDsSystemFrameSpaceContent_loadFrame;b.dispose=MO.FDsSystemFrameSpaceContent_dispose;return b};
MO.FDsSystemFrameSpaceContent_onEnterFrame=function(){var b=this._activeStage;if(b){var d=b.camera(),f=.05,h=MO.RKeyboard.isPress(MO.EKeyCode.W),q=MO.RKeyboard.isPress(MO.EKeyCode.S);h&&!q&&d.doWalk(.5);!h&&q&&d.doWalk(-.5);h=MO.RKeyboard.isPress(MO.EKeyCode.A);q=MO.RKeyboard.isPress(MO.EKeyCode.D);h&&!q&&d.doYaw(f);!h&&q&&d.doYaw(-f);h=MO.RKeyboard.isPress(MO.EKeyCode.Q);q=MO.RKeyboard.isPress(MO.EKeyCode.E);h&&!q&&d.doFly(.5);!h&&q&&d.doFly(-.5);q=MO.RKeyboard.isPress(MO.EKeyCode.Z);h=MO.RKeyboard.isPress(MO.EKeyCode.X);
q&&!h&&d.doPitch(f);!q&&h&&d.doPitch(-f);d.update();if(this._optionRotation){f=this._rotation;b=b.layers();d=b.count();for(h=0;h<d;h++)q=b.value(h).matrix(),q.setRotation(0,f.y,0),q.update();f.y+=.01}}};MO.FDsSystemFrameSpaceContent_onMouseCaptureStart=function(b){var d=this._activeStage;if(d){var f=this._activeStage.region();MO.Console.find(MO.FG3dTechniqueConsole).find(this._graphicContext,MO.FG3dSelectTechnique).test(f,b.offsetX,b.offsetY);this._capturePosition.set(b.clientX,b.clientY);this._captureRotation.assign(d.camera()._rotation)}};
MO.FDsSystemFrameSpaceContent_onMouseCapture=function(b){if(this._activeStage){var d=b.clientX-this._capturePosition.x;b=b.clientY-this._capturePosition.y;var f=this._activeStage.camera().rotation(),h=this._captureRotation;f.x=h.x+.003*b;f.y=h.y+.003*d}};MO.FDsSystemFrameSpaceContent_onMouseCaptureStop=function(b){};
MO.FDsSystemFrameSpaceContent_onResize=function(){this.__base.FDuiControl.onResize.call(this,event);var b=this._graphicContext.size(),d=this._activeStage;d&&(d=d.camera().projection(),d.size().set(b.width,b.height),d.update())};MO.FDsSystemFrameSpaceContent_onProcess=function(b){(b=this._activeFrame)&&b.psUpdate()};
MO.FDsSystemFrameSpaceContent_controlAction=function(b,d){var f=d.location(),h=d.size();switch(b){case MO.EKeyCode.A:return f.x--,!0;case MO.EKeyCode.W:return f.y--,!0;case MO.EKeyCode.D:return f.x++,!0;case MO.EKeyCode.S:return f.y++,!0;case MO.EKeyCode.J:return h.width--,!0;case MO.EKeyCode.I:return h.height--,!0;case MO.EKeyCode.L:return h.width++,!0;case MO.EKeyCode.K:return h.height++,!0}return!1};
MO.FDsSystemFrameSpaceContent_onKeyDown=function(b){b=b.keyCode;var d=this._activeControls;if(!d.isEmpty()){for(var f=!1,h=d.count(),q=0;q<h;q++){var w=d.at(q);this.controlAction(b,w)&&(f=!0)}f&&this._activeFrame.build()}};MO.FDsSystemFrameSpaceContent_oeResize=function(b){this.__base.FDuiControl.oeResize.call(this,b)};MO.FDsSystemFrameSpaceContent_oeFrame=function(b){this.__base.FDuiControl.oeFrame.call(this,b);this._guiManager.process();return MO.EEventStatus.Stop};
MO.FDsSystemFrameSpaceContent_construct=function(){this.__base.FDuiControl.construct.call(this);this._rotation=new MO.SVector3;this._activeControls=new MO.TObjects;this._capturePosition=new MO.SPoint2;this._captureRotation=new MO.SVector3;MO.RWindow.lsnsKeyDown.register(this,this.onKeyDown)};
MO.FDsSystemFrameSpaceContent_build=function(b){var d=this._desktop=MO.Class.create(MO.FDssDesktop);d.build(b);this.linkGraphicContext(d.canvas3d());b=this._guiManager=MO.Class.create(MO.FGuiCanvasManager);b.linkGraphicContext(d.canvas3d());b.setDesktop(d);b.setCanvas(d.canvas2d());b.setup()};MO.FDsSystemFrameSpaceContent_selectControl=function(b){var d=this._activeControls;d.clear();d.push(b)};
MO.FDsSystemFrameSpaceContent_loadFrame=function(b){var d=this._activeFrame;d&&(this._guiManager.unregister(d),this._activeFrame=null);d=this._activeFrame=MO.Console.find(MO.FGuiFrameConsole).get(this,b);d.setLocation(0,0);this._guiManager.register(d)};MO.FDsSystemFrameSpaceContent_dispose=function(){this._rotation=MO.Lang.Obejct.dispose(this._rotation);this.__base.FDuiControl.dispose.call(this)};
with(MO)MO.FDsSystemFrameSpaceToolBar=function(b){b=RClass.inherits(this,b,FUiToolBar);b._frameName="system.design.frame.SpaceToolBar";b._storageCode=b._frameName;b._controlFolderCreateButton=null;b._controlFolderDeleteButton=null;b._controlFolderPropertyButton=null;b._controlFolderOpenButton=null;b._controlFolderCloseButton=null;b._activeNodeGuid=null;b.onBuilded=FDsSystemFrameSpaceToolBar_onBuilded;b.onFolderCreateClick=FDsSystemFrameSpaceToolBar_onFolderCreateClick;b.onFolderDeleteLoad=FDsSystemFrameSpaceToolBar_onFolderDeleteLoad;
b.onFolderDeleteExcute=FDsSystemFrameSpaceToolBar_onFolderDeleteExcute;b.onFolderDeleteClick=FDsSystemFrameSpaceToolBar_onFolderDeleteClick;b.onFolderPropertyClick=FDsSystemFrameSpaceToolBar_onFolderPropertyClick;b.onFolderOpenClick=FDsSystemFrameSpaceToolBar_onFolderOpenClick;b.onFolderCloseClick=FDsSystemFrameSpaceToolBar_onFolderCloseClick;b.construct=FDsSystemFrameSpaceToolBar_construct;b.dispose=FDsSystemFrameSpaceToolBar_dispose;return b},MO.FDsSystemFrameSpaceToolBar_onBuilded=function(b){this.__base.FUiToolBar.onBuilded.call(this,
b)},MO.FDsSystemFrameSpaceToolBar_onFolderCreateClick=function(b){var d=b=null,f=this._frameSet._catalogContent.focusNode();f&&(b=f.guid(),d=f.label());f=RConsole.find(FUiWindowConsole).find(FDsResourceFolderDialog);f._workspace=this._workspace;f._frameSet=this._frameSet;f._parentGuid=b;f.setNodeParentLabel(d);f.setNodeLabel("");f.switchDataMode(EUiDataMode.Insert);f.showPosition(EUiPosition.Center)},MO.FDsSystemFrameSpaceToolBar_onFolderDeleteLoad=function(b){RConsole.find(FUiDesktopConsole).hide();
b=this._frameSet._catalogContent;var d=this._activeNodeGuid;d&&b.findByGuid(d).removeSelf();this._activeNodeGuid=null},MO.FDsSystemFrameSpaceToolBar_onFolderDeleteExcute=function(b){b.resultCd==EResult.Success&&(b=this._frameSet._catalogContent.focusNode(),RConsole.find(FUiDesktopConsole).showUploading(),this._activeNodeGuid=b._guid,RConsole.find(FDrResourceConsole).doFolderDelete(b._guid).addLoadListener(this,this.onFolderDeleteLoad))},MO.FDsSystemFrameSpaceToolBar_onFolderDeleteClick=function(b){if(!this._frameSet._catalogContent.focusNode())return RConsole.find(FUiMessageConsole).showInfo("\u8bf7\u9009\u4e2d\u76ee\u5f55\u8282\u70b9\u540e\uff0c\u518d\u70b9\u51fb\u64cd\u4f5c\u3002");
RConsole.find(FUiMessageConsole).showConfirm("\u8bf7\u786e\u8ba4\u662f\u5426\u5220\u9664\u5f53\u524d\u76ee\u5f55\uff1f").addResultListener(this,this.onFolderDeleteExcute)},MO.FDsSystemFrameSpaceToolBar_onFolderPropertyClick=function(b){b=this._frameSet._catalogContent.focusNode();if(!b)return RConsole.find(FUiMessageConsole).showInfo("\u8bf7\u9009\u4e2d\u76ee\u5f55\u8282\u70b9\u540e\uff0c\u518d\u70b9\u51fb\u64cd\u4f5c\u3002");var d=null;b._parent&&(d=b._parent.label());var f=RConsole.find(FUiWindowConsole).find(FDsResourceFolderDialog);
f._workspace=this._workspace;f._frameSet=this._frameSet;f._nodeGuid=b._guid;f.setNodeParentLabel(d);f.setNodeLabel(b.label());f.switchDataMode(EUiDataMode.Update);f.showPosition(EUiPosition.Center)},MO.FDsSystemFrameSpaceToolBar_onFolderOpenClick=function(b){},MO.FDsSystemFrameSpaceToolBar_onFolderCloseClick=function(b){},MO.FDsSystemFrameSpaceToolBar_construct=function(){this.__base.FUiToolBar.construct.call(this)},MO.FDsSystemFrameSpaceToolBar_dispose=function(){this.__base.FUiToolBar.dispose.call(this)};
