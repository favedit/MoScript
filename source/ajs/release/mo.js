var MO=new function(){this.version="0.2.0";return this};MO.ELogger=new function(){this.Debug=0;this.Info=1;this.Warn=2;this.Error=3;this.Fatal=4;return this};MO.EProcess=new function(){this.Release=0;this.Process=1;this.Debug=2;return this};MO.EScope=new function(){this.Local=1;this.Session=2;this.Global=3;return this};
with(MO)MO.RRuntime=function(){this.processCd=EProcess.Release;this.isDebug=RRuntime_isDebug;this.isProcess=RRuntime_isProcess;this.isRelease=RRuntime_isRelease;this.setProcessCd=RRuntime_setProcessCd;this.empty=RRuntime_empty;this.nvl=RRuntime_nvl;this.subString=RRuntime_subString;this.className=RRuntime_className;return this},MO.RRuntime_isDebug=function(){return this._processCd==EProcess.Debug},MO.RRuntime_isProcess=function(){return this._processCd==EProcess.Process},MO.RRuntime_isRelease=function(){return this._processCd==
EProcess.Release},MO.RRuntime_setProcessCd=function(a){this._processCd=a},MO.RRuntime_empty=function(){},MO.RRuntime_nvl=function(a,b){return null!=a?a:b},MO.RRuntime_subString=function(a,b,d){if(null==a)return a;var f=0;if(null!=b){var h=a.indexOf(b);-1!=h&&(f=h+b.length)}b=a.length;null!=d&&(h=a.indexOf(d,length),-1!=h&&(b=h));return f>=b?"":a.substring(f,b)},MO.RRuntime_className=function(a){return a&&("function"==typeof a||(a=a.constructor))?this.subString(a.toString(),"function ","("):null},
MO.RRuntime=new RRuntime,MO.Runtime=MO.RRuntime;
with(MO)MO.TArray=function(){this._length=0;this._memory=[];this.isEmpty=TArray_isEmpty;this.length=TArray_length;this.memory=TArray_memory;this.contains=TArray_contains;this.indexOf=TArray_indexOf;this.get=TArray_get;this.set=TArray_set;this.push=TArray_push;this.swap=TArray_swap;this.sort=TArray_sort;this.erase=TArray_erase;this.remove=TArray_remove;this.compress=TArray_compress;this.clear=TArray_clear;this.dispose=TArray_dispose;this.dump=TArray_dump;return this},MO.TArray_isEmpty=function(){return 0==
this._length},MO.TArray_length=function(){return this._length},MO.TArray_memory=function(){return this._memory},MO.TArray_contains=function(a){return-1!=this.indexOf(a)},MO.TArray_indexOf=function(a){for(var b=this._length,d=0;d<b;d++)if(this._memory[d]==a)return d;return-1},MO.TArray_get=function(a){return 0<=a&&a<this._length?this._memory[a]:null},MO.TArray_set=function(a,b){0<=a&&a<this._length&&(this._memory[a]=b)},MO.TArray_push=function(){for(var a=arguments.length,b=0;b<a;b++)this._memory[this._length++]=
arguments[b]},MO.TArray_swap=function(a,b){if(0<=a&&a<this._length&&0<=b&&b<this._length&&a!=b){var d=this._memory[a];this._memory[a]=this._memory[b];this._memory[b]=d}},MO.TArray_sort=function(){this._memory.sort()},MO.TArray_erase=function(a){var b=null;if(0<=a&&a<c)for(this._length--,b=this._memory[a];a<c;a++)this._memory[a]=this._memory[a+1];return b},MO.TArray_remove=function(a){if(null!=a){for(var b=0,d=this._length,f=b;f<d;f++)this._memory[f]!=a&&(this._memory[b++]=this._memory[f]);this._length=
b}return a},MO.TArray_compress=function(){for(var a=this._length,b=0,d=0;d<a;d++){var f=this._memory[d];null!=f&&(this._memory[b++]=f)}this._length=b},MO.TArray_clear=function(){this._length=0},MO.TArray_dispose=function(){this._length=0;this._memory=null},MO.TArray_dump=function(){var a=new TString,b=this._length;a.append(RRuntime.className(this),":",b);if(0<b)for(var d=0;d<b;d++)a.append(" [",this._memory[d],"]");return a.flush()};
with(MO)MO.TAttributes=function(){TDictionary.call(this);this.join=TAttributes_join;this.split=TAttributes_split;this.pack=TAttributes_pack;this.unpack=TAttributes_unpack;this.dump=TAttributes_dump;return this},MO.TAttributes_join=function(a,b){var d=new TString;a||(a="=");b||(b=",");for(var f=this._count,h=0;h<f;h++)0<h&&d.append(b),d.append(this.names[h]),d.append(a),d.append(this.values[h]);return d.flush()},MO.TAttributes_split=function(a,b,d){a=a.split(d);d=a.length;for(var f=0;f<d;f++){var h=
a[f];if(h.length){var k=h.split(b);2==k.length?this.set(RString.trim(k[0]),RString.trim(k[1])):this.set(RString.trim(h),"")}}},MO.TAttributes_pack=function(){for(var a=new TString,b=this._count,d=0;d<b;d++){var f=this.names[d],h=this.values[d],k=f.length;a.append(k.toString().length,k,f);null!=h?(h+="",f=h.length,a.append(f.toString().length,f,h)):a.append("0")}return a.flush()},MO.TAttributes_unpack=function(a){for(var b=this.count=0,d=a.length;b<d;){var f=parseInt(a.substr(b++,1)),h=parseInt(a.substr(b,
f)),k=a.substr(b+f,h),b=b+(f+h),f=parseInt(a.substr(b++,1)),q=null;0<f&&(h=parseInt(a.substr(b,f)),q=a.substr(b+f,h),b+=f+h);this.set(k,q)}},MO.TAttributes_dump=function(){var a=new TString,b=this._count;a.append(RRuntime.className(o)," : ",b);if(0<b){a.append(" (");for(var d=0;d<b;d++)0<d&&a.append(", "),a.append(this._names[d],"=",this._values[d]);a.append(")")}return a.flush()};
with(MO)MO.TDictionary=function(){TMap.call(this);this.dump=TDictionary_dump;return this},MO.TDictionary_dump=function(){var a=new TString,b=this._count;a.append(RRuntime.className(o),": ",b);if(0<b){a.append(" {\n");for(var d=0;d<b;d++)a.append("   ",this._names[d],"=[",this._values[d],"]\n");a.append("}")}return a.flush()};
with(MO)MO.TMap=function(){this._count=0;this._table={};this._names=[];this._values=[];this.isEmpty=TMap_isEmpty;this.count=TMap_count;this.contains=TMap_contains;this.containsValue=TMap_containsValue;this.indexOf=TMap_indexOf;this.indexOfValue=TMap_indexOfValue;this.first=TMap_first;this.last=TMap_last;this.nameAt=TMap_nameAt;this.name=TMap_name;this.at=this.valueAt=TMap_valueAt;this.value=TMap_value;this.setValueAt=TMap_setValueAt;this.setValue=TMap_setValue;this.get=TMap_get;this.set=TMap_set;
this.assign=TMap_assign;this.append=TMap_append;this.insert=TMap_insert;this.remove=TMap_remove;this.removeName=TMap_removeName;this.removeValue=TMap_removeValue;this.rebuild=TMap_rebuild;this.clear=TMap_clear;this.toString=TMap_toString;this.dispose=TMap_dispose;this.dump=TMap_dump;return this},MO.TMap_isEmpty=function(){return 0==this._count},MO.TMap_count=function(){return this._count},MO.TMap_contains=function(a){return null!=a&&null!=this._table[a.toString().toLowerCase()]?!0:!1},MO.TMap_containsValue=
function(a){return-1!=this.indexOfValue(a)},MO.TMap_indexOf=function(a){return null!=a&&(a=this._table[a.toString().toLowerCase()],null!=a)?a:-1},MO.TMap_indexOfValue=function(a){for(var b=this._count,d=0;d<b;d++)if(this._values[n]==a)return n;return-1},MO.TMap_first=function(){return 0<this._count?this._values[0]:null},MO.TMap_last=function(){return 0<this._count?this._values[this._count-1]:null},MO.TMap_nameAt=function(a){return this._names[a]},MO.TMap_name=function(a){return 0<=a&&a<this._count?
this._names[a]:null},MO.TMap_valueAt=function(a){return this._values[a]},MO.TMap_value=function(a){return 0<=a&&a<this._count?this._values[a]:null},MO.TMap_setValueAt=function(a,b){this._values[a]=b},MO.TMap_setValue=function(a,b){0<=a&&a<this._count&&(this._values[a]=b)},MO.TMap_get=function(a,b){if(null!=a){var d=this._table[a.toString().toLowerCase()];if(null!=d)return this._values[d]}return b},MO.TMap_set=function(a,b){if(null!=a){var d=a.toString().toLowerCase(),f=this._table[d];if(null==f||
f>=this._count)f=this._count++,this._names[f]=a,this._table[d]=f;this._values[f]=b}},MO.TMap_assign=function(a){this.clear();this.append(a)},MO.TMap_append=function(a){if(a)for(var b=a.count(),d=0;d<b;d++){var f=a.nameAt(d),h=a.valueAt(d);this.set(f,h)}},MO.TMap_insert=function(a,b,d){var f=this._count;if(0<=a&&a<=f){for(;f>a;f--)this._names[f]=this._names[f-1],this._values[f]=this._values[f-1];this._names[a]=b;this._values[a]=d;this._count++;this.rebuild()}},MO.TMap_remove=function(a){var b=null,
d=this._count;if(0<=a&&a<d){for(b=this._values[a];a<d;a++)this._names[a]=this._names[a+1],this._values[a]=this._values[a+1];this._count--;this.rebuild()}return b},MO.TMap_removeName=function(a){a=this.indexOf(a);return-1!=a?this.remove(a):null},MO.TMap_removeValue=function(a){for(var b=0,d=this._count,f=0;f<d;f++){var h=this._values[f];h!=a&&(b!=f&&(this._names[b]=this._names[f],this._values[b]=h),b++)}this._count=b;this.rebuild()},MO.TMap_rebuild=function(){var a=this._table,b;for(b in a)delete a[b];
b=this._count;for(var d=0;d<b;d++){var f=this._names[d].toLowerCase();a[f]=d}},MO.TMap_clear=function(){this._count=0;for(var a in this._table)delete this._table[a]},MO.TMap_toString=function(){return this.dump().toString()},MO.TMap_dispose=function(){this._count=0;var a=this._table;if(a){for(var b in a)a[b]=null;this._table=null}if(b=this._names){for(a=b.length-1;0<=a;a--)b[a]=null;this._names=null}if(b=this._values){for(a=b.length-1;0<=a;a--)b[a]=null;this._values=null}},MO.TMap_dump=function(){var a=
new TString,b=this._count;a.appendLine(RRuntime.className(o),": ",b);if(0<b){a.append(" {");for(var d=0;d<b;d++)a.appendLine(this._names[d],"=[",this._values[d],"]");a.append("}")}return a.flush()};
with(MO)MO.TObjects=function(){this._count=0;this._items=[];this.isEmpty=TObjects_isEmpty;this.count=TObjects_count;this.items=TObjects_items;this.contains=TObjects_contains;this.indexOf=TObjects_indexOf;this.first=TObjects_first;this.last=TObjects_last;this.at=this.getAt=TObjects_getAt;this.get=TObjects_get;this.setAt=TObjects_setAt;this.set=TObjects_set;this.assign=TObjects_assign;this.append=TObjects_append;this.insert=TObjects_insert;this.shift=TObjects_shift;this.unshift=TObjects_unshift;this.pop=
TObjects_pop;this.push=TObjects_push;this.pushUnique=TObjects_pushUnique;this.swap=TObjects_swap;this.sort=TObjects_sort;this.erase=TObjects_erase;this.remove=TObjects_remove;this.clear=TObjects_clear;this.dispose=TObjects_dispose;this.dump=TObjects_dump;return this},MO.TObjects_isEmpty=function(){return 0==this._count},MO.TObjects_count=function(){return this._count},MO.TObjects_items=function(){return this._items},MO.TObjects_contains=function(a){return-1!=this.indexOf(a)},MO.TObjects_indexOf=function(a){for(var b=
this._count,d=this._items,f=0;f<b;f++)if(d[f]==a)return f;return-1},MO.TObjects_first=function(){return this._count?this._items[0]:null},MO.TObjects_last=function(){return this._count?this._items[this._count-1]:null},MO.TObjects_getAt=function(a){return this._items[a]},MO.TObjects_get=function(a){return 0<=a&&a<this._count?this._items[a]:null},MO.TObjects_setAt=function(a,b){this._items[a]=b},MO.TObjects_set=function(a,b){0<=a&&a<this._count&&(this._items[a]=v)},MO.TObjects_assign=function(a){for(var b=
this._count=a._count,d=0;d<b;d++)this._items[d]=a._items[d]},MO.TObjects_append=function(a){for(var b=a._count,d=0;d<b;d++)this.push(a.at(d))},MO.TObjects_insert=function(a,b){var d=this._count;if(0<=a&&a<=d){for(;d>a;d--)this._items[d]=this._items[d-1];this._items[a]=b}},MO.TObjects_shift=function(){return this.erase(0)},MO.TObjects_unshift=function(a){return this.insert(0,a)},MO.TObjects_pop=function(){if(this._count)return this._items[--this._count]},MO.TObjects_push=function(a){var b=this._count++;
this._items[b]=a;return b},MO.TObjects_pushUnique=function(a){for(var b=this._count-1;0<=b;b--)if(this._items[b]==v)return b;b=this._count++;this._items[b]=a;return b},MO.TObjects_swap=function(a,b){if(0<=a&&a<this._count&&0<=b&&b<this._count&&a!=b){var d=this._items,f=d[a];d[a]=d[b];d[b]=f}},MO.TObjects_sort=function(a){var b=this._items;b.length!=this._count&&(b.length=this._count);b.sort(a)},MO.TObjects_erase=function(a){var b=null;if(0<=a&&a<this._count){for(var b=this._items[a],d=--this._count,
f=this._items;a<d;a++)f[a]=f[a+1];f[d]=null}return b},MO.TObjects_remove=function(a){var b=this._count;if(b){for(var d=0,f=this._items,h=d;h<b;h++)f[h]!=a&&(f[d++]=f[h]);for(h=d;h<b;h++)f[h]=null;this._count=d}return a},MO.TObjects_clear=function(){this._count=0},MO.TObjects_dispose=function(){for(var a in this._items)this._items[a]=null;this._count=0;this._items=null},MO.TObjects_dump=function(){var a=this._count,b=new TString;b.append(RRuntime.className(o),":",a);if(a)for(var d=0;d<a;d++)b.append(" [",
this._items[d],"]");return b.flush()};
with(MO)MO.TString=function(){this._count=0;this._memory=[];this.isEmpty=TString_isEmpty;this.assign=TString_assign;this.append=TString_append;this.appendIf=TString_appendIf;this.appendArray=TString_appendArray;this.appendLine=TString_appendLine;this.appendRepeat=TString_appendRepeat;this.push=TString_push;this.clear=TString_clear;this.toString=TString_toString;this.flush=TString_flush;this.dispose=TString_dispose;this.dump=TString_dump;return this},MO.TString_isEmpty=function(){return 0==this._count},
MO.TString_assign=function(){this.clear();this.appendArray(arguments,0,arguments.length)},MO.TString_append=function(a){this.appendArray(arguments,0,arguments.length)},MO.TString_appendIf=function(a){a&&this.appendArray(arguments,1,arguments.length-1)},MO.TString_appendArray=function(a,b,d){for(var f=0;f<d;f++){var h=a[b++];null!=h&&(this._memory[this._count++]=h)}},MO.TString_appendRepeat=function(a,b){for(var d=0;d<b;d++)this._memory[this._count++]=a},MO.TString_appendLine=function(){this.appendArray(arguments,
0,arguments.length);this._memory[this._count++]="\r\n"},MO.TString_push=function(){this.appendArray(arguments,0,arguments.length)},MO.TString_clear=function(){this._count=0},MO.TString_toString=function(){var a=this._memory;a.length!=this._count&&(a=a.slice(0,this._count));return a.join("")},MO.TString_flush=function(){var a=this.toString();this.dispose();return a},MO.TString_dispose=function(){this._count=0;var a=this._memory;if(a){for(var b=a.length-1;0<=b;b--)a[b]=null;this._memory=null}},MO.TString_dump=
function(){var a=this.toString();return RRuntime.className(o)+":"+a.length+"["+a+"]"};
with(MO)MO.RAssert=function(){this.isTrue=RAssert_isTrue;this.isFalse=RAssert_isFalse;this.debugEnd=this.debug=this.debugBegin=MO.Runtime.empty;this.debugTrue=RAssert_debugTrue;this.debugFalse=RAssert_debugFalse;this.debugNull=RAssert_debugNull;this.debugNotNull=RAssert_debugNotNull;this.debugEmpty=RAssert_debugEmpty;this.debugNotEmpty=RAssert_debugNotEmpty;return this},MO.RAssert_isTrue=function(a){if(!a)throw Error("Assert ture failure.");},MO.RAssert_isFalse=function(a){if(a)throw Error("Assert false failure.");
},MO.RAssert_debugTrue=function(a){if(!a)throw Error("Assert true failure.");},MO.RAssert_debugFalse=function(a){if(a)throw Error("Assert false failure.");},MO.RAssert_debugNull=function(a){if(null!=a)throw Error("Assert null failure.");},MO.RAssert_debugNotNull=function(a){if(null==a)throw Error("Assert not null failure.");},MO.RAssert_debugEmpty=function(a){if(null!=a)throw Error("Assert empty failure.");},MO.RAssert_debugNotEmpty=function(a){if(null==a)throw Error("Assert not empty failure.");
},MO.RAssert=new RAssert;
with(MO)MO.RMemory=function(){this._entryUnused=null;this._pools={};this.entryAlloc=RMemory_entryAlloc;this.entryFree=RMemory_entryFree;this.alloc=RMemory_alloc;this.free=RMemory_free;this.refresh=RMemory_refresh;return this},MO.RMemory_entryAlloc=function(){var a=null,b=this._entryUnused;b?(a=b,this._entryUnused=b.next):a=new SMemoryPoolEntry;return a},MO.RMemory_entryFree=function(a){RAssert.debugNotNull(a);a.next=this._entryUnused;this._entryUnused=a},MO.RMemory_alloc=function(a){RAssert.debugNotNull(a);
var b=RRuntime.className(a),d=this._pools,f=d[b];f||(f=new TMemoryPool,f._constructor=a,d[b]=f);return f.alloc()},MO.RMemory_free=function(a){RAssert.debugNotNull(a);var b=a.__pool;RAssert.debugNotNull(b);b.free(a)},MO.RMemory_refresh=function(){CollectGarbage()},MO.RMemory=new RMemory;
with(MO)MO.SMemoryPoolEntry=function(){this.value=this.next=null;this.dispose=SMemoryPoolEntry_dispose;return this},MO.SMemoryPoolEntry_dispose=function(){var a=this.value;a&&(a.__pool=null,a.dispose());this.value=this.next=null};
with(MO)MO.TMemoryPool=function(){this._unused=this._constructor=null;this._freeCount=this._allocCount=this._createCount=0;this.alloc=TMemoryPool_alloc;this.free=TMemoryPool_free;this.dispose=TMemoryPool_dispose;this.dump=TMemoryPool_dump;return this},MO.TMemoryPool_alloc=function(){var a=null,b=this._unused;b?(a=b.value,this._unused=b.next,RMemory.entryFree(b)):(a=new this._constructor,a.__pool=o,this._createCount++);this._allocCount++;return a},MO.TMemoryPool_free=function(a){RAssert.debugNotNull(a);
var b=RMemory.entryAlloc();b.value=a;b.next=this._unused;this._unused=b;this._freeCount++},MO.TMemoryPool_dispose=function(){for(var a=this._unused;a;){var b=a,a=b.next;b.dispose();RMemory.entryFree(b)}},MO.TMemoryPool_dump=function(){var a=new TString;a.append("Pool:");a.append("create=",this._createCount);a.append(", alloc=",this._allocCount);a.append(", free=",this._freeCount);return a.flush()};
with(MO)MO.SLooperEntry=function(){this.value=this.next=this.prior=null;this.dispose=SLooperEntry_dispose;return this},MO.SLooperEntry_dispose=function(){this.value=this.next=this.prior=null};
with(MO)MO.TLooper=function(){this._recordCount=this._count=0;this._current=null;this.innerPush=TLooper_innerPush;this.innerRemove=TLooper_innerRemove;this.innerRemoveCurrent=TLooper_innerRemoveCurrent;this.innerRemoveValue=TLooper_innerRemoveValue;this.isEmpty=TLooper_isEmpty;this.count=TLooper_count;this.record=TLooper_record;this.unrecord=TLooper_unrecord;this.contains=TLooper_contains;this.current=TLooper_current;this.next=TLooper_next;this.push=TLooper_push;this.pushUnique=TLooper_pushUnique;
this.removeCurrent=TLooper_removeCurrent;this.remove=TLooper_remove;this.clear=TLooper_clear;this.dispose=TLooper_dispose;this.dump=TLooper_dump;return this},MO.TLooper_innerPush=function(a){var b=this._current;if(b){var d=b.prior;a.prior=d;a.next=b;d.next=a;b.prior=a}else a.prior=a,this._current=a.next=a;this._count++},MO.TLooper_innerRemove=function(a){var b=a.prior,d=a.next;b.next=d;d.prior=b;this._count--;this._current=0<this._count?d:null;RMemory.free(a)},MO.TLooper_innerRemoveCurrent=function(){var a=
null;if(0<this._count){var b=this._current,a=b.value;this.innerRemove(b)}return a},MO.TLooper_innerRemoveValue=function(a){if(0<this._count)if(this._current.value==a)this.innerRemoveCurrent();else for(var b=this._current,d=b.next;d!=b;){if(d.value==a){this.innerRemove(d);this._current=b;break}d=d.next}},MO.TLooper_isEmpty=function(){return 0==this._count},MO.TLooper_count=function(){return this._count},MO.TLooper_record=function(){this._recordCount=this._count},MO.TLooper_unrecord=function(a){this._recordCount=
-1},MO.TLooper_contains=function(a){if(this._current)for(var b=this._current,d=this._count,f=0;f<d;f++){if(b.value==a)return!0;b=b.next}return!1},MO.TLooper_current=function(){var a=this._current;return a?a.value:null},MO.TLooper_next=function(){this._current&&(this._current=this._current.next);var a=this._recordCount;if(0<a)this._recordCount--;else if(0==a)return null;return this._current?this._current.value:null},MO.TLooper_push=function(a){var b=RMemory.alloc(SLooperEntry);b.value=a;this.innerPush(b)},
MO.TLooper_pushUnique=function(a){this.contains(a)||this.push(a)},MO.TLooper_removeCurrent=function(){return this.innerRemoveCurrent()},MO.TLooper_remove=function(a){this.innerRemoveValue(a)},MO.TLooper_clear=function(){var a=this._current;if(a)for(a.prior.next=null;a;)a=a.next,MO.Memory.free(a);this._count=0;this._current=null},MO.TLooper_dispose=function(){this.clear()},MO.TLooper_dump=function(){var a=this._count,b=new TString;b.append(RClass.name(this),": ",a);if(0<a)for(var d=this._current,f=
0;f<a;f++)b.append(" [",d.value,"]"),d=d.next;return b.flush()};
with(MO)MO.RGlobal=function(){this._instances=new TDictionary;this.get=RGlobal_get;this.set=RGlobal_set;this.globalGet=RGlobal_globalGet;this.globalSet=RGlobal_globalSet;return this},MO.RGlobal_get=function(a){return this._instances.get(a)},MO.RGlobal_set=function(a,b){this._instances.set(a,b)},MO.RGlobal_globalGet=function(a){var b=null;return b=top.MO.Global?top.MO.Global.get(a):this._instances.get(a)},MO.RGlobal_globalSet=function(a,b){top.MO.Global?top.MO.Global.set(a,b):this._instances.set(a,
b)},MO.RGlobal=new RGlobal;with(MO)MO.AAnnotation=function(a){this._annotationCd=null;this._duplicate=this._inherit=!1;this._name=a;this.annotationCd=AAnnotation_annotationCd;this.name=AAnnotation_name;this.code=AAnnotation_code;this.value=AAnnotation_value;return this},MO.AAnnotation_annotationCd=function(){return this._annotationCd},MO.AAnnotation_name=function(){return this._name},MO.AAnnotation_code=function(){return this._name},MO.AAnnotation_value=function(){return null};
with(MO)MO.AEnum=function(a,b){this.inherit=!0;this.annotation=EAnnotation.Enum;this.name=a;this.linker=b;return this};with(MO)MO.ALinker=function(a,b){this.inherit=!0;this.annotation=EAnnotation.Linker;this.name=a;this.linker=b;return this};
with(MO)MO.AProperty=function(a,b){AAnnotation.call(this,a);this._inherit=!0;this._annotationCd=EAnnotation.Property;this._linker=null;this._force=!1;this.code=AProperty_code;this.build=AProperty_build;this.load=AProperty_load;this.save=AProperty_save;this.toString=AProperty_toString;var d=null;null==b?(d=RString.startsWith(n,"_")?n.substring(1):n,d=RString.toUnderline(d)):d=b;this._linker=d;return this},MO.AProperty_code=function(){return this._linker},MO.AProperty_build=function(){},MO.AProperty_load=
function(a,b){a[this._name]=b.get(this._linker)},MO.AProperty_save=function(a,b){b.set(this._linker,a[this._name])},MO.AProperty_toString=function(){return"<"+this._annotationCd+",linker="+this._linker+">"};MO.EAnnotation=new function(){this.Property="property";this.Event="enum";this.Event="event";this.Linker="linker";this.Style="style";this.StyleIcon="icon";return this};MO.EBoolean=new function(){this.True="Y";this.False="N";return this};
MO.ECharCase=new function(){this.Upper="U";this.Lower="L";this.Word="W";return this};MO.EDataType=new function(){this.Unknown=0;this.Int8=1;this.Int16=2;this.Int32=3;this.Int64=4;this.Uint8=5;this.Uint16=6;this.Uint32=7;this.Uint64=8;this.Float16=9;this.Float32=10;this.Float64=11;this.String=12;return this};MO.EEndian=new function(){this.Big=0;this.Little=1;return this};MO.ENodeType=new function(){this.Node=1;this.Text=3;this.Data=4;return this};
MO.ENumber=new function(){this.Integer="I";this.PositiveInteger="PI";this.NegativeInteger="NI";this.Float="F";this.PositiveFloat="PF";this.NegativeFloat="NF";return this};MO.ERegExp=new function(){this.I=/^-?[1-9]\d*|0$/;this.PI=/^[1-9]\d*$/;this.NI=/^-[1-9]\d*$/;this.F=/^-?([1-9]\d*\.\d*|0\.\d*[1-9]\d*|0?\.0+|0)$/;this.PF=/^[1-9]\d*\.\d*|0\.\d*[1-9]\d*$/;this.NF=/^-([1-9]\d*\.\d*|0\.\d*[1-9]\d*)$/;this.U=/[1-9]{1}[0-9]/;this.E=/^\w{1,}[@]{1}[a-zA-Z]{1,}[.]{1}[a-zA-Z]{1,}$/;return this};
MO.EResult=new function(){this.Success=0;this.Continue=1;this.Skip=2;this.Finish=3;this.Failure=-1;this.Cancel=-2;return this};with(MO)MO.MInstance=function(a){a=RClass.inherits(this,a);a.__free=!1;a.instanceCreate=RMethod.empty;a.instanceAlloc=RMethod.empty;a.instanceFree=RMethod.empty;a.instanceRelease=RMethod.empty;return a};with(MO)MO.MInvoke=function(a){a=RClass.inherits(this,a);a.invoke=RMethod.virtual(a,"invoke");return a};
with(MO)MO.MPoolAble=function(a){a=RClass.inherits(this,a);a._poolCode=null;a.poolCode=MPoolAble_poolCode;a.setPoolCode=MPoolAble_setPoolCode;return a},MO.MPoolAble_poolCode=function(){return this._code},MO.MPoolAble_setPoolCode=function(a){this._poolCode=a};with(MO)MO.SArguments=function(){this.owner=null;return this};with(MO)MO.SEnumItem=function(){this.name=null;this.value=0;return this};
with(MO)MO.TClass=function(){this.__disposed=!0;this._unused=null;this._annotations={};this._attributes={};this.instance=this.clazz=this.base=this.parent=this.name=null;this._abstract=!1;this.styles=[];this.instances=[];this.register=TClass_register;this.assign=TClass_assign;this.annotations=TClass_annotations;this.annotation=TClass_annotation;this.annotationFind=TClass_annotationFind;this.attributeFind=TClass_attributeFind;this.style=TClass_style;this.build=TClass_build;this.newInstance=TClass_newInstance;
this.free=TClass_free;this.alloc=TClass_alloc;return this},MO.TClass_register=function(a){var b=a.annotationCd(),d=a.name(),f=a.code();if(!b||!f)throw new TError(this,"Unknown annotation. (class={1},annotation={2},name={3},code={4})",RClass.dump(this),b,d,f);var h=this._annotations[b];h||(h=this._annotations[b]={});if(!a._duplicate&&h[f])throw new TError(this,"Duplicate annotation. (class={1},annotation={2},name={3},code={4},value={5})",RClass.dump(this),b,d,f,a.toString());h[f]=a;this._attributes[d]=
a},MO.TClass_assign=function(a){for(var b in a._annotations){var d=this._annotations[b];d||(d=this._annotations[b]={});var f=a._annotations[b],h;for(h in f){var k=f[h];if(!k._duplicate&&d[h])throw new TError(this,"Duplicate annotation. (annotation={1}, {2}.{3}={4}.{5}, source={6})",b,this.name,h,a.name,h,k.toString());k._inherit&&(d[h]=k)}}for(h in a._attributes)k=a._attributes[h],k.construct!=Function&&(this._attributes[h]=a._attributes[h])},MO.TClass_annotations=function(a){var b=this._annotations[a];
b||RLogger.fatal(this,null,"Can't find annotations. (annotation={1}, class={2})",a,this.name);return b},MO.TClass_annotation=function(a,b){var d=null,f=this._annotations[a];f&&(d=f[b]);d||RLogger.fatal(this,null,"Can't find annotation. (annotation={1}, name={2}, class={3})",a,b,this.name);return d},MO.TClass_annotationFind=function(a){for(var b in this._annotations){var d=this._annotations[b];if(d&&(d=d[a],null!=d&&d.constructor!=Function))return d}return null},MO.TClass_attributeFind=function(a){return(a=
this._attributes[a])&&a.constructor!=Function?a:null},MO.TClass_style=function(a){if(this.styles[a])return this.styles[a];for(var b=null,d=this;d;){var f=d._annotations[EAnnotation.Style];if(f&&(b=f[a]))break;d=d.parent}b||RLogger.fatal(this,null,"No register style annotation. (name={1}, linker={2}, class={3})",this.name+"_"+a,this.liner,this.name);b=d.name+"_"+b.style();return this.styles[a]=b},MO.TClass_build=function(){for(var a in this.instance){var b=this.instance[a];if(null!=b&&b.constructor==
Function&&b.__virtual){this._abstract=!0;break}}if(b=this._annotations[EAnnotation.Property])for(a in b)b[a].build(this.instance)},MO.TClass_newInstance=function(){var a=this.alloc();if(!a){if(this._abstract){var a=new TString,b;for(b in this.instance){var d=this.instance[b];RMethod.isVirtual(d)&&(a.isEmpty()||a.append(","),a.append(d._name))}return RLogger.fatal(this,null,"Abstract Class can't be create.(name={1})\n[{2}]",this.name,a)}var f=this.instance;if(!f)return RLogger.fatal(this,null,"Class instance is empty. (name={1})",
this.name);a=new f.constructor;for(b in f){d=f[b];if(null!=d){if("__base"==b||"__inherits"==b){a[b]=f[b];continue}RClass.isBase(d)||(d=RObject.clone(d))}a[b]=d}a.__class=this;a.construct&&a.construct()}return a},MO.TClass_alloc=function(){var a=this._unused;a&&(this._unused=a.cnext,a.cnext=null,a._using=!0);return a},MO.TClass_free=function(a){if(a._using){a.cnext=this._unused;this._unused=a;a._using=!1;for(var b in a){var d=a[b];if(d&&!RClass.isBase(d))if(d._class)this.free(d);else if(this.isClass(d,
Array))for(var f=0;f<d.length;f++){var h=d[f];h._class&&this.free(h)}}}};with(MO)MO.TClassBase=function(){this.__disposed=!0;return this};with(MO)MO.TContext=function(a,b,d){this.name=a;this.code=b;this.text=d;return this};
with(MO)MO.TDataset=function(){this._code=null;this._pageSize=20;this._total=this._pageCount=this._pageIndex=0;this._rows=new TObjects;this.isEmpty=TDataset_isEmpty;this.createRow=TDataset_createRow;this.count=TDataset_count;this.row=TDataset_row;this.rows=TDataset_rows;this.find=TDataset_find;this.push=TDataset_push;this.loadConfig=TDataset_loadConfig;this.clear=TDataset_clear;return this},MO.TDataset_isEmpty=function(){return this._rows.isEmpty()},MO.TDataset_createRow=function(){var a=new TRow;
a._dataset=this;this._rows.push(a);return a},MO.TDataset_count=function(){return this._rows.count()},MO.TDataset_row=function(a){return this._rows.get(a)},MO.TDataset_rows=function(){return this._rows},MO.TDataset_find=function(a){var b=arguments,d=b.length;if(0!=d%2)throw new TError(this,"Parameters must is pairs (length={1})",d);for(var f=this._rows,h=f.count(),k=0;k<h;k++){for(var q=f.get(k),w=!0,x=0;x<d;x+=2)if(q.get(b[k])!=b[k+1]){w=!1;break}if(w)return q}return null},MO.TDataset_push=function(a){this._rows.push(a)},
MO.TDataset_loadConfig=function(a){this._code=a.get("name");this._pageSize=RInteger.parse(a.get("page_size",1E3));this._pageIndex=RInteger.parse(a.get("page",0));this._pageCount=RInteger.parse(a.get("page_count",1));this._total=RInteger.parse(a.get("total"));if(a=a.nodes())for(var b=a.count(),d=0;d<b;d++){var f=a.get(d);f.isName("Row")&&this.createRow().loadConfig(f)}},MO.TDataset_clear=function(){this._pageSize=20;this._total=this._pageCount=this._pageIndex=0;this._rows.clear()},MO.TDataset_findIndex=
function(a){for(var b=this._rows,d=b.count(),f=0;f<d;f++){var h=b.get(f);if(h._index=a)return h}return null},MO.TDataset_remove=function(a){return this._rows.remove(a)},MO.TDataset_removeRow=function(a){a=this.indexOf(a);-1!=a&&this._rows.remove(a)},MO.TDataset_saveViewer=function(a){a.datasetName=this._code;a.datasetId=this.id;a.position=0;a.start=0;a._count=this._rows._count;a._rows=this._rows;a.dataset=this},MO.TDataset_pack=function(){for(var a=this._rows,b=new TStrings,d=0;d<a._count;d++)b.push(a.get(d).pack());
return b.pack()},MO.TDataset_dump=function(){var a=new TString;a.append(RClass._code(this));a.append(" count=",this._count);a.append(" fields=",this.fieldCount);a.appendLine();if(this._rows)for(var b=this._count,d=0;d<b;d++)a.append("- "),this._rows.get(d).dump(s),d!=this._count-1&&a.appendLine();return a.toString()};
with(MO)MO.TDatasetViewer=function(){this._datasetId=null;this._count=this._start=this._position=0;this._ouids=this._rows=e._values=null;this.isEmpty=TDatasetViewer_isEmpty;this.count=TDatasetViewer_count;this.current=TDatasetViewer_current;this.reset=TDatasetViewer_reset;this.move=TDatasetViewer_move;this.moveToRow=TDatasetViewer_moveToRow;this.first=TDatasetViewer_first;this.prior=TDatasetViewer_prior;this.next=TDatasetViewer_next;this.last=TDatasetViewer_last;return this},MO.TDatasetViewer_isEmpty=
function(){return null==this._count},MO.TDatasetViewer_count=function(){return this._count},MO.TDatasetViewer_current=function(){var a=this._rows;return a?a.get(this._position-this._start):null},MO.TDatasetViewer_reset=function(){this._position=-1},MO.TDatasetViewer_move=function(a){this._position=a},MO.TDatasetViewer_moveToRow=function(a){a=this._rows.indexOf(a);-1!=a&&(this._position=a-this._start)},MO.TDatasetViewer_first=function(a){this._position=a?-1:0},MO.TDatasetViewer_prior=function(){return 0<
this._position?(this._position--,!0):!1},MO.TDatasetViewer_next=function(){return this._position<this._count-1?(this._position++,!0):!1},MO.TDatasetViewer_last=function(){this._position=this._count-1};
with(MO)MO.TDate=function(a){this.date=a?a:new Date;this.ms=this.second=this.minute=this.hour=this.day=this.month=this.year=null;this.equals=TDate_equals;this.isBefore=TDate_isBefore;this.isAfter=TDate_isAfter;this.monthDays=TDate_monthDays;this.monthWeekDay=TDate_monthWeekDay;this.weekDay=TDate_weekDay;this.setYear=TDate_setYear;this.setMonth=TDate_setMonth;this.setDay=TDate_setDay;this.setHour=TDate_setHour;this.setMinute=TDate_setMinute;this.setSecond=TDate_setSecond;this.addYear=TDate_addYear;
this.addMonth=TDate_addMonth;this.addDay=TDate_addDay;this.addMseconds=TDate_addMseconds;this.refresh=TDate_refresh;this.setDate=TDate_setDate;this.now=TDate_now;this.clone=TDate_clone;this.dump=TDate_dump;this.refresh();return this},MO.TDate_clone=function(){var a=new Date;a.setTime(this.date.getTime());return new TDate(a)},MO.TDate_equals=function(a){return this.date.getTime()==a.date.getTime()},MO.TDate_isBefore=function(a){return this.date.getTime()<a.date.getTime()},MO.TDate_isAfter=function(a){return this.date.getTime()>
a.date.getTime()},MO.TDate_monthDays=function(){return RDate.monthDays(this.year,this.month)},MO.TDate_monthWeekDay=function(){return(8-(this.day-this.weekDay())%7)%7},MO.TDate_weekDay=function(){return this.date.getDay()},MO.TDate_setYear=function(a){this.date.setFullYear(a);this.refresh()},MO.TDate_setMonth=function(a){this.date.setMonth(parseInt(a,10)-1);this.refresh()},MO.TDate_setDay=function(a){this.date.setDate(a);this.refresh()},MO.TDate_setHour=function(a){this.date.setHours(a);this.refresh()},
MO.TDate_setMinute=function(a){this.date.setMinutes(a);this.refresh()},MO.TDate_setSecond=function(a){this.date.setSeconds(a);this.refresh()},MO.TDate_addYear=function(a){this.date.setFullYear(this.date.getFullYear()+parseInt(a));this.refresh()},MO.TDate_addMonth=function(a){this.date.setMonth(this.date.getMonth()+parseInt(a));this.refresh()},MO.TDate_addDay=function(a){this.date.setTime(this.date.getTime()+864E5*parseInt(a));this.refresh()},MO.TDate_addMseconds=function(a){this.date.setTime(this.date.getTime()+
parseInt(a));this.refresh()},MO.TDate_refresh=function(){var a=this.date;a&&(this.year=a.getFullYear(),this.month=a.getMonth()+1,this.day=a.getDate(),this.hour=a.getHours(),this.minute=a.getMinutes(),this.second=a.getSeconds(),this.ms=a.getMilliseconds())},MO.TDate_setDate=function(a){this.date=a;this.refresh()},MO.TDate_now=function(){this.date=new Date;this.refresh()},MO.TDate_dump=function(){return RClass.dump(this)+" "+RDate.formatDate(this)};
with(MO)MO.TError=function TError(b,d,f){for(var h=new TString,k=TError.caller,q=new TString,w=[];k&&!RArray.contains(w,k);)w.push(k),k=k.caller;for(var x=w.length,y=0;y<x;y++)k=w[y],0<y&&q.appendLine(),q.append("   "+(x-y)+": "+RMethod.name(k));k=arguments;x=k.length;for(y=2;y<x;y++){var w=k[y],z=null,z="function"==typeof w?RMethod.name(w):w;d=d.replace("{"+(y-1)+"}",z)}h.appendLine(d);h.appendLine("------------------------------------------------------------");h.append(q);h=h.flush();alert(h)};
with(MO)MO.TFatalError=function TFatalError(b,d,f,h){for(var k=new TString,q=TFatalError.caller,w=new TString,x=[];q&&!RArray.contains(x,q);)x.push(q),q=q.caller;for(var y=x.length,z=0;z<y;z++)q=x[z],0<z&&w.appendLine(),w.append("   "+(y-z)+": "+RMethod.name(q));q=arguments;y=q.length;for(z=2;z<y;z++){var x=q[z],A=null,A="function"==typeof x?RMethod.name(x):x;f=f.replace("{"+(z-1)+"}",A)}k.appendLine(f);k.appendLine("------------------------------------------------------------");k.append(w);throw Error(k);
};
with(MO)MO.TInstancePool=function(){TObjects.call(this);this._instance=null;this.instance=TInstancePool_instance;this.alloc=TInstancePool_alloc;this.free=TInstancePool_free;return this},MO.TInstancePool_instance=function(a){var b=this._instance;null==b&&(b=this._instance=RClass.create(a),b.instanceCreate());b.instanceAlloc();return b},MO.TInstancePool_alloc=function(a){var b=null;0==this._count?(b=RClass.create(a),b.instanceCreate()):b=this.pop();b.instanceAlloc();return b},MO.TInstancePool_free=function(a){a.instanceFree();
return this.push(a)};with(MO)MO.TInvoke=function(){this.callback=this.owner=null;this.invoke=TInvoke_invoke;return this},MO.TInvoke_invoke=function(a,b,d,f,h,k){if(this.callback){var q=this.owner?this.owner:this;try{this.callback.call(q,a,b,d,f,h,k)}catch(w){RLogger.fatal(this,w,"Call method failure. (owner={1}, callback={2})",q,this.callback)}}};
with(MO)MO.TListener=function(){this._callback=this._owner=null;this.process=TListener_process;this.toString=TListener_toString;this.dispose=TListener_dispose;return this},MO.TListener_process=function(a,b,d,f,h,k){this._callback.call(this._owner?this._owner:this,a,b,d,f,h,k)},MO.TListener_toString=function(){return RClass.name(this)+"(owner="+RClass.name(this._owner)+", callback="+RMethod.name(this._callback)+")"},MO.TListener_dispose=function(){this._callback=this._owner=null;RObject.free(this)};
with(MO)MO.TListeners=function(){this._listeners=null;this.isEmpty=TListeners_isEmpty;this.find=TListeners_find;this.register=TListeners_register;this.unregister=TListeners_unregister;this.push=TListeners_push;this.remove=TListeners_remove;this.process=TListeners_process;this.clear=TListeners_clear;this.dispose=TListeners_dispose;this.dump=TListeners_dump;return this},MO.TListeners_isEmpty=function(){var a=this._listeners;return a?a.isEmpty():!0},MO.TListeners_find=function(a,b){var d=this._listeners;
if(d)for(var f=d.count(),h=0;h<f;h++){var k=d.getAt(h);if(k._owner==a&&k._callback==b)return k}return null},MO.TListeners_register=function(a,b){var d=this.find(a,b);if(d)throw new TError(this,"Listener is already register. (owner={1}, process={2})",a,b);d=new TListener;d._owner=a;d._callback=b;this.push(d);return d},MO.TListeners_unregister=function(a,b){var d=this.find(a,b);if(!d)throw new TError(this,"Listener is not register. (owner={1}, process={2})",a,b);this.remove(d);d.dispose()},MO.TListeners_push=
function(a){if(!a)throw new TError(this,"Listener is null.");if(!a._callback)throw new TError(this,"Listener process is null.");var b=this._listeners;b||(b=this._listeners=new TObjects);b.push(a)},MO.TListeners_remove=function(a){if(!a)throw new TError(this,"Listener is null.");this._listeners.remove(a)},MO.TListeners_process=function(a,b,d,f,h,k){var q=this._listeners;if(q)for(var w=q.count(),x=0;x<w;x++)q.getAt(x).process(a,b,d,f,h,k)},MO.TListeners_clear=function(){var a=this._listeners;a&&a.clear()},
MO.TListeners_dispose=function(){var a=this._listeners;if(a){for(var b=a.count()-1;0<=b;b--)a.getAt(b).dispose();this._listeners=RObject.dispose(a)}RObject.free(this)},MO.TListeners_dump=function(){var a=new TString;a.append(RClass.name(this));for(var b=this._listeners,d=b.count(),f=0;f<d;f++)a.append("\n   "+b.getAt(f));return a.flush()};
with(MO)MO.TLoaderListener=function(){this.invoke=null;this.ids=new TArray;this.check=TLoaderListener_check;return this},MO.TLoaderListener_check=function(a){var b=this.ids;if(!b.isEmpty())for(var d=b.length,f=0;f<d;f++)if(!a.contains(b.get(f)))return!1;return!0};with(MO)MO.TLocker=function(){this._lock=!1;this.enter=TLocker_enter;this.leave=TLocker_leave;return this},MO.TLocker_enter=function(){this._lock=!0},MO.TLocker_leave=function(){this._lock=!1};
with(MO)MO.TMessage=function(){this.typeCd=EMessage.None;this.redirect=this.description=this.message=this.attrType=null;this.loadConfig=TMessage_loadConfig;this.saveConfig=TMessage_saveConfig;this.icon=TMessage_icon;return this},MO.TMessage_loadConfig=function(a){this.typeCd=RString.toLower(a.name);this.message=a.nvl("message");this.attrType=a.nvl("type");this.redirect=a.nvl("redirect");this.description=a.nvl("description").replace(/\\n/g,"\n")},MO.TMessage_saveConfig=function(a){a.name=this.typeCd;
a.set("message",this.message);a.set("description",this.description)},MO.TMessage_icon=function(){return"sys.msg."+this.typeCd};
with(MO)MO.TMessages=function(){this._items=new TObjects;this.hasMessage=TMessages_hasMessage;this.message=TMessages_message;this.messages=TMessages_messages;this.type=TMessages_type;this.push=TMessages_push;return this},MO.TMessages_hasMessage=function(a){for(var b=0;b<this._items.count;b++){var d=this._items.get(b);if(d&&d.type==a)return!0}return!1},MO.TMessages_message=function(a){for(var b=0;b<this._items.count;b++){var d=this._items.get(b);if(d&&d.type==a)return d}return null},MO.TMessages_messages=
function(a){for(var b=null,d=0;d<this._items.count;d++){var f=this._items.get(d);f&&f.type==a&&(b||(b=new TList),b.push(f))}return b},MO.TMessages_type=function(){return this.hasMessage(EMessage.Fatal)?EMessage.Fatal:this.hasMessage(EMessage.Error)?EMessage.Error:this.hasMessage(EMessage.Warn)?EMessage.Warn:this.hasMessage(EMessage.Valid)?EMessage.Valid:this.hasMessage(EMessage.Info)?EMessage.Info:EMessage.None},MO.TMessages_push=function(a){a&&this._items.push(a)};
with(MO)MO.TNode=function(a){this._name=RString.nvl(a,"Node");this._nodes=this._attributes=this._value=null;this.isName=TNode_isName;this.name=TNode_name;this.setName=TNode_setName;this.value=TNode_value;this.setValue=TNode_setValue;this.contains=TNode_contains;this.hasAttribute=TNode_hasAttribute;this.attributes=TNode_attributes;this.hasNode=TNode_hasNode;this.nodeCount=TNode_nodeCount;this.node=TNode_node;this.nodes=TNode_nodes;this.get=TNode_get;this.getInteger=TNode_getInteger;this.set=TNode_set;
this.setNvl=TNode_setNvl;this.setBoolean=TNode_setBoolean;this.setFloat=TNode_setFloat;this.find=TNode_find;this.findNode=TNode_findNode;this.searchNode=TNode_searchNode;this.push=TNode_push;this.toString=TNode_toString;this.innerDump=TNode_innerDump;this.dump=TNode_dump;return this},MO.TNode_isName=function(a){return RString.equals(this._name,a)},MO.TNode_name=function(){return this._name},MO.TNode_setName=function(a){this._name=a},MO.TNode_value=function(){return this._value},MO.TNode_setValue=
function(a){this._value=a},MO.TNode_contains=function(a){var b=this._attributes;return b?b.contains(a):!1},MO.TNode_hasAttribute=function(){var a=this._attributes;return a?!a.isEmpty():!1},MO.TNode_attributes=function(){var a=this._attributes;a||(a=this._attributes=new TAttributes);return a},MO.TNode_hasNode=function(){var a=this._nodes;return a?!a.isEmpty():!1},MO.TNode_nodeCount=function(){var a=this._nodes;return a?a.count():0},MO.TNode_node=function(a){var b=this._nodes;return b?b.at(a):null},
MO.TNode_nodes=function(){var a=this._nodes;a||(a=this._nodes=new TObjects);return a},MO.TNode_get=function(a,b){return this._attributes?this._attributes.get(a,b):null},MO.TNode_getInteger=function(a,b){return RInteger.parse(this.get(a,b))},MO.TNode_set=function(a,b){null!=b&&this.attributes().set(a,b)},MO.TNode_setNvl=function(a,b){RString.isEmpty(b)||this.attributes().set(a,b)},MO.TNode_setBoolean=function(a,b){null!=b&&this.attributes().set(a,RBoolean.format(b))},MO.TNode_setFloat=function(a,b){null!=
b&&this.attributes().set(a,RFloat.format(b))},MO.TNode_find=function(a){if(this.hasNode())for(var b=this._nodes,d=b.count(),f=0;f<d;f++){var h=b.get(f);if(h.isName(a))return h}return null},MO.TNode_findNode=function(a,b){if(this.hasNode()){var d=this._nodes,f=d.count(),h=arguments,k=h.length;if((k-1)%2)throw new TError("Attributes is not pair. (length={1})",k);for(var q=0;q<f;q++){var w=d.get(q);if(null==a||w.isName(a)){for(var x=!0,y=1;y<k;y+=2)if(w.get(h[y])!=h[y+1]){x=!1;break}if(x)return w}}}return null},
MO.TNode_searchNode=function(a,b){if(this.hasAttribute()&&this._attributes.get(a)==b)return this;if(this.hasNode())for(var d=this._nodes,f=d.count();0<f;ni++){var h=d.get(h).searchNode(a,b);if(null!=h)return h}return null},MO.TNode_push=function(a){this.nodes().push(a)},MO.TNode_toString=function(){return this.dump()},MO.TNode_innerDump=function(a,b,d){null==d&&(d="");a.append(d,b._name,"(",RClass.name(b),")");var f=b._attributes;if(f){var h=f.count();a.append(" [",h,":");for(var k=0;k<h;k++)0<k&&
a.append(" "),a.append(f.name(k),"=",f.value(k)),k<h-1&&a.append(",");a.append("]")}b._value&&(h=b._value.toString(),RString.isEmpty(h)||a.append(" {",h.length,":",h,"}"));if(b=b._nodes)for(h=b.count(),a.append("\n"),k=0;k<h;k++)b.get(k).dump(a,d+"   "),k<h-1&&a.append("\n");return a},MO.TNode_dump=function(a,b){return this.innerDump(RString.nvlString(a),this,b)};
with(MO)MO.TRow=function(){TAttributes.call(this);this._statusCd=this._uniqueId=this._index=this._dataset=null;this.loadConfig=TRow_loadConfig;this.saveConfig=TRow_saveConfig;return this},MO.TRow_loadConfig=function(a){this._index=a.get("_id");this._statusCd=a.get("_status");this._uniqueId=a.get("ouid");a.hasAttribute()&&this.append(a.attributes())},MO.TRow_saveConfig=function(a){a.set("_id",this._index);a.set("_status",this._statusCd);for(var b=this.count(),d=0;d<b;d++)a.set(this._names[d],this._values[d])},
MO.TRow_copy=function(){var a=new TRow;a._dataset=this._dataset;a._index=this._index;a._statusCd=this._statusCd;a._uniqueId=this._uniqueId;for(var b=this.count,d=0;d<b;d++)a.set(this.names[d],this.values[d]);return a},MO.TRow_toAttributes=function(a){a||(a=new TAttributes);a.set(RDataset.ROW_STATUS,this._statusCd);a.append(this);return a},MO.TRow_dump=function(a){var b=this.count;a=RString.nvlStr(a);a.append(RClass.name(this)," [",this._statusCd,": ");for(var d=0;d<b;d++)0<d&&a.append(","),a.append(this.names[d],
"=",this.values[d]);a.append("]");return a};
with(MO)MO.TSpeed=function TSpeed(){this.arguments=arguments;this._span=this._end=this._start=0;this._spanMin=Number.MAX_VALUE;this._spanMax=0;this.start=(new Date).getTime();this.callerName=RMethod.name(TSpeed.caller);this.reset=TSpeed_reset;this.begin=TSpeed_begin;this.end=TSpeed_end;this.record=TSpeed_record;this.toString=TSpeed_toString;return this},MO.TSpeed_reset=function(){this._span=this._end=this._start=0},MO.TSpeed_begin=function(){this._start=(new Date).getTime()},MO.TSpeed_end=function(){this._end=
(new Date).getTime();this._span+=this._end-this._start;this._span<this._spanMin&&(this._spanMin=this._span);this._span>this._spanMax&&(this._spanMax=this._span)},MO.TSpeed_record=function(){var a=(new Date).getTime()-this.start;RLogger.debug(this,"Speed test. (caller={1}, speed={2}, arguments={3})",this.callerName,a,this.arguments);this.record=this.callerName=this.start=this.arguments=null},MO.TSpeed_toString=function(){return this._span+" ("+this._spanMin+" - "+this._spanMax+")"};
with(MO)MO.TUnsupportError=function TUnsupportError(b,d){for(var f="Unsupport method. (name={1})",h=new TString,k=TUnsupportError.caller,q=new TString,w=[];k&&!RArray.contains(w,k);)w.push(k),k=k.caller;for(var x=w.length,y=0;y<x;y++)k=w[y],0<y&&q.appendLine(),q.append("   "+(x-y)+": "+RMethod.name(k));k=arguments;x=k.length;for(y=1;y<x;y++)var w=k[y],z=null,z="function"==typeof w?RMethod.name(w):w,f=f.replace("{"+(y-1)+"}",z);h.appendLine(f);h.appendLine("------------------------------------------------------------");
h.append(q);throw Error(h);};with(MO)MO.FConsole=function(a){a=RClass.inherits(this,a,FObject);a._scopeCd=EScope.Global;a.scopeCd=FConsole_scopeCd;return a},MO.FConsole_scopeCd=function(){return this._scopeCd};
with(MO)MO.FObjectPool=function(a){a||(a=this);a.__class=null;a.__hash=0;a.__dispose=!1;a.construct=FObject_construct;a.hashCode=FObject_hashCode;a.toString=FObject_toString;a.dispose=FObject_dispose;a.innerDump=FObject_innerDump;a.dump=FObject_dump;return a},MO.FObject_construct=function(){this.__dispose=!1},MO.FObject_hashCode=function(){var a=this.__hash;a||(a=this.__hash=RObject.nextId());return a},MO.FObject_toString=function(){return RClass.dump(this)},MO.FObject_dispose=function(){RObject.free(this);
this.__dispose=!0},MO.FObject_innerDump=function(a,b){a.append(RClass.dump(this))},MO.FObject_dump=function(){var a=new TString;this.innerDump(a,0);return a.flush()};
with(MO)MO.FObjectPool=function(a){a=RClass.inherits(this,a,FObject);a._items=null;a._frees=null;a._allocCount=0;a._freeCount=0;a.construct=FObjectPool_construct;a.hasFree=FObjectPool_hasFree;a.alloc=FObjectPool_alloc;a.free=FObjectPool_free;a.push=FObjectPool_push;a.dispose=FObjectPool_dispose;a.innerDump=FObjectPool_innerDump;return a},MO.FObjectPool_construct=function(){this.__base.FObject.construct.call(this);this._items=new TObjects;this._frees=new TObjects},MO.FObjectPool_hasFree=function(){return!this._frees.isEmpty()},
MO.FObjectPool_alloc=function(){var a=null;this._frees.isEmpty()||(a=this._frees.pop());this._allocCount++;return a},MO.FObjectPool_free=function(a){this._frees.push(a);this._freeCount++},MO.FObjectPool_push=function(a){this._items.push(a);this._frees.push(a)},MO.FObjectPool_dispose=function(){this._items=RObject.dispose(this._items);this._frees=RObject.dispose(this._frees);this.__base.FObject.dispose.call(this)},MO.FObjectPool_innerDump=function(a,b){a.append("Pool:");a.append("total=",this._items.count());
a.append(", free=",this._frees.count());a.append(", alloc_count=",this._allocCount);a.append(", free_count=",this._freeCount)};
with(MO)MO.FObjectPools=function(a){a=RClass.inherits(this,a,FObject);a._pools=null;a.construct=FObjectPools_construct;a.pool=FObjectPools_pool;a.alloc=FObjectPools_alloc;a.free=FObjectPools_free;a.dispose=FObjectPools_dispose;return a},MO.FObjectPools_construct=function(){this.__base.FObject.construct.call(this);this._pools=new TDictionary},MO.FObjectPools_pool=function(a){var b=this._pools.get(a);b||(b=RClass.create(FObjectPool),this._pools.set(a,b));return b},MO.FObjectPools_alloc=function(a){return this.pool(a).alloc()},
MO.FObjectPools_free=function(a,b){return this.pool(a).free(b)},MO.FObjectPools_push=function(a,b){return this.pool(a).push(b)},MO.FObjectPools_dispose=function(){for(var a=this._pools,b=a.count(),d=0;d<b;d++)a.valueAt(d).dispose();a.dispose();this.__base.FObject.dispose.call(this)};
with(MO)MO.FTimer=function(a){a=RClass.inherits(this,a,FObject);a._count=0;a._startTime=0;a._beginTime=0;a._endTime=0;a._stopTime=0;a._span=0;a._spanSecond=0;a.setup=FTimer_setup;a.current=FTimer_current;a.span=FTimer_span;a.spanSecond=FTimer_spanSecond;a.rate=FTimer_rate;a.update=FTimer_update;return a},MO.FTimer_setup=function(){var a=(new Date).getTime();this._endTime=this._beginTime=this._startTime=a},MO.FTimer_current=function(){return this._lastTime},MO.FTimer_span=function(){return this._span},
MO.FTimer_spanSecond=function(){return this._spanSecond},MO.FTimer_rate=function(){return 0==this._count?0:parseInt(1E3*this._count/(this._lastTime-this._startTime))},MO.FTimer_update=function(){this._count++;var a=this._beginTime=this._endTime;this._spanSecond=(this._span=(this._endTime=(new Date).getTime())-a)/1E3};
with(MO)MO.RArray=function(){this.array1=Array(1);this.array2=Array(2);this.array3=Array(3);this.array4=Array(4);this.array9=Array(9);this.array12=Array(12);this.array16=Array(16);this.equals=RArray_equals;this.count=RArray_count;this.contains=RArray_contains;this.find=RArray_find;this.search=RArray_search;this.reverse=RArray_reverse;this.copy=RArray_copy;this.move=RArray_move;this.remove=RArray_remove;this.sortPartition=RArray_sortPartition;this.sortArray=RArray_sortArray;this.sort=RArray_sort;this.nameMaxLength=
RArray_nameMaxLength;return this},MO.RArray_equals=function(a,b){if(a&&b&&a.length==b.length){for(var d=a.length,f=0;f<d;f++)if(a[f]!=b[f])return!1;return!0}return!1},MO.RArray_count=function(a){for(var b in a)b++;return 0},MO.RArray_contains=function(a,b){for(var d=a.length,f=0;f<d;f++)if(a[f]==b)return!0;return!1},MO.RArray_find=function(a,b){for(var d=a.length,f=0;f<d;f++)if(a[f]==b)return f;return-1},MO.RArray_search=function(a,b){for(var d in a)if(a[d]==b)return d;return null},MO.RArray_reverse=
function(a,b,d){for(var f=d+1-b>>1,h=0;h<f;h++){var k=a[b+h];a[b+h]=a[d-h];a[d-h]=k}},MO.RArray_copy=function(a,b){for(var d in a)b[d]=a[d]},MO.RArray_move=function(a,b,d,f){if(b>f)for(var h=0;h<d;h++)a[f-h]=a[b+h];else if(b<f)for(h=0;h<d;h++)a[f+d-h-1]=a[b+d-h-1]},MO.RArray_remove=function(a,b){return a.slice(0,b).concat(a.slice(b+1))},MO.RArray_sortPartition=function(a,b,d){var f=b;d+=1;for(var h=a[f];;){for(;a[++f]<h;);for(;a[--d]>h;);if(f>d)break;var k=a[f];a[f]=a[d];a[d]=k}a[b]=a[d];a[d]=h;return d},
MO.RArray_sortArray=function(a,b,d){if(b<d){var f=this.sortPartition(a,b,d);this.sortArray(a,b,f-1);this.sortArray(a,f+1,d)}},MO.RArray_sort=function(a,b){var d=a.length-1;this.sortArray(a,0,d);b&&this.reverse(a,0,d);return a},MO.RArray_nameMaxLength=function(a){for(var b in a)a=b.length,a>b&&(b=a);return 0},MO.RArray=new RArray;
with(MO)MO.RBoolean=function(){this.format=RBoolean_format;this.parse=RBoolean_parse;this.toString=RBoolean_toString;return this},MO.RBoolean_format=function(a){return a?EBoolean.True:EBoolean.False},MO.RBoolean_parse=function(a){if(null!=a){if(a.constructor==Boolean)return a;if(a.constructor==String)return a==EBoolean.True;if(a.constructor==Number)return 0<a;throw new TError(this,"Unknown type.");}return!1},MO.RBoolean_toString=function(a,b,d){null==b&&(b=EBoolean.True);null==d&&(d=EBoolean.False);
return a?b:d},MO.RBoolean=new RBoolean;with(MO)MO.RByte=function(){this.copy=RByte_copy;return this},MO.RByte_copy=function(a,b,d,f,h){for(var k=0;k<h;k++)a[b++]=d[f++]},MO.RByte=new RByte;with(MO)MO.RChar=function(){this.parse=RChar_parse;this.toString=RChar_toString;return this},MO.RChar_parse=function(a){return String.fromCharCode(a)},MO.RChar_toString=function(a){return a},MO.RChar=new RChar;
with(MO)MO.RClass=function(){this._codes=[];this._classes={};this.isBase=RClass_isBase;this.isBaseName=RClass_isBaseName;this.isBaseDataName=RClass_isBaseDataName;this.isBaseType=RClass_isBaseType;this.isBaseDataType=RClass_isBaseDataType;this.isName=RClass_isName;this.isClass=RClass_isClass;this.typeOf=RClass_typeOf;this.safeTypeOf=RClass_safeTypeOf;this.checkClass=RClass_checkClass;this.code=RClass_code;this.name=RClass_name;this.inherits=RClass_inherits;this.forName=RClass_forName;this.find=RClass_find;
this.register=RClass_register;this.createBase=RClass_createBase;this.createClass=RClass_createClass;this.create=RClass_create;this.createByName=RClass_createByName;this.innerCopy=RClass_innerCopy;this.build=RClass_build;this.free=RClass_free;this.dump=RClass_dump;return this},MO.RClass_isBase=function(a){return null!=a?RClass.isBaseName(typeof a):!1},MO.RClass_isBaseName=function(a){return null==a||"boolean"!=a&&"number"!=a&&"date"!=a&&"string"!=a&&"function"!=a?!1:!0},MO.RClass_isBaseDataName=function(a){return null==
a||"boolean"!=a&&"number"!=a&&"date"!=a&&"string"!=a?!1:!0},MO.RClass_isBaseType=function(a){return null==a||a!=Boolean&&a!=Number&&a!=Date&&a!=String&&a!=Function?!1:!0},MO.RClass_isBaseDataType=function(a){return null==a||a!=Boolean&&a!=Number&&a!=Date&&a!=String?!1:!0},MO.RClass_isName=function(a,b){return this.name(a)==b},MO.RClass_isClass=function(a,b){if(a&&b){var d=this.name(b);return a.__base?null!=a.__base[d]:this.name(a)==d}return!1},MO.RClass_typeOf=function(a){return a&&a.constructor?
RString.mid(a.constructor.toString(),"function ","("):"Null"},MO.RClass_safeTypeOf=function(a,b){if(null==a)return"Null";try{var d=a.constructor;if(d==Boolean)return"Boolean";if(d==Number)return"Number";if(d==String)return"String";if(d==Function||d.constructor==Function)return RString.mid(d.toString(),"function ","(");if(a.__class)return a.__class.name;if(a.tagName)return"Html";for(var f in a)return"Object"}catch(h){}return"Unknown"},MO.RClass_checkClass=function(a,b){if(!this.isClass(a,b))throw Error("Invalid class "+
o.name(o)+"<>"+o.name(b));},MO.RClass_code=function(a){for(var b=this._codes,d=b.length,f=0;f<d;f++)if(b[f]==a)return f;b[d]=a;return d},MO.RClass_name=function(a){if(a){if(a.__name)return a.__name;if(a.__class)return a.__class.name;if("function"==typeof a)return RMethod.name(a);if(a=a.constructor)return RString.mid(a.toString(),"function ","(")}return null},MO.RClass_inherits=function(a,b){var d=RRuntime.nvl(b,a);d.__inherits=[];for(var f=arguments,h=f.length,k=2;k<h;k++)d.__inherits.push(RMethod.name(f[k]));
return d},MO.RClass_forName=function(a){var b=null;null!=a&&(b=this._classes[a],b||(b=this.createClass(a),this.build(b)));return b},MO.RClass_find=function(a){var b=null;null!=a&&(a.__class?b=a.__class.name:a.constructor==Function?b=RMethod.name(a):a.constructor!=String&&RLogger.fatal(this,null,"Find class failure. (value={1})",a));return this._classes[b]},MO.RClass_register=function(a,b,d){a=RMethod.name(a.constructor);this._classes[a].register(b);a=b.value();return null!=a?a:d},MO.RClass_createBase=
function(a){return a?eval("function "+a+"(){return this;} new "+a+"();"):null},MO.RClass_createClass=function(a){var b=this._classes[a]=new TClass;b.name=a;b.base=this.createBase(a);b.clazz=new b.base.constructor;eval(a)(b.clazz);return b},MO.RClass_create=function(a){var b=typeof a;"function"==b?a=RMethod.name(a):"string"!=b&&RLogger.fatal(this,null,"Param is invlid (name={1})",a);return this.createByName(a)},MO.RClass_createByName=function(a){(a=this.forName(a))||RLogger.fatal(this,null,"Cant find class. (name={1})",
a);return a.newInstance()},MO.RClass_innerCopy=function(a,b){if(null!=a&&null!=b)for(var d in a){var f=a[d];if(null!=f){var h=typeof f;if("function"==h){h=b[d];null==h?b[d]=f:RMethod.isVirtual(h)?b[d]=f:!RMethod.isVirtual(f)&&RMethod.isEmpty(h)?b[d]=f:RMethod.isVirtual(f)||RMethod.isEmpty(f)||(b[d]=f);continue}else if(!RClass.isBaseName(h)){null==b[d]&&(b[d]=new f.constructor);this.innerCopy(f,b[d]);continue}}b[d]=f}},MO.RClass_build=function(a){var b=a.clazz.__inherits;if(b&&b.constructor==Array)for(var d=
!1,f=b.length,h=0;h<f;h++){var k=b[h];RString.startsWith(k,"F")&&(d&&RLogger.fatal(this,null,"Parent class is too many. (name={1})",k),a.parent=RClass.forName(k),d=!0)}d=a.instance=new a.base.constructor;if(b&&b.constructor==Array)for(f=b.length,h=0;h<f;h++)if(k=b[h],!RString.startsWith(k,"F")){var q=RClass.forName(k);null==q&&RLogger.fatal(this,null,"Parent class is not exists. (name={1})",k);RClass.innerCopy(q.instance,d);a.assign(q)}a.parent&&(this.innerCopy(a.parent.instance,d),a.assign(a.parent));
d.__base||(d.__base=new TClassBase);d.__base[a.name]=new a.base.constructor;var q=a.clazz,w;for(w in q)"__base"!=w&&(null==q[w]&&null==d[w]?d[w]=null:null!=q[w]&&(null==d[w]||null!=d[w]&&q[w]!=d[w])&&(d[w]=q[w]));if(b&&b.constructor==Array)for(f=b.length,h=0;h<f;h++)for(w in k=b[h],q=RClass.forName(k),k=d.__base[k]=new q.base.constructor,q=q.instance,q)if("__base"!=w){var x=q[w],y=d[w];null!=x&&null!=y&&x!=y&&x.constructor==Function&&y.constructor==Function&&(k[w]=q[w])}a.build();if(RRuntime.isRelease())for(w in a.instance)null==
a.instance[w]&&delete a.instance[w]},MO.RClass_free=function(a){var b=a.__class;b&&b.free(a)},MO.RClass_dump=function(a){if(null==a)return"@null";var b=this.safeTypeOf(a);switch(b){case "Boolean":return"Boolean:"+a;case "Number":return"Number:"+a;case "String":return b+"<"+a.length+">:"+a;case "Function":return b+"<"+RMethod.name(a)+">@"+this.code(a);case "Html":return b+"<"+a.tagName+">@"+this.code(a);default:if(a.__name)return b+"<"+a.__name+">@"+this.code(a)}return b+"@"+this.code(a)},MO.RClass=
new RClass;
with(MO)MO.RConsole=function(){this.ConsolePreFix="console:";this._registers=new TObjects;this._consoles=new TDictionary;this._localConsoles=new TDictionary;this.initialize=RConsole_initialize;this.register=RConsole_register;this.create=RConsole_create;this.createByName=RConsole_createByName;this.get=RConsole_get;this.find=RConsole_find;this.release=RConsole_release;return this},MO.RConsole_initialize=function(){for(var a=this._registers,b=0;b<a;b++){var d=a.get(b);d.force&&this.find(d.clazz)}},MO.RConsole_register=
function(a){this._registers.push(a)},MO.RConsole_create=function(a){var b=null;if(a){var b=RClass.create(a),d;for(d in b)if(RString.startsWith(d,"lnk")){var f=b[d];if("string"==typeof f&&RString.startsWith(f,"&")){var h=this.find(f.substr(1));if(!h)return RMessage.fatal(this,null,"Can't link console. (name={0}, property={1}:{2})",a,d,f);b[d]=h}}}return b},MO.RConsole_createByName=function(a){var b=null;if(a){var b=RClass.createByName(a),d;for(d in b)if(RString.startsWith(d,"lnk")){var f=b[d];if("string"==
typeof f&&RString.startsWith(f,"&")){var h=this.find(f.substr(1));if(!h)return RMessage.fatal(this,null,"Can't link console. (name={0}, property={1}:{2})",a,d,f);b[d]=h}}}return b},MO.RConsole_get=function(a){a=RClass.name(a);return this._consoles.get(a)},MO.RConsole_find=function(a){var b=null;if(a.constructor=String)b=RClass.name(a);else if(a.constructor==Function)b=a;else return RLogger.fatal(this,null,"Parameter type is invalid. (console={1})",a);if((a=RGlobal.get(this.ConsolePreFix+b))||(a=this._consoles.get(b)))return a;
var d=RClass.forName(b).instance.scopeCd();switch(d){case EScope.Global:a=top.RConsole.createByName(b);RGlobal.set(this.ConsolePreFix+b,a);this._consoles.set(b,a);break;case EScope.Local:a=this.createByName(b);this._localConsoles.set(b,a);this._consoles.set(b,a);break;default:return RLogger.fatal(this,"Unknown scope code. (name={1})",b)}RLogger.info(this,"Create console. (name={1}, scope={2})",b,REnum.decode(EScope,d));return a},MO.RConsole_release=function(){this._registers&&(this._registers.dispose(),
this._registers=null);var a=this._localConsoles;if(a){for(var b=a.count(),d=0;d<b;d++)a.value(d).dispose();a.dispose()}this._localConsoles=null;this._consoles&&this._consoles.dispose();this._consoles=null},MO.RConsole=new RConsole;
with(MO)MO.RConst=function(){this.PI_2=Math.PI/2;this.PI=Math.PI;this.PI2=2*Math.PI;this.RADIAN_RATE=180/Math.PI;this.DEGREE_RATE=Math.PI/180;this.PERCENT_10=.1;this.PERCENT_100=.01;this.PERCENT_1000=.001;this.identity3x3=[1,0,0,0,1,0,0,0,1];this.identity4x4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return this},MO.RConst=new RConst;
with(MO)MO.RDate=function(){this.MinYear=1800;this.MaxYear=2400;this.Pattern="n-: /";this.Chars="0123456789-:/";this.DisplayFormat="yyyy-mm-dd hh24:mi:ss";this.DataFormat="yyyymmddhh24miss";this.MonthDays=[0,31,28,31,30,31,30,31,31,30,31,30,31];this.DaySeconds=1E3;this.Parts="YYYY MM DD HH24 MI SS".split(" ");this.PartsDefine={YYYY:["Year",4],MM:["Month",2],DD:["Day",2],HH24:["Hour",2],MI:["Minute",2],SS:["Second",2]};this.nvl=RDate_nvl;this.make=RDate_make;this.format=RDate_format;this.formatDate=
RDate_formatDate;this.formatText=RDate_formatText;this.monthDays=RDate_monthDays;this.splitFormat=RDate_splitFormat;this.makeDate=RDate_makeDate;this.checkItems=RDate_checkItems;this.check=RDate_check;this.parse=RDate_parse;this.splitDate=RDate_splitDate;this.splitTime=RDate_splitTime;this.autoParse=RDate_autoParse;this.getFormat=RDate_getFormat;return this},MO.RDate_nvl=function(a){return a?a:new TDate},MO.RDate_make=function(a,b,d,f,h,k){return new TDate(new Date(a,b,d))},MO.RDate_format=function(a){return this.formatDate(new TDate,
a)},MO.RDate_formatText=function(a,b){if(!a)return!1;b=b.toLowerCase();b=b.replace(/yyyy/g,a.substring(0,4));a=a.substring(4);b=b.replace(/mm/g,a.substring(0,2));a=a.substring(2);b=b.replace(/dd/g,a.substring(0,2));a=a.substring(2);b=b.replace(/hh24/g,a.substring(0,4));a=a.substring(4);b=b.replace(/mi/g,a.substring(0,2));a=a.substring(2);b=b.replace(/ss/g,a.substring(0,2));a.substring(2);return b},MO.RDate_formatDate=function(a,b){if(!a)return"";b=b?b.toLowerCase():this.DataFormat;b=b.replace(/yyyy/g,
RInteger.format(a.year,4));b=b.replace(/yy/g,RInteger.format(a.year%100,2));b=b.replace(/mm/g,RInteger.format(a.month,2));b=b.replace(/dd/g,RInteger.format(a.day,2));b=b.replace(/hh24/g,RInteger.format(a.hour,2));b=b.replace(/mi/g,RInteger.format(a.minute,2));b=b.replace(/ss/g,RInteger.format(a.second,2));return b=b.replace(/ms/g,RInteger.format(a.ms,3))},MO.RDate_monthDays=function(a,b){if(!a||!b)return 0;a=parseInt(a);b=parseInt(b);this.MonthDays[2]=0!=a%4&&0!=a%400||0==a%100?28:29;return this.MonthDays[b]},
MO.RDate_splitFormat=function(a,b){if(!a)return!1;b=b.toLowerCase();for(var d=[];0<b.length;)0==b.indexOf("yyyy")?(d.year=a.substring(0,4),b=b.substring(4),a=a.substring(4)):0==b.indexOf("mm")?(d.month=a.substring(0,2),b=b.substring(2),a=a.substring(2)):0==b.indexOf("dd")?(d.day=a.substring(0,2),b=b.substring(2),a=a.substring(2)):0==b.indexOf("hh24")?(d.hour=a.substring(0,2),b=b.substring(4),a=a.substring(2)):0==b.indexOf("mi")?(d.minute=a.substring(0,2),b=b.substring(2),a=a.substring(2)):0==b.indexOf("ss")?
(d.second=a.substring(0,2),b=b.substring(2),a=a.substring(2)):0==b.indexOf("ms")?(d.ms=a.substring(0,2),b=b.substring(2),a=a.substring(3)):(b=b.substring(1),a=a.substring(1));return d},MO.RDate_checkItems=function(a){if(!a)return!1;var b=RInteger.parse(a.year);if(b<this.MinYear||b>this.MaxYear)return!1;var d=RInteger.parse(a.month);if(1>d||12<d)return!1;var f=RInteger.parse(a.day);if(1>f||f>this.monthDays(b,d))return!1;b=RInteger.parse(a.hour);if(0>b||23<b)return!1;b=RInteger.parse(a.second);if(0>
b||59<b)return!1;a=RInteger.parse(a.ms);return 0>a||99<a?!1:!0},MO.RDate_check=function(a,b){return this.checkItems(this.splitFormat(a,b))},MO.RDate_makeDate=function(a,b){var d=new Date(RInteger.parse(b.year),RInteger.parse(b.month)-1,RInteger.parse(b.day),RInteger.parse(b.hour),RInteger.parse(b.minute),RInteger.parse(b.second),RInteger.parse(b.ms));return a?(a.setDate(d),a):new TDate(d)},MO.RDate_parse=function(a,b,d){d||(d=this.DataFormat);b=this.splitFormat(b,d);return this.checkItems(b)?this.makeDate(a,
b):null},MO.RDate_splitDate=function(a,b){if(b){var d=null;-1!=b.indexOf("-")||-1!=b.indexOf("/")?(-1!=b.indexOf("-")?d=b.split("-"):-1!=b.indexOf("/")&&(d=b.split("/")),1<=d.length&&(a.year=RInteger.parse(d[0])),2<=d.length&&(a.month=RInteger.parse(d[1])),3<=d.length&&(a.day=RInteger.parse(d[2]))):-1!=b.indexOf(":")?this.splitTime(a,b):14==b.length?(a.year=RInteger.parse(b.substr(0,4)),a.month=RInteger.parse(b.substr(4,2)),a.day=RInteger.parse(b.substr(6,2)),a.hour=RInteger.parse(b.substr(8,2)),
a.minute=RInteger.parse(b.substr(10,2)),a.second=RInteger.parse(b.substr(12,2))):8==b.length?(a.year=RInteger.parse(b.substr(0,4)),a.month=RInteger.parse(b.substr(4,2)),a.day=RInteger.parse(b.substr(6,2))):6==b.length?(a.year=RInteger.parse(b.substr(0,4)),a.month=RInteger.parse(b.substr(4,2))):4==b.length&&(a.year=RInteger.parse(b))}},MO.RDate_splitTime=function(a,b){if(b)if(-1!=b.indexOf(":")){var d=b.split(":");1<=d.length&&(a.hour=RInteger.parse(d[0]));2<=d.length&&(a.minute=RInteger.parse(d[1]));
3<=d.length&&(a.second=RInteger.parse(d[2]))}else 6==b.length?(a.hour=RInteger.parse(b.substr(0,2)),a.minute=RInteger.parse(b.substr(2,2)),a.second=RInteger.parse(b.substr(4,2))):4==b.length?(a.hour=RInteger.parse(b.substr(0,2)),a.minute=RInteger.parse(b.substr(2,2))):2==b.length&&(a.hour=RInteger.parse(b.substr(0,2)))},MO.RDate_autoParse=function(a,b){if(!b)return null;a=this.nvl(a);var d=[];d.year=2E3;d.month=1;d.day=1;d.hour=0;d.minute=0;d.second=0;b=RString.trim(b);if(-1==b.indexOf(" "))this.splitDate(d,
b);else{var f=b.split(" ");2==f.length&&(this.splitDate(d,f[0]),this.splitTime(d,f[1]))}return this.checkItems(d)?this.makeDate(a,d):null},MO.RDate_getFormat=function(a){var b="",d="";if(a){if(-1!=a.indexOf(":"))if(a=RString.split(a," "),1==a.length)a=RString.split(a[0],":"),1==a.length?(b+="HH24",d=1==a[0].length?d+("0"+a[0]):d+a[0]):2==a.length?(b+="HH24MI",1==a[0].length?d+="0"+a[0]:2==a[0].length&&(d+=a[0]),1==a[1].length?d+="0"+a[1]:2==a[1].length&&(d+=a[1])):3==a.length&&(b+="HH24MISS",1==a[0].length?
d+="0"+a[0]:2==a[0].length&&(d+=a[0]),1==a[1].length?d+="0"+a[1]:2==a[1].length&&(d+=a[1]),1==a[2].length?d+="0"+a[2]:2==a[2].length&&(d+=a[2]));else{if(2==a.length){var f=RString.split(a[0],"-");3==f.length?(b+="YYYYMMDD",4==f[0].length&&(d+=f[0]),1==f[1].length?d+="0"+f[1]:2==f[1].length&&(d+=f[1]),1==f[2].length?d+="0"+f[2]:2==f[2].length&&(d+=f[2])):2==f.length?(b+="YYYYMM",1==f[0].length&&(d+=f[0]),1==f[1].length?d+="0"+f[1]:2==f[1].length&&(d+=f[1])):1==f.length&&(b+="YYYY",4==f[0].length&&
(d+=f[0]));a=RString.split(a[1],":");1==a.length?(b+="HH24",d=1==a[0].length?d+("0"+a[0]):d+a[0]):2==a.length?(b+="HH24MI",1==a[0].length?d+="0"+a[0]:2==a[0].length&&(d+=a[0]),1==a[1].length?d+="0"+a[1]:2==a[1].length&&(d+=a[1])):3==a.length&&(b+=" HH24MISS",1==a[0].length?d+="0"+a[0]:2==a[0].length&&(d+=a[0]),1==a[1].length?d+="0"+a[1]:2==a[1].length&&(d+=a[1]),1==a[2].length?d+="0"+a[2]:2==a[2].length&&(d+=a[2]))}}else a=RString.split(a,"-"),3==a.length?(b+="YYYYMMDD",4==a[0].length&&(d+=a[0]),
1==a[1].length?d+="0"+a[1]:2==a[1].length&&(d+=a[1]),1==a[2].length?d+="0"+a[2]:2==a[2].length&&(d+=a[2])):2==a.length?(b="YYYYMM",4==a[0].length&&(d+=a[0]),1==a[1].length?d+="0"+a[1]:2==a[1].length&&(d+=a[1])):1==a.length&&(b+="YYYY",4==a[0].length&&(d+=a[0]));a=Array(2);a[0]=b;a[1]=d;return a}},MO.RDate=new RDate;
with(MO)MO.REnum=function(){this.contains=REnum_contains;this.tryEncode=REnum_tryEncode;this.encode=REnum_encode;this.tryDecode=REnum_tryDecode;this.decode=REnum_decode;this.parse=REnum_encode;this.format=REnum_decode;return this},MO.REnum_contains=function(){},MO.REnum_tryEncode=function(a,b,d){if(null!=a)for(var f in a)if(f.toLowerCase()==b.toLowerCase())return a[f];return d},MO.REnum_encode=function(a,b){var d=this.tryEncode(a,b);if(null==d)throw new TError(this,"Invalid value (enum={1}, value={2})",
RClass.dump(a),b);return d},MO.REnum_tryDecode=function(a,b,d){if(null!=a)for(var f in a)if(a[f]==b)return f;return d},MO.REnum_decode=function(a,b){var d=this.tryDecode(a,b);if(null==d)throw new TError(this,"Invalid value (enum={1}, value={2})",RClass.dump(a),b);return d},MO.REnum=new REnum;
with(MO)MO.RFile=function(){this.pictures=["jpg","png","gif","bmp"];this.knowns="jpg png gif bmp doc docx vsd xls xlsx".split(" ");this.inPicture=RFile_inPicture;this.isPicture=RFile_isPicture;this.isKnown=RFile_isKnown;this.name=RFile_name;this.extension=RFile_extension;return this},MO.RFile_inPicture=function(a){if(a){a=a.toLowerCase();for(var b in this.pictures)if(this.pictures[b]==a)return!0}},MO.RFile_isPicture=function(a){return this.inPicture(this.extension(a))},MO.RFile_isKnown=function(a){a=
this.extension(a).toLowerCase();for(var b in this.knowns)if(this.knowns[b]==a)return!0;return!1},MO.RFile_name=function(a){if(a){a=a.replace(/\\/g,"/");var b=a.lastIndexOf("/");-1!=b&&(a=a.substring(b+1));b=a.lastIndexOf(".");return-1!=b?a.substring(0,b):a}return""},MO.RFile_extension=function(a){if(a){a=a.replace(/\\/g,"/");var b=a.lastIndexOf("/");-1!=b&&(a=a.substring(b+1));b=a.lastIndexOf(".");return-1!=b?a.substring(b+1):a}return""},MO.RFile=new RFile;
with(MO)MO.RFloat=function(){this.NUMBER=this.Chars="0123456789-.%";this.LEFT_CHAR="0";this.isFloat=RFloat_isFloat;this.parse=RFloat_parse;this.format=RFloat_format;this.nvl=RFloat_nvl;this.toRange=RFloat_toRange;this.sum=RFloat_sum;this.calculate=RFloat_calculate;this.attach=RFloat_attach;this.fill=RFloat_fill;this.copy=RFloat_copy;return this},MO.RFloat_isFloat=function(a){return RString.isPattern(a,"n")},MO.RFloat_parse=function(a){if(null==a||""==a)return 0;a=RString.trim(a.toString());if(null==
a)return 0;for(;"0"==a.charAt(0);)a=a.substr(1);a=0<a.length?parseFloat(a):0;-1!=RString.findChars(a,"%")&&(a/=100);return isNaN(a)?0:a},MO.RFloat_format=function(a,b,d,f,h){null==b&&(b=0);null==d&&(d=this.LEFT_CHAR);null==f&&(f=6);null==h&&(h=this.LEFT_CHAR);var k=a.toString(),q=k.indexOf(".");-1==q?(a=k,k=""):(a=k.substring(0,q),k=k.substring(q+1,q+f+1));b=RString.lpad(a,b,d);f=RString.rpad(k,f,h);return b+"."+f},MO.RFloat_nvl=function(a,b){return a?a:b?b:0},MO.RFloat_toRange=function(a,b,d){null==
a&&(a=0);return Math.min(Math.max(a,b),d)},MO.RFloat_sum=function(){for(var a=arguments,b=0,d=a.length-1;0<=d;d--){var f=a[n];null!=f&&(b+=parseFloat(f))}return b},MO.RFloat_calculate=function(a,b,d){b=RFloat.nvl(b);d=RFloat.nvl(d);b=parseFloat(b);d=parseFloat(d);return a?(b+d).toString():(b-d).toString()},MO.RFloat_attach=function(a,b,d){for(var f=!1,h=0;h<d;h++)a[h]!=b[h]&&(a[h]=b[h],f=!0);return f},MO.RFloat_fill=function(a,b,d,f){for(var h=0;h<d;h++)a[b++]=f},MO.RFloat_copy=function(a,b,d,f,h){for(var k=
0;k<h;k++)a[b++]=d[f++]},MO.RFloat=new RFloat;with(MO)MO.RHex=function(){this.NUMBER="0x123456789ABCDEF";this.PAD="0";this.isValid=RHex_isValid;this.parse=RHex_parse;this.format=RHex_format;return this},MO.RHex_isValid=function(a){return RString.isPattern(a,this.NUMBER)},MO.RHex_parse=function(a){return a?parseInt("0x"+a):"0"},MO.RHex_format=function(a,b){var d=null,d=a?a.toString(16):"0";return b?RString.lpad(d,b,this.PAD):d},MO.RHex=new RHex;
with(MO)MO.RInstance=function(){this._pools=new TDictionary;this.pool=RInstance_pool;this.get=RInstance_get;this.alloc=RInstance_alloc;this.free=RInstance_free;return this},MO.RInstance_pool=function(a){a=RClass.name(a);var b=this._pools.get(a);null==b&&(b=new TInstancePool,this._pools.set(a,b));return b},MO.RInstance_get=function(a){return this.pool(a).instance(a)},MO.RInstance_alloc=function(a){return this.pool(p).alloc(p)},MO.RInstance_free=function(a){this.pool(p).free(p)},MO.RInstance=new RInstance;
with(MO)MO.RInteger=function(){this.NUMBER=this.Chars="0123456789-%";this.LEFT_CHAR="0";this.MAX_UINT16=65535;this.MAX_UINT32=4294967295;this.isInteger=this.isInt=RInteger_isInt;this.nvl=RInteger_nvl;this.strideByte=RInteger_strideByte;this.strideBit=RInteger_strideBit;this.parse=RInteger_parse;this.format=RInteger_format;this.toRange=RInteger_toRange;this.pow2=RInteger_pow2;this.sum=RInteger_sum;this.calculate=RInteger_calculate;this.copy=RInteger_copy;this.toString=RInteger_toString;return this},
MO.RInteger_isInt=function(a){return RString.isPattern(a,"n")},MO.RInteger_nvl=function(a,b){return a?a:b?b:0},MO.RInteger_strideByte=function(a){return 65535<a?4:255<a?2:1},MO.RInteger_strideBit=function(a){return 65535<a?32:255<a?16:8},MO.RInteger_parse=function(a,b){null==b&&(b=0);if(null==a||""==a)return b;for(a=RString.trim(a.toString());"0"==a.charAt(0);)a=a.substr(1);var d=0<a.length?parseInt(a):b;return isNaN(d)?b:d},MO.RInteger_format=function(a,b,d){d||(d=this.LEFT_CHAR);a=a.toString();
for(b=parseInt(b)-a.length-1;0<=b;b--)a=d+a;return a},MO.RInteger_toRange=function(a,b,d){null==a&&(a=0);isNaN(a)&&(a=0);a<b&&(a=b);a>d&&(a=d);return a},MO.RInteger_pow2=function(a){return 4096<a?8192:2048<a?4096:1024<a?2048:512<a?1024:256<a?512:128<a?256:64<a?128:32<a?64:16<a?32:8<a?16:4<a?8:2<a?4:1<a?2:1},MO.RInteger_sum=function(){for(var a=0,b=arguments,d=b.length,f=0;f<d;f++)null!=b[f]&&(a+=parseInt(b[f]));return a},MO.RInteger_calculate=function(a,b,d){b=RInteger.parse(b);d=RInteger.parse(d);
var f="";"+"==a?f=b+d:"-"==a?f=b-d:"x"==a?f=b*d:"/"==a&&(f=b/d);return f.toString()},MO.RInteger_copy=function(a,b,d,f,h){for(var k=0;k<h;k++)a[b++]=d[f++]},MO.RInteger_toString=function(a){return null==a?"0":a.toString()},MO.RInteger=new RInteger;with(MO)MO.RJson=function(){this.parse=RJson_parse;this.toString=RJson_toString;return this},MO.RJson_parse=function(a,b){var d=null;try{d=JSON.parse(a)}catch(f){b&&(d=new b)}return d},MO.RJson_toString=function(a){return JSON.stringify(a)},MO.RJson=new RJson;
with(MO)MO.RLogger=function(){this._statusError=!1;this._labelLength=40;this.lsnsOutput=new TListeners;this.output=RLogger_output;this.debug=RLogger_debug;this.info=RLogger_info;this.warn=RLogger_warn;this.error=RLogger_error;this.fatal=RLogger_fatal;this.show=RLogger_show;return this},MO.RLogger_output=function(a,b){this.lsnsOutput.process(a,b)},MO.RLogger_debug=function RLogger_debug(b,d,f){var h=RMethod.name(RLogger_debug.caller),h=h.replace("_","."),k=new TString;k.append(RDate.format("yymmdd-hh24miss.ms"));
k.append("|D ["+RString.rpad(h,this._labelLength)+"] ");for(var q=arguments,w=q.length,h=2;h<w;h++){var x=q[h],y="";null!=x&&(y="function"==typeof x?RMethod.name(x):x.toString());d=d.replace("{"+(h-1)+"}",y)}k.append(d);this.output(b,k.flush())},MO.RLogger_info=function RLogger_info(b,d,f){var h=RMethod.name(RLogger_info.caller),h=h.replace("_","."),k=new TString;k.append(RDate.format("yymmdd-hh24miss.ms"));k.append("|I ["+RString.rpad(h,this._labelLength)+"] ");for(var q=arguments,w=q.length,h=2;h<
w;h++){var x=q[h],y="";null!=x&&(y="function"==typeof x?RMethod.name(x):x.toString());d=d.replace("{"+(h-1)+"}",y)}k.append(d);this.output(b,k.flush())},MO.RLogger_warn=function RLogger_warn(b,d,f){var h=RMethod.name(RLogger_warn.caller),h=h.replace("_","."),k=new TString;k.append(RDate.format("yymmdd-hh24miss.ms"));k.append("|W ["+RString.rpad(h,this._labelLength)+"] ");for(var q=arguments,w=q.length,h=2;h<w;h++){var x=q[h],y="";null!=x&&(y="function"==typeof x?RMethod.name(x):x.toString());d=d.replace("{"+
(h-1)+"}",y)}k.append(d);this.output(b,k.flush())},MO.RLogger_error=function RLogger_error(b,d,f){var h=RMethod.name(RLogger_error.caller),h=h.replace("_","."),k=new TString;k.append(RDate.format("yymmdd-hh24miss.ms"));k.append("|E ["+RString.rpad(h,this._labelLength)+"] ");for(var q=arguments,w=q.length,h=2;h<w;h++){var x=q[h],y="";null!=x&&(y="function"==typeof x?RMethod.name(x):x.toString());d=d.replace("{"+(h-1)+"}",y)}k.append(d);this.output(b,k.flush())},MO.RLogger_fatal=function RLogger_fatal(b,
d,f,h){if(!this._statusError){this._statusError=!0;for(var k=new TString,q=[],w=RLogger_fatal.caller;w&&!RArray.contains(q,w);)q.push(w),w=w.caller;for(var x=q.length,y=0;y<x;y++)w=q[y],0<y&&k.appendLine(),k.append("   "+(x-y)+": "+RMethod.name(w));q=new TString;q.appendLine(RContext.get("RMessage:fatal"));q.appendLine(RString.repeat("-",60));q.append(RClass.dump(b),": ");if(f)for(w=arguments,x=w.length,y=3;y<x;y++){var z=w[y];"function"==typeof z&&(z=RMethod.name(z));f=f.replace("{"+(y-2)+"}",z)}q.appendLine(f);
q.appendLine(RString.repeat("-",60));q.appendLine("Stack:");q.append(k);throw Error(q.toString());}},MO.RLogger_show=function RLogger_show(b,d,f){var h=RMethod.name(RLogger_show.caller),h=h.replace("_","."),k=new TString;k.append(RDate.format("yymmdd-hh24miss.ms"));k.append("|I ["+RString.rpad(h,this._labelLength)+"] ");for(var q=arguments,w=q.length,h=2;h<w;h++){var x=q[h],y="";null!=x&&(y="function"==typeof x?RMethod.name(x):x.toString());d=d.replace("{"+(h-1)+"}",y)}k.append(d);alert(k.flush())},
MO.RLogger=new RLogger;
with(MO)MO.RMethod=function(){this._virtuals={};this.isFunction=RMethod_isFunction;this.isEmpty=RMethod_isEmpty;this.isVirtual=RMethod_isVirtual;this.name=RMethod_name;this.fullName=RMethod_fullName;this.empty=RMethod_empty;this.emptyTrue=RMethod_emptyTrue;this.emptyFalse=RMethod_emptyFalse;this.emptyCall=RMethod_emptyCall;this.virtual=RMethod_virtual;this.empty.__empty=!0;this.emptyTrue.__empty=!0;this.emptyFalse.__empty=!0;return this},MO.RMethod_isFunction=function(a){return"function"==typeof a},
MO.RMethod_isEmpty=function(a){return a&&a.__empty},MO.RMethod_isVirtual=function(a){return a&&a.__virtual},MO.RMethod_name=function(a){return a&&"function"==typeof a?a.__name?a.__name:a.__name=RString.mid(a.toString(),"function ","("):null},MO.RMethod_fullName=function(a){return a&&a.constructor==Function?a.__fullname?a.__fullname:a.__fullname=RString.mid(a.toString(),"function ",")")+")":null},MO.RMethod_empty=function(){},MO.RMethod_emptyTrue=function(){return!0},MO.RMethod_emptyFalse=function(){return!1},
MO.RMethod_emptyCall=function(){},MO.RMethod_virtual=function(a,b){var d=RClass.name(a)+"."+b;if(this._virtuals[d])return this._virtuals[d];var f=function(){throw Error("Virtual method be called.("+d+")");};f.__virtual=!0;f.__name=d;return this._virtuals[d]=f},MO.RMethod=new RMethod;
with(MO)MO.RObject=function(){this._hash=1;this.nextId=RObject_nextId;this.nvl=RObject_nvl;this.clone=RObject_clone;this.copy=RObject_copy;this.free=RObject_free;this.dispose=RObject_dispose;this.release=RObject_release;return this},MO.RObject_nextId=function(a){return this._hash++},MO.RObject_nvl=function(a){for(var b=arguments,d=b.length,f=0;f<d;f++)if(null!=b[f])return b[f];return null},MO.RObject_clone=function(a){var b=new a.constructor,d;for(d in a){var f=a[d];null!=f&&(RClass.isBaseType(f.constructor)||
(f=RObject.clone(f)));b[d]=f}return b},MO.RObject_copy=function(a,b){if(null!=a&&null!=b)for(var d in a){var f=a[d];null==f||RClass.isBaseType(f.constructor)||(null==b[d]&&(b[d]=new c),RObject.copy(f,b[d]));b[d]=f}},MO.RObject_free=function(a){if(a)if(RRuntime.isDebug())for(var b in a)if("__base"==b||"__inherits"==b||"__class"==b)a[b]=null;else{var d=a[b];if(null!=d){if(!RClass.isBaseType(d.constructor))throw new TError(RObject,"Free object is not base object.");a[b]=null}}else for(b in a)a[b]=null},
MO.RObject_dispose=function(a){a&&(a.__dispose||a.dispose());return null},MO.RObject_release=function(a){if(a)for(var b in p){var d=a[b];"Object"==typeof d&&RObject.release(d);a[b]=null}},MO.RObject=new RObject;
with(MO)MO.RRect=function(){this.nvl=RRect_nvl;this.pack=RRect_pack;this.unpack=RRect_unpack;return this},MO.RRect_nvl=function(a){return a?a:new TRect},MO.RRect_pack=function(a){var b=null;a&&(b=a.left+","+a.top+","+a.right+","+a.bottom);return b},MO.RRect_unpack=function(a,b){b=this.nvl(b);if(a){var d=a.split(",");4==d.length&&(b.left=RInt.parse(d[0]),b.top=RInt.parse(d[1]),b.right=RInt.parse(d[2]),b.bottom=RInt.parse(d[3]))}return b},MO.RRect=new RRect;
with(MO)MO.RRegExp=function(){this.test=RRegExp_test;this.testRgexp=RRegExp_testRgexp;return this},MO.RRegExp_test=function(a,b){return a&&null!=b?a.test(b):!1},MO.RRegExp_testRgexp=function(a,b){return a&&b?(new R,a.test(b)):!1},MO.RRegExp=new RRegExp;with(MO)MO.RSet=function(){this.contains=RSet_contains;this.containsString=RSet_containsString;return this},MO.RSet_contains=function(a,b){return(a&b)==b},MO.RSet_containsString=function(a,b){return null!=a&&null!=s?-1!=a.indexOf(s):!1},MO.RSet=new RSet;
with(MO)MO.RString=function(){this.EMPTY="";this.SPACE="   ";this.PAD=" ";this.TRIM=" \t\r\n";this.LOWER="abcdefghijklmnopqrstuvwxyz";this.UPPER="ABCDEFGHIJKLMNOPQRSTUVWXYZ";this.CodeLowerA=97;this.CodeLowerZ=122;this.CodeUpperA=65;this.CodeUpperZ=90;this.isEmpty=RString_isEmpty;this.isBlank=RString_isBlank;this.isAnsi=RString_isAnsi;this.isDbcs=RString_isDbcs;this.isPattern=RString_isPattern;this.inChars=RString_inChars;this.contains=RString_contains;this.equals=RString_equals;this.startsWith=RString_startsWith;
this.endsWith=RString_endsWith;this.findChars=RString_findChars;this.inRange=RString_inRange;this.nvl=RString_nvl;this.nvlString=RString_nvlString;this.empty=RString_empty;this.firstUpper=RString_firstUpper;this.firstLower=RString_firstLower;this.firstLine=RString_firstLine;this.format=RString_format;this.formatLines=RString_formatLines;this.repeat=RString_repeat;this.pad=RString_pad;this.lpad=RString_lpad;this.rpad=RString_rpad;this.trim=RString_trim;this.ltrim=RString_ltrim;this.rtrim=RString_rtrim;
this.mid=RString_mid;this.toLine=RString_toLine;this.toUnderline=RString_toUnderline;this.toLower=RString_toLower;this.toUpper=RString_toUpper;this.split=RString_split;this.splitTwo=RString_splitTwo;this.splitParts=RString_splitParts;this.splitPattern=RString_splitPattern;this.replace=RString_replace;this.replaceChar=RString_replaceChar;this.remove=RString_remove;this.removeChars=RString_removeChars;return this},MO.RString_isEmpty=function(a){return null!=a?0==a.length:!0},MO.RString_isBlank=function(a){return null!=
a?0==a.trim().length:!0},MO.RString_isAnsi=function(a){if(null!=a){for(var b=a.length,d=0;d<b;d++)if(255<a.charCodeAt(d))return!1;return!0}return!1},MO.RString_isDbcs=function(a){if(null==a){a=a.length;for(var b=0;b<a;b++)if(256>value.charCodeAt(b))return!1;return!0}return!1},MO.RString_isPattern=function(a,b){if(null!=a){null==b&&(b="$a$A$f");b=b.replace(/\a/g,this.LOWER);b=b.replace(/\A/g,this.UPPER);b=b.replace(/\f/g,RFloat.NUMBER);b=b.replace(/\n/g,RInteger.NUMBER);for(var d=a.length,f=0;f<d;f++)if(-1==
b.indexOf(a.charAt(f)))return!1;return!0}return!1},MO.RString_inChars=function(a,b){return-1!=this.findChars(b,a)?!0:!1},MO.RString_contains=function(a,b){return null!=a&&null!=b?-1!=a.toString().indexOf(b):!1},MO.RString_equals=function(a,b,d){null==a?a="":a.constructor!=String&&(a=a.toString());null==b?b="":b.constructor!=String&&(b=b.toString());return d?a==b:a.toLowerCase()==b.toLowerCase()},MO.RString_startsWith=function(a,b){return null==b?!0:null!=a?0==a.indexOf(b):!1},MO.RString_endsWith=
function(a,b){if(null==b)return!0;var d=null!=a?a.indexOf(b):-1;return-1!=d?d==a.length-b.length:!1},MO.RString_findChars=function(a,b){if(null!=a&&null!=b)for(var d=a.length,f=0;f<d;f++)if(-1!=b.indexOf(a.charAt(f)))return f;return-1},MO.RString_inRange=function(a,b,d){if(a&&b){d||(a=a.toLowerCase());for(var f=b.length,h=0;h<f;h++){var k=b[h];if(null!=k)if(d){if(a==k)return!0}else if(a==k.toLowerCase())return!0}}return!1},MO.RString_nvl=function(a,b){if(null!=a){var d=null,d=a.constructor!=String?
a.toString():a;if(0<d.length)return d}return null!=b?b:this.EMPTY},MO.RString_nvlString=function(a){null==a&&(a=new TString);return a},MO.RString_empty=function(a){if(null!=a){var b=null,b=a.constructor!=String?a.toString():a;if(0<b.length)return b}return null},MO.RString_firstUpper=function(a){return null!=a?a.charAt(0).toUpperCase()+a.substr(1):a},MO.RString_firstLower=function(){return null!=v?v.charAt(0).toLowerCase()+v.substr(1):v},MO.RString_firstLine=function(a){if(a){var b=Math.min(a.indexOf("\r"),
a.indexOf("\n"));return-1!=b?a.substr(0,b):a}return""},MO.RString_format=function(a,b){for(var d=arguments,f=d.length,h=1;h<f;h++)b=d[h],"function"==typeof b?b=RMethod.name(b):null==b&&(b=""),a=a.replace("{"+(h-1)+"}",b);return a},MO.RString_formatLines=function(a){a=a.replace(/\\r/g,"");a=a.split("\n");for(var b=a.length,d=new TString,f=0;f<b;f++){var h=a[f],h=this.trim(h);this.isEmpty(h)||this.startsWith(h,"//")||d.appendLine(h)}return d.toString()},MO.RString_repeat=function(a,b){return Array(b+
1).join(a)},MO.RString_pad=function(a,b,d){a=null!=a?a.toString():this.EMPTY;b-=a.length;if(0<b){null==d&&(d=this.PAD);var f=0==b%2?b/2:(b-1)/2;return Array(f+1).join(d)+a+Array(b-f+1).join(d)}return a},MO.RString_lpad=function(a,b,d){a=null!=a?a.toString():this.EMPTY;b-=a.length;return 0<b?(null==d&&(d=this.PAD),b=Array(b),b[b.length]=a,b.join(d)):a},MO.RString_rpad=function(a,b,d){a=null!=a?a.toString():this.EMPTY;b-=a.length;return 0<b?(null==d&&(d=this.PAD),a+Array(b+1).join(d)):a},MO.RString_trim=
function(a,b){a=this.nvl(a);b=this.nvl(b,this.TRIM);for(var d=0,f=a.length-1;d<f&&-1!=b.indexOf(a.charAt(d));d++);for(;f>=d&&-1!=b.indexOf(a.charAt(f));f--);return d==f+1?null:0!=d||f!=a.length-1?a.substring(d,f+1):a},MO.RString_ltrim=function(a,b){a=this.nvl(value);b=this.nvl(trims,this.TRIM);for(var d=0,f=a.length-1;d<f&&-1!=b.indexOf(a.charAt(d));d++);return 0!=d?a.substring(d,f+1):a},MO.RString_rtrim=function(a,b){a=this.nvl(a);b=this.nvl(b,this.TRIM);for(var d=a.length-1;0<=d&&-1!=b.indexOf(a.charAt(d));d--);
return d!=a.length-1?a.substring(0,d+1):a},MO.RString_mid=function(a,b,d){if(null==a)return a;var f=0;if(null!=b){var h=a.indexOf(b);-1!=h&&(f=h+b.length)}b=a.length;null!=d&&(h=a.indexOf(d,f),-1!=h&&(b=h));return a.substring(f,b)},MO.RString_toLine=function(a){return a.replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\t/g,"\\t")},MO.RString_toUnderline=function(a){var b=null;if(a){for(var b=new TString,d=a.length,f=0;f<d;f++){var h=a.charAt(f);h.toUpperCase()==h?(0<f&&b.append("_"),b.append(h.toLowerCase())):
b.append(h)}b=b.toString()}return b},MO.RString_toLower=function(a){return null!=a?a.toLowerCase():this.EMPTY},MO.RString_toUpper=function(a){return null!=a?a.toUpperCase():this.EMPTY},MO.RString_split=function(a,b){return a&&b?a.split(b):null},MO.RString_splitTwo=function(a,b){if(a&&b){var d=[],f=a.indexOf(b);-1==f?d.push(a):(d.push(a.substring(0,f)),d.push(a.substring(f+b.length)));return d}return null},MO.RString_splitParts=function(a,b){for(var d=[],f=0,h=a.length,k=0;k<h;k++)for(var q in b)if(this.startsWith(b[q],
a.charAt(k))&&this.equals(a.substr(k,b[q].length),b[q])){d[f++]=b[q];k=k+b[q].length-1;break}return d},MO.RString_splitPattern=function(a,b){var d=[];if(a)for(var f=a.length,h=b.length,k="",q=0;q<f;q++){for(var w=!1,x=0;x<h;x++){var y=b[x];if(-1==a.indexOf(y)){k.length&&(d[d.length]=k,k="");d[d.length]=y;a=a.substring(y.length);w=!0;break}}w||(k+=a.charAt(0),a=a.substring(1))}return d},MO.RString_replace=function(a,b,d){return a.replace(new RegExp(b,"g"),d)},MO.RString_replaceChar=function(a,b,d){if(null!=
a){for(var f=a.length,h=[],k=0;k<f;k++){var q=a.charAt(k);h[h.length]=q==b?d:q}return h.join("")}return a},MO.RString_remove=function(a,b){return a.replace(b,"")},MO.RString_removeChars=function(a,b){if(null!=a){for(var d=a.length,f=[],h=0;h<d;h++){var k=a.charAt(h);-1==b.indexOf(k)&&(f[f.length]=k)}return f.join("")}return a},MO.RString=new RString;
with(MO)MO.RTimer=function(){this._count=this._lastTime=this._startTime=0;this.setup=RTimer_setup;this.now=RTimer_now;this.current=RTimer_current;this.rate=RTimer_rate;this.update=RTimer_update;return this},MO.RTimer_setup=function(){var a=(new Date).getTime();this._lastTime=this._startTime=a},MO.RTimer_now=function(){return(new Date).getTime()},MO.RTimer_current=function(){return this._lastTime},MO.RTimer_rate=function(){return 0==this._count?0:parseInt(1E3*this._count/(this._lastTime-this._startTime))},
MO.RTimer_update=function(){this._count++;this._lastTime=(new Date).getTime()},MO.RTimer=new RTimer;MO.EFrustumPlane=new function(){this.Near=0;this.Far=1;this.Left=2;this.Right=3;this.Top=4;this.Bottom=5;this.Count=6;return this};
with(MO)MO.SColor4=function(a,b,d,f){this.red=a?a:0;this.green=b?b:0;this.blue=d?d:0;this.alpha=f?f:1;this.assign=SColor4_assign;this.assignPower=SColor4_assignPower;this.set=SColor4_set;this.serialize=SColor4_serialize;this.unserialize=SColor4_unserialize;this.unserialize3=SColor4_unserialize3;this.saveConfig=SColor4_saveConfig;this.savePower=SColor4_savePower;this.copyArray=SColor4_copyArray;this.toString=SColor4_toString;return this},MO.SColor4_assign=function(a){this.red=a.red;this.green=a.green;
this.blue=a.blue;this.alpha=a.alpha},MO.SColor4_assignPower=function(a){this.red=a.red*a.alpha;this.green=a.green*a.alpha;this.blue=a.blue*a.alpha;this.alpha=a.alpha},MO.SColor4_set=function(a,b,d,f){this.red=a;this.green=b;this.blue=d;this.alpha=f},MO.SColor4_serialize=function(a){a.writeFloat(this.red);a.writeFloat(this.green);a.writeFloat(this.blue);a.writeFloat(this.alpha)},MO.SColor4_unserialize=function(a){this.red=a.readFloat();this.green=a.readFloat();this.blue=a.readFloat();this.alpha=a.readFloat()},
MO.SColor4_unserialize3=function(a){this.red=a.readFloat();this.green=a.readFloat();this.blue=a.readFloat();this.alpha=1},MO.SColor4_saveConfig=function(a){a.setFloat("r",this.red);a.setFloat("g",this.green);a.setFloat("b",this.blue);a.setFloat("a",this.alpha)},MO.SColor4_savePower=function(a){a.setFloat("r",this.red);a.setFloat("g",this.green);a.setFloat("b",this.blue);a.setFloat("power",this.alpha)},MO.SColor4_copyArray=function(a,b){a[b++]=this.red;a[b++]=this.green;a[b++]=this.blue;a[b++]=this.alpha;
return 4},MO.SColor4_toString=function(){return RFloat.format(this.red)+","+RFloat.format(this.green)+","+RFloat.format(this.blue)+","+RFloat.format(this.alpha)};
with(MO)MO.SCorners=function(){this.blue=this.green=this.red=0;this.alpha=1;this.assign=SCorners_assign;this.assignPower=SCorners_assignPower;this.set=SCorners_set;this.serialize=SCorners_serialize;this.unserialize=SCorners_unserialize;this.unserialize3=SCorners_unserialize3;this.saveConfig=SCorners_saveConfig;this.savePower=SCorners_savePower;this.copyArray=SCorners_copyArray;this.toString=SCorners_toString;return this},MO.SCorners_assign=function(a){this.red=a.red;this.green=a.green;this.blue=a.blue;
this.alpha=a.alpha},MO.SCorners_assignPower=function(a){this.red=a.red*a.alpha;this.green=a.green*a.alpha;this.blue=a.blue*a.alpha;this.alpha=a.alpha},MO.SCorners_set=function(a,b,d,f){this.red=a;this.green=b;this.blue=d;this.alpha=f},MO.SCorners_serialize=function(a){a.writeFloat(this.red);a.writeFloat(this.green);a.writeFloat(this.blue);a.writeFloat(this.alpha)},MO.SCorners_unserialize=function(a){this.red=a.readFloat();this.green=a.readFloat();this.blue=a.readFloat();this.alpha=a.readFloat()},
MO.SCorners_unserialize3=function(a){this.red=a.readFloat();this.green=a.readFloat();this.blue=a.readFloat();this.alpha=1},MO.SCorners_saveConfig=function(a){a.setFloat("r",this.red);a.setFloat("g",this.green);a.setFloat("b",this.blue);a.setFloat("a",this.alpha)},MO.SCorners_savePower=function(a){a.setFloat("r",this.red);a.setFloat("g",this.green);a.setFloat("b",this.blue);a.setFloat("power",this.alpha)},MO.SCorners_copyArray=function(a,b){a[b++]=this.red;a[b++]=this.green;a[b++]=this.blue;a[b++]=
this.alpha;return 4},MO.SCorners_toString=function(){return RFloat.format(this.red)+","+RFloat.format(this.green)+","+RFloat.format(this.blue)+","+RFloat.format(this.alpha)};
with(MO)MO.SFrustum=function(){this.center=new SPoint3;this.maxZ=this.minZ=this.maxY=this.minY=this.maxX=this.minX=this.radius=null;this.points=Array(24);this.coners=Array(24);this.updateCenter=SFrustum_updateCenter;this.update=SFrustum_update;this.updateFlat=SFrustum_updateFlat;return this},MO.SFrustum_updateCenter=function(){var a=this.coners;this.minX=this.minY=this.minZ=Number.MAX_VALUE;this.maxX=this.maxY=this.maxZ=-Number.MAX_VALUE;for(var b=0;24>b;){var d=a[b++];d<this.minX&&(this.minX=d);
d>this.maxX&&(this.maxX=d);d=a[b++];d<this.minY&&(this.minY=d);d>this.maxY&&(this.maxY=d);d=a[b++];d<this.minZ&&(this.minZ=d);d>this.maxZ&&(this.maxZ=d)}this.center.x=.5*(this.minX+this.maxX);this.center.y=.5*(this.minY+this.maxY);this.center.z=.5*(this.minZ+this.maxZ);a=this.maxX-this.minX;b=this.maxY-this.minY;d=this.maxZ-this.minZ;this.radius=.5*Math.sqrt(a*a+b*b+d*d)},MO.SFrustum_update=function(a,b,d,f,h,k,q,w){d=b/d;k=Math.tan(RConst.DEGREE_RATE*a*.5);a=f*k;b=a*d;k*=h;q=k*d;d=this.points;d[0]=
-b;d[1]=a;d[2]=f;d[3]=b;d[4]=a;d[5]=f;d[6]=b;d[7]=-a;d[8]=f;d[9]=-b;d[10]=-a;d[11]=f;d[12]=-q;d[13]=k;d[14]=h;d[15]=q;d[16]=k;d[17]=h;d[18]=q;d[19]=-k;d[20]=h;d[21]=-q;d[22]=-k;d[23]=h;f=RMath.matrix;f.assign(w);f.invert();f.transform(this.coners,d,8);this.updateCenter()},MO.SFrustum_updateFlat=function(a,b,d,f,h,k,q,w){b/=d;f*=q;h*=k;q=Math.tan(RConst.DEGREE_RATE*a*.5);a=f*q;k=a*b;q*=h;d=q*b;b=this.points;b[0]=-k;b[1]=a;b[2]=f;b[3]=k;b[4]=a;b[5]=f;b[6]=k;b[7]=-a;b[8]=f;b[9]=-k;b[10]=-a;b[11]=f;b[12]=
-d;b[13]=q;b[14]=h;b[15]=d;b[16]=q;b[17]=h;b[18]=d;b[19]=-q;b[20]=h;b[21]=-d;b[22]=-q;b[23]=h;f=RMath.matrix;f.assign(w);f.invert();f.transform(this.coners,0,b,0,8);this.coners[1]=0;this.coners[4]=0;this.coners[7]=0;this.coners[10]=0;this.coners[13]=0;this.coners[16]=0;this.coners[19]=0;this.coners[22]=0;this.updateCenter()};
with(MO)MO.SFrustumPlanes=function(){this.planes=[];this.containsPoint=SFrustumPlanes_containsPoint;this.containsCube=SFrustumPlanes_containsCube;this.containsRectangle=SFrustumPlanes_containsRectangle;this.containsCorners=SFrustumPlanes_containsCorners;this.containsSphere=SFrustumPlanes_containsSphere;this.updateVision=SFrustumPlanes_updateVision;for(var a=0;a<EFrustumPlane.Count;a++)this.planes.push(new SPlane);return this},MO.SFrustumPlanes_containsPoint=function(a,b,d){for(var f=this.planes,h=
0;h<EFrustumPlane.Count;h++)if(0>f[n].dot(a,b,d))return!1;return!0},MO.SFrustumPlanes_containsCube=function(a,b,d,f){f=this.planes;for(var h=0;h<EFrustumPlane.Count;h++){var k=f[n];if(!(0<=k.dot(a-l,b-l,d-l)||0<=k.dot(a+l,b-l,d-l)||0<=k.dot(a-l,b+l,d-l)||0<=k.dot(a+l,b+l,d-l)||0<=k.dot(a-l,b-l,d+l)||0<=k.dot(a+l,b-l,d+l)||0<=k.dot(a-l,b+l,d+l)||0<=k.dot(a+l,b+l,d+l)))return!1}return!0},MO.SFrustumPlanes_containsRectangle=function(a,b,d,f,h,k){for(var q=this.planes,w=0;w<EFrustumPlane.Count;w++){var x=
q[n];if(!(0<=x.dot(a-f,b-h,d-k)||0<=x.dot(a+f,b-h,d-k)||0<=x.dot(a-f,b+h,d-k)||0<=x.dot(a+f,b+h,d-k)||0<=x.dot(a-f,b-h,d+k)||0<=x.dot(a+f,b-h,d+k)||0<=x.dot(a-f,b+h,d+k)||0<=x.dot(a+f,b+h,d+k)))return!1}return!0},MO.SFrustumPlanes_containsCorners=function(a){for(var b=this.planes,d=EFrustumPlane.Count-1;0<=d;d--){var f=b[d];if(!(0<=f.dot(a[0],a[1],a[2])||0<=f.dot(a[3],a[4],a[5])||0<=f.dot(a[6],a[7],a[8])||0<=f.dot(a[9],a[10],a[11])||0<=f.dot(a[12],a[13],a[14])||0<=f.dot(a[15],a[16],a[17])||0<=f.dot(a[18],
a[19],a[20])||0<=f.dot(a[21],a[22],a[23])))return!1}return!0},MO.SFrustumPlanes_containsSphere=function(a,b,d,f){for(var h=this.planes,k=0;k<EFrustumPlane.Count;k++)if(h[n].dot(a,b,d)<-f)return!1;return!0},MO.SFrustumPlanes_updateVision=function(a){var b=this.planes,d=b[EFrustumPlane.Near];d.a=a[3]+a[2];d.b=a[7]+a[6];d.c=a[11]+a[10];d.d=a[15]+a[14];d.normalize();d=b[EFrustumPlane.Far];d.a=a[3]-a[2];d.b=a[7]-a[6];d.c=a[11]-a[10];d.d=a[15]-a[14];d.normalize();d=b[EFrustumPlane.Left];d.a=a[3]-a[0];d.b=
a[7]-a[4];d.c=a[11]-a[8];d.d=a[15]-a[12];d.normalize();d=b[EFrustumPlane.Right];d.a=a[3]+a[0];d.b=a[7]+a[4];d.c=a[11]+a[8];d.d=a[15]+a[12];d.normalize();d=b[EFrustumPlane.Top];d.a=a[3]-a[1];d.b=a[7]-a[5];d.c=a[11]-a[9];d.d=a[15]-a[13];d.normalize();b=b[EFrustumPlane.Bottom];b.a=a[3]+a[1];b.b=a[7]+a[5];b.c=a[11]+a[9];b.d=a[15]+a[13];b.normalize()};
with(MO)MO.SMatrix3d=function(){SMatrix4x4.call(this);this._dirty=!1;this.rz=this.ry=this.rx=this.tz=this.ty=this.tx=0;this.sz=this.sy=this.sx=1;this.isIdentity=SMatrix3d_isIdentity;this.identity=SMatrix3d_identity;this.setTranslate=SMatrix3d_setTranslate;this.setRotation=SMatrix3d_setRotation;this.setScale=SMatrix3d_setScale;this.setScaleAll=SMatrix3d_setScaleAll;this.set=SMatrix3d_set;this.setAll=SMatrix3d_setAll;this.equals=SMatrix3d_equals;this.assign=SMatrix3d_assign;this.attach=SMatrix3d_attach;
this.append=SMatrix3d_append;this.updateForce=SMatrix3d_updateForce;this.update=SMatrix3d_update;this.merge=SMatrix3d_merge;this.serialize=SMatrix3d_serialize;this.unserialize=SMatrix3d_unserialize;this.saveConfig=SMatrix3d_saveConfig;this.identity();return this},MO.SMatrix3d_isIdentity=function(){return 0!=this.tx||0!=this.ty||0!=this.tz||0!=this.rx||0!=this.ry||0!=this.rz||1!=this.sx||1!=this.sy||1!=this.sz?!1:this.isIdentityData()},MO.SMatrix3d_identity=function(){this.rx=this.ry=this.rz=this.tx=
this.ty=this.tz=0;this.sx=this.sy=this.sz=1;return this.identityData()},MO.SMatrix3d_setTranslate=function(a,b,d){this.tx=a;this.ty=b;this.tz=d;this._dirty=!0},MO.SMatrix3d_setRotation=function(a,b,d){this.rx=a;this.ry=b;this.rz=d;this._dirty=!0},MO.SMatrix3d_setScale=function(a,b,d){this.sx=a;this.sy=b;this.sz=d;this._dirty=!0},MO.SMatrix3d_setScaleAll=function(a){this.sz=this.sy=this.sx=a;this._dirty=!0},MO.SMatrix3d_set=function(a,b,d){this.tx=a.x;this.ty=a.y;this.tz=a.z;this.rx=b.x;this.ry=b.y;
this.rz=b.z;this.sx=d.x;this.sy=d.y;this.sz=d.z;this._dirty=!0},MO.SMatrix3d_setAll=function(a,b,d,f,h,k,q,w,x){this.tx=a;this.ty=b;this.tz=d;this.rx=f;this.ry=h;this.rz=k;this.sx=q;this.sy=w;this.sz=x;this._dirty=!0},MO.SMatrix3d_equals=function(a){return this.equalsData(a._data)},MO.SMatrix3d_assign=function(a){this.tx=a.tx;this.ty=a.ty;this.tz=a.tz;this.rx=a.rx;this.ry=a.ry;this.rz=a.rz;this.sx=a.sx;this.sy=a.sy;this.sz=a.sz;this.assignData(a._data)},MO.SMatrix3d_attach=function(a){this.tx=a.tx;
this.ty=a.ty;this.tz=a.tz;this.rx=a.rx;this.ry=a.ry;this.rz=a.rz;this.sx=a.sx;this.sy=a.sy;this.sz=a.sz;return this.attachData(a._data)},MO.SMatrix3d_append=function(a){this.appendData(a._data)},MO.SMatrix3d_updateForce=function(){var a=this._data,b=Math.sin(this.rx),d=Math.cos(this.rx),f=Math.sin(this.ry),h=Math.cos(this.ry),k=Math.sin(this.rz),q=Math.cos(this.rz);a[0]=h*q*this.sx;a[1]=h*k*this.sx;a[2]=-f*this.sx;a[3]=0;a[4]=(b*f*q-d*k)*this.sy;a[5]=(b*f*k+d*q)*this.sy;a[6]=b*h*this.sy;a[7]=0;a[8]=
(d*f*q+b*k)*this.sz;a[9]=(d*f*k-b*q)*this.sz;a[10]=d*h*this.sz;a[11]=0;a[12]=this.tx;a[13]=this.ty;a[14]=this.tz;a[15]=1},MO.SMatrix3d_update=function(){this._dirty&&(this.updateForce(),this._dirty=!1)},MO.SMatrix3d_merge=function(a,b){this.tx=a.tx+b.tx;this.ty=a.ty+b.ty;this.tz=a.tz+b.tz;this.rx=a.rx+b.rx;this.ry=a.ry+b.ry;this.rz=a.rz+b.rz;this.sx=a.sx*b.sx;this.sy=a.sy*b.sy;this.sz=a.sz*b.sz;this.updateForce()},MO.SMatrix3d_serialize=function(a){a.writeFloat(this.tx);a.writeFloat(this.ty);a.writeFloat(this.tz);
a.writeFloat(this.rx);a.writeFloat(this.ry);a.writeFloat(this.rz);a.writeFloat(this.sx);a.writeFloat(this.sy);a.writeFloat(this.sz)},MO.SMatrix3d_unserialize=function(a){this.tx=a.readFloat();this.ty=a.readFloat();this.tz=a.readFloat();this.rx=a.readFloat();this.ry=a.readFloat();this.rz=a.readFloat();this.sx=a.readFloat();this.sy=a.readFloat();this.sz=a.readFloat();this.updateForce()},MO.SMatrix3d_saveConfig=function(a){a.set("tx",RFloat.format(this.tx));a.set("ty",RFloat.format(this.ty));a.set("tz",
RFloat.format(this.tz));a.set("rx",RFloat.format(this.rx));a.set("ry",RFloat.format(this.ry));a.set("rz",RFloat.format(this.rz));a.set("sx",RFloat.format(this.sx));a.set("sy",RFloat.format(this.sy));a.set("sz",RFloat.format(this.sz))};
with(MO)MO.SMatrix3x3=function(){this._data=Array(9);this.data=SMatrix3x3_data;this.equalsData=SMatrix3x3_equalsData;this.assignData=SMatrix3x3_assignData;this.appendData=SMatrix3x3_appendData;this.rotationX=SMatrix3x3_rotationX;this.rotationY=SMatrix3x3_rotationY;this.rotationZ=SMatrix3x3_rotationZ;this.rotation=SMatrix3x3_rotation;this.invert=SMatrix3x3_invert;this.transform=SMatrix3x3_transform;this.transformPoint3=SMatrix3x3_transformPoint3;this.build=SMatrix3x3_build;this.writeData=SMatrix3x3_writeData;
this.toString=SMatrix3x3_toString;return this},MO.SMatrix3x3_data=function(){return this._data},MO.SMatrix3x3_equalsData=function(a){for(var b=this._data,d=0;9>d;d++)if(b[d]!=a[d])return!1;return!0},MO.SMatrix3x3_assignData=function(a){for(var b=this._data,d=0;9>d;d++)b[d]=a[d]},MO.SMatrix3x3_appendData=function(a){var b=this._data,d=b[0]*a[1]+b[1]*a[4]+b[2]*a[7],f=b[0]*a[2]+b[1]*a[5]+b[2]*a[8],h=b[3]*a[0]+b[4]*a[3]+b[5]*a[6],k=b[3]*a[1]+b[4]*a[4]+b[5]*a[7],q=b[3]*a[2]+b[4]*a[5]+b[5]*a[8],w=b[6]*
a[0]+b[7]*a[3]+b[8]*a[6],x=b[6]*a[1]+b[7]*a[4]+b[8]*a[7],y=b[6]*a[2]+b[7]*a[5]+b[8]*a[8];b[0]=b[0]*a[0]+b[1]*a[3]+b[2]*a[6];b[1]=d;b[2]=f;b[3]=h;b[4]=k;b[5]=q;b[6]=w;b[7]=x;b[8]=y},MO.SMatrix3x3_rotationX=function(a){var b=Math.sin(a);a=Math.cos(a);var d=RMath.value9;d[0]=1;d[1]=0;d[2]=0;d[3]=0;d[4]=a;d[5]=b;d[6]=0;d[7]=-b;d[8]=a;this.appendData(d)},MO.SMatrix3x3_rotationY=function(a){var b=Math.sin(a);a=Math.cos(a);var d=RMath.value9;d[0]=a;d[1]=0;d[2]=b;d[3]=0;d[4]=1;d[5]=0;d[6]=-b;d[7]=0;d[8]=
a;this.appendData(d)},MO.SMatrix3x3_rotationZ=function(a){var b=Math.sin(a);a=Math.cos(a);var d=RMath.value9;d[0]=a;d[1]=b;d[2]=0;d[3]=-b;d[4]=a;d[5]=1;d[6]=0;d[7]=0;d[8]=1;this.appendData(d)},MO.SMatrix3x3_rotation=function(a,b,d){var f=Math.sin(a);a=Math.cos(a);var h=Math.sin(b);b=Math.cos(b);var k=Math.sin(d);d=Math.cos(d);var q=RMath.value9;q[0]=b*d;q[1]=b*k;q[2]=-h;q[3]=f*h*d-a*k;q[4]=f*h*k+a*d;q[5]=f*b;q[6]=a*h*d+f*k;q[7]=a*h*k-f*a;q[8]=a*b;this.appendData(q)},MO.SMatrix3x3_invert=function(){var a=
this._data,b=RValue.value9;b[0]=a[4]*a[8]-a[5]*a[7];b[1]=a[2]*a[7]-a[1]*a[8];b[2]=a[1]*a[5]-a[2]*a[4];b[3]=a[5]*a[6]-a[3]*a[8];b[4]=a[0]*a[8]-a[2]*a[6];b[5]=a[2]*a[3]-a[0]*a[5];b[6]=a[3]*a[7]-a[4]*a[6];b[7]=a[1]*a[6]-a[0]*a[7];b[8]=a[0]*a[4]-a[1]*a[3];var d=a[0]*b[0]+a[1]*b[3]+a[2]*b[6];if(0==d)return!1;for(var d=1/d,f=0;9>f;f++)a[f]=b[f]*d;return!0},MO.SMatrix3x3_transform=function(a,b,d){for(var f=this._data,h=0;h<d;h++){var k=(h<<1)+h;a[k]=b[k]*f[0]+b[k+1]*f[3]+b[k+2]*f[6];a[k+1]=b[k]*f[1]+b[k+
1]*f[4]+b[k+2]*f[7];a[k+2]=b[k]*f[2]+b[k+1]*f[5]+b[k+2]*f[8]}},MO.SMatrix3x3_transformPoint3=function(a,b){var d=this._data,f=a.x*d[0]+a.y*d[3]+a.z*d[6],h=a.x*d[1]+a.y*d[4]+a.z*d[7],d=a.x*d[2]+a.y*d[5]+a.z*d[8],k=null,k=b?b:new SPoint3;k.set(f,h,d);return k},MO.SMatrix3x3_build=function(a){var b=this._data,d=a.x*a.x,f=a.y*a.y,h=a.z*a.z,k=a.x*a.y,q=a.x*a.z,w=a.y*a.z,x=a.w*a.x,y=a.w*a.y;a=a.w*a.z;b[0]=1-2*(f+h);b[1]=2*(k-a);b[2]=2*(q+y);b[3]=2*(k+a);b[4]=1-2*(d+h);b[5]=2*(w-x);b[6]=2*(q-y);b[7]=2*(w+
x);b[8]=1-2*(d+f)},MO.SMatrix3x3_writeData=function(a,b){var d=this._data;a[b++]=d[0];a[b++]=d[3];a[b++]=d[6];a[b++]=d[1];a[b++]=d[4];a[b++]=d[7];a[b++]=d[2];a[b++]=d[5];a[b++]=d[8]},MO.SMatrix3x3_toString=function(){for(var a=this._data,b=new TString,d=0;3>d;d++){0<d&&b.append("|");for(var f=0;3>f;f++){var h=a[3*d+f];0<f&&b.append(",");b.append(RFloat.format(h,0,null,3,null))}}return b.flush()};
with(MO)MO.SMatrix4x4=function(){this._data=Array(16);this.data=SMatrix4x4_data;this.isIdentityData=SMatrix4x4_isIdentityData;this.identityData=SMatrix4x4_identityData;this.equalsData=SMatrix4x4_equalsData;this.assignData=SMatrix4x4_assignData;this.attachData=SMatrix4x4_attachData;this.appendData=SMatrix4x4_appendData;this.addTranslate=SMatrix4x4_addTranslate;this.addRotationX=SMatrix4x4_addRotationX;this.addRotationY=SMatrix4x4_addRotationY;this.addRotationZ=SMatrix4x4_addRotationZ;this.addRotation=
SMatrix4x4_addRotation;this.addScale=SMatrix4x4_addScale;this.invert=SMatrix4x4_invert;this.transform=SMatrix4x4_transform;this.transformPoint3=SMatrix4x4_transformPoint3;this.buildQuaternion=SMatrix4x4_buildQuaternion;this.build=SMatrix4x4_build;this.writeData=SMatrix4x4_writeData;this.writeData4x3=SMatrix4x4_writeData4x3;this.toString=SMatrix4x4_toString;return this},MO.SMatrix4x4_data=function(){return this._data},MO.SMatrix4x4_isIdentityData=function(){for(var a=this._data,b=RConst.identity4x4,
d=0;16>d;d++)if(a[d]!=b[d])return!1;return!0},MO.SMatrix4x4_identityData=function(){for(var a=this._data,b=RConst.identity4x4,d=0;16>d;d++)a[d]=b[d];return this},MO.SMatrix4x4_equalsData=function(a){for(var b=this._data,d=0;16>d;d++)if(b[d]!=a[d])return!1;return!0},MO.SMatrix4x4_assignData=function(a){for(var b=this._data,d=0;16>d;d++)b[d]=a[d]},MO.SMatrix4x4_attachData=function(a){for(var b=!1,d=this._data,f=0;16>f;f++){var h=a[f];b||d[f]!=h&&(b=!0);d[f]=h}return b},MO.SMatrix4x4_appendData=function(a){var b=
this._data,d=b[0]*a[1]+b[1]*a[5]+b[2]*a[9]+b[3]*a[13],f=b[0]*a[2]+b[1]*a[6]+b[2]*a[10]+b[3]*a[14],h=b[0]*a[3]+b[1]*a[7]+b[2]*a[11]+b[3]*a[15],k=b[4]*a[0]+b[5]*a[4]+b[6]*a[8]+b[7]*a[12],q=b[4]*a[1]+b[5]*a[5]+b[6]*a[9]+b[7]*a[13],w=b[4]*a[2]+b[5]*a[6]+b[6]*a[10]+b[7]*a[14],x=b[4]*a[3]+b[5]*a[7]+b[6]*a[11]+b[7]*a[15],y=b[8]*a[0]+b[9]*a[4]+b[10]*a[8]+b[11]*a[12],z=b[8]*a[1]+b[9]*a[5]+b[10]*a[9]+b[11]*a[13],A=b[8]*a[2]+b[9]*a[6]+b[10]*a[10]+b[11]*a[14],D=b[8]*a[3]+b[9]*a[7]+b[10]*a[11]+b[11]*a[15],B=b[12]*
a[0]+b[13]*a[4]+b[14]*a[8]+b[15]*a[12],E=b[12]*a[1]+b[13]*a[5]+b[14]*a[9]+b[15]*a[13],F=b[12]*a[2]+b[13]*a[6]+b[14]*a[10]+b[15]*a[14],C=b[12]*a[3]+b[13]*a[7]+b[14]*a[11]+b[15]*a[15];b[0]=b[0]*a[0]+b[1]*a[4]+b[2]*a[8]+b[3]*a[12];b[1]=d;b[2]=f;b[3]=h;b[4]=k;b[5]=q;b[6]=w;b[7]=x;b[8]=y;b[9]=z;b[10]=A;b[11]=D;b[12]=B;b[13]=E;b[14]=F;b[15]=C},MO.SMatrix4x4_addTranslate=function(a,b,d){var f=RArray.array16;f[0]=1;f[1]=0;f[2]=0;f[3]=0;f[4]=0;f[5]=1;f[6]=0;f[7]=0;f[8]=0;f[9]=0;f[10]=1;f[11]=0;f[12]=a;f[13]=
b;f[14]=d;f[15]=1;this.appendData(f)},MO.SMatrix4x4_addRotationX=function(a){var b=Math.sin(a);a=Math.cos(a);var d=RArray.array16;d[0]=1;d[1]=0;d[2]=0;d[3]=0;d[4]=0;d[5]=a;d[6]=b;d[7]=0;d[8]=0;d[9]=-b;d[10]=a;d[11]=0;d[12]=0;d[13]=0;d[14]=0;d[15]=1;this.appendData(d)},MO.SMatrix4x4_addRotationY=function(a){var b=Math.sin(a);a=Math.cos(a);var d=RArray.array16;d[0]=a;d[1]=0;d[2]=b;d[3]=0;d[4]=0;d[5]=1;d[6]=0;d[7]=0;d[8]=-b;d[9]=0;d[10]=a;d[11]=0;d[12]=0;d[13]=0;d[14]=0;d[15]=1;this.appendData(d)},MO.SMatrix4x4_addRotationZ=
function(a){var b=Math.sin(a);a=Math.cos(a);var d=RArray.array16;d[0]=a;d[1]=b;d[2]=0;d[3]=0;d[4]=-b;d[5]=a;d[6]=1;d[7]=0;d[8]=0;d[9]=0;d[10]=1;d[11]=0;d[12]=0;d[13]=0;d[14]=0;d[15]=1;this.appendData(d)},MO.SMatrix4x4_addRotation=function(a,b,d){var f=Math.sin(a);a=Math.cos(a);var h=Math.sin(b);b=Math.cos(b);var k=Math.sin(d);d=Math.cos(d);var q=RArray.array16;q[0]=b*d;q[1]=b*k;q[2]=-h;q[3]=0;q[4]=f*h*d-a*k;q[5]=f*h*k+a*d;q[6]=f*b;q[7]=0;q[8]=a*h*d+f*k;q[9]=a*h*k-f*a;q[10]=a*b;q[11]=0;q[12]=0;q[13]=
0;q[14]=0;q[15]=1;this.appendData(q)},MO.SMatrix4x4_addScale=function(a,b,d){var f=RArray.array16;f[0]=a;f[1]=0;f[2]=0;f[3]=0;f[4]=0;f[5]=b;f[6]=0;f[7]=0;f[8]=0;f[9]=0;f[10]=d;f[11]=0;f[12]=0;f[13]=0;f[14]=0;f[15]=1;this.appendData(f)},MO.SMatrix4x4_invert=function(){var a=this._data,b=RArray.array16;b[0]=a[5]*a[10]*a[15]-a[5]*a[11]*a[14]-a[9]*a[6]*a[15]+a[9]*a[7]*a[14]+a[13]*a[6]*a[11]-a[13]*a[7]*a[10];b[4]=-(a[4]*a[10]*a[15])+a[4]*a[11]*a[14]+a[8]*a[6]*a[15]-a[8]*a[7]*a[14]-a[12]*a[6]*a[11]+a[12]*
a[7]*a[10];b[8]=a[4]*a[9]*a[15]-a[4]*a[11]*a[13]-a[8]*a[5]*a[15]+a[8]*a[7]*a[13]+a[12]*a[5]*a[11]-a[12]*a[7]*a[9];b[12]=-(a[4]*a[9]*a[14])+a[4]*a[10]*a[13]+a[8]*a[5]*a[14]-a[8]*a[6]*a[13]-a[12]*a[5]*a[10]+a[12]*a[6]*a[9];b[1]=-(a[1]*a[10]*a[15])+a[1]*a[11]*a[14]+a[9]*a[2]*a[15]-a[9]*a[3]*a[14]-a[13]*a[2]*a[11]+a[13]*a[3]*a[10];b[5]=a[0]*a[10]*a[15]-a[0]*a[11]*a[14]-a[8]*a[2]*a[15]+a[8]*a[3]*a[14]+a[12]*a[2]*a[11]-a[12]*a[3]*a[10];b[9]=-(a[0]*a[9]*a[15])+a[0]*a[11]*a[13]+a[8]*a[1]*a[15]-a[8]*a[3]*
a[13]-a[12]*a[1]*a[11]+a[12]*a[3]*a[9];b[13]=a[0]*a[9]*a[14]-a[0]*a[10]*a[13]-a[8]*a[1]*a[14]+a[8]*a[2]*a[13]+a[12]*a[1]*a[10]-a[12]*a[2]*a[9];b[2]=a[1]*a[6]*a[15]-a[1]*a[7]*a[14]-a[5]*a[2]*a[15]+a[5]*a[3]*a[14]+a[13]*a[2]*a[7]-a[13]*a[3]*a[6];b[6]=-(a[0]*a[6]*a[15])+a[0]*a[7]*a[14]+a[4]*a[2]*a[15]-a[4]*a[3]*a[14]-a[12]*a[2]*a[7]+a[12]*a[3]*a[6];b[10]=a[0]*a[5]*a[15]-a[0]*a[7]*a[13]-a[4]*a[1]*a[15]+a[4]*a[3]*a[13]+a[12]*a[1]*a[7]-a[12]*a[3]*a[5];b[14]=-(a[0]*a[5]*a[14])+a[0]*a[6]*a[13]+a[4]*a[1]*
a[14]-a[4]*a[2]*a[13]-a[12]*a[1]*a[6]+a[12]*a[2]*a[5];b[3]=-(a[1]*a[6]*a[11])+a[1]*a[7]*a[10]+a[5]*a[2]*a[11]-a[5]*a[3]*a[10]-a[9]*a[2]*a[7]+a[9]*a[3]*a[6];b[7]=a[0]*a[6]*a[11]-a[0]*a[7]*a[10]-a[4]*a[2]*a[11]+a[4]*a[3]*a[10]+a[8]*a[2]*a[7]-a[8]*a[3]*a[6];b[11]=-(a[0]*a[5]*a[11])+a[0]*a[7]*a[9]+a[4]*a[1]*a[11]-a[4]*a[3]*a[9]-a[8]*a[1]*a[7]+a[8]*a[3]*a[5];b[15]=a[0]*a[5]*a[10]-a[0]*a[6]*a[9]-a[4]*a[1]*a[10]+a[4]*a[2]*a[9]+a[8]*a[1]*a[6]-a[8]*a[2]*a[5];var d=a[0]*b[0]+a[1]*b[4]+a[2]*b[8]+a[3]*b[12];
if(0==d)return!1;for(var d=1/d,f=0;16>f;f++)a[f]=b[f]*d;return!0},MO.SMatrix4x4_transform=function(a,b,d,f,h){for(var k=this._data,q=0;q<h;q++){var w=d[f++],x=d[f++],y=d[f++];a[b++]=w*k[0]+x*k[4]+y*k[8]+k[12];a[b++]=w*k[1]+x*k[5]+y*k[9]+k[13];a[b++]=w*k[2]+x*k[6]+y*k[10]+k[14]}},MO.SMatrix4x4_transformPoint3=function(a,b){var d=this._data,f=a.x*d[0]+a.y*d[4]+a.z*d[8]+d[12],h=a.x*d[1]+a.y*d[5]+a.z*d[9]+d[13],d=a.x*d[2]+a.y*d[6]+a.z*d[10]+d[14],k=null,k=b?b:new SPoint3;k.set(f,h,d);return k},MO.SMatrix4x4_build=
function(a,b,d){var f=this._data,h=b.x*b.x,k=b.y*b.y,q=b.z*b.z,w=b.x*b.y,x=b.x*b.z,y=b.y*b.z,z=b.w*b.x,A=b.w*b.y;b=b.w*b.z;f[0]=(1-2*(k+q))*d.x;f[1]=2*(w-b)*d.x;f[2]=2*(x+A)*d.x;f[3]=0;f[4]=2*(w+b)*d.y;f[5]=(1-2*(h+q))*d.y;f[6]=2*(y-z)*d.y;f[7]=0;f[8]=2*(x-A)*d.z;f[9]=2*(y+z)*d.z;f[10]=(1-2*(h+k))*d.z;f[11]=0;f[12]=a.x;f[13]=a.y;f[14]=a.z;f[15]=1},MO.SMatrix4x4_buildQuaternion=function(a){var b=this._data,d=a.x*a.x,f=a.y*a.y,h=a.z*a.z,k=a.x*a.y,q=a.x*a.z,w=a.y*a.z,x=a.w*a.x,y=a.w*a.y;a=a.w*a.z;b[0]=
1-2*(f+h);b[1]=2*(k-a);b[2]=2*(q+y);b[3]=0;b[4]=2*(k+a);b[5]=1-2*(d+h);b[6]=2*(w-x);b[7]=0;b[8]=2*(q-y);b[9]=2*(w+x);b[10]=1-2*(d+f);b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1},MO.SMatrix4x4_writeData=function(a,b){var d=this._data;a[b++]=d[0];a[b++]=d[4];a[b++]=d[8];a[b++]=d[12];a[b++]=d[1];a[b++]=d[5];a[b++]=d[9];a[b++]=d[13];a[b++]=d[2];a[b++]=d[6];a[b++]=d[10];a[b++]=d[14];a[b++]=d[3];a[b++]=d[7];a[b++]=d[11];a[b++]=d[15]},MO.SMatrix4x4_writeData4x3=function(a,b){var d=this._data;a[b++]=d[0];a[b++]=
d[4];a[b++]=d[8];a[b++]=d[12];a[b++]=d[1];a[b++]=d[5];a[b++]=d[9];a[b++]=d[13];a[b++]=d[2];a[b++]=d[6];a[b++]=d[10];a[b++]=d[14]},MO.SMatrix4x4_toString=function(){for(var a=this._data,b=new TString,d=0;4>d;d++){0<d&&b.append("|");for(var f=0;4>f;f++){var h=a[4*d+f];0<f&&b.append(",");b.append(RFloat.format(h,0,null,3,null))}}return b.flush()};
with(MO)MO.SOrthoMatrix3d=function(){SMatrix3d.call(this);this.perspectiveLH=SOrthoMatrix3d_perspectiveLH;this.perspectiveRH=SOrthoMatrix3d_perspectiveRH;this.perspectiveFieldOfViewLH=SOrthoMatrix3d_perspectiveFieldOfViewLH;this.perspectiveFieldOfViewRH=SOrthoMatrix3d_perspectiveFieldOfViewRH;return this},MO.SOrthoMatrix3d_perspectiveLH=function(a,b,d,f){var h=this._data;h[0]=2*d/a;h[1]=0;h[2]=0;h[3]=0;h[4]=0;h[5]=2*d/b;h[6]=0;h[7]=0;h[8]=0;h[9]=0;h[10]=f/(f-d);h[11]=1;h[12]=0;h[13]=0;h[14]=d*f/(d-
f);h[15]=0},MO.SOrthoMatrix3d_perspectiveRH=function(a,b,d,f){var h=this._data;h[0]=2*d/a;h[1]=0;h[2]=0;h[3]=0;h[4]=0;h[5]=2*d/b;h[6]=0;h[7]=0;h[8]=0;h[9]=0;h[10]=f/(d-f);h[11]=1;h[12]=0;h[13]=0;h[14]=d*f/(d-f);h[15]=0},MO.SOrthoMatrix3d_perspectiveFieldOfViewLH=function(a,b,d,f){var h=this._data;a=1/Math.tan(.5*a);h[0]=a/b;h[1]=0;h[2]=0;h[3]=0;h[4]=0;h[5]=a;h[6]=0;h[7]=0;h[8]=0;h[9]=0;h[10]=f/(f-d);h[11]=1;h[12]=0;h[13]=0;h[14]=d*f/(d-f);h[15]=0},MO.SOrthoMatrix3d_perspectiveFieldOfViewRH=function(a,
b,d,f){var h=this._data;a=1/Math.tan(.5*a);h[0]=a/b;h[1]=0;h[2]=0;h[3]=0;h[4]=0;h[5]=a;h[6]=0;h[7]=0;h[8]=0;h[9]=0;h[10]=f/(d-f);h[11]=1;h[12]=0;h[13]=0;h[14]=d*f/(f-d);h[15]=0};
with(MO)MO.SOutline3=function(){this.min=new SPoint3;this.max=new SPoint3;this.isEmpty=SOutline3_isEmpty;this.assign=SOutline3_assign;this.setMin=SOutline3_setMin;this.setMax=SOutline3_setMax;this.set=SOutline3_set;this.mergeMin=SOutline3_mergeMin;this.mergeMax=SOutline3_mergeMax;this.mergePoint=SOutline3_mergePoint;this.serialize=SOutline3_serialize;this.unserialize=SOutline3_unserialize;this.toString=SOutline3_toString;return this},MO.SOutline3_isEmpty=function(a){return this.min.isEmpty()&&this.max.isEmpty()},
MO.SOutline3_assign=function(a){this.min.assign(a.min);this.max.assign(a.max)},MO.SOutline3_setMin=function(){this.min.setMax();this.max.setMin()},MO.SOutline3_setMax=function(){this.min.setMin();this.max.setMax()},MO.SOutline3_set=function(a,b,d,f,h,k){this.min.set(a,b,d);this.max.set(f,h,k)},MO.SOutline3_mergeMin=function(a){this.min.mergeMax(a.min);this.max.mergeMin(a.max)},MO.SOutline3_mergeMax=function(a){this.min.mergeMin(a.min);this.max.mergeMax(a.max)},MO.SOutline3_mergePoint=function(a,b,
d){this.min.mergeMin3(a,b,d);this.max.mergeMax3(a,b,d)},MO.SOutline3_serialize=function(a){this.min.serialize(a);this.max.serialize(a)},MO.SOutline3_unserialize=function(a){this.min.unserialize(a);this.max.unserialize(a)},MO.SOutline3_toString=function(){return"("+this.min+")-("+this.max+")"};
with(MO)MO.SOutline3d=function(){SOutline3.call(this);this.center=new SPoint3;this.distance=new SPoint3;this.radius=0;this.points=Array(24);this.update=SOutline3d_update;this.calculateFrom=SOutline3d_calculateFrom;this.calculate=SOutline3d_calculate;return this},MO.SOutline3d_update=function(){var a=this.min,b=a.x,d=a.y,a=a.z,f=this.max,h=f.x,k=f.y,f=f.z,q=this.points;q[0]=b;q[1]=k;q[2]=a;q[3]=h;q[4]=k;q[5]=a;q[6]=h;q[7]=d;q[8]=a;q[9]=b;q[10]=d;q[11]=a;q[12]=b;q[13]=k;q[14]=f;q[15]=h;q[16]=k;q[17]=
f;q[18]=h;q[19]=d;q[20]=f;q[21]=b;q[22]=d;q[23]=f;q=this.center;q.x=.5*(b+h);q.y=.5*(d+k);q.z=.5*(a+f);q=this.distance;q.x=h-b;q.y=k-d;q.z=f-a;b=h-b;d=k-d;a=f-a;this.radius=.5*Math.sqrt(b*b+d*d+a*a)},MO.SOutline3d_calculateFrom=function(a,b){var d=this.points;b.transform(d,0,a.points,0,8);for(var f=minY=minZ=Number.MAX_VALUE,h=maxY=maxZ=-Number.MAX_VALUE,k=0;24>k;){var q=d[k++];q<f&&(f=q);q>h&&(h=q);q=d[k++];q<minY&&(minY=q);q>maxY&&(maxY=q);q=d[k++];q<minZ&&(minZ=q);q>maxZ&&(maxZ=q)}this.min.set(f,
minY,minZ);this.max.set(h,maxY,maxZ);this.update()},MO.SOutline3d_calculate=function(a){a=viy=viz=Number.MAX_VALUE;for(var b=vay=vaz=-Number.MAX_VALUE,d=0,f=this.points;24>d;){var h=f[d++];h<a&&(a=h);h>b&&(b=h);h=f[d++];h<viy&&(viy=h);h>vay&&(vay=h);h=f[d++];h<viz&&(viz=h);h>vaz&&(vaz=h)}this.min.set(a,viy,viz);this.max.set(b,vay,vaz);this.center.x=.5*(a+b);this.center.y=.5*(viy+vay);this.center.z=.5*(viz+vaz);a=b-a;b=vay-viy;d=vaz-viz;this.radius=.5*Math.sqrt(a*a+b*b+d*d)};
with(MO)MO.SPadding=function(a,b,d,f){this.left=RInteger.nvl(a);this.top=RInteger.nvl(b);this.right=RInteger.nvl(d);this.bottom=RInteger.nvl(f);this.isEmpty=SPadding_isEmpty;this.reset=SPadding_reset;this.assign=SPadding_assign;this.set=SPadding_set;this.parse=SPadding_parse;this.toString=SPadding_toString;this.dispose=SPadding_dispose;this.dump=SPadding_dump;return this},MO.SPadding_isEmpty=function(){return 0==this.left&&0==this.top&&0==this.right&&0==this.bottom},MO.SPadding_reset=function(){this.bottom=
this.right=this.top=this.left=0},MO.SPadding_assign=function(a){this.left=a.left;this.top=a.top;this.right=a.right;this.bottom=a.bottom},MO.SPadding_set=function(a,b,d,f){this.left=a;this.top=b;this.right=d;this.bottom=f},MO.SPadding_parse=function(a){var b=a.split(",");if(4==b.length)this.left=parseInt(b[0]),this.top=parseInt(b[1]),this.right=parseInt(b[2]),this.bottom=parseInt(b[3]);else throw new TError(this,"Parse value failure. (value={1})",a);},MO.SPadding_toString=function(){return this.left+
","+this.top+","+this.right+","+this.bottom},MO.SPadding_dispose=function(){this.bottom=this.right=this.top=this.left=null},MO.SPadding_dump=function(a){return RClass.dump(this)+" ["+this.left+","+this.top+","+this.right+","+this.bottom+"]"};
with(MO)MO.SPerspectiveMatrix3d=function(){SMatrix3d.call(this);this.perspectiveLH=SPerspectiveMatrix3d_perspectiveLH;this.perspectiveRH=SPerspectiveMatrix3d_perspectiveRH;this.perspectiveFieldOfViewLH=SPerspectiveMatrix3d_perspectiveFieldOfViewLH;this.perspectiveFieldOfViewRH=SPerspectiveMatrix3d_perspectiveFieldOfViewRH;return this},MO.SPerspectiveMatrix3d_perspectiveLH=function(a,b,d,f){var h=this._data;h[0]=2*d/a;h[1]=0;h[2]=0;h[3]=0;h[4]=0;h[5]=2*d/b;h[6]=0;h[7]=0;h[8]=0;h[9]=0;h[10]=f/(f-d);
h[11]=1;h[12]=0;h[13]=0;h[14]=d*f/(d-f);h[15]=0},MO.SPerspectiveMatrix3d_perspectiveRH=function(a,b,d,f){var h=this._data;h[0]=2*d/a;h[1]=0;h[2]=0;h[3]=0;h[4]=0;h[5]=2*d/b;h[6]=0;h[7]=0;h[8]=0;h[9]=0;h[10]=f/(d-f);h[11]=1;h[12]=0;h[13]=0;h[14]=d*f/(d-f);h[15]=0},MO.SPerspectiveMatrix3d_perspectiveFieldOfViewLH=function(a,b,d,f){var h=this._data;a=1/Math.tan(.5*a);h[0]=a/b;h[1]=0;h[2]=0;h[3]=0;h[4]=0;h[5]=a;h[6]=0;h[7]=0;h[8]=0;h[9]=0;h[10]=f/(f-d);h[11]=1;h[12]=0;h[13]=0;h[14]=d*f/(d-f);h[15]=0},
MO.SPerspectiveMatrix3d_perspectiveFieldOfViewRH=function(a,b,d,f){var h=this._data;a=1/Math.tan(.5*a);h[0]=a/b;h[1]=0;h[2]=0;h[3]=0;h[4]=0;h[5]=a;h[6]=0;h[7]=0;h[8]=0;h[9]=0;h[10]=f/(d-f);h[11]=1;h[12]=0;h[13]=0;h[14]=d*f/(f-d);h[15]=0};
with(MO)MO.SPlane=function(){this.d=this.c=this.b=this.a=0;this.assign=SPlane_assign;this.set=SPlane_set;this.normalize=SPlane_normalize;this.dot=SPlane_dot;this.toString=SPlane_toString;this.dump=SPlane_dump;return this},MO.SPlane_assign=function(a){this.a=a.a;this.b=a.b;this.c=a.c;this.d=a.d},MO.SPlane_set=function(a,b,d,f){this.a=a;this.b=b;this.c=d;this.d=f},MO.SPlane_normalize=function(){var a=1/Math.sqrt(this.a*this.a+this.b*this.b+this.c*this.c);this.a*=a;this.b*=a;this.c*=a;this.d*=a},MO.SPlane_dot=
function(a,b,d){return a*this.a+b*this.b+d*this.c+this.d},MO.SPlane_toString=function(){return this.a+","+this.b+","+this.c+","+this.d},MO.SPlane_dump=function(){return RClass.dump(this)+" ["+this.toString()+"]"};
with(MO)MO.SPoint2=function(a,b){this.x=RInteger.nvl(a);this.y=RInteger.nvl(b);this.isEmpty=SPoint2_isEmpty;this.equals=SPoint2_equals;this.assign=SPoint2_assign;this.set=SPoint2_set;this.serialize=SPoint2_serialize;this.unserialize=SPoint2_unserialize;this.toString=SPoint2_toString;this.dispose=SPoint2_dispose;this.dump=SPoint2_dump;return this},MO.SPoint2_isEmpty=function(){return 0==this.x&&0==this.y},MO.SPoint2_equals=function(a){return a?this.x==a.x&&this.y==a.y:!1},MO.SPoint2_assign=function(a){this.x=
a.x;this.y=a.y},MO.SPoint2_set=function(a,b){this.x=a;this.y=b},MO.SPoint2_serialize=function(a){a.writeFloat(this.x);a.writeFloat(this.y)},MO.SPoint2_unserialize=function(a){this.x=a.readFloat();this.y=a.readFloat()},MO.SPoint2_toString=function(){return this.x+","+this.y},MO.SPoint2_dispose=function(){this.y=this.x=null},MO.SPoint2_dump=function(){return RClass.dump(this)+" ["+this.x+","+this.y+"]"};
with(MO)MO.SPoint3=function(a,b,d){SValue3.call(this,a,b,d);this.conjugate=SPoint3_conjugate;this.mergeMin=SPoint3_mergeMin;this.mergeMin3=SPoint3_mergeMin3;this.mergeMax=SPoint3_mergeMax;this.mergeMax3=SPoint3_mergeMax3;this.resize=SPoint3_resize;this.slerp=SPoint3_slerp;return this},MO.SPoint3_conjugate=function(a){var b=null,b=a?a:new SPoint3;b.x=-this.x;b.y=-this.y;b.z=-this.z;return b},MO.SPoint3_mergeMin=function(a){this.x=Math.min(this.x,a.x);this.y=Math.min(this.y,a.y);this.z=Math.min(this.z,
a.z)},MO.SPoint3_mergeMin3=function(a,b,d){this.x=Math.min(this.x,a);this.y=Math.min(this.y,b);this.z=Math.min(this.z,d)},MO.SPoint3_mergeMax=function(a){this.x=Math.max(this.x,a.x);this.y=Math.max(this.y,a.y);this.z=Math.max(this.z,a.z)},MO.SPoint3_mergeMax3=function(a,b,d){this.x=Math.max(this.x,a);this.y=Math.max(this.y,b);this.z=Math.max(this.z,d)},MO.SPoint3_resize=function(a,b,d){null!=a&&(this.x+=a);null!=b&&(this.y+=b);null!=d&&(this.z+=d)},MO.SPoint3_slerp=function(a,b,d){this.x=(b.x-a.x)*
d+a.x;this.y=(b.y-a.y)*d+a.y;this.z=(b.z-a.z)*d+a.z};with(MO)MO.SPoint4=function(a,b,d,f){SValue4.call(this,a,b,d,f);this.serialize3=SPoint4_serialize3;this.unserialize3=SPoint4_unserialize3;return this},MO.SPoint4_serialize3=function(a){a.writeFloat(this.x);a.writeFloat(this.y);a.writeFloat(this.z)},MO.SPoint4_unserialize3=function(a){this.x=a.readFloat();this.y=a.readFloat();this.z=a.readFloat()};
with(MO)MO.SQuaternion=function(a){a||(a=this);a.x=0;a.y=0;a.z=0;a.w=1;a.identity=SQuaternion_identity;a.assign=SQuaternion_assign;a.set=SQuaternion_set;a.absolute=SQuaternion_absolute;a.normalize=SQuaternion_normalize;a.conjugate=SQuaternion_conjugate;a.mul=SQuaternion_mul;a.mul2=SQuaternion_mul2;a.translate=SQuaternion_translate;a.slerp=SQuaternion_slerp;a.fromAxisAngle=SQuaternion_fromAxisAngle;a.fromEuler=SQuaternion_fromEuler;a.parseEuler=SQuaternion_parseEuler;a.serialize=SQuaternion_serialize;
a.unserialize=SQuaternion_unserialize;a.clone=SQuaternion_clone;a.toString=SQuaternion_toString;return a},MO.SQuaternion_identity=function(){this.x=this.y=this.z=0;this.w=1;return this},MO.SQuaternion_assign=function(a){this.x=a.x;this.y=a.y;this.z=a.z;this.w=a.w},MO.SQuaternion_set=function(a,b,d,f){this.x=a;this.y=b;this.z=d;this.w=f},MO.SQuaternion_absolute=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},MO.SQuaternion_normalize=function(){var a=this.absolute();
0!=a&&(a=1/a,this.x*=a,this.y*=a,this.z*=a,this.w*=a)},MO.SQuaternion_conjugate=function(a){var b=null,b=a?a:new SQuaternion;b.x=-this.x;b.y=-this.y;b.z=-this.z;b.w=this.w;return b},MO.SQuaternion_mul=function(a){var b=this.x,d=this.y,f=this.z,h=this.w;this.x=h*a.x+b*a.w+d*a.z-f*a.y;this.y=h*a.y+d*a.w+f*a.x-b*a.z;this.z=h*a.z+f*a.w+b*a.y-d*a.x;this.w=h*a.w-b*a.x-d*a.y-f*a.z},MO.SQuaternion_mul2=function(a,b){this.x=a.w*b.x+a.x*b.w+a.y*b.z-a.z*b.y;this.y=a.w*b.y+a.y*b.w+a.z*b.x-a.x*b.z;this.z=a.w*
b.z+a.z*b.w+a.x*b.y-a.y*b.x;this.w=a.w*b.w-a.x*b.x-a.y*b.y-a.z*b.z},MO.SQuaternion_translate=function(a,b){var d=new SQuaternion;d.set(a.x,a.y,a.z,0);d.normalize();var f=this.conjugate();d.mul(f);f=this.clone();f.mul(d);d=null;d=b?b:new SVector3;d.set(f.x,f.y,f.z);return d},MO.SQuaternion_slerp=function(a,b,d){var f=a.x*b.x+a.y*b.y+a.z*b.z+a.w*b.w,h=!1;0>f&&(h=!0,f=-f);var k=0,q=0;.999999<f?(k=1-d,q=h?-d:d):(f=Math.acos(f),q=1/Math.sin(f),k=Math.sin((1-d)*f)*q,q=h?-Math.sin(d*f)*q:Math.sin(d*f)*q);
this.x=k*a.x+q*b.x;this.y=k*a.y+q*b.y;this.z=k*a.z+q*b.z;this.w=k*a.w+q*b.w},MO.SQuaternion_fromAxisAngle=function(a,b){var d=.5*b,f=Math.sin(d);this.x=a.x*f;this.y=a.y*f;this.z=a.z*f;this.w=Math.cos(d)},MO.SQuaternion_fromEuler=function(a,b,d){var f=Math.sin(.5*d);d=Math.cos(.5*d);var h=Math.sin(.5*a);a=Math.cos(.5*a);var k=Math.sin(.5*b);b=Math.cos(.5*b);this.x=d*h*b+f*a*k;this.y=d*a*k-f*h*b;this.z=f*a*b-d*h*k;this.w=d*a*b+f*h*k},MO.SQuaternion_parseEuler=function(a){var b=this.x*this.x,d=this.y*
this.y,f=this.z*this.z,h=null,h=a?a:new SVector3;h.x=Math.asin(RFloat.toRange(2*(this.w*this.x-this.y*this.z),-1,1));h.y=Math.atan2(2*(this.w*this.y+this.z*this.x),1-2*(b+d));h.z=Math.atan2(2*(this.w*this.z+this.x*this.y),1-2*(f+b));return h},MO.SQuaternion_serialize=function(a){a.writeFloat(this.x);a.writeFloat(this.y);a.writeFloat(this.z);a.writeFloat(this.w)},MO.SQuaternion_unserialize=function(a){this.x=a.readFloat();this.y=a.readFloat();this.z=a.readFloat();this.w=a.readFloat()},MO.SQuaternion_clone=
function(){var a=new SQuaternion;a.x=this.x;a.y=this.y;a.z=this.z;a.w=this.w;return a},MO.SQuaternion_toString=function(){return this.x+","+this.y+","+this.z+","+this.w};
with(MO)MO.SRange=function(a,b,d,f){this.x=a;this.y=b;this.width=d;this.height=f;this.dump=SRange_dump;return this},MO.SRange_reset=function(){this.bottom=this.right=this.top=this.left=0},MO.SRange_assign=function(a){this.left=a.left;this.top=a.top;this.right=a.right;this.bottom=a.bottom},MO.SRange_set=function(a,b,d,f){this.left=a;this.top=b;this.right=d;this.bottom=f},MO.SRange_setBounds=function(a,b,d,f){this.left=a;this.top=b;this.right=this.left+d-1;this.bottom=this.top+f-1},MO.SRange_width=
function(){return this.right-this.left+1},MO.SRange_setWidth=function(a){a&&(this.right=this.left+a-1)},MO.SRange_height=function(){return this.bottom-this.top+1},MO.SRange_setHeight=function(a){a&&(this.bottom=this.top+a-1)},MO.SRange_move=function(a,b){this.left+=a;this.top+=b;this.right+=a;this.bottom+=b},MO.SRange_inc=function(a){a=RInt.nvl(a,1);this.left-=a;this.top-=a;this.right+=a;this.bottom+=a},MO.SRange_dec=function(a){a=RInt.nvl(a,1);this.left+=a;this.top+=a;this.right-=a;this.bottom-=
a},MO.SRange_dump=function(a){a=RString.nvlStr(a);a.append(RClass.name(this));a.append(" [",this.x,",",this.y,"-",this.width,",",this.height,"] ");return a};
with(MO)MO.SRectangle=function(){this.position=new SPoint2;this.size=new SSize2;this.left=SRectangle_left;this.top=SRectangle_top;this.right=SRectangle_right;this.bottom=SRectangle_bottom;this.width=SRectangle_width;this.height=SRectangle_height;this.assign=SRectangle_assign;this.setPosition=SRectangle_setPosition;this.setSize=SRectangle_setSize;this.set=SRectangle_set;this.toString=SRectangle_toString;this.dispose=SRectangle_dispose;this.dump=SRectangle_dump;return this},MO.SRectangle_left=function(){return this.position.x},
MO.SRectangle_top=function(){return this.position.y},MO.SRectangle_right=function(){return this.position.x+this.size.width},MO.SRectangle_bottom=function(){return this.position.y+this.size.height},MO.SRectangle_width=function(){return this.size.width},MO.SRectangle_height=function(){return this.size.height},MO.SRectangle_assign=function(a){this.position.assign(a.position);this.size.assign(a.size)},MO.SRectangle_setPosition=function(a,b,d,f){this.position.set(a,b)},MO.SRectangle_setSize=function(a,
b){this.size.set(a,b)},MO.SRectangle_set=function(a,b,d,f){this.position.set(a,b);this.size.set(d,f)},MO.SRectangle_toString=function(){return this.position.x+","+this.position.y+","+this.size.width+","+this.size.height},MO.SRectangle_dispose=function(){this.position=this.position.dispose();this.size=this.size.dispose()},MO.SRectangle_dump=function(){return RClass.dump(this)+" ["+this.position.x+","+this.position.y+"-"+this.size.width+","+this.size.height+"]"};
with(MO)MO.SSize2=function(a,b){this.width=RInteger.nvl(a);this.height=RInteger.nvl(b);this.isEmpty=SSize2_isEmpty;this.equalsData=SSize2_equalsData;this.equals=SSize2_equals;this.square=SSize2_square;this.assign=SSize2_assign;this.set=SSize2_set;this.serialize=SSize2_serialize;this.unserialize=SSize2_unserialize;this.parse=SSize2_parse;this.toString=SSize2_toString;this.dispose=SSize2_dispose;this.dump=SSize2_dump;return this},MO.SSize2_isEmpty=function(){return 0==this.width&&0==this.height},MO.SSize2_equalsData=
function(a,b){return this.width!=a||this.height!=b?!1:!0},MO.SSize2_equals=function(a){return this.width!=a.width||this.height!=a.height?!1:!0},MO.SSize2_square=function(){return this.width*this.height},MO.SSize2_assign=function(a){this.width=a.width;this.height=a.height},MO.SSize2_set=function(a,b){this.width=a;this.height=b},MO.SSize2_serialize=function(a){a.writeFloat(this.width);a.writeFloat(this.height)},MO.SSize2_unserialize=function(a,b){b||(b=EDataType.Float16);this.width=a.readData(b);this.height=
a.readData(b)},MO.SSize2_parse=function(a){var b=a.split(",");if(2==b.length)this.width=parseInt(b[0]),this.height=parseInt(b[1]);else throw new TError(this,"Parse value failure. (value={1})",a);},MO.SSize2_toString=function(){return this.width+","+this.height},MO.SSize2_dispose=function(){this.height=this.width=null},MO.SSize2_dump=function(){return RClass.dump(this)+" ["+this.width+","+this.height+"]"};
with(MO)MO.SSize3=function(a,b,d){this.width=RInteger.nvl(a);this.height=RInteger.nvl(b);this.deep=RInteger.nvl(d);this.assign=SSize3_assign;this.set=SSize3_set;this.parse=SSize3_parse;this.toString=SSize3_toString;this.dump=SSize3_dump;return this},MO.SSize3_assign=function(a){this.width=a.width;this.height=a.height;this.deep=a.deep},MO.SSize3_set=function(a,b,d){this.width=a;this.height=b;this.deep=d},MO.SSize3_parse=function(a){var b=a.split(",");if(3==b.length)this.width=parseInt(b[0]),this.height=
parseInt(b[1]),this.deep=parseInt(b[2]);else throw new TError(this,"Parse value failure. (value={1})",a);},MO.SSize3_toString=function(){return this.width+","+this.height+","+this.deep},MO.SSize3_dump=function(){return RClass.dump(this)+" ["+this.width+","+this.height+","+this.deep+"]"};
with(MO)MO.SSquare=function(a,b,d,f){this.left=RInteger.nvl(left);this.top=RInteger.nvl(top);this.right=RInteger.nvl(right);this.bottom=RInteger.nvl(bottom);this.reset=SSquare_reset;this.assign=SSquare_assign;this.set=SSquare_set;this.setBounds=SSquare_setBounds;this.width=SSquare_width;this.setWidth=SSquare_setWidth;this.height=SSquare_height;this.setHeight=SSquare_setHeight;this.move=SSquare_move;this.inc=SSquare_inc;this.dec=SSquare_dec;this.dump=this.unpack=this.pack=SSquare_dump;return this},
MO.SSquare_reset=function(){this.bottom=this.right=this.top=this.left=0},MO.SSquare_assign=function(a){this.left=a.left;this.top=a.top;this.right=a.right;this.bottom=a.bottom},MO.SSquare_set=function(a,b,d,f){this.left=a;this.top=b;this.right=d;this.bottom=f},MO.SSquare_setBounds=function(a,b,d,f){this.left=a;this.top=b;this.right=this.left+d-1;this.bottom=this.top+f-1},MO.SSquare_width=function(){return this.right-this.left+1},MO.SSquare_setWidth=function(a){a&&(this.right=this.left+a-1)},MO.SSquare_height=
function(){return this.bottom-this.top+1},MO.SSquare_setHeight=function(a){a&&(this.bottom=this.top+a-1)},MO.SSquare_move=function(a,b){this.left+=a;this.top+=b;this.right+=a;this.bottom+=b},MO.SSquare_inc=function(a){a=RInt.nvl(a,1);this.left-=a;this.top-=a;this.right+=a;this.bottom+=a},MO.SSquare_dec=function(a){a=RInt.nvl(a,1);this.left+=a;this.top+=a;this.right-=a;this.bottom-=a},MO.SSquare_dump=function(a){a=RString.nvlStr(a);a.append(RClass.name(this));a.append(" [",this.left,",",this.top,"-",
this.right,",",this.bottom,"] ");a.append("(",this.width(),"-",this.height(),")");return a};
with(MO)MO.SValue3=function(a,b,d){this.x=RRuntime.nvl(a,0);this.y=RRuntime.nvl(b,0);this.z=RRuntime.nvl(d,0);this.isEmpty=SValue3_isEmpty;this.assign=SValue3_assign;this.setMin=SValue3_setMin;this.setMax=SValue3_setMax;this.set=SValue3_set;this.absolute=SValue3_absolute;this.normalize=SValue3_normalize;this.negative=SValue3_negative;this.serialize=SValue3_serialize;this.unserialize=SValue3_unserialize;this.parse=SValue3_parse;this.toString=SValue3_toString;return this},MO.SValue3_isEmpty=function(a){return 0==
this.x&&0==this.y&&0==this.z},MO.SValue3_assign=function(a){this.x=a.x;this.y=a.y;this.z=a.z},MO.SValue3_setMin=function(){this.z=this.y=this.x=Number.MIN_VALUE},MO.SValue3_setMax=function(){this.z=this.y=this.x=Number.MAX_VALUE},MO.SValue3_set=function(a,b,d){this.x=a;this.y=b;this.z=d},MO.SValue3_normalize=function(){var a=this.absolute();0!=a&&(a=1/a,this.x*=a,this.y*=a,this.z*=a);return this},MO.SValue3_absolute=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},MO.SValue3_negative=
function(a){var b=null,b=p?a:new this.constructor;b.x=-this.x;b.y=-this.y;b.z=-this.z;return b},MO.SValue3_serialize=function(a){a.writeFloat(this.x);a.writeFloat(this.y);a.writeFloat(this.z)},MO.SValue3_unserialize=function(a){this.x=a.readFloat();this.y=a.readFloat();this.z=a.readFloat()},MO.SValue3_parse=function(a){var b=a.split(",");if(3==b.length)this.x=parseFloat(b[0]),this.y=parseFloat(b[1]),this.z=parseFloat(b[2]);else throw new TError(o,"Parse value failure. (value={1})",a);},MO.SValue3_toString=
function(){return this.x+","+this.y+","+this.z};
with(MO)MO.SValue3=function(a,b,d,f){this.x=RRuntime.nvl(a,0);this.y=RRuntime.nvl(b,0);this.z=RRuntime.nvl(d,0);this.w=RRuntime.nvl(f,1);this.assign=SValue4_assign;this.set=SValue4_set;this.absolute=SValue4_absolute;this.normalize=SValue4_normalize;this.negative=SValue4_negative;this.serialize=SValue4_serialize;this.unserialize=SValue4_unserialize;this.parse=SValue4_parse;this.toString=SValue4_toString;return this},MO.SValue4_assign=function(a){this.x=a.x;this.y=a.y;this.z=a.z;this.w=a.w},MO.SValue4_set=
function(a,b,d,f){this.x=a;this.y=b;this.z=d;this.w=f},MO.SValue4_absolute=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},MO.SValue4_normalize=function(){var a=this.absolute();0!=a&&(a=1/a,this.x*=a,this.y*=a,this.z*=a,this.w*=a)},MO.SValue4_negative=function(a){var b=null,b=a?a:new this.constructor;b.x=-this.x;b.y=-this.y;b.z=-this.z;b.w=-this.w;return b},MO.SValue4_serialize=function(a){a.writeFloat(this.x);a.writeFloat(this.y);a.writeFloat(this.z);a.writeFloat(this.w)},
MO.SValue4_unserialize=function(a){this.x=a.readFloat();this.y=a.readFloat();this.z=a.readFloat();this.w=a.readFloat()},MO.SValue4_parse=function(a){var b=a.split(",");if(4==b.length)this.x=parseFloat(b[0]),this.y=parseFloat(b[1]),this.z=parseFloat(b[2]),this.w=parseFloat(b[3]);else throw new TError(o,"Parse value failure. (value={1})",a);},MO.SValue4_toString=function(){return this.x+","+this.y+","+this.z+","+this.w};
with(MO)MO.SVector3=function(a,b,d){SValue3.call(this,a,b,d);this.length=this.absolute;this.direction=SVector3_direction;this.conjugate=SVector3_conjugate;this.dotPoint3=SVector3_dotPoint3;this.cross=SVector3_cross;this.cross2=SVector3_cross2;this.slerp=SVector3_slerp;this.clone=SVector3_clone;return this},MO.SVector3_direction=function(a,b){this.x=b.x-a.x;this.y=b.y-a.y;this.z=b.z-a.z;return this},MO.SVector3_conjugate=function(a){var b=null,b=a?a:new SVector3;b.x=-this.x;b.y=-this.y;b.z=-this.z;
return b},MO.SVector3_dotPoint3=function(a){return this.x*a.x+this.y*a.y+this.z*a.z},MO.SVector3_cross=function(a){var b=this.z*a.x-this.x*a.z,d=this.x*a.y-this.y*a.x;this.x=this.y*a.z-this.z*a.y;this.y=b;this.z=d},MO.SVector3_cross2=function(a,b){a.x=this.y*b.z-this.z*b.y;a.y=this.z*b.x-this.x*b.z;a.z=this.x*b.y-this.y*b.x},MO.SVector3_slerp=function(a,b,d){this.x=(b.x-a.x)*d+a.x;this.y=(b.y-a.y)*d+a.y;this.z=(b.z-a.z)*d+a.z},MO.SVector3_clone=function(){var a=new SVector3;a.x=this.x;a.y=this.y;
a.z=this.z;return a};with(MO)MO.SVector4=function(a,b,d,f){SValue4.call(this,a,b,d,f);this.serialize3=SVector4_serialize3;this.unserialize3=SVector4_unserialize3;return this},MO.SVector4_serialize3=function(a){a.writeFloat(this.x);a.writeFloat(this.y);a.writeFloat(this.z)},MO.SVector4_unserialize3=function(a){this.x=a.readFloat();this.y=a.readFloat();this.z=a.readFloat()};
with(MO)MO.RMath=function(){this.value1=Array(1);this.value2=Array(2);this.value3=Array(3);this.value4=Array(4);this.value9=Array(9);this.value12=Array(12);this.value16=Array(16);this.matrix=this.rectangle=this.vector3=this.vectorBackward=this.vectorForward=this.vectorScale=this.vectorAxisZ=this.vectorAxisY=this.vectorAxisX=null;this.construct=RMath_construct;this.min=RMath_min;this.max=RMath_max;this.sign=RMath_sign;this.construct();return this},MO.RMath_construct=function(){this.vectorAxisX=new MO.SVector3(1,
0,0);this.vectorAxisY=new MO.SVector3(0,1,0);this.vectorAxisZ=new MO.SVector3(0,0,1);this.vectorScale=new MO.SVector3(1,1,1);this.vectorForward=new MO.SVector3(0,0,1);this.vectorBackward=new MO.SVector3(0,0,-1);this.vector3=new MO.SVector3;this.rectangle=new MO.SRectangle;this.matrix=new MO.SMatrix3d},MO.RMath_min=function(){var a=0,b=arguments.length;if(1<b)for(var a=Number.MAX_VALUE,d=0;d<b;d++){var f=arguments[d];f<a&&(a=f)}return a},MO.RMath_max=function(){var a=0,b=arguments.length;if(1<b)for(var a=
Number.MIN_VALUE,d=0;d<b;d++){var f=arguments[d];f>a&&(a=f)}return a},MO.RMath_sign=function(a){return 0<a?1:0>a?-1:0},MO.RMath=new RMath;with(MO)MO.RRandom=function(){this._seed=(new Date).getTime();this.get=RRandom_get;this.rand=RRandom_rand;return this},MO.RRandom_get=function(){this._seed=(9301*this._seed+49297)%233280;return this._seed/233280},MO.RRandom_rand=function(a){a*=this.get();return Math.ceil(a)},MO.RRandom=new RRandom;
with(MO)MO.AStyle=function(a,b){AAnnotation.call(this,a);this._annotationCd=EAnnotation.Style;this._duplicate=!0;this._style=b;this.code=AStyle_code;this.style=AStyle_style;this.build=AStyle_build;this.toString=AStyle_toString;if(null==b){var d=null;RString.startsWith(a,"_style")?d=a.substring(6):RString.startsWith(a,"style")&&(d=a.substring(5));if(null==d)throw new TError("Style name is empty.");this._style=d}return this},MO.AStyle_code=function(){return this._style},MO.AStyle_style=function(){return this._style},
MO.AStyle_build=function(a){a[this._name]=null},MO.AStyle_toString=function(){return"style="+this._style};
with(MO)MO.AStyleIcon=function(a,b){AAnnotation.call(this,a);this._annotationCd=EAnnotation.Style;this._style=b;this.code=AStyleIcon_code;this.style=AStyleIcon_style;this.build=AStyleIcon_build;this.toString=AStyleIcon_toString;if(null==b){var d=null;RString.startsWith(a,"_style")?d=a.substring(6):RString.startsWith(a,"style")&&(d=a.substring(5));if(null==d)throw new TError("Style name is empty.");this._style=d}return this},MO.AStyleIcon_code=function(){return this._style},MO.AStyleIcon_style=function(){return this._style},
MO.AStyleIcon_build=function(a){a[this._name]=null},MO.AStyleIcon_toString=function(){return"style="+this._style};MO.EEvent=new function(){this.Unknown=0;this.Load=1;this.Process=2;this.EnterFrame=3;this.LeaveFrame=4;this.Enter=5;this.Leave=6;this.Focus=7;this.Blur=8;this.Click=9;this.DoubleClick=10;this.ItemClick=11;this.Selected=12;this.DataChanged=13;this.Result=14;this.TouchZoom="touch.zoom";return this};MO.EHttpContent=new function(){this.Binary=1;this.Text=2;return this};
MO.EHttpMethod=new function(){this.Get="GET";this.Post="POST";return this};MO.EHttpStatus=new function(){this.Uninitialized=0;this.Open=1;this.Send=2;this.Receiving=3;this.Loaded=4;return this};
MO.EKeyCode=new function(){this.None=0;this.Esc=27;this.Tab=9;this.Enter=13;this.Shift=16;this.Alt=18;this.Ctrl=17;this.BackSpace=8;this.Space=32;this.Left=37;this.Up=38;this.Right=39;this.Down=40;this.Insert=45;this.Delete=46;this.Home=36;this.End=35;this.PageUp=33;this.PageDown=34;this.F1=112;this.F2=113;this.F3=114;this.F4=115;this.F5=116;this.F6=117;this.F7=118;this.F8=119;this.F9=120;this.F10=121;this.F11=122;this.F12=123;this.N0=48;this.N1=49;this.N2=50;this.N3=51;this.N4=52;this.N5=53;this.N6=
54;this.N7=55;this.N8=56;this.N9=57;this.A=65;this.B=66;this.C=67;this.D=68;this.E=69;this.F=70;this.G=71;this.H=72;this.I=73;this.J=74;this.K=75;this.L=76;this.M=77;this.N=78;this.O=79;this.P=80;this.Q=81;this.R=82;this.S=83;this.T=84;this.U=85;this.V=86;this.W=87;this.X=88;this.Y=89;this.Z=90;this.ControlKeys=[this.Tab,this.Enter,this.BackSpace,this.Left,this.Up,this.Right,this.Down,this.Insert,this.Delete,this.Home,this.End,this.PageUp,this.PageDown,this.F1,this.F2,this.F3,this.F4,this.F5,this.F6,
this.F7,this.F8,this.F9,this.F10,this.F11,this.F12];var a=this.integerCodes={};a[45]=!0;a[190]=!0;for(var b=this.N0;b<=this.N9;b++)a[b]=!0;a=this.floatCodes={};a[45]=!0;a[190]=!0;a[46]=!0;a[189]=!0;for(b=this.N0;b<=this.N9;b++)a[b]=!0;return this};MO.EKeyStatus=new function(){this.Normal=0;this.Press=1;return this};MO.EMouseButton=new function(){this.Left=0;this.Right=2;this.Middle=3;return this};MO.EMouseCursor=new function(){this.HSize="E-resize";this.VSize="N-resize";return this};
MO.EOrientation=new function(){this.Unknown=0;this.Horizontal="H";this.Vertical="V";return this};with(MO)MO.MAttributeCode=function(a){a=RClass.inherits(this,a);a._code=null;a.isCode=MAttributeCode_isCode;a.code=MAttributeCode_code;a.setCode=MAttributeCode_setCode;return a},MO.MAttributeCode_isCode=function(a){return this._code==a},MO.MAttributeCode_code=function(){return this._code},MO.MAttributeCode_setCode=function(a){this._code=a};
with(MO)MO.MAttributeGuid=function(a){a=RClass.inherits(this,a);a._guid=null;a.guid=MAttributeGuid_guid;a.setGuid=MAttributeGuid_setGuid;return a},MO.MAttributeGuid_guid=function(){return this._guid},MO.MAttributeGuid_setGuid=function(a){this._guid=a};
with(MO)MO.MAttributeLabel=function(a){a=RClass.inherits(this,a);a._label=null;a.label=MAttributeLabel_label;a.setLabel=MAttributeLabel_setLabel;return a},MO.MAttributeLabel_label=function(){return this._label},MO.MAttributeLabel_setLabel=function(a){this._label=a};
with(MO)MO.MAttributeName=function(a){a=RClass.inherits(this,a);a._name=null;a.name=MAttributeName_name;a.setName=MAttributeName_setName;return a},MO.MAttributeName_name=function(){return this._name},MO.MAttributeName_setName=function(a){this._name=a};
with(MO)MO.MAttributeParent=function(a){a=RClass.inherits(this,a);a._parent=null;a.parent=MAttributeParent_parent;a.findParent=MAttributeParent_findParent;a.setParent=MAttributeParent_setParent;a.dispose=MAttributeParent_dispose;return a},MO.MAttributeParent_parent=function(){return this._parent},MO.MAttributeParent_findParent=function(a){var b=this;if(a)for(;RClass.isClass(b._parent,a);)b=b._parent;else for(;b._parent;)b=b._parent;return b},MO.MAttributeParent_setParent=function(a){this._parent=
a},MO.MAttributeParent_dispose=function(){this._parent=null};with(MO)MO.MClone=function(a){a=RClass.inherits(this,a);a.clone=MClone_clone;return a},MO.MClone_clone=function(){var a=RClass.create(this.constructor),b;for(b in this)v=this[b],null!=v&&(RClass.isBaseDataType(v.constructor)||(a[b]=v.clone())),a[b]=v;return a};
with(MO)MO.MDataStream=function(a){a=RClass.inherits(this,a);a._viewer=null;a._endianCd=!1;a._position=0;a.testString=MDataStream_testString;a.readBoolean=MDataStream_readBoolean;a.readInt8=MDataStream_readInt8;a.readInt16=MDataStream_readInt16;a.readInt32=MDataStream_readInt32;a.readInt64=MDataStream_readInt64;a.readUint8=MDataStream_readUint8;a.readUint16=MDataStream_readUint16;a.readUint32=MDataStream_readUint32;a.readUint64=MDataStream_readUint64;a.readFloat=MDataStream_readFloat;a.readDouble=
MDataStream_readDouble;a.readString=MDataStream_readString;a.readData=MDataStream_readData;a.readBytes=MDataStream_readBytes;a.writeBoolean=MDataStream_writeBoolean;a.writeInt8=MDataStream_writeInt8;a.writeInt16=MDataStream_writeInt16;a.writeInt32=MDataStream_writeInt32;a.writeInt64=MDataStream_writeInt64;a.writeUint8=MDataStream_writeUint8;a.writeUint16=MDataStream_writeUint16;a.writeUint32=MDataStream_writeUint32;a.writeUint64=MDataStream_writeUint64;a.writeFloat=MDataStream_writeFloat;a.writeDouble=
MDataStream_writeDouble;a.writeString=MDataStream_writeString;a.writeBytes=MDataStream_writeBytes;return a},MO.MDataStream_testString=function(){for(var a=this._position,b=this._viewer.getUint16(a,this._endianCd),a=a+2,d=new TString,f=0;f<b;f++){var h=this._viewer.getUint16(a,this._endianCd),a=a+2;d.push(String.fromCharCode(h))}return d.toString()},MO.MDataStream_readBoolean=function(){var a=this._viewer.getInt8(this._position,this._endianCd);this._position++;return 0<a},MO.MDataStream_readInt8=function(){var a=
this._viewer.getInt8(this._position,this._endianCd);this._position++;return a},MO.MDataStream_readInt16=function(){var a=this._viewer.getInt16(this._position,this._endianCd);this._position+=2;return a},MO.MDataStream_readInt32=function(){var a=this._viewer.getInt32(this._position,this._endianCd);this._position+=4;return a},MO.MDataStream_readInt64=function(){var a=this._viewer.getInt64(this._position,this._endianCd);this._position+=8;return a},MO.MDataStream_readUint8=function(){var a=this._viewer.getUint8(this._position,
this._endianCd);this._position+=1;return a},MO.MDataStream_readUint16=function(){var a=this._viewer.getUint16(this._position,this._endianCd);this._position+=2;return a},MO.MDataStream_readUint32=function(){var a=this._viewer.getUint32(this._position,this._endianCd);this._position+=4;return a},MO.MDataStream_readUint64=function(){var a=this._viewer.getUint64(this._position,this._endianCd);this._position+=8;return a},MO.MDataStream_readFloat=function(){var a=this._viewer.getFloat32(this._position,this._endianCd);
this._position+=4;return a},MO.MDataStream_readDouble=function(){var a=this._viewer.getFloat64(this._position,this._endianCd);this._position+=8;return a},MO.MDataStream_readString=function(){for(var a=this._viewer,b=this._endianCd,d=this._position,f=a.getUint16(d,b),d=d+2,h=new TString,k=0;k<f;k++){var q=a.getUint16(d,b);h.push(String.fromCharCode(q));d+=2}this._position=d;return h.flush()},MO.MDataStream_readData=function(a){switch(a){case EDataType.Int8:return this.readInt8();case EDataType.Int16:return this.readInt16();
case EDataType.Int32:return this.readInt32();case EDataType.Int64:return this.readInt64();case EDataType.Uint8:return this.readUint8();case EDataType.Uint16:return this.readUint16();case EDataType.Uint32:return this.readUint32();case EDataType.Uint64:return this.readUint64();case EDataType.Float32:return this.readFloat();case EDataType.Float64:return this.readDouble();case EDataType.String:return this.readString()}throw new TError(this,"Unknown data cd. (data_cd={1})",a);},MO.MDataStream_readBytes=
function(a,b,d){var f=this._viewer;if(!(0>=d)){if(0!=b)throw new TError(this,"Unsupport.");b=this._position;var h=this._endianCd;if(0==d%8){a=new Float64Array(a);d>>=3;for(var k=0;k<d;k++)a[k]=f.getFloat64(b,h),b+=8}else if(0==d%4)for(a=new Uint32Array(a),d>>=2,k=0;k<d;k++)a[k]=f.getUint32(b,h),b+=4;else if(0==d%2)for(a=new Uint16Array(a),d>>=1,k=0;k<d;k++)a[k]=f.getUint16(b,h),b+=2;else for(a=new Uint8Array(a),k=0;k<d;k++)a[k]=f.getUint8(b++,h);this._position=b}},MO.MDataStream_writeBoolean=function(a){this._viewer.setInt8(this._position,
0<a?1:0,this._endianCd);this._position++},MO.MDataStream_writeInt8=function(a){this._viewer.setInt8(this._position,a,this._endianCd);this._position++},MO.MDataStream_writeInt16=function(a){this._viewer.setInt16(this._position,a,this._endianCd);this._position+=2},MO.MDataStream_writeInt32=function(a){this._viewer.setInt32(this._position,a,this._endianCd);this._position+=4},MO.MDataStream_writeInt64=function(a){this._viewer.setInt64(this._position,a,this._endianCd);this._position+=8},MO.MDataStream_writeUint8=
function(a){this._viewer.setUint8(this._position,a,this._endianCd);this._position+=1},MO.MDataStream_writeUint16=function(a){this._viewer.setUint16(this._position,a,this._endianCd);this._position+=2},MO.MDataStream_writeUint32=function(a){this._viewer.setUint32(this._position,a,this._endianCd);this._position+=4},MO.MDataStream_writeUint64=function(a){this._viewer.setUint64(this._position,a,this._endianCd);this._position+=8},MO.MDataStream_writeFloat=function(a){this._viewer.setFloat32(this._position,
a,this._endianCd);this._position+=4},MO.MDataStream_writeDouble=function(a){this._viewer.setDouble(this._position,a,this._endianCd);this._position+=8},MO.MDataStream_writeString=function(a){var b=this._viewer,d=v.length,f=this._endianCd,h=this._position;b.setUint16(h,d,f);for(var h=h+2,k=0;k<d;k++)b.setUint16(h,a.charCodeAt(k),f),h+=2;this._position=h},MO.MDataStream_writeBytes=function(a,b,d){var f=this._viewer;if(!(0>=d)){if(0!=b)throw new TError("Unsupport.");b=this._position;var h=this._endianCd;
if(0==d%8){a=new Float64Array(a);d>>=3;for(var k=0;k<d;k++)f.setFloat64(b,a[k],h),b+=8}else if(0==d%4)for(a=new Uint32Array(a),d>>=2,k=0;k<d;k++)f.setUint32(b,a[k],h),b+=4;else if(0==d%2)for(a=new Uint16Array(a),d>>=1,k=0;k<d;k++)f.setUint16(b,a[k],h),b+=2;else for(a=new Uint8Array(a),k=0;k<d;k++)f.setUint8(b++,a[k],h);this._position=b}};
with(MO)MO.MDataView=function(a){a=RClass.inherits(this,a);a._viewer=null;a._endianCd=0;a.endianCd=MDataView_endianCd;a.setEndianCd=MDataView_setEndianCd;a.getInt8=MDataView_getInt8;a.getInt16=MDataView_getInt16;a.getInt32=MDataView_getInt32;a.getInt64=MDataView_getInt64;a.getUint8=MDataView_getUint8;a.getUint16=MDataView_getUint16;a.getUint32=MDataView_getUint32;a.getUint64=MDataView_getUint64;a.getFloat=MDataView_getFloat;a.getDouble=MDataView_getDouble;a.setInt8=MDataView_setInt8;a.setInt16=MDataView_setInt16;
a.setInt32=MDataView_setInt32;a.setInt64=MDataView_setInt64;a.setUint8=MDataView_setUint8;a.setUint16=MDataView_setUint16;a.setUint32=MDataView_setUint32;a.setUint64=MDataView_setUint64;a.setFloat=MDataView_setFloat;a.setDouble=MDataView_setDouble;return a},MO.MDataView_endianCd=function(a){return this._endianCd},MO.MDataView_setEndianCd=function(a){this._endianCd=a},MO.MDataView_getInt8=function(a){return this._viewer.getInt8(a,this._endianCd)},MO.MDataView_getInt16=function(a){return this._viewer.getInt16(a,
this._endianCd)},MO.MDataView_getInt32=function(a){return this._viewer.getInt32(a,this._endianCd)},MO.MDataView_getInt64=function(a){return this._viewer.getInt64(a,this._endianCd)},MO.MDataView_getUint8=function(a){return this._viewer.getUint8(a,this._endianCd)},MO.MDataView_getUint16=function(a){return this._viewer.getUint16(a,this._endianCd)},MO.MDataView_getUint32=function(a){return this._viewer.getUint32(a,this._endianCd)},MO.MDataView_getUint64=function(a){return this._viewer.getUint64(a,this._endianCd)},
MO.MDataView_getFloat=function(a){return this._viewer.getFloat32(a,this._endianCd)},MO.MDataView_getDouble=function(a){return this._viewer.getFloat64(a,this._endianCd)},MO.MDataView_setInt8=function(a,b){this._viewer.setInt8(a,b,this._endianCd)},MO.MDataView_setInt16=function(a,b){this._viewer.setInt16(a,b,this._endianCd)},MO.MDataView_setInt32=function(a,b){this._viewer.setInt32(a,b,this._endianCd)},MO.MDataView_setInt64=function(a,b){this._viewer.setInt64(a,b,this._endianCd)},MO.MDataView_setUint8=
function(a,b){this._viewer.setUint8(a,b,this._endianCd)},MO.MDataView_setUint16=function(a,b){this._viewer.setUint16(a,b,this._endianCd)},MO.MDataView_setUint32=function(a,b){this._viewer.setUint32(a,b,this._endianCd)},MO.MDataView_setUint64=function(a,b){this._viewer.setUint64(a,b,this._endianCd)},MO.MDataView_setFloat=function(a,b){this._viewer.setFloat32(a,b,this._endianCd)},MO.MDataView_setDouble=function(a,b){this._viewer.setDouble(a,b,this._endianCd)};
with(MO)MO.MListener=function(a){a=RClass.inherits(this,a);a._listenerss=null;a.addListener=MListener_addListener;a.setListener=MListener_setListener;a.removeListener=MListener_removeListener;a.clearListeners=MListener_clearListeners;a.clearAllListeners=MListener_clearAllListeners;a.processListener=MListener_processListener;a.dispose=MListener_dispose;return a},MO.MListener_addListener=function(a,b,d){var f=this._listenerss;f||(f=this._listenerss=new TDictionary);var h=f.get(a);h||(h=new TListeners,
f.set(a,h));return h.register(b,d)},MO.MListener_setListener=function(a,b,d){var f=this._listenerss;f&&(f=f.get(a))&&f.clear();return this.addListener(a,b,d)},MO.MListener_removeListener=function(a,b,d){return this._listenerss.get(a).unregister(b,d)},MO.MListener_clearListeners=function(a){var b=this._listenerss;b&&(a=b.get(a))&&a.clear()},MO.MListener_clearAllListeners=function(){var a=this._listenerss;if(a)for(var b=a.count(),d=0;d<b;d++){var f=a.at(d);f&&f.clear()}},MO.MListener_processListener=
function(a,b,d,f,h,k){var q=this._listenerss;q&&(a=q.get(a))&&a.process(b,d,f,h,k)},MO.MListener_dispose=function(){var a=this._listenerss;if(a){for(var b=a.count()-1;0<=b;b--)a.at(b).dispose();this._listenerss=RObject.dispose(a)}};
with(MO)MO.MListenerLoad=function(a){a=RClass.inherits(this,a,MListener);a.addLoadListener=MListenerLoad_addLoadListener;a.removeLoadListener=MListenerLoad_removeLoadListener;a.clearLoadListeners=MListenerLoad_clearLoadListeners;a.processLoadListener=MListenerLoad_processLoadListener;return a},MO.MListenerLoad_addLoadListener=function(a,b){return this.addListener(EEvent.Load,a,b)},MO.MListenerLoad_removeLoadListener=function(a,b){this.removeListener(EEvent.Load,a,b)},MO.MListenerLoad_clearLoadListeners=
function(){this.clearListeners(EEvent.Load)},MO.MListenerLoad_processLoadListener=function(a,b,d,f,h){this.processListener(EEvent.Load,a,b,d,f,h)};
with(MO)MO.MListenerProcess=function(a){a=RClass.inherits(this,a,MListener);a.addProcessListener=MListenerProcess_addProcessListener;a.removeProcessListener=MListenerProcess_removeProcessListener;a.processProcessListener=MListenerProcess_processProcessListener;return a},MO.MListenerProcess_addProcessListener=function(a,b){return this.addListener(EEvent.Process,a,b)},MO.MListenerProcess_removeProcessListener=function(a,b){this.removeListener(EEvent.Process,a,b)},MO.MListenerProcess_processProcessListener=
function(a,b,d,f,h){this.processListener(EEvent.Process,a,b,d,f,h)};
with(MO)MO.MListenerTouchZoom=function(a){a=RClass.inherits(this,a,MListener);a.addTouchZoomListener=MListenerTouchZoom_addTouchZoomListener;a.removeTouchZoomListener=MListenerTouchZoom_removeTouchZoomListener;a.clearTouchZoomListeners=MListenerTouchZoom_clearTouchZoomListeners;a.processTouchZoomListener=MListenerTouchZoom_processTouchZoomListener;return a},MO.MListenerTouchZoom_addTouchZoomListener=function(a,b){return this.addListener(EEvent.TouchZoom,a,b)},MO.MListenerTouchZoom_removeTouchZoomListener=
function(a,b){this.removeListener(EEvent.TouchZoom,a,b)},MO.MListenerTouchZoom_clearTouchZoomListeners=function(){this.clearListeners(EEvent.TouchZoom)},MO.MListenerTouchZoom_processTouchZoomListener=function(a,b,d,f,h){this.processListener(EEvent.TouchZoom,a,b,d,f,h)};
with(MO)MO.MMouseCapture=function(a){a=RClass.inherits(this,a);a.onMouseCaptureStart=RMethod.virtual(a,"onMouseCaptureStart");a.onMouseCapture=RMethod.virtual(a,"onMouseCapture");a.onMouseCaptureStop=RMethod.virtual(a,"onMouseCaptureStop");a.testMouseCapture=RMethod.emptyTrue;return a};with(MO)MO.MMouseWheel=function(a){a=RClass.inherits(this,a);a.onMouseWheel=RClass.register(a,new AEventMouseWheel("onMouseWheel"),RMethod.empty);return a};
with(MO)MO.MProperty=function(a){a=RClass.inherits(this,a);a.propertyAssign=MProperty_propertyAssign;a.propertyLoad=MProperty_propertyLoad;a.propertySave=MProperty_propertySave;return a},MO.MProperty_propertyAssign=function(a){var b=RClass.find(this.constructor).annotations(EAnnotation.Property),d;for(d in b){var f=b[d];f.constructor!=Function&&(this[f._name]=a[f._name])}},MO.MProperty_propertyLoad=function(a){var b=RClass.find(this.constructor).annotations(EAnnotation.Property),d;for(d in b){var f=
b[d];f.constructor!=Function&&(f._force?f.load(this,a):a.contains(f._linker)?f.load(this,a):null==this[f._name]&&(this[f._name]=f._value))}},MO.MProperty_propertySave=function(a){var b=RClass.find(this.constructor).annotations(EAnnotation.Property),d;for(d in b){var f=b[d];f.constructor!=Function&&f.save(this,a)}};with(MO)MO.SClickEvent=function(a){SEvent.call(this,a);return this};
with(MO)MO.SEvent=function(a){this.listener=this.annotation=null;this.sender=a;this.process=this.onProcess=this.ohProcess=this.hSource=this.hSender=this.hEvent=this.source=null;this.dispose=SEvent_dispose;return this},MO.SEvent_dispose=function(){for(var a in this)this[a]=null};
with(MO)MO.SKeyboardEvent=function(){SEvent.call(this);this.ctrlKey=this.shiftKey=this.altKey=!1;this.keyCode=0;this.attachEvent=SKeyboardEvent_attachEvent;this.cancel=SKeyboardEvent_cancel;return this},MO.SKeyboardEvent_attachEvent=function(a){this.altKey=a.altKey;this.shiftKey=a.shiftKey;this.ctrlKey=a.ctrlKey;this.keyCode=a.keyCode},MO.SKeyboardEvent_cancel=function(){this.hEvent.returnValue=!1};
with(MO)MO.SMouseEvent=function(){SEvent.call(this);this.button=null;this.ctrlKey=this.altKey=this.mouseRight=this.mouseMiddle=this.mouseLeft=!1;this.deltaZ=this.deltaY=this.deltaX=this.clientY=this.clientX=this.offsetY=this.offsetX=this.y=this.x=0;this.attachEvent=SMouseEvent_attachEvent;return this},MO.SMouseEvent_attachEvent=function(a){var b=this.hSource=RHtml.eventSource(a);b&&(this.source=b.__linker);this.button=a.button;this.mouseLeft=a.button==EMouseButton.Left;this.mouseMiddle=a.button==
EMouseButton.Middle;this.mouseRight=a.button==EMouseButton.Right;this.altKey=a.altKey;this.ctrlKey=a.ctrlKey;RBrowser.isBrowser(EBrowser.FireFox)?(this.x=a.pageX,this.y=a.pageY,this.offsetX=a.layerX,this.offsetY=a.layerY):(this.x=a.x,this.y=a.y,this.offsetX=a.offsetX,this.offsetY=a.offsetY);this.clientX=a.clientX;this.clientY=a.clientY;this.deltaX=a.deltaX;this.deltaY=a.deltaY;this.deltaZ=a.deltaZ};
with(MO)MO.SResizeEvent=function(){SEvent.call(this);this.height=this.width=null;this.attachEvent=SResizeEvent_attachEvent;return this},MO.SResizeEvent_attachEvent=function(a){if(a=this.hSource=RHtml.eventSource(a))this.source=a.__linker};with(MO)MO.SXmlEvent=function(){SEvent.call(this);this.root=this.document=this.connection=null;return this};
with(MO)MO.THtmlItem=function(){this._link=null;this._links={};this.get=THtmlItem_get;this.set=THtmlItem_set;return this},MO.THtmlItem_get=function(a){return this._links[a]},MO.THtmlItem_set=function(a,b){this._links[a]=b};
with(MO)MO.TXmlDocument=function(){this._root=null;this.create=TXmlDocument_create;this.root=TXmlDocument_root;this.setRoot=TXmlDocument_setRoot;this.xml=TXmlDocument_xml;this.dump=TXmlDocument_dump;return this},MO.TXmlDocument_create=function(a,b,d){var f=new TXmlNode;f._name=a;f._attributes=b;f._value=d;return f},MO.TXmlDocument_root=function(){var a=this._root;a||(a=this._root=new TXmlNode,a._name="Configuration");return a},MO.TXmlDocument_setRoot=function(a){if(this._root)throw new TError(this,
"Root node is already exists.");this._root=a},MO.TXmlDocument_xml=function(){var a=new TString;a.append("<?xml version='1.0' encoding='UTF-8'?>");this.root().innerXml(a,0);return a.flush()},MO.TXmlDocument_dump=function(){var a=new TString;a.appendLine(RClass.name(this));this.root().dump(a);return a.flush()};
with(MO)MO.TXmlNode=function(a){TNode.call(this,a);this.create=TXmlNode_create;this.innerXml=TXmlNode_innerXml;this.xml=TXmlNode_xml;this.toString=TXmlNode_toString;return this},MO.TXmlNode_create=function(a,b){var d=new TXmlNode;d._name=a;d._attributes=b;if(!RClass.isClass(b,TAttributes)){b=arguments;var f=b.length;for(a=1;a<f;a+=2)a+1<f?d.set(b[a],b[a+1]):d._value=b[a]}this.push(d);return d},MO.TXmlNode_innerXml=function(a,b){a.appendRepeat("   ",b);a.append("<",this._name);var d=this._attributes;
if(d)for(var f=d.count(),h=0;h<f;h++)a.append(" ",d.name(h),'="'),RXml.buildText(a,d.value(h)),a.append('"');this._nodes||null!=this._value||a.append("/");a.append(">\n");if(d=this._nodes)for(f=d.count(),h=0;h<f;h++)d.get(h).innerXml(a,b+1);RXml.buildText(a,this._value);if(this._nodes||null!=this._value)a.appendRepeat("   ",b),a.append("</",this._name,">"),a.append("\n");return a},MO.TXmlNode_xml=function(){var a=new TString;this.innerXml(a,0);return a.flush()},MO.TXmlNode_toString=function(){return this.xml().toString()};
with(MO)MO.FBytes=function(a){a=RClass.inherits(this,a,FObject,MDataView);a._memory=null;a.construct=FBytes_construct;a.dispose=FBytes_dispose;return a},MO.FBytes_construct=function(){this.__base.FObject.construct.call(this);this._memory=new ArrayBuffer;this._viewer=new DataView(this._memory)},MO.FBytes_dispose=function(){this._viewer=this._memory=null;this.__base.FObject.dispose.call(this)};
with(MO)MO.FClassFactory=function(a){a=RClass.inherits(this,a,FObject);a._classes=null;a.construct=FClassFactory_construct;a.register=FClassFactory_register;a.unregister=FClassFactory_unregister;a.create=FClassFactory_create;a.dispose=FClassFactory_dispose;return a},MO.FClassFactory_construct=function(){this.__base.FObject.construct.call(this);this._classes=new TDictionary},MO.FClassFactory_register=function(a,b){this._classes.set(a,b)},MO.FClassFactory_unregister=function(a){this._classes.set(a,
null)},MO.FClassFactory_create=function(a){var b=this._classes.get(a);if(!b)throw new TError("Create unregister class. (name={1})",a);return RClass.create(b)},MO.FClassFactory_dispose=function(){this._classes=RObject.dispose(this._classes);this.__base.FObject.dispose.call(this)};with(MO)MO.FComponent=function(a){a=RClass.inherits(this,a,FObject,MAttributeParent,MAttributeCode);a.dispose=FComponent_dispose;return a},MO.FComponent_dispose=function(){this.__base.MAttributeParent.dispose.call(this);this.__base.FObject.dispose.call(this)};
with(MO)MO.FDataStream=function(a){a=RClass.inherits(this,a,FObject,MDataView,MDataStream);a._length=0;a._memory=null;a._viewer=null;a.construct=FDataStream_construct;a.length=FDataStream_length;a.setLength=FDataStream_setLength;a.memory=FDataStream_memory;a.flip=FDataStream_flip;a.dispose=FDataStream_dispose;return a},MO.FDataStream_construct=function(){this.__base.FObject.construct.call(this)},MO.FDataStream_length=function(){return this._length},MO.FDataStream_setLength=function(a){this._length=
a;this._memory=new ArrayBuffer(a);this._viewer=new DataView(this._memory)},MO.FDataStream_memory=function(){return this._memory},MO.FDataStream_flip=function(){this._length=this._position;this._position=0},MO.FDataStream_dispose=function(){this._memory=this._viewer=null;this.__base.FObject.dispose.call(this)};
with(MO)MO.FDataView=function(a){a=RClass.inherits(this,a,FObject,MDataView,MDataStream);a.link=FDataView_link;a.dispose=FDataView_dispose;return a},MO.FDataView_link=function(a){this._memory=a;this._viewer=new DataView(a)},MO.FDataView_dispose=function(){this._memory=this._viewer=null;this.__base.FObject.dispose.call(this)};
with(MO)MO.FFileReader=function(a){a=RClass.inherits(this,a,FObject,MListenerLoad);a._reader=null;a._fileName=null;a._length=0;a._data=null;a._statusLoading=!1;a.ohloadStart=FFileReader_ohLoadStart;a.ohLoad=FFileReader_ohLoad;a.ohLoadEnd=FFileReader_ohLoadEnd;a.ohProgress=FFileReader_ohProgress;a.construct=FFileReader_construct;a.fileName=FFileReader_fileName;a.length=FFileReader_length;a.data=FFileReader_data;a.loadFile=FFileReader_loadFile;a.dispose=FFileReader_dispose;return a},MO.FFileReader_ohLoadStart=
function(){},MO.FFileReader_ohLoad=function(){},MO.FFileReader_ohLoadEnd=function(){var a=this.__linker,b=a._reader;a._statusFree=!0;if(b.error){debugger;RLogger.error(a,"Load file failure. (error={1])",b.error)}else a._length=b.result.byteLength,a._data=b.result,b=new SEvent(a),a.processLoadListener(b),b.dispose()},MO.FFileReader_ohProgress=function(){},MO.FFileReader_construct=function(){this.__base.FObject.construct.call(this);var a=this._reader=new FileReader;a.__linker=this;a.onloadstart=this.ohLoadStart;
a.onload=this.ohLoad;a.onloadend=this.ohLoadEnd;a.onprogress=this.ohProgress},MO.FFileReader_fileName=function(){return this._fileName},MO.FFileReader_length=function(){return this._length},MO.FFileReader_data=function(){return this._data},MO.FFileReader_loadFile=function(a){this._fileName=a.name;this._length=a.size;this._reader.readAsArrayBuffer(a)},MO.FFileReader_dispose=function(){var a=this._reader=new FileReader;a.__linker=null;a.onloadstart=null;a.onload=null;a.onloadend=null;this._data=this._fileName=
this._reader=a.onprogress=null;this.__base.MListenerLoad.dispose.call(this);this.__base.FObject.dispose.call(this)};
with(MO)MO.FHttpConnection=function(a){a=RClass.inherits(this,a,FObject,MListenerLoad);a._asynchronous=!1;a._methodCd=EHttpMethod.Get;a._contentCd=EHttpContent.Binary;a._url=null;a._input=null;a._inputData=null;a._output=null;a._outputData=null;a._connection=null;a._contentLength=0;a._statusFree=!0;a.onConnectionSend=FHttpConnection_onConnectionSend;a.onConnectionReady=FHttpConnection_onConnectionReady;a.onConnectionComplete=FHttpConnection_onConnectionComplete;a.construct=FHttpConnection_construct;
a.setHeaders=FHttpConnection_setHeaders;a.inputData=FHttpConnection_inputData;a.setInputData=FHttpConnection_setInputData;a.outputData=FHttpConnection_outputData;a.setOutputData=FHttpConnection_setOutputData;a.content=FHttpConnection_content;a.sendSync=FHttpConnection_sendSync;a.sendAsync=FHttpConnection_sendAsync;a.send=FHttpConnection_send;a.dispose=FHttpConnection_dispose;return a},MO.FHttpConnection_onConnectionSend=function(){var a=this._input;if(a)if(a.constructor==String)this._inputData=a,
this._contentLength=a.length;else if(a.constructor==ArrayBuffer)this._inputData=a,this._contentLength=a.byteLength;else throw new TError("Unknown send data type.");},MO.FHttpConnection_onConnectionReady=function(){var a=this._linker;if(a._asynchronous){var b=a._connection;if(b.readyState==EHttpStatus.Loaded)if(200==b.status)a.setOutputData(),a.onConnectionComplete();else throw new TError(a,"Connection failure. (url={1})",a._url);}},MO.FHttpConnection_onConnectionComplete=function(){this._statusFree=
!0;this.processLoadListener(this)},MO.FHttpConnection_construct=function(){var a=this._connection=RXml.createConnection();a._linker=this;a.onreadystatechange=this.onConnectionReady},MO.FHttpConnection_setHeaders=function(){var a=this._connection;this._contentCd==EHttpContent.Binary?RBrowser.isBrowser(EBrowser.Explorer)?(a.setRequestHeader("Accept-Charset","x-user-defined"),a.responseType="arraybuffer"):(a.overrideMimeType("text/plain; charset=x-user-defined"),this._asynchronous&&(a.responseType="arraybuffer")):
a.setRequestHeader("content-type","application/x-www-form-urlencoded");RBrowser.isBrowser(EBrowser.Chrome)||0<this._contentLength&&a.setRequestHeader("content-length",this._contentLength)},MO.FHttpConnection_inputData=function(){return this._inputData},MO.FHttpConnection_setInputData=function(a){this._inputData=a},MO.FHttpConnection_outputData=function(){return this._outputData},MO.FHttpConnection_setOutputData=function(){var a=this._connection;this._outputData=this._contentCd==EHttpContent.Binary?
a.response:a.responseText},MO.FHttpConnection_content=function(){return this._outputData},MO.FHttpConnection_sendSync=function(){var a=this._connection;a.open(this._methodCd,this._url,!1);this.setHeaders(a,0);a.send(this._inputData);this.setOutputData();this.onConnectionComplete();RLogger.info(this,"Send http sync request. (method={1}, url={2})",this._methodCd,this._url)},MO.FHttpConnection_sendAsync=function(){var a=this._connection;a.open(this._methodCd,this._url,!0);this.setHeaders(a,0);a.send(this._inputData);
RLogger.info(this,"Send http asynchronous request. (method={1}, url={2})",this._methodCd,this._url)},MO.FHttpConnection_send=function(a,b){this._url=a;this._input=b;this._methodCd=null!=b?EHttpMethod.Post:EHttpMethod.Get;this._statusFree=!1;this.onConnectionSend();this._asynchronous?this.sendAsync():this.sendSync();return this.content()},MO.FHttpConnection_dispose=function(){this._outputData=this._output=this._inputData=this._input=null;var a=this._connection;a&&(this._connection=a.onreadystatechange=
null);this.__base.MListenerLoad.dispose.call(this);this.__base.FObject.dispose.call(this)};
with(MO)MO.FXmlConnection=function(a){a=RClass.inherits(this,a,FHttpConnection);a._contentCd=EHttpContent.Text;a._inputNode=null;a._outputNode=null;a.onConnectionSend=FXmlConnection_onConnectionSend;a.onConnectionComplete=FXmlConnection_onConnectionComplete;a.content=FXmlConnection_content;return a},MO.FXmlConnection_onConnectionSend=function(){var a=this._input;if(a){var b=null;if(a.constructor==String)b=a,this._inputNode=null;else if(a.constructor==TXmlNode)b=new TXmlDocument,b.setRoot(a),b=b.xml(),
this._inputNode=a;else if(a.constructor==TXmlDocument)b=a.xml(),this._inputNode=a.root();else throw new TError("Unknown send data type.");this._inputData=b;this._contentLength=b.length}},MO.FXmlConnection_onConnectionComplete=function(){var a=this._connection,b=null;if(a.responseXML)b=a.responseXML.documentElement;else if(a.responseXml)b=a.responseXml.documentElement;else throw new TError(this,"Fetch xml data failure.");if(!b)return RMessage.fatal(this,null,"Read xml error. (url={1})\n{2}",this._url,
a._outputText);a=new TXmlDocument;RXml.buildNode(a,null,b);var d=this._outputNode=a.root();this._statusFree=!0;b=new SXmlEvent;b.connection=this;b.document=a;b.root=d;b.parameters=this._parameters;this.processLoadListener(b);b.dispose();this._asynchronous&&(this._parameters=this._outputNode=this._output=this._inputNode=this._input=null)},MO.FXmlConnection_content=function(){return this._outputNode};
with(MO)MO.FXmlData=function(a){a=RClass.inherits(this,a,FObject);a._ready=null;a._config=null;a.testReady=FXmlData_testReady;return a},MO.FXmlData_testReady=function(){return this._ready};
with(MO)MO.REngine=function(){this._spaces={};this.Global={};this.Top={};this.Local={};this.onRelease=REngine_onRelease;this.register=REngine_register;this.initialize=REngine_initialize;this.connect=REngine_connect;this.buildSpace=REngine_buildSpace;this.find=REngine_find;this.findGlobal=REngine_findGlobal;this.findTop=REngine_findTop;this.findLocal=REngine_findLocal;return this},MO.REngine_onRelease=function(){RConsole.release();REvent.release();CollectGarbage()},MO.REngine_register=function(a){var b=
this._spaces[a.space];b||(b=this._spaces[a.space]={});b[a.name]=a},MO.REngine_initialize=function(){RConsole.initialize()},MO.REngine_connect=function(){RConsole.initialize()},MO.REngine_buildSpace=function(a,b){for(var d in b)RString.startsWith(d,"R")&&(a[d.substring(1)]=b[d].instance)},MO.REngine_find=function(a,b){var d=null;if(a=this._spaces[a])if(d=a[b])return d.instance;return null},MO.REngine_findGlobal=function(a){return this.find(ESpace.Global,a)},MO.REngine_findTop=function(a){return top.REngine.find(ESpace.Top,
a)},MO.REngine_findLocal=function(a){return this.find(ESpace.Local,a)},MO.REngine=new REngine;
with(MO)MO.RKeyboard=function(){this._status=[];this.onKeyDown=RKeyboard_onKeyDown;this.onKeyUp=RKeyboard_onKeyUp;this.construct=RKeyboard_construct;this.isControlKey=RKeyboard_isControlKey;this.isIntegerKey=RKeyboard_isIntegerKey;this.isFloatKey=RKeyboard_isFloatKey;this.isNumKey=RKeyboard_isNumKey;this.isPress=RKeyboard_isPress;this.fixCase=RKeyboard_fixCase;this.fixPattern=RKeyboard_fixPattern;this.fixChars=RKeyboard_fixChars;return this},MO.RKeyboard_onKeyDown=function(a){this._status[a.keyCode]=
EKeyStatus.Press},MO.RKeyboard_onKeyUp=function(a){this._status[a.keyCode]=EKeyStatus.Normal},MO.RKeyboard_construct=function(){for(var a=this._status,b=0;256>b;b++)a[b]=EKeyStatus.Normal;RWindow.lsnsKeyDown.register(this,this.onKeyDown);RWindow.lsnsKeyUp.register(this,this.onKeyUp)},MO.RKeyboard_isControlKey=function(a){for(var b=EKeyCode.ControlKeys,d=b.length-1;0<=d;d--)if(b[d]==a)return!0;return!1},MO.RKeyboard_isIntegerKey=function(a){return EKeyCode.integerCodes[a]},MO.RKeyboard_isFloatKey=
function(a){return EKeyCode.floatCodes[a]},MO.RKeyboard_isNumKey=function(a){return 96<=p&&105>=p?!0:!1},MO.RKeyboard_isPress=function(a){return this._status[a]==EKeyStatus.Press},MO.RKeyboard_fixCase=function(a,b){if(a&&b){var d=a.keyCode;ECase.Upper==b?d=String.fromCharCode(d).toUpperCase().charCodeAt(0):ECase.Lower==b&&(d=String.fromCharCode(d).toLowerCase().charCodeAt(0));a.keyCode=d}},MO.RKeyboard_fixPattern=function(a,b){if(b){var d=a.keyCode;if(!this.isControlKeyPress(d)&&!RString.isPattern(String.fromCharCode(d),
b))return a.keyCode=0,!1}return!0},MO.RKeyboard_fixChars=function(a,b){if(b){var d=a.keyCode;this.isNumKey(d)&&(d=a.keyCode-=48);if(!this.isControlKeyPress(d)&&!RString.inChars(String.fromCharCode(d),b))return a.keyCode=0,a.returnValue=!1}return!0},MO.RKeyboard=new RKeyboard;
with(MO)MO.RLoader=function(){this._loading=new TArray;this._loaded=new TArray;this._waits=new TArray;this.hWindow=this._intervalId=null;this.onInterval=RLoader_onInterval;this.intervalStart=RLoader_intervalStart;this.intervalStop=RLoader_intervalStop;this.loadJsFile=RLoader_loadJsFile;this.loadJs=RLoader_loadJs;this.loaded=RLoader_loaded;this.wait=RLoader_wait;this.waitJs=RLoader_waitJs;this.dispose=RLoader_dispose;return this},MO.RLoader_dispose=function(){this.intervalStop();this.hWindow=null},
MO.RLoader_onInterval=function(){for(var a=this._waits,b=a.length,d=0;d<b;d++){var f=a.get(d);f&&f.check(this._loaded)&&(f.invoke.invoke(),a.set(d,null))}a.compress();a.isEmpty()&&this.intervalStop()},MO.RLoader_intervalStart=function(){var a=this;a._intervalId||(a.hWindow=window,a._intervalId=window.setInterval(function(){a.onInterval()},10))},MO.RLoader_intervalStop=function(){var a=this.hWindow;a&&this._intervalId&&(a.clearInterval(this._intervalId),this._intervalId=this.hWindow=null)},MO.RLoader_loadJsFile=
function(a,b){var d=this,f=RWindow.hDocument,h=f.getElementsByTagName("head")[0];if(null==document.getElementById(a)){var k=top.RContext.location(b),q=RWindow.createElement("SCRIPT");q.id=a;q.type="text/javascript";q.src=k;f.attachEvent?q.onreadystatechange=function(){var b=q.readyState;if("loaded"==b||"complete"==b)q.onreadystatechange=null,d._loading.extract(a),d._loaded.push(a)}:q.onload=function(){"complete"==f.readyState&&(q.onload=null,d._loading.extract(a),d._loaded.push(a))};h.appendChild(q)}},
MO.RLoader_loadJs=function(a){for(var b=arguments,d=b.length,f=0;f<d;f++){var h=b[f];this.loadJsFile("js:"+h,"/ajs/"+h.replace(/\./g,"/")+".js")}},MO.RLoader_loaded=function(a){this._loading.extract(a);this._loaded.push(a)},MO.RLoader_wait=function(a,b){var d=new TLoaderListener;d.invoke=a;for(var f=arguments.length,h=1;h<f;h++)d.ids.push(arguments[h]);this._waits.push(d);this.intervalStart()},MO.RLoader_waitJs=function(a,b){var d=new TLoaderListener;d.invoke=a;for(var f=arguments,h=f.length,k=1;k<
h;k++)d.ids.push("js:"+f[k]);this._waits.push(d);this.intervalStart()},MO.RLoader=new RLoader;
with(MO)MO.RMessage=function(){this._hasError=!1;this._messages=null;this.push=RMessage_push;this.fatal=RMessage_fatal;this.confirmResult=!1;this.error=RMessage_error;this.warn=RMessage_warn;this.onWindowClose=RMessage_onWindowClose;this.confirm=RMessage_confirm;this.info=RMessage_info;return this},MO.RMessage_push=function(a){this._messages||(this._messages=new FLoopList);this._messages.push(a)},MO.RMessage_fatal=function RMessage_fatal(b,d,f,h){if(!this._hasError){this._hasError=!0;for(var k=new TString,
q=[],w=RMessage_fatal.caller;w&&!RArray.contains(q,w);)q.push(w),w=w.caller;for(var x=q.length,y=0;y<x;y++)w=q[y],0<y&&k.appendLine(),k.append("   "+(x-y)+": "+RMethod.name(w));q=new TString;q.appendLine(RContext.get("RMessage:fatal"));q.appendLine(RString.repeat("-",60));q.append(RClass.dump(b),": ");if(f)for(w=arguments,x=w.length,y=3;y<x;y++){var z=w[y];"function"==typeof z&&(z=RMethod.name(z));f=f.replace("{"+(y-2)+"}",z)}q.appendLine(f);q.appendLine(RString.repeat("-",60));q.appendLine("Stack:");
q.append(k);alert(q)}},MO.RMessage_error=function(a,b,d,f){if(!this._hasError)throw this._hasError=!0,Error(d);},MO.RMessage_warn=function(a,b,d){new TString;a=top.RControl.create(FAlertWindow);a.setText(b);a.show()},MO.RMessage_info=function(a,b,d){new TString;a=top.RControl.create(FInfoWindow);a.setText(b);a.show()},MO.RMessage_confirm=function(a,b){var d=top.RControl.create(FConfirmWindow);d.setText(a);d.lsns.register(this,b);d.show()},MO.RMessage_onWindowClose=function(a){this.confirmResult=a},
MO.RMessage=new RMessage;
with(MO)MO.RResource=function(){this.uriIcon="/ars/icon/";this.uriImage="/ars/img/";this.iconPath=RResource_iconPath;this.iconUrlPath=RResource_iconUrlPath;this.imagePath=RResource_imagePath;return this},MO.RResource_iconPath=function(a,b){a=RString.nvl(a,"n").replace(/\./g,"/")+"."+RString.nvl(b,"gif");return RBrowser.contentPath("/ars/icon/"+a)},MO.RResource_iconUrlPath=function(a,b){a=RString.nvl(a,"n").replace(/\./g,"/")+"."+RString.nvl(b,"gif");return RBrowser.contentPath("/ars/icon/"+a)},MO.RResource_imagePath=
function(a,b){},MO.RResource=new RResource;
with(MO)MO.RStyle=function(){this._connected=!1;this._rules=new TMap;this.connect=RStyle_connect;this.has=RStyle_has;this.nvl=RStyle_nvl;this.style=RStyle_style;return this},MO.RStyle_connect=function(){if(!this._connected){for(var a=this._rules,b=document.styleSheets,d=b.length,f=0;f<d;f++){var h=b[f].cssRules;if(h)for(var k=h.length,q=0;q<k;q++){var w=h[q];a.set(w.selectorText,w)}}this._connected=!0}},MO.RStyle_has=function(a){this._connected||this.connect();return a?this._rules.contains("."+a.toLowerCase()):
!1},MO.RStyle_nvl=function(a,b){this.connect();var d=arguments,f=d.length;for(b=0;b<f;b++)if((a=d[b])&&this._rules.contains("."+a.toLowerCase()))return a;return null},MO.RStyle_style=function(a,b){return RClass.name(a)+"_"+b},MO.RStyle=new RStyle;
with(MO)MO.RTypeArray=function(){this._float4=this._float3=null;this._data={};this.float3=RTypeArray_float3;this.float4=RTypeArray_float4;this.createArray=RTypeArray_createArray;this.findTemp=RTypeArray_findTemp;return this},MO.RTypeArray_float3=function(){var a=this._float3;null==a&&(a=this._float3=new Float32Array(3));return a},MO.RTypeArray_float4=function(){var a=this._float4;null==a&&(a=this._float4=new Float32Array(4));return a},MO.RTypeArray_createArray=function(a,b){switch(a){case EDataType.Boolean:case EDataType.Int8:return new Int8Array(b);
case EDataType.Int16:return new Int16Array(b);case EDataType.Int32:return new Int32Array(b);case EDataType.Int64:return new Int64Array(b);case EDataType.Uint8:return new Uint8Array(b);case EDataType.Uint16:return new Uint16Array(b);case EDataType.Uint32:return new Uint32Array(b);case EDataType.Float32:return new Float32Array(b);case EDataType.Float64:return new Float64Array(b)}throw new TError("Create unknown type array. (type={1}, length={2})",a,b);},MO.RTypeArray_findTemp=function(a,b){var d=this._data,
f=d[a];null==f&&(f=d[a]={});d=f[b];null==d&&(d=f[b]=this.createArray(a,b));return d},MO.RTypeArray=new RTypeArray;
with(MO)MO.FTag=function(a){a=RClass.inherits(this,a,FObject);a._name="Tag";a._children=null;a._trimLeft=!1;a._trimRight=!1;a.onBegin=FTag_onBegin;a.onEnd=FTag_onEnd;a.name=FTag_name;a.set=FTag_set;a.push=FTag_push;a.parse=FTag_parse;a.toString=FTag_toString;a.innerDump=FTag_innerDump;a.dump=FTag_dump;return a},MO.FTag_onBegin=function(a){return EResult.Continue},MO.FTag_onEnd=function(a){return EResult.Continue},MO.FTag_name=function(){return this._name},MO.FTag_set=function(a,b){throw new TError(this,
"Unknown attribute name. (name={1}, value={2})",a,b);},MO.FTag_push=function(a){var b=this._children;null==b&&(b=this._children=new TObjects);b.push(a)},MO.FTag_parse=function(a){var b=this.onBegin(a);if(b==EResult.Continue){var d=this._children;if(d)for(var f=d.count(),h=0;h<f;h++){var k=d.get(h),b=k.parse(a);if(b==EResult.Cancel)return b;a._trimLeft=k._trimLeft;a._trimRight=k._trimRight}return this.onEnd(a)}return b},MO.FTag_toString=function(){return null},MO.FTag_innerDump=function(a,b,d){a.appendRepeat("   ",
d);a.append(RClass.dump(b));var f=b.toString();RString.isEmpty(f)||a.append(" [",f,"]");if(b=b._children){a.append("\n");for(var f=b.count(),h=0;h<f;h++){var k=b.get(h);this.innerDump(a,k,d+1);h<f-1&&a.append("\n")}}},MO.FTag_dump=function(){var a=new TString;this.innerDump(a,this,0);return a.toString()};
with(MO)MO.FTagContext=function(a){a=RClass.inherits(this,a,FObject,MInstance);a._trimLeft=!1;a._trimRight=!1;a._attributes=null;a._source=null;a.construct=FTagContext_construct;a.instanceAlloc=FTagContext_instanceAlloc;a.attributes=FTagContext_attributes;a.get=FTagContext_get;a.set=FTagContext_set;a.setBoolean=FTagContext_setBoolean;a.source=FTagContext_source;a.write=FTagContext_write;a.resetSource=FTagContext_resetSource;a.dispose=FTagContext_dispose;return a},MO.FTagContext_construct=function(){this.__base.FObject.construct.call(this);
this._attributes=new TAttributes;this._source=new TString},MO.FTagContext_instanceAlloc=function(a){this._attributes.clear()},MO.FTagContext_attributes=function(){return this._attributes},MO.FTagContext_get=function(a,b){return this._attributes.get(a,b)},MO.FTagContext_set=function(a,b){this._attributes.set(a,b)},MO.FTagContext_setBoolean=function(a,b){this._attributes.set(a,RBoolean.toString(b))},MO.FTagContext_source=function(){return this._source.toString()},MO.FTagContext_write=function(a){RString.isEmpty(a)||
this._source.append(a)},MO.FTagContext_resetSource=function(a){this._source.clear()},MO.FTagContext_dispose=function(){this._attributes.dispose();this._attributes=null;this._source.dispose();this._source=null;this.__base.FObject.dispose.call(this)};
with(MO)MO.FTagDocument=function(a){a=RClass.inherits(this,a,FObject);a._space=null;a._root=null;a.space=FTagDocument_space;a.setSpace=FTagDocument_setSpace;a.create=FTagDocument_create;a.root=FTagDocument_root;a.loadNode=FTagDocument_loadNode;a.load=FTagDocument_load;a.parse=FTagDocument_parse;a.dump=FTagDocument_dump;return a},MO.FTagDocument_space=function(){return this._space},MO.FTagDocument_setSpace=function(a){this._space=a},MO.FTagDocument_create=function(a){var b=this._space+"_",d=null,d=
RString.startsWith(a,b)?a.substring(b.length):a;a=null;switch(d){case "source":a=RClass.create(FTag);break;case "write":a=RClass.create(FTagWrite);break;case "true":a=RClass.create(FTagTrue);break;case "false":a=RClass.create(FTagFalse);break;case "equals":a=RClass.create(FTagEquals);break;case "notEquals":a=RClass.create(FTagNotEquals);break;default:throw new TError(this,"Unknown tag type. (name={1})",d);}return a},MO.FTagDocument_root=function(){return this._root},MO.FTagDocument_loadNode=function(a,
b){var d=this.create(b.nodeName);a?a.push(d):this._root=d;var f=b.attributes;if(f)for(var h=f.length,k=0;k<h;k++){var q=f[k];q.nodeName&&d.set(q.nodeName,RXml.formatText(q.value))}if(f=b.childNodes)for(h=f.length,k=0;k<h;k++)switch(q=f[k],q.nodeType){case ENodeType.Text:var w=RClass.create(FTagText);w.setText(q.nodeValue);d.push(w);break;case ENodeType.Data:w=RClass.create(FTagText);w.setText(q.data);d.push(w);break;case ENodeType.Node:this.loadNode(d,q)}},MO.FTagDocument_load=function(a){a=("<source>"+
a+"</source>").replace(new RegExp("<"+this._space+":","g"),"<"+this._space+"_");a=a.replace(new RegExp("</"+this._space+":","g"),"</"+this._space+"_");a=a.replace(RegExp(" & ","g")," &amp; ");a=a.replace(RegExp(" < ","g")," &lt; ");a=a.replace(RegExp(" > ","g")," &gt; ");a=RXml.makeString(a);this.loadNode(null,a.firstChild)},MO.FTagDocument_parse=function(a){a.resetSource();this._root.parse(a);return a.source()},MO.FTagDocument_dump=function(){var a=new TString;a.appendLine(RClass.dump(this));a.appendLine(this.root().dump(a));
return a.toString()};
with(MO)MO.FTagEquals=function(a){a=RClass.inherits(this,a,FTag);a._trimLeft=!0;a._source=null;a._value=null;a.onBegin=FTagEquals_onBegin;a.set=FTagEquals_set;a.toString=FTagEquals_toString;return a},MO.FTagEquals_onBegin=function(a){var b=!1;a=a.get(this._source);for(var d=this._value.split("|"),f=d.length,h=0;h<f;h++)if(a==d[h]){b=!0;break}return b?EResult.Continue:EResult.Skip},MO.FTagEquals_set=function(a,b){switch(a){case "source":this._source=b;return;case "value":this._value=b;return}this.__base.FTag.set.call(this,
a,b)},MO.FTagEquals_toString=function(){return"source="+this._source+", value="+this._value};
with(MO)MO.FTagFalse=function(a){a=RClass.inherits(this,a,FTag);a._trimLeft=!0;a._source=null;a.onBegin=FTagFalse_onBegin;a.set=FTagFalse_set;a.toString=FTagFalse_toString;return a},MO.FTagFalse_onBegin=function(a){a=a.get(this._source);return RBoolean.parse(a)?EResult.Skip:EResult.Continue},MO.FTagFalse_set=function(a,b){switch(a){case "source":this._source=b;return}this.__base.FTag.set.call(this,a,b)},MO.FTagFalse_toString=function(){return"source="+this._source};
with(MO)MO.FTagNotEquals=function(a){a=RClass.inherits(this,a,FTag);a._trimLeft=!0;a._source=null;a._value=null;a.onBegin=FTagNotEquals_onBegin;a.set=FTagNotEquals_set;a.toString=FTagNotEquals_toString;return a},MO.FTagNotEquals_onBegin=function(a){var b=!0;a=a.get(this._source);for(var d=this._value.split("|"),f=d.length,h=0;h<f;h++)if(a==d[h]){b=!1;break}return b?EResult.Continue:EResult.Skip},MO.FTagNotEquals_set=function(a,b){switch(a){case "source":this._source=b;return;case "value":this._value=
b;return}this.__base.FTag.set.call(this,a,b)},MO.FTagNotEquals_toString=function(){return"source="+this._source+", value="+this._value};
with(MO)MO.FTagText=function(a){a=RClass.inherits(this,a,FTag);a._text=null;a.onBegin=FTagText_onBegin;a.text=FTagText_text;a.setText=FTagText_setText;a.toString=FTagText_toString;return a},MO.FTagText_onBegin=function(a){var b=this._text;a._trimLeft&&(RString.startsWith(b,"\r")&&(b=b.substring(1)),RString.startsWith(b,"\n")&&(b=b.substring(1)));a._trimRight&&(RString.endsWith(b,"\r")&&(b=b.substring(0,b.length-1)),RString.endsWith(b,"\n")&&(b=b.substring(0,b.length-1)));a.write(b);return EResult.Skip},
MO.FTagText_text=function(){return this._text},MO.FTagText_setText=function(a){this._text=a},MO.FTagText_toString=function(){return"{"+this._text+"}"};
with(MO)MO.FTagTrue=function(a){a=RClass.inherits(this,a,FTag);a._trimLeft=!0;a._source=null;a.onBegin=FTagTrue_onBegin;a.set=FTagTrue_set;a.toString=FTagTrue_toString;return a},MO.FTagTrue_onBegin=function(a){for(var b=!1,d=this._source.split("|"),f=d.length,h=0;h<f;h++){var k=a.get(d[h]);if(RBoolean.parse(k)){b=!0;break}}return b?EResult.Continue:EResult.Skip},MO.FTagTrue_set=function(a,b){switch(a){case "source":this._source=b;return}this.__base.FTag.set.call(this,a,b)},MO.FTagTrue_toString=function(){return"source="+
this._source};with(MO)MO.FTagWrite=function(a){a=RClass.inherits(this,a,FTag);a._source=null;a.onBegin=FTagWrite_onBegin;a.set=FTagWrite_set;a.toString=FTagWrite_toString;return a},MO.FTagWrite_onBegin=function(a){var b=a.get(this._source);a.write(b);return EResult.Skip},MO.FTagWrite_set=function(a,b){switch(a){case "source":this._source=b;return}this.__base.FTag.set.call(this,a,b)},MO.FTagWrite_toString=function(){return"source="+this._source};
MO.EThreadStatus=new function(){this.Sleep=0;this.Active=1;this.Finish=2;return this};with(MO)MO.SProcessEvent=function(){this.data=this.code=this.index=null;return this};
with(MO)MO.SXmlEvent=function(){this.callback=this.outputDocument=this.inputDocument=this.parameter=this.action=this.url=this.owner=null;this.process=SXmlEvent_process;this.dispose=SXmlEvent_dispose;return this},MO.SXmlEvent_process=function(a){this.outputDocument=a.document;this.outputNode=a.root;this.owner?this.callback.call(this.owner,this):this.callback(this)},MO.SXmlEvent_dispose=function(){this.callback=this.outputDocument=this.inputDocument=this.parameter=this.action=this.url=this.owner=null};
with(MO)MO.FContent=function(a){a=RClass.inherits(this,a,FObject);a._name=null;a.name=FContent_name;return a},MO.FContent_name=function(){return this._name};
with(MO)MO.FContentConsole=function(a){a=RClass.inherits(this,a,FConsole);a._scopeCd=EScope.Local;a.connections=null;a.onLoad=FContentConsole_onLoad;a.construct=FContentConsole_construct;a.alloc=FContentConsole_alloc;a.process=FContentConsole_process;a.send=FContentConsole_send;return a},MO.FContentConsole_construct=function(){this.connections=new TObjects},MO.FContentConsole_onLoad=function(){var a=this.event;a.document=this.document;a.process();this.document=this.event=null;this._statusFree=!0},
MO.FContentConsole_alloc=function(){for(var a=null,b=this.connections,d=b.count-1;0<=d;d--){var f=b.get(d);if(f._statusFree){a=f;break}}a||(a=RClass.create(FXmlConnection),b.push(a),a.onLoad=this.onLoad);a._statusFree=!1;return a},MO.FContentConsole_process=function(a){var b=this.alloc();b.event=a;switch(a.code){case EXmlEvent.Send:b.send(a.url,a.document);break;case EXmlEvent.Receive:b.receive(a.url,a.document);break;case EXmlEvent.SyncSend:return b.syncSend(a.url,a.document);case EXmlEvent.SyncReceive:return b.syncReceive(a.url,
a.document)}},MO.FContentConsole_send=function(a,b){var d=this.alloc(),f=d.syncSend(a,b);d._statusFree=!0;return f};with(MO)MO.FContentPipeline=function(a){a=RClass.inherits(this,a,FPipeline);a._scopeCd=EScope.Global;a.scopeCd=FContentPipeline_scopeCd;return a},MO.FContentPipeline_scopeCd=function(){return this._scopeCd};
with(MO)MO.FDragConsole=function(a){a=RClass.inherits(this,a,FConsole);a._scopeCd=EScope.Local;a._activeDragable=null;a._dragables=null;a.onMouseDown=FDragConsole_onMouseDown;a.onMouseMove=FDragConsole_onMouseMove;a.onMouseUp=FDragConsole_onMouseUp;a.construct=FDragConsole_construct;a.register=FDragConsole_register;a.unregister=FDragConsole_unregister;a.clear=FDragConsole_clear;return a},MO.FDragConsole_onMouseDown=function(a){var b=a.source;b&&RClass.isClass(b,MUiDragable)&&(RWindow.setOptionSelect(!1),
this._activeDragable=b,b.onDragStart(a))},MO.FDragConsole_onMouseMove=function(a){if(this._activeDragable)this._activeDragable.onDragMove(a)},MO.FDragConsole_onMouseUp=function(a){this._activeDragable&&(RWindow.setOptionSelect(!0),this._activeDragable.onDragStop(a),this._activeDragable=null)},MO.FDragConsole_construct=function(){this.__base.FConsole.construct.call(this);this._dragables=new TObjects;RWindow.lsnsMouseDown.register(this,this.onMouseDown);RWindow.lsnsMouseMove.register(this,this.onMouseMove);
RWindow.lsnsMouseUp.register(this,this.onMouseUp)},MO.FDragConsole_register=function(a){this._dragables.push(a)},MO.FDragConsole_unregister=function(a,b){this._dragables.remove(p)},MO.FDragConsole_clear=function(){this._dragables.clear()};
with(MO)MO.FEvent=function(a){a=RClass.inherits(this,a,FObject);a._owner=null;a._callback=null;a._valid=!0;a.owner=FEvent_owner;a.setOwner=FEvent_setOwner;a.callback=FEvent_callback;a.setCallback=FEvent_setCallback;a.valid=FEvent_valid;a.setValid=FEvent_setValid;a.process=FEvent_process;return a},MO.FEvent_owner=function(){return this._owner},MO.FEvent_setOwner=function(a){this._owner=a},MO.FEvent_callback=function(){return this._callback},MO.FEvent_setCallback=function(a){this._callback=a},MO.FEvent_valid=
function(){return this._valid},MO.FEvent_setValid=function(a){this._valid=a},MO.FEvent_process=function(){if(this._valid){var a=this._owner;a?this._callback.call(a,this):this._callback(this)}};
with(MO)MO.FEventConsole=function(a){a=RClass.inherits(this,a,FConsole);a._scopeCd=EScope.Local;a._thread=null;a._interval=100;a._processEvents=null;a._events=null;a.onProcess=FEventConsole_onProcess;a.construct=FEventConsole_construct;a.register=FEventConsole_register;a.push=FEventConsole_push;a.clear=FEventConsole_clear;return a},MO.FEventConsole_onProcess=function(){var a=this._events;if(!a.isEmpty()){var b=this._processEvents;b.assign(a);a.clear();a=b.count();if(0<a){for(var d=0;d<a;d++)b.get(d).process();
b.clear()}}},MO.FEventConsole_construct=function(){this.__base.FConsole.construct.call(this);this._processEvents=new TObjects;this._events=new TObjects;var a=this._thread=RClass.create(FThread);a.setInterval(this._interval);a.lsnsProcess.register(this,this.onProcess);RConsole.find(FThreadConsole).start(a);RLogger.debug(this,"Add event thread. (thread={1})",RClass.dump(a))},MO.FEventConsole_register=function(a,b){var d=RClass.create(FEvent);d.owner=a;d.callback=b;this._events.push(d)},MO.FEventConsole_push=
function(a){var b=this._events;b.contains(a)||b.push(a)},MO.FEventConsole_clear=function(){this._events.clear()};
with(MO)MO.FHttpConsole=function(a){a=RClass.inherits(this,a,FConsole);a._scopeCd=EScope.Local;a._pool=null;a.onLoad=FHttpConsole_onLoad;a.construct=FHttpConsole_construct;a.alloc=FHttpConsole_alloc;a.send=FHttpConsole_send;a.dispose=FHttpConsole_dispose;return a},MO.FHttpConsole_onLoad=function(a){this._pool.free(a)},MO.FHttpConsole_construct=function(){this.__base.FConsole.construct.call(this);this._pool=RClass.create(FObjectPool)},MO.FHttpConsole_alloc=function(){var a=this._pool;if(!a.hasFree()){var b=
RClass.create(FHttpConnection);b._asynchronous=!0;this._pool.push(b)}b=a.alloc();b.clearLoadListeners();b.addLoadListener(this,this.onLoad);return b},MO.FHttpConsole_send=function(a,b){var d=this.alloc();d.send(a,b);return d},MO.FHttpConsole_dispose=function(){this.__base.FConsole.dispose.call(this)};
with(MO)MO.FIdleConsole=function(a){a=RClass.inherits(this,a,FConsole);a.scope=EScope.Page;a.register=FIdleConsole_register;return a},MO.FIdleConsole_register=function(a,b){this.active=new TActive(a,b);this.active.interval=100;RConsole.find(FActiveConsole).push(this.active)},MO.FIdleConsole_construct=function(){};
with(MO)MO.FLoggerConsole=function(a){a=RClass.inherits(this,a,FConsole);a.scope=EScope.Page;a.iLogger=null;a.onKeyDown=FLoggerConsole_onKeyDown;a.construct=FLoggerConsole_construct;a.connect=FLoggerConsole_connect;a.disconnect=FLoggerConsole_disconnect;a.output=FLoggerConsole_output;return a},MO.FLoggerConsole_onKeyDown=function(a){a.shiftKey&&a.ctrlKey&&EKey.L==a.keyCode&&this.connect()},MO.FLoggerConsole_construct=function(){this.base.FConsole.construct.call(this);RWindow.lsnsKeyDown.register(this,
this.onKeyDown)},MO.FLoggerConsole_connect=function(){},MO.FLoggerConsole_disconnect=function(){this.iLogger=null},MO.FLoggerConsole_output=function(a,b,d,f,h,k){this.iLogger&&(b=RClass.dump(b),f&&(b+=" ("+f+"ms)"),a=a+" ["+RString.rpad(b,36)+"] ",a=k?a+(RString.rpad(h,120)+" ["+k+"]"):a+h,this.iLogger.Output(a))},MO.FLoggerConsole_xml=function(){this.environment||this.connect();return this.environment?this.environment.xml():null};
with(MO)MO.FMonitorConsole=function(a){a=RClass.inherits(this,a,FConsole);a.scope=EScope.Global;a.working=!1;a.interval=10;a.intervalId=null;a.monitors=new TList;a.hWindow=null;a.doInterval=FMonitorConsole_doInterval;a.push=FMonitorConsole_push;a.process=FMonitorConsole_process;a.processAll=FMonitorConsole_processAll;a.startup=FMonitorConsole_startup;a.wait=FMonitorConsole_wait;a.release=FMonitorConsole_release;return a},MO.FMonitorConsole_push=function(a){this.startup();a.id=this.monitors.sync(a);
a.name="T:"+RString.lpad(a.id,4,"0");a.status=EMonitor.Active},MO.FMonitorConsole_process=function(a){if(a)switch(a.status){case EMonitor.Active:a.process(this.interval);break;case EMonitor.Cancel:this.monitors.removeItem(a)}},MO.FMonitorConsole_processAll=function(){this.working=!0;for(var a=this.monitors,b=0;b<a.count;b++)this.process(a.get(b));this.working=!1},MO.FMonitorConsole_doInterval=function(){var a=RGlobal.get(FMonitorConsole);a&&!a.working&&a.processAll()},MO.FMonitorConsole_startup=function(){if(!this.hWindow){this.hWindow=
window;debugger;this.intervalId=this.hWindow.setInterval(this.doInterval,this.interval)}},MO.FMonitorConsole_wait=function(a){},MO.FMonitorConsole_release=function(){this.hWindow&&this.intervalId&&this.hWindow.clearInterval(this.intervalId)};
with(MO)MO.FMouseConsole=function(a){a=RClass.inherits(this,a,FConsole);a._scopeCd=EScope.Local;a._activeCapture=null;a.onMouseDown=FMouseConsole_onMouseDown;a.onMouseMove=FMouseConsole_onMouseMove;a.onMouseUp=FMouseConsole_onMouseUp;a.construct=FMouseConsole_construct;a.captureStart=FMouseConsole_captureStart;a.capture=FMouseConsole_capture;a.captureStop=FMouseConsole_captureStop;a.register=FMouseConsole_register;a.unregister=FMouseConsole_unregister;a.clear=FMouseConsole_clear;return a},MO.FMouseConsole_onMouseDown=
function(a){var b=RHtml.searchLinker(a.hSource,MMouseCapture);b&&b.testMouseCapture()&&(this._activeCapture=b,this.captureStart(a))},MO.FMouseConsole_onMouseMove=function(a){this._activeCapture&&this.capture(a)},MO.FMouseConsole_onMouseUp=function(a){this._activeCapture&&this.captureStop(a)},MO.FMouseConsole_construct=function(){this.__base.FConsole.construct.call(this);RWindow.lsnsMouseDown.register(this,this.onMouseDown);RWindow.lsnsMouseMove.register(this,this.onMouseMove);RWindow.lsnsMouseUp.register(this,
this.onMouseUp)},MO.FMouseConsole_captureStart=function(a){var b=this._activeCapture;b&&(RWindow.setOptionSelect(!1),b.onMouseCaptureStart(a))},MO.FMouseConsole_capture=function(a){var b=this._activeCapture;if(b)if(b.testMouseCapture())b.onMouseCapture(a);else this.captureStop(a)},MO.FMouseConsole_captureStop=function(a){var b=this._activeCapture;b&&(b.onMouseCaptureStop(a),this._activeCapture=null);RWindow.setOptionSelect(!0)},MO.FMouseConsole_register=function(a){},MO.FMouseConsole_unregister=function(a){},
MO.FMouseConsole_clear=function(){};with(MO)MO.FPipeline=function(a){a=RClass.inherits(this,a,FObject);a._code=null;a.code=FPipeline_code;return a},MO.FPipeline_code=function(){return this._code};
with(MO)MO.FProcess=function(a){a=RClass.inherits(this,a,FObject);a._name=null;a._source=null;a._worker=null;a._events=null;a.ohMessage=FProcess_ohMessage;a.onMessage=FProcess_onMessage;a.construct=FProcess_construct;a.name=FProcess_name;a.start=FProcess_start;a.process=FProcess_process;return a},MO.FProcess_ohMessage=function(){this.__linker.onMessage(this)},MO.FProcess_onMessage=function(a){},MO.FProcess_name=function(){return this._name},MO.FProcess_construct=function(){this.__base.FObject.construct.call(this);
this._events=new TObjects},MO.FProcess_start=function(a){if(this._worker)throw new TError(this,"Process is already start.");this._source=a;a=this._worker=new Worker(a);a.__linker=this;a.onmessage=this.ohMessage},MO.FProcess_process=function(a){var b=this._events,d=b.count();b.push(a);b=new SProcessEvent;b.index=d;b.code=a.code();b.data=a.data();this._worker.postMessage(b)};
with(MO)MO.FProcessConsole=function(a){a=RClass.inherits(this,a,FConsole);a._scopeCd=EScope.Local;a.connections=null;a.onLoad=FProcessConsole_onLoad;a.construct=FProcessConsole_construct;a.alloc=FProcessConsole_alloc;a.process=FProcessConsole_process;a.send=FProcessConsole_send;return a},MO.FProcessConsole_construct=function(){this.connections=new TObjects},MO.FProcessConsole_onLoad=function(){var a=this.event;a.document=this.document;a.process();this.document=this.event=null;this._statusFree=!0},
MO.FProcessConsole_alloc=function(){for(var a=null,b=this.connections,d=b.count-1;0<=d;d--){var f=b.get(d);if(f._statusFree){a=f;break}}a||(a=RClass.create(FXmlConnection),b.push(a),a.onLoad=this.onLoad);a._statusFree=!1;return a},MO.FProcessConsole_process=function(a){var b=this.alloc();b.event=a;switch(a.code){case EXmlEvent.Send:b.send(a.url,a.document);break;case EXmlEvent.Receive:b.receive(a.url,a.document);break;case EXmlEvent.SyncSend:return b.syncSend(a.url,a.document);case EXmlEvent.SyncReceive:return b.syncReceive(a.url,
a.document)}},MO.FProcessConsole_send=function(a,b){var d=this.alloc(),f=d.syncSend(a,b);d._statusFree=!0;return f};
with(MO)MO.FProcessEvent=function(a){a=RClass.inherits(this,a,FObject);a._code=null;a._data=null;a._listeners=null;a.code=FProcessEvent_code;a.setCode=FProcessEvent_setCode;a.data=FProcessEvent_data;a.setData=FProcessEvent_setData;a.register=FProcessEvent_register;return a},MO.FProcessEvent_name=function(){return this._name},MO.FProcessEvent_code=function(){return this._code},MO.FProcessEvent_setCode=function(a){this._code=a},MO.FProcessEvent_data=function(){return this._data},MO.FProcessEvent_setData=
function(a){this._data=a},MO.FProcessEvent_register=function(a,b){this._listeners||(this._listeners=new TListeners);this._listeners.register(a,b)};
with(MO)MO.FProcessor=function(a){a=RClass.inherits(this,a,FObject);a._name=null;a._source=null;a._worker=null;a._events=null;a.ohMessage=FProcessor_ohMessage;a.onMessage=FProcessor_onMessage;a.construct=FProcessor_construct;a.name=FProcessor_name;a.start=FProcessor_start;a.process=FProcessor_process;return a},MO.FProcessor_ohMessage=function(){this.__linker.onMessage(this)},MO.FProcessor_onMessage=function(a){},MO.FProcessor_name=function(){return this._name},MO.FProcessor_construct=function(){this.__base.FObject.construct.call(this);
this._events=new TObjects},MO.FProcessor_start=function(a){if(this._worker)throw new TError(this,"Process is already start.");this._source=a;a=this._worker=new Worker(a);a.__linker=this;a.onmessage=this.ohMessage},MO.FProcessor_process=function(a){var b=this._events,d=b.count();b.push(a);b=new SProcessEvent;b.index=d;b.code=a.code();b.data=a.data();this._worker.postMessage(b)};
with(MO)MO.FProcessServer=function(a){a=RClass.inherits(this,a,FObject);a._name=null;a._handle=null;a._processors=null;a.ohInterval=FProcessServer_ohInterval;a.onInterval=FProcessServer_onInterval;a.ohMessage=FProcessServer_ohMessage;a.onMessage=FProcessServer_onMessage;a.construct=FProcessServer_construct;a.name=FProcessServer_name;a.registerProcessor=FProcessServer_registerProcessor;a.unregisterProcessor=FProcessServer_unregisterProcessor;a.send=FProcessServer_send;a.process=FProcessServer_process;
return a},MO.FProcessServer_ohInterval=function(){FProcessServer.__linker.onInterval()},MO.FProcessServer_onInterval=function(){},MO.FProcessServer_ohMessage=function(a){FProcessServer.__linker.onMessage(a.data)},MO.FProcessServer_onMessage=function(a){console.log("messgae",this,a)},MO.FProcessServer_construct=function(){this.__base.FObject.construct.call(this);this._processors=new TDictionary},MO.FProcessServer_name=function(){return this._name},MO.FProcessServer_registerProcessor=function(a,b){this._processors.set(a,
b)},MO.FProcessServer_unregisterProcessor=function(a){this._processors.set(a,null)},MO.FProcessServer_send=function(a){postMessage(a)},MO.FProcessServer_process=function(){onmessage=this.ohMessage;FProcessServer.__linker=this};with(MO)MO.FStatistics=function(a){a=RClass.inherits(this,a,FObject);a._code=null;a.reset=FStatistics_reset;a.resetFrame=FStatistics_resetFrame;return a},MO.FStatistics_reset=function(){},MO.FStatistics_resetFrame=function(){};
with(MO)MO.FStatisticsConsole=function(a){a=RClass.inherits(this,a,FConsole);a._scopeCd=EScope.Local;a._statisticses=null;a.construct=FStatisticsConsole_construct;a.register=FStatisticsConsole_register;a.unregister=FStatisticsConsole_unregister;a.find=FStatisticsConsole_find;a.statisticses=FStatisticsConsole_statisticses;a.reset=FStatisticsConsole_reset;a.resetFrame=FStatisticsConsole_resetFrame;return a},MO.FStatisticsConsole_construct=function(){this._statisticses=new TDictionary},MO.FStatisticsConsole_register=
function(a,b){this._statisticses.set(a,b)},MO.FStatisticsConsole_unregister=function(a){return this._statisticses.remove(a)},MO.FStatisticsConsole_find=function(a){return this._statisticses.get(a)},MO.FStatisticsConsole_statisticses=function(){return this._statisticses},MO.FStatisticsConsole_reset=function(a){a=this._statisticses;for(var b=a.count()-1;0<=b;b--)a.getAt(b).reset()},MO.FStatisticsConsole_resetFrame=function(a,b){for(var d=this._statisticses,f=d.count()-1;0<=f;f--)d.getAt(f).resetFrame()};
with(MO)MO.FThread=function(a){a=RClass.inherits(this,a,FObject,MListenerProcess);a._name=null;a._statusCd=EThreadStatus.Sleep;a._interval=100;a._delay=0;a.construct=FThread_construct;a.name=FThread_name;a.statusCd=FThread_statusCd;a.interval=FThread_interval;a.setInterval=FThread_setInterval;a.start=FThread_start;a.stop=FThread_stop;a.process=FThread_process;return a},MO.FThread_construct=function(){this.__base.FObject.construct.call(this)},MO.FThread_name=function(){return this._name},MO.FThread_statusCd=
function(){return this._statusCd},MO.FThread_interval=function(){return this._interval},MO.FThread_setInterval=function(a){this._interval=a},MO.FThread_start=function(){this._statusCd=EThreadStatus.Active},MO.FThread_stop=function(){this._statusCd=EThreadStatus.Finish},MO.FThread_process=function(a){0>=this._delay?(this.processProcessListener(this),this._delay=this._interval):this._delay-=a};
with(MO)MO.FThreadConsole=function(a){a=RClass.inherits(this,a,FConsole);a._scopeCd=EScope.Local;a._active=!0;a._interval=5;a._threads=null;a._hWindow=null;a._hIntervalId=null;a.ohInterval=FThreadConsole_ohInterval;a.construct=FThreadConsole_construct;a.push=FThreadConsole_push;a.start=FThreadConsole_start;a.process=FThreadConsole_process;a.processAll=FThreadConsole_processAll;a.dispose=FThreadConsole_dispose;return a},MO.FThreadConsole_ohInterval=function(){RConsole.get(FThreadConsole).processAll()},
MO.FThreadConsole_push=function(a){this._threads.push(a)},MO.FThreadConsole_start=function(a){a.start();this._threads.push(a)},MO.FThreadConsole_construct=function(){this.__base.FConsole.construct.call(this);this._threads=new TObjects;this._hWindow=window;this._hIntervalId=this._hWindow.setInterval(this.ohInterval,this._interval)},MO.FThreadConsole_process=function(a){if(a)switch(a.statusCd()){case EThreadStatus.Active:a.process(this._interval);break;case EThreadStatus.Finish:a.dispose(),this._threads.remove(a)}},
MO.FThreadConsole_processAll=function(){if(this._active)for(var a=this._threads,b=a.count(),d=0;d<b;d++){var f=a.get(d);this.process(f)}},MO.FThreadConsole_dispose=function(){var a=this._hWindow;if(a){var b=this._hIntervalId;b&&(a.clearInterval(b),this._hIntervalId=null);this._hWindow=null}};
with(MO)MO.FXmlConsole=function(a){a=RClass.inherits(this,a,FConsole);a._scopeCd=EScope.Local;a._connections=null;a._caches=null;a.onLoad=FXmlConsole_onLoad;a.construct=FXmlConsole_construct;a.alloc=FXmlConsole_alloc;a.send=FXmlConsole_send;a.sendAsync=FXmlConsole_sendAsync;a.load=FXmlConsole_load;a.process=FXmlConsole_process;return a},MO.FXmlConsole_construct=function(){this._connections=new TObjects;this._caches=new TDictionary},MO.FXmlConsole_onLoad=function(a){debugger},MO.FXmlConsole_alloc=
function(){for(var a=null,b=this._connections,d=b.count-1;0<=d;d--){var f=b.get(d);if(f._statusFree){a=f;break}}a||(a=RClass.create(FXmlConnection),b.push(a),a.onLoad=this.onLoad);a._statusFree=!1;a.clearLoadListeners();return a},MO.FXmlConsole_send=function(a,b){var d=this.alloc();d._asynchronous=!1;var f=d.send(a,b);d._statusFree=!0;return f},MO.FXmlConsole_sendAsync=function(a,b,d){var f=this.alloc();f._asynchronous=!0;f._parameters=d;f.send(a,b);return f},MO.FXmlConsole_load=function(a,b,d){var f=
this._caches.get(a);if(f)return f;var h=this.alloc();h._asynchronous=!0;h._parameters=d;f=h._cache=RClass.create(FXmlData);h.send(a,b);this._caches.set(a,f);return f},MO.FXmlConsole_process=function(a){if(a.constructor!=SXmlEvent)throw new TError("Parameter type is invalid.");var b=this.alloc();b._asynchronous=!0;b.send(a.url,a.inputDocument);b.addLoadListener(a,a.process);return b};with(MO)MO.MCanvasObject=function(a){a=RClass.inherits(this,a);a.htmlCanvas=RMethod.virtual(a,"htmlCanvas");return a};
with(MO)MO.MGraphicObject=function(a){a=RClass.inherits(this,a);a._graphicContext=null;a.graphicContext=MGraphicObject_graphicContext;a.linkGraphicContext=MGraphicObject_linkGraphicContext;a.dispose=MGraphicObject_dispose;return a},MO.MGraphicObject_graphicContext=function(){return this._graphicContext},MO.MGraphicObject_linkGraphicContext=function(a){if(RClass.isClass(a,FGraphicContext))this._graphicContext=a;else if(RClass.isClass(a,MGraphicObject))this._graphicContext=a._graphicContext;else throw new TError(this,
"Link graphic context failure. (context={1})",a);},MO.MGraphicObject_dispose=function(){this._graphicContext=null};with(MO)MO.MGraphicRenderable=function(a){a=RClass.inherits(this,a,FObject);a.process=RMethod.empty;return a};
with(MO)MO.FFloatStream=function(a){a=RClass.inherits(this,a,FObject);a._length=0;a._memory=null;a._position=0;a.construct=FFloatStream_construct;a.length=FFloatStream_length;a.setLength=FFloatStream_setLength;a.memory=FFloatStream_memory;a.writeFloat4=FFloatStream_writeFloat4;a.writeColor4=FFloatStream_writeColor4;a.reset=FFloatStream_reset;a.clear=FFloatStream_clear;a.dispose=FFloatStream_dispose;return a},MO.FFloatStream_construct=function(){this.__base.FObject.construct.call(this)},MO.FFloatStream_length=
function(){return this._length},MO.FFloatStream_setLength=function(a){this._length=a;this._memory=new Float32Array(a)},MO.FFloatStream_memory=function(){return this._memory},MO.FFloatStream_writeFloat4=function(a,b,d,f){this._memory[this._position++]=a;this._memory[this._position++]=b;this._memory[this._position++]=d;this._memory[this._position++]=f},MO.FFloatStream_writeColor4=function(a){this.writeFloat4(a.red,a.green,a.blue,a.alpha)},MO.FFloatStream_reset=function(){this._position=0},MO.FFloatStream_clear=
function(){this._position=0},MO.FFloatStream_dispose=function(){this._memory=null;this.__base.FObject.dispose.call(this)};with(MO)MO.FGraphicContext=function(a){a=RClass.inherits(this,a,FObject,MGraphicObject);a._hCanvas=null;a.construct=FGraphicContext_construct;a.linkCanvas=RMethod.virtual(a,"linkCanvas");a.dispose=FGraphicContext_dispose;return a},MO.FGraphicContext_construct=function(){this.__base.FObject.construct.call(this)},MO.FGraphicContext_dispose=function(){this._hCanvas=null;this.__base.FObject.dispose.call(this)};
with(MO)MO.FG2dContext=function(a){a=RClass.inherits(this,a,FGraphicContext);a._native=null;a.construct=FG2dContext_construct;a.linkCanvas=FG2dContext_linkCanvas;a.drawLine=FG2dContext_drawLine;a.drawRecrangle=FG2dContext_drawRecrangle;a.drawText=FG2dContext_drawText;a.drawImage=FG2dContext_drawImage;a.fillRecrangle=FG2dContext_fillRecrangle;a.dispose=FG2dContext_dispose;return a},MO.FG2dContext_construct=function(){this.__base.FGraphicContext.construct.call(this)},MO.FG2dContext_linkCanvas=function(a){this._hCanvas=
a;this._native=a.getContext("2d")},MO.FG2dContext_drawLine=function(a,b,d,f){var h=this._native;h.moveTo(a,b);h.lineTo(d,f);h.stroke()},MO.FG2dContext_drawRecrangle=function(a,b,d,f){var h=this._native;h.moveTo(a,b);h.lineTo(d,b);h.lineTo(d,f);h.lineTo(a,f);h.lineTo(a,b);h.stroke()},MO.FG2dContext_drawText=function(a,b,d){this._native.fillText(d,a,b)},MO.FG2dContext_drawImage=function(a,b,d){this._native.drawImage(a,0,0)},MO.FG2dContext_fillRecrangle=function(a,b,d,f){var h=this._native;h.beginPath();
h.moveTo(a,b);h.lineTo(d,b);h.lineTo(d,f);h.lineTo(a,f);h.lineTo(a,b);h.closePath();h.fill()},MO.FG2dContext_dispose=function(){this._native=null;this.__base.FGraphicContext.dispose.call(this)};
with(MO)MO.FG2dContext=function(a){a=RClass.inherits(this,a,FGraphicContext);a._size=null;a.construct=FG2dContext_construct;a.linkCanvas=FG2dContext_linkCanvas;a.size=FG2dContext_size;a.dispose=FG2dContext_dispose;return a},MO.FG2dContext_construct=function(){this.__base.FGraphicContext.construct.call(this);this._size=new SSize2},MO.FG2dContext_linkCanvas=function(a){this._size.set(a.width,a.height)},MO.FG2dContext_size=function(){return this._size},MO.FG2dContext_dispose=function(){this._size=RObject.dispose(this._size);
this.__base.FGraphicContext.dispose.call(this)};
with(MO)MO.FG2dCanvasContext=function(a){a=RClass.inherits(this,a,FG2dContext);a._native=null;a.construct=FG2dCanvasContext_construct;a.linkCanvas=FG2dCanvasContext_linkCanvas;a.clear=FG2dCanvasContext_clear;a.drawLine=FG2dCanvasContext_drawLine;a.drawRectangle=FG2dCanvasContext_drawRectangle;a.drawText=FG2dCanvasContext_drawText;a.drawImage=FG2dCanvasContext_drawImage;a.fillRectangle=FG2dCanvasContext_fillRectangle;a.toBytes=FG2dCanvasContext_toBytes;return a},MO.FG2dCanvasContext_construct=function(){this.__base.FG2dContext.construct.call(this)},
MO.FG2dCanvasContext_linkCanvas=function(a){this.__base.FG2dContext.linkCanvas.call(this,a);if(a.getContext){var b=a.getContext("2d");if(!b)throw new TError(this,"Current browser can't support Context2D technique.");this._native=b}this._hCanvas=a},MO.FG2dCanvasContext_clear=function(a,b,d,f,h){b=this._native;a=this._size;b.clearRect(0,0,a.width,a.height)},MO.FG2dCanvasContext_drawLine=function(a,b,d,f,h,k){var q=this._native;q.strokeStyle=h;q.lineWidth=k;q.moveTo(a,b);q.lineTo(d,f);q.stroke()},MO.FG2dCanvasContext_drawRectangle=
function(a,b,d,f,h,k){var q=this._native;q.strokeStyle=h;q.lineWidth=k;q.strokeRect(a,b,d,f)},MO.FG2dCanvasContext_drawText=function(a,b,d,f){var h=this._native;h.fillStyle=f;h.fillText(a,b,d)},MO.FG2dCanvasContext_drawImage=function(a,b,d){var f=this._native,h=null;if("IMG"==a.tagName)h=a;else if(RClass.isClass(a,FImage))h=a.image();else throw new TError(this,"Unknown data type");f.drawImage(h,b,d,this._size.width,this._size.height)},MO.FG2dCanvasContext_fillRectangle=function(a,b,d,f,h){var k=this._native;
k.fillStyle=h;k.fillRect(a,b,d,f)},MO.FG2dCanvasContext_toBytes=function(){var a=this._size;return this._native.getImageData(0,0,a.width,a.height)};MO.EG3dMaterialMap=new function(){this.AmbientColor=0;this.DiffuseColor=1;this.SpecularColor=2;this.ReflectColor=3;this.EmissiveColor=4;this.Count=8;return this};
MO.EG3dRegionParameter=new function(){this.Unknown=0;this.CameraPosition=1;this.CameraDirection=2;this.CameraViewMatrix=3;this.CameraProjectionMatrix=4;this.CameraViewProjectionMatrix=5;this.LightPosition=6;this.LightDirection=7;this.LightViewMatrix=8;this.LightProjectionMatrix=9;this.LightViewProjectionMatrix=10;this.LightInfo=11;return this};
MO.EG3dTechniqueMode=new function(){this.Color="color";this.Ambient="ambient";this.DiffuseLevel="diffuse.level";this.DiffuseColor="diffuse.color";this.SpecularLevel="specular.level";this.SpecularColor="specular.color";this.Reflect="reflect";this.Emissive="emissive";this.Result="result";return this};
with(MO)MO.MG3dRegion=function(a){a=RClass.inherits(this,a);a._changed=!1;a._spaceName=null;a._technique=null;a._techniquePass=null;a._camera=null;a._projection=null;a._directionalLight=null;a._lights=null;a._allRenderables=null;a._renderables=null;a._cameraPosition=null;a._cameraDirection=null;a._cameraViewMatrix=null;a._cameraProjectionMatrix=null;a._cameraViewProjectionMatrix=null;a._lightPosition=null;a._lightDirection=null;a._lightViewMatrix=null;a._lightProjectionMatrix=null;a._lightViewProjectionMatrix=
null;a._lightInfo=null;a._materialMap=null;a.construct=MG3dRegion_construct;a.isChanged=MG3dRegion_isChanged;a.spaceName=MG3dRegion_spaceName;a.technique=MG3dRegion_technique;a.setTechnique=MG3dRegion_setTechnique;a.techniquePass=MG3dRegion_techniquePass;a.setTechniquePass=MG3dRegion_setTechniquePass;a.camera=MG3dRegion_camera;a.directionalLight=MG3dRegion_directionalLight;a.lights=MG3dRegion_lights;a.materialMap=MG3dRegion_materialMap;a.allRenderables=MG3dRegion_allRenderables;a.renderables=MG3dRegion_renderables;
a.pushRenderable=MG3dRegion_pushRenderable;a.setup=MG3dRegion_setup;a.change=MG3dRegion_change;a.prepare=MG3dRegion_prepare;a.reset=MG3dRegion_reset;a.calculate=MG3dRegion_calculate;a.update=MG3dRegion_update;a.dispose=MG3dRegion_dispose;return a},MO.MG3dRegion_construct=function(){this._lights=new TObjects;this._renderables=new TObjects;this._allRenderables=new TObjects;this._cameraPosition=new SPoint3;this._cameraDirection=new SVector3;this._cameraViewMatrix=new SMatrix3d;this._cameraProjectionMatrix=
new SMatrix3d;this._cameraViewProjectionMatrix=new SMatrix3d;this._lightPosition=new SPoint3;this._lightDirection=new SVector3;this._lightViewMatrix=new SMatrix3d;this._lightProjectionMatrix=new SMatrix3d;this._lightViewProjectionMatrix=new SMatrix3d;this._lightInfo=new SVector4},MO.MG3dRegion_isChanged=function(){return this._changed},MO.MG3dRegion_spaceName=function(){return this._spaceName},MO.MG3dRegion_technique=function(){return this._technique},MO.MG3dRegion_setTechnique=function(a){this._technique=
a},MO.MG3dRegion_techniquePass=function(){return this._techniquePass},MO.MG3dRegion_setTechniquePass=function(a,b){this._techniquePass=a;this._spaceName=a.fullCode();this._finish=b},MO.MG3dRegion_camera=function(){return this._camera},MO.MG3dRegion_directionalLight=function(){return this._directionalLight},MO.MG3dRegion_lights=function(){return this._lights},MO.MG3dRegion_materialMap=function(){return this._materialMap},MO.MG3dRegion_allRenderables=function(a){return this._allRenderables},MO.MG3dRegion_renderables=
function(a){return this._renderables},MO.MG3dRegion_pushRenderable=function(a){this._renderables.push(a);this._allRenderables.push(a)},MO.MG3dRegion_setup=function(){},MO.MG3dRegion_change=function(){this._changed=!0},MO.MG3dRegion_prepare=function(){this._changed=!1;var a=this._camera,b=a.projection();a.updateFrustum();this._cameraPosition.assign(a.position());this._cameraDirection.assign(a.direction());this._cameraViewMatrix.assign(a.matrix());this._cameraProjectionMatrix.assign(b.matrix());this._cameraViewProjectionMatrix.assign(a.matrix());
this._cameraViewProjectionMatrix.append(b.matrix());a=this._directionalLight.camera();a.position();b=a.projection();this._lightPosition.assign(a.position());this._lightDirection.assign(a.direction());this._lightViewMatrix.assign(a.matrix());this._lightProjectionMatrix.assign(b.matrix());this._lightViewProjectionMatrix.assign(a.matrix());this._lightViewProjectionMatrix.append(b.matrix());this._lightInfo.set(0,0,b._znear,1/b.distance());this._allRenderables.clear()},MO.MG3dRegion_reset=function(){this._renderables.clear()},
MO.MG3dRegion_calculate=function(a){switch(a){case EG3dRegionParameter.CameraPosition:return this._cameraPosition;case EG3dRegionParameter.CameraDirection:return this._cameraDirection;case EG3dRegionParameter.CameraViewMatrix:return this._cameraViewMatrix;case EG3dRegionParameter.CameraProjectionMatrix:return this._cameraProjectionMatrix;case EG3dRegionParameter.CameraViewProjectionMatrix:return this._cameraViewProjectionMatrix;case EG3dRegionParameter.LightPosition:return this._lightPosition;case EG3dRegionParameter.LightDirection:return this._lightDirection;
case EG3dRegionParameter.LightViewMatrix:return this._lightViewMatrix;case EG3dRegionParameter.LightProjectionMatrix:return this._lightProjectionMatrix;case EG3dRegionParameter.LightViewProjectionMatrix:return this._lightViewProjectionMatrix;case EG3dRegionParameter.LightInfo:return this._lightInfo}throw new TError(this,"Unknown parameter type. (type_cd={1})",a);},MO.MG3dRegion_update=function(){for(var a=this._renderables,b=a.count(),d=0;d<b;d++)a.getAt(d).update(this)},MO.MG3dRegion_dispose=function(){this._renderables=
RObject.free(this._renderables);this._allRenderables=RObject.free(this._allRenderables)};
with(MO)MO.MG3dRenderable=function(a){a=RClass.inherits(this,a,MGraphicRenderable);a._optionMerge=!1;a._currentMatrix=null;a._matrix=null;a._material=null;a._activeInfo=null;a._infos=null;a.construct=MG3dRenderable_construct;a.currentMatrix=MG3dRenderable_currentMatrix;a.matrix=MG3dRenderable_matrix;a.material=MG3dRenderable_material;a.setMaterial=MG3dRenderable_setMaterial;a.activeEffect=MG3dRenderable_activeEffect;a.activeInfo=MG3dRenderable_activeInfo;a.effectFind=MG3dRenderable_effectFind;a.effectSet=
MG3dRenderable_effectSet;a.infos=MG3dRenderable_infos;a.selectInfo=MG3dRenderable_selectInfo;a.resetInfos=MG3dRenderable_resetInfos;a.testVisible=RMethod.emptyTrue;a.update=RMethod.empty;a.dispose=MG3dRenderable_dispose;return a},MO.MG3dRenderable_construct=function(){this._currentMatrix=new SMatrix3d;this._matrix=new SMatrix3d},MO.MG3dRenderable_currentMatrix=function(){return this._currentMatrix},MO.MG3dRenderable_matrix=function(){return this._matrix},MO.MG3dRenderable_activeEffect=function(){var a=
this._activeInfo;return a?a.effect:null},MO.MG3dRenderable_activeInfo=function(){return this._activeInfo},MO.MG3dRenderable_effectFind=function(a){var b=this._infos;return b&&(a=b.get(a))?a.effect:null},MO.MG3dRenderable_effectSet=function(a,b){var d=this.infos(),f=d.get(a);f||(f=new SG3dRenderableInfo,d.set(a,f));f.effect=b},MO.MG3dRenderable_infos=function(){var a=this._infos;a||(a=this._infos=new TDictionary);return a},MO.MG3dRenderable_selectInfo=function(a){var b=this.infos(),d=b.get(a);d||(d=
new SG3dRenderableInfo,b.set(a,d));return this._activeInfo=d},MO.MG3dRenderable_resetInfos=function(){var a=this._infos;if(a)for(var b=a.count()-1;0<=b;b--)a.at(b).reset()},MO.MG3dRenderable_material=function(){return this._material},MO.MG3dRenderable_setMaterial=function(a){this._material=a},MO.MG3dRenderable_dispose=function(){this._currentMatrix=RObject.dispose(this._currentMatrix);this._matrix=RObject.dispose(this._matrix);this._material=RObject.dispose(this._material);this._activeInfo=null;this._infos=
RObject.dispose(this._infos)};
with(MO)MO.SG3dEffectInfo=function(){this.supportInstance=this.optionNormalCompress=this.optionNormalInvert=this.optionAlphaTest=this.blendTargetMode=this.blendSourceMode=this.optionBlendMode=this.optionDepthWrite=this.depthModeCd=this.optionDepthTest=this.cullModeCd=this.optionCullMode=this.fillModeCd=this.mergeCount=this.optionMerge=this.techniqueModeCode=this.techniqueCode=this.code=null;this.vertexCount=0;this.vertexSkeleton=this.vertexNormalFull=this.vertexNormal=this.vertexCoord=this.vertexColor=
null;this.vertexBoneCount=0;this.fragmentHeight=this.fragmentEmissive=this.fragmentRefract=this.fragmentReflect=this.fragmentLight=this.fragmentEnvironment=this.fragmentSpecularView=this.fragmentSpecularLevel=this.fragmentSpecularColor=this.fragmentDiffuseView=this.fragmentDiffuse=this.fragmentAmbient=this.fragmentBump=this.fragmentAlpha=null;this.attributes=new TArray;this.samplers=new TArray;this.attributeContains=SG3dEffectInfo_attributeContains;this.samplerContains=SG3dEffectInfo_samplerContains;
this.reset=SG3dEffectInfo_reset;this.reset();return this},MO.SG3dEffectInfo_attributeContains=function(a){return this.attributes.contains(a)},MO.SG3dEffectInfo_samplerContains=function(a){return this.samplers.contains(a)},MO.SG3dEffectInfo_reset=function(){this.code=null;this.optionMerge=!1;this.mergeCount=0;this.fillModeCd=EG3dFillMode.Fill;this.optionCullMode=!0;this.cullModeCd=EG3dCullMode.Front;this.optionDepthTest=!0;this.depthModeCd=EG3dDepthMode.Less;this.optionDepthWrite=!0;this.optionBlendMode=
!1;this.blendSourceMode=EG3dBlendMode.SourceAlpha;this.blendTargetMode=EG3dBlendMode.OneMinusSourceAlpha;this.optionNormalInvert=this.optionAlphaTest=!1;this.optionNormalCompress=!0;this.supportInstance=!1;this.vertexCount=0;this.vertexSkeleton=this.vertexNormalFull=this.vertexNormal=this.vertexCoord=this.vertexColor=!1;this.vertexBoneCount=0;this.fragmentHeight=this.fragmentEmissive=this.fragmentRefract=this.fragmentReflect=this.fragmentLight=this.fragmentEnvironment=this.fragmentSpecularView=this.fragmentSpecularLevel=
this.fragmentSpecularColor=this.fragmentDiffuseView=this.fragmentDiffuse=this.fragmentAmbient=this.fragmentBump=this.fragmentAlpha=!1;this.attributes.clear();this.samplers.clear()};
with(MO)MO.SG3dMaterialInfo=function(a){a||(a=this);a.effectCode="automatic";a.optionDepth=null;a.optionDouble=null;a.optionNormalInvert=null;a.optionShadow=null;a.optionShadowSelf=null;a.optionAlpha=null;a.alphaBase=1;a.alphaRate=1;a.alphaLevel=1;a.alphaMerge=1;a.optionColor=null;a.colorMin=0;a.colorMax=1;a.colorBalance=.5;a.colorRate=1;a.optionVertex=null;a.vertexColor=new SColor4;a.optionAmbient=null;a.ambientColor=new SColor4;a.ambientShadow=1;a.optionDiffuse=null;a.diffuseColor=new SColor4;a.diffuseShadow=
1;a.optionDiffuseView=null;a.diffuseViewColor=new SColor4;a.diffuseViewShadow=1;a.optionSpecular=null;a.specularColor=new SColor4;a.specularBase=1;a.specularLevel=1;a.specularAverage=1;a.specularShadow=1;a.specularInfo=null;a.optionSpecularView=null;a.specularViewColor=new SColor4;a.specularViewBase=1;a.specularViewRate=1;a.specularViewAverage=1;a.specularViewShadow=1;a.specularViewShadow=null;a.optionReflect=null;a.reflectColor=new SColor4;a.reflectMerge=1;a.reflectShadow=1;a.optionRefract=null;
a.refractFrontColor=new SColor4;a.refractBackColor=new SColor4;a.optionOpacity=null;a.opacityColor=new SColor4;a.opacityRate=1;a.opacityAlpha=1;a.opacityDepth=1;a.opacityTransmittance=1;a.optionEmissive=null;a.emissiveColor=new SColor4;a.assign=SG3dMaterialInfo_assign;a.calculate=SG3dMaterialInfo_calculate;a.reset=SG3dMaterialInfo_reset;a.reset();return a},MO.SG3dMaterialInfo_assign=function(a){this.effectCode=a.effectCode;this.transformName=a.transformName;this.optionDepth=a.optionDepth;this.optionDouble=
a.optionDouble;this.optionNormalInvert=a.optionNormalInvert;this.optionShadow=a.optionShadow;this.optionShadowSelf=a.optionShadowSelf;this.optionAlpha=a.optionAlpha;this.alphaBase=a.alphaBase;this.alphaRate=a.alphaRate;this.alphaLevel=a.alphaLevel;this.alphaMerge=a.alphaMerge;this.optionColor=a.optionColor;this.colorMin=a.colorMin;this.colorMax=a.colorMax;this.colorBalance=a.colorBalance;this.colorRate=a.colorRate;this.optionVertex=a.optionVertex;this.vertexColor.assign(a.vertexColor);this.optionAmbient=
a.optionAmbient;this.ambientColor.assign(a.ambientColor);this.ambientShadow=a.ambientShadow;this.optionDiffuse=a.optionDiffuse;this.diffuseColor.assign(a.diffuseColor);this.diffuseShadow=a.diffuseShadow;this.optionDiffuseView=a.optionDiffuseView;this.diffuseViewColor.assign(a.diffuseViewColor);this.diffuseViewShadow=a.diffuseViewShadow;this.optionSpecular=a.optionSpecular;this.specularColor.assign(a.specularColor);this.specularBase=a.specularBase;this.specularLevel=a.specularLevel;this.specularAverage=
a.specularAverage;this.specularShadow=a.specularShadow;this.optionSpecularView=a.optionSpecularView;this.specularViewColor.assign(a.specularViewColor);this.specularViewBase=a.specularViewBase;this.specularViewRate=a.specularViewRate;this.specularViewAverage=a.specularViewAverage;this.specularViewShadow=a.specularViewShadow;this.optionReflect=a.optionReflect;this.reflectColor.assign(a.reflectColor);this.reflectMerge=RFloat.toRange(a.reflectMerge,0,2);this.reflectShadow=a.reflectShadow;this.optionRefract=
a.optionRefract;this.refractFrontColor.assign(a.refractFrontColor);this.refractFrontMerge=a.refractFrontMerge;this.refractFrontShadow=a.refractFrontShadow;this.refractBackColor.assign(a.refractBackColor);this.refractBackMerge=a.refractBackMerge;this.refractBackShadow=a.refractBackShadow;this.optionOpacity=a.optionOpacity;this.opacityColor.assign(a.opacityColor);this.opacityRate=a.opacityRate;this.opacityAlpha=a.optionAlpha;this.opacityDepth=a.optionDepth;this.opacityTransmittance=a.optionTransmittance;
this.optionEmissive=a.optionEmissive;this.emissiveColor.assign(a.emissiveColor)},MO.SG3dMaterialInfo_calculate=function(a){this.effectCode=a.effectCode;this.transformName=a.transformName;this.optionDepth=a.optionDepth;this.optionDouble=a.optionDouble;this.optionNormalInvert=a.optionNormalInvert;this.optionShadow=a.optionShadow;this.optionShadowSelf=a.optionShadowSelf;this.optionAlpha=a.optionAlpha;this.alphaBase=a.alphaBase;this.alphaRate=a.alphaRate;this.alphaLevel=a.alphaLevel;this.alphaMerge=a.alphaMerge;
this.optionColor=a.optionColor;this.colorMin=a.colorMin;this.colorMax=a.colorMax;this.colorBalance=a.colorBalance;this.colorRate=a.colorRate;this.optionVertex=a.optionVertex;this.vertexColor.assignPower(a.vertexColor);this.optionAmbient=a.optionAmbient;this.ambientColor.assignPower(a.ambientColor);this.ambientShadow=a.ambientShadow;this.optionDiffuse=a.optionDiffuse;this.diffuseColor.assignPower(a.diffuseColor);this.diffuseShadow=a.diffuseShadow;this.optionDiffuseView=a.optionDiffuseView;this.diffuseViewColor.assignPower(a.diffuseViewColor);
this.diffuseViewShadow=a.diffuseViewShadow;this.optionSpecular=a.optionSpecular;this.specularColor.assignPower(a.specularColor);this.specularBase=a.specularBase;this.specularLevel=a.specularLevel;this.specularAverage=a.specularAverage;this.specularShadow=a.specularShadow;this.optionSpecularView=a.optionSpecularView;this.specularViewColor.assignPower(a.specularViewColor);this.specularViewBase=a.specularViewBase;this.specularViewRate=a.specularViewRate;this.specularViewAverage=a.specularViewAverage;
this.specularViewShadow=a.specularViewShadow;this.optionReflect=a.optionReflect;this.reflectColor.assignPower(a.reflectColor);this.reflectMerge=RFloat.toRange(a.reflectMerge,0,2);this.reflectShadow=a.reflectShadow;this.optionRefract=a.optionRefract;this.refractFrontColor.assignPower(a.refractFrontColor);this.refractFrontMerge=a.refractFrontMerge;this.refractFrontShadow=a.refractFrontShadow;this.refractBackColor.assignPower(a.refractBackColor);this.refractBackMerge=a.refractBackMerge;this.refractBackShadow=
a.refractBackShadow;this.optionOpacity=a.optionOpacity;this.opacityColor.assignPower(a.opacityColor);this.opacityRate=a.opacityRate;this.opacityAlpha=a.optionAlpha;this.opacityDepth=a.optionDepth;this.opacityTransmittance=a.optionTransmittance;this.optionEmissive=a.optionEmissive;this.emissiveColor.assignPower(a.emissiveColor)},MO.SG3dMaterialInfo_reset=function(){this.optionDepth=!0;this.optionNormalInvert=this.optionDouble=!1;this.optionShadowSelf=this.optionShadow=!0;this.optionAlpha=!1;this.alphaBase=
.2;this.alphaMerge=this.alphaLevel=this.alphaRate=1;this.optionColor=!0;this.colorMin=0;this.colorMax=1;this.colorBalance=.5;this.colorRate=1;this.optionVertex=!0;this.vertexColor.set(1,1,1,1);this.optionAmbient=!0;this.ambientColor.set(.5,.5,.5,1);this.ambientShadow=1;this.optionDiffuse=!0;this.diffuseColor.set(.5,.5,.5,1);this.diffuseShadow=1;this.optionDiffuseView=!0;this.diffuseViewColor.set(1,1,1,1);this.diffuseViewShadow=1;this.optionSpecular=!0;this.specularColor.set(.5,.5,.5,1);this.specularBase=
0;this.specularLevel=16;this.specularShadow=this.specularAverage=1;this.optionSpecularView=!0;this.specularViewColor.set(1,1,1,1);this.specularViewBase=0;this.specularViewRate=16;this.specularViewShadow=this.specularViewAverage=1;this.optionReflect=!0;this.reflectColor.set(1,1,1,1);this.reflectShadow=this.reflectMerge=1;this.optionRefract=!0;this.refractFrontColor.set(1,1,1,1);this.refractFrontShadow=this.refractFrontMerge=1;this.refractBackColor.set(1,1,1,1);this.refractBackShadow=this.refractBackMerge=
1;this.optionOpacity=!0;this.opacityColor.set(1,1,1,1);this.opacityTransmittance=this.opacityDepth=this.opacityAlpha=this.opacityRate=1;this.optionEmissive=!0;this.emissiveColor.set(1,1,1,1)};with(MO)MO.SG3dRenderableInfo=function(){this.material=this.layout=this.effect=null;this.reset=SG3dRenderableInfo_reset;return this},MO.SG3dRenderableInfo_reset=function(){this.effect=null;this.layout=RObject.dispose(this.layout)};
with(MO)MO.FG3dAnimation=function(a){a=RClass.inherits(this,a,FObject);a._baseTick=0;a._currentTick=0;a._lastTick=0;a._bones=null;a.construct=FG3dAnimation_construct;a.findBone=FG3dAnimation_findBone;a.process=FG3dAnimation_process;a.dispose=FG3dAnimation_dispose;return a},MO.FG3dAnimation_construct=function(){this.__base.FObject.construct.call(this);this._bones=new TObjects},MO.FG3dAnimation_findBone=function(a){for(var b=this._bones,d=b.count(),f=0;f<d;f++){var h=b.get(f);if(h.boneId()==a)return h}return null},
MO.FG3dAnimation_process=function(){var a=RTimer.current();0==this._lastTick&&(this._lastTick=a);this._currentTick=(a-this._lastTick+this._baseTick)/1E3;for(var a=this._bones,b=a.count(),d=0;d<b;d++)a.get(d).update(this._currentTick);return!0},MO.FG3dAnimation_dispose=function(){this._bones.dispose();this._bones=null;this.__base.FObject.dispose.call(this)};
with(MO)MO.FG3dBaseMaterial=function(a){a=RClass.inherits(this,a,FObject);a._name=null;a._info=null;a.construct=FG3dBaseMaterial_construct;a.info=FG3dBaseMaterial_info;a.assignInfo=FG3dBaseMaterial_assignInfo;a.assign=FG3dBaseMaterial_assign;a.calculate=FG3dBaseMaterial_calculate;return a},MO.FG3dBaseMaterial_construct=function(){this.__base.FObject.construct.call(this);this._info=new SG3dMaterialInfo},MO.FG3dBaseMaterial_info=function(){return this._info},MO.FG3dBaseMaterial_assignInfo=function(a){this._info.assign(a)},
MO.FG3dBaseMaterial_assign=function(a){this._info.assign(a.info())},MO.FG3dBaseMaterial_calculate=function(a){this._info.calculate(a.info())};with(MO)MO.FG3dBone=function(a){a=RClass.inherits(this,a,FObject);a._boneId=0;a._modeId=null;a.update=FG3dBone_update;return a},MO.FG3dBone_update=function(a){};
with(MO)MO.FG3dCamera=function(a){a=RClass.inherits(this,a,FObject);a._matrix=null;a._position=null;a._target=null;a._direction=null;a._directionTarget=null;a._centerFront=.6;a._centerBack=1;a._focalNear=.1;a._focalFar=200;a._frustum=null;a._planes=null;a._viewport=null;a.__axisUp=null;a.__axisX=null;a.__axisY=null;a.__axisZ=null;a.construct=FG3dCamera_construct;a.matrix=FG3dCamera_matrix;a.position=FG3dCamera_position;a.setPosition=FG3dCamera_setPosition;a.direction=FG3dCamera_direction;a.setDirection=
FG3dCamera_setDirection;a.frustum=FG3dCamera_frustum;a.planes=FG3dCamera_planes;a.doWalk=FG3dCamera_doWalk;a.doStrafe=FG3dCamera_doStrafe;a.doFly=FG3dCamera_doFly;a.doPitch=FG3dCamera_doPitch;a.doYaw=FG3dCamera_doYaw;a.doRoll=FG3dCamera_doRoll;a.lookAt=FG3dCamera_lookAt;a.update=FG3dCamera_update;a.updateFrustum=FG3dCamera_updateFrustum;return a},MO.FG3dCamera_construct=function(){this.__base.FObject.construct.call(this);this._matrix=new SMatrix3d;this._position=new SPoint3;this._target=new SPoint3;
this._direction=new SVector3;this._directionTarget=new SVector3;this._frustum=new SFrustum;this._planes=new SFrustumPlanes;this._viewport=RClass.create(FG3dViewport);this.__axisUp=new SVector3;this.__axisUp.set(0,1,0);this.__axisX=new SVector3;this.__axisY=new SVector3;this.__axisZ=new SVector3},MO.FG3dCamera_position=function(){return this._position},MO.FG3dCamera_matrix=function(){return this._matrix},MO.FG3dCamera_setPosition=function(a,b,d){this._position.set(a,b,d)},MO.FG3dCamera_direction=function(){return this._direction},
MO.FG3dCamera_setDirection=function(a,b,d){this._direction.set(a,b,d);this._directionTarget.set(a,b,d)},MO.FG3dCamera_frustum=function(){return this._frustum},MO.FG3dCamera_planes=function(){return this._planes},MO.FG3dCamera_doWalk=function(a){this._position.x+=this._direction.x*a;this._position.z+=this._direction.z*a},MO.FG3dCamera_doStrafe=function(a){this._position.x+=this.__axisY.x*a;this._position.z+=this.__axisY.z*a},MO.FG3dCamera_doFly=function(a){this._position.y+=a},MO.FG3dCamera_doPitch=
function(a){throw new TFatal(o,"Unsupport.");},MO.FG3dCamera_doYaw=function(a){throw new TFatal(o,"Unsupport.");},MO.FG3dCamera_doRoll=function(a){throw new TFatal(o,"Unsupport.");},MO.FG3dCamera_lookAt=function(a,b,d){var f=this._position,h=this._direction;this._target.set(a,b,d);h.set(a-f.x,b-f.y,d-f.z);h.normalize();this._directionTarget.assign(h)},MO.FG3dCamera_update=function(){var a=this.__axisX,b=this.__axisY,d=this.__axisZ;d.assign(this._direction);d.normalize();this.__axisUp.cross2(a,d);
a.normalize();d.cross2(b,a);b.normalize();var f=this._matrix.data();f[0]=a.x;f[1]=b.x;f[2]=d.x;f[3]=0;f[4]=a.y;f[5]=b.y;f[6]=d.y;f[7]=0;f[8]=a.z;f[9]=b.z;f[10]=d.z;f[11]=0;f[12]=-a.dotPoint3(this._position);f[13]=-b.dotPoint3(this._position);f[14]=-d.dotPoint3(this._position);f[15]=1},MO.FG3dCamera_updateFrustum=function(){var a=RMath.matrix;a.assign(this._matrix);a.append(this._projection.matrix());this._planes.updateVision(a.data())};
with(MO)MO.FG3dDirectionalLight=function(a){a=RClass.inherits(this,a,FG3dLight);a._camera=null;a._viewport=null;a._direction=null;a.construct=FG3dDirectionalLight_construct;a.camera=FG3dDirectionalLight_camera;a.projection=FG3dDirectionalLight_projection;a.viewport=FG3dDirectionalLight_viewport;a.direction=FG3dDirectionalLight_direction;return a},MO.FG3dDirectionalLight_construct=function(){this.__base.FG3dLight.construct.call(this);this._direction=new SVector3;this._camera=RClass.create(FG3dPerspectiveCamera)},
MO.FG3dDirectionalLight_camera=function(){return this._camera},MO.FG3dDirectionalLight_projection=function(){return this._projection},MO.FG3dDirectionalLight_viewport=function(){return this._viewport},MO.FG3dDirectionalLight_direction=function(){return this._direction};
with(MO)MO.FG3dEffect=function(a){a=RClass.inherits(this,a,FG3dObject);a._ready=null;a._code=null;a._stateFillCd=EG3dFillMode.Face;a._stateCullCd=EG3dCullMode.Front;a._stateDepth=!0;a._stateDepthCd=EG3dDepthMode.LessEqual;a._stateDepthWrite=!0;a._stateBlend=!0;a._stateBlendSourceCd=EG3dBlendMode.SourceAlpha;a._stateBlendTargetCd=EG3dBlendMode.OneMinusSourceAlpha;a._stateAlphaTest=!1;a._optionShadow=!1;a._optionLightMap=!1;a._optionFog=!1;a._program=null;a._vertexTemplate=null;a._fragmentTemplate=
null;a.setup=RMethod.empty;a.testReady=FG3dEffect_testReady;a.code=FG3dEffect_code;a.program=FG3dEffect_program;a.setParameter=FG3dEffect_setParameter;a.setSampler=FG3dEffect_setSampler;a.drawRenderable=FG3dEffect_drawRenderable;a.drawRenderables=FG3dEffect_drawRenderables;a.drawGroup=FG3dEffect_drawGroup;a.drawRegion=FG3dEffect_drawRegion;a.buildInfo=FG3dEffect_buildInfo;a.loadConfig=FG3dEffect_loadConfig;a.load=FG3dEffect_load;a.build=FG3dEffect_build;return a},MO.FG3dEffect_testReady=function(){return this._ready},
MO.FG3dEffect_code=function(){return this._code},MO.FG3dEffect_program=function(){return this._program},MO.FG3dEffect_setParameter=function(a,b,d){this._program.setParameter(a,b,d)},MO.FG3dEffect_setSampler=function(a,b){this._program.setSampler(a,b)},MO.FG3dEffect_buildInfo=function(a,b){},MO.FG3dEffect_drawRenderable=function(a,b){var d=this._graphicContext,f=this._program;if(f.hasAttribute())for(var h=f.attributes(),k=h.count(),q=0;q<k;q++){var w=h.value(q);if(w._statusUsed){var x=r.findVertexBuffer(w._linker);
if(!x)throw new TError("Can't find renderable vertex buffer. (linker={1})",w._linker);f.setAttribute(w._name,x,x._formatCd)}}f=r.indexBuffer();d.drawTriangles(f,0,f.count())},MO.FG3dEffect_drawRenderables=function(a,b,d,f){this._graphicContext.setProgram(this._program);for(var h=0;h<f;h++)this.drawRenderable(a,b.getAt(d+h))},MO.FG3dEffect_drawGroup=function(a,b,d,f){this.drawRenderables(a,b,d,f)},MO.FG3dEffect_drawRegion=function(a,b,d){for(var f=a.renderables(),h=0;h<d;){for(var k=h,q=d,w=f.at(b+
k).materialReference(),x=h;x<d;x++){var y=f.at(b+x).materialReference();if(w!=y){q=x;break}h++}this.drawGroup(a,f,b+k,q-k)}},MO.FG3dEffect_loadConfig=function(a){var b=this._graphicContext,d=this._program=b.createProgram();a=a.nodes();for(var b=a.count(),f=0;f<b;f++){var h=a.get(f);if(h.isName("State")){var k=h.get("name"),q=h.get("value");if("fill_mode"==k)this._stateFillCd=REnum.parse(EG3dFillMode,q);else if("cull_mode"==k)this._stateCullCd=REnum.parse(EG3dCullMode,q);else if("depth_mode"==k)this._stateDepth=
!0,this._stateDepthCd=REnum.parse(EG3dDepthMode,q);else if("depth_write"==k)this._stateDepthWrite=RBoolean.parse(q);else if("blend_mode"==k){if(this._stateBlend=RBoolean.parse(q))this._stateBlendSourceCd=REnum.parse(EG3dBlendMode,h.get("source")),this._stateBlendTargetCd=REnum.parse(EG3dBlendMode,h.get("target"))}else"alpha_test"==k&&(this._stateAlphaTest=RBoolean.parse(q))}else if(h.isName("Option"))k=h.get("name"),q=h.get("value"),"shadow"==k?this._optionShadow=RBoolean.parse(q):"lightmap"==k?this._optionLightMap=
RBoolean.parse(q):"fog"==k&&(this._optionFog=RBoolean.parse(q));else if(h.isName("Parameter"))k=RClass.create(FG3dProgramParameter),k.loadConfig(h),d.parameters().set(k.name(),k);else if(h.isName("Attribute"))k=RClass.create(FG3dProgramAttribute),k.loadConfig(h),d.attributes().set(k.name(),k);else if(h.isName("Sampler"))k=RClass.create(FG3dProgramSampler),k.loadConfig(h),d.samplers().set(k.name(),k);else if(h.isName("Source"))if(k=h.get("name"),"vertex"==k)this._vertexSource=h.value();else if("fragment"==
k)this._fragmentSource=h.value();else throw new TError(this,"Unknown source type. (name={1})",nt);else throw new TError(this,"Unknown config type. (name={1})",h.name());}(this._vertexTemplate=RClass.create(FG3dShaderTemplate)).load(this._vertexSource);(this._fragmentTemplate=RClass.create(FG3dShaderTemplate)).load(this._fragmentSource)},MO.FG3dEffect_build=function(a){var b=this._program,d=b._parameters,f=d.count(),h=RInstance.get(FTagContext);this.buildInfo(h,a);a=this._vertexTemplate.parse(h);a=
RString.formatLines(a);b.upload(EG3dShader.Vertex,a);h=this._fragmentTemplate.parse(h);for(a=0;a<f;a++){var k=d.value(a),q=k.name();(k=k.define())&&(h=h.replace(new RegExp(q,"g"),k))}d=RString.formatLines(h);b.upload(EG3dShader.Fragment,d);b.build();b.link()},MO.FG3dEffect_load=function(){var a=RConsole.find(FG3dEffectConsole).loadConfig(this._code);this.loadConfig(a)};
with(MO)MO.FG3dEffectConsole=function(a){a=RClass.inherits(this,a,FConsole);a._configs=null;a._loadEffects=null;a._registerEffects=null;a._templateEffects=null;a._effects=null;a._path="/ars/shader/";a._effectInfo=null;a._tagContext=null;a._thread=null;a._interval=300;a.onProcess=FG3dEffectConsole_onProcess;a.construct=FG3dEffectConsole_construct;a.path=FG3dEffectConsole_path;a.register=FG3dEffectConsole_register;a.unregister=FG3dEffectConsole_unregister;a.create=FG3dEffectConsole_create;a.buildEffectInfo=
FG3dEffectConsole_buildEffectInfo;a.findTemplate=FG3dEffectConsole_findTemplate;a.find=FG3dEffectConsole_find;a.loadConfig=FG3dEffectConsole_loadConfig;return a},MO.FG3dEffectConsole_onProcess=function(){var a=this._loadEffects;for(a.record();a.next();)a.current().processLoad()&&a.removeCurrent()},MO.FG3dEffectConsole_construct=function(){this.__base.FConsole.construct.call(this);this._configs=new TDictionary;this._loadEffects=new TLooper;this._registerEffects=new TDictionary;this._templateEffects=
new TDictionary;this._effects=new TDictionary;this._effectInfo=new SG3dEffectInfo;this._tagContext=RClass.create(FTagContext)},MO.FG3dEffectConsole_path=function(){return this._path},MO.FG3dEffectConsole_register=function(a,b){this._registerEffects.set(a,b)},MO.FG3dEffectConsole_unregister=function(a){this._registerEffects.set(a,null)},MO.FG3dEffectConsole_create=function(a,b){var d=this._registerEffects.get(b);if(!d)throw new TError(this,"Unknown effect type name. (type={1})",d);d=RClass.create(d);
d.linkGraphicContext(a);d.setup();return d},MO.FG3dEffectConsole_buildEffectInfo=function(a,b,d,f){a=a.capability();d=d.technique();b.techniqueModeCode=d.activeMode().code();b.optionMerge=f._optionMerge;b.optionMerge&&(b.mergeCount=f.mergeMaxCount());d=f.material().info();b.optionNormalInvert=d.optionNormalInvert;b.optionColor=d.optionColor;b.optionAmbient=d.optionAmbient;b.optionDiffuse=d.optionDiffuse;b.optionSpecular=d.optionSpecular;b.optionReflect=d.optionReflect;b.optionRefract=d.optionRefract;
b.vertexCount=f.vertexCount();var h=f.vertexBuffers();d=h.count();for(var k=0;k<d;k++){var q=h.at(k),w=q.code();"normal"==w&&(4==q.stride()?b.optionNormalCompress=!0:b.optionNormalCompress=!1);if(RString.isEmpty(w))throw new TError(this,"Vertex buffer code is empty.");b.attributes.push(w)}if(h=f.textures())for(d=h.count(),k=0;k<d;k++){q=h.name(k);if(RString.isEmpty(q))throw new TError(this,"Texture code is empty.");b.samplers.push(q)}if(d=f.bones())d=d.count(),b.vertexBoneCount=d,a=a.calculateBoneCount(b.vertexBoneCount,
b.vertexCount),d>a&&(d=a),f._boneLimit=d,b.vertexBoneLimit=d},MO.FG3dEffectConsole_findTemplate=function(a,b){var d=this._templateEffects,f=d.get(b);null==f&&(f=this.create(a,b),f.load(),RLogger.info(this,"Create effect template. (code={1}, instance={2})",b,f),d.set(b,f));return f},MO.FG3dEffectConsole_find=function(a,b,d){RClass.isClass(a,FGraphicContext)||(a=a.graphicContext());if(!RClass.isClass(a,FGraphicContext))throw new TError(this,"Unknown context.");var f=d.material().info().effectCode;RString.isEmpty(f)&&
(f="automatic");"skeleton"!=f&&"skeleton.4"!=f||null!=d.bones()||(f="automatic");var h=b.spaceName()+"."+f,k=this.findTemplate(a,h);if(k){var q=this._effectInfo;q.reset();this.buildEffectInfo(a,q,b,d);k.buildInfo(this._tagContext,q);b=h+this._tagContext.code;d=this._effects;q=d.get(b);q||(q=this.create(a,h),q._flag=b,q.load(),q.build(this._effectInfo),RLogger.info(this,"Create effect. (name={1}, instance={2})",f,q));d.set(b,q)}return q},MO.FG3dEffectConsole_loadConfig=function(a){var b=this._configs.get(a);
if(b)return b;b=RBrowser.contentPath(this._path+a+".xml");RRuntime.isDebug()&&(b+="?"+RDate.format());b=RClass.create(FXmlConnection).send(b);this._configs.set(a,b);return b};with(MO)MO.FG3dLight=function(a){return a=RClass.inherits(this,a,FObject)};with(MO)MO.FG3dLightMaterial=function(a){return a=RClass.inherits(this,a,FG3dBaseMaterial)};
with(MO)MO.FG3dMaterial=function(a){a=RClass.inherits(this,a,FG3dBaseMaterial);a._dirty=!0;a._textures=null;a.textures=FG3dMaterial_textures;a.update=FG3dMaterial_update;return a},MO.FG3dMaterial_textures=function(){return this._textures},MO.FG3dMaterial_update=function(){this._dirty=!0};
with(MO)MO.FG3dMaterialMap=function(a){a=RClass.inherits(this,a,FObject,MGraphicObject);a._size=null;a._data=null;a._texture=null;a._stride=null;a._dirty=!1;a.construct=FG3dMaterialMap_construct;a.size=FG3dMaterialMap_size;a.data=FG3dMaterialMap_data;a.texture=FG3dMaterialMap_texture;a.setup=FG3dMaterialMap_setup;a.resize=FG3dMaterialMap_resize;a.setUint8=FG3dMaterialMap_setUint8;a.setUint16=FG3dMaterialMap_setUint16;a.setUint32=FG3dMaterialMap_setUint32;a.setFloat16=FG3dMaterialMap_setFloat16;a.setFloat32=
FG3dMaterialMap_setFloat32;a.update=FG3dMaterialMap_update;return a},MO.FG3dMaterialMap_construct=function(){this.__base.FObject.construct.call(this);this._size=new SSize2},MO.FG3dMaterialMap_size=function(){return this._size},MO.FG3dMaterialMap_data=function(){return this._data},MO.FG3dMaterialMap_texture=function(){return this._texture},MO.FG3dMaterialMap_setup=function(a,b){var d=this._texture=this._graphicContext.createFlatTexture();this.resize(a,b);d.setFilterCd(EG3dSamplerFilter.Nearest,EG3dSamplerFilter.Nearest);
d.uploadData(this._data,a,b)},MO.FG3dMaterialMap_resize=function(a,b){var d=this._size;2048<b?b=4096:1024<b?b=2048:512<b?b=1024:256<b?b=512:128<b?b=256:64<b?b=128:32<b?b=64:16<b&&(b=32);b<d.height&&(b=d.height);if(d.width!=a||d.height!=b)d.set(a,b),this._stride=4*a,this._data=new Uint8Array(4*a*b)},MO.FG3dMaterialMap_setUint8=function(a,b,d,f,h,k){var q=this._data;a=this._stride*a+(b<<2);d.constructor==SColor4?(f=255*d.red,q[a]!=f&&(this._dirty=!0),q[a++]=f,f=255*d.green,q[a]!=f&&(this._dirty=!0),
q[a++]=f,f=255*d.blue,q[a]!=f&&(this._dirty=!0),q[a++]=f,f=255*d.alpha,q[a]!=f&&(this._dirty=!0),q[a++]=f):(q[a++]=d,q[a++]=f,q[a++]=h,q[a++]=k)},MO.FG3dMaterialMap_setUint16=function(a,b,d,f){var h=this._data;a=this._stride*a+(b<<2);h[a++]=d>>8&255;h[a++]=d&255;h[a++]=f>>8&255;h[a++]=f&255;this._dirty=!0},MO.FG3dMaterialMap_setUint32=function(a,b,d){var f=this._data;a=this._stride*a+(b<<2);f[a++]=d>>24&255;f[a++]=d>>16&255;f[a++]=d>>8&255;f[a++]=d&255;this._dirty=!0},MO.FG3dMaterialMap_setFloat16=
function(a,b,d,f){var h=this._data;a=this._stride*a+(b<<2);parseInt(256*d);h[a++]=parseInt(d)&255;h[a++]=parseInt(256*d)&255;h[a++]=parseInt(f)&255;h[a++]=parseInt(256*f)&255;this._dirty=!0},MO.FG3dMaterialMap_setFloat32=function(a,b,d){var f=this._data;a=this._stride*a+(b<<2);f[a++]=parseInt(.00390625*d)&255;f[a++]=parseInt(d)&255;f[a++]=parseInt(256*d)&255;f[a++]=parseInt(65536*d)&255;this._dirty=!0},MO.FG3dMaterialMap_update=function(){if(this._dirty){var a=this._size;this._texture.uploadData(this._data,
a.width,a.height);this._dirty=!1}};with(MO)MO.FG3dMaterialTexture=function(a){a=RClass.inherits(this,a,FG3dMaterial);a._texture=null;a.construct=FG3dMaterialTexture_construct;return a},MO.FG3dMaterialTexture_construct=function(){};with(MO)MO.FG3dObject=function(a){a=RClass.inherits(this,a,FObject,MGraphicObject);a.setup=FG3dObject_setup;a.dispose=FG3dObject_dispose;return a},MO.FG3dObject_setup=function(){},MO.FG3dObject_dispose=function(){this.__base.MGraphicObject.dispose.call(this);this.__base.FObject.dispose.call(this)};
with(MO)MO.FG3dOrthoCamera=function(a){a=RClass.inherits(this,a,FG3dCamera);a._projection=null;a.construct=FG3dOrthoCamera_construct;a.projection=FG3dOrthoCamera_projection;a.updateFrustum=FG3dOrthoCamera_updateFrustum;a.updateFromCamera=FG3dOrthoCamera_updateFromCamera;a.updateFlatCamera=FG3dOrthoCamera_updateFlatCamera;return a},MO.FG3dOrthoCamera_construct=function(){this.__base.FG3dCamera.construct.call(this);this._projection=RClass.create(FG3dOrthoProjection)},MO.FG3dOrthoCamera_projection=function(){return this._projection},
MO.FG3dOrthoCamera_updateFrustum=function(){this.__base.FG3dCamera.updateFrustum.call(this);var a=this._projection,b=a._size,d=this._frustum;d.update(a._angle,b.width,b.height,a._znear,a._zfar,this._centerFront,this._centerBack,this._matrix);return d},MO.FG3dOrthoCamera_updateFromCamera=function(a){a=a.updateFrustum();var b=this._direction;b.normalize();this._position.set(a.center.x-b.x*a.radius,a.center.y-b.y*a.radius,a.center.z-b.z*a.radius);this.lookAt(a.center.x,a.center.y,a.center.z);this.update();
b=this._frustum;this._matrix.transform(b.coners,a.coners,8);b.updateCenter();this._projection.updateFrustum(b)},MO.FG3dOrthoCamera_updateFlatCamera=function(a){var b=a.updateFlatFrustum(),d=RConst.DEGREE_RATE*this._projection.angle(),d=b.radius/Math.sin(.5*d),d=Math.max(d,a._projection._zfar);a=this._direction;a.normalize();this._position.set(b.center.x-a.x*d,b.center.y-a.y*d,b.center.z-a.z*d);this.lookAt(b.center.x,b.center.y,b.center.z);this.update();this._projection._znear=.3;this._projection._zfar=
1.5*d;this._projection.update()};
with(MO)MO.FG3dOrthoProjection=function(a){a=RClass.inherits(this,a,FG3dProjection);a._matrix=null;a.construct=FG3dOrthoProjection_construct;a.matrix=FG3dOrthoProjection_matrix;a.update=FG3dOrthoProjection_update;a.updateFrustum=FG3dOrthoProjection_updateFrustum;return a},MO.FG3dOrthoProjection_construct=function(){this.__base.FG3dProjection.construct.call(this);this._matrix=new SOrthoMatrix3d},MO.FG3dOrthoProjection_matrix=function(){return this._matrix},MO.FG3dOrthoProjection_update=function(){var a=
this._size;this._matrix.identity();var b=this._matrix.data();b[0]=2/a.width*8;b[4]=b[8]=b[12]=0;b[5]=2/a.height*8;b[1]=b[9]=b[13]=0;b[10]=1/(this._znear-this._zfar);b[2]=b[6]=b[14]=0;b[3]=b[7]=0;b[11]=this._znear/(this._znear-this._zfar);b[15]=1},MO.FG3dOrthoProjection_updateFrustum=function(a){this._znear=a.minZ;this._zfar=a.maxZ;this.update()};
with(MO)MO.FG3dPerspectiveCamera=function(a){a=RClass.inherits(this,a,FG3dCamera);a._projection=null;a._centerFront=.4;a.construct=FG3dPerspectiveCamera_construct;a.projection=FG3dPerspectiveCamera_projection;a.updateFrustum=FG3dPerspectiveCamera_updateFrustum;a.updateFlatFrustum=FG3dPerspectiveCamera_updateFlatFrustum;a.updateFromCamera=FG3dPerspectiveCamera_updateFromCamera;a.updateFlatCamera=FG3dPerspectiveCamera_updateFlatCamera;return a},MO.FG3dPerspectiveCamera_construct=function(){this.__base.FG3dCamera.construct.call(this);
this._projection=RClass.create(FG3dPerspectiveProjection)},MO.FG3dPerspectiveCamera_projection=function(){return this._projection},MO.FG3dPerspectiveCamera_updateFrustum=function(){this.__base.FG3dCamera.updateFrustum.call(this);var a=this._projection,b=a._size,d=this._frustum;d.update(a._angle,b.width,b.height,a._znear,a._zfar,this._centerFront,this._centerBack,this._matrix);return d},MO.FG3dPerspectiveCamera_updateFlatFrustum=function(){var a=this._projection,b=a._size,d=this._frustum;d.updateFlat(a._angle,
b.width,b.height,a._znear,a._zfar,this._centerFront,this._centerBack,this._matrix);return d},MO.FG3dPerspectiveCamera_updateFromCamera=function(a){var b=this._frustum,d=a.updateFrustum(),f=RConst.DEGREE_RATE*this._projection.angle(),f=d.radius/Math.sin(.5*f),f=Math.max(f,a._projection._zfar);a=this._direction;a.normalize();this._position.set(d.center.x-a.x*f,d.center.y-a.y*f,d.center.z-a.z*f);this.lookAt(d.center.x,d.center.y,d.center.z);this.update();this._matrix.transform(b.coners,0,d.coners,0,
8);b.updateCenter();this._projection.updateFrustum(b)},MO.FG3dPerspectiveCamera_updateFlatCamera=function(a){var b=a.updateFlatFrustum(),d=RConst.DEGREE_RATE*this._projection.angle(),d=b.radius/Math.sin(.5*d),d=Math.max(d,a._projection._zfar);a=this._direction;a.normalize();this._position.set(b.center.x-a.x*d*this._centerFront,b.center.y-a.y*d*this._centerFront,b.center.z-a.z*d*this._centerFront);this.lookAt(b.center.x,b.center.y,b.center.z);this.update();this._projection._znear=.1;this._projection._zfar=
d;this._projection.update()};
with(MO)MO.FG3dPerspectiveProjection=function(a){a=RClass.inherits(this,a,FG3dProjection);a._matrix=null;a.construct=FG3dPerspectiveProjection_construct;a.matrix=FG3dPerspectiveProjection_matrix;a.update=FG3dPerspectiveProjection_update;a.updateFrustum=FG3dPerspectiveProjection_updateFrustum;return a},MO.FG3dPerspectiveProjection_construct=function(){this.__base.FG3dProjection.construct.call(this);this._matrix=new SPerspectiveMatrix3d},MO.FG3dPerspectiveProjection_matrix=function(){return this._matrix},
MO.FG3dPerspectiveProjection_update=function(){var a=this._size;this._fieldOfView=RConst.DEGREE_RATE*this._angle;this._matrix.perspectiveFieldOfViewLH(this._fieldOfView,a.width/a.height,this._znear,this._zfar)},MO.FG3dPerspectiveProjection_updateFrustum=function(a){this._znear=a.minZ;this._zfar=a.maxZ;this.update()};with(MO)MO.FG3dPointLight=function(a){return a=RClass.inherits(this,a,FG3dLight)};
with(MO)MO.FG3dProjection=function(a){a=RClass.inherits(this,a,FObject);a._size=null;a._angle=60;a._fieldOfView=0;a._znear=.1;a._zfar=200;a._scale=0;a.construct=FG3dProjection_construct;a.size=FG3dProjection_size;a.angle=FG3dProjection_angle;a.znear=FG3dProjection_znear;a.zfar=FG3dProjection_zfar;a.distance=FG3dProjection_distance;return a},MO.FG3dProjection_construct=function(){this.__base.FObject.construct.call(this);this._size=new SSize2},MO.FG3dProjection_size=function(){return this._size},MO.FG3dProjection_angle=
function(){return this._angle},MO.FG3dProjection_znear=function(){return this._znear},MO.FG3dProjection_zfar=function(){return this._zfar},MO.FG3dProjection_distance=function(){return this._zfar-this._znear};with(MO)MO.FG3dShaderTemplate=function(a){a=RClass.inherits(this,a,FTagDocument);a._space="shader";return a};with(MO)MO.FG3dSpotLight=function(a){return a=RClass.inherits(this,a,FG3dLight)};
with(MO)MO.FG3dTechnique=function(a){a=RClass.inherits(this,a,FG3dObject);a._code=null;a._activeMode=null;a._modes=null;a._passes=null;a.construct=FG3dTechnique_construct;a.code=FG3dTechnique_code;a.activeMode=FG3dTechnique_activeMode;a.modes=FG3dTechnique_modes;a.passes=FG3dTechnique_passes;a.registerMode=FG3dTechnique_registerMode;a.selectMode=FG3dTechnique_selectMode;a.updateRegion=RMethod.empty;a.clear=FG3dTechnique_clear;a.sortRenderables=FG3dTechnique_sortRenderables;a.drawRegion=FG3dTechnique_drawRegion;
a.present=FG3dTechnique_present;return a},MO.FG3dTechnique_construct=function(){this.__base.FG3dObject.construct.call(this);this._modes=new TObjects;this._passes=new TObjects},MO.FG3dTechnique_code=function(){return this._code},MO.FG3dTechnique_activeMode=function(){return this._activeMode},MO.FG3dTechnique_modes=function(){return this._modes},MO.FG3dTechnique_passes=function(){return this._passes},MO.FG3dTechnique_registerMode=function(a){var b=RClass.create(FG3dTechniqueMode);b.setCode(a);this._modes.push(b);
return this._activeMode=b},MO.FG3dTechnique_selectMode=function(a){},MO.FG3dTechnique_clear=function(a){var b=this._graphicContext;b.setRenderTarget(null);b.clear(a.red,a.green,a.blue,a.alpha,1)},MO.FG3dTechnique_sortRenderables=function(a,b){},MO.FG3dTechnique_drawRegion=function(a){a.setTechnique(this);for(var b=this._passes,d=b.count(),f=0;f<d;f++){var h=b.get(f);a.setTechniquePass(h,f==d-1);h.drawRegion(a)}},MO.FG3dTechnique_present=function(a){this._graphicContext.present()};
with(MO)MO.FG3dTechniqueConsole=function(a){a=RClass.inherits(this,a,FConsole);a._techniques=null;a.construct=FG3dTechniqueConsole_construct;a.techniques=FG3dTechniqueConsole_techniques;a.find=FG3dTechniqueConsole_find;return a},MO.FG3dTechniqueConsole_construct=function(){this.__base.FConsole.construct.call(this);this._techniques=new TDictionary},MO.FG3dTechniqueConsole_techniques=function(){return this._techniques},MO.FG3dTechniqueConsole_find=function(a,b){RClass.isClass(a,FGraphicContext)||(a=
a.graphicContext());if(!RClass.isClass(a,FGraphicContext))throw new TError(this,"Unknown context.");var d=a.hashCode()+"|"+RClass.name(b),f=this._techniques,h=f.get(d);if(!h){h=RClass.create(b);h.linkGraphicContext(a);h.setup();for(var k=h.code(),q=h.passes(),w=q.count(),x=0;x<w;x++){var y=q.at(x),z=y.code();y.setFullCode(k+"."+z)}f.set(d,h)}return h};
with(MO)MO.FG3dTechniqueMode=function(a){a=RClass.inherits(this,a,FObject);a._code=null;a.code=FG3dTechniqueMode_code;a.setCode=FG3dTechniqueMode_setCode;return a},MO.FG3dTechniqueMode_code=function(){return this._code},MO.FG3dTechniqueMode_setCode=function(a){this._code=a};
with(MO)MO.FG3dTechniquePass=function(a){a=RClass.inherits(this,a,FG3dObject);a._fullCode=null;a._code=null;a._index=null;a._finish=!1;a._materialMap=null;a.setup=FG3dTechniquePass_setup;a.fullCode=FG3dTechniquePass_fullCode;a.setFullCode=FG3dTechniquePass_setFullCode;a.code=FG3dTechniquePass_code;a.activeEffects=FG3dTechniquePass_activeEffects;a.sortRenderables=FG3dTechniquePass_sortRenderables;a.drawRegion=FG3dTechniquePass_drawRegion;return a},MO.FG3dTechniquePass_setup=function(){var a=this._materialMap=
RClass.create(FG3dMaterialMap);a.linkGraphicContext(this);a.setup(EG3dMaterialMap.Count,32)},MO.FG3dTechniquePass_fullCode=function(){return this._fullCode},MO.FG3dTechniquePass_setFullCode=function(a){this._fullCode=a},MO.FG3dTechniquePass_code=function(){return this._code},MO.FG3dTechniquePass_sortRenderables=function(a,b){var d=a.material().info(),f=b.material().info();if(d.optionAlpha&&f.optionAlpha)return d=a.activeEffect(),f=b.activeEffect(),d==f&&(sm=a._materialReference,tm=b._materialReference,
sm&&tm)?sm.hashCode()-tm.hashCode():d.hashCode()-f.hashCode();if(d.optionAlpha&&!f.optionAlpha)return 1;if(!d.optionAlpha&&f.optionAlpha)return-1;d=a.activeEffect();f=b.activeEffect();return d==f&&(sm=a._materialReference,tm=b._materialReference,sm&&tm)?sm.hashCode()-tm.hashCode():d.hashCode()-f.hashCode()},MO.FG3dTechniquePass_activeEffects=function(a,b){for(var d=a.spaceName(),f=b.count()-1;0<=f;f--){var h=b.get(f),k=h.selectInfo(d);k.effect||(k.effect=RConsole.find(FG3dEffectConsole).find(this._graphicContext,
a,h))}},MO.FG3dTechniquePass_drawRegion=function(a){var b=a.renderables(),d=b.count();if(0!=d){a._statistics._frameDrawSort.begin();this.activeEffects(a,b);b.sort(this.sortRenderables);a._statistics._frameDrawSort.end();if(this._graphicContext.capability().optionMaterialMap){var f=this._materialMap;f.resize(EG3dMaterialMap.Count,d);for(var h=0;h<d;h++){var k=b.get(h);k._materialId=h;k=k.material().info();f.setUint8(h,EG3dMaterialMap.AmbientColor,k.ambientColor);f.setUint8(h,EG3dMaterialMap.DiffuseColor,
k.diffuseColor);f.setUint8(h,EG3dMaterialMap.SpecularColor,k.specularColor);f.setUint8(h,EG3dMaterialMap.ReflectColor,k.reflectColor);f.setUint8(h,EG3dMaterialMap.EmissiveColor,k.emissiveColor)}f.update();a._materialMap=f}for(f=0;f<d;){for(var k=f,q=d,w=b.getAt(k).activeEffect(),h=f;h<d;h++){var x=b.getAt(h).activeEffect();if(w!=x){q=h;break}f++}w.drawRegion(a,k,q-k)}}};
with(MO)MO.FG3dTrack=function(a){a=RClass.inherits(this,a,FObject);a._frames=null;a.construct=FG3dTrack_construct;a.calculate=FG3dTrack_calculate;return a},MO.FG3dTrack_construct=function(){this.__base.FObject.construct.call(this)},MO.FG3dTrack_update=function(a){a=new SG3dFrameInfo;this._trackResource.calculateFrameInfo(a,tick);a.update();this._matrix.assign(this._trackResource.matrixInvert());this._matrix.append(a.matrix);return!0},MO.FG3dTrack_calculate=function(a){var b=this._frames.count();if(0==
b)return!1;0>a&&(a=-a);var d=this._frames.Get(index),f=null,f=index<b-1?this._frames.Get(index+1):this._frames.Get(0);info.tick=a;info.currentFrame=d;info.nextFrame=f;return!0};with(MO)MO.FG3dViewport=function(a){a=RClass.inherits(this,a,FObject);a.left=0;a.top=0;a.width=0;a.height=0;a.set=FG3dViewport_set;return a},MO.FG3dViewport_set=function(a,b,d,f){this.left=a;this.top=b;this.width=d;this.height=f};
with(MO)MO.REngine3d=function(){this._setuped=!1;this._contexts=null;this.onUnload=REngine3d_onUnload;this.setup=REngine3d_setup;this.contexts=REngine3d_contexts;this.createContext=REngine3d_createContext;this.dispose=REngine3d_dispose;return this},MO.REngine3d_onUnload=function(a){this.dispose()},MO.REngine3d_setup=function(){this._setuped||(this._contexts=new TObjects,RWindow.lsnsUnload.register(this,this.onUnload),this._setuped=!0)},MO.REngine3d_contexts=function(){return this._contexts},MO.REngine3d_createContext=
function(a,b,d){this.setup();a=RClass.create(a);d&&(a._optionAlpha=d.alpha,a._optionAntialias=d.antialias);a.linkCanvas(b);this._contexts.push(a);return a},MO.REngine3d_dispose=function(){var a=this._contexts;if(a){for(var b=a.count(),d=0;d<b;d++)a.at(d).dispose();this._contexts=RObject.dispose(a)}},MO.REngine3d=new REngine3d;
MO.EG3dAttribute=new function(){this.Position="position";this.Color="color";this.Coord="coord";this.Normal="normal";this.Binormal="binormal";this.Tangent="tangent";this.BoneIndex="bone_index";this.BoneWeight="bone_weight";return this};MO.EG3dAttributeFormat=new function(){this.Unknown=0;this.Float1=1;this.Float2=2;this.Float3=3;this.Float4=4;this.Byte4=5;this.Byte4Normal=6;return this};
MO.EG3dBlendMode=new function(){this.Zero=0;this.One=1;this.SrcColor=2;this.OneMinusSrcColor=3;this.DstColor=4;this.OneMinusDstColor=5;this.SrcAlpha=6;this.OneMinusSrcAlpha=7;this.DstAlpha=8;this.OneMinusDstAlpha=9;this.SrcAlphaSaturate=10;return this};MO.EG3dCullMode=new function(){this.None=0;this.Front=1;this.Back=2;this.Both=3;return this};MO.EG3dDepthMode=new function(){this.None=0;this.Equal=1;this.NotEqual=2;this.Less=3;this.LessEqual=4;this.Greater=5;this.GreaterEqual=6;this.Always=7;return this};
MO.EG3dFillMode=new function(){this.Unknown=0;this.Point=1;this.Line=2;this.Face=3;return this};MO.EG3dIndexStride=new function(){this.Unknown=0;this.Uint16=1;this.Uint32=2;return this};MO.EG3dParameterFormat=new function(){this.Unknown=0;this.Float1=1;this.Float2=2;this.Float3=3;this.Float4=4;this.Float3x3=5;this.Float4x3=6;this.Float4x4=7;return this};
MO.EG3dSampler=new function(){this.Diffuse="diffuse";this.Alpha="alpha";this.Normal="normal";this.SpecularColor="specular.color";this.SpecularLevel="specular.level";this.Light="light";this.Reflect="reflect";this.Refract="refract";this.Emissive="emissive";this.Height="height";this.Environment="environment";return this};MO.EG3dSamplerFilter=new function(){this.Unknown=0;this.Nearest=1;this.Linear=2;this.Repeat=3;this.ClampToEdge=4;this.ClampToBorder=5;return this};
MO.EG3dShader=new function(){this.Unknown=0;this.Vertex=1;this.Fragment=2;return this};MO.EG3dTexture=new function(){this.Unknown=0;this.Flat2d=1;this.Flat3d=2;this.Cube=3;return this};
with(MO)MO.SG3dContextCapability=function(){this.shaderVersion=this.version=this.vendor=null;this.optionShaderSource=this.optionIndex32=this.optionMaterialMap=this.optionLayout=this.optionInstance=this.optionDebug=!1;this.mergeCount=0;this.attributeCount=null;this.vertexCount=65536;this.samplerCompressRgba=this.samplerCompressRgb=this.samplerSize=this.samplerCount=this.varyingCount=this.fragmentConst=this.vertexConst=null;this.calculateBoneCount=SG3dContextCapability_calculateBoneCount;this.calculateInstanceCount=
SG3dContextCapability_calculateInstanceCount;return this},MO.SG3dContextCapability_calculateBoneCount=function(a,b){var d=0,d=a%4,d=0!=d?a+4-d:a,f=(this.vertexConst-16)/4;return d>f?f:d},MO.SG3dContextCapability_calculateInstanceCount=function(a,b){var d=(this.vertexConst-16)/(4*a+4),f=cl;0<b&&(f=Math.min(d,this.vertexCount/b));64<f&&(f=64);return f};
with(MO)MO.SG3dLayoutBuffer=function(){this.formatCd=this.index=this.buffer=this.slot=null;this.dispose=SG3dLayoutBuffer_dispose;return this},MO.SG3dLayoutBuffer_dispose=function(){this.formatCd=this.index=this.buffer=this.slot=null};with(MO)MO.SG3dLayoutSampler=function(){this.slot=null;this.index=-1;this.texture=null;this.dispose=SG3dLayoutSampler_dispose;return this},MO.SG3dLayoutSampler_dispose=function(){this.slot=null;this.index=-1;this.texture=null};
with(MO)MO.FG3dBuffer=function(a){a=RClass.inherits(this,a,FG3dObject,MAttributeCode);a.isValid=RMethod.virtual(a,"isValid");return a};
with(MO)MO.FG3dContext=function(a){a=RClass.inherits(this,a,FGraphicContext);a._optionAlpha=!0;a._optionAntialias=!1;a._size=null;a._capability=null;a._statistics=null;a._fillModeCd=EG3dFillMode.Face;a._optionDepth=!1;a._optionCull=!1;a._depthModeCd=0;a._cullModeCd=0;a._statusBlend=!1;a._blendSourceCd=0;a._blendTargetCd=0;a._program=null;a._storePrograms=null;a._storeLayouts=null;a._storeBuffers=null;a._storeTextures=null;a._storeTargets=null;a.construct=FG3dContext_construct;a.linkCanvas=FG3dContext_linkCanvas;
a.size=FG3dContext_size;a.capability=FG3dContext_capability;a.statistics=FG3dContext_statistics;a.createProgram=RMethod.virtual(a,"createProgram");a.createLayout=RMethod.virtual(a,"createLayout");a.createVertexBuffer=RMethod.virtual(a,"createVertexBuffer");a.createIndexBuffer=RMethod.virtual(a,"createIndexBuffer");a.createFlatTexture=RMethod.virtual(a,"createFlatTexture");a.createCubeTexture=RMethod.virtual(a,"createCubeTexture");a.createRenderTarget=RMethod.virtual(a,"createRenderTarget");a.setViewport=
RMethod.virtual(a,"setViewport");a.setFillMode=RMethod.virtual(a,"setFillMode");a.setDepthMode=RMethod.virtual(a,"setDepthMode");a.setCullingMode=RMethod.virtual(a,"setCullingMode");a.setBlendFactors=RMethod.virtual(a,"setBlendFactors");a.setScissorRectangle=RMethod.virtual(a,"setScissorRectangle");a.setRenderTarget=RMethod.virtual(a,"setRenderTarget");a.setProgram=RMethod.virtual(a,"setProgram");a.bindVertexBuffer=RMethod.virtual(a,"bindVertexBuffer");a.bindTexture=RMethod.virtual(a,"bindTexture");
a.prepare=FG3dContext_prepare;a.clear=RMethod.virtual(a,"clear");a.clearColor=RMethod.virtual(a,"clearColor");a.clearDepth=RMethod.virtual(a,"clearDepth");a.drawTriangles=RMethod.virtual(a,"drawTriangles");a.present=RMethod.virtual(a,"present");a.dispose=FG3dContext_dispose;return a},MO.FG3dContext_construct=function(){this.__base.FGraphicContext.construct.call(this);this._size=new SSize2;this._statistics=RClass.create(FG3dStatistics);RConsole.find(FStatisticsConsole).register("graphic3d.context",
this._statistics);this._storePrograms=new TObjects;this._storeLayouts=new TObjects;this._storeBuffers=new TObjects;this._storeTextures=new TObjects;this._storeTargets=new TObjects},MO.FG3dContext_linkCanvas=function(a){this._size.set(a.width,a.height)},MO.FG3dContext_size=function(){return this._size},MO.FG3dContext_capability=function(){return this._capability},MO.FG3dContext_statistics=function(){return this._statistics},MO.FG3dContext_prepare=function(){this._statistics.resetFrame()},MO.FG3dContext_dispose=
function(){var a=this._storePrograms;if(a){for(var b=a.count(),d=0;d<b;d++)a.at(d).dispose();this._storePrograms=RObject.dispose(a)}if(a=this._storeLayouts){b=a.count();for(d=0;d<b;d++)a.at(d).dispose();this._storeLayouts=RObject.dispose(a)}if(a=this._storeBuffers){b=a.count();for(d=0;d<b;d++)a.at(d).dispose();this._storeBuffers=RObject.dispose(a)}if(a=this._storeTextures){b=a.count();for(d=0;d<b;d++)a.at(d).dispose();this._storeTextures=RObject.dispose(a)}if(a=this._storeTargets){b=a.count();for(d=
0;d<b;d++)a.at(d).dispose();this._storeTargets=RObject.dispose(a)}this._program=null;this.__base.FGraphicContext.dispose.call(this)};with(MO)MO.FG3dCubeTexture=function(a){a=RClass.inherits(this,a,FG3dTexture);a.size=0;a.construct=FG3dTexture_construct;a.upload=RMethod.virtual(a,"upload");a.update=RMethod.empty;return a},MO.FG3dTexture_construct=function(){this.__base.FG3dTexture.construct();this._textureCd=EG3dTexture.Cube};
with(MO)MO.FG3dFlatTexture=function(a){a=RClass.inherits(this,a,FG3dTexture);a._optionFlipY=!1;a._size=null;a.construct=FG3dFlatTexture_construct;a.optionFlipY=FG3dFlatTexture_optionFlipY;a.setOptionFlipY=FG3dFlatTexture_setOptionFlipY;a.size=FG3dFlatTexture_size;a.uploadData=RMethod.virtual(a,"uploadData");a.upload=RMethod.virtual(a,"upload");a.update=RMethod.empty;return a},MO.FG3dFlatTexture_construct=function(){this.__base.FG3dTexture.construct();this._textureCd=EG3dTexture.Flat2d},MO.FG3dFlatTexture_optionFlipY=
function(){return this._optionFlipY},MO.FG3dFlatTexture_setOptionFlipY=function(a){this._optionFlipY=a},MO.FG3dFlatTexture_size=function(){return this._size};with(MO)MO.FG3dFragmentShader=function(a){return a=RClass.inherits(this,a,FG3dShader)};
with(MO)MO.FG3dIndexBuffer=function(a){a=RClass.inherits(this,a,FG3dBuffer);a._strideCd=EG3dIndexStride.Uint16;a._count=0;a._fillModeCd=EG3dFillMode.Face;a._lineWidth=1;a.strideCd=FG3dIndexBuffer_strideCd;a.setStrideCd=FG3dIndexBuffer_setStrideCd;a.fillModeCd=FG3dIndexBuffer_fillModeCd;a.setFillModeCd=FG3dIndexBuffer_setFillModeCd;a.lineWidth=FG3dIndexBuffer_lineWidth;a.setLineWidth=FG3dIndexBuffer_setLineWidth;a.count=FG3dIndexBuffer_count;a.upload=RMethod.virtual(a,"upload");return a},MO.FG3dIndexBuffer_strideCd=
function(){return this._strideCd},MO.FG3dIndexBuffer_setStrideCd=function(a){this._strideCd=a},MO.FG3dIndexBuffer_fillModeCd=function(){return this._fillModeCd},MO.FG3dIndexBuffer_setFillModeCd=function(a){this._fillModeCd=a},MO.FG3dIndexBuffer_lineWidth=function(){return this._lineWidth},MO.FG3dIndexBuffer_setLineWidth=function(a){this._lineWidth=a},MO.FG3dIndexBuffer_count=function(){return this._count};
with(MO)MO.FG3dLayout=function(a){a=RClass.inherits(this,a,FG3dObject);a._buffers=null;a._samplers=null;a.buffers=FG3dLayout_buffers;a.linkBuffers=FG3dLayout_linkBuffers;a.bindBuffers=FG3dLayout_bindBuffers;a.samplers=FG3dLayout_samplers;a.linkSamplers=FG3dLayout_linkSamplers;a.bindSamplers=FG3dLayout_bindSamplers;a.unbindSamplers=FG3dLayout_unbindSamplers;a.dispose=FG3dLayout_dispose;return a},MO.FG3dLayout_construct=function(){this.__base.FG3dObject.construct.call(this)},MO.FG3dLayout_buffers=function(){return this._buffers},
MO.FG3dLayout_linkBuffers=function(a){if(!a.isEmpty()){var b=this._buffers;b||(b=this._buffers=new TObjects);b.assign(a)}},MO.FG3dLayout_bindBuffers=function(){var a=this._graphicContext,b=this._buffers;if(b)for(var d=b.count(),f=0;f<d;f++){var h=b.at(f);a.bindVertexBuffer(h.slot,h.buffer,h.index,h.formatCd)}},MO.FG3dLayout_samplers=function(){return this._samplers},MO.FG3dLayout_linkSamplers=function(a){if(!a.isEmpty()){var b=this._samplers;b||(b=this._samplers=new TObjects);b.assign(a)}},MO.FG3dLayout_bindSamplers=
function(){var a=this._graphicContext,b=this._samplers;if(b)for(var d=b.count(),f=0;f<d;f++){var h=b.at(f);a.bindTexture(h.slot,h.index,h.texture)}},MO.FG3dLayout_unbindSamplers=function(){var a=this._graphicContext,b=this._samplers;if(b)for(var d=b.count(),f=0;f<d;f++){var h=b.at(f);a.bindTexture(h.slot,h.index,null)}},MO.FG3dLayout_dispose=function(){this._buffers=RObject.dispose(this._buffers);this._samplers=RObject.dispose(this._samplers);this.__base.FG3dObject.dispose.call(this)};
with(MO)MO.FG3dProgram=function(a){a=RClass.inherits(this,a,FG3dObject);a._attributes=null;a._parameters=null;a._samplers=null;a._vertexShader=null;a._fragmentShader=null;a.hasAttribute=FG3dProgram_hasAttribute;a.registerAttribute=FG3dProgram_registerAttribute;a.findAttribute=FG3dProgram_findAttribute;a.attributes=FG3dProgram_attributes;a.hasParameter=FG3dProgram_hasParameter;a.registerParameter=FG3dProgram_registerParameter;a.findParameter=FG3dProgram_findParameter;a.parameters=FG3dProgram_parameters;
a.hasSampler=FG3dProgram_hasSampler;a.registerSampler=FG3dProgram_registerSampler;a.findSampler=FG3dProgram_findSampler;a.samplers=FG3dProgram_samplers;a.vertexShader=RMethod.virtual(a,"vertexShader");a.fragmentShader=RMethod.virtual(a,"fragmentShader");a.setAttribute=FG3dProgram_setAttribute;a.setParameter=FG3dProgram_setParameter;a.setParameter4=FG3dProgram_setParameter4;a.setSampler=FG3dProgram_setSampler;a.upload=RMethod.virtual(a,"upload");a.dispose=FG3dProgram_dispose;return a},MO.FG3dProgram_hasAttribute=
function(){var a=this._attributes;return a?!a.isEmpty():!1},MO.FG3dProgram_registerAttribute=function(a){var b=RClass.create(FG3dProgramAttribute);b._name=a;this.attributes().set(a,b);return b},MO.FG3dProgram_findAttribute=function(a){return this._attributes?this._attributes.get(a):null},MO.FG3dProgram_attributes=function(){var a=this._attributes;null==a&&(a=this._attributes=new TDictionary);return a},MO.FG3dProgram_hasParameter=function(){var a=this._parameters;return a?!a.isEmpty():!1},MO.FG3dProgram_registerParameter=
function(a,b){var d=RClass.create(FG3dProgramParameter);d._name=a;d.formatCd=b;this.parameters().set(a,d);return d},MO.FG3dProgram_findParameter=function(a){return this._parameters?this._parameters.get(a):null},MO.FG3dProgram_parameters=function(){var a=this._parameters;null==a&&(a=this._parameters=new TDictionary);return a},MO.FG3dProgram_hasSampler=function(){var a=this._samplers;return a?!a.isEmpty():!1},MO.FG3dProgram_registerSampler=function(a){var b=RClass.create(FG3dProgramSampler);b._name=
a;this.samplers().set(a,b);return b},MO.FG3dProgram_findSampler=function(a){return this._samplers?this._samplers.get(a):null},MO.FG3dProgram_samplers=function(){var a=this._samplers;null==a&&(a=this._samplers=new TDictionary);return a},MO.FG3dProgram_setAttribute=function(a,b,d){var f=this.findAttribute(a);if(null==f)throw new TError(this,"Bind invalid attribute. (name={1})",a);this._graphicContext.bindVertexBuffer(f._slot,b,0,d)},MO.FG3dProgram_setParameter=function(a,b,d){var f=this.findParameter(a);
if(null==f)throw new TError(this,"Bind invalid parameter. (name={1})",a);var h=null,h=b.constructor;if(h==Float32Array||h==SMatrix3d||h==SPerspectiveMatrix3d)h=b;else if(h==SColor4)h=RTypeArray.float4(),h[0]=b.red,h[1]=b.green,h[2]=b.blue,h[3]=b.alpha;else if(h==SPoint3||h==SVector3)h=RTypeArray.float3(),h[0]=b.x,h[1]=b.y,h[2]=b.z;else if(h==SPoint4||h==SVector4)h=RTypeArray.float4(),h[0]=b.x,h[1]=b.y,h[2]=b.z,h[3]=b.w;else throw new TError(this,"Bind invalid parameter type. (name={1}, type={2})",
a,h);f.attachData(h)&&this._graphicContext.bindConst(null,f._slot,f._formatCd,h,d)},MO.FG3dProgram_setParameter4=function(a,b,d,f,h){var k=RTypeArray.float4();k[0]=b;k[1]=d;k[2]=f;k[3]=h;this.setParameter(a,k,1)},MO.FG3dProgram_setSampler=function(a,b){var d=this.findSampler(a);if(null==d)throw new TError(this,"Bind invalid sampler. (name={1})",a);this._graphicContext.bindTexture(d._slot,d._index,b)},MO.FG3dProgram_dispose=function(){this._vertexShader=RObject.dispose(this._vertexShader);this._fragmentShader=
RObject.dispose(this._fragmentShader);this.__base.FG3dObject.dispose.call(this)};
with(MO)MO.FG3dProgramAttribute=function(a){a=RClass.inherits(this,a,FObject);a._name=null;a._linker=null;a._statusUsed=!1;a._slot=-1;a._index=-1;a._formatCd=EG3dAttributeFormat.Unknown;a.name=FG3dProgramAttribute_name;a.linker=FG3dProgramAttribute_linker;a.loadConfig=FG3dProgramAttribute_loadConfig;return a},MO.FG3dProgramAttribute_name=function(){return this._name},MO.FG3dProgramAttribute_linker=function(){return this._linker},MO.FG3dProgramAttribute_loadConfig=function(a){this._name=a.get("name");
this._linker=a.get("linker");this._formatCd=REnum.encode(EG3dAttributeFormat,a.get("format"))};
with(MO)MO.FG3dProgramParameter=function(a){a=RClass.inherits(this,a,FObject);a._name=null;a._linker=null;a._formatCd=EG3dParameterFormat.Unknown;a._define=null;a._statusUsed=!1;a._slot=null;a._size=0;a._buffer=null;a._memory=null;a.name=FG3dProgramParameter_name;a.linker=FG3dProgramParameter_linker;a.define=FG3dProgramParameter_define;a.attachData=FG3dProgramParameter_attachData;a.loadConfig=FG3dProgramParameter_loadConfig;return a},MO.FG3dProgramParameter_name=function(){return this._name},MO.FG3dProgramParameter_linker=
function(){return this._linker},MO.FG3dProgramParameter_define=function(){return this._define},MO.FG3dProgramParameter_attachData=function(a){var b=!1,b=a.constructor;if(b==SMatrix3d)b=this._memory,b||(b=this._memory=new Float32Array(16)),b=RFloat.attach(b,a._data,16);else if(b==Float32Array){var d=a.length,b=this._memory;b||(b=this._memory=new Float32Array(d));b=RFloat.attach(b,a,d)}else throw new TError(this,"Unknown data type.");return b},MO.FG3dProgramParameter_loadConfig=function(a){this._name=
a.get("name");this._linker=a.get("linker");this._formatCd=REnum.encode(EG3dParameterFormat,a.get("format"));this._define=a.get("define")};
with(MO)MO.FG3dProgramSampler=function(a){a=RClass.inherits(this,a,FObject);a._name=null;a._linker=null;a._statusUsed=!1;a._formatCd=EG3dTexture.Flat2d;a._bind=!0;a._slot=-1;a._index=0;a._source=null;a.name=FG3dProgramSampler_name;a.linker=FG3dProgramSampler_linker;a.formatCd=FG3dProgramSampler_formatCd;a.loadConfig=FG3dProgramSampler_loadConfig;return a},MO.FG3dProgramSampler_name=function(){return this._name},MO.FG3dProgramSampler_linker=function(){return this._linker},MO.FG3dProgramSampler_formatCd=
function(){return this._formatCd},MO.FG3dProgramSampler_loadConfig=function(a){this._name=a.get("name");this._linker=a.get("linker");this._bind=RBoolean.parse(a.get("bind","Y"));this._formatCd=REnum.encode(EG3dTexture,a.get("format","Flat2d"))};
with(MO)MO.FG3dRenderTarget=function(a){a=RClass.inherits(this,a,FG3dObject);a._size=null;a._color=null;a._textures=null;a.construct=FG3dRenderTarget_construct;a.size=FG3dRenderTarget_size;a.color=FG3dRenderTarget_color;a.textures=FG3dRenderTarget_textures;return a},MO.FG3dRenderTarget_construct=function(){this.__base.FG3dObject.construct();this._size=new SSize2;this._color=new SColor4;this._color.set(0,0,0,1)},MO.FG3dRenderTarget_size=function(){return this._size},MO.FG3dRenderTarget_color=function(){return this._color},
MO.FG3dRenderTarget_textures=function(){var a=this._textures;null==a&&(a=this._textures=new TObjects);return a};with(MO)MO.FG3dShader=function(a){a=RClass.inherits(this,a,FG3dObject);a._source=null;a.source=FG3dShader_source;a.upload=RMethod.virtual(a,"upload");return a},MO.FG3dShader_source=function(){return this._source};
with(MO)MO.FG3dStatistics=function(a){a=RClass.inherits(this,a,FStatistics);a._frameClearCount=0;a._frameFillModeCount=0;a._frameDepthModeCount=0;a._frameCullModeCount=0;a._frameBlendModeCount=0;a._frameProgramCount=0;a._frameConstCount=0;a._frameConstLength=0;a._frameBufferCount=0;a._frameTextureCount=0;a._frameTargetCount=0;a._frameDrawCount=0;a._frameTriangleCount=0;a._programTotal=0;a._layoutTotal=0;a._vertexBufferTotal=0;a._indexBufferTotal=0;a._flatTextureTotal=0;a._cubeTextureTotal=0;a._targetTotal=
0;a.reset=FG3dStatistics_reset;a.resetFrame=FG3dStatistics_resetFrame;return a},MO.FG3dStatistics_reset=function(){o._programTotal=0;o._layoutTotal=0;o._vertexBufferTotal=0;o._indexBufferTotal=0;o._flatTextureTotal=0;o._cubeTextureTotal=0;o._targetTotal=0},MO.FG3dStatistics_resetFrame=function(){this._frameDrawCount=this._frameTriangleCount=this._frameTargetCount=this._frameTextureCount=this._frameBufferCount=this._frameConstLength=this._frameConstCount=this._frameProgramCount=this._frameBlendModeCount=
this._frameCullModeCount=this._frameDepthModeCount=this._frameFillModeCount=this._frameClearCount=0};
with(MO)MO.FG3dTexture=function(a){a=RClass.inherits(this,a,FG3dObject);a._textureCd=EG3dTexture.Unknown;a._filterMinCd=EG3dSamplerFilter.Linear;a._filterMagCd=EG3dSamplerFilter.Linear;a._wrapS=EG3dSamplerFilter.Unknown;a._wrapT=EG3dSamplerFilter.Unknown;a._statusLoad=!1;a.isValid=RMethod.virtual(a,"isValid");a.textureCd=FG3dTexture_textureCd;a.filterMinCd=FG3dTexture_filterMinCd;a.filterMagCd=FG3dTexture_filterMagCd;a.setFilterCd=FG3dTexture_setFilterCd;a.wrapS=FG3dTexture_wrapS;a.wrapT=FG3dTexture_wrapT;
a.setWrapCd=FG3dTexture_setWrapCd;return a},MO.FG3dTexture_textureCd=function(){return this._textureCd},MO.FG3dTexture_filterMinCd=function(){return this._filterMinCd},MO.FG3dTexture_filterMagCd=function(){return this._filterMagCd},MO.FG3dTexture_setFilterCd=function(a,b){this._filterMinCd=a;this._filterMagCd=b},MO.FG3dTexture_wrapS=function(){return this._wrapS},MO.FG3dTexture_wrapT=function(){return this._wrapT},MO.FG3dTexture_setWrapCd=function(a,b){this._wrapS=a;this._wrapT=b};
with(MO)MO.FG3dVertexBuffer=function(a){a=RClass.inherits(this,a,FG3dBuffer);a._formatCd=EG3dAttributeFormat.Unknown;a._stride=0;a._count=0;a.formatCd=FG3dVertexBuffer_formatCd;a.setFormatCd=FG3dVertexBuffer_setFormatCd;a.stride=FG3dVertexBuffer_stride;a.setStride=FG3dVertexBuffer_setStride;a.count=FG3dVertexBuffer_count;a.setCount=FG3dVertexBuffer_setCount;a.upload=RMethod.virtual(a,"upload");return a},MO.FG3dVertexBuffer_formatCd=function(){return this._formatCd},MO.FG3dVertexBuffer_setFormatCd=
function(a){this._formatCd=a},MO.FG3dVertexBuffer_stride=function(){return this._stride},MO.FG3dVertexBuffer_setStride=function(a){this._stride=a},MO.FG3dVertexBuffer_count=function(){return this._count},MO.FG3dVertexBuffer_setCount=function(a){this._count=a};with(MO)MO.FG3dVertexShader=function(a){return a=RClass.inherits(this,a,FG3dShader)};
with(MO)MO.FG3dAutomaticEffect=function(a){a=RClass.inherits(this,a,FG3dEffect);a._optionMerge=!1;a._optionBlendMode=!0;a._supportInstance=!1;a._supportLayout=!1;a._supportMaterialMap=!1;a._supportVertexColor=!0;a._supportVertexCoord=!0;a._supportVertexNormal=!0;a._supportVertexNormalFull=!0;a._supportVertexNormalCompress=!1;a._supportSkeleton=!1;a._supportAlpha=!0;a._supportAmbient=!0;a._supportDiffuse=!0;a._supportDiffuseView=!0;a._supportSpecularColor=!0;a._supportSpecularLevel=!0;a._supportSpecularView=
!0;a._supportLight=!0;a._supportReflect=!0;a._supportRefract=!0;a._supportEmissive=!0;a._supportHeight=!0;a._supportEnvironment=!0;a._dynamicSkeleton=!0;a.setup=FG3dAutomaticEffect_setup;a.buildInfo=FG3dAutomaticEffect_buildInfo;a.bindAttributes=FG3dAutomaticEffect_bindAttributes;a.bindSamplers=FG3dAutomaticEffect_bindSamplers;a.bindMaterialSamplers=FG3dAutomaticEffect_bindMaterialSamplers;a.bindMaterial=FG3dAutomaticEffect_bindMaterial;a.drawRenderable=FG3dAutomaticEffect_drawRenderable;return a},
MO.FG3dAutomaticEffect_setup=function(){this._supportLayout=this._graphicContext.capability().optionLayout},MO.FG3dAutomaticEffect_buildInfo=function(a,b){var d=this._graphicContext.capability(),f=new TString;f.append(b.techniqueModeCode);a.set("technique.mode",b.techniqueModeCode);if(this._optionMerge=b.optionMerge){var h=b.mergeCount;f.append("|OI"+h);a.setBoolean("option.instance",!0);a.set("instance.count",h)}d.optionMaterialMap&&(f.append("|OM"),a.setBoolean("option.material.map",!0),this._supportMaterialMap=
!0);b.optionNormalInvert&&(f.append("|ON"),a.setBoolean("option.normal.invert",!0),this._supportNormalInvert=!0);b.optionColor&&(f.append("|OC"),a.setBoolean("option.color",!0),this.optionAmbient=!0);b.optionAmbient&&(f.append("|OA"),a.setBoolean("option.ambient",!0),this.optionAmbient=!0);b.optionDiffuse&&(f.append("|OD"),a.setBoolean("option.diffuse",!0),this.optionDiffuse=!0);b.optionSpecular&&(f.append("|OS"),a.setBoolean("option.specular",!0),this.optionSpecular=!0);b.optionReflect&&(f.append("|ORL"),
a.setBoolean("option.reflect",!0),this.optionReflect=!0);b.optionRefract&&(f.append("|ORF"),a.setBoolean("option.refract",!0),this.optionRefract=!0);h=b.attributeContains(EG3dAttribute.Color);if(this._dynamicVertexColor=this._supportVertexColor&&h)f.append("|AC"),a.setBoolean("vertex.attribute.color",!0);h=b.attributeContains(EG3dAttribute.Coord);if(this._dynamicVertexCoord=this._supportVertexCoord&&h)f.append("|AD"),a.setBoolean("vertex.attribute.coord",!0);h=b.attributeContains(EG3dAttribute.Normal);
if(this._dynamicVertexNormal=this._supportVertexNormal&&h)f.append("|AN"),a.setBoolean("vertex.attribute.normal",!0);var k=b.attributeContains(EG3dAttribute.Binormal),q=b.attributeContains(EG3dAttribute.Tangent);if(this._dynamicVertexNormalFull=this._supportVertexNormalFull&&h&&k&&q)f.append("|ANF"),a.setBoolean("vertex.attribute.normal.full",!0);if(this._dynamicVertexNormalCompress=b.optionNormalCompress)f.append("|ANC"),a.setBoolean("vertex.attribute.normal.compress",!0);if(this._dynamicInstance=
this._supportInstance&&d.optionInstance)f.append("|SI"),b&&a.setBoolean("support.instance",!0);if(this._dynamicSkeleton=this._supportSkeleton)f.append("|SS"),b&&a.setBoolean("support.skeleton",!0);h=b.samplerContains(EG3dSampler.Diffuse);(this._dynamicAlpha=this._supportAlpha)?(f.append("|RA"),b&&a.setBoolean("support.alpha",!0),this._optionBlendMode=!0):this._optionBlendMode=!1;if(this._dynamicAmbient=this._supportAmbient)f.append("|TA"),b&&a.setBoolean("support.ambient",!0),h&&(f.append("|TAS"),
b&&a.setBoolean("support.ambient.sampler",!0));b.samplerContains(EG3dSampler.Alpha)&&a.setBoolean("support.alpha.sampler",!0);h=b.samplerContains(EG3dSampler.Normal);this._dynamicDiffuse=this._supportDiffuse&&(this._dynamicVertexNormal||h);this._supportDiffuse&&(b&&a.setBoolean("support.diffuse",!0),h?(f.append("|TDD"),b&&(a.setBoolean("support.dump",!0),a.setBoolean("support.diffuse.dump",!0))):this._dynamicVertexNormal&&(f.append("|TDN"),b&&a.setBoolean("support.diffuse.normal",!0)));this._dynamicDiffuseView=
this._supportDiffuseView&&(this._dynamicVertexNormal||h);this._supportDiffuseView&&(b&&a.setBoolean("support.diffuse.view",!0),h?(f.append("|TDVD"),b&&(a.setBoolean("support.dump",!0),a.setBoolean("support.diffuse.view.dump",!0))):this._dynamicVertexNormal&&(f.append("|TDVN"),b&&a.setBoolean("support.diffuse.view.normal",!0)));h=b.samplerContains(EG3dSampler.SpecularColor);k=b.samplerContains(EG3dSampler.SpecularLevel);this._dynamicSpecularColor=this._supportSpecularColor&&h;this._dynamicSpecularLevel=
this._supportSpecularLevel&&k;(this._dynamicSpecularColor||this._dynamicSpecularLevel)&&this._dynamicVertexNormal&&(f.append("|TS"),b&&a.setBoolean("support.specular",!0),this._dynamicSpecularColor&&(f.append("|TSC"),b&&a.setBoolean("support.specular.color",!0)),this._dynamicSpecularLevel?(f.append("|TSL"),b&&a.setBoolean("support.specular.level",!0)):(f.append("|NSL"),b&&a.setBoolean("support.specular.normal",!0)));(this._dynamicSpecularView=this._supportSpecularView)&&this._dynamicVertexNormal&&
(f.append("|TSV"),b&&a.setBoolean("support.specular.view",!0),this._dynamicSpecularColor&&(f.append("|TSVC"),b&&a.setBoolean("support.specular.view.color",!0)),this._dynamicSpecularLevel?(f.append("|TSVL"),b&&a.setBoolean("support.specular.view.level",!0)):(f.append("|NSVL"),b&&a.setBoolean("support.specular.view.normal",!0)));h=b.samplerContains(EG3dSampler.Light);if(this._dynamicLight=this._supportLight&&h)f.append("|TL"),b&&(a.setBoolean("support.sampler.light",!0),a.setBoolean("support.light",
!0));h=b.samplerContains(EG3dSampler.Reflect);if(this._dynamicReflect=this._supportReflect&&h)f.append("|TRL"),b&&(a.setBoolean("support.sampler.light",!0),a.setBoolean("support.reflect",!0));h=b.samplerContains(EG3dSampler.Refract);if(this._dynamicRefract=this._supportRefract&&h)f.append("|TRF"),b&&(a.setBoolean("support.sampler.light",!0),a.setBoolean("support.refract",!0));h=b.samplerContains(EG3dSampler.Emissive);if(this._dynamicEmissive=this._supportEmissive&&h)f.append("|TLE"),b&&(a.setBoolean("support.sampler.light",
!0),a.setBoolean("support.emissive",!0));h=b.samplerContains(EG3dSampler.Height);if(this._dynamicHeight=this._supportHeight&&h)f.append("|TH"),b&&a.setBoolean("support.height",!0);h=b.samplerContains(EG3dSampler.Environment);if(this._dynamicEnvironment=this._supportEnvironment&&h)f.append("|TE"),b&&a.setBoolean("support.environment",!0);this._dynamicSkeleton&&(d=d.calculateBoneCount(b.vertexBoneCount,b.vertexCount),f.append("|B"+d),a.set("bone.count",d),a.set("bone.array.count",3*d),a.setBoolean("support.bone.weight.1",
!0),a.setBoolean("support.bone.weight.2",!0),a.setBoolean("support.bone.weight.3",!0),a.setBoolean("support.bone.weight.4",!0));a.code=f.flush()},MO.FG3dAutomaticEffect_bindAttributes=function(a){var b=this._program;if(b.hasAttribute())for(var d=b.attributes(),f=d.count(),h=0;h<f;h++){var k=d.at(h);if(k._statusUsed){var q=a.findVertexBuffer(k._linker);b.setAttribute(k._name,q,q._formatCd)}}},MO.FG3dAutomaticEffect_bindSamplers=function(a){var b=this._program;this._supportMaterialMap&&b.setSampler("fs_material",
region.materialMap().texture());if(b.hasSampler())for(var d=b.samplers(),f=d.count(),h=0;h<f;h++){var k=d.at(h);if(k._bind&&k._statusUsed){var q=k.linker(),q=a.findTexture(q);b.setSampler(k.name(),q.texture())}}},MO.FG3dAutomaticEffect_bindMaterialSamplers=function(a,b){var d=this._program;if(d.hasSampler())for(var f=d.samplers(),h=f.count(),k=0;k<h;k++){var q=f.at(k);if(q._bind&&q._statusUsed){var w=q.linker(),w=b.findBitmap(w);d.setSampler(q.name(),w.texture())}}},MO.FG3dAutomaticEffect_bindMaterial=
function(a){var b=this._graphicContext;a=a.info();a.optionDepth?b.setDepthMode(this._stateDepth,this._stateDepthCd):b.setDepthMode(!1);a.optionAlpha?b.setBlendFactors(this._stateBlend,this._stateBlendSourceCd,this._stateBlendTargetCd):b.setBlendFactors(!1);a.optionDouble?b.setCullingMode(!1):b.setCullingMode(this._stateDepth,this._stateCullCd)},MO.FG3dAutomaticEffect_drawRenderable=function(a,b){var d=this._graphicContext,f=b.activeInfo(),h=f.layout;h?(this._supportLayout?h.active():h.bindBuffers(),
h.bindSamplers()):(h=f.layout=d.createLayout(),this._supportLayout?(h.bind(),this.bindAttributes(b),h.unbind(),h.active()):(d.recordBegin(),this.bindAttributes(b),d.recordEnd(),h.linkBuffers(d.recordBuffers())),d.recordBegin(),this.bindSamplers(b),d.recordEnd(),h.linkSamplers(d.recordSamplers()));var f=0,k=b.indexBuffers();k&&(f=k.count());if(1<f)for(var q=b.materials(),w=0;w<f;w++){var x=k.at(w);if(q){var y=q.at(w);y&&this.bindMaterialSamplers(b,y)}d.drawTriangles(x)}else d.drawTriangles(b.indexBuffer());
this._supportLayout&&h.deactive()};
with(MO)MO.FG3dSelectAutomaticEffect=function(a){a=RClass.inherits(this,a,FG3dAutomaticEffect);a._code="select.automatic";a.drawRenderable=FG3dSelectAutomaticEffect_drawRenderable;return a},MO.FG3dSelectAutomaticEffect_drawRenderable=function(a,b,d){var f=this._graphicContext,h=f.size(),k=this._program,q=a._selectX,w=a._selectY,x=b.material(),y=x.info();this.bindMaterial(x);k.setParameter("vc_model_matrix",b.currentMatrix());k.setParameter("vc_vp_matrix",a.calculate(EG3dRegionParameter.CameraViewProjectionMatrix));k.setParameter4("vc_offset",
h.width,h.height,1-q/h.width*2,w/h.height*2-1);a=d+1;k.setParameter4("fc_index",(a&255)/255,(a>>8&255)/255,(a>>16&255)/255,y.alphaBase);this.bindAttributes(b);this.bindSamplers(b);f.drawTriangles(b.indexBuffer())};
with(MO)MO.FG3dSelectPass=function(a){a=RClass.inherits(this,a,FG3dTechniquePass);a._code="select";a._texture=null;a._renderTarget=null;a._position=null;a._data=null;a.construct=FG3dSelectPass_construct;a.setup=FG3dSelectPass_setup;a.textureDepth=FG3dSelectPass_texture;a.drawRegion=FG3dSelectPass_drawRegion;return a},MO.FG3dSelectPass_construct=function(){this.__base.FG3dTechniquePass.construct.call(this);this._data=new Uint8Array(4);this._position=new SPoint2},MO.FG3dSelectPass_setup=function(){this.__base.FG3dTechniquePass.setup.call(this);
var a=this._graphicContext,b=this._texture=a.createFlatTexture();b.setFilterCd(EG3dSamplerFilter.Nearest,EG3dSamplerFilter.Nearest);b.setWrapCd(EG3dSamplerFilter.ClampToEdge,EG3dSamplerFilter.ClampToEdge);a=this._renderTarget=a.createRenderTarget();a.size().set(1,1);a.textures().push(b);a.build()},MO.FG3dSelectPass_texture=function(){return this._texture},MO.FG3dSelectPass_drawRegion=function(a){var b=this._graphicContext,d=b._native;b.setRenderTarget(this._renderTarget);b.clear(0,0,0,0,1,1);var f=
a.allRenderables();this.activeEffects(a,f);for(var h=f.count(),k=0;k<h;k++){var q=f.get(k),w=q.activeEffect();b.setProgram(w.program());var x=q.display();x?x._optionFace||w.drawRenderable(a,q,k):w.drawRenderable(a,q,k)}b.clearDepth(1);for(k=0;k<h;k++)q=f.get(k),w=q.activeEffect(),b.setProgram(w.program()),(x=q.display())&&x._optionFace&&w.drawRenderable(a,q,k);d.readPixels(0,0,1,1,d.RGBA,d.UNSIGNED_BYTE,this._data);a=this._data[0]+(this._data[1]<<8)+(this._data[2]<<16);this._selectRenderable=null;
0!=a&&(this._selectRenderable=f.get(a-1))};
with(MO)MO.FG3dSelectSkeletonEffect=function(a){a=RClass.inherits(this,a,FG3dAutomaticEffect);a._code="select.automatic";a.drawRenderable=FG3dSelectSkeletonEffect_drawRenderable;return a},MO.FG3dSelectSkeletonEffect_drawRenderable=function(a,b,d){var f=this._graphicContext,h=f.size(),k=this._program,q=a._selectX,w=a._selectY,x=b.material(),y=x.info();this.bindMaterial(x);k.setParameter("vc_model_matrix",b.currentMatrix());k.setParameter("vc_vp_matrix",a.calculate(EG3dRegionParameter.CameraViewProjectionMatrix));k.setParameter4("vc_offset",
h.width,h.height,1-q/h.width*2,w/h.height*2-1);a=d+1;k.setParameter4("fc_index",(a&255)/255,(a>>8&255)/255,(a>>16&255)/255,y.alphaBase);this.bindAttributes(b);this.bindSamplers(b);f.drawTriangles(b.indexBuffer())};
with(MO)MO.FG3dSelectTechnique=function(a){a=RClass.inherits(this,a,FG3dTechnique);a._code="select";a._passSelect=null;a.setup=FG3dSelectTechnique_setup;a.passSelect=FG3dSelectTechnique_passSelect;a.test=FG3dSelectTechnique_test;return a},MO.FG3dSelectTechnique_setup=function(){this.__base.FG3dTechnique.setup.call(this);this.registerMode(EG3dTechniqueMode.Result);var a=this._passSelect=RClass.create(FG3dSelectPass);a.linkGraphicContext(this);a.setup();this._passes.push(a)},MO.FG3dSelectTechnique_passSelect=
function(){return this._passSelect},MO.FG3dSelectTechnique_test=function(a,b,d){a._selectX=b;a._selectY=d;a.setTechnique(this);this.drawRegion(a);return this._passSelect._selectRenderable};
with(MO)MO.FWglContext=function(a){a=RClass.inherits(this,a,FG3dContext);a._native=null;a._nativeInstance=null;a._nativeLayout=null;a._nativeDebugShader=null;a._activeRenderTarget=null;a._activeTextureSlot=null;a._parameters=null;a._extensions=null;a._statusRecord=!1;a._recordBuffers=null;a._recordSamplers=null;a._data9=null;a._data16=null;a.construct=FWglContext_construct;a.linkCanvas=FWglContext_linkCanvas;a.parameters=FWglContext_parameters;a.extensions=FWglContext_extensions;a.recordBuffers=FWglContext_recordBuffers;
a.recordSamplers=FWglContext_recordSamplers;a.recordBegin=FWglContext_recordBegin;a.recordEnd=FWglContext_recordEnd;a.createProgram=FWglContext_createProgram;a.createLayout=FWglContext_createLayout;a.createVertexBuffer=FWglContext_createVertexBuffer;a.createIndexBuffer=FWglContext_createIndexBuffer;a.createFlatTexture=FWglContext_createFlatTexture;a.createCubeTexture=FWglContext_createCubeTexture;a.createRenderTarget=FWglContext_createRenderTarget;a.setViewport=FWglContext_setViewport;a.setFillMode=
FWglContext_setFillMode;a.setDepthMode=FWglContext_setDepthMode;a.setCullingMode=FWglContext_setCullingMode;a.setBlendFactors=FWglContext_setBlendFactors;a.setScissorRectangle=FWglContext_setScissorRectangle;a.setRenderTarget=FWglContext_setRenderTarget;a.setProgram=FWglContext_setProgram;a.bindConst=FWglContext_bindConst;a.bindVertexBuffer=FWglContext_bindVertexBuffer;a.bindTexture=FWglContext_bindTexture;a.clear=FWglContext_clear;a.clearColor=FWglContext_clearColor;a.clearDepth=FWglContext_clearDepth;
a.readPixels=FWglContext_readPixels;a.drawTriangles=FWglContext_drawTriangles;a.present=FWglContext_present;a.checkError=FWglContext_checkError;return a},MO.FWglContext_construct=function(){this.__base.FG3dContext.construct.call(this);this._capability=new SG3dContextCapability;this._data9=new Float32Array(9);this._data16=new Float32Array(16);this._recordBuffers=new TObjects;this._recordSamplers=new TObjects},MO.FWglContext_linkCanvas=function(a){this.__base.FG3dContext.linkCanvas.call(this,a);this._hCanvas=
a;if(a.getContext){var b={};b.alpha=this._optionAlpha;b.antialias=this._optionAntialias;var d=a.getContext("experimental-webgl",b);null==d&&(d=a.getContext("webgl",b));if(null==d)throw new TError("Current browser can't support WebGL technique.");this._native=d;this._contextAttributes=d.getContextAttributes()}b=this._native;this.setViewport(0,0,a.width,a.height);this.setDepthMode(!0,EG3dDepthMode.LessEqual);this.setCullingMode(!0,EG3dCullMode.Front);a=this._capability;a.vendor=b.getParameter(b.VENDOR);
a.version=b.getParameter(b.VERSION);a.shaderVersion=b.getParameter(b.SHADING_LANGUAGE_VERSION);a.attributeCount=b.getParameter(b.MAX_VERTEX_ATTRIBS);a.vertexConst=b.getParameter(b.MAX_VERTEX_UNIFORM_VECTORS);a.varyingCount=b.getParameter(b.MAX_VARYING_VECTORS);a.fragmentConst=b.getParameter(b.MAX_FRAGMENT_UNIFORM_VECTORS);a.samplerCount=b.getParameter(b.MAX_VERTEX_TEXTURE_IMAGE_UNITS);a.samplerSize=b.getParameter(b.MAX_TEXTURE_SIZE);if(d=this._nativeInstance=b.getExtension("ANGLE_instanced_arrays"))a.optionInstance=
!0;a.mergeCount=parseInt((a.vertexConst-32)/4);if(d=this._nativeLayout=b.getExtension("OES_vertex_array_object"))a.optionLayout=!0;if(d=b.getExtension("OES_element_index_uint"))a.optionIndex32=!0;if(d=this._nativeSamplerS3tc=b.getExtension("WEBGL_compressed_texture_s3tc"))a.samplerCompressRgb=d.COMPRESSED_RGB_S3TC_DXT1_EXT,a.samplerCompressRgba=d.COMPRESSED_RGBA_S3TC_DXT5_EXT;var d=a.shader={},f=d.vertexPrecision={};b.getShaderPrecisionFormat&&(f.floatLow=b.getShaderPrecisionFormat(b.VERTEX_SHADER,
b.LOW_FLOAT),f.floatMedium=b.getShaderPrecisionFormat(b.VERTEX_SHADER,b.MEDIUM_FLOAT),f.floatHigh=b.getShaderPrecisionFormat(b.VERTEX_SHADER,b.HIGH_FLOAT),f.intLow=b.getShaderPrecisionFormat(b.VERTEX_SHADER,b.LOW_INT),f.intMedium=b.getShaderPrecisionFormat(b.VERTEX_SHADER,b.MEDIUM_INT),f.intHigh=b.getShaderPrecisionFormat(b.VERTEX_SHADER,b.HIGH_INT));d=d.fragmentPrecision={};b.getShaderPrecisionFormat&&(d.floatLow=b.getShaderPrecisionFormat(b.FRAGMENT_SHADER,b.LOW_FLOAT),d.floatMedium=b.getShaderPrecisionFormat(b.FRAGMENT_SHADER,
b.MEDIUM_FLOAT),d.floatHigh=b.getShaderPrecisionFormat(b.FRAGMENT_SHADER,b.HIGH_FLOAT),d.intLow=b.getShaderPrecisionFormat(b.FRAGMENT_SHADER,b.LOW_INT),d.intMedium=b.getShaderPrecisionFormat(b.FRAGMENT_SHADER,b.MEDIUM_INT),d.intHigh=b.getShaderPrecisionFormat(b.FRAGMENT_SHADER,b.HIGH_INT));if(d=this._nativeDebugShader=b.getExtension("WEBGL_debug_shaders"))a.optionShaderSource=!0},MO.FWglContext_parameters=function(){var a=this._parameters;if(a)return a;for(var b="ACTIVE_TEXTURE ALIASED_LINE_WIDTH_RANGE ALIASED_POINT_SIZE_RANGE ALPHA_BITS ARRAY_BUFFER_BINDING BLEND BLEND_COLOR BLEND_DST_ALPHA BLEND_DST_RGB BLEND_EQUATION_ALPHA BLEND_EQUATION_RGB BLEND_SRC_ALPHA BLEND_SRC_RGB BLUE_BITS COLOR_CLEAR_VALUE COLOR_WRITEMASK COMPRESSED_TEXTURE_FORMATS CULL_FACE CULL_FACE_MODE CURRENT_PROGRAM DEPTH_BITS DEPTH_CLEAR_VALUE DEPTH_FUNC DEPTH_RANGE DEPTH_TEST DEPTH_WRITEMASK DITHER ELEMENT_ARRAY_BUFFER_BINDING FRAMEBUFFER_BINDING FRONT_FACE GENERATE_MIPMAP_HINT GREEN_BITS IMPLEMENTATION_COLOR_READ_FORMAT IMPLEMENTATION_COLOR_READ_TYPE LINE_WIDTH MAX_COMBINED_TEXTURE_IMAGE_UNITS MAX_CUBE_MAP_TEXTURE_SIZE MAX_FRAGMENT_UNIFORM_VECTORS MAX_RENDERBUFFER_SIZE MAX_TEXTURE_IMAGE_UNITS MAX_TEXTURE_SIZE MAX_VARYING_VECTORS MAX_VERTEX_ATTRIBS MAX_VERTEX_TEXTURE_IMAGE_UNITS MAX_VERTEX_UNIFORM_VECTORS MAX_VIEWPORT_DIMS PACK_ALIGNMENT POLYGON_OFFSET_FACTOR POLYGON_OFFSET_FILL POLYGON_OFFSET_UNITS RED_BITS RENDERBUFFER_BINDING RENDERER SAMPLE_BUFFERS SAMPLE_COVERAGE_INVERT SAMPLE_COVERAGE_VALUE SAMPLES SCISSOR_BOX SCISSOR_TEST SHADING_LANGUAGE_VERSION STENCIL_BACK_FAIL STENCIL_BACK_FUNC STENCIL_BACK_PASS_DEPTH_FAIL STENCIL_BACK_PASS_DEPTH_PASS STENCIL_BACK_REF STENCIL_BACK_VALUE_MASK STENCIL_BACK_WRITEMASK STENCIL_BITS STENCIL_CLEAR_VALUE STENCIL_FAIL STENCIL_FUNC STENCIL_PASS_DEPTH_FAIL STENCIL_PASS_DEPTH_PASS STENCIL_REF STENCIL_TEST STENCIL_VALUE_MASK STENCIL_WRITEMASK SUBPIXEL_BITS TEXTURE_BINDING_2D TEXTURE_BINDING_CUBE_MAP UNPACK_ALIGNMENT UNPACK_COLORSPACE_CONVERSION_WEBGL UNPACK_FLIP_Y_WEBGL UNPACK_PREMULTIPLY_ALPHA_WEBGL VENDOR VERSION VIEWPORT".split(" "),
d=this._native,f=b.length,a={},h=0;h<f;h++){var k=b[h];a[k]=d.getParameter(d[k])}if(b=d.getExtension("WEBGL_debug_renderer_info"))a.UNMASKED_RENDERER_WEBGL=d.getParameter(b.UNMASKED_RENDERER_WEBGL),a.UNMASKED_VENDOR_WEBGL=d.getParameter(b.UNMASKED_VENDOR_WEBGL);return this._parameters=a},MO.FWglContext_extensions=function(){var a=this._extensions;if(!a)for(var a=this._extensions={},b=this._native,d=b.getSupportedExtensions(),f=d.length,h=0;h<f;h++){var k=d[h];a[k]=b.getExtension(k)}return a},MO.FWglContext_recordBuffers=
function(){return this._recordBuffers},MO.FWglContext_recordSamplers=function(){return this._recordSamplers},MO.FWglContext_recordBegin=function(){this._recordBuffers.clear();this._recordSamplers.clear();this._statusRecord=!0},MO.FWglContext_recordEnd=function(){this._statusRecord=!1},MO.FWglContext_createProgram=function(){var a=RClass.create(FWglProgram);a.linkGraphicContext(this);a.setup();this._storePrograms.push(a);this._statistics._programTotal++;return a},MO.FWglContext_createLayout=function(){var a=
RClass.create(FWglLayout);a.linkGraphicContext(this);this._capability.optionLayout&&a.setup();this._storeLayouts.push(a);this._statistics._layoutTotal++;return a},MO.FWglContext_createVertexBuffer=function(a){a=RClass.create(a?a:FWglVertexBuffer);a.linkGraphicContext(this);a.setup();this._storeBuffers.push(a);this._statistics._vertexBufferTotal++;return a},MO.FWglContext_createIndexBuffer=function(a){a=RClass.create(a?a:FWglIndexBuffer);a.linkGraphicContext(this);a.setup();this._storeBuffers.push(a);
this._statistics._indexBufferTotal++;return a},MO.FWglContext_createFlatTexture=function(){var a=RClass.create(FWglFlatTexture);a.linkGraphicContext(this);a.setup();this._storeTextures.push(a);this._statistics._flatTextureTotal++;return a},MO.FWglContext_createCubeTexture=function(){var a=RClass.create(FWglCubeTexture);a.linkGraphicContext(this);a.setup();this._storeTextures.push(a);this._statistics._cubeTextureTotal++;return a},MO.FWglContext_createRenderTarget=function(){var a=RClass.create(FWglRenderTarget);
a.linkGraphicContext(this);a.setup();this._storeTargets.push(a);this._statistics._targetTotal++;return a},MO.FWglContext_setViewport=function(a,b,d,f){this._size.set(d,f);this._native.viewport(a,b,d,f)},MO.FWglContext_setFillMode=function(a){var b=this._native;if(this._fillModeCd==a)return!1;this._statistics._frameFillModeCount++;switch(a){case EG3dFillMode.Point:b.polygonMode(b.FRONT_AND_BACK,b.POINT);break;case EG3dFillMode.Line:b.polygonMode(b.FRONT_AND_BACK,b.LINE);break;case EG3dFillMode.Face:b.polygonMode(b.FRONT,
b.FILL);break;default:throw new TError("Invalid parameter. (fill_mode={1})",a);}this._fillModeCd=a;return!0},MO.FWglContext_setDepthMode=function(a,b){var d=this._native;if(this._optionDepth==a&&this._depthModeCd==b)return!1;this._statistics._frameDepthModeCount++;this._optionDepth!=a&&(a?d.enable(d.DEPTH_TEST):d.disable(d.DEPTH_TEST),this._optionDepth=a);if(a&&this._depthModeCd!=b){var f=RWglUtility.convertDepthMode(d,b);d.depthFunc(f);this._depthModeCd=b}return!0},MO.FWglContext_setCullingMode=
function(a,b){var d=this._native;if(this._optionCull==a&&this._cullModeCd==b)return!1;this._statistics._frameCullModeCount++;this._optionCull!=a&&(a?d.enable(d.CULL_FACE):d.disable(d.CULL_FACE),this._optionCull=a);if(a&&this._cullModeCd!=b){var f=RWglUtility.convertCullMode(d,b);d.cullFace(f);this._cullModeCd=b}return!0},MO.FWglContext_setBlendFactors=function(a,b,d){var f=this._native;if(this._statusBlend==a&&this._blendSourceCd==b&&this._blendTargetCd==d)return!1;this._statistics._frameBlendModeCount++;
this._statusBlend!=a&&(a?f.enable(f.BLEND):(f.disable(f.BLEND),this._blendTargetCd=this._blendSourceCd=0),this._statusBlend=a);if(a&&(this._blendSourceCd!=b||this._blendTargetCd!=d)){a=RWglUtility.convertBlendFactors(f,b);var h=RWglUtility.convertBlendFactors(f,d);f.blendFunc(a,h);this._blendSourceCd=b;this._blendTargetCd=d}return!0},MO.FWglContext_setScissorRectangle=function(a,b,d,f){this._native.scissor(a,b,d,f)},MO.FWglContext_setRenderTarget=function(a){var b=this._native;if(this._activeRenderTarget!=
a){this._statistics._frameTargetCount++;var d=!0;if(null==a){b.bindFramebuffer(b.FRAMEBUFFER,null);d=this.checkError("glBindFramebuffer","Bind frame buffer. (frame_buffer={1})",null);if(!d)return d;b.viewport(0,0,this._size.width,this._size.height)}else{b.bindFramebuffer(b.FRAMEBUFFER,a._native);d=this.checkError("glBindFramebuffer","Bind frame buffer. (frame_buffer={1})",a._native);if(!d)return d;var f=a.size();b.viewport(0,0,f.width,f.height)}this._activeRenderTarget=a;return d}},MO.FWglContext_setProgram=
function(a){var b=this._native;if(this._program!=a)return this._statistics._frameProgramCount++,a?b.useProgram(a._native):b.useProgram(null),this._program=a,this.checkError("useProgram","Set program failure. (program={1}, program_native={2})",a,a._native)},MO.FWglContext_bindConst=function(a,b,d,f,h){var k=this._native,q=!0;this._statistics._frameConstCount++;switch(d){case EG3dParameterFormat.Float1:k.uniform1fv(b,f);this._statistics._frameConstLength+=f.byteLength;q=this.checkError("uniform1fv",
"Bind const data failure. (shader_cd={1}, slot={2}, data={3}, count={4})",a,b,f,h);break;case EG3dParameterFormat.Float2:k.uniform2fv(b,f);this._statistics._frameConstLength+=f.byteLength;q=this.checkError("uniform2fv","Bind const data failure. (shader_cd={1}, slot={2}, data={3}, count={4})",a,b,f,h);break;case EG3dParameterFormat.Float3:k.uniform3fv(b,f);this._statistics._frameConstLength+=f.byteLength;q=this.checkError("uniform3fv","Bind const data failure. (shader_cd={1}, slot={2}, data={3}, count={4})",
a,b,f,h);break;case EG3dParameterFormat.Float4:k.uniform4fv(b,f);this._statistics._frameConstLength+=f.byteLength;q=this.checkError("uniform4fv","Bind const data failure. (shader_cd={1}, slot={2}, data={3}, count={4})",a,b,f,h);break;case EG3dParameterFormat.Float3x3:d=this._data9;d[0]=f[0];d[1]=f[4];d[2]=f[8];d[3]=f[1];d[4]=f[5];d[5]=f[9];d[6]=f[2];d[7]=f[6];d[8]=f[10];k.uniformMatrix3fv(b,k.FALSE,d);this._statistics._frameConstLength+=d.byteLength;q=this.checkError("uniformMatrix3fv","Bind const matrix3x3 failure. (shader_cd={1}, slot={2}, data={3}, count={4})",
a,b,f,h);break;case EG3dParameterFormat.Float4x4:if(f.constructor==Float32Array)d=f;else if(f.writeData)d=this._data16,f.writeData(d,0);else throw new TError("Unknown data type.");k.uniformMatrix4fv(b,k.FALSE,d);this._statistics._frameConstLength+=d.byteLength;q=this.checkError("uniformMatrix4fv","Bind const matrix4x4 failure. (shader_cd={1}, slot={2}, data={3}, count={4})",a,b,f,h);break;default:throw new TError(this,"Unknown format type. (format_cd={1})",d);}return q},MO.FWglContext_bindVertexBuffer=
function(a,b,d,f){var h=this._native,k=!0;this._statistics._frameBufferCount++;this._statusRecord&&(k=new SG3dLayoutBuffer,k.slot=a,k.buffer=b,k.index=d,k.formatCd=f,this._recordBuffers.push(k));k=null;null!=b&&(k=b._native);h.bindBuffer(h.ARRAY_BUFFER,k);k=this.checkError("bindBuffer","Bind buffer. (buffer_id=%d)",k);if(!k)return k;if(b){if(h.enableVertexAttribArray(a),k=this.checkError("enableVertexAttribArray","Enable vertex attribute array. (slot=%d)",a),!k)return k}else return h.disableVertexAttribArray(a),
k=this.checkError("disableVertexAttribArray","Disable vertex attribute array. (slot=%d)",a);b=b._stride;switch(f){case EG3dAttributeFormat.Float1:h.vertexAttribPointer(a,1,h.FLOAT,!1,b,d);break;case EG3dAttributeFormat.Float2:h.vertexAttribPointer(a,2,h.FLOAT,!1,b,d);break;case EG3dAttributeFormat.Float3:h.vertexAttribPointer(a,3,h.FLOAT,!1,b,d);break;case EG3dAttributeFormat.Float4:h.vertexAttribPointer(a,4,h.FLOAT,!1,b,d);break;case EG3dAttributeFormat.Byte4:h.vertexAttribPointer(a,4,h.UNSIGNED_BYTE,
!1,b,d);break;case EG3dAttributeFormat.Byte4Normal:h.vertexAttribPointer(a,4,h.UNSIGNED_BYTE,!0,b,d);break;default:throw new TError(this,"Unknown vertex format. (format_cd=%d)",f);}return k=this.checkError("glVertexAttribPointer","Bind vertex attribute pointer. (slot=%d, format_cd=%d)",a,f)},MO.FWglContext_bindTexture=function(a,b,d){var f=this._native,h=!0;this._statistics._frameTextureCount++;if(this._statusRecord){var k=new SG3dLayoutSampler;k.slot=a;k.index=b;k.texture=d;this._recordSamplers.push(k)}if(this._activeTextureSlot!=
a){f.uniform1i(a,b);f.activeTexture(f.TEXTURE0+b);h=this.checkError("activeTexture","Active texture failure. (slot=%d, index=%d)",a,b);if(!h)return h;this._activeTextureSlot=a}if(null==d)return f.bindTexture(f.TEXTURE_2D,null),h=this.checkError("bindTexture","Bind texture clear failure. (slot=%d)",a);a=d._native;switch(d.textureCd()){case EG3dTexture.Flat2d:f.bindTexture(f.TEXTURE_2D,a);h=this.checkError("glBindTexture","Bind flag texture failure. (texture_id=%d)",a);if(!h)break;break;case EG3dTexture.Cube:f.bindTexture(f.TEXTURE_CUBE_MAP,
a);h=this.checkError("glBindTexture","Bind cube texture failure. (texture_id=%d)",a);if(!h)break;break;default:RLogger.fatal(this,null,"Unknown texture type.")}return h},MO.FWglContext_clear=function(a,b,d,f,h){var k=this._native;k.clearColor(a,b,d,f);k.clearDepth(h);k.clear(k.COLOR_BUFFER_BIT|k.DEPTH_BUFFER_BIT);this._statistics._frameClearCount++},MO.FWglContext_clearColor=function(a,b,d,f){var h=this._native;h.clearColor(a,b,d,f);h.clear(h.COLOR_BUFFER_BIT);this._statistics._frameClearCount++},
MO.FWglContext_clearDepth=function(a){var b=this._native;b.clearDepth(a);b.clear(b.DEPTH_BUFFER_BIT);this._statistics._frameClearCount++},MO.FWglContext_readPixels=function(a,b,d,f){var h=this._native,k=new Uint8Array(4*d*f);h.readPixels(a,b,d,f,h.RGBA,h.UNSIGNED_BYTE,k);return k},MO.FWglContext_drawTriangles=function(a,b,d){var f=this._native,h=!0;null==b&&(b=0);null==d&&(d=a.count());f.bindBuffer(f.ELEMENT_ARRAY_BUFFER,a._native);h=this.checkError("bindBuffer","Bind element array buffer failure. (index=0x%08X, offset=%d, count=%d, buffer_id)",
a,b,d,a._native);if(!h)return h;h=RWglUtility.convertIndexStride(f,a.strideCd());a.fillModeCd()==EG3dFillMode.Line?f.drawElements(f.LINES,d,h,2*b):f.drawElements(f.TRIANGLES,d,h,2*b);this._statistics._frameTriangleCount+=d;this._statistics._frameDrawCount++;h=this.checkError("drawElements","Draw triangles failure. (index=0x%08X, offset=%d, count=%d)",a,b,d);if(!h)return h;f.bindBuffer(f.ELEMENT_ARRAY_BUFFER,null);return h=this.checkError("bindBuffer","Bind element array buffer failure. (index=0x%08X, offset=%d, count=%d)",
a,b,d)},MO.FWglContext_present=function(){},MO.FWglContext_checkError=function(a,b,d){if(!this._capability.optionDebug||!RRuntime.isDebug())return!0;a=this._native;b=!1;for(var f=d=null;;){d=a.getError();if(d==a.NO_ERROR){b=!0;break}switch(d){case a.INVALID_OPERATION:f="Invalid operation.";break;case a.INVALID_ENUM:f="Invalid enum.";break;case a.INVALID_VALUE:f="Invalid value.";break;case a.INVALID_FRAMEBUFFER_OPERATION:f="Invalid paramebuffer opeartion.";break;case a.OUT_OF_MEMORY:f="Out of memory.";
break;default:f="Unknown"}}b||RLogger.fatal(this,null,"OpenGL check failure. (code={1}, description={2})",d,f);return b};
with(MO)MO.FWglCubeTexture=function(a){a=RClass.inherits(this,a,FG3dCubeTexture);a._native=null;a.setup=FWglCubeTexture_setup;a.isValid=FWglCubeTexture_isValid;a.makeMipmap=FWglCubeTexture_makeMipmap;a.upload=FWglCubeTexture_upload;a.update=FWglCubeTexture_update;a.dispose=FWglCubeTexture_dispose;return a},MO.FWglCubeTexture_setup=function(){var a=this._graphicContext._native;this.__base.FG3dCubeTexture.setup.call(this);this._native=a.createTexture()},MO.FWglCubeTexture_isValid=function(){return this._graphicContext._native.isTexture(this._native)},
MO.FWglCubeTexture_makeMipmap=function(){var a=this._graphicContext._native;a.bindTexture(a.TEXTURE_CUBE_MAP,this._native);a.generateMipmap(a.TEXTURE_CUBE_MAP)},MO.FWglCubeTexture_upload=function(a,b,d,f,h,k){var q=this._graphicContext,w=q._native;w.bindTexture(w.TEXTURE_CUBE_MAP,this._native);w.texImage2D(w.TEXTURE_CUBE_MAP_POSITIVE_X,0,w.RGB,w.RGB,w.UNSIGNED_BYTE,a.image());w.texImage2D(w.TEXTURE_CUBE_MAP_NEGATIVE_X,0,w.RGB,w.RGB,w.UNSIGNED_BYTE,b.image());w.texImage2D(w.TEXTURE_CUBE_MAP_POSITIVE_Y,
0,w.RGB,w.RGB,w.UNSIGNED_BYTE,d.image());w.texImage2D(w.TEXTURE_CUBE_MAP_NEGATIVE_Y,0,w.RGB,w.RGB,w.UNSIGNED_BYTE,f.image());w.texImage2D(w.TEXTURE_CUBE_MAP_POSITIVE_Z,0,w.RGB,w.RGB,w.UNSIGNED_BYTE,h.image());w.texImage2D(w.TEXTURE_CUBE_MAP_NEGATIVE_Z,0,w.RGB,w.RGB,w.UNSIGNED_BYTE,k.image());this._statusLoad=q.checkError("texImage2D","Upload cube image failure.");this.update()},MO.FWglCubeTexture_update=function(){this.__base.FG3dCubeTexture.update.call(this);var a=this._graphicContext._native;a.bindTexture(a.TEXTURE_CUBE_MAP,
this._native);var b=RWglUtility.convertSamplerFilter(a,this._filterMinCd);b&&a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_MIN_FILTER,b);(b=RWglUtility.convertSamplerFilter(a,this._filterMagCd))&&a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_MAG_FILTER,b)},MO.FWglCubeTexture_dispose=function(){var a=this._graphicContext,b=this._native;b&&(a._native.deleteTexture(b),this._native=null);this.__base.FG3dCubeTexture.dispose.call(this)};
with(MO)MO.FWglFlatTexture=function(a){a=RClass.inherits(this,a,FG3dFlatTexture);a._native=null;a.setup=FWglFlatTexture_setup;a.isValid=FWglFlatTexture_isValid;a.texture=FWglFlatTexture_texture;a.makeMipmap=FWglFlatTexture_makeMipmap;a.uploadData=FWglFlatTexture_uploadData;a.upload=FWglFlatTexture_upload;a.update=FWglFlatTexture_update;a.dispose=FWglFlatTexture_dispose;return a},MO.FWglFlatTexture_setup=function(){var a=this._graphicContext._native;this.__base.FG3dFlatTexture.setup.call(this);this._native=
a.createTexture()},MO.FWglFlatTexture_isValid=function(){return this._graphicContext._native.isTexture(this._native)},MO.FWglFlatTexture_texture=function(){return this},MO.FWglFlatTexture_makeMipmap=function(){var a=this._graphicContext._native;a.bindTexture(a.TEXTURE_2D,this._native);a.generateMipmap(a.TEXTURE_2D)},MO.FWglFlatTexture_uploadData=function(a,b,d){var f=this._graphicContext,h=f._native,k=null;if(a.constructor==ArrayBuffer)k=new Uint8Array(a);else if(a.constructor==Uint8Array)k=a;else throw new TError("Invalid data format.");
this.width=b;this.height=d;h.bindTexture(h.TEXTURE_2D,this._native);h.texImage2D(h.TEXTURE_2D,0,h.RGBA,b,d,0,h.RGBA,h.UNSIGNED_BYTE,k);this._statusLoad=f.checkError("texImage2D","Upload data failure.");this.update()},MO.FWglFlatTexture_upload=function(a){var b=this._graphicContext;b.capability();var d=b._native,f=null;if("IMG"==a.tagName||"CANVAS"==a.tagName)f=a;else if(RClass.isClass(a,FImage))f=a.image();else if(RClass.isClass(a,MCanvasObject))f=a.htmlCanvas();else throw new TError("Invalid image format.");
d.bindTexture(d.TEXTURE_2D,this._native);this._optionFlipY&&d.pixelStorei(d.UNPACK_FLIP_Y_WEBGL,!0);d.texImage2D(d.TEXTURE_2D,0,d.RGBA,d.RGBA,d.UNSIGNED_BYTE,f);this.update();this._statusLoad=b.checkError("texImage2D","Upload image failure.")},MO.FWglFlatTexture_update=function(){this.__base.FG3dFlatTexture.update.call(this);var a=this._graphicContext._native;a.bindTexture(a.TEXTURE_2D,this._native);var b=RWglUtility.convertSamplerFilter(a,this._filterMinCd);b&&a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,
b);(b=RWglUtility.convertSamplerFilter(a,this._filterMagCd))&&a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,b)},MO.FWglFlatTexture_dispose=function(){var a=this._graphicContext,b=this._native;b&&(a._native.deleteTexture(b),this._native=null);this.__base.FG3dFlatTexture.dispose.call(this)};
with(MO)MO.FWglFragmentShader=function(a){a=RClass.inherits(this,a,FG3dFragmentShader);a._native=null;a.setup=FWglFragmentShader_setup;a.targetSource=FWglFragmentShader_targetSource;a.upload=FWglFragmentShader_upload;a.dispose=FWglFragmentShader_dispose;return a},MO.FWglFragmentShader_setup=function(){this.__base.FG3dFragmentShader.setup.call(this);var a=this._graphicContext._native;this._native=a.createShader(a.FRAGMENT_SHADER)},MO.FWglFragmentShader_targetSource=function(){var a=null,a=this._graphicContext;
return a=a.capability().optionShaderSource?a._nativeDebugShader.getTranslatedShaderSource(this._native):this._source},MO.FWglFragmentShader_upload=function(a){var b=this._graphicContext._native,d=this._native;b.shaderSource(d,a);b.compileShader(d);if(!b.getShaderParameter(d,b.COMPILE_STATUS)){var f=b.getShaderInfoLog(d);b.deleteShader(d);this._native=null;throw new TError(this,"Upload fragment shader source failure. (error={1})\n{2}",f,a);}this._source=a;return!0},MO.FWglFragmentShader_dispose=function(){var a=
this._graphicContext,b=this._native;b&&(a._native.deleteShader(b),this._native=null);this.__base.FG3dFragmentShader.dispose.call(this)};
with(MO)MO.FWglIndexBuffer=function(a){a=RClass.inherits(this,a,FG3dIndexBuffer);a._native=null;a.setup=FWglIndexBuffer_setup;a.isValid=FWglIndexBuffer_isValid;a.upload=FWglIndexBuffer_upload;a.dispose=FWglIndexBuffer_dispose;return a},MO.FWglIndexBuffer_setup=function(){this.__base.FG3dIndexBuffer.setup.call(this);this._native=this._graphicContext._native.createBuffer()},MO.FWglIndexBuffer_isValid=function(){return this._graphicContext._native.isBuffer(this._native)},MO.FWglIndexBuffer_upload=function(a,
b){var d=this._graphicContext,f=d._native;this._count=b;var h=null;if(a.constructor==Array||a.constructor==ArrayBuffer)if(this._strideCd==EG3dIndexStride.Uint16)h=new Uint16Array(a);else if(this._strideCd==EG3dIndexStride.Uint32)h=new Uint32Array(a);else throw new TError(this,"Index stride is invalid.");else if(a.constructor==Uint16Array){if(this._strideCd!=EG3dIndexStride.Uint16)throw new TError(this,"Index stride16 is invalid.");h=a}else if(a.constructor==Uint32Array){if(this._strideCd!=EG3dIndexStride.Uint32)throw new TError(this,
"Index stride16 is invalid.");h=a}else throw new TError(this,"Upload index data type is invalid. (value={1})",a);f.bindBuffer(f.ELEMENT_ARRAY_BUFFER,this._native);d.checkError("bindBuffer","Bind buffer failure.");f.bufferData(f.ELEMENT_ARRAY_BUFFER,h,f.STATIC_DRAW);d.checkError("bufferData","Upload buffer data. (count={1})",b)},MO.FWglIndexBuffer_dispose=function(){var a=this._graphicContext,b=this._native;b&&(a._native.deleteBuffer(b),this._native=null);this.__base.FG3dIndexBuffer.dispose.call(this)};
with(MO)MO.FWglLayout=function(a){a=RClass.inherits(this,a,FG3dLayout);a._native=null;a.setup=FWglLayout_setup;a.bind=FWglLayout_bind;a.unbind=FWglLayout_unbind;a.active=FWglLayout_active;a.deactive=FWglLayout_deactive;a.dispose=FWglLayout_dispose;return a},MO.FWglLayout_setup=function(){this.__base.FG3dLayout.setup.call(this);this._native=this._graphicContext._nativeLayout.createVertexArrayOES()},MO.FWglLayout_bind=function(){this._graphicContext._nativeLayout.bindVertexArrayOES(this._native)},MO.FWglLayout_unbind=
function(){this._graphicContext._nativeLayout.bindVertexArrayOES(null)},MO.FWglLayout_active=function(){this._graphicContext._nativeLayout.bindVertexArrayOES(this._native)},MO.FWglLayout_deactive=function(){this._graphicContext._nativeLayout.bindVertexArrayOES(null)},MO.FWglLayout_dispose=function(){var a=this._graphicContext,b=this._native;b&&(a._nativeLayout.deleteVertexArrayOES(b),this._native=null);this.__base.FG3dLayout.dispose.call(this)};
with(MO)MO.FWglProgram=function(a){a=RClass.inherits(this,a,FG3dProgram);a._native=null;a.setup=FWglProgram_setup;a.vertexShader=FWglProgram_vertexShader;a.fragmentShader=FWglProgram_fragmentShader;a.upload=FWglProgram_upload;a.build=FWglProgram_build;a.link=FWglProgram_link;a.dispose=FWglProgram_dispose;return a},MO.FWglProgram_setup=function(){this._native=(g=this._graphicContext)._native.createProgram()},MO.FWglProgram_vertexShader=function(){var a=this._vertexShader;a||(a=this._vertexShader=RClass.create(FWglVertexShader),
a.linkGraphicContext(this),a.setup());return a},MO.FWglProgram_fragmentShader=function(){var a=this._fragmentShader;a||(a=this._fragmentShader=RClass.create(FWglFragmentShader),a.linkGraphicContext(this),a.setup());return a},MO.FWglProgram_upload=function(a,b){if(a==EG3dShader.Vertex)this.vertexShader().upload(b);else if(a==EG3dShader.Fragment)this.fragmentShader().upload(b);else throw Error("Unknown type");},MO.FWglProgram_build=function(){var a=this._graphicContext,b=a._native,d=this._native,f=
this.vertexShader();b.attachShader(d,f._native);var h=a.checkError("attachShader","Attach shader failure. (program_id=%d, shader_id=%d)",d,f._native);if(!h)return h;f=this.fragmentShader();b.attachShader(d,f._native);h=a.checkError("attachShader","Attach shader failure. (program_id=%d, shader_id=%d)",d,f._native);if(!h)return h;if(this.hasAttribute())for(var f=this.attributes(),k=f.count(),q=0;q<k;q++)if(h=f.value(q).name(),b.bindAttribLocation(d,q,h),h=a.checkError("bindAttribLocation","Bind attribute location. (program_id=%d, slot=%d, name=%s)",
d,q,h),!h)return h},MO.FWglProgram_link=function(){var a=this._graphicContext,b=a._native,d=!1,f=this._native;b.linkProgram(f);d=b.getProgramParameter(f,b.LINK_STATUS);if(!d)return a=b.getProgramInfoLog(f),RLogger.fatal(this,null,"Link program failure. (status={1}, reason={2})",d,a),b.deleteProgram(this._native),this._native=null,!1;b.validateProgram(f);(d=b.getProgramParameter(f,b.VALIDATE_STATUS))||b.getProgramInfoLog(f);b.finish();d=a.checkError("finish","Finish program link faliure. (program_id={1})",
f);if(!d)return d;if(this.hasParameter())for(var h=this._parameters.count(),k=0;k<h;k++){var q=this._parameters.value(k),w=b.getUniformLocation(f,q.name()),d=a.checkError("getUniformLocation","Find parameter slot. (program_id=%d, name=%s, slot=%d)",f,q.name(),w);if(!d)return d;q._slot=w;null!=w&&(q._statusUsed=!0)}if(this.hasAttribute())for(h=this._attributes.count(),k=0;k<h;k++){q=this._attributes.value(k);w=b.getAttribLocation(f,q.name());d=a.checkError("getAttribLocation","Find attribute slot. (program_id=%d, name=%s, slot=%d)",
f,q.name(),w);if(!d)return d;q._slot=w;-1!=w&&(q._statusUsed=!0)}if(this.hasSampler()){h=this._samplers.count();for(k=0;k<h;k++){q=this._samplers.value(k);w=b.getUniformLocation(f,q.name());d=a.checkError("getUniformLocation","Find sampler slot. (program_id=%d, name=%s, slot=%d)",f,q.name(),w);if(!d)return d;q._slot=w;null!=w&&(q._statusUsed=!0)}for(k=b=0;k<h;k++)q=this._samplers.value(k),q._statusUsed&&(q._index=b++)}return d},MO.FWglProgram_dispose=function(){var a=this._graphicContext,b=this._native;
b&&(a._native.deleteProgram(b),this._native=null);this.__base.FG3dProgram.dispose.call(this)};
with(MO)MO.FWglRenderTarget=function(a){a=RClass.inherits(this,a,FG3dRenderTarget);a._optionDepth=!0;a._native=null;a._nativeDepth=null;a.setup=FWglRenderTarget_setup;a.build=FWglRenderTarget_build;a.dispose=FWglRenderTarget_dispose;return a},MO.FWglRenderTarget_setup=function(){this.__base.FG3dRenderTarget.setup.call(this);var a=this._graphicContext;this._native=a._native.createFramebuffer();return a.checkError("createFramebuffer","Create frame buffer failure.")},MO.FWglRenderTarget_build=function(){var a=
this._size,b=this._graphicContext,d=b._native;d.bindFramebuffer(d.FRAMEBUFFER,this._native);var f=b.checkError("bindFramebuffer","Bind frame buffer failure.");if(!f)return f;if(this._optionDepth){var h=this._nativeDepth=d.createRenderbuffer(),f=b.checkError("createRenderbuffer","Create render buffer failure.");if(!f)return f;d.bindRenderbuffer(d.RENDERBUFFER,h);f=b.checkError("bindRenderbuffer","Bind render buffer failure.");if(!f)return f;d.renderbufferStorage(d.RENDERBUFFER,d.DEPTH_COMPONENT16,
a.width,a.height);f=b.checkError("renderbufferStorage","Set render buffer storage format failure.");if(!f)return f;d.framebufferRenderbuffer(d.FRAMEBUFFER,d.DEPTH_ATTACHMENT,d.RENDERBUFFER,h);f=b.checkError("framebufferRenderbuffer","Set depth buffer to frame buffer failure. (framebuffer=%d, depthbuffer=%d)",this._native,h);if(!f)return f}for(var h=this._textures,k=h.count(),q=0;q<k;q++){var w=h.get(q);d.bindTexture(d.TEXTURE_2D,w._native);d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,d.LINEAR);
d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,d.LINEAR);d.texImage2D(d.TEXTURE_2D,0,d.RGBA,a.width,a.height,0,d.RGBA,d.UNSIGNED_BYTE,null);f=b.checkError("texImage2D","Alloc texture storage. (texture_id, size=%dx%d)",w._native,this._size.width,this._size.height);if(!f)return f;d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0+q,d.TEXTURE_2D,w._native,0);f=b.checkError("framebufferTexture2D","Set color buffer into frame buffer failure. (framebuffer_id=%d, texture_id=%d)",this._native,w._native);
if(!f)return f}},MO.FWglRenderTarget_dispose=function(){var a=this._graphicContext,b=this._nativeDepth;b&&(a._native.deleteRenderbuffer(b),this._nativeDepth=null);if(b=this._native)a._native.deleteFramebuffer(b),this._native=null;this.__base.FG3dRenderTarget.dispose.call(this)};
with(MO)MO.FWglVertexBuffer=function(a){a=RClass.inherits(this,a,FG3dVertexBuffer);a._native=null;a.setup=FWglVertexBuffer_setup;a.isValid=FWglVertexBuffer_isValid;a.upload=FWglVertexBuffer_upload;a.dispose=FWglVertexBuffer_dispose;return a},MO.FWglVertexBuffer_setup=function(){this.__base.FG3dVertexBuffer.setup.call(this);this._native=this._graphicContext._native.createBuffer()},MO.FWglVertexBuffer_isValid=function(){return this._graphicContext._native.isBuffer(this._native)},MO.FWglVertexBuffer_upload=
function(a,b,d){var f=this._graphicContext,h=f._native;this._stride=b;this._count=d;b=null;if(a.constructor==Array||a.constructor==ArrayBuffer)switch(this._formatCd){case EG3dAttributeFormat.Float1:case EG3dAttributeFormat.Float2:case EG3dAttributeFormat.Float3:case EG3dAttributeFormat.Float4:b=new Float32Array(a);break;case EG3dAttributeFormat.Byte4:case EG3dAttributeFormat.Byte4Normal:b=new Uint8Array(a);break;default:throw new TError(this,"Unknown data type.");}else if(a.constructor==Uint8Array)b=
a;else if(a.constructor==Float32Array)b=a;else throw new TError(this,"Upload vertex data type is invalid. (data={1})",a);h.bindBuffer(h.ARRAY_BUFFER,this._native);f.checkError("bindBuffer","Bindbuffer");h.bufferData(h.ARRAY_BUFFER,b,h.STATIC_DRAW);f.checkError("bufferData","bufferData")},MO.FWglVertexBuffer_dispose=function(){var a=this._graphicContext,b=this._native;b&&(a._native.deleteBuffer(b),this._native=null);this.__base.FG3dVertexBuffer.dispose.call(this)};
with(MO)MO.FWglVertexShader=function(a){a=RClass.inherits(this,a,FG3dVertexShader);a._native=null;a.setup=FWglVertexShader_setup;a.targetSource=FWglVertexShader_targetSource;a.upload=FWglVertexShader_upload;a.dispose=FWglVertexShader_dispose;return a},MO.FWglVertexShader_setup=function(){this.__base.FG3dVertexShader.setup.call(this);var a=this._graphicContext._native;this._native=a.createShader(a.VERTEX_SHADER)},MO.FWglVertexShader_targetSource=function(){var a=null,a=this._graphicContext;return a=
a.capability().optionShaderSource?a._nativeDebugShader.getTranslatedShaderSource(this._native):this._source},MO.FWglVertexShader_upload=function(a){var b=this._graphicContext._native,d=this._native;b.shaderSource(d,a);b.compileShader(d);if(!b.getShaderParameter(d,b.COMPILE_STATUS)){var f=b.getShaderInfoLog(d);b.deleteShader(d);this._native=null;throw new TError(this,"Upload vertex shader source failure. (error={1})\n{2}",f,a);}this._source=a;return!0},MO.FWglVertexShader_dispose=function(){var a=
this._graphicContext,b=this._native;b&&(a._native.deleteShader(b),this._native=null);this.__base.FG3dVertexShader.dispose.call(this)};
with(MO)MO.RWglUtility=function(){this.convertFillMode=RWglUtility_convertFillMode;this.convertCullMode=RWglUtility_convertCullMode;this.convertDepthMode=RWglUtility_convertDepthMode;this.convertBlendFactors=RWglUtility_convertBlendFactors;this.convertIndexStride=RWglUtility_convertIndexStride;this.convertSamplerFilter=RWglUtility_convertSamplerFilter;return this},MO.RWglUtility_convertFillMode=function(a,b){switch(b){case EG3dFillMode.Point:return a.POINT;case EG3dFillMode.Line:return a.LINE;case EG3dFillMode.Face:return a.FILL}throw new TError(this,
"Convert fill mode failure. (fill_cd={1})",b);},MO.RWglUtility_convertCullMode=function(a,b){switch(b){case EG3dCullMode.Front:return a.FRONT;case EG3dCullMode.Back:return a.BACK;case EG3dCullMode.Both:return a.FRONT_AND_BACK}throw new TError(this,"Convert cull mode failure. (cull_cd={1})",b);},MO.RWglUtility_convertDepthMode=function(a,b){switch(b){case EG3dDepthMode.Equal:return a.EQUAL;case EG3dDepthMode.NotEqual:return a.NOTEQUAL;case EG3dDepthMode.Less:return a.LESS;case EG3dDepthMode.LessEqual:return a.LEQUAL;
case EG3dDepthMode.Greater:return a.GREATER;case EG3dDepthMode.GreaterEqual:return a.GEQUAL;case EG3dDepthMode.Always:return a.ALWAYS}throw new TError(this,"Convert depth mode failure. (depth_cd={1})",b);},MO.RWglUtility_convertBlendFactors=function(a,b){switch(b){case EG3dBlendMode.Zero:return a.ZERO;case EG3dBlendMode.One:return a.ONE;case EG3dBlendMode.SrcColor:return a.SRC_COLOR;case EG3dBlendMode.OneMinusSrcColor:return a.ONE_MINUS_SRC_COLOR;case EG3dBlendMode.DstColor:return a.DST_COLOR;case EG3dBlendMode.OneMinusDstColor:return a.ONE_MINUS_DST_COLOR;
case EG3dBlendMode.SrcAlpha:return a.SRC_ALPHA;case EG3dBlendMode.OneMinusSrcAlpha:return a.ONE_MINUS_SRC_ALPHA;case EG3dBlendMode.DstAlpha:return a.DST_ALPHA;case EG3dBlendMode.OneMinusDstAlpha:return a.ONE_MINUS_DST_ALPHA;case EG3dBlendMode.SrcAlphaSaturate:return a.SRC_ALPHA_SATURATE}throw new TError(this,"Convert blend factors failure. (blend_cd={1})",b);},MO.RWglUtility_convertIndexStride=function(a,b){switch(b){case EG3dIndexStride.Uint16:return a.UNSIGNED_SHORT;case EG3dIndexStride.Uint32:return a.UNSIGNED_INT}throw new TError(this,
"Convert index stride failure. (stride_cd={1})",b);},MO.RWglUtility_convertSamplerFilter=function(a,b){switch(b){case EG3dSamplerFilter.Unknown:return 0;case EG3dSamplerFilter.Nearest:return a.NEAREST;case EG3dSamplerFilter.Linear:return a.LINEAR;case EG3dSamplerFilter.Repeat:return a.REPEAT;case EG3dSamplerFilter.ClampToEdge:return a.CLAMP_TO_EDGE;case EG3dSamplerFilter.ClampToBorder:return a.CLAMP_TO_BORDER}throw new TError(this,"Convert sampler filter failure. (filter_cd={1})",b);},MO.RWglUtility=
new RWglUtility;MO.EBrowser=new function(){this.Unknown=0;this.Explorer=1;this.FireFox=2;this.Chrome=3;this.Safari=4;return this};MO.EDevice=new function(){this.Unknown=0;this.Pc=1;this.Mobile=2;return this};MO.ESoftware=new function(){this.Unknown=0;this.Window=1;this.Linux=2;this.Android=3;this.Apple=4;return this};MO.SBrowserCapability=function(){this.blobCreate=this.optionStorage=this.optionProcess=!1;return this};
with(MO)MO.STouchEvent=function(){this.dispose=STouchEvent_dispose;return this},MO.STouchEvent_dispose=function(){};
with(MO)MO.TDumpItem=function(){this.link=this.hRow=this.hText=this.hTable=this.hDocument=this.hPanel=this.hParent=null;this.level=0;this.caption=null;this.children=[];this.items=[];this.display=this.innerDisplay=this.loaded=!1;this.create=TDumpItem_create;this.push=TDumpItem_push;this.innerShow=TDumpItem_innerShow;this.show=TDumpItem_show;return this},MO.TDumpItem_create=function(){return this.children[this.children.length]=new TDumpItem},MO.TDumpItem_push=function(a){this.items[this.items.length]=
a},MO.TDumpItem_innerShow=function(a){for(var b=this.items.length,d=0;d<b;d++)RHtml.visibleSet(this.items[d],a);b=this.children.length;for(d=0;d<b;d++){var f=this.children[d];RHtml.visibleSet(f.hRow,a);a?f.show(f.innerDisplay):(f.innerDisplay=f.display,f.show(!1))}},MO.TDumpItem_show=function(a){this.display=a;var b=RString.repeat("   ",this.level-1)+(a?" -":" +")+" "+this.caption;this.hText.innerHTML=RHtml.toHtml(b);this.innerShow(a)};
with(MO)MO.RBrowser=function(){this._capability=null;this._deviceCd=MO.EDevice.Unknown;this._softwareCd=MO.ESoftware.Unknown;this._typeCd=MO.EBrowser.Unknown;this._supportHtml5=!1;this._contentPath=this._hostPath="";this.onLog=RBrowser_onLog;this.construct=RBrowser_construct;this.capability=RBrowser_capability;this.supportHtml5=RBrowser_supportHtml5;this.hostPath=RBrowser_hostPath;this.setHostPath=RBrowser_setHostPath;this.contentPath=RBrowser_contentPath;this.setContentPath=RBrowser_setContentPath;
this.isBrowser=RBrowser_isBrowser;this.encode=RBrowser_encode;this.decode=RBrowser_decode;this.urlEncode=RBrowser_urlEncode;this.urlDecode=RBrowser_urlDecode;return this},MO.RBrowser_onLog=function(a,b){console.log(b)},MO.RBrowser_construct=function(){var a=window.navigator.userAgent.toLowerCase();-1!=a.indexOf("android")&&(this._typeCd=EDevice.Mobile,this._softwareCd=ESoftware.Android);if(-1!=a.indexOf("chrome"))this._typeCd=EBrowser.Chrome;else if(-1!=a.indexOf("firefox"))this._typeCd=EBrowser.FireFox;
else if(-1!=a.indexOf("msie")||-1!=a.indexOf("windows"))this._typeCd=EBrowser.Explorer;else if(-1!=a.indexOf("safari")||-1!=a.indexOf("applewebkit"))this._typeCd=EBrowser.Safari;else{alert("Unknown browser.\n"+a);return}this._typeCd==EBrowser.Chrome&&RLogger.lsnsOutput.register(this,this.onLog);RLogger.info(this,"Parse browser agent. (type_cd={1})",REnum.decode(EBrowser,this._typeCd));window.applicationCache&&(this._supportHtml5=!0);a=this._capability=new SBrowserCapability;window.Worker&&(a.optionProcess=
!0);window.localStorage&&(a.optionStorage=!0);try{new Blob(["Test"],{type:"text/plain"}),a.blobCreate=!0}catch(b){RLogger.warn(this,"Browser blob not support.")}},MO.RBrowser_capability=function(){return this._capability},MO.RBrowser_supportHtml5=function(){return this._supportHtml5},MO.RBrowser_hostPath=function(a){return a?this._hostPath+a:this._hostPath},MO.RBrowser_setHostPath=function(a){this._hostPath=a},MO.RBrowser_contentPath=function(a){return a?this._contentPath+a:this._contentPath},MO.RBrowser_setContentPath=
function(a){this._contentPath=a},MO.RBrowser_isBrowser=function(a){return this._typeCd==a},MO.RBrowser_encode=function(a){return escape(a)},MO.RBrowser_decode=function(a){return unescape(a)},MO.RBrowser_urlEncode=function(a,b){return b?encodeURIComponent(a):encodeURI(a)},MO.RBrowser_urlDecode=function(a,b){return b?decodeURIComponent(a):decodeURI(a)},MO.RBrowser=new RBrowser;
with(MO)MO.RBuilder=function(){this.create=RBuilder_create;this.createIcon=RBuilder_createIcon;this.createImage=RBuilder_createImage;this.createText=RBuilder_createText;this.createButton=RBuilder_createButton;this.createCheck=RBuilder_createCheck;this.createRadio=RBuilder_createRadio;this.createEdit=RBuilder_createEdit;this.createFile=RBuilder_createFile;this.createSpan=RBuilder_createSpan;this.createDiv=RBuilder_createDiv;this.createTable=RBuilder_createTable;this.createTableRow=RBuilder_createTableRow;
this.createTableCell=RBuilder_createTableCell;this.createFragment=RBuilder_createFragment;this.append=RBuilder_append;this.appendIcon=RBuilder_appendIcon;this.appendImage=RBuilder_appendImage;this.appendEmpty=RBuilder_appendEmpty;this.appendText=RBuilder_appendText;this.appendButton=RBuilder_appendButton;this.appendCheck=RBuilder_appendCheck;this.appendRadio=RBuilder_appendRadio;this.appendEdit=RBuilder_appendEdit;this.appendFile=RBuilder_appendFile;this.appendSpan=RBuilder_appendSpan;this.appendDiv=
RBuilder_appendDiv;this.appendTable=RBuilder_appendTable;this.appendTableRow=RBuilder_appendTableRow;this.appendTableRowCell=RBuilder_appendTableRowCell;this.appendTableCell=RBuilder_appendTableCell;return this},MO.RBuilder_create=function(a,b,d){var f=null,f=a.ownerDocument?a.ownerDocument:a.hDocument?a.hDocument:a;a=f.createElement(b);d&&(a.className=d);return a},MO.RBuilder_createIcon=function(a,b,d,f,h){a=this.create(a,"IMG",RString.nvl(b,"Tag_Icon"));a.align="absmiddle";d&&(a.src=RResource.iconPath(d));
f&&(a.style.width=f+"px");h&&(a.style.height=h+"px");return a},MO.RBuilder_createImage=function(a,b,d,f,h){a=this.create(a,"IMG",d);d&&(a.src=RResource.imagePath(d));f&&(a.style.width=f);h&&(a.style.height=h);return a},MO.RBuilder_createText=function(a,b,d){a=this.create(a,"SPAN",b);d&&(a.innerHTML=d);return a},MO.RBuilder_createButton=function(a,b){var d=this.create(a,"INPUT",b);d.type="button";return d},MO.RBuilder_createCheck=function(a,b){var d=this.create(a,"INPUT",b);d.type="checkbox";return d},
MO.RBuilder_createRadio=function(a,b){var d=this.create(a,"INPUT",b);d.type="radio";return d},MO.RBuilder_createEdit=function(a,b){var d=this.create(a,"INPUT",b);d.type="text";return d},MO.RBuilder_createFile=function(a,b){var d=this.create(a,"INPUT",b);d.type="file";return d},MO.RBuilder_createSpan=function(a,b){return this.create(a,"SPAN",b)},MO.RBuilder_createDiv=function(a,b){return this.create(a,"DIV",b)},MO.RBuilder_createTable=function(a,b,d,f,h){a=this.create(a,"TABLE",b);d&&(a.border=RInteger.nvl(d));
a.cellSpacing=RInteger.nvl(f);a.cellPadding=RInteger.nvl(h);return a},MO.RBuilder_createTableRow=function(a,b){return this.create(a,"TR",b)},MO.RBuilder_createTableCell=function(a,b){return this.create(a,"TD",b)},MO.RBuilder_createFragment=function(a){var b=null,b=a.ownerDocument?a.ownerDocument:a.hDocument?a.hDocument:a;a=b.createDocumentFragment();a.__fragment=!0;return a},MO.RBuilder_append=function(a,b,d){b=RBuilder.create(a.ownerDocument,b,d);a?a.appendChild(b):this.hDocument.body.appendChild(b);
return b},MO.RBuilder_appendIcon=function(a,b,d,f,h){b=this.createIcon(a.ownerDocument,b,d,f,h);a.appendChild(b);return b},MO.RBuilder_appendImage=function(a,b,d,f,h){b=this.createImage(a.ownerDocument,b,d,f,h);a.appendChild(b);return b},MO.RBuilder_appendEmpty=function(a,b,d){b=this.createIcon(a.ownerDocument,null,"n",b,d);a.appendChild(b);return b},MO.RBuilder_appendText=function(a,b,d){b=this.createText(a.ownerDocument,b,d);a.appendChild(b);return b},MO.RBuilder_appendButton=function(a,b){var d=
this.createButton(a.ownerDocument,b);a.appendChild(d);return d},MO.RBuilder_appendCheck=function(a,b){var d=this.createCheck(a.ownerDocument,b);a.appendChild(d);return d},MO.RBuilder_appendRadio=function(a,b){var d=this.createRadio(a.ownerDocument,b);a.appendChild(d);return d},MO.RBuilder_appendEdit=function(a,b){var d=this.createEdit(a.ownerDocument,b);a.appendChild(d);return d},MO.RBuilder_appendFile=function(a,b){var d=this.createFile(a.ownerDocument,b);a.appendChild(d);return d},MO.RBuilder_appendSpan=
function(a,b){var d=this.createSpan(a.ownerDocument,b);a.appendChild(d);return d},MO.RBuilder_appendDiv=function(a,b){var d=this.createDiv(a.ownerDocument,b);a.appendChild(d);return d},MO.RBuilder_appendTable=function(a,b,d,f,h){b=this.createTable(a.ownerDocument,b,d,f,h);a?a.appendChild(b):this.hDocument.body.appendChild(b);return b},MO.RBuilder_appendTableRow=function(a,b,d,f){var h=null,h=null==d?RBrowser.isBrowser(EBrowser.Explorer)?a.insertRow():a.insertRow(-1):a.insertRow(d);b&&(h.className=
b);f&&(h.height=f);return h},MO.RBuilder_appendTableRowCell=function(a,b,d,f){a=this.appendTableRow(a,null,null,d);return this.appendTableCell(a,b,null,f)},MO.RBuilder_appendTableCell=function(a,b,d,f){var h=null;null==d?(h=this.create(a,"TD",b),a.appendChild(h)):h=a.insertCell(d);b&&(h.className=b);f&&(h.width=f);return h},MO.RBuilder=new RBuilder;
with(MO)MO.RDump=function(){this.LINE_SINGLE="------------------------------";this.LINE_DOUBLE="==============================";this.LINE_DOT="..............................";this.LINE_STAR="******************************";this.onclick=RDump_onclick;this.nameInfo=RDump_nameInfo;this.typeInfo=RDump_typeInfo;this.dumpInner=RDump_dumpInner;this.dump=RDump_dump;this.appendLevel=RDump_appendLevel;this.stack=RDump_stack;return this},MO.RDump_onclick=function(){var a=this.link;this.link&&(a.loaded?a.show(!a.display):
(RDump.dumpInner(this.link),a.loaded=!0,a.show(!0)))},MO.RDump_nameInfo=function(a){switch(RClass.typeOf(a)){case "Unknown":return"@unknown";case "Function":return RMethod.name(a)+"@Function";case "Array":return"@<Array>"}return a},MO.RDump_typeInfo=function(a,b){if(null==a)return"null";switch(b){case "Unknown":return"unknown";case "Undefined":return"undefined";case "Boolean":case "Number":return a.toString();case "String":return a.length+":'"+RString.toLine(a)+"'";case "Function":return a.__virtual?
"virtual":RMethod.name(a,!0);case "Array":return"@<Array@"+RClass.code(a)+"> length="+a.length;case "Html":return"@<"+a.tagName+">";default:if(a.constructor==TClass)return"@<"+a.name+"@"+RClass.code(a)+">";if(a.constructor==Function)return"@"+a.toString();try{for(var d in a)return"@<Object@"+RClass.code(a)+">"}catch(f){}return"<Object@"+RClass.code(a)+">"}},MO.RDump_dumpInner=function(a){var b=a.hTable,d=a.hRow,f=a.level,h=a.link,k=RClass.typeOf(h,!0),q=h.__class,w=[],x;for(x in h)w[w.length]=x;RString.endsWith(k,
"Array")?RArray.reverse(w,0,w.length-1):RArray.sort(w,!0);var y=w.length;2E3<y&&(y=2E3);for(var z=0;z<y;z++){x=w[z];var A="{error}";try{A=h[x]}catch(D){}RClass.safeTypeOf(A,!0);var k=RClass.safeTypeOf(A,!0),B=null,E=!0;if(q){var F=q.attributeFind(x);F&&(k="Annotation<"+RMethod.name(F.constructor)+">",B=A&&A.constructor==Function?"<FONT color='green'>"+RMethod.name(A)+"</FONT>":A+"<FONT color='green'> - ("+RHtml.toHtml(F.toString())+")</FONT>",E=!1)}null==B&&(B=this.typeInfo(A,k));var F=null,C=RBuilder.appendTableRow(b,
null,d?d.rowIndex+1:0);C.bgColor="#FFFFFF";RString.startsWith(B,"@")?(C.style.cursor="pointer",C.onclick=this.onclick,C.bgColor="#FFF0E0",F=C.link=a.create(),F.link=A,F.level=f,F.caption=x,F.hTable=b,F.level=f+1,F.hRow=C):a.push(C);"Function"==k&&"virtual"==B&&(C.bgColor="#E0F0FF");var A=RBuilder.appendTableCell(C),G=RString.startsWith(B,"@")?" +":"  ";x=RString.repeat("   ",f)+G+" "+x;A.innerHTML=RHtml.toHtml(x);A.style.borderBottom="1px solid #F0F0F0";A.width="240px";F&&(F.hText=A);A=RBuilder.appendTableCell(C);
A.innerHTML=RHtml.toHtml(k);A.style.borderBottom="1px solid #F0F0F0";A.style.color="Function"==k?"#3333FF":"#FF3333";A.width="200px";A=RBuilder.appendTableCell(C);RString.startsWith(B,"@")&&(B=B.substr(1));A.innerHTML=E?RHtml.toHtml(B):B;A.style.borderBottom="1px solid #F0F0F0"}b.width="100%"},MO.RDump_dump=function(a,b){b||(b=RBuilder.append(null,"DIV"));var d=new TString;d.append("<",RClass.safeTypeOf(a));a&&a.tagName&&d.append(" - ",a.tagName);d.appendLine("@"+RClass.code(a)+">");b=RBuilder.append(b,
"DIV");b.style.border="1px solid #BBBBBB";b.style.backgroundColor="#E0E0EB";var f=RBuilder.appendTable(b,null,null,0,1,0),h=RBuilder.appendTableRow(f),h=RBuilder.appendTableCell(h);f.width="100%";h.style.padding=2;h.style.borderBottom="1px solid gray";h.style.backgroundColor="#E0E0EB";RHtml.textSet(h,d.toString());d=RBuilder.appendTable(b,null,null,0,1,0);d.style.width="100%";f=new TDumpItem;f.hTable=d;f.hRow=null;f.hParent=b;f.link=a;f.level=0;this.dumpInner(f)},MO.RDump_appendLevel=function(a,b){for(var d=
0;d<b;d++)a.append("   ")},MO.RDump_stack=function RDump_stack(){for(var b=RDump_stack.caller,d=new TString;b;)d.append(RMethod.name(b)),(b=b.caller)&&d.appendLine();RLogger.debug(this,d)},MO.RDump=new RDump;
with(MO)MO.RHtml=function(){this._nextUid=1;this._links={};this._clientPosition=new MO.SPoint2;this.uid=RHtml_uid;this.fullscreen=RHtml_fullscreen;this.displayGet=RHtml_displayGet;this.displaySet=RHtml_displaySet;this.visibleGet=RHtml_visibleGet;this.visibleSet=RHtml_visibleSet;this.textGet=RHtml_textGet;this.textSet=RHtml_textSet;this.checkGet=RHtml_checkGet;this.checkSet=RHtml_checkSet;this.radioGet=RHtml_radioGet;this.radioSet=RHtml_radioSet;this.cursorSet=RHtml_cursorSet;this.linkGet=RHtml_linkGet;
this.linkSet=RHtml_linkSet;this.clientPosition=RHtml_clientPosition;this.clientX=RHtml_clientX;this.clientY=RHtml_clientY;this.setSize=RHtml_setSize;this.toText=RHtml_toText;this.toHtml=RHtml_toHtml;this.eventSource=RHtml_eventSource;this.get=RHtml_get;this.parent=RHtml_parent;this.searchLinker=RHtml_searchLinker;this.searchObject=RHtml_searchObject;this.tableMoveRow=RHtml_tableMoveRow;this.free=RHtml_free;return this},MO.RHtml_uid=function(a){var b=a.__puuid;null==b&&(b=a.__puuid=RHtml._nextUid++);
return b},MO.RHtml_fullscreen=function(a,b){b?a.requestFullscreen?a.requestFullscreen():a.mozRequestFullScreen?a.mozRequestFullScreen():a.webkitRequestFullScreen&&a.webkitRequestFullScreen():a.exitFullscreen?a.exitFullscreen():a.mozCancelFullScreen?a.mozCancelFullScreen():a.webkitCancelFullScreen&&a.webkitCancelFullScreen()},MO.RHtml_displayGet=function(a){var b=null;a=a.style.display;return b=RBrowser.isBrowser(EBrowser.Explorer)?"inline"==a:"none"!=a},MO.RHtml_displaySet=function(a,b){var d=null,
d=RBrowser.isBrowser(EBrowser.Explorer)?b?"inline":"none":b?null:"none";a.style.display=d},MO.RHtml_visibleGet=function(a){var b=null;a=a.style.display;return b=RBrowser.isBrowser(EBrowser.Explorer)?"block"==a:"none"!=a},MO.RHtml_visibleSet=function(a,b){var d=null,d=RBrowser.isBrowser(EBrowser.Explorer)?b?"":"none":b?null:"none";a.style.display=d},MO.RHtml_textGet=function(a,b){var d=null;return d=RBrowser.isBrowser(EBrowser.FireFox)?a.textContent:a.innerText},MO.RHtml_textSet=function(a,b){RBrowser.isBrowser(EBrowser.FireFox)?
a.textContent=b:a.innerText=b},MO.RHtml_checkGet=function(a){return RBool.toString(a.checked)},MO.RHtml_checkSet=function(a,b){a.checked=RBool.isTrue(b)},MO.RHtml_radioGet=function(a){if(a)for(var b=a.length,d=0;d<b;d++){var f=a[d];if(f.checked)return f.value}return null},MO.RHtml_radioSet=function(a,b){if(a)for(var d=a.length,f=0;f<d;f++){var h=a[f];if(h.value==b){h.checked=!0;break}}},MO.RHtml_cursorSet=function(a,b){a&&(a.style.cursor=b)},MO.RHtml_linkGet=function(a,b){var d=this.uid(a);return(d=
this._links[d])?d.get(b):null},MO.RHtml_linkSet=function(a,b,d){var f=this._links,h=this.uid(a),k=f[h];k||(k=f[h]=new THtmlItem,k._link=a);k.set(b,d)},MO.RHtml_clientPosition=function(a,b){var d=this._clientPosition;for(d.set(0,0);a!=b;)d.x+=a.offsetLeft+a.clientLeft-a.scrollLeft,d.y+=a.offsetTop+a.clientTop-a.scrollTop,a=a.offsetParent;return d},MO.RHtml_clientX=function(a,b){for(var d=0;a!=b;)d+=a.offsetLeft-a.scrollLeft,a=a.offsetParent;return d},MO.RHtml_clientY=function(a,b){for(var d=0;a!=b;)d+=
a.offsetTop-a.scrollTop,a=a.offsetParent;return d},MO.RHtml_setSize=function(a,b){b.width&&(a.style.width=b.width+"px");b.height&&(a.style.height=b.height+"px")},MO.RHtml_toText=function(a){null!=a&&(a=a.toString(),a=a.replace(/&lt;/,"<"),a=a.replace(/&gt;/g,">"),a=a.replace(/&nbsp;/g," "),a=a.replace(/<BR>/g,"\n"));return a},MO.RHtml_toHtml=function(a){null!=a&&(a=a.toString(),a=a.replace(/</g,"&lt;"),a=a.replace(/>/g,"&gt;"),a=a.replace(/ /g,"&nbsp;"),a=a.replace(/\n/g,"<BR>"),a=a.replace(/\\n/g,
"<BR>"),a=a.replace(/\r/g,""),a=a.replace(/\\r/g,""));return a},MO.RHtml_eventSource=function(a){return a.srcElement?a.srcElement:a.target},MO.RHtml_get=function(a){return document.getElementById(a)},MO.RHtml_parent=function(a,b){if(a&&t)for(b=b.toLowerCase();a;){if(a.tagName.toLowerCase()==b)return a;a=a.parentElement}return null},MO.RHtml_searchLinker=function(a,b){for(;a;){var d=a.__linker;if(d&&RClass.isClass(d,b))return d;a=a.parentElement}return null},MO.RHtml_searchObject=function(a,b){for(;a;){var d=
a[b];if(d)return d;a=a.parentElement}return null},MO.RHtml_tableMoveRow=function(a,b,d){if("TABLE"!=a.tagName)throw new TError("Html table is invalid.");if(b==d)return!1;if(a.moveRow)a.moveRow(b,d);else{a=a.getElementsByTagName("tbody")[0];var f=a.rows[b],h=a.rows[d];if(null==f||null==h)return!1;var k=null;if(b<=d)for(k=h;(k=k.nextSibling)&&"TR"!=k.tagName;);null==k?a.insertBefore(f,h):null==k?a.appendChild(f):a.insertBefore(f,k)}return!0},MO.RHtml_free=function(a){return null},MO.RHtml_clone=function RHtml_clone(b,
d,f){f||(f=d.cloneNode(!0));d._pname&&(b[d._pname]=f);d._ptyName&&(b[d._ptyName]=f);var h=REvent.find(d).events;f._psource=d;for(var k in h)f[h[k].handle]=d[h[k].handle],f[h[k].handle]&&RHtml.link(f,"_plink",b);d=d.children;for(k=d.length;0<=--k;)RHtml_clone(b,d[k],f.children[k]);return f},MO.RHtml_offsetPosition=function(a,b){for(var d=new TPoint;a!=b;)d.x+=a.offsetLeft-a.scrollLeft,d.y+=a.offsetTop-a.scrollTop,RHtml.currentStyle(a),d.x+=a.clientLeft,d.y+=a.clientTop,a=a.offsetParent;return d},MO.RHtml_offsetX=
function(a){for(var b=0;a;)b+=a.offsetLeft,a=a.offsetParent;return b},MO.RHtml_offsetY=function(a){for(var b=0;a;)b+=a.offsetTop,a=a.offsetParent;return b},MO.RHtml_bodyWidth=function(a){return a.all?a.body.scrollWidth:a.documentElement.scrollWidth},MO.RHtml_bodyHeight=function(a){return a.all?a.body.scrollHeight:a.documentElement.scrollHeight},MO.RHtml_frameHeight=function(a){a=a.contentWindow.document;return Math.max(a.body.scrollHeight,a.documentElement.scrollHeight)},MO.RHtml_scrollWidth=function(a){var b=
0;a.offsetWidth&&(b+=a.offsetWidth);a.borderTopWidth&&(b-=parseInt(a.borderLeftWidth));a.borderBottomWidth&&(b-=parseInt(a.borderRightWidth));a.clientWidth&&(b-=a.clientWidth);return b},MO.RHtml_scrollHeight=function(a){var b=0;a.offsetHeight&&(b+=a.offsetHeight);a.borderTopWidth&&(b-=parseInt(a.borderTopWidth));a.borderBottomWidth&&(b-=parseInt(a.borderBottomWidth));a.clientHeight&&(b-=a.clientHeight);return b},MO.RHtml_currentStyle=function(a){return a.currentStyle?a.currentStyle:window.getComputedStyle(a,
null)},MO.RHtml_point=function(a,b){return this.toPoint(new TPoint,a,b)},MO.RHtml_toPoint=function(a,b,d){if(a&&b){d=RObject.nvl(d,window.document.body);var f=RHtml.currentStyle(b);a.x=-RInt.parse(f.borderLeftWidth);for(a.y=-RInt.parse(f.borderTopWidth);b&&b!=d;)a.x+=b.offsetLeft-b.scrollLeft,a.y+=b.offsetTop-b.scrollTop,"absolute"!=RHtml.currentStyle(b).position&&(a.x+=b.clientLeft,a.y+=b.clientTop),b=b.offsetParent}return a},MO.RHtml_rect=function(a,b){return this.toRect(new TRect,a,b)},MO.RHtml_toRect=
function(a,b,d){if(a&&b){d=RObject.nvl(d,window.document.body);var f=RHtml.currentStyle(b);a.left=-RInt.parse(f.borderLeftWidth);a.top=-RInt.parse(f.borderTopWidth);for(var f=b.offsetWidth,f=b.offsetWidth-1,h=b.offsetHeight,h=b.offsetHeight-1;b&&b!=d;)a.left+=b.offsetLeft-b.scrollLeft,a.top+=b.offsetTop-b.scrollTop,"absolute"!=RHtml.currentStyle(b).position&&(a.left+=b.clientLeft,a.top+=b.clientTop),b=b.offsetParent;a.right=a.left+f;a.bottom=a.top+h}return a},MO.RHtml_top=function(a){var b=0;if(a)for(b=
RHtml.currentStyle(o),b=-RInteger.parse(b.borderTopWidth);a;)b+=a.offsetTop-a.scrollTop,"absolute"!=RHtml.currentStyle(o).position&&(b+=a.clientTop),a=a.offsetParent;return b},MO.RHtml_clientRect=function(a){if(a){for(var b=0,d=0,f=a.offsetWidth-1,h=a.offsetHeight-1;a;)b+=a.offsetLeft,d+=a.offsetTop,a=a.offsetParent;return new TRect(b,d,b+f,d+h)}return null},MO.RHtml_offsetRect=function(a){if(a){for(var b=0,d=0,f=a.offsetWidth-1,h=a.offsetHeight-1;a;)b+=a.offsetLeft+a.clientLeft,d+=a.offsetTop+a.clientTop,
a=a.offsetParent;return new TRect(b,d,b+f,d+h)}return null},MO.RHtml_clear=function(a){if(a){var b=a.children;if(b&&b.length)for(var d=b.length-1;0<=d;d--){var f=b[d];f.children&&f.children.length&&this.clear(f);a.removeChild(f)}}},MO.RHtml_setRect=function(a,b){if(a&&a.style){var d=a.style;d.left=b.left;d.top=b.top;d.width=b.width();d.height=b.height()}},MO.RHtml_setBounds=function(a,b,d,f,h){a&&a.style&&(a=a.style,null!=b&&(a.left=b),null!=d&&(a.top=d),null!=f&&(a.width=f),null!=h&&(a.height=h))},
MO.RHtml_setPixelRect=function(a,b){if(a&&a.style){var d=a.style;d.pixelLeft=b.left;d.pixelTop=b.top;d.pixelWidth=b.width();d.pixelHeight=b.height()}},MO.RHtml_setPixelBounds=function(a,b,d,f,h){a&&a.style&&(a=a.style,null!=b&&(a.pixelLeft=b),null!=d&&(a.pixelTop=d),null!=f&&(a.pixelWidth=f),null!=h&&(a.pixelHeight=h))},MO.RHtml_changeWidth=function(a,b){if(a&&b){var d=RHtml.currentStyle(b),d=parseInt(d.paddingLeft)+parseInt(d.paddingRight);b.style.pixelWidth=a.offsetWidth-d}},MO.RHtml_showNodes=
function(a,b){if(a&&a.childNodes)for(var d=0;d<a.childNodes.length;d++){var f=a.childNodes(d);f.tagName&&f.style?f.style.display="block":"#text"==f.nodeName&&(f.nodeValue=b[d])}},MO.RHtml_hideNodes=function(a,b){if(a&&a.childNodes)for(var d=0;d<a.childNodes.length;d++){var f=a.childNodes(d);f.tagName&&f.style?f.style.display="none":"#text"==f.nodeName&&(b[d]=f.nodeValue,f.nodeValue="")}},MO.RHtml_showChildren=function(a){if(a&&a.children)for(var b=0;b<a.children.length;b++){var d=a.children(b);d.tagName&&
d.style&&(d.style.display="block")}},MO.RHtml_hideChildren=function(a){if(a&&a.children)for(var b=0;b<a.children.length;b++){var d=a.children(b);d.tagName&&d.style&&(d.style.display="none")}},MO.RHtml_posParent=function(a){for(;a;){if("visible"!=a.currentStyle.overflow)return a;a=a.offsetParent}return null},MO.RHtml_form=function(a){if(a){var b=this.parent(a,"FORM");return b?b:a.ownerDocument.forms[0]}return window.document.forms[0]},MO.RHtml_popup=function(a,b,d){b=RString.format("left={0},top={1},width={2},height={3},toolbar=no,location=no,directories=no,status=no,menubar=no,resizable=yes,scrollbars=yes,dependent=yes",
(screen.width-b)/2,(screen.height-d)/2-20,b,d);window.open(a,"_blank",b)},MO.RHtml_selectText=function(){document.getElementById(id).select();return document.selection.createRange().text},MO.getTRNode=function(a,b){for(;(a=a[b])&&"TR"!=a.tagName;);return a},MO.RHtml=new RHtml;
with(MO)MO.RXml=function(){this.httpActiveX=!1;this.httpVendor=null;this.domActiveX=!1;this.domVendor=null;this.construct=RXml_construct;this.isNode=RXml_isNode;this.createConnection=RXml_createConnection;this.createDocument=RXml_createDocument;this.formatText=RXml_formatText;this.buildText=RXml_buildText;this.buildNode=RXml_buildNode;this.makeString=RXml_makeString;this.makeNode=RXml_makeNode;this.makeDocument=RXml_makeDocument;this.unpack=RXml_unpack;this.construct();return this},MO.RXml_construct=
function(){var a=window.document;if(window.ActiveXObject&&!window.XMLHttpRequest)for(var b=["MSXml2.XmlHTTP","Microsoft.XmlHTTP","MSXml.XmlHTTP","MSXml3.XmlHTTP"],d=b.length,f=0;f<d;f++){var h=b[f];try{new ActiveXObject(h);this.httpActiveX=!0;this.httpVendor=h;break}catch(k){m=k}}else if(window.XMLHttpRequest)try{this.httpActiveX=!1}catch(q){m=q}else alert("Unknown http vendor.");if(window.ActiveXObject||!window.DOMParser)for(b=["MSXml2.DOMDocument","Microsoft.XmlDOM","MSXml.DOMDocument","MSXml3.XmlDOM"],
d=b.length,f=0;f<d;f++){h=b[f];try{new ActiveXObject(h);this.domActiveX=!0;this.domVendor=h;break}catch(w){m=w}}else if(window.DOMParser&&a&&a.implementation&&a.implementation.createDocument)try{document.implementation.createDocument("","",null),this.domActiveX=!1}catch(x){m=x}else alert("Unknown dom vendor.")},MO.RXml_isNode=function(a){return RClass.isName(a,"TNode")},MO.RXml_createConnection=function(){var a=null;(a=this.httpActiveX?new ActiveXObject(this.httpVendor):new XMLHttpRequest)||alert("Create xml connection failure. (message="+
m+")");return a},MO.RXml_createDocument=function(){var a=null;(a=this.domActiveX?new ActiveXObject(this.domVendor):document.implementation.createDocument("","",null))||alert("Create xml document failure. (message="+m+")");return a},MO.RXml_formatText=function(a){null!=a&&(a=a.replace(/\\n/g,"\n"));return a},MO.RXml_buildText=function(a,b){if(null!=b){b=b.toString();for(var d=b.length,f=0;f<d;f++){var h=b.charAt(f);switch(h){case "<":a.append("&lt;");break;case ">":a.append("&gt;");break;case '"':a.append("&quot;");
break;case "&":a.append("&amp;");break;case "\r":continue;case "\n":a.append("\\n");break;default:a.append(h)}}}return a},MO.RXml_buildNode=function(a,b,d){var f=null,h=d.attributes;if(h){var k=h.length;if(0<k)for(var f=new TAttributes,q=0;q<k;q++){var w=h[q];w.nodeName&&f.set(w.nodeName,RXml.formatText(w.value))}}k=new TString;k.append(d.value);if(h=d.childNodes)for(w=h.length,q=0;q<w;q++){var x=h[q],y=x.nodeType;y==ENodeType.Text?k.append(x.nodeValue):y==ENodeType.Data&&k.append(x.data)}d=a.create(d.nodeName,
f,RString.trim(k.toString()));b?b.push(d):a._root=d;if(h)for(b=h.length,q=0;q<b;q++)h[q].nodeType==ENodeType.Node&&this.buildNode(a,d,h[q])},MO.RXml_makeString=function(a){var b=null;this.domActiveX?(b=new ActiveXObject(this.domVendor),b.async=!1,b.loadXML(a)):b=(new DOMParser).parseFromString(a,"text/xml");return b},MO.RXml_makeNode=function(a){if(a.documentElement){var b=new TXmlDocument;this.buildNode(b,null,a.documentElement);return b.root()}if("SCRIPT"==a.tagName){var d=a.textContent;d||(d=a.text);
if(d)return b=new TXmlDocument,a=this.makeString(d),this.buildNode(b,null,a.documentElement),b.root()}return null},MO.RXml_makeDocument=function(a){var b=new TXmlDocument;a.documentElement&&RXml.buildNode(b,null,a.documentElement);return b},MO.RXml_unpack=function(a,b){if(RString.isEmpty(a))return null;b||(b=new TNode);var d=new TAttributes;d.unpack(a);b.name=d.get("name");b.value=d.get("value");d.contains("attributes")&&b.attributes().unpack(d.get("attributes"));if(d.contains("nodes")){var f=new TStrings;
f.unpack(d.get("nodes"));for(d=0;d<f.count;d++)this.unpack(f.get(d),b.create())}return b},MO.RXml=new RXml;MO.EDisplayTransform=new function(){this.CameraPosition="camera.position";this.CameraDirection="camera.direction";this.BilboardedSphere="bilboarded.sphere";this.BilboardedCylinder="bilboarded.cylinder";return this};MO.EResourceCompress=new function(){this.None="none";this.Deflate="deflate";this.Lzma="lzma";return this};
MO.EStageKey=new function(){this.Forward=MO.EKeyCode.W;this.Back=MO.EKeyCode.S;this.Up=MO.EKeyCode.Q;this.Down=MO.EKeyCode.E;this.RotationLeft=MO.EKeyCode.A;this.RotationRight=MO.EKeyCode.D;this.RotationUp=MO.EKeyCode.Z;this.RotationDown=MO.EKeyCode.X;this.FocusForward=MO.EKeyCode.I;this.FocusBack=MO.EKeyCode.K;this.FocusLeft=MO.EKeyCode.J;this.FocusRight=MO.EKeyCode.L;return this};
with(MO)MO.MListenerEnterFrame=function(a){a=RClass.inherits(this,a,MListener);a.addEnterFrameListener=MListenerEnterFrame_addEnterFrameListener;a.removeEnterFrameListener=MListenerEnterFrame_removeEnterFrameListener;a.processEnterFrameListener=MListenerEnterFrame_processEnterFrameListener;return a},MO.MListenerEnterFrame_addEnterFrameListener=function(a,b){return this.addListener(EEvent.EnterFrame,a,b)},MO.MListenerEnterFrame_removeEnterFrameListener=function(a,b){this.removeListener(EEvent.EnterFrame,
a,b)},MO.MListenerEnterFrame_processEnterFrameListener=function(a,b,d,f,h){this.processListener(EEvent.EnterFrame,a,b,d,f,h)};
with(MO)MO.MListenerLeaveFrame=function(a){a=RClass.inherits(this,a,MListener);a.addLeaveFrameListener=MListenerLeaveFrame_addLeaveFrameListener;a.removeLeaveFrameListener=MListenerLeaveFrame_removeLeaveFrameListener;a.processLeaveFrameListener=MListenerLeaveFrame_processLeaveFrameListener;return a},MO.MListenerLeaveFrame_addLeaveFrameListener=function(a,b){return this.addListener(EEvent.LeaveFrame,a,b)},MO.MListenerLeaveFrame_removeLeaveFrameListener=function(a,b){this.removeListener(EEvent.LeaveFrame,
a,b)},MO.MListenerLeaveFrame_processLeaveFrameListener=function(a,b,d,f,h){this.processListener(EEvent.LeaveFrame,a,b,d,f,h)};
with(MO)MO.FDisplayContainer=function(a){a=RClass.inherits(this,a);a._ready=!1;a._guid=null;a._index=-1;a._compressData=null;a._data=null;a.compressData=MResourceData_compressData;a.setCompressData=MResourceData_setCompressData;a.testReady=MResourceData_testReady;a.completeData=MResourceData_completeData;a.dispose=MResourceData_dispose;return a},MO.MResourceData_compressData=function(){return this._compressData},MO.MResourceData_setCompressData=function(a){this._compressData=a},MO.MResourceData_testReady=
function(){return this._ready},MO.MResourceData_completeData=function(a){this._data=a;this._ready=!0},MO.MResourceData_dispose=function(){this._data=this._compressData=null};
with(MO)MO.FDisplay=function(a){a=RClass.inherits(this,a,FComponent,MGraphicObject);a._currentMatrix=null;a._matrix=null;a._location=null;a._rotation=null;a._scale=null;a._visible=!0;a._renderables=null;a.construct=FDisplay_construct;a.currentMatrix=FDisplay_currentMatrix;a.matrix=FDisplay_matrix;a.location=FDisplay_location;a.rotation=FDisplay_rotation;a.scale=FDisplay_scale;a.hasRenderable=FDisplay_hasRenderable;a.renderables=FDisplay_renderables;a.pushRenderable=FDisplay_pushRenderable;a.removeRenderable=
FDisplay_removeRenderable;a.clearRenderables=FDisplay_clearRenderables;a.filterDisplays=FDisplay_filterDisplays;a.filterRenderables=FDisplay_filterRenderables;a.show=FDisplay_show;a.hide=FDisplay_hide;a.setVisible=FDisplay_setVisible;a.update=FDisplay_update;a.updateMatrix=FDisplay_updateMatrix;a.process=FDisplay_process;a.remove=FDisplay_remove;a.dispose=FDisplay_dispose;return a},MO.FDisplay_construct=function(){this.__base.FComponent.construct.call(this);this._currentMatrix=new SMatrix3d;this._matrix=
new SMatrix3d;this._location=new SPoint3;this._rotation=new SVector3;this._scale=new SVector3;this._scale.set(1,1,1)},MO.FDisplay_currentMatrix=function(){return this._currentMatrix},MO.FDisplay_matrix=function(){return this._matrix},MO.FDisplay_location=function(){return this._location},MO.FDisplay_rotation=function(){return this._rotation},MO.FDisplay_scale=function(){return this._scale},MO.FDisplay_hasRenderable=function(){var a=this._renderables;return a?!a.isEmpty():!1},MO.FDisplay_renderables=
function(){var a=this._renderables;a||(a=this._renderables=new TObjects);return a},MO.FDisplay_pushRenderable=function(a){a._display=this;this.renderables().push(a)},MO.FDisplay_removeRenderable=function(a){var b=this._renderables;b&&b.remove(a)},MO.FDisplay_clearRenderables=function(){var a=this._renderables;a&&a.clear()},MO.FDisplay_filterDisplays=function(a){this._visible&&a.push(this)},MO.FDisplay_filterRenderables=function(a){if(!this._visible)return!1;var b=this._renderables;if(b)for(var d=
b.count(),f=0;f<d;f++)b.getAt(f).filterDrawables(a);return!0},MO.FDisplay_show=function(){this.setVisible(!0)},MO.FDisplay_hide=function(){this.setVisible(!1)},MO.FDisplay_setVisible=function(a){this._visible=a},MO.FDisplay_update=function(){var a=this._matrix;a.set(this._location,this._rotation,this._scale);a.update()},MO.FDisplay_updateMatrix=function(a){this._currentMatrix.assign(this._matrix);(a=this._parent)&&this._currentMatrix.append(a._currentMatrix)},MO.FDisplay_process=function(a){this.updateMatrix(a);
var b=this._renderables;if(b)for(var d=b.count(),f=0;f<d;f++)b.at(f).process(a)},MO.FDisplay_remove=function(){var a=this._parent;a&&(a.removeDisplay(this),this._parent=null)},MO.FDisplay_dispose=function(){RObject.dispose(this._currentMatrix);RObject.dispose(this._matrix);RObject.dispose(this._position);RObject.dispose(this._direction);RObject.dispose(this._scale);RObject.dispose(this._renderables);this.__base.FComponent.dispose.call(this)};
with(MO)MO.FDisplayContainer=function(a){a=RClass.inherits(this,a,FDisplay);a._displays=null;a.hasDisplay=FDisplayContainer_hasDisplay;a.findDisplay=FDisplayContainer_findDisplay;a.searchDisplay=FDisplayContainer_searchDisplay;a.displays=FDisplayContainer_displays;a.pushDisplay=FDisplayContainer_pushDisplay;a.removeDisplay=FDisplayContainer_removeDisplay;a.filterDisplays=FDisplayContainer_filterDisplays;a.filterRenderables=FDisplayContainer_filterRenderables;a.process=FDisplayContainer_process;a.dispose=
FDisplayContainer_dispose;return a},MO.FDisplayContainer_hasDisplay=function(){var a=this._displays;return a?!a.isEmpty():!1},MO.FDisplayContainer_findDisplay=function(a){var b=this._displays;if(b)for(var d=b.count(),f=0;f<d;f++){var h=b.at(f);if(h.code()==a)return h}return null},MO.FDisplayContainer_searchDisplay=function(a){var b=this._displays;if(b)for(var d=b.count(),f=0;f<d;f++){var h=b.at(f);if(h.isName(a)||(h=h.searchDisplay(a)))return h}return null},MO.FDisplayContainer_displays=function(){var a=
this._displays;a||(a=this._displays=new TObjects);return a},MO.FDisplayContainer_pushDisplay=function(a){a.setParent(this);this.displays().push(a)},MO.FDisplayContainer_removeDisplay=function(a){this.displays().remove(a);a.setParent(null)},MO.FDisplayContainer_filterDisplays=function(a){this.__base.FDisplay.filterDisplays.call(this,a);if(!this._visible)return!1;var b=this._displays;if(b)for(var d=b.count(),f=0;f<d;f++)b.at(f).filterDisplays(a)},MO.FDisplayContainer_filterRenderables=function(a){this.__base.FDisplay.filterRenderables.call(this,
a);if(!this._visible)return!1;var b=this._displays;if(b)for(var d=b.count(),f=0;f<d;f++)b.at(f).filterRenderables(a);return!0},MO.FDisplayContainer_process=function(a){this.__base.FDisplay.process.call(this,a);var b=this._displays;if(b)for(var d=b.count(),f=0;f<d;f++)b.at(f).process(a)},MO.FDisplayContainer_dispose=function(){var a=this._displays;if(a){for(var b=v.count()-1;0<=b;b--)a.at(b).dispose();this._displays=RObject.dispose(a)}this.__base.FDisplay.dispose.call(this)};
with(MO)MO.FDisplayLayer=function(a){a=RClass.inherits(this,a,FDisplayContainer);a._statusActive=!1;a._technique=null;a._visibleRenderables=null;a.construct=FDisplayLayer_construct;a.technique=FDisplayLayer_technique;a.setTechnique=FDisplayLayer_setTechnique;a.selectTechnique=FDisplayLayer_selectTechnique;a.visibleRenderables=FDisplayLayer_visibleRenderables;a.filterRenderables=FDisplayLayer_filterRenderables;a.active=FDisplayLayer_active;a.deactive=FDisplayLayer_deactive;return a},MO.FDisplayLayer_construct=
function(){this.__base.FDisplayContainer.construct.call(this);this._visibleRenderables=new TObjects},MO.FDisplayLayer_technique=function(){return this._technique},MO.FDisplayLayer_setTechnique=function(a){this._technique=a},MO.FDisplayLayer_selectTechnique=function(a,b){this._technique=RConsole.find(FG3dTechniqueConsole).find(a,b)},MO.FDisplayLayer_visibleRenderables=function(){return this._visibleRenderables},MO.FDisplayLayer_filterRenderables=function(a){this.__base.FDisplayContainer.filterRenderables.call(this,
a);this._visibleRenderables.assign(a.renderables())},MO.FDisplayLayer_active=function(){this._statusActive=!0},MO.FDisplayLayer_deactive=function(){this._statusActive=!1};with(MO)MO.FDisplayUiLayer=function(a){return a=RClass.inherits(this,a,FDisplayLayer)};
with(MO)MO.FDrawable=function(a){a=RClass.inherits(this,a,FObject);a._visible=!0;a.testVisible=FDrawable_testVisible;a.visible=FDrawable_visible;a.setVisible=FDrawable_setVisible;a.process=RMethod.empty;return a},MO.FDrawable_testVisible=function(){return this._visible},MO.FDrawable_visible=function(){return this._visible},MO.FDrawable_setVisible=function(a){this._visible=a};with(MO)MO.FRegion=function(a){return a=RClass.inherits(this,a,FObject)};
with(MO)MO.FRenderable=function(a){a=RClass.inherits(this,a,FDrawable);a._drawables=null;a.hasDrawable=FRenderable_hasDrawable;a.drawables=FRenderable_drawables;a.pushDrawable=FRenderable_pushDrawable;a.removeDrawable=FRenderable_removeDrawable;a.filterDrawables=FRenderable_filterDrawables;a.process=FRenderable_process;return a},MO.FRenderable_hasDrawable=function(){var a=this._drawables;return a?!a.isEmpty():!1},MO.FRenderable_drawables=function(){var a=this._drawables;a||(a=this._drawables=new TObjects);
return a},MO.FRenderable_pushDrawable=function(a){a._drawable=this;a._parent=this;this.drawables().push(a)},MO.FRenderable_removeDrawable=function(a){this._drawables.remove(a)},MO.FRenderable_filterDrawables=function(a){if(!this.testVisible())return!1;a.pushRenderable(this);var b=this._drawables;if(b)for(var d=b.count(),f=0;f<d;f++){var h=b.getAt(f);h.testVisible()&&a.pushRenderable(h)}return!0},MO.FRenderable_process=function(a){this.__base.FDrawable.process.call(this,a);var b=this._drawables;if(b)for(var d=
b.count(),f=0;f<d;f++)b.getAt(f).process(a)};
with(MO)MO.FStage=function(a){a=RClass.inherits(this,a,FComponent,MListenerEnterFrame,MListenerLeaveFrame);a._statusActive=!1;a._layers=null;a._timer=null;a.onProcess=FStage_onProcess;a.construct=FStage_construct;a.timer=FStage_timer;a.registerLayer=FStage_registerLayer;a.unregisterLayer=FStage_unregisterLayer;a.layers=FStage_layers;a.active=FStage_active;a.deactive=FStage_deactive;a.process=FStage_process;a.dispose=FStage_dispose;return a},MO.FStage_onProcess=function(){for(var a=this._layers,b=
a.count(),d=0;d<b;d++)a.valueAt(d).process()},MO.FStage_construct=function(){this.__base.FComponent.construct.call(this);this._timer=RClass.create(FTimer);this._layers=new TDictionary},MO.FStage_timer=function(){return this._timer},MO.FStage_registerLayer=function(a,b){b.setCode(a);this._layers.set(a,b)},MO.FStage_unregisterLayer=function(a){this._layers.set(a,null)},MO.FStage_layers=function(){return this._layers},MO.FStage_active=function(){this._statusActive=!0;for(var a=this._layers,b=a.count(),
d=0;d<b;d++)a.value(d).active()},MO.FStage_deactive=function(){for(var a=this._layers,b=a.count(),d=0;d<b;d++)a.value(d).deactive();this._statusActive=!1},MO.FStage_process=function(){var a=this._timer;a||(a=RClass.create(FTimer),a.setup());this.processEnterFrameListener(this);this.onProcess();this.processLeaveFrameListener(this);a.update()},MO.FStage_dispose=function(){this._timer=RObject.dispose(this._timer);this._layers=RObject.dispose(this._layers);this.__base.MListenerEnterFrame.dispose.call(this);
this.__base.MListenerLeaveFrame.dispose.call(this);this.__base.FComponent.dispose.call(this)};
with(MO)MO.RStage=function(){this._started=!1;this._thread=null;this._active=!0;this._interval=25;this.lsnsLeaveFrame=this.lsnsEnterFrame=this._stages=null;this.onProcess=RStage_onProcess;this.construct=RStage_construct;this.register=RStage_register;this.unregister=RStage_unregister;this.active=RStage_active;this.process=RStage_process;this.deactive=RStage_deactive;this.start=RStage_start;this.construct();return this},MO.RStage_onProcess=function(a){if(this._active)try{this.lsnsEnterFrame.process(this);
var b=this._stages;if(b){var d=b.count();for(a=0;a<d;a++)b.at(a).process()}this.lsnsLeaveFrame.process(this);RTimer.update()}catch(f){alert(f)}},MO.RStage_construct=function(){this.lsnsEnterFrame=new TListeners;this.lsnsLeaveFrame=new TListeners},MO.RStage_register=function(a,b){var d=this._stages;d||(d=this._stages=new TDictionary);d.set(a,b)},MO.RStage_unregister=function(a){this._stages.removeValue(a)},MO.RStage_active=function(){var a=this._stages;if(a)for(var b=a.count(),d=0;d<b;d++)a.at(d).active()},
MO.RStage_process=function(){this.onProcess()},MO.RStage_deactive=function(){var a=this._stages;if(a)for(var b=a.count(),d=0;d<b;d++)a.at(d).deactive()},MO.RStage_start=function(a){this._started||(RE3dEngine.setup(),this.active(),RTimer.setup(),null==a&&(a=this._interval),this._interval=parseInt(a),a=this._thread=RClass.create(FThread),a.setInterval(this._interval),a.addProcessListener(this,this.onProcess),RConsole.find(FThreadConsole).start(a),this._started=!0)},MO.RStage=new RStage;
with(MO)MO.MLinkerResource=function(a){a=RClass.inherits(this,a);a._resource=null;a.resource=MLinkerResource_resource;a.setResource=MLinkerResource_setResource;a.loadResource=MLinkerResource_loadResource;a.reloadResource=MLinkerResource_reloadResource;a.dispose=MLinkerResource_dispose;return a},MO.MLinkerResource_resource=function(){return this._resource},MO.MLinkerResource_setResource=function(a){this._resource=a},MO.MLinkerResource_loadResource=function(a){this._resource=a},MO.MLinkerResource_reloadResource=
function(a){this.loadResource(a)},MO.MLinkerResource_dispose=function(){this._resource=null};
with(MO)MO.FResource=function(a){a=RClass.inherits(this,a,FObject);a._typeCode=null;a._type=null;a._dataCompress=!1;a._dataBlock=!1;a._guid=null;a._code=null;a._label=null;a._sourceUrl=null;a.typeCode=FResource_typeCode;a.type=FResource_type;a.guid=FResource_guid;a.setGuid=FResource_setGuid;a.code=FResource_code;a.setCode=FResource_setCode;a.label=FResource_label;a.setLabel=FResource_setLabel;a.sourceUrl=FResource_sourceUrl;a.setSourceUrl=FResource_setSourceUrl;return a},MO.FResource_typeCode=function(){return this._typeCode},
MO.FResource_type=function(){return this._type},MO.FResource_guid=function(){return this._guid},MO.FResource_setGuid=function(a){this._guid=a},MO.FResource_code=function(){return this._code},MO.FResource_setCode=function(a){this._code=a},MO.FResource_label=function(){return this._label},MO.FResource_setLabel=function(a){this._label=a},MO.FResource_sourceUrl=function(){return this._sourceUrl},MO.FResource_setSourceUrl=function(a){this._sourceUrl=a};
with(MO)MO.FResourceBlockStorage=function(a){a=RClass.inherits(this,a,FResourceStorage);a._ready=!1;a._dataLength=0;a._blockSize=0;a._blockCount=0;a._blocks=null;a._resource=null;a.construct=FResourceBlockStorage_construct;a.testReady=FResourceBlockStorage_testReady;a.blocks=FResourceBlockStorage_blocks;a.load=FResourceBlockStorage_load;a.complete=FResourceBlockStorage_complete;a.dispose=FResourceBlockStorage_dispose;return a},MO.FResourceBlockStorage_construct=function(){this.__base.FResourceStorage.construct.call(this);
this._blocks=new TObjects},MO.FResourceBlockStorage_testReady=function(){if(!this._ready){for(var a=this._blocks,b=a.count(),d=0;d<b;d++)if(!a.at(d).testReady())return!1;this._ready=!0}return this._ready},MO.FResourceBlockStorage_blocks=function(){return this._blocks},MO.FResourceBlockStorage_load=function(a){var b=this._resource;this._compressLength=a.byteLength;var d=RClass.create(FDataView);d.setEndianCd(!0);d.link(a);d.readString();this._dataLength=d.readInt32();this._blockSize=d.readInt32();
a=this._blockCount=d.readInt32();for(var f=this._blocks,h=0;h<a;h++){var k=d.readInt32(),q=new ArrayBuffer(k);d.readBytes(q,0,k);k=RClass.create(FResourceBlockStorageData);k._guid=b.guid();k._index=h;k.setCompressData(q);f.push(k)}d.dispose()},MO.FResourceBlockStorage_complete=function(){var a=this._resource,b=RClass.create(FDataStream);b.setEndianCd(!0);b.setLength(this._dataLength);for(var d=this._blocks,f=d.count(),h=0;h<f;h++){var k=d.at(h)._data;b.writeBytes(k.buffer,0,k.byteLength)}b.flip();
d=RTimer.current()-a._compressStartTick;RLogger.info(this,"Process resource storage. (guid={1}, block_count={2}, length={3}, total={4}, tick={5})",a.guid(),f,this._compressLength,this._dataLength,d);a.onComplete(b);b.dispose()},MO.FResourceBlockStorage_dispose=function(){this._resource=null;var a=this._blocks;if(a){for(var b=a.count(),d=0;d<b;d++)a.at(d).dispose();this._blocks=RObject.dispose(a)}this.__base.FResourceStorage.dispose.call(this)};
with(MO)MO.FResourceBlockStorageData=function(a){a=RClass.inherits(this,a,FObject,MResourceData);a.dispose=FResourceBlockStorageData_dispose;return a},MO.FResourceBlockStorageData_dispose=function(){this.__base.MResourceData.dispose.call(this);this.__base.FObject.dispose.call(this)};
with(MO)MO.FResourceConsole=function(a){a=RClass.inherits(this,a,FConsole);a._scopeCd=EScope.Global;a._factory=null;a._types=null;a._resources=null;a._loadResources=null;a._loadingResources=null;a._processStorages=null;a._thread=null;a._loadLimit=8;a._interval=150;a.onComplete=FResourceConsole_onComplete;a.onLoad=FResourceConsole_onLoad;a.onBlockLoad=FResourceConsole_onBlockLoad;a.onProcess=FResourceConsole_onProcess;a.construct=FResourceConsole_construct;a.registerType=FResourceConsole_registerType;
a.factory=FResourceConsole_factory;a.load=FResourceConsole_load;return a},MO.FResourceConsole_onComplete=function(a,b){a._data=null;this._loadingResources.remove(a);a.onComplete(b)},MO.FResourceConsole_onLoad=function(a){var b=a.outputData();a=a._resource;var d=RClass.create(FResourceSingleStorage);d.setResource(a);d.load(b);RConsole.find(FResourceDataConsole).load(d);this._loadingResources.remove(a);this._processStorages.push(d)},MO.FResourceConsole_onBlockLoad=function(a){var b=a.outputData();a=
a._resource;a._compressLength=b.byteLength;a._compressStartTick=RTimer.current();var d=RClass.create(FResourceBlockStorage);d.setResource(a);d.load(b);for(var b=RConsole.find(FResourceDataConsole),f=d.blocks(),h=f.count(),k=0;k<h;k++){var q=f.at(k);b.load(q)}this._loadingResources.remove(a);this._processStorages.push(d)},MO.FResourceConsole_onProcess=function(){var a=RConsole.find(FHttpConsole),b=this._loadResources,d=this._loadingResources,f=d.count();if(!b.isEmpty())for(f=this._loadLimit-f;0<f;f--){var h=
b.shift(),k=h.sourceUrl(),k=a.send(k);k._resource=h;h._dataCompress?h._dataBlock?k.addLoadListener(this,this.onBlockLoad):k.addLoadListener(this,this.onLoad):k.addLoadListener(this,this.onComplete);h._dataLoad=!0;d.push(h);if(b.isEmpty())break}a=this._processStorages;for(a.record();a.next();)b=a.current(),b.testReady()&&(a.removeCurrent(),b.complete(),b.dispose())},MO.FResourceConsole_construct=function(){this.__base.FConsole.construct.call(this);this._factory=RClass.create(FClassFactory);this._types=
new TDictionary;this._resources=new TDictionary;this._loadResources=new TObjects;this._loadingResources=new TObjects;this._processStorages=new TLooper;var a=this._thread=RClass.create(FThread);a.setInterval(this._interval);a.addProcessListener(this,this.onProcess);RConsole.find(FThreadConsole).start(a)},MO.FResourceConsole_registerType=function(a){var b=a.code();return this._types.set(b,a)},MO.FResourceConsole_factory=function(){return this._factory},MO.FResourceConsole_load=function(a){var b=a.guid(),
d=this._resources;if(d.contains(b))throw new TError(this,"Resource is already loaded. (guid={1})",b);d.set(b,a);this._loadResources.push(a);a._dataLoad=!0};
with(MO)MO.FResourceDataConsole=function(a){a=RClass.inherits(this,a,FConsole);a._scopeCd=EScope.Global;a._loadDatas=null;a._processDatas=null;a._pipeline=null;a._pipelinePool=null;a._thread=null;a._processLimit=4;a._interval=200;a.onPipelineComplete=FResourceDataConsole_onPipelineComplete;a.onProcess=FResourceDataConsole_onProcess;a.construct=FResourceDataConsole_construct;a.allocPipeline=FResourceDataConsole_allocPipeline;a.freePipeline=FResourceDataConsole_freePipeline;a.load=FResourceDataConsole_load;
return a},MO.FResourceDataConsole_onPipelineComplete=function(a,b){a&&this.freePipeline(a);this._processDatas.remove(b)},MO.FResourceDataConsole_onProcess=function(){var a=this._loadDatas,b=a.count();if(0!=b){var d=this._pipeline;if(d)d.testBusy()||(b=a.shift(),d.decompress(b));else{var f=this._processDatas,d=f.count(),d=this._processLimit-d;if(!(0>=d))for(var h=Math.min(b,d),k=0;k<h;k++)b=a.shift(),d=this.allocPipeline(),d.decompress(b),f.push(b)}}},MO.FResourceDataConsole_construct=function(){this.__base.FConsole.construct.call(this);
this._loadDatas=new TObjects;this._processDatas=new TObjects;this._pipelinePool=RClass.create(FObjectPool);RBrowser.capability().optionProcess||(this._pipeline=RClass.create(FResourceSinglePipeline)).setConsole(this);var a=this._thread=RClass.create(FThread);a.setInterval(this._interval);a.addProcessListener(this,this.onProcess);RConsole.find(FThreadConsole).start(a)},MO.FResourceDataConsole_allocPipeline=function(){var a=this._pipelinePool;if(!a.hasFree()){var b=RClass.create(FResourceThreadPipeline);
b.setConsole(this);a.push(b)}return a.alloc()},MO.FResourceDataConsole_freePipeline=function(a){this._pipelinePool.free(a)},MO.FResourceDataConsole_load=function(a){this._loadDatas.push(a)};with(MO)MO.FResourceGroup=function(a){a=RClass.inherits(this,a,FObject);a._code=null;a._resources=null;a.code=FResourceGroup_code;return a},MO.FResourceGroup_code=function(){return this._code};
with(MO)MO.FResourcePipeline=function(a){a=RClass.inherits(this,a,FPipeline);a._console=null;a._compressCd=null;a._resource=null;a.console=FResourcePipeline_console;a.setConsole=FResourcePipeline_setConsole;a.compressCd=FResourcePipeline_compressCd;a.resource=FResourcePipeline_resource;a.setResource=FResourcePipeline_setResource;a.dispose=FResourcePipeline_dispose;return a},MO.FResourcePipeline_console=function(){return this._console},MO.FResourcePipeline_setConsole=function(a){this._console=a},MO.FResourcePipeline_compressCd=
function(){return this._compressCd},MO.FResourcePipeline_resource=function(){return this._resource},MO.FResourcePipeline_setResource=function(a){this._resource=a},MO.FResourcePipeline_dispose=function(){this._resource=this._console=null;this.__base.FPipeline.dispose.call(this)};
with(MO)MO.FResourceSinglePipeline=function(a){a=RClass.inherits(this,a,FResourcePipeline);a._startTime=0;a._statusBusy=!1;a._data=0;a._dataLength=0;a._worker=null;a.onComplete=FResourceSinglePipeline_onComplete;a.construct=FResourceSinglePipeline_construct;a.testBusy=FResourceSinglePipeline_testBusy;a.decompress=FResourceSinglePipeline_decompress;a.dispose=FResourceSinglePipeline_dispose;return a},MO.FResourceSinglePipeline_onComplete=function(a){var b=this._data,d=null;if(a.constructor==Array)d=
new Uint8Array(a);else if(a.constructor==ArrayBuffer)d=a;else throw new TError(this,"Unknown buffer type.");b.completeData(d);a=RTimer.now()-this._startTime;RLogger.info(this,"Process resource data decompress. (guid={1}, block={2}, length={3}, total={4}, tick={5})",b._guid,b._index,this._dataLength,d.byteLength,a);this._console.onPipelineComplete(null,b);this._data=null;this._statusBusy=!1},MO.FResourceSinglePipeline_construct=function(){this.__base.FResourcePipeline.construct.call(this)},MO.FResourceSinglePipeline_testBusy=
function(){return this._statusBusy},MO.FResourceSinglePipeline_decompress=function(a){var b=this;b._statusBusy=!0;b._startTime=RTimer.current();var d=a.compressData();b._data=a;b._dataLength=d.byteLength;a=null;if(d.constructor==ArrayBuffer)a=new Uint8Array(d);else if(d.constructor==Uint8Array)a=d;else throw new TError(b,"Unknown data type.");LZMAD.decompress(a,function(a){b.onComplete(a)},null)},MO.FResourceSinglePipeline_dispose=function(){this._worker=this._data=null;this.__base.FPipeline.dispose.call(this)};
with(MO)MO.FResourceSingleStorage=function(a){a=RClass.inherits(this,a,FResourceStorage,MResourceData);a.construct=FResourceSingleStorage_construct;a.load=FResourceSingleStorage_load;a.complete=FResourceSingleStorage_complete;a.dispose=FResourceSingleStorage_dispose;return a},MO.FResourceSingleStorage_construct=function(){this.__base.FResourceStorage.construct.call(this)},MO.FResourceSingleStorage_load=function(a){this._compressLength=a.byteLength;this._compressData=new Uint8Array(a)},MO.FResourceSingleStorage_complete=
function(){this._resource.onComplete(this._data)},MO.FResourceSingleStorage_dispose=function(){this.__base.MResourceData.dispose.call(this);this.__base.FResourceStorage.dispose.call(this)};
with(MO)MO.FResourceStorage=function(a){a=RClass.inherits(this,a,FObject);a._ready=!1;a._dataLength=0;a._resource=null;a.construct=FResourceStorage_construct;a.testReady=FResourceStorage_testReady;a.resource=FResourceStorage_resource;a.setResource=FResourceStorage_setResource;a.load=FResourceStorage_load;a.complete=FResourceStorage_complete;a.dispose=FResourceStorage_dispose;return a},MO.FResourceStorage_construct=function(){this.__base.FObject.construct.call(this)},MO.FResourceStorage_testReady=
function(){return this._ready},MO.FResourceStorage_resource=function(){return this._resource},MO.FResourceStorage_setResource=function(a){this._resource=a},MO.FResourceStorage_load=function(a){},MO.FResourceStorage_complete=function(){},MO.FResourceStorage_dispose=function(){this._resource=null;this.__base.FObject.dispose.call(this)};
with(MO)MO.FResourceThreadPipeline=function(a){a=RClass.inherits(this,a,FResourcePipeline);a._startTime=0;a._data=0;a._dataLength=0;a._worker=null;a.onComplete=FResourceThreadPipeline_onComplete;a.construct=FResourceThreadPipeline_construct;a.worker=FResourceThreadPipeline_worker;a.decompress=FResourceThreadPipeline_decompress;a.dispose=FResourceThreadPipeline_dispose;return a},MO.FResourceThreadPipeline_onComplete=function(a){var b=null;if(a.constructor==Array)b=new Uint8Array(a);else if(a.constructor==
Uint8Array)b=a;else throw new TError(this,"Unknown buffer type.");var d=this._data;d.completeData(b);b=RTimer.now()-this._startTime;RLogger.info(this,"Process resource data decompress. (guid={1}, block={2}, length={3}, total={4}, tick={5})",d._guid,d._index,this._dataLength,a.byteLength,b);this._console.onPipelineComplete(this,d);this._data=null},MO.FResourceThreadPipeline_construct=function(){this.__base.FResourcePipeline.construct.call(this)},MO.FResourceThreadPipeline_worker=function(){var a=this._worker;
a||(a=RBrowser.contentPath("/ajs/lzma_worker.js"),a=this._worker=new LZMA_WORKER(a));return a},MO.FResourceThreadPipeline_decompress=function(a){var b=this;b._startTime=RTimer.current();var d=a.compressData();b._data=a;b._dataLength=d.byteLength;b.worker().decompress(d,function(a){b.onComplete(a)},null)},MO.FResourceThreadPipeline_dispose=function(){this._worker=this._data=null;this.__base.FPipeline.dispose.call(this)};
with(MO)MO.FResourceType=function(a){a=RClass.inherits(this,a,FObject);a._code=null;a._pipeline=null;a._resources=null;a.construct=FResourceType_construct;a.code=FResourceType_code;a.setCode=FResourceType_setCode;a.pipeline=FResourceType_pipeline;a.setPipeline=FResourceType_setPipeline;a.findResource=FResourceType_findResource;a.resources=FResourceType_resources;return a},MO.FResourceType_construct=function(){this.__base.FObject.construct.call(this);this._resources=new TDictionary},MO.FResourceType_code=
function(){return this._code},MO.FResourceType_setCode=function(a){this._code=a},MO.FResourceType_pipeline=function(){return this._pipeline},MO.FResourceType_setPipeline=function(a){this._pipeline=a},MO.FResourceType_findResource=function(a){return this._resources.get(a)},MO.FResourceType_resources=function(){return this._resources};
with(MO)MO.FE2dCanvas=function(a){a=RClass.inherits(this,a,FObject,MCanvasObject);a._size=null;a._context=null;a._hCanvas=null;a.onResize=FE2dCanvas_onResize;a.construct=FE2dCanvas_construct;a.htmlCanvas=FE2dCanvas_htmlCanvas;a.size=FE2dCanvas_size;a.context=FE2dCanvas_context;a.build=FE2dCanvas_build;a.setPanel=FE2dCanvas_setPanel;a.dispose=FE2dCanvas_dispose;return a},MO.FE2dCanvas_onResize=function(a){},MO.FE2dCanvas_construct=function(){this.__base.FObject.construct.call(this);this._size=new SSize2},
MO.FE2dCanvas_htmlCanvas=function(){return this._hCanvas},MO.FE2dCanvas_size=function(){return this._size},MO.FE2dCanvas_context=function(){return this._context},MO.FE2dCanvas_build=function(a){var b=this._size,d=b.width,b=b.height;a=this._hCanvas=RBuilder.create(a,"CANVAS");a.__linker=this;a.width=d;a.height=b;var f=a.style;f.width=d+"px";f.height=b+"px";(this._context=RClass.create(FG2dCanvasContext)).linkCanvas(a)},MO.FE2dCanvas_setPanel=function(a){this._hPanel=a;a.appendChild(this._hCanvas);
this.onResize()},MO.FE2dCanvas_dispose=function(){this._context=RObject.dispose(this._context);this._hPanel=RHtml.free(this._hPanel);this._hCanvas=RHtml.free(this._hCanvas);this.__base.FObject.dispose.call(this)};
with(MO)MO.FE2dCanvasConsole=function(a){a=RClass.inherits(this,a,FConsole);a._scopeCd=EScope.Local;a._pools=null;a.construct=FE2dCanvasConsole_construct;a.allocBySize=FE2dCanvasConsole_allocBySize;a.free=FE2dCanvasConsole_free;return a},MO.FE2dCanvasConsole_construct=function(){this.__base.FConsole.construct.call(this);this._pools=RClass.create(FObjectPools)},MO.FE2dCanvasConsole_allocBySize=function(a,b){var d=this._pools.alloc(a+"x"+b);if(d)return d;d=RClass.create(FE2dCanvas);d.size().set(a,b);
d.build(RWindow._hDocument);return d},MO.FE2dCanvasConsole_free=function(a){var b=this._pools,d=a.size();b.free(d.width+"x"+d.height,a)};with(MO)MO.FE2dDrawable=function(a){return a=RClass.inherits(this,a,FDrawable)};with(MO)MO.ME3dObject=function(a){return a=RClass.inherits(this,a,MGraphicObject,MAttributeGuid,MAttributeCode)};
with(MO)MO.FE3dCanvas=function(a){a=RClass.inherits(this,a,FObject,MGraphicObject,MListenerLoad,MMouseCapture);a._optionAlpha=!0;a._optionAntialias=!1;a._scaleRate=1;a._size=null;a._interval=1E3/60;a._hPanel=null;a._hCanvas=null;a.onEnterFrame=RMethod.empty;a.ohTouchStart=FE3dCanvas_ohTouchStart;a.ohTouchMove=FE3dCanvas_ohTouchMove;a.ohTouchStop=FE3dCanvas_ohTouchStop;a.onMouseCaptureStart=RMethod.empty;a.onMouseCapture=RMethod.empty;a.onMouseCaptureStop=RMethod.empty;a.onTouchStart=RMethod.empty;
a.onTouchMove=RMethod.empty;a.onTouchStop=RMethod.empty;a.onResize=FE3dCanvas_onResize;a.construct=FE3dCanvas_construct;a.build=FE3dCanvas_build;a.resize=FE3dCanvas_resize;a.setPanel=FE3dCanvas_setPanel;a.dispose=FE3dCanvas_dispose;return a},MO.FE3dCanvas_ohTouchStart=function(a){this.__linker.onTouchStart(a)},MO.FE3dCanvas_ohTouchMove=function(a){this.__linker.onTouchMove(a)},MO.FE3dCanvas_ohTouchStop=function(a){this.__linker.onTouchStop(a)},MO.FE3dCanvas_onResize=function(a){var b=this._hPanel;
a=b.offsetWidth;b=b.offsetHeight;if(!this._size.equalsData(a,b)){this._size.set(a,b);var d=this._hCanvas;a=d.width=a*this._scaleRate;b=d.height=b*this._scaleRate;this._graphicContext.setViewport(0,0,a,b)}},MO.FE3dCanvas_construct=function(){this.__base.FObject.construct.call(this);this._size=new SSize2},MO.FE3dCanvas_build=function(a){a=this._hCanvas=RBuilder.create(a,"CANVAS");a.__linker=this;a.style.width="100%";a.style.height="100%";RMethod.isEmpty(this.onTouchStart)||a.addEventListener("touchstart",
this.ohTouchStart,!1);RMethod.isEmpty(this.onTouchMove)||a.addEventListener("touchmove",this.ohTouchMove,!1);RMethod.isEmpty(this.onTouchStop)||a.addEventListener("touchend",this.ohTouchStop,!1);var b={};b.alpha=this._optionAlpha;b.antialias=this._optionAntialias;this._graphicContext=REngine3d.createContext(FWglContext,a,b);RStage.lsnsEnterFrame.register(this,this.onEnterFrame);RStage.start(this._interval);RWindow.lsnsResize.register(this,this.onResize);RWindow.lsnsOrientation.register(this,this.onResize);
RConsole.find(FMouseConsole).register(this)},MO.FE3dCanvas_resize=function(){this.onResize()},MO.FE3dCanvas_setPanel=function(a){this._hPanel=a;a.appendChild(this._hCanvas);this.onResize()},MO.FE3dCanvas_dispose=function(){var a=this._hCanvas;a&&(a.__linker=null,a.removeEventListener("touchstart",this.ohTouchStart),a.removeEventListener("touchmove",this.ohTouchMove),a.removeEventListener("touchend",this.ohTouchStop));this._graphicContext=RObject.dispose(this._graphicContext);this._hPanel=RHtml.free(this._hPanel);
this._hCanvas=RHtml.free(this._hCanvas);this.__base.FObject.dispose.call(this)};
with(MO)MO.FE3dDisplay=function(a){a=RClass.inherits(this,a,FDisplay);a._outline=null;a._materials=null;a.construct=FE3dDisplay_construct;a.materials=FE3dDisplay_materials;a.calculateOutline=FE3dDisplay_calculateOutline;a.dispose=FE3dDisplay_dispose;return a},MO.FE3dDisplay_construct=function(){this.__base.FDisplay.construct.call(this);this._outline=new SOutline3},MO.FE3dDisplay_materials=function(){return this._materials},MO.FE3dDisplay_calculateOutline=function(){return this._outline},MO.FE3dDisplay_dispose=
function(){this._materials=RObject.free(this._materials);this.__base.FDisplay.dispose.call(this)};
with(MO)MO.FE3dDisplayContainer=function(a){a=RClass.inherits(this,a,FDisplayContainer);a._outline=null;a._materials=null;a.construct=FE3dDisplayContainer_construct;a.materials=FE3dDisplayContainer_materials;a.calculateOutline=FE3dDisplayContainer_calculateOutline;a.dispose=FE3dDisplayContainer_dispose;return a},MO.FE3dDisplayContainer_construct=function(){this.__base.FDisplayContainer.construct.call(this);this._outline=new SOutline3},MO.FE3dDisplayContainer_materials=function(){return this._materials},
MO.FE3dDisplayContainer_calculateOutline=function(){var a=this._outline;if(a.isEmpty()){a.setMin();var b=this._renderables;if(b)for(var d=b.count(),f=0;f<d;f++){var h=b.at(f).calculateOutline();a.mergeMax(h)}}return a},MO.FE3dDisplayContainer_dispose=function(){this._materials=RObject.free(this._materials);this.__base.FDisplayContainer.dispose.call(this)};
with(MO)MO.FE3dRenderable=function(a){a=RClass.inherits(this,a,FRenderable,MG3dRenderable,MGraphicObject,MLinkerResource);a._display=null;a._outline=null;a._outlineVisible=!0;a._calculateMatrix=null;a._vertexCount=0;a._vertexBuffers=null;a._indexBuffer=null;a._indexBuffers=null;a._materialReference=null;a._materials=null;a._bones=null;a._textures=null;a.construct=FE3dRenderable_construct;a.setup=RMethod.empty;a.testReady=RMethod.emptyTrue;a.testVisible=FE3dRenderable_testVisible;a.display=FE3dRenderable_display;
a.setDisplay=FE3dRenderable_setDisplay;a.vertexCount=FE3dRenderable_vertexCount;a.findVertexBuffer=FE3dRenderable_findVertexBuffer;a.vertexBuffers=FE3dRenderable_vertexBuffers;a.pushVertexBuffer=FE3dRenderable_pushVertexBuffer;a.indexBuffer=FE3dRenderable_indexBuffer;a.indexBuffers=FE3dRenderable_indexBuffers;a.materialReference=FE3dRenderable_materialReference;a.materials=FE3dRenderable_materials;a.pushMaterial=FE3dRenderable_pushMaterial;a.bones=FE3dRenderable_bones;a.findTexture=FE3dRenderable_findTexture;
a.pushTexture=FE3dRenderable_pushTexture;a.textures=FE3dRenderable_textures;a.processDelay=RMethod.empty;a.update=FE3dRenderable_update;a.remove=FE3dRenderable_remove;return a},MO.FE3dRenderable_construct=function(){this.__base.FRenderable.construct.call(this);this.__base.MG3dRenderable.construct.call(this);this._outline=new SOutline3d;this._calculateMatrix=new SMatrix3d;this._vertexBuffers=new TDictionary;this._materialReference=this},MO.FE3dRenderable_testVisible=function(){if(!this.testReady()||
!this.__base.FRenderable.testVisible.call(this)||!this._outlineVisible)return!1;var a=this._material;return a&&!a.testVisible()?!1:!0},MO.FE3dRenderable_display=function(){return this._display},MO.FE3dRenderable_setDisplay=function(a){this._display=a},MO.FE3dRenderable_vertexCount=function(){return this._vertexCount},MO.FE3dRenderable_findVertexBuffer=function(a){return this._vertexBuffers.get(a)},MO.FE3dRenderable_vertexBuffers=function(){return this._vertexBuffers},MO.FE3dRenderable_pushVertexBuffer=
function(a){var b=a.code();if(RString.isEmpty(b))throw new TError("Buffer code is empty.");var d=this._vertexBuffers;d||(d=this._vertexBuffers=new TDictionary);d.set(b,a)},MO.FE3dRenderable_materialReference=function(){return this._materialReference},MO.FE3dRenderable_materials=function(){return this._materials},MO.FE3dRenderable_pushMaterial=function(a){var b=this._materials;b||(b=this._materials=new TObjects);b.push(a)},MO.FE3dRenderable_indexBuffer=function(){return this._indexBuffer},MO.FE3dRenderable_indexBuffers=
function(){return this._indexBuffers},MO.FE3dRenderable_bones=function(){return this._bones},MO.FE3dRenderable_findTexture=function(a){return this._textures.get(a)},MO.FE3dRenderable_textures=function(){return this._textures},MO.FE3dRenderable_pushTexture=function(a){var b=this._textures;b||(b=this._textures=new TDictionary);var d=a._name?a._name:a.code();b.set(d,a)},MO.FE3dRenderable_update=function(a){var b=this._calculateMatrix;b.assign(this._matrix);var d=this._drawable;d&&b.append(d.currentMatrix());
(d=this._display)&&b.append(d.currentMatrix());this._currentMatrix.attachData(b.data())&&a&&a.change()},MO.FE3dRenderable_remove=function(){var a=this._display;a&&(a.removeRenderable(this),this._display=null)};
with(MO)MO.FE3dStage=function(a){a=RClass.inherits(this,a,FStage,MGraphicObject);a._statistics=null;a._camera=null;a._directionalLight=null;a._technique=null;a._region=null;a._allDisplays=null;a.onProcess=FE3dStage_onProcess;a.construct=FE3dStage_construct;a.createRegion=FE3dStage_createRegion;a.setup=FE3dStage_setup;a.statistics=FE3dStage_statistics;a.camera=FE3dStage_camera;a.projection=FE3dStage_projection;a.directionalLight=FE3dStage_directionalLight;a.technique=FE3dStage_technique;a.selectTechnique=
FE3dStage_selectTechnique;a.region=FE3dStage_region;a.filterDisplays=FE3dStage_filterDisplays;a.allDisplays=FE3dStage_allDisplays;return a},MO.FE3dStage_onProcess=function(){var a=this._region;if(a){var b=this._technique;if(b){var d=b._graphicContext,f=a._statistics=this._statistics;f.resetFrame();f._frame.begin();f._frameProcess.begin();d.prepare();b.updateRegion(a);a.prepare();a.change();for(var d=this._layers,h=d.count(),k=0;k<h;k++){var q=d.at(k);a.reset();q.process(a);q.filterRenderables(a);
a.update()}RConsole.find(FE3dStageConsole).process(a);f._frameProcess.end();f._frameDraw.begin();if(a.isChanged()){b.clear(a.backgroundColor());for(k=0;k<h;k++){var q=d.at(k),w=q.technique();w||(w=b);a.reset();a.renderables().assign(q.visibleRenderables());w.drawRegion(a)}b.present(a)}f._frameDraw.end();f._frame.end()}}},MO.FE3dStage_construct=function(){this.__base.FStage.construct.call(this);this._statistics=RClass.create(FE3dStageStatistics);RConsole.find(FStatisticsConsole).register("engine.stage",
this._statistics);this._allDisplays=new TObjects;(this._region=this.createRegion())._timer=this._timer},MO.FE3dStage_createRegion=function(){return RClass.create(FE3dRegion)},MO.FE3dStage_setup=function(){this.__base.FStage.construct.call(this);this._region.linkGraphicContext(this);this._region.setup()},MO.FE3dStage_statistics=function(){return this._statistics},MO.FE3dStage_camera=function(){return this._region._camera},MO.FE3dStage_projection=function(){return this._region._camera._projection},
MO.FE3dStage_directionalLight=function(){return this._region._directionalLight},MO.FE3dStage_technique=function(){return this._technique},MO.FE3dStage_selectTechnique=function(a,b){return this._technique=RConsole.find(FG3dTechniqueConsole).find(a,b)},MO.FE3dStage_region=function(){return this._region},MO.FE3dStage_filterDisplays=function(a){for(var b=this._layers,d=b.count(),f=0;f<d;f++)b.value(f).filterDisplays(a)},MO.FE3dStage_allDisplays=function(){var a=this._allDisplays;a.clear();this.filterDisplays(a);
return a};
with(MO)MO.FE3dStageConsole=function(a){a=RClass.inherits(this,a,FConsole);a._scopeCd=EScope.Local;a._looper=null;a._thread=null;a._interval=25;a._limit=8;a.onProcess=FE3dStageConsole_onProcess;a.construct=FE3dStageConsole_construct;a.process=FE3dStageConsole_process;return a},MO.FE3dStageConsole_onProcess=function(){var a=this._looper;a.record();for(var b=this._limit-1;0<=b;b--){var d=a.next();if(d)d.processDelay(d._linkRegion);else break}},MO.FE3dStageConsole_construct=function(){this._looper=new TLooper;
this._renderables=new TDictionary;var a=this._thread=RClass.create(FThread);a.setInterval(this._interval);a.addProcessListener(this,this.onProcess);RConsole.find(FThreadConsole).start(a)},MO.FE3dStageConsole_process=function(a){for(var b=a.allRenderables(),d=b.count()-1;0<=d;d--){var f=b.getAt(d);f._linkStageLooper||(this._looper.push(f),f._linkRegion=a,f._linkStageLooper=this._looper)}};
with(MO)MO.FE3dStageStatistics=function(a){a=RClass.inherits(this,a,FStatistics);a._frame=null;a._frameProcess=null;a._frameDraw=null;a._frameDrawSort=null;a._frameDrawRenderable=null;a.construct=FE3dStageStatistics_construct;a.reset=FE3dStageStatistics_reset;a.resetFrame=FE3dStageStatistics_resetFrame;return a},MO.FE3dStageStatistics_construct=function(){this.__base.FStatistics.construct.call(this);this._frame=new TSpeed;this._frameProcess=new TSpeed;this._frameDraw=new TSpeed;this._frameDrawSort=
new TSpeed;this._frameDrawRenderable=new TSpeed},MO.FE3dStageStatistics_reset=function(){},MO.FE3dStageStatistics_resetFrame=function(){this._frame.reset();this._frameProcess.reset();this._frameDraw.reset();this._frameDrawSort.reset();this._frameDrawRenderable.reset()};with(MO)MO.FE3dTechnique=function(a){return a=RClass.inherits(this,a,FG3dTechnique,MLinkerResource)};
with(MO)MO.RE3dEngine=function(){this._setuped=!1;this.onSetup=RE3dEngine_onSetup;this.setup=RE3dEngine_setup;return this},MO.RE3dEngine_onSetup=function(){var a=RConsole.find(FG3dEffectConsole);a.register("select.select.control",FG3dSelectAutomaticEffect);a.register("select.select.automatic",FG3dSelectAutomaticEffect);a.register("select.select.skeleton",FG3dSelectSkeletonEffect);a.register("select.select.skeleton.4",FG3dSelectSkeletonEffect);a.register("control.control.automatic",FE3dControlAutomaticEffect);
a.register("control.control.control",FE3dControlAutomaticEffect);a.register("general.color.control",FE3dControlAutomaticEffect);a.register("general.color.flat",FE3dGeneralColorFlatEffect);a.register("general.color.automatic",FE3dGeneralColorAutomaticEffect);a.register("general.color.skin",FE3dGeneralColorAutomaticEffect);a.register("general.color.parallax",FE3dGeneralColorAutomaticEffect);a.register("general.color.skeleton",FE3dGeneralColorSkeletonEffect);a.register("general.color.skeleton.4",FE3dGeneralColorSkeletonEffect);
a.register("general.color.fur.skeleton",FE3dGeneralColorSkeletonEffect);a.register("general.color.fur.skeleton.4",FE3dGeneralColorSkeletonEffect);a.register("shadow.depth.automatic",FE3dShadowDepthAutomaticEffect);a.register("shadow.depth.skeleton",FE3dShadowDepthSkeletonEffect);a.register("shadow.color.automatic",FE3dShadowColorAutomaticEffect);a.register("shadow.color.skeleton",FE3dShadowColorSkeletonEffect)},MO.RE3dEngine_setup=function(){this._setuped||(this.onSetup(),this._setuped=!0)},MO.RE3dEngine=
new RE3dEngine;MO.EE3sResource=new function(){this.Unknown="Unknown";this.Bitmap="Bitmap";this.Material="Material";this.Mesh="Mesh";this.Model="Model";this.Template="Template";this.Scene="Scene";this.Project="Project";this.All="All";return this};
with(MO)MO.ME3sGeometry=function(a){a=RClass.inherits(this,a);a._outline=null;a._streams=null;a.construct=ME3sGeometry_construct;a.outline=ME3sGeometry_outline;a.findStream=ME3sGeometry_findStream;a.streams=ME3sGeometry_streams;a.calculateOutline=ME3sGeometry_calculateOutline;a.dispose=ME3sGeometry_dispose;return a},MO.ME3sGeometry_construct=function(){this._outline=new SOutline3d},MO.ME3sGeometry_outline=function(){return this._outline},MO.ME3sGeometry_findStream=function(a){var b=this._streams,
d=b.count();for(n=0;n<d;n++){var f=b.getAt(n);if(f.code()==a)return f}return null},MO.ME3sGeometry_streams=function(){return this._streams},MO.ME3sGeometry_calculateOutline=function(){var a=this._outline;if(a.isEmpty()){a.setMin();for(var b=this.findStream("position"),d=b.dataCount(),b=new Float32Array(b.data()),f=0,h=0;h<d;h++){var k=b[f++],q=b[f++],w=b[f++];a.mergePoint(k,q,w)}a.update()}return a},MO.ME3sGeometry_dispose=function(){this._outline=RObject.dispose(this._outline);this.__base.FE3sSpace.dispose.call(this)};
with(MO)MO.SE3sCompressEvent=function(a,b,d){this.owner=a;this.process=b;this.data=d;return this};
with(MO)MO.SE3sMaterialInfo=function(){SG3dMaterialInfo.call(this);this.unserialize=SE3sMaterialInfo_unserialize;this.saveConfig=SE3sMaterialInfo_saveConfig;return this},MO.SE3sMaterialInfo_unserialize=function(a){this.effectCode=a.readString();this.optionDepth=a.readBoolean();this.optionDouble=a.readBoolean();this.optionNormalInvert=a.readBoolean();this.optionShadow=a.readBoolean();this.optionShadowSelf=a.readBoolean();this.optionAlpha=a.readBoolean();this.alphaBase=a.readFloat();this.alphaRate=
a.readFloat();this.optionColor=a.readBoolean();this.colorMin=a.readFloat();this.colorMax=a.readFloat();this.colorBalance=a.readFloat();this.colorRate=a.readFloat();this.optionVertex=a.readBoolean();this.vertexColor.unserialize(a);this.optionAmbient=a.readBoolean();this.ambientColor.unserialize(a);this.optionDiffuse=a.readBoolean();this.diffuseColor.unserialize(a);this.optionDiffuseView=a.readBoolean();this.diffuseViewColor.unserialize(a);this.optionSpecular=a.readBoolean();this.specularColor.unserialize(a);
this.specularBase=a.readFloat();this.specularLevel=a.readFloat();this.optionSpecularView=a.readBoolean();this.specularViewColor.unserialize(a);this.specularViewBase=a.readFloat();this.specularViewLevel=a.readFloat();this.optionReflect=a.readBoolean();this.reflectColor.unserialize(a);this.reflectMerge=a.readFloat();this.optionRefract=a.readBoolean();this.refractFrontColor.unserialize(a);this.refractBackColor.unserialize(a);this.optionOpacity=a.readBoolean();this.opacityColor.unserialize(a);this.opacityRate=
a.readFloat();this.opacityAlpha=a.readFloat();this.opacityDepth=a.readFloat();this.opacityTransmittance=a.readFloat();this.optionEmissive=a.readBoolean();this.emissiveColor.unserialize(a)},MO.SE3sMaterialInfo_saveConfig=function(a){a.set("effect_code",this.effectCode);a.setBoolean("option_double",this.optionDouble);a.setBoolean("option_alpha",this.optionAlpha);a.setBoolean("option_normal_invert",this.optionNormalInvert);a.setBoolean("option_shadow",this.optionShadow);a.setBoolean("option_shadow_self",
this.optionShadowSelf);var b=a.create("Alpha");b.setBoolean("valid",this.optionAlpha);b.setFloat("base",this.alphaBase);b.setFloat("rate",this.alphaRate);b=a.create("Color");b.setBoolean("valid",this.optionColor);b.setFloat("min",this.colorMin);b.setFloat("max",this.colorMax);b.setFloat("balance",this.colorBalance);b.setFloat("rate",this.colorRate);b=a.create("Vertex");b.setBoolean("valid",this.optionVertex);this.vertexColor.savePower(b);b=a.create("Ambient");b.setBoolean("valid",this.optionAmbient);
this.ambientColor.savePower(b);b=a.create("Diffuse");b.setBoolean("valid",this.optionDiffuse);this.diffuseColor.savePower(b);b=a.create("DiffuseView");b.setBoolean("valid",this.optionDiffuseView);this.diffuseViewColor.savePower(b);b=a.create("Specular");b.setBoolean("valid",this.optionSpecular);this.specularColor.savePower(b);b.setFloat("base",this.specularBase);b.setFloat("level",this.specularLevel);b=a.create("SpecularView");b.setBoolean("valid",this.optionSpecularView);this.specularViewColor.savePower(b);
b.setFloat("base",this.specularViewBase);b.setFloat("level",this.specularViewLevel);b=a.create("Reflect");b.setBoolean("valid",this.optionReflect);this.reflectColor.savePower(b);b.setFloat("merge",this.reflectMerge);b=a.create("Refract");b.setBoolean("valid",this.optionRefract);this.refractFrontColor.savePower(b.create("Front"));this.refractBackColor.savePower(b.create("Back"));b=a.create("Opacity");b.setBoolean("valid",this.optionOpacity);this.opacityColor.savePower(b);b.setFloat("rate",this.opacityRate);
b.setFloat("alpha",this.opacityAlpha);b.setFloat("depth",this.opacityDepth);b.setFloat("transmittance",this.opacityTransmittance);b=a.create("Emissive");b.setBoolean("valid",this.optionEmissive);this.emissiveColor.savePower(b)};with(MO)MO.SE3sSceneShadow=function(){this.range=this.level=this.rate=this.base=null;this.unserialize=SE3sSceneShadow_unserialize;return this},MO.SE3sSceneShadow_unserialize=function(a){this.base=a.readFloat();this.rate=a.readFloat();this.level=a.readFloat();this.range=a.readFloat()};
with(MO)MO.FE3sAnimation=function(a){a=RClass.inherits(this,a,FE3sObject);a._model=null;a._skeletonGuid=null;a._skeleton=null;a._frameCount=0;a._frameTick=0;a._frameSpan=0;a._frameTranslates=null;a._frameRotations=null;a._frameScales=null;a._tracks=null;a.skeletonGuid=FE3sAnimation_skeletonGuid;a.skeleton=FE3sAnimation_skeleton;a.frameCount=FE3sAnimation_frameCount;a.frameTick=FE3sAnimation_frameTick;a.frameSpan=FE3sAnimation_frameSpan;a.tracks=FE3sAnimation_tracks;a.unserialize=FE3sAnimation_unserialize;
return a},MO.FE3sAnimation_skeletonGuid=function(){return this._skeletonGuid},MO.FE3sAnimation_skeleton=function(){var a=this._skeleton;if(!a){var b=this._skeletonGuid;b&&(a=this._skeleton=RConsole.find(FE3sModelConsole).findSkeleton(b))}return a},MO.FE3sAnimation_frameCount=function(){return this._frameCount},MO.FE3sAnimation_frameTick=function(){return this._frameTick},MO.FE3sAnimation_frameSpan=function(){return this._frameSpan},MO.FE3sAnimation_tracks=function(){return this._tracks},MO.FE3sAnimation_unserialize=
function(a){this.__base.FE3sObject.unserialize.call(this,a);this._skeletonGuid=a.readString();this._frameCount=a.readUint16();this._frameTick=a.readUint16();this._frameSpan=a.readUint32();var b=a.readUint32(),d=RInteger.strideByte(b);if(0<b)for(var f=this._frameTranslates=new TObjects,h=0;h<b;h++){var k=new SPoint3;k.unserialize(a);f.push(k)}k=a.readUint32();b=RInteger.strideByte(k);if(0<k)for(var q=this._frameRotations=new TObjects,h=0;h<k;h++){var w=new SQuaternion;w.unserialize(a);q.push(w)}w=
a.readUint32();k=RInteger.strideByte(w);if(0<w)for(var x=this._frameScales=new TObjects,h=0;h<w;h++){var y=new SVector3;y.unserialize(a);x.push(y)}w=null;y=a.readUint16();if(0<y)for(var w=this._tracks=new TObjects,z=0;z<y;z++){var A=RClass.create(FE3sTrack);A.unserialize(a);w.push(A);for(var D=A._frameCount,A=A._frames,h=0;h<D;h++){var B=RClass.create(FE3sFrame),E=0,E=4==d?a.readUint32():2==d?a.readUint16():a.readUint8();B._translation=f.at(E);E=0;E=4==b?a.readUint32():2==b?a.readUint16():a.readUint8();
B._quaternion=q.at(E);E=0;E=4==k?a.readUint32():2==k?a.readUint16():a.readUint8();B._scale=x.at(E);A.push(B)}}if(w&&this._skeletonGuid){a=this.skeleton();for(h=0;h<y;h++)A=w.at(h),d=A.boneIndex(),a.findBone(d).setTrack(A);a.pushAnimation(this)}};
with(MO)MO.FE3sBone=function(a){a=RClass.inherits(this,a,FObject);a._index=null;a._track=null;a._bones=null;a.index=FE3sBone_index;a.track=FE3sBone_track;a.setTrack=FE3sBone_setTrack;a.bones=FE3sBone_bones;a.unserialize=FE3sBone_unserialize;return a},MO.FE3sBone_index=function(){return this._index},MO.FE3sBone_track=function(){return this._track},MO.FE3sBone_setTrack=function(a){this._track=a},MO.FE3sBone_bones=function(){return this._bones},MO.FE3sBone_unserialize=function(a){this._index=a.readUint8();
var b=a.readUint8();if(0<b)for(var d=this._bones=new TObjects,f=0;f<b;f++){var h=RClass.create(FE3sBone);h.unserialize(a);d.push(h)}};
with(MO)MO.FE3sBoneRefer=function(a){a=RClass.inherits(this,a,FObject);a._index=null;a._bone=null;a._track=null;a.index=FE3sBoneRefer_index;a.bone=FE3sBoneRefer_bone;a.setBone=FE3sBoneRefer_setBone;a.track=FE3sBoneRefer_track;a.setTrack=FE3sBoneRefer_setTrack;a.unserialize=FE3sBoneRefer_unserialize;return a},MO.FE3sBoneRefer_index=function(){return this._index},MO.FE3sBoneRefer_bone=function(){return this._bone},MO.FE3sBoneRefer_setBone=function(a){this._bone=a},MO.FE3sBoneRefer_track=function(){return this._track},
MO.FE3sBoneRefer_setTrack=function(a){this._track=a},MO.FE3sBoneRefer_unserialize=function(a){this._index=a.readUint8()};
with(MO)MO.FE3sCamera=function(a){a=RClass.inherits(this,a,FE3sObject);a._typeCd=null;a._position=null;a._direction=null;a._projection=null;a.construct=FE3sCamera_construct;a.typeCd=FE3sCamera_typeCd;a.position=FE3sCamera_position;a.direction=FE3sCamera_direction;a.projection=FE3sCamera_projection;a.unserialize=FE3sCamera_unserialize;a.saveConfig=FE3sCamera_saveConfig;return a},MO.FE3sCamera_construct=function(){this.__base.FE3sObject.construct.call(this);this._position=new SPoint3;this._direction=
new SVector3;this._projection=RClass.create(FE3sProjection)},MO.FE3sCamera_typeCd=function(){return this._typeCd},MO.FE3sCamera_position=function(){return this._position},MO.FE3sCamera_direction=function(){return this._direction},MO.FE3sCamera_projection=function(){return this._projection},MO.FE3sCamera_unserialize=function(a){this.__base.FE3sObject.unserialize.call(this,a);this._typeCd=a.readString();this._position.unserialize(a);this._direction.unserialize(a);this._projection.unserialize(a)},MO.FE3sCamera_saveConfig=
function(a){this.__base.FE3sObject.saveConfig.call(this,a);a.set("position",this._position.toString());a.set("direction",this._direction.toString());this._projection.saveConfig(a.create("Projection"))};with(MO)MO.FE3sComponent=function(a){return a=RClass.inherits(this,a,FE3sObject)};
with(MO)MO.FE3sDisplay=function(a){a=RClass.inherits(this,a,FE3sDrawable);a._outline=null;a._renderables=null;a.construct=FE3sDisplay_construct;a.renderables=FE3sDisplay_renderables;a.calculateOutline=FE3sDisplay_calculateOutline;a.unserialize=FE3sDisplay_unserialize;a.saveConfig=FE3sDisplay_saveConfig;a.clone=FE3sDisplay_clone;return a},MO.FE3sDisplay_construct=function(){this.__base.FE3sDrawable.construct.call(this);this._outline=new SOutline3d},MO.FE3sDisplay_renderables=function(){return this._renderables},
MO.FE3sDisplay_calculateOutline=function(){var a=this._outline;if(a.isEmpty()){var b=this._renderables;if(b){a.setMin();for(var d=b.count(),f=0;f<d;f++){var h=b.getAt(f).calculateOutline();a.mergeMax(h)}a.update()}}return a},MO.FE3sDisplay_unserialize=function(a){this.__base.FE3sDrawable.unserialize.call(this,a);var b=RConsole.find(FE3sResourceConsole),d=a.readUint16();if(0<d)for(var f=this._renderables=new TObjects,h=0;h<d;h++){var k=b.unserialize(a);f.push(k)}},MO.FE3sDisplay_saveConfig=function(a){this.__base.FE3sDrawable.saveConfig.call(this,
a);var b=this._renderables;if(b){a=a.create("RenderableCollection");for(var d=b.count(),f=0;f<d;f++)b.at(f).saveConfig(a.create("Renderable"))}},MO.FE3sDisplay_clone=function(a){a=this.__base.FE3sDrawable.clone.call(this,a);a._outline.assign(this._outline);return a};
with(MO)MO.FE3sDisplayContainer=function(a){a=RClass.inherits(this,a,FE3sDisplay);a._displays=null;a.construct=FE3sDisplayContainer_construct;a.displays=FE3sDisplayContainer_displays;a.pushDisplay=FE3sDisplayContainer_pushDisplay;a.calculateOutline=FE3sDisplayContainer_calculateOutline;a.unserialize=FE3sDisplayContainer_unserialize;a.saveConfig=FE3sDisplayContainer_saveConfig;a.clone=FE3sDisplayContainer_clone;return a},MO.FE3sDisplayContainer_construct=function(){this.__base.FE3sDisplay.construct.call(this)},
MO.FE3sDisplayContainer_displays=function(){return this._displays},MO.FE3sDisplayContainer_pushDisplay=function(a){var b=this._displays;b||(b=this._displays=new TObjects);a.setParent(this);b.push(a)},MO.FE3sDisplayContainer_calculateOutline=function(){var a=this._outline;if(a.isEmpty()){var b=this._renderables;if(b){a.setMin();for(var d=b.count(),f=0;f<d;f++){var h=b.getAt(f).calculateOutline();a.mergeMax(h)}a.update()}}return a},MO.FE3sDisplayContainer_unserialize=function(a){this.__base.FE3sDisplay.unserialize.call(this,
a);var b=a.readUint16();if(0<b){this._displays=new TObjects;for(var d=0;d<b;d++){var f=RClass.create(FE3sSceneDisplay);f.unserialize(a);this.pushDisplay(f)}}},MO.FE3sDisplayContainer_saveConfig=function(a){this.__base.FE3sDisplay.saveConfig.call(this,a);var b=this._displays;if(b){a=a.create("DisplayCollection");for(var d=b.count(),f=0;f<d;f++)b.at(f).saveConfig(a.create("Display"))}},MO.FE3sDisplayContainer_clone=function(a){return this.__base.FE3sDisplay.clone.call(this,a)};
with(MO)MO.FE3sDisplayLayer=function(a){a=RClass.inherits(this,a,FE3sDisplayContainer);a._typeCd=null;a._transformCd=null;a.typeCd=FE3sDisplayLayer_typeCd;a.setTypeCd=FE3sDisplayLayer_setTypeCd;a.transformCd=FE3sDisplayLayer_transformCd;a.setTransformCd=FE3sDisplayLayer_setTransformCd;a.unserialize=FE3sDisplayLayer_unserialize;a.saveConfig=FE3sDisplayLayer_saveConfig;return a},MO.FE3sDisplayLayer_typeCd=function(){return this._typeCd},MO.FE3sDisplayLayer_setTypeCd=function(a){this._typeCd=a},MO.FE3sDisplayLayer_transformCd=
function(){return this._transformCd},MO.FE3sDisplayLayer_setTransformCd=function(a){this._transformCd=a},MO.FE3sDisplayLayer_unserialize=function(a){this.__base.FE3sDisplayContainer.unserialize.call(this,a);this._typeCd=a.readString();this._transformCd=a.readString()},MO.FE3sDisplayLayer_saveConfig=function(a){this.__base.FE3sDisplayContainer.saveConfig.call(this,a);a.set("type_cd",this._typeCd);a.set("transform_cd",this._transformCd)};
with(MO)MO.FE3sDisplayMaterial=function(a){a=RClass.inherits(this,a,FObject);a._groupGuid=null;a._material=null;a.groupGuid=FE3sDisplayMaterial_groupGuid;a.material=FE3sDisplayMaterial_material;a.unserialize=FE3sDisplayMaterial_unserialize;return a},MO.FE3sDisplayMaterial_groupGuid=function(){return this._groupGuid},MO.FE3sDisplayMaterial_material=function(){return this._material},MO.FE3sDisplayMaterial_unserialize=function(a){this._groupGuid=a.readString();this._material=this._template._activeTheme.findMaterial(this._groupGuid)};
with(MO)MO.FE3sDrawable=function(a){a=RClass.inherits(this,a,FE3sComponent);a._matrix=null;a.construct=FE3sDrawable_construct;a.matrix=FE3sDrawable_matrix;a.unserialize=FE3sDrawable_unserialize;a.saveConfig=FE3sDrawable_saveConfig;a.clone=FE3sDrawable_clone;return a},MO.FE3sDrawable_construct=function(){this.__base.FE3sComponent.construct.call(this);this._matrix=new SMatrix3d},MO.FE3sDrawable_matrix=function(){return this._matrix},MO.FE3sDrawable_unserialize=function(a){this.__base.FE3sComponent.unserialize.call(this,
a);this._matrix.unserialize(a)},MO.FE3sDrawable_saveConfig=function(a){this.__base.FE3sComponent.saveConfig.call(this,a);this._matrix.saveConfig(a.create("Matrix"))},MO.FE3sDrawable_clone=function(a){a=this.__base.FE3sComponent.clone.call(this,a);a._matrix.assign(this._matrix);return a};
with(MO)MO.FE3sFrame=function(a){a=RClass.inherits(this,a,FObject);a._translation=null;a._quaternion=null;a._scale=null;a.translation=FE3sFrame_translation;a.quaternion=FE3sFrame_quaternion;a.scale=FE3sFrame_scale;return a},MO.FE3sFrame_tick=function(){return this._tick},MO.FE3sFrame_translation=function(){return this._translation},MO.FE3sFrame_quaternion=function(){return this._quaternion},MO.FE3sFrame_scale=function(){return this._scale};
with(MO)MO.FE3sGeometry=function(a){a=RClass.inherits(this,a,FE3sRenderable,ME3sGeometry);a.construct=FE3sGeometry_construct;a.unserialize=FE3sGeometry_unserialize;a.dispose=FE3sGeometry_dispose;return a},MO.FE3sGeometry_construct=function(){this.__base.FE3sRenderable.construct.call(this);this.__base.ME3sGeometry.construct.call(this)},MO.FE3sGeometry_unserialize=function(a){this.__base.FE3sRenderable.unserialize.call(this,a);var b=this._outline;b.unserialize(a);var d=a.readInt8();if(0<d)for(var f=
this._streams=new TObjects,h=0;h<d;h++){var k=RClass.create(FE3sStream);k.unserialize(a);f.push(k)}b.isEmpty()&&this.calculateOutline();b.update()},MO.FE3sGeometry_dispose=function(){this.__base.ME3sGeometry.dispose.call(this);this.__base.FE3sRenderable.dispose.call(this)};
with(MO)MO.FE3sLight=function(a){a=RClass.inherits(this,a,FE3sObject);a._typeName=null;a._material=null;a._camera=null;a.construct=FE3sLight_construct;a.typeName=FE3sLight_typeName;a.material=FE3sLight_material;a.camera=FE3sLight_camera;a.unserialize=FE3sLight_unserialize;return a},MO.FE3sLight_construct=function(){this.__base.FE3sObject.construct.call(this);this._material=RClass.create(FE3sMaterial);this._camera=RClass.create(FE3sCamera)},MO.FE3sLight_typeName=function(){return this._typeName},MO.FE3sLight_material=
function(){return this._material},MO.FE3sLight_camera=function(){return this._camera},MO.FE3sLight_unserialize=function(a){this.__base.FE3sObject.unserialize.call(this,a);this._typeName=a.readString();this._material.unserialize(a);this._camera.unserialize(a)};
with(MO)MO.FE3sMaterial=function(a){a=RClass.inherits(this,a,FE3sObject);a._parentGuid=null;a._info=null;a._bitmaps=null;a._bitmapPacks=null;a.construct=FE3sMaterial_construct;a.parentGuid=FE3sMaterial_parentGuid;a.effectCode=FE3sMaterial_effectCode;a.info=FE3sMaterial_info;a.bitmaps=FE3sMaterial_bitmaps;a.bitmapPacks=FE3sMaterial_bitmapPacks;a.unserialize=FE3sMaterial_unserialize;a.saveConfig=FE3sMaterial_saveConfig;a.clone=FE3sMaterial_clone;return a},MO.FE3sMaterial_construct=function(){this.__base.FE3sObject.construct.call(this);
this._info=new SE3sMaterialInfo},MO.FE3sMaterial_parentGuid=function(){return this._parentGuid},MO.FE3sMaterial_effectCode=function(){return this._info.effectCode},MO.FE3sMaterial_info=function(){return this._info},MO.FE3sMaterial_bitmaps=function(){return this._bitmaps},MO.FE3sMaterial_bitmapPacks=function(){return this._bitmapPacks},MO.FE3sMaterial_unserialize=function(a){this.__base.FE3sObject.unserialize.call(this,a);this._parentGuid=a.readString();this._info.unserialize(a);var b=a.readInt16();
if(0<b)for(var d=this._bitmapPacks=new TDictionary,f=0;f<b;f++){var h=RClass.create(FE3sMaterialBitmapPack);h.unserialize(a);d.set(h.guid(),h)}b=a.readInt16();if(0<b)for(h=this._bitmaps=new TObjects,f=0;f<b;f++){var k=RClass.create(FE3sMaterialBitmap);k.unserialize(a);h.push(k);var q=d.get(k.bitmapPackGuid());k.setBitmapPack(q)}},MO.FE3sMaterial_saveConfig=function(a){this.__base.FE3sObject.saveConfig.call(this,a);a.set("parent_guid",this._parentGuid);this._info.saveConfig(a)},MO.FE3sMaterial_clone=
function(a){a=this.__base.FE3sObject.clone.call(this,a);a._parentGuid=this._parentGuid;a._info.assign(this._info);return a};
with(MO)MO.FE3sMaterialBitmap=function(a){a=RClass.inherits(this,a,FE3sObject);a._bitmapPackGuid=null;a._bitmapPack=null;a._bitmapGuid=null;a._index=0;a.bitmapPackGuid=FE3sMaterialBitmap_bitmapPackGuid;a.bitmapPack=FE3sMaterialBitmap_bitmapPack;a.setBitmapPack=FE3sMaterialBitmap_setBitmapPack;a.bitmapGuid=FE3sMaterialBitmap_bitmapGuid;a.unserialize=FE3sMaterialBitmap_unserialize;return a},MO.FE3sMaterialBitmap_bitmapPackGuid=function(){return this._bitmapPackGuid},MO.FE3sMaterialBitmap_bitmapPack=
function(){return this._bitmapPack},MO.FE3sMaterialBitmap_setBitmapPack=function(a){this._bitmapPack=a},MO.FE3sMaterialBitmap_bitmapGuid=function(){return this._bitmapGuid},MO.FE3sMaterialBitmap_unserialize=function(a){this.__base.FE3sObject.unserialize.call(this,a);this._bitmapPackGuid=a.readString();this._bitmapGuid=a.readString();this._index=a.readUint16()};
with(MO)MO.FE3sMaterialBitmapPack=function(a){a=RClass.inherits(this,a,FE3sObject);a._typeName=null;a._formatName=null;a._size=null;a.construct=FE3sMaterialBitmapPack_construct;a.typeName=FE3sMaterialBitmapPack_typeName;a.formatName=FE3sMaterialBitmapPack_formatName;a.size=FE3sMaterialBitmapPack_size;a.unserialize=FE3sMaterialBitmapPack_unserialize;a.dispose=FE3sMaterialBitmapPack_dispose;return a},MO.FE3sMaterialBitmapPack_construct=function(){this.__base.FE3sObject.construct.call(this);this._size=
new SSize2},MO.FE3sMaterialBitmapPack_typeName=function(){return this._typeName},MO.FE3sMaterialBitmapPack_formatName=function(){return this._formatName},MO.FE3sMaterialBitmapPack_size=function(){return this._size},MO.FE3sMaterialBitmapPack_unserialize=function(a){this.__base.FE3sObject.unserialize.call(this,a);this._typeName=a.readString();this._formatName=a.readString();this._size.unserialize(a,EDataType.Uint16)},MO.FE3sMaterialBitmapPack_dispose=function(){this._size=RObject.dispose(this._size);
this.__base.FE3sObject.dispose.call(this)};
with(MO)MO.FE3sMaterialConsole=function(a){a=RClass.inherits(this,a,FConsole);a._resources=null;a._materials=null;a.construct=FE3sMaterialConsole_construct;a.find=FE3sMaterialConsole_find;a.unserialize=FE3sMaterialConsole_unserialize;a.loadByGuid=FE3sMaterialConsole_loadByGuid;a.dispose=FE3sMaterialConsole_dispose;return a},MO.FE3sMaterialConsole_construct=function(){this.__base.FConsole.construct.call(this);this._resources=new TDictionary;this._materials=new TDictionary},MO.FE3sMaterialConsole_find=
function(a){return this._materials.get(a)},MO.FE3sMaterialConsole_unserialize=function(a){var b=RClass.create(FE3sMaterial);b.unserialize(a);a=b.guid();if(this._materials.contains(a))throw new TError(this,"Material is already exists.");this._materials.set(a,b);return b},MO.FE3sMaterialConsole_loadByGuid=function(a){var b=this._resources,d=b.get(a);if(d)return d;var f=RConsole.find(FE3sVendorConsole).find("material");f.set("guid",a);var h=f.makeUrl(),d=RClass.create(FE3sMaterialResource);d.setGuid(a);
d.setVendor(f);d.setSourceUrl(h);RConsole.find(FResourceConsole).load(d);b.set(a,d);return d},MO.FE3sMaterialConsole_dispose=function(){this._resources=RObject.free(this._resources);this._materials=RObject.free(this._materials);this.__base.FConsole.dispose.call(this)};with(MO)MO.FE3sMaterialRefer=function(a){return a=RClass.inherits(this,a,FE3sObject)};
with(MO)MO.FE3sMaterialResource=function(a){a=RClass.inherits(this,a,FE3sResource);a._typeName="Material";a._dataCompress=!0;a._material=null;a.material=FE3sMaterialResource_material;a.unserialize=FE3sMaterialResource_unserialize;return a},MO.FE3sMaterialResource_material=function(){return this._material},MO.FE3sMaterialResource_unserialize=function(a){this.__base.FE3sResource.unserialize.call(this,a);this._material=RConsole.find(FE3sMaterialConsole).unserialize(a);RLogger.info(this,"Unserialize material success. (guid={1}, code={2})",
this._guid,this._code)};
with(MO)MO.FE3sMesh=function(a){a=RClass.inherits(this,a,FE3sSpace,ME3sGeometry);a._dataCompress=!0;a._typeName="Mesh";a._display=null;a._renderable=null;a.construct=FE3sMesh_construct;a.unserialize=FE3sMesh_unserialize;a.saveConfig=FE3sMesh_saveConfig;a.dispose=FE3sMesh_dispose;return a},MO.FE3sMesh_construct=function(){this.__base.FE3sSpace.construct.call(this);this.__base.ME3sGeometry.construct.call(this);this._display=RClass.create(FE3sMeshDisplay)},MO.FE3sMesh_unserialize=function(a){this.__base.FE3sSpace.unserialize.call(this,
a);this._outline.unserialize(a);this._outline.update();var b=a.readInt8();if(0<b)for(var d=this._streams=new TObjects,f=0;f<b;f++){var h=RClass.create(FE3sStream);h.unserialize(a);d.push(h)}this._display.unserialize(a);this._renderable=this._display._renderable},MO.FE3sMesh_saveConfig=function(a){this.__base.FE3sSpace.saveConfig.call(this,a);this._display.saveConfig(a.create("Display"))},MO.FE3sMesh_dispose=function(){this._outline=RObject.dispose(this._outline);this._display=RObject.dispose(this._display);
this.__base.ME3sGeometry.dispose.call(this);this.__base.FE3sSpace.dispose.call(this)};
with(MO)MO.FE3sMeshConsole=function(a){a=RClass.inherits(this,a,FConsole);a._venderCode="mesh";a._serviceUrl="/cloud.content.mesh.ws";a._dataUrl="/cloud.content.mesh.wv";a._meshs=null;a.construct=FE3sMeshConsole_construct;a.find=FE3sMeshConsole_find;a.meshs=FE3sMeshConsole_meshs;a.loadByGuid=FE3sMeshConsole_loadByGuid;a.loadByCode=FE3sMeshConsole_loadByCode;a.dispose=FE3sMeshConsole_dispose;return a},MO.FE3sMeshConsole_construct=function(){this.__base.FConsole.construct.call(this);this._meshs=new TDictionary},
MO.FE3sMeshConsole_find=function(a){return this._meshs.get(a)},MO.FE3sMeshConsole_meshs=function(){return this._meshs},MO.FE3sMeshConsole_loadByGuid=function(a){var b=this._meshs,d=b.get(a);if(d)return d;var f=RConsole.find(FE3sVendorConsole).find(this._venderCode);f.set("guid",a);var h=f.makeUrl(),d=RClass.create(FE3sMesh);d.setGuid(a);d.setVendor(f);d.setSourceUrl(h);RConsole.find(FResourceConsole).load(d);b.set(a,d);return d},MO.FE3sMeshConsole_loadByCode=function(a){var b=this._meshs,d=b.get(a);
if(d)return d;var f=RConsole.find(FE3sVendorConsole).find(this._venderCode);f.set("code",a);var h=f.makeUrl(),d=RClass.create(FE3sMesh);d.setGuid(a);d.setVendor(f);d.setSourceUrl(h);RConsole.find(FResourceConsole).load(d);b.set(a,d);return d},MO.FE3sMeshConsole_dispose=function(){this._meshs=RObject.free(this._meshs);this.__base.FConsole.dispose.call(this)};
with(MO)MO.FE3sMeshDisplay=function(a){a=RClass.inherits(this,a,FE3sObject);a._matrix=null;a._material=null;a._renderable=null;a.construct=FE3sMeshDisplay_construct;a.matrix=FE3sMeshDisplay_matrix;a.material=FE3sMeshDisplay_material;a.renderable=FE3sMeshDisplay_renderable;a.unserialize=FE3sMeshDisplay_unserialize;a.saveConfig=FE3sMeshDisplay_saveConfig;return a},MO.FE3sMeshDisplay_construct=function(){this.__base.FE3sObject.construct.call(this);this._matrix=new SMatrix3d;this._material=RClass.create(FE3sMaterial);
this._renderable=RClass.create(FE3sRenderable)},MO.FE3sMeshDisplay_matrix=function(){return this._matrix},MO.FE3sMeshDisplay_material=function(){return this._material},MO.FE3sMeshDisplay_renderable=function(){return this._renderable},MO.FE3sMeshDisplay_unserialize=function(a){this.__base.FE3sObject.unserialize.call(this,a);this._matrix.unserialize(a);this._material.unserialize(a);this._renderable.unserialize(a)},MO.FE3sMeshDisplay_saveConfig=function(a){this.__base.FE3sObject.saveConfig.call(this,
a);this._matrix.saveConfig(a.create("Matrix"));this._material.saveConfig(a.create("Material"));this._renderable.saveConfig(a.create("Renderable"))};
with(MO)MO.FE3sModel=function(a){a=RClass.inherits(this,a,FE3sSpace);a._typeName="Model";a._dataCompress=!0;a._dataBlock=!0;a._meshes=null;a._skeletons=null;a._animations=null;a._display=null;a.construct=FE3sModel_construct;a.findMeshByCode=FE3sModel_findMeshByCode;a.meshes=FE3sModel_meshes;a.skeletons=FE3sModel_skeletons;a.animations=FE3sModel_animations;a.display=FE3sModel_display;a.unserialize=FE3sModel_unserialize;a.saveConfig=FE3sModel_saveConfig;return a},MO.FE3sModel_construct=function(){this.__base.FE3sSpace.construct.call(this);
(this._display=RClass.create(FE3sModelDisplay))._model=this},MO.FE3sModel_findMeshByCode=function(a){for(var b=this._meshes,d=b.count()-1;0<=d;d--){var f=b.getAt(d);if(f._code==a)return f}return null},MO.FE3sModel_meshes=function(){return this._meshes},MO.FE3sModel_skeletons=function(){return this._skeletons},MO.FE3sModel_animations=function(){return this._animations},MO.FE3sModel_display=function(){return this._display},MO.FE3sModel_unserialize=function(a){this.__base.FE3sSpace.unserialize.call(this,
a);var b=RConsole.find(FE3sModelConsole);b.models().set(this.guid(),this);var d=a.readInt16();if(0<d)for(var f=this._meshes=new TDictionary,h=0;h<d;h++){var k=b.unserialMesh(a),q=k.guid();f.set(q,k)}k=a.readInt16();if(0<k)for(q=this._skeletons=new TObjects,h=0;h<k;h++)d=b.unserialSkeleton(a),q.push(d);k=a.readInt16();if(0<k)for(q=this._animations=new TObjects,h=0;h<k;h++)d=b.unserialAnimation(this,a),q.push(d);h=this._display;h.unserialize(a);if(a=h.renderables())for(b=a.count(),h=0;h<b;h++)d=a.get(h),
q=d.meshGuid(),k=f.get(q),d.setMesh(k);RLogger.info(this,"Unserialize model success. (guid={1}, code={2})",this._guid,this._code)},MO.FE3sModel_saveConfig=function(a){this.__base.FE3sSpace.saveConfig.call(this,a);this._display.saveConfig(a.create("Display"))};
with(MO)MO.FE3sModelConsole=function(a){a=RClass.inherits(this,a,FConsole);a._models=null;a._meshs=null;a._skeletons=null;a._animations=null;a.construct=FE3sModelConsole_construct;a.findModel=FE3sModelConsole_findModel;a.models=FE3sModelConsole_models;a.findMesh=FE3sModelConsole_findMesh;a.meshs=FE3sModelConsole_meshs;a.findSkeleton=FE3sModelConsole_findSkeleton;a.skeletons=FE3sModelConsole_skeletons;a.findAnimation=FE3sModelConsole_findAnimation;a.animations=FE3sModelConsole_animations;a.unserialMesh=
FE3sModelConsole_unserialMesh;a.unserialSkeleton=FE3sModelConsole_unserialSkeleton;a.unserialAnimation=FE3sModelConsole_unserialAnimation;a.load=FE3sModelConsole_load;a.dispose=FE3sModelConsole_dispose;return a},MO.FE3sModelConsole_construct=function(){this.__base.FConsole.construct.call(this);this._models=new TDictionary;this._meshs=new TDictionary;this._skeletons=new TDictionary;this._animations=new TDictionary;var a=RConsole.find(FResourceConsole),b=RClass.create(FResourcePipeline),d=RClass.create(FResourceType);
d.setCode("resource3d.model");d._pipeline=b;a.registerType(d)},MO.FE3sModelConsole_findModel=function(a){return this._models.get(a)},MO.FE3sModelConsole_models=function(){return this._models},MO.FE3sModelConsole_findMesh=function(a){return this._meshs.get(a)},MO.FE3sModelConsole_meshs=function(){return this._meshs},MO.FE3sModelConsole_findSkeleton=function(a){return this._skeletons.get(a)},MO.FE3sModelConsole_skeletons=function(){return this._skeletons},MO.FE3sModelConsole_findAnimation=function(a){return this._animations.get(a)},
MO.FE3sModelConsole_animations=function(){return this._animations},MO.FE3sModelConsole_unserialMesh=function(a){var b=RClass.create(FE3sModelMesh);b.unserialize(a);this._meshs.set(b.guid(),b);return b},MO.FE3sModelConsole_unserialSkeleton=function(a){var b=RClass.create(FE3sSkeleton);b.unserialize(a);this._skeletons.set(b.guid(),b);return b},MO.FE3sModelConsole_unserialAnimation=function(a,b){var d=RClass.create(FE3sAnimation);d._model=a;d.unserialize(b);this._animations.set(d.guid(),d);return d},
MO.FE3sModelConsole_load=function(a){var b=this._models,d=b.get(a);if(d)return d;var f=RConsole.find(FE3sVendorConsole).find("model");f.set("guid",a);var h=f.makeUrl(),d=RClass.create(FE3sModel);d.setGuid(a);d.setVendor(f);d.setSourceUrl(h);RConsole.find(FResourceConsole).load(d);b.set(a,d);return d},MO.FE3sModelConsole_dispose=function(){this._materials=RObject.free(this._materials);this.__base.FConsole.dispose.call(this)};
with(MO)MO.FE3sModelDisplay=function(a){a=RClass.inherits(this,a,FE3sDisplay);a._model=null;a._material=null;a.construct=FE3sModelDisplay_construct;a.material=FE3sModelDisplay_material;a.calculateOutline=FE3sModelDisplay_calculateOutline;a.unserialize=FE3sModelDisplay_unserialize;a.saveConfig=FE3sModelDisplay_saveConfig;return a},MO.FE3sModelDisplay_construct=function(){this.__base.FE3sDisplay.construct.call(this);this._material=RClass.create(FE3sMaterial)},MO.FE3sModelDisplay_material=function(){return this._material},
MO.FE3sModelDisplay_calculateOutline=function(){var a=this._outline;if(a.isEmpty()){var b=this._model.meshes();if(b){a.setMin();for(var d=b.count(),f=0;f<d;f++){var h=b.at(f).calculateOutline();a.mergeMax(h)}a.update()}}return a},MO.FE3sModelDisplay_unserialize=function(a){this.__base.FE3sDisplay.unserialize.call(this,a);this._material.unserialize(a)},MO.FE3sModelDisplay_saveConfig=function(a){this.__base.FE3sDisplay.saveConfig.call(this,a);this._material.saveConfig(a.create("Material"))};
with(MO)MO.FE3sModelMesh=function(a){return a=RClass.inherits(this,a,FE3sGeometry)};
with(MO)MO.FE3sModelRenderable=function(a){a=RClass.inherits(this,a,FE3sRenderable);a._meshGuid=null;a._mesh=null;a.construct=FE3sModelRenderable_construct;a.meshGuid=FE3sModelRenderable_meshGuid;a.mesh=FE3sModelRenderable_mesh;a.setMesh=FE3sModelRenderable_setMesh;a.unserialize=FE3sModelRenderable_unserialize;a.saveConfig=FE3sModelRenderable_saveConfig;return a},MO.FE3sModelRenderable_construct=function(){this.__base.FE3sRenderable.construct.call(this)},MO.FE3sModelRenderable_meshGuid=function(){return this._meshGuid},
MO.FE3sModelRenderable_mesh=function(){return this._mesh},MO.FE3sModelRenderable_setMesh=function(a){this._mesh=a},MO.FE3sModelRenderable_unserialize=function(a){this.__base.FE3sRenderable.unserialize.call(this,a);this._meshGuid=a.readString()},MO.FE3sModelRenderable_saveConfig=function(a){this.__base.FE3sRenderable.saveConfig.call(this,a);a.set("mesh_guid",this._meshGuid)};
with(MO)MO.FE3sMovie=function(a){a=RClass.inherits(this,a,FE3sObject);a._interval=null;a._rotation=null;a.construct=FE3sMovie_construct;a.interval=FE3sMovie_interval;a.setInterval=FE3sMovie_setInterval;a.rotation=FE3sMovie_rotation;a.unserialize=FE3sMovie_unserialize;a.saveConfig=FE3sMovie_saveConfig;a.dispose=FE3sMovie_dispose;return a},MO.FE3sMovie_construct=function(){this.__base.FE3sObject.construct.call(this);this._rotation=new SVector3},MO.FE3sMovie_interval=function(){return this._interval},
MO.FE3sMovie_setInterval=function(a){this._interval=a},MO.FE3sMovie_rotation=function(){return this._rotation},MO.FE3sMovie_unserialize=function(a){this.__base.FE3sObject.unserialize.call(this,a);this._interval=a.readInt32();this._rotation.unserialize(a)},MO.FE3sMovie_saveConfig=function(a){this.__base.FE3sObject.saveConfig.call(this,a);a.set("interval",this._interval);a.set("rotation",this._rotation)},MO.FE3sMovie_dispose=function(){this._rotation=RObject.dispose(this._rotation);this.__base.FE3sObject.disposet.call(this)};
with(MO)MO.FE3sObject=function(a){a=RClass.inherits(this,a,FObject,MAttributeParent,MAttributeGuid,MAttributeCode,MAttributeLabel);a._typeName=null;a._isClone=!1;a.makeLabel=FE3sObject_makeLabel;a.unserialize=FE3sObject_unserialize;a.saveConfig=FE3sObject_saveConfig;a.clone=FE3sObject_clone;a.dispose=FE3sObject_dispose;return a},MO.FE3sObject_makeLabel=function(){var a="";RString.isEmpty(this._code)||(a+=this._code);RString.isEmpty(this._label)||(a+=" ["+this._label+"]");return a},MO.FE3sObject_unserialize=
function(a){this._typeName=a.readString();this._guid=a.readString();this._code=a.readString();this._label=a.readString()},MO.FE3sObject_saveConfig=function(a){RString.isEmpty(this._typeName)||a.setName(this._typeName);a.set("guid",this._guid);a.set("code",this._code);a.set("label",this._label);this._isClone&&a.set("is_clone","Y")},MO.FE3sObject_clone=function(a){var b=null,b=a?a:RClass.create(this.constructor);b._isClone=!0;b._typeName=this._typeName;b._guid=this._guid;b._code=this._code;b._label=
this._label;return b},MO.FE3sObject_dispose=function(){this.__base.MAttributeParent.dispose.call(this);this.__base.FComponent.dispose.call(this)};
with(MO)MO.FE3sProjection=function(a){a=RClass.inherits(this,a,FE3sObject);a._angle=null;a._znear=null;a._zfar=null;a.angle=FE3sProjection_angle;a.znear=FE3sProjection_znear;a.zfar=FE3sProjection_zfar;a.unserialize=FE3sProjection_unserialize;a.saveConfig=FE3sProjection_saveConfig;return a},MO.FE3sProjection_angle=function(){return this._angle},MO.FE3sProjection_znear=function(){return this._znear},MO.FE3sProjection_zfar=function(){return this._zfar},MO.FE3sProjection_unserialize=function(a){this.__base.FE3sObject.unserialize.call(this,
a);this._angle=a.readFloat();this._znear=a.readFloat();this._zfar=a.readFloat()},MO.FE3sProjection_saveConfig=function(a){this.__base.FE3sObject.saveConfig.call(this,a);a.setFloat("angle",this._angle);a.setFloat("znear",this._znear);a.setFloat("zfar",this._zfar)};
with(MO)MO.FE3sRegion=function(a){a=RClass.inherits(this,a,FE3sObject);a._optionBackground=!0;a._backgroundColor=null;a._moveSpeed=.1;a._rotationKeySpeed=.005;a._rotationMouseSpeed=.003;a._material=null;a._camera=null;a._light=null;a.construct=FE3sRegion_construct;a.optionBackground=FE3sRegion_optionBackground;a.setOptionBackground=FE3sRegion_setOptionBackground;a.backgroundColor=FE3sRegion_backgroundColor;a.moveSpeed=FE3sRegion_moveSpeed;a.setMoveSpeed=FE3sRegion_setMoveSpeed;a.rotationKeySpeed=
FE3sRegion_rotationKeySpeed;a.setRotationKeySpeed=FE3sRegion_setRotationKeySpeed;a.rotationMouseSpeed=FE3sRegion_rotationMouseSpeed;a.setRotationMouseSpeed=FE3sRegion_setRotationMouseSpeed;a.camera=FE3sRegion_camera;a.light=FE3sRegion_light;a.unserialize=FE3sRegion_unserialize;a.saveConfig=FE3sRegion_saveConfig;return a},MO.FE3sRegion_construct=function(){this.__base.FE3sObject.construct.call(this);this._backgroundColor=new SColor4;this._material=RClass.create(FE3sMaterial);this._camera=RClass.create(FE3sCamera);
this._light=RClass.create(FE3sLight)},MO.FE3sRegion_optionBackground=function(){return this._optionBackground},MO.FE3sRegion_setOptionBackground=function(a){this._optionBackground=a},MO.FE3sRegion_backgroundColor=function(){return this._backgroundColor},MO.FE3sRegion_moveSpeed=function(){return this._moveSpeed},MO.FE3sRegion_setMoveSpeed=function(a){this._moveSpeed=a},MO.FE3sRegion_rotationKeySpeed=function(){return this._rotationKeySpeed},MO.FE3sRegion_setRotationKeySpeed=function(a){this._rotationKeySpeed=
a},MO.FE3sRegion_rotationMouseSpeed=function(){return this._rotationMouseSpeed},MO.FE3sRegion_setRotationMouseSpeed=function(a){this._rotationMouseSpeed=a},MO.FE3sRegion_camera=function(){return this._camera},MO.FE3sRegion_light=function(){return this._light},MO.FE3sRegion_unserialize=function(a){this.__base.FE3sObject.unserialize.call(this,a);this._backgroundColor.unserialize(a);this._moveSpeed=a.readFloat();this._rotationKeySpeed=a.readFloat();this._rotationMouseSpeed=a.readFloat();this._material.unserialize(a);
this._camera.unserialize(a);this._light.unserialize(a)},MO.FE3sRegion_saveConfig=function(a){this.__base.FE3sObject.saveConfig.call(this,a);a.set("color",this._backgroundColor.toString());a.setFloat("move_speed",this._moveSpeed);a.setFloat("rotation_key_speed",this._rotationKeySpeed);a.setFloat("rotation_mouse_speed",this._rotationMouseSpeed);this._camera.saveConfig(a.create("Camera"))};
with(MO)MO.FE3sRenderable=function(a){a=RClass.inherits(this,a,FE3sDrawable);a._materialRefers=null;a.construct=FE3sRenderable_construct;a.materialRefers=FE3sRenderable_materialRefers;a.syncMaterialRefer=FE3sRenderable_syncMaterialRefer;a.pushMaterialRefer=FE3sRenderable_pushMaterialRefer;a.unserialize=FE3sRenderable_unserialize;a.saveConfig=FE3sRenderable_saveConfig;a.clone=FE3sRenderable_clone;return a},MO.FE3sRenderable_construct=function(){this.__base.FE3sDrawable.construct.call(this)},MO.FE3sRenderable_materialRefers=
function(){return this._materialRefers},MO.FE3sRenderable_syncMaterialRefer=function(a){var b=this._materialRefers;b||(b=this._materialRefers=new TObjects);for(var d=b.count();d<=a;d++)b.push(RClass.create(FE3sMaterialRefer));return b.at(a)},MO.FE3sRenderable_pushMaterialRefer=function(a){var b=this._materialRefers;b||(b=this._materialRefers=new TObjects);b.push(a)},MO.FE3sRenderable_unserialize=function(a){this.__base.FE3sDrawable.unserialize.call(this,a);var b=a.readUint16();if(0<b)for(var d=0;d<
b;d++){var f=RClass.create(FE3sMaterialRefer);f.unserialize(a);this.pushMaterialRefer(f)}},MO.FE3sRenderable_saveConfig=function(a){this.__base.FE3sDrawable.saveConfig.call(this,a);var b=this._materialRefers;if(b){var d=b.count();a=a.create("MaterialReferCollection");for(var f=0;f<d;f++)b.at(f).saveConfig(a.create("MaterialRefer"))}},MO.FE3sRenderable_clone=function(a){a=this.__base.FE3sDrawable.clone.call(this,a);var b=this._materialRefers;if(b)for(var d=b.count(),f=0;f<d;f++){var h=b.at(f);a.pushMaterialRefer(h.clone())}return a};
with(MO)MO.FE3sResource=function(a){a=RClass.inherits(this,a,FResource,MListenerLoad);a._dataLoad=!1;a._dataReady=!1;a._dataSize=0;a._blockSize=0;a._blockCount=0;a._vendor=null;a.onComplete=FE3sResource_onComplete;a.makeLabel=FE3sResource_makeLabel;a.vendor=FE3sResource_vendor;a.setVendor=FE3sResource_setVendor;a.testReady=FE3sResource_testReady;a.unserialize=FE3sResource_unserialize;a.saveConfig=FE3sResource_saveConfig;a.dispose=FE3sResource_dispose;return a},MO.FE3sResource_onComplete=function(a){if(RClass.isClass(a,
MDataStream))this.unserialize(a);else{var b=RClass.create(FDataView);b.setEndianCd(!0);a.constructor==Array?(a=new Uint8Array(a),b.link(a.buffer)):a.constructor==Uint8Array?b.link(a.buffer):b.link(a.outputData());this.unserialize(b);b.dispose()}this._dataReady=!0;this.processLoadListener()},MO.FE3sResource_makeLabel=function(){var a="";RString.isEmpty(this._code)||(a+=this._code);RString.isEmpty(this._label)||(a+=" ["+this._label+"]");return a},MO.FE3sResource_vendor=function(){return this._vendor},
MO.FE3sResource_setVendor=function(a){this._vendor=a},MO.FE3sResource_testReady=function(){return this._dataReady},MO.FE3sResource_unserialize=function(a){this._typeName=a.readString();this._guid=a.readString();this._code=a.readString();this._label=a.readString()},MO.FE3sResource_saveConfig=function(a){RString.isEmpty(this._typeName)||a.setName(this._typeName);a.set("guid",this._guid);a.set("code",this._code);a.set("label",this._label)},MO.FE3sResource_dispose=function(){this._vendor=null;this.__base.MListenerLoad.dispose.call(this);
this.__base.FConsole.dispose.call(this)};
with(MO)MO.FE3sResourceConsole=function(a){a=RClass.inherits(this,a,FConsole);a._factory=null;a.construct=FE3sResourceConsole_construct;a.factory=FE3sResourceConsole_factory;a.create=FE3sResourceConsole_create;a.unserializeResource=FE3sResourceConsole_unserializeResource;a.unserialize=FE3sResourceConsole_unserialize;return a},MO.FE3sResourceConsole_construct=function(){this.__base.FConsole.construct.call(this);var a=this._factory=RClass.create(FClassFactory);a.register("Shape",FE3sShape);a.register("Sprite",
FE3sSprite);a.register("ModelMesh",FE3sModelMesh);a.register("ModelRenderable",FE3sModelRenderable)},MO.FE3sResourceConsole_factory=function(){return this._factory},MO.FE3sResourceConsole_create=function(a){return this._factory.create(a)},MO.FE3sResourceConsole_unserializeResource=function(a,b){a.unserialize(b)},MO.FE3sResourceConsole_unserialize=function(a){var b=a.testString(),b=this._factory.create(b);b.unserialize(a);return b};
with(MO)MO.FE3sScene=function(a){a=RClass.inherits(this,a,FE3sSpace);a._typeName="Scene";a._dataCompress=!0;a._templates=null;a.construct=FE3sScene_construct;a.unserialize=FE3sScene_unserialize;a.saveConfig=FE3sScene_saveConfig;return a},MO.FE3sScene_construct=function(){this.__base.FE3sSpace.construct.call(this)},MO.FE3sScene_unserialize=function(a){this.__base.FE3sSpace.unserialize.call(this,a);a=a.readInt16();if(0<a)for(var b=RConsole.find(FE3sTemplateConsole),d=this._templates=new TDictionary,
f=0;f<a;f++){var h=b.unserialize(p);d.set(ttemplate.guid(),h)}},MO.FE3sScene_saveConfig=function(a){this.__base.FE3sSpace.saveConfig.call(this,a)};
with(MO)MO.FE3sSceneAnimation=function(a){a=RClass.inherits(this,a,FE3sObject);a._playRate=1;a.construct=FE3sSceneAnimation_construct;a.playRate=FE3sSceneAnimation_playRate;a.setPlayRate=FE3sSceneAnimation_setPlayRate;a.unserialize=FE3sSceneAnimation_unserialize;a.saveConfig=FE3sSceneAnimation_saveConfig;return a},MO.FE3sSceneAnimation_construct=function(){this.__base.FE3sObject.construct.call(this)},MO.FE3sSceneAnimation_playRate=function(){return this._playRate},MO.FE3sSceneAnimation_setPlayRate=
function(a){this._playRate=a},MO.FE3sSceneAnimation_unserialize=function(a){this.__base.FE3sObject.unserialize.call(this,a);this._playRate=a.readFloat()},MO.FE3sSceneAnimation_saveConfig=function(a){this.__base.FE3sObject.saveConfig.call(this,a);a.set("play_rate",this._playRate)};
with(MO)MO.FE3sSceneConsole=function(a){a=RClass.inherits(this,a,FConsole);a._vendorCode="scene";a._dataUrl="/cloud.content.scene.wv";a._scenes=null;a.construct=FE3sSceneConsole_construct;a.loadByGuid=FE3sSceneConsole_loadByGuid;a.loadByCode=FE3sSceneConsole_loadByCode;return a},MO.FE3sSceneConsole_construct=function(){this.__base.FConsole.construct.call(this);this._scenes=new TDictionary},MO.FE3sSceneConsole_loadByGuid=function(a){var b=this._scenes,d=b.get(a);if(d)return d;var f=RConsole.find(FE3sVendorConsole).find(this._vendorCode);
f.set("guid",a);var h=f.makeUrl(),d=RClass.create(FE3sScene);d.setGuid(a);d.setVendor(f);d.setSourceUrl(h);RConsole.find(FResourceConsole).load(d);b.set(a,d);return d},MO.FE3sSceneConsole_loadByCode=function(a){var b=this._scenes,d=b.get(a);if(d)return d;var f=RConsole.find(FE3sVendorConsole).find(this._vendorCode);f.set("code",a);var h=f.makeUrl(),d=RClass.create(FE3sScene);d.setCode(a);d.setVendor(f);d.setSourceUrl(h);RConsole.find(FResourceConsole).load(d);b.set(a,d);return d};
with(MO)MO.FE3sSceneDisplay=function(a){a=RClass.inherits(this,a,FE3sSprite);a._templateGuid=null;a._animations=null;a._movies=null;a._renderables=null;a.construct=FE3sSceneDisplay_construct;a.templateGuid=FE3sSceneDisplay_templateGuid;a.findAnimation=FE3sSceneDisplay_findAnimation;a.syncAnimation=FE3sSceneDisplay_syncAnimation;a.animations=FE3sSceneDisplay_animations;a.movies=FE3sSceneDisplay_movies;a.renderables=FE3sSceneDisplay_renderables;a.unserialize=FE3sSceneDisplay_unserialize;a.saveConfig=
FE3sSceneDisplay_saveConfig;a.clone=FE3sSceneDisplay_clone;return a},MO.FE3sSceneDisplay_construct=function(){this.__base.FE3sSprite.construct.call(this)},MO.FE3sSceneDisplay_templateGuid=function(){return this._templateGuid},MO.FE3sSceneDisplay_findAnimation=function(a){var b=this._animations;return b?b.get(a):null},MO.FE3sSceneDisplay_syncAnimation=function(a){var b=this._animations;b||(b=this._animations=new TDictionary);var d=b.get(a);d||(d=RClass.create(FE3sSceneAnimation),d._guid=a,b.set(a,
d));return d},MO.FE3sSceneDisplay_animations=function(){return this._animations},MO.FE3sSceneDisplay_movies=function(){return this._movies},MO.FE3sSceneDisplay_renderables=function(){return this._renderables},MO.FE3sSceneDisplay_unserialize=function(a){this.__base.FE3sSprite.unserialize.call(this,a);this._templateGuid=a.readString();var b=a.readUint16();if(0<b)for(var d=this._animations=new TDictionary,f=0;f<b;f++){var h=RClass.create(FE3sSceneAnimation);h.unserialize(a);d.set(h.guid(),h)}b=a.readUint16();
if(0<b)for(d=this._movies=new TObjects,f=0;f<b;f++)h=RClass.create(FE3sMovie),h.unserialize(a),d.push(h)},MO.FE3sSceneDisplay_saveConfig=function(a){this.__base.FE3sSprite.saveConfig.call(this,a);a.set("template_guid",this._templateGuid);var b=this._animations;if(b){var d=b.count();a=a.create("AnimationCollection");for(var f=0;f<d;f++)b.at(f).saveConfig(a.create("Animation"))}},MO.FE3sSceneDisplay_clone=function(a){a=this.__base.FE3sSprite.clone.call(this,a);a._templateGuid=this._templateGuid;return a};
with(MO)MO.FE3sSceneLayer=function(a){return a=RClass.inherits(this,a,FE3sDisplayLayer)};with(MO)MO.FE3sSceneRenderable=function(a){a=RClass.inherits(this,a,FE3sObject);a.unserialize=FE3sSceneRenderable_unserialize;return a},MO.FE3sSceneRenderable_unserialize=function(a){this.__base.FE3sObject.unserialize.call(this,a)};
with(MO)MO.FE3sShape=function(a){a=RClass.inherits(this,a,FE3sRenderable);a._modelGuid=null;a._model=null;a._meshGuid=null;a._mesh=null;a._materialGuid=null;a._material=null;a.construct=FE3sShape_construct;a.modelGuid=FE3sShape_modelGuid;a.model=FE3sShape_model;a.meshGuid=FE3sShape_meshGuid;a.mesh=FE3sShape_mesh;a.materialGuid=FE3sShape_materialGuid;a.material=FE3sShape_material;a.unserialize=FE3sShape_unserialize;return a},MO.FE3sShape_construct=function(){this.__base.FE3sRenderable.construct.call(this)},
MO.FE3sShape_modelGuid=function(){return this._modelGuid},MO.FE3sShape_model=function(){var a=this._model;a||(a=this._model=RConsole.find(FE3sModelConsole).findModel(this._modelGuid));return a},MO.FE3sShape_meshGuid=function(){return this._meshGuid},MO.FE3sShape_mesh=function(){var a=this._mesh;a||(a=this._mesh=RConsole.find(FE3sModelConsole).findMesh(this._meshGuid));return a},MO.FE3sShape_materialGuid=function(){return this._materialGuid},MO.FE3sShape_material=function(){var a=this._material;a||
(a=this._material=RConsole.find(FE3sMaterialConsole).find(this._materialGuid));return a},MO.FE3sShape_unserialize=function(a){this.__base.FE3sRenderable.unserialize.call(this,a);this._modelGuid=a.readString();this._meshGuid=a.readString();this._materialGuid=a.readString()};
with(MO)MO.FE3sSkeleton=function(a){a=RClass.inherits(this,a,FE3sObject);a._bones=null;a._roots=null;a._skins=null;a._animations=null;a.findBone=FE3sSkeleton_findBone;a.bones=FE3sSkeleton_bones;a.roots=FE3sSkeleton_roots;a.skins=FE3sSkeleton_skins;a.animations=FE3sSkeleton_animations;a.pushAnimation=FE3sSkeleton_pushAnimation;a.innerFilter=FE3sSkeleton_innerFilter;a.unserialize=FE3sSkeleton_unserialize;return a},MO.FE3sSkeleton_findBone=function(a){return this._bones.get(a)},MO.FE3sSkeleton_bones=
function(){return this._bones},MO.FE3sSkeleton_roots=function(){return this._roots},MO.FE3sSkeleton_skins=function(){return this._skins},MO.FE3sSkeleton_animations=function(){return this._animations},MO.FE3sSkeleton_pushAnimation=function(a){var b=this._animations;b||(b=this._animations=new TObjects);b.push(a)},MO.FE3sSkeleton_innerFilter=function(a){this._bones.set(a.index(),a);if(a=a.bones())for(var b=a.count(),d=0;d<b;d++){var f=a.get(d);this.innerFilter(f)}},MO.FE3sSkeleton_unserialize=function(a){this.__base.FE3sObject.unserialize.call(this,
a);var b=a.readUint8();if(0<b){this._bones=new TDictionary;for(var d=this._roots=new TObjects,f=0;f<b;f++){var h=RClass.create(FE3sBone);h.unserialize(a);this.innerFilter(h);d.push(h)}}b=a.readUint8();if(0<b)for(d=this._skins=new TObjects,f=0;f<b;f++)h=RClass.create(FE3sSkeletonSkin),h.unserialize(a),d.push(h)};
with(MO)MO.FE3sSkeletonSkin=function(a){a=RClass.inherits(this,a,FE3sObject);a._meshGuid=null;a._streams=null;a._boneRefers=null;a.meshGuid=FE3sSkeletonSkin_meshGuid;a.find=FE3sSkeletonSkin_find;a.streams=FE3sSkeletonSkin_streams;a.boneRefers=FE3sSkeletonSkin_boneRefers;a.unserialize=FE3sSkeletonSkin_unserialize;return a},MO.FE3sSkeletonSkin_meshGuid=function(){return this._meshGuid},MO.FE3sSkeletonSkin_find=function(a){return this._streams.get(a)},MO.FE3sSkeletonSkin_streams=function(){return this._streams},
MO.FE3sSkeletonSkin_boneRefers=function(){return this._boneRefers},MO.FE3sSkeletonSkin_unserialize=function(a){this.__base.FE3sObject.unserialize.call(this,a);this._meshGuid=a.readString();var b=a.readUint8();if(0<b)for(var d=this._streams=new TObjects,f=0;f<b;f++){var h=RClass.create(FE3sStream);h.unserialize(a);d.push(h)}b=a.readUint8();if(0<b)for(d=this._boneRefers=new TObjects,f=0;f<b;f++)h=RClass.create(FE3sBoneRefer),h.unserialize(a),d.push(h)};
with(MO)MO.FE3sSpace=function(a){a=RClass.inherits(this,a,FE3sResource);a._typeName=null;a._technique=null;a._region=null;a._materials=null;a._displays=null;a._layers=null;a.construct=FE3sSpace_construct;a.technique=FE3sSpace_technique;a.region=FE3sSpace_region;a.materials=FE3sSpace_materials;a.displays=FE3sSpace_displays;a.layers=FE3sSpace_layers;a.unserialize=FE3sSpace_unserialize;a.saveConfig=FE3sSpace_saveConfig;return a},MO.FE3sSpace_construct=function(){this.__base.FE3sResource.construct.call(this);
this._technique=RClass.create(FE3sTechnique);this._region=RClass.create(FE3sRegion)},MO.FE3sSpace_technique=function(){return this._technique},MO.FE3sSpace_region=function(){return this._region},MO.FE3sSpace_materials=function(){return this._materials},MO.FE3sSpace_displays=function(){return this._displays},MO.FE3sSpace_layers=function(){return this._layers},MO.FE3sSpace_unserialize=function(a){this.__base.FE3sResource.unserialize.call(this,a);var b=RConsole.find(FE3sResourceConsole),d=RConsole.find(FE3sMaterialConsole);
this._technique.unserialize(a);this._region.unserialize(a);var f=a.readInt16();if(0<f)for(var h=this._materials=new TDictionary,k=0;k<f;k++){var q=d.unserialize(a);h.set(q.guid(),q)}d=a.readInt16();if(0<d)for(f=this._displays=new TObjects,k=0;k<d;k++)h=b.unserialize(a),f.push(h);b=a.readInt16();if(0<b)for(d=this._layers=new TDictionary,k=0;k<b;k++)f=RClass.create(FE3sDisplayLayer),f.unserialize(a),d.set(f.code(),f)},MO.FE3sSpace_saveConfig=function(a){this.__base.FE3sResource.saveConfig.call(this,
a);this._technique.saveConfig(a.create("Technique"));this._region.saveConfig(a.create("Region"));var b=this._materials;if(b)for(var d=a.create("MaterialCollection"),f=b.count(),h=0;h<f;h++)b.at(h).saveConfig(d.create("Material"));if(b=this._displays)for(d=a.create("DisplayCollection"),f=b.count(),h=0;h<f;h++)b.at(h).saveConfig(d.create("Display"));if(b=this._layers)for(a=a.create("LayerCollection"),d=b.count(),h=0;h<d;h++)b.valueAt(h).saveConfig(a.create("Layer"))};
with(MO)MO.FE3sSprite=function(a){a=RClass.inherits(this,a,FE3sDisplayContainer);a._materials=null;a.construct=FE3sSprite_construct;a.materials=FE3sSprite_materials;a.pushMaterial=FE3sSprite_pushMaterial;a.unserialize=FE3sSprite_unserialize;a.saveConfig=FE3sSprite_saveConfig;a.clone=FE3sSprite_clone;return a},MO.FE3sSprite_construct=function(){this.__base.FE3sDisplayContainer.construct.call(this)},MO.FE3sSprite_materials=function(){return this._materials},MO.FE3sSprite_pushMaterial=function(a){var b=
this._materials;b||(b=this._materials=new TDictionary);b.set(a.guid(),a)},MO.FE3sSprite_unserialize=function(a){this.__base.FE3sDisplayContainer.unserialize.call(this,a);var b=a.readUint16();if(0<b)for(var d=RConsole.find(FE3sMaterialConsole),f=0;f<b;f++){var h=d.unserialize(a);this.pushMaterial(h)}},MO.FE3sSprite_saveConfig=function(a){this.__base.FE3sDisplayContainer.saveConfig.call(this,a);var b=this._materials;if(b)for(var d=b.count(),f=a.create("MaterialCollection"),h=0;h<d;h++)b.at(h).saveConfig(f.create("Material"));
if(b=this._movies)for(d=b.count(),a=a.create("MovieCollection"),h=0;h<d;h++)b.at(h).saveConfig(a.create("Movie"))},MO.FE3sSprite_clone=function(a){a=this.__base.FE3sDisplayContainer.clone.call(this,a);var b=this._materials;if(b)for(var d=b.count(),f=0;f<d;f++){var h=b.at(f);a.pushMaterial(h.clone())}return a};
with(MO)MO.FE3sStream=function(a){a=RClass.inherits(this,a,FObject,MAttributeCode);a._elementDataCd=0;a._elementCount=0;a._elementNormalize=!1;a._dataStride=0;a._dataCount=0;a._dataLength=0;a._data=null;a._formatCd=EG3dAttributeFormat.Unknown;a.elementDataCd=FE3sStream_elementDataCd;a.formatCd=FE3sStream_formatCd;a.dataStride=FE3sStream_dataStride;a.dataCount=FE3sStream_dataCount;a.data=FE3sStream_data;a.unserialize=FE3sStream_unserialize;a.dispose=FE3sStream_dispose;return a},MO.FE3sStream_elementDataCd=
function(){return this._elementDataCd},MO.FE3sStream_formatCd=function(){return this._formatCd},MO.FE3sStream_dataStride=function(){return this._dataStride},MO.FE3sStream_dataCount=function(){return this._dataCount},MO.FE3sStream_data=function(){return this._data},MO.FE3sStream_unserialize=function(a){this._code=a.readString();this._elementDataCd=a.readUint8();this._elementCount=a.readUint8();this._elementNormalize=a.readBoolean();var b=this._dataStride=a.readUint8(),d=this._dataCount=a.readInt32(),
b=this._dataLength=b*d,d=this._data=new ArrayBuffer(b);a.readBytes(d,0,b)},MO.FE3sStream_dispose=function(){this.data=null;this.__base.FObject.dispose.call(this)};
with(MO)MO.FE3sTechnique=function(a){a=RClass.inherits(this,a,FE3sObject);a._techniqueCode=null;a._passes=null;a.passes=FE3sTechnique_passes;a.unserialize=FE3sTechnique_unserialize;a.saveConfig=FE3sTechnique_saveConfig;return a},MO.FE3sTechnique_passes=function(){return this._passes},MO.FE3sTechnique_unserialize=function(a){this.__base.FE3sObject.unserialize.call(this,a);var b=a.readInt16();if(0<b)for(var d=this._passes=new TObjects,f=0;f<b;f++){var h=RClass.create(FE3sTechniquePass);h.unserialize(a);
d.push(h)}},MO.FE3sTechnique_saveConfig=function(a){this.__base.FE3sObject.saveConfig.call(this,a);a.set("technique_code",this._techniqueCode)};
with(MO)MO.FE3sTechniquePass=function(a){a=RClass.inherits(this,a,FE3sObject);a._targetWidth=null;a._targetHeight=null;a.targetWidth=FE3sTechniquePass_targetWidth;a.targetHeight=FE3sTechniquePass_targetHeight;a.unserialize=FE3sTechniquePass_unserialize;return a},MO.FE3sTechniquePass_targetWidth=function(){return this._targetWidth},MO.FE3sTechniquePass_targetHeight=function(){return this._targetHeight},MO.FE3sTechniquePass_unserialize=function(a){this.__base.FE3sObject.unserialize.call(this,a);this._targetWidth=
a.readUint16();this._targetHeight=a.readUint16()};with(MO)MO.FE3sTemplate=function(a){a=RClass.inherits(this,a,FE3sSpace);a._typeName="Template";a._dataCompress=!0;return a};
with(MO)MO.FE3sTemplateConsole=function(a){a=RClass.inherits(this,a,FConsole);a._templates=null;a._serviceUrl="/cloud.content.template.ws";a.construct=FE3sTemplateConsole_construct;a.unserialize=FE3sTemplateConsole_unserialize;a.loadByGuid=FE3sTemplateConsole_loadByGuid;a.loadByCode=FE3sTemplateConsole_loadByCode;a.update=FE3sTemplateConsole_update;return a},MO.FE3sTemplateConsole_construct=function(){this.__base.FConsole.construct.call(this);this._templates=new TDictionary},MO.FE3sTemplateConsole_unserialize=
function(a){var b=RClass.create(FE3sTemplate);b._dataReady=!0;b.unserialize(a);this._templates.set(b.guid(),b);return b},MO.FE3sTemplateConsole_loadByGuid=function(a){var b=this._templates,d=b.get(a);if(d)return d;var f=RConsole.find(FE3sVendorConsole).find("template");f.set("guid",a);var h=f.makeUrl(),d=RClass.create(FE3sTemplate);d.setGuid(a);d.setVendor(f);d.setSourceUrl(h);RConsole.find(FResourceConsole).load(d);b.set(a,d);return d},MO.FE3sTemplateConsole_loadByCode=function(a){var b=this._templates,
d=b.get(a);if(d)return d;var f=RConsole.find(FE3sVendorConsole).find("template");f.set("code",a);var h=f.makeUrl(),d=RClass.create(FE3sTemplate);d.setCode(a);d.setVendor(f);d.setSourceUrl(h);RConsole.find(FResourceConsole).load(d);b.set(a,d);return d},MO.FE3sTemplateConsole_update=function(a){var b=RBrowser.hostPath(this._serviceUrl+"?action=update");RConsole.find(FXmlConsole).send(b,a)};
with(MO)MO.FE3sTemplateTheme=function(a){a=RClass.inherits(this,a,FE3sObject);a._materials=null;a.findMaterial=FE3sTemplateTheme_findMaterial;a.materials=FE3sTemplateTheme_materials;a.unserialize=FE3sTemplateTheme_unserialize;return a},MO.FE3sTemplateTheme_findMaterial=function(a){return this._materials.get(a)},MO.FE3sTemplateTheme_materials=function(){return this._materials},MO.FE3sTemplateTheme_unserialize=function(a){this.__base.FE3sObject.unserialize.call(this,a);var b=a.readUint16();if(0<b)for(var d=
RConsole.find(FE3sMaterialConsole),f=this._materials=new TDictionary,h=0;h<b;h++){var k=d.unserialize(a);f.set(k.groupGuid(),k)}};
with(MO)MO.FE3sTexture=function(a){a=RClass.inherits(this,a,FE3sResource);a._dataCompress=!0;a._bitmaps=null;a._bitmapPacks=null;a.construct=FE3sTexture_construct;a.bitmaps=FE3sTexture_bitmaps;a.bitmapPacks=FE3sTexture_bitmapPacks;a.unserialize=FE3sTexture_unserialize;a.dispose=FE3sTexture_dispose;return a},MO.FE3sTexture_construct=function(){this.__base.FE3sResource.construct.call(this)},MO.FE3sTexture_bitmaps=function(){return this._bitmaps},MO.FE3sTexture_bitmapPacks=function(){return this._bitmapPacks},
MO.FE3sTexture_unserialize=function(a){this.__base.FE3sResource.unserialize.call(this,a);var b=a.readInt16();if(0<b)for(var d=this._bitmaps=new TDictionary,f=0;f<b;f++){var h=RClass.create(FE3sTextureBitmap);h.unserialize(a);d.set(h.code(),h)}b=a.readInt16();if(0<b)for(d=this._bitmapPacks=new TDictionary,f=0;f<b;f++)h=RClass.create(FE3sTextureBitmapPack),h._texture=this,h.unserialize(a),d.set(h.code(),h)},MO.FE3sTexture_dispose=function(){this._bitmaps=RObject.free(this._bitmaps);this._bitmapPacks=
RObject.free(this._bitmapPacks);this.__base.FE3sResource.dispose.call(this)};with(MO)MO.FE3sTextureBitmap=function(a){a=RClass.inherits(this,a,FE3sObject);a._packCode=null;a.packCode=FE3sTextureBitmap_packCode;a.unserialize=FE3sTextureBitmap_unserialize;return a},MO.FE3sTextureBitmap_packCode=function(){return this._packCode},MO.FE3sTextureBitmap_unserialize=function(a){this.__base.FE3sObject.unserialize.call(this,a);this._packCode=a.readString()};
with(MO)MO.FE3sTextureBitmapPack=function(a){a=RClass.inherits(this,a,FE3sObject);a._optionCompress=null;a._size=null;a._data=null;a._typeName=null;a._formatName=null;a.construct=FE3sTextureBitmapPack_construct;a.optionCompress=FE3sTextureBitmapPack_optionCompress;a.size=FE3sTextureBitmapPack_size;a.data=FE3sTextureBitmapPack_data;a.unserialize=FE3sTextureBitmapPack_unserialize;a.dispose=FE3sTextureBitmapPack_dispose;return a},MO.FE3sTextureBitmapPack_construct=function(){this.__base.FE3sObject.construct.call(this);
this._size=new SSize2},MO.FE3sTextureBitmapPack_optionCompress=function(){return this._optionCompress},MO.FE3sTextureBitmapPack_size=function(){return this._size},MO.FE3sTextureBitmapPack_data=function(){return this._data},MO.FE3sTextureBitmapPack_unserialize=function(a){this.__base.FE3sObject.unserialize.call(this,a);this._typeName=a.readString();this._formatName=a.readString();this._size.width=a.readUint16();this._size.height=a.readUint16();if("flat"==this._typeName)var b=a.readInt32();else if("cube"==
this._typeName){this._data=[];for(var d=0;6>d;d++){var b=a.readInt32(),f=this._data[d]=new ArrayBuffer(b);a.readBytes(f,0,b)}}else throw new TError(this,"Unserial texture failure ");},MO.FE3sTextureBitmapPack_dispose=function(){this._data=null;this.__base.FE3sObject.dispose.call(this)};
with(MO)MO.FE3sTextureConsole=function(a){a=RClass.inherits(this,a,FConsole);a._textures=null;a.construct=FE3sTextureConsole_construct;a.unserialize=FE3sTextureConsole_unserialize;a.load=FE3sTextureConsole_load;a.loadBitmap=FE3sTextureConsole_loadBitmap;a.dispose=FE3sModelConsole_dispose;return a},MO.FE3sTextureConsole_construct=function(){this.__base.FConsole.construct.call(this);this._textures=new TDictionary},MO.FE3sTextureConsole_unserialize=function(a){var b=RClass.create(FE3sTexture);b._dataReady=
!0;b.unserialize(a);this._textures.set(b.guid(),b);return b},MO.FE3sTextureConsole_load=function(a){var b=this._textures,d=b.get(a);if(d)return d;var f=RConsole.find(FE3sVendorConsole).find("texture"),h=f.makeUrl(a),d=RClass.create(FE3sTexture);d.setGuid(a);d.setVendor(f);d.setSourceUrl(h);RConsole.find(FResourceConsole).load(d);b.set(a,d);return d},MO.FE3sTextureConsole_loadBitmap=function(a,b,d){var f=RConsole.find(FE3sVendorConsole).find("texture.bitmap");f.set("guid",a);f.set("code",b);f.set("format",
d);a=f.makeUrl();b=this._image=RClass.create(FImage);b.loadUrl(a);return b},MO.FE3sTextureConsole_dispose=function(){this._textures=RObject.free(this._textures);this.__base.FConsole.dispose.call(this)};
with(MO)MO.FE3sTheme=function(a){a=RClass.inherits(this,a,FE3sResource);a._materials=null;a.materials=FE3sTheme_materials;a.find=FE3sTheme_find;a.unserialize=FE3sTheme_unserialize;return a},MO.FE3sTheme_materials=function(){return this._materials},MO.FE3sTheme_find=function(a){var b=this._materials;return b?b.get(a):null},MO.FE3sTheme_unserialize=function(a){var b=a.readInt32();if(0<b)for(var d=this._materials=new TDictionary,f=0;f<b;f++){var h=RClass.create(FE3sMaterial);h.unserialize(a);d.set(h.code(),
h)}};
with(MO)MO.FE3sThemeConsole=function(a){a=RClass.inherits(this,a,FConsole);a._path="/assets/theme/";a._activeTheme=null;a._themes=null;a.construct=FE3sThemeConsole_construct;a.activeTheme=FE3sThemeConsole_activeTheme;a.find=FE3sThemeConsole_find;a.select=FE3sThemeConsole_select;return a},MO.FE3sThemeConsole_construct=function(){this.__base.FConsole.construct.call(this);this._themes=new TDictionary},MO.FE3sThemeConsole_activeTheme=function(){return this._activeTheme},MO.FE3sThemeConsole_find=function(a){var b=
this._activeTheme;if(null==b)throw new TError("Active theme is empty.");return b.find(a)},MO.FE3sThemeConsole_select=function(a){var b=this._themes.get(a);if(null==b){var d=RBrowser.contentPath(this._path+a+".ser"),b=RClass.create(FE3sTheme);b.load(d);this._themes.set(a,b)}return this._activeTheme=b};
with(MO)MO.FE3sTrack=function(a){a=RClass.inherits(this,a,FObject);a._meshCode=null;a._boneIndex=0;a._frameTick=0;a._matrix=null;a._matrixInvert=null;a._frameCount=null;a._frames=null;a.construct=FE3sTrack_construct;a.boneIndex=FE3sTrack_boneIndex;a.frameTick=FE3sTrack_frameTick;a.matrix=FE3sTrack_matrix;a.matrixInvert=FE3sTrack_matrixInvert;a.frames=FE3sTrack_frames;a.calculate=FE3sTrack_calculate;a.unserialize=FE3sTrack_unserialize;return a},MO.FE3sTrack_construct=function(){this.__base.FObject.construct.call(this);
this._matrix=new SMatrix3d;this._matrixInvert=new SMatrix3d},MO.FE3sTrack_boneIndex=function(){return this._boneIndex},MO.FE3sTrack_frameTick=function(){return this._frameTick},MO.FE3sTrack_matrix=function(){return this._matrix},MO.FE3sTrack_matrixInvert=function(){return this._matrixInvert},MO.FE3sTrack_frames=function(){return this._frames},MO.FE3sTrack_calculate=function(a,b){var d=a.frameCount;if(0==d)throw new TError("Frame count is invalid.");var f=a.beginIndex,h=this._frameTick,k=parseInt(b/
h)%d,q=this._frames,w=q.get(f+k),x=null,x=k<d-1?q.get(f+k+1):q.get(f);a.tick=b;a.rate=b%h/h;a.currentFrame=w;a.nextFrame=x;return!0},MO.FE3sTrack_unserialize=function(a){this._meshCode=a.readString();this._boneIndex=a.readUint16();this._frameTick=a.readUint16();this._matrix.unserialize(a);this._matrixInvert.assign(this._matrix);this._matrixInvert.invert();this._frameCount=a.readInt16();this._frames=new TObjects};
with(MO)MO.FE3sVendor=function(a){a=RClass.inherits(this,a,FObject);a._contentUrl=null;a._parameters=null;a.construct=FE3sVendor_construct;a.contentUrl=FE3sVendor_contentUrl;a.setContentUrl=FE3sVendor_setContentUrl;a.get=FE3sVendor_get;a.set=FE3sVendor_set;a.makeSource=RMethod.virtual(a,"makeSource");a.makeUrl=FE3sVendor_makeUrl;a.reset=FE3sVendor_reset;a.dispose=FE3sVendor_dispose;return a},MO.FE3sVendor_construct=function(){this.__base.FObject.construct.call(this);this._parameters=new TAttributes},
MO.FE3sVendor_contentUrl=function(a){return this._contentUrl},MO.FE3sVendor_setContentUrl=function(a){this._contentUrl=a},MO.FE3sVendor_get=function(a){return this._parameters.get(a)},MO.FE3sVendor_set=function(a,b){this._parameters.set(a,b)},MO.FE3sVendor_makeUrl=function(){var a=this.makeSource();RRuntime.isDebug()&&(a=-1==a.indexOf("?")?a+"?":a+"&",a+="date="+RDate.format());return a},MO.FE3sVendor_reset=function(){this._parameters.clear()},MO.FE3sVendor_dispose=function(){this._parameters=RObject.dispose(this._parameters);
this.__base.FObject.dispose.call(this)};
with(MO)MO.FE3sVendorConsole=function(a){a=RClass.inherits(this,a,FConsole);a._setuped=!1;a._vendors=null;a.construct=FE3sVendorConsole_construct;a.createVendor=FE3sVendorConsole_createVendor;a.register=FE3sVendorConsole_register;a.find=FE3sVendorConsole_find;a.setup=FE3sVendorConsole_setup;return a},MO.FE3sVendorConsole_construct=function(){this.__base.FConsole.construct.call(this);this._vendors=new TDictionary},MO.FE3sVendorConsole_createVendor=function(a,b){var d=RClass.create(a);d.setContentUrl(b);
return d},MO.FE3sVendorConsole_register=function(a,b){this._vendors.set(a,b)},MO.FE3sVendorConsole_find=function(a){this._setuped||this.setup("net");a=this._vendors.get(a);a.reset();return a},MO.FE3sVendorConsole_setup=function(a){if("net"==a)this._vendors.set("bitmap",this.createVendor(FE3sVendorNet,RBrowser.hostPath("/cloud.resource.bitmap.wv"),"guid")),this._vendors.set("material",this.createVendor(FE3sVendorNet,RBrowser.hostPath("/cloud.resource.material.wv?do=data"),"guid")),this._vendors.set("mesh",
this.createVendor(FE3sVendorNet,RBrowser.hostPath("/cloud.resource.mesh.wv"),"guid")),this._vendors.set("model",this.createVendor(FE3sVendorNet,RBrowser.hostPath("/cloud.resource.model.wv"),"guid")),this._vendors.set("template",this.createVendor(FE3sVendorNet,RBrowser.hostPath("/cloud.resource.template.wv"),"guid")),this._vendors.set("scene",this.createVendor(FE3sVendorNet,RBrowser.hostPath("/cloud.resource.scene.wv"),"guid|code"));else if("local"==a)this._vendors.set("bitmap",this.createVendor(FE3sVendorLocal,
RBrowser.contentPath("/ar3/bitmap/{guid}.bin"))),this._vendors.set("material",this.createVendor(FE3sVendorLocal,RBrowser.contentPath("/ar3/material/{guid}.bin"))),this._vendors.set("mesh",this.createVendor(FE3sVendorLocal,RBrowser.contentPath("/ar3/mesh/{guid}.bin"))),this._vendors.set("model",this.createVendor(FE3sVendorLocal,RBrowser.contentPath("/ar3/model/{guid}.bin"))),this._vendors.set("template",this.createVendor(FE3sVendorLocal,RBrowser.contentPath("/ar3/template/{guid}.bin"))),this._vendors.set("scene",
this.createVendor(FE3sVendorLocal,RBrowser.contentPath("/ar3/scene/{guid}.bin")));else throw new TError(this,"Unknown setup code. (code={1})",a);this._setuped=!0};with(MO)MO.FE3sVendorLocal=function(a){a=RClass.inherits(this,a,FE3sVendor);a.makeSource=FE3sVendorLocal_makeSource;return a},MO.FE3sVendorLocal_makeSource=function(){for(var a=this._contentUrl,b=this._parameters,d=b.count(),f=0;f<d;f++)var h=b.name(f),k=b.value(f),a=RString.replace(a,"{"+h+"}",k);return a};
with(MO)MO.FE3sVendorNet=function(a){a=RClass.inherits(this,a,FE3sVendor);a.makeSource=FE3sVendorNet_makeSource;return a},MO.FE3sVendorNet_makeSource=function(){for(var a=this._contentUrl,a=-1==a.indexOf("?")?a+"?":a+"&",b=this._parameters,d=b.count(),f=!1,h=0;h<d;h++){var k=b.name(h),q=b.value(h);RString.isEmpty(q)||(f?a+="&":f=!0,a+=k+"="+q)}return a};
with(MO)MO.SE3rPlayInfo=function(){this.tick=0;this.playRate=1;this.frameCount=this.endIndex=this.beginIndex=0;this.nextFrame=this.currentFrame=null;this.alpha=this.rate=1;this.translation=new SPoint3;this.quaternion=new SQuaternion;this.scale=new SVector3;this.matrix=new SMatrix3d;this.update=SE3rPlayInfo_update;return this},MO.SE3rPlayInfo_update=function(){var a=this.currentFrame;if(!a)return!1;var b=this.nextFrame;if(!b)return!1;var d=this.matrix,f=a.translation(),h=a.quaternion(),a=a.scale(),
k=this.rate;0<k&&1>k?(this.translation.slerp(f,b.translation(),k),this.quaternion.slerp(h,b.quaternion(),k),this.scale.slerp(a,b.scale(),k),d.build(this.translation,this.quaternion,this.scale)):d.build(f,h,a);return!0};
with(MO)MO.FE3rAnimation=function(a){a=RClass.inherits(this,a,FObject);a._valid=!1;a._baseTick=0;a._currentTick=0;a._lastTick=0;a._playRate=1;a._tracks=null;a._resource=null;a._playInfo=null;a.construct=FE3rAnimation_construct;a.findTrack=FE3rAnimation_findTrack;a.tracks=FE3rAnimation_tracks;a.resource=FE3rAnimation_resource;a.loadResource=FE3rAnimation_loadResource;a.record=FE3rAnimation_record;a.process=RMethod.virtual(a,"process");a.dispose=FE3rAnimation_dispose;return a},MO.FE3rAnimation_construct=
function(){this.__base.FObject.construct.call(this);this._playInfo=new SE3rPlayInfo},MO.FE3rAnimation_findTrack=function(a){for(var b=this._tracks,d=b.count(),f=0;f<d;f++){var h=b.get(f);if(h.boneIndex()==a)return h}return null},MO.FE3rAnimation_tracks=function(){return this._tracks},MO.FE3rAnimation_resource=function(){return this._resource},MO.FE3rAnimation_loadResource=function(a){var b=a.frameCount();this._resource=a;if(a=a.tracks())for(var d=this._tracks=new TObjects,f=a.count(),h=0;h<f;h++){var k=
a.at(h),q=RClass.create(FE3rTrack);q._animation=this;q.loadResource(k);d.push(q)}0<b&&(a=this._playInfo,a.beginIndex=0,a.endIndex=0<b?b-1:0,a.frameCount=b,this._valid=!0)},MO.FE3rAnimation_record=function(){var a=RTimer.current();0==this._lastTick&&(this._lastTick=a);this._currentTick=(a-this._lastTick+this._baseTick)*this._playRate},MO.FE3rAnimation_dispose=function(){this._resource=this._tracks=null;this.__base.FObject.dispose.call(this)};
with(MO)MO.FE3rBitmap=function(a){a=RClass.inherits(this,a,FE3rObject);a._pack=null;a.construct=FE3rBitmap_construct;a.testReady=FE3rBitmap_testReady;a.texture=FE3rBitmap_texture;a.loadResource=FE3rBitmap_loadResource;a.dispose=FE3rBitmap_dispose;return a},MO.FE3rBitmap_construct=function(){this.__base.FE3rObject.construct.call(this)},MO.FE3rBitmap_testReady=function(){return this._pack.testReady()},MO.FE3rBitmap_texture=function(){return this._pack.texture()},MO.FE3rBitmap_loadResource=function(a){this._resource=
a;this._guid=a.guid();this._code=a.code()},MO.FE3rBitmap_dispose=function(){this.__base.FE3rObject.dispose.call(this)};
with(MO)MO.FE3rBitmapConsole=function(a){a=RClass.inherits(this,a,FConsole);a._scopeCd=EScope.Local;a._bitmaps=null;a._dataUrl="/cloud.resource.material.wv";a.construct=FE3rBitmapConsole_construct;a.bitmaps=FE3rBitmapConsole_bitmaps;a.load=FE3rBitmapConsole_load;a.loadUrl=FE3rBitmapConsole_loadUrl;return a},MO.FE3rBitmapConsole_construct=function(){this.__base.FConsole.construct.call(this);this._bitmaps=new TDictionary},MO.FE3rBitmapConsole_bitmaps=function(){return this._bitmaps},MO.FE3rBitmapConsole_load=
function(a,b,d){var f=b+"|"+d,h=this._bitmaps.get(f);if(h)return h;b=RBrowser.hostPath(this._dataUrl+"?guid="+b+"&code="+d);RLogger.info(this,"Load bitmap. (url={1})",b);h="environment"==d?RClass.create(FE3rBitmapCubePack):RClass.create(FE3rBitmapFlatPack);h.linkGraphicContext(a);h.loadUrl(b);this._bitmaps.set(f,h);return h},MO.FE3rBitmapConsole_loadUrl=function(a,b){var d=this._bitmaps.get(b);if(d)return d;d=RBrowser.contentPath(b);RLogger.info(this,"Load bitmap from url. (url={1})",d);d=RClass.create(FE3rBitmap);
d.linkGraphicContext(a);d.setup();d.loadUrl(b);this._bitmaps.set(b,d);return d};
with(MO)MO.FE3rBitmapCubePack=function(a){a=RClass.inherits(this,a,FE3rBitmapPack);a._resource=null;a._images=null;a.onLoad=FE3rBitmapCubePack_onLoad;a.construct=FE3rBitmapCubePack_construct;a.loadUrl=FE3rBitmapCubePack_loadUrl;a.dispose=FE3rBitmapCubePack_dispose;return a},MO.FE3rBitmapCubePack_onLoad=function(a){a=this._graphicContext;var b=this._images;RBrowser.capability();for(var d=0;6>d;d++)if(!b.at(d).testReady())return;(this._texture=a.createCubeTexture()).upload(b.at(0),b.at(1),b.at(2),b.at(3),
b.at(4),b.at(5));for(d=0;6>d;d++)b.at(d).dispose();this._images=RObject.dispose(this._images);this._ready=this._dataReady=!0},MO.FE3rBitmapCubePack_construct=function(){this.__base.FE3rBitmapPack.construct.call(this)},MO.FE3rBitmapCubePack_loadUrl=function(a){this._images=new TObjects;for(var b=0;6>b;b++){var d=RClass.create(FImage);d._index=b;d.setOptionAlpha(!1);d.loadUrl(a+"&index="+b);d.addLoadListener(this,this.onLoad);this._images.push(d)}},MO.FE3rBitmapCubePack_dispose=function(){this._images=
RObject.dispose(this._images);this.__base.FE3rBitmapPack.dispose.call(this)};
with(MO)MO.FE3rBitmapFlatPack=function(a){a=RClass.inherits(this,a,FE3rBitmapPack);a._resource=null;a._image=null;a.onLoad=FE3rBitmapFlatPack_onLoad;a.construct=FE3rBitmapFlatPack_construct;a.loadUrl=FE3rBitmapFlatPack_loadUrl;a.dispose=FE3rBitmapFlatPack_dispose;return a},MO.FE3rBitmapFlatPack_onLoad=function(a){a=this._texture=this._graphicContext.createFlatTexture();a.upload(this._image);a.makeMipmap();this._image=RObject.dispose(this._image);this._dataReady=!0},MO.FE3rBitmapFlatPack_construct=
function(){this.__base.FE3rBitmapPack.construct.call(this)},MO.FE3rBitmapFlatPack_loadUrl=function(a){var b=this._image=RClass.create(FImage);b.addLoadListener(this,this.onLoad);b.loadUrl(a)},MO.FE3rBitmapFlatPack_dispose=function(){this._image=RObject.dispose(this._image);this.__base.FE3rBitmapPack.dispose.call(this)};
with(MO)MO.FE3rBitmapPack=function(a){a=RClass.inherits(this,a,FObject,MGraphicObject);a._resource=null;a._image=null;a._texture=null;a._ready=!1;a._dataReady=!1;a.onLoad=RMethod.virtual(a,"onLoad");a.construct=FE3rBitmapPack_construct;a.texture=FE3rBitmapPack_texture;a.testReady=FE3rBitmapPack_testReady;a.loadUrl=RMethod.virtual(a,"loadUrl");a.dispose=FE3rBitmapPack_dispose;return a},MO.FE3rBitmapPack_construct=function(){this.__base.FObject.construct.call(this)},MO.FE3rBitmapPack_texture=function(){return this._texture},
MO.FE3rBitmapPack_testReady=function(){this._dataReady&&(this._ready=this._texture.isValid());return this._ready},MO.FE3rBitmapPack_dispose=function(){this._dataReady=this._ready=!1;this.__base.FObject.dispose.call(this)};
with(MO)MO.FE3rBone=function(a){a=RClass.inherits(this,a,FObject);a._matrix=null;a._boneResource=null;a._trackResource=null;a.construct=FE3rBone_construct;a.matrix=FE3rBone_matrix;a.trackResource=FE3rBone_trackResource;a.loadResource=FE3rBone_loadResource;a.update=FE3rBone_update;a.dispose=FE3rBone_dispose;return a},MO.FE3rBone_construct=function(){this.__base.FObject.construct.call(this);this._matrix=new SMatrix3d},MO.FE3rBone_matrix=function(){return this._matrix},MO.FE3rBone_trackResource=function(){return this._trackResource},
MO.FE3rBone_loadResource=function(a){this._boneResource=a;this._trackResource=a.track()},MO.FE3rBone_update=function(a,b){var d=this._trackResource;d.calculate(a,b);a.update();var f=this._matrix;f.assign(d.matrixInvert());f.append(a.matrix)},MO.FE3rBone_dispose=function(){this._trackResource=this._boneResource=null;this.__base.FG3dBone.dispose.call(this)};
with(MO)MO.FE3rDynamicMesh=function(a){a=RClass.inherits(this,a,FE3dRenderable);a._model=null;a._optionMerge=!0;a._vertexPosition=0;a._vertexTotal=0;a._indexPosition=0;a._indexTotal=0;a._mergeRenderables=null;a.construct=FE3rDynamicMesh_construct;a.mergeCount=FE3rDynamicMesh_mergeCount;a.mergeMaxCount=FE3rDynamicMesh_mergeMaxCount;a.mergeRenderables=FE3rDynamicMesh_mergeRenderables;a.syncVertexBuffer=FE3rDynamicMesh_syncVertexBuffer;a.mergeRenderable=FE3rDynamicMesh_mergeRenderable;a.mergeVertexBuffer=
FE3rDynamicMesh_mergeVertexBuffer;a.mergeIndexBuffer=FE3rDynamicMesh_mergeIndexBuffer;a.build=FE3rDynamicMesh_build;return a},MO.FE3rDynamicMesh_construct=function(){this.__base.FE3dRenderable.construct.call(this);this._mergeRenderables=new TObjects},MO.FE3rDynamicMesh_mergeCount=function(){return this._mergeRenderables.count()},MO.FE3rDynamicMesh_mergeMaxCount=function(){return this._model._mergeMaxCount},MO.FE3rDynamicMesh_mergeRenderables=function(){return this._mergeRenderables},MO.FE3rDynamicMesh_syncVertexBuffer=
function(a){var b=a.resource().code(),d=this._vertexBuffers.get(b);if(!d){var f=a.formatCd(),h=this._vertexTotal,d=this._graphicContext.createVertexBuffer();d.setCode(b);d.setFormatCd(f);d.setStride(a.stride());switch(f){case EG3dAttributeFormat.Float1:d._data=new Float32Array(1*h);break;case EG3dAttributeFormat.Float2:d._data=new Float32Array(2*h);break;case EG3dAttributeFormat.Float3:d._data=new Float32Array(3*h);break;case EG3dAttributeFormat.Float4:d._data=new Float32Array(4*h);break;case EG3dAttributeFormat.Byte4:case EG3dAttributeFormat.Byte4Normal:d._data=
new Uint8Array(4*h);break;default:throw new TError("Unknown code");}this._vertexBuffers.set(b,d)}return d},MO.FE3rDynamicMesh_mergeRenderable=function(a){var b=this._graphicContext.capability(),d=a.vertexCount(),f=a.indexBuffer().count(),h=b.mergeCount;if(this._mergeRenderables.count()>=h)return!1;h=this._vertexTotal+d;if(b.optionIndex32){if(h>RInteger.MAX_UINT32)return!1}else if(h>RInteger.MAX_UINT16)return!1;this._vertexTotal+=d;this._indexTotal+=f;this._mergeRenderables.push(a);return!0},MO.FE3rDynamicMesh_mergeVertexBuffer=
function(a,b,d,f){a=this._vertexPosition;d=d._data;var h=f._dataCount;switch(b){case "position":b=new Float32Array(f._data);RFloat.copy(d,3*a,b,0,3*h);break;case "coord":b=new Float32Array(f._data);RFloat.copy(d,2*a,b,0,2*h);break;case "color":case "normal":case "binormal":case "tangent":case "bone_index":case "bone_weight":b=new Uint8Array(f._data);RByte.copy(d,4*a,b,0,4*h);break;default:throw new TError("Unknown code");}},MO.FE3rDynamicMesh_mergeIndexBuffer=function(a){var b=this._vertexPosition,
d=this._indexPosition,f=this._indexBuffer._data,h=new Uint16Array(a._data);a=3*a._dataCount;for(var k=0;k<a;k++)f[d++]=b+h[k]},MO.FE3rDynamicMesh_build=function(){var a=this._graphicContext,b=a.capability(),d=this._vertexTotal,f=this._indexTotal,h=this._mergeRenderables,k=h.count(),q=h.first();this._material=q._material;this._textures=q._textures;var w=this._instanceVertexBuffer=this._graphicContext.createVertexBuffer();w.setCode("instance");w.setStride(4);w.setFormatCd(EG3dAttributeFormat.Float1);
q=w._data=new Float32Array(d);this._vertexBuffers.set(w.code(),w);a=this._indexBuffer=a.createIndexBuffer();b.optionIndex32?(a.setStrideCd(EG3dIndexStride.Uint32),a._data=new Uint32Array(f)):(a.setSstrideCd(EG3dIndexStride.Uint16),a._data=new Uint16Array(f));a._count=f;for(b=0;b<k;b++){for(var w=h.getAt(b),a=w.vertexCount(),x=w.vertexBuffers(),y=x.count(),z=0;z<y;z++){var A=x.at(z),D=A._resource,B=D._code,A=this.syncVertexBuffer(A);this.mergeVertexBuffer(w,B,A,D)}RFloat.fill(q,this._vertexPosition,
a,b);w=w.indexBuffer();x=w.count();this.mergeIndexBuffer(w._resource);this._vertexPosition+=a;this._indexPosition+=x}x=this._vertexBuffers;y=x.count();for(b=0;b<y;b++)A=x.at(b),A.upload(A._data,A.stride(),d),A._data=null;this._indexBuffer.upload(this._indexBuffer._data,f);this._indexBuffer._data=null};
with(MO)MO.FE3rDynamicModel=function(a){a=RClass.inherits(this,a,FE3rObject);a._renderables=null;a._mergeMaxCount=0;a._meshes=null;a._updateDate=0;a.construct=FE3rDynamicModel_construct;a.createMesh=FE3rDynamicModel_createMesh;a.renderables=FE3rDynamicModel_renderables;a.meshes=FE3rDynamicModel_meshes;a.pushRenderable=FE3rDynamicModel_pushRenderable;a.build=FE3rDynamicModel_build;a.update=FE3rDynamicModel_update;return a},MO.FE3rDynamicModel_construct=function(){this.__base.FE3rObject.construct.call(this);
this._renderables=new TObjects;this._meshes=new TObjects},MO.FE3rDynamicModel_createMesh=function(){var a=RClass.create(FE3rDynamicMesh);a._model=this;a.linkGraphicContext(this);this._meshes.push(a);return a},MO.FE3rDynamicModel_renderables=function(){return this._renderables},MO.FE3rDynamicModel_meshes=function(){return this._meshes},MO.FE3rDynamicModel_pushRenderable=function(a){this._renderables.push(a)},MO.FE3rDynamicModel_build=function(){var a=this._renderables,b=this._meshes,d=a.count();if(0<
d)for(var f=this.createMesh(),h=0;h<d;h++){var k=a.getAt(h);if(!f.mergeRenderable(k)&&(f=this.createMesh(),!f.mergeRenderable(k)))throw new TError(this,"Merge renderable failure.");}a=0;d=b.count();for(h=0;h<d;h++)f=b.getAt(h),f.build(),a=Math.max(a,f.mergeCount());this._mergeMaxCount=a},MO.FE3rDynamicModel_update=function(a){this._updateDate=RTimer.current()};
with(MO)MO.FE3rGeometry=function(a){a=RClass.inherits(this,a,FE3rObject);a._ready=!1;a._resource=null;a._vertexCount=0;a._vertexBuffers=null;a._indexBuffer=null;a._indexBuffers=null;a._resourceMaterial=null;a._material=null;a._textures=null;a.construct=FE3rGeometry_construct;a.testReady=FE3rGeometry_testReady;a.resource=FE3rGeometry_resource;a.setResource=FE3rGeometry_setResource;a.vertexCount=FE3rGeometry_vertexCount;a.findVertexBuffer=FE3rGeometry_findVertexBuffer;a.vertexBuffers=FE3rGeometry_vertexBuffers;
a.indexBuffer=FE3rGeometry_indexBuffer;a.indexBuffers=FE3rGeometry_indexBuffers;a.material=FE3rGeometry_material;a.findTexture=FE3rGeometry_findTexture;a.textures=FE3rGeometry_textures;a.resource=FE3rGeometry_resource;a.loadResource=FE3rGeometry_loadResource;a.processLoad=FE3rGeometry_processLoad;return a},MO.FE3rGeometry_construct=function(){this.__base.FE3rObject.construct.call(this);this._vertexBuffers=new TDictionary;this._indexBuffers=new TObjects},MO.FE3rGeometry_testReady=function(){if(!this._ready){if(!this._resource.testReady())return!1;
var a=this._textures;if(null!=a)for(var b=a.count(),d=0;d<b;d++)if(!a.value(d).testReady())return!1}return this._ready},MO.FE3rGeometry_guid=function(){return this._resource.guid()},MO.FE3rGeometry_resource=function(){return this._resource},MO.FE3rGeometry_setResource=function(a){this._resource=a},MO.FE3rGeometry_vertexCount=function(){return this._vertexCount},MO.FE3rGeometry_findVertexBuffer=function(a){return this._vertexBuffers.get(a)},MO.FE3rGeometry_vertexBuffers=function(){return this._vertexBuffers},
MO.FE3rGeometry_indexBuffer=function(){return this._indexBuffer},MO.FE3rGeometry_indexBuffers=function(){return this._indexBuffers},MO.FE3rGeometry_material=function(){return this._material},MO.FE3rGeometry_findTexture=function(a){return this._textures.get(a)},MO.FE3rGeometry_textures=function(){return this._textures},MO.FE3rGeometry_resource=function(){return this._resource},MO.FE3rGeometry_loadResource=function(a){var b=this._graphicContext;this._resource=a;a=a.streams();for(var d=a.count(),f=0;f<
d;f++){var h=a.at(f),k=h.code(),q=h.dataCount(),w=h.data();if("index16"==k||"index32"==k){var x=this._indexBuffer=b.createIndexBuffer();x._resource=h;h=h.elementDataCd();if(h==EDataType.Uint16)x.setStrideCd(EG3dIndexStride.Uint16);else if(h==EDataType.Uint32)x.setStrideCd(EG3dIndexStride.Uint32);else throw new TError(this,"Unknown data type.");x.upload(w,3*q);this._indexBuffers.push(x)}else{x=b.createVertexBuffer(FE3rVertexBuffer);x.setCode(k);x._resource=h;x._vertexCount=q;var y=null;switch(k){case "position":y=
new Float32Array(w);x.setFormatCd(EG3dAttributeFormat.Float3);this._vertexCount=q;break;case "coord":y=new Float32Array(w);x.setFormatCd(EG3dAttributeFormat.Float2);break;case "color":y=new Uint8Array(w);x.setFormatCd(EG3dAttributeFormat.Byte4Normal);break;case "normal":case "binormal":case "tangent":y=new Uint8Array(w);x.setFormatCd(EG3dAttributeFormat.Byte4Normal);break;default:throw new TError(this,"Unknown code");}x.upload(y,h._dataStride,q);this._vertexBuffers.set(k,x)}}this._ready=!0},MO.FE3rGeometry_processLoad=
function(){if(this._dataReady)return!0;if(!this._resource.testReady())return!1;this.loadResource(this._resource);return!0};
with(MO)MO.FE3rInstanceMesh=function(a){a=RClass.inherits(this,a,FE3rMesh);a._merges=null;a.construct=FE3rInstanceMesh_construct;a.mergeRenderable=FE3rInstanceMesh_mergeRenderable;a.build=FE3rInstanceMesh_build;return a},MO.FE3rInstanceMesh_construct=function(){this.__base.FE3rMesh.construct.call(this);this._merges=new TObjects},MO.FE3rInstanceMesh_mergeRenderable=function(a){this._merges.push(a)},MO.FE3rInstanceMesh_build=function(){};
with(MO)MO.FE3rMaterial=function(a){a=RClass.inherits(this,a,FG3dMaterial,MAttributeGuid,MGraphicObject,MLinkerResource);a._ready=!1;a._visible=!0;a._bitmaps=null;a._reference=null;a.visible=FE3rMaterial_visible;a.setVisible=FE3rMaterial_setVisible;a.findBitmap=FE3rMaterial_findBitmap;a.bitmaps=FE3rMaterial_bitmaps;a.reference=FE3rMaterial_reference;a.testReady=FE3rMaterial_testReady;a.testVisible=FE3rMaterial_testVisible;a.loadResource=FE3rMaterial_loadResource;a.reloadResource=FE3rMaterial_reloadResource;
a.load=FE3rMaterial_load;return a},MO.FE3rMaterial_visible=function(){return this._visible},MO.FE3rMaterial_findBitmap=function(a){this._visible=a},MO.FE3rMaterial_findBitmap=function(a){return this._bitmaps.get(a)},MO.FE3rMaterial_bitmaps=function(){return this._bitmaps},MO.FE3rMaterial_reference=function(){return this._reference},MO.FE3rMaterial_testReady=function(){if(!this._ready){var a=this._bitmaps;if(a)for(var b=a.count(),d=0;d<b;d++)if(!a.at(d).testReady())return!1;this._ready=!0}return this._ready},
MO.FE3rMaterial_testVisible=function(){var a=this._visible;a&&this._reference&&(a=this._reference.testVisible());return a},MO.FE3rMaterial_loadResource=function(a){this._guid=a.guid();this._resource=a;this._info.calculate(a.info());this._dirty=!0},MO.FE3rMaterial_reloadResource=function(){this._info.calculate(this._resource.info());this._dirty=!0},MO.FE3rMaterial_load=function(){var a=this._resource.bitmaps();if(a)for(var b=RConsole.find(FE3rBitmapConsole),d=this._bitmaps=new TDictionary,f=a.count(),
h=0;h<f;h++){var k=a.at(h),q=k.code(),w=k.bitmapPack().code(),w=b.load(this,this._guid,w),x=RClass.create(FE3rBitmap);x._pack=w;x.loadResource(k);d.set(q,x)}};
with(MO)MO.FE3rMaterialConsole=function(a){a=RClass.inherits(this,a,FConsole);a._scopeCd=EScope.Local;a._materials=null;a.construct=FE3rMaterialConsole_construct;a.load=FE3rMaterialConsole_load;return a},MO.FE3rMaterialConsole_construct=function(){this.__base.FConsole.construct.call(this);this._materials=new TDictionary},MO.FE3rMaterialConsole_load=function(a,b){if(!a)throw new TError("Graphics context is empty");if(!b)throw new TError("Material guid is empty");var d=this._materials.get(b);if(d)return d;
var f=RConsole.find(FE3sMaterialConsole).find(b),d=RClass.create(FE3rMaterial);d.linkGraphicContext(a);d.loadResource(f);d.load();this._materials.set(b,d);return d};
with(MO)MO.FE3rMesh=function(a){a=RClass.inherits(this,a,FE3rObject);a._ready=!1;a._resource=null;a._vertexCount=0;a._vertexBuffers=null;a._indexBuffer=null;a._resourceMaterial=null;a._material=null;a._textures=null;a.construct=FE3rMesh_construct;a.testReady=FE3rMesh_testReady;a.resource=FE3rMesh_resource;a.setResource=FE3rMesh_setResource;a.vertexCount=FE3rMesh_vertexCount;a.findVertexBuffer=FE3rMesh_findVertexBuffer;a.vertexBuffers=FE3rMesh_vertexBuffers;a.indexBuffer=FE3rMesh_indexBuffer;a.material=
FE3rMesh_material;a.findTexture=FE3rMesh_findTexture;a.textures=FE3rMesh_textures;a.resource=FE3rMesh_resource;a.loadResource=FE3rMesh_loadResource;a.processLoad=FE3rMesh_processLoad;return a},MO.FE3rMesh_construct=function(){this.__base.FE3rObject.construct.call(this);this._vertexBuffers=new TObjects},MO.FE3rMesh_testReady=function(){if(!this._ready){if(!this._resource.testReady())return!1;var a=this._textures;if(null!=a)for(var b=a.count(),d=0;d<b;d++)if(!a.value(d).testReady())return!1}return this._ready},
MO.FE3rMesh_guid=function(){return this._resource.guid()},MO.FE3rMesh_resource=function(){return this._resource},MO.FE3rMesh_setResource=function(a){this._resource=a},MO.FE3rMesh_vertexCount=function(){return this._vertexCount},MO.FE3rMesh_findVertexBuffer=function(a){for(var b=this._vertexBuffers,d=b.count(),f=0;f<d;f++){var h=b.get(f);if(h.name()==a)return h}return null},MO.FE3rMesh_vertexBuffers=function(){return this._vertexBuffers},MO.FE3rMesh_indexBuffer=function(){return this._indexBuffer},
MO.FE3rMesh_material=function(){return this._material},MO.FE3rMesh_findTexture=function(a){return this._textures.get(a)},MO.FE3rMesh_textures=function(){return this._textures},MO.FE3rMesh_resource=function(){return this._resource},MO.FE3rMesh_loadResource=function(a){var b=this._graphicContext;this._resource=a;a=a.streams();for(var d=a.count(),f=0;f<d;f++){var h=a.get(f),k=h._code,q=h._dataCount,w=h._data;if("index16"==k||"index32"==k){var x=this._indexBuffer=b.createIndexBuffer();x._resource=h;h=
h.elementDataCd();if(h==EDataType.Uint16)x._strideCd=EG3dIndexStride.Uint16;else if(h==EDataType.Uint32)x._strideCd=EG3dIndexStride.Uint32;else throw new TError(this,"Unknown data type.");x.upload(w,3*q)}else{x=b.createVertexBuffer();x._name=k;x._resource=h;x._vertexCount=q;var y=null;switch(k){case "position":y=new Float32Array(w);x._formatCd=EG3dAttributeFormat.Float3;break;case "coord":y=new Float32Array(w);x._formatCd=EG3dAttributeFormat.Float2;break;case "color":y=new Uint8Array(w);x._formatCd=
EG3dAttributeFormat.Byte4Normal;break;case "normal":case "binormal":case "tangent":y=new Uint8Array(w);x._formatCd=EG3dAttributeFormat.Byte4Normal;break;default:throw new TError(this,"Unknown code");}x.upload(y,h._dataStride,q);this._vertexBuffers.push(x)}}this._ready=!0},MO.FE3rMesh_processLoad=function(){if(this._dataReady)return!0;if(!this._resource.testReady())return!1;this.loadResource(this._resource);return!0};
with(MO)MO.FE3rMeshAnimation=function(a){a=RClass.inherits(this,a,FE3rAnimation);a.process=FE3rMeshAnimation_process;return a},MO.FE3rMeshAnimation_process=function(a){if(this._valid){var b=Math.abs(this._currentTick),d=a._resource,f=this._playInfo;d.calculate(f,b);f.update();a=a._matrix;a.assign(d.matrixInvert());a.append(f.matrix)}};
with(MO)MO.FE3rMeshConsole=function(a){a=RClass.inherits(this,a,FConsole);a._scopeCd=EScope.Local;a._loadMeshs=null;a._meshs=null;a._thread=null;a._interval=200;a.onProcess=FE3rMeshConsole_onProcess;a.construct=FE3rMeshConsole_construct;a.findMesh=FE3rMeshConsole_findMesh;a.meshs=FE3rMeshConsole_meshs;a.loadByGuid=FE3rMeshConsole_loadByGuid;a.loadByCode=FE3rMeshConsole_loadByCode;return a},MO.FE3rMeshConsole_onProcess=function(){var a=this._loadMeshs;for(a.record();a.next();)a.current().processLoad()&&
a.removeCurrent()},MO.FE3rMeshConsole_construct=function(){this.__base.FConsole.construct.call(this);this._loadMeshs=new TLooper;this._meshs=new TDictionary;var a=this._thread=RClass.create(FThread);a.setInterval(this._interval);a.addProcessListener(this,this.onProcess);RConsole.find(FThreadConsole).start(a)},MO.FE3rMeshConsole_findMesh=function(a){return this._meshs.get(a)},MO.FE3rMeshConsole_meshs=function(){return this._meshs},MO.FE3rMeshConsole_loadByGuid=function(a,b){if(!RClass.isClass(a,MGraphicObject))throw new TError("Graphics context is empty");
if(RString.isEmpty(b))throw new TError("Mesh guid is empty");var d=this._meshs.get(b);if(d)return d;var f=RConsole.find(FE3sMeshConsole).loadByGuid(b),d=RClass.create(FE3rMesh);d.linkGraphicContext(a);d.setCode(b);d.setResource(f);this._meshs.set(b,d);f.testReady()?d.loadResource(f):this._loadMeshs.push(d);return d},MO.FE3rMeshConsole_loadByCode=function(a,b){if(!RClass.isClass(a,MGraphicObject))throw new TError("Graphics context is empty");if(RString.isEmpty(b))throw new TError("Mesh code is empty");
var d=this._meshs.get(b);if(d)return d;var f=RConsole.find(FE3sMeshConsole).loadByCode(b),d=RClass.create(FE3rMesh);d.linkGraphicContext(a);d.setCode(b);d.setResource(f);this._meshs.set(b,d);f.testReady()?d.loadResource(f):this._loadMeshs.push(d);return d};
with(MO)MO.FE3rModel=function(a){a=RClass.inherits(this,a,FE3rObject);a._resource=null;a._meshes=null;a._skeletons=null;a._dataReady=!1;a.findMeshByGuid=FE3rModel_findMeshByGuid;a.geometrys=FE3rModel_geometrys;a.resource=FE3rModel_resource;a.setResource=FE3rModel_setResource;a.testReady=FE3rModel_testReady;a.loadResource=FE3rModel_loadResource;a.loadSkeletonResource=FE3rModel_loadSkeletonResource;a.processLoad=FE3rModel_processLoad;a.dispose=FE3rModel_dispose;return a},MO.FE3rModel_findMeshByGuid=
function(a){for(var b=this._meshes,d=b.count(),f=0;f<d;f++){var h=b.get(f);if(h._guid==a)return h}return null},MO.FE3rModel_geometrys=function(){return this._meshes},MO.FE3rModel_resource=function(){return this._resource},MO.FE3rModel_setResource=function(a){this._resource=a},MO.FE3rModel_testReady=function(){return this._dataReady},MO.FE3rModel_loadSkeletonResource=function(a){var b=RConsole.find(FE3rModelConsole);if(a=a.skins())for(var d=a.count(),f=0;f<d;f++){var h=a.at(f),k=RClass.create(FE3rSkin);
k.linkGraphicContext(this);k.loadResource(h);h=h.meshGuid();b.findMesh(h).pushSkin(k)}},MO.FE3rModel_loadResource=function(a){var b=RConsole.find(FE3rModelConsole),d=a.meshes();if(d)for(var f=this._meshes=new TObjects,h=d.count(),k=0;k<h;k++){var q=d.valueAt(k),w=RClass.create(FE3rModelMesh);w.linkGraphicContext(this);w.loadResource(q);f.push(w);b.meshs().set(w.guid(),w)}if(a=a.skeletons())for(b=a.count(),k=0;k<b;k++)d=a.get(k),this.loadSkeletonResource(d);this._dataReady=!0},MO.FE3rModel_processLoad=
function(){if(this._dataReady)return!0;if(!this._resource.testReady())return!1;this.loadResource(this._resource);return!0},MO.FE3rModel_dispose=function(){this._ready=!1;this._resource=null;this._meshes=RObject.dispose(this._meshes);this._skeletons=RObject.dispose(this._skeletons);this.__base.FObject.dispose.call(this)};
with(MO)MO.FE3rModelConsole=function(a){a=RClass.inherits(this,a,FConsole);a._scopeCd=EScope.Local;a._loadModels=null;a._models=null;a._meshs=null;a._dynamicMeshs=null;a._thread=null;a._interval=200;a.onProcess=FE3rModelConsole_onProcess;a.construct=FE3rModelConsole_construct;a.findModel=FE3rModelConsole_findModel;a.models=FE3rModelConsole_models;a.findMesh=FE3rModelConsole_findMesh;a.meshs=FE3rModelConsole_meshs;a.load=FE3rModelConsole_load;a.loadMeshByGuid=FE3rModelConsole_loadMeshByGuid;a.loadMeshByCode=
FE3rModelConsole_loadMeshByCode;a.merge=FE3rModelConsole_merge;return a},MO.FE3rModelConsole_onProcess=function(){var a=this._loadModels;for(a.record();a.next();)a.current().processLoad()&&a.removeCurrent()},MO.FE3rModelConsole_construct=function(){this.__base.FConsole.construct.call(this);this._loadModels=new TLooper;this._models=new TDictionary;this._meshs=new TDictionary;this._dynamicMeshs=new TDictionary;var a=this._thread=RClass.create(FThread);a.setInterval(this._interval);a.addProcessListener(this,
this.onProcess);RConsole.find(FThreadConsole).start(a)},MO.FE3rModelConsole_findModel=function(a){return this._models.get(a)},MO.FE3rModelConsole_models=function(){return this._models},MO.FE3rModelConsole_findMesh=function(a){return this._meshs.get(a)},MO.FE3rModelConsole_meshs=function(){return this._meshs},MO.FE3rModelConsole_load=function(a,b){if(!a)throw new TError("Graphics context is empty");if(!b)throw new TError("Model guid is empty");var d=this._models.get(b);if(d)return d;var f=RConsole.find(FE3sModelConsole).load(b),
d=RClass.create(FE3rModel);d.linkGraphicContext(a);d.setCode(b);d.setResource(f);this._models.set(b,d);this._loadModels.push(d);return d},MO.FE3rModelConsole_loadMeshByGuid=function(a,b){if(!a)throw new TError("Graphics context is empty");if(!guid)throw new TError("Model guid is empty");var d=this._models.get(b);if(d)return d;RConsole.find(FE3sModelConsole).load(guid);d=RClass.create(FE3rModel);d.linkGraphicContext(pc);d.setCode(b);d.setResource(rm);this._models.set(b,d);rm.testReady()?d.loadResource(rm):
this._loadModels.push(d);return d},MO.FE3rModelConsole_loadMeshByCode=function(a,b){if(!RClass.isClass(a,MGraphicObject))throw new TError("Graphics context is empty");if(RString.isEmpty(b))throw new TError("Model guid is empty");var d=this._models.get(b);if(d)return d;var f=RConsole.find(FE3sModelConsole).load(guid),d=RClass.create(FE3rModel);d.linkGraphicContext(pc);d.setCode(b);d.setResource(f);this._models.set(b,d);rm.testReady()?m.loadResource(rm):this._loadModels.push(m);return m},MO.FE3rModelConsole_merge=
function(a,b,d,f){a="merge";for(var h=b.renderables(),k=0;k<f;k++){var q=h.getAt(d+k);a+="|"+q.hashCode()}var w=this._dynamicMeshs.get(a);if(!w){w=RClass.create(FE3rDynamicModel);w.linkGraphicContext(b);for(k=0;k<f;k++)q=h.getAt(d+k),w.pushRenderable(q);w.build();this._dynamicMeshs.set(a,w);RLogger.info(this,"Create merge model. (mesh={1}, renderables={2})",w.meshes().count(),w.renderables().count())}w.update();return w};
with(MO)MO.FE3rModelMesh=function(a){a=RClass.inherits(this,a,FE3rGeometry);a._ready=!1;a._resourceMaterial=null;a._skins=null;a._boneIds=null;a.construct=FE3rModelMesh_construct;a.testReady=FE3rModelMesh_testReady;a.guid=FE3rModelMesh_guid;a.skins=FE3rModelMesh_skins;a.pushSkin=FE3rModelMesh_pushSkin;a.boneIds=FE3rModelMesh_boneIds;return a},MO.FE3rModelMesh_construct=function(){this.__base.FE3rGeometry.construct.call(this)},MO.FE3rModelMesh_testReady=function(){if(!this._ready){var a=this._textures;
if(a)for(var b=a.count(),d=0;d<b;d++)if(!a.at(d).testReady())return!1;this._ready=!0}return this._ready},MO.FE3rModelMesh_guid=function(){return this._resource.guid()},MO.FE3rModelMesh_skins=function(){return this._skins},MO.FE3rModelMesh_pushSkin=function(a){var b=this._skins;b||(b=this._skins=new TObjects);b.push(a)},MO.FE3rModelMesh_boneIds=function(){return this._boneIds};with(MO)MO.FE3rObject=function(a){return a=RClass.inherits(this,a,FObject,MAttributeGuid,MAttributeCode,MGraphicObject)};
with(MO)MO.FE3rPipeline=function(a){a=RClass.inherits(this,a,FObject);a._vertexBuffers=null;a._indexBuffer=null;a.construct=FE3rPipeline_construct;a.findVertexBuffer=FE3rPipeline_findVertexBuffer;a.loadResource=FE3rPipeline_loadResource;return a},MO.FE3rPipeline_construct=function(){this.__base.FRenderable.construct.call(this);this._vertexBuffers=new TObjects},MO.FE3rPipeline_findVertexBuffer=function(a){for(var b=this._vertexBuffers,d=b.count(),f=0;f<d;f++){var h=b.get(f);if(h.name()==a)return h}return null},
MO.FE3rPipeline_loadResource=function(a){for(var b=this._context,d=a.vertexBuffers(),f=d.count(),h=0;h<f;h++){var k=d.get(h),q=context.createVertexBuffer();q._name=k.name();q.upload(new Float32Array(k._data),k._stride,k._vertexCount);this._vertexBuffers.push(q)}a=a.indexBuffer();(this._indexBuffer=b.createIndexBuffer()).upload(a.data(),a.count())};
with(MO)MO.FE3rSkeleton=function(a){a=RClass.inherits(this,a,FE3rObject,MLinkerResource);a._bones=null;a._skins=null;a.bones=FE3rSkeleton_bones;a.skins=FE3rSkeleton_skins;a.loadResource=FE3rSkeleton_loadResource;return a},MO.FE3rSkeleton_bones=function(){return this._bones},MO.FE3rSkeleton_skins=function(){return this._skins},MO.FE3rSkeleton_loadResource=function(a){this._resource=a;a=a._bones;var b=a.count();if(0<b)for(var d=this._bones=new TObjects,f=0;f<b;f++){var h=a.at(f),k=RClass.create(FE3rBone);
k.loadResource(h);d.push(k)}};with(MO)MO.FE3rSkeletonAnimation=function(a){a=RClass.inherits(this,a,FE3rAnimation);a.process=FE3rSkeletonAnimation_process;return a},MO.FE3rSkeletonAnimation_process=function(a){if(this._valid){var b=Math.abs(this._currentTick);a=a.bones();for(var d=a.count(),f=0;f<d;f++)a.at(f).update(this._playInfo,b)}};
with(MO)MO.FE3rSkin=function(a){a=RClass.inherits(this,a,FE3rObject);a._resource=null;a._streams=null;a.resource=FE3rSkin_resource;a.streams=FE3rSkin_streams;a.loadResource=FE3rSkin_loadResource;return a},MO.FE3rSkin_resource=function(){return this._resource},MO.FE3rSkin_streams=function(){return this._streams},MO.FE3rSkin_loadResource=function(a){this._resource=a;if(a=a.streams()){var b=a.count();if(0<b)for(var d=this._streams=new TObjects,f=0;f<b;f++){var h=a.at(f),k=RClass.create(FE3rStream);k.linkGraphicContext(this);
k.loadResource(h);d.push(k)}}};
with(MO)MO.FE3rStream=function(a){a=RClass.inherits(this,a,FE3rObject);a._buffer=null;a._resource=null;a.resource=FE3rStream_resource;a.buffer=FE3rStream_buffer;a.loadResource=FE3rStream_loadResource;return a},MO.FE3rStream_resource=function(){return this._resource},MO.FE3rStream_buffer=function(){return this._buffer},MO.FE3rStream_loadResource=function(a){var b=a.code(),d=a._dataCount;this._resource=a;this._vertexCount=d;var f=this._buffer=this._graphicContext.createVertexBuffer(FE3rVertexBuffer);f.setCode(b);
f.setResource(a);switch(b){case "bone_index":f.setFormatCd(EG3dAttributeFormat.Byte4);break;case "bone_weight":f.setFormatCd(EG3dAttributeFormat.Byte4Normal);break;default:throw new TError("Unknown code");}f.upload(a._data,a._dataStride,d)};
with(MO)MO.FE3rTexture=function(a){a=RClass.inherits(this,a,FObject,MGraphicObject);a._resource=null;a._bitmaps=null;a._bitmapPacks=null;a._ready=!1;a._dataReady=!1;a.construct=FE3rTexture_construct;a.resource=FE3rTexture_resource;a.setResource=FE3rTexture_setResource;a.bitmaps=FE3rTexture_bitmaps;a.testReady=FE3rTexture_testReady;a.loadBitmap=FE3rTexture_loadBitmap;a.loadResource=FE3rTexture_loadResource;a.load=FE3rTexture_load;a.processLoad=FE3rTexture_processLoad;a.dispose=FE3rTexture_dispose;
return a},MO.FE3rTexture_construct=function(){this.__base.FObject.construct.call(this);this._bitmaps=new TDictionary},MO.FE3rTexture_resource=function(){return this._resource},MO.FE3rTexture_setResource=function(a){this._resource=a},MO.FE3rTexture_bitmaps=function(){return this._bitmaps},MO.FE3rTexture_testReady=function(){return this._ready},MO.FE3rTexture_loadBitmap=function(a){var b=this._bitmaps,d=b.get(a);d||(d=RClass.create(FE3rTextureBitmap),b.set(a,d));return d},MO.FE3rTexture_loadResource=
function(a){if(a=a.bitmapPacks()){this._bitmapPacks=new TDictionary;for(var b=a.count(),d=0;d<b;d++){var f=a.valueAt(d),h=null;if("flat"==f._typeName)h=RClass.create(FE3rTextureBitmapFlatPack);else if("cube"==f._typeName)h=RClass.create(FE3rTextureBitmapCubePack);else throw new TError(this,"Load resource failure.");h.linkGraphicContext(this);h.loadResource(f);this._bitmapPacks.set(f.code(),h)}}this._dataReady=!0},MO.FE3rTexture_load=function(){for(var a=this._resource.bitmaps(),b=a.count()-1;0<=b;b--){var d=
a.valueAt(b),f=this.loadBitmap(d.guid()),d=this._bitmapPacks.get(d.packCode());if(!d)throw new TError("Link pack is not eists.");f.load(d)}this._ready=!0},MO.FE3rTexture_processLoad=function(){if(this._dataReady){for(var a=this._bitmapPacks,b=a.count()-1;0<=b;b--)if(!a.valueAt(b).testReady())return!1;this.load()}else{if(!this._resource.testReady())return!1;this.loadResource(this._resource)}return this._ready},MO.FE3rTexture_dispose=function(){this._ready=!1;this._resource=null;this._bitmaps=RObject.dispose(this._bitmaps);
this.__base.FObject.dispose.call(this)};
with(MO)MO.FE3rTextureBitmap=function(a){a=RClass.inherits(this,a,FObject,MGraphicObject);a._ready=!1;a._bitmapPack=null;a.construct=FE3rTextureBitmap_construct;a.texture=FE3rTextureBitmap_texture;a.testReady=FE3rTextureBitmap_testReady;a.load=FE3rTextureBitmap_load;a.dispose=FE3rTextureBitmap_dispose;return a},MO.FE3rTextureBitmap_construct=function(){this.__base.FObject.construct.call(this)},MO.FE3rTextureBitmap_texture=function(){return this._bitmapPack.texture()},MO.FE3rTextureBitmap_testReady=
function(){return this._ready},MO.FE3rTextureBitmap_load=function(a){this._bitmapPack=a;this._ready=!0},MO.FE3rTextureBitmap_dispose=function(){this._context=null;this._ready=!1;this._bitmapPack=null;this.__base.FObject.dispose.call(this)};
with(MO)MO.FE3rTextureBitmapCubePack=function(a){a=RClass.inherits(this,a,FE3rTextureBitmapPack);a._resource=null;a._images=null;a.onLoad=FE3rTextureBitmapCubePack_onLoad;a.construct=FE3rTextureBitmapCubePack_construct;a.loadResource=FE3rTextureBitmapCubePack_loadResource;a.dispose=FE3rTextureBitmapCubePack_dispose;return a},MO.FE3rTextureBitmapCubePack_onLoad=function(a){var b=this._graphicContext;a=this._images;for(var d=RBrowser.capability(),f=0;6>f;f++)if(!a[f].testReady())return;(this._texture=
b.createCubeTexture()).upload(a[0],a[1],a[2],a[3],a[4],a[5]);if(d.blobCreate)for(f=0;6>f;f++)b=a[f],window.URL.revokeObjectURL(b.url()),a[f]=RObject.dispose(b);this._images=RObject.dispose(this._images);this._dataReady=!0},MO.FE3rTextureBitmapCubePack_construct=function(){this.__base.FE3rTextureBitmapPack.construct.call(this)},MO.FE3rTextureBitmapCubePack_loadResource=function(a){this._resource=a;var b=a._texture,d=RBrowser.capability(),f=a.data(),h=a._formatName;this._images=new TObjects;for(var k=
0;6>k;k++){var q=this._images[k]=RClass.create(FImage);q._index=k;q.setOptionAlpha(!1);if(d.blobCreate)var w=new Blob([f[k]],{type:"image/"+h}),w=window.URL.createObjectURL(w);else w=RBrowser.hostPath("/cloud.content.texture.bitmap.wv")+"?guid="+b._guid+"&code="+a._code+"&index="+k;q.loadUrl(w);q.addLoadListener(this,this.onLoad)}},MO.FE3rTextureBitmapCubePack_dispose=function(){this._images=RObject.dispose(this._images);this.__base.FE3rTextureBitmapPack.dispose.call(this)};
with(MO)MO.FE3rTextureBitmapFlatPack=function(a){a=RClass.inherits(this,a,FE3rTextureBitmapPack);a._resource=null;a._image=null;a.onLoad=FE3rTextureBitmapFlatPack_onLoad;a.construct=FE3rTextureBitmapFlatPack_construct;a.loadResource=FE3rTextureBitmapFlatPack_loadResource;a.dispose=FE3rTextureBitmapFlatPack_dispose;return a},MO.FE3rTextureBitmapFlatPack_onLoad=function(a){a=this._texture=this._graphicContext.createFlatTexture();a.upload(this._image);a.makeMipmap();this._image=RObject.dispose(this._image);
this._dataReady=!0},MO.FE3rTextureBitmapFlatPack_construct=function(){this.__base.FE3rTextureBitmapPack.construct.call(this)},MO.FE3rTextureBitmapFlatPack_loadResource=function(a){this._resource=a;var b=a._texture,d=a.code();(this._image=RConsole.find(FE3sTextureConsole).loadBitmap(b._guid,d,a._formatName)).addLoadListener(this,this.onLoad)},MO.FE3rTextureBitmapFlatPack_dispose=function(){this._image=RObject.dispose(this._image);this.__base.FE3rTextureBitmapPack.dispose.call(this)};
with(MO)MO.FE3rTextureBitmapPack=function(a){a=RClass.inherits(this,a,FObject,MGraphicObject);a._resource=null;a._image=null;a._texture=null;a._ready=!1;a._dataReady=!1;a.onLoad=RMethod.virtual(a,"onLoad");a.construct=FE3rTextureBitmapPack_construct;a.texture=FE3rTextureBitmapPack_texture;a.testReady=FE3rTextureBitmapPack_testReady;a.loadResource=RMethod.virtual(a,"loadResource");a.dispose=FE3rTextureBitmapPack_dispose;return a},MO.FE3rTextureBitmapPack_construct=function(){this.__base.FObject.construct.call(this)},
MO.FE3rTextureBitmapPack_texture=function(){return this._texture},MO.FE3rTextureBitmapPack_testReady=function(){this._dataReady&&(this._ready=this._texture.isValid());return this._ready},MO.FE3rTextureBitmapPack_dispose=function(){this._dataReady=this._ready=!1;this.__base.FObject.dispose.call(this)};
with(MO)MO.FE3rTextureConsole=function(a){a=RClass.inherits(this,a,FConsole);a._scopeCd=EScope.Local;a._loadTextures=null;a._bitmaps=null;a._textures=null;a._thread=null;a._interval=200;a.onProcess=FE3rTextureConsole_onProcess;a.construct=FE3rTextureConsole_construct;a.bitmaps=FE3rTextureConsole_bitmaps;a.textures=FE3rTextureConsole_textures;a.load=FE3rTextureConsole_load;a.loadBitmap=FE3rTextureConsole_loadBitmap;return a},MO.FE3rTextureConsole_onProcess=function(){var a=this._loadTextures;for(a.record();a.next();)a.current().processLoad()&&
a.removeCurrent()},MO.FE3rTextureConsole_construct=function(){this.__base.FConsole.construct.call(this);this._loadTextures=new TLooper;this._bitmaps=new TDictionary;this._textures=new TDictionary;var a=this._thread=RClass.create(FThread);a.setInterval(this._interval);a.addProcessListener(this,this.onProcess);RConsole.find(FThreadConsole).start(a)},MO.FE3rTextureConsole_bitmaps=function(){return this._bitmaps},MO.FE3rTextureConsole_textures=function(){return this._textures},MO.FE3rTextureConsole_load=
function(a,b,d){if(a=this._textures.get(b+"|"+d))return a;b=RBrowser.hostPath(this._dataUrl+"?guid="+b+"&code="+d);RLogger.info(this,"Load bitmap. (url={1})",b);bitmap="environment"==d?RClass.create(FE3rTextureCube):RClass.create(FE3rTexture);t._name=pg;t.linkGraphicContext(pc);t.load(u);this._bitmaps.set(pg,t);return t},MO.FE3rTextureConsole_load2=function(a,b){var d=this._textures,f=d.get(b);if(f)return f;var h=RConsole.find(FE3sTextureConsole).load(b),f=RClass.create(FE3rTexture);f.linkGraphicContext(a);
f.setResource(h);d.set(b,f);this._loadTextures.push(f);return f},MO.FE3rTextureConsole_loadBitmap=function(a,b,d){var f=this._bitmaps.get(d);return f?f:this.load(a,b).loadBitmap(d)};
with(MO)MO.FE3rTrack=function(a){a=RClass.inherits(this,a,FObject);a._matrix=null;a._resource=null;a.construct=FE3rTrack_construct;a.matrix=FE3rTrack_matrix;a.resource=FE3rTrack_resource;a.loadResource=FE3rTrack_loadResource;a.dispose=FE3rTrack_dispose;return a},MO.FE3rTrack_construct=function(){this.__base.FObject.construct.call(this);this._matrix=new SMatrix3d},MO.FE3rTrack_matrix=function(){return this._matrix},MO.FE3rTrack_resource=function(){return this._resource},MO.FE3rTrack_loadResource=function(a){this._resource=
a;var b=a.frames();null!=b&&(this._frameCount=b.count());this._frameTick=a.frameTick()},MO.FE3rTrack_dispose=function(){this._resource=null;this.__base.FG3dTrack.dispose.call(this)};with(MO)MO.FE3rVertexBuffer=function(a){a=RClass.inherits(this,a,FWglVertexBuffer,MLinkerResource);a.dispose=FE3rVertexBuffer_dispose;return a},MO.FE3rVertexBuffer_dispose=function(){this.__base.MLinkerResource.dispose.call(this);this.__base.FObject.dispose.call(this)};
with(MO)MO.FE3dAutomaticEffect=function(a){a=RClass.inherits(this,a,FG3dAutomaticEffect);a.drawGroup=FE3dAutomaticEffect_drawGroup;return a},MO.FE3dAutomaticEffect_drawGroup=function(a,b,d,f){if(1<f){var h=RConsole.find(FE3rModelConsole).merge(this,a,d,f);if(h){b=this._graphicContext;h=h.meshes();d=h.count();f=a.spaceName();var k=h.first(),q=k.selectInfo(f),w=q.effect;w||(w=q.effect=RConsole.find(FG3dEffectConsole).find(b,a,k));for(b=1;b<d;b++)k=h.getAt(b),q=k.selectInfo(f),q.effect=w;return w.drawRenderables(a,
h,0,d)}}this.drawRenderables(a,b,d,f)};
with(MO)MO.FE3dControlAutomaticEffect=function(a){a=RClass.inherits(this,a,FG3dAutomaticEffect);a._code="control.automatic";a.drawRenderable=FE3dControlAutomaticEffect_drawRenderable;return a},MO.FE3dControlAutomaticEffect_drawRenderable=function(a,b){var d=this._graphicContext,f=this._program,h=b.currentMatrix(),k=a.calculate(EG3dRegionParameter.CameraViewProjectionMatrix),q=b.material(),w=q.info();this.bindMaterial(q);f.setParameter("vc_model_matrix",h);f.setParameter("vc_vp_matrix",k);f.setParameter4("fc_alpha",
w.alphaBase,w.alphaRate,w.alphaLevel,w.alphaMerge);f.setParameter("fc_ambient_color",w.ambientColor);this.bindAttributes(b);this.bindSamplers(b);d.drawTriangles(b.indexBuffer())};
with(MO)MO.FE3dControlFrameEffect=function(a){a=RClass.inherits(this,a,FG3dAutomaticEffect);a._code="control.frame";a.drawRenderable=FE3dControlFrameEffect_drawRenderable;return a},MO.FE3dControlFrameEffect_drawRenderable=function(a,b){var d=this._graphicContext,f=this._program,h=a.calculate(EG3dRegionParameter.CameraPosition),k=a.calculate(EG3dRegionParameter.LightDirection),q=b.material(),w=q.info();this.bindMaterial(q);f.setParameter("vc_model_matrix",b.currentMatrix());f.setParameter("vc_vp_matrix",
a.calculate(EG3dRegionParameter.CameraViewProjectionMatrix));f.setParameter("vc_camera_position",h);f.setParameter("vc_light_direction",k);f.setParameter("fc_camera_position",h);f.setParameter("fc_light_direction",k);f.setParameter("fc_color",w.ambientColor);f.setParameter4("fc_vertex_color",w.colorMin,w.colorMax,w.colorRate,w.colorMerge);f.setParameter4("fc_alpha",w.alphaBase,w.alphaRate,w.alphaLevel,w.alphaMerge);f.setParameter("fc_ambient_color",w.ambientColor);f.setParameter("fc_diffuse_color",
w.diffuseColor);f.setParameter("fc_specular_color",w.specularColor);f.setParameter4("fc_specular",w.specularBase,w.specularLevel,w.specularAverage,w.specularShadow);f.setParameter("fc_specular_view_color",w.specularViewColor);f.setParameter4("fc_specular_view",w.specularViewBase,w.specularViewRate,w.specularViewAverage,w.specularViewShadow);f.setParameter("fc_reflect_color",w.reflectColor);f.setParameter4("fc_reflect",0,0,1-w.reflectMerge,w.reflectMerge);f.setParameter("fc_emissive_color",w.emissiveColor);
this.bindAttributes(b);this.bindSamplers(b);d.drawTriangles(b.indexBuffer())};with(MO)MO.FE3dControlPass=function(a){a=RClass.inherits(this,a,FG3dTechniquePass);a._code="control";return a};
with(MO)MO.FE3dControlTechnique=function(a){a=RClass.inherits(this,a,FG3dTechnique);a._code="control";a._passControl=null;a.setup=FE3dControlTechnique_setup;a.passControl=FE3dControlTechnique_passControl;a.drawRegion=FE3dControlTechnique_drawRegion;return a},MO.FE3dControlTechnique_setup=function(){this.__base.FG3dTechnique.setup.call(this);this.registerMode(EG3dTechniqueMode.Result);var a=this._passControl=RClass.create(FE3dControlPass);a.linkGraphicContext(this);a.setup();this._passes.push(a)},
MO.FE3dControlTechnique_passControl=function(){return this._passControl},MO.FE3dControlTechnique_drawRegion=function(a){a.renderables().isEmpty()||(this._graphicContext.clearDepth(1),this.__base.FG3dTechnique.drawRegion.call(this,a))};
with(MO)MO.FE3dGeneralColorAutomaticEffect=function(a){a=RClass.inherits(this,a,FE3dAutomaticEffect);a._code="general.color.automatic";a.buildMaterial=FE3dGeneralColorAutomaticEffect_buildMaterial;a.drawRenderable=FE3dGeneralColorAutomaticEffect_drawRenderable;return a},MO.FE3dGeneralColorAutomaticEffect_buildMaterial=function(a,b){var d=b.material(),f=a.material;f||(f=a.material=RClass.create(FFloatStream),f.setLength(40),d._dirty=!0);if(d._dirty){var h=d.info();f.reset();h.optionAlpha?f.writeFloat4(h.alphaBase,
h.alphaRate,0,0):f.writeFloat4(h.alphaBase,1,0,0);f.writeFloat4(h.colorMin,h.colorMax,h.colorBalance,h.colorRate);f.writeColor4(h.vertexColor);f.writeColor4(h.ambientColor);f.writeColor4(h.diffuseColor);f.writeColor4(h.specularColor);f.writeFloat4(h.specularBase,h.specularLevel,h.specularAverage,h.specularShadow);f.writeColor4(h.reflectColor);f.writeFloat4(0,0,1-h.reflectMerge,h.reflectMerge);f.writeColor4(h.emissiveColor);d._dirty=!1}},MO.FE3dGeneralColorAutomaticEffect_drawRenderable=function(a,
b){var d=this._program,f=a.calculate(EG3dRegionParameter.CameraPosition),h=a.calculate(EG3dRegionParameter.LightDirection),k=a.calculate(EG3dRegionParameter.CameraViewProjectionMatrix),q=b.material();this.bindMaterial(q);if(b._optionMerge){for(var q=b.mergeRenderables(),w=q.count(),x=RTypeArray.findTemp(EDataType.Float32,16*w),y=0;y<w;y++){var z=q.at(y).currentMatrix();z.writeData(x,16*y)}d.setParameter("vc_model_matrix",x)}else z=b.currentMatrix(),d.setParameter("vc_model_matrix",z);d.setParameter("vc_vp_matrix",
k);d.setParameter("vc_camera_position",f);d.setParameter("vc_light_direction",h);d.setParameter("fc_camera_position",f);d.setParameter("fc_light_direction",h);this._supportMaterialMap?d.setParameter4("fc_material",.03125,b._materialId/512,0,0):(f=b.activeInfo(),this.buildMaterial(f,b),d.setParameter("fc_materials",f.material.memory()));this.__base.FE3dAutomaticEffect.drawRenderable.call(this,a,b)};
with(MO)MO.FE3dGeneralColorFlatEffect=function(a){a=RClass.inherits(this,a,FE3dAutomaticEffect);a._code="general.color.flat";a.drawRenderable=FE3dGeneralColorFlatEffect_drawRenderable;return a},MO.FE3dGeneralColorFlatEffect_drawRenderable=function(a,b){var d=this._graphicContext.size(),f=this._program,h=b.material();this.bindMaterial(h);if(b._optionMerge){for(var h=b.mergeRenderables(),k=h.count(),q=RTypeArray.findTemp(EDataType.Float32,4*k),w=0,x=0;x<k;x++){var y=h.getAt(x),z=y.matrix();q[w++]=z.sx/
d.width*2;q[w++]=z.sy/d.height*2;q[w++]=z.tx/d.width*2-1;q[w++]=1-z.ty/d.height*2;y.currentMatrix().writeData(q,4*x)}f.setParameter("vc_position",q)}else z=b.matrix(),f.setParameter4("vc_position",z.sx/d.width*2,z.sy/d.height*2,z.tx/d.width*2-1,1-z.ty/d.height*2);this.__base.FE3dAutomaticEffect.drawRenderable.call(this,a,b)};with(MO)MO.FE3dGeneralColorPass=function(a){a=RClass.inherits(this,a,FG3dTechniquePass);a._code="color";return a};
with(MO)MO.FE3dGeneralColorSkeletonEffect=function(a){a=RClass.inherits(this,a,FE3dAutomaticEffect);a._code="general.color.skeleton";a._supportSkeleton=!0;a.drawRenderable=FE3dGeneralColorSkeletonEffect_drawRenderable;return a},MO.FE3dGeneralColorSkeletonEffect_drawRenderable=function(a,b){var d=this._program,f=a.calculate(EG3dRegionParameter.CameraPosition),h=a.calculate(EG3dRegionParameter.LightDirection),k=b.material(),q=k.info();this.bindMaterial(k);d.setParameter("vc_model_matrix",b.currentMatrix());
d.setParameter("vc_vp_matrix",a.calculate(EG3dRegionParameter.CameraViewProjectionMatrix));d.setParameter("vc_camera_position",f);d.setParameter("vc_light_direction",h);d.setParameter("fc_camera_position",f);d.setParameter("fc_light_direction",h);d.setParameter("fc_color",q.ambientColor);d.setParameter4("fc_vertex_color",q.colorMin,q.colorMax,q.colorRate,q.colorMerge);d.setParameter4("fc_alpha",q.alphaBase,q.alphaRate,q.alphaLevel,q.alphaMerge);d.setParameter("fc_ambient_color",q.ambientColor);d.setParameter("fc_diffuse_color",
q.diffuseColor);d.setParameter("fc_specular_color",q.specularColor);d.setParameter4("fc_specular",q.specularBase,q.specularLevel,q.specularAverage,q.specularShadow);d.setParameter("fc_specular_view_color",q.specularViewColor);d.setParameter4("fc_specular_view",q.specularViewBase,q.specularViewRate,q.specularViewAverage,q.specularViewShadow);d.setParameter("fc_reflect_color",q.reflectColor);if(f=b.bones()){h=b._boneLimit;k=RTypeArray.findTemp(EDataType.Float32,12*h);for(q=0;q<h;q++)f.at(q).matrix().writeData4x3(k,
12*q);d.setParameter("vc_bone_matrix",k)}this.__base.FE3dAutomaticEffect.drawRenderable.call(this,a,b)};
with(MO)MO.FE3dGeneralTechnique=function(a){a=RClass.inherits(this,a,FE3dTechnique);a._code="general";a._passColor=null;a.setup=FE3dGeneralTechnique_setup;a.passColor=FE3dGeneralTechnique_passColor;return a},MO.FE3dGeneralTechnique_setup=function(){this.__base.FE3dTechnique.setup.call(this);this.registerMode(EG3dTechniqueMode.Ambient);this.registerMode(EG3dTechniqueMode.DiffuseLevel);this.registerMode(EG3dTechniqueMode.DiffuseColor);this.registerMode(EG3dTechniqueMode.SpecularLevel);this.registerMode(EG3dTechniqueMode.SpecularColor);
this.registerMode(EG3dTechniqueMode.Result);var a=this._passColor=RClass.create(FE3dGeneralColorPass);a.linkGraphicContext(this);a.setup();this._passes.push(a)},MO.FE3dGeneralTechnique_passColor=function(){return this._passColor};
with(MO)MO.FE3dShadowColorAutomaticEffect=function(a){a=RClass.inherits(this,a,FG3dAutomaticEffect);a._code="shadow.color.automatic";a.drawRenderable=FE3dShadowColorAutomaticEffect_drawRenderable;return a},MO.FE3dShadowColorAutomaticEffect_drawRenderable=function(a,b){var d=this._graphicContext,f=this._program,h=a.calculate(EG3dRegionParameter.CameraPosition),k=a.calculate(EG3dRegionParameter.CameraViewProjectionMatrix),q=a.calculate(EG3dRegionParameter.LightDirection),w=a.calculate(EG3dRegionParameter.LightViewMatrix),
x=a.calculate(EG3dRegionParameter.LightViewProjectionMatrix),y=a.calculate(EG3dRegionParameter.LightInfo),z=a.techniquePass(),A=b.material();this.bindMaterial(A);f.setParameter("vc_light_depth",y);f.setParameter("vc_model_matrix",b.currentMatrix());f.setParameter("vc_vp_matrix",k);f.setParameter("vc_camera_position",h);f.setParameter("vc_light_direction",q);f.setParameter("vc_light_view_matrix",w);f.setParameter("vc_light_vp_matrix",x);f.setParameter("fc_camera_position",h);f.setParameter("fc_light_direction",
q);f.setParameter4("fc_light_depth",1/4096,0,-1/4096,y.w);h=A.info();f.setParameter("fc_color",h.ambientColor);f.setParameter4("fc_vertex_color",h.colorMin,h.colorMax,h.colorRate,h.colorMerge);f.setParameter4("fc_alpha",h.alphaBase,h.alphaRate,h.alphaLevel,h.alphaMerge);f.setParameter("fc_ambient_color",h.ambientColor);f.setParameter("fc_diffuse_color",h.diffuseColor);f.setParameter("fc_specular_color",h.specularColor);f.setParameter4("fc_specular",h.specularBase,h.specularLevel,h.specularAverage,
h.specularShadow);f.setParameter("fc_specular_view_color",h.specularViewColor);f.setParameter4("fc_specular_view",h.specularViewBase,h.specularViewRate,h.specularViewAverage,h.specularViewShadow);f.setParameter("fc_reflect_color",h.reflectColor);this.bindAttributes(b);f.setSampler("fs_light_depth",z.textureDepth());this.bindSamplers(b);d.drawTriangles(b.indexBuffer())};
with(MO)MO.FE3dShadowColorPass=function(a){a=RClass.inherits(this,a,FG3dTechniquePass);a._code="color";a._textureDepth=null;a.textureDepth=FE3dShadowColorPass_textureDepth;a.setTextureDepth=FE3dShadowColorPass_setTextureDepth;a.drawRegion=FE3dShadowColorPass_drawRegion;return a},MO.FE3dShadowColorPass_textureDepth=function(){return this._textureDepth},MO.FE3dShadowColorPass_setTextureDepth=function(a){this._textureDepth=a},MO.FE3dShadowColorPass_drawRegion=function(a){var b=this._graphicContext;b.setRenderTarget(null);
var d=a._backgroundColor;b.clear(d.red,d.green,d.blue,d.alpha,1);this.__base.FG3dTechniquePass.drawRegion.call(this,a)};
with(MO)MO.FE3dShadowColorSkeletonEffect=function(a){a=RClass.inherits(this,a,FG3dAutomaticEffect);a._code="shadow.color.skeleton";a._supportSkeleton=!0;a.drawRenderable=FE3dShadowColorSkeletonEffect_drawRenderable;return a},MO.FE3dShadowColorSkeletonEffect_drawRenderable=function(a,b){var d=this._graphicContext,f=this._program,h=a.matrixViewProjection(),k=a.cameraPosition(),q=a.lightDirection();if(f.hasAttribute())for(var w=f.attributes(),x=w.count(),y=0;y<x;y++){var z=w.value(y);if(z._statusUsed){var A=
b.findVertexBuffer(z._linker);if(null==A)throw new TError("Can't find renderable vertex buffer. (linker={1})",z._linker);f.setAttribute(z._name,A,A._formatCd)}}if(f.hasSampler())for(w=f.samplers(),x=w.count(),y=0;y<x;y++)if(z=w.value(y),z._statusUsed){var A=z.linker(),D=b.findTexture(A);if(null!=D)f.setSampler(z.name(),D.texture());else throw new TError("Can't find sampler. (linker={1})",A);}f.setParameter("vc_model_matrix",b.currentMatrix());f.setParameter("vc_vp_matrix",h);f.setParameter("vc_camera_position",
k);f.setParameter("vc_light_direction",q);f.setParameter("fc_camera_position",k);f.setParameter("fc_light_direction",q);h=b.material();h=h.info();f.setParameter("fc_color",h.ambientColor);f.setParameter4("fc_vertex_color",h.colorMin,h.colorMax,h.colorRate,h.colorMerge);f.setParameter4("fc_alpha",h.alphaBase,h.alphaRate,h.alphaLevel,h.alphaMerge);f.setParameter("fc_ambient_color",h.ambientColor);f.setParameter("fc_diffuse_color",h.diffuseColor);f.setParameter("fc_specular_color",h.specularColor);f.setParameter4("fc_specular",
h.specularBase,h.specularLevel,h.specularAverage,h.specularShadow);f.setParameter("fc_specular_view_color",h.specularViewColor);f.setParameter4("fc_specular_view",h.specularViewBase,h.specularViewRate,h.specularViewAverage,h.specularViewShadow);f.setParameter("fc_reflect_color",h.reflectColor);if(k=b.bones()){q=k.count();32<q&&(q=32);y=RTypeArray.findTemp(EDataType.Float32,16*q);for(w=0;w<q;w++)h=k.get(w).matrix(),h.writeData(y,16*w);f.setParameter("vc_bone_matrix",y)}f=b.indexBuffer();d.drawTriangles(f,
0,f._count)};
with(MO)MO.FE3dShadowDepthAutomaticEffect=function(a){a=RClass.inherits(this,a,FG3dAutomaticEffect);a._code="shadow.depth.automatic";a.drawRenderable=FE3dShadowDepthAutomaticEffect_drawRenderable;return a},MO.FE3dShadowDepthAutomaticEffect_drawRenderable=function(a,b){var d=this._graphicContext,f=this._program,h=a.calculate(EG3dRegionParameter.LightViewMatrix),k=a.calculate(EG3dRegionParameter.LightViewProjectionMatrix),q=a.calculate(EG3dRegionParameter.LightInfo);d.setBlendFactors(!1);f.setParameter("vc_camera",
q);f.setParameter("vc_model_matrix",b.currentMatrix());f.setParameter("vc_view_matrix",h);f.setParameter("vc_vp_matrix",k);f.setParameter("fc_camera",q);f.setParameter4("fc_alpha",0,0,0,.1);this.bindAttributes(b);this.bindSamplers(b);d.drawTriangles(b.indexBuffer())};
with(MO)MO.FE3dShadowDepthPass=function(a){a=RClass.inherits(this,a,FG3dTechniquePass);a._code="depth";a._renderTarget=null;a._textureDepth=null;a._renderTarget=null;a.setup=FE3dShadowDepthPass_setup;a.textureDepth=FE3dShadowDepthPass_textureDepth;a.drawRegion=FE3dShadowDepthPass_drawRegion;return a},MO.FE3dShadowDepthPass_setup=function(){this.__base.FG3dTechniquePass.setup.call(this);var a=this._graphicContext,b=this._textureDepth=a.createFlatTexture();b.setFilter(EG3dSamplerFilter.Linear,EG3dSamplerFilter.Linear);
b.setWrap(EG3dSamplerFilter.ClampToEdge,EG3dSamplerFilter.ClampToEdge);a=this._renderTarget=a.createRenderTarget();a.size().set(2048,2048);a.textures().push(b);a.build()},MO.FE3dShadowDepthPass_textureDepth=function(){return this._textureDepth},MO.FE3dShadowDepthPass_drawRegion=function(a){var b=this._graphicContext;this._finish?(b.setRenderTarget(null),b=a._backgroundColor,this._context.clear(b.red,b.green,b.blue,b.alpha,1)):(b.setRenderTarget(this._renderTarget),b.clear(0,0,0,1,1,1));a._textureDepth=
this._textureDepth;this.__base.FG3dTechniquePass.drawRegion.call(this,a)};
with(MO)MO.FE3dShadowDepthSkeletonEffect=function(a){a=RClass.inherits(this,a,FG3dAutomaticEffect);a._code="shadow.depth.skeleton";a._supportSkeleton=!0;a.drawRenderable=FE3dShadowDepthSkeletonEffect_drawRenderable;return a},MO.FE3dShadowDepthSkeletonEffect_drawRenderable=function(a,b){var d=this._graphicContext,f=this._program;f.setParameter("vc_model_matrix",r.currentMatrix());f.setParameter("vc_vp_matrix",prvp);f.setParameter("vc_camera_position",prcp);f.setParameter("vc_light_direction",prld);
f.setParameter("fc_camera_position",prcp);f.setParameter("fc_light_direction",prld);var h=r.material(),h=h.info();f.setParameter("fc_color",h.ambientColor);f.setParameter4("fc_vertex_color",h.colorMin,h.colorMax,h.colorRate,h.colorMerge);f.setParameter4("fc_alpha",h.alphaBase,h.alphaRate,h.alphaLevel,h.alphaMerge);f.setParameter("fc_ambient_color",h.ambientColor);f.setParameter("fc_diffuse_color",h.diffuseColor);f.setParameter("fc_specular_color",h.specularColor);f.setParameter4("fc_specular",h.specularBase,
h.specularRate,h.specularAverage,h.specularShadow);f.setParameter("fc_specular_view_color",h.specularViewColor);f.setParameter4("fc_specular_view",h.specularViewBase,h.specularViewRate,h.specularViewAverage,h.specularViewShadow);f.setParameter("fc_reflect_color",h.reflectColor);var k=b.bones();if(k){var q=k.count();32<q&&(q=32);for(var w=RTypeArray.findTemp(EDataType.Float32,16*q),x=0;x<q;x++)h=k.get(x).matrix(),h.writeData(w,16*x);f.setParameter("vc_bone_matrix",w)}this.bindAttributes(b);this.bindSamplers(b);
d.drawTriangles(b.indexBuffer())};
with(MO)MO.FE3dShadowTechnique=function(a){a=RClass.inherits(this,a,FE3dTechnique);a._code="shadow";a._passDepth=null;a._passColor=null;a.setup=FE3dShadowTechnique_setup;a.passDepth=FE3dShadowTechnique_passDepth;a.passColor=FE3dShadowTechnique_passColor;a.updateRegion=FE3dShadowTechnique_updateRegion;return a},MO.FE3dShadowTechnique_setup=function(){this.__base.FE3dTechnique.setup.call(this);this.registerMode(EG3dTechniqueMode.Ambient);this.registerMode(EG3dTechniqueMode.DiffuseLevel);this.registerMode(EG3dTechniqueMode.DiffuseColor);
this.registerMode(EG3dTechniqueMode.SpecularLevel);this.registerMode(EG3dTechniqueMode.SpecularColor);this.registerMode(EG3dTechniqueMode.Result);var a=this._passes,b=this._passDepth=RClass.create(FE3dShadowDepthPass);b.linkGraphicContext(this);b.setup();var d=this._passColor=RClass.create(FE3dShadowColorPass);d.linkGraphicContext(this);d.setup();a.push(d);d.setTextureDepth(b.textureDepth())},MO.FE3dShadowTechnique_passDepth=function(){return this._passDepth},MO.FE3dShadowTechnique_passColor=function(){return this._passColor},
MO.FE3dShadowTechnique_updateRegion=function(a){this.__base.FE3dTechnique.updateRegion.call(this,a);this._graphicContext.size();a.camera();a.directionalLight().camera()};MO.EE3dInstance=new function(){this.ModelRenderable="model.renderable";this.TemplateRenderable="template.renderable";this.Scene="scene";this.SceneLayer="scene.layer";this.SceneDisplay="scene.display";this.SceneMaterial="scene.material";this.SceneMovie="scene.movie";this.SceneRenderable="scene.renderable";return this};
with(MO)MO.FE3dAnimation=function(a){return a=RClass.inherits(this,a,FObject,ME3dObject,MLinkerResource)};
with(MO)MO.FE3dBitmap=function(a){a=RClass.inherits(this,a,FE3dMeshRenderable,MListenerLoad);a._ready=!1;a._size=null;a._renderable=null;a.construct=FE3dBitmap_construct;a.testReady=FE3dBitmap_testReady;a.size=FE3dBitmap_size;a.setSize=FE3dBitmap_setSize;a.renderable=FE3dBitmap_renderable;a.setRenderable=FE3dBitmap_setRenderable;a.vertexBuffers=FE3dBitmap_vertexBuffers;a.indexBuffer=FE3dBitmap_indexBuffer;a.findVertexBuffer=FE3dBitmap_findVertexBuffer;a.findTexture=FE3dBitmap_findTexture;a.textures=
FE3dBitmap_textures;a.processLoad=FE3dBitmap_processLoad;a.process=FE3dBitmap_process;a.loadUrl=FE3dBitmap_loadUrl;a.dispose=FE3dBitmap_dispose;return a},MO.FE3dBitmap_construct=function(){this.__base.FE3dMeshRenderable.construct.call(this);this._material=RClass.create(FE3dMaterial);this._size=new SSize2},MO.FE3dBitmap_testReady=function(){if(!this._ready){var a=this._renderable;if(a&&(this._ready=a.testReady())){var b=a.size(),a=a.adjustSize(),d=this.matrix();d.sz=a.height/b.height;d.updateForce();
b=new SEvent(this);this.processLoadListener(b);b.dispose()}}return this._ready},MO.FE3dBitmap_size=function(){return this._size},MO.FE3dBitmap_setSize=function(a,b){this._size.set(a,b);this._scale.set(a,b,1)},MO.FE3dBitmap_renderable=function(a){return this._renderable},MO.FE3dBitmap_setRenderable=function(a){this._renderable=a;this._ready=!0;this.processLoadListener(this)},MO.FE3dBitmap_vertexBuffers=function(){return this._renderable.vertexBuffers()},MO.FE3dBitmap_indexBuffer=function(){return this._renderable.indexBuffer()},
MO.FE3dBitmap_findVertexBuffer=function(a){return this._renderable.findVertexBuffer(a)},MO.FE3dBitmap_findTexture=function(a){return this._renderable.findTexture(a)},MO.FE3dBitmap_textures=function(){return this._renderable.textures()},MO.FE3dBitmap_processLoad=function(){return!0},MO.FE3dBitmap_process=function(){this.__base.FE3dMeshRenderable.process.call(this)},MO.FE3dBitmap_loadUrl=function(a){var b=this._graphicContext;this._renderable=RConsole.find(FE3dBitmapConsole).loadUrl(b,a);this._ready=
!1},MO.FE3dBitmap_dispose=function(){this._material=RObject.dispoe(this._material);this.__base.FE3dMeshRenderable.dispose.call(this)};
with(MO)MO.FE3dBitmapConsole=function(a){a=RClass.inherits(this,a,FConsole);a._scopeCd=EScope.Local;a._bitmaps=null;a._dataUrl="/cloud.resource.bitmap.wv";a.construct=FE3dBitmapConsole_construct;a.bitmaps=FE3dBitmapConsole_bitmaps;a.load=FE3dBitmapConsole_load;a.loadUrl=FE3dBitmapConsole_loadUrl;return a},MO.FE3dBitmapConsole_construct=function(){this.__base.FConsole.construct.call(this);this._bitmaps=new TDictionary},MO.FE3dBitmapConsole_bitmaps=function(){return this._bitmaps},MO.FE3dBitmapConsole_load=
function(a,b,d){var f=b+"|"+d,h=this._bitmaps.get(f);if(h)return h;b=RBrowser.hostPath(this._dataUrl+"?guid="+b+"&code="+d);RLogger.info(this,"Load bitmap. (url={1})",b);h="environment"==d?RClass.create(FE3rBitmapCubePack):RClass.create(FE3rBitmapFlatPack);h.linkGraphicContext(a);h.loadUrl(b);this._bitmaps.set(f,h);return h},MO.FE3dBitmapConsole_loadUrl=function(a,b){var d=this._bitmaps.get(b);if(d)return d;d=RBrowser.contentPath(b);RLogger.info(this,"Load bitmap from url. (url={1})",d);d=RClass.create(FE3dBitmapData);
d.linkGraphicContext(a);d.setup();d.loadUrl(b);this._bitmaps.set(b,d);return d};
with(MO)MO.FE3dBitmapData=function(a){a=RClass.inherits(this,a,FE3rObject);a._ready=!1;a._vertexCount=4;a._vertexBuffers=null;a._indexBuffer=null;a._indexBuffers=null;a._material=null;a._textures=null;a._image=null;a._size=null;a._adjustSize=null;a.onImageLoad=FE3dBitmapData_onImageLoad;a.construct=FE3dBitmapData_construct;a.testReady=FE3dBitmapData_testReady;a.size=FE3dBitmapData_size;a.adjustSize=FE3dBitmapData_adjustSize;a.vertexCount=FE3dBitmapData_vertexCount;a.findVertexBuffer=FE3dBitmapData_findVertexBuffer;
a.vertexBuffers=FE3dBitmapData_vertexBuffers;a.indexBuffer=FE3dBitmapData_indexBuffer;a.indexBuffers=FE3dBitmapData_indexBuffers;a.material=FE3dBitmapData_material;a.findTexture=FE3dBitmapData_findTexture;a.textures=FE3dBitmapData_textures;a.setup=FE3dBitmapData_setup;a.loadUrl=FE3dBitmapData_loadUrl;a.dispose=FE3dBitmapData_dispose;return a},MO.FE3dBitmapData_onImageLoad=function(a){var b=this._graphicContext;a=a.sender;var d=a.size(),f=d.width,h=d.height;this._size.set(f,h);d=RInteger.pow2(f);h=
RInteger.pow2(h);this._adjustSize.set(d,h);f=RConsole.find(FE2dCanvasConsole);d=f.allocBySize(d,h);d.context().drawImage(a,0,0);b=this._imageTexture=b.createFlatTexture();b.setOptionFlipY(!0);b.upload(d);this._textures.set("diffuse",b);f.free(d);a.dispose();this._ready=!0},MO.FE3dBitmapData_construct=function(){this.__base.FE3rObject.construct.call(this);this._size=new SSize2;this._adjustSize=new SSize2;this._vertexBuffers=new TDictionary;this._textures=new TDictionary},MO.FE3dBitmapData_testReady=
function(){return this._ready},MO.FE3dBitmapData_size=function(){return this._size},MO.FE3dBitmapData_adjustSize=function(){return this._adjustSize},MO.FE3dBitmapData_vertexCount=function(){return this._vertexCount},MO.FE3dBitmapData_findVertexBuffer=function(a){return this._vertexBuffers.get(a)},MO.FE3dBitmapData_vertexBuffers=function(){return this._vertexBuffers},MO.FE3dBitmapData_indexBuffer=function(){return this._indexBuffer},MO.FE3dBitmapData_indexBuffers=function(){return this._indexBuffers},
MO.FE3dBitmapData_material=function(){return this._material},MO.FE3dBitmapData_findTexture=function(a){return this._textures.get(a)},MO.FE3dBitmapData_textures=function(){return this._textures},MO.FE3dBitmapData_setup=function(){var a=this._graphicContext,b=[0,0,0,1,0,0,1,-1,0,0,-1,0],d=this._vertexPositionBuffer=a.createVertexBuffer();d.setName("position");d._formatCd=EG3dAttributeFormat.Float3;d.upload(b,12,4);this._vertexBuffers.set(d.name(),d);b=[0,1,1,1,1,0,0,0];d=this._vertexColorBuffer=a.createVertexBuffer();
d.setName("coord");d._formatCd=EG3dAttributeFormat.Float2;d.upload(b,8,4);this._vertexBuffers.set(d.name(),d);b=[0,1,2,0,2,3];d=this._indexBuffer=a.createIndexBuffer();d.upload(b,6)},MO.FE3dBitmapData_loadUrl=function(a){var b=this._imageTexture;b&&(b.dispose(),this._imageTexture=null,this._textures.clear());b=RClass.create(FImage);b.addLoadListener(this,this.onImageLoad);b.loadUrl(a);this._ready=!1},MO.FE3dBitmapData_dispose=function(){this._size=RObject.dispose(this._size);this._adjustSize=RObject.dispose(this._adjustSize);
this._vertexBuffers=RObject.dispose(this._vertexBuffers);this._indexBuffer=RObject.dispose(this._indexBuffer);this._imageTexture=RObject.dispose(this._imageTexture);this._textures=RObject.dispose(this._textures);this.__base.FE3rObject.dispose.call(this)};
with(MO)MO.FE3dCamera=function(a){a=RClass.inherits(this,a,FG3dPerspectiveCamera,MLinkerResource);a._rotation=null;a._rotationMatrix=null;a._quaternion=null;a._quaternionX=null;a._quaternionY=null;a._quaternionZ=null;a.construct=FE3dCamera_construct;a.rotation=FE3dCamera_rotation;a.doForward=FE3dCamera_doForward;a.doPitch=FE3dCamera_doPitch;a.doYaw=FE3dCamera_doYaw;a.doRoll=FE3dCamera_doRoll;a.loadResource=FE3dCamera_loadResource;a.commitResource=FE3dCamera_commitResource;a.update=FE3dCamera_update;
return a},MO.FE3dCamera_construct=function(){this.__base.FG3dPerspectiveCamera.construct.call(this);this._rotation=new SVector3;this._rotationMatrix=new SMatrix3x3;this._quaternion=new SQuaternion;this._quaternionX=new SQuaternion;this._quaternionY=new SQuaternion;this._quaternionZ=new SQuaternion},MO.FE3dCamera_rotation=function(){return this._rotation},MO.FE3dCamera_doForward=function(a){this._position.x+=this._direction.x*a;this._position.y+=this._direction.y*a;this._position.z+=this._direction.z*
a},MO.FE3dCamera_doPitch=function(a){this._rotation.x+=a},MO.FE3dCamera_doYaw=function(a){this._rotation.y+=a},MO.FE3dCamera_doRoll=function(a){this._rotation.z+=a},MO.FE3dCamera_loadResource=function(a){var b=a.projection();this._resource=a;this.position().assign(a.position());this.setDirection(a.direction().x,a.direction().y,a.direction().z);this.update();a=this.projection();a._angle=b.angle();a._znear=b.znear();a._zfar=b.zfar();a.update()},MO.FE3dCamera_commitResource=function(){var a=this._resource;
a._position.assign(this._position);a._direction.assign(this._direction)},MO.FE3dCamera_update=function(){var a=this._rotation;this._quaternionX.fromAxisAngle(RMath.vectorAxisX,a.x);this._quaternionY.fromAxisAngle(RMath.vectorAxisY,a.y);this._quaternionZ.fromAxisAngle(RMath.vectorAxisZ,a.z);var b=this._quaternion.identity();b.mul(this._quaternionX);b.mul(this._quaternionY);b.mul(this._quaternionZ);a=this._rotationMatrix;a.build(b);b=this._direction;a.transformPoint3(this._directionTarget,b);b.normalize();
this.__base.FG3dPerspectiveCamera.update.call(this)};
with(MO)MO.FE3dDirectionalLight=function(a){a=RClass.inherits(this,a,FG3dDirectionalLight,MLinkerResource);a._material=null;a.construct=FE3dDirectionalLight_construct;a.material=FE3dDirectionalLight_material;a.loadResource=FE3dDirectionalLight_loadResource;a.dispose=FE3dDirectionalLight_dispose;return a},MO.FE3dDirectionalLight_construct=function(){this.__base.FG3dDirectionalLight.construct.call(this);this._material=RClass.create(FE3dMaterial)},MO.FE3dDirectionalLight_material=function(){return this._material},
MO.FE3dDirectionalLight_loadResource=function(a){this.__base.MLinkerResource.loadResource.call(this,a);this._material.loadResource(a.material())},MO.FE3dDirectionalLight_dispose=function(){this._material=RObject.dispose(this._material);this.__base.FG3dDirectionalLight.dispose.call(this)};
with(MO)MO.FE3dFlatStage=function(a){a=RClass.inherits(this,a,FE3dStage);a._layer=null;a.construct=FE3dFlatStage_construct;a.layer=FE3dFlatStage_layer;return a},MO.FE3dFlatStage_construct=function(){this.__base.FE3dStage.construct.call(this);var a=this._layer=RClass.create(FDisplayLayer);this.registerLayer("Layer",a)},MO.FE3dFlatStage_layer=function(){return this._layer};
with(MO)MO.FE3dInstanceConsole=function(a){a=RClass.inherits(this,a,FConsole);a._scopeCd=EScope.Local;a._factory=null;a.construct=FE3dInstanceConsole_construct;a.factory=FE3dInstanceConsole_factory;a.register=FE3dInstanceConsole_register;a.unregister=FE3dInstanceConsole_unregister;a.create=FE3dInstanceConsole_create;return a},MO.FE3dInstanceConsole_construct=function(){var a=this._factory=RClass.create(FClassFactory);a.register(EE3dInstance.ModelRenderable,FE3dModelRenderable);a.register(EE3dInstance.TemplateRenderable,
FE3dTemplateRenderable);a.register(EE3dInstance.Scene,FE3dScene);a.register(EE3dInstance.SceneLayer,FE3dSceneLayer);a.register(EE3dInstance.SceneDisplay,FE3dSceneDisplay);a.register(EE3dInstance.SceneMaterial,FE3dSceneMaterial);a.register(EE3dInstance.SceneMovie,FE3dMovie);a.register(EE3dInstance.SceneRenderable,FE3dSceneDisplayRenderable)},MO.FE3dInstanceConsole_factory=function(){return this._factory},MO.FE3dInstanceConsole_register=function(a,b){this._factory.register(a,b)},MO.FE3dInstanceConsole_unregister=
function(a){this._factory.unregister(a,clazz)},MO.FE3dInstanceConsole_create=function(a){return this._factory.create(a)};with(MO)MO.FE3dMaterial=function(a){a=RClass.inherits(this,a,FE3rMaterial);a._parent=null;a.loadParent=FE3dRenderable_loadParent;return a},MO.FE3dRenderable_loadParent=function(a){this._parent=a};
with(MO)MO.FE3dMesh=function(a){a=RClass.inherits(this,a,FE3dSpace,MLinkerResource,MListenerLoad);a._ready=!1;a._display=null;a._renderable=null;a._layer=null;a.construct=FE3dMesh_construct;a.testReady=FE3dMesh_testReady;a.loadRenderable=FE3dMesh_loadRenderable;a.processLoad=FE3dMesh_processLoad;a.process=FE3dMesh_process;return a},MO.FE3dMesh_construct=function(){this.__base.FE3dSpace.construct.call(this);var a=this._layer=RClass.create(FDisplayLayer);this.registerLayer("Layer",a)},MO.FE3dMesh_testReady=
function(){return this._ready},MO.FE3dMesh_loadRenderable=function(a){var b=a.resource();this.selectTechnique(this,FE3dGeneralTechnique).setResource(b.technique());this.loadResource(b);var d=RClass.create(FE3dMeshRenderable);d.setResource(b._renderable);d._material.loadResource(b._display._material);d._renderable=a;for(var f=a._vertexBuffers,h=f.count(),k=0;k<h;k++){var q=f.getAt(k);d._vertexBuffers.set(q._name,q)}d._indexBuffer=a._indexBuffer;d.matrix().assign(d.resource().matrix());a=this._display=
RClass.create(FE3dMeshDisplay);a._renderable=d;a.load(b._display);a.pushRenderable(d);this._layer.pushDisplay(a);this._ready=!0;this.processLoadListener(this)},MO.FE3dMesh_processLoad=function(){if(!this._renderable.testReady())return!1;this.loadRenderable(this._renderable);return!0},MO.FE3dMesh_process=function(){this.__base.FE3dSpace.process.call(this)};
with(MO)MO.FE3dMeshConsole=function(a){a=RClass.inherits(this,a,FConsole);a._scopeCd=EScope.Local;a._loadMeshs=null;a._meshs=null;a._thread=null;a._interval=100;a.onProcess=FE3dMeshConsole_onProcess;a.construct=FE3dMeshConsole_construct;a.meshs=FE3dMeshConsole_meshs;a.allocByGuid=FE3dMeshConsole_allocByGuid;a.allocByCode=FE3dMeshConsole_allocByCode;a.free=FE3dMeshConsole_free;return a},MO.FE3dMeshConsole_onProcess=function(){var a=this._loadMeshs;for(a.record();a.next();)a.current().processLoad()&&
a.removeCurrent()},MO.FE3dMeshConsole_construct=function(){this._loadMeshs=new TLooper;this._meshs=new TDictionary;var a=this._thread=RClass.create(FThread);a.setInterval(this._interval);a.addProcessListener(this,this.onProcess);RConsole.find(FThreadConsole).start(a)},MO.FE3dMeshConsole_meshs=function(){return this._meshs},MO.FE3dMeshConsole_allocByGuid=function(a,b){var d=this._meshs.get(b);if(d&&!d.isEmpty())return d.pop();var d=RConsole.find(FE3rMeshConsole).loadByGuid(a,b),f=RClass.create(FE3dMesh);
f.linkGraphicContext(a);f._name=b;f._renderable=d;this._loadMeshs.push(f);return f},MO.FE3dMeshConsole_allocByCode=function(a,b){var d=this._meshs.get(b);if(d&&!d.isEmpty())return d.pop();var d=RConsole.find(FE3rMeshConsole).loadByCode(a,b),f=RClass.create(FE3dMesh);f.linkGraphicContext(a);f._name=b;f._renderable=d;this._loadMeshs.push(f);return f},MO.FE3dMeshConsole_free=function(a){a._display.remove()};
with(MO)MO.FE3dMeshDisplay=function(a){a=RClass.inherits(this,a,FE3dDisplay,MLinkerResource);a._material=null;a._renderable=null;a.renderable=FE3dMeshDisplay_renderable;a.load=FE3dMeshDisplay_load;a.reloadResource=FE3dMeshDisplay_reloadResource;return a},MO.FE3dMeshDisplay_renderable=function(){return this._renderable},MO.FE3dMeshDisplay_load=function(a){this._resource=a;this._matrix.assign(a.matrix())},MO.FE3dMeshDisplay_reloadResource=function(){this._matrix.assign(this._resource.matrix())};
with(MO)MO.FE3dMeshRenderable=function(a){a=RClass.inherits(this,a,FE3dRenderable);a._renderable=null;a._activeTrack=null;a.renderable=FE3dMeshRenderable_renderable;a.vertexCount=FE3dMeshRenderable_vertexCount;a.findVertexBuffer=FE3dMeshRenderable_findVertexBuffer;a.vertexBuffers=FE3dMeshRenderable_vertexBuffers;a.indexBuffer=FE3dMeshRenderable_indexBuffer;a.indexBuffers=FE3dMeshRenderable_indexBuffers;a.findTexture=FE3dMeshRenderable_findTexture;a.textures=FE3dMeshRenderable_textures;a.reloadResource=
FE3dMeshRenderable_reloadResource;a.process=FE3dMeshRenderable_process;a.processDelay=FE3dMeshRenderable_processDelay;a.update=FE3dMeshRenderable_update;a.dispose=FE3dMeshRenderable_dispose;return a},MO.FE3dMeshRenderable_renderable=function(){return this._renderable},MO.FE3dMeshRenderable_vertexCount=function(){return this._renderable.vertexCount()},MO.FE3dMeshRenderable_findVertexBuffer=function(a){var b=this._vertexBuffers.get(a);return b?b:this._renderable.findVertexBuffer(a)},MO.FE3dMeshRenderable_vertexBuffers=
function(){return this._renderable.vertexBuffers()},MO.FE3dMeshRenderable_indexBuffer=function(){return this._renderable.indexBuffer()},MO.FE3dMeshRenderable_indexBuffers=function(){return this._renderable.indexBuffers()},MO.FE3dMeshRenderable_findTexture=function(a){return(a=this._textures.get(a))?a:this._renderable.findTexture(p)},MO.FE3dMeshRenderable_textures=function(){var a=this._textures;return a?a:this._renderable.textures()},MO.FE3dMeshRenderable_reloadResource=function(){this._matrix.assign(this._resource.matrix())},
MO.FE3dMeshRenderable_process=function(a){this.__base.FE3dRenderable.process.call(this,a);if((a=this._activeTrack)&&this._display._optionPlay){var b=a._animation;b&&b.process(a)}},MO.FE3dMeshRenderable_processDelay=function(a){this.__base.FE3dRenderable.processDelay.call(this,a)},MO.FE3dMeshRenderable_update=function(a){var b=this._display,d=this._matrix,f=this._activeTrack,h=this._calculateMatrix;f?(h.assign(f.matrix()),h.append(d)):h.assign(d);b&&(b=this._display.currentMatrix(),h.append(b));this._currentMatrix.attachData(h.data())&&
a.change()},MO.FE3dMeshRenderable_dispose=function(){this._modelMatrix=RObject.dispose(this._modelMatrix);this._vertexBuffers=RObject.dispose(this._vertexBuffers);this.__base.FE3dRenderable.dispose.call(this)};
with(MO)MO.FE3dModel=function(a){a=RClass.inherits(this,a,FE3dSpace,MPoolAble,MLinkerResource,MListenerLoad);a._dataReady=!1;a._renderable=null;a._display=null;a.construct=FE3dModel_construct;a.display=FE3dModel_display;a.testReady=FE3dModel_testReady;a.renderable=FE3dModel_renderable;a.setRenderable=FE3dModel_setRenderable;a.loadRenderable=FE3dModel_loadRenderable;a.processLoad=FE3dModel_processLoad;return a},MO.FE3dModel_construct=function(){this.__base.FE3dSpace.construct.call(this);var a=this._layer=
RClass.create(FDisplayLayer);this.registerLayer("sprite",a);var b=this._display=RClass.create(FE3dModelDisplay);a.pushDisplay(b)},MO.FE3dModel_display=function(){return this._display},MO.FE3dModel_testReady=function(){return this._dataReady},MO.FE3dModel_renderable=function(){return this._renderable},MO.FE3dModel_setRenderable=function(a){this._renderable=a},MO.FE3dModel_loadRenderable=function(a){this._renderable=a;var b=a.resource();this.selectTechnique(this,FE3dGeneralTechnique);this.loadResource(b);
this._display.load(a);this._dataReady=!0},MO.FE3dModel_processLoad=function(){if(this._dataReady)return!0;var a=this._renderable;if(!a.testReady())return!1;this.loadRenderable(a);this.processLoadListener(this);return!0};
with(MO)MO.FE3dModelConsole=function(a){a=RClass.inherits(this,a,FConsole);a._scopeCd=EScope.Local;a._looper=null;a._pools=null;a._thread=null;a._interval=100;a.onProcess=FE3dModelConsole_onProcess;a.construct=FE3dModelConsole_construct;a.pools=FE3dModelConsole_pools;a.allocByGuid=FE3dModelConsole_allocByGuid;a.allocByCode=FE3dModelConsole_allocByCode;a.free=FE3dModelConsole_free;return a},MO.FE3dModelConsole_onProcess=function(){var a=this._looper;for(a.record();a.next();)a.current().processLoad()&&
a.removeCurrent()},MO.FE3dModelConsole_construct=function(){this._looper=new TLooper;this._pools=RClass.create(FObjectPools);var a=this._thread=RClass.create(FThread);a.setInterval(this._interval);a.addProcessListener(this,this.onProcess);RConsole.find(FThreadConsole).start(a)},MO.FE3dModelConsole_pools=function(){return this._pools},MO.FE3dModelConsole_allocByGuid=function(a,b){var d=this._pools.alloc(b);if(d)return d;var f=RConsole.find(FE3rModelConsole).load(a,b),d=RClass.create(FE3dModel);d.linkGraphicContext(a);
d.setPoolCode(b);d.setRenderable(f);this._looper.push(d);return d},MO.FE3dModelConsole_allocByCode=function(a,b){return this._pools.alloc(b)},MO.FE3dModelConsole_free=function(a){var b=a.poolCode();this._pools.free(b,a)};
with(MO)MO.FE3dModelDisplay=function(a){a=RClass.inherits(this,a,FE3dDisplay,MLinkerResource);a._material=null;a._shapes=null;a.construct=FE3dModelDisplay_construct;a.material=FE3dModelDisplay_material;a.shapes=FE3dModelDisplay_shapes;a.load=FE3dModelDisplay_load;a.reloadResource=FE3dModelDisplay_reloadResource;a.dispose=FE3dModelDisplay_dispose;return a},MO.FE3dModelDisplay_construct=function(){this.__base.FE3dDisplay.construct.call(this);this._material=RClass.create(FE3dMaterial)},MO.FE3dModelDisplay_material=
function(){return this._material},MO.FE3dModelDisplay_shapes=function(){return this._shapes},MO.FE3dModelDisplay_load=function(a){var b=this._material,d=RConsole.find(FE3dInstanceConsole),f=this._resource=a.resource().display();this._matrix.assign(f.matrix());b.loadResource(f.material());if(a=a.geometrys())for(var f=a.count(),h=this._shapes=new TObjects,k=0;k<f;k++){var q=a.get(k),w=d.create(EE3dInstance.ModelRenderable);w.setDisplay(this);w.setMaterial(b);w.load(q);h.push(w);this.pushRenderable(w)}},
MO.FE3dModelDisplay_reloadResource=function(){var a=this._resource;this._matrix.assign(a.matrix());this._material.loadResource(a.material())},MO.FE3dModelDisplay_dispose=function(){this._material=RObject.dispose(this._material);this.__base.FE3dDisplay.dispose.call(this)};
with(MO)MO.FE3dModelRenderable=function(a){a=RClass.inherits(this,a,FE3dMeshRenderable);a._ready=!1;a._materialResource=null;a.testVisible=FE3dModelRenderable_testVisible;a.load=FE3dModelRenderable_load;return a},MO.FE3dModelRenderable_testVisible=function(a){!this._ready&&(a=this._renderable)&&(this._ready=a.testReady());return this._ready},MO.FE3dModelRenderable_load=function(a){var b=this._material,d=this._materialResource=a.material();d&&b.assignInfo(d.info());this._effectCode=b.info().effectCode;
this._renderable=a};
with(MO)MO.FE3dMovie=function(a){a=RClass.inherits(this,a,FObject,MLinkerResource);a._interval=null;a._firstTick=0;a._lastTick=0;a._matrix=null;a.construct=FE3dMovie_construct;a.loadResource=FE3dMovie_loadResource;a.reloadResource=FE3dMovie_reloadResource;a.process=FE3dMovie_process;return a},MO.FE3dMovie_construct=function(){this.__base.FObject.construct.call(this);this._matrix=new SMatrix3d},MO.FE3dMovie_loadResource=function(a){this._resource=a;this._interval=a._interval;this._matrix.setRotation(a._rotation.x,a._rotation.y*
Math.PI/180,a._rotation.z);this._matrix.update()},MO.FE3dMovie_reloadResource=function(){this.loadResource(this._resource)},MO.FE3dMovie_process=function(a){0==this._firstTick&&(this._firstTick=RTimer.current());0==this._lastTick&&(this._lastTick=RTimer.current());var b=RTimer.current(),d=b-this._lastTick;if(d>this._interval){var f=this._resource,d=d/1E3;"rotation"==this._resource.code()&&(a.ry+=f._rotation.y*d,a.updateForce());this._lastTick=b}};
with(MO)MO.FE3dRegion=function(a){a=RClass.inherits(this,a,FRegion,MGraphicObject,MG3dRegion,MLinkerResource);a._backgroundColor=null;a.construct=FE3dRegion_construct;a.backgroundColor=FE3dRegion_backgroundColor;a.loadResource=FE3dRegion_loadResource;a.reloadResource=FE3dRegion_reloadResource;a.prepare=FE3dRegion_prepare;a.dispose=FE3dRegion_dispose;return a},MO.FE3dRegion_construct=function(){this.__base.FRegion.construct.call(this);this.__base.MG3dRegion.construct.call(this);var a=this._camera=
RClass.create(FE3dCamera);a.position().set(0,0,-100);a.lookAt(0,0,0);a.update();a.projection().update();a=this._directionalLight=RClass.create(FE3dDirectionalLight);a.direction().set(0,-1,0);a=a.camera();a.position().set(10,10,-10);a.lookAt(0,0,0);(this._backgroundColor=new SColor4).set(0,0,0,1);this._calculateCameraMatrix=new SMatrix3d},MO.FE3dRegion_backgroundColor=function(){return this._backgroundColor},MO.FE3dRegion_loadResource=function(a){this._resource=a;this._camera.loadResource(a.camera());
this._directionalLight.loadResource(a.light());this.reloadResource()},MO.FE3dRegion_reloadResource=function(){var a=this._resource;a.optionBackground()?(this._backgroundColor.assignPower(a.backgroundColor()),this._backgroundColor.alpha=1):this._backgroundColor.set(0,0,0,0)},MO.FE3dRegion_prepare=function(){this.__base.MG3dRegion.prepare.call(this);this._calculateCameraMatrix.attach(this._camera.matrix())&&(this._changed=!0)},MO.FE3dRegion_dispose=function(){this.__base.FRegion.dispose.call(this);
this.__base.MG3dRegion.dispose.call(this)};
with(MO)MO.FE3dScene=function(a){a=RClass.inherits(this,a,FE3dSpace,MLinkerResource,MListenerLoad);a._ready=!1;a._dataReady=!1;a._resource=null;a._dirty=!1;a.onProcess=FE3dScene_onProcess;a.construct=FE3dScene_construct;a.createRegion=FE3dScene_createRegion;a.resource=FE3dScene_resource;a.loadTechniqueResource=FE3dScene_loadTechniqueResource;a.loadRegionResource=FE3dScene_loadRegionResource;a.loadDisplayResource=FE3dScene_loadDisplayResource;a.loadLayerResource=FE3dScene_loadLayerResource;a.loadResource=
FE3dScene_loadResource;a.testReady=FE3dScene_testReady;a.dirty=FE3dScene_dirty;a.processLoad=FE3dScene_processLoad;a.active=FE3dScene_active;a.deactive=FE3dScene_deactive;return a},MO.FE3dScene_onProcess=function(){this.__base.FE3dSpace.onProcess.call(this);if(this._dirty){for(var a=this._region.allRenderables(),b=a.count()-1;0<=b;b--)a.getAt(b).resetInfos();this._dirty=!1}},MO.FE3dScene_construct=function(){this.__base.FE3dSpace.construct.call(this)},MO.FE3dScene_createRegion=function(){return RClass.create(FE3dSceneRegion)},
MO.FE3dScene_resource=function(a){return this._resource},MO.FE3dScene_loadTechniqueResource=function(a){this._technique._resource=a},MO.FE3dScene_loadRegionResource=function(a){this._region.loadResource(a);var b=a.camera(),d=b.projection(),f=this.camera();f._resource=b;var h=f.projection();f.position().assign(b.position());f.setDirection(b.direction().x,b.direction().y,b.direction().z);f.update();h.size().assign(this._graphicContext.size());h._angle=d.angle();h._znear=d.znear();h._zfar=d.zfar();h.update();
d=a.light();a=d.camera();b=a.projection();f=this.directionalLight();f._resource=d;d=f._camera;f=d._projection;d.position().set(1,1,-1);d.lookAt(0,0,0);d.position().assign(a.position());d.update();f.size().set(1024,1024);f._angle=60;f._znear=b.znear();f._zfar=b.zfar();f.update()},MO.FE3dScene_loadDisplayResource=function(a,b){var d=RConsole.find(FE3dInstanceConsole).create(EE3dInstance.SceneDisplay);d.linkGraphicContext(this);d.loadResource(b);RConsole.find(FE3dSceneConsole).loadDisplay(d);a.pushDisplay(d)},
MO.FE3dScene_loadLayerResource=function(a){var b=RConsole.find(FE3dInstanceConsole).create(EE3dInstance.SceneLayer);b.loadResource(a);var d=a.displays();if(d)for(var f=d.count(),h=0;h<f;h++){var k=d.at(h);this.loadDisplayResource(b,k)}this.registerLayer(a.code(),b)},MO.FE3dScene_loadResource=function(a){this.selectTechnique(this,FE3dGeneralTechnique);this.loadTechniqueResource(a.technique());this.loadRegionResource(a.region());if(a=a.layers())for(var b=a.count(),d=0;d<b;d++){var f=a.at(d);this.loadLayerResource(f)}},
MO.FE3dScene_testReady=function(){return this._ready},MO.FE3dScene_dirty=function(){this._dirty=!0},MO.FE3dScene_processLoad=function(){if(this._dataReady)return!0;if(!this._resource.testReady())return!1;this.loadResource(this._resource);this._ready=!0;this.processLoadListener(this);return!0},MO.FE3dScene_active=function(){this.__base.FE3dSpace.active.call(this)},MO.FE3dScene_deactive=function(){this.__base.FE3dSpace.deactive.call(this)};
with(MO)MO.FE3dSceneAnimation=function(a){a=RClass.inherits(this,a,FE3dAnimation);a._animation=null;a._activeClip=null;a._clips=null;a.clips=FE3dSceneAnimation_clips;a.pushClip=FE3dSceneAnimation_pushClip;a.record=RMethod.empty;a.process=RMethod.empty;a.selectClip=FE3dSceneAnimation_selectClip;a.loadAnimation=FE3dSceneAnimation_loadAnimation;a.loadSceneResource=FE3dSceneAnimation_loadSceneResource;a.reloadResource=FE3dSceneAnimation_reloadResource;return a},MO.FE3dSceneAnimation_clips=function(){return this._clips},
MO.FE3dSceneAnimation_pushClip=function(a){var b=this._clips;b||(b=this._clips=new TDictionary);b.set(a.code(),a)},MO.FE3dSceneAnimation_selectClip=function(a){a=this._clips.get(a);if(this._activeClip!=a){var b=this._animation._playInfo;b.beginIndex=a.beginIndex();b.endIndex=a.endIndex();b.frameCount=b.endIndex-b.beginIndex+1;this._animation._playRate=a.playRate();this._activeClip=a}},MO.FE3dSceneAnimation_loadAnimation=function(a){this._animation=a},MO.FE3dSceneAnimation_loadSceneResource=function(a){this._resource=
a},MO.FE3dSceneAnimation_reloadResource=function(){this._animation._playRate=this._resource._playRate};
with(MO)MO.FE3dSceneAnimationClip=function(a){a=RClass.inherits(this,a,FObject,MAttributeCode);a._animation=null;a._beginIndex=0;a._endIndex=0;a._playRate=1;a.beginIndex=FE3dSceneAnimationClip_beginIndex;a.endIndex=FE3dSceneAnimationClip_endIndex;a.setRange=FE3dSceneAnimationClip_setRange;a.playRate=FE3dSceneAnimationClip_playRate;a.setPlayRate=FE3dSceneAnimationClip_setPlayRate;return a},MO.FE3dSceneAnimationClip_beginIndex=function(){return this._beginIndex},MO.FE3dSceneAnimationClip_endIndex=function(){return this._endIndex},
MO.FE3dSceneAnimationClip_setRange=function(a,b){this._beginIndex=a;this._endIndex=b},MO.FE3dSceneAnimationClip_playRate=function(){return this._playRate},MO.FE3dSceneAnimationClip_setPlayRate=function(a){this._playRate=a};
with(MO)MO.FE3dSceneCanvas=function(a){a=RClass.inherits(this,a,FE3dCanvas);a._activeSpace=null;a._captureStatus=!1;a._capturePosition=null;a._captureCameraPosition=null;a._captureCameraRotation=null;a._actionFullScreen=!1;a._actionPlay=!1;a._actionMovie=!1;a._actionUp=!1;a._actionDown=!1;a._actionForward=!1;a._actionBack=!1;a._cameraMoveRate=.4;a._cameraKeyRotation=.03;a._cameraMouseRotation=.005;a._touchTracker=null;a.onEnterFrame=FE3dSceneCanvas_onEnterFrame;a.onMouseCaptureStart=FE3dSceneCanvas_onMouseCaptureStart;
a.onMouseCapture=FE3dSceneCanvas_onMouseCapture;a.onMouseCaptureStop=FE3dSceneCanvas_onMouseCaptureStop;a.onTouchStart=FE3dSceneCanvas_onTouchStart;a.onTouchMove=FE3dSceneCanvas_onTouchMove;a.onTouchStop=FE3dSceneCanvas_onTouchStop;a.onTouchZoom=FE3dSceneCanvas_onTouchZoom;a.onDataLoaded=FE3dSceneCanvas_onDataLoaded;a.onResize=FE3dSceneCanvas_onResize;a.construct=FE3dSceneCanvas_construct;a.testPlay=FE3dSceneCanvas_testPlay;a.switchPlay=FE3dSceneCanvas_switchPlay;a.testMovie=FE3dSceneCanvas_testMovie;
a.switchMovie=FE3dSceneCanvas_switchMovie;a.doAction=FE3dSceneCanvas_doAction;a.loadByGuid=FE3dSceneCanvas_loadByGuid;a.loadByCode=FE3dSceneCanvas_loadByCode;a.dispose=FE3dSceneCanvas_dispose;return a},MO.FE3dSceneCanvas_onEnterFrame=function(){var a=this._activeSpace;if(a){var b=a.timer().spanSecond(),d=a.camera(),f=this._cameraMoveRate*b,b=this._cameraKeyRotation*b,h=RKeyboard.isPress(EStageKey.Forward),k=RKeyboard.isPress(EStageKey.Back);(h&&!k||this._actionForward)&&d.doWalk(f);(!h&&k||this._actionBack)&&
d.doWalk(-f);h=RKeyboard.isPress(EStageKey.Up);k=RKeyboard.isPress(EStageKey.Down);(h&&!k||this._actionUp)&&d.doFly(f);(!h&&k||this._actionDown)&&d.doFly(-f);f=RKeyboard.isPress(EStageKey.RotationLeft);h=RKeyboard.isPress(EStageKey.RotationRight);f&&!h&&d.doYaw(b);!f&&h&&d.doYaw(-b);f=RKeyboard.isPress(EStageKey.RotationUp);h=RKeyboard.isPress(EStageKey.RotationDown);f&&!h&&d.doPitch(b);!f&&h&&d.doPitch(-b);d.update();if(this._optionRotation){b=this._rotation;a=a.layers();d=a.count();for(f=0;f<d;f++)h=
a.at(f).matrix(),h.setRotation(0,b.y,0),h.update();b.y+=.01}}},MO.FE3dSceneCanvas_onMouseCaptureStart=function(a){var b=this._activeSpace;if(b){var d=this._activeSpace.region();RConsole.find(FG3dTechniqueConsole).find(this._graphicContext,FG3dSelectTechnique).test(d,a.offsetX,a.offsetY);this._capturePosition.set(a.clientX,a.clientY);this._captureCameraRotation.assign(b.camera()._rotation)}},MO.FE3dSceneCanvas_onMouseCapture=function(a){if(this._activeSpace){var b=a.clientX-this._capturePosition.x;
a=a.clientY-this._capturePosition.y;var d=this._activeSpace.camera().rotation(),f=this._captureCameraRotation;d.x=f.x+a*this._cameraMouseRotation;d.y=f.y+b*this._cameraMouseRotation}},MO.FE3dSceneCanvas_onMouseCaptureStop=function(a){},MO.FE3dSceneCanvas_onTouchStart=function(a){var b=this._activeSpace;if(b){this._activeSpace.region();var d=a.touches;1==d.length?(a.preventDefault(),a=d[0],this._captureStatus=!0,this._capturePosition.set(a.clientX,a.clientY),this._captureCameraPosition.assign(b.camera().position()),
this._captureCameraRotation.assign(b.camera().rotation())):this._touchTracker.eventStart(a)}},MO.FE3dSceneCanvas_onTouchMove=function(a){if(this._captureStatus){var b=a.touches,d=b.length;1==d?(a.preventDefault(),a=b[0],b=this._activeSpace.camera().rotation(),d=a.clientX-this._capturePosition.x,b.x=this._captureCameraRotation.x+-(a.clientY-this._capturePosition.y)*this._cameraMouseRotation,b.y=this._captureCameraRotation.y+-d*this._cameraMouseRotation):1<d&&this._touchTracker.eventMove(a)}},MO.FE3dSceneCanvas_onTouchStop=
function(a){this._touchTracker.eventStop(a);this._captureStatus=!1},MO.FE3dSceneCanvas_onTouchZoom=function(a){a=a.delta;var b=this._activeSpace;b&&b.camera().doForward(.006*a)},MO.FE3dSceneCanvas_onDataLoaded=function(a){var b=this._activeSpace;a=this._graphicContext.size();var d=b.camera().projection();d.size().set(a.width,a.height);d.update();a=b._region._resource;this._cameraMoveRate=a.moveSpeed();this._cameraKeyRotation=a.rotationKeySpeed();this._cameraMouseRotation=a.rotationMouseSpeed();a=
new SEvent(this);a.space=b;this.processLoadListener(a);a.dispose()},MO.FE3dSceneCanvas_onResize=function(a){this.__base.FE3dCanvas.onResize.call(this,a);a=this._graphicContext.size();var b=this._activeSpace;b&&(b=b.camera().projection(),b.size().set(a.width,a.height),b.update())},MO.FE3dSceneCanvas_construct=function(){this.__base.FE3dCanvas.construct.call(this);this._rotation=new SVector3;this._capturePosition=new SPoint2;this._captureCameraPosition=new SPoint3;this._captureCameraRotation=new SVector3;
this._touchTracker=RClass.create(FTouchTracker);this._touchTracker.addTouchZoomListener(this,this.onTouchZoom)},MO.FE3dSceneCanvas_testPlay=function(){return this._actionPlay},MO.FE3dSceneCanvas_switchPlay=function(a){for(var b=this._activeSpace.allDisplays(),d=b.count(),f=0;f<d;f++){var h=b.at(f);if(RClass.isClass(h,FE3dSceneDisplay)){var k=h._sprite;k&&(k._optionPlay=a);h._optionPlay=a}}this._actionPlay=a},MO.FE3dSceneCanvas_testMovie=function(){return this._actionMovie},MO.FE3dSceneCanvas_switchMovie=
function(a){for(var b=this._activeSpace.allDisplays(),d=b.count(),f=0;f<d;f++){var h=b.get(f);h._movies&&(h._optionMovie=a)}this._actionMovie=a},MO.FE3dSceneCanvas_doAction=function(a,b,d){if(this._activeSpace)switch(a.preventDefault(),this._actionBack=this._actionForward=this._actionDown=this._actionUp=!1,b){case "fullscreen":a=this._actionFullScreen=!this._actionFullScreen;RHtml.fullscreen(this._hPanel,a);break;case "play":this.switchMovie(!this._actionMovie);this.switchPlay(this._actionMovie);
break;case "up":this._actionUp=d;break;case "down":this._actionDown=d;break;case "forward":this._actionForward=d;break;case "back":this._actionBack=d}},MO.FE3dSceneCanvas_loadByGuid=function(a){var b=RConsole.find(FE3dSceneConsole);this._activeSpace&&b.free(this._activeSpace);a=this._activeSpace=b.allocByGuid(this._graphicContext,a);a.addLoadListener(this,this.onDataLoaded);RStage.register("canvas.space",a)},MO.FE3dSceneCanvas_loadByCode=function(a){var b=RConsole.find(FE3dSceneConsole);this._activeSpace&&
b.free(this._activeSpace);a=this._activeSpace=b.allocByCode(this._graphicContext,a);a.addLoadListener(this,this.onDataLoaded);RStage.register("canvas.space",a)},MO.FE3dSceneCanvas_dispose=function(){var a=this._rotation;a&&(a.dispose(),this._rotation=null);this.__base.FE3dCanvas.dispose.call(this)};
with(MO)MO.FE3dSceneConsole=function(a){a=RClass.inherits(this,a,FConsole);a._scopeCd=EScope.Local;a._loadDisplays=null;a._loadScenes=null;a._pools=null;a._thread=null;a._interval=100;a.onProcess=FE3dSceneConsole_onProcess;a.construct=FE3dSceneConsole_construct;a.scenes=FE3dSceneConsole_scenes;a.loadDisplay=FE3dSceneConsole_loadDisplay;a.allocByGuid=FE3dSceneConsole_allocByGuid;a.allocByCode=FE3dSceneConsole_allocByCode;a.free=FE3dSceneConsole_free;return a},MO.FE3dSceneConsole_onProcess=function(){var a=
this._loadDisplays;for(a.record();a.next();)a.current().processLoad()&&a.removeCurrent();a=this._loadScenes;for(a.record();a.next();)a.current().processLoad()&&a.removeCurrent()},MO.FE3dSceneConsole_construct=function(){this._loadDisplays=new TLooper;this._loadScenes=new TLooper;this._pools=RClass.create(FObjectPools);var a=this._thread=RClass.create(FThread);a.setInterval(this._interval);a.addProcessListener(this,this.onProcess);RConsole.find(FThreadConsole).start(a)},MO.FE3dSceneConsole_scenes=
function(){return this._scenes},MO.FE3dSceneConsole_loadDisplay=function(a){this._loadDisplays.push(a)},MO.FE3dSceneConsole_allocByGuid=function(a,b){var d=this._pools.alloc(b);if(d)return d;var f=RConsole.find(FE3sSceneConsole).loadByGuid(b),d=RClass.create(FE3dScene);d.linkGraphicContext(a);d.setResource(f);d._poolCode=b;d.setup();this._loadScenes.push(d);return d},MO.FE3dSceneConsole_allocByCode=function(a,b){var d=this._pools.alloc(b);if(d)return d;var f=RConsole.find(FE3sSceneConsole).loadByCode(b),
d=RClass.create(FE3dScene);d.linkGraphicContext(a);d.setResource(f);d._poolCode=b;d.setup();this._loadScenes.push(d);return d},MO.FE3dSceneConsole_free=function(a){this._pools.free(a._poolCode,a)};
with(MO)MO.FE3dSceneDisplay=function(a){a=RClass.inherits(this,a,FE3dSprite,MListenerLoad);a._dataReady=!1;a._optionPlay=!1;a._optionMovie=!1;a._movieMatrix=null;a._resource=null;a._materials=null;a._parentMaterials=null;a._template=null;a._sprite=null;a.construct=FE3dSceneDisplay_construct;a.calculateOutline=FE3dSceneDisplay_calculateOutline;a.meshRenderables=FE3dSceneDisplay_meshRenderables;a.loadResource=FE3dSceneDisplay_loadResource;a.loadTemplate=FE3dSceneDisplay_loadTemplate;a.processLoad=FE3dSceneDisplay_processLoad;
a.clone=FE3dSceneDisplay_clone;return a},MO.FE3dSceneDisplay_construct=function(){this.__base.FE3dSprite.construct.call(this);this._movieMatrix=new SMatrix3d},MO.FE3dSceneDisplay_calculateOutline=function(){return this._sprite.calculateOutline()},MO.FE3dSceneDisplay_meshRenderables=function(){return this._template.sprite().meshRenderables()},MO.FE3dSceneDisplay_loadResource=function(a){var b=RConsole.find(FE3dInstanceConsole);this._resource=a;this._code=a.code();this._matrix.assign(a.matrix());var d=
a.movies();if(d)for(var f=d.count(),h=0;h<f;h++){var k=d.at(h),q=b.create(EE3dInstance.SceneMovie);q.loadResource(k);this.pushMovie(q)}if(d=a.materials())for(f=d.count(),k=this._materials=new TDictionary,q=this._parentMaterials=new TDictionary,h=0;h<f;h++){var w=d.at(h),x=b.create(EE3dInstance.SceneMaterial);x._display=this;x.loadSceneResource(w);k.set(w.guid(),x);q.set(w.parentGuid(),x)}a=a.templateGuid();this._template=RConsole.find(FE3dTemplateConsole).allocByGuid(this,a)},MO.FE3dSceneDisplay_loadTemplate=
function(a){var b=this._resource,d=a._sprites;if(d)for(var f=this._optionPlay,h=d.count(),k=0;k<h;k++){var q=d.at(k);q._optionPlay=f;q.matrix().identity()}d=this._parentMaterials;q=this._sprite=a.sprite();f=q.renderables();h=f.count();for(a=0;a<h;a++){var k=f.at(a),w=k.material(),x=w.guid();d&&(x=d.get(x))&&(x.loadParent(w),x.reloadResource(),k.setMaterial(x))}this.pushDisplay(q);if(h=q.animations())for(q=h.count(),a=0;a<q;a++)d=h.at(a),k=d.resource(),w=k.guid(),f=b.findAnimation(w),f||(f=b.syncAnimation(w),
f._guid=k._guid,f._code=k._code,f._label=k._label),k=RClass.create(FE3dSceneAnimation),k.loadAnimation(d),k.loadSceneResource(f),k.reloadResource(),this.pushAnimation(k)},MO.FE3dSceneDisplay_processLoad=function(){if(this._ready)return!0;var a=this._template;if(!a.testReady())return!1;this.loadTemplate(a);this._ready=!0;this.processLoadListener(this);return!0},MO.FE3dSceneDisplay_clone=function(){};
with(MO)MO.FE3dSceneDisplayRenderable=function(a){a=RClass.inherits(this,a,FE3dTemplateRenderable);a.loadMaterial=FE3dSceneDisplayRenderable_loadMaterial;a.reloadResource=FE3dSceneDisplayRenderable_reloadResource;return a},MO.FE3dSceneDisplayRenderable_loadMaterial=function(a){this._materialReference=a;this._material.calculate(a)},MO.FE3dSceneDisplayRenderable_reloadResource=function(){var a=this._material;a.calculate(this._materialReference);a.update()};
with(MO)MO.FE3dSceneLayer=function(a){a=RClass.inherits(this,a,FDisplayLayer,MLinkerResource);a.makeLabel=FE3dSceneLayer_makeLabel;a.loadResource=FE3dSceneLayer_loadResource;a.process=FE3dSceneLayer_process;return a},MO.FE3dSceneLayer_makeLabel=function(){var a=this.resource(),b=a.code();return(a=a.label())?b+"["+a+"]":b},MO.FE3dSceneLayer_loadResource=function(a){this._resource=a},MO.FE3dSceneLayer_process=function(a){this.__base.FDisplayLayer.process.call(this,a);var b=this._resource.transformCd();
b&&b==EDisplayTransform.CameraPosition&&(a=a.camera().position(),this._matrix.setTranslate(a.x,a.y,a.z),this._matrix.update())};
with(MO)MO.FE3dSceneMaterial=function(a){a=RClass.inherits(this,a,FE3dMaterial);a._display=null;a._parentMaterial=null;a.loadSceneResource=FE3dSceneMaterial_loadSceneResource;a.reloadResource=FE3dSceneMaterial_reloadResource;return a},MO.FE3dSceneMaterial_loadSceneResource=function(a){this._resource=a;this.reloadResource()},MO.FE3dSceneMaterial_reloadResource=function(){this.calculate(this._resource);this.update()};
with(MO)MO.FE3dSceneRegion=function(a){a=RClass.inherits(this,a,FE3dRegion);a._resource=null;a.construct=FE3dSceneRegion_construct;a.resource=FE3dSceneRegion_resource;a.loadResource=FE3dSceneRegion_loadResource;a.reloadResource=FE3dSceneRegion_reloadResource;a.dispose=FE3dSceneRegion_dispose;return a},MO.FE3dSceneRegion_construct=function(){this.__base.FE3dRegion.construct.call(this)},MO.FE3dSceneRegion_resource=function(){return this._resource},MO.FE3dSceneRegion_loadResource=function(a){this._resource=
a;this.reloadResource()},MO.FE3dSceneRegion_reloadResource=function(){var a=this._resource;a.optionBackground()?(this._backgroundColor.assignPower(a.backgroundColor()),this._backgroundColor.alpha=1):this._backgroundColor.set(0,0,0,0)},MO.FE3dSceneRegion_dispose=function(){this._resource=null;this.__base.FE3dRegion.dispose.call(this)};
with(MO)MO.FE3dSimpleCanvas=function(a){a=RClass.inherits(this,a,FE3dCanvas);a._activeSpace=null;a._captureStatus=!1;a._capturePosition=null;a._captureCameraPosition=null;a._captureCameraRotation=null;a._actionFullScreen=!1;a._actionPlay=!1;a._actionMovie=!1;a._actionUp=!1;a._actionDown=!1;a._actionForward=!1;a._actionBack=!1;a._cameraMoveRate=.4;a._cameraKeyRotation=.03;a._cameraMouseRotation=.005;a.onEnterFrame=FE3dSimpleCanvas_onEnterFrame;a.onMouseCaptureStart=FE3dSimpleCanvas_onMouseCaptureStart;
a.onMouseCapture=FE3dSimpleCanvas_onMouseCapture;a.onMouseCaptureStop=FE3dSimpleCanvas_onMouseCaptureStop;a.onTouchStart=FE3dSimpleCanvas_onTouchStart;a.onTouchMove=FE3dSimpleCanvas_onTouchMove;a.onTouchStop=FE3dSimpleCanvas_onTouchStop;a.onSceneLoad=FE3dSimpleCanvas_onSceneLoad;a.onResize=FE3dSimpleCanvas_onResize;a.construct=FE3dSimpleCanvas_construct;a.switchPlay=FE3dSimpleCanvas_switchPlay;a.switchMovie=FE3dSimpleCanvas_switchMovie;a.doAction=FE3dSimpleCanvas_doAction;a.dispose=FE3dSimpleCanvas_dispose;
return a},MO.FE3dSimpleCanvas_onEnterFrame=function(){var a=this._activeSpace;if(a){var b=a.camera(),d=this._cameraMoveRate,f=this._cameraKeyRotation,h=RKeyboard.isPress(EKeyCode.W),k=RKeyboard.isPress(EKeyCode.S);(h&&!k||this._actionForward)&&b.doWalk(d);(!h&&k||this._actionBack)&&b.doWalk(-d);h=RKeyboard.isPress(EKeyCode.A);k=RKeyboard.isPress(EKeyCode.D);h&&!k&&b.doYaw(f);!h&&k&&b.doYaw(-f);h=RKeyboard.isPress(EKeyCode.Q);k=RKeyboard.isPress(EKeyCode.E);(h&&!k||this._actionUp)&&b.doFly(d);(!h&&
k||this._actionDown)&&b.doFly(-d);d=RKeyboard.isPress(EKeyCode.Z);h=RKeyboard.isPress(EKeyCode.X);d&&!h&&b.doPitch(f);!d&&h&&b.doPitch(-f);b.update();if(this._optionRotation){f=this._rotation;a=a.layers();b=a.count();for(d=0;d<b;d++)h=a.value(d).matrix(),h.setRotation(0,f.y,0),h.update();f.y+=.01}}},MO.FE3dSimpleCanvas_onMouseCaptureStart=function(a){var b=this._activeSpace;b&&(this._capturePosition.set(a.clientX,a.clientY),this._captureCameraRotation.assign(b.camera()._rotation))},MO.FE3dSimpleCanvas_onMouseCapture=
function(a){if(this._activeSpace){var b=a.clientX-this._capturePosition.x;a=a.clientY-this._capturePosition.y;var d=this._activeSpace.camera().rotation(),f=this._captureCameraRotation;d.x=f.x+a*this._cameraMouseRotation;d.y=f.y+b*this._cameraMouseRotation}},MO.FE3dSimpleCanvas_onMouseCaptureStop=function(a){},MO.FE3dSimpleCanvas_onTouchStart=function(a){var b=this._activeSpace;if(b){this._activeSpace.region();var d=a.touches;1==d.length&&(a.preventDefault(),a=d[0],this._captureStatus=!0,this._capturePosition.set(a.clientX,
a.clientY),this._captureCameraPosition.assign(b.camera().position()),this._captureCameraRotation.assign(b.camera().rotation()))}},MO.FE3dSimpleCanvas_onTouchMove=function(a){if(this._captureStatus){var b=a.touches;if(1==b.length){a.preventDefault();a=b[0];var b=this._activeSpace.camera().rotation(),d=a.clientX-this._capturePosition.x;b.x=this._captureCameraRotation.x+-(a.clientY-this._capturePosition.y)*this._cameraMouseRotation;b.y=this._captureCameraRotation.y+-d*this._cameraMouseRotation}}},MO.FE3dSimpleCanvas_onTouchStop=
function(a){this._captureStatus=!1},MO.FE3dSimpleCanvas_onSceneLoad=function(a){a=this._activeSpace;var b=this._graphicContext.size(),d=a.camera().projection();d.size().set(b.width,b.height);d.update();b=a._region._resource;this._cameraMoveRate=b.moveSpeed();this._cameraKeyRotation=b.rotationKeySpeed();this._cameraMouseRotation=b.rotationMouseSpeed();this.processLoadListener(this,a)},MO.FE3dSimpleCanvas_onResize=function(a){this.__base.FE3dCanvas.onResize.call(this,a);a=this._graphicContext.size();
var b=this._activeSpace;b&&(b=b.camera().projection(),b.size().set(a.width,a.height),b.update())},MO.FE3dSimpleCanvas_construct=function(){this.__base.FE3dCanvas.construct.call(this);this._rotation=new SVector3;this._capturePosition=new SPoint2;this._captureCameraPosition=new SPoint3;this._captureCameraRotation=new SVector3},MO.FE3dSimpleCanvas_switchPlay=function(a){for(var b=this._activeSpace.allDisplays(),d=b.count(),f=0;f<d;f++){var h=b.get(f);h._movies&&(h._optionPlay=a)}this._actionPlay=a},
MO.FE3dSimpleCanvas_switchMovie=function(a){for(var b=this._activeSpace.allDisplays(),d=b.count(),f=0;f<d;f++){var h=b.get(f);h._movies&&(h._optionMovie=a)}this._actionMovie=a},MO.FE3dSimpleCanvas_doAction=function(a,b,d){if(this._activeSpace)switch(a.preventDefault(),this._actionBack=this._actionForward=this._actionDown=this._actionUp=!1,b){case "fullscreen":a=this._actionFullScreen=!this._actionFullScreen;RHtml.fullscreen(this._hPanel,a);break;case "play":this.switchMovie(!this._actionMovie);this.switchPlay(this._actionMovie);
break;case "up":this._actionUp=d;break;case "down":this._actionDown=d;break;case "forward":this._actionForward=d;break;case "back":this._actionBack=d}},MO.FE3dSimpleCanvas_dispose=function(){var a=this._rotation;a&&(a.dispose(),this._rotation=null);this.__base.FE3dCanvas.dispose.call(this)};
with(MO)MO.FE3dSimpleStage=function(a){a=RClass.inherits(this,a,FE3dStage);a._optionKeyboard=!0;a._skyLayer=null;a._mapLayer=null;a._spriteLayer=null;a._faceLayer=null;a.construct=FE3dSimpleStage_construct;a.skyLayer=FE3dSimpleStage_skyLayer;a.mapLayer=FE3dSimpleStage_mapLayer;a.spriteLayer=FE3dSimpleStage_spriteLayer;a.faceLayer=FE3dSimpleStage_faceLayer;a.active=FE3dSimpleStage_active;a.deactive=FE3dSimpleStage_deactive;return a},MO.FE3dSimpleStage_construct=function(){this.__base.FE3dStage.construct.call(this);
var a=this._skyLayer=RClass.create(FDisplayLayer);this.registerLayer("SkyLayer",a);a=this._mapLayer=RClass.create(FDisplayLayer);this.registerLayer("MapLayer",a);a=this._spriteLayer=RClass.create(FDisplayLayer);this.registerLayer("SpriteLayer",a);a=this._faceLayer=RClass.create(FDisplayLayer);this.registerLayer("FaceLayer",a)},MO.FE3dSimpleStage_skyLayer=function(){return this._skyLayer},MO.FE3dSimpleStage_mapLayer=function(){return this._mapLayer},MO.FE3dSimpleStage_spriteLayer=function(){return this._spriteLayer},
MO.FE3dSimpleStage_faceLayer=function(){return this._faceLayer},MO.FE3dSimpleStage_active=function(){this.__base.FE3dStage.active.call(this)},MO.FE3dSimpleStage_deactive=function(){this.__base.FE3dStage.deactive.call(this)};
with(MO)MO.FE3dSpace=function(a){a=RClass.inherits(this,a,FE3dStage,MListenerLoad);a._dataReady=!1;a._resource=null;a._materials=null;a._dirty=!1;a.onProcess=FE3dSpace_onProcess;a.construct=FE3dSpace_construct;a.linkGraphicContext=FE3dSpace_linkGraphicContext;a.createRegion=FE3dSpace_createRegion;a.resource=FE3dSpace_resource;a.findMaterial=FE3dSpace_findMaterial;a.materials=FE3dSpace_materials;a.loadTechniqueResource=FE3dSpace_loadTechniqueResource;a.loadRegionResource=FE3dSpace_loadRegionResource;
a.loadDisplayResource=FE3dSpace_loadDisplayResource;a.loadLayerResource=FE3dSpace_loadLayerResource;a.loadResource=FE3dSpace_loadResource;a.commitResource=FE3dSpace_commitResource;a.dirty=FE3dSpace_dirty;a.processLoad=FE3dSpace_processLoad;a.active=FE3dSpace_active;a.deactive=FE3dSpace_deactive;return a},MO.FE3dSpace_onProcess=function(){this.__base.FE3dStage.onProcess.call(this);if(this._dirty){for(var a=this._region.allRenderables(),b=a.count()-1;0<=b;b--)a.getAt(b).resetInfos();this._dirty=!1}},
MO.FE3dSpace_construct=function(){this.__base.FE3dStage.construct.call(this);this._materials=new TDictionary},MO.FE3dSpace_linkGraphicContext=function(a){this.__base.FE3dStage.linkGraphicContext.call(this,a);this._region.linkGraphicContext(a)},MO.FE3dSpace_createRegion=function(){return RClass.create(FE3dRegion)},MO.FE3dSpace_resource=function(a){return this._resource},MO.FE3dSpace_findMaterial=function(a){return this._materials.get(a)},MO.FE3dSpace_materials=function(a){return this._materials},MO.FE3dSpace_loadTechniqueResource=
function(a){this._technique._resource=a},MO.FE3dSpace_loadRegionResource=function(a){this._region.loadResource(a);var b=a.camera();b.projection();var d=this.camera();d.projection().size().assign(this._graphicContext.size());d.loadResource(b);d=a.light();a=d.camera();var b=a.projection(),f=this.directionalLight();f._resource=d;d=f._camera;f=d._projection;d.position().set(1,1,-1);d.lookAt(0,0,0);d.position().assign(a.position());d.update();f.size().set(1024,1024);f._angle=60;f._znear=b.znear();f._zfar=
b.zfar();f.update()},MO.FE3dSpace_loadDisplayResource=function(a,b){var d=RConsole.find(FE3dSpaceConsole).factory().create(EE3dScene.Display);d.linkGraphicContext(this);d.loadSceneResource(b);RConsole.find(FE3dTemplateConsole).loadByGuid(d,b.templateGuid());a.pushDisplay(d)},MO.FE3dSpace_loadLayerResource=function(a){var b=RConsole.find(FE3dSpaceConsole).factory().create(EE3dScene.Layer);b.loadResource(a);var d=a.displays();if(d)for(var f=d.count(),h=0;h<f;h++){var k=d.get(h);this.loadDisplayResource(b,
k)}this.registerLayer(a.code(),b)},MO.FE3dSpace_loadResource=function(a){this._resource=a;this.loadTechniqueResource(a.technique());this.loadRegionResource(a.region());var b=a.materials();if(b)for(var d=b.count(),f=RConsole.find(FE3rMaterialConsole),h=0;h<d;h++){var k=b.at(h).guid(),q=f.load(this,k);this._materials.set(k,q)}if(a=a.layers())for(b=a.count(),h=0;h<b;h++)d=a.at(h),this.loadLayerResource(d)},MO.FE3dSpace_commitResource=function(){this._region.camera().commitResource()},MO.FE3dSpace_dirty=
function(){this._dirty=!0},MO.FE3dSpace_processLoad=function(){if(this._dataReady)return!0;if(!this._resource.testReady())return!1;this.loadResource(this._resource);this.processLoadListener(this);return!0},MO.FE3dSpace_active=function(){this.__base.FE3dStage.active.call(this)},MO.FE3dSpace_deactive=function(){this.__base.FE3dStage.deactive.call(this)};
with(MO)MO.FE3dSprite=function(a){a=RClass.inherits(this,a,FE3dDisplayContainer,MGraphicObject,MLinkerResource);a._dataReady=!1;a._ready=!1;a._shapes=null;a._skeletons=null;a._animations=null;a._movies=null;a._resource=null;a.construct=FE3dSprite_construct;a.testReady=FE3dSprite_testReady;a.makeLabel=FE3dSprite_makeLabel;a.findMeshByCode=FE3dSprite_findMeshByCode;a.meshRenderables=FE3dSprite_shapes;a.skeletons=FE3dSprite_skeletons;a.pushSkeleton=FE3dSprite_pushSkeleton;a.findAnimation=FE3dSprite_findAnimation;
a.animations=FE3dSprite_animations;a.pushAnimation=FE3dSprite_pushAnimation;a.movies=FE3dSprite_movies;a.pushMovie=FE3dSprite_pushMovie;a.loadSkeletons=FE3dSprite_loadSkeletons;a.linkAnimation=FE3dSprite_linkAnimation;a.loadAnimations=FE3dSprite_loadAnimations;a.loadResource=FE3dSprite_loadResource;a.reloadResource=FE3dSprite_reloadResource;a.load=FE3dSprite_load;a.updateMatrix=FE3dSprite_updateMatrix;a.selectClip=FE3dSprite_selectClip;a.process=FE3dSprite_process;a.dispose=FE3dSprite_dispose;return a},
MO.FE3dSprite_construct=function(){this.__base.FE3dDisplayContainer.construct.call(this);this._shapes=new TObjects},MO.FE3dSprite_testReady=function(){var a=this._shapes;if(a)for(var b=a.count(),d=0;d<b;d++)if(!a.at(d).testReady())return!1;return!0},MO.FE3dSprite_makeLabel=function(){var a=this.resource(),b=a.code();return(a=a.label())?b+"["+a+"]":b},MO.FE3dSprite_findMeshByCode=function(a){for(var b=this._shapes,d=b.count()-1;0<=d;d--){var f=b.getAt(d);if(f._renderable._resource._code==a)return f}return null},
MO.FE3dSprite_shapes=function(){return this._shapes},MO.FE3dSprite_skeletons=function(){return this._skeletons},MO.FE3dSprite_pushSkeleton=function(a){var b=this._skeletons;b||(b=this._skeletons=new TDictionary);this._activeSkeleton||(this._activeSkeleton=a);b.set(a._resource.guid(),a)},MO.FE3dSprite_findAnimation=function(a){var b=this._animations;return b?b.get(a):null},MO.FE3dSprite_animations=function(){return this._animations},MO.FE3dSprite_pushAnimation=function(a){var b=this._animations;b||
(b=this._animations=new TDictionary);var d=a.resource();b.set(d.guid(),a)},MO.FE3dSprite_movies=function(){return this._movies},MO.FE3dSprite_pushMovie=function(a){var b=this._movies;b||(b=this._movies=new TObjects);b.push(a)},MO.FE3dSprite_loadSkeletons=function(a){var b=a.count();if(0<b){this.skeletons();for(var d=0;d<b;d++){var f=a.getAt(d),h=RClass.create(FE3rSkeleton);h.loadResource(f);this.pushSkeleton(h)}}},MO.FE3dSprite_linkAnimation=function(a){a=a.tracks();for(var b=a.count(),d=0;d<b;d++){var f=
a.getAt(d),h=f._resource._meshCode;h&&(this.findMeshByCode(h)._activeTrack=f)}},MO.FE3dSprite_loadAnimations=function(a){var b=a.count();if(0<b)for(var d=0;d<b;d++){var f=a.getAt(d),h=this.findAnimation(f.guid());h||(h=f.skeleton()?RClass.create(FE3rSkeletonAnimation):RClass.create(FE3rMeshAnimation),h._display=this,h.loadResource(f),this.pushAnimation(h))}},MO.FE3dSprite_loadResource=function(a){this._resource=a;this._matrix.assign(a.matrix());a=a.renderables();var b=a.count();if(0<b)for(var d=this._shapes,
f=0;f<b;f++){var h=a.at(f),k=RClass.create(FE3dTemplateRenderable);k._display=this;k.linkGraphicContext(this);k.loadResource(h);d.push(k);this.pushRenderable(k)}},MO.FE3dSprite_reloadResource=function(){var a=this._shapes;if(a)for(var b=a.count(),d=0;d<b;d++)a.getAt(d).reloadResource()},MO.FE3dSprite_load=function(){var a=this._shapes;if(a)for(var b=a.count(),d=0;d<b;d++)a.at(d).load()},MO.FE3dSprite_updateMatrix=function(a){a=this._currentMatrix.identity();var b=this._movies;if(b){if(this._optionMovie)for(var d=
b.count(),f=0;f<d;f++)b.at(f).process(this._movieMatrix);a.append(this._movieMatrix)}a.append(this._matrix);(a=this._parent)&&this._currentMatrix.append(a._currentMatrix)},MO.FE3dSprite_selectClip=function(a){var b=this._animations;if(b)for(var d=b.count(),f=0;f<d;f++)b.at(f).selectClip(a)},MO.FE3dSprite_process=function(a){var b=this._animations;if(b)for(var d=b.count(),f=0;f<d;f++){var h=b.at(f);h.record()}this.__base.FE3dDisplayContainer.process.call(this,a);if((a=this._activeSkeleton)&&b)for(d=
b.count(),f=0;f<d;f++)h=b.at(f),h.process(a)},MO.FE3dSprite_dispose=function(){this._shapes=RObject.dispose(this._shapes);this.__base.FE3dDisplayContainer.dispose.call(this)};
with(MO)MO.FE3dTemplate=function(a){a=RClass.inherits(this,a,FE3dSpace,MGraphicObject,MListenerLoad);a._dataReady=!1;a._ready=!1;a._resource=null;a._sprites=null;a._skeletons=null;a._animations=null;a._resource=null;a.construct=FE3dTemplate_construct;a.testReady=FE3dTemplate_testReady;a.sprite=FE3dTemplate_sprite;a.findMeshByCode=FE3dTemplate_findMeshByCode;a.meshRenderables=FE3dTemplate_sprites;a.skeletons=FE3dTemplate_skeletons;a.pushSkeleton=FE3dTemplate_pushSkeleton;a.findAnimation=FE3dTemplate_findAnimation;
a.animations=FE3dTemplate_animations;a.pushAnimation=FE3dTemplate_pushAnimation;a.visible=FE3dTemplate_visible;a.setVisible=FE3dTemplate_setVisible;a.resource=FE3dTemplate_resource;a.setResource=FE3dTemplate_setResource;a.loadSkeletons=FE3dTemplate_loadSkeletons;a.linkAnimation=FE3dTemplate_linkAnimation;a.loadAnimations=FE3dTemplate_loadAnimations;a.loadResource=FE3dTemplate_loadResource;a.reloadResource=FE3dTemplate_reloadResource;a.processLoad=FE3dTemplate_processLoad;a.process=FE3dTemplate_process;
a.dispose=FE3dTemplate_dispose;return a},MO.FE3dTemplate_construct=function(){this.__base.FE3dSpace.construct.call(this);var a=this._layer=RClass.create(FDisplayLayer);this.registerLayer("Layer",a);this._sprites=new TObjects},MO.FE3dTemplate_testReady=function(){return this._ready},MO.FE3dTemplate_sprite=function(){return this._sprites.first()},MO.FE3dTemplate_findMeshByCode=function(a){for(var b=this._sprites,d=b.count()-1;0<=d;d--){var f=b.getAt(d);if(f._renderable._resource._code==a)return f}return null},
MO.FE3dTemplate_sprites=function(){return this._sprites},MO.FE3dTemplate_skeletons=function(){return this._skeletons},MO.FE3dTemplate_pushSkeleton=function(a){var b=this._skeletons;b||(b=this._skeletons=new TDictionary);this._activeSkeleton||(this._activeSkeleton=a);b.set(a._resource.guid(),a)},MO.FE3dTemplate_findAnimation=function(a){var b=this._animations;return b?b.get(a):null},MO.FE3dTemplate_animations=function(){return this._animations},MO.FE3dTemplate_pushAnimation=function(a){var b=this._animations;
b||(b=this._animations=new TDictionary);var d=a.resource();b.set(d.guid(),a)},MO.FE3dTemplate_visible=function(){return this.sprite().visible()},MO.FE3dTemplate_setVisible=function(a){this.sprite().setVisible(a)},MO.FE3dTemplate_resource=function(a){return this._resource},MO.FE3dTemplate_setResource=function(a){this._resource=a},MO.FE3dTemplate_loadSkeletons=function(a){var b=a.count();if(0<b){this.skeletons();for(var d=0;d<b;d++){var f=a.getAt(d),h=RClass.create(FE3rSkeleton);h.loadResource(f);this.pushSkeleton(h)}}},
MO.FE3dTemplate_linkAnimation=function(a){a=a.tracks();for(var b=a.count(),d=0;d<b;d++){var f=a.getAt(d),h=f._resource._meshCode;h&&(this.findMeshByCode(h)._activeTrack=f)}},MO.FE3dTemplate_loadAnimations=function(a){var b=a.count();if(0<b)for(var d=0;d<b;d++){var f=a.getAt(d),h=this.findAnimation(f.guid());h||(h=f.skeleton()?RClass.create(FE3rSkeletonAnimation):RClass.create(FE3rMeshAnimation),h._display=this,h.loadResource(f),this.pushAnimation(h))}},MO.FE3dTemplate_loadResource=function(a){this.selectTechnique(this,
FE3dGeneralTechnique).setResource(a.technique());this.__base.FE3dSpace.loadResource.call(this,a);if(a=a.displays()){var b=a.count();if(0<b)for(var d=0;d<b;d++){var f=a.at(d),h=RClass.create(FE3dTemplateDisplay);h._parent=this;h.linkGraphicContext(this);h.loadResource(f);this._sprites.push(h)}}},MO.FE3dTemplate_reloadResource=function(){var a=this._sprites;if(a)for(var b=a.count(),d=0;d<b;d++)a.getAt(d).reloadResource()},MO.FE3dTemplate_processLoad=function(){if(this._ready)return!0;if(!this._dataReady){var a=
this._resource;if(!a.testReady())return!1;this.loadResource(a);this._dataReady=!0}var b=this._sprites;if(b){for(var d=b.count(),a=0;a<d;a++){var f=b.at(a);if(!f.testReady())return!1}for(a=0;a<d;a++)f=b.at(a),f.load(),this._layer.pushDisplay(f)}if(b=this._animations)for(d=b.count(),a=0;a<d;a++)f=b.at(a),null==f.resource().skeleton()&&this.linkAnimation(f);this._ready=!0;this.processLoadListener(this);return this._ready},MO.FE3dTemplate_process=function(a){this.__base.FE3dSpace.process.call(this)},
MO.FE3dTemplate_dispose=function(){this._sprites=RObject.dispose(this._sprites);this.__base.FE3dSpace.dispose.call(this)};
with(MO)MO.FE3dTemplateCanvas=function(a){a=RClass.inherits(this,a,FE3dCanvas);a._activeTemplate=null;a._capturePosition=null;a._captureRotation=null;a.onEnterFrame=FDsSceneCanvas_onEnterFrame;a.onMouseCaptureStart=FE3dTemplateCanvas_onMouseCaptureStart;a.onMouseCapture=FE3dTemplateCanvas_onMouseCapture;a.onMouseCaptureStop=FE3dTemplateCanvas_onMouseCaptureStop;a.onResize=FE3dTemplateCanvas_onResize;a.onTemplateLoad=FE3dTemplateCanvas_onTemplateLoad;a.construct=FE3dTemplateCanvas_construct;a.build=
FE3dTemplateCanvas_build;a.load=FE3dTemplateCanvas_load;a.setPanel=FE3dTemplateCanvas_setPanel;a.dispose=FE3dTemplateCanvas_dispose;return a},MO.FE3dTemplateCanvas_onEnterFrame=function(){var a=this._activeTemplate;if(a){var b=a.camera(),d=.05,f=RKeyboard.isPress(EKeyCode.W),h=RKeyboard.isPress(EKeyCode.S);f&&!h&&b.doWalk(.5);!f&&h&&b.doWalk(-.5);f=RKeyboard.isPress(EKeyCode.A);h=RKeyboard.isPress(EKeyCode.D);f&&!h&&b.doYaw(d);!f&&h&&b.doYaw(-d);f=RKeyboard.isPress(EKeyCode.Q);h=RKeyboard.isPress(EKeyCode.E);
f&&!h&&b.doFly(.5);!f&&h&&b.doFly(-.5);h=RKeyboard.isPress(EKeyCode.Z);f=RKeyboard.isPress(EKeyCode.X);h&&!f&&b.doPitch(d);!h&&f&&b.doPitch(-d);b.update();if(this._optionRotation){d=this._rotation;a=a.layers();b=a.count();for(f=0;f<b;f++)h=a.value(f).matrix(),h.setRotation(0,d.y,0),h.update();d.y+=.01}}},MO.FE3dTemplateCanvas_onMouseCaptureStart=function(a){var b=this._activeTemplate;if(b){var d=this._activeTemplate.region();RConsole.find(FG3dTechniqueConsole).find(this._context,FG3dSelectTechnique).test(d,
a.offsetX,a.offsetY);this._capturePosition.set(a.clientX,a.clientY);this._captureRotation.assign(b.camera()._rotation)}},MO.FE3dTemplateCanvas_onMouseCapture=function(a){if(this._activeTemplate){var b=a.clientX-this._capturePosition.x;a=a.clientY-this._capturePosition.y;var d=this._activeTemplate.camera().rotation(),f=this._captureRotation;d.x=f.x+.003*a;d.y=f.y+.003*b}},MO.FE3dTemplateCanvas_onMouseCaptureStop=function(a){},MO.FE3dTemplateCanvas_onResize=function(){var a=this._hPanel,b=a.offsetWidth,
a=a.offsetHeight,d=this._hCanvas;d.width=b;d.height=a;this._context.setViewport(0,0,b,a)},MO.FE3dTemplateCanvas_onTemplateLoad=function(a){a=this._activeTemplate;var b=this._context.size(),d=a.camera().projection();d.size().set(b.width,b.height);d.update();this.processLoadListener(this,a)},MO.FE3dTemplateCanvas_construct=function(){this.__base.FObject.construct.call(this);this._rotation=new SVector3;this._capturePosition=new SPoint2;this._captureRotation=new SVector3},MO.FE3dTemplateCanvas_build=
function(a){a=this._hCanvas=RBuilder.create(a,"CANVAS");a.__linker=this;this._context=REngine3d.createContext(FWglContext,a);RStage.lsnsEnterFrame.register(this,this.onEnterFrame);RStage.start(1E3/60);RWindow.lsnsResize.register(this,this.onResize);RConsole.find(FMouseConsole).register(this)},MO.FE3dTemplateCanvas_load=function(a){var b=this._context,d=RConsole.find(FE3dSceneConsole);null!=this._activeTemplate&&d.free(this._activeTemplate);a=d.alloc(this._context,a);a.addLoadListener(this,this.onTemplateLoad);
a.selectTechnique(b,FG3dGeneralTechnique);this._stage=this._activeTemplate=a;RStage.register("stage3d",a)},MO.FE3dTemplateCanvas_setPanel=function(a){this._hPanel=a;a.appendChild(this._hCanvas);this.onResize()},MO.FE3dTemplateCanvas_dispose=function(){var a=this._rotation;a&&(a.dispose(),this._rotation=null);this.__base.FObject.dispose.call(this)};
with(MO)MO.FE3dTemplateConsole=function(a){a=RClass.inherits(this,a,FConsole);a._scopeCd=EScope.Local;a._loadQueue=null;a._pools=null;a._thread=null;a._interval=200;a.onProcess=FE3dTemplateConsole_onProcess;a.construct=FE3dTemplateConsole_construct;a.allocByGuid=FE3dTemplateConsole_allocByGuid;a.allocByCode=FE3dTemplateConsole_allocByCode;a.free=FE3dTemplateConsole_free;return a},MO.FE3dTemplateConsole_onProcess=function(){var a=this._loadQueue;for(a.record();a.next();)a.current().processLoad()&&
a.removeCurrent()},MO.FE3dTemplateConsole_construct=function(){this._loadQueue=new TLooper;this._pools=RClass.create(FObjectPools);var a=this._thread=RClass.create(FThread);a.setInterval(this._interval);a.addProcessListener(this,this.onProcess);RConsole.find(FThreadConsole).start(a)},MO.FE3dTemplateConsole_allocByGuid=function(a,b){var d=this._pools.alloc(b);if(d)return d;var f=RConsole.find(FE3sTemplateConsole).loadByGuid(b),d=RClass.create(FE3dTemplate);d.linkGraphicContext(a);d.setResource(f);
d._poolCode=b;this._loadQueue.push(d);return d},MO.FE3dTemplateConsole_allocByCode=function(a,b){var d=this._pools.alloc(b);if(d)return d;var f=RConsole.find(FE3sTemplateConsole).loadByCode(b),d=RClass.create(FE3dTemplate);d.linkGraphicContext(a);d.setResource(f);d._poolCode=b;this._loadQueue.push(d);return d},MO.FE3dTemplateConsole_free=function(a){this._pools.free(a._poolCode,a)};
with(MO)MO.FE3dTemplateDisplay=function(a){a=RClass.inherits(this,a,FE3dSprite,MListenerLoad);a._dataReady=!1;a._ready=!1;a._shapes=null;a._skeletons=null;a.construct=FE3dTemplateDisplay_construct;a.testReady=FE3dTemplateDisplay_testReady;a.findMeshByCode=FE3dTemplateDisplay_findMeshByCode;a.meshRenderables=FE3dTemplateDisplay_shapes;a.skeletons=FE3dTemplateDisplay_skeletons;a.pushSkeleton=FE3dTemplateDisplay_pushSkeleton;a.loadSkeletons=FE3dTemplateDisplay_loadSkeletons;a.linkAnimation=FE3dTemplateDisplay_linkAnimation;
a.loadAnimations=FE3dTemplateDisplay_loadAnimations;a.loadResource=FE3dTemplateDisplay_loadResource;a.reloadResource=FE3dTemplateDisplay_reloadResource;a.load=FE3dTemplateDisplay_load;a.dispose=FE3dTemplateDisplay_dispose;return a},MO.FE3dTemplateDisplay_construct=function(){this.__base.FE3dSprite.construct.call(this);this._shapes=new TObjects},MO.FE3dTemplateDisplay_testReady=function(){var a=this._shapes;if(a)for(var b=a.count(),d=0;d<b;d++)if(!a.at(d).testReady())return!1;return!0},MO.FE3dTemplateDisplay_findMeshByCode=
function(a){for(var b=this._shapes,d=b.count()-1;0<=d;d--){var f=b.getAt(d);if(f._renderable._resource._code==a)return f}return null},MO.FE3dTemplateDisplay_shapes=function(){return this._shapes},MO.FE3dTemplateDisplay_skeletons=function(){return this._skeletons},MO.FE3dTemplateDisplay_pushSkeleton=function(a){var b=a.resource().guid(),d=this._skeletons;d||(d=this._skeletons=new TDictionary);this._activeSkeleton||(this._activeSkeleton=a);d.set(b,a)},MO.FE3dTemplateDisplay_loadSkeletons=function(a){var b=
a.count();if(0<b)for(var d=0;d<b;d++){var f=a.at(d),h=RClass.create(FE3rSkeleton);h.loadResource(f);this.pushSkeleton(h)}},MO.FE3dTemplateDisplay_linkAnimation=function(a){a=a.tracks();for(var b=a.count(),d=0;d<b;d++){var f=a.at(d),h=f._resource._meshCode;h&&(this.findMeshByCode(h)._activeTrack=f)}},MO.FE3dTemplateDisplay_loadAnimations=function(a){for(var b=a.count(),d=0;d<b;d++){var f=a.at(d),h=f.guid(),h=this.findAnimation(h);h||(h=f.skeleton()?RClass.create(FE3rSkeletonAnimation):RClass.create(FE3rMeshAnimation),
h._display=this,h.loadResource(f),this.pushAnimation(h))}},MO.FE3dTemplateDisplay_loadResource=function(a){this._resource=a;var b=RConsole.find(FE3dInstanceConsole);this._matrix.assign(a.matrix());if(a=a.renderables())for(var d=this._shapes,f=a.count(),h=0;h<f;h++){var k=a.at(h),q=b.create(EE3dInstance.TemplateRenderable);q._display=this;q.linkGraphicContext(this);q.loadResource(k);d.push(q);this.pushRenderable(q)}},MO.FE3dTemplateDisplay_reloadResource=function(){var a=this._shapes;if(a)for(var b=
a.count(),d=0;d<b;d++)a.at(d).reloadResource()},MO.FE3dTemplateDisplay_load=function(){var a=this._shapes;if(a)for(var b=a.count(),d=0;d<b;d++)a.at(d).load();if(a=this._animations)for(b=a.count(),d=0;d<b;d++){var f=a.at(d);null==f.resource().skeleton()&&this.linkAnimation(f)}},MO.FE3dTemplateDisplay_dispose=function(){this._shapes=RObject.dispose(this._shapes);this.__base.FE3dSprite.dispose.call(this)};
with(MO)MO.FE3dTemplateRenderable=function(a){a=RClass.inherits(this,a,FE3dMeshRenderable,MLinkerResource);a._ready=!1;a._model=null;a._materialCode=null;a._materialResource=null;a.construct=FE3dTemplateRenderable_construct;a.testReady=FE3dTemplateRenderable_testReady;a.testVisible=FE3dTemplateRenderable_testVisible;a.calculateOutline=FE3dTemplateRenderable_calculateOutline;a.loadResource=FE3dTemplateRenderable_loadResource;a.reloadResource=FE3dTemplateRenderable_reloadResource;a.load=FE3dTemplateRenderable_load;
a.dispose=FE3dTemplateRenderable_dispose;return a},MO.FE3dTemplateRenderable_construct=function(){this.__base.FE3dMeshRenderable.construct.call(this)},MO.FE3dTemplateRenderable_testReady=function(){if(!this._ready){if(!this._model.testReady())return!1;var a=this._materials;if(a)for(var b=a.count(),d=0;d<b;d++){var f=a.at(d);if(f&&!f.testReady())return!1}this._ready=!0}return this._ready},MO.FE3dTemplateRenderable_testVisible=function(a){a=!1;this._ready&&(a=this.__base.FE3dMeshRenderable.testVisible.call(this));
return a},MO.FE3dTemplateRenderable_calculateOutline=function(){var a=this._outline;if(a.isEmpty()){var b=this._resource.mesh().outline();a.assign(b)}return a},MO.FE3dTemplateRenderable_loadResource=function(a){this._resource=a;this._matrix.assign(a.matrix());var b=a.modelGuid();this._model=RConsole.find(FE3rModelConsole).load(this,b);var d=a.materialGuid();RString.isEmpty(d)||(d=this._material=this._materialReference=RConsole.find(FE3rMaterialConsole).load(this,d),this._materialResource=d.resource(),
this.pushMaterial(d));b=this._display._parent;if(a=a.materialRefers())for(var f=a.count(),h=0;h<f;h++)d=a.at(h).guid(),d=b.findMaterial(d),this.pushMaterial(d),this._material=d;this._material||(this._material=this._materialReference=RClass.create(FE3dMaterial))},MO.FE3dTemplateRenderable_reloadResource=function(){var a=this._material;a.calculate(this._materialResource);a.update()},MO.FE3dTemplateRenderable_load=function(){var a=this._display,b=this._resource,d=b.model(),f=this._material.bitmaps();
if(f)for(var h=f.count(),k=0;k<h;k++){var q=f.at(k);this.pushTexture(q)}(k=d.skeletons())&&a.loadSkeletons(k);(k=d.animations())&&a.loadAnimations(k);b.mesh();k=b.meshGuid();b=this._renderable=RConsole.find(FE3rModelConsole).findMesh(k);d=b.vertexBuffers();f=d.count();for(k=0;k<f;k++)h=d.at(k),this._vertexBuffers.set(h.code(),h);if(k=b.skins()){a=a._activeSkeleton;b=this._activeSkin=k.first();d=b.streams();f=d.count();for(k=0;k<f;k++)h=d.at(k).buffer(),this._vertexBuffers.set(h.code(),h);b=b.resource().boneRefers();
d=b.count();if(0<d)for(f=this._bones=new TObjects,k=0;k<d;k++){h=b.at(k).index();h=a.bones().get(h);if(!h)throw new TError(this,"Bone is not exist.");f.push(h)}}this._ready=!0},MO.FE3dTemplateRenderable_dispose=function(){this.__base.FE3dMeshRenderable.dispose.call(this)};with(MO)MO.SE3dRulerPrecision=function(a){a=this;a.interval=1;a.length=.5;a.color=new SColor4(255,255,255,255);return a},MO.SE3dRulerPrecision_assign=function(a){this.interval.assign(a.interval);this.color.assign(a.color)};
with(MO)MO.SE3dRulerStyle=function(a){a=this;a.lineColor=new SColor4(255,255,255,255);a.bothLength=.5;a.bothColor=new SColor4(255,255,255,255);a.tickInterval=1;a.tickLength=.3;a.tickColor=new SColor4(255,255,255,255);a.precisions=new TObjects;a.assign=SE3dRulerStyle_assign;return a},MO.SE3dRulerStyle=function(a){this.lineColor.assign(a.lineColor);this.bothLength=a.bothLength;this.bothColor.assign(a.lineColor);this.tickInterval=a.tickInterval;this.tickLength=a.tickLength;this.tickColor.assign(a.lineColor);
this.precisions.assign(a.precisions)};
with(MO)MO.FE3dBoundBox=function(a){a=RClass.inherits(this,a,FE3dRenderable);a._outline=null;a._rate=.2;a._vertexPositionBuffer=null;a._vertexColorBuffer=null;a.construct=FE3dBoundBox_construct;a.outline=FE3dBoundBox_outline;a.setup=FE3dBoundBox_setup;a.upload=FE3dBoundBox_upload;return a},MO.FE3dBoundBox_construct=function(){this.__base.FE3dRenderable.construct.call(this);this._material=RClass.create(FE3dMaterial);this._outline=new SOutline3},MO.FE3dBoundBox_outline=function(){return this._outline},
MO.FE3dBoundBox_setup=function(){var a=this._graphicContext,b=this._vertexPositionBuffer=a.createVertexBuffer();b.setCode("position");b.setFormatCd(EG3dAttributeFormat.Float3);this.pushVertexBuffer(b);for(var d=new Uint8Array(128),b=127;0<=b;b--)d[b]=255;b=this._vertexColorBuffer=a.createVertexBuffer();b.setCode("color");b.setFormatCd(EG3dAttributeFormat.Byte4Normal);b.upload(d,4,32);this.pushVertexBuffer(b);this._vertexCount=32;b=this._indexBuffer=a.createIndexBuffer();b.setFillModeCd(EG3dFillMode.Line);
b.upload([0,1,0,4,0,12,3,2,3,5,3,13,8,6,8,9,8,14,11,7,11,10,11,15,20,16,20,21,20,24,23,17,23,22,23,25,28,18,28,26,28,29,31,19,31,27,31,30],48);this.update();a=this.material().info();a.effectCode="control";a.ambientColor.set(1,1,1,1)},MO.FE3dBoundBox_upload=function(){var a=this._outline,b=a.max,d=b.x,f=b.y,b=b.z,h=a.min,a=h.x,k=h.y,h=h.z,q=this._rate,w=(d-a)*q,x=(f-k)*q,q=(b-h)*q;this._vertexPositionBuffer.upload([a,f,h,a+w,f,h,d-w,f,h,d,f,h,a,f-x,h,d,f-x,h,a,k+x,h,d,k+x,h,a,k,h,a+w,k,h,d-w,k,h,d,
k,h,a,f,h+q,d,f,h+q,a,k,h+q,d,k,h+q,a,f,b-q,d,f,b-q,a,k,b-q,d,k,b-q,a,f,b,a+w,f,b,d-w,f,b,d,f,b,a,f-x,b,d,f-x,b,a,k+x,b,d,k+x,b,a,k,b,a+w,k,b,d-w,k,b,d,k,b],12,32)};
with(MO)MO.FE3dCube=function(a){a=RClass.inherits(this,a,FE3dRenderable);a.vertexPositionBuffer=null;a.vertexColorBuffer=null;a.indexBuffer=null;a.setup=FE3dCube_setup;return a},MO.FE3dCube_setup=function(a){this.vertexPositionBuffer=a.createVertexBuffer();this.vertexPositionBuffer.upload([-1,1,-1,1,1,-1,1,-1,-1,-1,-1,-1,-1,1,1,1,1,1,1,-1,1,-1,-1,1],12,8);this.vertexColorBuffer=a.createVertexBuffer();this.vertexColorBuffer.upload([0,1,0,1,1,0,0,1,1,0,0,1,0,0,0,1,0,1,0,1,1,0,1,1,1,0,1,1,0,0,1,1],16,
8);this.indexBuffer=context.createIndexBuffer();this.indexBuffer.upload([0,1,2,0,2,3,1,5,6,1,6,2,5,4,7,5,7,6,4,0,3,4,3,7,0,4,5,0,5,1,3,2,6,3,6,7],36);a=this.material().info();a.effectCode="control";a.ambientColor.set(1,1,1,1)};
with(MO)MO.FE3dDimensional=function(a){a=RClass.inherits(this,a,FE3dRenderable);a._cellSize=null;a._size=null;a._lineColor=null;a._lineCenterColor=null;a._vertexPositionBuffer=null;a._vertexColorBuffer=null;a.construct=FE3dDimensional_construct;a.setup=FE3dDimensional_setup;return a},MO.FE3dDimensional_construct=function(){this.__base.FE3dRenderable.construct.call(this);this._material=RClass.create(FE3dMaterial);this._cellSize=new SSize2;this._cellSize.set(1,1);this._size=new SSize2;this._size.set(16,
16)},MO.FE3dDimensional_setup=function(){for(var a=this._graphicContext,b=this._cellSize.width,d=this._cellSize.height,f=this._size.width,h=f/2,k=this._size.height,q=k/2,w=2*(f+2+(k+2)),x=0,y=0,z=new Float32Array(3*w),A=0,D=new Uint8Array(4*w),B=0,E=new Uint16Array(w),F=0;F<=k;F++){var C=1;0==F-q&&(C=0);z[x++]=b*-h*C;z[x++]=0;z[x++]=d*(F-q);z[x++]=b*h*C;z[x++]=0;z[x++]=d*(F-q);for(C=0;8>C;C++)D[A++]=255;E[B++]=y++;E[B++]=y++}z[x++]=b*-h;z[x++]=0;z[x++]=0;z[x++]=b*h;z[x++]=0;for(C=z[x++]=0;2>C;C++)D[A++]=
255,D[A++]=0,D[A++]=0,D[A++]=255;E[B++]=y++;E[B++]=y++;for(k=0;k<=f;k++){C=1;0==k-h&&(C=0);z[x++]=b*(k-h);z[x++]=0;z[x++]=d*-q*C;z[x++]=b*(k-h);z[x++]=0;z[x++]=d*q*C;for(C=0;8>C;C++)D[A++]=255;E[B++]=y++;E[B++]=y++}z[x++]=0;z[x++]=0;z[x++]=d*-q;z[x++]=0;z[x++]=0;z[x++]=d*q;for(C=0;2>C;C++)D[A++]=255,D[A++]=0,D[A++]=0,D[A++]=255;E[B++]=y++;E[B++]=y++;this._vertexCount=w;b=this._vertexPositionBuffer=a.createVertexBuffer();b._name="position";b._formatCd=EG3dAttributeFormat.Float3;b.upload(z,12,w);this._vertexBuffers.set(b._name,
b);b=this._vertexColorBuffer=a.createVertexBuffer();b._name="color";b._formatCd=EG3dAttributeFormat.Byte4Normal;b.upload(D,4,w);this._vertexBuffers.set(b._name,b);a=this._indexBuffer=a.createIndexBuffer();a._fillMode=EG3dFillMode.Line;a.upload(E,w);w=this.material().info();w.effectCode="control";w.ambientColor.set(1,1,1,1)};with(MO)MO.FE3dPolygon=function(a){return a=RClass.inherits(this,a,FE3dRenderable)};
with(MO)MO.FE3dRectangle=function(a){a=RClass.inherits(this,a,FE3dRenderable);a._vertexPositionBuffer=null;a._vertexColorBuffer=null;a._indexBuffer=null;a.setup=FE3dRectangle_setup;return a},MO.FE3dRectangle_setup=function(a){this._vertexPositionBuffer=a.createVertexBuffer();this._vertexPositionBuffer.upload([-1,1,0,1,1,0,1,-1,0,-1,-1,0],12,4);this._vertexColorBuffer=a.createVertexBuffer();this._vertexColorBuffer.upload([0,1,0,1,1,0,0,1,1,0,0,1,0,0,0,1],16,4);this._indexBuffer=context.createIndexBuffer();
this._indexBuffer.upload([0,1,2,0,2,3],6)};
with(MO)MO.FE3dRuler=function(a){a=RClass.inherits(this,a,FE3dRenderable);a._style=null;a._beginPoint=null;a._endPoint=null;a._direction=null;a._directionLine=null;a._vertexPositionBuffer=null;a._vertexColorBuffer=null;a._vertexPositionData=null;a._vertexColorData=null;a._indexData=null;a.construct=FE3dRuler_construct;a.style=FE3dRuler_style;a.beginPoint=FE3dRuler_beginPoint;a.endPoint=FE3dRuler_endPoint;a.direction=FE3dRuler_direction;a.setup=FE3dRuler_setup;a.upload=FE3dRuler_upload;return a},MO.FE3dRuler_construct=
function(){this.__base.FE3dRenderable.construct.call(this);this._material=RClass.create(FE3dMaterial);this._style=new SE3dRulerStyle;this._beginPoint=new SPoint3(0,0,0);this._endPoint=new SPoint3(0,10,0);this._direction=new SVector3(1,0,0);this._directionLine=new SVector3;this._vertexPositionData=new TArray;this._vertexColorData=new TArray;this._indexData=new TArray},MO.FE3dRuler_style=function(){return this._style},MO.FE3dRuler_beginPoint=function(){return this._beginPoint},MO.FE3dRuler_endPoint=
function(){return this._endPoint},MO.FE3dRuler_direction=function(){return this._direction},MO.FE3dRuler_setup=function(){var a=this._graphicContext,b=this._vertexPositionBuffer=a.createVertexBuffer();b.setCode("position");b.setFormatCd(EG3dAttributeFormat.Float3);this.pushVertexBuffer(b);b=this._vertexColorBuffer=a.createVertexBuffer();b.setCode("color");b.setFormatCd(EG3dAttributeFormat.Byte4Normal);this.pushVertexBuffer(b);b=this._indexBuffer=a.createIndexBuffer();b.setFillModeCd(EG3dFillMode.Line);
b.setLineWidth(1);this.upload();this.update();a=this.material().info();a.effectCode="control";a.ambientColor.set(1,1,1,1)},MO.FE3dRuler_upload=function(){var a=0,b=this._style,d=this._vertexPositionData;d.clear();var f=this._vertexColorData;f.clear();var h=this._indexData;h.clear();var k=this._beginPoint,q=this._endPoint;d.push(k.x,k.y,k.z);f.push(255,255,255,255);a++;d.push(q.x,q.y,q.z);f.push(255,255,255,255);a++;h.push(0,1);var w=b.bothLength,x=b.bothColor,y=this._direction,z=new SPoint3,A=new SPoint3;
d.push(k.x,k.y,k.z);f.push(x.red,x.green,x.blue,x.alpha);A.x=y.x*w+k.x;A.y=y.y*w+k.y;A.z=y.z*w+k.z;d.push(A.x,A.y,A.z);f.push(x.red,x.green,x.blue,x.alpha);h.push(a,a+1);a+=2;d.push(q.x,q.y,q.z);f.push(x.red,x.green,x.blue,x.alpha);A.x=y.x*w+q.x;A.y=y.y*w+q.y;A.z=y.z*w+q.z;d.push(A.x,A.y,A.z);f.push(x.red,x.green,x.blue,x.alpha);h.push(a,a+1);a+=2;q=this._directionLine.direction(k,this._endPoint);w=q.length();q.normalize();for(var b=b.precisions,x=b.count(),D=0;D<x;D++)for(var B=b.at(D),E=B.interval,
F=B.length,B=B.color,C=E;C<w;C+=E)z.x=q.x*C+k.x,z.y=q.y*C+k.y,z.z=q.z*C+k.z,d.push(z.x,z.y,z.z),f.push(B.red,B.green,B.blue,B.alpha),A.x=y.x*F+z.x,A.y=y.y*F+z.y,A.z=y.z*F+z.z,d.push(A.x,A.y,A.z),f.push(B.red,B.green,B.blue,B.alpha),h.push(a,a+1),a+=2;this._vertexPositionBuffer.upload(d.memory(),12,a);this._vertexColorBuffer.upload(f.memory(),4,a);this._indexBuffer.upload(h.memory(),h.length())};
with(MO)MO.FE3dRulerBox=function(a){a=RClass.inherits(this,a,FE3dSprite);a._outline=null;a._style=null;a._rulerX=null;a._rulerY=null;a._rulerZ=null;a.construct=FE3dRulerBox_construct;a.style=FE3dRulerBox_style;a.outline=FE3dRulerBox_outline;a.setup=FE3dRulerBox_setup;a.upload=FE3dRulerBox_upload;return a},MO.FE3dRulerBox_construct=function(){this.__base.FE3dSprite.construct.call(this);this._material=RClass.create(FE3dMaterial);this._style=new SE3dRulerStyle;this._outline=new SOutline3;var a=this._rulerX=
RClass.create(FE3dRuler);this.pushRenderable(a);a=this._rulerY=RClass.create(FE3dRuler);this.pushRenderable(a);a=this._rulerZ=RClass.create(FE3dRuler);this.pushRenderable(a)},MO.FE3dRulerBox_style=function(){return this._style},MO.FE3dRulerBox_outline=function(){return this._outline},MO.FE3dRulerBox_setup=function(){var a=this._graphicContext,b=this._style;this.matrix().setScaleAll(.1);this.matrix().update();var d=this._outline,f=d.min,d=d.max,h=this._rulerX;h.linkGraphicContext(a);h.style().assign(b);
h.beginPoint().assign(f);h.endPoint().set(d.x,f.y,f.z);h.direction().set(0,0,-1);h.setup();h=this._rulerY;h.linkGraphicContext(a);h.style().assign(b);h.beginPoint().assign(f);h.endPoint().set(f.x,d.y,f.z);h.direction().set(-1,0,0);h.setup();h=this._rulerZ;h.linkGraphicContext(a);h.style().assign(b);h.beginPoint().assign(f);h.endPoint().set(f.x,f.y,d.z);h.direction().set(-1,0,0);h.setup()},MO.FE3dRulerBox_upload=function(){this._rulerX.upload();this._rulerY.upload();this._rulerZ.upload()};
with(MO)MO.FE3dSphere=function(a){a=RClass.inherits(this,a,FE3dRenderable);a._outline=null;a._splitCount=8;a._vertexPositionBuffer=null;a._vertexColorBuffer=null;a.construct=FE3dSphere_construct;a.splitCount=FE3dSphere_splitCount;a.setSplitCount=FE3dSphere_setSplitCount;a.setup=FE3dSphere_setup;return a},MO.FE3dSphere_construct=function(){this.__base.FE3dRenderable.construct.call(this);this._material=RClass.create(FE3dMaterial);this._outline=new SOutline3},MO.FE3dSphere_splitCount=function(){return this._splitCount},
MO.FE3dSphere_setSplitCount=function(a){this._splitCount=a},MO.FE3dSphere_setup=function(){for(var a=this._graphicContext,b=new TArray,d=new TArray,f=2*this._splitCount,h=this._splitCount,k=2*Math.PI/f,q=Math.PI/h,w=0,x=0;x<=h;x++)for(var y=0;y<f;y++){var z=k*y-Math.PI,A=q*x-RConst.PI_2,D=Math.sin(z)*Math.cos(A),B=Math.sin(A),z=-Math.cos(z)*Math.cos(A);b.push(D,B,z);d.push(D,B,z);w++}this._vertexCount=w;x=this._vertexPositionBuffer=a.createVertexBuffer();x._name="position";x._formatCd=EG3dAttributeFormat.Float3;
x.upload(new Float32Array(b.memory()),12,w);this._vertexBuffers.set(x._name,x);x=this._vertexColorBuffer=a.createVertexBuffer();x._name="normal";x._formatCd=EG3dAttributeFormat.Float3;x.upload(new Float32Array(d.memory()),12,w);this._vertexBuffers.set(x._name,x);b=new TArray;for(x=0;x<h;x++)for(y=0;y<f;y++)d=f*x,w=d+y,k=d+y+f,y==f-1?(b.push(w,k,d),b.push(k,d+f,d)):(b.push(w,k,w+1),b.push(k,k+1,w+1));(this._indexBuffer=a.createIndexBuffer()).upload(new Uint16Array(b.memory()),b.length());this.update();
a=this.material().info();a.ambientColor.set(.2,.2,.2,1);a.diffuseColor.set(.8,.8,.8,1);a.specularColor.set(.8,.8,.8,1);a.specularLevel=64};
