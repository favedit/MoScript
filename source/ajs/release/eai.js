MO.EEaiChapter=new function(){this.Loading="loading";this.Login="login";this.Scene="scene";this.Chart="chart";return this};MO.EEaiConstant=new function(){this.ServiceHost="eai.logic.service";this.Resource="eai.resource";return this};MO.EEaiRate=new function(){this.Line=0;this.Map=1;this.Investment=2;this.InvestmentRange=3;return this};
MO.EEaiScene=new function(){this.Group="group";this.GroupReport="group.report";this.Company="company";this.Country="country";this.ChartTotal="chart.total";this.ChartHistory="chart.history";this.ChartLive="chart.live";this.ChartIndustry="chart.industry";this.ChartInvestment="chart.investment";this.ChartCustomer="chart.customer";return this};MO.Eai=new function(){this.Canvas=this.Application=null;return this};MO.FEaiEntity=function(a){return a=MO.Class.inherits(this,a,MO.FObject,MO.MGraphicObject)};
with(MO)MO.FEaiTable=function(a){a=RClass.inherits(this,a,FObject);a._headLineCount=0;a._hTable=null;a.createRow=FEaiTable_createRow;a.setDataCount=FEaiTable_setDataCount;a.dataRow=FEaiTable_dataRow;return a},MO.FEaiTable_createRow=function(){},MO.FEaiTable_setDataCount=function(a){for(var b=this._headLineCount,c=b+a,d=this._hTable.rows.length,e=d;e<c;e++)this.createRow();d=this._hTable.rows.length;for(e=b;e<d;e++)this._hTable.rows[e].style.display=e-b<a?null:"none"},MO.FEaiTable_dataRow=function(a){return this._hTable.rows[this._headLineCount+
a]};MO.FEaiCardResource=function(a){a=MO.Class.inherits(this,a,MO.FObject);a._code=MO.Class.register(a,new MO.AGetter("_code"));a._cityCode=MO.Class.register(a,new MO.AGetter("_cityCode"));a.unserialize=MO.FEaiCardResource_unserialize;return a};MO.FEaiCardResource_unserialize=function(a){this._code=a.readUint16();this._cityCode=a.readUint16()};
MO.FEaiCardResourceConsole=function(a){a=MO.Class.inherits(this,a,MO.FConsole);a._cards=MO.Class.register(a,new MO.AGetter("_cards"));a.construct=MO.FEaiCardResourceConsole_construct;a.find=MO.FEaiCardResourceConsole_find;a.findCityCode=MO.FEaiCardResourceConsole_findCityCode;a.unserialize=MO.FEaiCardResourceConsole_unserialize;a.dispose=MO.FEaiCardResourceConsole_dispose;return a};MO.FEaiCardResourceConsole_construct=function(){this.__base.FConsole.construct.call(this);this._cards=new MO.TDictionary};
MO.FEaiCardResourceConsole_find=function(a){return this._cards.get(a)};MO.FEaiCardResourceConsole_findCityCode=function(a){var b=null;(a=this._cards.get(a))&&(b=a.cityCode());return b};MO.FEaiCardResourceConsole_unserialize=function(a){for(var b=this._cards,c=a.readInt32(),d=0;d<c;d++){var e=MO.Class.create(MO.FEaiCardResource);e.unserialize(a);b.set(e.code(),e)}};MO.FEaiCardResourceConsole_dispose=function(){this._cards=MO.Lang.Object.dispose(this._cards);this.__base.FConsole.dispose.call(this)};
MO.FEaiCityResource=function(a){a=MO.Class.inherits(this,a,MO.FObject);a._provinceCode=MO.Class.register(a,new MO.AGetter("_provinceCode"));a._code=MO.Class.register(a,new MO.AGetter("_code"));a._label=MO.Class.register(a,new MO.AGetter("_label"));a._level=MO.Class.register(a,new MO.AGetter("_level"));a._location=MO.Class.register(a,new MO.AGetter("_location"));a.construct=MO.FEaiCityResource_construct;a.unserialize=MO.FEaiCityResource_unserialize;a.dispose=MO.FEaiCityResource_dispose;return a};
MO.FEaiCityResource_construct=function(){this.__base.FObject.construct.call(this);this._location=new MO.SPoint3};MO.FEaiCityResource_unserialize=function(a){this._provinceCode=a.readUint16();this._code=a.readUint16();this._label=a.readString();this._level=a.readUint16();this._location.unserialize2(a)};MO.FEaiCityResource_dispose=function(){this._location=RObject.dispose(this._location);this.__base.FObject.dispose.call(this)};
MO.FEaiCityResourceConsole=function(a){a=MO.Class.inherits(this,a,MO.FConsole);a._resourceConsole=MO.Class.register(a,new MO.AGetSet("_resourceConsole"));a._citys=MO.Class.register(a,new MO.AGetter("_citys"));a.construct=MO.FEaiCityResourceConsole_construct;a.find=MO.FEaiCityResourceConsole_find;a.findByCard=MO.FEaiCityResourceConsole_findByCard;a.unserialize=MO.FEaiCityResourceConsole_unserialize;a.dispose=MO.FEaiCityResourceConsole_dispose;return a};
MO.FEaiCityResourceConsole_construct=function(){this.__base.FConsole.construct.call(this);this._citys=new MO.TDictionary};MO.FEaiCityResourceConsole_find=function(a){return this._citys.get(a)};MO.FEaiCityResourceConsole_findByCard=function(a){var b=null;(a=this._resourceConsole.cardConsole().findCityCode(a))&&(b=this._citys.get(a));return b};
MO.FEaiCityResourceConsole_unserialize=function(a){for(var b=this._citys,c=a.readInt32(),d=0;d<c;d++){var e=MO.Class.create(MO.FEaiCityResource);e.unserialize(a);b.set(e.code(),e)}};MO.FEaiCityResourceConsole_dispose=function(){this._citys=MO.Lang.Object.dispose(this._citys);this.__base.FConsole.dispose.call(this)};
with(MO)MO.FEaiHistoryCityResource=function(a){a=RClass.inherits(this,a,FObject);a._code=RClass.register(a,new AGetSet("_code"));a._investmentDay=RClass.register(a,new AGetSet("_investmentDay"));a._investmentTotal=RClass.register(a,new AGetSet("_investmentTotal"));a.unserialize=FEaiHistoryCityResource_unserialize;return a},MO.FEaiHistoryCityResource_unserialize=function(a){this._code=a.readUint16();this._investmentDay=a.readFloat();this._investmentTotal=a.readFloat()};
with(MO)MO.FEaiHistoryDateResource=function(a){a=RClass.inherits(this,a,FObject);a._code=RClass.register(a,new AGetter("_code"));a._investmentDay=RClass.register(a,new AGetter("_investmentDay"));a._investmentTotal=RClass.register(a,new AGetter("_investmentTotal"));a._provinces=RClass.register(a,new AGetter("_provinces"));a._citys=RClass.register(a,new AGetter("_citys"));a.construct=FEaiHistoryDateResource_construct;a.unserialize=FEaiHistoryDateResource_unserialize;a.dispose=FEaiHistoryDateResource_dispose;
return a},MO.FEaiHistoryDateResource_construct=function(){this.__base.FObject.construct.call(this);this._provinces=new TDictionary;this._citys=new TDictionary},MO.FEaiHistoryDateResource_unserialize=function(a){this._code=a.readString();this._investmentDay=a.readFloat();this._investmentTotal=a.readFloat();for(var b=this._provinces,c=a.readInt32(),d=0;d<c;d++){var e=RClass.create(FEaiHistoryProvinceResource);e.unserialize(a);b.set(e.code(),e)}b=this._citys;c=a.readInt32();for(d=0;d<c;d++)e=RClass.create(FEaiHistoryCityResource),
e.unserialize(a),b.set(e.code(),e)},MO.FEaiHistoryDateResource_dispose=function(){this._provinces=RObject.dispose(this._provinces);this._citys=RObject.dispose(this._citys);this.__base.FObject.dispose.call(this)};
with(MO)MO.FEaiHistoryMilestoneResource=function(a){a=RClass.inherits(this,a,FObject);a._code=RClass.register(a,new AGetSet("_code"));a._investmentTotal=RClass.register(a,new AGetSet("_investmentTotal"));a._dayCount=RClass.register(a,new AGetSet("_dayCount"));a._companyCount=RClass.register(a,new AGetSet("_companyCount"));a._staffCount=RClass.register(a,new AGetSet("_staffCount"));a.unserialize=FEaiHistoryMilestoneResource_unserialize;return a},MO.FEaiHistoryMilestoneResource_unserialize=function(a){this._code=
a.readString();this._investmentTotal=a.readFloat();this._dayCount=a.readUint16();this._companyCount=a.readUint16();this._staffCount=a.readUint16()};
with(MO)MO.FEaiHistoryProvinceResource=function(a){a=RClass.inherits(this,a,FObject);a._code=RClass.register(a,new AGetSet("_code"));a._investmentDay=RClass.register(a,new AGetSet("_investmentDay"));a._investmentTotal=RClass.register(a,new AGetSet("_investmentTotal"));a.unserialize=FEaiHistoryProvinceResource_unserialize;return a},MO.FEaiHistoryProvinceResource_unserialize=function(a){this._code=a.readUint16();this._investmentDay=a.readFloat();this._investmentTotal=a.readFloat()};
MO.FEaiHistoryResourceConsole=function(a){a=MO.Class.inherits(this,a,MO.FConsole,MO.MListener);a._investmentDay=MO.Class.register(a,new MO.AGetter("_investmentDay"));a._investmentTotal=MO.Class.register(a,new MO.AGetter("_investmentTotal"));a._investmentProvinceDay=MO.Class.register(a,new MO.AGetter("_investmentProvinceDay"));a._investmentProvinceTotal=MO.Class.register(a,new MO.AGetter("_investmentProvinceTotal"));a._investmentCityDay=MO.Class.register(a,new MO.AGetter("_investmentCityDay"));a._investmentCityTotal=
MO.Class.register(a,new MO.AGetter("_investmentCityTotal"));a._provinces=MO.Class.register(a,new MO.AGetter("_provinces"));a._citys=MO.Class.register(a,new MO.AGetter("_citys"));a._milestones=MO.Class.register(a,new MO.AGetter("_milestones"));a._dates=MO.Class.register(a,new MO.AGetter("_dates"));a._listenersLoad=MO.Class.register(a,new MO.AListener("_listenersLoad",MO.EEvent.Load));a.onLoad=MO.FEaiHistoryResourceConsole_onLoad;a.construct=MO.FEaiHistoryResourceConsole_construct;a.unserialize=MO.FEaiHistoryResourceConsole_unserialize;
a.load=MO.FEaiHistoryResourceConsole_load;a.dispose=MO.FEaiHistoryResourceConsole_dispose;return a};MO.FEaiHistoryResourceConsole_onLoad=function(a){a=a.outputData();var b=MO.Class.create(MO.FDataView);b.setEndianCd(!0);b.link(a);this.unserialize(b);b.dispose();a=new MO.SEvent;this.processLoadListener(a);a.dispose()};
MO.FEaiHistoryResourceConsole_construct=function(){this.__base.FConsole.construct.call(this);this._provinces=new MO.TDictionary;this._citys=new MO.TDictionary;this._milestones=new MO.TDictionary;this._dates=new MO.TDictionary};
MO.FEaiHistoryResourceConsole_unserialize=function(a){this._investmentDay=a.readFloat();this._investmentTotal=a.readFloat();this._investmentProvinceDay=a.readFloat();this._investmentProvinceTotal=a.readFloat();this._investmentCityDay=a.readFloat();this._investmentCityTotal=a.readFloat();var b=this._provinces;b.clear();for(var c=a.readInt32(),d=0;d<c;d++){var e=MO.Class.create(MO.FEaiHistoryProvinceResource);e.unserialize(a);b.set(e.code(),e)}b=this._citys;b.clear();c=a.readInt32();for(d=0;d<c;d++)e=
MO.Class.create(MO.FEaiHistoryCityResource),e.unserialize(a),b.set(e.code(),e);b=this._milestones;b.clear();c=a.readInt32();for(d=0;d<c;d++)e=MO.Class.create(MO.FEaiHistoryMilestoneResource),e.unserialize(a),b.set(e.code(),e);b=this._dates;b.clear();c=a.readInt32();for(d=0;d<c;d++)e=MO.Class.create(MO.FEaiHistoryDateResource),e.unserialize(a),b.set(e.code(),e)};
MO.FEaiHistoryResourceConsole_load=function(){var a="{eai.resource}/investment.dat?date="+MO.Lang.Date.format(),a=MO.Console.find(MO.FEnvironmentConsole).parse(a);MO.Console.find(MO.FHttpConsole).send(a).addLoadListener(this,this.onLoad)};MO.FEaiHistoryResourceConsole_dispose=function(){this._provinces=RObject.dispose(this._provinces);this._citys=RObject.dispose(this._citys);this._milestones=RObject.dispose(this._milestones);this._dates=RObject.dispose(this._dates);this.__base.FConsole.dispose.call(this)};
with(MO)MO.FEaiProvinceResource=function(a){a=RClass.inherits(this,a,FObject);a._code=RClass.register(a,new AGetter("_code"));a._name=RClass.register(a,new AGetter("_name"));a._label=RClass.register(a,new AGetter("_label"));a._typeCd=RClass.register(a,new AGetter("_typeCd"));a._displayOrder=RClass.register(a,new AGetter("_displayOrder"));a.unserialize=FEaiProvinceResource_unserialize;return a},MO.FEaiProvinceResource_unserialize=function(a){this._code=a.readUint16();this._name=a.readString();this._label=
a.readString();this._typeCd=a.readString();this._displayOrder=a.readUint16()};
with(MO)MO.FEaiProvinceResourceConsole=function(a){a=RClass.inherits(this,a,FConsole);a._provinceCodes=RClass.register(a,new AGetter("_provinceCodes"));a._provinceNames=RClass.register(a,new AGetter("_provinceNames"));a.construct=FEaiProvinceResourceConsole_construct;a.findByCode=FEaiProvinceResourceConsole_findByCode;a.findByName=FEaiProvinceResourceConsole_findByName;a.unserialize=FEaiProvinceResourceConsole_unserialize;a.dispose=FEaiProvinceResourceConsole_dispose;return a},MO.FEaiProvinceResourceConsole_construct=
function(){this.__base.FConsole.construct.call(this);this._provinceCodes=new TDictionary;this._provinceNames=new TDictionary},MO.FEaiProvinceResourceConsole_findByCode=function(a){return this._provinceCodes.get(a)},MO.FEaiProvinceResourceConsole_findByName=function(a){return this._provinceNames.get(a)},MO.FEaiProvinceResourceConsole_unserialize=function(a){for(var b=this._provinceCodes,c=this._provinceNames,d=a.readInt32(),e=0;e<d;e++){var f=RClass.create(FEaiProvinceResource);f.unserialize(a);b.set(f.code(),
f);c.set(f.name(),f)}},MO.FEaiProvinceResourceConsole_dispose=function(){this._provinceCodes=RObject.dispose(this._provinceCodes);this._provinceNames=RObject.dispose(this._provinceNames);this.__base.FConsole.dispose.call(this)};
MO.FEaiRateResource=function(a){a=MO.Class.inherits(this,a,MO.FObject);a._count=MO.Class.register(a,new MO.AGetter("_count"));a._colors=MO.Class.register(a,new MO.AGetter("_colors"));a.construct=MO.FEaiRateResource_construct;a.find=MO.FEaiRateResource_find;a.findRate=MO.FEaiRateResource_findRate;a.unserialize=MO.FEaiRateResource_unserialize;a.dispose=MO.FEaiRateResource_dispose;return a};MO.FEaiRateResource_construct=function(){this.__base.FObject.construct.call(this)};
MO.FEaiRateResource_find=function(a){a=parseInt(a);0>a&&(a=0);a>=this._count&&(a=this._count-1);return this._colors[a]};MO.FEaiRateResource_findRate=function(a){return this.find(a*this._count)};MO.FEaiRateResource_unserialize=function(a){for(var b=this._count=a.readInt32(),c=this._colors=new Uint32Array(b),d=0;d<b;d++)c[d]=a.readUint32()};MO.FEaiRateResource_dispose=function(){this._colors=null;this.__base.FObject.dispose.call(this)};
with(MO)MO.FEaiRateResourceConsole=function(a){a=RClass.inherits(this,a,FConsole);a._rates=RClass.register(a,new AGetter("_rates"));a.construct=FEaiRateResourceConsole_construct;a.find=FEaiRateResourceConsole_find;a.unserialize=FEaiRateResourceConsole_unserialize;a.dispose=FEaiRateResourceConsole_dispose;return a},MO.FEaiRateResourceConsole_construct=function(){this.__base.FConsole.construct.call(this);this._rates=new TObjects},MO.FEaiRateResourceConsole_find=function(a){return this._rates.get(a)},
MO.FEaiRateResourceConsole_unserialize=function(a){for(var b=this._count=a.readInt32(),c=0;c<b;c++){var d=MO.Class.create(FEaiRateResource);d.unserialize(a);this._rates.push(d)}},MO.FEaiRateResourceConsole_dispose=function(){this._rates=RObject.dispose(this._rates);this.__base.FConsole.dispose.call(this)};
MO.FEaiResourceConsole=function(a){a=MO.RClass.inherits(this,a,MO.FConsole,MO.MListener);a._scopeCd=MO.EScope.Local;a._rateConsole=MO.Class.register(a,new MO.AGetter("_rateConsole"));a._provinceConsole=MO.Class.register(a,new MO.AGetter("_provinceConsole"));a._cityConsole=MO.Class.register(a,new MO.AGetter("_cityConsole"));a._cardConsole=MO.Class.register(a,new MO.AGetter("_cardConsole"));a._historyConsole=MO.Class.register(a,new MO.AGetter("_historyConsole"));a._loadListeners=MO.Class.register(a,
new MO.AListener("_loadListeners",MO.EEvent.Load));a.onLoad=MO.FEaiResourceConsole_onLoad;a.construct=MO.FEaiResourceConsole_construct;a.unserialize=MO.FEaiResourceConsole_unserialize;a.load=MO.FEaiResourceConsole_load;a.dispose=MO.FEaiResourceConsole_dispose;return a};MO.FEaiResourceConsole_onLoad=function(a){a=a.outputData();var b=MO.Class.create(MO.FDataView);b.setEndianCd(!0);b.link(a);this.unserialize(b);b.dispose();a=new MO.SEvent;this.processLoadListener(a);a.dispose()};
MO.FEaiResourceConsole_construct=function(){this.__base.FConsole.construct.call(this);this._rateConsole=MO.Class.create(MO.FEaiRateResourceConsole);this._provinceConsole=MO.Class.create(MO.FEaiProvinceResourceConsole);(this._cityConsole=MO.Class.create(MO.FEaiCityResourceConsole)).setResourceConsole(this);this._cardConsole=MO.Class.create(MO.FEaiCardResourceConsole);this._historyConsole=MO.Class.create(MO.FEaiHistoryResourceConsole)};
MO.FEaiResourceConsole_unserialize=function(a){this._rateConsole.unserialize(a);this._provinceConsole.unserialize(a);this._cityConsole.unserialize(a);this._cardConsole.unserialize(a)};MO.FEaiResourceConsole_load=function(a){a=MO.Console.find(MO.FEnvironmentConsole).parse(a);MO.Console.find(MO.FHttpConsole).send(a).addLoadListener(this,this.onLoad)};
MO.FEaiResourceConsole_dispose=function(a){this._rateConsole=MO.Lang.Object.dispose(this._rateConsole);this._provinceConsole=MO.Lang.Object.dispose(this._provinceConsole);this._cityConsole=MO.Lang.Object.dispose(this._cityConsole);this._cardConsole=MO.Lang.Object.dispose(this._cardConsole);this._historyConsole=MO.Lang.Object.dispose(this._historyConsole);this.__base.FConsole.dispose.call(this)};
with(MO)MO.FEaiLogic=function(a){a=RClass.inherits(this,a,FObject);a._code=null;a.makeUrl=FEaiLogic_makeUrl;a.send=FEaiLogic_send;return a},MO.FEaiLogic_makeUrl=function(a,b){var c="http://"+MO.RConsole.find(MO.FEnvironmentConsole).findValue(MO.EEaiConstant.ServiceHost)+"/eai/"+this._code+"/"+a;b&&(c+="?"+b);return c},MO.FEaiLogic_send=function(a,b,c,d){a=this.makeUrl(a,b);a=RConsole.find(FJsonConsole).sendAsync(a);a.addProcessListener(c,d);return a};
with(MO)MO.FEaiLogicAchievement=function(a){a=RClass.inherits(this,a,FEaiLogic);a._code="achievement";a.doGroup=FEaiLogicAchievement_doGroup;a.doSort=FEaiLogicAchievement_doSort;a.doQuery=FEaiLogicAchievement_doQuery;return a},MO.FEaiLogicAchievement_doGroup=function(a,b){return this.send("group",null,a,b)},MO.FEaiLogicAchievement_doSort=function(a,b){return this.send("sort",null,a,b)},MO.FEaiLogicAchievement_doQuery=function(a,b){return this.send("query",null,a,b)};
MO.FEaiLogicConsole=function(a){a=MO.Class.inherits(this,a,MO.FConsole);a._system=MO.Class.register(a,new MO.AGetter("_system"));a._organization=MO.Class.register(a,new MO.AGetter("_organization"));a._achievement=MO.Class.register(a,new MO.AGetter("_achievement"));a._schedule=MO.Class.register(a,new MO.AGetter("_schedule"));a._statistics=MO.Class.register(a,new MO.AGetter("_statistics"));a._thread=null;a._interval=6E5;a.onProcess=MO.FEaiLogicConsole_onProcess;a.construct=MO.FEaiLogicConsole_construct;
a.dispose=MO.FEaiLogicConsole_dispose;return a};MO.FEaiLogicConsole_onProcess=function(a){this._system.refresh()};
MO.FEaiLogicConsole_construct=function(){this.__base.FConsole.construct.call(this);this._system=MO.Class.create(MO.FEaiLogicSystem);this._organization=MO.Class.create(MO.FEaiLogicOrganization);this._achievement=MO.Class.create(MO.FEaiLogicAchievement);this._schedule=MO.Class.create(MO.FEaiLogicSchedule);this._statistics=MO.Class.create(MO.FEaiLogicStatistics);var a=this._thread=MO.Class.create(MO.FThread);a.setInterval(this._interval);a.addProcessListener(this,this.onProcess);MO.Console.find(MO.FThreadConsole).start(a)};
MO.FEaiLogicConsole_dispose=function(){this._system=MO.RObject.dispose(this._system);this._organization=MO.RObject.dispose(this._organization);this._achievement=MO.RObject.dispose(this._achievement);this._schedule=MO.RObject.dispose(this._schedule);this._statistics=MO.RObject.dispose(this._statistics);this.__base.FConsole.dispose.call(this)};
with(MO)MO.FEaiLogicOrganization=function(a){a=RClass.inherits(this,a,FEaiLogic);a._code="organization";a._pIdMIndexDict=RClass.register(a,new AGetter("_pIdMIndexDict"));a._cityIdNameDict=RClass.register(a,new AGetter("_cityIdNameDict"));a._provinceColors=RClass.register(a,new AGetter("_provinceColors"));a.doFetch=FEaiLogicOrganization_doFetch;a.getMeshIndex=FEaiLogicOrganization_getMeshIndex;a.construct=FEaiLogicOrganization_construct;return a},MO.FEaiLogicOrganization_construct=function(){this.__base.FEaiLogic.construct.call(this);
var a=this._pIdMIndexDict=new TDictionary;a.set(11,6);a.set(12,7);a.set(13,5);a.set(14,8);a.set(15,2);a.set(21,4);a.set(22,3);a.set(23,1);a.set(31,-1);a.set(32,21);a.set(33,22);a.set(34,20);a.set(35,30);a.set(36,23);a.set(37,9);a.set(41,10);a.set(42,19);a.set(43,29);a.set(44,24);a.set(45,25);a.set(46,0);a.set(50,18);a.set(51,17);a.set(52,26);a.set(53,27);a.set(54,16);a.set(61,12);a.set(62,13);a.set(63,15);a.set(64,11);a.set(65,14);a.set(71,28);a.set(81,-1);a.set(82,-1);this._cityIdNameDict=new TDictionary;
a=this._provinceColors=new TObjects;a.push(new SColor4(.25,.5,.6));a.push(new SColor4(.3,.6,.75));a.push(new SColor4(.35,.7,.8));a.push(new SColor4(.4,.75,.85));a.push(new SColor4(.45,.85,1))},MO.FEaiLogicOrganization_doFetch=function(a,b){return this.send("fetch",null,a,b)},MO.FEaiLogicOrganization_getMeshIndex=function(a){return this.pIdMIndexDict().value(a)},MO.FEaiLogicOrganization_getMeshIndex=function(a){return this.cityIdNameDict().value(a)};
with(MO)MO.FEaiLogicSchedule=function(a){a=RClass.inherits(this,a,FEaiLogic);a._code="schedule";a.doFetch=FEaiLogicSchedule_doFetch;return a},MO.FEaiLogicSchedule_doFetch=function(a,b){return this.send("fetch",null,a,b)};MO.FEaiLogicStatistics=function(a){a=MO.Class.inherits(this,a,MO.FEaiLogic);a._code="statistics";a.doInvestmentDynamic=MO.FEaiLogicStatistics_doInvestmentDynamic;a.doInvestmentTrend=MO.FEaiLogicStatistics_doInvestmentTrend;return a};
MO.FEaiLogicStatistics_doInvestmentDynamic=function(a,b,c,d){return this.send("investment_dynamic","begin="+c+"&end="+d,a,b)};MO.FEaiLogicStatistics_doInvestmentTrend=function(a,b,c,d,e){e||(e=6E5);return this.send("investment_trend","begin="+c+"&end="+d+"&interval="+e,a,b)};
MO.FEaiLogicSystem=function(a){a=MO.Class.inherits(this,a,MO.FEaiLogic);a._code="system";a._ready=!1;a._currentDate=null;a._localDate=null;a._systemDate=MO.Class.register(a,new MO.AGetter("_systemDate"));a.onInfo=MO.FEaiLogicSystem_onInfo;a.construct=MO.FEaiLogicSystem_construct;a.doInfo=MO.FEaiLogicSystem_doInfo;a.testReady=MO.FEaiLogicSystem_testReady;a.currentDate=MO.FEaiLogicSystem_currentDate;a.refresh=MO.FEaiLogicSystem_refresh;a.dispose=MO.FEaiLogicSystem_dispose;return a};
MO.FEaiLogicSystem_onInfo=function(a){a=a.content;this._localDate.setNow();this._systemDate.parse(a.date);this._ready=!0};MO.FEaiLogicSystem_construct=function(){this.__base.FEaiLogic.construct.call(this);this._currentDate=new MO.TDate;this._localDate=new MO.TDate;this._systemDate=new MO.TDate};MO.FEaiLogicSystem_doInfo=function(a,b){return this.send("info",null,a,b)};MO.FEaiLogicSystem_testReady=function(){return this._ready};
MO.FEaiLogicSystem_currentDate=function(){var a=this._systemDate.get()-this._localDate.get();this._currentDate.set(MO.Timer.current()+a);return this._currentDate};MO.FEaiLogicSystem_refresh=function(){return this.doInfo(this,this.onInfo)};MO.FEaiLogicSystem_dispose=function(){this._localDate=RObject.dispose(this._localDate);this._systemDate=RObject.dispose(this._systemDate);this.__base.FEaiLogic.consturct.call(this)};
with(MO)MO.FEaiBoundaryData=function(a){a=RClass.inherits(this,a,FEaiEntity);a._positionCount=RClass.register(a,new AGetter("_positionCount"));a._positions=RClass.register(a,new AGetter("_positions"));a._indexes=RClass.register(a,new AGetter("_indexes"));a.construct=FEaiBoundaryData_construct;a.unserialize=FEaiBoundaryData_unserialize;a.dispose=FEaiBoundaryData_dispose;return a},MO.FEaiBoundaryData_construct=function(){this.__base.FEaiEntity.construct.call(this)},MO.FEaiBoundaryData_unserialize=function(a){var b=
0,c=this._positionCount=a.readInt32();this._positions=new Float32Array(2*c);for(var d=0;d<c;d++)this._positions[b++]=a.readFloat(),this._positions[b++]=a.readFloat();b=a.readInt32();this._indexes=new Uint16Array(b);for(d=0;d<b;d++)this._indexes[d]=a.readUint16()},MO.FEaiBoundaryData_dispose=function(){this._indexes=this._positions=null;this.__base.FEaiEntity.dispose.call(this)};
MO.FEaiCityEffect=function(a){a=MO.Class.inherits(this,a,MO.FG3dAutomaticEffect);a._code="eai.city";a.drawRenderable=MO.FEaiCityEffect_drawRenderable;return a};
MO.FEaiCityEffect_drawRenderable=function(a,b){var c=this._graphicContext,d=this._program,e=b.currentMatrix(),f=a.calculate(MO.EG3dRegionParameter.CameraViewProjectionMatrix),g=b.material(),h=g.info();this.bindMaterial(g);d.setParameter("vc_model_matrix",e);d.setParameter("vc_vp_matrix",f);d.setParameter4("fc_alpha",h.alphaBase,h.alphaRate,h.alphaLevel,h.alphaMerge);d.setParameter("fc_ambient_color",h.ambientColor);this.bindAttributes(b);this.bindSamplers(b);d=b.indexBuffers().first();c.drawTriangles(d)};
MO.FEaiCityEntity=function(a){a=MO.Class.inherits(this,a,MO.FEaiEntity);a._provinceEntity=MO.Class.register(a,new MO.AGetSet("_provinceEntity"));a._visible=MO.Class.register(a,new MO.AGetter("_visible"),!1);a._location=MO.Class.register(a,new MO.AGetter("_location"));a._size=MO.Class.register(a,new MO.AGetter("_size"));a._color=MO.Class.register(a,new MO.AGetter("_color"));a._range=MO.Class.register(a,new MO.AGetter("_range"),1);a._rangeColor=MO.Class.register(a,new MO.AGetter("_rangeColor"));a._cityTotal=
0;a._investmentCount=0;a._investmentTotal=MO.Class.register(a,new MO.AGetSet("_investmentTotal"),0);a._investmentLevel=0;a._investmentLast=0;a._investmentRateTotal=0;a._investmentRate=0;a._investmentAlpha=0;a._investmentRange=0;a._investmentDirection=1;a._stage=MO.Class.register(a,new MO.AGetSet("_stage"));a._renderable=MO.Class.register(a,new MO.AGetSet("_renderable"));a._data=MO.Class.register(a,new MO.AGetSet("_data"));a._inputPoint=null;a._outputPoint=null;a.construct=MO.FEaiCityEntity_construct;
a.calculateScreenPosition=MO.FEaiCityEntity_calculateScreenPosition;a.build=MO.FEaiCityEntity_build;a.addInvestmentTotal=MO.FEaiCityEntity_addInvestmentTotal;a.reset=MO.FEaiCityEntity_reset;a.update=MO.FEaiCityEntity_update;a.process=MO.FEaiCityEntity_process;a.dispose=MO.FEaiCityEntity_dispose;return a};
MO.FEaiCityEntity_construct=function(){this.__base.FEaiEntity.construct.call(this);this._location=new MO.SPoint2;this._size=new MO.SSize2;this._color=new MO.SColor4(0,0,0,0);this._rangeColor=new MO.SColor4(0,0,0,0);this._inputPoint=new MO.SPoint3;this._outputPoint=new MO.SPoint3};
MO.FEaiCityEntity_calculateScreenPosition=function(){var a=this._stage.region().calculate(MO.EG3dRegionParameter.CameraViewProjectionMatrix),b=this._renderable.matrix(),c=MO.Lang.Math.matrix;c.identity();c.append(b);c.append(a);this._inputPoint.set(this._location.x,this._location.y,0);c.transformPoint3(this._inputPoint,this._outputPoint);return this._outputPoint};MO.FEaiCityEntity_build=function(a){this._location.assign(this._data.location());this._size.set(2,2)};
MO.FEaiCityEntity_addInvestmentTotal=function(a,b){this._investmentCount++;this._investmentTotal+=b;if(!(b<this._investmentLast)){var c=MO.Console.find(MO.FEaiResourceConsole).rateConsole().find(MO.EEaiRate.InvestmentRange).findRate(b/2E5);this._color.set(1,1,1,1);this._rangeColor.setInteger(c);this._rangeColor.alpha=1;this._investmentLast=b;this._investmentRate=this._investmentRateTotal=1E5*(a+1);this._investmentRange=Math.log(b*b)/10;this._investmentAlpha=8;this._visible=!0}};
MO.FEaiCityEntity_reset=function(){this._visible=!1;this._cityTotal=0;this._color.set(0,0,0,0);this._rangeColor.set(0,0,0,0)};
MO.FEaiCityEntity_update=function(a){var b=1;this._color.set(1,1,1,1);this._rangeColor.set(1,1,1,1);a&&(this._cityTotal=a.investmentTotal());a=this._cityTotal;0<a&&(this._visible=!0);var c=MO.Console.find(MO.FEaiResourceConsole).historyConsole().investmentCityTotal(),b=MO.Console.find(MO.FEaiResourceConsole).rateConsole().find(MO.EEaiRate.Map);a=4*Math.sqrt(a/c);c=b.findRate(a);b=6*a;a=MO.Lang.Float.toRange(a,0,1);this._rangeColor.setIntAlpha(c,.6*a);this._range=MO.Lang.Float.toRange(Math.sqrt(b),
1,6)};MO.FEaiCityEntity_process=function(a){if(0<this._investmentRate)return a=this._investmentRate/this._investmentRateTotal,this._range=this._investmentRange*a,a=Math.min(this._investmentAlpha*a,1),this._color.alpha=a,this._rangeColor.alpha=a,this._investmentRate--,!0;this._investmentAlpha=this._investmentRange=this._investmentRate=this._investmentLast=0;return this._visible=!1};
MO.FEaiCityEntity_dispose=function(){this._location=MO.Lang.Object.dispose(this._location);this._size=MO.Lang.Object.dispose(this._size);this._color=MO.Lang.Object.dispose(this._color);this._rangeColor=MO.Lang.Object.dispose(this._rangeColor);this._inputPoint=MO.Lang.Object.dispose(this._inputPoint);this._outputPoint=MO.Lang.Object.dispose(this._outputPoint);this.__base.FEaiEntity.dispose.call(this)};
MO.FEaiCityEntityConsole=function(a){a=MO.RClass.inherits(this,a,MO.FObject);a._citys=MO.Class.register(a,new MO.AGetter("_citys"));a.construct=MO.FEaiCityEntityConsole_construct;a.findByCode=MO.FEaiCityEntityConsole_findByCode;a.findByCard=MO.FEaiCityEntityConsole_findByCard;a.push=MO.FEaiCityEntityConsole_push;a.dispose=MO.FEaiCityEntityConsole_dispose;return a};MO.FEaiCityEntityConsole_construct=function(){this.__base.FObject.construct.call(this);this._citys=new MO.TDictionary};
MO.FEaiCityEntityConsole_findByCode=function(a){return this._citys.get(a)};MO.FEaiCityEntityConsole_findByCard=function(a){if(4!=a.length)return null;var b=this._citys;if(b=b.get(a))return b;b=this._citys;return(b=b.get(a.substring(0,2)))?b:null};MO.FEaiCityEntityConsole_push=function(a){this._citys.set(a.data().code(),a)};MO.FEaiCityEntityConsole_dispose=function(a){this._citys=RObject.dispose(this._citys);this.__base.FObject.dispose.call(this)};
MO.FEaiCityRangeEffect=function(a){a=MO.Class.inherits(this,a,MO.FG3dAutomaticEffect);a._code="eai.city.range";a.drawRenderable=MO.FEaiCityRangeEffect_drawRenderable;return a};
MO.FEaiCityRangeEffect_drawRenderable=function(a,b){var c=this._graphicContext,d=this._program,e=b.currentMatrix(),f=a.calculate(MO.EG3dRegionParameter.CameraViewProjectionMatrix),g=b.material();g.info();this.bindMaterial(g);d.setParameter("vc_model_matrix",e);d.setParameter("vc_vp_matrix",f);this.bindAttributes(b);this.bindSamplers(b);d=b.indexBuffers().first();c.drawTriangles(d)};
MO.FEaiCitysRangeRenderable=function(a){a=MO.Class.inherits(this,a,MO.FE3dRenderable);a._ready=!1;a._image=null;a._citys=MO.Class.register(a,new MO.AGetter("_citys"));a._citySize=MO.Class.register(a,new MO.AGetter("_citySize"));a._vertexPositionBuffer=null;a._vertexColorBuffer=null;a._vertexCoordBuffer=null;a._indexBuffer=null;a._texture=null;a.onImageLoad=MO.FEaiCitysRangeRenderable_onImageLoad;a.construct=MO.FEaiCitysRangeRenderable_construct;a.testReady=MO.FEaiCitysRangeRenderable_testReady;a.setup=
MO.FEaiCitysRangeRenderable_setup;a.upload=MO.FEaiCitysRangeRenderable_upload;a.dispose=MO.FEaiCitysRangeRenderable_dispose;return a};MO.FEaiCitysRangeRenderable_onImageLoad=function(a){a=a.sender;this._texture.upload(a);a.dispose();this._ready=!0};MO.FEaiCitysRangeRenderable_construct=function(){this.__base.FE3dRenderable.construct.call(this);this._citys=new MO.TObjects;this._material=MO.Class.create(MO.FE3dMaterial)};MO.FEaiCitysRangeRenderable_testReady=function(){return this._ready};
MO.FEaiCitysRangeRenderable_setup=function(){var a=this._graphicContext,b=this._citys.count(),c=this._vertexCount=4*b,d=this._vertexPositionBuffer=a.createVertexBuffer();d.setCode("position");d.setFormatCd(MO.EG3dAttributeFormat.Float3);this.pushVertexBuffer(d);for(var d=0,e=new Float32Array(2*c),f=0;f<b;f++)e[d++]=0,e[d++]=1,e[d++]=1,e[d++]=1,e[d++]=1,e[d++]=0,e[d++]=0,e[d++]=0;d=this._vertexCoordBuffer=a.createVertexBuffer();d.setCode("coord");d.setFormatCd(MO.EG3dAttributeFormat.Float2);d.upload(e,
8,c);this.pushVertexBuffer(d);d=this._vertexColorBuffer=a.createVertexBuffer();d.setCode("color");d.setFormatCd(MO.EG3dAttributeFormat.Byte4Normal);this.pushVertexBuffer(d);c=6*b;d=0;e=new Uint16Array(c);for(f=0;f<b;f++){var g=4*f;e[d++]=g+0;e[d++]=g+1;e[d++]=g+2;e[d++]=g+0;e[d++]=g+2;e[d++]=g+3}d=this._indexBuffer=a.createIndexBuffer();d.upload(e,c);this.pushIndexBuffer(d);a=this._texture=a.createFlatTexture();a.setOptionFlipY(!0);a.setWrapCd(MO.EG3dSamplerFilter.ClampToEdge,MO.EG3dSamplerFilter.ClampToEdge);
this.pushTexture(a,"diffuse");a=this._material.info();a.effectCode="eai.citys.range";a.optionAlpha=!0;a.optionDepth=!1;this._material._textures=this._textures;a=MO.Class.create(MO.FImage);a.addLoadListener(this,this.onImageLoad);a.loadUrl("{eai.resource}/dot.png");this._ready=!1};
MO.FEaiCitysRangeRenderable_upload=function(){for(var a=this._citys,b=a.count(),c=0,d=0;d<b;d++){var e=a.at(d);e.visible()&&c++}for(var f=this._vertexCount=4*c,g=0,h=new Float32Array(3*f),k=0,m=new Uint8Array(4*f),d=0;d<b;d++)if(e=a.at(d),e.visible()){var l=e.location(),r=e.range();e.size();var p=e.provinceEntity(),n=0;p&&(n=p.currentZ());h[g++]=l.x-r;h[g++]=l.y+r;h[g++]=n;h[g++]=l.x+r;h[g++]=l.y+r;h[g++]=n;h[g++]=l.x+r;h[g++]=l.y-r;h[g++]=n;h[g++]=l.x-r;h[g++]=l.y-r;h[g++]=n;p=e.rangeColor();e=parseInt(255*
p.red);l=parseInt(255*p.green);r=parseInt(255*p.blue);p=parseInt(255*p.alpha);for(n=0;4>n;n++)m[k++]=e,m[k++]=l,m[k++]=r,m[k++]=p}this._vertexPositionBuffer.upload(h,12,f);this._vertexColorBuffer.upload(m,4,f);this._indexBuffer.setCount(6*c)};
MO.FEaiCitysRangeRenderable_dispose=function(){this._texture=MO.Lang.Object.dispose(this._texture);this._vertexPositionBuffer=MO.Lang.Object.dispose(this._vertexPositionBuffer);this._vertexCoordBuffer=MO.Lang.Object.dispose(this._vertexCoordBuffer);this._indexBuffer=MO.Lang.Object.dispose(this._indexBuffer);this.__base.FE3dRenderable.dispose.call(this)};
MO.FEaiCitysRenderable=function(a){a=MO.Class.inherits(this,a,MO.FE3dRenderable);a._ready=!1;a._image=null;a._levelCoordLeft=null;a._levelCoordRight=null;a._levelScale=null;a._citys=MO.Class.register(a,new MO.AGetter("_citys"));a._level=MO.Class.register(a,new MO.AGetSet("_level"));a._citySize=MO.Class.register(a,new MO.AGetter("_citySize"));a._vertexPositionBuffer=null;a._vertexCoordBuffer=null;a._indexBuffer=null;a._texture=null;a.onImageLoad=MO.FEaiCitysRenderable_onImageLoad;a.construct=MO.FEaiCitysRenderable_construct;
a.testReady=MO.FEaiCitysRenderable_testReady;a.setup=MO.FEaiCitysRenderable_setup;a.upload=MO.FEaiCitysRenderable_upload;a.dispose=MO.FEaiCitysRenderable_dispose;return a};MO.FEaiCitysRenderable_onImageLoad=function(a){a=a.sender;this._texture.upload(a);a.dispose();this._ready=!0};
MO.FEaiCitysRenderable_construct=function(){this.__base.FE3dRenderable.construct.call(this);this._citys=new MO.TObjects;this._material=MO.Class.create(MO.FE3dMaterial);var a=this._levelCoordLeft={};a[1]=0;a[2]=.25;a[3]=.5;a[4]=.75;a=this._levelCoordRight={};a[1]=.25;a[2]=.5;a[3]=.75;a[4]=1;a=this._levelScale={};a[1]=.7;a[2]=.5;a[3]=.4;a[4]=.2};MO.FEaiCitysRenderable_testReady=function(){return this._ready};
MO.FEaiCitysRenderable_setup=function(){var a=this._graphicContext,b=this._citys.count();this._vertexCount=4*b;var c=this._vertexPositionBuffer=a.createVertexBuffer();c.setCode("position");c.setFormatCd(MO.EG3dAttributeFormat.Float3);this.pushVertexBuffer(c);c=this._vertexCoordBuffer=a.createVertexBuffer();c.setCode("coord");c.setFormatCd(MO.EG3dAttributeFormat.Float2);this.pushVertexBuffer(c);c=this._vertexColorBuffer=a.createVertexBuffer();c.setCode("color");c.setFormatCd(MO.EG3dAttributeFormat.Byte4Normal);
this.pushVertexBuffer(c);for(var d=6*b,c=0,e=new Uint16Array(d),f=0;f<b;f++){var g=4*f;e[c++]=g+0;e[c++]=g+1;e[c++]=g+2;e[c++]=g+0;e[c++]=g+2;e[c++]=g+3}c=this._indexBuffer=a.createIndexBuffer();c.upload(e,d);this.pushIndexBuffer(c);a=this._texture=a.createFlatTexture();a.setOptionFlipY(!0);a.setWrapCd(MO.EG3dSamplerFilter.ClampToEdge,MO.EG3dSamplerFilter.ClampToEdge);this.pushTexture(a,"diffuse");a=this._material.info();a.effectCode="eai.citys";a.optionAlpha=!0;a.optionDepth=!1;a.ambientColor.setHex("#FFFFFF");
this._material._textures=this._textures;a=MO.Class.create(MO.FImage);a.addLoadListener(this,this.onImageLoad);a.loadUrl("{eai.resource}/citys.png");this._ready=!1};
MO.FEaiCitysRenderable_upload=function(){for(var a=this._citys,b=a.count(),c=0,d=0;d<b;d++){var e=a.at(d);e.visible()&&c++}for(var f=this._vertexCount=4*c,g=0,h=new Float32Array(3*f),k=0,m=new Float32Array(2*f),l=0,r=new Uint8Array(4*f),d=0;d<b;d++)if(e=a.at(d),e.visible()){e.range();var p=e.location(),n=e.data().level();if(1!=n&&2!=n&&3!=n&&4!=n)throw new TError("Invalid level.");var q=e.provinceEntity(),u=0;q&&(u=q.currentZ());var q=this._levelCoordLeft[n],t=this._levelCoordRight[n],n=this._levelScale[n];
h[g++]=p.x-n;h[g++]=p.y+n;h[g++]=u;h[g++]=p.x+n;h[g++]=p.y+n;h[g++]=u;h[g++]=p.x+n;h[g++]=p.y-n;h[g++]=u;h[g++]=p.x-n;h[g++]=p.y-n;h[g++]=u;m[k++]=q;m[k++]=1;m[k++]=t;m[k++]=1;m[k++]=t;m[k++]=0;m[k++]=q;m[k++]=0;n=e.color();e=parseInt(255*n.red);p=parseInt(255*n.green);u=parseInt(255*n.blue);n=parseInt(255*n.alpha);for(q=0;4>q;q++)r[l++]=e,r[l++]=p,r[l++]=u,r[l++]=n}this._vertexPositionBuffer.upload(h,12,f);this._vertexCoordBuffer.upload(m,8,f);this._vertexColorBuffer.upload(r,4,f);this._indexBuffer.setCount(6*
c)};MO.FEaiCitysRenderable_dispose=function(){this._texture=MO.Lang.Object.dispose(this._texture);this._vertexPositionBuffer=MO.Lang.Object.dispose(this._vertexPositionBuffer);this._vertexCoordBuffer=MO.Lang.Object.dispose(this._vertexCoordBuffer);this._vertexColorBuffer=MO.Lang.Object.dispose(this._vertexColorBuffer);this._indexBuffer=MO.Lang.Object.dispose(this._indexBuffer);this.__base.FE3dRenderable.dispose.call(this)};
MO.FEaiCountryData=function(a){a=MO.Class.inherits(this,a,MO.FObject,MO.MListener);a._listenersLoad=MO.Class.register(a,new MO.AListener("_listenersLoad",MO.EEvent.Load));a._provinces=MO.Class.register(a,new MO.AGetter("_provinces"));a.onLoaded=MO.FEaiCountryData_onLoaded;a.construct=MO.FEaiCountryData_construct;a.unserialize=MO.FEaiCountryData_unserialize;a.load=MO.FEaiCountryData_load;a.dispose=MO.FEaiCountryData_dispose;return a};
MO.FEaiCountryData_construct=function(){this.__base.FObject.construct.call(this);this._provinces=new MO.TDictionary};MO.FEaiCountryData_onLoaded=function(a){a=a.outputData();var b=MO.Class.create(MO.FDataView);b.setEndianCd(!0);b.link(a);this.unserialize(b);b.dispose()};MO.FEaiCountryData_unserialize=function(a){for(var b=a.readInt32(),c=0;c<b;c++){var d=MO.Class.create(MO.FEaiProvinceData);d.unserialize(a);this._provinces.set(d.code(),d)}a=new MO.SEvent(this);this.processLoadListener(a);a.dispose()};
MO.FEaiCountryData_load=function(){var a=MO.Console.find(MO.FEnvironmentConsole).parse("{eai.resource}/country.dat");MO.Console.find(MO.FHttpConsole).send(a).addLoadListener(this,this.onLoaded)};MO.FEaiCountryData_dispose=function(){this._provinces=MO.Lang.Object.dispose(this._provinces);this.__base.FObject.dispose.call(this)};
with(MO)MO.FEaiCountryEntity=function(a){a=RClass.inherits(this,a,FEaiEntity);a._enterSELoaded=!1;a._enterSEPlaying=!1;a._cameraDirection=RClass.register(a,new AGetSet("_cameraDirection"));a._startDelay=RClass.register(a,new AGetSet("_startDelay"),0);a._riseDuration=RClass.register(a,new AGetSet("_riseDuration"),5E3);a._riseDistance=RClass.register(a,new AGetSet("_riseDistance"),600);a._fallDuration=RClass.register(a,new AGetSet("_fallDuration"),200);a._fallDistance=RClass.register(a,new AGetSet("_fallDistance"),
3);a._blockInterval=RClass.register(a,new AGetSet("_blockInterval"),200);a._mouseOverRiseHeight=RClass.register(a,new AGetSet("_mouseOverRiseHeight"),3);a._mouseMoveCheckInterval=RClass.register(a,new AGetSet("_mouseMoveCheckInterval"),100);a._cameraMoveDuration=RClass.register(a,new AGetSet("_cameraMoveDuration"),500);a._provinceEntities=MO.Class.register(a,new MO.AGetter("_provinceEntities"));a._provinceArray=null;a._playing=!1;a._lastTick=0;a._interval=10;a._template=RClass.register(a,new AGetSet("_template"));
a._introAnimeDone=RClass.register(a,new AGetSet("_introAnimeDone"),!1);a._startTime=RClass.register(a,new AGetSet("_startTime"));a._mouseOverRiseRenderable=RClass.register(a,new AGetSet("_mouseOverRiseRenderable"));a._mouseOverFallArray=RClass.register(a,new AGetSet("_mouseOverFallArray"));a._mouseMoveLastCheck=RClass.register(a,new AGetSet("_mouseMoveLastCheck"));a._cameraMoving=RClass.register(a,new AGetSet("_cameraMoving"),!1);a._cameraFrom=RClass.register(a,new AGetSet("_cameraFrom"));a._cameraTo=
RClass.register(a,new AGetSet("_cameraTo"));a._mapEnterSE=null;a.setup=FEaiCountryEntity_setup;a.start=FEaiCountryEntity_start;a.process=FEaiCountryEntity_process;a.introAnime=FEaiCountryEntity_introAnime;a.onMouseMove=FEaiCountryEntity_onMouseMove;a.onMouseDown=FEaiCountryEntity_onMouseDown;a.mouseOverFallAnime=FEaiCountryEntity_mouseOverFallAnime;a.onOrganizationFetch=FEaiCountryEntity_onOrganizationFetch;a.cameraMoveAnime=FEaiCountryEntity_cameraMoveAnime;a.provinceShowOrderSort=FEaiCountryEntity_provinceShowOrderSort;
a.onEnterSELoaded=FEaiCountryEntity_onEnterSELoaded;a.isReady=FEaiCountryEntity_isReady;return a},MO.FEaiCountryEntity_setup=function(a){this._provinceEntities=a;for(var b=0;b<this._provinceEntities.count();b++){var c=this._provinceEntities.at(b).faceRenderable(),d=this._provinceEntities.at(b).borderRenderable(),c=c.matrix(),d=d.matrix();c.tz=this.riseDistance();c.updateForce();d.tz=this.riseDistance();d.updateForce()}d=this._provinceArray=Array(a.count());for(b=0;b<a.count();b++)d[b]=a.at(b);d.sort(this.provinceShowOrderSort);
MO.Console.find(MO.FAudioContextConsole).load("{eai.resource}/map_entry/enter.mp3",this,this.onEnterSELoaded)},MO.FEaiCountryEntity_onEnterSELoaded=function(a){var b=MO.Console.find(MO.FAudioContextConsole);this._provinceEntities.count();this._mapEnterSE=b.create(a);this._enterSELoaded=!0},MO.FEaiCountryEntity_isReady=function(){return this._enterSELoaded?(this._startTime=MO.Timer.current(),!0):!1},MO.FEaiCountryEntity_provinceShowOrderSort=function(a,b){var c=MO.RConsole.find(FEaiResourceConsole).provinceConsole(),
d=c.findByCode(a.data().code()),c=c.findByCode(b.data().code());return d.displayOrder()>c.displayOrder()?1:-1},MO.FEaiCountryEntity_start=function(){this._startTime=MO.Timer.current()},MO.FEaiCountryEntity_process=function(){this._provinceEntities&&this.introAnime()},MO.FEaiCountryEntity_introAnime=function(){var a=MO.Timer.current()-this._startTime;if(!(a<this.startDelay())){a-=this.startDelay();if(a>this.riseDuration()+this.fallDuration()+this.blockInterval()*this._provinceEntities.count()){this.setIntroAnimeDone(!0);
var b=new TListener;b._owner=this;b._callback=this.onMouseMove;RWindow.lsnsMouseMove.push(b);b=new TListener;b._owner=this;b._callback=this.onMouseDown;RWindow.lsnsMouseDown.push(b)}this._enterSEPlaying||(this._mapEnterSE.start(0),this._enterSEPlaying=!0);for(var b=a/this.blockInterval(),c=0;c<this._provinceArray.length&&c<b;c++){var d=this._provinceArray[c].faceRenderable(),e=this._provinceArray[c].borderRenderable(),d=d.matrix(),e=e.matrix(),f=(a-this.blockInterval()*c)/(this.riseDuration()-c*c),
g=0;1<f&&(f=1,g=(a-this.blockInterval()*c-(this.riseDuration()-c*c))/this.fallDuration(),1<g&&(g=1));d.tz=this.riseDistance()*(1-f)-this.fallDistance()*(1-g);d.updateForce();e.tz=this.riseDistance()*(1-f)-this.fallDistance()*(1-g);e.updateForce()}b>this._provinceArray.length-1||parseInt(b)}},MO.FEaiCountryEntity_onMouseMove=function(a){},MO.FEaiCountryEntity_mouseOverFallAnime=function(){},MO.FEaiCountryEntity_onOrganizationFetch=function(a){},MO.FEaiCountryEntity_onMouseDown=function(a){},MO.FEaiCountryEntity_cameraMoveAnime=
function(){};
MO.FEaiEntityConsole=function(a){a=MO.RClass.inherits(this,a,MO.FConsole,MO.MListener,MO.MGraphicObject);a._scopeCd=MO.EScope.Local;a._mapEntity=MO.Class.register(a,new MO.AGetter("_mapEntity"));a._countryData=null;a._countryReady=!1;a._provinceConsole=MO.Class.register(a,new MO.AGetter("_provinceConsole"));a._cityConsole=MO.Class.register(a,new MO.AGetter("_cityConsole"));a._listenersLoadCountry=MO.Class.register(a,new MO.AListener("_listenersLoadCountry","LoadCountry"));a.onSetup=MO.FEaiEntityConsole_onSetup;a.onLoadCountry=
MO.FEaiEntityConsole_onLoadCountry;a.construct=MO.FEaiEntityConsole_construct;a.testCountryReady=MO.FEaiEntityConsole_testCountryReady;a.loadCountryData=MO.FEaiEntityConsole_loadCountryData;a.dispose=MO.FEaiEntityConsole_dispose;return a};MO.FEaiEntityConsole_onSetup=function(){this.__base.FConsole.onSetup.call(this);var a=this._mapEntity=MO.Class.create(MO.FEaiMapEntity);a.linkGraphicContext(this);a.setup()};
MO.FEaiEntityConsole_onLoadCountry=function(a){var b=a.sender;a=this._mapEntity;a.countryDisplay();a.countryBorderDisplay();for(var c=a.citysRangeRenderable(),d=a.citysRenderable(),e=MO.Console.find(MO.FEaiResourceConsole).provinceConsole(),f=MO.Console.find(MO.FEaiEntityConsole).provinceConsole(),g=b.provinces(),h=g.count(),b=0;b<h;b++){provinceData=g.at(b);var k=provinceData.code();e.findByCode(k);k=MO.Class.create(MO.FEaiProvinceEntity);k.setMapEntity(a);k.setData(provinceData);k.build(this);a.pushProvince(k);
f.push(k)}b=MO.Console.find(MO.FEaiResourceConsole).cityConsole();e=MO.Console.find(MO.FEaiEntityConsole).cityConsole();f=a.cityEntities();g=b.citys();h=g.count();for(b=0;b<h;b++){k=g.at(b);k.level();k.location();var m=MO.Class.create(MO.FEaiCityEntity);m.setRenderable(d);m.setData(k);m.build(this);f.set(k.code(),m);d.citys().push(m);c.citys().push(m);e.push(m)}d.setup();d.upload();c.setup();c.upload();a.setupCityEntities();this._countryReady=!0;a=new MO.SEvent;this.processLoadCountryListener(a)};
MO.FEaiEntityConsole_construct=function(){this.__base.FConsole.construct.call(this);this._provinceConsole=MO.Class.create(MO.FEaiProvinceEntityConsole);this._cityConsole=MO.Class.create(MO.FEaiCityEntityConsole)};MO.FEaiEntityConsole_testCountryReady=function(){return this._countryReady&&this._mapEntity.countryEntity().isReady()};
MO.FEaiEntityConsole_loadCountryData=function(){var a=this._countryData;a||(a=this._countryData=MO.Class.create(MO.FEaiCountryData),a.addLoadListener(this,this.onLoadCountry),a.load())};MO.FEaiEntityConsole_dispose=function(){this._mapEntity=RObject.dispose(this._mapEntity);this._provinceConsole=RObject.dispose(this._provinceConsole);this._cityConsole=RObject.dispose(this._cityConsole);this.__base.FConsole.dispose.call(this)};
MO.FEaiMapEntity=function(a){a=MO.Class.inherits(this,a,MO.FEaiEntity);a._countryEntity=MO.Class.register(a,new MO.AGetter("_countryEntity"));a._provinceEntities=MO.Class.register(a,new MO.AGetter("_provinceEntities"));a._cityEntities=MO.Class.register(a,new MO.AGetter("_cityEntities"));a._citysRenderable=MO.Class.register(a,new MO.AGetSet("_citysRenderable"));a._citysRangeRenderable=MO.Class.register(a,new MO.AGetSet("_citysRangeRenderable"));a._countryDisplay=MO.Class.register(a,new MO.AGetter("_countryDisplay"));
a._countryBorderDisplay=MO.Class.register(a,new MO.AGetter("_countryBorderDisplay"));a._provinceFaceShape=MO.Class.register(a,new MO.AGetter("_provinceFaceShape"));a._provinceBorderShape=MO.Class.register(a,new MO.AGetter("_provinceBorderShape"));a.construct=MO.FEaiMapEntity_construct;a.setup=MO.FEaiMapEntity_setup;a.setupCityEntities=MO.FEaiMapEntity_setupCityEntities;a.findProvinceByCode=MO.FEaiMapEntity_findProvinceByCode;a.findCityByCard=MO.FEaiMapEntity_findCityByCard;a.pushProvince=MO.FEaiMapEntity_pushProvince;
a.upload=MO.FEaiMapEntity_upload;a.process=MO.FEaiMapEntity_process;a.reset=MO.FEaiMapEntity_reset;a.dispose=MO.FEaiMapEntity_dispose;return a};MO.FEaiMapEntity_construct=function(){this.__base.FEaiEntity.construct.call(this);this._countryEntity=MO.Class.create(MO.FEaiCountryEntity);this._provinceEntities=new MO.TDictionary;this._cityEntities=new MO.TDictionary};
MO.FEaiMapEntity_setup=function(){(this._citysRenderable=MO.Class.create(MO.FEaiCitysRenderable)).linkGraphicContext(this);(this._citysRangeRenderable=MO.Class.create(MO.FEaiCitysRangeRenderable)).linkGraphicContext(this);var a=this._countryDisplay=MO.Class.create(MO.FE3dDisplayContainer);a.linkGraphicContext(this);a=this._countryBorderDisplay=MO.Class.create(MO.FE3dDisplayContainer);a.linkGraphicContext(this);a=this._provinceFaceShape=MO.Class.create(MO.FE3dDynamicShape);a.linkGraphicContext(this);
this._countryDisplay.push(a);a=this._provinceBorderShape=MO.Class.create(MO.FE3dDynamicShape);a.linkGraphicContext(this);this._countryBorderDisplay.push(a)};
MO.FEaiMapEntity_setupCityEntities=function(){for(var a=this._provinceEntities,b=this._cityEntities,c=b.count(),d=0;d<c;d++){var e=b.at(d),f=e.data().provinceCode(),f=a.get(f);e.setProvinceEntity(f)}this._countryEntity.setup(a);b=this._provinceFaceShape;e=this._provinceBorderShape;c=a.count();for(d=0;d<c;d++){var f=a.at(d),g=f.faceRenderable();b.pushMergeRenderable(g);f=f.borderRenderable();e.pushMergeRenderable(f)}b.build();e.build()};MO.FEaiMapEntity_findProvinceByCode=function(a){return this._provinceEntities.get(a)};
MO.FEaiMapEntity_pushProvince=function(a){var b=a.data().code();this._provinceEntities.set(b,a)};MO.FEaiMapEntity_findCityByCard=function(a){var b=null;(a=MO.Console.find(MO.FEaiResourceConsole).cardConsole().findCityCode(a))&&(b=this._cityEntities.get(a));return b};MO.FEaiMapEntity_upload=function(){this._citysRenderable.upload();this._citysRangeRenderable.upload()};
MO.FEaiMapEntity_process=function(a){var b=!1,b=this._provinceEntities;a=b.count();for(var c=0;c<a;c++)b.at(c).process();var b=!1,d=this._cityEntities;a=d.count();for(c=0;c<a;c++)d.at(c).process()&&(b=!0);b&&this.upload()};MO.FEaiMapEntity_reset=function(){for(var a=this._provinceEntities,b=a.count(),c=0;c<b;c++)a.at(c).reset();a=this._cityEntities;b=a.count();for(c=0;c<b;c++)a.at(c).reset()};
MO.FEaiMapEntity_dispose=function(){this._countryEntity=MO.Lang.Object.dispose(this._countryEntity);this._provinceEntities=MO.Lang.Object.dispose(this._provinceEntities);this._cityEntities=MO.Lang.Object.dispose(this._cityEntities);this._citysRenderable=MO.Lang.Object.dispose(this._citysRenderable);this._citysRangeRenderable=MO.Lang.Object.dispose(this._citysRangeRenderable);this._countryDisplay=MO.Lang.Object.dispose(this._countryDisplay);this._countryBorderDisplay=MO.Lang.Object.dispose(this._countryBorderDisplay);
this.__base.FEaiEntity.dispose.call(this)};MO.FEaiMapFaceEffect=function(a){a=MO.Class.inherits(this,a,MO.FG3dAutomaticEffect);a._code="eai.map.face";a.drawRenderable=MO.FEaiMapFaceEffect_drawRenderable;return a};
MO.FEaiMapFaceEffect_drawRenderable=function(a,b){var c=this._graphicContext,d=this._program,e=a.calculate(MO.EG3dRegionParameter.CameraViewProjectionMatrix),f=b.material();f.info();this.bindMaterial(f);for(var f=b.mergeRenderables(),g=f.count(),h=MO.Lang.TypeArray.findTemp(MO.EDataType.Float32,16*g),k=0;k<g;k++){var m=16*k,l=f.at(k),r=l.matrix(),l=l.color();r.writeData(h,m);h[m+12]=l.red;h[m+13]=l.green;h[m+14]=l.blue;h[m+15]=l.alpha}d.setParameter("vc_data",h);f=b.display().currentMatrix();d.setParameter("vc_model_matrix",
f);d.setParameter("vc_vp_matrix",e);this.bindAttributes(b);d=b.indexBuffers().first();c.drawTriangles(d)};MO.FEaiProvinceData=function(a){a=MO.Class.inherits(this,a,MO.FEaiEntity);a._code=MO.Class.register(a,new MO.AGetSet("_code"));a._boundaries=MO.Class.register(a,new MO.AGetter("_boundaries"));a.construct=MO.FEaiProvinceData_construct;a.unserialize=MO.FEaiProvinceData_unserialize;a.dispose=MO.FEaiProvinceData_dispose;return a};
MO.FEaiProvinceData_construct=function(){this.__base.FEaiEntity.construct.call(this);this._boundaries=new MO.TObjects};MO.FEaiProvinceData_unserialize=function(a){this._code=a.readUint16();for(var b=a.readInt32(),c=0;c<b;c++){var d=MO.Class.create(MO.FEaiBoundaryData);d.unserialize(a);this._boundaries.push(d)}};MO.FEaiProvinceData_dispose=function(){this._boundaries=MO.Lang.Object.dispose(this._boundaries);this.__base.FEaiEntity.dispose.call(this)};
MO.FEaiProvinceEntity=function(a){a=MO.Class.inherits(this,a,MO.FEaiEntity);a._mapEntity=MO.Class.register(a,new MO.AGetSet("_mapEntity"));a._data=MO.Class.register(a,new MO.AGetSet("_data"));a._faceRenderable=MO.Class.register(a,new MO.AGetter("_faceRenderable"));a._borderRenderable=MO.Class.register(a,new MO.AGetter("_borderRenderable"));a._layerDepth=3;a._currentZ=MO.Class.register(a,new MO.AGetter("_currentZ"),0);a._focusTick=0;a._focusInterval=10;a._focusCurrent=0;a._focusColor=null;a._focusCount=
200;a.construct=MO.FEaiProvinceEntity_construct;a.buildFace=MO.FEaiProvinceEntity_buildFace;a.buildBorder=MO.FEaiProvinceEntity_buildBorder;a.build=MO.FEaiProvinceEntity_build;a.doInvestment=MO.FEaiProvinceEntity_doInvestment;a.updateColor=MO.FEaiProvinceEntity_updateColor;a.update=MO.FEaiProvinceEntity_update;a.process=MO.FEaiProvinceEntity_process;a.reset=MO.FEaiProvinceEntity_reset;a.dispose=MO.FEaiProvinceEntity_dispose;return a};
MO.FEaiProvinceEntity_construct=function(){this.__base.FEaiEntity.construct.call(this);var a=this._focusColors=[];a[0]=[40,66,180];a[1]=[40,66,180];a[2]=[27,162,188];a[3]=[255,223,111];a[4]=[255,107,73];a[5]=[255,107,73]};
MO.FEaiProvinceEntity_buildFace=function(a){for(var b=this._data.boundaries(),c=b.count(),d=this._vertexTotal,e=this._indexTotal,f=0,g=0,h=new Float32Array(6*d),k=0,e=new Uint16Array(e+6*d),m=0;m<c;m++){for(var l=b.at(m),r=l.positionCount(),p=l.positions(),n=0,q=0;q<r;q++)h[g++]=p[n++],h[g++]=p[n++],h[g++]=0;l=l.indexes();p=l.length/3;for(q=0;q<p;q++)n=3*q,e[k++]=f+l[n+2],e[k++]=f+l[n+1],e[k++]=f+l[n];f+=r}for(var u=f,m=0;m<c;m++)for(l=b.at(m),r=l.positionCount(),p=l.positions(),q=n=0;q<r;q++)h[g++]=
p[n++],h[g++]=p[n++],h[g++]=this._layerDepth;for(m=f=0;m<c;m++){l=b.at(m);r=l.positionCount();for(q=0;q<r;q++)q==r-1?(e[k++]=f+q,e[k++]=f+0,e[k++]=f+q+u,e[k++]=f+0,e[k++]=f+u):(e[k++]=f+q,e[k++]=f+q+1,e[k++]=f+q+u,e[k++]=f+q+1,e[k++]=f+q+u+1),e[k++]=f+q+u;f+=r}c=0;b=this.colorsData=new Uint8Array(8*d);f=2*d;for(q=0;q<f;q++)b[c++]=255,b[c++]=255,b[c++]=255,b[c++]=255;q=this._faceRenderable=MO.Class.create(MO.FE3dDataBox);q.setVertexCount(2*d);q.linkGraphicContext(a);q.setup();q.color().setHex("#080D19");
q.vertexPositionBuffer().upload(h,12,2*d,!0);q.vertexColorBuffer().upload(b,4,2*d,!0);q.indexBuffer().upload(e,k,!0);q.material().info().effectCode="eai.map.face"};
MO.FEaiProvinceEntity_buildBorder=function(a){for(var b=this._data.boundaries(),c=b.count(),d=this._vertexTotal,e=0,f=0,g=new Float32Array(6*d),h=0,k=new Uint16Array(2*d+2*d),m=0;m<c;m++){for(var l=b.at(m),r=l.positionCount(),p=l.positions(),n=0,l=0;l<r;l++)g[f++]=p[n++],g[f++]=p[n++],g[f++]=0;for(l=0;l<r;l++)k[h++]=e+l,l==r-1?k[h++]=e:k[h++]=e+l+1;e+=r}for(var q=e,m=0;m<c;m++){l=b.at(m);r=l.positionCount();p=l.positions();for(l=n=0;l<r;l++)g[f++]=p[n++],g[f++]=p[n++],g[f++]=this._layerDepth;e+=r}for(m=
e=0;m<c;m++){l=b.at(m);r=l.positionCount();for(l=0;l<r;l++)k[h++]=e+l,k[h++]=e+l+q;e+=r}c=0;b=this.colorsData=new Uint8Array(8*d);for(l=0;l<d;l++)b[c++]=0,b[c++]=181,b[c++]=246,b[c++]=255;for(l=0;l<d;l++)b[c++]=11,b[c++]=17,b[c++]=35,b[c++]=255;l=this._borderRenderable=MO.Class.create(MO.FE3dDataBox);l.linkGraphicContext(a);l.setup();l.setVertexCount(2*d);l.vertexPositionBuffer().upload(g,12,2*d,!0);l.vertexColorBuffer().upload(b,4,2*d,!0);l.indexBuffer().setDrawModeCd(MO.EG3dDrawMode.Lines);l.indexBuffer().setLineWidth(1);
l.indexBuffer().upload(k,h,!0);l.material().info().effectCode="eai.map.face"};MO.FEaiProvinceEntity_build=function(a){for(var b=0,c=0,d=this._data.boundaries(),e=d.count(),f=0;f<e;f++)var g=d.at(f),b=b+g.positionCount(),c=c+g.indexes().length;this._vertexTotal=b;this._indexTotal=c;this.buildFace(a);this.buildBorder(a)};MO.FEaiProvinceEntity_doInvestment=function(a,b){this._focusTick=0;this._focusCurrent=this._focusCount;this._focusColor=this._focusColors[a]};
MO.FEaiProvinceEntity_update=function(a){a=a.investmentTotal();Math.sqrt(a)};MO.FEaiProvinceEntity_updateColor=function(a){var b=this._focusColor;a=this._focusCurrent/this._focusCount;var c=8+(b[0]-8)*a,d=13+(b[1]-13)*a;a=25+(b[2]-25)*a;this._faceRenderable.color().set(c/255,d/255,a/255,1)};
MO.FEaiProvinceEntity_process=function(){if(0<this._focusCurrent){var a=MO.Timer.current();if(a-this._focusTick>this._focusInterval){var b=this._currentZ=-this._focusCurrent/60;faceRenderable=this._faceRenderable;matrix=faceRenderable.matrix();matrix.tz=b;matrix.updateForce();borderRenderable=this._borderRenderable;matrix=borderRenderable.matrix();matrix.tz=b;matrix.updateForce();this.updateColor(this._focusCurrent);this._focusCurrent--;this._focusTick=a}}};
MO.FEaiProvinceEntity_reset=function(){this._focusCurrent=this._focusTick=this._currentZ=0};MO.FEaiProvinceEntity_dispose=function(){this.__base.FEaiEntity.dispose.call(this)};
MO.FEaiProvinceEntityConsole=function(a){a=MO.RClass.inherits(this,a,MO.FObject);a._provinces=MO.Class.register(a,new MO.AGetter("_provinces"));a.construct=MO.FEaiProvinceEntityConsole_construct;a.findByCode=MO.FEaiProvinceEntityConsole_findByCode;a.push=MO.FEaiProvinceEntityConsole_push;a.dispose=MO.FEaiProvinceEntityConsole_dispose;return a};MO.FEaiProvinceEntityConsole_construct=function(){this.__base.FObject.construct.call(this);this._provinces=MO.TDictionary()};
MO.FEaiProvinceEntityConsole_findByCode=function(a){return this._provinces.get(a)};MO.FEaiProvinceEntityConsole_push=function(a){var b=a.data().code();this._provinces.set(b,a)};MO.FEaiProvinceEntityConsole_dispose=function(a){this._provinces=RObject.dispose(this._provinces);this.__base.FObject.dispose.call(this)};
with(MO)MO.FGui24HTimeline=function(a){a=RClass.inherits(this,a,FGuiControl);a._startTime=RClass.register(a,new AGetSet("_startTime"));a._endTime=RClass.register(a,new AGetSet("_endTime"));a._data=null;a._ready=!1;a._investmentTotal=0;a._intervalMiniute=10;a._baseHeight=5;a._degreeLineHeight=RClass.register(a,new AGetSet("_degreeLineHeight"),10);a._triangleWidth=RClass.register(a,new AGetSet("_triangleWidth"),10);a._triangleHeight=RClass.register(a,new AGetSet("_triangleHeight"),12);a._decoLineGap=
RClass.register(a,new AGetSet("_decoLineGap"),10);a._decoLineWidth=RClass.register(a,new AGetSet("_decoLineWidth"),30);a.oeUpdate=FGui24HTimeline_oeUpdate;a.construct=FGui24HTimeline_construct;a.sync=FGui24HTimeline_sync;a.onPaintBegin=FGui24HTimeline_onPaintBegin;a.on24HDataFetch=FGui24HTimeline_on24HDataFetch;return a},MO.FGui24HTimeline_construct=function(){this.__base.FGuiControl.construct.call(this);this._startTime=new TDate;this._endTime=new TDate},MO.FGui24HTimeline_sync=function(){if(this._ready){var a=
MO.Console.find(MO.FEaiLogicConsole).system();if(a.testReady()){a=a.currentDate();a.truncMinute(this._intervalMiniute);var b=this._startTime;b.assign(a);b.addDay(-1);var c=this._endTime;c.assign(a);MO.Console.find(MO.FEaiLogicConsole).statistics().doInvestmentTrend(this,this.on24HDataFetch,b.format(),c.format(),60*this._intervalMiniute)}}},MO.FGui24HTimeline_on24HDataFetch=function(a){this._investmentTotal=0;if(a=this._data=a.content.collection)for(var b=a.length,c=0;c<b;c++)this._investmentTotal+=
parseFloat(a[c].investment);this.dirty()},MO.FGui24HTimeline_oeUpdate=function(a){this.__base.FGuiControl.oeUpdate.call(this,a);if(!this._ready)return MO.Console.find(MO.FEaiLogicConsole).system().testReady()&&(this._ready=!0,this.sync()),MO.EEventStatus.Stop},MO.FGui24HTimeline_onPaintBegin=function(a){if(this._ready){this.__base.FGuiControl.onPaintBegin.call(this,a);var b=a.graphic,c=a.rectangle,d=c.top,e=c.top+c.height,f=e-30;a=c.left+5;var c=c.left+c.width-5,g=this.triangleWidth()+this.decoLineGap();
b.drawTriangle(a,f,a+this.triangleWidth(),f+this.triangleHeight()/2,a+this.triangleWidth(),f-this.triangleHeight()/2,1,"#F8CB3D","#F8CB3D");b.drawTriangle(c,f,c-this.triangleWidth(),f+this.triangleHeight()/2,c-this.triangleWidth(),f-this.triangleHeight()/2,1,"#F8CB3D","#F8CB3D");b.drawLine(a+g,f,a+g+this.decoLineWidth(),f,"#F8CB3D",3);b.drawLine(c-g,f,c-g-this.decoLineWidth(),f,"#F8CB3D",3);var h=a+g+this.decoLineWidth(),k=c-g-this.decoLineWidth(),g=d+60,m=e-30,l=m-g;b.drawLine(h,f,k,f,"#F8CB3D",
3);for(var e=this.startTime(),r=this.endTime(),p=r.date.getTime()-e.date.getTime(),c=e.date.getTime(),n,q=!1,u=0;!e.isAfter(r);){var t=e.date.getTime()-c,t=h+t/p*(k-h);b.drawLine(t,f-this.degreeLineHeight(),t,f,"#FFFFFF",1);n=e.format("HH24:00");e.addHour(1);if(q=!q)b.setFont("bold 20px Microsoft YaHei"),u=b.textWidth(n),b.drawText(n,t-u/2,f+20,"#59FDE9")}e.date.setTime(c);e.refresh();if((u=this._data)&&!(1>u.length)){for(f=q=0;f<u.length;f++)r=parseInt(u[f].investment),r>q&&(q=r);n=1E4*l/q;r=parseInt(u[0].investment);
l=m-r/1E4*n;r=b._handle;r.lineCap="round";r.beginPath();r.moveTo(h,l);q=MO.Console.find(MO.FEaiResourceConsole).rateConsole().find(EEaiRate.Investment);for(f=1;f<u.length;f++){e.parseAuto(u[f].date);e.refresh();var t=e.date.getTime()-c,t=h+t/p*(k-h),w=m-u[f].investment/1E4*n,w=w-this._baseHeight;r.lineTo(t,w)}n=MO.Lang.Hex.format(q.findRate(0));p="#"+n.substring(2);k="rgba("+MO.Lang.Hex.parse(n.substring(2,4))+","+MO.Lang.Hex.parse(n.substring(4,6))+","+MO.Lang.Hex.parse(n.substring(6,8))+",0.5)";
n=MO.Lang.Hex.format(q.findRate(1));f="#"+n.substring(2);q="rgba("+MO.Lang.Hex.parse(n.substring(2,4))+","+MO.Lang.Hex.parse(n.substring(4,6))+","+MO.Lang.Hex.parse(n.substring(6,8))+",0.5)";n=b.createLinearGradient(0,m,0,g);n.addColorStop("0",p);n.addColorStop("1",f);g=b.createLinearGradient(0,m,0,g);g.addColorStop("0",k);g.addColorStop("1",q);r.strokeStyle=n;r.fillStyle=g;r.lineWidth=4;r.stroke();r.lineTo(t,m);r.lineTo(h,m);r.lineTo(h,l);r.fill();e.date.setTime(c);e.refresh();t=-1;h=g=0;e.parseAuto(u[0].date);
e.refresh();t=e.date.getHours();for(f=0;f<u.length;f++)e.parseAuto(u[f].date),e.refresh(),m=e.date.getHours(),t==m?g+=parseInt(u[f].investment):(g>h&&(h=g,g=0),t=m);b.setFont("bold 24px Microsoft YaHei");b.drawText("24\u5c0f\u65f6\u6295\u8d44\u66f2\u7ebf",a,d,"#54F0FF");b.setFont("22px Microsoft YaHei");d+=30;u=b.textWidth("\u5c0f\u65f6\u5cf0\u503c\uff1a");h=MO.Lang.Float.unitFormat(h,0,0,2,0,1E4,"\u4e07");t=b.textWidth(h);g=MO.Lang.Float.unitFormat(this._investmentTotal,0,0,2,0,1E4,"\u4e07");m=b.textWidth(g);
k=MO.Lang.Float.unitFormat(this._investmentTotal/24,0,0,2,0,1E4,"\u4e07");p=b.textWidth(k);f=Math.max(Math.max(t,m),p);b.drawText("24H\u603b\u989d\uff1a",a,d+0,"#00CFFF");b.drawText(g,a+u+f-m,d+0,"#00B5F6");b.drawText("\u5c0f\u65f6\u5cf0\u503c\uff1a",a,d+22+5,"#00CFFF");b.drawText(h,a+u+f-t,d+22+5,"#00B5F6");b.drawText("\u5c0f\u65f6\u5747\u503c\uff1a",a,d+44+10,"#00CFFF");b.drawText(k,a+u+f-p,d+44+10,"#00B5F6");e.date.setTime(c);e.refresh()}}};
with(MO)MO.FGuiHistoryMilestoneBar=function(a){a=RClass.inherits(this,a,FGuiControl);a._bgImage=null;a._wanBGImage=null;a._yiBGImage=null;a._numImages=null;a._wanImage=null;a._yiImage=null;a._data=RClass.register(a,new AGetSet("_data"));a._fullWidth=0;a._fullHeight=0;a.setup=FGuiHistoryMilestoneBar_setup;a.onPaintBegin=FGuiHistoryMilestoneBar_onPaintBegin;a.dispose=FGuiHistoryMilestoneBar_dispose;return a},MO.FGuiHistoryMilestoneBar_setup=function(a){this._data=a;var b=MO.Console.find(MO.FImageConsole);
this._wanBGImage=b.load("{eai.resource}/milestone/bar_wan.png");this._yiBGImage=b.load("{eai.resource}/milestone/bar_yi.png");this._wanImage=b.load("{eai.resource}/number_2/wan.png");this._yiImage=b.load("{eai.resource}/number_2/yi.png");this._numImages=Array(10);for(var c=0;10>c;c++)this._numImages[c]=b.load("{eai.resource}/number_2/"+c+".png");1E4<=a.investmentTotal()?(this._bgImage=this._yiBGImage,this.setWidth(371),this.setHeight(80)):(this._bgImage=this._wanBGImage,this.setWidth(341),this.setHeight(76))},
MO.FGuiHistoryMilestoneBar_onPaintBegin=function(a){if(this._data){this.__base.FGuiControl.onPaintBegin.call(this,a);a=a.graphic;var b=this._clientRectangle,c=this._bgImage._size;a.drawImage(this._bgImage,b.left,b.top,c.width,c.height);var d=b.left+25,e=b.top+b.height/2,c=1,f=this.data().investmentTotal().toString();if(4<f.length){c=.53;a.setFont("22px Microsoft YaHei");var e=e+10,f=f.substring(0,f.length-4),g=this._yiImage}else c=.35,a.setFont("18px Microsoft YaHei"),e+=6,g=this._wanImage;var h=
this.data().code(),h=h.substring(0,4)+"\u5e74"+h.substring(4,6)+"\u6708"+h.substring(6,8)+"\u65e5";a.textWidth(h);a.drawText(h,d,e,"#FFEE78");for(var d=this._numImages[0]._size,e=this._yiImage._size,h=b.left+b.width-(f.length*d.width*c+e.width*c)-55,b=b.top+(b.height-d.height*c)/2,k=0;k<f.length;k++)a.drawImage(this._numImages[f[k]],h+k*d.width*c,b,d.width*c,d.height*c);a.drawImage(g,h+f.length*d.width*c,b,e.width*c,e.height*c)}},MO.FGuiHistoryMilestoneBar_dispose=function(){this.__base.FGuiControl.dispose.call(this)};
with(MO)MO.FGuiHistoryMilestoneFrame=function(a){a=RClass.inherits(this,a,FGuiControl);a._bgImage=null;a._numImages=null;a._wanImage=null;a._yiImage=null;a._data=RClass.register(a,new AGetSet("_data"));a._startTick=0;a._popDuration=400;a._showDuration=3E3;a._closeDuration=400;a._fullWidth=953;a._fullHeight=896;a._popupSE=null;a._100yiSE=null;a._listenersDataChanged=RClass.register(a,new AListener("_listenersDataChanged",MO.EEvent.DataChanged));a.setup=FGuiHistoryMilestoneFrame_setup;a.onPaintBegin=
FGuiHistoryMilestoneFrame_onPaintBegin;a.onImageLoad=FGuiHistoryMilestoneFrame_onImageLoad;a.show=FGuiHistoryMilestoneFrame_show;a.dispose=FGuiHistoryMilestoneFrame_dispose;return a},MO.FGuiHistoryMilestoneFrame_setup=function(){this.setWidth(this._fullWidth);this.setHeight(this._fullHeight);this.setLeft((MO.Eai.Canvas.logicSize().width-this._fullWidth)/2);this.setTop(MO.Eai.Canvas.logicSize().height);this._bgImage=MO.Class.create(MO.FImage);this._bgImage.addLoadListener(this,this.onImageLoad);this._bgImage.loadUrl("{eai.resource}/milestone/bg.png");
this._wanImage=MO.Class.create(MO.FImage);this._wanImage.addLoadListener(this,this.onImageLoad);this._wanImage.loadUrl("{eai.resource}/number/wan.png");this._yiImage=MO.Class.create(MO.FImage);this._yiImage.addLoadListener(this,this.onImageLoad);this._yiImage.loadUrl("{eai.resource}/number/yi.png");this._numImages=Array(10);for(var a=0;10>a;a++){var b=MO.Class.create(MO.FImage);b.addLoadListener(this,this.onImageLoad);b.loadUrl("{eai.resource}/number/"+a+".png");this._numImages[a]=b}a=MO.Console.find(MO.FAudioConsole);
this._popupSE=a.load("{eai.resource}/milestone/popup.mp3");this._100yiSE=a.load("{eai.resource}/milestone/100yi.mp3")},MO.FGuiHistoryMilestoneFrame_onImageLoad=function(){this.dirty()},MO.FGuiHistoryMilestoneFrame_onPaintBegin=function(a){if(this._data){this.__base.FGuiControl.onPaintBegin.call(this,a);a=a.graphic;var b=this._clientRectangle,c=this._bgImage._size,d=b.left+b.width/2,e=d-135,f=b.top+520,g=MO.Timer.current()-this._startTick,h=g-this._popDuration,k=g-this._showDuration-this._popDuration,
m=(MO.Eai.Canvas.logicSize().height+this._fullHeight)/2+50-this._fullHeight,l=0;if(g<this._popDuration)l=g/this._popDuration,l=1-(1-l)*(1-l),a._handle.globalAlpha=l,this.setTop(MO.Eai.Canvas.logicSize().height-this._fullHeight-m*l);else if(!(h<this._showDuration))if(k<this._closeDuration)l=k/this._closeDuration,l*=l,a._handle.globalAlpha=1-l,this.setTop((MO.Eai.Canvas.logicSize().height-this._fullHeight)/2-50-m*l);else{this._data=null;this.setVisible(!1);this.setTop(MO.Eai.Canvas.logicSize().height-
this._fullHeight);this.dirty();a=MO.Memory.alloc(SEvent);a.sender=this;this.processDataChangedListener(a);return}a.drawImage(this._bgImage,d-c.width/2,b.top,c.width,c.height);a.setFont("bold 28px Microsoft YaHei");a.drawText("\u8fbe\u6210\u65e5\u6570\uff1a",e,f+50,"#FF9103");a.drawText("\u5206\u516c\u53f8\u6570\uff1a",e,f+100,"#FF9103");a.drawText("\u7406\u8d22\u5e08\u6570\uff1a",e,f+150,"#FF9103");if(this.data()){c=this.data().investmentTotal().toString();4<c.length?(c=c.substring(0,c.length-4),
g=this._yiImage):g=this._wanImage;h=this._numImages[0]._size;k=this._yiImage._size;m=d-(c.length*h.width+k.width)/2;for(l=0;l<c.length;l++)a.drawImage(this._numImages[c[l]],m+l*h.width,b.top+320,h.width,h.height);a.drawImage(g,m+c.length*h.width,b.top+320,k.width,k.height);c="";g=0;a.setFont("48px Microsoft YaHei");b=b.top+280;h=this.data().code();c=h.substring(0,4)+"\u5e74"+h.substring(4,6)+"\u6708"+h.substring(6,8)+"\u65e5\u8fbe\u6210";g=a.textWidth(c);d=d-g/2-10;c=h.substring(0,4);g=a.textWidth(c);
a.drawText(c,d,b,"#FFEE78");d+=g;c="\u5e74";g=a.textWidth(c);a.drawText(c,d,b,"#FF9103");d+=g;c=h.substring(4,6);g=a.textWidth(c);a.drawText(c,d,b,"#FFEE78");d+=g;c="\u6708";g=a.textWidth(c);a.drawText(c,d,b,"#FF9103");d+=g;c=h.substring(6,8);g=a.textWidth(c);a.drawText(c,d,b,"#FFEE78");d+=g;c="\u65e5\u8fbe\u6210";a.textWidth(c);a.drawText(c,d,b,"#FF9103");a.setFont("bold 28px Microsoft YaHei");c=this.data().dayCount();g=a.textWidth(c);a.drawText(c,e+250-g,f+50,"#FFEE78");c=this.data().companyCount();
g=a.textWidth(c);a.drawText(c,e+250-g,f+100,"#FFEE78");c=this.data().staffCount();g=a.textWidth(c);a.drawText(c,e+250-g,f+150,"#FFEE78")}a._handle.globalAlpha=1}},MO.FGuiHistoryMilestoneFrame_show=function(){o=this;o.setVisible(!0);o._startTick=MO.Timer.current();1E6==o.data().investmentTotal()&&o._100yiSE.play(0);o._popupSE.play(0)},MO.FGuiHistoryMilestoneFrame_dispose=function(){this.__base.FEaiEntity.dispose.call(this)};
MO.FGuiHistoryTimeline=function(a){a=MO.Class.inherits(this,a,MO.FGuiTimeline);a._startHeight=30;a._lineWidth=5;a._circleRadius=5;a._timeFontColor="#00B5F6";a._cursorFontColor="#59FDE9";a.onPaintBegin=MO.FGuiHistoryTimeline_onPaintBegin;return a};
MO.FGuiHistoryTimeline_onPaintBegin=function(a){this.__base.FGuiTimeline.onPaintBegin.call(this,a);var b=a.graphic,c=a.rectangle,d=c.top;a=c.bottom()-50;var e=a-(d+30+this._startHeight),f=this.triangleWidth()+this.decoLineGap(),d=c.left+5+f+this.decoLineWidth(),c=c.left+c.width-5-f-this.decoLineWidth(),f=this.startTime(),g=this.endTime(),h=this.degreeTime(),k=f.date.getTime(),m=g.date.getTime()-f.date.getTime(),l=MO.Console.find(MO.FEaiResourceConsole).historyConsole(),r=l.investmentTotal(),p=l.dates().get(g.format("YYYYMMDD")),
g=p.investmentTotal(),n=l.dates().get(h.format("YYYYMMDD"));3*n.investmentTotal()<r&&(g=g*(n.investmentTotal()/r)*3);for(var e=1E4*e/g,p=l.dates().get(f.format("YYYYMMDD")),q=p.investmentTotal(),g=d,n=a-q/1E4*e-this._startHeight,u=MO.Console.find(MO.FEaiResourceConsole).rateConsole().find(MO.EEaiRate.Line);f.isBefore(h);)if(p=l.dates().get(f.format("YYYYMMDD"))){var t=f.date.getTime()-k,t=d+t/m*(c-d),w=p.investmentTotal(),p=a-w/1E4*e,p=p-this._startHeight,v=MO.Lang.Hex.format(u.findRate(w/r)),w="#"+
v.substring(2),v=MO.GuiColor.makeRgbString(v,.3);b.drawLine(g,n,t,p,w,this._lineWidth);var x=b.createLinearGradient(0,a,0,p),y=MO.Lang.Hex.format(u.find(0)),y=MO.GuiColor.makeRgbString(y,.3);x.addColorStop("0",y);x.addColorStop("1",v);b.drawQuadrilateral(g,n,t,p,t,a,g,a,null,null,x);1==f.date.getDate()&&(v=MO.Lang.Float.unitFormat(q,0,0,0,0,1E4,"\u4e07"),b.drawCircle(t,p,this._circleRadius,0,w,w));g=t;n=p;f.addDay(1)}else break;f.date.setTime(k);for(f.refresh();f.isBefore(h);)if(p=l.dates().get(f.format("YYYYMMDD")))t=
f.date.getTime()-k,t=d+t/m*(c-d),q=p.investmentTotal(),p=a-q/1E4*e,p-=this._startHeight,1==f.date.getDate()&&(b.setFont("bold 22px Microsoft YaHei"),1E8<q?(v=MO.Lang.Float.unitFormat(q,0,0,2,0,1E8,"\u4ebf"),q=b.textWidth(v),b.drawText(v,t-q/2,p-16,"#FFE849")):(v=parseInt(q/1E4)+"\u4e07",q=b.textWidth(v),b.drawText(v,t-q/2,p-16,"#FF7200"))),f.addDay(1);else break;if(p=l.dates().get(f.format("YYYYMMDD")))t=f.date.getTime()-k+this.unitms()*this.progress(),t=d+t/m*(c-d),q=p.investmentTotal(),p=a-q/1E4*
e-this._startHeight,v=MO.Lang.Hex.format(u.findRate(q/r)),w="#"+v.substring(2),v=MO.GuiColor.makeRgbString(v,.3),b.drawLine(g,n,t,n+(p-n)*this.progress(),w,this._lineWidth),x=b.createLinearGradient(0,a,0,p),y=MO.Lang.Hex.format(u.find(0)),y=MO.GuiColor.makeRgbString(y,.3),x.addColorStop("0",y),x.addColorStop("1",v),b.drawQuadrilateral(g,n,t,p,t,a,g,a,null,null,x),b.drawCircle(t,n+(p-n)*this.progress(),this._circleRadius,0,w,w),b.setFont("bold 22px Microsoft YaHei"),1E8<q?(v=MO.Lang.Float.unitFormat(q,
0,0,2,0,1E8,"\u4ebf"),q=b.textWidth(v),b.drawText(v,t-q/2,p-16,"#FFE849")):(v=parseInt(q/1E4)+"\u4e07",q=b.textWidth(v),b.drawText(v,t-q/2,p-16,"#FF7200"));f.date.setTime(k);f.refresh()};
MO.FGuiLivePop=function(a){a=MO.Class.inherits(this,a,MO.FGuiControl);a._bgImage=null;a._data=MO.Class.register(a,new MO.AGetSet("_data"));a._startTick=0;a._popDuration=500;a._showDuration=2E3;a._closeDuration=500;a._fullWidth=910;a._fullHeight=140;a._riseHeight=50;a._date=null;a.construct=MO.FGuiLivePop_construct;a.setup=MO.FGuiLivePop_setup;a.onPaintBegin=MO.FGuiLivePop_onPaintBegin;a.onImageLoad=MO.FGuiLivePop_onImageLoad;a.show=MO.FGuiLivePop_show;a.dispose=MO.FGuiLivePop_dispose;return a};
MO.FGuiLivePop_construct=function(){this.__base.FGuiControl.construct.call(this);this._date=new MO.TDate};MO.FGuiLivePop_setup=function(){this.setWidth(this._fullWidth);this.setHeight(this._fullHeight);this.setLeft((MO.Eai.Canvas.logicSize().width-this._fullWidth)/3);this.setTop((MO.Eai.Canvas.logicSize().height-this._fullHeight)/2+this._riseHeight);this._bgImage=MO.Class.create(MO.FImage);this._bgImage.addLoadListener(this,this.onImageLoad);this._bgImage.loadUrl("{eai.resource}/invespop.png")};
MO.FGuiLivePop_onImageLoad=function(){this.dirty()};
MO.FGuiLivePop_onPaintBegin=function(a){this.__base.FGuiControl.onPaintBegin.call(this,a);if(this._data){a=a.graphic;var b=this._clientRectangle,c=this._data,d=MO.Console.find(MO.FEaiEntityConsole).cityConsole().findByCard(c.card()),e="";this._date.parse(c.date());e+=this._date.format("HH24:MI:SS");e+="    ";d&&(e+=d.data().label());e=e+"    "+(c.customer()+" - "+c.phone());e+="    ";e+=MO.Lang.Float.format(c.investment(),null,null,2,"0");a.setFont("36px Microsoft YaHei");popTextWidth=a.textWidth(e);
var c=MO.Timer.current()-this._startTick,d=c-this._popDuration,f=c-this._showDuration-this._popDuration,g=0;c<this._popDuration?(g=c/this._popDuration,a._handle.globalAlpha=g,a.drawImage(this._bgImage,b.left,b.top,this._fullWidth,this._fullHeight),a._handle.globalAlpha=1,this.setTop((MO.Eai.Canvas.logicSize().height-this._fullHeight)/2+this._riseHeight*(1-g)),a.drawText(e,b.left+(b.width-popTextWidth)/2,b.top+80,"rgba(255, 241, 0, "+g+")")):d<this._showDuration?(a.drawImage(this._bgImage,b.left,b.top,
this._fullWidth,this._fullHeight),a.drawText(e,b.left+(b.width-popTextWidth)/2,b.top+80,"rgba(255, 241, 0, 1)")):f<this._closeDuration?(g=f/this._closeDuration,a._handle.globalAlpha=1-g,a.drawImage(this._bgImage,b.left,b.top,this._fullWidth,this._fullHeight),a._handle.globalAlpha=1,this.setTop((MO.Eai.Canvas.logicSize().height-this._fullHeight)/2-this._riseHeight*g),a.drawText(e,b.left+(b.width-popTextWidth)/2,b.top+80,"rgba(255, 241, 0, "+(1-g)+")")):(this._data=null,this.setVisible(!1),this.dirty())}};
MO.FGuiLivePop_show=function(){o=this;o.setVisible(!0);o._startTick=MO.Timer.current();o.dirty()};MO.FGuiLivePop_dispose=function(){this._date=MO.Lang.Object.dispose(this._date);this.__base.FGuiControl.dispose.call(this)};
MO.FGuiLiveTable=function(a){a=MO.Class.inherits(this,a,MO.FGuiControl);a._currentDate=null;a._rank=MO.Class.register(a,new MO.AGetSet("_rank"));a._rankLogoImage=null;a._rankTitleImage=null;a._rankLineImage=null;a._rankLinePadding=null;a._rank1Image=null;a._rank2Image=null;a._rank3Image=null;a._backgroundImage=null;a._backgroundPadding=null;a._columnLabels=null;a._columnDefines=null;a._columnWidths=null;a._tableCount=0;a._entities=null;a._lineScroll=0;a._listenersDataChanged=MO.Class.register(a,new MO.AListener("_listenersDataChanged",
MO.EEvent.DataChanged));a.onImageLoad=MO.FGuiLiveTable_onImageLoad;a.onPaintBegin=MO.FGuiLiveTable_onPaintBegin;a.oeUpdate=MO.FGuiLiveTable_oeUpdate;a.construct=MO.FGuiLiveTable_construct;a.setup=MO.FGuiLiveTable_setup;a.pushEntity=MO.FGuiLiveTable_pushEntity;a.drawRow=MO.FGuiLiveTable_drawRow;a.dispose=MO.FGuiLiveTable_dispose;return a};MO.FGuiLiveTable_onImageLoad=function(){this.dirty()};
MO.FGuiLiveTable_onPaintBegin=function(a){this.__base.FGuiControl.onPaintBegin.call(this,a);var b=a.graphic,c=a.rectangle,d=c.left;a=c.top;for(var e=c.width,f=c.height,c=d+12,g=d+e-d,h=0,k=0;4>k;k++)h+=this._columnDefines[k];for(k=0;4>k;k++)this._columnWidths[k]=this._columnDefines[k]/h*g-7;b.drawGridImage(this._backgroundImage,d,a,e,f,this._backgroundPadding);b.setFont(this._headFontStyle);k=b.textWidth("\u5168\u7403\u5b9e\u65f6\u6295\u8d44\u6570\u636e\u5c55\u793a\u4e2d\u5fc3(\u4e2d\u56fd)");b.drawText("\u5168\u7403\u5b9e\u65f6\u6295\u8d44\u6570\u636e\u5c55\u793a\u4e2d\u5fc3(\u4e2d\u56fd)",
d+.5*(e-k),a+76,"#59FDE9");b.setFont(this._rowFontStyle);f=a+this._rankStart;b.drawGridImage(this._rankLineImage,d+6,f+this._rankTitleStart,e-22,this._rankHeight,this._rankLinePadding);b.drawImage(this._rankTitleImage,d+.5*(e-167),f+3,167,40);if(h=this._rank)for(d=h.count(),f+=90,k=0;k<d;k++)e=h.at(k),this.drawRow(b,e,!0,k,c,f+this._rankRowHeight*k,g);for(var d="",e=0,f=c,h=a+this._headStart,m=h+this._headTextTop,k=0;4>k;k++)d=this._columnLabels[k],e=b.textWidth(d),b.fillRectangle(f,h,this._columnWidths[k]-
4,this._headHeight,"#122A46"),b.drawText(d,f+.5*(this._columnWidths[k]-e-4),m,"#00B2F2"),f+=this._columnWidths[k];h=this._entities;if(!h.isEmpty())for(f=a+this._rowStart,b.clip(c,f,g-38,this._rowHeight*(this._tableCount-1)),f+=24,d=h.count(),k=0;k<d;k++)e=h.at(k),this.drawRow(b,e,!1,k,c,f+this._rowHeight*k+this._lineScroll,g)};
MO.FGuiLiveTable_oeUpdate=function(a){this.__base.FGuiControl.oeUpdate.call(this,a);a.isBefore()&&0>this._lineScroll&&(this._lineScroll++,0==this._lineScroll&&(a=this._entities,a.count()>this._tableCount&&a.pop()),this.dirty())};
MO.FGuiLiveTable_construct=function(){this.__base.FGuiControl.construct.call(this);this._entities=new MO.TObjects;this._currentDate=new MO.TDate;this._rankLinePadding=new MO.SPadding(40,0,40,0);this._backgroundPadding=new MO.SPadding(20,20,90,20);this._columnLabels=["\u65f6\u95f4","\u57ce\u5e02","\u7528\u6237-\u624b\u673a","\u6295\u8d44\u989d(\u5143)"];MO.Runtime.isPlatformMobile()?this._columnDefines=[130,130,180,186]:this._columnDefines=[110,110,160,166];this._columnWidths=[]};
MO.FGuiLiveTable_setup=function(){var a=MO.Console.find(MO.FImageConsole),b=this._logoImage=a.load("{eai.resource}/live/company.png");b.addLoadListener(this,this.onImageLoad);b=this._backgroundImage=a.load("{eai.resource}/live/grid.png");b.addLoadListener(this,this.onImageLoad);b=this._rankTitleImage=a.load("{eai.resource}/live/tank-title.png");b.addLoadListener(this,this.onImageLoad);b=this._rankLineImage=a.load("{eai.resource}/live/rank.png");b.addLoadListener(this,this.onImageLoad);b=this._rank1Image=
a.load("{eai.resource}/live/1.png");b.addLoadListener(this,this.onImageLoad);b=this._rank2Image=a.load("{eai.resource}/live/2.png");b.addLoadListener(this,this.onImageLoad);b=this._rank3Image=a.load("{eai.resource}/live/3.png");b.addLoadListener(this,this.onImageLoad);this._headFontStyle="bold 36px Microsoft YaHei";MO.Window.Browser.isOrientationVertical()?(this._tableCount=11,this._rankStart=100,this._rankTitleStart=-5,this._rankHeight=249,this._rankRowHeight=50,this._rankIconStart=22,this._rankTextStart=
8,this._rankRowUp=36,this._rankRowDown=68,this._headStart=352,this._headTextTop=37,this._headHeight=54,this._rowStart=418,this._rowTextTop=0,this._rowFontStyle="36px Microsoft YaHei",this._rowHeight=46):(this._tableCount=19,this._rankStart=110,this._rankTitleStart=0,this._rankHeight=219,this._rankRowHeight=40,this._rankIconStart=25,this._rankTextStart=0,this._rankRowUp=32,this._rankRowDown=51,this._headStart=336,this._headTextTop=27,this._headHeight=40,this._rowFontStyle="24px Microsoft YaHei",this._rowStart=
384,this._rowHeight=36)};MO.FGuiLiveTable_pushEntity=function(a){if(!a)return null;var b=this._entities;b.unshift(a);this._lineScroll-=this._rowHeight;b.count()>=this._tableCount&&b.pop()};
MO.FGuiLiveTable_drawRow=function(a,b,c,d,e,f,g){var h=this._columnWidths;g=null;g=c?"#E5BD1D":"#59FDE9";if(c){var k=e+.5*h[0]-23,m=f-this._rankIconStart;0==d&&this._rank1Image.testReady()&&a.drawImage(this._rank1Image,k-6,m-28,58,65);1==d&&this._rank2Image.testReady()&&a.drawImage(this._rank2Image,k,m,46,37);2==d&&this._rank3Image.testReady()&&a.drawImage(this._rank3Image,k,m,46,37)}f+=this._rankTextStart;d=0;c||(this._currentDate.parse(b.date()),c=this._currentDate.format("HH24:MI:SS"),d=a.textWidth(c),
a.drawText(c,e+.5*h[0]-.5*d,f,g));e+=h[0];d=MO.Console.find(MO.FEaiResourceConsole).cityConsole().findByCard(b.card());c="";d&&(c=d.label());d=a.textWidth(c);a.drawText(c,e+.5*h[1]-.5*d,f,g);e+=h[1];c=b.customer()+" - "+b.phone();d=a.textWidth(c);a.drawText(c,e+.5*h[2]-.5*d,f,g);e+=h[2];b=MO.Lang.Float.format(b.investment(),null,null,2,"0");e=e+h[3]-15;7<b.length?(g=null,g=9<b.length?"#FDEF01":"#EB6C03",h=b.substring(0,b.length-7),b=b.substring(b.length-7,b.length),c=a.textWidth(h),d=a.textWidth(b),
a.drawText(h,e-d-c,f,g),a.drawText(b,e-d,f,"#59FDE9")):(d=a.textWidth(b),a.drawText(b,e-d,f,g))};MO.FGuiLiveTable_dispose=function(){this._entities=MO.Lang.Object.dispose(this._entities);this._backgroundPadding=MO.Lang.Object.dispose(this._backgroundPadding);this.__base.FEaiEntity.dispose.call(this)};
MO.FEaiStatisticsDate=function(a){a=MO.Class.inherits(this,a,MO.FGuiLabel);a._value=MO.Class.register(a,new MO.AGetter("_value"));a.onPaintLabel=MO.FEaiStatisticsDate_onPaintLabel;a.construct=MO.FEaiStatisticsDate_construct;a.setValue=MO.FEaiStatisticsDate_setValue;a.dispose=MO.FEaiStatisticsDate_dispose;return a};
MO.FEaiStatisticsDate_onPaintLabel=function(a){var b=a.graphic,c=a.rectangle;b.setFont("bold 36px Microsoft YaHei");a=this._value.format("YYYY");var d=this._value.format("MM"),e=this._value.format("DD"),f=a+"\u5e74",g=d+"\u6708";b.textWidth(f+g+(e+"\u65e5"));var f=b.textWidth(f),g=b.textWidth(g),h=c.left,c=c.top+c.height,k=h+4,m=c-5;b.setFont("bold 36px Microsoft YaHei");var l=b.textWidth(a);b.drawText(a,h,c,"#FFD926");b.setFont("bold 28px Microsoft YaHei");b.drawText("\u5e74",k+l,m,"#00B5F6");b.setFont("bold 36px Microsoft YaHei");
l=b.textWidth(d);b.drawText(d,h+f,c,"#FFD926");b.setFont("bold 28px Microsoft YaHei");b.drawText("\u6708",k+f+l,m,"#00B5F6");b.setFont("bold 36px Microsoft YaHei");l=b.textWidth(e);b.drawText(e,h+f+g,c,"#FFD926");b.setFont("bold 28px Microsoft YaHei");b.drawText("\u65e5",k+f+g+l,m,"#00B5F6")};MO.FEaiStatisticsDate_construct=function(){this.__base.FGuiLabel.construct.call(this);this._value=new MO.TDate};MO.FEaiStatisticsDate_setValue=function(a){this._value.parse(a,"YYYYMMDD");this.dirty()};
MO.FEaiStatisticsDate_dispose=function(){this._value=MO.Lang.Object.dispose(this._value);this.__base.FGuiLabel.dispose.call(this)};
MO.FEaiStatisticsInvestment=function(a){a=MO.Class.inherits(this,a,MO.FObject,MO.MGraphicObject,MO.MListener);a._dateSetup=!1;a._beginDate=MO.Class.register(a,new MO.AGetter("_beginDate"));a._endDate=MO.Class.register(a,new MO.AGetter("_endDate"));a._invementDayCurrent=MO.Class.register(a,new MO.AGetter("_invementDayCurrent"),0);a._invementDay=MO.Class.register(a,new MO.AGetter("_invementDay"),0);a._invementTotalCurrent=MO.Class.register(a,new MO.AGetter("_invementTotalCurrent"),0);a._invementTotal=
MO.Class.register(a,new MO.AGetter("_invementTotal"),0);a._intervalMinute=1;a._mapEntity=MO.Class.register(a,new MO.AGetSet("_mapEntity"));a._display=MO.Class.register(a,new MO.AGetter("_display"));a._rankEntities=MO.Class.register(a,new MO.AGetter("_rankEntities"));a._entities=MO.Class.register(a,new MO.AGetter("_entities"));a._tableEntities=MO.Class.register(a,new MO.AGetter("_tableEntities"));a._tableCount=40;a._tableInterval=1E3;a._tableTick=1;a._dataTicker=null;a._entityPool=null;a._autios=null;
a._listenersDataChanged=MO.Class.register(a,new MO.AListener("_listenersDataChanged",MO.EEvent.DataChanged));a.onInvestment=MO.FEaiStatisticsInvestment_onInvestment;a.construct=MO.FEaiStatisticsInvestment_construct;a.allocEntity=MO.FEaiStatisticsInvestment_allocEntity;a.allocShape=MO.FEaiStatisticsInvestment_allocShape;a.setup=MO.FEaiStatisticsInvestment_setup;a.calculateInvestmentLevel=MO.FEaiStatisticsInvestment_calculateInvestmentLevel;a.calculateCurrent=MO.FEaiStatisticsInvestment_calculateCurrent;
a.focusEntity=MO.FEaiStatisticsInvestment_focusEntity;a.process=MO.FEaiStatisticsInvestment_process;a.dispose=MO.FEaiStatisticsInvestment_dispose;return a};
MO.FEaiStatisticsInvestment_onInvestment=function(a){var b=a.content;this._invementDay=b.investment_day;this._invementTotal=b.investment_total;var c=this._rankEntities;a=c.count();for(var d=0;d<a;d++){var e=c.at(d);this._entityPool.free(e)}c.clear();var f=b.rank;if(f)for(a=f.length,d=0;d<a;d++){var g=f[d],e=this.allocEntity();e.loadData(g);c.push(e)}f=b.collection;b=this._entities;if(f)for(a=f.length,d=0;d<a;d++)g=f[d],e=this.allocEntity(),e.loadData(g),b.push(e);this.calculateCurrent();a=MO.Memory.alloc(MO.SEvent);
a.sender=this;a.entity=null;a.rank=this._rankEntities;a.data=this._tableEntities;this.processDataChangedListener(a);MO.Memory.free(a);a=b.count();this._tableInterval=6E4*this._intervalMinute/a;this._tableTick=0};
MO.FEaiStatisticsInvestment_construct=function(){this.__base.FObject.construct.call(this);this._beginDate=new MO.TDate;this._endDate=new MO.TDate;this._entities=new MO.TObjects;this._tableEntities=new MO.TObjects;this._tableTicker=new MO.TTicker(1E3*this._tableInterval);this._autios={};this._dataTicker=new MO.TTicker(6E4*this._intervalMinute);var a=this._dataTable=MO.Class.create(MO.FEaiStatisticsTable);a._hTable=document.getElementById("id_investment");a._headLineCount=1;this._rankEntities=new MO.TObjects;
this._entityPool=MO.Class.create(MO.FObjectPool)};MO.FEaiStatisticsInvestment_allocEntity=function(){var a=this._entityPool.alloc();a||(a=MO.Class.create(MO.FEaiStatisticsInvestmentEntity));return a};MO.FEaiStatisticsInvestment_setup=function(){for(var a=MO.Console.find(MO.FAudioConsole),b=1;5>=b;b++)this._autios[b]=a.load("{eai.resource}/currency/"+b+".mp3");(this._display=MO.Class.create(MO.FE3dDisplay)).linkGraphicContext(this)};
MO.FEaiStatisticsInvestment_calculateInvestmentLevel=function(a){return 5E6<=a?5:1E6<=a?4:1E5<=a?3:1E4<=a?2:1E3<=a?1:0};MO.FEaiStatisticsInvestment_calculateCurrent=function(){for(var a=this._invementDay,b=this._invementTotal,c=this._entities,d=c.count(),e=0;e<d;e++)var f=c.at(e).investment(),a=a-f,b=b-f;this._invementDayCurrent=Math.max(a,0);this._invementTotalCurrent=Math.max(b,0)};
MO.FEaiStatisticsInvestment_focusEntity=function(a){var b=this._mapEntity,c=a.card(),d=a.investment();if(c=b.findCityByCard(c)){var e=this.calculateInvestmentLevel(d),f=c.data().provinceCode();MO.Console.find(MO.FEaiResourceConsole).provinceConsole();(b=b.findProvinceByCode(f))&&b.doInvestment(e,d);c.addInvestmentTotal(e,d);this._mapEntity.upload();(d=this._autios[e])&&d.play(0)}d=MO.Memory.alloc(MO.SEvent);d.sender=this;d.entity=a;d.rank=this._rankEntities;d.data=this._tableEntities;this.processDataChangedListener(d);
MO.Memory.free(d)};
MO.FEaiStatisticsInvestment_process=function(){var a=MO.Console.find(MO.FEaiLogicConsole).system();if(a.testReady()){a=a.currentDate();a.truncMinute();this._dateSetup||(this._endDate.assign(a),this._endDate.addMinute(-this._intervalMinute),this._dateSetup=!0);if(this._dataTicker.process()){var b=MO.Console.find(MO.FEaiLogicConsole).statistics(),c=this._beginDate,d=this._endDate;c.assign(d);d.assign(a);b.doInvestmentDynamic(this,this.onInvestment,c.format(),d.format());c.assign(d)}a=MO.RTimer.current();
a-this._tableTick>this._tableInterval&&(this._tableEntities.count()>=this._tableCount&&(b=this._tableEntities.pop(),this._entityPool.free(b)),b=this._entities,b.isEmpty()||(b=b.shift(),this._tableEntities.unshift(b),this.focusEntity(b)),this.calculateCurrent(),this._tableTick=a);this._mapEntity.process();a=MO.Desktop.application().dynamicInfo();a._investmentEntityCount=this._entities.count();a._investmentTableEntityCount=this._tableEntities.count();a._investmentPoolItemCount=this._entityPool.items().count();
a._investmentPoolFreeCount=this._entityPool.frees().count()}};MO.FEaiStatisticsInvestment_dispose=function(){this._entities=MO.RObject.dispose(this._entities);this._dataTicker=MO.RObject.dispose(this._dataTicker);this.__base.FObject.dispose.call(this)};
with(MO)MO.FEaiStatisticsInvestmentEntity=function(a){a=RClass.inherits(this,a,FEaiEntity);a._date=RClass.register(a,new AGetter("_date"));a._customer=RClass.register(a,new AGetter("_customer"));a._phone=RClass.register(a,new AGetter("_phone"));a._card=RClass.register(a,new AGetter("_card"));a._investment=RClass.register(a,new AGetter("_investment"));a._shape=RClass.register(a,new AGetSet("_shape"));a.construct=FEaiStatisticsInvestmentEntity_construct;a.loadData=FEaiStatisticsInvestmentEntity_loadData;
a.update=FEaiStatisticsInvestmentEntity_update;a.dispose=FEaiStatisticsInvestmentEntity_dispose;return a},MO.FEaiStatisticsInvestmentEntity_construct=function(){this.__base.FEaiEntity.construct.call(this)},MO.FEaiStatisticsInvestmentEntity_loadData=function(a){this._date=a.date;this._customer=a.customer;this._phone=a.phone;this._card=a.card;this._investment=a.investment},MO.FEaiStatisticsInvestmentEntity_build=function(a){this._location.assign(this._data.location());this._size.set(2,2)},MO.FEaiStatisticsInvestmentEntity_update=
function(a){this._data.location();var b=1;if(a){var c=RConsole.find(FEaiResourceConsole).historyConsole().investmentCityTotal(),b=RConsole.find(FEaiResourceConsole).rateConsole().find(EEaiRate.Map);a=5*Math.sqrt(a.investmentTotal()/c);c=b.findRate(a);b=10*a;a=RFloat.toRange(a,0,1);this._color.set((c>>16&255)/255,(c>>8&255)/255,(c>>0&255)/255,4*a)}else this._color.set(0,0,0,0);b=this._range=RFloat.toRange(Math.sqrt(b),1,4);this._size.set(b,b)},MO.FEaiStatisticsInvestmentEntity_dispose=function(){this.__base.FEaiEntity.dispose.call(this)};
with(MO)MO.FEaiStatisticsInvestmentShape=function(a){a=RClass.inherits(this,a,FE3dShape);a._ready=!1;a._playing=!1;a._finish=!1;a._image=null;a._statusPaint=!1;a._cityEntity=RClass.register(a,new AGetSet("_cityEntity"));a._entity=RClass.register(a,new AGetter("_entity"));a._customerLabel=null;a._cityLabel=null;a._investment=null;a._interval=10;a._moveRate=0;a._lastTick=0;a.onImageLoad=FEaiStatisticsInvestmentShape_onImageLoad;a.construct=FEaiStatisticsInvestmentShape_construct;a.setup=FEaiStatisticsInvestmentShape_setup;
a.setEntity=FEaiStatisticsInvestmentShape_setEntity;a.paint=FEaiStatisticsInvestmentShape_paint;a.process=FEaiStatisticsInvestmentShape_process;a.dispose=FEaiStatisticsInvestmentShape_dispose;return a},MO.FEaiStatisticsInvestmentShape_onImageLoad=function(a){this._ready=!0},MO.FEaiStatisticsInvestmentShape_construct=function(){this.__base.FE3dShape.construct.call(this)},MO.FEaiStatisticsInvestmentShape_setup=function(){this.__base.FE3dShape.setup.call(this);var a=this._renderable=RClass.create(FE3dShapeData);
a.linkGraphicContext(this);a.setOptionCenter(!0);a.size().set(128,64);a.setup();a=this._image=RClass.create(FImage);a.addLoadListener(this,this.onImageLoad);a.loadUrl("/script/ars/eai/investment.png");this._ready=!1},MO.FEaiStatisticsInvestmentShape_setEntity=function(a){this._customerLabel=a.customer();this._cityLabel=this._cityEntity.data().label();this._investment=a.investment();this._finish=!1},MO.FEaiStatisticsInvestmentShape_paint=function(){var a=this._cityEntity.location(),b=this.material();
b.info().optionAlpha=!0;b.info().ambientColor.set(1,1,1,1);b=this._matrix;b.tx=a.x;b.ty=a.y;b.tz=0;b.setScale(10,5,1);b.update();a=this._renderable;b=a.beginDraw();b.drawImage(this._image,0,0,128,64);b.setFont("bold 18px Microsoft YaHei");b.drawText(this._cityLabel,15,25,"#FF00FF");b.setFont("bold 20px Microsoft YaHei");b.drawText(this._customerLabel,30,50,"#FFFF00");b.setFont("bold 20px Microsoft YaHei");b.drawText(this._investment,55,50,"#FF0000");a.endDraw();this._playing=this._statusPaint=!0;
this._moveRate=this._lastTick=0},MO.FEaiStatisticsInvestmentShape_process=function(a){this.__base.FE3dShape.process.call(this,a);this._statusDirty&&this.testReady()&&(this._statusPaint||(this.paint(),this._statusPaint=!0),this._statusDirty=!1);if(this._statusPaint&&!this._finish){a=RTimer.current();var b=this._matrix;a-this._lastTick>this._interval&&(b.ty+=this._moveRate+.01,this._moveRate+=.01,b.updateForce(),this._lastTick=a);100<b.ty&&(this._finish=!0)}},MO.FEaiStatisticsInvestmentShape_dispose=
function(){this.__base.FE3dShape.dispose.call(this)};
MO.FEaiStatisticsLabel=function(a){a=MO.Class.inherits(this,a,MO.FGuiLabel);a._value=MO.Class.register(a,new MO.AGetter("_value"),"0");a._originValue="0";a._startTick=0;a._rolling=MO.Class.register(a,new MO.AGetSet("_rolling"),!1);a._rollingDuration=MO.Class.register(a,new MO.AGetSet("_rollingDuration"),1E3);a._rollingPages=null;a._noRolling=MO.Class.register(a,new MO.AGetSet("_noRolling"),!1);a.onPaintLabel=MO.FEaiStatisticsLabel_onPaintLabel;a.oeUpdate=MO.FEaiStatisticsLabel_oeUpdate;a.construct=
MO.FEaiStatisticsLabel_construct;a.setValue=MO.FEaiStatisticsLabel_setValue;a.dispose=MO.FEaiStatisticsLabel_dispose;return a};
MO.FEaiStatisticsLabel_onPaintLabel=function(a){var b=a.graphic,c=a.rectangle;b.clip(c.left,c.top,c.width,c.height);b.setFont("bold 38px Microsoft YaHei");a=c.left;var c=c.top+c.height,d=a+6,e=c-4,f="",g=MO.Timer.current()-this._startTick;if(g>this._rollingDuration||this._noRolling)g=this._rollingDuration,this._rolling=!1;for(var h=0;h<this._value.length;h++){var k=this._rollingPages.get(h)*(g/this._rollingDuration),m=(parseInt(this._originValue.charAt(h))+parseInt(k)).toString(),m=parseInt(m.charAt(m.length-
1)),l=9==m?0:m+1,k=k-parseInt(k);b.setFont("bold 38px Microsoft YaHei");var r=b.textWidth(f),p="";h<this._originValue.length-8?p="#FFD926":h<this._originValue.length-4?p="#FF7200":h<this._originValue.length&&(p="#FD0000");b.drawText(m,a+r,c-38*k,p);b.drawText(l,a+r,c+38-38*k,p);f+=m;h==this._originValue.length-9?(r=b.textWidth(f),b.setFont("bold 24px Microsoft YaHei"),b.drawText("\u4ebf",d+r,e,"#00B5F6"),f+="\u4ebf"):h==this._originValue.length-5?(r=b.textWidth(f),b.setFont("bold 24px Microsoft YaHei"),
b.drawText("\u4e07",d+r,e,"#00B5F6"),f+="\u4e07"):h==this._originValue.length-1&&(r=b.textWidth(f),b.setFont("bold 24px Microsoft YaHei"),b.drawText("\u5143",d+r,e,"#00B5F6"),f+="\u5143")}0==this._rolling&&(this._originValue=this._value,this._rollingPages.clear())};
MO.FEaiStatisticsLabel_setValue=function(a){if(this._value!=a){this._rolling&&(this._originValue=this._value);this._value=a;for(var b=this._originValue,c=a.length-b.length;0<c;)b="0"+b,c--;this._originValue=b;this._rollingPages.clear();this._rollingPages._length=a.length;for(c=0;c<a.length;c++){var d=parseInt(a.substring(c,c+1))-parseInt(b.substring(c,c+1)),d=0>d?d+10:d;this._rollingPages.set(c,d)}this._startTick=MO.Timer.current();this._rolling=!0}};
MO.FEaiStatisticsLabel_oeUpdate=function(a){this.__base.FGuiLabel.oeUpdate.call(this,a);this._rolling&&this.dirty();return MO.EEventStatus.Stop};MO.FEaiStatisticsLabel_construct=function(){this.__base.FGuiLabel.construct.call(this);this._rollingPages=new MO.TArray};MO.FEaiStatisticsLabel_dispose=function(){this._ticker=MO.RObject.dispose(this._ticker);this.__base.FGuiLabel.dispose.call(this)};
with(MO)MO.FEaiStatisticsTable=function(a){a=RClass.inherits(this,a,FEaiTable);a.createRow=FEaiCityEntity_createRow;return a},MO.FEaiCityEntity_createRow=function(){var a=RBuilder.appendTableRow(this._hTable);a.className="Investment_DataGrid_Row";var b=RBuilder.appendTableCell(a);b.className="Investment_DataGrid_Cell";b.align="center";b=RBuilder.appendTableCell(a);b.className="Investment_DataGrid_Cell";b.align="center";b=RBuilder.appendTableCell(a);b.className="Investment_DataGrid_Cell";b.align="center";
b=RBuilder.appendTableCell(a);b.className="Investment_DataGrid_Cell";b.align="right"};
MO.FEaiChartCustomerScene=function(a){a=MO.RClass.inherits(this,a,MO.FEaiChartScene);a._code=MO.EEaiScene.ChartCustomer;a._playing=!1;a._startDate=null;a._endDate=null;a._currentDate=null;a.onLoadData=MO.FEaiChartCustomerScene_onLoadData;a.onKeyDown=MO.FEaiChartCustomerScene_onKeyDown;a.setup=MO.FEaiChartCustomerScene_setup;a.selectDate=MO.FEaiChartCustomerScene_selectDate;a.active=MO.FEaiChartCustomerScene_active;a.process=MO.FEaiChartCustomerScene_process;a.deactive=MO.FEaiChartCustomerScene_deactive;
return a};MO.FEaiChartCustomerScene_onLoadData=function(a){this.__base.FEaiChartScene.onLoadData.call(this,a);a=this._currentDate.format("YYYYMMDD");this.selectDate(a)};
MO.FEaiChartCustomerScene_onKeyDown=function(a){a=a.keyCode;if(a==MO.EKeyCode.N){this._currentDate.addDay(-1);var b=this._currentDate.format("YYYYMMDD");this.selectDate(b);console.log(b)}a==MO.EKeyCode.M&&(this._currentDate.addDay(1),b=this._currentDate.format("YYYYMMDD"),this.selectDate(b),console.log(b));a==MO.EKeyCode.L&&(MO.RDate.autoParse(this._currentDate,"20140701"),this._playing=!0)};
MO.FEaiChartCustomerScene_selectDate=function(a){this.graphicContext();var b=this._activeStage;b.mapLayer();b.borderLayer();b.dataLayer();if(b=MO.Console.find(MO.FEaiResourceConsole).historyConsole().dates().get(a)){a=b.provinces();for(var c=a.count(),d=0;d<c;d++){var e=a.at(d);this._provinceEntities.get(e.code()).update(e)}for(var e=b.citys(),f=this._cityEntities,c=f.count(),d=0;d<c;d++){var g=f.at(d);a=g.data().code();a=e.get(a);g.update(a)}if(c=document.getElementById("id_total"))c.innerHTML=this._currentDate.format("YYYY-MM-DD")+
" "+b.investmentTotal()}this._citysRangeRenderable.upload()};MO.FEaiChartCustomerScene_setup=function(){this.__base.FEaiChartScene.setup.call(this);MO.RWindow.lsnsKeyDown.register(this,this.onKeyDown);this._currentDate=new MO.TDate;this._startDate=new MO.TDate;this._endDate=new MO.TDate;this._currentDate.parseAuto("20140701");this._startDate.parseAuto("20140701");this._endDate.parseAuto("20150618")};MO.FEaiChartCustomerScene_active=function(){this.__base.FEaiChartScene.active.call(this)};
MO.FEaiChartCustomerScene_process=function(){this.__base.FEaiChartScene.process.call(this);if(this._playing){this._currentDate.addDay(1);var a=this._currentDate.format("YYYYMMDD"),b=this._endDate.format("YYYYMMDD");this.selectDate(a);a==b&&(this._playing=!1)}};MO.FEaiChartCustomerScene_deactive=function(){this.__base.FEaiChartScene.deactive.call(this)};
MO.FEaiChartHistoryScene=function(a){a=MO.RClass.inherits(this,a,MO.FEaiChartScene);a._code=MO.EEaiScene.ChartHistory;a._ready=!1;a._mapReady=!1;a._playing=!1;a._lastTick=0;a._interval=10;a._lastDateTick=0;a._dateInterval=120;a._startDate=null;a._endDate=null;a._currentDate=null;a._logoBar=null;a._buttonTransform=null;a._timeline=null;a._milestoneFrame=null;a._statusStart=!1;a._statusLayerCount=100;a._statusLayerLevel=100;a._milestoneBars=null;a._milestoneShowed=0;a._milestoneBarShowDuration=1E3;
a._milestoneBarShowTick=0;a._milestoneBarShowing=!1;a._bgm=null;a._bgmPlaying=!1;a.onLoadData=MO.FEaiChartHistoryScene_onLoadData;a.onDateSelect=MO.FEaiChartHistoryScene_onDateSelect;a.onMilestoneDone=MO.FEaiChartHistoryScene_onMilestoneDone;a.onOperationPlay=MO.FEaiChartHistoryScene_onOperationPlay;a.onOperationPause=MO.FEaiChartHistoryScene_onOperationPause;a.onProcess=MO.FEaiChartHistoryScene_onProcess;a.onSwitchLiveComplete=MO.FEaiChartHistoryScene_onSwitchLiveComplete;a.testReady=MO.FEaiChartHistoryScene_testReady;
a.setup=MO.FEaiChartHistoryScene_setup;a.resetDate=MO.FEaiChartHistoryScene_resetDate;a.selectDate=MO.FEaiChartHistoryScene_selectDate;a.switchPlay=MO.FEaiChartHistoryScene_switchPlay;a.switchLive=MO.FEaiChartHistoryScene_switchLive;a.processResize=MO.FEaiChartHistoryScene_processResize;return a};
MO.FEaiChartHistoryScene_onLoadData=function(a){a=MO.Console.find(MO.FEaiResourceConsole).historyConsole();var b=a.dates().first(),c=a.dates().last();this._currentDate.parseAuto(b.code());this._startDate.parseAuto(b.code());this._endDate.parseAuto(c.code());a=a.milestones();for(var b=this._milestoneBars=new MO.TObjects,c=a.count(),d=c-1;0<=d;d--){var e=a.at(c-d-1),f=MO.RClass.create(MO.FGuiHistoryMilestoneBar);f.linkGraphicContext(this);f.setName("MilestoneBar_"+d);f.setVisible(!1);f.setDockCd(MO.EUiDock.Right);
f.setTop(90+100*d);1E4<=e.investmentTotal()?f.setRight(-371):f.setRight(-341);f.setup(e);f.build();this._guiManager.register(f);b.push(f)}};MO.FEaiChartHistoryScene_onDateSelect=function(a){this._currentDate.date.setTime(a.date.date.getTime());this._currentDate.refresh();this.selectDate(this._currentDate.format("YYYYMMDD"))};MO.FEaiChartHistoryScene_onMilestoneDone=function(a){this.switchPlay(!0);this._milestoneShowed++;this._milestoneBarShowTick=MO.Timer.current();this._milestoneBarShowing=!0};
MO.FEaiChartHistoryScene_onOperationPlay=function(a){a=this._currentDate.format("YYYYMMDD");var b=this._endDate.format("YYYYMMDD");a==b&&(a=MO.Console.find(MO.FEaiResourceConsole).historyConsole().dates().first(),MO.Lang.Date.autoParse(this._currentDate,a.code()));this.switchPlay(!0)};MO.FEaiChartHistoryScene_onOperationPause=function(a){this.switchPlay(!1)};
MO.FEaiChartHistoryScene_onProcess=function(){this.__base.FEaiChartScene.onProcess.call(this);var a=this._mapEntity;a.countryDisplay();a.countryBorderDisplay();if(!this._statusStart&&this.testReady()){var b=document.getElementById("id_loading");b&&(b.style.opacity=this._statusLayerLevel/this._statusLayerCount,this._statusLayerLevel--);this._statusLayerLevel--;0==this._statusLayerLevel&&(b&&document.body.removeChild(b),this.switchPlay(!0),this.processLoaded(),this._statusStart=!0)}b=MO.Timer.current();
if(this._playing){var c=a.countryEntity();if(!c.introAnimeDone()){c.process();return}this._bgmPlaying||(this._bgm.play(0),this._bgmPlaying=!0);this._mapReady||(a.citysRangeRenderable().setVisible(!0),a.citysRenderable().setVisible(!0),this._guiManager.show(),this._milestoneFrame.setVisible(!1),a=MO.Class.create(MO.FGuiActionAlpha),a.setAlphaBegin(0),a.setAlphaEnd(1),a.setAlphaInterval(.005),a.push(this._guiManager),this._guiManager.mainTimeline().pushAction(a),this._mapReady=!0);b-this._lastTick>
this._interval&&(b-this._lastDateTick>this._dateInterval&&(this._currentDate.addDay(1),a=this._currentDate.format("YYYYMMDD"),c=this._endDate.format("YYYYMMDD"),this.selectDate(a),a==c&&(this.switchPlay(!1),this.switchLive()),this._lastDateTick=b,this._mapEntity.upload()),this._timeline.setProgress((b-this._lastDateTick)/this._dateInterval),this._timeline.dirty(),this._lastTick=b)}this._milestoneBarShowing&&(b=(b-this._milestoneBarShowTick)/this._milestoneBarShowDuration,1<b&&(b=1,this._milestoneBarShowing=
!1),b=(1-b)*(1-b),a=this._milestoneBars.at(this._milestoneShowed-1),1E4<=a.data().investmentTotal()?a.setRight(20+-371*b):a.setRight(20+-341*b),a.dirty());this._milestoneFrame.visible()&&this._milestoneFrame.dirty()};MO.FEaiChartHistoryScene_onSwitchLiveComplete=function(a){this._chapter.selectSceneByCode(MO.EEaiScene.ChartLive).showFace()};MO.FEaiChartHistoryScene_testReady=function(){if(!this._ready){if(!this._countryReady)return!1;this._ready=!0}return this._ready};
MO.FEaiChartHistoryScene_setup=function(){this.__base.FEaiChartScene.setup.call(this);this._currentDate=new MO.TDate;this._startDate=new MO.TDate;this._endDate=new MO.TDate;this._groundAutio.pause();this._bgm=MO.Console.find(MO.FAudioConsole).load("{eai.resource}/historyBGM.mp3");var a=this._mapEntity;a.citysRangeRenderable().setVisible(!1);a.citysRenderable().setVisible(!1);a=this._logoBar=MO.RConsole.find(MO.FGuiFrameConsole).get(this,"eai.history.LogoBar");a.setLocation(5,5);this._guiManager.register(a);
this._logoBar.findComponent("investment").setNoRolling(!0);a=this._buttonTransform=MO.Class.create(MO.FGuiChangeTransform);a.setInterval(10);a.setScale(.1);this.activeStage();a=this._timeline=MO.Class.create(MO.FGuiHistoryTimeline);a.linkGraphicContext(this);a.setName("Timeline");a.setDockCd(MO.EUiDock.Bottom);a.setAnchorCd(MO.EUiAnchor.Left|MO.EUiAnchor.Right);a.setLeft(50);a.setRight(450);a.setBottom(5);a.setHeight(600);a.setTimeUnit(MO.EUiTimeUnit.Month);a.setStartTime(this._startDate);a.setEndTime(this._endDate);
a.setDegreeTime(this._currentDate);a.addDataChangedListener(this,this.onDateSelect);a.build();this._guiManager.register(a);a=this._milestoneFrame=MO.RClass.create(MO.FGuiHistoryMilestoneFrame);a.linkGraphicContext(this);a.setName("MilestoneFrame");a.addDataChangedListener(this,this.onMilestoneDone);a.setup();a.build();this._guiManager.register(a);MO.Console.find(MO.FImageConsole);a=MO.RClass.create(MO.FGuiPicture);a.linkGraphicContext(this);a.setName("MilestoneBG_Top");a.setDockCd(MO.EUiDock.RightTop);
a.setWidth(468);a.setHeight(464);a._displayOrder=-1;a._backResource="url:/script/ars/eai/milestone/bar_bg_top.png";a.psInitialize();a.build();this._guiManager.register(a);a=MO.RClass.create(MO.FGuiPicture);a.linkGraphicContext(this);a.setName("MilestoneBG_Bottom");a.setDockCd(MO.EUiDock.RightBottom);a.setWidth(468);a.setHeight(464);a._displayOrder=-1;a._backResource="url:/script/ars/eai/milestone/bar_bg_bottom.png";a.psInitialize();a.build();this._guiManager.register(a);this._guiManager.hide();a=
MO.Console.find(MO.FEaiResourceConsole).historyConsole();a.addLoadListener(this,this.onLoadData);a.load()};MO.FEaiChartHistoryScene_resetDate=function(){for(var a=this._mapEntity.cityEntities(),b=a.count(),c=0;c<b;c++)a.at(c).reset()};
MO.FEaiChartHistoryScene_selectDate=function(a){var b=MO.Console.find(MO.FEaiResourceConsole).historyConsole();MO.Console.find(MO.FEaiResourceConsole).provinceConsole();var c=b.dates().get(a);if(b=b.milestones().get(a))this._milestoneFrame.setData(b),this._milestoneFrame.show(),this._milestoneFrame.dirty(),this.switchPlay(!1);if(c){this._timeline.setDegreeTime(this._currentDate);this._timeline.dirty();for(var b=c.citys(),d=this._mapEntity.cityEntities(),e=d.count(),f=0;f<e;f++){var g=d.at(f),h=g.data().code(),
h=b.get(h);g.update(h)}this._logoBar.findComponent("date").setValue(a);this._logoBar.findComponent("investment").setValue(parseInt(c.investmentTotal()).toString())}};MO.FEaiChartHistoryScene_switchPlay=function(a){this._playing=a};MO.FEaiChartHistoryScene_switchLive=function(){var a=MO.Class.create(MO.FGuiActionAlpha);a.setAlphaBegin(1);a.setAlphaEnd(0);a.setAlphaInterval(-.005);a.addCompleteListener(this,this.onSwitchLiveComplete);a.push(this._guiManager);this._guiManager.mainTimeline().pushAction(a)};
MO.FEaiChartHistoryScene_processResize=function(){this.__base.FEaiChartScene.processResize.call(this);var a=this._southSea;a.setDockCd(MO.EUiDock.RightBottom);a.setRight(520);a.setBottom(180)};
MO.FEaiChartIndustryScene=function(a){a=MO.RClass.inherits(this,a,MO.FEaiChartScene);a._code=MO.EEaiScene.ChartIndustry;a._playing=!1;a._startDate=null;a._endDate=null;a._currentDate=null;a.onLoadData=MO.FEaiChartIndustryScene_onLoadData;a.onKeyDown=MO.FEaiChartIndustryScene_onKeyDown;a.setup=MO.FEaiChartIndustryScene_setup;a.selectDate=MO.FEaiChartIndustryScene_selectDate;a.active=MO.FEaiChartIndustryScene_active;a.process=MO.FEaiChartIndustryScene_process;a.deactive=MO.FEaiChartIndustryScene_deactive;
return a};MO.FEaiChartIndustryScene_onLoadData=function(a){this.__base.FEaiChartScene.onLoadData.call(this,a);a=this._currentDate.format("YYYYMMDD");this.selectDate(a)};
MO.FEaiChartIndustryScene_onKeyDown=function(a){a=a.keyCode;if(a==MO.EKeyCode.N){this._currentDate.addDay(-1);var b=this._currentDate.format("YYYYMMDD");this.selectDate(b);console.log(b)}a==MO.EKeyCode.M&&(this._currentDate.addDay(1),b=this._currentDate.format("YYYYMMDD"),this.selectDate(b),console.log(b));a==MO.EKeyCode.L&&(MO.RDate.autoParse(this._currentDate,"20140701"),this._playing=!0)};
MO.FEaiChartIndustryScene_selectDate=function(a){this.graphicContext();var b=this._activeStage;b.mapLayer();b.borderLayer();b.dataLayer();if(b=MO.Console.find(MO.FEaiResourceConsole).historyConsole().dates().get(a)){a=b.provinces();for(var c=a.count(),d=0;d<c;d++){var e=a.at(d);this._provinceEntities.get(e.code()).update(e)}for(var e=b.citys(),f=this._cityEntities,c=f.count(),d=0;d<c;d++){var g=f.at(d);a=g.data().code();a=e.get(a);g.update(a)}if(c=document.getElementById("id_total"))c.innerHTML=this._currentDate.format("YYYY-MM-DD")+
" "+b.investmentTotal()}this._citysRangeRenderable.upload()};MO.FEaiChartIndustryScene_setup=function(){this.__base.FEaiChartScene.setup.call(this);MO.RWindow.lsnsKeyDown.register(this,this.onKeyDown);this._currentDate=new MO.TDate;this._startDate=new MO.TDate;this._endDate=new MO.TDate;this._currentDate.parseAuto("20140701");this._startDate.parseAuto("20140701");this._endDate.parseAuto("20150618")};MO.FEaiChartIndustryScene_active=function(){this.__base.FEaiChartScene.active.call(this)};
MO.FEaiChartIndustryScene_process=function(){this.__base.FEaiChartScene.process.call(this);if(this._playing){this._currentDate.addDay(1);var a=this._currentDate.format("YYYYMMDD"),b=this._endDate.format("YYYYMMDD");this.selectDate(a);a==b&&(this._playing=!1)}};MO.FEaiChartIndustryScene_deactive=function(){this.__base.FEaiChartScene.deactive.call(this)};
MO.FEaiChartInvestmentScene=function(a){a=MO.RClass.inherits(this,a,MO.FEaiChartScene);a._code=MO.EEaiScene.ChartInvestment;a._playing=!1;a._startDate=null;a._endDate=null;a._currentDate=null;a._timeline=null;a.onLoadData=MO.FEaiChartInvestmentScene_onLoadData;a.onKeyDown=MO.FEaiChartInvestmentScene_onKeyDown;a.setup=MO.FEaiChartInvestmentScene_setup;a.selectDate=MO.FEaiChartInvestmentScene_selectDate;a.active=MO.FEaiChartInvestmentScene_active;a.process=MO.FEaiChartInvestmentScene_process;a.deactive=
MO.FEaiChartInvestmentScene_deactive;a.onDateSelect=MO.FEaiChartInvestmentScene_onDateSelect;return a};MO.FEaiChartInvestmentScene_onLoadData=function(a){this.__base.FEaiChartScene.onLoadData.call(this,a);a=this._currentDate.format("YYYYMMDD");this.selectDate(a)};
MO.FEaiChartInvestmentScene_onKeyDown=function(a){a=a.keyCode;if(a==MO.EKeyCode.N){this._currentDate.addDay(-1);var b=this._currentDate.format("YYYYMMDD");this.selectDate(b);console.log(b)}a==MO.EKeyCode.M&&(this._currentDate.addDay(1),b=this._currentDate.format("YYYYMMDD"),this.selectDate(b),console.log(b));if(a==MO.EKeyCode.L){MO.RDate.autoParse(this._currentDate,"20140701");a=document.getElementById("id_investment_table");for(b=1;b<a.rows.length;b++)a.rows[b].style.display="none";this._playing=
!0}};
MO.FEaiChartInvestmentScene_selectDate=function(a){this.graphicContext();var b=this._activeStage;b.mapLayer();b.borderLayer();var b=MO.Console.find(MO.FEaiResourceConsole).historyConsole(),c=MO.Console.find(MO.FEaiResourceConsole).provinceConsole();if(b=b.dates().get(a)){a=b.provinces();for(var d=a.count(),e=document.getElementById("id_investment_table");e.rows.length<d+1;){var f=e.insertRow(e.rows.length);f.insertCell(0);f.insertCell(1);f.insertCell(2)}for(var g=0;g<d;g++){var h=a.at(g);this._provinceEntities.get(h.code()).update(h);var k=
c.findByCode(h.code()),f=e.rows[g+1];f.style.display="";f.className="DataGrid_Row";var m=f.cells[0],l=f.cells[1],f=f.cells[2];2<g&&(m.innerText=g+1);l.innerText=k.label();1E3<h.investmentTotal()?f.innerText=MO.RFloat.unitFormat(h.investmentTotal(),0,0,2,0,1E4,"\u4e07"):f.innerText=h.investmentTotal();f.align="right"}this._timeline.setDegreeTime(this._currentDate);this._timeline.repaint();c=b.citys();e=this._cityEntities;d=e.count();for(g=0;g<d;g++)h=e.at(g),a=h.data().code(),a=c.get(a),h.update(a);
this._totalBar.findComponent("total").setLabel(MO.RFloat.unitFormat(b.investmentTotal(),0,0,2,0,1E4,"\u4e07"));this._totalBar.repaint()}};
MO.FEaiChartInvestmentScene_setup=function(){this.__base.FEaiChartScene.setup.call(this);MO.RWindow.lsnsKeyDown.register(this,this.onKeyDown);this._currentDate=new MO.TDate;this._startDate=new MO.TDate;this._endDate=new MO.TDate;this._currentDate.parseAuto("20140701");this._startDate.parseAuto("20140701");this._endDate.parseAuto("20150618");for(var a=document.getElementById("id_investment_table"),b=0;3>b;b++){var c=a.insertRow(a.rows.length),d=c.insertCell(0);c.insertCell(1);c.insertCell(2);switch(b){case 0:c.style.color=
"#FFEA01";d.innerHTML="1 <IMG src='/script/ars/eai/medals/gold.png'/>";break;case 1:c.style.color="#C5D3D6";d.innerHTML="2 <IMG src='/script/ars/eai/medals/silver.png'/>";break;case 2:c.style.color="#E16A00",d.innerHTML="3 <IMG src='/script/ars/eai/medals/copper.png'/>"}}a=this.activeStage().faceLayer();b=this._timeline=MO.RClass.create(MO.FGuiHistoryTimeline);b.setName("Timeline");b.setLeft(50);b.setTop(MO.Eai.Canvas._size.height-400);b.setWidth(MO.Eai.Canvas._size.width-500);b.setHeight(350);b.setTimeUnit(MO.EUiTimeUnit.Month);
b.setStartTime(this._startDate);b.setEndTime(this._endDate);b.setDegreeTime(this._currentDate);b.addDataChangedListener(this,this.onDateSelect);b.linkGraphicContext(this);b.build();this._desktop.register(b);a.push(b)};MO.FEaiChartInvestmentScene_onDateSelect=function(a){this._currentDate.date.setTime(a.date.date.getTime());this._currentDate.refresh();this.selectDate(this._currentDate.format("YYYYMMDD"))};MO.FEaiChartInvestmentScene_active=function(){this.__base.FEaiChartScene.active.call(this)};
MO.FEaiChartInvestmentScene_process=function(){this.__base.FEaiChartScene.process.call(this);if(this._playing){this._currentDate.addDay(1);var a=this._currentDate.format("YYYYMMDD"),b=this._endDate.format("YYYYMMDD");this.selectDate(a);a==b&&(this._playing=!1)}for(var a=this._citysRenderables,b=a.count(),c=0;c<b;c++)a.at(c).upload();this._citysRangeRenderable.upload()};MO.FEaiChartInvestmentScene_deactive=function(){this.__base.FEaiChartScene.deactive.call(this)};
MO.FEaiChartLiveScene=function(a){a=MO.RClass.inherits(this,a,MO.FEaiChartScene);a._code=MO.EEaiScene.ChartLive;a._investment=MO.Class.register(a,new MO.AGetter("_investment"));a._investmentCurrent=0;a._ready=!1;a._mapReady=!1;a._playing=!1;a._lastTick=0;a._interval=10;a._24HLastTick=0;a._24HTrendInterval=3E5;a._logoBar=null;a._timeline=null;a._liveTable=null;a._livePop=null;a._statusStart=!1;a._statusLayerCount=100;a._statusLayerLevel=100;a._groundAutioUrl="{eai.resource}/music/statistics.mp3";a.onInvestmentDataChanged=
MO.FEaiChartLiveScene_onInvestmentDataChanged;a.onProcess=MO.FEaiChartLiveScene_onProcess;a.onSwitchProcess=MO.FEaiChartLiveScene_onSwitchProcess;a.onSwitchComplete=MO.FEaiChartLiveScene_onSwitchComplete;a.testReady=MO.FEaiChartLiveScene_testReady;a.setup=MO.FEaiChartLiveScene_setup;a.showParticle=MO.FEaiChartLiveScene_showParticle;a.showFace=MO.FEaiChartLiveScene_showFace;a.fixMatrix=MO.FEaiChartLiveScene_fixMatrix;a.processResize=MO.FEaiChartLiveScene_processResize;return a};
MO.FEaiChartLiveScene_onInvestmentDataChanged=function(a){var b=a.entity,c=this._liveTable;c.setRank(a.rank);c.pushEntity(b);c.dirty();b&&(this._livePop.setData(b),MO.Console.find(MO.FEaiResourceConsole).cityConsole(),b=this._mapEntity.findCityByCard(b.card()))&&(a=b.provinceEntity(),b=b.data(),this.showParticle(a,b))};
MO.FEaiChartLiveScene_onProcess=function(){this.__base.FEaiChartScene.onProcess.call(this);if(!this._statusStart&&this.testReady()){var a=document.getElementById("id_loading");a&&(a.style.opacity=this._statusLayerLevel/this._statusLayerCount,this._statusLayerLevel--);this._statusLayerLevel--;0>=this._statusLayerLevel&&(a&&document.body.removeChild(a),this._mapEntity.countryEntity().start(),this.processLoaded(),this._statusStart=this._playing=!0)}if(this._playing){a=this._mapEntity.countryEntity();
if(!a.introAnimeDone()){a.process();return}this._mapReady||(this._guiManager.show(),a=MO.Class.create(MO.FGuiActionAlpha),a.setAlphaBegin(0),a.setAlphaEnd(1),a.setAlphaInterval(.01),a.push(this._guiManager),this._guiManager.mainTimeline().pushAction(a),this._mapReady=!0);a=MO.Timer.current();a-this._24HLastTick>this._24HTrendInterval&&(this._timeline.sync(),this._24HLastTick=a);this._investment.process();var a=this._logoBar,b=a.findComponent("investmentTotal"),c=this._investment.invementTotalCurrent();
b.setValue(parseInt(c).toString());a=a.findComponent("investmentDay");b=this._investment.invementDayCurrent();a.setValue(parseInt(b).toString());this._nowTicker.process()&&(a=this._logoBar,b=this._nowDate,b.setNow(),a.findComponent("date").setLabel(b.format("YYYY/MM/DD")),a.findComponent("time").setLabel(b.format("HH24:MI")))}this._livePop.visible()&&this._livePop.dirty()};MO.FEaiChartLiveScene_onSwitchProcess=function(a){};MO.FEaiChartLiveScene_onSwitchComplete=function(a){};
MO.FEaiChartLiveScene_testReady=function(){if(!this._ready){if(!this._countryReady)return!1;this._ready=!0}return this._ready};
MO.FEaiChartLiveScene_setup=function(){this.__base.FEaiChartScene.setup.call(this);var a=this._activeStage.dataLayer(),b=this._logoBar=MO.Console.find(MO.FGuiFrameConsole).get(this,"eai.chart.LogoBar");b.setLocation(5,5);this._guiManager.register(b);b=this._investment=MO.Class.create(MO.FEaiStatisticsInvestment);b.linkGraphicContext(this);b.setMapEntity(this._mapEntity);b.setup();b.addDataChangedListener(this,this.onInvestmentDataChanged);b=b.display();this.fixMatrix(b.matrix());a.push(b);MO.Console.find(MO.FEaiResourceConsole).historyConsole().milestones();
this.activeStage();a=this._timeline=MO.Class.create(MO.FGui24HTimeline);a.setName("Timeline");a.linkGraphicContext(this);a.sync();a.build();this._guiManager.register(a);a=this._liveTable=MO.Class.create(MO.FGuiLiveTable);a.setName("LiveTable");a.linkGraphicContext(this);a.setup();a.build();this._guiManager.register(a);a=this._livePop=MO.Class.create(MO.FGuiLivePop);a.setName("LivePop");a.linkGraphicContext(this);a.setup();a.build();this._guiManager.register(a);this._guiManager.hide()};
MO.FEaiChartLiveScene_showParticle=function(a,b){};MO.FEaiChartLiveScene_showFace=function(){this._playing=this._statusStart=!0;this._mapEntity.reset();this.processResize()};MO.FEaiChartLiveScene_fixMatrix=function(a){MO.Window.Browser.isOrientationVertical()?(a.tx=-14.58,a.ty=-1.9,a.tz=0,a.setScale(.14,.16,.14)):(a.tx=-38.6,a.ty=-12.8,a.tz=0,a.setScale(.32,.36,.32));a.update()};
MO.FEaiChartLiveScene_processResize=function(){this.__base.FEaiChartScene.processResize.call(this);var a=MO.Window.Browser.isOrientationVertical();this.fixMatrix(this._investment.display().matrix());var b=this._southSea;a?(b.setDockCd(MO.EUiDock.RightTop),b.setTop(570),b.setRight(100)):(b.setDockCd(MO.EUiDock.RightBottom),b.setRight(710),b.setBottom(260));b=this._timeline;a?(b.setDockCd(MO.EUiDock.Bottom),b.setAnchorCd(MO.EUiAnchor.Left|MO.EUiAnchor.Right),b.setLeft(10),b.setRight(10),b.setBottom(920)):
(b.setDockCd(MO.EUiDock.Bottom),b.setAnchorCd(MO.EUiAnchor.Left|MO.EUiAnchor.Right),b.setLeft(20),b.setBottom(30),b.setRight(680));b.setHeight(250);b=this._liveTable;a?(b.setDockCd(MO.EUiDock.Bottom),b.setAnchorCd(MO.EUiAnchor.Left|MO.EUiAnchor.Top|MO.EUiAnchor.Right),b.setLeft(10),b.setRight(10),b.setBottom(10),b.setWidth(1060),b.setHeight(900)):(b.setDockCd(MO.EUiDock.Right),b.setAnchorCd(MO.EUiAnchor.Left|MO.EUiAnchor.Top|MO.EUiAnchor.Bottom),b.setTop(10),b.setRight(0),b.setBottom(10),b.setWidth(650))};
MO.FEaiChartScene=function(a){a=MO.RClass.inherits(this,a,MO.FEaiScene);a._optionMapCountry=!0;a._readyProvince=!1;a._countryReady=!1;a._nowDate=null;a._nowTicker=null;a._mapEntity=null;a._citysRangeRenderable=null;a._citysRenderable=null;a._flagSprite=null;a._southSea=null;a._groundAutio=null;a.onLoadTemplate=MO.FEaiChartScene_onLoadTemplate;a.onProcess=MO.FEaiChartScene_onProcess;a.construct=MO.FEaiChartScene_construct;a.fixMatrix=MO.FEaiChartScene_fixMatrix;a.setup=MO.FEaiChartScene_setup;a.active=
MO.FEaiChartScene_active;a.resetDate=MO.FEaiChartScene_resetDate;a.processResize=MO.FEaiChartScene_processResize;a.deactive=MO.FEaiChartScene_deactive;a.dispose=MO.FEaiChartScene_dispose;return a};MO.FEaiChartScene_onLoadTemplate=function(a){};MO.FEaiChartScene_onProcess=function(){this.__base.FEaiScene.onProcess.call(this);!this._countryReady&&MO.Console.find(MO.FEaiEntityConsole).testCountryReady()&&(this._countryReady=!0,this.processResize())};
MO.FEaiChartScene_construct=function(){this.__base.FEaiScene.construct.call(this);this._nowDate=new MO.TDate;this._nowTicker=new MO.TTicker(1E4)};MO.FEaiChartScene_fixMatrix=function(a){a.tx=-35;a.ty=-12.3;a.tz=0;a.setScale(.32,.36,.32);a.update()};
MO.FEaiChartScene_setup=function(){this.__base.FEaiScene.setup.call(this);var a=this._mapEntity=MO.Console.find(MO.FEaiEntityConsole).mapEntity(),b=this._activeStage=MO.Class.create(MO.FEaiChartStage);b.linkGraphicContext(this);b.region().linkGraphicContext(this);b.region().backgroundColor().set(0,0,0,0);var c=a.countryDisplay();this.fixMatrix(c.matrix());b.mapLayer().pushDisplay(c);c=a.countryBorderDisplay();this.fixMatrix(c.matrix());b.borderLayer().pushDisplay(c);c=a.citysRangeRenderable();this.fixMatrix(c.matrix());
b.cityRangeLayer().push(c);a=a.citysRenderable();this.fixMatrix(a.matrix());b.cityLayer().push(a);MO.Console.find(MO.FEaiLogicConsole).system().refresh();b=this._groundAutio=MO.Console.find(MO.FAudioConsole).load("{eai.resource}/ground.mp3");b.setLoop(!0);b.setVolume(.2);b.play();this._optionMapCountry&&(b=this._southSea=MO.Class.create(MO.FGuiPicture),b.setDisplayOrder(-10),b.size().set(134,203),b.setBackResource("url:{eai.resource}/south-sea.png"),b.psInitialize(),b.build(),this._guiManager.register(b))};
MO.FEaiChartScene_active=function(){this.__base.FEaiScene.active.call(this)};MO.FEaiChartScene_resetDate=function(){};MO.FEaiChartScene_processResize=function(){this.__base.FEaiScene.processResize.call(this);var a=MO.Console.find(MO.FEaiEntityConsole).mapEntity();this.fixMatrix(a.countryDisplay().matrix());this.fixMatrix(a.countryBorderDisplay().matrix());this.fixMatrix(a.citysRangeRenderable().matrix());this.fixMatrix(a.citysRenderable().matrix())};MO.FEaiChartScene_deactive=function(){this.__base.FEaiScene.deactive.call(this)};
MO.FEaiChartScene_dispose=function(){this._nowDate=RObject.dispose(this._nowDate);this._nowTicker=RObject.dispose(this._nowTicker);this._mapEntity=null;this.__base.FEaiScene.dispose.call(this)};
MO.FEaiChartStage=function(a){a=MO.RClass.inherits(this,a,MO.FE3dStage);a._groundLayer=MO.RClass.register(a,new MO.AGetter("_groundLayer"));a._mapLayer=MO.RClass.register(a,new MO.AGetter("_mapLayer"));a._borderLayer=MO.RClass.register(a,new MO.AGetter("_borderLayer"));a._cityRangeLayer=MO.RClass.register(a,new MO.AGetter("_cityRangeLayer"));a._cityLayer=MO.RClass.register(a,new MO.AGetter("_cityLayer"));a._dataLayer=MO.RClass.register(a,new MO.AGetter("_dataLayer"));a._spriteLayer=MO.RClass.register(a,
new MO.AGetter("_spriteLayer"));a.construct=MO.FEaiChartStage_construct;return a};
MO.FEaiChartStage_construct=function(){this.__base.FE3dStage.construct.call(this);var a=this._groundLayer=MO.RClass.create(MO.FDisplayLayer);this.registerLayer("GroundLayer",a);a=this._mapLayer=MO.RClass.create(MO.FDisplayLayer);a.setOptionClearDepth(!0);this.registerLayer("MapLayer",a);a=this._borderLayer=MO.RClass.create(MO.FDisplayLayer);this.registerLayer("BorderLayer",a);a=this._cityRangeLayer=MO.RClass.create(MO.FDisplayLayer);a.setOptionClearDepth(!0);this.registerLayer("CityRangeLayer",a);
a=this._cityLayer=MO.RClass.create(MO.FDisplayLayer);a.setOptionClearDepth(!0);this.registerLayer("CityLayer",a);a=this._dataLayer=MO.RClass.create(MO.FDisplayLayer);a.setOptionClearDepth(!0);this.registerLayer("DataLayer",a);a=this._spriteLayer=MO.RClass.create(MO.FDisplayLayer);a.setOptionClearDepth(!0);this.registerLayer("SpriteLayer",a)};
MO.FEaiChartTotalScene=function(a){a=MO.RClass.inherits(this,a,MO.FEaiChartScene);a._optionMapCountry=!1;a._code=MO.EEaiScene.ChartTotal;a._currentDate=null;a._statusStart=!1;a._statusLayerCount=100;a._statusLayerLevel=100;a._chartTotal=null;a.onInvestment=MO.FEaiChartTotalScene_onInvestment;a.onProcess=MO.FEaiChartTotalScene_onProcess;a.construct=MO.FEaiChartTotalScene_construct;a.setup=MO.FEaiChartTotalScene_setup;a.testReady=MO.FEaiChartTotalScene_testReady;return a};
MO.FEaiChartTotalScene_onInvestment=function(a){this._chartTotal.setValue(parseInt(a.content.investment_total).toString())};
MO.FEaiChartTotalScene_onProcess=function(){this.__base.FEaiChartScene.onProcess.call(this);if(!this._statusStart&&this.testReady()){var a=document.getElementById("id_loading");a&&(a.style.opacity=this._statusLayerLevel/this._statusLayerCount,this._statusLayerLevel--);this._statusLayerLevel--;0==this._statusLayerLevel&&(a&&document.body.removeChild(a),this._statusStart=this._playing=!0)}this._playing&&(this._mapReady||(this._guiManager.show(),a=MO.Class.create(MO.FGuiActionAlpha),a.setAlphaBegin(0),
a.setAlphaEnd(1),a.setAlphaInterval(.01),a.push(this._guiManager),this._guiManager.mainTimeline().pushAction(a),this._mapReady=!0),this._dataTicker.process()&&(a=MO.Console.find(MO.FEaiLogicConsole).system(),a.testReady()&&(a=a.currentDate(),MO.Console.find(MO.FEaiLogicConsole).statistics().doInvestmentDynamic(this,this.onInvestment,a.format(),a.format()))),this._chartTotal.rolling()&&this._chartTotal.dirty())};
MO.FEaiChartTotalScene_construct=function(){this.__base.FEaiChartScene.construct.call(this);this._currentDate=new MO.TDate;this._dataTicker=new MO.TTicker(3E4)};MO.FEaiChartTotalScene_setup=function(){this.__base.FEaiChartScene.setup.call(this);this._guiManager.hide();var a=this._chartTotal=MO.Class.create(MO.FGuiChartTotal);a.setup();a.build();this._guiManager.register(a)};
MO.FEaiChartTotalScene_testReady=function(){if(!this._ready){if(!this._countryReady||!this._chartTotal.ready())return!1;this._ready=!0}return this._ready};MO.FEaiCompanyScene=function(a){a=MO.RClass.inherits(this,a,MO.FEaiScene);a._code=MO.EEaiScene.Company;return a};
MO.FEaiCountryScene=function(a){a=MO.RClass.inherits(this,a,MO.FEaiScene);a._code=MO.EEaiScene.Country;a._countryTemplate=null;a._countryLogoBar=null;a.onTemplateLoad=MO.FEaiCountryScene_onTemplateLoad;a.setup=MO.FEaiCountryScene_setup;a.active=MO.FEaiCountryScene_active;a.deactive=MO.FEaiCountryScene_deactive;return a};MO.FEaiCountryScene_onTemplateLoad=function(a){a=this._countryTemplate.sprite().matrix();a.tx=-4;a.ty=-3;a.rx=-Math.PI/2;a.updateForce();MO.Eai.Canvas.activeStage()};
MO.FEaiCountryScene_setup=function(){this.__base.FEaiScene.setup.call(this);var a=this._countryLogoBar=MO.RConsole.find(MO.FGuiFrameConsole).get(MO.Eai.Canvas,"eai.country.LogoBar");this.registerFrame(a)};MO.FEaiCountryScene_active=function(){this.__base.FEaiScene.active.call(this)};MO.FEaiCountryScene_deactive=function(){this.__base.FEaiScene.deactive.call(this);MO.Eai.Canvas.activeStage().faceLayer().removeRenderable(this._countryLogoBar.renderable())};
MO.FEaiDynamicInfo=function(a){a=MO.Class.inherits(this,a,MO.FGuiControl);a._lastTick=0;a._name="EngineInfo";a._stage=MO.Class.register(a,new MO.AGetSet("_stage"));a._guiManager=MO.Class.register(a,new MO.AGetSet("_guiManager"));a._context=MO.Class.register(a,new MO.AGetSet("_context"));a._ticker=null;a.onPaintBegin=MO.FEaiDynamicInfo_onPaintBegin;a.oeUpdate=MO.FEaiDynamicInfo_oeUpdate;a.construct=MO.FEaiDynamicInfo_construct;return a};
MO.FEaiDynamicInfo_onPaintBegin=function(a){this.__base.FGuiControl.onPaintBegin.call(this,a);if(null!=this._stage&&null!=this._context){var b=a.graphic;a=a.rectangle;this._stage.timer();var c=this._stage.statistics(),d=this._context.statistics();a=a.top+20;b.setFont("16px sans-serif");var e=MO.Window.Browser,f=e.capability();b.drawText(MO.Lang.String.format("Agent         : {1}",e.code),10,a,"#FFFFFF");a+=20;b.drawText(MO.Lang.String.format(" - Browser    : type={1}, orientation={2}, canvas_scale={3}",
e.typeCd(),e.orientationCd(),f.canvasAutoScale),10,a,"#FFFFFF");a+=20;var e=this._guiManager.desktop(),g=e.canvas2d(),f=e.canvas3d(),h=MO.Window.Browser.capability().pixelRatio;b.drawText(MO.Lang.String.format("Screen        : ratio={1}, screen_size={2}, size={3}",h,e.screenSize().toDisplay(),e.size().toDisplay()),10,a,"#FFFFFF");a+=20;g=g._hCanvas;b.drawText(MO.Lang.String.format(" - Canvas2d   : size={1}x{2}, inner_size={3}x{4}",g.offsetWidth,g.offsetHeight,g.width,g.height),10,a,"#FFFFFF");a+=
20;g=f._hCanvas;b.drawText(MO.Lang.String.format(" - Canvas3d   : size={1}x{2}, inner_size={3}x{4}",g.offsetWidth,g.offsetHeight,g.width,g.height),10,a,"#FFFFFF");a+=20;f=f.graphicContext();b.drawText(MO.Lang.String.format("   - Context  : {1}",f.size().toDisplay()),10,a,"#FFFFFF");a+=20;b.drawText(MO.Lang.String.format("   - Viewport : {1}",f.viewportRectangle()),10,a,"#FFFFFF");a+=20;f=this._stage.camera();g=f.projection();b.drawText(MO.Lang.String.format("Stage         : ={1}, size={2}x{3}",f.position()),
10,a,"#FFFFFF");a+=20;b.drawText(MO.Lang.String.format(" - Camera     : position={1}",f.position()),10,a,"#FFFFFF");a+=20;b.drawText(MO.Lang.String.format(" - Projection : size={1}, znear={2}, zfar={3}",g.size(),g.znear(),g.zfar()),10,a,"#FFFFFF");a+=20;b.drawText(MO.Lang.String.format("Frame         : rate={1}, span=[{2}]",MO.Timer.rate(),c._frame),10,a,"#FFFFFF");a+=20;b.drawText(MO.Lang.String.format(" - Process    : {1}",c._frameProcess),10,a,"#FFFFFF");a+=20;b.drawText(MO.Lang.String.format(" - Draw       : draw={1}, sort={2}",
c._frameDraw,c._frameDrawSort),10,a,"#FFFFFF");a+=20;b.drawText(MO.Lang.String.format("Draw          : count={1}, triangle={2}",d.frameDrawCount(),d.frameTriangleCount()),10,a,"#FFFFFF");a+=20;b.drawText(MO.Lang.String.format(" - Const      : count={1}, length={2}",d.frameConstCount(),d.frameConstLength()),10,a,"#FFFFFF");a+=20;b.drawText(MO.Lang.String.format(" - Alloc      : buffer={1}, texture={2}",d.frameBufferCount(),d.frameTextureCount()),10,a,"#FFFFFF");a+=20;b.drawText(MO.Lang.String.format(" - Total      : program={1}, layout={2}, vertex={3}, index={4}",
d.programTotal(),d.layoutTotal(),d.vertexBufferTotal(),d.indexBufferTotal()),10,a,"#FFFFFF");d=MO.Console.find(MO.FEaiEntityConsole).mapEntity();c=d.provinceEntities();d=d.cityEntities();a+=20;b.drawText(MO.Lang.String.format("Entity        : province={1} city={2}",c.count(),d.count()),10,a,"#FFFFFF");a+=20;b.drawText(MO.Lang.String.format("Investment    : entity={1}, table={2}, pool_item={3}, pool_free={4}",this._investmentEntityCount,this._investmentTableEntityCount,this._investmentPoolItemCount,
this._investmentPoolFreeCount),10,a,"#FFFFFF");e.resize()}};MO.FEaiDynamicInfo_oeUpdate=function(a){this._ticker.process()&&this.dirty();return MO.EEventStatus.Stop};MO.FEaiDynamicInfo_construct=function(){this.__base.FGuiControl.construct.call(this);this._size.set(1024,512);this._ticker=new MO.TTicker(1E3)};MO.FEaiGroupReportScene=function(a){a=MO.RClass.inherits(this,a,MO.FEaiScene);a._code=MO.EEaiScene.GroupReport;return a};
MO.FEaiGroupScene=function(a){a=MO.RClass.inherits(this,a,MO.FEaiScene);a._code=MO.EEaiScene.Group;return a};
MO.FEaiScene=function(a){a=MO.Class.inherits(this,a,MO.FScene);a._optionDebug=!1;a._guiManager=MO.Class.register(a,new MO.AGetter("_guiManager"));a.onOperationResize=MO.FEaiScene_onOperationResize;a.onOperationOrientation=MO.FEaiScene_onOperationOrientation;a.onProcessAfter=MO.FEaiScene_onProcessAfter;a.construct=MO.FEaiScene_construct;a.setup=MO.FEaiScene_setup;a.active=MO.FEaiScene_active;a.deactive=MO.FEaiScene_deactive;a.processLoaded=MO.FEaiScene_processLoaded;a.processResize=MO.FEaiScene_processResize;
a.processEvent=MO.FEaiScene_processEvent;a.dispose=MO.FEaiScene_dispose;return a};MO.FEaiScene_onOperationResize=function(a){this.__base.FScene.onOperationResize.call(this,a);this.processResize()};MO.FEaiScene_onOperationOrientation=function(a){this.__base.FScene.onOperationOrientation.call(this,a);this.processResize()};MO.FEaiScene_onProcessAfter=function(){this.__base.FScene.onProcessAfter.call(this);this._guiManager.process()};MO.FEaiScene_construct=function(){this.__base.FScene.construct.call(this)};
MO.FEaiScene_setup=function(){this.__base.FScene.setup.call(this);var a=this._application.desktop(),b=a.canvas2d();a.hide();var c=this._guiManager=MO.Class.create(MO.FGuiCanvasManager);c.linkGraphicContext(this);c.setDesktop(a);c.setCanvas(b);c.setup();this._optionDebug&&(a=this._application.dynamicInfo(),c.register(a))};
MO.FEaiScene_active=function(){this.__base.FScene.active.call(this);var a=this._activeStage;if(this._optionDebug){var b=this._application.dynamicInfo();b.setDisplayOrder(1E4);b.setStage(a);b.setGuiManager(this._guiManager)}this._application.desktop().selectStage(a)};MO.FEaiScene_deactive=function(){this.__base.FScene.deactive.call(this);this._application.desktop().selectStage(null)};MO.FEaiScene_processLoaded=function(){var a=new MO.SEvent(this);MO.Window.lsnsLoaded.process(a);a.dispose();this._application.desktop().show()};
MO.FEaiScene_processResize=function(a){this._guiManager.dirty()};MO.FEaiScene_processEvent=function(a){this.__base.FScene.processEvent.call(this,a);this._guiManager.processEvent(a)};MO.FEaiScene_dispose=function(){this._guiManager=MO.RObject.dispose(this._guiManager);this.__base.FScene.dispose.call(this)};with(MO)MO.FEaiChapter=function(a){return a=RClass.inherits(this,a,FChapter)};
MO.FEaiChartChapter=function(a){a=MO.RClass.inherits(this,a,MO.FEaiChapter);a._code=MO.EEaiChapter.Chart;a._sceneTotal=MO.Class.register(a,new MO.AGetter("_sceneTotal"));a._sceneHistory=MO.Class.register(a,new MO.AGetter("_sceneHistory"));a._sceneLive=MO.Class.register(a,new MO.AGetter("_sceneLive"));a.construct=MO.FEaiChartChapter_construct;a.setup=MO.FEaiChartChapter_setup;a.process=MO.FEaiChartChapter_process;a.dispose=MO.FEaiChartChapter_dispose;return a};MO.FEaiChartChapter_construct=function(){this.__base.FEaiChapter.construct.call(this)};
MO.FEaiChartChapter_setup=function(){var a=this._sceneTotal=MO.RClass.create(MO.FEaiChartTotalScene);a.linkGraphicContext(this);this.registerScene(a);a=this._sceneHistory=MO.RClass.create(MO.FEaiChartHistoryScene);a.linkGraphicContext(this);this.registerScene(a);a=this._sceneLive=MO.RClass.create(MO.FEaiChartLiveScene);a.linkGraphicContext(this);this.registerScene(a)};MO.FEaiChartChapter_process=function(){this.__base.FEaiChapter.process.call(this)};MO.FEaiChartChapter_dispose=function(){this.__base.FEaiChapter.dispose.call(this)};
MO.FEaiLoadingChapter=function(a){a=MO.RClass.inherits(this,a,MO.FEaiChapter);a._code=MO.EEaiChapter.Loading;return a};MO.FEaiLoginChapter=function(a){a=MO.RClass.inherits(this,a,MO.FEaiChapter);a._code=MO.EEaiChapter.Login;return a};
MO.FEaiSceneChapter=function(a){a=MO.RClass.inherits(this,a,MO.FEaiChapter);a._code=MO.EEaiChapter.Scene;a._sceneCountry=null;a._sceneGroup=null;a._sceneGroupReport=null;a._sceneCompany=null;a.construct=MO.FEaiSceneChapter_construct;a.setup=MO.FEaiSceneChapter_setup;a.process=MO.FEaiSceneChapter_process;a.dispose=MO.FEaiSceneChapter_dispose;return a};MO.FEaiSceneChapter_construct=function(){this.__base.FEaiChapter.construct.call(this)};
MO.FEaiSceneChapter_setup=function(){var a=this._sceneCountry=MO.RClass.create(MO.FEaiCountryScene);a.linkGraphicContext(this);this.registerScene(a);a=this._sceneGroup=MO.RClass.create(MO.FEaiGroupScene);a.linkGraphicContext(this);this.registerScene(a);a=this._sceneGroupReport=MO.RClass.create(MO.FEaiGroupReportScene);a.linkGraphicContext(this);this.registerScene(a);a=this._sceneCompany=MO.RClass.create(MO.FEaiCompanyScene);a.linkGraphicContext(this);this.registerScene(a)};
MO.FEaiSceneChapter_process=function(){this.__base.FEaiChapter.process.call(this)};MO.FEaiSceneChapter_dispose=function(){this.__base.FEaiChapter.dispose.call(this)};MO.FEaiApplication=function(a){a=MO.Class.inherits(this,a,MO.FApplication);a._desktop=MO.Class.register(a,new MO.AGetter("_desktop"));a.setup=MO.FEaiApplication_setup;a.processResize=MO.FEaiApplication_processResize;a.processEvent=MO.FEaiApplication_processEvent;return a};
MO.FEaiApplication_setup=function(a){a=MO.Console.find(MO.FG3dEffectConsole);a.register("general.color.eai.map.face",MO.FEaiMapFaceEffect);a.register("general.color.eai.citys",MO.FEaiCityEffect);a.register("general.color.eai.citys.range",MO.FEaiCityRangeEffect)};MO.FEaiApplication_processResize=function(){this.__base.FApplication.processResize.call(this,event);var a=this._desktop;a&&a.resize()};
MO.FEaiApplication_processEvent=function(a){this.__base.FApplication.processEvent.call(this,a);var b=this._desktop;b&&b.processEvent(a)};
MO.FEaiCanvas=function(a){a=MO.Class.inherits(this,a,MO.FE3dCanvas);a._scaleRate=1;a._optionAlpha=!1;a._optionAntialias=!1;a._activeStage=MO.Class.register(a,new MO.AGetter("_activeStage"));a._capturePosition=null;a._captureRotation=null;a.construct=MO.FEaiCanvas_construct;a.resize=MO.FEaiCanvas_resize;a.selectStage=MO.FEaiCanvas_selectStage;a.dispose=MO.FEaiCanvas_dispose;return a};
MO.FEaiCanvas_construct=function(){this.__base.FE3dCanvas.construct.call(this);this._rotation=new MO.SVector3;this._capturePosition=new MO.SPoint2;this._captureRotation=new MO.SVector3};MO.FEaiCanvas_resize=function(a,b){this.__base.FE3dCanvas.resize.call(this,a,b);var c=this._graphicContext.size(),d=this._activeStage;d&&(d=d.camera().projection(),d.size().set(c.width,c.height),d.update())};
MO.FEaiCanvas_selectStage=function(a){a&&(a.linkGraphicContext(this),a.region().linkGraphicContext(this),a.selectTechnique(this,MO.FE3dGeneralTechnique));this._activeStage=a};MO.FEaiCanvas_dispose=function(){this._rotation=MO.Lang.Object.dispose(this._rotation);this._capturePosition=MO.Lang.Object.dispose(this._capturePosition);this._captureRotation=MO.Lang.Object.dispose(this._captureRotation);this.__base.FE3dCanvas.dispose.call(this)};
MO.FEaiChartApplication=function(a){a=MO.Class.inherits(this,a,MO.FEaiApplication);a._sceneCode=MO.Class.register(a,new MO.AGetSet("_sceneCode"),MO.EEaiScene.ChartHistory);a._chapterLoading=MO.Class.register(a,new MO.AGetter("_chapterLoading"));a._chapterChart=MO.Class.register(a,new MO.AGetter("_chapterChart"));a._dynamicInfo=MO.Class.register(a,new MO.AGetter("_dynamicInfo"));a._thread=null;a._interval=10;a.onLoadCountry=MO.FEaiChartApplication_onLoadCountry;a.onLoadResource=MO.FEaiChartApplication_onLoadResource;
a.construct=MO.FEaiChartApplication_construct;a.createCanvas=MO.FEaiChartApplication_createCanvas;a.setup=MO.FEaiChartApplication_setup;a.dispose=MO.FEaiChartApplication_dispose;return a};MO.FEaiChartApplication_onLoadCountry=function(a){this.selectChapterByCode(MO.EEaiChapter.Chart).selectSceneByCode(this._sceneCode);this.processResize()};
MO.FEaiChartApplication_onLoadResource=function(){var a=this._desktop.canvas3d(),b=MO.Console.find(MO.FEaiEntityConsole);b.linkGraphicContext(a);b.setup();b.addLoadCountryListener(this,this.onLoadCountry);b.loadCountryData();this.processResize()};MO.FEaiChartApplication_construct=function(){this.__base.FEaiApplication.construct.call(this)};MO.FEaiChartApplication_createCanvas=function(){return RClass.create(FEaiChartCanvas)};
MO.FEaiChartApplication_setup=function(a){this.__base.FEaiApplication.setup.call(this,a);this._hPanel=a;var b=this._desktop=MO.RClass.create(MO.FEaiChartDesktop);b.build(a);a=MO.Eai.Canvas=b.canvas3d();a.graphicContext().isValid()&&(this.linkGraphicContext(a),b=this._dynamicInfo=MO.Class.create(MO.FEaiDynamicInfo),b.linkGraphicContext(a),b.setContext(a.graphicContext()),b.location().set(10,300),b.build(),a=this._chapterChart=MO.RClass.create(MO.FEaiChartChapter),a.linkGraphicContext(this),this.registerChapter(a),
a=MO.RConsole.find(MO.FEaiResourceConsole),a.addLoadListener(this,this.onLoadResource),a.load("{eai.resource}/resource.dat"))};MO.FEaiChartApplication_dispose=function(){this._chapterLoading=MO.Lang.Object.dispose(this._chapterLoading);this._chapterChart=MO.Lang.Object.dispose(this._chapterChart);this._dynamicInfo=MO.Lang.Object.dispose(this._dynamicInfo);this.__base.FEaiApplication.dispose.call(this)};
MO.FEaiChartCanvas=function(a){a=MO.Class.inherits(this,a,MO.FEaiCanvas);a._optionStageProcess=!1;a._optionResize=!1;a._optionMouseCapture=!1;a._optionAlpha=!0;a._optionAntialias=!1;a._capturePosition=null;a._cameraPosition=null;a.construct=MO.FEaiChartCanvas_construct;a.setPanel=MO.FEaiChartCanvas_setPanel;a.dispose=MO.FEaiChartCanvas_dispose;return a};
MO.FEaiChartCanvas_construct=function(){this.__base.FEaiCanvas.construct.call(this);this._logicSize=new MO.SSize2(1920,1080);this._cameraPosition=new MO.SPoint3};MO.FEaiChartCanvas_setPanel=function(a){this._hPanel=a;a.appendChild(this._hCanvas)};MO.FEaiChartCanvas_dispose=function(){this._cameraPosition=MO.Lang.Object.dispose(this._cameraPosition);this.__base.FEaiCanvas.dispose.call(this)};
MO.FEaiChartDesktop=function(a){a=MO.Class.inherits(this,a,MO.FEaiDesktop);a._orientationCd=null;a._visible=MO.Class.register(a,new MO.AGetter("_visible"),!0);a._canvas3d=MO.Class.register(a,new MO.AGetter("_canvas3d"));a._canvas2d=MO.Class.register(a,new MO.AGetter("_canvas2d"));a.onOperationResize=MO.FEaiChartDesktop_onOperationResize;a.onOperationOrientation=MO.FEaiChartDesktop_onOperationOrientation;a.construct=MO.FEaiChartDesktop_construct;a.build=MO.FEaiChartDesktop_build;a.resize=MO.FEaiChartDesktop_resize;
a.show=MO.FEaiChartDesktop_show;a.hide=MO.FEaiChartDesktop_hide;a.setVisible=MO.FEaiChartDesktop_setVisible;a.selectStage=MO.FEaiChartDesktop_selectStage;a.dispose=MO.FEaiChartDesktop_dispose;return a};MO.FEaiChartDesktop_onOperationResize=function(a){this.__base.FEaiDesktop.onOperationResize.call(this,a);this.resize()};MO.FEaiChartDesktop_onOperationOrientation=function(){this.__base.FEaiDesktop.onOperationOrientation.call(this,event);this.resize()};MO.FEaiChartDesktop_construct=function(){this.__base.FEaiDesktop.construct.call(this)};
MO.FEaiChartDesktop_build=function(a){this.__base.FEaiDesktop.build.call(this,a);var b=this._canvas3d=MO.RClass.create(MO.FEaiChartCanvas);b.setDesktop(this);b.build(a);b.setPanel(a);this.canvasRegister(b);b=this._canvas2d=MO.RClass.create(MO.FE2dCanvas);b.setDesktop(this);b.build(a);b.setPanel(a);b._hCanvas.style.position="absolute";this.canvasRegister(b);MO.RE3dEngine.setup()};
MO.FEaiChartDesktop_resize=function(a,b){var c=MO.Window.Browser,d=null!=a?a:window.innerWidth,e=null!=b?b:window.innerHeight,f=c.orientationCd();if(!this._screenSize.equalsData(d,e)||this._orientationCd!=f){this._screenSize.set(d,e);this._orientationCd=f;var g=c.capability().pixelRatio,f=parseInt(d*g),h=parseInt(e*g);this._size.set(f,h);var k=1,m=1,l=this._logicSize;c.isOrientationVertical()?(k=f/l.height,m=h/l.width,this._calculateSize.set(l.height,l.width)):(k=f/l.width,m=h/l.height,this._calculateSize.set(l.width,
l.height));l=this._sizeRate=Math.min(k,m);this._logicRate.set(k,m);k>m?this._calculateRate.set(k/l,1):k<m?this._calculateRate.set(1,m/l):this._calculateRate.set(1,1);MO.Logger.info(this,"Change screen size. (orientation={1}, ratio={2}, screen_size={3}, size={4}, rate={5}, calculate_rate={6})",c.orientationCd(),g,this._screenSize.toDisplay(),this._size.toDisplay(),l,this._calculateRate.toDisplay());c=MO.Runtime.isPlatformMobile();this._canvas3d.resize(f,h);g=this._canvas3d.graphicContext();c&&(k=this._canvas3d._hCanvas,
k.style.width=d+"px",k.style.height=e+"px");g.setViewport(0,0,this._size.width,this._size.height);g=this._canvas2d;g.resize(f,h);g.graphicContext().setGlobalScale(l,l);c&&(f=g._hCanvas,f.style.width=d+"px",f.style.height=e+"px");d=this._canvas3d.activeStage();this.selectStage(d)}};MO.FEaiChartDesktop_show=function(){this.setVisible(!0)};MO.FEaiChartDesktop_hide=function(){this.setVisible(!1)};MO.FEaiChartDesktop_setVisible=function(a){this._visible=a;this._canvas2d.setVisible(a);this._canvas3d.setVisible(a)};
MO.FEaiChartDesktop_selectStage=function(a){this._canvas3d.selectStage(a);if(a){var b=a.region().camera(),c=b.projection();c.size().assign(this._size);c.setAngle(80);c.update();b.position().set(0,0,-10);b.lookAt(0,0,0);b.update()}this._activeStage=a};MO.FEaiChartDesktop_dispose=function(){this._canvas3d=MO.Lang.Object.dispose(this._canvas3d);this._canvas2d=MO.Lang.Object.dispose(this._canvas2d);this.__base.FEaiDesktop.dispose.call(this)};
MO.FEaiDesktop=function(a){a=MO.Class.inherits(this,a,MO.FDesktop);a.construct=MO.FEaiDesktop_construct;a.dispose=MO.FEaiDesktop_dispose;return a};MO.FEaiDesktop_construct=function(){this.__base.FDesktop.construct.call(this);this._size.set(1920,1080);this._logicSize.set(1920,1080)};MO.FEaiDesktop_dispose=function(){this.__base.FDesktop.dispose.call(this)};
with(MO)MO.FEaiFlatCanvas=function(a){a=RClass.inherits(this,a,FEaiCanvas);a._capturePosition=null;a._cameraPosition=null;a.onEnterFrame=FEaiFlatCanvas_onEnterFrame;a.onMouseCaptureStart=FEaiFlatCanvas_onMouseCaptureStart;a.onMouseCapture=FEaiFlatCanvas_onMouseCapture;a.onMouseCaptureStop=FEaiFlatCanvas_onMouseCaptureStop;a.construct=FEaiFlatCanvas_construct;a.setPanel=FEaiFlatCanvas_setPanel;a.dispose=FEaiFlatCanvas_dispose;return a},MO.FEaiFlatCanvas_onEnterFrame=function(){var a=this._activeStage;
if(a){var a=a.camera(),b=RKeyboard.isPress(EKeyCode.W),c=RKeyboard.isPress(EKeyCode.S);b&&!c&&a.doMoveY(.5);!b&&c&&a.doMoveY(-.5);b=RKeyboard.isPress(EKeyCode.A);c=RKeyboard.isPress(EKeyCode.D);b&&!c&&a.doMoveX(-.5);!b&&c&&a.doMoveX(.5);a.update()}},MO.FEaiFlatCanvas_onMouseCaptureStart=function(a){var b=this._activeStage;b&&(this._capturePosition.set(a.clientX,a.clientY),this._cameraPosition.assign(b.camera().position()))},MO.FEaiFlatCanvas_onMouseCapture=function(a){var b=this._activeStage;if(b){var c=
a.clientX-this._capturePosition.x;a=a.clientY-this._capturePosition.y;b=b.camera().position();b.x=this._cameraPosition.x-.03*c;b.y=this._cameraPosition.y+.03*a}},MO.FEaiFlatCanvas_onMouseCaptureStop=function(a){},MO.FEaiFlatCanvas_construct=function(){this.__base.FEaiCanvas.construct.call(this);this._logicSize=new SSize2(1920,1080);this._cameraPosition=new SPoint3},MO.FEaiFlatCanvas_setPanel=function(a){this.__base.FEaiCanvas.setPanel.call(this,a)},MO.FEaiFlatCanvas_dispose=function(){this._cameraPosition=
RObject.dispose(this._cameraPosition);this.__base.FEaiCanvas.dispose.call(this)};
with(MO)MO.FEaiPlatformApplication=function(a){a=RClass.inherits(this,a,FEaiApplication);a._chapterLoading=RClass.register(a,new AGetter("_chapterLoading"));a._chapterLogin=RClass.register(a,new AGetter("_chapterLogin"));a._chapterScene=RClass.register(a,new AGetter("_chapterScene"));a._chapterChart=RClass.register(a,new AGetter("_chapterChart"));a._thread=null;a._interval=10;a.onLoadResource=FEaiPlatformApplication_onLoadResource;a.construct=FEaiPlatformApplication_construct;a.createCanvas=FEaiPlatformApplication_createCanvas;
a.setup=FEaiPlatformApplication_setup;a.dispose=FEaiPlatformApplication_dispose;return a},MO.FEaiPlatformApplication_onLoadResource=function(){this.selectChapterByCode(MO.EEaiChapter.Scene).selectSceneByCode(MO.EEaiScene.Country)},MO.FEaiPlatformApplication_construct=function(){this.__base.FEaiApplication.construct.call(this)},MO.FEaiPlatformApplication_createCanvas=function(){return RClass.create(FEaiPlatformCanvas)},MO.FEaiPlatformApplication_setup=function(){var a=this._chapterLoading=MO.RClass.create(MO.FEaiLoadingChapter);
a.linkGraphicContext(this);this.registerChapter(a);a=this._chapterLogin=MO.RClass.create(MO.FEaiLoginChapter);a.linkGraphicContext(this);this.registerChapter(a);a=this._chapterScene=MO.RClass.create(MO.FEaiSceneChapter);a.linkGraphicContext(this);this.registerChapter(a);a=this._chapterChart=MO.RClass.create(MO.FEaiChartChapter);a.linkGraphicContext(this);this.registerChapter(a);a=MO.RConsole.find(MO.FEaiResourceConsole);a.addLoadListener(this,this.onLoadResource);a.load()},MO.FEaiPlatformApplication_dispose=
function(){this.__base.FEaiApplication.dispose.call(this)};
with(MO)MO.FEaiPlatformCanvas=function(a){a=RClass.inherits(this,a,FEaiCanvas);a._capturePosition=null;a._captureRotation=null;a.onEnterFrame=FEaiPlatformCanvas_onEnterFrame;a.onMouseCaptureStart=FEaiPlatformCanvas_onMouseCaptureStart;a.onMouseCapture=FEaiPlatformCanvas_onMouseCapture;a.onMouseCaptureStop=FEaiPlatformCanvas_onMouseCaptureStop;a.construct=FEaiPlatformCanvas_construct;a.dispose=FEaiPlatformCanvas_dispose;return a},MO.FEaiPlatformCanvas_onEnterFrame=function(){var a=this._activeStage;
if(a){var b=a.camera(),c=.05,d=RKeyboard.isPress(EKeyCode.W),e=RKeyboard.isPress(EKeyCode.S);d&&!e&&b.doWalk(.5);!d&&e&&b.doWalk(-.5);d=RKeyboard.isPress(EKeyCode.A);e=RKeyboard.isPress(EKeyCode.D);d&&!e&&b.doYaw(c);!d&&e&&b.doYaw(-c);d=RKeyboard.isPress(EKeyCode.Q);e=RKeyboard.isPress(EKeyCode.E);d&&!e&&b.doFly(.5);!d&&e&&b.doFly(-.5);e=RKeyboard.isPress(EKeyCode.Z);d=RKeyboard.isPress(EKeyCode.X);e&&!d&&b.doPitch(c);!e&&d&&b.doPitch(-c);b.update();if(this._optionRotation){c=this._rotation;a=a.layers();
b=a.count();for(d=0;d<b;d++)e=a.value(d).matrix(),e.setRotation(0,c.y,0),e.update();c.y+=.01}}},MO.FEaiPlatformCanvas_onMouseCaptureStart=function(a){var b=this._activeStage;if(b){var c=this._activeStage.region();RConsole.find(FG3dTechniqueConsole).find(this._graphicContext,FG3dSelectTechnique).test(c,a.offsetX,a.offsetY);this._capturePosition.set(a.clientX,a.clientY);this._captureRotation.assign(b.camera()._rotation)}},MO.FEaiPlatformCanvas_onMouseCapture=function(a){if(this._activeStage){var b=
a.clientX-this._capturePosition.x;a=a.clientY-this._capturePosition.y;var c=this._activeStage.camera().rotation(),d=this._captureRotation;c.x=d.x+.003*a;c.y=d.y+.003*b}},MO.FEaiPlatformCanvas_onMouseCaptureStop=function(a){},MO.FEaiPlatformCanvas_construct=function(){this.__base.FEaiCanvas.construct.call(this)},MO.FEaiPlatformCanvas_dispose=function(){this.__base.FEaiCanvas.dispose.call(this)};MO.Eai.setup=function(a,b){};
