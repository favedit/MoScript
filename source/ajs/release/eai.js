MO.EEaiChapter=new function(){this.Loading="loading";this.Login="login";this.Scene="scene";this.Chart="chart";return this};MO.EEaiConstant=new function(){this.DefaultCountry="china";this.LogicService="eai.logic.service";this.ServiceHost="eai.host.service";this.Resource="eai.resource";return this};MO.EEaiRate=new function(){this.Line=0;this.Map=1;this.Investment=2;this.InvestmentRange=3;return this};
MO.EEaiScene=new function(){this.Group="group";this.GroupReport="group.report";this.Company="company";this.Country="country";this.ChartTotal="chart.total";this.ChartHistory="chart.history";this.ChartCustomer="chart.customer";this.ChartMarketer="chart.marketer";this.ChartDepartment="chart.department";this.ChartLive="chart.live";this.ChartWorld="chart.world";this.ChartSales="chart.sales";this.ChartIndustry="chart.industry";this.ChartInvestment="chart.investment";this.ChartCustomer="chart.customer";
this.ChartPerformence="chart.performence";return this};MO.Eai=new function(){this.Canvas=this.Application=null;return this};MO.FEaiCardResource=function(a){a=MO.Class.inherits(this,a,MO.FObject,MO.MPersistence);a._code=MO.Class.register(a,[new MO.AGetter("_code"),new MO.APersistence("_code",MO.EDataType.Uint16)]);a._cityCode=MO.Class.register(a,[new MO.AGetter("_cityCode"),new MO.APersistence("_cityCode",MO.EDataType.Uint16)]);return a};
MO.FEaiCardResourceModule=function(a){a=MO.Class.inherits(this,a,MO.FEaiResourceModule);a._cards=MO.Class.register(a,new MO.AGetter("_cards"));a.construct=MO.FEaiCardResourceModule_construct;a.find=MO.FEaiCardResourceModule_find;a.findCityCode=MO.FEaiCardResourceModule_findCityCode;a.unserialize=MO.FEaiCardResourceModule_unserialize;a.dispose=MO.FEaiCardResourceModule_dispose;return a};MO.FEaiCardResourceModule_construct=function(){this.__base.FEaiResourceModule.construct.call(this);this._cards=new MO.TDictionary};
MO.FEaiCardResourceModule_find=function(a){return this._cards.get(a)};MO.FEaiCardResourceModule_findCityCode=function(a){var b=null;(a=this._cards.get(a))&&(b=a.cityCode());return b};MO.FEaiCardResourceModule_unserialize=function(a){for(var b=this._cards,c=a.readInt32(),e=0;e<c;e++){var d=MO.Class.create(MO.FEaiCardResource);d.unserialize(a);b.set(d.code(),d)}};MO.FEaiCardResourceModule_dispose=function(){this._cards=MO.Lang.Object.dispose(this._cards);this.__base.FEaiResourceModule.dispose.call(this)};
MO.FEaiCityResource=function(a){a=MO.Class.inherits(this,a,MO.FObject,MO.MPersistence);a._provinceCode=MO.Class.register(a,[new MO.AGetter("_provinceCode"),new MO.APersistence("_provinceCode",MO.EDataType.Uint16)]);a._code=MO.Class.register(a,[new MO.AGetter("_code"),new MO.APersistence("_code",MO.EDataType.Uint16)]);a._label=MO.Class.register(a,[new MO.AGetter("_label"),new MO.APersistence("_label",MO.EDataType.String)]);a._level=MO.Class.register(a,[new MO.AGetter("_level"),new MO.APersistence("_level",
MO.EDataType.Uint16)]);a._location=MO.Class.register(a,[new MO.AGetter("_location"),new MO.APersistence("_location",MO.EDataType.Struct,MO.SPoint2)]);return a};
MO.FEaiCityResourceModule=function(a){a=MO.Class.inherits(this,a,MO.FEaiResourceModule);a._resourceConsole=MO.Class.register(a,new MO.AGetSet("_resourceConsole"));a._citys=MO.Class.register(a,new MO.AGetter("_citys"));a.construct=MO.FEaiCityResourceModule_construct;a.find=MO.FEaiCityResourceModule_find;a.findByCard=MO.FEaiCityResourceModule_findByCard;a.unserialize=MO.FEaiCityResourceModule_unserialize;a.dispose=MO.FEaiCityResourceModule_dispose;return a};
MO.FEaiCityResourceModule_construct=function(){this.__base.FEaiResourceModule.construct.call(this);this._citys=new MO.TDictionary};MO.FEaiCityResourceModule_find=function(a){return this._citys.get(a)};MO.FEaiCityResourceModule_findByCard=function(a){var b=null;(a=this._resourceConsole.cardModule().findCityCode(a))&&(b=this._citys.get(a));return b};
MO.FEaiCityResourceModule_unserialize=function(a){for(var b=this._citys,c=a.readInt32(),e=0;e<c;e++){var d=MO.Class.create(MO.FEaiCityResource);d.unserialize(a);b.set(d.code(),d)}};MO.FEaiCityResourceModule_dispose=function(){this._citys=MO.Lang.Object.dispose(this._citys);this.__base.FEaiResourceModule.dispose.call(this)};
MO.FEaiDepartmentResource=function(a){a=MO.Class.inherits(this,a,MO.FObject,MO.MPersistence);a._code=MO.Class.register(a,[new MO.AGetter("_code"),new MO.APersistence("_code",MO.EDataType.String)]);a._label=MO.Class.register(a,[new MO.AGetter("_label"),new MO.APersistence("_label",MO.EDataType.String)]);a._fullLabel=MO.Class.register(a,[new MO.AGetter("_fullLabel"),new MO.APersistence("_fullLabel",MO.EDataType.String)]);return a};
MO.FEaiDepartmentResourceModule=function(a){a=MO.Class.inherits(this,a,MO.FEaiResourceModule,MO.MPersistence);a._departments=MO.Class.register(a,[new MO.AGetter("_departments"),new MO.APersistence("_departments",MO.EDataType.Objects,MO.FEaiDepartmentResource)]);a.construct=MO.FEaiDepartmentResourceModule_construct;a.find=MO.FEaiDepartmentResourceModule_find;a.findByFullLabel=MO.FEaiDepartmentResourceModule_findByFullLabel;a.dispose=MO.FEaiDepartmentResourceModule_dispose;return a};
MO.FEaiDepartmentResourceModule_construct=function(){this.__base.FEaiResourceModule.construct.call(this);this._departments=new MO.TObjects};MO.FEaiDepartmentResourceModule_find=function(a){return this._departments.get(a)};MO.FEaiDepartmentResourceModule_findByFullLabel=function(a){for(var b=this._departments,c=b.count(),e=0;e<c;e++){var d=b.at(e);if(d.fullLabel()==a)return d}return null};
MO.FEaiDepartmentResourceModule_dispose=function(){this._departments=MO.Lang.Object.dispose(this._departments);this.__base.FEaiResourceModule.dispose.call(this)};MO.FEaiHistoryCityResource=function(a){a=MO.Class.inherits(this,a,MO.FObject);a._code=MO.Class.register(a,new MO.AGetSet("_code"));a._investmentDay=MO.Class.register(a,new MO.AGetSet("_investmentDay"));a._investmentTotal=MO.Class.register(a,new MO.AGetSet("_investmentTotal"));a.unserialize=MO.FEaiHistoryCityResource_unserialize;return a};
MO.FEaiHistoryCityResource_unserialize=function(a){this._code=a.readUint16();this._investmentDay=a.readFloat();this._investmentTotal=a.readFloat()};
MO.FEaiHistoryDateResource=function(a){a=MO.Class.inherits(this,a,MO.FObject);a._code=MO.Class.register(a,new MO.AGetter("_code"));a._investmentDay=MO.Class.register(a,new MO.AGetter("_investmentDay"));a._investmentTotal=MO.Class.register(a,new MO.AGetter("_investmentTotal"));a._provinces=MO.Class.register(a,new MO.AGetter("_provinces"));a._citys=MO.Class.register(a,new MO.AGetter("_citys"));a.construct=MO.FEaiHistoryDateResource_construct;a.unserialize=MO.FEaiHistoryDateResource_unserialize;a.dispose=
MO.FEaiHistoryDateResource_dispose;return a};MO.FEaiHistoryDateResource_construct=function(){this.__base.FObject.construct.call(this);this._provinces=new MO.TDictionary;this._citys=new MO.TDictionary};
MO.FEaiHistoryDateResource_unserialize=function(a){this._code=a.readString();this._investmentDay=a.readFloat();this._investmentTotal=a.readFloat();for(var b=this._provinces,c=a.readInt32(),e=0;e<c;e++){var d=MO.Class.create(MO.FEaiHistoryProvinceResource);d.unserialize(a);b.set(d.code(),d)}b=this._citys;c=a.readInt32();for(e=0;e<c;e++)d=MO.Class.create(MO.FEaiHistoryCityResource),d.unserialize(a),b.set(d.code(),d)};
MO.FEaiHistoryDateResource_dispose=function(){this._provinces=MO.Lang.Object.dispose(this._provinces);this._citys=MO.Lang.Object.dispose(this._citys);this.__base.FObject.dispose.call(this)};
MO.FEaiHistoryMilestoneResource=function(a){a=MO.Class.inherits(this,a,MO.FObject);a._code=MO.Class.register(a,new MO.AGetSet("_code"));a._investmentTotal=MO.Class.register(a,new MO.AGetSet("_investmentTotal"));a._dayCount=MO.Class.register(a,new MO.AGetSet("_dayCount"));a._companyCount=MO.Class.register(a,new MO.AGetSet("_companyCount"));a._staffCount=MO.Class.register(a,new MO.AGetSet("_staffCount"));a.unserialize=MO.FEaiHistoryMilestoneResource_unserialize;return a};
MO.FEaiHistoryMilestoneResource_unserialize=function(a){this._code=a.readString();this._investmentTotal=a.readFloat();this._dayCount=a.readUint16();this._companyCount=a.readUint16();this._staffCount=a.readUint16()};
MO.FEaiHistoryProvinceResource=function(a){a=MO.Class.inherits(this,a,MO.FObject);a._code=MO.Class.register(a,new MO.AGetSet("_code"));a._investmentDay=MO.Class.register(a,new MO.AGetSet("_investmentDay"));a._investmentTotal=MO.Class.register(a,new MO.AGetSet("_investmentTotal"));a.unserialize=MO.FEaiHistoryProvinceResource_unserialize;return a};MO.FEaiHistoryProvinceResource_unserialize=function(a){this._code=a.readUint16();this._investmentDay=a.readFloat();this._investmentTotal=a.readFloat()};
MO.FEaiHistoryResourceModule=function(a){a=MO.Class.inherits(this,a,MO.FEaiResourceModule,MO.MListener);a._investmentDay=MO.Class.register(a,new MO.AGetter("_investmentDay"));a._investmentTotal=MO.Class.register(a,new MO.AGetter("_investmentTotal"));a._investmentProvinceDay=MO.Class.register(a,new MO.AGetter("_investmentProvinceDay"));a._investmentProvinceTotal=MO.Class.register(a,new MO.AGetter("_investmentProvinceTotal"));a._investmentCityDay=MO.Class.register(a,new MO.AGetter("_investmentCityDay"));
a._investmentCityTotal=MO.Class.register(a,new MO.AGetter("_investmentCityTotal"));a._provinces=MO.Class.register(a,new MO.AGetter("_provinces"));a._citys=MO.Class.register(a,new MO.AGetter("_citys"));a._milestones=MO.Class.register(a,new MO.AGetter("_milestones"));a._dates=MO.Class.register(a,new MO.AGetter("_dates"));a._listenersLoad=MO.Class.register(a,new MO.AListener("_listenersLoad",MO.EEvent.Load));a.onLoad=MO.FEaiHistoryResourceModule_onLoad;a.construct=MO.FEaiHistoryResourceModule_construct;
a.unserialize=MO.FEaiHistoryResourceModule_unserialize;a.load=MO.FEaiHistoryResourceModule_load;a.dispose=MO.FEaiHistoryResourceModule_dispose;return a};MO.FEaiHistoryResourceModule_onLoad=function(a){a=a.content;var b=MO.Class.create(MO.FDataView);b.setEndianCd(!0);b.link(a);this.unserialize(b);b.dispose();a=new MO.SEvent;this.processLoadListener(a);a.dispose()};
MO.FEaiHistoryResourceModule_construct=function(){this.__base.FEaiResourceModule.construct.call(this);this._provinces=new MO.TDictionary;this._citys=new MO.TDictionary;this._milestones=new MO.TDictionary;this._dates=new MO.TDictionary};
MO.FEaiHistoryResourceModule_unserialize=function(a){this._investmentDay=a.readFloat();this._investmentTotal=a.readFloat();this._investmentProvinceDay=a.readFloat();this._investmentProvinceTotal=a.readFloat();this._investmentCityDay=a.readFloat();this._investmentCityTotal=a.readFloat();var b=this._provinces;b.clear();for(var c=a.readInt32(),e=0;e<c;e++){var d=MO.Class.create(MO.FEaiHistoryProvinceResource);d.unserialize(a);b.set(d.code(),d)}b=this._citys;b.clear();c=a.readInt32();for(e=0;e<c;e++)d=
MO.Class.create(MO.FEaiHistoryCityResource),d.unserialize(a),b.set(d.code(),d);b=this._milestones;b.clear();c=a.readInt32();for(e=0;e<c;e++)d=MO.Class.create(MO.FEaiHistoryMilestoneResource),d.unserialize(a),b.set(d.code(),d);b=this._dates;b.clear();c=a.readInt32();for(e=0;e<c;e++)d=MO.Class.create(MO.FEaiHistoryDateResource),d.unserialize(a),b.set(d.code(),d)};
MO.FEaiHistoryResourceModule_load=function(){var a="{eai.resource}/investment.dat?date="+MO.Lang.Date.format(),a=MO.Console.find(MO.FEnvironmentConsole).parse(a);MO.Console.find(MO.FHttpConsole).send(a).addLoadListener(this,this.onLoad)};MO.FEaiHistoryResourceModule_dispose=function(){this._provinces=RObject.dispose(this._provinces);this._citys=RObject.dispose(this._citys);this._milestones=RObject.dispose(this._milestones);this._dates=RObject.dispose(this._dates);this.__base.FEaiResourceModule.dispose.call(this)};
MO.FEaiMapBoundaryData=function(a){a=MO.Class.inherits(this,a,MO.FObject,MO.ME3dBoundaryPolygon);a.construct=MO.FEaiMapBoundaryData_construct;a.unserialize=MO.FEaiMapBoundaryData_unserialize;a.dispose=MO.FEaiMapBoundaryData_dispose;return a};MO.FEaiMapBoundaryData_construct=function(){this.__base.FObject.construct.call(this);this.__base.ME3dBoundaryPolygon.construct.call(this)};
MO.FEaiMapBoundaryData_unserialize=function(a){for(var b=0,c=this._positionCount=a.readInt32(),e=this._positions=new Float32Array(2*c),d=0;d<c;d++)e[b++]=a.readFloat(),e[b++]=a.readFloat();b=this._indexCount=a.readInt32();c=this._indexes=new Uint16Array(b);for(d=0;d<b;d++)c[d]=a.readUint16()};MO.FEaiMapBoundaryData_dispose=function(){this.__base.ME3dBoundaryPolygon.dispose.call(this);this.__base.FObject.dispose.call(this)};
MO.FEaiMapCountryData=function(a){a=MO.Class.inherits(this,a,MO.FObject);a._code=MO.Class.register(a,new MO.AGetSet("_code"));a._label=MO.Class.register(a,new MO.AGetSet("_label"));a._boundaries=MO.Class.register(a,new MO.AGetter("_boundaries"));a._provinces=MO.Class.register(a,new MO.AGetter("_provinces"));a.construct=MO.FEaiMapCountryData_construct;a.unserialize=MO.FEaiMapCountryData_unserialize;a.dispose=MO.FEaiMapCountryData_dispose;return a};
MO.FEaiMapCountryData_construct=function(){this.__base.FObject.construct.call(this);this._boundaries=new MO.TObjects;this._provinces=new MO.TDictionary};
MO.FEaiMapCountryData_unserialize=function(a){this._code=a.readString();this._label=a.readString();var b=a.readInt32();if(0<b)for(var c=this._boundaries,e=0;e<b;e++){var d=MO.Class.create(MO.FEaiMapBoundaryData);d.unserialize(a);c.push(d)}b=a.readInt32();if(0<b)for(c=this._provinces,e=0;e<b;e++)d=MO.Class.create(MO.FEaiMapProvinceData),d.unserialize(a),c.set(d.code(),d)};
MO.FEaiMapCountryData_dispose=function(){this._boundaries=MO.Lang.Object.dispose(this._boundaries);this._provinces=MO.Lang.Object.dispose(this._provinces);this.__base.FObject.dispose.call(this)};MO.FEaiMapCountryResource=function(a){a=MO.Class.inherits(this,a,MO.FResourcePackage);a._data=MO.Class.register(a,new MO.AGetter("_data"));a.construct=MO.FEaiMapCountryResource_construct;a.unserialize=MO.FEaiMapCountryResource_unserialize;a.dispose=MO.FEaiMapCountryResource_dispose;return a};
MO.FEaiMapCountryResource_construct=function(){this.__base.FResourcePackage.construct.call(this);this._data=MO.Class.create(MO.FEaiMapCountryData)};MO.FEaiMapCountryResource_unserialize=function(a){this._data.unserialize(a)};MO.FEaiMapCountryResource_dispose=function(){this._data=MO.Lang.Object.dispose(this._data);this.__base.FResourcePackage.dispose.call(this)};
MO.FEaiMapProvinceData=function(a){a=MO.Class.inherits(this,a,MO.FObject);a._code=MO.Class.register(a,new MO.AGetSet("_code"));a._boundaries=MO.Class.register(a,new MO.AGetter("_boundaries"));a.construct=MO.FEaiMapProvinceData_construct;a.unserialize=MO.FEaiMapProvinceData_unserialize;a.dispose=MO.FEaiMapProvinceData_dispose;return a};MO.FEaiMapProvinceData_construct=function(){this.__base.FObject.construct.call(this);this._boundaries=new MO.TObjects};
MO.FEaiMapProvinceData_unserialize=function(a){this._code=a.readUint16();var b=a.readInt32();if(0<b)for(var c=this._boundaries,e=0;e<b;e++){var d=MO.Class.create(MO.FEaiMapBoundaryData);d.unserialize(a);c.push(d)}};MO.FEaiMapProvinceData_dispose=function(){this._boundaries=MO.Lang.Object.dispose(this._boundaries);this.__base.FObject.dispose.call(this)};
MO.FEaiMapResourceModule=function(a){a=MO.Class.inherits(this,a,MO.FEaiResourceModule);a._world=MO.Class.register(a,new MO.AGetter("_world"));a._countries=MO.Class.register(a,new MO.AGetter("_countries"));a.construct=MO.FEaiMapResourceModule_construct;a.findCountryByCode=MO.FEaiMapResourceModule_findCountryByCode;a.loadCountry=MO.FEaiMapResourceModule_loadCountry;a.loadWorld=MO.FEaiMapResourceModule_loadWorld;a.dispose=MO.FEaiMapResourceModule_dispose;return a};
MO.FEaiMapResourceModule_construct=function(){this.__base.FEaiResourceModule.construct.call(this);this._countries=new MO.TDictionary};MO.FEaiMapResourceModule_findCountryByCode=function(a){return this._countries.get(a)};MO.FEaiMapResourceModule_loadCountry=function(a){var b=this._countries,c=b.get(name);c||(c=MO.Class.create(MO.FEaiMapCountryResource),c.setCode(a),c.setUri("{eai.resource}-{device.type}/map/country/"+a+".dat"),c.load(),b.set(a,c));return c};
MO.FEaiMapResourceModule_loadWorld=function(){var a=this._world;a||(a=this._world=MO.Class.create(MO.FEaiMapWorldResource),a.load());return a};MO.FEaiMapResourceModule_dispose=function(){this._world=MO.Lang.Object.dispose(this._world);this._countries=MO.Lang.Object.dispose(this._countries,!0);this.__base.FEaiResourceModule.dispose.call(this)};
MO.FEaiMapWorldData=function(a){a=MO.Class.inherits(this,a,MO.FObject);a._countries=MO.Class.register(a,new MO.AGetter("_countries"));a.construct=MO.FEaiMapWorldData_construct;a.unserialize=MO.FEaiMapWorldData_unserialize;a.dispose=MO.FEaiMapWorldData_dispose;return a};MO.FEaiMapWorldData_construct=function(){this.__base.FObject.construct.call(this);this._countries=new MO.TObjects};
MO.FEaiMapWorldData_unserialize=function(a){var b=a.readInt32();if(0<b)for(var c=this._countries,e=0;e<b;e++){var d=MO.Class.create(MO.FEaiMapCountryData);d.unserialize(a);c.push(d)}};MO.FEaiMapWorldData_dispose=function(){this._countries=MO.Lang.Object.dispose(this._countries);this.__base.FObject.dispose.call(this)};
MO.FEaiMapWorldResource=function(a){a=MO.Class.inherits(this,a,MO.FResourcePackage);a._uri="{eai.resource}-{device.type}/map/world.dat";a._data=MO.Class.register(a,new MO.AGetter("_data"));a.construct=MO.FEaiMapWorldResource_construct;a.unserialize=MO.FEaiMapWorldResource_unserialize;a.dispose=MO.FEaiMapWorldResource_dispose;return a};MO.FEaiMapWorldResource_construct=function(){this.__base.FResourcePackage.construct.call(this);this._data=MO.Class.create(MO.FEaiMapWorldData)};
MO.FEaiMapWorldResource_unserialize=function(a){this._data.unserialize(a)};MO.FEaiMapWorldResource_dispose=function(){this._data=MO.Lang.Object.dispose(this._data);this.__base.FResourcePackage.dispose.call(this)};
MO.FEaiProvinceResource=function(a){a=MO.Class.inherits(this,a,MO.FObject,MO.MPersistence);a._code=MO.Class.register(a,[new MO.AGetter("_code"),new MO.APersistence("_code",MO.EDataType.Uint16)]);a._name=MO.Class.register(a,[new MO.AGetter("_name"),new MO.APersistence("_name",MO.EDataType.String)]);a._label=MO.Class.register(a,[new MO.AGetter("_label"),new MO.APersistence("_label",MO.EDataType.String)]);a._typeCd=MO.Class.register(a,[new MO.AGetter("_typeCd"),new MO.APersistence("_typeCd",MO.EDataType.String)]);
a._displayOrder=MO.Class.register(a,[new MO.AGetter("_displayOrder"),new MO.APersistence("_displayOrder",MO.EDataType.Uint16)]);return a};
MO.FEaiProvinceResourceModule=function(a){a=MO.Class.inherits(this,a,MO.FEaiResourceModule);a._provinceCodes=MO.Class.register(a,new MO.AGetter("_provinceCodes"));a._provinceNames=MO.Class.register(a,new MO.AGetter("_provinceNames"));a.construct=MO.FEaiProvinceResourceModule_construct;a.findByCode=MO.FEaiProvinceResourceModule_findByCode;a.findByName=MO.FEaiProvinceResourceModule_findByName;a.unserialize=MO.FEaiProvinceResourceModule_unserialize;a.dispose=MO.FEaiProvinceResourceModule_dispose;return a};
MO.FEaiProvinceResourceModule_construct=function(){this.__base.FEaiResourceModule.construct.call(this);this._provinceCodes=new MO.TDictionary;this._provinceNames=new MO.TDictionary};MO.FEaiProvinceResourceModule_findByCode=function(a){return this._provinceCodes.get(a)};MO.FEaiProvinceResourceModule_findByName=function(a){return this._provinceNames.get(a)};
MO.FEaiProvinceResourceModule_unserialize=function(a){for(var b=this._provinceCodes,c=this._provinceNames,e=a.readInt32(),d=0;d<e;d++){var f=MO.Class.create(MO.FEaiProvinceResource);f.unserialize(a);b.set(f.code(),f);c.set(f.name(),f)}};MO.FEaiProvinceResourceModule_dispose=function(){this._provinceCodes=MO.Lang.Object.dispose(this._provinceCodes);this._provinceNames=MO.Lang.Object.dispose(this._provinceNames);this.__base.FEaiResourceModule.dispose.call(this)};
MO.FEaiRateResource=function(a){a=MO.Class.inherits(this,a,MO.FObject);a._count=MO.Class.register(a,new MO.AGetter("_count"));a._colors=MO.Class.register(a,new MO.AGetter("_colors"));a.construct=MO.FEaiRateResource_construct;a.find=MO.FEaiRateResource_find;a.findRate=MO.FEaiRateResource_findRate;a.unserialize=MO.FEaiRateResource_unserialize;a.dispose=MO.FEaiRateResource_dispose;return a};MO.FEaiRateResource_construct=function(){this.__base.FObject.construct.call(this)};
MO.FEaiRateResource_find=function(a){a=parseInt(a);0>a&&(a=0);a>=this._count&&(a=this._count-1);return this._colors[a]};MO.FEaiRateResource_findRate=function(a){return this.find(a*this._count)};MO.FEaiRateResource_unserialize=function(a){for(var b=this._count=a.readInt32(),c=this._colors=new Uint32Array(b),e=0;e<b;e++)c[e]=a.readUint32()};MO.FEaiRateResource_dispose=function(){this._colors=null;this.__base.FObject.dispose.call(this)};
MO.FEaiRateResourceModule=function(a){a=MO.Class.inherits(this,a,MO.FEaiResourceModule);a._rates=MO.Class.register(a,new MO.AGetter("_rates"));a.construct=MO.FEaiRateResourceModule_construct;a.find=MO.FEaiRateResourceModule_find;a.unserialize=MO.FEaiRateResourceModule_unserialize;a.dispose=MO.FEaiRateResourceModule_dispose;return a};MO.FEaiRateResourceModule_construct=function(){this.__base.FEaiResourceModule.construct.call(this);this._rates=new MO.TObjects};MO.FEaiRateResourceModule_find=function(a){return this._rates.get(a)};
MO.FEaiRateResourceModule_unserialize=function(a){for(var b=this._count=a.readInt32(),c=0;c<b;c++){var e=MO.Class.create(MO.FEaiRateResource);e.unserialize(a);this._rates.push(e)}};MO.FEaiRateResourceModule_dispose=function(){this._rates=MO.Lang.Object.dispose(this._rates);this.__base.FEaiResourceModule.dispose.call(this)};
MO.FEaiResource=function(a){a=MO.Class.inherits(this,a,MO.FObject);a._code=MO.Class.register(a,new MO.AGetter("_code"));a.unserialize=MO.FEaiResource_unserialize;a.processLoad=MO.FEaiResource_processLoad;return a};MO.FEaiResource_unserialize=function(a){this._code=a.readUint16()};MO.FEaiResource_processLoad=function(){this._code=input.readUint16();this._cityCode=input.readUint16()};
MO.FEaiResourceConsole=function(a){a=MO.Class.inherits(this,a,MO.FConsole,MO.MListener);a._scopeCd=MO.EScope.Local;a._rateModule=MO.Class.register(a,new MO.AGetter("_rateModule"));a._provinceModule=MO.Class.register(a,new MO.AGetter("_provinceModule"));a._cityModule=MO.Class.register(a,new MO.AGetter("_cityModule"));a._cardModule=MO.Class.register(a,new MO.AGetter("_cardModule"));a._departmentModule=MO.Class.register(a,new MO.AGetter("_departmentModule"));a._historyModule=MO.Class.register(a,new MO.AGetter("_historyModule"));
a._mapModule=MO.Class.register(a,new MO.AGetter("_mapModule"));a._loadListeners=MO.Class.register(a,new MO.AListener("_loadListeners",MO.EEvent.Load));a._looper=null;a._thread=null;a._interval=100;a.onLoad=MO.FEaiResourceConsole_onLoad;a.onProcess=MO.FEaiResourceConsole_onProcess;a.construct=MO.FEaiResourceConsole_construct;a.unserialize=MO.FEaiResourceConsole_unserialize;a.load=MO.FEaiResourceConsole_load;a.dispose=MO.FEaiResourceConsole_dispose;return a};
MO.FEaiResourceConsole_onProcess=function(){var a=this._looper;for(a.record();a.next();)a.current().processLoad()&&a.removeCurrent()};MO.FEaiResourceConsole_onLoad=function(a){a=a.content;var b=MO.Class.create(MO.FDataView);b.setEndianCd(!0);b.link(a);this.unserialize(b);b.dispose();a=new MO.SEvent;this.processLoadListener(a);a.dispose()};
MO.FEaiResourceConsole_construct=function(){this.__base.FConsole.construct.call(this);this._looper=new MO.TLooper;this._rateModule=MO.Class.create(MO.FEaiRateResourceModule);this._provinceModule=MO.Class.create(MO.FEaiProvinceResourceModule);var a=this._cityModule=MO.Class.create(MO.FEaiCityResourceModule);this._cardModule=MO.Class.create(MO.FEaiCardResourceModule);this._departmentModule=MO.Class.create(MO.FEaiDepartmentResourceModule);this._historyModule=MO.Class.create(MO.FEaiHistoryResourceModule);
this._mapModule=MO.Class.create(MO.FEaiMapResourceModule);a.setResourceConsole(this);a=this._thread=MO.Class.create(MO.FThread);a.setInterval(this._interval);a.addProcessListener(this,this.onProcess);MO.Console.find(MO.FThreadConsole).start(a)};MO.FEaiResourceConsole_unserialize=function(a){this._rateModule.unserialize(a);this._provinceModule.unserialize(a);this._cityModule.unserialize(a);this._cardModule.unserialize(a);this._departmentModule.unserialize(a)};
MO.FEaiResourceConsole_load=function(a){a=MO.Console.find(MO.FEnvironmentConsole).parse(a);MO.Console.find(MO.FHttpConsole).send(a).addLoadListener(this,this.onLoad)};
MO.FEaiResourceConsole_dispose=function(a){this._rateModule=MO.Lang.Object.dispose(this._rateModule);this._provinceModule=MO.Lang.Object.dispose(this._provinceModule);this._cityModule=MO.Lang.Object.dispose(this._cityModule);this._cardModule=MO.Lang.Object.dispose(this._cardModule);this._historyModule=MO.Lang.Object.dispose(this._historyModule);this._mapModule=MO.Lang.Object.dispose(this._mapModule);this.__base.FConsole.dispose.call(this)};
MO.FEaiResourceModule=function(a){a=MO.Class.inherits(this,a,MO.FObject);a._code=MO.Class.register(a,new MO.AGetSet("_code"));a.construct=MO.FEaiResourceModule_construct;a.dispose=MO.FEaiResourceModule_dispose;return a};MO.FEaiResourceModule_construct=function(){this.__base.FObject.construct.call(this)};MO.FEaiResourceModule_dispose=function(){this.__base.FObject.dispose.call(this)};
MO.FEaiFinancialData=function(a){a=MO.Class.inherits(this,a,MO.FObject);a._provinceCode=MO.Class.register(a,new MO.AGetter("_provinceCode"));a._code=MO.Class.register(a,new MO.AGetter("_code"));a._label=MO.Class.register(a,new MO.AGetter("_label"));a._level=MO.Class.register(a,new MO.AGetter("_level"));a._location=MO.Class.register(a,new MO.AGetter("_location"));a.construct=MO.FEaiFinancialData_construct;a.unserialize=MO.FEaiFinancialData_unserialize;a.dispose=MO.FEaiFinancialData_dispose;return a};
MO.FEaiFinancialData_construct=function(){this.__base.FObject.construct.call(this);this._location=new MO.SPoint3};MO.FEaiFinancialData_unserialize=function(a){this._provinceCode=a.readUint16();this._code=a.readUint16();this._label=a.readString();this._level=a.readUint16();this._location.unserialize2(a)};MO.FEaiFinancialData_dispose=function(){this._location=RObject.dispose(this._location);this.__base.FObject.dispose.call(this)};
MO.FEaiFinancialData=function(a){a=MO.Class.inherits(this,a,MO.FObject);a._provinceCode=MO.Class.register(a,new MO.AGetter("_provinceCode"));a._code=MO.Class.register(a,new MO.AGetter("_code"));a._label=MO.Class.register(a,new MO.AGetter("_label"));a._level=MO.Class.register(a,new MO.AGetter("_level"));a._location=MO.Class.register(a,new MO.AGetter("_location"));a.construct=MO.FEaiFinancialData_construct;a.unserialize=MO.FEaiFinancialData_unserialize;a.dispose=MO.FEaiFinancialData_dispose;return a};
MO.FEaiFinancialData_construct=function(){this.__base.FObject.construct.call(this);this._location=new MO.SPoint3};MO.FEaiFinancialData_unserialize=function(a){this._provinceCode=a.readUint16();this._code=a.readUint16();this._label=a.readString();this._level=a.readUint16();this._location.unserialize2(a)};MO.FEaiFinancialData_dispose=function(){this._location=RObject.dispose(this._location);this.__base.FObject.dispose.call(this)};
MO.FEaiFinancialMarketerDynamic=function(a){a=MO.Class.inherits(this,a,MO.FObject);a._provinceCode=MO.Class.register(a,new MO.AGetter("_provinceCode"));a._code=MO.Class.register(a,new MO.AGetter("_code"));a._label=MO.Class.register(a,new MO.AGetter("_label"));a._level=MO.Class.register(a,new MO.AGetter("_level"));a._location=MO.Class.register(a,new MO.AGetter("_location"));a.construct=MO.FEaiFinancialMarketerDynamic_construct;a.unserialize=MO.FEaiFinancialMarketerDynamic_unserialize;a.dispose=MO.FEaiFinancialMarketerDynamic_dispose;
return a};MO.FEaiFinancialMarketerDynamic_construct=function(){this.__base.FObject.construct.call(this);this._location=new MO.SPoint3};MO.FEaiFinancialMarketerDynamic_unserialize=function(a){this._provinceCode=a.readUint16();this._code=a.readUint16();this._label=a.readString();this._level=a.readUint16();this._location.unserialize2(a)};MO.FEaiFinancialMarketerDynamic_dispose=function(){this._location=RObject.dispose(this._location);this.__base.FObject.dispose.call(this)};
MO.FEaiLogic=function(a){a=MO.Class.inherits(this,a,MO.FObject);a._code=null;a._parameters=null;a._urlParameters=null;a.construct=MO.FEaiLogic_construct;a.makeUrl=MO.FEaiLogic_makeUrl;a.prepareParemeters=MO.FEaiLogic_prepareParemeters;a.send=MO.FEaiLogic_send;a.sendService=MO.FEaiLogic_sendService;a.dispose=MO.FEaiLogic_dispose;return a};MO.FEaiLogic_construct=function(){this.__base.FObject.construct.call(this);this._parameters=new MO.TAttributes;this._urlParameters=new MO.TAttributes};
MO.FEaiLogic_prepareParemeters=function(){var a=this._parameters;a.clear();return a};MO.FEaiLogic_makeUrl=function(a,b){var c="{eai.host.service}/eai/"+this._code+"/"+a,c=MO.Console.find(MO.FEnvironmentConsole).parse(c);if(b){var e=MO.Console.find(MO.FEaiLogicConsole).system(),d=e.sign(),f=e.currentDate(),e=f.format(),g=this._urlParameters;g.clear();g.set("tick",f.format());g.split(b,"=","&");g.sortByName();f=g.joinValue();d=hex_md5(f+d);c+="?"+b+"&tick="+e+"&sign="+d}return c};
MO.FEaiLogic_send=function(a,b,c,e){a=this.makeUrl(a,b);a=MO.Console.find(MO.FJsonConsole).sendAsync(a);a.addLoadListener(c,e);return a};
MO.FEaiLogic_sendService=function(a,b,c,e){a=MO.Console.find(MO.FEnvironmentConsole).parse(a);for(var d=b.count(),f=0;f<d;f++){var g=b.name(f),h=b.value(f);a+="&"+g+"="+h}f=MO.Console.find(MO.FEaiLogicConsole).system();d=f.token();f=f.currentDate().daySecond();b.set("tick",f);a+="&tick="+f;b.sortByName();b=b.joinValue();b=MO.Lang.String.calculateHash(b,d);a+="&sign="+b;d=MO.Desktop.application().findSessionId();MO.Lang.String.isEmpty(d)||(a+="&sid="+d);d=MO.Console.find(MO.FHttpConsole).alloc();d.setAsynchronous(!0);
d.attributes().set("sign",b);d.addLoadListener(c,e);d.send(a)};MO.FEaiLogic_dispose=function(){this._urlParameters=MO.Lang.Object.dispose(this._urlParameters);this.__base.FObject.dispose.call(this)};MO.FEaiLogicAchievement=function(a){a=MO.Class.inherits(this,a,MO.FEaiLogic);a._code="achievement";a.doGroup=MO.FEaiLogicAchievement_doGroup;a.doSort=MO.FEaiLogicAchievement_doSort;a.doQuery=MO.FEaiLogicAchievement_doQuery;return a};
MO.FEaiLogicAchievement_doGroup=function(a,b){return this.send("group",null,a,b)};MO.FEaiLogicAchievement_doSort=function(a,b){return this.send("sort",null,a,b)};MO.FEaiLogicAchievement_doQuery=function(a,b){return this.send("query",null,a,b)};
MO.FEaiLogicConsole=function(a){a=MO.Class.inherits(this,a,MO.FConsole);a._system=MO.Class.register(a,new MO.AGetter("_system"));a._organization=MO.Class.register(a,new MO.AGetter("_organization"));a._achievement=MO.Class.register(a,new MO.AGetter("_achievement"));a._schedule=MO.Class.register(a,new MO.AGetter("_schedule"));a._statistics=MO.Class.register(a,new MO.AGetter("_statistics"));a._thread=null;a._interval=6E5;a.onProcess=MO.FEaiLogicConsole_onProcess;a.construct=MO.FEaiLogicConsole_construct;
a.dispose=MO.FEaiLogicConsole_dispose;return a};MO.FEaiLogicConsole_onProcess=function(a){this._system.refresh()};
MO.FEaiLogicConsole_construct=function(){this.__base.FConsole.construct.call(this);this._system=MO.Class.create(MO.FEaiLogicSystem);this._organization=MO.Class.create(MO.FEaiLogicOrganization);this._achievement=MO.Class.create(MO.FEaiLogicAchievement);this._schedule=MO.Class.create(MO.FEaiLogicSchedule);this._statistics=MO.Class.create(MO.FEaiLogicStatistics);var a=this._thread=MO.Class.create(MO.FThread);a.setInterval(this._interval);a.addProcessListener(this,this.onProcess);MO.Console.find(MO.FThreadConsole).start(a)};
MO.FEaiLogicConsole_dispose=function(){this._system=MO.Lang.Object.dispose(this._system);this._organization=MO.Lang.Object.dispose(this._organization);this._achievement=MO.Lang.Object.dispose(this._achievement);this._schedule=MO.Lang.Object.dispose(this._schedule);this._statistics=MO.Lang.Object.dispose(this._statistics);this.__base.FConsole.dispose.call(this)};
MO.FEaiLogicOrganization=function(a){a=MO.Class.inherits(this,a,MO.FEaiLogic);a._code="organization";a._pIdMIndexDict=MO.Class.register(a,new MO.AGetter("_pIdMIndexDict"));a._cityIdNameDict=MO.Class.register(a,new MO.AGetter("_cityIdNameDict"));a._provinceColors=MO.Class.register(a,new MO.AGetter("_provinceColors"));a.doFetch=MO.FEaiLogicOrganization_doFetch;a.getMeshIndex=MO.FEaiLogicOrganization_getMeshIndex;a.construct=MO.FEaiLogicOrganization_construct;return a};
MO.FEaiLogicOrganization_construct=function(){this.__base.FEaiLogic.construct.call(this);var a=this._pIdMIndexDict=new MO.TDictionary;a.set(11,6);a.set(12,7);a.set(13,5);a.set(14,8);a.set(15,2);a.set(21,4);a.set(22,3);a.set(23,1);a.set(31,-1);a.set(32,21);a.set(33,22);a.set(34,20);a.set(35,30);a.set(36,23);a.set(37,9);a.set(41,10);a.set(42,19);a.set(43,29);a.set(44,24);a.set(45,25);a.set(46,0);a.set(50,18);a.set(51,17);a.set(52,26);a.set(53,27);a.set(54,16);a.set(61,12);a.set(62,13);a.set(63,15);
a.set(64,11);a.set(65,14);a.set(71,28);a.set(81,-1);a.set(82,-1);this._cityIdNameDict=new MO.TDictionary;a=this._provinceColors=new MO.TObjects;a.push(new MO.SColor4(.25,.5,.6));a.push(new MO.SColor4(.3,.6,.75));a.push(new MO.SColor4(.35,.7,.8));a.push(new MO.SColor4(.4,.75,.85));a.push(new MO.SColor4(.45,.85,1))};MO.FEaiLogicOrganization_doFetch=function(a,b){return this.send("fetch",null,a,b)};MO.FEaiLogicOrganization_getMeshIndex=function(a){return this.pIdMIndexDict().value(a)};
MO.FEaiLogicOrganization_getMeshIndex=function(a){return this.cityIdNameDict().value(a)};MO.FEaiLogicSchedule=function(a){a=MO.Class.inherits(this,a,MO.FEaiLogic);a._code="schedule";a.doFetch=MO.FEaiLogicSchedule_doFetch;return a};MO.FEaiLogicSchedule_doFetch=function(a,b){return this.send("fetch",null,a,b)};
MO.FEaiLogicStatistics=function(a){a=MO.Class.inherits(this,a,MO.FEaiLogic);a._code="statistics";a.calculateAmountLevel=MO.FEaiLogicStatistics_calculateAmountLevel;a.doInvestmentDynamic=MO.FEaiLogicStatistics_doInvestmentDynamic;a.doInvestmentTrend=MO.FEaiLogicStatistics_doInvestmentTrend;a.doCustomerDynamic=MO.FEaiLogicStatistics_doCustomerDynamic;a.doCustomerTrend=MO.FEaiLogicStatistics_doCustomerTrend;a.doMarketerDynamic=MO.FEaiLogicStatistics_doMarketerDynamic;a.doMarketerTrend=MO.FEaiLogicStatistics_doMarketerTrend;
a.doDepartmentDynamic=MO.FEaiLogicStatistics_doDepartmentDynamic;a.doDepartmentTrend=MO.FEaiLogicStatistics_doDepartmentTrend;return a};MO.FEaiLogicStatistics_calculateAmountLevel=function(a){return 5E6<=a?5:1E6<=a?4:1E5<=a?3:1E4<=a?2:1E3<=a?1:0};MO.FEaiLogicStatistics_doInvestmentDynamic=function(a,b,c,e){return this.send("investment_dynamic","begin="+c+"&end="+e,a,b)};
MO.FEaiLogicStatistics_doInvestmentTrend=function(a,b,c,e,d){d||(d=6E5);return this.send("investment_trend","begin="+c+"&end="+e+"&interval="+d,a,b)};MO.FEaiLogicStatistics_doCustomerDynamic=function(a,b,c,e){var d=this.prepareParemeters();d.set("begin",c);d.set("end",e);this.sendService("{eai.logic.service}/eai.financial.customer.wv?do=dynamic",d,a,b)};
MO.FEaiLogicStatistics_doCustomerTrend=function(a,b,c,e){var d=this.prepareParemeters();d.set("begin",c);d.set("end",e);this.sendService("{eai.logic.service}/eai.financial.customer.wv?do=trend",d,a,b)};MO.FEaiLogicStatistics_doMarketerDynamic=function(a,b,c,e){var d=this.prepareParemeters();d.set("begin",c);d.set("end",e);this.sendService("{eai.logic.service}/eai.financial.marketer.wv?do=dynamic",d,a,b)};
MO.FEaiLogicStatistics_doMarketerTrend=function(a,b,c,e){var d=this.prepareParemeters();d.set("begin",c);d.set("end",e);this.sendService("{eai.logic.service}/eai.financial.marketer.wv?do=trend",d,a,b)};MO.FEaiLogicStatistics_doDepartmentDynamic=function(a,b,c,e){var d=this.prepareParemeters();d.set("begin",c);d.set("end",e);this.sendService("{eai.logic.service}/eai.financial.marketer.wv?do=dynamic",d,a,b)};
MO.FEaiLogicStatistics_doDepartmentTrend=function(a,b,c,e){var d=this.prepareParemeters();d.set("begin",c);d.set("end",e);this.sendService("{eai.logic.service}/eai.financial.marketer.wv?do=trend",d,a,b)};
MO.FEaiLogicSystem=function(a){a=MO.Class.inherits(this,a,MO.FEaiLogic);a._code="system";a._ready=!1;a._info=null;a._token=MO.Class.register(a,new MO.AGetter("_token"),0);a._currentDate=null;a._localDate=null;a._systemDate=MO.Class.register(a,new MO.AGetter("_systemDate"));a.onInfo=MO.FEaiLogicSystem_onInfo;a.construct=MO.FEaiLogicSystem_construct;a.doInfo=MO.FEaiLogicSystem_doInfo;a.doDeviceAccess=MO.FEailogicSystem_doDeviceAccess;a.testReady=MO.FEaiLogicSystem_testReady;a.currentDate=MO.FEaiLogicSystem_currentDate;
a.refresh=MO.FEaiLogicSystem_refresh;a.dispose=MO.FEaiLogicSystem_dispose;return a};MO.FEaiLogicSystem_onInfo=function(a){var b=this._info;b.unserializeSignBuffer(a.sign,a.content,!0);this._token=b.token();this._localDate.setNow();this._systemDate.parse(b.date());this._ready=!0};MO.FEaiLogicSystem_construct=function(){this.__base.FEaiLogic.construct.call(this);this._info=MO.Class.create(MO.FEaiLogicSystemInfo);this._currentDate=new MO.TDate;this._localDate=new MO.TDate;this._systemDate=new MO.TDate};
MO.FEaiLogicSystem_doInfo=function(a,b){var c=this.prepareParemeters();this.sendService("{eai.logic.service}/eai.system.wv?do=info",c,a,b)};
MO.FEailogicSystem_doDeviceAccess=function(){var a=new MO.TXmlNode("Configuration"),b=MO.Window.Browser.agent(),c=a.create("Browser");MO.Window.Browser.saveConfig(c);var e=MO.Desktop.application().desktop();if(e&&(c=c.create("Desktop"),e.canvas2d()&&c.create("Context2d"),e=e.canvas3d())){var e=e.graphicContext(),d=e.parameter("VERSION");d&&(b+="|"+d);(d=e.parameter("SHADING_LANGUAGE_VERSION"))&&(b+="|"+d);(d=e.parameter("UNMASKED_RENDERER_WEBGL"))&&(b+="|"+d);c=c.create("Context3d");e.saveConfig(c)}a.set("identity_code",
b);MO.Console.find(MO.FServiceConsole).send("cloud.info.device","access",a)};MO.FEaiLogicSystem_testReady=function(){return this._ready};MO.FEaiLogicSystem_currentDate=function(){var a=this._currentDate,b=this._systemDate.get()-this._localDate.get();a.set(MO.Timer.current()+b);return a};MO.FEaiLogicSystem_refresh=function(){return this.doInfo(this,this.onInfo)};
MO.FEaiLogicSystem_dispose=function(){this._info=MO.Lang.Object.dispose(this._info);this._localDate=MO.Lang.Object.dispose(this._localDate);this._systemDate=MO.Lang.Object.dispose(this._systemDate);this.__base.FEaiLogic.consturct.call(this)};
MO.FEaiLogicSystemInfo=function(a){a=MO.Class.inherits(this,a,MO.FObject,MO.MPersistence);a._sessionId=MO.Class.register(a,[new MO.AGetter("_sessionId"),new MO.APersistence("_sessionId",MO.EDataType.String)]);a._date=MO.Class.register(a,[new MO.AGetter("_date"),new MO.APersistence("_date",MO.EDataType.String)]);a._token=MO.Class.register(a,[new MO.AGetter("_token"),new MO.APersistence("_token",MO.EDataType.Uint32)]);return a};
MO.FEaiCityEntity=function(a){a=MO.Class.inherits(this,a,MO.FEaiEntity);a._provinceEntity=MO.Class.register(a,new MO.AGetSet("_provinceEntity"));a._visible=MO.Class.register(a,new MO.AGetter("_visible"),!1);a._location=MO.Class.register(a,new MO.AGetter("_location"));a._size=MO.Class.register(a,new MO.AGetter("_size"));a._color=MO.Class.register(a,new MO.AGetter("_color"));a._range=MO.Class.register(a,new MO.AGetter("_range"),1);a._rangeColor=MO.Class.register(a,new MO.AGetter("_rangeColor"));a._cityTotal=
0;a._investmentCount=0;a._investmentTotal=MO.Class.register(a,new MO.AGetSet("_investmentTotal"),0);a._investmentLevel=0;a._investmentLast=0;a._investmentRateTotal=0;a._investmentRate=0;a._investmentAlpha=0;a._investmentRange=0;a._investmentDirection=1;a._stage=MO.Class.register(a,new MO.AGetSet("_stage"));a._renderable=MO.Class.register(a,new MO.AGetSet("_renderable"));a._data=MO.Class.register(a,new MO.AGetSet("_data"));a._inputPoint=null;a._outputPoint=null;a.construct=MO.FEaiCityEntity_construct;
a.calculateScreenPosition=MO.FEaiCityEntity_calculateScreenPosition;a.build=MO.FEaiCityEntity_build;a.addInvestmentTotal=MO.FEaiCityEntity_addInvestmentTotal;a.reset=MO.FEaiCityEntity_reset;a.update=MO.FEaiCityEntity_update;a.process=MO.FEaiCityEntity_process;a.dispose=MO.FEaiCityEntity_dispose;return a};
MO.FEaiCityEntity_construct=function(){this.__base.FEaiEntity.construct.call(this);this._location=new MO.SPoint2;this._size=new MO.SSize2;this._color=new MO.SColor4(0,0,0,0);this._rangeColor=new MO.SColor4(0,0,0,0);this._inputPoint=new MO.SPoint3;this._outputPoint=new MO.SPoint3};
MO.FEaiCityEntity_calculateScreenPosition=function(){var a=this._stage.region().calculate(MO.EG3dRegionParameter.CameraViewProjectionMatrix),b=this._renderable.matrix(),c=MO.Lang.Math.matrix;c.identity();c.append(b);c.append(a);this._inputPoint.set(this._location.x,this._location.y,0);c.transformPoint3(this._inputPoint,this._outputPoint);return this._outputPoint};MO.FEaiCityEntity_build=function(a){this._location.assign(this._data.location());this._size.set(2,2)};
MO.FEaiCityEntity_addInvestmentTotal=function(a,b){this._investmentCount++;this._investmentTotal+=b;if(!(b<this._investmentLast)){var c=MO.Console.find(MO.FEaiResourceConsole).rateModule().find(MO.EEaiRate.InvestmentRange).findRate(b/2E5);this._color.set(1,1,1,1);this._rangeColor.setInteger(c);this._rangeColor.alpha=1;this._investmentLast=b;this._investmentRate=this._investmentRateTotal=1E5*(a+1);this._investmentRange=Math.log(b*b)/10;this._investmentAlpha=8;this._visible=!0}};
MO.FEaiCityEntity_reset=function(){this._visible=!1;this._cityTotal=0;this._color.set(0,0,0,0);this._rangeColor.set(0,0,0,0)};
MO.FEaiCityEntity_update=function(a){var b=1;this._color.set(1,1,1,1);this._rangeColor.set(1,1,1,1);a&&(this._cityTotal=a.investmentTotal());a=this._cityTotal;0<a&&(this._visible=!0);var c=MO.Console.find(MO.FEaiResourceConsole).historyModule().investmentCityTotal(),b=MO.Console.find(MO.FEaiResourceConsole).rateModule().find(MO.EEaiRate.Map);a=4*Math.sqrt(a/c);c=b.findRate(a);b=6*a;a=MO.Lang.Float.toRange(a,0,1);this._rangeColor.setIntAlpha(c,.6*a);this._range=MO.Lang.Float.toRange(Math.sqrt(b),1,
6)};MO.FEaiCityEntity_process=function(a){if(0<this._investmentRate)return a=this._investmentRate/this._investmentRateTotal,this._range=this._investmentRange*a,a=Math.min(this._investmentAlpha*a,1),this._color.alpha=a,this._rangeColor.alpha=a,this._investmentRate--,!0;this._investmentAlpha=this._investmentRange=this._investmentRate=this._investmentLast=0;return this._visible=!1};
MO.FEaiCityEntity_dispose=function(){this._location=MO.Lang.Object.dispose(this._location);this._size=MO.Lang.Object.dispose(this._size);this._color=MO.Lang.Object.dispose(this._color);this._rangeColor=MO.Lang.Object.dispose(this._rangeColor);this._inputPoint=MO.Lang.Object.dispose(this._inputPoint);this._outputPoint=MO.Lang.Object.dispose(this._outputPoint);this.__base.FEaiEntity.dispose.call(this)};
MO.FEaiCityEntityModule=function(a){a=MO.Class.inherits(this,a,MO.FEaiEntityModule);a._citys=MO.Class.register(a,new MO.AGetter("_citys"));a.construct=MO.FEaiCityEntityModule_construct;a.findByCode=MO.FEaiCityEntityModule_findByCode;a.findByCard=MO.FEaiCityEntityModule_findByCard;a.push=MO.FEaiCityEntityModule_push;a.build=MO.FEaiCityEntityModule_build;a.linkProvinces=MO.FEaiCityEntityModule_linkProvinces;a.dispose=MO.FEaiCityEntityModule_dispose;return a};
MO.FEaiCityEntityModule_construct=function(){this.__base.FEaiEntityModule.construct.call(this);this._citys=new MO.TDictionary};MO.FEaiCityEntityModule_findByCode=function(a){return this._citys.get(a)};MO.FEaiCityEntityModule_findByCard=function(a){a=MO.Console.find(MO.FEaiResourceConsole).cardModule().findCityCode(a);return this._citys.get(a)};MO.FEaiCityEntityModule_push=function(a){var b=a.data().code();this._citys.set(b,a)};
MO.FEaiCityEntityModule_build=function(a){a=MO.Console.find(MO.FEaiResourceConsole).cityModule().citys();for(var b=this._citys,c=a.count(),e=0;e<c;e++){var d=a.at(e),f=d.code();d.level();d.location();var g=MO.Class.create(MO.FEaiCityEntity);g.setData(d);g.build(this);b.set(f,g)}};MO.FEaiCityEntityModule_linkProvinces=function(){for(var a=MO.Console.find(MO.FEaiEntityConsole).provinceModule(),b=this._citys,c=b.count(),e=0;e<c;e++){var d=b.at(e),f=d.data().provinceCode(),f=a.findByCode(f);d.setProvinceEntity(f)}};
MO.FEaiCityEntityModule_dispose=function(a){this._citys=MO.Lang.Object.dispose(this._citys);this.__base.FEaiEntityModule.dispose.call(this)};
MO.FEaiCountryEntity=function(a){a=MO.Class.inherits(this,a,MO.FEaiEntity);a._enterSELoaded=!1;a._enterSEPlaying=!1;a._cameraDirection=MO.Class.register(a,new MO.AGetSet("_cameraDirection"));a._startDelay=MO.Class.register(a,new MO.AGetSet("_startDelay"),0);a._riseDuration=MO.Class.register(a,new MO.AGetSet("_riseDuration"),5E3);a._riseDistance=MO.Class.register(a,new MO.AGetSet("_riseDistance"),600);a._fallDuration=MO.Class.register(a,new MO.AGetSet("_fallDuration"),200);a._fallDistance=MO.Class.register(a,
new MO.AGetSet("_fallDistance"),3);a._blockInterval=MO.Class.register(a,new MO.AGetSet("_blockInterval"),200);a._mouseOverRiseHeight=MO.Class.register(a,new MO.AGetSet("_mouseOverRiseHeight"),3);a._mouseMoveCheckInterval=MO.Class.register(a,new MO.AGetSet("_mouseMoveCheckInterval"),100);a._cameraMoveDuration=MO.Class.register(a,new MO.AGetSet("_cameraMoveDuration"),500);a._data=MO.Class.register(a,new MO.AGetter("_data"));a._worldEntity=MO.Class.register(a,new MO.AGetSet("_worldEntity"));a._provinceEntities=
MO.Class.register(a,new MO.AGetter("_provinceEntities"));a._cityEntities=MO.Class.register(a,new MO.AGetter("_cityEntities"));a._boundaryShape=MO.Class.register(a,new MO.AGetter("_boundaryShape"));a._faceShape=MO.Class.register(a,new MO.AGetter("_faceShape"));a._borderShape=MO.Class.register(a,new MO.AGetter("_borderShape"));a._provinceArray=null;a._playing=!1;a._lastTick=0;a._interval=10;a._template=MO.Class.register(a,new MO.AGetSet("_template"));a._introAnimeDone=MO.Class.register(a,new MO.AGetSet("_introAnimeDone"),
!1);a._startTime=MO.Class.register(a,new MO.AGetSet("_startTime"));a._mouseOverRiseRenderable=MO.Class.register(a,new MO.AGetSet("_mouseOverRiseRenderable"));a._mouseOverFallArray=MO.Class.register(a,new MO.AGetSet("_mouseOverFallArray"));a._mouseMoveLastCheck=MO.Class.register(a,new MO.AGetSet("_mouseMoveLastCheck"));a._cameraMoving=MO.Class.register(a,new MO.AGetSet("_cameraMoving"),!1);a._cameraFrom=MO.Class.register(a,new MO.AGetSet("_cameraFrom"));a._cameraTo=MO.Class.register(a,new MO.AGetSet("_cameraTo"));
a._audioContext=null;a._audioMapEnter=null;a.onOrganizationFetch=MO.FEaiCountryEntity_onOrganizationFetch;a.onMouseMove=MO.FEaiCountryEntity_onMouseMove;a.onMouseDown=MO.FEaiCountryEntity_onMouseDown;a.construct=MO.FEaiCountryEntity_construct;a.setup=MO.FEaiCountryEntity_setup;a.build=MO.FEaiCountryEntity_build;a.provinceShowOrderSort=MO.FEaiCountryEntity_provinceShowOrderSort;a.setupProvinces=MO.FEaiCountryEntity_setupProvinces;a.loadData=MO.FEaiCountryEntity_loadData;a.loadResource=MO.FEaiCountryEntity_loadResource;
a.start=MO.FEaiCountryEntity_start;a.process=MO.FEaiCountryEntity_process;a.processLoad=MO.FEaiCountryEntity_processLoad;a.introAnime=MO.FEaiCountryEntity_introAnime;a.mouseOverFallAnime=MO.FEaiCountryEntity_mouseOverFallAnime;a.cameraMoveAnime=MO.FEaiCountryEntity_cameraMoveAnime;a.isReady=MO.FEaiCountryEntity_isReady;a.dispose=MO.FEaiCountryEntity_dispose;return a};
MO.FEaiCountryEntity_construct=function(){this.__base.FEaiEntity.construct.call(this);this._provinceEntities=new MO.TDictionary;this._cityEntities=new MO.TDictionary};MO.FEaiCountryEntity_setup=function(){(this._boundaryShape=MO.Class.create(MO.EE3dBoundaryShape)).linkGraphicContext(this)};
MO.FEaiCountryEntity_build=function(){var a=this._faceShape=MO.Class.create(MO.FE3dDynamicShape);a.linkGraphicContext(this);a=this._borderShape=MO.Class.create(MO.FE3dDynamicShape);a.linkGraphicContext(this);this._audioMapEnter=(this._audioContext=MO.Console.find(MO.FAudioContextConsole).create()).createBuffer("{eai.resource}/map_entry/enter.mp3")};
MO.FEaiCountryEntity_setupProvinces=function(){for(var a=this._provinceEntities,b=0;b<a.count();b++){var c=a.at(b),e=c.faceRenderable(),c=c.borderRenderable(),e=e.matrix(),c=c.matrix();e.tz=this.riseDistance();e.updateForce();c.tz=this.riseDistance();c.updateForce()}e=this._provinceArray=Array(a.count());for(b=0;b<a.count();b++)e[b]=a.at(b);e.sort(this.provinceShowOrderSort)};
MO.FEaiCountryEntity_loadData=function(a){this._data=a;this._code=a.code();var b=this._boundaryShape;a=a.boundaries();for(var c=a.count(),e=0;e<c;e++){var d=a.at(e);b.pushPolygon(d)}b.build()};
MO.FEaiCountryEntity_loadResource=function(a){var b=a.data();a=this._provinceEntities;var c=this._faceShape,e=this._borderShape;this.loadData(b);for(var d=MO.Console.find(MO.FEaiResourceConsole).provinceModule(),f=MO.Console.find(MO.FEaiEntityConsole).provinceModule(),b=b.provinces(),g=b.count(),h=0;h<g;h++){provinceData=b.at(h);var m=provinceData.code(),k=d.findByCode(m),l=MO.Class.create(MO.FEaiProvinceEntity);l.setResource(k);l.setData(provinceData);l.build(this);a.set(m,l);f.push(l);m=l.faceRenderable();
c.pushMergeRenderable(m);l=l.borderRenderable();e.pushMergeRenderable(l)}c.build();e.build();this.setupProvinces(a);MO.Console.find(MO.FEaiEntityConsole).cityModule().linkProvinces()};MO.FEaiCountryEntity_isReady=function(){return this._audioMapEnter.testFinish()?(this._startTime=MO.Timer.current(),!0):!1};
MO.FEaiCountryEntity_provinceShowOrderSort=function(a,b){var c=MO.Console.find(MO.FEaiResourceConsole).provinceModule(),e=c.findByCode(a.data().code()),c=c.findByCode(b.data().code());return e.displayOrder()>c.displayOrder()?1:-1};MO.FEaiCountryEntity_start=function(){this._startTime=MO.Timer.current()};MO.FEaiCountryEntity_process=function(){this._provinceEntities&&this.introAnime()};
MO.FEaiCountryEntity_processLoad=function(){var a=this._resource;return a.testReady()?(this.loadResource(a),this._statusReady=!0):!1};
MO.FEaiCountryEntity_introAnime=function(){var a=MO.Timer.current()-this._startTime;if(!(a<this.startDelay())){a-=this.startDelay();if(a>this.riseDuration()+this.fallDuration()+this.blockInterval()*this._provinceEntities.count()){this.setIntroAnimeDone(!0);var b=new MO.TListener;b._owner=this;b._callback=this.onMouseMove;MO.Window.lsnsMouseMove.push(b);b=new MO.TListener;b._owner=this;b._callback=this.onMouseDown;MO.Window.lsnsMouseDown.push(b)}this._enterSEPlaying||(this._audioMapEnter.play(0),this._enterSEPlaying=
!0);for(var b=a/this.blockInterval(),c=0;c<this._provinceArray.length&&c<b;c++){var e=this._provinceArray[c].faceRenderable(),d=this._provinceArray[c].borderRenderable(),e=e.matrix(),d=d.matrix(),f=(a-this.blockInterval()*c)/(this.riseDuration()-c*c),g=0;1<f&&(f=1,g=(a-this.blockInterval()*c-(this.riseDuration()-c*c))/this.fallDuration(),1<g&&(g=1));e.tz=this.riseDistance()*(1-f)-this.fallDistance()*(1-g);e.updateForce();d.tz=this.riseDistance()*(1-f)-this.fallDistance()*(1-g);d.updateForce()}b>this._provinceArray.length-
1||parseInt(b)}};MO.FEaiCountryEntity_onMouseMove=function(a){};MO.FEaiCountryEntity_mouseOverFallAnime=function(){};MO.FEaiCountryEntity_onOrganizationFetch=function(a){};MO.FEaiCountryEntity_onMouseDown=function(a){};MO.FEaiCountryEntity_cameraMoveAnime=function(){};MO.FEaiCountryEntity_dispose=function(){this._provinceEntities=MO.Lang.Object.dispose(this._provinceEntities);this._cityEntities=MO.Lang.Object.dispose(this._cityEntities);this.__base.FEaiEntity.dispose.call(this)};
MO.FEaiCountryEntityModule=function(a){a=MO.Class.inherits(this,a,MO.FEaiEntityModule);a._countries=MO.Class.register(a,new MO.AGetter("_countries"));a.construct=MO.FEaiCountryEntityModule_construct;a.findByCode=MO.FEaiCountryEntityModule_findByCode;a.push=MO.FEaiCountryEntityModule_push;a.load=MO.FEaiCountryEntityModule_load;a.dispose=MO.FEaiCountryEntityModule_dispose;return a};MO.FEaiCountryEntityModule_construct=function(){this.__base.FEaiEntityModule.construct.call(this);this._countries=new MO.TDictionary};
MO.FEaiCountryEntityModule_findByCode=function(a){return this._countries.get(a)};MO.FEaiCountryEntityModule_push=function(a){var b=a.code();this._countries.set(b,a)};MO.FEaiCountryEntityModule_load=function(a,b){var c=this._countries,e=c.get(b);if(e)return e;var d=MO.Console.find(MO.FEaiResourceConsole).mapConsole().loadCountry(b),e=MO.Class.create(MO.FEaiCountryEntity);e.linkGraphicContext(a);e.setResource(d);e.setup();MO.Console.find(MO.FEntityConsole).loadEntity(e);c.set(b,e);return e};
MO.FEaiCountryEntityModule_dispose=function(){this._countries=MO.Lang.Object.dispose(this._countries);this.__base.FEaiEntityModule.dispose.call(this)};MO.FEaiEntity=function(a){a=MO.Class.inherits(this,a,MO.FEntity,MO.MGraphicObject,MO.MLinkerResource);a._code=MO.Class.register(a,new MO.AGetter("_code"));return a};
MO.FEaiEntityConsole=function(a){a=MO.Class.inherits(this,a,MO.FConsole,MO.MListener,MO.MGraphicObject);a._scopeCd=MO.EScope.Local;a._cityModule=MO.Class.register(a,new MO.AGetter("_cityModule"));a._provinceModule=MO.Class.register(a,new MO.AGetter("_provinceModule"));a._countryModule=MO.Class.register(a,new MO.AGetter("_countryModule"));a._mapModule=MO.Class.register(a,new MO.AGetter("_mapModule"));a._mapEntity=MO.Class.register(a,new MO.AGetter("_mapEntity"));a._worldData=null;a._worldReady=!1;
a._countryData=null;a._countryReady=!1;a._worldEntity=MO.Class.register(a,new MO.AGetter("_worldEntity"));a._listenersLoadWorld=MO.Class.register(a,new MO.AListener("_listenersLoadWorld","LoadWorld"));a._listenersLoadCountry=MO.Class.register(a,new MO.AListener("_listenersLoadCountry","LoadCountry"));a.onSetup=MO.FEaiEntityConsole_onSetup;a.onLoadCountry=MO.FEaiEntityConsole_onLoadCountry;a.construct=MO.FEaiEntityConsole_construct;a.testWorldReady=MO.FEaiEntityConsole_testWorldReady;a.loadWorldData=
MO.FEaiEntityConsole_loadWorldData;a.testCountryReady=MO.FEaiEntityConsole_testCountryReady;a.loadCountryData=MO.FEaiEntityConsole_loadCountryData;a.dispose=MO.FEaiEntityConsole_dispose;return a};MO.FEaiEntityConsole_onSetup=function(){this.__base.FConsole.onSetup.call(this);var a=this._mapEntity=MO.Class.create(MO.FEaiMapEntity);a.linkGraphicContext(this);a.setup()};
MO.FEaiEntityConsole_onLoadCountry=function(a){var b=a.sender;a=this._mapEntity;var c=a.countryEntity();a.countryDisplay();a.countryBorderDisplay();var e=a.citysRangeRenderable(),d=a.citysRenderable();c.loadProvinceData(b);for(var c=c.provinceEntities(),f=c.count(),b=0;b<f;b++){var g=c.at(b);a.pushProvince(g)}for(var b=MO.Console.find(MO.FEaiEntityConsole).cityConsole(),c=MO.Console.find(MO.FEaiEntityConsole).cityConsole(),f=a.cityEntities(),g=b.citys(),h=g.count(),b=0;b<h;b++){var m=g.at(b);m.level();
m.location();var k=MO.Class.create(MO.FEaiCityEntity);k.setRenderable(d);k.setData(m);k.build(this);f.set(m.code(),k);d.citys().push(k);e.citys().push(k);c.push(k)}d.setup();d.upload();e.setup();e.upload();a.setupCityEntities();this._countryReady=!0;a=new MO.SEvent;this.processLoadCountryListener(a)};
MO.FEaiEntityConsole_construct=function(){this.__base.FConsole.construct.call(this);this._cityModule=MO.Class.create(MO.FEaiCityEntityModule);this._provinceModule=MO.Class.create(MO.FEaiProvinceEntityModule);this._countryModule=MO.Class.create(MO.FEaiCountryEntityModule);this._mapModule=MO.Class.create(MO.FEaiMapEntityModule)};MO.FEaiEntityConsole_testWorldReady=function(){return this._countryReady&&this._mapEntity.countryEntity().isReady()};
MO.FEaiEntityConsole_testCountryReady=function(){return this._countryReady&&this._mapEntity.countryEntity().isReady()};MO.FEaiEntityConsole_loadCountryData=function(){var a=this._countryData;a||(a=this._countryData=MO.Class.create(MO.FEaiCountryData),a.addLoadListener(this,this.onLoadCountry),a.load())};
MO.FEaiEntityConsole_dispose=function(){this._cityModule=MO.Lang.Object.dispose(this._cityModule);this._provinceModule=MO.Lang.Object.dispose(this._provinceModule);this._countryModule=MO.Lang.Object.dispose(this._countryModule);this._mapModule=MO.Lang.Object.dispose(this._mapModule);this._mapEntity=MO.Lang.Object.dispose(this._mapEntity);this.__base.FConsole.dispose.call(this)};
MO.FEaiEntityModule=function(a){a=MO.Class.inherits(this,a,MO.FObject);a.construct=MO.FEaiEntityModule_construct;a.dispose=MO.FEaiEntityModule_dispose;return a};MO.FEaiEntityModule_construct=function(){this.__base.FObject.construct.call(this)};MO.FEaiEntityModule_dispose=function(){this.__base.FObject.dispose.call(this)};
MO.FEaiMapEntity=function(a){a=MO.Class.inherits(this,a,MO.FEaiEntity);a._worldEntity=MO.Class.register(a,new MO.AGetter("_worldEntity"));a._cityCenterRenderable=MO.Class.register(a,new MO.AGetter("_cityCenterRenderable"));a._cityRangeRenderable=MO.Class.register(a,new MO.AGetter("_cityRangeRenderable"));a._countryFaceDisplay=MO.Class.register(a,new MO.AGetter("_countryFaceDisplay"));a._countryBorderDisplay=MO.Class.register(a,new MO.AGetter("_countryBorderDisplay"));a.construct=MO.FEaiMapEntity_construct;
a.setup=MO.FEaiMapEntity_setup;a.upload=MO.FEaiMapEntity_upload;a.showCity=MO.FEaiMapEntity_showCity;a.showCountry=MO.FEaiMapEntity_showCountry;a.showWorld=MO.FEaiMapEntity_showWorld;a.process=MO.FEaiMapEntity_process;a.reset=MO.FEaiMapEntity_reset;a.dispose=MO.FEaiMapEntity_dispose;return a};MO.FEaiMapEntity_construct=function(){this.__base.FEaiEntity.construct.call(this)};
MO.FEaiMapEntity_setup=function(){(this._cityCenterRenderable=MO.Class.create(MO.FEaiCitysRenderable)).linkGraphicContext(this);(this._cityRangeRenderable=MO.Class.create(MO.FEaiCitysRangeRenderable)).linkGraphicContext(this);var a=this._countryFaceDisplay=MO.Class.create(MO.FE3dDisplayContainer);a.linkGraphicContext(this);a=this._countryBorderDisplay=MO.Class.create(MO.FE3dDisplayContainer);a.linkGraphicContext(this)};MO.FEaiMapEntity_upload=function(){this._cityCenterRenderable.upload();this._cityRangeRenderable.upload()};
MO.FEaiMapEntity_process=function(a){var b=!1,b=MO.Console.find(MO.FEaiEntityConsole).provinceModule().provinces();a=b.count();for(var c=0;c<a;c++)b.at(c).process();var b=!1,e=MO.Console.find(MO.FEaiEntityConsole).cityModule().citys();a=e.count();for(c=0;c<a;c++)e.at(c).process()&&(b=!0);b&&this.upload()};
MO.FEaiMapEntity_showCity=function(){for(var a=this._cityCenterRenderable,b=this._cityRangeRenderable,c=MO.Console.find(MO.FEaiEntityConsole).cityModule().citys(),e=c.count(),d=0;d<e;d++){var f=c.at(d);a.citys().push(f);b.citys().push(f)}a.setup();a.upload();b.setup();b.upload()};MO.FEaiMapEntity_showCountry=function(a){this._countryFaceDisplay.push(a.faceShape());this._countryBorderDisplay.push(a.borderShape())};
MO.FEaiMapEntity_showWorld=function(){var a=this._worldEntity=MO.Console.find(MO.FEaiEntityConsole).mapModule().worldEntity();this._countryFaceDisplay.push(a.sphere());this._countryFaceDisplay.push(a._sphere2);this._countryFaceDisplay.push(a._sphere3);this._countryFaceDisplay.push(a.faceShape());this._countryBorderDisplay.push(a.borderShape())};
MO.FEaiMapEntity_reset=function(){for(var a=MO.Console.find(MO.FEaiEntityConsole).provinceModule().provinces(),b=a.count(),c=0;c<b;c++)a.at(c).reset();a=MO.Console.find(MO.FEaiEntityConsole).cityModule().citys();b=a.count();for(c=0;c<b;c++)a.at(c).reset()};
MO.FEaiMapEntity_dispose=function(){this._cityCenterRenderable=MO.Lang.Object.dispose(this._cityCenterRenderable);this._cityRangeRenderable=MO.Lang.Object.dispose(this._cityRangeRenderable);this._countryFaceDisplay=MO.Lang.Object.dispose(this._countryFaceDisplay);this._countryBorderDisplay=MO.Lang.Object.dispose(this._countryBorderDisplay);this.__base.FEaiEntity.dispose.call(this)};
MO.FEaiMapEntityModule=function(a){a=MO.Class.inherits(this,a,MO.FEaiEntityModule);a._worldEntity=MO.Class.register(a,new MO.AGetter("_worldEntity"));a._countryEntities=MO.Class.register(a,new MO.AGetter("_countryEntities"));a._provinceEntities=MO.Class.register(a,new MO.AGetter("_provinceEntities"));a._cityEntities=MO.Class.register(a,new MO.AGetter("_cityEntities"));a.construct=MO.FEaiMapEntityModule_construct;a.loadCountry=MO.FEaiMapEntityModule_loadCountry;a.loadWorld=MO.FEaiMapEntityModule_loadWorld;
a.dispose=MO.FEaiMapEntityModule_dispose;return a};MO.FEaiMapEntityModule_construct=function(){this.__base.FEaiEntityModule.construct.call(this);this._countryEntities=new MO.TDictionary;this._provinceEntities=new MO.TDictionary;this._cityEntities=new MO.TDictionary};
MO.FEaiMapEntityModule_loadCountry=function(a,b){var c=this._countryEntities,e=c.get(b);if(e)return e;var d=MO.Console.find(MO.FEaiResourceConsole).mapModule().loadCountry(b),e=MO.Class.create(MO.FEaiCountryEntity);e.linkGraphicContext(a);e.setResource(d);e.setup();e.build();MO.Console.find(MO.FEntityConsole).loadEntity(e);c.set(b,e);return e};
MO.FEaiMapEntityModule_loadWorld=function(a){var b=this._worldEntity;if(b)return b;var c=MO.Console.find(MO.FEaiResourceConsole).mapModule().loadWorld(),b=this._worldEntity=MO.Class.create(MO.FEaiWorldEntity);b.linkGraphicContext(a);b.setResource(c);b.setup();MO.Console.find(MO.FEntityConsole).loadEntity(b);return b};
MO.FEaiMapEntityModule_dispose=function(){this._countryEntities=MO.Lang.Object.dispose(this._countryEntities);this._provinceEntities=MO.Lang.Object.dispose(this._provinceEntities);this._cityEntities=MO.Lang.Object.dispose(this._cityEntities);this.__base.FEaiEntityModule.dispose.call(this)};
MO.FEaiProvinceEntity=function(a){a=MO.Class.inherits(this,a,MO.FEaiEntity);a._data=MO.Class.register(a,new MO.AGetSet("_data"));a._resource=MO.Class.register(a,new MO.AGetSet("_resource"));a._boundaryShape=MO.Class.register(a,new MO.AGetter("_boundaryShape"));a._faceRenderable=MO.Class.register(a,new MO.AGetter("_faceRenderable"));a._borderRenderable=MO.Class.register(a,new MO.AGetter("_borderRenderable"));a._layerDepth=3;a._currentZ=MO.Class.register(a,new MO.AGetter("_currentZ"),0);a._focusTick=
0;a._focusInterval=10;a._focusCurrent=0;a._focusColor=null;a._focusCount=200;a.construct=MO.FEaiProvinceEntity_construct;a.setup=MO.FEaiProvinceEntity_setup;a.buildFace=MO.FEaiProvinceEntity_buildFace;a.buildBorder=MO.FEaiProvinceEntity_buildBorder;a.build=MO.FEaiProvinceEntity_build;a.doInvestment=MO.FEaiProvinceEntity_doInvestment;a.updateColor=MO.FEaiProvinceEntity_updateColor;a.update=MO.FEaiProvinceEntity_update;a.process=MO.FEaiProvinceEntity_process;a.reset=MO.FEaiProvinceEntity_reset;a.dispose=
MO.FEaiProvinceEntity_dispose;return a};MO.FEaiProvinceEntity_construct=function(){this.__base.FEaiEntity.construct.call(this);var a=this._focusColors=[];a[0]=[40,66,180];a[1]=[40,66,180];a[2]=[27,162,188];a[3]=[255,223,111];a[4]=[255,107,73];a[5]=[255,107,73]};MO.FEaiProvinceEntity_setup=function(){(this._boundaryShape=MO.Class.create(MO.FE3dBoundary)).linkGraphicContext(this)};
MO.FEaiProvinceEntity_buildFace=function(a){for(var b=this._data.boundaries(),c=b.count(),e=this._vertexTotal,d=this._indexTotal,f=0,g=0,h=new Float32Array(6*e),m=0,d=new Uint32Array(d+6*e),k=0;k<c;k++){for(var l=b.at(k),q=l.positionCount(),u=l.positions(),n=0,p=0;p<q;p++)h[g++]=u[n++],h[g++]=u[n++],h[g++]=0;l=l.indexes();u=l.length/3;for(p=0;p<u;p++)n=3*p,d[m++]=f+l[n+2],d[m++]=f+l[n+1],d[m++]=f+l[n];f+=q}for(k=0;k<c;k++)for(l=b.at(k),q=l.positionCount(),u=l.positions(),p=n=0;p<q;p++)h[g++]=u[n++],
h[g++]=u[n++],h[g++]=this._layerDepth;c=0;b=this.colorsData=new Uint8Array(8*e);f=2*e;for(p=0;p<f;p++)b[c++]=255,b[c++]=255,b[c++]=255,b[c++]=255;p=this._faceRenderable=MO.Class.create(MO.FE3dDataBox);p.setVertexCount(2*e);p.linkGraphicContext(a);p.setup();p.color().setHex("#080D19");p.vertexPositionBuffer().upload(h,12,2*e,!0);p.vertexColorBuffer().upload(b,4,2*e,!0);p.indexBuffer().setStrideCd(MO.EG3dIndexStride.Uint32);p.indexBuffer().upload(d,m,!0);p.material().info().effectCode="eai.map.face"};
MO.FEaiProvinceEntity_buildBorder=function(a){for(var b=this._data.boundaries(),c=b.count(),e=this._vertexTotal,d=0,f=0,g=new Float32Array(6*e),h=0,m=new Uint16Array(2*e+2*e),k=0;k<c;k++){for(var l=b.at(k),q=l.positionCount(),u=l.positions(),n=0,l=0;l<q;l++)g[f++]=u[n++],g[f++]=u[n++],g[f++]=0;for(l=0;l<q;l++)m[h++]=d+l,l==q-1?m[h++]=d:m[h++]=d+l+1;d+=q}for(var p=d,k=0;k<c;k++){l=b.at(k);q=l.positionCount();u=l.positions();for(l=n=0;l<q;l++)g[f++]=u[n++],g[f++]=u[n++],g[f++]=this._layerDepth;d+=q}for(k=
d=0;k<c;k++){l=b.at(k);q=l.positionCount();for(l=0;l<q;l++)m[h++]=d+l,m[h++]=d+l+p;d+=q}c=0;b=this.colorsData=new Uint8Array(8*e);for(l=0;l<e;l++)b[c++]=0,b[c++]=181,b[c++]=246,b[c++]=255;for(l=0;l<e;l++)b[c++]=11,b[c++]=17,b[c++]=35,b[c++]=255;l=this._borderRenderable=MO.Class.create(MO.FE3dDataBox);l.linkGraphicContext(a);l.setup();l.setVertexCount(2*e);l.vertexPositionBuffer().upload(g,12,2*e,!0);l.vertexColorBuffer().upload(b,4,2*e,!0);l.indexBuffer().setDrawModeCd(MO.EG3dDrawMode.Lines);l.indexBuffer().setLineWidth(1);
l.indexBuffer().upload(m,h,!0);l.material().info().effectCode="eai.map.face"};MO.FEaiProvinceEntity_build=function(a){for(var b=0,c=0,e=this._data.boundaries(),d=e.count(),f=0;f<d;f++)var g=e.at(f),b=b+g.positionCount(),c=c+g.indexCount();this._vertexTotal=b;this._indexTotal=c;this.buildFace(a);this.buildBorder(a)};MO.FEaiProvinceEntity_doInvestment=function(a,b){this._focusTick=0;this._focusCurrent=this._focusCount;this._focusColor=this._focusColors[a]};
MO.FEaiProvinceEntity_update=function(a){a=a.investmentTotal();Math.sqrt(a)};MO.FEaiProvinceEntity_updateColor=function(a){var b=this._focusColor;a=this._focusCurrent/this._focusCount;var c=8+(b[0]-8)*a,e=13+(b[1]-13)*a;a=25+(b[2]-25)*a;this._faceRenderable.color().set(c/255,e/255,a/255,1)};
MO.FEaiProvinceEntity_process=function(){if(0<this._focusCurrent){var a=MO.Timer.current();if(a-this._focusTick>this._focusInterval){var b=this._currentZ=-this._focusCurrent/60;faceRenderable=this._faceRenderable;matrix=faceRenderable.matrix();matrix.tz=b;matrix.updateForce();borderRenderable=this._borderRenderable;matrix=borderRenderable.matrix();matrix.tz=b;matrix.updateForce();this.updateColor(this._focusCurrent);this._focusCurrent--;this._focusTick=a}}};
MO.FEaiProvinceEntity_reset=function(){this._focusCurrent=this._focusTick=this._currentZ=0};MO.FEaiProvinceEntity_dispose=function(){this.__base.FEaiEntity.dispose.call(this)};
MO.FEaiProvinceEntityModule=function(a){a=MO.RClass.inherits(this,a,MO.FEaiEntityModule);a._provinces=MO.Class.register(a,new MO.AGetter("_provinces"));a.construct=MO.FEaiProvinceEntityModule_construct;a.findByCode=MO.FEaiProvinceEntityModule_findByCode;a.push=MO.FEaiProvinceEntityModule_push;a.dispose=MO.FEaiProvinceEntityModule_dispose;return a};MO.FEaiProvinceEntityModule_construct=function(){this.__base.FEaiEntityModule.construct.call(this);this._provinces=new MO.TDictionary};
MO.FEaiProvinceEntityModule_findByCode=function(a){return this._provinces.get(a)};MO.FEaiProvinceEntityModule_push=function(a){var b=a.data().code();this._provinces.set(b,a)};MO.FEaiProvinceEntityModule_dispose=function(a){this._provinces=MO.Lang.Object.dispose(this._provinces);this.__base.FEaiEntityModule.dispose.call(this)};
MO.FEaiWorldEntity=function(a){a=MO.Class.inherits(this,a,MO.FEaiEntity,MO.MListener);a._data=MO.Class.register(a,new MO.AGetSet("_data"));a._material=MO.Class.register(a,new MO.AGetter("_material"));a._countries=MO.Class.register(a,new MO.AGetter("_countries"));a._sphere=MO.Class.register(a,new MO.AGetter("_sphere"));a._faceShape=MO.Class.register(a,new MO.AGetter("_faceShape"));a._borderShape=MO.Class.register(a,new MO.AGetter("_borderShape"));a._imageGround=null;a.construct=MO.FEaiWorldEntity_construct;
a.setup=MO.FEaiWorldEntity_setup;a.loadResource=MO.FEaiWorldEntity_loadResource;a.processLoad=MO.FEaiWorldEntity_processLoad;a.dispose=MO.FEaiWorldEntity_dispose;return a};MO.FEaiWorldEntity_construct=function(){this.__base.FEaiEntity.construct.call(this);this._countries=new MO.TObjects;(this._material=MO.Class.create(MO.FE3dMaterial)).info().effectCode="eai.world.face"};
MO.FEaiWorldEntity_setup=function(){var a=this._graphicContext;(this._faceShape=MO.Class.create(MO.FE3dDynamicShape)).linkGraphicContext(a);(this._borderShape=MO.Class.create(MO.FE3dDynamicShape)).linkGraphicContext(a);var b=this._sphere2=MO.Class.create(MO.FE3dSphere);b.linkGraphicContext(a);b.setSplitCount(24);b.setup();b.matrix().setScaleAll(.98);b.matrix().update();b=b.material().info();b.optionAlpha=!1;b.ambientColor.setHex("#128AF9");b.ambientColor.alpha=1;b.diffuseColor.set(.4,.4,.4,1);b.specularColor.set(.2,
.2,.2,.2);b.specularLevel=64;b=this._sphere=MO.Class.create(MO.FE3dSphere);b.linkGraphicContext(a);b.setSplitCount(24);b.setup();b.matrix().setScaleAll(.99);b.matrix().update();b=b.material().info();b.optionAlpha=!0;b.alphaRate=.6;b.ambientColor.setHex("#128AF9");b.ambientColor.alpha=.4;b.diffuseColor.set(.4,.4,.4,1);b.specularColor.set(.2,.2,.2,.2);b.specularLevel=64;b=this._sphere3=MO.Class.create(MO.FE3dSphere);b.linkGraphicContext(a);b.setSplitCount(24);b.setup();b.matrix().setScaleAll(1.2);b.matrix().update();
b=b.material().info();b.optionAlpha=!0;b.optionDepth=!1;b.alphaRate=.05;b.ambientColor.setHex("#128AF9");b.ambientColor.alpha=.4;b.diffuseColor.set(.4,.4,.4,1);b.specularColor.set(.2,.2,.2,.2);b.specularLevel=64;a=this._texture=a.createFlatTexture();a.setWrapCd(MO.EG3dSamplerFilter.ClampToEdge,MO.EG3dSamplerFilter.ClampToEdge);this._material.setTexture("diffuse",a);this._imageGround=MO.Console.find(MO.FImageConsole).load("{eai.resource}/world/color.jpg")};
MO.FEaiWorldEntity_loadResource=function(a){var b=a.data(),c=MO.Console.find(MO.FEaiEntityConsole).countryModule();a=this._countries;for(var e=b.countries(),b=e.count(),d=0;d<b;d++){var f=e.at(d),g=MO.Class.create(MO.FEaiCountryEntity);g.linkGraphicContext(this);g.setWorldEntity(this);g.setup();g.loadData(f);f=g.boundaryShape().faceRenderable();f._material=this._material;f._texture=this._material.textures();a.push(g);c.push(g)}c=this._faceShape=MO.Class.create(MO.FE3dDynamicShape);c.linkGraphicContext(this);
e=this._borderShape=MO.Class.create(MO.FE3dDynamicShape);e.linkGraphicContext(this);for(d=0;d<b;d++)g=a.at(d).boundaryShape(),c.pushMergeRenderable(g.faceRenderable()),e.pushMergeRenderable(g.borderRenderable());c.build();e.build()};MO.FEaiWorldEntity_processLoad=function(){var a=this._imageGround;if(a)return a.testReady()&&(this._texture.upload(a),this._imageGround=null),!1;a=this._resource;return a.testReady()?(this.loadResource(a),this._statusReady=!0):!1};
MO.FEaiWorldEntity_dispose=function(){this._countries=MO.Lang.Object.dispose(this._countries,!0);this.__base.FEaiEntity.dispose.call(this)};MO.FEaiCityEffect=function(a){a=MO.Class.inherits(this,a,MO.FG3dAutomaticEffect);a._code="eai.city";a.drawRenderable=MO.FEaiCityEffect_drawRenderable;return a};
MO.FEaiCityEffect_drawRenderable=function(a,b){var c=this._graphicContext,e=this._program,d=b.currentMatrix(),f=a.calculate(MO.EG3dRegionParameter.CameraViewProjectionMatrix),g=b.material(),h=g.info();this.bindMaterial(g);e.setParameter("vc_model_matrix",d);e.setParameter("vc_vp_matrix",f);e.setParameter4("fc_alpha",h.alphaBase,h.alphaRate,h.alphaLevel,h.alphaMerge);e.setParameter("fc_ambient_color",h.ambientColor);this.bindAttributes(b);this.bindSamplers(b);e=b.indexBuffers().first();c.drawTriangles(e)};
MO.FEaiCityRangeEffect=function(a){a=MO.Class.inherits(this,a,MO.FG3dAutomaticEffect);a._code="eai.city.range";a.drawRenderable=MO.FEaiCityRangeEffect_drawRenderable;return a};
MO.FEaiCityRangeEffect_drawRenderable=function(a,b){var c=this._graphicContext,e=this._program,d=b.currentMatrix(),f=a.calculate(MO.EG3dRegionParameter.CameraViewProjectionMatrix),g=b.material();g.info();this.bindMaterial(g);e.setParameter("vc_model_matrix",d);e.setParameter("vc_vp_matrix",f);this.bindAttributes(b);this.bindSamplers(b);e=b.indexBuffers().first();c.drawTriangles(e)};
MO.FEaiCitysRangeRenderable=function(a){a=MO.Class.inherits(this,a,MO.FE3dRenderable);a._ready=!1;a._image=null;a._citys=MO.Class.register(a,new MO.AGetter("_citys"));a._citySize=MO.Class.register(a,new MO.AGetter("_citySize"));a._vertexPositionBuffer=null;a._vertexColorBuffer=null;a._vertexCoordBuffer=null;a._indexBuffer=null;a._texture=null;a.onImageLoad=MO.FEaiCitysRangeRenderable_onImageLoad;a.construct=MO.FEaiCitysRangeRenderable_construct;a.testReady=MO.FEaiCitysRangeRenderable_testReady;a.setup=
MO.FEaiCitysRangeRenderable_setup;a.upload=MO.FEaiCitysRangeRenderable_upload;a.dispose=MO.FEaiCitysRangeRenderable_dispose;return a};MO.FEaiCitysRangeRenderable_onImageLoad=function(a){a=a.sender;this._texture.upload(a);a.dispose();this._ready=!0};MO.FEaiCitysRangeRenderable_construct=function(){this.__base.FE3dRenderable.construct.call(this);this._citys=new MO.TObjects;this._material=MO.Class.create(MO.FE3dMaterial)};MO.FEaiCitysRangeRenderable_testReady=function(){return this._ready};
MO.FEaiCitysRangeRenderable_setup=function(){var a=this._graphicContext,b=this._citys.count(),c=this._vertexCount=4*b,e=this._vertexPositionBuffer=a.createVertexBuffer();e.setCode("position");e.setFormatCd(MO.EG3dAttributeFormat.Float3);this.pushVertexBuffer(e);for(var e=0,d=new Float32Array(2*c),f=0;f<b;f++)d[e++]=0,d[e++]=1,d[e++]=1,d[e++]=1,d[e++]=1,d[e++]=0,d[e++]=0,d[e++]=0;e=this._vertexCoordBuffer=a.createVertexBuffer();e.setCode("coord");e.setFormatCd(MO.EG3dAttributeFormat.Float2);e.upload(d,
8,c);this.pushVertexBuffer(e);e=this._vertexColorBuffer=a.createVertexBuffer();e.setCode("color");e.setFormatCd(MO.EG3dAttributeFormat.Byte4Normal);this.pushVertexBuffer(e);c=6*b;e=0;d=new Uint16Array(c);for(f=0;f<b;f++){var g=4*f;d[e++]=g+0;d[e++]=g+1;d[e++]=g+2;d[e++]=g+0;d[e++]=g+2;d[e++]=g+3}e=this._indexBuffer=a.createIndexBuffer();e.upload(d,c);this.pushIndexBuffer(e);a=this._texture=a.createFlatTexture();a.setOptionFlipY(!0);a.setWrapCd(MO.EG3dSamplerFilter.ClampToEdge,MO.EG3dSamplerFilter.ClampToEdge);
this.pushTexture(a,"diffuse");a=this._material.info();a.effectCode="eai.citys.range";a.optionAlpha=!0;a.optionDepth=!1;this._material._textures=this._textures;a=MO.Class.create(MO.FImage);a.addLoadListener(this,this.onImageLoad);a.loadUrl("{eai.resource}/dot.png");this._ready=!1};
MO.FEaiCitysRangeRenderable_upload=function(){for(var a=this._citys,b=a.count(),c=0,e=0;e<b;e++){var d=a.at(e);d.visible()&&c++}for(var f=this._vertexCount=4*c,g=0,h=new Float32Array(3*f),m=0,k=new Uint8Array(4*f),e=0;e<b;e++)if(d=a.at(e),d.visible()){var l=d.location(),q=d.range();d.size();var u=d.provinceEntity(),n=0;u&&(n=u.currentZ());h[g++]=l.x-q;h[g++]=l.y+q;h[g++]=n;h[g++]=l.x+q;h[g++]=l.y+q;h[g++]=n;h[g++]=l.x+q;h[g++]=l.y-q;h[g++]=n;h[g++]=l.x-q;h[g++]=l.y-q;h[g++]=n;u=d.rangeColor();d=parseInt(255*
u.red);l=parseInt(255*u.green);q=parseInt(255*u.blue);u=parseInt(255*u.alpha);for(n=0;4>n;n++)k[m++]=d,k[m++]=l,k[m++]=q,k[m++]=u}this._vertexPositionBuffer.upload(h,12,f);this._vertexColorBuffer.upload(k,4,f);this._indexBuffer.setCount(6*c)};
MO.FEaiCitysRangeRenderable_dispose=function(){this._texture=MO.Lang.Object.dispose(this._texture);this._vertexPositionBuffer=MO.Lang.Object.dispose(this._vertexPositionBuffer);this._vertexCoordBuffer=MO.Lang.Object.dispose(this._vertexCoordBuffer);this._indexBuffer=MO.Lang.Object.dispose(this._indexBuffer);this.__base.FE3dRenderable.dispose.call(this)};
MO.FEaiCitysRenderable=function(a){a=MO.Class.inherits(this,a,MO.FE3dRenderable);a._ready=!1;a._image=null;a._levelCoordLeft=null;a._levelCoordRight=null;a._levelScale=null;a._citys=MO.Class.register(a,new MO.AGetter("_citys"));a._level=MO.Class.register(a,new MO.AGetSet("_level"));a._citySize=MO.Class.register(a,new MO.AGetter("_citySize"));a._vertexPositionBuffer=null;a._vertexCoordBuffer=null;a._indexBuffer=null;a._texture=null;a.onImageLoad=MO.FEaiCitysRenderable_onImageLoad;a.construct=MO.FEaiCitysRenderable_construct;
a.testReady=MO.FEaiCitysRenderable_testReady;a.setup=MO.FEaiCitysRenderable_setup;a.upload=MO.FEaiCitysRenderable_upload;a.dispose=MO.FEaiCitysRenderable_dispose;return a};MO.FEaiCitysRenderable_onImageLoad=function(a){a=a.sender;this._texture.upload(a);a.dispose();this._ready=!0};
MO.FEaiCitysRenderable_construct=function(){this.__base.FE3dRenderable.construct.call(this);this._citys=new MO.TObjects;this._material=MO.Class.create(MO.FE3dMaterial);var a=this._levelCoordLeft={};a[1]=0;a[2]=.25;a[3]=.5;a[4]=.75;a=this._levelCoordRight={};a[1]=.25;a[2]=.5;a[3]=.75;a[4]=1;a=this._levelScale={};a[1]=.7;a[2]=.5;a[3]=.4;a[4]=.2};MO.FEaiCitysRenderable_testReady=function(){return this._ready};
MO.FEaiCitysRenderable_setup=function(){var a=this._graphicContext,b=this._citys.count();this._vertexCount=4*b;var c=this._vertexPositionBuffer=a.createVertexBuffer();c.setCode("position");c.setFormatCd(MO.EG3dAttributeFormat.Float3);this.pushVertexBuffer(c);c=this._vertexCoordBuffer=a.createVertexBuffer();c.setCode("coord");c.setFormatCd(MO.EG3dAttributeFormat.Float2);this.pushVertexBuffer(c);c=this._vertexColorBuffer=a.createVertexBuffer();c.setCode("color");c.setFormatCd(MO.EG3dAttributeFormat.Byte4Normal);
this.pushVertexBuffer(c);for(var e=6*b,c=0,d=new Uint16Array(e),f=0;f<b;f++){var g=4*f;d[c++]=g+0;d[c++]=g+1;d[c++]=g+2;d[c++]=g+0;d[c++]=g+2;d[c++]=g+3}c=this._indexBuffer=a.createIndexBuffer();c.upload(d,e);this.pushIndexBuffer(c);a=this._texture=a.createFlatTexture();a.setOptionFlipY(!0);a.setWrapCd(MO.EG3dSamplerFilter.ClampToEdge,MO.EG3dSamplerFilter.ClampToEdge);this.pushTexture(a,"diffuse");a=this._material.info();a.effectCode="eai.citys";a.optionAlpha=!0;a.optionDepth=!1;a.ambientColor.setHex("#FFFFFF");
this._material._textures=this._textures;a=MO.Class.create(MO.FImage);a.addLoadListener(this,this.onImageLoad);a.loadUrl("{eai.resource}/citys.png");this._ready=!1};
MO.FEaiCitysRenderable_upload=function(){for(var a=this._citys,b=a.count(),c=0,e=0;e<b;e++){var d=a.at(e);d.visible()&&c++}for(var f=this._vertexCount=4*c,g=0,h=new Float32Array(3*f),m=0,k=new Float32Array(2*f),l=0,q=new Uint8Array(4*f),e=0;e<b;e++)if(d=a.at(e),d.visible()){d.range();var u=d.location(),n=d.data().level();if(1!=n&&2!=n&&3!=n&&4!=n)throw new TError("Invalid level.");var p=d.provinceEntity(),t=0;p&&(t=p.currentZ());var p=this._levelCoordLeft[n],r=this._levelCoordRight[n],n=this._levelScale[n];
h[g++]=u.x-n;h[g++]=u.y+n;h[g++]=t;h[g++]=u.x+n;h[g++]=u.y+n;h[g++]=t;h[g++]=u.x+n;h[g++]=u.y-n;h[g++]=t;h[g++]=u.x-n;h[g++]=u.y-n;h[g++]=t;k[m++]=p;k[m++]=1;k[m++]=r;k[m++]=1;k[m++]=r;k[m++]=0;k[m++]=p;k[m++]=0;n=d.color();d=parseInt(255*n.red);u=parseInt(255*n.green);t=parseInt(255*n.blue);n=parseInt(255*n.alpha);for(p=0;4>p;p++)q[l++]=d,q[l++]=u,q[l++]=t,q[l++]=n}this._vertexPositionBuffer.upload(h,12,f);this._vertexCoordBuffer.upload(k,8,f);this._vertexColorBuffer.upload(q,4,f);this._indexBuffer.setCount(6*
c)};MO.FEaiCitysRenderable_dispose=function(){this._texture=MO.Lang.Object.dispose(this._texture);this._vertexPositionBuffer=MO.Lang.Object.dispose(this._vertexPositionBuffer);this._vertexCoordBuffer=MO.Lang.Object.dispose(this._vertexCoordBuffer);this._vertexColorBuffer=MO.Lang.Object.dispose(this._vertexColorBuffer);this._indexBuffer=MO.Lang.Object.dispose(this._indexBuffer);this.__base.FE3dRenderable.dispose.call(this)};
MO.FEaiMapFaceEffect=function(a){a=MO.Class.inherits(this,a,MO.FG3dAutomaticEffect);a._code="eai.map.face";a.drawRenderable=MO.FEaiMapFaceEffect_drawRenderable;return a};
MO.FEaiMapFaceEffect_drawRenderable=function(a,b){var c=this._graphicContext,e=this._program,d=a.calculate(MO.EG3dRegionParameter.CameraViewProjectionMatrix),f=b.material();f.info();this.bindMaterial(f);for(var f=b.mergeRenderables(),g=f.count(),h=MO.Lang.TypeArray.findTemp(MO.EDataType.Float32,16*g),m=0;m<g;m++){var k=16*m,l=f.at(m),q=l.matrix(),l=l.color();q.writeData(h,k);h[k+12]=l.red;h[k+13]=l.green;h[k+14]=l.blue;h[k+15]=l.alpha}e.setParameter("vc_data",h);f=b.display().currentMatrix();e.setParameter("vc_model_matrix",
f);e.setParameter("vc_vp_matrix",d);this.bindAttributes(b);e=b.indexBuffers().first();c.drawTriangles(e)};MO.FEaiWorldFaceEffect=function(a){a=MO.Class.inherits(this,a,MO.FG3dAutomaticEffect);a._code="eai.world.face";a.drawRenderable=MO.FEaiWorldFaceEffect_drawRenderable;return a};
MO.FEaiWorldFaceEffect_drawRenderable=function(a,b){var c=this._graphicContext,e=this._program,d=a.calculate(MO.EG3dRegionParameter.CameraViewProjectionMatrix),f=b.material();f.info();this.bindMaterial(f);for(var f=b.mergeRenderables(),g=f.count(),h=MO.Lang.TypeArray.findTemp(MO.EDataType.Float32,16*g),m=0;m<g;m++){var k=16*m,l=f.at(m),q=l.matrix(),l=l.color();q.writeData(h,k);h[k+12]=l.red;h[k+13]=l.green;h[k+14]=l.blue;h[k+15]=l.alpha}e.setParameter("vc_data",h);f=b.display().currentMatrix();e.setParameter("vc_model_matrix",
f);e.setParameter("vc_vp_matrix",d);this.bindAttributes(b);e.setSampler("fs_diffuse",b.material().textures().get("diffuse"));e=b.indexBuffers().first();c.drawTriangles(e)};
MO.FEaiDynamicInfo=function(a){a=MO.Class.inherits(this,a,MO.FGuiControl);a._lastTick=0;a._name="EngineInfo";a._stage=MO.Class.register(a,new MO.AGetSet("_stage"));a._guiManager=MO.Class.register(a,new MO.AGetSet("_guiManager"));a._context=MO.Class.register(a,new MO.AGetSet("_context"));a._ticker=null;a.onPaintBegin=MO.FEaiDynamicInfo_onPaintBegin;a.oeUpdate=MO.FEaiDynamicInfo_oeUpdate;a.construct=MO.FEaiDynamicInfo_construct;return a};
MO.FEaiDynamicInfo_onPaintBegin=function(a){this.__base.FGuiControl.onPaintBegin.call(this,a);if(null!=this._stage&&null!=this._context){var b=a.graphic,c=a.rectangle;this._stage.timer();a=this._stage.statistics();var e=this._context.statistics(),c=c.top+20;b.setFont("16px sans-serif");var d=MO.Window.Browser,f=d.capability();b.drawText(MO.Lang.String.format("Agent         : {1}",d.code),10,c,"#FFFFFF");c+=20;b.drawText(MO.Lang.String.format(" - Browser    : type={1}, orientation={2}, canvas_scale={3}",
d.typeCd(),d.orientationCd(),f.canvasScale),10,c,"#FFFFFF");var c=c+20,d=this._guiManager.desktop(),g=d.canvas2d(),f=d.canvas3d(),h=MO.Window.Browser.capability().pixelRatio;b.drawText(MO.Lang.String.format("Screen        : ratio={1}, screen_size={2}, size={3}",h,d.screenSize().toDisplay(),d.size().toDisplay()),10,c,"#FFFFFF");c+=20;g=g._hCanvas;b.drawText(MO.Lang.String.format(" - Canvas2d   : size={1}x{2}, inner_size={3}x{4}",g.offsetWidth,g.offsetHeight,g.width,g.height),10,c,"#FFFFFF");c+=20;
g=f._hCanvas;b.drawText(MO.Lang.String.format(" - Canvas3d   : size={1}x{2}, inner_size={3}x{4}",g.offsetWidth,g.offsetHeight,g.width,g.height),10,c,"#FFFFFF");c+=20;f=f.graphicContext();b.drawText(MO.Lang.String.format("   - Context  : {1}",f.size().toDisplay()),10,c,"#FFFFFF");c+=20;b.drawText(MO.Lang.String.format("   - Viewport : {1}",f.viewportRectangle()),10,c,"#FFFFFF");c+=20;f=this._stage.camera();g=f.projection();b.drawText(MO.Lang.String.format("Stage         :"),10,c,"#FFFFFF");c+=20;b.drawText(MO.Lang.String.format(" - Camera     : position={1}",
f.position()),10,c,"#FFFFFF");c+=20;b.drawText(MO.Lang.String.format(" - Projection : size={1}, znear={2}, zfar={3}",g.size(),g.znear(),g.zfar()),10,c,"#FFFFFF");c+=20;b.drawText(MO.Lang.String.format("Frame         : rate={1}, span=[{2}]",MO.Timer.rate(),a._frame),10,c,"#FFFFFF");c+=20;b.drawText(MO.Lang.String.format(" - Process    : {1}",a._frameProcess),10,c,"#FFFFFF");c+=20;b.drawText(MO.Lang.String.format(" - Draw       : draw={1}, sort={2}",a._frameDraw,a._frameDrawSort),10,c,"#FFFFFF");c+=
20;b.drawText(MO.Lang.String.format("Draw          : count={1}, triangle={2}",e.frameDrawCount(),e.frameTriangleCount()),10,c,"#FFFFFF");c+=20;b.drawText(MO.Lang.String.format(" - Const      : count={1}, length={2}",e.frameConstCount(),e.frameConstLength()),10,c,"#FFFFFF");c+=20;b.drawText(MO.Lang.String.format(" - Alloc      : buffer={1}, texture={2}",e.frameBufferCount(),e.frameTextureCount()),10,c,"#FFFFFF");c+=20;b.drawText(MO.Lang.String.format(" - Total      : program={1}, layout={2}, vertex={3}, index={4}",
e.programTotal(),e.layoutTotal(),e.vertexBufferTotal(),e.indexBufferTotal()),10,c,"#FFFFFF");c+=20;b.drawText(MO.Lang.String.format("Investment    : entity={1}, table={2}, pool_item={3}, pool_free={4}",this._investmentEntityCount,this._investmentTableEntityCount,this._investmentPoolItemCount,this._investmentPoolFreeCount),10,c,"#FFFFFF");d.resize()}};MO.FEaiDynamicInfo_oeUpdate=function(a){this._ticker.process()&&this.dirty();return MO.EEventStatus.Stop};
MO.FEaiDynamicInfo_construct=function(){this.__base.FGuiControl.construct.call(this);this._size.set(1024,512);this._ticker=new MO.TTicker(1E3)};
with(MO)MO.FGui24HTimeline=function(a){a=RClass.inherits(this,a,FGuiControl);a._startTime=RClass.register(a,new AGetSet("_startTime"));a._endTime=RClass.register(a,new AGetSet("_endTime"));a._data=null;a._ready=!1;a._investmentTotal=0;a._intervalMiniute=10;a._baseHeight=5;a._degreeLineHeight=RClass.register(a,new AGetSet("_degreeLineHeight"),10);a._triangleWidth=RClass.register(a,new AGetSet("_triangleWidth"),10);a._triangleHeight=RClass.register(a,new AGetSet("_triangleHeight"),12);a._decoLineGap=
RClass.register(a,new AGetSet("_decoLineGap"),10);a._decoLineWidth=RClass.register(a,new AGetSet("_decoLineWidth"),30);a.oeUpdate=FGui24HTimeline_oeUpdate;a.construct=FGui24HTimeline_construct;a.sync=FGui24HTimeline_sync;a.onPaintBegin=FGui24HTimeline_onPaintBegin;a.on24HDataFetch=FGui24HTimeline_on24HDataFetch;return a},MO.FGui24HTimeline_construct=function(){this.__base.FGuiControl.construct.call(this);this._startTime=new TDate;this._endTime=new TDate},MO.FGui24HTimeline_sync=function(){if(this._ready){var a=
MO.Console.find(MO.FEaiLogicConsole).system();if(a.testReady()){a=a.currentDate();a.truncMinute(this._intervalMiniute);var b=this._startTime;b.assign(a);b.addDay(-1);var c=this._endTime;c.assign(a);MO.Console.find(MO.FEaiLogicConsole).statistics().doInvestmentTrend(this,this.on24HDataFetch,b.format(),c.format(),60*this._intervalMiniute)}}},MO.FGui24HTimeline_on24HDataFetch=function(a){this._investmentTotal=0;if(a=this._data=a.content.collection)for(var b=a.length,c=0;c<b;c++)this._investmentTotal+=
parseFloat(a[c].investment);this.dirty()},MO.FGui24HTimeline_oeUpdate=function(a){this.__base.FGuiControl.oeUpdate.call(this,a);if(!this._ready)return MO.Console.find(MO.FEaiLogicConsole).system().testReady()&&(this._ready=!0,this.sync()),MO.EEventStatus.Stop},MO.FGui24HTimeline_onPaintBegin=function(a){if(this._ready){this.__base.FGuiControl.onPaintBegin.call(this,a);var b=a.graphic,c=a.rectangle,e=c.top,d=c.top+c.height,f=d-30;a=c.left+5;var c=c.left+c.width-5,g=this.triangleWidth()+this.decoLineGap();
b.drawTriangle(a,f,a+this.triangleWidth(),f+this.triangleHeight()/2,a+this.triangleWidth(),f-this.triangleHeight()/2,1,"#F8CB3D","#F8CB3D");b.drawTriangle(c,f,c-this.triangleWidth(),f+this.triangleHeight()/2,c-this.triangleWidth(),f-this.triangleHeight()/2,1,"#F8CB3D","#F8CB3D");b.drawLine(a+g,f,a+g+this.decoLineWidth(),f,"#F8CB3D",3);b.drawLine(c-g,f,c-g-this.decoLineWidth(),f,"#F8CB3D",3);var h=a+g+this.decoLineWidth(),m=c-g-this.decoLineWidth(),g=e+60,k=d-30,l=k-g;b.drawLine(h,f,m,f,"#F8CB3D",
3);for(var d=this.startTime(),q=this.endTime(),u=q.date.getTime()-d.date.getTime(),c=d.date.getTime(),n,p=!1,t=0;!d.isAfter(q);){var r=d.date.getTime()-c,r=h+r/u*(m-h);b.drawLine(r,f-this.degreeLineHeight(),r,f,"#FFFFFF",1);n=d.format("HH24:00");d.addHour(1);if(p=!p)b.setFont("bold 20px Microsoft YaHei"),t=b.textWidth(n),b.drawText(n,r-t/2,f+20,"#59FDE9")}d.date.setTime(c);d.refresh();if((t=this._data)&&!(1>t.length)){for(f=p=0;f<t.length;f++)q=parseInt(t[f].investment),q>p&&(p=q);n=1E4*l/p;q=parseInt(t[0].investment);
l=k-q/1E4*n;q=b._handle;q.lineCap="round";q.beginPath();q.moveTo(h,l);p=MO.Console.find(MO.FEaiResourceConsole).rateModule().find(EEaiRate.Investment);for(f=1;f<t.length;f++){d.parseAuto(t[f].date);d.refresh();var r=d.date.getTime()-c,r=h+r/u*(m-h),v=k-t[f].investment/1E4*n,v=v-this._baseHeight;q.lineTo(r,v)}n=MO.Lang.Hex.format(p.findRate(0));u="#"+n.substring(2);m="rgba("+MO.Lang.Hex.parse(n.substring(2,4))+","+MO.Lang.Hex.parse(n.substring(4,6))+","+MO.Lang.Hex.parse(n.substring(6,8))+",0.5)";
n=MO.Lang.Hex.format(p.findRate(1));f="#"+n.substring(2);p="rgba("+MO.Lang.Hex.parse(n.substring(2,4))+","+MO.Lang.Hex.parse(n.substring(4,6))+","+MO.Lang.Hex.parse(n.substring(6,8))+",0.5)";n=b.createLinearGradient(0,k,0,g);n.addColorStop("0",u);n.addColorStop("1",f);g=b.createLinearGradient(0,k,0,g);g.addColorStop("0",m);g.addColorStop("1",p);q.strokeStyle=n;q.fillStyle=g;q.lineWidth=4;q.stroke();q.lineTo(r,k);q.lineTo(h,k);q.lineTo(h,l);q.fill();d.date.setTime(c);d.refresh();r=-1;h=g=0;d.parseAuto(t[0].date);
d.refresh();r=d.date.getHours();for(f=0;f<t.length;f++)d.parseAuto(t[f].date),d.refresh(),k=d.date.getHours(),r==k?g+=parseInt(t[f].investment):(g>h&&(h=g,g=0),r=k);b.setFont("bold 24px Microsoft YaHei");b.drawText("24\u5c0f\u65f6\u6295\u8d44\u66f2\u7ebf",a,e,"#54F0FF");b.setFont("22px Microsoft YaHei");e+=30;t=b.textWidth("\u5c0f\u65f6\u5cf0\u503c\uff1a");h=MO.Lang.Float.unitFormat(h,0,0,2,0,1E4,"\u4e07");r=b.textWidth(h);g=MO.Lang.Float.unitFormat(this._investmentTotal,0,0,2,0,1E4,"\u4e07");k=b.textWidth(g);
m=MO.Lang.Float.unitFormat(this._investmentTotal/24,0,0,2,0,1E4,"\u4e07");u=b.textWidth(m);f=Math.max(Math.max(r,k),u);b.drawText("24H\u603b\u989d\uff1a",a,e+0,"#00CFFF");b.drawText(g,a+t+f-k,e+0,"#00B5F6");b.drawText("\u5c0f\u65f6\u5cf0\u503c\uff1a",a,e+22+5,"#00CFFF");b.drawText(h,a+t+f-r,e+22+5,"#00B5F6");b.drawText("\u5c0f\u65f6\u5747\u503c\uff1a",a,e+44+10,"#00CFFF");b.drawText(m,a+t+f-u,e+44+10,"#00B5F6");d.date.setTime(c);d.refresh()}}};
MO.FGui2DMap=function(a){a=MO.Class.inherits(this,a,MO.FGuiControl);a._bgImage=null;a._countryRes=MO.Class.register(a,new MO.AGetSet("_countryRes"));a.construct=MO.FGui2DMap_construct;a.onPaintBegin=MO.FGui2DMap_onPaintBegin;a.onPaintCity=MO.FGui2DMap_onPaintCity;a.dispose=MO.FGui2DMap_dispose;return a};MO.FGui2DMap_construct=function(){this.__base.FGuiControl.construct.call(this)};
MO.FGui2DMap_onPaintBegin=function(a){this.__base.FGuiControl.onPaintBegin.call(this,a);if(this._countryRes){var b=a.graphic,c=a.rectangle,e=this._countryRes;b.drawRectangle(c.left,c.top,c.width,c.height,"#FF0000",2);b=b._handle;b.lineCap="round";b.beginPath();for(var e=e.data().provinces(),c=e.count(),d,f,g,h=0;h<c;h++){d=e.at(h);d=d.boundaries();for(var m=0;m<d._count;m++){f=d.items()[m];positionCount=f._positionCount;position=f._positions;b.moveTo(14*position[0]+-1E3,14*(90-position[1])+-400);
for(var k=0;k<positionCount;k++)f=14*position[0+2*k]+-1E3,g=14*(90-position[1+2*k])+-400,b.lineTo(f,g)}}b.fillStyle="rgba(8, 13, 25, 0.63)";b.strokeStyle="#00B5F6";b.lineWidth=1;b.stroke();b.fill();this.onPaintCity(a)}};
MO.FGui2DMap_onPaintCity=function(a,b){var c=a.graphic,e=c._handle,d=MO.Console.find(MO.FEaiResourceConsole).cityModule().findByCard("1410"),f=14*d._location.x+-1E3,d=14*(90-d._location.y)+-400;MO.Class.create(MO.FEaiCityEntity);e=e.createRadialGradient(f,d,1,f,d,20);e.addColorStop(0,"red");e.addColorStop(1,"rgba(255, 255, 255, 0)");c.drawCircle(f,d,20,1,"rgba(255, 255, 255, 0)",e);c.drawCircle(f,d,2,1,"rgba(255, 255, 255, 0)","#f96")};
MO.FGui2DMap_dispose=function(){this._date=MO.Lang.Object.dispose(this._date);this.__base.FGuiControl.dispose.call(this)};
MO.FGuiFPCCTable=function(a){a=MO.Class.inherits(this,a,MO.FGuiControl);a._frameTime=MO.Class.register(a,new MO.AGetSet("_frameTime"));a._ready=MO.Class.register(a,new MO.AGetSet("_ready"),!1);a._padding=0;a._headFontText=null;a._headFontStyle=null;a._headFontHeight=0;a._rankHeight=0;a._rankCount=0;a._tableTitleTexts=null;a._tableTitleTextHeight=0;a._tableTextPadding=0;a.setup=MO.FGuiFPCCTable_setup;a.onPaintBegin=MO.FGuiFPCCTable_onPaintBegin;a.onImageLoad=MO.FGuiFPCCTable_onImageLoad;a.drawRectangleByText=
MO.FGuiFPCCTable_drawRectangleByText;return a};
MO.FGuiFPCCTable_setup=function(){this._headFontText="\u7406\u8d22\u5e08\u4e1a\u7ee9\u5c55\u793a\u4e2d\u5fc3";this._headFontStyle="bold 32px Microsoft YaHei";this._headFontHeight=30;this._padding=6;this._rankHeight=40;this._rankCount=3;this._tableTitleTexts="\u65f6\u95f4 \u516c\u53f8 \u7406\u8d22\u5e08 \u7406\u8d22\u5e08\u4e1a\u7ee9 \u6ce8\u518c/\u6295\u8d44 \u6295\u8d44/\u8d4e\u56de".split(" ");this._tableTitleFontStyle="16px Microsoft songti";this._tableTitleTextHeight=16;this._tableTextPadding=
7};MO.FGuiFPCCTable_onImageLoad=function(){0==--this._imageToLoad&&(this._ready=!0,this._lastTick=MO.Timer.current(),this.dirty())};
MO.FGuiFPCCTable_onPaintBegin=function(a){var b=a.graphic,c=a.rectangle,e=c.left,d=c.top;a=c.height;c=c.width;b.drawRectangle(e,d,c,a,"#fff",1);b.setFont(this._headFontStyle);var f=b.textWidth(this._headFontText),f=e+.5*(c-f),d=d+this._padding+this._headFontHeight;b.setFont(this._headFontStyle);b.drawText(this._headFontText,f,d,"#55FFED");for(var e=e+this._padding,d=d+2*this._padding,f=c-2*this._padding,g=0,c=1;c<=this._rankCount;c++)1==c?b.drawRectangle(e,d,f,this._rankHeight,"#fff",1):b.drawRectangle(e,
d+this._rankHeight*(c-1),f,this._rankHeight,"#fff",1),3==c&&(g=d+this._rankHeight*(c-1)+this._rankHeight);c=g+this._padding;b.drawRectangle(e,c,f,a-g-this._padding,"#fff",1);a=e+this._padding;b.setFont(this._tableTitleFontStyle);for(e=0;e<this._tableTitleTexts.length;e++)d=this._tableTitleTexts[e],b.textWidth(d),f=c+this._tableTitleTextHeight+this._tableTextPadding,0==e?(b.drawText(d,a,f,"#fff"),this.drawRectangleByText(b,d,this._tableTitleTextHeight,"#7798f2",1,a,f,1)):(g=b.textWidth(this._tableTitleTexts[e-
1]),a=a+g+this._tableTextPadding,b.drawText(d,a,f,"#fff"),this.drawRectangleByText(b,d,this._tableTitleTextHeight,"#ff6d4b",1,a,f,1))};MO.FGuiFPCCTable_drawRectangleByText=function(a,b,c,e,d,f,g,h){h*=1.5;f-=h;g=g-h-c;b=a.textWidth(b);a.drawRectangle(f,g,2*h+b,c+4*h,e,d)};
with(MO)MO.FGuiHistoryMilestoneBar=function(a){a=RClass.inherits(this,a,FGuiControl);a._bgImage=null;a._wanBGImage=null;a._yiBGImage=null;a._numImages=null;a._wanImage=null;a._yiImage=null;a._data=RClass.register(a,new AGetSet("_data"));a._fullWidth=0;a._fullHeight=0;a.setup=FGuiHistoryMilestoneBar_setup;a.onPaintBegin=FGuiHistoryMilestoneBar_onPaintBegin;a.dispose=FGuiHistoryMilestoneBar_dispose;return a},MO.FGuiHistoryMilestoneBar_setup=function(a){this._data=a;var b=MO.Console.find(MO.FImageConsole);
this._wanBGImage=b.load("{eai.resource}/milestone/bar_wan.png");this._yiBGImage=b.load("{eai.resource}/milestone/bar_yi.png");this._wanImage=b.load("{eai.resource}/number_2/wan.png");this._yiImage=b.load("{eai.resource}/number_2/yi.png");this._numImages=Array(10);for(var c=0;10>c;c++)this._numImages[c]=b.load("{eai.resource}/number_2/"+c+".png");1E4<=a.investmentTotal()?(this._bgImage=this._yiBGImage,this.setWidth(371),this.setHeight(80)):(this._bgImage=this._wanBGImage,this.setWidth(341),this.setHeight(76))},
MO.FGuiHistoryMilestoneBar_onPaintBegin=function(a){if(this._data){this.__base.FGuiControl.onPaintBegin.call(this,a);a=a.graphic;var b=this._clientRectangle,c=this._bgImage._size;a.drawImage(this._bgImage,b.left,b.top,c.width,c.height);var e=b.left+25,d=b.top+b.height/2,c=1,f=this.data().investmentTotal().toString();if(4<f.length){c=.53;a.setFont("22px Microsoft YaHei");var d=d+10,f=f.substring(0,f.length-4),g=this._yiImage}else c=.35,a.setFont("18px Microsoft YaHei"),d+=6,g=this._wanImage;var h=
this.data().code(),h=h.substring(0,4)+"\u5e74"+h.substring(4,6)+"\u6708"+h.substring(6,8)+"\u65e5";a.textWidth(h);a.drawText(h,e,d,"#FFEE78");for(var e=this._numImages[0]._size,d=this._yiImage._size,h=b.left+b.width-(f.length*e.width*c+d.width*c)-55,b=b.top+(b.height-e.height*c)/2,m=0;m<f.length;m++)a.drawImage(this._numImages[f[m]],h+m*e.width*c,b,e.width*c,e.height*c);a.drawImage(g,h+f.length*e.width*c,b,d.width*c,d.height*c)}},MO.FGuiHistoryMilestoneBar_dispose=function(){this.__base.FGuiControl.dispose.call(this)};
with(MO)MO.FGuiHistoryMilestoneFrame=function(a){a=RClass.inherits(this,a,FGuiControl);a._bgImage=null;a._numImages=null;a._wanImage=null;a._yiImage=null;a._data=RClass.register(a,new AGetSet("_data"));a._startTick=0;a._popDuration=400;a._showDuration=3E3;a._closeDuration=400;a._fullWidth=953;a._fullHeight=896;a._popupSE=null;a._100yiSE=null;a._listenersDataChanged=RClass.register(a,new AListener("_listenersDataChanged",MO.EEvent.DataChanged));a.setup=FGuiHistoryMilestoneFrame_setup;a.onPaintBegin=
FGuiHistoryMilestoneFrame_onPaintBegin;a.onImageLoad=FGuiHistoryMilestoneFrame_onImageLoad;a.show=FGuiHistoryMilestoneFrame_show;a.dispose=FGuiHistoryMilestoneFrame_dispose;return a},MO.FGuiHistoryMilestoneFrame_setup=function(){this.setWidth(this._fullWidth);this.setHeight(this._fullHeight);this.setLeft((MO.Eai.Canvas.logicSize().width-this._fullWidth)/2);this.setTop(MO.Eai.Canvas.logicSize().height);this._bgImage=MO.Class.create(MO.FImage);this._bgImage.addLoadListener(this,this.onImageLoad);this._bgImage.loadUrl("{eai.resource}/milestone/bg.png");
this._wanImage=MO.Class.create(MO.FImage);this._wanImage.addLoadListener(this,this.onImageLoad);this._wanImage.loadUrl("{eai.resource}/number/wan.png");this._yiImage=MO.Class.create(MO.FImage);this._yiImage.addLoadListener(this,this.onImageLoad);this._yiImage.loadUrl("{eai.resource}/number/yi.png");this._numImages=Array(10);for(var a=0;10>a;a++){var b=MO.Class.create(MO.FImage);b.addLoadListener(this,this.onImageLoad);b.loadUrl("{eai.resource}/number/"+a+".png");this._numImages[a]=b}a=MO.Console.find(MO.FAudioConsole);
this._popupSE=a.load("{eai.resource}/milestone/popup.mp3");this._100yiSE=a.load("{eai.resource}/milestone/100yi.mp3")},MO.FGuiHistoryMilestoneFrame_onImageLoad=function(){this.dirty()},MO.FGuiHistoryMilestoneFrame_onPaintBegin=function(a){if(this._data){this.__base.FGuiControl.onPaintBegin.call(this,a);a=a.graphic;var b=this._clientRectangle,c=this._bgImage._size,e=b.left+b.width/2,d=e-135,f=b.top+520,g=MO.Timer.current()-this._startTick,h=g-this._popDuration,m=g-this._showDuration-this._popDuration,
k=(MO.Eai.Canvas.logicSize().height+this._fullHeight)/2+50-this._fullHeight,l=0;if(g<this._popDuration)l=g/this._popDuration,l=1-(1-l)*(1-l),a._handle.globalAlpha=l,this.setTop(MO.Eai.Canvas.logicSize().height-this._fullHeight-k*l);else if(!(h<this._showDuration))if(m<this._closeDuration)l=m/this._closeDuration,l*=l,a._handle.globalAlpha=1-l,this.setTop((MO.Eai.Canvas.logicSize().height-this._fullHeight)/2-50-k*l);else{this._data=null;this.setVisible(!1);this.setTop(MO.Eai.Canvas.logicSize().height-
this._fullHeight);this.dirty();a=MO.Memory.alloc(SEvent);a.sender=this;this.processDataChangedListener(a);return}a.drawImage(this._bgImage,e-c.width/2,b.top,c.width,c.height);a.setFont("bold 28px Microsoft YaHei");a.drawText("\u8fbe\u6210\u65e5\u6570\uff1a",d,f+50,"#FF9103");a.drawText("\u5206\u516c\u53f8\u6570\uff1a",d,f+100,"#FF9103");a.drawText("\u7406\u8d22\u5e08\u6570\uff1a",d,f+150,"#FF9103");if(this.data()){c=this.data().investmentTotal().toString();4<c.length?(c=c.substring(0,c.length-4),
g=this._yiImage):g=this._wanImage;h=this._numImages[0]._size;m=this._yiImage._size;k=e-(c.length*h.width+m.width)/2;for(l=0;l<c.length;l++)a.drawImage(this._numImages[c[l]],k+l*h.width,b.top+320,h.width,h.height);a.drawImage(g,k+c.length*h.width,b.top+320,m.width,m.height);c="";g=0;a.setFont("48px Microsoft YaHei");b=b.top+280;h=this.data().code();c=h.substring(0,4)+"\u5e74"+h.substring(4,6)+"\u6708"+h.substring(6,8)+"\u65e5\u8fbe\u6210";g=a.textWidth(c);e=e-g/2-10;c=h.substring(0,4);g=a.textWidth(c);
a.drawText(c,e,b,"#FFEE78");e+=g;c="\u5e74";g=a.textWidth(c);a.drawText(c,e,b,"#FF9103");e+=g;c=h.substring(4,6);g=a.textWidth(c);a.drawText(c,e,b,"#FFEE78");e+=g;c="\u6708";g=a.textWidth(c);a.drawText(c,e,b,"#FF9103");e+=g;c=h.substring(6,8);g=a.textWidth(c);a.drawText(c,e,b,"#FFEE78");e+=g;c="\u65e5\u8fbe\u6210";a.textWidth(c);a.drawText(c,e,b,"#FF9103");a.setFont("bold 28px Microsoft YaHei");c=this.data().dayCount();g=a.textWidth(c);a.drawText(c,d+250-g,f+50,"#FFEE78");c=this.data().companyCount();
g=a.textWidth(c);a.drawText(c,d+250-g,f+100,"#FFEE78");c=this.data().staffCount();g=a.textWidth(c);a.drawText(c,d+250-g,f+150,"#FFEE78")}a._handle.globalAlpha=1}},MO.FGuiHistoryMilestoneFrame_show=function(){o=this;o.setVisible(!0);o._startTick=MO.Timer.current();1E6==o.data().investmentTotal()&&o._100yiSE.play(0);o._popupSE.play(0)},MO.FGuiHistoryMilestoneFrame_dispose=function(){this.__base.FEaiEntity.dispose.call(this)};
MO.FGuiHistoryTimeline=function(a){a=MO.Class.inherits(this,a,MO.FGuiTimeline);a._startHeight=30;a._lineWidth=5;a._circleRadius=5;a._timeFontColor="#00B5F6";a._cursorFontColor="#59FDE9";a.onPaintBegin=MO.FGuiHistoryTimeline_onPaintBegin;return a};
MO.FGuiHistoryTimeline_onPaintBegin=function(a){this.__base.FGuiTimeline.onPaintBegin.call(this,a);var b=a.graphic,c=a.rectangle,e=c.top;a=c.bottom();var d=e+30+this._startHeight;a-=50;var f=a-d,g=this.triangleWidth()+this.decoLineGap(),e=c.left+5+g+this.decoLineWidth(),c=c.left+c.width-5-g-this.decoLineWidth(),g=this.startTime(),h=this.endTime(),m=this.degreeTime(),k=g.date.getTime(),l=h.date.getTime()-g.date.getTime(),q=MO.Console.find(MO.FEaiResourceConsole).historyModule(),u=q.investmentTotal(),
n=q.dates().get(h.format("YYYYMMDD")),h=n.investmentTotal(),p=q.dates().get(m.format("YYYYMMDD"));3*p.investmentTotal()<u&&(h=h*(p.investmentTotal()/u)*3);f=1E4*f/h;h=MO.Console.find(MO.FEaiResourceConsole).rateModule().find(MO.EEaiRate.Line);p=b._handle;p.lineCap="round";p.beginPath();p.moveTo(r,v);var n=q.dates().get(g.format("YYYYMMDD")),t=n.investmentTotal(),r=e,v;for(v=a-t/1E4*f-this._startHeight;g.isBefore(m);)if(n=q.dates().get(g.format("YYYYMMDD"))){var w=g.date.getTime()-k,w=e+w/l*(c-e);
v=n.investmentTotal();n=a-v/1E4*f;n-=this._startHeight;p.lineTo(w,n);v=n;g.addDay(1)}else break;if(n=q.dates().get(g.format("YYYYMMDD"))){var w=g.date.getTime()-k+this.unitms()*this.progress(),w=e+w/l*(c-e),t=n.investmentTotal(),n=a-t/1E4*f-this._startHeight,r=MO.Lang.Hex.format(h.findRate(t/u)),x="#"+r.substring(2);MO.GuiColor.makeRgbString(r,.3);p.lineTo(w,v+(n-v)*this.progress())}var r=MO.Lang.Hex.format(h.findRate(0)),t="#"+r.substring(2),n="rgba("+MO.Lang.Hex.parse(r.substring(2,4))+","+MO.Lang.Hex.parse(r.substring(4,
6))+","+MO.Lang.Hex.parse(r.substring(6,8))+",0.5)",r=MO.Lang.Hex.format(h.findRate(1)),x="#"+r.substring(2),r="rgba("+MO.Lang.Hex.parse(r.substring(2,4))+","+MO.Lang.Hex.parse(r.substring(4,6))+","+MO.Lang.Hex.parse(r.substring(6,8))+",0.5)",y=b.createLinearGradient(0,a,0,d);y.addColorStop("0",t);y.addColorStop("1",x);d=b.createLinearGradient(0,a,0,d);d.addColorStop("0",n);d.addColorStop("1",r);p.strokeStyle=y;p.fillStyle=d;p.lineWidth=this._lineWidth;p.stroke();p.lineTo(w,a);p.lineTo(e,a);p.lineTo(e,
v);p.fill();g.date.setTime(k);for(g.refresh();g.isBefore(m);)if(n=q.dates().get(g.format("YYYYMMDD")))w=g.date.getTime()-k,w=e+w/l*(c-e),v=n.investmentTotal(),n=a-v/1E4*f,n-=this._startHeight,r=MO.Lang.Hex.format(h.findRate(v/u)),x="#"+r.substring(2),1==g.date.getDate()&&(b.drawCircle(w,n,this._circleRadius,0,x,x),b.setFont("bold 22px Microsoft YaHei"),1E8<v?(v=MO.Lang.Float.unitFormat(v,0,0,2,0,1E8,"\u4ebf"),d=b.textWidth(v),b.drawText(v,w-d/2,n-16,"#FFE849")):(v=parseInt(v/1E4)+"\u4e07",d=b.textWidth(v),
b.drawText(v,w-d/2,n-16,"#FF7200"))),v=n,g.addDay(1);else break;if(n=q.dates().get(g.format("YYYYMMDD")))w=g.date.getTime()-k+this.unitms()*this.progress(),w=e+w/l*(c-e),t=n.investmentTotal(),n=a-t/1E4*f-this._startHeight,r=MO.Lang.Hex.format(h.findRate(t/u)),x="#"+r.substring(2),b.drawCircle(w,v+(n-v)*this.progress(),this._circleRadius,0,x,x),b.setFont("bold 22px Microsoft YaHei"),1E8<t?(v=MO.Lang.Float.unitFormat(t,0,0,2,0,1E8,"\u4ebf"),d=b.textWidth(v),b.drawText(v,w-d/2,n-16,"#FFE849")):(v=parseInt(t/
1E4)+"\u4e07",d=b.textWidth(v),b.drawText(v,w-d/2,n-16,"#FF7200"));g.date.setTime(k);g.refresh()};
MO.FGuiLivePop=function(a){a=MO.Class.inherits(this,a,MO.FGuiControl);a._bgImage=null;a._data=MO.Class.register(a,new MO.AGetSet("_data"));a._startTick=0;a._popDuration=500;a._showDuration=2E3;a._closeDuration=500;a._fullWidth=910;a._fullHeight=140;a._riseHeight=50;a._date=null;a.construct=MO.FGuiLivePop_construct;a.setup=MO.FGuiLivePop_setup;a.onPaintBegin=MO.FGuiLivePop_onPaintBegin;a.onImageLoad=MO.FGuiLivePop_onImageLoad;a.show=MO.FGuiLivePop_show;a.dispose=MO.FGuiLivePop_dispose;return a};
MO.FGuiLivePop_construct=function(){this.__base.FGuiControl.construct.call(this);this._date=new MO.TDate};MO.FGuiLivePop_setup=function(){this.setWidth(this._fullWidth);this.setHeight(this._fullHeight);this.setLeft((MO.Eai.Canvas.logicSize().width-this._fullWidth)/3);this.setTop((MO.Eai.Canvas.logicSize().height-this._fullHeight)/2+this._riseHeight);this._bgImage=MO.Class.create(MO.FImage);this._bgImage.addLoadListener(this,this.onImageLoad);this._bgImage.loadUrl("{eai.resource}/invespop.png")};
MO.FGuiLivePop_onImageLoad=function(){this.dirty()};
MO.FGuiLivePop_onPaintBegin=function(a){this.__base.FGuiControl.onPaintBegin.call(this,a);if(this._data){a=a.graphic;var b=this._clientRectangle,c=this._data,e=MO.Console.find(MO.FEaiEntityConsole).cityModule().findByCard(c.card()),d="";this._date.parse(c.date());d+=this._date.format("HH24:MI:SS");d+="    ";e&&(d+=e.data().label());d=d+"    "+(c.customer()+" - "+c.phone());d+="    ";d+=MO.Lang.Float.format(c.investment(),null,null,2,"0");a.setFont("36px Microsoft YaHei");popTextWidth=a.textWidth(d);
var c=MO.Timer.current()-this._startTick,e=c-this._popDuration,f=c-this._showDuration-this._popDuration,g=0;c<this._popDuration?(g=c/this._popDuration,a._handle.globalAlpha=g,a.drawImage(this._bgImage,b.left,b.top,this._fullWidth,this._fullHeight),a._handle.globalAlpha=1,this.setTop((MO.Eai.Canvas.logicSize().height-this._fullHeight)/2+this._riseHeight*(1-g)),a.drawText(d,b.left+(b.width-popTextWidth)/2,b.top+80,"rgba(255, 241, 0, "+g+")")):e<this._showDuration?(a.drawImage(this._bgImage,b.left,b.top,
this._fullWidth,this._fullHeight),a.drawText(d,b.left+(b.width-popTextWidth)/2,b.top+80,"rgba(255, 241, 0, 1)")):f<this._closeDuration?(g=f/this._closeDuration,a._handle.globalAlpha=1-g,a.drawImage(this._bgImage,b.left,b.top,this._fullWidth,this._fullHeight),a._handle.globalAlpha=1,this.setTop((MO.Eai.Canvas.logicSize().height-this._fullHeight)/2-this._riseHeight*g),a.drawText(d,b.left+(b.width-popTextWidth)/2,b.top+80,"rgba(255, 241, 0, "+(1-g)+")")):(this._data=null,this.setVisible(!1),this.dirty())}};
MO.FGuiLivePop_show=function(){o=this;o.setVisible(!0);o._startTick=MO.Timer.current();o.dirty()};MO.FGuiLivePop_dispose=function(){this._date=MO.Lang.Object.dispose(this._date);this.__base.FGuiControl.dispose.call(this)};
MO.FGuiLiveTable=function(a){a=MO.Class.inherits(this,a,MO.FGuiControl);a._currentDate=null;a._rank=MO.Class.register(a,new MO.AGetSet("_rank"));a._rankLogoImage=null;a._rankTitleImage=null;a._rankLineImage=null;a._rankLinePadding=null;a._rank1Image=null;a._rank2Image=null;a._rank3Image=null;a._backgroundImage=null;a._backgroundPadding=null;a._columnLabels=null;a._columnDefines=null;a._columnWidths=null;a._tableCount=0;a._entities=null;a._lineScroll=0;a._listenersDataChanged=MO.Class.register(a,new MO.AListener("_listenersDataChanged",
MO.EEvent.DataChanged));a.onImageLoad=MO.FGuiLiveTable_onImageLoad;a.onPaintBegin=MO.FGuiLiveTable_onPaintBegin;a.oeUpdate=MO.FGuiLiveTable_oeUpdate;a.construct=MO.FGuiLiveTable_construct;a.setup=MO.FGuiLiveTable_setup;a.pushEntity=MO.FGuiLiveTable_pushEntity;a.drawRow=MO.FGuiLiveTable_drawRow;a.dispose=MO.FGuiLiveTable_dispose;return a};MO.FGuiLiveTable_onImageLoad=function(){this.dirty()};
MO.FGuiLiveTable_onPaintBegin=function(a){this.__base.FGuiControl.onPaintBegin.call(this,a);var b=a.graphic,c=a.rectangle,e=c.left;a=c.top;for(var d=c.width,f=c.height,c=e+12,g=e+d-e,h=0,m=0;4>m;m++)h+=this._columnDefines[m];for(m=0;4>m;m++)this._columnWidths[m]=this._columnDefines[m]/h*g-7;b.drawGridImage(this._backgroundImage,e,a,d,f,this._backgroundPadding);b.setFont(this._headFontStyle);m=b.textWidth("\u5168\u7403\u5b9e\u65f6\u6295\u8d44\u6570\u636e\u5c55\u793a\u4e2d\u5fc3(\u4e2d\u56fd)");b.drawText("\u5168\u7403\u5b9e\u65f6\u6295\u8d44\u6570\u636e\u5c55\u793a\u4e2d\u5fc3(\u4e2d\u56fd)",
e+.5*(d-m),a+76,"#59FDE9");b.setFont(this._rowFontStyle);f=a+this._rankStart;b.drawGridImage(this._rankLineImage,e+6,f+this._rankTitleStart,d-22,this._rankHeight,this._rankLinePadding);b.drawImage(this._rankTitleImage,e+.5*(d-167),f+3,167,40);if(h=this._rank)for(e=h.count(),f+=90,m=0;m<e;m++)d=h.at(m),this.drawRow(b,d,!0,m,c,f+this._rankRowHeight*m,g);for(var e="",d=0,f=c,h=a+this._headStart,k=h+this._headTextTop,m=0;4>m;m++)e=this._columnLabels[m],d=b.textWidth(e),b.fillRectangle(f,h,this._columnWidths[m]-
4,this._headHeight,"#122A46"),b.drawText(e,f+.5*(this._columnWidths[m]-d-4),k,"#00B2F2"),f+=this._columnWidths[m];h=this._entities;if(!h.isEmpty())for(f=a+this._rowStart,b.clip(c,f,g-38,this._rowHeight*(this._tableCount-1)),f+=24,e=h.count(),m=0;m<e;m++)d=h.at(m),this.drawRow(b,d,!1,m,c,f+this._rowHeight*m+this._lineScroll,g)};
MO.FGuiLiveTable_oeUpdate=function(a){this.__base.FGuiControl.oeUpdate.call(this,a);a.isBefore()&&0>this._lineScroll&&(this._lineScroll+=1,this._lineScroll<-this._rowHeight&&(this._lineScroll=0),0<=this._lineScroll&&(a=this._entities,a.count()>this._tableCount&&a.pop(),this._lineScroll=0),this.dirty())};
MO.FGuiLiveTable_construct=function(){this.__base.FGuiControl.construct.call(this);this._entities=new MO.TObjects;this._currentDate=new MO.TDate;this._rankLinePadding=new MO.SPadding(40,0,40,0);this._backgroundPadding=new MO.SPadding(20,20,90,20);this._columnLabels=["\u65f6\u95f4","\u57ce\u5e02","\u7528\u6237-\u624b\u673a","\u6295\u8d44\u989d(\u5143)"];MO.Runtime.isPlatformMobile()?this._columnDefines=[130,130,180,186]:this._columnDefines=[110,110,160,166];this._columnWidths=[]};
MO.FGuiLiveTable_setup=function(){var a=MO.Console.find(MO.FImageConsole),b=this._logoImage=a.load("{eai.resource}/live/company.png");b.addLoadListener(this,this.onImageLoad);b=this._backgroundImage=a.load("{eai.resource}/live/grid.png");b.addLoadListener(this,this.onImageLoad);b=this._rankTitleImage=a.load("{eai.resource}/live/tank-title.png");b.addLoadListener(this,this.onImageLoad);b=this._rankLineImage=a.load("{eai.resource}/live/rank.png");b.addLoadListener(this,this.onImageLoad);b=this._rank1Image=
a.load("{eai.resource}/live/1.png");b.addLoadListener(this,this.onImageLoad);b=this._rank2Image=a.load("{eai.resource}/live/2.png");b.addLoadListener(this,this.onImageLoad);b=this._rank3Image=a.load("{eai.resource}/live/3.png");b.addLoadListener(this,this.onImageLoad);this._headFontStyle="bold 36px Microsoft YaHei";MO.Window.Browser.isOrientationVertical()?(this._tableCount=11,this._rankStart=100,this._rankTitleStart=-5,this._rankHeight=249,this._rankRowHeight=50,this._rankIconStart=22,this._rankTextStart=
8,this._rankRowUp=36,this._rankRowDown=68,this._headStart=352,this._headTextTop=37,this._headHeight=54,this._rowStart=418,this._rowTextTop=0,this._rowFontStyle="36px Microsoft YaHei",this._rowHeight=46):(this._tableCount=19,this._rankStart=110,this._rankTitleStart=0,this._rankHeight=219,this._rankRowHeight=40,this._rankIconStart=25,this._rankTextStart=0,this._rankRowUp=32,this._rankRowDown=51,this._headStart=336,this._headTextTop=27,this._headHeight=40,this._rowFontStyle="24px Microsoft YaHei",this._rowStart=
384,this._rowHeight=36)};MO.FGuiLiveTable_pushEntity=function(a){if(!a)return null;var b=this._entities;b.unshift(a);this._lineScroll-=this._rowHeight;b.count()>this._tableCount&&b.pop()};
MO.FGuiLiveTable_drawRow=function(a,b,c,e,d,f,g){var h=this._columnWidths;g=null;g=c?"#E5BD1D":"#59FDE9";if(c){var m=d+.5*h[0]-23,k=f-this._rankIconStart;0==e&&this._rank1Image.testReady()&&a.drawImage(this._rank1Image,m-6,k-28,58,65);1==e&&this._rank2Image.testReady()&&a.drawImage(this._rank2Image,m,k,46,37);2==e&&this._rank3Image.testReady()&&a.drawImage(this._rank3Image,m,k,46,37)}f+=this._rankTextStart;e=0;c||(this._currentDate.parse(b.date()),c=this._currentDate.format("HH24:MI:SS"),e=a.textWidth(c),
a.drawText(c,d+.5*h[0]-.5*e,f,g));d+=h[0];e=MO.Console.find(MO.FEaiResourceConsole).cityModule().findByCard(b.card());c="";e&&(c=e.label());e=a.textWidth(c);a.drawText(c,d+.5*h[1]-.5*e,f,g);d+=h[1];c=b.customer()+" - "+b.phone();e=a.textWidth(c);a.drawText(c,d+.5*h[2]-.5*e,f,g);d+=h[2];b=MO.Lang.Float.format(b.investment(),null,null,2,"0");d=d+h[3]-15;7<b.length?(g=null,g=9<b.length?"#FDEF01":"#EB6C03",h=b.substring(0,b.length-7),b=b.substring(b.length-7,b.length),c=a.textWidth(h),e=a.textWidth(b),
a.drawText(h,d-e-c,f,g),a.drawText(b,d-e,f,"#59FDE9")):(e=a.textWidth(b),a.drawText(b,d-e,f,g))};MO.FGuiLiveTable_dispose=function(){this._entities=MO.Lang.Object.dispose(this._entities);this._backgroundPadding=MO.Lang.Object.dispose(this._backgroundPadding);this.__base.FEaiEntity.dispose.call(this)};
MO.FEaiStatisticsDate=function(a){a=MO.Class.inherits(this,a,MO.FGuiLabel);a._value=MO.Class.register(a,new MO.AGetter("_value"));a.onPaintLabel=MO.FEaiStatisticsDate_onPaintLabel;a.construct=MO.FEaiStatisticsDate_construct;a.setValue=MO.FEaiStatisticsDate_setValue;a.dispose=MO.FEaiStatisticsDate_dispose;return a};
MO.FEaiStatisticsDate_onPaintLabel=function(a){var b=a.graphic,c=a.rectangle;b.setFont("bold 36px Microsoft YaHei");a=this._value.format("YYYY");var e=this._value.format("MM"),d=this._value.format("DD"),f=a+"\u5e74",g=e+"\u6708";b.textWidth(f+g+(d+"\u65e5"));var f=b.textWidth(f),g=b.textWidth(g),h=c.left,c=c.top+c.height,m=h+4,k=c-5;b.setFont("bold 36px Microsoft YaHei");var l=b.textWidth(a);b.drawText(a,h,c,"#FFD926");b.setFont("bold 28px Microsoft YaHei");b.drawText("\u5e74",m+l,k,"#00B5F6");b.setFont("bold 36px Microsoft YaHei");
l=b.textWidth(e);b.drawText(e,h+f,c,"#FFD926");b.setFont("bold 28px Microsoft YaHei");b.drawText("\u6708",m+f+l,k,"#00B5F6");b.setFont("bold 36px Microsoft YaHei");l=b.textWidth(d);b.drawText(d,h+f+g,c,"#FFD926");b.setFont("bold 28px Microsoft YaHei");b.drawText("\u65e5",m+f+g+l,k,"#00B5F6")};MO.FEaiStatisticsDate_construct=function(){this.__base.FGuiLabel.construct.call(this);this._value=new MO.TDate};MO.FEaiStatisticsDate_setValue=function(a){this._value.parse(a,"YYYYMMDD");this.dirty()};
MO.FEaiStatisticsDate_dispose=function(){this._value=MO.Lang.Object.dispose(this._value);this.__base.FGuiLabel.dispose.call(this)};
MO.FEaiStatisticsInvestment=function(a){a=MO.Class.inherits(this,a,MO.FObject,MO.MGraphicObject,MO.MListener);a._dateSetup=!1;a._beginDate=MO.Class.register(a,new MO.AGetter("_beginDate"));a._endDate=MO.Class.register(a,new MO.AGetter("_endDate"));a._invementDayCurrent=MO.Class.register(a,new MO.AGetter("_invementDayCurrent"),0);a._invementDay=MO.Class.register(a,new MO.AGetter("_invementDay"),0);a._invementTotalCurrent=MO.Class.register(a,new MO.AGetter("_invementTotalCurrent"),0);a._invementTotal=
MO.Class.register(a,new MO.AGetter("_invementTotal"),0);a._intervalMinute=1;a._mapEntity=MO.Class.register(a,new MO.AGetSet("_mapEntity"));a._display=MO.Class.register(a,new MO.AGetter("_display"));a._rankEntities=MO.Class.register(a,new MO.AGetter("_rankEntities"));a._entities=MO.Class.register(a,new MO.AGetter("_entities"));a._tableEntities=MO.Class.register(a,new MO.AGetter("_tableEntities"));a._tableCount=40;a._tableInterval=1E3;a._tableTick=1;a._dataTicker=null;a._entityPool=null;a._autios=null;
a._eventDataChanged=null;a._listenersDataChanged=MO.Class.register(a,new MO.AListener("_listenersDataChanged",MO.EEvent.DataChanged));a.onInvestment=MO.FEaiStatisticsInvestment_onInvestment;a.construct=MO.FEaiStatisticsInvestment_construct;a.allocEntity=MO.FEaiStatisticsInvestment_allocEntity;a.allocShape=MO.FEaiStatisticsInvestment_allocShape;a.setup=MO.FEaiStatisticsInvestment_setup;a.calculateInvestmentLevel=MO.FEaiStatisticsInvestment_calculateInvestmentLevel;a.calculateCurrent=MO.FEaiStatisticsInvestment_calculateCurrent;
a.focusEntity=MO.FEaiStatisticsInvestment_focusEntity;a.process=MO.FEaiStatisticsInvestment_process;a.dispose=MO.FEaiStatisticsInvestment_dispose;return a};
MO.FEaiStatisticsInvestment_onInvestment=function(a){var b=a.content;this._invementDay=b.investment_day;this._invementTotal=b.investment_total;var c=this._rankEntities;a=c.count();for(var e=0;e<a;e++){var d=c.at(e);this._entityPool.free(d)}c.clear();var f=b.rank;if(f)for(a=f.length,e=0;e<a;e++){var g=f[e],d=this.allocEntity();d.loadData(g);c.push(d)}f=b.collection;b=this._entities;if(f)for(a=f.length,e=0;e<a;e++)g=f[e],d=this.allocEntity(),d.loadData(g),b.push(d);this.calculateCurrent();a=this._eventDataChanged;
a.entity=null;a.rank=this._rankEntities;a.data=this._tableEntities;this.processDataChangedListener(a);a=b.count();this._tableInterval=6E4*this._intervalMinute/a;this._tableTick=0};
MO.FEaiStatisticsInvestment_construct=function(){this.__base.FObject.construct.call(this);this._beginDate=new MO.TDate;this._endDate=new MO.TDate;this._entities=new MO.TObjects;this._tableEntities=new MO.TObjects;this._tableTicker=new MO.TTicker(1E3*this._tableInterval);this._autios={};this._dataTicker=new MO.TTicker(6E4*this._intervalMinute);this._rankEntities=new MO.TObjects;this._entityPool=MO.Class.create(MO.FObjectPool);this._eventDataChanged=new MO.SEvent(this)};
MO.FEaiStatisticsInvestment_allocEntity=function(){var a=this._entityPool.alloc();a||(a=MO.Class.create(MO.FEaiStatisticsInvestmentEntity));return a};MO.FEaiStatisticsInvestment_setup=function(){for(var a=MO.Console.find(MO.FAudioConsole),b=1;5>=b;b++)this._autios[b]=a.load("{eai.resource}/currency/"+b+".mp3");(this._display=MO.Class.create(MO.FE3dDisplay)).linkGraphicContext(this)};
MO.FEaiStatisticsInvestment_calculateInvestmentLevel=function(a){return 5E6<=a?5:1E6<=a?4:1E5<=a?3:1E4<=a?2:1E3<=a?1:0};MO.FEaiStatisticsInvestment_calculateCurrent=function(){for(var a=this._invementDay,b=this._invementTotal,c=this._entities,e=c.count(),d=0;d<e;d++)var f=c.at(d).investment(),a=a-f,b=b-f;this._invementDayCurrent=Math.max(a,0);this._invementTotalCurrent=Math.max(b,0)};
MO.FEaiStatisticsInvestment_focusEntity=function(a){var b=a.card();if(b=MO.Console.find(MO.FEaiEntityConsole).cityModule().findByCard(b)){var c=a.investment(),e=this.calculateInvestmentLevel(c),d=b.data().provinceCode();(d=MO.Console.find(MO.FEaiEntityConsole).provinceModule().findByCode(d))&&d.doInvestment(e,c);b.addInvestmentTotal(e,c);this._mapEntity.upload();(b=this._autios[e])&&b.play(0)}b=this._eventDataChanged;b.entity=a;b.rank=this._rankEntities;b.data=this._tableEntities;this.processDataChangedListener(b)};
MO.FEaiStatisticsInvestment_process=function(){var a=MO.Console.find(MO.FEaiLogicConsole).system();if(a.testReady()){a=a.currentDate();a.truncMinute();this._dateSetup||(this._endDate.assign(a),this._endDate.addMinute(-this._intervalMinute),this._dateSetup=!0);if(this._dataTicker.process()){var b=MO.Console.find(MO.FEaiLogicConsole).statistics(),c=this._beginDate,e=this._endDate;c.assign(e);e.assign(a);b.doInvestmentDynamic(this,this.onInvestment,c.format(),e.format());c.assign(e)}a=MO.RTimer.current();
a-this._tableTick>this._tableInterval&&(this._tableEntities.count()>=this._tableCount&&(b=this._tableEntities.pop(),this._entityPool.free(b)),b=this._entities,b.isEmpty()||(b=b.shift(),this._tableEntities.unshift(b),this.focusEntity(b)),this.calculateCurrent(),this._tableTick=a);this._mapEntity.process();a=MO.Desktop.application().dynamicInfo();a._investmentEntityCount=this._entities.count();a._investmentTableEntityCount=this._tableEntities.count();a._investmentPoolItemCount=this._entityPool.items().count();
a._investmentPoolFreeCount=this._entityPool.frees().count()}};MO.FEaiStatisticsInvestment_dispose=function(){this._entities=MO.Lang.Object.dispose(this._entities);this._dataTicker=MO.Lang.Object.dispose(this._dataTicker);this._eventDataChanged=MO.Lang.Object.dispose(this._eventDataChanged);this.__base.FObject.dispose.call(this)};
with(MO)MO.FEaiStatisticsInvestmentEntity=function(a){a=RClass.inherits(this,a,FEaiEntity);a._date=RClass.register(a,new AGetter("_date"));a._customer=RClass.register(a,new AGetter("_customer"));a._phone=RClass.register(a,new AGetter("_phone"));a._card=RClass.register(a,new AGetter("_card"));a._investment=RClass.register(a,new AGetter("_investment"));a._shape=RClass.register(a,new AGetSet("_shape"));a.construct=FEaiStatisticsInvestmentEntity_construct;a.loadData=FEaiStatisticsInvestmentEntity_loadData;
a.update=FEaiStatisticsInvestmentEntity_update;a.dispose=FEaiStatisticsInvestmentEntity_dispose;return a},MO.FEaiStatisticsInvestmentEntity_construct=function(){this.__base.FEaiEntity.construct.call(this)},MO.FEaiStatisticsInvestmentEntity_loadData=function(a){this._date=a.date;this._customer=a.customer;this._phone=a.phone;this._card=a.card;this._investment=a.investment},MO.FEaiStatisticsInvestmentEntity_build=function(a){this._location.assign(this._data.location());this._size.set(2,2)},MO.FEaiStatisticsInvestmentEntity_update=
function(a){this._data.location();var b=1;if(a){var c=RConsole.find(FEaiResourceConsole).historyConsole().investmentCityTotal(),b=RConsole.find(FEaiResourceConsole).rateConsole().find(EEaiRate.Map);a=5*Math.sqrt(a.investmentTotal()/c);c=b.findRate(a);b=10*a;a=RFloat.toRange(a,0,1);this._color.set((c>>16&255)/255,(c>>8&255)/255,(c>>0&255)/255,4*a)}else this._color.set(0,0,0,0);b=this._range=RFloat.toRange(Math.sqrt(b),1,4);this._size.set(b,b)},MO.FEaiStatisticsInvestmentEntity_dispose=function(){this.__base.FEaiEntity.dispose.call(this)};
with(MO)MO.FEaiStatisticsInvestmentShape=function(a){a=RClass.inherits(this,a,FE3dShape);a._ready=!1;a._playing=!1;a._finish=!1;a._image=null;a._statusPaint=!1;a._cityEntity=RClass.register(a,new AGetSet("_cityEntity"));a._entity=RClass.register(a,new AGetter("_entity"));a._customerLabel=null;a._cityLabel=null;a._investment=null;a._interval=10;a._moveRate=0;a._lastTick=0;a.onImageLoad=FEaiStatisticsInvestmentShape_onImageLoad;a.construct=FEaiStatisticsInvestmentShape_construct;a.setup=FEaiStatisticsInvestmentShape_setup;
a.setEntity=FEaiStatisticsInvestmentShape_setEntity;a.paint=FEaiStatisticsInvestmentShape_paint;a.process=FEaiStatisticsInvestmentShape_process;a.dispose=FEaiStatisticsInvestmentShape_dispose;return a},MO.FEaiStatisticsInvestmentShape_onImageLoad=function(a){this._ready=!0},MO.FEaiStatisticsInvestmentShape_construct=function(){this.__base.FE3dShape.construct.call(this)},MO.FEaiStatisticsInvestmentShape_setup=function(){this.__base.FE3dShape.setup.call(this);var a=this._renderable=RClass.create(FE3dShapeData);
a.linkGraphicContext(this);a.setOptionCenter(!0);a.size().set(128,64);a.setup();a=this._image=RClass.create(FImage);a.addLoadListener(this,this.onImageLoad);a.loadUrl("/script/ars/eai/investment.png");this._ready=!1},MO.FEaiStatisticsInvestmentShape_setEntity=function(a){this._customerLabel=a.customer();this._cityLabel=this._cityEntity.data().label();this._investment=a.investment();this._finish=!1},MO.FEaiStatisticsInvestmentShape_paint=function(){var a=this._cityEntity.location(),b=this.material();
b.info().optionAlpha=!0;b.info().ambientColor.set(1,1,1,1);b=this._matrix;b.tx=a.x;b.ty=a.y;b.tz=0;b.setScale(10,5,1);b.update();a=this._renderable;b=a.beginDraw();b.drawImage(this._image,0,0,128,64);b.setFont("bold 18px Microsoft YaHei");b.drawText(this._cityLabel,15,25,"#FF00FF");b.setFont("bold 20px Microsoft YaHei");b.drawText(this._customerLabel,30,50,"#FFFF00");b.setFont("bold 20px Microsoft YaHei");b.drawText(this._investment,55,50,"#FF0000");a.endDraw();this._playing=this._statusPaint=!0;
this._moveRate=this._lastTick=0},MO.FEaiStatisticsInvestmentShape_process=function(a){this.__base.FE3dShape.process.call(this,a);this._statusDirty&&this.testReady()&&(this._statusPaint||(this.paint(),this._statusPaint=!0),this._statusDirty=!1);if(this._statusPaint&&!this._finish){a=RTimer.current();var b=this._matrix;a-this._lastTick>this._interval&&(b.ty+=this._moveRate+.01,this._moveRate+=.01,b.updateForce(),this._lastTick=a);100<b.ty&&(this._finish=!0)}},MO.FEaiStatisticsInvestmentShape_dispose=
function(){this.__base.FE3dShape.dispose.call(this)};
MO.FEaiStatisticsLabel=function(a){a=MO.Class.inherits(this,a,MO.FGuiLabel);a._value=MO.Class.register(a,new MO.AGetter("_value"),"0");a._originValue="0";a._startTick=0;a._textFontW="0";a._unitFontW="0";a._negative="0";a._origin="0";a._rolling=MO.Class.register(a,new MO.AGetSet("_rolling"),!1);a._rollingDuration=MO.Class.register(a,new MO.AGetSet("_rollingDuration"),1E3);a._rollingPages=null;a._noRolling=MO.Class.register(a,new MO.AGetSet("_noRolling"),!1);a.onPaintLabel=MO.FEaiStatisticsLabel_onPaintLabel;
a.oeUpdate=MO.FEaiStatisticsLabel_oeUpdate;a.construct=MO.FEaiStatisticsLabel_construct;a.setValue=MO.FEaiStatisticsLabel_setValue;a.dispose=MO.FEaiStatisticsLabel_dispose;return a};
MO.FEaiStatisticsLabel_onPaintLabel=function(a){var b=a.graphic,c=a.rectangle;b.clip(c.left,c.top,c.width,c.height);a=this._foreFont;var e=this._backFont;b.setFont(a);var d,f;this._alignCd!=MO.EUiAlign.Right?(d=c.left,f=d+4):f=d=c.right()-this._unitFontW+(this._textFontW-this._unitFontW)-65;var c=c.top+c.height,g=c-2,h="",m=MO.Timer.current()-this._startTick;if(m>this._rollingDuration||this._noRolling)m=this._rollingDuration,this._rolling=!1;for(var k=0;k<this._value.length;k++){var l=this._rollingPages.get(k)*
(m/this._rollingDuration),q=(parseInt(this._originValue.charAt(k))+parseInt(l)).toString(),q=parseInt(q.charAt(q.length-1)),u=9==q?0:q+1,n=0==q?9:q-1,l=l-parseInt(l);b.setFont(a);var p,t="",r=this._originValue.length;k<r-8?t="#FFD926":k<r-4?t="#FF7200":k<r&&(t="#FD0000");if(!/^[0-9]+$/.test(this._negative)){p="";var v=1,w=this._negative.length,x=d;5>=w?p="#FD0000":9>=w?p="#FF7200":13>=w&&(p="#FFD926");b.setFont(a);"0"!=this._rollingPages.get(0)&&(v=l);0==k&&(d+=10,f+=10,b.drawText("-",x,c-38*v,p),
b.drawText("-",x,c*v,p),b.drawText("-",x,c+38*v,p))}this._textFontW=p=b.textWidth(h);b.drawText(n,d+p,c-38-38*l,t);b.drawText(q,d+p,c-38*l,t);b.drawText(u,d+p,c+38-38*l,t);h+=q;k==r-9?(p=b.textWidth(h),b.setFont(e),b.drawText("\u4ebf",f+p,g,"#00B5F6"),h+="\u4ebf"):k==r-5?(p=b.textWidth(h),b.setFont(e),b.drawText("\u4e07",f+p,g,"#00B5F6"),h+="\u4e07"):k==r-1&&(p=b.textWidth(h),b.setFont(e),b.drawText("\u5143",f+p,g,"#00B5F6"),h+="\u5143",this._unitFontW=p)}0==this._rolling&&(this._originValue=this._value,
this._origin=this._negative,this._rollingPages.clear())};
MO.FEaiStatisticsLabel_setValue=function(a){var b,c=/^[0-9]+$/,e=a;if(this._value!=a&&this._negative!=a){this._rolling&&(this._originValue=this._value,this._origin=this._negative);this._negative=a;b=a-this._origin;this._value=a=Math.abs(a).toString();for(var d=this._originValue,f=a.length-d.length;0<f;)d="0"+d,f--;this._originValue=d;this._rollingPages.clear();f=this._rollingPages._length=a.length;if(b=c.test(e)?0>b:0<b)for(b=0;b<f;b++)c=parseInt(a.substring(b,b+1))-parseInt(d.substring(b,b+1)),c=
0<c?c-10:c,this._rollingPages.set(b,c);else for(b=0;b<f;b++)c=parseInt(a.substring(b,b+1))-parseInt(d.substring(b,b+1)),c=0>c?c+10:c,this._rollingPages.set(b,c);this._startTick=MO.Timer.current();this._rolling=!0}};MO.FEaiStatisticsLabel_oeUpdate=function(a){this.__base.FGuiLabel.oeUpdate.call(this,a);this._rolling&&this.dirty();return MO.EEventStatus.Stop};MO.FEaiStatisticsLabel_construct=function(){this.__base.FGuiLabel.construct.call(this);this._rollingPages=new MO.TArray};
MO.FEaiStatisticsLabel_dispose=function(){this._ticker=MO.RObject.dispose(this._ticker);this.__base.FGuiLabel.dispose.call(this)};
MO.FEaiChartCustomerScene=function(a){a=MO.RClass.inherits(this,a,MO.FEaiChartScene);a._code=MO.EEaiScene.ChartCustomer;a._playing=!1;a._startDate=null;a._endDate=null;a._currentDate=null;a.onLoadData=MO.FEaiChartCustomerScene_onLoadData;a.onKeyDown=MO.FEaiChartCustomerScene_onKeyDown;a.setup=MO.FEaiChartCustomerScene_setup;a.selectDate=MO.FEaiChartCustomerScene_selectDate;a.active=MO.FEaiChartCustomerScene_active;a.process=MO.FEaiChartCustomerScene_process;a.deactive=MO.FEaiChartCustomerScene_deactive;
return a};MO.FEaiChartCustomerScene_onLoadData=function(a){this.__base.FEaiChartScene.onLoadData.call(this,a);a=this._currentDate.format("YYYYMMDD");this.selectDate(a)};
MO.FEaiChartCustomerScene_onKeyDown=function(a){a=a.keyCode;if(a==MO.EKeyCode.N){this._currentDate.addDay(-1);var b=this._currentDate.format("YYYYMMDD");this.selectDate(b);console.log(b)}a==MO.EKeyCode.M&&(this._currentDate.addDay(1),b=this._currentDate.format("YYYYMMDD"),this.selectDate(b),console.log(b));a==MO.EKeyCode.L&&(MO.RDate.autoParse(this._currentDate,"20140701"),this._playing=!0)};
MO.FEaiChartCustomerScene_selectDate=function(a){this.graphicContext();var b=this._activeStage;b.mapLayer();b.borderLayer();b.dataLayer();if(b=MO.Console.find(MO.FEaiResourceConsole).historyConsole().dates().get(a)){a=b.provinces();for(var c=a.count(),e=0;e<c;e++){var d=a.at(e);this._provinceEntities.get(d.code()).update(d)}for(var d=b.citys(),f=this._cityEntities,c=f.count(),e=0;e<c;e++){var g=f.at(e);a=g.data().code();a=d.get(a);g.update(a)}if(c=document.getElementById("id_total"))c.innerHTML=this._currentDate.format("YYYY-MM-DD")+
" "+b.investmentTotal()}this._citysRangeRenderable.upload()};MO.FEaiChartCustomerScene_setup=function(){this.__base.FEaiChartScene.setup.call(this);MO.RWindow.lsnsKeyDown.register(this,this.onKeyDown);this._currentDate=new MO.TDate;this._startDate=new MO.TDate;this._endDate=new MO.TDate;this._currentDate.parseAuto("20140701");this._startDate.parseAuto("20140701");this._endDate.parseAuto("20150618")};MO.FEaiChartCustomerScene_active=function(){this.__base.FEaiChartScene.active.call(this)};
MO.FEaiChartCustomerScene_process=function(){this.__base.FEaiChartScene.process.call(this);if(this._playing){this._currentDate.addDay(1);var a=this._currentDate.format("YYYYMMDD"),b=this._endDate.format("YYYYMMDD");this.selectDate(a);a==b&&(this._playing=!1)}};MO.FEaiChartCustomerScene_deactive=function(){this.__base.FEaiChartScene.deactive.call(this)};
MO.FEaiChartIndustryScene=function(a){a=MO.RClass.inherits(this,a,MO.FEaiChartScene);a._code=MO.EEaiScene.ChartIndustry;a._playing=!1;a._startDate=null;a._endDate=null;a._currentDate=null;a.onLoadData=MO.FEaiChartIndustryScene_onLoadData;a.onKeyDown=MO.FEaiChartIndustryScene_onKeyDown;a.setup=MO.FEaiChartIndustryScene_setup;a.selectDate=MO.FEaiChartIndustryScene_selectDate;a.active=MO.FEaiChartIndustryScene_active;a.process=MO.FEaiChartIndustryScene_process;a.deactive=MO.FEaiChartIndustryScene_deactive;
return a};MO.FEaiChartIndustryScene_onLoadData=function(a){this.__base.FEaiChartScene.onLoadData.call(this,a);a=this._currentDate.format("YYYYMMDD");this.selectDate(a)};
MO.FEaiChartIndustryScene_onKeyDown=function(a){a=a.keyCode;if(a==MO.EKeyCode.N){this._currentDate.addDay(-1);var b=this._currentDate.format("YYYYMMDD");this.selectDate(b);console.log(b)}a==MO.EKeyCode.M&&(this._currentDate.addDay(1),b=this._currentDate.format("YYYYMMDD"),this.selectDate(b),console.log(b));a==MO.EKeyCode.L&&(MO.RDate.autoParse(this._currentDate,"20140701"),this._playing=!0)};
MO.FEaiChartIndustryScene_selectDate=function(a){this.graphicContext();var b=this._activeStage;b.mapLayer();b.borderLayer();b.dataLayer();if(b=MO.Console.find(MO.FEaiResourceConsole).historyConsole().dates().get(a)){a=b.provinces();for(var c=a.count(),e=0;e<c;e++){var d=a.at(e);this._provinceEntities.get(d.code()).update(d)}for(var d=b.citys(),f=this._cityEntities,c=f.count(),e=0;e<c;e++){var g=f.at(e);a=g.data().code();a=d.get(a);g.update(a)}if(c=document.getElementById("id_total"))c.innerHTML=this._currentDate.format("YYYY-MM-DD")+
" "+b.investmentTotal()}this._citysRangeRenderable.upload()};MO.FEaiChartIndustryScene_setup=function(){this.__base.FEaiChartScene.setup.call(this);MO.RWindow.lsnsKeyDown.register(this,this.onKeyDown);this._currentDate=new MO.TDate;this._startDate=new MO.TDate;this._endDate=new MO.TDate;this._currentDate.parseAuto("20140701");this._startDate.parseAuto("20140701");this._endDate.parseAuto("20150618")};MO.FEaiChartIndustryScene_active=function(){this.__base.FEaiChartScene.active.call(this)};
MO.FEaiChartIndustryScene_process=function(){this.__base.FEaiChartScene.process.call(this);if(this._playing){this._currentDate.addDay(1);var a=this._currentDate.format("YYYYMMDD"),b=this._endDate.format("YYYYMMDD");this.selectDate(a);a==b&&(this._playing=!1)}};MO.FEaiChartIndustryScene_deactive=function(){this.__base.FEaiChartScene.deactive.call(this)};
MO.FEaiChartInvestmentScene=function(a){a=MO.RClass.inherits(this,a,MO.FEaiChartScene);a._code=MO.EEaiScene.ChartInvestment;a._playing=!1;a._startDate=null;a._endDate=null;a._currentDate=null;a._timeline=null;a.onLoadData=MO.FEaiChartInvestmentScene_onLoadData;a.onKeyDown=MO.FEaiChartInvestmentScene_onKeyDown;a.setup=MO.FEaiChartInvestmentScene_setup;a.selectDate=MO.FEaiChartInvestmentScene_selectDate;a.active=MO.FEaiChartInvestmentScene_active;a.process=MO.FEaiChartInvestmentScene_process;a.deactive=
MO.FEaiChartInvestmentScene_deactive;a.onDateSelect=MO.FEaiChartInvestmentScene_onDateSelect;return a};MO.FEaiChartInvestmentScene_onLoadData=function(a){this.__base.FEaiChartScene.onLoadData.call(this,a);a=this._currentDate.format("YYYYMMDD");this.selectDate(a)};
MO.FEaiChartInvestmentScene_onKeyDown=function(a){a=a.keyCode;if(a==MO.EKeyCode.N){this._currentDate.addDay(-1);var b=this._currentDate.format("YYYYMMDD");this.selectDate(b);console.log(b)}a==MO.EKeyCode.M&&(this._currentDate.addDay(1),b=this._currentDate.format("YYYYMMDD"),this.selectDate(b),console.log(b));if(a==MO.EKeyCode.L){MO.RDate.autoParse(this._currentDate,"20140701");a=document.getElementById("id_investment_table");for(b=1;b<a.rows.length;b++)a.rows[b].style.display="none";this._playing=
!0}};
MO.FEaiChartInvestmentScene_selectDate=function(a){this.graphicContext();var b=this._activeStage;b.mapLayer();b.borderLayer();var b=MO.Console.find(MO.FEaiResourceConsole).historyConsole(),c=MO.Console.find(MO.FEaiResourceConsole).provinceConsole();if(b=b.dates().get(a)){a=b.provinces();for(var e=a.count(),d=document.getElementById("id_investment_table");d.rows.length<e+1;){var f=d.insertRow(d.rows.length);f.insertCell(0);f.insertCell(1);f.insertCell(2)}for(var g=0;g<e;g++){var h=a.at(g);this._provinceEntities.get(h.code()).update(h);var m=
c.findByCode(h.code()),f=d.rows[g+1];f.style.display="";f.className="DataGrid_Row";var k=f.cells[0],l=f.cells[1],f=f.cells[2];2<g&&(k.innerText=g+1);l.innerText=m.label();1E3<h.investmentTotal()?f.innerText=MO.RFloat.unitFormat(h.investmentTotal(),0,0,2,0,1E4,"\u4e07"):f.innerText=h.investmentTotal();f.align="right"}this._timeline.setDegreeTime(this._currentDate);this._timeline.repaint();c=b.citys();d=this._cityEntities;e=d.count();for(g=0;g<e;g++)h=d.at(g),a=h.data().code(),a=c.get(a),h.update(a);
this._totalBar.findComponent("total").setLabel(MO.RFloat.unitFormat(b.investmentTotal(),0,0,2,0,1E4,"\u4e07"));this._totalBar.repaint()}};
MO.FEaiChartInvestmentScene_setup=function(){this.__base.FEaiChartScene.setup.call(this);MO.RWindow.lsnsKeyDown.register(this,this.onKeyDown);this._currentDate=new MO.TDate;this._startDate=new MO.TDate;this._endDate=new MO.TDate;this._currentDate.parseAuto("20140701");this._startDate.parseAuto("20140701");this._endDate.parseAuto("20150618");for(var a=document.getElementById("id_investment_table"),b=0;3>b;b++){var c=a.insertRow(a.rows.length),e=c.insertCell(0);c.insertCell(1);c.insertCell(2);switch(b){case 0:c.style.color=
"#FFEA01";e.innerHTML="1 <IMG src='/script/ars/eai/medals/gold.png'/>";break;case 1:c.style.color="#C5D3D6";e.innerHTML="2 <IMG src='/script/ars/eai/medals/silver.png'/>";break;case 2:c.style.color="#E16A00",e.innerHTML="3 <IMG src='/script/ars/eai/medals/copper.png'/>"}}a=this.activeStage().faceLayer();b=this._timeline=MO.RClass.create(MO.FGuiHistoryTimeline);b.setName("Timeline");b.setLeft(50);b.setTop(MO.Eai.Canvas._size.height-400);b.setWidth(MO.Eai.Canvas._size.width-500);b.setHeight(350);b.setTimeUnit(MO.EUiTimeUnit.Month);
b.setStartTime(this._startDate);b.setEndTime(this._endDate);b.setDegreeTime(this._currentDate);b.addDataChangedListener(this,this.onDateSelect);b.linkGraphicContext(this);b.build();this._desktop.register(b);a.push(b)};MO.FEaiChartInvestmentScene_onDateSelect=function(a){this._currentDate.date.setTime(a.date.date.getTime());this._currentDate.refresh();this.selectDate(this._currentDate.format("YYYYMMDD"))};MO.FEaiChartInvestmentScene_active=function(){this.__base.FEaiChartScene.active.call(this)};
MO.FEaiChartInvestmentScene_process=function(){this.__base.FEaiChartScene.process.call(this);if(this._playing){this._currentDate.addDay(1);var a=this._currentDate.format("YYYYMMDD"),b=this._endDate.format("YYYYMMDD");this.selectDate(a);a==b&&(this._playing=!1)}for(var a=this._citysRenderables,b=a.count(),c=0;c<b;c++)a.at(c).upload();this._citysRangeRenderable.upload()};MO.FEaiChartInvestmentScene_deactive=function(){this.__base.FEaiChartScene.deactive.call(this)};
MO.FEaiChartLiveScene=function(a){a=MO.RClass.inherits(this,a,MO.FEaiChartScene);a._code=MO.EEaiScene.ChartLive;a._investment=MO.Class.register(a,new MO.AGetter("_investment"));a._investmentCurrent=0;a._ready=!1;a._mapReady=!1;a._playing=!1;a._lastTick=0;a._interval=10;a._24HLastTick=0;a._24HTrendInterval=3E5;a._logoBar=null;a._timeline=null;a._liveTable=null;a._livePop=null;a._statusStart=!1;a._statusLayerCount=100;a._statusLayerLevel=100;a._groundAutioUrl="{eai.resource}/music/statistics.mp3";a.onInvestmentDataChanged=
MO.FEaiChartLiveScene_onInvestmentDataChanged;a.onOperationVisibility=MO.FEaiChartLiveScene_onOperationVisibility;a.onProcessReady=MO.FEaiChartLiveScene_onProcessReady;a.onProcess=MO.FEaiChartLiveScene_onProcess;a.onSwitchProcess=MO.FEaiChartLiveScene_onSwitchProcess;a.onSwitchComplete=MO.FEaiChartLiveScene_onSwitchComplete;a.setup=MO.FEaiChartLiveScene_setup;a.showParticle=MO.FEaiChartLiveScene_showParticle;a.showFace=MO.FEaiChartLiveScene_showFace;a.fixMatrix=MO.FEaiChartLiveScene_fixMatrix;a.processResize=
MO.FEaiChartLiveScene_processResize;return a};MO.FEaiChartLiveScene_onInvestmentDataChanged=function(a){var b=a.entity,c=this._liveTable;c.setRank(a.rank);c.pushEntity(b);c.dirty();b&&this._livePop.setData(b)};MO.FEaiChartLiveScene_onOperationVisibility=function(a){this.__base.FEaiChartScene.onOperationVisibility.call(this,a);a.visibility?(this._groundAutio.play(),this._countryEntity._audioMapEnter._hAudio.muted=!1):(this._groundAutio.pause(),this._countryEntity._audioMapEnter._hAudio.muted=!0)};
MO.FEaiChartLiveScene_onProcessReady=function(){this.__base.FEaiChartScene.onProcessReady.call(this);this._mapEntity.showCity()};
MO.FEaiChartLiveScene_onProcess=function(){this.__base.FEaiChartScene.onProcess.call(this);if(!this._statusStart){if(MO.Window.Browser.capability().soundConfirm){var a=document.getElementById("id_ios_play");a&&MO.Window.Html.visibleSet(a,!0);(a=document.getElementById("id_loading"))&&document.body.removeChild(a)}else{if(a=document.getElementById("id_loading"))a.style.opacity=this._statusLayerLevel/this._statusLayerCount,this._statusLayerLevel--;this._statusLayerLevel--}0>=this._statusLayerLevel&&
(a&&document.body.removeChild(a),a=this._countryEntity,a.start(),this._mapEntity.showCountry(a),this.processLoaded(),this._statusStart=this._playing=!0)}if(this._playing){a=this._countryEntity;if(!a.introAnimeDone()){a.process();return}this._mapReady||(this._guiManager.show(),a=MO.Class.create(MO.FGuiActionAlpha),a.setAlphaBegin(0),a.setAlphaEnd(1),a.setAlphaInterval(.01),a.push(this._guiManager),this._guiManager.mainTimeline().pushAction(a),this._mapReady=!0);a=MO.Timer.current();a-this._24HLastTick>
this._24HTrendInterval&&(this._timeline.sync(),this._24HLastTick=a);this._investment.process();var a=this._logoBar,b=a.findComponent("investmentTotal"),c=this._investment.invementTotalCurrent();b.setValue(parseInt(c).toString());a=a.findComponent("investmentDay");b=this._investment.invementDayCurrent();a.setValue(parseInt(b).toString());this._nowTicker.process()&&(a=this._logoBar,b=this._nowDate,b.setNow(),a.findComponent("date").setLabel(b.format("YYYY/MM/DD")),a.findComponent("time").setLabel(b.format("HH24:MI")))}this._livePop.visible()&&
this._livePop.dirty()};MO.FEaiChartLiveScene_onSwitchProcess=function(a){};MO.FEaiChartLiveScene_onSwitchComplete=function(a){};
MO.FEaiChartLiveScene_setup=function(){this.__base.FEaiChartScene.setup.call(this);var a=this._activeStage.dataLayer(),b=this._logoBar=MO.Console.find(MO.FGuiFrameConsole).get(this,"eai.chart.LogoBar");this._guiManager.register(b);b=this._investment=MO.Class.create(MO.FEaiStatisticsInvestment);b.linkGraphicContext(this);b.setMapEntity(this._mapEntity);b.setup();b.addDataChangedListener(this,this.onInvestmentDataChanged);b=b.display();this.fixMatrix(b.matrix());a.push(b);this.activeStage();a=this._timeline=
MO.Class.create(MO.FGui24HTimeline);a.setName("Timeline");a.linkGraphicContext(this);a.sync();a.build();this._guiManager.register(a);a=this._liveTable=MO.Class.create(MO.FGuiLiveTable);a.setName("LiveTable");a.linkGraphicContext(this);a.setup();a.build();this._guiManager.register(a);a=this._livePop=MO.Class.create(MO.FGuiLivePop);a.setName("LivePop");a.linkGraphicContext(this);a.setup();a.build();this._guiManager.register(a);this._guiManager.hide();a=MO.Console.find(MO.FEaiEntityConsole);a.cityModule().build(this);
a=this._countryEntity=a.mapModule().loadCountry(this,MO.EEaiConstant.DefaultCountry);this._readyLoader.push(a)};MO.FEaiChartLiveScene_showParticle=function(a,b){var c=this._particle,e=b.location();c.color().set(1,1,0,1);for(var d=0;4>d;d++){var f=parseInt(100*Math.random());Math.random();c.setItemCount(f);c.position().assign(e);c.position().z=a.currentZ();c.setDelay(10*d);c.setSpeed(4+.4*d);c.setAcceleration(0);c.setAttenuation(.8);c.start()}};
MO.FEaiChartLiveScene_showFace=function(){this._playing=this._statusStart=!0;this._mapReady=!1;this._mapEntity.reset();this._application.desktop().show();this.processResize()};MO.FEaiChartLiveScene_fixMatrix=function(a){MO.Window.Browser.isOrientationVertical()?(a.tx=-14.58,a.ty=-1.9,a.tz=0,a.setScale(.14,.16,.14)):(a.tx=-38.6,a.ty=-12.8,a.tz=0,a.setScale(.32,.36,.32));a.update()};
MO.FEaiChartLiveScene_processResize=function(){this.__base.FEaiChartScene.processResize.call(this);var a=MO.Window.Browser.isOrientationVertical();this.fixMatrix(this._investment.display().matrix());var b=this._logoBar;a?(b.setLocation(8,8),b.setScale(.85,.85)):(b.setLocation(5,5),b.setScale(1,1));b=this._southSea;a?(b.setDockCd(MO.EUiDock.RightTop),b.setTop(570),b.setRight(100)):(b.setDockCd(MO.EUiDock.RightBottom),b.setRight(710),b.setBottom(260));b=this._timeline;a?(b.setDockCd(MO.EUiDock.Bottom),
b.setAnchorCd(MO.EUiAnchor.Left|MO.EUiAnchor.Right),b.setLeft(10),b.setRight(10),b.setBottom(920)):(b.setDockCd(MO.EUiDock.Bottom),b.setAnchorCd(MO.EUiAnchor.Left|MO.EUiAnchor.Right),b.setLeft(20),b.setBottom(30),b.setRight(680));b.setHeight(250);b=this._liveTable;a?(b.setDockCd(MO.EUiDock.Bottom),b.setAnchorCd(MO.EUiAnchor.Left|MO.EUiAnchor.Top|MO.EUiAnchor.Right),b.setLeft(10),b.setRight(10),b.setBottom(10),b.setWidth(1060),b.setHeight(900)):(b.setDockCd(MO.EUiDock.Right),b.setAnchorCd(MO.EUiAnchor.Left|
MO.EUiAnchor.Top|MO.EUiAnchor.Bottom),b.setTop(10),b.setRight(0),b.setBottom(10),b.setWidth(650))};
MO.FEaiChartScene=function(a){a=MO.Class.inherits(this,a,MO.FEaiScene);a._optionMapCountry=!0;a._readyProvince=!1;a._countryReady=!1;a._nowDate=null;a._nowTicker=null;a._mapEntity=null;a._citysRangeRenderable=null;a._citysRenderable=null;a._flagSprite=null;a._southSea=null;a._groundAutio=null;a.onLoadTemplate=MO.FEaiChartScene_onLoadTemplate;a.onProcess=MO.FEaiChartScene_onProcess;a.construct=MO.FEaiChartScene_construct;a.fixMatrix=MO.FEaiChartScene_fixMatrix;a.setup=MO.FEaiChartScene_setup;a.active=
MO.FEaiChartScene_active;a.resetDate=MO.FEaiChartScene_resetDate;a.processResize=MO.FEaiChartScene_processResize;a.deactive=MO.FEaiChartScene_deactive;a.dispose=MO.FEaiChartScene_dispose;return a};MO.FEaiChartScene_onLoadTemplate=function(a){};MO.FEaiChartScene_onProcess=function(){this.__base.FEaiScene.onProcess.call(this);!this._countryReady&&MO.Console.find(MO.FEaiEntityConsole).testCountryReady()&&(this._countryReady=!0,this.processResize())};
MO.FEaiChartScene_construct=function(){this.__base.FEaiScene.construct.call(this);this._nowDate=new MO.TDate;this._nowTicker=new MO.TTicker(1E4)};MO.FEaiChartScene_fixMatrix=function(a){a.tx=-35;a.ty=-12.3;a.tz=0;a.setScale(.32,.36,.32);a.update()};
MO.FEaiChartScene_setup=function(){this.__base.FEaiScene.setup.call(this);var a=MO.Console.find(MO.FEaiEntityConsole);a.linkGraphicContext(this);a.setup();var b=this._mapEntity=a.mapEntity(),a=this._activeStage=MO.Class.create(MO.FEaiChartStage);a.linkGraphicContext(this);a.region().linkGraphicContext(this);a.region().backgroundColor().set(0,0,0,0);var c=b.countryFaceDisplay();this.fixMatrix(c.matrix());a.mapLayer().pushDisplay(c);c=b.countryBorderDisplay();this.fixMatrix(c.matrix());a.borderLayer().pushDisplay(c);
c=b.cityRangeRenderable();this.fixMatrix(c.matrix());a.cityRangeLayer().push(c);b=b.cityCenterRenderable();this.fixMatrix(b.matrix());a.cityLayer().push(b);MO.Console.find(MO.FEaiLogicConsole).system().refresh();a=this._groundAutio=MO.Console.find(MO.FAudioConsole).load("{eai.resource}-{device.type}/chart/ground.mp3");a.setLoop(!0);a.setVolume(.2);a.play();this._optionMapCountry&&(a=this._southSea=MO.Class.create(MO.FGuiPicture),a.setDisplayOrder(-10),a.size().set(134,203),a.setBackResource("url:{eai.resource}/south-sea.png"),
a.psInitialize(),a.build(),this._guiManager.register(a))};MO.FEaiChartScene_active=function(){this.__base.FEaiScene.active.call(this)};MO.FEaiChartScene_resetDate=function(){};MO.FEaiChartScene_processResize=function(){this.__base.FEaiScene.processResize.call(this);var a=MO.Console.find(MO.FEaiEntityConsole).mapEntity();this.fixMatrix(a.countryFaceDisplay().matrix());this.fixMatrix(a.countryBorderDisplay().matrix());this.fixMatrix(a.cityRangeRenderable().matrix());this.fixMatrix(a.cityCenterRenderable().matrix())};
MO.FEaiChartScene_deactive=function(){this.__base.FEaiScene.deactive.call(this)};MO.FEaiChartScene_dispose=function(){this._nowDate=RObject.dispose(this._nowDate);this._nowTicker=RObject.dispose(this._nowTicker);this._mapEntity=null;this.__base.FEaiScene.dispose.call(this)};
MO.FEaiChartStage=function(a){a=MO.RClass.inherits(this,a,MO.FE3dStage);a._groundLayer=MO.Class.register(a,new MO.AGetter("_groundLayer"));a._mapLayer=MO.Class.register(a,new MO.AGetter("_mapLayer"));a._borderLayer=MO.Class.register(a,new MO.AGetter("_borderLayer"));a._cityRangeLayer=MO.Class.register(a,new MO.AGetter("_cityRangeLayer"));a._cityLayer=MO.Class.register(a,new MO.AGetter("_cityLayer"));a._dataLayer=MO.Class.register(a,new MO.AGetter("_dataLayer"));a._spriteLayer=MO.Class.register(a,
new MO.AGetter("_spriteLayer"));a.construct=MO.FEaiChartStage_construct;return a};
MO.FEaiChartStage_construct=function(){this.__base.FE3dStage.construct.call(this);var a=this._groundLayer=MO.Class.create(MO.FDisplayLayer);this.registerLayer("GroundLayer",a);a=this._mapLayer=MO.Class.create(MO.FDisplayLayer);a.setOptionClearDepth(!0);this.registerLayer("MapLayer",a);a=this._borderLayer=MO.Class.create(MO.FDisplayLayer);this.registerLayer("BorderLayer",a);a=this._cityRangeLayer=MO.Class.create(MO.FDisplayLayer);a.setOptionClearDepth(!0);this.registerLayer("CityRangeLayer",a);a=this._cityLayer=
MO.Class.create(MO.FDisplayLayer);a.setOptionClearDepth(!0);this.registerLayer("CityLayer",a);a=this._dataLayer=MO.Class.create(MO.FDisplayLayer);a.setOptionClearDepth(!0);this.registerLayer("DataLayer",a);a=this._spriteLayer=MO.Class.create(MO.FDisplayLayer);a.setOptionClearDepth(!0);this.registerLayer("SpriteLayer",a)};
MO.FEaiChartTotalScene=function(a){a=MO.RClass.inherits(this,a,MO.FEaiChartScene);a._optionMapCountry=!1;a._code=MO.EEaiScene.ChartTotal;a._currentDate=null;a._statusStart=!1;a._statusLayerCount=100;a._statusLayerLevel=100;a._chartTotal=null;a.onInvestment=MO.FEaiChartTotalScene_onInvestment;a.onProcess=MO.FEaiChartTotalScene_onProcess;a.construct=MO.FEaiChartTotalScene_construct;a.setup=MO.FEaiChartTotalScene_setup;a.testReady=MO.FEaiChartTotalScene_testReady;return a};
MO.FEaiChartTotalScene_onInvestment=function(a){this._chartTotal.setValue(parseInt(a.content.investment_total).toString())};
MO.FEaiChartTotalScene_onProcess=function(){this.__base.FEaiChartScene.onProcess.call(this);if(!this._statusStart&&this.testReady()){var a=document.getElementById("id_loading");a&&(a.style.opacity=this._statusLayerLevel/this._statusLayerCount,this._statusLayerLevel--);this._statusLayerLevel--;0==this._statusLayerLevel&&(a&&document.body.removeChild(a),this._statusStart=this._playing=!0)}this._playing&&(this._mapReady||(this._guiManager.show(),a=MO.Class.create(MO.FGuiActionAlpha),a.setAlphaBegin(0),
a.setAlphaEnd(1),a.setAlphaInterval(.01),a.push(this._guiManager),this._guiManager.mainTimeline().pushAction(a),this._mapReady=!0),this._dataTicker.process()&&(a=MO.Console.find(MO.FEaiLogicConsole).system(),a.testReady()&&(a=a.currentDate(),MO.Console.find(MO.FEaiLogicConsole).statistics().doInvestmentDynamic(this,this.onInvestment,a.format(),a.format()))),this._chartTotal.rolling()&&this._chartTotal.dirty())};
MO.FEaiChartTotalScene_construct=function(){this.__base.FEaiChartScene.construct.call(this);this._currentDate=new MO.TDate;this._dataTicker=new MO.TTicker(3E4)};MO.FEaiChartTotalScene_setup=function(){this.__base.FEaiChartScene.setup.call(this);this._guiManager.hide();var a=this._chartTotal=MO.Class.create(MO.FGuiChartTotal);a.setup();a.build();this._guiManager.register(a)};
MO.FEaiChartTotalScene_testReady=function(){if(!this._ready){if(!this._countryReady||!this._chartTotal.ready())return!1;this._ready=!0}return this._ready};
MO.FEaiChartWorldScene=function(a){a=MO.Class.inherits(this,a,MO.FEaiChartScene);a._code=MO.EEaiScene.ChartWorld;a._investment=MO.Class.register(a,new MO.AGetter("_investment"));a._investmentCurrent=0;a._ready=!1;a._mapReady=!1;a._playing=!1;a._lastTick=0;a._interval=10;a._24HLastTick=0;a._24HTrendInterval=3E5;a._logoBar=null;a._timeline=null;a._liveTable=null;a._livePop=null;a._statusStart=!1;a._statusLayerCount=100;a._statusLayerLevel=100;a._operationFlag=!1;a._operationPoint=null;a._operationRotationX=
0;a._operationRotationY=0;a._rotationX=0;a._rotationY=0;a._worldScale=500;a._groundAutioUrl="{eai.resource}/music/statistics.mp3";a.onInvestmentDataChanged=MO.FEaiChartWorldScene_onInvestmentDataChanged;a.onProcessReady=MO.FEaiChartWorldScene_onProcessReady;a.onProcess=MO.FEaiChartWorldScene_onProcess;a.onOperationDown=MO.FEaiChartWorldScene_onOperationDown;a.onOperationMove=MO.FEaiChartWorldScene_onOperationMove;a.onOperationUp=MO.FEaiChartWorldScene_onOperationUp;a.onOperationWheel=MO.FEaiChartWorldScene_onOperationWheel;
a.onSwitchProcess=MO.FEaiChartWorldScene_onSwitchProcess;a.onSwitchComplete=MO.FEaiChartWorldScene_onSwitchComplete;a.construct=MO.FEaiChartWorldScene_construct;a.setup=MO.FEaiChartWorldScene_setup;a.testReady=MO.FEaiChartWorldScene_testReady;a.showParticle=MO.FEaiChartWorldScene_showParticle;a.showFace=MO.FEaiChartWorldScene_showFace;a.fixMatrix=MO.FEaiChartWorldScene_fixMatrix;a.processResize=MO.FEaiChartWorldScene_processResize;return a};
MO.FEaiChartWorldScene_onInvestmentDataChanged=function(a){var b=a.entity,c=this._liveTable;c.setRank(a.rank);c.pushEntity(b);c.dirty();b&&this._livePop.setData(b)};MO.FEaiChartWorldScene_onProcessReady=function(){this.__base.FEaiChartScene.onProcessReady.call(this);this._mapEntity.showWorld()};
MO.FEaiChartWorldScene_onProcess=function(){this.__base.FEaiChartScene.onProcess.call(this);if(!this._statusStart&&this.testReady()){var a=document.getElementById("id_loading");a&&(a.style.opacity=this._statusLayerLevel/this._statusLayerCount,this._statusLayerLevel--);this._statusLayerLevel--;0>=this._statusLayerLevel&&(a&&document.body.removeChild(a),this.processLoaded(),this._statusStart=this._playing=!0)}if(this._playing){this._mapReady||(this._guiManager.show(),this._southSea.setVisible(!1),a=
MO.Class.create(MO.FGuiActionAlpha),a.setAlphaBegin(0),a.setAlphaEnd(1),a.setAlphaInterval(.01),a.push(this._guiManager),this._guiManager.mainTimeline().pushAction(a),this._mapReady=!0);a=MO.Timer.current();a-this._24HLastTick>this._24HTrendInterval&&(this._timeline.sync(),this._24HLastTick=a);this._investment.process();var a=this._logoBar,b=a.findComponent("investmentTotal"),c=this._investment.invementTotalCurrent();b.setValue(parseInt(c).toString());a=a.findComponent("investmentDay");b=this._investment.invementDayCurrent();
a.setValue(parseInt(b).toString());this._nowTicker.process()&&(a=this._logoBar,b=this._nowDate,b.setNow(),a.findComponent("date").setLabel(b.format("YYYY/MM/DD")),a.findComponent("time").setLabel(b.format("HH24:MI")));a=this._mapEntity;this.fixMatrix(a.countryFaceDisplay().matrix());this.fixMatrix(a.countryBorderDisplay().matrix())}this._livePop.visible()&&this._livePop.dirty()};
MO.FEaiChartWorldScene_onOperationDown=function(a){this._operationFlag=!0;this._operationRotationX=this._rotationX;this._operationRotationY=this._rotationY;this._operationPoint.set(a.x,a.y)};MO.FEaiChartWorldScene_onOperationMove=function(a){if(this._operationFlag){var b=a.x-this._operationPoint.x;this._rotationX=this._operationRotationX-.001*(a.y-this._operationPoint.y);this._rotationY=this._operationRotationY-.002*b}};MO.FEaiChartWorldScene_onOperationUp=function(a){this._operationFlag=!1};
MO.FEaiChartWorldScene_onOperationWheel=function(a){a=a.deltaY;0<a?this._worldScale/=1.05:0>a&&(this._worldScale*=1.05)};MO.FEaiChartWorldScene_onSwitchProcess=function(a){};MO.FEaiChartWorldScene_onSwitchComplete=function(a){};MO.FEaiChartWorldScene_construct=function(){this.__base.FEaiChartScene.construct.call(this);this._operationPoint=new MO.SPoint2};
MO.FEaiChartWorldScene_setup=function(){this.__base.FEaiChartScene.setup.call(this);var a=this._activeStage.dataLayer(),b=this._logoBar=MO.Console.find(MO.FGuiFrameConsole).get(this,"eai.chart.LogoBar");this._guiManager.register(b);b=this._investment=MO.Class.create(MO.FEaiStatisticsInvestment);b.linkGraphicContext(this);b.setMapEntity(this._mapEntity);b.setup();b.addDataChangedListener(this,this.onInvestmentDataChanged);b=b.display();this.fixMatrix(b.matrix());a.push(b);this.activeStage();a=this._timeline=
MO.Class.create(MO.FGui24HTimeline);a.setName("Timeline");a.linkGraphicContext(this);a.sync();a.build();this._guiManager.register(a);a=this._liveTable=MO.Class.create(MO.FGuiLiveTable);a.setName("LiveTable");a.linkGraphicContext(this);a.setup();a.build();this._guiManager.register(a);a=this._livePop=MO.Class.create(MO.FGuiLivePop);a.setName("LivePop");a.linkGraphicContext(this);a.setup();a.build();this._guiManager.register(a);this._guiManager.hide();a=MO.Class.create(MO.FE3dOrthoCamera);a.position().set(0,
0,-500);a.lookAt(0,0,0);a.update();b=a.projection();b.setZnear(1);b.setZfar(1E3);b.update();this._activeStage.region().selectCamera(a);a=this._worldEntity=MO.Console.find(MO.FEaiEntityConsole).mapModule().loadWorld(this);this._readyLoader.push(a)};MO.FEaiChartWorldScene_testReady=function(){return!0};
MO.FEaiChartWorldScene_showParticle=function(a,b){var c=this._particle,e=b.location();c.color().set(1,1,0,1);for(var d=0;4>d;d++){var f=parseInt(100*Math.random());Math.random();c.setItemCount(f);c.position().assign(e);c.position().z=a.currentZ();c.setDelay(10*d);c.setSpeed(4+.4*d);c.setAcceleration(0);c.setAttenuation(.8);c.start()}};MO.FEaiChartWorldScene_showFace=function(){this._playing=this._statusStart=!0;this._mapReady=!1;this._mapEntity.reset();this.processResize()};
MO.FEaiChartWorldScene_fixMatrix=function(a){MO.Window.Browser.isOrientationVertical()?(a.tx=-14.58,a.ty=-1.9,a.tz=0,a.setScale(.14,.16,.14)):(a.tx=-320,a.ty=0,a.tz=0,a.rx=this._rotationX,a.ry=this._rotationY,a.setScale(this._worldScale,this._worldScale,this._worldScale));a.update();this._rotationY+=.001};
MO.FEaiChartWorldScene_processResize=function(){this.__base.FEaiChartScene.processResize.call(this);var a=MO.Window.Browser.isOrientationVertical();this.fixMatrix(this._investment.display().matrix());var b=this._logoBar;a?(b.setLocation(8,8),b.setScale(.85,.85)):(b.setLocation(5,5),b.setScale(1,1));b=this._southSea;a?(b.setDockCd(MO.EUiDock.RightTop),b.setTop(570),b.setRight(100)):(b.setDockCd(MO.EUiDock.RightBottom),b.setRight(710),b.setBottom(260));b=this._timeline;a?(b.setDockCd(MO.EUiDock.Bottom),
b.setAnchorCd(MO.EUiAnchor.Left|MO.EUiAnchor.Right),b.setLeft(10),b.setRight(10),b.setBottom(920)):(b.setDockCd(MO.EUiDock.Bottom),b.setAnchorCd(MO.EUiAnchor.Left|MO.EUiAnchor.Right),b.setLeft(20),b.setBottom(30),b.setRight(680));b.setHeight(250);b=this._liveTable;a?(b.setDockCd(MO.EUiDock.Bottom),b.setAnchorCd(MO.EUiAnchor.Left|MO.EUiAnchor.Top|MO.EUiAnchor.Right),b.setLeft(10),b.setRight(10),b.setBottom(10),b.setWidth(1060),b.setHeight(900)):(b.setDockCd(MO.EUiDock.Right),b.setAnchorCd(MO.EUiAnchor.Left|
MO.EUiAnchor.Top|MO.EUiAnchor.Bottom),b.setTop(10),b.setRight(0),b.setBottom(10),b.setWidth(650))};MO.FEaiCompanyScene=function(a){a=MO.RClass.inherits(this,a,MO.FEaiScene);a._code=MO.EEaiScene.Company;return a};
MO.FEaiCountryScene=function(a){a=MO.RClass.inherits(this,a,MO.FEaiScene);a._code=MO.EEaiScene.Country;a._countryTemplate=null;a._countryLogoBar=null;a.onTemplateLoad=MO.FEaiCountryScene_onTemplateLoad;a.setup=MO.FEaiCountryScene_setup;a.active=MO.FEaiCountryScene_active;a.deactive=MO.FEaiCountryScene_deactive;return a};MO.FEaiCountryScene_onTemplateLoad=function(a){a=this._countryTemplate.sprite().matrix();a.tx=-4;a.ty=-3;a.rx=-Math.PI/2;a.updateForce();MO.Eai.Canvas.activeStage()};
MO.FEaiCountryScene_setup=function(){this.__base.FEaiScene.setup.call(this);var a=this._countryLogoBar=MO.RConsole.find(MO.FGuiFrameConsole).get(MO.Eai.Canvas,"eai.country.LogoBar");this.registerFrame(a)};MO.FEaiCountryScene_active=function(){this.__base.FEaiScene.active.call(this)};MO.FEaiCountryScene_deactive=function(){this.__base.FEaiScene.deactive.call(this);MO.Eai.Canvas.activeStage().faceLayer().removeRenderable(this._countryLogoBar.renderable())};
MO.FEaiGroupReportScene=function(a){a=MO.RClass.inherits(this,a,MO.FEaiScene);a._code=MO.EEaiScene.GroupReport;return a};MO.FEaiGroupScene=function(a){a=MO.RClass.inherits(this,a,MO.FEaiScene);a._code=MO.EEaiScene.Group;return a};
MO.FEaiScene=function(a){a=MO.Class.inherits(this,a,MO.FScene);a._guiManager=MO.Class.register(a,new MO.AGetter("_guiManager"));a.onOperationKeyDown=MO.FEaiScene_onOperationKeyDown;a.onOperationResize=MO.FEaiScene_onOperationResize;a.onOperationOrientation=MO.FEaiScene_onOperationOrientation;a.onProcessAfter=MO.FEaiScene_onProcessAfter;a.construct=MO.FEaiScene_construct;a.setup=MO.FEaiScene_setup;a.active=MO.FEaiScene_active;a.deactive=MO.FEaiScene_deactive;a.processLoaded=MO.FEaiScene_processLoaded;
a.processResize=MO.FEaiScene_processResize;a.processEvent=MO.FEaiScene_processEvent;a.dispose=MO.FEaiScene_dispose;return a};MO.FEaiScene_onOperationKeyDown=function(a){this.__base.FScene.onOperationKeyDown.call(this,a);a.altKey&&a.keyCode==MO.EKeyCode.P&&(a=this._application.dynamicInfo(),a.setVisible(!a.visible()))};MO.FEaiScene_onOperationResize=function(a){this.__base.FScene.onOperationResize.call(this,a);this.processResize()};
MO.FEaiScene_onOperationOrientation=function(a){this.__base.FScene.onOperationOrientation.call(this,a);this.processResize()};MO.FEaiScene_onProcessAfter=function(){this.__base.FScene.onProcessAfter.call(this);this._guiManager.process()};MO.FEaiScene_construct=function(){this.__base.FScene.construct.call(this)};
MO.FEaiScene_setup=function(){this.__base.FScene.setup.call(this);var a=this._application.desktop(),b=a.canvas2d();a.hide();var c=this._guiManager=MO.Class.create(MO.FGuiCanvasManager);c.linkGraphicContext(this);c.setDesktop(a);c.setCanvas(b);c.setup();a=this._application.dynamicInfo();c.register(a)};
MO.FEaiScene_active=function(){this.__base.FScene.active.call(this);var a=this._activeStage,b=this._application.dynamicInfo();b.setVisible(!1);b.setDisplayOrder(1E4);b.setStage(a);b.setGuiManager(this._guiManager);this._application.desktop().selectStage(a)};MO.FEaiScene_deactive=function(){this.__base.FScene.deactive.call(this);this._application.desktop().selectStage(null)};MO.FEaiScene_processLoaded=function(){var a=new MO.SEvent(this);MO.Window.lsnsLoaded.process(a);a.dispose();this._application.desktop().show()};
MO.FEaiScene_processResize=function(a){this._guiManager.dirty()};MO.FEaiScene_processEvent=function(a){this.__base.FScene.processEvent.call(this,a);this._guiManager.processEvent(a)};MO.FEaiScene_dispose=function(){this._guiManager=MO.RObject.dispose(this._guiManager);this.__base.FScene.dispose.call(this)};
MO.FEaiChartHistoryScene=function(a){a=MO.RClass.inherits(this,a,MO.FEaiChartScene);a._code=MO.EEaiScene.ChartHistory;a._ready=!1;a._mapReady=!1;a._dataReady=!1;a._playing=!1;a._lastTick=0;a._interval=10;a._lastDateTick=0;a._dateInterval=120;a._startDate=null;a._endDate=null;a._currentDate=null;a._logoBar=null;a._buttonTransform=null;a._timeline=null;a._milestoneFrame=null;a._statusStart=!1;a._statusLayerCount=100;a._statusLayerLevel=100;a._milestoneBars=null;a._milestoneShowed=0;a._milestoneBarShowDuration=
1E3;a._milestoneBarShowTick=0;a._milestoneBarShowing=!1;a.onLoadData=MO.FEaiChartHistoryScene_onLoadData;a.onDateSelect=MO.FEaiChartHistoryScene_onDateSelect;a.onMilestoneDone=MO.FEaiChartHistoryScene_onMilestoneDone;a.onOperationPlay=MO.FEaiChartHistoryScene_onOperationPlay;a.onOperationPause=MO.FEaiChartHistoryScene_onOperationPause;a.onOperationVisibility=MO.FEaiChartHistoryScene_onOperationVisibility;a.onProcessReady=MO.FEaiChartHistoryScene_onProcessReady;a.onProcess=MO.FEaiChartHistoryScene_onProcess;
a.onSwitchLiveComplete=MO.FEaiChartHistoryScene_onSwitchLiveComplete;a.testReady=MO.FEaiChartHistoryScene_testReady;a.setup=MO.FEaiChartHistoryScene_setup;a.resetDate=MO.FEaiChartHistoryScene_resetDate;a.selectDate=MO.FEaiChartHistoryScene_selectDate;a.switchPlay=MO.FEaiChartHistoryScene_switchPlay;a.switchLive=MO.FEaiChartHistoryScene_switchLive;a.processResize=MO.FEaiChartHistoryScene_processResize;return a};
MO.FEaiChartHistoryScene_onLoadData=function(a){a=MO.Console.find(MO.FEaiResourceConsole).historyModule();var b=a.dates().first(),c=a.dates().last();this._currentDate.parseAuto(b.code());this._startDate.parseAuto(b.code());this._endDate.parseAuto(c.code());a=a.milestones();for(var b=this._milestoneBars=new MO.TObjects,c=a.count(),e=c-1;0<=e;e--){var d=a.at(c-e-1),f=MO.RClass.create(MO.FGuiHistoryMilestoneBar);f.linkGraphicContext(this);f.setName("MilestoneBar_"+e);f.setVisible(!1);f.setDockCd(MO.EUiDock.Right);
f.setTop(90+100*e);1E4<=d.investmentTotal()?f.setRight(-371):f.setRight(-341);f.setup(d);f.build();this._guiManager.register(f);b.push(f)}this._dataReady=!0};MO.FEaiChartHistoryScene_onDateSelect=function(a){this._currentDate.date.setTime(a.date.date.getTime());this._currentDate.refresh();this.selectDate(this._currentDate.format("YYYYMMDD"))};
MO.FEaiChartHistoryScene_onMilestoneDone=function(a){this.switchPlay(!0);this._milestoneShowed++;this._milestoneBarShowTick=MO.Timer.current();this._milestoneBarShowing=!0};MO.FEaiChartHistoryScene_onOperationPlay=function(a){a=this._currentDate.format("YYYYMMDD");var b=this._endDate.format("YYYYMMDD");a==b&&(a=MO.Console.find(MO.FEaiResourceConsole).historyConsole().dates().first(),MO.Lang.Date.autoParse(this._currentDate,a.code()));this.switchPlay(!0)};
MO.FEaiChartHistoryScene_onOperationPause=function(a){this.switchPlay(!1)};MO.FEaiChartHistoryScene_onOperationVisibility=function(a){this.__base.FEaiChartScene.onOperationVisibility.call(this,a);a.visibility?(this._groundAutio.play(),this._countryEntity._audioMapEnter._hAudio.muted=!1):(this._groundAutio.pause(),this._countryEntity._audioMapEnter._hAudio.muted=!0)};MO.FEaiChartHistoryScene_onProcessReady=function(){this.__base.FEaiChartScene.onProcessReady.call(this);this._mapEntity.showCity()};
MO.FEaiChartHistoryScene_onProcess=function(){this.__base.FEaiChartScene.onProcess.call(this);var a=this._countryEntity,b=this._mapEntity;if(!this._statusStart&&this.testReady()){var c=document.getElementById("id_loading");c&&(c.style.opacity=this._statusLayerLevel/this._statusLayerCount,this._statusLayerLevel--);this._statusLayerLevel--;0==this._statusLayerLevel&&(c&&document.body.removeChild(c),a.start(),this._mapEntity.showCountry(a),this.switchPlay(!0),this.processLoaded(),this._statusStart=!0)}c=
MO.Timer.current();this._playing&&(a.introAnimeDone()||a.process(),this._mapReady||(b.cityRangeRenderable().setVisible(!0),b.cityCenterRenderable().setVisible(!0),this._guiManager.show(),this._milestoneFrame.setVisible(!1),a=MO.Class.create(MO.FGuiActionAlpha),a.setAlphaBegin(0),a.setAlphaEnd(1),a.setAlphaInterval(.005),a.push(this._guiManager),this._guiManager.mainTimeline().pushAction(a),this._mapReady=!0),c-this._lastTick>this._interval&&(c-this._lastDateTick>this._dateInterval&&(this._currentDate.addDay(1),
a=this._currentDate.format("YYYYMMDD"),b=this._endDate.format("YYYYMMDD"),this.selectDate(a),a==b&&(this.switchPlay(!1),this.switchLive()),this._lastDateTick=c,this._mapEntity.upload()),this._timeline.setProgress((c-this._lastDateTick)/this._dateInterval),this._timeline.dirty(),this._lastTick=c));this._milestoneBarShowing&&(c=(c-this._milestoneBarShowTick)/this._milestoneBarShowDuration,1<c&&(c=1,this._milestoneBarShowing=!1),c=(1-c)*(1-c),a=this._milestoneBars.at(this._milestoneShowed-1),1E4<=a.data().investmentTotal()?
a.setRight(20+-371*c):a.setRight(20+-341*c),a.dirty());this._milestoneFrame.visible()&&this._milestoneFrame.dirty()};MO.FEaiChartHistoryScene_onSwitchLiveComplete=function(a){this._chapter.selectSceneByCode(MO.EEaiScene.ChartLive).showFace()};MO.FEaiChartHistoryScene_testReady=function(){if(!this._ready){if(!this._dataReady)return!1;this._ready=!0}return this._ready};
MO.FEaiChartHistoryScene_setup=function(){this.__base.FEaiChartScene.setup.call(this);this._currentDate=new MO.TDate;this._startDate=new MO.TDate;this._endDate=new MO.TDate;var a=this._groundAutio;a.pause();a=this._groundAutio=MO.Console.find(MO.FAudioConsole).load("{eai.resource}/historyBGM.mp3");a.setLoop(!0);a.setVolume(.2);a.play();a=this._mapEntity;a.cityRangeRenderable().setVisible(!1);a.cityCenterRenderable().setVisible(!1);a=this._logoBar=MO.RConsole.find(MO.FGuiFrameConsole).get(this,"eai.history.LogoBar");
a.setLocation(5,5);this._guiManager.register(a);this._logoBar.findComponent("investment").setNoRolling(!0);a=this._buttonTransform=MO.Class.create(MO.FGuiChangeTransform);a.setInterval(10);a.setScale(.1);this.activeStage();a=this._timeline=MO.Class.create(MO.FGuiHistoryTimeline);a.linkGraphicContext(this);a.setName("Timeline");a.setDockCd(MO.EUiDock.Bottom);a.setAnchorCd(MO.EUiAnchor.Left|MO.EUiAnchor.Right);a.setLeft(50);a.setRight(450);a.setBottom(5);a.setHeight(600);a.setTimeUnit(MO.EUiTimeUnit.Month);
a.setStartTime(this._startDate);a.setEndTime(this._endDate);a.setDegreeTime(this._currentDate);a.addDataChangedListener(this,this.onDateSelect);a.build();this._guiManager.register(a);a=this._milestoneFrame=MO.RClass.create(MO.FGuiHistoryMilestoneFrame);a.linkGraphicContext(this);a.setName("MilestoneFrame");a.addDataChangedListener(this,this.onMilestoneDone);a.setup();a.build();this._guiManager.register(a);MO.Console.find(MO.FImageConsole);a=MO.RClass.create(MO.FGuiPicture);a.linkGraphicContext(this);
a.setName("MilestoneBG_Top");a.setDockCd(MO.EUiDock.RightTop);a.setWidth(468);a.setHeight(464);a._displayOrder=-1;a._backResource="url:/script/ars/eai/milestone/bar_bg_top.png";a.psInitialize();a.build();this._guiManager.register(a);a=MO.RClass.create(MO.FGuiPicture);a.linkGraphicContext(this);a.setName("MilestoneBG_Bottom");a.setDockCd(MO.EUiDock.RightBottom);a.setWidth(468);a.setHeight(464);a._displayOrder=-1;a._backResource="url:/script/ars/eai/milestone/bar_bg_bottom.png";a.psInitialize();a.build();
this._guiManager.register(a);this._guiManager.hide();a=MO.Console.find(MO.FEaiEntityConsole);a.cityModule().build(this);a=this._countryEntity=a.mapModule().loadCountry(this,MO.EEaiConstant.DefaultCountry);this._readyLoader.push(a);a=MO.Console.find(MO.FEaiResourceConsole).historyModule();a.addLoadListener(this,this.onLoadData);a.load()};MO.FEaiChartHistoryScene_resetDate=function(){for(var a=MO.Console.find(MO.FEaiEntityConsole).cityModule().citys(),b=a.count(),c=0;c<b;c++)a.at(c).reset()};
MO.FEaiChartHistoryScene_selectDate=function(a){var b=MO.Console.find(MO.FEaiResourceConsole).historyModule(),c=b.dates().get(a);if(b=b.milestones().get(a))this._milestoneFrame.setData(b),this._milestoneFrame.show(),this._milestoneFrame.dirty(),this.switchPlay(!1);if(c){this._timeline.setDegreeTime(this._currentDate);this._timeline.dirty();for(var b=c.citys(),e=MO.Console.find(MO.FEaiEntityConsole).cityModule().citys(),d=e.count(),f=0;f<d;f++){var g=e.at(f),h=g.data().code(),h=b.get(h);g.update(h)}this._logoBar.findComponent("date").setValue(a);
this._logoBar.findComponent("investment").setValue(parseInt(c.investmentTotal()).toString())}};MO.FEaiChartHistoryScene_switchPlay=function(a){this._playing=a};MO.FEaiChartHistoryScene_switchLive=function(){var a=MO.Class.create(MO.FGuiActionAlpha);a.setAlphaBegin(1);a.setAlphaEnd(0);a.setAlphaInterval(-.005);a.addCompleteListener(this,this.onSwitchLiveComplete);a.push(this._guiManager);this._guiManager.mainTimeline().pushAction(a)};
MO.FEaiChartHistoryScene_processResize=function(){this.__base.FEaiChartScene.processResize.call(this);var a=this._southSea;a.setDockCd(MO.EUiDock.RightBottom);a.setRight(520);a.setBottom(180)};
MO.FEaiChartCustomerDynamicInfo=function(a){a=MO.Class.inherits(this,a,MO.FObject,MO.MPersistence);a._investmentCount=MO.Class.register(a,[new MO.AGetter("_investmentCount"),new MO.APersistence("_investmentCount",MO.EDataType.Double)]);a._investmentTotal=MO.Class.register(a,[new MO.AGetter("_investmentTotal"),new MO.APersistence("_investmentTotal",MO.EDataType.Double)]);a._customerCount=MO.Class.register(a,[new MO.AGetter("_customerCount"),new MO.APersistence("_customerCount",MO.EDataType.Int32)]);
a._customerTotal=MO.Class.register(a,[new MO.AGetter("_customerTotal"),new MO.APersistence("_customerTotal",MO.EDataType.Int32)]);a._rankUnits=MO.Class.register(a,[new MO.AGetter("_rankUnits"),new MO.APersistence("_rankUnits",MO.EDataType.Objects,MO.FEaiChartCustomerDynamicRankUnit)]);a._units=MO.Class.register(a,[new MO.AGetter("_units"),new MO.APersistence("_units",MO.EDataType.Objects,MO.FEaiChartCustomerDynamicUnit)]);return a};
MO.FEaiChartCustomerDynamicRankUnit=function(a){a=MO.Class.inherits(this,a,MO.FObject,MO.MPersistence);a._label=MO.Class.register(a,[new MO.AGetter("_label"),new MO.APersistence("_label",MO.EDataType.String)]);a._card=MO.Class.register(a,[new MO.AGetter("_card"),new MO.APersistence("_card",MO.EDataType.String)]);a._phone=MO.Class.register(a,[new MO.AGetter("_phone"),new MO.APersistence("_phone",MO.EDataType.String)]);a._investment=MO.Class.register(a,[new MO.AGetter("_investment"),new MO.APersistence("_investment",
MO.EDataType.Double)]);return a};
MO.FEaiChartCustomerDynamicUnit=function(a){a=MO.Class.inherits(this,a,MO.FObject,MO.MPersistence);a._recordDate=MO.Class.register(a,[new MO.AGetter("_recordDate"),new MO.APersistence("_recordDate",MO.EDataType.String)]);a._label=MO.Class.register(a,[new MO.AGetter("_label"),new MO.APersistence("_label",MO.EDataType.String)]);a._card=MO.Class.register(a,[new MO.AGetter("_card"),new MO.APersistence("_card",MO.EDataType.String)]);a._phone=MO.Class.register(a,[new MO.AGetter("_phone"),new MO.APersistence("_phone",
MO.EDataType.String)]);a._investment=MO.Class.register(a,[new MO.AGetter("_investment"),new MO.APersistence("_investment",MO.EDataType.Double)]);return a};
MO.FEaiChartCustomerProcessor=function(a){a=MO.Class.inherits(this,a,MO.FObject,MO.MGraphicObject,MO.MListener);a._dateSetup=!1;a._beginDate=MO.Class.register(a,new MO.AGetter("_beginDate"));a._endDate=MO.Class.register(a,new MO.AGetter("_endDate"));a._invementDayCurrent=MO.Class.register(a,new MO.AGetter("_invementDayCurrent"),0);a._redemptionDayCurrent=MO.Class.register(a,new MO.AGetter("_redemptionDayCurrent"),0);a._netinvestmentDayCurrent=MO.Class.register(a,new MO.AGetter("_netinvestmentDayCurrent"),
0);a._interestDayCurrent=MO.Class.register(a,new MO.AGetter("_interestDayCurrent"),0);a._performanceDayCurrent=MO.Class.register(a,new MO.AGetter("_performanceDayCurrent"),0);a._customerDayCurrent=MO.Class.register(a,new MO.AGetter("_customerDayCurrent"),0);a._invementDay=MO.Class.register(a,new MO.AGetter("_invementDay"),0);a._invementTotalCurrent=MO.Class.register(a,new MO.AGetter("_invementTotalCurrent"),0);a._invementTotal=MO.Class.register(a,new MO.AGetter("_invementTotal"),0);a._dynamicInfo=
MO.Class.register(a,new MO.AGetter("_dynamicInfo"));a._intervalMinute=1;a._mapEntity=MO.Class.register(a,new MO.AGetSet("_mapEntity"));a._display=MO.Class.register(a,new MO.AGetter("_display"));a._rankUnits=MO.Class.register(a,new MO.AGetter("_rankUnits"));a._units=MO.Class.register(a,new MO.AGetter("_units"));a._tableCount=40;a._tableInterval=1E3;a._tableTick=1;a._dataTicker=null;a._unitPool=null;a._autios=null;a._eventDataChanged=null;a._listenersDataChanged=MO.Class.register(a,new MO.AListener("_listenersDataChanged",
MO.EEvent.DataChanged));a.onDynamicData=MO.FEaiChartCustomerProcessor_onDynamicData;a.construct=MO.FEaiChartCustomerProcessor_construct;a.allocUnit=MO.FEaiChartCustomerProcessor_allocUnit;a.allocShape=MO.FEaiChartCustomerProcessor_allocShape;a.setup=MO.FEaiChartCustomerProcessor_setup;a.calculateCurrent=MO.FEaiChartCustomerProcessor_calculateCurrent;a.focusEntity=MO.FEaiChartCustomerProcessor_focusEntity;a.process=MO.FEaiChartCustomerProcessor_process;a.dispose=MO.FEaiChartCustomerProcessor_dispose;
return a};MO.FEaiChartCustomerProcessor_onDynamicData=function(a){var b=this._dynamicInfo;b.unserializeSignBuffer(a.sign,a.content,!0);a=this._rankUnits;a.assign(b.rankUnits());var c=this._units;c.append(b.units());this._tableInterval=(b=c.count())?6E4*this._intervalMinute/b:6E4*this._intervalMinute;this._tableTick=0;b=this._eventDataChanged;b.rankUnits=a;b.unit=null;this.processDataChangedListener(b)};
MO.FEaiChartCustomerProcessor_construct=function(){this.__base.FObject.construct.call(this);this._beginDate=new MO.TDate;this._endDate=new MO.TDate;this._units=new MO.TObjects;this._tableTicker=new MO.TTicker(1E3*this._tableInterval);this._autios={};this._dataTicker=new MO.TTicker(6E4*this._intervalMinute);this._dynamicInfo=MO.Class.create(MO.FEaiChartCustomerDynamicInfo);this._rankUnits=new MO.TObjects;this._unitPool=MO.Class.create(MO.FObjectPool);this._eventDataChanged=new MO.SEvent(this)};
MO.FEaiChartCustomerProcessor_allocUnit=function(){var a=this._unitPool.alloc();a||(a=MO.Class.create(MO.FEaiChartCustomerDynamicUnit));return a};MO.FEaiChartCustomerProcessor_setup=function(){for(var a=MO.Console.find(MO.FAudioConsole),b=1;5>=b;b++)this._autios[b]=a.load("{eai.resource}/currency/"+b+".mp3");(this._display=MO.Class.create(MO.FE3dDisplay)).linkGraphicContext(this)};
MO.FEaiChartCustomerProcessor_calculateCurrent=function(){for(var a=this._dynamicInfo,b=a.investmentCount(),a=a.investmentTotal(),c=this._units,e=c.count(),d=0;d<e;d++)var f=c.at(d),b=b-f.investment(),a=a+f.investment();this._invementTotalCurrent=a;this._invementDayCurrent=b};
MO.FEaiChartCustomerProcessor_focusEntity=function(a){var b=a.card();if(b=MO.Console.find(MO.FEaiEntityConsole).cityModule().findByCard(b)){var c=a.investment(),e=MO.Console.find(MO.FEaiLogicConsole).statistics().calculateAmountLevel(c),d=b.data().provinceCode();(d=MO.Console.find(MO.FEaiEntityConsole).provinceModule().findByCode(d))&&d.doInvestment(e,c);b.addInvestmentTotal(e,c);this._mapEntity.upload();(b=this._autios[e])&&b.play(0)}b=this._eventDataChanged;b.rankUnits=this._rankUnits;b.unit=a;
this.processDataChangedListener(b)};
MO.FEaiChartCustomerProcessor_process=function(){var a=MO.Console.find(MO.FEaiLogicConsole).system();if(a.testReady()){a=a.currentDate();a.truncMinute();this._dateSetup||(this._endDate.assign(a),this._endDate.addMinute(-this._intervalMinute),this._dateSetup=!0);if(this._dataTicker.process()){var b=MO.Console.find(MO.FEaiLogicConsole).statistics(),c=this._beginDate,e=this._endDate;c.assign(e);e.assign(a);b.doCustomerDynamic(this,this.onDynamicData,c.format(),e.format());c.assign(e)}a=MO.Timer.current();
a-this._tableTick>this._tableInterval&&(b=this._units,b.isEmpty()||(b=b.shift(),this.focusEntity(b)),this.calculateCurrent(),this._tableTick=a);this._mapEntity.process();a=MO.Desktop.application().dynamicInfo();a._investmentEntityCount=this._units.count();a._investmentPoolItemCount=this._unitPool.items().count();a._investmentPoolFreeCount=this._unitPool.frees().count()}};
MO.FEaiChartCustomerProcessor_dispose=function(){this._units=MO.Lang.Object.dispose(this._units);this._dataTicker=MO.Lang.Object.dispose(this._dataTicker);this._eventDataChanged=MO.Lang.Object.dispose(this._eventDataChanged);this.__base.FObject.dispose.call(this)};
MO.FEaiChartCustomerScene=function(a){a=MO.RClass.inherits(this,a,MO.FEaiChartScene);a._code=MO.EEaiScene.ChartCustomer;a._processor=MO.Class.register(a,new MO.AGetter("_processor"));a._processorCurrent=0;a._ready=!1;a._mapReady=!1;a._playing=!1;a._lastTick=0;a._interval=10;a._24HLastTick=0;a._24HTrendInterval=3E5;a._logoBar=null;a._timeline=null;a._liveTable=null;a._statusStart=!1;a._statusLayerCount=100;a._statusLayerLevel=100;a.onInvestmentDataChanged=MO.FEaiChartCustomerScene_onInvestmentDataChanged;
a.onOperationVisibility=MO.FEaiChartCustomerScene_onOperationVisibility;a.onProcessReady=MO.FEaiChartCustomerScene_onProcessReady;a.onProcess=MO.FEaiChartCustomerScene_onProcess;a.onSwitchProcess=MO.FEaiChartCustomerScene_onSwitchProcess;a.onSwitchComplete=MO.FEaiChartCustomerScene_onSwitchComplete;a.setup=MO.FEaiChartCustomerScene_setup;a.showParticle=MO.FEaiChartCustomerScene_showParticle;a.showFace=MO.FEaiChartCustomerScene_showFace;a.fixMatrix=MO.FEaiChartCustomerScene_fixMatrix;a.processResize=
MO.FEaiChartCustomerScene_processResize;return a};MO.FEaiChartCustomerScene_onInvestmentDataChanged=function(a){var b=a.unit,c=this._liveTable;c.setRankUnits(a.rankUnits);c.pushUnit(b);c.dirty()};MO.FEaiChartCustomerScene_onOperationVisibility=function(a){this.__base.FEaiChartScene.onOperationVisibility.call(this,a);a.visibility?(this._groundAutio.play(),this._countryEntity._audioMapEnter._hAudio.muted=!1):(this._groundAutio.pause(),this._countryEntity._audioMapEnter._hAudio.muted=!0)};
MO.FEaiChartCustomerScene_onProcessReady=function(){this.__base.FEaiChartScene.onProcessReady.call(this);this._mapEntity.showCity()};
MO.FEaiChartCustomerScene_onProcess=function(){this.__base.FEaiChartScene.onProcess.call(this);if(!this._statusStart){if(MO.Window.Browser.capability().soundConfirm){var a=document.getElementById("id_ios_play");a&&MO.Window.Html.visibleSet(a,!0);(a=document.getElementById("id_loading"))&&document.body.removeChild(a)}else{if(a=document.getElementById("id_loading"))a.style.opacity=this._statusLayerLevel/this._statusLayerCount,this._statusLayerLevel--;this._statusLayerLevel--}0>=this._statusLayerLevel&&
(a&&document.body.removeChild(a),a=this._countryEntity,a.start(),this._mapEntity.showCountry(a),this.processLoaded(),this._statusStart=this._playing=!0)}if(this._playing){a=this._countryEntity;a.introAnimeDone()||a.process();this._mapReady||(this._guiManager.show(),a=MO.Class.create(MO.FGuiActionAlpha),a.setAlphaBegin(0),a.setAlphaEnd(1),a.setAlphaInterval(.01),a.push(this._guiManager),this._guiManager.mainTimeline().pushAction(a),this._mapReady=!0);a=MO.Timer.current();a-this._24HLastTick>this._24HTrendInterval&&
(this._timeline.sync(),this._24HLastTick=a);this._processor.process();var a=this._logoBar,b=this._processor;0<b.invementDayCurrent()&&(a.findComponent("investmentTotal").setValue(parseInt(b.invementTotalCurrent()).toString()),a.findComponent("investmentDay").setValue(parseInt(b.invementDayCurrent()).toString()));this._nowTicker.process()&&(a=this._logoBar,b=this._nowDate,b.setNow(),a.findComponent("date").setLabel(b.format("YYYY/MM/DD")),a.findComponent("time").setLabel(b.format("HH24:MI")))}};
MO.FEaiChartCustomerScene_onSwitchProcess=function(a){};MO.FEaiChartCustomerScene_onSwitchComplete=function(a){};
MO.FEaiChartCustomerScene_setup=function(){this.__base.FEaiChartScene.setup.call(this);var a=this._activeStage.dataLayer(),b=this._logoBar=MO.Console.find(MO.FGuiFrameConsole).get(this,"eai.chart.customer.LogoBar");this._guiManager.register(b);b=this._processor=MO.Class.create(MO.FEaiChartCustomerProcessor);b.linkGraphicContext(this);b.setMapEntity(this._mapEntity);b.setup();b.addDataChangedListener(this,this.onInvestmentDataChanged);b=b.display();this.fixMatrix(b.matrix());a.push(b);this.activeStage();
a=this._timeline=MO.Class.create(MO.FEaiChartCustomerTimeline);a.setName("Timeline");a.linkGraphicContext(this);a.sync();a.build();this._guiManager.register(a);a=this._liveTable=MO.Class.create(MO.FEaiChartCustomerTable);a.setName("LiveTable");a.linkGraphicContext(this);a.setup();a.build();this._guiManager.register(a);this._guiManager.hide();a=MO.Console.find(MO.FEaiEntityConsole);a.cityModule().build(this);a=this._countryEntity=a.mapModule().loadCountry(this,MO.EEaiConstant.DefaultCountry);this._readyLoader.push(a)};
MO.FEaiChartCustomerScene_showParticle=function(a,b){var c=this._particle,e=b.location();c.color().set(1,1,0,1);for(var d=0;4>d;d++){var f=parseInt(100*Math.random());Math.random();c.setItemCount(f);c.position().assign(e);c.position().z=a.currentZ();c.setDelay(10*d);c.setSpeed(4+.4*d);c.setAcceleration(0);c.setAttenuation(.8);c.start()}};MO.FEaiChartCustomerScene_showFace=function(){this._playing=this._statusStart=!0;this._mapReady=!1;this._mapEntity.reset();this._application.desktop().show();this.processResize()};
MO.FEaiChartCustomerScene_fixMatrix=function(a){MO.Window.Browser.isOrientationVertical()?(a.tx=-14.58,a.ty=-1.9,a.tz=0,a.setScale(.14,.16,.14)):(a.tx=-34.8,a.ty=-11,a.tz=0,a.setScale(.28,.31,.28));a.update()};
MO.FEaiChartCustomerScene_processResize=function(){this.__base.FEaiChartScene.processResize.call(this);var a=MO.Window.Browser.isOrientationVertical();this.fixMatrix(this._processor.display().matrix());var b=this._logoBar;a?(b.setLocation(8,8),b.setScale(.85,.85)):(b.setLocation(5,5),b.setScale(.9,.9));b=this._southSea;a?(b.setDockCd(MO.EUiDock.RightTop),b.setTop(570),b.setRight(100)):(b.setDockCd(MO.EUiDock.RightBottom),b.setRight(780),b.setBottom(260));b=this._timeline;a?(b.setDockCd(MO.EUiDock.Bottom),
b.setAnchorCd(MO.EUiAnchor.Left|MO.EUiAnchor.Right),b.setLeft(10),b.setRight(10),b.setBottom(920)):(b.setDockCd(MO.EUiDock.Bottom),b.setAnchorCd(MO.EUiAnchor.Left|MO.EUiAnchor.Right),b.setLeft(20),b.setBottom(30),b.setRight(780));b.setHeight(250);b=this._liveTable;a?(b.setDockCd(MO.EUiDock.Bottom),b.setAnchorCd(MO.EUiAnchor.Left|MO.EUiAnchor.Top|MO.EUiAnchor.Right),b.setLeft(10),b.setRight(10),b.setBottom(10),b.setWidth(1060),b.setHeight(900)):(b.setDockCd(MO.EUiDock.Right),b.setAnchorCd(MO.EUiAnchor.Left|
MO.EUiAnchor.Top|MO.EUiAnchor.Bottom),b.setTop(10),b.setRight(0),b.setBottom(10),b.setWidth(750))};
MO.FEaiChartCustomerTable=function(a){a=MO.Class.inherits(this,a,MO.FGuiControl);a._currentDate=null;a._rank=MO.Class.register(a,new MO.AGetter("_rank"));a._rankLogoImage=null;a._rankTitleImage=null;a._rankLineImage=null;a._rankLinePadding=null;a._rank1Image=null;a._rank2Image=null;a._rank3Image=null;a._backgroundImage=null;a._backgroundPadding=null;a._tableCount=0;a._units=null;a._lineScroll=0;a._listenersDataChanged=MO.Class.register(a,new MO.AListener("_listenersDataChanged",MO.EEvent.DataChanged));
a.onImageLoad=MO.FEaiChartCustomerTable_onImageLoad;a.onPaintBegin=MO.FEaiChartCustomerTable_onPaintBegin;a.construct=MO.FEaiChartCustomerTable_construct;a.setup=MO.FEaiChartCustomerTable_setup;a.setRankUnits=MO.FEaiChartCustomerTable_setRankUnits;a.pushUnit=MO.FEaiChartCustomerTable_pushUnit;a.drawRow=MO.FEaiChartCustomerTable_drawRow;a.dispose=MO.FEaiChartCustomerTable_dispose;return a};MO.FEaiChartCustomerTable_onImageLoad=function(){this.dirty()};
MO.FEaiChartCustomerTable_onPaintBegin=function(a){this.__base.FGuiControl.onPaintBegin.call(this,a);var b=a.graphic,c=a.rectangle,e=c.left,d=c.top,f=c.width;a=e+12;var g=e+f-e;b.drawGridImage(this._backgroundImage,e,d,f,c.height,this._backgroundPadding);b.setFont(this._headFontStyle);c=b.textWidth("\u5168\u7403\u5b9e\u65f6\u6295\u8d44\u6570\u636e\u5c55\u793a\u4e2d\u5fc3(\u4e2d\u56fd)");b.drawText("\u5168\u7403\u5b9e\u65f6\u6295\u8d44\u6570\u636e\u5c55\u793a\u4e2d\u5fc3(\u4e2d\u56fd)",e+.5*(f-c),
d+76,"#59FDE9");b.setFont(this._rowFontStyle);d+=this._rankStart;b.drawGridImage(this._rankLineImage,e+6,d+this._rankTitleStart,f-22,this._rankHeight,this._rankLinePadding);b.drawImage(this._rankTitleImage,e+.5*(f-167),d+3,198,40);if(this._rank)for(e=rankUnit.count(),d+=90,f=0;f<e;f++)c=rankUnit.at(f),this.drawRow(b,c,!0,f,a,d+this._rankRowHeight*f,g)};
MO.FEaiChartCustomerTable_construct=function(){this.__base.FGuiControl.construct.call(this);this._units=new MO.TObjects;this._currentDate=new MO.TDate;this._rankLinePadding=new MO.SPadding(40,0,40,0);this._backgroundPadding=new MO.SPadding(20,20,90,20)};
MO.FEaiChartCustomerTable_setup=function(){var a=MO.Console.find(MO.FImageConsole),b=this._logoImage=a.load("{eai.resource}/live/company.png");b.addLoadListener(this,this.onImageLoad);b=this._backgroundImage=a.load("{eai.resource}/live/grid.png");b.addLoadListener(this,this.onImageLoad);b=this._rankTitleImage=a.load("{eai.resource}/live/tank-title.png");b.addLoadListener(this,this.onImageLoad);b=this._rankLineImage=a.load("{eai.resource}/live/rank.png");b.addLoadListener(this,this.onImageLoad);a=
this._gridRank=MO.Class.create(MO.FGuiGridControl);a.setOptionClip(!1);a.setDisplayHead(!1);a.setLocation(50,170);a.setSize(800,700);a.setAnchorCd(MO.EUiAnchor.Left|MO.EUiAnchor.Right);a.setLeft(9);a.setRight(19);a.setHeadHeight(40);a.setHeadBackColor("#122A46");a.headFont().font="Microsoft YaHei";a.headFont().size=22;a.headFont().color="#00B2F2";a.setRowHeight(40);a.rowFont().font="Microsoft YaHei";a.rowFont().size=22;a.rowFont().color="#59FDE9";b=MO.Class.create(MO.FGuiGridColumnPicture);b.setName("rank");
b.setLabel();b.setDataName("image");b.setWidth(110);b.setPadding(1,1,1,1);b.setAlign(MO.EUiAlign.Center);a.pushColumn(b);b=MO.Class.create(MO.FGuiGridColumnText);b.setName("card");b.setLabel("");b.setDataName("card");b.setWidth(100);b.setPadding(1,1,1,1);a.pushColumn(b);b=MO.Class.create(MO.FGuiGridColumnText);b.setName("label_phone");b.setLabel("");b.setDataName("label_phone");b.setWidth(160);b.setPadding(1,1,1,1);a.pushColumn(b);b=MO.Class.create(MO.FGuiGridColumnCurrency);b.setName("investment");
b.setLabel("");b.setDataName("investment");b.setNormalColor("#59FDE9");b.setHighColor("#FDEF01");b.setLowerColor("#EB6C03");b.setNegativeColor("#FF0000");b.cellPadding().right=10;b.setWidth(160);b.setPadding(1,1,1,1);a.pushColumn(b);this.push(a);a=this._gridControl=MO.Class.create(MO.FGuiTable);a.setOptionClip(!0);a.setLocation(50,332);a.setSize(800,700);a.setAnchorCd(MO.EUiAnchor.Left|MO.EUiAnchor.Right);a.setLeft(9);a.setRight(19);a.setHeadHeight(32);a.setHeadBackColor("#122A46");a.headFont().font=
"Microsoft YaHei";a.headFont().size=22;a.headFont().color="#00B2F2";a.setRowHeight(30);a.rowFont().font="Microsoft YaHei";a.rowFont().size=22;a.rowFont().color="#59FDE9";b=MO.Class.create(MO.FGuiGridColumnDate);b.setName("recordDate");b.setLabel("\u65f6\u95f4");b.setDataName("record_date");b.setDateFormat("HH24:MI:SS");b.setWidth(110);b.setPadding(1,1,1,1);a.pushColumn(b);b=MO.Class.create(MO.FGuiGridColumnText);b.setName("customerCity");b.setLabel("\u57ce\u5e02");b.setDataName("customer_city");b.setWidth(100);
b.setPadding(1,1,1,1);a.pushColumn(b);b=MO.Class.create(MO.FGuiGridColumnText);b.setName("customerInfo");b.setLabel("\u7528\u6237-\u624b\u673a");b.setDataName("customer_info");b.setWidth(160);b.setPadding(1,1,1,1);a.pushColumn(b);b=MO.Class.create(MO.FGuiGridColumnCurrency);b.setName("customerAmount");b.setLabel("\u6295\u8d44\u989d(\u5143)");b.setDataName("customer_amount");b.setNormalColor("#59FDE9");b.setHighColor("#FDEF01");b.setLowerColor("#EB6C03");b.setNegativeColor("#FF0000");b.cellPadding().right=
10;b.setWidth(160);b.setPadding(1,1,1,1);a.pushColumn(b);this.push(a);this._headFontStyle="bold 32px Microsoft YaHei";MO.Window.Browser.isOrientationVertical()?(this._tableCount=11,this._rankStart=100,this._rankTitleStart=-5,this._rankHeight=249,this._rankRowHeight=50,this._rankIconStart=22,this._rankTextStart=8,this._rankRowUp=36,this._rankRowDown=68,this._headStart=352,this._headTextTop=37,this._headHeight=54,this._rowStart=418,this._rowTextTop=0,this._rowFontStyle="36px Microsoft YaHei"):(this._tableCount=
19,this._rankStart=110,this._rankTitleStart=0,this._rankHeight=219,this._rankRowHeight=40,this._rankIconStart=25,this._rankTextStart=0,this._rankRowUp=32,this._rankRowDown=51,this._headStart=336,this._headTextTop=27,this._headHeight=40,this._rowFontStyle="22px Microsoft YaHei",this._rowStart=384)};
MO.FEaiChartCustomerTable_setRankUnits=function(a){var b=this._gridRank;b.clearRows();for(var c=a.count(),e=0;e<c;e++){var d=a.at(e),f=b.allocRow();f.set("image","{eai.resource}/live/"+(e+1)+".png");f.set("card",d.card());f.set("label_phone",d.label()+" - "+d.phone());f.set("investment",d.investment());b.pushRow(f)}};
MO.FEaiChartCustomerTable_pushUnit=function(a){if(!a)return null;var b=a.card(),c=MO.Console.find(MO.FEaiResourceConsole).cityModule().findByCard(b),b="";c&&(b=c.label());var c=this._gridControl,e=c.allocRow();e.set("record_date",a.recordDate());e.set("customer_city",b);e.set("customer_info",a.label()+" - "+a.phone());e.set("customer_amount",a.investment());c.insertRow(e);b=this._units;b.unshift(a);this._lineScroll-=this._rowHeight;b.count()>this._tableCount&&b.pop()};
MO.FEaiChartCustomerTable_dispose=function(){this._units=MO.Lang.Object.dispose(this._units);this._backgroundPadding=MO.Lang.Object.dispose(this._backgroundPadding);this.__base.FGuiControl.dispose.call(this)};
MO.FEaiChartCustomerTimeline=function(a){a=MO.Class.inherits(this,a,MO.FGuiControl);a._startTime=MO.Class.register(a,new MO.AGetSet("_startTime"));a._endTime=MO.Class.register(a,new MO.AGetSet("_endTime"));a._ready=!1;a._investmentTotal=0;a._intervalMiniute=10;a._baseHeight=5;a._degreeLineHeight=MO.Class.register(a,new MO.AGetSet("_degreeLineHeight"),10);a._triangleWidth=MO.Class.register(a,new MO.AGetSet("_triangleWidth"),10);a._triangleHeight=MO.Class.register(a,new MO.AGetSet("_triangleHeight"),
12);a._decoLineGap=MO.Class.register(a,new MO.AGetSet("_decoLineGap"),10);a._decoLineWidth=MO.Class.register(a,new MO.AGetSet("_decoLineWidth"),30);a.oeUpdate=MO.FEaiChartCustomerTimeline_oeUpdate;a.construct=MO.FEaiChartCustomerTimeline_construct;a.sync=MO.FEaiChartCustomerTimeline_sync;a.drawTrend=MO.FEaiChartCustomerTimeline_drawTrend;a.onPaintBegin=MO.FEaiChartCustomerTimeline_onPaintBegin;a.on24HDataFetch=MO.FEaiChartCustomerTimeline_on24HDataFetch;return a};
MO.FEaiChartCustomerTimeline_construct=function(){this.__base.FGuiControl.construct.call(this);this._startTime=new MO.TDate;this._endTime=new MO.TDate;this._trendInfo=MO.Class.create(MO.FEaiChartCustomerTrendInfo)};
MO.FEaiChartCustomerTimeline_sync=function(){if(this._ready){var a=MO.Console.find(MO.FEaiLogicConsole).system();if(a.testReady()){a=a.currentDate();a.truncMinute(this._intervalMiniute);var b=this._startTime;b.assign(a);b.addDay(-1);var c=this._endTime;c.assign(a);MO.Console.find(MO.FEaiLogicConsole).statistics().doCustomerTrend(this,this.on24HDataFetch,b.format(),c.format())}}};MO.FEaiChartCustomerTimeline_on24HDataFetch=function(a){this._trendInfo.unserializeSignBuffer(a.sign,a.content,!0);this.dirty()};
MO.FEaiChartCustomerTimeline_oeUpdate=function(a){this.__base.FGuiControl.oeUpdate.call(this,a);if(!this._ready)return MO.Console.find(MO.FEaiLogicConsole).system().testReady()&&(this._ready=!0,this.sync()),MO.EEventStatus.Stop};
MO.FEaiChartCustomerTimeline_drawTrend=function(a,b,c,e,d,f,g,h,m,k,l,q){l=this._startTime;q=this._trendInfo.units();var u=q.count(),n=q.first(),p=a._handle;p.lineCap="round";var t=1E4*g/k;g=f-n[b]/1E4*t;p.beginPath();p.moveTo(c,g);k=MO.Console.find(MO.FEaiResourceConsole).rateModule().find(MO.EEaiRate.Investment);for(n=1;n<u;n++){var r=q.get(n),v=r[b];l.parseAuto(r.recordDate());l.refresh();r=l.date.getTime()-h;r=c+r/m*(d-c);v=f-v/1E4*t;v-=this._baseHeight;p.lineTo(r,v)}d=MO.Lang.Hex.format(k.findRate(0));
l="#"+d.substring(2);b="rgba("+MO.Lang.Hex.parse(d.substring(2,4))+","+MO.Lang.Hex.parse(d.substring(4,6))+","+MO.Lang.Hex.parse(d.substring(6,8))+",0.5)";d=MO.Lang.Hex.format(k.findRate(1));q="#"+d.substring(2);d="rgba("+MO.Lang.Hex.parse(d.substring(2,4))+","+MO.Lang.Hex.parse(d.substring(4,6))+","+MO.Lang.Hex.parse(d.substring(6,8))+",0.5)";h=a.createLinearGradient(0,f,0,e);h.addColorStop("0",l);h.addColorStop("1",q);a=a.createLinearGradient(0,f,0,e);a.addColorStop("0",b);a.addColorStop("1",d);
p.strokeStyle=h;p.lineWidth=4;p.stroke();p.fillStyle=a;p.lineTo(r,f);p.lineTo(c,f);p.lineTo(c,g);p.fill()};
MO.FEaiChartCustomerTimeline_onPaintBegin=function(a){if(this._ready){this.__base.FGuiControl.onPaintBegin.call(this,a);var b=a.graphic,c=a.rectangle,e=c.top,d=c.top+c.height,f=d-30;a=c.left+5;var c=c.left+c.width-5,g=this.triangleWidth()+this.decoLineGap();b.drawTriangle(a,f,a+this.triangleWidth(),f+this.triangleHeight()/2,a+this.triangleWidth(),f-this.triangleHeight()/2,1,"#F8CB3D","#F8CB3D");b.drawTriangle(c,f,c-this.triangleWidth(),f+this.triangleHeight()/2,c-this.triangleWidth(),f-this.triangleHeight()/
2,1,"#F8CB3D","#F8CB3D");b.drawLine(a+g,f,a+g+this.decoLineWidth(),f,"#F8CB3D",3);b.drawLine(c-g,f,c-g-this.decoLineWidth(),f,"#F8CB3D",3);var h=a+g+this.decoLineWidth(),g=c-g-this.decoLineWidth(),m=e+60,k=d-30,l=k-m;b.drawLine(h,f,g,f,"#F8CB3D",1);for(var d=this.startTime(),q=this.endTime(),u=q.date.getTime()-d.date.getTime(),c=d.date.getTime(),n,p=!1,t=0;!d.isAfter(q);){var t=d.date.getTime()-c,r=h+t/u*(g-h);b.drawLine(r,f-this.degreeLineHeight(),r,f,"#FFFFFF",1);n=d.format("HH24:00");d.addHour(1);
if(p=!p)b.setFont("bold 20px Microsoft YaHei"),t=b.textWidth(n),b.drawText(n,r-t/2,f+20,"#59FDE9")}d.date.setTime(c);d.refresh();f=this._trendInfo;if((t=f.units())&&!t.isEmpty()){n=t.first();for(var v=0,q=t.count(),p=0;p<q;p++)r=t.get(p),r=r.investment(),r>v&&(v=r);this.drawTrend(b,"_investment",h,m,g,k,l,c,u,v,"#FF8800","#FF0000");g=-1;h=m=0;d.parseAuto(n.recordDate());d.refresh();g=d.date.getHours();for(p=0;p<q;p++)r=t.get(p),d.parseAuto(r.recordDate()),d.refresh(),k=d.date.getHours(),g==k?m+=r.investment():
(m>h&&(h=m,m=0),g=k);b.setFont("24px Microsoft YaHei");b.drawText("24H\u6570\u636e\u66f2\u7ebf",a,e,"#54F0FF");b.setFont("22px Microsoft YaHei");e+=30;t=b.textWidth("\u6295\u8d44\u603b\u8ba1\uff1a");g=MO.Lang.Float.unitFormat(f.investmentTotal(),0,0,2,0,1E4,"\u4e07");m=b.textWidth(g);h=MO.Lang.Float.unitFormat(h,0,0,2,0,1E4,"\u4e07");k=b.textWidth(h);f=MO.Lang.Float.unitFormat(f.investmentTotal()/24,0,0,2,0,1E4,"\u4e07");l=b.textWidth(f);b.drawText("24H\u603b\u989d\uff1a",a,e+0,"#00CFFF");b.drawText(g,
a+t+m-m,e+0,"#00B5F6");b.drawText("\u5c0f\u65f6\u5cf0\u503c\uff1a",a,e+22+5,"#00CFFF");b.drawText(h,a+t+m-k,e+22+5,"#00B5F6");b.drawText("\u5c0f\u65f6\u5747\u503c\uff1a",a,e+44+10,"#00CFFF");b.drawText(f,a+t+m-l,e+44+10,"#00B5F6");d.date.setTime(c);d.refresh()}}};
MO.FEaiChartCustomerTrendInfo=function(a){a=MO.Class.inherits(this,a,MO.FObject,MO.MPersistence);a._investmentTotal=MO.Class.register(a,[new MO.AGetter("_investmentTotal"),new MO.APersistence("_investmentTotal",MO.EDataType.Double)]);a._customerTotal=MO.Class.register(a,[new MO.AGetter("_customerTotal"),new MO.APersistence("_customerTotal",MO.EDataType.Uint32)]);a._units=MO.Class.register(a,[new MO.AGetter("_units"),new MO.APersistence("_units",MO.EDataType.Objects,MO.FEaiChartCustomerTrendUnit)]);
return a};MO.FEaiChartCustomerTrendUnit=function(a){a=MO.Class.inherits(this,a,MO.FObject,MO.MPersistence);a._recordDate=MO.Class.register(a,[new MO.AGetter("_recordDate"),new MO.APersistence("_recordDate",MO.EDataType.String)]);a._investment=MO.Class.register(a,[new MO.AGetter("_investment"),new MO.APersistence("_investment",MO.EDataType.Double)]);a._customerCount=MO.Class.register(a,[new MO.AGetter("_customerCount"),new MO.APersistence("_customerCount",MO.EDataType.Uint32)]);return a};
MO.FEaiChartMarketerDynamicInfo=function(a){a=MO.Class.inherits(this,a,MO.FObject,MO.MPersistence);a._investmentCount=MO.Class.register(a,[new MO.AGetter("_investmentCount"),new MO.APersistence("_investmentCount",MO.EDataType.Double)]);a._investmentTotal=MO.Class.register(a,[new MO.AGetter("_investmentTotal"),new MO.APersistence("_investmentTotal",MO.EDataType.Double)]);a._redemptionCount=MO.Class.register(a,[new MO.AGetter("_redemptionCount"),new MO.APersistence("_redemptionCount",MO.EDataType.Double)]);
a._redemptionTotal=MO.Class.register(a,[new MO.AGetter("_redemptionTotal"),new MO.APersistence("_redemptionTotal",MO.EDataType.Double)]);a._netinvestmentCount=MO.Class.register(a,[new MO.AGetter("_netinvestmentCount"),new MO.APersistence("_netinvestmentCount",MO.EDataType.Double)]);a._netinvestmentTotal=MO.Class.register(a,[new MO.AGetter("_netinvestmentTotal"),new MO.APersistence("_netinvestmentTotal",MO.EDataType.Double)]);a._interestCount=MO.Class.register(a,[new MO.AGetter("_interestCount"),new MO.APersistence("_interestCount",
MO.EDataType.Double)]);a._interestTotal=MO.Class.register(a,[new MO.AGetter("_interestTotal"),new MO.APersistence("_interestTotal",MO.EDataType.Double)]);a._performanceCount=MO.Class.register(a,[new MO.AGetter("_performanceCount"),new MO.APersistence("_performanceCount",MO.EDataType.Double)]);a._performanceTotal=MO.Class.register(a,[new MO.AGetter("_performanceTotal"),new MO.APersistence("_interestTotal",MO.EDataType.Double)]);a._customerCount=MO.Class.register(a,[new MO.AGetter("_customerCount"),
new MO.APersistence("_customerCount",MO.EDataType.Int32)]);a._customerTotal=MO.Class.register(a,[new MO.AGetter("_customerTotal"),new MO.APersistence("_customerTotal",MO.EDataType.Int32)]);a._rankDayUnits=MO.Class.register(a,[new MO.AGetter("_rankDayUnits"),new MO.APersistence("_rankDayUnits",MO.EDataType.Objects,MO.FEaiChartMarketerDynamicRankUnit)]);a._rankWeekUnits=MO.Class.register(a,[new MO.AGetter("_rankWeekUnits"),new MO.APersistence("_rankWeekUnits",MO.EDataType.Objects,MO.FEaiChartMarketerDynamicRankUnit)]);
a._rankMonthUnits=MO.Class.register(a,[new MO.AGetter("_rankMonthUnits"),new MO.APersistence("_rankMonthUnits",MO.EDataType.Objects,MO.FEaiChartMarketerDynamicRankUnit)]);a._units=MO.Class.register(a,[new MO.AGetter("_units"),new MO.APersistence("_units",MO.EDataType.Objects,MO.FEaiChartMarketerDynamicUnit)]);return a};
MO.FEaiChartMarketerDynamicRankUnit=function(a){a=MO.Class.inherits(this,a,MO.FObject,MO.MPersistence);a._departmentLabel=MO.Class.register(a,[new MO.AGetter("_departmentLabel"),new MO.APersistence("_departmentLabel",MO.EDataType.String)]);a._marketerLabel=MO.Class.register(a,[new MO.AGetter("_marketerLabel"),new MO.APersistence("_marketerLabel",MO.EDataType.String)]);a._investmentTotal=MO.Class.register(a,[new MO.AGetter("_investmentTotal"),new MO.APersistence("_investmentTotal",MO.EDataType.Double)]);
a._redemptionTotal=MO.Class.register(a,[new MO.AGetter("_redemptionTotal"),new MO.APersistence("_redemptionTotal",MO.EDataType.Double)]);a._netinvestmentTotal=MO.Class.register(a,[new MO.AGetter("_netinvestmentTotal"),new MO.APersistence("_netinvestmentTotal",MO.EDataType.Double)]);a._interestTotal=MO.Class.register(a,[new MO.AGetter("_interestTotal"),new MO.APersistence("_interestTotal",MO.EDataType.Double)]);a._performanceTotal=MO.Class.register(a,[new MO.AGetter("_performanceTotal"),new MO.APersistence("_performanceTotal",
MO.EDataType.Double)]);a._customerCount=MO.Class.register(a,[new MO.AGetter("_customerCount"),new MO.APersistence("_customerCount",MO.EDataType.Int32)]);a._customerTotal=MO.Class.register(a,[new MO.AGetter("_customerTotal"),new MO.APersistence("_customerTotal",MO.EDataType.Int32)]);return a};
MO.FEaiChartMarketerDynamicUnit=function(a){a=MO.Class.inherits(this,a,MO.FObject,MO.MPersistence);a._recordDate=MO.Class.register(a,[new MO.AGetter("_recordDate"),new MO.APersistence("_recordDate",MO.EDataType.String)]);a._departmentLabel=MO.Class.register(a,[new MO.AGetter("_departmentLabel"),new MO.APersistence("_departmentLabel",MO.EDataType.String)]);a._marketerLabel=MO.Class.register(a,[new MO.AGetter("_marketerLabel"),new MO.APersistence("_marketerLabel",MO.EDataType.String)]);a._customerLabel=
MO.Class.register(a,[new MO.AGetter("_customerLabel"),new MO.APersistence("_customerLabel",MO.EDataType.String)]);a._customerCard=MO.Class.register(a,[new MO.AGetter("_customerCard"),new MO.APersistence("_customerCard",MO.EDataType.String)]);a._customerPhone=MO.Class.register(a,[new MO.AGetter("_customerPhone"),new MO.APersistence("_customerPhone",MO.EDataType.String)]);a._customerActionCd=MO.Class.register(a,[new MO.AGetter("_customerActionCd"),new MO.APersistence("_customerActionCd",MO.EDataType.Uint8)]);
a._customerActionAmount=MO.Class.register(a,[new MO.AGetter("_customerActionAmount"),new MO.APersistence("_customerActionAmount",MO.EDataType.Double)]);a._customerActionInterest=MO.Class.register(a,[new MO.AGetter("_customerActionInterest"),new MO.APersistence("_customerActionInterest",MO.EDataType.Double)]);return a};
MO.FEaiChartMarketerProcessor=function(a){a=MO.Class.inherits(this,a,MO.FObject,MO.MGraphicObject,MO.MListener);a._dateSetup=!1;a._beginDate=MO.Class.register(a,new MO.AGetter("_beginDate"));a._endDate=MO.Class.register(a,new MO.AGetter("_endDate"));a._invementDayCurrent=MO.Class.register(a,new MO.AGetter("_invementDayCurrent"),0);a._redemptionDayCurrent=MO.Class.register(a,new MO.AGetter("_redemptionDayCurrent"),0);a._netinvestmentDayCurrent=MO.Class.register(a,new MO.AGetter("_netinvestmentDayCurrent"),
0);a._interestDayCurrent=MO.Class.register(a,new MO.AGetter("_interestDayCurrent"),0);a._performanceDayCurrent=MO.Class.register(a,new MO.AGetter("_performanceDayCurrent"),0);a._customerDayCurrent=MO.Class.register(a,new MO.AGetter("_customerDayCurrent"),0);a._invementDay=MO.Class.register(a,new MO.AGetter("_invementDay"),0);a._invementTotalCurrent=MO.Class.register(a,new MO.AGetter("_invementTotalCurrent"),0);a._invementTotal=MO.Class.register(a,new MO.AGetter("_invementTotal"),0);a._dynamicInfo=
MO.Class.register(a,new MO.AGetter("_dynamicInfo"));a._intervalMinute=1;a._mapEntity=MO.Class.register(a,new MO.AGetSet("_mapEntity"));a._display=MO.Class.register(a,new MO.AGetter("_display"));a._rankUnits=MO.Class.register(a,new MO.AGetter("_rankUnits"));a._units=MO.Class.register(a,new MO.AGetter("_units"));a._tableCount=40;a._tableInterval=1E3;a._tableTick=1;a._dataTicker=null;a._unitPool=null;a._autios=null;a._eventDataChanged=null;a._listenersDataChanged=MO.Class.register(a,new MO.AListener("_listenersDataChanged",
MO.EEvent.DataChanged));a.onDynamicData=MO.FEaiChartMarketerProcessor_onDynamicData;a.construct=MO.FEaiChartMarketerProcessor_construct;a.allocUnit=MO.FEaiChartMarketerProcessor_allocUnit;a.allocShape=MO.FEaiChartMarketerProcessor_allocShape;a.setup=MO.FEaiChartMarketerProcessor_setup;a.calculateCurrent=MO.FEaiChartMarketerProcessor_calculateCurrent;a.focusEntity=MO.FEaiChartMarketerProcessor_focusEntity;a.process=MO.FEaiChartMarketerProcessor_process;a.dispose=MO.FEaiChartMarketerProcessor_dispose;
return a};MO.FEaiChartMarketerProcessor_onDynamicData=function(a){var b=this._dynamicInfo;b.unserializeSignBuffer(a.sign,a.content,!0);a=this._rankUnits;a.assign(b.rankDayUnits());var c=this._units;c.append(b.units());this._tableInterval=(c=c.count())?6E4*this._intervalMinute/c:6E4*this._intervalMinute;this._tableTick=0;c=this._eventDataChanged;c.rankUnits=a;c.rankDayUnits=b._rankDayUnits;c.rankWeekUnits=b._rankWeekUnits;c.rankMonthUnits=b._rankMonthUnits;c.unit=null;this.processDataChangedListener(c)};
MO.FEaiChartMarketerProcessor_construct=function(){this.__base.FObject.construct.call(this);this._beginDate=new MO.TDate;this._endDate=new MO.TDate;this._units=new MO.TObjects;this._tableTicker=new MO.TTicker(1E3*this._tableInterval);this._autios={};this._dataTicker=new MO.TTicker(6E4*this._intervalMinute);this._dynamicInfo=MO.Class.create(MO.FEaiChartMarketerDynamicInfo);this._rankUnits=new MO.TObjects;this._unitPool=MO.Class.create(MO.FObjectPool);this._eventDataChanged=new MO.SEvent(this)};
MO.FEaiChartMarketerProcessor_allocUnit=function(){var a=this._unitPool.alloc();a||(a=MO.Class.create(MO.FEaiChartMarketerDynamicUnit));return a};MO.FEaiChartMarketerProcessor_setup=function(){for(var a=MO.Console.find(MO.FAudioConsole),b=1;5>=b;b++)this._autios[b]=a.load("{eai.resource}/currency/"+b+".mp3");(this._display=MO.Class.create(MO.FE3dDisplay)).linkGraphicContext(this)};
MO.FEaiChartMarketerProcessor_calculateCurrent=function(){for(var a=this._dynamicInfo,b=a.investmentCount(),c=a.redemptionCount(),e=a.interestCount(),a=a.performanceCount(),d=this._units,f=d.count(),g=0;g<f;g++){var h=d.at(g),m=h.customerActionCd(),k=h.customerActionAmount(),h=h.customerActionInterest();1==m?(b-=k,a-=k):2==m&&(c-=k,e-=h)}this._invementDayCurrent=b;this._redemptionDayCurrent=c;this._netinvestmentDayCurrent=b-c;this._interestDayCurrent=e;this._performanceDayCurrent=a};
MO.FEaiChartMarketerProcessor_focusEntity=function(a){if(1==a.customerActionCd()){var b=a.customerCard();if(b=MO.Console.find(MO.FEaiEntityConsole).cityModule().findByCard(b)){var c=a.customerActionAmount(),e=MO.Console.find(MO.FEaiLogicConsole).statistics().calculateAmountLevel(c),d=b.data().provinceCode();(d=MO.Console.find(MO.FEaiEntityConsole).provinceModule().findByCode(d))&&d.doInvestment(e,c);b.addInvestmentTotal(e,c);this._mapEntity.upload();(b=this._autios[e])&&b.play(0)}}b=this._eventDataChanged;
b.rankUnits=this._rankUnits;b.unit=a;this.processDataChangedListener(b)};
MO.FEaiChartMarketerProcessor_process=function(){var a=MO.Console.find(MO.FEaiLogicConsole).system();if(a.testReady()){a=a.currentDate();a.truncMinute();this._dateSetup||(this._endDate.assign(a),this._endDate.addMinute(-this._intervalMinute),this._dateSetup=!0);if(this._dataTicker.process()){var b=MO.Console.find(MO.FEaiLogicConsole).statistics(),c=this._beginDate,e=this._endDate;c.assign(e);e.assign(a);b.doMarketerDynamic(this,this.onDynamicData,c.format(),e.format());c.assign(e)}a=MO.Timer.current();
a-this._tableTick>this._tableInterval&&(b=this._units,b.isEmpty()||(b=b.shift(),this.focusEntity(b)),this.calculateCurrent(),this._tableTick=a);this._mapEntity.process();a=MO.Desktop.application().dynamicInfo();a._investmentEntityCount=this._units.count();a._investmentPoolItemCount=this._unitPool.items().count();a._investmentPoolFreeCount=this._unitPool.frees().count()}};
MO.FEaiChartMarketerProcessor_dispose=function(){this._units=MO.Lang.Object.dispose(this._units);this._dataTicker=MO.Lang.Object.dispose(this._dataTicker);this._eventDataChanged=MO.Lang.Object.dispose(this._eventDataChanged);this.__base.FObject.dispose.call(this)};
MO.FEaiChartMarketerScene=function(a){a=MO.RClass.inherits(this,a,MO.FEaiChartScene);a._code=MO.EEaiScene.ChartMarketer;a._processor=MO.Class.register(a,new MO.AGetter("_processor"));a._processorCurrent=0;a._ready=!1;a._mapReady=!1;a._playing=!1;a._lastTick=0;a._interval=10;a._24HLastTick=0;a._24HTrendInterval=3E5;a._logoBar=null;a._timeline=null;a._liveTable=null;a._statusStart=!1;a._statusLayerCount=100;a._statusLayerLevel=100;a.onInvestmentDataChanged=MO.FEaiChartMarketerScene_onInvestmentDataChanged;
a.onOperationVisibility=MO.FEaiChartMarketerScene_onOperationVisibility;a.onProcessReady=MO.FEaiChartMarketerScene_onProcessReady;a.onProcess=MO.FEaiChartMarketerScene_onProcess;a.onSwitchProcess=MO.FEaiChartMarketerScene_onSwitchProcess;a.onSwitchComplete=MO.FEaiChartMarketerScene_onSwitchComplete;a.setup=MO.FEaiChartMarketerScene_setup;a.showParticle=MO.FEaiChartMarketerScene_showParticle;a.showFace=MO.FEaiChartMarketerScene_showFace;a.fixMatrix=MO.FEaiChartMarketerScene_fixMatrix;a.processResize=
MO.FEaiChartMarketerScene_processResize;return a};MO.FEaiChartMarketerScene_onInvestmentDataChanged=function(a){var b=a.unit,c=this._liveTable;c.setRankDayUnits(a.rankDayUnits);c.setRankWeekUnits(a.rankWeekUnits);c.setRankMonthUnits(a.rankMonthUnits);c.pushUnit(b);c.dirty()};
MO.FEaiChartMarketerScene_onOperationVisibility=function(a){this.__base.FEaiChartScene.onOperationVisibility.call(this,a);a.visibility?(this._groundAutio.play(),this._countryEntity._audioMapEnter._hAudio.muted=!1):(this._groundAutio.pause(),this._countryEntity._audioMapEnter._hAudio.muted=!0)};MO.FEaiChartMarketerScene_onProcessReady=function(){this.__base.FEaiChartScene.onProcessReady.call(this);this._mapEntity.showCity()};
MO.FEaiChartMarketerScene_onProcess=function(){this.__base.FEaiChartScene.onProcess.call(this);if(!this._statusStart){if(MO.Window.Browser.capability().soundConfirm){var a=document.getElementById("id_ios_play");a&&MO.Window.Html.visibleSet(a,!0);(a=document.getElementById("id_loading"))&&document.body.removeChild(a)}else{if(a=document.getElementById("id_loading"))a.style.opacity=this._statusLayerLevel/this._statusLayerCount,this._statusLayerLevel--;this._statusLayerLevel--}0>=this._statusLayerLevel&&
(a&&document.body.removeChild(a),a=this._countryEntity,a.start(),this._mapEntity.showCountry(a),this.processLoaded(),this._statusStart=this._playing=!0)}if(this._playing)if(a=this._countryEntity,a.introAnimeDone()){this._mapReady||(this._guiManager.show(),a=MO.Class.create(MO.FGuiActionAlpha),a.setAlphaBegin(0),a.setAlphaEnd(1),a.setAlphaInterval(.01),a.push(this._guiManager),this._guiManager.mainTimeline().pushAction(a),this._mapReady=!0);a=MO.Timer.current();a-this._24HLastTick>this._24HTrendInterval&&
(this._timeline.sync(),this._24HLastTick=a);this._processor.process();var a=this._logoBar,b=this._processor;0<b.invementDayCurrent()&&(a.findComponent("investmentTotal").setValue(parseInt(b.invementDayCurrent()).toString()),a.findComponent("redemptionTotal").setValue(parseInt(b.redemptionDayCurrent()).toString()),a.findComponent("netinvestmentTotal").setValue(parseInt(b.netinvestmentDayCurrent()).toString()),b=b._dynamicInfo,a.findComponent("redemptionTotalCount").setValue(parseInt(b._redemptionTotal).toString()),
a.findComponent("netinvestmentTotalCount").setValue(parseInt(b._netinvestmentTotal).toString()),a.findComponent("investmentTotalCount").setValue(parseInt(b._investmentTotal).toString()));this._nowTicker.process()&&(a=this._logoBar,b=this._nowDate,b.setNow(),a.findComponent("date").setLabel(b.format("YYYY/MM/DD")),a.findComponent("time").setLabel(b.format("HH24:MI")))}else a.process()};MO.FEaiChartMarketerScene_onSwitchProcess=function(a){};MO.FEaiChartMarketerScene_onSwitchComplete=function(a){};
MO.FEaiChartMarketerScene_setup=function(){this.__base.FEaiChartScene.setup.call(this);var a=this._activeStage.dataLayer(),b=this._logoBar=MO.Console.find(MO.FGuiFrameConsole).get(this,"eai.chart.marketer.LogoBar");this._guiManager.register(b);b=this._processor=MO.Class.create(MO.FEaiChartMarketerProcessor);b.linkGraphicContext(this);b.setMapEntity(this._mapEntity);b.setup();b.addDataChangedListener(this,this.onInvestmentDataChanged);b=b.display();this.fixMatrix(b.matrix());a.push(b);this.activeStage();
a=this._timeline=MO.Class.create(MO.FEaiChartMarketerTimeline);a.setName("Timeline");a.linkGraphicContext(this);a.sync();a.build();this._guiManager.register(a);a=this._liveTable=MO.Class.create(MO.FEaiChartMarketerTable);a.setName("LiveTable");a.linkGraphicContext(this);a.setup();a.build();this._guiManager.register(a);this._guiManager.hide();a=MO.Console.find(MO.FEaiEntityConsole);a.cityModule().build(this);a=this._countryEntity=a.mapModule().loadCountry(this,MO.EEaiConstant.DefaultCountry);this._readyLoader.push(a)};
MO.FEaiChartMarketerScene_showParticle=function(a,b){var c=this._particle,e=b.location();c.color().set(1,1,0,1);for(var d=0;4>d;d++){var f=parseInt(100*Math.random());Math.random();c.setItemCount(f);c.position().assign(e);c.position().z=a.currentZ();c.setDelay(10*d);c.setSpeed(4+.4*d);c.setAcceleration(0);c.setAttenuation(.8);c.start()}};MO.FEaiChartMarketerScene_showFace=function(){this._playing=this._statusStart=!0;this._mapReady=!1;this._mapEntity.reset();this._application.desktop().show();this.processResize()};
MO.FEaiChartMarketerScene_fixMatrix=function(a){MO.Window.Browser.isOrientationVertical()?(a.tx=-14.58,a.ty=-1.9,a.tz=0,a.setScale(.14,.16,.14)):(a.tx=-34.8,a.ty=-11,a.tz=0,a.setScale(.28,.31,.28));a.update()};
MO.FEaiChartMarketerScene_processResize=function(){this.__base.FEaiChartScene.processResize.call(this);var a=MO.Window.Browser.isOrientationVertical();this.fixMatrix(this._processor.display().matrix());var b=this._logoBar;a?(b.setLocation(8,8),b.setScale(.85,.85)):(b.setLocation(5,5),b.setScale(.9,.9));b=this._southSea;a?(b.setDockCd(MO.EUiDock.RightTop),b.setTop(570),b.setRight(100)):(b.setDockCd(MO.EUiDock.RightBottom),b.setRight(780),b.setBottom(260));b=this._timeline;a?(b.setDockCd(MO.EUiDock.Bottom),
b.setAnchorCd(MO.EUiAnchor.Left|MO.EUiAnchor.Right),b.setLeft(10),b.setRight(10),b.setBottom(920)):(b.setDockCd(MO.EUiDock.Bottom),b.setAnchorCd(MO.EUiAnchor.Left|MO.EUiAnchor.Right),b.setLeft(20),b.setBottom(30),b.setRight(780));b.setHeight(250);b=this._liveTable;a?(b.setDockCd(MO.EUiDock.Bottom),b.setAnchorCd(MO.EUiAnchor.Left|MO.EUiAnchor.Top|MO.EUiAnchor.Right),b.setLeft(10),b.setRight(10),b.setBottom(10),b.setWidth(1060),b.setHeight(900)):(b.setDockCd(MO.EUiDock.Right),b.setAnchorCd(MO.EUiAnchor.Left|
MO.EUiAnchor.Top|MO.EUiAnchor.Bottom),b.setTop(10),b.setRight(0),b.setBottom(10),b.setWidth(750))};
MO.FEaiChartMarketerTable=function(a){a=MO.Class.inherits(this,a,MO.FGuiControl);a._currentDate=null;a._rank=MO.Class.register(a,new MO.AGetter("_rank"));a._rankLogoImage=null;a._rankTitleImage=null;a._rankLineImage=null;a._rankLinePadding=null;a._rank1Image=null;a._rank2Image=null;a._rank3Image=null;a._backgroundImage=null;a._backgroundPadding=null;a._dayImage=null;a._weeksImage=null;a._monthImage=null;a._tableCount=0;a._units=null;a._lineScroll=0;a._listenersDataChanged=MO.Class.register(a,new MO.AListener("_listenersDataChanged",
MO.EEvent.DataChanged));a.onImageLoad=MO.FEaiChartMarketerTable_onImageLoad;a.onPaintBegin=MO.FEaiChartMarketerTable_onPaintBegin;a.construct=MO.FEaiChartMarketerTable_construct;a.setup=MO.FEaiChartMarketerTable_setup;a.pushUnit=MO.FEaiChartMarketerTable_pushUnit;a.setRankDayUnits=MO.FEaiChartMarketerTable_setRankDayUnits;a.setRankWeekUnits=MO.FEaiChartMarketerTable_setRankWeekUnits;a.setRankMonthUnits=MO.FEaiChartMarketerTable_setRankMonthUnits;a.drawRow=MO.FEaiChartMarketerTable_drawRow;a.dispose=
MO.FEaiChartMarketerTable_dispose;return a};MO.FEaiChartMarketerTable_onImageLoad=function(){this.dirty()};
MO.FEaiChartMarketerTable_onPaintBegin=function(a){this.__base.FGuiControl.onPaintBegin.call(this,a);var b=a.graphic,c=a.rectangle,e=c.left,d=c.top,f=c.width;a=e+12;var g=e+f-e;b.drawGridImage(this._backgroundImage,e,d,f,c.height,this._backgroundPadding);b.setFont(this._headFontStyle);c=b.textWidth("\u7406\u8d22\u5e08\u4e1a\u7ee9\u5c55\u793a\u4e2d\u5fc3");b.drawText("\u7406\u8d22\u5e08\u4e1a\u7ee9\u5c55\u793a\u4e2d\u5fc3",e+.5*(f-c),d+76,"#59FDE9");b.setFont(this._rowFontStyle);d+=this._rankStart;
e+=6;b.drawGridImage(this._rankLineImage,e,d+this._rankTitleStart,f-22,this._rankHeight,this._rankLinePadding);b.drawImage(this._dayImage,e,d+44,56,130);b.drawImage(this._weeksImage,e,d+177,56,137);b.drawImage(this._monthImage,e,d+317,56,130);if(this._rank)for(f=rankUnit.count(),d+=90,e=0;e<f;e++)c=rankUnit.at(e),this.drawRow(b,c,!0,e,a,d+this._rankRowHeight*e,g)};
MO.FEaiChartMarketerTable_construct=function(){this.__base.FGuiControl.construct.call(this);this._units=new MO.TObjects;this._currentDate=new MO.TDate;this._rankLinePadding=new MO.SPadding(40,0,40,0);this._backgroundPadding=new MO.SPadding(20,20,90,20)};
MO.FEaiChartMarketerTable_setup=function(){var a=MO.Console.find(MO.FImageConsole),b=this._logoImage=a.load("{eai.resource}/live/company.png");b.addLoadListener(this,this.onImageLoad);b=this._backgroundImage=a.load("{eai.resource}/marketer/right.png");b.addLoadListener(this,this.onImageLoad);b=this._rankTitleImage=a.load("{eai.resource}/marketer/title.png");b.addLoadListener(this,this.onImageLoad);b=this._rankLineImage=a.load("{eai.resource}/marketer/rank.png");b.addLoadListener(this,this.onImageLoad);
b=this._rank1Image=a.load("{eai.resource}/live/1.png");b.addLoadListener(this,this.onImageLoad);b=this._rank2Image=a.load("{eai.resource}/live/2.png");b.addLoadListener(this,this.onImageLoad);b=this._rank3Image=a.load("{eai.resource}/live/3.png");b.addLoadListener(this,this.onImageLoad);b=this._dayImage=a.load("{eai.resource}/marketer/day.png");b.addLoadListener(this,this.onImageLoad);b=this._weeksImage=a.load("{eai.resource}/marketer/weeks.png");b.addLoadListener(this,this.onImageLoad);b=this._monthImage=
a.load("{eai.resource}/marketer/month.png");b.addLoadListener(this,this.onImageLoad);a=this._gridMonthRank=MO.Class.create(MO.FGuiGridControl);a.setLocation(50,112);a.setSize(800,900);a.setAnchorCd(MO.EUiAnchor.Left|MO.EUiAnchor.Right);a.setLeft(9);a.setRight(19);a.setHeadHeight(32);a.headPadding().set(0,0,0,10);a.setHeadBackColor("#122A46");a.headFont().font="Microsoft YaHei";a.headFont().size=22;a.headFont().color="#00B2F2";a.setRowHeight(40);a.rowFont().font="Microsoft YaHei";a.rowFont().size=
20;a.rowFont().color="#59FDE9";b=MO.Class.create(MO.FGuiGridColumnText);b.setName("");b.setLabel("");b.setDataName("");b.setWidth(56);b.setPadding(0,1,0,1);a.pushColumn(b);b=MO.Class.create(MO.FGuiGridColumnPicture);b.setName("rank");b.setLabel();b.setDataName("month_images");b.setWidth(40);b.setPadding(0,1,0,1);b.setAlign(MO.EUiAlign.Center);a.pushColumn(b);b=MO.Class.create(MO.FGuiGridColumnText);b.setName("monthDepartmentLabel");b.setLabel("\u516c\u53f8");b.setDataName("month_department_label");
b.setWidth(100);b.setPadding(0,1,1,1);a.pushColumn(b);b=MO.Class.create(MO.FGuiGridColumnText);b.setName("monthMarketerLabel");b.setLabel("\u7406\u8d22\u5e08");b.setDataName("month_marketer_label");b.setWidth(98);b.setPadding(1,1,1,1);a.pushColumn(b);b=MO.Class.create(MO.FGuiGridColumnCurrency);b.setName("monthInvestmentTotal");b.setLabel("\u6295\u8d44");b.setDataName("month_investment_total");b.setNormalColor("#59FDE9");b.setHighColor("#FDEF01");b.setLowerColor("#EB6C03");b.setNegativeColor("#FF0000");
b.cellPadding().right=10;b.setWidth(123);b.setPadding(1,1,1,1);a.pushColumn(b);b=MO.Class.create(MO.FGuiGridColumnCurrency);b.setName("monthRedemptionTotal");b.setLabel("\u8d4e\u56de");b.setDataName("month_redemption_total");b.setNormalColor("#59FDE9");b.setHighColor("#FDEF01");b.setLowerColor("#EB6C03");b.setNegativeColor("#FF0000");b.cellPadding().right=10;b.setWidth(118);b.setPadding(1,1,1,1);a.pushColumn(b);b=MO.Class.create(MO.FGuiGridColumnCurrency);b.setName("monthNetinvestmentTotal");b.setLabel("\u51c0\u6295");
b.setDataName("month_netinvestment_total");b.setNormalColor("#59FDE9");b.setHighColor("#FDEF01");b.setLowerColor("#EB6C03");b.setNegativeColor("#FF0000");b.cellPadding().right=10;b.setWidth(127);b.setPadding(1,1,1,1);a.pushColumn(b);b=MO.Class.create(MO.FGuiGridColumnText);b.setName("monthCustomerCount");b.setLabel("\u5ba2\u6237\u6570");b.setDataName("month_customer_count");b.setWidth(81);b.setPadding(1,1,1,1);a.pushColumn(b);this.push(a);a=this._gridWeeksRank=MO.Class.create(MO.FGuiGridControl);
a.setDisplayHead(!1);a.setLocation(50,290);a.setSize(800,700);a.setAnchorCd(MO.EUiAnchor.Left|MO.EUiAnchor.Right);a.setLeft(9);a.setRight(19);a.setHeadHeight(32);a.setHeadBackColor("#122A46");a.headFont().font="Microsoft YaHei";a.headFont().size=22;a.headFont().color="#00B2F2";a.setRowHeight(40);a.rowFont().font="Microsoft YaHei";a.rowFont().size=20;a.rowFont().color="#59FDE9";b=MO.Class.create(MO.FGuiGridColumnText);b.setName("");b.setLabel("");b.setDataName("");b.setWidth(56);b.setPadding(0,1,0,
1);a.pushColumn(b);b=MO.Class.create(MO.FGuiGridColumnPicture);b.setName("weeksRank");b.setLabel();b.setDataName("weeks_images");b.setWidth(40);b.setPadding(0,1,0,1);b.setAlign(MO.EUiAlign.Center);a.pushColumn(b);b=MO.Class.create(MO.FGuiGridColumnText);b.setName("weeksDepartmentLabel");b.setLabel("\u516c\u53f8");b.setDataName("weeks_department_label");b.setWidth(100);b.setPadding(0,1,1,1);a.pushColumn(b);b=MO.Class.create(MO.FGuiGridColumnText);b.setName("weeksMarketerLabel");b.setLabel("\u7406\u8d22\u5e08");
b.setDataName("weeks_marketer_label");b.setWidth(98);b.setPadding(1,1,1,1);a.pushColumn(b);b=MO.Class.create(MO.FGuiGridColumnCurrency);b.setName("weeksInvestmentTotal");b.setLabel("\u6295\u8d44");b.setDataName("weeks_investment_total");b.setNormalColor("#59FDE9");b.setHighColor("#FDEF01");b.setLowerColor("#EB6C03");b.setNegativeColor("#FF0000");b.cellPadding().right=10;b.setWidth(123);b.setPadding(1,1,1,1);a.pushColumn(b);b=MO.Class.create(MO.FGuiGridColumnCurrency);b.setName("weeksRedemptionTotal");
b.setLabel("\u8d4e\u56de");b.setDataName("weeks_redemption_total");b.setNormalColor("#59FDE9");b.setHighColor("#FDEF01");b.setLowerColor("#EB6C03");b.setNegativeColor("#FF0000");b.cellPadding().right=10;b.setWidth(118);b.setPadding(1,1,1,1);a.pushColumn(b);b=MO.Class.create(MO.FGuiGridColumnCurrency);b.setName("weeksNetinvestmentTotal");b.setLabel("\u51c0\u6295");b.setDataName("weeks_netinvestment_total");b.setNormalColor("#59FDE9");b.setHighColor("#FDEF01");b.setLowerColor("#EB6C03");b.setNegativeColor("#FF0000");
b.cellPadding().right=10;b.setWidth(127);b.setPadding(1,1,1,1);a.pushColumn(b);b=MO.Class.create(MO.FGuiGridColumnText);b.setName("weeksCustomerCount");b.setLabel("\u5ba2\u6237\u6570");b.setDataName("weeks_customer_count");b.setWidth(81);b.setPadding(1,1,1,1);a.pushColumn(b);this.push(a);a=this._gridDayRank=MO.Class.create(MO.FGuiGridControl);a.setDisplayHead(!1);a.setLocation(50,430);a.setSize(800,130);a.setAnchorCd(MO.EUiAnchor.Left|MO.EUiAnchor.Right);a.setLeft(9);a.setRight(19);a.setHeadHeight(32);
a.setHeadBackColor("#122A46");a.headFont().font="Microsoft YaHei";a.headFont().size=22;a.headFont().color="#00B2F2";a.setRowHeight(40);a.rowFont().font="Microsoft YaHei";a.rowFont().size=20;a.rowFont().color="#59FDE9";b=MO.Class.create(MO.FGuiGridColumnText);b.setName("");b.setLabel("");b.setDataName("");b.setWidth(56);b.setPadding(0,1,0,1);a.pushColumn(b);b=MO.Class.create(MO.FGuiGridColumnPicture);b.setName("rank");b.setLabel();b.setDataName("images");b.setWidth(40);b.setPadding(0,1,0,1);b.setAlign(MO.EUiAlign.Center);
a.pushColumn(b);b=MO.Class.create(MO.FGuiGridColumnText);b.setName("departmentLabel");b.setLabel("\u516c\u53f8");b.setDataName("department_label");b.setWidth(100);b.setPadding(0,1,1,1);a.pushColumn(b);b=MO.Class.create(MO.FGuiGridColumnText);b.setName("marketerLabel");b.setLabel("\u7406\u8d22\u5e08");b.setDataName("marketer_label");b.setWidth(98);b.setPadding(1,1,1,1);a.pushColumn(b);b=MO.Class.create(MO.FGuiGridColumnCurrency);b.setName("investmentTotal");b.setLabel("\u6295\u8d44");b.setDataName("investment_total");
b.setNormalColor("#59FDE9");b.setHighColor("#FDEF01");b.setLowerColor("#EB6C03");b.setNegativeColor("#FF0000");b.cellPadding().right=10;b.setWidth(123);b.setPadding(1,1,1,1);a.pushColumn(b);b=MO.Class.create(MO.FGuiGridColumnCurrency);b.setName("redemptionTotal");b.setLabel("\u8d4e\u56de");b.setDataName("redemption_total");b.setNormalColor("#59FDE9");b.setHighColor("#FDEF01");b.setLowerColor("#EB6C03");b.setNegativeColor("#FF0000");b.cellPadding().right=10;b.setWidth(118);b.setPadding(1,1,1,1);a.pushColumn(b);
b=MO.Class.create(MO.FGuiGridColumnCurrency);b.setName("netinvestmentTotal");b.setLabel("\u51c0\u6295");b.setDataName("netinvestment_total");b.setNormalColor("#59FDE9");b.setHighColor("#FDEF01");b.setLowerColor("#EB6C03");b.setNegativeColor("#FF0000");b.cellPadding().right=10;b.setWidth(127);b.setPadding(1,1,1,1);a.pushColumn(b);b=MO.Class.create(MO.FGuiGridColumnText);b.setName("customerCount");b.setLabel("\u5ba2\u6237\u6570");b.setDataName("customer_count");b.setWidth(81);b.setPadding(1,1,1,1);
a.pushColumn(b);this.push(a);a=this._gridControl=MO.Class.create(MO.FGuiTable);a.setLocation(50,570);a.setSize(800,430);a.setAnchorCd(MO.EUiAnchor.Left|MO.EUiAnchor.Right);a.setLeft(9);a.setRight(19);a.setHeadHeight(32);a.setHeadBackColor("#122A46");a.headFont().font="Microsoft YaHei";a.headFont().size=22;a.headFont().color="#00B2F2";a.setRowHeight(30);a.rowFont().font="Microsoft YaHei";a.rowFont().size=20;a.rowFont().color="#59FDE9";b=MO.Class.create(MO.FGuiGridColumnDate);b.setName("recordDate");
b.setLabel("\u65f6\u95f4");b.setDataName("record_date");b.setDateFormat("HH24:MI:SS");b.setWidth(110);b.setPadding(1,1,1,1);a.pushColumn(b);b=MO.Class.create(MO.FGuiGridColumnText);b.setName("departmentLabel");b.setLabel("\u516c\u53f8");b.setDataName("department_label");b.setWidth(140);b.setPadding(1,1,1,1);a.pushColumn(b);b=MO.Class.create(MO.FGuiGridColumnText);b.setName("marketerLabel");b.setLabel("\u7406\u8d22\u5e08");b.setDataName("marketer_label");b.setWidth(110);b.setPadding(1,1,1,1);a.pushColumn(b);
b=MO.Class.create(MO.FGuiGridColumnText);b.setName("customerCard");b.setLabel("\u57ce\u5e02");b.setDataName("customer_city");b.setWidth(100);b.setPadding(1,1,1,1);a.pushColumn(b);b=MO.Class.create(MO.FGuiGridColumnText);b.setName("customerInfo");b.setLabel("\u7528\u6237-\u624b\u673a");b.setDataName("customer_info");b.setWidth(140);b.setPadding(1,1,1,1);a.pushColumn(b);b=MO.Class.create(MO.FGuiGridColumnCurrency);b.setName("customerAmount");b.setLabel("\u6295\u8d44\u989d(\u5143)");b.setDataName("customer_amount");
b.setNormalColor("#59FDE9");b.setHighColor("#FDEF01");b.setLowerColor("#EB6C03");b.setNegativeColor("#FF0000");b.cellPadding().right=10;b.setWidth(120);b.setPadding(1,1,1,1);a.pushColumn(b);this.push(a);this._headFontStyle="bold 32px Microsoft YaHei";MO.Window.Browser.isOrientationVertical()?(this._tableCount=11,this._rankStart=100,this._rankTitleStart=-5,this._rankHeight=249,this._rankRowHeight=50,this._rankIconStart=22,this._rankTextStart=8,this._rankRowUp=36,this._rankRowDown=68,this._headStart=
352,this._headTextTop=37,this._headHeight=54,this._rowStart=418,this._rowTextTop=0,this._rowFontStyle="36px Microsoft YaHei"):(this._tableCount=19,this._rankStart=110,this._rankTitleStart=0,this._rankHeight=450,this._rankRowHeight=40,this._rankIconStart=25,this._rankTextStart=0,this._rankRowUp=32,this._rankRowDown=51,this._headStart=336,this._headTextTop=27,this._headHeight=40,this._rowFontStyle="22px Microsoft YaHei",this._rowStart=384)};
MO.FEaiChartMarketerTable_setRankDayUnits=function(a){var b=this._gridDayRank;b.clearRows();for(var c=a.count(),e=0;e<c;e++){var d=a.at(e),f=b.allocRow(),g=d.departmentLabel(),h=MO.Console.find(MO.FEaiResourceConsole).departmentModule().findByFullLabel(g);h&&(g=h.label());f.set("images","{eai.resource}/marketer/"+(e+1)+".png");f.set("department_label",g);f.set("marketer_label",d.marketerLabel());f.set("investment_total",d.investmentTotal());f.set("redemption_total",d.redemptionTotal());f.set("netinvestment_total",
d.netinvestmentTotal());f.set("customer_count",d.customerTotal());b.pushRow(f)}};
MO.FEaiChartMarketerTable_setRankWeekUnits=function(a){var b=this._gridWeeksRank;b.clearRows();for(var c=a.count(),e=0;e<c;e++){var d=a.at(e),f=b.allocRow(),g=d.departmentLabel(),h=MO.Console.find(MO.FEaiResourceConsole).departmentModule().findByFullLabel(g);h&&(g=h.label());f.set("weeks_images","{eai.resource}/marketer/"+(e+1)+".png");f.set("weeks_department_label",g);f.set("weeks_marketer_label",d.marketerLabel());f.set("weeks_investment_total",d.investmentTotal());f.set("weeks_redemption_total",
d.redemptionTotal());f.set("weeks_netinvestment_total",d.netinvestmentTotal());f.set("weeks_customer_count",d.customerTotal());b.pushRow(f)}};
MO.FEaiChartMarketerTable_setRankMonthUnits=function(a){var b=this._gridMonthRank;b.clearRows();for(var c=a.count(),e=0;e<c;e++){var d=a.at(e),f=b.allocRow(),g=d.departmentLabel(),h=MO.Console.find(MO.FEaiResourceConsole).departmentModule().findByFullLabel(g);h&&(g=h.label());f.set("month_images","{eai.resource}/marketer/"+(e+1)+".png");f.set("month_department_label",g);f.set("month_marketer_label",d.marketerLabel());f.set("month_investment_total",d.investmentTotal());f.set("month_redemption_total",
d.redemptionTotal());f.set("month_netinvestment_total",d.netinvestmentTotal());f.set("month_customer_count",d.customerTotal());b.pushRow(f)}};
MO.FEaiChartMarketerTable_pushUnit=function(a){if(!a)return null;var b=a.departmentLabel(),c=MO.Console.find(MO.FEaiResourceConsole).departmentModule().findByFullLabel(b);c&&(b=c.label());var c=a.customerCard(),e=MO.Console.find(MO.FEaiResourceConsole).cityModule().findByCard(c),c="";e&&(c=e.label());var e=this._gridControl,d=e.allocRow();d.set("record_date",a.recordDate());d.set("department_label",b);d.set("marketer_label",a.marketerLabel());d.set("customer_city",c);d.set("customer_info",a.customerLabel()+
" - "+a.customerPhone());1==a.customerActionCd()?d.set("customer_amount",a.customerActionAmount()):d.set("customer_amount",-a.customerActionAmount());e.insertRow(d);b=this._units;b.unshift(a);this._lineScroll-=this._rowHeight;b.count()>this._tableCount&&b.pop()};MO.FEaiChartMarketerTable_dispose=function(){this._units=MO.Lang.Object.dispose(this._units);this._backgroundPadding=MO.Lang.Object.dispose(this._backgroundPadding);this.__base.FGuiControl.dispose.call(this)};
MO.FEaiChartMarketerTimeline=function(a){a=MO.Class.inherits(this,a,MO.FGuiControl);a._startTime=MO.Class.register(a,new MO.AGetSet("_startTime"));a._endTime=MO.Class.register(a,new MO.AGetSet("_endTime"));a._ready=!1;a._investmentTotal=0;a._intervalMiniute=10;a._baseHeight=5;a._degreeLineHeight=MO.Class.register(a,new MO.AGetSet("_degreeLineHeight"),10);a._triangleWidth=MO.Class.register(a,new MO.AGetSet("_triangleWidth"),10);a._triangleHeight=MO.Class.register(a,new MO.AGetSet("_triangleHeight"),
12);a._decoLineGap=MO.Class.register(a,new MO.AGetSet("_decoLineGap"),10);a._decoLineWidth=MO.Class.register(a,new MO.AGetSet("_decoLineWidth"),30);a.oeUpdate=MO.FEaiChartMarketerTimeline_oeUpdate;a.construct=MO.FEaiChartMarketerTimeline_construct;a.sync=MO.FEaiChartMarketerTimeline_sync;a.drawTrend=MO.FEaiChartMarketerTimeline_drawTrend;a.onPaintBegin=MO.FEaiChartMarketerTimeline_onPaintBegin;a.on24HDataFetch=MO.FEaiChartMarketerTimeline_on24HDataFetch;return a};
MO.FEaiChartMarketerTimeline_construct=function(){this.__base.FGuiControl.construct.call(this);this._startTime=new MO.TDate;this._endTime=new MO.TDate;this._trendInfo=MO.Class.create(MO.FEaiChartMarketerTrendInfo)};
MO.FEaiChartMarketerTimeline_sync=function(){if(this._ready){var a=MO.Console.find(MO.FEaiLogicConsole).system();if(a.testReady()){a=a.currentDate();a.truncMinute(this._intervalMiniute);var b=this._startTime;b.assign(a);b.addDay(-1);var c=this._endTime;c.assign(a);MO.Console.find(MO.FEaiLogicConsole).statistics().doMarketerTrend(this,this.on24HDataFetch,b.format(),c.format())}}};MO.FEaiChartMarketerTimeline_on24HDataFetch=function(a){this._trendInfo.unserializeSignBuffer(a.sign,a.content,!0);this.dirty()};
MO.FEaiChartMarketerTimeline_oeUpdate=function(a){this.__base.FGuiControl.oeUpdate.call(this,a);if(!this._ready)return MO.Console.find(MO.FEaiLogicConsole).system().testReady()&&(this._ready=!0,this.sync()),MO.EEventStatus.Stop};
MO.FEaiChartMarketerTimeline_drawTrend=function(a,b,c,e,d,f,g,h,m,k,l,q){var u=this._startTime,n=this._trendInfo.units(),p=n.count(),t=n.first(),r=a._handle;r.lineCap="round";g=1E4*g/k;t=f-t[b]/1E4*g;r.beginPath();r.moveTo(c,t);t=MO.Console.find(MO.FEaiResourceConsole).rateModule().find(MO.EEaiRate.Investment);for(k=1;k<p;k++){var v=n.get(k),w=v[b];u.parseAuto(v.recordDate());u.refresh();v=u.date.getTime()-h;v=c+v/m*(d-c);w=f-w/1E4*g;w-=this._baseHeight;r.lineTo(v,w)}c=MO.Lang.Hex.format(t.findRate(0));
b="rgba("+MO.Lang.Hex.parse(c.substring(2,4))+","+MO.Lang.Hex.parse(c.substring(4,6))+","+MO.Lang.Hex.parse(c.substring(6,8))+",0.5)";c=MO.Lang.Hex.format(t.findRate(1));c="rgba("+MO.Lang.Hex.parse(c.substring(2,4))+","+MO.Lang.Hex.parse(c.substring(4,6))+","+MO.Lang.Hex.parse(c.substring(6,8))+",0.5)";d=a.createLinearGradient(0,f,0,e);d.addColorStop("0",l);d.addColorStop("1",q);a=a.createLinearGradient(0,f,0,e);a.addColorStop("0",b);a.addColorStop("1",c);r.strokeStyle=d;r.lineWidth=4;r.stroke()};
MO.FEaiChartMarketerTimeline_onPaintBegin=function(a){if(this._ready){this.__base.FGuiControl.onPaintBegin.call(this,a);var b=a.graphic,c=a.rectangle,e=c.top,d=c.top+c.height,f=d-30;a=c.left+5;var c=c.left+c.width-5,g=this.triangleWidth()+this.decoLineGap();b.drawTriangle(a,f,a+this.triangleWidth(),f+this.triangleHeight()/2,a+this.triangleWidth(),f-this.triangleHeight()/2,1,"#F8CB3D","#F8CB3D");b.drawTriangle(c,f,c-this.triangleWidth(),f+this.triangleHeight()/2,c-this.triangleWidth(),f-this.triangleHeight()/
2,1,"#F8CB3D","#F8CB3D");b.drawLine(a+g,f,a+g+this.decoLineWidth(),f,"#F8CB3D",3);b.drawLine(c-g,f,c-g-this.decoLineWidth(),f,"#F8CB3D",3);var h=a+g+this.decoLineWidth(),g=c-g-this.decoLineWidth(),m=e+60,k=d-30,l=k-m;b.drawLine(h,f,g,f,"#F8CB3D",3);for(var d=this.startTime(),q=this.endTime(),u=q.date.getTime()-d.date.getTime(),c=d.date.getTime(),n,p=!1,t=0;!d.isAfter(q);){var t=d.date.getTime()-c,r=h+t/u*(g-h);b.drawLine(r,f-this.degreeLineHeight(),r,f,"#FFFFFF",1);n=d.format("HH24:00");d.addHour(1);
if(p=!p)b.setFont("bold 20px Microsoft YaHei"),t=b.textWidth(n),b.drawText(n,r-t/2,f+20,"#59FDE9")}d.date.setTime(c);d.refresh();f=this._trendInfo;if((t=f.units())&&!t.isEmpty()){n=t.first();for(var v=0,q=t.count(),p=0;p<q;p++){var r=t.get(p),w=r.investment();w>v&&(v=w);r=r.redemption();r>v&&(v=r)}this.drawTrend(b,"_investment",h,m,g,k,l,c,u,v,"#FF8800","#FF0000");this.drawTrend(b,"_redemption",h,m,g,k,l,c,u,v,"#0088FF","#0000FF");d.date.setTime(c);d.refresh();h=-1;m=g=0;d.parseAuto(n.recordDate());
d.refresh();h=d.date.getHours();for(p=0;p<q;p++)r=t.get(p),d.parseAuto(r.recordDate()),d.refresh(),k=d.date.getHours(),h==k?g+=r.redemption():(g>m&&(m=g,g=0),h=k);b.setFont("24px Microsoft YaHei");b.drawText("24H\u6570\u636e\u66f2\u7ebf",a,e,"#54F0FF");b.setFont("22px Microsoft YaHei");e+=30;t=b.textWidth("\u6295\u8d44\u603b\u8ba1\uff1a");h=MO.Lang.Float.unitFormat(f.investmentTotal(),0,0,2,0,1E4,"\u4e07");g=b.textWidth(h);m=MO.Lang.Float.unitFormat(f.redemptionTotal(),0,0,2,0,1E4,"\u4e07");k=b.textWidth(m);
l=MO.Lang.Float.unitFormat(f.netinvestmentTotal(),0,0,2,0,1E4,"\u4e07");u=b.textWidth(l);f=MO.Lang.Float.unitFormat(f.interestTotal(),0,0,2,0,1E4,"\u4e07");q=b.textWidth(f);p=Math.max(Math.max(Math.max(g,k),u),q);b.drawText("\u6295\u8d44\u603b\u989d\uff1a",a,e+0,"#00CFFF");b.drawText(h,a+t+p-g,e+0,"#00B5F6");b.drawText("\u8d4e\u56de\u603b\u989d\uff1a",a,e+22+5,"#00CFFF");b.drawText(m,a+t+p-k,e+22+5,"#00B5F6");b.drawText("\u51c0\u6295\u603b\u989d\uff1a",a,e+44+10,"#00CFFF");b.drawText(l,a+t+p-u,e+
44+10,"#00B5F6");b.drawText("\u5229\u606f\u603b\u989d\uff1a",a,e+66+15,"#00CFFF");b.drawText(f,a+t+p-q,e+66+15,"#00B5F6");d.date.setTime(c);d.refresh()}}};
MO.FEaiChartMarketerTrendInfo=function(a){a=MO.Class.inherits(this,a,MO.FObject,MO.MPersistence);a._investmentTotal=MO.Class.register(a,[new MO.AGetter("_investmentTotal"),new MO.APersistence("_investmentTotal",MO.EDataType.Double)]);a._redemptionTotal=MO.Class.register(a,[new MO.AGetter("_redemptionTotal"),new MO.APersistence("_redemptionTotal",MO.EDataType.Double)]);a._netinvestmentTotal=MO.Class.register(a,[new MO.AGetter("_netinvestmentTotal"),new MO.APersistence("_netinvestmentTotal",MO.EDataType.Double)]);
a._interestTotal=MO.Class.register(a,[new MO.AGetter("_interestTotal"),new MO.APersistence("_interestTotal",MO.EDataType.Double)]);a._performanceTotal=MO.Class.register(a,[new MO.AGetter("_performanceTotal"),new MO.APersistence("_performanceTotal",MO.EDataType.Double)]);a._units=MO.Class.register(a,[new MO.AGetter("_units"),new MO.APersistence("_units",MO.EDataType.Objects,MO.FEaiChartMarketerTrendUnit)]);return a};
MO.FEaiChartMarketerTrendUnit=function(a){a=MO.Class.inherits(this,a,MO.FObject,MO.MPersistence);a._recordDate=MO.Class.register(a,[new MO.AGetter("_recordDate"),new MO.APersistence("_recordDate",MO.EDataType.String)]);a._investment=MO.Class.register(a,[new MO.AGetter("_investment"),new MO.APersistence("_investment",MO.EDataType.Double)]);a._redemption=MO.Class.register(a,[new MO.AGetter("_redemption"),new MO.APersistence("_redemption",MO.EDataType.Double)]);a._netinvestment=MO.Class.register(a,[new MO.AGetter("_netinvestment"),
new MO.APersistence("_netinvestment",MO.EDataType.Double)]);a._interest=MO.Class.register(a,[new MO.AGetter("_interest"),new MO.APersistence("_interest",MO.EDataType.Double)]);a._performance=MO.Class.register(a,[new MO.AGetter("_performance"),new MO.APersistence("_performance",MO.EDataType.Double)]);return a};
MO.FEaiChartDepartmentScene=function(a){a=MO.Class.inherits(this,a,MO.FEaiChartScene);a._code=MO.EEaiScene.ChartDepartment;a._investment=MO.Class.register(a,new MO.AGetter("_investment"));a._investmentCurrent=0;a._ready=!1;a._mapReady=!1;a._playing=!1;a._lastTick=0;a._interval=10;a._24HLastTick=0;a._24HTrendInterval=3E5;a._logoBar=null;a._timeline=null;a._liveTable=null;a._livePop=null;a._statusStart=!1;a._statusLayerCount=100;a._statusLayerLevel=100;a._groundAutioUrl="{eai.resource}/music/statistics.mp3";
a.onInvestmentDataChanged=MO.FEaiChartDepartmentScene_onInvestmentDataChanged;a.onOperationVisibility=MO.FEaiChartDepartmentScene_onOperationVisibility;a.onProcessReady=MO.FEaiChartDepartmentScene_onProcessReady;a.onProcess=MO.FEaiChartDepartmentScene_onProcess;a.onSwitchProcess=MO.FEaiChartDepartmentScene_onSwitchProcess;a.onSwitchComplete=MO.FEaiChartDepartmentScene_onSwitchComplete;a.setup=MO.FEaiChartDepartmentScene_setup;a.showParticle=MO.FEaiChartDepartmentScene_showParticle;a.showFace=MO.FEaiChartDepartmentScene_showFace;
a.fixMatrix=MO.FEaiChartDepartmentScene_fixMatrix;a.processResize=MO.FEaiChartDepartmentScene_processResize;return a};MO.FEaiChartDepartmentScene_onInvestmentDataChanged=function(a){var b=a.entity,c=this._liveTable;c.setRank(a.rank);c.pushEntity(b);c.dirty();b&&this._livePop.setData(b)};
MO.FEaiChartDepartmentScene_onOperationVisibility=function(a){this.__base.FEaiChartScene.onOperationVisibility.call(this,a);a.visibility?(this._groundAutio.play(),this._countryEntity._audioMapEnter._hAudio.muted=!1):(this._groundAutio.pause(),this._countryEntity._audioMapEnter._hAudio.muted=!0)};MO.FEaiChartDepartmentScene_onProcessReady=function(){this.__base.FEaiChartScene.onProcessReady.call(this);this._mapEntity.showCity()};
MO.FEaiChartDepartmentScene_onProcess=function(){this.__base.FEaiChartScene.onProcess.call(this);if(!this._statusStart){if(MO.Window.Browser.capability().soundConfirm){var a=document.getElementById("id_ios_play");a&&MO.Window.Html.visibleSet(a,!0);(a=document.getElementById("id_loading"))&&document.body.removeChild(a)}else{if(a=document.getElementById("id_loading"))a.style.opacity=this._statusLayerLevel/this._statusLayerCount,this._statusLayerLevel--;this._statusLayerLevel--}0>=this._statusLayerLevel&&
(a&&document.body.removeChild(a),a=this._countryEntity,a.start(),this._mapEntity.showCountry(a),this.processLoaded(),this._statusStart=this._playing=!0)}if(this._playing){a=this._countryEntity;if(!a.introAnimeDone()){a.process();return}this._mapReady||(this._guiManager.show(),a=MO.Class.create(MO.FGuiActionAlpha),a.setAlphaBegin(0),a.setAlphaEnd(1),a.setAlphaInterval(.01),a.push(this._guiManager),this._guiManager.mainTimeline().pushAction(a),this._mapReady=!0);a=MO.Timer.current();a-this._24HLastTick>
this._24HTrendInterval&&(this._timeline.sync(),this._24HLastTick=a);this._investment.process();var a=this._logoBar,b=a.findComponent("investmentTotal"),c=this._investment.invementTotalCurrent();b.setValue(parseInt(c).toString());a=a.findComponent("investmentDay");b=this._investment.invementDayCurrent();a.setValue(parseInt(b).toString());this._nowTicker.process()&&(a=this._logoBar,b=this._nowDate,b.setNow(),a.findComponent("date").setLabel(b.format("YYYY/MM/DD")),a.findComponent("time").setLabel(b.format("HH24:MI")))}this._livePop.visible()&&
this._livePop.dirty()};MO.FEaiChartDepartmentScene_onSwitchProcess=function(a){};MO.FEaiChartDepartmentScene_onSwitchComplete=function(a){};
MO.FEaiChartDepartmentScene_setup=function(){this.__base.FEaiChartScene.setup.call(this);var a=this._activeStage.dataLayer(),b=this._logoBar=MO.Console.find(MO.FGuiFrameConsole).get(this,"eai.chart.LogoBar");this._guiManager.register(b);b=this._investment=MO.Class.create(MO.FEaiStatisticsInvestment);b.linkGraphicContext(this);b.setMapEntity(this._mapEntity);b.setup();b.addDataChangedListener(this,this.onInvestmentDataChanged);b=b.display();this.fixMatrix(b.matrix());a.push(b);this.activeStage();a=
this._timeline=MO.Class.create(MO.FGui24HTimeline);a.setName("Timeline");a.linkGraphicContext(this);a.sync();a.build();this._guiManager.register(a);a=this._liveTable=MO.Class.create(MO.FGuiLiveTable);a.setName("LiveTable");a.linkGraphicContext(this);a.setup();a.build();this._guiManager.register(a);a=this._livePop=MO.Class.create(MO.FGuiLivePop);a.setName("LivePop");a.linkGraphicContext(this);a.setup();a.build();this._guiManager.register(a);this._guiManager.hide();a=MO.Console.find(MO.FEaiEntityConsole);
a.cityModule().build(this);a=this._countryEntity=a.mapModule().loadCountry(this,MO.EEaiConstant.DefaultCountry);this._readyLoader.push(a)};MO.FEaiChartDepartmentScene_showParticle=function(a,b){var c=this._particle,e=b.location();c.color().set(1,1,0,1);for(var d=0;4>d;d++){var f=parseInt(100*Math.random());Math.random();c.setItemCount(f);c.position().assign(e);c.position().z=a.currentZ();c.setDelay(10*d);c.setSpeed(4+.4*d);c.setAcceleration(0);c.setAttenuation(.8);c.start()}};
MO.FEaiChartDepartmentScene_showFace=function(){this._playing=this._statusStart=!0;this._mapReady=!1;this._mapEntity.reset();this._application.desktop().show();this.processResize()};MO.FEaiChartDepartmentScene_fixMatrix=function(a){MO.Window.Browser.isOrientationVertical()?(a.tx=-14.58,a.ty=-1.9,a.tz=0,a.setScale(.14,.16,.14)):(a.tx=-38.6,a.ty=-12.8,a.tz=0,a.setScale(.32,.36,.32));a.update()};
MO.FEaiChartDepartmentScene_processResize=function(){this.__base.FEaiChartScene.processResize.call(this);var a=MO.Window.Browser.isOrientationVertical();this.fixMatrix(this._investment.display().matrix());var b=this._logoBar;a?(b.setLocation(8,8),b.setScale(.85,.85)):(b.setLocation(5,5),b.setScale(1,1));b=this._southSea;a?(b.setDockCd(MO.EUiDock.RightTop),b.setTop(570),b.setRight(100)):(b.setDockCd(MO.EUiDock.RightBottom),b.setRight(710),b.setBottom(260));b=this._timeline;a?(b.setDockCd(MO.EUiDock.Bottom),
b.setAnchorCd(MO.EUiAnchor.Left|MO.EUiAnchor.Right),b.setLeft(10),b.setRight(10),b.setBottom(920)):(b.setDockCd(MO.EUiDock.Bottom),b.setAnchorCd(MO.EUiAnchor.Left|MO.EUiAnchor.Right),b.setLeft(20),b.setBottom(30),b.setRight(680));b.setHeight(250);b=this._liveTable;a?(b.setDockCd(MO.EUiDock.Bottom),b.setAnchorCd(MO.EUiAnchor.Left|MO.EUiAnchor.Top|MO.EUiAnchor.Right),b.setLeft(10),b.setRight(10),b.setBottom(10),b.setWidth(1060),b.setHeight(900)):(b.setDockCd(MO.EUiDock.Right),b.setAnchorCd(MO.EUiAnchor.Left|
MO.EUiAnchor.Top|MO.EUiAnchor.Bottom),b.setTop(10),b.setRight(0),b.setBottom(10),b.setWidth(650))};MO.FEaiChapter=function(a){return a=MO.Class.inherits(this,a,MO.FChapter)};
MO.FEaiChartChapter=function(a){a=MO.Class.inherits(this,a,MO.FEaiChapter);a._code=MO.EEaiChapter.Chart;a._sceneTotal=MO.Class.register(a,new MO.AGetter("_sceneTotal"));a._sceneHistory=MO.Class.register(a,new MO.AGetter("_sceneHistory"));a._sceneCustomer=MO.Class.register(a,new MO.AGetter("_sceneCustomer"));a._sceneMarketer=MO.Class.register(a,new MO.AGetter("_sceneMarketer"));a._scenePerformence=MO.Class.register(a,new MO.AGetter("_scenePerformence"));a._sceneDepartment=MO.Class.register(a,new MO.AGetter("_sceneDepartment"));
a._sceneLive=MO.Class.register(a,new MO.AGetter("_sceneLive"));a._sceneWorld=MO.Class.register(a,new MO.AGetter("_sceneWorld"));a._sceneSales=MO.Class.register(a,new MO.AGetter("_sceneSales"));a.construct=MO.FEaiChartChapter_construct;a.setup=MO.FEaiChartChapter_setup;a.process=MO.FEaiChartChapter_process;a.dispose=MO.FEaiChartChapter_dispose;return a};MO.FEaiChartChapter_construct=function(){this.__base.FEaiChapter.construct.call(this)};
MO.FEaiChartChapter_setup=function(){var a=this._sceneTotal=MO.Class.create(MO.FEaiChartTotalScene);a.linkGraphicContext(this);this.registerScene(a);a=this._sceneHistory=MO.Class.create(MO.FEaiChartHistoryScene);a.linkGraphicContext(this);this.registerScene(a);a=this._sceneCustomer=MO.Class.create(MO.FEaiChartCustomerScene);a.linkGraphicContext(this);this.registerScene(a);a=this._sceneMarketer=MO.Class.create(MO.FEaiChartMarketerScene);a.linkGraphicContext(this);this.registerScene(a);a=this._sceneDepartment=
MO.Class.create(MO.FEaiChartDepartmentScene);a.linkGraphicContext(this);this.registerScene(a);a=this._sceneLive=MO.Class.create(MO.FEaiChartLiveScene);a.linkGraphicContext(this);this.registerScene(a);a=this._sceneWorld=MO.Class.create(MO.FEaiChartWorldScene);a.linkGraphicContext(this);this.registerScene(a)};MO.FEaiChartChapter_process=function(){this.__base.FEaiChapter.process.call(this)};MO.FEaiChartChapter_dispose=function(){this.__base.FEaiChapter.dispose.call(this)};
MO.FEaiLoadingChapter=function(a){a=MO.Class.inherits(this,a,MO.FEaiChapter);a._code=MO.EEaiChapter.Loading;return a};MO.FEaiLoginChapter=function(a){a=MO.Class.inherits(this,a,MO.FEaiChapter);a._code=MO.EEaiChapter.Login;return a};
MO.FEaiSceneChapter=function(a){a=MO.RClass.inherits(this,a,MO.FEaiChapter);a._code=MO.EEaiChapter.Scene;a._sceneCountry=null;a._sceneGroup=null;a._sceneGroupReport=null;a._sceneCompany=null;a.construct=MO.FEaiSceneChapter_construct;a.setup=MO.FEaiSceneChapter_setup;a.process=MO.FEaiSceneChapter_process;a.dispose=MO.FEaiSceneChapter_dispose;return a};MO.FEaiSceneChapter_construct=function(){this.__base.FEaiChapter.construct.call(this)};
MO.FEaiSceneChapter_setup=function(){var a=this._sceneCountry=MO.Class.create(MO.FEaiCountryScene);a.linkGraphicContext(this);this.registerScene(a);a=this._sceneGroup=MO.Class.create(MO.FEaiGroupScene);a.linkGraphicContext(this);this.registerScene(a);a=this._sceneGroupReport=MO.Class.create(MO.FEaiGroupReportScene);a.linkGraphicContext(this);this.registerScene(a);a=this._sceneCompany=MO.Class.create(MO.FEaiCompanyScene);a.linkGraphicContext(this);this.registerScene(a)};
MO.FEaiSceneChapter_process=function(){this.__base.FEaiChapter.process.call(this)};MO.FEaiSceneChapter_dispose=function(){this.__base.FEaiChapter.dispose.call(this)};MO.FEaiApplication=function(a){a=MO.Class.inherits(this,a,MO.FApplication);a._desktop=MO.Class.register(a,new MO.AGetter("_desktop"));a.setup=MO.FEaiApplication_setup;a.processResize=MO.FEaiApplication_processResize;a.processEvent=MO.FEaiApplication_processEvent;return a};
MO.FEaiApplication_setup=function(a){if(!MO.Window.Browser.supportHtml5())return a=new MO.SEvent,MO.Window.processDeviceError(a),a.dispose(),!1;a=MO.Console.find(MO.FG3dEffectConsole);a.register("general.color.eai.world.face",MO.FEaiWorldFaceEffect);a.register("general.color.eai.map.face",MO.FEaiMapFaceEffect);a.register("general.color.eai.citys",MO.FEaiCityEffect);a.register("general.color.eai.citys.range",MO.FEaiCityRangeEffect);return!0};
MO.FEaiApplication_processResize=function(){this.__base.FApplication.processResize.call(this,event);var a=this._desktop;a&&a.resize()};MO.FEaiApplication_processEvent=function(a){this.__base.FApplication.processEvent.call(this,a);var b=this._desktop;b&&b.processEvent(a)};
MO.FEaiCanvas=function(a){a=MO.Class.inherits(this,a,MO.FE3dCanvas);a._scaleRate=1;a._optionAlpha=!1;a._optionAntialias=!1;a._activeStage=MO.Class.register(a,new MO.AGetter("_activeStage"));a._capturePosition=null;a._captureRotation=null;a.construct=MO.FEaiCanvas_construct;a.resize=MO.FEaiCanvas_resize;a.selectStage=MO.FEaiCanvas_selectStage;a.dispose=MO.FEaiCanvas_dispose;return a};
MO.FEaiCanvas_construct=function(){this.__base.FE3dCanvas.construct.call(this);this._rotation=new MO.SVector3;this._capturePosition=new MO.SPoint2;this._captureRotation=new MO.SVector3};MO.FEaiCanvas_resize=function(a,b){this.__base.FE3dCanvas.resize.call(this,a,b);var c=this._graphicContext.size(),e=this._activeStage;e&&(e=e.camera().projection(),e.size().set(c.width,c.height),e.update())};
MO.FEaiCanvas_selectStage=function(a){a&&(a.linkGraphicContext(this),a.region().linkGraphicContext(this),a.selectTechnique(this,MO.FE3dGeneralTechnique));this._activeStage=a};MO.FEaiCanvas_dispose=function(){this._rotation=MO.Lang.Object.dispose(this._rotation);this._capturePosition=MO.Lang.Object.dispose(this._capturePosition);this._captureRotation=MO.Lang.Object.dispose(this._captureRotation);this.__base.FE3dCanvas.dispose.call(this)};
MO.FEaiChartApplication=function(a){a=MO.Class.inherits(this,a,MO.FEaiApplication);a._sceneCode=MO.Class.register(a,new MO.AGetSet("_sceneCode"),MO.EEaiScene.ChartCustomer);a._chapterLoading=MO.Class.register(a,new MO.AGetter("_chapterLoading"));a._chapterChart=MO.Class.register(a,new MO.AGetter("_chapterChart"));a._dynamicInfo=MO.Class.register(a,new MO.AGetter("_dynamicInfo"));a.onLoadResource=MO.FEaiChartApplication_onLoadResource;a.construct=MO.FEaiChartApplication_construct;a.setup=MO.FEaiChartApplication_setup;
a.dispose=MO.FEaiChartApplication_dispose;return a};MO.FEaiChartApplication_onLoadResource=function(){this.selectChapterByCode(MO.EEaiChapter.Chart).selectSceneByCode(this._sceneCode);this.processResize()};MO.FEaiChartApplication_construct=function(){this.__base.FEaiApplication.construct.call(this)};
MO.FEaiChartApplication_setup=function(a){var b=this.__base.FEaiApplication.setup.call(this,a);if(!b)return b;this._hPanel=a;b=this._desktop=MO.Class.create(MO.FEaiChartDesktop);b.build(a);a=MO.Eai.Canvas=b.canvas3d();if(a.graphicContext().isValid())return this.linkGraphicContext(a),b=this._dynamicInfo=MO.Class.create(MO.FEaiDynamicInfo),b.linkGraphicContext(a),b.setContext(a.graphicContext()),b.location().set(10,300),b.build(),a=this._chapterChart=MO.Class.create(MO.FEaiChartChapter),a.linkGraphicContext(this),
this.registerChapter(a),a=MO.Console.find(MO.FEaiResourceConsole),a.addLoadListener(this,this.onLoadResource),a.load("{eai.resource}/resource.dat"),!0};MO.FEaiChartApplication_dispose=function(){this._chapterLoading=MO.Lang.Object.dispose(this._chapterLoading);this._chapterChart=MO.Lang.Object.dispose(this._chapterChart);this._dynamicInfo=MO.Lang.Object.dispose(this._dynamicInfo);this.__base.FEaiApplication.dispose.call(this)};
MO.FEaiChartCanvas=function(a){a=MO.Class.inherits(this,a,MO.FEaiCanvas);a._optionStageProcess=!1;a._optionResize=!1;a._optionMouseCapture=!1;a._optionAlpha=!0;a._optionAntialias=!1;a._capturePosition=null;a._cameraPosition=null;a.construct=MO.FEaiChartCanvas_construct;a.setPanel=MO.FEaiChartCanvas_setPanel;a.dispose=MO.FEaiChartCanvas_dispose;return a};MO.FEaiChartCanvas_construct=function(){this.__base.FEaiCanvas.construct.call(this);this._logicSize.set(1920,1080);this._cameraPosition=new MO.SPoint3};
MO.FEaiChartCanvas_setPanel=function(a){this._hPanel=a;a.appendChild(this._hCanvas)};MO.FEaiChartCanvas_dispose=function(){this._cameraPosition=MO.Lang.Object.dispose(this._cameraPosition);this.__base.FEaiCanvas.dispose.call(this)};
MO.FEaiChartDesktop=function(a){a=MO.Class.inherits(this,a,MO.FEaiDesktop);a._orientationCd=null;a._visible=MO.Class.register(a,new MO.AGetter("_visible"),!0);a._canvas3d=MO.Class.register(a,new MO.AGetter("_canvas3d"));a._canvas2d=MO.Class.register(a,new MO.AGetter("_canvas2d"));a.onOperationResize=MO.FEaiChartDesktop_onOperationResize;a.onOperationOrientation=MO.FEaiChartDesktop_onOperationOrientation;a.construct=MO.FEaiChartDesktop_construct;a.build=MO.FEaiChartDesktop_build;a.resize=MO.FEaiChartDesktop_resize;
a.show=MO.FEaiChartDesktop_show;a.hide=MO.FEaiChartDesktop_hide;a.setVisible=MO.FEaiChartDesktop_setVisible;a.selectStage=MO.FEaiChartDesktop_selectStage;a.dispose=MO.FEaiChartDesktop_dispose;return a};MO.FEaiChartDesktop_onOperationResize=function(a){this.__base.FEaiDesktop.onOperationResize.call(this,a);this.resize()};MO.FEaiChartDesktop_onOperationOrientation=function(){this.__base.FEaiDesktop.onOperationOrientation.call(this,event);this.resize()};MO.FEaiChartDesktop_construct=function(){this.__base.FEaiDesktop.construct.call(this)};
MO.FEaiChartDesktop_build=function(a){this.__base.FEaiDesktop.build.call(this,a);var b=this._canvas3d=MO.Class.create(MO.FEaiChartCanvas);b.setDesktop(this);b.build(a);b.setPanel(a);this.canvasRegister(b);b=this._canvas2d=MO.Class.create(MO.FGuiCanvas);b.setDesktop(this);b.build(a);b.setPanel(a);b._hCanvas.style.position="absolute";this.canvasRegister(b);MO.RE3dEngine.setup()};
MO.FEaiChartDesktop_resize=function(a,b){var c=MO.Window.Browser,e=null!=a?a:window.innerWidth,d=null!=b?b:window.innerHeight,f=c.orientationCd();if(!this._screenSize.equalsData(e,d)||this._orientationCd!=f){this._screenSize.set(e,d);this._orientationCd=f;var g=c.capability().pixelRatio,f=parseInt(e*g),g=parseInt(d*g);this._size.set(f,g);var h=1,m=1,k=this._logicSize;c.isOrientationVertical()?(h=f/k.height,m=g/k.width,this._calculateSize.set(k.height,k.width)):(h=f/k.width,m=g/k.height,this._calculateSize.set(k.width,
k.height));k=this._sizeRate=Math.min(h,m);this._logicRate.set(h,m);h>m?this._calculateRate.set(h/k,1):h<m?this._calculateRate.set(1,m/k):this._calculateRate.set(1,1);h=this._canvas3d;c.capability().canvasScale?h.resize(f,g):h.resize(e,d);h.graphicContext().setViewport(0,0,f,g);c=this._canvas2d;c.resize(f,g);c.graphicContext().setGlobalScale(k,k);c=this._canvas3d.activeStage();this.selectStage(c)}};MO.FEaiChartDesktop_show=function(){this.setVisible(!0)};MO.FEaiChartDesktop_hide=function(){this.setVisible(!1)};
MO.FEaiChartDesktop_setVisible=function(a){this._visible=a;this._canvas2d.setVisible(a);this._canvas3d.setVisible(a)};MO.FEaiChartDesktop_selectStage=function(a){this._canvas3d.selectStage(a);if(a){var b=a.region().camera(),c=b.projection();c.setAngle(80);c.size().assign(this._size);c.update();b.position().set(0,0,-10);b.lookAt(0,0,0);b.update()}this._activeStage=a};
MO.FEaiChartDesktop_dispose=function(){this._canvas3d=MO.Lang.Object.dispose(this._canvas3d);this._canvas2d=MO.Lang.Object.dispose(this._canvas2d);this.__base.FEaiDesktop.dispose.call(this)};MO.FEaiDesktop=function(a){a=MO.Class.inherits(this,a,MO.FDesktop);a.construct=MO.FEaiDesktop_construct;a.dispose=MO.FEaiDesktop_dispose;return a};MO.FEaiDesktop_construct=function(){this.__base.FDesktop.construct.call(this);this._size.set(1920,1080);this._logicSize.set(1920,1080)};MO.FEaiDesktop_dispose=function(){this.__base.FDesktop.dispose.call(this)};
MO.FEaiFlatCanvas=function(a){a=MO.Class.inherits(this,a,MO.FEaiCanvas);a._capturePosition=null;a._cameraPosition=null;a.onEnterFrame=MO.FEaiFlatCanvas_onEnterFrame;a.onMouseCaptureStart=MO.FEaiFlatCanvas_onMouseCaptureStart;a.onMouseCapture=MO.FEaiFlatCanvas_onMouseCapture;a.onMouseCaptureStop=MO.FEaiFlatCanvas_onMouseCaptureStop;a.construct=MO.FEaiFlatCanvas_construct;a.setPanel=MO.FEaiFlatCanvas_setPanel;a.dispose=MO.FEaiFlatCanvas_dispose;return a};
MO.FEaiFlatCanvas_onEnterFrame=function(){var a=this._activeStage;if(a){var a=a.camera(),b=RKeyboard.isPress(EKeyCode.W),c=RKeyboard.isPress(EKeyCode.S);b&&!c&&a.doMoveY(.5);!b&&c&&a.doMoveY(-.5);b=RKeyboard.isPress(EKeyCode.A);c=RKeyboard.isPress(EKeyCode.D);b&&!c&&a.doMoveX(-.5);!b&&c&&a.doMoveX(.5);a.update()}};MO.FEaiFlatCanvas_onMouseCaptureStart=function(a){var b=this._activeStage;b&&(this._capturePosition.set(a.clientX,a.clientY),this._cameraPosition.assign(b.camera().position()))};
MO.FEaiFlatCanvas_onMouseCapture=function(a){var b=this._activeStage;if(b){var c=a.clientX-this._capturePosition.x;a=a.clientY-this._capturePosition.y;b=b.camera().position();b.x=this._cameraPosition.x-.03*c;b.y=this._cameraPosition.y+.03*a}};MO.FEaiFlatCanvas_onMouseCaptureStop=function(a){};MO.FEaiFlatCanvas_construct=function(){this.__base.FEaiCanvas.construct.call(this);this._logicSize=new SSize2(1920,1080);this._cameraPosition=new SPoint3};
MO.FEaiFlatCanvas_setPanel=function(a){this.__base.FEaiCanvas.setPanel.call(this,a)};MO.FEaiFlatCanvas_dispose=function(){this._cameraPosition=RObject.dispose(this._cameraPosition);this.__base.FEaiCanvas.dispose.call(this)};
MO.FEaiPlatformApplication=function(a){a=MO.Class.inherits(this,a,MO.FEaiApplication);a._chapterLoading=MO.Class.register(a,new MO.AGetter("_chapterLoading"));a._chapterLogin=MO.Class.register(a,new MO.AGetter("_chapterLogin"));a._chapterScene=MO.Class.register(a,new MO.AGetter("_chapterScene"));a._chapterChart=MO.Class.register(a,new MO.AGetter("_chapterChart"));a._thread=null;a._interval=10;a.onLoadResource=MO.FEaiPlatformApplication_onLoadResource;a.construct=MO.FEaiPlatformApplication_construct;
a.createCanvas=MO.FEaiPlatformApplication_createCanvas;a.setup=MO.FEaiPlatformApplication_setup;a.dispose=MO.FEaiPlatformApplication_dispose;return a};MO.FEaiPlatformApplication_onLoadResource=function(){this.selectChapterByCode(MO.EEaiChapter.Scene).selectSceneByCode(MO.EEaiScene.Country)};MO.FEaiPlatformApplication_construct=function(){this.__base.FEaiApplication.construct.call(this)};MO.FEaiPlatformApplication_createCanvas=function(){return RClass.create(FEaiPlatformCanvas)};
MO.FEaiPlatformApplication_setup=function(){var a=this._chapterLoading=MO.RClass.create(MO.FEaiLoadingChapter);a.linkGraphicContext(this);this.registerChapter(a);a=this._chapterLogin=MO.RClass.create(MO.FEaiLoginChapter);a.linkGraphicContext(this);this.registerChapter(a);a=this._chapterScene=MO.RClass.create(MO.FEaiSceneChapter);a.linkGraphicContext(this);this.registerChapter(a);a=this._chapterChart=MO.RClass.create(MO.FEaiChartChapter);a.linkGraphicContext(this);this.registerChapter(a);a=MO.RConsole.find(MO.FEaiResourceConsole);
a.addLoadListener(this,this.onLoadResource);a.load()};MO.FEaiPlatformApplication_dispose=function(){this.__base.FEaiApplication.dispose.call(this)};
MO.FEaiPlatformCanvas=function(a){a=MO.Class.inherits(this,a,MO.FEaiCanvas);a._capturePosition=null;a._captureRotation=null;a.onEnterFrame=MO.FEaiPlatformCanvas_onEnterFrame;a.onMouseCaptureStart=MO.FEaiPlatformCanvas_onMouseCaptureStart;a.onMouseCapture=MO.FEaiPlatformCanvas_onMouseCapture;a.onMouseCaptureStop=MO.FEaiPlatformCanvas_onMouseCaptureStop;a.construct=MO.FEaiPlatformCanvas_construct;a.dispose=MO.FEaiPlatformCanvas_dispose;return a};
MO.FEaiPlatformCanvas_onEnterFrame=function(){var a=this._activeStage;if(a){var b=a.camera(),c=.05,e=RKeyboard.isPress(EKeyCode.W),d=RKeyboard.isPress(EKeyCode.S);e&&!d&&b.doWalk(.5);!e&&d&&b.doWalk(-.5);e=RKeyboard.isPress(EKeyCode.A);d=RKeyboard.isPress(EKeyCode.D);e&&!d&&b.doYaw(c);!e&&d&&b.doYaw(-c);e=RKeyboard.isPress(EKeyCode.Q);d=RKeyboard.isPress(EKeyCode.E);e&&!d&&b.doFly(.5);!e&&d&&b.doFly(-.5);d=RKeyboard.isPress(EKeyCode.Z);e=RKeyboard.isPress(EKeyCode.X);d&&!e&&b.doPitch(c);!d&&e&&b.doPitch(-c);
b.update();if(this._optionRotation){c=this._rotation;a=a.layers();b=a.count();for(e=0;e<b;e++)d=a.value(e).matrix(),d.setRotation(0,c.y,0),d.update();c.y+=.01}}};MO.FEaiPlatformCanvas_onMouseCaptureStart=function(a){var b=this._activeStage;if(b){var c=this._activeStage.region();RConsole.find(FG3dTechniqueConsole).find(this._graphicContext,FG3dSelectTechnique).test(c,a.offsetX,a.offsetY);this._capturePosition.set(a.clientX,a.clientY);this._captureRotation.assign(b.camera()._rotation)}};
MO.FEaiPlatformCanvas_onMouseCapture=function(a){if(this._activeStage){var b=a.clientX-this._capturePosition.x;a=a.clientY-this._capturePosition.y;var c=this._activeStage.camera().rotation(),e=this._captureRotation;c.x=e.x+.003*a;c.y=e.y+.003*b}};MO.FEaiPlatformCanvas_onMouseCaptureStop=function(a){};MO.FEaiPlatformCanvas_construct=function(){this.__base.FEaiCanvas.construct.call(this)};MO.FEaiPlatformCanvas_dispose=function(){this.__base.FEaiCanvas.dispose.call(this)};MO.Eai.setup=function(a,b){};
