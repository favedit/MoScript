MO.EEaiChapter=new function(){this.Loading="loading";this.Login="login";this.Scene="scene";this.Chart="chart";return this};MO.EEaiConstant=new function(){this.ServiceHost="eai.logic.service";this.Resource="eai.resource";return this};MO.EEaiRate=new function(){this.Line=0;this.Map=1;this.Investment=2;return this};
MO.EEaiScene=new function(){this.Group="group";this.GroupReport="group.report";this.Company="company";this.Country="country";this.ChartHistory="chart.history";this.ChartIndustry="chart.industry";this.ChartInvestment="chart.investment";this.ChartCustomer="chart.customer";this.ChartStatistics="chart.statistics";return this};MO.Eai=new function(){this.Canvas=this.Application=null;return this};MO.FEaiEntity=function(a){return a=MO.Class.inherits(this,a,MO.FObject)};
with(MO)MO.FEaiTable=function(a){a=RClass.inherits(this,a,FObject);a._headLineCount=0;a._hTable=null;a.createRow=FEaiTable_createRow;a.setDataCount=FEaiTable_setDataCount;a.dataRow=FEaiTable_dataRow;return a},MO.FEaiTable_createRow=function(){},MO.FEaiTable_setDataCount=function(a){for(var b=this._headLineCount,c=b+a,d=this._hTable.rows.length,e=d;e<c;e++)this.createRow();d=this._hTable.rows.length;for(e=b;e<d;e++)this._hTable.rows[e].style.display=e-b<a?null:"none"},MO.FEaiTable_dataRow=function(a){return this._hTable.rows[this._headLineCount+
a]};MO.FEaiCardResource=function(a){a=RClass.inherits(this,a,FObject);a._cardCode=MO.Class.register(a,new MO.AGetter("_cardCode"));a._cityCode=MO.Class.register(a,new MO.AGetter("_cityCode"));a.unserialize=FEaiCardResource_unserialize;return a};MO.FEaiCardResource_unserialize=function(a){this._cardCode=a.readUint16();this._cityCode=a.readUint16()};
MO.FEaiCardResourceConsole=function(a){a=MO.Class.inherits(this,a,MO.FConsole);a._cards=MO.Class.register(a,new MO.AGetter("_cards"));a.construct=MO.FEaiCardResourceConsole_construct;a.find=MO.FEaiCardResourceConsole_find;a.unserialize=MO.FEaiCardResourceConsole_unserialize;a.dispose=MO.FEaiCardResourceConsole_dispose;return a};MO.FEaiCardResourceConsole_construct=function(){this.__base.FConsole.construct.call(this);this._cards=new MO.TDictionary};MO.FEaiCardResourceConsole_find=function(a){return this._cards.get(a)};
MO.FEaiCardResourceConsole_unserialize=function(a){for(var b=this._cards,c=a.readInt32(),d=0;d<c;d++){var e=MO.Class.create(MO.FEaiCardResource);e.unserialize(a);b.set(e.code(),e)}};MO.FEaiCardResourceConsole_dispose=function(){this._cards=MO.Lang.Object.dispose(this._cards);this.__base.FConsole.dispose.call(this)};
with(MO)MO.FEaiCityResource=function(a){a=RClass.inherits(this,a,FObject);a._provinceCode=RClass.register(a,new AGetter("_provinceCode"));a._code=RClass.register(a,new AGetter("_code"));a._label=RClass.register(a,new AGetter("_label"));a._level=RClass.register(a,new AGetter("_level"));a._location=RClass.register(a,new AGetter("_location"));a.construct=FEaiCityResource_construct;a.unserialize=FEaiCityResource_unserialize;a.dispose=FEaiCityResource_dispose;return a},MO.FEaiCityResource_construct=function(){this.__base.FObject.construct.call(this);
this._location=new SPoint3},MO.FEaiCityResource_unserialize=function(a){this._provinceCode=a.readUint16();this._code=a.readUint16();this._label=a.readString();this._level=a.readUint16();this._location.unserialize(a)},MO.FEaiCityResource_dispose=function(){this._location=RObject.dispose(this._location);this.__base.FObject.dispose.call(this)};
with(MO)MO.FEaiCityResourceConsole=function(a){a=RClass.inherits(this,a,FConsole);a._citys=RClass.register(a,new AGetter("_citys"));a.construct=FEaiCityResourceConsole_construct;a.find=FEaiCityResourceConsole_find;a.findCityByCard=FEaiCityResourceConsole_findCityByCard;a.unserialize=FEaiCityResourceConsole_unserialize;a.dispose=FEaiCityResourceConsole_dispose;return a},MO.FEaiCityResourceConsole_construct=function(){this.__base.FConsole.construct.call(this);this._citys=new TDictionary},MO.FEaiCityResourceConsole_find=
function(a){return this._citys.get(a)},MO.FEaiCityResourceConsole_findCityByCard=function(a){if(4!=a.length)return null;var b=this._citys;if(b=b.get(a))return b;b=this._citys;return(b=b.get(a.substring(0,2)))?b:null},MO.FEaiCityResourceConsole_unserialize=function(a){for(var b=this._citys,c=a.readInt32(),d=0;d<c;d++){var e=RClass.create(FEaiCityResource);e.unserialize(a);b.set(e.code(),e)}},MO.FEaiCityResourceConsole_dispose=function(){this._citys=RObject.dispose(this._citys);this.__base.FConsole.dispose.call(this)};
with(MO)MO.FEaiHistoryCityResource=function(a){a=RClass.inherits(this,a,FObject);a._code=RClass.register(a,new AGetSet("_code"));a._investmentDay=RClass.register(a,new AGetSet("_investmentDay"));a._investmentTotal=RClass.register(a,new AGetSet("_investmentTotal"));a.unserialize=FEaiHistoryCityResource_unserialize;return a},MO.FEaiHistoryCityResource_unserialize=function(a){this._code=a.readUint16();this._investmentDay=a.readFloat();this._investmentTotal=a.readFloat()};
with(MO)MO.FEaiHistoryDateResource=function(a){a=RClass.inherits(this,a,FObject);a._code=RClass.register(a,new AGetter("_code"));a._investmentDay=RClass.register(a,new AGetter("_investmentDay"));a._investmentTotal=RClass.register(a,new AGetter("_investmentTotal"));a._provinces=RClass.register(a,new AGetter("_provinces"));a._citys=RClass.register(a,new AGetter("_citys"));a.construct=FEaiHistoryDateResource_construct;a.unserialize=FEaiHistoryDateResource_unserialize;a.dispose=FEaiHistoryDateResource_dispose;
return a},MO.FEaiHistoryDateResource_construct=function(){this.__base.FObject.construct.call(this);this._provinces=new TDictionary;this._citys=new TDictionary},MO.FEaiHistoryDateResource_unserialize=function(a){this._code=a.readString();this._investmentDay=a.readFloat();this._investmentTotal=a.readFloat();for(var b=this._provinces,c=a.readInt32(),d=0;d<c;d++){var e=RClass.create(FEaiHistoryProvinceResource);e.unserialize(a);b.set(e.code(),e)}b=this._citys;c=a.readInt32();for(d=0;d<c;d++)e=RClass.create(FEaiHistoryCityResource),
e.unserialize(a),b.set(e.code(),e)},MO.FEaiHistoryDateResource_dispose=function(){this._provinces=RObject.dispose(this._provinces);this._citys=RObject.dispose(this._citys);this.__base.FObject.dispose.call(this)};
with(MO)MO.FEaiHistoryMilestoneResource=function(a){a=RClass.inherits(this,a,FObject);a._code=RClass.register(a,new AGetSet("_code"));a._investmentTotal=RClass.register(a,new AGetSet("_investmentTotal"));a._dayCount=RClass.register(a,new AGetSet("_dayCount"));a._companyCount=RClass.register(a,new AGetSet("_companyCount"));a._staffCount=RClass.register(a,new AGetSet("_staffCount"));a.unserialize=FEaiHistoryMilestoneResource_unserialize;return a},MO.FEaiHistoryMilestoneResource_unserialize=function(a){this._code=
a.readString();this._investmentTotal=a.readFloat();this._dayCount=a.readUint16();this._companyCount=a.readUint16();this._staffCount=a.readUint16()};
with(MO)MO.FEaiHistoryProvinceResource=function(a){a=RClass.inherits(this,a,FObject);a._code=RClass.register(a,new AGetSet("_code"));a._investmentDay=RClass.register(a,new AGetSet("_investmentDay"));a._investmentTotal=RClass.register(a,new AGetSet("_investmentTotal"));a.unserialize=FEaiHistoryProvinceResource_unserialize;return a},MO.FEaiHistoryProvinceResource_unserialize=function(a){this._code=a.readUint16();this._investmentDay=a.readFloat();this._investmentTotal=a.readFloat()};
MO.FEaiHistoryResourceConsole=function(a){a=MO.Class.inherits(this,a,MO.FConsole,MO.MListener);a._investmentDay=MO.Class.register(a,new MO.AGetter("_investmentDay"));a._investmentTotal=MO.Class.register(a,new MO.AGetter("_investmentTotal"));a._investmentProvinceDay=MO.Class.register(a,new MO.AGetter("_investmentProvinceDay"));a._investmentProvinceTotal=MO.Class.register(a,new MO.AGetter("_investmentProvinceTotal"));a._investmentCityDay=MO.Class.register(a,new MO.AGetter("_investmentCityDay"));a._investmentCityTotal=
MO.Class.register(a,new MO.AGetter("_investmentCityTotal"));a._provinces=MO.Class.register(a,new MO.AGetter("_provinces"));a._citys=MO.Class.register(a,new MO.AGetter("_citys"));a._milestones=MO.Class.register(a,new MO.AGetter("_milestones"));a._dates=MO.Class.register(a,new MO.AGetter("_dates"));a._listenersLoad=MO.Class.register(a,new MO.AListener("_listenersLoad",MO.EEvent.Load));a.construct=MO.FEaiHistoryResourceConsole_construct;a.unserialize=MO.FEaiHistoryResourceConsole_unserialize;a.load=
MO.FEaiHistoryResourceConsole_load;a.dispose=MO.FEaiHistoryResourceConsole_dispose;return a};MO.FEaiHistoryResourceConsole_construct=function(){this.__base.FConsole.construct.call(this);this._provinces=new MO.TDictionary;this._citys=new MO.TDictionary;this._milestones=new MO.TDictionary;this._dates=new MO.TDictionary};
MO.FEaiHistoryResourceConsole_unserialize=function(a){this._investmentDay=a.readFloat();this._investmentTotal=a.readFloat();this._investmentProvinceDay=a.readFloat();this._investmentProvinceTotal=a.readFloat();this._investmentCityDay=a.readFloat();this._investmentCityTotal=a.readFloat();for(var b=a.readInt32(),c=0;c<b;c++){var d=MO.Class.create(MO.FEaiHistoryProvinceResource);d.unserialize(a);this._provinces.set(d.code(),d)}b=a.readInt32();for(c=0;c<b;c++)d=MO.Class.create(MO.FEaiHistoryCityResource),
d.unserialize(a),this._citys.set(d.code(),d);b=a.readInt32();for(c=0;c<b;c++)d=MO.Class.create(MO.FEaiHistoryMilestoneResource),d.unserialize(a),this._milestones.set(d.code(),d);b=a.readInt32();for(c=0;c<b;c++)d=MO.Class.create(MO.FEaiHistoryDateResource),d.unserialize(a),this._dates.set(d.code(),d)};
MO.FEaiHistoryResourceConsole_dispose=function(){this._provinces=RObject.dispose(this._provinces);this._citys=RObject.dispose(this._citys);this._milestones=RObject.dispose(this._milestones);this._dates=RObject.dispose(this._dates);this.__base.FConsole.dispose.call(this)};
with(MO)MO.FEaiProvinceResource=function(a){a=RClass.inherits(this,a,FObject);a._code=RClass.register(a,new AGetter("_code"));a._name=RClass.register(a,new AGetter("_name"));a._label=RClass.register(a,new AGetter("_label"));a._displayOrder=RClass.register(a,new AGetter("_displayOrder"));a.unserialize=FEaiProvinceResource_unserialize;return a},MO.FEaiProvinceResource_unserialize=function(a){this._code=a.readUint16();this._name=a.readString();this._label=a.readString();this._displayOrder=a.readUint16()};
with(MO)MO.FEaiProvinceResourceConsole=function(a){a=RClass.inherits(this,a,FConsole);a._provinceCodes=RClass.register(a,new AGetter("_provinceCodes"));a._provinceNames=RClass.register(a,new AGetter("_provinceNames"));a.construct=FEaiProvinceResourceConsole_construct;a.findByCode=FEaiProvinceResourceConsole_findByCode;a.findByName=FEaiProvinceResourceConsole_findByName;a.unserialize=FEaiProvinceResourceConsole_unserialize;a.dispose=FEaiProvinceResourceConsole_dispose;return a},MO.FEaiProvinceResourceConsole_construct=
function(){this.__base.FConsole.construct.call(this);this._provinceCodes=new TDictionary;this._provinceNames=new TDictionary},MO.FEaiProvinceResourceConsole_findByCode=function(a){return this._provinceCodes.get(a)},MO.FEaiProvinceResourceConsole_findByName=function(a){return this._provinceNames.get(a)},MO.FEaiProvinceResourceConsole_unserialize=function(a){for(var b=this._provinceCodes,c=this._provinceNames,d=a.readInt32(),e=0;e<d;e++){var f=RClass.create(FEaiProvinceResource);f.unserialize(a);b.set(f.code(),
f);c.set(f.name(),f)}},MO.FEaiProvinceResourceConsole_dispose=function(){this._provinceCodes=RObject.dispose(this._provinceCodes);this._provinceNames=RObject.dispose(this._provinceNames);this.__base.FConsole.dispose.call(this)};
with(MO)MO.FEaiRateResource=function(a){a=RClass.inherits(this,a,FObject);a._count=RClass.register(a,new AGetter("_count"));a._colors=RClass.register(a,new AGetter("_colors"));a.construct=FEaiRateResource_construct;a.find=FEaiRateResource_find;a.findRate=FEaiRateResource_findRate;a.unserialize=FEaiRateResource_unserialize;a.dispose=FEaiRateResource_dispose;return a},MO.FEaiRateResource_construct=function(){this.__base.FObject.construct.call(this)},MO.FEaiRateResource_find=function(a){a=parseInt(a);
0>a&&(a=0);a>this._count&&(a=this._count-1);return this._colors[a]},MO.FEaiRateResource_findRate=function(a){return this.find(a*this._count)},MO.FEaiRateResource_unserialize=function(a){for(var b=this._count=a.readInt32(),c=this._colors=new Uint32Array(b),d=0;d<b;d++)c[d]=a.readUint32()},MO.FEaiRateResource_dispose=function(){this._colors=null;this.__base.FObject.dispose.call(this)};
with(MO)MO.FEaiRateResourceConsole=function(a){a=RClass.inherits(this,a,FConsole);a._rates=RClass.register(a,new AGetter("_rates"));a.construct=FEaiRateResourceConsole_construct;a.find=FEaiRateResourceConsole_find;a.unserialize=FEaiRateResourceConsole_unserialize;a.dispose=FEaiRateResourceConsole_dispose;return a},MO.FEaiRateResourceConsole_construct=function(){this.__base.FConsole.construct.call(this);this._rates=new TObjects},MO.FEaiRateResourceConsole_find=function(a){return this._rates.get(a)},
MO.FEaiRateResourceConsole_unserialize=function(a){for(var b=this._count=a.readInt32(),c=0;c<b;c++){var d=MO.Class.create(FEaiRateResource);d.unserialize(a);this._rates.push(d)}},MO.FEaiRateResourceConsole_dispose=function(){this._rates=RObject.dispose(this._rates);this.__base.FConsole.dispose.call(this)};
MO.FEaiResourceConsole=function(a){a=MO.RClass.inherits(this,a,MO.FConsole,MO.MListener);a._scopeCd=MO.EScope.Local;a._rateConsole=MO.Class.register(a,new MO.AGetter("_rateConsole"));a._provinceConsole=MO.Class.register(a,new MO.AGetter("_provinceConsole"));a._cityConsole=MO.Class.register(a,new MO.AGetter("_cityConsole"));a._cardConsole=MO.Class.register(a,new MO.AGetter("_cardConsole"));a._historyConsole=MO.Class.register(a,new MO.AGetter("_historyConsole"));a._loadListeners=MO.Class.register(a,
new MO.AListener("_loadListeners",MO.EEvent.Load));a.onLoad=MO.FEaiResourceConsole_onLoad;a.construct=MO.FEaiResourceConsole_construct;a.unserialize=MO.FEaiResourceConsole_unserialize;a.load=MO.FEaiResourceConsole_load;a.dispose=MO.FEaiResourceConsole_dispose;return a};MO.FEaiResourceConsole_onLoad=function(a){a=a.outputData();var b=MO.Class.create(MO.FDataView);b.setEndianCd(!0);b.link(a);this.unserialize(b);b.dispose();a=new MO.SEvent;this.processLoadListener(a);a.dispose()};
MO.FEaiResourceConsole_construct=function(){this.__base.FConsole.construct.call(this);this._rateConsole=MO.Class.create(MO.FEaiRateResourceConsole);this._provinceConsole=MO.Class.create(MO.FEaiProvinceResourceConsole);this._cityConsole=MO.Class.create(MO.FEaiCityResourceConsole);this._cardConsole=MO.Class.create(MO.FEaiCardResourceConsole);this._historyConsole=MO.Class.create(MO.FEaiHistoryResourceConsole)};
MO.FEaiResourceConsole_unserialize=function(a){var b=a.readString();if("chart-live"==b)this._rateConsole.unserialize(a),this._provinceConsole.unserialize(a),this._cityConsole.unserialize(a),this._cardConsole.unserialize(a);else if("chart-history"==b)this._rateConsole.unserialize(a),this._provinceConsole.unserialize(a),this._cityConsole.unserialize(a),this._cardConsole.unserialize(a),this._historyConsole.unserialize(a);else throw new TError("Unserialize code failure.");};
MO.FEaiResourceConsole_load=function(a){a=MO.Console.find(MO.FEnvironmentConsole).parse("{eai.resource}"+a);MO.Console.find(MO.FHttpConsole).send(a).addLoadListener(this,this.onLoad)};
MO.FEaiResourceConsole_dispose=function(a){this._rateConsole=MO.Lang.Object.dispose(this._rateConsole);this._provinceConsole=MO.Lang.Object.dispose(this._provinceConsole);this._cityConsole=MO.Lang.Object.dispose(this._cityConsole);this._cardConsole=MO.Lang.Object.dispose(this._cardConsole);this._historyConsole=MO.Lang.Object.dispose(this._historyConsole);this.__base.FConsole.dispose.call(this)};
with(MO)MO.FEaiLogic=function(a){a=RClass.inherits(this,a,FObject);a._code=null;a.makeUrl=FEaiLogic_makeUrl;a.send=FEaiLogic_send;return a},MO.FEaiLogic_makeUrl=function(a,b){var c="http://"+MO.RConsole.find(MO.FEnvironmentConsole).findValue(MO.EEaiConstant.ServiceHost)+"/eai/"+this._code+"/"+a;b&&(c+="?"+b);return c},MO.FEaiLogic_send=function(a,b,c,d){a=this.makeUrl(a,b);a=RConsole.find(FJsonConsole).sendAsync(a);a.addProcessListener(c,d);return a};
with(MO)MO.FEaiLogicAchievement=function(a){a=RClass.inherits(this,a,FEaiLogic);a._code="achievement";a.doGroup=FEaiLogicAchievement_doGroup;a.doSort=FEaiLogicAchievement_doSort;a.doQuery=FEaiLogicAchievement_doQuery;return a},MO.FEaiLogicAchievement_doGroup=function(a,b){return this.send("group",null,a,b)},MO.FEaiLogicAchievement_doSort=function(a,b){return this.send("sort",null,a,b)},MO.FEaiLogicAchievement_doQuery=function(a,b){return this.send("query",null,a,b)};
MO.FEaiLogicConsole=function(a){a=MO.Class.inherits(this,a,MO.FConsole);a._system=MO.Class.register(a,new MO.AGetter("_system"));a._organization=MO.Class.register(a,new MO.AGetter("_organization"));a._achievement=MO.Class.register(a,new MO.AGetter("_achievement"));a._schedule=MO.Class.register(a,new MO.AGetter("_schedule"));a._statistics=MO.Class.register(a,new MO.AGetter("_statistics"));a._thread=null;a._interval=6E5;a.onProcess=MO.FEaiLogicConsole_onProcess;a.construct=MO.FEaiLogicConsole_construct;
a.dispose=MO.FEaiLogicConsole_dispose;return a};MO.FEaiLogicConsole_onProcess=function(a){this._system.refresh()};
MO.FEaiLogicConsole_construct=function(){this.__base.FConsole.construct.call(this);this._system=MO.Class.create(MO.FEaiLogicSystem);this._organization=MO.Class.create(MO.FEaiLogicOrganization);this._achievement=MO.Class.create(MO.FEaiLogicAchievement);this._schedule=MO.Class.create(MO.FEaiLogicSchedule);this._statistics=MO.Class.create(MO.FEaiLogicStatistics);var a=this._thread=MO.Class.create(MO.FThread);a.setInterval(this._interval);a.addProcessListener(this,this.onProcess);MO.Console.find(MO.FThreadConsole).start(a)};
MO.FEaiLogicConsole_dispose=function(){this._system=MO.RObject.dispose(this._system);this._organization=MO.RObject.dispose(this._organization);this._achievement=MO.RObject.dispose(this._achievement);this._schedule=MO.RObject.dispose(this._schedule);this._statistics=MO.RObject.dispose(this._statistics);this.__base.FConsole.dispose.call(this)};
with(MO)MO.FEaiLogicOrganization=function(a){a=RClass.inherits(this,a,FEaiLogic);a._code="organization";a._pIdMIndexDict=RClass.register(a,new AGetter("_pIdMIndexDict"));a._cityIdNameDict=RClass.register(a,new AGetter("_cityIdNameDict"));a._provinceColors=RClass.register(a,new AGetter("_provinceColors"));a.doFetch=FEaiLogicOrganization_doFetch;a.getMeshIndex=FEaiLogicOrganization_getMeshIndex;a.construct=FEaiLogicOrganization_construct;return a},MO.FEaiLogicOrganization_construct=function(){this.__base.FEaiLogic.construct.call(this);
var a=this._pIdMIndexDict=new TDictionary;a.set(11,6);a.set(12,7);a.set(13,5);a.set(14,8);a.set(15,2);a.set(21,4);a.set(22,3);a.set(23,1);a.set(31,-1);a.set(32,21);a.set(33,22);a.set(34,20);a.set(35,30);a.set(36,23);a.set(37,9);a.set(41,10);a.set(42,19);a.set(43,29);a.set(44,24);a.set(45,25);a.set(46,0);a.set(50,18);a.set(51,17);a.set(52,26);a.set(53,27);a.set(54,16);a.set(61,12);a.set(62,13);a.set(63,15);a.set(64,11);a.set(65,14);a.set(71,28);a.set(81,-1);a.set(82,-1);this._cityIdNameDict=new TDictionary;
a=this._provinceColors=new TObjects;a.push(new SColor4(.25,.5,.6));a.push(new SColor4(.3,.6,.75));a.push(new SColor4(.35,.7,.8));a.push(new SColor4(.4,.75,.85));a.push(new SColor4(.45,.85,1))},MO.FEaiLogicOrganization_doFetch=function(a,b){return this.send("fetch",null,a,b)},MO.FEaiLogicOrganization_getMeshIndex=function(a){return this.pIdMIndexDict().value(a)},MO.FEaiLogicOrganization_getMeshIndex=function(a){return this.cityIdNameDict().value(a)};
with(MO)MO.FEaiLogicSchedule=function(a){a=RClass.inherits(this,a,FEaiLogic);a._code="schedule";a.doFetch=FEaiLogicSchedule_doFetch;return a},MO.FEaiLogicSchedule_doFetch=function(a,b){return this.send("fetch",null,a,b)};MO.FEaiLogicStatistics=function(a){a=MO.Class.inherits(this,a,MO.FEaiLogic);a._code="statistics";a.doInvestmentDynamic=MO.FEaiLogicStatistics_doInvestmentDynamic;a.doInvestmentTrend=MO.FEaiLogicStatistics_doInvestmentTrend;return a};
MO.FEaiLogicStatistics_doInvestmentDynamic=function(a,b,c,d){return this.send("investment_dynamic","begin="+c+"&end="+d,a,b)};MO.FEaiLogicStatistics_doInvestmentTrend=function(a,b,c,d,e){e||(e=6E5);return this.send("investment_trend","begin="+c+"&end="+d+"&interval="+e,a,b)};
MO.FEaiLogicSystem=function(a){a=MO.Class.inherits(this,a,MO.FEaiLogic);a._code="system";a._ready=!1;a._currentDate=null;a._localDate=null;a._systemDate=MO.Class.register(a,new MO.AGetter("_systemDate"));a.onInfo=MO.FEaiLogicSystem_onInfo;a.construct=MO.FEaiLogicSystem_construct;a.doInfo=MO.FEaiLogicSystem_doInfo;a.testReady=MO.FEaiLogicSystem_testReady;a.currentDate=MO.FEaiLogicSystem_currentDate;a.refresh=MO.FEaiLogicSystem_refresh;a.dispose=MO.FEaiLogicSystem_dispose;return a};
MO.FEaiLogicSystem_onInfo=function(a){a=a.content;this._localDate.setNow();this._systemDate.parse(a.date);this._ready=!0};MO.FEaiLogicSystem_construct=function(){this.__base.FEaiLogic.construct.call(this);this._currentDate=new MO.TDate;this._localDate=new MO.TDate;this._systemDate=new MO.TDate};MO.FEaiLogicSystem_doInfo=function(a,b){return this.send("info",null,a,b)};MO.FEaiLogicSystem_testReady=function(){return this._ready};
MO.FEaiLogicSystem_currentDate=function(){var a=this._systemDate.get()-this._localDate.get();this._currentDate.set(MO.Timer.current()+a);return this._currentDate};MO.FEaiLogicSystem_refresh=function(){return this.doInfo(this,this.onInfo)};MO.FEaiLogicSystem_dispose=function(){this._localDate=RObject.dispose(this._localDate);this._systemDate=RObject.dispose(this._systemDate);this.__base.FEaiLogic.consturct.call(this)};
with(MO)MO.FEaiBoundaryData=function(a){a=RClass.inherits(this,a,FEaiEntity);a._positionCount=RClass.register(a,new AGetter("_positionCount"));a._positions=RClass.register(a,new AGetter("_positions"));a._indexes=RClass.register(a,new AGetter("_indexes"));a.construct=FEaiBoundaryData_construct;a.unserialize=FEaiBoundaryData_unserialize;a.dispose=FEaiBoundaryData_dispose;return a},MO.FEaiBoundaryData_construct=function(){this.__base.FEaiEntity.construct.call(this)},MO.FEaiBoundaryData_unserialize=function(a){var b=
0,c=this._positionCount=a.readInt32();this._positions=new Float32Array(2*c);for(var d=0;d<c;d++)this._positions[b++]=a.readFloat(),this._positions[b++]=a.readFloat();b=a.readInt32();this._indexes=new Uint16Array(b);for(d=0;d<b;d++)this._indexes[d]=a.readUint16()},MO.FEaiBoundaryData_dispose=function(){this._indexes=this._positions=null;this.__base.FEaiEntity.dispose.call(this)};
with(MO)MO.FEaiCityEffect=function(a){a=RClass.inherits(this,a,FG3dAutomaticEffect);a._code="eai.city";a.drawRenderable=FEaiCityEffect_drawRenderable;return a},MO.FEaiCityEffect_drawRenderable=function(a,b){var c=this._graphicContext,d=this._program,e=b.currentMatrix(),f=a.calculate(EG3dRegionParameter.CameraViewProjectionMatrix),g=b.material(),h=g.info();this.bindMaterial(g);d.setParameter("vc_model_matrix",e);d.setParameter("vc_vp_matrix",f);d.setParameter4("fc_alpha",h.alphaBase,h.alphaRate,h.alphaLevel,
h.alphaMerge);d.setParameter("fc_ambient_color",h.ambientColor);this.bindAttributes(b);this.bindSamplers(b);d=b.indexBuffers().first();c.drawTriangles(d)};
with(MO)MO.FEaiCityEntity=function(a){a=RClass.inherits(this,a,FEaiEntity);a._visible=RClass.register(a,new AGetter("_visible"),!1);a._location=RClass.register(a,new AGetter("_location"));a._size=RClass.register(a,new AGetter("_size"));a._alpha=RClass.register(a,new AGetSet("_alpha"),1);a._color=RClass.register(a,new AGetter("_color"));a._range=RClass.register(a,new AGetter("_range"),1);a._rangeColor=RClass.register(a,new AGetter("_rangeColor"));a._cityTotal=0;a._investmentCount=0;a._investmentTotal=
RClass.register(a,new AGetSet("_investmentTotal"));a._investmentLevelTotal=2E4;a._investmentLevel=0;a._investmentRange=1;a._investmentRate=100;a._investmentDirection=1;a._stage=RClass.register(a,new AGetSet("_stage"));a._renderable=RClass.register(a,new AGetSet("_renderable"));a._data=RClass.register(a,new AGetSet("_data"));a._inputPoint=null;a._outputPoint=null;a.construct=FEaiCityEntity_construct;a.calculateScreenPosition=FEaiCityEntity_calculateScreenPosition;a.build=FEaiCityEntity_build;a.addInvestmentTotal=
FEaiCityEntity_addInvestmentTotal;a.reset=FEaiCityEntity_reset;a.update=FEaiCityEntity_update;a.process=FEaiCityEntity_process;a.dispose=FEaiCityEntity_dispose;return a},MO.FEaiCityEntity_construct=function(){this.__base.FEaiEntity.construct.call(this);this._location=new SPoint2;this._size=new SSize2;this._color=new SColor4(0,0,0,0);this._rangeColor=new SColor4(0,0,0,0);this._inputPoint=new SPoint3;this._outputPoint=new SPoint3},MO.FEaiCityEntity_calculateScreenPosition=function(){var a=this._stage.region().calculate(EG3dRegionParameter.CameraViewProjectionMatrix),
b=this._renderable.matrix(),c=MO.RMath.matrix;c.identity();c.append(b);c.append(a);this._inputPoint.set(this._location.x,this._location.y,0);c.transformPoint3(this._inputPoint,this._outputPoint);return this._outputPoint},MO.FEaiCityEntity_build=function(a){this._location.assign(this._data.location());this._size.set(2,2)},MO.FEaiCityEntity_addInvestmentTotal=function(a){this._investmentCount++;this._investmentTotal+=a;this._investmentLevel=this._investmentLevelTotal;var b=RConsole.find(FEaiResourceConsole).rateConsole().find(EEaiRate.Line).findRate(this._investmentTotal/
2E5);this._color.set(1,1,1,1);this._range=RFloat.toRange(Math.log(a)/5,0,6);this._rangeColor.setInteger(b);this._rangeColor.alpha=1;this._investmentRange=this._range;this._investmentRate=100;this._visible=!0},MO.FEaiCityEntity_reset=function(){this._visible=!1;this._cityTotal=this._alpha=0;this._color.set(0,0,0,0);this._rangeColor.set(0,0,0,0)},MO.FEaiCityEntity_update=function(a){var b=1;this._color.set(1,1,1,1);this._rangeColor.set(1,1,1,1);a&&(this._cityTotal=a.investmentTotal());a=this._cityTotal;
0<a&&(this._visible=!0);var c=RConsole.find(FEaiResourceConsole).historyConsole().investmentCityTotal(),b=RConsole.find(FEaiResourceConsole).rateConsole().find(EEaiRate.Map);a=4*Math.sqrt(a/c);c=b.findRate(a);b=6*a;a=RFloat.toRange(a,0,1);this._alpha=RFloat.toRange(1.5*a,0,1);this._rangeColor.setIntAlpha(c,.6*a);this._range=RFloat.toRange(Math.sqrt(b),1,6)},MO.FEaiCityEntity_process=function(a){return 0<this._investmentLevel?(a=this._investmentLevel/this._investmentLevelTotal,0>this._investmentRate?
(this._investmentRate=0,this._investmentDirection=4):100<this._investmentRate&&(this._investmentRate=100,this._investmentDirection=-2),this._color.alpha=a,this._rangeColor.alpha=a,this._investmentLevel--,0==this._investmentLevel&&(this._visible=!1),!0):!1},MO.FEaiCityEntity_dispose=function(){this._location=RObject.dispose(this._location);this._size=RObject.dispose(this._size);this._color=RObject.dispose(this._color);this._rangeColor=RObject.dispose(this._rangeColor);this._inputPoint=RObject.dispose(this._inputPoint);
this._outputPoint=RObject.dispose(this._outputPoint);this.__base.FEaiEntity.dispose.call(this)};MO.FEaiCityEntityConsole=function(a){a=MO.RClass.inherits(this,a,MO.FObject);a._citys=MO.Class.register(a,new MO.AGetter("_citys"));a.construct=MO.FEaiCityEntityConsole_construct;a.findByCode=MO.FEaiCityEntityConsole_findByCode;a.findByCard=MO.FEaiCityEntityConsole_findByCard;a.push=MO.FEaiCityEntityConsole_push;a.dispose=MO.FEaiCityEntityConsole_dispose;return a};
MO.FEaiCityEntityConsole_construct=function(){this.__base.FObject.construct.call(this);this._citys=MO.TDictionary()};MO.FEaiCityEntityConsole_findByCode=function(a){return this._citys.get(a)};MO.FEaiCityEntityConsole_findByCard=function(a){if(4!=a.length)return null;var b=this._citys;if(b=b.get(a))return b;b=this._citys;return(b=b.get(a.substring(0,2)))?b:null};MO.FEaiCityEntityConsole_push=function(a){this._citys.set(a.data().code(),a)};
MO.FEaiCityEntityConsole_dispose=function(a){this._citys=RObject.dispose(this._citys);this.__base.FObject.dispose.call(this)};
with(MO)MO.FEaiCityRangeEffect=function(a){a=RClass.inherits(this,a,FG3dAutomaticEffect);a._code="eai.city.range";a.drawRenderable=FEaiCityRangeEffect_drawRenderable;return a},MO.FEaiCityRangeEffect_drawRenderable=function(a,b){var c=this._graphicContext,d=this._program,e=b.currentMatrix(),f=a.calculate(EG3dRegionParameter.CameraViewProjectionMatrix),g=b.material();g.info();this.bindMaterial(g);d.setParameter("vc_model_matrix",e);d.setParameter("vc_vp_matrix",f);this.bindAttributes(b);this.bindSamplers(b);
d=b.indexBuffers().first();c.drawTriangles(d)};
with(MO)MO.FEaiCitysRangeRenderable=function(a){a=RClass.inherits(this,a,FE3dRenderable);a._ready=!1;a._image=null;a._citys=RClass.register(a,new AGetter("_citys"));a._citySize=RClass.register(a,new AGetter("_citySize"));a._vertexPositionBuffer=null;a._vertexColorBuffer=null;a._vertexCoordBuffer=null;a._indexBuffer=null;a._texture=null;a.onImageLoad=FEaiCitysRangeRenderable_onImageLoad;a.construct=FEaiCitysRangeRenderable_construct;a.testReady=FEaiCitysRangeRenderable_testReady;a.setup=FEaiCitysRangeRenderable_setup;
a.upload=FEaiCitysRangeRenderable_upload;a.loadUrl=FEaiCitysRangeRenderable_loadUrl;a.dispose=FEaiCitysRangeRenderable_dispose;return a},MO.FEaiCitysRangeRenderable_onImageLoad=function(a){a=a.sender;this._texture.upload(a);a.dispose();this._ready=!0},MO.FEaiCitysRangeRenderable_construct=function(){this.__base.FE3dRenderable.construct.call(this);this._citys=new TObjects;this._material=RClass.create(FE3dMaterial)},MO.FEaiCitysRangeRenderable_testReady=function(){return this._ready},MO.FEaiCitysRangeRenderable_setup=
function(){var a=this._graphicContext,b=this._citys.count(),c=this._vertexCount=4*b,d=this._vertexPositionBuffer=a.createVertexBuffer();d.setCode("position");d.setFormatCd(EG3dAttributeFormat.Float3);this.pushVertexBuffer(d);for(var d=0,e=new Float32Array(2*c),f=0;f<b;f++)e[d++]=0,e[d++]=1,e[d++]=1,e[d++]=1,e[d++]=1,e[d++]=0,e[d++]=0,e[d++]=0;d=this._vertexCoordBuffer=a.createVertexBuffer();d.setCode("coord");d.setFormatCd(EG3dAttributeFormat.Float2);d.upload(e,8,c);this.pushVertexBuffer(d);d=this._vertexColorBuffer=
a.createVertexBuffer();d.setCode("color");d.setFormatCd(EG3dAttributeFormat.Byte4Normal);this.pushVertexBuffer(d);c=6*b;d=0;e=new Uint16Array(c);for(f=0;f<b;f++){var g=4*f;e[d++]=g+0;e[d++]=g+1;e[d++]=g+2;e[d++]=g+0;e[d++]=g+2;e[d++]=g+3}d=this._indexBuffer=a.createIndexBuffer();d.upload(e,c);this.pushIndexBuffer(d);a=this._texture=a.createFlatTexture();a.setOptionFlipY(!0);a.setWrapCd(EG3dSamplerFilter.ClampToEdge,EG3dSamplerFilter.ClampToEdge);this.pushTexture(a,"diffuse");a=this._material.info();
a.effectCode="eai.citys.range";a.optionAlpha=!0;this._material._textures=this._textures;this.loadUrl("/script/ars/eai/dot.png")},MO.FEaiCitysRangeRenderable_upload=function(){for(var a=this._citys,b=a.count(),c=0,d=0;d<b;d++){var e=a.at(d);e.visible()&&c++}for(var f=this._vertexCount=4*c,g=0,h=new Float32Array(3*f),m=0,l=new Uint8Array(4*f),d=0;d<b;d++)if(e=a.at(d),e.visible()){var k=e.location(),p=e.range();e.size();h[g++]=k.x-p;h[g++]=k.y+p;h[g++]=0;h[g++]=k.x+p;h[g++]=k.y+p;h[g++]=0;h[g++]=k.x+
p;h[g++]=k.y-p;h[g++]=0;h[g++]=k.x-p;h[g++]=k.y-p;h[g++]=0;for(var q=e.rangeColor(),e=parseInt(255*q.red),k=parseInt(255*q.green),p=parseInt(255*q.blue),q=parseInt(255*q.alpha),r=0;4>r;r++)l[m++]=e,l[m++]=k,l[m++]=p,l[m++]=q}this._vertexPositionBuffer.upload(h,12,f);this._vertexColorBuffer.upload(l,4,f);this._indexBuffer.setCount(6*c)},MO.FEaiCitysRangeRenderable_loadUrl=function(a){var b=RClass.create(FImage);b.addLoadListener(this,this.onImageLoad);b.loadUrl(a);this._ready=!1},MO.FEaiCitysRangeRenderable_dispose=
function(){this._texture=RObject.dispose(this._texture);this._vertexPositionBuffer=RObject.dispose(this._vertexPositionBuffer);this._vertexCoordBuffer=RObject.dispose(this._vertexCoordBuffer);this._indexBuffer=RObject.dispose(this._indexBuffer);this.__base.FE3dRenderable.dispose.call(this)};
with(MO)MO.FEaiCitysRenderable=function(a){a=RClass.inherits(this,a,FE3dRenderable);a._ready=!1;a._image=null;a._levelCoordLeft=null;a._levelCoordRight=null;a._levelScale=null;a._citys=RClass.register(a,new AGetter("_citys"));a._level=RClass.register(a,new AGetSet("_level"));a._citySize=RClass.register(a,new AGetter("_citySize"));a._vertexPositionBuffer=null;a._vertexCoordBuffer=null;a._indexBuffer=null;a._texture=null;a.onImageLoad=FEaiCitysRenderable_onImageLoad;a.construct=FEaiCitysRenderable_construct;
a.testReady=FEaiCitysRenderable_testReady;a.setup=FEaiCitysRenderable_setup;a.upload=FEaiCitysRenderable_upload;a.loadUrl=FEaiCitysRenderable_loadUrl;a.dispose=FEaiCitysRenderable_dispose;return a},MO.FEaiCitysRenderable_onImageLoad=function(a){a=a.sender;this._texture.upload(a);a.dispose();this._ready=!0},MO.FEaiCitysRenderable_construct=function(){this.__base.FE3dRenderable.construct.call(this);this._citys=new TObjects;this._material=RClass.create(FE3dMaterial);var a=this._levelCoordLeft={};a[1]=
0;a[2]=.25;a[3]=.5;a[4]=.75;a=this._levelCoordRight={};a[1]=.25;a[2]=.5;a[3]=.75;a[4]=1;a=this._levelScale={};a[1]=.7;a[2]=.5;a[3]=.4;a[4]=.2},MO.FEaiCitysRenderable_testReady=function(){return this._ready},MO.FEaiCitysRenderable_setup=function(){var a=this._graphicContext,b=this._citys.count();this._vertexCount=4*b;var c=this._vertexPositionBuffer=a.createVertexBuffer();c.setCode("position");c.setFormatCd(EG3dAttributeFormat.Float3);this.pushVertexBuffer(c);c=this._vertexCoordBuffer=a.createVertexBuffer();
c.setCode("coord");c.setFormatCd(EG3dAttributeFormat.Float2);this.pushVertexBuffer(c);c=this._vertexColorBuffer=a.createVertexBuffer();c.setCode("color");c.setFormatCd(EG3dAttributeFormat.Byte4Normal);this.pushVertexBuffer(c);for(var d=6*b,c=0,e=new Uint16Array(d),f=0;f<b;f++){var g=4*f;e[c++]=g+0;e[c++]=g+1;e[c++]=g+2;e[c++]=g+0;e[c++]=g+2;e[c++]=g+3}c=this._indexBuffer=a.createIndexBuffer();c.upload(e,d);this.pushIndexBuffer(c);a=this._texture=a.createFlatTexture();a.setOptionFlipY(!0);a.setWrapCd(EG3dSamplerFilter.ClampToEdge,
EG3dSamplerFilter.ClampToEdge);this.pushTexture(a,"diffuse");a=this._material.info();a.effectCode="eai.citys";a.optionAlpha=!0;a.ambientColor.setHex("#FFFFFF");this._material._textures=this._textures;this.loadUrl("/script/ars/eai/citys.png")},MO.FEaiCitysRenderable_upload=function(){for(var a=this._citys,b=a.count(),c=0,d=0;d<b;d++){var e=a.at(d);e.visible()&&c++}for(var f=this._vertexCount=4*c,g=0,h=new Float32Array(3*f),m=0,l=new Float32Array(2*f),k=0,p=new Uint8Array(4*f),d=0;d<b;d++)if(e=a.at(d),
e.visible()){e.range();var q=e.alpha(),r=e.location(),n=e.data().level();if(1!=n&&2!=n&&3!=n&&4!=n)throw new TError("Invalid level.");var t=this._levelCoordLeft[n],w=this._levelCoordRight[n],n=this._levelScale[n];h[g++]=r.x-n;h[g++]=r.y+n;h[g++]=0;h[g++]=r.x+n;h[g++]=r.y+n;h[g++]=0;h[g++]=r.x+n;h[g++]=r.y-n;h[g++]=0;h[g++]=r.x-n;h[g++]=r.y-n;h[g++]=0;l[m++]=t;l[m++]=1;l[m++]=w;l[m++]=1;l[m++]=w;l[m++]=0;l[m++]=t;l[m++]=0;w=e.color();e=parseInt(255*w.red);r=parseInt(255*w.green);t=parseInt(255*w.blue);
q=parseInt(w.alpha*q*255);for(w=0;4>w;w++)p[k++]=e,p[k++]=r,p[k++]=t,p[k++]=q}this._vertexPositionBuffer.upload(h,12,f);this._vertexCoordBuffer.upload(l,8,f);this._vertexColorBuffer.upload(p,4,f);this._indexBuffer.setCount(6*c)},MO.FEaiCitysRenderable_loadUrl=function(a){var b=RClass.create(FImage);b.addLoadListener(this,this.onImageLoad);b.loadUrl(a);this._ready=!1},MO.FEaiCitysRenderable_dispose=function(){this._texture=RObject.dispose(this._texture);this._vertexPositionBuffer=RObject.dispose(this._vertexPositionBuffer);
this._vertexCoordBuffer=RObject.dispose(this._vertexCoordBuffer);this._vertexColorBuffer=RObject.dispose(this._vertexColorBuffer);this._indexBuffer=RObject.dispose(this._indexBuffer);this.__base.FE3dRenderable.dispose.call(this)};
MO.FEaiCountryData=function(a){a=MO.Class.inherits(this,a,MO.FObject,MO.MListener);a._listenersLoad=MO.Class.register(a,new MO.AListener("_listenersLoad",MO.EEvent.Load));a._provinces=MO.Class.register(a,new MO.AGetter("_provinces"));a.onLoaded=MO.FEaiCountryData_onLoaded;a.construct=MO.FEaiCountryData_construct;a.unserialize=MO.FEaiCountryData_unserialize;a.load=MO.FEaiCountryData_load;a.dispose=MO.FEaiCountryData_dispose;return a};
MO.FEaiCountryData_construct=function(){this.__base.FObject.construct.call(this);this._provinces=new MO.TDictionary};MO.FEaiCountryData_onLoaded=function(a){a=a.outputData();var b=MO.Class.create(MO.FDataView);b.setEndianCd(!0);b.link(a);this.unserialize(b);b.dispose()};MO.FEaiCountryData_unserialize=function(a){for(var b=a.readInt32(),c=0;c<b;c++){var d=MO.Class.create(MO.FEaiProvinceData);d.unserialize(a);this._provinces.set(d.name(),d)}a=new MO.SEvent(this);this.processLoadListener(a);a.dispose()};
MO.FEaiCountryData_load=function(){MO.Console.find(MO.FHttpConsole).send("/script/ars/eai/country.dat").addLoadListener(this,this.onLoaded)};MO.FEaiCountryData_dispose=function(){this._provinces=MO.Lang.Object.dispose(this._provinces);this.__base.FObject.dispose.call(this)};
with(MO)MO.FEaiCountryEntity=function(a){a=RClass.inherits(this,a,FEaiEntity);a._cameraDirection=RClass.register(a,new AGetSet("_cameraDirection"));a._startDelay=RClass.register(a,new AGetSet("_startDelay"),0);a._riseDuration=RClass.register(a,new AGetSet("_riseDuration"),5E3);a._riseDistance=RClass.register(a,new AGetSet("_riseDistance"),1E3);a._fallDuration=RClass.register(a,new AGetSet("_fallDuration"),200);a._fallDistance=RClass.register(a,new AGetSet("_fallDistance"),3);a._blockInterval=RClass.register(a,
new AGetSet("_blockInterval"),60);a._mouseOverRiseHeight=RClass.register(a,new AGetSet("_mouseOverRiseHeight"),3);a._mouseMoveCheckInterval=RClass.register(a,new AGetSet("_mouseMoveCheckInterval"),100);a._cameraMoveDuration=RClass.register(a,new AGetSet("_cameraMoveDuration"),500);a._provinceEntities=MO.Class.register(a,new MO.AGetter("_provinceEntities"));a._playing=!1;a._lastTick=0;a._interval=10;a._template=RClass.register(a,new AGetSet("_template"));a._introAnimeDone=RClass.register(a,new AGetSet("_introAnimeDone"),
!1);a._startTime=RClass.register(a,new AGetSet("_startTime"));a._mouseOverRiseRenderable=RClass.register(a,new AGetSet("_mouseOverRiseRenderable"));a._mouseOverFallArray=RClass.register(a,new AGetSet("_mouseOverFallArray"));a._mouseMoveLastCheck=RClass.register(a,new AGetSet("_mouseMoveLastCheck"));a._cameraMoving=RClass.register(a,new AGetSet("_cameraMoving"),!1);a._cameraFrom=RClass.register(a,new AGetSet("_cameraFrom"));a._cameraTo=RClass.register(a,new AGetSet("_cameraTo"));a.setup=FEaiCountryEntity_setup;
a.start=FEaiCountryEntity_start;a.process=FEaiCountryEntity_process;a.introAnime=FEaiCountryEntity_introAnime;a.onMouseMove=FEaiCountryEntity_onMouseMove;a.onMouseDown=FEaiCountryEntity_onMouseDown;a.mouseOverFallAnime=FEaiCountryEntity_mouseOverFallAnime;a.onOrganizationFetch=FEaiCountryEntity_onOrganizationFetch;a.cameraMoveAnime=FEaiCountryEntity_cameraMoveAnime;return a},MO.FEaiCountryEntity_setup=function(a){this._provinceEntities=a;for(a=0;a<this._provinceEntities.count();a++){var b=this._provinceEntities.at(a).faceRenderable(),
c=this._provinceEntities.at(a).borderRenderable(),b=b.matrix(),c=c.matrix();b.tz=this.riseDistance();b.updateForce();c.tz=this.riseDistance();c.updateForce()}this._startTime=MO.Timer.current()},MO.FEaiCountryEntity_start=function(){this._startTime=MO.Timer.current()},MO.FEaiCountryEntity_process=function(){this._provinceEntities&&this.introAnime()},MO.FEaiCountryEntity_introAnime=function(){var a=MO.Timer.current()-this._startTime;if(!(a<this.startDelay())){a-=this.startDelay();if(a>this.riseDuration()+
this.fallDuration()+this.blockInterval()*this._provinceEntities.count()){this.setIntroAnimeDone(!0);var b=new TListener;b._owner=this;b._callback=this.onMouseMove;RWindow.lsnsMouseMove.push(b);b=new TListener;b._owner=this;b._callback=this.onMouseDown;RWindow.lsnsMouseDown.push(b)}for(var b=a/this.blockInterval(),c=0;c<this._provinceEntities.count()&&c<b;c++){var d=this._provinceEntities.at(c).faceRenderable(),e=this._provinceEntities.at(c).borderRenderable(),d=d.matrix(),e=e.matrix(),f=(a-this.blockInterval()*
c)/this.riseDuration(),g=0;1<f&&(f=1,g=(a-this.blockInterval()*c-this.riseDuration())/this.fallDuration(),1<g&&(g=1));d.tz=this.riseDistance()*(1-f)-this.fallDistance()*(1-g);d.updateForce();e.tz=this.riseDistance()*(1-f)-this.fallDistance()*(1-g);e.updateForce()}}},MO.FEaiCountryEntity_onMouseMove=function(a){},MO.FEaiCountryEntity_mouseOverFallAnime=function(){},MO.FEaiCountryEntity_onOrganizationFetch=function(a){},MO.FEaiCountryEntity_onMouseDown=function(a){},MO.FEaiCountryEntity_cameraMoveAnime=
function(){};MO.FEaiEntityConsole=function(a){a=MO.RClass.inherits(this,a,MO.FConsole);a._scopeCd=MO.EScope.Local;a._cityConsole=MO.Class.register(a,new MO.AGetter("_cityConsole"));a._provinceConsole=MO.Class.register(a,new MO.AGetter("_provinceConsole"));a.construct=MO.FEaiEntityConsole_construct;a.dispose=MO.FEaiEntityConsole_dispose;return a};
MO.FEaiEntityConsole_construct=function(){this.__base.FConsole.construct.call(this);this._cityConsole=MO.RClass.create(MO.FEaiCityEntityConsole);this._provinceConsole=MO.RClass.create(MO.FEaiProvinceEntityConsole)};MO.FEaiEntityConsole_dispose=function(){this._cityConsole=RObject.dispose(this._cityConsole);this._provinceConsole=RObject.dispose(this._provinceConsole);this.__base.FConsole.dispose.call(this)};
MO.FEaiMapEntity=function(a){a=MO.Class.inherits(this,a,MO.FEaiEntity);a._countryEntity=MO.Class.register(a,new MO.AGetter("_countryEntity"));a._provinceEntities=MO.Class.register(a,new MO.AGetter("_provinceEntities"));a._cityEntities=MO.Class.register(a,new MO.AGetter("_cityEntities"));a._citysRenderable=MO.Class.register(a,new MO.AGetSet("_citysRenderable"));a._citysRangeRenderable=MO.Class.register(a,new MO.AGetSet("_citysRangeRenderable"));a.construct=MO.FEaiMapEntity_construct;a.findProvinceByCard=
MO.FEaiMapEntity_findProvinceByCard;a.findCityByCard=MO.FEaiMapEntity_findCityByCard;a.upload=MO.FEaiMapEntity_upload;a.process=MO.FEaiMapEntity_process;a.dispose=MO.FEaiMapEntity_dispose;return a};MO.FEaiMapEntity_construct=function(){this.__base.FEaiEntity.construct.call(this);this._countryEntity=MO.Class.create(MO.FEaiCountryEntity);this._provinceEntities=new MO.TDictionary;this._cityEntities=new MO.TDictionary};MO.FEaiMapEntity_findProvinceByCard=function(a){return this._provinceEntities.get(a)};
MO.FEaiMapEntity_findCityByCard=function(a){if(4!=a.length)return null;var b=this._cityEntities;if(b=b.get(a))return b;b=this._cityEntities;return(b=b.get(a.substring(0,2)))?b:null};MO.FEaiMapEntity_upload=function(){this._citysRenderable.upload();this._citysRangeRenderable.upload()};MO.FEaiMapEntity_process=function(a){var b=!1,b=this._provinceEntities;a=b.count();for(var c=0;c<a;c++)b.at(c).process();var b=!1,d=this._cityEntities;a=d.count();for(c=0;c<a;c++)d.at(c).process()&&(b=!0);b&&this.upload()};
MO.FEaiMapEntity_dispose=function(){this._countryEntity=MO.RObject.dispose(this._countryEntity);this._provinceEntities=MO.RObject.dispose(this._provinceEntities);this._cityEntities=MO.RObject.dispose(this._cityEntities);this.__base.FEaiEntity.dispose.call(this)};
with(MO)MO.FEaiProvinceData=function(a){a=RClass.inherits(this,a,FEaiEntity);a._name=RClass.register(a,new AGetSet("_name"));a._color=RClass.register(a,new AGetSet("_color"));a._boundaries=RClass.register(a,new AGetter("_boundaries"));a.construct=FEaiProvinceData_construct;a.unserialize=FEaiProvinceData_unserialize;a.dispose=FEaiProvinceData_dispose;return a},MO.FEaiProvinceData_construct=function(){this.__base.FEaiEntity.construct.call(this);this._boundaries=new TObjects},MO.FEaiProvinceData_unserialize=
function(a){this._name=a.readString();this._color=a.readUint32();for(var b=a.readInt32(),c=0;c<b;c++){var d=RClass.create(FEaiBoundaryData);d.unserialize(a);this._boundaries.push(d)}},MO.FEaiProvinceData_dispose=function(){this._boundaries=RObject.dispose(this._boundaries);this.__base.FEaiEntity.dispose.call(this)};
with(MO)MO.FEaiProvinceEntity=function(a){a=RClass.inherits(this,a,FEaiEntity);a._mapEntity=RClass.register(a,new AGetSet("_mapEntity"));a._data=RClass.register(a,new AGetSet("_data"));a._faceRenderable=RClass.register(a,new AGetter("_faceRenderable"));a._borderRenderable=RClass.register(a,new AGetter("_borderRenderable"));a._layerDepth=3;a._focusTick=0;a._focusInterval=10;a._focusCurrent=0;a._focusCount=100;a.construct=FEaiProvinceEntity_construct;a.buildFace=FEaiProvinceEntity_buildFace;a.buildBorder=
FEaiProvinceEntity_buildBorder;a.build=FEaiProvinceEntity_build;a.doInvestment=FEaiProvinceEntity_doInvestment;a.updateColor=FEaiProvinceEntity_updateColor;a.update=FEaiProvinceEntity_update;a.process=FEaiProvinceEntity_process;a.dispose=FEaiProvinceEntity_dispose;return a},MO.FEaiProvinceEntity_construct=function(){this.__base.FEaiEntity.construct.call(this)},MO.FEaiProvinceEntity_buildFace=function(a){for(var b=this._data.boundaries(),c=b.count(),d=this._vertexTotal,e=this._indexTotal,f=0,g=0,h=
new Float32Array(6*d),m=0,e=new Uint16Array(2*e+6*d),l=0;l<c;l++){for(var k=b.at(l),p=k.positionCount(),q=k.positions(),r=0,n=0;n<p;n++)h[g++]=q[r++],h[g++]=q[r++],h[g++]=0;k=k.indexes();q=k.length;for(n=0;n<q;n++)e[m++]=f+k[n];f+=p}for(var t=f,l=0;l<c;l++){k=b.at(l);p=k.positionCount();q=k.positions();for(n=r=0;n<p;n++)h[g++]=q[r++],h[g++]=q[r++],h[g++]=this._layerDepth;k=k.indexes();q=k.length;for(n=0;n<q;n++)e[m++]=f+k[n];f+=p}for(l=f=0;l<c;l++){k=b.at(l);p=k.positionCount();for(n=0;n<p;n++)n==
p-1?(e[m++]=f+n,e[m++]=f+0,e[m++]=f+n+t,e[m++]=f+0,e[m++]=f+t):(e[m++]=f+n,e[m++]=f+n+1,e[m++]=f+n+t,e[m++]=f+n+1,e[m++]=f+n+t+1),e[m++]=f+n+t;f+=p}c=0;b=this.colorsData=new Uint8Array(8*d);f=2*d;for(n=0;n<f;n++)b[c++]=8,b[c++]=13,b[c++]=25,b[c++]=255;n=this._faceRenderable=MO.RClass.create(MO.FE3dDataBox);n.linkGraphicContext(a);n.setup();n.vertexPositionBuffer().upload(h,12,2*d);n.vertexColorBuffer().upload(b,4,2*d);n.indexBuffer().upload(e,m);n.material().info().optionDouble=!0},MO.FEaiProvinceEntity_buildBorder=
function(a){for(var b=this._data.boundaries(),c=b.count(),d=this._vertexTotal,e=0,f=0,g=new Float32Array(6*d),h=0,m=new Uint16Array(2*d+2*d),l=0;l<c;l++){for(var k=b.at(l),p=k.positionCount(),q=k.positions(),r=0,k=0;k<p;k++)g[f++]=q[r++],g[f++]=q[r++],g[f++]=0;for(k=0;k<p;k++)m[h++]=e+k,k==p-1?m[h++]=e:m[h++]=e+k+1;e+=p}for(var n=e,l=0;l<c;l++){k=b.at(l);p=k.positionCount();q=k.positions();for(k=r=0;k<p;k++)g[f++]=q[r++],g[f++]=q[r++],g[f++]=this._layerDepth;e+=p}for(l=e=0;l<c;l++){k=b.at(l);p=k.positionCount();
for(k=0;k<p;k++)m[h++]=e+k,m[h++]=e+k+n;e+=p}c=0;b=this.colorsData=new Uint8Array(8*d);for(k=0;k<d;k++)b[c++]=0,b[c++]=181,b[c++]=246,b[c++]=255;for(k=0;k<d;k++)b[c++]=11,b[c++]=17,b[c++]=35,b[c++]=255;k=this._borderRenderable=MO.RClass.create(MO.FE3dDataBox);k.linkGraphicContext(a);k.setup();k.vertexPositionBuffer().upload(g,12,2*d);k.vertexColorBuffer().upload(b,4,2*d);k.indexBuffer().setDrawModeCd(MO.EG3dDrawMode.Lines);k.indexBuffer().setLineWidth(1);k.indexBuffer().upload(m,h)},MO.FEaiProvinceEntity_build=
function(a){for(var b=0,c=0,d=this._data.boundaries(),e=d.count(),f=0;f<e;f++)var g=d.at(f),b=b+g.positionCount(),c=c+g.indexes().length;this._vertexTotal=b;this._indexTotal=c;this.buildFace(a);this.buildBorder(a)},MO.FEaiProvinceEntity_doInvestment=function(){this._focusTick=0;this._focusCurrent=this._focusCount},MO.FEaiProvinceEntity_update=function(a){a=a.investmentTotal();Math.sqrt(a)},MO.FEaiProvinceEntity_updateColor=function(a){a=this._focusCurrent/100;for(var b=this._vertexTotal,c=0,d=MO.TypeArray.findTemp(EDataType.Uint8,
8*b),e=2*b,f=0;f<e;f++)d[c++]=8+0*a,d[c++]=13+168*a,d[c++]=25+221*a,d[c++]=255;this._faceRenderable.vertexColorBuffer().upload(d,4,2*b)},MO.FEaiProvinceEntity_process=function(){if(0<this._focusCurrent){var a=RTimer.current();if(a-this._focusTick>this._focusInterval){var b=-this._focusCurrent/20;faceRenderable=this._faceRenderable;matrix=faceRenderable.matrix();matrix.tz=b;matrix.updateForce();borderRenderable=this._borderRenderable;matrix=borderRenderable.matrix();matrix.tz=b;matrix.updateForce();
this.updateColor(this._focusCurrent);this._focusCurrent--;this._focusTick=a}}},MO.FEaiProvinceEntity_dispose=function(){this.__base.FEaiEntity.dispose.call(this)};MO.FEaiProvinceEntityConsole=function(a){a=MO.RClass.inherits(this,a,MO.FObject);a._provinces=MO.Class.register(a,new MO.AGetter("_provinces"));a.construct=MO.FEaiProvinceEntityConsole_construct;a.findByCode=MO.FEaiProvinceEntityConsole_findByCode;a.push=MO.FEaiProvinceEntityConsole_push;a.dispose=MO.FEaiProvinceEntityConsole_dispose;return a};
MO.FEaiProvinceEntityConsole_construct=function(){this.__base.FObject.construct.call(this);this._provinces=MO.TDictionary()};MO.FEaiProvinceEntityConsole_findByCode=function(a){return this._provinces.get(a)};MO.FEaiProvinceEntityConsole_push=function(a){this._provinces.set(a.data().name(),a)};MO.FEaiProvinceEntityConsole_dispose=function(a){this._provinces=RObject.dispose(this._provinces);this.__base.FObject.dispose.call(this)};
with(MO)MO.FGui24HTimeline=function(a){a=RClass.inherits(this,a,FGuiControl);a._startTime=RClass.register(a,new AGetSet("_startTime"));a._endTime=RClass.register(a,new AGetSet("_endTime"));a._data=null;a._ready=!1;a._investmentTotal=0;a._degreeLineHeight=RClass.register(a,new AGetSet("_degreeLineHeight"),10);a._triangleWidth=RClass.register(a,new AGetSet("_triangleWidth"),10);a._triangleHeight=RClass.register(a,new AGetSet("_triangleHeight"),12);a._decoLineGap=RClass.register(a,new AGetSet("_decoLineGap"),
10);a._decoLineWidth=RClass.register(a,new AGetSet("_decoLineWidth"),30);a.oeUpdate=FGui24HTimeline_oeUpdate;a.construct=FGui24HTimeline_construct;a.sync=FGui24HTimeline_sync;a.onPaintBegin=FGui24HTimeline_onPaintBegin;a.on24HDataFetch=FGui24HTimeline_on24HDataFetch;return a},MO.FGui24HTimeline_construct=function(){this.__base.FGuiControl.construct.call(this);this._startTime=new TDate;this._endTime=new TDate},MO.FGui24HTimeline_sync=function(){if(this._ready){var a=this._startTime,b=this._endTime,
c=MO.Console.find(MO.FEaiLogicConsole).system().currentDate();a.assign(c);a.setSecond(0);a.setMinute(0);a.addDay(-1);b.assign(c);b.setSecond(0);b.setMinute(15*parseInt(b.date.getMinutes()/15));b.refresh();MO.Console.find(MO.FEaiLogicConsole).statistics().doInvestmentTrend(this,this.on24HDataFetch,this._startTime.format("YYYYMMDDHH24MISS"),this._endTime.format("YYYYMMDDHH24MISS"),900)}},MO.FGui24HTimeline_on24HDataFetch=function(a){this._investmentTotal=0;if(a=this._data=a.content.collection)for(var b=
a.length,c=0;c<b;c++)this._investmentTotal+=parseFloat(a[c].investment);this.dirty()},MO.FGui24HTimeline_oeUpdate=function(a){this.__base.FGuiControl.oeUpdate.call(this,a);if(!this._ready)return MO.Console.find(MO.FEaiLogicConsole).system().testReady()&&(this._ready=!0,this.sync()),MO.EEventStatus.Stop},MO.FGui24HTimeline_onPaintBegin=function(a){if(this._ready){this.__base.FGuiControl.onPaintBegin.call(this,a);var b=a.graphic,c=a.rectangle;a=c.top;var d=c.top+c.height,e=d-30,f=c.left+5,c=c.left+
c.width-5,g=this.triangleWidth()+this.decoLineGap();b.drawTriangle(f,e,f+this.triangleWidth(),e+this.triangleHeight()/2,f+this.triangleWidth(),e-this.triangleHeight()/2,1,"#F8CB3D","#F8CB3D");b.drawTriangle(c,e,c-this.triangleWidth(),e+this.triangleHeight()/2,c-this.triangleWidth(),e-this.triangleHeight()/2,1,"#F8CB3D","#F8CB3D");b.drawLine(f+g,e,f+g+this.decoLineWidth(),e,"#F8CB3D",3);b.drawLine(c-g,e,c-g-this.decoLineWidth(),e,"#F8CB3D",3);var h=f+g+this.decoLineWidth(),g=c-g-this.decoLineWidth(),
m=d-30,l=m-(a+30);b.drawLine(h,e,g,e,"#F8CB3D",3);for(var d=this.startTime(),k=this.endTime(),p=k.date.getTime()-d.date.getTime(),c=d.date.getTime(),q,r=!1,n=0;!d.isAfter(k);){var n=d.date.getTime()-c,t=h+n/p*(g-h);b.drawLine(t,e-this.degreeLineHeight(),t,e,"#FFFFFF",1);q=d.format("HH24:00");d.addMseconds(36E5);if(r=!r)b.setFont("bold 20px Microsoft YaHei"),n=b.textWidth(q),b.drawText(q,t-n/2,e+20,"#FFFFFF")}d.date.setTime(c);d.refresh();if(n=this._data){for(e=k=0;e<n.length;e++)t=parseInt(n[e].investment),
t>k&&(k=t);l=1E4*l/k;t=parseInt(n[0].investment);r=h;q=m-t/1E4*l;for(var w=MO.Console.find(MO.FEaiResourceConsole).rateConsole().find(EEaiRate.Investment),e=1;e<n.length;e++){d.parseAuto(n[e].date);d.refresh();var t=d.date.getTime()-c,t=h+t/p*(g-h),v=m-n[e].investment/1E4*l,u=n[e].investment/k,u=parseInt((w.count()-1)*u),u=RHex.format(w.find(u)),x="#"+u.substring(2),u="rgba("+RHex.parse(u.substring(2,4))+","+RHex.parse(u.substring(4,6))+","+RHex.parse(u.substring(6,8))+",0.3)",y=n[e-1].investment/
k,y=parseInt((w.count()-1)*y),y=RHex.format(w.find(y)),z="#"+y.substring(2);RHex.parse(y.substring(2,4));RHex.parse(y.substring(4,6));RHex.parse(y.substring(6,8));y=b.createLinearGradient(r,q,t,v);y.addColorStop("0",z);y.addColorStop("1",x);x=b.createLinearGradient(0,m,0,v);z=RHex.format(w.find(0));z="rgba("+RHex.parse(z.substring(2,4))+","+RHex.parse(z.substring(4,6))+","+RHex.parse(z.substring(6,8))+",0.3)";x.addColorStop("0",z);x.addColorStop("1",u);b.drawLine(r,q,t,v,y,3);b.drawQuadrilateral(r,
q,t,v,t,m,r,m,null,null,x);r=t;q=v}d.date.setTime(c);d.refresh();g=-1;h=m=0;d.parseAuto(n[0].date);d.refresh();g=d.date.getHours();for(e=0;e<n.length;e++)d.parseAuto(n[e].date),d.refresh(),p=d.date.getHours(),g==p?m+=parseInt(n[e].investment):(m>h&&(h=m,m=0),g=p);b.setFont("bold 22px Microsoft YaHei");b.drawText("24\u5c0f\u65f6\u6295\u8d44\u66f2\u7ebf",f,a,"#54F0FF");b.setFont("bold 20px Microsoft YaHei");n=b.textWidth("\u5cf0\u503c\uff1a");h=MO.RFloat.unitFormat(h,0,0,2,0,1E4,"\u4e07");g=b.textWidth(h);
m=MO.RFloat.unitFormat(this._investmentTotal,0,0,2,0,1E4,"\u4e07");p=b.textWidth(m);e=MO.RFloat.unitFormat(this._investmentTotal/24,0,0,2,0,1E4,"\u4e07");t=b.textWidth(e);k=Math.max(Math.max(g,p),t);b.drawText("\u5cf0\u503c\uff1a",f,a+30,"#00CFFF");b.drawText(h,f+n+k-g,a+30,"#00B5F6");b.drawText("\u603b\u989d\uff1a",f,a+55,"#00CFFF");b.drawText(m,f+n+k-p,a+55,"#00B5F6");b.drawText("\u5747\u503c\uff1a",f,a+80,"#00CFFF");b.drawText(e,f+n+k-t,a+80,"#00B5F6");d.date.setTime(c);d.refresh()}}};
with(MO)MO.FGuiHistoryMilestoneFrame=function(a){a=RClass.inherits(this,a,FGuiControl);a._bgImage=null;a._numImages=null;a._wanImage=null;a._yiImage=null;a._data=RClass.register(a,new AGetSet("_data"));a._startTick=0;a._popDuration=500;a._showDuration=2E3;a._closeDuration=500;a._fullWidth=953;a._fullHeight=896;a.setup=FGuiHistoryMilestoneFrame_setup;a.onPaintBegin=FGuiHistoryMilestoneFrame_onPaintBegin;a.onImageLoad=FGuiHistoryMilestoneFrame_onImageLoad;a.show=FGuiHistoryMilestoneFrame_show;a.dispose=
FGuiHistoryMilestoneFrame_dispose;a._dataChangedListeners=RClass.register(a,new AListener("_dataChangedListeners",EEvent.DataChanged));return a},MO.FGuiHistoryMilestoneFrame_setup=function(){this.setWidth(this._fullWidth);this.setHeight(this._fullHeight);this.setLeft((MO.Eai.Canvas.logicSize().width-this._fullWidth)/2);this.setTop(MO.Eai.Canvas.logicSize().height);this._bgImage=MO.Class.create(MO.FImage);this._bgImage.addLoadListener(this,this.onImageLoad);this._bgImage.loadUrl("../ars/eai/milestone/bg.png");
this._wanImage=MO.Class.create(MO.FImage);this._wanImage.addLoadListener(this,this.onImageLoad);this._wanImage.loadUrl("../ars/eai/number/wan.png");this._yiImage=MO.Class.create(MO.FImage);this._yiImage.addLoadListener(this,this.onImageLoad);this._yiImage.loadUrl("../ars/eai/number/yi.png");this._numImages=Array(10);for(var a=0;10>a;a++){var b=MO.Class.create(MO.FImage);b.addLoadListener(this,this.onImageLoad);b.loadUrl("../ars/eai/number/"+a+".png");this._numImages[a]=b}},MO.FGuiHistoryMilestoneFrame_onImageLoad=
function(){this.dirty()},MO.FGuiHistoryMilestoneFrame_onPaintBegin=function(a){if(this._data){this.__base.FGuiControl.onPaintBegin.call(this,a);a=a.graphic;var b=this._clientRectangle,c=this._bgImage._size,d=b.left+b.width/2,e=d-100,f=b.top+520,g=MO.Timer.current()-this._startTick,h=g-this._popDuration,m=g-this._showDuration-this._popDuration,l=(MO.Eai.Canvas.logicSize().height+this._fullHeight)/2+100,k=0;g<this._popDuration?(k=g/this._popDuration,k=1-(1-k)*(1-k),a._handle.globalAlpha=k,this.setTop(MO.Eai.Canvas.logicSize().height-
l*k)):h<this._showDuration||(m<this._closeDuration?(k=m/this._closeDuration,k*=k,a._handle.globalAlpha=1-k,this.setTop((MO.Eai.Canvas.logicSize().height-this._fullHeight)/2-100-l*k)):(this._data=null,this.setVisible(!1),this.dirty(),g=MO.Memory.alloc(SEvent),g.sender=this,this.processDataChangedListener(g)));a.drawImage(this._bgImage,d-c.width/2,b.top,c.width,c.height);a.setFont("bold 20px Microsoft YaHei");a.drawText("\u8fbe\u6210\u65e5\u6570\uff1a",e,f+50,"#FFE849");a.drawText("\u5206\u516c\u53f8\u6570\uff1a",
e,f+100,"#FFE849");a.drawText("\u7406\u8d22\u5e08\u6570\uff1a",e,f+150,"#FFE849");if(this.data()){c=this.data().investmentTotal().toString();4<c.length?(c=c.substring(0,c.length-4),g=this._yiImage):g=this._wanImage;h=this._numImages[0]._size;d-=(c.length*h.width+this._yiImage._size.width)/2;for(m=0;m<c.length;m++)a.drawImage(this._numImages[c[m]],d+m*h.width,b.top+320,h.width,h.height);a.drawImage(g,d+c.length*h.width,b.top+320,h.width,h.height);a.drawText(this.data().dayCount(),e+120,f+50,"#FFA800");
a.drawText(this.data().companyCount(),e+120,f+100,"#FFA800");a.drawText(this.data().staffCount(),e+120,f+150,"#FFA800")}a._handle.globalAlpha=1}},MO.FGuiHistoryMilestoneFrame_show=function(){o=this;o.setVisible(!0);o._startTick=MO.Timer.current()},MO.FGuiHistoryMilestoneFrame_dispose=function(){this.__base.FEaiEntity.dispose.call(this)};
with(MO)MO.FGuiHistoryTimeline=function(a){a=RClass.inherits(this,a,FGuiTimeline);a.onPaintBegin=FGuiHistoryTimeline_onPaintBegin;return a},MO.FGuiHistoryTimeline_onPaintBegin=function(a){this.__base.FGuiTimeline.onPaintBegin.call(this,a);var b=a.graphic,c=a.rectangle,d=c.top;a=c.bottom()-50;for(var d=a-(d+30),e=this.triangleWidth()+this.decoLineGap(),f=c.left+5+e+this.decoLineWidth(),g=c.left+c.width-5-e-this.decoLineWidth(),c=this.startTime(),h=this.endTime(),m=this.degreeTime(),e=c.date.getTime(),
l=h.date.getTime()-c.date.getTime(),k=MO.Console.find(MO.FEaiResourceConsole).historyConsole(),p=k.investmentTotal(),q=k.dates().get(h.format("YYYYMMDD")),h=q.investmentTotal(),r=1E4*d/h,q=k.dates().get(c.format("YYYYMMDD")),n=q.investmentTotal(),h=f,t=a-n/1E4*r,w=MO.Console.find(MO.FEaiResourceConsole).rateConsole().find(EEaiRate.Line);c.isBefore(m);)if(q=k.dates().get(c.format("YYYYMMDD"))){var v=c.date.getTime()-e,v=f+v/l*(g-f),u=q.investmentTotal(),q=a-u/1E4*r,u=RHex.format(w.findRate(u/p)),x=
"#"+u.substring(2);b.drawLine(h,t,v,q,x,3);1==c.date.getDate()&&(u=MO.RFloat.unitFormat(n,0,0,2,0,1E4,"\u4e07"),b.drawCircle(v,q,3,0,x,x));h=v;t=q;c.addDay(1)}else break;c.date.setTime(e);for(c.refresh();c.isBefore(m);)if(q=k.dates().get(c.format("YYYYMMDD")))v=c.date.getTime()-e,v=f+v/l*(g-f),n=q.investmentTotal(),q=a-n/1E4*r,1==c.date.getDate()&&(b.setFont("bold 16px Microsoft YaHei"),1E8<n?(u=MO.RFloat.unitFormat(n,0,0,2,0,1E8,"\u4ebf"),p=b.textWidth(u),b.drawText(u,v-p/2,q-16,"#FFE849")):(u=MO.RFloat.unitFormat(n,
0,0,2,0,1E4,"\u4e07"),p=b.textWidth(u),b.drawText(u,v-p/2,q-16,"#FF7200"))),c.addDay(1);else break;if(q=k.dates().get(c.format("YYYYMMDD")))v=c.date.getTime()-e+this.unitms()*this.progress(),v=f+v/l*(g-f),n=q.investmentTotal(),q=a-n/1E4*r,a=1-q/d,a=parseInt(w.count()*a),u=RHex.format(w.find(a)),x="#"+u.substring(2),b.drawLine(h,t,v,t+(q-t)*this.progress(),x,3),b.drawCircle(v,t+(q-t)*this.progress(),3,0,x,x),b.setFont("bold 16px Microsoft YaHei"),1E8<n?(u=MO.RFloat.unitFormat(n,0,0,2,0,1E8,"\u4ebf"),
p=b.textWidth(u),b.drawText(u,v-p/2,q-16,"#FFE849")):(u=MO.RFloat.unitFormat(n,0,0,2,0,1E4,"\u4e07"),p=b.textWidth(u),b.drawText(u,v-p/2,q-16,"#FF7200"));c.date.setTime(e);c.refresh()};
with(MO)MO.FGuiLivePop=function(a){a=RClass.inherits(this,a,FGuiControl);a._bgImage=null;a._data=RClass.register(a,new AGetSet("_data"));a._startTick=0;a._popDuration=500;a._showDuration=2E3;a._closeDuration=500;a._fullWidth=910;a._fullHeight=140;a._riseHeight=50;a.setup=FGuiLivePop_setup;a.onPaintBegin=FGuiLivePop_onPaintBegin;a.onImageLoad=FGuiLivePop_onImageLoad;a.show=FGuiLivePop_show;a.dispose=FGuiLivePop_dispose;return a},MO.FGuiLivePop_setup=function(){this.setWidth(this._fullWidth);this.setHeight(this._fullHeight);
this.setLeft((MO.Eai.Canvas.logicSize().width-this._fullWidth)/3);this.setTop((MO.Eai.Canvas.logicSize().height-this._fullHeight)/2+this._riseHeight);this._bgImage=MO.Class.create(MO.FImage);this._bgImage.addLoadListener(this,this.onImageLoad);this._bgImage.loadUrl("../ars/eai/invespop.png")},MO.FGuiLivePop_onImageLoad=function(){this.dirty()},MO.FGuiLivePop_onPaintBegin=function(a){this.__base.FGuiControl.onPaintBegin.call(this,a);if(this._data){a=a.graphic;var b=this._clientRectangle,c=this._data,
d=MO.Console.find(MO.FEaiEntityConsole).cityConsole().findByCard(c.card()),e="",f=MO.Memory.alloc(TDate);f.parse(c.date());e+=f.format("HH24:MI:SS");e+="    ";d&&(e+=d.data().label());e=e+"    "+(c.customer()+" - "+c.phone());e+="    ";e+=MO.Lang.Float.format(c.investment(),null,null,2,"0");a.setFont("36px Microsoft YaHei");popTextWidth=a.textWidth(e);var c=MO.Timer.current()-this._startTick,d=c-this._popDuration,f=c-this._showDuration-this._popDuration,g=0;c<this._popDuration?(g=c/this._popDuration,
a.globalAlpha=g,a.drawImage(this._bgImage,b.left,b.top,this._fullWidth,this._fullHeight),a.globalAlpha=1,this.setTop((MO.Eai.Canvas.logicSize().height-this._fullHeight)/2+this._riseHeight*(1-g)),a.drawText(e,b.left+(b.width-popTextWidth)/2,b.top+80,"rgba(255, 241, 0, "+g+")")):d<this._showDuration?(a.drawImage(this._bgImage,b.left,b.top,this._fullWidth,this._fullHeight),a.drawText(e,b.left+(b.width-popTextWidth)/2,b.top+80,"rgba(255, 241, 0, 1)")):f<this._closeDuration?(g=f/this._closeDuration,a.globalAlpha=
g,a.drawImage(this._bgImage,b.left,b.top,this._fullWidth,this._fullHeight),a.globalAlpha=1,this.setTop((MO.Eai.Canvas.logicSize().height-this._fullHeight)/2-this._riseHeight*g),a.drawText(e,b.left+(b.width-popTextWidth)/2,b.top+80,"rgba(255, 241, 0, "+(1-g)+")")):(this._data=null,this.setVisible(!1))}},MO.FGuiLivePop_show=function(){o=this;o.setVisible(!0);o._startTick=MO.Timer.current()},MO.FGuiLivePop_dispose=function(){this.__base.FEaiEntity.dispose.call(this)};
MO.FGuiLiveTable=function(a){a=MO.Class.inherits(this,a,MO.FGuiControl);a._currentDate=null;a._rank=MO.Class.register(a,new MO.AGetSet("_rank"));a._data=MO.Class.register(a,new MO.AGetSet("_data"));a._rankLogoImage=null;a._rankLineImage=null;a._rankLinePadding=null;a._rank1Image=null;a._rank2Image=null;a._rank3Image=null;a._backgroundImage=null;a._backgroundPadding=null;a._columnLabels=null;a._columnDefines=null;a._columnWidths=null;a._listenersDataChanged=MO.Class.register(a,new MO.AListener("_listenersDataChanged",
MO.EEvent.DataChanged));a.onImageLoad=MO.FGuiLiveTable_onImageLoad;a.construct=MO.FGuiLiveTable_construct;a.setup=MO.FGuiLiveTable_setup;a.drawRow=MO.FGuiLiveTable_drawRow;a.onPaintBegin=MO.FGuiLiveTable_onPaintBegin;a.dispose=MO.FGuiLiveTable_dispose;return a};MO.FGuiLiveTable_onImageLoad=function(){this.dirty()};
MO.FGuiLiveTable_construct=function(){this.__base.FGuiControl.construct.call(this);this._currentDate=MO.TDate();this._rankLinePadding=new MO.SPadding(40,0,40,0);this._backgroundPadding=new MO.SPadding(60,60,100,60);this._columnLabels=["\u65f6\u95f4","\u57ce\u5e02","\u7528\u6237-\u624b\u673a","\u6295\u8d44\u989d(\u5143)"];MO.Runtime.isPlatformMobile()?this._columnDefines=[130,130,180,186]:this._columnDefines=[110,110,160,166];this._columnWidths=[]};
MO.FGuiLiveTable_setup=function(){var a=this._logoImage=MO.Class.create(MO.FImage);a.addLoadListener(this,this.onImageLoad);a.loadUrl("../ars/eai/statistics/logo.png");a=this._backgroundImage=MO.Class.create(MO.FImage);a.addLoadListener(this,this.onImageLoad);a.loadUrl("../ars/eai/statistics/grid.png");a=this._rankLineImage=MO.Class.create(MO.FImage);a.addLoadListener(this,this.onImageLoad);a.loadUrl("../ars/eai/statistics/line.png");a=this._rank1Image=MO.Class.create(MO.FImage);a.addLoadListener(this,
this.onImageLoad);a.loadUrl("../ars/eai/statistics/1.png");a=this._rank2Image=MO.Class.create(MO.FImage);a.addLoadListener(this,this.onImageLoad);a.loadUrl("../ars/eai/statistics/2.png");a=this._rank3Image=MO.Class.create(MO.FImage);a.addLoadListener(this,this.onImageLoad);a.loadUrl("../ars/eai/statistics/3.png");MO.Runtime.isPlatformMobile()?(this._headFontStyle="bold 42px Microsoft YaHei",this._headStart=120,this._headTextTop=38,this._headHeight=54,this._rankStart=220,this._rankHeight=60,this._rankIconStart=
30,this._rankRowUp=46,this._rankRowDown=68,this._rowStart=400,this._rowFontStyle="36px Microsoft YaHei",this._rowHeight=46):(this._headFontStyle="bold 36px Microsoft YaHei",this._headStart=116,this._headTextTop=26,this._headHeight=40,this._rankStart=190,this._rankHeight=44,this._rankIconStart=25,this._rankRowUp=32,this._rankRowDown=51,this._rowStart=320,this._rowFontStyle="22px Microsoft YaHei",this._rowHeight=32)};
MO.FGuiLiveTable_drawRow=function(a,b,c,d,e,f,g){var h=this._columnWidths,m=null,m=c?"#E5BD1D":"#59FDE9";if(c){this._rankLineImage.testReady()&&a.drawGridImage(this._rankLineImage,e-9,f-this._rankRowUp,g-42,this._rankRowDown,this._rankLinePadding);g=e+.5*h[0]-23;var l=f-this._rankIconStart;0==d&&this._rank1Image.testReady()&&a.drawImage(this._rank1Image,g,l,46,37);1==d&&this._rank2Image.testReady()&&a.drawImage(this._rank2Image,g,l,46,37);2==d&&this._rank3Image.testReady()&&a.drawImage(this._rank3Image,
g,l,46,37)}c||(this._currentDate.parse(b.date()),c=this._currentDate.format("HH24:MI:SS"),d=a.textWidth(c),a.drawText(c,e+h[0]/2-d/2,f,m));e+=h[0];d=MO.Console.find(MO.FEaiResourceConsole).cityConsole().findCityByCard(b.card());c="";d&&(c=d.label());d=a.textWidth(c);a.drawText(c,e+h[1]/2-d/2,f,m);e+=h[1];c=b.customer()+" - "+b.phone();d=a.textWidth(c);a.drawText(c,e+h[2]/2-d/2,f,m);e+=h[2];b=MO.Lang.Float.format(b.investment(),null,null,2,"0");e=e+h[3]-15;7<b.length?(m=null,m=9<b.length?"#FDEF01":
"#EB6C03",h=b.substring(0,b.length-7),b=b.substring(b.length-7,b.length),c=a.textWidth(h),d=a.textWidth(b),a.drawText(h,e-d-c,f,m),a.drawText(b,e-d,f,"#59FDE9")):(c=b,d=a.textWidth(c),a.drawText(c,e-d,f,m))};
MO.FGuiLiveTable_onPaintBegin=function(a){this.__base.FGuiControl.onPaintBegin.call(this,a);var b=a.graphic,c=a.rectangle,d=c.left;a=c.top;for(var e=c.width,f=c.height,g=d+e,c=d+29,h=g-d,m=0,l=0;4>l;l++)m+=this._columnDefines[l];for(l=0;4>l;l++)this._columnWidths[l]=this._columnDefines[l]/m*h-14;b.drawGridImage(this._backgroundImage,d,a,e,f,this._backgroundPadding);b.setFont(this._headFontStyle);l=b.textWidth("\u94b0\u8bda\u63a7\u80a1 - e\u79df\u5b9d");l=d+(g-d)/2-l/2;this._logoImage.testReady()&&
b.drawImage(this._logoImage,l-77,a+35,62,62);b.drawText("\u94b0\u8bda\u63a7\u80a1 - e\u79df\u5b9d",l,a+76,"#59FDE9");b.setFont(this._rowFontStyle);d="";e=0;g=c;f=a+this._headStart;m=f+this._headTextTop;for(l=0;4>l;l++)d=this._columnLabels[l],e=b.textWidth(d),b.fillRectangle(g,f,this._columnWidths[l]-4,this._headHeight,"#122A46"),b.drawText(d,g+.5*(this._columnWidths[l]-e-4),m,"#00B2F2"),g+=this._columnWidths[l];if(d=this._rank)for(e=a+this._rankStart,g=this._data,f=d.count(),l=0;l<f;l++)m=d.at(l),
this.drawRow(b,m,!0,l,c,e+this._rankHeight*l,h);if(g=this._data)for(e=a+this._rowStart,f=g.count(),l=0;l<f;l++)m=g.at(l),this.drawRow(b,m,!1,l,c,e+this._rowHeight*l,h)};MO.FGuiLiveTable_dispose=function(){this._backgroundPadding=RObject.dispose(this._backgroundPadding);this.__base.FEaiEntity.dispose.call(this)};
MO.FEaiStatisticsDate=function(a){a=MO.Class.inherits(this,a,MO.FGuiLabel);a._value=MO.Class.register(a,new MO.AGetter("_value"));a.onPaintLabel=MO.FEaiStatisticsDate_onPaintLabel;a.construct=MO.FEaiStatisticsDate_construct;a.setValue=MO.FEaiStatisticsDate_setValue;a.dispose=MO.FEaiStatisticsDate_dispose;return a};
MO.FEaiStatisticsDate_onPaintLabel=function(a){var b=a.graphic,c=a.rectangle;this._foreFont&&b.setFont(this._foreFont);a=this._value.format("YYYY");var d=this._value.format("MM"),e=this._value.format("DD"),f=a+"\u5e74",g=d+"\u6708";b.textWidth(f+g+(e+"\u65e5"));var f=b.textWidth(f),g=b.textWidth(g),h=c.left,c=c.top+c.height,m=b.textWidth(a);b.drawText(a,h,c,"#FFD926");b.drawText("\u5e74",h+m,c-1,"#00B5F6");m=b.textWidth(d);b.drawText(d,h+f,c,"#FFD926");b.drawText("\u6708",h+f+m,c-1,"#00B5F6");m=b.textWidth(e);
b.drawText(e,h+f+g,c,"#FFD926");b.drawText("\u65e5",h+f+g+m,c-1,"#00B5F6")};MO.FEaiStatisticsDate_construct=function(){this.__base.FGuiLabel.construct.call(this);this._value=new MO.TDate};MO.FEaiStatisticsDate_setValue=function(a){this._value.parse(a,"YYYYMMDD");this.dirty()};MO.FEaiStatisticsDate_dispose=function(){this._value=MO.Lang.Object.dispose(this._value);this.__base.FGuiLabel.dispose.call(this)};
MO.FEaiStatisticsInvestment=function(a){a=MO.Class.inherits(this,a,MO.FObject,MO.MGraphicObject,MO.MListener);a._dateSetup=!1;a._beginDate=MO.Class.register(a,new MO.AGetter("_beginDate"));a._endDate=MO.Class.register(a,new MO.AGetter("_endDate"));a._invementDayCurrent=MO.Class.register(a,new MO.AGetter("_invementDayCurrent"),0);a._invementDay=MO.Class.register(a,new MO.AGetter("_invementDay"),0);a._invementTotalCurrent=MO.Class.register(a,new MO.AGetter("_invementTotalCurrent"),0);a._invementTotal=
MO.Class.register(a,new MO.AGetter("_invementTotal"),0);a._intervalMinute=2;a._mapEntity=MO.Class.register(a,new MO.AGetSet("_mapEntity"));a._display=MO.Class.register(a,new MO.AGetter("_display"));a._rankEntities=MO.Class.register(a,new MO.AGetter("_rankEntities"));a._entities=MO.Class.register(a,new MO.AGetter("_entities"));a._tableEntities=MO.Class.register(a,new MO.AGetter("_tableEntities"));a._showShapes=MO.Class.register(a,new MO.AGetter("_showShapes"));a._tableCount=21;a._tableInterval=1E3;
a._tableTick=1;a._dataTicker=null;a._entityPool=null;a._shapePool=null;a._autios=null;a._listenersEntityChanged=MO.RClass.register(a,new MO.AListener("_listenersEntityChanged",MO.EEvent.DataChanged));a.onInvestment=MO.FEaiStatisticsInvestment_onInvestment;a.construct=MO.FEaiStatisticsInvestment_construct;a.allocEntity=MO.FEaiStatisticsInvestment_allocEntity;a.allocShape=MO.FEaiStatisticsInvestment_allocShape;a.setup=MO.FEaiStatisticsInvestment_setup;a.calculateCurrent=MO.FEaiStatisticsInvestment_calculateCurrent;
a.focusEntity=MO.FEaiStatisticsInvestment_focusEntity;a.process=MO.FEaiStatisticsInvestment_process;a.dispose=MO.FEaiStatisticsInvestment_dispose;return a};
MO.FEaiStatisticsInvestment_onInvestment=function(a){a=a.content;this._invementDay=a.investment_day;this._invementTotal=a.investment_total;for(var b=this._rankEntities,c=b.count(),d=0;d<c;d++){var e=b.at(d);this._entityPool.free(e)}b.clear();var f=a.rank;if(f)for(c=f.length,d=0;d<c;d++){var g=f[d],e=this.allocEntity();e.loadData(g);b.push(e)}if(f=a.collection)for(c=f.length,d=0;d<c;d++)g=f[d],e=this.allocEntity(),e.loadData(g),this._entities.push(e);this.calculateCurrent();a=MO.Memory.alloc(MO.SEvent);
a.sender=this;a.rank=this._rankEntities;a.data=this._tableEntities;this.processDataChangedListener(a);MO.Memory.free(a);a=this._entities.count();this._tableInterval=6E4*this._intervalMinute/a;this._tableTick=0};
MO.FEaiStatisticsInvestment_construct=function(){this.__base.FObject.construct.call(this);this._beginDate=new MO.TDate;this._endDate=new MO.TDate;this._entities=new MO.TObjects;this._showShapes=new MO.TObjects;this._tableEntities=new MO.TObjects;this._tableTicker=new MO.TTicker(1E3*this._tableInterval);this._autios={};this._dataTicker=new MO.TTicker(6E4*this._intervalMinute);var a=this._dataTable=MO.Class.create(MO.FEaiStatisticsTable);a._hTable=document.getElementById("id_investment");a._headLineCount=
1;this._rankEntities=new MO.TObjects;this._entityPool=MO.Class.create(MO.FObjectPool);this._shapePool=MO.Class.create(MO.FObjectPool)};MO.FEaiStatisticsInvestment_allocEntity=function(){var a=this._entityPool.alloc();a||(a=MO.Class.create(MO.FEaiStatisticsInvestmentEntity));return a};MO.FEaiStatisticsInvestment_allocShape=function(){var a=this._shapePool.alloc();a||(a=MO.Class.create(MO.FEaiStatisticsInvestmentShape),a.linkGraphicContext(this),a.setup());return a};
MO.FEaiStatisticsInvestment_setup=function(){MO.Runtime.isPlatformMobile()?this._tableCount=12:this._tableCount=21;for(var a=MO.Console.find(MO.FAudioConsole),b=1;5>=b;b++)this._autios[b]=a.load("{eai.resource}/currency/"+b+".mp3");(this._display=MO.Class.create(MO.FE3dDisplay)).linkGraphicContext(this)};
MO.FEaiStatisticsInvestment_calculateCurrent=function(){for(var a=this._invementDay,b=this._invementTotal,c=this._entities,d=c.count(),e=0;e<d;e++)var f=c.at(e).investment(),a=a-f,b=b-f;this._invementDayCurrent=Math.max(a,0);this._invementTotalCurrent=Math.max(b,0)};
MO.FEaiStatisticsInvestment_focusEntity=function(a){var b=a.card();a=a.investment();MO.Console.find(MO.FEaiResourceConsole).cityConsole();if(b=this._mapEntity.findCityByCard(b)){var c=b.data().provinceCode();MO.Console.find(MO.FEaiResourceConsole).provinceConsole().findByCode(c);(c=this._mapEntity.findProvinceByCard(c))&&c.doInvestment();b.addInvestmentTotal(a);this._mapEntity.upload();b=this._autios;1E6<=a?b[5].play(0):1E6<=a?b[4].play(0):1E5<=a?b[3].play(0):1E4<=a?b[2].play(0):1E3<=a&&b[1].play(0)}};
MO.FEaiStatisticsInvestment_process=function(){var a=MO.Console.find(MO.FEaiLogicConsole).system();if(a.testReady()){a=a.currentDate();this._dateSetup||(this._endDate.assign(a),this._endDate.addMinute(-this._intervalMinute),this._dateSetup=!0);if(this._dataTicker.process()){var b=MO.Console.find(MO.FEaiLogicConsole).statistics(),c=this._beginDate,d=this._endDate;c.assign(d);d.assign(a);b.doInvestmentDynamic(this,this.onInvestment,c.format(),d.format());c.assign(d)}a=MO.RTimer.current();a-this._tableTick>
this._tableInterval&&(this._tableEntities.count()>this._tableCount&&(b=this._tableEntities.pop(),this._entityPool.free(b)),b=this._entities,b.isEmpty()||(b=b.shift(),this._tableEntities.unshift(b),this.focusEntity(b),b=MO.Memory.alloc(MO.SEvent),b.sender=this,b.rank=this._rankEntities,b.data=this._tableEntities,this.processDataChangedListener(b),MO.Memory.free(b)),this.calculateCurrent(),this._tableTick=a);this._mapEntity.process();a=this._showShapes;for(b=a.count()-1;0<=b;b--)c=a.at(b),c._finish&&
(a.erase(b),this._display.removeRenderable(c),this._shapePool.free(c))}};MO.FEaiStatisticsInvestment_dispose=function(){this._entities=MO.RObject.dispose(this._entities);this._showShapes=MO.RObject.dispose(this._showShapes);this._dataTicker=MO.RObject.dispose(this._dataTicker);this.__base.FObject.dispose.call(this)};
with(MO)MO.FEaiStatisticsInvestmentEntity=function(a){a=RClass.inherits(this,a,FEaiEntity);a._date=RClass.register(a,new AGetter("_date"));a._customer=RClass.register(a,new AGetter("_customer"));a._phone=RClass.register(a,new AGetter("_phone"));a._card=RClass.register(a,new AGetter("_card"));a._investment=RClass.register(a,new AGetter("_investment"));a._shape=RClass.register(a,new AGetSet("_shape"));a.construct=FEaiStatisticsInvestmentEntity_construct;a.loadData=FEaiStatisticsInvestmentEntity_loadData;
a.update=FEaiStatisticsInvestmentEntity_update;a.dispose=FEaiStatisticsInvestmentEntity_dispose;return a},MO.FEaiStatisticsInvestmentEntity_construct=function(){this.__base.FEaiEntity.construct.call(this)},MO.FEaiStatisticsInvestmentEntity_loadData=function(a){this._date=a.date;this._customer=a.customer;this._phone=a.phone;this._card=a.card;this._investment=a.investment},MO.FEaiStatisticsInvestmentEntity_build=function(a){this._location.assign(this._data.location());this._size.set(2,2)},MO.FEaiStatisticsInvestmentEntity_update=
function(a){this._data.location();var b=1;if(a){var c=RConsole.find(FEaiResourceConsole).historyConsole().investmentCityTotal(),b=RConsole.find(FEaiResourceConsole).rateConsole().find(EEaiRate.Map);a=5*Math.sqrt(a.investmentTotal()/c);c=b.findRate(a);b=10*a;a=RFloat.toRange(a,0,1);this._color.set((c>>16&255)/255,(c>>8&255)/255,(c>>0&255)/255,4*a)}else this._color.set(0,0,0,0);b=this._range=RFloat.toRange(Math.sqrt(b),1,4);this._size.set(b,b)},MO.FEaiStatisticsInvestmentEntity_dispose=function(){this.__base.FEaiEntity.dispose.call(this)};
with(MO)MO.FEaiStatisticsInvestmentShape=function(a){a=RClass.inherits(this,a,FE3dShape);a._ready=!1;a._playing=!1;a._finish=!1;a._image=null;a._statusPaint=!1;a._cityEntity=RClass.register(a,new AGetSet("_cityEntity"));a._entity=RClass.register(a,new AGetter("_entity"));a._customerLabel=null;a._cityLabel=null;a._investment=null;a._interval=10;a._moveRate=0;a._lastTick=0;a.onImageLoad=FEaiStatisticsInvestmentShape_onImageLoad;a.construct=FEaiStatisticsInvestmentShape_construct;a.setup=FEaiStatisticsInvestmentShape_setup;
a.setEntity=FEaiStatisticsInvestmentShape_setEntity;a.paint=FEaiStatisticsInvestmentShape_paint;a.process=FEaiStatisticsInvestmentShape_process;a.dispose=FEaiStatisticsInvestmentShape_dispose;return a},MO.FEaiStatisticsInvestmentShape_onImageLoad=function(a){this._ready=!0},MO.FEaiStatisticsInvestmentShape_construct=function(){this.__base.FE3dShape.construct.call(this)},MO.FEaiStatisticsInvestmentShape_setup=function(){this.__base.FE3dShape.setup.call(this);var a=this._renderable=RClass.create(FE3dShapeData);
a.linkGraphicContext(this);a.setOptionCenter(!0);a.size().set(128,64);a.setup();a=this._image=RClass.create(FImage);a.addLoadListener(this,this.onImageLoad);a.loadUrl("/script/ars/eai/investment.png");this._ready=!1},MO.FEaiStatisticsInvestmentShape_setEntity=function(a){this._customerLabel=a.customer();this._cityLabel=this._cityEntity.data().label();this._investment=a.investment();this._finish=!1},MO.FEaiStatisticsInvestmentShape_paint=function(){var a=this._cityEntity.location(),b=this.material();
b.info().optionAlpha=!0;b.info().ambientColor.set(1,1,1,1);b=this._matrix;b.tx=a.x;b.ty=a.y;b.tz=0;b.setScale(10,5,1);b.update();a=this._renderable;b=a.beginDraw();b.drawImage(this._image,0,0,128,64);b.setFont("bold 18px Microsoft YaHei");b.drawText(this._cityLabel,15,25,"#FF00FF");b.setFont("bold 20px Microsoft YaHei");b.drawText(this._customerLabel,30,50,"#FFFF00");b.setFont("bold 20px Microsoft YaHei");b.drawText(this._investment,55,50,"#FF0000");a.endDraw();this._playing=this._statusPaint=!0;
this._moveRate=this._lastTick=0},MO.FEaiStatisticsInvestmentShape_process=function(a){this.__base.FE3dShape.process.call(this,a);this._statusDirty&&this.testReady()&&(this._statusPaint||(this.paint(),this._statusPaint=!0),this._statusDirty=!1);if(this._statusPaint&&!this._finish){a=RTimer.current();var b=this._matrix;a-this._lastTick>this._interval&&(b.ty+=this._moveRate+.01,this._moveRate+=.01,b.updateForce(),this._lastTick=a);100<b.ty&&(this._finish=!0)}},MO.FEaiStatisticsInvestmentShape_dispose=
function(){this.__base.FE3dShape.dispose.call(this)};MO.FEaiStatisticsLabel=function(a){a=MO.Class.inherits(this,a,MO.FGuiLabel);a._value=MO.Class.register(a,new MO.AGetSet("_value"),"0");a._currentValue="0";a._ticker=null;a.onPaintLabel=MO.FEaiStatisticsLabel_onPaintLabel;a.oeUpdate=MO.FEaiStatisticsLabel_oeUpdate;a.construct=MO.FEaiStatisticsLabel_construct;a.updateValue=MO.FEaiStatisticsLabel_updateValue;a.dispose=MO.FEaiStatisticsLabel_dispose;return a};
MO.FEaiStatisticsLabel_onPaintLabel=function(a){var b=a.graphic,c=a.rectangle;this._foreFont&&b.setFont(this._foreFont);var d="",e=this._label,f=e.length,g=a=null;8<f&&(a=e.substring(0,f-8),g=a+"\u4ebf",d+=g);var h=null,m=null;4<f&&(h=e.substring(f-8,f-4),m=h+"\u4e07",d+=m);var l=null,k=null;0<f&&(l=e.substring(f-4,f),k=l+"\u5143",d+=k);b.textWidth(d);d=b.textWidth(g);e=b.textWidth(m);f=c.left;c=c.top+c.height;null!=g&&(g=b.textWidth(a),b.drawText(a,f,c,"#FFD926"),b.drawText("\u4ebf",f+g,c-1,"#00B5F6"));
null!=m&&(g=b.textWidth(h),b.drawText(h,f+d,c,"#FF7200"),b.drawText("\u4e07",f+d+g,c-1,"#00B5F6"));null!=k&&(g=b.textWidth(l),b.drawText(l,f+d+e,c,"#FD0000"),b.drawText("\u5143",f+d+e+g,c-1,"#00B5F6"))};MO.FEaiStatisticsLabel_oeUpdate=function(a){this.__base.FGuiLabel.oeUpdate.call(this,a);this._value!=this._currentValue&&this._ticker.process()&&(this.updateValue(),this.dirty());return MO.EEventStatus.Stop};
MO.FEaiStatisticsLabel_construct=function(){this.__base.FGuiLabel.construct.call(this);this._ticker=new MO.TTicker(200)};MO.FEaiStatisticsLabel_updateValue=function(){for(var a=this._value,b=this._currentValue,c="",d=!1,e=a.length-1;0<=e;e--){var f=a.charAt(e),f=parseInt(f),g=b.charAt(e),g=""==g?0:parseInt(g);d||f==g||(g++,9<g&&(g=0),d=!0);c=g+c}this._currentValue=this._label=c};MO.FEaiStatisticsLabel_dispose=function(){this._ticker=MO.RObject.dispose(this._ticker);this.__base.FGuiLabel.dispose.call(this)};
with(MO)MO.FEaiStatisticsTable=function(a){a=RClass.inherits(this,a,FEaiTable);a.createRow=FEaiCityEntity_createRow;return a},MO.FEaiCityEntity_createRow=function(){var a=RBuilder.appendTableRow(this._hTable);a.className="Investment_DataGrid_Row";var b=RBuilder.appendTableCell(a);b.className="Investment_DataGrid_Cell";b.align="center";b=RBuilder.appendTableCell(a);b.className="Investment_DataGrid_Cell";b.align="center";b=RBuilder.appendTableCell(a);b.className="Investment_DataGrid_Cell";b.align="center";
b=RBuilder.appendTableCell(a);b.className="Investment_DataGrid_Cell";b.align="right"};
MO.FEaiChartCustomerScene=function(a){a=MO.RClass.inherits(this,a,MO.FEaiChartScene);a._code=MO.EEaiScene.ChartCustomer;a._playing=!1;a._startDate=null;a._endDate=null;a._currentDate=null;a.onLoadData=MO.FEaiChartCustomerScene_onLoadData;a.onKeyDown=MO.FEaiChartCustomerScene_onKeyDown;a.setup=MO.FEaiChartCustomerScene_setup;a.selectDate=MO.FEaiChartCustomerScene_selectDate;a.active=MO.FEaiChartCustomerScene_active;a.process=MO.FEaiChartCustomerScene_process;a.deactive=MO.FEaiChartCustomerScene_deactive;
return a};MO.FEaiChartCustomerScene_onLoadData=function(a){this.__base.FEaiChartScene.onLoadData.call(this,a);a=this._currentDate.format("YYYYMMDD");this.selectDate(a)};
MO.FEaiChartCustomerScene_onKeyDown=function(a){a=a.keyCode;if(a==MO.EKeyCode.N){this._currentDate.addDay(-1);var b=this._currentDate.format("YYYYMMDD");this.selectDate(b);console.log(b)}a==MO.EKeyCode.M&&(this._currentDate.addDay(1),b=this._currentDate.format("YYYYMMDD"),this.selectDate(b),console.log(b));a==MO.EKeyCode.L&&(MO.RDate.autoParse(this._currentDate,"20140701"),this._playing=!0)};
MO.FEaiChartCustomerScene_selectDate=function(a){this.graphicContext();var b=this._activeStage;b.mapLayer();b.borderLayer();b.dataLayer();if(b=MO.Console.find(MO.FEaiResourceConsole).historyConsole().dates().get(a)){a=b.provinces();for(var c=a.count(),d=0;d<c;d++){var e=a.at(d);this._provinceEntities.get(e.code()).update(e)}for(var e=b.citys(),f=this._cityEntities,c=f.count(),d=0;d<c;d++){var g=f.at(d);a=g.data().code();a=e.get(a);g.update(a)}if(c=document.getElementById("id_total"))c.innerHTML=this._currentDate.format("YYYY-MM-DD")+
" "+b.investmentTotal()}this._citysRangeRenderable.upload()};MO.FEaiChartCustomerScene_setup=function(){this.__base.FEaiChartScene.setup.call(this);MO.RWindow.lsnsKeyDown.register(this,this.onKeyDown);this._currentDate=new MO.TDate;this._startDate=new MO.TDate;this._endDate=new MO.TDate;this._currentDate.parseAuto("20140701");this._startDate.parseAuto("20140701");this._endDate.parseAuto("20150618")};MO.FEaiChartCustomerScene_active=function(){this.__base.FEaiChartScene.active.call(this)};
MO.FEaiChartCustomerScene_process=function(){this.__base.FEaiChartScene.process.call(this);if(this._playing){this._currentDate.addDay(1);var a=this._currentDate.format("YYYYMMDD"),b=this._endDate.format("YYYYMMDD");this.selectDate(a);a==b&&(this._playing=!1)}};MO.FEaiChartCustomerScene_deactive=function(){this.__base.FEaiChartScene.deactive.call(this)};
MO.FEaiChartHistoryScene=function(a){a=MO.RClass.inherits(this,a,MO.FEaiChartScene);a._code=MO.EEaiScene.ChartHistory;a._ready=!1;a._mapReady=!1;a._playing=!1;a._lastTick=0;a._interval=10;a._lastDateTick=0;a._dateInterval=100;a._startDate=null;a._endDate=null;a._currentDate=null;a._logoBar=null;a._playButton=null;a._pauseButton=null;a._buttonTransform=null;a._timeline=null;a._milestoneFrame=null;a._buttonAudio=null;a._statusStart=!1;a._statusLayerCount=150;a._statusLayerLevel=150;a._milestoneShowed=
0;a._milestoneBarShowDuration=1E3;a._milestoneBarShowTick=0;a._milestoneBarShowing=!1;a.onLoadData=MO.FEaiChartHistoryScene_onLoadData;a.onDateSelect=MO.FEaiChartHistoryScene_onDateSelect;a.onMilestoneDone=MO.FEaiChartHistoryScene_onMilestoneDone;a.onOperationPlay=MO.FEaiChartHistoryScene_onOperationPlay;a.onOperationPause=MO.FEaiChartHistoryScene_onOperationPause;a.testReady=MO.FEaiChartHistoryScene_testReady;a.setup=MO.FEaiChartHistoryScene_setup;a.resetDate=MO.FEaiChartHistoryScene_resetDate;a.selectDate=
MO.FEaiChartHistoryScene_selectDate;a.switchPlay=MO.FEaiChartHistoryScene_switchPlay;a.active=MO.FEaiChartHistoryScene_active;a.process=MO.FEaiChartHistoryScene_process;a.deactive=MO.FEaiChartHistoryScene_deactive;return a};MO.FEaiChartHistoryScene_onLoadData=function(a){this.__base.FEaiChartScene.onLoadData.call(this,a);a=this._currentDate.format("YYYYMMDD");this.resetDate(a);this.selectDate(a)};
MO.FEaiChartHistoryScene_onDateSelect=function(a){this._currentDate.date.setTime(a.date.date.getTime());this._currentDate.refresh();this.selectDate(this._currentDate.format("YYYYMMDD"))};MO.FEaiChartHistoryScene_onMilestoneDone=function(a){this.switchPlay(!0);this._milestoneShowed++;this._milestoneBarShowTick=MO.Timer.current();this._milestoneBarShowing=!0};
MO.FEaiChartHistoryScene_onOperationPlay=function(a){a=this._currentDate.format("YYYYMMDD");var b=this._endDate.format("YYYYMMDD");a==b&&(a=MO.Console.find(MO.FEaiResourceConsole).historyConsole().dates().at(0),MO.RDate.autoParse(this._currentDate,a._code));this.switchPlay(!0)};MO.FEaiChartHistoryScene_onOperationPause=function(a){this.switchPlay(!1)};MO.FEaiChartHistoryScene_testReady=function(){if(!this._ready){if(!this._readyProvince)return!1;this._ready=!0}return this._ready};
MO.FEaiChartHistoryScene_setup=function(){this.__base.FEaiChartScene.setup.call(this);this._currentDate=new MO.TDate;this._startDate=new MO.TDate;this._endDate=new MO.TDate;var a=MO.Console.find(MO.FEaiResourceConsole).historyConsole(),b=a.dates().at(0),a=a.dates().at(a.dates().count()-1);this._currentDate.parseAuto(b._code);this._startDate.parseAuto(b._code);this._endDate.parseAuto(a._code);this._citysRangeRenderable.setVisible(!1);this._citysRenderable.setVisible(!1);b=this._logoBar=MO.RConsole.find(MO.FGuiFrameConsole).get(this,
"eai.history.LogoBar");b.setLocation(5,5);this._guiManager.register(b);b=this._playButton=MO.Class.create(MO.FGuiPicture);b.linkGraphicContext(this);b.setLocation(30,300);b.setSize(120,120);b.setBackResource("url:/script/ars/eai/city-level.png");b.psInitialize();b.build();b.setVisible(!0);this._guiManager.register(b);b=this._playButton=MO.Class.create(MO.FGuiPicture);b.linkGraphicContext(this);b.setLocation(40,730);b.setSize(196,196);b.setBackResource("url:/script/ars/eai/player.png");b.psInitialize();
b.build();b.setVisible(!0);b.addOperationDownListener(this,this.onOperationPlay);b=this._pauseButton=MO.Class.create(MO.FGuiPicture);b.linkGraphicContext(this);b.setLocation(40,730);b.setSize(196,196);b.setBackResource("url:/script/ars/eai/pause.png");b.psInitialize();b.build();b.setVisible(!1);b.addOperationDownListener(this,this.onOperationPause);(this._buttonAudio=MO.Class.create(MO.FAudio)).loadUrl("/script/ars/eai/button.mp3");b=this._buttonTransform=MO.Class.create(MO.FGuiChangeTransform);b.setInterval(10);
b.setScale(.1);for(var a=MO.Console.find(MO.FEaiResourceConsole).historyConsole(),a=a.milestones(),c=this._milestoneBars=new MO.TObjects,d=a.count(),e=0;e<d;e++){var f=a.at(e),b=MO.Console.find(MO.FGuiFrameConsole).create(this,"eai.chart.MilestoneBar");b.setDockCd(MO.EGuiDock.Right);b.setTop(100+110*e);b.setRight(-360);var g=new MO.TDate;g.parse(f.code());b.findComponent("date").setLabel(g.format("YYYY/MM/DD"));g=null;f=f.investmentTotal();g=1E4<=f?parseInt(f/1E4)+"\u4ebf":parseInt(f)+"\u4e07";b.findComponent("total").setLabel(g);
this._guiManager.register(b);c.push(b)}this.activeStage();b=this._timeline=MO.Class.create(MO.FGuiHistoryTimeline);b.linkGraphicContext(this);b.setName("Timeline");b.setDockCd(MO.EGuiDock.Bottom);b.setAnchorCd(MO.EGuiAnchor.Left|MO.EGuiAnchor.Right);b.setLeft(50);b.setRight(450);b.setBottom(50);b.setHeight(500);b.setTimeUnit(MO.EGuiTimeUnit.Month);b.setStartTime(this._startDate);b.setEndTime(this._endDate);b.setDegreeTime(this._currentDate);b.addDataChangedListener(this,this.onDateSelect);b.build();
this._guiManager.register(b);b=this._milestoneFrame=MO.RClass.create(MO.FGuiHistoryMilestoneFrame);b.linkGraphicContext(this);b.setName("MilestoneFrame");b.addDataChangedListener(this,this.onMilestoneDone);b.setup();b.build();this._guiManager.register(b);this._guiManager.hide()};MO.FEaiChartHistoryScene_resetDate=function(){for(var a=this._mapEntity.cityEntities(),b=a.count(),c=0;c<b;c++)a.at(c).reset()};
MO.FEaiChartHistoryScene_selectDate=function(a){var b=MO.Console.find(MO.FEaiResourceConsole).historyConsole();MO.Console.find(MO.FEaiResourceConsole).provinceConsole();var c=b.dates().get(a);if(b=b.milestones().get(a))this._milestoneFrame.setData(b),this._milestoneFrame.show(),this._milestoneFrame.dirty(),this.switchPlay(!1);if(c){this._timeline.setDegreeTime(this._currentDate);this._timeline.dirty();for(var b=c.citys(),d=this._mapEntity.cityEntities(),e=d.count(),f=0;f<e;f++){var g=d.at(f),h=g.data().code(),
h=b.get(h);g.update(h)}this._logoBar.findComponent("date").setValue(a);this._logoBar.findComponent("investment").setLabel(parseInt(c.investmentTotal()).toString())}};MO.FEaiChartHistoryScene_switchPlay=function(a){this._playing=a;this._buttonAudio.play(0);a?(this._playButton.setVisible(!1),this._pauseButton.setVisible(!0)):(this._playButton.setVisible(!0),this._pauseButton.setVisible(!1))};MO.FEaiChartHistoryScene_active=function(){this.__base.FEaiChartScene.active.call(this)};
MO.FEaiChartHistoryScene_process=function(){this.__base.FEaiChartScene.process.call(this);if(!this._statusStart&&this.testReady()){var a=document.getElementById("id_loading");a&&(a.style.opacity=this._statusLayerLevel/this._statusLayerCount,this._statusLayerLevel--);this._statusLayerLevel--;0==this._statusLayerLevel&&(a&&document.body.removeChild(a),this.switchPlay(!0),this._statusStart=!0)}a=MO.Timer.current();if(this._playing){var b=this._mapEntity.countryEntity();if(!b.introAnimeDone()){b.process();
return}this._mapReady||(this._citysRangeRenderable.setVisible(!0),this._citysRenderable.setVisible(!0),this._guiManager.show(),this._milestoneFrame.setVisible(!1),this._mapReady=!0);if(a-this._lastTick>this._interval){if(a-this._lastDateTick>this._dateInterval){this._currentDate.addDay(1);var b=this._currentDate.format("YYYYMMDD"),c=this._endDate.format("YYYYMMDD");this.selectDate(b);b==c&&this.switchPlay(!1);this._lastDateTick=a;this._mapEntity.upload()}this._timeline.setProgress((a-this._lastDateTick)/
this._dateInterval);this._timeline.dirty();this._lastTick=a}}this._milestoneBarShowing&&(a=(a-this._milestoneBarShowTick)/this._milestoneBarShowDuration,1<a&&(a=1,this._milestoneBarShowing=!1),a=(1-a)*(1-a),b=this._milestoneBars.at(this._milestoneShowed-1),b.setRight(20+-380*a),b.dirty());this._milestoneFrame.visible()&&this._milestoneFrame.dirty()};MO.FEaiChartHistoryScene_deactive=function(){this.__base.FEaiChartScene.deactive.call(this)};
MO.FEaiChartIndustryScene=function(a){a=MO.RClass.inherits(this,a,MO.FEaiChartScene);a._code=MO.EEaiScene.ChartIndustry;a._playing=!1;a._startDate=null;a._endDate=null;a._currentDate=null;a.onLoadData=MO.FEaiChartIndustryScene_onLoadData;a.onKeyDown=MO.FEaiChartIndustryScene_onKeyDown;a.setup=MO.FEaiChartIndustryScene_setup;a.selectDate=MO.FEaiChartIndustryScene_selectDate;a.active=MO.FEaiChartIndustryScene_active;a.process=MO.FEaiChartIndustryScene_process;a.deactive=MO.FEaiChartIndustryScene_deactive;
return a};MO.FEaiChartIndustryScene_onLoadData=function(a){this.__base.FEaiChartScene.onLoadData.call(this,a);a=this._currentDate.format("YYYYMMDD");this.selectDate(a)};
MO.FEaiChartIndustryScene_onKeyDown=function(a){a=a.keyCode;if(a==MO.EKeyCode.N){this._currentDate.addDay(-1);var b=this._currentDate.format("YYYYMMDD");this.selectDate(b);console.log(b)}a==MO.EKeyCode.M&&(this._currentDate.addDay(1),b=this._currentDate.format("YYYYMMDD"),this.selectDate(b),console.log(b));a==MO.EKeyCode.L&&(MO.RDate.autoParse(this._currentDate,"20140701"),this._playing=!0)};
MO.FEaiChartIndustryScene_selectDate=function(a){this.graphicContext();var b=this._activeStage;b.mapLayer();b.borderLayer();b.dataLayer();if(b=MO.Console.find(MO.FEaiResourceConsole).historyConsole().dates().get(a)){a=b.provinces();for(var c=a.count(),d=0;d<c;d++){var e=a.at(d);this._provinceEntities.get(e.code()).update(e)}for(var e=b.citys(),f=this._cityEntities,c=f.count(),d=0;d<c;d++){var g=f.at(d);a=g.data().code();a=e.get(a);g.update(a)}if(c=document.getElementById("id_total"))c.innerHTML=this._currentDate.format("YYYY-MM-DD")+
" "+b.investmentTotal()}this._citysRangeRenderable.upload()};MO.FEaiChartIndustryScene_setup=function(){this.__base.FEaiChartScene.setup.call(this);MO.RWindow.lsnsKeyDown.register(this,this.onKeyDown);this._currentDate=new MO.TDate;this._startDate=new MO.TDate;this._endDate=new MO.TDate;this._currentDate.parseAuto("20140701");this._startDate.parseAuto("20140701");this._endDate.parseAuto("20150618")};MO.FEaiChartIndustryScene_active=function(){this.__base.FEaiChartScene.active.call(this)};
MO.FEaiChartIndustryScene_process=function(){this.__base.FEaiChartScene.process.call(this);if(this._playing){this._currentDate.addDay(1);var a=this._currentDate.format("YYYYMMDD"),b=this._endDate.format("YYYYMMDD");this.selectDate(a);a==b&&(this._playing=!1)}};MO.FEaiChartIndustryScene_deactive=function(){this.__base.FEaiChartScene.deactive.call(this)};
MO.FEaiChartInvestmentScene=function(a){a=MO.RClass.inherits(this,a,MO.FEaiChartScene);a._code=MO.EEaiScene.ChartInvestment;a._playing=!1;a._startDate=null;a._endDate=null;a._currentDate=null;a._timeline=null;a.onLoadData=MO.FEaiChartInvestmentScene_onLoadData;a.onKeyDown=MO.FEaiChartInvestmentScene_onKeyDown;a.setup=MO.FEaiChartInvestmentScene_setup;a.selectDate=MO.FEaiChartInvestmentScene_selectDate;a.active=MO.FEaiChartInvestmentScene_active;a.process=MO.FEaiChartInvestmentScene_process;a.deactive=
MO.FEaiChartInvestmentScene_deactive;a.onDateSelect=MO.FEaiChartInvestmentScene_onDateSelect;return a};MO.FEaiChartInvestmentScene_onLoadData=function(a){this.__base.FEaiChartScene.onLoadData.call(this,a);a=this._currentDate.format("YYYYMMDD");this.selectDate(a)};
MO.FEaiChartInvestmentScene_onKeyDown=function(a){a=a.keyCode;if(a==MO.EKeyCode.N){this._currentDate.addDay(-1);var b=this._currentDate.format("YYYYMMDD");this.selectDate(b);console.log(b)}a==MO.EKeyCode.M&&(this._currentDate.addDay(1),b=this._currentDate.format("YYYYMMDD"),this.selectDate(b),console.log(b));if(a==MO.EKeyCode.L){MO.RDate.autoParse(this._currentDate,"20140701");a=document.getElementById("id_investment_table");for(b=1;b<a.rows.length;b++)a.rows[b].style.display="none";this._playing=
!0}};
MO.FEaiChartInvestmentScene_selectDate=function(a){this.graphicContext();var b=this._activeStage;b.mapLayer();b.borderLayer();var b=MO.Console.find(MO.FEaiResourceConsole).historyConsole(),c=MO.Console.find(MO.FEaiResourceConsole).provinceConsole();if(b=b.dates().get(a)){a=b.provinces();for(var d=a.count(),e=document.getElementById("id_investment_table");e.rows.length<d+1;){var f=e.insertRow(e.rows.length);f.insertCell(0);f.insertCell(1);f.insertCell(2)}for(var g=0;g<d;g++){var h=a.at(g);this._provinceEntities.get(h.code()).update(h);var m=
c.findByCode(h.code()),f=e.rows[g+1];f.style.display="";f.className="DataGrid_Row";var l=f.cells[0],k=f.cells[1],f=f.cells[2];2<g&&(l.innerText=g+1);k.innerText=m.label();1E3<h.investmentTotal()?f.innerText=MO.RFloat.unitFormat(h.investmentTotal(),0,0,2,0,1E4,"\u4e07"):f.innerText=h.investmentTotal();f.align="right"}this._timeline.setDegreeTime(this._currentDate);this._timeline.repaint();c=b.citys();e=this._cityEntities;d=e.count();for(g=0;g<d;g++)h=e.at(g),a=h.data().code(),a=c.get(a),h.update(a);
this._totalBar.findComponent("total").setLabel(MO.RFloat.unitFormat(b.investmentTotal(),0,0,2,0,1E4,"\u4e07"));this._totalBar.repaint()}};
MO.FEaiChartInvestmentScene_setup=function(){this.__base.FEaiChartScene.setup.call(this);MO.RWindow.lsnsKeyDown.register(this,this.onKeyDown);this._currentDate=new MO.TDate;this._startDate=new MO.TDate;this._endDate=new MO.TDate;this._currentDate.parseAuto("20140701");this._startDate.parseAuto("20140701");this._endDate.parseAuto("20150618");for(var a=document.getElementById("id_investment_table"),b=0;3>b;b++){var c=a.insertRow(a.rows.length),d=c.insertCell(0);c.insertCell(1);c.insertCell(2);switch(b){case 0:c.style.color=
"#FFEA01";d.innerHTML="1 <IMG src='/script/ars/eai/medals/gold.png'/>";break;case 1:c.style.color="#C5D3D6";d.innerHTML="2 <IMG src='/script/ars/eai/medals/silver.png'/>";break;case 2:c.style.color="#E16A00",d.innerHTML="3 <IMG src='/script/ars/eai/medals/copper.png'/>"}}a=this.activeStage().faceLayer();b=this._timeline=MO.RClass.create(MO.FGuiHistoryTimeline);b.setName("Timeline");b.setLeft(50);b.setTop(MO.Eai.Canvas._size.height-400);b.setWidth(MO.Eai.Canvas._size.width-500);b.setHeight(350);b.setTimeUnit(MO.EGuiTimeUnit.Month);
b.setStartTime(this._startDate);b.setEndTime(this._endDate);b.setDegreeTime(this._currentDate);b.addDataChangedListener(this,this.onDateSelect);b.linkGraphicContext(this);b.build();this._desktop.register(b);a.push(b)};MO.FEaiChartInvestmentScene_onDateSelect=function(a){this._currentDate.date.setTime(a.date.date.getTime());this._currentDate.refresh();this.selectDate(this._currentDate.format("YYYYMMDD"))};MO.FEaiChartInvestmentScene_active=function(){this.__base.FEaiChartScene.active.call(this)};
MO.FEaiChartInvestmentScene_process=function(){this.__base.FEaiChartScene.process.call(this);if(this._playing){this._currentDate.addDay(1);var a=this._currentDate.format("YYYYMMDD"),b=this._endDate.format("YYYYMMDD");this.selectDate(a);a==b&&(this._playing=!1)}for(var a=this._citysRenderables,b=a.count(),c=0;c<b;c++)a.at(c).upload();this._citysRangeRenderable.upload()};MO.FEaiChartInvestmentScene_deactive=function(){this.__base.FEaiChartScene.deactive.call(this)};
MO.FEaiChartScene=function(a){a=MO.RClass.inherits(this,a,MO.FEaiScene);a._readyProvince=!1;a._nowDate=null;a._nowTicker=null;a._mapEntity=MO.Class.register(a,new MO.AGetter("_mapEntity"));a._countryData=null;a._countryBorderDisplay=null;a._countryDisplay=null;a._citysRangeRenderable=null;a._citysRenderable=null;a._titleBar=null;a._flagSprite=null;a._groundAutioUrl="/script/ars/eai/ground.mp3";a._groundAutio=null;a.onLoadData=MO.FEaiChartScene_onLoadData;a.onLoadTemplate=MO.FEaiChartScene_onLoadTemplate;
a.construct=MO.FEaiChartScene_construct;a.fixMatrix=MO.FEaiChartScene_fixMatrix;a.setup=MO.FEaiChartScene_setup;a.active=MO.FEaiChartScene_active;a.resetDate=MO.FEaiChartScene_resetDate;a.processResize=MO.FEaiChartScene_processResize;a.process=MO.FEaiChartScene_process;a.deactive=MO.FEaiChartScene_deactive;a.dispose=MO.FEaiChartScene_dispose;return a};
MO.FEaiChartScene_onLoadData=function(a){var b=a.sender;a=this.graphicContext();for(var c=this._countryDisplay,d=this._countryBorderDisplay,e=this._mapEntity,f=MO.Console.find(MO.FEaiResourceConsole).provinceConsole(),g=MO.Console.find(MO.FEaiEntityConsole).provinceConsole(),h=e.provinceEntities(),b=b.provinces(),m=b.count(),l=0;l<m;l++){provinceData=b.at(l);var k=provinceData.name(),k=f.findByName(k),p=MO.Class.create(MO.FEaiProvinceEntity);p.setMapEntity(e);p.setData(provinceData);p.build(a);h.set(k.code(),
p);g.push(p);c.pushRenderable(p.faceRenderable());d.pushRenderable(p.borderRenderable())}this._readyProvince=!0;this._mapEntity.countryEntity().setup(h);this.processResize()};MO.FEaiChartScene_onLoadTemplate=function(a){};MO.FEaiChartScene_construct=function(){this.__base.FEaiScene.construct.call(this);this._nowDate=new MO.TDate;this._nowTicker=new MO.TTicker(1E4);this._mapEntity=MO.Class.create(MO.FEaiMapEntity)};
MO.FEaiChartScene_fixMatrix=function(a){a.tx=-35;a.ty=-12.3;a.tz=0;a.setScale(.32,.36,.32);a.update()};
MO.FEaiChartScene_setup=function(){this.__base.FEaiScene.setup.call(this);var a=this.graphicContext();a.size();var b=this._activeStage=MO.Class.create(MO.FEaiChartStage);b.linkGraphicContext(this);b.region().linkGraphicContext(this);b.region().backgroundColor().set(0,0,0,0);var c=this._countryDisplay=MO.Class.create(MO.FE3dDisplay);this.fixMatrix(c.matrix());b.mapLayer().pushDisplay(c);c=this._countryBorderDisplay=MO.Class.create(MO.FE3dDisplay);this.fixMatrix(c.matrix());b.borderLayer().pushDisplay(c);
c=this._citysRangeRenderable=MO.Class.create(MO.FEaiCitysRangeRenderable);c.linkGraphicContext(this);this.fixMatrix(c.matrix());b.cityRangeLayer().push(c);this._mapEntity.setCitysRangeRenderable(c);var d=this._citysRenderable=MO.Class.create(MO.FEaiCitysRenderable);d.linkGraphicContext(this);this.fixMatrix(d.matrix());b.cityLayer().push(d);this._mapEntity.setCitysRenderable(d);for(var e=MO.Console.find(MO.FEaiResourceConsole).cityConsole(),b=MO.Console.find(MO.FEaiEntityConsole).cityConsole(),f=this._mapEntity.cityEntities(),
e=e.citys(),g=e.count(),h=0;h<g;h++){var m=e.at(h);m.level();m.location();var l=MO.Class.create(MO.FEaiCityEntity);l.setStage(this._activeStage);l.setRenderable(d);l.setData(m);l.build(a);f.set(m.code(),l);d.citys().push(l);c.citys().push(l);b.push(l)}d.setup();d.upload();c.setup();c.upload();a=this._groundAutio=MO.Class.create(MO.FAudio);a.loadUrl(this._groundAutioUrl);a.setVolume(.2);a.play();a=this._countryData=MO.Class.create(MO.FEaiCountryData);a.addLoadListener(this,this.onLoadData);a.load()};
MO.FEaiChartScene_active=function(){this.__base.FEaiScene.active.call(this)};MO.FEaiChartScene_active=function(){this.__base.FEaiScene.active.call(this)};MO.FEaiChartScene_resetDate=function(){};MO.FEaiChartScene_processResize=function(){this.__base.FEaiScene.processResize.call(this);this.fixMatrix(this._countryDisplay.matrix());this.fixMatrix(this._countryBorderDisplay.matrix());this.fixMatrix(this._citysRangeRenderable.matrix());this.fixMatrix(this._citysRenderable.matrix())};
MO.FEaiChartScene_process=function(){this.__base.FEaiScene.process.call(this)};MO.FEaiChartScene_dispose=function(){this._nowDate=RObject.dispose(this._nowDate);this._nowTicker=RObject.dispose(this._nowTicker);this._mapEntity=RObject.dispose(this._mapEntity);this.__base.FEaiScene.dispose.call(this)};
MO.FEaiChartStage=function(a){a=MO.RClass.inherits(this,a,MO.FE3dStage);a._groundLayer=MO.RClass.register(a,new MO.AGetter("_groundLayer"));a._mapLayer=MO.RClass.register(a,new MO.AGetter("_mapLayer"));a._borderLayer=MO.RClass.register(a,new MO.AGetter("_borderLayer"));a._cityRangeLayer=MO.RClass.register(a,new MO.AGetter("_cityRangeLayer"));a._cityLayer=MO.RClass.register(a,new MO.AGetter("_cityLayer"));a._dataLayer=MO.RClass.register(a,new MO.AGetter("_dataLayer"));a._faceLayer=MO.RClass.register(a,
new MO.AGetter("_faceLayer"));a.construct=MO.FEaiChartStage_construct;return a};
MO.FEaiChartStage_construct=function(){this.__base.FE3dStage.construct.call(this);var a=this._groundLayer=MO.RClass.create(MO.FDisplayLayer);this.registerLayer("GroundLayer",a);a=this._mapLayer=MO.RClass.create(MO.FDisplayLayer);a.setOptionClearDepth(!0);this.registerLayer("MapLayer",a);a=this._borderLayer=MO.RClass.create(MO.FDisplayLayer);this.registerLayer("BorderLayer",a);a=this._cityRangeLayer=MO.RClass.create(MO.FDisplayLayer);a.setOptionClearDepth(!0);this.registerLayer("CityRangeLayer",a);
a=this._cityLayer=MO.RClass.create(MO.FDisplayLayer);a.setOptionClearDepth(!0);this.registerLayer("CityLayer",a);a=this._dataLayer=MO.RClass.create(MO.FDisplayLayer);a.setOptionClearDepth(!0);this.registerLayer("DataLayer",a);a=this._faceLayer=MO.RClass.create(MO.FDisplayLayer);a.setOptionClearDepth(!0);this.registerLayer("FaceLayer",a)};
MO.FEaiChartStatisticsScene=function(a){a=MO.RClass.inherits(this,a,MO.FEaiChartScene);a._code=MO.EEaiScene.ChartStatistics;a._investment=MO.Class.register(a,new MO.AGetter("_investment"));a._investmentCurrent=0;a._ready=!1;a._mapReady=!1;a._playing=!1;a._lastTick=0;a._interval=10;a._24HLastTick=0;a._24HTrendInterval=3E5;a._startDate=null;a._endDate=null;a._currentDate=null;a._logoBar=null;a._timeline=null;a._liveTable=null;a._livePop=null;a._statusStart=!1;a._statusLayerCount=150;a._statusLayerLevel=
150;a._groundAutioUrl="/script/ars/eai/music/statistics.mp3";a.onLiveTableChanged=MO.FEaiChartStatisticsScene_onLiveTableChanged;a.testReady=MO.FEaiChartStatisticsScene_testReady;a.setup=MO.FEaiChartStatisticsScene_setup;a.fixMatrix=MO.FEaiChartStatisticsScene_fixMatrix;a.processResize=MO.FEaiChartStatisticsScene_processResize;a.process=MO.FEaiChartStatisticsScene_process;return a};
MO.FEaiChartStatisticsScene_onLiveTableChanged=function(a){var b=this._liveTable;b.setRank(a.rank);b.setData(a.data);b.dirty()};MO.FEaiChartStatisticsScene_testReady=function(){if(!this._ready){if(!this._readyProvince)return!1;this._ready=!0}return this._ready};
MO.FEaiChartStatisticsScene_setup=function(){this.__base.FEaiChartScene.setup.call(this);var a=this._activeStage.dataLayer();this._activeStage.faceLayer();this._currentDate=new MO.TDate;this._startDate=new MO.TDate;this._endDate=new MO.TDate;this._currentDate.parseAuto("20140701");this._startDate.parseAuto("20140701");this._endDate.parseAuto("20150618");var b=this._logoBar=MO.RConsole.find(MO.FGuiFrameConsole).get(this,"eai.chart.LogoBar");b.setLocation(5,5);this._guiManager.register(b);b=this._investment=
MO.Class.create(MO.FEaiStatisticsInvestment);b.linkGraphicContext(this);b.setMapEntity(this._mapEntity);b.setup();b.addDataChangedListener(this,this.onLiveTableChanged);b=b.display();this.fixMatrix(b.matrix());a.push(b);MO.Console.find(MO.FEaiResourceConsole).historyConsole().milestones();this.activeStage();a=this._timeline=MO.Class.create(MO.FGui24HTimeline);a.setName("Timeline");a.linkGraphicContext(this);a.sync();a.build();this._guiManager.register(a);a=this._liveTable=MO.Class.create(MO.FGuiLiveTable);
a.setName("LiveTable");a.linkGraphicContext(this);a.setup();a.build();this._guiManager.register(a);a=this._livePop=MO.Class.create(MO.FGuiLivePop);a.setName("LivePop");a.linkGraphicContext(this);a.setup();a.build();this._guiManager.register(a);this._guiManager.hide()};
MO.FEaiChartStatisticsScene_fixMatrix=function(a){MO.Runtime.isPlatformMobile()?MO.RBrowser.isOrientationVertical()?(a.tx=-14.58,a.ty=-2.2,a.tz=0,a.setScale(.14,.16,.14)):(a.tx=-36.8,a.ty=-11.6,a.tz=0,a.setScale(.3,.33,.3)):(a.tx=-38,a.ty=-13.2,a.tz=0,a.setScale(.32,.36,.32));a.update()};
MO.FEaiChartStatisticsScene_processResize=function(){this.__base.FEaiChartScene.processResize.call(this);this.fixMatrix(this._investment.display().matrix());MO.RBrowser.isOrientationVertical();var a=this._timeline;MO.RBrowser.isOrientationVertical()?(a.setDockCd(MO.EGuiDock.Bottom),a.setAnchorCd(MO.EGuiAnchor.Left|MO.EGuiAnchor.Right),a.setLeft(10),a.setRight(10),a.setBottom(830)):(a.setDockCd(MO.EGuiDock.Bottom),a.setAnchorCd(MO.EGuiAnchor.Left|MO.EGuiAnchor.Right),a.setLeft(20),a.setBottom(30),
MO.Runtime.isPlatformMobile()?a.setRight(680):a.setRight(640));a.setHeight(250);a=this._liveTable;MO.RBrowser.isOrientationVertical()?(a.setDockCd(MO.EGuiDock.Bottom),a.setAnchorCd(MO.EGuiAnchor.Left|MO.EGuiAnchor.Top|MO.EGuiAnchor.Right),a.setLeft(10),a.setRight(10),a.setBottom(10),a.setWidth(1060),a.setHeight(800)):(a.setDockCd(MO.EGuiDock.Right),a.setAnchorCd(MO.EGuiAnchor.Left|MO.EGuiAnchor.Top|MO.EGuiAnchor.Bottom),a.setTop(10),a.setRight(10),a.setBottom(10),MO.Runtime.isPlatformMobile()?a.setWidth(660):
a.setWidth(600))};
MO.FEaiChartStatisticsScene_process=function(){this.__base.FEaiChartScene.process.call(this);if(!this._statusStart&&this.testReady()){var a=document.getElementById("id_loading");a&&(a.style.opacity=this._statusLayerLevel/this._statusLayerCount,this._statusLayerLevel--);this._statusLayerLevel--;0==this._statusLayerLevel&&(a&&document.body.removeChild(a),this._mapEntity.countryEntity().start(),this._statusStart=this._playing=!0)}if(this._playing)if(a=this._mapEntity.countryEntity(),a.introAnimeDone()){this._mapReady||
(this._guiManager.show(),this._mapReady=!0);a=MO.Timer.current();a-this._24HLastTick>this._24HTrendInterval&&(this._timeline.sync(),this._24HLastTick=a);this._investment.process();var a=this._logoBar,b=a.findComponent("investmentDay"),c=this._investment.invementDayCurrent();b.setValue(parseInt(c).toString());a=a.findComponent("investmentTotal");b=this._investment.invementTotalCurrent();a.setValue(parseInt(b).toString());this._nowTicker.process()&&(a=this._logoBar,b=this._nowDate,b.setNow(),a.findComponent("date").setLabel(b.format("YYYY/MM/DD")),
a.findComponent("time").setLabel(b.format("HH24:MI")))}else a.process()};MO.FEaiCompanyScene=function(a){a=MO.RClass.inherits(this,a,MO.FEaiScene);a._code=MO.EEaiScene.Company;return a};MO.FEaiCountryScene=function(a){a=MO.RClass.inherits(this,a,MO.FEaiScene);a._code=MO.EEaiScene.Country;a._countryTemplate=null;a._countryLogoBar=null;a.onTemplateLoad=MO.FEaiCountryScene_onTemplateLoad;a.setup=MO.FEaiCountryScene_setup;a.active=MO.FEaiCountryScene_active;a.deactive=MO.FEaiCountryScene_deactive;return a};
MO.FEaiCountryScene_onTemplateLoad=function(a){a=this._countryTemplate.sprite().matrix();a.tx=-4;a.ty=-3;a.rx=-Math.PI/2;a.updateForce();MO.Eai.Canvas.activeStage()};MO.FEaiCountryScene_setup=function(){this.__base.FEaiScene.setup.call(this);var a=this._countryLogoBar=MO.RConsole.find(MO.FGuiFrameConsole).get(MO.Eai.Canvas,"eai.country.LogoBar");this.registerFrame(a)};MO.FEaiCountryScene_active=function(){this.__base.FEaiScene.active.call(this)};
MO.FEaiCountryScene_deactive=function(){this.__base.FEaiScene.deactive.call(this);MO.Eai.Canvas.activeStage().faceLayer().removeRenderable(this._countryLogoBar.renderable())};MO.FEaiGroupReportScene=function(a){a=MO.RClass.inherits(this,a,MO.FEaiScene);a._code=MO.EEaiScene.GroupReport;return a};MO.FEaiGroupScene=function(a){a=MO.RClass.inherits(this,a,MO.FEaiScene);a._code=MO.EEaiScene.Group;return a};
MO.FEaiScene=function(a){a=MO.Class.inherits(this,a,MO.FScene);a._optionDebug=!1;a._guiManager=MO.Class.register(a,new MO.AGetter("_guiManager"));a._engineInfo=null;a.onOperationResize=MO.FEaiScene_onOperationResize;a.onOperationOrientation=MO.FEaiScene_onOperationOrientation;a.onProcess=MO.FEaiScene_onProcess;a.construct=MO.FEaiScene_construct;a.setup=MO.FEaiScene_setup;a.active=MO.FEaiScene_active;a.deactive=MO.FEaiScene_deactive;a.processResize=MO.FEaiScene_processResize;a.processEvent=MO.FEaiScene_processEvent;
a.dispose=MO.FEaiScene_dispose;return a};MO.FEaiScene_onOperationResize=function(a){this.__base.FScene.onOperationResize.call(this,a);this.processResize()};MO.FEaiScene_onOperationOrientation=function(a){this.__base.FScene.onOperationOrientation.call(this,a);this.processResize()};MO.FEaiScene_onProcess=function(){this.__base.FScene.onProcess.call(this);this._guiManager.process()};MO.FEaiScene_construct=function(){this.__base.FScene.construct.call(this)};
MO.FEaiScene_setup=function(){this.__base.FScene.setup.call(this);var a=this._application.desktop(),b=a.canvas2d(),c=this._guiManager=MO.Class.create(MO.FGuiCanvasManager);c.linkGraphicContext(this);c.setDesktop(a);c.setCanvas(b);c.setup();this._optionDebug&&(a=this._engineInfo=MO.Class.create(MO.FGuiEngineInfo),a.linkGraphicContext(this),a.setContext(this.graphicContext()),a.location().set(10,300),a.build(),c.register(a))};
MO.FEaiScene_active=function(){this.__base.FScene.active.call(this);var a=this._activeStage;this._optionDebug&&this._engineInfo.setStage(a);MO.Eai.Canvas.selectStage(a)};MO.FEaiScene_deactive=function(){this.__base.FScene.deactive.call(this);MO.Eai.Canvas.selectStage(null)};MO.FEaiScene_processResize=function(a){this._guiManager.dirty()};MO.FEaiScene_processEvent=function(a){this.__base.FScene.processEvent.call(this,a);this._guiManager.processEvent(a)};
MO.FEaiScene_dispose=function(){this._guiManager=MO.RObject.dispose(this._guiManager);this.__base.FScene.dispose.call(this)};with(MO)MO.FEaiChapter=function(a){return a=RClass.inherits(this,a,FChapter)};
MO.FEaiChartChapter=function(a){a=MO.RClass.inherits(this,a,MO.FEaiChapter);a._code=MO.EEaiChapter.Chart;a._sceneHistory=MO.Class.register(a,new MO.AGetter("_sceneHistory"));a._sceneStatistics=MO.Class.register(a,new MO.AGetter("_sceneStatistics"));a._sceneIndustry=MO.Class.register(a,new MO.AGetter("_sceneIndustry"));a._sceneInvestment=MO.Class.register(a,new MO.AGetter("_sceneInvestment"));a._sceneCustomer=MO.Class.register(a,new MO.AGetter("_sceneCustomer"));a.construct=MO.FEaiChartChapter_construct;
a.setup=MO.FEaiChartChapter_setup;a.process=MO.FEaiChartChapter_process;a.dispose=MO.FEaiChartChapter_dispose;return a};MO.FEaiChartChapter_construct=function(){this.__base.FEaiChapter.construct.call(this)};
MO.FEaiChartChapter_setup=function(){var a=this._sceneHistory=MO.RClass.create(MO.FEaiChartHistoryScene);a.linkGraphicContext(this);this.registerScene(a);a=this._sceneStatistics=MO.RClass.create(MO.FEaiChartStatisticsScene);a.linkGraphicContext(this);this.registerScene(a);a=this._sceneIndustry=MO.RClass.create(MO.FEaiChartIndustryScene);a.linkGraphicContext(this);this.registerScene(a);a=this._sceneInvestment=MO.RClass.create(MO.FEaiChartInvestmentScene);a.linkGraphicContext(this);this.registerScene(a);
a=this._sceneCustomer=MO.RClass.create(MO.FEaiChartCustomerScene);a.linkGraphicContext(this);this.registerScene(a)};MO.FEaiChartChapter_process=function(){this.__base.FEaiChapter.process.call(this)};MO.FEaiChartChapter_dispose=function(){this.__base.FEaiChapter.dispose.call(this)};MO.FEaiLoadingChapter=function(a){a=MO.RClass.inherits(this,a,MO.FEaiChapter);a._code=MO.EEaiChapter.Loading;return a};
MO.FEaiLoginChapter=function(a){a=MO.RClass.inherits(this,a,MO.FEaiChapter);a._code=MO.EEaiChapter.Login;return a};MO.FEaiSceneChapter=function(a){a=MO.RClass.inherits(this,a,MO.FEaiChapter);a._code=MO.EEaiChapter.Scene;a._sceneCountry=null;a._sceneGroup=null;a._sceneGroupReport=null;a._sceneCompany=null;a.construct=MO.FEaiSceneChapter_construct;a.setup=MO.FEaiSceneChapter_setup;a.process=MO.FEaiSceneChapter_process;a.dispose=MO.FEaiSceneChapter_dispose;return a};MO.FEaiSceneChapter_construct=function(){this.__base.FEaiChapter.construct.call(this)};
MO.FEaiSceneChapter_setup=function(){var a=this._sceneCountry=MO.RClass.create(MO.FEaiCountryScene);a.linkGraphicContext(this);this.registerScene(a);a=this._sceneGroup=MO.RClass.create(MO.FEaiGroupScene);a.linkGraphicContext(this);this.registerScene(a);a=this._sceneGroupReport=MO.RClass.create(MO.FEaiGroupReportScene);a.linkGraphicContext(this);this.registerScene(a);a=this._sceneCompany=MO.RClass.create(MO.FEaiCompanyScene);a.linkGraphicContext(this);this.registerScene(a)};
MO.FEaiSceneChapter_process=function(){this.__base.FEaiChapter.process.call(this)};MO.FEaiSceneChapter_dispose=function(){this.__base.FEaiChapter.dispose.call(this)};MO.FEaiApplication=function(a){a=MO.Class.inherits(this,a,MO.FApplication);a._desktop=MO.Class.register(a,new MO.AGetter("_desktop"));a.setup=MO.FEaiApplication_setup;a.processResize=MO.FEaiApplication_processResize;a.processEvent=MO.FEaiApplication_processEvent;return a};
MO.FEaiApplication_setup=function(a){a=MO.Console.find(MO.FG3dEffectConsole);a.register("general.color.eai.citys",MO.FEaiCityEffect);a.register("general.color.eai.citys.range",MO.FEaiCityRangeEffect)};MO.FEaiApplication_processResize=function(){this.__base.FApplication.processResize.call(this,event);var a=this._desktop;a&&a.resize()};MO.FEaiApplication_processEvent=function(a){this.__base.FApplication.processEvent.call(this,a);var b=this._desktop;b&&b.processEvent(a)};
with(MO)MO.FEaiCanvas=function(a){a=RClass.inherits(this,a,FE3dCanvas);a._scaleRate=1;a._optionAlpha=!1;a._optionAntialias=!1;a._activeStage=RClass.register(a,new AGetter("_activeStage"));a._capturePosition=null;a._captureRotation=null;a.construct=FEaiCanvas_construct;a.resize=FEaiCanvas_resize;a.selectStage=FEaiCanvas_selectStage;a.dispose=FEaiCanvas_dispose;return a},MO.FEaiCanvas_construct=function(){this.__base.FE3dCanvas.construct.call(this);this._rotation=new SVector3;this._capturePosition=
new SPoint2;this._captureRotation=new SVector3},MO.FEaiCanvas_resize=function(a,b){this.__base.FE3dCanvas.resize.call(this,a,b);var c=this._graphicContext.size(),d=this._activeStage;d&&(d=d.camera().projection(),d.size().set(c.width,c.height),d.update())},MO.FEaiCanvas_selectStage=function(a){a.linkGraphicContext(this);a.region().linkGraphicContext(this);a.selectTechnique(this,FE3dGeneralTechnique);var b=a.region().camera(),c=b.projection();c.setAngle(80);c.size().set(this._hCanvas.offsetWidth,this._hCanvas.offsetHeight);
c.update();b.position().set(0,0,-10);b.lookAt(0,0,0);b.update();this._activeStage=a},MO.FEaiCanvas_dispose=function(){this._rotation=RObject.dispose(this._rotation);this.__base.FE3dCanvas.dispose.call(this)};
with(MO)MO.FEaiChartApplication=function(a){a=RClass.inherits(this,a,FEaiApplication);a._sceneCode=RClass.register(a,new AGetSet("_sceneCode"),MO.EEaiScene.ChartHistory);a._chapterLoading=RClass.register(a,new AGetter("_chapterLoading"));a._chapterChart=RClass.register(a,new AGetter("_chapterChart"));a._thread=null;a._interval=10;a.onLoadResource=FEaiChartApplication_onLoadResource;a.construct=FEaiChartApplication_construct;a.createCanvas=FEaiChartApplication_createCanvas;a.setup=FEaiChartApplication_setup;
a.dispose=FEaiChartApplication_dispose;return a},MO.FEaiChartApplication_onLoadResource=function(){this.selectChapterByCode(MO.EEaiChapter.Chart).selectSceneByCode(this._sceneCode)},MO.FEaiChartApplication_construct=function(){this.__base.FEaiApplication.construct.call(this)},MO.FEaiChartApplication_createCanvas=function(){return RClass.create(FEaiChartCanvas)},MO.FEaiChartApplication_setup=function(a){this.__base.FEaiApplication.setup.call(this,a);this._hPanel=a;var b=this._desktop=MO.RClass.create(MO.FEaiChartDesktop);
b.build(a);a=MO.Eai.Canvas=b.canvas3d();this.linkGraphicContext(a);a=this._chapterChart=MO.RClass.create(MO.FEaiChartChapter);a.linkGraphicContext(this);this.registerChapter(a);a=MO.RConsole.find(MO.FEaiResourceConsole);a.addLoadListener(this,this.onLoadResource);if(this._sceneCode==MO.EEaiScene.ChartStatistics)a.load("/chart-live.dat");else if(this._sceneCode==MO.EEaiScene.ChartHistory)a.load("/chart-history.dat");else throw new TError("Scene code is invalid.");this.processResize()},MO.FEaiChartApplication_dispose=
function(){this._chapterLoading=RObject.dispose(this._chapterLoading);this._chapterChart=RObject.dispose(this._chapterChart);this.__base.FEaiApplication.dispose.call(this)};
with(MO)MO.FEaiChartCanvas=function(a){a=RClass.inherits(this,a,FEaiCanvas);a._optionStageProcess=!1;a._optionResize=!1;a._optionMouseCapture=!1;a._optionAlpha=!0;a._optionAntialias=!0;a._capturePosition=null;a._cameraPosition=null;a.construct=FEaiChartCanvas_construct;a.setPanel=FEaiChartCanvas_setPanel;a.dispose=FEaiChartCanvas_dispose;return a},MO.FEaiChartCanvas_construct=function(){this.__base.FEaiCanvas.construct.call(this);this._logicSize=new SSize2(1920,1080);this._cameraPosition=new SPoint3},
MO.FEaiChartCanvas_setPanel=function(a){this._hPanel=a;a.appendChild(this._hCanvas)},MO.FEaiChartCanvas_dispose=function(){this._cameraPosition=RObject.dispose(this._cameraPosition);this.__base.FEaiCanvas.dispose.call(this)};
MO.FEaiChartDesktop=function(a){a=MO.Class.inherits(this,a,MO.FEaiDesktop);a._canvas3d=MO.Class.register(a,new MO.AGetter("_canvas3d"));a._canvas2d=MO.Class.register(a,new MO.AGetter("_canvas2d"));a.onOperationResize=MO.FEaiChartDesktop_onOperationResize;a.onOperationOrientation=MO.FEaiChartDesktop_onOperationOrientation;a.construct=MO.FEaiChartDesktop_construct;a.build=MO.FEaiChartDesktop_build;a.resize=MO.FEaiChartDesktop_resize;a.dispose=MO.FEaiChartDesktop_dispose;return a};
MO.FEaiChartDesktop_onOperationResize=function(a){this.__base.FEaiDesktop.onOperationResize.call(this,a);this.resize()};MO.FEaiChartDesktop_onOperationOrientation=function(){this.__base.FEaiDesktop.onOperationOrientation.call(this,event);this.resize()};MO.FEaiChartDesktop_construct=function(){this.__base.FEaiDesktop.construct.call(this)};
MO.FEaiChartDesktop_build=function(a){this.__base.FEaiDesktop.build.call(this,a);var b=this._canvas3d=MO.RClass.create(MO.FEaiChartCanvas);b.setDesktop(this);b.build(a);b.setPanel(a);this.canvasRegister(b);b=this._canvas2d=MO.RClass.create(MO.FE2dCanvas);b.setDesktop(this);b.build(a);b.setPanel(a);b._hCanvas.style.position="absolute";this.canvasRegister(b);MO.RE3dEngine.setup()};
MO.FEaiChartDesktop_resize=function(a,b){var c=null!=a?a:window.innerWidth,d=null!=b?b:window.innerHeight;if(!this._screenSize.equalsData(c,d)){this._screenSize.set(c,d);var e=MO.Browser.capability().pixelRatio;MO.Logger.info(this,"Change screen size. (size={1}x{2}, pixel_ratio={3})",c,d,e);var c=c*e,d=d*e,f=e=1,g=this._logicSize;MO.Browser.isOrientationHorizontal()?(e=c/g.width,f=d/g.height,this._calculateSize.set(g.width,g.height)):(e=c/g.height,f=d/g.width,this._calculateSize.set(g.height,g.width));
g=this._sizeRate=Math.min(e,f);this._logicRate.set(e,f);e>f?this._calculateRate.set(e/g,1):e<f?this._calculateRate.set(1,f/g):this._calculateRate.set(1,1);this._canvas3d.resize(c,d);e=this._canvas2d;e.resize(c,d);e.context().setScale(g,g)}};MO.FEaiChartDesktop_dispose=function(){this._canvas3d=MO.RObject.dispose(this._canvas3d);this._canvas2d=MO.RObject.dispose(this._canvas2d);this.__base.FEaiDesktop.dispose.call(this)};
MO.FEaiDesktop=function(a){a=MO.Class.inherits(this,a,MO.FDesktop);a.construct=MO.FEaiDesktop_construct;a.dispose=MO.FEaiDesktop_dispose;return a};MO.FEaiDesktop_construct=function(){this.__base.FDesktop.construct.call(this);this._size.set(1920,1080);this._logicSize.set(1920,1080);this._screenSize.set(0,0)};MO.FEaiDesktop_dispose=function(){this.__base.FDesktop.dispose.call(this)};
with(MO)MO.FEaiFlatCanvas=function(a){a=RClass.inherits(this,a,FEaiCanvas);a._capturePosition=null;a._cameraPosition=null;a.onEnterFrame=FEaiFlatCanvas_onEnterFrame;a.onMouseCaptureStart=FEaiFlatCanvas_onMouseCaptureStart;a.onMouseCapture=FEaiFlatCanvas_onMouseCapture;a.onMouseCaptureStop=FEaiFlatCanvas_onMouseCaptureStop;a.construct=FEaiFlatCanvas_construct;a.setPanel=FEaiFlatCanvas_setPanel;a.dispose=FEaiFlatCanvas_dispose;return a},MO.FEaiFlatCanvas_onEnterFrame=function(){var a=this._activeStage;
if(a){var a=a.camera(),b=RKeyboard.isPress(EKeyCode.W),c=RKeyboard.isPress(EKeyCode.S);b&&!c&&a.doMoveY(.5);!b&&c&&a.doMoveY(-.5);b=RKeyboard.isPress(EKeyCode.A);c=RKeyboard.isPress(EKeyCode.D);b&&!c&&a.doMoveX(-.5);!b&&c&&a.doMoveX(.5);a.update()}},MO.FEaiFlatCanvas_onMouseCaptureStart=function(a){var b=this._activeStage;b&&(this._capturePosition.set(a.clientX,a.clientY),this._cameraPosition.assign(b.camera().position()))},MO.FEaiFlatCanvas_onMouseCapture=function(a){var b=this._activeStage;if(b){var c=
a.clientX-this._capturePosition.x;a=a.clientY-this._capturePosition.y;b=b.camera().position();b.x=this._cameraPosition.x-.03*c;b.y=this._cameraPosition.y+.03*a}},MO.FEaiFlatCanvas_onMouseCaptureStop=function(a){},MO.FEaiFlatCanvas_construct=function(){this.__base.FEaiCanvas.construct.call(this);this._logicSize=new SSize2(1920,1080);this._cameraPosition=new SPoint3},MO.FEaiFlatCanvas_setPanel=function(a){this.__base.FEaiCanvas.setPanel.call(this,a)},MO.FEaiFlatCanvas_dispose=function(){this._cameraPosition=
RObject.dispose(this._cameraPosition);this.__base.FEaiCanvas.dispose.call(this)};
with(MO)MO.FEaiPlatformApplication=function(a){a=RClass.inherits(this,a,FEaiApplication);a._chapterLoading=RClass.register(a,new AGetter("_chapterLoading"));a._chapterLogin=RClass.register(a,new AGetter("_chapterLogin"));a._chapterScene=RClass.register(a,new AGetter("_chapterScene"));a._chapterChart=RClass.register(a,new AGetter("_chapterChart"));a._thread=null;a._interval=10;a.onLoadResource=FEaiPlatformApplication_onLoadResource;a.construct=FEaiPlatformApplication_construct;a.createCanvas=FEaiPlatformApplication_createCanvas;
a.setup=FEaiPlatformApplication_setup;a.dispose=FEaiPlatformApplication_dispose;return a},MO.FEaiPlatformApplication_onLoadResource=function(){this.selectChapterByCode(MO.EEaiChapter.Scene).selectSceneByCode(MO.EEaiScene.Country)},MO.FEaiPlatformApplication_construct=function(){this.__base.FEaiApplication.construct.call(this)},MO.FEaiPlatformApplication_createCanvas=function(){return RClass.create(FEaiPlatformCanvas)},MO.FEaiPlatformApplication_setup=function(){var a=this._chapterLoading=MO.RClass.create(MO.FEaiLoadingChapter);
a.linkGraphicContext(this);this.registerChapter(a);a=this._chapterLogin=MO.RClass.create(MO.FEaiLoginChapter);a.linkGraphicContext(this);this.registerChapter(a);a=this._chapterScene=MO.RClass.create(MO.FEaiSceneChapter);a.linkGraphicContext(this);this.registerChapter(a);a=this._chapterChart=MO.RClass.create(MO.FEaiChartChapter);a.linkGraphicContext(this);this.registerChapter(a);a=MO.RConsole.find(MO.FEaiResourceConsole);a.addLoadListener(this,this.onLoadResource);a.load()},MO.FEaiPlatformApplication_dispose=
function(){this.__base.FEaiApplication.dispose.call(this)};
with(MO)MO.FEaiPlatformCanvas=function(a){a=RClass.inherits(this,a,FEaiCanvas);a._capturePosition=null;a._captureRotation=null;a.onEnterFrame=FEaiPlatformCanvas_onEnterFrame;a.onMouseCaptureStart=FEaiPlatformCanvas_onMouseCaptureStart;a.onMouseCapture=FEaiPlatformCanvas_onMouseCapture;a.onMouseCaptureStop=FEaiPlatformCanvas_onMouseCaptureStop;a.construct=FEaiPlatformCanvas_construct;a.dispose=FEaiPlatformCanvas_dispose;return a},MO.FEaiPlatformCanvas_onEnterFrame=function(){var a=this._activeStage;
if(a){var b=a.camera(),c=.05,d=RKeyboard.isPress(EKeyCode.W),e=RKeyboard.isPress(EKeyCode.S);d&&!e&&b.doWalk(.5);!d&&e&&b.doWalk(-.5);d=RKeyboard.isPress(EKeyCode.A);e=RKeyboard.isPress(EKeyCode.D);d&&!e&&b.doYaw(c);!d&&e&&b.doYaw(-c);d=RKeyboard.isPress(EKeyCode.Q);e=RKeyboard.isPress(EKeyCode.E);d&&!e&&b.doFly(.5);!d&&e&&b.doFly(-.5);e=RKeyboard.isPress(EKeyCode.Z);d=RKeyboard.isPress(EKeyCode.X);e&&!d&&b.doPitch(c);!e&&d&&b.doPitch(-c);b.update();if(this._optionRotation){c=this._rotation;a=a.layers();
b=a.count();for(d=0;d<b;d++)e=a.value(d).matrix(),e.setRotation(0,c.y,0),e.update();c.y+=.01}}},MO.FEaiPlatformCanvas_onMouseCaptureStart=function(a){var b=this._activeStage;if(b){var c=this._activeStage.region();RConsole.find(FG3dTechniqueConsole).find(this._graphicContext,FG3dSelectTechnique).test(c,a.offsetX,a.offsetY);this._capturePosition.set(a.clientX,a.clientY);this._captureRotation.assign(b.camera()._rotation)}},MO.FEaiPlatformCanvas_onMouseCapture=function(a){if(this._activeStage){var b=
a.clientX-this._capturePosition.x;a=a.clientY-this._capturePosition.y;var c=this._activeStage.camera().rotation(),d=this._captureRotation;c.x=d.x+.003*a;c.y=d.y+.003*b}},MO.FEaiPlatformCanvas_onMouseCaptureStop=function(a){},MO.FEaiPlatformCanvas_construct=function(){this.__base.FEaiCanvas.construct.call(this)},MO.FEaiPlatformCanvas_dispose=function(){this.__base.FEaiCanvas.dispose.call(this)};MO.Eai.setup=function(a,b){};
