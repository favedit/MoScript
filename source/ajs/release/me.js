var MO=new function(){this.version="0.3.0";this.info={};this.Lang=new function(){return this};this.Stream=new function(){return this};this.Core=new function(){return this};this.Gui=new function(){return this};this.Dui=new function(){return this};return this};MO.initialize=function(){var a=0,b;for(b in this){var d=this[b];d&&d.constructor==Function&&(d.__name=b);a++}this.info.count=a};MO.release=function(){};MO.RSingleton=function(){this._singleton=!0;return this};
MO.TEnum=function(){this.toDisplay=MO.TEnum_toDisplay;this.toValue=MO.TEnum_toValue;return this};MO.TEnum_toDisplay=function(a,b){for(var d in this){var e=this[d];if(e.constructor!=Function&&e==a)return d}return b};MO.TEnum_toValue=function(a,b){var d=a.toLowerCase(),e;for(e in this)if(this[e].constructor!=Function&&e.toLowerCase()==d)return this[e];return b};MO.ELogger=new function(){MO.TEnum.call(this);this.Unknown=0;this.Debug=1;this.Info=2;this.Warn=3;this.Error=4;this.Fatal=5;return this};
MO.EPlatform=new function(){MO.TEnum.call(this);this.Unknown=0;this.Pc=1;this.Mobile=2;return this};MO.EProcess=new function(){MO.TEnum.call(this);this.Unknown=0;this.Debug=1;this.Release=2;return this};MO.RRuntime=function(){var a=MO.RSingleton.call(this);a._processCd=MO.EProcess.Release;a._platformCd=MO.EPlatform.Pc;return a};MO.RRuntime.prototype.isDebug=function(){return this._processCd==MO.EProcess.Debug};MO.RRuntime.prototype.isRelease=function(){return this._processCd==MO.EProcess.Release};
MO.RRuntime.prototype.processCd=function(){return this._processCd};MO.RRuntime.prototype.setProcessCd=function(a){this._processCd=a};MO.RRuntime.prototype.isPlatformPc=function(){return this._platformCd==MO.EPlatform.Pc};MO.RRuntime.prototype.isPlatformMobile=function(){return this._platformCd==MO.EPlatform.Mobile};MO.RRuntime.prototype.platformCd=function(){return this._platformCd};MO.RRuntime.prototype.setPlatformCd=function(a){this._platformCd=a};MO.RRuntime.prototype.empty=function(){};
MO.RRuntime.prototype.nvl=function(a,b){return null!=a?a:b};MO.RRuntime.prototype.subString=function(a,b,d){if(null==a)return a;var e=0;if(null!=b){var f=a.indexOf(b);-1!=f&&(e=f+b.length)}b=a.length;null!=d&&(f=a.indexOf(d,length),-1!=f&&(b=f));return e>=b?"":a.substring(e,b)};MO.RRuntime.prototype.className=function(a){return a&&("function"==typeof a||(a=a.constructor))?this.subString(a.toString(),"function ","("):null};MO.RRuntime.prototype.sortComparerAsc=function(a,b,d){return a>b?1:a<b?-1:0};
MO.RRuntime.prototype.sortComparerDesc=function(a,b,d){return a>b?-1:a<b?1:0};MO.RRuntime.prototype.pairSortMid=function(a,b,d,e,f,h){var k=a[d];if(b)var q=b[d];for(;d<e;){for(;d<e&&0<=f(a[e],k,h);)e--;a[d]=a[e];for(b&&(b[d]=b[e]);d<e&&0>=f(a[d],k,h);)d++;a[e]=a[d];b&&(b[e]=b[d])}a[d]=k;b&&(b[d]=q);return d};MO.RRuntime.prototype.pairSortSub=function(a,b,d,e,f,h){if(d<e){var k=this.pairSortMid(a,b,d,e,f,h);this.pairSortSub(a,b,d,k-1,f,h);this.pairSortSub(a,b,k+1,e,f,h)}};
MO.RRuntime.prototype.pairSort=function(a,b,d,e,f,h){this.pairSortSub(a,b,d,d+e-1,MO.Runtime.nvl(f,this.sortComparerAsc),h)};MO.Runtime=new MO.RRuntime;MO.TAttributes=function(){MO.TDictionary.call(this);this.joinValue=MO.TAttributes_joinValue;this.join=MO.TAttributes_join;this.split=MO.TAttributes_split;this.pack=MO.TAttributes_pack;this.unpack=MO.TAttributes_unpack;this.dump=MO.TAttributes_dump;return this};
MO.TAttributes_joinValue=function(a){for(var b=new MO.TString,d=this._count,e=0;e<d;e++)0<e&&b.append(a),b.append(this._values[e]);return b.flush()};MO.TAttributes_join=function(a,b){var d=new MO.TString;a||(a="=");b||(b=",");for(var e=this._count,f=0;f<e;f++)0<f&&d.append(b),d.append(this._names[f]),d.append(a),d.append(this._values[f]);return d.flush()};
MO.TAttributes_split=function(a,b,d){a=a.split(d);d=a.length;for(var e=0;e<d;e++){var f=a[e];if(f.length){var h=f.split(b);2==h.length?this.set(MO.Lang.String.trim(h[0]),MO.Lang.String.trim(h[1])):this.set(MO.Lang.String.trim(f),"")}}};MO.TAttributes_pack=function(){for(var a=new MO.TString,b=this._count,d=this._names,e=this._values,f=0;f<b;f++){var h=d[f],k=e[f],q=h.length;a.append(q.toString().length,q,h);null!=k?(k+="",h=k.length,a.append(h.toString().length,h,k)):a.append("0")}return a.flush()};
MO.TAttributes_unpack=function(a){for(var b=this.count=0,d=a.length;b<d;){var e=parseInt(a.substr(b++,1)),f=parseInt(a.substr(b,e)),h=a.substr(b+e,f),b=b+(e+f),e=parseInt(a.substr(b++,1)),k=null;0<e&&(f=parseInt(a.substr(b,e)),k=a.substr(b+e,f),b+=e+f);this.set(h,k)}};MO.TAttributes_dump=function(){var a=new MO.TString,b=this._count;a.append(MO.Runtime.className(this)," : ",b);if(0<b){var d=this._names,e=this._values;a.append(" (");for(var f=0;f<b;f++)0<f&&a.append(", "),a.append(d[f],"=",e[f]);a.append(")")}return a.flush()};
MO.TDictionary=function(){MO.TMap.call(this);this.sortByName=MO.TDictionary_sortByName;this.joinName=MO.TDictionary_joinName;this.dump=MO.TDictionary_dump;return this};MO.TDictionary_sortByName=function(a,b){MO.Runtime.pairSort(this._names,this._values,0,this._count,a,b);this.rebuild()};MO.TDictionary_joinName=function(a){for(var b=new MO.TString,d=this._count,e=0;e<d;e++)0<e&&b.append(a),b.append(this._names[e]);return b.flush()};
MO.TDictionary_dump=function(){var a=new MO.TString,b=this._count;a.append(MO.Runtime.className(this),": ",b);if(0<b){var d=this._names,e=this._values;a.append(" {\n");for(var f=0;f<b;f++)a.append("   ",d[f],"=[",e[f],"]\n");a.append("}")}return a.flush()};
MO.TMap=function(){this._count=0;this._table={};this._names=[];this._values=[];this.isEmpty=MO.TMap_isEmpty;this.count=MO.TMap_count;this.contains=MO.TMap_contains;this.containsValue=MO.TMap_containsValue;this.indexOf=MO.TMap_indexOf;this.indexOfValue=MO.TMap_indexOfValue;this.first=MO.TMap_first;this.last=MO.TMap_last;this.nameAt=MO.TMap_nameAt;this.name=MO.TMap_name;this.at=this.valueAt=MO.TMap_valueAt;this.value=MO.TMap_value;this.setValueAt=MO.TMap_setValueAt;this.setValue=MO.TMap_setValue;this.get=
MO.TMap_get;this.set=MO.TMap_set;this.setNvl=MO.TMap_setNvl;this.assign=MO.TMap_assign;this.append=MO.TMap_append;this.insert=MO.TMap_insert;this.remove=MO.TMap_remove;this.removeName=MO.TMap_removeName;this.removeValue=MO.TMap_removeValue;this.rebuild=MO.TMap_rebuild;this.invoke=MO.TMap_invoke;this.clear=MO.TMap_clear;this.toString=MO.TMap_toString;this.dispose=MO.TMap_dispose;return this};MO.TMap_isEmpty=function(){return 0==this._count};MO.TMap_count=function(){return this._count};
MO.TMap_contains=function(a){return null!=a&&null!=this._table[a.toString().toLowerCase()]?!0:!1};MO.TMap_containsValue=function(a){return-1!=this.indexOfValue(a)};MO.TMap_indexOf=function(a){return null!=a&&(a=this._table[a.toString().toLowerCase()],null!=a)?a:-1};MO.TMap_indexOfValue=function(a){var b=this._count;if(0<b)for(var d=this._values,e=0;e<b;e++)if(d[e]==a)return e;return-1};MO.TMap_first=function(){return 0<this._count?this._values[0]:null};
MO.TMap_last=function(){return 0<this._count?this._values[this._count-1]:null};MO.TMap_nameAt=function(a){return this._names[a]};MO.TMap_name=function(a){return 0<=a&&a<this._count?this._names[a]:null};MO.TMap_valueAt=function(a){return this._values[a]};MO.TMap_value=function(a){return 0<=a&&a<this._count?this._values[a]:null};MO.TMap_setValueAt=function(a,b){this._values[a]=b};MO.TMap_setValue=function(a,b){0<=a&&a<this._count&&(this._values[a]=b)};
MO.TMap_get=function(a,b){if(null!=a){var d=this._table[a.toString().toLowerCase()];if(null!=d)return this._values[d]}return b};MO.TMap_set=function(a,b){var d=a.toString(),e=d.toLowerCase(),f=this._table[e];if(null==f||f>=this._count)f=this._count++,this._names[f]=d,this._table[e]=f;this._values[f]=b};MO.TMap_setNvl=function(a,b){b&&this.set(a,b)};MO.TMap_assign=function(a){this.clear();this.append(a)};
MO.TMap_append=function(a){if(a)for(var b=a.count(),d=0;d<b;d++){var e=a.nameAt(d),f=a.valueAt(d);this.set(e,f)}};MO.TMap_insert=function(a,b,d){var e=this._count;if(0<=a&&a<=e){for(var f=this._names,h=this._values;e>a;e--)f[e]=f[e-1],h[e]=h[e-1];f[a]=b;h[a]=d;this._count++;this.rebuild()}};MO.TMap_remove=function(a){var b=null,d=this._count;if(0<=a&&a<d){for(var e=this._names,f=this._values,b=f[a];a<d;a++)e[a]=e[a+1],f[a]=f[a+1];this._count--;this.rebuild()}return b};
MO.TMap_removeName=function(a){a=this.indexOf(a);return-1!=a?this.remove(a):null};MO.TMap_removeValue=function(a){for(var b=0,d=this._count,e=this._names,f=this._values,h=0;h<d;h++){var k=f[h];k!=a&&(b!=h&&(e[b]=e[h],f[b]=k),b++)}this._count=b;this.rebuild()};MO.TMap_rebuild=function(){var a=this._table,b;for(b in a)delete a[b];b=this._count;for(var d=this._names,e=0;e<b;e++){var f=d[e].toLowerCase();a[f]=e}};
MO.TMap_invoke=function(a,b,d,e,f,h){for(var k=this._count,q=this._values,w=0;w<k;w++){var x=q[w];x[a].call(x,b,d,e,f,h)}};MO.TMap_clear=function(){this._count=0;var a=this._table,b;for(b in a)delete a[b]};MO.TMap_toString=function(){return this.dump().toString()};
MO.TMap_dispose=function(a){var b=this._count,d=this._table;if(d){for(var e in d)d[e]=null;this._table=null}if(e=this._names){for(d=0;d<b;d++)e[d]=null;this._names=null}if(e=this._values){for(d=0;d<b;d++)a&&MO.Lang.Object.dispose(e[d]),e[d]=null;this._values=null}this._count=0};
MO.TObjects=function(){this._count=0;this._items=[];this.isEmpty=MO.TObjects_isEmpty;this.count=MO.TObjects_count;this.items=MO.TObjects_items;this.contains=MO.TObjects_contains;this.indexOf=MO.TObjects_indexOf;this.first=MO.TObjects_first;this.last=MO.TObjects_last;this.at=this.getAt=MO.TObjects_getAt;this.get=MO.TObjects_get;this.setAt=MO.TObjects_setAt;this.set=MO.TObjects_set;this.assign=MO.TObjects_assign;this.append=MO.TObjects_append;this.insert=MO.TObjects_insert;this.shift=MO.TObjects_shift;
this.unshift=MO.TObjects_unshift;this.pop=MO.TObjects_pop;this.push=MO.TObjects_push;this.pushUnique=MO.TObjects_pushUnique;this.swap=MO.TObjects_swap;this.sort=MO.TObjects_sort;this.erase=MO.TObjects_erase;this.remove=MO.TObjects_remove;this.invoke=MO.TObjects_invoke;this.clear=MO.TObjects_clear;this.dispose=MO.TObjects_dispose;this.dump=MO.TObjects_dump;return this};MO.TObjects_isEmpty=function(){return 0==this._count};MO.TObjects_count=function(){return this._count};MO.TObjects_items=function(){return this._items};
MO.TObjects_contains=function(a){return-1!=this.indexOf(a)};MO.TObjects_indexOf=function(a){for(var b=this._count,d=this._items,e=0;e<b;e++)if(d[e]==a)return e;return-1};MO.TObjects_first=function(){return this._count?this._items[0]:null};MO.TObjects_last=function(){return this._count?this._items[this._count-1]:null};MO.TObjects_getAt=function(a){return this._items[a]};MO.TObjects_get=function(a){return 0<=a&&a<this._count?this._items[a]:null};MO.TObjects_setAt=function(a,b){this._items[a]=b};
MO.TObjects_set=function(a,b){var d=this._items;0<=a&&a<this._count&&(d[a]=b)};MO.TObjects_assign=function(a){var b=this._items,d=this._count=a.count();a=a.items();for(var e=0;e<d;e++)b[e]=a[e]};MO.TObjects_append=function(a){for(var b=a.count(),d=0;d<b;d++)this.push(a.at(d))};MO.TObjects_insert=function(a,b){var d=this._count,e=this._items;if(0<=a&&a<=d){for(;d>a;d--)e[d]=e[d-1];e[a]=b;this._count++}};MO.TObjects_shift=function(){return this.erase(0)};
MO.TObjects_unshift=function(a){return this.insert(0,a)};MO.TObjects_pop=function(){var a=null;this._count&&(a=this._items[--this._count]);return a};MO.TObjects_push=function(a){var b=this._count++;this._items[b]=a;return b};MO.TObjects_pushUnique=function(a){-1==this.indexOf(a)&&this.push(a)};MO.TObjects_swap=function(a,b){var d=this._count;if(0<=a&&a<d&&0<=b&&b<d&&a!=b){var d=this._items,e=d[a];d[a]=d[b];d[b]=e}};
MO.TObjects_sort=function(a){var b=this._items;b.length!=this._count&&(b.length=this._count);b.sort(a)};MO.TObjects_erase=function(a){var b=null;if(0<=a&&a<this._count){for(var d=this._items,b=d[a],e=--this._count;a<e;a++)d[a]=d[a+1];d[e]=null}return b};MO.TObjects_remove=function(a){var b=this._count;if(b){for(var d=0,e=this._items,f=d;f<b;f++)e[f]!=a&&(e[d++]=e[f]);for(f=d;f<b;f++)e[f]=null;this._count=d}return a};
MO.TObjects_invoke=function(a,b,d,e,f,h){for(var k=this._count,q=this._items,w=0;w<k;w++){var x=q[w];x[a].call(x,b,d,e,f,h)}};MO.TObjects_clear=function(){this._count=0};MO.TObjects_dispose=function(){var a=this._items,b;for(b in a)a[b]=null;this._count=0;this._items=null};MO.TObjects_dump=function(){var a=othis._count,b=new MO.TString;b.append(MO.Runtime.className(this),":",a);if(a)for(var d=0;d<a;d++)b.append(" [",this._items[d],"]");return b.flush()};
MO.TString=function(){this._count=0;this._memory=[];this.isEmpty=MO.TString_isEmpty;this.assign=MO.TString_assign;this.append=MO.TString_append;this.appendIf=MO.TString_appendIf;this.appendArray=MO.TString_appendArray;this.appendLine=MO.TString_appendLine;this.appendRepeat=MO.TString_appendRepeat;this.push=MO.TString_push;this.clear=MO.TString_clear;this.toString=MO.TString_toString;this.flush=MO.TString_flush;this.dispose=MO.TString_dispose;this.dump=MO.TString_dump;return this};
MO.TString_isEmpty=function(){return 0==this._count};MO.TString_assign=function(){this.clear();this.appendArray(arguments,0,arguments.length)};MO.TString_append=function(){this.appendArray(arguments,0,arguments.length)};MO.TString_appendIf=function(a){a&&this.appendArray(arguments,1,arguments.length-1)};MO.TString_appendArray=function(a,b,d){for(var e=this._memory,f=0;f<d;f++){var h=a[b++];null!=h&&(e[this._count++]=h)}};
MO.TString_appendRepeat=function(a,b){for(var d=this._memory,e=0;e<b;e++)d[this._count++]=a};MO.TString_appendLine=function(){this.appendArray(arguments,0,arguments.length);this._memory[this._count++]="\r\n"};MO.TString_push=function(){this.appendArray(arguments,0,arguments.length)};MO.TString_clear=function(){this._count=0};MO.TString_toString=function(){var a=this._memory;a.length!=this._count&&(a=a.slice(0,this._count));return a.join("")};
MO.TString_flush=function(){var a=this.toString();this.dispose();return a};MO.TString_dispose=function(){this._count=0;var a=this._memory;if(a){for(var b=a.length,d=0;d<b;d++)a[d]=null;this._memory=null}};MO.TString_dump=function(){var a=this.toString();return MO.Runtime.className(o)+":"+a.length+"["+a+"]"};MO.RAssert=function(){var a=MO.RSingleton.call(this);a.debugBegin=MO.Runtime.empty;a.debugEnd=MO.Runtime.empty;return a};
MO.RAssert.prototype.isTrue=function(a){if(!a)throw Error("Assert ture failure.");};MO.RAssert.prototype.isFalse=function(a){if(a)throw Error("Assert false failure.");};MO.RAssert.prototype.debug=function(a){return a};MO.RAssert.prototype.debugTrue=function(a){if(!a)throw Error("Assert true failure.");};MO.RAssert.prototype.debugFalse=function(a){if(a)throw Error("Assert false failure.");};MO.RAssert.prototype.debugNull=function(a){if(null!=a)throw Error("Assert null failure.");};
MO.RAssert.prototype.debugNotNull=function(a){if(null==a)throw Error("Assert not null failure.");};MO.RAssert.prototype.debugEmpty=function(a){if(null!=a&&0!=a.length)throw Error("Assert empty failure.");};MO.RAssert.prototype.debugNotEmpty=function(a){if(null==a)throw Error("Assert not empty failure, value is null.");if(0==a.length)throw Error("Assert not empty failure, value length is empty.");};MO.Assert=new MO.RAssert;
MO.EScope=new function(){MO.TEnum.call(this);this.Unknown=0;this.Local=1;this.Session=2;this.Global=3;return this};
MO.TArray=function(a){this._length=MO.Runtime.nvl(a,0);this._memory=[];this.isEmpty=MO.TArray_isEmpty;this.length=MO.TArray_length;this.setLength=MO.TArray_setLength;this.memory=MO.TArray_memory;this.contains=MO.TArray_contains;this.indexOf=MO.TArray_indexOf;this.get=MO.TArray_get;this.set=MO.TArray_set;this.push=MO.TArray_push;this.swap=MO.TArray_swap;this.sort=MO.TArray_sort;this.erase=MO.TArray_erase;this.remove=MO.TArray_remove;this.compress=MO.TArray_compress;this.clear=MO.TArray_clear;this.dispose=
MO.TArray_dispose;this.dump=MO.TArray_dump;return this};MO.TArray_isEmpty=function(){return 0==this._length};MO.TArray_length=function(){return this._length};MO.TArray_setLength=function(a){this._length=a};MO.TArray_memory=function(){return this._memory};MO.TArray_contains=function(a){return-1!=this.indexOf(a)};MO.TArray_indexOf=function(a){for(var b=this._length,d=0;d<b;d++)if(this._memory[d]==a)return d;return-1};MO.TArray_get=function(a){return 0<=a&&a<this._length?this._memory[a]:null};
MO.TArray_set=function(a,b){0<=a&&a<this._length&&(this._memory[a]=b)};MO.TArray_push=function(){for(var a=arguments.length,b=0;b<a;b++)this._memory[this._length++]=arguments[b]};MO.TArray_swap=function(a,b){var d=this._length;if(0<=a&&a<d&&0<=b&&b<d&&a!=b){var d=this._memory,e=d[a];d[a]=d[b];d[b]=e}};MO.TArray_sort=function(){this._memory.sort()};MO.TArray_erase=function(a){var b=null,d=this._count;if(0<=a&&a<d){for(b=this._memory[a];a<d;a++)this._memory[a]=this._memory[a+1];this._length--}return b};
MO.TArray_remove=function(a){for(var b=0,d=this._memory,e=this._length,f=0;f<e;f++)d[f]!=a&&(d[b++]=d[f]);this._length=b};MO.TArray_compress=function(){for(var a=0,b=this._length,d=this._memory,e=0;e<b;e++){var f=d[e];null!=f&&(d[a++]=f)}this._length=a};MO.TArray_clear=function(){this._length=0};MO.TArray_dispose=function(){this._length=0;this._memory=null};
MO.TArray_dump=function(){var a=new MO.TString,b=this._length;a.append(MO.Runtime.className(this),":",b);if(0<b)for(var d=this._memory,e=0;e<b;e++)a.append(" [",d[e],"]");return a.flush()};MO.RMemory=function(){var a=MO.RSingleton.call(this);a._entryUnused=null;a._pools={};return a};MO.RMemory.prototype.entryAlloc=function(){var a=null,b=this._entryUnused;b?(a=b,this._entryUnused=b.next):a=new MO.SMemoryPoolEntry;return a};
MO.RMemory.prototype.entryFree=function(a){a.next=this._entryUnused;this._entryUnused=a};MO.RMemory.prototype.alloc=function(a){var b=MO.Runtime.className(a),d=this._pools,e=d[b];e||(e=new MO.TMemoryPool,e._constructor=a,d[b]=e);return e.alloc()};MO.RMemory.prototype.free=function(a){a.__pool.free(a);a.free&&a.free()};MO.RMemory.prototype.refresh=function(){CollectGarbage()};MO.Memory=new MO.RMemory;
MO.SMemoryPoolEntry=function(){this.value=this.next=null;this.dispose=MO.SMemoryPoolEntry_dispose;return this};MO.SMemoryPoolEntry_dispose=function(){var a=this.value;a&&(a.__pool=null,a.dispose());this.value=this.next=null};MO.TMemoryPool=function(){this._unused=this._constructor=null;this._freeCount=this._allocCount=this._createCount=0;this.alloc=MO.TMemoryPool_alloc;this.free=MO.TMemoryPool_free;this.dispose=MO.TMemoryPool_dispose;this.dump=MO.TMemoryPool_dump;return this};
MO.TMemoryPool_alloc=function(){var a=null,b=this._unused;b?(a=b.value,this._unused=b.next,MO.Memory.entryFree(b)):(a=new this._constructor,a.__pool=this,this._createCount++);this._allocCount++;return a};MO.TMemoryPool_free=function(a){var b=MO.Memory.entryAlloc();b.value=a;b.next=this._unused;this._unused=b;this._freeCount++};MO.TMemoryPool_dispose=function(){for(var a=this._unused;a;){var b=a,a=b.next;b.dispose();MO.Memory.entryFree(b)}};
MO.TMemoryPool_dump=function(){var a=new MO.TString;a.append("Pool:");a.append("create=",this._createCount);a.append(", alloc=",this._allocCount);a.append(", free=",this._freeCount);return a.flush()};MO.SLooperEntry=function(){this.value=this.next=this.prior=null;this.dispose=MO.SLooperEntry_dispose;return this};MO.SLooperEntry_dispose=function(){this.value=this.next=this.prior=null};
MO.TLooper=function(){this._recordCount=this._count=0;this._current=null;this.innerPush=MO.TLooper_innerPush;this.innerRemove=MO.TLooper_innerRemove;this.innerRemoveCurrent=MO.TLooper_innerRemoveCurrent;this.innerRemoveValue=MO.TLooper_innerRemoveValue;this.isEmpty=MO.TLooper_isEmpty;this.count=MO.TLooper_count;this.record=MO.TLooper_record;this.unrecord=MO.TLooper_unrecord;this.contains=MO.TLooper_contains;this.current=MO.TLooper_current;this.next=MO.TLooper_next;this.push=MO.TLooper_push;this.pushUnique=
MO.TLooper_pushUnique;this.removeCurrent=MO.TLooper_removeCurrent;this.remove=MO.TLooper_remove;this.clear=MO.TLooper_clear;this.dispose=MO.TLooper_dispose;this.dump=MO.TLooper_dump;return this};MO.TLooper_innerPush=function(a){var b=this._current;if(b){var d=b.prior;a.prior=d;a.next=b;d.next=a;b.prior=a}else a.prior=a,this._current=a.next=a;this._count++};MO.TLooper_innerRemove=function(a){var b=a.prior,d=a.next;b.next=d;d.prior=b;this._count--;this._current=0<this._count?d:null;MO.Memory.free(a)};
MO.TLooper_innerRemoveCurrent=function(){var a=null;if(0<this._count){var b=this._current,a=b.value;this.innerRemove(b)}return a};MO.TLooper_innerRemoveValue=function(a){if(0<this._count)if(this._current.value==a)this.innerRemoveCurrent();else for(var b=this._current,d=b.next;d!=b;){if(d.value==a){this.innerRemove(d);this._current=b;break}d=d.next}};MO.TLooper_isEmpty=function(){return 0==this._count};MO.TLooper_count=function(){return this._count};MO.TLooper_record=function(){this._recordCount=this._count};
MO.TLooper_unrecord=function(a){this._recordCount=-1};MO.TLooper_contains=function(a){if(this._current)for(var b=this._current,d=this._count,e=0;e<d;e++){if(b.value==a)return!0;b=b.next}return!1};MO.TLooper_current=function(){var a=this._current;return a?a.value:null};MO.TLooper_next=function(){this._current&&(this._current=this._current.next);var a=this._recordCount;if(0<a)this._recordCount--;else if(0==a)return null;return this._current?this._current.value:null};
MO.TLooper_push=function(a){var b=MO.Memory.alloc(MO.SLooperEntry);b.value=a;this.innerPush(b)};MO.TLooper_pushUnique=function(a){this.contains(a)||this.push(a)};MO.TLooper_removeCurrent=function(){return this.innerRemoveCurrent()};MO.TLooper_remove=function(a){this.innerRemoveValue(a)};MO.TLooper_clear=function(){var a=this._current;if(a)for(a.prior.next=null;a;)a=a.next,MO.Memory.free(a);this._count=0;this._current=null};MO.TLooper_dispose=function(){this.clear()};
MO.TLooper_dump=function(){var a=this._count,b=new MO.TString;b.append(MO.Class.name(this),": ",a);if(0<a)for(var d=this._current,e=0;e<a;e++)b.append(" [",d.value,"]"),d=d.next;return b.flush()};MO.RGlobal=function(){var a=MO.RSingleton.call(this);a._instances=new MO.TDictionary;return a};MO.RGlobal.prototype.get=function(a){var b=this;top.MO&&top.MO.Global&&(b=top.MO.Global);return b._instances.get(a)};
MO.RGlobal.prototype.set=function(a,b){var d=this;top.MO&&top.MO.Global&&(d=top.MO.Global);return d._instances.set(a,b)};MO.Global=new MO.RGlobal;
MO.AAnnotation=function(a){this._annotationCd=this._clazz=null;this._ordered=this._duplicate=this._inherit=!1;this._name=a;this.clazz=MO.AAnnotation_clazz;this.annotationCd=MO.AAnnotation_annotationCd;this.isInherit=MO.AAnnotation_isInherit;this.isDuplicate=MO.AAnnotation_isDuplicate;this.isOrdered=MO.AAnnotation_isOrdered;this.name=MO.AAnnotation_name;this.code=MO.AAnnotation_code;this.value=MO.AAnnotation_value;return this};MO.AAnnotation_clazz=function(){return this._clazz};
MO.AAnnotation_annotationCd=function(){return this._annotationCd};MO.AAnnotation_isInherit=function(){return this._inherit};MO.AAnnotation_isDuplicate=function(){return this._duplicate};MO.AAnnotation_isOrdered=function(){return this._ordered};MO.AAnnotation_name=function(){return this._name};MO.AAnnotation_code=function(){return this._name};MO.AAnnotation_value=function(){return null};MO.AGetSet=function(a,b){MO.ASource.call(this,a,MO.ESource.GetSet,b);this.build=MO.AGetSet_build;return this};
MO.AGetSet_build=function(a,b){var d=this._code;b[d]=MO.Method.makePropertyGet(this._name,d);d="set"+this._linker;b[d]=MO.Method.makePropertySet(this._name,d)};MO.AGetter=function(a,b){MO.ASource.call(this,a,MO.ESource.Get,b);this._linker=b;this.build=MO.AGetter_build;return this};MO.AGetter_build=function(a,b){var d=this._linker?this._linker:this._code;b[d]=MO.Method.makePropertyGet(this._name,d)};MO.ASetter=function(a,b){MO.ASource.call(this,a,MO.ESource.Set,b);this.build=MO.ASetter_build;return this};
MO.ASetter_build=function(a,b){var d="set"+this._linker;b[d]=MO.Method.makePropertySet(this._name,d)};MO.ASource=function(a,b,d){MO.AAnnotation.call(this,a);this._inherit=!1;this._annotationCd=MO.EAnnotation.Source;this._typeCd=b;this._linker=this._code=null;this.build=MO.ASource_build;this.toString=MO.ASource_toString;a=this._name;MO.Lang.String.startsWith(a,"_")&&(a=a.substring(1));this._code=a;this._linker=null==d?MO.Lang.String.firstUpper(a):d;return this};MO.ASource_build=function(){};
MO.ASource_toString=function(){return"<"+this._annotationCd+",linker="+this._linker+">"};MO.AVirtual=function(a,b){MO.ASource.call(this,a,MO.ESource.Virtual,b);this.build=MO.AVirtual_build;return this};MO.AVirtual_build=function(a,b){b[this._name]=MO.Method.makeVirtual(this._clazz,this._name)};
MO.EAnnotation=new function(){this.Constructor="constructor";this.Dispose="dispose";this.Source="source";this.Property="property";this.Persistence="persistence";this.Event="enum";this.Event="event";this.Linker="linker";this.Style="style";this.StyleIcon="icon";return this};
MO.EDataType=new function(){this.Unknown=0;this.Int8=this.Boolean=1;this.Int16=2;this.Int32=3;this.Int64=4;this.Uint8=5;this.Uint16=6;this.Uint32=7;this.Uint64=8;this.Float16=9;this.Float32=this.Float=10;this.Float64=this.Double=11;this.String=12;this.Struct=13;this.Object=14;this.Array=15;this.Objects=16;this.Dictionary=17;return this};MO.EEndian=new function(){this.Big=0;this.Little=1;return this};
MO.ESource=new function(){this.Virtual="virtual";this.Get="get";this.Set="set";this.GetSet="getset";this.Listener="listener";return this};MO.SLogger=function(){this.message=null;return this};
MO.TClass=function(){this.__disposed=!0;this._abstract=!1;this._annotations={};this._attributes={};this._styles=[];this._instance=this._parent=this._clazz=this._base=null;this._pool=new MO.TMemoryPool;this.name=null;this.register=MO.TClass_register;this.assign=MO.TClass_assign;this.annotations=MO.TClass_annotations;this.annotation=MO.TClass_annotation;this.annotationFind=MO.TClass_annotationFind;this.attributeFind=MO.TClass_attributeFind;this.style=MO.TClass_style;this.build=MO.TClass_build;this.newInstance=
MO.TClass_newInstance;this.free=MO.TClass_free;this.alloc=MO.TClass_alloc;return this};
MO.TClass_register=function(a){a._clazz=this;var b=a.annotationCd(),d=a.isOrdered(),e=a.name(),f=a.code();if(!b||!f)throw new MO.TError(this,"Unknown annotation. (class={1}, annotation={2}, name={3}, code={4})",MO.Class.dump(this),a,e,f);var h=this._annotations[b];h||(h=d?new MO.TObjects:{},this._annotations[b]=h);if(!a._duplicate&&h[f])throw new MO.TError(this,"Duplicate annotation. (class={1}, annotation={2}, name={3}, code={4}, value={5})",MO.Class.dump(this),a,e,f,a.toString());d?h.push(a):h[f]=
a;this._attributes[e]=a};
MO.TClass_assign=function(a){for(var b in a._annotations){var d=a._annotations[b],e=this._annotations[b];e||(e=this._annotations[b]=new d.constructor);if(d.constructor==MO.TObjects)e.append(d);else for(var f in d){var h=d[f];if(!h.isDuplicate()&&e[f])throw new MO.TError(this,"Duplicate annotation. (annotation={1}, {2}.{3}={4}.{5}, source={6})",b,this.name,f,a.name,f,h.toString());h._inherit&&(e[f]=h)}}for(f in a._attributes)a._attributes[f].construct!=Function&&(this._attributes[f]=a._attributes[f])};
MO.TClass_annotations=function(a){var b=this._annotations[a];b||MO.Logger.fatal(this,null,"Can't find annotations. (annotation_cd={1}, class={2})",a,this.name);return b};MO.TClass_annotation=function(a,b){var d=null,e=this._annotations[a];e&&(d=e[b]);d||MO.Logger.fatal(this,null,"Can't find annotation. (annotation_cd={1}, name={2}, class={3})",a,b,this.name);return d};
MO.TClass_annotationFind=function(a){for(var b in this._annotations){var d=this._annotations[b];if(d&&(d=d[a],null!=d&&d.constructor!=Function))return d}return null};MO.TClass_attributeFind=function(a){return(a=this._attributes[a])&&a.constructor!=Function?a:null};
MO.TClass_style=function(a){var b=this._styles;if(b[a])return b[a];for(var d=null,e=this;e;){var f=e._annotations[MO.EAnnotation.Style];if(f&&(d=f[a]))break;e=e._parent}d||MO.Logger.fatal(this,null,"No register style annotation. (class={1}, name={2})",this.name,this.name+"_"+a);d=e.name+"_"+d.style();return b[a]=d};
MO.TClass_build=function(){var a=this._instance,b;for(b in a){var d=a[b];if(null!=d&&d.constructor==Function&&d.__virtual){this._abstract=!0;break}}if(d=this._annotations[MO.EAnnotation.Property])for(b in d)d[b].build(a);if(d=this._annotations[MO.EAnnotation.Source])for(b in d)d[b].build(this,a)};
MO.TClass_newInstance=function(){var a=null;if(this._abstract){var a=new MO.TString,b;for(b in this._instance){var d=this._instance[b];MO.Method.isVirtual(d)&&(a.isEmpty()||a.append(","),a.append(d._name))}throw new MO.TError(this,"Abstract Class can't be create.(name={1})\n[{2}]",this.name,a);}var e=this._instance;if(!e)return MO.Logger.fatal(this,null,"Class instance is empty. (name={1})",this.name);a=new e.constructor;for(b in e){d=e[b];if(null!=d){if("__base"==b||"__inherits"==b){a[b]=e[b];continue}MO.Class.isBase(d)||
(d=MO.Lang.Object.clone(d))}a[b]=d}a.__class=this;a.construct&&a.construct();return a};MO.TClass_alloc=function(){return this._pool.alloc()};MO.TClass_free=function(a){this._pool.free(a)};MO.TClassBase=function(){this.__disposed=!0;return this};
MO.TDate=function(a){this.date=a?a:new Date;this.ms=this.second=this.minute=this.hour=this.day=this.month=this.year=null;this.equals=MO.TDate_equals;this.isBefore=MO.TDate_isBefore;this.isAfter=MO.TDate_isAfter;this.monthDays=MO.TDate_monthDays;this.monthWeekDay=MO.TDate_monthWeekDay;this.weekDay=MO.TDate_weekDay;this.totalSecond=MO.TDate_totalSecond;this.daySecond=MO.TDate_daySecond;this.assign=MO.TDate_assign;this.refresh=MO.TDate_refresh;this.setYear=MO.TDate_setYear;this.setMonth=MO.TDate_setMonth;
this.setDay=MO.TDate_setDay;this.setHour=MO.TDate_setHour;this.setMinute=MO.TDate_setMinute;this.setSecond=MO.TDate_setSecond;this.setDate=MO.TDate_setDate;this.setNow=MO.TDate_setNow;this.addYear=MO.TDate_addYear;this.addMonth=MO.TDate_addMonth;this.addDay=MO.TDate_addDay;this.addHour=MO.TDate_addHour;this.addMinute=MO.TDate_addMinute;this.addSecond=MO.TDate_addSecond;this.add=MO.TDate_add;this.truncDay=MO.TDate_truncDay;this.truncHour=MO.TDate_truncHour;this.truncMinute=MO.TDate_truncMinute;this.truncSecond=
MO.TDate_truncSecond;this.trunc=MO.TDate_trunc;this.get=MO.TDate_get;this.set=MO.TDate_set;this.parse=MO.TDate_parse;this.parseAuto=MO.TDate_parseAuto;this.format=MO.TDate_format;this.clone=MO.TDate_clone;this.dump=MO.TDate_dump;this.refresh();return this};MO.TDate_equals=function(a){return this.date.getTime()==a.date.getTime()};MO.TDate_isBefore=function(a){return this.date.getTime()<a.date.getTime()};MO.TDate_isAfter=function(a){return this.date.getTime()>a.date.getTime()};
MO.TDate_monthDays=function(){return RDate.monthDays(this.year,this.month)};MO.TDate_monthWeekDay=function(){return(8-(this.day-this.weekDay())%7)%7};MO.TDate_assign=function(a){this.date.setTime(a.date.getTime());this.refresh()};MO.TDate_refresh=function(){var a=this.date;a&&(this.year=a.getFullYear(),this.month=a.getMonth()+1,this.day=a.getDate(),this.hour=a.getHours(),this.minute=a.getMinutes(),this.second=a.getSeconds(),this.ms=a.getMilliseconds())};MO.TDate_weekDay=function(){return this.date.getDay()};
MO.TDate_totalSecond=function(){return parseInt(this.date.getTime()/1E3)};MO.TDate_daySecond=function(){return 3600*this.hour+60*this.minute+this.second};MO.TDate_setYear=function(a){this.date.setFullYear(a);this.refresh()};MO.TDate_setMonth=function(a){this.date.setMonth(parseInt(a,10)-1);this.refresh()};MO.TDate_setDay=function(a){this.date.setDate(a);this.refresh()};MO.TDate_setHour=function(a){this.date.setHours(a);this.refresh()};MO.TDate_setMinute=function(a){this.date.setMinutes(a);this.refresh()};
MO.TDate_setSecond=function(a){this.date.setSeconds(a);this.refresh()};MO.TDate_setDate=function(a){this.date=a;this.refresh()};MO.TDate_setNow=function(){this.date=new Date;this.refresh()};MO.TDate_addYear=function(a){var b=this.date.getFullYear();this.date.setFullYear(b+MO.Lang.Integer.nvl(a,1));this.refresh()};MO.TDate_addMonth=function(a){var b=this.date.getMonth();this.date.setMonth(b+MO.Lang.Integer.nvl(a,1));this.refresh()};
MO.TDate_addDay=function(a){a=this.date.getTime()+864E5*MO.Lang.Integer.nvl(a,1);this.date.setTime(a);this.refresh()};MO.TDate_addHour=function(a){a=this.date.getTime()+36E5*MO.Lang.Integer.nvl(a,1);this.date.setTime(a);this.refresh()};MO.TDate_addMinute=function(a){a=this.date.getTime()+6E4*MO.Lang.Integer.nvl(a,1);this.date.setTime(a);this.refresh()};MO.TDate_addSecond=function(a){a=this.date.getTime()+1E3*MO.Lang.Integer.nvl(a,1);this.date.setTime(a);this.refresh()};
MO.TDate_add=function(a){a=this.date.getTime()+MO.Lang.Integer.nvl(a,1);this.date.setTime(a);this.refresh()};MO.TDate_truncDay=function(a){var b=this.date.getTime();a=b-b%(864E5*MO.Lang.Integer.nvl(a,1));this.date.setTime(a);this.refresh()};MO.TDate_truncHour=function(a){var b=this.date.getTime();a=b-b%(36E5*MO.Lang.Integer.nvl(a,1));this.date.setTime(a);this.refresh()};MO.TDate_truncMinute=function(a){var b=this.date.getTime();a=b-b%(6E4*MO.Lang.Integer.nvl(a,1));this.date.setTime(a);this.refresh()};
MO.TDate_truncSecond=function(a){var b=this.date.getTime();a=b-b%(1E3*MO.Lang.Integer.nvl(a,1));this.date.setTime(a);this.refresh()};MO.TDate_trunc=function(a){var b=this.date.getTime();a=b-b%MO.Lang.Integer.nvl(a,1);this.date.setTime(a);this.refresh()};MO.TDate_get=function(a){return this.date.getTime()};MO.TDate_set=function(a){this.date.setTime(a);this.refresh()};MO.TDate_parse=function(a,b){return MO.Lang.Date.parse(this,a,b)};
MO.TDate_parseAuto=function(a){return MO.Lang.Date.autoParse(this,a)};MO.TDate_format=function(a){return MO.Lang.Date.formatDate(this,a)};MO.TDate_clone=function(){var a=new Date;a.setTime(this.date.getTime());return new MO.TDate(a)};MO.TDate_dump=function(){return MO.Class.dump(this)+" "+MO.Lang.Date.formatDate(this)};
MO.TError=function(a,b,d){for(var e=new MO.TString,f=MO.TError.caller,h=new MO.TString,k=[];f&&!MO.Lang.Array.contains(k,f);)k.push(f),f=f.caller;for(var q=k.length,w=0;w<q;w++)f=k[w],0<w&&h.appendLine(),h.append("   "+(q-w)+": "+MO.Method.name(f));f=arguments;q=f.length;for(w=2;w<q;w++){var k=f[w],x=null,x="function"==typeof k?MO.Method.name(k):k;b=b.replace("{"+(w-1)+"}",x)}e.appendLine(b);e.appendLine("------------------------------------------------------------");e.append(h);e=e.flush();alert(e)};
MO.TListener=function(){this._callback=this._owner=null;this.process=MO.TListener_process;this.toString=MO.TListener_toString;this.dispose=MO.TListener_dispose;return this};MO.TListener_process=function(a,b,d,e,f,h){this._callback.call(this._owner?this._owner:this,a,b,d,e,f,h)};MO.TListener_toString=function(){return MO.Class.name(this)+"(owner="+MO.Class.name(this._owner)+", callback="+MO.Method.name(this._callback)+")"};MO.TListener_dispose=function(){this._callback=this._owner=null;MO.Lang.Object.free(this)};
MO.TListeners=function(){this._listeners=null;this.isEmpty=MO.TListeners_isEmpty;this.find=MO.TListeners_find;this.register=MO.TListeners_register;this.unregister=MO.TListeners_unregister;this.push=MO.TListeners_push;this.remove=MO.TListeners_remove;this.process=MO.TListeners_process;this.clear=MO.TListeners_clear;this.dispose=MO.TListeners_dispose;this.dump=MO.TListeners_dump;return this};MO.TListeners_isEmpty=function(){var a=this._listeners;return a?a.isEmpty():!0};
MO.TListeners_find=function(a,b){var d=this._listeners;if(d)for(var e=d.count(),f=0;f<e;f++){var h=d.at(f);if(h._owner==a&&h._callback==b)return h}return null};MO.TListeners_register=function(a,b){var d=this.find(a,b);if(d)throw new MO.TError(this,"Listener is already register. (owner={1}, process={2})",a,b);d=new MO.TListener;d._owner=a;d._callback=b;this.push(d);return d};
MO.TListeners_unregister=function(a,b){var d=this.find(a,b);if(!d)throw new MO.TError(this,"Listener is not register. (owner={1}, process={2})",a,b);this.remove(d);d.dispose()};MO.TListeners_push=function(a){if(!a)throw new MO.TError(this,"Listener is null.");if(!a._callback)throw new MO.TError(this,"Listener process is null.");var b=this._listeners;b||(b=this._listeners=new MO.TObjects);b.push(a)};MO.TListeners_remove=function(a){if(!a)throw new MO.TError(this,"Listener is null.");this._listeners.remove(a)};
MO.TListeners_process=function(a,b,d,e,f,h){var k=this._listeners;if(k)for(var q=k.count(),w=0;w<q;w++)k.at(w).process(a,b,d,e,f,h)};MO.TListeners_clear=function(){var a=this._listeners;a&&a.clear()};MO.TListeners_dispose=function(){var a=this._listeners;if(a){for(var b=a.count()-1;0<=b;b--)a.at(b).dispose();this._listeners=MO.Lang.Object.dispose(a)}MO.Lang.Object.free(this)};
MO.TListeners_dump=function(){var a=new MO.TString;a.append(MO.Class.name(this));for(var b=this._listeners,d=b.count(),e=0;e<d;e++)a.append("\n   "+b.at(e));return a.flush()};MO.FObject=function(a){a||(a=this);a.__class=null;a.__dispose=!1;a.__hash=0;a.construct=MO.FObject_construct;a.hashCode=MO.FObject_hashCode;a.toString=MO.FObject_toString;a.dispose=MO.FObject_dispose;a.innerDump=MO.FObject_innerDump;a.dump=MO.FObject_dump;return a};MO.FObject_construct=function(){this.__dispose=!1};
MO.FObject_hashCode=function(){var a=this.__hash;a||(a=this.__hash=MO.RObject.nextId());return a};MO.FObject_toString=function(){return MO.Class.dump(this)};MO.FObject_dispose=function(){MO.Lang.Object.free(this);this.__dispose=!0};MO.FObject_innerDump=function(a,b){a.append(MO.Class.dump(this))};MO.FObject_dump=function(){var a=new MO.TString;this.innerDump(a,0);return a.flush()};MO.RClass=function(){this._codes=[];this._classes={};return this};
MO.RClass.prototype.isBase=function(a){return null!=a?MO.Class.isBaseName(typeof a):!1};MO.RClass.prototype.isBaseName=function(a){return null==a||"boolean"!=a&&"number"!=a&&"date"!=a&&"string"!=a&&"function"!=a?!1:!0};MO.RClass.prototype.isBaseDataName=function(a){return null==a||"boolean"!=a&&"number"!=a&&"date"!=a&&"string"!=a?!1:!0};MO.RClass.prototype.isBaseType=function(a){return null==a||a!=Boolean&&a!=Number&&a!=Date&&a!=String&&a!=Function?!1:!0};
MO.RClass.prototype.isBaseDataType=function(a){return null==a||a!=Boolean&&a!=Number&&a!=Date&&a!=String?!1:!0};MO.RClass.prototype.isName=function(a,b){return this.name(a)==b};MO.RClass.prototype.isClass=function(a,b){if(a){var d=this.name(b);return a.__base?null!=a.__base[d]:this.name(a)==d}return!1};MO.RClass.prototype.typeOf=function(a){return a&&a.constructor?MO.Lang.String.mid(a.constructor.toString(),"function ","("):"Null"};
MO.RClass.prototype.safeTypeOf=function(a,b){if(null==a)return"Null";try{var d=a.constructor;if(d==Boolean)return"Boolean";if(d==Number)return"Number";if(d==String)return"String";if(d==Function||d.constructor==Function)return MO.Lang.String.mid(d.toString(),"function ","(");if(a.__class)return a.__class.name;if(a.tagName)return"Html";for(var e in a)return"Object"}catch(f){}return"Unknown"};
MO.RClass.prototype.checkClass=function(a,b){if(!this.isClass(a,b))throw Error("Invalid class "+o.name(o)+"<>"+o.name(b));};MO.RClass.prototype.code=function(a){for(var b=this._codes,d=b.length,e=0;e<d;e++)if(b[e]==a)return e;b[d]=a;return d};MO.RClass.prototype.name=function(a){if(a){if(a.__name)return a.__name;if(a.__class)return a.__class.name;if("function"==typeof a)return MO.Method.name(a);if(a=a.constructor)return MO.Lang.String.mid(a.toString(),"function ","(")}return null};
MO.RClass.prototype.inherits=function(a,b){var d=MO.Runtime.nvl(b,a);d.__inherits=[];for(var e=arguments.length,f=2;f<e;f++)d.__inherits.push(MO.Method.name(arguments[f]));return d};MO.RClass.prototype.forName=function(a){var b=null;a&&(b=this._classes[a],b||(b=this.createClass(a),this.build(b)));return b};
MO.RClass.prototype.find=function(a){var b=null;null!=a&&(a.__class?b=a.__class.name:a.constructor==Function?b=MO.Method.name(a):a.constructor!=String&&MO.Logger.fatal(this,null,"Find class failure. (value={1})",a));return this._classes[b]};MO.RClass.prototype.register=function(a,b,d){a=MO.Method.name(a.constructor);a=this._classes[a];var e=null;if(b.constructor==Array)for(var f=b.length,h=0;h<f;h++)e=b[h],a.register(e);else e=b,a.register(e);b=e.value();return null!=d?d:b};
MO.RClass.prototype.createBase=function(a){var b=null;a&&(b=eval("function "+a+"(){return this;} new "+a+"();"));return b};MO.RClass.prototype.createClass=function(a){var b=this._classes[a]=new MO.TClass;b.name=a;b._base=this.createBase(a);b._clazz=new b._base.constructor;eval("MO."+a)(b._clazz);return b};MO.RClass.prototype.create=function(a){var b=null,b=typeof a;if("function"==b)b=MO.Method.name(a);else if("string"==b)b=a;else throw new MO.TError(this,"Param is invlid (clazz={1})",a);return this.createByName(b)};
MO.RClass.prototype.createByName=function(a){a=this.forName(a);if(!a)throw new MO.TError(this,"Cant find class. (name={1})",a);return a.newInstance()};
MO.RClass.prototype.innerCopy=function(a,b){if(null!=a&&null!=b)for(var d in a){var e=a[d];if(null!=e){var f=typeof e;if("function"==f){f=b[d];null==f?b[d]=e:MO.Method.isVirtual(f)?b[d]=e:!MO.Method.isVirtual(e)&&MO.Method.isEmpty(f)?b[d]=e:MO.Method.isVirtual(e)||MO.Method.isEmpty(e)||(b[d]=e);continue}else if(!MO.Class.isBaseName(f)){null==b[d]&&(b[d]=new e.constructor);this.innerCopy(e,b[d]);continue}}b[d]=e}};
MO.RClass.prototype.build=function(a){var b=a._clazz.__inherits;if(b&&b.constructor==Array)for(var d=!1,e=b.length,f=0;f<e;f++){var h=b[f];MO.Lang.String.startsWith(h,"F")&&(d&&MO.Logger.fatal(this,null,"Parent class is too many. (name={1})",h),a._parent=MO.Class.forName(h),d=!0)}d=a._instance=new a._base.constructor;if(b&&b.constructor==Array)for(e=b.length,f=0;f<e;f++)if(h=b[f],!MO.Lang.String.startsWith(h,"F")){var k=MO.Class.forName(h);null==k&&MO.Logger.fatal(this,null,"Parent class is not exists. (name={1})",
h);MO.Class.innerCopy(k._instance,d);a.assign(k)}a._parent&&(this.innerCopy(a._parent._instance,d),a.assign(a._parent));d.__base||(d.__base=new MO.TClassBase);d.__base[a.name]=new a._base.constructor;e=a._clazz;for(h in e)"__base"!=h&&(null==e[h]&&null==d[h]?d[h]=null:null!=e[h]&&(null==d[h]||null!=d[h]&&e[h]!=d[h])&&(d[h]=e[h]));if(b&&b.constructor==Array)for(e=b.length,f=0;f<e;f++){var h=b[f],q=MO.Class.forName(h),k=d.__base[h]=new q._base.constructor,q=q._instance;for(h in q)if("__base"!=h){var w=
q[h],x=d[h];null!=w&&null!=x&&w!=x&&w.constructor==Function&&x.constructor==Function&&(k[h]=q[h])}}a.build();if(MO.Runtime.isRelease())for(h in d=a._instance,d)null==d[h]&&delete a._instance[h]};MO.RClass.prototype.free=function(a){a.__class.free(a)};
MO.RClass.prototype.dump=function(a){if(null==a)return"@null";var b=this.safeTypeOf(a);switch(b){case "Boolean":return"Boolean:"+a;case "Number":return"Number:"+a;case "String":return b+"<"+a.length+">:"+a;case "Function":return b+"<"+MO.Method.name(a)+">@"+this.code(a);case "Html":return b+"<"+a.tagName+">@"+this.code(a);default:if(a.__name)return b+"<"+a.__name+">@"+this.code(a)}return b+"@"+this.code(a)};MO.RClass=new MO.RClass;MO.Class=MO.RClass;
MO.RDate=function(){this.MinYear=1800;this.MaxYear=2400;this.Pattern="n-: /";this.Chars="0123456789-:/";this.DisplayFormat="yyyy-mm-dd hh24:mi:ss";this.DataFormat="yyyymmddhh24miss";this.MonthDays=[0,31,28,31,30,31,30,31,31,30,31,30,31];this.Parts="YYYY MM DD HH24 MI SS".split(" ");this.PartsDefine={YYYY:["Year",4],MM:["Month",2],DD:["Day",2],HH24:["Hour",2],MI:["Minute",2],SS:["Second",2]};return this};MO.RDate.prototype.nvl=function(a){return a?a:new MO.TDate};
MO.RDate.prototype.format=function(a){return this.formatDate(new MO.TDate,a)};MO.RDate.prototype.formatText=function(a,b){if(!a)return!1;var d=b.toLowerCase(),d=d.replace(/yyyy/g,a.substring(0,4));a=a.substring(4);d=d.replace(/mm/g,a.substring(0,2));a=a.substring(2);d=d.replace(/dd/g,a.substring(0,2));a=a.substring(2);d=d.replace(/hh24/g,a.substring(0,4));a=a.substring(4);d=d.replace(/mi/g,a.substring(0,2));a=a.substring(2);d=d.replace(/ss/g,a.substring(0,2));a.substring(2);return d};
MO.RDate.prototype.formatDate=function(a,b){if(!a)return"";var d=b?b.toLowerCase():this.DataFormat,d=d.replace(/yyyy/g,MO.Lang.Integer.format(a.year,4)),d=d.replace(/yy/g,MO.Lang.Integer.format(a.year%100,2)),d=d.replace(/mm/g,MO.Lang.Integer.format(a.month,2)),d=d.replace(/dd/g,MO.Lang.Integer.format(a.day,2)),d=d.replace(/hh24/g,MO.Lang.Integer.format(a.hour,2)),d=d.replace(/mi/g,MO.Lang.Integer.format(a.minute,2)),d=d.replace(/ss/g,MO.Lang.Integer.format(a.second,2));return d=d.replace(/ms/g,MO.Lang.Integer.format(a.ms,
3))};MO.RDate.prototype.monthDays=function(a,b){if(!a||!b)return 0;a=parseInt(a);b=parseInt(b);this.MonthDays[2]=0!=a%4&&0!=a%400||0==a%100?28:29;return this.MonthDays[b]};
MO.RDate.prototype.splitFormat=function(a,b){if(!a)return!1;b=b.toLowerCase();for(var d=[];0<b.length;)0==b.indexOf("yyyy")?(d.year=a.substring(0,4),b=b.substring(4),a=a.substring(4)):0==b.indexOf("mm")?(d.month=a.substring(0,2),b=b.substring(2),a=a.substring(2)):0==b.indexOf("dd")?(d.day=a.substring(0,2),b=b.substring(2),a=a.substring(2)):0==b.indexOf("hh24")?(d.hour=a.substring(0,2),b=b.substring(4),a=a.substring(2)):0==b.indexOf("mi")?(d.minute=a.substring(0,2),b=b.substring(2),a=a.substring(2)):
0==b.indexOf("ss")?(d.second=a.substring(0,2),b=b.substring(2),a=a.substring(2)):0==b.indexOf("ms")?(d.ms=a.substring(0,2),b=b.substring(2),a=a.substring(3)):(b=b.substring(1),a=a.substring(1));return d};
MO.RDate.prototype.splitTime=function(a,b){if(b)if(-1!=b.indexOf(":")){var d=b.split(":");1<=d.length&&(a.hour=MO.Lang.Integer.parse(d[0]));2<=d.length&&(a.minute=MO.Lang.Integer.parse(d[1]));3<=d.length&&(a.second=MO.Lang.Integer.parse(d[2]))}else 6==b.length?(a.hour=MO.Lang.Integer.parse(b.substr(0,2)),a.minute=MO.Lang.Integer.parse(b.substr(2,2)),a.second=MO.Lang.Integer.parse(b.substr(4,2))):4==b.length?(a.hour=MO.Lang.Integer.parse(b.substr(0,2)),a.minute=MO.Lang.Integer.parse(b.substr(2,2))):
2==b.length&&(a.hour=MO.Lang.Integer.parse(b.substr(0,2)))};
MO.RDate.prototype.splitDate=function(a,b){if(b)if(-1!=b.indexOf("-")||-1!=b.indexOf("/")){var d=null;-1!=b.indexOf("-")?d=b.split("-"):-1!=b.indexOf("/")&&(d=b.split("/"));1<=d.length&&(a.year=MO.Lang.Integer.parse(d[0]));2<=d.length&&(a.month=MO.Lang.Integer.parse(d[1]));3<=d.length&&(a.day=MO.Lang.Integer.parse(d[2]))}else-1!=b.indexOf(":")?this.splitTime(a,b):14==b.length?(a.year=MO.Lang.Integer.parse(b.substr(0,4)),a.month=MO.Lang.Integer.parse(b.substr(4,2)),a.day=MO.Lang.Integer.parse(b.substr(6,
2)),a.hour=MO.Lang.Integer.parse(b.substr(8,2)),a.minute=MO.Lang.Integer.parse(b.substr(10,2)),a.second=MO.Lang.Integer.parse(b.substr(12,2))):8==b.length?(a.year=MO.Lang.Integer.parse(b.substr(0,4)),a.month=MO.Lang.Integer.parse(b.substr(4,2)),a.day=MO.Lang.Integer.parse(b.substr(6,2))):6==b.length?(a.year=MO.Lang.Integer.parse(b.substr(0,4)),a.month=MO.Lang.Integer.parse(b.substr(4,2))):4==b.length&&(a.year=MO.Lang.Integer.parse(b))};
MO.RDate.prototype.checkItems=function(a){if(!a)return!1;var b=MO.Lang.Integer.parse(a.year);if(b<this.MinYear||b>this.MaxYear)return!1;var d=MO.Lang.Integer.parse(a.month);if(1>d||12<d)return!1;var e=MO.Lang.Integer.parse(a.day);if(1>e||e>this.monthDays(b,d))return!1;b=MO.Lang.Integer.parse(a.hour);if(0>b||23<b)return!1;b=MO.Lang.Integer.parse(a.second);if(0>b||59<b)return!1;a=MO.Lang.Integer.parse(a.ms);return 0>a||99<a?!1:!0};
MO.RDate.prototype.check=function(a,b){return this.checkItems(this.splitFormat(a,b))};MO.RDate.prototype.make=function(a,b,d,e,f,h){return new MO.TDate(new Date(a,b,d))};MO.RDate.prototype.makeDate=function(a,b){var d=MO.Lang.Integer.parse(b.year),e=MO.Lang.Integer.parse(b.month)-1,f=MO.Lang.Integer.parse(b.day),h=MO.Lang.Integer.parse(b.hour),k=MO.Lang.Integer.parse(b.minute),q=MO.Lang.Integer.parse(b.second),w=MO.Lang.Integer.parse(b.ms),d=new Date(d,e,f,h,k,q,w);return a?(a.setDate(d),a):new MO.TDate(d)};
MO.RDate.prototype.parse=function(a,b,d){d||(d=this.DataFormat);b=this.splitFormat(b,d);return this.checkItems(b)?this.makeDate(a,b):null};MO.RDate.prototype.autoParse=function(a,b){if(!b)return null;a=this.nvl(a);var d=[];d.year=2E3;d.month=1;d.day=1;d.hour=0;d.minute=0;d.second=0;b=MO.Lang.String.trim(b);if(-1==b.indexOf(" "))this.splitDate(d,b);else{var e=b.split(" ");2==e.length&&(this.splitDate(d,e[0]),this.splitTime(d,e[1]))}return this.checkItems(d)?this.makeDate(a,d):null};MO.RDate=new MO.RDate;
MO.Lang.Date=MO.RDate;MO.RInteger=function(){this.NUMBER=this.Chars="0123456789-%";this.LEFT_CHAR="0";this.MAX_UINT16=65535;this.MAX_UINT32=4294967295;return this};MO.RInteger.prototype.isInt=function(a){return MO.Lang.String.isPattern(a,"n")};MO.RInteger.prototype.nvl=function(a,b){return null!=a?parseInt(a):null!=b?b:0};MO.RInteger.prototype.strideByte=function(a){return 65535<a?4:255<a?2:1};MO.RInteger.prototype.strideBit=function(a){return 65535<a?32:255<a?16:8};
MO.RInteger.prototype.parse=function(a,b){null==b&&(b=0);if(null==a||""==a)return b;for(a=MO.Lang.String.trim(a.toString());"0"==a.charAt(0);)a=a.substr(1);var d=0<a.length?parseInt(a):b;return isNaN(d)?b:d};MO.RInteger.prototype.format=function(a,b,d){d||(d=this.LEFT_CHAR);a=a.toString();for(b=parseInt(b)-a.length-1;0<=b;b--)a=d+a;return a};MO.RInteger.prototype.toRange=function(a,b,d){null==a&&(a=0);isNaN(a)&&(a=0);a<b&&(a=b);a>d&&(a=d);return a};
MO.RInteger.prototype.pow2=function(a){return 4096<a?8192:2048<a?4096:1024<a?2048:512<a?1024:256<a?512:128<a?256:64<a?128:32<a?64:16<a?32:8<a?16:4<a?8:2<a?4:1<a?2:1};MO.RInteger.prototype.sum=function(){for(var a=0,b=arguments,d=b.length,e=0;e<d;e++)null!=b[e]&&(a+=parseInt(b[e]));return a};MO.RInteger.prototype.calculate=function(a,b,d){b=RInteger.parse(b);d=RInteger.parse(d);var e="";"+"==a?e=b+d:"-"==a?e=b-d:"x"==a?e=b*d:"/"==a&&(e=b/d);return e.toString()};
MO.RInteger.prototype.copy=function(a,b,d,e,f){for(var h=0;h<f;h++)a[b++]=d[e++]};MO.RInteger.prototype.toString=function(a){return null==a?"0":a.toString()};MO.RInteger=new MO.RInteger;MO.Lang.Integer=MO.RInteger;MO.RLogger=function(){this._labelLength=40;this._logger=new MO.SLogger;this.lsnsOutput=new MO.TListeners;return this};MO.RLogger.prototype.output=function(a,b){var d=this._logger;d.sender=a;d.message=b;this.lsnsOutput.process(d)};
MO.RLogger.prototype.debug=function(a,b,d){var e=null,f=MO.Logger.debug.caller;f?e=MO.Method.name(f):arguments.caller&&(e=MO.Method.name(arguments.caller[0]));e=null==e?"unknown":e.replace("_",".");a&&a.hashCode&&(e+="@"+a.hashCode());f=new MO.TString;f.append(MO.Lang.Date.format("yymmdd-hh24miss.ms"));f.append("|D ["+MO.Lang.String.rpad(e,this._labelLength)+"] ");for(var e=arguments.length,h=2;h<e;h++){var k=arguments[h],q="";null!=k&&(q="function"==typeof k?MO.Method.name(k):k.toString());b=b.replace("{"+
(h-1)+"}",q)}f.append(b);this.output(a,f.flush())};
MO.RLogger.prototype.info=function(a,b,d){var e=null,f=MO.Logger.info.caller;f?e=MO.Method.name(f):arguments.caller&&(e=MO.Method.name(arguments.caller[0]));e=null==e?"unknown":e.replace("_",".");a&&a.hashCode&&(e+="@"+a.hashCode());f=new MO.TString;f.append(MO.Lang.Date.format("yymmdd-hh24miss.ms"));f.append("|I ["+MO.Lang.String.rpad(e,this._labelLength)+"] ");for(var e=arguments.length,h=2;h<e;h++){var k=arguments[h],q="";null!=k&&(q="function"==typeof k?MO.Method.name(k):k.toString());b=b.replace("{"+
(h-1)+"}",q)}f.append(b);this.output(a,f.flush())};
MO.RLogger.prototype.warn=function(a,b,d){var e=null,f=MO.Logger.warn.caller;f?e=MO.Method.name(f):arguments.caller&&(e=MO.Method.name(arguments.caller[0]));e=null==e?"unknown":e.replace("_",".");a&&a.hashCode&&(e+="@"+a.hashCode());f=new MO.TString;f.append(MO.Lang.Date.format("yymmdd-hh24miss.ms"));f.append("|W ["+MO.Lang.String.rpad(e,this._labelLength)+"] ");for(var e=arguments.length,h=2;h<e;h++){var k=arguments[h],q="";null!=k&&(q="function"==typeof k?MO.Method.name(k):k.toString());b=b.replace("{"+
(h-1)+"}",q)}f.append(b);this.output(a,f.flush())};
MO.RLogger.prototype.error=function(a,b,d){var e=null,f=MO.Logger.error.caller;f?e=MO.Method.name(f):arguments.caller&&(e=MO.Method.name(arguments.caller[0]));e=null==e?"unknown":e.replace("_",".");a&&a.hashCode&&(e+="@"+a.hashCode());f=new MO.TString;f.append(MO.Lang.Date.format("yymmdd-hh24miss.ms"));f.append("|E ["+MO.Lang.String.rpad(e,this._labelLength)+"] ");for(var e=arguments.length,h=2;h<e;h++){var k=arguments[h],q="";null!=k&&(q="function"==typeof k?MO.Method.name(k):k.toString());b=b.replace("{"+
(h-1)+"}",q)}f.append(b);this.output(a,f.flush())};
MO.RLogger.prototype.fatal=function(a,b,d,e){for(var f=new MO.TString,h=[],k=MO.Logger.fatal.caller;k&&!MO.Lang.Array.contains(h,k);)h.push(k),k=k.caller;for(var q=h.length,w=0;w<q;w++)k=h[w],0<w&&f.appendLine(),f.append("   "+(q-w)+": "+MO.Method.name(k));h=new MO.TString;h.appendLine(MO.RContext.get("RMessage:fatal"));h.appendLine(MO.Lang.String.repeat("-",60));h.append(MO.Class.dump(a),": ");if(d)for(q=arguments.length,w=3;w<q;w++)k=arguments[w],"function"==typeof k&&(k=MO.Method.name(k)),d=d.replace("{"+
(w-2)+"}",k);h.appendLine(d);h.appendLine(MO.Lang.String.repeat("-",60));h.appendLine("Stack:");h.append(f.flush());f=h.flush();this.output(a,f);if(MO.Runtime.isPlatformPc()&&!MO.Runtime.isRelease())throw Error(f);};
MO.RLogger.prototype.show=function(a,b,d){var e=null,f=MO.Logger.show.caller;f?e=MO.Method.name(f):arguments.caller&&(e=MO.Method.name(arguments.caller[0]));e=null==e?"unknown":e.replace("_",".");owner.hashCode&&(e+="@"+owner.hashCode());f=new MO.TString;f.append(MO.Lang.Date.format("yymmdd-hh24miss.ms"));f.append("|I ["+MO.Lang.String.rpad(e,this._labelLength)+"] ");for(var e=arguments.length,h=2;h<e;h++){var k=arguments[h],q="";null!=k&&(q="function"==typeof k?MO.Method.name(k):k.toString());b=
b.replace("{"+(h-1)+"}",q)}f.append(b);alert(f.flush())};MO.Logger=new MO.RLogger;MO.RMethod=function(){this._virtuals={};this._properties={};return this};MO.RMethod.prototype.construct=function(){this.empty.__empty=!0;this.emptyTrue.__empty=!0;this.emptyFalse.__empty=!0};MO.RMethod.prototype.isFunction=function(a){return"function"==typeof a};MO.RMethod.prototype.isEmpty=function(a){return a&&a.__empty};MO.RMethod.prototype.isVirtual=function(a){return a&&a.__virtual};
MO.RMethod.prototype.name=function(a){return a&&"function"==typeof a?a.__name?a.__name:a.__name=MO.Lang.String.mid(a.toString(),"function ","("):null};MO.RMethod.prototype.fullName=function(a){return a&&a.constructor==Function?a.__fullname?a.__fullname:a.__fullname=MO.Lang.String.mid(a.toString(),"function ",")")+")":null};MO.RMethod.prototype.empty=function(){};MO.RMethod.prototype.emptyTrue=function(){return!0};MO.RMethod.prototype.emptyFalse=function(){return!1};
MO.RMethod.prototype.emptyCall=function(){};MO.RMethod.prototype.virtual=function(a,b){var d=null,e=MO.Class.name(a)+"."+b,f=this._virtuals;f[e]?d=f[e]:(d=new Function("throw new Error('Virtual method be called.("+e+")');"),d.__virtual=!0,d.__name=e,f[e]=d);return d};MO.RMethod.prototype.makeVirtual=function(a,b){var d=null,e=a.name+"."+b,f=this._virtuals;f[e]?d=f[e]:(d=new Function("throw new Error('Virtual method be called.("+e+")');"),d.__virtual=!0,d.__name=e,f[e]=d);return d};
MO.RMethod.prototype.makePropertyGet=function(a,b){var d=a+"|"+b,e=null;this._properties[d]?e=this._properties[d]:(e=new Function("return this."+a+";"),this._properties[d]=e);return e};MO.RMethod.prototype.makePropertyGetSource=function(a,b){return new Function("return this."+a+";")};MO.RMethod.prototype.makePropertySet=function(a,b){var d=a+"|"+b,e=null;this._properties[d]?e=this._properties[d]:(e=new Function("value","this."+a+"=value;"),this._properties[d]=e);return e};MO.RMethod=new MO.RMethod;
MO.Method=MO.RMethod;MO.Method.construct();MO.RObject=function(){this._hash=1;return this};MO.RObject.prototype.nextId=function(a){return this._hash++};MO.RObject.prototype.nvl=function(a){for(var b=arguments,d=b.length,e=0;e<d;e++)if(null!=b[e])return b[e];return null};MO.RObject.prototype.clone=function(a){var b=new a.constructor,d;for(d in a){var e=a[d];null!=e&&(MO.Class.isBaseType(e.constructor)||(e=MO.Lang.Object.clone(e)));b[d]=e}return b};
MO.RObject.prototype.copy=function(a,b){if(null!=a&&null!=b)for(var d in a){var e=a[d];null==e||MO.Class.isBaseType(e.constructor)||(null==b[d]&&(b[d]=new c),MO.Lang.Object.copy(e,b[d]));b[d]=e}};
MO.RObject.prototype.free=function(a){if(a)if(MO.Runtime.isDebug())for(var b in a)if("__base"==b||"__inherits"==b||"__class"==b)a[b]=null;else{var d=a[b];if(null!=d){if(!MO.Class.isBaseType(d.constructor))throw new MO.TError(MO.Lang.Object,"Free object is not base object.");a[b]=null}}else for(b in a)a[b]=null};MO.RObject.prototype.dispose=function(a,b){if(a){if(a.__dispose)throw new MO.TError(MO.Lang.Object,"Object has disposed.");a.dispose(b);a.__dispose=!0}return null};
MO.RObject.prototype.release=function(a){if(a)for(var b in a){var d=a[b];"Object"==typeof d&&this.release(d);a[n]=null}return null};MO.RObject=new MO.RObject;MO.Lang.Object=MO.RObject;MO.RString=function(){this.EMPTY="";this.SPACE="   ";this.PAD=" ";this.TRIM=" \t\r\n";this.LOWER="abcdefghijklmnopqrstuvwxyz";this.UPPER="ABCDEFGHIJKLMNOPQRSTUVWXYZ";this.CodeLowerA=97;this.CodeLowerZ=122;this.CodeUpperA=65;this.CodeUpperZ=90;this._hashData=null;return this};
MO.RString.prototype.isEmpty=function(a){return null!=a?0==a.length:!0};MO.RString.prototype.isBlank=function(a){return null!=a?0==a.trim().length:!0};MO.RString.prototype.isAnsi=function(a){if(null!=a){for(var b=a.length,d=0;d<b;d++)if(255<a.charCodeAt(d))return!1;return!0}return!1};MO.RString.prototype.isDbcs=function(a){if(null==a){for(var b=a.length,d=0;d<b;d++)if(256>a.charCodeAt(d))return!1;return!0}return!1};
MO.RString.prototype.isPattern=function(a,b){if(null!=a){var d;d=(null==b?"$a$A$f":b).replace(/\a/g,this.LOWER);d=d.replace(/\A/g,this.UPPER);d=d.replace(/\f/g,MO.Lang.Float.NUMBER);d=d.replace(/\n/g,MO.Lang.Integer.NUMBER);for(var e=a.length,f=0;f<e;f++)if(-1==d.indexOf(a.charAt(f)))return!1;return!0}return!1};MO.RString.prototype.inChars=function(a,b){return-1!=this.findChars(b,a)?!0:!1};
MO.RString.prototype.equals=function(a,b,d){null==a?a="":a.constructor!=String&&(a=a.toString());null==b?b="":b.constructor!=String&&(b=b.toString());return d?a==b:a.toLowerCase()==b.toLowerCase()};MO.RString.prototype.contains=function(a,b){if(null!=a){a.constructor!=String&&(a=a.toString());for(var d=arguments.length,e=1;e<d;e++)if(-1!=a.indexOf(arguments[e]))return!0}return!1};MO.RString.prototype.startsWith=function(a,b){return null==b?!0:null!=a?0==a.indexOf(b):!1};
MO.RString.prototype.endsWith=function(a,b){if(null==b)return!0;var d=null!=a?a.indexOf(b):-1;return-1!=d?d==a.length-b.length:!1};MO.RString.prototype.findChars=function(a,b){if(null!=a&&null!=b)for(var d=a.length,e=0;e<d;e++)if(-1!=b.indexOf(a.charAt(e)))return e;return-1};MO.RString.prototype.inRange=function(a,b,d){if(a&&b){d||(a=a.toLowerCase());for(var e=b.length,f=0;f<e;f++){var h=b[f];if(null!=h)if(d){if(a==h)return!0}else if(a==h.toLowerCase())return!0}}return!1};
MO.RString.prototype.nvl=function(a,b){if(null!=a){var d=null,d=a.constructor!=String?a.toString():a;if(0<d.length)return d}return null!=b?b:this.EMPTY};MO.RString.prototype.nvlString=function(a){null==a&&(a=new MO.TString);return a};MO.RString.prototype.empty=function(a){if(null!=a){var b=null,b=a.constructor!=String?a.toString():a;if(0<b.length)return b}return null};
MO.RString.prototype.calculateHash=function(a,b){var d=this._hashData;d||(d=this._hashData=new Int32Array(1));d[0]=MO.Runtime.nvl(b,0);for(var e=a.length,f=0;f<e;f++){var h=a.charCodeAt(f);d[0]=31*d[0]+h}return Math.abs(d[0])};MO.RString.prototype.firstUpper=function(a){return null!=a?a.charAt(0).toUpperCase()+a.substr(1):a};MO.RString.prototype.firstLower=function(){return null!=value?value.charAt(0).toLowerCase()+value.substr(1):value};
MO.RString.prototype.firstLine=function(a){if(a){var b=Math.min(a.indexOf("\r"),a.indexOf("\n"));return-1!=b?a.substr(0,b):a}return""};MO.RString.prototype.format=function(a,b){for(var d=arguments.length,e=1;e<d;e++){var f=arguments[e];null==f?f="":"function"==typeof f&&(f=MO.Method.name(f));a=a.replace("{"+e+"}",f)}return a};
MO.RString.prototype.formatLines=function(a){a=a.replace(/\\r/g,"");a=a.split("\n");for(var b=a.length,d=new MO.TString,e=0;e<b;e++){var f=a[e],f=this.trim(f);this.isEmpty(f)||this.startsWith(f,"//")||d.appendLine(f)}return d.flush()};MO.RString.prototype.repeat=function(a,b){return Array(b+1).join(a)};MO.RString.prototype.pad=function(a,b,d){a=null!=a?a.toString():this.EMPTY;b-=a.length;if(0<b){null==d&&(d=this.PAD);var e=0==b%2?b/2:(b-1)/2;return Array(e+1).join(d)+a+Array(b-e+1).join(d)}return a};
MO.RString.prototype.lpad=function(a,b,d){a=null!=a?a.toString():this.EMPTY;b-=a.length;return 0<b?(null==d&&(d=this.PAD),b=Array(b),b[b.length]=a,b.join(d)):a};MO.RString.prototype.rpad=function(a,b,d){a=null!=a?a.toString():this.EMPTY;b-=a.length;return 0<b?(null==d&&(d=this.PAD),a+Array(b+1).join(d)):a};
MO.RString.prototype.trim=function(a,b){a=this.nvl(a);b=this.nvl(b,this.TRIM);for(var d=0,e=a.length-1;d<e&&-1!=b.indexOf(a.charAt(d));d++);for(;e>=d&&-1!=b.indexOf(a.charAt(e));e--);return d==e+1?null:0!=d||e!=a.length-1?a.substring(d,e+1):a};MO.RString.prototype.ltrim=function(a,b){a=this.nvl(value);b=this.nvl(trims,this.TRIM);for(var d=0,e=a.length-1;d<e&&-1!=b.indexOf(a.charAt(d));d++);return 0!=d?a.substring(d,e+1):a};
MO.RString.prototype.rtrim=function(a,b){a=this.nvl(a);b=this.nvl(b,this.TRIM);for(var d=a.length-1;0<=d&&-1!=b.indexOf(a.charAt(d));d--);return d!=a.length-1?a.substring(0,d+1):a};MO.RString.prototype.mid=function(a,b,d){if(null==a)return a;var e=0;if(null!=b){var f=a.indexOf(b);-1!=f&&(e=f+b.length)}b=a.length;null!=d&&(f=a.indexOf(d,e),-1!=f&&(b=f));return a.substring(e,b)};MO.RString.prototype.toLine=function(a){return a.replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\t/g,"\\t")};
MO.RString.prototype.toUnderline=function(a){var b=null;if(a){for(var b=new MO.TString,d=a.length,e=0;e<d;e++){var f=a.charAt(e);f.toUpperCase()==f?(0<e&&b.append("_"),b.append(f.toLowerCase())):b.append(f)}b=b.flush()}return b};MO.RString.prototype.toLower=function(a){return null!=a?a.toLowerCase():this.EMPTY};MO.RString.prototype.toUpper=function(a){return null!=a?a.toUpperCase():this.EMPTY};MO.RString.prototype.split=function(a,b){return a&&b?a.split(b):null};
MO.RString.prototype.splitTwo=function(a,b){if(a&&b){var d=[],e=a.indexOf(b);-1==e?d.push(a):(d.push(a.substring(0,e)),d.push(a.substring(e+b.length)));return d}return null};MO.RString.prototype.splitParts=function(a,b){for(var d=[],e=0,f=a.length,h=0;h<f;h++)for(var k in b)if(this.startsWith(b[k],a.charAt(h))&&this.equals(a.substr(h,b[k].length),b[k])){d[e++]=b[k];h=h+b[k].length-1;break}return d};
MO.RString.prototype.splitPattern=function(a,b){var d=[];if(a)for(var e=a.length,f=b.length,h="",k=0;k<e;k++){for(var q=!1,w=0;w<f;w++){var x=b[w];if(-1==a.indexOf(x)){h.length&&(d[d.length]=h,h="");d[d.length]=x;a=a.substring(x.length);q=!0;break}}q||(h+=a.charAt(0),a=a.substring(1))}return d};MO.RString.prototype.replace=function(a,b,d){return a.replace(new RegExp(b,"g"),d)};
MO.RString.prototype.replaceChar=function(a,b,d){if(null!=a){for(var e=a.length,f=[],h=0;h<e;h++){var k=a.charAt(h);f[f.length]=k==b?d:k}return f.join("")}return a};
MO.RString.prototype.decodeUtf=function(a){for(var b=0,d=0,e=0,f=0,h=0,k=a.length,q=[],w=[];b<k;++b,++d){e=a[b]&255;if(e&128)if(192==(e&224)){if(b+1>=k)return a;f=a[++b]&255;if(128!=(f&192))return a;w[d]=(e&31)<<6|f&63}else if(224==(e&240)){if(b+2>=k)return a;f=a[++b]&255;if(128!=(f&192))return a;h=a[++b]&255;if(128!=(h&192))return a;w[d]=(e&15)<<12|(f&63)<<6|h&63}else return a;else{if(!e)return a;w[d]=e}if(65535==d){d=w.length;for(e=0;e<d;e++)q.push(String.fromCharCode(w[e]));d=-1}}if(0<d)for(w.length=
d,d=w.length,e=0;e<d;e++)q.push(String.fromCharCode(w[e]));return q.join("")};MO.RString.prototype.remove=function(a,b){return a.replace(b,"")};MO.RString.prototype.removeChars=function(a,b){if(null!=a){for(var d=a.length,e=[],f=0;f<d;f++){var h=a.charAt(f);-1==b.indexOf(h)&&(e[e.length]=h)}return e.join("")}return a};MO.RString=new MO.RString;MO.Lang.String=MO.RString;
MO.AConstructor=function(a,b,d){MO.AAnnotation.call(this,a);this._annotationCd=MO.EAnnotation.Constructor;this._ordered=this._inherit=!0;this._dataCd=b;this._dataClass=d;this.dataCd=MO.AConstructor_dataCd;this.dataClass=MO.AConstructor_dataClass;return this};MO.AConstructor_dataCd=function(){return this._dataCd};MO.AConstructor_dataClass=function(){return this._dataClass};
MO.ADispose=function(a,b){MO.AAnnotation.call(this,a);this._annotationCd=MO.EAnnotation.Dispose;this._ordered=this._inherit=!0;this._disposeCd=b;this.disposeCd=MO.ADispose_disposeCd;return this};MO.ADispose_disposeCd=function(){return this._disposeCd};MO.AEnum=function(a,b){this.inherit=!0;this.annotation=MO.EAnnotation.Enum;this.name=a;this.linker=b;return this};MO.AGetterSource=function(a,b){MO.ASource.call(this,a,MO.ESource.Get,b);this._linker=b;this.build=MO.AGetterSource_build;return this};
MO.AGetterSource_build=function(a,b){var d=this._linker?this._linker:this._code;b[d]=MO.Method.makePropertyGetSource(this._name,d)};MO.ALinker=function(a,b){this.inherit=!0;this.annotation=MO.EAnnotation.Linker;this.name=a;this.linker=b;return this};
MO.AProperty=function(a,b){MO.AAnnotation.call(this,a);this._inherit=!0;this._annotationCd=MO.EAnnotation.Property;this._linker=null;this._force=!1;this.code=MO.AProperty_code;this.build=MO.AProperty_build;this.load=MO.AProperty_load;this.save=MO.AProperty_save;this.toString=MO.AProperty_toString;var d=null;null==b?(d=MO.Lang.String.startsWith(a,"_")?a.substring(1):a,d=MO.Lang.String.toUnderline(d)):d=b;this._linker=d;return this};MO.AProperty_code=function(){return this._linker};
MO.AProperty_build=function(){};MO.AProperty_load=function(a,b){a[this._name]=b.get(this._linker)};MO.AProperty_save=function(a,b){b.set(this._linker,a[this._name])};MO.AProperty_toString=function(){return"<"+this._annotationCd+",linker="+this._linker+">"};MO.EBoolean=new function(){this.True="Y";this.False="N";return this};MO.ECharCase=new function(){this.Upper="U";this.Lower="L";this.Word="W";return this};MO.EDispose=new function(){this.Null=0;this.Dispose=1;this.Release=2;return this};
MO.ENodeType=new function(){this.Node=1;this.Text=3;this.Data=4;return this};MO.ENumber=new function(){this.Integer="I";this.PositiveInteger="PI";this.NegativeInteger="NI";this.Float="F";this.PositiveFloat="PF";this.NegativeFloat="NF";return this};
MO.ERegExp=new function(){this.I=/^-?[1-9]\d*|0$/;this.PI=/^[1-9]\d*$/;this.NI=/^-[1-9]\d*$/;this.F=/^-?([1-9]\d*\.\d*|0\.\d*[1-9]\d*|0?\.0+|0)$/;this.PF=/^[1-9]\d*\.\d*|0\.\d*[1-9]\d*$/;this.NF=/^-([1-9]\d*\.\d*|0\.\d*[1-9]\d*)$/;this.U=/[1-9]{1}[0-9]/;this.E=/^\w{1,}[@]{1}[a-zA-Z]{1,}[.]{1}[a-zA-Z]{1,}$/;return this};MO.EResult=new function(){this.Success=0;this.Continue=1;this.Skip=2;this.Finish=3;this.Failure=-1;this.Cancel=-2;return this};
MO.MInstance=function(a){a=MO.Class.inherits(this,a);a.__free=!1;a.instanceCreate=MO.Method.empty;a.instanceAlloc=MO.Method.empty;a.instanceFree=MO.Method.empty;a.instanceRelease=MO.Method.empty;return a};MO.MInvoke=function(a){a=MO.Class.inherits(this,a);a.invoke=MO.Method.virtual(a,"invoke");return a};MO.MPoolAble=function(a){a=MO.Class.inherits(this,a);a._poolCode=MO.Class.register(a,new MO.AGetSet("_poolCode"));return a};MO.SArguments=function(){this.owner=null;return this};
MO.SEnumItem=function(){this.name=null;this.value=0;return this};MO.TContext=function(a,b,d){this.name=a;this.code=b;this.text=d;return this};
MO.TFatalError=function TFatalError(b,d,e,f){for(var h=new MO.TString,k=TFatalError.caller,q=new MO.TString,w=[];k&&!MO.Lang.Array.contains(w,k);)w.push(k),k=k.caller;for(var x=w.length,y=0;y<x;y++)k=w[y],0<y&&q.appendLine(),q.append("   "+(x-y)+": "+MO.Method.name(k));k=arguments;x=k.length;for(y=2;y<x;y++){var w=k[y],z=null,z="function"==typeof w?MO.Method.name(w):w;e=e.replace("{"+(y-1)+"}",z)}h.appendLine(e);h.appendLine("------------------------------------------------------------");h.append(q);
throw Error(h);};MO.TInstancePool=function(){MO.TObjects.call(this);this._instance=null;this.instance=MO.TInstancePool_instance;this.alloc=MO.TInstancePool_alloc;this.free=MO.TInstancePool_free;return this};MO.TInstancePool_instance=function(a){var b=this._instance;null==b&&(b=this._instance=MO.Class.create(a),b.instanceCreate());b.instanceAlloc();return b};MO.TInstancePool_alloc=function(a){var b=null;0==this._count?(b=MO.Class.create(a),b.instanceCreate()):b=this.pop();b.instanceAlloc();return b};
MO.TInstancePool_free=function(a){a.instanceFree();return this.push(a)};MO.TInvoke=function(){this.callback=this.owner=null;this.invoke=MO.TInvoke_invoke;return this};MO.TInvoke_invoke=function(a,b,d,e,f,h){if(this.callback){var k=this.owner?this.owner:this;try{this.callback.call(k,a,b,d,e,f,h)}catch(q){MO.Logger.fatal(this,q,"Call method failure. (owner={1}, callback={2})",k,this.callback)}}};
MO.TLoaderListener=function(){this.invoke=null;this.ids=new MO.TArray;this.check=MO.TLoaderListener_check;return this};MO.TLoaderListener_check=function(a){var b=this.ids;if(!b.isEmpty())for(var d=b.length,e=0;e<d;e++)if(!a.contains(b.get(e)))return!1;return!0};MO.TLocker=function(){this._lock=!1;this.enter=MO.TLocker_enter;this.leave=MO.TLocker_leave;return this};MO.TLocker_enter=function(){this._lock=!0};MO.TLocker_leave=function(){this._lock=!1};
MO.TMessage=function(){this.typeCd=MO.EMessage.None;this.redirect=this.description=this.message=this.attrType=null;this.loadConfig=MO.TMessage_loadConfig;this.saveConfig=MO.TMessage_saveConfig;this.icon=MO.TMessage_icon;return this};MO.TMessage_loadConfig=function(a){this.typeCd=RString.toLower(a.name);this.message=a.nvl("message");this.attrType=a.nvl("type");this.redirect=a.nvl("redirect");this.description=a.nvl("description").replace(/\\n/g,"\n")};
MO.TMessage_saveConfig=function(a){a.name=this.typeCd;a.set("message",this.message);a.set("description",this.description)};MO.TMessage_icon=function(){return"sys.msg."+this.typeCd};MO.TMessages=function(){this._items=new MO.TObjects;this.hasMessage=MO.TMessages_hasMessage;this.message=MO.TMessages_message;this.messages=MO.TMessages_messages;this.type=MO.TMessages_type;this.push=MO.TMessages_push;return this};
MO.TMessages_hasMessage=function(a){for(var b=0;b<this._items.count;b++){var d=this._items.get(b);if(d&&d.type==a)return!0}return!1};MO.TMessages_message=function(a){for(var b=0;b<this._items.count;b++){var d=this._items.get(b);if(d&&d.type==a)return d}return null};MO.TMessages_messages=function(a){for(var b=null,d=0;d<this._items.count;d++){var e=this._items.get(d);e&&e.type==a&&(b||(b=new TList),b.push(e))}return b};
MO.TMessages_type=function(){return this.hasMessage(EMessage.Fatal)?EMessage.Fatal:this.hasMessage(EMessage.Error)?EMessage.Error:this.hasMessage(EMessage.Warn)?EMessage.Warn:this.hasMessage(EMessage.Valid)?EMessage.Valid:this.hasMessage(EMessage.Info)?EMessage.Info:EMessage.None};MO.TMessages_push=function(a){a&&this._items.push(a)};
MO.TNode=function(a){this._name=MO.Lang.String.nvl(a,"Node");this._nodes=this._attributes=this._value=null;this.isName=MO.TNode_isName;this.name=MO.TNode_name;this.setName=MO.TNode_setName;this.value=MO.TNode_value;this.setValue=MO.TNode_setValue;this.contains=MO.TNode_contains;this.hasAttribute=MO.TNode_hasAttribute;this.attributes=MO.TNode_attributes;this.hasNode=MO.TNode_hasNode;this.nodeCount=MO.TNode_nodeCount;this.node=MO.TNode_node;this.nodes=MO.TNode_nodes;this.get=MO.TNode_get;this.getInteger=
MO.TNode_getInteger;this.set=MO.TNode_set;this.setNvl=MO.TNode_setNvl;this.setBoolean=MO.TNode_setBoolean;this.setFloat=MO.TNode_setFloat;this.find=MO.TNode_find;this.findNode=MO.TNode_findNode;this.searchNode=MO.TNode_searchNode;this.push=MO.TNode_push;this.toString=MO.TNode_toString;this.innerDump=MO.TNode_innerDump;this.dump=MO.TNode_dump;return this};MO.TNode_isName=function(a){return MO.Lang.String.equals(this._name,a)};MO.TNode_name=function(){return this._name};
MO.TNode_setName=function(a){this._name=a};MO.TNode_value=function(){return this._value};MO.TNode_setValue=function(a){this._value=a};MO.TNode_contains=function(a){var b=this._attributes;return b?b.contains(a):!1};MO.TNode_hasAttribute=function(){var a=this._attributes;return a?!a.isEmpty():!1};MO.TNode_attributes=function(){var a=this._attributes;a||(a=this._attributes=new MO.TAttributes);return a};MO.TNode_hasNode=function(){var a=this._nodes;return a?!a.isEmpty():!1};
MO.TNode_nodeCount=function(){var a=this._nodes;return a?a.count():0};MO.TNode_node=function(a){var b=this._nodes;return b?b.at(a):null};MO.TNode_nodes=function(){var a=this._nodes;a||(a=this._nodes=new MO.TObjects);return a};MO.TNode_get=function(a,b){return this._attributes?this._attributes.get(a,b):null};MO.TNode_getInteger=function(a,b){return MO.Lang.Integer.parse(this.get(a,b))};MO.TNode_set=function(a,b){null!=b&&this.attributes().set(a,b)};
MO.TNode_setNvl=function(a,b){MO.Lang.String.isEmpty(b)||this.attributes().set(a,b)};MO.TNode_setBoolean=function(a,b){null!=b&&this.attributes().set(a,MO.Lang.Boolean.format(b))};MO.TNode_setFloat=function(a,b){null!=b&&this.attributes().set(a,MO.Lang.Float.format(b))};MO.TNode_find=function(a){if(this.hasNode())for(var b=this._nodes,d=b.count(),e=0;e<d;e++){var f=b.get(e);if(f.isName(a))return f}return null};
MO.TNode_findNode=function(a,b){if(this.hasNode()){var d=this._nodes,e=d.count(),f=arguments,h=f.length;if((h-1)%2)throw new MO.TError("Attributes is not pair. (length={1})",h);for(var k=0;k<e;k++){var q=d.get(k);if(null==a||q.isName(a)){for(var w=!0,x=1;x<h;x+=2)if(q.get(f[x])!=f[x+1]){w=!1;break}if(w)return q}}}return null};
MO.TNode_searchNode=function(a,b){if(this.hasAttribute()&&this._attributes.get(a)==b)return this;if(this.hasNode())for(var d=this._nodes,e=d.count();0<e;ni++){var f=d.get(f).searchNode(a,b);if(null!=f)return f}return null};MO.TNode_push=function(a){this.nodes().push(a)};MO.TNode_toString=function(){return this.dump()};
MO.TNode_innerDump=function(a,b,d){null==d&&(d="");a.append(d,b._name,"(",RClass.name(b),")");var e=b._attributes;if(e){var f=e.count();a.append(" [",f,":");for(var h=0;h<f;h++)0<h&&a.append(" "),a.append(e.name(h),"=",e.value(h)),h<f-1&&a.append(",");a.append("]")}b._value&&(f=b._value.toString(),MO.Lang.String.isEmpty(f)||a.append(" {",f.length,":",f,"}"));if(b=b._nodes)for(f=b.count(),a.append("\n"),h=0;h<f;h++)b.get(h).dump(a,d+"   "),h<f-1&&a.append("\n");return a};
MO.TNode_dump=function(a,b){return this.innerDump(MO.Lang.String.nvlString(a),this,b)};MO.TRow=function(){MO.TAttributes.call(this);this._statusCd=this._uniqueId=this._index=this._dataset=null;this.loadConfig=MO.TRow_loadConfig;this.saveConfig=MO.TRow_saveConfig;return this};MO.TRow_loadConfig=function(a){this._index=a.get("_id");this._statusCd=a.get("_status");this._uniqueId=a.get("ouid");a.hasAttribute()&&this.append(a.attributes())};
MO.TRow_saveConfig=function(a){a.set("_id",this._index);a.set("_status",this._statusCd);for(var b=this.count(),d=0;d<b;d++)a.set(this._names[d],this._values[d])};MO.TRow_copy=function(){var a=new TRow;a._dataset=this._dataset;a._index=this._index;a._statusCd=this._statusCd;a._uniqueId=this._uniqueId;for(var b=this.count,d=0;d<b;d++)a.set(this.names[d],this.values[d]);return a};MO.TRow_toAttributes=function(a){a||(a=new MO.TAttributes);a.set(RDataset.ROW_STATUS,this._statusCd);a.append(this);return a};
MO.TRow_dump=function(a){var b=this.count;a=MO.Lang.String.nvlStr(a);a.append(MO.Class.name(this)," [",this._statusCd,": ");for(var d=0;d<b;d++)0<d&&a.append(","),a.append(this.names[d],"=",this.values[d]);a.append("]");return a};
MO.TSpeed=function(){this.arguments=arguments;this._span=this._end=this._start=0;this._spanMin=Number.MAX_VALUE;this._spanMax=0;this.start=(new Date).getTime();this.callerName=MO.Method.name(MO.TSpeed.caller);this.reset=MO.TSpeed_reset;this.begin=MO.TSpeed_begin;this.end=MO.TSpeed_end;this.record=MO.TSpeed_record;this.toString=MO.TSpeed_toString;return this};MO.TSpeed_reset=function(){this._span=this._end=this._start=0};MO.TSpeed_begin=function(){this._start=(new Date).getTime()};
MO.TSpeed_end=function(){this._end=(new Date).getTime();this._span+=this._end-this._start;this._span<this._spanMin&&(this._spanMin=this._span);this._span>this._spanMax&&(this._spanMax=this._span)};MO.TSpeed_record=function(){(new Date).getTime();this.record=this.callerName=this.start=this.arguments=null};MO.TSpeed_toString=function(){return this._span+" ("+this._spanMin+" - "+this._spanMax+")"};MO.TTicker=function(a){this.interval=a;this.lastTick=0;this.process=MO.TTicker_process};
MO.TTicker_process=function(){var a=MO.Timer.current();return a-this.lastTick>this.interval?(this.lastTick=a,!0):!1};
MO.TUnsupportError=function TUnsupportError(b,d){for(var e="Unsupport method. (name={1})",f=new MO.TString,h=TUnsupportError.caller,k=new MO.TString,q=[];h&&!MO.Lang.Array.contains(q,h);)q.push(h),h=h.caller;for(var w=q.length,x=0;x<w;x++)h=q[x],0<x&&k.appendLine(),k.append("   "+(w-x)+": "+MO.Method.name(h));h=arguments;w=h.length;for(x=1;x<w;x++)var q=h[x],y=null,y="function"==typeof q?MO.Method.name(q):q,e=e.replace("{"+(x-1)+"}",y);f.appendLine(e);f.appendLine("------------------------------------------------------------");
f.append(k);throw Error(f);};MO.FConsole=function(a){a=MO.Class.inherits(this,a,MO.FObject);a._scopeCd=MO.Class.register(a,new MO.AGetter("_scopeCd"),MO.EScope.Global);a._statusSetup=!1;a.onSetup=MO.Method.empty;a.setup=MO.FConsole_setup;return a};MO.FConsole_setup=function(){this._statusSetup||(this.onSetup(),this._statusSetup=!0)};
MO.FObjectPool=function(a){a=MO.Class.inherits(this,a,MO.FObject);a._items=MO.Class.register(a,new MO.AGetter("_items"));a._frees=MO.Class.register(a,new MO.AGetter("_frees"));a._allocCount=0;a._freeCount=0;a.construct=MO.FObjectPool_construct;a.hasFree=MO.FObjectPool_hasFree;a.alloc=MO.FObjectPool_alloc;a.free=MO.FObjectPool_free;a.push=MO.FObjectPool_push;a.dispose=MO.FObjectPool_dispose;a.innerDump=MO.FObjectPool_innerDump;return a};
MO.FObjectPool_construct=function(){this.__base.FObject.construct.call(this);this._items=new MO.TObjects;this._frees=new MO.TObjects};MO.FObjectPool_hasFree=function(){return!this._frees.isEmpty()};MO.FObjectPool_alloc=function(){var a=null;this._frees.isEmpty()||(a=this._frees.pop());this._allocCount++;return a};MO.FObjectPool_free=function(a){this._frees.push(a);this._freeCount++};MO.FObjectPool_push=function(a){this._items.push(a);this._frees.push(a)};
MO.FObjectPool_dispose=function(){this._items=MO.Lang.Object.dispose(this._items);this._frees=MO.Lang.Object.dispose(this._frees);this.__base.FObject.dispose.call(this)};MO.FObjectPool_innerDump=function(a,b){a.append("Pool:");a.append("total=",this._items.count());a.append(", free=",this._frees.count());a.append(", alloc_count=",this._allocCount);a.append(", free_count=",this._freeCount)};
MO.FObjectPools=function(a){a=MO.Class.inherits(this,a,MO.FObject);a._pools=null;a.construct=MO.FObjectPools_construct;a.pool=MO.FObjectPools_pool;a.alloc=MO.FObjectPools_alloc;a.free=MO.FObjectPools_free;a.dispose=MO.FObjectPools_dispose;return a};MO.FObjectPools_construct=function(){this.__base.FObject.construct.call(this);this._pools=new MO.TDictionary};MO.FObjectPools_pool=function(a){var b=this._pools.get(a);b||(b=MO.Class.create(MO.FObjectPool),this._pools.set(a,b));return b};
MO.FObjectPools_alloc=function(a){return this.pool(a).alloc()};MO.FObjectPools_free=function(a,b){return this.pool(a).free(b)};MO.FObjectPools_push=function(a,b){return this.pool(a).push(b)};MO.FObjectPools_dispose=function(){for(var a=this._pools,b=a.count(),d=0;d<b;d++)a.at(d).dispose();a.dispose();this.__base.FObject.dispose.call(this)};
MO.FTimer=function(a){a=MO.Class.inherits(this,a,MO.FObject);a._count=0;a._startTime=0;a._beginTime=0;a._endTime=0;a._stopTime=0;a._span=MO.Class.register(a,new MO.AGetter("_span"),0);a._spanSecond=MO.Class.register(a,new MO.AGetter("_spanSecond"),0);a.setup=MO.FTimer_setup;a.current=MO.FTimer_current;a.rate=MO.FTimer_rate;a.update=MO.FTimer_update;return a};MO.FTimer_setup=function(){var a=(new Date).getTime();this._endTime=this._beginTime=this._startTime=a};MO.FTimer_current=function(){return this._lastTime};
MO.FTimer_rate=function(){return 0==this._count?0:parseInt(1E3*this._count/(this._lastTime-this._startTime))};MO.FTimer_update=function(){this._count++;var a=this._beginTime=this._endTime;this._spanSecond=(this._span=(this._endTime=(new Date).getTime())-a)/1E3};
MO.RArray=function(){this.array1=Array(1);this.array2=Array(2);this.array3=Array(3);this.array4=Array(4);this.array9=Array(9);this.array12=Array(12);this.array16=Array(16);this.sortComparerAsc=MO.Runtime.sortComparerAsc;this.sortComparerDesc=MO.Runtime.sortComparerDesc;this.pairSortMid=MO.Runtime.pairSortMid;this.pairSortSub=MO.Runtime.pairSortSub;this.pairSort=MO.Runtime.pairSort;return this};
MO.RArray.prototype.equals=function(a,b){if(a&&b&&a.length==b.length){for(var d=a.length,e=0;e<d;e++)if(a[e]!=b[e])return!1;return!0}return!1};MO.RArray.prototype.count=function(a){var b=0,d;for(d in a)b++;return b};MO.RArray.prototype.contains=function(a,b){for(var d=a.length,e=0;e<d;e++)if(a[e]==b)return!0;return!1};MO.RArray.prototype.find=function(a,b){for(var d=a.length,e=0;e<d;e++)if(a[e]==b)return e;return-1};MO.RArray.prototype.search=function(a,b){for(var d in a)if(a[d]==b)return d;return null};
MO.RArray.prototype.reverse=function(a,b,d){for(var e=d+1-b>>1,f=0;f<e;f++){var h=a[b+f];a[b+f]=a[d-f];a[d-f]=h}};MO.RArray.prototype.copy=function(a,b,d,e,f){for(var h=0;h<d;h++)e[h+f]=a[h+b];return e};MO.RArray.prototype.move=function(a,b,d,e){if(b>e)for(var f=0;f<d;f++)a[e-f]=a[b+f];else if(b<e)for(f=0;f<d;f++)a[e+d-f-1]=a[b+d-f-1]};MO.RArray.prototype.remove=function(a,b){return a.slice(0,b).concat(a.slice(b+1))};
MO.RArray.prototype.sortPartition=function(a,b,d){var e=b;d+=1;for(var f=a[e];;){for(;a[++e]<f;);for(;a[--d]>f;);if(e>d)break;var h=a[e];a[e]=a[d];a[d]=h}a[b]=a[d];a[d]=f;return d};MO.RArray.prototype.sortArray=function(a,b,d){if(b<d){var e=this.sortPartition(a,b,d);this.sortArray(a,b,e-1);this.sortArray(a,e+1,d)}};MO.RArray.prototype.sort=function(a,b){var d=a.length-1;this.sortArray(a,0,d);b&&this.reverse(a,0,d);return a};
MO.RArray.prototype.nameMaxLength=function(a){for(var b in a)a=b.length,a>b&&(b=a);return 0};MO.RArray.prototype.quickSort=function(a,b,d,e,f){this.pairSort(a,null,b,d,e,f)};MO.RArray=new MO.RArray;MO.Lang.Array=MO.RArray;MO.RBlob=function(){return this};MO.RBlob.prototype.fromText=function(a){for(var b=a.length,d=new Uint8Array(b),e=0;e<b;e++)d[e]=a.charCodeAt(e);return new Blob([d])};MO.Lang.Blob=new MO.RBlob;MO.RBoolean=function(){return this};
MO.RBoolean.prototype.format=function(a){return a?MO.EBoolean.True:MO.EBoolean.False};MO.RBoolean.prototype.parse=function(a){if(null!=a){if(a.constructor==Boolean)return a;if(a.constructor==String)return a==MO.EBoolean.True;if(a.constructor==Number)return 0<a;throw new MO.TError(this,"Unknown type.");}return!1};MO.RBoolean.prototype.toString=function(a,b,d){null==b&&(b=MO.EBoolean.True);null==d&&(d=MO.EBoolean.False);return a?b:d};MO.RBoolean=new MO.RBoolean;MO.Lang.Boolean=MO.RBoolean;
MO.RByte=function(){return this};MO.RByte.prototype.copy=function(a,b,d,e,f){for(var h=0;h<f;h++)a[b++]=d[e++]};MO.RByte.prototype.encodeBytes=function(a,b,d,e){var f=new Uint8Array(8);f[0]=e>>16&255;f[1]=e>>8&255;f[2]=e&255;f[3]=e>>24&255;f[4]=e&255;f[5]=e>>24&255;f[6]=e>>16&255;f[7]=e>>8&255;for(e=0;e<d;e++)a[b+e]^=f[e%8]};MO.RByte=new MO.RByte;MO.Lang.Byte=MO.RByte;MO.RChar=function(){return this};MO.RChar.prototype.parse=function(a){return String.fromCharCode(a)};MO.RChar.prototype.toString=function(a){return a};
MO.RChar=new MO.RChar;MO.Lang.Char=MO.RChar;MO.RConsole=function(){this.ConsolePreFix="console:";this._registers=new MO.TObjects;this._consoles=new MO.TDictionary;this._localConsoles=new MO.TDictionary;return this};MO.RConsole.prototype.initialize=function(){for(var a=this._registers,b=a.count(),d=0;d<b;d++){var e=a.get(d);e.force&&this.find(e.clazz)}};MO.RConsole.prototype.register=function(a){this._registers.push(a)};
MO.RConsole.prototype.create=function(a){var b=null;if(a){var b=MO.Class.create(a),d;for(d in b)if(MO.Lang.String.startsWith(d,"lnk")){var e=b[d];if("string"==typeof e&&MO.Lang.String.startsWith(e,"&")){var f=this.find(e.substr(1));if(!f)return MO.RMessage.fatal(this,null,"Can't link console. (name={0}, property={1}:{2})",a,d,e);b[d]=f}}}return b};
MO.RConsole.prototype.createByName=function(a){var b=null;if(a){var b=MO.Class.createByName(a),d;for(d in b)if(MO.Lang.String.startsWith(d,"lnk")){var e=b[d];if("string"==typeof e&&MO.Lang.String.startsWith(e,"&")){var f=this.find(e.substr(1));if(!f)return MO.Message.fatal(this,null,"Can't link console. (name={0}, property={1}:{2})",a,d,e);b[d]=f}}}return b};MO.RConsole.prototype.get=function(a){a=MO.Class.name(a);return this._consoles.get(a)};
MO.RConsole.prototype.find=function(a){var b=null;if(a.constructor==String)b=a;else if(a.constructor==Function)b=MO.Class.name(a);else return MO.Logger.fatal(this,null,"Parameter type is invalid. (console={1})",a);if((a=MO.Global.get(this.ConsolePreFix+b))||(a=this._consoles.get(b)))return a;switch(MO.Class.forName(b)._instance.scopeCd()){case MO.EScope.Global:a=top.MO.Console.createByName(b);MO.Global.set(this.ConsolePreFix+b,a);this._consoles.set(b,a);break;case MO.EScope.Local:a=this.createByName(b);
this._localConsoles.set(b,a);this._consoles.set(b,a);break;default:return MO.Logger.fatal(this,"Unknown scope code. (name={1})",b)}return a};MO.RConsole.prototype.release=function(){this._registers&&(this._registers.dispose(),this._registers=null);var a=this._localConsoles;if(a){for(var b=a.count(),d=0;d<b;d++)a.value(d).dispose();a.dispose()}this._localConsoles=null;this._consoles&&this._consoles.dispose();this._consoles=null};MO.RConsole=new MO.RConsole;MO.Console=MO.RConsole;
MO.RConst=function(){this.PI_2=Math.PI/2;this.PI=Math.PI;this.PI2=2*Math.PI;this.RADIAN_RATE=180/Math.PI;this.DEGREE_RATE=Math.PI/180;this.PERCENT_10=.1;this.PERCENT_100=.01;this.PERCENT_1000=.001;this.identity3x3=[1,0,0,0,1,0,0,0,1];this.identity4x4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return this};MO.RConst=new MO.RConst;MO.Const=MO.RConst;MO.Lang.Const=MO.RConst;MO.REnum=function(){return this};MO.REnum.prototype.contains=function(){};
MO.REnum.prototype.tryEncode=function(a,b,d){if(a)for(var e in a)if(e.toLowerCase()==b.toLowerCase())return a[e];return d};MO.REnum.prototype.encode=function(a,b){var d=this.tryEncode(a,b);if(null==d)throw new MO.TError(this,"Invalid value (enum={1}, value={2})",RClass.dump(a),b);return d};MO.REnum.prototype.tryDecode=function(a,b,d){if(a)for(var e in a)if(a[e]==b)return e;return d};
MO.REnum.prototype.decode=function(a,b){var d=this.tryDecode(a,b);if(null==d)throw new MO.TError(this,"Invalid value (enum={1}, value={2})",MO.Class.dump(a),b);return d};MO.REnum.prototype.parse=MO.REnum.prototype.encode;MO.REnum=new MO.REnum;MO.Lang.Enum=MO.REnum;MO.RFile=function(){this.pictures=["jpg","png","gif","bmp"];this.knowns="jpg png gif bmp doc docx vsd xls xlsx".split(" ");return this};
MO.RFile.prototype.inPicture=function(a){if(a){a=a.toLowerCase();for(var b in this.pictures)if(this.pictures[b]==a)return!0}};MO.RFile.prototype.isPicture=function(a){return this.inPicture(this.extension(a))};MO.RFile.prototype.isKnown=function(a){a=this.extension(a).toLowerCase();for(var b in this.knowns)if(this.knowns[b]==a)return!0;return!1};
MO.RFile.prototype.name=function(a){if(a){a=a.replace(/\\/g,"/");var b=a.lastIndexOf("/");-1!=b&&(a=a.substring(b+1));b=a.lastIndexOf(".");return-1!=b?a.substring(0,b):a}return""};MO.RFile.prototype.extension=function(a){if(a){a=a.replace(/\\/g,"/");var b=a.lastIndexOf("/");-1!=b&&(a=a.substring(b+1));b=a.lastIndexOf(".");return-1!=b?a.substring(b+1):a}return""};MO.RFile=new MO.RFile;MO.Stream.File=MO.File;MO.RFloat=function(){this.NUMBER=this.Chars="0123456789-.%";this.PAD_CHAR="0";return this};
MO.RFloat.prototype.isFloat=function(a){return MO.Lang.String.isPattern(a,"n")};MO.RFloat.prototype.parse=function(a){if(null==a||""==a)return 0;a=MO.Lang.String.trim(a.toString());if(null==a)return 0;for(;"0"==a.charAt(0);)a=a.substr(1);a=0<a.length?parseFloat(a):0;-1!=MO.Lang.String.findChars(a,"%")&&(a/=100);return isNaN(a)?0:a};
MO.RFloat.prototype.format=function(a,b,d,e,f){if(null==a)return"";null==b&&(b=0);null==d&&(d=this.PAD_CHAR);null==e&&(e=6);null==f&&(f=this.PAD_CHAR);var h=null,k=null,k=a.toString();a=k.indexOf(".");-1==a?(h=k,k=""):(h=k.substring(0,a),k=k.substring(a+1,a+e+1));b=MO.Lang.String.lpad(h,b,d);e=MO.Lang.String.rpad(k,e,f);return b+"."+e};
MO.RFloat.prototype.formatParttern=function(a,b){var d=parseFloat(a);if(!isNaN(d)&&isFinite(a)){var e=b.toString(),f=e.length,e=e.indexOf("."),f=f-e-1,h="",k=null,d=Math.round(d*Math.pow(10,f))/Math.pow(10,f),k=d.toString(),q=k.length,k=k.indexOf("."),w=q-k-1,q=f-w;if(-1!=e)if(-1==k){for(e=0;e<f;e++)h+="0";k=d+"."+h}else if(f==w)k=d;else{for(e=0;e<q;e++)h+="0";k=d+h}else k=Math.round(d);return k}};
MO.RFloat.prototype.unitFormat=function(a,b,d,e,f,h,k){null==b&&(b=0);null==d&&(d=this.PAD_CHAR);null==e&&(e=6);null==f&&(f=this.PAD_CHAR);if(null==h||null==k)h=1,k="";a=(a/h).toString();var q=a.indexOf(".");-1==q?(h=a,a=""):(h=a.substring(0,q),a=a.substring(q+1,q+e+1));d=MO.Lang.String.lpad(h,b,d);b=new MO.TString;for(h=1;h-1<d.length;h++)b.append(d.substring(h-1,h)),0<d.length-h&&0==(d.length-h)%3&&b.append(",");e=MO.Lang.String.rpad(a,e,f);return b+"."+e+k};
MO.RFloat.prototype.nvl=function(a,b){return a?a:b?b:0};MO.RFloat.prototype.toRange=function(a,b,d){null==a&&(a=0);return Math.min(Math.max(a,b),d)};MO.RFloat.prototype.sum=function(){for(var a=arguments,b=0,d=a.length-1;0<=d;d--){var e=a[n];null!=e&&(b+=parseFloat(e))}return b};MO.RFloat.prototype.calculate=function(a,b,d){b=RFloat.nvl(b);d=RFloat.nvl(d);b=parseFloat(b);d=parseFloat(d);return a?(b+d).toString():(b-d).toString()};
MO.RFloat.prototype.attach=function(a,b,d){for(var e=!1,f=0;f<d;f++)a[f]!=b[f]&&(a[f]=b[f],e=!0);return e};MO.RFloat.prototype.fill=function(a,b,d,e){for(var f=0;f<d;f++)a[b++]=e};MO.RFloat.prototype.copy=function(a,b,d,e,f){for(var h=0;h<f;h++)a[b++]=d[e++]};MO.RFloat=new MO.RFloat;MO.Lang.Float=MO.RFloat;MO.RHex=function(){this.NUMBER="0x123456789ABCDEF";this.PAD="0";return this};MO.RHex.prototype.isValid=function(a){return MO.String.isPattern(a,this.NUMBER)};
MO.RHex.prototype.parse=function(a){return a?parseInt("0x"+a):0};MO.RHex.prototype.format=function(a,b){var d=null,d=a?a.toString(16):"0";return b?MO.String.lpad(d,b,this.PAD):d};MO.RHex=new MO.RHex;MO.Lang.Hex=MO.RHex;MO.RInstance=function(){this._pools=new MO.TDictionary;return this};MO.RInstance.prototype.pool=function(a){a=MO.Class.name(a);var b=this._pools.get(a);null==b&&(b=new MO.TInstancePool,this._pools.set(a,b));return b};MO.RInstance.prototype.get=function(a){return this.pool(a).instance(a)};
MO.RInstance.prototype.alloc=function(a){return this.pool(p).alloc(p)};MO.RInstance.prototype.free=function(a){this.pool(p).free(p)};MO.RInstance=new MO.RInstance;MO.Instance=MO.RInstance;MO.RJson=function(){return this};MO.RJson.prototype.parse=function(a,b){var d=null;try{d=JSON.parse(a)}catch(e){b&&(d=new b)}return d};MO.RJson.prototype.toString=function(a){return JSON.stringify(a)};MO.Json=new MO.RJson;MO.RRect=function(){return this};MO.RRect.prototype.nvl=function(a){return a?a:new TRect};
MO.RRect.prototype.pack=function(a){var b=null;a&&(b=a.left+","+a.top+","+a.right+","+a.bottom);return b};MO.RRect.prototype.unpack=function(a,b){b=this.nvl(b);if(a){var d=a.split(",");4==d.length&&(b.left=RInt.parse(d[0]),b.top=RInt.parse(d[1]),b.right=RInt.parse(d[2]),b.bottom=RInt.parse(d[3]))}return b};MO.RRect=new MO.RRect;MO.RRegExp=function(){return this};MO.RRegExp.prototype.test=function(a,b){return a&&null!=b?a.test(b):!1};
MO.RRegExp.prototype.testRgexp=function(a,b){return a&&b?(new R,a.test(b)):!1};MO.RRegExp=new MO.RRegExp;MO.RSet=function(){return this};MO.RSet.prototype.contains=function(a,b){return(a&b)==b};MO.RSet.prototype.containsString=function(a,b){return null!=a&&null!=b?-1!=a.indexOf(b):!1};MO.Lang.Set=new MO.RSet;MO.RTimer=function(){this._count=this._lastTime=this._startTime=0;return this};MO.RTimer.prototype.setup=function(){var a=(new Date).getTime();this._lastTime=this._startTime=a};
MO.RTimer.prototype.now=function(){return(new Date).getTime()};MO.RTimer.prototype.current=function(){return this._lastTime};MO.RTimer.prototype.rate=function(){return 0==this._count?0:parseInt(1E3*this._count/(this._lastTime-this._startTime))};MO.RTimer.prototype.update=function(){this._count++;this._lastTime=(new Date).getTime()};MO.RTimer=new MO.RTimer;MO.Timer=MO.RTimer;MO.EFrustumPlane=new function(){this.Near=0;this.Far=1;this.Left=2;this.Right=3;this.Top=4;this.Bottom=5;this.Count=6;return this};
MO.SColor4=function(a,b,d,e){this.red=a?a:0;this.green=b?b:0;this.blue=d?d:0;this.alpha=e?e:1;this.assign=MO.SColor4_assign;this.assignPower=MO.SColor4_assignPower;this.set=MO.SColor4_set;this.setInteger=MO.SColor4_setInteger;this.setIntAlpha=MO.SColor4_setIntAlpha;this.setHex=MO.SColor4_setHex;this.serialize=MO.SColor4_serialize;this.unserialize=MO.SColor4_unserialize;this.unserialize3=MO.SColor4_unserialize3;this.saveConfig=MO.SColor4_saveConfig;this.savePower=MO.SColor4_savePower;this.copyArray=
MO.SColor4_copyArray;this.toString=MO.SColor4_toString;this.dispose=MO.SColor4_dispose;return this};MO.SColor4_assign=function(a){this.red=a.red;this.green=a.green;this.blue=a.blue;this.alpha=a.alpha};MO.SColor4_assignPower=function(a){this.red=a.red*a.alpha;this.green=a.green*a.alpha;this.blue=a.blue*a.alpha;this.alpha=a.alpha};MO.SColor4_set=function(a,b,d,e){this.red=a;this.green=b;this.blue=d;this.alpha=e};
MO.SColor4_setInteger=function(a){this.red=(a>>16&255)/255;this.green=(a>>8&255)/255;this.blue=(a&255)/255;this.alpha=(a>>24&255)/255};MO.SColor4_setIntAlpha=function(a,b){this.red=(a>>16&255)/255;this.green=(a>>8&255)/255;this.blue=(a&255)/255;this.alpha=b};
MO.SColor4_setHex=function(a){0==a.indexOf("#")&&(a=a.substring(1));0==a.indexOf("0x")&&(a=a.substring(2));if(6==a.length)this.red=MO.Lang.Hex.parse(a.substring(0,2))/255,this.green=MO.Lang.Hex.parse(a.substring(2,4))/255,this.blue=MO.Lang.Hex.parse(a.substring(4,6))/255;else throw new MO.TError(this,"Invalid value.");};MO.SColor4_serialize=function(a){a.writeFloat(this.red);a.writeFloat(this.green);a.writeFloat(this.blue);a.writeFloat(this.alpha)};
MO.SColor4_unserialize=function(a){this.red=a.readFloat();this.green=a.readFloat();this.blue=a.readFloat();this.alpha=a.readFloat()};MO.SColor4_unserialize3=function(a){this.red=a.readFloat();this.green=a.readFloat();this.blue=a.readFloat();this.alpha=1};MO.SColor4_saveConfig=function(a){a.setFloat("r",this.red);a.setFloat("g",this.green);a.setFloat("b",this.blue);a.setFloat("a",this.alpha)};
MO.SColor4_savePower=function(a){a.setFloat("r",this.red);a.setFloat("g",this.green);a.setFloat("b",this.blue);a.setFloat("power",this.alpha)};MO.SColor4_copyArray=function(a,b){a[b++]=this.red;a[b++]=this.green;a[b++]=this.blue;a[b++]=this.alpha;return 4};MO.SColor4_toString=function(){return MO.Lang.Float.format(this.red)+","+MO.Lang.Float.format(this.green)+","+MO.Lang.Float.format(this.blue)+","+MO.Lang.Float.format(this.alpha)};
MO.SColor4_dispose=function(){this.alpha=this.blue=this.green=this.red=null};
MO.SCorners=function(){this.blue=this.green=this.red=0;this.alpha=1;this.assign=MO.SCorners_assign;this.assignPower=MO.SCorners_assignPower;this.set=MO.SCorners_set;this.serialize=MO.SCorners_serialize;this.unserialize=MO.SCorners_unserialize;this.unserialize3=MO.SCorners_unserialize3;this.saveConfig=MO.SCorners_saveConfig;this.savePower=MO.SCorners_savePower;this.copyArray=MO.SCorners_copyArray;this.toString=MO.SCorners_toString;return this};
MO.SCorners_assign=function(a){this.red=a.red;this.green=a.green;this.blue=a.blue;this.alpha=a.alpha};MO.SCorners_assignPower=function(a){this.red=a.red*a.alpha;this.green=a.green*a.alpha;this.blue=a.blue*a.alpha;this.alpha=a.alpha};MO.SCorners_set=function(a,b,d,e){this.red=a;this.green=b;this.blue=d;this.alpha=e};MO.SCorners_serialize=function(a){a.writeFloat(this.red);a.writeFloat(this.green);a.writeFloat(this.blue);a.writeFloat(this.alpha)};
MO.SCorners_unserialize=function(a){this.red=a.readFloat();this.green=a.readFloat();this.blue=a.readFloat();this.alpha=a.readFloat()};MO.SCorners_unserialize3=function(a){this.red=a.readFloat();this.green=a.readFloat();this.blue=a.readFloat();this.alpha=1};MO.SCorners_saveConfig=function(a){a.setFloat("r",this.red);a.setFloat("g",this.green);a.setFloat("b",this.blue);a.setFloat("a",this.alpha)};
MO.SCorners_savePower=function(a){a.setFloat("r",this.red);a.setFloat("g",this.green);a.setFloat("b",this.blue);a.setFloat("power",this.alpha)};MO.SCorners_copyArray=function(a,b){a[b++]=this.red;a[b++]=this.green;a[b++]=this.blue;a[b++]=this.alpha;return 4};MO.SCorners_toString=function(){return MO.Lang.Float.format(this.red)+","+MO.Lang.Float.format(this.green)+","+MO.Lang.Float.format(this.blue)+","+MO.Lang.Float.format(this.alpha)};
MO.SFrustum=function(){this.center=new MO.SPoint3;this.maxZ=this.minZ=this.maxY=this.minY=this.maxX=this.minX=this.radius=null;this.points=Array(24);this.coners=Array(24);this.updateCenter=MO.SFrustum_updateCenter;this.update=MO.SFrustum_update;this.updateFlat=MO.SFrustum_updateFlat;return this};
MO.SFrustum_updateCenter=function(){var a=this.coners;this.minX=this.minY=this.minZ=Number.MAX_VALUE;this.maxX=this.maxY=this.maxZ=-Number.MAX_VALUE;for(var b=0;24>b;){var d=a[b++];d<this.minX&&(this.minX=d);d>this.maxX&&(this.maxX=d);d=a[b++];d<this.minY&&(this.minY=d);d>this.maxY&&(this.maxY=d);d=a[b++];d<this.minZ&&(this.minZ=d);d>this.maxZ&&(this.maxZ=d)}this.center.x=.5*(this.minX+this.maxX);this.center.y=.5*(this.minY+this.maxY);this.center.z=.5*(this.minZ+this.maxZ);a=this.maxX-this.minX;b=
this.maxY-this.minY;d=this.maxZ-this.minZ;this.radius=.5*Math.sqrt(a*a+b*b+d*d)};MO.SFrustum_update=function(a,b,d,e,f,h,k,q){d=b/d;h=Math.tan(MO.Const.DEGREE_RATE*a*.5);a=e*h;b=a*d;h*=f;k=h*d;d=this.points;d[0]=-b;d[1]=a;d[2]=e;d[3]=b;d[4]=a;d[5]=e;d[6]=b;d[7]=-a;d[8]=e;d[9]=-b;d[10]=-a;d[11]=e;d[12]=-k;d[13]=h;d[14]=f;d[15]=k;d[16]=h;d[17]=f;d[18]=k;d[19]=-h;d[20]=f;d[21]=-k;d[22]=-h;d[23]=f;e=MO.Lang.Math.matrix;e.assign(q);e.invert();e.transform(this.coners,d,8);this.updateCenter()};
MO.SFrustum_updateFlat=function(a,b,d,e,f,h,k,q){b/=d;e*=k;f*=h;k=Math.tan(MO.Const.DEGREE_RATE*a*.5);a=e*k;h=a*b;k*=f;d=k*b;b=this.points;b[0]=-h;b[1]=a;b[2]=e;b[3]=h;b[4]=a;b[5]=e;b[6]=h;b[7]=-a;b[8]=e;b[9]=-h;b[10]=-a;b[11]=e;b[12]=-d;b[13]=k;b[14]=f;b[15]=d;b[16]=k;b[17]=f;b[18]=d;b[19]=-k;b[20]=f;b[21]=-d;b[22]=-k;b[23]=f;e=MO.Lang.Math.matrix;e.assign(q);e.invert();e.transform(this.coners,0,b,0,8);this.coners[1]=0;this.coners[4]=0;this.coners[7]=0;this.coners[10]=0;this.coners[13]=0;this.coners[16]=
0;this.coners[19]=0;this.coners[22]=0;this.updateCenter()};MO.SFrustumPlanes=function(){this.planes=[];this.containsPoint=MO.SFrustumPlanes_containsPoint;this.containsCube=MO.SFrustumPlanes_containsCube;this.containsRectangle=MO.SFrustumPlanes_containsRectangle;this.containsCorners=MO.SFrustumPlanes_containsCorners;this.containsSphere=MO.SFrustumPlanes_containsSphere;this.updateVision=MO.SFrustumPlanes_updateVision;for(var a=0;a<MO.EFrustumPlane.Count;a++)this.planes.push(new MO.SPlane);return this};
MO.SFrustumPlanes_containsPoint=function(a,b,d){for(var e=this.planes,f=0;f<MO.EFrustumPlane.Count;f++)if(0>e[n].dot(a,b,d))return!1;return!0};MO.SFrustumPlanes_containsCube=function(a,b,d,e){e=this.planes;for(var f=0;f<MO.EFrustumPlane.Count;f++){var h=e[n];if(!(0<=h.dot(a-l,b-l,d-l)||0<=h.dot(a+l,b-l,d-l)||0<=h.dot(a-l,b+l,d-l)||0<=h.dot(a+l,b+l,d-l)||0<=h.dot(a-l,b-l,d+l)||0<=h.dot(a+l,b-l,d+l)||0<=h.dot(a-l,b+l,d+l)||0<=h.dot(a+l,b+l,d+l)))return!1}return!0};
MO.SFrustumPlanes_containsRectangle=function(a,b,d,e,f,h){for(var k=this.planes,q=0;q<MO.EFrustumPlane.Count;q++){var w=k[n];if(!(0<=w.dot(a-e,b-f,d-h)||0<=w.dot(a+e,b-f,d-h)||0<=w.dot(a-e,b+f,d-h)||0<=w.dot(a+e,b+f,d-h)||0<=w.dot(a-e,b-f,d+h)||0<=w.dot(a+e,b-f,d+h)||0<=w.dot(a-e,b+f,d+h)||0<=w.dot(a+e,b+f,d+h)))return!1}return!0};
MO.SFrustumPlanes_containsCorners=function(a){for(var b=this.planes,d=MO.EFrustumPlane.Count-1;0<=d;d--){var e=b[d];if(!(0<=e.dot(a[0],a[1],a[2])||0<=e.dot(a[3],a[4],a[5])||0<=e.dot(a[6],a[7],a[8])||0<=e.dot(a[9],a[10],a[11])||0<=e.dot(a[12],a[13],a[14])||0<=e.dot(a[15],a[16],a[17])||0<=e.dot(a[18],a[19],a[20])||0<=e.dot(a[21],a[22],a[23])))return!1}return!0};MO.SFrustumPlanes_containsSphere=function(a,b,d,e){for(var f=this.planes,h=0;h<MO.EFrustumPlane.Count;h++)if(f[n].dot(a,b,d)<-e)return!1;return!0};
MO.SFrustumPlanes_updateVision=function(a){var b=this.planes,d=b[MO.EFrustumPlane.Near];d.a=a[3]+a[2];d.b=a[7]+a[6];d.c=a[11]+a[10];d.d=a[15]+a[14];d.normalize();d=b[MO.EFrustumPlane.Far];d.a=a[3]-a[2];d.b=a[7]-a[6];d.c=a[11]-a[10];d.d=a[15]-a[14];d.normalize();d=b[MO.EFrustumPlane.Left];d.a=a[3]-a[0];d.b=a[7]-a[4];d.c=a[11]-a[8];d.d=a[15]-a[12];d.normalize();d=b[MO.EFrustumPlane.Right];d.a=a[3]+a[0];d.b=a[7]+a[4];d.c=a[11]+a[8];d.d=a[15]+a[12];d.normalize();d=b[MO.EFrustumPlane.Top];d.a=a[3]-a[1];
d.b=a[7]-a[5];d.c=a[11]-a[9];d.d=a[15]-a[13];d.normalize();b=b[MO.EFrustumPlane.Bottom];b.a=a[3]+a[1];b.b=a[7]+a[5];b.c=a[11]+a[9];b.d=a[15]+a[13];b.normalize()};
MO.SMatrix3d=function(){MO.SMatrix4x4.call(this);this._dirty=!1;this.rz=this.ry=this.rx=this.tz=this.ty=this.tx=0;this.sz=this.sy=this.sx=1;this.isIdentity=MO.SMatrix3d_isIdentity;this.identity=MO.SMatrix3d_identity;this.setTranslate=MO.SMatrix3d_setTranslate;this.setRotation=MO.SMatrix3d_setRotation;this.setScale=MO.SMatrix3d_setScale;this.setScaleAll=MO.SMatrix3d_setScaleAll;this.set=MO.SMatrix3d_set;this.setAll=MO.SMatrix3d_setAll;this.equals=MO.SMatrix3d_equals;this.assign=MO.SMatrix3d_assign;
this.attach=MO.SMatrix3d_attach;this.append=MO.SMatrix3d_append;this.updateForce=MO.SMatrix3d_updateForce;this.update=MO.SMatrix3d_update;this.merge=MO.SMatrix3d_merge;this.serialize=MO.SMatrix3d_serialize;this.unserialize=MO.SMatrix3d_unserialize;this.saveConfig=MO.SMatrix3d_saveConfig;this.identity();return this};MO.SMatrix3d_isIdentity=function(){return 0!=this.tx||0!=this.ty||0!=this.tz||0!=this.rx||0!=this.ry||0!=this.rz||1!=this.sx||1!=this.sy||1!=this.sz?!1:this.isIdentityData()};
MO.SMatrix3d_identity=function(){this.rx=this.ry=this.rz=this.tx=this.ty=this.tz=0;this.sx=this.sy=this.sz=1;return this.identityData()};MO.SMatrix3d_setTranslate=function(a,b,d){this.tx=a;this.ty=b;this.tz=d;this._dirty=!0};MO.SMatrix3d_setRotation=function(a,b,d){this.rx=a;this.ry=b;this.rz=d;this._dirty=!0};MO.SMatrix3d_setScale=function(a,b,d){this.sx=a;this.sy=b;this.sz=d;this._dirty=!0};MO.SMatrix3d_setScaleAll=function(a){this.sz=this.sy=this.sx=a;this._dirty=!0};
MO.SMatrix3d_set=function(a,b,d){this.tx=a.x;this.ty=a.y;this.tz=a.z;this.rx=b.x;this.ry=b.y;this.rz=b.z;this.sx=d.x;this.sy=d.y;this.sz=d.z;this._dirty=!0};MO.SMatrix3d_setAll=function(a,b,d,e,f,h,k,q,w){this.tx=a;this.ty=b;this.tz=d;this.rx=e;this.ry=f;this.rz=h;this.sx=k;this.sy=q;this.sz=w;this._dirty=!0};MO.SMatrix3d_equals=function(a){return this.equalsData(a._data)};
MO.SMatrix3d_assign=function(a){this.tx=a.tx;this.ty=a.ty;this.tz=a.tz;this.rx=a.rx;this.ry=a.ry;this.rz=a.rz;this.sx=a.sx;this.sy=a.sy;this.sz=a.sz;this.assignData(a._data)};MO.SMatrix3d_attach=function(a){this.tx=a.tx;this.ty=a.ty;this.tz=a.tz;this.rx=a.rx;this.ry=a.ry;this.rz=a.rz;this.sx=a.sx;this.sy=a.sy;this.sz=a.sz;return this.attachData(a._data)};MO.SMatrix3d_append=function(a){this.appendData(a._data)};
MO.SMatrix3d_updateForce=function(){var a=this._data,b=Math.sin(this.rx),d=Math.cos(this.rx),e=Math.sin(this.ry),f=Math.cos(this.ry),h=Math.sin(this.rz),k=Math.cos(this.rz);a[0]=f*k*this.sx;a[1]=f*h*this.sx;a[2]=-e*this.sx;a[3]=0;a[4]=(b*e*k-d*h)*this.sy;a[5]=(b*e*h+d*k)*this.sy;a[6]=b*f*this.sy;a[7]=0;a[8]=(d*e*k+b*h)*this.sz;a[9]=(d*e*h-b*k)*this.sz;a[10]=d*f*this.sz;a[11]=0;a[12]=this.tx;a[13]=this.ty;a[14]=this.tz;a[15]=1};
MO.SMatrix3d_update=function(){this._dirty&&(this.updateForce(),this._dirty=!1)};MO.SMatrix3d_merge=function(a,b){this.tx=a.tx+b.tx;this.ty=a.ty+b.ty;this.tz=a.tz+b.tz;this.rx=a.rx+b.rx;this.ry=a.ry+b.ry;this.rz=a.rz+b.rz;this.sx=a.sx*b.sx;this.sy=a.sy*b.sy;this.sz=a.sz*b.sz;this.updateForce()};
MO.SMatrix3d_serialize=function(a){a.writeFloat(this.tx);a.writeFloat(this.ty);a.writeFloat(this.tz);a.writeFloat(this.rx);a.writeFloat(this.ry);a.writeFloat(this.rz);a.writeFloat(this.sx);a.writeFloat(this.sy);a.writeFloat(this.sz)};MO.SMatrix3d_unserialize=function(a){this.tx=a.readFloat();this.ty=a.readFloat();this.tz=a.readFloat();this.rx=a.readFloat();this.ry=a.readFloat();this.rz=a.readFloat();this.sx=a.readFloat();this.sy=a.readFloat();this.sz=a.readFloat();this.updateForce()};
MO.SMatrix3d_saveConfig=function(a){a.set("tx",MO.Lang.Float.format(this.tx));a.set("ty",MO.Lang.Float.format(this.ty));a.set("tz",MO.Lang.Float.format(this.tz));a.set("rx",MO.Lang.Float.format(this.rx));a.set("ry",MO.Lang.Float.format(this.ry));a.set("rz",MO.Lang.Float.format(this.rz));a.set("sx",MO.Lang.Float.format(this.sx));a.set("sy",MO.Lang.Float.format(this.sy));a.set("sz",MO.Lang.Float.format(this.sz))};
MO.SMatrix3x3=function(){this._data=Array(9);this.data=MO.SMatrix3x3_data;this.equalsData=MO.SMatrix3x3_equalsData;this.assignData=MO.SMatrix3x3_assignData;this.appendData=MO.SMatrix3x3_appendData;this.rotationX=MO.SMatrix3x3_rotationX;this.rotationY=MO.SMatrix3x3_rotationY;this.rotationZ=MO.SMatrix3x3_rotationZ;this.rotation=MO.SMatrix3x3_rotation;this.invert=MO.SMatrix3x3_invert;this.transform=MO.SMatrix3x3_transform;this.transformPoint3=MO.SMatrix3x3_transformPoint3;this.build=MO.SMatrix3x3_build;
this.writeData=MO.SMatrix3x3_writeData;this.toString=MO.SMatrix3x3_toString;return this};MO.SMatrix3x3_data=function(){return this._data};MO.SMatrix3x3_equalsData=function(a){for(var b=this._data,d=0;9>d;d++)if(b[d]!=a[d])return!1;return!0};MO.SMatrix3x3_assignData=function(a){for(var b=this._data,d=0;9>d;d++)b[d]=a[d]};
MO.SMatrix3x3_appendData=function(a){var b=this._data,d=b[0]*a[1]+b[1]*a[4]+b[2]*a[7],e=b[0]*a[2]+b[1]*a[5]+b[2]*a[8],f=b[3]*a[0]+b[4]*a[3]+b[5]*a[6],h=b[3]*a[1]+b[4]*a[4]+b[5]*a[7],k=b[3]*a[2]+b[4]*a[5]+b[5]*a[8],q=b[6]*a[0]+b[7]*a[3]+b[8]*a[6],w=b[6]*a[1]+b[7]*a[4]+b[8]*a[7],x=b[6]*a[2]+b[7]*a[5]+b[8]*a[8];b[0]=b[0]*a[0]+b[1]*a[3]+b[2]*a[6];b[1]=d;b[2]=e;b[3]=f;b[4]=h;b[5]=k;b[6]=q;b[7]=w;b[8]=x};
MO.SMatrix3x3_rotationX=function(a){var b=Math.sin(a);a=Math.cos(a);var d=MO.Lang.Math.value9;d[0]=1;d[1]=0;d[2]=0;d[3]=0;d[4]=a;d[5]=b;d[6]=0;d[7]=-b;d[8]=a;this.appendData(d)};MO.SMatrix3x3_rotationY=function(a){var b=Math.sin(a);a=Math.cos(a);var d=RMath.value9;d[0]=a;d[1]=0;d[2]=b;d[3]=0;d[4]=1;d[5]=0;d[6]=-b;d[7]=0;d[8]=a;this.appendData(d)};MO.SMatrix3x3_rotationZ=function(a){var b=Math.sin(a);a=Math.cos(a);var d=RMath.value9;d[0]=a;d[1]=b;d[2]=0;d[3]=-b;d[4]=a;d[5]=1;d[6]=0;d[7]=0;d[8]=1;this.appendData(d)};
MO.SMatrix3x3_rotation=function(a,b,d){var e=Math.sin(a);a=Math.cos(a);var f=Math.sin(b);b=Math.cos(b);var h=Math.sin(d);d=Math.cos(d);var k=RMath.value9;k[0]=b*d;k[1]=b*h;k[2]=-f;k[3]=e*f*d-a*h;k[4]=e*f*h+a*d;k[5]=e*b;k[6]=a*f*d+e*h;k[7]=a*f*h-e*a;k[8]=a*b;this.appendData(k)};
MO.SMatrix3x3_invert=function(){var a=this._data,b=RValue.value9;b[0]=a[4]*a[8]-a[5]*a[7];b[1]=a[2]*a[7]-a[1]*a[8];b[2]=a[1]*a[5]-a[2]*a[4];b[3]=a[5]*a[6]-a[3]*a[8];b[4]=a[0]*a[8]-a[2]*a[6];b[5]=a[2]*a[3]-a[0]*a[5];b[6]=a[3]*a[7]-a[4]*a[6];b[7]=a[1]*a[6]-a[0]*a[7];b[8]=a[0]*a[4]-a[1]*a[3];var d=a[0]*b[0]+a[1]*b[3]+a[2]*b[6];if(0==d)return!1;for(var d=1/d,e=0;9>e;e++)a[e]=b[e]*d;return!0};
MO.SMatrix3x3_transform=function(a,b,d){for(var e=this._data,f=0;f<d;f++){var h=(f<<1)+f;a[h]=b[h]*e[0]+b[h+1]*e[3]+b[h+2]*e[6];a[h+1]=b[h]*e[1]+b[h+1]*e[4]+b[h+2]*e[7];a[h+2]=b[h]*e[2]+b[h+1]*e[5]+b[h+2]*e[8]}};MO.SMatrix3x3_transformPoint3=function(a,b){var d=this._data,e=a.x*d[0]+a.y*d[3]+a.z*d[6],f=a.x*d[1]+a.y*d[4]+a.z*d[7],d=a.x*d[2]+a.y*d[5]+a.z*d[8],h=null,h=b?b:new SPoint3;h.set(e,f,d);return h};
MO.SMatrix3x3_build=function(a){var b=this._data,d=a.x*a.x,e=a.y*a.y,f=a.z*a.z,h=a.x*a.y,k=a.x*a.z,q=a.y*a.z,w=a.w*a.x,x=a.w*a.y;a=a.w*a.z;b[0]=1-2*(e+f);b[1]=2*(h-a);b[2]=2*(k+x);b[3]=2*(h+a);b[4]=1-2*(d+f);b[5]=2*(q-w);b[6]=2*(k-x);b[7]=2*(q+w);b[8]=1-2*(d+e)};MO.SMatrix3x3_writeData=function(a,b){var d=this._data;a[b++]=d[0];a[b++]=d[3];a[b++]=d[6];a[b++]=d[1];a[b++]=d[4];a[b++]=d[7];a[b++]=d[2];a[b++]=d[5];a[b++]=d[8]};
MO.SMatrix3x3_toString=function(){for(var a=this._data,b=new MO.TString,d=0;3>d;d++){0<d&&b.append("|");for(var e=0;3>e;e++){var f=a[3*d+e];0<e&&b.append(",");b.append(MO.Lang.Float.format(f,0,null,3,null))}}return b.flush()};
MO.SMatrix4x4=function(){this._data=Array(16);this.data=MO.SMatrix4x4_data;this.isIdentityData=MO.SMatrix4x4_isIdentityData;this.identityData=MO.SMatrix4x4_identityData;this.equalsData=MO.SMatrix4x4_equalsData;this.assignData=MO.SMatrix4x4_assignData;this.attachData=MO.SMatrix4x4_attachData;this.appendData=MO.SMatrix4x4_appendData;this.addTranslate=MO.SMatrix4x4_addTranslate;this.addRotationX=MO.SMatrix4x4_addRotationX;this.addRotationY=MO.SMatrix4x4_addRotationY;this.addRotationZ=MO.SMatrix4x4_addRotationZ;
this.addRotation=MO.SMatrix4x4_addRotation;this.addScale=MO.SMatrix4x4_addScale;this.invert=MO.SMatrix4x4_invert;this.transform=MO.SMatrix4x4_transform;this.transformPoint3=MO.SMatrix4x4_transformPoint3;this.buildQuaternion=MO.SMatrix4x4_buildQuaternion;this.build=MO.SMatrix4x4_build;this.writeData=MO.SMatrix4x4_writeData;this.writeData4x3=MO.SMatrix4x4_writeData4x3;this.toString=MO.SMatrix4x4_toString;return this};MO.SMatrix4x4_data=function(){return this._data};
MO.SMatrix4x4_isIdentityData=function(){for(var a=this._data,b=MO.Const.identity4x4,d=0;16>d;d++)if(a[d]!=b[d])return!1;return!0};MO.SMatrix4x4_identityData=function(){for(var a=this._data,b=MO.Const.identity4x4,d=0;16>d;d++)a[d]=b[d];return this};MO.SMatrix4x4_equalsData=function(a){for(var b=this._data,d=0;16>d;d++)if(b[d]!=a[d])return!1;return!0};MO.SMatrix4x4_assignData=function(a){for(var b=this._data,d=0;16>d;d++)b[d]=a[d]};
MO.SMatrix4x4_attachData=function(a){for(var b=!1,d=this._data,e=0;16>e;e++){var f=a[e];b||d[e]!=f&&(b=!0);d[e]=f}return b};
MO.SMatrix4x4_appendData=function(a){var b=this._data,d=b[0]*a[1]+b[1]*a[5]+b[2]*a[9]+b[3]*a[13],e=b[0]*a[2]+b[1]*a[6]+b[2]*a[10]+b[3]*a[14],f=b[0]*a[3]+b[1]*a[7]+b[2]*a[11]+b[3]*a[15],h=b[4]*a[0]+b[5]*a[4]+b[6]*a[8]+b[7]*a[12],k=b[4]*a[1]+b[5]*a[5]+b[6]*a[9]+b[7]*a[13],q=b[4]*a[2]+b[5]*a[6]+b[6]*a[10]+b[7]*a[14],w=b[4]*a[3]+b[5]*a[7]+b[6]*a[11]+b[7]*a[15],x=b[8]*a[0]+b[9]*a[4]+b[10]*a[8]+b[11]*a[12],y=b[8]*a[1]+b[9]*a[5]+b[10]*a[9]+b[11]*a[13],z=b[8]*a[2]+b[9]*a[6]+b[10]*a[10]+b[11]*a[14],A=b[8]*
a[3]+b[9]*a[7]+b[10]*a[11]+b[11]*a[15],B=b[12]*a[0]+b[13]*a[4]+b[14]*a[8]+b[15]*a[12],D=b[12]*a[1]+b[13]*a[5]+b[14]*a[9]+b[15]*a[13],E=b[12]*a[2]+b[13]*a[6]+b[14]*a[10]+b[15]*a[14],C=b[12]*a[3]+b[13]*a[7]+b[14]*a[11]+b[15]*a[15];b[0]=b[0]*a[0]+b[1]*a[4]+b[2]*a[8]+b[3]*a[12];b[1]=d;b[2]=e;b[3]=f;b[4]=h;b[5]=k;b[6]=q;b[7]=w;b[8]=x;b[9]=y;b[10]=z;b[11]=A;b[12]=B;b[13]=D;b[14]=E;b[15]=C};
MO.SMatrix4x4_addTranslate=function(a,b,d){var e=MO.Lang.Array.array16;e[0]=1;e[1]=0;e[2]=0;e[3]=0;e[4]=0;e[5]=1;e[6]=0;e[7]=0;e[8]=0;e[9]=0;e[10]=1;e[11]=0;e[12]=a;e[13]=b;e[14]=d;e[15]=1;this.appendData(e)};MO.SMatrix4x4_addRotationX=function(a){var b=Math.sin(a);a=Math.cos(a);var d=MO.Lang.Array.array16;d[0]=1;d[1]=0;d[2]=0;d[3]=0;d[4]=0;d[5]=a;d[6]=b;d[7]=0;d[8]=0;d[9]=-b;d[10]=a;d[11]=0;d[12]=0;d[13]=0;d[14]=0;d[15]=1;this.appendData(d)};
MO.SMatrix4x4_addRotationY=function(a){var b=Math.sin(a);a=Math.cos(a);var d=MO.Lang.Array.array16;d[0]=a;d[1]=0;d[2]=b;d[3]=0;d[4]=0;d[5]=1;d[6]=0;d[7]=0;d[8]=-b;d[9]=0;d[10]=a;d[11]=0;d[12]=0;d[13]=0;d[14]=0;d[15]=1;this.appendData(d)};MO.SMatrix4x4_addRotationZ=function(a){var b=Math.sin(a);a=Math.cos(a);var d=MO.Lang.Array.array16;d[0]=a;d[1]=b;d[2]=0;d[3]=0;d[4]=-b;d[5]=a;d[6]=1;d[7]=0;d[8]=0;d[9]=0;d[10]=1;d[11]=0;d[12]=0;d[13]=0;d[14]=0;d[15]=1;this.appendData(d)};
MO.SMatrix4x4_addRotation=function(a,b,d){var e=Math.sin(a);a=Math.cos(a);var f=Math.sin(b);b=Math.cos(b);var h=Math.sin(d);d=Math.cos(d);var k=MO.Lang.Array.array16;k[0]=b*d;k[1]=b*h;k[2]=-f;k[3]=0;k[4]=e*f*d-a*h;k[5]=e*f*h+a*d;k[6]=e*b;k[7]=0;k[8]=a*f*d+e*h;k[9]=a*f*h-e*a;k[10]=a*b;k[11]=0;k[12]=0;k[13]=0;k[14]=0;k[15]=1;this.appendData(k)};
MO.SMatrix4x4_addScale=function(a,b,d){var e=MO.Lang.Array.array16;e[0]=a;e[1]=0;e[2]=0;e[3]=0;e[4]=0;e[5]=b;e[6]=0;e[7]=0;e[8]=0;e[9]=0;e[10]=d;e[11]=0;e[12]=0;e[13]=0;e[14]=0;e[15]=1;this.appendData(e)};
MO.SMatrix4x4_invert=function(){var a=this._data,b=MO.Lang.Array.array16;b[0]=a[5]*a[10]*a[15]-a[5]*a[11]*a[14]-a[9]*a[6]*a[15]+a[9]*a[7]*a[14]+a[13]*a[6]*a[11]-a[13]*a[7]*a[10];b[4]=-(a[4]*a[10]*a[15])+a[4]*a[11]*a[14]+a[8]*a[6]*a[15]-a[8]*a[7]*a[14]-a[12]*a[6]*a[11]+a[12]*a[7]*a[10];b[8]=a[4]*a[9]*a[15]-a[4]*a[11]*a[13]-a[8]*a[5]*a[15]+a[8]*a[7]*a[13]+a[12]*a[5]*a[11]-a[12]*a[7]*a[9];b[12]=-(a[4]*a[9]*a[14])+a[4]*a[10]*a[13]+a[8]*a[5]*a[14]-a[8]*a[6]*a[13]-a[12]*a[5]*a[10]+a[12]*a[6]*a[9];b[1]=
-(a[1]*a[10]*a[15])+a[1]*a[11]*a[14]+a[9]*a[2]*a[15]-a[9]*a[3]*a[14]-a[13]*a[2]*a[11]+a[13]*a[3]*a[10];b[5]=a[0]*a[10]*a[15]-a[0]*a[11]*a[14]-a[8]*a[2]*a[15]+a[8]*a[3]*a[14]+a[12]*a[2]*a[11]-a[12]*a[3]*a[10];b[9]=-(a[0]*a[9]*a[15])+a[0]*a[11]*a[13]+a[8]*a[1]*a[15]-a[8]*a[3]*a[13]-a[12]*a[1]*a[11]+a[12]*a[3]*a[9];b[13]=a[0]*a[9]*a[14]-a[0]*a[10]*a[13]-a[8]*a[1]*a[14]+a[8]*a[2]*a[13]+a[12]*a[1]*a[10]-a[12]*a[2]*a[9];b[2]=a[1]*a[6]*a[15]-a[1]*a[7]*a[14]-a[5]*a[2]*a[15]+a[5]*a[3]*a[14]+a[13]*a[2]*a[7]-
a[13]*a[3]*a[6];b[6]=-(a[0]*a[6]*a[15])+a[0]*a[7]*a[14]+a[4]*a[2]*a[15]-a[4]*a[3]*a[14]-a[12]*a[2]*a[7]+a[12]*a[3]*a[6];b[10]=a[0]*a[5]*a[15]-a[0]*a[7]*a[13]-a[4]*a[1]*a[15]+a[4]*a[3]*a[13]+a[12]*a[1]*a[7]-a[12]*a[3]*a[5];b[14]=-(a[0]*a[5]*a[14])+a[0]*a[6]*a[13]+a[4]*a[1]*a[14]-a[4]*a[2]*a[13]-a[12]*a[1]*a[6]+a[12]*a[2]*a[5];b[3]=-(a[1]*a[6]*a[11])+a[1]*a[7]*a[10]+a[5]*a[2]*a[11]-a[5]*a[3]*a[10]-a[9]*a[2]*a[7]+a[9]*a[3]*a[6];b[7]=a[0]*a[6]*a[11]-a[0]*a[7]*a[10]-a[4]*a[2]*a[11]+a[4]*a[3]*a[10]+a[8]*
a[2]*a[7]-a[8]*a[3]*a[6];b[11]=-(a[0]*a[5]*a[11])+a[0]*a[7]*a[9]+a[4]*a[1]*a[11]-a[4]*a[3]*a[9]-a[8]*a[1]*a[7]+a[8]*a[3]*a[5];b[15]=a[0]*a[5]*a[10]-a[0]*a[6]*a[9]-a[4]*a[1]*a[10]+a[4]*a[2]*a[9]+a[8]*a[1]*a[6]-a[8]*a[2]*a[5];var d=a[0]*b[0]+a[1]*b[4]+a[2]*b[8]+a[3]*b[12];if(0==d)return!1;for(var d=1/d,e=0;16>e;e++)a[e]=b[e]*d;return!0};
MO.SMatrix4x4_transform=function(a,b,d,e,f){for(var h=this._data,k=0;k<f;k++){var q=d[e++],w=d[e++],x=d[e++];a[b++]=q*h[0]+w*h[4]+x*h[8]+h[12];a[b++]=q*h[1]+w*h[5]+x*h[9]+h[13];a[b++]=q*h[2]+w*h[6]+x*h[10]+h[14]}};MO.SMatrix4x4_transformPoint3=function(a,b){var d=this._data,e=a.x*d[0]+a.y*d[4]+a.z*d[8]+d[12],f=a.x*d[1]+a.y*d[5]+a.z*d[9]+d[13],d=a.x*d[2]+a.y*d[6]+a.z*d[10]+d[14],h=null,h=b?b:new MO.SPoint3;h.set(e,f,d);return h};
MO.SMatrix4x4_build=function(a,b,d){var e=this._data,f=b.x*b.x,h=b.y*b.y,k=b.z*b.z,q=b.x*b.y,w=b.x*b.z,x=b.y*b.z,y=b.w*b.x,z=b.w*b.y;b=b.w*b.z;e[0]=(1-2*(h+k))*d.x;e[1]=2*(q-b)*d.x;e[2]=2*(w+z)*d.x;e[3]=0;e[4]=2*(q+b)*d.y;e[5]=(1-2*(f+k))*d.y;e[6]=2*(x-y)*d.y;e[7]=0;e[8]=2*(w-z)*d.z;e[9]=2*(x+y)*d.z;e[10]=(1-2*(f+h))*d.z;e[11]=0;e[12]=a.x;e[13]=a.y;e[14]=a.z;e[15]=1};
MO.SMatrix4x4_buildQuaternion=function(a){var b=this._data,d=a.x*a.x,e=a.y*a.y,f=a.z*a.z,h=a.x*a.y,k=a.x*a.z,q=a.y*a.z,w=a.w*a.x,x=a.w*a.y;a=a.w*a.z;b[0]=1-2*(e+f);b[1]=2*(h-a);b[2]=2*(k+x);b[3]=0;b[4]=2*(h+a);b[5]=1-2*(d+f);b[6]=2*(q-w);b[7]=0;b[8]=2*(k-x);b[9]=2*(q+w);b[10]=1-2*(d+e);b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1};
MO.SMatrix4x4_writeData=function(a,b){var d=this._data;a[b++]=d[0];a[b++]=d[4];a[b++]=d[8];a[b++]=d[12];a[b++]=d[1];a[b++]=d[5];a[b++]=d[9];a[b++]=d[13];a[b++]=d[2];a[b++]=d[6];a[b++]=d[10];a[b++]=d[14];a[b++]=d[3];a[b++]=d[7];a[b++]=d[11];a[b++]=d[15]};MO.SMatrix4x4_writeData4x3=function(a,b){var d=this._data;a[b++]=d[0];a[b++]=d[4];a[b++]=d[8];a[b++]=d[12];a[b++]=d[1];a[b++]=d[5];a[b++]=d[9];a[b++]=d[13];a[b++]=d[2];a[b++]=d[6];a[b++]=d[10];a[b++]=d[14]};
MO.SMatrix4x4_toString=function(){for(var a=this._data,b=new MO.TString,d=0;4>d;d++){0<d&&b.append("|");for(var e=0;4>e;e++){var f=a[4*d+e];0<e&&b.append(",");b.append(MO.Lang.Float.format(f,0,null,3,null))}}return b.flush()};
MO.SOutline2=function(){this.min=new MO.SPoint2;this.max=new MO.SPoint2;this.isEmpty=MO.SOutline2_isEmpty;this.assign=MO.SOutline2_assign;this.setMin=MO.SOutline2_setMin;this.setMax=MO.SOutline2_setMax;this.set=MO.SOutline2_set;this.mergeMin=MO.SOutline2_mergeMin;this.mergeMax=MO.SOutline2_mergeMax;this.mergeMax2=MO.SOutline2_mergeMax2;this.mergePoint=MO.SOutline2_mergePoint;this.serialize=MO.SOutline2_serialize;this.unserialize=MO.SOutline2_unserialize;this.toString=MO.SOutline2_toString;return this};
MO.SOutline2_isEmpty=function(a){return this.min.isEmpty()&&this.max.isEmpty()};MO.SOutline2_assign=function(a){this.min.assign(a.min);this.max.assign(a.max)};MO.SOutline2_setMin=function(){this.min.setMax();this.max.setMin()};MO.SOutline2_setMax=function(){this.min.setMin();this.max.setMax()};MO.SOutline2_set=function(a,b,d,e,f,h){this.min.set(a,b,d);this.max.set(e,f,h)};MO.SOutline2_mergeMin=function(a){this.min.mergeMax(a.min);this.max.mergeMin(a.max)};
MO.SOutline2_mergeMax=function(a){this.min.mergeMin(a.min);this.max.mergeMax(a.max)};MO.SOutline2_mergeMax2=function(a,b){this.min.mergeMin2(a,b);this.max.mergeMax2(a,b)};MO.SOutline2_mergePoint=function(a,b,d){this.min.mergeMin3(a,b,d);this.max.mergeMax3(a,b,d)};MO.SOutline2_serialize=function(a){this.min.serialize(a);this.max.serialize(a)};MO.SOutline2_unserialize=function(a){this.min.unserialize(a);this.max.unserialize(a)};MO.SOutline2_toString=function(){return"("+this.min+")-("+this.max+")"};
MO.SOutline2d=function(){MO.SOutline2.call(this);this.center=new MO.SPoint2;this.distance=new MO.SPoint2;this.radius=0;this.points=Array(8);this.assign=MO.SOutline2d_assign;this.set=MO.SOutline2d_set;this.update=MO.SOutline2d_update;return this};MO.SOutline2d_assign=function(a){this.center.assign(a.center);this.distance.assign(a.distance);this.radius=a.radius;for(var b=0;8>b;b++)this.points[b]=a.points[b]};MO.SOutline2d_set=function(a,b,d,e){this.min.set(a,b);this.max.set(d,e);this.update()};
MO.SOutline2d_update=function(){var a=this.min,b=a.x,a=a.y,d=this.max,e=d.x,d=d.y,f=this.points;f[0]=b;f[1]=d;f[2]=e;f[3]=d;f[4]=e;f[5]=a;f[6]=b;f[7]=a;f=this.center;f.x=.5*(b+e);f.y=.5*(a+d);f=this.distance;f.x=e-b;f.y=d-a;b=e-b;a=d-a;this.radius=.5*Math.sqrt(b*b+a*a)};
MO.SOutline3=function(){this.min=new MO.SPoint3;this.max=new MO.SPoint3;this.isEmpty=MO.SOutline3_isEmpty;this.assign=MO.SOutline3_assign;this.setMin=MO.SOutline3_setMin;this.setMax=MO.SOutline3_setMax;this.set=MO.SOutline3_set;this.mergeMin=MO.SOutline3_mergeMin;this.mergeMax=MO.SOutline3_mergeMax;this.mergePoint=MO.SOutline3_mergePoint;this.serialize=MO.SOutline3_serialize;this.unserialize=MO.SOutline3_unserialize;this.toString=MO.SOutline3_toString;return this};
MO.SOutline3_isEmpty=function(a){return this.min.isEmpty()&&this.max.isEmpty()};MO.SOutline3_assign=function(a){this.min.assign(a.min);this.max.assign(a.max)};MO.SOutline3_setMin=function(){this.min.setMax();this.max.setMin()};MO.SOutline3_setMax=function(){this.min.setMin();this.max.setMax()};MO.SOutline3_set=function(a,b,d,e,f,h){this.min.set(a,b,d);this.max.set(e,f,h)};MO.SOutline3_mergeMin=function(a){this.min.mergeMax(a.min);this.max.mergeMin(a.max)};
MO.SOutline3_mergeMax=function(a){this.min.mergeMin(a.min);this.max.mergeMax(a.max)};MO.SOutline3_mergePoint=function(a,b,d){this.min.mergeMin3(a,b,d);this.max.mergeMax3(a,b,d)};MO.SOutline3_serialize=function(a){this.min.serialize(a);this.max.serialize(a)};MO.SOutline3_unserialize=function(a){this.min.unserialize(a);this.max.unserialize(a)};MO.SOutline3_toString=function(){return"("+this.min+")-("+this.max+")"};
MO.SOutline3d=function(){MO.SOutline3.call(this);this.center=new MO.SPoint3;this.distance=new MO.SPoint3;this.radius=0;this.points=Array(24);this.assign=MO.SOutline3d_assign;this.set=MO.SOutline3d_set;this.update=MO.SOutline3d_update;this.calculateFrom=MO.SOutline3d_calculateFrom;this.calculate=MO.SOutline3d_calculate;return this};MO.SOutline3d_assign=function(a){this.center.assign(a.center);this.distance.assign(a.distance);this.radius=a.radius;for(var b=0;24>b;b++)this.points[b]=a.points[b]};
MO.SOutline3d_set=function(a,b,d,e,f,h){this.min.set(a,b,d);this.max.set(e,f,h);this.update()};
MO.SOutline3d_update=function(){var a=this.min,b=a.x,d=a.y,a=a.z,e=this.max,f=e.x,h=e.y,e=e.z,k=this.points;k[0]=b;k[1]=h;k[2]=a;k[3]=f;k[4]=h;k[5]=a;k[6]=f;k[7]=d;k[8]=a;k[9]=b;k[10]=d;k[11]=a;k[12]=b;k[13]=h;k[14]=e;k[15]=f;k[16]=h;k[17]=e;k[18]=f;k[19]=d;k[20]=e;k[21]=b;k[22]=d;k[23]=e;k=this.center;k.x=.5*(b+f);k.y=.5*(d+h);k.z=.5*(a+e);k=this.distance;k.x=f-b;k.y=h-d;k.z=e-a;b=f-b;d=h-d;a=e-a;this.radius=.5*Math.sqrt(b*b+d*d+a*a)};
MO.SOutline3d_calculateFrom=function(a,b){var d=this.points;b.transform(d,0,a.points,0,8);for(var e=minY=minZ=Number.MAX_VALUE,f=maxY=maxZ=-Number.MAX_VALUE,h=0;24>h;){var k=d[h++];k<e&&(e=k);k>f&&(f=k);k=d[h++];k<minY&&(minY=k);k>maxY&&(maxY=k);k=d[h++];k<minZ&&(minZ=k);k>maxZ&&(maxZ=k)}this.min.set(e,minY,minZ);this.max.set(f,maxY,maxZ);this.update()};
MO.SOutline3d_calculate=function(a){a=viy=viz=Number.MAX_VALUE;for(var b=vay=vaz=-Number.MAX_VALUE,d=0,e=this.points;24>d;){var f=e[d++];f<a&&(a=f);f>b&&(b=f);f=e[d++];f<viy&&(viy=f);f>vay&&(vay=f);f=e[d++];f<viz&&(viz=f);f>vaz&&(vaz=f)}this.min.set(a,viy,viz);this.max.set(b,vay,vaz);this.center.x=.5*(a+b);this.center.y=.5*(viy+vay);this.center.z=.5*(viz+vaz);a=b-a;b=vay-viy;d=vaz-viz;this.radius=.5*Math.sqrt(a*a+b*b+d*d)};
MO.SPadding=function(a,b,d,e){this.left=MO.Lang.Integer.nvl(a);this.top=MO.Lang.Integer.nvl(b);this.right=MO.Lang.Integer.nvl(d);this.bottom=MO.Lang.Integer.nvl(e);this.isEmpty=MO.SPadding_isEmpty;this.reset=MO.SPadding_reset;this.assign=MO.SPadding_assign;this.set=MO.SPadding_set;this.parse=MO.SPadding_parse;this.toString=MO.SPadding_toString;this.dispose=MO.SPadding_dispose;this.dump=MO.SPadding_dump;return this};
MO.SPadding_isEmpty=function(){return 0==this.left&&0==this.top&&0==this.right&&0==this.bottom};MO.SPadding_reset=function(){this.bottom=this.right=this.top=this.left=0};MO.SPadding_assign=function(a){this.left=a.left;this.top=a.top;this.right=a.right;this.bottom=a.bottom};MO.SPadding_set=function(a,b,d,e){this.left=a;this.top=b;this.right=d;this.bottom=e};
MO.SPadding_parse=function(a){var b=a.split(",");if(4==b.length)this.left=parseInt(b[0]),this.top=parseInt(b[1]),this.right=parseInt(b[2]),this.bottom=parseInt(b[3]);else throw new MO.TError(this,"Parse value failure. (value={1})",a);};MO.SPadding_toString=function(){return this.left+","+this.top+","+this.right+","+this.bottom};MO.SPadding_dispose=function(){this.bottom=this.right=this.top=this.left=null};
MO.SPadding_dump=function(a){return MO.Class.dump(this)+" ["+this.left+","+this.top+","+this.right+","+this.bottom+"]"};MO.SPlane=function(){this.d=this.c=this.b=this.a=0;this.assign=MO.SPlane_assign;this.set=MO.SPlane_set;this.normalize=MO.SPlane_normalize;this.dot=MO.SPlane_dot;this.toString=MO.SPlane_toString;this.dump=MO.SPlane_dump;return this};MO.SPlane_assign=function(a){this.a=a.a;this.b=a.b;this.c=a.c;this.d=a.d};MO.SPlane_set=function(a,b,d,e){this.a=a;this.b=b;this.c=d;this.d=e};
MO.SPlane_normalize=function(){var a=1/Math.sqrt(this.a*this.a+this.b*this.b+this.c*this.c);this.a*=a;this.b*=a;this.c*=a;this.d*=a};MO.SPlane_dot=function(a,b,d){return a*this.a+b*this.b+d*this.c+this.d};MO.SPlane_toString=function(){return this.a+","+this.b+","+this.c+","+this.d};MO.SPlane_dump=function(){return MO.Class.dump(this)+" ["+this.toString()+"]"};
MO.SPoint2=function(a,b){MO.SValue2.call(this,MO.Lang.Integer.nvl(a),MO.Lang.Integer.nvl(b));this.serialize=MO.SPoint2_serialize;this.unserialize=MO.SPoint2_unserialize;this.parse=MO.SPoint2_parse;this.toString=MO.SPoint2_toString;this.dispose=MO.SPoint2_dispose;return this};MO.SPoint2_serialize=function(a){a.writeFloat(this.x);a.writeFloat(this.y)};MO.SPoint2_unserialize=function(a){this.x=a.readFloat();this.y=a.readFloat()};
MO.SPoint2_parse=function(a){var b=a.split(",");if(2==b.length)this.x=parseInt(b[0]),this.y=parseInt(b[1]);else throw new TError(this,"Parse value failure. (value={1})",a);};MO.SPoint2_toString=function(){return this.x+","+this.y};MO.SPoint2_dispose=function(){this.y=this.x=null};
MO.SPoint3=function(a,b,d){MO.SValue3.call(this,a,b,d);this.conjugate=MO.SPoint3_conjugate;this.mergeMin=MO.SPoint3_mergeMin;this.mergeMin3=MO.SPoint3_mergeMin3;this.mergeMax=MO.SPoint3_mergeMax;this.mergeMax3=MO.SPoint3_mergeMax3;this.resize=MO.SPoint3_resize;this.slerp=MO.SPoint3_slerp;return this};MO.SPoint3_conjugate=function(a){var b=null,b=a?a:new MO.SPoint3;b.x=-this.x;b.y=-this.y;b.z=-this.z;return b};
MO.SPoint3_mergeMin=function(a){this.x=Math.min(this.x,a.x);this.y=Math.min(this.y,a.y);this.z=Math.min(this.z,a.z)};MO.SPoint3_mergeMin3=function(a,b,d){this.x=Math.min(this.x,a);this.y=Math.min(this.y,b);this.z=Math.min(this.z,d)};MO.SPoint3_mergeMax=function(a){this.x=Math.max(this.x,a.x);this.y=Math.max(this.y,a.y);this.z=Math.max(this.z,a.z)};MO.SPoint3_mergeMax3=function(a,b,d){this.x=Math.max(this.x,a);this.y=Math.max(this.y,b);this.z=Math.max(this.z,d)};
MO.SPoint3_resize=function(a,b,d){null!=a&&(this.x+=a);null!=b&&(this.y+=b);null!=d&&(this.z+=d)};MO.SPoint3_slerp=function(a,b,d){this.x=(b.x-a.x)*d+a.x;this.y=(b.y-a.y)*d+a.y;this.z=(b.z-a.z)*d+a.z};MO.SPoint4=function(a,b,d,e){MO.SValue4.call(this,a,b,d,e);this.serialize3=MO.SPoint4_serialize3;this.unserialize3=MO.SPoint4_unserialize3;return this};MO.SPoint4_serialize3=function(a){a.writeFloat(this.x);a.writeFloat(this.y);a.writeFloat(this.z)};
MO.SPoint4_unserialize3=function(a){this.x=a.readFloat();this.y=a.readFloat();this.z=a.readFloat()};
MO.SQuaternion=function(){this.z=this.y=this.x=0;this.w=1;this.identity=MO.SQuaternion_identity;this.assign=MO.SQuaternion_assign;this.set=MO.SQuaternion_set;this.absolute=MO.SQuaternion_absolute;this.normalize=MO.SQuaternion_normalize;this.conjugate=MO.SQuaternion_conjugate;this.mul=MO.SQuaternion_mul;this.mul2=MO.SQuaternion_mul2;this.translate=MO.SQuaternion_translate;this.slerp=MO.SQuaternion_slerp;this.fromAxisAngle=MO.SQuaternion_fromAxisAngle;this.fromEuler=MO.SQuaternion_fromEuler;this.parseEuler=
MO.SQuaternion_parseEuler;this.serialize=MO.SQuaternion_serialize;this.unserialize=MO.SQuaternion_unserialize;this.clone=MO.SQuaternion_clone;this.toString=MO.SQuaternion_toString;return this};MO.SQuaternion_identity=function(){this.x=this.y=this.z=0;this.w=1;return this};MO.SQuaternion_assign=function(a){this.x=a.x;this.y=a.y;this.z=a.z;this.w=a.w};MO.SQuaternion_set=function(a,b,d,e){this.x=a;this.y=b;this.z=d;this.w=e};
MO.SQuaternion_absolute=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)};MO.SQuaternion_normalize=function(){var a=this.absolute();0!=a&&(a=1/a,this.x*=a,this.y*=a,this.z*=a,this.w*=a)};MO.SQuaternion_conjugate=function(a){var b=null,b=a?a:new MO.SQuaternion;b.x=-this.x;b.y=-this.y;b.z=-this.z;b.w=this.w;return b};
MO.SQuaternion_mul=function(a){var b=this.x,d=this.y,e=this.z,f=this.w;this.x=f*a.x+b*a.w+d*a.z-e*a.y;this.y=f*a.y+d*a.w+e*a.x-b*a.z;this.z=f*a.z+e*a.w+b*a.y-d*a.x;this.w=f*a.w-b*a.x-d*a.y-e*a.z};MO.SQuaternion_mul2=function(a,b){this.x=a.w*b.x+a.x*b.w+a.y*b.z-a.z*b.y;this.y=a.w*b.y+a.y*b.w+a.z*b.x-a.x*b.z;this.z=a.w*b.z+a.z*b.w+a.x*b.y-a.y*b.x;this.w=a.w*b.w-a.x*b.x-a.y*b.y-a.z*b.z};
MO.SQuaternion_translate=function(a,b){var d=new MO.SQuaternion;d.set(a.x,a.y,a.z,0);d.normalize();var e=this.conjugate();d.mul(e);e=this.clone();e.mul(d);d=null;d=b?b:new MO.SVector3;d.set(e.x,e.y,e.z);return d};
MO.SQuaternion_slerp=function(a,b,d){var e=a.x*b.x+a.y*b.y+a.z*b.z+a.w*b.w,f=!1;0>e&&(f=!0,e=-e);var h=0,k=0;.999999<e?(h=1-d,k=f?-d:d):(e=Math.acos(e),k=1/Math.sin(e),h=Math.sin((1-d)*e)*k,k=f?-Math.sin(d*e)*k:Math.sin(d*e)*k);this.x=h*a.x+k*b.x;this.y=h*a.y+k*b.y;this.z=h*a.z+k*b.z;this.w=h*a.w+k*b.w};MO.SQuaternion_fromAxisAngle=function(a,b){var d=.5*b,e=Math.sin(d);this.x=a.x*e;this.y=a.y*e;this.z=a.z*e;this.w=Math.cos(d)};
MO.SQuaternion_fromEuler=function(a,b,d){var e=Math.sin(.5*d);d=Math.cos(.5*d);var f=Math.sin(.5*a);a=Math.cos(.5*a);var h=Math.sin(.5*b);b=Math.cos(.5*b);this.x=d*f*b+e*a*h;this.y=d*a*h-e*f*b;this.z=e*a*b-d*f*h;this.w=d*a*b+e*f*h};
MO.SQuaternion_parseEuler=function(a){var b=this.x*this.x,d=this.y*this.y,e=this.z*this.z,f=null,f=a?a:new MO.SVector3;f.x=Math.asin(RFloat.toRange(2*(this.w*this.x-this.y*this.z),-1,1));f.y=Math.atan2(2*(this.w*this.y+this.z*this.x),1-2*(b+d));f.z=Math.atan2(2*(this.w*this.z+this.x*this.y),1-2*(e+b));return f};MO.SQuaternion_serialize=function(a){a.writeFloat(this.x);a.writeFloat(this.y);a.writeFloat(this.z);a.writeFloat(this.w)};
MO.SQuaternion_unserialize=function(a){this.x=a.readFloat();this.y=a.readFloat();this.z=a.readFloat();this.w=a.readFloat()};MO.SQuaternion_clone=function(){var a=new MO.SQuaternion;a.x=this.x;a.y=this.y;a.z=this.z;a.w=this.w;return a};MO.SQuaternion_toString=function(){return this.x+","+this.y+","+this.z+","+this.w};MO.SRange=function(a,b,d,e){this.x=a;this.y=b;this.width=d;this.height=e;this.dump=SRange_dump;return this};MO.SRange_reset=function(){this.bottom=this.right=this.top=this.left=0};
MO.SRange_assign=function(a){this.left=a.left;this.top=a.top;this.right=a.right;this.bottom=a.bottom};MO.SRange_set=function(a,b,d,e){this.left=a;this.top=b;this.right=d;this.bottom=e};MO.SRange_setBounds=function(a,b,d,e){this.left=a;this.top=b;this.right=this.left+d-1;this.bottom=this.top+e-1};MO.SRange_width=function(){return this.right-this.left+1};MO.SRange_setWidth=function(a){a&&(this.right=this.left+a-1)};MO.SRange_height=function(){return this.bottom-this.top+1};
MO.SRange_setHeight=function(a){a&&(this.bottom=this.top+a-1)};MO.SRange_move=function(a,b){this.left+=a;this.top+=b;this.right+=a;this.bottom+=b};MO.SRange_inc=function(a){a=RInt.nvl(a,1);this.left-=a;this.top-=a;this.right+=a;this.bottom+=a};MO.SRange_dec=function(a){a=RInt.nvl(a,1);this.left+=a;this.top+=a;this.right-=a;this.bottom-=a};MO.SRange_dump=function(a){a=RString.nvlStr(a);a.append(RClass.name(this));a.append(" [",this.x,",",this.y,"-",this.width,",",this.height,"] ");return a};
MO.SRectangle=function(a,b,d,e){this.left=MO.Lang.Integer.nvl(a);this.top=MO.Lang.Integer.nvl(b);this.width=MO.Lang.Integer.nvl(d);this.height=MO.Lang.Integer.nvl(e);this.right=MO.SRectangle_right;this.bottom=MO.SRectangle_bottom;this.isEmpty=MO.SRectangle_isEmpty;this.testRange=MO.SRectangle_testRange;this.testRectangle=MO.SRectangle_testRectangle;this.reset=MO.SRectangle_reset;this.assign=MO.SRectangle_assign;this.setLocation=MO.SRectangle_setLocation;this.setSize=MO.SRectangle_setSize;this.setLocationSize=
MO.SRectangle_setLocationSize;this.set=MO.SRectangle_set;this.toString=MO.SRectangle_toString;this.dispose=MO.SRectangle_dispose;return this};MO.SRectangle_right=function(){return this.left+this.width};MO.SRectangle_bottom=function(){return this.top+this.height};MO.SRectangle_isEmpty=function(){return 0<this.width&&0<this.height?!1:!0};MO.SRectangle_testRange=function(a,b){return a<this.left||b<this.top||a-this.left>this.width||b-this.top>this.height?!1:!0};
MO.SRectangle_testRectangle=function(a){return this.left<a.left+a.width&&this.left+this.width>a.left&&this.top<a.top+a.height&&this.top+this.height>a.top};MO.SRectangle_reset=function(){this.height=this.width=this.top=this.left=0};MO.SRectangle_assign=function(a){this.left=a.left;this.top=a.top;this.width=a.width;this.height=a.height};MO.SRectangle_setLocation=function(a,b){this.left=a;this.top=b};MO.SRectangle_setSize=function(a,b){this.width=a;this.height=b};
MO.SRectangle_setLocationSize=function(a,b){this.left=a.x;this.top=a.y;this.width=b.width;this.height=b.height};MO.SRectangle_set=function(a,b,d,e){this.left=a;this.top=b;this.width=d;this.height=e};MO.SRectangle_toString=function(){return this.left+","+this.top+","+this.width+","+this.height};MO.SRectangle_dispose=function(){this.height=this.width=this.top=this.left=null};
MO.SSize2=function(a,b){this.width=MO.Lang.Integer.nvl(a);this.height=MO.Lang.Integer.nvl(b);this.isEmpty=MO.SSize2_isEmpty;this.equalsData=MO.SSize2_equalsData;this.equals=MO.SSize2_equals;this.square=MO.SSize2_square;this.assign=MO.SSize2_assign;this.set=MO.SSize2_set;this.serialize=MO.SSize2_serialize;this.unserialize=MO.SSize2_unserialize;this.parse=MO.SSize2_parse;this.toDisplay=MO.SSize2_toDisplay;this.toString=MO.SSize2_toString;this.dispose=MO.SSize2_dispose;this.dump=MO.SSize2_dump;return this};
MO.SSize2_isEmpty=function(){return 0==this.width&&0==this.height};MO.SSize2_equalsData=function(a,b){return this.width!=a||this.height!=b?!1:!0};MO.SSize2_equals=function(a){return this.width!=a.width||this.height!=a.height?!1:!0};MO.SSize2_square=function(){return this.width*this.height};MO.SSize2_assign=function(a){this.width=a.width;this.height=a.height};MO.SSize2_set=function(a,b){this.width=a;this.height=b};MO.SSize2_serialize=function(a){a.writeFloat(this.width);a.writeFloat(this.height)};
MO.SSize2_unserialize=function(a,b){b||(b=MO.EDataType.Float16);this.width=a.readData(b);this.height=a.readData(b)};MO.SSize2_parse=function(a){var b=a.split(",");if(2==b.length)this.width=parseInt(b[0]),this.height=parseInt(b[1]);else throw new TError(this,"Parse value failure. (value={1})",a);};MO.SSize2_toDisplay=function(){return this.width+"x"+this.height};MO.SSize2_toString=function(){return this.width+","+this.height};MO.SSize2_dispose=function(){this.height=this.width=null};
MO.SSize2_dump=function(){return MO.Class.dump(this)+" ["+this.width+","+this.height+"]"};MO.SSize3=function(a,b,d){this.width=MO.Lang.Integer.nvl(a);this.height=MO.Lang.Integer.nvl(b);this.deep=MO.Lang.Integer.nvl(d);this.assign=MO.SSize3_assign;this.set=MO.SSize3_set;this.parse=MO.SSize3_parse;this.toString=MO.SSize3_toString;this.dump=MO.SSize3_dump;return this};MO.SSize3_assign=function(a){this.width=a.width;this.height=a.height;this.deep=a.deep};
MO.SSize3_set=function(a,b,d){this.width=a;this.height=b;this.deep=d};MO.SSize3_parse=function(a){var b=a.split(",");if(3==b.length)this.width=parseInt(b[0]),this.height=parseInt(b[1]),this.deep=parseInt(b[2]);else throw new MO.TError(this,"Parse value failure. (value={1})",a);};MO.SSize3_toString=function(){return this.width+","+this.height+","+this.deep};MO.SSize3_dump=function(){return MO.Lang.Class.dump(this)+" ["+this.width+","+this.height+","+this.deep+"]"};
MO.SSquare=function(a,b,d,e){this.left=MO.Lang.Integer.nvl(left);this.top=MO.Lang.Integer.nvl(top);this.right=MO.Lang.Integer.nvl(right);this.bottom=MO.Lang.Integer.nvl(bottom);this.reset=MO.SSquare_reset;this.assign=MO.SSquare_assign;this.set=MO.SSquare_set;this.setBounds=MO.SSquare_setBounds;this.width=MO.SSquare_width;this.setWidth=MO.SSquare_setWidth;this.height=MO.SSquare_height;this.setHeight=MO.SSquare_setHeight;this.move=MO.SSquare_move;this.inc=MO.SSquare_inc;this.dec=MO.SSquare_dec;this.dump=
this.unpack=this.pack=MO.SSquare_dump;return this};MO.SSquare_reset=function(){this.bottom=this.right=this.top=this.left=0};MO.SSquare_assign=function(a){this.left=a.left;this.top=a.top;this.right=a.right;this.bottom=a.bottom};MO.SSquare_set=function(a,b,d,e){this.left=a;this.top=b;this.right=d;this.bottom=e};MO.SSquare_setBounds=function(a,b,d,e){this.left=a;this.top=b;this.right=this.left+d-1;this.bottom=this.top+e-1};MO.SSquare_width=function(){return this.right-this.left+1};
MO.SSquare_setWidth=function(a){a&&(this.right=this.left+a-1)};MO.SSquare_height=function(){return this.bottom-this.top+1};MO.SSquare_setHeight=function(a){a&&(this.bottom=this.top+a-1)};MO.SSquare_move=function(a,b){this.left+=a;this.top+=b;this.right+=a;this.bottom+=b};MO.SSquare_inc=function(a){a=RInt.nvl(a,1);this.left-=a;this.top-=a;this.right+=a;this.bottom+=a};MO.SSquare_dec=function(a){a=RInt.nvl(a,1);this.left+=a;this.top+=a;this.right-=a;this.bottom-=a};
MO.SSquare_dump=function(a){a=MO.Lang.String.nvlStr(a);a.append(MO.Class.name(this));a.append(" [",this.left,",",this.top,"-",this.right,",",this.bottom,"] ");a.append("(",this.width(),"-",this.height(),")");return a};
MO.SValue2=function(a,b){this.x=MO.Runtime.nvl(a,0);this.y=MO.Runtime.nvl(b,0);this.isEmpty=MO.SValue2_isEmpty;this.equals=MO.SValue2_equals;this.equalsData=MO.SValue2_equalsData;this.assign=MO.SValue2_assign;this.setMin=MO.SValue2_setMin;this.setMax=MO.SValue2_setMax;this.set=MO.SValue2_set;this.setAll=MO.SValue2_setAll;this.mergeMin=MO.SValue2_mergeMin;this.mergeMin2=MO.SValue2_mergeMin2;this.mergeMax=MO.SValue2_mergeMax;this.mergeMax2=MO.SValue2_mergeMax2;this.absolute=this.length=MO.SValue2_absolute;
this.normalize=MO.SValue2_normalize;this.negative=MO.SValue2_negative;this.parse=MO.SValue2_parse;this.toString=MO.SValue2_toString;return this};MO.SValue2_isEmpty=function(){return 0==this.x&&0==this.y};MO.SValue2_equals=function(a){return this.x==a.x&&this.y==a.y};MO.SValue2_equalsData=function(a,b){return this.x==a&&this.y==b};MO.SValue2_assign=function(a){this.x=a.x;this.y=a.y};MO.SValue2_setMin=function(){this.y=this.x=Number.MIN_VALUE};MO.SValue2_setMax=function(){this.y=this.x=Number.MAX_VALUE};
MO.SValue2_set=function(a,b){this.x=a;this.y=b};MO.SValue2_setAll=function(a){this.y=this.x=a};MO.SValue2_normalize=function(){var a=this.absolute();0!=a&&(a=1/a,this.x*=a,this.y*=a);return this};MO.SValue2_mergeMin=function(a){this.x=Math.min(this.x,a.x);this.y=Math.min(this.y,a.y)};MO.SValue2_mergeMin2=function(a,b){this.x=Math.min(this.x,a);this.y=Math.min(this.y,b)};MO.SValue2_mergeMax=function(a){this.x=Math.max(this.x,a.x);this.y=Math.max(this.y,a.y)};
MO.SValue2_mergeMax2=function(a,b){this.x=Math.max(this.x,a);this.y=Math.max(this.y,b)};MO.SValue2_absolute=function(){return Math.sqrt(this.x*this.x+this.y*this.y)};MO.SValue2_negative=function(a){var b=null,b=p?a:new this.constructor;b.x=-this.x;b.y=-this.y;return b};MO.SValue2_parse=function(a){var b=a.split(",");if(2==b.length)this.x=parseFloat(b[0]),this.y=parseFloat(b[1]);else throw new MO.TError(o,"Parse value failure. (value={1})",a);};MO.SValue2_toString=function(){return this.x+","+this.y};
MO.SValue3=function(a,b,d){this.x=MO.Runtime.nvl(a,0);this.y=MO.Runtime.nvl(b,0);this.z=MO.Runtime.nvl(d,0);this.isEmpty=MO.SValue3_isEmpty;this.equals=MO.SValue3_equals;this.equalsData=MO.SValue3_equalsData;this.assign=MO.SValue3_assign;this.setMin=MO.SValue3_setMin;this.setMax=MO.SValue3_setMax;this.set=MO.SValue3_set;this.setAll=MO.SValue3_setAll;this.absolute=this.length=MO.SValue3_absolute;this.normalize=MO.SValue3_normalize;this.negative=MO.SValue3_negative;this.serialize=MO.SValue3_serialize;
this.unserialize=MO.SValue3_unserialize3;this.unserialize2=MO.SValue3_unserialize2;this.unserialize3=MO.SValue3_unserialize3;this.parse=MO.SValue3_parse;this.toString=MO.SValue3_toString;return this};MO.SValue3_isEmpty=function(a){return 0==this.x&&0==this.y&&0==this.z};MO.SValue3_equals=function(a){return this.x==a.x&&this.y==a.y&&this.z==a.z};MO.SValue3_equalsData=function(a,b,d){return this.x==a&&this.y==b&&this.z==d};MO.SValue3_assign=function(a){this.x=a.x;this.y=a.y;this.z=a.z};
MO.SValue3_setMin=function(){this.z=this.y=this.x=Number.MIN_VALUE};MO.SValue3_setMax=function(){this.z=this.y=this.x=Number.MAX_VALUE};MO.SValue3_set=function(a,b,d){this.x=a;this.y=b;this.z=d};MO.SValue3_setAll=function(a){this.z=this.y=this.x=a};MO.SValue3_normalize=function(){var a=this.absolute();0!=a&&(a=1/a,this.x*=a,this.y*=a,this.z*=a);return this};MO.SValue3_absolute=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)};
MO.SValue3_negative=function(a){var b=null,b=p?a:new this.constructor;b.x=-this.x;b.y=-this.y;b.z=-this.z;return b};MO.SValue3_serialize=function(a){a.writeFloat(this.x);a.writeFloat(this.y);a.writeFloat(this.z)};MO.SValue3_unserialize2=function(a){this.x=a.readFloat();this.y=a.readFloat()};MO.SValue3_unserialize3=function(a){this.x=a.readFloat();this.y=a.readFloat();this.z=a.readFloat()};
MO.SValue3_parse=function(a){var b=a.split(",");if(3==b.length)this.x=parseFloat(b[0]),this.y=parseFloat(b[1]),this.z=parseFloat(b[2]);else throw new MO.TError(o,"Parse value failure. (value={1})",a);};MO.SValue3_toString=function(){return this.x+","+this.y+","+this.z};
MO.SValue4=function(a,b,d,e){this.x=MO.Runtime.nvl(a,0);this.y=MO.Runtime.nvl(b,0);this.z=MO.Runtime.nvl(d,0);this.w=MO.Runtime.nvl(e,1);this.assign=MO.SValue4_assign;this.set=MO.SValue4_set;this.absolute=MO.SValue4_absolute;this.normalize=MO.SValue4_normalize;this.negative=MO.SValue4_negative;this.serialize=MO.SValue4_serialize;this.unserialize=MO.SValue4_unserialize;this.parse=MO.SValue4_parse;this.toString=MO.SValue4_toString;return this};
MO.SValue4_assign=function(a){this.x=a.x;this.y=a.y;this.z=a.z;this.w=a.w};MO.SValue4_set=function(a,b,d,e){this.x=a;this.y=b;this.z=d;this.w=e};MO.SValue4_absolute=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)};MO.SValue4_normalize=function(){var a=this.absolute();0!=a&&(a=1/a,this.x*=a,this.y*=a,this.z*=a,this.w*=a)};MO.SValue4_negative=function(a){var b=null,b=a?a:new this.constructor;b.x=-this.x;b.y=-this.y;b.z=-this.z;b.w=-this.w;return b};
MO.SValue4_serialize=function(a){a.writeFloat(this.x);a.writeFloat(this.y);a.writeFloat(this.z);a.writeFloat(this.w)};MO.SValue4_unserialize=function(a){this.x=a.readFloat();this.y=a.readFloat();this.z=a.readFloat();this.w=a.readFloat()};MO.SValue4_parse=function(a){var b=a.split(",");if(4==b.length)this.x=parseFloat(b[0]),this.y=parseFloat(b[1]),this.z=parseFloat(b[2]),this.w=parseFloat(b[3]);else throw new MO.TError(o,"Parse value failure. (value={1})",a);};
MO.SValue4_toString=function(){return this.x+","+this.y+","+this.z+","+this.w};MO.SVector2=function(a,b,d){MO.SValue2.call(this,a,b,d);this.length=this.absolute;this.direction=MO.SVector2_direction;this.conjugate=MO.SVector2_conjugate;this.dotPoint3=MO.SVector2_dotPoint3;this.cross=MO.SVector2_cross;this.cross2=MO.SVector2_cross2;this.slerp=MO.SVector2_slerp;this.clone=MO.SVector2_clone;return this};MO.SVector2_direction=function(a,b){this.x=b.x-a.x;this.y=b.y-a.y;this.z=b.z-a.z;return this};
MO.SVector2_conjugate=function(a){var b=null,b=a?a:new MO.SVector2;b.x=-this.x;b.y=-this.y;b.z=-this.z;return b};MO.SVector2_dotPoint3=function(a){return this.x*a.x+this.y*a.y+this.z*a.z};MO.SVector2_cross=function(a){var b=this.z*a.x-this.x*a.z,d=this.x*a.y-this.y*a.x;this.x=this.y*a.z-this.z*a.y;this.y=b;this.z=d};MO.SVector2_cross2=function(a,b){a.x=this.y*b.z-this.z*b.y;a.y=this.z*b.x-this.x*b.z;a.z=this.x*b.y-this.y*b.x};
MO.SVector2_slerp=function(a,b,d){this.x=(b.x-a.x)*d+a.x;this.y=(b.y-a.y)*d+a.y;this.z=(b.z-a.z)*d+a.z};MO.SVector2_clone=function(){var a=new MO.SVector2;a.x=this.x;a.y=this.y;a.z=this.z;return a};
MO.SVector3=function(a,b,d){MO.SValue3.call(this,a,b,d);this.length=this.absolute;this.direction=MO.SVector3_direction;this.conjugate=MO.SVector3_conjugate;this.dotPoint3=MO.SVector3_dotPoint3;this.cross=MO.SVector3_cross;this.cross2=MO.SVector3_cross2;this.slerp=MO.SVector3_slerp;this.clone=MO.SVector3_clone;return this};MO.SVector3_direction=function(a,b){this.x=b.x-a.x;this.y=b.y-a.y;this.z=b.z-a.z;return this};
MO.SVector3_conjugate=function(a){var b=null,b=a?a:new MO.SVector3;b.x=-this.x;b.y=-this.y;b.z=-this.z;return b};MO.SVector3_dotPoint3=function(a){return this.x*a.x+this.y*a.y+this.z*a.z};MO.SVector3_cross=function(a){var b=this.z*a.x-this.x*a.z,d=this.x*a.y-this.y*a.x;this.x=this.y*a.z-this.z*a.y;this.y=b;this.z=d};MO.SVector3_cross2=function(a,b){a.x=this.y*b.z-this.z*b.y;a.y=this.z*b.x-this.x*b.z;a.z=this.x*b.y-this.y*b.x};
MO.SVector3_slerp=function(a,b,d){this.x=(b.x-a.x)*d+a.x;this.y=(b.y-a.y)*d+a.y;this.z=(b.z-a.z)*d+a.z};MO.SVector3_clone=function(){var a=new MO.SVector3;a.x=this.x;a.y=this.y;a.z=this.z;return a};MO.SVector4=function(a,b,d,e){MO.SValue4.call(this,a,b,d,e);this.serialize3=MO.SVector4_serialize3;this.unserialize3=MO.SVector4_unserialize3;return this};MO.SVector4_serialize3=function(a){a.writeFloat(this.x);a.writeFloat(this.y);a.writeFloat(this.z)};
MO.SVector4_unserialize3=function(a){this.x=a.readFloat();this.y=a.readFloat();this.z=a.readFloat()};MO.RMath=function(){this.value1=Array(1);this.value2=Array(2);this.value3=Array(3);this.value4=Array(4);this.value9=Array(9);this.value12=Array(12);this.value16=Array(16);this.matrix=this.rectangle=this.vector3=this.vectorBackward=this.vectorForward=this.vectorScale=this.vectorAxisZ=this.vectorAxisY=this.vectorAxisX=null;this.faceCenterPositions=[-1,1,0,1,1,0,1,-1,0,-1,-1,0];return this};
MO.RMath.prototype.construct=function(){this.vectorAxisX=new MO.SVector3(1,0,0);this.vectorAxisY=new MO.SVector3(0,1,0);this.vectorAxisZ=new MO.SVector3(0,0,1);this.vectorScale=new MO.SVector3(1,1,1);this.vectorForward=new MO.SVector3(0,0,1);this.vectorBackward=new MO.SVector3(0,0,-1);this.vector3=new MO.SVector3;this.rectangle=new MO.SRectangle;this.matrix=new MO.SMatrix3d};
MO.RMath.prototype.min=function(){var a=0,b=arguments.length;if(1<b)for(var a=Number.MAX_VALUE,d=0;d<b;d++){var e=arguments[d];e<a&&(a=e)}return a};MO.RMath.prototype.max=function(){var a=0,b=arguments.length;if(1<b)for(var a=Number.MIN_VALUE,d=0;d<b;d++){var e=arguments[d];e>a&&(a=e)}return a};MO.RMath.prototype.sign=function(a){return 0<a?1:0>a?-1:0};MO.RMath=new MO.RMath;MO.RMath.construct();MO.Lang.Math=MO.RMath;
MO.RMatrix=function(){this.identity3x3=[1,0,0,0,1,0,0,0,1];this.identity4x4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return this};MO.RMatrix.prototype.perspectiveLH=function(a,b,d,e,f){a=a.data();a[0]=2*e/b;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=2*e/d;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=f/(f-e);a[11]=1;a[12]=0;a[13]=0;a[14]=e*f/(e-f);a[15]=0};
MO.RMatrix.prototype.perspectiveRH=function(a,b,d,e,f){a=a.data();a[0]=2*e/b;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=2*e/d;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=f/(e-f);a[11]=1;a[12]=0;a[13]=0;a[14]=e*f/(e-f);a[15]=0};MO.RMatrix.prototype.perspectiveFieldOfViewLH=function(a,b,d,e,f){a=a.data();b=1/Math.tan(.5*b);a[0]=b/d;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=b;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=f/(f-e);a[11]=1;a[12]=0;a[13]=0;a[14]=e*f/(e-f);a[15]=0};
MO.RMatrix.prototype.perspectiveFieldOfViewRH=function(a,b,d,e,f){a=a.data();b=1/Math.tan(.5*b);a[0]=b/d;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=b;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=f/(e-f);a[11]=1;a[12]=0;a[13]=0;a[14]=e*f/(f-e);a[15]=0};MO.RMatrix.prototype.orthoLH=function(a,b,d,e,f,h,k){k-=h;b=(b+(b+e))/e;d=(d+(d+f))/f;h/=k;a=MO.Lang.Array.copy(this.identity4x4,0,16,a.data(),0);a[0]=2/e;a[5]=2/f;a[10]=1/k;a[12]=-b;a[13]=-d;a[14]=-h};
MO.RMatrix.prototype.orthoRH=function(a,b,d,e,f,h,k){var q=k-h;b=(b+(b+e))/e;d=(d+(d+f))/f;h=(h+k)/q;a=MO.Lang.Array.copy(this.identity4x4,0,16,a.data(),0);a[0]=2/e;a[5]=2/f;a[10]=-2/q;a[12]=-b;a[13]=-d;a[14]=-h};MO.Lang.Matrix=new MO.RMatrix;MO.RRandom=function(){this._seed=(new Date).getTime();return this};MO.RRandom.prototype.get=function(){this._seed=(9301*this._seed+49297)%233280;return this._seed/233280};MO.RRandom.prototype.rand=function(a){a*=this.get();return Math.ceil(a)};MO.RRandom=new MO.RRandom;
MO.Lang.Random=MO.RRandom;MO.AListener=function(a,b){MO.ASource.call(this,a,MO.ESource.Listener,b);this.build=MO.AListener_build;if(null==b){a=this._name;if(MO.Lang.String.startsWith(a,"_listeners"))a=a.substring(10);else throw new MO.TError("Linker is invalid.");this._linker=a}else this._linker=b;return this};
MO.AListener_build=function(a,b){var d="add"+this._linker+"Listener";b[d]=MO.RListener.makeAddListener(d,this._linker);d="set"+this._linker+"Listener";b[d]=MO.RListener.makeSetListener(d,this._linker);d="remove"+this._linker+"Listener";b[d]=MO.RListener.makeRemoveListener(d,this._linker);d="clear"+this._linker+"Listeners";b[d]=MO.RListener.makeClearListener(d,this._linker);d="process"+this._linker+"Listener";b[d]=MO.RListener.makeProcessListener(d,this._linker)};
MO.EEvent=new function(){this.Unknown="Unknown";this.Load="Load";this.Loaded="Loaded";this.Process="Process";this.Complete="Complete";this.Change="Change";this.EnterFrame="EnterFrame";this.LeaveFrame="LeaveFrame";this.Enter="Enter";this.Leave="Leave";this.Resize="Reisze";this.Focus="Focus";this.Blur="Blur";this.MouseDown="MouseDown";this.MouseMove="MouseMove";this.MouseUp="MouseUp";this.MouseWheel="MouseWheel";this.KeyDown="KeyDown";this.KeyPress="KeyPress";this.KeyUp="KeyUp";this.Click="Click";this.DoubleClick=
"DoubleClick";this.NodeClick="NodeClick";this.ItemClick="ItemClick";this.Selected="Selected";this.DataChanged="DataChanged";this.Result="Result";this.TouchZoom="TouchZoom";this.Visibility="Visibility";this.Orientation="Orientation";this.OperationDown="OperationDown";this.OperationMove="OperationMove";this.OperationUp="OperationUp";return this};MO.EHttpContent=new function(){this.Binary=1;this.Text=2;return this};MO.EHttpMethod=new function(){this.Get="GET";this.Post="POST";return this};
MO.EHttpStatus=new function(){this.Uninitialized=0;this.Open=1;this.Send=2;this.Receiving=3;this.Loaded=4;return this};MO.EOrientation=new function(){this.Unknown=0;this.Horizontal="H";this.Vertical="V";return this};
MO.MListener=function(a){a=MO.Class.inherits(this,a);a._listenerss=null;a.addListener=MO.MListener_addListener;a.setListener=MO.MListener_setListener;a.removeListener=MO.MListener_removeListener;a.clearListeners=MO.MListener_clearListeners;a.clearAllListeners=MO.MListener_clearAllListeners;a.processListener=MO.MListener_processListener;a.dispose=MO.MListener_dispose;return a};
MO.MListener_addListener=function(a,b,d){var e=this._listenerss;e||(e=this._listenerss=new MO.TDictionary);var f=e.get(a);f||(f=new MO.TListeners,e.set(a,f));return f.register(b,d)};MO.MListener_setListener=function(a,b,d){var e=this._listenerss;e&&(e=e.get(a))&&e.clear();return this.addListener(a,b,d)};MO.MListener_removeListener=function(a,b,d){return this._listenerss.get(a).unregister(b,d)};MO.MListener_clearListeners=function(a){var b=this._listenerss;b&&(a=b.get(a))&&a.clear()};
MO.MListener_clearAllListeners=function(){var a=this._listenerss;if(a)for(var b=a.count(),d=0;d<b;d++){var e=a.at(d);e&&e.clear()}};MO.MListener_processListener=function(a,b,d,e,f,h){var k=this._listenerss;k&&(a=k.get(a))&&a.process(b,d,e,f,h)};MO.MListener_dispose=function(){var a=this._listenerss;if(a){for(var b=a.count()-1;0<=b;b--)a.at(b).dispose();this._listenerss=MO.Lang.Object.dispose(a)}};
MO.SEvent=function(a){this.listener=this.annotation=this.code=null;this.sender=a;this.process=this.onProcess=this.ohProcess=this.hSource=this.hSender=this.hEvent=this.source=null;this.dispose=MO.SEvent_dispose;return this};MO.SEvent_dispose=function(){for(var a in this)this[a]=null};MO.SKeyboardEvent=function(){MO.SEvent.call(this);this.ctrlKey=this.shiftKey=this.altKey=!1;this.keyCode=0;this.attachEvent=MO.SKeyboardEvent_attachEvent;this.cancel=MO.SKeyboardEvent_cancel;return this};
MO.SKeyboardEvent_attachEvent=function(a){this.altKey=a.altKey;this.shiftKey=a.shiftKey;this.ctrlKey=a.ctrlKey;this.keyCode=a.keyCode};MO.SKeyboardEvent_cancel=function(){this.hEvent.returnValue=!1};MO.SMouseEvent=function(){MO.SEvent.call(this);this.button=null;this.ctrlKey=this.altKey=this.mouseRight=this.mouseMiddle=this.mouseLeft=!1;this.deltaZ=this.deltaY=this.deltaX=this.clientY=this.clientX=this.offsetY=this.offsetX=this.y=this.x=0;this.attachEvent=MO.SMouseEvent_attachEvent;return this};
MO.SMouseEvent_attachEvent=function(a){var b=this.hSource=MO.RHtml.eventSource(a);b&&(this.source=b.__linker);this.button=a.button;this.mouseLeft=a.button==MO.EMouseButton.Left;this.mouseMiddle=a.button==MO.EMouseButton.Middle;this.mouseRight=a.button==MO.EMouseButton.Right;this.altKey=a.altKey;this.ctrlKey=a.ctrlKey;MO.RBrowser.isBrowser(MO.EBrowser.FireFox)?(this.x=a.pageX,this.y=a.pageY,this.offsetX=a.layerX,this.offsetY=a.layerY):(this.x=a.x,this.y=a.y,this.offsetX=a.offsetX,this.offsetY=a.offsetY);
this.clientX=a.clientX;this.clientY=a.clientY;this.deltaX=a.deltaX;this.deltaY=a.deltaY;this.deltaZ=a.deltaZ};MO.SResizeEvent=function(){MO.SEvent.call(this);this.height=this.width=null;this.attachEvent=MO.SResizeEvent_attachEvent;return this};MO.SResizeEvent_attachEvent=function(a){if(a=this.hSource=MO.RHtml.eventSource(a))this.source=a.__linker};
MO.FHttpConnection=function(a){a=MO.Class.inherits(this,a,MO.FObject,MO.MListener);a._asynchronous=MO.Class.register(a,new MO.AGetSet("_asynchronous"),!1);a._methodCd=MO.EHttpMethod.Get;a._contentCd=MO.EHttpContent.Binary;a._url=null;a._heads=MO.Class.register(a,new MO.AGetter("_heads"));a._attributes=MO.Class.register(a,new MO.AGetter("_attributes"));a._input=null;a._inputData=MO.Class.register(a,new MO.AGetSet("_inputData"));a._output=null;a._outputData=MO.Class.register(a,new MO.AGetter("_outputData"));
a._handle=null;a._contentLength=0;a._statusFree=!0;a._event=null;a._listenersLoad=MO.Class.register(a,new MO.AListener("_listenersLoad",MO.EEvent.Load));a._listenersComplete=MO.Class.register(a,new MO.AListener("_listenersComplete",MO.EEvent.Complete));a.onConnectionSend=MO.FHttpConnection_onConnectionSend;a.onConnectionReady=MO.FHttpConnection_onConnectionReady;a.onConnectionComplete=MO.FHttpConnection_onConnectionComplete;a.construct=MO.FHttpConnection_construct;a.header=MO.FHttpConnection_header;
a.setHeader=MO.FHttpConnection_setHeader;a.setHeaders=MO.FHttpConnection_setHeaders;a.setOutputData=MO.FHttpConnection_setOutputData;a.content=MO.FHttpConnection_content;a.reset=MO.FHttpConnection_reset;a.sendSync=MO.FHttpConnection_sendSync;a.sendAsync=MO.FHttpConnection_sendAsync;a.send=MO.FHttpConnection_send;a.post=MO.FHttpConnection_post;a.dispose=MO.FHttpConnection_dispose;return a};
MO.FHttpConnection_onConnectionSend=function(){var a=this._input;if(a)if(a.constructor==String)this._inputData=a,this._contentLength=a.length;else if(a.constructor==ArrayBuffer)this._inputData=a,this._contentLength=a.byteLength;else throw new MO.TError("Unknown send data type.");};
MO.FHttpConnection_onConnectionReady=function(){var a=this._linker;if(a._asynchronous){var b=a._handle;b.readyState==MO.EHttpStatus.Loaded&&(200==b.status?(a.setOutputData(),a.onConnectionComplete()):MO.Logger.fatal(a,"Connection failure. (url={1})",a._url))}};
MO.FHttpConnection_onConnectionComplete=function(){this._statusFree=!0;var a=this._event;a.connection=this;a.content=this._outputData;for(var b=this._attributes,d=b.count(),e=0;e<d;e++){var f=b.name(e),h=b.value(e);a[f]=h}this.processLoadListener(a);this.processCompleteListener(a)};
MO.FHttpConnection_construct=function(){this.__base.FObject.construct.call(this);this._heads=new MO.TAttributes;this._attributes=new MO.TAttributes;this._event=new MO.SEvent;var a=this._handle=MO.Window.Xml.createConnection();a._linker=this;a.onreadystatechange=this.onConnectionReady};MO.FHttpConnection_header=function(a){return this._heads.get(a)};MO.FHttpConnection_setHeader=function(a,b){this._heads.set(a,b)};
MO.FHttpConnection_setHeaders=function(){var a=this._handle;this._contentCd==MO.EHttpContent.Binary?MO.Window.Browser.isBrowser(MO.EBrowser.Explorer)?(a.setRequestHeader("Accept-Charset","x-user-defined"),a.responseType="arraybuffer"):(a.overrideMimeType("text/plain; charset=x-user-defined"),this._asynchronous&&(a.responseType="arraybuffer")):a.setRequestHeader("content-type","application/x-www-form-urlencoded");var b=this._heads,d=b.count();if(0<d)for(var e=0;e<d;e++){var f=b.name(e),h=b.value(e);
a.setRequestHeader(f,h)}MO.Window.Browser.isBrowser(MO.EBrowser.Chrome)||(b=this._contentLength,0<b&&a.setRequestHeader("content-length",b))};MO.FHttpConnection_setOutputData=function(){var a=this._handle;this._outputData=this._contentCd==MO.EHttpContent.Binary?a.response:a.responseText};MO.FHttpConnection_content=function(){return this._outputData};MO.FHttpConnection_reset=function(){this._handle.abort();this._attributes.clear();this.clearAllListeners()};
MO.FHttpConnection_sendSync=function(){var a=this._handle;a.open(this._methodCd,this._url,!1);this.setHeaders(a,0);a.send(this._inputData);this.setOutputData();this.onConnectionComplete();MO.Logger.info(this,"Send http sync request. (method={1}, url={2})",this._methodCd,this._url)};
MO.FHttpConnection_sendAsync=function(){var a=this._handle;a.open(this._methodCd,this._url,!0);this.setHeaders(a,0);a.send(this._inputData);MO.Logger.info(this,"Send http asynchronous request. (method={1}, url={2})",this._methodCd,this._url)};MO.FHttpConnection_send=function(a,b){this._url=a;this._input=b;this._methodCd=null!=b?MO.EHttpMethod.Post:MO.EHttpMethod.Get;this._statusFree=!1;this.onConnectionSend();this._asynchronous?this.sendAsync():this.sendSync();return this.content()};
MO.FHttpConnection_post=function(a,b){this._url=a;this._input=b;this._methodCd=MO.EHttpMethod.Post;this._statusFree=!1;this.onConnectionSend();this._asynchronous?this.sendAsync():this.sendSync();return this.content()};
MO.FHttpConnection_dispose=function(){this._heads=MO.Lang.Object.dispose(this._heads);this._attributes=MO.Lang.Object.dispose(this._attributes);this._event=MO.Lang.Object.dispose(this._event);this._outputData=this._output=this._inputData=this._input=null;var a=this._handle;a&&(this._handle=a.onreadystatechange=null);this.__base.MListener.dispose.call(this);this.__base.FObject.dispose.call(this)};MO.RListener=function(){this._listeners={};return this};
MO.RListener.prototype.makeAddListener=function(a,b){var d=null;this._listeners[a]?d=this._listeners[a]:(d=new Function("owner","callback","return this.addListener('"+b+"',owner,callback);"),this._listeners[a]=d);return d};MO.RListener.prototype.makeSetListener=function(a,b){var d=null;this._listeners[a]?d=this._listeners[a]:(d=new Function("owner","callback","return this.setListener('"+b+"',owner,callback);"),this._listeners[a]=d);return d};
MO.RListener.prototype.makeRemoveListener=function(a,b){var d=null;this._listeners[a]?d=this._listeners[a]:(d=new Function("owner","callback","return this.removeListener('"+b+"',owner,callback);"),this._listeners[a]=d);return d};MO.RListener.prototype.makeClearListener=function(a,b){var d=null;this._listeners[a]?d=this._listeners[a]:(d=new Function("return this.clearListeners('"+b+"');"),this._listeners[a]=d);return d};
MO.RListener.prototype.makeProcessListener=function(a,b){var d=null;this._listeners[a]?d=this._listeners[a]:(d=new Function("p1","p2","p3","p4","p5","p6","return this.processListener('"+b+"', p1, p2, p3, p4, p5, p6);"),this._listeners[a]=d);return d};MO.RListener=new MO.RListener;
MO.APersistence=function(a,b,d){MO.AAnnotation.call(this,a);this._annotationCd=MO.EAnnotation.Persistence;this._ordered=this._inherit=!0;this._dataCd=b;this._dataClass=d;this.dataCd=MO.APersistence_dataCd;this.dataClass=MO.APersistence_dataClass;this.newStruct=MO.APersistence_newStruct;this.newInstance=MO.APersistence_newInstance;this.toString=MO.APersistence_toString;return this};MO.APersistence_dataCd=function(){return this._dataCd};MO.APersistence_dataClass=function(){return this._dataClass};
MO.APersistence_newStruct=function(){return new this._dataClass};MO.APersistence_newInstance=function(){return MO.Class.create(this._dataClass)};MO.APersistence_toString=function(){return"<"+this._annotationCd+",name="+this._name+">"};
MO.AStyle=function(a,b){MO.AAnnotation.call(this,a);this._annotationCd=MO.EAnnotation.Style;this._duplicate=!0;this._style=b;this.code=MO.AStyle_code;this.style=MO.AStyle_style;this.build=MO.AStyle_build;this.toString=MO.AStyle_toString;if(null==b){var d=null;MO.Lang.String.startsWith(a,"_style")?d=a.substring(6):MO.Lang.String.startsWith(a,"style")&&(d=a.substring(5));if(null==d)throw new MO.TError("Style name is empty.");this._style=d}return this};MO.AStyle_code=function(){return this._style};
MO.AStyle_style=function(){return this._style};MO.AStyle_build=function(a){a[this._name]=null};MO.AStyle_toString=function(){return"style="+this._style};
MO.AStyleIcon=function(a,b){MO.AAnnotation.call(this,a);this._annotationCd=MO.EAnnotation.Style;this._style=b;this.code=MO.AStyleIcon_code;this.style=MO.AStyleIcon_style;this.build=MO.AStyleIcon_build;this.toString=MO.AStyleIcon_toString;if(null==b){var d=null;MO.Lang.String.startsWith(a,"_style")?d=a.substring(6):MO.Lang.String.startsWith(a,"style")&&(d=a.substring(5));if(null==d)throw new MO.TError("Style name is empty.");this._style=d}return this};MO.AStyleIcon_code=function(){return this._style};
MO.AStyleIcon_style=function(){return this._style};MO.AStyleIcon_build=function(a){a[this._name]=null};MO.AStyleIcon_toString=function(){return"style="+this._style};MO.EEventInvoke=new function(){this.Unknown=0;this.Before=1;this.After=2;return this};MO.EEventStatus=new function(){this.Unknown=0;this.Continue=1;this.Stop=2;this.Cancel=3;this.Failure=4;return this};
MO.EKeyCode=new function(){this.None=0;this.Esc=27;this.Tab=9;this.Enter=13;this.Shift=16;this.Alt=18;this.Ctrl=17;this.BackSpace=8;this.Space=32;this.Left=37;this.Up=38;this.Right=39;this.Down=40;this.Insert=45;this.Delete=46;this.Home=36;this.End=35;this.PageUp=33;this.PageDown=34;this.F1=112;this.F2=113;this.F3=114;this.F4=115;this.F5=116;this.F6=117;this.F7=118;this.F8=119;this.F9=120;this.F10=121;this.F11=122;this.F12=123;this.N0=48;this.N1=49;this.N2=50;this.N3=51;this.N4=52;this.N5=53;this.N6=
54;this.N7=55;this.N8=56;this.N9=57;this.A=65;this.B=66;this.C=67;this.D=68;this.E=69;this.F=70;this.G=71;this.H=72;this.I=73;this.J=74;this.K=75;this.L=76;this.M=77;this.N=78;this.O=79;this.P=80;this.Q=81;this.R=82;this.S=83;this.T=84;this.U=85;this.V=86;this.W=87;this.X=88;this.Y=89;this.Z=90;this.ControlKeys=[this.Tab,this.Enter,this.BackSpace,this.Left,this.Up,this.Right,this.Down,this.Insert,this.Delete,this.Home,this.End,this.PageUp,this.PageDown,this.F1,this.F2,this.F3,this.F4,this.F5,this.F6,
this.F7,this.F8,this.F9,this.F10,this.F11,this.F12];var a=this.integerCodes={};a[45]=!0;a[190]=!0;for(var b=this.N0;b<=this.N9;b++)a[b]=!0;a=this.floatCodes={};a[45]=!0;a[190]=!0;a[46]=!0;a[189]=!0;for(b=this.N0;b<=this.N9;b++)a[b]=!0;return this};MO.EKeyStatus=new function(){this.Normal=0;this.Press=1;return this};MO.EMouseButton=new function(){this.Left=0;this.Right=2;this.Middle=3;return this};MO.EMouseCursor=new function(){this.HSize="E-resize";this.VSize="N-resize";return this};
MO.MClone=function(a){a=MO.Class.inherits(this,a);a.clone=MO.MClone_clone;return a};MO.MClone_clone=function(){var a=MO.Class.create(this.constructor),b;for(b in this){var d=this[b];null!=d&&(MO.Class.isBaseDataType(d.constructor)||(a[b]=d.clone()));a[b]=d}return a};
MO.MDataStream=function(a){a=MO.Class.inherits(this,a);a._viewer=null;a._endianCd=!1;a._position=0;a.testString=MO.MDataStream_testString;a.readBoolean=MO.MDataStream_readBoolean;a.readInt8=MO.MDataStream_readInt8;a.readInt16=MO.MDataStream_readInt16;a.readInt32=MO.MDataStream_readInt32;a.readInt64=MO.MDataStream_readInt64;a.readUint8=MO.MDataStream_readUint8;a.readUint16=MO.MDataStream_readUint16;a.readUint32=MO.MDataStream_readUint32;a.readUint64=MO.MDataStream_readUint64;a.readFloat=MO.MDataStream_readFloat;
a.readDouble=MO.MDataStream_readDouble;a.readString=MO.MDataStream_readString;a.readBytes=MO.MDataStream_readBytes;a.readData=MO.MDataStream_readData;a.writeBoolean=MO.MDataStream_writeBoolean;a.writeInt8=MO.MDataStream_writeInt8;a.writeInt16=MO.MDataStream_writeInt16;a.writeInt32=MO.MDataStream_writeInt32;a.writeInt64=MO.MDataStream_writeInt64;a.writeUint8=MO.MDataStream_writeUint8;a.writeUint16=MO.MDataStream_writeUint16;a.writeUint32=MO.MDataStream_writeUint32;a.writeUint64=MO.MDataStream_writeUint64;
a.writeFloat=MO.MDataStream_writeFloat;a.writeDouble=MO.MDataStream_writeDouble;a.writeString=MO.MDataStream_writeString;a.writeBytes=MO.MDataStream_writeBytes;a.writeData=MO.MDataStream_writeData;return a};MO.MDataStream_testString=function(){for(var a=this._position,b=this._viewer.getUint16(a,this._endianCd),a=a+2,d=new MO.TString,e=0;e<b;e++){var f=this._viewer.getUint16(a,this._endianCd),a=a+2;d.push(String.fromCharCode(f))}return d.flush()};
MO.MDataStream_readBoolean=function(){var a=this._viewer.getInt8(this._position,this._endianCd);this._position++;return 0<a};MO.MDataStream_readInt8=function(){var a=this._viewer.getInt8(this._position,this._endianCd);this._position++;return a};MO.MDataStream_readInt16=function(){var a=this._viewer.getInt16(this._position,this._endianCd);this._position+=2;return a};MO.MDataStream_readInt32=function(){var a=this._viewer.getInt32(this._position,this._endianCd);this._position+=4;return a};
MO.MDataStream_readInt64=function(){var a=this._viewer.getInt64(this._position,this._endianCd);this._position+=8;return a};MO.MDataStream_readUint8=function(){var a=this._viewer.getUint8(this._position,this._endianCd);this._position+=1;return a};MO.MDataStream_readUint16=function(){var a=this._viewer.getUint16(this._position,this._endianCd);this._position+=2;return a};MO.MDataStream_readUint32=function(){var a=this._viewer.getUint32(this._position,this._endianCd);this._position+=4;return a};
MO.MDataStream_readUint64=function(){var a=this._viewer.getUint64(this._position,this._endianCd);this._position+=8;return a};MO.MDataStream_readFloat=function(){var a=this._viewer.getFloat32(this._position,this._endianCd);this._position+=4;return a};MO.MDataStream_readDouble=function(){var a=this._viewer.getFloat64(this._position,this._endianCd);this._position+=8;return a};
MO.MDataStream_readString=function(){for(var a=this._viewer,b=this._endianCd,d=this._position,e=a.getUint16(d,b),d=d+2,f=new MO.TString,h=0;h<e;h++){var k=a.getUint16(d,b);f.push(String.fromCharCode(k));d+=2}this._position=d;return f.flush()};
MO.MDataStream_readBytes=function(a,b,d){var e=this._viewer;if(!(0>=d)){if(0!=b)throw new MO.TError(this,"Unsupport.");b=this._position;var f=this._endianCd;if(0==d%8){a=new Float64Array(a);d>>=3;for(var h=0;h<d;h++)a[h]=e.getFloat64(b,f),b+=8}else if(0==d%4)for(a=new Uint32Array(a),d>>=2,h=0;h<d;h++)a[h]=e.getUint32(b,f),b+=4;else if(0==d%2)for(a=new Uint16Array(a),d>>=1,h=0;h<d;h++)a[h]=e.getUint16(b,f),b+=2;else for(a=new Uint8Array(a),h=0;h<d;h++)a[h]=e.getUint8(b++,f);this._position=b}};
MO.MDataStream_readData=function(a){switch(a){case MO.EDataType.Int8:return this.readInt8();case MO.EDataType.Int16:return this.readInt16();case MO.EDataType.Int32:return this.readInt32();case MO.EDataType.Int64:return this.readInt64();case MO.EDataType.Uint8:return this.readUint8();case MO.EDataType.Uint16:return this.readUint16();case MO.EDataType.Uint32:return this.readUint32();case MO.EDataType.Uint64:return this.readUint64();case MO.EDataType.Float32:return this.readFloat();case MO.EDataType.Float64:return this.readDouble();
case MO.EDataType.String:return this.readString()}throw new TError(this,"Unknown data cd. (data_cd={1})",a);};MO.MDataStream_writeBoolean=function(a){this._viewer.setInt8(this._position,0<a?1:0,this._endianCd);this._position++};MO.MDataStream_writeInt8=function(a){this._viewer.setInt8(this._position,a,this._endianCd);this._position++};MO.MDataStream_writeInt16=function(a){this._viewer.setInt16(this._position,a,this._endianCd);this._position+=2};
MO.MDataStream_writeInt32=function(a){this._viewer.setInt32(this._position,a,this._endianCd);this._position+=4};MO.MDataStream_writeInt64=function(a){this._viewer.setInt64(this._position,a,this._endianCd);this._position+=8};MO.MDataStream_writeUint8=function(a){this._viewer.setUint8(this._position,a,this._endianCd);this._position+=1};MO.MDataStream_writeUint16=function(a){this._viewer.setUint16(this._position,a,this._endianCd);this._position+=2};
MO.MDataStream_writeUint32=function(a){this._viewer.setUint32(this._position,a,this._endianCd);this._position+=4};MO.MDataStream_writeUint64=function(a){this._viewer.setUint64(this._position,a,this._endianCd);this._position+=8};MO.MDataStream_writeFloat=function(a){this._viewer.setFloat32(this._position,a,this._endianCd);this._position+=4};MO.MDataStream_writeDouble=function(a){this._viewer.setDouble(this._position,a,this._endianCd);this._position+=8};
MO.MDataStream_writeString=function(a){var b=this._viewer,d=v.length,e=this._endianCd,f=this._position;b.setUint16(f,d,e);for(var f=f+2,h=0;h<d;h++)b.setUint16(f,a.charCodeAt(h),e),f+=2;this._position=f};
MO.MDataStream_writeBytes=function(a,b,d){var e=this._viewer;if(!(0>=d)){if(0!=b)throw new MO.TError("Unsupport.");b=this._position;var f=this._endianCd;if(0==d%8){a=new Float64Array(a);d>>=3;for(var h=0;h<d;h++)e.setFloat64(b,a[h],f),b+=8}else if(0==d%4)for(a=new Uint32Array(a),d>>=2,h=0;h<d;h++)e.setUint32(b,a[h],f),b+=4;else if(0==d%2)for(a=new Uint16Array(a),d>>=1,h=0;h<d;h++)e.setUint16(b,a[h],f),b+=2;else for(a=new Uint8Array(a),h=0;h<d;h++)e.setUint8(b++,a[h],f);this._position=b}};
MO.MDataStream_writeData=function(a,b){switch(a){case MO.EDataType.Int8:return this.writeInt8(b);case MO.EDataType.Int16:return this.writeInt16(b);case MO.EDataType.Int32:return this.writeInt32(b);case MO.EDataType.Int64:return this.writeInt64(b);case MO.EDataType.Uint8:return this.writeUint8(b);case MO.EDataType.Uint16:return this.writeUint16(b);case MO.EDataType.Uint32:return this.writeUint32(b);case MO.EDataType.Uint64:return this.writeUint64(b);case MO.EDataType.Float32:return this.writeFloat(b);
case MO.EDataType.Float64:return this.writeDouble(b);case MO.EDataType.String:return this.writeString(b)}throw new TError(this,"Unknown data cd. (data_cd={1})",a);};
MO.MDataView=function(a){a=MO.Class.inherits(this,a);a._viewer=null;a._endianCd=MO.Class.register(a,new MO.AGetSet("_endianCd"),!1);a.getInt8=MO.MDataView_getInt8;a.getInt16=MO.MDataView_getInt16;a.getInt32=MO.MDataView_getInt32;a.getInt64=MO.MDataView_getInt64;a.getUint8=MO.MDataView_getUint8;a.getUint16=MO.MDataView_getUint16;a.getUint32=MO.MDataView_getUint32;a.getUint64=MO.MDataView_getUint64;a.getFloat=MO.MDataView_getFloat;a.getDouble=MO.MDataView_getDouble;a.setInt8=MO.MDataView_setInt8;a.setInt16=
MO.MDataView_setInt16;a.setInt32=MO.MDataView_setInt32;a.setInt64=MO.MDataView_setInt64;a.setUint8=MO.MDataView_setUint8;a.setUint16=MO.MDataView_setUint16;a.setUint32=MO.MDataView_setUint32;a.setUint64=MO.MDataView_setUint64;a.setFloat=MO.MDataView_setFloat;a.setDouble=MO.MDataView_setDouble;return a};MO.MDataView_getInt8=function(a){return this._viewer.getInt8(a,this._endianCd)};MO.MDataView_getInt16=function(a){return this._viewer.getInt16(a,this._endianCd)};
MO.MDataView_getInt32=function(a){return this._viewer.getInt32(a,this._endianCd)};MO.MDataView_getInt64=function(a){return this._viewer.getInt64(a,this._endianCd)};MO.MDataView_getUint8=function(a){return this._viewer.getUint8(a,this._endianCd)};MO.MDataView_getUint16=function(a){return this._viewer.getUint16(a,this._endianCd)};MO.MDataView_getUint32=function(a){return this._viewer.getUint32(a,this._endianCd)};MO.MDataView_getUint64=function(a){return this._viewer.getUint64(a,this._endianCd)};
MO.MDataView_getFloat=function(a){return this._viewer.getFloat32(a,this._endianCd)};MO.MDataView_getDouble=function(a){return this._viewer.getFloat64(a,this._endianCd)};MO.MDataView_setInt8=function(a,b){this._viewer.setInt8(a,b,this._endianCd)};MO.MDataView_setInt16=function(a,b){this._viewer.setInt16(a,b,this._endianCd)};MO.MDataView_setInt32=function(a,b){this._viewer.setInt32(a,b,this._endianCd)};MO.MDataView_setInt64=function(a,b){this._viewer.setInt64(a,b,this._endianCd)};
MO.MDataView_setUint8=function(a,b){this._viewer.setUint8(a,b,this._endianCd)};MO.MDataView_setUint16=function(a,b){this._viewer.setUint16(a,b,this._endianCd)};MO.MDataView_setUint32=function(a,b){this._viewer.setUint32(a,b,this._endianCd)};MO.MDataView_setUint64=function(a,b){this._viewer.setUint64(a,b,this._endianCd)};MO.MDataView_setFloat=function(a,b){this._viewer.setFloat32(a,b,this._endianCd)};MO.MDataView_setDouble=function(a,b){this._viewer.setDouble(a,b,this._endianCd)};
MO.MEncryptedStream=function(a){a=MO.Class.inherits(this,a,MO.MDataStream);a._sign=null;a._signLength=null;a._data=null;a._dataViewer=null;a.testString=MO.MEncryptedStream_testString;a.readBoolean=MO.MEncryptedStream_readBoolean;a.readInt8=MO.MEncryptedStream_readInt8;a.readInt16=MO.MEncryptedStream_readInt16;a.readInt32=MO.MEncryptedStream_readInt32;a.readInt64=MO.MEncryptedStream_readInt64;a.readUint8=MO.MEncryptedStream_readUint8;a.readUint16=MO.MEncryptedStream_readUint16;a.readUint32=MO.MEncryptedStream_readUint32;
a.readUint64=MO.MEncryptedStream_readUint64;a.readFloat=MO.MEncryptedStream_readFloat;a.readDouble=MO.MEncryptedStream_readDouble;a.readString=MO.MEncryptedStream_readString;a.readBytes=MO.MEncryptedStream_readBytes;a.readData=MO.MEncryptedStream_readData;a.writeBoolean=MO.MEncryptedStream_writeBoolean;a.writeInt8=MO.MEncryptedStream_writeInt8;a.writeInt16=MO.MEncryptedStream_writeInt16;a.writeInt32=MO.MEncryptedStream_writeInt32;a.writeInt64=MO.MEncryptedStream_writeInt64;a.writeUint8=MO.MEncryptedStream_writeUint8;
a.writeUint16=MO.MEncryptedStream_writeUint16;a.writeUint32=MO.MEncryptedStream_writeUint32;a.writeUint64=MO.MEncryptedStream_writeUint64;a.writeFloat=MO.MEncryptedStream_writeFloat;a.writeDouble=MO.MEncryptedStream_writeDouble;a.writeString=MO.MEncryptedStream_writeString;a.writeBytes=MO.MEncryptedStream_writeBytes;a.writeData=MO.MEncryptedStream_writeData;return a};
MO.MEncryptedStream_testString=function(){debugger;for(var a=this._position,b=this._viewer.getUint16(a,this._endianCd),a=a+2,d=new MO.TString,e=0;e<b;e++){var f=this._viewer.getUint16(a,this._endianCd),a=a+2;d.push(String.fromCharCode(f))}return d.flush()};MO.MEncryptedStream_readBoolean=function(){var a=this._viewer.getInt8(this._position,this._endianCd)^this._sign[0];this._position++;return 0<a};
MO.MEncryptedStream_readInt8=function(){var a=this._viewer.getInt8(this._position,this._endianCd)^this._sign[0];this._position++;return a};MO.MEncryptedStream_readInt16=function(){for(var a=this._sign,b=this._viewer,d=this._endianCd,e=this._dataViewer,f=0;2>f;f++)e.setUint8(f,b.getUint8(this._position+f,d)^a[f],d);a=e.getInt16(0,d);this._position+=2;return a};
MO.MEncryptedStream_readInt32=function(){for(var a=this._sign,b=this._viewer,d=this._endianCd,e=this._dataViewer,f=0;4>f;f++)e.setUint8(f,b.getUint8(this._position+f,d)^a[f],d);a=e.getInt32(0,d);this._position+=4;return a};MO.MEncryptedStream_readInt64=function(){for(var a=this._sign,b=this._viewer,d=this._endianCd,e=this._dataViewer,f=0;8>f;f++)e.setUint8(f,b.getUint8(this._position+f,d)^a[f],d);a=e.getInt64(0,d);this._position+=8;return a};
MO.MEncryptedStream_readUint8=function(){var a=this._viewer.getUint8(this._position,this._endianCd)^this._sign[0];this._position+=1;return a};MO.MEncryptedStream_readUint16=function(){for(var a=this._sign,b=this._viewer,d=this._endianCd,e=this._dataViewer,f=0;2>f;f++)e.setUint8(f,b.getUint8(this._position+f,d)^a[f],d);a=e.getUint16(0,d);this._position+=2;return a};
MO.MEncryptedStream_readUint32=function(){for(var a=this._sign,b=this._viewer,d=this._endianCd,e=this._dataViewer,f=0;4>f;f++)e.setUint8(f,b.getUint8(this._position+f,d)^a[f],d);a=e.getUint32(0,d);this._position+=4;return a};MO.MEncryptedStream_readUint64=function(){for(var a=this._sign,b=this._viewer,d=this._endianCd,e=this._dataViewer,f=0;8>f;f++)e.setUint8(f,b.getUint8(this._position+f,d)^a[f],d);a=e.getUint64(0,d);this._position+=8;return a};
MO.MEncryptedStream_readFloat=function(){for(var a=this._sign,b=this._viewer,d=this._endianCd,e=this._dataViewer,f=0;4>f;f++)e.setUint8(f,b.getUint8(this._position+f,d)^a[f],d);a=e.getFloat32(0,d);this._position+=4;return a};MO.MEncryptedStream_readDouble=function(){for(var a=this._sign,b=this._viewer,d=this._endianCd,e=this._dataViewer,f=0;8>f;f++)e.setUint8(f,b.getUint8(this._position+f,d)^a[f],d);a=e.getFloat64(0,d);this._position+=8;return a};
MO.MEncryptedStream_readString=function(){var a=this._sign,b=this._signLength,d=this._dataViewer,e=this._viewer,f=this._endianCd,h=this.readUint16();if(0==h)return"";new Uint8Array(this._data);new Uint8Array(this._memory);for(var k=this._position,q=new MO.TString,w=0;w<h;w++){var x=w<<1;d.setUint8(0,e.getUint8(k,f)^a[x%b],f);d.setUint8(1,e.getUint8(k+1,f)^a[(x+1)%b],f);x=d.getUint16(0,f);q.push(String.fromCharCode(x));k+=2}this._position=k;return q.flush()};
MO.MEncryptedStream_readBytes=function(a,b,d){var e=this._viewer;if(!(0>=d)){if(0!=b)throw new MO.TError(this,"Unsupport.");b=this._position;var f=this._endianCd;if(0==d%8){a=new Float64Array(a);d>>=3;for(var h=0;h<d;h++)a[h]=e.getFloat64(b,f),b+=8}else if(0==d%4)for(a=new Uint32Array(a),d>>=2,h=0;h<d;h++)a[h]=e.getUint32(b,f),b+=4;else if(0==d%2)for(a=new Uint16Array(a),d>>=1,h=0;h<d;h++)a[h]=e.getUint16(b,f),b+=2;else for(a=new Uint8Array(a),h=0;h<d;h++)a[h]=e.getUint8(b++,f);this._position=b}};
MO.MEncryptedStream_readData=function(a){switch(a){case MO.EDataType.Int8:return this.readInt8();case MO.EDataType.Int16:return this.readInt16();case MO.EDataType.Int32:return this.readInt32();case MO.EDataType.Int64:return this.readInt64();case MO.EDataType.Uint8:return this.readUint8();case MO.EDataType.Uint16:return this.readUint16();case MO.EDataType.Uint32:return this.readUint32();case MO.EDataType.Uint64:return this.readUint64();case MO.EDataType.Float32:return this.readFloat();case MO.EDataType.Float64:return this.readDouble();
case MO.EDataType.String:return this.readString()}throw new TError(this,"Unknown data cd. (data_cd={1})",a);};MO.MEncryptedStream_writeBoolean=function(a){this._viewer.setInt8(this._position,0<a?1:0,this._endianCd);this._position++};MO.MEncryptedStream_writeInt8=function(a){this._viewer.setInt8(this._position,a,this._endianCd);this._position++};MO.MEncryptedStream_writeInt16=function(a){this._viewer.setInt16(this._position,a,this._endianCd);this._position+=2};
MO.MEncryptedStream_writeInt32=function(a){this._viewer.setInt32(this._position,a,this._endianCd);this._position+=4};MO.MEncryptedStream_writeInt64=function(a){this._viewer.setInt64(this._position,a,this._endianCd);this._position+=8};MO.MEncryptedStream_writeUint8=function(a){this._viewer.setUint8(this._position,a,this._endianCd);this._position+=1};MO.MEncryptedStream_writeUint16=function(a){this._viewer.setUint16(this._position,a,this._endianCd);this._position+=2};
MO.MEncryptedStream_writeUint32=function(a){this._viewer.setUint32(this._position,a,this._endianCd);this._position+=4};MO.MEncryptedStream_writeUint64=function(a){this._viewer.setUint64(this._position,a,this._endianCd);this._position+=8};MO.MEncryptedStream_writeFloat=function(a){this._viewer.setFloat32(this._position,a,this._endianCd);this._position+=4};MO.MEncryptedStream_writeDouble=function(a){this._viewer.setDouble(this._position,a,this._endianCd);this._position+=8};
MO.MEncryptedStream_writeString=function(a){var b=this._sign,d=this._signLength,e=this._viewer,f=v.length,h=this._endianCd,k=this._position;e.setUint16(k,f^b[0],h);for(var k=k+2,q=0;q<f;q++)e.setUint16(k,a.charCodeAt(q)^b[q%d],h),k+=2;this._position=k};
MO.MEncryptedStream_writeBytes=function(a,b,d){var e=this._viewer;if(!(0>=d)){if(0!=b)throw new MO.TError("Unsupport.");b=this._position;var f=this._endianCd;if(0==d%8){a=new Float64Array(a);d>>=3;for(var h=0;h<d;h++)e.setFloat64(b,a[h],f),b+=8}else if(0==d%4)for(a=new Uint32Array(a),d>>=2,h=0;h<d;h++)e.setUint32(b,a[h],f),b+=4;else if(0==d%2)for(a=new Uint16Array(a),d>>=1,h=0;h<d;h++)e.setUint16(b,a[h],f),b+=2;else for(a=new Uint8Array(a),h=0;h<d;h++)e.setUint8(b++,a[h],f);this._position=b}};
MO.MEncryptedStream_writeData=function(a,b){switch(a){case MO.EDataType.Int8:return this.writeInt8(b);case MO.EDataType.Int16:return this.writeInt16(b);case MO.EDataType.Int32:return this.writeInt32(b);case MO.EDataType.Int64:return this.writeInt64(b);case MO.EDataType.Uint8:return this.writeUint8(b);case MO.EDataType.Uint16:return this.writeUint16(b);case MO.EDataType.Uint32:return this.writeUint32(b);case MO.EDataType.Uint64:return this.writeUint64(b);case MO.EDataType.Float32:return this.writeFloat(b);
case MO.EDataType.Float64:return this.writeDouble(b);case MO.EDataType.String:return this.writeString(b)}throw new TError(this,"Unknown data cd. (data_cd={1})",a);};MO.MListenerLoad=function(a){a=MO.Class.inherits(this,a,MO.MListener);a.addLoadListener=MO.MListenerLoad_addLoadListener;a.removeLoadListener=MO.MListenerLoad_removeLoadListener;a.clearLoadListeners=MO.MListenerLoad_clearLoadListeners;a.processLoadListener=MO.MListenerLoad_processLoadListener;return a};
MO.MListenerLoad_addLoadListener=function(a,b){return this.addListener(MO.EEvent.Load,a,b)};MO.MListenerLoad_removeLoadListener=function(a,b){this.removeListener(MO.EEvent.Load,a,b)};MO.MListenerLoad_clearLoadListeners=function(){this.clearListeners(MO.EEvent.Load)};MO.MListenerLoad_processLoadListener=function(a,b,d,e,f){this.processListener(MO.EEvent.Load,a,b,d,e,f)};
MO.MListenerProcess=function(a){a=MO.Class.inherits(this,a,MO.MListener);a.addProcessListener=MO.MListenerProcess_addProcessListener;a.removeProcessListener=MO.MListenerProcess_removeProcessListener;a.clearProcessListeners=MO.MListenerProcess_clearProcessListeners;a.processProcessListener=MO.MListenerProcess_processProcessListener;return a};MO.MListenerProcess_addProcessListener=function(a,b){return this.addListener(MO.EEvent.Process,a,b)};
MO.MListenerProcess_removeProcessListener=function(a,b){this.removeListener(MO.EEvent.Process,a,b)};MO.MListenerProcess_clearProcessListeners=function(){this.clearListeners(MO.EEvent.Process)};MO.MListenerProcess_processProcessListener=function(a,b,d,e,f){this.processListener(MO.EEvent.Process,a,b,d,e,f)};
MO.MListenerTouchZoom=function(a){a=MO.Class.inherits(this,a,MO.MListener);a.addTouchZoomListener=MO.MListenerTouchZoom_addTouchZoomListener;a.removeTouchZoomListener=MO.MListenerTouchZoom_removeTouchZoomListener;a.clearTouchZoomListeners=MO.MListenerTouchZoom_clearTouchZoomListeners;a.processTouchZoomListener=MO.MListenerTouchZoom_processTouchZoomListener;return a};MO.MListenerTouchZoom_addTouchZoomListener=function(a,b){return this.addListener(MO.EEvent.TouchZoom,a,b)};
MO.MListenerTouchZoom_removeTouchZoomListener=function(a,b){this.removeListener(MO.EEvent.TouchZoom,a,b)};MO.MListenerTouchZoom_clearTouchZoomListeners=function(){this.clearListeners(MO.EEvent.TouchZoom)};MO.MListenerTouchZoom_processTouchZoomListener=function(a,b,d,e,f){this.processListener(MO.EEvent.TouchZoom,a,b,d,e,f)};
MO.MMouseCapture=function(a){a=MO.Class.inherits(this,a);a.onMouseCaptureStart=MO.Method.virtual(a,"onMouseCaptureStart");a.onMouseCapture=MO.Method.virtual(a,"onMouseCapture");a.onMouseCaptureStop=MO.Method.virtual(a,"onMouseCaptureStop");a.testMouseCapture=MO.Method.emptyTrue;return a};MO.MMouseWheel=function(a){a=MO.Class.inherits(this,a);a.onMouseWheel=MO.Class.register(a,new MO.AEventMouseWheel("onMouseWheel"),MO.Method.empty);return a};
MO.MParent=function(a){a=MO.Class.inherits(this,a);a._parent=MO.Class.register(a,new MO.AGetSet("_parent"));a.isParent=MO.MParent_isParent;a.findParent=MO.MParent_findParent;a.dispose=MO.MParent_dispose;return a};MO.MParent_isParent=function(a){for(;a;){if(a==this)return!0;a=a.parent()}};MO.MParent_findParent=function(a){var b=this;if(a)for(;MO.Class.isClass(b._parent,a);)b=b.parent();else for(;b._parent;)b=b.parent();return b};MO.MParent_dispose=function(){this._parent=null};
MO.MPersistence=function(a){a=MO.Class.inherits(this,a);a.unserialize=MO.MPersistence_unserialize;a.unserializeBuffer=MO.MPersistence_unserializeBuffer;a.unserializeSignBuffer=MO.MPersistence_unserializeSignBuffer;a.unserializeEncryptedBuffer=MO.MPersistence_unserializeEncryptedBuffer;a.serialize=MO.MPersistence_serialize;a.serializeBuffer=MO.MPersistence_serializeBuffer;a.serializeSignBuffer=MO.MPersistence_serializeSignBuffer;a.serializeEncryptedBuffer=MO.MPersistence_serializeEncryptedBuffer;return a};
MO.MPersistence_unserialize=function(a){for(var b=MO.Class.find(this.constructor).annotations(MO.EAnnotation.Persistence),d=b.count(),e=0;e<d;e++){var f=b.at(e),h=f.dataCd(),k=f.name();if(h==MO.EDataType.Struct)(h=this[k])||(h=this[k]=f.newStruct()),h.unserialize(a);else if(h==MO.EDataType.Object)(h=this[k])||(h=this[k]=f.newInstance()),h.unserialize(a);else if(h==MO.EDataType.Objects){var q=this[k];q||(q=this[k]=new MO.TObjects);q.clear();for(var k=a.readInt32(),w=0;w<k;w++)h=f.newInstance(),h.unserialize(a),
q.push(h)}else if(h==MO.EDataType.Dictionary)for((q=this[k])||(q=this[k]=new MO.TDictionary),q.clear(),k=a.readInt32(),w=0;w<k;w++)h=f.newInstance(),h.unserialize(a),q.set(h.code(),h);else this[k]=a.readData(h)}};MO.MPersistence_unserializeBuffer=function(a,b){var d=MO.Class.create(MO.FDataView);d.setEndianCd(b);d.link(a);this.unserialize(d);d.dispose()};
MO.MPersistence_unserializeSignBuffer=function(a,b,d){var e=new Uint8Array(b);MO.Lang.Byte.encodeBytes(e,0,e.length,a);a=MO.Class.create(MO.FDataView);a.setEndianCd(d);a.link(b);this.unserialize(a);a.dispose()};MO.MPersistence_unserializeEncryptedBuffer=function(a,b,d){var e=MO.Class.create(MO.FEncryptedView);e.setSign(a);e.setEndianCd(d);e.link(b);this.unserialize(e);e.dispose()};
MO.MPersistence_serialize=function(a){a=MO.Class.find(this.constructor).annotations(MO.EAnnotation.Persistence);for(var b=a.count(),d=0;d<b;d++){var e=a.at(d),f=e.dataCd(),e=this[e.name()];if(f==MO.EDataType.Object)e.unserialize(input);else if(f==MO.EDataType.Objects)for(f=e.count(),input.writeInt32(f),d=0;d<f;d++){var h=e.at(d);h.serialize(input)}else if(f==MO.EDataType.Dictionary)for(f=e.count(),input.writeInt32(f),d=0;d<f;d++)h=e.at(d),h.serialize(input);else input.writeData(f,e)}};
MO.MPersistence_serializeBuffer=function(a,b){var d=MO.Class.create(MO.FDataView);d.setEndianCd(b);d.link(a);this.serialize(d);d.dispose()};MO.MPersistence_serializeSignBuffer=function(a,b){var d=MO.Class.create(MO.FDataView);d.setEndianCd(b);d.link(a);this.serialize(d);d.dispose()};MO.MPersistence_serializeEncryptedBuffer=function(a,b,d){var e=MO.Class.create(MO.FEncryptedView);e.setSign(a);e.setEndianCd(d);e.link(b);this.serialize(e);e.dispose()};
MO.MProperty=function(a){a=MO.Class.inherits(this,a);a.propertyAssign=MO.MProperty_propertyAssign;a.propertyLoad=MO.MProperty_propertyLoad;a.propertySave=MO.MProperty_propertySave;return a};MO.MProperty_propertyAssign=function(a){var b=MO.Class.find(this.constructor).annotations(MO.EAnnotation.Property),d;for(d in b){var e=b[d];e.constructor!=Function&&(this[e._name]=a[e._name])}};
MO.MProperty_propertyLoad=function(a){var b=MO.Class.find(this.constructor).annotations(MO.EAnnotation.Property),d;for(d in b){var e=b[d];e.constructor!=Function&&(e._force?e.load(this,a):a.contains(e._linker)?e.load(this,a):null==this[e._name]&&(this[e._name]=e._value))}};MO.MProperty_propertySave=function(a){var b=MO.Class.find(this.constructor).annotations(MO.EAnnotation.Property),d;for(d in b){var e=b[d];e.constructor!=Function&&e.save(this,a)}};
MO.SClickEvent=function(a){MO.SEvent.call(this,a);return this};MO.SXmlEvent=function(){MO.SEvent.call(this);this.root=this.document=this.connection=null;return this};MO.THtmlItem=function(){this._link=null;this._links={};this.get=MO.THtmlItem_get;this.set=MO.THtmlItem_set;return this};MO.THtmlItem_get=function(a){return this._links[a]};MO.THtmlItem_set=function(a,b){this._links[a]=b};
MO.TXmlDocument=function(){this._root=null;this.create=MO.TXmlDocument_create;this.root=MO.TXmlDocument_root;this.setRoot=MO.TXmlDocument_setRoot;this.xml=MO.TXmlDocument_xml;this.dump=MO.TXmlDocument_dump;return this};MO.TXmlDocument_create=function(a,b,d){var e=new MO.TXmlNode;e._name=a;e._attributes=b;e._value=d;return e};MO.TXmlDocument_root=function(){var a=this._root;a||(a=this._root=new MO.TXmlNode,a._name="Configuration");return a};
MO.TXmlDocument_setRoot=function(a){if(this._root)throw new MO.TError(this,"Root node is already exists.");this._root=a};MO.TXmlDocument_xml=function(){var a=new MO.TString;a.append("<?xml version='1.0' encoding='UTF-8'?>");this.root().innerXml(a,0);return a.flush()};MO.TXmlDocument_dump=function(){var a=new MO.TString;a.appendLine(MO.RClass.name(this));this.root().dump(a);return a.flush()};
MO.TXmlNode=function(a){MO.TNode.call(this,a);this.create=MO.TXmlNode_create;this.innerXml=MO.TXmlNode_innerXml;this.xml=MO.TXmlNode_xml;this.toString=MO.TXmlNode_toString;return this};MO.TXmlNode_create=function(a,b){var d=new MO.TXmlNode;d._name=a;d._attributes=b;if(!MO.Class.isClass(b,MO.TAttributes))for(var e=arguments,f=e.length,h=1;h<f;h+=2)h+1<f?d.set(e[h],e[h+1]):d.setValue(e[h]);this.push(d);return d};
MO.TXmlNode_innerXml=function(a,b){a.appendRepeat("   ",b);a.append("<",this._name);var d=this._attributes;if(d)for(var e=d.count(),f=0;f<e;f++)a.append(" ",d.name(f),'="'),MO.RXml.buildText(a,d.value(f)),a.append('"');this._nodes||null!=this._value||a.append("/");a.append(">\n");if(d=this._nodes)for(e=d.count(),f=0;f<e;f++)d.get(f).innerXml(a,b+1);MO.RXml.buildText(a,this._value);if(this._nodes||null!=this._value)a.appendRepeat("   ",b),a.append("</",this._name,">"),a.append("\n");return a};
MO.TXmlNode_xml=function(){var a=new MO.TString;this.innerXml(a,0);return a.flush()};MO.TXmlNode_toString=function(){return this.xml().toString()};
MO.FBufferedSocket=function(a){a=MO.Class.inherits(this,a,MO.FSocket);a._bufferSends=MO.Class.register(a,new MO.AGetter("_bufferSends"));a._bufferReceives=MO.Class.register(a,new MO.AGetter("_bufferReceives"));a.onOpen=MO.FBufferedSocket_onOpen;a.construct=MO.FBufferedSocket_construct;a.push=MO.FBufferedSocket_push;a.process=MO.FBufferedSocket_process;a.dispose=MO.FBufferedSocket_dispose;return a};MO.FBufferedSocket_onOpen=function(a){this.__base.FSocket.onOpen.call(this,a);this.process()};
MO.FBufferedSocket_ohError=function(a){};MO.FBufferedSocket_ohMessage=function(a){};MO.FBufferedSocket_ohClose=function(a){this._linker._connected=!1};MO.FBufferedSocket_construct=function(){this.__base.FSocket.construct.call(this);this._bufferSends=new MO.TObjects;this._bufferReceives=new MO.TObjects};MO.FBufferedSocket_push=function(a){this._bufferSends.push(a)};
MO.FBufferedSocket_process=function(){if(!this._connected)return!1;var a=this._bufferSends;if(!a.isEmpty()){for(var b=a.count(),d=0;d<b;d++){var e=a.at(d);this.send(e)}a.clear()}return!0};MO.FBufferedSocket_dispose=function(){this._bufferSends=MO.Lang.Object.dispose(this._bufferSends);this._bufferReceives=MO.Lang.Object.dispose(this._bufferReceives);this.__base.FSocket.dispose.call(this)};
MO.FBytes=function(a){a=MO.Class.inherits(this,a,MO.FObject,MO.MDataView);a._memory=MO.Class.register(a,new MO.AGetter("_memory"));a.construct=MO.FBytes_construct;a.dispose=MO.FBytes_dispose;return a};MO.FBytes_construct=function(){this.__base.FObject.construct.call(this);this._memory=new ArrayBuffer;this._viewer=new DataView(this._memory)};MO.FBytes_dispose=function(){this._viewer=this._memory=null;this.__base.FObject.dispose.call(this)};
MO.FClassFactory=function(a){a=MO.Class.inherits(this,a,MO.FObject);a._classes=null;a.construct=MO.FClassFactory_construct;a.register=MO.FClassFactory_register;a.unregister=MO.FClassFactory_unregister;a.create=MO.FClassFactory_create;a.dispose=MO.FClassFactory_dispose;return a};MO.FClassFactory_construct=function(){this.__base.FObject.construct.call(this);this._classes=new MO.TDictionary};MO.FClassFactory_register=function(a,b){this._classes.set(a,b)};
MO.FClassFactory_unregister=function(a){this._classes.set(a,null)};MO.FClassFactory_create=function(a){var b=this._classes.get(a);if(!b)throw new MO.TError("Create unregister class. (name={1})",a);return MO.Class.create(b)};MO.FClassFactory_dispose=function(){this._classes=MO.Lang.Object.dispose(this._classes);this.__base.FObject.dispose.call(this)};
MO.FComponent=function(a){a=MO.Class.inherits(this,a,MO.FObject,MO.MParent);a._code=MO.Class.register(a,new MO.AGetSet("_code"));a.dispose=MO.FComponent_dispose;return a};MO.FComponent_dispose=function(){this.__base.MParent.dispose.call(this);this.__base.FObject.dispose.call(this)};
MO.FDataStream=function(a){a=MO.Class.inherits(this,a,MO.FObject,MO.MDataView,MO.MDataStream);a._length=MO.Class.register(a,new MO.AGetter("_length"),0);a._memory=MO.Class.register(a,new MO.AGetter("_memory"));a._viewer=null;a.construct=MO.FDataStream_construct;a.setLength=MO.FDataStream_setLength;a.flip=MO.FDataStream_flip;a.dispose=MO.FDataStream_dispose;return a};MO.FDataStream_construct=function(){this.__base.FObject.construct.call(this)};
MO.FDataStream_setLength=function(a){this._length=a;this._memory=new ArrayBuffer(a);this._viewer=new DataView(this._memory)};MO.FDataStream_flip=function(){this._length=this._position;this._position=0};MO.FDataStream_dispose=function(){this._memory=this._viewer=null;this.__base.FObject.dispose.call(this)};MO.FDataView=function(a){a=MO.Class.inherits(this,a,MO.FObject,MO.MDataView,MO.MDataStream);a.link=MO.FDataView_link;a.dispose=MO.FDataView_dispose;return a};
MO.FDataView_link=function(a){this._memory=a;this._viewer=new DataView(a)};MO.FDataView_dispose=function(){this._memory=this._viewer=null;this.__base.FObject.dispose.call(this)};MO.FEncryptedView=function(a){a=MO.Class.inherits(this,a,MO.FObject,MO.MDataView,MO.MEncryptedStream);a.construct=MO.FEncryptedView_construct;a.setSign=MO.FEncryptedView_setSign;a.link=MO.FEncryptedView_link;a.dispose=MO.FEncryptedView_dispose;return a};
MO.FEncryptedView_construct=function(){this.__base.FObject.construct.call(this);this._data=new ArrayBuffer(8);this._dataViewer=new DataView(this._data)};MO.FEncryptedView_setSign=function(a){var b=this._sign=new Uint8Array(8);b[0]=a&255;b[1]=a>>8&255;b[2]=a>>16&255;b[3]=a>>24&255;b[4]=a>>24&255;b[5]=a>>16&255;b[6]=a>>8&255;b[7]=a&255;this._signLength=b.length};MO.FEncryptedView_link=function(a){this._memory=a;this._viewer=new DataView(a)};
MO.FEncryptedView_dispose=function(){this._data=this._sign=null;this._memory=this._viewer=this._dataViewer=this._dataViewer.buffer=null;this.__base.FObject.dispose.call(this)};
MO.FFileReader=function(a){a=MO.Class.inherits(this,a,MO.FObject,MO.MListenerLoad);a._reader=null;a._fileName=MO.Class.register(a,new MO.AGetter("_fileName"));a._length=MO.Class.register(a,new MO.AGetter("_length"),0);a._data=MO.Class.register(a,new MO.AGetter("_data"));a._statusLoading=!1;a.ohloadStart=MO.FFileReader_ohLoadStart;a.ohLoad=MO.FFileReader_ohLoad;a.ohLoadEnd=MO.FFileReader_ohLoadEnd;a.ohProgress=MO.FFileReader_ohProgress;a.construct=MO.FFileReader_construct;a.loadFile=MO.FFileReader_loadFile;
a.dispose=MO.FFileReader_dispose;return a};MO.FFileReader_ohLoadStart=function(){};MO.FFileReader_ohLoad=function(){};MO.FFileReader_ohLoadEnd=function(){var a=this.__linker,b=a._reader;a._statusFree=!0;b.error?MO.Logger.error(a,"Load file failure. (error={1])",b.error):(a._length=b.result.byteLength,a._data=b.result,b=new MO.SEvent(a),a.processLoadListener(b),b.dispose())};MO.FFileReader_ohProgress=function(){};
MO.FFileReader_construct=function(){this.__base.FObject.construct.call(this);var a=this._reader=new FileReader;a.__linker=this;a.onloadstart=this.ohLoadStart;a.onload=this.ohLoad;a.onloadend=this.ohLoadEnd;a.onprogress=this.ohProgress};MO.FFileReader_loadFile=function(a){this._fileName=a.name;this._length=a.size;this._reader.readAsArrayBuffer(a)};
MO.FFileReader_dispose=function(){var a=this._reader;a.__linker=null;a.onloadstart=null;a.onload=null;a.onloadend=null;this._data=this._fileName=this._reader=a.onprogress=null;this.__base.MListenerLoad.dispose.call(this);this.__base.FObject.dispose.call(this)};MO.FJsonConnection=function(a){a=MO.Class.inherits(this,a,MO.FHttpConnection);a._contentCd=MO.EHttpContent.Text;a._content=null;a.onConnectionComplete=MO.FJsonConnection_onConnectionComplete;a.content=MO.FJsonConnection_content;return a};
MO.FJsonConnection_onConnectionComplete=function(){this._statusFree=!0;var a=null,b=this._outputData;b&&(a=this._content=JSON.parse(b));var d=this._event;d.connection=this;d.data=b;d.content=a;this.processLoadListener(d);this.processCompleteListener(d)};MO.FJsonConnection_content=function(){return this._content};
MO.FSocket=function(a){a=MO.Class.inherits(this,a,MO.FObject);a._connected=MO.Class.register(a,new MO.AGetter("_connected"),!1);a._handle=MO.Class.register(a,new MO.AGetter("_handle"));a.onOpen=MO.FSocket_onOpen;a.ohOpen=MO.FSocket_ohOpen;a.ohError=MO.FSocket_ohError;a.ohMessage=MO.FSocket_ohMessage;a.ohClose=MO.FSocket_ohClose;a.construct=MO.FSocket_construct;a.connect=MO.FSocket_connect;a.send=MO.FSocket_send;a.disconnect=MO.FSocket_disconnect;a.dispose=MO.FSocket_dispose;return a};
MO.FSocket_onOpen=function(a){this._connected=!0};MO.FSocket_ohOpen=function(a){this._linker.onOpen(a)};MO.FSocket_ohError=function(a){};MO.FSocket_ohMessage=function(a){};MO.FSocket_ohClose=function(a){this._linker._connected=!1};MO.FSocket_construct=function(){this.__base.FObject.construct.call(this)};MO.FSocket_connect=function(a){a=this._handle=new WebSocket(a);a._linker=this;a.onopen=this.ohOpen;a.onerror=this.ohError;a.onmessage=this.ohMessage;a.onclose=this.ohClose};MO.FSocket_send=function(a){this._handle.send(a)};
MO.FSocket_disconnect=function(){this._handle.close()};MO.FSocket_dispose=function(){this._handle=null;this.__base.FObject.dispose.call(this)};MO.FXmlConnection=function(a){a=MO.Class.inherits(this,a,MO.FHttpConnection);a._contentCd=MO.EHttpContent.Text;a._inputNode=null;a._outputNode=null;a.onConnectionSend=MO.FXmlConnection_onConnectionSend;a.onConnectionComplete=MO.FXmlConnection_onConnectionComplete;a.content=MO.FXmlConnection_content;return a};
MO.FXmlConnection_onConnectionSend=function(){var a=this._input;if(a){var b=null;if(a.constructor==String)b=a,this._inputNode=null;else if(a.constructor==MO.TXmlNode)b=new MO.TXmlDocument,b.setRoot(a),b=b.xml(),this._inputNode=a;else if(a.constructor==MO.TXmlDocument)b=a.xml(),this._inputNode=a.root();else throw new MO.TError("Unknown send data type.");this._inputData=b;this._contentLength=b.length}};
MO.FXmlConnection_onConnectionComplete=function(){var a=this._handle,b=null;if(a.responseXML)b=a.responseXML.documentElement;else if(a.responseXml)b=a.responseXml.documentElement;else throw new MO.TError(this,"Fetch xml data failure.");if(!b)return MO.Logger.fatal(this,"Read xml error. (url={1})\n{2}",this._url,c._outputText);a=new MO.TXmlDocument;MO.Lang.Xml.buildNode(a,null,b);b=this._outputNode=a.root();this._statusFree=!0;var d=this._event;d.connection=this;d.document=a;d.root=b;d.content=b;d.parameters=
this._parameters;this.processLoadListener(d);d.dispose();this._asynchronous&&(this._parameters=this._outputNode=this._output=this._inputNode=this._input=null)};MO.FXmlConnection_content=function(){return this._outputNode};MO.FXmlData=function(a){a=MO.Class.inherits(this,a,MO.FObject);a._ready=null;a._config=null;a.testReady=MO.FXmlData_testReady;return a};MO.FXmlData_testReady=function(){return this._ready};
MO.REngine=function(){this._spaces={};this.Global={};this.Top={};this.Local={};this.onRelease=MO.REngine_onRelease;this.register=MO.REngine_register;this.initialize=MO.REngine_initialize;this.connect=MO.REngine_connect;this.buildSpace=MO.REngine_buildSpace;this.find=MO.REngine_find;this.findGlobal=MO.REngine_findGlobal;this.findTop=MO.REngine_findTop;this.findLocal=MO.REngine_findLocal;return this};MO.REngine_onRelease=function(){MO.RConsole.release();MO.REvent.release();CollectGarbage()};
MO.REngine_register=function(a){var b=this._spaces[a.space];b||(b=this._spaces[a.space]={});b[a.name]=a};MO.REngine_initialize=function(){MO.RConsole.initialize()};MO.REngine_connect=function(){MO.RConsole.initialize()};MO.REngine_buildSpace=function(a,b){for(var d in b)MO.Lang.String.startsWith(d,"R")&&(a[d.substring(1)]=b[d].instance)};MO.REngine_find=function(a,b){var d=null;if(a=this._spaces[a])if(d=a[b])return d.instance;return null};
MO.REngine_findGlobal=function(a){return this.find(MO.ESpace.Global,a)};MO.REngine_findTop=function(a){return top.MO.REngine.find(MO.ESpace.Top,a)};MO.REngine_findLocal=function(a){return this.find(MO.ESpace.Local,a)};MO.REngine=new MO.REngine;
MO.RLoader=function(){this._loading=new MO.TArray;this._loaded=new MO.TArray;this._waits=new MO.TArray;this.hWindow=this._intervalId=null;this.onInterval=MO.RLoader_onInterval;this.intervalStart=MO.RLoader_intervalStart;this.intervalStop=MO.RLoader_intervalStop;this.loadJsFile=MO.RLoader_loadJsFile;this.loadJs=MO.RLoader_loadJs;this.loaded=MO.RLoader_loaded;this.wait=MO.RLoader_wait;this.waitJs=MO.RLoader_waitJs;this.dispose=MO.RLoader_dispose;return this};
MO.RLoader_dispose=function(){this.intervalStop();this.hWindow=null};MO.RLoader_onInterval=function(){for(var a=this._waits,b=a.length,d=0;d<b;d++){var e=a.get(d);e&&e.check(this._loaded)&&(e.invoke.invoke(),a.set(d,null))}a.compress();a.isEmpty()&&this.intervalStop()};MO.RLoader_intervalStart=function(){var a=this;a._intervalId||(a.hWindow=window,a._intervalId=window.setInterval(function(){a.onInterval()},10))};
MO.RLoader_intervalStop=function(){var a=this.hWindow;a&&this._intervalId&&(a.clearInterval(this._intervalId),this._intervalId=this.hWindow=null)};
MO.RLoader_loadJsFile=function(a,b){var d=this,e=MO.RWindow.hDocument,f=e.getElementsByTagName("head")[0];if(null==document.getElementById(a)){var h=top.MO.RContext.location(b),k=MO.RWindow.createElement("SCRIPT");k.id=a;k.type="text/javascript";k.src=h;e.attachEvent?k.onreadystatechange=function(){var b=k.readyState;if("loaded"==b||"complete"==b)k.onreadystatechange=null,d._loading.extract(a),d._loaded.push(a)}:k.onload=function(){"complete"==e.readyState&&(k.onload=null,d._loading.extract(a),d._loaded.push(a))};
f.appendChild(k)}};MO.RLoader_loadJs=function(a){for(var b=arguments,d=b.length,e=0;e<d;e++){var f=b[e];this.loadJsFile("js:"+f,"/ajs/"+f.replace(/\./g,"/")+".js")}};MO.RLoader_loaded=function(a){this._loading.extract(a);this._loaded.push(a)};MO.RLoader_wait=function(a,b){var d=new MO.TLoaderListener;d.invoke=a;for(var e=arguments.length,f=1;f<e;f++)d.ids.push(arguments[f]);this._waits.push(d);this.intervalStart()};
MO.RLoader_waitJs=function(a,b){var d=new MO.TLoaderListener;d.invoke=a;for(var e=arguments,f=e.length,h=1;h<f;h++)d.ids.push("js:"+e[h]);this._waits.push(d);this.intervalStart()};MO.RLoader=new MO.RLoader;
MO.RMessage=function(){this._hasError=!1;this._messages=null;this.push=MO.RMessage_push;this.fatal=MO.RMessage_fatal;this.confirmResult=!1;this.error=MO.RMessage_error;this.warn=MO.RMessage_warn;this.onWindowClose=MO.RMessage_onWindowClose;this.confirm=MO.RMessage_confirm;this.info=MO.RMessage_info;return this};MO.RMessage_push=function(a){this._messages||(this._messages=new FLoopList);this._messages.push(a)};
MO.RMessage_fatal=function(a,b,d,e){if(!this._hasError){this._hasError=!0;for(var f=new MO.TString,h=[],k=MO.RMessage_fatal.caller;k&&!MO.Lang.Array.contains(h,k);)h.push(k),k=k.caller;for(var q=h.length,w=0;w<q;w++)k=h[w],0<w&&f.appendLine(),f.append("   "+(q-w)+": "+MO.Method.name(k));h=new MO.TString;h.appendLine(MO.RContext.get("RMessage:fatal"));h.appendLine(MO.Lang.String.repeat("-",60));h.append(MO.Class.dump(a),": ");if(d)for(k=arguments,q=k.length,w=3;w<q;w++){var x=k[w];"function"==typeof x&&
(x=MO.Method.name(x));d=d.replace("{"+(w-2)+"}",x)}h.appendLine(d);h.appendLine(MO.String.repeat("-",60));h.appendLine("Stack:");h.append(f);alert(h)}};MO.RMessage_error=function(a,b,d,e){if(!this._hasError)throw this._hasError=!0,Error(d);};MO.RMessage_warn=function(a,b,d){new MO.TString;a=top.MO.RControl.create(MO.FAlertWindow);a.setText(b);a.show()};MO.RMessage_info=function(a,b,d){new MO.TString;a=top.MO.RControl.create(MO.FInfoWindow);a.setText(b);a.show()};
MO.RMessage_confirm=function(a,b){var d=top.MO.RControl.create(MO.FConfirmWindow);d.setText(a);d.lsns.register(this,b);d.show()};MO.RMessage_onWindowClose=function(a){this.confirmResult=a};MO.RMessage=new MO.RMessage;MO.RStyle=function(){this._connected=!1;this._rules=new MO.TMap;this.connect=MO.RStyle_connect;this.has=MO.RStyle_has;this.nvl=MO.RStyle_nvl;this.style=MO.RStyle_style;return this};
MO.RStyle_connect=function(){if(!this._connected){for(var a=this._rules,b=document.styleSheets,d=b.length,e=0;e<d;e++){var f=b[e].cssRules;if(f)for(var h=f.length,k=0;k<h;k++){var q=f[k];a.set(q.selectorText,q)}}this._connected=!0}};MO.RStyle_has=function(a){this._connected||this.connect();return a?this._rules.contains("."+a.toLowerCase()):!1};MO.RStyle_nvl=function(a,b){this.connect();var d=arguments,e=d.length;for(b=0;b<e;b++)if((a=d[b])&&this._rules.contains("."+a.toLowerCase()))return a;return null};
MO.RStyle_style=function(a,b){return MO.Class.name(a)+"_"+b};MO.RStyle=new MO.RStyle;MO.RTypeArray=function(){this._float4=this._float3=null;this._data={};return this};MO.RTypeArray.prototype.float3=function(){var a=this._float3;null==a&&(a=this._float3=new Float32Array(3));return a};MO.RTypeArray.prototype.float4=function(){var a=this._float4;null==a&&(a=this._float4=new Float32Array(4));return a};
MO.RTypeArray.prototype.createArray=function(a,b){switch(a){case MO.EDataType.Boolean:case MO.EDataType.Int8:return new Int8Array(b);case MO.EDataType.Int16:return new Int16Array(b);case MO.EDataType.Int32:return new Int32Array(b);case MO.EDataType.Int64:return new Int64Array(b);case MO.EDataType.Uint8:return new Uint8Array(b);case MO.EDataType.Uint16:return new Uint16Array(b);case MO.EDataType.Uint32:return new Uint32Array(b);case MO.EDataType.Float32:return new Float32Array(b);case MO.EDataType.Float64:return new Float64Array(b)}throw new TError("Create unknown type array. (type={1}, length={2})",
a,b);};MO.RTypeArray.prototype.findTemp=function(a,b){var d=this._data,e=d[a];null==e&&(e=d[a]={});d=e[b];null==d&&(d=e[b]=this.createArray(a,b));return d};MO.Lang.TypeArray=new MO.RTypeArray;MO.RXml=function(){return this};MO.RXml.prototype.isNode=function(a){return MO.Class.isName(a,"TNode")};MO.RXml.prototype.formatText=function(a){null!=a&&(a=a.replace(/\\n/g,"\n"));return a};
MO.RXml.prototype.buildText=function(a,b){if(null!=b){b=b.toString();for(var d=b.length,e=0;e<d;e++){var f=b.charAt(e);switch(f){case "<":a.append("&lt;");break;case ">":a.append("&gt;");break;case "&":a.append("&amp;");break;case "'":a.append("&apos;");break;case '"':a.append("&quot;");break;case "\r":continue;case "\n":a.append("\\n");break;default:a.append(f)}}}return a};
MO.RXml.prototype.buildNode=function(a,b,d){var e=null,f=d.attributes;if(f){var h=f.length;if(0<h)for(var e=new MO.TAttributes,k=0;k<h;k++){var q=f[k];q.nodeName&&e.set(q.nodeName,this.formatText(q.value))}}h=new MO.TString;h.append(d.value);if(f=d.childNodes)for(q=f.length,k=0;k<q;k++){var w=f[k],x=w.nodeType;x==MO.ENodeType.Text?h.append(w.nodeValue):x==MO.ENodeType.Data&&h.append(w.data)}d=a.create(d.nodeName,e,MO.Lang.String.trim(h.toString()));b?b.push(d):a._root=d;if(f)for(b=f.length,k=0;k<
b;k++)f[k].nodeType==MO.ENodeType.Node&&this.buildNode(a,d,f[k])};MO.RXml.prototype.makeNode=function(a){if(a.documentElement){var b=new MO.TXmlDocument;this.buildNode(b,null,a.documentElement);return b.root()}if("SCRIPT"==a.tagName){var d=a.textContent;d||(d=a.text);if(d)return b=new MO.TXmlDocument,a=this.makeString(d),this.buildNode(b,null,a.documentElement),b.root()}return null};
MO.RXml.prototype.makeDocument=function(a){var b=new MO.TXmlDocument;a.documentElement&&this.buildNode(b,null,a.documentElement);return b};
MO.RXml.prototype.unpack=function(a,b){if(MO.Lang.String.isEmpty(a))return null;b||(b=new MO.TNode);var d=new MO.TAttributes;d.unpack(a);b.name=d.get("name");b.value=d.get("value");d.contains("attributes")&&b.attributes().unpack(d.get("attributes"));if(d.contains("nodes")){var e=new MO.TStrings;e.unpack(d.get("nodes"));for(d=0;d<e.count;d++)this.unpack(e.get(d),b.create())}return b};
MO.RXml.prototype.saveObject=function(a,b,d){for(var e in d){var f=d[e];if(null!=f){var h=a.create(b);h.set("name",e);switch(typeof f){case "boolean":case "number":case "date":case "string":h.setValue(f);break;case "function":h.setValue(MO.Method.name(f));break;case "object":this.saveObject(h,"Property",f);break;default:throw new MO.TError("Invalid object.");}}}};MO.Lang.Xml=new MO.RXml;
MO.FTag=function(a){a=MO.Class.inherits(this,a,MO.FObject);a._name="Tag";a._children=null;a._trimLeft=!1;a._trimRight=!1;a.onBegin=MO.FTag_onBegin;a.onEnd=MO.FTag_onEnd;a.name=MO.FTag_name;a.set=MO.FTag_set;a.push=MO.FTag_push;a.parse=MO.FTag_parse;a.toString=MO.FTag_toString;a.innerDump=MO.FTag_innerDump;a.dump=MO.FTag_dump;return a};MO.FTag_onBegin=function(a){return MO.EResult.Continue};MO.FTag_onEnd=function(a){return MO.EResult.Continue};MO.FTag_name=function(){return this._name};
MO.FTag_set=function(a,b){throw new MO.TError(this,"Unknown attribute name. (name={1}, value={2})",a,b);};MO.FTag_push=function(a){var b=this._children;null==b&&(b=this._children=new MO.TObjects);b.push(a)};MO.FTag_parse=function(a){var b=this.onBegin(a);if(b==MO.EResult.Continue){var d=this._children;if(d)for(var e=d.count(),f=0;f<e;f++){var h=d.get(f),b=h.parse(a);if(b==MO.EResult.Cancel)return b;a._trimLeft=h._trimLeft;a._trimRight=h._trimRight}return this.onEnd(a)}return b};MO.FTag_toString=function(){return null};
MO.FTag_innerDump=function(a,b,d){a.appendRepeat("   ",d);a.append(MO.Class.dump(b));var e=b.toString();MO.MO.Lang.String.isEmpty(e)||a.append(" [",e,"]");if(b=b._children){a.append("\n");for(var e=b.count(),f=0;f<e;f++){var h=b.get(f);this.innerDump(a,h,d+1);f<e-1&&a.append("\n")}}};MO.FTag_dump=function(){var a=new MO.TString;this.innerDump(a,this,0);return a.toString()};
MO.FTagContext=function(a){a=MO.Class.inherits(this,a,MO.FObject,MO.MInstance);a._trimLeft=!1;a._trimRight=!1;a._attributes=MO.Class.register(a,new MO.AGetter("_attributes"));a._source=null;a.construct=MO.FTagContext_construct;a.instanceAlloc=MO.FTagContext_instanceAlloc;a.get=MO.FTagContext_get;a.set=MO.FTagContext_set;a.setBoolean=MO.FTagContext_setBoolean;a.source=MO.FTagContext_source;a.write=MO.FTagContext_write;a.resetSource=MO.FTagContext_resetSource;a.dispose=MO.FTagContext_dispose;return a};
MO.FTagContext_construct=function(){this.__base.FObject.construct.call(this);this._attributes=new MO.TAttributes;this._source=new MO.TString};MO.FTagContext_instanceAlloc=function(){this._attributes.clear()};MO.FTagContext_get=function(a,b){return this._attributes.get(a,b)};MO.FTagContext_set=function(a,b){this._attributes.set(a,b)};MO.FTagContext_setBoolean=function(a,b){this._attributes.set(a,MO.RBoolean.toString(b))};MO.FTagContext_source=function(){return this._source.toString()};
MO.FTagContext_write=function(a){MO.Lang.String.isEmpty(a)||this._source.append(a)};MO.FTagContext_resetSource=function(a){this._source.clear()};MO.FTagContext_dispose=function(){this._attributes=RObject.dispose(this._attributes);this._source=RObject.dispose(this._source);this.__base.FObject.dispose.call(this)};
MO.FTagDocument=function(a){a=MO.Class.inherits(this,a,MO.FObject);a._space=MO.Class.register(a,MO.AGetSet("_space"));a._root=MO.Class.register(a,MO.AGetter("_root"));a.create=MO.FTagDocument_create;a.loadNode=MO.FTagDocument_loadNode;a.load=MO.FTagDocument_load;a.parse=MO.FTagDocument_parse;a.dump=MO.FTagDocument_dump;return a};
MO.FTagDocument_create=function(a){var b=this._space+"_",d=null,d=MO.RString.startsWith(a,b)?a.substring(b.length):a;a=null;switch(d){case "source":a=MO.Class.create(MO.FTag);break;case "write":a=MO.Class.create(MO.FTagWrite);break;case "true":a=MO.Class.create(MO.FTagTrue);break;case "false":a=MO.Class.create(MO.FTagFalse);break;case "equals":a=MO.Class.create(MO.FTagEquals);break;case "notEquals":a=MO.Class.create(MO.FTagNotEquals);break;default:throw new MO.TError(this,"Unknown tag type. (name={1})",
d);}return a};
MO.FTagDocument_loadNode=function(a,b){var d=this.create(b.nodeName);a?a.push(d):this._root=d;var e=b.attributes;if(e)for(var f=e.length,h=0;h<f;h++){var k=e[h];k.nodeName&&d.set(k.nodeName,MO.RXml.formatText(k.value))}if(e=b.childNodes)for(f=e.length,h=0;h<f;h++)switch(k=e[h],k.nodeType){case MO.ENodeType.Text:var q=MO.Class.create(MO.FTagText);q.setText(k.nodeValue);d.push(q);break;case MO.ENodeType.Data:q=MO.Class.create(MO.FTagText);q.setText(k.data);d.push(q);break;case MO.ENodeType.Node:this.loadNode(d,k)}};
MO.FTagDocument_load=function(a){a=("<source>"+a+"</source>").replace(new RegExp("<"+this._space+":","g"),"<"+this._space+"_");a=a.replace(new RegExp("</"+this._space+":","g"),"</"+this._space+"_");a=a.replace(RegExp(" & ","g")," &amp; ");a=a.replace(RegExp(" < ","g")," &lt; ");a=a.replace(RegExp(" > ","g")," &gt; ");a=MO.RXml.makeString(a);this.loadNode(null,a.firstChild)};MO.FTagDocument_parse=function(a){a.resetSource();this._root.parse(a);return a.source()};
MO.FTagDocument_dump=function(){var a=new MO.TString;a.appendLine(MO.Class.dump(this));a.appendLine(this.root().dump(a));return a.toString()};MO.FTagEquals=function(a){a=MO.Class.inherits(this,a,MO.FTag);a._trimLeft=!0;a._source=null;a._value=null;a.onBegin=MO.FTagEquals_onBegin;a.set=MO.FTagEquals_set;a.toString=MO.FTagEquals_toString;return a};
MO.FTagEquals_onBegin=function(a){var b=!1;a=a.get(this._source);for(var d=this._value.split("|"),e=d.length,f=0;f<e;f++)if(a==d[f]){b=!0;break}return b?MO.EResult.Continue:MO.EResult.Skip};MO.FTagEquals_set=function(a,b){switch(a){case "source":this._source=b;return;case "value":this._value=b;return}this.__base.FTag.set.call(this,a,b)};MO.FTagEquals_toString=function(){return"source="+this._source+", value="+this._value};
MO.FTagFalse=function(a){a=MO.Class.inherits(this,a,MO.FTag);a._trimLeft=!0;a._source=null;a.onBegin=MO.FTagFalse_onBegin;a.set=MO.FTagFalse_set;a.toString=MO.FTagFalse_toString;return a};MO.FTagFalse_onBegin=function(a){a=a.get(this._source);return MO.RBoolean.parse(a)?MO.EResult.Skip:MO.EResult.Continue};MO.FTagFalse_set=function(a,b){switch(a){case "source":this._source=b;return}this.__base.FTag.set.call(this,a,b)};MO.FTagFalse_toString=function(){return"source="+this._source};
MO.FTagNotEquals=function(a){a=MO.Class.inherits(this,a,MO.FTag);a._trimLeft=!0;a._source=null;a._value=null;a.onBegin=MO.FTagNotEquals_onBegin;a.set=MO.FTagNotEquals_set;a.toString=MO.FTagNotEquals_toString;return a};MO.FTagNotEquals_onBegin=function(a){var b=!0;a=a.get(this._source);for(var d=this._value.split("|"),e=d.length,f=0;f<e;f++)if(a==d[f]){b=!1;break}return b?MO.EResult.Continue:MO.EResult.Skip};
MO.FTagNotEquals_set=function(a,b){switch(a){case "source":this._source=b;return;case "value":this._value=b;return}this.__base.FTag.set.call(this,a,b)};MO.FTagNotEquals_toString=function(){return"source="+this._source+", value="+this._value};MO.FTagText=function(a){a=MO.Class.inherits(this,a,MO.FTag);a._text=MO.Class.register(a,new MO.AGetSet("_text"));a.onBegin=MO.FTagText_onBegin;a.toString=MO.FTagText_toString;return a};
MO.FTagText_onBegin=function(a){var b=this._text;a._trimLeft&&(MO.RString.startsWith(b,"\r")&&(b=b.substring(1)),MO.RString.startsWith(b,"\n")&&(b=b.substring(1)));a._trimRight&&(MO.RString.endsWith(b,"\r")&&(b=b.substring(0,b.length-1)),MO.RString.endsWith(b,"\n")&&(b=b.substring(0,b.length-1)));a.write(b);return MO.EResult.Skip};MO.FTagText_toString=function(){return"{"+this._text+"}"};
MO.FTagTrue=function(a){a=MO.Class.inherits(this,a,MO.FTag);a._trimLeft=!0;a._source=null;a.onBegin=MO.FTagTrue_onBegin;a.set=MO.FTagTrue_set;a.toString=MO.FTagTrue_toString;return a};MO.FTagTrue_onBegin=function(a){for(var b=!1,d=this._source.split("|"),e=d.length,f=0;f<e;f++){var h=a.get(d[f]);if(MO.Lang.Boolean.parse(h)){b=!0;break}}return b?MO.EResult.Continue:MO.EResult.Skip};MO.FTagTrue_set=function(a,b){switch(a){case "source":this._source=b;return}this.__base.FTag.set.call(this,a,b)};
MO.FTagTrue_toString=function(){return"source="+this._source};MO.FTagWrite=function(a){a=MO.Class.inherits(this,a,MO.FTag);a._source=null;a.onBegin=MO.FTagWrite_onBegin;a.set=MO.FTagWrite_set;a.toString=MO.FTagWrite_toString;return a};MO.FTagWrite_onBegin=function(a){var b=a.get(this._source);a.write(b);return MO.EResult.Skip};MO.FTagWrite_set=function(a,b){switch(a){case "source":this._source=b;return}this.__base.FTag.set.call(this,a,b)};MO.FTagWrite_toString=function(){return"source="+this._source};
MO.EThreadStatus=new function(){this.Sleep=0;this.Active=1;this.Finish=2;return this};MO.SProcessEvent=function(){this.data=this.code=this.index=null;return this};MO.SXmlEvent=function(){this.callback=this.outputDocument=this.inputDocument=this.parameter=this.action=this.url=this.owner=null;this.process=MO.SXmlEvent_process;this.dispose=MO.SXmlEvent_dispose;return this};
MO.SXmlEvent_process=function(a){this.outputDocument=a.document;this.outputNode=a.root;this.owner?this.callback.call(this.owner,this):this.callback(this)};MO.SXmlEvent_dispose=function(){this.callback=this.outputDocument=this.inputDocument=this.parameter=this.action=this.url=this.owner=null};MO.FContent=function(a){a=MO.Class.inherits(this,a,MO.FObject);a._name=MO.Class.register(a,new MO.AGetter("_name"));return a};
MO.FContentConsole=function(a){a=MO.Class.inherits(this,a,MO.FConsole);a._scopeCd=MO.EScope.Local;a._connections=null;a.onLoad=MO.FContentConsole_onLoad;a.construct=MO.FContentConsole_construct;a.alloc=MO.FContentConsole_alloc;a.process=MO.FContentConsole_process;a.send=MO.FContentConsole_send;return a};MO.FContentConsole_construct=function(){this.__base.FConsole.construct.call(this);this._connections=new MO.TObjects};
MO.FContentConsole_onLoad=function(){var a=this.event;a.document=this.document;a.process();this.document=this.event=null;this._statusFree=!0};MO.FContentConsole_alloc=function(){for(var a=null,b=this._connections,d=b.count-1;0<=d;d--){var e=b.get(d);if(e._statusFree){a=e;break}}a||(a=MO.Class.create(MO.FXmlConnection),b.push(a),a.onLoad=this.onLoad);a._statusFree=!1;return a};
MO.FContentConsole_process=function(a){var b=this.alloc();b.event=a;switch(a.code){case MO.EXmlEvent.Send:b.send(a.url,a.document);break;case MO.EXmlEvent.Receive:b.receive(a.url,a.document);break;case MO.EXmlEvent.SyncSend:return b.syncSend(a.url,a.document);case MO.EXmlEvent.SyncReceive:return b.syncReceive(a.url,a.document)}};MO.FContentConsole_send=function(a,b){var d=this.alloc(),e=d.syncSend(a,b);d._statusFree=!0;return e};
MO.FContentPipeline=function(a){a=MO.Class.inherits(this,a,MO.FPipeline);a._scopeCd=MO.Class.register(a,new MO.AGetter("_scopeCd"),MO.EScope.Global);return a};
MO.FDragConsole=function(a){a=MO.Class.inherits(this,a,MO.FConsole);a._scopeCd=MO.EScope.Local;a._activeDragable=null;a._dragables=null;a.onMouseDown=MO.FDragConsole_onMouseDown;a.onMouseMove=MO.FDragConsole_onMouseMove;a.onMouseUp=MO.FDragConsole_onMouseUp;a.construct=MO.FDragConsole_construct;a.register=MO.FDragConsole_register;a.unregister=MO.FDragConsole_unregister;a.clear=MO.FDragConsole_clear;return a};
MO.FDragConsole_onMouseDown=function(a){var b=a.source;b&&MO.Class.isClass(b,MO.MUiDragable)&&(MO.RWindow.setOptionSelect(!1),this._activeDragable=b,b.onDragStart(a))};MO.FDragConsole_onMouseMove=function(a){if(this._activeDragable)this._activeDragable.onDragMove(a)};MO.FDragConsole_onMouseUp=function(a){this._activeDragable&&(MO.RWindow.setOptionSelect(!0),this._activeDragable.onDragStop(a),this._activeDragable=null)};
MO.FDragConsole_construct=function(){this.__base.FConsole.construct.call(this);this._dragables=new MO.TObjects;MO.RWindow.lsnsMouseDown.register(this,this.onMouseDown);MO.RWindow.lsnsMouseMove.register(this,this.onMouseMove);MO.RWindow.lsnsMouseUp.register(this,this.onMouseUp)};MO.FDragConsole_register=function(a){this._dragables.push(a)};MO.FDragConsole_unregister=function(a,b){this._dragables.remove(p)};MO.FDragConsole_clear=function(){this._dragables.clear()};
MO.FEnvironment=function(a){a=MO.Class.inherits(this,a,MO.FObject);a._name=MO.Class.register(a,new MO.AGetSet("_name"));a._value=MO.Class.register(a,new MO.AGetSet("_value"));a.set=MO.FEnvironment_set;return a};MO.FEnvironment_set=function(a,b){this._name=a;this._value=b};
MO.FEnvironmentConsole=function(a){a=MO.Class.inherits(this,a,MO.FConsole);a._scopeCd=MO.EScope.Local;a._environments=MO.Class.register(a,new MO.AGetSet("_environments"));a.construct=MO.FEnvironmentConsole_construct;a.register=MO.FEnvironmentConsole_register;a.registerValue=MO.FEnvironmentConsole_registerValue;a.find=MO.FEnvironmentConsole_find;a.findValue=MO.FEnvironmentConsole_findValue;a.parse=MO.FEnvironmentConsole_parse;a.dispose=MO.FEnvironmentConsole_dispose;return a};
MO.FEnvironmentConsole_construct=function(){this.__base.FConsole.construct.call(this);this._environments=new MO.TDictionary};MO.FEnvironmentConsole_register=function(a){var b=a.name();this._environments.set(b,a)};MO.FEnvironmentConsole_registerValue=function(a,b){var d=MO.RClass.create(MO.FEnvironment);d.set(a,b);this._environments.set(a,d);return d};MO.FEnvironmentConsole_find=function(a){return this._environments.get(a)};
MO.FEnvironmentConsole_findValue=function(a){var b=null;(a=this._environments.get(a))&&(b=a.value());return b};MO.FEnvironmentConsole_parse=function(a){for(var b=this._environments,d=b.count(),e=0;e<d;e++){var f=b.at(e);a=MO.Lang.String.replace(a,"{"+f.name()+"}",f.value())}return a};MO.FEnvironmentConsole_dispose=function(){this._environments=new TDictionary;this.__base.FConsole.dispose.call(this)};
MO.FEvent=function(a){a=MO.Class.inherits(this,a,MO.FObject);a._owner=MO.Class.register(a,new MO.AGetSet("_owner"));a._callback=MO.Class.register(a,new MO.AGetSet("_callback"));a._valid=MO.Class.register(a,new MO.AGetSet("_valid"),!0);a.process=MO.FEvent_process;return a};MO.FEvent_process=function(){if(this._valid){var a=this._owner;a?this._callback.call(a,this):this._callback(this)}};
MO.FEventConsole=function(a){a=MO.Class.inherits(this,a,MO.FConsole);a._scopeCd=MO.EScope.Local;a._thread=null;a._interval=100;a._processEvents=null;a._events=null;a.onProcess=MO.FEventConsole_onProcess;a.construct=MO.FEventConsole_construct;a.register=MO.FEventConsole_register;a.push=MO.FEventConsole_push;a.clear=MO.FEventConsole_clear;return a};
MO.FEventConsole_onProcess=function(){var a=this._events;if(!a.isEmpty()){var b=this._processEvents;b.assign(a);a.clear();a=b.count();if(0<a){for(var d=0;d<a;d++)b.get(d).process();b.clear()}}};MO.FEventConsole_construct=function(){this.__base.FConsole.construct.call(this);this._processEvents=new MO.TObjects;this._events=new MO.TObjects;var a=this._thread=MO.Class.create(MO.FThread);a.setInterval(this._interval);a.lsnsProcess.register(this,this.onProcess);MO.Console.find(MO.FThreadConsole).start(a)};
MO.FEventConsole_register=function(a,b){var d=MO.Class.create(FEvent);d.owner=a;d.callback=b;this._events.push(d)};MO.FEventConsole_push=function(a){var b=this._events;b.contains(a)||b.push(a)};MO.FEventConsole_clear=function(){this._events.clear()};
MO.FHttpConsole=function(a){a=MO.Class.inherits(this,a,MO.FConsole);a._scopeCd=MO.EScope.Local;a._pool=null;a.onComplete=MO.FHttpConsole_onComplete;a.construct=MO.FHttpConsole_construct;a.create=MO.FHttpConsole_create;a.alloc=MO.FHttpConsole_alloc;a.free=MO.FHttpConsole_free;a.send=MO.FHttpConsole_sendAsync;a.sendSync=MO.FHttpConsole_sendSync;a.sendAsync=MO.FHttpConsole_sendAsync;a.fetch=MO.FHttpConsole_fetchAsync;a.fetchSync=MO.FHttpConsole_fetchSync;a.fetchAsync=MO.FHttpConsole_fetchAsync;a.dispose=
MO.FHttpConsole_dispose;return a};MO.FHttpConsole_onComplete=function(a){this._pool.free(a.connection)};MO.FHttpConsole_construct=function(){this.__base.FConsole.construct.call(this);this._pool=MO.Class.create(MO.FObjectPool)};MO.FHttpConsole_create=function(){return MO.Class.create(MO.FHttpConnection)};MO.FHttpConsole_alloc=function(a){a=this._pool;a.hasFree()||this._pool.push(this.create());a=a.alloc();a.reset();a.addCompleteListener(this,this.onComplete);return a};MO.FHttpConsole_free=function(a){this._pool.free(a)};
MO.FHttpConsole_sendSync=function(a,b){var d=this.alloc();d._asynchronous=!1;d.send(a,b);return d.content()};MO.FHttpConsole_sendAsync=function(a,b){var d=this.alloc();d._asynchronous=!0;d.send(a,b);return d};MO.FHttpConsole_fetchSync=function(a,b){var d=this.alloc();d._asynchronous=!1;d._contentCd=MO.EHttpContent.Text;d.send(a,b);return d.content()};MO.FHttpConsole_fetchAsync=function(a,b){var d=this.alloc();d._asynchronous=!0;d._contentCd=MO.EHttpContent.Text;d.send(a,b);return d};
MO.FHttpConsole_dispose=function(){this.__base.FConsole.dispose.call(this)};MO.FIdleConsole=function(a){a=MO.Class.inherits(this,a,FConsole);a.scope=MO.EScope.Page;a.register=MO.FIdleConsole_register;return a};MO.FIdleConsole_register=function(a,b){this.active=new TActive(a,b);this.active.interval=100;RConsole.find(FActiveConsole).push(this.active)};MO.FIdleConsole_construct=function(){};MO.FJsonConsole=function(a){a=MO.Class.inherits(this,a,MO.FHttpConsole);a.create=MO.FJsonConsole_create;return a};
MO.FJsonConsole_create=function(){return MO.Class.create(MO.FJsonConnection)};MO.FLoggerConsole=function(a){a=MO.Class.inherits(this,a,MO.FConsole);a._scopeCd=MO.EScope.Global;a._socket=null;a.onOutput=MO.FLoggerConsole_onOutput;a.construct=MO.FLoggerConsole_construct;a.connect=MO.FLoggerConsole_connect;a.output=MO.FLoggerConsole_output;a.disconnect=MO.FLoggerConsole_disconnect;a.dispose=MO.FLoggerConsole_dispose;return a};MO.FLoggerConsole_onOutput=function(a){this.output(a.message)};
MO.FLoggerConsole_construct=function(){this.__base.FConsole.construct.call(this);MO.Logger.lsnsOutput.register(this,this.onOutput)};MO.FLoggerConsole_connect=function(a){(this._socket=MO.Class.create(MO.FBufferedSocket)).connect(a)};MO.FLoggerConsole_output=function(a){var b=this._socket;b&&(b.push("["+window.location.toString()+"] - "+a),b.process())};MO.FLoggerConsole_disconnect=function(){var a=this._socket;a&&a.close()};
MO.FLoggerConsole_dispose=function(){this._socket=MO.Lang.Object.dispose(this._socket);this.__base.FConsole.dispose.call(this)};
MO.FMonitorConsole=function(a){a=MO.Class.inherits(this,a,MO.FConsole);a.scope=MO.EScope.Global;a.working=!1;a.interval=10;a.intervalId=null;a.monitors=new MO.TList;a.hWindow=null;a.doInterval=MO.FMonitorConsole_doInterval;a.push=MO.FMonitorConsole_push;a.process=MO.FMonitorConsole_process;a.processAll=MO.FMonitorConsole_processAll;a.startup=MO.FMonitorConsole_startup;a.wait=MO.FMonitorConsole_wait;a.release=MO.FMonitorConsole_release;return a};
MO.FMonitorConsole_push=function(a){this.startup();a.id=this.monitors.sync(a);a.name="T:"+MO.Lang.String.lpad(a.id,4,"0");a.status=EMonitor.Active};MO.FMonitorConsole_process=function(a){if(a)switch(a.status){case MO.EMonitor.Active:a.process(this.interval);break;case MO.EMonitor.Cancel:this.monitors.removeItem(a)}};MO.FMonitorConsole_processAll=function(){this.working=!0;for(var a=this.monitors,b=0;b<a.count;b++)this.process(a.get(b));this.working=!1};
MO.FMonitorConsole_doInterval=function(){var a=MO.RGlobal.get(FMonitorConsole);a&&!a.working&&a.processAll()};MO.FMonitorConsole_startup=function(){if(!this.hWindow){this.hWindow=window;debugger;this.intervalId=this.hWindow.setInterval(this.doInterval,this.interval)}};MO.FMonitorConsole_wait=function(a){};MO.FMonitorConsole_release=function(){this.hWindow&&this.intervalId&&this.hWindow.clearInterval(this.intervalId)};
MO.FMouseConsole=function(a){a=MO.Class.inherits(this,a,MO.FConsole);a._scopeCd=MO.EScope.Local;a._activeCapture=null;a.onMouseDown=MO.FMouseConsole_onMouseDown;a.onMouseMove=MO.FMouseConsole_onMouseMove;a.onMouseUp=MO.FMouseConsole_onMouseUp;a.construct=MO.FMouseConsole_construct;a.captureStart=MO.FMouseConsole_captureStart;a.capture=MO.FMouseConsole_capture;a.captureStop=MO.FMouseConsole_captureStop;a.register=MO.FMouseConsole_register;a.unregister=MO.FMouseConsole_unregister;a.clear=MO.FMouseConsole_clear;
return a};MO.FMouseConsole_onMouseDown=function(a){var b=MO.RHtml.searchLinker(a.hSource,MO.MMouseCapture);b&&b.testMouseCapture()&&(this._activeCapture=b,this.captureStart(a))};MO.FMouseConsole_onMouseMove=function(a){this._activeCapture&&this.capture(a)};MO.FMouseConsole_onMouseUp=function(a){this._activeCapture&&this.captureStop(a)};
MO.FMouseConsole_construct=function(){this.__base.FConsole.construct.call(this);MO.RWindow.lsnsMouseDown.register(this,this.onMouseDown);MO.RWindow.lsnsMouseMove.register(this,this.onMouseMove);MO.RWindow.lsnsMouseUp.register(this,this.onMouseUp)};MO.FMouseConsole_captureStart=function(a){var b=this._activeCapture;b&&(MO.RWindow.setOptionSelect(!1),b.onMouseCaptureStart(a))};MO.FMouseConsole_capture=function(a){var b=this._activeCapture;if(b)if(b.testMouseCapture())b.onMouseCapture(a);else this.captureStop(a)};
MO.FMouseConsole_captureStop=function(a){var b=this._activeCapture;b&&(b.onMouseCaptureStop(a),this._activeCapture=null);MO.RWindow.setOptionSelect(!0)};MO.FMouseConsole_register=function(a){};MO.FMouseConsole_unregister=function(a){};MO.FMouseConsole_clear=function(){};MO.FPipeline=function(a){a=MO.Class.inherits(this,a,MO.FObject);a._code=MO.Class.register(a,new MO.AGetter("_code"));return a};
MO.FProcess=function(a){a=MO.Class.inherits(this,a,MO.FObject);a._name=MO.Class.register(a,new MO.AGetter("_name"));a._source=null;a._worker=null;a._events=null;a.ohMessage=MO.FProcess_ohMessage;a.onMessage=MO.FProcess_onMessage;a.construct=MO.FProcess_construct;a.name=MO.FProcess_name;a.start=MO.FProcess_start;a.process=MO.FProcess_process;return a};MO.FProcess_ohMessage=function(){this.__linker.onMessage(this)};MO.FProcess_onMessage=function(a){};
MO.FProcess_construct=function(){this.__base.FObject.construct.call(this);this._events=new MO.TObjects};MO.FProcess_start=function(a){if(this._worker)throw new MO.TError(this,"Process is already start.");this._source=a;a=this._worker=new Worker(a);a.__linker=this;a.onmessage=this.ohMessage};MO.FProcess_process=function(a){var b=this._events,d=b.count();b.push(a);b=new MO.SProcessEvent;b.index=d;b.code=a.code();b.data=a.data();this._worker.postMessage(b)};
MO.FProcessConsole=function(a){a=MO.Class.inherits(this,a,FConsole);a._scopeCd=MO.EScope.Local;a._connections=null;a.onLoad=MO.FProcessConsole_onLoad;a.construct=MO.FProcessConsole_construct;a.alloc=MO.FProcessConsole_alloc;a.process=MO.FProcessConsole_process;a.send=MO.FProcessConsole_send;return a};MO.FProcessConsole_construct=function(){this._connections=new MO.TObjects};
MO.FProcessConsole_onLoad=function(){var a=this.event;a.document=this.document;a.process();this.document=this.event=null;this._statusFree=!0};MO.FProcessConsole_alloc=function(){for(var a=null,b=this._connections,d=b.count-1;0<=d;d--){var e=b.get(d);if(e._statusFree){a=e;break}}a||(a=MO.Class.create(MO.FXmlConnection),b.push(a),a.onLoad=this.onLoad);a._statusFree=!1;return a};
MO.FProcessConsole_process=function(a){var b=this.alloc();b.event=a;switch(a.code){case MO.EXmlEvent.Send:b.send(a.url,a.document);break;case MO.EXmlEvent.Receive:b.receive(a.url,a.document);break;case MO.EXmlEvent.SyncSend:return b.syncSend(a.url,a.document);case MO.EXmlEvent.SyncReceive:return b.syncReceive(a.url,a.document)}};MO.FProcessConsole_send=function(a,b){var d=this.alloc(),e=d.syncSend(a,b);d._statusFree=!0;return e};
MO.FProcessEvent=function(a){a=MO.Class.inherits(this,a,MO.FObject);a._code=MO.Class.register(a,new MO.AGetSet("_code"));a._data=MO.Class.register(a,new MO.AGetSet("_data"));a._listeners=null;a.register=MO.FProcessEvent_register;return a};MO.FProcessEvent_register=function(a,b){this._listeners||(this._listeners=new MO.TListeners);this._listeners.register(a,b)};
MO.FProcessor=function(a){a=MO.Class.inherits(this,a,MO.FObject);a._name=MO.Class.register(a,new MO.AGetter("_name"));a._source=null;a._worker=null;a._events=null;a.ohMessage=MO.FProcessor_ohMessage;a.onMessage=MO.FProcessor_onMessage;a.construct=MO.FProcessor_construct;a.start=MO.FProcessor_start;a.process=MO.FProcessor_process;return a};MO.FProcessor_ohMessage=function(){this.__linker.onMessage(this)};MO.FProcessor_onMessage=function(a){};
MO.FProcessor_construct=function(){this.__base.FObject.construct.call(this);this._events=new MO.TObjects};MO.FProcessor_start=function(a){if(this._worker)throw new MO.TError(this,"Process is already start.");this._source=a;a=this._worker=new Worker(a);a.__linker=this;a.onmessage=this.ohMessage};MO.FProcessor_process=function(a){var b=this._events,d=b.count();b.push(a);b=new MO.SProcessEvent;b.index=d;b.code=a.code();b.data=a.data();this._worker.postMessage(b)};
MO.FProcessServer=function(a){a=MO.Class.inherits(this,a,MO.FObject);a._name=MO.Class.register(a,new MO.AGetSet("_name"));a._handle=null;a._processors=null;a.ohInterval=MO.FProcessServer_ohInterval;a.onInterval=MO.FProcessServer_onInterval;a.ohMessage=MO.FProcessServer_ohMessage;a.onMessage=MO.FProcessServer_onMessage;a.construct=MO.FProcessServer_construct;a.registerProcessor=MO.FProcessServer_registerProcessor;a.unregisterProcessor=MO.FProcessServer_unregisterProcessor;a.send=MO.FProcessServer_send;
a.process=MO.FProcessServer_process;return a};MO.FProcessServer_ohInterval=function(){MO.FProcessServer.__linker.onInterval()};MO.FProcessServer_onInterval=function(){};MO.FProcessServer_ohMessage=function(a){MO.FProcessServer.__linker.onMessage(a.data)};MO.FProcessServer_onMessage=function(a){console.log("messgae",this,a)};MO.FProcessServer_construct=function(){this.__base.FObject.construct.call(this);this._processors=new MO.TDictionary};
MO.FProcessServer_registerProcessor=function(a,b){this._processors.set(a,b)};MO.FProcessServer_unregisterProcessor=function(a){this._processors.set(a,null)};MO.FProcessServer_send=function(a){postMessage(a)};MO.FProcessServer_process=function(){onmessage=this.ohMessage;FProcessServer.__linker=this};
MO.FServiceConsole=function(a){a=MO.Class.inherits(this,a,MO.FConsole);a._scopeCd=MO.EScope.Global;a.construct=MO.FServiceConsole_construct;a.send=MO.FServiceConsole_send;a.dispose=MO.FServiceConsole_dispose;return a};MO.FServiceConsole_onLoad=function(a){this._pool.free(a)};MO.FServiceConsole_construct=function(){this.__base.FConsole.construct.call(this)};
MO.FServiceConsole_send=function(a,b,d){a=MO.Window.Browser.hostPath("/"+a+".ws?action="+b);return MO.Console.find(MO.FXmlConsole).sendAsync(a,d)};MO.FServiceConsole_dispose=function(){this.__base.FConsole.dispose.call(this)};MO.FStatistics=function(a){a=MO.Class.inherits(this,a,MO.FObject);a._code=null;a.reset=MO.FStatistics_reset;a.resetFrame=MO.FStatistics_resetFrame;return a};MO.FStatistics_reset=function(){};MO.FStatistics_resetFrame=function(){};
MO.FStatisticsConsole=function(a){a=MO.Class.inherits(this,a,MO.FConsole);a._scopeCd=MO.EScope.Local;a._statisticses=MO.Class.register(a,new MO.AGetter("_statisticses"));a.construct=MO.FStatisticsConsole_construct;a.register=MO.FStatisticsConsole_register;a.unregister=MO.FStatisticsConsole_unregister;a.find=MO.FStatisticsConsole_find;a.reset=MO.FStatisticsConsole_reset;a.resetFrame=MO.FStatisticsConsole_resetFrame;return a};MO.FStatisticsConsole_construct=function(){this._statisticses=new MO.TDictionary};
MO.FStatisticsConsole_register=function(a,b){this._statisticses.set(a,b)};MO.FStatisticsConsole_unregister=function(a){return this._statisticses.remove(a)};MO.FStatisticsConsole_find=function(a){return this._statisticses.get(a)};MO.FStatisticsConsole_reset=function(a){a=this._statisticses;for(var b=a.count()-1;0<=b;b--)a.at(b).reset()};MO.FStatisticsConsole_resetFrame=function(a,b){for(var d=this._statisticses,e=d.count()-1;0<=e;e--)d.at(e).resetFrame()};
MO.FThread=function(a){a=MO.Class.inherits(this,a,MO.FObject,MO.MListenerProcess);a._name=MO.Class.register(a,new MO.AGetter("_name"));a._statusCd=MO.Class.register(a,new MO.AGetter("_statusCd"),MO.EThreadStatus.Sleep);a._interval=MO.Class.register(a,new MO.AGetSet("_interval"),100);a._delay=0;a.construct=MO.FThread_construct;a.start=MO.FThread_start;a.stop=MO.FThread_stop;a.process=MO.FThread_process;return a};MO.FThread_construct=function(){this.__base.FObject.construct.call(this)};
MO.FThread_start=function(){this._statusCd=MO.EThreadStatus.Active};MO.FThread_stop=function(){this._statusCd=MO.EThreadStatus.Finish};MO.FThread_process=function(a){0>=this._delay?(this.processProcessListener(this),this._delay=this._interval):this._delay-=a};
MO.FThreadConsole=function(a){a=MO.Class.inherits(this,a,MO.FConsole);a._scopeCd=MO.EScope.Global;a._active=!0;a._requestFlag=!1;a._interval=8;a._threads=MO.Class.register(a,new MO.AGetter("_threads"));a._hIntervalId=null;a.ohInterval=MO.FThreadConsole_ohInterval;a.construct=MO.FThreadConsole_construct;a.push=MO.FThreadConsole_push;a.start=MO.FThreadConsole_start;a.process=MO.FThreadConsole_process;a.processAll=MO.FThreadConsole_processAll;a.dispose=MO.FThreadConsole_dispose;return a};
MO.FThreadConsole_ohInterval=function(){MO.Console.find(MO.FThreadConsole).processAll()};MO.FThreadConsole_push=function(a){this._threads.push(a)};MO.FThreadConsole_start=function(a){a.start();this._threads.push(a)};MO.FThreadConsole_construct=function(){this.__base.FConsole.construct.call(this);this._threads=new MO.TObjects;this._hIntervalId=MO.Window.htmlWindow().setInterval(this.ohInterval,this._interval)};
MO.FThreadConsole_process=function(a){if(a)switch(a.statusCd()){case MO.EThreadStatus.Active:a.process(this._interval);break;case MO.EThreadStatus.Finish:this._threads.remove(a),a.dispose()}};MO.FThreadConsole_processAll=function(){if(this._active){var a=this._threads,b=a.count();try{for(var d=0;d<b;d++){var e=a.at(d);this.process(e)}}catch(f){MO.Logger.fatal(this,f,"Thread process failure. (thread_count={1})",b)}}this._requestFlag&&MO.Window.requestAnimationFrame(this.ohInterval)};
MO.FThreadConsole_dispose=function(){if(this._requestFlag)MO.Window.cancelRequestAnimationFrame(this.ohInterval);else{var a=this._hIntervalId;a&&(MO.Window.htmlWindow().clearInterval(a),this._hIntervalId=null)}this._threads=MO.Lang.Object.dispose(this._threads);this.__base.FConsole.dispose.call(this)};MO.FTimeConsole=function(a){a=MO.Class.inherits(this,a,MO.FConsole);a._scopeCd=MO.EScope.Global;a._date=null;a.construct=MO.FTimeConsole_construct;a.dispose=MO.FTimeConsole_dispose;return a};
MO.FTimeConsole_construct=function(){this.__base.FConsole.construct.call(this)};MO.FTimeConsole_dispose=function(){this.__base.FConsole.dispose.call(this)};MO.FXmlConsole=function(a){a=MO.Class.inherits(this,a,MO.FHttpConsole);a.create=MO.FXmlConsole_create;return a};MO.FXmlConsole_create=function(){return MO.Class.create(MO.FXmlConnection)};MO.EBrowser=new function(){this.Unknown="unknown";this.Explorer="explorer";this.FireFox="firefox";this.Chrome="chrome";this.Safari="safari";return this};
MO.EDevice=new function(){this.Unknown="unknown";this.Pc="pc";this.Mobile="mobile";return this};MO.ESoftware=new function(){this.Unknown="unknown";this.Window="window";this.Linux="linux";this.Android="android";this.Apple="apple";return this};
MO.RWindow=function(){this._optionSelect=!0;this._statusError=!1;this._statusEnable=!0;this._disableDeep=0;this._cookies=new MO.TAttributes;this._sessionStorage=this._localStorage=null;this._eventMouse=new MO.SMouseEvent;this._eventKey=new MO.SKeyboardEvent;this._eventResize=new MO.SResizeEvent;this._eventVisibility=new MO.SEvent;this._eventOrientation=new MO.SEvent;this._eventUnload=new MO.SEvent;this._hDisableImage=this._hDisablePanel=this._hContainer=this._hDocument=this._hWindow=null;this.lsnsLoad=
new MO.TListeners;this.lsnsLoaded=new MO.TListeners;this.lsnsUnload=new MO.TListeners;this.lsnsMouseDown=new MO.TListeners;this.lsnsMouseUp=new MO.TListeners;this.lsnsMouseOver=new MO.TListeners;this.lsnsMouseMove=new MO.TListeners;this.lsnsMouseWheel=new MO.TListeners;this.lsnsKeyDown=new MO.TListeners;this.lsnsKeyUp=new MO.TListeners;this.lsnsKeyPress=new MO.TListeners;this.lsnsResize=new MO.TListeners;this.lsnsVisibility=new MO.TListeners;this.lsnsOrientation=new MO.TListeners;this.lsnsDeviceError=
new MO.TListeners;return this};MO.RWindow.prototype.ohMouseDown=function(a){var b=MO.Window;a||(a=b._hWindow.event);var d=b._eventMouse;d.code=MO.EEvent.MouseDown;d.attachEvent(a);b.lsnsMouseDown.process(d)};MO.RWindow.prototype.ohMouseMove=function(a){var b=MO.Window;a||(a=b._hWindow.event);var d=b._eventMouse;d.code=MO.EEvent.MouseMove;d.attachEvent(a);b.lsnsMouseMove.process(d)};
MO.RWindow.prototype.ohMouseUp=function(a){var b=MO.Window;a||(a=b._hWindow.event);var d=b._eventMouse;d.code=MO.EEvent.MouseUp;d.attachEvent(a);b.lsnsMouseUp.process(d)};MO.RWindow.prototype.ohMouseWheel=function(a){var b=MO.Window;a||(a=b._hWindow.event);var d=b._eventMouse;d.code=MO.EEvent.MouseWheel;d.attachEvent(a);b.lsnsMouseWheel.process(d)};MO.RWindow.prototype.ohKeyDown=function(a){var b=MO.Window;a||(a=b._hWindow.event);var d=b._eventKey;d.code=MO.EEvent.KeyDown;d.attachEvent(a);b.lsnsKeyDown.process(d)};
MO.RWindow.prototype.ohKeyUp=function(a){var b=MO.Window;a||(a=b._hWindow.event);var d=b._eventKey;d.code=MO.EEvent.KeyUp;d.attachEvent(a);b.lsnsKeyUp.process(d)};MO.RWindow.prototype.ohKeyPress=function(a){var b=MO.Window;a||(a=b._hWindow.event);var d=b._eventKey;d.code=MO.EEvent.KeyPress;d.attachEvent(a);b.lsnsKeyPress.process(d)};MO.RWindow.prototype.ohResize=function(a){var b=MO.Window;a||(a=b._hWindow.event);var d=b._eventResize;d.code=MO.EEvent.Resize;d.attachEvent(a);b.lsnsResize.process(d)};
MO.RWindow.prototype.ohSelect=function(a){return MO.Window._optionSelect};MO.RWindow.prototype.ohVisibility=function(a){a=MO.Window;var b=MO.Window.Browser.isVisibility(),d=a._eventVisibility;d.visibility=b;a.lsnsVisibility.process(d)};MO.RWindow.prototype.ohOrientation=function(a){a=MO.Window;var b=a.Browser.refreshOrientation(),d=a._eventOrientation;d.orientationCd=b;a.lsnsOrientation.process(d)};
MO.RWindow.prototype.ohUnload=function(a){var b=MO.Window;a=b._eventUnload;b.lsnsUnload.process(a);b.dispose()};
MO.RWindow.prototype.connect=function(a){this._eventVisibility.code=MO.EEvent.Visibility;this._eventOrientation.code=MO.EEvent.Orientation;a=this._hWindow=a;var b=this._hDocument=a.document,d=this._hContainer=b.body,e=MO.Window.Browser.defineEventGet("visibilitychange");MO.Window.Browser.supportHtml5()?(d.addEventListener("mousedown",this.ohMouseDown,!0),d.addEventListener("mousemove",this.ohMouseMove,!0),d.addEventListener("mouseup",this.ohMouseUp,!0),d.addEventListener("mousewheel",this.ohMouseWheel,
!0),d.addEventListener("keydown",this.ohKeyDown,!0),d.addEventListener("keyup",this.ohKeyUp,!0),d.addEventListener("keypress",this.ohKeyPress,!0),b.addEventListener(e,this.ohVisibility,!0)):(d.onmousedown=this.ohMouseDown,d.onmousemove=this.ohMouseMove,d.onmouseup=this.ohMouseUp,d.onmousewheel=this.ohMouseWheel,d.onkeydown=this.ohKeyDown,d.onkeyup=this.ohKeyUp,d.onkeypress=this.ohKeyPress,b["on"+e]=this.ohVisibility);a.onorientationchange=this.ohOrientation;d.onresize=this.ohResize;d.onselectstart=
this.ohSelect;d.onunload=this.ohUnload;this._cookies.split(b.cookie,"=",";");this._requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame;this._cancelAnimationFrame=window.cancelRequestAnimationFrame||window.webkitCancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.mozCancelAnimationFrame||window.mozCancelRequestAnimationFrame||window.msCancelAnimationFrame||
window.msCancelRequestAnimationFrame};MO.RWindow.prototype.htmlWindow=function(){return this._hWindow};MO.RWindow.prototype.optionSelect=function(){return this._optionSelect};MO.RWindow.prototype.setOptionSelect=function(a){this._optionSelect=a;MO.Window.Browser.isBrowser(MO.EBrowser.FireFox)&&(this._hContainer.style.MozUserSelect=a?"":"none")};MO.RWindow.prototype.statusError=function(){return this._statusError};MO.RWindow.prototype.setStatusError=function(a){this._statusError=a};
MO.RWindow.prototype.processDeviceError=function(a){this._statusError=!0;this.lsnsDeviceError.process(a)};MO.RWindow.prototype.setCaption=function(a){top.document.title=MO.Lang.String.nvl(a)};MO.RWindow.prototype.setStatus=function(a){window.status=MO.Lang.String.nvl(a)};MO.RWindow.prototype.cookies=function(){return this._cookies};MO.RWindow.prototype.cookie=function(a){return this._cookies.get(a)};
MO.RWindow.prototype.storage=function(a){switch(a){case MO.EScope.Local:return a=this._localStorage,a||(a=this._localStorage=MO.Class.create(MO.FWindowStorage),a.link(window.localStorage)),a;case MO.EScope.Session:return a=this._sessionStorage,a||(a=this._sessionStorage=MO.Class.create(MO.FWindowStorage),a.link(window.sessionStorage)),a}throw new TError(this,"Unknown scope. (scope_cd={1})",a);};
MO.RWindow.prototype.makeDisablePanel=function(a){var b=this._hDisablePanel;b||(b=this._hDisablePanel=MO.Window.Builder.createDiv(this._hDocument,"RWindow_Disable"),b.style.zIndex=5E3);var d=this._hDisableImage;d||(d=this._hDisableImage=MO.Window.Builder.appendIcon(b),d.src=MO.RResource.iconPath("control.RWindow_Loading"),d.style.margin=this._hContainer.offsetHeight/2,d.style.display="none");MO.Window.Html.visibleSet(d,a);return b};
MO.RWindow.prototype.windowDisable=function(){this._hContainer.disabled=!0};MO.RWindow.prototype.windowEnable=function(){this._hContainer.disabled=!1};MO.RWindow.prototype.isEnable=function(){return this._statusEnable};MO.RWindow.prototype.enable=function(){this._disableDeep--;0==this._disableDeep&&this.setEnable(!0)};MO.RWindow.prototype.disable=function(){0==this._disableDeep&&this.setEnable(!1);this._disableDeep++};
MO.RWindow.prototype.setEnable=function(a,b){var d=this.makeDisablePanel(b);if(a)this.windowEnable(),d._linked&&(this._hContainer.removeChild(d),d._linked=!1);else{var e=this._hDocument,f=this._hDisablePanel.style;f.left="0px";f.top="0px";f.width=(e.all?this._hContainer.scrollWidth:e.documentElement.scrollWidth)+"px";f.height=(e.all?this._hContainer.scrollHeight:e.documentElement.scrollHeight)+"px";d._linked||(this._hContainer.appendChild(d),d._linked=!0)}this._statusEnable=a};
MO.RWindow.prototype.appendElement=function(a){this._hContainer.appendChild(a)};MO.RWindow.prototype.requestAnimationFrame=function(a){var b=this._requestAnimationFrame;return b?(b(a),!0):!1};MO.RWindow.prototype.cancelRequestAnimationFrame=function(a){var b=this._cancelAnimationFrame;return b?(b(a),!0):!1};MO.RWindow.prototype.redirect=function(){};MO.RWindow.prototype.historyForward=function(){};MO.RWindow.prototype.historyBack=function(){};
MO.RWindow.prototype.dispose=function(){var a=this._hWindow,b=this._hContainer;MO.Window.Browser.supportHtml5()?(b.removeEventListener("mousedown",this.onMouseDown,!0),b.removeEventListener("mousemove",this.onMouseMove,!0),b.removeEventListener("mouseup",this.onMouseUp,!0),b.removeEventListener("mousewheel",this.onMouseWheel,!0),b.removeEventListener("keydown",this.onKeyDown,!0),b.removeEventListener("keyup",this.onKeyUp,!0),b.removeEventListener("keypress",this.onKeyPress,!0),a.removeEventListener("orientationchange",
this.onOrientation)):(b.onmousedown=null,b.onmousemove=null,b.onmouseup=null,b.onmousewheel=null,b.onkeydown=null,b.onkeyup=null,b.onkeypress=null,a.onorientationchange=null);b.onresize=null;b.onselectstart=null;b.onunload=null;this._localStorage=MO.Lang.Object.dispose(this._localStorage);this._sessionStorage=MO.Lang.Object.dispose(this._sessionStorage);this._hContainer=this._hDocument=this._hWindow=null;this._eventMouse=MO.Lang.Object.dispose(this._eventMouse);this._eventKey=MO.Lang.Object.dispose(this._eventKey);
this._eventResize=MO.Lang.Object.dispose(this._eventResize);this._eventOrientation=MO.Lang.Object.dispose(this._eventOrientation);this._eventUnload=MO.Lang.Object.dispose(this._eventUnload)};MO.RWindow=new MO.RWindow;MO.Window=MO.RWindow;MO.SBrowserCapability=function(){this.optionStorage=this.optionProcess=!1;this.canvasScale=!0;this.soundConfirm=!1;this.soundFinish=!0;this.blobCreate=!1;this.pixelRatio=1;return this};
MO.FWindowStorage=function(a){a=MO.Class.inherits(this,a,MO.FObject);a._scopeCd=MO.Class.register(a,new MO.AGetter("_scopeCd"));a._storage=null;a.link=MO.FWindowStorage_link;a.get=MO.FWindowStorage_get;a.set=MO.FWindowStorage_set;a.remove=MO.FWindowStorage_remove;a.clear=MO.FWindowStorage_clear;a.dispose=MO.FWindowStorage_dispose;a.innerDump=MO.FWindowStorage_innerDump;return a};MO.FWindowStorage_link=function(a){this._storage=a};MO.FWindowStorage_get=function(a){return this._storage.getItem(a)};
MO.FWindowStorage_set=function(a,b){this._storage.setItem(a,b)};MO.FWindowStorage_remove=function(a){this._storage.removeItem(a)};MO.FWindowStorage_clear=function(){this._storage.clear()};MO.FWindowStorage_dispose=function(){this._storage=null;this.__base.FObject.dispose.call(this)};MO.FWindowStorage_innerDump=function(a,b){for(var d=this._storage,e=d.length,f=0;f<e;f++){var h=d.key(f),k=d.getItem(h);0<f&&a.append(";");a.append(h+"="+k)}};
MO.RBrowser=function(){this._defineMethods=this._defineEvents=this._defineProperties=this._capability=this._agent=null;this._deviceCd=MO.EDevice.Unknown;this._softwareCd=MO.ESoftware.Unknown;this._typeCd=MO.EBrowser.Unknown;this._orientationCd=MO.EOrientation.Horizontal;this._supportHtml5=!1;this._contentPath=this._hostPath="";return this};MO.RBrowser.prototype.onLog=function(a){console.log(a.message)};
MO.RBrowser.prototype.construct=function(){var a=(this._agent=window.navigator.userAgent.toString()).toLowerCase(),b=this._defineProperties={},d=this._defineEvents={};this._defineMethods={};var e=this._capability=new MO.SBrowserCapability;-1!=a.indexOf("android")&&(this._typeCd=MO.EDevice.Mobile,this._softwareCd=MO.ESoftware.Android);if(-1!=a.indexOf("chrome"))this._typeCd=MO.EBrowser.Chrome;else if(-1!=a.indexOf("firefox"))this._typeCd=MO.EBrowser.FireFox;else if(-1!=a.indexOf("msie")||-1!=a.indexOf("windows"))this._typeCd=
MO.EBrowser.Explorer;else if(-1!=a.indexOf("safari")||-1!=a.indexOf("applewebkit"))this._typeCd=MO.EBrowser.Safari;else{alert("Unknown browser.\n"+a);return}var f=MO.EPlatform.Mobile,h=MO.Console.find(MO.FEnvironmentConsole);MO.Lang.String.contains(a,"android","ipad","iphone","midp","rv:1.2.3.4","windows ce","windows mobile")?(f=MO.EPlatform.Mobile,h.registerValue(MO.EConstant.DeviceType,"mb")):(f=MO.EPlatform.Pc,h.registerValue(MO.EConstant.DeviceType,"pc"));MO.Runtime.setPlatformCd(f);MO.Lang.String.contains(a,
"android 5.1","iphone","ipad")&&(e.soundConfirm=!0);MO.Lang.String.contains(a,"mqqbrowser")&&(e.canvasScale=!1);this._typeCd==MO.EBrowser.Chrome&&MO.Logger.lsnsOutput.register(this,this.onLog);window.applicationCache&&(this._supportHtml5=!0);(f=window.external)&&f.twGetRunPath&&(-1!=a.indexOf("360chrome")||-1!=a.indexOf("360se")?e.soundFinish=!1:-1!=f.twGetRunPath().toLowerCase().indexOf("360se")&&(e.soundFinish=!1));(a=window.devicePixelRatio)&&MO.Runtime.isPlatformMobile()&&(e.pixelRatio=Math.min(a,
3));window.Worker&&(e.optionProcess=!0);window.localStorage&&(e.optionStorage=!0);try{new Blob(["Test"],{type:"text/plain"}),e.blobCreate=!0}catch(k){MO.Logger.warn(this,"Browser blob not support.")}e=window.document;"undefined"!==typeof e.hidden?(b.hidden="hidden",d.visibilitychange="visibilitychange"):"undefined"!==typeof e.mozHidden?(b.hidden="mozHidden",d.visibilitychange="mozvisibilitychange"):"undefined"!==typeof e.msHidden?(b.hidden="msHidden",d.visibilitychange="msvisibilitychange"):"undefined"!==
typeof e.webkitHidden&&(b.hidden="webkitHidden",d.visibilitychange="webkitvisibilitychange");this.refreshOrientation()};MO.RBrowser.prototype.agent=function(){return this._agent};MO.RBrowser.prototype.capability=function(){return this._capability};MO.RBrowser.prototype.defineProperties=function(){return this._defineProperties};MO.RBrowser.prototype.definePropertyGet=function(a){return this._defineProperties[a]};MO.RBrowser.prototype.defineEvents=function(){return this._defineEvents};
MO.RBrowser.prototype.defineEventGet=function(a){return this._defineEvents[a]};MO.RBrowser.prototype.defineMethods=function(){return this._defineMethods};MO.RBrowser.prototype.defineMethodGet=function(a){return this._defineMethods[a]};MO.RBrowser.prototype.supportHtml5=function(){return this._supportHtml5};MO.RBrowser.prototype.hostPath=function(a){return a?this._hostPath+a:this._hostPath};MO.RBrowser.prototype.setHostPath=function(a){this._hostPath=a};
MO.RBrowser.prototype.contentPath=function(a){return a?this._contentPath+a:this._contentPath};MO.RBrowser.prototype.setContentPath=function(a){this._contentPath=a};MO.RBrowser.prototype.typeCd=function(){return this._typeCd};MO.RBrowser.prototype.isBrowser=function(a){return this._typeCd==a};MO.RBrowser.prototype.orientationCd=function(){return this._orientationCd};MO.RBrowser.prototype.setOrientationCd=function(a){this._orientationCd=a};
MO.RBrowser.prototype.isOrientationHorizontal=function(){return this._orientationCd==MO.EOrientation.Horizontal};MO.RBrowser.prototype.isOrientationVertical=function(){return this._orientationCd==MO.EOrientation.Vertical};
MO.RBrowser.prototype.refreshOrientation=function(){if(null!=window.orientation)if(180==window.orientation||0==window.orientation)this._orientationCd=MO.EOrientation.Vertical;else if(90==window.orientation||-90==window.orientation)this._orientationCd=MO.EOrientation.Horizontal;else throw new MO.TError(this,"Unknown orientation mode.");return this._orientationCd};MO.RBrowser.prototype.isVisibility=function(){var a=this.definePropertyGet("hidden");return!window.document[a]};
MO.RBrowser.prototype.encode=function(a){return escape(a)};MO.RBrowser.prototype.decode=function(a){return unescape(a)};MO.RBrowser.prototype.urlEncode=function(a,b){return b?encodeURIComponent(a):encodeURI(a)};MO.RBrowser.prototype.urlDecode=function(a,b){return b?decodeURIComponent(a):decodeURI(a)};
MO.RBrowser.prototype.fullscreen=function(a,b){b?a.requestFullscreen?a.requestFullscreen():a.mozRequestFullScreen?a.mozRequestFullScreen():a.webkitRequestFullScreen?a.webkitRequestFullScreen():a.msRequestFullscreen&&a.msRequestFullscreen():a.exitFullscreen?a.exitFullscreen():a.mozCancelFullScreen?a.mozCancelFullScreen():a.webkitCancelFullScreen?a.webkitCancelFullScreen():a.msExitFullscreen&&a.msExitFullscreen()};
MO.RBrowser.prototype.downloadBlob=function(a,b){var d=document.createElement("A"),e=document.createEvent("MouseEvents");e.initEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null);d.download=a;d.href=URL.createObjectURL(b);d.dispatchEvent(e)};MO.RBrowser.prototype.downloadText=function(a,b){var d=MO.Labg.Blob.fromText(b);this.downloadBlob(a,d)};MO.RBrowser.prototype.saveConfig=function(a){a.create("Agent").setValue(this._agent)};MO.RBrowser=new MO.RBrowser;MO.Window.Browser=MO.RBrowser;
MO.RXmlUtil=function(){this.httpActiveX=!1;this.httpVendor=null;this.domActiveX=!1;this.domVendor=null;this.construct();return this};
MO.RXmlUtil.prototype.construct=function(){var a=window.document;if(window.ActiveXObject&&!window.XMLHttpRequest)for(var b=["MSXml2.XmlHTTP","Microsoft.XmlHTTP","MSXml.XmlHTTP","MSXml3.XmlHTTP"],d=b.length,e=0;e<d;e++){var f=b[e];try{new ActiveXObject(f);this.httpActiveX=!0;this.httpVendor=f;break}catch(h){m=h}}else if(window.XMLHttpRequest)try{this.httpActiveX=!1}catch(k){m=k}else alert("Unknown http vendor.");if(window.ActiveXObject||!window.DOMParser)for(b=["MSXml2.DOMDocument","Microsoft.XmlDOM",
"MSXml.DOMDocument","MSXml3.XmlDOM"],d=b.length,e=0;e<d;e++){f=b[e];try{new ActiveXObject(f);this.domActiveX=!0;this.domVendor=f;break}catch(q){m=q}}else if(window.DOMParser&&a&&a.implementation&&a.implementation.createDocument)try{document.implementation.createDocument("","",null),this.domActiveX=!1}catch(w){m=w}else alert("Unknown dom vendor.")};MO.RXmlUtil.prototype.isNode=function(a){return RClass.isName(a,"TNode")};
MO.RXmlUtil.prototype.createConnection=function(){var a=null;(a=this.httpActiveX?new ActiveXObject(this.httpVendor):new XMLHttpRequest)||alert("Create xml connection failure. (message="+m+")");return a};MO.RXmlUtil.prototype.createDocument=function(){var a=null;(a=this.domActiveX?new ActiveXObject(this.domVendor):document.implementation.createDocument("","",null))||alert("Create xml document failure. (message="+m+")");return a};
MO.RXmlUtil.prototype.formatText=function(a){null!=a&&(a=a.replace(/\\n/g,"\n"));return a};MO.RXmlUtil.prototype.buildText=function(a,b){if(null!=b){b=b.toString();for(var d=b.length,e=0;e<d;e++){var f=b.charAt(e);switch(f){case "<":a.append("&lt;");break;case ">":a.append("&gt;");break;case "&":a.append("&amp;");break;case "'":a.append("&apos;");break;case '"':a.append("&quot;");break;case "\r":continue;case "\n":a.append("\\n");break;default:a.append(f)}}}return a};
MO.RXmlUtil.prototype.buildNode=function(a,b,d){var e=null,f=d.attributes;if(f){var h=f.length;if(0<h)for(var e=new MO.TAttributes,k=0;k<h;k++){var q=f[k];q.nodeName&&e.set(q.nodeName,this.formatText(q.value))}}h=new MO.TString;h.append(d.value);if(f=d.childNodes)for(q=f.length,k=0;k<q;k++){var w=f[k],x=w.nodeType;x==MO.ENodeType.Text?h.append(w.nodeValue):x==MO.ENodeType.Data&&h.append(w.data)}d=a.create(d.nodeName,e,MO.Lang.String.trim(h.toString()));b?b.push(d):a._root=d;if(f)for(b=f.length,k=
0;k<b;k++)f[k].nodeType==MO.ENodeType.Node&&this.buildNode(a,d,f[k])};MO.RXmlUtil.prototype.makeString=function(a){var b=null;this.domActiveX?(b=new ActiveXObject(this.domVendor),b.async=!1,b.loadXML(a)):b=(new DOMParser).parseFromString(a,"text/xml");return b};
MO.RXmlUtil.prototype.makeNode=function(a){if(a.documentElement){var b=new MO.TXmlDocument;this.buildNode(b,null,a.documentElement);return b.root()}if("SCRIPT"==a.tagName){var d=a.textContent;d||(d=a.text);if(d)return b=new MO.TXmlDocument,a=this.makeString(d),this.buildNode(b,null,a.documentElement),b.root()}return null};MO.RXmlUtil.prototype.makeDocument=function(a){var b=new MO.TXmlDocument;a.documentElement&&this.buildNode(b,null,a.documentElement);return b};
MO.RXmlUtil.prototype.unpack=function(a,b){if(MO.Lang.String.isEmpty(a))return null;b||(b=new MO.TNode);var d=new MO.TAttributes;d.unpack(a);b.name=d.get("name");b.value=d.get("value");d.contains("attributes")&&b.attributes().unpack(d.get("attributes"));if(d.contains("nodes")){var e=new MO.TStrings;e.unpack(d.get("nodes"));for(d=0;d<e.count;d++)this.unpack(e.get(d),b.create())}return b};MO.RXml=new MO.RXmlUtil;MO.Window.Xml=MO.RXml;MO.EConstant=new function(){this.DeviceType="device.type";return this};
MO.STouchEvent=function(){this.dispose=MO.STouchEvent_dispose;return this};MO.STouchEvent_dispose=function(){};MO.TDumpItem=function(){this.link=this.hRow=this.hText=this.hTable=this.hDocument=this.hPanel=this.hParent=null;this.level=0;this.caption=null;this.children=[];this.items=[];this.display=this.innerDisplay=this.loaded=!1;this.create=MO.TDumpItem_create;this.push=MO.TDumpItem_push;this.innerShow=MO.TDumpItem_innerShow;this.show=MO.TDumpItem_show;return this};
MO.TDumpItem_create=function(){return this.children[this.children.length]=new MO.TDumpItem};MO.TDumpItem_push=function(a){this.items[this.items.length]=a};MO.TDumpItem_innerShow=function(a){for(var b=this.items.length,d=0;d<b;d++)MO.RHtml.visibleSet(this.items[d],a);b=this.children.length;for(d=0;d<b;d++){var e=this.children[d];MO.RHtml.visibleSet(e.hRow,a);a?e.show(e.innerDisplay):(e.innerDisplay=e.display,e.show(!1))}};
MO.TDumpItem_show=function(a){this.display=a;var b=MO.Lang.String.repeat("   ",this.level-1)+(a?" -":" +")+" "+this.caption;this.hText.innerHTML=MO.RHtml.toHtml(b);this.innerShow(a)};
MO.FImage=function(a){a=MO.Class.inherits(this,a,MO.FObject,MO.MListenerLoad);a._optionAlpha=MO.Class.register(a,new MO.AGetter("_optionAlpha"),!0);a._ready=!1;a._size=MO.Class.register(a,new MO.AGetter("_size"));a._url=MO.Class.register(a,new MO.AGetter("_url"));a._hImage=null;a.ohLoad=MO.FImage_ohLoad;a.ohError=MO.FImage_ohError;a.construct=MO.FImage_construct;a.image=MO.FImage_image;a.testReady=MO.FImage_testReady;a.loadUrl=MO.FImage_loadUrl;a.dispose=MO.FImage_dispose;return a};
MO.FImage_ohLoad=function(){var a=this.__linker,b=a._hImage;a._size.set(b.naturalWidth,b.naturalHeight);a._ready=!0;b=new MO.SEvent(a);a.processLoadListener(b);b.dispose()};MO.FImage_ohError=function(a){a=this.__linker;MO.Logger.error(a,"Load image failure. (url={1})",a._url)};MO.FImage_construct=function(){this.__base.FObject.construct.call(this);this._size=new MO.SSize2};MO.FImage_image=function(){return this._hImage};MO.FImage_testReady=function(){return this._ready};
MO.FImage_loadUrl=function(a){a=MO.Console.find(MO.FEnvironmentConsole).parse(a);var b=this._hImage;b||(b=this._hImage=new Image,b.__linker=this,b.onload=this.ohLoad,b.onerror=this.ohError);this._url=a;b.src=a};MO.FImage_dispose=function(){this._size=MO.Lang.Object.dispose(this._size);this._hImage=MO.RHtml.free(this._hImage);this.__base.MListenerLoad.dispose.call(this);this.__base.FObject.dispose.call(this)};
MO.FTouchTracker=function(a){a=MO.Class.inherits(this,a,MO.FObject,MO.MListenerTouchZoom);a._touchsLength=null;a._touchs=null;a._touchPool=null;a._touchZoomEvent=null;a.construct=MO.FTouchTracker_construct;a.calculateLength=MO.FTouchTracker_calculateLength;a.eventStart=MO.FTouchTracker_eventStart;a.eventMove=MO.FTouchTracker_eventMove;a.eventStop=MO.FTouchTracker_eventStop;a.dispose=MO.FTouchTracker_dispose;return a};
MO.FTouchTracker_construct=function(){this.__base.FObject.construct.call(this);this._touchs=new MO.TObjects;this._touchPool=MO.Class.create(MO.FObjectPool);this._touchZoomEvent=new MO.SEvent(this)};MO.FTouchTracker_calculateLength=function(a){var b=0;a=a.touches;var d=a.length;if(0<d)for(var e=0;e<d;e++)var f=a[e],h=e==d-1?a[0]:a[e+1],k=f.clientX-h.clientX,f=f.clientY-h.clientY,k=Math.sqrt(k*k+f*f),b=b+k;return b};
MO.FTouchTracker_eventStart=function(a){var b=this._touchs;b.clear();for(var d=a.touches,e=d.length,f=0;f<e;f++){var h=d[f],k=new STouchEvent;k.clientX=h.clientX;k.clientY=h.clientY;b.push(k)}this._touchsLength=this.calculateLength(a)};
MO.FTouchTracker_eventMove=function(a){for(var b=this._touchs,d=a.touches,e=d.length,f=0;f<e;f++){var h=d[f],k=b.at(f);k.clientX=h.clientX;k.clientY=h.clientY}a=this.calculateLength(a);this._touchsLength!=a&&(b=this._touchZoomEvent,b.touchsLength=a,b.delta=a-this._touchsLength,this.processTouchZoomListener(b),this._touchsLength=a)};MO.FTouchTracker_eventStop=function(a){};
MO.FTouchTracker_dispose=function(){this._touchs=MO.Lang.Object.dispose(this._touchs);this._touchZoomEvent=MO.Lang.Object.dispose(this._touchZoomEvent);this.__base.MListenerTouchZoom.dispose.call(this);this.__base.FObject.dispose.call(this)};MO.RBuilder=function(){return this};MO.RBuilder.prototype.create=function(a,b,d){var e=null,e=a.ownerDocument?a.ownerDocument:a.hDocument?a.hDocument:a;a=e.createElement(b);d&&(a.className=d);return a};
MO.RBuilder.prototype.createIcon=function(a,b,d,e,f){a=this.create(a,"IMG",MO.Lang.String.nvl(b,"Tag_Icon"));a.align="absmiddle";d&&(a.src=MO.Window.Resource.iconPath(d));e&&(a.style.width=e+"px");f&&(a.style.height=f+"px");return a};MO.RBuilder.prototype.createImage=function(a,b,d,e,f){a=this.create(a,"IMG",b);d&&(a.src=MO.Window.Resource.imagePath(d));e&&(a.style.width=e+"px");f&&(a.style.height=f+"px");return a};
MO.RBuilder.prototype.createText=function(a,b,d){a=this.create(a,"SPAN",b);d&&(a.innerHTML=d);return a};MO.RBuilder.prototype.createButton=function(a,b){var d=this.create(a,"INPUT",b);d.type="button";return d};MO.RBuilder.prototype.createCheck=function(a,b){var d=this.create(a,"INPUT",b);d.type="checkbox";return d};MO.RBuilder.prototype.createRadio=function(a,b){var d=this.create(a,"INPUT",b);d.type="radio";return d};
MO.RBuilder.prototype.createEdit=function(a,b){var d=this.create(a,"INPUT",b);d.type="text";return d};MO.RBuilder.prototype.createFile=function(a,b){var d=this.create(a,"INPUT",b);d.type="file";return d};MO.RBuilder.prototype.createSpan=function(a,b){return this.create(a,"SPAN",b)};MO.RBuilder.prototype.createDiv=function(a,b){return this.create(a,"DIV",b)};
MO.RBuilder.prototype.createTable=function(a,b,d,e,f){a=this.create(a,"TABLE",b);d&&(a.border=MO.Lang.Integer.nvl(d));a.cellSpacing=MO.Lang.Integer.nvl(e);a.cellPadding=MO.Lang.Integer.nvl(f);return a};MO.RBuilder.prototype.createTableRow=function(a,b){return this.create(a,"TR",b)};MO.RBuilder.prototype.createTableCell=function(a,b){return this.create(a,"TD",b)};
MO.RBuilder.prototype.createFragment=function(a){var b=null,b=a.ownerDocument?a.ownerDocument:a.hDocument?a.hDocument:a;a=b.createDocumentFragment();a.__fragment=!0;return a};MO.RBuilder.prototype.append=function(a,b,d){b=this.create(a.ownerDocument,b,d);a?a.appendChild(b):this.hDocument.body.appendChild(b);return b};MO.RBuilder.prototype.appendIcon=function(a,b,d,e,f){b=this.createIcon(a.ownerDocument,b,d,e,f);a.appendChild(b);return b};
MO.RBuilder.prototype.appendImage=function(a,b,d,e,f){b=this.createImage(a.ownerDocument,b,d,e,f);a.appendChild(b);return b};MO.RBuilder.prototype.appendEmpty=function(a,b,d){b=this.createIcon(a.ownerDocument,null,"n",b,d);a.appendChild(b);return b};MO.RBuilder.prototype.appendText=function(a,b,d){b=this.createText(a.ownerDocument,b,d);a.appendChild(b);return b};MO.RBuilder.prototype.appendButton=function(a,b){var d=this.createButton(a.ownerDocument,b);a.appendChild(d);return d};
MO.RBuilder.prototype.appendCheck=function(a,b){var d=this.createCheck(a.ownerDocument,b);a.appendChild(d);return d};MO.RBuilder.prototype.appendRadio=function(a,b){var d=this.createRadio(a.ownerDocument,b);a.appendChild(d);return d};MO.RBuilder.prototype.appendEdit=function(a,b){var d=this.createEdit(a.ownerDocument,b);a.appendChild(d);return d};MO.RBuilder.prototype.appendFile=function(a,b){var d=this.createFile(a.ownerDocument,b);a.appendChild(d);return d};
MO.RBuilder.prototype.appendSpan=function(a,b){var d=this.createSpan(a.ownerDocument,b);a.appendChild(d);return d};MO.RBuilder.prototype.appendDiv=function(a,b){var d=this.createDiv(a.ownerDocument,b);a.appendChild(d);return d};MO.RBuilder.prototype.appendTable=function(a,b,d,e,f){b=this.createTable(a.ownerDocument,b,d,e,f);a?a.appendChild(b):this.hDocument.body.appendChild(b);return b};
MO.RBuilder.prototype.appendTableRow=function(a,b,d,e){var f=null,f=null==d?MO.RBrowser.isBrowser(MO.EBrowser.Explorer)?a.insertRow():a.insertRow(-1):a.insertRow(d);b&&(f.className=b);e&&(f.height=e);return f};MO.RBuilder.prototype.appendTableRowCell=function(a,b,d,e){a=this.appendTableRow(a,null,null,d);return this.appendTableCell(a,b,null,e)};
MO.RBuilder.prototype.appendTableCell=function(a,b,d,e){var f=null;null==d?(f=this.create(a,"TD",b),a.appendChild(f)):f=a.insertCell(d);b&&(f.className=b);e&&(f.width=e);return f};MO.RBuilder=new MO.RBuilder;MO.Window.Builder=MO.RBuilder;MO.RContext=function(){this._location=null;this._contexts={};this.languageId=this.themeId=this.contextTag=this.contextPath=null;return this};
MO.RContext.prototype.location=function(a){var b=this._location;if(null==b){var b=window.location,d=b.href,b=d.substring(0,d.indexOf(b.pathname));this.contextPath&&(b+=this.contextPath);this._location=b}a&&(b+=a);return b};MO.RContext.prototype.context=function(a){return null!=a?MO.Lang.String.endsWith(a,".wv")?this.contextPath+"/"+a:MO.Lang.String.startsWith(a,"#")?this.contextPath+this.contextTag+a.substr(1):this.contextPath+a:this.contextPath};
MO.RContext.prototype.initialize=function(a){for(var b in a){var d=a[b],e;for(e in d)this._contexts[b+":"+e]=new MO.TContext(b,e,d[e])}};MO.RContext.prototype.get=function(a,b,d,e,f,h){var k=this._contexts[a];return k?MO.Lang.String.format(k.text,b,d,e,f,h):MO.Logger.warn(this,"Can not find context (code={1})",a)};MO.RContext.prototype.find=function(a,b){var d=a+":"+b,e=this._contexts[d];return e?e.text:MO.Logger.warn(this,"Can not find context (id={1})",d)};MO.RContext=new MO.RContext;
MO.Context=MO.RContext;MO.RDump=function(){this.LINE_SINGLE="------------------------------";this.LINE_DOUBLE="==============================";this.LINE_DOT="..............................";this.LINE_STAR="******************************";return this};MO.RDump.prototype.onclick=function(){var a=this.link;this.link&&(a.loaded?a.show(!a.display):(MO.RDump.dumpInner(this.link),a.loaded=!0,a.show(!0)))};
MO.RDump.prototype.nameInfo=function(a){switch(MO.Class.typeOf(a)){case "Unknown":return"@unknown";case "Function":return MO.Method.name(a)+"@Function";case "Array":return"@<Array>"}return a};
MO.RDump.prototype.typeInfo=function(a,b){if(null==a)return"null";switch(b){case "Unknown":return"unknown";case "Undefined":return"undefined";case "Boolean":case "Number":return a.toString();case "String":return a.length+":'"+MO.Lang.String.toLine(a)+"'";case "Function":return a.__virtual?"virtual":MO.Method.name(a,!0);case "Array":return"@<Array@"+MO.Class.code(a)+"> length="+a.length;case "Html":return"@<"+a.tagName+">";default:if(a.constructor==MO.TClass)return"@<"+a.name+"@"+MO.Class.code(a)+
">";if(a.constructor==Function)return"@"+a.toString();try{for(var d in a)return"@<Object@"+MO.Class.code(a)+">"}catch(e){}return"<Object@"+MO.Class.code(a)+">"}};
MO.RDump.prototype.dumpInner=function(a){var b=a.hTable,d=a.hRow,e=a.level,f=a.link,h=MO.Class.typeOf(f,!0),k=f.__class,q=[],w;for(w in f)q[q.length]=w;MO.Lang.String.endsWith(h,"Array")?MO.Lang.Array.reverse(q,0,q.length-1):MO.Lang.Array.sort(q,!0);var x=q.length;2E3<x&&(x=2E3);for(var y=0;y<x;y++){w=q[y];var z="{error}";try{z=f[w]}catch(A){}MO.Class.safeTypeOf(z,!0);var h=MO.Class.safeTypeOf(z,!0),B=null,D=!0;if(k){var E=k.attributeFind(w);E&&(h="Annotation<"+MO.Method.name(E.constructor)+">",B=
z&&z.constructor==Function?"<FONT color='green'>"+MO.Method.name(z)+"</FONT>":z+"<FONT color='green'> - ("+MO.RHtml.toHtml(E.toString())+")</FONT>",D=!1)}null==B&&(B=this.typeInfo(z,h));var E=null,C=MO.RBuilder.appendTableRow(b,null,d?d.rowIndex+1:0);C.bgColor="#FFFFFF";MO.Lang.String.startsWith(B,"@")?(C.style.cursor="pointer",C.onclick=this.onclick,C.bgColor="#FFF0E0",E=C.link=a.create(),E.link=z,E.level=e,E.caption=w,E.hTable=b,E.level=e+1,E.hRow=C):a.push(C);"Function"==h&&"virtual"==B&&(C.bgColor=
"#E0F0FF");var z=MO.RBuilder.appendTableCell(C),F=MO.Lang.String.startsWith(B,"@")?" +":"  ";w=MO.Lang.String.repeat("   ",e)+F+" "+w;z.innerHTML=MO.RHtml.toHtml(w);z.style.borderBottom="1px solid #F0F0F0";z.width="240px";E&&(E.hText=z);z=MO.RBuilder.appendTableCell(C);z.innerHTML=MO.RHtml.toHtml(h);z.style.borderBottom="1px solid #F0F0F0";z.style.color="Function"==h?"#3333FF":"#FF3333";z.width="200px";z=MO.RBuilder.appendTableCell(C);MO.Lang.String.startsWith(B,"@")&&(B=B.substr(1));z.innerHTML=
D?MO.RHtml.toHtml(B):B;z.style.borderBottom="1px solid #F0F0F0"}b.width="100%"};
MO.RDump.prototype.dump=function(a,b){b||(b=MO.RBuilder.append(null,"DIV"));var d=new MO.TString;d.append("<",MO.Class.safeTypeOf(a));a&&a.tagName&&d.append(" - ",a.tagName);d.appendLine("@"+MO.Class.code(a)+">");b=MO.RBuilder.append(b,"DIV");b.style.border="1px solid #BBBBBB";b.style.backgroundColor="#E0E0EB";var e=MO.RBuilder.appendTable(b,null,null,0,1,0),f=MO.RBuilder.appendTableRow(e),f=MO.RBuilder.appendTableCell(f);e.width="100%";f.style.padding=2;f.style.borderBottom="1px solid gray";f.style.backgroundColor=
"#E0E0EB";MO.RHtml.textSet(f,d.toString());d=MO.RBuilder.appendTable(b,null,null,0,1,0);d.style.width="100%";e=new MO.TDumpItem;e.hTable=d;e.hRow=null;e.hParent=b;e.link=a;e.level=0;this.dumpInner(e)};MO.RDump.prototype.appendLevel=function(a,b){for(var d=0;d<b;d++)a.append("   ")};MO.RDump.prototype.stack=function RDump_stack(){for(var b=RDump_stack.caller,d=new MO.TString;b;)d.append(MO.Method.name(b)),(b=b.caller)&&d.appendLine()};MO.RDump=new MO.RDump;
MO.RHtml=function(){this._nextUid=1;this._links={};this._clientPosition=null;return this};MO.RHtml.prototype.uid=function(a){var b=a.__puuid;null==b&&(b=a.__puuid=this._nextUid++);return b};MO.RHtml.prototype.displayGet=function(a){var b=null;a=a.style.display;return b=MO.Window.Browser.isBrowser(MO.EBrowser.Explorer)?"inline"==a:"none"!=a};MO.RHtml.prototype.displaySet=function(a,b){var d=null,d=MO.Window.Browser.isBrowser(MO.EBrowser.Explorer)?b?"inline":"none":b?null:"none";a.style.display=d};
MO.RHtml.prototype.visibleGet=function(a){var b=null;a=a.style.display;return b=MO.Window.Browser.isBrowser(MO.EBrowser.Explorer)?"block"==a:"none"!=a};MO.RHtml.prototype.visibleSet=function(a,b){var d=null,d=MO.Window.Browser.isBrowser(MO.EBrowser.Explorer)?b?"":"none":b?null:"none";a.style.display=d};MO.RHtml.prototype.textGet=function(a,b){var d=null;return d=MO.Window.Browser.isBrowser(MO.EBrowser.FireFox)?a.textContent:a.innerText};
MO.RHtml.prototype.textSet=function(a,b){MO.Window.Browser.isBrowser(MO.EBrowser.FireFox)?a.textContent=b:a.innerText=b};MO.RHtml.prototype.checkGet=function(a){return MO.Lang.Bool.toString(a.checked)};MO.RHtml.prototype.checkSet=function(a,b){a.checked=MO.Lang.Bool.isTrue(b)};MO.RHtml.prototype.radioGet=function(a){if(a)for(var b=a.length,d=0;d<b;d++){var e=a[d];if(e.checked)return e.value}return null};
MO.RHtml.prototype.radioSet=function(a,b){if(a)for(var d=a.length,e=0;e<d;e++){var f=a[e];if(f.value==b){f.checked=!0;break}}};MO.RHtml.prototype.cursorSet=function(a,b){a&&(a.style.cursor=b)};MO.RHtml.prototype.linkGet=function(a,b){var d=this.uid(a);return(d=this._links[d])?d.get(b):null};MO.RHtml.prototype.linkSet=function(a,b,d){var e=this._links,f=this.uid(a),h=e[f];h||(h=e[f]=new MO.THtmlItem,h._link=a);h.set(b,d)};
MO.RHtml.prototype.clientPosition=function(a,b){var d=this._clientPosition;d||(d=this._clientPosition=new MO.SPoint2);for(d.set(0,0);a!=b;)d.x+=a.offsetLeft+a.clientLeft-a.scrollLeft,d.y+=a.offsetTop+a.clientTop-a.scrollTop,a=a.offsetParent;return d};MO.RHtml.prototype.clientX=function(a,b){for(var d=0;a!=b;)d+=a.offsetLeft-a.scrollLeft,a=a.offsetParent;return d};MO.RHtml.prototype.clientY=function(a,b){for(var d=0;a!=b;)d+=a.offsetTop-a.scrollTop,a=a.offsetParent;return d};
MO.RHtml.prototype.setSize=function(a,b){b&&(b.width&&(a.style.width=b.width+"px"),b.height&&(a.style.height=b.height+"px"))};MO.RHtml.prototype.toText=function(a){null!=a&&(a=a.toString(),a=a.replace(/&lt;/,"<"),a=a.replace(/&gt;/g,">"),a=a.replace(/&nbsp;/g," "),a=a.replace(/<BR>/g,"\n"));return a};
MO.RHtml.prototype.toHtml=function(a){null!=a&&(a=a.toString(),a=a.replace(/</g,"&lt;"),a=a.replace(/>/g,"&gt;"),a=a.replace(/ /g,"&nbsp;"),a=a.replace(/\n/g,"<BR>"),a=a.replace(/\\n/g,"<BR>"),a=a.replace(/\r/g,""),a=a.replace(/\\r/g,""));return a};MO.RHtml.prototype.eventSource=function(a){return a.srcElement?a.srcElement:a.target};MO.RHtml.prototype.get=function(a){return document.getElementById(a)};
MO.RHtml.prototype.parent=function(a,b){if(a&&t)for(b=b.toLowerCase();a;){if(a.tagName.toLowerCase()==b)return a;a=a.parentElement}return null};MO.RHtml.prototype.searchLinker=function(a,b){for(;a;){var d=a.__linker;if(d&&MO.Class.isClass(d,b))return d;a=a.parentElement}return null};MO.RHtml.prototype.searchObject=function(a,b){for(;a;){var d=a[b];if(d)return d;a=a.parentElement}return null};
MO.RHtml.prototype.tableMoveRow=function(a,b,d){if("TABLE"!=a.tagName)throw new MO.TError("Html table is invalid.");if(b==d)return!1;if(a.moveRow)a.moveRow(b,d);else{a=a.getElementsByTagName("tbody")[0];var e=a.rows[b],f=a.rows[d];if(null==e||null==f)return!1;var h=null;if(b<=d)for(h=f;(h=h.nextSibling)&&"TR"!=h.tagName;);null==h?a.insertBefore(e,f):null==h?a.appendChild(e):a.insertBefore(e,h)}return!0};MO.RHtml.prototype.clear=function(a){if(a){var b=a.children;if(b)for(var d=b.length-1;0<=d;d--)a.removeChild(b[d])}};
MO.RHtml.prototype.clearAll=function(a){if(a){var b=a.children;if(b)for(var d=b.length-1;0<=d;d--){var e=b[d];e.children&&this.clear(e);a.removeChild(e)}}};MO.RHtml.prototype.free=function(a){return null};MO.RHtml=new MO.RHtml;MO.Window.Html=MO.RHtml;MO.RKeyboard=function(){this._status=[];return this};MO.RKeyboard.prototype.onKeyDown=function(a){this._status[a.keyCode]=MO.EKeyStatus.Press};MO.RKeyboard.prototype.onKeyUp=function(a){this._status[a.keyCode]=MO.EKeyStatus.Normal};
MO.RKeyboard.prototype.construct=function(){for(var a=this._status,b=0;256>b;b++)a[b]=MO.EKeyStatus.Normal;MO.RWindow.lsnsKeyDown.register(this,this.onKeyDown);MO.RWindow.lsnsKeyUp.register(this,this.onKeyUp)};MO.RKeyboard.prototype.isControlKey=function(a){for(var b=MO.EKeyCode.ControlKeys,d=b.length-1;0<=d;d--)if(b[d]==a)return!0;return!1};MO.RKeyboard.prototype.isIntegerKey=function(a){return MO.EKeyCode.integerCodes[a]};MO.RKeyboard.prototype.isFloatKey=function(a){return MO.EKeyCode.floatCodes[a]};
MO.RKeyboard.prototype.isNumKey=function(a){return 96<=p&&105>=p?!0:!1};MO.RKeyboard.prototype.isPress=function(a){return this._status[a]==MO.EKeyStatus.Press};MO.RKeyboard.prototype.fixCase=function(a,b){if(a&&b){var d=a.keyCode;ECase.Upper==b?d=String.fromCharCode(d).toUpperCase().charCodeAt(0):ECase.Lower==b&&(d=String.fromCharCode(d).toLowerCase().charCodeAt(0));a.keyCode=d}};
MO.RKeyboard.prototype.fixPattern=function(a,b){if(b){var d=a.keyCode;if(!this.isControlKeyPress(d)&&!MO.Lang.String.isPattern(String.fromCharCode(d),b))return a.keyCode=0,!1}return!0};MO.RKeyboard.prototype.fixChars=function(a,b){if(b){var d=a.keyCode;this.isNumKey(d)&&(d=a.keyCode-=48);if(!this.isControlKeyPress(d)&&!MO.Lang.String.inChars(String.fromCharCode(d),b))return a.keyCode=0,a.returnValue=!1}return!0};MO.Window.Keyboard=new MO.RKeyboard;
MO.RResource=function(){this.uriIcon="/ars/icon/";this.uriImage="/ars/img/";return this};MO.RResource.prototype.iconPath=function(a,b){var d=null;if(-1!=a.indexOf("|")){var e=a.split("|"),d=e[0];b=e[1]}else d=a;d=MO.Lang.String.nvl(d,"n").replace(/\./g,"/")+"."+MO.Lang.String.nvl(b,"gif");return MO.Window.Browser.contentPath("/ars/icon/"+d)};
MO.RResource.prototype.iconUrlPath=function(a,b){a=MO.Lang.String.nvl(a,"n").replace(/\./g,"/")+"."+MO.Lang.String.nvl(b,"gif");return MO.RBrowser.contentPath("/ars/icon/"+a)};MO.RResource.prototype.imagePath=function(a,b){};MO.RResource=new MO.RResource;MO.Window.Resource=MO.RResource;
MO.RValue=function(){this.double64=this.double16=this.double16=this.double4=this.double3=this.double2=this.double1=this.float16=this.float12=this.float9=this.float4=this.float3=this.float2=this.float1=null;this.construct();return this};
MO.RValue.prototype.construct=function(){MO.RBrowser.supportHtml5()&&(this.float1=new Float32Array(1),this.float2=new Float32Array(2),this.float3=new Float32Array(3),this.float4=new Float32Array(4),this.float9=new Float32Array(9),this.float12=new Float32Array(12),this.float16=new Float32Array(16),this.double1=new Float64Array(1),this.double2=new Float64Array(2),this.double3=new Float64Array(3),this.double4=new Float64Array(4),this.double9=new Float64Array(9),this.double12=new Float64Array(12),this.double16=
new Float64Array(16))};MO.RValue=new MO.RValue;MO.EGraphicError=new function(){this.Unsupport2d="unsupport.2d";this.UnsupportWebGL="unsupport.webgL";return this};MO.MCanvasObject=function(a){a=MO.Class.inherits(this,a);a.htmlCanvas=MO.Method.virtual(a,"htmlCanvas");return a};
MO.MGraphicObject=function(a){a=MO.Class.inherits(this,a);a._graphicContext=MO.Class.register(a,new MO.AGetter("_graphicContext"));a.linkGraphicContext=MO.MGraphicObject_linkGraphicContext;a.dispose=MO.MGraphicObject_dispose;return a};
MO.MGraphicObject_linkGraphicContext=function(a){if(MO.Class.isClass(a,MO.FGraphicContext))this._graphicContext=a;else if(MO.Class.isClass(a,MO.MGraphicObject))this._graphicContext=a.graphicContext();else throw new MO.TError(this,"Link graphic context failure. (context={1})",a);};MO.MGraphicObject_dispose=function(){this._graphicContext=null};MO.MGraphicRenderable=function(a){a=MO.Class.inherits(this,a,MO.FObject);a.process=MO.Method.empty;return a};MO.Graphic=new function(){return this};
MO.FFloatStream=function(a){a=MO.Class.inherits(this,a,MO.FObject);a._length=MO.Class.register(a,new MO.AGetter("_length"),0);a._memory=MO.Class.register(a,new MO.AGetter("_memory"),null);a._position=0;a.construct=MO.FFloatStream_construct;a.setLength=MO.FFloatStream_setLength;a.writeFloat4=MO.FFloatStream_writeFloat4;a.writeColor4=MO.FFloatStream_writeColor4;a.reset=MO.FFloatStream_reset;a.clear=MO.FFloatStream_clear;a.dispose=MO.FFloatStream_dispose;return a};MO.FFloatStream_construct=function(){this.__base.FObject.construct.call(this)};
MO.FFloatStream_setLength=function(a){this._length=a;this._memory=new Float32Array(a)};MO.FFloatStream_writeFloat4=function(a,b,d,e){this._memory[this._position++]=a;this._memory[this._position++]=b;this._memory[this._position++]=d;this._memory[this._position++]=e};MO.FFloatStream_writeColor4=function(a){this.writeFloat4(a.red,a.green,a.blue,a.alpha)};MO.FFloatStream_reset=function(){this._position=0};MO.FFloatStream_clear=function(){this._position=0};
MO.FFloatStream_dispose=function(){this._memory=null;this.__base.FObject.dispose.call(this)};MO.FGraphicContext=function(a){a=MO.Class.inherits(this,a,MO.FObject,MO.MGraphicObject);a._size=MO.Class.register(a,new MO.AGetter("_size"));a._hCanvas=MO.Class.register(a,new MO.AGetter("_hCanvas","htmlCanvas"));a.construct=MO.FGraphicContext_construct;a.linkCanvas=MO.Method.virtual(a,"linkCanvas");a.dispose=MO.FGraphicContext_dispose;return a};
MO.FGraphicContext_construct=function(){this.__base.FObject.construct.call(this);this._size=new MO.SSize2(1280,720)};MO.FGraphicContext_dispose=function(){this._size=MO.Lang.Object.dispose(this._size);this._hCanvas=null;this.__base.FObject.dispose.call(this)};
MO.SBorder=function(){this.valid=!1;this.left=new MO.SBorderLine;this.top=new MO.SBorderLine;this.right=new MO.SBorderLine;this.bottom=new MO.SBorderLine;this.parse=MO.SBorder_parse;this.toString=MO.SBorder_toString;this.dispose=MO.SBorder_dispose;return this};MO.SBorder_parse=function(a){var b=a.split(",");if(4==b.length)this.left.parse(b[0]),this.top.parse(b[1]),this.right.parse(b[2]),this.bottom.parse(b[3]);else throw new MO.TError(this,"Parse value failure. (source={1})",a);};
MO.SBorder_toString=function(){return this.left+","+this.top+","+this.right+","+this.bottom};MO.SBorder_dispose=function(){this.left=MO.Lang.Object.dispose(this.left);this.top=MO.Lang.Object.dispose(this.top);this.right=MO.Lang.Object.dispose(this.right);this.bottom=MO.Lang.Object.dispose(this.bottom)};
MO.SBorderLine=function(a,b,d){this.width=MO.Runtime.nvl(a,1);this.style=MO.Runtime.nvl(b,"solid");this.color=MO.Runtime.nvl(d,"#FFFFFF");this.parse=MO.SBorderLine_parse;this.toString=MO.SBorderLine_toString;this.dispose=MO.SBorderLine_dispose;return this};MO.SBorderLine_parse=function(a){var b=a.split(" ");if(3==b.length)this.width=parseInt(b[0]),this.style=b[1],this.color=b[2];else throw new TError(this,"Parse value failure. (source={1})",a);};
MO.SBorderLine_toString=function(){return this.width+" "+this.style+" "+this.color};MO.SBorderLine_dispose=function(){this.color=this.style=this.width=null};MO.FG2dObject=function(a){a=MO.Class.inherits(this,a,MO.FObject,MO.MGraphicObject);a.setup=MO.FG2dObject_setup;a.dispose=MO.FG2dObject_dispose;return a};MO.FG2dObject_setup=function(){};MO.FG2dObject_dispose=function(){this.__base.MGraphicObject.dispose.call(this);this.__base.FObject.dispose.call(this)};
MO.FG2dContext=function(a){a=MO.Class.inherits(this,a,MO.FGraphicContext);a._globalScale=MO.Class.register(a,new MO.AGetter("_globalScale"));a._scale=MO.Class.register(a,new MO.AGetter("_scale"));a.construct=MO.FG2dContext_construct;a.linkCanvas=MO.FG2dContext_linkCanvas;a.dispose=MO.FG2dContext_dispose;return a};MO.FG2dContext_construct=function(){this.__base.FGraphicContext.construct.call(this);this._globalScale=new MO.SSize2(1,1);this._scale=new MO.SSize2(1,1)};
MO.FG2dContext_linkCanvas=function(a){this._size.set(a.width,a.height)};MO.FG2dContext_dispose=function(){this._globalScale=MO.Lang.Object.dispose(this._globalScale);this._scale=MO.Lang.Object.dispose(this._scale);this.__base.FGraphicContext.dispose.call(this)};
MO.FG2dCanvasContext=function(a){a=MO.Class.inherits(this,a,MO.FG2dContext);a._handle=null;a._gridSourceX=null;a._gridSourceY=null;a._gridSourceWidth=null;a._gridSourceHeight=null;a._gridDrawX=null;a._gridDrawY=null;a._gridDrawWidth=null;a._gridDrawHeight=null;a.construct=MO.FG2dCanvasContext_construct;a.linkCanvas=MO.FG2dCanvasContext_linkCanvas;a.setGlobalScale=MO.FG2dCanvasContext_setGlobalScale;a.setScale=MO.FG2dCanvasContext_setScale;a.setAlpha=MO.FG2dCanvasContext_setAlpha;a.setFont=MO.FG2dCanvasContext_setFont;
a.store=MO.FG2dCanvasContext_store;a.restore=MO.FG2dCanvasContext_restore;a.prepare=MO.FG2dCanvasContext_prepare;a.clear=MO.FG2dCanvasContext_clear;a.clearRectangle=MO.FG2dCanvasContext_clearRectangle;a.clip=MO.FG2dCanvasContext_clip;a.textWidth=MO.FG2dCanvasContext_textWidth;a.createLinearGradient=MO.FG2dCanvasContext_createLinearGradient;a.drawLine=MO.FG2dCanvasContext_drawLine;a.drawRectangle=MO.FG2dCanvasContext_drawRectangle;a.drawTriangle=MO.FG2dCanvasContext_drawTriangle;a.drawCircle=MO.FG2dCanvasContext_drawCircle;
a.drawText=MO.FG2dCanvasContext_drawText;a.drawTextVertical=MO.FG2dCanvasContext_drawTextVertical;a.drawImage=MO.FG2dCanvasContext_drawImage;a.drawGridImage=MO.FG2dCanvasContext_drawGridImage;a.drawQuadrilateral=MO.FG2dCanvasContext_drawQuadrilateral;a.drawBorderLine=MO.FG2dCanvasContext_drawBorderLine;a.drawBorder=MO.FG2dCanvasContext_drawBorder;a.fillRectangle=MO.FG2dCanvasContext_fillRectangle;a.toBytes=MO.FG2dCanvasContext_toBytes;return a};
MO.FG2dCanvasContext_construct=function(){this.__base.FG2dContext.construct.call(this);this._gridSourceX=Array(3);this._gridSourceY=Array(3);this._gridSourceWidth=Array(3);this._gridSourceHeight=Array(3);this._gridDrawX=Array(3);this._gridDrawY=Array(3);this._gridDrawWidth=Array(3);this._gridDrawHeight=Array(3)};
MO.FG2dCanvasContext_linkCanvas=function(a){this.__base.FG2dContext.linkCanvas.call(this,a);if(a.getContext){var b=a.getContext("2d");if(!b)throw new MO.TError(this,"Current browser can't support Context2D technique.");this._handle=b}this._hCanvas=a};MO.FG2dCanvasContext_setGlobalScale=function(a,b){this._globalScale.set(a,b)};MO.FG2dCanvasContext_setScale=function(a,b){this._scale.equalsData(a,b)||(this._handle.scale(a,b),this._scale.set(a,b))};
MO.FG2dCanvasContext_setAlpha=function(a){this._handle.globalAlpha=a};MO.FG2dCanvasContext_setFont=function(a){this._handle.font=a};MO.FG2dCanvasContext_store=function(){this._handle.save()};MO.FG2dCanvasContext_restore=function(){this._handle.restore()};MO.FG2dCanvasContext_prepare=function(a){var b=this._handle,d=this._globalScale;a&&(a=this._size,b.setTransform(1,0,0,1,0,0),b.clearRect(0,0,a.width,a.height));b.setTransform(d.width,0,0,d.height,0,0)};
MO.FG2dCanvasContext_clear=function(){var a=this._size,b=this._handle;b.save();b.setTransform(1,0,0,1,0,0);this._handle.clearRect(0,0,a.width,a.height);b.restore()};MO.FG2dCanvasContext_clearRectangle=function(a){this._handle.clearRect(a.left,a.top,a.width,a.height)};MO.FG2dCanvasContext_clip=function(a,b,d,e){var f=this._handle;f.beginPath();f.rect(a,b,d,e);f.clip()};MO.FG2dCanvasContext_textWidth=function(a){return this._handle.measureText(a).width};
MO.FG2dCanvasContext_createLinearGradient=function(a,b,d,e){return this._handle.createLinearGradient(a,b,d,e)};MO.FG2dCanvasContext_drawLine=function(a,b,d,e,f,h){var k=this._handle;k.strokeStyle=f;k.lineWidth=h;k.beginPath();k.moveTo(a,b);k.lineTo(d,e);k.closePath();k.stroke()};MO.FG2dCanvasContext_drawRectangle=function(a,b,d,e,f,h){var k=this._handle;k.strokeStyle=f;k.lineWidth=h;k.strokeRect(a,b,d,e)};
MO.FG2dCanvasContext_drawText=function(a,b,d,e){var f=this._handle;f.fillStyle=e;f.fillText(a,b,d)};MO.FG2dCanvasContext_drawTextVertical=function(a,b,d,e){var f=this._handle;f.font=e.toString();f.fillStyle=e.color;for(var h=0;h<a.length;h++)f.fillText(a.charAt(h),b,d),d+=e.size+parseInt(e.size/5)};
MO.FG2dCanvasContext_drawImage=function(a,b,d,e,f){var h=this._handle,k=null;if("IMG"==a.tagName)k=a;else if(MO.Class.isClass(a,MO.FImage)){if(!a.testReady())return;k=a.image();null==e&&(e=k.size().width);null==f&&(f=k.size().height)}else throw new MO.TError(this,"Unknown content type");h.drawImage(k,b,d,e,f)};
MO.FG2dCanvasContext_drawGridImage=function(a,b,d,e,f,h){var k=this._handle,q=null;if(MO.Class.isClass(a,MO.FImage)){if(!a.testReady())return;q=a.image()}else throw new TError(this,"Unknown content type");var w=a.size();a=this._gridSourceX;a[0]=0;a[1]=h.left;a[2]=w.width-h.right;var x=this._gridSourceY;x[0]=0;x[1]=h.top;x[2]=w.height-h.bottom;var y=this._gridDrawX;y[0]=b;y[1]=b+h.left;y[2]=b+e-h.right;b=this._gridDrawY;b[0]=d;b[1]=d+h.top;b[2]=d+f-h.bottom;d=this._gridSourceWidth;d[0]=h.left;d[1]=
w.width-h.left-h.right;d[2]=h.right;var z=this._gridSourceHeight;z[0]=h.top;z[1]=w.height-h.top-h.bottom;z[2]=h.bottom;w=this._gridDrawWidth;w[0]=h.left;w[1]=e-h.left-h.right;w[2]=h.right;e=this._gridDrawHeight;e[0]=h.top;e[1]=f-h.top-h.bottom;e[2]=h.bottom;for(f=0;9>f;f++){h=parseInt(f/3);var A=f%3;0<e[h]&&0<w[A]&&k.drawImage(q,a[A],x[h],d[A],z[h],y[A],b[h],w[A],e[h])}};MO.FG2dCanvasContext_drawImageRectangle=function(a,b){return this.drawImage(a,b.left,b.top,b.width,b.height)};
MO.FG2dCanvasContext_drawBorderLine=function(a,b,d,e,f){var h=this._handle;h.strokeStyle=f.color;h.lineWidth=f.width;h.beginPath();h.moveTo(a+.5,b+.5);h.lineTo(d+.5,e+.5);h.closePath();h.stroke()};MO.FG2dCanvasContext_drawBorder=function(a,b){var d=a.left,e=a.top,f=a.left+a.width-1,h=a.top+a.height-1;this.drawBorderLine(d,h,d,e,b.left);this.drawBorderLine(d-.5,e,f+.5,e,b.top);this.drawBorderLine(f,e,f,h,b.right);this.drawBorderLine(d-.5,h,f+.5,h,b.bottom)};
MO.FG2dCanvasContext_fillRectangle=function(a,b,d,e,f){var h=this._handle;h.fillStyle=f;h.beginPath();h.fillRect(a,b,d,e);h.closePath()};MO.FG2dCanvasContext_drawQuadrilateral=function(a,b,d,e,f,h,k,q,w,x,y){var z=this._handle;z.beginPath();z.lineWidth=w;z.strokeStyle=x;z.fillStyle=y;z.moveTo(a+.5,b+.5);z.lineTo(d+.5,e+.5);z.lineTo(f+.5,h+.5);z.lineTo(k+.5,q+.5);z.lineTo(a+.5,b+.5);z.closePath();null!=w&&null!=x&&z.stroke();null!=y&&z.fill()};
MO.FG2dCanvasContext_drawTriangle=function(a,b,d,e,f,h,k,q,w){var x=this._handle;x.lineWidth=k;x.strokeStyle=q;x.fillStyle=w;x.beginPath();x.moveTo(a+.5,b+.5);x.lineTo(d+.5,e+.5);x.lineTo(f+.5,h+.5);x.closePath();x.fill();x.stroke()};MO.FG2dCanvasContext_drawCircle=function(a,b,d,e,f,h){var k=this._handle;k.lineWidth=e;k.strokeStyle=f;k.fillStyle=h;k.beginPath();k.arc(a,b,d,0,2*Math.PI,!1);k.closePath();(h||""!=h)&&k.fill();(f||""!=f)&&k.stroke()};
MO.FG2dCanvasContext_toBytes=function(){var a=this._size;return this._handle.getImageData(0,0,a.width,a.height)};MO.EG3dMaterialMap=new function(){this.AmbientColor=0;this.DiffuseColor=1;this.SpecularColor=2;this.ReflectColor=3;this.EmissiveColor=4;this.Count=8;return this};
MO.EG3dRegionParameter=new function(){this.Unknown=0;this.CameraPosition=1;this.CameraDirection=2;this.CameraViewMatrix=3;this.CameraProjectionMatrix=4;this.CameraViewProjectionMatrix=5;this.LightPosition=6;this.LightDirection=7;this.LightViewMatrix=8;this.LightProjectionMatrix=9;this.LightViewProjectionMatrix=10;this.LightInfo=11;return this};
MO.EG3dTechniqueMode=new function(){this.Color="color";this.Ambient="ambient";this.DiffuseLevel="diffuse.level";this.DiffuseColor="diffuse.color";this.SpecularLevel="specular.level";this.SpecularColor="specular.color";this.Reflect="reflect";this.Emissive="emissive";this.Result="result";return this};
MO.MG3dRegion=function(a){a=MO.Class.inherits(this,a);a._changed=!1;a._spaceName=MO.Class.register(a,new MO.AGetter("_spaceName"));a._technique=MO.Class.register(a,new MO.AGetSet("_technique"));a._techniquePass=MO.Class.register(a,new MO.AGetter("_techniquePass"));a._camera=MO.Class.register(a,new MO.AGetter("_camera"));a._projection=null;a._directionalLight=MO.Class.register(a,new MO.AGetter("_directionalLight"));a._lights=MO.Class.register(a,new MO.AGetter("_lights"));a._allRenderables=MO.Class.register(a,
new MO.AGetter("_allRenderables"));a._renderables=MO.Class.register(a,new MO.AGetter("_renderables"));a._ratioMatrix=null;a._cameraPosition=null;a._cameraDirection=null;a._cameraViewMatrix=null;a._cameraProjectionMatrix=null;a._cameraViewProjectionMatrix=null;a._lightPosition=null;a._lightDirection=null;a._lightViewMatrix=null;a._lightProjectionMatrix=null;a._lightViewProjectionMatrix=null;a._lightInfo=null;a.construct=MO.MG3dRegion_construct;a.isChanged=MO.MG3dRegion_isChanged;a.setTechniquePass=
MO.MG3dRegion_setTechniquePass;a.pushRenderable=MO.MG3dRegion_pushRenderable;a.setup=MO.MG3dRegion_setup;a.change=MO.MG3dRegion_change;a.prepare=MO.MG3dRegion_prepare;a.reset=MO.MG3dRegion_reset;a.calculate=MO.MG3dRegion_calculate;a.update=MO.MG3dRegion_update;a.dispose=MO.MG3dRegion_dispose;return a};
MO.MG3dRegion_construct=function(){this._lights=new MO.TObjects;this._renderables=new MO.TObjects;this._allRenderables=new MO.TObjects;this._ratioMatrix=new MO.SMatrix3d;this._cameraPosition=new MO.SPoint3;this._cameraDirection=new MO.SVector3;this._cameraViewMatrix=new MO.SMatrix3d;this._cameraProjectionMatrix=new MO.SMatrix3d;this._cameraViewProjectionMatrix=new MO.SMatrix3d;this._lightPosition=new MO.SPoint3;this._lightDirection=new MO.SVector3;this._lightViewMatrix=new MO.SMatrix3d;this._lightProjectionMatrix=
new MO.SMatrix3d;this._lightViewProjectionMatrix=new MO.SMatrix3d;this._lightInfo=new MO.SVector4};MO.MG3dRegion_isChanged=function(){return this._changed};MO.MG3dRegion_setTechniquePass=function(a,b){this._techniquePass=a;this._spaceName=a.fullCode();this._finish=b};MO.MG3dRegion_pushRenderable=function(a){this._renderables.push(a);this._allRenderables.push(a)};MO.MG3dRegion_setup=function(){};MO.MG3dRegion_change=function(){this._changed=!0};
MO.MG3dRegion_prepare=function(){this._changed=!1;var a=this._camera,b=a.projection();a.updateFrustum();MO.Window.Browser.capability();this._ratioMatrix.identity();this._cameraPosition.assign(a.position());this._cameraDirection.assign(a.direction());this._cameraViewMatrix.assign(a.matrix());this._cameraProjectionMatrix.assign(b.matrix());this._cameraViewProjectionMatrix.assign(a.matrix());this._cameraViewProjectionMatrix.append(b.matrix());a=this._directionalLight.camera();a.position();this._lightPosition.assign(a.position());
this._lightDirection.assign(a.direction());this._lightViewMatrix.assign(a.matrix());this._allRenderables.clear()};MO.MG3dRegion_reset=function(){this._renderables.clear()};
MO.MG3dRegion_calculate=function(a){switch(a){case MO.EG3dRegionParameter.CameraPosition:return this._cameraPosition;case MO.EG3dRegionParameter.CameraDirection:return this._cameraDirection;case MO.EG3dRegionParameter.CameraViewMatrix:return this._cameraViewMatrix;case MO.EG3dRegionParameter.CameraProjectionMatrix:return this._cameraProjectionMatrix;case MO.EG3dRegionParameter.CameraViewProjectionMatrix:return this._cameraViewProjectionMatrix;case MO.EG3dRegionParameter.LightPosition:return this._lightPosition;
case MO.EG3dRegionParameter.LightDirection:return this._lightDirection;case MO.EG3dRegionParameter.LightViewMatrix:return this._lightViewMatrix;case MO.EG3dRegionParameter.LightProjectionMatrix:return this._lightProjectionMatrix;case MO.EG3dRegionParameter.LightViewProjectionMatrix:return this._lightViewProjectionMatrix;case MO.EG3dRegionParameter.LightInfo:return this._lightInfo}throw new MO.TError(this,"Unknown parameter type. (type_cd={1})",a);};
MO.MG3dRegion_update=function(){for(var a=this._renderables,b=a.count(),d=0;d<b;d++)a.at(d).update(this)};MO.MG3dRegion_dispose=function(){this._ratioMatrix=MO.Lang.Object.free(this._ratioMatrix);this._renderables=MO.Lang.Object.free(this._renderables);this._allRenderables=MO.Lang.Object.free(this._allRenderables)};
MO.MG3dRenderable=function(a){a=MO.Class.inherits(this,a,MO.MGraphicRenderable);a._optionMerge=MO.Class.register(a,new MO.AGetter("_optionMerge"),!1);a._optionSelect=MO.Class.register(a,new MO.AGetter("_optionSelect"),!0);a._currentMatrix=MO.Class.register(a,new MO.AGetter("_currentMatrix"));a._matrix=MO.Class.register(a,new MO.AGetter("_matrix"));a._material=MO.Class.register(a,new MO.AGetSet("_material"));a._activeInfo=MO.Class.register(a,new MO.AGetter("_activeInfo"));a._infos=null;a.construct=
MO.MG3dRenderable_construct;a.activeEffect=MO.MG3dRenderable_activeEffect;a.effectFind=MO.MG3dRenderable_effectFind;a.effectSet=MO.MG3dRenderable_effectSet;a.infos=MO.MG3dRenderable_infos;a.selectInfo=MO.MG3dRenderable_selectInfo;a.resetInfos=MO.MG3dRenderable_resetInfos;a.testVisible=MO.Method.emptyTrue;a.update=MO.Method.empty;a.dispose=MO.MG3dRenderable_dispose;return a};MO.MG3dRenderable_construct=function(){this._currentMatrix=new MO.SMatrix3d;this._matrix=new MO.SMatrix3d};
MO.MG3dRenderable_activeEffect=function(){var a=this._activeInfo;return a?a.effect:null};MO.MG3dRenderable_effectFind=function(a){var b=this._infos;return b&&(a=b.get(a))?a.effect:null};MO.MG3dRenderable_effectSet=function(a,b){var d=this.infos(),e=d.get(a);e||(e=new MO.SG3dRenderableInfo,d.set(a,e));e.effect=b};MO.MG3dRenderable_infos=function(){var a=this._infos;a||(a=this._infos=new MO.TDictionary);return a};
MO.MG3dRenderable_selectInfo=function(a){var b=this.infos(),d=b.get(a);d||(d=new MO.SG3dRenderableInfo,b.set(a,d));return this._activeInfo=d};MO.MG3dRenderable_resetInfos=function(){var a=this._infos;if(a)for(var b=a.count(),d=0;d<b;d++)a.at(d).reset()};MO.MG3dRenderable_dispose=function(){this._currentMatrix=MO.Lang.Object.dispose(this._currentMatrix);this._matrix=MO.Lang.Object.dispose(this._matrix);this._material=MO.Lang.Object.dispose(this._material);this._activeInfo=null;this._infos=MO.Lang.Object.dispose(this._infos)};
MO.SG3dEffectInfo=function(){this.supportInstance=this.optionNormalCompress=this.optionNormalInvert=this.optionAlphaTest=this.blendTargetMode=this.blendSourceMode=this.optionBlendMode=this.optionDepthWrite=this.depthModeCd=this.optionDepthTest=this.cullModeCd=this.optionCullMode=this.fillModeCd=this.mergeCount=this.optionMerge=this.techniqueModeCode=this.techniqueCode=this.code=null;this.vertexCount=0;this.vertexSkeleton=this.vertexNormalFull=this.vertexNormal=this.vertexCoord=this.vertexColor=null;
this.vertexBoneCount=0;this.fragmentHeight=this.fragmentEmissive=this.fragmentRefract=this.fragmentReflect=this.fragmentLight=this.fragmentEnvironment=this.fragmentSpecularView=this.fragmentSpecularLevel=this.fragmentSpecularColor=this.fragmentDiffuseView=this.fragmentDiffuse=this.fragmentAmbient=this.fragmentBump=this.fragmentAlpha=null;this.attributes=new MO.TArray;this.samplers=new MO.TArray;this.attributeContains=MO.SG3dEffectInfo_attributeContains;this.samplerContains=MO.SG3dEffectInfo_samplerContains;
this.reset=MO.SG3dEffectInfo_reset;this.reset();return this};MO.SG3dEffectInfo_attributeContains=function(a){return this.attributes.contains(a)};MO.SG3dEffectInfo_samplerContains=function(a){return this.samplers.contains(a)};
MO.SG3dEffectInfo_reset=function(){this.code=null;this.optionMerge=!1;this.mergeCount=0;this.fillModeCd=MO.EG3dFillMode.Fill;this.optionCullMode=!0;this.cullModeCd=MO.EG3dCullMode.Front;this.optionDepthTest=!0;this.depthModeCd=MO.EG3dDepthMode.Less;this.optionDepthWrite=!0;this.optionBlendMode=!1;this.blendSourceMode=MO.EG3dBlendMode.SourceAlpha;this.blendTargetMode=MO.EG3dBlendMode.OneMinusSourceAlpha;this.optionNormalInvert=this.optionAlphaTest=!1;this.optionNormalCompress=!0;this.supportInstance=
!1;this.vertexCount=0;this.vertexSkeleton=this.vertexNormalFull=this.vertexNormal=this.vertexCoord=this.vertexColor=!1;this.vertexBoneCount=0;this.fragmentHeight=this.fragmentEmissive=this.fragmentRefract=this.fragmentReflect=this.fragmentLight=this.fragmentEnvironment=this.fragmentSpecularView=this.fragmentSpecularLevel=this.fragmentSpecularColor=this.fragmentDiffuseView=this.fragmentDiffuse=this.fragmentAmbient=this.fragmentBump=this.fragmentAlpha=!1;this.attributes.clear();this.samplers.clear()};
MO.SG3dMaterialInfo=function(){this.effectCode="automatic";this.optionAlpha=this.optionShadowSelf=this.optionShadow=this.optionNormalInvert=this.optionDouble=this.optionDepth=null;this.alphaMerge=this.alphaLevel=this.alphaRate=this.alphaBase=1;this.optionColor=null;this.colorMin=0;this.colorMax=1;this.colorBalance=.5;this.colorRate=1;this.optionVertex=null;this.vertexColor=new MO.SColor4;this.optionAmbient=null;this.ambientColor=new MO.SColor4;this.ambientShadow=1;this.optionDiffuse=null;this.diffuseColor=
new MO.SColor4;this.diffuseShadow=1;this.optionDiffuseView=null;this.diffuseViewColor=new MO.SColor4;this.diffuseViewShadow=1;this.optionSpecular=null;this.specularColor=new MO.SColor4;this.specularShadow=this.specularAverage=this.specularLevel=this.specularBase=1;this.optionSpecularView=this.specularInfo=null;this.specularViewColor=new MO.SColor4;this.specularViewShadow=this.specularViewAverage=this.specularViewRate=this.specularViewBase=1;this.optionReflect=this.specularViewShadow=null;this.reflectColor=
new MO.SColor4;this.reflectShadow=this.reflectMerge=1;this.optionRefract=null;this.refractFrontColor=new MO.SColor4;this.refractBackColor=new MO.SColor4;this.optionOpacity=null;this.opacityColor=new MO.SColor4;this.opacityTransmittance=this.opacityDepth=this.opacityAlpha=this.opacityRate=1;this.optionEmissive=null;this.emissiveColor=new MO.SColor4;this.assign=MO.SG3dMaterialInfo_assign;this.calculate=MO.SG3dMaterialInfo_calculate;this.reset=MO.SG3dMaterialInfo_reset;this.reset();return this};
MO.SG3dMaterialInfo_assign=function(a){this.effectCode=a.effectCode;this.transformName=a.transformName;this.optionDepth=a.optionDepth;this.optionDouble=a.optionDouble;this.optionNormalInvert=a.optionNormalInvert;this.optionShadow=a.optionShadow;this.optionShadowSelf=a.optionShadowSelf;this.optionAlpha=a.optionAlpha;this.alphaBase=a.alphaBase;this.alphaRate=a.alphaRate;this.alphaLevel=a.alphaLevel;this.alphaMerge=a.alphaMerge;this.optionColor=a.optionColor;this.colorMin=a.colorMin;this.colorMax=a.colorMax;
this.colorBalance=a.colorBalance;this.colorRate=a.colorRate;this.optionVertex=a.optionVertex;this.vertexColor.assign(a.vertexColor);this.optionAmbient=a.optionAmbient;this.ambientColor.assign(a.ambientColor);this.ambientShadow=a.ambientShadow;this.optionDiffuse=a.optionDiffuse;this.diffuseColor.assign(a.diffuseColor);this.diffuseShadow=a.diffuseShadow;this.optionDiffuseView=a.optionDiffuseView;this.diffuseViewColor.assign(a.diffuseViewColor);this.diffuseViewShadow=a.diffuseViewShadow;this.optionSpecular=
a.optionSpecular;this.specularColor.assign(a.specularColor);this.specularBase=a.specularBase;this.specularLevel=a.specularLevel;this.specularAverage=a.specularAverage;this.specularShadow=a.specularShadow;this.optionSpecularView=a.optionSpecularView;this.specularViewColor.assign(a.specularViewColor);this.specularViewBase=a.specularViewBase;this.specularViewRate=a.specularViewRate;this.specularViewAverage=a.specularViewAverage;this.specularViewShadow=a.specularViewShadow;this.optionReflect=a.optionReflect;
this.reflectColor.assign(a.reflectColor);this.reflectMerge=MO.Lang.Float.toRange(a.reflectMerge,0,2);this.reflectShadow=a.reflectShadow;this.optionRefract=a.optionRefract;this.refractFrontColor.assign(a.refractFrontColor);this.refractFrontMerge=a.refractFrontMerge;this.refractFrontShadow=a.refractFrontShadow;this.refractBackColor.assign(a.refractBackColor);this.refractBackMerge=a.refractBackMerge;this.refractBackShadow=a.refractBackShadow;this.optionOpacity=a.optionOpacity;this.opacityColor.assign(a.opacityColor);
this.opacityRate=a.opacityRate;this.opacityAlpha=a.optionAlpha;this.opacityDepth=a.optionDepth;this.opacityTransmittance=a.optionTransmittance;this.optionEmissive=a.optionEmissive;this.emissiveColor.assign(a.emissiveColor)};
MO.SG3dMaterialInfo_calculate=function(a){this.effectCode=a.effectCode;this.transformName=a.transformName;this.optionDepth=a.optionDepth;this.optionDouble=a.optionDouble;this.optionNormalInvert=a.optionNormalInvert;this.optionShadow=a.optionShadow;this.optionShadowSelf=a.optionShadowSelf;this.optionAlpha=a.optionAlpha;this.alphaBase=a.alphaBase;this.alphaRate=a.alphaRate;this.alphaLevel=a.alphaLevel;this.alphaMerge=a.alphaMerge;this.optionColor=a.optionColor;this.colorMin=a.colorMin;this.colorMax=
a.colorMax;this.colorBalance=a.colorBalance;this.colorRate=a.colorRate;this.optionVertex=a.optionVertex;this.vertexColor.assignPower(a.vertexColor);this.optionAmbient=a.optionAmbient;this.ambientColor.assignPower(a.ambientColor);this.ambientShadow=a.ambientShadow;this.optionDiffuse=a.optionDiffuse;this.diffuseColor.assignPower(a.diffuseColor);this.diffuseShadow=a.diffuseShadow;this.optionDiffuseView=a.optionDiffuseView;this.diffuseViewColor.assignPower(a.diffuseViewColor);this.diffuseViewShadow=a.diffuseViewShadow;
this.optionSpecular=a.optionSpecular;this.specularColor.assignPower(a.specularColor);this.specularBase=a.specularBase;this.specularLevel=a.specularLevel;this.specularAverage=a.specularAverage;this.specularShadow=a.specularShadow;this.optionSpecularView=a.optionSpecularView;this.specularViewColor.assignPower(a.specularViewColor);this.specularViewBase=a.specularViewBase;this.specularViewRate=a.specularViewRate;this.specularViewAverage=a.specularViewAverage;this.specularViewShadow=a.specularViewShadow;
this.optionReflect=a.optionReflect;this.reflectColor.assignPower(a.reflectColor);this.reflectMerge=MO.Lang.Float.toRange(a.reflectMerge,0,2);this.reflectShadow=a.reflectShadow;this.optionRefract=a.optionRefract;this.refractFrontColor.assignPower(a.refractFrontColor);this.refractFrontMerge=a.refractFrontMerge;this.refractFrontShadow=a.refractFrontShadow;this.refractBackColor.assignPower(a.refractBackColor);this.refractBackMerge=a.refractBackMerge;this.refractBackShadow=a.refractBackShadow;this.optionOpacity=
a.optionOpacity;this.opacityColor.assignPower(a.opacityColor);this.opacityRate=a.opacityRate;this.opacityAlpha=a.optionAlpha;this.opacityDepth=a.optionDepth;this.opacityTransmittance=a.optionTransmittance;this.optionEmissive=a.optionEmissive;this.emissiveColor.assignPower(a.emissiveColor)};
MO.SG3dMaterialInfo_reset=function(){this.optionDepth=!0;this.optionNormalInvert=this.optionDouble=!1;this.optionShadowSelf=this.optionShadow=!0;this.optionAlpha=!1;this.alphaBase=.2;this.alphaMerge=this.alphaLevel=this.alphaRate=1;this.optionColor=!0;this.colorMin=0;this.colorMax=1;this.colorBalance=.5;this.colorRate=1;this.optionVertex=!0;this.vertexColor.set(1,1,1,1);this.optionAmbient=!0;this.ambientColor.set(.5,.5,.5,1);this.ambientShadow=1;this.optionDiffuse=!0;this.diffuseColor.set(.5,.5,.5,
1);this.diffuseShadow=1;this.optionDiffuseView=!0;this.diffuseViewColor.set(1,1,1,1);this.diffuseViewShadow=1;this.optionSpecular=!0;this.specularColor.set(.5,.5,.5,1);this.specularBase=0;this.specularLevel=16;this.specularShadow=this.specularAverage=1;this.optionSpecularView=!0;this.specularViewColor.set(1,1,1,1);this.specularViewBase=0;this.specularViewRate=16;this.specularViewShadow=this.specularViewAverage=1;this.optionReflect=!0;this.reflectColor.set(1,1,1,1);this.reflectShadow=this.reflectMerge=
1;this.optionRefract=!0;this.refractFrontColor.set(1,1,1,1);this.refractFrontShadow=this.refractFrontMerge=1;this.refractBackColor.set(1,1,1,1);this.refractBackShadow=this.refractBackMerge=1;this.optionOpacity=!0;this.opacityColor.set(1,1,1,1);this.opacityTransmittance=this.opacityDepth=this.opacityAlpha=this.opacityRate=1;this.optionEmissive=!0;this.emissiveColor.set(1,1,1,1)};MO.SG3dRenderableInfo=function(){this.material=this.layout=this.effect=null;this.reset=MO.SG3dRenderableInfo_reset;return this};
MO.SG3dRenderableInfo_reset=function(){this.effect=null;this.layout=MO.Lang.Object.dispose(this.layout)};MO.FG3dAnimation=function(a){a=MO.Class.inherits(this,a,MO.FObject);a._baseTick=0;a._currentTick=0;a._lastTick=0;a._bones=null;a.construct=MO.FG3dAnimation_construct;a.findBone=MO.FG3dAnimation_findBone;a.process=MO.FG3dAnimation_process;a.dispose=MO.FG3dAnimation_dispose;return a};MO.FG3dAnimation_construct=function(){this.__base.FObject.construct.call(this);this._bones=new MO.TObjects};
MO.FG3dAnimation_findBone=function(a){for(var b=this._bones,d=b.count(),e=0;e<d;e++){var f=b.get(e);if(f.boneId()==a)return f}return null};MO.FG3dAnimation_process=function(){var a=MO.Timer.current();0==this._lastTick&&(this._lastTick=a);this._currentTick=(a-this._lastTick+this._baseTick)/1E3;for(var a=this._bones,b=a.count(),d=0;d<b;d++)a.get(d).update(this._currentTick);return!0};MO.FG3dAnimation_dispose=function(){this._bones.dispose();this._bones=null;this.__base.FObject.dispose.call(this)};
MO.FG3dBaseMaterial=function(a){a=MO.Class.inherits(this,a,MO.FObject);a._name=null;a._info=MO.Class.register(a,new MO.AGetter("_info"));a.construct=MO.FG3dBaseMaterial_construct;a.assignInfo=MO.FG3dBaseMaterial_assignInfo;a.assign=MO.FG3dBaseMaterial_assign;a.calculate=MO.FG3dBaseMaterial_calculate;return a};MO.FG3dBaseMaterial_construct=function(){this.__base.FObject.construct.call(this);this._info=new MO.SG3dMaterialInfo};MO.FG3dBaseMaterial_assignInfo=function(a){this._info.assign(a)};
MO.FG3dBaseMaterial_assign=function(a){this._info.assign(a.info())};MO.FG3dBaseMaterial_calculate=function(a){this._info.calculate(a.info())};MO.FG3dBone=function(a){a=MO.Class.inherits(this,a,MO.FObject);a._boneId=0;a._modeId=null;a.update=MO.FG3dBone_update;return a};MO.FG3dBone_update=function(a){};
MO.FG3dCamera=function(a){a=MO.Class.inherits(this,a,MO.FObject);a._matrix=MO.Class.register(a,new MO.AGetter("_matrix"));a._position=MO.Class.register(a,new MO.AGetter("_position"));a._target=null;a._direction=MO.Class.register(a,new MO.AGetter("_direction"));a._directionTarget=null;a._centerFront=.6;a._centerBack=1;a._focalNear=.1;a._focalFar=200;a._frustum=MO.Class.register(a,new MO.AGetter("_frustum"));a._planes=MO.Class.register(a,new MO.AGetter("_planes"));a._viewport=null;a.__axisUp=null;a.__axisX=
null;a.__axisY=null;a.__axisZ=null;a.construct=MO.FG3dCamera_construct;a.setPosition=MO.FG3dCamera_setPosition;a.setDirection=MO.FG3dCamera_setDirection;a.doWalk=MO.FG3dCamera_doWalk;a.doStrafe=MO.FG3dCamera_doStrafe;a.doFly=MO.FG3dCamera_doFly;a.doPitch=MO.FG3dCamera_doPitch;a.doYaw=MO.FG3dCamera_doYaw;a.doRoll=MO.FG3dCamera_doRoll;a.lookAt=MO.FG3dCamera_lookAt;a.update=MO.FG3dCamera_update;a.updateFrustum=MO.FG3dCamera_updateFrustum;a.dispose=MO.FG3dCamera_dispose;return a};
MO.FG3dCamera_construct=function(){this.__base.FObject.construct.call(this);this._matrix=new MO.SMatrix3d;this._position=new MO.SPoint3;this._target=new MO.SPoint3;this._direction=new MO.SVector3;this._directionTarget=new MO.SVector3;this._frustum=new MO.SFrustum;this._planes=new MO.SFrustumPlanes;this._viewport=MO.Class.create(MO.FG3dViewport);this.__axisUp=new MO.SVector3(0,1,0);this.__axisX=new MO.SVector3;this.__axisY=new MO.SVector3;this.__axisZ=new MO.SVector3};
MO.FG3dCamera_setPosition=function(a,b,d){this._position.set(a,b,d)};MO.FG3dCamera_setDirection=function(a,b,d){this._direction.set(a,b,d);this._directionTarget.set(a,b,d)};MO.FG3dCamera_doWalk=function(a){this._position.x+=this._direction.x*a;this._position.z+=this._direction.z*a};MO.FG3dCamera_doStrafe=function(a){this._position.x+=this.__axisY.x*a;this._position.z+=this.__axisY.z*a};MO.FG3dCamera_doFly=function(a){this._position.y+=a};
MO.FG3dCamera_doPitch=function(a){throw new MO.TFatal(o,"Unsupport.");};MO.FG3dCamera_doYaw=function(a){throw new MO.TFatal(o,"Unsupport.");};MO.FG3dCamera_doRoll=function(a){throw new MO.TFatal(o,"Unsupport.");};MO.FG3dCamera_lookAt=function(a,b,d){var e=this._position,f=this._direction;this._target.set(a,b,d);f.set(a-e.x,b-e.y,d-e.z);f.normalize();this._directionTarget.assign(f)};
MO.FG3dCamera_update=function(){var a=this.__axisX,b=this.__axisY,d=this.__axisZ;d.assign(this._direction);d.normalize();this.__axisUp.cross2(a,d);a.normalize();d.cross2(b,a);b.normalize();var e=this._matrix.data();e[0]=a.x;e[1]=b.x;e[2]=d.x;e[3]=0;e[4]=a.y;e[5]=b.y;e[6]=d.y;e[7]=0;e[8]=a.z;e[9]=b.z;e[10]=d.z;e[11]=0;e[12]=-a.dotPoint3(this._position);e[13]=-b.dotPoint3(this._position);e[14]=-d.dotPoint3(this._position);e[15]=1};
MO.FG3dCamera_updateFrustum=function(){var a=MO.Lang.Math.matrix;a.assign(this._matrix);a.append(this._projection.matrix());this._planes.updateVision(a.data())};MO.FG3dCamera_dispose=function(){this._matrix=MO.Lang.Obejct.dispose(this._matrix);this.__base.FObject.dispose.call(this)};
MO.FG3dDirectionalLight=function(a){a=MO.Class.inherits(this,a,MO.FG3dLight);a._camera=MO.Class.register(a,new MO.AGetter("_camera"));a._viewport=MO.Class.register(a,new MO.AGetter("_viewport"));a._direction=MO.Class.register(a,new MO.AGetter("_direction"));a.construct=MO.FG3dDirectionalLight_construct;a.dispose=MO.FG3dDirectionalLight_dispose;return a};
MO.FG3dDirectionalLight_construct=function(){this.__base.FG3dLight.construct.call(this);this._camera=MO.Class.create(MO.FG3dCamera);this._direction=new MO.SVector3};MO.FG3dDirectionalLight_dispose=function(){this._camera=MO.Lang.Object.dispose(this._camera);this.__base.FG3dLight.dispose.call(this)};
MO.FG3dEffect=function(a){a=MO.Class.inherits(this,a,MO.FG3dObject);a._ready=null;a._code=MO.Class.register(a,new MO.AGetter("_code"));a._stateFillCd=MO.EG3dFillMode.Face;a._stateCullCd=MO.EG3dCullMode.Front;a._stateDepth=!0;a._stateDepthCd=MO.EG3dDepthMode.LessEqual;a._stateDepthWrite=!0;a._stateBlend=!0;a._stateBlendSourceCd=MO.EG3dBlendMode.SourceAlpha;a._stateBlendTargetCd=MO.EG3dBlendMode.OneMinusSourceAlpha;a._stateAlphaTest=!1;a._optionShadow=!1;a._optionLightMap=!1;a._optionFog=!1;a._program=
MO.Class.register(a,new MO.AGetter("_program"));a._vertexTemplate=null;a._fragmentTemplate=null;a.setup=MO.Method.empty;a.testReady=MO.FG3dEffect_testReady;a.setParameter=MO.FG3dEffect_setParameter;a.setSampler=MO.FG3dEffect_setSampler;a.drawRenderable=MO.FG3dEffect_drawRenderable;a.drawRenderables=MO.FG3dEffect_drawRenderables;a.drawGroup=MO.FG3dEffect_drawGroup;a.drawRegion=MO.FG3dEffect_drawRegion;a.buildInfo=MO.FG3dEffect_buildInfo;a.loadConfig=MO.FG3dEffect_loadConfig;a.load=MO.FG3dEffect_load;
a.build=MO.FG3dEffect_build;return a};MO.FG3dEffect_testReady=function(){return this._ready};MO.FG3dEffect_setParameter=function(a,b,d){this._program.setParameter(a,b,d)};MO.FG3dEffect_setSampler=function(a,b){this._program.setSampler(a,b)};MO.FG3dEffect_buildInfo=function(a,b){};
MO.FG3dEffect_drawRenderable=function(a,b){var d=this._graphicContext,e=this._program;if(e.hasAttribute())for(var f=e.attributes(),h=f.count(),k=0;k<h;k++){var q=f.value(k);if(q._statusUsed){var w=q._linker,x=b.findVertexBuffer(w);if(!x)throw new MO.TError("Can't find renderable vertex buffer. (linker={1})",w);e.setAttribute(q._name,x,x._formatCd)}}e=b.indexBuffer();d.drawTriangles(e,0,e.count())};
MO.FG3dEffect_drawRenderables=function(a,b,d,e){this._graphicContext.setProgram(this._program);for(var f=0;f<e;f++){var h=b.at(d+f);this.drawRenderable(a,h)}};MO.FG3dEffect_drawGroup=function(a,b,d,e){this.drawRenderables(a,b,d,e)};MO.FG3dEffect_drawRegion=function(a,b,d){for(var e=a.renderables(),f=0;f<d;){for(var h=f,k=d,q=e.at(b+h).materialReference(),w=f;w<d;w++){var x=e.at(b+w).materialReference();if(q!=x){k=w;break}f++}this.drawGroup(a,e,b+h,k-h)}};
MO.FG3dEffect_loadConfig=function(a){var b=this._program=this._graphicContext.createProgram();a=a.nodes();for(var d=a.count(),e=0;e<d;e++){var f=a.get(e);if(f.isName("State")){var h=f.get("name"),k=f.get("value");if("fill_mode"==h)this._stateFillCd=MO.Lang.Enum.parse(MO.EG3dFillMode,k);else if("cull_mode"==h)this._stateCullCd=MO.Lang.Enum.parse(MO.EG3dCullMode,k);else if("depth_mode"==h)this._stateDepth=!0,this._stateDepthCd=MO.Lang.Enum.parse(MO.EG3dDepthMode,k);else if("depth_write"==h)this._stateDepthWrite=
MO.Lang.Boolean.parse(k);else if("blend_mode"==h){if(this._stateBlend=MO.Lang.Boolean.parse(k))this._stateBlendSourceCd=MO.Lang.Enum.parse(MO.EG3dBlendMode,f.get("source")),this._stateBlendTargetCd=MO.Lang.Enum.parse(MO.EG3dBlendMode,f.get("target"))}else"alpha_test"==h&&(this._stateAlphaTest=MO.RBoolean.parse(k))}else if(f.isName("Option"))h=f.get("name"),k=f.get("value"),"shadow"==h?this._optionShadow=MO.Lang.Boolean.parse(k):"lightmap"==h?this._optionLightMap=MO.Lang.Boolean.parse(k):"fog"==h&&
(this._optionFog=MO.Lang.Boolean.parse(k));else if(f.isName("Parameter"))h=MO.Class.create(MO.FG3dProgramParameter),h.loadConfig(f),b.parameters().set(h.name(),h);else if(f.isName("Attribute"))h=MO.Class.create(MO.FG3dProgramAttribute),h.loadConfig(f),b.attributes().set(h.name(),h);else if(f.isName("Sampler"))h=MO.Class.create(MO.FG3dProgramSampler),h.loadConfig(f),b.samplers().set(h.name(),h);else if(f.isName("Source"))if(h=f.get("name"),"vertex"==h)this._vertexSource=f.value();else if("fragment"==
h)this._fragmentSource=f.value();else throw new MO.TError(this,"Unknown source type. (name={1})",h);else throw new MO.TError(this,"Unknown config type. (name={1})",f.name());}(this._vertexTemplate=MO.Class.create(MO.FG3dShaderTemplate)).load(this._vertexSource);(this._fragmentTemplate=MO.Class.create(MO.FG3dShaderTemplate)).load(this._fragmentSource)};
MO.FG3dEffect_build=function(a){var b=this._program,d=b.parameters(),e=d.count(),f=MO.RInstance.get(MO.FTagContext);this.buildInfo(f,a);a=this._vertexTemplate.parse(f);a=MO.Lang.String.formatLines(a);b.upload(MO.EG3dShader.Vertex,a);a=this._fragmentTemplate.parse(f);for(f=0;f<e;f++){var h=d.at(f),k=h.name();(h=h.define())&&(a=a.replace(new RegExp(k,"g"),h))}a=MO.Lang.String.formatLines(a);b.upload(MO.EG3dShader.Fragment,a);b.build();b.link()};
MO.FG3dEffect_load=function(){var a=MO.Console.find(MO.FG3dEffectConsole).loadConfig(this._code);this.loadConfig(a)};
MO.FG3dEffectConsole=function(a){a=MO.Class.inherits(this,a,MO.FConsole);a._scopeCd=MO.EScope.Local;a._configs=null;a._loadEffects=null;a._registerEffects=null;a._templateEffects=null;a._effects=null;a._path=MO.Class.register(a,MO.AGetter("_path"),"/ars/shader/");a._effectInfo=null;a._tagContext=null;a._thread=null;a._interval=300;a.onProcess=MO.FG3dEffectConsole_onProcess;a.construct=MO.FG3dEffectConsole_construct;a.register=MO.FG3dEffectConsole_register;a.unregister=MO.FG3dEffectConsole_unregister;
a.create=MO.FG3dEffectConsole_create;a.buildEffectInfo=MO.FG3dEffectConsole_buildEffectInfo;a.findTemplate=MO.FG3dEffectConsole_findTemplate;a.find=MO.FG3dEffectConsole_find;a.loadConfig=MO.FG3dEffectConsole_loadConfig;return a};MO.FG3dEffectConsole_onProcess=function(){var a=this._loadEffects;for(a.record();a.next();)a.current().processLoad()&&a.removeCurrent()};
MO.FG3dEffectConsole_construct=function(){this.__base.FConsole.construct.call(this);this._configs=new MO.TDictionary;this._loadEffects=new MO.TLooper;this._registerEffects=new MO.TDictionary;this._templateEffects=new MO.TDictionary;this._effects=new MO.TDictionary;this._effectInfo=new MO.SG3dEffectInfo;this._tagContext=MO.Class.create(MO.FTagContext)};MO.FG3dEffectConsole_register=function(a,b){this._registerEffects.set(a,b)};
MO.FG3dEffectConsole_unregister=function(a){this._registerEffects.set(a,null)};MO.FG3dEffectConsole_create=function(a,b){var d=this._registerEffects.get(b);if(!d)throw new MO.TError(this,"Unknown effect type name. (type={1})",d);d=MO.Class.create(d);d.linkGraphicContext(a);d.setup();return d};
MO.FG3dEffectConsole_buildEffectInfo=function(a,b,d,e){a=a.capability();d=d.technique();b.techniqueModeCode=d.activeMode().code();b.optionMerge=e._optionMerge;b.optionMerge&&(b.mergeCount=e.mergeMaxCount(),b.mergeStride=e.mergeStride());d=e.material().info();b.optionNormalInvert=d.optionNormalInvert;b.optionColor=d.optionColor;b.optionAmbient=d.optionAmbient;b.optionDiffuse=d.optionDiffuse;b.optionSpecular=d.optionSpecular;b.optionReflect=d.optionReflect;b.optionRefract=d.optionRefract;b.vertexCount=
e.vertexCount();var f=e.vertexBuffers();d=f.count();for(var h=0;h<d;h++){var k=f.at(h),q=k.code();"normal"==q&&(4==k.stride()?b.optionNormalCompress=!0:b.optionNormalCompress=!1);if(MO.Lang.String.isEmpty(q))throw new MO.TError(this,"Vertex buffer code is empty.");b.attributes.push(q)}if(f=e.textures())for(d=f.count(),h=0;h<d;h++){k=f.name(h);if(MO.Lang.String.isEmpty(k))throw new MO.TError(this,"Texture code is empty.");b.samplers.push(k)}if(d=e.bones())d=d.count(),b.vertexBoneCount=d,a=a.calculateBoneCount(b.vertexBoneCount,
b.vertexCount),d>a&&(d=a),e._boneLimit=d,b.vertexBoneLimit=d};MO.FG3dEffectConsole_findTemplate=function(a,b){var d=this._templateEffects,e=d.get(b);null==e&&(e=this.create(a,b),e.load(),MO.Logger.info(this,"Create effect template. (code={1}, instance={2})",b,e),d.set(b,e));return e};
MO.FG3dEffectConsole_find=function(a,b,d){MO.Class.isClass(a,MO.FGraphicContext)||(a=a.graphicContext());if(!MO.Class.isClass(a,MO.FGraphicContext))throw new MO.TError(this,"Unknown context.");var e=d.material().info().effectCode;MO.Lang.String.isEmpty(e)&&(e="automatic");"skeleton"!=e&&"skeleton.4"!=e||null!=d.bones()||(e="automatic");var f=b.spaceName()+"."+e,h=this.findTemplate(a,f);if(h){var k=this._effectInfo;k.reset();this.buildEffectInfo(a,k,b,d);h.buildInfo(this._tagContext,k);b=f+this._tagContext.code;
d=this._effects;k=d.get(b);k||(k=this.create(a,f),k._flag=b,k.load(),k.build(this._effectInfo),MO.Logger.info(this,"Create effect. (name={1}, instance={2})",e,k));d.set(b,k)}return k};MO.FG3dEffectConsole_loadConfig=function(a){var b=this._configs.get(a);if(b)return b;b=MO.RBrowser.contentPath(this._path+a+".xml");MO.Runtime.isDebug()&&(b+="?"+MO.Lang.Date.format());b=MO.Class.create(MO.FXmlConnection).send(b);this._configs.set(a,b);return b};
MO.FG3dLight=function(a){return a=MO.Class.inherits(this,a,MO.FObject)};MO.FG3dLightMaterial=function(a){return a=MO.Class.inherits(this,a,MO.FG3dBaseMaterial)};MO.FG3dMaterial=function(a){a=MO.Class.inherits(this,a,MO.FG3dBaseMaterial);a._dirty=!0;a._textures=MO.Class.register(a,new MO.AGetter("_textures"));a.setTexture=MO.FG3dMaterial_setTexture;a.update=MO.FG3dMaterial_update;return a};
MO.FG3dMaterial_setTexture=function(a,b){var d=this._textures;d||(d=this._textures=new MO.TDictionary);d.set(a,b)};MO.FG3dMaterial_update=function(){this._dirty=!0};
MO.FG3dMaterialMap=function(a){a=MO.Class.inherits(this,a,MO.FObject,MO.MGraphicObject);a._size=MO.Class.register(a,new MO.AGetter("_size"));a._data=MO.Class.register(a,new MO.AGetter("_data"));a._texture=MO.Class.register(a,new MO.AGetter("_texture"));a._stride=null;a._dirty=!1;a.construct=MO.FG3dMaterialMap_construct;a.setup=MO.FG3dMaterialMap_setup;a.resize=MO.FG3dMaterialMap_resize;a.setUint8=MO.FG3dMaterialMap_setUint8;a.setUint16=MO.FG3dMaterialMap_setUint16;a.setUint32=MO.FG3dMaterialMap_setUint32;
a.setFloat16=MO.FG3dMaterialMap_setFloat16;a.setFloat32=MO.FG3dMaterialMap_setFloat32;a.update=MO.FG3dMaterialMap_update;return a};MO.FG3dMaterialMap_construct=function(){this.__base.FObject.construct.call(this);this._size=new MO.SSize2};MO.FG3dMaterialMap_setup=function(a,b){var d=this._texture=this._graphicContext.createFlatTexture();this.resize(a,b);d.setFilterCd(MO.EG3dSamplerFilter.Nearest,MO.EG3dSamplerFilter.Nearest);d.uploadData(this._data,a,b)};
MO.FG3dMaterialMap_resize=function(a,b){var d=this._size;2048<b?b=4096:1024<b?b=2048:512<b?b=1024:256<b?b=512:128<b?b=256:64<b?b=128:32<b?b=64:16<b&&(b=32);b<d.height&&(b=d.height);if(d.width!=a||d.height!=b)d.set(a,b),this._stride=4*a,this._data=new Uint8Array(4*a*b)};
MO.FG3dMaterialMap_setUint8=function(a,b,d,e,f,h){var k=this._data;a=this._stride*a+(b<<2);d.constructor==MO.SColor4?(e=255*d.red,k[a]!=e&&(this._dirty=!0),k[a++]=e,e=255*d.green,k[a]!=e&&(this._dirty=!0),k[a++]=e,e=255*d.blue,k[a]!=e&&(this._dirty=!0),k[a++]=e,e=255*d.alpha,k[a]!=e&&(this._dirty=!0),k[a++]=e):(k[a++]=d,k[a++]=e,k[a++]=f,k[a++]=h)};
MO.FG3dMaterialMap_setUint16=function(a,b,d,e){var f=this._data;a=this._stride*a+(b<<2);f[a++]=d>>8&255;f[a++]=d&255;f[a++]=e>>8&255;f[a++]=e&255;this._dirty=!0};MO.FG3dMaterialMap_setUint32=function(a,b,d){var e=this._data;a=this._stride*a+(b<<2);e[a++]=d>>24&255;e[a++]=d>>16&255;e[a++]=d>>8&255;e[a++]=d&255;this._dirty=!0};
MO.FG3dMaterialMap_setFloat16=function(a,b,d,e){var f=this._data;a=this._stride*a+(b<<2);parseInt(256*d);f[a++]=parseInt(d)&255;f[a++]=parseInt(256*d)&255;f[a++]=parseInt(e)&255;f[a++]=parseInt(256*e)&255;this._dirty=!0};MO.FG3dMaterialMap_setFloat32=function(a,b,d){var e=this._data;a=this._stride*a+(b<<2);e[a++]=parseInt(.00390625*d)&255;e[a++]=parseInt(d)&255;e[a++]=parseInt(256*d)&255;e[a++]=parseInt(65536*d)&255;this._dirty=!0};
MO.FG3dMaterialMap_update=function(){if(this._dirty){var a=this._size;this._texture.uploadData(this._data,a.width,a.height);this._dirty=!1}};MO.FG3dMaterialTexture=function(a){a=MO.Class.inherits(this,a,MO.FG3dMaterial);a._texture=null;return a};MO.FG3dObject=function(a){a=MO.Class.inherits(this,a,MO.FObject,MO.MGraphicObject);a.setup=MO.FG3dObject_setup;a.dispose=MO.FG3dObject_dispose;return a};MO.FG3dObject_setup=function(){};
MO.FG3dObject_dispose=function(){this.__base.MGraphicObject.dispose.call(this);this.__base.FObject.dispose.call(this)};MO.FG3dOrthoProjection=function(a){a=MO.Class.inherits(this,a,MO.FG3dProjection);a.construct=MO.FG3dOrthoProjection_construct;a.update=MO.FG3dOrthoProjection_update;a.updateFrustum=MO.FG3dOrthoProjection_updateFrustum;a.dispose=MO.FG3dOrthoProjection_dispose;return a};MO.FG3dOrthoProjection_construct=function(){this.__base.FG3dProjection.construct.call(this)};
MO.FG3dOrthoProjection_update=function(){var a=this._size;MO.Lang.Matrix.orthoLH(this._matrix,.5*-a.width,.5*-a.height,a.width,a.height,this._znear,this._zfar)};MO.FG3dOrthoProjection_updateFrustum=function(a){this._znear=a.minZ;this._zfar=a.maxZ;this.update()};MO.FG3dOrthoProjection_dispose=function(){this.__base.FG3dProjection.dispose.call(this)};
MO.FG3dPerspectiveProjection=function(a){a=MO.Class.inherits(this,a,MO.FG3dProjection);a.construct=MO.FG3dPerspectiveProjection_construct;a.update=MO.FG3dPerspectiveProjection_update;a.updateFrustum=MO.FG3dPerspectiveProjection_updateFrustum;a.dispose=MO.FG3dPerspectiveProjection_dispose;return a};MO.FG3dPerspectiveProjection_construct=function(){this.__base.FG3dProjection.construct.call(this)};
MO.FG3dPerspectiveProjection_update=function(){var a=this._size;this._fieldOfView=MO.RConst.DEGREE_RATE*this._angle;MO.Lang.Matrix.perspectiveFieldOfViewLH(this._matrix,this._fieldOfView,a.width/a.height,this._znear,this._zfar)};MO.FG3dPerspectiveProjection_updateFrustum=function(a){this._znear=a.minZ;this._zfar=a.maxZ;this.update()};MO.FG3dPerspectiveProjection_dispose=function(){this.__base.FG3dProjection.dispose.call(this)};MO.FG3dPointLight=function(a){return a=MO.Class.inherits(this,a,MO.FG3dLight)};
MO.FG3dProjection=function(a){a=MO.Class.inherits(this,a,MO.FObject);a._matrix=MO.Class.register(a,new MO.AGetter("_matrix"));a._size=MO.Class.register(a,new MO.AGetter("_size"));a._angle=MO.Class.register(a,new MO.AGetSet("_angle"),60);a._fieldOfView=MO.Class.register(a,new MO.AGetSet("_fieldOfView"),0);a._znear=MO.Class.register(a,new MO.AGetSet("_znear"),.1);a._zfar=MO.Class.register(a,new MO.AGetSet("_zfar"),200);a._zoom=MO.Class.register(a,new MO.AGetSet("_zoom"),1);a.construct=MO.FG3dProjection_construct;
a.distance=MO.FG3dProjection_distance;a.dispose=MO.FG3dProjection_dispose;return a};MO.FG3dProjection_construct=function(){this.__base.FObject.construct.call(this);this._matrix=new MO.SMatrix3d;this._size=new MO.SSize2};MO.FG3dProjection_distance=function(){return this._zfar-this._znear};MO.FG3dProjection_dispose=function(){this._matrix=MO.Lang.Object.dispose(this._matrix);this._size=MO.Lang.Object.dispose(this._size);this.__base.FObject.dispose.call(this)};
MO.FG3dShaderTemplate=function(a){a=MO.Class.inherits(this,a,MO.FTagDocument);a._space="shader";return a};MO.FG3dSpotLight=function(a){return a=MO.Class.inherits(this,a,MO.FG3dLight)};
MO.FG3dTechnique=function(a){a=MO.Class.inherits(this,a,MO.FG3dObject);a._code=MO.Class.register(a,new MO.AGetter("_code"));a._activeMode=MO.Class.register(a,new MO.AGetter("_activeMode"));a._modes=MO.Class.register(a,new MO.AGetter("_modes"));a._passes=MO.Class.register(a,new MO.AGetter("_passes"));a.construct=MO.FG3dTechnique_construct;a.registerMode=MO.FG3dTechnique_registerMode;a.selectMode=MO.FG3dTechnique_selectMode;a.pushPass=MO.FG3dTechnique_pushPass;a.updateRegion=MO.Method.empty;a.clear=
MO.FG3dTechnique_clear;a.clearDepth=MO.FG3dTechnique_clearDepth;a.sortRenderables=MO.FG3dTechnique_sortRenderables;a.drawRegion=MO.FG3dTechnique_drawRegion;a.present=MO.FG3dTechnique_present;return a};MO.FG3dTechnique_construct=function(){this.__base.FG3dObject.construct.call(this);this._modes=new MO.TObjects;this._passes=new MO.TObjects};MO.FG3dTechnique_registerMode=function(a){var b=MO.Class.create(MO.FG3dTechniqueMode);b.setCode(a);this._modes.push(b);return this._activeMode=b};
MO.FG3dTechnique_selectMode=function(a){};MO.FG3dTechnique_pushPass=function(a){a.setTechnique(this);this._passes.push(a)};MO.FG3dTechnique_clear=function(a){var b=this._graphicContext;b.setRenderTarget(null);b.clear(a.red,a.green,a.blue,a.alpha,1)};MO.FG3dTechnique_clearDepth=function(a){null==a&&(a=1);this._graphicContext.clearDepth(a)};MO.FG3dTechnique_sortRenderables=function(a,b){};
MO.FG3dTechnique_drawRegion=function(a){a.setTechnique(this);for(var b=this._passes,d=b.count(),e=0;e<d;e++){var f=b.at(e);a.setTechniquePass(f,e==d-1);f.drawRegion(a)}};MO.FG3dTechnique_present=function(a){this._graphicContext.present()};MO.FG3dTechniqueConsole=function(a){a=MO.Class.inherits(this,a,MO.FConsole);a._scopeCd=MO.EScope.Local;a._techniques=MO.Class.register(a,new MO.AGetter("_techniques"));a.construct=MO.FG3dTechniqueConsole_construct;a.find=MO.FG3dTechniqueConsole_find;return a};
MO.FG3dTechniqueConsole_construct=function(){this.__base.FConsole.construct.call(this);this._techniques=new MO.TDictionary};
MO.FG3dTechniqueConsole_find=function(a,b){MO.Class.isClass(a,MO.FGraphicContext)||(a=a.graphicContext());if(!MO.Class.isClass(a,MO.FGraphicContext))throw new MO.TError(this,"Unknown context.");var d=a.hashCode()+"|"+MO.Class.name(b),e=this._techniques,f=e.get(d);if(!f){f=MO.Class.create(b);f.linkGraphicContext(a);f.setup();for(var h=f.code(),k=f.passes(),q=k.count(),w=0;w<q;w++){var x=k.at(w),y=x.code();x.setFullCode(h+"."+y)}e.set(d,f)}return f};
MO.FG3dTechniqueMode=function(a){a=MO.Class.inherits(this,a,MO.FObject);a._code=MO.Class.register(a,new MO.AGetSet("_code"));return a};
MO.FG3dTechniquePass=function(a){a=MO.Class.inherits(this,a,MO.FG3dObject);a._technique=MO.Class.register(a,new MO.AGetSet("_technique"));a._fullCode=MO.Class.register(a,new MO.AGetSet("_fullCode"));a._code=MO.Class.register(a,new MO.AGetter("_code"));a._index=null;a._finish=!1;a._materialMap=null;a.setup=MO.FG3dTechniquePass_setup;a.activeEffects=MO.FG3dTechniquePass_activeEffects;a.sortRenderables=MO.FG3dTechniquePass_sortRenderables;a.drawBegin=MO.FG3dTechniquePass_drawBegin;a.drawRegion=MO.FG3dTechniquePass_drawRegion;
a.drawEnd=MO.FG3dTechniquePass_drawEnd;return a};MO.FG3dTechniquePass_setup=function(){var a=this._materialMap=MO.Class.create(MO.FG3dMaterialMap);a.linkGraphicContext(this);a.setup(MO.EG3dMaterialMap.Count,32)};
MO.FG3dTechniquePass_sortRenderables=function(a,b){var d=a.material().info(),e=b.material().info();if(d.optionAlpha&&e.optionAlpha){d=a.activeEffect();e=b.activeEffect();if(d==e){var f=a.materialReference(),h=b.materialReference();if(f&&h)return f.hashCode()-h.hashCode()}return d.hashCode()-e.hashCode()}if(d.optionAlpha&&!e.optionAlpha)return 1;if(!d.optionAlpha&&e.optionAlpha)return-1;d=a.activeEffect();e=b.activeEffect();return d==e&&(f=a.materialReference(),h=b.materialReference(),f&&h)?f.hashCode()-
h.hashCode():d.hashCode()-e.hashCode()};MO.FG3dTechniquePass_activeEffects=function(a,b){for(var d=a.spaceName(),e=b.count(),f=0;f<e;f++){var h=b.at(f),k=h.selectInfo(d);k.effect||(k.effect=MO.Console.find(MO.FG3dEffectConsole).find(this._graphicContext,a,h))}};MO.FG3dTechniquePass_drawBegin=function(a){this._technique.clear(a.backgroundColor())};
MO.FG3dTechniquePass_drawRegion=function(a){var b=a.renderables(),d=b.count();if(0!=d){var e=a._statistics;e._frameDrawSort.begin();this.activeEffects(a,b);b.sort(this.sortRenderables);e._frameDrawSort.end();if(this._graphicContext.capability().optionMaterialMap){var f=this._materialMap;f.resize(MO.EG3dMaterialMap.Count,d);for(e=0;e<d;e++){var h=b.get(e);h._materialId=e;h=h.material().info();f.setUint8(e,MO.EG3dMaterialMap.AmbientColor,h.ambientColor);f.setUint8(e,MO.EG3dMaterialMap.DiffuseColor,
h.diffuseColor);f.setUint8(e,MO.EG3dMaterialMap.SpecularColor,h.specularColor);f.setUint8(e,MO.EG3dMaterialMap.ReflectColor,h.reflectColor);f.setUint8(e,MO.EG3dMaterialMap.EmissiveColor,h.emissiveColor)}f.update();a._materialMap=f}for(f=0;f<d;){for(var h=f,k=d,q=b.at(h).activeEffect(),e=f;e<d;e++){var w=b.at(e).activeEffect();if(q!=w){k=e;break}f++}q.drawRegion(a,h,k-h)}}};MO.FG3dTechniquePass_drawEnd=function(a){};
MO.FG3dTrack=function(a){a=MO.Class.inherits(this,a,MO.FObject);a._frames=null;a.construct=MO.FG3dTrack_construct;a.calculate=MO.FG3dTrack_calculate;return a};MO.FG3dTrack_construct=function(){this.__base.FObject.construct.call(this)};MO.FG3dTrack_update=function(a){a=new MO.SG3dFrameInfo;this._trackResource.calculateFrameInfo(a,tick);a.update();this._matrix.assign(this._trackResource.matrixInvert());this._matrix.append(a.matrix);return!0};
MO.FG3dTrack_calculate=function(a){var b=this._frames.count();if(0==b)return!1;0>a&&(a=-a);var d=this._frames.Get(index),e=null,e=index<b-1?this._frames.Get(index+1):this._frames.Get(0);info.tick=a;info.currentFrame=d;info.nextFrame=e;return!0};MO.FG3dViewport=function(a){a=MO.Class.inherits(this,a,MO.FObject);a.left=0;a.top=0;a.width=0;a.height=0;a.set=MO.FG3dViewport_set;return a};MO.FG3dViewport_set=function(a,b,d,e){this.left=a;this.top=b;this.width=d;this.height=e};
MO.REngine3d=function(){this._setuped=!1;this._contexts=null;return this};MO.REngine3d.prototype.onUnload=function(a){this.dispose()};MO.REngine3d.prototype.setup=function(){this._setuped||(this._contexts=new MO.TObjects,MO.Window.lsnsUnload.register(this,this.onUnload),this._setuped=!0)};MO.REngine3d.prototype.contexts=function(){return this._contexts};
MO.REngine3d.prototype.createContext=function(a,b,d){this.setup();a=MO.Class.create(a);d&&(a._optionAlpha=d.alpha,a._optionAntialias=d.antialias);if(!a.linkCanvas(b))return null;this._contexts.push(a);return a};MO.REngine3d.prototype.dispose=function(){var a=this._contexts;if(a){for(var b=a.count(),d=0;d<b;d++)a.at(d).dispose();this._contexts=MO.Lang.Object.dispose(a)}};MO.REngine3d=new MO.REngine3d;MO.Graphic.Context3d=MO.REngine3d;MO.Engine3d=MO.REngine3d;
MO.EG3dAttribute=new function(){this.Position="position";this.Color="color";this.Coord="coord";this.Normal="normal";this.Binormal="binormal";this.Tangent="tangent";this.BoneIndex="bone_index";this.BoneWeight="bone_weight";return this};MO.EG3dAttributeFormat=new function(){this.Unknown=0;this.Float1=1;this.Float2=2;this.Float3=3;this.Float4=4;this.Byte4=5;this.Byte4Normal=6;return this};
MO.EG3dBlendMode=new function(){this.Zero=0;this.One=1;this.SrcColor=2;this.OneMinusSrcColor=3;this.DstColor=4;this.OneMinusDstColor=5;this.SrcAlpha=6;this.OneMinusSrcAlpha=7;this.DstAlpha=8;this.OneMinusDstAlpha=9;this.SrcAlphaSaturate=10;return this};MO.EG3dCullMode=new function(){this.None=0;this.Front=1;this.Back=2;this.Both=3;return this};MO.EG3dDepthMode=new function(){this.None=0;this.Equal=1;this.NotEqual=2;this.Less=3;this.LessEqual=4;this.Greater=5;this.GreaterEqual=6;this.Always=7;return this};
MO.EG3dDrawMode=new function(){this.Unknown=0;this.Points=1;this.Lines=2;this.LineStrip=3;this.LineLoop=4;this.Triangles=5;this.TriangleStrip=6;this.TriangleFan=7;this.Quads=8;this.QuadStrip=9;return this};MO.EG3dFillMode=new function(){this.Unknown=0;this.Point=1;this.Line=2;this.Face=3;return this};MO.EG3dIndexStride=new function(){this.Unknown=0;this.Uint16=1;this.Uint32=2;return this};
MO.EG3dParameterFormat=new function(){this.Unknown=0;this.Float1=1;this.Float2=2;this.Float3=3;this.Float4=4;this.Float3x3=5;this.Float4x3=6;this.Float4x4=7;return this};MO.EG3dSampler=new function(){this.Diffuse="diffuse";this.Alpha="alpha";this.Normal="normal";this.SpecularColor="specular.color";this.SpecularLevel="specular.level";this.Light="light";this.Reflect="reflect";this.Refract="refract";this.Emissive="emissive";this.Height="height";this.Environment="environment";return this};
MO.EG3dSamplerFilter=new function(){this.Unknown=0;this.Nearest=1;this.Linear=2;this.Repeat=3;this.ClampToEdge=4;this.ClampToBorder=5;return this};MO.EG3dShader=new function(){this.Unknown=0;this.Vertex=1;this.Fragment=2;return this};MO.EG3dTexture=new function(){this.Unknown=0;this.Flat2d=1;this.Flat3d=2;this.Cube=3;return this};
MO.SG3dContextCapability=function(){this.shaderVersion=this.version=this.vendor=null;this.optionShaderSource=this.optionIndex32=this.optionMaterialMap=this.optionLayout=this.optionInstance=this.optionDebug=!1;this.mergeCount=0;this.attributeCount=null;this.vertexCount=65536;this.shader=this.samplerCompressRgba=this.samplerCompressRgb=this.samplerSize=this.samplerCount=this.varyingCount=this.fragmentConst=this.vertexConst=null;return this};
MO.SG3dContextCapability.prototype.calculateBoneCount=function(a,b){var d=0,d=a%4,d=0!=d?a+4-d:a,e=(this.vertexConst-16)/4;return d>e?e:d};MO.SG3dContextCapability.prototype.calculateInstanceCount=function(a,b){var d=(this.vertexConst-16)/(4*a+4),e=cl;0<b&&(e=Math.min(d,this.vertexCount/b));64<e&&(e=64);return e};MO.SG3dContextCapability.prototype.dispose=function(){this.shader=null;MO.RObject.free(this)};
MO.SG3dLayoutBuffer=function(){this.formatCd=this.index=this.buffer=this.slot=null;this.dispose=MO.SG3dLayoutBuffer_dispose;return this};MO.SG3dLayoutBuffer_dispose=function(){this.formatCd=this.index=this.buffer=this.slot=null};MO.SG3dLayoutSampler=function(){this.slot=null;this.index=-1;this.texture=null;this.dispose=MO.SG3dLayoutSampler_dispose;return this};MO.SG3dLayoutSampler_dispose=function(){this.slot=null;this.index=-1;this.texture=null};
MO.FG3dBuffer=function(a){a=MO.Class.inherits(this,a,MO.FG3dObject);a._code=MO.Class.register(a,new MO.AGetSet("_code"));a._data=MO.Class.register(a,new MO.AGetSet("_data"));a.isValid=MO.Method.virtual(a,"isValid");a.dispose=MO.FG3dBuffer_dispose;return a};MO.FG3dBuffer_dispose=function(){this._data=null;this.__base.FG3dObject.dispose.call(this)};
MO.FG3dContext=function(a){a=MO.Class.inherits(this,a,MO.FGraphicContext);a._optionAlpha=!0;a._optionAntialias=!1;a._viewportRectangle=MO.Class.register(a,new MO.AGetter("_viewportRectangle"));a._capability=MO.Class.register(a,new MO.AGetter("_capability"));a._statistics=MO.Class.register(a,new MO.AGetter("_statistics"));a._fillModeCd=MO.EG3dFillMode.Face;a._optionDepth=!1;a._optionCull=!1;a._depthModeCd=0;a._cullModeCd=0;a._statusBlend=!1;a._blendSourceCd=0;a._blendTargetCd=0;a._program=null;a._storePrograms=
null;a._storeLayouts=null;a._storeBuffers=null;a._storeTextures=null;a._storeTargets=null;a.construct=MO.FG3dContext_construct;a.linkCanvas=MO.FG3dContext_linkCanvas;a.createObject=MO.FG3dContext_createObject;a.createProgram=MO.Method.virtual(a,"createProgram");a.createLayout=MO.Method.virtual(a,"createLayout");a.createVertexBuffer=MO.Method.virtual(a,"createVertexBuffer");a.createIndexBuffer=MO.Method.virtual(a,"createIndexBuffer");a.createFlatTexture=MO.Method.virtual(a,"createFlatTexture");a.createCubeTexture=
MO.Method.virtual(a,"createCubeTexture");a.createRenderTarget=MO.Method.virtual(a,"createRenderTarget");a.setViewport=MO.Method.virtual(a,"setViewport");a.setFillMode=MO.Method.virtual(a,"setFillMode");a.setDepthMode=MO.Method.virtual(a,"setDepthMode");a.setCullingMode=MO.Method.virtual(a,"setCullingMode");a.setBlendFactors=MO.Method.virtual(a,"setBlendFactors");a.setScissorRectangle=MO.Method.virtual(a,"setScissorRectangle");a.setRenderTarget=MO.Method.virtual(a,"setRenderTarget");a.setProgram=MO.Method.virtual(a,
"setProgram");a.bindVertexBuffer=MO.Method.virtual(a,"bindVertexBuffer");a.bindTexture=MO.Method.virtual(a,"bindTexture");a.prepare=MO.FG3dContext_prepare;a.clear=MO.Method.virtual(a,"clear");a.clearColor=MO.Method.virtual(a,"clearColor");a.clearDepth=MO.Method.virtual(a,"clearDepth");a.drawTriangles=MO.Method.virtual(a,"drawTriangles");a.present=MO.Method.virtual(a,"present");a.dispose=MO.FG3dContext_dispose;return a};
MO.FG3dContext_construct=function(){this.__base.FGraphicContext.construct.call(this);this._viewportRectangle=new MO.SRectangle;this._statistics=MO.Class.create(MO.FG3dStatistics);MO.Console.find(MO.FStatisticsConsole).register("graphic3d.context",this._statistics);this._storePrograms=new MO.TObjects;this._storeLayouts=new MO.TObjects;this._storeBuffers=new MO.TObjects;this._storeTextures=new MO.TObjects;this._storeTargets=new MO.TObjects};
MO.FG3dContext_linkCanvas=function(a){this._size.set(a.width,a.height)};MO.FG3dContext_createObject=function(a){a=MO.Class.create(a);a.linkGraphicContext(this);a.setup();return a};MO.FG3dContext_prepare=function(){this._statistics.resetFrame()};
MO.FG3dContext_dispose=function(){var a=this._storePrograms;if(a){for(var b=a.count(),d=0;d<b;d++)a.at(d).dispose();this._storePrograms=MO.Lang.Object.dispose(a)}if(a=this._storeLayouts){b=a.count();for(d=0;d<b;d++)a.at(d).dispose();this._storeLayouts=MO.Lang.Object.dispose(a)}if(a=this._storeBuffers){b=a.count();for(d=0;d<b;d++)a.at(d).dispose();this._storeBuffers=MO.Lang.Object.dispose(a)}if(a=this._storeTextures){b=a.count();for(d=0;d<b;d++)a.at(d).dispose();this._storeTextures=MO.Lang.Object.dispose(a)}if(a=
this._storeTargets){b=a.count();for(d=0;d<b;d++)a.at(d).dispose();this._storeTargets=MO.Lang.Object.dispose(a)}this._program=null;this._viewportRectangle=MO.Lang.Object.dispose(this._viewportRectangle);this._capability=MO.Lang.Object.dispose(this._capability);this._statistics=MO.Lang.Object.dispose(this._statistics);this._handle=this._handleLayout=this._handleInstance=null;this.__base.FGraphicContext.dispose.call(this)};
MO.FG3dCubeTexture=function(a){a=MO.Class.inherits(this,a,MO.FG3dTexture);a.size=0;a.construct=MO.FG3dTexture_construct;a.upload=MO.Method.virtual(a,"upload");a.update=MO.Method.empty;return a};MO.FG3dTexture_construct=function(){this.__base.FG3dTexture.construct();this._textureCd=MO.EG3dTexture.Cube};
MO.FG3dFlatTexture=function(a){a=MO.Class.inherits(this,a,MO.FG3dTexture);a._optionFlipY=MO.Class.register(a,new MO.AGetSet("_optionFlipY"),!1);a._size=MO.Class.register(a,new MO.AGetter("_size"));a.construct=MO.FG3dFlatTexture_construct;a.uploadData=MO.Method.virtual(a,"uploadData");a.upload=MO.Method.virtual(a,"upload");a.update=MO.Method.empty;return a};MO.FG3dFlatTexture_construct=function(){this.__base.FG3dTexture.construct();this._textureCd=MO.EG3dTexture.Flat2d};
MO.FG3dFragmentShader=function(a){return a=MO.Class.inherits(this,a,MO.FG3dShader)};MO.FG3dIndexBuffer=function(a){a=MO.Class.inherits(this,a,MO.FG3dBuffer);a._strideCd=MO.Class.register(a,new MO.AGetSet("_strideCd"),MO.EG3dIndexStride.Uint16);a._count=MO.Class.register(a,new MO.AGetSet("_count"),0);a._drawModeCd=MO.Class.register(a,new MO.AGetSet("_drawModeCd"),MO.EG3dDrawMode.Triangles);a._lineWidth=MO.Class.register(a,new MO.AGetSet("_lineWidth"),1);a.upload=MO.Method.virtual(a,"upload");return a};
MO.FG3dLayout=function(a){a=MO.Class.inherits(this,a,MO.FG3dObject);a._buffers=MO.Class.register(a,new MO.AGetter("_buffers"));a._samplers=MO.Class.register(a,new MO.AGetter("_samplers"));a.linkBuffers=MO.FG3dLayout_linkBuffers;a.bindBuffers=MO.FG3dLayout_bindBuffers;a.linkSamplers=MO.FG3dLayout_linkSamplers;a.bindSamplers=MO.FG3dLayout_bindSamplers;a.unbindSamplers=MO.FG3dLayout_unbindSamplers;a.dispose=MO.FG3dLayout_dispose;return a};MO.FG3dLayout_construct=function(){this.__base.FG3dObject.construct.call(this)};
MO.FG3dLayout_linkBuffers=function(a){if(!a.isEmpty()){var b=this._buffers;b||(b=this._buffers=new MO.TObjects);b.assign(a)}};MO.FG3dLayout_bindBuffers=function(){var a=this._graphicContext,b=this._buffers;if(b)for(var d=b.count(),e=0;e<d;e++){var f=b.at(e);a.bindVertexBuffer(f.slot,f.buffer,f.index,f.formatCd)}};MO.FG3dLayout_linkSamplers=function(a){if(!a.isEmpty()){var b=this._samplers;b||(b=this._samplers=new MO.TObjects);b.assign(a)}};
MO.FG3dLayout_bindSamplers=function(){var a=this._graphicContext,b=this._samplers;if(b)for(var d=b.count(),e=0;e<d;e++){var f=b.at(e);a.bindTexture(f.slot,f.index,f.texture)}};MO.FG3dLayout_unbindSamplers=function(){var a=this._graphicContext,b=this._samplers;if(b)for(var d=b.count(),e=0;e<d;e++){var f=b.at(e);a.bindTexture(f.slot,f.index,null)}};MO.FG3dLayout_dispose=function(){this._buffers=MO.Lang.Object.dispose(this._buffers);this._samplers=MO.Lang.Object.dispose(this._samplers);this.__base.FG3dObject.dispose.call(this)};
MO.FG3dProgram=function(a){a=MO.Class.inherits(this,a,MO.FG3dObject);a._attributes=null;a._parameters=null;a._samplers=null;a._vertexShader=null;a._fragmentShader=null;a.hasAttribute=MO.FG3dProgram_hasAttribute;a.registerAttribute=MO.FG3dProgram_registerAttribute;a.findAttribute=MO.FG3dProgram_findAttribute;a.attributes=MO.FG3dProgram_attributes;a.hasParameter=MO.FG3dProgram_hasParameter;a.registerParameter=MO.FG3dProgram_registerParameter;a.findParameter=MO.FG3dProgram_findParameter;a.parameters=
MO.FG3dProgram_parameters;a.hasSampler=MO.FG3dProgram_hasSampler;a.registerSampler=MO.FG3dProgram_registerSampler;a.findSampler=MO.FG3dProgram_findSampler;a.samplers=MO.FG3dProgram_samplers;a.vertexShader=MO.Method.virtual(a,"vertexShader");a.fragmentShader=MO.Method.virtual(a,"fragmentShader");a.setAttribute=MO.FG3dProgram_setAttribute;a.setParameter=MO.FG3dProgram_setParameter;a.setParameter4=MO.FG3dProgram_setParameter4;a.setSampler=MO.FG3dProgram_setSampler;a.upload=MO.Method.virtual(a,"upload");
a.dispose=MO.FG3dProgram_dispose;return a};MO.FG3dProgram_hasAttribute=function(){var a=this._attributes;return a?!a.isEmpty():!1};MO.FG3dProgram_registerAttribute=function(a){var b=MO.Class.create(MO.FG3dProgramAttribute);b._name=a;this.attributes().set(a,b);return b};MO.FG3dProgram_findAttribute=function(a){return this._attributes?this._attributes.get(a):null};MO.FG3dProgram_attributes=function(){var a=this._attributes;null==a&&(a=this._attributes=new MO.TDictionary);return a};
MO.FG3dProgram_hasParameter=function(){var a=this._parameters;return a?!a.isEmpty():!1};MO.FG3dProgram_registerParameter=function(a,b){var d=MO.Class.create(MO.FG3dProgramParameter);d._name=a;d.formatCd=b;this.parameters().set(a,d);return d};MO.FG3dProgram_findParameter=function(a){return this._parameters?this._parameters.get(a):null};MO.FG3dProgram_parameters=function(){var a=this._parameters;null==a&&(a=this._parameters=new MO.TDictionary);return a};
MO.FG3dProgram_hasSampler=function(){var a=this._samplers;return a?!a.isEmpty():!1};MO.FG3dProgram_registerSampler=function(a){var b=MO.Class.create(MO.FG3dProgramSampler);b._name=a;this.samplers().set(a,b);return b};MO.FG3dProgram_findSampler=function(a){return this._samplers?this._samplers.get(a):null};MO.FG3dProgram_samplers=function(){var a=this._samplers;null==a&&(a=this._samplers=new MO.TDictionary);return a};
MO.FG3dProgram_setAttribute=function(a,b,d){var e=this.findAttribute(a);if(null==e)throw new MO.TError(this,"Bind invalid attribute. (name={1})",a);this._graphicContext.bindVertexBuffer(e._slot,b,0,d)};
MO.FG3dProgram_setParameter=function(a,b,d){var e=this.findParameter(a);if(null==e)throw new MO.TError(this,"Bind invalid parameter. (name={1})",a);var f=null,f=b.constructor;if(f==Float32Array||f==MO.SMatrix3d||f==MO.SPerspectiveMatrix3d)f=b;else if(f==MO.SColor4)f=MO.Lang.TypeArray.float4(),f[0]=b.red,f[1]=b.green,f[2]=b.blue,f[3]=b.alpha;else if(f==MO.SPoint3||f==MO.SVector3)f=MO.Lang.TypeArray.float3(),f[0]=b.x,f[1]=b.y,f[2]=b.z;else if(f==MO.SPoint4||f==MO.SVector4)f=MO.Lang.TypeArray.float4(),
f[0]=b.x,f[1]=b.y,f[2]=b.z,f[3]=b.w;else throw new MO.TError(this,"Bind invalid parameter type. (name={1}, type={2})",a,f);e.attachData(f)&&this._graphicContext.bindConst(null,e._slot,e._formatCd,f,d)};MO.FG3dProgram_setParameter4=function(a,b,d,e,f){var h=MO.Lang.TypeArray.float4();h[0]=b;h[1]=d;h[2]=e;h[3]=f;this.setParameter(a,h,1)};
MO.FG3dProgram_setSampler=function(a,b){var d=this.findSampler(a);if(!d)throw new MO.TError(this,"Bind invalid sampler. (name={1})",a);this._graphicContext.bindTexture(d._slot,d._index,b)};
MO.FG3dProgram_dispose=function(){this._attributes=MO.Lang.Object.dispose(this._attributes,!0);this._parameters=MO.Lang.Object.dispose(this._parameters,!0);this._samplers=MO.Lang.Object.dispose(this._samplers,!0);this._vertexShader=MO.Lang.Object.dispose(this._vertexShader);this._fragmentShader=MO.Lang.Object.dispose(this._fragmentShader);this.__base.FG3dObject.dispose.call(this)};
MO.FG3dProgramAttribute=function(a){a=MO.Class.inherits(this,a,MO.FObject);a._name=MO.Class.register(a,new MO.AGetter("_name"));a._linker=MO.Class.register(a,new MO.AGetter("_linker"));a._statusUsed=MO.Class.register(a,new MO.AGetter("_statusUsed"),!1);a._slot=null;a._index=-1;a._formatCd=MO.Class.register(a,new MO.AGetter("_formatCd"),MO.EG3dAttributeFormat.Unknown);a.loadConfig=MO.FG3dProgramAttribute_loadConfig;a.dispose=MO.FG3dProgramAttribute_dispose;return a};
MO.FG3dProgramAttribute_loadConfig=function(a){this._name=a.get("name");this._linker=a.get("linker");this._formatCd=MO.Lang.Enum.encode(MO.EG3dAttributeFormat,a.get("format"))};MO.FG3dProgramAttribute_dispose=function(){this._slot=null;this.__base.FObject.dispose.call(this)};
MO.FG3dProgramParameter=function(a){a=MO.Class.inherits(this,a,MO.FObject);a._name=MO.Class.register(a,new MO.AGetter("_name"));a._linker=MO.Class.register(a,new MO.AGetter("_linker"));a._formatCd=MO.EG3dParameterFormat.Unknown;a._define=MO.Class.register(a,new MO.AGetter("_define"));a._statusUsed=!1;a._slot=null;a._size=0;a._buffer=null;a._memory=null;a.attachData=MO.FG3dProgramParameter_attachData;a.loadConfig=MO.FG3dProgramParameter_loadConfig;a.dispose=MO.FG3dProgramParameter_dispose;return a};
MO.FG3dProgramParameter_attachData=function(a){var b=!1,b=a.constructor;if(b==MO.SMatrix3d)b=this._memory,b||(b=this._memory=new Float32Array(16)),b=MO.Lang.Float.attach(b,a._data,16);else if(b==Float32Array){var d=a.length,b=this._memory;b||(b=this._memory=new Float32Array(d));b=MO.Lang.Float.attach(b,a,d)}else throw new MO.TError(this,"Unknown data type.");return b};
MO.FG3dProgramParameter_loadConfig=function(a){this._name=a.get("name");this._linker=a.get("linker");this._formatCd=MO.Lang.Enum.encode(MO.EG3dParameterFormat,a.get("format"));this._define=a.get("define")};MO.FG3dProgramParameter_dispose=function(){this._memory=this._slot=null;this.__base.FObject.dispose.call(this)};
MO.FG3dProgramSampler=function(a){a=MO.Class.inherits(this,a,MO.FObject);a._name=MO.Class.register(a,new MO.AGetter("_name"));a._linker=MO.Class.register(a,new MO.AGetter("_linker"));a._statusUsed=!1;a._formatCd=MO.Class.register(a,new MO.AGetter("_formatCd"),MO.EG3dTexture.Flat2d);a._bind=!0;a._slot=-1;a._index=0;a._source=null;a.loadConfig=MO.FG3dProgramSampler_loadConfig;a.dispose=MO.FG3dProgramSampler_dispose;return a};
MO.FG3dProgramSampler_loadConfig=function(a){this._name=a.get("name");this._linker=a.get("linker");this._bind=MO.Lang.Boolean.parse(a.get("bind","Y"));this._formatCd=MO.Lang.Enum.encode(MO.EG3dTexture,a.get("format","Flat2d"))};MO.FG3dProgramSampler_dispose=function(){this._slot=null;this.__base.FObject.dispose.call(this)};
MO.FG3dRenderTarget=function(a){a=MO.Class.inherits(this,a,MO.FG3dObject);a._size=MO.Class.register(a,new MO.AGetter("_size"));a._color=MO.Class.register(a,new MO.AGetter("_color"));a._textures=null;a.construct=MO.FG3dRenderTarget_construct;a.textures=MO.FG3dRenderTarget_textures;a.dispose=MO.FG3dRenderTarget_dispose;return a};MO.FG3dRenderTarget_construct=function(){this.__base.FG3dObject.construct();this._size=new MO.SSize2;this._color=new MO.SColor4;this._color.set(0,0,0,1)};
MO.FG3dRenderTarget_textures=function(){var a=this._textures;a||(a=this._textures=new MO.TObjects);return a};MO.FG3dRenderTarget_dispose=function(){this._size=MO.Lang.Object.dispose(this._size);this._color=MO.Lang.Object.dispose(this._color);this._textures=MO.Lang.Object.dispose(this._textures);this.__base.FG3dObject.dispose.call(this)};
MO.FG3dShader=function(a){a=MO.Class.inherits(this,a,MO.FG3dObject);a._source=MO.Class.register(a,new MO.AGetter("_source"));a.upload=MO.Method.virtual(a,"upload");return a};
MO.FG3dStatistics=function(a){a=MO.Class.inherits(this,a,MO.FStatistics);a._frameClearCount=MO.Class.register(a,new MO.AGetter("_frameClearCount"),0);a._frameFillModeCount=MO.Class.register(a,new MO.AGetter("_frameFillModeCount"),0);a._frameDepthModeCount=MO.Class.register(a,new MO.AGetter("_frameDepthModeCount"),0);a._frameCullModeCount=MO.Class.register(a,new MO.AGetter("_frameCullModeCount"),0);a._frameBlendModeCount=MO.Class.register(a,new MO.AGetter("_frameBlendModeCount"),0);a._frameProgramCount=
MO.Class.register(a,new MO.AGetter("_frameProgramCount"),0);a._frameConstCount=MO.Class.register(a,new MO.AGetter("_frameConstCount"),0);a._frameConstLength=MO.Class.register(a,new MO.AGetter("_frameConstLength"),0);a._frameBufferCount=MO.Class.register(a,new MO.AGetter("_frameBufferCount"),0);a._frameTextureCount=MO.Class.register(a,new MO.AGetter("_frameTextureCount"),0);a._frameTargetCount=MO.Class.register(a,new MO.AGetter("_frameTargetCount"),0);a._frameDrawCount=MO.Class.register(a,new MO.AGetter("_frameDrawCount"),
0);a._frameTriangleCount=MO.Class.register(a,new MO.AGetter("_frameTriangleCount"),0);a._programTotal=MO.Class.register(a,new MO.AGetter("_programTotal"),0);a._layoutTotal=MO.Class.register(a,new MO.AGetter("_layoutTotal"),0);a._vertexBufferTotal=MO.Class.register(a,new MO.AGetter("_vertexBufferTotal"),0);a._indexBufferTotal=MO.Class.register(a,new MO.AGetter("_indexBufferTotal"),0);a._flatTextureTotal=MO.Class.register(a,new MO.AGetter("_flatTextureTotal"),0);a._cubeTextureTotal=MO.Class.register(a,
new MO.AGetter("_cubeTextureTotal"),0);a._targetTotal=MO.Class.register(a,new MO.AGetter("_targetTotal"),0);a.reset=MO.FG3dStatistics_reset;a.resetFrame=MO.FG3dStatistics_resetFrame;return a};MO.FG3dStatistics_reset=function(){o._programTotal=0;o._layoutTotal=0;o._vertexBufferTotal=0;o._indexBufferTotal=0;o._flatTextureTotal=0;o._cubeTextureTotal=0;o._targetTotal=0};
MO.FG3dStatistics_resetFrame=function(){this._frameDrawCount=this._frameTriangleCount=this._frameTargetCount=this._frameTextureCount=this._frameBufferCount=this._frameConstLength=this._frameConstCount=this._frameProgramCount=this._frameBlendModeCount=this._frameCullModeCount=this._frameDepthModeCount=this._frameFillModeCount=this._frameClearCount=0};
MO.FG3dTexture=function(a){a=MO.Class.inherits(this,a,MO.FG3dObject);a._textureCd=MO.Class.register(a,new MO.AGetter("_textureCd"),MO.EG3dTexture.Unknown);a._filterMinCd=MO.Class.register(a,new MO.AGetSet("_filterMinCd"),MO.EG3dSamplerFilter.Linear);a._filterMagCd=MO.Class.register(a,new MO.AGetSet("_filterMagCd"),MO.EG3dSamplerFilter.Linear);a._wrapS=MO.Class.register(a,new MO.AGetSet("_wrapS"),MO.EG3dSamplerFilter.Unknown);a._wrapT=MO.Class.register(a,new MO.AGetSet("_wrapT"),MO.EG3dSamplerFilter.Unknown);
a._statusLoad=!1;a.isValid=MO.Method.virtual(a,"isValid");a.setFilterCd=MO.FG3dTexture_setFilterCd;a.setWrapCd=MO.FG3dTexture_setWrapCd;return a};MO.FG3dTexture_setFilterCd=function(a,b){this._filterMinCd=a;this._filterMagCd=b};MO.FG3dTexture_setWrapCd=function(a,b){this._wrapS=a;this._wrapT=b};
MO.FG3dVertexBuffer=function(a){a=MO.Class.inherits(this,a,MO.FG3dBuffer);a._formatCd=MO.Class.register(a,new MO.AGetSet("_formatCd"),MO.EG3dAttributeFormat.Unknown);a._stride=MO.Class.register(a,new MO.AGetSet("_stride"),0);a._count=MO.Class.register(a,new MO.AGetSet("_count"),0);a.upload=MO.Method.virtual(a,"upload");return a};MO.FG3dVertexShader=function(a){return a=MO.Class.inherits(this,a,MO.FG3dShader)};
MO.FG3dAutomaticEffect=function(a){a=MO.Class.inherits(this,a,MO.FG3dEffect);a._optionMerge=!1;a._optionBlendMode=!0;a._supportInstance=!1;a._supportLayout=!1;a._supportMaterialMap=!1;a._supportVertexColor=!0;a._supportVertexCoord=!0;a._supportVertexNormal=!0;a._supportVertexNormalFull=!0;a._supportVertexNormalCompress=!1;a._supportSkeleton=!1;a._supportAlpha=!0;a._supportAmbient=!0;a._supportDiffuse=!0;a._supportDiffuseView=!0;a._supportSpecularColor=!0;a._supportSpecularLevel=!0;a._supportSpecularView=
!0;a._supportLight=!0;a._supportReflect=!0;a._supportRefract=!0;a._supportEmissive=!0;a._supportHeight=!0;a._supportEnvironment=!0;a._dynamicSkeleton=!0;a.setup=MO.FG3dAutomaticEffect_setup;a.buildInfo=MO.FG3dAutomaticEffect_buildInfo;a.bindAttributes=MO.FG3dAutomaticEffect_bindAttributes;a.bindSamplers=MO.FG3dAutomaticEffect_bindSamplers;a.bindMaterialSamplers=MO.FG3dAutomaticEffect_bindMaterialSamplers;a.bindMaterial=MO.FG3dAutomaticEffect_bindMaterial;a.drawRenderable=MO.FG3dAutomaticEffect_drawRenderable;
return a};MO.FG3dAutomaticEffect_setup=function(){this._supportLayout=this._graphicContext.capability().optionLayout};
MO.FG3dAutomaticEffect_buildInfo=function(a,b){var d=this._graphicContext.capability(),e=new MO.TString;e.append(b.techniqueModeCode);a.set("technique.mode",b.techniqueModeCode);if(this._optionMerge=b.optionMerge){var f=b.mergeCount,h=b.mergeStride;e.append("|OI"+f);a.setBoolean("option.instance",!0);a.set("instance.count",f);a.set("instance.length",h*f)}d.optionMaterialMap&&(e.append("|OM"),a.setBoolean("option.material.map",!0),this._supportMaterialMap=!0);b.optionNormalInvert&&(e.append("|ON"),
a.setBoolean("option.normal.invert",!0),this._supportNormalInvert=!0);b.optionColor&&(e.append("|OC"),a.setBoolean("option.color",!0),this.optionAmbient=!0);b.optionAmbient&&(e.append("|OA"),a.setBoolean("option.ambient",!0),this.optionAmbient=!0);b.optionDiffuse&&(e.append("|OD"),a.setBoolean("option.diffuse",!0),this.optionDiffuse=!0);b.optionSpecular&&(e.append("|OS"),a.setBoolean("option.specular",!0),this.optionSpecular=!0);b.optionReflect&&(e.append("|ORL"),a.setBoolean("option.reflect",!0),
this.optionReflect=!0);b.optionRefract&&(e.append("|ORF"),a.setBoolean("option.refract",!0),this.optionRefract=!0);f=b.attributeContains(MO.EG3dAttribute.Color);if(this._dynamicVertexColor=this._supportVertexColor&&f)e.append("|AC"),a.setBoolean("vertex.attribute.color",!0);f=b.attributeContains(MO.EG3dAttribute.Coord);if(this._dynamicVertexCoord=this._supportVertexCoord&&f)e.append("|AD"),a.setBoolean("vertex.attribute.coord",!0);f=b.attributeContains(MO.EG3dAttribute.Normal);if(this._dynamicVertexNormal=
this._supportVertexNormal&&f)e.append("|AN"),a.setBoolean("vertex.attribute.normal",!0);var h=b.attributeContains(MO.EG3dAttribute.Binormal),k=b.attributeContains(MO.EG3dAttribute.Tangent);if(this._dynamicVertexNormalFull=this._supportVertexNormalFull&&f&&h&&k)e.append("|ANF"),a.setBoolean("vertex.attribute.normal.full",!0);if(this._dynamicVertexNormalCompress=b.optionNormalCompress)e.append("|ANC"),a.setBoolean("vertex.attribute.normal.compress",!0);if(this._dynamicInstance=this._supportInstance&&
d.optionInstance)e.append("|SI"),b&&a.setBoolean("support.instance",!0);if(this._dynamicSkeleton=this._supportSkeleton)e.append("|SS"),b&&a.setBoolean("support.skeleton",!0);f=b.samplerContains(MO.EG3dSampler.Diffuse);(this._dynamicAlpha=this._supportAlpha)?(e.append("|RA"),b&&a.setBoolean("support.alpha",!0),this._optionBlendMode=!0):this._optionBlendMode=!1;if(this._dynamicAmbient=this._supportAmbient)e.append("|TA"),b&&a.setBoolean("support.ambient",!0),f&&(e.append("|TAS"),b&&a.setBoolean("support.ambient.sampler",
!0));b.samplerContains(MO.EG3dSampler.Alpha)&&a.setBoolean("support.alpha.sampler",!0);f=b.samplerContains(MO.EG3dSampler.Normal);this._dynamicDiffuse=this._supportDiffuse&&(this._dynamicVertexNormal||f);this._supportDiffuse&&(b&&a.setBoolean("support.diffuse",!0),f?(e.append("|TDD"),b&&(a.setBoolean("support.dump",!0),a.setBoolean("support.diffuse.dump",!0))):this._dynamicVertexNormal&&(e.append("|TDN"),b&&a.setBoolean("support.diffuse.normal",!0)));this._dynamicDiffuseView=this._supportDiffuseView&&
(this._dynamicVertexNormal||f);this._supportDiffuseView&&(b&&a.setBoolean("support.diffuse.view",!0),f?(e.append("|TDVD"),b&&(a.setBoolean("support.dump",!0),a.setBoolean("support.diffuse.view.dump",!0))):this._dynamicVertexNormal&&(e.append("|TDVN"),b&&a.setBoolean("support.diffuse.view.normal",!0)));f=b.samplerContains(MO.EG3dSampler.SpecularColor);h=b.samplerContains(MO.EG3dSampler.SpecularLevel);this._dynamicSpecularColor=this._supportSpecularColor&&f;this._dynamicSpecularLevel=this._supportSpecularLevel&&
h;(this._dynamicSpecularColor||this._dynamicSpecularLevel)&&this._dynamicVertexNormal&&(e.append("|TS"),b&&a.setBoolean("support.specular",!0),this._dynamicSpecularColor&&(e.append("|TSC"),b&&a.setBoolean("support.specular.color",!0)),this._dynamicSpecularLevel?(e.append("|TSL"),b&&a.setBoolean("support.specular.level",!0)):(e.append("|NSL"),b&&a.setBoolean("support.specular.normal",!0)));(this._dynamicSpecularView=this._supportSpecularView)&&this._dynamicVertexNormal&&(e.append("|TSV"),b&&a.setBoolean("support.specular.view",
!0),this._dynamicSpecularColor&&(e.append("|TSVC"),b&&a.setBoolean("support.specular.view.color",!0)),this._dynamicSpecularLevel?(e.append("|TSVL"),b&&a.setBoolean("support.specular.view.level",!0)):(e.append("|NSVL"),b&&a.setBoolean("support.specular.view.normal",!0)));f=b.samplerContains(MO.EG3dSampler.Light);if(this._dynamicLight=this._supportLight&&f)e.append("|TL"),b&&(a.setBoolean("support.sampler.light",!0),a.setBoolean("support.light",!0));f=b.samplerContains(MO.EG3dSampler.Reflect);if(this._dynamicReflect=
this._supportReflect&&f)e.append("|TRL"),b&&(a.setBoolean("support.sampler.light",!0),a.setBoolean("support.reflect",!0));f=b.samplerContains(MO.EG3dSampler.Refract);if(this._dynamicRefract=this._supportRefract&&f)e.append("|TRF"),b&&(a.setBoolean("support.sampler.light",!0),a.setBoolean("support.refract",!0));f=b.samplerContains(MO.EG3dSampler.Emissive);if(this._dynamicEmissive=this._supportEmissive&&f)e.append("|TLE"),b&&(a.setBoolean("support.sampler.light",!0),a.setBoolean("support.emissive",
!0));f=b.samplerContains(MO.EG3dSampler.Height);if(this._dynamicHeight=this._supportHeight&&f)e.append("|TH"),b&&a.setBoolean("support.height",!0);f=b.samplerContains(MO.EG3dSampler.Environment);if(this._dynamicEnvironment=this._supportEnvironment&&f)e.append("|TE"),b&&a.setBoolean("support.environment",!0);this._dynamicSkeleton&&(d=d.calculateBoneCount(b.vertexBoneCount,b.vertexCount),e.append("|B"+d),a.set("bone.count",d),a.set("bone.array.count",3*d),a.setBoolean("support.bone.weight.1",!0),a.setBoolean("support.bone.weight.2",
!0),a.setBoolean("support.bone.weight.3",!0),a.setBoolean("support.bone.weight.4",!0));a.code=e.flush()};MO.FG3dAutomaticEffect_bindAttributes=function(a){var b=this._program;if(b.hasAttribute())for(var d=b.attributes(),e=d.count(),f=0;f<e;f++){var h=d.at(f);if(h._statusUsed){var k=a.findVertexBuffer(h._linker);b.setAttribute(h._name,k,k._formatCd)}}};
MO.FG3dAutomaticEffect_bindSamplers=function(a){var b=this._program;this._supportMaterialMap&&b.setSampler("fs_material",region.materialMap().texture());if(b.hasSampler())for(var d=b.samplers(),e=d.count(),f=0;f<e;f++){var h=d.at(f);if(h._bind&&h._statusUsed){var k=h.name(),h=h.linker(),h=a.findTexture(h);b.setSampler(k,h.texture())}}};
MO.FG3dAutomaticEffect_bindMaterialSamplers=function(a,b){var d=this._program;if(d.hasSampler())for(var e=d.samplers(),f=e.count(),h=0;h<f;h++){var k=e.at(h);if(k._bind&&k._statusUsed){var q=k.linker(),q=b.findBitmap(q);d.setSampler(k.name(),q.texture())}}};
MO.FG3dAutomaticEffect_bindMaterial=function(a){var b=this._graphicContext;a=a.info();a.optionDepth?b.setDepthMode(this._stateDepth,this._stateDepthCd):b.setDepthMode(!1);a.optionAlpha?b.setBlendFactors(this._stateBlend,this._stateBlendSourceCd,this._stateBlendTargetCd):b.setBlendFactors(!1);a.optionDouble?b.setCullingMode(!1):b.setCullingMode(this._stateDepth,this._stateCullCd)};
MO.FG3dAutomaticEffect_drawRenderable=function(a,b){var d=this._graphicContext,e=b.activeInfo(),f=e.layout;f?(this._supportLayout?f.active():f.bindBuffers(),f.bindSamplers()):(f=e.layout=d.createLayout(),this._supportLayout?(f.bind(),this.bindAttributes(b),f.unbind(),f.active()):(d.recordBegin(),this.bindAttributes(b),d.recordEnd(),f.linkBuffers(d.recordBuffers())),d.recordBegin(),this.bindSamplers(b),d.recordEnd(),f.linkSamplers(d.recordSamplers()));var e=0,h=b.indexBuffers();h&&(e=h.count());if(1<
e)for(var k=b.materials(),q=0;q<e;q++){var w=h.at(q);if(k){var x=k.at(q);x&&this.bindMaterialSamplers(b,x)}d.drawTriangles(w)}else if(1==e)w=h.first(),d.drawTriangles(w);else throw new MO.TError(this,"Index buffer is not found.");this._supportLayout&&f.deactive()};MO.FG3dSelectAutomaticEffect=function(a){a=MO.Class.inherits(this,a,MO.FG3dAutomaticEffect);a._code="select.automatic";a.drawRenderable=MO.FG3dSelectAutomaticEffect_drawRenderable;return a};
MO.FG3dSelectAutomaticEffect_drawRenderable=function(a,b,d){var e=this._graphicContext,f=e.size(),h=this._program,k=a._selectX,q=a._selectY,w=b.material(),x=w.info();this.bindMaterial(w);h.setParameter("vc_model_matrix",b.currentMatrix());h.setParameter("vc_vp_matrix",a.calculate(MO.EG3dRegionParameter.CameraViewProjectionMatrix));h.setParameter4("vc_offset",f.width,f.height,1-k/f.width*2,q/f.height*2-1);a=d+1;h.setParameter4("fc_index",(a&255)/255,(a>>8&255)/255,(a>>16&255)/255,x.alphaBase);this.bindAttributes(b);
this.bindSamplers(b);b=b.indexBuffers();h=b.count();for(a=0;a<h;a++)x=b.at(a),e.drawTriangles(x)};MO.FG3dSelectPass=function(a){a=MO.Class.inherits(this,a,MO.FG3dTechniquePass);a._code="select";a._texture=MO.Class.register(a,new MO.AGetter("_texture"));a._renderTarget=null;a._position=null;a._data=null;a.construct=MO.FG3dSelectPass_construct;a.setup=MO.FG3dSelectPass_setup;a.activeEffects=MO.FG3dSelectPass_activeEffects;a.drawRegion=MO.FG3dSelectPass_drawRegion;return a};
MO.FG3dSelectPass_construct=function(){this.__base.FG3dTechniquePass.construct.call(this);this._data=new Uint8Array(4);this._position=new MO.SPoint2};
MO.FG3dSelectPass_setup=function(){this.__base.FG3dTechniquePass.setup.call(this);var a=this._graphicContext,b=this._texture=a.createFlatTexture();b.setFilterCd(MO.EG3dSamplerFilter.Nearest,MO.EG3dSamplerFilter.Nearest);b.setWrapCd(MO.EG3dSamplerFilter.ClampToEdge,MO.EG3dSamplerFilter.ClampToEdge);a=this._renderTarget=a.createRenderTarget();a.size().set(1,1);a.textures().push(b);a.build()};
MO.FG3dSelectPass_activeEffects=function(a,b){for(var d=a.spaceName(),e=b.count(),f=0;f<e;f++){var h=b.at(f);if(h.optionSelect()){var k=h.selectInfo(d);k.effect||(k.effect=MO.Console.find(MO.FG3dEffectConsole).find(this._graphicContext,a,h))}}};
MO.FG3dSelectPass_drawRegion=function(a){var b=this._graphicContext,d=b.handle();b.setRenderTarget(this._renderTarget);b.clear(0,0,0,0,1,1);var e=a.allRenderables();this.activeEffects(a,e);for(var f=e.count(),h=0;h<f;h++){var k=e.at(h);if(k.optionSelect()){var q=k.activeEffect();b.setProgram(q.program());var w=k.display();w?w._optionFace||q.drawRenderable(a,k,h):q.drawRenderable(a,k,h)}}b.clearDepth(1);for(h=0;h<f;h++)k=e.at(h),k.optionSelect()&&(q=k.activeEffect(),b.setProgram(q.program()),(w=k.display())&&
w._optionFace&&q.drawRenderable(a,k,h));d.readPixels(0,0,1,1,d.RGBA,d.UNSIGNED_BYTE,this._data);a=this._data[0]+(this._data[1]<<8)+(this._data[2]<<16);this._selectRenderable=null;0!=a&&(this._selectRenderable=e.get(a-1))};MO.FG3dSelectSkeletonEffect=function(a){a=MO.Class.inherits(this,a,MO.FG3dAutomaticEffect);a._code="select.automatic";a.drawRenderable=MO.FG3dSelectSkeletonEffect_drawRenderable;return a};
MO.FG3dSelectSkeletonEffect_drawRenderable=function(a,b,d){var e=this._graphicContext,f=e.size(),h=this._program,k=a._selectX,q=a._selectY,w=b.material(),x=w.info();this.bindMaterial(w);h.setParameter("vc_model_matrix",b.currentMatrix());h.setParameter("vc_vp_matrix",a.calculate(MO.EG3dRegionParameter.CameraViewProjectionMatrix));h.setParameter4("vc_offset",f.width,f.height,1-k/f.width*2,q/f.height*2-1);a=d+1;h.setParameter4("fc_index",(a&255)/255,(a>>8&255)/255,(a>>16&255)/255,x.alphaBase);this.bindAttributes(b);
this.bindSamplers(b);e.drawTriangles(b.indexBuffer())};MO.FG3dSelectTechnique=function(a){a=MO.Class.inherits(this,a,MO.FG3dTechnique);a._code="select";a._passSelect=MO.Class.register(a,new MO.AGetter("_passSelect"));a.setup=MO.FG3dSelectTechnique_setup;a.test=MO.FG3dSelectTechnique_test;a.testDynamic=MO.FG3dSelectTechnique_testDynamic;return a};
MO.FG3dSelectTechnique_setup=function(){this.__base.FG3dTechnique.setup.call(this);this.registerMode(MO.EG3dTechniqueMode.Result);var a=this._passSelect=MO.Class.create(MO.FG3dSelectPass);a.linkGraphicContext(this);a.setup();this.pushPass(a)};MO.FG3dSelectTechnique_test=function(a,b,d){a._selectX=b;a._selectY=d;a.setTechnique(this);this.drawRegion(a);return this._passSelect._selectRenderable};
MO.FWglContext=function(a){a=MO.Class.inherits(this,a,MO.FG3dContext);a._handle=MO.Class.register(a,new MO.AGetter("_handle"));a._handleInstance=null;a._handleLayout=null;a._handleSamplerS3tc=null;a._handleDebugShader=null;a._activeRenderTarget=null;a._activeTextureSlot=null;a._parameters=null;a._extensions=null;a._statusRecord=!1;a._recordBuffers=MO.Class.register(a,new MO.AGetter("_recordBuffers"));a._recordSamplers=MO.Class.register(a,new MO.AGetter("_recordSamplers"));a._statusFloatTexture=!1;
a._statusScissor=!1;a._data9=null;a._data16=null;a.construct=MO.FWglContext_construct;a.isValid=MO.FWglContext_isValid;a.linkCanvas=MO.FWglContext_linkCanvas;a.parameter=MO.FWglContext_parameter;a.parameters=MO.FWglContext_parameters;a.extension=MO.FWglContext_extension;a.extensions=MO.FWglContext_extensions;a.enableFloatTexture=MO.FWglContext_enableFloatTexture;a.recordBegin=MO.FWglContext_recordBegin;a.recordEnd=MO.FWglContext_recordEnd;a.createProgram=MO.FWglContext_createProgram;a.createLayout=
MO.FWglContext_createLayout;a.createVertexBuffer=MO.FWglContext_createVertexBuffer;a.createIndexBuffer=MO.FWglContext_createIndexBuffer;a.createFlatTexture=MO.FWglContext_createFlatTexture;a.createCubeTexture=MO.FWglContext_createCubeTexture;a.createRenderTarget=MO.FWglContext_createRenderTarget;a.setViewport=MO.FWglContext_setViewport;a.setFillMode=MO.FWglContext_setFillMode;a.setDepthMode=MO.FWglContext_setDepthMode;a.setCullingMode=MO.FWglContext_setCullingMode;a.setBlendFactors=MO.FWglContext_setBlendFactors;
a.setScissorRectangle=MO.FWglContext_setScissorRectangle;a.setRenderTarget=MO.FWglContext_setRenderTarget;a.setProgram=MO.FWglContext_setProgram;a.bindConst=MO.FWglContext_bindConst;a.bindVertexBuffer=MO.FWglContext_bindVertexBuffer;a.bindTexture=MO.FWglContext_bindTexture;a.clear=MO.FWglContext_clear;a.clearColor=MO.FWglContext_clearColor;a.clearDepth=MO.FWglContext_clearDepth;a.readPixels=MO.FWglContext_readPixels;a.drawTriangles=MO.FWglContext_drawTriangles;a.present=MO.FWglContext_present;a.checkError=
MO.FWglContext_checkError;a.saveConfig=MO.FWglContext_saveConfig;a.dispose=MO.FWglContext_dispose;return a};MO.FWglContext_construct=function(){this.__base.FG3dContext.construct.call(this);this._capability=new MO.SG3dContextCapability;this._data9=new Float32Array(9);this._data16=new Float32Array(16);this._recordBuffers=new MO.TObjects;this._recordSamplers=new MO.TObjects};MO.FWglContext_isValid=function(){return this._handle};
MO.FWglContext_linkCanvas=function(a){this.__base.FG3dContext.linkCanvas.call(this,a);this._hCanvas=a;if(a.getContext){var b={};b.alpha=this._optionAlpha;b.antialias=this._optionAntialias;b.depth=!0;b.stencil=!1;b.premultipliedAlpha=!1;for(var d=null,e=["experimental-webgl2","experimental-webgl","webgl","webkit-3d","moz-webgl"],f=e.length,h=0;h<f&&!(d=a.getContext(e[h],b));h++);if(!d)return MO.Logger.error(this,"Create context3d failure."),d=new MO.SEvent(this),d.code=MO.EGraphicError.UnsupportWebGL,
d.message="Current browser can't support WebGL technique.",MO.Window.processDeviceError(d),d.dispose(),!1;this._handle=d;this._contextAttributes=d.getContextAttributes()}else return d=new MO.SEvent(this),d.code=MO.EGraphicError.UnsupportWebGL,d.message="Canvas can't support WebGL technique.",MO.Window.processDeviceError(d),d.dispose(),!1;d=this._handle;this.setDepthMode(!0,MO.EG3dDepthMode.LessEqual);this.setCullingMode(!0,MO.EG3dCullMode.Front);a=this._capability;a.vendor=d.getParameter(d.VENDOR);
a.version=d.getParameter(d.VERSION);a.shaderVersion=d.getParameter(d.SHADING_LANGUAGE_VERSION);a.attributeCount=d.getParameter(d.MAX_VERTEX_ATTRIBS);a.vertexConst=d.getParameter(d.MAX_VERTEX_UNIFORM_VECTORS);a.varyingCount=d.getParameter(d.MAX_VARYING_VECTORS);a.fragmentConst=d.getParameter(d.MAX_FRAGMENT_UNIFORM_VECTORS);a.samplerCount=d.getParameter(d.MAX_VERTEX_TEXTURE_IMAGE_UNITS);a.samplerSize=d.getParameter(d.MAX_TEXTURE_SIZE);if(b=this._handleInstance=d.getExtension("ANGLE_instanced_arrays"))a.optionInstance=
!0;a.mergeCount=parseInt((a.vertexConst-32)/4);if(b=this._handleLayout=d.getExtension("OES_vertex_array_object"))a.optionLayout=!0;if(b=d.getExtension("OES_element_index_uint"))a.optionIndex32=!0;if(b=this._handleSamplerS3tc=d.getExtension("WEBGL_compressed_texture_s3tc"))a.samplerCompressRgb=b.COMPRESSED_RGB_S3TC_DXT1_EXT,a.samplerCompressRgba=b.COMPRESSED_RGBA_S3TC_DXT5_EXT;b=a.shader={};e=b.vertexPrecision={};d.getShaderPrecisionFormat&&(e.floatLow=d.getShaderPrecisionFormat(d.VERTEX_SHADER,d.LOW_FLOAT),
e.floatMedium=d.getShaderPrecisionFormat(d.VERTEX_SHADER,d.MEDIUM_FLOAT),e.floatHigh=d.getShaderPrecisionFormat(d.VERTEX_SHADER,d.HIGH_FLOAT),e.intLow=d.getShaderPrecisionFormat(d.VERTEX_SHADER,d.LOW_INT),e.intMedium=d.getShaderPrecisionFormat(d.VERTEX_SHADER,d.MEDIUM_INT),e.intHigh=d.getShaderPrecisionFormat(d.VERTEX_SHADER,d.HIGH_INT));b=b.fragmentPrecision={};d.getShaderPrecisionFormat&&(b.floatLow=d.getShaderPrecisionFormat(d.FRAGMENT_SHADER,d.LOW_FLOAT),b.floatMedium=d.getShaderPrecisionFormat(d.FRAGMENT_SHADER,
d.MEDIUM_FLOAT),b.floatHigh=d.getShaderPrecisionFormat(d.FRAGMENT_SHADER,d.HIGH_FLOAT),b.intLow=d.getShaderPrecisionFormat(d.FRAGMENT_SHADER,d.LOW_INT),b.intMedium=d.getShaderPrecisionFormat(d.FRAGMENT_SHADER,d.MEDIUM_INT),b.intHigh=d.getShaderPrecisionFormat(d.FRAGMENT_SHADER,d.HIGH_INT));if(b=this._handleDebugShader=d.getExtension("WEBGL_debug_shaders"))a.optionShaderSource=!0;return!0};MO.FWglContext_parameter=function(a){return this.parameters()[a]};
MO.FWglContext_parameters=function(){var a=this._parameters;if(a)return a;for(var b="ACTIVE_TEXTURE ALIASED_LINE_WIDTH_RANGE ALIASED_POINT_SIZE_RANGE ALPHA_BITS ARRAY_BUFFER_BINDING BLEND BLEND_COLOR BLEND_DST_ALPHA BLEND_DST_RGB BLEND_EQUATION_ALPHA BLEND_EQUATION_RGB BLEND_SRC_ALPHA BLEND_SRC_RGB BLUE_BITS COLOR_CLEAR_VALUE COLOR_WRITEMASK COMPRESSED_TEXTURE_FORMATS CULL_FACE CULL_FACE_MODE CURRENT_PROGRAM DEPTH_BITS DEPTH_CLEAR_VALUE DEPTH_FUNC DEPTH_RANGE DEPTH_TEST DEPTH_WRITEMASK DITHER ELEMENT_ARRAY_BUFFER_BINDING FRAMEBUFFER_BINDING FRONT_FACE GENERATE_MIPMAP_HINT GREEN_BITS IMPLEMENTATION_COLOR_READ_FORMAT IMPLEMENTATION_COLOR_READ_TYPE LINE_WIDTH MAX_COMBINED_TEXTURE_IMAGE_UNITS MAX_CUBE_MAP_TEXTURE_SIZE MAX_FRAGMENT_UNIFORM_VECTORS MAX_RENDERBUFFER_SIZE MAX_TEXTURE_IMAGE_UNITS MAX_TEXTURE_SIZE MAX_VARYING_VECTORS MAX_VERTEX_ATTRIBS MAX_VERTEX_TEXTURE_IMAGE_UNITS MAX_VERTEX_UNIFORM_VECTORS MAX_VIEWPORT_DIMS PACK_ALIGNMENT POLYGON_OFFSET_FACTOR POLYGON_OFFSET_FILL POLYGON_OFFSET_UNITS RED_BITS RENDERBUFFER_BINDING RENDERER SAMPLE_BUFFERS SAMPLE_COVERAGE_INVERT SAMPLE_COVERAGE_VALUE SAMPLES SCISSOR_BOX SCISSOR_TEST SHADING_LANGUAGE_VERSION STENCIL_BACK_FAIL STENCIL_BACK_FUNC STENCIL_BACK_PASS_DEPTH_FAIL STENCIL_BACK_PASS_DEPTH_PASS STENCIL_BACK_REF STENCIL_BACK_VALUE_MASK STENCIL_BACK_WRITEMASK STENCIL_BITS STENCIL_CLEAR_VALUE STENCIL_FAIL STENCIL_FUNC STENCIL_PASS_DEPTH_FAIL STENCIL_PASS_DEPTH_PASS STENCIL_REF STENCIL_TEST STENCIL_VALUE_MASK STENCIL_WRITEMASK SUBPIXEL_BITS TEXTURE_BINDING_2D TEXTURE_BINDING_CUBE_MAP UNPACK_ALIGNMENT UNPACK_COLORSPACE_CONVERSION_WEBGL UNPACK_FLIP_Y_WEBGL UNPACK_PREMULTIPLY_ALPHA_WEBGL VENDOR VERSION VIEWPORT".split(" "),
d=this._handle,e=b.length,a={},f=0;f<e;f++){var h=b[f];a[h]=d.getParameter(d[h])}if(b=d.getExtension("WEBGL_debug_renderer_info"))a.UNMASKED_RENDERER_WEBGL=d.getParameter(b.UNMASKED_RENDERER_WEBGL),a.UNMASKED_VENDOR_WEBGL=d.getParameter(b.UNMASKED_VENDOR_WEBGL);return this._parameters=a};MO.FWglContext_extension=function(a){return this.extensions()[a]};
MO.FWglContext_extensions=function(){var a=this._extensions;if(!a)for(var a=this._extensions={},b=this._handle,d=b.getSupportedExtensions(),e=d.length,f=0;f<e;f++){var h=d[f];a[h]=b.getExtension(h)}return a};MO.FWglContext_enableFloatTexture=function(){if(!this._statusFloatTexture){var a=this._handle.getExtension("OES_texture_float");if(!a)return!1;a=this._handle.getExtension("OES_texture_float_linear");if(!a)return!1;this._statusFloatTexture=!0}return this._statusFloatTexture};
MO.FWglContext_recordBegin=function(){this._recordBuffers.clear();this._recordSamplers.clear();this._statusRecord=!0};MO.FWglContext_recordEnd=function(){this._statusRecord=!1};MO.FWglContext_createProgram=function(){var a=this.createObject(MO.FWglProgram);this._storePrograms.push(a);this._statistics._programTotal++;return a};
MO.FWglContext_createLayout=function(){var a=MO.Class.create(MO.FWglLayout);a.linkGraphicContext(this);this._capability.optionLayout&&a.setup();this._storeLayouts.push(a);this._statistics._layoutTotal++;return a};MO.FWglContext_createVertexBuffer=function(a){a=this.createObject(MO.Runtime.nvl(a,MO.FWglVertexBuffer));a.linkGraphicContext(this);a.setup();this._storeBuffers.push(a);this._statistics._vertexBufferTotal++;return a};
MO.FWglContext_createIndexBuffer=function(a){a=this.createObject(MO.Runtime.nvl(a,MO.FWglIndexBuffer));this._storeBuffers.push(a);this._statistics._indexBufferTotal++;return a};MO.FWglContext_createFlatTexture=function(a){a=this.createObject(MO.Runtime.nvl(a,MO.FWglFlatTexture));this._storeTextures.push(a);this._statistics._flatTextureTotal++;return a};
MO.FWglContext_createCubeTexture=function(a){a=this.createObject(MO.Runtime.nvl(a,MO.FWglCubeTexture));this._storeTextures.push(a);this._statistics._cubeTextureTotal++;return a};MO.FWglContext_createRenderTarget=function(a){a=this.createObject(MO.Runtime.nvl(a,MO.FWglRenderTarget));this._storeTargets.push(a);this._statistics._targetTotal++;return a};MO.FWglContext_setViewport=function(a,b,d,e){this._size.set(d,e);this._viewportRectangle.set(a,b,d,e);this._handle.viewport(a,b,d,e)};
MO.FWglContext_setFillMode=function(a){var b=this._handle;if(this._fillModeCd==a)return!1;this._statistics._frameFillModeCount++;switch(a){case EG3dFillMode.Point:b.polygonMode(b.FRONT_AND_BACK,b.POINT);break;case EG3dFillMode.Line:b.polygonMode(b.FRONT_AND_BACK,b.LINE);break;case EG3dFillMode.Face:b.polygonMode(b.FRONT,b.FILL);break;default:throw new MO.TError("Invalid parameter. (fill_mode={1})",a);}this._fillModeCd=a;return!0};
MO.FWglContext_setDepthMode=function(a,b){var d=this._handle;if(this._optionDepth==a&&this._depthModeCd==b)return!1;this._statistics._frameDepthModeCount++;this._optionDepth!=a&&(a?d.enable(d.DEPTH_TEST):d.disable(d.DEPTH_TEST),this._optionDepth=a);if(a&&this._depthModeCd!=b){var e=MO.RWglUtility.convertDepthMode(d,b);d.depthFunc(e);this._depthModeCd=b}return!0};
MO.FWglContext_setCullingMode=function(a,b){var d=this._handle;if(this._optionCull==a&&this._cullModeCd==b)return!1;this._statistics._frameCullModeCount++;this._optionCull!=a&&(a?d.enable(d.CULL_FACE):d.disable(d.CULL_FACE),this._optionCull=a);if(a&&this._cullModeCd!=b){var e=MO.RWglUtility.convertCullMode(d,b);d.cullFace(e);this._cullModeCd=b}return!0};
MO.FWglContext_setBlendFactors=function(a,b,d){var e=this._handle;if(this._statusBlend==a&&this._blendSourceCd==b&&this._blendTargetCd==d)return!1;this._statistics._frameBlendModeCount++;this._statusBlend!=a&&(a?e.enable(e.BLEND):(e.disable(e.BLEND),this._blendTargetCd=this._blendSourceCd=0),this._statusBlend=a);if(a&&(this._blendSourceCd!=b||this._blendTargetCd!=d)){a=MO.RWglUtility.convertBlendFactors(e,b);var f=MO.RWglUtility.convertBlendFactors(e,d);e.blendFunc(a,f);this._blendSourceCd=b;this._blendTargetCd=
d}return!0};MO.FWglContext_setScissorRectangle=function(a,b,d,e){var f=this._handle,h=0<d&&0<e;this._statusScissor!=h&&(h?f.enable(f.SCISSOR_TEST):f.disable(f.SCISSOR_TEST),this._statusScissor=h);h&&f.scissor(a,b,d,e)};
MO.FWglContext_setRenderTarget=function(a){var b=this._handle;if(this._activeRenderTarget!=a){this._statistics._frameTargetCount++;var d=!0;if(null==a){b.bindFramebuffer(b.FRAMEBUFFER,null);d=this.checkError("glBindFramebuffer","Bind frame buffer. (frame_buffer={1})",null);if(!d)return d;b.viewport(0,0,this._size.width,this._size.height)}else{b.bindFramebuffer(b.FRAMEBUFFER,a._handle);d=this.checkError("glBindFramebuffer","Bind frame buffer. (frame_buffer={1})",a._handle);if(!d)return d;var e=a.size();
b.viewport(0,0,e.width,e.height)}this._activeRenderTarget=a;return d}};MO.FWglContext_setProgram=function(a){var b=this._handle;if(this._program!=a)return this._statistics._frameProgramCount++,a?b.useProgram(a._handle):b.useProgram(null),this._program=a,this.checkError("useProgram","Set program failure. (program={1}, program_native={2})",a,a._handle)};
MO.FWglContext_bindConst=function(a,b,d,e,f){var h=this._handle,k=!0;this._statistics._frameConstCount++;switch(d){case MO.EG3dParameterFormat.Float1:h.uniform1fv(b,e);this._statistics._frameConstLength+=e.byteLength;k=this.checkError("uniform1fv","Bind const data failure. (shader_cd={1}, slot={2}, data={3}, count={4})",a,b,e,f);break;case MO.EG3dParameterFormat.Float2:h.uniform2fv(b,e);this._statistics._frameConstLength+=e.byteLength;k=this.checkError("uniform2fv","Bind const data failure. (shader_cd={1}, slot={2}, data={3}, count={4})",
a,b,e,f);break;case MO.EG3dParameterFormat.Float3:h.uniform3fv(b,e);this._statistics._frameConstLength+=e.byteLength;k=this.checkError("uniform3fv","Bind const data failure. (shader_cd={1}, slot={2}, data={3}, count={4})",a,b,e,f);break;case MO.EG3dParameterFormat.Float4:h.uniform4fv(b,e);this._statistics._frameConstLength+=e.byteLength;k=this.checkError("uniform4fv","Bind const data failure. (shader_cd={1}, slot={2}, data={3}, count={4})",a,b,e,f);break;case MO.EG3dParameterFormat.Float3x3:d=this._data9;
d[0]=e[0];d[1]=e[4];d[2]=e[8];d[3]=e[1];d[4]=e[5];d[5]=e[9];d[6]=e[2];d[7]=e[6];d[8]=e[10];h.uniformMatrix3fv(b,h.FALSE,d);this._statistics._frameConstLength+=d.byteLength;k=this.checkError("uniformMatrix3fv","Bind const matrix3x3 failure. (shader_cd={1}, slot={2}, data={3}, count={4})",a,b,e,f);break;case MO.EG3dParameterFormat.Float4x4:if(e.constructor==Float32Array)d=e;else if(e.writeData)d=this._data16,e.writeData(d,0);else throw new MO.TError("Unknown data type.");h.uniformMatrix4fv(b,h.FALSE,
d);this._statistics._frameConstLength+=d.byteLength;k=this.checkError("uniformMatrix4fv","Bind const matrix4x4 failure. (shader_cd={1}, slot={2}, data={3}, count={4})",a,b,e,f);break;default:throw new MO.TError(this,"Unknown format type. (format_cd={1})",d);}return k};
MO.FWglContext_bindVertexBuffer=function(a,b,d,e){var f=this._handle,h=!0;this._statistics._frameBufferCount++;this._statusRecord&&(h=new MO.SG3dLayoutBuffer,h.slot=a,h.buffer=b,h.index=d,h.formatCd=e,this._recordBuffers.push(h));h=null;null!=b&&(h=b._handle);f.bindBuffer(f.ARRAY_BUFFER,h);h=this.checkError("bindBuffer","Bind buffer. (buffer_id=%d)",h);if(!h)return h;if(b){if(f.enableVertexAttribArray(a),h=this.checkError("enableVertexAttribArray","Enable vertex attribute array. (slot=%d)",a),!h)return h}else return f.disableVertexAttribArray(a),
h=this.checkError("disableVertexAttribArray","Disable vertex attribute array. (slot=%d)",a);b=b._stride;switch(e){case MO.EG3dAttributeFormat.Float1:f.vertexAttribPointer(a,1,f.FLOAT,!1,b,d);break;case MO.EG3dAttributeFormat.Float2:f.vertexAttribPointer(a,2,f.FLOAT,!1,b,d);break;case MO.EG3dAttributeFormat.Float3:f.vertexAttribPointer(a,3,f.FLOAT,!1,b,d);break;case MO.EG3dAttributeFormat.Float4:f.vertexAttribPointer(a,4,f.FLOAT,!1,b,d);break;case MO.EG3dAttributeFormat.Byte4:f.vertexAttribPointer(a,
4,f.UNSIGNED_BYTE,!1,b,d);break;case MO.EG3dAttributeFormat.Byte4Normal:f.vertexAttribPointer(a,4,f.UNSIGNED_BYTE,!0,b,d);break;default:throw new MO.TError(this,"Unknown vertex format. (format_cd=%d)",e);}return h=this.checkError("glVertexAttribPointer","Bind vertex attribute pointer. (slot=%d, format_cd=%d)",a,e)};
MO.FWglContext_bindTexture=function(a,b,d){var e=this._handle,f=!0;this._statistics._frameTextureCount++;this._statusRecord&&(f=new MO.SG3dLayoutSampler,f.slot=a,f.index=b,f.texture=d,this._recordSamplers.push(f));if(this._activeTextureSlot!=a){e.uniform1i(a,b);e.activeTexture(e.TEXTURE0+b);f=this.checkError("activeTexture","Active texture failure. (slot=%d, index=%d)",a,b);if(!f)return f;this._activeTextureSlot=a}if(null==d)return e.bindTexture(e.TEXTURE_2D,null),f=this.checkError("bindTexture",
"Bind texture clear failure. (slot=%d)",a);a=d._handle;switch(d.textureCd()){case MO.EG3dTexture.Flat2d:e.bindTexture(e.TEXTURE_2D,a);f=this.checkError("glBindTexture","Bind flag texture failure. (texture_id=%d)",a);if(!f)break;break;case MO.EG3dTexture.Cube:e.bindTexture(e.TEXTURE_CUBE_MAP,a);f=this.checkError("glBindTexture","Bind cube texture failure. (texture_id=%d)",a);if(!f)break;break;default:throw new MO.TError(this,"Unknown texture type.");}return f};
MO.FWglContext_clear=function(a,b,d,e,f){var h=this._handle;h.clearColor(a,b,d,e);h.clearDepth(f);h.clear(h.COLOR_BUFFER_BIT|h.DEPTH_BUFFER_BIT);this._statistics._frameClearCount++};MO.FWglContext_clearColor=function(a,b,d,e){var f=this._handle;f.clearColor(a,b,d,e);f.clear(f.COLOR_BUFFER_BIT);this._statistics._frameClearCount++};MO.FWglContext_clearDepth=function(a){var b=this._handle;b.clearDepth(a);b.clear(b.DEPTH_BUFFER_BIT);this._statistics._frameClearCount++};
MO.FWglContext_readPixels=function(a,b,d,e){var f=this._handle,h=new Uint8Array(4*d*e);f.readPixels(a,b,d,e,f.RGBA,f.UNSIGNED_BYTE,h);return h};
MO.FWglContext_drawTriangles=function(a,b,d){var e=this._handle,f=!0;null==b&&(b=0);null==d&&(d=a.count());e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,a._handle);f=this.checkError("bindBuffer","Bind element array buffer failure. (index=0x%08X, offset=%d, count=%d, buffer_id)",a,b,d,a._handle);if(!f)return f;var h=a.strideCd(),f=MO.RWglUtility.convertIndexStride(e,h),k=0;switch(h){case MO.EG3dIndexStride.Uint16:k=b<<1;break;case MO.EG3dIndexStride.Uint32:k=b<<2}h=a.drawModeCd();h=MO.RWglUtility.convertDrawMode(e,
h);e.drawElements(h,d,f,k);this._statistics._frameTriangleCount+=d;this._statistics._frameDrawCount++;f=this.checkError("drawElements","Draw triangles failure. (index={1}, offset={2}, count={3})",a,b,d);if(!f)return f;e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null);return f=this.checkError("bindBuffer","Bind element array buffer failure. (index={1}, offset={2}, count={3})",a,b,d)};MO.FWglContext_present=function(){};
MO.FWglContext_checkError=function(a,b,d){if(!this._capability.optionDebug||!MO.Runtime.isDebug())return!0;a=this._handle;b=!1;for(var e=d=null;;){d=a.getError();if(d==a.NO_ERROR){b=!0;break}switch(d){case a.INVALID_OPERATION:e="Invalid operation.";break;case a.INVALID_ENUM:e="Invalid enum.";break;case a.INVALID_VALUE:e="Invalid value.";break;case a.INVALID_FRAMEBUFFER_OPERATION:e="Invalid paramebuffer opeartion.";break;case a.OUT_OF_MEMORY:e="Out of memory.";break;default:e="Unknown"}}b||MO.Logger.fatal(this,
null,"OpenGL check failure. (code={1}, description={2})",d,e);return b};MO.FWglContext_saveConfig=function(a){var b=this.parameters(),d=a.create("Parameters");MO.Lang.Xml.saveObject(d,"Parameter",b);b=this.extensions();a=a.create("Extensions");MO.Lang.Xml.saveObject(a,"Extension",b)};
MO.FWglContext_dispose=function(){this._data16=this._data9=null;this._recordBuffers=MO.Lang.Object.dispose(this._recordBuffers);this._recordSamplers=MO.Lang.Object.dispose(this._recordSamplers);this._handleDebugShader=this._handleSamplerS3tc=this._activeTextureSlot=this._extensions=this._parameters=this._contextAttributes=null;this.__base.FG3dContext.dispose.call(this)};
MO.FWglCubeTexture=function(a){a=MO.Class.inherits(this,a,MO.FG3dCubeTexture);a._handle=null;a.setup=MO.FWglCubeTexture_setup;a.isValid=MO.FWglCubeTexture_isValid;a.makeMipmap=MO.FWglCubeTexture_makeMipmap;a.upload=MO.FWglCubeTexture_upload;a.update=MO.FWglCubeTexture_update;a.dispose=MO.FWglCubeTexture_dispose;return a};MO.FWglCubeTexture_setup=function(){var a=this._graphicContext._handle;this.__base.FG3dCubeTexture.setup.call(this);this._handle=a.createTexture()};MO.FWglCubeTexture_isValid=function(){return this._graphicContext._handle.isTexture(this._handle)};
MO.FWglCubeTexture_makeMipmap=function(){var a=this._graphicContext._handle;a.bindTexture(a.TEXTURE_CUBE_MAP,this._handle);a.generateMipmap(a.TEXTURE_CUBE_MAP)};
MO.FWglCubeTexture_upload=function(a,b,d,e,f,h){var k=this._graphicContext,q=k._handle;q.bindTexture(q.TEXTURE_CUBE_MAP,this._handle);q.texImage2D(q.TEXTURE_CUBE_MAP_POSITIVE_X,0,q.RGB,q.RGB,q.UNSIGNED_BYTE,a.image());q.texImage2D(q.TEXTURE_CUBE_MAP_NEGATIVE_X,0,q.RGB,q.RGB,q.UNSIGNED_BYTE,b.image());q.texImage2D(q.TEXTURE_CUBE_MAP_POSITIVE_Y,0,q.RGB,q.RGB,q.UNSIGNED_BYTE,d.image());q.texImage2D(q.TEXTURE_CUBE_MAP_NEGATIVE_Y,0,q.RGB,q.RGB,q.UNSIGNED_BYTE,e.image());q.texImage2D(q.TEXTURE_CUBE_MAP_POSITIVE_Z,
0,q.RGB,q.RGB,q.UNSIGNED_BYTE,f.image());q.texImage2D(q.TEXTURE_CUBE_MAP_NEGATIVE_Z,0,q.RGB,q.RGB,q.UNSIGNED_BYTE,h.image());this._statusLoad=k.checkError("texImage2D","Upload cube image failure.");this.update()};
MO.FWglCubeTexture_update=function(){this.__base.FG3dCubeTexture.update.call(this);var a=this._graphicContext._handle;a.bindTexture(a.TEXTURE_CUBE_MAP,this._handle);var b=MO.RWglUtility.convertSamplerFilter(a,this._filterMinCd);b&&a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_MIN_FILTER,b);(b=MO.RWglUtility.convertSamplerFilter(a,this._filterMagCd))&&a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_MAG_FILTER,b)};
MO.FWglCubeTexture_dispose=function(){var a=this._graphicContext,b=this._handle;b&&(a._handle.deleteTexture(b),this._handle=null);this.__base.FG3dCubeTexture.dispose.call(this)};
MO.FWglFlatTexture=function(a){a=MO.Class.inherits(this,a,MO.FG3dFlatTexture);a._handle=null;a.setup=MO.FWglFlatTexture_setup;a.isValid=MO.FWglFlatTexture_isValid;a.texture=MO.FWglFlatTexture_texture;a.makeMipmap=MO.FWglFlatTexture_makeMipmap;a.uploadData=MO.FWglFlatTexture_uploadData;a.upload=MO.FWglFlatTexture_upload;a.update=MO.FWglFlatTexture_update;a.dispose=MO.FWglFlatTexture_dispose;return a};
MO.FWglFlatTexture_setup=function(){var a=this._graphicContext._handle;this.__base.FG3dFlatTexture.setup.call(this);this._handle=a.createTexture()};MO.FWglFlatTexture_isValid=function(){return this._graphicContext._handle.isTexture(this._handle)};MO.FWglFlatTexture_texture=function(){return this};MO.FWglFlatTexture_makeMipmap=function(){var a=this._graphicContext._handle;a.bindTexture(a.TEXTURE_2D,this._handle);a.generateMipmap(a.TEXTURE_2D)};
MO.FWglFlatTexture_uploadData=function(a,b,d){var e=this._graphicContext,f=e._handle,h=null;if(a.constructor==ArrayBuffer)h=new Uint8Array(a);else if(a.constructor==Uint8Array)h=a;else if(a.constructor==Float32Array){if(!e.enableFloatTexture())throw new MO.TError("Invalid content float format.");h=a}else throw new MO.TError("Invalid content format.");this.width=b;this.height=d;f.bindTexture(f.TEXTURE_2D,this._handle);var k=f.RGBA,q=f.RGBA,w=f.UNSIGNED_BYTE;a.constructor==Float32Array&&(q=k=f.ALPHA,
w=f.FLOAT);f.texImage2D(f.TEXTURE_2D,0,k,b,d,0,q,w,h);this._statusLoad=e.checkError("texImage2D","Upload content failure.");this.update()};
MO.FWglFlatTexture_upload=function(a){var b=this._graphicContext;b.capability();var d=b._handle,e=null,e=a.tagName;if("IMG"==e||"VIDEO"==e||"CANVAS"==e)e=a;else if(MO.Class.isClass(a,MO.FImage))e=a.image();else if(MO.Class.isClass(a,MO.MCanvasObject))e=a.htmlCanvas();else throw new TError("Invalid image format.");d.bindTexture(d.TEXTURE_2D,this._handle);this._optionFlipY&&d.pixelStorei(d.UNPACK_FLIP_Y_WEBGL,!0);d.texImage2D(d.TEXTURE_2D,0,d.RGBA,d.RGBA,d.UNSIGNED_BYTE,e);this.update();this._statusLoad=
b.checkError("texImage2D","Upload image failure.")};
MO.FWglFlatTexture_update=function(){this.__base.FG3dFlatTexture.update.call(this);var a=this._graphicContext._handle;a.bindTexture(a.TEXTURE_2D,this._handle);var b=MO.RWglUtility.convertSamplerFilter(a,this._filterMinCd);b&&a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,b);(b=MO.RWglUtility.convertSamplerFilter(a,this._filterMagCd))&&a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,b);(b=MO.RWglUtility.convertSamplerFilter(a,this._wrapS))&&a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,b);(b=
MO.RWglUtility.convertSamplerFilter(a,this._wrapT))&&a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,b)};MO.FWglFlatTexture_dispose=function(){var a=this._graphicContext,b=this._handle;b&&(a._handle.deleteTexture(b),this._handle=null);this.__base.FG3dFlatTexture.dispose.call(this)};
MO.FWglFragmentShader=function(a){a=MO.Class.inherits(this,a,MO.FG3dFragmentShader);a._handle=null;a.setup=MO.FWglFragmentShader_setup;a.targetSource=MO.FWglFragmentShader_targetSource;a.upload=MO.FWglFragmentShader_upload;a.dispose=MO.FWglFragmentShader_dispose;return a};MO.FWglFragmentShader_setup=function(){this.__base.FG3dFragmentShader.setup.call(this);var a=this._graphicContext._handle;this._handle=a.createShader(a.FRAGMENT_SHADER)};
MO.FWglFragmentShader_targetSource=function(){var a=null,a=this._graphicContext;return a=a.capability().optionShaderSource?a._handleDebugShader.getTranslatedShaderSource(this._handle):this._source};
MO.FWglFragmentShader_upload=function(a){var b=this._graphicContext._handle,d=this._handle;b.shaderSource(d,a);b.compileShader(d);if(!b.getShaderParameter(d,b.COMPILE_STATUS)){var e=b.getShaderInfoLog(d);b.deleteShader(d);this._handle=null;throw new MO.TError(this,"Upload fragment shader source failure. (error={1})\n{2}",e,a);}this._source=a;return!0};MO.FWglFragmentShader_dispose=function(){var a=this._graphicContext,b=this._handle;b&&(a._handle.deleteShader(b),this._handle=null);this.__base.FG3dFragmentShader.dispose.call(this)};
MO.FWglIndexBuffer=function(a){a=MO.Class.inherits(this,a,MO.FG3dIndexBuffer);a._handle=null;a.setup=MO.FWglIndexBuffer_setup;a.isValid=MO.FWglIndexBuffer_isValid;a.upload=MO.FWglIndexBuffer_upload;a.dispose=MO.FWglIndexBuffer_dispose;return a};MO.FWglIndexBuffer_setup=function(){this.__base.FG3dIndexBuffer.setup.call(this);this._handle=this._graphicContext._handle.createBuffer()};MO.FWglIndexBuffer_isValid=function(){return this._graphicContext._handle.isBuffer(this._handle)};
MO.FWglIndexBuffer_upload=function(a,b,d){var e=this._graphicContext,f=e._handle;d&&(this._data=a);this._count=b;d=null;if(a.constructor==Array||a.constructor==ArrayBuffer)if(this._strideCd==MO.EG3dIndexStride.Uint16)d=new Uint16Array(a);else if(this._strideCd==MO.EG3dIndexStride.Uint32)d=new Uint32Array(a);else throw new TError(this,"Index stride is invalid.");else if(a.constructor==Uint16Array){if(this._strideCd!=MO.EG3dIndexStride.Uint16)throw new TError(this,"Index stride16 is invalid.");d=a}else if(a.constructor==
Uint32Array){if(this._strideCd!=MO.EG3dIndexStride.Uint32)throw new TError(this,"Index stride16 is invalid.");d=a}else throw new TError(this,"Upload index data type is invalid. (value={1})",a);f.bindBuffer(f.ELEMENT_ARRAY_BUFFER,this._handle);e.checkError("bindBuffer","Bind buffer failure.");f.bufferData(f.ELEMENT_ARRAY_BUFFER,d,f.STATIC_DRAW);e.checkError("bufferData","Upload buffer data. (count={1})",b)};
MO.FWglIndexBuffer_dispose=function(){var a=this._graphicContext;this._resource=null;var b=this._handle;b&&(a._handle.deleteBuffer(b),this._handle=null);this.__base.FG3dIndexBuffer.dispose.call(this)};MO.FWglLayout=function(a){a=MO.Class.inherits(this,a,MO.FG3dLayout);a._handle=null;a.setup=MO.FWglLayout_setup;a.bind=MO.FWglLayout_bind;a.unbind=MO.FWglLayout_unbind;a.active=MO.FWglLayout_active;a.deactive=MO.FWglLayout_deactive;a.dispose=MO.FWglLayout_dispose;return a};
MO.FWglLayout_setup=function(){this.__base.FG3dLayout.setup.call(this);this._handle=this._graphicContext._handleLayout.createVertexArrayOES()};MO.FWglLayout_bind=function(){this._graphicContext._handleLayout.bindVertexArrayOES(this._handle)};MO.FWglLayout_unbind=function(){this._graphicContext._handleLayout.bindVertexArrayOES(null)};MO.FWglLayout_active=function(){this._graphicContext._handleLayout.bindVertexArrayOES(this._handle)};MO.FWglLayout_deactive=function(){this._graphicContext._handleLayout.bindVertexArrayOES(null)};
MO.FWglLayout_dispose=function(){var a=this._graphicContext,b=this._handle;b&&(a._handleLayout.deleteVertexArrayOES(b),this._handle=null);this.__base.FG3dLayout.dispose.call(this)};
MO.FWglProgram=function(a){a=MO.Class.inherits(this,a,MO.FG3dProgram);a._handle=null;a.setup=MO.FWglProgram_setup;a.vertexShader=MO.FWglProgram_vertexShader;a.fragmentShader=MO.FWglProgram_fragmentShader;a.upload=MO.FWglProgram_upload;a.build=MO.FWglProgram_build;a.link=MO.FWglProgram_link;a.dispose=MO.FWglProgram_dispose;return a};MO.FWglProgram_setup=function(){this._handle=(g=this._graphicContext)._handle.createProgram()};
MO.FWglProgram_vertexShader=function(){var a=this._vertexShader;a||(a=this._vertexShader=MO.Class.create(MO.FWglVertexShader),a.linkGraphicContext(this),a.setup());return a};MO.FWglProgram_fragmentShader=function(){var a=this._fragmentShader;a||(a=this._fragmentShader=MO.Class.create(MO.FWglFragmentShader),a.linkGraphicContext(this),a.setup());return a};
MO.FWglProgram_upload=function(a,b){if(a==MO.EG3dShader.Vertex)this.vertexShader().upload(b);else if(a==MO.EG3dShader.Fragment)this.fragmentShader().upload(b);else throw Error("Unknown type");};
MO.FWglProgram_build=function(){var a=this._graphicContext,b=a._handle,d=this._handle,e=this.vertexShader();b.attachShader(d,e._handle);var f=a.checkError("attachShader","Attach shader failure. (program_id=%d, shader_id=%d)",d,e._handle);if(!f)return f;e=this.fragmentShader();b.attachShader(d,e._handle);f=a.checkError("attachShader","Attach shader failure. (program_id=%d, shader_id=%d)",d,e._handle);if(!f)return f;if(this.hasAttribute())for(var e=this.attributes(),h=e.count(),k=0;k<h;k++)if(f=e.at(k).name(),
b.bindAttribLocation(d,k,f),f=a.checkError("bindAttribLocation","Bind attribute location. (program_id=%d, slot=%d, name=%s)",d,k,f),!f)return f};
MO.FWglProgram_link=function(){var a=this._graphicContext,b=a._handle,d=!1,e=this._handle;b.linkProgram(e);d=b.getProgramParameter(e,b.LINK_STATUS);if(!d)return a=b.getProgramInfoLog(e),MO.Logger.fatal(this,null,"Link program failure. (status={1}, reason={2})",d,a),b.deleteProgram(this._handle),this._handle=null,!1;b.validateProgram(e);(d=b.getProgramParameter(e,b.VALIDATE_STATUS))||b.getProgramInfoLog(e);b.finish();d=a.checkError("finish","Finish program link faliure. (program_id={1})",e);if(!d)return d;
if(this.hasParameter())for(var f=this._parameters.count(),h=0;h<f;h++){var k=this._parameters.at(h),q=b.getUniformLocation(e,k.name()),d=a.checkError("getUniformLocation","Find parameter slot. (program_id=%d, name=%s, slot=%d)",e,k.name(),q);if(!d)return d;k._slot=q;null!=q&&(k._statusUsed=!0)}if(this.hasAttribute())for(f=this._attributes.count(),h=0;h<f;h++){k=this._attributes.at(h);q=b.getAttribLocation(e,k.name());d=a.checkError("getAttribLocation","Find attribute slot. (program_id=%d, name=%s, slot=%d)",
e,k.name(),q);if(!d)return d;k._slot=q;-1!=q&&(k._statusUsed=!0)}if(this.hasSampler()){f=this._samplers.count();for(h=0;h<f;h++){k=this._samplers.at(h);q=b.getUniformLocation(e,k.name());d=a.checkError("getUniformLocation","Find sampler slot. (program_id=%d, name=%s, slot=%d)",e,k.name(),q);if(!d)return d;k._slot=q;null!=q&&(k._statusUsed=!0)}for(h=b=0;h<f;h++)k=this._samplers.value(h),k._statusUsed&&(k._index=b++)}return d};
MO.FWglProgram_dispose=function(){var a=this._graphicContext,b=this._handle;b&&(a._handle.deleteProgram(b),this._handle=null);this.__base.FG3dProgram.dispose.call(this)};MO.FWglRenderTarget=function(a){a=MO.Class.inherits(this,a,MO.FG3dRenderTarget);a._optionDepth=!0;a._handle=null;a._handleDepth=null;a.setup=MO.FWglRenderTarget_setup;a.build=MO.FWglRenderTarget_build;a.dispose=MO.FWglRenderTarget_dispose;return a};
MO.FWglRenderTarget_setup=function(){this.__base.FG3dRenderTarget.setup.call(this);var a=this._graphicContext;this._handle=a._handle.createFramebuffer();return a.checkError("createFramebuffer","Create frame buffer failure.")};
MO.FWglRenderTarget_build=function(){var a=this._size,b=this._graphicContext,d=b._handle;d.bindFramebuffer(d.FRAMEBUFFER,this._handle);var e=b.checkError("bindFramebuffer","Bind frame buffer failure.");if(!e)return e;if(this._optionDepth){var f=this._handleDepth=d.createRenderbuffer(),e=b.checkError("createRenderbuffer","Create render buffer failure.");if(!e)return e;d.bindRenderbuffer(d.RENDERBUFFER,f);e=b.checkError("bindRenderbuffer","Bind render buffer failure.");if(!e)return e;d.renderbufferStorage(d.RENDERBUFFER,
d.DEPTH_COMPONENT16,a.width,a.height);e=b.checkError("renderbufferStorage","Set render buffer storage format failure.");if(!e)return e;d.framebufferRenderbuffer(d.FRAMEBUFFER,d.DEPTH_ATTACHMENT,d.RENDERBUFFER,f);e=b.checkError("framebufferRenderbuffer","Set depth buffer to frame buffer failure. (framebuffer=%d, depthbuffer=%d)",this._handle,f);if(!e)return e}for(var f=this._textures,h=f.count(),k=0;k<h;k++){var q=f.get(k);d.bindTexture(d.TEXTURE_2D,q._handle);d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,
d.LINEAR);d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,d.LINEAR);d.texImage2D(d.TEXTURE_2D,0,d.RGBA,a.width,a.height,0,d.RGBA,d.UNSIGNED_BYTE,null);e=b.checkError("texImage2D","Alloc texture storage. (texture_id, size=%dx%d)",q._handle,a.width,a.height);if(!e)return e;d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0+k,d.TEXTURE_2D,q._handle,0);e=b.checkError("framebufferTexture2D","Set color buffer into frame buffer failure. (framebuffer_id=%d, texture_id=%d)",this._handle,q._handle);
if(!e)return e}d.bindFramebuffer(d.FRAMEBUFFER,null)};MO.FWglRenderTarget_dispose=function(){var a=this._graphicContext,b=this._handleDepth;b&&(a._handle.deleteRenderbuffer(b),this._handleDepth=null);if(b=this._handle)a._handle.deleteFramebuffer(b),this._handle=null;this.__base.FG3dRenderTarget.dispose.call(this)};
MO.FWglVertexBuffer=function(a){a=MO.Class.inherits(this,a,MO.FG3dVertexBuffer);a._handle=null;a.setup=MO.FWglVertexBuffer_setup;a.isValid=MO.FWglVertexBuffer_isValid;a.upload=MO.FWglVertexBuffer_upload;a.dispose=MO.FWglVertexBuffer_dispose;return a};MO.FWglVertexBuffer_setup=function(){this.__base.FG3dVertexBuffer.setup.call(this);this._handle=this._graphicContext._handle.createBuffer()};MO.FWglVertexBuffer_isValid=function(){return this._graphicContext._handle.isBuffer(this._handle)};
MO.FWglVertexBuffer_upload=function(a,b,d,e){var f=this._graphicContext,h=f._handle;e&&(this._data=a);this._stride=b;this._count=d;b=null;if(a.constructor==Array||a.constructor==ArrayBuffer)switch(this._formatCd){case MO.EG3dAttributeFormat.Float1:case MO.EG3dAttributeFormat.Float2:case MO.EG3dAttributeFormat.Float3:case MO.EG3dAttributeFormat.Float4:b=new Float32Array(a);break;case MO.EG3dAttributeFormat.Byte4:case MO.EG3dAttributeFormat.Byte4Normal:b=new Uint8Array(a);break;default:throw new MO.TError(this,
"Unknown data type.");}else if(a.constructor==Uint8Array)b=a;else if(a.constructor==Float32Array)b=a;else throw new MO.TError(this,"Upload vertex data type is invalid. (data={1})",a);h.bindBuffer(h.ARRAY_BUFFER,this._handle);f.checkError("bindBuffer","Bindbuffer");h.bufferData(h.ARRAY_BUFFER,b,h.STATIC_DRAW);f.checkError("bufferData","bufferData")};
MO.FWglVertexBuffer_dispose=function(){var a=this._graphicContext;this._resource=null;var b=this._handle;b&&(a._handle.deleteBuffer(b),this._handle=null);this.__base.FG3dVertexBuffer.dispose.call(this)};MO.FWglVertexShader=function(a){a=MO.Class.inherits(this,a,MO.FG3dVertexShader);a._handle=null;a.setup=MO.FWglVertexShader_setup;a.targetSource=MO.FWglVertexShader_targetSource;a.upload=MO.FWglVertexShader_upload;a.dispose=MO.FWglVertexShader_dispose;return a};
MO.FWglVertexShader_setup=function(){this.__base.FG3dVertexShader.setup.call(this);var a=this._graphicContext._handle;this._handle=a.createShader(a.VERTEX_SHADER)};MO.FWglVertexShader_targetSource=function(){var a=null,a=this._graphicContext;return a=a.capability().optionShaderSource?a._handleDebugShader.getTranslatedShaderSource(this._handle):this._source};
MO.FWglVertexShader_upload=function(a){var b=this._graphicContext._handle,d=this._handle;b.shaderSource(d,a);b.compileShader(d);if(!b.getShaderParameter(d,b.COMPILE_STATUS)){var e=b.getShaderInfoLog(d);b.deleteShader(d);this._handle=null;throw new MO.TError(this,"Upload vertex shader source failure. (error={1})\n{2}",e,a);}this._source=a;return!0};MO.FWglVertexShader_dispose=function(){var a=this._graphicContext,b=this._handle;b&&(a._handle.deleteShader(b),this._handle=null);this.__base.FG3dVertexShader.dispose.call(this)};
MO.RWglUtility=function(){return this};MO.RWglUtility.prototype.convertFillMode=function(a,b){switch(b){case MO.EG3dFillMode.Point:return a.POINT;case MO.EG3dFillMode.Line:return a.LINE;case MO.EG3dFillMode.Face:return a.FILL}throw new TError(this,"Convert fill mode failure. (fill_cd={1})",b);};
MO.RWglUtility.prototype.convertDrawMode=function(a,b){switch(b){case MO.EG3dDrawMode.Point:return a.POINTS;case MO.EG3dDrawMode.Lines:return a.LINES;case MO.EG3dDrawMode.LineStrip:return a.LINE_STRIP;case MO.EG3dDrawMode.LineLoop:return a.LINE_LOOP;case MO.EG3dDrawMode.Triangles:return a.TRIANGLES;case MO.EG3dDrawMode.TriangleStrip:return a.TRIANGLE_STRIP;case MO.EG3dDrawMode.TriangleFan:return a.TRIANGLE_FAN;case MO.EG3dDrawMode.Quads:return a.QUADS;case MO.EG3dDrawMode.QuadStrip:return a.QUAD_STRIP}throw new TError(this,
"Convert draw mode failure. (draw_cd={1})",b);};MO.RWglUtility.prototype.convertCullMode=function(a,b){switch(b){case MO.EG3dCullMode.Front:return a.FRONT;case MO.EG3dCullMode.Back:return a.BACK;case MO.EG3dCullMode.Both:return a.FRONT_AND_BACK}throw new TError(this,"Convert cull mode failure. (cull_cd={1})",b);};
MO.RWglUtility.prototype.convertDepthMode=function(a,b){switch(b){case MO.EG3dDepthMode.Equal:return a.EQUAL;case MO.EG3dDepthMode.NotEqual:return a.NOTEQUAL;case MO.EG3dDepthMode.Less:return a.LESS;case MO.EG3dDepthMode.LessEqual:return a.LEQUAL;case MO.EG3dDepthMode.Greater:return a.GREATER;case MO.EG3dDepthMode.GreaterEqual:return a.GEQUAL;case MO.EG3dDepthMode.Always:return a.ALWAYS}throw new TError(this,"Convert depth mode failure. (depth_cd={1})",b);};
MO.RWglUtility.prototype.convertBlendFactors=function(a,b){switch(b){case MO.EG3dBlendMode.Zero:return a.ZERO;case MO.EG3dBlendMode.One:return a.ONE;case MO.EG3dBlendMode.SrcColor:return a.SRC_COLOR;case MO.EG3dBlendMode.OneMinusSrcColor:return a.ONE_MINUS_SRC_COLOR;case MO.EG3dBlendMode.DstColor:return a.DST_COLOR;case MO.EG3dBlendMode.OneMinusDstColor:return a.ONE_MINUS_DST_COLOR;case MO.EG3dBlendMode.SrcAlpha:return a.SRC_ALPHA;case MO.EG3dBlendMode.OneMinusSrcAlpha:return a.ONE_MINUS_SRC_ALPHA;
case MO.EG3dBlendMode.DstAlpha:return a.DST_ALPHA;case MO.EG3dBlendMode.OneMinusDstAlpha:return a.ONE_MINUS_DST_ALPHA;case MO.EG3dBlendMode.SrcAlphaSaturate:return a.SRC_ALPHA_SATURATE}throw new TError(this,"Convert blend factors failure. (blend_cd={1})",b);};
MO.RWglUtility.prototype.convertIndexStride=function(a,b){switch(b){case MO.EG3dIndexStride.Uint16:return a.UNSIGNED_SHORT;case MO.EG3dIndexStride.Uint32:return a.UNSIGNED_INT}throw new TError(this,"Convert index stride failure. (stride_cd={1})",b);};
MO.RWglUtility.prototype.convertSamplerFilter=function(a,b){switch(b){case MO.EG3dSamplerFilter.Unknown:return 0;case MO.EG3dSamplerFilter.Nearest:return a.NEAREST;case MO.EG3dSamplerFilter.Linear:return a.LINEAR;case MO.EG3dSamplerFilter.Repeat:return a.REPEAT;case MO.EG3dSamplerFilter.ClampToEdge:return a.CLAMP_TO_EDGE;case MO.EG3dSamplerFilter.ClampToBorder:return a.CLAMP_TO_BORDER}throw new TError(this,"Convert sampler filter failure. (filter_cd={1})",b);};MO.RWglUtility=new MO.RWglUtility;
MO.EDisplayTransform=new function(){this.CameraPosition="camera.position";this.CameraDirection="camera.direction";this.BilboardedSphere="bilboarded.sphere";this.BilboardedCylinder="bilboarded.cylinder";return this};MO.EResourceCompress=new function(){this.None="none";this.Deflate="deflate";this.Lzma="lzma";return this};
MO.EStageKey=new function(){this.Forward=MO.EKeyCode.W;this.Back=MO.EKeyCode.S;this.Up=MO.EKeyCode.Q;this.Down=MO.EKeyCode.E;this.RotationLeft=MO.EKeyCode.A;this.RotationRight=MO.EKeyCode.D;this.RotationUp=MO.EKeyCode.Z;this.RotationDown=MO.EKeyCode.X;this.FocusForward=MO.EKeyCode.I;this.FocusBack=MO.EKeyCode.K;this.FocusLeft=MO.EKeyCode.J;this.FocusRight=MO.EKeyCode.L;return this};
MO.MEventDispatcher=function(a){a=MO.Class.inherits(this,a);a.onOperationDown=MO.Method.empty;a.onOperationMove=MO.Method.empty;a.onOperationUp=MO.Method.empty;a.onOperationWheel=MO.Method.empty;a.onOperationKeyDown=MO.Method.empty;a.onOperationKeyPress=MO.Method.empty;a.onOperationKeyUp=MO.Method.empty;a.onOperationResize=MO.Method.empty;a.onOperationVisibility=MO.Method.empty;a.onOperationOrientation=MO.Method.empty;a.dispatcherEvent=MO.MEventDispatcher_dispatcherEvent;return a};
MO.MEventDispatcher_dispatcherEvent=function(a,b){switch(a.code){case MO.EEvent.MouseDown:this.onOperationDown(a);break;case MO.EEvent.MouseMove:this.onOperationMove(a);break;case MO.EEvent.MouseUp:this.onOperationUp(a);break;case MO.EEvent.MouseWheel:this.onOperationWheel(a);break;case MO.EEvent.KeyDown:this.onOperationKeyDown(a);break;case MO.EEvent.KeyPress:this.onOperationKeyPress(a);break;case MO.EEvent.KeyUp:this.onOperationKeyUp(a);break;case MO.EEvent.Resize:this.onOperationResize(a);break;
case MO.EEvent.Visibility:this.onOperationVisibility(a);break;case MO.EEvent.Orientation:this.onOperationOrientation(a);break;default:throw new MO.TError("Unknown event type.");}};MO.MReady=function(a){a=MO.Class.inherits(this,a);a.testReady=MO.Method.virtual(a,"testReady");return a};MO.MRenderableLinker=function(a){a=MO.Class.inherits(this,a);a._renderable=MO.RClass.register(a,new MO.AGetter("_renderable"));a.dispose=MO.MRenderableLinker_dispose;return a};
MO.MRenderableLinker_dispose=function(){this._renderable=null};MO.MResourceData=function(a){a=MO.Class.inherits(this,a);a._ready=!1;a._guid=null;a._index=-1;a._compressData=MO.Class.register(a,new MO.AGetSet("_compressData"));a._data=null;a.testReady=MO.MResourceData_testReady;a.completeData=MO.MResourceData_completeData;a.dispose=MO.MResourceData_dispose;return a};MO.MResourceData_testReady=function(){return this._ready};MO.MResourceData_completeData=function(a){this._data=a;this._ready=!0};
MO.MResourceData_dispose=function(){this._data=this._compressData=null};MO.MTimeline=function(a){return a=MO.Class.inherits(this,a,MO.MTimelineWorker)};MO.MTimelineAction=function(a){return a=MO.Class.inherits(this,a,MO.MTimelineWorker)};
MO.MTimelineActions=function(a){a=MO.Class.inherits(this,a);a._actions=MO.Class.register(a,new MO.AGetter("_actions"));a.construct=MO.MTimelineActions_construct;a.setup=MO.MTimelineActions_setup;a.pushAction=MO.MTimelineActions_pushAction;a.process=MO.MTimelineActions_process;a.dispose=MO.MTimelineActions_dispose;return a};MO.MTimelineActions_construct=function(){this.__base.FObject.construct.call(this);this._actions=new MO.TObjects};MO.MTimelineActions_setup=function(){};
MO.MTimelineActions_pushAction=function(a){this._actions.push(a)};MO.MTimelineActions_process=function(a){for(var b=a.tick,d=this._actions,e=d.count()-1;0<=e;e--){var f=d.at(e),h=b-f.tick;if(!(0>h))if(f.statusStart())if(f.statusStop())d.erase(e),f.dispose();else{var k=f.duration();0!=k&&h>k?f.stop():(a.tick=h,f.process(a))}else f.start()}a.tick=b};MO.MTimelineActions_dispose=function(){this._actions=MO.Lang.Obejct.dispose(this._actions);this.__base.FObject.dispose.call(this)};
MO.MTimelines=function(a){a=MO.Class.inherits(this,a);a._timelines=MO.Class.register(a,new MO.AGetter("_timelines"));a.construct=MO.MTimelines_construct;a.setup=MO.MTimelines_setup;a.pushTimeline=MO.MTimelines_pushTimeline;a.process=MO.MTimelines_process;a.dispose=MO.MTimelines_dispose;return a};MO.MTimelines_construct=function(){this.__base.FObject.construct.call(this);this._timelines=new MO.TObjects};MO.MTimelines_setup=function(){};MO.MTimelines_pushTimeline=function(a){this._timelines.push(a)};
MO.MTimelines_process=function(a){for(var b=a.tick,d=this._timelines,e=d.count()-1;0<=e;e--){var f=d.at(e),h=b-f.tick;if(!(0>h))if(f.statusStart())if(f.statusStop())d.erase(e),f.dispose();else{var k=f.duration();0!=k&&h>k?f.stop():(a.tick=h,f.process(a))}else f.start()}a.tick=b};MO.MTimelines_dispose=function(){this._timelines=MO.Lang.Obejct.dispose(this._timelines);this.__base.FObject.dispose.call(this)};
MO.MTimelineWorker=function(a){a=MO.Class.inherits(this,a);a._code=MO.Class.register(a,new MO.AGetSet("_code"));a._tick=MO.Class.register(a,new MO.AGetSet("_tick"),0);a._duration=MO.Class.register(a,new MO.AGetSet("_duration"),0);a._statusStart=MO.Class.register(a,new MO.AGetter("_statusStart"),!1);a._statusStop=MO.Class.register(a,new MO.AGetter("_statusStop"),!1);a.onStart=MO.MTimelineWorker_onStart;a.onStop=MO.MTimelineWorker_onStop;a.construct=MO.MTimelineWorker_construct;a.setup=MO.MTimelineWorker_setup;
a.start=MO.MTimelineWorker_start;a.process=MO.MTimelineWorker_process;a.stop=MO.MTimelineWorker_stop;a.dispose=MO.MTimelineWorker_dispose;return a};MO.MTimelineWorker_onStart=function(){};MO.MTimelineWorker_onStop=function(){};MO.MTimelineWorker_construct=function(){};MO.MTimelineWorker_setup=function(){this._statusStart=!1};MO.MTimelineWorker_start=function(){this._statusStart||(this.onStart(),this._statusStart=!0);this._statusStop=!1};MO.MTimelineWorker_process=function(){};
MO.MTimelineWorker_stop=function(){this._statusStop||(this.onStop(),this._statusStop=!0)};MO.MTimelineWorker_dispose=function(){};MO.STimelineContext=function(){this._action=this._timeline=this._mainTimeline=null;return this};MO.FCanvas=function(a){a=MO.Class.inherits(this,a,MO.FObject);a._desktop=MO.Class.register(a,new MO.AGetSet("_desktop"));a._activeStage=MO.Class.register(a,new MO.AGetter("_activeStage"));a.construct=MO.FCanvas_construct;a.dispose=MO.FCanvas_dispose;return a};
MO.FCanvas_construct=function(){this.__base.FObject.construct.call(this)};MO.FCanvas_dispose=function(){this._desktop=null;this.__base.FObject.dispose.call(this)};
MO.FDesktop=function(a){a=MO.Class.inherits(this,a,MO.FObject,MO.MEventDispatcher);a._size=MO.Class.register(a,new MO.AGetter("_size"));a._sizeRate=MO.Class.register(a,new MO.AGetter("_sizeRate"),1);a._calculateSize=MO.Class.register(a,new MO.AGetter("_calculateSize"));a._calculateRate=MO.Class.register(a,new MO.AGetter("_calculateRate"));a._logicSize=MO.Class.register(a,new MO.AGetter("_logicSize"));a._logicRate=MO.Class.register(a,new MO.AGetter("_logicRate"));a._screenSize=MO.Class.register(a,
new MO.AGetter("_screenSize"));a._virtualSize=MO.Class.register(a,new MO.AGetter("_virtualSize"));a._canvases=MO.Class.register(a,new MO.AGetter("_canvases"));a.construct=MO.FDesktop_construct;a.canvasRegister=MO.FDesktop_canvasRegister;a.canvasUnregister=MO.FDesktop_canvasUnregister;a.setup=MO.Method.empty;a.build=MO.Method.empty;a.resize=MO.Method.empty;a.processEvent=MO.FDesktop_processEvent;a.process=MO.Method.empty;a.dispose=MO.FDesktop_dispose;return a};
MO.FDesktop_construct=function(){this.__base.FObject.construct.call(this);this._size=new MO.SSize2(1280,720);this._calculateSize=new MO.SSize2(1280,720);this._calculateRate=new MO.SSize2(1,1);this._logicSize=new MO.SSize2(1280,720);this._logicRate=new MO.SSize2(1,1);this._screenSize=new MO.SSize2(1280,720);this._virtualSize=new MO.SSize2(1280,720);this._canvases=new MO.TObjects};MO.FDesktop_canvasRegister=function(a){this._canvases.push(a)};MO.FDesktop_canvasUnregister=function(a){this._canvases.remove(a)};
MO.FDesktop_processEvent=function(a){this.dispatcherEvent(a)};MO.FDesktop_dispose=function(){this._size=MO.Lang.Object.dispose(this._size);this._calculateSize=MO.Lang.Object.dispose(this._calculateSize);this._logicSize=MO.Lang.Object.dispose(this._logicSize);this._logicRate=MO.Lang.Object.dispose(this._logicRate);this._screenSize=MO.Lang.Object.dispose(this._screenSize);this._virtualSize=MO.Lang.Object.dispose(this._virtualSize);this._canvases=MO.Lang.Object.dispose(this._canvases);this.__base.FObject.dispose.call(this)};
MO.FDisplay=function(a){a=MO.Class.inherits(this,a,MO.FComponent,MO.MGraphicObject);a._currentMatrix=MO.Class.register(a,new MO.AGetter("_currentMatrix"));a._matrix=MO.Class.register(a,new MO.AGetter("_matrix"));a._location=MO.Class.register(a,new MO.AGetter("_location"));a._rotation=MO.Class.register(a,new MO.AGetter("_rotation"));a._scale=MO.Class.register(a,new MO.AGetter("_scale"));a._visible=!0;a._renderables=null;a.construct=MO.FDisplay_construct;a.hasRenderable=MO.FDisplay_hasRenderable;a.renderables=
MO.FDisplay_renderables;a.pushRenderable=MO.FDisplay_pushRenderable;a.removeRenderable=MO.FDisplay_removeRenderable;a.clearRenderables=MO.FDisplay_clearRenderables;a.push=MO.FDisplay_push;a.remove=MO.FDisplay_remove;a.filterDisplays=MO.FDisplay_filterDisplays;a.filterRenderables=MO.FDisplay_filterRenderables;a.show=MO.FDisplay_show;a.hide=MO.FDisplay_hide;a.setVisible=MO.FDisplay_setVisible;a.update=MO.FDisplay_update;a.updateMatrix=MO.FDisplay_updateMatrix;a.process=MO.FDisplay_process;a.dispose=
MO.FDisplay_dispose;return a};MO.FDisplay_construct=function(){this.__base.FComponent.construct.call(this);this._currentMatrix=new MO.SMatrix3d;this._matrix=new MO.SMatrix3d;this._location=new MO.SPoint3;this._rotation=new MO.SVector3;this._scale=new MO.SVector3(1,1,1)};MO.FDisplay_hasRenderable=function(){var a=this._renderables;return a?!a.isEmpty():!1};MO.FDisplay_renderables=function(){var a=this._renderables;a||(a=this._renderables=new MO.TObjects);return a};
MO.FDisplay_pushRenderable=function(a){a._display=this;this.renderables().push(a)};MO.FDisplay_removeRenderable=function(a){var b=this._renderables;b&&b.remove(a)};MO.FDisplay_clearRenderables=function(){var a=this._renderables;a&&a.clear()};
MO.FDisplay_push=function(a){if(MO.Class.isClass(a,MO.FRenderable))this.pushRenderable(a);else if(MO.Class.isClass(a,MO.MRenderableLinker))this.pushRenderable(a.renderable());else if(MO.Class.isClass(a,MO.FDisplay))this.pushDisplay(a);else throw new MO.TError(this,"Unknown item type.");};MO.FDisplay_remove=function(){var a=this._parent;a&&(a.removeDisplay(this),this._parent=null)};MO.FDisplay_filterDisplays=function(a){this._visible&&a.push(this)};
MO.FDisplay_filterRenderables=function(a){if(!this._visible)return!1;var b=this._renderables;if(b)for(var d=b.count(),e=0;e<d;e++)b.getAt(e).filterDrawables(a);return!0};MO.FDisplay_show=function(){this.setVisible(!0)};MO.FDisplay_hide=function(){this.setVisible(!1)};MO.FDisplay_setVisible=function(a){this._visible=a};MO.FDisplay_update=function(){var a=this._matrix;a.set(this._location,this._rotation,this._scale);a.update()};
MO.FDisplay_updateMatrix=function(a){this._currentMatrix.assign(this._matrix);(a=this._parent)&&this._currentMatrix.append(a._currentMatrix)};MO.FDisplay_process=function(a){this.updateMatrix(a);var b=this._renderables;if(b)for(var d=b.count(),e=0;e<d;e++)b.at(e).process(a)};
MO.FDisplay_dispose=function(){this._currentMatrix=MO.Lang.Object.dispose(this._currentMatrix);this._matrix=MO.Lang.Object.dispose(this._matrix);this._position=MO.Lang.Object.dispose(this._position);this._direction=MO.Lang.Object.dispose(this._direction);this._scale=MO.Lang.Object.dispose(this._scale);this._renderables=MO.Lang.Object.dispose(this._renderables);this.__base.FComponent.dispose.call(this)};
MO.FDisplayContainer=function(a){a=MO.Class.inherits(this,a,MO.FDisplay);a._displays=null;a.hasDisplay=MO.FDisplayContainer_hasDisplay;a.findDisplay=MO.FDisplayContainer_findDisplay;a.searchDisplay=MO.FDisplayContainer_searchDisplay;a.displays=MO.FDisplayContainer_displays;a.pushDisplay=MO.FDisplayContainer_pushDisplay;a.removeDisplay=MO.FDisplayContainer_removeDisplay;a.filterDisplays=MO.FDisplayContainer_filterDisplays;a.filterRenderables=MO.FDisplayContainer_filterRenderables;a.process=MO.FDisplayContainer_process;
a.dispose=MO.FDisplayContainer_dispose;return a};MO.FDisplayContainer_hasDisplay=function(){var a=this._displays;return a?!a.isEmpty():!1};MO.FDisplayContainer_findDisplay=function(a){var b=this._displays;if(b)for(var d=b.count(),e=0;e<d;e++){var f=b.at(e);if(f.code()==a)return f}return null};MO.FDisplayContainer_searchDisplay=function(a){var b=this._displays;if(b)for(var d=b.count(),e=0;e<d;e++){var f=b.at(e);if(f.isName(a)||(f=f.searchDisplay(a)))return f}return null};
MO.FDisplayContainer_displays=function(){var a=this._displays;a||(a=this._displays=new MO.TObjects);return a};MO.FDisplayContainer_pushDisplay=function(a){a.setParent(this);this.displays().push(a)};MO.FDisplayContainer_removeDisplay=function(a){this.displays().remove(a);a.setParent(null)};MO.FDisplayContainer_filterDisplays=function(a){this.__base.FDisplay.filterDisplays.call(this,a);if(!this._visible)return!1;var b=this._displays;if(b)for(var d=b.count(),e=0;e<d;e++)b.at(e).filterDisplays(a)};
MO.FDisplayContainer_filterRenderables=function(a){this.__base.FDisplay.filterRenderables.call(this,a);if(!this._visible)return!1;var b=this._displays;if(b)for(var d=b.count(),e=0;e<d;e++)b.at(e).filterRenderables(a);return!0};MO.FDisplayContainer_process=function(a){this.__base.FDisplay.process.call(this,a);var b=this._displays;if(b)for(var d=b.count(),e=0;e<d;e++)b.at(e).process(a)};
MO.FDisplayContainer_dispose=function(){var a=this._displays;if(a){for(var b=v.count()-1;0<=b;b--)a.at(b).dispose();this._displays=MO.Lang.Object.dispose(a)}this.__base.FDisplay.dispose.call(this)};
MO.FDisplayLayer=function(a){a=MO.Class.inherits(this,a,MO.FDisplayContainer);a._optionClearDepth=MO.Class.register(a,new MO.AGetSet("_optionClearDepth"),!1);a._statusActive=!1;a._technique=MO.Class.register(a,new MO.AGetSet("_technique"));a._visibleRenderables=MO.Class.register(a,new MO.AGetter("_visibleRenderables"));a.construct=MO.FDisplayLayer_construct;a.selectTechnique=MO.FDisplayLayer_selectTechnique;a.filterRenderables=MO.FDisplayLayer_filterRenderables;a.active=MO.FDisplayLayer_active;a.deactive=
MO.FDisplayLayer_deactive;return a};MO.FDisplayLayer_construct=function(){this.__base.FDisplayContainer.construct.call(this);this._visibleRenderables=new MO.TObjects};MO.FDisplayLayer_selectTechnique=function(a,b){var d=MO.Console.find(MO.FG3dTechniqueConsole).find(a,b);this.selectTechnique(d)};MO.FDisplayLayer_filterRenderables=function(a){this.__base.FDisplayContainer.filterRenderables.call(this,a);this._visibleRenderables.assign(a.renderables())};
MO.FDisplayLayer_active=function(){this._statusActive=!0};MO.FDisplayLayer_deactive=function(){this._statusActive=!1};MO.FDisplayUiLayer=function(a){return a=MO.Class.inherits(this,a,MO.FDisplayLayer)};MO.FDrawable=function(a){a=MO.Class.inherits(this,a,MO.FObject);a._visible=MO.Class.register(a,new MO.AGetSet("_visible"),!0);a.testVisible=MO.FDrawable_testVisible;a.process=MO.Method.empty;return a};MO.FDrawable_testVisible=function(){return this._visible};
MO.FMainTimeline=function(a){a=MO.Class.inherits(this,a,MO.FObject,MO.MListener,MO.MTimelineActions,MO.MTimeline,MO.MTimelines);a._context=null;a._startTick=0;a._lastTick=0;a._interval=0;a.construct=MO.FMainTimeline_construct;a.setup=MO.FMainTimeline_setup;a.start=MO.FMainTimeline_start;a.process=MO.FMainTimeline_process;a.dispose=MO.FMainTimeline_dispose;return a};
MO.FMainTimeline_construct=function(){this.__base.FObject.construct.call(this);this.__base.MTimelineActions.construct.call(this);this._context=new MO.STimelineContext;this._timelines=new MO.TObjects};MO.FMainTimeline_setup=function(){};MO.FMainTimeline_start=function(){};
MO.FMainTimeline_process=function(){var a=MO.Timer.current();if(a-this._lastTick<this._interval)return!1;this._lastTick=a;0==this._startTick&&(this._startTick=a);var b=this._context;b.tick=this._startTick-a;this.__base.MTimelineActions.process.call(this,b);this.__base.MTimelines.process.call(this,b)};MO.FMainTimeline_dispose=function(){this._timelines=MO.Lang.Object.dispose(this._timelines);this._context=MO.Lang.Object.dispose(this._context);this.__base.MTimelineActions.dispose.call(this);this.__base.FObject.dispose.call(this)};
MO.FReadyLoader=function(a){a=MO.Class.inherits(this,a,MO.FObject,MO.MListener);a._items=MO.Class.register(a,new MO.AGetter("_items"));a._listenersChange=MO.Class.register(a,new MO.AListener("_listenersChange",MO.EEvent.Change));a._statusEvent=null;a._statusReady=!1;a.construct=MO.FReadyLoader_construct;a.testReady=MO.FReadyLoader_testReady;a.push=MO.FReadyLoader_push;a.clear=MO.FReadyLoader_clear;a.dispose=MO.FReadyLoader_dispose;return a};
MO.FReadyLoader_construct=function(){this.__base.FObject.construct.call(this);this._items=new MO.TObjects;this._statusEvent=new MO.SEvent};MO.FReadyLoader_testReady=function(){var a=this._statusReady;if(!a){for(var a=this._items,b=a.count(),d=0;d<b;d++)if(!a.at(d).testReady())return!1;a=this._statusEvent;a.ready=!0;this.processChangeListener(a);a=this._statusReady=!0}return a};MO.FReadyLoader_push=function(a){this._items.push(a);this._statusReady=!1};
MO.FReadyLoader_clear=function(){this._items.clear();this._statusReady=!0};MO.FReadyLoader_dispose=function(){this._items=MO.Lang.Object.dispose(this._items);this._statusEvent=MO.Lang.Object.dispose(this._statusEvent);this.__base.MListener.dispose.call(this);this.__base.FObject.dispose.call(this)};MO.FRegion=function(a){return a=MO.Class.inherits(this,a,MO.FObject)};
MO.FRenderable=function(a){a=MO.Class.inherits(this,a,MO.FDrawable);a._drawables=null;a.hasDrawable=MO.FRenderable_hasDrawable;a.drawables=MO.FRenderable_drawables;a.pushDrawable=MO.FRenderable_pushDrawable;a.removeDrawable=MO.FRenderable_removeDrawable;a.filterDrawables=MO.FRenderable_filterDrawables;a.process=MO.FRenderable_process;return a};MO.FRenderable_hasDrawable=function(){var a=this._drawables;return a?!a.isEmpty():!1};
MO.FRenderable_drawables=function(){var a=this._drawables;a||(a=this._drawables=new MO.TObjects);return a};MO.FRenderable_pushDrawable=function(a){a._drawable=this;a._parent=this;this.drawables().push(a)};MO.FRenderable_removeDrawable=function(a){this._drawables.remove(a)};MO.FRenderable_filterDrawables=function(a){if(!this.testVisible())return!1;a.pushRenderable(this);var b=this._drawables;if(b)for(var d=b.count(),e=0;e<d;e++){var f=b.getAt(e);f.testVisible()&&a.pushRenderable(f)}return!0};
MO.FRenderable_process=function(a){this.__base.FDrawable.process.call(this,a);var b=this._drawables;if(b)for(var d=b.count(),e=0;e<d;e++)b.getAt(e).process(a)};
MO.FStage=function(a){a=MO.Class.inherits(this,a,MO.FComponent,MO.MListener);a._code="stage";a._statusActive=!1;a._size=MO.Class.register(a,new MO.AGetter("_size"));a._timer=MO.Class.register(a,new MO.AGetter("_timer"));a._layers=MO.Class.register(a,new MO.AGetter("_layers"));a._enterFrameListeners=MO.Class.register(a,new MO.AListener("_enterFrameListeners",MO.EEvent.EnterFrame));a._leaveFrameListeners=MO.Class.register(a,new MO.AListener("_leaveFrameListeners",MO.EEvent.LeaveFrame));a.onProcess=
MO.FStage_onProcess;a.construct=MO.FStage_construct;a.registerLayer=MO.FStage_registerLayer;a.unregisterLayer=MO.FStage_unregisterLayer;a.active=MO.FStage_active;a.deactive=MO.FStage_deactive;a.process=MO.FStage_process;a.dispose=MO.FStage_dispose;return a};MO.FStage_onProcess=function(){for(var a=this._layers,b=a.count(),d=0;d<b;d++)a.at(d).process()};
MO.FStage_construct=function(){this.__base.FComponent.construct.call(this);this._size=new MO.SSize2(1920,1080);this._timer=MO.Class.create(MO.FTimer);this._layers=new MO.TDictionary};MO.FStage_registerLayer=function(a,b){b.setCode(a);this._layers.set(a,b)};MO.FStage_unregisterLayer=function(a){this._layers.set(a,null)};MO.FStage_active=function(){this._statusActive=!0;for(var a=this._layers,b=a.count(),d=0;d<b;d++)a.at(d).active()};
MO.FStage_deactive=function(){for(var a=this._layers,b=a.count(),d=0;d<b;d++)a.at(d).deactive();this._statusActive=!1};MO.FStage_process=function(){var a=this._timer;a||(a=MO.Class.create(MO.FTimer),a.setup());this.processEnterFrameListener(this);this.onProcess();this.processLeaveFrameListener(this);a.update()};MO.FStage_dispose=function(){this._timer=MO.Lang.Object.dispose(this._timer);this._layers=MO.Lang.Object.dispose(this._layers);this.__base.MListener.dispose.call(this);this.__base.FComponent.dispose.call(this)};
MO.FTimeline=function(a){a=MO.Class.inherits(this,a,MO.FObject,MO.MListener,MO.MTimelineActions,MO.MTimeline,MO.MTimelines);a._mainTimeline=MO.Class.register(a,new MO.AGetter("_mainTimeline"));a.construct=MO.FTimeline_construct;a.setup=MO.FTimeline_setup;a.process=MO.FTimeline_process;a.dispose=MO.FTimeline_dispose;return a};MO.FTimeline_construct=function(){this.__base.FObject.construct.call(this);this.__base.MTimelineActions.construct.call(this);this._actions=new MO.TObejcts};
MO.FTimeline_setup=function(){};MO.FTimeline_process=function(a){this.__base.MTimelineActions.process.call(this,a);this.__base.MTimelines.process.call(this,a)};MO.FTimeline_dispose=function(){this._actions=MO.Lang.Obejct.dispose(this._actions);this.__base.MTimelineActions.dispose.call(this);this.__base.FObject.dispose.call(this)};MO.RStage=function(){this._started=!1;this._thread=null;this._active=!0;this._interval=10;this.lsnsLeaveFrame=this.lsnsEnterFrame=this._stages=null;this.construct();return this};
MO.RStage.prototype.onProcess=function(a){if(this._active)try{this.lsnsEnterFrame.process(this);var b=this._stages;if(b){var d=b.count();for(a=0;a<d;a++)b.at(a).process()}this.lsnsLeaveFrame.process(this);MO.Timer.update()}catch(e){alert(e)}};MO.RStage.prototype.construct=function(){this.lsnsEnterFrame=new MO.TListeners;this.lsnsLeaveFrame=new MO.TListeners};MO.RStage.prototype.register=function(a,b){var d=this._stages;d||(d=this._stages=new MO.TDictionary);d.set(a,b)};
MO.RStage.prototype.unregister=function(a){this._stages.removeValue(a)};MO.RStage.prototype.active=function(){var a=this._stages;if(a)for(var b=a.count(),d=0;d<b;d++)a.at(d).active()};MO.RStage.prototype.process=function(){this.onProcess()};MO.RStage.prototype.deactive=function(){var a=this._stages;if(a)for(var b=a.count(),d=0;d<b;d++)a.at(d).deactive()};
MO.RStage.prototype.start=function(a){this._started||(MO.RE3dEngine.setup(),this.active(),MO.Timer.setup(),null==a&&(a=this._interval),this._interval=parseInt(a),a=this._thread=MO.Class.create(MO.FThread),a.setInterval(this._interval),a.addProcessListener(this,this.onProcess),MO.Console.find(MO.FThreadConsole).start(a),this._started=!0)};MO.RStage=new MO.RStage;
MO.MAudio=function(a){a=MO.Class.inherits(this,a,MO.MListener);a._ready=MO.Class.register(a,new MO.AGetterSource("_ready","testReady"),!1);a._loaded=MO.Class.register(a,new MO.AGetterSource("_loaded","testLoaded"),!1);a._finish=MO.Class.register(a,new MO.AGetterSource("_finish","testFinish"),!1);a._listenersLoad=MO.Class.register(a,new MO.AListener("_listenersLoad",MO.EEvent.Load));a.construct=MO.MAudio_construct;a.volume=MO.MAudio_volume;a.setVolume=MO.MAudio_setVolume;a.loop=MO.MAudio_loop;a.setLoop=
MO.MAudio_setLoop;a.play=MO.MAudio_play;a.pause=MO.MAudio_pause;a.dispose=MO.MAudio_dispose;return a};MO.MAudio_construct=function(){this.__base.FObject.construct.call(this)};MO.MAudio_volume=function(){return 0};MO.MAudio_setVolume=function(a){};MO.MAudio_loop=function(){return!1};MO.MAudio_setLoop=function(a){};MO.MAudio_play=function(a){};MO.MAudio_pause=function(){};MO.MAudio_dispose=function(){this.__base.MListener.dispose.call(this)};
MO.MLinkerResource=function(a){a=MO.Class.inherits(this,a);a._resource=MO.Class.register(a,new MO.AGetSet("_resource"));a.loadResource=MO.MLinkerResource_loadResource;a.reloadResource=MO.MLinkerResource_reloadResource;a.dispose=MO.MLinkerResource_dispose;return a};MO.MLinkerResource_loadResource=function(a){this._resource=a};MO.MLinkerResource_reloadResource=function(){this.loadResource(this._resource)};MO.MLinkerResource_dispose=function(){this._resource=null};
MO.FAudio=function(a){a=MO.Class.inherits(this,a,MO.FObject,MO.MAudio);a._url=MO.Class.register(a,new MO.AGetter("_url"));a._hAudio=null;a.ohLoad=MO.FAudio_ohLoad;a.ohLoaded=MO.FAudio_ohLoaded;a.ohError=MO.FAudio_ohError;a.construct=MO.FAudio_construct;a.volume=MO.FAudio_volume;a.setVolume=MO.FAudio_setVolume;a.loop=MO.FAudio_loop;a.setLoop=MO.FAudio_setLoop;a.play=MO.FAudio_play;a.pause=MO.FAudio_pause;a.loadUrl=MO.FAudio_loadUrl;a.select=MO.FAudio_select;a.dispose=MO.FAudio_dispose;return a};
MO.FAudio_ohLoad=function(){var a=this.__linker;a._ready=!0;a._hAudio.oncanplay=null;MO.Logger.info(a,"Audio load success. (url={1})",a._url)};MO.FAudio_ohLoaded=function(a){a=this.__linker;a._ready=!0;a._loaded=!0;a._finish=!0;a._hAudio.oncanplaythrough=null;MO.Logger.info(a,"Audio loaded success. (url={1})",a._url)};MO.FAudio_ohError=function(a){a=this.__linker;a._finish=!0;MO.Logger.error(a,"Audio load failure. (url={1})",a._url)};
MO.FAudio_construct=function(){this.__base.FObject.construct.call(this);this.__base.MAudio.construct.call(this)};MO.FAudio_volume=function(){return this._hAudio.volume};MO.FAudio_setVolume=function(a){this._hAudio.volume=a};MO.FAudio_loop=function(){return this._hAudio.loop};MO.FAudio_setLoop=function(a){this._hAudio.loop=a};MO.FAudio_play=function(a){var b=this._hAudio;null!=a&&b.currentTime!=a&&(b.currentTime=a);b.play()};MO.FAudio_pause=function(){this._hAudio.pause()};
MO.FAudio_loadUrl=function(a){a=MO.Console.find(MO.FEnvironmentConsole).parse(a);var b=this._hAudio;b||(b=this._hAudio=new Audio,b.__linker=this,b.oncanplay=this.ohLoad,b.oncanplaythrough=this.ohLoaded,b.onerror=this.ohError,b.loop=!1);MO.Window.Browser.capability.soundFinish||(this._finish=this._loaded=this._ready=!0);this._url=a;b.src=a};MO.FAudio_select=function(){this._hAudio.play();this._hAudio.pause()};
MO.FAudio_dispose=function(){this._hAudio=MO.Window.Html.free(this._hAudio);this.__base.MListenerLoad.dispose.call(this);this.__base.MAudio.dispose.call(this);this.__base.FObject.dispose.call(this)};
MO.FAudioBuffer=function(a){a=MO.Class.inherits(this,a,MO.FObject,MO.MAudio);a._context=MO.Class.register(a,new MO.AGetSet("_context"));a._url=MO.Class.register(a,new MO.AGetSet("_url"));a._handle=MO.Class.register(a,new MO.AGetter("_handle"));a._buffer=MO.Class.register(a,new MO.AGetter("_buffer"));a.onDecodeSuccess=MO.FAudioBuffer_onDecodeSuccess;a.onDecodeFailure=MO.FAudioBuffer_onDecodeFailure;a.onLoad=MO.FAudioBuffer_onLoad;a.construct=MO.FAudioBuffer_construct;a.testReady=MO.FAudioBuffer_testReady;
a.loadUrl=MO.FAudioBuffer_loadUrl;a.play=MO.FAudioBuffer_play;a.dispose=MO.FAudioBuffer_dispose;return a};MO.FAudioBuffer_onDecodeSuccess=function(a){var b=this._context.handle(),d=this._buffer=b.createBufferSource();d.buffer=a;d.connect(b.destination);this._finish=this._loaded=this._ready=!0;a=new MO.SEvent(this);this.processLoadListener(a);a.dispose()};MO.FAudioBuffer_onDecodeFailure=function(a){this._finish=!0;MO.Logger.error(this,"Decode audio buffer failure. (url={1})",this._url)};
MO.FAudioBuffer_onLoad=function(a){a=a.outputData();this._context.handle().decodeAudioData(a,this.onDecodeSuccess.bind(this),this.onDecodeFailure.bind(this))};MO.FAudioBuffer_construct=function(){this.__base.FObject.construct.call(this);this.__base.MAudio.construct.call(this)};MO.FAudioBuffer_testReady=function(){return this._ready};
MO.FAudioBuffer_loadUrl=function(a){this._url=MO.Console.find(MO.FEnvironmentConsole).parse(a);MO.Console.find(MO.FHttpConsole).sendAsync(this._url).addLoadListener(this,this.onLoad)};MO.FAudioBuffer_play=function(a){this._buffer.start(MO.Lang.Integer.nvl(a))};MO.FAudioBuffer_dispose=function(){this.__base.MAudio.dispose.call(this);this.__base.FObject.dispose.call(this)};
MO.FAudioConsole=function(a){a=MO.Class.inherits(this,a,MO.FConsole);a._scopeCd=MO.EScope.Global;a._audios=null;a.construct=MO.FAudioConsole_construct;a.create=MO.FAudioConsole_create;a.load=MO.FAudioConsole_load;a.select=MO.FAudioConsole_select;a.dispose=MO.FAudioConsole_dispose;return a};MO.FAudioConsole_construct=function(){this.__base.FConsole.construct.call(this);this._audios=new MO.TDictionary};
MO.FAudioConsole_create=function(a){a=MO.Console.find(MO.FEnvironmentConsole).parse(a);var b=MO.Class.create(MO.FAudioResource);b.loadUrl(a);return b};MO.FAudioConsole_load=function(a){var b=this._audios,d=b.get(a);d||(d=this.create(a),b.set(a,d));return d};MO.FAudioConsole_select=function(){for(var a=this._audios,b=a.count(),d=0;d<b;d++)a.at(d).select()};MO.FAudioConsole_dispose=function(){this._audios=MO.Lang.Object.dispose(this._audios);this.__base.FConsole.dispose.call(this)};
MO.FAudioContext=function(a){a=MO.Class.inherits(this,a,MO.FObject);a._handle=MO.Class.register(a,new MO.AGetter("_handle"));a._buffers=MO.Class.register(a,new MO.AGetter("_buffers"));a.construct=MO.FAudioContext_construct;a.setup=MO.FAudioContext_setup;a.createBuffer=MO.FAudioContext_createBuffer;a.dispose=MO.FAudioContext_dispose;return a};MO.FAudioContext_construct=function(){this.__base.FObject.construct.call(this);this._buffers=new MO.TDictionary};
MO.FAudioContext_setup=function(a){this._audioBuffers=new MO.TDictionary;a=null;window.AudioContext?a=new AudioContext:window.webkitAudioContext&&(a=new webkitAudioContext);if(!a)return MO.Logger.error(this,"Invalid audio context.");this._handle=a};MO.FAudioContext_createBuffer=function(a){a=MO.Console.find(MO.FEnvironmentConsole).parse(a);var b=null;this._handle=null,b=MO.Class.create(MO.FAudio);b.loadUrl(a);return b};
MO.FAudioContext_dispose=function(){this._buffers=MO.Lang.Object.dispose(this._buffers);this.__base.FObject.dispose.call(this)};MO.FAudioContextConsole=function(a){a=MO.Class.inherits(this,a,MO.FConsole);a._scopeCd=MO.EScope.Global;a._contexts=null;a.construct=MO.FAudioContextConsole_construct;a.create=MO.FAudioContextConsole_create;a.dispose=MO.FAudioContextConsole_dispose;return a};MO.FAudioContextConsole_construct=function(){this.__base.FConsole.construct.call(this);this._contexts=new MO.TObjects};
MO.FAudioContextConsole_create=function(a){a=MO.Class.create(MO.FAudioContext);a.setup();this._contexts.push(a);return a};MO.FAudioContextConsole_dispose=function(){this._contexts=MO.Lang.Object.dispose(this._contexts);this.__base.FConsole.dispose.call(this)};MO.FAudioResource=function(a){return a=MO.Class.inherits(this,a,MO.FAudio)};
MO.FImageConsole=function(a){a=MO.Class.inherits(this,a,MO.FConsole);a._scopeCd=MO.EScope.Global;a._images=null;a.construct=MO.FImageConsole_construct;a.create=MO.FImageConsole_create;a.load=MO.FImageConsole_load;a.dispose=MO.FImageConsole_dispose;return a};MO.FImageConsole_construct=function(){this.__base.FConsole.construct.call(this);this._images=new MO.TDictionary};
MO.FImageConsole_create=function(a){a=MO.Console.find(MO.FEnvironmentConsole).parse(a);var b=MO.Class.create(MO.FImageResource);b.loadUrl(a);return b};MO.FImageConsole_load=function(a){var b=this._images,d=b.get(a);d||(d=this.create(a),b.set(a,d));return d};MO.FImageConsole_dispose=function(){this._images=MO.Lang.Object.dispose(this._images);this.__base.FConsole.dispose.call(this)};MO.FImageResource=function(a){return a=MO.Class.inherits(this,a,MO.FImage)};
MO.FResource=function(a){a=MO.Class.inherits(this,a,MO.FObject);a._guid=MO.Class.register(a,new MO.AGetSet("_guid"));a._code=MO.Class.register(a,new MO.AGetSet("_code"));a._label=MO.Class.register(a,new MO.AGetSet("_label"));return a};
MO.FResourceBlockStorage=function(a){a=MO.Class.inherits(this,a,MO.FResourceStorage);a._ready=!1;a._dataLength=0;a._blockSize=0;a._blockCount=0;a._blocks=MO.Class.register(a,new MO.AGetter("_blocks"));a._resource=null;a.construct=MO.FResourceBlockStorage_construct;a.testReady=MO.FResourceBlockStorage_testReady;a.load=MO.FResourceBlockStorage_load;a.complete=MO.FResourceBlockStorage_complete;a.dispose=MO.FResourceBlockStorage_dispose;return a};
MO.FResourceBlockStorage_construct=function(){this.__base.FResourceStorage.construct.call(this);this._blocks=new MO.TObjects};MO.FResourceBlockStorage_testReady=function(){if(!this._ready){for(var a=this._blocks,b=a.count(),d=0;d<b;d++)if(!a.at(d).testReady())return!1;this._ready=!0}return this._ready};
MO.FResourceBlockStorage_load=function(a){var b=this._resource;this._compressLength=a.byteLength;var d=MO.Class.create(MO.FDataView);d.setEndianCd(!0);d.link(a);d.readString();this._dataLength=d.readInt32();this._blockSize=d.readInt32();a=this._blockCount=d.readInt32();for(var e=this._blocks,f=0;f<a;f++){var h=d.readInt32(),k=new ArrayBuffer(h);d.readBytes(k,0,h);h=MO.Class.create(MO.FResourceBlockStorageData);h._guid=b.guid();h._index=f;h.setCompressData(k);e.push(h)}d.dispose()};
MO.FResourceBlockStorage_complete=function(){var a=this._resource,b=MO.Class.create(MO.FDataStream);b.setEndianCd(!0);b.setLength(this._dataLength);for(var d=this._blocks,e=d.count(),f=0;f<e;f++){var h=d.at(f)._data;b.writeBytes(h.buffer,0,h.byteLength)}b.flip();d=MO.Timer.current()-a._compressStartTick;MO.Logger.info(this,"Process resource storage. (guid={1}, block_count={2}, length={3}, total={4}, tick={5})",a.guid(),e,this._compressLength,this._dataLength,d);a.onComplete(b);b.dispose()};
MO.FResourceBlockStorage_dispose=function(){this._resource=null;var a=this._blocks;if(a){for(var b=a.count(),d=0;d<b;d++)a.at(d).dispose();this._blocks=MO.Lang.Object.dispose(a)}this.__base.FResourceStorage.dispose.call(this)};MO.FResourceBlockStorageData=function(a){a=MO.Class.inherits(this,a,MO.FObject,MO.MResourceData);a.dispose=MO.FResourceBlockStorageData_dispose;return a};MO.FResourceBlockStorageData_dispose=function(){this.__base.MResourceData.dispose.call(this);this.__base.FObject.dispose.call(this)};
MO.FResourceConsole=function(a){a=MO.Class.inherits(this,a,MO.FConsole);a._scopeCd=MO.EScope.Global;a._factory=null;a._types=null;a._packages=null;a._resources=null;a._loadResources=null;a._loadingResources=null;a._processStorages=null;a._thread=null;a._loadLimit=8;a._interval=150;a.onComplete=MO.FResourceConsole_onComplete;a.onLoad=MO.FResourceConsole_onLoad;a.onBlockLoad=MO.FResourceConsole_onBlockLoad;a.onProcess=MO.FResourceConsole_onProcess;a.construct=MO.FResourceConsole_construct;a.registerType=
MO.FResourceConsole_registerType;a.factory=MO.FResourceConsole_factory;a.load=MO.FResourceConsole_load;a.loadPackage=MO.FResourceConsole_loadPackage;a.loadPackageByUrl=MO.FResourceConsole_loadPackageByUrl;a.dispose=MO.FResourceConsole_dispose;return a};MO.FResourceConsole_onComplete=function(a,b){a._data=null;this._loadingResources.remove(a);a.onComplete(b)};
MO.FResourceConsole_onLoad=function(a){var b=a.outputData();a=a._resource;var d=MO.Class.create(MO.FResourceSingleStorage);d.setResource(a);d.load(b);MO.Console.find(MO.FResourceDataConsole).load(d);this._loadingResources.remove(a);this._processStorages.push(d)};
MO.FResourceConsole_onBlockLoad=function(a){var b=a.outputData();a=a._resource;a._compressLength=b.byteLength;a._compressStartTick=RTimer.current();var d=MO.Class.create(MO.FResourceBlockStorage);d.setResource(a);d.load(b);for(var b=MO.Console.find(MO.FResourceDataConsole),e=d.blocks(),f=e.count(),h=0;h<f;h++){var k=e.at(h);b.load(k)}this._loadingResources.remove(a);this._processStorages.push(d)};
MO.FResourceConsole_onProcess=function(){var a=MO.Console.find(MO.FHttpConsole),b=this._loadResources,d=this._loadingResources,e=d.count();if(!b.isEmpty())for(e=this._loadLimit-e;0<e;e--){var f=b.shift(),h=f.sourceUrl(),h=a.send(h);h._resource=f;f._dataCompress?f._dataBlock?h.addLoadListener(this,this.onBlockLoad):h.addLoadListener(this,this.onLoad):h.addLoadListener(this,this.onComplete);f._dataLoad=!0;d.push(f);if(b.isEmpty())break}a=this._processStorages;for(a.record();a.next();)b=a.current(),
b.testReady()&&(a.removeCurrent(),b.complete(),b.dispose())};
MO.FResourceConsole_construct=function(){this.__base.FConsole.construct.call(this);this._factory=MO.Class.create(MO.FClassFactory);this._types=new MO.TDictionary;this._packages=new MO.TDictionary;this._resources=new MO.TDictionary;this._loadResources=new MO.TObjects;this._loadingResources=new MO.TObjects;this._processStorages=new MO.TLooper;var a=this._thread=MO.Class.create(MO.FThread);a.setInterval(this._interval);a.addProcessListener(this,this.onProcess);MO.Console.find(MO.FThreadConsole).start(a)};
MO.FResourceConsole_registerType=function(a){var b=a.code();return this._types.set(b,a)};MO.FResourceConsole_factory=function(){return this._factory};MO.FResourceConsole_load=function(a){var b=a.guid(),d=this._resources;if(d.contains(b))throw new MO.TError(this,"Resource is already loaded. (guid={1})",b);d.set(b,a);this._loadResources.push(a);a._dataLoad=!0};MO.FResourceConsole_loadPackage=function(a){};
MO.FResourceConsole_loadPackageByUrl=function(a){var b=this._packages,d=b.get(a);if(!d){var e=MO.Console.find(MO.FEnvironmentConsole).parse(a),d=MO.Class.create(MO.FResourcePackage);d.loadUrl(e);b.set(a,d)}return d};
MO.FResourceConsole_dispose=function(){this._factory=MO.Lang.Object.dispose(this._factory);this._types=MO.Lang.Object.dispose(this._types);this._packages=MO.Lang.Object.dispose(this._packages);this._resources=MO.Lang.Object.dispose(this._resources);this._loadResources=MO.Lang.Object.dispose(this._loadResources);this._loadingResources=MO.Lang.Object.dispose(this._loadingResources);this._processStorages=MO.Lang.Object.dispose(this._processStorages);this.__base.FConsole.dispose.call(this)};
MO.FResourceDataConsole=function(a){a=MO.Class.inherits(this,a,MO.FConsole);a._scopeCd=MO.EScope.Global;a._loadDatas=null;a._processDatas=null;a._pipeline=null;a._pipelinePool=null;a._thread=null;a._processLimit=4;a._interval=200;a.onPipelineComplete=MO.FResourceDataConsole_onPipelineComplete;a.onProcess=MO.FResourceDataConsole_onProcess;a.construct=MO.FResourceDataConsole_construct;a.allocPipeline=MO.FResourceDataConsole_allocPipeline;a.freePipeline=MO.FResourceDataConsole_freePipeline;a.load=MO.FResourceDataConsole_load;
return a};MO.FResourceDataConsole_onPipelineComplete=function(a,b){a&&this.freePipeline(a);this._processDatas.remove(b)};MO.FResourceDataConsole_onProcess=function(){var a=this._loadDatas,b=a.count();if(0!=b){var d=this._pipeline;if(d)d.testBusy()||(b=a.shift(),d.decompress(b));else{var e=this._processDatas,d=e.count(),d=this._processLimit-d;if(!(0>=d))for(var f=Math.min(b,d),h=0;h<f;h++)b=a.shift(),d=this.allocPipeline(),d.decompress(b),e.push(b)}}};
MO.FResourceDataConsole_construct=function(){this.__base.FConsole.construct.call(this);this._loadDatas=new MO.TObjects;this._processDatas=new MO.TObjects;this._pipelinePool=MO.Class.create(MO.FObjectPool);MO.Window.Browser.capability().optionProcess||(this._pipeline=MO.Class.create(FResourceSinglePipeline)).setConsole(this);var a=this._thread=MO.Class.create(MO.FThread);a.setInterval(this._interval);a.addProcessListener(this,this.onProcess);MO.Console.find(MO.FThreadConsole).start(a)};
MO.FResourceDataConsole_allocPipeline=function(){var a=this._pipelinePool;if(!a.hasFree()){var b=MO.Class.create(MO.FResourceThreadPipeline);b.setConsole(this);a.push(b)}return a.alloc()};MO.FResourceDataConsole_freePipeline=function(a){this._pipelinePool.free(a)};MO.FResourceDataConsole_load=function(a){this._loadDatas.push(a)};MO.FResourceGroup=function(a){a=MO.Class.inherits(this,a,MO.FResource);a._resources=null;return a};
MO.FResourceObject=function(a){a=MO.Class.inherits(this,a,MO.FResource);a._typeCode=MO.Class.register(a,new MO.AGetter("_typeCode"));return a};MO.FResourcePackage=function(a){a=MO.Class.inherits(this,a,MO.FResource);a._uri=MO.Class.register(a,new MO.AGetSet("_uri"));a._url=MO.Class.register(a,new MO.AGetSet("_url"));a._statusReady=!1;a.onLoad=MO.FResourcePackage_onLoad;a.testReady=MO.FResourcePackage_testReady;a.unserialize=MO.Method.empty;a.load=MO.FResourcePackage_load;return a};
MO.FResourcePackage_onLoad=function(a){var b=MO.Class.create(MO.FDataView);b.setEndianCd(!0);b.link(a.content);this.unserialize(b);b.dispose();this._statusReady=!0};MO.FResourcePackage_testReady=function(){return this._statusReady};MO.FResourcePackage_load=function(){var a=this._url;a||(a=this._url=MO.Console.find(MO.FEnvironmentConsole).parse(this._uri));a=MO.Console.find(MO.FHttpConsole).sendAsync(a);a.addLoadListener(this,this.onLoad);return a};
MO.FResourcePipeline=function(a){a=MO.Class.inherits(this,a,MO.FPipeline);a._console=MO.Class.register(a,new MO.AGetSet("_console"));a._compressCd=MO.Class.register(a,new MO.AGetter("_compressCd"));a._resource=MO.Class.register(a,new MO.AGetSet("_resource"));a.dispose=MO.FResourcePipeline_dispose;return a};MO.FResourcePipeline_dispose=function(){this._resource=this._console=null;this.__base.FPipeline.dispose.call(this)};
MO.FResourceSinglePipeline=function(a){a=MO.Class.inherits(this,a,MO.FResourcePipeline);a._startTime=0;a._statusBusy=!1;a._data=0;a._dataLength=0;a._worker=null;a.onComplete=MO.FResourceSinglePipeline_onComplete;a.construct=MO.FResourceSinglePipeline_construct;a.testBusy=MO.FResourceSinglePipeline_testBusy;a.decompress=MO.FResourceSinglePipeline_decompress;a.dispose=MO.FResourceSinglePipeline_dispose;return a};
MO.FResourceSinglePipeline_onComplete=function(a){var b=this._data,d=null;if(a.constructor==Array)d=new Uint8Array(a);else if(a.constructor==ArrayBuffer)d=a;else throw new MO.TError(this,"Unknown buffer type.");b.completeData(d);a=MO.Timer.now()-this._startTime;MO.Logger.info(this,"Process resource data decompress. (guid={1}, block={2}, length={3}, total={4}, tick={5})",b._guid,b._index,this._dataLength,d.byteLength,a);this._console.onPipelineComplete(null,b);this._data=null;this._statusBusy=!1};
MO.FResourceSinglePipeline_construct=function(){this.__base.FResourcePipeline.construct.call(this)};MO.FResourceSinglePipeline_testBusy=function(){return this._statusBusy};
MO.FResourceSinglePipeline_decompress=function(a){var b=this;b._statusBusy=!0;b._startTime=MO.Timer.current();var d=a.compressData();b._data=a;b._dataLength=d.byteLength;a=null;if(d.constructor==ArrayBuffer)a=new Uint8Array(d);else if(d.constructor==Uint8Array)a=d;else throw new MO.TError(b,"Unknown data type.");LZMAD.decompress(a,function(a){b.onComplete(a)},null)};MO.FResourceSinglePipeline_dispose=function(){this._worker=this._data=null;this.__base.FPipeline.dispose.call(this)};
MO.FResourceSingleStorage=function(a){a=MO.Class.inherits(this,a,MO.FResourceStorage,MO.MResourceData);a.construct=MO.FResourceSingleStorage_construct;a.load=MO.FResourceSingleStorage_load;a.complete=MO.FResourceSingleStorage_complete;a.dispose=MO.FResourceSingleStorage_dispose;return a};MO.FResourceSingleStorage_construct=function(){this.__base.FResourceStorage.construct.call(this)};MO.FResourceSingleStorage_load=function(a){this._compressLength=a.byteLength;this._compressData=new Uint8Array(a)};
MO.FResourceSingleStorage_complete=function(){this._resource.onComplete(this._data)};MO.FResourceSingleStorage_dispose=function(){this.__base.MResourceData.dispose.call(this);this.__base.FResourceStorage.dispose.call(this)};
MO.FResourceStorage=function(a){a=MO.Class.inherits(this,a,MO.FObject);a._ready=!1;a._dataLength=0;a._resource=MO.Class.register(a,new MO.AGetSet("_resource"));a.construct=MO.FResourceStorage_construct;a.testReady=MO.FResourceStorage_testReady;a.load=MO.FResourceStorage_load;a.complete=MO.FResourceStorage_complete;a.dispose=MO.FResourceStorage_dispose;return a};MO.FResourceStorage_construct=function(){this.__base.FObject.construct.call(this)};MO.FResourceStorage_testReady=function(){return this._ready};
MO.FResourceStorage_load=function(a){};MO.FResourceStorage_complete=function(){};MO.FResourceStorage_dispose=function(){this._resource=null;this.__base.FObject.dispose.call(this)};
MO.FResourceThreadPipeline=function(a){a=MO.Class.inherits(this,a,MO.FResourcePipeline);a._startTime=0;a._data=0;a._dataLength=0;a._worker=null;a.onComplete=MO.FResourceThreadPipeline_onComplete;a.construct=MO.FResourceThreadPipeline_construct;a.worker=MO.FResourceThreadPipeline_worker;a.decompress=MO.FResourceThreadPipeline_decompress;a.dispose=MO.FResourceThreadPipeline_dispose;return a};
MO.FResourceThreadPipeline_onComplete=function(a){var b=null;if(a.constructor==Array)b=new Uint8Array(a);else if(a.constructor==Uint8Array)b=a;else throw new MO.TError(this,"Unknown buffer type.");var d=this._data;d.completeData(b);b=MO.Timer.now()-this._startTime;MO.Logger.info(this,"Process resource data decompress. (guid={1}, block={2}, length={3}, total={4}, tick={5})",d._guid,d._index,this._dataLength,a.byteLength,b);this._console.onPipelineComplete(this,d);this._data=null};
MO.FResourceThreadPipeline_construct=function(){this.__base.FResourcePipeline.construct.call(this)};MO.FResourceThreadPipeline_worker=function(){var a=this._worker;a||(a=MO.RBrowser.contentPath("/ajs/lzma_worker.js"),a=this._worker=new LZMA_WORKER(a));return a};MO.FResourceThreadPipeline_decompress=function(a){var b=this;b._startTime=MO.Timer.current();var d=a.compressData();b._data=a;b._dataLength=d.byteLength;b.worker().decompress(d,function(a){b.onComplete(a)},null)};
MO.FResourceThreadPipeline_dispose=function(){this._worker=this._data=null;this.__base.FPipeline.dispose.call(this)};MO.FResourceType=function(a){a=MO.Class.inherits(this,a,MO.FObject);a._code=MO.Class.register(a,new MO.AGetSet("_code"));a._pipeline=MO.Class.register(a,new MO.AGetSet("_pipeline"));a._resources=MO.Class.register(a,new MO.AGetter("_resources"));a.construct=MO.FResourceType_construct;a.findResource=MO.FResourceType_findResource;a.dispose=MO.FResourceType_dispose;return a};
MO.FResourceType_construct=function(){this.__base.FObject.construct.call(this);this._resources=new MO.TDictionary};MO.FResourceType_findResource=function(a){return this._resources.get(a)};MO.FResourceType_dispose=function(){this._resources=MO.Lang.Object.dispose(this._resources);this.__base.FObject.dispose.call(this)};MO.FEntity=function(a){a=MO.Class.inherits(this,a,MO.FObject,MO.MReady);a._statusReady=!1;a.testReady=MO.FEntity_testReady;a.processLoad=MO.Method.emptyTrue;return a};
MO.FEntity_testReady=function(){return this._statusReady};MO.FEntityConsole=function(a){a=MO.Class.inherits(this,a,MO.FConsole);a._scopeCd=MO.EScope.Global;a._looperLoad=null;a._thread=null;a._interval=100;a.onProcess=MO.FEntityConsole_onProcess;a.construct=MO.FEntityConsole_construct;a.loadEntity=MO.FEntityConsole_loadEntity;a.dispose=MO.FEntityConsole_dispose;return a};MO.FEntityConsole_onProcess=function(){var a=this._looperLoad;for(a.record();a.next();)a.current().processLoad()&&a.removeCurrent()};
MO.FEntityConsole_construct=function(){this.__base.FConsole.construct.call(this);this._looperLoad=new MO.TLooper;var a=this._thread=MO.Class.create(MO.FThread);a.setInterval(this._interval);a.addProcessListener(this,this.onProcess);MO.Console.find(MO.FThreadConsole).start(a)};MO.FEntityConsole_loadEntity=function(a){this._looperLoad.push(a)};MO.FEntityConsole_dispose=function(){this._looperLoad=RObject.dispose(this._looperLoad);this.__base.FConsole.dispose.call(this)};
MO.FE2dCanvas=function(a){a=MO.Class.inherits(this,a,MO.FCanvas,MO.MCanvasObject,MO.MGraphicObject);a._size=MO.Class.register(a,new MO.AGetter("_size"));a._hCanvas=null;a.onResize=MO.FE2dCanvas_onResize;a.construct=MO.FE2dCanvas_construct;a.createContext=MO.FE2dCanvas_createContext;a.htmlCanvas=MO.FE2dCanvas_htmlCanvas;a.build=MO.FE2dCanvas_build;a.setPanel=MO.FE2dCanvas_setPanel;a.resize=MO.FE2dCanvas_resize;a.show=MO.FE2dCanvas_show;a.hide=MO.FE2dCanvas_hide;a.setVisible=MO.FE2dCanvas_setVisible;
a.reset=MO.FE2dCanvas_reset;a.dispose=MO.FE2dCanvas_dispose;return a};MO.FE2dCanvas_onResize=function(a){};MO.FE2dCanvas_construct=function(){this.__base.FCanvas.construct.call(this);this._size=new MO.SSize2(1280,720)};MO.FE2dCanvas_createContext=function(){return MO.Class.create(MO.FG2dCanvasContext)};MO.FE2dCanvas_htmlCanvas=function(){return this._hCanvas};
MO.FE2dCanvas_build=function(a){var b=this._size,d=b.width,b=b.height;a=this._hCanvas=MO.Window.Builder.create(a,"CANVAS");a.__linker=this;var e=a.style;e.left="0px";e.top="0px";e.width="100%";e.height="100%";(this._graphicContext=this.createContext()).linkCanvas(a);this.resize(d,b)};MO.FE2dCanvas_setPanel=function(a){this._hPanel=a;a.appendChild(this._hCanvas);this.onResize()};
MO.FE2dCanvas_resize=function(a,b){var d=this._hCanvas;d.width=a;d.height=b;this._size.set(a,b);this._graphicContext.size().set(a,b)};MO.FE2dCanvas_show=function(){this.setVisible(!0)};MO.FE2dCanvas_hide=function(){this.setVisible(!1)};MO.FE2dCanvas_setVisible=function(a){MO.Window.Html.visibleSet(this._hCanvas,a)};MO.FE2dCanvas_reset=function(){this._graphicContext.clear()};
MO.FE2dCanvas_dispose=function(){this._size=MO.Lang.Object.dispose(this._size);this._graphicContext=MO.Lang.Object.dispose(this._graphicContext);this._hPanel=MO.Window.Html.free(this._hPanel);this._hCanvas=MO.Window.Html.free(this._hCanvas);this.__base.FCanvas.dispose.call(this)};
MO.FE2dCanvasConsole=function(a){a=MO.Class.inherits(this,a,MO.FConsole);a._scopeCd=MO.EScope.Local;a._pools=null;a.construct=MO.FE2dCanvasConsole_construct;a.allocBySize=MO.FE2dCanvasConsole_allocBySize;a.free=MO.FE2dCanvasConsole_free;return a};MO.FE2dCanvasConsole_construct=function(){this.__base.FConsole.construct.call(this);this._pools=MO.Class.create(MO.FObjectPools)};
MO.FE2dCanvasConsole_allocBySize=function(a,b){var d=this._pools.alloc(a+"x"+b);d||(d=MO.Class.create(MO.FE2dCanvas),d.size().set(a,b),d.build(MO.Window._hDocument));d.reset();return d};MO.FE2dCanvasConsole_free=function(a){var b=this._pools,d=a.size();b.free(d.width+"x"+d.height,a)};MO.FE2dDrawable=function(a){return a=MO.Class.inherits(this,a,MO.FDrawable)};
MO.ME3dObject=function(a){a=MO.Class.inherits(this,a,MO.MGraphicObject,MO.MAttributeCode);a._guid=MO.Class.register(a,new MO.AGetSet("_guid"));return a};
MO.FE3dCanvas=function(a){a=MO.Class.inherits(this,a,MO.FCanvas,MO.MGraphicObject,MO.MMouseCapture);a._optionAlpha=!0;a._optionAntialias=!0;a._optionStageProcess=!0;a._optionResize=!0;a._optionMouseCapture=!0;a._listenerLoad=MO.Class.register(a,new MO.AListener("_listenerLoad",MO.EEvent.Load));a._size=MO.Class.register(a,new MO.AGetter("_size"));a._logicSize=MO.Class.register(a,new MO.AGetter("_logicSize"));a._screenSize=MO.Class.register(a,new MO.AGetter("_screenSize"));a._interval=10;a._hPanel=
null;a._hCanvas=null;a.onEnterFrame=MO.Method.empty;a.ohTouchStart=MO.FE3dCanvas_ohTouchStart;a.ohTouchMove=MO.FE3dCanvas_ohTouchMove;a.ohTouchStop=MO.FE3dCanvas_ohTouchStop;a.onMouseCaptureStart=MO.Method.empty;a.onMouseCapture=MO.Method.empty;a.onMouseCaptureStop=MO.Method.empty;a.onTouchStart=MO.Method.empty;a.onTouchMove=MO.Method.empty;a.onTouchStop=MO.Method.empty;a.onResize=MO.FE3dCanvas_onResize;a.construct=MO.FE3dCanvas_construct;a.build=MO.FE3dCanvas_build;a.resize=MO.FE3dCanvas_resize;
a.show=MO.FE3dCanvas_show;a.hide=MO.FE3dCanvas_hide;a.setVisible=MO.FE3dCanvas_setVisible;a.setPanel=MO.FE3dCanvas_setPanel;a.dispose=MO.FE3dCanvas_dispose;return a};MO.FE3dCanvas_ohTouchStart=function(a){this.__linker.onTouchStart(a)};MO.FE3dCanvas_ohTouchMove=function(a){this.__linker.onTouchMove(a)};MO.FE3dCanvas_ohTouchStop=function(a){this.__linker.onTouchStop(a)};MO.FE3dCanvas_onResize=function(a){this.resize()};
MO.FE3dCanvas_construct=function(){this.__base.FCanvas.construct.call(this);this._size=new MO.SSize2(1280,720);this._logicSize=new MO.SSize2(1280,720);this._screenSize=new MO.SSize2(1280,720)};
MO.FE3dCanvas_build=function(a){var b=this._size,d=b.width,b=b.height;a=this._hCanvas=MO.RBuilder.create(a,"CANVAS");a.__linker=this;a.width=d;a.height=b;d=a.style;d.left="0px";d.top="0px";d.width="100%";d.height="100%";MO.Method.isEmpty(this.onTouchStart)||a.addEventListener("touchstart",this.ohTouchStart,!1);MO.Method.isEmpty(this.onTouchMove)||a.addEventListener("touchmove",this.ohTouchMove,!1);MO.Method.isEmpty(this.onTouchStop)||a.addEventListener("touchend",this.ohTouchStop,!1);d={};d.alpha=
this._optionAlpha;d.antialias=this._optionAntialias;this._graphicContext=MO.Graphic.Context3d.createContext(MO.FWglContext,a,d);this._optionStageProcess&&(RStage.lsnsEnterFrame.register(this,this.onEnterFrame),RStage.start(this._interval));this._optionResize&&(MO.Window.lsnsResize.register(this,this.onResize),MO.Window.lsnsOrientation.register(this,this.onResize));this._optionMouseCapture&&MO.Console.find(MO.FMouseConsole).register(this)};
MO.FE3dCanvas_resize=function(a,b){if(!a||!b)throw new MO.TError(this,"Invalid canvas size.");this._screenSize.set(a,b);var d=parseInt(a),e=parseInt(b),f=this._hCanvas;f.width=d;f.height=e;this._size.set(d,e);this._graphicContext.setViewport(0,0,d,e)};MO.FE3dCanvas_show=function(){this.setVisible(!0)};MO.FE3dCanvas_hide=function(){this.setVisible(!1)};MO.FE3dCanvas_setVisible=function(a){MO.Window.Html.visibleSet(this._hCanvas,a)};
MO.FE3dCanvas_setPanel=function(a){a.appendChild(this._hCanvas);this._hPanel=a;this.resize()};
MO.FE3dCanvas_dispose=function(){var a=this._hCanvas;a&&(a.__linker=null,a.removeEventListener("touchstart",this.ohTouchStart),a.removeEventListener("touchmove",this.ohTouchMove),a.removeEventListener("touchend",this.ohTouchStop));this._graphicContext=MO.Lang.Object.dispose(this._graphicContext);this._size=MO.Lang.Object.dispose(this._size);this._screenSize=MO.Lang.Object.dispose(this._screenSize);this._logicSize=MO.Lang.Object.dispose(this._logicSize);this._hPanel=MO.RHtml.free(this._hPanel);this._hCanvas=
MO.RHtml.free(this._hCanvas);this.__base.FCanvas.dispose.call(this)};MO.FE3dDisplay=function(a){a=MO.Class.inherits(this,a,MO.FDisplay);a._outline=MO.Class.register(a,new MO.AGetter("_outline"));a._materials=MO.Class.register(a,new MO.AGetter("_materials"));a.construct=MO.FE3dDisplay_construct;a.calculateOutline=MO.FE3dDisplay_calculateOutline;a.dispose=MO.FE3dDisplay_dispose;return a};MO.FE3dDisplay_construct=function(){this.__base.FDisplay.construct.call(this);this._outline=new MO.SOutline3d};
MO.FE3dDisplay_calculateOutline=function(){return this._outline};MO.FE3dDisplay_dispose=function(){this._materials=MO.Lang.Object.free(this._materials);this.__base.FDisplay.dispose.call(this)};
MO.FE3dDisplayContainer=function(a){a=MO.Class.inherits(this,a,MO.FDisplayContainer);a._outline=null;a._materials=MO.Class.register(a,new MO.AGetter("_materials"));a.construct=MO.FE3dDisplayContainer_construct;a.calculateOutline=MO.FE3dDisplayContainer_calculateOutline;a.dispose=MO.FE3dDisplayContainer_dispose;return a};MO.FE3dDisplayContainer_construct=function(){this.__base.FDisplayContainer.construct.call(this);this._outline=new MO.SOutline3d};
MO.FE3dDisplayContainer_calculateOutline=function(){var a=this._outline;if(a.isEmpty()){a.setMin();var b=this._renderables;if(b)for(var d=b.count(),e=0;e<d;e++){var f=b.at(e).calculateOutline();a.mergeMax(f)}}return a};MO.FE3dDisplayContainer_dispose=function(){this._materials=RObject.dispose(this._materials);this.__base.FDisplayContainer.dispose.call(this)};
MO.FE3dRenderable=function(a){a=MO.Class.inherits(this,a,MO.FRenderable,MO.MG3dRenderable,MO.MGraphicObject,MO.MLinkerResource);a._display=MO.Class.register(a,new MO.AGetSet("_display"));a._outline=null;a._outlineVisible=!0;a._calculateMatrix=null;a._vertexCount=MO.Class.register(a,new MO.AGetSet("_vertexCount"));a._vertexBuffers=MO.Class.register(a,new MO.AGetter("_vertexBuffers"));a._indexBuffers=MO.Class.register(a,new MO.AGetter("_indexBuffers"));a._materialReference=MO.Class.register(a,new MO.AGetSet("_materialReference"));
a._materials=MO.Class.register(a,new MO.AGetter("_materials"));a._bones=MO.Class.register(a,new MO.AGetter("_bones"));a._textures=MO.Class.register(a,new MO.AGetter("_textures"));a.construct=MO.FE3dRenderable_construct;a.setup=MO.Method.empty;a.testReady=MO.Method.emptyTrue;a.testVisible=MO.FE3dRenderable_testVisible;a.findVertexBuffer=MO.FE3dRenderable_findVertexBuffer;a.pushVertexBuffer=MO.FE3dRenderable_pushVertexBuffer;a.pushIndexBuffer=MO.FE3dRenderable_pushIndexBuffer;a.pushMaterial=MO.FE3dRenderable_pushMaterial;
a.findTexture=MO.FE3dRenderable_findTexture;a.pushTexture=MO.FE3dRenderable_pushTexture;a.processDelay=MO.Method.empty;a.update=MO.FE3dRenderable_update;a.remove=MO.FE3dRenderable_remove;return a};MO.FE3dRenderable_construct=function(){this.__base.FRenderable.construct.call(this);this.__base.MG3dRenderable.construct.call(this);this._outline=new MO.SOutline3d;this._calculateMatrix=new MO.SMatrix3d;this._vertexBuffers=new MO.TDictionary;this._materialReference=this};
MO.FE3dRenderable_testVisible=function(){if(!this.testReady()||!this.__base.FRenderable.testVisible.call(this)||!this._outlineVisible)return!1;var a=this._material;return a&&!a.testVisible()?!1:!0};MO.FE3dRenderable_findVertexBuffer=function(a){return this._vertexBuffers.get(a)};MO.FE3dRenderable_pushVertexBuffer=function(a){var b=a.code();if(MO.Lang.String.isEmpty(b))throw new MO.TError("Buffer code is empty.");var d=this._vertexBuffers;d||(d=this._vertexBuffers=new MO.TDictionary);d.set(b,a)};
MO.FE3dRenderable_pushIndexBuffer=function(a){var b=this._indexBuffers;b||(b=this._indexBuffers=new MO.TObjects);b.push(a)};MO.FE3dRenderable_pushMaterial=function(a){var b=this._materials;b||(b=this._materials=new MO.TObjects);b.push(a)};MO.FE3dRenderable_findTexture=function(a){return this._textures.get(a)};MO.FE3dRenderable_pushTexture=function(a,b){var d=this._textures;d||(d=this._textures=new MO.TDictionary);null!=b?d.set(b,a):a._name?d.set(a._name,a):d.set(a.code(),a)};
MO.FE3dRenderable_update=function(a){var b=this._calculateMatrix;b.assign(this._matrix);var d=this._drawable;d&&b.append(d.currentMatrix());(d=this._display)&&b.append(d.currentMatrix());this._currentMatrix.attachData(b.data())&&a&&a.change()};MO.FE3dRenderable_remove=function(){var a=this._display;a&&(a.removeRenderable(this),this._display=null)};
MO.FE3dStage=function(a){a=MO.Class.inherits(this,a,MO.FStage,MO.MGraphicObject);a._statistics=MO.Class.register(a,new MO.AGetter("_statistics"));a._technique=MO.Class.register(a,new MO.AGetter("_technique"));a._region=MO.Class.register(a,new MO.AGetter("_region"));a._allDisplays=null;a.onProcess=MO.FE3dStage_onProcess;a.construct=MO.FE3dStage_construct;a.createRegion=MO.FE3dStage_createRegion;a.linkGraphicContext=MO.FE3dStage_linkGraphicContext;a.setup=MO.FE3dStage_setup;a.camera=MO.FE3dStage_camera;
a.projection=MO.FE3dStage_projection;a.directionalLight=MO.FE3dStage_directionalLight;a.selectTechnique=MO.FE3dStage_selectTechnique;a.filterDisplays=MO.FE3dStage_filterDisplays;a.allDisplays=MO.FE3dStage_allDisplays;return a};
MO.FE3dStage_onProcess=function(){var a=this._region;if(a){var b=this._technique;if(b){var d=b._graphicContext,e=a._statistics=this._statistics;e.resetFrame();e._frame.begin();e._frameProcess.begin();d.prepare();b.updateRegion(a);a.prepare();a.change();for(var d=this._layers,f=d.count(),h=0;h<f;h++){var k=d.at(h);a.reset();k.process(a);k.filterRenderables(a);a.update()}MO.Console.find(MO.FE3dStageConsole).process(a);e._frameProcess.end();e._frameDraw.begin();a.isChanged()&&b.drawStage(this,a);e._frameDraw.end();
e._frame.end()}}};MO.FE3dStage_construct=function(){this.__base.FStage.construct.call(this);this._statistics=MO.Class.create(MO.FE3dStageStatistics);MO.Console.find(MO.FStatisticsConsole).register("engine.stage",this._statistics);this._allDisplays=new MO.TObjects;(this._region=this.createRegion())._timer=this._timer};MO.FE3dStage_createRegion=function(){return MO.Class.create(MO.FE3dRegion)};
MO.FE3dStage_linkGraphicContext=function(a){this.__base.MGraphicObject.linkGraphicContext.call(this,a);var b=this._region;b&&b.linkGraphicContext(a)};MO.FE3dStage_setup=function(){this.__base.FStage.construct.call(this);this._region.linkGraphicContext(this);this._region.setup()};MO.FE3dStage_camera=function(){return this._region.camera()};MO.FE3dStage_projection=function(){return this._region.camera().projection()};MO.FE3dStage_directionalLight=function(){return this._region.directionalLight()};
MO.FE3dStage_selectTechnique=function(a,b){return this._technique=MO.Console.find(MO.FG3dTechniqueConsole).find(a,b)};MO.FE3dStage_filterDisplays=function(a){for(var b=this._layers,d=b.count(),e=0;e<d;e++)b.at(e).filterDisplays(a)};MO.FE3dStage_allDisplays=function(){var a=this._allDisplays;a.clear();this.filterDisplays(a);return a};
MO.FE3dStageConsole=function(a){a=MO.Class.inherits(this,a,MO.FConsole);a._scopeCd=MO.EScope.Local;a._looper=null;a._thread=null;a._interval=25;a._limit=8;a.onProcess=MO.FE3dStageConsole_onProcess;a.construct=MO.FE3dStageConsole_construct;a.process=MO.FE3dStageConsole_process;return a};MO.FE3dStageConsole_onProcess=function(){var a=this._looper;a.record();for(var b=this._limit-1;0<=b;b--){var d=a.next();if(d)d.processDelay(d._linkRegion);else break}};
MO.FE3dStageConsole_construct=function(){this.__base.FConsole.construct.call(this);this._looper=new MO.TLooper;this._renderables=new MO.TDictionary;var a=this._thread=MO.Class.create(MO.FThread);a.setInterval(this._interval);a.addProcessListener(this,this.onProcess);MO.Console.find(MO.FThreadConsole).start(a)};MO.FE3dStageConsole_process=function(a){for(var b=a.allRenderables(),d=b.count()-1;0<=d;d--){var e=b.at(d);e._linkStageLooper||(e._linkRegion=a,e._linkStageLooper=this._looper,this._looper.push(e))}};
MO.FE3dStageStatistics=function(a){a=MO.Class.inherits(this,a,MO.FStatistics);a._frame=null;a._frameProcess=null;a._frameDraw=null;a._frameDrawSort=null;a._frameDrawRenderable=null;a.construct=MO.FE3dStageStatistics_construct;a.reset=MO.FE3dStageStatistics_reset;a.resetFrame=MO.FE3dStageStatistics_resetFrame;return a};
MO.FE3dStageStatistics_construct=function(){this.__base.FStatistics.construct.call(this);this._frame=new MO.TSpeed;this._frameProcess=new MO.TSpeed;this._frameDraw=new MO.TSpeed;this._frameDrawSort=new MO.TSpeed;this._frameDrawRenderable=new MO.TSpeed};MO.FE3dStageStatistics_reset=function(){};MO.FE3dStageStatistics_resetFrame=function(){this._frame.reset();this._frameProcess.reset();this._frameDraw.reset();this._frameDrawSort.reset();this._frameDrawRenderable.reset()};
MO.FE3dTechnique=function(a){a=MO.Class.inherits(this,a,MO.FG3dTechnique,MO.MLinkerResource);a.drawStage=MO.FE3dTechnique_drawStage;return a};MO.FE3dTechnique_drawStage=function(a,b){var d=a.layers(),e=d.count();b.setTechnique(this);for(var f=this._passes,h=f.count(),k=0;k<h;k++){var q=f.at(k);q.drawBegin(b);for(var w=0;w<e;w++){var x=d.at(w),y=x.technique();y||(y=this);b.reset();b.renderables().assign(x.visibleRenderables());x.optionClearDepth()&&y.clearDepth();b.setTechniquePass(q,k==h-1);q.drawRegion(b)}q.drawEnd(b)}this.present(b)};
MO.RE3dEngine=function(){this._setuped=!1;return this};
MO.RE3dEngine.prototype.onSetup=function(){var a=MO.Console.find(MO.FG3dEffectConsole);a.register("select.select.flat",MO.FG3dSelectAutomaticEffect);a.register("select.select.control",MO.FG3dSelectAutomaticEffect);a.register("select.select.automatic",MO.FG3dSelectAutomaticEffect);a.register("select.select.skeleton",MO.FG3dSelectSkeletonEffect);a.register("select.select.skeleton.4",MO.FG3dSelectSkeletonEffect);a.register("control.control.automatic",MO.FE3dControlAutomaticEffect);a.register("control.control.control",
MO.FE3dControlAutomaticEffect);a.register("general.color.control",MO.FE3dControlAutomaticEffect);a.register("general.color.flat",MO.FE3dGeneralColorFlatEffect);a.register("general.color.fill",MO.FE3dGeneralColorFillEffect);a.register("general.color.automatic",MO.FE3dGeneralColorAutomaticEffect);a.register("general.color.skin",MO.FE3dGeneralColorAutomaticEffect);a.register("general.color.parallax",MO.FE3dGeneralColorAutomaticEffect);a.register("general.color.skeleton",MO.FE3dGeneralColorSkeletonEffect);
a.register("general.color.skeleton.4",MO.FE3dGeneralColorSkeletonEffect);a.register("general.color.fur.skeleton",MO.FE3dGeneralColorSkeletonEffect);a.register("general.color.fur.skeleton.4",MO.FE3dGeneralColorSkeletonEffect);a.register("shadow.depth.automatic",MO.FE3dShadowDepthAutomaticEffect);a.register("shadow.depth.skeleton",MO.FE3dShadowDepthSkeletonEffect);a.register("shadow.color.automatic",MO.FE3dShadowColorAutomaticEffect);a.register("shadow.color.skeleton",MO.FE3dShadowColorSkeletonEffect)};
MO.RE3dEngine.prototype.setup=function(){this._setuped||(this.onSetup(),this._setuped=!0)};MO.RE3dEngine=new MO.RE3dEngine;MO.EE3sResource=new function(){this.Unknown="Unknown";this.Bitmap="Bitmap";this.Material="Material";this.Mesh="Mesh";this.Model="Model";this.Template="Template";this.Scene="Scene";this.Project="Project";this.All="All";return this};
MO.ME3sGeometry=function(a){a=MO.Class.inherits(this,a);a._outline=MO.Class.register(a,new MO.AGetter("_outline"));a._streams=MO.Class.register(a,new MO.AGetter("_streams"));a.construct=MO.ME3sGeometry_construct;a.findStream=MO.ME3sGeometry_findStream;a.calculateOutline=MO.ME3sGeometry_calculateOutline;a.dispose=MO.ME3sGeometry_dispose;return a};MO.ME3sGeometry_construct=function(){this._outline=new MO.SOutline3d};
MO.ME3sGeometry_findStream=function(a){var b=this._streams,d=b.count();for(n=0;n<d;n++){var e=b.getAt(n);if(e.code()==a)return e}return null};MO.ME3sGeometry_calculateOutline=function(){var a=this._outline;if(a.isEmpty()){a.setMin();for(var b=this.findStream("position"),d=b.dataCount(),b=new Float32Array(b.data()),e=0,f=0;f<d;f++){var h=b[e++],k=b[e++],q=b[e++];a.mergePoint(h,k,q)}a.update()}return a};MO.ME3sGeometry_dispose=function(){this._outline=MO.Lang.Object.dispose(this._outline);this.__base.FE3sSpace.dispose.call(this)};
MO.SE3sCompressEvent=function(a,b,d){this.owner=a;this.process=b;this.data=d;return this};MO.SE3sMaterialInfo=function(){MO.SG3dMaterialInfo.call(this);this.unserialize=MO.SE3sMaterialInfo_unserialize;this.saveConfig=MO.SE3sMaterialInfo_saveConfig;return this};
MO.SE3sMaterialInfo_unserialize=function(a){this.effectCode=a.readString();this.optionDepth=a.readBoolean();this.optionDouble=a.readBoolean();this.optionNormalInvert=a.readBoolean();this.optionShadow=a.readBoolean();this.optionShadowSelf=a.readBoolean();this.optionAlpha=a.readBoolean();this.alphaBase=a.readFloat();this.alphaRate=a.readFloat();this.optionColor=a.readBoolean();this.colorMin=a.readFloat();this.colorMax=a.readFloat();this.colorBalance=a.readFloat();this.colorRate=a.readFloat();this.optionVertex=
a.readBoolean();this.vertexColor.unserialize(a);this.optionAmbient=a.readBoolean();this.ambientColor.unserialize(a);this.optionDiffuse=a.readBoolean();this.diffuseColor.unserialize(a);this.optionDiffuseView=a.readBoolean();this.diffuseViewColor.unserialize(a);this.optionSpecular=a.readBoolean();this.specularColor.unserialize(a);this.specularBase=a.readFloat();this.specularLevel=a.readFloat();this.optionSpecularView=a.readBoolean();this.specularViewColor.unserialize(a);this.specularViewBase=a.readFloat();
this.specularViewLevel=a.readFloat();this.optionReflect=a.readBoolean();this.reflectColor.unserialize(a);this.reflectMerge=a.readFloat();this.optionRefract=a.readBoolean();this.refractFrontColor.unserialize(a);this.refractBackColor.unserialize(a);this.optionOpacity=a.readBoolean();this.opacityColor.unserialize(a);this.opacityRate=a.readFloat();this.opacityAlpha=a.readFloat();this.opacityDepth=a.readFloat();this.opacityTransmittance=a.readFloat();this.optionEmissive=a.readBoolean();this.emissiveColor.unserialize(a)};
MO.SE3sMaterialInfo_saveConfig=function(a){a.set("effect_code",this.effectCode);a.setBoolean("option_double",this.optionDouble);a.setBoolean("option_alpha",this.optionAlpha);a.setBoolean("option_normal_invert",this.optionNormalInvert);a.setBoolean("option_shadow",this.optionShadow);a.setBoolean("option_shadow_self",this.optionShadowSelf);var b=a.create("Alpha");b.setBoolean("valid",this.optionAlpha);b.setFloat("base",this.alphaBase);b.setFloat("rate",this.alphaRate);b=a.create("Color");b.setBoolean("valid",
this.optionColor);b.setFloat("min",this.colorMin);b.setFloat("max",this.colorMax);b.setFloat("balance",this.colorBalance);b.setFloat("rate",this.colorRate);b=a.create("Vertex");b.setBoolean("valid",this.optionVertex);this.vertexColor.savePower(b);b=a.create("Ambient");b.setBoolean("valid",this.optionAmbient);this.ambientColor.savePower(b);b=a.create("Diffuse");b.setBoolean("valid",this.optionDiffuse);this.diffuseColor.savePower(b);b=a.create("DiffuseView");b.setBoolean("valid",this.optionDiffuseView);
this.diffuseViewColor.savePower(b);b=a.create("Specular");b.setBoolean("valid",this.optionSpecular);this.specularColor.savePower(b);b.setFloat("base",this.specularBase);b.setFloat("level",this.specularLevel);b=a.create("SpecularView");b.setBoolean("valid",this.optionSpecularView);this.specularViewColor.savePower(b);b.setFloat("base",this.specularViewBase);b.setFloat("level",this.specularViewLevel);b=a.create("Reflect");b.setBoolean("valid",this.optionReflect);this.reflectColor.savePower(b);b.setFloat("merge",
this.reflectMerge);b=a.create("Refract");b.setBoolean("valid",this.optionRefract);this.refractFrontColor.savePower(b.create("Front"));this.refractBackColor.savePower(b.create("Back"));b=a.create("Opacity");b.setBoolean("valid",this.optionOpacity);this.opacityColor.savePower(b);b.setFloat("rate",this.opacityRate);b.setFloat("alpha",this.opacityAlpha);b.setFloat("depth",this.opacityDepth);b.setFloat("transmittance",this.opacityTransmittance);b=a.create("Emissive");b.setBoolean("valid",this.optionEmissive);
this.emissiveColor.savePower(b)};MO.SE3sSceneShadow=function(){this.range=this.level=this.rate=this.base=null;this.unserialize=MO.SE3sSceneShadow_unserialize;return this};MO.SE3sSceneShadow_unserialize=function(a){this.base=a.readFloat();this.rate=a.readFloat();this.level=a.readFloat();this.range=a.readFloat()};
MO.FE3sAnimation=function(a){a=MO.Class.inherits(this,a,MO.FE3sObject);a._model=null;a._skeletonGuid=MO.Class.register(a,new MO.AGetter("_skeletonGuid"));a._skeleton=null;a._frameCount=MO.Class.register(a,new MO.AGetter("_frameCount"),0);a._frameTick=MO.Class.register(a,new MO.AGetter("_frameTick"),0);a._frameSpan=MO.Class.register(a,new MO.AGetter("_frameSpan"),0);a._frameTranslates=null;a._frameRotations=null;a._frameScales=null;a._tracks=MO.Class.register(a,new MO.AGetter("_tracks"));a.skeleton=
MO.FE3sAnimation_skeleton;a.tracks=MO.FE3sAnimation_tracks;a.unserialize=MO.FE3sAnimation_unserialize;return a};MO.FE3sAnimation_skeleton=function(){var a=this._skeleton;if(!a){var b=this._skeletonGuid;b&&(a=this._skeleton=MO.Console.find(MO.FE3sModelConsole).findSkeleton(b))}return a};
MO.FE3sAnimation_unserialize=function(a){this.__base.FE3sObject.unserialize.call(this,a);this._skeletonGuid=a.readString();this._frameCount=a.readUint16();this._frameTick=a.readUint16();this._frameSpan=a.readUint32();var b=a.readUint32(),d=MO.Lang.Integer.strideByte(b);if(0<b)for(var e=this._frameTranslates=new MO.TObjects,f=0;f<b;f++){var h=new MO.SPoint3;h.unserialize(a);e.push(h)}h=a.readUint32();b=MO.Lang.Integer.strideByte(h);if(0<h)for(var k=this._frameRotations=new MO.TObjects,f=0;f<h;f++){var q=
new MO.SQuaternion;q.unserialize(a);k.push(q)}q=a.readUint32();h=MO.Lang.Integer.strideByte(q);if(0<q)for(var w=this._frameScales=new MO.TObjects,f=0;f<q;f++){var x=new MO.SVector3;x.unserialize(a);w.push(x)}q=null;x=a.readUint16();if(0<x)for(var q=this._tracks=new MO.TObjects,y=0;y<x;y++){var z=MO.Class.create(MO.FE3sTrack);z.unserialize(a);q.push(z);for(var A=z._frameCount,z=z._frames,f=0;f<A;f++){var B=MO.Class.create(MO.FE3sFrame),D=0,D=4==d?a.readUint32():2==d?a.readUint16():a.readUint8();B._translation=
e.at(D);D=0;D=4==b?a.readUint32():2==b?a.readUint16():a.readUint8();B._quaternion=k.at(D);D=0;D=4==h?a.readUint32():2==h?a.readUint16():a.readUint8();B._scale=w.at(D);z.push(B)}}if(q&&this._skeletonGuid){a=this.skeleton();for(f=0;f<x;f++)z=q.at(f),d=z.boneIndex(),a.findBone(d).setTrack(z);a.pushAnimation(this)}};
MO.FE3sBone=function(a){a=MO.Class.inherits(this,a,MO.FObject);a._index=MO.Class.register(a,new MO.AGetter("_index"));a._track=MO.Class.register(a,new MO.AGetSet("_track"));a._bones=MO.Class.register(a,new MO.AGetter("_bones"));a.unserialize=MO.FE3sBone_unserialize;return a};MO.FE3sBone_unserialize=function(a){this._index=a.readUint8();var b=a.readUint8();if(0<b)for(var d=this._bones=new MO.TObjects,e=0;e<b;e++){var f=MO.Class.create(MO.FE3sBone);f.unserialize(a);d.push(f)}};
MO.FE3sBoneRefer=function(a){a=MO.Class.inherits(this,a,MO.FObject);a._index=MO.Class.register(a,new MO.AGetter("_index"));a._bone=MO.Class.register(a,new MO.AGetSet("_bone"));a._track=MO.Class.register(a,new MO.AGetSet("_track"));a.unserialize=MO.FE3sBoneRefer_unserialize;return a};MO.FE3sBoneRefer_unserialize=function(a){this._index=a.readUint8()};
MO.FE3sCamera=function(a){a=MO.Class.inherits(this,a,MO.FE3sObject);a._typeCd=MO.Class.register(a,new MO.AGetter("_typeCd"));a._position=MO.Class.register(a,new MO.AGetter("_position"));a._direction=MO.Class.register(a,new MO.AGetter("_direction"));a._projection=MO.Class.register(a,new MO.AGetter("_projection"));a.construct=MO.FE3sCamera_construct;a.unserialize=MO.FE3sCamera_unserialize;a.saveConfig=MO.FE3sCamera_saveConfig;return a};
MO.FE3sCamera_construct=function(){this.__base.FE3sObject.construct.call(this);this._position=new MO.SPoint3;this._direction=new MO.SVector3;this._projection=MO.Class.create(MO.FE3sProjection)};MO.FE3sCamera_unserialize=function(a){this.__base.FE3sObject.unserialize.call(this,a);this._typeCd=a.readString();this._position.unserialize(a);this._direction.unserialize(a);this._projection.unserialize(a)};
MO.FE3sCamera_saveConfig=function(a){this.__base.FE3sObject.saveConfig.call(this,a);a.set("position",this._position.toString());a.set("direction",this._direction.toString());this._projection.saveConfig(a.create("Projection"))};MO.FE3sComponent=function(a){return a=MO.Class.inherits(this,a,MO.FE3sObject)};
MO.FE3sDisplay=function(a){a=MO.Class.inherits(this,a,MO.FE3sDrawable);a._outline=null;a._renderables=MO.Class.register(a,new MO.AGetter("_renderables"));a.construct=MO.FE3sDisplay_construct;a.calculateOutline=MO.FE3sDisplay_calculateOutline;a.unserialize=MO.FE3sDisplay_unserialize;a.saveConfig=MO.FE3sDisplay_saveConfig;a.clone=MO.FE3sDisplay_clone;return a};MO.FE3sDisplay_construct=function(){this.__base.FE3sDrawable.construct.call(this);this._outline=new MO.SOutline3d};
MO.FE3sDisplay_calculateOutline=function(){var a=this._outline;if(a.isEmpty()){var b=this._renderables;if(b){a.setMin();for(var d=b.count(),e=0;e<d;e++){var f=b.at(e).calculateOutline();a.mergeMax(f)}a.update()}}return a};MO.FE3sDisplay_unserialize=function(a){this.__base.FE3sDrawable.unserialize.call(this,a);var b=MO.Console.find(MO.FE3sResourceConsole),d=a.readUint16();if(0<d)for(var e=this._renderables=new MO.TObjects,f=0;f<d;f++){var h=b.unserialize(a);e.push(h)}};
MO.FE3sDisplay_saveConfig=function(a){this.__base.FE3sDrawable.saveConfig.call(this,a);var b=this._renderables;if(b){a=a.create("RenderableCollection");for(var d=b.count(),e=0;e<d;e++)b.at(e).saveConfig(a.create("Renderable"))}};MO.FE3sDisplay_clone=function(a){a=this.__base.FE3sDrawable.clone.call(this,a);a._outline.assign(this._outline);return a};
MO.FE3sDisplayContainer=function(a){a=MO.Class.inherits(this,a,MO.FE3sDisplay);a._displays=MO.Class.register(a,new MO.AGetter("_displays"));a.construct=MO.FE3sDisplayContainer_construct;a.pushDisplay=MO.FE3sDisplayContainer_pushDisplay;a.calculateOutline=MO.FE3sDisplayContainer_calculateOutline;a.unserialize=MO.FE3sDisplayContainer_unserialize;a.saveConfig=MO.FE3sDisplayContainer_saveConfig;a.clone=MO.FE3sDisplayContainer_clone;return a};MO.FE3sDisplayContainer_construct=function(){this.__base.FE3sDisplay.construct.call(this)};
MO.FE3sDisplayContainer_pushDisplay=function(a){var b=this._displays;b||(b=this._displays=new MO.TObjects);a.setParent(this);b.push(a)};MO.FE3sDisplayContainer_calculateOutline=function(){var a=this._outline;if(a.isEmpty()){var b=this._renderables;if(b){a.setMin();for(var d=b.count(),e=0;e<d;e++){var f=b.getAt(e).calculateOutline();a.mergeMax(f)}a.update()}}return a};
MO.FE3sDisplayContainer_unserialize=function(a){this.__base.FE3sDisplay.unserialize.call(this,a);var b=a.readUint16();if(0<b){this._displays=new MO.TObjects;for(var d=0;d<b;d++){var e=MO.Class.create(MO.FE3sSceneDisplay);e.unserialize(a);this.pushDisplay(e)}}};MO.FE3sDisplayContainer_saveConfig=function(a){this.__base.FE3sDisplay.saveConfig.call(this,a);var b=this._displays;if(b){a=a.create("DisplayCollection");for(var d=b.count(),e=0;e<d;e++)b.at(e).saveConfig(a.create("Display"))}};
MO.FE3sDisplayContainer_clone=function(a){return this.__base.FE3sDisplay.clone.call(this,a)};MO.FE3sDisplayLayer=function(a){a=MO.Class.inherits(this,a,MO.FE3sDisplayContainer);a._typeCd=MO.Class.register(a,new MO.AGetSet("_typeCd"));a._transformCd=MO.Class.register(a,new MO.AGetSet("_transformCd"));a.unserialize=MO.FE3sDisplayLayer_unserialize;a.saveConfig=MO.FE3sDisplayLayer_saveConfig;return a};
MO.FE3sDisplayLayer_unserialize=function(a){this.__base.FE3sDisplayContainer.unserialize.call(this,a);this._typeCd=a.readString();this._transformCd=a.readString()};MO.FE3sDisplayLayer_saveConfig=function(a){this.__base.FE3sDisplayContainer.saveConfig.call(this,a);a.set("type_cd",this._typeCd);a.set("transform_cd",this._transformCd)};
MO.FE3sDisplayMaterial=function(a){a=MO.Class.inherits(this,a,MO.FObject);a._groupGuid=MO.Class.register(a,new MO.AGetter("_groupGuid"));a._material=MO.Class.register(a,new MO.AGetter("_material"));a.unserialize=MO.FE3sDisplayMaterial_unserialize;return a};MO.FE3sDisplayMaterial_unserialize=function(a){this._groupGuid=a.readString();this._material=this._template._activeTheme.findMaterial(this._groupGuid)};
MO.FE3sDrawable=function(a){a=MO.Class.inherits(this,a,MO.FE3sComponent);a._matrix=MO.Class.register(a,new MO.AGetter("_matrix"));a.construct=MO.FE3sDrawable_construct;a.matrix=MO.FE3sDrawable_matrix;a.unserialize=MO.FE3sDrawable_unserialize;a.saveConfig=MO.FE3sDrawable_saveConfig;a.clone=MO.FE3sDrawable_clone;return a};MO.FE3sDrawable_construct=function(){this.__base.FE3sComponent.construct.call(this);this._matrix=new MO.SMatrix3d};
MO.FE3sDrawable_unserialize=function(a){this.__base.FE3sComponent.unserialize.call(this,a);this._matrix.unserialize(a)};MO.FE3sDrawable_saveConfig=function(a){this.__base.FE3sComponent.saveConfig.call(this,a);this._matrix.saveConfig(a.create("Matrix"))};MO.FE3sDrawable_clone=function(a){a=this.__base.FE3sComponent.clone.call(this,a);a._matrix.assign(this._matrix);return a};
MO.FE3sFrame=function(a){a=MO.Class.inherits(this,a,MO.FObject);a._tick=MO.Class.register(a,new MO.AGetter("_tick"));a._translation=MO.Class.register(a,new MO.AGetter("_translation"));a._quaternion=MO.Class.register(a,new MO.AGetter("_quaternion"));a._scale=MO.Class.register(a,new MO.AGetter("_scale"));return a};
MO.FE3sGeometry=function(a){a=MO.Class.inherits(this,a,MO.FE3sRenderable,MO.ME3sGeometry);a.construct=MO.FE3sGeometry_construct;a.unserialize=MO.FE3sGeometry_unserialize;a.dispose=MO.FE3sGeometry_dispose;return a};MO.FE3sGeometry_construct=function(){this.__base.FE3sRenderable.construct.call(this);this.__base.ME3sGeometry.construct.call(this)};
MO.FE3sGeometry_unserialize=function(a){this.__base.FE3sRenderable.unserialize.call(this,a);var b=this._outline;b.unserialize(a);var d=a.readInt8();if(0<d)for(var e=this._streams=new MO.TObjects,f=0;f<d;f++){var h=MO.Class.create(MO.FE3sStream);h.unserialize(a);e.push(h)}b.isEmpty()&&this.calculateOutline();b.update()};MO.FE3sGeometry_dispose=function(){this.__base.ME3sGeometry.dispose.call(this);this.__base.FE3sRenderable.dispose.call(this)};
MO.FE3sLight=function(a){a=MO.Class.inherits(this,a,MO.FE3sObject);a._typeName=MO.Class.register(a,new MO.AGetter("_typeName"));a._material=MO.Class.register(a,new MO.AGetter("_material"));a._camera=MO.Class.register(a,new MO.AGetter("_camera"));a.construct=MO.FE3sLight_construct;a.unserialize=MO.FE3sLight_unserialize;return a};MO.FE3sLight_construct=function(){this.__base.FE3sObject.construct.call(this);this._material=MO.Class.create(MO.FE3sMaterial);this._camera=MO.Class.create(MO.FE3sCamera)};
MO.FE3sLight_unserialize=function(a){this.__base.FE3sObject.unserialize.call(this,a);this._typeName=a.readString();this._material.unserialize(a);this._camera.unserialize(a)};
MO.FE3sMaterial=function(a){a=MO.Class.inherits(this,a,MO.FE3sObject);a._parentGuid=MO.Class.register(a,new MO.AGetter("_parentGuid"));a._info=MO.Class.register(a,new MO.AGetter("_info"));a._bitmaps=MO.Class.register(a,new MO.AGetter("_bitmaps"));a._bitmapPacks=MO.Class.register(a,new MO.AGetter("_bitmapPacks"));a.construct=MO.FE3sMaterial_construct;a.effectCode=MO.FE3sMaterial_effectCode;a.unserialize=MO.FE3sMaterial_unserialize;a.saveConfig=MO.FE3sMaterial_saveConfig;a.clone=MO.FE3sMaterial_clone;
return a};MO.FE3sMaterial_construct=function(){this.__base.FE3sObject.construct.call(this);this._info=new MO.SE3sMaterialInfo};MO.FE3sMaterial_effectCode=function(){return this._info.effectCode};
MO.FE3sMaterial_unserialize=function(a){this.__base.FE3sObject.unserialize.call(this,a);this._parentGuid=a.readString();this._info.unserialize(a);var b=a.readInt16();if(0<b)for(var d=this._bitmapPacks=new MO.TDictionary,e=0;e<b;e++){var f=MO.Class.create(MO.FE3sMaterialBitmapPack);f.unserialize(a);d.set(f.guid(),f)}b=a.readInt16();if(0<b)for(f=this._bitmaps=new MO.TObjects,e=0;e<b;e++){var h=MO.Class.create(MO.FE3sMaterialBitmap);h.unserialize(a);f.push(h);var k=d.get(h.bitmapPackGuid());h.setBitmapPack(k)}};
MO.FE3sMaterial_saveConfig=function(a){this.__base.FE3sObject.saveConfig.call(this,a);a.set("parent_guid",this._parentGuid);this._info.saveConfig(a)};MO.FE3sMaterial_clone=function(a){a=this.__base.FE3sObject.clone.call(this,a);a._parentGuid=this._parentGuid;a._info.assign(this._info);return a};
MO.FE3sMaterialBitmap=function(a){a=MO.Class.inherits(this,a,MO.FE3sObject);a._bitmapPackGuid=MO.Class.register(a,new MO.AGetter("_bitmapPackGuid"));a._bitmapPack=MO.Class.register(a,new MO.AGetSet("_bitmapPack"));a._bitmapGuid=MO.Class.register(a,new MO.AGetter("_bitmapGuid"));a._index=0;a.unserialize=MO.FE3sMaterialBitmap_unserialize;return a};
MO.FE3sMaterialBitmap_unserialize=function(a){this.__base.FE3sObject.unserialize.call(this,a);this._bitmapPackGuid=a.readString();this._bitmapGuid=a.readString();this._index=a.readUint16()};
MO.FE3sMaterialBitmapPack=function(a){a=MO.Class.inherits(this,a,MO.FE3sObject);a._typeName=MO.Class.register(a,new MO.AGetter("_typeName"));a._formatName=MO.Class.register(a,new MO.AGetter("_formatName"));a._size=MO.Class.register(a,new MO.AGetter("_size"));a.construct=MO.FE3sMaterialBitmapPack_construct;a.unserialize=MO.FE3sMaterialBitmapPack_unserialize;a.dispose=MO.FE3sMaterialBitmapPack_dispose;return a};
MO.FE3sMaterialBitmapPack_construct=function(){this.__base.FE3sObject.construct.call(this);this._size=new MO.SSize2};MO.FE3sMaterialBitmapPack_unserialize=function(a){this.__base.FE3sObject.unserialize.call(this,a);this._typeName=a.readString();this._formatName=a.readString();this._size.unserialize(a,MO.EDataType.Uint16)};MO.FE3sMaterialBitmapPack_dispose=function(){this._size=MO.Lang.Object.dispose(this._size);this.__base.FE3sObject.dispose.call(this)};
MO.FE3sMaterialConsole=function(a){a=MO.Class.inherits(this,a,MO.FConsole);a._resources=null;a._materials=null;a.construct=MO.FE3sMaterialConsole_construct;a.find=MO.FE3sMaterialConsole_find;a.unserialize=MO.FE3sMaterialConsole_unserialize;a.loadByGuid=MO.FE3sMaterialConsole_loadByGuid;a.dispose=MO.FE3sMaterialConsole_dispose;return a};MO.FE3sMaterialConsole_construct=function(){this.__base.FConsole.construct.call(this);this._resources=new MO.TDictionary;this._materials=new MO.TDictionary};
MO.FE3sMaterialConsole_find=function(a){return this._materials.get(a)};MO.FE3sMaterialConsole_unserialize=function(a){var b=MO.Class.create(MO.FE3sMaterial);b.unserialize(a);a=b.guid();if(this._materials.contains(a))throw new MO.TError(this,"Material is already exists.");this._materials.set(a,b);return b};
MO.FE3sMaterialConsole_loadByGuid=function(a){var b=this._resources,d=b.get(a);if(d)return d;var e=MO.Console.find(MO.FE3sVendorConsole).find("material");e.set("guid",a);var f=e.makeUrl(),d=MO.Class.create(MO.FE3sMaterialResource);d.setGuid(a);d.setVendor(e);d.setSourceUrl(f);MO.Console.find(MO.FResourceConsole).load(d);b.set(a,d);return d};MO.FE3sMaterialConsole_dispose=function(){this._resources=MO.Lang.Object.free(this._resources);this._materials=MO.Lang.Object.free(this._materials);this.__base.FConsole.dispose.call(this)};
MO.FE3sMaterialRefer=function(a){return a=MO.Class.inherits(this,a,MO.FE3sObject)};MO.FE3sMaterialResource=function(a){a=MO.Class.inherits(this,a,MO.FE3sResource);a._typeName="Material";a._dataCompress=!0;a._material=MO.Class.register(a,new MO.AGetter("_material"));a.unserialize=MO.FE3sMaterialResource_unserialize;return a};
MO.FE3sMaterialResource_unserialize=function(a){this.__base.FE3sResource.unserialize.call(this,a);this._material=MO.Console.find(MO.FE3sMaterialConsole).unserialize(a);MO.Logger.info(this,"Unserialize material success. (guid={1}, code={2})",this._guid,this._code)};
MO.FE3sMesh=function(a){a=MO.Class.inherits(this,a,MO.FE3sSpace,MO.ME3sGeometry);a._dataCompress=!0;a._typeName="Mesh";a._display=null;a._renderable=null;a.construct=MO.FE3sMesh_construct;a.unserialize=MO.FE3sMesh_unserialize;a.saveConfig=MO.FE3sMesh_saveConfig;a.dispose=MO.FE3sMesh_dispose;return a};MO.FE3sMesh_construct=function(){this.__base.FE3sSpace.construct.call(this);this.__base.ME3sGeometry.construct.call(this);this._display=MO.Class.create(MO.FE3sMeshDisplay)};
MO.FE3sMesh_unserialize=function(a){this.__base.FE3sSpace.unserialize.call(this,a);this._outline.unserialize(a);this._outline.update();var b=a.readInt8();if(0<b)for(var d=this._streams=new MO.TObjects,e=0;e<b;e++){var f=MO.Class.create(MO.FE3sStream);f.unserialize(a);d.push(f)}this._display.unserialize(a);this._renderable=this._display._renderable};MO.FE3sMesh_saveConfig=function(a){this.__base.FE3sSpace.saveConfig.call(this,a);this._display.saveConfig(a.create("Display"))};
MO.FE3sMesh_dispose=function(){this._outline=MO.Lang.Object.dispose(this._outline);this._display=MO.Lang.Object.dispose(this._display);this.__base.ME3sGeometry.dispose.call(this);this.__base.FE3sSpace.dispose.call(this)};
MO.FE3sMeshConsole=function(a){a=MO.Class.inherits(this,a,MO.FConsole);a._venderCode="mesh";a._serviceUrl="/cloud.content.mesh.ws";a._dataUrl="/cloud.content.mesh.wv";a._meshs=MO.Class.register(a,new MO.AGetter("_meshs"));a.construct=MO.FE3sMeshConsole_construct;a.find=MO.FE3sMeshConsole_find;a.loadByGuid=MO.FE3sMeshConsole_loadByGuid;a.loadByCode=MO.FE3sMeshConsole_loadByCode;a.dispose=MO.FE3sMeshConsole_dispose;return a};
MO.FE3sMeshConsole_construct=function(){this.__base.FConsole.construct.call(this);this._meshs=new MO.TDictionary};MO.FE3sMeshConsole_find=function(a){return this._meshs.get(a)};MO.FE3sMeshConsole_loadByGuid=function(a){var b=this._meshs,d=b.get(a);if(d)return d;var e=MO.Console.find(MO.FE3sVendorConsole).find(this._venderCode);e.set("guid",a);var f=e.makeUrl(),d=MO.Class.create(MO.FE3sMesh);d.setGuid(a);d.setVendor(e);d.setSourceUrl(f);MO.Console.find(MO.FResourceConsole).load(d);b.set(a,d);return d};
MO.FE3sMeshConsole_loadByCode=function(a){var b=this._meshs,d=b.get(a);if(d)return d;var e=MO.Console.find(MO.FE3sVendorConsole).find(this._venderCode);e.set("code",a);var f=e.makeUrl(),d=MO.Class.create(MO.FE3sMesh);d.setGuid(a);d.setVendor(e);d.setSourceUrl(f);MO.Console.find(MO.FResourceConsole).load(d);b.set(a,d);return d};MO.FE3sMeshConsole_dispose=function(){this._meshs=MO.Lang.Object.free(this._meshs);this.__base.FConsole.dispose.call(this)};
MO.FE3sMeshDisplay=function(a){a=MO.Class.inherits(this,a,MO.FE3sObject);a._matrix=MO.Class.register(a,new MO.AGetter("_matrix"));a._material=MO.Class.register(a,new MO.AGetter("_material"));a._renderable=MO.Class.register(a,new MO.AGetter("_renderable"));a.construct=MO.FE3sMeshDisplay_construct;a.unserialize=MO.FE3sMeshDisplay_unserialize;a.saveConfig=MO.FE3sMeshDisplay_saveConfig;return a};
MO.FE3sMeshDisplay_construct=function(){this.__base.FE3sObject.construct.call(this);this._matrix=new MO.SMatrix3d;this._material=MO.Class.create(MO.FE3sMaterial);this._renderable=MO.Class.create(MO.FE3sRenderable)};MO.FE3sMeshDisplay_unserialize=function(a){this.__base.FE3sObject.unserialize.call(this,a);this._matrix.unserialize(a);this._material.unserialize(a);this._renderable.unserialize(a)};
MO.FE3sMeshDisplay_saveConfig=function(a){this.__base.FE3sObject.saveConfig.call(this,a);this._matrix.saveConfig(a.create("Matrix"));this._material.saveConfig(a.create("Material"));this._renderable.saveConfig(a.create("Renderable"))};
MO.FE3sModel=function(a){a=MO.Class.inherits(this,a,MO.FE3sSpace);a._typeName="Model";a._dataCompress=!0;a._dataBlock=!0;a._meshes=MO.Class.register(a,new MO.AGetter("_meshes"));a._skeletons=MO.Class.register(a,new MO.AGetter("_skeletons"));a._animations=MO.Class.register(a,new MO.AGetter("_animations"));a._display=MO.Class.register(a,new MO.AGetter("_display"));a.construct=MO.FE3sModel_construct;a.findMeshByCode=MO.FE3sModel_findMeshByCode;a.unserialize=MO.FE3sModel_unserialize;a.saveConfig=MO.FE3sModel_saveConfig;
return a};MO.FE3sModel_construct=function(){this.__base.FE3sSpace.construct.call(this);(this._display=MO.Class.create(MO.FE3sModelDisplay))._model=this};MO.FE3sModel_findMeshByCode=function(a){for(var b=this._meshes,d=b.count()-1;0<=d;d--){var e=b.at(d);if(e._code==a)return e}return null};
MO.FE3sModel_unserialize=function(a){this.__base.FE3sSpace.unserialize.call(this,a);var b=MO.Console.find(MO.FE3sModelConsole);b.models().set(this.guid(),this);var d=a.readInt16();if(0<d)for(var e=this._meshes=new MO.TDictionary,f=0;f<d;f++){var h=b.unserialMesh(a),k=h.guid();e.set(k,h)}h=a.readInt16();if(0<h)for(k=this._skeletons=new MO.TObjects,f=0;f<h;f++)d=b.unserialSkeleton(a),k.push(d);h=a.readInt16();if(0<h)for(k=this._animations=new MO.TObjects,f=0;f<h;f++)d=b.unserialAnimation(this,a),k.push(d);
f=this._display;f.unserialize(a);if(a=f.renderables())for(b=a.count(),f=0;f<b;f++)d=a.get(f),k=d.meshGuid(),h=e.get(k),d.setMesh(h);MO.Logger.info(this,"Unserialize model success. (guid={1}, code={2})",this._guid,this._code)};MO.FE3sModel_saveConfig=function(a){this.__base.FE3sSpace.saveConfig.call(this,a);this._display.saveConfig(a.create("Display"))};
MO.FE3sModelConsole=function(a){a=MO.Class.inherits(this,a,MO.FConsole);a._models=MO.Class.register(a,new MO.AGetter("_models"));a._meshs=MO.Class.register(a,new MO.AGetter("_meshs"));a._skeletons=MO.Class.register(a,new MO.AGetter("_skeletons"));a._animations=MO.Class.register(a,new MO.AGetter("_animations"));a.construct=MO.FE3sModelConsole_construct;a.findModel=MO.FE3sModelConsole_findModel;a.findMesh=MO.FE3sModelConsole_findMesh;a.findSkeleton=MO.FE3sModelConsole_findSkeleton;a.findAnimation=MO.FE3sModelConsole_findAnimation;
a.unserialMesh=MO.FE3sModelConsole_unserialMesh;a.unserialSkeleton=MO.FE3sModelConsole_unserialSkeleton;a.unserialAnimation=MO.FE3sModelConsole_unserialAnimation;a.load=MO.FE3sModelConsole_load;a.dispose=MO.FE3sModelConsole_dispose;return a};
MO.FE3sModelConsole_construct=function(){this.__base.FConsole.construct.call(this);this._models=new MO.TDictionary;this._meshs=new MO.TDictionary;this._skeletons=new MO.TDictionary;this._animations=new MO.TDictionary;var a=MO.Console.find(MO.FResourceConsole),b=MO.Class.create(MO.FResourcePipeline),d=MO.Class.create(MO.FResourceType);d.setCode("resource3d.model");d._pipeline=b;a.registerType(d)};MO.FE3sModelConsole_findModel=function(a){return this._models.get(a)};MO.FE3sModelConsole_findMesh=function(a){return this._meshs.get(a)};
MO.FE3sModelConsole_findSkeleton=function(a){return this._skeletons.get(a)};MO.FE3sModelConsole_findAnimation=function(a){return this._animations.get(a)};MO.FE3sModelConsole_unserialMesh=function(a){var b=MO.Class.create(MO.FE3sModelMesh);b.unserialize(a);this._meshs.set(b.guid(),b);return b};MO.FE3sModelConsole_unserialSkeleton=function(a){var b=MO.Class.create(MO.FE3sSkeleton);b.unserialize(a);this._skeletons.set(b.guid(),b);return b};
MO.FE3sModelConsole_unserialAnimation=function(a,b){var d=MO.Class.create(MO.FE3sAnimation);d._model=a;d.unserialize(b);this._animations.set(d.guid(),d);return d};MO.FE3sModelConsole_load=function(a){var b=this._models,d=b.get(a);if(d)return d;var e=MO.Console.find(MO.FE3sVendorConsole).find("model");e.set("guid",a);var f=e.makeUrl(),d=MO.Class.create(MO.FE3sModel);d.setGuid(a);d.setVendor(e);d.setSourceUrl(f);MO.Console.find(MO.FResourceConsole).load(d);b.set(a,d);return d};
MO.FE3sModelConsole_dispose=function(){this._materials=MO.Lang.Object.free(this._materials);this.__base.FConsole.dispose.call(this)};MO.FE3sModelDisplay=function(a){a=MO.Class.inherits(this,a,MO.FE3sDisplay);a._model=null;a._material=null;a.construct=MO.FE3sModelDisplay_construct;a.material=MO.FE3sModelDisplay_material;a.calculateOutline=MO.FE3sModelDisplay_calculateOutline;a.unserialize=MO.FE3sModelDisplay_unserialize;a.saveConfig=MO.FE3sModelDisplay_saveConfig;return a};
MO.FE3sModelDisplay_construct=function(){this.__base.FE3sDisplay.construct.call(this);this._material=MO.Class.create(MO.FE3sMaterial)};MO.FE3sModelDisplay_material=function(){return this._material};MO.FE3sModelDisplay_calculateOutline=function(){var a=this._outline;if(a.isEmpty()){var b=this._model.meshes();if(b){a.setMin();for(var d=b.count(),e=0;e<d;e++){var f=b.at(e).calculateOutline();a.mergeMax(f)}a.update()}}return a};
MO.FE3sModelDisplay_unserialize=function(a){this.__base.FE3sDisplay.unserialize.call(this,a);this._material.unserialize(a)};MO.FE3sModelDisplay_saveConfig=function(a){this.__base.FE3sDisplay.saveConfig.call(this,a);this._material.saveConfig(a.create("Material"))};MO.FE3sModelMesh=function(a){return a=MO.Class.inherits(this,a,MO.FE3sGeometry)};
MO.FE3sModelRenderable=function(a){a=MO.Class.inherits(this,a,MO.FE3sRenderable);a._meshGuid=MO.Class.register(a,new MO.AGetter("_meshGuid"));a._mesh=MO.Class.register(a,new MO.AGetSet("_mesh"));a.construct=MO.FE3sModelRenderable_construct;a.unserialize=MO.FE3sModelRenderable_unserialize;a.saveConfig=MO.FE3sModelRenderable_saveConfig;return a};MO.FE3sModelRenderable_construct=function(){this.__base.FE3sRenderable.construct.call(this)};
MO.FE3sModelRenderable_unserialize=function(a){this.__base.FE3sRenderable.unserialize.call(this,a);this._meshGuid=a.readString()};MO.FE3sModelRenderable_saveConfig=function(a){this.__base.FE3sRenderable.saveConfig.call(this,a);a.set("mesh_guid",this._meshGuid)};
MO.FE3sMovie=function(a){a=MO.Class.inherits(this,a,MO.FE3sObject);a._interval=MO.Class.register(a,new MO.AGetSet("_interval"));a._rotation=MO.Class.register(a,new MO.AGetter("_rotation"));a.construct=MO.FE3sMovie_construct;a.unserialize=MO.FE3sMovie_unserialize;a.saveConfig=MO.FE3sMovie_saveConfig;a.dispose=MO.FE3sMovie_dispose;return a};MO.FE3sMovie_construct=function(){this.__base.FE3sObject.construct.call(this);this._rotation=new MO.SVector3};
MO.FE3sMovie_unserialize=function(a){this.__base.FE3sObject.unserialize.call(this,a);this._interval=a.readInt32();this._rotation.unserialize(a)};MO.FE3sMovie_saveConfig=function(a){this.__base.FE3sObject.saveConfig.call(this,a);a.set("interval",this._interval);a.set("rotation",this._rotation)};MO.FE3sMovie_dispose=function(){this._rotation=MO.Lang.Object.dispose(this._rotation);this.__base.FE3sObject.disposet.call(this)};
MO.FE3sObject=function(a){a=MO.Class.inherits(this,a,MO.FObject,MO.MParent);a._typeName=null;a._guid=MO.Class.register(a,new MO.AGetSet("_guid"));a._code=MO.Class.register(a,new MO.AGetSet("_code"));a._label=MO.Class.register(a,new MO.AGetSet("_label"));a._isClone=!1;a.makeLabel=MO.FE3sObject_makeLabel;a.unserialize=MO.FE3sObject_unserialize;a.saveConfig=MO.FE3sObject_saveConfig;a.clone=MO.FE3sObject_clone;a.dispose=MO.FE3sObject_dispose;return a};
MO.FE3sObject_makeLabel=function(){var a="";MO.Lang.String.isEmpty(this._code)||(a+=this._code);MO.Lang.String.isEmpty(this._label)||(a+=" ["+this._label+"]");return a};MO.FE3sObject_unserialize=function(a){this._typeName=a.readString();this._guid=a.readString();this._code=a.readString();this._label=a.readString()};
MO.FE3sObject_saveConfig=function(a){MO.Lang.String.isEmpty(this._typeName)||a.setName(this._typeName);a.set("guid",this._guid);a.set("code",this._code);a.set("label",this._label);this._isClone&&a.set("is_clone","Y")};MO.FE3sObject_clone=function(a){var b=null,b=a?a:MO.Class.create(this.constructor);b._isClone=!0;b._typeName=this._typeName;b._guid=this._guid;b._code=this._code;b._label=this._label;return b};MO.FE3sObject_dispose=function(){this.__base.MAttributeParent.dispose.call(this);this.__base.FComponent.dispose.call(this)};
MO.FE3sProjection=function(a){a=MO.Class.inherits(this,a,MO.FE3sObject);a._angle=MO.Class.register(a,MO.AGetter("_angle"),90);a._znear=MO.Class.register(a,MO.AGetter("_znear"),1);a._zfar=MO.Class.register(a,MO.AGetter("_zfar"),200);a.unserialize=MO.FE3sProjection_unserialize;a.saveConfig=MO.FE3sProjection_saveConfig;return a};MO.FE3sProjection_unserialize=function(a){this.__base.FE3sObject.unserialize.call(this,a);this._angle=a.readFloat();this._znear=a.readFloat();this._zfar=a.readFloat()};
MO.FE3sProjection_saveConfig=function(a){this.__base.FE3sObject.saveConfig.call(this,a);a.setFloat("angle",this._angle);a.setFloat("znear",this._znear);a.setFloat("zfar",this._zfar)};
MO.FE3sRegion=function(a){a=MO.Class.inherits(this,a,MO.FE3sObject);a._optionBackground=MO.Class.register(a,new MO.AGetSet("_optionBackground"),!0);a._backgroundColor=MO.Class.register(a,new MO.AGetter("_backgroundColor"));a._moveSpeed=MO.Class.register(a,new MO.AGetSet("_moveSpeed"),.1);a._rotationKeySpeed=MO.Class.register(a,new MO.AGetSet("_rotationKeySpeed"),.005);a._rotationMouseSpeed=MO.Class.register(a,new MO.AGetSet("_rotationMouseSpeed"),.003);a._material=null;a._camera=MO.Class.register(a,
new MO.AGetter("_camera"));a._light=MO.Class.register(a,new MO.AGetter("_light"));a.construct=MO.FE3sRegion_construct;a.unserialize=MO.FE3sRegion_unserialize;a.saveConfig=MO.FE3sRegion_saveConfig;return a};MO.FE3sRegion_construct=function(){this.__base.FE3sObject.construct.call(this);this._backgroundColor=new MO.SColor4;this._material=MO.Class.create(MO.FE3sMaterial);this._camera=MO.Class.create(MO.FE3sCamera);this._light=MO.Class.create(MO.FE3sLight)};
MO.FE3sRegion_unserialize=function(a){this.__base.FE3sObject.unserialize.call(this,a);this._backgroundColor.unserialize(a);this._moveSpeed=a.readFloat();this._rotationKeySpeed=a.readFloat();this._rotationMouseSpeed=a.readFloat();this._material.unserialize(a);this._camera.unserialize(a);this._light.unserialize(a)};
MO.FE3sRegion_saveConfig=function(a){this.__base.FE3sObject.saveConfig.call(this,a);a.set("color",this._backgroundColor.toString());a.setFloat("move_speed",this._moveSpeed);a.setFloat("rotation_key_speed",this._rotationKeySpeed);a.setFloat("rotation_mouse_speed",this._rotationMouseSpeed);this._camera.saveConfig(a.create("Camera"))};
MO.FE3sRenderable=function(a){a=MO.Class.inherits(this,a,MO.FE3sDrawable);a._materialRefers=MO.Class.register(a,new MO.AGetter("_materialRefers"));a.construct=MO.FE3sRenderable_construct;a.syncMaterialRefer=MO.FE3sRenderable_syncMaterialRefer;a.pushMaterialRefer=MO.FE3sRenderable_pushMaterialRefer;a.unserialize=MO.FE3sRenderable_unserialize;a.saveConfig=MO.FE3sRenderable_saveConfig;a.clone=MO.FE3sRenderable_clone;return a};MO.FE3sRenderable_construct=function(){this.__base.FE3sDrawable.construct.call(this)};
MO.FE3sRenderable_syncMaterialRefer=function(a){var b=this._materialRefers;b||(b=this._materialRefers=new MO.TObjects);for(var d=b.count();d<=a;d++)b.push(MO.Class.create(MO.FE3sMaterialRefer));return b.at(a)};MO.FE3sRenderable_pushMaterialRefer=function(a){var b=this._materialRefers;b||(b=this._materialRefers=new MO.Objects);b.push(a)};
MO.FE3sRenderable_unserialize=function(a){this.__base.FE3sDrawable.unserialize.call(this,a);var b=a.readUint16();if(0<b)for(var d=0;d<b;d++){var e=MO.Class.create(MO.FE3sMaterialRefer);e.unserialize(a);this.pushMaterialRefer(e)}};MO.FE3sRenderable_saveConfig=function(a){this.__base.FE3sDrawable.saveConfig.call(this,a);var b=this._materialRefers;if(b){var d=b.count();a=a.create("MaterialReferCollection");for(var e=0;e<d;e++)b.at(e).saveConfig(a.create("MaterialRefer"))}};
MO.FE3sRenderable_clone=function(a){a=this.__base.FE3sDrawable.clone.call(this,a);var b=this._materialRefers;if(b)for(var d=b.count(),e=0;e<d;e++){var f=b.at(e);a.pushMaterialRefer(f.clone())}return a};
MO.FE3sResource=function(a){a=MO.Class.inherits(this,a,MO.FResource,MO.MListener);a._dataLoad=!1;a._dataReady=!1;a._dataSize=0;a._blockSize=0;a._blockCount=0;a._vendor=MO.Class.register(a,new MO.AGetSet("_vendor"));a._loadListeners=MO.Class.register(a,new MO.AListener("_loadListeners",MO.EEvent.Load));a.onComplete=MO.FE3sResource_onComplete;a.makeLabel=MO.FE3sResource_makeLabel;a.testReady=MO.FE3sResource_testReady;a.unserialize=MO.FE3sResource_unserialize;a.saveConfig=MO.FE3sResource_saveConfig;
a.dispose=MO.FE3sResource_dispose;return a};MO.FE3sResource_onComplete=function(a){if(MO.Class.isClass(a,MO.MDataStream))this.unserialize(a);else{var b=MO.Class.create(MO.FDataView);b.setEndianCd(!0);a.constructor==Array?(a=new Uint8Array(a),b.link(a.buffer)):a.constructor==Uint8Array?b.link(a.buffer):b.link(a.outputData());this.unserialize(b);b.dispose()}this._dataReady=!0;this.processLoadListener()};
MO.FE3sResource_makeLabel=function(){var a="";MO.Lang.String.isEmpty(this._code)||(a+=this._code);MO.Lang.String.isEmpty(this._label)||(a+=" ["+this._label+"]");return a};MO.FE3sResource_testReady=function(){return this._dataReady};MO.FE3sResource_unserialize=function(a){this._typeName=a.readString();this._guid=a.readString();this._code=a.readString();this._label=a.readString()};
MO.FE3sResource_saveConfig=function(a){MO.Lang.String.isEmpty(this._typeName)||a.setName(this._typeName);a.set("guid",this._guid);a.set("code",this._code);a.set("label",this._label)};MO.FE3sResource_dispose=function(){this._vendor=null;this.__base.MListener.dispose.call(this);this.__base.FConsole.dispose.call(this)};
MO.FE3sResourceConsole=function(a){a=MO.Class.inherits(this,a,MO.FConsole);a._factory=MO.Class.register(a,new MO.AGetter("_factory"));a.construct=MO.FE3sResourceConsole_construct;a.create=MO.FE3sResourceConsole_create;a.unserializeResource=MO.FE3sResourceConsole_unserializeResource;a.unserialize=MO.FE3sResourceConsole_unserialize;return a};
MO.FE3sResourceConsole_construct=function(){this.__base.FConsole.construct.call(this);var a=this._factory=MO.Class.create(MO.FClassFactory);a.register("Shape",MO.FE3sShape);a.register("Sprite",MO.FE3sSprite);a.register("ModelMesh",MO.FE3sModelMesh);a.register("ModelRenderable",MO.FE3sModelRenderable)};MO.FE3sResourceConsole_create=function(a){return this._factory.create(a)};MO.FE3sResourceConsole_unserializeResource=function(a,b){a.unserialize(b)};
MO.FE3sResourceConsole_unserialize=function(a){var b=a.testString(),b=this._factory.create(b);b.unserialize(a);return b};MO.FE3sScene=function(a){a=MO.Class.inherits(this,a,MO.FE3sSpace);a._typeName="Scene";a._dataCompress=!0;a._templates=null;a.construct=MO.FE3sScene_construct;a.unserialize=MO.FE3sScene_unserialize;a.saveConfig=MO.FE3sScene_saveConfig;return a};MO.FE3sScene_construct=function(){this.__base.FE3sSpace.construct.call(this)};
MO.FE3sScene_unserialize=function(a){this.__base.FE3sSpace.unserialize.call(this,a);a=a.readInt16();if(0<a)for(var b=MO.Console.find(MO.FE3sTemplateConsole),d=this._templates=new MO.TDictionary,e=0;e<a;e++){var f=b.unserialize(p);d.set(ttemplate.guid(),f)}};MO.FE3sScene_saveConfig=function(a){this.__base.FE3sSpace.saveConfig.call(this,a)};
MO.FE3sSceneAnimation=function(a){a=MO.Class.inherits(this,a,MO.FE3sObject);a._playRate=MO.Class.register(a,new MO.AGetSet("_playRate"),1);a.construct=MO.FE3sSceneAnimation_construct;a.unserialize=MO.FE3sSceneAnimation_unserialize;a.saveConfig=MO.FE3sSceneAnimation_saveConfig;return a};MO.FE3sSceneAnimation_construct=function(){this.__base.FE3sObject.construct.call(this)};MO.FE3sSceneAnimation_unserialize=function(a){this.__base.FE3sObject.unserialize.call(this,a);this._playRate=a.readFloat()};
MO.FE3sSceneAnimation_saveConfig=function(a){this.__base.FE3sObject.saveConfig.call(this,a);a.set("play_rate",this._playRate)};MO.FE3sSceneConsole=function(a){a=MO.Class.inherits(this,a,MO.FConsole);a._vendorCode="scene";a._dataUrl="/cloud.content.scene.wv";a._scenes=null;a.construct=MO.FE3sSceneConsole_construct;a.loadByGuid=MO.FE3sSceneConsole_loadByGuid;a.loadByCode=MO.FE3sSceneConsole_loadByCode;return a};
MO.FE3sSceneConsole_construct=function(){this.__base.FConsole.construct.call(this);this._scenes=new MO.TDictionary};MO.FE3sSceneConsole_loadByGuid=function(a){var b=this._scenes,d=b.get(a);if(d)return d;var e=MO.Console.find(MO.FE3sVendorConsole).find(this._vendorCode);e.set("guid",a);var f=e.makeUrl(),d=MO.Class.create(MO.FE3sScene);d.setGuid(a);d.setVendor(e);d.setSourceUrl(f);MO.Console.find(MO.FResourceConsole).load(d);b.set(a,d);return d};
MO.FE3sSceneConsole_loadByCode=function(a){var b=this._scenes,d=b.get(a);if(d)return d;var e=MO.Console.find(MO.FE3sVendorConsole).find(this._vendorCode);e.set("code",a);var f=e.makeUrl(),d=MO.Class.create(MO.FE3sScene);d.setCode(a);d.setVendor(e);d.setSourceUrl(f);MO.Console.find(MO.FResourceConsole).load(d);b.set(a,d);return d};
MO.FE3sSceneDisplay=function(a){a=MO.Class.inherits(this,a,MO.FE3sSprite);a._templateGuid=MO.Class.register(a,new MO.AGetter("_templateGuid"));a._animations=MO.Class.register(a,new MO.AGetter("_animations"));a._movies=MO.Class.register(a,new MO.AGetter("_movies"));a._renderables=MO.Class.register(a,new MO.AGetter("_renderables"));a.construct=MO.FE3sSceneDisplay_construct;a.findAnimation=MO.FE3sSceneDisplay_findAnimation;a.syncAnimation=MO.FE3sSceneDisplay_syncAnimation;a.unserialize=MO.FE3sSceneDisplay_unserialize;
a.saveConfig=MO.FE3sSceneDisplay_saveConfig;a.clone=MO.FE3sSceneDisplay_clone;return a};MO.FE3sSceneDisplay_construct=function(){this.__base.FE3sSprite.construct.call(this)};MO.FE3sSceneDisplay_findAnimation=function(a){var b=this._animations;return b?b.get(a):null};MO.FE3sSceneDisplay_syncAnimation=function(a){var b=this._animations;b||(b=this._animations=new MO.TDictionary);var d=b.get(a);d||(d=MO.Class.create(MO.FE3sSceneAnimation),d._guid=a,b.set(a,d));return d};
MO.FE3sSceneDisplay_unserialize=function(a){this.__base.FE3sSprite.unserialize.call(this,a);this._templateGuid=a.readString();var b=a.readUint16();if(0<b)for(var d=this._animations=new MO.TDictionary,e=0;e<b;e++){var f=MO.Class.create(MO.FE3sSceneAnimation);f.unserialize(a);d.set(f.guid(),f)}b=a.readUint16();if(0<b)for(d=this._movies=new MO.TObjects,e=0;e<b;e++)f=MO.Class.create(MO.FE3sMovie),f.unserialize(a),d.push(f)};
MO.FE3sSceneDisplay_saveConfig=function(a){this.__base.FE3sSprite.saveConfig.call(this,a);a.set("template_guid",this._templateGuid);var b=this._animations;if(b){var d=b.count();a=a.create("AnimationCollection");for(var e=0;e<d;e++)b.at(e).saveConfig(a.create("Animation"))}};MO.FE3sSceneDisplay_clone=function(a){a=this.__base.FE3sSprite.clone.call(this,a);a._templateGuid=this._templateGuid;return a};MO.FE3sSceneLayer=function(a){return a=MO.Class.inherits(this,a,MO.FE3sDisplayLayer)};
MO.FE3sSceneRenderable=function(a){a=MO.Class.inherits(this,a,MO.FE3sObject);a.unserialize=MO.FE3sSceneRenderable_unserialize;return a};MO.FE3sSceneRenderable_unserialize=function(a){this.__base.FE3sObject.unserialize.call(this,a)};
MO.FE3sShape=function(a){a=MO.Class.inherits(this,a,FE3sRenderable);a._modelGuid=MO.Class.register(a,new MO.AGetter("_modelGuid"));a._model=null;a._meshGuid=MO.Class.register(a,new MO.AGetter("_meshGuid"));a._mesh=null;a._materialGuid=MO.Class.register(a,new MO.AGetter("_materialGuid"));a._material=null;a.construct=FE3sShape_construct;a.model=FE3sShape_model;a.mesh=FE3sShape_mesh;a.material=FE3sShape_material;a.unserialize=FE3sShape_unserialize;return a};MO.FE3sShape_construct=function(){this.__base.FE3sRenderable.construct.call(this)};
MO.FE3sShape_model=function(){var a=this._model;a||(a=this._model=MO.Console.find(MO.FE3sModelConsole).findModel(this._modelGuid));return a};MO.FE3sShape_mesh=function(){var a=this._mesh;a||(a=this._mesh=MO.Console.find(MO.FE3sModelConsole).findMesh(this._meshGuid));return a};MO.FE3sShape_material=function(){var a=this._material;a||(a=this._material=MO.Console.find(MO.FE3sMaterialConsole).find(this._materialGuid));return a};
MO.FE3sShape_unserialize=function(a){this.__base.FE3sRenderable.unserialize.call(this,a);this._modelGuid=a.readString();this._meshGuid=a.readString();this._materialGuid=a.readString()};
MO.FE3sSkeleton=function(a){a=MO.Class.inherits(this,a,MO.FE3sObject);a._bones=MO.Class.register(a,new MO.AGetter("_bones"));a._roots=MO.Class.register(a,new MO.AGetter("_roots"));a._skins=MO.Class.register(a,new MO.AGetter("_skins"));a._animations=MO.Class.register(a,new MO.AGetter("_animations"));a.findBone=MO.FE3sSkeleton_findBone;a.pushAnimation=MO.FE3sSkeleton_pushAnimation;a.innerFilter=MO.FE3sSkeleton_innerFilter;a.unserialize=MO.FE3sSkeleton_unserialize;return a};
MO.FE3sSkeleton_findBone=function(a){return this._bones.get(a)};MO.FE3sSkeleton_pushAnimation=function(a){var b=this._animations;b||(b=this._animations=new MO.TObjects);b.push(a)};MO.FE3sSkeleton_innerFilter=function(a){this._bones.set(a.index(),a);if(a=a.bones())for(var b=a.count(),d=0;d<b;d++){var e=a.get(d);this.innerFilter(e)}};
MO.FE3sSkeleton_unserialize=function(a){this.__base.FE3sObject.unserialize.call(this,a);var b=a.readUint8();if(0<b){this._bones=new MO.TDictionary;for(var d=this._roots=new MO.TObjects,e=0;e<b;e++){var f=MO.Class.create(MO.FE3sBone);f.unserialize(a);this.innerFilter(f);d.push(f)}}b=a.readUint8();if(0<b)for(d=this._skins=new MO.TObjects,e=0;e<b;e++)f=MO.Class.create(MO.FE3sSkeletonSkin),f.unserialize(a),d.push(f)};
MO.FE3sSkeletonSkin=function(a){a=MO.Class.inherits(this,a,MO.FE3sObject);a._meshGuid=MO.Class.register(a,new MO.AGetter("_meshGuid"));a._streams=MO.Class.register(a,new MO.AGetter("_streams"));a._boneRefers=MO.Class.register(a,new MO.AGetter("_boneRefers"));a.find=MO.FE3sSkeletonSkin_find;a.unserialize=MO.FE3sSkeletonSkin_unserialize;return a};MO.FE3sSkeletonSkin_find=function(a){return this._streams.get(a)};
MO.FE3sSkeletonSkin_unserialize=function(a){this.__base.FE3sObject.unserialize.call(this,a);this._meshGuid=a.readString();var b=a.readUint8();if(0<b)for(var d=this._streams=new MO.TObjects,e=0;e<b;e++){var f=MO.Class.create(MO.FE3sStream);f.unserialize(a);d.push(f)}b=a.readUint8();if(0<b)for(d=this._boneRefers=new MO.TObjects,e=0;e<b;e++)f=MO.Class.create(MO.FE3sBoneRefer),f.unserialize(a),d.push(f)};
MO.FE3sSpace=function(a){a=MO.Class.inherits(this,a,MO.FE3sResource);a._typeName=null;a._technique=MO.Class.register(a,new MO.AGetter("_technique"));a._region=MO.Class.register(a,new MO.AGetter("_region"));a._materials=MO.Class.register(a,new MO.AGetter("_materials"));a._displays=MO.Class.register(a,new MO.AGetter("_displays"));a._layers=MO.Class.register(a,new MO.AGetter("_layers"));a.construct=MO.FE3sSpace_construct;a.unserialize=MO.FE3sSpace_unserialize;a.saveConfig=MO.FE3sSpace_saveConfig;return a};
MO.FE3sSpace_construct=function(){this.__base.FE3sResource.construct.call(this);this._technique=MO.Class.create(MO.FE3sTechnique);this._region=MO.Class.create(MO.FE3sRegion)};
MO.FE3sSpace_unserialize=function(a){this.__base.FE3sResource.unserialize.call(this,a);var b=MO.Console.find(MO.FE3sResourceConsole),d=MO.Console.find(MO.FE3sMaterialConsole);this._technique.unserialize(a);this._region.unserialize(a);var e=a.readInt16();if(0<e)for(var f=this._materials=new MO.TDictionary,h=0;h<e;h++){var k=d.unserialize(a);f.set(k.guid(),k)}d=a.readInt16();if(0<d)for(e=this._displays=new MO.TObjects,h=0;h<d;h++)f=b.unserialize(a),e.push(f);b=a.readInt16();if(0<b)for(d=this._layers=
new MO.TDictionary,h=0;h<b;h++)e=MO.Class.create(MO.FE3sDisplayLayer),e.unserialize(a),d.set(e.code(),e)};
MO.FE3sSpace_saveConfig=function(a){this.__base.FE3sResource.saveConfig.call(this,a);this._technique.saveConfig(a.create("Technique"));this._region.saveConfig(a.create("Region"));var b=this._materials;if(b)for(var d=a.create("MaterialCollection"),e=b.count(),f=0;f<e;f++)b.at(f).saveConfig(d.create("Material"));if(b=this._displays)for(d=a.create("DisplayCollection"),e=b.count(),f=0;f<e;f++)b.at(f).saveConfig(d.create("Display"));if(b=this._layers)for(a=a.create("LayerCollection"),d=b.count(),f=0;f<
d;f++)b.valueAt(f).saveConfig(a.create("Layer"))};MO.FE3sSprite=function(a){a=MO.Class.inherits(this,a,MO.FE3sDisplayContainer);a._materials=MO.Class.register(a,new MO.AGetter("_materials"));a.construct=MO.FE3sSprite_construct;a.pushMaterial=MO.FE3sSprite_pushMaterial;a.unserialize=MO.FE3sSprite_unserialize;a.saveConfig=MO.FE3sSprite_saveConfig;a.clone=MO.FE3sSprite_clone;return a};MO.FE3sSprite_construct=function(){this.__base.FE3sDisplayContainer.construct.call(this)};
MO.FE3sSprite_pushMaterial=function(a){var b=this._materials;b||(b=this._materials=new MO.TDictionary);b.set(a.guid(),a)};MO.FE3sSprite_unserialize=function(a){this.__base.FE3sDisplayContainer.unserialize.call(this,a);var b=a.readUint16();if(0<b)for(var d=MO.Console.find(MO.FE3sMaterialConsole),e=0;e<b;e++){var f=d.unserialize(a);this.pushMaterial(f)}};
MO.FE3sSprite_saveConfig=function(a){this.__base.FE3sDisplayContainer.saveConfig.call(this,a);var b=this._materials;if(b)for(var d=b.count(),e=a.create("MaterialCollection"),f=0;f<d;f++)b.at(f).saveConfig(e.create("Material"));if(b=this._movies)for(d=b.count(),a=a.create("MovieCollection"),f=0;f<d;f++)b.at(f).saveConfig(a.create("Movie"))};
MO.FE3sSprite_clone=function(a){a=this.__base.FE3sDisplayContainer.clone.call(this,a);var b=this._materials;if(b)for(var d=b.count(),e=0;e<d;e++){var f=b.at(e);a.pushMaterial(f.clone())}return a};
MO.FE3sStream=function(a){a=MO.Class.inherits(this,a,MO.FObject);a._code=MO.Class.register(a,new MO.AGetSet("_code"));a._elementDataCd=MO.Class.register(a,new MO.AGetSet("_elementDataCd"),0);a._elementCount=MO.Class.register(a,new MO.AGetSet("_elementCount"),0);a._elementNormalize=MO.Class.register(a,new MO.AGetSet("_elementNormalize"),!1);a._dataStride=MO.Class.register(a,new MO.AGetSet("_dataStride"),0);a._dataCount=MO.Class.register(a,new MO.AGetSet("_dataCount"),0);a._dataLength=MO.Class.register(a,
new MO.AGetSet("_dataLength"),0);a._data=MO.Class.register(a,new MO.AGetSet("_data"));a._formatCd=MO.Class.register(a,new MO.AGetSet("_formatCd"),MO.EG3dAttributeFormat.Unknown);a.unserialize=MO.FE3sStream_unserialize;a.dispose=MO.FE3sStream_dispose;return a};
MO.FE3sStream_unserialize=function(a){this._code=a.readString();this._elementDataCd=a.readUint8();this._elementCount=a.readUint8();this._elementNormalize=a.readBoolean();var b=this._dataStride=a.readUint8(),d=this._dataCount=a.readInt32(),b=this._dataLength=b*d,d=this._data=new ArrayBuffer(b);a.readBytes(d,0,b)};MO.FE3sStream_dispose=function(){this.data=null;this.__base.FObject.dispose.call(this)};
MO.FE3sTechnique=function(a){a=MO.Class.inherits(this,a,MO.FE3sObject);a._techniqueCode=MO.Class.register(a,new MO.AGetter("_techniqueCode"));a._passes=MO.Class.register(a,new MO.AGetter("_passes"));a.passes=MO.FE3sTechnique_passes;a.unserialize=MO.FE3sTechnique_unserialize;a.saveConfig=MO.FE3sTechnique_saveConfig;return a};
MO.FE3sTechnique_unserialize=function(a){this.__base.FE3sObject.unserialize.call(this,a);var b=a.readInt16();if(0<b)for(var d=this._passes=new MO.TObjects,e=0;e<b;e++){var f=MO.Class.create(MO.FE3sTechniquePass);f.unserialize(a);d.push(f)}};MO.FE3sTechnique_saveConfig=function(a){this.__base.FE3sObject.saveConfig.call(this,a);a.set("technique_code",this._techniqueCode)};
MO.FE3sTechniquePass=function(a){a=MO.Class.inherits(this,a,MO.FE3sObject);a._targetWidth=MO.Class.register(a,new MO.AGetter("_targetWidth"));a._targetHeight=MO.Class.register(a,new MO.AGetter("_targetHeight"));a.unserialize=MO.FE3sTechniquePass_unserialize;return a};MO.FE3sTechniquePass_unserialize=function(a){this.__base.FE3sObject.unserialize.call(this,a);this._targetWidth=a.readUint16();this._targetHeight=a.readUint16()};
MO.FE3sTemplate=function(a){a=MO.Class.inherits(this,a,MO.FE3sSpace);a._typeName="Template";a._dataCompress=!0;return a};MO.FE3sTemplateConsole=function(a){a=MO.Class.inherits(this,a,MO.FConsole);a._templates=null;a._serviceUrl="/cloud.content.template.ws";a.construct=MO.FE3sTemplateConsole_construct;a.unserialize=MO.FE3sTemplateConsole_unserialize;a.loadByGuid=MO.FE3sTemplateConsole_loadByGuid;a.loadByCode=MO.FE3sTemplateConsole_loadByCode;a.update=MO.FE3sTemplateConsole_update;return a};
MO.FE3sTemplateConsole_construct=function(){this.__base.FConsole.construct.call(this);this._templates=new MO.TDictionary};MO.FE3sTemplateConsole_unserialize=function(a){var b=MO.Class.create(MO.FE3sTemplate);b._dataReady=!0;b.unserialize(a);this._templates.set(b.guid(),b);return b};
MO.FE3sTemplateConsole_loadByGuid=function(a){var b=this._templates,d=b.get(a);if(d)return d;var e=MO.Console.find(MO.FE3sVendorConsole).find("template");e.set("guid",a);var f=e.makeUrl(),d=MO.Class.create(MO.FE3sTemplate);d.setGuid(a);d.setVendor(e);d.setSourceUrl(f);MO.Console.find(MO.FResourceConsole).load(d);b.set(a,d);return d};
MO.FE3sTemplateConsole_loadByCode=function(a){var b=this._templates,d=b.get(a);if(d)return d;var e=MO.Console.find(MO.FE3sVendorConsole).find("template");e.set("code",a);var f=e.makeUrl(),d=MO.Class.create(MO.FE3sTemplate);d.setCode(a);d.setVendor(e);d.setSourceUrl(f);MO.Console.find(MO.FResourceConsole).load(d);b.set(a,d);return d};MO.FE3sTemplateConsole_update=function(a){var b=MO.RBrowser.hostPath(this._serviceUrl+"?action=update");MO.Console.find(MO.FXmlConsole).send(b,a)};
MO.FE3sTemplateTheme=function(a){a=MO.Class.inherits(this,a,MO.FE3sObject);a._materials=MO.Class.register(a,new MO.AGetter("_materials"));a.findMaterial=MO.FE3sTemplateTheme_findMaterial;a.materials=MO.FE3sTemplateTheme_materials;a.unserialize=MO.FE3sTemplateTheme_unserialize;return a};MO.FE3sTemplateTheme_findMaterial=function(a){return this._materials.get(a)};
MO.FE3sTemplateTheme_unserialize=function(a){this.__base.FE3sObject.unserialize.call(this,a);var b=a.readUint16();if(0<b)for(var d=MO.Console.find(MO.FE3sMaterialConsole),e=this._materials=new MO.TDictionary,f=0;f<b;f++){var h=d.unserialize(a);e.set(h.groupGuid(),h)}};
MO.FE3sTexture=function(a){a=MO.Class.inherits(this,a,MO.FE3sResource);a._dataCompress=!0;a._bitmaps=MO.Class.register(a,new MO.AGetter("_bitmaps"));a._bitmapPacks=MO.Class.register(a,new MO.AGetter("_bitmapPacks"));a.construct=MO.FE3sTexture_construct;a.unserialize=MO.FE3sTexture_unserialize;a.dispose=MO.FE3sTexture_dispose;return a};MO.FE3sTexture_construct=function(){this.__base.FE3sResource.construct.call(this)};
MO.FE3sTexture_unserialize=function(a){this.__base.FE3sResource.unserialize.call(this,a);var b=a.readInt16();if(0<b)for(var d=this._bitmaps=new MO.TDictionary,e=0;e<b;e++){var f=MO.Class.create(FE3sTextureBitmap);f.unserialize(a);d.set(f.code(),f)}b=a.readInt16();if(0<b)for(d=this._bitmapPacks=new MO.TDictionary,e=0;e<b;e++)f=MO.Class.create(FE3sTextureBitmapPack),f._texture=this,f.unserialize(a),d.set(f.code(),f)};
MO.FE3sTexture_dispose=function(){this._bitmaps=MO.Lang.Object.free(this._bitmaps);this._bitmapPacks=MO.Lang.Object.free(this._bitmapPacks);this.__base.FE3sResource.dispose.call(this)};MO.FE3sTextureBitmap=function(a){a=MO.Class.inherits(this,a,MO.FE3sObject);a._packCode=MO.Class.register(a,new MO.AGetter("_packCode"));a.packCode=MO.FE3sTextureBitmap_packCode;a.unserialize=MO.FE3sTextureBitmap_unserialize;return a};
MO.FE3sTextureBitmap_unserialize=function(a){this.__base.FE3sObject.unserialize.call(this,a);this._packCode=a.readString()};
MO.FE3sTextureBitmapPack=function(a){a=MO.Class.inherits(this,a,MO.FE3sObject);a._optionCompress=MO.Class.register(a,new MO.AGetter("_optionCompress"));a._size=MO.Class.register(a,new MO.AGetter("_size"));a._data=MO.Class.register(a,new MO.AGetter("_data"));a._typeName=null;a._formatName=null;a.construct=MO.FE3sTextureBitmapPack_construct;a.unserialize=MO.FE3sTextureBitmapPack_unserialize;a.dispose=MO.FE3sTextureBitmapPack_dispose;return a};
MO.FE3sTextureBitmapPack_construct=function(){this.__base.FE3sObject.construct.call(this);this._size=new MO.SSize2};
MO.FE3sTextureBitmapPack_unserialize=function(a){this.__base.FE3sObject.unserialize.call(this,a);this._typeName=a.readString();this._formatName=a.readString();this._size.width=a.readUint16();this._size.height=a.readUint16();if("flat"==this._typeName)var b=a.readInt32();else if("cube"==this._typeName){this._data=[];for(var d=0;6>d;d++){var b=a.readInt32(),e=this._data[d]=new ArrayBuffer(b);a.readBytes(e,0,b)}}else throw new MO.TError(this,"Unserial texture failure ");};
MO.FE3sTextureBitmapPack_dispose=function(){this._data=null;this.__base.FE3sObject.dispose.call(this)};MO.FE3sTextureConsole=function(a){a=MO.Class.inherits(this,a,MO.FConsole);a._textures=null;a.construct=MO.FE3sTextureConsole_construct;a.unserialize=MO.FE3sTextureConsole_unserialize;a.load=MO.FE3sTextureConsole_load;a.loadBitmap=MO.FE3sTextureConsole_loadBitmap;a.dispose=MO.FE3sModelConsole_dispose;return a};
MO.FE3sTextureConsole_construct=function(){this.__base.FConsole.construct.call(this);this._textures=new MO.TDictionary};MO.FE3sTextureConsole_unserialize=function(a){var b=MO.Class.create(MO.FE3sTexture);b._dataReady=!0;b.unserialize(a);this._textures.set(b.guid(),b);return b};
MO.FE3sTextureConsole_load=function(a){var b=this._textures,d=b.get(a);if(d)return d;var e=MO.Console.find(MO.FE3sVendorConsole).find("texture"),f=e.makeUrl(a),d=MO.Class.create(MO.FE3sTexture);d.setGuid(a);d.setVendor(e);d.setSourceUrl(f);MO.Console.find(MO.FResourceConsole).load(d);b.set(a,d);return d};
MO.FE3sTextureConsole_loadBitmap=function(a,b,d){var e=MO.Console.find(MO.FE3sVendorConsole).find("texture.bitmap");e.set("guid",a);e.set("code",b);e.set("format",d);a=e.makeUrl();b=this._image=MO.Class.create(MO.FImage);b.loadUrl(a);return b};MO.FE3sTextureConsole_dispose=function(){this._textures=MO.Lang.Object.free(this._textures);this.__base.FConsole.dispose.call(this)};
MO.FE3sTheme=function(a){a=MO.Class.inherits(this,a,MO.FE3sResource);a._materials=MO.Class.register(a,new MO.AGetter("_materials"));a.find=MO.FE3sTheme_find;a.unserialize=MO.FE3sTheme_unserialize;return a};MO.FE3sTheme_find=function(a){var b=this._materials;return b?b.get(a):null};MO.FE3sTheme_unserialize=function(a){if(0<a.readInt32())for(var b=this._materials=new MO.TDictionary,d=0;d<c;d++){var e=MO.Class.create(FE3sMaterial);e.unserialize(a);b.set(e.code(),e)}};
MO.FE3sThemeConsole=function(a){a=MO.Class.inherits(this,a,MO.FConsole);a._path="/assets/theme/";a._activeTheme=MO.Class.register(a,new MO.AGetter("_activeTheme"));a._themes=null;a.construct=MO.FE3sThemeConsole_construct;a.find=MO.FE3sThemeConsole_find;a.select=MO.FE3sThemeConsole_select;return a};MO.FE3sThemeConsole_construct=function(){this.__base.FConsole.construct.call(this);this._themes=new MO.TDictionary};
MO.FE3sThemeConsole_find=function(a){var b=this._activeTheme;if(null==b)throw new MO.TError("Active theme is empty.");return b.find(a)};MO.FE3sThemeConsole_select=function(a){var b=this._themes.get(a);if(null==b){var d=MO.RBrowser.contentPath(this._path+a+".ser"),b=MO.Class.create(MO.FE3sTheme);b.load(d);this._themes.set(a,b)}return this._activeTheme=b};
MO.FE3sTrack=function(a){a=MO.Class.inherits(this,a,MO.FObject);a._meshCode=MO.Class.register(a,new MO.AGetter("_meshCode"));a._boneIndex=MO.Class.register(a,new MO.AGetter("_boneIndex"),0);a._frameTick=MO.Class.register(a,new MO.AGetter("_frameTick"),0);a._matrix=MO.Class.register(a,new MO.AGetter("_matrix"));a._matrixInvert=MO.Class.register(a,new MO.AGetter("_matrixInvert"));a._frameCount=MO.Class.register(a,new MO.AGetter("_frameCount"));a._frames=MO.Class.register(a,new MO.AGetter("_frames"));
a.construct=MO.FE3sTrack_construct;a.calculate=MO.FE3sTrack_calculate;a.unserialize=MO.FE3sTrack_unserialize;return a};MO.FE3sTrack_construct=function(){this.__base.FObject.construct.call(this);this._matrix=new MO.SMatrix3d;this._matrixInvert=new MO.SMatrix3d};
MO.FE3sTrack_calculate=function(a,b){var d=a.frameCount;if(0==d)throw new MO.TError("Frame count is invalid.");var e=a.beginIndex,f=this._frameTick,h=parseInt(b/f)%d,k=this._frames,q=k.get(e+h),w=null,w=h<d-1?k.get(e+h+1):k.get(e);a.tick=b;a.rate=b%f/f;a.currentFrame=q;a.nextFrame=w;return!0};
MO.FE3sTrack_unserialize=function(a){this._meshCode=a.readString();this._boneIndex=a.readUint16();this._frameTick=a.readUint16();this._matrix.unserialize(a);this._matrixInvert.assign(this._matrix);this._matrixInvert.invert();this._frameCount=a.readInt16();this._frames=new MO.TObjects};
MO.FE3sVendor=function(a){a=MO.Class.inherits(this,a,MO.FObject);a._contentUrl=MO.Class.register(a,new MO.AGetSet("_contentUrl"));a._parameters=null;a.construct=MO.FE3sVendor_construct;a.get=MO.FE3sVendor_get;a.set=MO.FE3sVendor_set;a.makeSource=MO.Method.virtual(a,"makeSource");a.makeUrl=MO.FE3sVendor_makeUrl;a.reset=MO.FE3sVendor_reset;a.dispose=MO.FE3sVendor_dispose;return a};MO.FE3sVendor_construct=function(){this.__base.FObject.construct.call(this);this._parameters=new MO.TAttributes};
MO.FE3sVendor_get=function(a){return this._parameters.get(a)};MO.FE3sVendor_set=function(a,b){this._parameters.set(a,b)};MO.FE3sVendor_makeUrl=function(){var a=this.makeSource();MO.Runtime.isDebug()&&(a=-1==a.indexOf("?")?a+"?":a+"&",a+="date="+MO.Lang.Date.format());return a};MO.FE3sVendor_reset=function(){this._parameters.clear()};MO.FE3sVendor_dispose=function(){this._parameters=MO.Lang.Object.dispose(this._parameters);this.__base.FObject.dispose.call(this)};
MO.FE3sVendorConsole=function(a){a=MO.Class.inherits(this,a,MO.FConsole);a._setuped=!1;a._vendors=null;a.construct=MO.FE3sVendorConsole_construct;a.createVendor=MO.FE3sVendorConsole_createVendor;a.register=MO.FE3sVendorConsole_register;a.find=MO.FE3sVendorConsole_find;a.setup=MO.FE3sVendorConsole_setup;return a};MO.FE3sVendorConsole_construct=function(){this.__base.FConsole.construct.call(this);this._vendors=new MO.TDictionary};
MO.FE3sVendorConsole_createVendor=function(a,b){var d=MO.Class.create(a);d.setContentUrl(b);return d};MO.FE3sVendorConsole_register=function(a,b){this._vendors.set(a,b)};MO.FE3sVendorConsole_find=function(a){this._setuped||this.setup("net");a=this._vendors.get(a);a.reset();return a};
MO.FE3sVendorConsole_setup=function(a){if("net"==a)this._vendors.set("bitmap",this.createVendor(MO.FE3sVendorNet,MO.RBrowser.hostPath("/cloud.resource.bitmap.wv"),"guid")),this._vendors.set("material",this.createVendor(MO.FE3sVendorNet,MO.RBrowser.hostPath("/cloud.resource.material.wv?do=data"),"guid")),this._vendors.set("mesh",this.createVendor(MO.FE3sVendorNet,MO.RBrowser.hostPath("/cloud.resource.mesh.wv"),"guid")),this._vendors.set("model",this.createVendor(MO.FE3sVendorNet,MO.RBrowser.hostPath("/cloud.resource.model.wv"),
"guid")),this._vendors.set("template",this.createVendor(MO.FE3sVendorNet,MO.RBrowser.hostPath("/cloud.resource.template.wv"),"guid")),this._vendors.set("scene",this.createVendor(MO.FE3sVendorNet,MO.RBrowser.hostPath("/cloud.resource.scene.wv"),"guid|code"));else if("local"==a)this._vendors.set("bitmap",this.createVendor(MO.FE3sVendorLocal,MO.RBrowser.contentPath("/ar3/bitmap/{guid}.bin"))),this._vendors.set("material",this.createVendor(MO.FE3sVendorLocal,MO.RBrowser.contentPath("/ar3/material/{guid}.bin"))),
this._vendors.set("mesh",this.createVendor(MO.FE3sVendorLocal,MO.RBrowser.contentPath("/ar3/mesh/{guid}.bin"))),this._vendors.set("model",this.createVendor(MO.FE3sVendorLocal,MO.RBrowser.contentPath("/ar3/model/{guid}.bin"))),this._vendors.set("template",this.createVendor(MO.FE3sVendorLocal,MO.RBrowser.contentPath("/ar3/template/{guid}.bin"))),this._vendors.set("scene",this.createVendor(MO.FE3sVendorLocal,MO.RBrowser.contentPath("/ar3/scene/{guid}.bin")));else throw new MO.TError(this,"Unknown setup code. (code={1})",
a);this._setuped=!0};MO.FE3sVendorLocal=function(a){a=MO.Class.inherits(this,a,MO.FE3sVendor);a.makeSource=MO.FE3sVendorLocal_makeSource;return a};MO.FE3sVendorLocal_makeSource=function(){for(var a=this._contentUrl,b=this._parameters,d=b.count(),e=0;e<d;e++)var f=b.name(e),h=b.value(e),a=MO.Lang.String.replace(a,"{"+f+"}",h);return a};MO.FE3sVendorNet=function(a){a=MO.Class.inherits(this,a,MO.FE3sVendor);a.makeSource=MO.FE3sVendorNet_makeSource;return a};
MO.FE3sVendorNet_makeSource=function(){for(var a=this._contentUrl,a=-1==a.indexOf("?")?a+"?":a+"&",b=this._parameters,d=b.count(),e=!1,f=0;f<d;f++){var h=b.name(f),k=b.value(f);MO.Lang.String.isEmpty(k)||(e?a+="&":e=!0,a+=h+"="+k)}return a};
MO.SE3rPlayInfo=function(){this.tick=0;this.playRate=1;this.frameCount=this.endIndex=this.beginIndex=0;this.nextFrame=this.currentFrame=null;this.alpha=this.rate=1;this.translation=new MO.SPoint3;this.quaternion=new MO.SQuaternion;this.scale=new MO.SVector3;this.matrix=new MO.SMatrix3d;this.update=MO.SE3rPlayInfo_update;return this};
MO.SE3rPlayInfo_update=function(){var a=this.currentFrame;if(!a)return!1;var b=this.nextFrame;if(!b)return!1;var d=this.matrix,e=a.translation(),f=a.quaternion(),a=a.scale(),h=this.rate;0<h&&1>h?(this.translation.slerp(e,b.translation(),h),this.quaternion.slerp(f,b.quaternion(),h),this.scale.slerp(a,b.scale(),h),d.build(this.translation,this.quaternion,this.scale)):d.build(e,f,a);return!0};
MO.FE3rAnimation=function(a){a=MO.Class.inherits(this,a,MO.FObject);a._valid=!1;a._baseTick=0;a._currentTick=0;a._lastTick=0;a._playRate=1;a._tracks=MO.Class.register(a,new AGetter("_tracks"));a._resource=MO.Class.register(a,new AGetter("_resource"));a._playInfo=null;a.construct=MO.FE3rAnimation_construct;a.findTrack=MO.FE3rAnimation_findTrack;a.loadResource=MO.FE3rAnimation_loadResource;a.record=MO.FE3rAnimation_record;a.process=MO.Method.virtual(a,"process");a.dispose=MO.FE3rAnimation_dispose;return a};
MO.FE3rAnimation_construct=function(){this.__base.FObject.construct.call(this);this._playInfo=new MO.SE3rPlayInfo};MO.FE3rAnimation_findTrack=function(a){for(var b=this._tracks,d=b.count(),e=0;e<d;e++){var f=b.get(e);if(f.boneIndex()==a)return f}return null};
MO.FE3rAnimation_loadResource=function(a){var b=a.frameCount();this._resource=a;if(a=a.tracks())for(var d=this._tracks=new MO.TObjects,e=a.count(),f=0;f<e;f++){var h=a.at(f),k=MO.Class.create(MO.FE3rTrack);k._animation=this;k.loadResource(h);d.push(k)}0<b&&(a=this._playInfo,a.beginIndex=0,a.endIndex=0<b?b-1:0,a.frameCount=b,this._valid=!0)};MO.FE3rAnimation_record=function(){var a=RTimer.current();0==this._lastTick&&(this._lastTick=a);this._currentTick=(a-this._lastTick+this._baseTick)*this._playRate};
MO.FE3rAnimation_dispose=function(){this._resource=this._tracks=null;this.__base.FObject.dispose.call(this)};MO.FE3rBitmap=function(a){a=MO.Class.inherits(this,a,MO.FE3rObject);a._pack=null;a.construct=MO.FE3rBitmap_construct;a.testReady=MO.FE3rBitmap_testReady;a.texture=MO.FE3rBitmap_texture;a.loadResource=MO.FE3rBitmap_loadResource;a.dispose=MO.FE3rBitmap_dispose;return a};MO.FE3rBitmap_construct=function(){this.__base.FE3rObject.construct.call(this)};MO.FE3rBitmap_testReady=function(){return this._pack.testReady()};
MO.FE3rBitmap_texture=function(){return this._pack.texture()};MO.FE3rBitmap_loadResource=function(a){this._resource=a;this._guid=a.guid();this._code=a.code()};MO.FE3rBitmap_dispose=function(){this.__base.FE3rObject.dispose.call(this)};
MO.FE3rBitmapConsole=function(a){a=MO.Class.inherits(this,a,MO.FConsole);a._scopeCd=MO.EScope.Local;a._bitmaps=MO.Class.register(a,new AGetter("_bitmaps"));a._dataUrl="/cloud.resource.material.wv";a.construct=MO.FE3rBitmapConsole_construct;a.load=MO.FE3rBitmapConsole_load;a.loadUrl=MO.FE3rBitmapConsole_loadUrl;return a};MO.FE3rBitmapConsole_construct=function(){this.__base.FConsole.construct.call(this);this._bitmaps=new MO.TDictionary};
MO.FE3rBitmapConsole_load=function(a,b,d){var e=b+"|"+d,f=this._bitmaps.get(e);if(f)return f;b=MO.Window.Browser.hostPath(this._dataUrl+"?guid="+b+"&code="+d);MO.Logger.info(this,"Load bitmap. (url={1})",b);f="environment"==d?a.createObject(MO.FE3rBitmapCubePack):a.createObject(MO.FE3rBitmapFlatPack);this._bitmaps.set(e,f);return f};
MO.FE3rBitmapConsole_loadUrl=function(a,b){var d=this._bitmaps.get(b);if(d)return d;d=MO.Window.Browser.contentPath(b);MO.Logger.info(this,"Load bitmap from url. (url={1})",d);d=a.createObject(MO.FE3rBitmap);d.loadUrl(b);this._bitmaps.set(b,d);return d};
MO.FE3rBitmapCubePack=function(a){a=MO.Class.inherits(this,a,MO.FE3rBitmapPack);a._images=MO.Class.register(a,new MO.AGetter("_images"));a.onLoad=MO.FE3rBitmapCubePack_onLoad;a.construct=MO.FE3rBitmapCubePack_construct;a.loadUrl=MO.FE3rBitmapCubePack_loadUrl;a.dispose=MO.FE3rBitmapCubePack_dispose;return a};
MO.FE3rBitmapCubePack_onLoad=function(a){a=this._graphicContext;var b=this._images;MO.Window.Browser.capability();for(var d=0;6>d;d++)if(!b.at(d).testReady())return;(this._texture=a.createCubeTexture()).upload(b.at(0),b.at(1),b.at(2),b.at(3),b.at(4),b.at(5));for(d=0;6>d;d++)b.at(d).dispose();this._images=MO.Lang.Object.dispose(this._images);this._ready=this._dataReady=!0};MO.FE3rBitmapCubePack_construct=function(){this.__base.FE3rBitmapPack.construct.call(this)};
MO.FE3rBitmapCubePack_loadUrl=function(a){for(var b=this._images=new MO.TObjects,d=0;6>d;d++){var e=MO.Class.create(MO.FImage);e._index=d;e.setOptionAlpha(!1);e.addLoadListener(this,this.onLoad);e.loadUrl(a+"&index="+d);b.push(e)}};MO.FE3rBitmapCubePack_dispose=function(){this._images=MO.Lang.Object.dispose(this._images,!0);this.__base.FE3rBitmapPack.dispose.call(this)};
MO.FE3rBitmapFlatPack=function(a){a=MO.Class.inherits(this,a,MO.FE3rBitmapPack);a._image=MO.Class.register(a,new MO.AGetter("_image"));a.onLoad=MO.FE3rBitmapFlatPack_onLoad;a.construct=MO.FE3rBitmapFlatPack_construct;a.loadUrl=MO.FE3rBitmapFlatPack_loadUrl;a.dispose=MO.FE3rBitmapFlatPack_dispose;return a};
MO.FE3rBitmapFlatPack_onLoad=function(a){a=this._texture=this._graphicContext.createFlatTexture();a.upload(this._image);a.makeMipmap();this._image=MO.Lang.Object.dispose(this._image);this._dataReady=!0};MO.FE3rBitmapFlatPack_construct=function(){this.__base.FE3rBitmapPack.construct.call(this)};MO.FE3rBitmapFlatPack_loadUrl=function(a){var b=this._image=MO.Class.create(MO.FImage);b.addLoadListener(this,this.onLoad);b.loadUrl(a)};
MO.FE3rBitmapFlatPack_dispose=function(){this._image=MO.Lang.Object.dispose(this._image);this.__base.FE3rBitmapPack.dispose.call(this)};
MO.FE3rBitmapPack=function(a){a=MO.Class.inherits(this,a,MO.FObject,MO.MGraphicObject,MO.MLinkerResource);a._texture=MO.Class.register(a,new MO.AGetter("_texture"));a._dataReady=!1;a._ready=!1;a.onLoad=MO.Method.virtual(a,"onLoad");a.construct=MO.FE3rBitmapPack_construct;a.testReady=MO.FE3rBitmapPack_testReady;a.loadUrl=MO.Method.virtual(a,"loadUrl");a.dispose=MO.FE3rBitmapPack_dispose;return a};MO.FE3rBitmapPack_construct=function(){this.__base.FObject.construct.call(this)};
MO.FE3rBitmapPack_testReady=function(){this._dataReady&&(this._ready=this._texture.isValid());return this._ready};MO.FE3rBitmapPack_dispose=function(){this._dataReady=this._ready=!1;this.__base.FObject.dispose.call(this)};
MO.FE3rBone=function(a){a=MO.Class.inherits(this,a,MO.FObject);a._matrix=MO.Class.register(a,new AGetter("_matrix"));a._boneResource=MO.Class.register(a,new AGetter("_boneResource"));a._trackResource=MO.Class.register(a,new AGetter("_trackResource"));a.construct=MO.FE3rBone_construct;a.loadResource=MO.FE3rBone_loadResource;a.update=MO.FE3rBone_update;a.dispose=MO.FE3rBone_dispose;return a};MO.FE3rBone_construct=function(){this.__base.FObject.construct.call(this);this._matrix=new MO.SMatrix3d};
MO.FE3rBone_loadResource=function(a){this._boneResource=a;this._trackResource=a.track()};MO.FE3rBone_update=function(a,b){var d=this._trackResource;d.calculate(a,b);a.update();var e=this._matrix;e.assign(d.matrixInvert());e.append(a.matrix)};MO.FE3rBone_dispose=function(){this._trackResource=this._boneResource=null;this.__base.FG3dBone.dispose.call(this)};
MO.FE3rDynamicMesh=function(a){a=MO.Class.inherits(this,a,MO.FE3dRenderable);a._model=null;a._optionMerge=!0;a._vertexPosition=0;a._vertexTotal=0;a._indexPosition=0;a._indexTotal=0;a._mergeRenderables=null;a.construct=MO.FE3rDynamicMesh_construct;a.mergeCount=MO.FE3rDynamicMesh_mergeCount;a.mergeMaxCount=MO.FE3rDynamicMesh_mergeMaxCount;a.mergeRenderables=MO.FE3rDynamicMesh_mergeRenderables;a.syncVertexBuffer=MO.FE3rDynamicMesh_syncVertexBuffer;a.mergeRenderable=MO.FE3rDynamicMesh_mergeRenderable;
a.mergeVertexBuffer=MO.FE3rDynamicMesh_mergeVertexBuffer;a.mergeIndexBuffer=MO.FE3rDynamicMesh_mergeIndexBuffer;a.build=MO.FE3rDynamicMesh_build;return a};MO.FE3rDynamicMesh_construct=function(){this.__base.FE3dRenderable.construct.call(this);this._mergeRenderables=new TObjects};MO.FE3rDynamicMesh_mergeCount=function(){return this._mergeRenderables.count()};MO.FE3rDynamicMesh_mergeMaxCount=function(){return this._model._mergeMaxCount};MO.FE3rDynamicMesh_mergeRenderables=function(){return this._mergeRenderables};
MO.FE3rDynamicMesh_syncVertexBuffer=function(a){var b=a._resource.code(),d=this._vertexBuffers.get(b);if(!d){var e=a.formatCd(),f=this._vertexTotal,d=this._graphicContext.createVertexBuffer();d.setCode(b);d.setFormatCd(e);d.setStride(a.stride());switch(e){case MO.EG3dAttributeFormat.Float1:d._data=new Float32Array(1*f);break;case MO.EG3dAttributeFormat.Float2:d._data=new Float32Array(2*f);break;case MO.EG3dAttributeFormat.Float3:d._data=new Float32Array(3*f);break;case MO.EG3dAttributeFormat.Float4:d._data=
new Float32Array(4*f);break;case MO.EG3dAttributeFormat.Byte4:case MO.EG3dAttributeFormat.Byte4Normal:d._data=new Uint8Array(4*f);break;default:throw new MO.TError("Unknown code");}this._vertexBuffers.set(b,d)}return d};
MO.FE3rDynamicMesh_mergeRenderable=function(a){var b=this._graphicContext.capability(),d=a.vertexCount(),e=a.indexBuffers().first().count(),f=b.mergeCount;if(this._mergeRenderables.count()>=f)return!1;f=this._vertexTotal+d;if(b.optionIndex32){if(f>MO.Lang.Integer.MAX_UINT32)return!1}else if(f>MO.Lang.Integer.MAX_UINT16)return!1;this._vertexTotal+=d;this._indexTotal+=e;this._mergeRenderables.push(a);return!0};
MO.FE3rDynamicMesh_mergeVertexBuffer=function(a,b,d,e){a=this._vertexPosition;d=d._data;var f=e._dataCount;switch(b){case "position":b=new Float32Array(e._data);MO.Lang.Float.copy(d,3*a,b,0,3*f);break;case "coord":b=new Float32Array(e._data);MO.Lang.Float.copy(d,2*a,b,0,2*f);break;case "color":case "normal":case "binormal":case "tangent":case "bone_index":case "bone_weight":b=new Uint8Array(e._data);MO.Lang.Byte.copy(d,4*a,b,0,4*f);break;default:throw new MO.TError("Unknown code");}};
MO.FE3rDynamicMesh_mergeIndexBuffer=function(a){var b=this._vertexPosition,d=this._indexPosition,e=this._indexBuffer._data,f=new Uint16Array(a._data);a=3*a._dataCount;for(var h=0;h<a;h++)e[d++]=b+f[h]};
MO.FE3rDynamicMesh_build=function(){var a=this._graphicContext,b=a.capability(),d=this._vertexTotal,e=this._indexTotal,f=this._mergeRenderables,h=f.count(),k=f.first();this._material=k.material();this._textures=k.textures();var q=this._instanceVertexBuffer=this._graphicContext.createVertexBuffer();q.setCode("instance");q.setStride(4);q.setFormatCd(EG3dAttributeFormat.Float1);k=q._data=new Float32Array(d);this._vertexBuffers.set(q.code(),q);q=this._indexBuffer=a.createIndexBuffer(FE3rIndexBuffer);
b.optionIndex32?(q.setStrideCd(MO.EG3dIndexStride.Uint32),q._data=new Uint32Array(e)):(q.setSstrideCd(MO.EG3dIndexStride.Uint16),q._data=new Uint16Array(e));q._count=e;this.pushIndexBuffer(q);for(b=0;b<h;b++){for(var q=f.getAt(b),a=q.vertexCount(),w=q.vertexBuffers(),x=w.count(),y=0;y<x;y++){var z=w.at(y),A=z._resource,B=A.code(),z=this.syncVertexBuffer(z);this.mergeVertexBuffer(q,B,z,A)}RFloat.fill(k,this._vertexPosition,a,b);q=q.indexBuffers().first();w=q.count();this.mergeIndexBuffer(q._resource);
this._vertexPosition+=a;this._indexPosition+=w}w=this._vertexBuffers;x=w.count();for(b=0;b<x;b++)z=w.at(b),z.upload(z._data,z.stride(),d),z._data=null;this._indexBuffer.upload(this._indexBuffer._data,e);this._indexBuffer._data=null};
MO.FE3rDynamicModel=function(a){a=MO.Class.inherits(this,a,MO.FE3rObject);a._renderables=MO.Class.register(a,new AGetter("_renderables"));a._mergeMaxCount=MO.Class.register(a,new AGetter("_mergeMaxCount"));a._mergeStride=MO.Class.register(a,new AGetter("_mergeStride"),4);a._meshes=MO.Class.register(a,new AGetter("_meshes"));a._updateDate=0;a.construct=MO.FE3rDynamicModel_construct;a.createMesh=MO.FE3rDynamicModel_createMesh;a.pushRenderable=MO.FE3rDynamicModel_pushRenderable;a.build=MO.FE3rDynamicModel_build;
a.update=MO.FE3rDynamicModel_update;return a};MO.FE3rDynamicModel_construct=function(){this.__base.FE3rObject.construct.call(this);this._renderables=new MO.TObjects;this._meshes=new MO.TObjects};MO.FE3rDynamicModel_createMesh=function(){var a=MO.Class.create(MO.FE3rDynamicMesh);a._model=this;a.linkGraphicContext(this);this._meshes.push(a);return a};MO.FE3rDynamicModel_pushRenderable=function(a){this._renderables.push(a)};
MO.FE3rDynamicModel_build=function(){var a=this._renderables,b=this._meshes,d=a.count();if(0<d)for(var e=this.createMesh(),f=0;f<d;f++){var h=a.at(f);if(!e.mergeRenderable(h)&&(e=this.createMesh(),!e.mergeRenderable(h)))throw new MO.TError(this,"Merge renderable failure.");}a=0;d=b.count();for(f=0;f<d;f++)e=b.at(f),e.build(),a=Math.max(a,e.mergeCount());this._mergeMaxCount=a};MO.FE3rDynamicModel_update=function(a){this._updateDate=MO.Timer.current()};
MO.FE3rGeometry=function(a){a=MO.Class.inherits(this,a,MO.FE3rObject);a._ready=!1;a._resource=MO.Class.register(a,new AGetSet("_resource"));a._vertexCount=MO.Class.register(a,new AGetter("_vertexCount"),0);a._vertexBuffers=MO.Class.register(a,new AGetter("_vertexBuffers"));a._indexBuffer=MO.Class.register(a,new AGetter("_indexBuffer"));a._indexBuffers=MO.Class.register(a,new AGetter("_indexBuffers"));a._resourceMaterial=MO.Class.register(a,new AGetter("_resourceMaterial"));a._material=MO.Class.register(a,
new AGetter("_material"));a._textures=MO.Class.register(a,new AGetter("_textures"));a.construct=MO.FE3rGeometry_construct;a.testReady=MO.FE3rGeometry_testReady;a.findVertexBuffer=MO.FE3rGeometry_findVertexBuffer;a.findTexture=MO.FE3rGeometry_findTexture;a.loadResource=MO.FE3rGeometry_loadResource;a.processLoad=MO.FE3rGeometry_processLoad;return a};MO.FE3rGeometry_construct=function(){this.__base.FE3rObject.construct.call(this);this._vertexBuffers=new MO.TDictionary;this._indexBuffers=new MO.TObjects};
MO.FE3rGeometry_testReady=function(){if(!this._ready){if(!this._resource.testReady())return!1;var a=this._textures;if(null!=a)for(var b=a.count(),d=0;d<b;d++)if(!a.value(d).testReady())return!1}return this._ready};MO.FE3rGeometry_guid=function(){return this._resource.guid()};MO.FE3rGeometry_findVertexBuffer=function(a){return this._vertexBuffers.get(a)};MO.FE3rGeometry_findTexture=function(a){return this._textures.get(a)};
MO.FE3rGeometry_loadResource=function(a){var b=this._graphicContext;this._resource=a;a=a.streams();for(var d=a.count(),e=0;e<d;e++){var f=a.at(e),h=f.code(),k=f.dataCount(),q=f.data();if("index16"==h||"index32"==h){var w=this._indexBuffer=b.createIndexBuffer(FE3rIndexBuffer);w._resource=f;f=f.elementDataCd();if(f==MO.EDataType.Uint16)w.setStrideCd(MO.EG3dIndexStride.Uint16);else if(f==MO.EDataType.Uint32)w.setStrideCd(MO.EG3dIndexStride.Uint32);else throw new MO.TError(this,"Unknown data type.");
w.upload(q,3*k);this._indexBuffers.push(w)}else{w=b.createVertexBuffer(FE3rVertexBuffer);w.setCode(h);w._resource=f;w._vertexCount=k;var x=null;switch(h){case "position":x=new Float32Array(q);w.setFormatCd(EG3dAttributeFormat.Float3);this._vertexCount=k;break;case "coord":x=new Float32Array(q);w.setFormatCd(EG3dAttributeFormat.Float2);break;case "color":x=new Uint8Array(q);w.setFormatCd(EG3dAttributeFormat.Byte4Normal);break;case "normal":case "binormal":case "tangent":x=new Uint8Array(q);w.setFormatCd(EG3dAttributeFormat.Byte4Normal);
break;default:throw new TError(this,"Unknown code");}w.upload(x,f._dataStride,k);this._vertexBuffers.set(h,w)}}this._ready=!0};MO.FE3rGeometry_processLoad=function(){if(this._dataReady)return!0;if(!this._resource.testReady())return!1;this.loadResource(this._resource);return!0};MO.FE3rIndexBuffer=function(a){a=MO.Class.inherits(this,a,MO.FWglIndexBuffer,MO.MLinkerResource);a.dispose=MO.FE3rIndexBuffer_dispose;return a};
MO.FE3rIndexBuffer_dispose=function(){this.__base.MLinkerResource.dispose.call(this);this.__base.FWglIndexBuffer.dispose.call(this)};MO.FE3rInstanceMesh=function(a){a=MO.Class.inherits(this,a,MO.FE3rMesh);a._merges=null;a.construct=MO.FE3rInstanceMesh_construct;a.mergeRenderable=MO.FE3rInstanceMesh_mergeRenderable;a.build=MO.FE3rInstanceMesh_build;return a};MO.FE3rInstanceMesh_construct=function(){this.__base.FE3rMesh.construct.call(this);this._merges=new MO.TObjects};
MO.FE3rInstanceMesh_mergeRenderable=function(a){this._merges.push(a)};MO.FE3rInstanceMesh_build=function(){};
MO.FE3rMaterial=function(a){a=MO.Class.inherits(this,a,MO.FG3dMaterial,MO.MGraphicObject,MO.MLinkerResource);a._ready=!1;a._visible=MO.Class.register(a,new MO.AGetSet("_visible"),!0);a._guid=MO.Class.register(a,new MO.AGetSet("_guid"));a._bitmaps=MO.Class.register(a,new MO.AGetter("_bitmaps"));a._reference=MO.Class.register(a,new MO.AGetter("_reference"));a.findBitmap=MO.FE3rMaterial_findBitmap;a.testReady=MO.FE3rMaterial_testReady;a.testVisible=MO.FE3rMaterial_testVisible;a.loadResource=MO.FE3rMaterial_loadResource;
a.reloadResource=MO.FE3rMaterial_reloadResource;a.load=MO.FE3rMaterial_load;return a};MO.FE3rMaterial_findBitmap=function(a){return this._bitmaps.get(a)};MO.FE3rMaterial_testReady=function(){if(!this._ready){var a=this._bitmaps;if(a)for(var b=a.count(),d=0;d<b;d++)if(!a.at(d).testReady())return!1;this._ready=!0}return this._ready};MO.FE3rMaterial_testVisible=function(){var a=this._visible;a&&this._reference&&(a=this._reference.testVisible());return a};
MO.FE3rMaterial_loadResource=function(a){this._guid=a.guid();this._resource=a;this._info.calculate(a.info());this._dirty=!0};MO.FE3rMaterial_reloadResource=function(){this._info.calculate(this._resource.info());this._dirty=!0};
MO.FE3rMaterial_load=function(){var a=this._resource.bitmaps();if(a)for(var b=MO.Console.find(MO.FE3rBitmapConsole),d=this._bitmaps=new MO.TDictionary,e=a.count(),f=0;f<e;f++){var h=a.at(f),k=h.code(),q=h.bitmapPack().code(),q=b.load(this,this._guid,q),w=MO.Class.create(MO.FE3rBitmap);w._pack=q;w.loadResource(h);d.set(k,w)}};
MO.FE3rMaterialConsole=function(a){a=MO.Class.inherits(this,a,MO.FConsole);a._scopeCd=MO.EScope.Local;a._materials=null;a.construct=MO.FE3rMaterialConsole_construct;a.load=MO.FE3rMaterialConsole_load;return a};MO.FE3rMaterialConsole_construct=function(){this.__base.FConsole.construct.call(this);this._materials=new MO.TDictionary};
MO.FE3rMaterialConsole_load=function(a,b){if(!a)throw new MO.TError("Graphics context is empty");if(!b)throw new MO.TError("Material guid is empty");var d=this._materials.get(b);if(d)return d;var e=MO.Console.find(MO.FE3sMaterialConsole).find(b),d=MO.Class.create(MO.FE3rMaterial);d.linkGraphicContext(a);d.loadResource(e);d.load();this._materials.set(b,d);return d};
MO.FE3rMesh=function(a){a=MO.Class.inherits(this,a,MO.FE3rObject);a._ready=!1;a._resource=MO.Class.register(a,new AGetSet("_resource"));a._vertexCount=MO.Class.register(a,new AGetter("_vertexCount"),0);a._vertexBuffers=MO.Class.register(a,new AGetter("_vertexBuffers"));a._indexBuffer=MO.Class.register(a,new AGetter("_indexBuffer"));a._resourceMaterial=MO.Class.register(a,new AGetter("_resourceMaterial"));a._material=MO.Class.register(a,new AGetter("_material"));a._textures=MO.Class.register(a,new AGetter("_textures"));
a.construct=MO.FE3rMesh_construct;a.testReady=MO.FE3rMesh_testReady;a.findVertexBuffer=MO.FE3rMesh_findVertexBuffer;a.findTexture=MO.FE3rMesh_findTexture;a.loadResource=MO.FE3rMesh_loadResource;a.processLoad=MO.FE3rMesh_processLoad;return a};MO.FE3rMesh_construct=function(){this.__base.FE3rObject.construct.call(this);this._vertexBuffers=new TObjects};
MO.FE3rMesh_testReady=function(){if(!this._ready){if(!this._resource.testReady())return!1;var a=this._textures;if(null!=a)for(var b=a.count(),d=0;d<b;d++)if(!a.value(d).testReady())return!1}return this._ready};MO.FE3rMesh_guid=function(){return this._resource.guid()};MO.FE3rMesh_findVertexBuffer=function(a){for(var b=this._vertexBuffers,d=b.count(),e=0;e<d;e++){var f=b.get(e);if(f.name()==a)return f}return null};MO.FE3rMesh_findTexture=function(a){return this._textures.get(a)};
MO.FE3rMesh_loadResource=function(a){var b=this._graphicContext;this._resource=a;a=a.streams();for(var d=a.count(),e=0;e<d;e++){var f=a.get(e),h=f._code,k=f._dataCount,q=f._data;if("index16"==h||"index32"==h){var w=this._indexBuffer=b.createIndexBuffer();w._resource=f;f=f.elementDataCd();if(f==EDataType.Uint16)w._strideCd=EG3dIndexStride.Uint16;else if(f==EDataType.Uint32)w._strideCd=EG3dIndexStride.Uint32;else throw new TError(this,"Unknown data type.");w.upload(q,3*k)}else{w=b.createVertexBuffer();
w._name=h;w._resource=f;w._vertexCount=k;var x=null;switch(h){case "position":x=new Float32Array(q);w._formatCd=EG3dAttributeFormat.Float3;break;case "coord":x=new Float32Array(q);w._formatCd=EG3dAttributeFormat.Float2;break;case "color":x=new Uint8Array(q);w._formatCd=EG3dAttributeFormat.Byte4Normal;break;case "normal":case "binormal":case "tangent":x=new Uint8Array(q);w._formatCd=EG3dAttributeFormat.Byte4Normal;break;default:throw new TError(this,"Unknown code");}w.upload(x,f._dataStride,k);this._vertexBuffers.push(w)}}this._ready=
!0};MO.FE3rMesh_processLoad=function(){if(this._dataReady)return!0;if(!this._resource.testReady())return!1;this.loadResource(this._resource);return!0};MO.FE3rMeshAnimation=function(a){a=MO.Class.inherits(this,a,MO.FE3rAnimation);a.process=MO.FE3rMeshAnimation_process;return a};MO.FE3rMeshAnimation_process=function(a){if(this._valid){var b=Math.abs(this._currentTick),d=a._resource,e=this._playInfo;d.calculate(e,b);e.update();a=a._matrix;a.assign(d.matrixInvert());a.append(e.matrix)}};
MO.FE3rMeshConsole=function(a){a=MO.Class.inherits(this,a,MO.FConsole);a._scopeCd=MO.EScope.Local;a._loadMeshs=null;a._meshs=MO.Class.register(a,new AGetter("_meshs"));a._thread=null;a._interval=200;a.onProcess=MO.FE3rMeshConsole_onProcess;a.construct=MO.FE3rMeshConsole_construct;a.findMesh=MO.FE3rMeshConsole_findMesh;a.loadByGuid=MO.FE3rMeshConsole_loadByGuid;a.loadByCode=MO.FE3rMeshConsole_loadByCode;return a};
MO.FE3rMeshConsole_onProcess=function(){var a=this._loadMeshs;for(a.record();a.next();)a.current().processLoad()&&a.removeCurrent()};MO.FE3rMeshConsole_construct=function(){this.__base.FConsole.construct.call(this);this._loadMeshs=new MO.TLooper;this._meshs=new MO.TDictionary;var a=this._thread=MO.Class.create(MO.FThread);a.setInterval(this._interval);a.addProcessListener(this,this.onProcess);MO.Console.find(MO.FThreadConsole).start(a)};MO.FE3rMeshConsole_findMesh=function(a){return this._meshs.get(a)};
MO.FE3rMeshConsole_loadByGuid=function(a,b){if(!MO.Class.isClass(a,MO.MGraphicObject))throw new MO.TError("Graphics context is empty");if(MO.Lang.String.isEmpty(b))throw new MO.TError("Mesh guid is empty");var d=this._meshs.get(b);if(d)return d;var e=MO.Console.find(MO.FE3sMeshConsole).loadByGuid(b),d=MO.Class.create(MO.FE3rMesh);d.linkGraphicContext(a);d.setCode(b);d.setResource(e);this._meshs.set(b,d);e.testReady()?d.loadResource(e):this._loadMeshs.push(d);return d};
MO.FE3rMeshConsole_loadByCode=function(a,b){if(!MO.Class.isClass(a,MO.MGraphicObject))throw new MO.TError("Graphics context is empty");if(MO.Lang.String.isEmpty(b))throw new MO.TError("Mesh code is empty");var d=this._meshs.get(b);if(d)return d;var e=MO.Console.find(MO.FE3sMeshConsole).loadByCode(b),d=MO.Class.create(MO.FE3rMesh);d.linkGraphicContext(a);d.setCode(b);d.setResource(e);this._meshs.set(b,d);e.testReady()?d.loadResource(e):this._loadMeshs.push(d);return d};
MO.FE3rModel=function(a){a=MO.Class.inherits(this,a,MO.FE3rObject);a._resource=MO.Class.register(a,new AGetSet("_resource"));a._meshes=MO.Class.register(a,new AGetter("_meshes"));a._skeletons=MO.Class.register(a,new AGetter("_skeletons"));a._dataReady=!1;a.findMeshByGuid=MO.FE3rModel_findMeshByGuid;a.testReady=MO.FE3rModel_testReady;a.loadResource=MO.FE3rModel_loadResource;a.loadSkeletonResource=MO.FE3rModel_loadSkeletonResource;a.processLoad=MO.FE3rModel_processLoad;a.dispose=MO.FE3rModel_dispose;
return a};MO.FE3rModel_findMeshByGuid=function(a){for(var b=this._meshes,d=b.count(),e=0;e<d;e++){var f=b.get(e);if(f._guid==a)return f}return null};MO.FE3rModel_testReady=function(){return this._dataReady};MO.FE3rModel_loadSkeletonResource=function(a){var b=MO.Console.find(MO.FE3rModelConsole);if(a=a.skins())for(var d=a.count(),e=0;e<d;e++){var f=a.at(e),h=MO.Class.create(MO.FE3rSkin);h.linkGraphicContext(this);h.loadResource(f);f=f.meshGuid();b.findMesh(f).pushSkin(h)}};
MO.FE3rModel_loadResource=function(a){var b=MO.Console.find(MO.FE3rModelConsole),d=a.meshes();if(d)for(var e=this._meshes=new MO.TObjects,f=d.count(),h=0;h<f;h++){var k=d.valueAt(h),q=MO.Class.create(MO.FE3rModelMesh);q.linkGraphicContext(this);q.loadResource(k);e.push(q);b.meshs().set(q.guid(),q)}if(a=a.skeletons())for(b=a.count(),h=0;h<b;h++)d=a.get(h),this.loadSkeletonResource(d);this._dataReady=!0};
MO.FE3rModel_processLoad=function(){if(this._dataReady)return!0;if(!this._resource.testReady())return!1;this.loadResource(this._resource);return!0};MO.FE3rModel_dispose=function(){this._ready=!1;this._resource=null;this._meshes=MO.Lang.Object.dispose(this._meshes);this._skeletons=MO.Lang.Object.dispose(this._skeletons);this.__base.FObject.dispose.call(this)};
MO.FE3rModelConsole=function(a){a=MO.Class.inherits(this,a,MO.FConsole);a._scopeCd=MO.EScope.Local;a._loadModels=null;a._models=MO.Class.register(a,new MO.AGetter("_models"));a._meshs=MO.Class.register(a,new MO.AGetter("_meshs"));a._dynamicMeshs=null;a._thread=null;a._interval=200;a.onProcess=MO.FE3rModelConsole_onProcess;a.construct=MO.FE3rModelConsole_construct;a.findModel=MO.FE3rModelConsole_findModel;a.findMesh=MO.FE3rModelConsole_findMesh;a.load=MO.FE3rModelConsole_load;a.loadMeshByGuid=MO.FE3rModelConsole_loadMeshByGuid;
a.loadMeshByCode=MO.FE3rModelConsole_loadMeshByCode;a.merge=MO.FE3rModelConsole_merge;return a};MO.FE3rModelConsole_onProcess=function(){var a=this._loadModels;for(a.record();a.next();)a.current().processLoad()&&a.removeCurrent()};
MO.FE3rModelConsole_construct=function(){this.__base.FConsole.construct.call(this);this._loadModels=new MO.TLooper;this._models=new MO.TDictionary;this._meshs=new MO.TDictionary;this._dynamicMeshs=new MO.TDictionary;var a=this._thread=MO.Class.create(MO.FThread);a.setInterval(this._interval);a.addProcessListener(this,this.onProcess);MO.Console.find(MO.FThreadConsole).start(a)};MO.FE3rModelConsole_findModel=function(a){return this._models.get(a)};MO.FE3rModelConsole_findMesh=function(a){return this._meshs.get(a)};
MO.FE3rModelConsole_load=function(a,b){if(!a)throw new MO.TError("Graphics context is empty");if(!b)throw new MO.TError("Model guid is empty");var d=this._models.get(b);if(d)return d;var e=MO.Console.find(MO.FE3sModelConsole).load(b),d=MO.Class.create(MO.FE3rModel);d.linkGraphicContext(a);d.setCode(b);d.setResource(e);this._models.set(b,d);this._loadModels.push(d);return d};
MO.FE3rModelConsole_loadMeshByGuid=function(a,b){if(!a)throw new MO.TError("Graphics context is empty");if(!guid)throw new MO.TError("Model guid is empty");var d=this._models.get(b);if(d)return d;MO.Console.find(MO.FE3sModelConsole).load(guid);d=MO.Class.create(MO.FE3rModel);d.linkGraphicContext(pc);d.setCode(b);d.setResource(rm);this._models.set(b,d);rm.testReady()?d.loadResource(rm):this._loadModels.push(d);return d};
MO.FE3rModelConsole_loadMeshByCode=function(a,b){if(!MO.Class.isClass(a,MO.MGraphicObject))throw new MO.TError("Graphics context is empty");if(MO.Lang.String.isEmpty(b))throw new MO.TError("Model guid is empty");var d=this._models.get(b);if(d)return d;var e=MO.Console.find(MO.FE3sModelConsole).load(guid),d=MO.Class.create(MO.FE3rModel);d.linkGraphicContext(pc);d.setCode(b);d.setResource(e);this._models.set(b,d);rm.testReady()?m.loadResource(rm):this._loadModels.push(m);return m};
MO.FE3rModelConsole_merge=function(a,b,d,e){a="merge";for(var f=b.renderables(),h=0;h<e;h++){var k=f.getAt(d+h);a+="|"+k.hashCode()}var q=this._dynamicMeshs.get(a);if(!q){q=MO.Class.create(MO.FE3rDynamicModel);q.linkGraphicContext(b);for(h=0;h<e;h++)k=f.getAt(d+h),q.pushRenderable(k);q.build();this._dynamicMeshs.set(a,q);MO.Logger.info(this,"Create merge model. (mesh={1}, renderables={2})",q.meshes().count(),q.renderables().count())}q.update();return q};
MO.FE3rModelMesh=function(a){a=MO.Class.inherits(this,a,MO.FE3rGeometry);a._ready=!1;a._resourceMaterial=null;a._skins=MO.Class.register(a,new AGetter("_skins"));a._boneIds=MO.Class.register(a,new AGetter("_boneIds"));a.construct=MO.FE3rModelMesh_construct;a.testReady=MO.FE3rModelMesh_testReady;a.guid=MO.FE3rModelMesh_guid;a.pushSkin=MO.FE3rModelMesh_pushSkin;return a};MO.FE3rModelMesh_construct=function(){this.__base.FE3rGeometry.construct.call(this)};
MO.FE3rModelMesh_testReady=function(){if(!this._ready){var a=this._textures;if(a)for(var b=a.count(),d=0;d<b;d++)if(!a.at(d).testReady())return!1;this._ready=!0}return this._ready};MO.FE3rModelMesh_guid=function(){return this._resource.guid()};MO.FE3rModelMesh_pushSkin=function(a){var b=this._skins;b||(b=this._skins=new MO.TObjects);b.push(a)};
MO.FE3rObject=function(a){a=MO.Class.inherits(this,a,MO.FObject,MO.MGraphicObject);a._guid=MO.Class.register(a,new MO.AGetSet("_guid"));a._code=MO.Class.register(a,new MO.AGetSet("_code"));return a};MO.FE3rPipeline=function(a){a=MO.Class.inherits(this,a,MO.FObject);a._vertexBuffers=null;a._indexBuffer=null;a.construct=MO.FE3rPipeline_construct;a.findVertexBuffer=MO.FE3rPipeline_findVertexBuffer;a.loadResource=MO.FE3rPipeline_loadResource;return a};
MO.FE3rPipeline_construct=function(){this.__base.FRenderable.construct.call(this);this._vertexBuffers=new MO.TObjects};MO.FE3rPipeline_findVertexBuffer=function(a){for(var b=this._vertexBuffers,d=b.count(),e=0;e<d;e++){var f=b.get(e);if(f.name()==a)return f}return null};
MO.FE3rPipeline_loadResource=function(a){for(var b=this._context,d=a.vertexBuffers(),e=d.count(),f=0;f<e;f++){var h=d.get(f),k=context.createVertexBuffer();k._name=h.name();k.upload(new Float32Array(h._data),h._stride,h._vertexCount);this._vertexBuffers.push(k)}a=a.indexBuffer();(this._indexBuffer=b.createIndexBuffer()).upload(a.data(),a.count())};
MO.FE3rSkeleton=function(a){a=MO.Class.inherits(this,a,MO.FE3rObject,MO.MLinkerResource);a._bones=MO.Class.register(a,new AGetter("_bones"));a._skins=MO.Class.register(a,new AGetter("_skins"));a.loadResource=MO.FE3rSkeleton_loadResource;return a};MO.FE3rSkeleton_loadResource=function(a){this._resource=a;a=a._bones;var b=a.count();if(0<b)for(var d=this._bones=new MO.TObjects,e=0;e<b;e++){var f=a.at(e),h=MO.Class.create(MO.FE3rBone);h.loadResource(f);d.push(h)}};
MO.FE3rSkeletonAnimation=function(a){a=MO.Class.inherits(this,a,MO.FE3rAnimation);a.process=MO.FE3rSkeletonAnimation_process;return a};MO.FE3rSkeletonAnimation_process=function(a){if(this._valid){var b=Math.abs(this._currentTick);a=a.bones();for(var d=a.count(),e=0;e<d;e++)a.at(e).update(this._playInfo,b)}};
MO.FE3rSkin=function(a){a=MO.Class.inherits(this,a,MO.FE3rObject);a._resource=MO.Class.register(a,new AGetter("_resource"));a._streams=MO.Class.register(a,new AGetter("_streams"));a.loadResource=MO.FE3rSkin_loadResource;return a};MO.FE3rSkin_loadResource=function(a){this._resource=a;if(a=a.streams()){var b=a.count();if(0<b)for(var d=this._streams=new MO.TObjects,e=0;e<b;e++){var f=a.at(e),h=MO.Class.create(MO.FE3rStream);h.linkGraphicContext(this);h.loadResource(f);d.push(h)}}};
MO.FE3rStream=function(a){a=MO.Class.inherits(this,a,MO.FE3rObject);a._resource=MO.Class.register(a,new MO.AGetter("_resource"));a._buffer=MO.Class.register(a,new MO.AGetter("_buffer"));a.loadResource=MO.FE3rStream_loadResource;return a};
MO.FE3rStream_loadResource=function(a){var b=a.code(),d=a._dataCount;this._resource=a;this._vertexCount=d;var e=this._buffer=this._graphicContext.createVertexBuffer(FE3rVertexBuffer);e.setCode(b);e.setResource(a);switch(b){case "bone_index":e.setFormatCd(EG3dAttributeFormat.Byte4);break;case "bone_weight":e.setFormatCd(EG3dAttributeFormat.Byte4Normal);break;default:throw new MO.TError("Unknown code");}e.upload(a._data,a._dataStride,d)};
MO.FE3rTexture=function(a){a=MO.Class.inherits(this,a,MO.FObject,MO.MGraphicObject);a._resource=MO.Class.register(a,new MO.AGetSet("_resource"));a._bitmaps=MO.Class.register(a,new MO.AGetter("_bitmaps"));a._bitmapPacks=MO.Class.register(a,new MO.AGetter("_bitmapPacks"));a._ready=!1;a._dataReady=!1;a.construct=MO.FE3rTexture_construct;a.testReady=MO.FE3rTexture_testReady;a.loadBitmap=MO.FE3rTexture_loadBitmap;a.loadResource=MO.FE3rTexture_loadResource;a.load=MO.FE3rTexture_load;a.processLoad=MO.FE3rTexture_processLoad;
a.dispose=MO.FE3rTexture_dispose;return a};MO.FE3rTexture_construct=function(){this.__base.FObject.construct.call(this);this._bitmaps=new MO.TDictionary};MO.FE3rTexture_testReady=function(){return this._ready};MO.FE3rTexture_loadBitmap=function(a){var b=this._bitmaps,d=b.get(a);d||(d=MO.Class.create(MO.FE3rTextureBitmap),b.set(a,d));return d};
MO.FE3rTexture_loadResource=function(a){if(a=a.bitmapPacks()){this._bitmapPacks=new MO.TDictionary;for(var b=a.count(),d=0;d<b;d++){var e=a.valueAt(d),f=null;if("flat"==e._typeName)f=MO.Class.create(MO.FE3rTextureBitmapFlatPack);else if("cube"==e._typeName)f=MO.Class.create(MO.FE3rTextureBitmapCubePack);else throw new MO.TError(this,"Load resource failure.");f.linkGraphicContext(this);f.loadResource(e);this._bitmapPacks.set(e.code(),f)}}this._dataReady=!0};
MO.FE3rTexture_load=function(){for(var a=this._resource.bitmaps(),b=a.count()-1;0<=b;b--){var d=a.valueAt(b),e=this.loadBitmap(d.guid()),d=this._bitmapPacks.get(d.packCode());if(!d)throw new MO.TError("Link pack is not eists.");e.load(d)}this._ready=!0};MO.FE3rTexture_processLoad=function(){if(this._dataReady){for(var a=this._bitmapPacks,b=a.count()-1;0<=b;b--)if(!a.valueAt(b).testReady())return!1;this.load()}else{if(!this._resource.testReady())return!1;this.loadResource(this._resource)}return this._ready};
MO.FE3rTexture_dispose=function(){this._ready=!1;this._resource=null;this._bitmaps=MO.Lang.Object.dispose(this._bitmaps);this.__base.FObject.dispose.call(this)};MO.FE3rTextureBitmap=function(a){a=MO.Class.inherits(this,a,MO.FObject,MO.MGraphicObject);a._ready=!1;a._bitmapPack=null;a.construct=MO.FE3rTextureBitmap_construct;a.texture=MO.FE3rTextureBitmap_texture;a.testReady=MO.FE3rTextureBitmap_testReady;a.load=MO.FE3rTextureBitmap_load;a.dispose=MO.FE3rTextureBitmap_dispose;return a};
MO.FE3rTextureBitmap_construct=function(){this.__base.FObject.construct.call(this)};MO.FE3rTextureBitmap_texture=function(){return this._bitmapPack.texture()};MO.FE3rTextureBitmap_testReady=function(){return this._ready};MO.FE3rTextureBitmap_load=function(a){this._bitmapPack=a;this._ready=!0};MO.FE3rTextureBitmap_dispose=function(){this._context=null;this._ready=!1;this._bitmapPack=null;this.__base.FObject.dispose.call(this)};
MO.FE3rTextureBitmapCubePack=function(a){a=MO.Class.inherits(this,a,MO.FE3rTextureBitmapPack);a._resource=null;a._images=null;a.onLoad=MO.FE3rTextureBitmapCubePack_onLoad;a.construct=MO.FE3rTextureBitmapCubePack_construct;a.loadResource=MO.FE3rTextureBitmapCubePack_loadResource;a.dispose=MO.FE3rTextureBitmapCubePack_dispose;return a};
MO.FE3rTextureBitmapCubePack_onLoad=function(a){var b=this._graphicContext;a=this._images;for(var d=MO.Window.Browser.capability(),e=0;6>e;e++)if(!a[e].testReady())return;(this._texture=b.createCubeTexture()).upload(a[0],a[1],a[2],a[3],a[4],a[5]);if(d.blobCreate)for(e=0;6>e;e++)b=a[e],window.URL.revokeObjectURL(b.url()),a[e]=MO.Lang.Object.dispose(b);this._images=MO.Lang.Object.dispose(this._images);this._dataReady=!0};MO.FE3rTextureBitmapCubePack_construct=function(){this.__base.FE3rTextureBitmapPack.construct.call(this)};
MO.FE3rTextureBitmapCubePack_loadResource=function(a){this._resource=a;var b=a._texture,d=MO.Window.Browser.capability(),e=a.data(),f=a._formatName;this._images=new MO.TObjects;for(var h=0;6>h;h++){var k=this._images[h]=MO.Class.create(FImage);k._index=h;k.setOptionAlpha(!1);if(d.blobCreate)var q=new Blob([e[h]],{type:"image/"+f}),q=window.URL.createObjectURL(q);else q=MO.Window.Browser.hostPath("/cloud.content.texture.bitmap.wv")+"?guid="+b._guid+"&code="+a._code+"&index="+h;k.loadUrl(q);k.addLoadListener(this,
this.onLoad)}};MO.FE3rTextureBitmapCubePack_dispose=function(){this._images=MO.Lang.Object.dispose(this._images);this.__base.FE3rTextureBitmapPack.dispose.call(this)};MO.FE3rTextureBitmapFlatPack=function(a){a=MO.Class.inherits(this,a,MO.FE3rTextureBitmapPack);a._resource=null;a._image=null;a.onLoad=MO.FE3rTextureBitmapFlatPack_onLoad;a.construct=MO.FE3rTextureBitmapFlatPack_construct;a.loadResource=MO.FE3rTextureBitmapFlatPack_loadResource;a.dispose=MO.FE3rTextureBitmapFlatPack_dispose;return a};
MO.FE3rTextureBitmapFlatPack_onLoad=function(a){a=this._texture=this._graphicContext.createFlatTexture();a.upload(this._image);a.makeMipmap();this._image=MO.Lang.Object.dispose(this._image);this._dataReady=!0};MO.FE3rTextureBitmapFlatPack_construct=function(){this.__base.FE3rTextureBitmapPack.construct.call(this)};
MO.FE3rTextureBitmapFlatPack_loadResource=function(a){this._resource=a;var b=a._texture,d=a.code();(this._image=MO.Console.find(MO.FE3sTextureConsole).loadBitmap(b._guid,d,a._formatName)).addLoadListener(this,this.onLoad)};MO.FE3rTextureBitmapFlatPack_dispose=function(){this._image=MO.Lang.Object.dispose(this._image);this.__base.FE3rTextureBitmapPack.dispose.call(this)};
MO.FE3rTextureBitmapPack=function(a){a=MO.Class.inherits(this,a,MO.FObject,MO.MGraphicObject);a._resource=null;a._image=null;a._texture=MO.Class.register(a,new AGetter("_texture"));a._ready=!1;a._dataReady=!1;a.onLoad=MO.Method.virtual(a,"onLoad");a.construct=MO.FE3rTextureBitmapPack_construct;a.testReady=MO.FE3rTextureBitmapPack_testReady;a.loadResource=MO.Method.virtual(a,"loadResource");a.dispose=MO.FE3rTextureBitmapPack_dispose;return a};MO.FE3rTextureBitmapPack_construct=function(){this.__base.FObject.construct.call(this)};
MO.FE3rTextureBitmapPack_testReady=function(){this._dataReady&&(this._ready=this._texture.isValid());return this._ready};MO.FE3rTextureBitmapPack_dispose=function(){this._dataReady=this._ready=!1;this.__base.FObject.dispose.call(this)};
MO.FE3rTextureConsole=function(a){a=MO.Class.inherits(this,a,MO.FConsole);a._scopeCd=MO.EScope.Local;a._loadTextures=null;a._bitmaps=MO.Class.register(a,new AGetter("_bitmaps"));a._textures=MO.Class.register(a,new AGetter("_textures"));a._thread=null;a._interval=200;a.onProcess=MO.FE3rTextureConsole_onProcess;a.construct=MO.FE3rTextureConsole_construct;a.load=MO.FE3rTextureConsole_load;a.loadBitmap=MO.FE3rTextureConsole_loadBitmap;return a};
MO.FE3rTextureConsole_onProcess=function(){var a=this._loadTextures;for(a.record();a.next();)a.current().processLoad()&&a.removeCurrent()};MO.FE3rTextureConsole_construct=function(){this.__base.FConsole.construct.call(this);this._loadTextures=new MO.TLooper;this._bitmaps=new MO.TDictionary;this._textures=new MO.TDictionary;var a=this._thread=MO.Class.create(MO.FThread);a.setInterval(this._interval);a.addProcessListener(this,this.onProcess);MO.Console.find(MO.FThreadConsole).start(a)};
MO.FE3rTextureConsole_load=function(a,b,d){if(a=this._textures.get(b+"|"+d))return a;b=MO.Window.Browser.hostPath(this._dataUrl+"?guid="+b+"&code="+d);MO.Logger.info(this,"Load bitmap. (url={1})",b);bitmap="environment"==d?MO.Window.Class.create(MO.FE3rTextureCube):MO.Window.Class.create(MO.FE3rTexture);t._name=pg;t.linkGraphicContext(pc);t.load(u);this._bitmaps.set(pg,t);return t};
MO.FE3rTextureConsole_load2=function(a,b){var d=this._textures,e=d.get(b);if(e)return e;var f=MO.Console.find(MO.FE3sTextureConsole).load(b),e=MO.Class.create(MO.FE3rTexture);e.linkGraphicContext(a);e.setResource(f);d.set(b,e);this._loadTextures.push(e);return e};MO.FE3rTextureConsole_loadBitmap=function(a,b,d){var e=this._bitmaps.get(d);return e?e:this.load(a,b).loadBitmap(d)};
MO.FE3rTrack=function(a){a=MO.Class.inherits(this,a,MO.FObject);a._matrix=MO.Class.register(a,new AGetter("_matrix"));a._resource=MO.Class.register(a,new AGetter("_resource"));a.construct=MO.FE3rTrack_construct;a.loadResource=MO.FE3rTrack_loadResource;a.dispose=MO.FE3rTrack_dispose;return a};MO.FE3rTrack_construct=function(){this.__base.FObject.construct.call(this);this._matrix=new MO.SMatrix3d};
MO.FE3rTrack_loadResource=function(a){this._resource=a;var b=a.frames();null!=b&&(this._frameCount=b.count());this._frameTick=a.frameTick()};MO.FE3rTrack_dispose=function(){this._resource=null;this.__base.FG3dTrack.dispose.call(this)};MO.FE3rVertexBuffer=function(a){a=MO.Class.inherits(this,a,MO.FWglVertexBuffer,MO.MLinkerResource);a.dispose=MO.FE3rVertexBuffer_dispose;return a};MO.FE3rVertexBuffer_dispose=function(){this.__base.MLinkerResource.dispose.call(this);this.__base.FWglVertexBuffer.dispose.call(this)};
MO.FE3dAutomaticEffect=function(a){a=MO.Class.inherits(this,a,MO.FG3dAutomaticEffect);a.drawGroup=MO.FE3dAutomaticEffect_drawGroup;return a};
MO.FE3dAutomaticEffect_drawGroup=function(a,b,d,e){if(1<e){var f=MO.Console.find(MO.FE3rModelConsole).merge(this,a,d,e);if(f){b=this._graphicContext;f=f.meshes();d=f.count();e=a.spaceName();var h=f.first(),k=h.selectInfo(e),q=k.effect;q||(q=k.effect=MO.Console.find(MO.FG3dEffectConsole).find(b,a,h));for(b=1;b<d;b++)h=f.getAt(b),k=h.selectInfo(e),k.effect=q;return q.drawRenderables(a,f,0,d)}}this.drawRenderables(a,b,d,e)};
MO.FE3dControlAutomaticEffect=function(a){a=MO.Class.inherits(this,a,MO.FG3dAutomaticEffect);a._code="control.automatic";a.drawRenderable=MO.FE3dControlAutomaticEffect_drawRenderable;return a};
MO.FE3dControlAutomaticEffect_drawRenderable=function(a,b){var d=this._graphicContext,e=this._program,f=b.currentMatrix(),h=a.calculate(MO.EG3dRegionParameter.CameraViewProjectionMatrix),k=b.material(),q=k.info();this.bindMaterial(k);e.setParameter("vc_model_matrix",f);e.setParameter("vc_vp_matrix",h);e.setParameter4("fc_alpha",q.alphaBase,q.alphaRate,q.alphaLevel,q.alphaMerge);e.setParameter("fc_ambient_color",q.ambientColor);this.bindAttributes(b);this.bindSamplers(b);e=b.indexBuffers().first();
d.drawTriangles(e)};MO.FE3dControlFrameEffect=function(a){a=MO.Class.inherits(this,a,MO.FG3dAutomaticEffect);a._code="control.frame";a.drawRenderable=MO.FE3dControlFrameEffect_drawRenderable;return a};
MO.FE3dControlFrameEffect_drawRenderable=function(a,b){var d=this._graphicContext,e=this._program,f=a.calculate(MO.EG3dRegionParameter.CameraPosition),h=a.calculate(MO.EG3dRegionParameter.LightDirection),k=b.material(),q=k.info();this.bindMaterial(k);e.setParameter("vc_model_matrix",b.currentMatrix());e.setParameter("vc_vp_matrix",a.calculate(MO.EG3dRegionParameter.CameraViewProjectionMatrix));e.setParameter("vc_camera_position",f);e.setParameter("vc_light_direction",h);e.setParameter("fc_camera_position",
f);e.setParameter("fc_light_direction",h);e.setParameter("fc_color",q.ambientColor);e.setParameter4("fc_vertex_color",q.colorMin,q.colorMax,q.colorRate,q.colorMerge);e.setParameter4("fc_alpha",q.alphaBase,q.alphaRate,q.alphaLevel,q.alphaMerge);e.setParameter("fc_ambient_color",q.ambientColor);e.setParameter("fc_diffuse_color",q.diffuseColor);e.setParameter("fc_specular_color",q.specularColor);e.setParameter4("fc_specular",q.specularBase,q.specularLevel,q.specularAverage,q.specularShadow);e.setParameter("fc_specular_view_color",
q.specularViewColor);e.setParameter4("fc_specular_view",q.specularViewBase,q.specularViewRate,q.specularViewAverage,q.specularViewShadow);e.setParameter("fc_reflect_color",q.reflectColor);e.setParameter4("fc_reflect",0,0,1-q.reflectMerge,q.reflectMerge);e.setParameter("fc_emissive_color",q.emissiveColor);this.bindAttributes(b);this.bindSamplers(b);d.drawTriangles(b.indexBuffer())};MO.FE3dControlPass=function(a){a=MO.Class.inherits(this,a,MO.FG3dTechniquePass);a._code="control";return a};
MO.FE3dControlTechnique=function(a){a=MO.Class.inherits(this,a,MO.FG3dTechnique);a._code="control";a._passControl=MO.Class.register(a,new MO.AGetter("_passControl"));a.setup=MO.FE3dControlTechnique_setup;a.drawRegion=MO.FE3dControlTechnique_drawRegion;return a};MO.FE3dControlTechnique_setup=function(){this.__base.FG3dTechnique.setup.call(this);this.registerMode(MO.EG3dTechniqueMode.Result);var a=this._passControl=MO.Class.create(MO.FE3dControlPass);a.linkGraphicContext(this);a.setup();this.pushPass(a)};
MO.FE3dControlTechnique_drawRegion=function(a){a.renderables().isEmpty()||(this._graphicContext.clearDepth(1),this.__base.FG3dTechnique.drawRegion.call(this,a))};MO.FE3dGeneralColorAutomaticEffect=function(a){a=MO.Class.inherits(this,a,MO.FE3dAutomaticEffect);a._code="general.color.automatic";a.buildMaterial=MO.FE3dGeneralColorAutomaticEffect_buildMaterial;a.drawRenderable=MO.FE3dGeneralColorAutomaticEffect_drawRenderable;return a};
MO.FE3dGeneralColorAutomaticEffect_buildMaterial=function(a,b){var d=b.material(),e=a.material;e||(e=a.material=MO.Class.create(MO.FFloatStream),e.setLength(40),d._dirty=!0);if(d._dirty){var f=d.info();e.reset();f.optionAlpha?e.writeFloat4(f.alphaBase,f.alphaRate,0,0):e.writeFloat4(f.alphaBase,1,0,0);e.writeFloat4(f.colorMin,f.colorMax,f.colorBalance,f.colorRate);e.writeColor4(f.vertexColor);e.writeColor4(f.ambientColor);e.writeColor4(f.diffuseColor);e.writeColor4(f.specularColor);e.writeFloat4(f.specularBase,
f.specularLevel,f.specularAverage,f.specularShadow);e.writeColor4(f.reflectColor);e.writeFloat4(0,0,1-f.reflectMerge,f.reflectMerge);e.writeColor4(f.emissiveColor);d._dirty=!1}};
MO.FE3dGeneralColorAutomaticEffect_drawRenderable=function(a,b){var d=this._program,e=a.calculate(MO.EG3dRegionParameter.CameraPosition),f=a.calculate(MO.EG3dRegionParameter.LightDirection),h=a.calculate(MO.EG3dRegionParameter.CameraViewProjectionMatrix),k=b.material();this.bindMaterial(k);if(b._optionMerge){for(var k=b.mergeRenderables(),q=k.count(),w=MO.Lang.TypeArray.findTemp(MO.EDataType.Float32,16*q),x=0;x<q;x++){var y=k.at(x).currentMatrix();y.writeData(w,16*x)}d.setParameter("vc_model_matrix",
w)}else y=b.currentMatrix(),d.setParameter("vc_model_matrix",y);d.setParameter("vc_vp_matrix",h);d.setParameter("vc_camera_position",e);d.setParameter("vc_light_direction",f);d.setParameter("fc_camera_position",e);d.setParameter("fc_light_direction",f);this._supportMaterialMap?d.setParameter4("fc_material",.03125,b._materialId/512,0,0):(e=b.activeInfo(),this.buildMaterial(e,b),d.setParameter("fc_materials",e.material.memory()));this.__base.FE3dAutomaticEffect.drawRenderable.call(this,a,b)};
MO.FE3dGeneralColorFillEffect=function(a){a=MO.Class.inherits(this,a,MO.FE3dAutomaticEffect);a._code="general.color.flat";a.drawRenderable=MO.FE3dGeneralColorFillEffect_drawRenderable;return a};MO.FE3dGeneralColorFillEffect_drawRenderable=function(a,b){this._graphicContext.size();var d=this._program,e=b.material();this.bindMaterial(e);d.setParameter4("vc_position",2,2,-1,1);this.__base.FE3dAutomaticEffect.drawRenderable.call(this,a,b)};
MO.FE3dGeneralColorFlatEffect=function(a){a=MO.Class.inherits(this,a,MO.FE3dAutomaticEffect);a._code="general.color.flat";a.drawRenderable=MO.FE3dGeneralColorFlatEffect_drawRenderable;return a};
MO.FE3dGeneralColorFlatEffect_drawRenderable=function(a,b){var d=this._graphicContext,e=d.size(),f=d.ratio(),d=d.sizeRatio(),h=e.width*f,k=e.height*f,f=e.width*d.width,q=e.height*d.height,e=this._program,d=b.material();this.bindMaterial(d);if(b._optionMerge){for(var f=b.mergeRenderables(),h=f.count(),k=MO.Lang.TypeArray.findTemp(MO.EDataType.Float32,4*h),w=q=0;w<h;w++){var x=f.at(w),d=x.matrix();k[q++]=d.sx/contextWidth*2;k[q++]=d.sy/contextHeight*2;k[q++]=d.tx/contextWidth*2-1;k[q++]=1-d.ty/contextHeight*
2;x.currentMatrix().writeData(k,4*w)}e.setParameter("vc_position",k)}else d=b.matrix(),b._optionFull?(h=d.sx/f*2,k=d.sy/q*2):(h=d.sx/h*2,k=d.sy/k*2),f=d.tx/f*2-1,d=1-d.ty/q*2,e.setParameter4("vc_position",h,k,f,d);this.__base.FE3dAutomaticEffect.drawRenderable.call(this,a,b)};MO.FE3dGeneralColorPass=function(a){a=MO.Class.inherits(this,a,MO.FG3dTechniquePass);a._code="color";return a};
MO.FE3dGeneralColorSkeletonEffect=function(a){a=MO.Class.inherits(this,a,MO.FE3dAutomaticEffect);a._code="general.color.skeleton";a._supportSkeleton=!0;a.drawRenderable=MO.FE3dGeneralColorSkeletonEffect_drawRenderable;return a};
MO.FE3dGeneralColorSkeletonEffect_drawRenderable=function(a,b){var d=this._program,e=a.calculate(MO.EG3dRegionParameter.CameraPosition),f=a.calculate(MO.EG3dRegionParameter.LightDirection),h=b.material(),k=h.info();this.bindMaterial(h);d.setParameter("vc_model_matrix",b.currentMatrix());d.setParameter("vc_vp_matrix",a.calculate(MO.EG3dRegionParameter.CameraViewProjectionMatrix));d.setParameter("vc_camera_position",e);d.setParameter("vc_light_direction",f);d.setParameter("fc_camera_position",e);d.setParameter("fc_light_direction",
f);d.setParameter("fc_color",k.ambientColor);d.setParameter4("fc_vertex_color",k.colorMin,k.colorMax,k.colorRate,k.colorMerge);d.setParameter4("fc_alpha",k.alphaBase,k.alphaRate,k.alphaLevel,k.alphaMerge);d.setParameter("fc_ambient_color",k.ambientColor);d.setParameter("fc_diffuse_color",k.diffuseColor);d.setParameter("fc_specular_color",k.specularColor);d.setParameter4("fc_specular",k.specularBase,k.specularLevel,k.specularAverage,k.specularShadow);d.setParameter("fc_specular_view_color",k.specularViewColor);
d.setParameter4("fc_specular_view",k.specularViewBase,k.specularViewRate,k.specularViewAverage,k.specularViewShadow);d.setParameter("fc_reflect_color",k.reflectColor);if(e=b.bones()){f=b._boneLimit;h=MO.Lang.TypeArray.findTemp(MO.EDataType.Float32,12*f);for(k=0;k<f;k++)e.at(k).matrix().writeData4x3(h,12*k);d.setParameter("vc_bone_matrix",h)}this.__base.FE3dAutomaticEffect.drawRenderable.call(this,a,b)};
MO.FE3dGeneralTechnique=function(a){a=MO.Class.inherits(this,a,MO.FE3dTechnique);a._code="general";a._passColor=MO.Class.register(a,new MO.AGetter("_passColor"));a.setup=MO.FE3dGeneralTechnique_setup;return a};
MO.FE3dGeneralTechnique_setup=function(){this.__base.FE3dTechnique.setup.call(this);this.registerMode(MO.EG3dTechniqueMode.Ambient);this.registerMode(MO.EG3dTechniqueMode.DiffuseLevel);this.registerMode(MO.EG3dTechniqueMode.DiffuseColor);this.registerMode(MO.EG3dTechniqueMode.SpecularLevel);this.registerMode(MO.EG3dTechniqueMode.SpecularColor);this.registerMode(MO.EG3dTechniqueMode.Result);var a=this._passColor=MO.Class.create(MO.FE3dGeneralColorPass);a.linkGraphicContext(this);a.setup();this.pushPass(a)};
MO.FE3dShadowColorAutomaticEffect=function(a){a=MO.Class.inherits(this,a,MO.FG3dAutomaticEffect);a._code="shadow.color.automatic";a.drawRenderable=MO.FE3dShadowColorAutomaticEffect_drawRenderable;return a};
MO.FE3dShadowColorAutomaticEffect_drawRenderable=function(a,b){var d=this._graphicContext,e=this._program,f=a.calculate(MO.EG3dRegionParameter.CameraPosition),h=a.calculate(MO.EG3dRegionParameter.CameraViewProjectionMatrix),k=a.calculate(MO.EG3dRegionParameter.LightDirection),q=a.calculate(MO.EG3dRegionParameter.LightViewMatrix),w=a.calculate(MO.EG3dRegionParameter.LightViewProjectionMatrix),x=a.calculate(MO.EG3dRegionParameter.LightInfo),y=a.techniquePass(),z=b.material();this.bindMaterial(z);e.setParameter("vc_light_depth",
x);e.setParameter("vc_model_matrix",b.currentMatrix());e.setParameter("vc_vp_matrix",h);e.setParameter("vc_camera_position",f);e.setParameter("vc_light_direction",k);e.setParameter("vc_light_view_matrix",q);e.setParameter("vc_light_vp_matrix",w);e.setParameter("fc_camera_position",f);e.setParameter("fc_light_direction",k);e.setParameter4("fc_light_depth",1/4096,0,-1/4096,x.w);f=z.info();e.setParameter("fc_color",f.ambientColor);e.setParameter4("fc_vertex_color",f.colorMin,f.colorMax,f.colorRate,f.colorMerge);
e.setParameter4("fc_alpha",f.alphaBase,f.alphaRate,f.alphaLevel,f.alphaMerge);e.setParameter("fc_ambient_color",f.ambientColor);e.setParameter("fc_diffuse_color",f.diffuseColor);e.setParameter("fc_specular_color",f.specularColor);e.setParameter4("fc_specular",f.specularBase,f.specularLevel,f.specularAverage,f.specularShadow);e.setParameter("fc_specular_view_color",f.specularViewColor);e.setParameter4("fc_specular_view",f.specularViewBase,f.specularViewRate,f.specularViewAverage,f.specularViewShadow);
e.setParameter("fc_reflect_color",f.reflectColor);this.bindAttributes(b);e.setSampler("fs_light_depth",y.textureDepth());this.bindSamplers(b);d.drawTriangles(b.indexBuffer())};MO.FE3dShadowColorPass=function(a){a=MO.Class.inherits(this,a,MO.FG3dTechniquePass);a._code="color";a._textureDepth=MO.Class.register(a,new MO.AGetSet("_textureDepth"));a.drawRegion=MO.FE3dShadowColorPass_drawRegion;return a};
MO.FE3dShadowColorPass_drawRegion=function(a){var b=this._graphicContext;b.setRenderTarget(null);var d=a._backgroundColor;b.clear(d.red,d.green,d.blue,d.alpha,1);this.__base.FG3dTechniquePass.drawRegion.call(this,a)};MO.FE3dShadowColorSkeletonEffect=function(a){a=MO.Class.inherits(this,a,MO.FG3dAutomaticEffect);a._code="shadow.color.skeleton";a._supportSkeleton=!0;a.drawRenderable=MO.FE3dShadowColorSkeletonEffect_drawRenderable;return a};
MO.FE3dShadowColorSkeletonEffect_drawRenderable=function(a,b){var d=this._graphicContext,e=this._program,f=a.matrixViewProjection(),h=a.cameraPosition(),k=a.lightDirection();if(e.hasAttribute())for(var q=e.attributes(),w=q.count(),x=0;x<w;x++){var y=q.value(x);if(y._statusUsed){var z=b.findVertexBuffer(y._linker);if(null==z)throw new MO.TError("Can't find renderable vertex buffer. (linker={1})",y._linker);e.setAttribute(y._name,z,z._formatCd)}}if(e.hasSampler())for(q=e.samplers(),w=q.count(),x=0;x<
w;x++)if(y=q.value(x),y._statusUsed){var z=y.linker(),A=b.findTexture(z);if(null!=A)e.setSampler(y.name(),A.texture());else throw new MO.TError("Can't find sampler. (linker={1})",z);}e.setParameter("vc_model_matrix",b.currentMatrix());e.setParameter("vc_vp_matrix",f);e.setParameter("vc_camera_position",h);e.setParameter("vc_light_direction",k);e.setParameter("fc_camera_position",h);e.setParameter("fc_light_direction",k);f=b.material();f=f.info();e.setParameter("fc_color",f.ambientColor);e.setParameter4("fc_vertex_color",
f.colorMin,f.colorMax,f.colorRate,f.colorMerge);e.setParameter4("fc_alpha",f.alphaBase,f.alphaRate,f.alphaLevel,f.alphaMerge);e.setParameter("fc_ambient_color",f.ambientColor);e.setParameter("fc_diffuse_color",f.diffuseColor);e.setParameter("fc_specular_color",f.specularColor);e.setParameter4("fc_specular",f.specularBase,f.specularLevel,f.specularAverage,f.specularShadow);e.setParameter("fc_specular_view_color",f.specularViewColor);e.setParameter4("fc_specular_view",f.specularViewBase,f.specularViewRate,
f.specularViewAverage,f.specularViewShadow);e.setParameter("fc_reflect_color",f.reflectColor);if(h=b.bones()){k=h.count();32<k&&(k=32);x=MO.Lang.TypeArray.findTemp(MO.EDataType.Float32,16*k);for(q=0;q<k;q++)f=h.get(q).matrix(),f.writeData(x,16*q);e.setParameter("vc_bone_matrix",x)}e=b.indexBuffer();d.drawTriangles(e,0,e._count)};
MO.FE3dShadowDepthAutomaticEffect=function(a){a=MO.Class.inherits(this,a,MO.FG3dAutomaticEffect);a._code="shadow.depth.automatic";a.drawRenderable=MO.FE3dShadowDepthAutomaticEffect_drawRenderable;return a};
MO.FE3dShadowDepthAutomaticEffect_drawRenderable=function(a,b){var d=this._graphicContext,e=this._program,f=a.calculate(MO.EG3dRegionParameter.LightViewMatrix),h=a.calculate(MO.EG3dRegionParameter.LightViewProjectionMatrix),k=a.calculate(MO.EG3dRegionParameter.LightInfo);d.setBlendFactors(!1);e.setParameter("vc_camera",k);e.setParameter("vc_model_matrix",b.currentMatrix());e.setParameter("vc_view_matrix",f);e.setParameter("vc_vp_matrix",h);e.setParameter("fc_camera",k);e.setParameter4("fc_alpha",
0,0,0,.1);this.bindAttributes(b);this.bindSamplers(b);d.drawTriangles(b.indexBuffer())};MO.FE3dShadowDepthPass=function(a){a=MO.Class.inherits(this,a,MO.FG3dTechniquePass);a._code="depth";a._renderTarget=null;a._textureDepth=MO.Class.register(a,new MO.AGetter("_textureDepth"));a._renderTarget=null;a.setup=MO.FE3dShadowDepthPass_setup;a.drawRegion=MO.FE3dShadowDepthPass_drawRegion;return a};
MO.FE3dShadowDepthPass_setup=function(){this.__base.FG3dTechniquePass.setup.call(this);var a=this._graphicContext,b=this._textureDepth=a.createFlatTexture();b.setFilter(EG3dSamplerFilter.Linear,EG3dSamplerFilter.Linear);b.setWrap(EG3dSamplerFilter.ClampToEdge,EG3dSamplerFilter.ClampToEdge);a=this._renderTarget=a.createRenderTarget();a.size().set(2048,2048);a.textures().push(b);a.build()};
MO.FE3dShadowDepthPass_drawRegion=function(a){var b=this._graphicContext;this._finish?(b.setRenderTarget(null),b=a._backgroundColor,this._context.clear(b.red,b.green,b.blue,b.alpha,1)):(b.setRenderTarget(this._renderTarget),b.clear(0,0,0,1,1,1));a._textureDepth=this._textureDepth;this.__base.FG3dTechniquePass.drawRegion.call(this,a)};
MO.FE3dShadowDepthSkeletonEffect=function(a){a=MO.Class.inherits(this,a,MO.FG3dAutomaticEffect);a._code="shadow.depth.skeleton";a._supportSkeleton=!0;a.drawRenderable=MO.FE3dShadowDepthSkeletonEffect_drawRenderable;return a};
MO.FE3dShadowDepthSkeletonEffect_drawRenderable=function(a,b){var d=this._graphicContext,e=this._program;e.setParameter("vc_model_matrix",r.currentMatrix());e.setParameter("vc_vp_matrix",prvp);e.setParameter("vc_camera_position",prcp);e.setParameter("vc_light_direction",prld);e.setParameter("fc_camera_position",prcp);e.setParameter("fc_light_direction",prld);var f=r.material(),f=f.info();e.setParameter("fc_color",f.ambientColor);e.setParameter4("fc_vertex_color",f.colorMin,f.colorMax,f.colorRate,
f.colorMerge);e.setParameter4("fc_alpha",f.alphaBase,f.alphaRate,f.alphaLevel,f.alphaMerge);e.setParameter("fc_ambient_color",f.ambientColor);e.setParameter("fc_diffuse_color",f.diffuseColor);e.setParameter("fc_specular_color",f.specularColor);e.setParameter4("fc_specular",f.specularBase,f.specularRate,f.specularAverage,f.specularShadow);e.setParameter("fc_specular_view_color",f.specularViewColor);e.setParameter4("fc_specular_view",f.specularViewBase,f.specularViewRate,f.specularViewAverage,f.specularViewShadow);
e.setParameter("fc_reflect_color",f.reflectColor);var h=b.bones();if(h){var k=h.count();32<k&&(k=32);for(var q=MO.Lang.TypeArray.findTemp(MO.EDataType.Float32,16*k),w=0;w<k;w++)f=h.get(w).matrix(),f.writeData(q,16*w);e.setParameter("vc_bone_matrix",q)}this.bindAttributes(b);this.bindSamplers(b);d.drawTriangles(b.indexBuffer())};
MO.FE3dShadowTechnique=function(a){a=MO.Class.inherits(this,a,MO.FE3dTechnique);a._code="shadow";a._passDepth=MO.Class.register(a,new MO.AGetter("_passDepth"));a._passColor=MO.Class.register(a,new MO.AGetter("_passColor"));a.setup=MO.FE3dShadowTechnique_setup;a.updateRegion=MO.FE3dShadowTechnique_updateRegion;return a};
MO.FE3dShadowTechnique_setup=function(){this.__base.FE3dTechnique.setup.call(this);this.registerMode(MO.EG3dTechniqueMode.Ambient);this.registerMode(MO.EG3dTechniqueMode.DiffuseLevel);this.registerMode(MO.EG3dTechniqueMode.DiffuseColor);this.registerMode(MO.EG3dTechniqueMode.SpecularLevel);this.registerMode(MO.EG3dTechniqueMode.SpecularColor);this.registerMode(MO.EG3dTechniqueMode.Result);var a=this._passDepth=MO.Class.create(MO.FE3dShadowDepthPass);a.linkGraphicContext(this);a.setup();this.pushPass(a);
var b=this._passColor=MO.Class.create(MO.FE3dShadowColorPass);b.linkGraphicContext(this);b.setup();this.pushPass(b);b.setTextureDepth(a.textureDepth())};MO.FE3dShadowTechnique_updateRegion=function(a){this.__base.FE3dTechnique.updateRegion.call(this,a);this._graphicContext.size();a.camera();a.directionalLight().camera()};
MO.FE3dSphereColorPass=function(a){a=MO.Class.inherits(this,a,MO.FG3dTechniquePass);a._code="color";a._textureColor=MO.Class.register(a,new MO.AGetter("_textureColor"));a.setup=MO.FE3dSphereColorPass_setup;a.drawBegin=MO.FE3dSphereColorPass_drawBegin;return a};
MO.FE3dSphereColorPass_setup=function(){this.__base.FG3dTechniquePass.setup.call(this);var a=this._graphicContext,b=this._textureColor=a.createFlatTexture();b.setFilterCd(MO.EG3dSamplerFilter.Linear,MO.EG3dSamplerFilter.Linear);b.setWrapCd(MO.EG3dSamplerFilter.ClampToEdge,MO.EG3dSamplerFilter.ClampToEdge);a=this._renderTarget=a.createRenderTarget();a.size().set(2048,1024);a.textures().push(b);a.build()};
MO.FE3dSphereColorPass_drawBegin=function(a){var b=this._graphicContext;a=a.backgroundColor();b.setRenderTarget(this._renderTarget);b.clear(a.red,a.green,a.blue,a.alpha,1)};MO.FE3dSphereTechnique=function(a){a=MO.Class.inherits(this,a,MO.FE3dTechnique);a._code="general";a._passColor=MO.Class.register(a,new MO.AGetter("_passColor"));a._passView=MO.Class.register(a,new MO.AGetter("_passView"));a.setup=MO.FE3dSphereTechnique_setup;return a};
MO.FE3dSphereTechnique_setup=function(){this.__base.FE3dTechnique.setup.call(this);this.registerMode(MO.EG3dTechniqueMode.Ambient);this.registerMode(MO.EG3dTechniqueMode.DiffuseLevel);this.registerMode(MO.EG3dTechniqueMode.DiffuseColor);this.registerMode(MO.EG3dTechniqueMode.SpecularLevel);this.registerMode(MO.EG3dTechniqueMode.SpecularColor);this.registerMode(MO.EG3dTechniqueMode.Result);var a=this._passColor=MO.Class.create(MO.FE3dSphereColorPass);a.linkGraphicContext(this);a.setup();this.pushPass(a);
var b=this._passView=MO.Class.create(MO.FE3dSphereViewPass);b.linkGraphicContext(this);b.setup();this.pushPass(b);b.setTextureColor(a.textureColor())};MO.FE3dSphereViewAutomaticEffect=function(a){a=MO.Class.inherits(this,a,MO.FG3dAutomaticEffect);a._code="sphere.view.automatic";a._rotation=0;a.drawRenderable=MO.FE3dSphereViewAutomaticEffect_drawRenderable;return a};
MO.FE3dSphereViewAutomaticEffect_drawRenderable=function(a,b){var d=this._graphicContext,e=this._program,f=d.size(),h=1,k=1;f.width>f.height?h=f.width/f.height:f.width<f.height&&(k=f.height/f.width);f=this._rotation+1E-4;e.setParameter4("vc_const",h,k,1,f);e.setParameter4("fc_const",h,k,1,f);this._rotation=f;e=b.material();this.bindMaterial(e);this.bindAttributes(b);this.bindSamplers(b);d.drawTriangles(b.indexBuffer())};
MO.FE3dSphereViewPass=function(a){a=MO.Class.inherits(this,a,MO.FG3dTechniquePass);a._code="view";a._radianSize=null;a._textureColor=MO.Class.register(a,new MO.AGetSet("_textureColor"));a._effect=null;a._textureRadian=null;a._rectangle=null;a.construct=MO.FE3dSphereViewPass_construct;a.setup=MO.FE3dSphereViewPass_setup;a.drawBegin=MO.FE3dSphereViewPass_drawBegin;a.drawRegion=MO.FE3dSphereViewPass_drawRegion;return a};
MO.FE3dSphereViewPass_construct=function(){this.__base.FG3dTechniquePass.construct.call(this);this._radianSize=new MO.SSize2(1024,1024)};
MO.FE3dSphereViewPass_setup=function(){this.__base.FG3dTechniquePass.setup.call(this);for(var a=this._graphicContext,b=.5/Math.PI,d=this._radianSize.width,e=this._radianSize.height,f=d/2,h=e/2,k=new Float32Array(d*e),q=0,w=new MO.SVector2,x=0;x<e;x++)for(var y=(x-h)/(e/2),z=0;z<d;z++){var A=(z-f)/(d/2),B=Math.sqrt(A*A+y*y),D=.5;0!=B&&(B=A/B,w.x=A,w.y=y,w.normalize(),Math.acos(w.x),Math.asin(w.y),x>h?D=.5-Math.acos(B)*b:x<h&&(D=.5+Math.acos(B)*b));k[q++]=D}a=this._textureRadian=a.createFlatTexture();
a.setWrapCd(MO.EG3dSamplerFilter.ClampToBorder,MO.EG3dSamplerFilter.ClampToBorder);a.uploadData(k,d,e);d=this._rectangle=MO.Class.create(MO.FE3dRectangleArea);d.linkGraphicContext(this);d.setup()};MO.FE3dSphereViewPass_drawBegin=function(a){var b=this._graphicContext,d=this._rectangle;a.backgroundColor();b.setRenderTarget(null);b.clear(0,0,0,0,1);a=d.textures();a.isEmpty()&&(a.set("diffuse",this._textureColor),a.set("radian",this._textureRadian))};
MO.FE3dSphereViewPass_drawRegion=function(a){var b=this._graphicContext,d=this._rectangle,e=this._effect;e||(e=this._effect=MO.Console.find(MO.FG3dEffectConsole).find(this,a,d));b.setProgram(e.program());e.drawRenderable(a,this._rectangle)};
MO.EE3dInstance=new function(){this.ModelRenderable="model.renderable";this.TemplateRenderable="template.renderable";this.Scene="scene";this.SceneLayer="scene.layer";this.SceneDisplay="scene.display";this.SceneMaterial="scene.material";this.SceneMovie="scene.movie";this.SceneRenderable="scene.renderable";return this};MO.FE3dAnimation=function(a){return a=MO.Class.inherits(this,a,MO.FObject,MO.ME3dObject,MO.MLinkerResource)};
MO.FE3dCamera=function(a){a=MO.Class.inherits(this,a,MO.FG3dCamera,MO.MLinkerResource);a._projection=MO.Class.register(a,new MO.AGetter("_projection"));a._rotation=MO.Class.register(a,new MO.AGetter("_rotation"));a._rotationMatrix=null;a._quaternion=null;a._quaternionX=null;a._quaternionY=null;a._quaternionZ=null;a.construct=MO.FE3dCamera_construct;a.doMoveX=MO.FE3dCamera_doMoveX;a.doMoveY=MO.FE3dCamera_doMoveY;a.doMoveZ=MO.FE3dCamera_doMoveZ;a.doForward=MO.FE3dCamera_doForward;a.doPitch=MO.FE3dCamera_doPitch;
a.doYaw=MO.FE3dCamera_doYaw;a.doRoll=MO.FE3dCamera_doRoll;a.loadResource=MO.FE3dCamera_loadResource;a.commitResource=MO.FE3dCamera_commitResource;a.update=MO.FE3dCamera_update;return a};MO.FE3dCamera_construct=function(){this.__base.FG3dCamera.construct.call(this);this._rotation=new MO.SVector3;this._rotationMatrix=new MO.SMatrix3x3;this._quaternion=new MO.SQuaternion;this._quaternionX=new MO.SQuaternion;this._quaternionY=new MO.SQuaternion;this._quaternionZ=new MO.SQuaternion};
MO.FE3dCamera_doMoveX=function(a){this._position.x+=a};MO.FE3dCamera_doMoveY=function(a){this._position.y+=a};MO.FE3dCamera_doMoveZ=function(a){this._position.z+=a};MO.FE3dCamera_doForward=function(a){this._position.x+=this._direction.x*a;this._position.y+=this._direction.y*a;this._position.z+=this._direction.z*a};MO.FE3dCamera_doPitch=function(a){this._rotation.x+=a};MO.FE3dCamera_doYaw=function(a){this._rotation.y+=a};MO.FE3dCamera_doRoll=function(a){this._rotation.z+=a};
MO.FE3dCamera_loadResource=function(a){var b=a.projection();this._resource=a;this.position().assign(a.position());this.setDirection(a.direction().x,a.direction().y,a.direction().z);this.update();a=this.projection();a._angle=b.angle();a._znear=b.znear();a._zfar=b.zfar();a.update()};MO.FE3dCamera_commitResource=function(){var a=this._resource;a._position.assign(this._position);a._direction.assign(this._direction)};
MO.FE3dCamera_update=function(){var a=this._rotation;this._quaternionX.fromAxisAngle(MO.Lang.Math.vectorAxisX,a.x);this._quaternionY.fromAxisAngle(MO.Lang.Math.vectorAxisY,a.y);this._quaternionZ.fromAxisAngle(MO.Lang.Math.vectorAxisZ,a.z);var b=this._quaternion.identity();b.mul(this._quaternionX);b.mul(this._quaternionY);b.mul(this._quaternionZ);a=this._rotationMatrix;a.build(b);b=this._direction;a.transformPoint3(this._directionTarget,b);b.normalize();this.__base.FG3dCamera.update.call(this)};
MO.FG3dCamera_dispose=function(){this._projection=MO.Lang.Obejct.dispose(this._projection);this.__base.FObject.dispose.call(this)};MO.FE3dDirectionalLight=function(a){a=MO.Class.inherits(this,a,MO.FG3dDirectionalLight,MO.MLinkerResource);a._material=MO.Class.register(a,new MO.AGetter("_material"));a.construct=MO.FE3dDirectionalLight_construct;a.loadResource=MO.FE3dDirectionalLight_loadResource;a.dispose=MO.FE3dDirectionalLight_dispose;return a};
MO.FE3dDirectionalLight_construct=function(){this.__base.FG3dDirectionalLight.construct.call(this);this._material=MO.Class.create(MO.FE3dMaterial)};MO.FE3dDirectionalLight_loadResource=function(a){this.__base.MLinkerResource.loadResource.call(this,a);this._material.loadResource(a.material())};MO.FE3dDirectionalLight_dispose=function(){this._material=MO.Lang.Object.dispose(this._material);this.__base.FG3dDirectionalLight.dispose.call(this)};
MO.FE3dFlatStage=function(a){a=MO.Class.inherits(this,a,MO.FE3dStage);a._layer=MO.Class.register(a,new MO.AGetter("_layer"));a.construct=MO.FE3dFlatStage_construct;return a};MO.FE3dFlatStage_construct=function(){this.__base.FE3dStage.construct.call(this);var a=this._layer=MO.Class.create(MO.FDisplayLayer);this.registerLayer("Layer",a)};
MO.FE3dInstanceConsole=function(a){a=MO.Class.inherits(this,a,MO.FConsole);a._scopeCd=MO.EScope.Local;a._factory=MO.Class.register(a,new MO.AGetter("_factory"));a.construct=MO.FE3dInstanceConsole_construct;a.register=MO.FE3dInstanceConsole_register;a.unregister=MO.FE3dInstanceConsole_unregister;a.create=MO.FE3dInstanceConsole_create;return a};
MO.FE3dInstanceConsole_construct=function(){var a=this._factory=MO.Class.create(MO.FClassFactory);a.register(MO.EE3dInstance.ModelRenderable,MO.FE3dModelRenderable);a.register(MO.EE3dInstance.TemplateRenderable,MO.FE3dTemplateRenderable);a.register(MO.EE3dInstance.Scene,MO.FE3dScene);a.register(MO.EE3dInstance.SceneLayer,MO.FE3dSceneLayer);a.register(MO.EE3dInstance.SceneDisplay,MO.FE3dSceneDisplay);a.register(MO.EE3dInstance.SceneMaterial,MO.FE3dSceneMaterial);a.register(MO.EE3dInstance.SceneMovie,
MO.FE3dMovie);a.register(MO.EE3dInstance.SceneRenderable,MO.FE3dSceneDisplayRenderable)};MO.FE3dInstanceConsole_register=function(a,b){this._factory.register(a,b)};MO.FE3dInstanceConsole_unregister=function(a){this._factory.unregister(a,clazz)};MO.FE3dInstanceConsole_create=function(a){return this._factory.create(a)};MO.FE3dMaterial=function(a){a=MO.Class.inherits(this,a,MO.FE3rMaterial);a._parent=null;a.loadParent=MO.FE3dRenderable_loadParent;return a};
MO.FE3dRenderable_loadParent=function(a){this._parent=a};MO.FE3dMesh=function(a){a=MO.Class.inherits(this,a,MO.FE3dSpace,MO.MLinkerResource,MO.MListenerLoad);a._ready=!1;a._display=null;a._renderable=null;a._layer=null;a.construct=MO.FE3dMesh_construct;a.testReady=MO.FE3dMesh_testReady;a.loadRenderable=MO.FE3dMesh_loadRenderable;a.processLoad=MO.FE3dMesh_processLoad;a.process=MO.FE3dMesh_process;return a};
MO.FE3dMesh_construct=function(){this.__base.FE3dSpace.construct.call(this);var a=this._layer=MO.Class.create(MO.FDisplayLayer);this.registerLayer("Layer",a)};MO.FE3dMesh_testReady=function(){return this._ready};
MO.FE3dMesh_loadRenderable=function(a){var b=a.resource();this.selectTechnique(this,FE3dGeneralTechnique).setResource(b.technique());this.loadResource(b);var d=MO.Class.create(MO.FE3dMeshRenderable);d.setResource(b._renderable);d._material.loadResource(b._display._material);d._renderable=a;for(var e=a._vertexBuffers,f=e.count(),h=0;h<f;h++){var k=e.getAt(h);d._vertexBuffers.set(k._name,k)}d._indexBuffer=a._indexBuffer;d.matrix().assign(d.resource().matrix());a=this._display=MO.Class.create(MO.FE3dMeshDisplay);
a._renderable=d;a.load(b._display);a.pushRenderable(d);this._layer.pushDisplay(a);this._ready=!0;this.processLoadListener(this)};MO.FE3dMesh_processLoad=function(){if(!this._renderable.testReady())return!1;this.loadRenderable(this._renderable);return!0};MO.FE3dMesh_process=function(){this.__base.FE3dSpace.process.call(this)};
MO.FE3dMeshConsole=function(a){a=MO.Class.inherits(this,a,MO.FConsole);a._scopeCd=MO.EScope.Local;a._loadMeshs=null;a._meshs=MO.Class.register(a,new MO.AGetter("_meshs"));a._thread=null;a._interval=100;a.onProcess=MO.FE3dMeshConsole_onProcess;a.construct=MO.FE3dMeshConsole_construct;a.meshs=MO.FE3dMeshConsole_meshs;a.allocByGuid=MO.FE3dMeshConsole_allocByGuid;a.allocByCode=MO.FE3dMeshConsole_allocByCode;a.free=MO.FE3dMeshConsole_free;return a};
MO.FE3dMeshConsole_onProcess=function(){var a=this._loadMeshs;for(a.record();a.next();)a.current().processLoad()&&a.removeCurrent()};MO.FE3dMeshConsole_construct=function(){this._loadMeshs=new MO.TLooper;this._meshs=new MO.TDictionary;var a=this._thread=MO.Class.create(MO.FThread);a.setInterval(this._interval);a.addProcessListener(this,this.onProcess);MO.Console.find(MO.FThreadConsole).start(a)};MO.FE3dMeshConsole_meshs=function(){return this._meshs};
MO.FE3dMeshConsole_allocByGuid=function(a,b){var d=this._meshs.get(b);if(d&&!d.isEmpty())return d.pop();var d=MO.Console.find(MO.FE3rMeshConsole).loadByGuid(a,b),e=MO.Class.create(MO.FE3dMesh);e.linkGraphicContext(a);e._name=b;e._renderable=d;this._loadMeshs.push(e);return e};
MO.FE3dMeshConsole_allocByCode=function(a,b){var d=this._meshs.get(b);if(d&&!d.isEmpty())return d.pop();var d=MO.Console.find(MO.FE3rMeshConsole).loadByCode(a,b),e=MO.Class.create(MO.FE3dMesh);e.linkGraphicContext(a);e._name=b;e._renderable=d;this._loadMeshs.push(e);return e};MO.FE3dMeshConsole_free=function(a){a._display.remove()};
MO.FE3dMeshDisplay=function(a){a=MO.Class.inherits(this,a,MO.FE3dDisplay,MO.MLinkerResource);a._material=MO.Class.register(a,new MO.AGetter("_material"));a._renderable=MO.Class.register(a,new MO.AGetter("_renderable"));a.load=MO.FE3dMeshDisplay_load;a.reloadResource=MO.FE3dMeshDisplay_reloadResource;return a};MO.FE3dMeshDisplay_load=function(a){this._resource=a;this._matrix.assign(a.matrix())};MO.FE3dMeshDisplay_reloadResource=function(){this._matrix.assign(this._resource.matrix())};
MO.FE3dMeshRenderable=function(a){a=MO.Class.inherits(this,a,MO.FE3dRenderable);a._renderable=MO.Class.register(a,MO.AGetSet("_renderable"));a._activeTrack=null;a.vertexCount=MO.FE3dMeshRenderable_vertexCount;a.findVertexBuffer=MO.FE3dMeshRenderable_findVertexBuffer;a.vertexBuffers=MO.FE3dMeshRenderable_vertexBuffers;a.indexBuffers=MO.FE3dMeshRenderable_indexBuffers;a.findTexture=MO.FE3dMeshRenderable_findTexture;a.textures=MO.FE3dMeshRenderable_textures;a.reloadResource=MO.FE3dMeshRenderable_reloadResource;
a.process=MO.FE3dMeshRenderable_process;a.processDelay=MO.FE3dMeshRenderable_processDelay;a.update=MO.FE3dMeshRenderable_update;a.dispose=MO.FE3dMeshRenderable_dispose;return a};MO.FE3dMeshRenderable_vertexCount=function(){return this._renderable.vertexCount()};MO.FE3dMeshRenderable_findVertexBuffer=function(a){var b=this._vertexBuffers.get(a);return b?b:this._renderable.findVertexBuffer(a)};MO.FE3dMeshRenderable_vertexBuffers=function(){return this._renderable.vertexBuffers()};
MO.FE3dMeshRenderable_indexBuffers=function(){return this._renderable.indexBuffers()};MO.FE3dMeshRenderable_findTexture=function(a){return(a=this._textures.get(a))?a:this._renderable.findTexture(p)};MO.FE3dMeshRenderable_textures=function(){var a=this._textures;return a?a:this._renderable.textures()};MO.FE3dMeshRenderable_reloadResource=function(){this._matrix.assign(this._resource.matrix())};
MO.FE3dMeshRenderable_process=function(a){this.__base.FE3dRenderable.process.call(this,a);if((a=this._activeTrack)&&this._display._optionPlay){var b=a._animation;b&&b.process(a)}};MO.FE3dMeshRenderable_processDelay=function(a){this.__base.FE3dRenderable.processDelay.call(this,a)};
MO.FE3dMeshRenderable_update=function(a){var b=this._display,d=this._matrix,e=this._activeTrack,f=this._calculateMatrix;e?(f.assign(e.matrix()),f.append(d)):f.assign(d);b&&(b=this._display.currentMatrix(),f.append(b));this._currentMatrix.attachData(f.data())&&a.change()};MO.FE3dMeshRenderable_dispose=function(){this._modelMatrix=MO.Lang.Object.dispose(this._modelMatrix);this._vertexBuffers=MO.Lang.Object.dispose(this._vertexBuffers);this.__base.FE3dRenderable.dispose.call(this)};
MO.FE3dModel=function(a){a=MO.Class.inherits(this,a,MO.FE3dSpace,MO.MPoolAble,MO.MLinkerResource,MO.MListenerLoad);a._dataReady=!1;a._display=MO.Class.register(a,new MO.AGetter("_display"));a._renderable=MO.Class.register(a,new MO.AGetSet("_renderable"));a.construct=MO.FE3dModel_construct;a.testReady=MO.FE3dModel_testReady;a.loadRenderable=MO.FE3dModel_loadRenderable;a.processLoad=MO.FE3dModel_processLoad;return a};
MO.FE3dModel_construct=function(){this.__base.FE3dSpace.construct.call(this);var a=this._layer=MO.Class.create(MO.FDisplayLayer);this.registerLayer("sprite",a);var b=this._display=MO.Class.create(MO.FE3dModelDisplay);a.pushDisplay(b)};MO.FE3dModel_testReady=function(){return this._dataReady};MO.FE3dModel_loadRenderable=function(a){this._renderable=a;var b=a.resource();this.selectTechnique(this,FE3dGeneralTechnique);this.loadResource(b);this._display.load(a);this._dataReady=!0};
MO.FE3dModel_processLoad=function(){if(this._dataReady)return!0;var a=this._renderable;if(!a.testReady())return!1;this.loadRenderable(a);this.processLoadListener(this);return!0};
MO.FE3dModelConsole=function(a){a=MO.Class.inherits(this,a,MO.FConsole);a._scopeCd=MO.EScope.Local;a._looper=null;a._pools=MO.Class.register(a,new MO.AGetter("_pools"));a._thread=null;a._interval=100;a.onProcess=MO.FE3dModelConsole_onProcess;a.construct=MO.FE3dModelConsole_construct;a.pools=MO.FE3dModelConsole_pools;a.allocByGuid=MO.FE3dModelConsole_allocByGuid;a.allocByCode=MO.FE3dModelConsole_allocByCode;a.free=MO.FE3dModelConsole_free;return a};
MO.FE3dModelConsole_onProcess=function(){var a=this._looper;for(a.record();a.next();)a.current().processLoad()&&a.removeCurrent()};MO.FE3dModelConsole_construct=function(){this._looper=new MO.TLooper;this._pools=MO.Class.create(MO.FObjectPools);var a=this._thread=MO.Class.create(MO.FThread);a.setInterval(this._interval);a.addProcessListener(this,this.onProcess);MO.Console.find(MO.FThreadConsole).start(a)};
MO.FE3dModelConsole_allocByGuid=function(a,b){var d=this._pools.alloc(b);if(d)return d;var e=MO.Console.find(MO.FE3rModelConsole).load(a,b),d=MO.Class.create(MO.FE3dModel);d.linkGraphicContext(a);d.setPoolCode(b);d.setRenderable(e);this._looper.push(d);return d};MO.FE3dModelConsole_allocByCode=function(a,b){return this._pools.alloc(b)};MO.FE3dModelConsole_free=function(a){var b=a.poolCode();this._pools.free(b,a)};
MO.FE3dModelDisplay=function(a){a=MO.Class.inherits(this,a,MO.FE3dDisplay,MO.MLinkerResource);a._material=MO.Class.register(a,new MO.AGetter("_material"));a._shapes=MO.Class.register(a,new MO.AGetter("_shapes"));a.construct=MO.FE3dModelDisplay_construct;a.load=MO.FE3dModelDisplay_load;a.reloadResource=MO.FE3dModelDisplay_reloadResource;a.dispose=MO.FE3dModelDisplay_dispose;return a};MO.FE3dModelDisplay_construct=function(){this.__base.FE3dDisplay.construct.call(this);this._material=MO.Class.create(FE3dMaterial)};
MO.FE3dModelDisplay_load=function(a){var b=this._material,d=RConsole.find(FE3dInstanceConsole),e=this._resource=a.resource().display();this._matrix.assign(e.matrix());b.loadResource(e.material());if(a=a.geometrys())for(var e=a.count(),f=this._shapes=new MO.TObjects,h=0;h<e;h++){var k=a.get(h),q=d.create(MO.EE3dInstance.ModelRenderable);q.setDisplay(this);q.setMaterial(b);q.load(k);f.push(q);this.pushRenderable(q)}};
MO.FE3dModelDisplay_reloadResource=function(){var a=this._resource;this._matrix.assign(a.matrix());this._material.loadResource(a.material())};MO.FE3dModelDisplay_dispose=function(){this._material=MO.Lang.Object.dispose(this._material);this.__base.FE3dDisplay.dispose.call(this)};MO.FE3dModelRenderable=function(a){a=MO.Class.inherits(this,a,MO.FE3dMeshRenderable);a._ready=!1;a._materialResource=null;a.testVisible=MO.FE3dModelRenderable_testVisible;a.load=MO.FE3dModelRenderable_load;return a};
MO.FE3dModelRenderable_testVisible=function(a){!this._ready&&(a=this._renderable)&&(this._ready=a.testReady());return this._ready};MO.FE3dModelRenderable_load=function(a){var b=this._material,d=this._materialResource=a.material();d&&b.assignInfo(d.info());this._effectCode=b.info().effectCode;this._renderable=a};
MO.FE3dMovie=function(a){a=MO.Class.inherits(this,a,MO.FObject,MO.MLinkerResource);a._interval=null;a._firstTick=0;a._lastTick=0;a._matrix=null;a.construct=MO.FE3dMovie_construct;a.loadResource=MO.FE3dMovie_loadResource;a.reloadResource=MO.FE3dMovie_reloadResource;a.process=MO.FE3dMovie_process;return a};MO.FE3dMovie_construct=function(){this.__base.FObject.construct.call(this);this._matrix=new MO.SMatrix3d};
MO.FE3dMovie_loadResource=function(a){this._resource=a;this._interval=a._interval;this._matrix.setRotation(a._rotation.x,a._rotation.y*Math.PI/180,a._rotation.z);this._matrix.update()};MO.FE3dMovie_reloadResource=function(){this.loadResource(this._resource)};
MO.FE3dMovie_process=function(a){0==this._firstTick&&(this._firstTick=MO.Timer.current());0==this._lastTick&&(this._lastTick=MO.Timer.current());var b=RTimer.current(),d=b-this._lastTick;if(d>this._interval){var e=this._resource,d=d/1E3;"rotation"==this._resource.code()&&(a.ry+=e._rotation.y*d,a.updateForce());this._lastTick=b}};
MO.FE3dOrthoCamera=function(a){a=MO.Class.inherits(this,a,MO.FE3dCamera);a.construct=MO.FE3dOrthoCamera_construct;a.updateFrustum=MO.FE3dOrthoCamera_updateFrustum;a.updateFromCamera=MO.FE3dOrthoCamera_updateFromCamera;a.updateFlatCamera=MO.FE3dOrthoCamera_updateFlatCamera;return a};MO.FE3dOrthoCamera_construct=function(){this.__base.FE3dCamera.construct.call(this);this._projection=MO.Class.create(MO.FG3dOrthoProjection)};
MO.FE3dOrthoCamera_updateFrustum=function(){this.__base.FE3dCamera.updateFrustum.call(this);var a=this._projection,b=a._size,d=this._frustum;d.update(a._angle,b.width,b.height,a._znear,a._zfar,this._centerFront,this._centerBack,this._matrix);return d};
MO.FE3dOrthoCamera_updateFromCamera=function(a){a=a.updateFrustum();var b=this._direction;b.normalize();this._position.set(a.center.x-b.x*a.radius,a.center.y-b.y*a.radius,a.center.z-b.z*a.radius);this.lookAt(a.center.x,a.center.y,a.center.z);this.update();b=this._frustum;this._matrix.transform(b.coners,a.coners,8);b.updateCenter();this._projection.updateFrustum(b)};
MO.FE3dOrthoCamera_updateFlatCamera=function(a){var b=a.updateFlatFrustum(),d=MO.RConst.DEGREE_RATE*this._projection.angle(),d=b.radius/Math.sin(.5*d),d=Math.max(d,a._projection._zfar);a=this._direction;a.normalize();this._position.set(b.center.x-a.x*d,b.center.y-a.y*d,b.center.z-a.z*d);this.lookAt(b.center.x,b.center.y,b.center.z);this.update();this._projection._znear=.3;this._projection._zfar=1.5*d;this._projection.update()};
MO.FE3dPerspectiveCamera=function(a){a=MO.Class.inherits(this,a,MO.FE3dCamera,MO.MLinkerResource);a._centerFront=.4;a.construct=MO.FE3dPerspectiveCamera_construct;a.updateFrustum=MO.FE3dPerspectiveCamera_updateFrustum;a.updateFlatFrustum=MO.FE3dPerspectiveCamera_updateFlatFrustum;a.updateFromCamera=MO.FE3dPerspectiveCamera_updateFromCamera;a.updateFlatCamera=MO.FE3dPerspectiveCamera_updateFlatCamera;return a};
MO.FE3dPerspectiveCamera_construct=function(){this.__base.FE3dCamera.construct.call(this);this._projection=MO.Class.create(MO.FG3dPerspectiveProjection);this._rotation=new MO.SVector3;this._rotationMatrix=new MO.SMatrix3x3;this._quaternion=new MO.SQuaternion;this._quaternionX=new MO.SQuaternion;this._quaternionY=new MO.SQuaternion;this._quaternionZ=new MO.SQuaternion};
MO.FE3dPerspectiveCamera_updateFrustum=function(){this.__base.FE3dCamera.updateFrustum.call(this);var a=this._projection,b=a._size,d=this._frustum;d.update(a._angle,b.width,b.height,a._znear,a._zfar,this._centerFront,this._centerBack,this._matrix);return d};MO.FE3dPerspectiveCamera_updateFlatFrustum=function(){var a=this._projection,b=a._size,d=this._frustum;d.updateFlat(a._angle,b.width,b.height,a._znear,a._zfar,this._centerFront,this._centerBack,this._matrix);return d};
MO.FE3dPerspectiveCamera_updateFromCamera=function(a){var b=this._frustum,d=a.updateFrustum(),e=MO.RConst.DEGREE_RATE*this._projection.angle(),e=d.radius/Math.sin(.5*e),e=Math.max(e,a._projection._zfar);a=this._direction;a.normalize();this._position.set(d.center.x-a.x*e,d.center.y-a.y*e,d.center.z-a.z*e);this.lookAt(d.center.x,d.center.y,d.center.z);this.update();this._matrix.transform(b.coners,0,d.coners,0,8);b.updateCenter();this._projection.updateFrustum(b)};
MO.FE3dPerspectiveCamera_updateFlatCamera=function(a){var b=a.updateFlatFrustum(),d=MO.RConst.DEGREE_RATE*this._projection.angle(),d=b.radius/Math.sin(.5*d),d=Math.max(d,a._projection._zfar);a=this._direction;a.normalize();this._position.set(b.center.x-a.x*d*this._centerFront,b.center.y-a.y*d*this._centerFront,b.center.z-a.z*d*this._centerFront);this.lookAt(b.center.x,b.center.y,b.center.z);this.update();this._projection._znear=.1;this._projection._zfar=d;this._projection.update()};
MO.FE3dRegion=function(a){a=MO.Class.inherits(this,a,MO.FRegion,MO.MGraphicObject,MO.MG3dRegion,MO.MLinkerResource);a._backgroundColor=MO.Class.register(a,new MO.AGetter("_backgroundColor"));a.construct=MO.FE3dRegion_construct;a.selectCamera=MO.FE3dRegion_selectCamera;a.loadResource=MO.FE3dRegion_loadResource;a.reloadResource=MO.FE3dRegion_reloadResource;a.prepare=MO.FE3dRegion_prepare;a.dispose=MO.FE3dRegion_dispose;return a};
MO.FE3dRegion_construct=function(){this.__base.FRegion.construct.call(this);this.__base.MG3dRegion.construct.call(this);var a=this._camera=MO.Class.create(MO.FE3dPerspectiveCamera);a.position().set(0,0,-100);a.lookAt(0,0,0);a.update();a.projection().update();a=this._directionalLight=MO.Class.create(MO.FE3dDirectionalLight);a.direction().set(0,-1,0);a=a.camera();a.position().set(10,10,-10);a.lookAt(0,0,0);(this._backgroundColor=new MO.SColor4).set(0,0,0,1);this._calculateCameraMatrix=new MO.SMatrix3d};
MO.FE3dRegion_selectCamera=function(a){this._camera=a};MO.FE3dRegion_loadResource=function(a){this._resource=a;this._camera.loadResource(a.camera());this._directionalLight.loadResource(a.light());this.reloadResource()};MO.FE3dRegion_reloadResource=function(){var a=this._resource;a.optionBackground()?(this._backgroundColor.assignPower(a.backgroundColor()),this._backgroundColor.alpha=1):this._backgroundColor.set(0,0,0,0)};
MO.FE3dRegion_prepare=function(){this.__base.MG3dRegion.prepare.call(this);this._calculateCameraMatrix.attach(this._camera.matrix())&&(this._changed=!0)};MO.FE3dRegion_dispose=function(){this.__base.FRegion.dispose.call(this);this.__base.MG3dRegion.dispose.call(this)};
MO.FE3dScene=function(a){a=MO.Class.inherits(this,a,MO.FE3dSpace,MO.MLinkerResource,MO.MListenerLoad);a._ready=!1;a._dataReady=!1;a._resource=MO.Class.register(a,new MO.AGetter("_resource"));a._dirty=!1;a.onProcess=MO.FE3dScene_onProcess;a.construct=MO.FE3dScene_construct;a.createRegion=MO.FE3dScene_createRegion;a.loadTechniqueResource=MO.FE3dScene_loadTechniqueResource;a.loadRegionResource=MO.FE3dScene_loadRegionResource;a.loadDisplayResource=MO.FE3dScene_loadDisplayResource;a.loadLayerResource=
MO.FE3dScene_loadLayerResource;a.loadResource=MO.FE3dScene_loadResource;a.testReady=MO.FE3dScene_testReady;a.dirty=MO.FE3dScene_dirty;a.processLoad=MO.FE3dScene_processLoad;a.active=MO.FE3dScene_active;a.deactive=MO.FE3dScene_deactive;return a};MO.FE3dScene_onProcess=function(){this.__base.FE3dSpace.onProcess.call(this);if(this._dirty){for(var a=this._region.allRenderables(),b=a.count()-1;0<=b;b--)a.getAt(b).resetInfos();this._dirty=!1}};MO.FE3dScene_construct=function(){this.__base.FE3dSpace.construct.call(this)};
MO.FE3dScene_createRegion=function(){return MO.Class.create(MO.FE3dSceneRegion)};MO.FE3dScene_loadTechniqueResource=function(a){this._technique._resource=a};
MO.FE3dScene_loadRegionResource=function(a){this._region.loadResource(a);var b=a.camera(),d=b.projection(),e=this.camera();e._resource=b;var f=e.projection();e.position().assign(b.position());e.setDirection(b.direction().x,b.direction().y,b.direction().z);e.update();f.size().assign(this._graphicContext.size());f._angle=d.angle();f._znear=d.znear();f._zfar=d.zfar();f.update();d=a.light();a=d.camera();b=a.projection();e=this.directionalLight();e._resource=d;d=e._camera;e=d._projection;d.position().set(1,
1,-1);d.lookAt(0,0,0);d.position().assign(a.position());d.update();e.size().set(1024,1024);e._angle=60;e._znear=b.znear();e._zfar=b.zfar();e.update()};MO.FE3dScene_loadDisplayResource=function(a,b){var d=MO.Console.find(MO.FE3dInstanceConsole).create(MO.EE3dInstance.SceneDisplay);d.linkGraphicContext(this);d.loadResource(b);MO.Console.find(MO.FE3dSceneConsole).loadDisplay(d);a.pushDisplay(d)};
MO.FE3dScene_loadLayerResource=function(a){var b=MO.Console.find(MO.FE3dInstanceConsole).create(MO.EE3dInstance.SceneLayer);b.loadResource(a);var d=a.displays();if(d)for(var e=d.count(),f=0;f<e;f++){var h=d.at(f);this.loadDisplayResource(b,h)}this.registerLayer(a.code(),b)};
MO.FE3dScene_loadResource=function(a){this.selectTechnique(this,MO.FE3dGeneralTechnique);this.loadTechniqueResource(a.technique());this.loadRegionResource(a.region());if(a=a.layers())for(var b=a.count(),d=0;d<b;d++){var e=a.at(d);this.loadLayerResource(e)}};MO.FE3dScene_testReady=function(){return this._ready};MO.FE3dScene_dirty=function(){this._dirty=!0};
MO.FE3dScene_processLoad=function(){if(this._dataReady)return!0;if(!this._resource.testReady())return!1;this.loadResource(this._resource);this._ready=!0;this.processLoadListener(this);return!0};MO.FE3dScene_active=function(){this.__base.FE3dSpace.active.call(this)};MO.FE3dScene_deactive=function(){this.__base.FE3dSpace.deactive.call(this)};
MO.FE3dSceneAnimation=function(a){a=MO.Class.inherits(this,a,MO.FE3dAnimation);a._animation=null;a._activeClip=null;a._clips=null;a.clips=MO.FE3dSceneAnimation_clips;a.pushClip=MO.FE3dSceneAnimation_pushClip;a.record=MO.Method.empty;a.process=MO.Method.empty;a.selectClip=MO.FE3dSceneAnimation_selectClip;a.loadAnimation=MO.FE3dSceneAnimation_loadAnimation;a.loadSceneResource=MO.FE3dSceneAnimation_loadSceneResource;a.reloadResource=MO.FE3dSceneAnimation_reloadResource;return a};
MO.FE3dSceneAnimation_clips=function(){return this._clips};MO.FE3dSceneAnimation_pushClip=function(a){var b=this._clips;b||(b=this._clips=new MO.TDictionary);b.set(a.code(),a)};MO.FE3dSceneAnimation_selectClip=function(a){a=this._clips.get(a);if(this._activeClip!=a){var b=this._animation._playInfo;b.beginIndex=a.beginIndex();b.endIndex=a.endIndex();b.frameCount=b.endIndex-b.beginIndex+1;this._animation._playRate=a.playRate();this._activeClip=a}};
MO.FE3dSceneAnimation_loadAnimation=function(a){this._animation=a};MO.FE3dSceneAnimation_loadSceneResource=function(a){this._resource=a};MO.FE3dSceneAnimation_reloadResource=function(){this._animation._playRate=this._resource._playRate};
MO.FE3dSceneAnimationClip=function(a){a=MO.Class.inherits(this,a,MO.FObject,MO.MAttributeCode);a._animation=null;a._beginIndex=MO.Class.register(a,new MO.AGetSet("_beginIndex"),0);a._endIndex=MO.Class.register(a,new MO.AGetSet("_endIndex"),0);a._playRate=MO.Class.register(a,new MO.AGetSet("_playRate"),1);a.setRange=MO.FE3dSceneAnimationClip_setRange;return a};MO.FE3dSceneAnimationClip_setRange=function(a,b){this._beginIndex=a;this._endIndex=b};
MO.FE3dSceneCanvas=function(a){a=MO.Class.inherits(this,a,MO.FE3dCanvas);a._activeSpace=null;a._captureStatus=!1;a._capturePosition=null;a._captureCameraPosition=null;a._captureCameraRotation=null;a._actionFullScreen=!1;a._actionPlay=!1;a._actionMovie=!1;a._actionUp=!1;a._actionDown=!1;a._actionForward=!1;a._actionBack=!1;a._cameraMoveRate=.4;a._cameraKeyRotation=.03;a._cameraMouseRotation=.005;a._touchTracker=null;a.onEnterFrame=MO.FE3dSceneCanvas_onEnterFrame;a.onMouseCaptureStart=MO.FE3dSceneCanvas_onMouseCaptureStart;
a.onMouseCapture=MO.FE3dSceneCanvas_onMouseCapture;a.onMouseCaptureStop=MO.FE3dSceneCanvas_onMouseCaptureStop;a.onTouchStart=MO.FE3dSceneCanvas_onTouchStart;a.onTouchMove=MO.FE3dSceneCanvas_onTouchMove;a.onTouchStop=MO.FE3dSceneCanvas_onTouchStop;a.onTouchZoom=MO.FE3dSceneCanvas_onTouchZoom;a.onDataLoaded=MO.FE3dSceneCanvas_onDataLoaded;a.onResize=MO.FE3dSceneCanvas_onResize;a.construct=MO.FE3dSceneCanvas_construct;a.testPlay=MO.FE3dSceneCanvas_testPlay;a.switchPlay=MO.FE3dSceneCanvas_switchPlay;
a.testMovie=MO.FE3dSceneCanvas_testMovie;a.switchMovie=MO.FE3dSceneCanvas_switchMovie;a.doAction=MO.FE3dSceneCanvas_doAction;a.loadByGuid=MO.FE3dSceneCanvas_loadByGuid;a.loadByCode=MO.FE3dSceneCanvas_loadByCode;a.dispose=MO.FE3dSceneCanvas_dispose;return a};
MO.FE3dSceneCanvas_onEnterFrame=function(){var a=this._activeSpace;if(a){var b=a.timer().spanSecond(),d=a.camera(),e=this._cameraMoveRate*b,b=this._cameraKeyRotation*b,f=RKeyboard.isPress(MO.EStageKey.Forward),h=RKeyboard.isPress(MO.EStageKey.Back);(f&&!h||this._actionForward)&&d.doWalk(e);(!f&&h||this._actionBack)&&d.doWalk(-e);f=RKeyboard.isPress(MO.EStageKey.Up);h=RKeyboard.isPress(MO.EStageKey.Down);(f&&!h||this._actionUp)&&d.doFly(e);(!f&&h||this._actionDown)&&d.doFly(-e);e=RKeyboard.isPress(MO.EStageKey.RotationLeft);
f=RKeyboard.isPress(MO.EStageKey.RotationRight);e&&!f&&d.doYaw(b);!e&&f&&d.doYaw(-b);e=RKeyboard.isPress(MO.EStageKey.RotationUp);f=RKeyboard.isPress(MO.EStageKey.RotationDown);e&&!f&&d.doPitch(b);!e&&f&&d.doPitch(-b);d.update();if(this._optionRotation){b=this._rotation;a=a.layers();d=a.count();for(e=0;e<d;e++)f=a.at(e).matrix(),f.setRotation(0,b.y,0),f.update();b.y+=.01}}};
MO.FE3dSceneCanvas_onMouseCaptureStart=function(a){var b=this._activeSpace;if(b){var d=this._activeSpace.region();RConsole.find(FG3dTechniqueConsole).find(this._graphicContext,FG3dSelectTechnique).test(d,a.offsetX,a.offsetY);this._capturePosition.set(a.clientX,a.clientY);this._captureCameraRotation.assign(b.camera()._rotation)}};
MO.FE3dSceneCanvas_onMouseCapture=function(a){if(this._activeSpace){var b=a.clientX-this._capturePosition.x;a=a.clientY-this._capturePosition.y;var d=this._activeSpace.camera().rotation(),e=this._captureCameraRotation;d.x=e.x+a*this._cameraMouseRotation;d.y=e.y+b*this._cameraMouseRotation}};MO.FE3dSceneCanvas_onMouseCaptureStop=function(a){};
MO.FE3dSceneCanvas_onTouchStart=function(a){var b=this._activeSpace;if(b){this._activeSpace.region();var d=a.touches;1==d.length?(a.preventDefault(),a=d[0],this._captureStatus=!0,this._capturePosition.set(a.clientX,a.clientY),this._captureCameraPosition.assign(b.camera().position()),this._captureCameraRotation.assign(b.camera().rotation())):this._touchTracker.eventStart(a)}};
MO.FE3dSceneCanvas_onTouchMove=function(a){if(this._captureStatus){var b=a.touches,d=b.length;1==d?(a.preventDefault(),a=b[0],b=this._activeSpace.camera().rotation(),d=a.clientX-this._capturePosition.x,b.x=this._captureCameraRotation.x+-(a.clientY-this._capturePosition.y)*this._cameraMouseRotation,b.y=this._captureCameraRotation.y+-d*this._cameraMouseRotation):1<d&&this._touchTracker.eventMove(a)}};MO.FE3dSceneCanvas_onTouchStop=function(a){this._touchTracker.eventStop(a);this._captureStatus=!1};
MO.FE3dSceneCanvas_onTouchZoom=function(a){a=a.delta;var b=this._activeSpace;b&&b.camera().doForward(.006*a)};MO.FE3dSceneCanvas_onDataLoaded=function(a){var b=this._activeSpace;a=this._graphicContext.size();var d=b.camera().projection();d.size().set(a.width,a.height);d.update();a=b._region._resource;this._cameraMoveRate=a.moveSpeed();this._cameraKeyRotation=a.rotationKeySpeed();this._cameraMouseRotation=a.rotationMouseSpeed();a=new MO.SEvent(this);a.space=b;this.processLoadListener(a);a.dispose()};
MO.FE3dSceneCanvas_onResize=function(a){this.__base.FE3dCanvas.onResize.call(this,a);a=this._graphicContext.size();var b=this._activeSpace;b&&(b=b.camera().projection(),b.size().set(a.width,a.height),b.update())};
MO.FE3dSceneCanvas_construct=function(){this.__base.FE3dCanvas.construct.call(this);this._rotation=new MO.SVector3;this._capturePosition=new MO.SPoint2;this._captureCameraPosition=new MO.SPoint3;this._captureCameraRotation=new MO.SVector3;this._touchTracker=MO.Class.create(MO.FTouchTracker);this._touchTracker.addTouchZoomListener(this,this.onTouchZoom)};MO.FE3dSceneCanvas_testPlay=function(){return this._actionPlay};
MO.FE3dSceneCanvas_switchPlay=function(a){for(var b=this._activeSpace.allDisplays(),d=b.count(),e=0;e<d;e++){var f=b.at(e);if(MO.Class.isClass(f,FE3dSceneDisplay)){var h=f._sprite;h&&(h._optionPlay=a);f._optionPlay=a}}this._actionPlay=a};MO.FE3dSceneCanvas_testMovie=function(){return this._actionMovie};MO.FE3dSceneCanvas_switchMovie=function(a){for(var b=this._activeSpace.allDisplays(),d=b.count(),e=0;e<d;e++){var f=b.get(e);f._movies&&(f._optionMovie=a)}this._actionMovie=a};
MO.FE3dSceneCanvas_doAction=function(a,b,d){if(this._activeSpace)switch(a.preventDefault(),this._actionBack=this._actionForward=this._actionDown=this._actionUp=!1,b){case "fullscreen":a=this._actionFullScreen=!this._actionFullScreen;MO.RHtml.fullscreen(this._hPanel,a);break;case "play":this.switchMovie(!this._actionMovie);this.switchPlay(this._actionMovie);break;case "up":this._actionUp=d;break;case "down":this._actionDown=d;break;case "forward":this._actionForward=d;break;case "back":this._actionBack=
d}};MO.FE3dSceneCanvas_loadByGuid=function(a){var b=MO.Console.find(MO.FE3dSceneConsole);this._activeSpace&&b.free(this._activeSpace);a=this._activeSpace=b.allocByGuid(this._graphicContext,a);a.addLoadListener(this,this.onDataLoaded);RStage.register("canvas.space",a)};
MO.FE3dSceneCanvas_loadByCode=function(a){var b=MO.Console.find(MO.FE3dSceneConsole);this._activeSpace&&b.free(this._activeSpace);a=this._activeSpace=b.allocByCode(this._graphicContext,a);a.addLoadListener(this,this.onDataLoaded);RStage.register("canvas.space",a)};MO.FE3dSceneCanvas_dispose=function(){var a=this._rotation;a&&(a.dispose(),this._rotation=null);this.__base.FE3dCanvas.dispose.call(this)};
MO.FE3dSceneConsole=function(a){a=MO.Class.inherits(this,a,MO.FConsole);a._scopeCd=MO.EScope.Local;a._loadDisplays=null;a._loadScenes=null;a._pools=null;a._thread=null;a._interval=100;a.onProcess=MO.FE3dSceneConsole_onProcess;a.construct=MO.FE3dSceneConsole_construct;a.scenes=MO.FE3dSceneConsole_scenes;a.loadDisplay=MO.FE3dSceneConsole_loadDisplay;a.allocByGuid=MO.FE3dSceneConsole_allocByGuid;a.allocByCode=MO.FE3dSceneConsole_allocByCode;a.free=MO.FE3dSceneConsole_free;return a};
MO.FE3dSceneConsole_onProcess=function(){var a=this._loadDisplays;for(a.record();a.next();)a.current().processLoad()&&a.removeCurrent();a=this._loadScenes;for(a.record();a.next();)a.current().processLoad()&&a.removeCurrent()};MO.FE3dSceneConsole_construct=function(){this._loadDisplays=new MO.TLooper;this._loadScenes=new MO.TLooper;this._pools=MO.Class.create(MO.FObjectPools);var a=this._thread=MO.Class.create(MO.FThread);a.setInterval(this._interval);a.addProcessListener(this,this.onProcess);MO.Console.find(MO.FThreadConsole).start(a)};
MO.FE3dSceneConsole_scenes=function(){return this._scenes};MO.FE3dSceneConsole_loadDisplay=function(a){this._loadDisplays.push(a)};MO.FE3dSceneConsole_allocByGuid=function(a,b){var d=this._pools.alloc(b);if(d)return d;var e=MO.Console.find(MO.FE3sSceneConsole).loadByGuid(b),d=MO.Class.create(MO.FE3dScene);d.linkGraphicContext(a);d.setResource(e);d._poolCode=b;d.setup();this._loadScenes.push(d);return d};
MO.FE3dSceneConsole_allocByCode=function(a,b){var d=this._pools.alloc(b);if(d)return d;var e=MO.Console.find(MO.FE3sSceneConsole).loadByCode(b),d=MO.Class.create(MO.FE3dScene);d.linkGraphicContext(a);d.setResource(e);d._poolCode=b;d.setup();this._loadScenes.push(d);return d};MO.FE3dSceneConsole_free=function(a){this._pools.free(a._poolCode,a)};
MO.FE3dSceneDisplay=function(a){a=MO.Class.inherits(this,a,MO.FE3dSprite,MO.MListenerLoad);a._dataReady=!1;a._optionPlay=!1;a._optionMovie=!1;a._movieMatrix=null;a._resource=null;a._materials=null;a._parentMaterials=null;a._template=null;a._sprite=null;a.construct=MO.FE3dSceneDisplay_construct;a.calculateOutline=MO.FE3dSceneDisplay_calculateOutline;a.meshRenderables=MO.FE3dSceneDisplay_meshRenderables;a.loadResource=MO.FE3dSceneDisplay_loadResource;a.loadTemplate=MO.FE3dSceneDisplay_loadTemplate;
a.processLoad=MO.FE3dSceneDisplay_processLoad;a.clone=MO.FE3dSceneDisplay_clone;return a};MO.FE3dSceneDisplay_construct=function(){this.__base.FE3dSprite.construct.call(this);this._movieMatrix=new MO.SMatrix3d};MO.FE3dSceneDisplay_calculateOutline=function(){return this._sprite.calculateOutline()};MO.FE3dSceneDisplay_meshRenderables=function(){return this._template.sprite().meshRenderables()};
MO.FE3dSceneDisplay_loadResource=function(a){var b=MO.Console.find(MO.FE3dInstanceConsole);this._resource=a;this._code=a.code();this._matrix.assign(a.matrix());var d=a.movies();if(d)for(var e=d.count(),f=0;f<e;f++){var h=d.at(f),k=b.create(MO.EE3dInstance.SceneMovie);k.loadResource(h);this.pushMovie(k)}if(d=a.materials())for(e=d.count(),h=this._materials=new MO.TDictionary,k=this._parentMaterials=new MO.TDictionary,f=0;f<e;f++){var q=d.at(f),w=b.create(MO.EE3dInstance.SceneMaterial);w._display=this;
w.loadSceneResource(q);h.set(q.guid(),w);k.set(q.parentGuid(),w)}a=a.templateGuid();this._template=MO.Console.find(MO.FE3dTemplateConsole).allocByGuid(this,a)};
MO.FE3dSceneDisplay_loadTemplate=function(a){var b=this._resource,d=a._sprites;if(d)for(var e=this._optionPlay,f=d.count(),h=0;h<f;h++){var k=d.at(h);k._optionPlay=e;k.matrix().identity()}d=this._parentMaterials;k=this._sprite=a.sprite();e=k.renderables();f=e.count();for(a=0;a<f;a++){var h=e.at(a),q=h.material(),w=q.guid();d&&(w=d.get(w))&&(w.loadParent(q),w.reloadResource(),h.setMaterial(w))}this.pushDisplay(k);if(f=k.animations())for(k=f.count(),a=0;a<k;a++)d=f.at(a),h=d.resource(),q=h.guid(),e=
b.findAnimation(q),e||(e=b.syncAnimation(q),e._guid=h._guid,e._code=h._code,e._label=h._label),h=MO.Class.create(MO.FE3dSceneAnimation),h.loadAnimation(d),h.loadSceneResource(e),h.reloadResource(),this.pushAnimation(h)};MO.FE3dSceneDisplay_processLoad=function(){if(this._ready)return!0;var a=this._template;if(!a.testReady())return!1;this.loadTemplate(a);this._ready=!0;this.processLoadListener(this);return!0};MO.FE3dSceneDisplay_clone=function(){};
MO.FE3dSceneDisplayRenderable=function(a){a=MO.Class.inherits(this,a,MO.FE3dTemplateRenderable);a.loadMaterial=MO.FE3dSceneDisplayRenderable_loadMaterial;a.reloadResource=MO.FE3dSceneDisplayRenderable_reloadResource;return a};MO.FE3dSceneDisplayRenderable_loadMaterial=function(a){this._materialReference=a;this._material.calculate(a)};MO.FE3dSceneDisplayRenderable_reloadResource=function(){var a=this._material;a.calculate(this._materialReference);a.update()};
MO.FE3dSceneLayer=function(a){a=MO.Class.inherits(this,a,MO.FDisplayLayer,MO.MLinkerResource);a.makeLabel=MO.FE3dSceneLayer_makeLabel;a.loadResource=MO.FE3dSceneLayer_loadResource;a.process=MO.FE3dSceneLayer_process;return a};MO.FE3dSceneLayer_makeLabel=function(){var a=this.resource(),b=a.code();return(a=a.label())?b+"["+a+"]":b};MO.FE3dSceneLayer_loadResource=function(a){this._resource=a};
MO.FE3dSceneLayer_process=function(a){this.__base.FDisplayLayer.process.call(this,a);var b=this._resource.transformCd();b&&b==MO.EDisplayTransform.CameraPosition&&(a=a.camera().position(),this._matrix.setTranslate(a.x,a.y,a.z),this._matrix.update())};MO.FE3dSceneMaterial=function(a){a=MO.Class.inherits(this,a,MO.FE3dMaterial);a._display=null;a._parentMaterial=null;a.loadSceneResource=MO.FE3dSceneMaterial_loadSceneResource;a.reloadResource=MO.FE3dSceneMaterial_reloadResource;return a};
MO.FE3dSceneMaterial_loadSceneResource=function(a){this._resource=a;this.reloadResource()};MO.FE3dSceneMaterial_reloadResource=function(){this.calculate(this._resource);this.update()};MO.FE3dSceneRegion=function(a){a=MO.Class.inherits(this,a,MO.FE3dRegion);a._resource=MO.Class.register(a,new MO.AGetter("_resource"));a.construct=MO.FE3dSceneRegion_construct;a.loadResource=MO.FE3dSceneRegion_loadResource;a.reloadResource=MO.FE3dSceneRegion_reloadResource;a.dispose=MO.FE3dSceneRegion_dispose;return a};
MO.FE3dSceneRegion_construct=function(){this.__base.FE3dRegion.construct.call(this)};MO.FE3dSceneRegion_loadResource=function(a){this._resource=a;this.reloadResource()};MO.FE3dSceneRegion_reloadResource=function(){var a=this._resource;a.optionBackground()?(this._backgroundColor.assignPower(a.backgroundColor()),this._backgroundColor.alpha=1):this._backgroundColor.set(0,0,0,0)};MO.FE3dSceneRegion_dispose=function(){this._resource=null;this.__base.FE3dRegion.dispose.call(this)};
MO.FE3dSimpleCanvas=function(a){a=MO.Class.inherits(this,a,MO.FE3dCanvas);a._activeSpace=null;a._captureStatus=!1;a._capturePosition=null;a._captureCameraPosition=null;a._captureCameraRotation=null;a._actionFullScreen=!1;a._actionPlay=!1;a._actionMovie=!1;a._actionUp=!1;a._actionDown=!1;a._actionForward=!1;a._actionBack=!1;a._cameraMoveRate=.4;a._cameraKeyRotation=.03;a._cameraMouseRotation=.005;a._stage=MO.Class.register(a,new MO.AGetter("_stage"));a.onEnterFrame=MO.FE3dSimpleCanvas_onEnterFrame;
a.onMouseCaptureStart=MO.FE3dSimpleCanvas_onMouseCaptureStart;a.onMouseCapture=MO.FE3dSimpleCanvas_onMouseCapture;a.onMouseCaptureStop=MO.FE3dSimpleCanvas_onMouseCaptureStop;a.onTouchStart=MO.FE3dSimpleCanvas_onTouchStart;a.onTouchMove=MO.FE3dSimpleCanvas_onTouchMove;a.onTouchStop=MO.FE3dSimpleCanvas_onTouchStop;a.onSceneLoad=MO.FE3dSimpleCanvas_onSceneLoad;a.onResize=MO.FE3dSimpleCanvas_onResize;a.construct=MO.FE3dSimpleCanvas_construct;a.build=MO.FE3dSimpleCanvas_build;a.setPanel=MO.FE3dSimpleCanvas_setPanel;
a.switchPlay=MO.FE3dSimpleCanvas_switchPlay;a.switchMovie=MO.FE3dSimpleCanvas_switchMovie;a.doAction=MO.FE3dSimpleCanvas_doAction;a.dispose=MO.FE3dSimpleCanvas_dispose;return a};
MO.FE3dSimpleCanvas_onEnterFrame=function(){var a=this._activeSpace;if(a){var b=a.camera(),d=this._cameraMoveRate,e=this._cameraKeyRotation,f=MO.Window.Keyboard.isPress(MO.EKeyCode.W),h=MO.Window.Keyboard.isPress(MO.EKeyCode.S);(f&&!h||this._actionForward)&&b.doWalk(d);(!f&&h||this._actionBack)&&b.doWalk(-d);f=MO.Window.Keyboard.isPress(MO.EKeyCode.A);h=MO.Window.Keyboard.isPress(MO.EKeyCode.D);f&&!h&&b.doYaw(e);!f&&h&&b.doYaw(-e);f=MO.Window.Keyboard.isPress(MO.EKeyCode.Q);h=MO.Window.Keyboard.isPress(MO.EKeyCode.E);
(f&&!h||this._actionUp)&&b.doFly(d);(!f&&h||this._actionDown)&&b.doFly(-d);d=MO.Window.Keyboard.isPress(MO.EKeyCode.Z);f=MO.Window.Keyboard.isPress(MO.EKeyCode.X);d&&!f&&b.doPitch(e);!d&&f&&b.doPitch(-e);b.update();if(this._optionRotation){e=this._rotation;a=a.layers();b=a.count();for(d=0;d<b;d++)f=a.value(d).matrix(),f.setRotation(0,e.y,0),f.update();e.y+=.01}}};MO.FE3dSimpleCanvas_onMouseCaptureStart=function(a){var b=this._activeSpace;b&&(this._capturePosition.set(a.clientX,a.clientY),this._captureCameraRotation.assign(b.camera()._rotation))};
MO.FE3dSimpleCanvas_onMouseCapture=function(a){if(this._activeSpace){var b=a.clientX-this._capturePosition.x;a=a.clientY-this._capturePosition.y;var d=this._activeSpace.camera().rotation(),e=this._captureCameraRotation;d.x=e.x+a*this._cameraMouseRotation;d.y=e.y+b*this._cameraMouseRotation}};MO.FE3dSimpleCanvas_onMouseCaptureStop=function(a){};
MO.FE3dSimpleCanvas_onTouchStart=function(a){var b=this._activeSpace;if(b){this._activeSpace.region();var d=a.touches;1==d.length&&(a.preventDefault(),a=d[0],this._captureStatus=!0,this._capturePosition.set(a.clientX,a.clientY),this._captureCameraPosition.assign(b.camera().position()),this._captureCameraRotation.assign(b.camera().rotation()))}};
MO.FE3dSimpleCanvas_onTouchMove=function(a){if(this._captureStatus){var b=a.touches;if(1==b.length){a.preventDefault();a=b[0];var b=this._activeSpace.camera().rotation(),d=a.clientX-this._capturePosition.x;b.x=this._captureCameraRotation.x+-(a.clientY-this._capturePosition.y)*this._cameraMouseRotation;b.y=this._captureCameraRotation.y+-d*this._cameraMouseRotation}}};MO.FE3dSimpleCanvas_onTouchStop=function(a){this._captureStatus=!1};
MO.FE3dSimpleCanvas_onSceneLoad=function(a){a=this._activeSpace;var b=this._graphicContext.size(),d=a.camera().projection();d.size().set(b.width,b.height);d.update();b=a._region._resource;this._cameraMoveRate=b.moveSpeed();this._cameraKeyRotation=b.rotationKeySpeed();this._cameraMouseRotation=b.rotationMouseSpeed();this.processLoadListener(this,a)};
MO.FE3dSimpleCanvas_onResize=function(a){this.__base.FE3dCanvas.onResize.call(this,a);a=this._graphicContext.size();var b=this._activeSpace;b&&(b=b.camera().projection(),b.size().set(a.width,a.height),b.update())};MO.FE3dSimpleCanvas_construct=function(){this.__base.FE3dCanvas.construct.call(this);this._rotation=new MO.SVector3;this._capturePosition=new MO.SPoint2;this._captureCameraPosition=new MO.SPoint3;this._captureCameraRotation=new MO.SVector3};
MO.FE3dSimpleCanvas_build=function(a){this.__base.FE3dCanvas.build.call(this,a);a=this._stage=this._activeSpace=MO.Class.create(MO.FE3dSimpleStage);a.linkGraphicContext(this);a.region().linkGraphicContext(this);a.selectTechnique(this,FE3dGeneralTechnique);MO.RStage.register("simple.stage",a)};
MO.FE3dSimpleCanvas_setPanel=function(a){this.__base.FE3dCanvas.setPanel.call(this,a);a=this._stage.region().camera();var b=a.projection();b.size().set(this._hCanvas.offsetWidth,this._hCanvas.offsetHeight);b.update();a.position().set(0,0,-10);a.lookAt(0,0,0);a.update()};MO.FE3dSimpleCanvas_switchPlay=function(a){for(var b=this._activeSpace.allDisplays(),d=b.count(),e=0;e<d;e++){var f=b.get(e);f._movies&&(f._optionPlay=a)}this._actionPlay=a};
MO.FE3dSimpleCanvas_switchMovie=function(a){for(var b=this._activeSpace.allDisplays(),d=b.count(),e=0;e<d;e++){var f=b.get(e);f._movies&&(f._optionMovie=a)}this._actionMovie=a};
MO.FE3dSimpleCanvas_doAction=function(a,b,d){if(this._activeSpace)switch(a.preventDefault(),this._actionBack=this._actionForward=this._actionDown=this._actionUp=!1,b){case "fullscreen":a=this._actionFullScreen=!this._actionFullScreen;RHtml.fullscreen(this._hPanel,a);break;case "play":this.switchMovie(!this._actionMovie);this.switchPlay(this._actionMovie);break;case "up":this._actionUp=d;break;case "down":this._actionDown=d;break;case "forward":this._actionForward=d;break;case "back":this._actionBack=
d}};MO.FE3dSimpleCanvas_dispose=function(){var a=this._rotation;a&&(a.dispose(),this._rotation=null);this.__base.FE3dCanvas.dispose.call(this)};MO.FE3dSimpleDesktop=function(a){a=MO.Class.inherits(this,a,MO.FDesktop);a._canvas3d=MO.Class.register(a,new MO.AGetter("_canvas3d"));a._canvas2d=MO.Class.register(a,new MO.AGetter("_canvas2d"));a.onResize=MO.FE3dSimpleDesktop_onResize;a.construct=MO.FE3dSimpleDesktop_construct;a.build=MO.FE3dSimpleDesktop_build;a.dispose=MO.FE3dSimpleDesktop_dispose;return a};
MO.FE3dSimpleDesktop_onResize=function(a){};MO.FE3dSimpleDesktop_construct=function(){this.__base.FDesktop.construct.call(this)};
MO.FE3dSimpleDesktop_build=function(a){this.__base.FDesktop.build.call(this,a);MO.RWindow.lsnsResize.register(this,this.onResize);var b=this._canvas3d=MO.RClass.create(MO.FE3dSimpleCanvas);b.build(a);b.setPanel(a);var d=b.size(),e=b._hCanvas,b=this._canvas2d=MO.RClass.create(MO.FE2dCanvas);b.size().assign(d);b.build(a);b.setPanel(a);a=b._hCanvas;a.style.position="absolute";a.style.left=e.offsetLeft+"px";a.style.top=e.offsetTop+"px"};MO.FE3dSimpleDesktop_dispose=function(){this.__base.FDesktop.dispose.call(this)};
MO.FE3dSimpleStage=function(a){a=MO.RClass.inherits(this,a,MO.FE3dStage);a._optionKeyboard=!0;a._skyLayer=MO.RClass.register(a,new MO.AGetter("_skyLayer"));a._mapLayer=MO.RClass.register(a,new MO.AGetter("_mapLayer"));a._spriteLayer=MO.RClass.register(a,new MO.AGetter("_spriteLayer"));a._faceLayer=MO.RClass.register(a,new MO.AGetter("_faceLayer"));a.construct=MO.FE3dSimpleStage_construct;a.active=MO.FE3dSimpleStage_active;a.deactive=MO.FE3dSimpleStage_deactive;return a};
MO.FE3dSimpleStage_construct=function(){this.__base.FE3dStage.construct.call(this);var a=this._skyLayer=MO.RClass.create(MO.FDisplayLayer);this.registerLayer("SkyLayer",a);a=this._mapLayer=MO.RClass.create(MO.FDisplayLayer);this.registerLayer("MapLayer",a);a=this._spriteLayer=MO.RClass.create(MO.FDisplayLayer);this.registerLayer("SpriteLayer",a);a=this._faceLayer=MO.RClass.create(MO.FDisplayLayer);this.registerLayer("FaceLayer",a)};MO.FE3dSimpleStage_active=function(){this.__base.FE3dStage.active.call(this)};
MO.FE3dSimpleStage_deactive=function(){this.__base.FE3dStage.deactive.call(this)};
MO.FE3dSpace=function(a){a=MO.Class.inherits(this,a,MO.FE3dStage,MO.MListener);a._dataReady=!1;a._resource=MO.Class.register(a,new MO.AGetSet("_resource"));a._materials=MO.Class.register(a,new MO.AGetter("_materials"));a._dirty=!1;a._loadListeners=MO.Class.register(a,new MO.AListener("_loadListeners",MO.EEvent.Load));a.onProcess=MO.FE3dSpace_onProcess;a.construct=MO.FE3dSpace_construct;a.linkGraphicContext=MO.FE3dSpace_linkGraphicContext;a.createRegion=MO.FE3dSpace_createRegion;a.findMaterial=MO.FE3dSpace_findMaterial;
a.loadTechniqueResource=MO.FE3dSpace_loadTechniqueResource;a.loadRegionResource=MO.FE3dSpace_loadRegionResource;a.loadDisplayResource=MO.FE3dSpace_loadDisplayResource;a.loadLayerResource=MO.FE3dSpace_loadLayerResource;a.loadResource=MO.FE3dSpace_loadResource;a.commitResource=MO.FE3dSpace_commitResource;a.dirty=MO.FE3dSpace_dirty;a.processLoad=MO.FE3dSpace_processLoad;a.active=MO.FE3dSpace_active;a.deactive=MO.FE3dSpace_deactive;return a};
MO.FE3dSpace_onProcess=function(){this.__base.FE3dStage.onProcess.call(this);if(this._dirty){for(var a=this._region.allRenderables(),b=a.count(),d=0;d<b;d++)a.at(d).resetInfos();this._dirty=!1}};MO.FE3dSpace_construct=function(){this.__base.FE3dStage.construct.call(this);this._materials=new MO.TDictionary};MO.FE3dSpace_linkGraphicContext=function(a){this.__base.FE3dStage.linkGraphicContext.call(this,a);this._region.linkGraphicContext(a)};MO.FE3dSpace_createRegion=function(){return MO.Class.create(MO.FE3dRegion)};
MO.FE3dSpace_findMaterial=function(a){return this._materials.get(a)};MO.FE3dSpace_loadTechniqueResource=function(a){this._technique._resource=a};
MO.FE3dSpace_loadRegionResource=function(a){this._region.loadResource(a);var b=a.camera();b.projection();var d=this.camera();d.projection().size().assign(this._graphicContext.size());d.loadResource(b);d=a.light();a=d.camera();var b=a.projection(),e=this.directionalLight();e._resource=d;d=e._camera;e=d._projection;d.position().set(1,1,-1);d.lookAt(0,0,0);d.position().assign(a.position());d.update();e.size().set(1024,1024);e._angle=60;e._znear=b.znear();e._zfar=b.zfar();e.update()};
MO.FE3dSpace_loadDisplayResource=function(a,b){var d=MO.Console.find(MO.FE3dSpaceConsole).factory().create(EE3dScene.Display);d.linkGraphicContext(this);d.loadSceneResource(b);MO.Console.find(MO.FE3dTemplateConsole).loadByGuid(d,b.templateGuid());a.pushDisplay(d)};
MO.FE3dSpace_loadLayerResource=function(a){var b=MO.Console.find(MO.FE3dSpaceConsole).factory().create(EE3dScene.Layer);b.loadResource(a);var d=a.displays();if(d)for(var e=d.count(),f=0;f<e;f++){var h=d.get(f);this.loadDisplayResource(b,h)}this.registerLayer(a.code(),b)};
MO.FE3dSpace_loadResource=function(a){this._resource=a;this.loadTechniqueResource(a.technique());this.loadRegionResource(a.region());var b=a.materials();if(b)for(var d=b.count(),e=MO.Console.find(MO.FE3rMaterialConsole),f=0;f<d;f++){var h=b.at(f).guid(),k=e.load(this,h);this._materials.set(h,k)}if(a=a.layers())for(b=a.count(),f=0;f<b;f++)d=a.at(f),this.loadLayerResource(d)};MO.FE3dSpace_commitResource=function(){this._region.camera().commitResource()};MO.FE3dSpace_dirty=function(){this._dirty=!0};
MO.FE3dSpace_processLoad=function(){if(this._dataReady)return!0;if(!this._resource.testReady())return!1;this.loadResource(this._resource);this.processLoadListener(this);return!0};MO.FE3dSpace_active=function(){this.__base.FE3dStage.active.call(this)};MO.FE3dSpace_deactive=function(){this.__base.FE3dStage.deactive.call(this)};
MO.FE3dSprite=function(a){a=MO.Class.inherits(this,a,MO.FE3dDisplayContainer,MO.MGraphicObject,MO.MLinkerResource);a._dataReady=!1;a._ready=!1;a._shapes=null;a._skeletons=null;a._animations=null;a._movies=null;a._resource=null;a.construct=MO.FE3dSprite_construct;a.testReady=MO.FE3dSprite_testReady;a.makeLabel=MO.FE3dSprite_makeLabel;a.findMeshByCode=MO.FE3dSprite_findMeshByCode;a.meshRenderables=MO.FE3dSprite_shapes;a.skeletons=MO.FE3dSprite_skeletons;a.pushSkeleton=MO.FE3dSprite_pushSkeleton;a.findAnimation=
MO.FE3dSprite_findAnimation;a.animations=MO.FE3dSprite_animations;a.pushAnimation=MO.FE3dSprite_pushAnimation;a.movies=MO.FE3dSprite_movies;a.pushMovie=MO.FE3dSprite_pushMovie;a.loadSkeletons=MO.FE3dSprite_loadSkeletons;a.linkAnimation=MO.FE3dSprite_linkAnimation;a.loadAnimations=MO.FE3dSprite_loadAnimations;a.loadResource=MO.FE3dSprite_loadResource;a.reloadResource=MO.FE3dSprite_reloadResource;a.load=MO.FE3dSprite_load;a.updateMatrix=MO.FE3dSprite_updateMatrix;a.selectClip=MO.FE3dSprite_selectClip;
a.process=MO.FE3dSprite_process;a.dispose=MO.FE3dSprite_dispose;return a};MO.FE3dSprite_construct=function(){this.__base.FE3dDisplayContainer.construct.call(this);this._shapes=new TObjects};MO.FE3dSprite_testReady=function(){var a=this._shapes;if(a)for(var b=a.count(),d=0;d<b;d++)if(!a.at(d).testReady())return!1;return!0};MO.FE3dSprite_makeLabel=function(){var a=this.resource(),b=a.code();return(a=a.label())?b+"["+a+"]":b};
MO.FE3dSprite_findMeshByCode=function(a){for(var b=this._shapes,d=b.count()-1;0<=d;d--){var e=b.getAt(d);if(e._renderable._resource._code==a)return e}return null};MO.FE3dSprite_shapes=function(){return this._shapes};MO.FE3dSprite_skeletons=function(){return this._skeletons};MO.FE3dSprite_pushSkeleton=function(a){var b=this._skeletons;b||(b=this._skeletons=new MO.TDictionary);this._activeSkeleton||(this._activeSkeleton=a);b.set(a._resource.guid(),a)};
MO.FE3dSprite_findAnimation=function(a){var b=this._animations;return b?b.get(a):null};MO.FE3dSprite_animations=function(){return this._animations};MO.FE3dSprite_pushAnimation=function(a){var b=this._animations;b||(b=this._animations=new MO.TDictionary);var d=a.resource();b.set(d.guid(),a)};MO.FE3dSprite_movies=function(){return this._movies};MO.FE3dSprite_pushMovie=function(a){var b=this._movies;b||(b=this._movies=new MO.TObjects);b.push(a)};
MO.FE3dSprite_loadSkeletons=function(a){var b=a.count();if(0<b){this.skeletons();for(var d=0;d<b;d++){var e=a.getAt(d),f=MO.Class.create(MO.FE3rSkeleton);f.loadResource(e);this.pushSkeleton(f)}}};MO.FE3dSprite_linkAnimation=function(a){a=a.tracks();for(var b=a.count(),d=0;d<b;d++){var e=a.getAt(d),f=e._resource._meshCode;f&&(this.findMeshByCode(f)._activeTrack=e)}};
MO.FE3dSprite_loadAnimations=function(a){var b=a.count();if(0<b)for(var d=0;d<b;d++){var e=a.getAt(d),f=this.findAnimation(e.guid());f||(f=e.skeleton()?MO.Class.create(MO.FE3rSkeletonAnimation):MO.Class.create(MO.FE3rMeshAnimation),f._display=this,f.loadResource(e),this.pushAnimation(f))}};
MO.FE3dSprite_loadResource=function(a){this._resource=a;this._matrix.assign(a.matrix());a=a.renderables();var b=a.count();if(0<b)for(var d=this._shapes,e=0;e<b;e++){var f=a.at(e),h=MO.Class.create(MO.FE3dTemplateRenderable);h._display=this;h.linkGraphicContext(this);h.loadResource(f);d.push(h);this.pushRenderable(h)}};MO.FE3dSprite_reloadResource=function(){var a=this._shapes;if(a)for(var b=a.count(),d=0;d<b;d++)a.getAt(d).reloadResource()};
MO.FE3dSprite_load=function(){var a=this._shapes;if(a)for(var b=a.count(),d=0;d<b;d++)a.at(d).load()};MO.FE3dSprite_updateMatrix=function(a){a=this._currentMatrix.identity();var b=this._movies;if(b){if(this._optionMovie)for(var d=b.count(),e=0;e<d;e++)b.at(e).process(this._movieMatrix);a.append(this._movieMatrix)}a.append(this._matrix);(a=this._parent)&&this._currentMatrix.append(a._currentMatrix)};MO.FE3dSprite_selectClip=function(a){var b=this._animations;if(b)for(var d=b.count(),e=0;e<d;e++)b.at(e).selectClip(a)};
MO.FE3dSprite_process=function(a){var b=this._animations;if(b)for(var d=b.count(),e=0;e<d;e++){var f=b.at(e);f.record()}this.__base.FE3dDisplayContainer.process.call(this,a);if((a=this._activeSkeleton)&&b)for(d=b.count(),e=0;e<d;e++)f=b.at(e),f.process(a)};MO.FE3dSprite_dispose=function(){this._shapes=MO.Lang.Object.dispose(this._shapes);this.__base.FE3dDisplayContainer.dispose.call(this)};
MO.FE3dTemplate=function(a){a=MO.Class.inherits(this,a,MO.FE3dSpace,MO.MGraphicObject,MO.MListenerLoad);a._dataReady=!1;a._ready=!1;a._sprites=MO.Class.register(a,new MO.AGetter("_sprites"));a._skeletons=MO.Class.register(a,new MO.AGetter("_skeletons"));a._animations=MO.Class.register(a,new MO.AGetter("_animations"));a.construct=MO.FE3dTemplate_construct;a.testReady=MO.FE3dTemplate_testReady;a.sprite=MO.FE3dTemplate_sprite;a.findMeshByCode=MO.FE3dTemplate_findMeshByCode;a.meshRenderables=MO.FE3dTemplate_sprites;
a.pushSkeleton=MO.FE3dTemplate_pushSkeleton;a.findAnimation=MO.FE3dTemplate_findAnimation;a.pushAnimation=MO.FE3dTemplate_pushAnimation;a.visible=MO.FE3dTemplate_visible;a.setVisible=MO.FE3dTemplate_setVisible;a.loadSkeletons=MO.FE3dTemplate_loadSkeletons;a.linkAnimation=MO.FE3dTemplate_linkAnimation;a.loadAnimations=MO.FE3dTemplate_loadAnimations;a.loadResource=MO.FE3dTemplate_loadResource;a.reloadResource=MO.FE3dTemplate_reloadResource;a.processLoad=MO.FE3dTemplate_processLoad;a.process=MO.FE3dTemplate_process;
a.dispose=MO.FE3dTemplate_dispose;return a};MO.FE3dTemplate_construct=function(){this.__base.FE3dSpace.construct.call(this);var a=this._layer=MO.Class.create(MO.FDisplayLayer);this.registerLayer("Layer",a);this._sprites=new MO.TObjects};MO.FE3dTemplate_testReady=function(){return this._ready};MO.FE3dTemplate_sprite=function(){return this._sprites.first()};MO.FE3dTemplate_findMeshByCode=function(a){for(var b=this._sprites,d=b.count()-1;0<=d;d--){var e=b.getAt(d);if(e._renderable._resource._code==a)return e}return null};
MO.FE3dTemplate_pushSkeleton=function(a){var b=this._skeletons;b||(b=this._skeletons=new MO.TDictionary);this._activeSkeleton||(this._activeSkeleton=a);b.set(a._resource.guid(),a)};MO.FE3dTemplate_sprites=function(){return this._sprites};MO.FE3dTemplate_findAnimation=function(a){var b=this._animations;return b?b.get(a):null};MO.FE3dTemplate_pushAnimation=function(a){var b=this._animations;b||(b=this._animations=new MO.TDictionary);var d=a.resource();b.set(d.guid(),a)};MO.FE3dTemplate_visible=function(){return this.sprite().visible()};
MO.FE3dTemplate_setVisible=function(a){this.sprite().setVisible(a)};MO.FE3dTemplate_loadSkeletons=function(a){var b=a.count();if(0<b){this.skeletons();for(var d=0;d<b;d++){var e=a.at(d),f=MO.Class.create(MO.FE3rSkeleton);f.loadResource(e);this.pushSkeleton(f)}}};MO.FE3dTemplate_linkAnimation=function(a){a=a.tracks();for(var b=a.count(),d=0;d<b;d++){var e=a.getAt(d),f=e._resource._meshCode;f&&(this.findMeshByCode(f)._activeTrack=e)}};
MO.FE3dTemplate_loadAnimations=function(a){var b=a.count();if(0<b)for(var d=0;d<b;d++){var e=a.getAt(d),f=this.findAnimation(e.guid());f||(f=e.skeleton()?MO.Class.create(MO.FE3rSkeletonAnimation):MO.Class.create(MO.FE3rMeshAnimation),f._display=this,f.loadResource(e),this.pushAnimation(f))}};
MO.FE3dTemplate_loadResource=function(a){this.selectTechnique(this,FE3dGeneralTechnique).setResource(a.technique());this.__base.FE3dSpace.loadResource.call(this,a);if(a=a.displays()){var b=a.count();if(0<b)for(var d=0;d<b;d++){var e=a.at(d),f=MO.Class.create(MO.FE3dTemplateDisplay);f._parent=this;f.linkGraphicContext(this);f.loadResource(e);this._sprites.push(f)}}};MO.FE3dTemplate_reloadResource=function(){var a=this._sprites;if(a)for(var b=a.count(),d=0;d<b;d++)a.at(d).reloadResource()};
MO.FE3dTemplate_processLoad=function(){if(this._ready)return!0;if(!this._dataReady){var a=this._resource;if(!a.testReady())return!1;this.loadResource(a);this._dataReady=!0}var b=this._sprites;if(b){for(var d=b.count(),a=0;a<d;a++){var e=b.at(a);if(!e.testReady())return!1}for(a=0;a<d;a++)e=b.at(a),e.load(),this._layer.pushDisplay(e)}if(b=this._animations)for(d=b.count(),a=0;a<d;a++)e=b.at(a),null==e.resource().skeleton()&&this.linkAnimation(e);this._ready=!0;a=MO.Memory.alloc(SEvent);a.sender=this;
a.template=this;this.processLoadListener(a);MO.Memory.free(a);return this._ready};MO.FE3dTemplate_process=function(a){this.__base.FE3dSpace.process.call(this)};MO.FE3dTemplate_dispose=function(){this._sprites=MO.Lang.Object.dispose(this._sprites);this.__base.FE3dSpace.dispose.call(this)};
MO.FE3dTemplateCanvas=function(a){a=MO.Class.inherits(this,a,MO.FE3dCanvas);a._activeTemplate=null;a._capturePosition=null;a._captureRotation=null;a.onEnterFrame=MO.FE3dTemplateCanvas_onEnterFrame;a.onMouseCaptureStart=MO.FE3dTemplateCanvas_onMouseCaptureStart;a.onMouseCapture=MO.FE3dTemplateCanvas_onMouseCapture;a.onMouseCaptureStop=MO.FE3dTemplateCanvas_onMouseCaptureStop;a.onResize=MO.FE3dTemplateCanvas_onResize;a.onTemplateLoad=MO.FE3dTemplateCanvas_onTemplateLoad;a.construct=MO.FE3dTemplateCanvas_construct;
a.loadByGuid=MO.FE3dTemplateCanvas_loadByGuid;a.loadByCode=MO.FE3dTemplateCanvas_loadByCode;a.dispose=MO.FE3dTemplateCanvas_dispose;return a};
MO.FE3dTemplateCanvas_onEnterFrame=function(){var a=this._activeTemplate;if(a){var b=a.camera(),d=.05,e=RKeyboard.isPress(EKeyCode.W),f=RKeyboard.isPress(EKeyCode.S);e&&!f&&b.doWalk(.5);!e&&f&&b.doWalk(-.5);e=RKeyboard.isPress(EKeyCode.A);f=RKeyboard.isPress(EKeyCode.D);e&&!f&&b.doYaw(d);!e&&f&&b.doYaw(-d);e=RKeyboard.isPress(EKeyCode.Q);f=RKeyboard.isPress(EKeyCode.E);e&&!f&&b.doFly(.5);!e&&f&&b.doFly(-.5);f=RKeyboard.isPress(EKeyCode.Z);e=RKeyboard.isPress(EKeyCode.X);f&&!e&&b.doPitch(d);!f&&e&&
b.doPitch(-d);b.update();if(this._optionRotation){d=this._rotation;a=a.layers();b=a.count();for(e=0;e<b;e++)f=a.value(e).matrix(),f.setRotation(0,d.y,0),f.update();d.y+=.01}}};MO.FE3dTemplateCanvas_onMouseCaptureStart=function(a){var b=this._activeTemplate;if(b){var d=this._activeTemplate.region();MO.Console.find(MO.FG3dTechniqueConsole).find(this._graphicContext,FG3dSelectTechnique).test(d,a.offsetX,a.offsetY);this._capturePosition.set(a.clientX,a.clientY);this._captureRotation.assign(b.camera()._rotation)}};
MO.FE3dTemplateCanvas_onMouseCapture=function(a){if(this._activeTemplate){var b=a.clientX-this._capturePosition.x;a=a.clientY-this._capturePosition.y;var d=this._activeTemplate.camera().rotation(),e=this._captureRotation;d.x=e.x+.003*a;d.y=e.y+.003*b}};MO.FE3dTemplateCanvas_onMouseCaptureStop=function(a){};
MO.FE3dTemplateCanvas_onResize=function(){this.__base.FE3dCanvas.onResize.call(this,event);var a=this._graphicContext.size(),b=this._activeSpace;b&&(b=b.camera().projection(),b.size().set(a.width,a.height),b.update())};MO.FE3dTemplateCanvas_onTemplateLoad=function(a){a=this._activeTemplate;var b=this._graphicContext.size(),d=a.camera().projection();d.size().set(b.width,b.height);d.update();this.processLoadListener(this,a)};
MO.FE3dTemplateCanvas_construct=function(){this.__base.FE3dCanvas.construct.call(this);this._rotation=new MO.SVector3;this._capturePosition=new MO.SPoint2;this._captureRotation=new MO.SVector3};
MO.FE3dTemplateCanvas_loadByGuid=function(a){var b=this._graphicContext,d=MO.Console.find(MO.FE3dSceneConsole);null!=this._activeTemplate&&d.free(this._activeTemplate);a=d.alloc(this,a);a.addLoadListener(this,this.onTemplateLoad);a.selectTechnique(b,FG3dGeneralTechnique);this._stage=this._activeTemplate=a;RStage.register("stage3d",a)};
MO.FE3dTemplateCanvas_loadByCode=function(a){var b=this._graphicContext,d=MO.Console.find(MO.FE3dTemplateConsole);null!=this._activeTemplate&&d.free(this._activeTemplate);a=d.allocByCode(b,a);a.addLoadListener(this,this.onTemplateLoad);a.selectTechnique(b,FE3dGeneralTechnique);this._stage=this._activeTemplate=a;MO.RStage.register("stage.template",a)};MO.FE3dTemplateCanvas_dispose=function(){var a=this._rotation;a&&(a.dispose(),this._rotation=null);this.__base.FE3dCanvas.dispose.call(this)};
MO.FE3dTemplateConsole=function(a){a=MO.Class.inherits(this,a,MO.FConsole);a._scopeCd=MO.EScope.Local;a._loadQueue=null;a._pools=null;a._thread=null;a._interval=200;a.onProcess=MO.FE3dTemplateConsole_onProcess;a.construct=MO.FE3dTemplateConsole_construct;a.allocByGuid=MO.FE3dTemplateConsole_allocByGuid;a.allocByCode=MO.FE3dTemplateConsole_allocByCode;a.free=MO.FE3dTemplateConsole_free;return a};
MO.FE3dTemplateConsole_onProcess=function(){var a=this._loadQueue;for(a.record();a.next();)a.current().processLoad()&&a.removeCurrent()};MO.FE3dTemplateConsole_construct=function(){this._loadQueue=new MO.TLooper;this._pools=MO.Class.create(MO.FObjectPools);var a=this._thread=MO.Class.create(MO.FThread);a.setInterval(this._interval);a.addProcessListener(this,this.onProcess);MO.Console.find(MO.FThreadConsole).start(a)};
MO.FE3dTemplateConsole_allocByGuid=function(a,b){var d=this._pools.alloc(b);if(d)return d;var e=MO.Console.find(MO.FE3sTemplateConsole).loadByGuid(b),d=MO.Class.create(MO.FE3dTemplate);d.linkGraphicContext(a);d.setResource(e);d._poolCode=b;this._loadQueue.push(d);return d};
MO.FE3dTemplateConsole_allocByCode=function(a,b){var d=this._pools.alloc(b);if(d)return d;var e=MO.Console.find(MO.FE3sTemplateConsole).loadByCode(b),d=MO.Class.create(MO.FE3dTemplate);d.linkGraphicContext(a);d.setResource(e);d._poolCode=b;this._loadQueue.push(d);return d};MO.FE3dTemplateConsole_free=function(a){this._pools.free(a._poolCode,a)};
MO.FE3dTemplateDisplay=function(a){a=MO.Class.inherits(this,a,MO.FE3dSprite,MO.MListenerLoad);a._dataReady=!1;a._ready=!1;a._shapes=MO.Class.register(a,new MO.AGetter("_shapes"));a._skeletons=MO.Class.register(a,new MO.AGetter("_skeletons"));a.construct=MO.FE3dTemplateDisplay_construct;a.testReady=MO.FE3dTemplateDisplay_testReady;a.findMeshByCode=MO.FE3dTemplateDisplay_findMeshByCode;a.pushSkeleton=MO.FE3dTemplateDisplay_pushSkeleton;a.loadSkeletons=MO.FE3dTemplateDisplay_loadSkeletons;a.linkAnimation=
MO.FE3dTemplateDisplay_linkAnimation;a.loadAnimations=MO.FE3dTemplateDisplay_loadAnimations;a.loadResource=MO.FE3dTemplateDisplay_loadResource;a.reloadResource=MO.FE3dTemplateDisplay_reloadResource;a.load=MO.FE3dTemplateDisplay_load;a.dispose=MO.FE3dTemplateDisplay_dispose;return a};MO.FE3dTemplateDisplay_construct=function(){this.__base.FE3dSprite.construct.call(this);this._shapes=new MO.TObjects};
MO.FE3dTemplateDisplay_testReady=function(){var a=this._shapes;if(a)for(var b=a.count(),d=0;d<b;d++)if(!a.at(d).testReady())return!1;return!0};MO.FE3dTemplateDisplay_findMeshByCode=function(a){for(var b=this._shapes,d=b.count()-1;0<=d;d--){var e=b.at(d);if(e._renderable._resource._code==a)return e}return null};
MO.FE3dTemplateDisplay_pushSkeleton=function(a){var b=a.resource().guid(),d=this._skeletons;d||(d=this._skeletons=new MO.TDictionary);this._activeSkeleton||(this._activeSkeleton=a);d.set(b,a)};MO.FE3dTemplateDisplay_loadSkeletons=function(a){var b=a.count();if(0<b)for(var d=0;d<b;d++){var e=a.at(d),f=MO.Class.create(MO.FE3rSkeleton);f.loadResource(e);this.pushSkeleton(f)}};
MO.FE3dTemplateDisplay_linkAnimation=function(a){a=a.tracks();for(var b=a.count(),d=0;d<b;d++){var e=a.at(d),f=e._resource._meshCode;f&&(this.findMeshByCode(f)._activeTrack=e)}};MO.FE3dTemplateDisplay_loadAnimations=function(a){for(var b=a.count(),d=0;d<b;d++){var e=a.at(d),f=e.guid(),f=this.findAnimation(f);f||(f=e.skeleton()?MO.Class.create(MO.FE3rSkeletonAnimation):MO.Class.create(MO.FE3rMeshAnimation),f._display=this,f.loadResource(e),this.pushAnimation(f))}};
MO.FE3dTemplateDisplay_loadResource=function(a){this._resource=a;var b=MO.Console.find(MO.FE3dInstanceConsole);this._matrix.assign(a.matrix());if(a=a.renderables())for(var d=this._shapes,e=a.count(),f=0;f<e;f++){var h=a.at(f),k=b.create(MO.EE3dInstance.TemplateRenderable);k._display=this;k.linkGraphicContext(this);k.loadResource(h);d.push(k);this.pushRenderable(k)}};MO.FE3dTemplateDisplay_reloadResource=function(){var a=this._shapes;if(a)for(var b=a.count(),d=0;d<b;d++)a.at(d).reloadResource()};
MO.FE3dTemplateDisplay_load=function(){var a=this._shapes;if(a)for(var b=a.count(),d=0;d<b;d++)a.at(d).load();if(a=this._animations)for(b=a.count(),d=0;d<b;d++){var e=a.at(d);null==e.resource().skeleton()&&this.linkAnimation(e)}};MO.FE3dTemplateDisplay_dispose=function(){this._shapes=MO.Lang.Object.dispose(this._shapes);this.__base.FE3dSprite.dispose.call(this)};
MO.FE3dTemplateRenderable=function(a){a=MO.Class.inherits(this,a,MO.FE3dMeshRenderable,MO.MLinkerResource);a._ready=!1;a._model=null;a._materialCode=null;a._materialResource=null;a.construct=MO.FE3dTemplateRenderable_construct;a.testReady=MO.FE3dTemplateRenderable_testReady;a.testVisible=MO.FE3dTemplateRenderable_testVisible;a.calculateOutline=MO.FE3dTemplateRenderable_calculateOutline;a.loadResource=MO.FE3dTemplateRenderable_loadResource;a.reloadResource=MO.FE3dTemplateRenderable_reloadResource;
a.load=MO.FE3dTemplateRenderable_load;a.dispose=MO.FE3dTemplateRenderable_dispose;return a};MO.FE3dTemplateRenderable_construct=function(){this.__base.FE3dMeshRenderable.construct.call(this)};MO.FE3dTemplateRenderable_testReady=function(){if(!this._ready){if(!this._model.testReady())return!1;var a=this._materials;if(a)for(var b=a.count(),d=0;d<b;d++){var e=a.at(d);if(e&&!e.testReady())return!1}this._ready=!0}return this._ready};
MO.FE3dTemplateRenderable_testVisible=function(a){a=!1;this._ready&&(a=this.__base.FE3dMeshRenderable.testVisible.call(this));return a};MO.FE3dTemplateRenderable_calculateOutline=function(a){var b=this._outline;if(b.isEmpty()||a)a=this._resource.mesh().outline(),b.calculateFrom(a,this._currentMatrix);return b};
MO.FE3dTemplateRenderable_loadResource=function(a){this._resource=a;this._matrix.assign(a.matrix());var b=a.modelGuid();this._model=MO.Console.find(MO.FE3rModelConsole).load(this,b);var d=a.materialGuid();MO.Lang.String.isEmpty(d)||(d=this._material=this._materialReference=MO.Console.find(MO.FE3rMaterialConsole).load(this,d),this._materialResource=d.resource(),this.pushMaterial(d));b=this._display._parent;if(a=a.materialRefers())for(var e=a.count(),f=0;f<e;f++)d=a.at(f).guid(),d=b.findMaterial(d),
this.pushMaterial(d),this._material=d;this._material||(this._material=this._materialReference=MO.Class.create(MO.FE3dMaterial))};MO.FE3dTemplateRenderable_reloadResource=function(){var a=this._material;a.calculate(this._materialResource);a.update()};
MO.FE3dTemplateRenderable_load=function(){var a=this._display,b=this._resource,d=b.model(),e=this._material.bitmaps();if(e)for(var f=e.count(),h=0;h<f;h++){var k=e.at(h);this.pushTexture(k)}(h=d.skeletons())&&a.loadSkeletons(h);(h=d.animations())&&a.loadAnimations(h);b.mesh();h=b.meshGuid();b=this._renderable=MO.Console.find(MO.FE3rModelConsole).findMesh(h);d=b.vertexBuffers();e=d.count();for(h=0;h<e;h++)f=d.at(h),this._vertexBuffers.set(f.code(),f);if(h=b.skins()){a=a._activeSkeleton;b=this._activeSkin=
h.first();d=b.streams();e=d.count();for(h=0;h<e;h++)f=d.at(h).buffer(),this._vertexBuffers.set(f.code(),f);b=b.resource().boneRefers();d=b.count();if(0<d)for(e=this._bones=new MO.TObjects,h=0;h<d;h++){f=b.at(h).index();f=a.bones().get(f);if(!f)throw new MO.TError(this,"Bone is not exist.");e.push(f)}}this._ready=!0};MO.FE3dTemplateRenderable_dispose=function(){this.__base.FE3dMeshRenderable.dispose.call(this)};
MO.ME3dBoundaryPolygon=function(a){a=MO.Class.inherits(this,a);a._positionCount=MO.Class.register(a,new MO.AGetter("_positionCount"));a._positions=MO.Class.register(a,new MO.AGetter("_positions"));a._indexCount=MO.Class.register(a,new MO.AGetter("_indexCount"));a._indexes=MO.Class.register(a,new MO.AGetter("_indexes"));a.construct=MO.ME3dBoundaryPolygon_construct;a.dispose=MO.ME3dBoundaryPolygon_dispose;return a};MO.ME3dBoundaryPolygon_construct=function(){};
MO.ME3dBoundaryPolygon_dispose=function(){this._indexes=this._positions=null};MO.ME3dDynamicRenderable=function(a){a=MO.Class.inherits(this,a);a._color=MO.Class.register(a,new MO.AGetter("_color"));a.construct=MO.ME3dDynamicRenderable_construct;a.dispose=MO.ME3dDynamicRenderable_dispose;return a};MO.ME3dDynamicRenderable_construct=function(){this._color=new MO.SColor4(1,1,1,1)};MO.ME3dDynamicRenderable_dispose=function(){this._color=MO.Lang.Object.dispose(this._color)};
MO.SE3dRulerPrecision=function(a){a=this;a.interval=1;a.length=.5;a.color=new MO.SColor4(255,255,255,255);return a};MO.SE3dRulerPrecision_assign=function(a){this.interval.assign(a.interval);this.color.assign(a.color)};MO.SE3dRulerStyle=function(a){a=this;a.lineColor=new MO.SColor4(255,255,255,255);a.bothLength=.5;a.bothColor=new MO.SColor4(255,255,255,255);a.tickInterval=1;a.tickLength=.3;a.tickColor=new MO.SColor4(255,255,255,255);a.precisions=new MO.TObjects;a.assign=MO.SE3dRulerStyle_assign;return a};
MO.SE3dRulerStyle=function(a){this.lineColor.assign(a.lineColor);this.bothLength=a.bothLength;this.bothColor.assign(a.lineColor);this.tickInterval=a.tickInterval;this.tickLength=a.tickLength;this.tickColor.assign(a.lineColor);this.precisions.assign(a.precisions)};MO.FE3dBitmap=function(a){a=MO.Class.inherits(this,a,MO.FE3dFace);a.construct=MO.FE3dBitmap_construct;a.testReady=MO.FE3dBitmap_testReady;a.loadUrl=MO.FE3dBitmap_loadUrl;a.dispose=MO.FE3dBitmap_dispose;return a};MO.FE3dBitmap_construct=function(){this.__base.FE3dFace.construct.call(this)};
MO.FE3dBitmap_testReady=function(){if(!this._ready){var a=this._renderable;if(a){if(this._ready=a.testReady()){var b=a.size(),d=a.adjustSize(),e=this.matrix();e.sz=d.height/b.height;e.updateForce();b=new MO.SEvent(this);this.processLoadListener(b);b.dispose()}this._materialReference=a}}return this._ready};MO.FE3dBitmap_loadUrl=function(a){this._renderable=MO.Console.find(MO.FE3dBitmapConsole).loadDataByUrl(this,a);this._ready=!1};MO.FE3dBitmap_dispose=function(){this.__base.FE3dFace.dispose.call(this)};
MO.FE3dBitmapConsole=function(a){a=MO.Class.inherits(this,a,MO.FConsole);a._scopeCd=MO.EScope.Local;a._bitmaps=MO.Class.register(a,new MO.AGetter("_bitmaps"));a._bitmapDatas=MO.Class.register(a,new MO.AGetter("_bitmapDatas"));a._dataUrl="/cloud.resource.bitmap.wv";a.construct=MO.FE3dBitmapConsole_construct;a.loadByUrl=MO.FE3dBitmapConsole_loadByUrl;a.loadByGuid=MO.FE3dBitmapConsole_loadByGuid;a.loadDataByUrl=MO.FE3dBitmapConsole_loadDataByUrl;a.loadDataByGuid=MO.FE3dBitmapConsole_loadDataByGuid;a.dispose=
MO.FE3dBitmapConsole_dispose;return a};MO.FE3dBitmapConsole_construct=function(){this.__base.FConsole.construct.call(this);this._bitmaps=new MO.TDictionary;this._bitmapDatas=new MO.TDictionary};MO.FE3dBitmapConsole_loadByUrl=function(a,b){var d=this._bitmaps.get(b);if(d)return d;d=MO.Window.Browser.contentPath(b);MO.Logger.info(this,"Load bitmap from url. (url={1})",d);d=MO.Class.create(MO.FE3dBitmap);d.linkGraphicContext(a);d.setup();d.loadUrl(b);this._bitmaps.set(b,d);return d};
MO.FE3dBitmapConsole_loadByGuid=function(a,b){var d=MO.Window.Browser.hostPath(this._dataUrl+"?do=view&guid="+b);return this.loadByUrl(a,d)};MO.FE3dBitmapConsole_loadDataByUrl=function(a,b){var d=MO.Window.Browser.contentPath(b);MO.Logger.info(this,"Load bitmap data from url. (url={1})",d);d=this._bitmapDatas.get(b);d||(d=MO.Class.create(MO.FE3dBitmapData),d.linkGraphicContext(a),d.setup(),d.loadUrl(b),this._bitmapDatas.set(b,d));return d};
MO.FE3dBitmapConsole_loadDataByGuid=function(a,b){var d=MO.Window.Browser.hostPath(this._dataUrl+"?do=view&guid="+b);return this.loadDataByUrl(a,d)};MO.FE3dBitmapConsole_dispose=function(){this._bitmaps=MO.Lang.Object.dispose(this._bitmaps);this._bitmapDatas=MO.Lang.Object.dispose(this._bitmapDatas);this.__base.FConsole.dispose.call(this)};
MO.FE3dBitmapData=function(a){a=MO.Class.inherits(this,a,MO.FE3dFaceData,MO.MListener);a._image=null;a._listenersImageLoad=MO.Class.register(a,new MO.AListener("_listenersImageLoad"));a.onImageLoad=MO.FE3dBitmapData_onImageLoad;a.construct=MO.FE3dBitmapData_construct;a.loadUrl=MO.FE3dBitmapData_loadUrl;a.dispose=MO.FE3dBitmapData_dispose;return a};
MO.FE3dBitmapData_onImageLoad=function(a){a=a.sender;var b=a.size(),d=b.width,b=b.height;this._size.set(d,b);var e=MO.Lang.Integer.pow2(d),f=MO.Lang.Integer.pow2(b);this._adjustSize.set(e,f);var h=this._texture;if(e==d&&f==b)h.upload(a);else{var k=MO.Console.find(MO.FE2dCanvasConsole),e=k.allocBySize(e,f);e.graphicContext().drawImage(a,0,0,d,b);h.upload(e);k.free(e)}a.dispose();this._ready=!0;this.processImageLoadListener(this)};MO.FE3dBitmapData_construct=function(){this.__base.FE3dFaceData.construct.call(this)};
MO.FE3dBitmapData_loadUrl=function(a){var b=MO.Class.create(MO.FImage);b.addLoadListener(this,this.onImageLoad);b.loadUrl(a);this._ready=!1};MO.FE3dBitmapData_dispose=function(){this.__base.FE3dFaceData.dispose.call(this)};
MO.EE3dBoundaryShape=function(a){a=MO.Class.inherits(this,a,MO.FObject,MO.MGraphicObject);a._optionSphere=!1;a._scale=MO.Class.register(a,new MO.AGetter("_scale"),1);a._color=MO.Class.register(a,new MO.AGetter("_color"));a._polygons=MO.Class.register(a,new MO.AGetter("_polygons"));a._faceEffectCode=MO.Class.register(a,new MO.AGetSet("_faceEffectCode"));a._faceRenderable=MO.Class.register(a,new MO.AGetter("_faceRenderable"));a._borderEffectCode=MO.Class.register(a,new MO.AGetSet("_borderEffectCode"));
a._borderRenderable=MO.Class.register(a,new MO.AGetter("_borderRenderable"));a.construct=MO.EE3dBoundaryShape_construct;a.pushPolygon=MO.EE3dBoundaryShape_pushPolygon;a.buildFace=MO.EE3dBoundaryShape_buildFace;a.buildBorder=MO.EE3dBoundaryShape_buildBorder;a.build=MO.EE3dBoundaryShape_build;a.buildFlat=MO.EE3dBoundaryShape_buildFlat;a.buildSphere=MO.EE3dBoundaryShape_buildSphere;a.dispose=MO.EE3dBoundaryShape_dispose;return a};
MO.EE3dBoundaryShape_construct=function(){this.__base.FObject.construct.call(this);this._color=new MO.SColor4(.3,.3,.3);this._polygons=new MO.TObjects};MO.EE3dBoundaryShape_pushPolygon=function(a){this._polygons.push(a)};
MO.EE3dBoundaryShape_buildFace=function(){for(var a=this._graphicContext,b=this._polygons,d=b.count(),e=this._vertexTotal,f=this._indexTotal,h=0,k=0,q=new Float32Array(6*e),w=0,x=new Float32Array(4*e),y=0,f=new Uint32Array(f+6*e),z=0;z<d;z++){for(var A=b.at(z),B=A.positionCount(),D=A.positions(),E=0,C=0;C<B;C++){var F=D[E++],H=D[E++],G=F*MO.Lang.Const.DEGREE_RATE,I=H*MO.Lang.Const.DEGREE_RATE;q[k++]=Math.sin(G)*Math.cos(I)*this._scale;q[k++]=Math.sin(I)*this._scale;q[k++]=-Math.cos(G)*Math.cos(I)*
this._scale;x[w++]=F/360+.5;x[w++]=.5-H/180}A=A.indexes();D=A.length/3;for(C=0;C<D;C++)E=3*C,f[y++]=h+A[E+2],f[y++]=h+A[E+1],f[y++]=h+A[E];h+=B}F=h;for(z=0;z<d;z++)for(A=b.at(z),B=A.positionCount(),D=A.positions(),C=E=0;C<B;C++)G=D[E++]*MO.Lang.Const.DEGREE_RATE,I=D[E++]*MO.Lang.Const.DEGREE_RATE,q[k++]=Math.sin(G)*Math.cos(I)*.9,q[k++]=.9*Math.sin(I),q[k++]=-Math.cos(G)*Math.cos(I)*.9,x[w++]=G,x[w++]=I;for(z=h=0;z<d;z++){A=b.at(z);B=A.positionCount();for(C=0;C<B;C++)C==B-1?(f[y++]=h+C,f[y++]=h+0,
f[y++]=h+C+F,f[y++]=h+0,f[y++]=h+F):(f[y++]=h+C,f[y++]=h+C+1,f[y++]=h+C+F,f[y++]=h+C+1,f[y++]=h+C+F+1),f[y++]=h+C+F;h+=B}d=0;b=this.colorsData=new Uint8Array(8*e);h=2*e;for(C=0;C<h;C++)b[d++]=255,b[d++]=255,b[d++]=255,b[d++]=255;C=this._faceRenderable=MO.Class.create(MO.FE3dDataBox);C._shape=this;C.linkGraphicContext(a);C.setOptionColor(!0);C.setOptionCoord(!0);C.setVertexCount(2*e);C.setup();C.color().setHex("#0a5294");C.vertexPositionBuffer().upload(q,12,2*e,!0);C.vertexColorBuffer().upload(b,4,
2*e,!0);C.vertexCoordBuffer().upload(x,8,2*e,!0);C.indexBuffer().setStrideCd(MO.EG3dIndexStride.Uint32);C.indexBuffer().upload(f,y,!0)};
MO.EE3dBoundaryShape_buildBorder=function(){for(var a=this._graphicContext,b=this._polygons,d=b.count(),e=this._vertexTotal,f=0,h=0,k=new Float32Array(6*e),q=0,w=new Uint32Array(2*e+2*e),x=0;x<d;x++){for(var y=b.at(x),z=y.positionCount(),A=y.positions(),B=0,y=0;y<z;y++){var D=A[B++]/180*Math.PI,E=A[B++]/180*Math.PI;k[h++]=Math.sin(D)*Math.cos(E)*1.001;k[h++]=1.001*Math.sin(E);k[h++]=-Math.cos(D)*Math.cos(E)*1.001}for(y=0;y<z;y++)w[q++]=f+y,y==z-1?w[q++]=f:w[q++]=f+y+1;f+=z}for(var C=f,x=0;x<d;x++){y=
b.at(x);z=y.positionCount();A=y.positions();for(y=B=0;y<z;y++)D=A[B++]/180*Math.PI,E=A[B++]/180*Math.PI,k[h++]=Math.sin(D)*Math.cos(E)*.98,k[h++]=.98*Math.sin(E),k[h++]=-Math.cos(D)*Math.cos(E)*.98;f+=z}for(x=f=0;x<d;x++){y=b.at(x);z=y.positionCount();for(y=0;y<z;y++)w[q++]=f+y,w[q++]=f+y+C;f+=z}d=0;b=this.colorsData=new Uint8Array(8*e);for(y=0;y<e;y++)b[d++]=34,b[d++]=169,b[d++]=255,b[d++]=255;for(y=0;y<e;y++)b[d++]=150,b[d++]=176,b[d++]=214,b[d++]=255;y=this._borderRenderable=MO.Class.create(MO.FE3dDataBox);
y._shape=this;y.linkGraphicContext(a);y.setup();y.setVertexCount(2*e);y.vertexPositionBuffer().upload(k,12,2*e,!0);y.vertexColorBuffer().upload(b,4,2*e,!0);y.indexBuffer().setDrawModeCd(MO.EG3dDrawMode.Lines);y.indexBuffer().setStrideCd(MO.EG3dIndexStride.Uint32);y.indexBuffer().setLineWidth(1);y.indexBuffer().upload(w,q,!0);y.material().info().effectCode="eai.map.face"};
MO.EE3dBoundaryShape_build=function(a){for(var b=0,d=0,e=this._polygons,f=e.count(),h=0;h<f;h++)var k=e.at(h),b=b+k.positionCount(),d=d+k.indexes().length;this._vertexTotal=b;this._indexTotal=d;this.buildFace(a);this.buildBorder(a)};MO.EE3dBoundaryShape_buildFlat=function(a){this._optionSphere=!1;this.build(a)};MO.EE3dBoundaryShape_buildSphere=function(a){this._optionSphere=!0;this.build(a)};MO.EE3dBoundaryShape_dispose=function(){this._polygons=MO.Lang.Obejct.dispose(this._polygons);this.__base.FObject.dispose.call(this)};
MO.FE3dBoundaryShape3d=function(a){a=MO.Class.inherits(this,a,MO.FObject,MO.MGraphicObject);a._optionSphere=!1;a._scaleTop=MO.Class.register(a,new MO.AGetSet("_scaleTop"),1);a._scaleBottom=MO.Class.register(a,new MO.AGetSet("_scaleBottom"),.9);a._faceColor=MO.Class.register(a,new MO.AGetter("_faceColor"));a._color=MO.Class.register(a,new MO.AGetter("_color"));a._polygons=MO.Class.register(a,new MO.AGetter("_polygons"));a._faceEffectCode=MO.Class.register(a,new MO.AGetSet("_faceEffectCode"));a._faceRenderable=
MO.Class.register(a,new MO.AGetter("_faceRenderable"));a._borderEffectCode=MO.Class.register(a,new MO.AGetSet("_borderEffectCode"));a._borderRenderable=MO.Class.register(a,new MO.AGetter("_borderRenderable"));a.construct=MO.FE3dBoundaryShape3d_construct;a.pushPolygon=MO.FE3dBoundaryShape3d_pushPolygon;a.buildFace=MO.FE3dBoundaryShape3d_buildFace;a.buildBorder=MO.FE3dBoundaryShape3d_buildBorder;a.build=MO.FE3dBoundaryShape3d_build;a.buildFlat=MO.FE3dBoundaryShape3d_buildFlat;a.buildSphere=MO.FE3dBoundaryShape3d_buildSphere;
a.dispose=MO.FE3dBoundaryShape3d_dispose;return a};MO.FE3dBoundaryShape3d_construct=function(){this.__base.FObject.construct.call(this);this._faceColor=new MO.SColor4(1,1,1,1);this._color=new MO.SColor4(.3,.3,.3);this._polygons=new MO.TObjects};MO.FE3dBoundaryShape3d_pushPolygon=function(a){this._polygons.push(a)};
MO.FE3dBoundaryShape3d_buildFace=function(){for(var a=this._graphicContext,b=this._faceColor,d=this._scaleTop,e=this._scaleBottom,f=this._polygons,h=f.count(),k=this._vertexTotal,q=this._indexTotal,w=0,x=0,y=new Float32Array(6*k),z=0,A=new Float32Array(4*k),B=0,q=new Uint32Array(q+6*k),D=0;D<h;D++){for(var E=f.at(D),C=E.positionCount(),F=E.positions(),H=0,G=0;G<C;G++){var I=F[H++],L=F[H++],K=I*MO.Lang.Const.DEGREE_RATE,J=L*MO.Lang.Const.DEGREE_RATE;y[x++]=Math.sin(K)*Math.cos(J)*d;y[x++]=Math.sin(J)*
d;y[x++]=-Math.cos(K)*Math.cos(J)*d;A[z++]=I/360+.5;A[z++]=L/180-.5}E=E.indexes();F=E.length/3;for(G=0;G<F;G++)H=3*G,q[B++]=w+E[H+2],q[B++]=w+E[H+1],q[B++]=w+E[H];w+=C}d=w;for(D=0;D<h;D++)for(E=f.at(D),C=E.positionCount(),F=E.positions(),G=H=0;G<C;G++)K=F[H++]*MO.Lang.Const.DEGREE_RATE,J=F[H++]*MO.Lang.Const.DEGREE_RATE,y[x++]=Math.sin(K)*Math.cos(J)*e,y[x++]=Math.sin(J)*e,y[x++]=-Math.cos(K)*Math.cos(J)*e,A[z++]=K,A[z++]=J;for(D=w=0;D<h;D++){E=f.at(D);C=E.positionCount();for(G=0;G<C;G++)G==C-1?(q[B++]=
w+G,q[B++]=w+0,q[B++]=w+G+d,q[B++]=w+0,q[B++]=w+d):(q[B++]=w+G,q[B++]=w+G+1,q[B++]=w+G+d,q[B++]=w+G+1,q[B++]=w+G+d+1),q[B++]=w+G+d;w+=C}f=0;e=this.colorsData=new Uint8Array(8*k);h=2*k;for(G=0;G<h;G++)e[f++]=255*b.red&255,e[f++]=255*b.green&255,e[f++]=255*b.blue&255,e[f++]=255*b.alpha&255;b=this._faceRenderable=MO.Class.create(MO.FE3dDataBox);b._shape=this;b.linkGraphicContext(a);b.setOptionColor(!0);b.setOptionCoord(!0);b.setVertexCount(2*k);b.setup();b.color().setHex("#0A5294");b.vertexPositionBuffer().upload(y,
12,2*k,!0);b.vertexColorBuffer().upload(e,4,2*k,!0);b.vertexCoordBuffer().upload(A,8,2*k,!0);b.indexBuffer().setStrideCd(MO.EG3dIndexStride.Uint32);b.indexBuffer().upload(q,B,!0)};
MO.FE3dBoundaryShape3d_buildBorder=function(){for(var a=this._graphicContext,b=1.001*this._scaleTop,d=this._scaleBottom,e=this._polygons,f=e.count(),h=this._vertexTotal,k=0,q=0,w=new Float32Array(6*h),x=0,y=new Uint32Array(2*h+2*h),z=0;z<f;z++){for(var A=e.at(z),B=A.positionCount(),D=A.positions(),E=0,A=0;A<B;A++){var C=D[E++]/180*Math.PI,F=D[E++]/180*Math.PI;w[q++]=Math.sin(C)*Math.cos(F)*b;w[q++]=Math.sin(F)*b;w[q++]=-Math.cos(C)*Math.cos(F)*b}for(A=0;A<B;A++)y[x++]=k+A,A==B-1?y[x++]=k:y[x++]=k+
A+1;k+=B}b=k;for(z=0;z<f;z++){A=e.at(z);B=A.positionCount();D=A.positions();for(A=E=0;A<B;A++)C=D[E++]/180*Math.PI,F=D[E++]/180*Math.PI,w[q++]=Math.sin(C)*Math.cos(F)*d,w[q++]=Math.sin(F)*d,w[q++]=-Math.cos(C)*Math.cos(F)*d;k+=B}for(z=k=0;z<f;z++){A=e.at(z);B=A.positionCount();for(A=0;A<B;A++)y[x++]=k+A,y[x++]=k+A+b;k+=B}e=0;d=this.colorsData=new Uint8Array(8*h);for(A=0;A<h;A++)d[e++]=34,d[e++]=169,d[e++]=255,d[e++]=255;for(A=0;A<h;A++)d[e++]=150,d[e++]=176,d[e++]=214,d[e++]=255;A=this._borderRenderable=
MO.Class.create(MO.FE3dDataBox);A._shape=this;A.linkGraphicContext(a);A.setup();A.setVertexCount(2*h);A.vertexPositionBuffer().upload(w,12,2*h,!0);A.vertexColorBuffer().upload(d,4,2*h,!0);A.indexBuffer().setDrawModeCd(MO.EG3dDrawMode.Lines);A.indexBuffer().setStrideCd(MO.EG3dIndexStride.Uint32);A.indexBuffer().setLineWidth(1);A.indexBuffer().upload(y,x,!0);A.material().info().effectCode="eai.map.face"};
MO.FE3dBoundaryShape3d_build=function(a){for(var b=0,d=0,e=this._polygons,f=e.count(),h=0;h<f;h++)var k=e.at(h),b=b+k.positionCount(),d=d+k.indexes().length;this._vertexTotal=b;this._indexTotal=d;this.buildFace(a);this.buildBorder(a)};MO.FE3dBoundaryShape3d_buildFlat=function(a){this._optionSphere=!1;this.build(a)};MO.FE3dBoundaryShape3d_buildSphere=function(a){this._optionSphere=!0;this.build(a)};MO.FE3dBoundaryShape3d_dispose=function(){this._polygons=MO.Lang.Obejct.dispose(this._polygons);this.__base.FObject.dispose.call(this)};
MO.FE3dBoundBox=function(a){a=MO.Class.inherits(this,a,MO.FE3dRenderable);a._outline=MO.Class.create(a,new MO.AGetter("_outline"));a._rate=.2;a._vertexPositionBuffer=null;a._vertexColorBuffer=null;a.construct=MO.FE3dBoundBox_construct;a.setup=MO.FE3dBoundBox_setup;a.upload=MO.FE3dBoundBox_upload;return a};MO.FE3dBoundBox_construct=function(){this.__base.FE3dRenderable.construct.call(this);this._material=MO.Class.create(MO.FE3dMaterial);this._outline=new MO.SOutline3};
MO.FE3dBoundBox_setup=function(){var a=this._graphicContext,b=this._vertexPositionBuffer=a.createVertexBuffer();b.setCode("position");b.setFormatCd(MO.EG3dAttributeFormat.Float3);this.pushVertexBuffer(b);for(var d=new Uint8Array(128),b=127;0<=b;b--)d[b]=255;b=this._vertexColorBuffer=a.createVertexBuffer();b.setCode("color");b.setFormatCd(MO.EG3dAttributeFormat.Byte4Normal);b.upload(d,4,32);this.pushVertexBuffer(b);this._vertexCount=32;b=this._indexBuffer=a.createIndexBuffer();b.setDrawModeCd(MO.EG3dDrawMode.Lines);
b.setLineWidth(1);b.upload([0,1,0,4,0,12,3,2,3,5,3,13,8,6,8,9,8,14,11,7,11,10,11,15,20,16,20,21,20,24,23,17,23,22,23,25,28,18,28,26,28,29,31,19,31,27,31,30],48);this.pushIndexBuffer(b);this.update();a=this.material().info();a.effectCode="control";a.ambientColor.set(1,1,1,1)};
MO.FE3dBoundBox_upload=function(){var a=this._outline,b=a.max,d=b.x,e=b.y,b=b.z,f=a.min,a=f.x,h=f.y,f=f.z,k=this._rate,q=(d-a)*k,w=(e-h)*k,k=(b-f)*k;this._vertexPositionBuffer.upload([a,e,f,a+q,e,f,d-q,e,f,d,e,f,a,e-w,f,d,e-w,f,a,h+w,f,d,h+w,f,a,h,f,a+q,h,f,d-q,h,f,d,h,f,a,e,f+k,d,e,f+k,a,h,f+k,d,h,f+k,a,e,b-k,d,e,b-k,a,h,b-k,d,h,b-k,a,e,b,a+q,e,b,d-q,e,b,d,e,b,a,e-w,b,d,e-w,b,a,h+w,b,d,h+w,b,a,h,b,a+q,h,b,d-q,h,b,d,h,b],12,32)};
MO.FE3dCube=function(a){a=MO.Class.inherits(this,a,MO.FE3dRenderable);a.vertexPositionBuffer=null;a.vertexColorBuffer=null;a.indexBuffer=null;a.setup=MO.FE3dCube_setup;return a};
MO.FE3dCube_setup=function(a){var b=this.vertexPositionBuffer=a.createVertexBuffer();b.upload([-1,1,-1,1,1,-1,1,-1,-1,-1,-1,-1,-1,1,1,1,1,1,1,-1,1,-1,-1,1],12,8);this.pushVertexBuffer(b);b=this.vertexColorBuffer=a.createVertexBuffer();b.upload([0,1,0,1,1,0,0,1,1,0,0,1,0,0,0,1,0,1,0,1,1,0,1,1,1,0,1,1,0,0,1,1],16,8);this.pushVertexBuffer(b);b=context.createIndexBuffer();b.upload([0,1,2,0,2,3,1,5,6,1,6,2,5,4,7,5,7,6,4,0,3,4,3,7,0,4,5,0,5,1,3,2,6,3,6,7],36);this.pushIndexBuffer(b);a=this.material().info();
a.effectCode="control";a.ambientColor.set(1,1,1,1)};
MO.FE3dDataBox=function(a){a=MO.Class.inherits(this,a,MO.FE3dRenderable,MO.ME3dDynamicRenderable);a._optionColor=MO.Class.register(a,new MO.AGetSet("_optionColor"),!0);a._optionCoord=MO.Class.register(a,new MO.AGetSet("_optionCoord"),!1);a._optionNormal=MO.Class.register(a,new MO.AGetSet("_optionNormal"),!1);a._vertexPositionBuffer=MO.Class.register(a,new MO.AGetter("_vertexPositionBuffer"));a._vertexColorBuffer=MO.Class.register(a,new MO.AGetter("_vertexColorBuffer"));a._vertexCoordBuffer=MO.Class.register(a,
new MO.AGetter("_vertexCoordBuffer"));a._vertexNormalBuffer=MO.Class.register(a,new MO.AGetter("_vertexNormalBuffer"));a._indexBuffer=MO.Class.register(a,new MO.AGetter("_indexBuffer"));a.construct=MO.FE3dDataBox_construct;a.setup=MO.FE3dDataBox_setup;a.calculateOutline=MO.FE3dDataBox_calculateOutline;a.dispose=MO.FE3dDataBox_dispose;return a};MO.FE3dDataBox_construct=function(){this.__base.FE3dRenderable.construct.call(this);this.__base.ME3dDynamicRenderable.construct.call(this);this._material=MO.Class.create(MO.FE3dMaterial)};
MO.FE3dDataBox_setup=function(a,b,d){a=this._graphicContext;b=this._vertexPositionBuffer=a.createVertexBuffer();b.setCode("position");b.setFormatCd(MO.EG3dAttributeFormat.Float3);this.pushVertexBuffer(b);this._optionColor&&(b=this._vertexColorBuffer=a.createVertexBuffer(),b.setCode("color"),b.setFormatCd(MO.EG3dAttributeFormat.Byte4Normal),this.pushVertexBuffer(b));this._optionCoord&&(b=this._vertexCoordBuffer=a.createVertexBuffer(),b.setCode("coord"),b.setFormatCd(MO.EG3dAttributeFormat.Float2),
this.pushVertexBuffer(b));this._optionNormal&&(b=this._vertexNormalBuffer=a.createVertexBuffer(),b.setCode("normal"),b.setFormatCd(MO.EG3dAttributeFormat.Byte4Normal),this.pushVertexBuffer(b));b=this._indexBuffer=a.createIndexBuffer();this.pushIndexBuffer(b);a=this.material().info();a.effectCode="control";a.ambientColor.set(1,1,1,1)};
MO.FE3dDataBox_calculateOutline=function(){var a=this._outline;if(a.isEmpty()){a.setMin();for(var b=this._vertexCount,d=this._vertexPositionBuffer._data,e=0,f=0;f<b;f++){var h=d[e++],k=d[e++],q=d[e++];a.mergePoint(h,k,q)}a.update()}return a};MO.FE3dDataBox_dispose=function(){this._material=MO.Class.create(MO.FE3dMaterial);this.__base.ME3dDynamicRenderable.dispose.call(this);this.__base.FE3dRenderable.dispose.call(this)};
MO.FE3dDimensional=function(a){a=MO.Class.inherits(this,a,MO.FE3dRenderable);a._cellSize=null;a._size=null;a._lineColor=null;a._lineCenterColor=null;a._vertexPositionBuffer=null;a._vertexColorBuffer=null;a.construct=MO.FE3dDimensional_construct;a.setup=MO.FE3dDimensional_setup;return a};
MO.FE3dDimensional_construct=function(){this.__base.FE3dRenderable.construct.call(this);this._material=MO.Class.create(MO.FE3dMaterial);this._cellSize=new MO.SSize2;this._cellSize.set(1,1);this._size=new MO.SSize2;this._size.set(16,16)};
MO.FE3dDimensional_setup=function(){for(var a=this._graphicContext,b=this._cellSize.width,d=this._cellSize.height,e=this._size.width,f=e/2,h=this._size.height,k=h/2,q=2*(e+2+(h+2)),w=0,x=0,y=new Float32Array(3*q),z=0,A=new Uint8Array(4*q),B=0,D=new Uint16Array(q),E=0;E<=h;E++){var C=1;0==E-k&&(C=0);y[w++]=b*-f*C;y[w++]=0;y[w++]=d*(E-k);y[w++]=b*f*C;y[w++]=0;y[w++]=d*(E-k);for(C=0;8>C;C++)A[z++]=255;D[B++]=x++;D[B++]=x++}y[w++]=b*-f;y[w++]=0;y[w++]=0;y[w++]=b*f;y[w++]=0;for(C=y[w++]=0;2>C;C++)A[z++]=
255,A[z++]=0,A[z++]=0,A[z++]=255;D[B++]=x++;D[B++]=x++;for(h=0;h<=e;h++){C=1;0==h-f&&(C=0);y[w++]=b*(h-f);y[w++]=0;y[w++]=d*-k*C;y[w++]=b*(h-f);y[w++]=0;y[w++]=d*k*C;for(C=0;8>C;C++)A[z++]=255;D[B++]=x++;D[B++]=x++}y[w++]=0;y[w++]=0;y[w++]=d*-k;y[w++]=0;y[w++]=0;y[w++]=d*k;for(C=0;2>C;C++)A[z++]=255,A[z++]=0,A[z++]=0,A[z++]=255;D[B++]=x++;D[B++]=x++;this._vertexCount=q;b=this._vertexPositionBuffer=a.createVertexBuffer();b.setCode("position");b.setFormatCd(MO.EG3dAttributeFormat.Float3);b.upload(y,
12,q);this.pushVertexBuffer(b);b=this._vertexColorBuffer=a.createVertexBuffer();b.setCode("color");b.setFormatCd(MO.EG3dAttributeFormat.Byte4Normal);b.upload(A,4,q);this.pushVertexBuffer(b);b=a.createIndexBuffer();b.setDrawModeCd(MO.EG3dDrawMode.Lines);b.upload(D,q);this.pushIndexBuffer(b);a=this.material().info();a.effectCode="control";a.ambientColor.set(1,1,1,1)};
MO.FE3dDynamicMesh=function(a){a=MO.Class.inherits(this,a,MO.FE3dRenderable);a._shape=MO.Class.register(a,new MO.AGetSet("_shape"));a._optionMerge=!0;a._vertexPosition=0;a._vertexTotal=0;a._indexPosition=0;a._indexTotal=0;a._mergeRenderables=MO.Class.register(a,new MO.AGetter("_mergeRenderables"));a.construct=MO.FE3dDynamicMesh_construct;a.mergeCount=MO.FE3dDynamicMesh_mergeCount;a.mergeMaxCount=MO.FE3dDynamicMesh_mergeMaxCount;a.mergeStride=MO.FE3dDynamicMesh_mergeStride;a.findMergeRenderable=MO.FE3dDynamicMesh_findMergeRenderable;
a.calculateOutline=MO.FE3dDynamicMesh_calculateOutline;a.syncVertexBuffer=MO.FE3dDynamicMesh_syncVertexBuffer;a.mergeRenderable=MO.FE3dDynamicMesh_mergeRenderable;a.mergeVertexBuffer=MO.FE3dDynamicMesh_mergeVertexBuffer;a.mergeIndexBuffer=MO.FE3dDynamicMesh_mergeIndexBuffer;a.build=MO.FE3dDynamicMesh_build;a.dispose=MO.FE3dDynamicMesh_dispose;return a};MO.FE3dDynamicMesh_construct=function(){this.__base.FE3dRenderable.construct.call(this);this._mergeRenderables=new MO.TObjects};
MO.FE3dDynamicMesh_mergeCount=function(){return this._mergeRenderables.count()};MO.FE3dDynamicMesh_mergeMaxCount=function(){return this._shape.mergeMaxCount()};MO.FE3dDynamicMesh_mergeStride=function(){return this._shape.mergeStride()};MO.FE3dDynamicMesh_findMergeRenderable=function(a){return this._mergeRenderables.get(a)};
MO.FE3dDynamicMesh_syncVertexBuffer=function(a){var b=a.code(),d=this._vertexBuffers.get(b);if(!d){var e=a.formatCd(),f=this._vertexTotal,d=this._graphicContext.createVertexBuffer();d.setCode(b);d.setFormatCd(e);d.setStride(a.stride());a=null;switch(e){case MO.EG3dAttributeFormat.Float1:a=new Float32Array(1*f);break;case MO.EG3dAttributeFormat.Float2:a=new Float32Array(2*f);break;case MO.EG3dAttributeFormat.Float3:a=new Float32Array(3*f);break;case MO.EG3dAttributeFormat.Float4:a=new Float32Array(4*
f);break;case MO.EG3dAttributeFormat.Byte4:case MO.EG3dAttributeFormat.Byte4Normal:a=new Uint8Array(4*f);break;default:throw new MO.TError("Unknown code");}d.setData(a);this.pushVertexBuffer(d)}return d};
MO.FE3dDynamicMesh_mergeRenderable=function(a){var b=this._graphicContext.capability(),d=a.vertexCount(),e=a.indexBuffers().first().count(),f=b.mergeCount;if(this._mergeRenderables.count()>=f)return!1;f=this._vertexTotal+d;if(b.optionIndex32){if(f>MO.Lang.Integer.MAX_UINT32)return!1}else if(f>MO.Lang.Integer.MAX_UINT16)return!1;this._vertexTotal+=d;this._indexTotal+=e;this._mergeRenderables.push(a);return!0};
MO.FE3dDynamicMesh_mergeVertexBuffer=function(a){var b=this._vertexPosition,d=a.count(),e=a.formatCd(),f=a.stride(),h=a.data();a=this.syncVertexBuffer(a).data();switch(e){case MO.EG3dAttributeFormat.Float1:case MO.EG3dAttributeFormat.Float2:case MO.EG3dAttributeFormat.Float3:case MO.EG3dAttributeFormat.Float4:MO.Lang.Float.copy(a,f/4*b,h,0,f/4*d);break;case MO.EG3dAttributeFormat.Byte4:case MO.EG3dAttributeFormat.Byte4Normal:MO.Lang.Byte.copy(a,f*b,h,0,f*d);break;default:throw new MO.TError("Unknown code");
}};MO.FE3dDynamicMesh_mergeIndexBuffer=function(a){var b=this._vertexPosition,d=this._indexPosition,e=a.drawModeCd(),f=a.data(),h=this._indexBuffer.data();a=a.count();for(var k=0;k<a;k++)h[d++]=b+f[k];this._indexBuffer.setDrawModeCd(e)};
MO.FE3dDynamicMesh_build=function(){var a=this._graphicContext,b=a.capability(),d=this._vertexTotal,e=this._indexTotal,f=this._mergeRenderables,h=f.count(),k=f.first();this._material=k.material();this._textures=k.textures();var q=new Float32Array(d),w=this._instanceVertexBuffer=a.createVertexBuffer();w.setCode("instance");w.setStride(4);w.setFormatCd(MO.EG3dAttributeFormat.Float1);w.setData(q);this.pushVertexBuffer(w);w=new Float32Array(4*d);k=this._indexVertexBuffer=a.createVertexBuffer();k.setCode("index");
k.setStride(16);k.setFormatCd(MO.EG3dAttributeFormat.Float4);k.setData(w);this.pushVertexBuffer(k);a=this._indexBuffer=a.createIndexBuffer(MO.FE3rIndexBuffer);b.optionIndex32?(a.setStrideCd(MO.EG3dIndexStride.Uint32),a.setData(new Uint32Array(e))):(a.setStrideCd(MO.EG3dIndexStride.Uint16),a.setData(new Uint16Array(e)));a.setCount(e);this.pushIndexBuffer(a);for(var x=b=0;x<h;x++){var k=f.at(x),y=k.vertexCount();MO.Lang.Float.fill(q,this._vertexPosition,y,x);for(var z=x+1,A=(z&255)/255,B=(z>>8&255)/
255,D=(z>>16&255)/255,z=0;z<y;z++)w[b++]=A,w[b++]=B,w[b++]=D,w[b++]=1;A=k.vertexBuffers();B=A.count();for(z=0;z<B;z++)D=A.at(z),this.mergeVertexBuffer(D);k=k.indexBuffers().first();z=k.count();this.mergeIndexBuffer(k);this._vertexPosition+=y;this._indexPosition+=z}A=this._vertexBuffers;B=A.count();for(z=0;z<B;z++)D=A.at(z),f=D.data(),h=D.stride(),D.upload(f,h,d),D.setData(null);d=a.data();a.upload(d,e);a.setData(null)};
MO.FE3dDynamicMesh_calculateOutline=function(){var a=this._outline;if(a.isEmpty()){a.setMin();var b=this._mergeRenderables;if(b)for(var d=b.count(),e=0;e<d;e++){var f=b.at(e).calculateOutline();a.mergeMax(f)}}return a};MO.FE3dDynamicMesh_dispose=function(){this._mergeRenderables=MO.Lang.Object.dispose(this._mergeRenderables);this.__base.FE3dRenderable.dispose.call(this)};
MO.FE3dDynamicShape=function(a){a=MO.Class.inherits(this,a,MO.FE3dDisplay);a._mergeMaxCount=MO.Class.register(a,new MO.AGetter("_mergeMaxCount"));a._mergeStride=MO.Class.register(a,new MO.AGetter("_mergeStride"),4);a._sourceRenderables=MO.Class.register(a,new MO.AGetter("_sourceRenderables"));a._meshes=MO.Class.register(a,new MO.AGetter("_meshes"));a.construct=MO.FE3dDynamicShape_construct;a.createMesh=MO.FE3dDynamicShape_createMesh;a.pushMergeRenderable=MO.FE3dDynamicShape_pushMergeRenderable;a.build=
MO.FE3dDynamicShape_build;a.dispose=MO.FE3dDynamicShape_dispose;return a};MO.FE3dDynamicShape_construct=function(){this.__base.FE3dDisplay.construct.call(this);this._sourceRenderables=new MO.TObjects;this._meshes=new MO.TObjects;this._material=MO.Class.create(MO.FE3dMaterial)};MO.FE3dDynamicShape_createMesh=function(){var a=MO.Class.create(MO.FE3dDynamicMesh);a._shape=this;a.linkGraphicContext(this);a.setShape(this);this._meshes.push(a);this.pushRenderable(a);return a};
MO.FE3dDynamicShape_pushMergeRenderable=function(a){this._sourceRenderables.push(a)};MO.FE3dDynamicShape_build=function(){var a=this._sourceRenderables,b=this.renderables(),d=a.count();if(0<d)for(var e=this.createMesh(),f=0;f<d;f++){var h=a.at(f);if(!e.mergeRenderable(h)&&(e=this.createMesh(),!e.mergeRenderable(h)))throw new MO.TError(this,"Merge renderable failure.");}a=0;d=b.count();for(f=0;f<d;f++)e=b.at(f),e.build(),a=Math.max(a,e.mergeCount());this._mergeMaxCount=a};
MO.FE3dDynamicShape_dispose=function(){this._sourceRenderables=MO.Lang.Object.dispose(this._sourceRenderables);this._meshes=MO.Lang.Object.dispose(this._meshes);this.__base.FE3dDisplay.dispose.call(this)};
MO.FE3dFace=function(a){a=MO.Class.inherits(this,a,MO.FE3dMeshRenderable,MO.MListener);a._ready=!1;a._size=MO.Class.register(a,new MO.AGetter("_size"));a._loadListeners=MO.Class.register(a,new MO.AListener("_loadListeners",MO.EEvent.Load));a._statusDirty=!0;a.construct=MO.FE3dFace_construct;a.setSize=MO.FE3dFace_setSize;a.setData=MO.FE3dFace_setData;a.findVertexBuffer=MO.FE3dFace_findVertexBuffer;a.vertexBuffers=MO.FE3dFace_vertexBuffers;a.findTexture=MO.FE3dFace_findTexture;a.textures=MO.FE3dFace_textures;
a.material=MO.FE3dFace_material;a.dirty=MO.FE3dFace_dirty;a.processLoad=MO.FE3dFace_processLoad;a.process=MO.FE3dFace_process;a.dispose=MO.FE3dFace_dispose;return a};MO.FE3dFace_construct=function(){this.__base.FE3dMeshRenderable.construct.call(this);this._size=new MO.SSize2};MO.FE3dFace_setSize=function(a,b){this._size.set(a,b);this._matrix.setScale(a,b,1)};MO.FE3dFace_setData=function(a){this._renderable=a};MO.FE3dFace_findVertexBuffer=function(a){return this._renderable.findVertexBuffer(a)};
MO.FE3dFace_vertexBuffers=function(){return this._renderable.vertexBuffers()};MO.FE3dFace_findTexture=function(a){return this._renderable.findTexture(a)};MO.FE3dFace_textures=function(){return this._renderable.textures()};MO.FE3dFace_material=function(){return this._renderable.material()};MO.FE3dFace_dirty=function(){this._statusDirty=!0};MO.FE3dFace_processLoad=function(){return!0};MO.FE3dFace_process=function(){this.__base.FE3dMeshRenderable.process.call(this)};
MO.FE3dFace_dispose=function(){this._material=RObject.dispoe(this._material);this.__base.FE3dMeshRenderable.dispose.call(this)};
MO.FE3dFaceData=function(a){a=MO.Class.inherits(this,a,MO.FE3dRenderable);a._ready=!1;a._optionCenter=MO.Class.register(a,new MO.AGetSet("_optionCenter"),!1);a._size=MO.Class.register(a,new MO.AGetter("_size"));a._adjustSize=MO.Class.register(a,new MO.AGetter("_adjustSize"));a._vertexPositionBuffer=null;a._vertexCoordBuffer=null;a._indexBuffer=null;a._texture=null;a.construct=MO.FE3dFaceData_construct;a.testReady=MO.FE3dFaceData_testReady;a.setup=MO.FE3dFaceData_setup;a.dispose=MO.FE3dFaceData_dispose;
return a};MO.FE3dFaceData_construct=function(){this.__base.FE3dRenderable.construct.call(this);this._size=new MO.SSize2;this._adjustSize=new MO.SSize2;this._material=MO.Class.create(MO.FE3dMaterial)};MO.FE3dFaceData_testReady=function(){return this._ready};
MO.FE3dFaceData_setup=function(){var a=this._graphicContext;this._vertexCount=4;var b=null,b=this._optionCenter?[-1,1,0,1,1,0,1,-1,0,-1,-1,0]:[0,0,0,1,0,0,1,-1,0,0,-1,0],d=this._vertexPositionBuffer=a.createVertexBuffer();d.setCode("position");d.setFormatCd(MO.EG3dAttributeFormat.Float3);d.upload(b,12,4);var e=MO.Class.create(MO.FE3sStream);e.setCode("position");e.setDataCount(4);e.setData(b);d._resource=e;this.pushVertexBuffer(d);b=[0,1,1,1,1,0,0,0];d=this._vertexCoordBuffer=a.createVertexBuffer();
d.setCode("coord");d.setFormatCd(MO.EG3dAttributeFormat.Float2);d.upload(b,8,4);e=MO.Class.create(MO.FE3sStream);e.setCode("coord");e.setDataCount(4);e.setData(b);d._resource=e;this.pushVertexBuffer(d);b=[0,1,2,0,2,3];d=this._indexBuffer=a.createIndexBuffer();d.upload(b,6);e=MO.Class.create(MO.FE3sStream);e.setCode("index16");e.setDataCount(2);e.setData(b);d._resource=e;this.pushIndexBuffer(d);a=this._texture=a.createFlatTexture();a.setOptionFlipY(!0);a.setWrapCd(MO.EG3dSamplerFilter.ClampToEdge,
MO.EG3dSamplerFilter.ClampToEdge);this.pushTexture(a,"diffuse");this._material.info().optionDouble=!0;this._material._textures=this._textures};
MO.FE3dFaceData_dispose=function(){this._size=MO.Lang.Object.dispose(this._size);this._adjustSize=MO.Lang.Object.dispose(this._adjustSize);this._texture=MO.Lang.Object.dispose(this._texture);this._vertexPositionBuffer=MO.Lang.Object.dispose(this._vertexPositionBuffer);this._vertexCoordBuffer=MO.Lang.Object.dispose(this._vertexCoordBuffer);this._indexBuffer=MO.Lang.Object.dispose(this._indexBuffer);this.__base.FE3dRenderable.dispose.call(this)};
MO.FE3dPolygon=function(a){return a=MO.Class.inherits(this,a,MO.FE3dRenderable)};MO.FE3dRectangle=function(a){a=MO.Class.inherits(this,a,MO.FE3dRenderable);a._vertexPositionBuffer=null;a._vertexColorBuffer=null;a._indexBuffer=MO.Class.register(a,new MO.AGetter("_indexBuffer"));a.construct=MO.FE3dRectangle_construct;a.setup=MO.FE3dRectangle_setup;return a};MO.FE3dRectangle_construct=function(){this.__base.FE3dRenderable.construct.call(this);this._material=MO.Class.create(MO.FE3dMaterial)};
MO.FE3dRectangle_setup=function(){var a=this._graphicContext,b=this._vertexPositionBuffer=a.createVertexBuffer();b.setCode("position");b.setFormatCd(MO.EG3dAttributeFormat.Float3);b.upload([-1,1,0,.5,.5,0,.5,-.5,0,-.5,-.5,0],8,4);this.pushVertexBuffer(b);b=this._vertexCoordBuffer=a.createVertexBuffer();b.setCode("coord");b.setFormatCd(MO.EG3dAttributeFormat.Float2);b.upload([0,1,1,1,1,0,0,0],8,4);this.pushVertexBuffer(b);b=this._indexBuffer=a.createIndexBuffer();b.upload([0,1,2,0,2,3],6);this.pushIndexBuffer(b);
this._textures=new MO.TDictionary;this._material.info().optionDouble=!0};MO.FE3dRectangleArea=function(a){a=MO.Class.inherits(this,a,MO.FE3dRenderable);a._vertexPositionBuffer=null;a._vertexColorBuffer=null;a._indexBuffer=MO.Class.register(a,new MO.AGetter("_indexBuffer"));a.construct=MO.FE3dRectangleArea_construct;a.setup=MO.FE3dRectangleArea_setup;return a};MO.FE3dRectangleArea_construct=function(){this.__base.FE3dRenderable.construct.call(this);this._material=MO.Class.create(MO.FE3dMaterial)};
MO.FE3dRectangleArea_setup=function(){var a=this._graphicContext,b=this._vertexPositionBuffer=a.createVertexBuffer();b.setCode("position");b.setFormatCd(MO.EG3dAttributeFormat.Float2);b.upload([-1,1,1,1,1,-1,-1,-1],8,4);this.pushVertexBuffer(b);b=this._vertexCoordBuffer=a.createVertexBuffer();b.setCode("coord");b.setFormatCd(MO.EG3dAttributeFormat.Float2);b.upload([0,1,1,1,1,0,0,0],8,4);this.pushVertexBuffer(b);b=this._indexBuffer=a.createIndexBuffer();b.upload([0,1,2,0,2,3],6);this.pushIndexBuffer(b);
this._textures=new MO.TDictionary;this._material.info().optionDouble=!0};
MO.FE3dRuler=function(a){a=MO.Class.inherits(this,a,MO.FE3dRenderable);a._style=MO.Class.register(a,new MO.AGetter("_style"));a._beginPoint=MO.Class.register(a,new MO.AGetter("_beginPoint"));a._endPoint=MO.Class.register(a,new MO.AGetter("_endPoint"));a._direction=MO.Class.register(a,new MO.AGetter("_direction"));a._directionLine=null;a._vertexPositionBuffer=null;a._vertexColorBuffer=null;a._vertexPositionData=null;a._vertexColorData=null;a._indexData=null;a.construct=MO.FE3dRuler_construct;a.setup=
MO.FE3dRuler_setup;a.upload=MO.FE3dRuler_upload;return a};MO.FE3dRuler_construct=function(){this.__base.FE3dRenderable.construct.call(this);this._material=MO.Class.create(MO.FE3dMaterial);this._style=new MO.SE3dRulerStyle;this._beginPoint=new MO.SPoint3(0,0,0);this._endPoint=new MO.SPoint3(0,10,0);this._direction=new MO.SVector3(1,0,0);this._directionLine=new MO.SVector3;this._vertexPositionData=new MO.TArray;this._vertexColorData=new MO.TArray;this._indexData=new MO.TArray};
MO.FE3dRuler_setup=function(){var a=this._graphicContext,b=this._vertexPositionBuffer=a.createVertexBuffer();b.setCode("position");b.setFormatCd(MO.EG3dAttributeFormat.Float3);this.pushVertexBuffer(b);b=this._vertexColorBuffer=a.createVertexBuffer();b.setCode("color");b.setFormatCd(MO.EG3dAttributeFormat.Byte4Normal);this.pushVertexBuffer(b);a=this._indexBuffer=a.createIndexBuffer();a.setFillModeCd(MO.EG3dFillMode.Line);a.setLineWidth(1);this.pushIndexBuffer(a);this.upload();this.update();a=this.material().info();
a.effectCode="control";a.ambientColor.set(1,1,1,1)};
MO.FE3dRuler_upload=function(){var a=0,b=this._style,d=this._vertexPositionData;d.clear();var e=this._vertexColorData;e.clear();var f=this._indexData;f.clear();var h=this._beginPoint,k=this._endPoint;d.push(h.x,h.y,h.z);e.push(255,255,255,255);a++;d.push(k.x,k.y,k.z);e.push(255,255,255,255);a++;f.push(0,1);var q=b.bothLength,w=b.bothColor,x=this._direction,y=new SPoint3,z=new SPoint3;d.push(h.x,h.y,h.z);e.push(w.red,w.green,w.blue,w.alpha);z.x=x.x*q+h.x;z.y=x.y*q+h.y;z.z=x.z*q+h.z;d.push(z.x,z.y,
z.z);e.push(w.red,w.green,w.blue,w.alpha);f.push(a,a+1);a+=2;d.push(k.x,k.y,k.z);e.push(w.red,w.green,w.blue,w.alpha);z.x=x.x*q+k.x;z.y=x.y*q+k.y;z.z=x.z*q+k.z;d.push(z.x,z.y,z.z);e.push(w.red,w.green,w.blue,w.alpha);f.push(a,a+1);a+=2;k=this._directionLine.direction(h,this._endPoint);q=k.length();k.normalize();for(var b=b.precisions,w=b.count(),A=0;A<w;A++)for(var B=b.at(A),D=B.interval,E=B.length,B=B.color,C=D;C<q;C+=D)y.x=k.x*C+h.x,y.y=k.y*C+h.y,y.z=k.z*C+h.z,d.push(y.x,y.y,y.z),e.push(B.red,B.green,
B.blue,B.alpha),z.x=x.x*E+y.x,z.y=x.y*E+y.y,z.z=x.z*E+y.z,d.push(z.x,z.y,z.z),e.push(B.red,B.green,B.blue,B.alpha),f.push(a,a+1),a+=2;this._vertexPositionBuffer.upload(d.memory(),12,a);this._vertexColorBuffer.upload(e.memory(),4,a);indexBuffer.upload(f.memory(),f.length())};
MO.FE3dRulerBox=function(a){a=MO.Class.inherits(this,a,MO.FE3dSprite);a._outline=MO.Class.register(a,new MO.AGetter("_outline"));a._style=MO.Class.register(a,new MO.AGetter("_style"));a._rulerX=null;a._rulerY=null;a._rulerZ=null;a.construct=MO.FE3dRulerBox_construct;a.setup=MO.FE3dRulerBox_setup;a.upload=MO.FE3dRulerBox_upload;return a};
MO.FE3dRulerBox_construct=function(){this.__base.FE3dSprite.construct.call(this);this._material=MO.Class.create(MO.FE3dMaterial);this._style=new SE3dRulerStyle;this._outline=new MO.SOutline3;var a=this._rulerX=MO.Class.create(MO.FE3dRuler);this.pushRenderable(a);a=this._rulerY=MO.Class.create(MO.FE3dRuler);this.pushRenderable(a);a=this._rulerZ=MO.Class.create(MO.FE3dRuler);this.pushRenderable(a)};
MO.FE3dRulerBox_setup=function(){var a=this._graphicContext,b=this._style;this.matrix().setScaleAll(.1);this.matrix().update();var d=this._outline,e=d.min,d=d.max,f=this._rulerX;f.linkGraphicContext(a);f.style().assign(b);f.beginPoint().assign(e);f.endPoint().set(d.x,e.y,e.z);f.direction().set(0,0,-1);f.setup();f=this._rulerY;f.linkGraphicContext(a);f.style().assign(b);f.beginPoint().assign(e);f.endPoint().set(e.x,d.y,e.z);f.direction().set(-1,0,0);f.setup();f=this._rulerZ;f.linkGraphicContext(a);
f.style().assign(b);f.beginPoint().assign(e);f.endPoint().set(e.x,e.y,d.z);f.direction().set(-1,0,0);f.setup()};MO.FE3dRulerBox_upload=function(){this._rulerX.upload();this._rulerY.upload();this._rulerZ.upload()};MO.FE3dShape=function(a){a=MO.Class.inherits(this,a,MO.FE3dFace);a._ready=!0;a.construct=MO.FE3dShape_construct;a.dispose=MO.FE3dShape_dispose;return a};MO.FE3dShape_construct=function(){this.__base.FE3dFace.construct.call(this)};MO.FE3dShape_dispose=function(){this.__base.FE3dFace.dispose.call(this)};
MO.FE3dShapeConsole=function(a){a=MO.Class.inherits(this,a,MO.FConsole);a._scopeCd=MO.EScope.Local;a._bitmaps=MO.Class.register(a,new MO.AGetter("_bitmaps"));a.construct=MO.FE3dShapeConsole_construct;a.load=MO.FE3dShapeConsole_load;a.loadUrl=MO.FE3dShapeConsole_loadUrl;return a};MO.FE3dShapeConsole_construct=function(){this.__base.FConsole.construct.call(this);this._bitmaps=new MO.TDictionary};
MO.FE3dShapeConsole_load=function(a,b,d){var e=b+"|"+d,f=this._bitmaps.get(e);if(f)return f;b=MO.Window.Browser.hostPath(this._dataUrl+"?guid="+b+"&code="+d);MO.Logger.info(this,"Load bitmap. (url={1})",b);f="environment"==d?MO.Class.create(MO.FE3rBitmapCubePack):MO.Class.create(MO.FE3rBitmapFlatPack);f.linkGraphicContext(a);f.loadUrl(b);this._bitmaps.set(e,f);return f};
MO.FE3dShapeConsole_loadUrl=function(a,b){var d=this._bitmaps.get(b);if(d)return d;d=MO.Window.Browser.contentPath(b);MO.Logger.info(this,"Load bitmap from url. (url={1})",d);d=MO.Class.create(MO.FE3dBitmapData);d.linkGraphicContext(a);d.setup();d.loadUrl(b);this._bitmaps.set(b,d);return d};
MO.FE3dShapeData=function(a){a=MO.Class.inherits(this,a,MO.FE3dFaceData);a._graphic=null;a._texture=null;a.construct=MO.FE3dShapeData_construct;a.beginDraw=MO.FE3dShapeData_beginDraw;a.endDraw=MO.FE3dShapeData_endDraw;a.dispose=MO.FE3dShapeData_dispose;return a};MO.FE3dShapeData_construct=function(){this.__base.FE3dFaceData.construct.call(this)};
MO.FE3dShapeData_beginDraw=function(){var a=this._size,b=MO.Lang.Integer.pow2(a.width),a=MO.Lang.Integer.pow2(a.height);this._adjustSize.set(b,a);return this._graphic=(this._canvas=MO.Console.find(FE2dCanvasConsole).allocBySize(b,a)).context()};MO.FE3dShapeData_endDraw=function(){this._texture.upload(this._canvas);MO.Console.find(MO.FE2dCanvasConsole).free(this._canvas);this._graphic=this._canvas=null;this._ready=!0};MO.FE3dShapeData_dispose=function(){this.__base.FE3dFaceData.dispose.call(this)};
MO.FE3dSphere=function(a){a=MO.Class.inherits(this,a,MO.FE3dRenderable);a._outline=null;a._splitCount=MO.Class.register(a,new MO.AGetSet("_splitCount"),8);a._vertexPositionBuffer=null;a._vertexColorBuffer=null;a.construct=MO.FE3dSphere_construct;a.setup=MO.FE3dSphere_setup;return a};MO.FE3dSphere_construct=function(){this.__base.FE3dRenderable.construct.call(this);this._material=MO.Class.create(MO.FE3dMaterial);this._outline=new MO.SOutline3};
MO.FE3dSphere_setup=function(){for(var a=this._graphicContext,b=new MO.TArray,d=new MO.TArray,e=2*this._splitCount,f=this._splitCount,h=2*Math.PI/e,k=Math.PI/f,q=0,w=0;w<=f;w++)for(var x=0;x<e;x++){var y=h*x-Math.PI,z=k*w-MO.RConst.PI_2,A=Math.sin(y)*Math.cos(z),B=Math.sin(z),y=-Math.cos(y)*Math.cos(z);b.push(A,B,y);d.push(A,B,y);q++}this._vertexCount=q;w=this._vertexPositionBuffer=a.createVertexBuffer();w.setCode("position");w.setFormatCd(MO.EG3dAttributeFormat.Float3);w.upload(new Float32Array(b.memory()),
12,q);this.pushVertexBuffer(w);w=this._vertexColorBuffer=a.createVertexBuffer();w.setCode("normal");w.setFormatCd(MO.EG3dAttributeFormat.Float3);w.upload(new Float32Array(d.memory()),12,q);this.pushVertexBuffer(w);b=new MO.TArray;for(w=0;w<f;w++)for(x=0;x<e;x++)d=e*w,q=d+x,h=d+x+e,x==e-1?(b.push(q,h,d),b.push(h,d+e,d)):(b.push(q,h,q+1),b.push(h,h+1,q+1));w=a.createIndexBuffer();w.upload(new Uint16Array(b.memory()),b.length());this.pushIndexBuffer(w);this.update();a=this.material().info();a.ambientColor.set(.2,
.2,.2,1);a.diffuseColor.set(.8,.8,.8,1);a.specularColor.set(.8,.8,.8,1);a.specularLevel=64};MO.FE3dVideo=function(a){a=MO.Class.inherits(this,a,MO.FE3dFace);a.construct=MO.FE3dVideo_construct;a.testReady=MO.FE3dVideo_testReady;a.loadUrl=MO.FE3dVideo_loadUrl;a.dispose=MO.FE3dVideo_dispose;return a};MO.FE3dVideo_construct=function(){this.__base.FE3dFace.construct.call(this)};
MO.FE3dVideo_testReady=function(){if(!this._ready){var a=this._renderable;if(a){if(this._ready=a.testReady()){var b=new SEvent(this);this.processLoadListener(b);b.dispose()}this._materialReference=a}}return this._ready};MO.FE3dVideo_loadUrl=function(a){var b=this._graphicContext;this._renderable=MO.Console.find(MO.FE3dVideoConsole).loadUrl(b,a);this._ready=!1};MO.FE3dVideo_dispose=function(){this.__base.FE3dFace.dispose.call(this)};
MO.FE3dVideoConsole=function(a){a=MO.Class.inherits(this,a,MO.FConsole);a._scopeCd=MO.EScope.Local;a._videos=null;a._dataUrl="/cloud.resource.bitmap.wv";a.construct=MO.FE3dVideoConsole_construct;a.videos=MO.FE3dVideoConsole_videos;a.load=MO.FE3dVideoConsole_load;a.loadUrl=MO.FE3dVideoConsole_loadUrl;return a};MO.FE3dVideoConsole_construct=function(){this.__base.FConsole.construct.call(this);this._videos=new MO.TDictionary};MO.FE3dVideoConsole_videos=function(){return this._videos};
MO.FE3dVideoConsole_load=function(a,b,d){var e=b+"|"+d,f=this._videos.get(e);if(f)return f;b=MO.Window.Browser.hostPath(this._dataUrl+"?guid="+b+"&code="+d);MO.Logger.info(this,"Load bitmap. (url={1})",b);f="environment"==d?MO.Class.create(MO.FE3rBitmapCubePack):MO.Class.create(MO.FE3rBitmapFlatPack);f.linkGraphicContext(a);f.loadUrl(b);this._videos.set(e,f);return f};
MO.FE3dVideoConsole_loadUrl=function(a,b){var d=this._videos.get(b);if(d)return d;d=MO.Window.Browser.contentPath(b);MO.Logger.info(this,"Load bitmap from url. (url={1})",d);d=MO.Class.create(MO.FE3dVideoData);d.linkGraphicContext(a);d.setup();d.loadUrl(b);this._videos.set(b,d);return d};
MO.FE3dVideoData=function(a){a=MO.Class.inherits(this,a,MO.FE3dFaceData);a._hVideo=null;a.ohVideoLoad=MO.FE3dVideoData_ohVideoLoad;a.ohVideoEnded=MO.FE3dVideoData_ohVideoEnded;a.construct=MO.FE3dVideoData_construct;a.loadUrl=MO.FE3dVideoData_loadUrl;a.process=MO.FE3dVideoData_process;a.dispose=MO.FE3dVideoData_dispose;return a};MO.FE3dVideoData_ohVideoLoad=function(a){this.__linker._ready=!0};MO.FE3dVideoData_ohVideoEnded=function(){};MO.FE3dVideoData_construct=function(){this.__base.FE3dFaceData.construct.call(this)};
MO.FE3dVideoData_loadUrl=function(a){var b=this._hVideo=document.createElement("VIDEO");b.__linker=this;b.autoplay=!0;b.loop=!0;b.src=a;b.addEventListener("canplay",this.ohVideoLoad);b.load();this._ready=!1};MO.FE3dVideoData_process=function(){this._ready&&this._texture.upload(this._hVideo)};MO.FE3dVideoData_dispose=function(){this._hVideo=null;this.__base.FE3dFaceData.dispose.call(this)};
MO.FE3dFireworksParticle=function(a){a=MO.Class.inherits(this,a,MO.FE3dParticle);a._angle=MO.Class.register(a,new MO.AGetSet("_angle"),0);a._itemCount=MO.Class.register(a,new MO.AGetSet("_itemCount"),0);a._itemDelay=MO.Class.register(a,new MO.AGetSet("_itemDelay"),0);a._itemColor=MO.Class.register(a,new MO.AGetter("_itemColor"));a._itemPosition=MO.Class.register(a,new MO.AGetter("_itemPosition"));a._itemRotation=MO.Class.register(a,new MO.AGetter("_itemRotation"));a._itemScale=MO.Class.register(a,
new MO.AGetter("_itemScale"));a._itemSpeed=MO.Class.register(a,new MO.AGetSet("_itemSpeed"),0);a._itemAcceleration=MO.Class.register(a,new MO.AGetSet("_itemAcceleration"));a._itemAttenuation=MO.Class.register(a,new MO.AGetSet("_itemAttenuation"),0);a._itemSplittingNumber=MO.Class.register(a,new MO.AGetSet("_itemSplittingNumber"),0);a._vertexPositionBuffer=null;a._vertexCoordBuffer=null;a._indexBuffer=null;a.construct=MO.FE3dFireworksParticle_construct;a.setup=MO.FE3dFireworksParticle_setup;a.testInRange=
MO.FE3dFireworksParticle_testInRange;a.start=MO.FE3dFireworksParticle_start;a.dispose=MO.FE3dFireworksParticle_dispose;return a};MO.FE3dFireworksParticle_construct=function(){this.__base.FE3dParticle.construct.call(this);this._itemColor=new MO.SColor4(1,1,1,1);this._itemPosition=new MO.SPoint3(0,0,0);this._itemRotation=new MO.SVector3(0,0,0);this._itemScale=new MO.SVector3(1,1,1);this._itemAcceleration=new MO.SVector3(0,0,0)};MO.FE3dFireworksParticle_setup=function(){this.__base.FE3dParticle.setup.call(this)};
MO.FE3dFireworksParticle_testInRange=function(a,b){var d=parseInt((a+17)/20*220),d=4*(360*(60-parseInt(6*(b+3)))+d),e=this._data.data;if(0<=d&&d<e.length)var f=e[d];return 0<f};
MO.FE3dFireworksParticle_start=function(){for(var a=MO.Console.find(MO.FE3dParticleConsole),b=this._itemCount,d=2*Math.PI/b,e=0;e<b;e++){var f=this._angle+d*e,h=a.itemAlloc(MO.FE3dFireworksParticleItem);h.setParticle(this);h.setDelay(this._itemDelay);h.position().assign(this._itemPosition);h.direction().set(Math.sin(f),Math.cos(f),0);h.scale().assign(this._itemScale);h.color().assign(this._itemColor);h.setSpeed(this._itemSpeed);h.acceleration().assign(this._itemAcceleration);h.setAttenuation(this._itemAttenuation);
h.setSplittingDistance(3+Math.random());h.setSplittingNumber(this._itemSplittingNumber);h.start();this.pushItem(h)}};MO.FE3dFireworksParticle_dispose=function(){this._itemColor=MO.Lang.Object.dispose(this._itemColor);this._itemPosition=MO.Lang.Object.dispose(this._itemPosition);this._itemRotation=MO.Lang.Object.dispose(this._itemRotation);this._itemScale=MO.Lang.Object.dispose(this._itemScale);this._itemAcceleration=MO.Lang.Object.dispose(this._itemAcceleration);this.__base.FE3dParticle.dispose.call(this)};
MO.FE3dFireworksParticleItem=function(a){a=MO.Class.inherits(this,a,MO.FE3dParticleItem);a._priorPosition=MO.Class.register(a,new MO.AGetter("_priorPosition"));a._direction=MO.Class.register(a,new MO.AGetter("_direction"));a._speed=MO.Class.register(a,new MO.AGetSet("_speed"),0);a._acceleration=MO.Class.register(a,new MO.AGetter("_acceleration"));a._attenuation=MO.Class.register(a,new MO.AGetSet("_attenuation"),0);a._splittingDistance=MO.Class.register(a,new MO.AGetSet("_splittingDistance"),1);a._splittingNumber=
MO.Class.register(a,new MO.AGetSet("_splittingNumber"),0);a._currentDistance=null;a._currentSpeed=null;a._currentDirection=null;a._statusInRange=!1;a._storeSpeed=null;a.construct=MO.FE3dFireworksParticleItem_construct;a.start=MO.FE3dFireworksParticleItem_start;a.processSplit=MO.FE3dFireworksParticleItem_processSplit;a.processFrame=MO.FE3dFireworksParticleItem_processFrame;a.dispose=MO.FE3dFireworksParticleItem_dispose;return a};
MO.FE3dFireworksParticleItem_construct=function(){this.__base.FE3dParticleItem.construct.call(this);this._priorPosition=new MO.SPoint3;this._direction=new MO.SVector3;this._acceleration=new MO.SVector3;this._currentSpeed=new MO.SVector3;this._currentDirection=new MO.SVector3;this._storeSpeed=new MO.SVector3};
MO.FE3dFireworksParticleItem_start=function(){this.__base.FE3dParticleItem.start.call(this);this._priorPosition.assign(this._position);this._currentDistance=0;this._currentAlpha=1;var a=this._direction,b=this._speed;this._currentSpeed.x=a.x*b;this._currentSpeed.y=a.y*b;this._currentSpeed.z=a.z*b};
MO.FE3dFireworksParticleItem_processSplit=function(){for(var a=this._particle,b=MO.Console.find(MO.FE3dParticleConsole),d=0;4>d;d++)for(var e=2*Math.PI/16,f=0;16>f;f++){var h=e*f,k=b.itemAlloc(MO.FE3dFireworksParticleItem);k.setSplittingNumber(0);k.setParticle(a);k.direction().set(Math.sin(h),Math.cos(h),0);k.position().assign(position);k.color().assign(this._color);k.scale().setAll(.2);k.setDelay(.02*d);k.setSpeed(this._speed);k.acceleration().assign(this._acceleration);k.setAttenuation(1);k.start();
a.pushItem(k)}};
MO.FE3dFireworksParticleItem_processFrame=function(a){var b=this._priorPosition;b.assign(this._position);var d=this._position,e=this._particle.testInRange(d.x,d.y);this._statusInRange!=e&&(e?(this._storeSpeed.assign(this._currentSpeed),this._currentSpeed.setAll(.01),this._color.set(1,0,0,1)):(this._color.set(1,1,1,1),this._currentSpeed.assign(this._storeSpeed)),this._statusInRange=e);var e=this._currentSpeed,f=e.x*a,h=e.y*a,k=e.z*a,d=this._position;d.x+=f;d.y+=h;d.z+=k;f=this._direction;f.x=d.x-b.x;
f.y=d.y-b.y;f.z=d.z-b.z;this._currentDistance+=f.length();f.normalize();b=Math.acos(f.x);this._rotation.z=0<f.y?b:2*Math.PI-b;b=this._acceleration;e.x+=b.x*a;e.y+=b.y*a;e.z+=b.z*a;a*=this._attenuation;a>this._currentAlpha?(this._currentAlpha=0,this._currentFinish=!0):this._currentAlpha-=a;0<this._splittingNumber&&this._currentDistance>this._splittingDistance&&(this.processSplit(),this._splittingNumber--,0==this._splittingNumber&&(this._currentFinish=!0));this.dirty()};
MO.FE3dFireworksParticleItem_dispose=function(){this._priorPosition=MO.Lang.Object.dispose(this._priorPosition);this._direction=MO.Lang.Object.dispose(this._direction);this.__base.FE3dParticleItem.dispose.call(this)};
MO.FE3dParticle=function(a){a=MO.Class.inherits(this,a,MO.FE3dRenderable);a._items=MO.Class.register(a,new MO.AGetter("_items"));a._vertexPositionBuffer=null;a._vertexCoordBuffer=null;a._vertexColorBuffer=null;a._indexBuffer=null;a.construct=MO.FE3dParticle_construct;a.setup=MO.FE3dParticle_setup;a.testReady=MO.FE3dParticle_testReady;a.findTexture=MO.FE3dParticle_findTexture;a.textures=MO.FE3dParticle_textures;a.material=MO.FE3dParticle_material;a.setSize=MO.FE3dParticle_setSize;a.setData=MO.FE3dParticle_setData;
a.loadUrl=MO.FE3dParticle_loadUrl;a.createItem=MO.FE3dParticle_createItem;a.pushItem=MO.FE3dParticle_pushItem;a.process=MO.FE3dParticle_process;a.upload=MO.FE3dParticle_upload;a.dispose=MO.FE3dParticle_dispose;return a};MO.FE3dParticle_construct=function(){this.__base.FE3dRenderable.construct.call(this);this._items=new MO.TLooper};
MO.FE3dParticle_setup=function(){var a=this._graphicContext;this._vertexCount=0;var b=this._vertexPositionBuffer=a.createVertexBuffer();b.setCode("position");b.setFormatCd(MO.EG3dAttributeFormat.Float3);this.pushVertexBuffer(b);b=this._vertexCoordBuffer=a.createVertexBuffer();b.setCode("coord");b.setFormatCd(MO.EG3dAttributeFormat.Float2);this.pushVertexBuffer(b);b=this._vertexColorBuffer=a.createVertexBuffer();b.setCode("color");b.setFormatCd(MO.EG3dAttributeFormat.Byte4Normal);this.pushVertexBuffer(b);
b=this._indexBuffer=a.createIndexBuffer();this.pushIndexBuffer(b)};MO.FE3dParticle_testReady=function(){this._ready||(this._ready=this._renderable.testReady());return this._ready};MO.FE3dParticle_findTexture=function(a){return this._renderable.findTexture(a)};MO.FE3dParticle_textures=function(){return this._renderable.textures()};MO.FE3dParticle_material=function(){return this._renderable.material()};MO.FE3dParticle_setSize=function(a,b){};MO.FE3dParticle_setData=function(a){this._renderable=a};
MO.FE3dParticle_loadUrl=function(a){var b=this._graphicContext;this._renderable=RConsole.find(FE3dParticleConsole).loadUrl(b,a);this._ready=!1};MO.FE3dParticle_createItem=function(){var a=MO.Class.create(MO.FE3dParticleItem);this.pushItem(a);return this};MO.FE3dParticle_pushItem=function(a){this._items.push(a)};
MO.FE3dParticle_process=function(){this.__base.FE3dRenderable.process.call(this);var a=MO.Console.find(MO.FE3dParticleConsole),b=this._items;for(b.record();b.next();){var d=b.current();d.currentFinish()&&(b.removeCurrent(),a.itemFree(d));d.process()}b.isEmpty()||this.upload()};
MO.FE3dParticle_upload=function(){var a=this._items,b=a.count(),d=this._vertexCount=4*b,e=new Float32Array(3*d),f=0,h=new Float32Array(2*d),k=0,d=new Uint8Array(4*d),q=0,b=new Uint16Array(12*b);a.record();for(var w=0;a.next();){var x=a.current();if(x.visible()){var y=x.currentMatrix(),z=x.color(),A=parseInt(255*MO.Lang.Float.toRange(z.red,0,1)),B=parseInt(255*z.green),z=parseInt(255*z.blue),x=parseInt(255*x.currentAlpha());y.transform(e,12*w,MO.Lang.Math.faceCenterPositions,0,4);h[f++]=0;h[f++]=1;
h[f++]=1;h[f++]=1;h[f++]=1;h[f++]=0;h[f++]=0;for(y=h[f++]=0;4>y;y++)d[k++]=A,d[k++]=B,d[k++]=z,d[k++]=x;A=4*w;b[q++]=A+0;b[q++]=A+1;b[q++]=A+2;b[q++]=A+0;b[q++]=A+2;b[q++]=A+3;w++}}this._vertexPositionBuffer.upload(e,12,w);this._vertexCoordBuffer.upload(h,8,w);this._vertexColorBuffer.upload(d,4,w);this._indexBuffer.upload(b,6*w)};MO.FE3dParticle_dispose=function(){this._items=MO.Lang.Object.dispose(this._items);this.__base.FE3dRenderable.dispose.call(this)};
MO.FE3dParticleConsole=function(a){a=MO.Class.inherits(this,a,MO.FConsole);a._scopeCd=MO.EScope.Local;a._pools=MO.Class.register(a,new MO.AGetter("_pools"));a.onLoad=MO.FE3dParticleConsole_onLoad;a.construct=MO.FE3dParticleConsole_construct;a.itemAlloc=MO.FE3dParticleConsole_itemAlloc;a.itemFree=MO.FE3dParticleConsole_itemFree;a.dispose=MO.FE3dParticleConsole_dispose;return a};MO.FE3dParticleConsole_construct=function(){this.__base.FConsole.construct.call(this);this._pools=MO.Class.create(MO.FObjectPools)};
MO.FE3dParticleConsole_itemAlloc=function(a){var b=MO.Class.name(a);(b=this._pools.alloc(b))||(b=MO.Class.create(a));return b};MO.FE3dParticleConsole_itemFree=function(a){var b=MO.Class.name(a);this._pools.free(b,a)};MO.FE3dParticleConsole_dispose=function(){this._pools=MO.Lang.Object.dispose(this._pools);this.__base.FConsole.dispose.call(this)};
MO.FE3dParticleData=function(a){a=MO.Class.inherits(this,a,MO.FE3dFaceData);a.onImageLoad=MO.FE3dParticleData_onImageLoad;a.construct=MO.FE3dParticleData_construct;a.loadUrl=MO.FE3dParticleData_loadUrl;a.dispose=MO.FE3dParticleData_dispose;return a};MO.FE3dParticleData_onImageLoad=function(a){a=a.sender;this._size.assign(a.size());this._texture.upload(a);a.dispose();this._ready=!0};
MO.FE3dParticleData_construct=function(){this.__base.FE3dFaceData.construct.call(this);var a=this._material.info();a.effectCode="control";a.optionAlpha=!0;a.ambientColor.set(1,1,1,1)};MO.FE3dParticleData_loadUrl=function(a){var b=MO.Class.create(MO.FImage);b.addLoadListener(this,this.onImageLoad);b.loadUrl(a);this._ready=!1};MO.FE3dParticleData_dispose=function(){this._hVideo=null;this.__base.FE3dFaceData.dispose.call(this)};
MO.FE3dParticleItem=function(a){a=MO.Class.inherits(this,a,MO.FObject);a._particle=MO.Class.register(a,new MO.AGetSet("_particle"));a._visible=MO.Class.register(a,new MO.AGetSet("_visible"),!1);a._delay=MO.Class.register(a,new MO.AGetSet("_delay"),0);a._interval=MO.Class.register(a,new MO.AGetter("_interval"),1);a._position=MO.Class.register(a,new MO.AGetter("_position"));a._rotation=MO.Class.register(a,new MO.AGetter("_rotation"));a._scale=MO.Class.register(a,new MO.AGetter("_scale"));a._color=MO.Class.register(a,
new MO.AGetter("_color"));a._currentMatrix=MO.Class.register(a,new MO.AGetter("_currentMatrix"));a._currentAlpha=MO.Class.register(a,new MO.AGetSet("_currentAlpha"),0);a._currentFinish=MO.Class.register(a,new MO.AGetSet("_currentFinish"),!1);a._startTick=0;a._lastTick=0;a._statusDirty=!1;a.construct=MO.FE3dParticleItem_construct;a.start=MO.FE3dParticleItem_start;a.processFrame=MO.FE3dParticleItem_processFrame;a.process=MO.FE3dParticleItem_process;a.dirty=MO.FE3dParticleItem_dirty;a.dispose=MO.FE3dParticleItem_dispose;
return a};MO.FE3dParticleItem_construct=function(){this.__base.FObject.construct.call(this);this._currentMatrix=new MO.SMatrix3d;this._position=new MO.SPoint3(0,0,0);this._rotation=new MO.SVector3(0,0,0);this._scale=new MO.SVector3(1,1,1);this._color=new MO.SColor4(1,1,1,1)};MO.FE3dParticleItem_start=function(){this._visible=!1;this._currentAlpha=1;this._currentFinish=!1;this._startTick=MO.Timer.current();this._lastTick=0};MO.FE3dParticleItem_processFrame=function(a){};
MO.FE3dParticleItem_process=function(){var a=MO.Timer.current();if(this._visible||!(a-this._startTick<this._delay)){if(0==this._lastTick)return this._lastTick=a,!1;var b=a-this._lastTick;if(b<=this._interval)return!1;this.processFrame(b/1E3);this._lastTick=a;this._statusDirty&&(a=this._currentMatrix,a.tx=this._position.x,a.ty=this._position.y,a.tz=this._position.z,a.rx=this._rotation.x,a.ry=this._rotation.y,a.rz=this._rotation.z,a.sx=this._scale.x,a.sy=this._scale.y,a.sz=this._scale.z,a.updateForce(),
this._visible=!0,this._statusDirty=!1)}};MO.FE3dParticleItem_dirty=function(){this._statusDirty=!0};MO.FE3dParticleItem_dispose=function(){this._currentMatrix=MO.Lang.Object.dispose(this._currentMatrix);this._position=MO.Lang.Object.dispose(this._position);this._rotation=MO.Lang.Object.dispose(this._rotation);this._scale=MO.Lang.Object.dispose(this._scale);this.__base.FObject.dispose.call(this)};
MO.FE3dRainFontParticle=function(a){a=MO.Class.inherits(this,a,MO.FE3dParticle);a._itemCount=MO.Class.register(a,new MO.AGetSet("_itemCount"),0);a._delay=MO.Class.register(a,new MO.AGetSet("_delay"),0);a._speed=MO.Class.register(a,new MO.AGetSet("_speed"),1);a._angle=MO.Class.register(a,new MO.AGetSet("_angle"),0);a._acceleration=MO.Class.register(a,new MO.AGetSet("_acceleration"),0);a._attenuation=MO.Class.register(a,new MO.AGetSet("_attenuation"),0);a._vertexPositionBuffer=null;a._vertexCoordBuffer=
null;a._indexBuffer=null;a.construct=MO.FE3dRainFontParticle_construct;a.setup=MO.FE3dRainFontParticle_setup;a.testInRange=MO.FE3dRainFontParticle_testInRange;a.start=MO.FE3dRainFontParticle_start;a.dispose=MO.FE3dRainFontParticle_dispose;return a};MO.FE3dRainFontParticle_construct=function(){this.__base.FE3dParticle.construct.call(this)};MO.FE3dRainFontParticle_setup=function(){this.__base.FE3dParticle.setup.call(this)};
MO.FE3dRainFontParticle_testInRange=function(a,b){var d=parseInt((a+17)/20*220),d=4*(360*(60-parseInt(6*(b+3)))+d),e=this._data.data;if(0<=d&&d<e.length)var f=e[d];return 0<f};
MO.FE3dRainFontParticle_start=function(){for(var a=MO.Console.find(MO.FE3dParticleConsole),b=this._itemCount,d=0;d<b;d++){var e=parseInt(360*MO.Random.get())%360,f=a.itemAlloc(MO.FE3dRainFontParticleItem);f.setParticle(this);f.direction().set(0,-1,0);f.position().set(.1*e-12,5,0);f.rotation().set(0,0,-Math.PI/2);f.scale().set(.1,.1,.1);f.setDelay(this._delay);f.setSpeed(this._speed);f.setAcceleration(this._acceleration);f.setAttenuation(this._attenuation);f.start();this.pushItem(f)}};
MO.FE3dRainFontParticle_dispose=function(){this.__base.FE3dParticle.dispose.call(this)};
MO.FE3dRainFontParticleItem=function(a){a=MO.Class.inherits(this,a,MO.FE3dParticleItem);a._direction=MO.Class.register(a,new MO.AGetter("_direction"));a._speed=MO.Class.register(a,new MO.AGetSet("_speed"));a._acceleration=MO.Class.register(a,new MO.AGetSet("_acceleration"),1);a._attenuation=MO.Class.register(a,new MO.AGetSet("_attenuation"),0);a._statusInRange=!1;a._currentSpeed=0;a._storeSpeed=0;a.construct=MO.FE3dRainFontParticleItem_construct;a.start=MO.FE3dRainFontParticleItem_start;a.processFrame=
MO.FE3dRainFontParticleItem_processFrame;a.dispose=MO.FE3dRainFontParticleItem_dispose;return a};MO.FE3dRainFontParticleItem_construct=function(){this.__base.FE3dParticleItem.construct.call(this);this._direction=new MO.SVector3};MO.FE3dRainFontParticleItem_start=function(){this.__base.FE3dParticleItem.start.call(this);this._statusInRange=!1;this._currentSpeed=this._speed;this._storeSpeed=0;this._currentAlpha=.2;this._color.set(.5,.5,.5,1)};
MO.FE3dRainFontParticleItem_processFrame=function(a){this._particle._graphicContext.size();var b=this._position,d=this._particle.testInRange(b.x,b.y);this._statusInRange!=d&&(d?(this._storeSpeed=this._currentSpeed,this._currentSpeed=.2,this._color.set(1,0,0,1),this._currentAlpha=1):(this._color.set(1,1,1,1),this._currentAlpha=.2,this._currentSpeed=this._storeSpeed),this._statusInRange=d);a*=this._currentSpeed;d=this._direction;b.x+=d.x*a;b.y+=d.y*a;b.z+=d.z*a;this.dirty()};
MO.FE3dRainFontParticleItem_dispose=function(){this._direction=MO.Lang.Object.dispose(this._direction);this.__base.FE3dParticleItem.dispose.call(this)};MO.EDataStatus=new function(){this.Unknown="";this.Insert="I";this.Update="U";this.Delete="D";return this};
MO.FDataRow=function(a){a=MO.Class.inherits(this,a,MO.FObject);a._dataset=MO.Class.register(a,new MO.AGetSet("_dataset"));a._index=MO.Class.register(a,new MO.AGetSet("_index"),0);a._statusCd=MO.Class.register(a,new MO.AGetSet("_statusCd"),MO.EDataStatus.Unknown);a._dataValues=null;a.construct=MO.FDataRow_construct;a.isEmpty=MO.FDataRow_isEmpty;a.count=MO.FDataRow_count;a.get=MO.FDataRow_get;a.set=MO.FDataRow_set;a.clear=MO.FDataRow_clear;a.loadConfig=MO.FDataRow_loadConfig;a.saveConfig=MO.FDataRow_saveConfig;
a.dispose=MO.FDataRow_dispose;return a};MO.FDataRow_construct=function(){this.__base.FObject.construct.call(this);this._dataValues=new MO.TDictionary};MO.FDataRow_isEmpty=function(){return this._dataValues.isEmpty()};MO.FDataRow_count=function(){return this._dataValues.count()};MO.FDataRow_get=function(a,b){var d=this._dataValues.get(a);return d?d.get():b};MO.FDataRow_set=function(a,b,d){var e=this._dataValues,f=e.get(a);f||(f=MO.Class.create(MO.FDataValue),e.set(a,f));f.set(b,d)};
MO.FDataRow_clear=function(){for(var a=this._dataValues,b=a.count(),d=0;d<b;d++)a.at(d).clear()};MO.FDataRow_loadConfig=function(a){this._statusCd=MO.EDataStatus.View;if(a=a.attributes())for(var b=a.count(),d=0;d<b;d++){var e=a.name(d),f=a.value(d);this.set(e,f)}};MO.FDataRow_saveConfig=function(a){a.set("_status_cd",this._statusCd);for(var b=this._dataValues,d=b.count(),e=0;e<d;e++){var f=b.name(e),h=b.value(e).get();a.set(f,h)}};
MO.FDataRow_dispose=function(){this._dataValues=MO.Lang.Object.dispose(this._dataValues);this.__base.FObject.dispose.call(this)};
MO.FDataset=function(a){a=MO.Class.inherits(this,a,MO.FObject);a._name=MO.Class.register(a,new MO.AGetSet("_name"));a._total=MO.Class.register(a,new MO.AGetter("_total"));a._pageSize=MO.Class.register(a,new MO.AGetSet("_pageSize"),20);a._pageCount=MO.Class.register(a,new MO.AGetter("_pageCount"));a._page=MO.Class.register(a,new MO.AGetSet("_page"));a._rows=MO.Class.register(a,new MO.AGetter("_rows"));a._viewers=MO.Class.register(a,new MO.AGetter("_viewers"));a.construct=MO.FDataset_construct;a.isEmpty=
MO.FDataset_isEmpty;a.count=MO.FDataset_count;a.createRow=MO.FDataset_createRow;a.row=MO.FDataset_row;a.rows=MO.FDataset_rows;a.find=MO.FDataset_find;a.findIndex=MO.FDataset_findIndex;a.push=MO.FDataset_push;a.erase=MO.FDataset_erase;a.remove=MO.FDataset_remove;a.createViewer=MO.FDataset_createViewer;a.loadConfig=MO.FDataset_loadConfig;a.saveConfig=MO.FDataset_saveConfig;a.clear=MO.FDataset_clear;a.dispose=MO.FDataset_dispose;return a};
MO.FDataset_construct=function(){this.__base.FObject.construct.call(this);this._rows=new MO.TObjects;this._viewers=new MO.TObjects};MO.FDataset_isEmpty=function(){return this._rows.isEmpty()};MO.FDataset_count=function(){return this._rows.count()};MO.FDataset_createRow=function(){var a=MO.Class.create(MO.FDataRow);a.setDataset(this);this._rows.push(a);return a};MO.FDataset_row=function(a){return this._rows.get(a)};MO.FDataset_rows=function(){return this._rows};
MO.FDataset_find=function(){var a=arguments.length;if(0!=a%2)throw new MO.TError(this,"Parameters must is pairs (length={1})",a);for(var b=this._rows,d=b.count(),e=0;e<d;e++){for(var f=b.at(e),h=!0,k=0;k<a;k+=2){var q=arguments[e+1];if(f.get(arguments[e])!=q){h=!1;break}}if(h)return f}return null};MO.FDataset_findIndex=function(a){for(var b=this._rows,d=b.count(),e=0;e<d;e++){var f=b.at(e);f.index();if(a)return f}return null};MO.FDataset_push=function(a){this._rows.push(a)};MO.FDataset_erase=function(a){return this._rows.remove(a)};
MO.FDataset_remove=function(a){this._rows.remove(a)};MO.FDataset_createViewer=function(a,b){var d=MO.Class.create(MO.FDatasetViewer);d.setDataset(this);d.setOffset(MO.Runtime.nvl(a,0));d.setCount(MO.Runtime.nvl(b,this._rows.count()));this._viewers.push(d);return row};
MO.FDataset_loadConfig=function(a){this._code=a.get("name");this._total=MO.Lang.Integer.parse(a.get("total"));this._pageSize=MO.Lang.Integer.parse(a.get("page_size",100));this._pageCount=MO.Lang.Integer.parse(a.get("page_count",1));this._page=MO.Lang.Integer.parse(a.get("page",0));if(a=a.nodes())for(var b=a.count(),d=0;d<b;d++){var e=a.at(d);e.isName("Row")&&this.createRow().loadConfig(e)}};MO.FDataset_saveConfig=function(a){a.set("name",this._name);for(var b=this._rows,d=b.count(),e=0;e<d;e++)b.at(e).saveConfig(a.create("Row"))};
MO.FDataset_clear=function(){this._pageSize=20;this._total=this._pageCount=this._page=0;this._rows.clear()};MO.FDataset_dispose=function(){this._values=MO.Lang.Object.dispose(this._values);this.__base.FObject.dispose.call(this)};
MO.FDatasetViewer=function(a){a=MO.Class.inherits(this,a,MO.FObject);a._dataset=MO.Class.register(a,new MO.AGetSet("_dataset"));a._position=MO.Class.register(a,new MO.AGetter("_position"),0);a._offset=MO.Class.register(a,new MO.AGetSet("_offset"),0);a._count=MO.Class.register(a,new MO.AGetSet("_count"),0);a.construct=MO.FDatasetViewer_construct;a.isEmpty=MO.FDatasetViewer_isEmpty;a.current=MO.FDatasetViewer_current;a.first=MO.FDatasetViewer_first;a.prior=MO.FDatasetViewer_prior;a.next=MO.FDatasetViewer_next;
a.last=MO.FDatasetViewer_last;a.move=MO.FDatasetViewer_move;a.moveToRow=MO.FDatasetViewer_moveToRow;a.reset=MO.FDatasetViewer_reset;a.dispose=MO.FDatasetViewer_dispose;return a};MO.FDatasetViewer_construct=function(){this.__base.FObject.construct.call(this)};MO.FDatasetViewer_isEmpty=function(){return 0==this._count};MO.FDatasetViewer_current=function(){var a=this._position;return-1!=a?(a+=this._offset,this._dataset.rows().get(a)):null};
MO.FDatasetViewer_move=function(a){var b=this._count;return 0<b&&0<=a&&a<b?(this._position=a,!0):!1};MO.FDatasetViewer_moveToRow=function(a){a=this._rows.indexOf(a);-1!=a&&(this._position=a-this._offset)};MO.FDatasetViewer_first=function(){if(0<this._count)return this._position=0,!0;this._position=-1;return!1};MO.FDatasetViewer_prior=function(){return 0<this._position?(this._position--,!0):!1};MO.FDatasetViewer_next=function(){return this._position<this._count-1?(this._position++,!0):!1};
MO.FDatasetViewer_last=function(){var a=this._count;if(0<a)return this._position=a-1,!0;this._position=-1;return!1};MO.FDatasetViewer_reset=function(){this._position=-1};MO.FDatasetViewer_dispose=function(){this._dataset=null;this.__base.FObject.dispose.call(this)};
MO.FDataSource=function(a){a=MO.Class.inherits(this,a,MO.FObject);a._currentRow=MO.Class.register(a,new MO.AGetter("_currentRow"));a._currentDataset=MO.Class.register(a,new MO.AGetter("_currentDataset"));a._datasets=null;a.construct=MO.FDataSource_construct;a.selectDataset=MO.FDataSource_selectDataset;a.selectRow=MO.FDataSource_selectRow;a.loadConfig=MO.FDataSource_loadConfig;a.saveConfig=MO.FDataSource_saveConfig;a.dispose=MO.FDataSource_dispose;return a};
MO.FDataSource_construct=function(){this.__base.FObject.construct.call(this);this._datasets=new MO.TDictionary};MO.FDataSource_selectDataset=function(a){var b=this._datasets;a=MO.Lang.String.nvl(a,"default");var d=b.get(a);d||(d=MO.Class.create(MO.FDataset),d.setName(a),b.set(a,d));return this._currentDataset=d};MO.FDataSource_selectRow=function(a){if(a)this._currentRow=a;else return a=this._currentDataset,this._currentRow=a=a.isEmpty()?a.createRow():a.rows.first()};
MO.FDataSource_loadConfig=function(a){if(a=a.nodes())for(var b=a.count(),d=0;d<b;d++){var e=a.at(d);if(e.isName("Dataset")){var f=e.get("name");this.selectDataset(f).loadConfig(e)}}};MO.FDataSource_saveConfig=function(a){for(var b=this._datasets,d=b.count(),e=0;e<d;e++)b.at(e).saveConfig(a.create("Dataset"))};MO.FDataSource_dispose=function(){this._datasets=MO.Lang.Object.dispose(this._datasets);this.__base.FObject.dispose.call(this)};MO.FDataSource_create=function(a){return this.dataset.create(a)};
MO.FDataSource_count=function(){return this.dataset.count};MO.FDataSource_row=function(a){return this.dataset.get(a)};MO.FDataSource_current=function(){return this.row(this._position)};MO.FDataSource_isChanged=function(){for(var a=this.dataset,b=0;b<a.count;b++){var d=a.get(b);if(d&&d.isSave())return!0}return!1};MO.FDataSource_get=function(a){var b=this.current();return b?b.get(a):""};MO.FDataSource_set=function(a,b){var d=this.current();d&&d.set(a,b)};
MO.FDataSource_move=function(a){this._position=a};MO.FDataSource_moveToRow=function(a){a=this.dataset.indexOf(a);-1!=a&&(this._position=a)};MO.FDataSource_find=function(){return this.dataset.findByArgs(arguments)};MO.FDataSource_loadNode=function(a){if(a&&a.nodes){a=a.nodes;for(var b=0;b<a.count;b++){var d=a.get(b);if(d&&d.isName("Row")){var e=this.dataset.create();e.loadNode(d);e.store()}}}};
MO.FDataSource_dump=function(a){a=RString.nvlStr(a);a.appendLine(RClass.dump(this));this.dataset.dump(a);return a};
MO.FDataValue=function(a){a=MO.Class.inherits(this,a,MO.FObject);a._typeCd=MO.Class.register(a,new MO.AGetter("_typeCd"),MO.EDataType.Unknown);a._origin=MO.Class.register(a,new MO.AGetSet("_origin"));a._value=MO.Class.register(a,new MO.AGetSet("_value"));a._listenersChanged=null;a.isSet=MO.FDataValue_isSet;a.listenersChanged=MO.FDataValue_listenersChanged;a.get=MO.FDataValue_get;a.set=MO.FDataValue_set;a.clear=MO.FDataValue_clear;a.dispose=MO.FDataValue_dispose;return a};
MO.FDataValue_isSet=function(){return this._typeCd!=MO.EDataType.Unknown};MO.FDataValue_listenersChanged=function(){var a=this._listenersChanged;a||(a=this._listenersChanged=new MO.TListeners);return a};MO.FDataValue_get=function(){return this._typeCd!=MO.EDataType.Unknown?this._value:null};MO.FDataValue_set=function(a,b){this._typeCd=MO.Runtime.nvl(b,MO.EDataType.String);this._value=this._origin=a};MO.FDataValue_clear=function(){this._typeCd=MO.EDataType.Unknown;this._value=this._origin=null};
MO.FDataValue_dispose=function(){this.clear();this._listenersChanged=MO.Lang.Object.dispose(this._listenersChanged);this.__base.FObject.dispose.call(this)};
MO.AEvent=function(a,b,d){MO.AAnnotation.call(this,a);this._annotationCd=MO.EAnnotation.Event;this._logger=this._inherit=!0;this._linker=b;this._handle=d;this._process=null;this.linker=MO.AEvent_linker;this.handle=MO.AEvent_handle;this.value=MO.AEvent_value;this.create=MO.AEvent_create;this.attach=MO.Method.empty;this.bind=MO.AEvent_bind;this.toString=MO.AEvent_toString;return this};MO.AEvent_linker=function(){return this._linker};MO.AEvent_handle=function(){return this._handle};MO.AEvent_value=function(){return this._process};
MO.AEvent_create=function(){return new MO.SEvent};MO.AEvent_bind=function(a,b){b?a.addEventListener(this._linker,MO.Dui.Event.ohEvent,!0):a[this._handle]=MO.Dui.Event.ohEvent};MO.AEvent_toString=function(){return"linker="+this._linker+",handle="+this._handle};MO.AEventBlur=function(a,b){MO.AEvent.call(this,a,"blur","onblur");this.attach=MO.AEventBlur_attach;return this};MO.AEventBlur_attach=function(a,b){};
MO.AEventChange=function(a){MO.AEvent.call(this,a,"change","onchange");this.attach=MO.AEventChange_attach;return this};MO.AEventChange_attach=function(a,b){};MO.AEventClick=function(a){MO.AEvent.call(this,a,"click","onclick");this.attach=MO.AEventClick_attach;return this};MO.AEventClick_attach=function(a,b){a.altKey=b.altKey;a.ctrlKey=b.ctrlKey;a.shiftKey=b.shiftKey};MO.AEventDoubleClick=function(a){MO.AEvent.call(this,a,"dblclick","ondblclick");this.attach=MO.AEventDoubleClick_attach;return this};
MO.AEventDoubleClick_attach=function(a,b){a.altKey=b.altKey;a.ctrlKey=b.ctrlKey;a.shiftKey=b.shiftKey};MO.AEventFocus=function(a){MO.AEvent.call(this,a,"focus","onfocus");this.attach=MO.AEventFocus_attach;return this};MO.AEventFocus_attach=function(a,b){};MO.AEventInputChanged=function(a){MO.AEvent.call(this,a,"input","oninput");this.attach=MO.AEventInputChanged_attach;this.bind=MO.AEventInputChanged_bind;return this};MO.AEventInputChanged_attach=function(a,b){};
MO.AEventInputChanged_bind=function(a,b){MO.Window.Browser.isBrowser(MO.EBrowser.Explorer)?a.onpropertychange=MO.Dui.Event.ohEvent:a.addEventListener("input",MO.Dui.Event.ohEvent)};MO.AEventKeyDown=function(a){MO.AEvent.call(this,a,"keydown","onkeydown");this.attach=MO.AEventKeyDown_attach;return this};MO.AEventKeyDown_attach=function(a,b){a.altKey=b.altKey;a.shiftKey=b.shiftKey;a.ctrlKey=b.ctrlKey;a.keyCode=b.keyCode};
MO.AEventKeyPress=function(a){MO.AEvent.call(this,a,"keypress","onkeypress");this.create=MO.AEventKeyPress_create;this.attach=MO.AEventKeyPress_attach;return this};MO.AEventKeyPress_create=function(){return new MO.SKeyboardEvent};MO.AEventKeyPress_attach=function(a,b){a.hEvent=b;a.attachEvent(b)};MO.AEventKeyUp=function(a){MO.AEvent.call(this,a,"keyup","onkeyup");this.attach=MO.AEventKeyUp_attach;return this};
MO.AEventKeyUp_attach=function(a,b){a.altKey=b.altKey;a.shiftKey=b.shiftKey;a.ctrlKey=b.ctrlKey;a.keyCode=b.keyCode};MO.AEventLoad=function(a){MO.AEvent.call(this,a,"load","onload");this.attach=MO.AEventLoad_attach;return this};MO.AEventLoad_attach=function(a,b){};MO.AEventMouse=function(a,b,d){MO.AEvent.call(this,a,b,d);this.attach=MO.AEventMouse_attach;return this};
MO.AEventMouse_attach=function(a,b){a.button=b.button;a.mouseLeft=b.button==MO.EMouseButton.Left;a.mouseMiddle=b.button==MO.EMouseButton.Middle;a.mouseRight=b.button==MO.EMouseButton.Right;a.altKey=b.altKey;a.ctrlKey=b.ctrlKey;MO.Window.Browser.isBrowser(MO.EBrowser.FireFox)?(a.x=b.pageX,a.y=b.pageY,a.offsetX=b.layerX,a.offsetY=b.layerY):(a.x=b.x,a.y=b.y,a.offsetX=b.offsetX,a.offsetY=b.offsetY);a.clientX=b.clientX;a.clientY=b.clientY};
MO.AEventMouseDown=function(a){MO.AEventMouse.call(this,a,"mousedown","onmousedown");return this};MO.AEventMouseEnter=function(a){MO.AEvent.call(this,a,"mouseenter","onmouseenter");this._logger=!1;this.attach=MO.AEventMouseEnter_attach;return this};MO.AEventMouseEnter_attach=function(a,b){};MO.AEventMouseLeave=function(a){MO.AEvent.call(this,a,"mouseleave","onmouseleave");this._logger=!1;this.attach=MO.AEventMouseLeave_attach;return this};MO.AEventMouseLeave_attach=function(a,b){};
MO.AEventMouseMove=function(a){MO.AEventMouse.call(this,a,"mousemove","onmousemove");this._logger=!1;return this};MO.AEventMouseOut=function(a){MO.AEvent.call(this,a,"mouseout","onmouseout");this._y=this._x=this._ctrlKey=this._altKey=this._hSource=null;this.attach=MO.AEventMouseOut_attach;return this};
MO.AEventMouseOut_attach=function(a){this._hSource=a.srcElement;this._altKey=a.altKey;this._ctrlKey=a.ctrlKey;MO.Window.Browser.isBrowser(MO.EBrowser.FireFox)?(this._x=a.pageX,this._y=a.pageY):(this._x=a.x,this._y=a.y)};MO.AEventMouseOver=function(a){MO.AEvent.call(this,a,"mouseover","onmouseover");this._y=this._x=this._ctrlKey=this._altKey=this._hSource=null;this.attach=MO.AEventMouseOver_attach;return this};
MO.AEventMouseOver_attach=function(a){this._hSource=a.srcElement;this._altKey=a.altKey;this._ctrlKey=a.ctrlKey;MO.Window.Browser.isBrowser(MO.EBrowser.FireFox)?(this._x=a.pageX,this._y=a.pageY):(this._x=a.x,this._y=a.y)};MO.AEventMouseUp=function(a){MO.AEventMouse.call(this,a,"mouseup","onmouseup");return this};MO.AEventMouseWheel=function(a){MO.AEvent.call(this,a,"mousewheel","onmousewheel");this.attach=MO.AEventMouseWheel_attach;return this};
MO.AEventMouseWheel_attach=function(a,b){a.altKey=b.altKey;a.ctrlKey=b.ctrlKey;a.delta=b.wheelDelta;MO.Window.Browser.isBrowser(MO.EBrowser.FireFox)?(a.x=b.pageX,a.y=b.pageY):(a.x=b.x,a.y=b.y)};MO.AEventReadyStateChange=function(a){MO.AEvent.call(this,a,"readystatechange","onreadystatechange");this.attach=MO.AEventReadyStateChange_attach;return this};MO.AEventReadyStateChange_attach=function(a,b){};
MO.AEventResize=function(a){MO.AEvent.call(this,a,"resize","onresize");this.attach=MO.AEventResize_attach;return this};MO.AEventResize_attach=function(a,b){a.x=b.x;a.y=b.y};MO.AEventScroll=function(a){MO.AEvent.call(this,a,"scroll","onscroll");this.attach=MO.AEventScroll_attach;return this};MO.AEventScroll_attach=function(a,b){};MO.AEventTouchEnd=function(a){MO.AEvent.call(this,a,"touchstart","ontouchstart");this.attach=MO.AEventTouchEnd_attach;return this};MO.AEventTouchEnd_attach=function(a,b){};
MO.AEventTouchMove=function(a){MO.AEvent.call(this,a,"touchstart","ontouchstart");this.attach=MO.AEventTouchMove_attach;return this};MO.AEventTouchMove_attach=function(a,b){};MO.AEventTouchStart=function(a){MO.AEvent.call(this,a,"touchstart","ontouchstart");this.attach=MO.AEventTouchStart_attach;return this};MO.AEventTouchStart_attach=function(a,b){};
MO.APtyAttributes=function(a,b,d,e){MO.AProperty.call(this,a,b);this._splitName=MO.Lang.String.nvl(d,"=");this._splitValue=MO.Lang.String.nvl(e,"\n");this.load=MO.APtyAttributes_load;this.save=MO.APtyAttributes_save;this.toString=MO.APtyAttributes_toString;return this};MO.APtyAttributes_load=function(a,b){var d=this._name,e=a[d];e||(e=a[d]=new MO.TAttributes);d=b.get(this._linker);e.split(d,this._splitName,this._splitValue)};
MO.APtyAttributes_save=function(a,b){var d=a[this._name];d&&b.set(this._linker,d.join(this._splitName,this._splitValue))};MO.APtyAttributes_toString=function(){return"linker="+this._linker+",split_name="+this._splitName+",split_value"+this._splitValue};MO.APtyBoolean=function(a,b,d){MO.AProperty.call(this,a,b);this._value=d?d:!1;this.build=MO.APtyBoolean_build;this.load=MO.APtyBoolean_load;this.save=MO.APtyBoolean_save;this.toString=MO.APtyBoolean_toString;return this};
MO.APtyBoolean_build=function(a){null==a[this._name]&&(a[this._name]=this._value)};MO.APtyBoolean_load=function(a,b){var d=b.get(this._linker);a[this._name]=MO.Lang.Boolean.parse(d)};MO.APtyBoolean_save=function(a,b){var d=a[this._name];d&&b.set(this._linker,MO.Lang.Boolean.toString(d))};MO.APtyBoolean_toString=function(){return"linker="+this._linker+",value="+this._value};
MO.APtyBorder=function(a,b){MO.AProperty.call(this,a,b);this.load=MO.APtyBorder_load;this.save=MO.APtyBorder_save;this.toString=MO.APtyBorder_toString;return this};MO.APtyBorder_load=function(a,b){var d=b.get(this._linker);a[this._name].parse(d)};MO.APtyBorder_save=function(a,b){};MO.APtyBorder_toString=function(){return"linker="+this._linker+",value="+this._x+","+this._y};
MO.APtyConfig=function(a,b){MO.AProperty.call(this,a,b);this.force=!0;this.load=MO.APtyConfig_load;this.save=MO.Method.empty;return this};MO.APtyConfig_load=function(a,b){a[this.name]=b};MO.APtyEnum=function(a,b,d,e){MO.AProperty.call(this,a,b);this._enum=d;this._default=e;this.build=MO.APtyEnum_build;this.load=MO.APtyEnum_load;this.save=MO.APtyEnum_save;this.toString=MO.APtyEnum_toString;return this};MO.APtyEnum_build=function(a){null==a[this._name]&&(a[this._name]=this._default)};
MO.APtyEnum_load=function(a,b){a[this._name]=b.get(this._linker)};MO.APtyEnum_save=function(a,b){b.set(this._linker,a[this._name])};MO.APtyEnum_toString=function(){return"linker="+this._linker+",enum="+this._enum+",default="+this._default};
MO.APtyFont=function(a,b,d,e,f,h){MO.AProperty.call(this,a,b);this._font=MO.Lang.Integer.nvl(d);this._size=MO.Lang.Integer.nvl(e);this._bold=MO.Lang.Integer.nvl(f);this._color=MO.Lang.Integer.nvl(h);this.load=MO.APtyFont_load;this.save=MO.APtyFont_save;this.toString=MO.APtyFont_toString;return this};MO.APtyFont_load=function(a,b){var d=b.get(this._linker);a[this._name].parse(d)};MO.APtyFont_save=function(a,b){var d=a[this._name];d.isEmpty()||b.set(this._linker,d.toString())};
MO.APtyFont_toString=function(){return"linker="+this._linker+",value="+this._font+","+this._size+this._bold+","+this._color};MO.APtyInteger=function(a,b,d){MO.AProperty.call(this,a,b);this._value=MO.Lang.Integer.nvl(d);this.build=MO.APtyInteger_build;this.load=MO.APtyInteger_load;this.save=MO.APtyInteger_save;this.toString=MO.APtyInteger_toString;return this};MO.APtyInteger_build=function(a){var b=this._name;null==a[b]&&(a[b]=this._value)};
MO.APtyInteger_load=function(a,b){var d=b.get(this._linker);a[this._name]=MO.Lang.Integer.parse(d)};MO.APtyInteger_save=function(a,b){b.set(this._linker,MO.Lang.Integer.toString(a[this._name]))};MO.APtyInteger_toString=function(){return"linker="+this._linker+",value="+this._value};MO.APtyNumber=function(a,b,d){MO.AProperty.call(this,a,b);this._value=MO.Lang.Integer.nvl(d);this.build=MO.APtyNumber_build;this.toString=MO.APtyNumber_toString;return this};
MO.APtyNumber_build=function(a){null==a[this._name]&&(a[this._name]=this._value)};MO.APtyNumber_toString=function(){return"linker="+this._linker+",value="+this._value};MO.APtyPadding=function(a,b,d,e,f,h){MO.AProperty.call(this,a,b);this._left=MO.Lang.Integer.nvl(d);this._top=MO.Lang.Integer.nvl(e);this._right=MO.Lang.Integer.nvl(f);this._bottom=MO.Lang.Integer.nvl(h);this.load=MO.APtyPadding_load;this.save=MO.APtyPadding_save;this.toString=MO.APtyPadding_toString;return this};
MO.APtyPadding_load=function(a,b){var d=this._name,e=b.get(this._linker),f=a[d];f||(f=a[d]=new MO.SPadding);f.parse(e)};MO.APtyPadding_save=function(a,b){var d=a[this._name];d&&b.set(this._linker,d.toString())};MO.APtyPadding_toString=function(){return"linker="+this._linker+",value="+this._left+","+this._top+","+this._right+","+this._bottom};
MO.APtyPoint2=function(a,b,d,e){MO.AProperty.call(this,a,b);this._x=MO.Lang.Integer.nvl(d);this._y=MO.Lang.Integer.nvl(e);this.load=MO.APtyPoint2_load;this.save=MO.APtyPoint2_save;this.toString=MO.APtyPoint2_toString;return this};MO.APtyPoint2_load=function(a,b){var d=b.get(this._linker);a[this._name].parse(d)};MO.APtyPoint2_save=function(a,b){var d=a[this._name];d.isEmpty()||b.set(this._linker,d.toString())};MO.APtyPoint2_toString=function(){return"linker="+this._linker+",value="+this._x+","+this._y};
MO.APtySet=function(a,b,d,e){MO.AProperty.call(this,a,b);b=null;b=MO.Lang.String.startsWith(a,"_")?a.substring(1):a;this._code=MO.Lang.String.toUnderline(b);this._search=d;this._value=e;this.code=MO.APtySet_code;this.build=MO.APtySet_build;this.load=MO.APtySet_load;this.save=MO.APtySet_save;this.toString=MO.APtySet_toString;return this};MO.APtySet_code=function(){return this._code};MO.APtySet_build=function(a){var b=this._name;null==a[b]&&(a[b]=this._value)};
MO.APtySet_load=function(a,b){var d=b.get(this._linker);a[this._name]=MO.Lang.Set.containsString(d,this._search)};MO.APtySet_save=function(a,b){var d=this._name,e=this._search,f=a[d],h=b.get(this._linker),k=MO.Lang.Set.containsString(xs,e);f&&!k?b.set(d,h+e):!f&&k&&b.set(d,MO.Lang.String.remove(h,e))};MO.APtySet_toString=function(){return"linker="+this._linker+",value="+this._value+",search="+this._search};
MO.APtySize2=function(a,b,d,e){MO.AProperty.call(this,a,b);this._width=MO.Lang.Integer.nvl(d);this._height=MO.Lang.Integer.nvl(e);this.load=MO.APtySize2_load;this.save=MO.APtySize2_save;this.toString=MO.APtySize2_toString;return this};MO.APtySize2_load=function(a,b){var d=this._name,e=b.get(this._linker),f=a[d];f||(f=a[d]=new MO.SSize2);f.parse(e)};MO.APtySize2_save=function(a,b){var d=a[this._name];d&&b.set(this._linker,d.toString())};
MO.APtySize2_toString=function(){return"linker="+this._linker+",value="+this._width+","+this._height};MO.APtyString=function(a,b,d){MO.AProperty.call(this,a,b);this._value=d?d:null;this.build=MO.APtyString_build;this.toString=MO.APtyString_toString;return this};MO.APtyString_build=function(a){null==a[this._name]&&(a[this._name]=this._value)};MO.APtyString_toString=function(){return"linker="+this._linker+",value="+this._value};
MO.EUiAlign=new function(){this.Left="left";this.Center="center";this.Right="right";this.Top="up";this.Middle="middle";this.Bottom="down";this.BottomLeft="bl";this.BottomRight="br";return this};MO.EUiAnchor=new function(){this.None=0;this.Left=1;this.Top=2;this.Right=4;this.Bottom=8;this.Width=5;this.Height=10;this.All=15;return this};MO.EUiBorder=new function(){this.None=0;this.Square=1;this.Round=2;this.RoundIcon=3;this.RoundDrop=4;this.RoundTitle=5;this.RoundIconDrop=6;return this};
MO.EUiBorderStyle=new function(){this.Readonly=1;this.Edit=2;this.Hover=3;return this};MO.EUiColor=new function(){this.Text="#0099FF";this.TextReadonly=this.TextHover="#000000";this.EditHover=this.Edit="#EBFFFF";this.EditReadonly="#FEFECB";return this};
MO.EUiCursor=new function(){this.Default="default";this.Auto="auto";this.NorthWest="NW";this.SouthWest="SW";this.SouthEast="SE";this.NorthEast="NE";this.West="W";this.South="S";this.East="E";this.North="N";this.Pointer="pointer";this.Cross="crosshair";this.Move="move";return this};MO.EUiDataAction=new function(){MO.TEnum.call(this);this.First="first";this.Prior="prior";this.Next="next";this.Last="last";this.Prepare="prepare";this.Insert="insert";this.Update="update";this.Delete="delete";return this};
MO.EUiDialog=new function(){this.Confirm=1;this.Info=2;this.Warn=3;this.Error=4;return this};MO.EUiDirection=new function(){this.Horizontal="H";this.Vertical="V";return this};MO.EUiDock=new function(){this.None="None";this.LeftTop="LeftTop";this.Left="Left";this.LeftBottom="LeftBottom";this.Top="Top";this.RightTop="RightTop";this.Right="Right";this.RightBottom="RightBottom";this.Bottom="Bottom";this.Center="Center";this.Fill="Fill";return this};
MO.EUiLabelMode=new function(){this.All="A";this.Label="L";this.Hidden="H";return this};MO.EUiLabelPosition=new function(){this.Left="left";this.Right="right";this.Top="top";this.Bottom="bottom";return this};MO.EUiLayer=new function(){this.Default=2E4;this.Shadow=6E3;this.Disable=5E3;this.Drap=1E4;this.Window=2E4;this.Drop=4E4;this.Editor=1E4;this.Border=2E4;this.Move=25E3;this.Message=this.Search=45E3;return this};
MO.EUiLayout=new function(){this.Display="P";this.Search="S";this.Design="G";this.Insert="I";this.Update="U";this.Delete="D";this.Zoom="Z";return this};MO.EUiMerge=new function(){this.Append="append";this.Override="override";this.Disable="disable";return this};MO.EUiMode=new function(){MO.TEnum.call(this);this.View="V";this.Insert="I";this.Update="U";this.Delete="D";this.Search="S";this.Picker="P";this.Zoom="Z";this.Design="G";this.Print="R";return this};
MO.EPanel=new function(){this.Container=0;this.Parent=1;this.Size=8;this.Border=2;this.Edit=3;this.Focus=4;this.Design=5;this.Scroll=6;this.Shadow=7;this.Move=9;this.Disable=10;this.Drop=11;return this};MO.EUiPosition=new function(){this.Left="left";this.Right="right";this.Top="top";this.Bottom="bottom";this.Center="center";this.Before=1;this.After=2;this.LineBefore=3;this.LineAfter=4;return this};
MO.EUiScroll=new function(){this.None="N";this.Horizontal="H";this.HorizontalAuto="HA";this.Vertical="V";this.VerticalAuto="VA";this.Both="B";this.BothAuto="BA";return this};MO.EUiSize=new function(){this.Normal=0;this.Horizontal=1;this.Vertical=2;this.Fill=3;this.Both=4;return this};MO.EUiTimeUnit=new function(){this.Second="second";this.Minute="minute";this.Hour="hour";this.Day="day";this.Week="week";this.Month="month";this.Year="year";return this};
MO.EUiWrap=new function(){this.NextLine=0;this.SameLine=1;return this};MO.MUiBorder=function(a){a=MO.Class.inherits(this,a);a._borderInner=MO.Class.register(a,[new MO.APtyBorder("_borderInner"),new MO.AGetter("_borderInner")]);a._borderOuter=MO.Class.register(a,[new MO.APtyBorder("_borderOuter"),new MO.AGetter("_borderOuter")]);a.construct=MO.MUiBorder_construct;a.dispose=MO.MUiBorder_dispose;return a};MO.MUiBorder_construct=function(){this._borderInner=new MO.SBorder;this._borderOuter=new MO.SBorder};
MO.MUiBorder_dispose=function(){this._borderInner=MO.Lang.Object.dispose(this._borderInner);this._borderOuter=MO.Lang.Object.dispose(this._borderOuter)};
MO.MUiComponent=function(a){a=MO.Class.inherits(this,a);a._valid=MO.Class.register(a,[new MO.APtyBoolean("_valid"),new MO.AGetSet("_valid")]);a._guid=MO.Class.register(a,[new MO.APtyString("_guid"),new MO.AGetSet("_guid")]);a._code=MO.Class.register(a,[new MO.APtyString("_code"),new MO.AGetSet("_code")]);a._name=MO.Class.register(a,[new MO.APtyString("_name"),new MO.AGetSet("_name")]);a._label=MO.Class.register(a,[new MO.APtyString("_label"),new MO.AGetSet("_label")]);a._attributes=MO.Class.register(a,
[new MO.APtyAttributes("_attributes"),new MO.AGetter("_attributes")]);a._components=null;a._tag=MO.Class.register(a,new MO.AGetSet("_tag"));a.oeInitialize=MO.MUiComponent_oeInitialize;a.oeRelease=MO.MUiComponent_oeRelease;a.attributeGet=MO.MUiComponent_attributeGet;a.attributeSet=MO.MUiComponent_attributeSet;a.topComponent=MO.MUiComponent_topComponent;a.hasComponent=MO.MUiComponent_hasComponent;a.findComponent=MO.MUiComponent_findComponent;a.searchComponent=MO.MUiComponent_searchComponent;a.searchComponents=
MO.MUiComponent_searchComponents;a.components=MO.MUiComponent_components;a.push=MO.MUiComponent_push;a.remove=MO.MUiComponent_remove;a.clear=MO.MUiComponent_clear;a.process=MO.MUiComponent_process;a.psInitialize=MO.MUiComponent_psInitialize;a.psRelease=MO.MUiComponent_psRelease;a.toString=MO.MUiComponent_toString;a.dispose=MO.MUiComponent_dispose;a.innerDumpInfo=MO.MUiComponent_innerDumpInfo;a.innerDump=MO.MUiComponent_innerDump;return a};MO.MUiComponent_oeInitialize=function(a){return MO.EEventStatus.Continue};
MO.MUiComponent_oeRelease=function(a){return MO.EEventStatus.Continue};MO.MUiComponent_attributeGet=function(a){var b=null,d=this._attributes;d&&(b=d.get(a));return b};MO.MUiComponent_attributeSet=function(a,b){var d=this._attributes;d||(d=this._attributes=new MO.TAttributes);d.set(a,b)};MO.MUiComponent_topComponent=function(a){var b=this;if(a)for(;MO.Class.isClass(b._parent,a);)b=b._parent;else for(;b._parent;)b=b._parent;return b};
MO.MUiComponent_hasComponent=function(){var a=this._components;return a?!a.isEmpty():!1};MO.MUiComponent_findComponent=function(a){var b=this._components;return b?b.get(a):null};MO.MUiComponent_searchComponent=function(a){var b=null,d=this._components;d&&(b=d.get(a));if(!b)for(var e=d.count(),f=0;f<e&&!(b=d.at(f).findComponent(a));f++);return b};
MO.MUiComponent_searchComponents=function(a,b){var d=this._components;if(d)for(var e=d.count(),f=0;f<e;f++){var h=d.at(f);MO.Class.isClass(h,b)&&a.pushUnique(h);h.searchComponents(a,b)}};MO.MUiComponent_components=function(){var a=this._components;null==a&&(this._components=a=new MO.TDictionary);return a};MO.MUiComponent_push=function(a){if(MO.Class.isClass(a,MO.MUiComponent)){var b=this.components(),d=a.name();a.setParent(this);null==d&&(d=b.count(),a.setName(d));b.set(d,a)}};
MO.MUiComponent_remove=function(a){if(!MO.Class.isClass(a,MO.MUiComponent))throw new MO.TError(this,"Parameter is not componet. (component={1})",a);var b=this._components;if(!b.contains(a.name()))throw new MO.TError(this,"Parameter component is not in this component. (name={1})",a.name());b.removeValue(a)};MO.MUiComponent_clear=function(){var a=this._components;a&&a.clear()};
MO.MUiComponent_process=function(a){var b=this.__base[a.clazz];if(b){a.invokeCd=MO.EEventInvoke.Before;var d=this[a.invoke];if(d&&(d=d.call(this,a),d==MO.EEventStatus.Stop||d==MO.EEventStatus.Cancel))return d}var e=this._components;if(e){var f=e.count();if(f)for(var h=0;h<f;h++)if(d=e.at(h).process(a),d==MO.EEventStatus.Cancel)return d}return b&&(a.invokeCd=MO.EEventInvoke.After,d=this[a.invoke])&&(d=d.call(this,a),d==MO.EEventStatus.Stop||d==MO.EEventStatus.Cancel)?d:MO.EEventStatus.Continue};
MO.MUiComponent_psInitialize=function(){var a=new MO.SUiDispatchEvent(this,"oeInitialize",MO.MUiComponent);this.process(a);a.dispose()};MO.MUiComponent_psRelease=function(){var a=new MO.SUiDispatchEvent(this,"oeRelease",MO.MUiComponent);this.process(a);a.dispose()};MO.MUiComponent_toString=function(){return MO.Class.dump(this)+":label="+this._label};
MO.MUiComponent_dispose=function(){this._attributes=MO.Lang.Object.dispose(this._attributes);this._components=MO.Lang.Object.dispose(this._components,!0);this._tag=null};MO.MUiComponent_innerDumpInfo=function(a){a.append(MO.Class.dump(this));a.append(",name=",this._name);a.append(",label=",this._label)};MO.MUiComponent_innerDump=function(a,b){this.innerdumpInfo(a);var d=this.components;if(d){a.appendLine();for(var e=d.count(),f=0;f<e;f++){var h=d.at(f);h&&h.innerDump(a,b+1)}}return a};
MO.MUiContainer=function(a){a=MO.Class.inherits(this,a);a._scrollCd=MO.Class.register(a,new MO.APtyEnum("_scrollCd",null,MO.EUiScroll,MO.EUiScroll.None));a.createChild=MO.Method.empty;a.appendChild=MO.Method.empty;a.removeChild=MO.Method.empty;return a};
MO.MUiControl=function(a){a=MO.Class.inherits(this,a);a._visible=MO.Class.register(a,[new MO.APtyString("_visible"),new MO.AGetter("_visible")],!0);a._disable=MO.Class.register(a,[new MO.APtyString("_disable"),new MO.AGetter("_disable")],!1);a._dockCd=MO.Class.register(a,[new MO.APtyString("_dockCd"),new MO.AGetSet("_dockCd")],MO.EUiDock.LeftTop);a._anchorCd=MO.Class.register(a,[new MO.APtyString("_anchorCd"),new MO.AGetSet("_anchorCd")],MO.EUiAnchor.None);a._hint=MO.Class.register(a,[new MO.APtyString("_hint"),
new MO.AGetSet("_hint")]);a._eventEnable=null;a._eventVisible=null;a._eventResize=null;a._eventRefresh=null;a._eventFrame=null;a.oeEnable=MO.MUiControl_oeEnable;a.oeVisible=MO.MUiControl_oeVisible;a.oeResize=MO.MUiControl_oeResize;a.oeRefresh=MO.MUiControl_oeRefresh;a.oeFrame=MO.MUiControl_oeFrame;a.psEnable=MO.MUiControl_psEnable;a.psVisible=MO.MUiControl_psVisible;a.psResize=MO.MUiControl_psResize;a.psRefresh=MO.MUiControl_psRefresh;a.psFrame=MO.MUiControl_psFrame;a.dispose=MO.MUiControl_dispose;
return a};MO.MUiControl_oeEnable=function(a){a.isBefore()&&this.setEnable(a.enable);return MO.EEventStatus.Continue};MO.MUiControl_oeVisible=function(a){a.isBefore()&&this.setVisible(a.visible);return MO.EEventStatus.Continue};MO.MUiControl_oeResize=function(a){return MO.EEventStatus.Continue};MO.MUiControl_oeRefresh=function(a){return MO.EEventStatus.Continue};MO.MUiControl_oeFrame=function(a){return MO.EEventStatus.Continue};
MO.MUiControl_psEnable=function(a){var b=this._eventEnable;b||(b=this._eventEnable=new MO.SUiDispatchEvent(this,"oeEnable",MO.MUiControl));b.enable=a;this.process(b)};MO.MUiControl_psVisible=function(a){var b=this._eventVisible;b||(b=this._eventVisible=new MO.SUiDispatchEvent(this,"oeVisible",MO.MUiControl));b.visible=a;this.process(b)};MO.MUiControl_psResize=function(){var a=this._eventResize;a||(a=this._eventResize=new MO.SUiDispatchEvent(this,"oeResize",MO.MUiControl));this.process(a)};
MO.MUiControl_psRefresh=function(){var a=this._eventRefresh;a||(a=this._eventRefresh=new MO.SUiDispatchEvent(this,"oeRefresh",MO.MUiControl));this.process(a)};MO.MUiControl_psFrame=function(){var a=this._eventFrame;a||(a=this._eventFrame=new MO.SUiDispatchEvent(this,"oeFrame",MO.MUiControl));this.process(a)};
MO.MUiControl_dispose=function(){this._eventEnable=MO.Lang.Object.dispose(this._eventEnable);this._eventVisible=MO.Lang.Object.dispose(this._eventVisible);this._eventResize=MO.Lang.Object.dispose(this._eventResize);this._eventRefresh=MO.Lang.Object.dispose(this._eventRefresh);this._eventFrame=MO.Lang.Object.dispose(this._eventFrame)};
MO.MUiDataContainer=function(a){a=MO.Class.inherits(this,a);a._dataActionCd=MO.Class.register(a,new MO.AGetter("_dataActionCd"));a.loadUnit=MO.MUiDataContainer_loadUnit;a.saveUnit=MO.MUiDataContainer_saveUnit;a.dataView=MO.MUiDataContainer_dataView;a.dataPrepare=MO.MUiDataContainer_dataPrepare;a.dataModify=MO.MUiDataContainer_dataModify;a.dataErase=MO.MUiDataContainer_dataErase;a.dataSave=MO.MUiDataContainer_dataSave;return a};
MO.MUiDataContainer_loadUnit=function(a){var b=new MO.SUiDispatchEvent(this,"oeLoadUnit",MO.MUiDataField);b.unit=a;this.process(b);b.dispose()};MO.MUiDataContainer_saveUnit=function(a){var b=new MO.SUiDispatchEvent(this,"oeSaveUnit",MO.MUiDataField);b.unit=a;this.process(b);b.dispose()};MO.MUiDataContainer_dataView=function(){var a=new MO.SUiDispatchEvent(this,"oeDataView",MO.MUiDataField);this.process(a);a.dispose()};
MO.MUiDataContainer_dataPrepare=function(){this._dataActionCd=MO.EUiDataAction.Insert;var a=new MO.SUiDispatchEvent(this,"oeDataPrepare",MO.MUiDataField);this.process(a);a.dispose()};MO.MUiDataContainer_dataModify=function(){this._dataActionCd=MO.EUiDataAction.Update;var a=new MO.SUiDispatchEvent(this,"oeDataEdit",MO.MUiDataField);this.process(a);a.dispose()};
MO.MUiDataContainer_dataErase=function(){this._dataActionCd=MO.EUiDataAction.Delete;var a=new MO.SUiDispatchEvent(this,"oeDataDelete",MO.MUiDataField);this.process(a);a.dispose()};MO.MUiDataContainer_dataSave=function(){var a=new MO.SUiDispatchEvent(this,"oeDataSave",MO.MUiDataField);this.process(a);a.dispose()};
MO.MUiDataField=function(a){a=MO.Class.inherits(this,a);a._dataName=MO.Class.register(a,[new MO.APtyString("_dataName"),new MO.AGetSet("_dataName")]);a._dataTypeCd=MO.Class.register(a,[new MO.APtyString("_dataTypeCd"),new MO.AGetSet("_dataTypeCd")],MO.EDataType.String);a._dataRequire=MO.Class.register(a,[new MO.APtyBoolean("_dataRequire"),new MO.AGetSet("_dataRequire")]);a._dataDefault=MO.Class.register(a,[new MO.APtyString("_dataDefault"),new MO.AGetSet("_dataDefault")]);a.oeDataPrepare=MO.MUiDataField_oeDataPrepare;
return a};MO.MUiDataField_oeDataPrepare=function(a){a.isAfter()&&this.set(this._dataDefault);return MO.EEventStatus.Continue};MO.MUiDataProperties=function(a){a=MO.Class.inherits(this,a);a._dataProperties=null;a.dataProperties=MO.MUiDataProperties_dataProperties;a.dataPropertyGet=MO.MUiDataProperties_dataPropertyGet;a.dataPropertySet=MO.MUiDataProperties_dataPropertySet;return a};
MO.MUiDataProperties_dataProperties=function(a,b){var d=this._dataProperties;null==d&&(d=this._dataProperties=new MO.TDictionary);return d};MO.MUiDataProperties_dataPropertyGet=function(a){return(a=this._dataProperties)?a.get(n):null};MO.MUiDataProperties_dataPropertySet=function(a,b){this.dataProperties().set(a,b)};
MO.MUiDataset=function(a){a=MO.Class.inherits(this,a);a._dsService=MO.Class.register(a,[new MO.APtyString("_dsService","dataset_service"),new MO.AGetSet("_dsService")]);a._dsName=MO.Class.register(a,[new MO.APtyString("_dsName","dataset_name"),new MO.AGetSet("_dsName")]);a._dsPageSize=MO.Class.register(a,[new MO.APtyInteger("_dsPageSize","page_size"),new MO.AGetSet("_dsPageSize")],20);a._dsPage=0;a._dsInsertAction=MO.Class.register(a,[new MO.APtyString("_dsInsertAction","insert_action"),new MO.AGetSet("_dsInsertAction")]);
a._dsUpdateAction=MO.Class.register(a,[new MO.APtyString("_dsUpdateAction","update_action"),new MO.AGetSet("_dsUpdateAction")]);a._dsDeleteAction=MO.Class.register(a,[new MO.APtyString("_dsDeleteAction","delete_action"),new MO.AGetSet("_dsDeleteAction")]);a._activeDataset=null;a.oeLoadDataSource=MO.MUiDataContainer_oeLoadDataSource;a.oeSaveDataSource=MO.MUiDataContainer_oeSaveDataSource;a.dsLoadSource=MO.MUiDataContainer_dsLoadSource;a.dsSaveSource=MO.MUiDataContainer_dsSaveSource;return a};
MO.MUiDataContainer_oeLoadDataSource=function(a){a.isBefore()&&(a=a.source,this._activeDataset=a.selectDataset(this._dsName),a=a.selectRow(),this.loadUnit(a));return MO.EEventStatus.Contine};
MO.MUiDataContainer_oeSaveDataSource=function(a){if(a.isBefore()){a=a.source;this._activeDataset=a.selectDataset(this._dsName);a=a.selectRow();switch(this._dataActionCd){case MO.EUiDataAction.Insert:a._statusCd=MO.EDataStatus.Insert;break;case MO.EUiDataAction.Update:a._statusCd=MO.EDataStatus.Update;break;case MO.EUiDataAction.Delete:a._statusCd=MO.EDataStatus.Delete;break;default:throw new TError(this,"Invalid data action.");}this.saveUnit(a)}return MO.EEventStatus.Contine};
MO.MUiDataContainer_dsLoadSource=function(a){var b=new MO.SUiDispatchEvent(this,"oeLoadDataSource",MO.MUiDataset);b.source=a;this.process(b);b.dispose()};MO.MUiDataContainer_dsSaveSource=function(a){var b=new MO.SUiDispatchEvent(this,"oeSaveDataSource",MO.MUiDataset);b.source=a;this.process(b);b.dispose()};MO.MUiDataset_onDsFetch=function(a){this.dsDatasetLoad(a.datasets)};MO.MUiDataset_onDsCopy=function(a){this.loadDatasets(a.resultDatasets);this.onLoadDatasetEnd();this.focus()};
MO.MUiDataset_onDsPrepare=function(a){a.resultDatasets.set("/",null);this.loadDatasets(a.resultDatasets);this.doPrepare(a.resultRow);a.invokeSuccess()||(this.onLoadDatasetEnd(),this.focus())};MO.MUiDataset_onDsUpdate=function(a){this.loadDatasets(a.resultDatasets);this.onLoadDatasetEnd();this.focus()};MO.MUiDataset_onDsDoUpdate=function(a){a.invokeSuccess()||this.psRefresh();a.processFinish||(this.focus(),this.lsnsUpdateEnd.process(a));this.onLoadDatasetEnd()};
MO.MUiDataset_onDsDelete=function(a){this.loadDatasets(a.resultDatasets);this.doDelete(a.resultRow);this.onLoadDatasetEnd();this.focus()};MO.MUiDataset_onDsProcess=function(a){var b=a.resultCallback;b&&b.invoke(this,a)};MO.MUiDataset_oeDataLoad=function(a){a.isBefore()&&(a=a.source,a.selectDataset(),a.selectRow());return EEventStatus.Contine};MO.MUiDataset_oeDataSave=function(a){a.isBefore()&&(a=a.source,a.selectDataset(),a.selectRow());return EEventStatus.Contine};
MO.MUiDataset_oeDatasetLoad=function(a){a.isBefore()&&(this._dataset=a=a.datasets.get(this._name),this.onDatasetLoad(a));return EEventStatus.Contine};MO.MUiDataset_construct=function(){this._dataViewer=new TDatasetViewer};MO.MUiDataset_loadDataset=function(a){this.dsStore=a;a.saveViewer(this._dataViewer);this.onLoadDataset(a)};
MO.MUiDataset_loadDatasets=function(a){for(var b=a.count(),d=0;d<b;d++){var e=a.value(n),f=this.findByPath(e.name);if(!f)return RMessage.fatal(this,null,"Load dataset failed. (dataset={1}",e.name);f.loadDataset(e)}};MO.MUiDataset_dsDatasetLoad=function(a){var b=new TEventProcess(null,this,"oeDatasetLoad",MUiDataset);b.datasets=a;this.process(b);b.dispose()};
MO.MUiDataset_toDeepAttributes=function(a,b){a||(a=new TAttributes);for(var d=new TList,e=this;e;){MO.Class.isClass(e,MUiDataset)&&d.push(e);if(!e.parent)break;e=e.topControl(MUiDataset)}for(var f=d.count;0<=f;f--)e=d.get(f),MO.Class.isClass(e,FForm)?e.toAttributes(a,b):MO.Class.isClass(b,FTable)&&(e=e.getCurrentRow())&&e.toAttributes(a,b);return a};MO.MUiDataset_dsFetch=function(){var a=new TDatasetFetchArg;a.owner=this;a.name=this._name;a.callback=this.onDsFetch;RConsole.find(FDatasetConsole).fetch(a)};
MO.MUiDataset_dsInitialize=function(){this.callEvent("onFormInitialize",this,this.__initializeEvent)};MO.MUiDataset_dsShow=function(){this.callEvent("onFormShow",this,this.__showEvent)};MO.MUiDataset_dsLoaded=function(){this.callEvent("onDatasetLoaded",this,this.__loadedEvent)};
MO.MUiDataset_dsSearch=function(a){this.psProgress(!0);var b=this.topControl(),d=this.fullPath();a&&(d=a.fullPath());a=new TDatasetFetchArg(b.name,b.formId,this.dsPageSize,0,!0,!1,d);a.mode=b._emode;a.searchs.append(this._dataGlobalSearchs);a.searchs.append(this._dataSearchs);a.orders.append(this._dataGlobalOrders);a.orders.append(this._dataOrders);this.toDeepAttributes(a.values);a.values.append(this._dataValues);a.callback=new TInvoke(this,this.onDsFetch);RConsole.find(FDatasetConsole).fetch(a)};
MO.MUiDataset_dsCopy=function(a){this.psProgress(!0);this.psMode(EMode.Insert);var b=new TDatasetFetchArg(this.name,this.formId,this.dsPageSize,0,!0);b.form=this;b.mode=EMode.Insert;this._dataSearchs.clear();this._dataSearchs.push(new TSearchItem("OUID",a.get("OUID")));b.searchs=this._dataSearchs;b.callback=new TInvoke(this,this.onDsCopy);this.onDsUpdateCheck(b)&&RConsole.find(FDatasetConsole).fetch(b)};
MO.MUiDataset_dsPrepare=function(a){this.psProgress(!0);this.psMode(EMode.Insert);var b=new TDatasetPrepareArg(this.name,this.formId);b.form=this;b.values.append(this._dataValues);b.callbackSuccess=a;this.onDsPrepareCheck(b)&&(b.callback=new TInvoke(this,this.onDsPrepare),RConsole.find(FDatasetConsole).prepare(b))};MO.MUiDataset_dsUpdate=function(a,b){this.psProgress(!0);this.psMode(EMode.Update);this.dsFetch(!0)};
MO.MUiDataset_dsDoUpdate=function(a,b){if(this.psValid()){var d=this.topControl(),d=new TDatasetUpdateArg(d.name,this.formId,this.dsName);d.form=this;d.path=this.fullPath();d.mode=this._emode;d.codes=this.getDataCodes();d.callback=new TInvoke(this,this.onDsDoUpdate);d.callbackSuccess=a;if(EMode.Insert==this._emode||EMode.Delete==this._emode)d.dataset.rows.append(this.getCurrentRows());else if(d.dataset.rows.append(this.getChangedRows()),!b&&!d.hasData())return RMessage.warn(this,RContext.get("MUiDataset:nochange"));
this.psProgress(!0);RConsole.find(FDatasetConsole).update(d)}};MO.MUiDataset_dsDelete=function(a,b){this.psProgress(!0);this.psMode(EMode.Delete);var d=new TDatasetFetchArg(this.name,this.formId,this.dsPageSize,0,!0);d.callback=new TInvoke(this,this.onDsDelete);d.form=this;d.mode=EMode.Delete;a&&d.searchs.push(new TSearchItem("OUID",a));b&&d.searchs.push(new TSearchItem("OVER",b));d.values=this._dataValues;this.onDsDeleteCheck(d)&&RConsole.find(FDatasetConsole).fetch(d)};
MO.MUiDataset_dsMode=function(a){switch(a){case EMode.Insert:this.dsPrepare();break;case EMode.Update:this.dsUpdate();break;case EMode.Delete:this.dsDelete()}};MO.MUiDataset_dsProcess=function(a,b){if(this.psValid()){var d=new TDatasetServiceArg(this.topControl().name,a);d.form=this;d.controlName=this.name;this.toDeepAttributes(d.attributes);d.codes=this.getDataCodes();d.push(this.getCurrentRow());d.resultCallback=b;this.psProgress(!0);d.callback=new TInvoke(this,this.onDsProcess);RConsole.find(FFormConsole).process(d)}};
MO.MUiDataset_dsProcessCustom=function(a,b,d,e){if(e||this.psValid()){b=new TDatasetServiceArg(this.topControl().name,b);b.form=this;b.controlName=this.name;b.attributes=a;b.codes=this.getDataCodes();b.push(this.getCurrentRow());b.resultCallback=d;if(!e&&!b.hasData())return RMessage.warn(this,RContext.get("MUiDataset:nodata"));this.psProgress(!0);b.callback=new TInvoke(this,this.onDsProcess);RConsole.find(FFormConsole).process(b)}};
MO.MUiDataset_dsProcessSelected=function(a,b){if(this.psValid()){var d=new TDatasetServiceArg(this.topControl().name,a);d.form=this;d.controlName=this.name;this.toDeepAttributes(d.attributes);d.codes=this.getDataCodes();d.rows=this.getSelectedRows();if(0<d.rows.count)d.resultCallback=b,this.psProgress(!0),d.callback=new TInvoke(this,this.onDsProcess),RConsole.find(FFormConsole).process(d),this.clearSelectRows();else return RMessage.warn(this,RContext.get("MUiDataset:norows"))}};
MO.MUiDataset_dsProcessChanged=function(a,b){if(this.psValid()){var d=new TDatasetServiceArg(this.topControl().name,a);d.form=this;d.controlName=this.name;this.toDeepAttributes(d.attributes);d.codes=this.getDataCodes();d.rows=this.getChangedRows();d.resultCallback=b;if(!d.hasData())return RMessage.warn(this,RContext.get("MUiDataset:nochange"));this.psProgress(!0);d.callback=new TInvoke(this,this.onDsProcess);RConsole.find(FFormConsole).process(d)}};
MO.MUiDataset_dsProcessAll=function(a,b){if(this.psValid()){var d=new TDatasetServiceArg(this.topControl().name,a);d.form=this;d.controlName=this.name;this.toDeepAttributes(d.attributes);d.codes=this.getDataCodes();d.rows=this.getRows();d.resultCallback=b;this.psProgress(!0);d.callback=new TInvoke(this,this.onDsProcess);RConsole.find(FFormConsole).process(d)}};MO.MUiDataset_psProgress=function(a){if(this.__progress!=a){this.__progress=a;var b=this.__progressProcess;b.enable=a;this.process(b)}};
MO.MUiDataset_psValid=function(){var a=this.__validProcess,b=a.controls;b.clear();this.process(a);return b.isEmpty()?!0:(a=RConsole.find(FCheckWindowConsole).find(),a.set(b),a.show(),!1)};MO.MUiDataset_dsIsChanged=function(){var a=this.dsStore;return a?a.isChanged():!1};MO.MUiDataset_dsCount=function(){return this.dsStore?this.dsStore.count:0};MO.MUiDataset_dsCurrent=function(){};
MO.MUiDataset_dsMove=function(a){var b=this.dsStore;if(null!=a||b)RInt.isInt(a)?b.move(a):EDataAction.First==a?b.moveFirst():EDataAction.Prior==a?b.movePrior():EDataAction.Next==a?b.moveNext():EDataAction.Last==a?b.moveLast():RMessage.fatal(this,null,"Unknown position (postion={0})",a),MO.Class.isClass(this,MValue)&&this.loadValue(b.current())};
MO.MUiDataset_dsMovePage=function(a){var b=this.dsStore;RInt.isInt(a)||(EDataAction.First==a?a=0:EDataAction.Prior==a?(a=b.pageIndex,0<a&&a--):EDataAction.Next==a?(a=b.pageIndex,a<b.pageCount-1&&a++):EDataAction.Last==a?a=b.pageCount-1:RMessage.fatal(this,null,"Unknown page (page={0})",a));a!=b.pageIndex&&(this.psProgress(!0),b=this.topControl(MUiDataset),a=new TDatasetFetchArg(b.name,b.formId,this.dsPageSize,a,!0),a.path=this.fullPath(),a.mode=b._emode,a.searchs.append(this._dataGlobalSearchs),a.searchs.append(this._dataSearchs),
a.orders.append(this._dataGlobalOrders),a.orders.append(this._dataOrders),a.values=this.toDeepAttributes(),a.values.append(this._dataValues),a.callback=new TInvoke(this,this.onDsFetch),RConsole.find(FDatasetConsole).fetch(a))};MO.MUiDataset_dsGet=function(a){return this.dsStore?this.dsStore.get(a):""};MO.MUiDataset_dsSet=function(a,b){this.dsStore&&this.dsStore.set(a,b)};MO.MUiDataset_dsRefresh=function(){this._dsService&&this.dsMove(this.dsPage,!0)};
MO.MUiDataset_doSearch=function(){var a=this.dsSearchWindow;a||(a=this.dsSearchWindow=top.RControl.create(top.FSearchWindow),a.linkDsControl(this));a.show()};MO.MUiDataValue=function(a){a=MO.Class.inherits(this,a,MO.MUiValue);a._dataValue=MO.Class.register(a,[new MO.APtyString("_dataValue"),new MO.AGetSet("_dataValue")]);a.oeLoadDataRow=MO.Method.empty;a.oeSaveDataRow=MO.Method.empty;return a};
MO.MUiDescriptorPicker=function(a){a=MO.Class.inherits(this,a);a._pickerService=MO.Class.register(a,new MO.APtyString("_pickerService"));a._pickerFrame=MO.Class.register(a,new MO.APtyString("_pickerFrame"));a._pickerFields=MO.Class.register(a,new MO.APtyAttributes("_pickerFields",null,"=",";"));a._pickerWhere=MO.Class.register(a,new MO.APtyString("_pickerWhere"));a._pickerOrder=MO.Class.register(a,new MO.APtyString("_pickerOrder"));a._picker=null;a.onPickerClick=MO.MUiDescriptorPicker_onPickerClick;
a.onPickerSelect=MO.MUiDescriptorPicker_onPickerSelect;a.testPicker=MO.MUiDescriptorPicker_testPicker;a.doPicker=MO.Method.empty;return a};MO.MUiDescriptorPicker_onPickerClick=function(a){this.testPicker()&&this.doPicker()};MO.MUiDescriptorPicker_onPickerSelect=function(a){a=a.row;for(var b=this._pickerFields,d=this.findParent(MO.MUiDataset),e=b.count(),f=0;f<e;f++){var h=b.name(f),k=b.value(f),h=d.searchComponent(h),k=a.get(k);h.set(k)}};
MO.MUiDescriptorPicker_testPicker=function(){return this._statusEditable?!MO.Lang.String.isEmpty(this._pickerFrame):!1};MO.MUiDescriptorZoom=function(a){a=MO.Class.inherits(this,a);a._zoomFrame=MO.Class.register(a,new MO.APtyString("_zoomFrame"));a._zoomField=MO.Class.register(a,new MO.APtyString("_zoomField"));a.testZoom=MO.MUiDescriptorZoom_testZoom;a.doZoom=MO.MUiDescriptorZoom_doZoom;return a};MO.MUiDescriptorZoom_testZoom=function(){return!MO.Lang.String.isEmpty(this._zoomFrame)};
MO.MUiDescriptorZoom_doZoom=function(a){MO.RFormSpace.doZoom(this,a)};
MO.MUiDisplay=function(a){a=MO.Class.inherits(this,a);a._displayView=MO.Class.register(a,new MO.APtySet("_displayView","display_mode",MO.EUiMode.View,!0));a._displayInsert=MO.Class.register(a,new MO.APtySet("_displayInsert","display_mode",MO.EUiMode.Insert,!1));a._displayUpdate=MO.Class.register(a,new MO.APtySet("_displayUpdate","display_mode",MO.EUiMode.Update,!0));a._displayDelete=MO.Class.register(a,new MO.APtySet("_displayDelete","display_mode",MO.EUiMode.Delete,!1));a._displaySearch=MO.Class.register(a,
new MO.APtySet("_displaySearch","display_mode",MO.EUiMode.Search,!1));a._displayPicker=MO.Class.register(a,new MO.APtySet("_displayPicker","display_mode",MO.EUiMode.Picker,!1));a._displayZoom=MO.Class.register(a,new MO.APtySet("_displayZoom","display_mode",MO.EUiMode.Zoom,!1));a._statusDisplay=MO.Class.register(a,new MO.AGetter("_statusDisplay","isDisplay"),!0);a.oeMode=MO.MUiDisplay_oeMode;a.testVisible=MO.MUiDisplay_testVisible;a.setVisible=MO.Method.empty;return a};
MO.MUiDisplay_oeMode=function(a){a.isBefore()&&(a=this._statusDisplay=this.testVisible(a.modeCd),this.setVisible(a))};MO.MUiDisplay_testVisible=function(a){switch(a){case MO.EUiMode.View:return this._displayView;case MO.EUiMode.Search:return this._displaySearch;case MO.EUiMode.Insert:return this._displayInsert;case MO.EUiMode.Update:return this._displayUpdate;case MO.EUiMode.Delete:return this._displayDelete;case MO.EUiMode.Zoom:return this._displayZoom}return!1};
MO.MUiDisplayContrainer=function(a){a=MO.Class.inherits(this,a);a._modeCd=MO.Class.register(a,new MO.AGetter("_modeCd"),MO.EUiMode.View);a._eventMode=null;a.construct=MO.MUiDisplayContrainer_construct;a.psMode=MO.MUiDisplayContrainer_psMode;a.psDesign=MO.MUiDisplayContrainer_psDesign;a.dispose=MO.MUiDisplayContrainer_dispose;return a};MO.MUiDisplayContrainer_construct=function(){this._eventMode=new MO.SUiDispatchEvent(this,"oeMode",MO.MUiDisplay)};
MO.MUiDisplayContrainer_psMode=function(a){this._modeCd=a;var b=this._eventMode;b.modeCd=a;this.process(b)};MO.MUiDisplayContrainer_psDesign=function(a,b){MO.Console.find(FDesignConsole).setFlag(a,b,this);var d=new MO.SUiDispatchEvent(this,"oeDesign",MO.MUiDesign);d.mode=a;d.flag=b;this.process(d);d.dispose()};MO.MUiDisplayContrainer_dispose=function(){this._eventMode=MO.Lang.Object.Dispose(this._eventMode)};
MO.MUiDragable=function(a){a=MO.Class.inherits(this,a);a.onDragStart=MO.Method.virtual(a,"onDragStart");a.onDragMove=MO.Method.virtual(a,"onDragMove");a.onDragStop=MO.Method.virtual(a,"onDragStop");return a};
MO.MUiEditable=function(a){a=MO.Class.inherits(this,a);a._editView=MO.Class.register(a,new MO.APtySet("_editView","edit_mode",MO.EUiMode.View,!1));a._editInsert=MO.Class.register(a,new MO.APtySet("_editInsert","edit_mode",MO.EUiMode.Insert,!1));a._editUpdate=MO.Class.register(a,new MO.APtySet("_editUpdate","edit_mode",MO.EUiMode.Update,!1));a._editDelete=MO.Class.register(a,new MO.APtySet("_editDelete","edit_mode",MO.EUiMode.Delete,!1));a._statusEditable=MO.Class.register(a,new MO.AGetter("_statusEditable",
"isEditable"),!0);a.oeMode=MO.MUiEditable_oeMode;a.testEditable=MO.MUiEditable_testEditable;a.setEditable=MO.Class.register(a,new MO.AVirtual("setEditable"));return a};MO.MUiEditable_oeMode=function(a){a.isBefore()&&(a=this._statusEditable=this.testEditable(a.modeCd),this.setEditable(a))};MO.MUiEditable_testEditable=function(a){switch(a){case MO.EUiMode.View:return this._editView;case MO.EUiMode.Insert:return this._editInsert;case MO.EUiMode.Update:return this._editUpdate;case MO.EUiMode.Delete:return this._editDelete}return!1};
MO.MUiEditValue=function(a){a=MO.Class.inherits(this,a,MO.MUiTextFormator);a._statusEditable=!0;a._statusEditing=!1;a._statusInvalid=!0;a._recordText=null;a._recordValue=null;a._currentValue=null;a.isTextChanged=MO.MUiEditValue_isTextChanged;a.isValueChanged=MO.MUiEditValue_isValueChanged;a.formator=MO.MUiEditValue_formator;a.get=MO.MUiEditValue_get;a.set=MO.MUiEditValue_set;a.text=MO.MUiEditValue_text;a.clearValue=MO.MUiEditValue_clearValue;a.resetValue=MO.MUiEditValue_resetValue;a.loadValue=MO.MUiEditValue_loadValue;
a.saveValue=MO.MUiEditValue_saveValue;a.recordValue=MO.MUiEditValue_recordValue;a.validValue=MO.Method.empty;a.setEditAble=MO.MUiEditValue_setEditAble;a.doFocus=MO.MUiEditValue_doFocus;a.doBlur=MO.MUiEditValue_doBlur;return a};MO.MUiEditValue_isTextChanged=function(){var a=this.text();return MO.Lang.String.equals(this._recordText,a)};MO.MUiEditValue_isValueChanged=function(){var a=this.get();return MO.Lang.String.equals(this._recordValue,a)};MO.MUiEditValue_formator=function(){return this};
MO.MUiEditValue_get=function(){throw new MO.TError("Unsupport method.");};MO.MUiEditValue_set=function(a){throw new MO.TError("Unsupport method.");};MO.MUiEditValue_text=function(){return this.get()};MO.MUiEditValue_clearValue=function(){this._dataValue=MO.Lang.String.EMPTY;this.set(MO.Lang.String.EMPTY)};MO.MUiEditValue_resetValue=function(){this._dataValue=value;this.set(value)};MO.MUiEditValue_loadValue=function(a,b){};MO.MUiEditValue_saveValue=function(a,b){};
MO.MUiEditValue_recordValue=function(){this._recordText=this.text();this._recordValue=this.get()};MO.MUiEditValue_setEditAble=function(a){this._statusEditable=a};MO.MUiEditValue_doFocus=function(){this._statusEditable&&(this._statusEditing=!0)};MO.MUiEditValue_doBlur=function(){this._statusEditable&&this._statusEditing&&(this._statusEditing=!1)};MO.MUiEditValue_oeClearValue=function(a){a=this.descriptor();MO.Lang.String.isEmpty(a.dataName)||(this.clearValue(),this.dataValue=this.reget());return EEventStatus.Stop};
MO.MUiEditValue_oeResetValue=function(a){a=this.descriptor();MO.Lang.String.isEmpty(a.dataName)||(this.resetValue(),this.dataValue=this.reget());return EEventStatus.Stop};MO.MUiEditValue_oeLoadValue=function(a){var b=this.descriptor();a=a.values;b=b.dataName;!MO.Lang.String.isEmpty(b)&&a.contains(b)&&(b=a.nvl(b),RControl.isInfo(b)?this.setInfoPack(b):RControl.isGroup(b)?this.setGroupPack(b):this.loadValue(a),this.recordValue(),this.dataValue=this.reget());return EEventStatus.Stop};
MO.MUiEditValue_oeSaveValue=function(a){var b=this.descriptor();MO.Lang.String.isEmpty(b.dataName)||this.saveValue(a.values);return EEventStatus.Stop};MO.MUiEditValue_oeRecordValue=function(){var a=this.descriptor();MO.Lang.String.isEmpty(a.dataName)||this.recordValue();return EEventStatus.Stop};MO.MUiEditValue_commitValue=function(){this.__commitValue=MO.Lang.String.nvl(this.reget())};MO.MUiEditValue_reget=function(){return this.descriptor().formatValue(this.text())};
MO.MUiEditValue_setInfoPack=function(a){var b=this._info;b||(b=this._info=new MO.TControlInfo);b.unpack(a);a=this.descriptor();a.setInfo(b);a!=this&&this.setInfo(b)};MO.MUiEditValue_setInfo=function(a){this.set(a.value)};MO.MUiMargin=function(a){a=MO.RClass.inherits(this,a);a._margin=MO.RClass.register(a,[new MO.APtyPadding("_margin"),new MO.AGetter("_margin")]);a.construct=MO.MUiMargin_construct;a.setMargin=MO.MUiMargin_setMargin;a.dispose=MO.MUiMargin_dispose;return a};
MO.MUiMargin_construct=function(){this._margin=new MO.SPadding};MO.MUiMargin_setMargin=function(a,b,d,e){this._margin.set(a,b,d,e)};MO.MUiMargin_dispose=function(){this._margin=MO.Lang.Object.dispose(this._margin)};MO.MUiPadding=function(a){a=MO.RClass.inherits(this,a);a._padding=MO.RClass.register(a,[new MO.APtyPadding("_padding"),new MO.AGetter("_padding")]);a.construct=MO.MUiPadding_construct;a.setPadding=MO.MUiPadding_setPadding;a.dispose=MO.MUiPadding_dispose;return a};
MO.MUiPadding_construct=function(){this._padding=new MO.SPadding};MO.MUiPadding_setPadding=function(a,b,d,e){this._padding.set(a,b,d,e)};MO.MUiPadding_dispose=function(){this._padding=MO.Lang.Object.dispose(this._padding)};MO.MUiProgress=function(a){a=MO.Class.inherits(this,a);a.oeProgress=MO.Method.virtual(a,"oeProgress");return a};
MO.MUiPropertyCheck=function(a){a=MO.Class.inherits(this,a);a._valueTrue=MO.Class.register(a,new MO.APtyString("_valueTrue"),MO.EBoolean.True);a._valueFalse=MO.Class.register(a,new MO.APtyString("_valueFalse"),MO.EBoolean.False);return a};
MO.MUiPropertyEdit=function(a){a=MO.Class.inherits(this,a);a._editCaseCd=MO.Class.register(a,new MO.APtyString("_editCaseCd"));a._editPattern=MO.Class.register(a,new MO.APtyString("_editPattern"));a._editLength=MO.Class.register(a,new MO.APtyInteger("_editLength"));a._editComplete=MO.Class.register(a,new MO.APtyBoolean("_editComplete"));a._validLengthMin=MO.Class.register(a,new MO.APtyInteger("_validLengthMin"));a._validLengthMax=MO.Class.register(a,new MO.APtyInteger("_validLengthMax"));a.oeValid=
MO.MUiPropertyEdit_oeValid;return a};MO.MUiPropertyEdit_oeValid=function(a){var b=MO.EEventStatus.Stop;if(this._visible&&this._validable){var d=this.text();if(this.validRequire&&!MO.RValidator.validRequire(this,d))return a.controls.push(this),b;this.editLength&&!MO.RValidator.validTextLength(this,d,this.editLength)&&a.controls.push(this)}return b};
MO.MUiPropertyNumber=function(a){a=MO.Class.inherits(this,a);a._valueMin=MO.Class.register(a,new MO.APtyNumber("_valueMin"));a._valueMax=MO.Class.register(a,new MO.APtyNumber("_valueMax"));a._valuePrecision=MO.Class.register(a,new MO.APtyInteger("_valuePrecision"),3);return a};
MO.MUiPropertySelect=function(a){a=MO.Class.inherits(this,a);a._editCaseCd=MO.Class.register(a,new MO.APtyString("_editCaseCd"));a._editPattern=MO.Class.register(a,new MO.APtyString("_editPattern"));a._editLength=MO.Class.register(a,new MO.APtyInteger("_editLength"));a._editComplete=MO.Class.register(a,new MO.APtyBoolean("_editComplete"));a._validLengthMin=MO.Class.register(a,new MO.APtyInteger("_validLengthMin"));a._validLengthMax=MO.Class.register(a,new MO.APtyInteger("_validLengthMax"));a.oeValid=
MO.MUiPropertySelect_oeValid;return a};MO.MUiPropertySelect_oeValid=function(a){var b=MO.EEventStatus.Stop;if(this._visible&&this._validable){var d=this.text();if(this.validRequire&&!MO.RValidator.validRequire(this,d))return a.controls.push(this),b;this.editLength&&!MO.RValidator.validTextLength(this,d,this.editLength)&&a.controls.push(this)}return b};
MO.MUiStorage=function(a){a=MO.Class.inherits(this,a);a._storageCode=null;a._storageObject=null;a.storageGet=MO.MUiStorage_storageGet;a.storageGetBoolean=MO.MUiStorage_storageGetBoolean;a.storageSet=MO.MUiStorage_storageSet;a.storageUpdate=MO.MUiStorage_storageUpdate;a.dispose=MO.MUiStorage_dispose;return a};
MO.MUiStorage_storageGet=function(a,b){if(null==a)throw new MO.TError(this,"Name is empty.");var d=this._storageObject;d||(d=MO.Window.storage(MO.EScope.Local).get(this._storageCode),d=this._storageObject=MO.Json.parse(d,Object));return d&&(d=d[a],null!=d)?d:b};MO.MUiStorage_storageGetBoolean=function(a,b){var d=this.storageGet(a,b);return MO.Lang.Boolean.parse(d)};
MO.MUiStorage_storageSet=function(a,b){if(null==a)throw new TError(this,"Name is empty.");var d=this._storageObject;d||(d=this._storageObject={});d[a]=b};MO.MUiStorage_storageUpdate=function(){var a=this._storageObject;if(a){var b=MO.Window.storage(MO.EScope.Local),a=MO.Json.toString(a);b.set(this._storageCode,a)}};MO.MUiStorage_dispose=function(){this._storageObject=this._storageCode=null};
MO.MUiTextFormator=function(a){a=MO.Class.inherits(this,a);a.formatText=MO.MUiTextFormator_formatText;a.formatValue=MO.MUiTextFormator_formatValue;return a};MO.MUiTextFormator_formatText=function(a){return a};MO.MUiTextFormator_formatValue=function(a){return a};MO.MUiValue=function(a){a=MO.Class.inherits(this,a);a.get=MO.Method.empty;a.set=MO.Method.empty;return a};MO.Ui=new function(){return this};MO.Gui=new function(){return this};MO.Dui=new function(){return this};
MO.SUiDispatchEvent=function(a,b,d){MO.SEvent.call(this);this.owner=a;this.invoke=b;this.clazz=MO.Class.name(d);this.invokeCd=MO.EEventInvoke.Unknown;this.isBefore=MO.SUiDispatchEvent_isBefore;this.isAfter=MO.SUiDispatchEvent_isAfter;this.dispose=MO.SUiDispatchEvent_dispose;this.dump=MO.SUiDispatchEvent_dump;return this};MO.SUiDispatchEvent_isBefore=function(){return this.invokeCd==MO.EEventInvoke.Before};MO.SUiDispatchEvent_isAfter=function(){return this.invokeCd==MO.EEventInvoke.After};
MO.SUiDispatchEvent_dispose=function(){this.invokeCd=this.clazz=this.invoke=this.owner=null};MO.SUiDispatchEvent_dump=function(){return MO.Class.dump(this)+":owner="+this.owner+",type="+this.type+".invoke="+MO.Method.name(this.invoke)};MO.SUiFont=function(){this.font="Microsoft YaHei";this.size=16;this.bold=!1;this.color="#FFFFFF";this.assign=MO.SUiFont_assign;this.parse=MO.SUiFont_parse;this.toString=MO.SUiFont_toString;this.dispose=MO.SUiFont_dispose;return this};
MO.SUiFont_assign=function(a){this.font=a.font;this.size=a.size;this.bold=a.bold;this.color=a.color};MO.SUiFont_parse=function(a){var b=a.toLowerCase().indexOf("bold");-1!=b&&(this.bold=!0,a=a.replace(a.substring(b,b+4),""));b=a.indexOf("#");-1!=b&&(this.color=a.substring(b,b+7),a=a.replace(this.color,""));b=a.toLowerCase().indexOf("px");-1!=b&&(b=a.substring(b-2,b+2),this.size=parseInt(b),a=a.replace(b,""));this.font=MO.RString.trim(a)};
MO.SUiFont_toString=function(){var a="";this.bold&&(a+="bold");this.size&&(""!=a&&(a+=" "),a+=this.size+"px");this.font&&(""!=a&&(a+=" "),a+=this.font);return a};MO.SUiFont_dispose=function(){this.bold=this.size=this.font=null};MO.FUiFrameDefineConsole=function(a){a=MO.Class.inherits(this,a,MO.FConsole);a._scopeCd=MO.EScope.Global;a._service="content.define.frame";a._defines=null;a.lsnsLoaded=null;a.construct=MO.FUiFrameDefineConsole_construct;a.load=MO.FUiFrameDefineConsole_load;return a};
MO.FUiFrameDefineConsole_construct=function(){this._defines=new MO.TDictionary;this.lsnsLoaded=new MO.TListeners};
MO.FUiFrameDefineConsole_load=function(a){var b=this._defines,d=b.get(a);if(d)return d;var e=new MO.TXmlDocument,d=e.root();d.set("action","query");d=d.create("Frame");d.set("name",a);for(var d=MO.RDuiService.url(this._service),e=MO.Console.find(MO.FXmlConsole).sendSync(d,e).nodes(),f=e.count(),h=0;h<f;h++){var d=e.at(h),k=d.get("name");b.set(k,d)}d=b.get(a);if(!d)throw new MO.TError(this,"Unknown frame. (name={1])",a);return d};MO.MUiMenuButton=function(a){return a=MO.Class.inherits(this,a)};
MO.MUiToolButton=function(a){return a=MO.Class.inherits(this,a)};
MO.MUiGridCell=function(a){a=MO.Class.inherits(this,a);a._grid=MO.Class.register(a,new MO.AGetSet("_grid"));a._column=MO.Class.register(a,new MO.AGetSet("_column"));a._row=MO.Class.register(a,new MO.AGetSet("_row"));a._alignCd=MO.Class.register(a,new MO.AGetSet("_alignCd"),MO.EUiAlign.Left);a._font=MO.Class.register(a,new MO.AGetSet("_font"));a._value=MO.Class.register(a,new MO.AGetSet("_value"));a.construct=MO.Method.empty;a.calculateStyle=MO.MUiGridCell_calculateStyle;a.text=MO.MUiGridCell_text;
a.setText=MO.MUiGridCell_setText;a.dispose=MO.MUiGridCell_dispose;return a};MO.MUiGridCell_calculateStyle=function(a){var b=this._row,d=this._column,e=this._grid,f=this._font;f&&(f=b.font());f||(f=d.font());f||(f=e.rowFont());a.font=f;(b=this._alignCd)||(b=d.alignCd());a.alignCd=b};MO.MUiGridCell_text=function(){return this._column.formatText(this._value)};MO.MUiGridCell_setText=function(a){a=this._column.formatValue(a);this.setValue(a)};
MO.MUiGridCell_dispose=function(){this._row=this._column=this._grid=null;this.__base.FObject.dispose.call(this)};MO.MUiGridCellCurrency=function(a){a=MO.Class.inherits(this,a);a.construct=MO.MUiGridCellCurrency_construct;a.dispose=MO.MUiGridCellCurrency_dispose;return a};MO.MUiGridCellCurrency_construct=function(){};MO.MUiGridCellCurrency_dispose=function(){};MO.MUiGridCellDate=function(a){a=MO.Class.inherits(this,a);a.construct=MO.MUiGridCellDate_construct;a.dispose=MO.MUiGridCellDate_dispose;return a};
MO.MUiGridCellDate_construct=function(){};MO.MUiGridCellDate_dispose=function(){};MO.MUiGridCellPicture=function(a){a=MO.Class.inherits(this,a);a.construct=MO.MUiGridCellPicture_construct;a.dispose=MO.MUiGridCellPicture_dispose;return a};MO.MUiGridCellPicture_construct=function(){};MO.MUiGridCellPicture_dispose=function(){};MO.MUiGridCellText=function(a){a=MO.Class.inherits(this,a);a.construct=MO.MUiGridCellText_construct;a.dispose=MO.MUiGridCellText_dispose;return a};
MO.MUiGridCellText_construct=function(){};MO.MUiGridCellText_dispose=function(){};
MO.MUiGridColumn=function(a){a=MO.Class.inherits(this,a,MO.MUiPadding,MO.MUiMargin,MO.MUiTextFormator);a._grid=MO.Class.register(a,new MO.AGetSet("_grid"));a._index=MO.Class.register(a,new MO.AGetSet("_index"),-1);a._name=MO.Class.register(a,new MO.AGetSet("_name"));a._label=MO.Class.register(a,new MO.AGetSet("_label"));a._dataName=MO.Class.register(a,new MO.AGetSet("_dataName"));a._backColor=MO.Class.register(a,new MO.AGetSet("_backColor"));a._font=MO.Class.register(a,new MO.AGetter("_font"));a._width=
MO.Class.register(a,new MO.AGetSet("_width"),100);a._realWidth=MO.Class.register(a,new MO.AGetSet("_realWidth"),100);a._alignCd=MO.Class.register(a,new MO.AGetSet("_alignCd"),MO.EUiAlign.Left);a._cellPadding=MO.Class.register(a,new MO.AGetter("_cellPadding"));a._cellClass=null;a.construct=MO.MUiGridColumn_construct;a.createCell=MO.MUiGridColumn_createCell;a.findFont=MO.MUiGridColumn_findFont;a.dispose=MO.MUiGridColumn_dispose;return a};
MO.MUiGridColumn_construct=function(){this.__base.MUiPadding.construct.call(this);this.__base.MUiMargin.construct.call(this);this._cellPadding=new MO.SPadding};MO.MUiGridColumn_createCell=function(a){a=MO.Class.create(MO.Runtime.nvl(a,this._cellClass));a.setGrid(this._grid);a.setColumn(this);return a};MO.MUiGridColumn_findFont=function(){var a=this._font;a||(a=this._grid.headFont());return a};
MO.MUiGridColumn_dispose=function(){this._grid=null;this._cellPadding=MO.Lang.Object.dispose(this._cellPadding);this.__base.MUiMargin.dispose.call(this);this.__base.MUiPadding.dispose.call(this)};
MO.MUiGridColumnCurrency=function(a){a=MO.Class.inherits(this,a);a._currencyPercent=MO.Class.register(a,new MO.AGetSet("_currencyPercent"),2);a._normalColor=MO.Class.register(a,new MO.AGetSet("_normalColor"),"#000000");a._lowerestColor=MO.Class.register(a,new MO.AGetSet("_lowerestColor"),"#000000");a._lowerColor=MO.Class.register(a,new MO.AGetSet("_lowerColor"),"#000000");a._highColor=MO.Class.register(a,new MO.AGetSet("_highColor"),"#000000");a._highestColor=MO.Class.register(a,new MO.AGetSet("_highestColor"),
"#000000");a._negativeColor=MO.Class.register(a,new MO.AGetSet("_negativeColor"),"#000000");a.construct=MO.MUiGridColumnCurrency_construct;a.formatText=MO.MUiGridColumnCurrency_formatText;a.dispose=MO.MUiGridColumnCurrency_dispose;return a};MO.MUiGridColumnCurrency_construct=function(){};MO.MUiGridColumnCurrency_formatText=function(a){return MO.Lang.Float.format(MO.Runtime.nvl(a,0),null,null,this._currencyPercent,"0")};MO.MUiGridColumnCurrency_dispose=function(){};
MO.MUiGridColumnDate=function(a){a=MO.Class.inherits(this,a);a._dateFormat=MO.Class.register(a,new MO.AGetSet("_dateFormat"),"YYYY/MM/DD HH24:MI:SS");a._dateValue=null;a.construct=MO.MUiGridColumnDate_construct;a.formatText=MO.MUiGridColumnDate_formatText;a.dispose=MO.MUiGridColumnDate_dispose;return a};MO.MUiGridColumnDate_construct=function(){this._dateValue=new MO.TDate};MO.MUiGridColumnDate_formatText=function(a){var b=this._dateValue;b.parse(a);return b.format(this._dateFormat)};
MO.MUiGridColumnDate_dispose=function(){this._dateValue=MO.Lang.Object.dispose(this._dateValue)};MO.MUiGridColumnText=function(a){a=MO.Class.inherits(this,a);a._textAlign=MO.Class.register(a,new MO.AGetSet("_textAlign"),MO.EUiAlign.Center);a.construct=MO.MUiGridColumnText_construct;a.dispose=MO.MUiGridColumnText_dispose;return a};MO.MUiGridColumnText_construct=function(){};MO.MUiGridColumnText_dispose=function(){};
MO.MUiGridControl=function(a){a=MO.Class.inherits(this,a);a._displayHead=MO.Class.register(a,new MO.AGetSet("_displayHead"),!0);a._displayFooter=MO.Class.register(a,new MO.AGetSet("_displayFooter"),!0);a._displayCount=MO.Class.register(a,new MO.AGetSet("_displayCount"),20);a._columns=MO.Class.register(a,new MO.AGetter("_columns"));a._headFont=MO.Class.register(a,new MO.AGetter("_headFont"));a._headBackColor=MO.Class.register(a,new MO.AGetSet("_headBackColor"),"#000000");a._headHeight=MO.Class.register(a,
new MO.AGetSet("_headHeight"),32);a._rowClass=MO.FUiGridRow;a._rowFont=MO.Class.register(a,new MO.AGetter("_rowFont"));a._rowHeight=MO.Class.register(a,new MO.AGetSet("_rowHeight"),28);a._rowLimitCount=MO.Class.register(a,new MO.AGetter("_rowLimitCount"),0);a._rows=MO.Class.register(a,new MO.AGetter("_rows"));a._rowPool=null;a._focusRow=null;a._focusCell=null;a.construct=MO.MUiGridControl_construct;a.createRow=MO.MUiGridControl_createRow;a.allocRow=MO.MUiGridControl_allocRow;a.freeRow=MO.MUiGridControl_freeRow;
a.pushColumn=MO.MUiGridControl_pushColumn;a.pushRow=MO.MUiGridControl_pushRow;a.clearRows=MO.MUiGridControl_clearRows;a.dispose=MO.MUiGridControl_dispose;return a};MO.MUiGridControl_construct=function(){this._columns=new MO.TDictionary;this._headFont=new MO.SUiFont;this._rows=new MO.TObjects;this._rowFont=new MO.SUiFont;this._rowPool=MO.Class.create(MO.FObjectPool)};
MO.MUiGridControl_createRow=function(a){a=MO.Class.create(MO.Runtime.nvl(a,this._rowClass));a.setGrid(this);for(var b=this._columns,d=b.count(),e=0;e<d;e++){var f=b.at(e).createCell();a.pushCell(f)}return a};MO.MUiGridControl_allocRow=function(a){var b=null,b=this._rowPool;return b=b.hasFree()?b.alloc():this.createRow(a)};MO.MUiGridControl_freeRow=function(a){this._rowPool.free(a)};
MO.MUiGridControl_pushColumn=function(a){var b=this._columns,d=a.name();a.setGrid(this);a.setIndex(b.count());b.set(d,a)};MO.MUiGridControl_pushRow=function(a){a.setGrid(this);this._rows.push(a)};MO.MUiGridControl_clearRows=function(){for(var a=this._rows,b=a.count(),d=0;d<b;d++){var e=a.at(d);this.freeRow(e)}a.clear()};
MO.MUiGridControl_dispose=function(){this._columns=MO.Lang.Object.dispose(this._columns);this._rowClass=null;this._rowPool=MO.Lang.Object.dispose(this._rowPool);this._rows=MO.Lang.Object.dispose(this._rows);this._rowFont=this._focusCell=this._focusRow=null};
MO.MUiGridRow=function(a){a=MO.Class.inherits(this,a,MO.FObject);a._grid=MO.Class.register(a,new MO.AGetSet("_grid"));a._cells=MO.Class.register(a,new MO.AGetter("_cells"));a._font=MO.Class.register(a,new MO.AGetSet("_font"));a._height=MO.Class.register(a,new MO.AGetSet("_height"),28);a.construct=MO.MUiGridRow_construct;a.findCell=MO.MUiGridRow_findCell;a.pushCell=MO.MUiGridRow_pushCell;a.get=MO.MUiGridRow_get;a.set=MO.MUiGridRow_set;a.dispose=MO.MUiGridRow_dispose};
MO.MUiGridRow_construct=function(){this.__base.FObject.construct.call(this);this._cells=new MO.TDictionary};MO.MUiGridRow_findCell=function(a){return this._cells.get(a)};MO.MUiGridRow_pushCell=function(a){a.setRow(this);var b=a.column().dataName();this._cells.set(b,a)};MO.MUiGridRow_get=function(a,b){return this._cells.get(a).value(b)};MO.MUiGridRow_set=function(a,b){return this._cells.get(a).setValue(b)};
MO.MUiGridRow_dispose=function(){this._grid=null;this._cells=MO.Lang.Object.dispose(this._cells);this.__base.FObject.dispose.call(this)};MO.SUiGridCellStyle=function(){this.font=this.alignCd=null;this.dispose=MO.SUiGridCellStyle_dispose;return this};MO.SUiGridCellStyle_dispose=function(){this.font=this.alignCd=null};MO.EApplicationConstant=new function(){this.SessionCode="mo-session-id";this.Resource="resource";return this};
MO.MFrameProcessor=function(a){a=MO.Class.inherits(this,a);a._readyLoader=MO.Class.register(a,new MO.AGetter("_readyLoader"));a._eventEnterFrame=null;a._enterFrameListeners=MO.Class.register(a,new MO.AListener("_enterFrameListeners",MO.EEvent.EnterFrame));a._eventLeaveFrame=null;a._leaveFrameListeners=MO.Class.register(a,new MO.AListener("_leaveFrameListeners",MO.EEvent.LeaveFrame));a.onProcessReady=MO.Method.empty;a.construct=MO.MFrameProcessor_construct;a.dispose=MO.MFrameProcessor_dispose;return a};
MO.MFrameProcessor_construct=function(){(this._readyLoader=MO.Class.create(MO.FReadyLoader)).addChangeListener(this,this.onProcessReady);this._eventEnterFrame=new MO.SEvent;this._eventLeaveFrame=new MO.SEvent};MO.MFrameProcessor_dispose=function(){this._readyLoader=MO.Lang.Object.dispose(this._readyLoader);this._eventEnterFrame=MO.Lang.Object.dispose(this._eventEnterFrame);this._eventLeaveFrame=MO.Lang.Object.dispose(this._eventLeaveFrame)};
MO.FApplication=function(a){a=MO.Class.inherits(this,a,MO.FObject,MO.MListener,MO.MGraphicObject,MO.MEventDispatcher,MO.MFrameProcessor);a._sessionId=MO.Class.register(a,new MO.AGetSet("_sessionId"));a._activeChapter=MO.Class.register(a,new MO.AGetter("_activeChapter"));a._chapters=MO.Class.register(a,new MO.AGetter("_chapters"));a.onProcessReady=MO.FApplication_onProcessReady;a.onProcess=MO.FApplication_onProcess;a.construct=MO.FApplication_construct;a.setup=MO.Method.empty;a.findSessionId=MO.FApplication_findSessionId;
a.registerChapter=MO.FApplication_registerChapter;a.unregisterChapter=MO.FApplication_unregisterChapter;a.selectChapter=MO.FApplication_selectChapter;a.selectChapterByCode=MO.FApplication_selectChapterByCode;a.processResize=MO.FApplication_processResize;a.processEvent=MO.FApplication_processEvent;a.process=MO.FApplication_process;a.dispose=MO.FApplication_dispose;return a};MO.FApplication_onProcessReady=function(a){};MO.FApplication_onProcess=function(a){(a=this._activeChapter)&&a.process()};
MO.FApplication_construct=function(){this.__base.FObject.construct.call(this);this.__base.MFrameProcessor.construct.call(this);this._sessionId=MO.Window.cookie(MO.EApplicationConstant.SessionCode);this._chapters=new MO.TDictionary};MO.FApplication_findSessionId=function(){return this._sessionId};MO.FApplication_registerChapter=function(a){var b=a.code();a.setApplication(this);this._chapters.set(b,a)};MO.FApplication_unregisterChapter=function(a){a=a.code();this._chapters.set(a,null)};
MO.FApplication_selectChapter=function(a){if(this._activeChapter!=a){var b=this._activeChapter;b&&(b.deactive(),this._activeChapter=null);a&&(a.active(),this._activeChapter=a)}};MO.FApplication_selectChapterByCode=function(a){a=this._chapters.get(a);this.selectChapter(a);return a};MO.FApplication_processResize=function(){};MO.FApplication_processEvent=function(a){this.dispatcherEvent(a);var b=this._activeChapter;b&&b.processEvent(a)};
MO.FApplication_process=function(){this._readyLoader.testReady()&&(this.processEnterFrameListener(this._eventEnterFrame),this.onProcess(),this.processLeaveFrameListener(this._eventLeaveFrame))};MO.FApplication_dispose=function(){this._activeChapter=null;this._chapters=MO.Lang.Object.dispose(this._chapters,!0);this.__base.MFrameProcessor.dispose.call(this);this.__base.MListener.dispose.call(this);this.__base.FObject.dispose.call(this)};
MO.FChapter=function(a){a=MO.Class.inherits(this,a,MO.FObject,MO.MListener,MO.MGraphicObject,MO.MEventDispatcher,MO.MFrameProcessor);a._code=MO.Class.register(a,new MO.AGetSet("_code"));a._application=MO.Class.register(a,new MO.AGetSet("_application"));a._scenes=MO.Class.register(a,new MO.AGetter("_scenes"));a._activeScene=MO.Class.register(a,new MO.AGetter("_activeScene"));a._statusSetup=!1;a._statusActive=!1;a.onProcessReady=MO.FChapter_onProcessReady;a.construct=MO.FChapter_construct;a.registerScene=
MO.FChapter_registerScene;a.unregisterScene=MO.FChapter_unregisterScene;a.createScene=MO.Method.empty;a.selectScene=MO.FChapter_selectScene;a.selectSceneByCode=MO.FChapter_selectSceneByCode;a.setup=MO.Method.empty;a.active=MO.FChapter_active;a.deactive=MO.FChapter_deactive;a.processEvent=MO.FChapter_processEvent;a.process=MO.FChapter_process;a.dispose=MO.FChapter_dispose;return a};MO.FChapter_onProcessReady=function(a){};
MO.FChapter_construct=function(){this.__base.FObject.construct.call(this);this.__base.MFrameProcessor.construct.call(this);this._scenes=new MO.TDictionary};MO.FChapter_registerScene=function(a){var b=a.code();a.setApplication(this._application);a.setChapter(this);this._scenes.set(b,a)};MO.FChapter_unregisterScene=function(a){a=a.code();this._scenes.set(a,null)};
MO.FChapter_selectScene=function(a){if(this._activeScene!=a){var b=this._activeScene;b&&(b.deactive(),this._activeScene=null);a&&(a.active(),this._activeScene=a)}};MO.FChapter_selectSceneByCode=function(a){var b=this._scenes.get(a);null==b&&(b=this.createScene(a),this.registerScene(b));this.selectScene(b);return b};MO.FChapter_active=function(){this._statusSetup||(this.setup(),this._statusSetup=!0);this._statusActive=!0};MO.FChapter_deactive=function(){this._statusActive=!1};
MO.FChapter_processEvent=function(a){this.dispatcherEvent(a);var b=this._activeScene;b&&b.processEvent(a)};MO.FChapter_process=function(){if(this._readyLoader.testReady()&&this._statusActive){this.processEnterFrameListener(this._eventEnterFrame);var a=this._activeScene;a&&a.visible()&&a.process();this.processLeaveFrameListener(this._eventLeaveFrame)}};
MO.FChapter_dispose=function(){this._scenes=MO.Lang.Object.dispose(this._scenes);this.__base.MFrameProcessor.dispose.call(this);this.__base.MListener.dispose.call(this);this.__base.FObject.dispose.call(this)};
MO.FGuiApplication=function(a){a=MO.Class.inherits(this,a,MO.FApplication);a._canvas=MO.Class.register(a,new MO.AGetter("_canvas"));a._manager=MO.Class.register(a,new MO.AGetter("_manager"));a._desktop=MO.Class.register(a,new MO.AGetter("_desktop"));a.construct=MO.FGuiApplication_construct;a.setup=MO.FGuiApplication_setup;a.process=MO.FGuiApplication_process;a.dispose=MO.FGuiApplication_dispose;return a};
MO.FGuiApplication_construct=function(){this.__base.FApplication.construct.call(this);this._chapters=new MO.TDictionary;this._eventEnterFrame=new MO.SEvent;this._eventLeaveFrame=new MO.SEvent};MO.FGuiApplication_setup=function(a){var b=this._desktop=MO.Class.create(MO.FGuiDesktop);b.build(a);a=this._canvas=b.canvas();var d=this._manager=MO.Class.create(MO.FGuiCanvasManager);d.setDesktop(b);d.setCanvas(a)};MO.FGuiApplication_process=function(){this.__base.FApplication.process.call(this);this._manager.process()};
MO.FGuiApplication_dispose=function(){this.__base.FApplication.dispose.call(this)};MO.FGuiDesktop=function(a){a=MO.Class.inherits(this,a,MO.FDesktop);a._canvas=MO.Class.register(a,new MO.AGetter("_canvas"));a.onOperationResize=MO.FGuiDesktop_onOperationResize;a.onOperationOrientation=MO.FGuiDesktop_onOperationOrientation;a.construct=MO.FGuiDesktop_construct;a.build=MO.FGuiDesktop_build;a.resize=MO.FGuiDesktop_resize;a.dispose=MO.FGuiDesktop_dispose;return a};
MO.FGuiDesktop_onOperationResize=function(a){this.__base.FDesktop.onOperationResize.call(this,a);this.resize()};MO.FGuiDesktop_onOperationOrientation=function(){this.__base.FDesktop.onOperationOrientation.call(this,event);this.resize()};MO.FGuiDesktop_construct=function(){this.__base.FDesktop.construct.call(this);this._size.set(1920,1080);this._logicSize.set(1920,1080);this._screenSize.set(0,0)};
MO.FGuiDesktop_build=function(a){this.__base.FDesktop.build.call(this,a);var b=this._canvas=MO.RClass.create(MO.FE2dCanvas);b.setDesktop(this);b.build(a);b.setPanel(a);b._hCanvas.style.position="absolute";this.canvasRegister(b);MO.RE3dEngine.setup()};
MO.FGuiDesktop_resize=function(a,b){var d=null!=a?a:window.innerWidth,e=null!=b?b:window.innerHeight;if(!this._screenSize.equalsData(d,e)){this._screenSize.set(d,e);var f=MO.Browser.capability().pixelRatio;MO.Logger.info(this,"Change screen size. (size={1}x{2}, pixel_ratio={3})",d,e,f);var d=d*f,e=e*f,h=f=1,k=this._logicSize;MO.Browser.isOrientationHorizontal()?(f=d/k.width,h=e/k.height,this._calculateSize.set(k.width,k.height)):(f=d/k.height,h=e/k.width,this._calculateSize.set(k.height,k.width));
k=this._sizeRate=Math.min(f,h);this._logicRate.set(f,h);f>h?this._calculateRate.set(f/k,1):f<h?this._calculateRate.set(1,h/k):this._calculateRate.set(1,1);this._canvas3d.resize(d,e);f=this._canvas;f.resize(d,e);f.context().setGlobalScale(k,k)}};MO.FGuiDesktop_dispose=function(){this._canvas3d=MO.Lang.Object.dispose(this._canvas3d);this._canvas=MO.Lang.Object.dispose(this._canvas);this.__base.FDesktop.dispose.call(this)};
MO.FScene=function(a){a=MO.Class.inherits(this,a,MO.FObject,MO.MListener,MO.MGraphicObject,MO.MEventDispatcher,MO.MFrameProcessor);a._visible=MO.Class.register(a,new MO.AGetSet("_visible"),!0);a._code=MO.Class.register(a,new MO.AGetSet("_code"));a._application=MO.Class.register(a,new MO.AGetSet("_application"));a._chapter=MO.Class.register(a,new MO.AGetSet("_chapter"));a._activeStage=MO.Class.register(a,new MO.AGetSet("_activeStage"));a._statusSetup=!1;a._statusActive=!1;a.onOperationVisibility=MO.FScene_onOperationVisibility;
a.onProcessReady=MO.FScene_onProcessReady;a.onProcessBefore=MO.Method.empty;a.onProcess=MO.FScene_onProcess;a.onProcessAfter=MO.Method.empty;a.construct=MO.FScene_construct;a.setup=MO.Method.empty;a.active=MO.FScene_active;a.deactive=MO.FScene_deactive;a.processEvent=MO.FScene_processEvent;a.process=MO.FScene_process;a.dispose=MO.FScene_dispose;return a};MO.FScene_onOperationVisibility=function(a){this.__base.MEventDispatcher.onOperationVisibility.call(this,a);this._visible=a.visibility};
MO.FScene_onProcessReady=function(a){};MO.FScene_onProcess=function(){this.processEnterFrameListener(this._eventEnterFrame);this._activeStage&&this._activeStage.process();this.processLeaveFrameListener(this._eventLeaveFrame)};MO.FScene_construct=function(){this.__base.FObject.construct.call(this);this.__base.MFrameProcessor.construct.call(this)};MO.FScene_active=function(){this._statusSetup||(this.setup(),this._statusSetup=!0);this._statusActive=!0;this.processResize()};
MO.FScene_deactive=function(){this._statusActive=!1};MO.FScene_process=function(){this._readyLoader.testReady()&&this._statusActive&&(this.processEnterFrameListener(this._eventEnterFrame),this.onProcessBefore(),this.onProcess(),this._activeStage&&this._activeStage.process(),this.onProcessAfter(),this.processLeaveFrameListener(this._eventLeaveFrame))};MO.FScene_processEvent=function(a){this.dispatcherEvent(a)};
MO.FScene_dispose=function(){this.__base.MFrameProcessor.dispose.call(this);this.__base.MListener.dispose.call(this);this.__base.FObject.dispose.call(this)};MO.FTestApplication=function(a){a=MO.Class.inherits(this,a,MO.FApplication);a.setup=MO.FTestApplication_setup;return a};
MO.FTestApplication_setup=function(a){var b=new MO.TXmlNode("Configuration"),d=MO.Window.Browser.agent(),e=b.create("Browser");MO.Window.Browser.saveConfig(e);e=e.create("Desktop");e.create("Context2d");e=e.create("Context3d");a=MO.Window.Builder.create(a,"CANVAS");if(a=MO.Graphic.Context3d.createContext(MO.FWglContext,a)){var f=a.parameter("VERSION");f&&(d+="|"+f);(f=a.parameter("SHADING_LANGUAGE_VERSION"))&&(d+="|"+f);(f=a.parameter("UNMASKED_RENDERER_WEBGL"))&&(d+="|"+f);a.saveConfig(e)}b.set("identity_code",
d);MO.Console.find(MO.FServiceConsole).send("cloud.info.device","access",b)};MO.RApplication=function(){this._workspaces=new MO.TDictionary;return this};MO.RApplication.prototype.initialize=function(){MO.Window.Browser.construct();MO.Window.connect(window);MO.Window.Keyboard.construct()};MO.RApplication.prototype.findWorkspace=function(a){var b=MO.Class.name(a),d=this._workspaces,e=d.get(b);null==e&&(e=MO.Class.create(a),d.set(b,e));return e};MO.RApplication.prototype.release=function(){try{CollectGarbage()}catch(a){MO.Logger.error(a)}};
MO.RApplication=new MO.RApplication;MO.RDesktop=function(){this._application=null;this._workspaces=new MO.TDictionary;this._thread=null;this._interval=20;return this};MO.RDesktop.prototype.onProcessEvent=function(a){var b=this._application;b&&b.processEvent(a)};MO.RDesktop.prototype.onProcess=function(a){(a=this._application)&&a.process()};MO.RDesktop.prototype.application=function(){return this._application};
MO.RDesktop.prototype.initialize=function(a){MO.Window.Browser.construct();MO.Window.connect(window);MO.Window.Keyboard.construct();MO.Window.lsnsMouseDown.register(this,this.onProcessEvent);MO.Window.lsnsMouseMove.register(this,this.onProcessEvent);MO.Window.lsnsMouseUp.register(this,this.onProcessEvent);MO.Window.lsnsMouseWheel.register(this,this.onProcessEvent);MO.Window.lsnsKeyDown.register(this,this.onProcessEvent);MO.Window.lsnsKeyPress.register(this,this.onProcessEvent);MO.Window.lsnsKeyUp.register(this,
this.onProcessEvent);MO.Window.lsnsResize.register(this,this.onProcessEvent);MO.Window.lsnsVisibility.register(this,this.onProcessEvent);MO.Window.lsnsOrientation.register(this,this.onProcessEvent);var b=this._thread=MO.Class.create(MO.FThread);b.setInterval(this._interval);b.addProcessListener(this,this.process);MO.Console.find(MO.FThreadConsole).start(b);MO.Timer.setup();return MO.Application=this._application=MO.Class.create(a)};
MO.RDesktop.prototype.findWorkspace=function(a){var b=MO.Class.name(a),d=this._workspaces,e=d.get(b);null==e&&(e=MO.Class.create(a),d.set(b,e));return e};MO.RDesktop.prototype.process=function(){this.onProcess();MO.Timer.update()};MO.RDesktop.prototype.release=function(){try{CollectGarbage()}catch(a){MO.Logger.error(a)}};MO.Desktop=new MO.RDesktop;
MO.MGuiDispatcher=function(a){a=MO.Class.inherits(this,a);a.onOperationDown=MO.MGuiDispatcher_onOperationDown;a.onOperationMove=MO.MGuiDispatcher_onOperationMove;a.onOperationUp=MO.MGuiDispatcher_onOperationUp;a.onOperationResize=MO.MGuiDispatcher_onOperationResize;a.dispatcherEvent=MO.MGuiDispatcher_dispatcherEvent;return a};MO.MGuiDispatcher_onOperationDown=function(a){};MO.MGuiDispatcher_onOperationMove=function(a){};MO.MGuiDispatcher_onOperationUp=function(a){};
MO.MGuiDispatcher_onOperationResize=function(a){};MO.MGuiDispatcher_dispatcherEvent=function(a){switch(a.code){case MO.EEvent.MouseDown:this.onOperationDown(a);break;case MO.EEvent.MouseMove:this.onOperationMove(a);break;case MO.EEvent.MouseUp:this.onOperationUp(a);break;case MO.EEvent.Resize:this.onOperationResize(a);break;default:throw new MO.TError("Unknown event type.");}};
MO.MGuiLocation=function(a){a=MO.Class.inherits(this,a);a._left=MO.Class.register(a,[new MO.APtyInteger("_left"),new MO.AGetSet("_left")]);a._right=MO.Class.register(a,[new MO.APtyInteger("_right"),new MO.AGetSet("_right")]);a._top=MO.Class.register(a,[new MO.APtyInteger("_top"),new MO.AGetSet("_top")]);a._bottom=MO.Class.register(a,[new MO.APtyInteger("_bottom"),new MO.AGetSet("_bottom")]);return a};
MO.MGuiSize=function(a){a=MO.Class.inherits(this,a);a._location=MO.Class.register(a,[new MO.APtyPoint2("_location"),new MO.AGetter("_location")]);a._right=MO.Class.register(a,[new MO.APtyInteger("_right"),new MO.AGetSet("_right")],0);a._bottom=MO.Class.register(a,[new MO.APtyInteger("_bottom"),new MO.AGetSet("_bottom")],0);a._size=MO.Class.register(a,[new MO.APtySize2("_size"),new MO.AGetter("_size")]);a._scale=MO.Class.register(a,[new MO.APtySize2("_scale"),new MO.AGetter("_scale")]);a.construct=
MO.MGuiSize_construct;a.left=MO.MGuiSize_left;a.setLeft=MO.MGuiSize_setLeft;a.top=MO.MGuiSize_top;a.setTop=MO.MGuiSize_setTop;a.setLocation=MO.MGuiSize_setLocation;a.width=MO.MGuiSize_width;a.setWidth=MO.MGuiSize_setWidth;a.height=MO.MGuiSize_height;a.setHeight=MO.MGuiSize_setHeight;a.setSize=MO.MGuiSize_setSize;a.setScale=MO.MGuiSize_setScale;a.setBounds=MO.MGuiSize_setBounds;a.dispose=MO.MGuiSize_dispose;return a};
MO.MGuiSize_construct=function(){this._location=new MO.SPoint2(0,0);this._size=new MO.SSize2(128,128);this._scale=new MO.SSize2(1,1)};MO.MGuiSize_left=function(){return this._location.x};MO.MGuiSize_setLeft=function(a){this.setLocation(a,this._location.y)};MO.MGuiSize_top=function(){return this._location.y};MO.MGuiSize_setTop=function(a){this.setLocation(this._location.x,a)};MO.MGuiSize_setLocation=function(a,b){this._location.set(a,b)};MO.MGuiSize_width=function(){return this._size.width};
MO.MGuiSize_setWidth=function(a){this.setSize(a,this._size.height)};MO.MGuiSize_height=function(){return this._size.height};MO.MGuiSize_setHeight=function(a){this.setSize(this._size.width,a)};MO.MGuiSize_setSize=function(a,b){this._size.set(a,b)};MO.MGuiSize_setScale=function(a,b){this._scale.set(a,b)};MO.MGuiSize_setBounds=function(a,b,d,e){this.setLocation(a,b);this.setSize(d,e)};
MO.MGuiSize_dispose=function(){this._location=RObject.dispose(this._location);this._size=RObject.dispose(this._size);this._scale=RObject.dispose(this._scale)};MO.SGuiImage=function(){this.ready=!1;this.resource=this.bitmap=null;this.onImageLoad=MO.SGuiImage_onImageLoad;this.testReady=MO.SGuiImage_testReady;this.load=MO.SGuiImage_load;this.dispose=MO.SGuiImage_dispose;return this};MO.SGuiImage_onImageLoad=function(a){this.ready=!0};MO.SGuiImage_testReady=function(){return this.ready};
MO.SGuiImage_load=function(){this.ready=!1;var a=null;if(MO.Lang.String.startsWith(this.resource,"url:"))a=this.resource.substring(4),a=MO.Console.find(MO.FEnvironmentConsole).parse(a);else throw new MO.TError("Invalid url.");var b=this.bitmap=MO.Class.create(MO.FImage);b.addLoadListener(this,this.onImageLoad);b.loadUrl(a)};MO.SGuiImage_dispose=function(){this.bitmap=MO.Lang.Object.dispose(this.bitmap);return this};
MO.SGuiPaintEvent=function(){this.graphic=null;this.parentRectangle=new MO.SRectangle;this.rectangle=new MO.SRectangle;this.free=MO.SGuiPaintEvent_free;this.dispose=MO.SGuiPaintEvent_dispose;return this};MO.SGuiPaintEvent_free=function(){this.graphic=null;return this};MO.SGuiPaintEvent_dispose=function(){this.parentRectangle=MO.Lang.Object.dispose(this.parentRectangle);this.rectangle=MO.Lang.Object.dispose(this.rectangle);return this};
MO.SGuiUpdateEvent=function(){this.flag=!1;this.rectangle=new MO.SRectangle;this.isBefore=MO.SGuiUpdateEvent_isBefore;this.isAfter=MO.SGuiUpdateEvent_isAfter;this.dispose=MO.SGuiUpdateEvent_dispose;return this};MO.SGuiUpdateEvent_isBefore=function(){return this.flag};MO.SGuiUpdateEvent_isAfter=function(){return!this.flag};MO.SGuiUpdateEvent_dispose=function(){this.rectangle=MO.Lang.Object.dispose(this.rectangle);return this};
MO.FGuiAction=function(a){a=MO.Class.inherits(this,a,MO.FObject,MO.MListener,MO.MTimelineAction);a._controls=MO.Class.register(a,[new MO.AGetter("_controls")]);a._listenersProcess=MO.Class.register(a,new MO.AListener("_listenersProcess",MO.EEvent.Process));a._listenersComplete=MO.Class.register(a,new MO.AListener("_listenersComplete",MO.EEvent.Complete));a.construct=MO.FGuiAction_construct;a.push=MO.FGuiAction_push;a.startControl=MO.FGuiAction_startControl;a.start=MO.FGuiAction_start;a.processControl=
MO.FGuiAction_processControl;a.process=MO.FGuiAction_process;a.dispose=MO.FGuiAction_dispose;return a};MO.FGuiAction_construct=function(){this.__base.FObject.construct.call(this);this.__base.MTimelineAction.construct.call(this);this._controls=new MO.TObjects};MO.FGuiAction_push=function(a){this._controls.push(a)};MO.FGuiAction_startControl=function(a,b){};
MO.FGuiAction_start=function(a){this.__base.MTimelineAction.start.call(this);for(var b=this._controls,d=b.count(),e=0;e<d;e++){var f=b.at(e);this.startControl(a,f)}};MO.FGuiAction_processControl=function(a,b){};MO.FGuiAction_process=function(a){this.__base.MTimelineAction.process.call(this);for(var b=this._controls,d=b.count(),e=0;e<d;e++){var f=b.at(e);this.processControl(a,f)}};
MO.FGuiAction_dispose=function(){this._controls=MO.Lang.Object.dispose(this._controls);this.__base.MTimelineAction.dispose.call(this);this.__base.MListener.dispose.call(this);this.__base.FObject.dispose.call(this)};
MO.FGuiActionAlpha=function(a){a=MO.Class.inherits(this,a,MO.FGuiAction);a._alphaBegin=MO.Class.register(a,[new MO.AGetSet("_alphaBegin")],0);a._alphaEnd=MO.Class.register(a,[new MO.AGetSet("_alphaEnd")],1);a._alphaInterval=MO.Class.register(a,[new MO.AGetSet("_alphaInterval")],.1);a._alphaCurrent=0;a._eventProcess=null;a._eventFinish=null;a.construct=MO.FGuiActionAlpha_construct;a.doComplete=MO.FGuiActionAlpha_doComplete;a.startControl=MO.FGuiActionAlpha_startControl;a.processControl=MO.FGuiActionAlpha_processControl;
a.dispose=MO.FGuiActionAlpha_dispose;return a};MO.FGuiActionAlpha_construct=function(){this.__base.FGuiAction.construct.call(this);this._eventProcess=new MO.SEvent;this._eventFinish=new MO.SEvent};MO.FGuiActionAlpha_doComplete=function(){this.processCompleteListener(this._eventProcess);this._alphaCurrent=this._alphaEnd;this._statusStop=!0};MO.FGuiActionAlpha_startControl=function(a,b){this.__base.FGuiAction.startControl.call(this);this._alphaCurrent=this._alphaBegin};
MO.FGuiActionAlpha_processControl=function(a,b){this.__base.FGuiAction.processControl.call(this);this._alphaCurrent+=this._alphaInterval;0<this._alphaInterval?this._alphaCurrent>=this._alphaEnd&&this.doComplete():0>this._alphaInterval?this._alphaCurrent<=this._alphaEnd&&this.doComplete():this.doComplete();if(!this._statusStop){var d=this._eventProcess;d.alpha=this._alphaCurrent;this.processProcessListener(d)}b.doActionAlpha(this._alphaCurrent)};
MO.FGuiActionAlpha_dispose=function(){this._eventProcess=MO.Lang.Object.dispose(this._eventProcess);this._eventFinish=MO.Lang.Object.dispose(this._eventFinish);this.__base.FGuiAction.dispose.call(this)};MO.FGuiComponent=function(a){a=MO.Class.inherits(this,a,MO.FComponent,MO.MUiComponent,MO.MProperty);a.dispose=MO.FGuiComponent_dispose;return a};MO.FGuiComponent_dispose=function(){this.__base.MUiComponent.dispose.call(this);this.__base.FComponent.dispose.call(this)};
MO.FGuiContainer=function(a){a=MO.Class.inherits(this,a,MO.FGuiControl,MO.MUiContainer);a.createChild=MO.FGuiContainer_createChild;return a};MO.FGuiContainer_createChild=function(a){a=MO.RGuiControl.newInstance(a);a._parent=this;return a};
MO.FGuiControl=function(a){a=MO.Class.inherits(this,a,MO.FGuiComponent,MO.MUiControl,MO.MGraphicObject,MO.MRenderableLinker,MO.MListener,MO.MUiMargin,MO.MUiPadding,MO.MUiBorder,MO.MGuiSize);a._optionScale=MO.Class.register(a,[new MO.AGetter("_optionScale")],!0);a._alpha=MO.Class.register(a,[new MO.APtyString("_alpha"),new MO.AGetSet("_alpha")],1);a._displayOrder=MO.Class.register(a,[new MO.APtyString("_displayOrder"),new MO.AGetSet("_displayOrder")],0);a._foreColor=MO.Class.register(a,[new MO.APtyString("_foreColor"),
new MO.AGetSet("_foreColor")],"#FFFFFF");a._foreFont=MO.Class.register(a,[new MO.APtyFont("_foreFont"),new MO.AGetSet("_foreFont")]);a._backColor=MO.Class.register(a,[new MO.APtyString("_backColor"),new MO.AGetSet("_backColor")]);a._backFont=MO.Class.register(a,[new MO.APtyFont("_backFont"),new MO.AGetSet("_backFont")]);a._backResource=MO.Class.register(a,[new MO.APtyString("_backResource"),new MO.AGetSet("_backResource")]);a._backGrid=MO.Class.register(a,[new MO.APtyPadding("_backGrid"),new MO.AGetter("_backGrid")]);
a._backHoverColor=MO.Class.register(a,[new MO.APtyString("_backHoverColor"),new MO.AGetSet("_backHoverColor")]);a._backHoverResource=MO.Class.register(a,[new MO.APtyString("_backHoverResource"),new MO.AGetSet("_backHoverResource")]);a._backHoverGrid=MO.Class.register(a,[new MO.APtyPadding("_backHoverGrid"),new MO.AGetter("_backHoverGrid")]);a._manager=MO.Class.register(a,new MO.AGetSet("_manager"));a._statusReady=!1;a._statusDirty=!0;a._statusHover=!1;a._backImage=null;a._backHoverResource=null;a._clientRectangle=
MO.Class.register(a,new MO.AGetter("_clientRectangle"));a._parentRectangle=MO.Class.register(a,new MO.AGetter("_parentRectangle"));a._eventRectangle=null;a._operationDownListeners=MO.Class.register(a,new MO.AListener("_operationDownListeners",MO.EEvent.OperationDown));a._operationMoveListeners=MO.Class.register(a,new MO.AListener("_operationMoveListeners",MO.EEvent.OperationMove));a._operationUpListeners=MO.Class.register(a,new MO.AListener("_operationUpListeners",MO.EEvent.OperationUp));a.onUpdate=
MO.FGuiControl_onUpdate;a.onPaintBegin=MO.FGuiControl_onPaintBegin;a.onPaintEnd=MO.FGuiControl_onPaintEnd;a.onOperationDown=MO.FGuiControl_onOperationDown;a.onOperationMove=MO.FGuiControl_onOperationMove;a.onOperationUp=MO.FGuiControl_onOperationUp;a.onEvent=MO.FGuiControl_onEvent;a.oeInitialize=MO.FGuiControl_oeInitialize;a.oeResize=MO.FGuiControl_oeResize;a.oeUpdate=MO.FGuiControl_oeUpdate;a.construct=MO.FGuiControl_construct;a.isReady=MO.FGuiControl_isReady;a.isDirty=MO.FGuiControl_isDirty;a.setVisible=
MO.FGuiControl_setVisible;a.setSize=MO.FGuiControl_setSize;a.testReady=MO.FGuiControl_testReady;a.testDirty=MO.FGuiControl_testDirty;a.testInRange=MO.FGuiControl_testInRange;a.paint=MO.FGuiControl_paint;a.update=MO.FGuiControl_update;a.build=MO.FGuiControl_build;a.processReady=MO.FGuiControl_processReady;a.processEvent=MO.FGuiControl_processEvent;a.dirty=MO.FGuiControl_dirty;a.psPaint=MO.FGuiControl_psPaint;a.psUpdate=MO.FGuiControl_psUpdate;a.dispose=MO.FGuiControl_dispose;return a};
MO.FGuiControl_onUpdate=function(a){var b=this._components;if(b)for(var d=b.count(),e=0;e<d;e++){var f=b.at(e);if(MO.Class.isClass(f,MO.FGuiControl))f.onUpdate(a)}};
MO.FGuiControl_onPaintBegin=function(a){var b=a.graphic;a=a.rectangle;this._backColor&&b.fillRectangle(a.left,a.top,a.width,a.height,this._styleBackcolor,1);var d=null,e=null;this._statusHover?(d=this._backHoverImage,e=this._backHoverGrid):(d=this._backImage,e=this._backGrid);d&&(e&&!e.isEmpty()?b.drawGridImage(d.bitmap,a.left,a.top,a.width,a.height,e):b.drawImage(d.bitmap,a.left,a.top,a.width,a.height));this._borderOuter.valid&&b.drawBorder(a,this._borderOuter);this._borderInner.valid&&b.drawBorder(a,
this._borderInner)};MO.FGuiControl_onPaintEnd=function(a){};MO.FGuiControl_onOperationDown=function(a){a.flag&&this.processOperationDownListener(a)};MO.FGuiControl_onOperationMove=function(a){a.flag&&this.processOperationMoveListener(a)};MO.FGuiControl_onOperationUp=function(a){a.flag&&this.processOperationUpListener(a)};
MO.FGuiControl_onEvent=function(a,b){a.flag=b;switch(a.code){case MO.EEvent.MouseDown:this.onOperationDown(a);break;case MO.EEvent.MouseMove:this.onOperationMove(a);break;case MO.EEvent.MouseUp:this.onOperationUp(a);break;default:throw new TError("Unknown event type.");}};
MO.FGuiControl_oeInitialize=function(a){var b=this.__base.FGuiComponent.oeInitialize.call(this,a);a.isBefore()&&(this._backResource&&(a=this._backImage=new MO.SGuiImage,a.resource=this._backResource,a.load()),this._backHoverResource&&(a=this._backHoverImage=new MO.SGuiImage,a.resource=this._backHoverResource,a.load()));return b};MO.FGuiControl_oeResize=function(a){return MO.EEventStatus.Continue};MO.FGuiControl_oeUpdate=function(a){return MO.EEventStatus.Continue};
MO.FGuiControl_construct=function(){this.__base.FGuiComponent.construct.call(this);this.__base.MGuiSize.construct.call(this);this.__base.MUiMargin.construct.call(this);this.__base.MUiPadding.construct.call(this);this.__base.MUiBorder.construct.call(this);this._parentRectangle=new MO.SRectangle;this._clientRectangle=new MO.SRectangle;this._eventRectangle=new MO.SRectangle;this._foreFont=new MO.SUiFont;this._backFont=new MO.SUiFont};MO.FGuiControl_isReady=function(){return this._statusReady};
MO.FGuiControl_isDirty=function(){return this._statusDirty};MO.FGuiControl_setVisible=function(a){this._visible=a;(a=this._manager)&&a.dirty()};MO.FGuiControl_setSize=function(a,b){this.__base.MGuiSize.setSize.call(this,a,b);var d=this._renderable;d&&d.setSize(a,b)};MO.FGuiControl_testReady=function(){var a=this._backImage;return a&&!a.testReady()?!1:(a=this._backHoverImage)&&!a.testReady()?!1:!0};
MO.FGuiControl_testDirty=function(){var a=this._components;if(a)for(var b=a.count(),d=0;d<b;d++){var e=a.at(d);if(MO.Class.isClass(e,MO.FGuiControl)&&e.testDirty()){this._statusDirty=!0;break}}return this._statusDirty};MO.FGuiControl_testInRange=function(a,b){};
MO.FGuiControl_paint=function(a){var b=this._location,d=this._size,e=this._dockCd,f=this._anchorCd,h=a.graphic,k=a.parentRectangle,q=a.rectangle,w=a.calculateRate,x=w.width,w=w.height;this._parentRectangle.assign(k);this._eventRectangle.assign(q);var y=k.right(),z=k.bottom(),A=0,B=0,D=0,E=0,C=0,F=0,A=f&MO.EUiAnchor.Left?q.left+b.x*x:q.left+b.x,B=f&MO.EUiAnchor.Top?q.top+b.y*w:q.top+b.y,D=f&MO.EUiAnchor.Right?y-this._right*x:y-this._right,E=f&MO.EUiAnchor.Bottom?z-this._bottom*w:z-this._bottom,C=f&
MO.EUiAnchor.Left&&f&MO.EUiAnchor.Right?d.width*x:d.width,F=f&MO.EUiAnchor.Top&&f&MO.EUiAnchor.Bottom?d.height*w:d.height;if(e==MO.EUiDock.RightTop||e==MO.EUiDock.Right||e==MO.EUiDock.RightBottom)D=y-this._right*x,A=D-C;if(e==MO.EUiDock.LeftBottom||e==MO.EUiDock.Bottom||e==MO.EUiDock.RightBottom)E=z-this._bottom*w,B=E-F;f&MO.EUiAnchor.Left&&f&MO.EUiAnchor.Right?C=D-A:this._anchorCd&MO.EUiAnchor.Left?(A=y-C-this._right,C=D-A):this._anchorCd&MO.EUiAnchor.Right&&(C=y-A-this._right);f&MO.EUiAnchor.Top&&
this._anchorCd&MO.EUiAnchor.Bottom?F=E-B:this._anchorCd&MO.EUiAnchor.Top?(B=z-F-this._bottom,F=E-B):this._anchorCd&MO.EUiAnchor.Bottom&&(F=z-B-this._bottom);q.set(A,B,Math.max(C,0),Math.max(F,0));k.assign(q);this._clientRectangle.assign(q);h.store();h.setScale(this._scale.width,this._scale.height);this.onPaintBegin(a);if(b=this._components)for(d=b.count(),e=0;e<d;e++)f=b.at(e),MO.Class.isClass(f,MO.FGuiControl)&&f.paint(a);this.onPaintEnd(a);h.restore();q.assign(this._eventRectangle);k.assign(this._parentRectangle);
this._statusDirty=!1};MO.FGuiControl_update=function(){var a=this._size,b=MO.Memory.alloc(SGuiUpdateEvent);b.rectangle.set(0,0,a.width,a.height);this.onUpdate(b);MO.Memory.free(b)};MO.FGuiControl_dirty=function(){this._statusDirty=!0};MO.FGuiControl_build=function(){};MO.FGuiControl_processReady=function(){this._statusReady||(this._statusReady=this.testReady());return this._statusReady};
MO.FGuiControl_processEvent=function(a){if(this.testInRange(a.locationX,a.locationY)){this.onEvent(a,!0);var b=this._components;if(b)for(var d=b.count(),e=0;e<d&&!b.at(e).processEvent(a);e++);this.onEvent(a,!1);return!0}return!1};MO.FGuiControl_psPaint=function(a){a=new MO.SUiDispatchEvent(this,"oeParint",MO.FGuiControl);this.process(a);a.dispose()};MO.FGuiControl_psUpdate=function(){var a=new MO.SUiDispatchEvent(this,"oeUpdate",MO.FGuiControl);this.process(a);a.dispose()};
MO.FGuiControl_dispose=function(){this._backImage=MO.Lang.Object.dispose(this._backImage);this._backHoverImage=MO.Lang.Object.dispose(this._backHoverImage);this._clientRectangle=MO.Lang.Object.dispose(this._clientRectangle);this.__base.MGuiSize.dispose.call(this);this.__base.MUiBorder.dispose.call(this);this.__base.MUiPadding.dispose.call(this);this.__base.MUiMargin.dispose.call(this);this.__base.MRenderableLinker.dispose.call(this);this.__base.MGraphicObject.dispose.call(this);this.__base.MUiControl.dispose.call(this);
this.__base.FGuiComponent.dispose.call(this)};
MO.FGuiControlRenderable=function(a){a=MO.Class.inherits(this,a,MO.FE3dFaceData);a._optionFull=MO.Class.register(a,new MO.AGetSet("_optionFull"));a._control=MO.Class.register(a,new MO.AGetSet("_control"));a._graphic=null;a.construct=MO.FGuiControlRenderable_construct;a.setup=MO.FGuiControlRenderable_setup;a.setLocation=MO.FGuiControlRenderable_setLocation;a.setSize=MO.FGuiControlRenderable_setSize;a.beginDraw=MO.FGuiControlRenderable_beginDraw;a.endDraw=MO.FGuiControlRenderable_endDraw;a.dispose=
MO.FGuiControlRenderable_dispose;return a};MO.FGuiControlRenderable_construct=function(){this.__base.FE3dFaceData.construct.call(this)};MO.FGuiControlRenderable_setup=function(){this.__base.FE3dFaceData.setup.call(this);var a=this._material.info();a.effectCode="gui";a.optionAlpha=!0;a.optionDepth=!1;a.optionDouble=!0};MO.FGuiControlRenderable_setLocation=function(a,b){this._matrix.setTranslate(a,b,0)};MO.FGuiControlRenderable_setSize=function(a,b){this._size.set(a,b)};
MO.FGuiControlRenderable_beginDraw=function(){var a=this._size,b=MO.Lang.Integer.pow2(a.width),a=MO.Lang.Integer.pow2(a.height);this._adjustSize.set(b,a);this._matrix.setScale(b,a,1);return this._graphic=(this._canvas=MO.Console.find(MO.FE2dCanvasConsole).allocBySize(b,a)).context()};MO.FGuiControlRenderable_endDraw=function(){this._texture.upload(this._canvas);MO.Console.find(MO.FE2dCanvasConsole).free(this._canvas);this._graphic=this._canvas=null;this._ready=!0};
MO.FGuiControlRenderable_dispose=function(){this.__base.FE3dFaceData.dispose.call(this)};MO.FGuiFrame=function(a){return a=MO.Class.inherits(this,a,MO.FGuiContainer)};
MO.FGuiSpriteMultimage=function(a){a=MO.Class.inherits(this,a,MO.FGuiControl);a._sequenceImages=null;a._frameTime=MO.Class.register(a,new MO.AGetSet("_frameTime"));a._ready=MO.Class.register(a,new MO.AGetSet("_ready"),!1);a._imageCount=0;a._imageToLoad=0;a._lastTick=0;a._currentFrame=0;a.setup=MO.FGuiSpriteMultimage_setup;a.onPaintBegin=MO.FGuiSpriteMultimage_onPaintBegin;a.onImageLoad=MO.FGuiSpriteMultimage_onImageLoad;return a};
MO.FGuiSpriteMultimage_setup=function(a,b,d){this._imageToLoad=this._imageCount=b;for(var e=this._sequenceImages=Array(b),f=0;f<b;f++)e[f]=MO.Class.create(MO.FImage),e[f].addLoadListener(this,this.onImageLoad),e[f].loadUrl(a+f+d)};MO.FGuiSpriteMultimage_onImageLoad=function(){0==--this._imageToLoad&&(this._ready=!0,this._lastTick=MO.Timer.current(),this.dirty())};
MO.FGuiSpriteMultimage_onPaintBegin=function(a){if(this._ready){this.__base.FGuiControl.onPaintBegin.call(this,a);var b=a.graphic;a=a.rectangle;MO.Timer.current()-this._lastTick>this._frameTime&&(++this._currentFrame>this._imageCount-1&&(this._currentFrame=0),this._lastTick=MO.Timer.current());b._handle.drawImage(this._sequenceImages[this._currentFrame].image(),a.left,a.top,a.width,a.height)}};MO.RGuiColor=function(){return this};
MO.RGuiColor.prototype.makeRgbString=function(a,b){var d=a.substring(2,4),e=a.substring(4,6),f=a.substring(6,8);return"rgba("+MO.Lang.Hex.parse(d)+","+MO.Lang.Hex.parse(e)+","+MO.Lang.Hex.parse(f)+","+b+")"};MO.GuiColor=new MO.RGuiColor;MO.RGuiControl=function(){this.PREFIX="FGui";return this};
MO.RGuiControl.prototype.newInstance=function(a){var b=null;if(a){var d=b=null;if(a.constructor==String)MO.Lang.String.startsWith(a,this.PREFIX)||(b=this.PREFIX+a);else if(a.constructor==MO.TXmlNode)b=a.get("type"),MO.Lang.String.isEmpty(b)?(b=a.name(),MO.Lang.String.startsWith(b,this.PREFIX)||(b=this.PREFIX+b)):d=b;else throw new MO.TError(this,"Unknown parameter. (type={1})",a);b=MO.Class.create(b);d&&(b.__typed=!0)}if(null==b)throw new MO.TError(this,"Create instance failure. (type={1})",a);return b};
MO.RGuiControl.prototype.attachEvent=function(a,b,d,e,f){var h=null;b=a[b];if(!MO.Method.isEmpty(b)||e){var k=MO.Class.find(a.constructor).annotation(EAnnotation.Event,n),h=k.create();h.annotation=k;h.source=a;h.hSource=d;h.ohProcess=e;h.onProcess=b;h.process=MO.Dui.Event.onProcess;MO.Dui.Event.find(d).push(k.linker(),h);MO.RHtml.linkSet(d,"_plink",c);k.bind(d,f)}return h};
MO.RGuiControl.prototype.innerbuild=function(a,b,d,e){if(null!=b&&null!=d){MO.Class.isClass(b,MO.MProperty)&&b.propertyLoad(d);var f=d.get("linker");f&&a&&(a[f]=b);MO.Class.isClass(b,MO.FGuiControl);b.__typed&&(a=b);if(MO.Class.isClass(b,MO.MUiContainer)&&d.hasNode()){d=d.nodes();for(var f=d.count(),h=0;h<f;h++){var k=d.at(h),q=b.createChild(k);if(!q)throw new MO.TError("Invalid create child.");this.innerbuild(a,q,k,e);b.push(q)}}MO.Class.isClass(b,MO.FGuiControl)}};
MO.RGuiControl.prototype.build=function(a,b,d){a||(a=this.newInstance(b));this.innerbuild(a,a,b,d);return a};MO.RGuiControl.prototype.saveConfig=function(a,b){a.propertySave(b);if(a.hasComponent())for(var d=a.components(),e=d.count(),f=0;f<e;f++){var h=d.at(f),k=MO.Class.name(h);MO.Lang.String.startsWith(k,"FGui")&&(k=k.substring(4));k=b.create(k);this.saveConfig(h,k)}return b};MO.RGuiControl=new MO.RGuiControl;
MO.FGuiCanvas=function(a){a=MO.Class.inherits(this,a,MO.FE2dCanvas);a.createContext=MO.FGuiCanvas_createContext;return a};MO.FGuiCanvas_createContext=function(){return MO.Class.create(MO.FGuiCanvasContext)};MO.FGuiCanvasContext=function(a){a=MO.Class.inherits(this,a,MO.FG2dCanvasContext);a.construct=MO.FGuiCanvasContext_construct;a.drawFontText=MO.FGuiCanvasContext_drawFontText;a.dispose=MO.FGuiCanvasContext_dispose;return a};MO.FGuiCanvasContext_construct=function(){this.__base.FG2dCanvasContext.construct.call(this)};
MO.FGuiCanvasContext_drawFontText=function(a,b,d,e,f,h,k){if(!MO.Lang.String.isEmpty(a)){var q=this._handle;q.font=b.toString();q.fillStyle=b.color;var w=this.textWidth(a),x=d+.5*(f-w);b=e+.5*(h-b.size)+b.size;if(k==MO.EUiAlign.Left)q.fillText(a,d,b);else if(k==MO.EUiAlign.Right)q.fillText(a,d+(f-w),b);else if(k==MO.EUiAlign.Center)q.fillText(a,x,b);else throw new MO.TError("Invalid align type.");}};MO.FGuiCanvasContext_dispose=function(){this.__base.FG2dCanvasContext.dispose.call(this)};
MO.FGuiCanvasManager=function(a){a=MO.Class.inherits(this,a,MO.FGuiManager);a._desktop=MO.Class.register(a,new MO.AGetSet("_desktop"));a._canvas=MO.Class.register(a,new MO.AGetSet("_canvas"));a._readyControls=null;a._dirtyControls=null;a._paintEvent=null;a.onSortControl=MO.FGuiCanvasManager_onSortControl;a.construct=MO.FGuiCanvasManager_construct;a.filterByRectangle=MO.FGuiCanvasManager_filterByRectangle;a.doActionAlpha=MO.FGuiCanvasManager_doActionAlpha;a.processResize=MO.FGuiCanvasManager_processResize;
a.processControl=MO.FGuiCanvasManager_processControl;a.process=MO.FGuiCanvasManager_process;a.dispose=MO.FGuiCanvasManager_dispose;return a};MO.FGuiCanvasManager_onSortControl=function(a,b){var d=a.displayOrder(),e=b.displayOrder();return d-e};MO.FGuiCanvasManager_construct=function(){this.__base.FGuiManager.construct.call(this);this._readyControls=new MO.TObjects;this._dirtyControls=new MO.TObjects;this._paintEvent=new MO.SGuiPaintEvent};
MO.FGuiCanvasManager_filterByRectangle=function(a,b){for(var d=this._readyControls,e=d.count(),f=0;f<e;f++){var h=d.at(f),k=h.clientRectangle();b.testRectangle(k)&&(h._flagDirty||(h._flagDirty=!0,this.filterByRectangle(a,k)),h.dirty(),a.pushUnique(h))}};MO.FGuiCanvasManager_doActionAlpha=function(a){this._canvas.graphicContext().setAlpha(a);this.dirty()};MO.FGuiCanvasManager_processResize=function(a){};
MO.FGuiCanvasManager_processControl=function(a){this.__base.FGuiManager.process.call(this);var b=this._canvas.graphicContext(),d=this._desktop;d.calculateSize();var e=d.calculateRate(),d=d.virtualSize(),f=this._paintEvent;f.optionScale=!1;f.graphic=b;f.parentRectangle.set(0,0,d.width,d.height);f.rectangle.set(0,0,d.width,d.height);f.calculateRate=e;a.paint(f)};
MO.FGuiCanvasManager_process=function(){this.__base.FGuiManager.process.call(this);var a=this._canvas.graphicContext(),b=this._desktop.sizeRate();a.setGlobalScale(b,b);var d=this._readyControls;d.clear();var e=this._controls,f=e.count();if(this._visible)for(b=0;b<f;b++){var h=e.at(b);h.processReady()&&h.visible()&&(h._flagDirty=!1,d.push(h))}if(this._statusDirty){a.prepare(!0);d.sort(this.onSortControl);a=d.count();for(b=0;b<a;b++)h=d.at(b),this.processControl(h);this._statusDirty=!1}else{e=this._dirtyControls;
e.clear();f=d.count();for(b=0;b<f;b++)if(h=d.at(b),h.testDirty()){var k=h.clientRectangle();e.push(h);h._flagDirty=!0;this.filterByRectangle(e,k)}e.sort(this.onSortControl);if(d=e.count()){a.prepare(!1);for(b=0;b<d;b++)h=e.at(b),h=h.clientRectangle(),h.isEmpty()||a.clearRectangle(h);for(b=0;b<d;b++)h=e.at(b),this.processControl(h)}}};
MO.FGuiCanvasManager_dispose=function(){this._readyControls=MO.Lang.Object.dispose(this._readyControls);this._dirtyControls=MO.Lang.Object.dispose(this._dirtyControls);this._paintEvent=MO.Lang.Object.dispose(this._paintEvent);this.__base.FGuiManager.dispose.call(this)};
MO.FGuiChangeTransform=function(a){a=MO.Class.inherits(this,a,MO.FGuiTransform);a._changeCd=MO.Class.register(a,new MO.AGetSet("_changeCd"));a._interval=MO.Class.register(a,new MO.AGetSet("_interval"));a._scale=MO.Class.register(a,new MO.AGetSet("_scale"));a._sourceControl=MO.Class.register(a,new MO.AGetSet("_sourceControl"));a._targetControl=MO.Class.register(a,new MO.AGetSet("_targetControl"));a._sourceRectangle=null;a._targetRectangle=null;a._current=0;a._middleCount=100;a._endCount=200;a.construct=
MO.FGuiChangeTransform_construct;a.start=MO.FGuiChangeTransform_start;a.process=MO.FGuiChangeTransform_process;a.dispose=MO.FGuiChangeTransform_dispose;return a};MO.FGuiChangeTransform_construct=function(){this.__base.FGuiTransform.construct.call(this);this._sourceRectangle=new MO.SRectangle;this._targetRectangle=new MO.SRectangle};
MO.FGuiChangeTransform_start=function(){this.__base.FGuiTransform.start.call(this);this._current=0;var a=this._sourceControl;this._sourceRectangle.set(a.location().x,a.location().y,a.size().width,a.size().height);a=this._targetControl;this._targetRectangle.set(a.location().x,a.location().y,a.size().width,a.size().height)};
MO.FGuiChangeTransform_process=function(){var a=this._sourceControl,b=this._targetControl;if(this._current<this._middleCount){var d=this._middleCount-this._current,d=d/this._middleCount;a.size().set(this._sourceRectangle.width*d,this._sourceRectangle.height*d)}else this._current==this._middleCount?(a.setVisible(!1),b.setVisible(!0)):this._current>this._middleCount?(d=this._endCount-this._current,d/=this._middleCount,b.size().set(this._sourceRectangle.width*d,this._sourceRectangle.height*d)):this._current==
this._endCount&&(a.setLocation(this._targetRectangle.left,this._targetRectangle.top),a.setSize(this._targetRectangle.width,this._targetRectangle.height),b.setLocation(this._sourceRectangle.left,this._sourceRectangle.top),b.setSize(this._sourceRectangle.width,this._sourceRectangle.height),this._finish=!0);this._current++};MO.FGuiChangeTransform_dispose=function(){this.__base.FGuiTransform.dispose.call(this)};
MO.FGuiFrameConsole=function(a){a=MO.Class.inherits(this,a,MO.FConsole);a._scopeCd=MO.EScope.Local;a._frames=null;a.construct=MO.FGuiFrameConsole_construct;a.createFrame=MO.FGuiFrameConsole_createFrame;a.create=MO.FGuiFrameConsole_create;a.find=MO.FGuiFrameConsole_find;a.get=MO.FGuiFrameConsole_get;a.alloc=MO.FGuiFrameConsole_alloc;a.free=MO.FGuiFrameConsole_free;a.dispose=MO.FGuiFrameConsole_dispose;return a};
MO.FGuiFrameConsole_construct=function(){this.__base.FConsole.construct.call(this);this._frames=new MO.TDictionary};MO.FGuiFrameConsole_createFrame=function(a,b,d){b=MO.Console.find(MO.FGuiFrameDescribeConsole).load(d);b=MO.RGuiControl.build(null,b,null,null);b.linkGraphicContext(a);b.psInitialize();b.build();return b};MO.FGuiFrameConsole_create=function(a,b){return this.createFrame(a,null,b)};MO.FGuiFrameConsole_find=function(a){return this._frames.get(a)};
MO.FGuiFrameConsole_get=function(a,b){var d=this._frames,e=d.get(b);e||(e=this.createFrame(a,null,b),d.set(b,e));return e};MO.FGuiFrameConsole_alloc=function(a){};MO.FGuiFrameConsole_free=function(a){a.setVisible(!1);this._freeFrames.push(a)};MO.FGuiFrameConsole_dispose=function(){this._frames=MO.Lang.Object.dispose(this._frames,!0);this.__base.FConsole.construct.call(this)};
MO.FGuiFrameDescribeConsole=function(a){a=MO.Class.inherits(this,a,MO.FConsole);a._scopeCd=MO.EScope.Global;a._serviceCode="cloud.describe.frame";a._defines=MO.Class.register(a,new MO.AGetter("_defines"));a.construct=MO.FGuiFrameDescribeConsole_construct;a.load=MO.FGuiFrameDescribeConsole_load;a.dispose=MO.FGuiFrameDescribeConsole_dispose;return a};MO.FGuiFrameDescribeConsole_construct=function(){this.__base.FConsole.construct.call(this);this._defines=new MO.TDictionary};
MO.FGuiFrameDescribeConsole_load=function(a){var b=this._defines,d=b.get(a);if(d)return d;var e=new MO.TXmlDocument,d=e.root();d.set("action","query");d=d.create("Frame");d.set("name",a);for(var d=MO.Window.Browser.hostPath("/"+this._serviceCode+".ws"),e=MO.Console.find(MO.FXmlConsole).sendSync(d,e).nodes(),f=e.count(),h=0;h<f;h++){var d=e.at(h),k=d.get("name");b.set(k,d)}d=b.get(a);if(!d)throw new MO.TError(this,"Unknown frame. (name={1})",a);return d};
MO.FGuiFrameDescribeConsole_dispose=function(){this._defines=MO.Lang.Object.dispose(this._defines,!0);this.__base.FConsole.dispose.call(this)};MO.FGuiGeneralColorEffect=function(a){a=MO.Class.inherits(this,a,MO.FE3dAutomaticEffect);a._code="general.color.gui";a.drawRenderable=MO.FGuiGeneralColorEffect_drawRenderable;return a};
MO.FGuiGeneralColorEffect_drawRenderable=function(a,b){if(!MO.Class.isClass(b,MO.FGuiControlRenderable))throw new MO.TError("Invalid renderable.");var d=b.control(),e=b.adjustSize(),f=d.location(),h=d.size(),d=d.dockCd(),k=this._graphicContext,q=k.logicSize(),w=k.size(),x=k.ratio(),y=k.sizeRatio(),k=w.width*x,x=w.height*x,z=w.width*y.width,w=w.height*y.height,A=b.material();this.bindMaterial(A);A=width=height=0;if(b._optionFull)A=f.x/z*2-1,D=1-f.y/w*2,width=e.width/z*2,height=e.height/w*2;else{var B=
y.width>y.height?1:y.height/y.width;if(d==MO.EGuiDock.LeftTop||d==MO.EGuiDock.Left||d==MO.EGuiDock.LeftBottom||d==MO.EGuiDock.Fill)A=f.x/z*2-1;else if(d==MO.EGuiDock.RightTop||d==MO.EGuiDock.Right||d==MO.EGuiDock.RightBottom)A=(q.width-f.x-h.width/B)/z*2-1;else throw new MO.TError(this,"Invalid dock.");var D=0,y=y.width>y.height?1:y.height/y.width;if(d==MO.EGuiDock.LeftTop||d==MO.EGuiDock.Top||d==MO.EGuiDock.RightTop||d==MO.EGuiDock.Fill)D=1-f.y/w*2;else if(d==MO.EGuiDock.LeftBottom||d==MO.EGuiDock.Bottom||
d==MO.EGuiDock.RightBottom)D=1-(q.height-f.y-h.height/y)/w*2;else throw new MO.TError(this,"Invalid dock.");width=d==MO.EGuiDock.Fill?(q.width-f.x-h.width/B)/z*2-1-(f.x/z*2-1):e.width/k*2;height=e.height/x*2}this._program.setParameter4("vc_position",A,D,width,height);this.__base.FE3dAutomaticEffect.drawRenderable.call(this,a,b)};
MO.FGuiManager=function(a){a=MO.Class.inherits(this,a,MO.FObject,MO.MGraphicObject,MO.MEventDispatcher);a._visible=MO.Class.register(a,new MO.AGetter("_visible"),!0);a._controls=MO.Class.register(a,new MO.AGetter("_controls"));a._mainTimeline=MO.Class.register(a,new MO.AGetter("_mainTimeline"));a._transforms=MO.Class.register(a,new MO.AGetter("_transforms"));a._statusDirty=!1;a._visibleControls=null;a.construct=MO.FGuiManager_construct;a.register=MO.FGuiManager_register;a.unregister=MO.FGuiManager_unregister;
a.transformStart=MO.FGuiManager_transformStart;a.setup=MO.FGuiManager_setup;a.isDirty=MO.FGuiManager_isDirty;a.setVisible=MO.FGuiManager_setVisible;a.show=MO.FGuiManager_show;a.hide=MO.FGuiManager_hide;a.processResize=MO.FGuiManager_processResize;a.processEvent=MO.FGuiManager_processEvent;a.processTransforms=MO.FGuiManager_processTransforms;a.process=MO.FGuiManager_process;a.dirty=MO.FGuiManager_dirty;a.dispose=MO.FGuiManager_dispose;return a};
MO.FGuiManager_construct=function(){this.__base.FObject.construct.call(this);this._controls=new MO.TObjects;this._mainTimeline=MO.Class.create(MO.FMainTimeline);this._transforms=new MO.TLooper;this._visibleControls=new MO.TObjects};MO.FGuiManager_register=function(a){a.setManager(this);this._controls.push(a);this._statusDirty=!0};MO.FGuiManager_unregister=function(a){a.setManager(null);this._controls.remove(a);this._statusDirty=!0};MO.FGuiManager_transformStart=function(a){a.start();this._transforms.pushUnique(a)};
MO.FGuiManager_setup=function(){MO.Console.find(MO.FG3dEffectConsole).register("general.color.gui",MO.FGuiGeneralColorEffect)};MO.FGuiManager_isDirty=function(){return this._statusDirty};MO.FGuiManager_setVisible=function(a){this._visible=a;this._statusDirty=!0};MO.FGuiManager_show=function(){this.setVisible(!0)};MO.FGuiManager_hide=function(){this.setVisible(!1)};MO.FGuiManager_processResize=function(a){a=this._controls;for(var b=a.count(),d=0;d<b;d++)a.at(d).psResize()};
MO.FGuiManager_processEvent=function(a){this.dispatcherEvent(a)};MO.FGuiManager_processTransforms=function(){var a=this._transforms;for(a.record();a.next();){var b=a.current();b.process();b.isFinish()&&a.removeCurrent()}};MO.FGuiManager_process=function(){for(var a=this._controls,b=a.count(),d=0;d<b;d++)a.at(d).psUpdate();this._mainTimeline.process();this.processTransforms()};MO.FGuiManager_dirty=function(){this._statusDirty=!0};
MO.FGuiManager_dispose=function(){this._controls=MO.Lang.Object.dispose(this._controls);this._mainTimeline=MO.Lang.Object.dispose(this._mainTimeline);this._transforms=MO.Lang.Object.dispose(this._transforms);this._visibleControls=MO.Lang.Object.dispose(this._visibleControls);this.__base.FObject.dispose.call(this)};
MO.FGuiTransform=function(a){a=MO.Class.inherits(this,a,MO.FObject);a._finish=!1;a.construct=MO.FGuiTransform_construct;a.isFinish=MO.FGuiTransform_isFinish;a.start=MO.FGuiTransform_start;a.process=MO.FGuiTransform_process;a.dispose=MO.FGuiTransform_dispose;return a};MO.FGuiTransform_construct=function(){this.__base.FObject.construct.call(this)};MO.FGuiTransform_isFinish=function(){return this._finish};MO.FGuiTransform_start=function(){this._finish=!1};MO.FGuiTransform_process=function(){};
MO.FGuiTransform_dispose=function(){this.__base.FObject.dispose.call(this)};MO.FGuiButton=function(a){a=MO.Class.inherits(this,a,MO.FGuiControl);a.onPaintBegin=MO.FGuiButton_onPaintBegin;return a};MO.FGuiButton_onPaintBegin=function(a){this.__base.FGuiControl.onPaintBegin.call(this,a);var b=a.graphic;a=a.rectangle;if(this._label){this._foreFont&&b.setFont(this._foreFont);var d=b.textWidth(this._label);b.drawText(this._label,a.left+.5*a.width-.5*d,a.top+.5*a.height+3,this._foreColor)}};
MO.FGuiLabel=function(a){a=MO.Class.inherits(this,a,MO.FGuiControl);a._alignCd=MO.Class.register(a,[new MO.APtyString("_alignCd"),new MO.AGetter("_alignCd")],MO.EUiAlign.Left);a.onPaintLabel=MO.FGuiLabel_onPaintLabel;a.onPaintBegin=MO.FGuiLabel_onPaintBegin;a.setLabel=MO.FGuiLabel_setLabel;return a};
MO.FGuiLabel_onPaintLabel=function(a){this.__base.FGuiControl.onPaintBegin.call(this,a);var b=a.graphic;a=a.rectangle;this._foreFont&&b.setFont(this._foreFont);var d=b.textWidth(this._label);b.drawText(this._label,a.left+.5*a.width-.5*d,a.top+.5*a.height+3,this._foreColor)};MO.FGuiLabel_onPaintBegin=function(a){this.__base.FGuiControl.onPaintBegin.call(this,a);if(this._label)this.onPaintLabel(a)};
MO.FGuiLabel_setLabel=function(a){this._label!=a&&this.dirty();this.__base.FGuiControl.setLabel.call(this,a)};MO.FGuiPanel=function(a){return a=MO.Class.inherits(this,a,MO.FGuiControl)};MO.FGuiPicture=function(a){return a=MO.Class.inherits(this,a,MO.FGuiControl)};
MO.FGuiTimeline=function(a){a=MO.Class.inherits(this,a,MO.FGuiControl);a._timeUnit=MO.Class.register(a,new MO.AGetSet("_timeUnit"));a._startTime=MO.Class.register(a,new MO.AGetSet("_startTime"));a._endTime=MO.Class.register(a,new MO.AGetSet("_endTime"));a._degreeTime=MO.Class.register(a,new MO.AGetSet("_degreeTime"));a._progress=MO.Class.register(a,new MO.AGetSet("_progress"));a._unitms=MO.Class.register(a,new MO.AGetSet("_unitms"),864E5);a._degreeLineHeight=MO.Class.register(a,new MO.AGetSet("_degreeLineHeight"),
15);a._degreeLineWidth=MO.Class.register(a,new MO.AGetSet("_degreeLineWidth"),3);a._mainLineWidth=MO.Class.register(a,new MO.AGetSet("_mainLineWidth"),5);a._triangleWidth=MO.Class.register(a,new MO.AGetSet("_triangleWidth"),10);a._triangleHeight=MO.Class.register(a,new MO.AGetSet("_triangleHeight"),12);a._decoLineGap=MO.Class.register(a,new MO.AGetSet("_decoLineGap"),10);a._decoLineWidth=MO.Class.register(a,new MO.AGetSet("_decoLineWidth"),40);a._timeFontColor="#FFFFFF";a._cursorFontColor="#FFFFFF";
a._listenersDataChanged=MO.Class.register(a,new MO.AListener("_listenersDataChanged",MO.EEvent.DataChanged));a.onPaintBegin=MO.FGuiTimeline_onPaintBegin;a.onOperationDown=MO.FGuiTimeline_onOperationDown;return a};
MO.FGuiTimeline_onPaintBegin=function(a){this.__base.FGuiControl.onPaintBegin.call(this,a);var b=a.graphic,d=a.rectangle;a=d.top+d.height-50;var e=d.left+5,d=d.left+d.width-5,f=this.triangleWidth()+this.decoLineGap();b.drawTriangle(e,a,e+this.triangleWidth(),a+this.triangleHeight()/2,e+this.triangleWidth(),a-this.triangleHeight()/2,1,"#FFFFFF","#FFFFFF");b.drawTriangle(d,a,d-this.triangleWidth(),a+this.triangleHeight()/2,d-this.triangleWidth(),a-this.triangleHeight()/2,1,"#FFFFFF","#FFFFFF");b.drawLine(e+
f,a,e+f+this.decoLineWidth(),a,"#25E8FF",this._mainLineWidth);b.drawLine(d-f,a,d-f-this.decoLineWidth(),a,"#25E8FF",this._mainLineWidth);e=e+f+this.decoLineWidth();d=d-f-this.decoLineWidth();b.drawLine(e,a,d,a,"#25E8FF",this._mainLineWidth);var f=this.startTime(),h=this.endTime(),k=this.degreeTime(),q,w;switch(this.timeUnit()){case MO.EUiTimeUnit.Second:w=f.format("MI:SS.MISS");q=k.format("MI:SS.MISS");break;case MO.EUiTimeUnit.Minute:w=f.format("HH24:MI:SS");q=k.format("HH24:MI:SS");break;case MO.EUiTimeUnit.Hour:w=
f.format("HH24:MI");q=k.format("HH24:MI");break;case MO.EUiTimeUnit.Day:w=f.format("MM-DD:HH24");q=k.format("MM-DD:HH24");break;case MO.EUiTimeUnit.Week:w=f.format("MM-DD");q=k.format("MM-DD");break;case MO.EUiTimeUnit.Month:w=f.format("YYYY-MM-DD");q=k.format("YYYY-MM-DD");break;case MO.EUiTimeUnit.Year:w=f.format("YYYY-MM");q=k.format("YYYY-MM");break;default:return}var x=h.date.getTime()-f.date.getTime(),y=k.date.getTime()-f.date.getTime()+this.unitms()*this.progress(),y=e+y/x*(d-e);b.drawTriangle(y,
a+2,y-this.triangleWidth()/2,a+2+this.triangleHeight(),y+this.triangleWidth()/2,a+2+this.triangleHeight(),1,"#FFFFFF","#FFFFFF");b.setFont("bold 22px Microsoft YaHei");var z=b.textWidth(q);b.drawText(q,y-z/2,a+50,this._cursorFontColor);q=f.date.getTime();b.drawLine(e,a-this.degreeLineHeight(),e,a,"#FFFFFF",this._degreeLineWidth);y=b.textWidth(w);b.drawText(w,e-y/2,a+50,this._cursorFontColor);switch(this.timeUnit()){case MO.EUiTimeUnit.Second:f.addMseconds(1E3);f.parseAuto(f.format("YYYYMMDDHH24MISS"));
break;case MO.EUiTimeUnit.Minute:f.addMseconds(6E4);f.parseAuto(f.format("YYYYMMDDHH24MISS"));break;case MO.EUiTimeUnit.Hour:f.addMseconds(36E5);f.parseAuto(f.format("YYYYMMDDHH24MISS"));break;case MO.EUiTimeUnit.Day:f.addDay(1);f.parseAuto(f.format("YYYYMMDD"));break;case MO.EUiTimeUnit.Week:f.addDay(7);f.parseAuto(f.format("YYYYMMDD"));break;case MO.EUiTimeUnit.Month:f.addMonth(1);f.parseAuto(f.format("YYYYMM"));break;case MO.EUiTimeUnit.Year:f.addYear(1);f.parseAuto(f.format("YYYY"));break;default:return}for(y=
0;!f.isAfter(k);){w=f.date.getTime()-q;z=e+w/x*(d-e);b.drawLine(z,a-this.degreeLineHeight(),z,a,"#FFFFFF",this._degreeLineWidth);switch(this.timeUnit()){case MO.EUiTimeUnit.Second:w=f.format("MI:SS");f.addMseconds(1E3);break;case MO.EUiTimeUnit.Minute:w=f.format("HH24:MI");f.addMseconds(6E4);break;case MO.EUiTimeUnit.Hour:w=f.format("HH24:00");f.addMseconds(36E5);break;case MO.EUiTimeUnit.Day:w=f.format("MM-DD");f.addDay(1);break;case MO.EUiTimeUnit.Week:w=f.format("MM-DD");f.addDay(7);break;case MO.EUiTimeUnit.Month:w=
f.format("YYYY-MM");f.addMonth(1);break;case MO.EUiTimeUnit.Year:w=f.format("YYYY");f.addYear(1);break;default:return}b.setFont("bold 22px Microsoft YaHei");var A=b.textWidth(w),y=a+26;b.drawText(w,z-A/2,y,this._timeFontColor)}w=h.date.getTime()-q;z=e+w/x*(d-e);b.drawLine(z,a-this.degreeLineHeight(),z,a,this._cursorFontColor,this._degreeLineWidth);f.date.setTime(q);f.refresh()};
MO.FGuiTimeline_onOperationDown=function(a){if(a.flag){this.__base.FGuiControl.onOperationDown.call(this,a);var b=a.rectangle,d=b.top+b.height,e=b.left+5,b=b.left+b.width-5,f=this.triangleWidth()+this.decoLineGap(),e=e+f+this.decoLineWidth(),b=b-f-this.decoLineWidth(),f=a.locationX;a.locationY>d-30&&f>e&&f<b&&(a=(f-e)/(b-e),a=this.startTime().date.getTime()+(this.endTime().date.getTime()-this.startTime().date.getTime())*a,d=MO.Memory.alloc(SEvent),d.sender=this,e=MO.Memory.alloc(TDate),e.date.setTime(a),
e.refresh(),d.date=e.parseAuto(e.format("YYYYMMDD")),this.processDataChangedListener(d),MO.Memory.free(d))}};MO.SGuiGridPaintContext=function(){this.graphic=null;this.rectangle=new MO.SRectangle;this.style=new MO.SUiGridCellStyle;this.dispose=MO.SGuiGridPaintContext_dispose;return this};MO.SGuiGridPaintContext_dispose=function(){this.graphic=null;this.rectangle=MO.Lang.Object.dispose(this.rectangle);this.style=MO.Lang.Object.dispose(this.style)};
MO.FGuiGridCell=function(a){a=MO.Class.inherits(this,a,MO.FObject,MO.MUiGridCell);a.onPaint=MO.FGuiGridCell_onPaint;a.construct=MO.FGuiGridCell_construct;a.testReady=MO.Method.emptyTrue;a.draw=MO.Method.empty;a.dispose=MO.FGuiGridCell_dispose;return a};MO.FGuiGridCell_construct=function(){this.__base.FObject.construct.call(this);this.__base.MUiGridCell.construct.call(this)};MO.FGuiGridCell_dispose=function(){this.__base.MUiGridCell.dispose.call(this);this.__base.FObject.dispose.call(this)};
MO.FGuiGridCellBigNumber=function(a){a=MO.Class.inherits(this,a,MO.FGuiGridCell,MO.MUiGridCellCurrency);a._fontColor=null;a._numberFont=null;a.construct=MO.FGuiGridCellBigNumber_construct;a.formatText=MO.FGuiGridCellBigNumber_formatText;a.draw=MO.FGuiGridCellBigNumber_draw;a.dispose=MO.FGuiGridCellBigNumber_dispose;return a};MO.FGuiGridCellBigNumber_construct=function(){this.__base.FGuiGridCell.construct.call(this);this.__base.MUiGridCellCurrency.construct.call(this);this._numberFont=new MO.SUiFont};
MO.FGuiGridCellBigNumber_formatText=function(a){return this.__base.MUiGridColumnDate.formatText.call(this,a)};
MO.FGuiGridCellBigNumber_draw=function(a){var b=a.graphic,d=a.rectangle,e=a.style.font;a=d.left;var f=d.top,h=d.width,d=d.height,k=this._column,q=k.cellPadding(),w=this.value(),x=this.text(),y=x.length,z=this._numberFont;z.assign(e);e=h-q.right;0<=w?7<y?(k.highColor(),h=x.substring(0,x.length-11),x=x.substring(x.length-11,x.length-7)+"."+x.substring(x.length-7,x.length-5),b.textWidth(h),w=b.textWidth(x),z.color=k.highColor(),b.drawFontText(h,z,a,f,e-w,d,MO.EUiAlign.Right),z.color=k.normalColor(),
b.drawFontText(x,z,a,f,e,d,MO.EUiAlign.Right)):5<y?(x="0."+x.substring(x.length-7,x.length-5),z.color=k.normalColor(),b.drawFontText(x,z,a,f,e,d,MO.EUiAlign.Right)):(z.color=k.normalColor(),b.drawFontText("0.00",z,a,f,e,d,MO.EUiAlign.Right)):0>w&&(z.color=k.negativeColor(),b.drawFontText(x,z,a,f,e,d,MO.EUiAlign.Right))};MO.FGuiGridCellBigNumber_dispose=function(){this._numberFont=MO.Lang.Object.dispose(this._numberFont);this.__base.MUiGridCellCurrency.dispose.call(this);this.__base.FGuiGridCell.dispose.call(this)};
MO.FGuiGridCellCurrency=function(a){a=MO.Class.inherits(this,a,MO.FGuiGridCell,MO.MUiGridCellCurrency);a._fontColor=null;a._numberFont=null;a.construct=MO.FGuiGridCellCurrency_construct;a.formatText=MO.FGuiGridCellCurrency_formatText;a.draw=MO.FGuiGridCellCurrency_draw;a.dispose=MO.FGuiGridCellCurrency_dispose;return a};MO.FGuiGridCellCurrency_construct=function(){this.__base.FGuiGridCell.construct.call(this);this.__base.MUiGridCellCurrency.construct.call(this);this._numberFont=new MO.SUiFont};
MO.FGuiGridCellCurrency_formatText=function(a){return this.__base.MUiGridColumnDate.formatText.call(this,a)};
MO.FGuiGridCellCurrency_draw=function(a){var b=a.graphic,d=a.rectangle,e=a.style.font;a=d.left;var f=d.top,h=d.width,d=d.height,k=this._column,q=k.cellPadding(),w=this.value(),x=this.text(),y=x.length,z=this._numberFont;z.assign(e);e=h-q.right;0<=w?(11<y?(w=null,w=x.substring(0,x.length-11),h=x.substring(y-11,y-7),x=x.substring(y-7,y),b.textWidth(w),q=b.textWidth(h),y=b.textWidth(x),z.color=k.highestColor(),b.drawFontText(w,z,a,f,e-q-y,d,MO.EUiAlign.Right),z.color=k.highColor(),b.drawFontText(h,z,
a,f,e-y,d,MO.EUiAlign.Right)):7<y&&(w=9<y?k.highColor():k.lowerColor(),h=x.substring(0,y-7),x=x.substring(y-7,y),b.textWidth(h),y=b.textWidth(x),z.color=w,b.drawFontText(h,z,a,f,e-y,d,MO.EUiAlign.Right)),z.color=k.normalColor(),b.drawFontText(x,z,a,f,e,d,MO.EUiAlign.Right)):0>w&&(z.color=k.negativeColor(),b.drawFontText(x,z,a,f,e,d,MO.EUiAlign.Right))};
MO.FGuiGridCellCurrency_dispose=function(){this._numberFont=MO.Lang.Object.dispose(this._numberFont);this.__base.MUiGridCellCurrency.dispose.call(this);this.__base.FGuiGridCell.dispose.call(this)};MO.FGuiGridCellDate=function(a){a=MO.Class.inherits(this,a,MO.FGuiGridCell,MO.MUiGridCellDate);a.construct=MO.FGuiGridCellDate_construct;a.draw=MO.FGuiGridCellDate_draw;a.dispose=MO.FGuiGridCellDate_dispose;return a};
MO.FGuiGridCellDate_construct=function(){this.__base.FGuiGridCell.construct.call(this);this.__base.MUiGridCellDate.construct.call(this)};MO.FGuiGridCellDate_draw=function(a){var b=a.graphic,d=a.rectangle;a=a.style.font;var e=this.text();b.drawFontText(e,a,d.left,d.top,d.width,d.height,MO.EUiAlign.Center)};MO.FGuiGridCellDate_dispose=function(){this.__base.MUiGridCellDate.dispose.call(this);this.__base.FGuiGridCell.dispose.call(this)};
MO.FGuiGridCellPicture=function(a){a=MO.Class.inherits(this,a,MO.FGuiGridCell,MO.MUiGridCellPicture);a._image=null;a.construct=MO.FGuiGridCellPicture_construct;a.testReady=MO.FGuiGridCellPicture_testReady;a.setValue=MO.FGuiGridCellPicture_setValue;a.draw=MO.FGuiGridCellPicture_draw;a.dispose=MO.FGuiGridCellPicture_dispose;return a};MO.FGuiGridCellPicture_construct=function(){this.__base.FGuiGridCell.construct.call(this);this.__base.MUiGridCellPicture.construct.call(this)};
MO.FGuiGridCellPicture_testReady=function(){var a=this._image;return a?a.testReady():!0};MO.FGuiGridCellPicture_draw=function(a){var b=a.graphic;a=a.rectangle;this.text();var d=this._image;if(d){var e=d.size(),f=e.width,e=e.height,h=a.height,k=this._column._align,q=0,w=a.top;k==MO.EUiAlign.Left?q=a.left:k==MO.EUiAlign.Center?q=a.width/2-f/2+a.left:k==MO.EUiAlign.Right&&(q=a.width/2+f/2+a.left);b.drawImage(d,q,h>=e?h/2-e/2+w+3:w-(e-h),f,e)}};
MO.FGuiGridCellPicture_setValue=function(a){this.__base.FGuiGridCell.setValue.call(this,a);a=this.text();MO.Lang.String.isEmpty(a)?this._image=null:this._image=MO.Console.find(MO.FImageConsole).load(a)};MO.FGuiGridCellPicture_dispose=function(){this.__base.MUiGridCellPicture.dispose.call(this);this.__base.FGuiGridCell.dispose.call(this)};
MO.FGuiGridCellText=function(a){a=MO.Class.inherits(this,a,MO.FGuiGridCell,MO.MUiGridCellText);a.construct=MO.FGuiGridCellText_construct;a.draw=MO.FGuiGridCellText_draw;a.dispose=MO.FGuiGridCellText_dispose;return a};MO.FGuiGridCellText_construct=function(){this.__base.FGuiGridCell.construct.call(this);this.__base.MUiGridCellText.construct.call(this)};
MO.FGuiGridCellText_draw=function(a){var b=a.graphic,d=a.rectangle;a=a.style.font;var e=this._column,f=e.cellPadding(),h=this.text(),e=this._column;b.drawFontText(h,a,d.left,d.top,d.width-f.right,d.height,e.textAlign())};MO.FGuiGridCellText_dispose=function(){this.__base.MUiGridCellText.dispose.call(this);this.__base.FGuiGridCell.dispose.call(this)};
MO.FGuiGridColumn=function(a){a=MO.Class.inherits(this,a,MO.FObject,MO.MUiGridColumn);a.construct=MO.FGuiGridColumn_construct;a.testReady=MO.Method.emptyTrue;a.draw=MO.FGuiGridColumn_draw;a.dispose=MO.FGuiGridColumn_dispose;return a};MO.FGuiGridColumn_construct=function(){this.__base.FObject.construct.call(this);this.__base.MUiGridColumn.construct.call(this)};
MO.FGuiGridColumn_draw=function(a){var b=a.graphic,d=a.rectangle,e=this._padding;a=d.left+e.left;var f=d.top+e.top,h=d.width-e.left-e.right,d=d.height-e.top-e.bottom;(e=this._backColor)||(e=this._grid.headBackColor());b.fillRectangle(a,f,h,d,e);e=this.findFont();b.drawFontText(this._label,e,a,f-3,h,d,MO.EUiAlign.Center)};MO.FGuiGridColumn_dispose=function(){this.__base.MUiGridColumn.dispose.call(this);this.__base.FObject.dispose.call(this)};
MO.FGuiGridColumnBigNumber=function(a){a=MO.Class.inherits(this,a,MO.FGuiGridColumn,MO.MUiGridColumnCurrency);a.construct=MO.FGuiGridColumnBigNumber_construct;a.formatText=MO.FGuiGridColumnBigNumber_formatText;a.dispose=MO.FGuiGridColumnBigNumber_dispose;return a};MO.FGuiGridColumnBigNumber_construct=function(){this.__base.FGuiGridColumn.construct.call(this);this.__base.MUiGridColumnCurrency.construct.call(this);this._cellClass=MO.FGuiGridCellBigNumber};
MO.FGuiGridColumnBigNumber_formatText=function(a){return this.__base.MUiGridColumnCurrency.formatText.call(this,a)};MO.FGuiGridColumnBigNumber_dispose=function(){this.__base.MUiGridColumnCurrency.dispose.call(this);this.__base.FGuiGridColumn.dispose.call(this)};
MO.FGuiGridColumnCurrency=function(a){a=MO.Class.inherits(this,a,MO.FGuiGridColumn,MO.MUiGridColumnCurrency);a.construct=MO.FGuiGridColumnCurrency_construct;a.formatText=MO.FGuiGridColumnCurrency_formatText;a.dispose=MO.FGuiGridColumnCurrency_dispose;return a};MO.FGuiGridColumnCurrency_construct=function(){this.__base.FGuiGridColumn.construct.call(this);this.__base.MUiGridColumnCurrency.construct.call(this);this._cellClass=MO.FGuiGridCellCurrency};
MO.FGuiGridColumnCurrency_formatText=function(a){return this.__base.MUiGridColumnCurrency.formatText.call(this,a)};MO.FGuiGridColumnCurrency_dispose=function(){this.__base.MUiGridColumnCurrency.dispose.call(this);this.__base.FGuiGridColumn.dispose.call(this)};MO.FGuiGridColumnDate=function(a){a=MO.Class.inherits(this,a,MO.FGuiGridColumn,MO.MUiGridColumnDate);a.construct=MO.FGuiGridColumnDate_construct;a.formatText=MO.FGuiGridColumnDate_formatText;a.dispose=MO.FGuiGridColumnDate_dispose;return a};
MO.FGuiGridColumnDate_construct=function(){this.__base.FGuiGridColumn.construct.call(this);this.__base.MUiGridColumnDate.construct.call(this);this._cellClass=MO.FGuiGridCellDate};MO.FGuiGridColumnDate_formatText=function(a){return this.__base.MUiGridColumnDate.formatText.call(this,a)};MO.FGuiGridColumnDate_dispose=function(){this.__base.MUiGridColumnDate.dispose.call(this);this.__base.FGuiGridColumn.dispose.call(this)};
MO.FGuiGridColumnPicture=function(a){a=MO.Class.inherits(this,a,MO.FGuiGridColumn,MO.MUiGridColumnText);a._align=MO.Class.register(a,new MO.AGetSet("_align"));a.construct=MO.FGuiGridColumnPicture_construct;a.dispose=MO.FGuiGridColumnPicture_dispose;return a};MO.FGuiGridColumnPicture_construct=function(){this.__base.FGuiGridColumn.construct.call(this);this.__base.MUiGridColumnText.construct.call(this);this._cellClass=MO.FGuiGridCellPicture};
MO.FGuiGridColumnPicture_dispose=function(){this.__base.MUiGridColumnText.dispose.call(this);this.__base.FGuiGridColumn.dispose.call(this)};MO.FGuiGridColumnText=function(a){a=MO.Class.inherits(this,a,MO.FGuiGridColumn,MO.MUiGridColumnText);a.construct=MO.FGuiGridColumnText_construct;a.dispose=MO.FGuiGridColumnText_dispose;return a};MO.FGuiGridColumnText_construct=function(){this.__base.FGuiGridColumn.construct.call(this);this.__base.MUiGridColumnText.construct.call(this);this._cellClass=MO.FGuiGridCellText};
MO.FGuiGridColumnText_dispose=function(){this.__base.MUiGridColumnText.dispose.call(this);this.__base.FGuiGridColumn.dispose.call(this)};
MO.FGuiGridControl=function(a){a=MO.Class.inherits(this,a,MO.FGuiControl,MO.MUiGridControl);a._optionClip=MO.Class.register(a,new MO.AGetSet("_optionClip"),!0);a._headPadding=MO.Class.register(a,new MO.AGetter("_headPadding"));a._rowScroll=0;a._rowScrollSpeed=1;a._paintContext=null;a.onPaintBegin=MO.FGuiGridControl_onPaintBegin;a.construct=MO.FGuiGridControl_construct;a.dispose=MO.FGuiGridControl_dispose;return a};
MO.FGuiGridControl_onPaintBegin=function(a){var b=!1,d=this._padding,e=this._paintContext,f=e.style,h=e.rectangle,k=a.graphic;e.graphic=k;var q=a.rectangle;a=q.left+d.left;for(var w=q.top+d.top,x=q.bottom()-d.bottom,y=this._headPadding,w=w+y.top,d=q.width-d.left-d.right,q=0,z=this._columns,A=z.count(),B=0;B<A;B++)var D=z.at(B),q=q+D.width();if(this._displayHead){for(var E=a,C=w,F=this._headHeight,B=0;B<A;B++)if(D=z.at(B),D.testReady()){var H=d*D.width()/q;h.set(E,C,H,F);D.draw(e);E+=H}else b=!0;w+=
F+y.bottom}y=this._rowHeight;this._optionClip&&k.clip(a,w,d,x-w);k=this._rows;C=k.count();w+=this._rowScroll;for(F=0;F<C;F++){E=a;if(w>-y)for(var G=k.at(F),B=0;B<A;B++){var D=z.at(B),I=D.dataName(),H=d*D.width()/q,D=G.cells().get(I);D.testReady()?(D.calculateStyle(f),h.set(E,w,H,y),D.draw(e),E+=H):b=!0}w+=y;if(w>x)break}b&&this.dirty()};
MO.FGuiGridControl_construct=function(){this.__base.FGuiControl.construct.call(this);this.__base.MUiGridControl.construct.call(this);this._rowClass=MO.FGuiGridRow;this._paintContext=new MO.SGuiGridPaintContext;this._headPadding=new MO.SPadding};MO.FGuiGridControl_dispose=function(){this._headPadding=this._rowClass=null;this._paintContext=MO.Lang.Object.dispose(this._paintContext);this.__base.MUiGridControl.dispose.call(this);this.__base.FGuiControl.dispose.call(this)};
MO.FGuiGridRow=function(a){a=MO.Class.inherits(this,a,MO.FObject,MO.MUiGridRow);a.construct=MO.FGuiGridRow_construct;a.dispose=MO.FGuiGridRow_dispose;return a};MO.FGuiGridRow_construct=function(){this.__base.FObject.construct.call(this);this.__base.MUiGridRow.construct.call(this)};MO.FGuiGridRow_dispose=function(){this.__base.MUiGridRow.dispose.call(this);this.__base.FObject.dispose.call(this)};
MO.FGuiTable=function(a){a=MO.Class.inherits(this,a,MO.FGuiGridControl);a.oeUpdate=MO.FGuiTable_oeUpdate;a.construct=MO.FGuiTable_construct;a.insertRow=MO.FGuiTable_insertRow;a.loadDataset=MO.FGuiTable_loadDataset;a.dispose=MO.FGuiTable_dispose;return a};
MO.FGuiTable_oeUpdate=function(a){this.__base.FGuiGridControl.oeUpdate.call(this,a);if(a.isBefore()&&0>this._rowScroll){a=this._rows;var b=Math.max(parseInt(-this._rowScroll/this._rowHeight),this._rowScrollSpeed);this._rowScroll+=b;0<=this._rowScroll&&(b=this._rowLimitCount,0!=b&&a.count()>b&&(a=a.pop(),this.freeRow(a)),this._rowScroll=0);this.dirty()}};
MO.FGuiTable_construct=function(){this.__base.FGuiGridControl.construct.call(this);this.__base.MUiGridControl.construct.call(this);this._rowClass=MO.FGuiGridRow};MO.FGuiTable_insertRow=function(a){this._rows.unshift(a);this._rowScroll-=this._rowHeight;this.dirty()};MO.FGuiTable_loadDataset=function(a){};MO.FGuiTable_dispose=function(){this.__base.MUiGridControl.dispose.call(this);this.__base.FGuiGridControl.dispose.call(this)};MO.FGuiBar=function(a){return a=MO.Class.inherits(this,a,MO.FGuiFrame)};
MO.FGuiChartTotal=function(a){a=MO.Class.inherits(this,a,MO.FGuiControl);a._ready=MO.Class.register(a,new MO.AGetSet("_ready"),!1);a._numImages=null;a._yuanImage=null;a._wanImage=null;a._yiImage=null;a._imageToLoad=0;a._value=MO.Class.register(a,new MO.AGetter("_value"));a._originValue="0";a._nextValue=null;a._startTick=0;a._rolling=MO.Class.register(a,new MO.AGetSet("_rolling"),!1);a._rollingDuration=MO.Class.register(a,new MO.AGetSet("_rollingDuration"),1E3);a._rollingPages=null;a._noRolling=MO.Class.register(a,
new MO.AGetSet("_noRolling"),!1);a.construct=MO.FGuiChartTotal_construct;a.setup=MO.FGuiChartTotal_setup;a.onImageLoad=MO.FGuiChartTotal_onImageLoad;a.onPaintBegin=MO.FGuiChartTotal_onPaintBegin;a.setValue=MO.FGuiChartTotal_setValue;a.dispose=MO.FGuiChartTotal_dispose;return a};MO.FGuiChartTotal_construct=function(){this.__base.FGuiControl.construct.call(this);this._rollingPages=new MO.TArray};
MO.FGuiChartTotal_setup=function(){this._yuanImage=MO.Class.create(MO.FImage);this._yuanImage.addLoadListener(this,this.onImageLoad);this._yuanImage.loadUrl("{eai.resource}/number/yuan.png");this._imageToLoad++;this._wanImage=MO.Class.create(MO.FImage);this._wanImage.addLoadListener(this,this.onImageLoad);this._wanImage.loadUrl("{eai.resource}/number/wan.png");this._imageToLoad++;this._yiImage=MO.Class.create(MO.FImage);this._yiImage.addLoadListener(this,this.onImageLoad);this._yiImage.loadUrl("{eai.resource}/number/yi.png");
this._imageToLoad++;this._numImages=Array(10);this._imageToLoad+=10;for(var a=0;10>a;a++){var b=MO.Class.create(MO.FImage);b.addLoadListener(this,this.onImageLoad);b.loadUrl("{eai.resource}/number/"+a+".png");this._numImages[a]=b}};
MO.FGuiChartTotal_onImageLoad=function(){if(0==--this._imageToLoad){var a=MO.Eai.Canvas.logicSize(),b=this._numImages[0]._size,d=this._yiImage._size;this.setLeft((a.width-4*b.width-d.width)/2);this.setTop((a.height-3*d.height)/2);this.setWidth(4*b.width+d.width);this.setHeight(3*d.height);this._ready=!0}};
MO.FGuiChartTotal_setValue=function(a){if(this._value!=a){this._rolling&&(this._nextValue=this._value);this._value=a;for(var b=this._originValue,d=a.length-b.length;0<d;)b="0"+b,d--;this._originValue=b;this._rollingPages.clear();this._rollingPages._length=a.length;for(d=0;d<a.length;d++){var e=parseInt(a.substring(d,d+1))-parseInt(b.substring(d,d+1)),e=0>e?e+10:e;this._rollingPages.set(d,e)}this._startTick=MO.Timer.current();this._rolling=!0}};
MO.FGuiChartTotal_onPaintBegin=function(a){this.__base.FGuiControl.onPaintBegin.call(this,a);if(this._value){var b=a.graphic;a=a.rectangle;var d=MO.Timer.current()-this._startTick;if(d>this._rollingDuration||this._noRolling)d=this._rollingDuration,this._rolling=!1;var e=this._numImages[0]._size,f=this._yiImage._size,h=4*e.width+f.width,k=a.left+(a.width-h)/2,q=a.top;b.store();b.clip(k,q,h,f.height);for(var k=k+e.width,w=0;w<this._value.length;w++){var x=this._rollingPages.get(w)*(d/this._rollingDuration),
y=(parseInt(this._originValue.charAt(w))+parseInt(x)).toString(),y=parseInt(y.charAt(y.length-1)),z=9==y?0:y+1,x=x-parseInt(x);b.drawImage(this._numImages[y],k,q-e.height*x,e.width,e.height);b.drawImage(this._numImages[z],k,q+e.height-e.height*x,e.width,e.height);k+=e.width;w==this._originValue.length-9?(b.drawImage(this._yiImage,k,q,f.width,f.height),k=a.left+(a.width-h)/2,q+=f.height,b.restore(),b.store(),b.clip(k,q,h,f.height)):w==this._originValue.length-5?(b.drawImage(this._wanImage,k,q,f.width,
f.height),k=a.left+(a.width-h)/2,q+=f.height,b.restore(),b.store(),b.clip(k,q,h,f.height)):w==this._originValue.length-1&&b.drawImage(this._yuanImage,k,q,f.width,f.height)}0==this._rolling&&(this._originValue=this._value,this._rollingPages.clear())}};MO.FGuiChartTotal_dispose=function(){this.__base.FGuiControl.dispose.call(this)};MO.FGuiWindow=function(a){return a=MO.Class.inherits(this,a,MO.FGuiFrame)};
MO.FGuiDesignAnchor=function(a){a=MO.Class.inherits(this,a,MO.FGuiControl);a.construct=MO.FGuiDesignAnchor_construct;a.onPaintBegin=FGuiDesignAnchor_onPaintBegin;a.dispose=MO.FGuiDesignAnchor_dispose;return a};MO.FGuiDesignAnchor_construct=function(){this.__base.FGuiControl.construct.call(this)};MO.FGuiDesignAnchor_onPaintBegin=function(a){this.__base.FGuiControl.onPaintBegin.call(this,a)};MO.FGuiDesignAnchor_dispose=function(){this.__base.FGuiControl.dispose.call(this)};
MO.FGuiDesignRule=function(a){a=MO.Class.inherits(this,a,MO.FGuiControl);a.construct=MO.FGuiDesignRule_construct;a.dispose=MO.FGuiDesignRule_dispose;return a};MO.FGuiDesignRule_construct=function(){this.__base.FGuiControl.construct.call(this)};MO.FGuiDesignRule_dispose=function(){this.__base.FGuiControl.dispose.call(this)};
MO.FGuiEngineInfo=function(a){a=MO.Class.inherits(this,a,MO.FGuiControl);a._lastTick=0;a._name="EngineInfo";a._stage=MO.Class.register(a,new MO.AGetSet("_stage"));a._context=MO.Class.register(a,new MO.AGetSet("_context"));a._ticker=null;a.onPaintBegin=MO.FGuiEngineInfo_onPaintBegin;a.oeUpdate=MO.FGuiEngineInfo_oeUpdate;a.construct=MO.FGuiEngineInfo_construct;return a};
MO.FGuiEngineInfo_onPaintBegin=function(a){this.__base.FGuiControl.onPaintBegin.call(this,a);if(null!=this._stage&&null!=this._context){var b=a.graphic,d=a.rectangle;this._stage.timer();a=this._stage.statistics();var e=this._context.statistics(),d=d.top+20;b.setFont("16px sans-serif");b.drawText("Frame         : "+MO.Timer.rate(),10,d,"#FFFFFF");d+=20;b.drawText("Frame Span    : "+a._frame.toString(),10,d,"#FFFFFF");d+=20;b.drawText("Frame Process : "+a._frameProcess.toString(),10,d,"#FFFFFF");d+=
20;b.drawText("Frame Draw    : "+a._frameDraw.toString()+" | "+a._frameDrawSort.toString(),10,d,"#FFFFFF");d+=20;b.drawText("Draw          : "+e.frameDrawCount(),10,d,"#FFFFFF");d+=20;b.drawText("Draw Const    : "+e.frameConstCount()+" Length="+e.frameConstLength(),10,d,"#FFFFFF");d+=20;b.drawText("Draw Buffer   : "+e.frameBufferCount(),10,d,"#FFFFFF");d+=20;b.drawText("Draw Texture  : "+e.frameTextureCount(),10,d,"#FFFFFF");d+=20;b.drawText("Draw Triangle : "+e.frameTriangleCount(),10,d,"#FFFFFF");
d+=20;b.drawText("Total Program : "+e.programTotal(),10,d,"#FFFFFF");d+=20;b.drawText("Total Layout  : "+e.layoutTotal(),10,d,"#FFFFFF");d+=20;b.drawText("Total Buffer  : Vertex="+e.vertexBufferTotal()+" Index="+e.indexBufferTotal(),10,d,"#FFFFFF")}};MO.FGuiEngineInfo_oeUpdate=function(a){this._ticker.process()&&this.dirty();return MO.EEventStatus.Stop};MO.FGuiEngineInfo_construct=function(){this.__base.FGuiControl.construct.call(this);this._size.set(512,256);this._ticker=new MO.TTicker(1E3)};
