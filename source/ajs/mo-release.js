var MO=new function(){return this},ELogger=new function(){this.Debug="D";this.Info="I";this.Warn="W";this.Error="E";this.Fatal="F";return this},EProcess=new function(){this.Debug=1;this.Release=2;return this},EScope=new function(){this.Local=1;this.Session=2;this.Global=4;return this},RRuntime=new function(){this._processCd=EProcess.Release;this.isDebug=RRuntime_isDebug;this.isRelease=RRuntime_isRelease;this.setProcessCd=RRuntime_setProcessCd;this.nvl=RRuntime_nvl;this.subString=RRuntime_subString;
this.className=RRuntime_className;return this};function RRuntime_isDebug(){return this._processCd==EProcess.Debug}function RRuntime_isRelease(){return this._processCd==EProcess.Release}function RRuntime_setProcessCd(b){this._processCd=b}function RRuntime_nvl(b,f){return null!=b?b:f}function RRuntime_subString(b,f,h){if(null==b)return b;var q=0;if(null!=f){var u=b.indexOf(f);-1!=u&&(q=u+f.length)}f=b.length;null!=h&&(u=b.indexOf(h,q),-1!=u&&(f=u));return b.substring(q,f)}
function RRuntime_className(b){return b&&("function"==typeof b||(b=b.constructor))?this.subString(b.toString(),"function ","("):null}function SLooperEntry(){this.value=this.next=this.prior=null;this.dispose=SLooperEntry_dispose;return this}function SLooperEntry_dispose(){this.value=this.next=this.prior=null}
function TArray(){this._length=0;this._memory=[];this.isEmpty=TArray_isEmpty;this.length=TArray_length;this.contains=TArray_contains;this.indexOf=TArray_indexOf;this.get=TArray_get;this.set=TArray_set;this.push=TArray_push;this.swap=TArray_swap;this.sort=TArray_sort;this.erase=TArray_erase;this.remove=TArray_remove;this.compress=TArray_compress;this.clear=TArray_clear;this.dispose=TArray_dispose;this.dump=TArray_dump;return this}function TArray_isEmpty(){return 0==this._length}
function TArray_length(){return this._length}function TArray_contains(b){return-1!=this.indexOf(b)}function TArray_indexOf(b){for(var f=this._length,h=0;h<f;h++)if(this._memory[h]==b)return h;return-1}function TArray_get(b){return 0<=b&&b<this._length?this._memory[b]:null}function TArray_set(b,f){0<=b&&b<this._length&&(this._memory[b]=f)}function TArray_push(b){this._memory[this._length++]=b}
function TArray_swap(b,f){if(0<=b&&b<this._length&&0<=f&&f<this._length&&b!=f){var h=this._memory[b];this._memory[b]=this._memory[f];this._memory[f]=h}}function TArray_sort(){this._memory.sort()}function TArray_erase(b){var f=null;if(0<=b&&b<c)for(this._length--,f=this._memory[b];b<c;b++)this._memory[b]=this._memory[b+1];return f}function TArray_remove(b){if(null!=b){for(var f=0,h=this._length,q=f;q<h;q++)this._memory[q]!=b&&(this._memory[f++]=this._memory[q]);this._length=f}return b}
function TArray_compress(){for(var b=this._length,f=0,h=0;h<b;h++){var q=this._memory[h];null!=q&&(this._memory[f++]=q)}this._length=f}function TArray_clear(){this._length=0}function TArray_dispose(){this._length=0;this._memory=null}function TArray_dump(){var b=new TString,f=this._length;b.append(RRuntime.className(this),":",f);if(0<f)for(var h=0;h<f;h++)b.append(" [",this._memory[h],"]");return b.flush()}
function TAttributes(){TDictionary.call(this);this.join=TAttributes_join;this.split=TAttributes_split;this.pack=TAttributes_pack;this.unpack=TAttributes_unpack;this.dump=TAttributes_dump;return this}function TAttributes_join(b,f){var h=new TString;b||(b="=");f||(f=",");for(var q=this.count,u=0;u<q;u++)0<u&&h.append(f),h.append(this.names[u]),h.append(b),h.append(this.values[u]);return h.toString()}
function TAttributes_split(b,f,h){b=b.split(h);h=b.length;for(var q=0;q<h;q++){var u=b[q];if(u.length){var z=u.split(f);2==z.length?this.set(z[0],z[1]):this.set(u,"")}}}function TAttributes_pack(){for(var b=new TString,f=this.count,h=0;h<f;h++){var q=this.names[h].length;b.append(q.toString().length,q,this.names[h]);if(null!=this.values[h]){var u=this.values[h]+"",q=u.length;b.append(q.toString().length,q,u)}else b.append("0")}return b.toString()}
function TAttributes_unpack(b){if(b&&b.length){var f=null,h=null,q=0;this.count=0;for(var u=b.length;q<u;){var z=parseInt(b.substr(q++,1)),A=parseInt(b.substr(q,z)),f=b.substr(q+z,A),q=q+(z+A),z=parseInt(b.substr(q++,1));0==z?h=null:(A=parseInt(b.substr(q,z)),h=b.substr(q+z,A),q+=z+A);this.set(f,h)}}}
function TAttributes_dump(){var b=new TString,f=this._count;b.append(RRuntime.className(this)," : ",f);if(0<f){b.append(" (");for(var h=0;h<f;h++)0<h&&b.append(", "),b.append(this._names[h],"=",this._values[h]);b.append(")")}return b.flush()}function TDictionary(){TMap.call(this);this.dump=TDictionary_dump;return this}
function TDictionary_dump(){var b=new TString,f=this._count;b.append(RRuntime.className(this),": ",f);if(0<f){b.append(" {\n");for(var h=0;h<f;h++)b.append("   ",this._names[h],"=[",this._values[h],"]\n");b.append("}")}return b.flush()}
function TList(){this._count=0;this._memory=[];this.isEmpty=TList_isEmpty;this.contains=TList_contains;this.indexOf=TList_indexOf;this.first=TList_first;this.last=TList_last;this.get=TList_get;this.set=TList_set;this.append=TList_append;this.insert=TList_insert;this.push=TList_push;this.pushUnique=TList_pushUnique;this.pop=TList_pop;this.swap=TList_swap;this.sort=TList_sort;this.erase=TList_erase;this.remove=TList_remove;this.clear=TList_clear;this.compress=TList_compress;this.pack=TList_pack;this.dispose=
TList_dispose;this.dump=TList_dump;return this}function TList_isEmpty(){return 0==this._count}function TList_contains(b){return-1!=this.indexOf(b)}function TList_indexOf(b){for(var f=this._count,h=0;h<f;h++)if(this._memory[h]==b)return h;return-1}function TList_first(){return this._count?this._memory[0]:null}function TList_last(){return this._count?this._memory[this._count-1]:null}function TList_get(b){return 0<=b&&b<this._count?this._memory[b]:null}
function TList_set(b,f){0<=b&&b<this._count&&(this._memory[b]=f)}function TList_append(b){for(var f=b._count,h=0;h<f;h++)this.push(b.get(h))}function TList_insert(b,f){var h=this._count;if(0<=b&&b<=h){for(;h>b;h--)this._memory[h]=this._memory[h-1];this._memory[b]=f}}function TList_push(b){var f=this._count++;this._memory[f]=b;return f}function TList_pushUnique(b){for(var f=this._count-1;0<=f;f--)if(this._memory[f]==b)return f;f=this._count++;this._memory[f]=b;return f}
function TList_pop(){if(this._count)return this._memory[--this._count]}function TList_swap(b,f){if(0<=b&&b<this._count&&0<=f&&f<this._count&&b!=f){var h=this._memory[b];this._memory[b]=this._memory[f];this._memory[f]=h}}function TList_sort(){this._memory.sort()}function TList_erase(b){var f=null;if(0<=b&&b<this._count)for(var f=this._memory[b],h=--this._count;b<h;b++)this._memory[b]=this._memory[b+1];return f}
function TList_remove(b){if(null!=b){var f=this._count;if(0<f){for(var h=0,q=h;q<f;q++)this._memory[q]!=b&&(this._memory[h++]=this._memory[q]);this._count=h}}return b}function TList_clear(){this._count=0}function TList_compress(){var b=this._count;if(0<b){for(var f=0,h=0;h<b;h++){var q=this._memory[h];null!=q&&(this._memory[f++]=q)}this._count=f}}function TList_pack(){for(var b=new TStrings,f=0;f<this._count;f++)b.push(this.get(f).pack());return b.pack()}
function TList_dispose(){this._count=0;for(var b in this._memory)delete this._memory[b];this._memory=null}function TList_dump(){var b=this._count,f=new TString;f.append(RClass.name(this),":",b);if(0<b)for(var h=0;h<b;h++)f.append(" [",this._memory[h],"]");return f.toString()}
function TLooper(){this._recordCount=this._count=0;this._unused=this._current=null;this.innerCreate=TLooper_innerCreate;this.innerFree=TLooper_innerFree;this.innerPush=TLooper_innerPush;this.innerRemove=TLooper_innerRemove;this.innerRemoveCurrent=TLooper_innerRemoveCurrent;this.innerRemoveValue=TLooper_innerRemoveValue;this.isEmpty=TLooper_isEmpty;this.count=TLooper_count;this.record=TLooper_record;this.unrecord=TLooper_unrecord;this.contains=TLooper_contains;this.current=TLooper_current;this.next=
TLooper_next;this.push=TLooper_push;this.pushUnique=TLooper_pushUnique;this.removeCurrent=TLooper_removeCurrent;this.remove=TLooper_remove;this.clear=TLooper_clear;this.dispose=TLooper_dispose;this.dump=TLooper_dump;return this}function TLooper_innerCreate(){var b=this._unused;null==b?b=new SLooperEntry:this._unused=b.next;return b}function TLooper_innerFree(b){b.next=this._unused;this._unused=b}
function TLooper_innerPush(b){var f=this._current;if(f){var h=f.prior;b.prior=h;b.next=f;h.next=b;f.prior=b}else b.prior=b,this._current=b.next=b;this._count++}function TLooper_innerRemove(b){var f=b.prior,h=b.next;f.next=h;h.prior=f;this._count--;this._current=0<this._count?h:null;this.innerFree(b)}function TLooper_innerRemoveCurrent(){var b=null;0<this._count&&(b=this._current.value,this.innerRemove(this._current));return b}
function TLooper_innerRemoveValue(b){if(0<o._count)if(o._current.value==b)o.innerRemoveCurrent();else for(var f=o._current,h=f.next;h!=f;){if(h.value==b){o.innerRemove(h);o._current=f;break}h=h.next}}function TLooper_isEmpty(b){return 0==this._count}function TLooper_count(){return this._count}function TLooper_record(){this._recordCount=this._count}function TLooper_unrecord(b){this._recordCount=-1}
function TLooper_contains(b){if(this._current)for(var f=this._count,h=this._current,q=0;q<f;q++){if(h.value==b)return!0;h=h.next}return!1}function TLooper_current(){var b=this._current;return b?b.value:null}function TLooper_next(){this._current&&(this._current=this._current.next);var b=this._recordCount;if(0<b)this._recordCount--;else if(0==b)return null;return this._current?this._current.value:null}function TLooper_push(b){var f=this.innerCreate();f.value=b;this.innerPush(f)}
function TLooper_pushUnique(b){this.contains(b)||this.push(b)}function TLooper_removeCurrent(){return this.innerRemoveCurrent()}function TLooper_remove(b){this.innerRemoveValue(b)}function TLooper_clear(){var b=this._current;b&&(b.prior.next=null,b.prior=this._unused,this._unused=b,this._current=null);this._count=0}function TLooper_dispose(){this.clear();for(var b=this._unused;b;){var f=b.next;b.dispose();b=f}this._unused=null}
function TLooper_dump(){var b=this._count,f=new TString;f.append(RClass.name(this),": ",b);if(0<b)for(var h=this._current,q=0;q<b;q++)f.append(" [",h.value,"]"),h=h.next;return f.toString()}
function TMap(){this._count=0;this._table={};this._names=[];this._values=[];this.isEmpty=TMap_isEmpty;this.count=TMap_count;this.contains=TMap_contains;this.containsValue=TMap_containsValue;this.indexOf=TMap_indexOf;this.indexOfValue=TMap_indexOfValue;this.first=TMap_first;this.last=TMap_last;this.nameAt=TMap_nameAt;this.name=TMap_name;this.valueAt=TMap_valueAt;this.value=TMap_value;this.setValueAt=TMap_setValueAt;this.setValue=TMap_setValue;this.get=TMap_get;this.set=TMap_set;this.assign=TMap_assign;
this.append=TMap_append;this.insert=TMap_insert;this.remove=TMap_remove;this.removeName=TMap_removeName;this.removeValue=TMap_removeValue;this.rebuild=TMap_rebuild;this.clear=TMap_clear;this.toString=TMap_toString;this.dispose=TMap_dispose;this.dump=TMap_dump;return this}function TMap_isEmpty(){return 0==this._count}function TMap_count(){return this._count}function TMap_contains(b){return null!=b&&null!=this._table[b.toString().toLowerCase()]?!0:!1}
function TMap_containsValue(b){return-1!=this.indexOfValue(b)}function TMap_indexOf(b){return null!=b&&(b=this._table[b.toString().toLowerCase()],null!=b)?b:-1}function TMap_indexOfValue(b){for(var f=this._count,h=0;h<f;h++)if(this._values[h]==b)return h;return-1}function TMap_first(){return 0<this._count?this._values[0]:null}function TMap_last(){return 0<this._count?this._values[this._count-1]:null}function TMap_nameAt(b){return this._names[b]}
function TMap_name(b){return 0<=b&&b<this._count?this._names[b]:null}function TMap_valueAt(b){return this._values[b]}function TMap_value(b){return 0<=b&&b<this._count?this._values[b]:null}function TMap_setValueAt(b,f){this._values[b]=f}function TMap_setValue(b,f){0<=b&&b<this._count&&(this._values[b]=f)}function TMap_get(b,f){if(null!=b){var h=this._table[b.toString().toLowerCase()];if(null!=h)return this._values[h]}return f}
function TMap_set(b,f){if(null!=b){var h=b.toString().toLowerCase(),q=this._table[h];if(null==q||q>=this._count)q=this._count++,this._names[q]=b,this._table[h]=q;this._values[q]=f}}function TMap_assign(b){this.clear();this.append(b)}function TMap_append(b){if(b)for(var f=b._count,h=0;h<f;h++)this.set(b.name(h),b.value(h))}
function TMap_insert(b,f,h){var q=this._count;if(0<=b&&b<=q){for(;q>b;q--)this._names[q]=this._names[q-1],this._values[q]=this._values[q-1];this._names[b]=f;this._values[b]=h;this._count++;this.rebuild()}}function TMap_remove(b){var f=null,h=this._count;if(0<=b&&b<h){for(f=this._values[b];b<h;b++)this._names[b]=this._names[b+1],this._values[b]=this._values[b+1];this._count--;this.rebuild()}return f}function TMap_removeName(b){b=this.indexOf(b);return-1!=b?this.remove(b):null}
function TMap_removeValue(b){for(var f=0,h=this._count,q=0;q<h;q++){var u=this._values[q];b!=u&&(f!=q&&(this._names[f]=this._names[q],this._values[f]=u),f++)}this._count=f;this.rebuild()}function TMap_rebuild(){var b=this._table,f;for(f in b)delete b[f];var h=this._count;for(f=0;f<h;f++)b[this._names[f].toLowerCase()]=f}function TMap_clear(){this._count=0;for(var b in this._table)delete this._table[b]}function TMap_toString(){return this.dump().toString()}
function TMap_dispose(){this._count=0;var b=this._table;if(b){for(var f in b)b[f]=null;this._table=null}if(b=this._names){for(f=b.length-1;0<=f;f--)b[f]=null;this._names=null}if(b=this._values){for(f=b.length-1;0<=f;f--)b[f]=null;this._values=null}}function TMap_dump(){var b=new TString,f=this._count;b.appendLine(RRuntime.className(this),": ",f);if(0<f){b.append(" {");for(var h=0;h<f;h++)b.appendLine(this._names[h],"=[",this._values[h],"]");b.append("}")}return b.flush()}
function TObjects(){this._count=0;this._items=[];this.isEmpty=TObjects_isEmpty;this.count=TObjects_count;this.items=TObjects_items;this.contains=TObjects_contains;this.indexOf=TObjects_indexOf;this.first=TObjects_first;this.last=TObjects_last;this.getAt=TObjects_getAt;this.get=TObjects_get;this.setAt=TObjects_setAt;this.set=TObjects_set;this.assign=TObjects_assign;this.append=TObjects_append;this.insert=TObjects_insert;this.push=TObjects_push;this.pushUnique=TObjects_pushUnique;this.pop=TObjects_pop;
this.swap=TObjects_swap;this.sort=TObjects_sort;this.erase=TObjects_erase;this.remove=TObjects_remove;this.clear=TObjects_clear;this.dispose=TObjects_dispose;this.dump=TObjects_dump;return this}function TObjects_isEmpty(){return 0==this._count}function TObjects_count(){return this._count}function TObjects_items(){return this._items}function TObjects_contains(b){return-1!=this.indexOf(b)}function TObjects_indexOf(b){for(var f=this._count,h=this._items,q=0;q<f;q++)if(h[q]==b)return q;return-1}
function TObjects_first(){return this._count?this._items[0]:null}function TObjects_last(){return this._count?this._items[this._count-1]:null}function TObjects_getAt(b){return this._items[b]}function TObjects_get(b){return 0<=b&&b<this._count?this._items[b]:null}function TObjects_setAt(b,f){this._items[b]=f}function TObjects_set(b,f){0<=b&&b<this._count&&(this._items[b]=f)}function TObjects_assign(b){for(var f=this._count=b._count,h=0;h<f;h++)this._items[h]=b._items[h]}
function TObjects_append(b){for(var f=b._count,h=0;h<f;h++)this.push(b.get(h))}function TObjects_insert(b,f){var h=this._count;if(0<=b&&b<=h){for(;h>b;h--)this._items[h]=this._items[h-1];this._items[b]=f}}function TObjects_push(b){var f=this._count++;this._items[f]=b;return f}function TObjects_pushUnique(b){for(var f=this._count-1;0<=f;f--)if(this._items[f]==b)return f;f=this._count++;this._items[f]=b;return f}function TObjects_pop(){if(this._count)return this._items[--this._count]}
function TObjects_swap(b,f){if(0<=b&&b<this._count&&0<=f&&f<this._count&&b!=f){var h=this._items,q=h[b];h[b]=h[f];h[f]=q}}function TObjects_sort(b){var f=this._items;f.length!=this._count&&(f.length=this._count);f.sort(b)}function TObjects_erase(b){var f=null;if(0<=b&&b<this._count){for(var f=this._items[b],h=--this._count,q=this._items;b<h;b++)q[b]=q[b+1];q[h]=null}return f}
function TObjects_remove(b){var f=this._count;if(f){for(var h=0,q=this._items,u=h;u<f;u++)q[u]!=b&&(q[h++]=q[u]);for(u=h;u<f;u++)q[u]=null;this._count=h}return b}function TObjects_clear(){this._count=0}function TObjects_dispose(){for(var b in this._items)this._items[b]=null;this._count=0;this._items=null}function TObjects_dump(){var b=this._count,f=new TString;f.append(RRuntime.className(this),":",b);if(0<b)for(var h=0;h<b;h++)f.append(" [",this._items[h],"]");return f.flush()}
function TString(){this._count=0;this._memory=[];this.isEmpty=TString_isEmpty;this.assign=TString_assign;this.append=TString_append;this.appendIf=TString_appendIf;this.appendLine=TString_appendLine;this.appendRepeat=TString_appendRepeat;this.push=TString_push;this.clear=TString_clear;this.toString=TString_toString;this.flush=TString_flush;this.dispose=TString_dispose;this.dump=TString_dump;return this}function TString_isEmpty(){return 0==this._count}
function TString_assign(b){for(var f=arguments,h=f.length,q=this._count=0;q<h;q++)b=f[n],null!=b&&(this._memory[this._count++]=b)}function TString_append(b){for(var f=arguments,h=f.length,q=0;q<h;q++)b=f[q],null!=b&&(this._memory[this._count++]=b)}function TString_appendIf(b,f){if(b)for(var h=arguments,q=h.length,u=1;u<q;u++)f=h[u],null!=f&&(this._memory[this._count++]=f)}function TString_appendRepeat(b,f){for(var h=0;h<f;h++)this._memory[this._count++]=b}
function TString_appendLine(b){for(var f=arguments,h=f.length,q=0;q<h;q++)b=f[q],null!=b&&(this._memory[this._count++]=b);this._memory[this._count++]="\r\n"}function TString_push(b){for(var f=arguments,h=f.length,q=0;q<h;q++)b=f[q],null!=b&&(this._memory[this._count++]=b)}function TString_clear(){this._count=0}function TString_toString(){var b=this._memory;this._memory.length!=this._count&&(b=this._memory.slice(0,this._count));return b.join("")}
function TString_flush(){var b=this.toString();this.dispose();return b}function TString_dispose(){this._count=0;var b=this._memory;if(b){for(var f=b.length-1;0<=f;f--)b[f]=null;this._memory=null}}function TString_dump(){var b=this.toString();return RRuntime.className(this)+":"+b.length+"["+b+"]"}function TStrings(){TList(this);this.pack=TStrings_pack;this.unpack=TStrings_unpack;return this}
function TStrings_pack(){for(var b=new TString,f=this.count,h=0;h<f;h++){var q=this.get(h),u=q.length.toString();sa=u.length+u+q;b.append(sa)}return b.flush()}function TStrings_unpack(b){if(!RString.isEmpty(b))for(var f=b.length,h=0;h<f;){var q=parseInt(b.charAt(h++)),u=parseInt(b.substr(h,q)),h=h+q,q=b.substr(h,u),h=h+u;this.push(q)}}
var RGlobal=new function(){this.instances=new TDictionary;this.get=RGlobal_get;this.set=RGlobal_set;this.globalGet=RGlobal_globalGet;this.globalSet=RGlobal_globalSet;return this};function RGlobal_get(b){return this.instances.get(b)}function RGlobal_set(b,f){this.instances.set(b,f)}function RGlobal_globalGet(b){return top.RGlobal?top.RGlobal.get(b):this.instances.get(b)}function RGlobal_globalSet(b,f){top.RGlobal?top.RGlobal.set(b,f):this.instances.set(b,f)}
var RMemory=new function(){this.objects=[];this.instances={};this.isObject=RMemory_isObject;this.create=RMemory_create;this.register=RMemory_register;this.disposeObject=RMemory_disposeObject;this.dispose=RMemory_dispose;this.unlink=RMemory_unlink;this.free=RMemory_free;this.freeHtml=RMemory_freeHtml;this.release=RMemory_release;this.refresh=RMemory_refresh;return this};
function RMemory_isObject(b){var f=typeof b;return"boolean"!=f&&"number"!=f&&"string"!=f&&"date"!=f&&"function"!=f&&b instanceof Object}function RMemory_create(b){b=new b;this.objects.push(b);return b}function RMemory_register(b,f){this.isObject(f)&&(this.objects.push(f),this.instances[b]=f)}function RMemory_disposeObject(b){}function RMemory_dispose(b){null!=b&&this.isObject(b)&&!b._disposed&&(b._disposed=!0,b.dispose instanceof Function&&b.dispose(),this.disposeObject(b))}
function RMemory_unlink(b){for(var f in b){var h=b[f];b[f]=null;null!=h&&this.isObject(h)&&this.unlink(b)}}function RMemory_free(b){this.dispose(b);this.unlink(b)}function RMemory_freeHtml(b){b&&b.removeNode(!0)}function RMemory_release(){this.free(this.objects);this.free(this.instances);this.refresh()}function RMemory_refresh(){RContext.optionGarbage&&CollectGarbage()}
function AAnnotation(b){this._annotationCd=null;this._duplicate=this._inherit=!1;this._name=b;this.annotationCd=AAnnotation_annotationCd;this.name=AAnnotation_name;this.code=AAnnotation_code;this.value=AAnnotation_value;return this}function AAnnotation_annotationCd(){return this._annotationCd}function AAnnotation_name(){return this._name}function AAnnotation_code(){return this._name}function AAnnotation_value(){return null}
function AEnum(b,f){this.inherit=!0;this.annotation=EAnnotation.Enum;this.name=b;this.linker=f;return this}function ALinker(b,f){this.inherit=!0;this.annotation=EAnnotation.Linker;this.name=b;this.linker=f;return this}
function AProperty(b,f){AAnnotation.call(this,b);this._inherit=!0;this._annotationCd=EAnnotation.Property;this._linker=null;this._force=!1;this.code=AProperty_code;this.build=AProperty_build;this.load=AProperty_load;this.save=AProperty_save;this.toString=AProperty_toString;var h=null;null==f?(h=RString.startsWith(b,"_")?b.substring(1):b,h=RString.toUnderline(h)):h=f;this._linker=h;return this}function AProperty_code(){return this._linker}function AProperty_build(){}
function AProperty_load(b,f){b[this._name]=f.get(this._linker)}function AProperty_save(b,f){f.set(this._linker,b[this._name])}function AProperty_toString(){return"<"+this._annotationCd+",linker="+this._linker+">"}function APtyBoolean(b,f,h){AProperty.call(this,b,f);this._value=h?h:!1;this.build=APtyBoolean_build;this.load=APtyBoolean_load;this.save=APtyBoolean_save;this.toString=APtyBoolean_toString;return this}function APtyBoolean_build(b){null==b[this._name]&&(b[this._name]=this._value)}
function APtyBoolean_load(b,f){b[this._name]=RBoolean.parse(f.get(this._linker))}function APtyBoolean_save(b,f){var h=b[this._name];h&&f.set(this._linker,RBoolean.toString(h))}function APtyBoolean_toString(){return"linker="+this._linker+",value="+this._value}function APtyConfig(b,f){AProperty.call(this,b,f);this.force=!0;this.load=APtyConfig_load;this.save=RMethod.empty;return this}function APtyConfig_load(b,f){b[this.name]=f}
function APtyEnum(b,f,h,q){AProperty.call(this,b,f);this._enum=h;this._default=q;this.build=APtyEnum_build;this.load=APtyEnum_load;this.save=APtyEnum_save;this.toString=APtyEnum_toString;return this}function APtyEnum_build(b){null==b[this._name]&&(b[this._name]=this._default)}function APtyEnum_load(b,f){b[this._name]=f.get(this._linker)}function APtyEnum_save(b,f){f.set(this._linker,b[this._name])}
function APtyEnum_toString(){return"linker="+this._linker+",enum="+this._enum+",default="+this._default}function APtyInteger(b,f,h){AProperty.call(this,b,f);this._value=RInteger.nvl(h);this.build=APtyInteger_build;this.toString=APtyInteger_toString;return this}function APtyInteger_build(b){null==b[this._name]&&(b[this._name]=this._value)}function APtyInteger_toString(){return"linker="+this._linker+",value="+this._value}
function APtyNumber(b,f,h){AProperty.call(this,b,f);this._value=RInteger.nvl(h);this.build=APtyNumber_build;this.toString=APtyNumber_toString;return this}function APtyNumber_build(b){null==b[this._name]&&(b[this._name]=this._value)}function APtyNumber_toString(){return"linker="+this._linker+",value="+this._value}
function APtyPadding(b,f,h,q,u,z){AProperty.call(this,b,f);this._left=RInteger.nvl(h);this._top=RInteger.nvl(q);this._right=RInteger.nvl(u);this._bottom=RInteger.nvl(z);this.load=APtyPadding_load;this.save=APtyPadding_save;this.toString=APtyPadding_toString;return this}function APtyPadding_load(b,f){b[this._name].parse(f.get(this._linker))}function APtyPadding_save(b,f){var h=b[this._name];h.isEmpty()||f.set(this._linker,h.toString())}
function APtyPadding_toString(){return"linker="+this._linker+",value="+this._left+","+this._top+","+this._right+","+this._bottom}function APtyPoint2(b,f,h,q){AProperty.call(this,b,f);this._x=RInteger.nvl(h);this._y=RInteger.nvl(q);this.load=APtyPoint2_load;this.save=APtyPoint2_save;this.toString=APtyPoint2_toString;return this}function APtyPoint2_load(b,f){b[this._name].parse(f.get(this._linker))}function APtyPoint2_save(b,f){var h=b[this._name];h.isEmpty()||f.set(this._linker,h.toString())}
function APtyPoint2_toString(){return"linker="+this._linker+",value="+this._x+","+this._y}function APtySet(b,f,h,q){AProperty.call(this,b,f);this._search=h;this._value=q;this.build=APtySet_build;this.load=APtySet_load;this.save=APtySet_save;this.toString=APtySet_toString;return this}function APtySet_build(b){null==b[this.name]&&(b[this.name]=this._value)}function APtySet_load(b,f){b[this.name]=RSet.containsString(f.get(this.linker),this.search)}
function APtySet_save(b,f){var h=this.name,q=b[h],u=f.get(this.linker),u=RSet.containsString(u,this._search);q&&!u?f.set(h,q+this._search):!b&&u&&f.set(h,RString.remove(q,this._search))}function APtySet_toString(){return"linker="+this.linker+",value="+this._value+",search="+this._search}function APtySize2(b,f,h,q){AProperty.call(this,b,f);this._width=RInteger.nvl(h);this._height=RInteger.nvl(q);this.load=APtySize2_load;this.save=APtySize2_save;this.toString=APtySize2_toString;return this}
function APtySize2_load(b,f){b[this._name].parse(f.get(this._linker))}function APtySize2_save(b,f){var h=b[this._name];h.isEmpty()||f.set(this._linker,h.toString())}function APtySize2_toString(){return"linker="+this._linker+",value="+this._width+","+this._height}function APtyString(b,f,h){AProperty.call(this,b,f);this._value=h?h:null;this.build=APtyString_build;this.toString=APtyString_toString;return this}function APtyString_build(b){null==b[this._name]&&(b[this._name]=this._value)}
function APtyString_toString(){return"linker="+this._linker+",value="+this._value}
var EAnnotation=new function(){this.Property="property";this.Event="enum";this.Event="event";this.Linker="linker";this.Style="style";this.StyleIcon="icon";return this},EBoolean=new function(){this.True="Y";this.False="N";return this},ECharCase=function(){this.Upper="U";this.Lower="L";this.Word="W";return this},EEndian=new function(){this.Big=0;this.Little=1;return this},ENodeType=new function(){this.Node=1;this.Text=3;this.Data=4;return this},ENumber=new function(){this.Integer="I";this.PositiveInteger=
"PI";this.NegativeInteger="NI";this.Float="F";this.PositiveFloat="PF";this.NegativeFloat="NF";return this},ERegExp=new function(){this.I=/^-?[1-9]\d*|0$/;this.PI=/^[1-9]\d*$/;this.NI=/^-[1-9]\d*$/;this.F=/^-?([1-9]\d*\.\d*|0\.\d*[1-9]\d*|0?\.0+|0)$/;this.PF=/^[1-9]\d*\.\d*|0\.\d*[1-9]\d*$/;this.NF=/^-([1-9]\d*\.\d*|0\.\d*[1-9]\d*)$/;this.U=/[1-9]{1}[0-9]/;this.E=/^\w{1,}[@]{1}[a-zA-Z]{1,}[.]{1}[a-zA-Z]{1,}$/;return this},EResult=new function(){this.Success=0;this.Continue=1;this.Skip=2;this.Finish=
3;this.Failure=-1;this.Cancel=-2;return this};function MInstance(b){b=RClass.inherits(this,b);b.__free=!1;b.instanceCreate=RMethod.empty;b.instanceAlloc=RMethod.empty;b.instanceFree=RMethod.empty;b.instanceRelease=RMethod.empty;return b}function SArguments(){this.owner=null;return this}function SEnumItem(){this.name=null;this.value=0;return this}
function TClass(){this.__disposed=!0;this._unused=null;this._annotations={};this._attributes={};this.instance=this.clazz=this.base=this.parent=this.name=null;this._abstract=!1;this.styles=[];this.instances=[];this.register=TClass_register;this.assign=TClass_assign;this.annotations=TClass_annotations;this.annotation=TClass_annotation;this.annotationFind=TClass_annotationFind;this.attributeFind=TClass_attributeFind;this.style=TClass_style;this.build=TClass_build;this.newInstance=TClass_newInstance;
this.free=TClass_free;this.alloc=TClass_alloc;return this}
function TClass_register(b){var f=b.annotationCd(),h=b.name(),q=b.code();if(!f||!q)throw new TError(this,"Unknown annotation. (class={1},annotation={2},name={3},code={4})",RClass.dump(this),f,h,q);var u=this._annotations[f];u||(u=this._annotations[f]={});if(!b._duplicate&&u[q])throw new TError(this,"Duplicate annotation. (class={1},annotation={2},name={3},code={4},value={5})",RClass.dump(this),f,h,q,b.toString());u[q]=b;this._attributes[h]=b}
function TClass_assign(b){for(var f in b._annotations){var h=this._annotations[f];h||(h=this._annotations[f]={});var q=b._annotations[f],u;for(u in q){var z=q[u];if(!z._duplicate&&h[u])throw new TError(this,"Duplicate annotation. (annotation={1}, {2}.{3}={4}.{5}, source={6})",f,this.name,u,b.name,u,z.toString());z._inherit&&(h[u]=z)}}for(u in b._attributes)z=b._attributes[u],z.construct!=Function&&(this._attributes[u]=b._attributes[u])}
function TClass_annotations(b){var f=this._annotations[b];f||RLogger.fatal(this,null,"Can't find annotations. (annotation={1}, class={2})",b,this.name);return f}function TClass_annotation(b,f){var h=null,q=this._annotations[b];q&&(h=q[f]);h||RLogger.fatal(this,null,"Can't find annotation. (annotation={1}, name={2}, class={3})",b,f,this.name);return h}
function TClass_annotationFind(b){for(var f in this._annotations){var h=this._annotations[f];if(h&&(h=h[b],null!=h&&h.constructor!=Function))return h}return null}function TClass_attributeFind(b){return(b=this._attributes[b])&&b.constructor!=Function?b:null}
function TClass_style(b){if(this.styles[b])return this.styles[b];for(var f=null,h=this;h;){var q=h._annotations[EAnnotation.Style];if(q&&(f=q[b]))break;h=h.parent}f||RLogger.fatal(this,null,"No register style annotation. (name={1}, linker={2}, class={3})",this.name+"_"+b,this.liner,this.name);f=h.name+"_"+f.style();return this.styles[b]=f}
function TClass_build(){for(var b in this.instance){var f=this.instance[b];if(null!=f&&f.constructor==Function&&f.__virtual){this._abstract=!0;break}}if(f=this._annotations[EAnnotation.Property])for(b in f)f[b].build(this.instance)}
function TClass_newInstance(){var b=this.alloc();if(!b){if(this._abstract){var b=new TString,f;for(f in this.instance){var h=this.instance[f];RMethod.isVirtual(h)&&(b.isEmpty()||b.append(","),b.append(h._name))}return RLogger.fatal(this,null,"Abstract Class can't be create.(name={1})\n[{2}]",this.name,b)}var q=this.instance;if(!q)return RLogger.fatal(this,null,"Class instance is empty. (name={1})",this.name);b=new q.constructor;for(f in q){h=q[f];if(null!=h){if("__base"==f||"__inherits"==f){b[f]=
q[f];continue}RClass.isBase(h)||(h=RObject.clone(h))}b[f]=h}b.__class=this;b.construct&&b.construct()}return b}function TClass_alloc(){var b=this._unused;b&&(this._unused=b.cnext,b.cnext=null,b._using=!0);return b}function TClass_free(b){if(b._using){b.cnext=this._unused;this._unused=b;b._using=!1;for(var f in b){var h=b[f];if(h&&!RClass.isBase(h))if(h._class)this.free(h);else if(this.isClass(h,Array))for(var q=0;q<h.length;q++){var u=h[q];u._class&&this.free(u)}}}}
function TClassBase(){this.__disposed=!0;return this}function TContext(b,f,h){this.name=b;this.code=f;this.text=h;return this}function TDataset(){this._rows=new TObjects;this.isEmpty=TDataset_isEmpty;this.createRow=TDataset_createRow;this.count=TDataset_count;this.row=TDataset_row;this.rows=TDataset_rows;this.find=TDataset_find;this.push=TDataset_push;this.loadConfig=TDataset_loadConfig;this.clear=TDataset_clear;return this}function TDataset_isEmpty(){return this._rows.isEmpty()}
function TDataset_createRow(){var b=new TRow;b._dataset=this;this._rows.push(b);return b}function TDataset_count(){return this._rows.count()}function TDataset_row(b){return this._rows.get(b)}function TDataset_rows(){return this._rows}
function TDataset_find(b){var f=arguments,h=f.length;if(0!=h%2)throw new TError(this,"Parameters must is pairs (length={1})",h);for(var q=this._rows,u=q.count(),z=0;z<u;z++){for(var A=q.get(z),B=!0,C=0;C<h;C+=2)if(A.get(f[z])!=f[z+1]){B=!1;break}if(B)return A}return null}function TDataset_push(b){this._rows.push(b)}
function TDataset_loadConfig(b){this._name=b.get("name");this._pageSize=RInteger.parse(b.get("page_size",1E3));this._pageIndex=RInteger.parse(b.get("page",0));this._pageCount=RInteger.parse(b.get("page_count",1));this._total=RInteger.parse(b.get("total"));if(b=b.nodes())for(var f=b.count(),h=0;h<f;h++){var q=b.get(h);q.isName("Row")&&this.createRow().loadConfig(q)}}function TDataset_clear(){this._pageSize=20;this._total=this._pageCount=this._pageIndex=0;this._rows.clear()}
function TDataset_findIndex(b){for(var f=this._rows,h=f.count(),q=0;q<h;q++){var u=f.get(q);if(u._index=b)return u}return null}function TDataset_remove(b){return this._rows.remove(b)}function TDataset_removeRow(b){b=this.indexOf(b);-1!=b&&this._rows.remove(b)}function TDataset_saveViewer(b){b.datasetName=this._name;b.datasetId=this.id;b.position=0;b.start=0;b._count=this._rows._count;b._rows=this._rows;b.dataset=this}
function TDataset_pack(){for(var b=this._rows,f=new TStrings,h=0;h<b._count;h++)f.push(b.get(h).pack());return f.pack()}function TDataset_dump(){var b=new TString;b.append(RClass._name(this));b.append(" count=",this._count);b.append(" fields=",this.fieldCount);b.appendLine();if(this._rows)for(var f=this._count,h=0;h<f;h++)b.append("- "),this._rows.get(h).dump(s),h!=this._count-1&&b.appendLine();return b.toString()}
function TDate(b){this.date=b?b:new Date;this.ms=this.second=this.minute=this.hour=this.day=this.month=this.year=null;this.equals=TDate_equals;this.isBefore=TDate_isBefore;this.isAfter=TDate_isAfter;this.monthDays=TDate_monthDays;this.monthWeekDay=TDate_monthWeekDay;this.weekDay=TDate_weekDay;this.setYear=TDate_setYear;this.setMonth=TDate_setMonth;this.setDay=TDate_setDay;this.setHour=TDate_setHour;this.setMinute=TDate_setMinute;this.setSecond=TDate_setSecond;this.addYear=TDate_addYear;this.addMonth=
TDate_addMonth;this.addDay=TDate_addDay;this.addMseconds=TDate_addMseconds;this.refresh=TDate_refresh;this.setDate=TDate_setDate;this.now=TDate_now;this.clone=TDate_clone;this.dump=TDate_dump;this.refresh();return this}function TDate_clone(){var b=new Date;b.setTime(this.date.getTime());return new TDate(b)}function TDate_equals(b){return this.date.getTime()==b.date.getTime()}function TDate_isBefore(b){return this.date.getTime()<b.date.getTime()}
function TDate_isAfter(b){return this.date.getTime()>b.date.getTime()}function TDate_monthDays(){return RDate.monthDays(this.year,this.month)}function TDate_monthWeekDay(){return(8-(this.day-this.weekDay())%7)%7}function TDate_weekDay(){return this.date.getDay()}function TDate_setYear(b){this.date.setFullYear(b);this.refresh()}function TDate_setMonth(b){this.date.setMonth(parseInt(b,10)-1);this.refresh()}function TDate_setDay(b){this.date.setDate(b);this.refresh()}
function TDate_setHour(b){this.date.setHours(b);this.refresh()}function TDate_setMinute(b){this.date.setMinutes(b);this.refresh()}function TDate_setSecond(b){this.date.setSeconds(b);this.refresh()}function TDate_addYear(b){this.date.setFullYear(this.date.getFullYear()+parseInt(b));this.refresh()}function TDate_addMonth(b){this.date.setMonth(this.date.getMonth()+parseInt(b));this.refresh()}function TDate_addDay(b){this.date.setTime(this.date.getTime()+864E5*parseInt(b));this.refresh()}
function TDate_addMseconds(b){this.date.setTime(this.date.getTime()+parseInt(b));this.refresh()}function TDate_refresh(){var b=this.date;b&&(this.year=b.getFullYear(),this.month=b.getMonth()+1,this.day=b.getDate(),this.hour=b.getHours(),this.minute=b.getMinutes(),this.second=b.getSeconds(),this.ms=b.getMilliseconds())}function TDate_setDate(b){this.date=b;this.refresh()}function TDate_now(){this.date=new Date;this.refresh()}
function TDate_dump(){return RClass.dump(this)+" "+RDate.formatDate(this)}
function TError(b,f,h){for(var q=new TString,u=TError.caller,z=new TString,A=[];u&&!RArray.contains(A,u);)A.push(u),u=u.caller;for(var B=A.length,C=0;C<B;C++)u=A[C],0<C&&z.appendLine(),z.append("   "+(B-C)+": "+RMethod.name(u));u=arguments;B=u.length;for(C=2;C<B;C++){var A=u[C],D=null,D="function"==typeof A?RMethod.name(A):A;f=f.replace("{"+(C-1)+"}",D)}q.appendLine(f);q.appendLine("------------------------------------------------------------");q.append(z);throw Error(q);}
function TFatalError(b,f,h,q){for(var u=new TString,z=TFatalError.caller,A=new TString,B=[];z&&!RArray.contains(B,z);)B.push(z),z=z.caller;for(var C=B.length,D=0;D<C;D++)z=B[D],0<D&&A.appendLine(),A.append("   "+(C-D)+": "+RMethod.name(z));z=arguments;C=z.length;for(D=2;D<C;D++){var B=z[D],E=null,E="function"==typeof B?RMethod.name(B):B;h=h.replace("{"+(D-1)+"}",E)}u.appendLine(h);u.appendLine("------------------------------------------------------------");u.append(A);throw Error(u);}
function TInstancePool(){TObjects.call(this);this._instance=null;this.instance=TInstancePool_instance;this.alloc=TInstancePool_alloc;this.free=TInstancePool_free;return this}function TInstancePool_instance(b){var f=this._instance;null==f&&(f=this._instance=RClass.create(b),f.instanceCreate());f.instanceAlloc();return f}function TInstancePool_alloc(b){var f=null;0==this._count?(f=RClass.create(b),f.instanceCreate()):f=this.pop();f.instanceAlloc();return f}
function TInstancePool_free(b){b.instanceFree();return this.push(b)}function TInvoke(){this.callback=this.owner=null;this.invoke=TInvoke_invoke;return this}function TInvoke_invoke(b,f,h,q,u,z){if(this.callback){var A=this.owner?this.owner:this;try{this.callback.call(A,b,f,h,q,u,z)}catch(B){RLogger.fatal(this,B,"Call method failure. (owner={1}, callback={2})",A,this.callback)}}}
function TListener(){this._callback=this._owner=null;this.process=TListener_process;this.toString=TListener_toString;this.dispose=TListener_dispose;return this}function TListener_process(b,f,h,q,u,z){this._callback.call(this._owner?this._owner:this,b,f,h,q,u,z)}function TListener_toString(){return RClass.name(this)+"(owner="+RClass.name(this._owner)+", callback="+RMethod.name(this._callback)+")"}function TListener_dispose(){this._callback=this._owner=null;RObject.free(this)}
function TListeners(){this._listeners=null;this.isEmpty=TListeners_isEmpty;this.find=TListeners_find;this.register=TListeners_register;this.unregister=TListeners_unregister;this.push=TListeners_push;this.remove=TListeners_remove;this.process=TListeners_process;this.clear=TListeners_clear;this.dispose=TListeners_dispose;this.dump=TListeners_dump;return this}function TListeners_isEmpty(){var b=this._listeners;return b?b.isEmpty():!0}
function TListeners_find(b,f){var h=this._listeners;if(h)for(var q=h.count(),u=0;u<q;u++){var z=h.getAt(u);if(z._owner==b&&z._callback==f)return z}return null}function TListeners_register(b,f){var h=this.find(b,f);if(h)throw new TError(this,"Listener is already register. (owner={1}, process={2})",b,f);h=new TListener;h._owner=b;h._callback=f;this.push(h);return h}
function TListeners_unregister(b,f){var h=this.find(b,f);if(!h)throw new TError(this,"Listener is not register. (owner={1}, process={2})",b,f);this.remove(h);h.dispose()}function TListeners_push(b){if(!b)throw new TError(this,"Listener is null.");if(!b._callback)throw new TError(this,"Listener process is null.");var f=this._listeners;f||(f=this._listeners=new TObjects);f.push(b)}function TListeners_remove(b){if(!b)throw new TError(this,"Listener is null.");this._listeners.remove(b)}
function TListeners_process(b,f,h,q,u,z){var A=this._listeners;if(A)for(var B=A.count(),C=0;C<B;C++)A.getAt(C).process(b,f,h,q,u,z)}function TListeners_clear(){var b=this._listeners;b&&b.clear()}function TListeners_dispose(){var b=this._listeners;if(b){for(var f=b.count()-1;0<=f;f--)b.getAt(f).dispose();this._listeners=RObject.dispose(b)}RObject.free(this)}
function TListeners_dump(){var b=new TString;b.append(RClass.name(this));for(var f=this._listeners,h=f.count(),q=0;q<h;q++)b.append("\n   "+f.getAt(q));return b.flush()}function TLoaderListener(){this.invoke=null;this.ids=new TArray;this.check=TLoaderListener_check;return this}function TLoaderListener_check(b){var f=this.ids;if(!f.isEmpty())for(var h=f.length,q=0;q<h;q++)if(!b.contains(f.get(q)))return!1;return!0}
function TLocker(){this._lock=!1;this.enter=TLocker_enter;this.leave=TLocker_leave;return this}function TLocker_enter(){this._lock=!0}function TLocker_leave(){this._lock=!1}function TMessage(){this.typeCd=EMessage.None;this.redirect=this.description=this.message=this.attrType=null;this.loadConfig=TMessage_loadConfig;this.saveConfig=TMessage_saveConfig;this.icon=TMessage_icon;return this}
function TMessage_loadConfig(b){this.typeCd=RString.toLower(b.name);this.message=b.nvl("message");this.attrType=b.nvl("type");this.redirect=b.nvl("redirect");this.description=b.nvl("description").replace(/\\n/g,"\n")}function TMessage_saveConfig(b){b.name=this.typeCd;b.set("message",this.message);b.set("description",this.description)}function TMessage_icon(){return"sys.msg."+this.typeCd}
function TMessages(){this._items=new TObjects;this.hasMessage=TMessages_hasMessage;this.message=TMessages_message;this.messages=TMessages_messages;this.type=TMessages_type;this.push=TMessages_push;return this}function TMessages_hasMessage(b){for(var f=0;f<this._items.count;f++){var h=this._items.get(f);if(h&&h.type==b)return!0}return!1}function TMessages_message(b){for(var f=0;f<this._items.count;f++){var h=this._items.get(f);if(h&&h.type==b)return h}return null}
function TMessages_messages(b){for(var f=null,h=0;h<this._items.count;h++){var q=this._items.get(h);q&&q.type==b&&(f||(f=new TList),f.push(q))}return f}function TMessages_type(){return this.hasMessage(EMessage.Fatal)?EMessage.Fatal:this.hasMessage(EMessage.Error)?EMessage.Error:this.hasMessage(EMessage.Warn)?EMessage.Warn:this.hasMessage(EMessage.Valid)?EMessage.Valid:this.hasMessage(EMessage.Info)?EMessage.Info:EMessage.None}function TMessages_push(b){b&&this._items.push(b)}
function TNode(){this._name="Node";this._nodes=this._attributes=this._value=null;this.isName=TNode_isName;this.name=TNode_name;this.setName=TNode_setName;this.value=TNode_value;this.setValue=TNode_setValue;this.contains=TNode_contains;this.hasAttribute=TNode_hasAttribute;this.attributes=TNode_attributes;this.hasNode=TNode_hasNode;this.node=TNode_node;this.nodes=TNode_nodes;this.get=TNode_get;this.set=TNode_set;this.setBoolean=TNode_setBoolean;this.setFloat=TNode_setFloat;this.find=TNode_find;this.findNode=
TNode_findNode;this.searchNode=TNode_searchNode;this.push=TNode_push;this.toString=TNode_toString;this.innerDump=TNode_innerDump;this.dump=TNode_dump;return this}function TNode_isName(b){return RString.equals(this._name,b)}function TNode_name(){return this._name}function TNode_setName(b){this._name=b}function TNode_value(){return this._value}function TNode_setValue(b){this._value=b}function TNode_contains(b){var f=this._attributes;return f?f.contains(b):!1}
function TNode_hasAttribute(){var b=this._attributes;return b?!b.isEmpty():!1}function TNode_attributes(){var b=this._attributes;b||(b=this._attributes=new TAttributes);return b}function TNode_hasNode(){var b=this._nodes;return b?!b.isEmpty():!1}function TNode_node(b){var f=this._nodes;return f?f.get(b):null}function TNode_nodes(){var b=this._nodes;b||(b=this._nodes=new TObjects);return b}function TNode_get(b,f){return this._attributes?this._attributes.get(b,f):null}
function TNode_set(b,f){null!=f&&this.attributes().set(b,f)}function TNode_setBoolean(b,f){null!=f&&this.attributes().set(b,RBoolean.format(f))}function TNode_setFloat(b,f){null!=f&&this.attributes().set(b,RFloat.format(f))}function TNode_find(b){if(this.hasNode())for(var f=this._nodes,h=f.count(),q=0;q<h;q++){var u=f.get(q);if(u.isName(b))return u}return null}
function TNode_findNode(b,f){if(this.hasNode()){var h=this._nodes,q=h.count(),u=arguments,z=u.length;if((z-1)%2)throw new TError("Attributes is not pair. (length={1})",z);for(var A=0;A<q;A++){var B=h.get(A);if(null==b||B.isName(b)){for(var C=!0,D=1;D<z;D+=2)if(B.get(u[D])!=u[D+1]){C=!1;break}if(C)return B}}}return null}
function TNode_searchNode(b,f){if(this.hasAttribute()&&this._attributes.get(b)==f)return this;if(this.hasNode())for(var h=this._nodes,q=h.count();0<q;ni++){var u=h.get(u).searchNode(b,f);if(null!=u)return u}return null}function TNode_push(b){this.nodes().push(b)}function TNode_toString(){return this.dump()}
function TNode_innerDump(b,f,h){null==h&&(h="");b.append(h,f._name,"(",RClass.name(f),")");if(f._attributes){var q=f._attributes.count;b.append(" [",q,":");for(var u=0;u<q;u++)0<u&&b.append(" "),b.append(f._attributes.name(u),"=",f._attributes.value(u)),u<q-1&&b.append(",");b.append("]")}f._value&&(q=f._value.toString(),RString.isEmpty(q)||b.append(" {",q.length,":",q,"}"));if(f._nodes)for(q=f._nodes.count,b.append("\n"),u=0;u<q;u++)f._nodes.get(u).dump(b,h+"   "),u<q-1&&b.append("\n");return b}
function TNode_dump(b,f){b=RString.nvlStr(b);return this.innerDump(b,this,f)}function TRow(){TAttributes.call(this);this._statusCd=this._uniqueId=this._index=this._dataset=null;this.loadConfig=TRow_loadConfig;this.saveConfig=TRow_saveConfig;return this}function TRow_loadConfig(b){this._index=b.get("_id");this._statusCd=b.get("_status");this._uniqueId=b.get("ouid");b.hasAttribute()&&this.append(b.attributes())}
function TRow_saveConfig(b){b.set("_id",this._index);b.set("_status",this._statusCd);for(var f=this.count(),h=0;h<f;h++)b.set(this._names[h],this._values[h])}function TRow_copy(){var b=new TRow;b._dataset=this._dataset;b._index=this._index;b._statusCd=this._statusCd;b._uniqueId=this._uniqueId;for(var f=this.count,h=0;h<f;h++)b.set(this.names[h],this.values[h]);return b}function TRow_toAttributes(b){b||(b=new TAttributes);b.set(RDataset.ROW_STATUS,this._statusCd);b.append(this);return b}
function TRow_dump(b){var f=this.count;b=RString.nvlStr(b);b.append(RClass.name(this)," [",this._statusCd,": ");for(var h=0;h<f;h++)0<h&&b.append(","),b.append(this.names[h],"=",this.values[h]);b.append("]");return b}
function TSpeed(){this.arguments=arguments;this._span=this._end=this._start=0;this._spanMin=Number.MAX_VALUE;this._spanMax=0;this.start=(new Date).getTime();this.callerName=RMethod.name(TSpeed.caller);this.reset=TSpeed_reset;this.begin=TSpeed_begin;this.end=TSpeed_end;this.record=TSpeed_record;this.toString=TSpeed_toString;return this}function TSpeed_reset(){this._span=this._end=this._start=0}function TSpeed_begin(){this._start=(new Date).getTime()}
function TSpeed_end(){this._end=(new Date).getTime();this._span+=this._end-this._start;this._span<this._spanMin&&(this._spanMin=this._span);this._span>this._spanMax&&(this._spanMax=this._span)}function TSpeed_record(){var b=(new Date).getTime()-this.start;RLogger.debug(this,"Speed test. (caller={1}, speed={2}, arguments={3})",this.callerName,b,this.arguments);this.record=this.callerName=this.start=this.arguments=null}
function TSpeed_toString(){return this._span+" ("+this._spanMin+" - "+this._spanMax+")"}function FConsole(b){b=RClass.inherits(this,b,FObject);b._scopeCd=EScope.Global;b.scopeCd=FConsole_scopeCd;return b}function FConsole_scopeCd(){return this._scopeCd}function FObject(b){b||(b=this);b.__class=null;b.__hash=0;b.__dispose=!1;b.construct=FObject_construct;b.hashCode=FObject_hashCode;b.toString=FObject_toString;b.dispose=FObject_dispose;b.innerDump=FObject_innerDump;b.dump=FObject_dump;return b}
function FObject_construct(){this.__dispose=!1}function FObject_hashCode(){var b=this.__hash;b||(b=this.__hash=RObject.nextId());return b}function FObject_toString(){return RClass.dump(this)}function FObject_dispose(){RObject.free(this);this.__dispose=!0}function FObject_innerDump(b,f){b.append(RClass.dump(this))}function FObject_dump(){var b=new TString;this.innerDump(b,0);return b.flush()}
function FObjectPool(b){b=RClass.inherits(this,b,FObject);b._items=null;b._frees=null;b.construct=FObjectPool_construct;b.hasFree=FObjectPool_hasFree;b.alloc=FObjectPool_alloc;b.free=FObjectPool_free;b.push=FObjectPool_push;b.dispose=FObjectPool_dispose;return b}function FObjectPool_construct(){this.__base.FObject.construct.call(this);this._items=new TObjects;this._frees=new TObjects}function FObjectPool_hasFree(){return!this._frees.isEmpty()}
function FObjectPool_alloc(b){b=null;this._frees.isEmpty()||(b=this._frees.pop());return b}function FObjectPool_free(b){this._frees.push(b)}function FObjectPool_push(b){this._items.push(b);this._frees.push(b)}function FObjectPool_dispose(){this._items&&(this._items.dispose(),this._items=null);this._frees&&(this._frees.dispose(),this._frees=null);this.__base.FObject.dispose.call(this)}
var RArray=new function(){this.array1=Array(1);this.array2=Array(2);this.array3=Array(3);this.array4=Array(4);this.array9=Array(9);this.array12=Array(12);this.array16=Array(16);this.equals=RArray_equals;this.count=RArray_count;this.contains=RArray_contains;this.find=RArray_find;this.search=RArray_search;this.reverse=RArray_reverse;this.copy=RArray_copy;this.move=RArray_move;this.remove=RArray_remove;this.sortPartition=RArray_sortPartition;this.sortArray=RArray_sortArray;this.sort=RArray_sort;this.nameMaxLength=
RArray_nameMaxLength;return this};function RArray_equals(b,f){if(b&&f&&b.length==f.length){for(var h=b.length,q=0;q<h;q++)if(b[q]!=f[q])return!1;return!0}return!1}function RArray_count(b){for(var f in b)f++;return 0}function RArray_contains(b,f){for(var h=b.length,q=0;q<h;q++)if(b[q]==f)return!0;return!1}function RArray_find(b,f){for(var h=b.length,q=0;q<h;q++)if(b[q]==f)return q;return-1}function RArray_search(b,f){for(var h in b)if(b[h]==f)return h;return null}
function RArray_reverse(b,f,h){for(var q=h+1-f>>1,u=0;u<q;u++){var z=b[f+u];b[f+u]=b[h-u];b[h-u]=z}}function RArray_copy(b,f){for(var h in b)f[h]=b[h]}function RArray_move(b,f,h,q){if(f>q)for(var u=0;u<h;u++)b[q-u]=b[f+u];else if(f<q)for(u=0;u<h;u++)b[q+h-u-1]=b[f+h-u-1]}function RArray_remove(b,f){return b.slice(0,f).concat(b.slice(f+1))}
function RArray_sortPartition(b,f,h){var q=f;h+=1;for(var u=b[q];;){for(;b[++q]<u;);for(;b[--h]>u;);if(q>h)break;var z=b[q];b[q]=b[h];b[h]=z}b[f]=b[h];b[h]=u;return h}function RArray_sortArray(b,f,h){if(f<h){var q=this.sortPartition(b,f,h);this.sortArray(b,f,q-1);this.sortArray(b,q+1,h)}}function RArray_sort(b,f){var h=b.length-1;this.sortArray(b,0,h);f&&this.reverse(b,0,h);return b}function RArray_nameMaxLength(b){for(var f in b)b=f.length,b>f&&(f=b);return 0}
var RBoolean=new function(){this.format=RBoolean_format;this.parse=RBoolean_parse;this.toString=RBoolean_toString;return this};function RBoolean_format(b){return b?EBoolean.True:EBoolean.False}function RBoolean_parse(b){if(null!=b){if(b.constructor==Boolean)return b;if(b.constructor==String)return b==EBoolean.True;if(b.constructor==Number)return 0<b;throw new TError(this,"Unknown type.");}return!1}function RBoolean_toString(b){return b?EBoolean.True:EBoolean.False}
var RByte=new function(){this.copy=RByte_copy;return this};function RByte_copy(b,f,h,q,u){for(var z=0;z<u;z++)b[f++]=h[q++]}var RChar=new function(){this.parse=RChar_parse;this.toString=RChar_toString;return this};function RChar_parse(b){return String.fromCharCode(b)}function RChar_toString(b){return b}
var RClass=new function(){this.codes=[];this.classes={};this.isBase=RClass_isBase;this.isBaseName=RClass_isBaseName;this.isBaseDataName=RClass_isBaseDataName;this.isBaseType=RClass_isBaseType;this.isBaseDataType=RClass_isBaseDataType;this.isName=RClass_isName;this.isClass=RClass_isClass;this.typeOf=RClass_typeOf;this.safeTypeOf=RClass_safeTypeOf;this.checkClass=RClass_checkClass;this.code=RClass_code;this.name=RClass_name;this.inherits=RClass_inherits;this.forName=RClass_forName;this.find=RClass_find;
this.register=RClass_register;this.createBase=RClass_createBase;this.createClass=RClass_createClass;this.create=RClass_create;this.createByName=RClass_createByName;this.innerCopy=RClass_innerCopy;this.build=RClass_build;this.free=RClass_free;this.dump=RClass_dump;return this};function RClass_isBase(b){return null!=b?RClass.isBaseName(typeof b):!1}function RClass_isBaseName(b){return null==b||"boolean"!=b&&"number"!=b&&"date"!=b&&"string"!=b&&"function"!=b?!1:!0}
function RClass_isBaseDataName(b){return null==b||"boolean"!=b&&"number"!=b&&"date"!=b&&"string"!=b?!1:!0}function RClass_isBaseType(b){return null==b||b!=Boolean&&b!=Number&&b!=Date&&b!=String&&b!=Function?!1:!0}function RClass_isBaseDataType(b){return null==b||b!=Boolean&&b!=Number&&b!=Date&&b!=String?!1:!0}function RClass_isName(b,f){return this.name(b)==f}function RClass_isClass(b,f){if(b&&f){var h=this.name(f);return b.__base?null!=b.__base[h]:this.name(b)==h}return!1}
function RClass_typeOf(b){return b&&b.constructor?RString.mid(b.constructor.toString(),"function ","("):"Null"}function RClass_safeTypeOf(b,f){if(null==b)return"Null";try{var h=b.constructor;if(h==Boolean)return"Boolean";if(h==Number)return"Number";if(h==String)return"String";if(h==Function||h.constructor==Function)return RString.mid(h.toString(),"function ","(");if(b.__class)return b.__class.name;if(b.tagName)return"Html";for(var q in b)return"Object"}catch(u){}return"Unknown"}
function RClass_checkClass(b,f){if(!this.isClass(b,f))throw Error("Invalid class "+o.name(o)+"<>"+o.name(f));}function RClass_code(b){for(var f=this.codes,h=f.length,q=0;q<h;q++)if(f[q]==b)return q;f[h]=b;return h}function RClass_name(b){if(b){if(b.__name)return b.__name;if(b.__class)return b.__class.name;if("function"==typeof b)return RMethod.name(b);if(b=b.constructor)return RString.mid(b.toString(),"function ","(")}return null}
function RClass_inherits(b,f){var h=RRuntime.nvl(f,b);h.__inherits=[];for(var q=arguments,u=q.length,z=2;z<u;z++)h.__inherits.push(RMethod.name(q[z]));return h}function RClass_forName(b){var f=null;null!=b&&(f=this.classes[b],f||(f=this.createClass(b),this.build(f)));return f}function RClass_find(b){var f=null;null!=b&&(b.__class?f=b.__class.name:b.constructor==Function?f=RMethod.name(b):b.constructor!=String&&RLogger.fatal(this,null,"Find class failure. (value={1})",b));return this.classes[f]}
function RClass_register(b,f,h){b=RMethod.name(b.constructor);this.classes[b].register(f);b=f.value();return null!=b?b:h}function RClass_createBase(b){return b?eval("function "+b+"(){return this;} new "+b+"();"):null}function RClass_createClass(b){var f=this.classes[b]=new TClass;f.name=b;f.base=this.createBase(b);f.clazz=new f.base.constructor;eval(b)(f.clazz);return f}
function RClass_create(b){var f=typeof b;"function"==f?b=RMethod.name(b):"string"!=f&&RLogger.fatal(this,null,"Param is invlid (name={1})",b);return this.createByName(b)}function RClass_createByName(b){(b=this.forName(b))||RLogger.fatal(this,null,"Cant find class. (name={1})",b);return b.newInstance()}
function RClass_innerCopy(b,f){if(null!=b&&null!=f)for(var h in b){var q=b[h];if(null!=q){var u=typeof q;if("function"==u){u=f[h];null==u?f[h]=q:RMethod.isVirtual(u)?f[h]=q:!RMethod.isVirtual(q)&&RMethod.isEmpty(u)?f[h]=q:RMethod.isVirtual(q)||RMethod.isEmpty(q)||(f[h]=q);continue}else if(!RClass.isBaseName(u)){null==f[h]&&(f[h]=new q.constructor);this.innerCopy(q,f[h]);continue}}f[h]=q}}
function RClass_build(b){var f=b.clazz.__inherits;if(f&&f.constructor==Array)for(var h=!1,q=f.length,u=0;u<q;u++){var z=f[u];RString.startsWith(z,"F")&&(h&&RLogger.fatal(this,null,"Parent class is too many. (name={1})",z),b.parent=RClass.forName(z),h=!0)}h=b.instance=new b.base.constructor;if(f&&f.constructor==Array)for(q=f.length,u=0;u<q;u++)if(z=f[u],!RString.startsWith(z,"F")){var A=RClass.forName(z);null==A&&RLogger.fatal(this,null,"Parent class is not exists. (name={1})",z);RClass.innerCopy(A.instance,
h);b.assign(A)}b.parent&&(this.innerCopy(b.parent.instance,h),b.assign(b.parent));h.__base||(h.__base=new TClassBase);h.__base[b.name]=new b.base.constructor;var A=b.clazz,B;for(B in A)"__base"!=B&&(null==A[B]&&null==h[B]?h[B]=null:null!=A[B]&&(null==h[B]||null!=h[B]&&A[B]!=h[B])&&(h[B]=A[B]));if(f&&f.constructor==Array)for(q=f.length,u=0;u<q;u++)for(B in z=f[u],A=RClass.forName(z),z=h.__base[z]=new A.base.constructor,A=A.instance,A)if("__base"!=B){var C=A[B],D=h[B];null!=C&&null!=D&&C!=D&&C.constructor==
Function&&D.constructor==Function&&(z[B]=A[B])}b.build();if(RRuntime.isRelease())for(B in b.instance)null==b.instance[B]&&delete b.instance[B]}function RClass_free(b){var f=b.__class;f&&f.free(b)}
function RClass_dump(b){if(null==b)return"@null";var f=this.safeTypeOf(b);switch(f){case "Boolean":return"Boolean:"+b;case "Number":return"Number:"+b;case "String":return f+"<"+b.length+">:"+b;case "Function":return f+"<"+RMethod.name(b)+">@"+this.code(b);case "Html":return f+"<"+b.tagName+">@"+this.code(b);default:if(b.__name)return f+"<"+b.__name+">@"+this.code(b)}return f+"@"+this.code(b)}
var RConsole=new function(){this.ConsolePreFix="console:";this._registers=new TObjects;this._consoles=new TDictionary;this._localConsoles=new TDictionary;this.initialize=RConsole_initialize;this.register=RConsole_register;this.create=RConsole_create;this.createByName=RConsole_createByName;this.get=RConsole_get;this.find=RConsole_find;this.release=RConsole_release;return this};function RConsole_initialize(){for(var b=this._registers,f=0;f<b;f++){var h=b.get(f);h.force&&this.find(h.clazz)}}
function RConsole_register(b){this._registers.push(b)}function RConsole_create(b){var f=null;if(b){var f=RClass.create(b),h;for(h in f)if(RString.startsWith(h,"lnk")){var q=f[h];if("string"==typeof q&&RString.startsWith(q,"&")){var u=this.find(q.substr(1));if(!u)return RMessage.fatal(this,null,"Can't link console. (name={0}, property={1}:{2})",b,h,q);f[h]=u}}}return f}
function RConsole_createByName(b){var f=null;if(b){var f=RClass.createByName(b),h;for(h in f)if(RString.startsWith(h,"lnk")){var q=f[h];if("string"==typeof q&&RString.startsWith(q,"&")){var u=this.find(q.substr(1));if(!u)return RMessage.fatal(this,null,"Can't link console. (name={0}, property={1}:{2})",b,h,q);f[h]=u}}}return f}function RConsole_get(b){b=RClass.name(b);return this._consoles.get(b)}
function RConsole_find(b){var f=null;if(b.constructor=String)f=RClass.name(b);else if(b.constructor==Function)f=b;else return RLogger.fatal(this,null,"Parameter type is invalid. (console={1})",b);if((b=RGlobal.get(this.ConsolePreFix+f))||(b=this._consoles.get(f)))return b;var h=RClass.forName(f).instance.scopeCd();switch(h){case EScope.Global:b=top.RConsole.createByName(f);RGlobal.set(this.ConsolePreFix+f,b);this._consoles.set(f,b);break;case EScope.Local:b=this.createByName(f);this._localConsoles.set(f,
b);this._consoles.set(f,b);break;default:return RLogger.fatal(this,"Unknown scope code. (name={1})",f)}RLogger.info(this,"Create console. (name={1}, scope={2})",f,REnum.decode(EScope,h));return b}function RConsole_release(){this._registers&&(this._registers.dispose(),this._registers=null);var b=this._localConsoles;if(b){for(var f=b.count(),h=0;h<f;h++)b.value(h).dispose();b.dispose()}this._localConsoles=null;this._consoles&&this._consoles.dispose();this._consoles=null}
var RDate=new function(){this.MinYear=1800;this.MaxYear=2400;this.Pattern="n-: /";this.Chars="0123456789-:/";this.DisplayFormat="yyyy-mm-dd hh24:mi:ss";this.DataFormat="yyyymmddhh24miss";this.MonthDays=[0,31,28,31,30,31,30,31,31,30,31,30,31];this.DaySeconds=1E3;this.Parts="YYYY MM DD HH24 MI SS".split(" ");this.PartsDefine={YYYY:["Year",4],MM:["Month",2],DD:["Day",2],HH24:["Hour",2],MI:["Minute",2],SS:["Second",2]};this.nvl=RDate_nvl;this.make=RDate_make;this.format=RDate_format;this.formatDate=RDate_formatDate;
this.formatText=RDate_formatText;this.monthDays=RDate_monthDays;this.splitFormat=RDate_splitFormat;this.makeDate=RDate_makeDate;this.checkItems=RDate_checkItems;this.check=RDate_check;this.parse=RDate_parse;this.splitDate=RDate_splitDate;this.splitTime=RDate_splitTime;this.autoParse=RDate_autoParse;this.getFormat=RDate_getFormat;return this};function RDate_nvl(b){return b?b:new TDate}function RDate_make(b,f,h,q,u,z){return new TDate(new Date(b,f,h))}
function RDate_format(b){return this.formatDate(new TDate,b)}function RDate_formatText(b,f){if(!b)return!1;f=f.toLowerCase();f=f.replace(/yyyy/g,b.substring(0,4));b=b.substring(4);f=f.replace(/mm/g,b.substring(0,2));b=b.substring(2);f=f.replace(/dd/g,b.substring(0,2));b=b.substring(2);f=f.replace(/hh24/g,b.substring(0,4));b=b.substring(4);f=f.replace(/mi/g,b.substring(0,2));b=b.substring(2);f=f.replace(/ss/g,b.substring(0,2));b.substring(2);return f}
function RDate_formatDate(b,f){if(!b)return"";f=f?f.toLowerCase():this.DataFormat;f=f.replace(/yyyy/g,RInteger.format(b.year,4));f=f.replace(/yy/g,RInteger.format(b.year%100,2));f=f.replace(/mm/g,RInteger.format(b.month,2));f=f.replace(/dd/g,RInteger.format(b.day,2));f=f.replace(/hh24/g,RInteger.format(b.hour,2));f=f.replace(/mi/g,RInteger.format(b.minute,2));f=f.replace(/ss/g,RInteger.format(b.second,2));return f=f.replace(/ms/g,RInteger.format(b.ms,3))}
function RDate_monthDays(b,f){if(!b||!f)return 0;b=parseInt(b);f=parseInt(f);this.MonthDays[2]=0!=b%4&&0!=b%400||0==b%100?28:29;return this.MonthDays[f]}
function RDate_splitFormat(b,f){if(!b)return!1;f=f.toLowerCase();for(var h=[];0<f.length;)0==f.indexOf("yyyy")?(h.year=b.substring(0,4),f=f.substring(4),b=b.substring(4)):0==f.indexOf("mm")?(h.month=b.substring(0,2),f=f.substring(2),b=b.substring(2)):0==f.indexOf("dd")?(h.day=b.substring(0,2),f=f.substring(2),b=b.substring(2)):0==f.indexOf("hh24")?(h.hour=b.substring(0,2),f=f.substring(4),b=b.substring(2)):0==f.indexOf("mi")?(h.minute=b.substring(0,2),f=f.substring(2),b=b.substring(2)):0==f.indexOf("ss")?
(h.second=b.substring(0,2),f=f.substring(2),b=b.substring(2)):0==f.indexOf("ms")?(h.ms=b.substring(0,2),f=f.substring(2),b=b.substring(3)):(f=f.substring(1),b=b.substring(1));return h}
function RDate_checkItems(b){if(!b)return!1;var f=RInteger.parse(b.year);if(f<this.MinYear||f>this.MaxYear)return!1;var h=RInteger.parse(b.month);if(1>h||12<h)return!1;var q=RInteger.parse(b.day);if(1>q||q>this.monthDays(f,h))return!1;f=RInteger.parse(b.hour);if(0>f||23<f)return!1;f=RInteger.parse(b.second);if(0>f||59<f)return!1;b=RInteger.parse(b.ms);return 0>b||99<b?!1:!0}function RDate_check(b,f){return this.checkItems(this.splitFormat(b,f))}
function RDate_makeDate(b,f){var h=new Date(RInteger.parse(f.year),RInteger.parse(f.month)-1,RInteger.parse(f.day),RInteger.parse(f.hour),RInteger.parse(f.minute),RInteger.parse(f.second),RInteger.parse(f.ms));return b?(b.setDate(h),b):new TDate(h)}function RDate_parse(b,f,h){h||(h=this.DataFormat);f=this.splitFormat(f,h);return this.checkItems(f)?this.makeDate(b,f):null}
function RDate_splitDate(b,f){if(f){var h=null;-1!=f.indexOf("-")||-1!=f.indexOf("/")?(-1!=f.indexOf("-")?h=f.split("-"):-1!=f.indexOf("/")&&(h=f.split("/")),1<=h.length&&(b.year=RInteger.parse(h[0])),2<=h.length&&(b.month=RInteger.parse(h[1])),3<=h.length&&(b.day=RInteger.parse(h[2]))):-1!=f.indexOf(":")?this.splitTime(b,f):14==f.length?(b.year=RInteger.parse(f.substr(0,4)),b.month=RInteger.parse(f.substr(4,2)),b.day=RInteger.parse(f.substr(6,2)),b.hour=RInteger.parse(f.substr(8,2)),b.minute=RInteger.parse(f.substr(10,
2)),b.second=RInteger.parse(f.substr(12,2))):8==f.length?(b.year=RInteger.parse(f.substr(0,4)),b.month=RInteger.parse(f.substr(4,2)),b.day=RInteger.parse(f.substr(6,2))):6==f.length?(b.year=RInteger.parse(f.substr(0,4)),b.month=RInteger.parse(f.substr(4,2))):4==f.length&&(b.year=RInteger.parse(f))}}
function RDate_splitTime(b,f){if(f)if(-1!=f.indexOf(":")){var h=f.split(":");1<=h.length&&(b.hour=RInteger.parse(h[0]));2<=h.length&&(b.minute=RInteger.parse(h[1]));3<=h.length&&(b.second=RInteger.parse(h[2]))}else 6==f.length?(b.hour=RInteger.parse(f.substr(0,2)),b.minute=RInteger.parse(f.substr(2,2)),b.second=RInteger.parse(f.substr(4,2))):4==f.length?(b.hour=RInteger.parse(f.substr(0,2)),b.minute=RInteger.parse(f.substr(2,2))):2==f.length&&(b.hour=RInteger.parse(f.substr(0,2)))}
function RDate_autoParse(b,f){if(!f)return null;b=this.nvl(b);var h=[];h.year=2E3;h.month=1;h.day=1;h.hour=0;h.minute=0;h.second=0;f=RString.trim(f);if(-1==f.indexOf(" "))this.splitDate(h,f);else{var q=f.split(" ");2==q.length&&(this.splitDate(h,q[0]),this.splitTime(h,q[1]))}return this.checkItems(h)?this.makeDate(b,h):null}
function RDate_getFormat(b){var f="",h="";if(b){if(-1!=b.indexOf(":"))if(b=RString.split(b," "),1==b.length)b=RString.split(b[0],":"),1==b.length?(f+="HH24",h=1==b[0].length?h+("0"+b[0]):h+b[0]):2==b.length?(f+="HH24MI",1==b[0].length?h+="0"+b[0]:2==b[0].length&&(h+=b[0]),1==b[1].length?h+="0"+b[1]:2==b[1].length&&(h+=b[1])):3==b.length&&(f+="HH24MISS",1==b[0].length?h+="0"+b[0]:2==b[0].length&&(h+=b[0]),1==b[1].length?h+="0"+b[1]:2==b[1].length&&(h+=b[1]),1==b[2].length?h+="0"+b[2]:2==b[2].length&&
(h+=b[2]));else{if(2==b.length){var q=RString.split(b[0],"-");3==q.length?(f+="YYYYMMDD",4==q[0].length&&(h+=q[0]),1==q[1].length?h+="0"+q[1]:2==q[1].length&&(h+=q[1]),1==q[2].length?h+="0"+q[2]:2==q[2].length&&(h+=q[2])):2==q.length?(f+="YYYYMM",1==q[0].length&&(h+=q[0]),1==q[1].length?h+="0"+q[1]:2==q[1].length&&(h+=q[1])):1==q.length&&(f+="YYYY",4==q[0].length&&(h+=q[0]));b=RString.split(b[1],":");1==b.length?(f+="HH24",h=1==b[0].length?h+("0"+b[0]):h+b[0]):2==b.length?(f+="HH24MI",1==b[0].length?
h+="0"+b[0]:2==b[0].length&&(h+=b[0]),1==b[1].length?h+="0"+b[1]:2==b[1].length&&(h+=b[1])):3==b.length&&(f+=" HH24MISS",1==b[0].length?h+="0"+b[0]:2==b[0].length&&(h+=b[0]),1==b[1].length?h+="0"+b[1]:2==b[1].length&&(h+=b[1]),1==b[2].length?h+="0"+b[2]:2==b[2].length&&(h+=b[2]))}}else b=RString.split(b,"-"),3==b.length?(f+="YYYYMMDD",4==b[0].length&&(h+=b[0]),1==b[1].length?h+="0"+b[1]:2==b[1].length&&(h+=b[1]),1==b[2].length?h+="0"+b[2]:2==b[2].length&&(h+=b[2])):2==b.length?(f="YYYYMM",4==b[0].length&&
(h+=b[0]),1==b[1].length?h+="0"+b[1]:2==b[1].length&&(h+=b[1])):1==b.length&&(f+="YYYY",4==b[0].length&&(h+=b[0]));b=Array(2);b[0]=f;b[1]=h;return b}}var REnum=new function(){this.contains=REnum_contains;this.tryEncode=REnum_tryEncode;this.encode=REnum_encode;this.tryDecode=REnum_tryDecode;this.decode=REnum_decode;this.parse=REnum_encode;this.format=REnum_decode;return this};function REnum_contains(){}
function REnum_tryEncode(b,f,h){if(null!=b)for(var q in b)if(q.toLowerCase()==f.toLowerCase())return b[q];return h}function REnum_encode(b,f){var h=this.tryEncode(b,f);if(null==h)throw new TError(this,"Invalid value (enum={1}, value={2})",RClass.dump(b),f);return h}function REnum_tryDecode(b,f,h){if(null!=b)for(var q in b)if(b[q]==f)return q;return h}
function REnum_decode(b,f){var h=this.tryDecode(b,f);if(null==h)throw new TError(this,"Invalid value (enum={1}, value={2})",RClass.dump(b),f);return h}var RFile=new function(){this.pictures=["jpg","png","gif","bmp"];this.knowns="jpg png gif bmp doc docx vsd xls xlsx".split(" ");this.inPicture=RFile_inPicture;this.isPicture=RFile_isPicture;this.isKnown=RFile_isKnown;this.extend=RFile_extend;RMemory.register("RFile",this);return this};
function RFile_inPicture(b){if(b){b=b.toLowerCase();for(var f in this.pictures)if(this.pictures[f]==b)return!0}}function RFile_isPicture(b){return this.inPicture(this.extend(b))}function RFile_isKnown(b){b=this.extend(b).toLowerCase();for(var f in this.knowns)if(this.knowns[f]==b)return!0;return!1}function RFile_extend(b){if(b){b=b.replace(/\\/g,"/");var f=b.lastIndexOf("/");-1!=f&&(b=b.substring(f+1));f=b.lastIndexOf(".");return-1!=f?b.substring(f+1):b}return""}
var RFloat=new function(){this.NUMBER=this.Chars="0123456789-.%";this.LEFT_CHAR="0";this.isFloat=RFloat_isFloat;this.parse=RFloat_parse;this.format=RFloat_format;this.nvl=RFloat_nvl;this.toRange=RFloat_toRange;this.sum=RFloat_sum;this.calculate=RFloat_calculate;this.fill=RFloat_fill;this.copy=RFloat_copy;return this};function RFloat_isFloat(b){return RString.isPattern(b,"n")}
function RFloat_parse(b){if(null==b||""==b)return 0;for(b=RString.trim(b.toString());"0"==b.charAt(0);)b=b.substr(1);var f=0<b.length?parseFloat(b):0;-1!=RString.findChars(b,"%")&&(f/=100);return isNaN(f)?0:f}function RFloat_format(b,f,h,q,u){null==f&&(f=0);null==h&&(h=this.LEFT_CHAR);null==q&&(q=7);null==u&&(u=this.LEFT_CHAR);var z=b.toString(),A=z.indexOf(".");-1==A?(b=z,z=""):(b=z.substring(0,A),z=z.substring(A+1,A+q+1));f=RString.lpad(b,f,h);q=RString.rpad(z,q,u);return f+"."+q}
function RFloat_nvl(b,f){return b?b:f?f:0}function RFloat_toRange(b,f,h){null==b&&(b=0);return Math.min(Math.max(b,f),h)}function RFloat_sum(){for(var b=arguments,f=0,h=b.length-1;0<=h;h--){var q=b[n];null!=q&&(f+=parseFloat(q))}return f}function RFloat_calculate(b,f,h){f=RFloat.nvl(f);h=RFloat.nvl(h);f=parseFloat(f);h=parseFloat(h);return b?(f+h).toString():(f-h).toString()}function RFloat_fill(b,f,h,q){for(var u=0;u<h;u++)b[f++]=q}
function RFloat_copy(b,f,h,q,u){for(var z=0;z<u;z++)b[f++]=h[q++]}var RHex=new function(){this.NUMBER="0x123456789ABCDEF";this.PAD="0";this.isValid=RHex_isValid;this.parse=RHex_parse;this.format=RHex_format;return this};function RHex_isValid(b){return RString.isPattern(b,this.NUMBER)}function RHex_parse(b){return b?parseInt("0x"+b):"0"}function RHex_format(b,f){var h=null,h=b?b.toString(16):"0";return f?RString.lpad(h,f,this.PAD):h}
var RInstance=new function(){this._pools=new TDictionary;this.pool=RInstance_pool;this.get=RInstance_get;this.alloc=RInstance_alloc;this.free=RInstance_free;return this};function RInstance_pool(b){b=RClass.name(b);var f=this._pools.get(b);null==f&&(f=new TInstancePool,this._pools.set(b,f));return f}function RInstance_get(b){return this.pool(b).instance(b)}function RInstance_alloc(b){return this.pool(p).alloc(p)}function RInstance_free(b){this.pool(p).free(p)}
var RInteger=new function(){this.NUMBER=this.Chars="0123456789-%";this.LEFT_CHAR="0";this.MAX_UINT16=65535;this.MAX_UINT32=4294967295;this.isInt=RInteger_isInt;this.nvl=RInteger_nvl;this.parse=RInteger_parse;this.format=RInteger_format;this.toRange=RInteger_toRange;this.sum=RInteger_sum;this.calculate=RInteger_calculate;return this};function RInteger_isInt(b){return RString.isPattern(b,"n")}function RInteger_nvl(b,f){return b?b:f?f:0}
function RInteger_parse(b,f){null==f&&(f=0);if(null==b||""==b)return f;for(b=RString.trim(b.toString());"0"==b.charAt(0);)b=b.substr(1);var h=0<b.length?parseInt(b):f;return isNaN(h)?f:h}function RInteger_format(b,f,h){h||(h=this.LEFT_CHAR);b=b.toString();for(f=parseInt(f)-b.length-1;0<=f;f--)b=h+b;return b}function RInteger_toRange(b,f,h){null==b&&(b=0);isNaN(b)&&(b=0);b<f&&(b=f);b>h&&(b=h);return b}
function RInteger_sum(){for(var b=0,f=arguments,h=f.length,q=0;q<h;q++)null!=f[q]&&(b+=parseInt(f[q]));return b}function RInteger_calculate(b,f,h){f=RInteger.parse(f);h=RInteger.parse(h);var q="";"+"==b?q=f+h:"-"==b?q=f-h:"x"==b?q=f*h:"/"==b&&(q=f/h);return q.toString()}
var RLogger=new function(){this._statusError=!1;this._labelLength=40;this.lsnsOutput=new TListeners;this.output=RLogger_output;this.debug=RLogger_debug;this.info=RLogger_info;this.warn=RLogger_warn;this.error=RLogger_error;this.fatal=RLogger_fatal;return this};function RLogger_output(b,f){this.lsnsOutput.process(b,f)}
function RLogger_debug(b,f,h){var q=RMethod.name(RLogger_debug.caller),q=q.replace("_","."),u=new TString;u.append(RDate.format("yymmdd-hh24miss.ms"));u.append("|D ["+RString.rpad(q,this._labelLength)+"] ");for(var z=arguments,A=z.length,q=2;q<A;q++){var B=z[q],C="";null!=B&&(C="function"==typeof B?RMethod.name(B):B.toString());f=f.replace("{"+(q-1)+"}",C)}u.append(f);this.output(b,u.flush())}
function RLogger_info(b,f,h){var q=RMethod.name(RLogger_info.caller),q=q.replace("_","."),u=new TString;u.append(RDate.format("yymmdd-hh24miss.ms"));u.append("|I ["+RString.rpad(q,this._labelLength)+"] ");for(var z=arguments,A=z.length,q=2;q<A;q++){var B=z[q],C="";null!=B&&(C="function"==typeof B?RMethod.name(B):B.toString());f=f.replace("{"+(q-1)+"}",C)}u.append(f);this.output(b,u.flush())}
function RLogger_warn(b,f,h){var q=RMethod.name(RLogger_warn.caller),q=q.replace("_","."),u=new TString;u.append(RDate.format("yymmdd-hh24miss.ms"));u.append("|W ["+RString.rpad(q,this._labelLength)+"] ");for(var z=arguments,A=z.length,q=2;q<A;q++){var B=z[q],C="";null!=B&&(C="function"==typeof B?RMethod.name(B):B.toString());f=f.replace("{"+(q-1)+"}",C)}u.append(f);this.output(b,u.flush())}function RLogger_error(b,f,h,q){if(!this._statusError)throw this._statusError=!0,Error(h);}
function RLogger_fatal(b,f,h,q){if(!this._statusError){this._statusError=!0;for(var u=new TString,z=[],A=RLogger_fatal.caller;A&&!RArray.contains(z,A);)z.push(A),A=A.caller;for(var B=z.length,C=0;C<B;C++)A=z[C],0<C&&u.appendLine(),u.append("   "+(B-C)+": "+RMethod.name(A));z=new TString;z.appendLine(RContext.get("RMessage:fatal"));z.appendLine(RString.repeat("-",60));z.append(RClass.dump(b),": ");if(h)for(A=arguments,B=A.length,C=3;C<B;C++){var D=A[C];"function"==typeof D&&(D=RMethod.name(D));h=h.replace("{"+
(C-2)+"}",D)}z.appendLine(h);z.appendLine(RString.repeat("-",60));z.appendLine("Stack:");z.append(u);alert(z)}}
var RMethod=new function(){this._virtuals={};this.isFunction=RMethod_isFunction;this.isEmpty=RMethod_isEmpty;this.isVirtual=RMethod_isVirtual;this.name=RMethod_name;this.fullName=RMethod_fullName;this.empty=RMethod_empty;this.emptyTrue=RMethod_emptyTrue;this.emptyFalse=RMethod_emptyFalse;this.emptyCall=RMethod_emptyCall;this.virtual=RMethod_virtual;this.empty.__empty=!0;this.emptyTrue.__empty=!0;this.emptyFalse.__empty=!0;return this};function RMethod_isFunction(b){return"function"==typeof b}
function RMethod_isEmpty(b){return b&&b.__empty}function RMethod_isVirtual(b){return b&&b.__virtual}function RMethod_name(b){return b&&"function"==typeof b?b.__name?b.__name:b.__name=RString.mid(b.toString(),"function ","("):null}function RMethod_fullName(b){return b&&b.constructor==Function?b.__fullname?b.__fullname:b.__fullname=RString.mid(b.toString(),"function ",")")+")":null}function RMethod_empty(){}function RMethod_emptyTrue(){return!0}function RMethod_emptyFalse(){return!1}
function RMethod_emptyCall(){}function RMethod_virtual(b,f){var h=RClass.name(b)+"."+f;if(this._virtuals[h])return this._virtuals[h];var q=function(){throw Error("Virtual method be called.("+h+")");};q.__virtual=!0;q.__name=h;return this._virtuals[h]=q}var RObject=new function(){this._hash=1;this.nextId=RObject_nextId;this.nvl=RObject_nvl;this.clone=RObject_clone;this.copy=RObject_copy;this.free=RObject_free;this.dispose=RObject_dispose;this.release=RObject_release;return this};
function RObject_nextId(b){return this._hash++}function RObject_nvl(b){for(var f=arguments,h=f.length,q=0;q<h;q++)if(null!=f[q])return f[q];return null}function RObject_clone(b){var f=new b.constructor,h;for(h in b){var q=b[h];null!=q&&(RClass.isBaseType(q.constructor)||(q=RObject.clone(q)));f[h]=q}return f}function RObject_copy(b,f){if(null!=b&&null!=f)for(var h in b){var q=b[h];null==q||RClass.isBaseType(q.constructor)||(null==f[h]&&(f[h]=new c),RObject.copy(q,f[h]));f[h]=q}}
function RObject_free(b){if(b)if(RRuntime.isDebug())for(var f in b)if("__base"==f||"__inherits"==f||"__class"==f)b[f]=null;else{var h=b[f];if(null!=h){if(!RClass.isBaseType(h.constructor))throw new TError(RObject,"Free object is not base object.");b[f]=null}}else for(f in b)b[f]=null}function RObject_dispose(b){b&&b.dispose();return null}function RObject_release(b){if(b)for(var f in b){var h=b[f];"Object"==typeof h&&RObject.release(h);b[f]=null}}
var RRandom=new function(){this._seed=(new Date).getTime();this.get=RRandom_get;this.rand=RRandom_rand;RMemory.register("RRandom",this);return this};function RRandom_get(){this._seed=(9301*this._seed+49297)%233280;return this._seed/233280}function RRandom_rand(b){return Math.ceil(this.get()*b)}var RRect=new function(){this.nvl=RRect_nvl;this.pack=RRect_pack;this.unpack=RRect_unpack;return this};function RRect_nvl(b){return b?b:new TRect}
function RRect_pack(b){var f=null;b&&(f=b.left+","+b.top+","+b.right+","+b.bottom);return f}function RRect_unpack(b,f){f=this.nvl(f);if(b){var h=b.split(",");4==h.length&&(f.left=RInt.parse(h[0]),f.top=RInt.parse(h[1]),f.right=RInt.parse(h[2]),f.bottom=RInt.parse(h[3]))}return f}var RRegExp=new function(){this.test=RRegExp_test;this.testRgexp=RRegExp_testRgexp;return this};function RRegExp_test(b,f){return b&&null!=f?b.test(f):!1}function RRegExp_testRgexp(b,f){return b&&f?(new R,b.test(f)):!1}
var RSet=new function(){this.contains=RSet_contains;this.containsString=RSet_containsString;return this};function RSet_contains(b,f){return(b&f)==f}function RSet_containsString(b,f){return null!=b&&null!=s?-1!=b.indexOf(s):!1}
var RString=new function(){this.EMPTY="";this.SPACE="   ";this.PAD=" ";this.TRIM=" \t\r\n";this.LOWER="abcdefghijklmnopqrstuvwxyz";this.UPPER="ABCDEFGHIJKLMNOPQRSTUVWXYZ";this.CodeLowerA=97;this.CodeLowerZ=122;this.CodeUpperA=65;this.CodeUpperZ=90;this.isEmpty=RString_isEmpty;this.isBlank=RString_isBlank;this.isAnsi=RString_isAnsi;this.isDbcs=RString_isDbcs;this.isPattern=RString_isPattern;this.inChars=RString_inChars;this.contains=RString_contains;this.equals=RString_equals;this.startsWith=RString_startsWith;
this.endsWith=RString_endsWith;this.findChars=RString_findChars;this.inRange=RString_inRange;this.nvl=RString_nvl;this.empty=RString_empty;this.firstUpper=RString_firstUpper;this.firstLower=RString_firstLower;this.firstLine=RString_firstLine;this.format=RString_format;this.formatLines=RString_formatLines;this.repeat=RString_repeat;this.pad=RString_pad;this.lpad=RString_lpad;this.rpad=RString_rpad;this.trim=RString_trim;this.ltrim=RString_ltrim;this.rtrim=RString_rtrim;this.mid=RString_mid;this.toLine=
RString_toLine;this.toUnderline=RString_toUnderline;this.toLower=RString_toLower;this.toUpper=RString_toUpper;this.split=RString_split;this.splitTwo=RString_splitTwo;this.splitParts=RString_splitParts;this.splitPattern=RString_splitPattern;this.replace=RString_replace;this.replaceChar=RString_replaceChar;this.remove=RString_remove;this.removeChars=RString_removeChars;return this};function RString_isEmpty(b){return null!=b?0==b.length:!0}
function RString_isBlank(b){return null!=b?0==b.trim().length:!0}function RString_isAnsi(b){if(null!=b){for(var f=b.length,h=0;h<f;h++)if(255<b.charCodeAt(h))return!1;return!0}return!1}function RString_isDbcs(b){if(null==b){b=b.length;for(var f=0;f<b;f++)if(256>value.charCodeAt(f))return!1;return!0}return!1}
function RString_isPattern(b,f){if(null!=b){null==f&&(f="$a$A$f");f=f.replace(/\a/g,this.LOWER);f=f.replace(/\A/g,this.UPPER);f=f.replace(/\f/g,RFloat.NUMBER);f=f.replace(/\n/g,RInt.NUMBER);for(var h=b.length,q=0;q<h;q++)if(-1==f.indexOf(b.charAt(q)))return!1;return!0}return!1}function RString_inChars(b,f){return-1!=this.findChars(f,b)?!0:!1}function RString_contains(b,f){return null!=b&&null!=f?-1!=b.toString().indexOf(f):!1}
function RString_equals(b,f,h){null==b?b="":b.constructor!=String&&(b=b.toString());null==f?f="":f.constructor!=String&&(f=f.toString());return h?b==f:b.toLowerCase()==f.toLowerCase()}function RString_startsWith(b,f){return null==f?!0:null!=b?0==b.indexOf(f):!1}function RString_endsWith(b,f){if(null==f)return!0;var h=null!=b?b.indexOf(f):-1;return-1!=h?h==b.length-f.length:!1}
function RString_findChars(b,f){if(null!=b&&null!=f)for(var h=b.length,q=0;q<h;q++)if(-1!=f.indexOf(b.charAt(q)))return q;return-1}function RString_inRange(b,f,h){if(b&&f){h||(b=b.toLowerCase());for(var q=f.length,u=0;u<q;u++){var z=f[u];if(null!=z)if(h){if(b==z)return!0}else if(b==z.toLowerCase())return!0}}return!1}function RString_nvl(b,f){if(null!=b){var h=null,h=b.constructor!=String?b.toString():b;if(0<h.length)return h}return null!=f?f:this.EMPTY}
function RString_empty(b){if(null!=b){var f=null,f=b.constructor!=String?b.toString():b;if(0<f.length)return f}return null}function RString_firstUpper(b){return null!=b?b.charAt(0).toUpperCase()+b.substr(1):b}function RString_firstLower(){return null!=v?v.charAt(0).toLowerCase()+v.substr(1):v}function RString_firstLine(b){if(b){var f=Math.min(b.indexOf("\r"),b.indexOf("\n"));return-1!=f?b.substr(0,f):b}return""}
function RString_format(b,f){for(var h=arguments,q=h.length,u=1;u<q;u++)f=h[u],"function"==typeof f?f=RMethod.name(f):null==f&&(f=""),b=b.replace("{"+(u-1)+"}",f);return b}function RString_formatLines(b){b=b.replace(/\\r/g,"");b=b.split("\n");for(var f=b.length,h=new TString,q=0;q<f;q++){var u=b[q],u=this.trim(u);this.isEmpty(u)||this.startsWith(u,"//")||h.appendLine(u)}return h.toString()}function RString_repeat(b,f){return Array(f+1).join(b)}
function RString_pad(b,f,h){b=null!=b?b.toString():this.EMPTY;f-=b.length;if(0<f){null==h&&(h=this.PAD);var q=0==f%2?f/2:(f-1)/2;return Array(q+1).join(h)+b+Array(f-q+1).join(h)}return b}function RString_lpad(b,f,h){b=null!=b?b.toString():this.EMPTY;f-=b.length;return 0<f?(null==h&&(h=this.PAD),f=Array(f),f[f.length]=b,f.join(h)):b}function RString_rpad(b,f,h){b=null!=b?b.toString():this.EMPTY;f-=b.length;return 0<f?(null==h&&(h=this.PAD),b+Array(f+1).join(h)):b}
function RString_trim(b,f){b=this.nvl(b);f=this.nvl(f,this.TRIM);for(var h=0,q=b.length-1;h<q&&-1!=f.indexOf(b.charAt(h));h++);for(;q>=h&&-1!=f.indexOf(b.charAt(q));q--);return h==q+1?null:0!=h||q!=b.length-1?b.substring(h,q+1):b}function RString_ltrim(b,f){b=this.nvl(value);f=this.nvl(trims,this.TRIM);for(var h=0,q=b.length-1;h<q&&-1!=f.indexOf(b.charAt(h));h++);return 0!=h?b.substring(h,q+1):b}
function RString_rtrim(b,f){b=this.nvl(b);f=this.nvl(f,this.TRIM);for(var h=b.length-1;0<=h&&-1!=f.indexOf(b.charAt(h));h--);return h!=b.length-1?b.substring(0,h+1):b}function RString_mid(b,f,h){if(null==b)return b;var q=0;if(null!=f){var u=b.indexOf(f);-1!=u&&(q=u+f.length)}f=b.length;null!=h&&(u=b.indexOf(h,q),-1!=u&&(f=u));return b.substring(q,f)}function RString_toLine(b){return b.replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\t/g,"\\t")}
function RString_toUnderline(b){var f=null;if(b){for(var f=new TString,h=b.length,q=0;q<h;q++){var u=b.charAt(q);u.toUpperCase()==u?(0<q&&f.append("_"),f.append(u.toLowerCase())):f.append(u)}f=f.toString()}return f}function RString_toLower(b){return null!=b?b.toLowerCase():this.EMPTY}function RString_toUpper(b){return null!=b?b.toUpperCase():this.EMPTY}function RString_split(b,f){return b&&f?b.split(f):null}
function RString_splitTwo(b,f){if(b&&f){var h=[],q=b.indexOf(f);-1==q?h.push(b):(h.push(b.substring(0,q)),h.push(b.substring(q+f.length)));return h}return null}function RString_splitParts(b,f){for(var h=[],q=0,u=b.length,z=0;z<u;z++)for(var A in f)if(this.startsWith(f[A],b.charAt(z))&&this.equals(b.substr(z,f[A].length),f[A])){h[q++]=f[A];z=z+f[A].length-1;break}return h}
function RString_splitPattern(b,f){var h=[];if(b)for(var q=b.length,u=f.length,z="",A=0;A<q;A++){for(var B=!1,C=0;C<u;C++){var D=f[C];if(-1==b.indexOf(D)){z.length&&(h[h.length]=z,z="");h[h.length]=D;b=b.substring(D.length);B=!0;break}}B||(z+=b.charAt(0),b=b.substring(1))}return h}function RString_replace(b,f,h){return b.replace(new RegExp(f,"g"),h)}
function RString_replaceChar(b,f,h){if(null!=b){for(var q=b.length,u=[],z=0;z<q;z++){var A=b.charAt(z);u[u.length]=A==f?h:A}return u.join("")}return b}function RString_remove(b,f){return b.replace(f,"")}function RString_removeChars(b,f){if(null!=b){for(var h=b.length,q=[],u=0;u<h;u++){var z=b.charAt(u);-1==f.indexOf(z)&&(q[q.length]=z)}return q.join("")}return b}
var RTimer=new function(){this._count=this._lastTime=this._startTime=0;this.setup=RTimer_setup;this.current=RTimer_current;this.rate=RTimer_rate;this.update=RTimer_update;return this};function RTimer_setup(){var b=(new Date).getTime();this._lastTime=this._startTime=b}function RTimer_current(){return this._lastTime}function RTimer_rate(){return 0==this._count?0:parseInt(1E3*this._count/(this._lastTime-this._startTime))}function RTimer_update(){this._count++;this._lastTime=(new Date).getTime()}
var EFrustumPlane=new function(){this.Near=0;this.Far=1;this.Left=2;this.Right=3;this.Top=4;this.Bottom=5;this.Count=6;return this};
function SColor4(){this.blue=this.green=this.red=0;this.alpha=1;this.assign=SColor4_assign;this.assignPower=SColor4_assignPower;this.set=SColor4_set;this.serialize=SColor4_serialize;this.unserialize=SColor4_unserialize;this.unserialize3=SColor4_unserialize3;this.saveConfig=SColor4_saveConfig;this.savePower=SColor4_savePower;this.copyArray=SColor4_copyArray;this.toString=SColor4_toString;return this}function SColor4_assign(b){this.red=b.red;this.green=b.green;this.blue=b.blue;this.alpha=b.alpha}
function SColor4_assignPower(b){this.red=b.red*b.alpha;this.green=b.green*b.alpha;this.blue=b.blue*b.alpha;this.alpha=b.alpha}function SColor4_set(b,f,h,q){this.red=b;this.green=f;this.blue=h;this.alpha=q}function SColor4_serialize(b){b.writeFloat(this.red);b.writeFloat(this.green);b.writeFloat(this.blue);b.writeFloat(this.alpha)}function SColor4_unserialize(b){this.red=b.readFloat();this.green=b.readFloat();this.blue=b.readFloat();this.alpha=b.readFloat()}
function SColor4_unserialize3(b){this.red=b.readFloat();this.green=b.readFloat();this.blue=b.readFloat();this.alpha=1}function SColor4_saveConfig(b){b.setFloat("r",this.red);b.setFloat("g",this.green);b.setFloat("b",this.blue);b.setFloat("a",this.alpha)}function SColor4_savePower(b){b.setFloat("r",this.red);b.setFloat("g",this.green);b.setFloat("b",this.blue);b.setFloat("power",this.alpha)}
function SColor4_copyArray(b,f){b[f++]=this.red;b[f++]=this.green;b[f++]=this.blue;b[f++]=this.alpha;return 4}function SColor4_toString(){return this.red+","+this.green+","+this.blue+","+this.alpha}function SFrustum(){this.center=new SPoint3;this.maxZ=this.minZ=this.maxY=this.minY=this.maxX=this.minX=this.radius=null;this.points=Array(24);this.coners=Array(24);this.updateCenter=SFrustum_updateCenter;this.update=SFrustum_update;this.updateFlat=SFrustum_updateFlat;return this}
function SFrustum_updateCenter(){var b=this.coners;this.minX=this.minY=this.minZ=Number.MAX_VALUE;this.maxX=this.maxY=this.maxZ=-Number.MAX_VALUE;for(var f=0;24>f;){var h=b[f++];h<this.minX&&(this.minX=h);h>this.maxX&&(this.maxX=h);h=b[f++];h<this.minY&&(this.minY=h);h>this.maxY&&(this.maxY=h);h=b[f++];h<this.minZ&&(this.minZ=h);h>this.maxZ&&(this.maxZ=h)}this.center.x=.5*(this.minX+this.maxX);this.center.y=.5*(this.minY+this.maxY);this.center.z=.5*(this.minZ+this.maxZ);this.radius=.5*Math.sqrt((this.minX-
this.minY)*(this.minX-this.minY)+(this.minZ-this.maxX)*(this.minZ-this.maxX)+(this.maxY-this.maxZ)*(this.maxY-this.maxZ))}
function SFrustum_update(b,f,h,q,u,z,A,B){h=f/h;z=Math.tan(RMath.DEGREE_RATE*b*.5);b=q*z;f=b*h;z*=u;A=z*h;h=this.points;h[0]=-f;h[1]=b;h[2]=q;h[3]=f;h[4]=b;h[5]=q;h[6]=f;h[7]=-b;h[8]=q;h[9]=-f;h[10]=-b;h[11]=q;h[12]=-A;h[13]=z;h[14]=u;h[15]=A;h[16]=z;h[17]=u;h[18]=A;h[19]=-z;h[20]=u;h[21]=-A;h[22]=-z;h[23]=u;q=RMath.matrix;q.assign(B);q.invert();q.transform(this.coners,h,8);this.updateCenter()}
function SFrustum_updateFlat(b,f,h,q,u,z,A,B){f/=h;q*=A;u*=z;A=Math.tan(RMath.DEGREE_RATE*b*.5);b=q*A;z=b*f;A*=u;h=A*f;f=this.points;f[0]=-z;f[1]=b;f[2]=q;f[3]=z;f[4]=b;f[5]=q;f[6]=z;f[7]=-b;f[8]=q;f[9]=-z;f[10]=-b;f[11]=q;f[12]=-h;f[13]=A;f[14]=u;f[15]=h;f[16]=A;f[17]=u;f[18]=h;f[19]=-A;f[20]=u;f[21]=-h;f[22]=-A;f[23]=u;q=RMath.matrix;q.assign(B);q.invert();q.transform(this.coners,f,8);this.coners[1]=0;this.coners[4]=0;this.coners[7]=0;this.coners[10]=0;this.coners[13]=0;this.coners[16]=0;this.coners[19]=
0;this.coners[22]=0;this.updateCenter()}function SFrustumPlanes(){this.planes=[];this.containsPoint=SFrustumPlanes_containsPoint;this.containsCube=SFrustumPlanes_containsCube;this.containsRectangle=SFrustumPlanes_containsRectangle;this.containsCorners=SFrustumPlanes_containsCorners;this.containsSphere=SFrustumPlanes_containsSphere;this.updateVision=SFrustumPlanes_updateVision;for(var b=0;b<EFrustumPlane.Count;b++)this.planes.push(new SPlane);return this}
function SFrustumPlanes_containsPoint(b,f,h){for(var q=this.planes,u=0;u<EFrustumPlane.Count;u++)if(0>q[n].dot(b,f,h))return!1;return!0}function SFrustumPlanes_containsCube(b,f,h,q){q=this.planes;for(var u=0;u<EFrustumPlane.Count;u++){var z=q[n];if(!(0<=z.dot(b-l,f-l,h-l)||0<=z.dot(b+l,f-l,h-l)||0<=z.dot(b-l,f+l,h-l)||0<=z.dot(b+l,f+l,h-l)||0<=z.dot(b-l,f-l,h+l)||0<=z.dot(b+l,f-l,h+l)||0<=z.dot(b-l,f+l,h+l)||0<=z.dot(b+l,f+l,h+l)))return!1}return!0}
function SFrustumPlanes_containsRectangle(b,f,h,q,u,z){for(var A=this.planes,B=0;B<EFrustumPlane.Count;B++){var C=A[n];if(!(0<=C.dot(b-q,f-u,h-z)||0<=C.dot(b+q,f-u,h-z)||0<=C.dot(b-q,f+u,h-z)||0<=C.dot(b+q,f+u,h-z)||0<=C.dot(b-q,f-u,h+z)||0<=C.dot(b+q,f-u,h+z)||0<=C.dot(b-q,f+u,h+z)||0<=C.dot(b+q,f+u,h+z)))return!1}return!0}
function SFrustumPlanes_containsCorners(b){for(var f=this.planes,h=0;h<EFrustumPlane.Count;h++)if(b=f[n],!(0<=b.dot(b[0],b[1],b[2])||0<=b.dot(b[3],b[4],b[5])||0<=b.dot(b[6],b[7],b[8])||0<=b.dot(b[9],b[10],b[11])||0<=b.dot(b[12],b[13],b[14])||0<=b.dot(b[15],b[16],b[17])||0<=b.dot(b[18],b[19],b[20])||0<=b.dot(b[21],b[22],b[23])))return!1;return!0}function SFrustumPlanes_containsSphere(b,f,h,q){for(var u=this.planes,z=0;z<EFrustumPlane.Count;z++)if(u[n].dot(b,f,h)<-q)return!1;return!0}
function SFrustumPlanes_updateVision(b){var f=this.planes,h=f[EFrustumPlane.Near];h.a=b[2];h.b=b[6];h.c=b[10];h.d=b[14];h.normalize();h=f[EFrustumPlane.Far];h.a=b[3]-b[2];h.b=b[7]-b[6];h.c=b[11]-b[10];h.d=b[15]-b[14];h.normalize();h=f[EFrustumPlane.Left];h.a=b[3]+b[0];h.b=b[7]+b[4];h.c=b[11]+b[8];h.d=b[15]+b[12];h.normalize();h=f[EFrustumPlane.Right];h.a=b[3]-b[0];h.b=b[7]-b[4];h.c=b[11]-b[8];h.d=b[15]-b[12];h.normalize();h=f[EFrustumPlane.Top];h.a=b[3]-b[1];h.b=b[7]-b[5];h.c=b[11]-b[9];h.d=b[15]-
b[13];h.normalize();f=f[EFrustumPlane.Bottom];f.a=b[3]+b[1];f.b=b[7]+b[5];f.c=b[11]+b[9];f.d=b[15]+b[13];f.normalize()}
function SMatrix3d(){SMatrix4x4.call(this);this._dirty=!1;this.rz=this.ry=this.rx=this.tz=this.ty=this.tx=0;this.sz=this.sy=this.sx=1;this.isIdentity=SMatrix3d_isIdentity;this.identity=SMatrix3d_identity;this.setTranslate=SMatrix3d_setTranslate;this.setRotation=SMatrix3d_setRotation;this.setScale=SMatrix3d_setScale;this.setScaleAll=SMatrix3d_setScaleAll;this.set=SMatrix3d_set;this.setAll=SMatrix3d_setAll;this.equals=SMatrix3d_equals;this.assign=SMatrix3d_assign;this.attach=SMatrix3d_attach;this.append=
SMatrix3d_append;this.updateForce=SMatrix3d_updateForce;this.update=SMatrix3d_update;this.merge=SMatrix3d_merge;this.serialize=SMatrix3d_serialize;this.unserialize=SMatrix3d_unserialize;this.saveConfig=SMatrix3d_saveConfig;this.identity();return this}function SMatrix3d_isIdentity(){return 0!=this.tx||0!=this.ty||0!=this.tz||0!=this.rx||0!=this.ry||0!=this.rz||1!=this.sx||1!=this.sy||1!=this.sz?!1:this.isIdentityData()}
function SMatrix3d_identity(){this.rx=this.ry=this.rz=this.tx=this.ty=this.tz=0;this.sx=this.sy=this.sz=1;return this.identityData()}function SMatrix3d_setTranslate(b,f,h){this.tx=b;this.ty=f;this.tz=h;this._dirty=!0}function SMatrix3d_setRotation(b,f,h){this.rx=b;this.ry=f;this.rz=h;this._dirty=!0}function SMatrix3d_setScale(b,f,h){this.sx=b;this.sy=f;this.sz=h;this._dirty=!0}function SMatrix3d_setScaleAll(b){this.sz=this.sy=this.sx=b;this._dirty=!0}
function SMatrix3d_set(b,f,h){this.tx=b.x;this.ty=b.y;this.tz=b.z;this.rx=f.x;this.ry=f.y;this.rz=f.z;this.sx=h.x;this.sy=h.y;this.sz=h.z;this._dirty=!0}function SMatrix3d_setAll(b,f,h,q,u,z,A,B,C){this.tx=b;this.ty=f;this.tz=h;this.rx=q;this.ry=u;this.rz=z;this.sx=A;this.sy=B;this.sz=C;this._dirty=!0}function SMatrix3d_equals(b){return this.equalsData(b._data)}
function SMatrix3d_assign(b){this.tx=b.tx;this.ty=b.ty;this.tz=b.tz;this.rx=b.rx;this.ry=b.ry;this.rz=b.rz;this.sx=b.sx;this.sy=b.sy;this.sz=b.sz;this.assignData(b._data)}function SMatrix3d_attach(b){this.tx=b.tx;this.ty=b.ty;this.tz=b.tz;this.rx=b.rx;this.ry=b.ry;this.rz=b.rz;this.sx=b.sx;this.sy=b.sy;this.sz=b.sz;return this.attachData(b._data)}function SMatrix3d_append(b){this.appendData(b._data)}
function SMatrix3d_updateForce(){var b=this._data,f=Math.sin(this.rx),h=Math.cos(this.rx),q=Math.sin(this.ry),u=Math.cos(this.ry),z=Math.sin(this.rz),A=Math.cos(this.rz);b[0]=u*A*this.sx;b[1]=u*z*this.sx;b[2]=-q*this.sx;b[3]=0;b[4]=(f*q*A-h*z)*this.sy;b[5]=(f*q*z+h*A)*this.sy;b[6]=f*u*this.sy;b[7]=0;b[8]=(h*q*A+f*z)*this.sz;b[9]=(h*q*z-f*A)*this.sz;b[10]=h*u*this.sz;b[11]=0;b[12]=this.tx;b[13]=this.ty;b[14]=this.tz;b[15]=1}
function SMatrix3d_update(){this._dirty&&(this.updateForce(),this._dirty=!1)}function SMatrix3d_merge(b,f){this.tx=b.tx+f.tx;this.ty=b.ty+f.ty;this.tz=b.tz+f.tz;this.rx=b.rx+f.rx;this.ry=b.ry+f.ry;this.rz=b.rz+f.rz;this.sx=b.sx*f.sx;this.sy=b.sy*f.sy;this.sz=b.sz*f.sz;this.updateForce()}
function SMatrix3d_serialize(b){b.writeFloat(this.tx);b.writeFloat(this.ty);b.writeFloat(this.tz);b.writeFloat(this.rx);b.writeFloat(this.ry);b.writeFloat(this.rz);b.writeFloat(this.sx);b.writeFloat(this.sy);b.writeFloat(this.sz)}function SMatrix3d_unserialize(b){this.tx=b.readFloat();this.ty=b.readFloat();this.tz=b.readFloat();this.rx=b.readFloat();this.ry=b.readFloat();this.rz=b.readFloat();this.sx=b.readFloat();this.sy=b.readFloat();this.sz=b.readFloat();this.updateForce()}
function SMatrix3d_saveConfig(b){b.set("tx",RFloat.format(this.tx));b.set("ty",RFloat.format(this.ty));b.set("tz",RFloat.format(this.tz));b.set("rx",RFloat.format(this.rx));b.set("ry",RFloat.format(this.ry));b.set("rz",RFloat.format(this.rz));b.set("sx",RFloat.format(this.sx));b.set("sy",RFloat.format(this.sy));b.set("sz",RFloat.format(this.sz))}
function SMatrix3x3(){this._data=Array(9);this.data=SMatrix3x3_data;this.equalsData=SMatrix3x3_equalsData;this.assignData=SMatrix3x3_assignData;this.appendData=SMatrix3x3_appendData;this.rotationX=SMatrix3x3_rotationX;this.rotationY=SMatrix3x3_rotationY;this.rotationZ=SMatrix3x3_rotationZ;this.rotation=SMatrix3x3_rotation;this.invert=SMatrix3x3_invert;this.transform=SMatrix3x3_transform;this.transformPoint3=SMatrix3x3_transformPoint3;this.build=SMatrix3x3_build;this.writeData=SMatrix3x3_writeData;
this.toString=SMatrix3x3_toString;return this}function SMatrix3x3_data(){return this._data}function SMatrix3x3_equalsData(b){for(var f=this._data,h=0;9>h;h++)if(f[h]!=b[h])return!1;return!0}function SMatrix3x3_assignData(b){for(var f=this._data,h=0;9>h;h++)f[h]=b[h]}
function SMatrix3x3_appendData(b){var f=this._data,h=f[0]*b[1]+f[1]*b[4]+f[2]*b[7],q=f[0]*b[2]+f[1]*b[5]+f[2]*b[8],u=f[3]*b[0]+f[4]*b[3]+f[5]*b[6],z=f[3]*b[1]+f[4]*b[4]+f[5]*b[7],A=f[3]*b[2]+f[4]*b[5]+f[5]*b[8],B=f[6]*b[0]+f[7]*b[3]+f[8]*b[6],C=f[6]*b[1]+f[7]*b[4]+f[8]*b[7],D=f[6]*b[2]+f[7]*b[5]+f[8]*b[8];f[0]=f[0]*b[0]+f[1]*b[3]+f[2]*b[6];f[1]=h;f[2]=q;f[3]=u;f[4]=z;f[5]=A;f[6]=B;f[7]=C;f[8]=D}
function SMatrix3x3_rotationX(b){var f=Math.sin(b);b=Math.cos(b);var h=RMath.float9;h[0]=1;h[1]=0;h[2]=0;h[3]=0;h[4]=b;h[5]=f;h[6]=0;h[7]=-f;h[8]=b;this.appendData(h)}function SMatrix3x3_rotationY(b){var f=Math.sin(b);b=Math.cos(b);var h=RMath.float9;h[0]=b;h[1]=0;h[2]=f;h[3]=0;h[4]=1;h[5]=0;h[6]=-f;h[7]=0;h[8]=b;this.appendData(h)}
function SMatrix3x3_rotationZ(b){var f=Math.sin(b);b=Math.cos(b);var h=RMath.float9;h[0]=b;h[1]=f;h[2]=0;h[3]=-f;h[4]=b;h[5]=1;h[6]=0;h[7]=0;h[8]=1;this.appendData(h)}function SMatrix3x3_rotation(b,f,h){var q=Math.sin(b);b=Math.cos(b);var u=Math.sin(f);f=Math.cos(f);var z=Math.sin(h);h=Math.cos(h);var A=RMath.float9;A[0]=f*h;A[1]=f*z;A[2]=-u;A[3]=q*u*h-b*z;A[4]=q*u*z+b*h;A[5]=q*f;A[6]=b*u*h+q*z;A[7]=b*u*z-q*b;A[8]=b*f;this.appendData(A)}
function SMatrix3x3_invert(){var b=this._data,f=RValue.float9;f[0]=b[4]*b[8]-b[5]*b[7];f[1]=b[2]*b[7]-b[1]*b[8];f[2]=b[1]*b[5]-b[2]*b[4];f[3]=b[5]*b[6]-b[3]*b[8];f[4]=b[0]*b[8]-b[2]*b[6];f[5]=b[2]*b[3]-b[0]*b[5];f[6]=b[3]*b[7]-b[4]*b[6];f[7]=b[1]*b[6]-b[0]*b[7];f[8]=b[0]*b[4]-b[1]*b[3];var h=b[0]*f[0]+b[1]*f[3]+b[2]*f[6];if(0==h)return!1;for(var h=1/h,q=0;9>q;q++)b[q]=f[q]*h;return!0}
function SMatrix3x3_transform(b,f,h){for(var q=this._data,u=0;u<h;u++){var z=(u<<1)+u;b[z]=f[z]*q[0]+f[z+1]*q[3]+f[z+2]*q[6];b[z+1]=f[z]*q[1]+f[z+1]*q[4]+f[z+2]*q[7];b[z+2]=f[z]*q[2]+f[z+1]*q[5]+f[z+2]*q[8]}}function SMatrix3x3_transformPoint3(b,f){var h=this._data,q=b.x*h[0]+b.y*h[3]+b.z*h[6],u=b.x*h[1]+b.y*h[4]+b.z*h[7],h=b.x*h[2]+b.y*h[5]+b.z*h[8],z=null,z=f?f:new SPoint3;z.set(q,u,h);return z}
function SMatrix3x3_build(b){var f=this._data,h=b.x*b.x,q=b.y*b.y,u=b.z*b.z,z=b.x*b.y,A=b.x*b.z,B=b.y*b.z,C=b.w*b.x,D=b.w*b.y;b=b.w*b.z;f[0]=1-2*(q+u);f[1]=2*(z-b);f[2]=2*(A+D);f[3]=2*(z+b);f[4]=1-2*(h+u);f[5]=2*(B-C);f[6]=2*(A-D);f[7]=2*(B+C);f[8]=1-2*(h+q)}function SMatrix3x3_writeData(b,f){var h=this._data;b[f++]=h[0];b[f++]=h[3];b[f++]=h[6];b[f++]=h[1];b[f++]=h[4];b[f++]=h[7];b[f++]=h[2];b[f++]=h[5];b[f++]=h[8]}
function SMatrix3x3_toString(){for(var b=this._data,f=new TString,h=0;3>h;h++){0<h&&f.append("|");for(var q=0;3>q;q++){var u=b[3*h+q];0<q&&f.append(",");f.append(RFloat.format(u,0,null,3,null))}}return f.flush()}
function SMatrix4x4(){this._data=Array(16);this.data=SMatrix4x4_data;this.isIdentityData=SMatrix4x4_isIdentityData;this.identityData=SMatrix4x4_identityData;this.equalsData=SMatrix4x4_equalsData;this.assignData=SMatrix4x4_assignData;this.attachData=SMatrix4x4_attachData;this.appendData=SMatrix4x4_appendData;this.translate=SMatrix4x4_translate;this.rotationX=SMatrix4x4_rotationX;this.rotationY=SMatrix4x4_rotationY;this.rotationZ=SMatrix4x4_rotationZ;this.rotation=SMatrix4x4_rotation;this.scale=SMatrix4x4_scale;
this.invert=SMatrix4x4_invert;this.transform=SMatrix4x4_transform;this.transformPoint3=SMatrix4x4_transformPoint3;this.buildQuaternion=SMatrix4x4_buildQuaternion;this.build=SMatrix4x4_build;this.writeData=SMatrix4x4_writeData;this.toString=SMatrix4x4_toString;return this}function SMatrix4x4_data(){return this._data}function SMatrix4x4_isIdentityData(){for(var b=this._data,f=RMath.identity4x4,h=0;16>h;h++)if(b[h]!=f[h])return!1;return!0}
function SMatrix4x4_identityData(){for(var b=this._data,f=RMath.identity4x4,h=0;16>h;h++)b[h]=f[h];return this}function SMatrix4x4_equalsData(b){for(var f=this._data,h=0;16>h;h++)if(f[h]!=b[h])return!1;return!0}function SMatrix4x4_assignData(b){for(var f=this._data,h=0;16>h;h++)f[h]=b[h]}function SMatrix4x4_attachData(b){for(var f=!1,h=this._data,q=0;16>q;q++){var u=b[q];f||h[q]!=u&&(f=!0);h[q]=u}return f}
function SMatrix4x4_appendData(b){var f=this._data,h=f[0]*b[1]+f[1]*b[5]+f[2]*b[9]+f[3]*b[13],q=f[0]*b[2]+f[1]*b[6]+f[2]*b[10]+f[3]*b[14],u=f[0]*b[3]+f[1]*b[7]+f[2]*b[11]+f[3]*b[15],z=f[4]*b[0]+f[5]*b[4]+f[6]*b[8]+f[7]*b[12],A=f[4]*b[1]+f[5]*b[5]+f[6]*b[9]+f[7]*b[13],B=f[4]*b[2]+f[5]*b[6]+f[6]*b[10]+f[7]*b[14],C=f[4]*b[3]+f[5]*b[7]+f[6]*b[11]+f[7]*b[15],D=f[8]*b[0]+f[9]*b[4]+f[10]*b[8]+f[11]*b[12],E=f[8]*b[1]+f[9]*b[5]+f[10]*b[9]+f[11]*b[13],F=f[8]*b[2]+f[9]*b[6]+f[10]*b[10]+f[11]*b[14],G=f[8]*b[3]+
f[9]*b[7]+f[10]*b[11]+f[11]*b[15],K=f[12]*b[0]+f[13]*b[4]+f[14]*b[8]+f[15]*b[12],H=f[12]*b[1]+f[13]*b[5]+f[14]*b[9]+f[15]*b[13],J=f[12]*b[2]+f[13]*b[6]+f[14]*b[10]+f[15]*b[14],I=f[12]*b[3]+f[13]*b[7]+f[14]*b[11]+f[15]*b[15];f[0]=f[0]*b[0]+f[1]*b[4]+f[2]*b[8]+f[3]*b[12];f[1]=h;f[2]=q;f[3]=u;f[4]=z;f[5]=A;f[6]=B;f[7]=C;f[8]=D;f[9]=E;f[10]=F;f[11]=G;f[12]=K;f[13]=H;f[14]=J;f[15]=I}
function SMatrix4x4_translate(b,f,h){var q=RArray.array16;q[0]=1;q[1]=0;q[2]=0;q[3]=0;q[4]=0;q[5]=1;q[6]=0;q[7]=0;q[8]=0;q[9]=0;q[10]=1;q[11]=0;q[12]=b;q[13]=f;q[14]=h;q[15]=1;this.appendData(q)}function SMatrix4x4_rotationX(b){var f=Math.sin(b);b=Math.cos(b);var h=RArray.array16;h[0]=1;h[1]=0;h[2]=0;h[3]=0;h[4]=0;h[5]=b;h[6]=f;h[7]=0;h[8]=0;h[9]=-f;h[10]=b;h[11]=0;h[12]=0;h[13]=0;h[14]=0;h[15]=1;this.appendData(h)}
function SMatrix4x4_rotationY(b){var f=Math.sin(b);b=Math.cos(b);var h=RArray.array16;h[0]=b;h[1]=0;h[2]=f;h[3]=0;h[4]=0;h[5]=1;h[6]=0;h[7]=0;h[8]=-f;h[9]=0;h[10]=b;h[11]=0;h[12]=0;h[13]=0;h[14]=0;h[15]=1;this.appendData(h)}function SMatrix4x4_rotationZ(b){var f=Math.sin(b);b=Math.cos(b);var h=RArray.array16;h[0]=b;h[1]=f;h[2]=0;h[3]=0;h[4]=-f;h[5]=b;h[6]=1;h[7]=0;h[8]=0;h[9]=0;h[10]=1;h[11]=0;h[12]=0;h[13]=0;h[14]=0;h[15]=1;this.appendData(h)}
function SMatrix4x4_rotation(b,f,h){var q=Math.sin(b);b=Math.cos(b);var u=Math.sin(f);f=Math.cos(f);var z=Math.sin(h);h=Math.cos(h);var A=RArray.array16;A[0]=f*h;A[1]=f*z;A[2]=-u;A[3]=0;A[4]=q*u*h-b*z;A[5]=q*u*z+b*h;A[6]=q*f;A[7]=0;A[8]=b*u*h+q*z;A[9]=b*u*z-q*b;A[10]=b*f;A[11]=0;A[12]=0;A[13]=0;A[14]=0;A[15]=1;this.appendData(A)}
function SMatrix4x4_scale(b,f,h){var q=RArray.array16;q[0]=b;q[1]=0;q[2]=0;q[3]=0;q[4]=0;q[5]=f;q[6]=0;q[7]=0;q[8]=0;q[9]=0;q[10]=h;q[11]=0;q[12]=0;q[13]=0;q[14]=0;q[15]=1;this.appendData(q)}
function SMatrix4x4_invert(){var b=this._data,f=RArray.array16;f[0]=b[5]*b[10]*b[15]-b[5]*b[11]*b[14]-b[9]*b[6]*b[15]+b[9]*b[7]*b[14]+b[13]*b[6]*b[11]-b[13]*b[7]*b[10];f[4]=-(b[4]*b[10]*b[15])+b[4]*b[11]*b[14]+b[8]*b[6]*b[15]-b[8]*b[7]*b[14]-b[12]*b[6]*b[11]+b[12]*b[7]*b[10];f[8]=b[4]*b[9]*b[15]-b[4]*b[11]*b[13]-b[8]*b[5]*b[15]+b[8]*b[7]*b[13]+b[12]*b[5]*b[11]-b[12]*b[7]*b[9];f[12]=-(b[4]*b[9]*b[14])+b[4]*b[10]*b[13]+b[8]*b[5]*b[14]-b[8]*b[6]*b[13]-b[12]*b[5]*b[10]+b[12]*b[6]*b[9];f[1]=-(b[1]*b[10]*
b[15])+b[1]*b[11]*b[14]+b[9]*b[2]*b[15]-b[9]*b[3]*b[14]-b[13]*b[2]*b[11]+b[13]*b[3]*b[10];f[5]=b[0]*b[10]*b[15]-b[0]*b[11]*b[14]-b[8]*b[2]*b[15]+b[8]*b[3]*b[14]+b[12]*b[2]*b[11]-b[12]*b[3]*b[10];f[9]=-(b[0]*b[9]*b[15])+b[0]*b[11]*b[13]+b[8]*b[1]*b[15]-b[8]*b[3]*b[13]-b[12]*b[1]*b[11]+b[12]*b[3]*b[9];f[13]=b[0]*b[9]*b[14]-b[0]*b[10]*b[13]-b[8]*b[1]*b[14]+b[8]*b[2]*b[13]+b[12]*b[1]*b[10]-b[12]*b[2]*b[9];f[2]=b[1]*b[6]*b[15]-b[1]*b[7]*b[14]-b[5]*b[2]*b[15]+b[5]*b[3]*b[14]+b[13]*b[2]*b[7]-b[13]*b[3]*
b[6];f[6]=-(b[0]*b[6]*b[15])+b[0]*b[7]*b[14]+b[4]*b[2]*b[15]-b[4]*b[3]*b[14]-b[12]*b[2]*b[7]+b[12]*b[3]*b[6];f[10]=b[0]*b[5]*b[15]-b[0]*b[7]*b[13]-b[4]*b[1]*b[15]+b[4]*b[3]*b[13]+b[12]*b[1]*b[7]-b[12]*b[3]*b[5];f[14]=-(b[0]*b[5]*b[14])+b[0]*b[6]*b[13]+b[4]*b[1]*b[14]-b[4]*b[2]*b[13]-b[12]*b[1]*b[6]+b[12]*b[2]*b[5];f[3]=-(b[1]*b[6]*b[11])+b[1]*b[7]*b[10]+b[5]*b[2]*b[11]-b[5]*b[3]*b[10]-b[9]*b[2]*b[7]+b[9]*b[3]*b[6];f[7]=b[0]*b[6]*b[11]-b[0]*b[7]*b[10]-b[4]*b[2]*b[11]+b[4]*b[3]*b[10]+b[8]*b[2]*b[7]-
b[8]*b[3]*b[6];f[11]=-(b[0]*b[5]*b[11])+b[0]*b[7]*b[9]+b[4]*b[1]*b[11]-b[4]*b[3]*b[9]-b[8]*b[1]*b[7]+b[8]*b[3]*b[5];f[15]=b[0]*b[5]*b[10]-b[0]*b[6]*b[9]-b[4]*b[1]*b[10]+b[4]*b[2]*b[9]+b[8]*b[1]*b[6]-b[8]*b[2]*b[5];var h=b[0]*f[0]+b[1]*f[4]+b[2]*f[8]+b[3]*f[12];if(0==h)return!1;for(var h=1/h,q=0;16>q;q++)b[q]=f[q]*h;return!0}
function SMatrix4x4_transform(b,f,h,q,u){for(var z=this._data,A=0;A<u;A++){var B=h[q++],C=h[q++],D=h[q++];b[f++]=B*z[0]+C*z[4]+D*z[8]+z[12];b[f++]=B*z[1]+C*z[5]+D*z[9]+z[13];b[f++]=B*z[2]+C*z[6]+D*z[10]+z[14]}}function SMatrix4x4_transformPoint3(b,f){var h=this._data,q=b.x*h[0]+b.y*h[4]+b.z*h[8]+h[12],u=b.x*h[1]+b.y*h[5]+b.z*h[9]+h[13],h=b.x*h[2]+b.y*h[6]+b.z*h[10]+h[14],z=null,z=f?f:new SPoint3;z.set(q,u,h);return z}
function SMatrix4x4_build(b,f,h){var q=this._data,u=f.x*f.x,z=f.y*f.y,A=f.z*f.z,B=f.x*f.y,C=f.x*f.z,D=f.y*f.z,E=f.w*f.x,F=f.w*f.y;f=f.w*f.z;q[0]=(1-2*(z+A))*h.x;q[1]=2*(B-f)*h.x;q[2]=2*(C+F)*h.x;q[3]=0;q[4]=2*(B+f)*h.y;q[5]=(1-2*(u+A))*h.y;q[6]=2*(D-E)*h.y;q[7]=0;q[8]=2*(C-F)*h.z;q[9]=2*(D+E)*h.z;q[10]=(1-2*(u+z))*h.z;q[11]=0;q[12]=b.x;q[13]=b.y;q[14]=b.z;q[15]=1}
function SMatrix4x4_buildQuaternion(b){var f=this._data,h=b.x*b.x,q=b.y*b.y,u=b.z*b.z,z=b.x*b.y,A=b.x*b.z,B=b.y*b.z,C=b.w*b.x,D=b.w*b.y;b=b.w*b.z;f[0]=1-2*(q+u);f[1]=2*(z-b);f[2]=2*(A+D);f[3]=0;f[4]=2*(z+b);f[5]=1-2*(h+u);f[6]=2*(B-C);f[7]=0;f[8]=2*(A-D);f[9]=2*(B+C);f[10]=1-2*(h+q);f[11]=0;f[12]=0;f[13]=0;f[14]=0;f[15]=1}
function SMatrix4x4_writeData(b,f){var h=this._data;b[f++]=h[0];b[f++]=h[4];b[f++]=h[8];b[f++]=h[12];b[f++]=h[1];b[f++]=h[5];b[f++]=h[9];b[f++]=h[13];b[f++]=h[2];b[f++]=h[6];b[f++]=h[10];b[f++]=h[14];b[f++]=h[3];b[f++]=h[7];b[f++]=h[11];b[f++]=h[15]}function SMatrix4x4_toString(){for(var b=this._data,f=new TString,h=0;4>h;h++){0<h&&f.append("|");for(var q=0;4>q;q++){var u=b[4*h+q];0<q&&f.append(",");f.append(RFloat.format(u,0,null,3,null))}}return f.flush()}
function SOrthoMatrix3d(){SMatrix3d.call(this);this.perspectiveLH=SOrthoMatrix3d_perspectiveLH;this.perspectiveRH=SOrthoMatrix3d_perspectiveRH;this.perspectiveFieldOfViewLH=SOrthoMatrix3d_perspectiveFieldOfViewLH;this.perspectiveFieldOfViewRH=SOrthoMatrix3d_perspectiveFieldOfViewRH;return this}function SOrthoMatrix3d_perspectiveLH(b,f,h,q){var u=this._data;u[0]=2*h/b;u[1]=0;u[2]=0;u[3]=0;u[4]=0;u[5]=2*h/f;u[6]=0;u[7]=0;u[8]=0;u[9]=0;u[10]=q/(q-h);u[11]=1;u[12]=0;u[13]=0;u[14]=h*q/(h-q);u[15]=0}
function SOrthoMatrix3d_perspectiveRH(b,f,h,q){var u=this._data;u[0]=2*h/b;u[1]=0;u[2]=0;u[3]=0;u[4]=0;u[5]=2*h/f;u[6]=0;u[7]=0;u[8]=0;u[9]=0;u[10]=q/(h-q);u[11]=1;u[12]=0;u[13]=0;u[14]=h*q/(h-q);u[15]=0}function SOrthoMatrix3d_perspectiveFieldOfViewLH(b,f,h,q){var u=this._data;b=1/Math.tan(.5*b);u[0]=b/f;u[1]=0;u[2]=0;u[3]=0;u[4]=0;u[5]=b;u[6]=0;u[7]=0;u[8]=0;u[9]=0;u[10]=q/(q-h);u[11]=1;u[12]=0;u[13]=0;u[14]=h*q/(h-q);u[15]=0}
function SOrthoMatrix3d_perspectiveFieldOfViewRH(b,f,h,q){var u=this._data;b=1/Math.tan(.5*b);u[0]=b/f;u[1]=0;u[2]=0;u[3]=0;u[4]=0;u[5]=b;u[6]=0;u[7]=0;u[8]=0;u[9]=0;u[10]=q/(h-q);u[11]=1;u[12]=0;u[13]=0;u[14]=h*q/(q-h);u[15]=0}function SOutline3(){this.min=new SPoint3;this.max=new SPoint3;this.assign=SOutline3_assign;this.serialize=SOutline3_serialize;this.unserialize=SOutline3_unserialize;this.toString=SOutline3_toString;return this}
function SOutline3_assign(b){this.min.assign(b.min);this.max.assign(b.max)}function SOutline3_serialize(b){this.min.serialize(b);this.max.serialize(b)}function SOutline3_unserialize(b){this.min.unserialize(b);this.max.unserialize(b)}function SOutline3_toString(){return"("+this.min+")-("+this.max+")"}
function SPadding(b,f,h,q){this.left=RInteger.nvl(b);this.top=RInteger.nvl(f);this.right=RInteger.nvl(h);this.bottom=RInteger.nvl(q);this.isEmpty=SPadding_isEmpty;this.reset=SPadding_reset;this.assign=SPadding_assign;this.set=SPadding_set;this.parse=SPadding_parse;this.toString=SPadding_toString;this.dispose=SPadding_dispose;this.dump=SPadding_dump;return this}function SPadding_isEmpty(){return 0==this.left&&0==this.top&&0==this.right&&0==this.bottom}
function SPadding_reset(){this.bottom=this.right=this.top=this.left=0}function SPadding_assign(b){this.left=b.left;this.top=b.top;this.right=b.right;this.bottom=b.bottom}function SPadding_set(b,f,h,q){this.left=b;this.top=f;this.right=h;this.bottom=q}function SPadding_parse(b){var f=b.split(",");if(4==f.length)this.left=parseInt(f[0]),this.top=parseInt(f[1]),this.right=parseInt(f[2]),this.bottom=parseInt(f[3]);else throw new TError(this,"Parse value failure. (value={1})",b);}
function SPadding_toString(){return this.left+","+this.top+","+this.right+","+this.bottom}function SPadding_dispose(){this.bottom=this.right=this.top=this.left=null}function SPadding_dump(b){return RClass.dump(this)+" ["+this.left+","+this.top+","+this.right+","+this.bottom+"]"}
function SPerspectiveMatrix3d(){SMatrix3d.call(this);this.perspectiveLH=SPerspectiveMatrix3d_perspectiveLH;this.perspectiveRH=SPerspectiveMatrix3d_perspectiveRH;this.perspectiveFieldOfViewLH=SPerspectiveMatrix3d_perspectiveFieldOfViewLH;this.perspectiveFieldOfViewRH=SPerspectiveMatrix3d_perspectiveFieldOfViewRH;return this}
function SPerspectiveMatrix3d_perspectiveLH(b,f,h,q){var u=this._data;u[0]=2*h/b;u[1]=0;u[2]=0;u[3]=0;u[4]=0;u[5]=2*h/f;u[6]=0;u[7]=0;u[8]=0;u[9]=0;u[10]=q/(q-h);u[11]=1;u[12]=0;u[13]=0;u[14]=h*q/(h-q);u[15]=0}function SPerspectiveMatrix3d_perspectiveRH(b,f,h,q){var u=this._data;u[0]=2*h/b;u[1]=0;u[2]=0;u[3]=0;u[4]=0;u[5]=2*h/f;u[6]=0;u[7]=0;u[8]=0;u[9]=0;u[10]=q/(h-q);u[11]=1;u[12]=0;u[13]=0;u[14]=h*q/(h-q);u[15]=0}
function SPerspectiveMatrix3d_perspectiveFieldOfViewLH(b,f,h,q){var u=this._data;b=1/Math.tan(.5*b);u[0]=b/f;u[1]=0;u[2]=0;u[3]=0;u[4]=0;u[5]=b;u[6]=0;u[7]=0;u[8]=0;u[9]=0;u[10]=q/(q-h);u[11]=1;u[12]=0;u[13]=0;u[14]=h*q/(h-q);u[15]=0}function SPerspectiveMatrix3d_perspectiveFieldOfViewRH(b,f,h,q){var u=this._data;b=1/Math.tan(.5*b);u[0]=b/f;u[1]=0;u[2]=0;u[3]=0;u[4]=0;u[5]=b;u[6]=0;u[7]=0;u[8]=0;u[9]=0;u[10]=q/(h-q);u[11]=1;u[12]=0;u[13]=0;u[14]=h*q/(q-h);u[15]=0}
function SPlane(b){b||(b=this);b.a=0;b.b=0;b.c=0;b.d=0;b.assign=SPlane_assign;b.set=SPlane_set;b.normalize=SPlane_normalize;b.dot=SPlane_dot;b.toString=SPlane_toString;b.dump=SPlane_dump;return b}function SPlane_assign(b){this.a=b.a;this.b=b.b;this.c=b.c;this.d=b.d}function SPlane_set(b,f,h,q){this.a=b;this.b=f;this.c=h;this.d=q}function SPlane_normalize(){var b=1/Math.sqrt(this.a*this.a+this.b*this.b+this.c*this.c);this.a*=b;this.b*=b;this.c*=b;this.d*=b}
function SPlane_dot(b,f,h){return b*this.a+f*this.b+h*this.c+d}function SPlane_toString(){return this.a+","+this.b+","+this.c+","+this.d}function SPlane_dump(){return RClass.dump(this)+" ["+this.toString()+"]"}
function SPoint2(b,f){this.x=RInteger.nvl(b);this.y=RInteger.nvl(f);this.isEmpty=SPoint2_isEmpty;this.equals=SPoint2_equals;this.assign=SPoint2_assign;this.set=SPoint2_set;this.serialize=SPoint2_serialize;this.unserialize=SPoint2_unserialize;this.toString=SPoint2_toString;this.dispose=SPoint2_dispose;this.dump=SPoint2_dump;return this}function SPoint2_isEmpty(){return 0==this.x&&0==this.y}function SPoint2_equals(b){return b?this.x==b.x&&this.y==b.y:!1}
function SPoint2_assign(b){this.x=b.x;this.y=b.y}function SPoint2_set(b,f){this.x=b;this.y=f}function SPoint2_serialize(b){b.writeFloat(this.x);b.writeFloat(this.y)}function SPoint2_unserialize(b){this.x=b.readFloat();this.y=b.readFloat()}function SPoint2_toString(){return this.x+","+this.y}function SPoint2_dispose(){this.y=this.x=null}function SPoint2_dump(){return RClass.dump(this)+" ["+this.x+","+this.y+"]"}
function SPoint3(b,f,h){SValue3.call(this,b,f,h);this.conjugate=SPoint3_conjugate;this.resize=SPoint3_resize;this.slerp=SPoint3_slerp;return this}function SPoint3_conjugate(b){var f=null,f=b?b:new SPoint3;f.x=-this.x;f.y=-this.y;f.z=-this.z;return f}function SPoint3_resize(b,f,h){null!=b&&(this.x+=b);null!=f&&(this.y+=f);null!=h&&(this.z+=h)}function SPoint3_slerp(b,f,h){this.x=(f.x-b.x)*h+b.x;this.y=(f.y-b.y)*h+b.y;this.z=(f.z-b.z)*h+b.z}
function SPoint4(b,f,h,q){SValue4.call(this,b,f,h,q);this.serialize3=SPoint4_serialize3;this.unserialize3=SPoint4_unserialize3;return this}function SPoint4_serialize3(b){b.writeFloat(this.x);b.writeFloat(this.y);b.writeFloat(this.z)}function SPoint4_unserialize3(b){this.x=b.readFloat();this.y=b.readFloat();this.z=b.readFloat()}
function SQuaternion(b){b||(b=this);b.x=0;b.y=0;b.z=0;b.w=1;b.identity=SQuaternion_identity;b.assign=SQuaternion_assign;b.set=SQuaternion_set;b.absolute=SQuaternion_absolute;b.normalize=SQuaternion_normalize;b.conjugate=SQuaternion_conjugate;b.mul=SQuaternion_mul;b.mul2=SQuaternion_mul2;b.translate=SQuaternion_translate;b.slerp=SQuaternion_slerp;b.fromAxisAngle=SQuaternion_fromAxisAngle;b.fromEuler=SQuaternion_fromEuler;b.parseEuler=SQuaternion_parseEuler;b.serialize=SQuaternion_serialize;b.unserialize=
SQuaternion_unserialize;b.clone=SQuaternion_clone;b.toString=SQuaternion_toString;return b}function SQuaternion_identity(){this.x=this.y=this.z=0;this.w=1;return this}function SQuaternion_assign(b){this.x=b.x;this.y=b.y;this.z=b.z;this.w=b.w}function SQuaternion_set(b,f,h,q){this.x=b;this.y=f;this.z=h;this.w=q}function SQuaternion_absolute(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}
function SQuaternion_normalize(){var b=this.absolute();0!=b&&(b=1/b,this.x*=b,this.y*=b,this.z*=b,this.w*=b)}function SQuaternion_conjugate(b){var f=null,f=b?b:new SQuaternion;f.x=-this.x;f.y=-this.y;f.z=-this.z;f.w=this.w;return f}function SQuaternion_mul(b){var f=this.x,h=this.y,q=this.z,u=this.w;this.x=u*b.x+f*b.w+h*b.z-q*b.y;this.y=u*b.y+h*b.w+q*b.x-f*b.z;this.z=u*b.z+q*b.w+f*b.y-h*b.x;this.w=u*b.w-f*b.x-h*b.y-q*b.z}
function SQuaternion_mul2(b,f){this.x=b.w*f.x+b.x*f.w+b.y*f.z-b.z*f.y;this.y=b.w*f.y+b.y*f.w+b.z*f.x-b.x*f.z;this.z=b.w*f.z+b.z*f.w+b.x*f.y-b.y*f.x;this.w=b.w*f.w-b.x*f.x-b.y*f.y-b.z*f.z}function SQuaternion_translate(b,f){var h=new SQuaternion;h.set(b.x,b.y,b.z,0);h.normalize();var q=this.conjugate();h.mul(q);q=this.clone();q.mul(h);h=null;h=f?f:new SVector3;h.set(q.x,q.y,q.z);return h}
function SQuaternion_slerp(b,f,h){var q=b.x*f.x+b.y*f.y+b.z*f.z+b.w*f.w,u=!1;0>q&&(u=!0,q=-q);var z=0,A=0;.999999<q?(z=1-h,A=u?-h:h):(q=Math.acos(q),A=1/Math.sin(q),z=Math.sin((1-h)*q)*A,A=u?-Math.sin(h*q)*A:Math.sin(h*q)*A);this.x=z*b.x+A*f.x;this.y=z*b.y+A*f.y;this.z=z*b.z+A*f.z;this.w=z*b.w+A*f.w}function SQuaternion_fromAxisAngle(b,f){var h=.5*f,q=Math.sin(h);this.x=b.x*q;this.y=b.y*q;this.z=b.z*q;this.w=Math.cos(h)}
function SQuaternion_fromEuler(b,f,h){var q=Math.sin(.5*h);h=Math.cos(.5*h);var u=Math.sin(.5*b);b=Math.cos(.5*b);var z=Math.sin(.5*f);f=Math.cos(.5*f);this.x=h*u*f+q*b*z;this.y=h*b*z-q*u*f;this.z=q*b*f-h*u*z;this.w=h*b*f+q*u*z}
function SQuaternion_parseEuler(b){var f=this.x*this.x,h=this.y*this.y,q=this.z*this.z,u=null,u=b?b:new SVector3;u.x=Math.asin(RFloat.toRange(2*(this.w*this.x-this.y*this.z),-1,1));u.y=Math.atan2(2*(this.w*this.y+this.z*this.x),1-2*(f+h));u.z=Math.atan2(2*(this.w*this.z+this.x*this.y),1-2*(q+f));return u}function SQuaternion_serialize(b){b.writeFloat(this.x);b.writeFloat(this.y);b.writeFloat(this.z);b.writeFloat(this.w)}
function SQuaternion_unserialize(b){this.x=b.readFloat();this.y=b.readFloat();this.z=b.readFloat();this.w=b.readFloat()}function SQuaternion_clone(){var b=new SQuaternion;b.x=this.x;b.y=this.y;b.z=this.z;b.w=this.w;return b}function SQuaternion_toString(){return this.x+","+this.y+","+this.z+","+this.w}function SRange(b,f,h,q){this.x=b;this.y=f;this.width=h;this.height=q;this.dump=SRange_dump;return this}function SRange_reset(){this.bottom=this.right=this.top=this.left=0}
function SRange_assign(b){this.left=b.left;this.top=b.top;this.right=b.right;this.bottom=b.bottom}function SRange_set(b,f,h,q){this.left=b;this.top=f;this.right=h;this.bottom=q}function SRange_setBounds(b,f,h,q){this.left=b;this.top=f;this.right=this.left+h-1;this.bottom=this.top+q-1}function SRange_width(){return this.right-this.left+1}function SRange_setWidth(b){b&&(this.right=this.left+b-1)}function SRange_height(){return this.bottom-this.top+1}
function SRange_setHeight(b){b&&(this.bottom=this.top+b-1)}function SRange_move(b,f){this.left+=b;this.top+=f;this.right+=b;this.bottom+=f}function SRange_inc(b){b=RInt.nvl(b,1);this.left-=b;this.top-=b;this.right+=b;this.bottom+=b}function SRange_dec(b){b=RInt.nvl(b,1);this.left+=b;this.top+=b;this.right-=b;this.bottom-=b}function SRange_dump(b){b=RString.nvlStr(b);b.append(RClass.name(this));b.append(" [",this.x,",",this.y,"-",this.width,",",this.height,"] ");return b}
function SRectangle(){this.position=new SPoint2;this.size=new SSize2;this.left=SRectangle_left;this.top=SRectangle_top;this.right=SRectangle_right;this.bottom=SRectangle_bottom;this.width=SRectangle_width;this.height=SRectangle_height;this.assign=SRectangle_assign;this.setPosition=SRectangle_setPosition;this.setSize=SRectangle_setSize;this.set=SRectangle_set;this.toString=SRectangle_toString;this.dispose=SRectangle_dispose;this.dump=SRectangle_dump;return this}
function SRectangle_left(){return this.position.x}function SRectangle_top(){return this.position.y}function SRectangle_right(){return this.position.x+this.size.width}function SRectangle_bottom(){return this.position.y+this.size.height}function SRectangle_width(){return this.size.width}function SRectangle_height(){return this.size.height}function SRectangle_assign(b){this.position.assign(b.position);this.size.assign(b.size)}function SRectangle_setPosition(b,f,h,q){this.position.set(b,f)}
function SRectangle_setSize(b,f){this.size.set(b,f)}function SRectangle_set(b,f,h,q){this.position.set(b,f);this.size.set(h,q)}function SRectangle_toString(){return this.position.x+","+this.position.y+","+this.size.width+","+this.size.height}function SRectangle_dispose(){this.position=this.position.dispose();this.size=this.size.dispose()}function SRectangle_dump(){return RClass.dump(this)+" ["+this.position.x+","+this.position.y+"-"+this.size.width+","+this.size.height+"]"}
function SSize2(b,f){this.width=RInteger.nvl(b);this.height=RInteger.nvl(f);this.isEmpty=SSize2_isEmpty;this.square=SSize2_square;this.assign=SSize2_assign;this.set=SSize2_set;this.parse=SSize2_parse;this.toString=SSize2_toString;this.dispose=SSize2_dispose;this.dump=SSize2_dump;return this}function SSize2_isEmpty(){return 0==this.width&&0==this.height}function SSize2_square(){return this.width*this.height}function SSize2_assign(b){this.width=b.width;this.height=b.height}
function SSize2_set(b,f){this.width=b;this.height=f}function SSize2_parse(b){var f=b.split(",");if(2==f.length)this.width=parseInt(f[0]),this.height=parseInt(f[1]);else throw new TError(this,"Parse value failure. (value={1})",b);}function SSize2_toString(){return this.width+","+this.height}function SSize2_dispose(){this.height=this.width=null}function SSize2_dump(){return RClass.dump(this)+" ["+this.width+","+this.height+"]"}
function SSize3(b,f,h){this.width=RInteger.nvl(b);this.height=RInteger.nvl(f);this.deep=RInteger.nvl(h);this.assign=SSize3_assign;this.set=SSize3_set;this.parse=SSize3_parse;this.toString=SSize3_toString;this.dump=SSize3_dump;return this}function SSize3_assign(b){this.width=b.width;this.height=b.height;this.deep=b.deep}function SSize3_set(b,f,h){this.width=b;this.height=f;this.deep=h}
function SSize3_parse(b){var f=b.split(",");if(3==f.length)this.width=parseInt(f[0]),this.height=parseInt(f[1]),this.deep=parseInt(f[2]);else throw new TError(this,"Parse value failure. (value={1})",b);}function SSize3_toString(){return this.width+","+this.height+","+this.deep}function SSize3_dump(){return RClass.dump(this)+" ["+this.width+","+this.height+","+this.deep+"]"}
function SSquare(b,f,h,q){this.left=RInteger.nvl(left);this.top=RInteger.nvl(top);this.right=RInteger.nvl(right);this.bottom=RInteger.nvl(bottom);this.reset=SSquare_reset;this.assign=SSquare_assign;this.set=SSquare_set;this.setBounds=SSquare_setBounds;this.width=SSquare_width;this.setWidth=SSquare_setWidth;this.height=SSquare_height;this.setHeight=SSquare_setHeight;this.move=SSquare_move;this.inc=SSquare_inc;this.dec=SSquare_dec;this.dump=this.unpack=this.pack=SSquare_dump;return this}
function SSquare_reset(){this.bottom=this.right=this.top=this.left=0}function SSquare_assign(b){this.left=b.left;this.top=b.top;this.right=b.right;this.bottom=b.bottom}function SSquare_set(b,f,h,q){this.left=b;this.top=f;this.right=h;this.bottom=q}function SSquare_setBounds(b,f,h,q){this.left=b;this.top=f;this.right=this.left+h-1;this.bottom=this.top+q-1}function SSquare_width(){return this.right-this.left+1}function SSquare_setWidth(b){b&&(this.right=this.left+b-1)}
function SSquare_height(){return this.bottom-this.top+1}function SSquare_setHeight(b){b&&(this.bottom=this.top+b-1)}function SSquare_move(b,f){this.left+=b;this.top+=f;this.right+=b;this.bottom+=f}function SSquare_inc(b){b=RInt.nvl(b,1);this.left-=b;this.top-=b;this.right+=b;this.bottom+=b}function SSquare_dec(b){b=RInt.nvl(b,1);this.left+=b;this.top+=b;this.right-=b;this.bottom-=b}
function SSquare_dump(b){b=RString.nvlStr(b);b.append(RClass.name(this));b.append(" [",this.left,",",this.top,"-",this.right,",",this.bottom,"] ");b.append("(",this.width(),"-",this.height(),")");return b}
function SValue3(b,f,h){this.x=RRuntime.nvl(b,0);this.y=RRuntime.nvl(f,0);this.z=RRuntime.nvl(h,0);this.assign=SValue3_assign;this.set=SValue3_set;this.absolute=SValue3_absolute;this.normalize=SValue3_normalize;this.negative=SValue3_negative;this.serialize=SValue3_serialize;this.unserialize=SValue3_unserialize;this.parse=SValue3_parse;this.toString=SValue3_toString;return this}function SValue3_assign(b){this.x=b.x;this.y=b.y;this.z=b.z}function SValue3_set(b,f,h){this.x=b;this.y=f;this.z=h}
function SValue3_normalize(){var b=this.absolute();0!=b&&(this.x/=b,this.y/=b,this.z/=b)}function SValue3_absolute(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}function SValue3_negative(b){var f=null,f=b?b:new this.constructor;f.x=-this.x;f.y=-this.y;f.z=-this.z;return f}function SValue3_serialize(b){b.writeFloat(this.x);b.writeFloat(this.y);b.writeFloat(this.z)}function SValue3_unserialize(b){this.x=b.readFloat();this.y=b.readFloat();this.z=b.readFloat()}
function SValue3_parse(b){var f=b.split(",");if(3==f.length)this.x=parseFloat(f[0]),this.y=parseFloat(f[1]),this.z=parseFloat(f[2]);else throw new TError(this,"Parse value failure. (value={1})",b);}function SValue3_toString(){return this.x+","+this.y+","+this.z}
function SValue4(b,f,h,q){this.x=RRuntime.nvl(b,0);this.y=RRuntime.nvl(f,0);this.z=RRuntime.nvl(h,0);this.w=RRuntime.nvl(q,1);this.assign=SValue4_assign;this.set=SValue4_set;this.absolute=SValue4_absolute;this.normalize=SValue4_normalize;this.negative=SValue4_negative;this.serialize=SValue4_serialize;this.unserialize=SValue4_unserialize;this.parse=SValue4_parse;this.toString=SValue4_toString;return this}function SValue4_assign(b){this.x=b.x;this.y=b.y;this.z=b.z;this.w=b.w}
function SValue4_set(b,f,h,q){this.x=b;this.y=f;this.z=h;this.w=q}function SValue4_absolute(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}function SValue4_normalize(){var b=this.absolute();0!=b&&(this.x/=b,this.y/=b,this.z/=b,this.w/=w)}function SValue4_negative(b){var f=null,f=b?b:new this.constructor;f.x=-this.x;f.y=-this.y;f.z=-this.z;f.w=-this.w;return f}
function SValue4_serialize(b){b.writeFloat(this.x);b.writeFloat(this.y);b.writeFloat(this.z);b.writeFloat(this.w)}function SValue4_unserialize(b){this.x=b.readFloat();this.y=b.readFloat();this.z=b.readFloat();this.w=b.readFloat()}function SValue4_parse(b){var f=b.split(",");if(4==f.length)this.x=parseFloat(f[0]),this.y=parseFloat(f[1]),this.z=parseFloat(f[2]),this.w=parseFloat(f[3]);else throw new TError(this,"Parse value failure. (value={1})",b);}
function SValue4_toString(){return this.x+","+this.y+","+this.z+","+this.w}function SVector3(b,f,h){SValue3.call(this,b,f,h);this.conjugate=SVector3_conjugate;this.dotPoint3=SVector3_dotPoint3;this.cross=SVector3_cross;this.cross2=SVector3_cross2;this.slerp=SVector3_slerp;this.clone=SVector3_clone;return this}function SVector3_conjugate(b){var f=null,f=b?b:new SVector3;f.x=-this.x;f.y=-this.y;f.z=-this.z;return f}function SVector3_dotPoint3(b){return this.x*b.x+this.y*b.y+this.z*b.z}
function SVector3_cross(b){var f=this.z*b.x-this.x*b.z,h=this.x*b.y-this.y*b.x;this.x=this.y*b.z-this.z*b.y;this.y=f;this.z=h}function SVector3_cross2(b,f){b.x=this.y*f.z-this.z*f.y;b.y=this.z*f.x-this.x*f.z;b.z=this.x*f.y-this.y*f.x}function SVector3_slerp(b,f,h){this.x=(f.x-b.x)*h+b.x;this.y=(f.y-b.y)*h+b.y;this.z=(f.z-b.z)*h+b.z}function SVector3_clone(){var b=new SVector3;b.x=this.x;b.y=this.y;b.z=this.z;return b}
function SVector4(b,f,h,q){SValue4.call(this,b,f,h,q);this.serialize3=SVector4_serialize3;this.unserialize3=SVector4_unserialize3;return this}function SVector4_serialize3(b){b.writeFloat(this.x);b.writeFloat(this.y);b.writeFloat(this.z)}function SVector4_unserialize3(b){this.x=b.readFloat();this.y=b.readFloat();this.z=b.readFloat()}
var RMath=new function(){this.PI=Math.PI;this.PI2=2*Math.PI;this.RADIAN_RATE=180/Math.PI;this.DEGREE_RATE=Math.PI/180;this.PERCENT_10=.1;this.PERCENT_100=.01;this.PERCENT_1000=.001;this.identity4x4=this.vectorBackward=this.vectorForward=this.vectorScale=this.vectorAxisZ=this.vectorAxisY=this.vectorAxisX=null;this.construct=RMath_construct;this.construct();return this};
function RMath_construct(){this.vectorAxisX=new SVector3(1,0,0);this.vectorAxisY=new SVector3(0,1,0);this.vectorAxisZ=new SVector3(0,0,1);this.vectorScale=new SVector3(1,1,1);this.vectorForward=new SVector3(0,0,1);this.vectorBackward=new SVector3(0,0,-1);this.identity4x4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}
function AEvent(b,f,h){AAnnotation.call(this,b);this._annotationCd=EAnnotation.Event;this._logger=this._inherit=!0;this._linker=f;this._handle=h;this._process=null;this.linker=AEvent_linker;this.handle=AEvent_handle;this.value=AEvent_value;this.create=AEvent_create;this.attach=RMethod.empty;this.bind=AEvent_bind;this.toString=AEvent_toString;return this}function AEvent_linker(){return this._linker}function AEvent_handle(){return this._handle}function AEvent_value(){return this._process}
function AEvent_create(){return new SEvent}function AEvent_bind(b,f){f?b.addEventListener(this._linker,REvent.ohEvent,!0):b[this._handle]=REvent.ohEvent}function AEvent_toString(){return"linker="+this._linker+",handle="+this._handle}function AEventBlur(b,f){AEvent.call(this,b,"blur","onblur");this.attach=AEventBlur_attach;return this}function AEventBlur_attach(b,f){}function AEventChange(b){AEvent.call(this,b,"change","onchange");this.attach=AEventChange_attach;return this}
function AEventChange_attach(b,f){}function AEventClick(b){AEvent.call(this,b,"click","onclick");this.attach=AEventClick_attach;return this}function AEventClick_attach(b,f){b.altKey=f.altKey;b.ctrlKey=f.ctrlKey;b.shiftKey=f.shiftKey}function AEventDoubleClick(b){AEvent.call(this,b,"dblclick","ondblclick");this.attach=AEventDoubleClick_attach;return this}function AEventDoubleClick_attach(b,f){b.altKey=f.altKey;b.ctrlKey=f.ctrlKey;b.shiftKey=f.shiftKey}
function AEventFocus(b){AEvent.call(this,b,"focus","onfocus");this.attach=AEventFocus_attach;return this}function AEventFocus_attach(b,f){}function AEventInputChanged(b){AEvent.call(this,b,"input","oninput");this.attach=AEventInputChanged_attach;this.bind=AEventInputChanged_bind;return this}function AEventInputChanged_attach(b,f){}function AEventInputChanged_bind(b,f){RBrowser.isBrowser(EBrowser.Explorer)?b.onpropertychange=REvent.ohEvent:b.addEventListener("input",REvent.ohEvent)}
function AEventKeyDown(b){AEvent.call(this,b,"keydown","onkeydown");this.attach=AEventKeyDown_attach;return this}function AEventKeyDown_attach(b,f){b.altKey=f.altKey;b.shiftKey=f.shiftKey;b.ctrlKey=f.ctrlKey;b.keyCode=f.keyCode}function AEventKeyPress(b){AEvent.call(this,b,"keypress","onkeypress");this.create=AEventKeyPress_create;this.attach=AEventKeyPress_attach;return this}function AEventKeyPress_create(){return new SKeyboardEvent}
function AEventKeyPress_attach(b,f){b.hEvent=f;b.attachEvent(f)}function AEventKeyUp(b){AEvent.call(this,b,"keyup","onkeyup");this.attach=AEventKeyUp_attach;return this}function AEventKeyUp_attach(b,f){b.altKey=f.altKey;b.shiftKey=f.shiftKey;b.ctrlKey=f.ctrlKey;b.keyCode=f.keyCode}function AEventLoad(b){AEvent.call(this,b,"load","onload");this.attach=AEventLoad_attach;return this}function AEventLoad_attach(b,f){}
function AEventMouse(b,f,h){AEvent.call(this,b,f,h);this.attach=AEventMouse_attach;return this}
function AEventMouse_attach(b,f){b.button=f.button;b.mouseLeft=f.button==EMouseButton.Left;b.mouseMiddle=f.button==EMouseButton.Middle;b.mouseRight=f.button==EMouseButton.Right;b.altKey=f.altKey;b.ctrlKey=f.ctrlKey;RBrowser.isBrowser(EBrowser.FireFox)?(b.x=f.pageX,b.y=f.pageY,b.offsetX=f.layerX,b.offsetY=f.layerY):(b.x=f.x,b.y=f.y,b.offsetX=f.offsetX,b.offsetY=f.offsetY);b.clientX=f.clientX;b.clientY=f.clientY}
function AEventMouseDown(b){AEventMouse.call(this,b,"mousedown","onmousedown");return this}function AEventMouseEnter(b){AEvent.call(this,b,"mouseenter","onmouseenter");this._logger=!1;this.attach=AEventMouseEnter_attach;return this}function AEventMouseEnter_attach(b,f){}function AEventMouseLeave(b){AEvent.call(this,b,"mouseleave","onmouseleave");this._logger=!1;this.attach=AEventMouseLeave_attach;return this}function AEventMouseLeave_attach(b,f){}
function AEventMouseMove(b){AEventMouse.call(this,b,"mousemove","onmousemove");this._logger=!1;return this}function AEventMouseOut(b){AEvent.call(this,b,"mouseout","onmouseout");this._y=this._x=this._ctrlKey=this._altKey=this._hSource=null;this.attach=AEventMouseOut_attach;return this}function AEventMouseOut_attach(b){this._hSource=b.srcElement;this._altKey=b.altKey;this._ctrlKey=b.ctrlKey;RBrowser.isBrowser(EBrowser.FireFox)?(this._x=b.pageX,this._y=b.pageY):(this._x=b.x,this._y=b.y)}
function AEventMouseOver(b){AEvent.call(this,b,"mouseover","onmouseover");this._y=this._x=this._ctrlKey=this._altKey=this._hSource=null;this.attach=AEventMouseOver_attach;return this}function AEventMouseOver_attach(b){this._hSource=b.srcElement;this._altKey=b.altKey;this._ctrlKey=b.ctrlKey;RBrowser.isBrowser(EBrowser.FireFox)?(this._x=b.pageX,this._y=b.pageY):(this._x=b.x,this._y=b.y)}function AEventMouseUp(b){AEventMouse.call(this,b,"mouseup","onmouseup");return this}
function AEventMouseWheel(b){AEvent.call(this,b,"mousewheel","onmousewheel");this.attach=AEventMouseWheel_attach;return this}function AEventMouseWheel_attach(b,f){b.altKey=f.altKey;b.ctrlKey=f.ctrlKey;b.delta=f.wheelDelta;RBrowser.isBrowser(EBrowser.FireFox)?(b.x=f.pageX,b.y=f.pageY):(b.x=f.x,b.y=f.y)}function AEventReadyStateChange(b){AEvent.call(this,b,"readystatechange","onreadystatechange");this.attach=AEventReadyStateChange_attach;return this}function AEventReadyStateChange_attach(b,f){}
function AEventResize(b){AEvent.call(this,b,"resize","onresize");this.attach=AEventResize_attach;return this}function AEventResize_attach(b,f){b.x=f.x;b.y=f.y}function AEventScroll(b){AEvent.call(this,b,"scroll","onscroll");this.attach=AEventScroll_attach;return this}function AEventScroll_attach(b,f){}function AEventTouchEnd(b){AEvent.call(this,b,"touchstart","ontouchstart");this.attach=AEventTouchEnd_attach;return this}function AEventTouchEnd_attach(b,f){}
function AEventTouchMove(b){AEvent.call(this,b,"touchstart","ontouchstart");this.attach=AEventTouchMove_attach;return this}function AEventTouchMove_attach(b,f){}function AEventTouchStart(b){AEvent.call(this,b,"touchstart","ontouchstart");this.attach=AEventTouchStart_attach;return this}function AEventTouchStart_attach(b,f){}
function AStyle(b,f){AAnnotation.call(this,b);this._annotationCd=EAnnotation.Style;this._duplicate=!0;this._style=f;this.code=AStyle_code;this.style=AStyle_style;this.build=AStyle_build;this.toString=AStyle_toString;if(null==f){var h=null;RString.startsWith(b,"_style")?h=b.substring(6):RString.startsWith(b,"style")&&(h=b.substring(5));if(null==h)throw new TError("Style name is empty.");this._style=h}return this}function AStyle_code(){return this._style}function AStyle_style(){return this._style}
function AStyle_build(b){b[this._name]=null}function AStyle_toString(){return"style="+this._style}
function AStyleIcon(b,f){AAnnotation.call(this,b);this._annotationCd=EAnnotation.Style;this._style=f;this.code=AStyleIcon_code;this.style=AStyleIcon_style;this.build=AStyleIcon_build;this.toString=AStyleIcon_toString;if(null==f){var h=null;RString.startsWith(b,"_style")?h=b.substring(6):RString.startsWith(b,"style")&&(h=b.substring(5));if(null==h)throw new TError("Style name is empty.");this._style=h}return this}function AStyleIcon_code(){return this._style}
function AStyleIcon_style(){return this._style}function AStyleIcon_build(b){b[this._name]=null}function AStyleIcon_toString(){return"style="+this._style}
var EBrowser=new function(){this.Unknown=0;this.Explorer=1;this.FireFox=2;this.Chrome=3;this.Safari=4;return this},EDataType=new function(){this.Unknown=0;this.Boolean=1;this.Int8=2;this.Int16=3;this.Int32=4;this.Int64=5;this.Uint8=6;this.Uint16=7;this.Uint32=8;this.Uint64=9;this.Float=10;this.Double=11;this.String=12;return this},EDevice=new function(){this.Unknown=0;this.Pc=1;this.Mobile=2;return this},EEvent=new function(){this.Unknown=0;this.Load=1;this.Process=2;this.EnterFrame=3;this.LeaveFrame=
4;this.Enter=5;this.Leave=6;this.Focus=7;this.Blur=8;this.Click=9;this.DoubleClick=10;this.ItemClick=11;this.Selected=12;this.DataChanged=13;return this},EHttpContent=new function(){this.Binary=1;this.Text=2;return this},EHttpMethod=new function(){this.Get="GET";this.Post="POST";return this},EHttpStatus=new function(){this.Begin=0;this.Build=1;this.Send=2;this.Receive=3;this.Finish=4;return this},EKeyCode=new function(){this.None=0;this.Esc=27;this.Tab=9;this.Enter=13;this.Shift=16;this.Alt=18;this.Ctrl=
17;this.BackSpace=8;this.Space=32;this.Left=37;this.Up=38;this.Right=39;this.Down=40;this.Insert=45;this.Delete=46;this.Home=36;this.End=35;this.PageUp=33;this.PageDown=34;this.F1=112;this.F2=113;this.F3=114;this.F4=115;this.F5=116;this.F6=117;this.F7=118;this.F8=119;this.F9=120;this.F10=121;this.F11=122;this.F12=123;this.N0=48;this.N1=49;this.N2=50;this.N3=51;this.N4=52;this.N5=53;this.N6=54;this.N7=55;this.N8=56;this.N9=57;this.A=65;this.B=66;this.C=67;this.D=68;this.E=69;this.F=70;this.G=71;this.H=
72;this.I=73;this.J=74;this.K=75;this.L=76;this.M=77;this.N=78;this.O=79;this.P=80;this.Q=81;this.R=82;this.S=83;this.T=84;this.U=85;this.V=86;this.W=87;this.X=88;this.Y=89;this.Z=90;this.ControlKeys=[this.Tab,this.Enter,this.BackSpace,this.Left,this.Up,this.Right,this.Down,this.Insert,this.Delete,this.Home,this.End,this.PageUp,this.PageDown,this.F1,this.F2,this.F3,this.F4,this.F5,this.F6,this.F7,this.F8,this.F9,this.F10,this.F11,this.F12];var b=this.integerCodes={};b[45]=!0;b[190]=!0;for(var f=this.N0;f<=
this.N9;f++)b[f]=!0;b=this.floatCodes={};b[45]=!0;b[190]=!0;b[46]=!0;b[189]=!0;for(f=this.N0;f<=this.N9;f++)b[f]=!0;return this},EKeyStatus=new function(){this.Normal=0;this.Press=1;return this},EMouseButton=new function(){this.Left=0;this.Right=2;this.Middle=3;return this},EMouseCursor=new function(){this.HSize="E-resize";this.VSize="N-resize";return this},EOrientation=new function(){this.Unknown=0;this.Horizontal="H";this.Vertical="V";return this},ESoftware=new function(){this.Unknown=0;this.Window=
1;this.Linux=2;this.Android=3;this.Apple=4;return this};function MClone(b){b=RClass.inherits(this,b);b.clone=MClone_clone;return b}function MClone_clone(){var b=RClass.create(this.constructor),f;for(f in this)v=this[f],null!=v&&(RClass.isBaseDataType(v.constructor)||(b[f]=v.clone())),b[f]=v;return b}
function MDataStream(b){b=RClass.inherits(this,b);b._viewer=null;b._endianCd=!1;b._position=0;b.readBoolean=FByteStream_readBoolean;b.readInt8=FByteStream_readInt8;b.readInt16=FByteStream_readInt16;b.readInt32=FByteStream_readInt32;b.readInt64=FByteStream_readInt64;b.readUint8=FByteStream_readUint8;b.readUint16=FByteStream_readUint16;b.readUint32=FByteStream_readUint32;b.readUint64=FByteStream_readUint64;b.readFloat=FByteStream_readFloat;b.readDouble=FByteStream_readDouble;b.readString=FByteStream_readString;
b.readBytes=FByteStream_readBytes;b.writeBoolean=FByteStream_writeBoolean;b.writeInt8=FByteStream_writeInt8;b.writeInt16=FByteStream_writeInt16;b.writeInt32=FByteStream_writeInt32;b.writeInt64=FByteStream_writeInt64;b.writeUint8=FByteStream_writeUint8;b.writeUint16=FByteStream_writeUint16;b.writeUint32=FByteStream_writeUint32;b.writeUint64=FByteStream_writeUint64;b.writeFloat=FByteStream_writeFloat;b.writeDouble=FByteStream_writeDouble;b.writeString=FByteStream_writeString;return b}
function FByteStream_readBoolean(){var b=this._viewer.getInt8(this._position,this._endianCd);this._position++;return 0<b}function FByteStream_readInt8(){var b=this._viewer.getInt8(this._position,this._endianCd);this._position++;return b}function FByteStream_readInt16(){var b=this._viewer.getInt16(this._position,this._endianCd);this._position+=2;return b}function FByteStream_readInt32(){var b=this._viewer.getInt32(this._position,this._endianCd);this._position+=4;return b}
function FByteStream_readInt64(){var b=this._viewer.getInt64(this._position,this._endianCd);this._position+=8;return b}function FByteStream_readUint8(){var b=this._viewer.getUint8(this._position,this._endianCd);this._position+=1;return b}function FByteStream_readUint16(){var b=this._viewer.getUint16(this._position,this._endianCd);this._position+=2;return b}function FByteStream_readUint32(){var b=this._viewer.getUint32(this._position,this._endianCd);this._position+=4;return b}
function FByteStream_readUint64(){var b=this._viewer.getUint64(this._position,this._endianCd);this._position+=8;return b}function FByteStream_readFloat(){var b=this._viewer.getFloat32(this._position,this._endianCd);this._position+=4;return b}function FByteStream_readDouble(){var b=this._viewer.getFloat64(this._position,this._endianCd);this._position+=8;return b}
function FByteStream_readString(){var b=this._viewer.getUint16(this._position,this._endianCd);this._position+=2;for(var f=new TString,h=0;h<b;h++){var q=this._viewer.getUint16(this._position,this._endianCd);this._position+=2;f.push(String.fromCharCode(q))}return f.toString()}
function FByteStream_readBytes(b,f,h){if(!(0>=h)){if(0!=f)throw new TError("Unsupport.");if(0==h%8)for(b=new Float64Array(b),h>>=3,f=0;f<h;f++)b[f]=this._viewer.getFloat64(this._position,this._endianCd),this._position+=8;else if(0==h%4)for(h>>=2,b=new Uint32Array(b),f=0;f<h;f++)b[f]=this._viewer.getUint32(this._position,this._endianCd),this._position+=4;else if(0==h%2)for(h>>=1,b=new Uint16Array(b),f=0;f<h;f++)b[f]=this._viewer.getUint16(this._position,this._endianCd),this._position+=2;else for(b=
new Uint8Array(b),f=0;f<h;f++)b[f]=this._viewer.getUint8(this._position++,this._endianCd)}}function FByteStream_writeBoolean(b){b=this._viewer.setInt8(this._position,0<b?1:0,this._endianCd);this._position++;return b}function FByteStream_writeInt8(b){b=this._viewer.setInt8(this._position,b,this._endianCd);this._position++;return b}function FByteStream_writeInt16(b){b=this._viewer.setInt16(this._position,b,this._endianCd);this._position+=2;return b}
function FByteStream_writeInt32(b){b=this._viewer.setInt32(this._position,b,this._endianCd);this._position+=4;return b}function FByteStream_writeInt64(b){b=this._viewer.setInt64(this._position,b,this._endianCd);this._position+=8;return b}function FByteStream_writeUint8(b){b=this._viewer.setUint8(this._position,b,this._endianCd);this._position+=1;return b}function FByteStream_writeUint16(b){b=this._viewer.setUint16(this._position,b,this._endianCd);this._position+=2;return b}
function FByteStream_writeUint32(b){b=this._viewer.setUint32(this._position,b,this._endianCd);this._position+=4;return b}function FByteStream_writeUint64(b){b=this._viewer.setUint64(this._position,b,this._endianCd);this._position+=8;return b}function FByteStream_writeFloat(b){b=this._viewer.setFloat32(this._position,b,this._endianCd);this._position+=4;return b}function FByteStream_writeDouble(b){b=this._viewer.setDouble(this._position,b,this._endianCd);this._position+=8;return b}
function FByteStream_writeString(b){var f=b.length;this._viewer.setUint16(this._position,f,this._endianCd);this._position+=2;for(var h=0;h<f;h++)this._viewer.setUint16(this._position,b.charCodeAt(h),this._endianCd),this._position+=2}
function MDataView(b){b=RClass.inherits(this,b);b._viewer=null;b._endianCd=0;b.endianCd=MDataView_endianCd;b.setEndianCd=MDataView_setEndianCd;b.getInt8=MDataView_getInt8;b.getInt16=MDataView_getInt16;b.getInt32=MDataView_getInt32;b.getInt64=MDataView_getInt64;b.getUint8=MDataView_getUint8;b.getUint16=MDataView_getUint16;b.getUint32=MDataView_getUint32;b.getUint64=MDataView_getUint64;b.getFloat=MDataView_getFloat;b.getDouble=MDataView_getDouble;b.setInt8=MDataView_setInt8;b.setInt16=MDataView_setInt16;
b.setInt32=MDataView_setInt32;b.setInt64=MDataView_setInt64;b.setUint8=MDataView_setUint8;b.setUint16=MDataView_setUint16;b.setUint32=MDataView_setUint32;b.setUint64=MDataView_setUint64;b.setFloat=MDataView_setFloat;b.setDouble=MDataView_setDouble;return b}function MDataView_endianCd(b){return this._endianCd}function MDataView_setEndianCd(b){this._endianCd=b}function MDataView_getInt8(b){return this._viewer.getInt8(b,this._endianCd)}
function MDataView_getInt16(b){return this._viewer.getInt16(b,this._endianCd)}function MDataView_getInt32(b){return this._viewer.getInt32(b,this._endianCd)}function MDataView_getInt64(b){return this._viewer.getInt64(b,this._endianCd)}function MDataView_getUint8(b){return this._viewer.getUint8(b,this._endianCd)}function MDataView_getUint16(b){return this._viewer.getUint16(b,this._endianCd)}function MDataView_getUint32(b){return this._viewer.getUint32(b,this._endianCd)}
function MDataView_getUint64(b){return this._viewer.getUint64(b,this._endianCd)}function MDataView_getFloat(b){return this._viewer.getFloat32(b,this._endianCd)}function MDataView_getDouble(b){return this._viewer.getFloat64(b,this._endianCd)}function MDataView_setInt8(b,f){this._viewer.setInt8(b,f,this._endianCd)}function MDataView_setInt16(b,f){this._viewer.setInt16(b,f,this._endianCd)}function MDataView_setInt32(b,f){this._viewer.setInt32(b,f,this._endianCd)}
function MDataView_setInt64(b,f){this._viewer.setInt64(b,f,this._endianCd)}function MDataView_setUint8(b,f){this._viewer.setUint8(b,f,this._endianCd)}function MDataView_setUint16(b,f){this._viewer.setUint16(b,f,this._endianCd)}function MDataView_setUint32(b,f){this._viewer.setUint32(b,f,this._endianCd)}function MDataView_setUint64(b,f){this._viewer.setUint64(b,f,this._endianCd)}function MDataView_setFloat(b,f){this._viewer.setFloat32(b,f,this._endianCd)}
function MDataView_setDouble(b,f){this._viewer.setDouble(b,f,this._endianCd)}function MListener(b){b=RClass.inherits(this,b);b._listeners=null;b.addListener=MListener_addListener;b.removeListener=MListener_removeListener;b.processListener=MListener_processListener;b.dispose=MListener_dispose;return b}function MListener_addListener(b,f,h){var q=this._listeners;q||(q=this._listeners=new TDictionary);var u=q.get(b);u||(u=new TListeners,q.set(b,u));return u.register(f,h)}
function MListener_removeListener(b,f,h){return this._listeners.get(b).unregister(f,h)}function MListener_processListener(b,f,h,q,u,z){var A=this._listeners;A&&(b=A.get(b))&&b.process(f,h,q,u,z)}function MListener_dispose(){var b=this._listeners;if(b){for(var f=b.count()-1;0<=f;f--)b.valueAt(f).dispose();this._listeners=RObject.dispose(b)}}
function MListenerLoad(b){b=RClass.inherits(this,b,MListener);b.addLoadListener=MListenerLoad_addLoadListener;b.removeLoadListener=MListenerLoad_removeLoadListener;b.processLoadListener=MListenerLoad_processLoadListener;return b}function MListenerLoad_addLoadListener(b,f){return this.addListener(EEvent.Load,b,f)}function MListenerLoad_removeLoadListener(b,f){this.removeListener(EEvent.Load,b,f)}function MListenerLoad_processLoadListener(b,f,h,q,u){this.processListener(EEvent.Load,b,f,h,q,u)}
function MListenerProcess(b){b=RClass.inherits(this,b,MListener);b.addProcessListener=MListenerProcess_addProcessListener;b.removeProcessListener=MListenerProcess_removeProcessListener;b.processProcessListener=MListenerProcess_processProcessListener;return b}function MListenerProcess_addProcessListener(b,f){return this.addListener(EEvent.Process,b,f)}function MListenerProcess_removeProcessListener(b,f){this.removeListener(EEvent.Process,b,f)}
function MListenerProcess_processProcessListener(b,f,h,q,u){this.processListener(EEvent.Process,b,f,h,q,u)}function MMouseCapture(b){b=RClass.inherits(this,b);b.onMouseCaptureStart=RMethod.virtual(b,"onMouseCaptureStart");b.onMouseCapture=RMethod.virtual(b,"onMouseCapture");b.onMouseCaptureStop=RMethod.virtual(b,"onMouseCaptureStop");b.testMouseCapture=RMethod.emptyTrue;return b}
function MMouseWheel(b){b=RClass.inherits(this,b);b.onMouseWheel=RClass.register(b,new AEventMouseWheel("onMouseWheel"),RMethod.empty);return b}function MProperty(b){b=RClass.inherits(this,b);b.propertyAssign=MProperty_propertyAssign;b.propertyLoad=MProperty_propertyLoad;b.propertySave=MProperty_propertySave;return b}
function MProperty_propertyAssign(b){var f=RClass.find(this.constructor).annotations(EAnnotation.Property),h;for(h in f){var q=f[h];q.constructor!=Function&&(this[q._name]=b[q._name])}}function MProperty_propertyLoad(b){var f=RClass.find(this.constructor).annotations(EAnnotation.Property),h;for(h in f){var q=f[h];q.constructor!=Function&&(q._force?q.load(this,b):b.contains(q._linker)?q.load(this,b):null==this[q._name]&&(this[q._name]=q._value))}}
function MProperty_propertySave(b){var f=RClass.find(this.constructor).annotations(EAnnotation.Property),h;for(h in f){var q=f[h];q.constructor!=Function&&q.save(this,b)}}function SEvent(){this.process=this.onProcess=this.ohProcess=this.hSource=this.hSender=this.hEvent=this.source=this.annotation=null;this.dispose=SEvent_dispose;return this}function SEvent_dispose(){for(var b in this)this[b]=null}
function SKeyboardEvent(){SEvent.call(this);this.ctrlKey=this.shiftKey=this.altKey=!1;this.keyCode=0;this.attachEvent=SKeyboardEvent_attachEvent;this.cancel=SKeyboardEvent_cancel;return this}function SKeyboardEvent_attachEvent(b){this.altKey=b.altKey;this.shiftKey=b.shiftKey;this.ctrlKey=b.ctrlKey;this.keyCode=b.keyCode}function SKeyboardEvent_cancel(){this.hEvent.returnValue=!1}
function SMouseEvent(){SEvent.call(this);this.button=null;this.ctrlKey=this.altKey=this.mouseRight=this.mouseMiddle=this.mouseLeft=!1;this.clientY=this.clientX=this.offsetY=this.offsetX=this.y=this.x=0;this.attachEvent=SMouseEvent_attachEvent;return this}
function SMouseEvent_attachEvent(b){var f=this.hSource=RHtml.eventSource(b);f&&(this.source=f.__linker);this.button=b.button;this.mouseLeft=b.button==EMouseButton.Left;this.mouseMiddle=b.button==EMouseButton.Middle;this.mouseRight=b.button==EMouseButton.Right;this.altKey=b.altKey;this.ctrlKey=b.ctrlKey;RBrowser.isBrowser(EBrowser.FireFox)?(this.x=b.pageX,this.y=b.pageY,this.offsetX=b.layerX,this.offsetY=b.layerY):(this.x=b.x,this.y=b.y,this.offsetX=b.offsetX,this.offsetY=b.offsetY);this.clientX=b.clientX;
this.clientY=b.clientY}function SResizeEvent(){SEvent.call(this);this.height=this.width=null;this.attachEvent=SResizeEvent_attachEvent;return this}function SResizeEvent_attachEvent(b){if(b=this.hSource=RHtml.eventSource(b))this.source=b.__linker}function SServiceInfo(){this.url=this.action=this.service=null;return this}function SXmlEvent(){SEvent.call(this);this.root=this.document=this.connection=null;return this}
function TDumpItem(){this.link=this.hRow=this.hText=this.hTable=this.hDocument=this.hPanel=this.hParent=null;this.level=0;this.caption=null;this.children=[];this.items=[];this.display=this.innerDisplay=this.loaded=!1;this.create=TDumpItem_create;this.push=TDumpItem_push;this.innerShow=TDumpItem_innerShow;this.show=TDumpItem_show;return this}function TDumpItem_create(){return this.children[this.children.length]=new TDumpItem}function TDumpItem_push(b){this.items[this.items.length]=b}
function TDumpItem_innerShow(b){for(var f=this.items.length,h=0;h<f;h++)RHtml.visibleSet(this.items[h],b);f=this.children.length;for(h=0;h<f;h++){var q=this.children[h];RHtml.visibleSet(q.hRow,b);b?q.show(q.innerDisplay):(q.innerDisplay=q.display,q.show(!1))}}function TDumpItem_show(b){this.display=b;var f=RString.repeat("   ",this.level-1)+(b?" -":" +")+" "+this.caption;this.hText.innerHTML=RHtml.toHtml(f);this.innerShow(b)}
function THtmlItem(){this._link=null;this._links={};this.get=THtmlItem_get;this.set=THtmlItem_set;return this}function THtmlItem_get(b){return this._links[b]}function THtmlItem_set(b,f){this._links[b]=f}function TXmlDocument(){this._root=null;this.create=TXmlDocument_create;this.root=TXmlDocument_root;this.setRoot=TXmlDocument_setRoot;this.xml=TXmlDocument_xml;this.dump=TXmlDocument_dump;return this}
function TXmlDocument_create(b,f,h){var q=new TXmlNode;q._name=b;q._attributes=f;q._value=h;return q}function TXmlDocument_root(){var b=this._root;b||(b=this._root=new TXmlNode,b._name="Configuration");return b}function TXmlDocument_setRoot(b){if(this._root)throw new TError(this,"Root node is already exists.");this._root=b}function TXmlDocument_xml(){var b=new TString;b.append("<?xml version='1.0' encoding='UTF-8'?>");this.root().innerXml(b,0);return b.flush()}
function TXmlDocument_dump(){var b=new TString;b.appendLine(RClass.name(this));this.root().innerDump(b);return b.flush()}function TXmlNode(){TNode.call(this);this.create=TXmlNode_create;this.innerXml=TXmlNode_innerXml;this.xml=TXmlNode_xml;this.toString=TXmlNode_toString;return this}function TXmlNode_create(b,f){var h=new TXmlNode;h._name=b;h._attributes=f;if(!RClass.isClass(f,TAttributes)){f=arguments;var q=f.length;for(b=1;b<q;b+=2)b+1<q?h.set(f[b],f[b+1]):h._value=f[b]}this.push(h);return h}
function TXmlNode_innerXml(b,f){b.appendRepeat("   ",f);b.append("<",this._name);var h=this._attributes;if(h)for(var q=h.count(),u=0;u<q;u++)b.append(" ",h.name(u),'="'),RXml.buildText(b,h.value(u)),b.append('"');this._nodes||null!=this._value||b.append("/");b.append(">\n");if(h=this._nodes)for(q=h.count(),u=0;u<q;u++)h.get(u).innerXml(b,f+1);RXml.buildText(b,this._value);if(this._nodes||null!=this._value)b.appendRepeat("   ",f),b.append("</",this._name,">"),b.append("\n");return b}
function TXmlNode_xml(){var b=new TString;this.innerXml(b,0);return b.flush()}function TXmlNode_toString(){return this.xml().toString()}function FBytes(b){b=RClass.inherits(this,b,FObject,MDataView);b._memory=null;b.construct=FBytes_construct;b.dispose=FBytes_dispose;return b}function FBytes_construct(){this.__base.FObject.construct.call(this);this._memory=new ArrayBuffer;this._viewer=new DataView(this._memory)}
function FBytes_dispose(){this._viewer=this._memory=null;this.__base.FObject.dispose.call(this)}function FClassFactory(b){b=RClass.inherits(this,b,FObject);b._classes=null;b.construct=FClassFactory_construct;b.register=FClassFactory_register;b.unregister=FClassFactory_unregister;b.create=FClassFactory_create;b.dispose=FClassFactory_dispose;return b}function FClassFactory_construct(){this.__base.FObject.construct.call(this);this._classes=new TDictionary}
function FClassFactory_register(b,f){this._classes.set(b,f)}function FClassFactory_unregister(b){this._classes.set(b,null)}function FClassFactory_create(b){var f=this._classes.get(b);if(!f)throw new TError("Create unregister class. (name={1})",b);return RClass.create(f)}function FClassFactory_dispose(){this._classes=RObject.dispose(this._classes);this.__base.FObject.dispose.call(this)}
function FDataStream(b){b=RClass.inherits(this,b,FObject,MDataView,MDataStream);b._length=0;b._memory=null;b._viewer=null;b.construct=FDataStream_construct;b.length=FDataStream_length;b.setLength=FDataStream_setLength;b.memory=FDataStream_memory;b.dispose=FDataStream_dispose;return b}function FDataStream_construct(){this.__base.FObject.construct.call(this)}function FDataStream_length(){return this._length}
function FDataStream_setLength(b){this._length=b;this._memory=new ArrayBuffer(b);this._viewer=new DataView(this._memory)}function FDataStream_memory(){return this._memory}function FDataStream_dispose(){this._memory=this._viewer=null;this.__base.FObject.dispose.call(this)}function FDataView(b){b=RClass.inherits(this,b,FObject,MDataView,MDataStream);b.link=FDataView_link;b.dispose=FDataView_dispose;return b}function FDataView_link(b){this._memory=b;this._viewer=new DataView(b)}
function FDataView_dispose(){this._memory=this._viewer=null;this.__base.FObject.dispose.call(this)}
function FHttpConnection(b){b=RClass.inherits(this,b,FObject);b._asynchronous=!1;b._methodCd=EHttpMethod.Get;b._contentCd=EHttpContent.Binary;b._url=null;b._input=null;b._inputData=null;b._output=null;b._outputData=null;b._connection=null;b._contentLength=0;b._statusFree=!0;b.lsnsLoad=null;b.onConnectionSend=FHttpConnection_onConnectionSend;b.onConnectionReady=FHttpConnection_onConnectionReady;b.onConnectionComplete=FHttpConnection_onConnectionComplete;b.construct=FHttpConnection_construct;b.setHeaders=
FHttpConnection_setHeaders;b.inputData=FHttpConnection_inputData;b.setInputData=FHttpConnection_setInputData;b.outputData=FHttpConnection_outputData;b.setOutputData=FHttpConnection_setOutputData;b.content=FHttpConnection_content;b.sendSync=FHttpConnection_sendSync;b.sendAsync=FHttpConnection_sendAsync;b.send=FHttpConnection_send;return b}function FHttpConnection_onConnectionSend(){this._inputData&&(this._contentLength=this._inputData.length)}
function FHttpConnection_onConnectionReady(){var b=this._linker;if(b._asynchronous){var f=b._connection;if(f.readyState==EHttpStatus.Finish)if(200==f.status)b.setOutputData(),b.onConnectionComplete();else throw new TError(b,"Connection failure. (url={1})",b._url);}}function FHttpConnection_onConnectionComplete(){this._statusFree=!0;this.lsnsLoad.process(this)}
function FHttpConnection_construct(){this.lsnsLoad=new TListeners;var b=this._connection=RXml.createConnection();b._linker=this;b.onreadystatechange=this.onConnectionReady}
function FHttpConnection_setHeaders(){var b=this._connection;this._contentCd==EHttpContent.Binary?RBrowser.isBrowser(EBrowser.Explorer)?(b.setRequestHeader("Accept-Charset","x-user-defined"),b.responseType="arraybuffer"):(b.overrideMimeType("text/plain; charset=x-user-defined"),this._asynchronous&&(b.responseType="arraybuffer")):b.setRequestHeader("content-type","application/x-www-form-urlencoded");RBrowser.isBrowser(EBrowser.Chrome)||0<this._contentLength&&b.setRequestHeader("content-length",this._contentLength)}
function FHttpConnection_inputData(){return this._inputData}function FHttpConnection_setInputData(b){this._inputData=b}function FHttpConnection_outputData(){return this._outputData}function FHttpConnection_setOutputData(){var b=this._connection;this._contentCd==EHttpContent.Binary?(RBrowser.isBrowser(EBrowser.Chrome),this._outputData=b.response):this._outputData=b.responseText}function FHttpConnection_content(){return this._outputData}
function FHttpConnection_sendSync(){var b=this._connection;b.open(this._methodCd,this._url,!1);this.setHeaders(b,0);b.send(this._inputData);this.setOutputData();this.onConnectionComplete();RLogger.info(this,"Send http sync request. (method={1}, url={2})",this._methodCd,this._url)}
function FHttpConnection_sendAsync(){var b=this._connection;b.open(this._methodCd,this._url,!0);this.setHeaders(b,0);b.send(this._inputData);RLogger.info(this,"Send http asynchronous request. (method={1}, url={2})",this._methodCd,this._url)}function FHttpConnection_send(b,f){this._url=b;this._input=f;this._methodCd=null!=f?EHttpMethod.Post:EHttpMethod.Get;this._statusFree=!1;this.onConnectionSend();this._asynchronous?this.sendAsync():this.sendSync();return this.content()}
function FImage(b){b=RClass.inherits(this,b,FObject,MListenerLoad);b._optionAlpha=!0;b._ready=!1;b._size=null;b._url=null;b._hImage=null;b.ohLoad=FImage_ohLoad;b.ohError=FImage_ohError;b.construct=FImage_construct;b.optionAlpha=FImage_optionAlpha;b.setOptionAlpha=FImage_setOptionAlpha;b.size=FImage_size;b.image=FImage_image;b.url=FImage_url;b.testReady=FImage_testReady;b.loadUrl=FImage_loadUrl;b.dispose=FImage_dispose;return b}
function FImage_ohLoad(){var b=this.__linker,f=b._hImage;b._size.set(f.naturalWidth,f.naturalHeight);b._ready=!0;b.processLoadListener(b)}function FImage_ohError(b){debugger}function FImage_construct(){this.__base.FObject.construct.call(this);this._size=new SSize2}function FImage_optionAlpha(){return this._optionAlpha}function FImage_setOptionAlpha(b){this._optionAlpha=b}function FImage_size(){return this._size}function FImage_image(){return this._hImage}function FImage_url(){return this._url}
function FImage_testReady(){return this._ready}function FImage_loadUrl(b){this._url=b;var f=this._hImage;f||(f=this._hImage=new Image,f.__linker=this,f.onload=this.ohLoad,f.onerror=this.ohError);f.src=b}function FImage_dispose(){this._size=RObject.dispose(this._size);this._hImage=RHtml.free(this._hImage);this.__base.MListenerLoad.dispose.call(this);this.__base.FObject.dispose.call(this)}
function FXmlConnection(b){b=RClass.inherits(this,b,FHttpConnection);b._contentCd=EHttpContent.Text;b._inputNode=null;b._outputNode=null;b.onConnectionSend=FXmlConnection_onConnectionSend;b.onConnectionComplete=FXmlConnection_onConnectionComplete;b.content=FXmlConnection_content;return b}
function FXmlConnection_onConnectionSend(){var b=this._input;if(b){var f=null;if(b.constructor==String)f=b,this._inputNode=null;else if(b.constructor==TXmlNode)f=new TXmlDocument,f.setRoot(b),f=f.xml(),this._inputNode=b;else if(b.constructor==TXmlDocument)f=b.xml(),this._inputNode=b.root();else throw new TError("Unknown send data type.");this._inputData=f;this._contentLength=f.length}}
function FXmlConnection_onConnectionComplete(){var b=this._connection,f=null;if(b.responseXML)f=b.responseXML.documentElement;else if(b.responseXml)f=b.responseXml.documentElement;else throw new TError(this,"Fetch xml data failure.");if(!f)return RMessage.fatal(this,null,"Read xml error. (url={1})\n{2}",this._url,b._outputText);b=new TXmlDocument;RXml.buildNode(b,null,f);var h=this._outputNode=b.root();this._statusFree=!0;f=new SXmlEvent;f.connection=this;f.document=b;f.root=h;f.parameters=this._parameters;
this.lsnsLoad.process(f);f.dispose();this._asynchronous&&(this._parameters=this._outputNode=this._output=this._inputNode=this._input=null)}function FXmlConnection_content(){return this._outputNode}
var RDump=new function(){this.LINE_SINGLE="------------------------------";this.LINE_DOUBLE="==============================";this.LINE_DOT="..............................";this.LINE_STAR="******************************";this.onclick=RDump_onclick;this.nameInfo=RDump_nameInfo;this.typeInfo=RDump_typeInfo;this.dumpInner=RDump_dumpInner;this.dump=RDump_dump;this.appendLevel=RDump_appendLevel;this.stack=RDump_stack;return this};
function RDump_onclick(){var b=this.link;this.link&&(b.loaded?b.show(!b.display):(RDump.dumpInner(this.link),b.loaded=!0,b.show(!0)))}function RDump_nameInfo(b){switch(RClass.typeOf(b)){case "Unknown":return"@unknown";case "Function":return RMethod.name(b)+"@Function";case "Array":return"@<Array>"}return b}
function RDump_typeInfo(b,f){if(null==b)return"null";switch(f){case "Unknown":return"unknown";case "Undefined":return"undefined";case "Boolean":case "Number":return b.toString();case "String":return b.length+":'"+RString.toLine(b)+"'";case "Function":return b.__virtual?"virtual":RMethod.name(b,!0);case "Array":return"@<Array@"+RClass.code(b)+"> length="+b.length;case "Html":return"@<"+b.tagName+">";default:if(b.constructor==TClass)return"@<"+b.name+"@"+RClass.code(b)+">";if(b.constructor==Function)return"@"+
b.toString();try{for(var h in b)return"@<Object@"+RClass.code(b)+">"}catch(q){}return"<Object@"+RClass.code(b)+">"}}
function RDump_dumpInner(b){var f=b.hTable,h=b.hRow,q=b.level,u=b.link,z=RClass.typeOf(u,!0),A=u.__class,B=[],C;for(C in u)B[B.length]=C;RString.endsWith(z,"Array")?RArray.reverse(B,0,B.length-1):RArray.sort(B,!0);var D=B.length;2E3<D&&(D=2E3);for(var E=0;E<D;E++){C=B[E];var F=u[C];RClass.safeTypeOf(F,!0);var z=RClass.safeTypeOf(F,!0),G=null,K=!0;if(A){var H=A.attributeFind(C);H&&(z="Annotation<"+RMethod.name(H.constructor)+">",G=F&&F.constructor==Function?"<FONT color='green'>"+RMethod.name(F)+"</FONT>":
F+"<FONT color='green'> - ("+RHtml.toHtml(H.toString())+")</FONT>",K=!1)}null==G&&(G=this.typeInfo(F,z));var H=null,J=RBuilder.appendTableRow(f,null,h?h.rowIndex+1:0);J.bgColor="#FFFFFF";RString.startsWith(G,"@")?(J.style.cursor="pointer",J.onclick=this.onclick,J.bgColor="#FFF0E0",H=J.link=b.create(),H.link=F,H.level=q,H.caption=C,H.hTable=f,H.level=q+1,H.hRow=J):b.push(J);"Function"==z&&"virtual"==G&&(J.bgColor="#E0F0FF");var F=RBuilder.appendTableCell(J),I=RString.startsWith(G,"@")?" +":"  ";C=
RString.repeat("   ",q)+I+" "+C;F.innerHTML=RHtml.toHtml(C);F.style.borderBottom="1px solid #F0F0F0";F.width="240px";H&&(H.hText=F);F=RBuilder.appendTableCell(J);F.innerHTML=RHtml.toHtml(z);F.style.borderBottom="1px solid #F0F0F0";F.style.color="Function"==z?"#3333FF":"#FF3333";F.width="200px";F=RBuilder.appendTableCell(J);RString.startsWith(G,"@")&&(G=G.substr(1));F.innerHTML=K?RHtml.toHtml(G):G;F.style.borderBottom="1px solid #F0F0F0"}f.width="100%"}
function RDump_dump(b,f){f||(f=RBuilder.append(null,"DIV"));var h=new TString;h.append("<",RClass.safeTypeOf(b));b&&b.tagName&&h.append(" - ",b.tagName);h.appendLine("@"+RClass.code(b)+">");var q=RBuilder.append(f,"DIV");q.style.border="1px solid #BBBBBB";q.style.backgroundColor="#E0E0EB";var u=RBuilder.appendTable(q,null,null,0,1,0),z=RBuilder.appendTableRow(u),z=RBuilder.appendTableCell(z);u.width="100%";z.style.padding=2;z.style.borderBottom="1px solid gray";z.style.backgroundColor="#E0E0EB";RHtml.textSet(z,
h.toString());h=RBuilder.appendTable(q,null,null,0,1,0);h.style.width="100%";q=new TDumpItem;q.hTable=h;q.hRow=null;q.hParent=f;q.link=b;q.level=0;this.dumpInner(q)}function RDump_appendLevel(b,f){for(var h=0;h<f;h++)b.append("   ")}function RDump_stack(){for(var b=RDump_stack.caller,f=new TString;b;)f.append(RMethod.name(b)),(b=b.caller)&&f.appendLine();RLogger.debug(this,f)}
var REngine=new function(){this._spaces={};this.Global={};this.Top={};this.Local={};this.onRelease=REngine_onRelease;this.register=REngine_register;this.initialize=REngine_initialize;this.connect=REngine_connect;this.buildSpace=REngine_buildSpace;this.find=REngine_find;this.findGlobal=REngine_findGlobal;this.findTop=REngine_findTop;this.findLocal=REngine_findLocal;return this};function REngine_onRelease(){RConsole.release();REvent.release();CollectGarbage()}
function REngine_register(b){var f=this._spaces[b.space];f||(f=this._spaces[b.space]={});f[b.name]=b}function REngine_initialize(){RConsole.initialize()}function REngine_connect(){RConsole.initialize()}function REngine_buildSpace(b,f){for(var h in f)RString.startsWith(h,"R")&&(b[h.substring(1)]=f[h].instance)}function REngine_find(b,f){var h=null;if(b=this._spaces[b])if(h=b[f])return h.instance;return null}function REngine_findGlobal(b){return this.find(ESpace.Global,b)}
function REngine_findTop(b){return top.REngine.find(ESpace.Top,b)}function REngine_findLocal(b){return this.find(ESpace.Local,b)}
var RHtml=new function(){this._nextUid=1;this._links={};this._clientPosition=new SPoint2;this.uid=RHtml_uid;this.fullscreen=RHtml_fullscreen;this.displayGet=RHtml_displayGet;this.displaySet=RHtml_displaySet;this.visibleGet=RHtml_visibleGet;this.visibleSet=RHtml_visibleSet;this.textGet=RHtml_textGet;this.textSet=RHtml_textSet;this.checkGet=RHtml_checkGet;this.checkSet=RHtml_checkSet;this.radioGet=RHtml_radioGet;this.radioSet=RHtml_radioSet;this.linkGet=RHtml_linkGet;this.linkSet=RHtml_linkSet;this.clientPosition=
RHtml_clientPosition;this.clientX=RHtml_clientX;this.clientY=RHtml_clientY;this.setSize=RHtml_setSize;this.toText=RHtml_toText;this.toHtml=RHtml_toHtml;this.eventSource=RHtml_eventSource;this.searchLinker=RHtml_searchLinker;this.searchObject=RHtml_searchObject;this.free=RHtml_free;this.offsetPosition=RHtml_offsetPosition;this.offsetX=RHtml_offsetX;this.offsetY=RHtml_offsetY;this.scrollWidth=RHtml_scrollWidth;this.scrollHeight=RHtml_scrollHeight;this.radioSet=RHtml_radioSet;this.point=RHtml_point;
this.toPoint=RHtml_toPoint;this.rect=RHtml_rect;this.toRect=RHtml_toRect;this.top=RHtml_top;this.clientRect=RHtml_clientRect;this.offsetRect=RHtml_offsetRect;this.changeWidth=RHtml_changeWidth;this.clear=RHtml_clear;this.setRect=RHtml_setRect;this.setBounds=RHtml_setBounds;this.setPixelRect=RHtml_setPixelRect;this.setPixelBounds=RHtml_setPixelBounds;this.showNodes=RHtml_showNodes;this.hideNodes=RHtml_hideNodes;this.showChildren=RHtml_showChildren;this.hideChildren=RHtml_hideChildren;this.get=RHtml_get;
this.parent=RHtml_parent;this.posParent=RHtml_posParent;this.form=RHtml_form;this.popup=RHtml_popup;this.bodyWidth=RHtml_bodyWidth;this.bodyHeight=RHtml_bodyHeight;this.frameHeight=RHtml_frameHeight;this.selectText=RHtml_selectText;this.currentStyle=RHtml_currentStyle;this.tableMoveRow=RHtml_tableMoveRow;this.clone=RHtml_clone;return this};function RHtml_uid(b){var f=b.__puuid;null==f&&(f=b.__puuid=RHtml._nextUid++);return f}
function RHtml_fullscreen(b,f){f?b.requestFullscreen?b.requestFullscreen():b.mozRequestFullScreen?b.mozRequestFullScreen():b.webkitRequestFullScreen&&b.webkitRequestFullScreen():b.exitFullscreen?b.exitFullscreen():b.mozCancelFullScreen?b.mozCancelFullScreen():b.webkitCancelFullScreen&&b.webkitCancelFullScreen()}function RHtml_displayGet(b){var f=null;b=b.style.display;return f=RBrowser.isBrowser(EBrowser.Explorer)?"inline"==b:"none"!=b}
function RHtml_displaySet(b,f){var h=null,h=RBrowser.isBrowser(EBrowser.Explorer)?f?"inline":"none":f?null:"none";b.style.display=h}function RHtml_visibleGet(b){var f=null;b=b.style.display;return f=RBrowser.isBrowser(EBrowser.Explorer)?"block"==b:"none"!=b}function RHtml_visibleSet(b,f){var h=null,h=RBrowser.isBrowser(EBrowser.Explorer)?f?"":"none":f?null:"none";b.style.display=h}function RHtml_textGet(b,f){var h=null;return h=RBrowser.isBrowser(EBrowser.FireFox)?b.textContent:b.innerText}
function RHtml_textSet(b,f){RBrowser.isBrowser(EBrowser.FireFox)?b.textContent=f:b.innerText=f}function RHtml_checkGet(b){return RBool.toString(b.checked)}function RHtml_checkSet(b,f){b.checked=RBool.isTrue(f)}function RHtml_radioGet(b){if(b)for(var f=b.length,h=0;h<f;h++){var q=b[h];if(q.checked)return q.value}return null}function RHtml_radioSet(b,f){if(b)for(var h=b.length,q=0;q<h;q++){var u=b[q];if(u.value==f){u.checked=!0;break}}}
function RHtml_linkGet(b,f){var h=this.uid(b);return(h=this._links[h])?h.get(f):null}function RHtml_linkSet(b,f,h){var q=this._links,u=this.uid(b),z=q[u];z||(z=q[u]=new THtmlItem,z._link=b);z.set(f,h)}function RHtml_clientPosition(b,f){var h=this._clientPosition;for(h.set(0,0);b!=f;)h.x+=b.offsetLeft+b.clientLeft-b.scrollLeft,h.y+=b.offsetTop+b.clientTop-b.scrollTop,b=b.offsetParent;return h}function RHtml_clientX(b,f){for(var h=0;b!=f;)h+=b.offsetLeft-b.scrollLeft,b=b.offsetParent;return h}
function RHtml_clientY(b,f){for(var h=0;b!=f;)h+=b.offsetTop-b.scrollTop,b=b.offsetParent;return h}function RHtml_setSize(b,f){f.width&&(b.style.width=f.width+"px");f.height&&(b.style.height=f.height+"px")}function RHtml_toText(b){null!=b&&(b=b.toString(),b=b.replace(/&lt;/,"<"),b=b.replace(/&gt;/g,">"),b=b.replace(/&nbsp;/g," "),b=b.replace(/<BR>/g,"\n"));return b}
function RHtml_toHtml(b){null!=b&&(b=b.toString(),b=b.replace(/</g,"&lt;"),b=b.replace(/>/g,"&gt;"),b=b.replace(/ /g,"&nbsp;"),b=b.replace(/\n/g,"<BR>"),b=b.replace(/\\n/g,"<BR>"),b=b.replace(/\r/g,""),b=b.replace(/\\r/g,""));return b}function RHtml_eventSource(b){return b.srcElement?b.srcElement:b.target}function RHtml_searchLinker(b,f){for(;b;){var h=b.__linker;if(h&&RClass.isClass(h,f))return h;b=b.parentElement}return null}
function RHtml_searchObject(b,f){for(;b;){var h=b[f];if(h)return h;b=b.parentElement}return null}function RHtml_free(b){return null}function RHtml_clone(b,f,h){h||(h=f.cloneNode(!0));f._pname&&(b[f._pname]=h);f._ptyName&&(b[f._ptyName]=h);var q=REvent.find(f).events;h._psource=f;for(var u in q)h[q[u].handle]=f[q[u].handle],h[q[u].handle]&&RHtml.link(h,"_plink",b);f=f.children;for(u=f.length;0<=--u;)RHtml_clone(b,f[u],h.children[u]);return h}
function RHtml_offsetPosition(b,f){for(var h=new TPoint;b!=f;)h.x+=b.offsetLeft-b.scrollLeft,h.y+=b.offsetTop-b.scrollTop,RHtml.currentStyle(b),h.x+=b.clientLeft,h.y+=b.clientTop,b=b.offsetParent;return h}function RHtml_offsetX(b){for(var f=0;b;)f+=b.offsetLeft,b=b.offsetParent;return f}function RHtml_offsetY(b){for(var f=0;b;)f+=b.offsetTop,b=b.offsetParent;return f}function RHtml_bodyWidth(b){return b.all?b.body.scrollWidth:b.documentElement.scrollWidth}
function RHtml_bodyHeight(b){return b.all?b.body.scrollHeight:b.documentElement.scrollHeight}function RHtml_frameHeight(b){b=b.contentWindow.document;return Math.max(b.body.scrollHeight,b.documentElement.scrollHeight)}function RHtml_scrollWidth(b){var f=0;b.offsetWidth&&(f+=b.offsetWidth);b.borderTopWidth&&(f-=parseInt(b.borderLeftWidth));b.borderBottomWidth&&(f-=parseInt(b.borderRightWidth));b.clientWidth&&(f-=b.clientWidth);return f}
function RHtml_scrollHeight(b){var f=0;b.offsetHeight&&(f+=b.offsetHeight);b.borderTopWidth&&(f-=parseInt(b.borderTopWidth));b.borderBottomWidth&&(f-=parseInt(b.borderBottomWidth));b.clientHeight&&(f-=b.clientHeight);return f}function RHtml_currentStyle(b){return b.currentStyle?b.currentStyle:window.getComputedStyle(b,null)}function RHtml_point(b,f){return this.toPoint(new TPoint,b,f)}
function RHtml_toPoint(b,f,h){if(b&&f){h=RObject.nvl(h,window.document.body);var q=RHtml.currentStyle(f);b.x=-RInt.parse(q.borderLeftWidth);for(b.y=-RInt.parse(q.borderTopWidth);f&&f!=h;)b.x+=f.offsetLeft-f.scrollLeft,b.y+=f.offsetTop-f.scrollTop,"absolute"!=RHtml.currentStyle(f).position&&(b.x+=f.clientLeft,b.y+=f.clientTop),f=f.offsetParent}return b}function RHtml_rect(b,f){return this.toRect(new TRect,b,f)}
function RHtml_toRect(b,f,h){if(b&&f){h=RObject.nvl(h,window.document.body);var q=RHtml.currentStyle(f);b.left=-RInt.parse(q.borderLeftWidth);b.top=-RInt.parse(q.borderTopWidth);for(var q=f.offsetWidth,q=f.offsetWidth-1,u=f.offsetHeight,u=f.offsetHeight-1;f&&f!=h;)b.left+=f.offsetLeft-f.scrollLeft,b.top+=f.offsetTop-f.scrollTop,"absolute"!=RHtml.currentStyle(f).position&&(b.left+=f.clientLeft,b.top+=f.clientTop),f=f.offsetParent;b.right=b.left+q;b.bottom=b.top+u}return b}
function RHtml_top(b){var f=0;if(b)for(f=RHtml.currentStyle(o),f=-RInteger.parse(f.borderTopWidth);b;)f+=b.offsetTop-b.scrollTop,"absolute"!=RHtml.currentStyle(o).position&&(f+=b.clientTop),b=b.offsetParent;return f}function RHtml_clientRect(b){if(b){for(var f=0,h=0,q=b.offsetWidth-1,u=b.offsetHeight-1;b;)f+=b.offsetLeft,h+=b.offsetTop,b=b.offsetParent;return new TRect(f,h,f+q,h+u)}return null}
function RHtml_offsetRect(b){if(b){for(var f=0,h=0,q=b.offsetWidth-1,u=b.offsetHeight-1;b;)f+=b.offsetLeft+b.clientLeft,h+=b.offsetTop+b.clientTop,b=b.offsetParent;return new TRect(f,h,f+q,h+u)}return null}function RHtml_clear(b){if(b){var f=b.children;if(f&&f.length)for(var h=f.length-1;0<=h;h--){var q=f[h];q.children&&q.children.length&&this.clear(q);b.removeChild(q)}}}function RHtml_setRect(b,f){if(b&&b.style){var h=b.style;h.left=f.left;h.top=f.top;h.width=f.width();h.height=f.height()}}
function RHtml_setBounds(b,f,h,q,u){b&&b.style&&(b=b.style,null!=f&&(b.left=f),null!=h&&(b.top=h),null!=q&&(b.width=q),null!=u&&(b.height=u))}function RHtml_setPixelRect(b,f){if(b&&b.style){var h=b.style;h.pixelLeft=f.left;h.pixelTop=f.top;h.pixelWidth=f.width();h.pixelHeight=f.height()}}function RHtml_setPixelBounds(b,f,h,q,u){b&&b.style&&(b=b.style,null!=f&&(b.pixelLeft=f),null!=h&&(b.pixelTop=h),null!=q&&(b.pixelWidth=q),null!=u&&(b.pixelHeight=u))}
function RHtml_changeWidth(b,f){if(b&&f){var h=RHtml.currentStyle(f),h=parseInt(h.paddingLeft)+parseInt(h.paddingRight);f.style.pixelWidth=b.offsetWidth-h}}function RHtml_showNodes(b,f){if(b&&b.childNodes)for(var h=0;h<b.childNodes.length;h++){var q=b.childNodes(h);q.tagName&&q.style?q.style.display="block":"#text"==q.nodeName&&(q.nodeValue=f[h])}}
function RHtml_hideNodes(b,f){if(b&&b.childNodes)for(var h=0;h<b.childNodes.length;h++){var q=b.childNodes(h);q.tagName&&q.style?q.style.display="none":"#text"==q.nodeName&&(f[h]=q.nodeValue,q.nodeValue="")}}function RHtml_showChildren(b){if(b&&b.children)for(var f=0;f<b.children.length;f++){var h=b.children(f);h.tagName&&h.style&&(h.style.display="block")}}
function RHtml_hideChildren(b){if(b&&b.children)for(var f=0;f<b.children.length;f++){var h=b.children(f);h.tagName&&h.style&&(h.style.display="none")}}function RHtml_get(b){return document.getElementById(b)}function RHtml_parent(b,f){if(b&&f)for(f=f.toLowerCase();b;){if(b.tagName.toLowerCase()==f)return b;b=b.parentElement}return null}function RHtml_posParent(b){for(;b;){if("visible"!=b.currentStyle.overflow)return b;b=b.offsetParent}return null}
function RHtml_form(b){if(b){var f=this.parent(b,"FORM");return f?f:b.ownerDocument.forms[0]}return window.document.forms[0]}function RHtml_popup(b,f,h){f=RString.format("left={0},top={1},width={2},height={3},toolbar=no,location=no,directories=no,status=no,menubar=no,resizable=yes,scrollbars=yes,dependent=yes",(screen.width-f)/2,(screen.height-h)/2-20,f,h);window.open(b,"_blank",f)}function RHtml_selectText(){document.getElementById(id).select();return document.selection.createRange().text}
function getTRNode(b,f){for(;(b=b[f])&&"TR"!=b.tagName;);return b}function RHtml_tableMoveRow(b,f,h){if("TABLE"!=b.tagName||f==h)return!1;if(b.moveRow)b.moveRow(f,h);else{b=b.getElementsByTagName("tbody")[0];var q=b.rows[f],u=b.rows[h];if(null==q||null==u)return!1;var z=null;if(f<=h)for(z=u;(z=z.nextSibling)&&"TR"!=z.tagName;);null==z?b.insertBefore(q,u):null==z?b.appendChild(q):b.insertBefore(q,z)}return!0}
var RKeyboard=new function(){this._status=[];this.onKeyDown=RKeyboard_onKeyDown;this.onKeyUp=RKeyboard_onKeyUp;this.construct=RKeyboard_construct;this.isControlKey=RKeyboard_isControlKey;this.isIntegerKey=RKeyboard_isIntegerKey;this.isFloatKey=RKeyboard_isFloatKey;this.isNumKey=RKeyboard_isNumKey;this.isPress=RKeyboard_isPress;this.fixCase=RKeyboard_fixCase;this.fixPattern=RKeyboard_fixPattern;this.fixChars=RKeyboard_fixChars;return this};
function RKeyboard_onKeyDown(b){this._status[b.keyCode]=EKeyStatus.Press}function RKeyboard_onKeyUp(b){this._status[b.keyCode]=EKeyStatus.Normal}function RKeyboard_construct(){for(var b=this._status,f=0;256>f;f++)b[f]=EKeyStatus.Normal;RWindow.lsnsKeyDown.register(this,this.onKeyDown);RWindow.lsnsKeyUp.register(this,this.onKeyUp)}function RKeyboard_isControlKey(b){for(var f=EKeyCode.ControlKeys,h=f.length-1;0<=h;h--)if(f[h]==b)return!0;return!1}
function RKeyboard_isIntegerKey(b){return EKeyCode.integerCodes[b]}function RKeyboard_isFloatKey(b){return EKeyCode.floatCodes[b]}function RKeyboard_isNumKey(b){return 96<=p&&105>=p?!0:!1}function RKeyboard_isPress(b){return this._status[b]==EKeyStatus.Press}function RKeyboard_fixCase(b,f){if(b&&f){var h=b.keyCode;ECase.Upper==f?h=String.fromCharCode(h).toUpperCase().charCodeAt(0):ECase.Lower==f&&(h=String.fromCharCode(h).toLowerCase().charCodeAt(0));b.keyCode=h}}
function RKeyboard_fixPattern(b,f){if(f){var h=b.keyCode;if(!this.isControlKeyPress(h)&&!RString.isPattern(String.fromCharCode(h),f))return b.keyCode=0,!1}return!0}function RKeyboard_fixChars(b,f){if(f){var h=b.keyCode;this.isNumKey(h)&&(h=b.keyCode-=48);if(!this.isControlKeyPress(h)&&!RString.inChars(String.fromCharCode(h),f))return b.keyCode=0,b.returnValue=!1}return!0}
var RLoader=new function(){this._loading=new TArray;this._loaded=new TArray;this._waits=new TArray;this.hWindow=this._intervalId=null;this.onInterval=RLoader_onInterval;this.intervalStart=RLoader_intervalStart;this.intervalStop=RLoader_intervalStop;this.loadJsFile=RLoader_loadJsFile;this.loadJs=RLoader_loadJs;this.loaded=RLoader_loaded;this.wait=RLoader_wait;this.waitJs=RLoader_waitJs;this.dispose=RLoader_dispose;return this};function RLoader_dispose(){this.intervalStop();this.hWindow=null}
function RLoader_onInterval(){for(var b=this._waits,f=b.length,h=0;h<f;h++){var q=b.get(h);q&&q.check(this._loaded)&&(q.invoke.invoke(),b.set(h,null))}b.compress();b.isEmpty()&&this.intervalStop()}function RLoader_intervalStart(){var b=this;b._intervalId||(b.hWindow=window,b._intervalId=window.setInterval(function(){b.onInterval()},10))}function RLoader_intervalStop(){var b=this.hWindow;b&&this._intervalId&&(b.clearInterval(this._intervalId),this._intervalId=this.hWindow=null)}
function RLoader_loadJsFile(b,f){var h=this,q=RWindow.hDocument,u=q.getElementsByTagName("head")[0];if(null==document.getElementById(b)){var z=top.RContext.location(f),A=RWindow.createElement("SCRIPT");A.id=b;A.type="text/javascript";A.src=z;q.attachEvent?A.onreadystatechange=function(){var f=A.readyState;if("loaded"==f||"complete"==f)A.onreadystatechange=null,h._loading.extract(b),h._loaded.push(b)}:A.onload=function(){"complete"==q.readyState&&(A.onload=null,h._loading.extract(b),h._loaded.push(b))};
u.appendChild(A)}}function RLoader_loadJs(b){for(var f=arguments,h=f.length,q=0;q<h;q++){var u=f[q];this.loadJsFile("js:"+u,"/ajs/"+u.replace(/\./g,"/")+".js")}}function RLoader_loaded(b){this._loading.extract(b);this._loaded.push(b)}function RLoader_wait(b,f){var h=new TLoaderListener;h.invoke=b;for(var q=arguments.length,u=1;u<q;u++)h.ids.push(arguments[u]);this._waits.push(h);this.intervalStart()}
function RLoader_waitJs(b,f){var h=new TLoaderListener;h.invoke=b;for(var q=arguments,u=q.length,z=1;z<u;z++)h.ids.push("js:"+q[z]);this._waits.push(h);this.intervalStart()}var RMessage=new function(){this._hasError=!1;this._messages=null;this.push=RMessage_push;this.fatal=RMessage_fatal;this.confirmResult=!1;this.error=RMessage_error;this.warn=RMessage_warn;this.onWindowClose=RMessage_onWindowClose;this.confirm=RMessage_confirm;this.info=RMessage_info;return this};
function RMessage_push(b){this._messages||(this._messages=new FLoopList);this._messages.push(b)}
function RMessage_fatal(b,f,h,q){if(!this._hasError){this._hasError=!0;for(var u=new TString,z=[],A=RMessage_fatal.caller;A&&!RArray.contains(z,A);)z.push(A),A=A.caller;for(var B=z.length,C=0;C<B;C++)A=z[C],0<C&&u.appendLine(),u.append("   "+(B-C)+": "+RMethod.name(A));z=new TString;z.appendLine(RContext.get("RMessage:fatal"));z.appendLine(RString.repeat("-",60));z.append(RClass.dump(b),": ");if(h)for(A=arguments,B=A.length,C=3;C<B;C++){var D=A[C];"function"==typeof D&&(D=RMethod.name(D));h=h.replace("{"+
(C-2)+"}",D)}z.appendLine(h);z.appendLine(RString.repeat("-",60));z.appendLine("Stack:");z.append(u);alert(z)}}function RMessage_error(b,f,h,q){if(!this._hasError)throw this._hasError=!0,Error(h);}function RMessage_warn(b,f,h){new TString;b=top.RControl.create(FAlertWindow);b.setText(f);b.show()}function RMessage_info(b,f,h){new TString;b=top.RControl.create(FInfoWindow);b.setText(f);b.show()}
function RMessage_confirm(b,f){var h=top.RControl.create(FConfirmWindow);h.setText(b);h.lsns.register(this,f);h.show()}function RMessage_onWindowClose(b){this.confirmResult=b}var RResource=new function(){this.uriIcon="/ars/icon/";this.uriImage="/ars/img/";this.iconPath=RResource_iconPath;this.iconUrlPath=RResource_iconUrlPath;this.imagePath=RResource_imagePath;return this};
function RResource_iconPath(b,f){b=RString.nvl(b,"n").replace(/\./g,"/")+"."+RString.nvl(f,"gif");return RBrowser.contentPath("/ars/icon/"+b)}function RResource_iconUrlPath(b,f){b=RString.nvl(b,"n").replace(/\./g,"/")+"."+RString.nvl(f,"gif");return RBrowser.contentPath("/ars/icon/"+b)}function RResource_imagePath(b,f){}var RService=new function(){this._services=new TDictionary;this.url=RService_url;this.parse=RService_parse;return this};
function RService_url(b){if(RString.startsWith(b,"http://"))return b;if(RString.startsWith(b,"#"))return b.substr(1);RString.startsWith(b,"/")||(b="/"+b);return b+".ws"}
function RService_parse(b){var f=null,h=this._services;if(b){f=h.get(b);if(null==f){var q=b.split("@");1==q.length?q[0]&&(f=new SServiceInfo,f.service=q[0],f.action=null,f.url=this.url(q[0])):2==q.length&&q[0]&&q[1]&&(f=new SServiceInfo,f.service=q[1],f.action=q[0],f.url=this.url(q[1])+"?action="+q[0])}if(null==f)throw new TError(this,"Unknown service format. (source={1})",b);h.set(b,f)}return f}
var RStyle=new function(){this._connected=!1;this._rules=new TMap;this.connect=RStyle_connect;this.has=RStyle_has;this.nvl=RStyle_nvl;this.style=RStyle_style;return this};function RStyle_connect(){if(!this._connected){for(var b=this._rules,f=document.styleSheets,h=f.length,q=0;q<h;q++){var u=f[q].cssRules;if(u)for(var z=u.length,A=0;A<z;A++){var B=u[A];b.set(B.selectorText,B)}}this._connected=!0}}
function RStyle_has(b){this._connected||this.connect();return b?this._rules.contains("."+b.toLowerCase()):!1}function RStyle_nvl(b,f){this.connect();var h=arguments,q=h.length;for(f=0;f<q;f++)if((b=h[f])&&this._rules.contains("."+b.toLowerCase()))return b;return null}function RStyle_style(b,f){return RClass.name(b)+"_"+f}
var RTypeArray=new function(){this._float4=this._float3=null;this._data={};this.float3=RTypeArray_float3;this.float4=RTypeArray_float4;this.createArray=RTypeArray_createArray;this.findTemp=RTypeArray_findTemp;return this};function RTypeArray_float3(){var b=this._float3;null==b&&(b=this._float3=new Float32Array(3));return b}function RTypeArray_float4(){var b=this._float4;null==b&&(b=this._float4=new Float32Array(4));return b}
function RTypeArray_createArray(b,f){switch(b){case EDataType.Boolean:case EDataType.Int8:return new Int8Array(f);case EDataType.Int16:return new Int16Array(f);case EDataType.Int32:return new Int32Array(f);case EDataType.Int64:return new Int64Array(f);case EDataType.Uint8:return new Uint8Array(f);case EDataType.Uint16:return new Uint16Array(f);case EDataType.Uint32:return new Uint32Array(f);case EDataType.Float:return new Float32Array(f);case EDataType.Double:return new Float64Array(f)}throw new TError("Create unknown type array. (type={1}, length={2})",
b,f);}function RTypeArray_findTemp(b,f){var h=this._data,q=h[b];null==q&&(q=h[b]={});h=q[f];null==h&&(h=q[f]=this.createArray(b,f));return h}function FTag(b){b=RClass.inherits(this,b,FObject);b._name="Tag";b._children=null;b._trimLeft=!1;b._trimRight=!1;b.onBegin=FTag_onBegin;b.onEnd=FTag_onEnd;b.name=FTag_name;b.set=FTag_set;b.push=FTag_push;b.parse=FTag_parse;b.toString=FTag_toString;b.innerDump=FTag_innerDump;b.dump=FTag_dump;return b}function FTag_onBegin(b){return EResult.Continue}
function FTag_onEnd(b){return EResult.Continue}function FTag_name(){return this._name}function FTag_set(b,f){throw new TError(this,"Unknown attribute name. (name={1}, value={2})",b,f);}function FTag_push(b){var f=this._children;null==f&&(f=this._children=new TObjects);f.push(b)}
function FTag_parse(b){var f=this.onBegin(b);if(f==EResult.Continue){var h=this._children;if(h)for(var q=h.count(),u=0;u<q;u++){var z=h.get(u),f=z.parse(b);if(f==EResult.Cancel)return f;b._trimLeft=z._trimLeft;b._trimRight=z._trimRight}return this.onEnd(b)}return f}function FTag_toString(){return null}
function FTag_innerDump(b,f,h){b.appendRepeat("   ",h);b.append(RClass.dump(f));var q=f.toString();RString.isEmpty(q)||b.append(" [",q,"]");if(f=f._children){b.append("\n");for(var q=f.count(),u=0;u<q;u++){var z=f.get(u);this.innerDump(b,z,h+1);u<q-1&&b.append("\n")}}}function FTag_dump(){var b=new TString;this.innerDump(b,this,0);return b.toString()}
function FTagContext(b){b=RClass.inherits(this,b,FObject,MInstance);b._trimLeft=!1;b._trimRight=!1;b._attributes=null;b._source=null;b.construct=FTagContext_construct;b.instanceAlloc=FTagContext_instanceAlloc;b.attributes=FTagContext_attributes;b.get=FTagContext_get;b.set=FTagContext_set;b.setBoolean=FTagContext_setBoolean;b.source=FTagContext_source;b.write=FTagContext_write;b.resetSource=FTagContext_resetSource;b.dispose=FTagContext_dispose;return b}
function FTagContext_construct(){this.__base.FObject.construct.call(this);this._attributes=new TAttributes;this._source=new TString}function FTagContext_instanceAlloc(b){this._attributes.clear()}function FTagContext_attributes(){return this._attributes}function FTagContext_get(b,f){return this._attributes.get(b,f)}function FTagContext_set(b,f){this._attributes.set(b,f)}function FTagContext_setBoolean(b,f){this._attributes.set(b,RBoolean.toString(f))}
function FTagContext_source(){return this._source.toString()}function FTagContext_write(b){RString.isEmpty(b)||this._source.append(b)}function FTagContext_resetSource(b){this._source.clear()}function FTagContext_dispose(){this._attributes.dispose();this._attributes=null;this._source.dispose();this._source=null;this.__base.FObject.dispose.call(this)}
function FTagDocument(b){b=RClass.inherits(this,b,FObject);b._space=null;b._root=null;b.space=FTagDocument_space;b.setSpace=FTagDocument_setSpace;b.create=FTagDocument_create;b.root=FTagDocument_root;b.loadNode=FTagDocument_loadNode;b.load=FTagDocument_load;b.parse=FTagDocument_parse;b.dump=FTagDocument_dump;return b}function FTagDocument_space(){return this._space}function FTagDocument_setSpace(b){this._space=b}
function FTagDocument_create(b){var f=this._space+"_",h=null,h=RString.startsWith(b,f)?b.substring(f.length):b;b=null;switch(h){case "source":b=RClass.create(FTag);break;case "write":b=RClass.create(FTagWrite);break;case "true":b=RClass.create(FTagTrue);break;case "false":b=RClass.create(FTagFalse);break;case "equals":b=RClass.create(FTagEquals);break;case "notEquals":b=RClass.create(FTagNotEquals);break;default:throw new TError(this,"Unknown tag type. (name={1})",h);}return b}
function FTagDocument_root(){return this._root}
function FTagDocument_loadNode(b,f){var h=this.create(f.nodeName);b?b.push(h):this._root=h;var q=f.attributes;if(q)for(var u=q.length,z=0;z<u;z++){var A=q[z];A.nodeName&&h.set(A.nodeName,RXml.formatText(A.value))}if(q=f.childNodes)for(u=q.length,z=0;z<u;z++)switch(A=q[z],A.nodeType){case ENodeType.Text:var B=RClass.create(FTagText);B.setText(A.nodeValue);h.push(B);break;case ENodeType.Data:B=RClass.create(FTagText);B.setText(A.data);h.push(B);break;case ENodeType.Node:this.loadNode(h,A)}}
function FTagDocument_load(b){b=("<source>"+b+"</source>").replace(new RegExp("<"+this._space+":","g"),"<"+this._space+"_");b=b.replace(new RegExp("</"+this._space+":","g"),"</"+this._space+"_");b=b.replace(RegExp(" & ","g")," &amp; ");b=b.replace(RegExp(" < ","g")," &lt; ");b=b.replace(RegExp(" > ","g")," &gt; ");b=RXml.makeString(b);this.loadNode(null,b.firstChild)}function FTagDocument_parse(b){b.resetSource();this._root.parse(b);return b.source()}
function FTagDocument_dump(){var b=new TString;b.appendLine(RClass.dump(this));b.appendLine(this.root().dump(b));return b.toString()}function FTagEquals(b){b=RClass.inherits(this,b,FTag);b._trimLeft=!0;b._source=null;b._value=null;b.onBegin=FTagEquals_onBegin;b.set=FTagEquals_set;b.toString=FTagEquals_toString;return b}
function FTagEquals_onBegin(b){var f=!1;b=b.get(this._source);for(var h=this._value.split("|"),q=h.length,u=0;u<q;u++)if(b==h[u]){f=!0;break}return f?EResult.Continue:EResult.Skip}function FTagEquals_set(b,f){switch(b){case "source":this._source=f;return;case "value":this._value=f;return}this.__base.FTag.set.call(this,b,f)}function FTagEquals_toString(){return"source="+this._source+", value="+this._value}
function FTagFalse(b){b=RClass.inherits(this,b,FTag);b._trimLeft=!0;b._source=null;b.onBegin=FTagFalse_onBegin;b.set=FTagFalse_set;b.toString=FTagFalse_toString;return b}function FTagFalse_onBegin(b){b=b.get(this._source);return RBoolean.parse(b)?EResult.Skip:EResult.Continue}function FTagFalse_set(b,f){switch(b){case "source":this._source=f;return}this.__base.FTag.set.call(this,b,f)}function FTagFalse_toString(){return"source="+this._source}
function FTagNotEquals(b){b=RClass.inherits(this,b,FTag);b._trimLeft=!0;b._source=null;b._value=null;b.onBegin=FTagNotEquals_onBegin;b.set=FTagNotEquals_set;b.toString=FTagNotEquals_toString;return b}function FTagNotEquals_onBegin(b){var f=!0;b=b.get(this._source);for(var h=this._value.split("|"),q=h.length,u=0;u<q;u++)if(b==h[u]){f=!1;break}return f?EResult.Continue:EResult.Skip}
function FTagNotEquals_set(b,f){switch(b){case "source":this._source=f;return;case "value":this._value=f;return}this.__base.FTag.set.call(this,b,f)}function FTagNotEquals_toString(){return"source="+this._source+", value="+this._value}function FTagText(b){b=RClass.inherits(this,b,FTag);b._text=null;b.onBegin=FTagText_onBegin;b.text=FTagText_text;b.setText=FTagText_setText;b.toString=FTagText_toString;return b}
function FTagText_onBegin(b){var f=this._text;b._trimLeft&&(RString.startsWith(f,"\r")&&(f=f.substring(1)),RString.startsWith(f,"\n")&&(f=f.substring(1)));b._trimRight&&(RString.endsWith(f,"\r")&&(f=f.substring(0,f.length-1)),RString.endsWith(f,"\n")&&(f=f.substring(0,f.length-1)));b.write(f);return EResult.Skip}function FTagText_text(){return this._text}function FTagText_setText(b){this._text=b}function FTagText_toString(){return"{"+this._text+"}"}
function FTagTrue(b){b=RClass.inherits(this,b,FTag);b._trimLeft=!0;b._source=null;b.onBegin=FTagTrue_onBegin;b.set=FTagTrue_set;b.toString=FTagTrue_toString;return b}function FTagTrue_onBegin(b){for(var f=!1,h=this._source.split("|"),q=h.length,u=0;u<q;u++){var z=b.get(h[u]);if(RBoolean.parse(z)){f=!0;break}}return f?EResult.Continue:EResult.Skip}function FTagTrue_set(b,f){switch(b){case "source":this._source=f;return}this.__base.FTag.set.call(this,b,f)}
function FTagTrue_toString(){return"source="+this._source}function FTagWrite(b){b=RClass.inherits(this,b,FTag);b._source=null;b.onBegin=FTagWrite_onBegin;b.set=FTagWrite_set;b.toString=FTagWrite_toString;return b}function FTagWrite_onBegin(b){var f=b.get(this._source);b.write(f);return EResult.Skip}function FTagWrite_set(b,f){switch(b){case "source":this._source=f;return}this.__base.FTag.set.call(this,b,f)}function FTagWrite_toString(){return"source="+this._source}
var EThreadStatus=new function(){this.Sleep=0;this.Active=1;this.Finish=2;return this};function SProcessEvent(){this.data=this.code=this.index=null;return this}function SXmlEvent(){this.callback=this.outputDocument=this.inputDocument=this.parameter=this.action=this.url=this.owner=null;this.process=SXmlEvent_process;this.dispose=SXmlEvent_dispose;return this}
function SXmlEvent_process(b){this.outputDocument=b.document;this.outputNode=b.root;this.owner?this.callback.call(this.owner,this):this.callback(this)}function SXmlEvent_dispose(){this.callback=this.outputDocument=this.inputDocument=this.parameter=this.action=this.url=this.owner=null}function FContent(b){b=RClass.inherits(this,b,FObject);b._name=null;b.name=FContent_name;return b}function FContent_name(){return this._name}
function FContentConsole(b){b=RClass.inherits(this,b,FConsole);b._scopeCd=EScope.Local;b.connections=null;b.onLoad=FContentConsole_onLoad;b.construct=FContentConsole_construct;b.alloc=FContentConsole_alloc;b.process=FContentConsole_process;b.send=FContentConsole_send;return b}function FContentConsole_construct(){this.connections=new TObjects}function FContentConsole_onLoad(){var b=this.event;b.document=this.document;b.process();this.document=this.event=null;this._statusFree=!0}
function FContentConsole_alloc(){for(var b=null,f=this.connections,h=f.count-1;0<=h;h--){var q=f.get(h);if(q._statusFree){b=q;break}}b||(b=RClass.create(FXmlConnection),f.push(b),b.onLoad=this.onLoad);b._statusFree=!1;return b}
function FContentConsole_process(b){var f=this.alloc();f.event=b;switch(b.code){case EXmlEvent.Send:f.send(b.url,b.document);break;case EXmlEvent.Receive:f.receive(b.url,b.document);break;case EXmlEvent.SyncSend:return f.syncSend(b.url,b.document);case EXmlEvent.SyncReceive:return f.syncReceive(b.url,b.document)}}function FContentConsole_send(b,f){var h=this.alloc(),q=h.syncSend(b,f);h._statusFree=!0;return q}
function FContentPipeline(b){b=RClass.inherits(this,b,FPipeline);b._scopeCd=EScope.Global;b.scopeCd=FContentPipeline_scopeCd;return b}function FContentPipeline_scopeCd(){return this._scopeCd}
function FDragConsole(b){b=RClass.inherits(this,b,FConsole);b._scopeCd=EScope.Local;b._activeDragable=null;b._dragables=null;b.onMouseDown=FDragConsole_onMouseDown;b.onMouseMove=FDragConsole_onMouseMove;b.onMouseUp=FDragConsole_onMouseUp;b.construct=FDragConsole_construct;b.register=FDragConsole_register;b.unregister=FDragConsole_unregister;b.clear=FDragConsole_clear;return b}
function FDragConsole_onMouseDown(b){var f=b.source;f&&RClass.isClass(f,MDragable)&&(RWindow.setOptionSelect(!1),this._activeDragable=f,f.onDragStart(b))}function FDragConsole_onMouseMove(b){if(this._activeDragable)this._activeDragable.onDragMove(b)}function FDragConsole_onMouseUp(b){this._activeDragable&&(RWindow.setOptionSelect(!0),this._activeDragable.onDragStop(b),this._activeDragable=null)}
function FDragConsole_construct(){this.__base.FConsole.construct.call(this);this._dragables=new TObjects;RWindow.lsnsMouseDown.register(this,this.onMouseDown);RWindow.lsnsMouseMove.register(this,this.onMouseMove);RWindow.lsnsMouseUp.register(this,this.onMouseUp)}function FDragConsole_register(b){this._dragables.push(b)}function FDragConsole_unregister(b,f){this._dragables.remove(p)}function FDragConsole_clear(){this._dragables.clear()}
function FEnvironmentConsole(b){b=RClass.inherits(this,b,FConsole);b.scope=EScope.Local;b.environment=null;b.connect=FEnvironmentConsole_connect;b.build=FEnvironmentConsole_build;b.buildValue=FEnvironmentConsole_buildValue;b.xml=FEnvironmentConsole_xml;return b}function FEnvironmentConsole_connect(){var b=RHtml.get("xEnvironment");b&&(this.environment=RXml.makeNode(b))}
function FEnvironmentConsole_build(b){this.environment||this.connect();this.environment&&b.create("Environment").attributes().append(this.environment.attributes())}function FEnvironmentConsole_buildValue(){this.environment||this.connect();if(this.environment){var b=RHtml.get("_environment");b&&(b.value=this.environment.xml())}}function FEnvironmentConsole_xml(){this.environment||this.connect();return this.environment?this.environment.xml():null}
function FEvent(b){b=RClass.inherits(this,b,FObject);b._owner=null;b._callback=null;b._valid=!0;b.owner=FEvent_owner;b.setOwner=FEvent_setOwner;b.callback=FEvent_callback;b.setCallback=FEvent_setCallback;b.valid=FEvent_valid;b.setValid=FEvent_setValid;b.process=FEvent_process;return b}function FEvent_owner(){return this._owner}function FEvent_setOwner(b){this._owner=b}function FEvent_callback(){return this._callback}function FEvent_setCallback(b){this._callback=b}
function FEvent_valid(){return this._valid}function FEvent_setValid(b){this._valid=b}function FEvent_process(){if(this._valid){var b=this._owner;b?this._callback.call(b,this):this._callback(this)}}
function FEventConsole(b){b=RClass.inherits(this,b,FConsole);b._scopeCd=EScope.Local;b._thread=null;b._interval=100;b._processEvents=null;b._events=null;b.onProcess=FEventConsole_onProcess;b.construct=FEventConsole_construct;b.register=FEventConsole_register;b.push=FEventConsole_push;b.clear=FEventConsole_clear;return b}
function FEventConsole_onProcess(){var b=this._events;if(!b.isEmpty()){var f=this._processEvents;f.assign(b);b.clear();b=f.count();if(0<b){for(var h=0;h<b;h++)f.get(h).process();f.clear()}}}
function FEventConsole_construct(){this.__base.FConsole.construct.call(this);this._processEvents=new TObjects;this._events=new TObjects;var b=this._thread=RClass.create(FThread);b.setInterval(this._interval);b.lsnsProcess.register(this,this.onProcess);RConsole.find(FThreadConsole).start(b);RLogger.debug(this,"Add event thread. (thread={1})",RClass.dump(b))}function FEventConsole_register(b,f){var h=RClass.create(FEvent);h.owner=b;h.callback=f;this._events.push(h)}
function FEventConsole_push(b){var f=this._events;f.contains(b)||f.push(b)}function FEventConsole_clear(){this._events.clear()}function FHttpConsole(b){b=RClass.inherits(this,b,FConsole);b._scopeCd=EScope.Local;b._pool=null;b.onLoad=FHttpConsole_onLoad;b.construct=FHttpConsole_construct;b.alloc=FHttpConsole_alloc;b.send=FHttpConsole_send;return b}function FHttpConsole_construct(){this.__base.FConsole.construct.call(this);this._pool=RClass.create(FObjectPool)}
function FHttpConsole_onLoad(b){this._pool.free(b)}function FHttpConsole_alloc(){var b=this._pool;if(!b.hasFree()){var f=RClass.create(FHttpConnection);f._asynchronous=!0;this._pool.push(f)}f=b.alloc();f.lsnsLoad.clear();f.lsnsLoad.register(this,this.onLoad);return f}function FHttpConsole_send(b){var f=this.alloc();f.send(b);return f}function FIdleConsole(b){b=RClass.inherits(this,b,FConsole);b.scope=EScope.Page;b.register=FIdleConsole_register;return b}
function FIdleConsole_register(b,f){this.active=new TActive(b,f);this.active.interval=100;RConsole.find(FActiveConsole).push(this.active)}function FIdleConsole_construct(){}function FLoggerConsole(b){b=RClass.inherits(this,b,FConsole);b.scope=EScope.Page;b.iLogger=null;b.onKeyDown=FLoggerConsole_onKeyDown;b.construct=FLoggerConsole_construct;b.connect=FLoggerConsole_connect;b.disconnect=FLoggerConsole_disconnect;b.output=FLoggerConsole_output;return b}
function FLoggerConsole_onKeyDown(b){b.shiftKey&&b.ctrlKey&&EKey.L==b.keyCode&&this.connect()}function FLoggerConsole_construct(){this.base.FConsole.construct.call(this);RWindow.lsnsKeyDown.register(this,this.onKeyDown)}function FLoggerConsole_connect(){}function FLoggerConsole_disconnect(){this.iLogger=null}
function FLoggerConsole_output(b,f,h,q,u,z){this.iLogger&&(f=RClass.dump(f),q&&(f+=" ("+q+"ms)"),b=b+" ["+RString.rpad(f,36)+"] ",b=z?b+(RString.rpad(u,120)+" ["+z+"]"):b+u,this.iLogger.Output(b))}function FLoggerConsole_xml(){this.environment||this.connect();return this.environment?this.environment.xml():null}
function FMonitorConsole(b){b=RClass.inherits(this,b,FConsole);b.scope=EScope.Global;b.working=!1;b.interval=10;b.intervalId=null;b.monitors=new TList;b.hWindow=null;b.doInterval=FMonitorConsole_doInterval;b.push=FMonitorConsole_push;b.process=FMonitorConsole_process;b.processAll=FMonitorConsole_processAll;b.startup=FMonitorConsole_startup;b.wait=FMonitorConsole_wait;b.release=FMonitorConsole_release;return b}
function FMonitorConsole_push(b){this.startup();b.id=this.monitors.sync(b);b.name="T:"+RString.lpad(b.id,4,"0");b.status=EMonitor.Active}function FMonitorConsole_process(b){if(b)switch(b.status){case EMonitor.Active:b.process(this.interval);break;case EMonitor.Cancel:this.monitors.removeItem(b)}}function FMonitorConsole_processAll(){this.working=!0;for(var b=this.monitors,f=0;f<b.count;f++)this.process(b.get(f));this.working=!1}
function FMonitorConsole_doInterval(){var b=RGlobal.get(FMonitorConsole);b&&!b.working&&b.processAll()}function FMonitorConsole_startup(){this.hWindow||(this.hWindow=window,this.intervalId=this.hWindow.setInterval(this.doInterval,this.interval))}function FMonitorConsole_wait(b){}function FMonitorConsole_release(){this.hWindow&&this.intervalId&&this.hWindow.clearInterval(this.intervalId)}
function FMouseConsole(b){b=RClass.inherits(this,b,FConsole);b._scopeCd=EScope.Local;b._activeCapture=null;b._captures=null;b.onMouseDown=FMouseConsole_onMouseDown;b.onMouseMove=FMouseConsole_onMouseMove;b.onMouseUp=FMouseConsole_onMouseUp;b.construct=FMouseConsole_construct;b.captureStart=FMouseConsole_captureStart;b.capture=FMouseConsole_capture;b.captureStop=FMouseConsole_captureStop;b.register=FMouseConsole_register;b.unregister=FMouseConsole_unregister;b.clear=FMouseConsole_clear;return b}
function FMouseConsole_onMouseDown(b){var f=RHtml.searchLinker(b.hSource,MMouseCapture);f&&f.testMouseCapture()&&(this._activeCapture=f,this.captureStart(b))}function FMouseConsole_onMouseMove(b){this._activeCapture&&this.capture(b)}function FMouseConsole_onMouseUp(b){this._activeCapture&&this.captureStop(b)}
function FMouseConsole_construct(){this.__base.FConsole.construct.call(this);this._captures=new TObjects;RWindow.lsnsMouseDown.register(this,this.onMouseDown);RWindow.lsnsMouseMove.register(this,this.onMouseMove);RWindow.lsnsMouseUp.register(this,this.onMouseUp)}function FMouseConsole_captureStart(b){var f=this._activeCapture;f&&(RWindow.setOptionSelect(!1),f.onMouseCaptureStart(b))}
function FMouseConsole_capture(b){var f=this._activeCapture;if(f)if(f.testMouseCapture())f.onMouseCapture(b);else this.captureStop(b)}function FMouseConsole_captureStop(b){var f=this._activeCapture;f&&(f.onMouseCaptureStop(b),this._activeCapture=null);RWindow.setOptionSelect(!0)}function FMouseConsole_register(b){this._captures.push(b)}function FMouseConsole_unregister(b){this._captures.remove(b)}function FMouseConsole_clear(){this._captures.clear()}
function FPipeline(b){b=RClass.inherits(this,b,FObject);b._name=null;b.name=FPipeline_name;return b}function FPipeline_name(){return this._name}function FProcess(b){b=RClass.inherits(this,b,FObject);b._name=null;b._source=null;b._worker=null;b._events=null;b.ohMessage=FProcess_ohMessage;b.onMessage=FProcess_onMessage;b.construct=FProcess_construct;b.name=FProcess_name;b.start=FProcess_start;b.process=FProcess_process;return b}function FProcess_ohMessage(){this.__linker.onMessage(this)}
function FProcess_onMessage(b){}function FProcess_name(){return this._name}function FProcess_construct(){this.__base.FObject.construct.call(this);this._events=new TObjects}function FProcess_start(b){if(this._worker)throw new TError(this,"Process is already start.");this._source=b;b=this._worker=new Worker(b);b.__linker=this;b.onmessage=this.ohMessage}
function FProcess_process(b){var f=this._events,h=f.count();f.push(b);f=new SProcessEvent;f.index=h;f.code=b.code();f.data=b.data();this._worker.postMessage(f)}function FProcessConsole(b){b=RClass.inherits(this,b,FConsole);b._scopeCd=EScope.Local;b.connections=null;b.onLoad=FProcessConsole_onLoad;b.construct=FProcessConsole_construct;b.alloc=FProcessConsole_alloc;b.process=FProcessConsole_process;b.send=FProcessConsole_send;return b}
function FProcessConsole_construct(){this.connections=new TObjects}function FProcessConsole_onLoad(){var b=this.event;b.document=this.document;b.process();this.document=this.event=null;this._statusFree=!0}function FProcessConsole_alloc(){for(var b=null,f=this.connections,h=f.count-1;0<=h;h--){var q=f.get(h);if(q._statusFree){b=q;break}}b||(b=RClass.create(FXmlConnection),f.push(b),b.onLoad=this.onLoad);b._statusFree=!1;return b}
function FProcessConsole_process(b){var f=this.alloc();f.event=b;switch(b.code){case EXmlEvent.Send:f.send(b.url,b.document);break;case EXmlEvent.Receive:f.receive(b.url,b.document);break;case EXmlEvent.SyncSend:return f.syncSend(b.url,b.document);case EXmlEvent.SyncReceive:return f.syncReceive(b.url,b.document)}}function FProcessConsole_send(b,f){var h=this.alloc(),q=h.syncSend(b,f);h._statusFree=!0;return q}
function FProcessEvent(b){b=RClass.inherits(this,b,FObject);b._code=null;b._data=null;b._listeners=null;b.code=FProcessEvent_code;b.setCode=FProcessEvent_setCode;b.data=FProcessEvent_data;b.setData=FProcessEvent_setData;b.register=FProcessEvent_register;return b}function FProcessEvent_name(){return this._name}function FProcessEvent_code(){return this._code}function FProcessEvent_setCode(b){this._code=b}function FProcessEvent_data(){return this._data}
function FProcessEvent_setData(b){this._data=b}function FProcessEvent_register(b,f){this._listeners||(this._listeners=new TListeners);this._listeners.register(b,f)}function FProcessor(b){b=RClass.inherits(this,b,FObject);b._name=null;b._source=null;b._worker=null;b._events=null;b.ohMessage=FProcessor_ohMessage;b.onMessage=FProcessor_onMessage;b.construct=FProcessor_construct;b.name=FProcessor_name;b.start=FProcessor_start;b.process=FProcessor_process;return b}
function FProcessor_ohMessage(){this.__linker.onMessage(this)}function FProcessor_onMessage(b){}function FProcessor_name(){return this._name}function FProcessor_construct(){this.__base.FObject.construct.call(this);this._events=new TObjects}function FProcessor_start(b){if(this._worker)throw new TError(this,"Process is already start.");this._source=b;b=this._worker=new Worker(b);b.__linker=this;b.onmessage=this.ohMessage}
function FProcessor_process(b){var f=this._events,h=f.count();f.push(b);f=new SProcessEvent;f.index=h;f.code=b.code();f.data=b.data();this._worker.postMessage(f)}
function FProcessServer(b){b=RClass.inherits(this,b,FObject);b._name=null;b._handle=null;b._processors=null;b.ohInterval=FProcessServer_ohInterval;b.onInterval=FProcessServer_onInterval;b.ohMessage=FProcessServer_ohMessage;b.onMessage=FProcessServer_onMessage;b.construct=FProcessServer_construct;b.name=FProcessServer_name;b.registerProcessor=FProcessServer_registerProcessor;b.unregisterProcessor=FProcessServer_unregisterProcessor;b.send=FProcessServer_send;b.process=FProcessServer_process;return b}
function FProcessServer_ohInterval(){FProcessServer.__linker.onInterval()}function FProcessServer_onInterval(){}function FProcessServer_ohMessage(b){FProcessServer.__linker.onMessage(b.data)}function FProcessServer_onMessage(b){console.log("messgae",this,b)}function FProcessServer_construct(){this.__base.FObject.construct.call(this);this._processors=new TDictionary}function FProcessServer_name(){return this._name}function FProcessServer_registerProcessor(b,f){this._processors.set(b,f)}
function FProcessServer_unregisterProcessor(b){this._processors.set(b,null)}function FProcessServer_send(b){postMessage(b)}function FProcessServer_process(){onmessage=this.ohMessage;FProcessServer.__linker=this}function FResource(b){b=RClass.inherits(this,b,FObject);b._guid=null;b._code=null;b._label=null;b.guid=FResource_guid;b.code=FResource_code;b.label=FResource_label;return b}function FResource_guid(){return this._guid}function FResource_code(){return this._code}
function FResource_label(){return this._label}function FResourceConsole(b){b=RClass.inherits(this,b,FConsole);b._scopeCd=EScope.Local;b._resources=null;b.onLoad=FResourceConsole_onLoad;b.construct=FResourceConsole_construct;b.alloc=FResourceConsole_alloc;b.process=FResourceConsole_process;b.send=FResourceConsole_send;return b}function FResourceConsole_construct(){this.connections=new TObjects}
function FResourceConsole_onLoad(){var b=this.event;b.document=this.document;b.process();this.document=this.event=null;this._statusFree=!0}function FResourceConsole_alloc(){for(var b=null,f=this.connections,h=f.count-1;0<=h;h--){var q=f.get(h);if(q._statusFree){b=q;break}}b||(b=RClass.create(FXmlConnection),f.push(b),b.onLoad=this.onLoad);b._statusFree=!1;return b}
function FResourceConsole_process(b){var f=this.alloc();f.event=b;switch(b.code){case EXmlEvent.Send:f.send(b.url,b.document);break;case EXmlEvent.Receive:f.receive(b.url,b.document);break;case EXmlEvent.SyncSend:return f.syncSend(b.url,b.document);case EXmlEvent.SyncReceive:return f.syncReceive(b.url,b.document)}}function FResourceConsole_send(b,f){var h=this.alloc(),q=h.syncSend(b,f);h._statusFree=!0;return q}
function FResourceGroup(b){b=RClass.inherits(this,b,FObject);b._name=null;b.name=FResourceGroup_name;return b}function FResourceGroup_name(){return this._name}function FResourceType(b){b=RClass.inherits(this,b,FObject);b._name=null;b._pipeline=null;b._resources=null;b.construct=FResourceType_construct;b.name=FResourceType_name;b.resource=FResourceType_resource;b.resources=FResourceType_resources;return b}
function FResourceType_construct(){this.__base.construct.call(this);this._resources=new TDictionary}function FResourceType_name(){return this._name}function FResourceType_resource(b){return this._resources.get(b)}function FResourceType_resources(){return this._resources}function FStatistics(b){b=RClass.inherits(this,b,FObject);b._code=null;b.reset=FStatistics_reset;b.resetFrame=FStatistics_resetFrame;return b}function FStatistics_reset(){}function FStatistics_resetFrame(){}
function FStatisticsConsole(b){b=RClass.inherits(this,b,FConsole);b._scopeCd=EScope.Local;b._statisticses=null;b.construct=FStatisticsConsole_construct;b.register=FStatisticsConsole_register;b.unregister=FStatisticsConsole_unregister;b.find=FStatisticsConsole_find;b.statisticses=FStatisticsConsole_statisticses;b.reset=FStatisticsConsole_reset;b.resetFrame=FStatisticsConsole_resetFrame;return b}function FStatisticsConsole_construct(){this._statisticses=new TDictionary}
function FStatisticsConsole_register(b,f){this._statisticses.set(b,f)}function FStatisticsConsole_unregister(b){return this._statisticses.remove(b)}function FStatisticsConsole_find(b){return this._statisticses.get(b)}function FStatisticsConsole_statisticses(){return this._statisticses}function FStatisticsConsole_reset(b){b=this._statisticses;for(var f=b.count()-1;0<=f;f--)b.getAt(f).reset()}
function FStatisticsConsole_resetFrame(b,f){for(var h=this._statisticses,q=h.count()-1;0<=q;q--)h.getAt(q).resetFrame()}function FThread(b){b=RClass.inherits(this,b,FObject,MListenerProcess);b._name=null;b._statusCd=EThreadStatus.Sleep;b._interval=100;b._delay=0;b.construct=FThread_construct;b.name=FThread_name;b.statusCd=FThread_statusCd;b.interval=FThread_interval;b.setInterval=FThread_setInterval;b.start=FThread_start;b.stop=FThread_stop;b.process=FThread_process;return b}
function FThread_construct(){this.__base.FObject.construct.call(this)}function FThread_name(){return this._name}function FThread_statusCd(){return this._statusCd}function FThread_interval(){return this._interval}function FThread_setInterval(b){this._interval=b}function FThread_start(){this._statusCd=EThreadStatus.Active}function FThread_stop(){this._statusCd=EThreadStatus.Finish}
function FThread_process(b){0>=this._delay?(this.processProcessListener(this),this._delay=this._interval):this._delay-=b}
function FThreadConsole(b){b=RClass.inherits(this,b,FConsole);b._scopeCd=EScope.Local;b._active=!0;b._interval=20;b._threads=null;b._hWindow=null;b._hIntervalId=null;b.ohInterval=FThreadConsole_ohInterval;b.construct=FThreadConsole_construct;b.push=FThreadConsole_push;b.start=FThreadConsole_start;b.process=FThreadConsole_process;b.processAll=FThreadConsole_processAll;b.dispose=FThreadConsole_dispose;return b}function FThreadConsole_ohInterval(){RConsole.get(FThreadConsole).processAll()}
function FThreadConsole_push(b){this._threads.push(b)}function FThreadConsole_start(b){b.start();this._threads.push(b)}function FThreadConsole_construct(){this.__base.FConsole.construct.call(this);this._threads=new TObjects;this._hWindow=window;this._hIntervalId=this._hWindow.setInterval(this.ohInterval,this._interval)}
function FThreadConsole_process(b){if(b)switch(b.statusCd()){case EThreadStatus.Active:b.process(this._interval);break;case EThreadStatus.Finish:b.dispose(),this._threads.remove(b)}}function FThreadConsole_processAll(){if(this._active)for(var b=this._threads,f=b.count(),h=0;h<f;h++){var q=b.get(h);this.process(q)}}function FThreadConsole_dispose(){var b=this._hWindow;if(b){var f=this._hIntervalId;f&&(b.clearInterval(f),this._hIntervalId=null);this._hWindow=null}}
function FXmlConsole(b){b=RClass.inherits(this,b,FConsole);b._scopeCd=EScope.Local;b.connections=null;b.onLoad=FXmlConsole_onLoad;b.construct=FXmlConsole_construct;b.alloc=FXmlConsole_alloc;b.send=FXmlConsole_send;b.sendAsync=FXmlConsole_sendAsync;b.process=FXmlConsole_process;return b}function FXmlConsole_construct(){this.connections=new TObjects}function FXmlConsole_onLoad(b){debugger}
function FXmlConsole_alloc(){for(var b=null,f=this.connections,h=f.count-1;0<=h;h--){var q=f.get(h);if(q._statusFree){b=q;break}}b||(b=RClass.create(FXmlConnection),f.push(b),b.onLoad=this.onLoad);b._statusFree=!1;return b}function FXmlConsole_send(b,f){var h=this.alloc();h._asynchronous=!1;var q=h.send(b,f);h._statusFree=!0;return q}function FXmlConsole_sendAsync(b,f,h){var q=this.alloc();q._asynchronous=!0;q._parameters=h;q.send(b,f);return q}
function FXmlConsole_process(b){if(b.constructor!=SXmlEvent)throw new TError("Parameter type is invalid.");var f=this.alloc();f._asynchronous=!0;f.send(b.url,b.inputDocument);f.lsnsLoad.register(b,b.process);return f}var RApplication=new function(){this._workspaces=new TDictionary;this.initialize=RApplication_initialize;this.findWorkspace=RApplication_findWorkspace;this.release=RApplication_release;return this};
function RApplication_initialize(){RBrowser.construct();RWindow.connect(window);RKeyboard.construct()}function RApplication_findWorkspace(b){var f=RClass.name(b),h=this._workspaces,q=h.get(f);null==q&&(q=RClass.create(b),h.set(f,q));return q}function RApplication_release(){try{CollectGarbage()}catch(b){RLogger.error(b)}}
var RBrowser=new function(){this._deviceCd=EDevice.Unknown;this._softwareCd=ESoftware.Unknown;this._typeCd=EBrowser.Unknown;this._supportHtml5=!1;this._contentPath=this._hostPath="";this.onLog=RBrowser_onLog;this.construct=RBrowser_construct;this.supportHtml5=RBrowser_supportHtml5;this.hostPath=RBrowser_hostPath;this.setHostPath=RBrowser_setHostPath;this.contentPath=RBrowser_contentPath;this.setContentPath=RBrowser_setContentPath;this.isBrowser=RBrowser_isBrowser;return this};
function RBrowser_onLog(b,f){console.log(f)}
function RBrowser_construct(){var b=window.navigator.userAgent.toLowerCase();-1!=b.indexOf("android")&&(this._typeCd=EDevice.Mobile,this._softwareCd=ESoftware.Android);if(-1!=b.indexOf("chrome"))this._typeCd=EBrowser.Chrome;else if(-1!=b.indexOf("firefox"))this._typeCd=EBrowser.FireFox;else if(-1!=b.indexOf("msie")||-1!=b.indexOf("windows"))this._typeCd=EBrowser.Explorer;else if(-1!=b.indexOf("safari")||-1!=b.indexOf("applewebkit"))this._typeCd=EBrowser.Safari;else{alert("Unknown browser.\n"+b);return}this._typeCd==
EBrowser.Chrome&&RLogger.lsnsOutput.register(this,this.onLog);window.applicationCache&&(this._supportHtml5=!0);RLogger.info(this,"Parse browser agent. (type_cd={1})",REnum.decode(EBrowser,this._typeCd))}function RBrowser_supportHtml5(){return this._supportHtml5}function RBrowser_hostPath(b){return b?this._hostPath+b:this._hostPath}function RBrowser_setHostPath(b){this._hostPath=b}function RBrowser_contentPath(b){return b?this._contentPath+b:this._contentPath}
function RBrowser_setContentPath(b){this._contentPath=b}function RBrowser_isBrowser(b){return this._typeCd==b}
var RBuilder=new function(){this.create=RBuilder_create;this.createIcon=RBuilder_createIcon;this.createImage=RBuilder_createImage;this.createText=RBuilder_createText;this.createCheck=RBuilder_createCheck;this.createRadio=RBuilder_createRadio;this.createEdit=RBuilder_createEdit;this.createSpan=RBuilder_createSpan;this.createDiv=RBuilder_createDiv;this.createTable=RBuilder_createTable;this.createTableRow=RBuilder_createTableRow;this.createTableCell=RBuilder_createTableCell;this.createFragment=RBuilder_createFragment;
this.append=RBuilder_append;this.appendIcon=RBuilder_appendIcon;this.appendImage=RBuilder_appendImage;this.appendEmpty=RBuilder_appendEmpty;this.appendText=RBuilder_appendText;this.appendCheck=RBuilder_appendCheck;this.appendRadio=RBuilder_appendRadio;this.appendEdit=RBuilder_appendEdit;this.appendSpan=RBuilder_appendSpan;this.appendDiv=RBuilder_appendDiv;this.appendTable=RBuilder_appendTable;this.appendTableRow=RBuilder_appendTableRow;this.appendTableRowCell=RBuilder_appendTableRowCell;this.appendTableCell=
RBuilder_appendTableCell;return this};function RBuilder_create(b,f,h){var q=null,q=b.ownerDocument?b.ownerDocument:b.hDocument?b.hDocument:b;b=q.createElement(f);h&&(b.className=h);return b}function RBuilder_createIcon(b,f,h,q,u){b=this.create(b,"IMG",RString.nvl(f,"Tag_Icon"));b.align="absmiddle";h&&(b.src=RResource.iconPath(h));q&&(b.style.width=q+"px");u&&(b.style.height=u+"px");return b}
function RBuilder_createImage(b,f,h,q,u){b=this.create(b,"IMG",h);h&&(b.src=RResource.imagePath(h));q&&(b.style.width=q);u&&(b.style.height=u);return b}function RBuilder_createText(b,f,h){b=this.create(b,"SPAN",f);h&&(b.innerHTML=h);return b}function RBuilder_createCheck(b,f){var h=this.create(b,"INPUT",f);h.type="checkbox";return h}function RBuilder_createRadio(b,f){var h=this.create(b,"INPUT",f);h.type="radio";return h}
function RBuilder_createEdit(b,f){var h=this.create(b,"INPUT",f);h.type="text";return h}function RBuilder_createSpan(b,f){return this.create(b,"SPAN",f)}function RBuilder_createDiv(b,f){return this.create(b,"DIV",f)}function RBuilder_createTable(b,f,h,q,u){b=this.create(b,"TABLE",f);h&&(b.border=RInteger.nvl(h));b.cellSpacing=RInteger.nvl(q);b.cellPadding=RInteger.nvl(u);return b}function RBuilder_createTableRow(b,f){return this.create(b,"TR",f)}
function RBuilder_createTableCell(b,f){return this.create(b,"TD",f)}function RBuilder_createFragment(b){return b.createDocumentFragment()}function RBuilder_append(b,f,h){f=RBuilder.create(b.ownerDocument,f,h);b?b.appendChild(f):this.hDocument.body.appendChild(f);return f}function RBuilder_appendIcon(b,f,h,q,u){f=this.createIcon(b.ownerDocument,f,h,q,u);b.appendChild(f);return f}function RBuilder_appendImage(b,f,h,q,u){f=this.createImage(b.ownerDocument,f,h,q,u);b.appendChild(f);return f}
function RBuilder_appendEmpty(b,f,h){f=this.createIcon(b.ownerDocument,null,"n",f,h);b.appendChild(f);return f}function RBuilder_appendText(b,f,h){f=this.createText(b.ownerDocument,f,h);b.appendChild(f);return f}function RBuilder_appendCheck(b,f){var h=this.createCheck(b.ownerDocument,f);b.appendChild(h);return h}function RBuilder_appendRadio(b,f){var h=this.createRadio(b.ownerDocument,f);b.appendChild(h);return h}
function RBuilder_appendEdit(b,f){var h=this.createEdit(b.ownerDocument,f);b.appendChild(h);return h}function RBuilder_appendSpan(b,f){var h=this.createSpan(b.ownerDocument,f);b.appendChild(h);return h}function RBuilder_appendDiv(b,f){var h=this.createDiv(b.ownerDocument,f);b.appendChild(h);return h}function RBuilder_appendTable(b,f,h,q,u){f=this.createTable(b.ownerDocument,f,h,q,u);b?b.appendChild(f):this.hDocument.body.appendChild(f);return f}
function RBuilder_appendTableRow(b,f,h,q){var u=null,u=null==h?RBrowser.isBrowser(EBrowser.Explorer)?b.insertRow():b.insertRow(-1):b.insertRow(h);f&&(u.className=f);q&&(u.height=q);return u}function RBuilder_appendTableRowCell(b,f,h,q){b=this.appendTableRow(b,null,null,h);return this.appendTableCell(b,f,null,q)}function RBuilder_appendTableCell(b,f,h,q){var u=null;null==h?(u=this.create(b,"TD",f),b.appendChild(u)):u=b.insertCell(h);f&&(u.className=f);q&&(u.width=q);return u}
var RContext=new function(){this.optionGarbage=!0;this._location=null;this._contexts={};this.languageId=this.themeId=this.contextTag=this.contextPath=null;this.construct=RContext_construct;this.initialize=RContext_initialize;this.get=RContext_get;this.find=RContext_find;this.location=RContext_location;this.context=RContext_context;this.construct();return this};function RContext_construct(){this.optionGarbage=window.ActiveXObject?!0:!1}
function RContext_location(b){var f=this._location;if(null==f){var f=window.location,h=f.href,f=h.substring(0,h.indexOf(f.pathname));this.contextPath&&(f+=this.contextPath);this._location=f}b&&(f+=b);return f}function RContext_context(b){return null!=b?RString.endsWith(b,".wv")?this.contextPath+"/"+b:RString.startsWith(b,"#")?this.contextPath+this.contextTag+b.substr(1):this.contextPath+b:this.contextPath}
function RContext_initialize(b){for(var f in b){var h=b[f],q;for(q in h)this._contexts[f+":"+q]=new TContext(f,q,h[q])}}function RContext_get(b,f,h,q,u,z){var A=this._contexts[b];return A?RString.format(A.text,f,h,q,u,z):RLogger.fatal(this,null,"Can not find context (path={1})",b)}function RContext_find(b,f){var h=b+":"+f,q=this._contexts[h];return q?q.text:RLogger.fatal(this,null,"Can not find context (id={1})",h)}
var RValue=new function(){this.matrix=this.rectangle=this.vector3=this.double64=this.double16=this.double16=this.double4=this.double3=this.double2=this.double1=this.float16=this.float12=this.float9=this.float4=this.float3=this.float2=this.float1=null;this.construct=RValue_construct;this.construct();return this};
function RValue_construct(){RBrowser.supportHtml5()&&(this.float1=new Float32Array(1),this.float2=new Float32Array(2),this.float3=new Float32Array(3),this.float4=new Float32Array(4),this.float9=new Float32Array(9),this.float12=new Float32Array(12),this.float16=new Float32Array(16),this.double1=new Float64Array(1),this.double2=new Float64Array(2),this.double3=new Float64Array(3),this.double4=new Float64Array(4),this.double9=new Float64Array(9),this.double12=new Float64Array(12),this.double16=new Float64Array(16));
this.vector3=new SVector3;this.rectangle=new SRectangle;this.matrix=new SMatrix3d}
var RWindow=new function(){this._optionSelect=!0;this._mouseEvent=new SMouseEvent;this._keyEvent=new SKeyboardEvent;this._resizeEvent=new SResizeEvent;this._orientationEvent=new SEvent;this._hContainer=this._hDocument=this._hWindow=null;this.lsnsLoad=new TListeners;this.lsnsUnload=new TListeners;this.lsnsMouseDown=new TListeners;this.lsnsMouseUp=new TListeners;this.lsnsMouseOver=new TListeners;this.lsnsMouseMove=new TListeners;this.lsnsMouseWheel=new TListeners;this.lsnsKeyDown=new TListeners;this.lsnsKeyUp=
new TListeners;this.lsnsKeyPress=new TListeners;this.lsnsResize=new TListeners;this.lsnsOrientation=new TListeners;this.ohMouseDown=RWindow_ohMouseDown;this.ohMouseMove=RWindow_ohMouseMove;this.ohMouseUp=RWindow_ohMouseUp;this.ohKeyDown=RWindow_ohKeyDown;this.ohKeyUp=RWindow_ohKeyUp;this.ohKeyPress=RWindow_ohKeyPress;this.ohResize=RWindow_ohResize;this.ohSelect=RWindow_ohSelect;this.ohOrientation=RWindow_ohOrientation;this.connect=RWindow_connect;this.optionSelect=RWindow_optionSelect;this.setOptionSelect=
RWindow_setOptionSelect;this.setCaption=RWindow_setCaption;this.setStatus=RWindow_setStatus;this._builder=null;this._disableDeep=0;this.panels=new TMap;this.inSizing=this.inMoving=this.inDisable=!1;this.hShadow=this.hDisablePanel=null;this.onUnload=RWindow_onUnload;this.onResize=RWindow_onResize;this.createElement=RWindow_createElement;this.event=RWindow_event;this.source=RWindow_source;this.getElement=RWindow_getElement;this.getDisablePanel=RWindow_getDisablePanel;this.findElement=RWindow_findElement;
this.panel=RWindow_panel;this.screenPos=RWindow_screenPos;this.clientPos=RWindow_clientPos;this.offsetPos=RWindow_offsetPos;this.windowEnable=RWindow_windowEnable;this.windowDisable=RWindow_windowDisable;this.enable=RWindow_enable;this.disable=RWindow_disable;this.setEnable=RWindow_setEnable;this.showShadow=RWindow_showShadow;this.moveCenter=RWindow_moveCenter;this.appendControl=RWindow_appendControl;this.appendElement=RWindow_appendElement;this.appendContainer=RWindow_appendContainer;this.containerTop=
RWindow_containerTop;this.dispose=RWindow_dispose;return this};function RWindow_ohMouseDown(b){var f=RWindow;b||(b=f._hWindow.event);var h=f._mouseEvent;h.attachEvent(b);f.lsnsMouseDown.process(h)}function RWindow_ohMouseMove(b){var f=RWindow;b||(b=f._hWindow.event);var h=f._mouseEvent;h.attachEvent(b);f.lsnsMouseMove.process(h)}function RWindow_ohMouseUp(b){var f=RWindow;b||(b=f._hWindow.event);var h=f._mouseEvent;h.attachEvent(b);f.lsnsMouseUp.process(h)}
function RWindow_ohKeyDown(b){var f=RWindow;b||(b=f._hWindow.event);var h=f._keyEvent;h.attachEvent(b);f.lsnsKeyDown.process(h)}function RWindow_ohKeyUp(b){var f=RWindow;b||(b=f._hWindow.event);var h=f._keyEvent;h.attachEvent(b);f.lsnsKeyUp.process(h)}function RWindow_ohKeyPress(b){var f=RWindow;b||(b=f._hWindow.event);var h=f._keyEvent;h.attachEvent(b);f.lsnsKeyPress.process(h)}
function RWindow_ohResize(b){var f=RWindow;b||(b=f._hWindow.event);var h=f._resizeEvent;h.attachEvent(b);f.lsnsResize.process(h)}function RWindow_ohSelect(b){return RWindow._optionSelect}
function RWindow_ohOrientation(b){b=RWindow;var f=b._orientationEvent;if(180==window.orientation||0==window.orientation)f.orientationCd=EOrientation.Vertical;else if(90==window.orientation||-90==window.orientation)f.orientationCd=EOrientation.Horizontal;else throw new TError(b,"Unknown orientation mode.");b.lsnsOrientation.process(f)}
function RWindow_connect(b){b=this._hWindow=b;var f=this._hContainer=(this._hDocument=b.document).body;RBrowser.supportHtml5()?(f.addEventListener("mousedown",this.ohMouseDown,!0),f.addEventListener("mousemove",this.ohMouseMove,!0),f.addEventListener("mouseup",this.ohMouseUp,!0),f.addEventListener("keydown",this.ohKeyDown,!0),f.addEventListener("keyup",this.ohKeyUp,!0),f.addEventListener("keypress",this.ohKeyPress,!0),b.addEventListener("orientationchange",this.ohOrientation)):(f.onmousedown=this.ohMouseDown,
f.onmousemove=this.ohMouseMove,f.onmouseup=this.ohMouseUp,f.onkeydown=this.ohKeyDown,f.onkeyup=this.ohKeyUp,f.onkeypress=this.ohKeyPress);f.onselectstart=this.ohSelect}function RWindow_optionSelect(){return this._optionSelect}function RWindow_setOptionSelect(b){this._optionSelect=b;RBrowser.isBrowser(EBrowser.FireFox)&&(this._hContainer.style.MozUserSelect=b?"":"none")}function RWindow_setCaption(b){top.document.title=b}function RWindow_setStatus(b){window.status=RString.nvl(b)}
function RWindow_onUnload(){RMemory.release()}function RWindow_onResize(){var b=this.hDisablePanel;if(b&&"block"==b.style.display){var b=b.style,f=this.hDocument;b.pixelLeft=0;b.pixelTop=0;b.pixelWidth=f.all?this.hBody.scrollWidth:f.documentElement.scrollWidth;b.pixelHeight=f.all?this.hBody.scrollHeight:f.documentElement.scrollHeight}}
function RWindow_connect2(b){var f=this;f.hWindow=b;var h=f.hDocument=b.document,h=f.hBody=f.hContainer=h.body;f.processUnload=h.onunload;h.onunload=function(h){h||(h=b.event);f.lsnsUnload.process(h);f.onUnload()};h.onmouseover=function(h){h||(h=b.event);f.lsnsMouseOver.process(h)};h.onmousewheel=function(h){h||(h=b.event);f.lsnsMouseWheel.process(h)};h.onkeydown=function(h){h||(h=b.event);RLogger.debug(f,"Window key down. (key_code={1})",h.keyCode);var u=h.srcElement?h.srcElement:h.target,z=u.tagName;
if(EKeyCode.BackSpace==h.keyCode)if("INPUT"==z){if(u.readOnly||"checkbox"==u.type)return RKey.eventClear(h)}else if("TEXTAREA"==z){if(u.readOnly)return RKey.eventClear(h)}else return RKey.eventClear(h);f.__keyDownEvent.attach(h);f.lsnsKeyDown.process(f.__keyDownEvent);EKeyCode.Enter==h.keyCode&&"INPUT"==z&&REvent.process(u,h)&&RKey.eventClear(h)};h.onkeyup=function(h){h||(h=b.event);f.lsnsKeyUp.process(h)};h.onkeypress=function(h){h||(h=b.event);RLogger.debug(f,"Window key press. (key_code={1})",
h.keyCode);f.lsnsKeyPress.process(h)};h.onresize=function(h){h||(h=b.event);if(f.oldBodyWidth!=f.hBody.offsetWidth||f.oldBodyHeight!=f.hBody.offsetHeight)f.oldBodyWidth=f.hBody.offsetWidth,f.oldBodyHeight=f.hBody.offsetHeight,f.onResize(),f.lsnsResize.process(h)}}function RWindow_createElement(b){return this.hDocument.createElement(b)}function RWindow_event(){return this.hWindow.event}function RWindow_source(b){return b?b.ownerDocument.parentWindow.event.srcElement:this.hWindow.event.srcElement}
function RWindow_getElement(b){var f=this.hDocument.getElementById(b);f||RMessage.fatal(this,null,"Can't get html element. (name={0})",b);return f}
function RWindow_getDisablePanel(b){var f=this.hDisablePanel;f||(f=this.hDisablePanel=this.builder().newDiv(),f.style.backgroundColor="#CCCCCC",f.style.position="absolute",f.style.filter="progid:DXImageTransform.Microsoft.Alpha(opacity=60)",this.hBody.appendChild(f),f.style.zIndex=8E3,f.style.display="none");var h=this.hImg;h||(h=this.hImg=this.builder().appendImage(f),h.src=top.RContext.context("/ats/00/rs/icon/ctl/RWindow_Loading.gif"),h.style.margin=document.body.offsetHeight/2,h.style.display=
"none");h.style.display=b?"none":"block";return f}function RWindow_findElement(b){return this.hDocument.getElementById(b)}function RWindow_panel(b){if(EPanel.Disable==b){b=this.hDisablePanel;if(!b){b=this.hDisablePanel=RBuilder.append(this.hBody,"DIV","RWindow_Disable");var f=RBuilder.append(b,"IMG");f.src=RRes.iconPath("#ctl.RWindow_Loading");f.style.margin=document.body.offsetHeight/2;b.style.zIndex=ELayer.Disable}return b}}
function RWindow_screenPos(b){var f=this.hWindow.event;return b?(b.x=f.screenX,b.y=f.screenY,b):new TPoint(f.screenX,f.screenY)}function RWindow_clientPos(b){var f=this.hWindow.event;return b?(b.x=f.clientX,b.y=f.clientY,b):new TPoint(f.clientX,f.clientY)}function RWindow_offsetPos(b){var f=this.hWindow.event;return b?(b.x=f.offsetX,b.y=f.offsetY,b):new TPoint(f.offsetX,f.offsetY)}function RWindow_windowDisable(){this.hWindow.document.body.disabled=!0}
function RWindow_windowEnable(){this.hWindow.document.body.disabled=!1}function RWindow_enable(){this._disableDeep--;0==this._disableDeep&&this.setEnable(!0)}function RWindow_disable(){0==this._disableDeep&&this.setEnable(!1);this._disableDeep++}
function RWindow_setEnable(b,f){var h=this.getDisablePanel(f).style;b?(this.windowEnable(),h.display="none"):(h=this.hDisablePanel.style,h.pixelLeft=0,h.pixelTop=0,h.pixelWidth=this.hDocument.all?this.hBody.scrollWidth:this.hDocument.documentElement.scrollWidth,h.pixelHeight=this.hDocument.all?this.hBody.scrollHeight:this.hDocument.documentElement.scrollHeight,h.display="block")}
function RWindow_showShadow(b,f){this.hShadow||(this.hShadow=RBuilder.append(this.hBody,"DIV","RWindow_Shadow"),this.hShadow.style.zIndex=ELayer.Shadow);var h=this.hShadow.style;0==b?h.display="none":(h.display="block",h.pixelLeft=f.left+3,h.pixelTop=f.top+3,h.pixelWidth=f.width(),h.pixelHeight=f.height())}
function RWindow_moveCenter(b){b&&(b.style.pixelLeft=Math.max(parseInt((this.hBody.offsetWidth-b.offsetWidth)/2),0),b.style.pixelTop=Math.max(parseInt((this.hBody.offsetHeight-b.offsetHeight)/2),0)+this.hBody.scrollTop)}function RWindow_appendControl(b){this.hBody.appendChild(b.hPanel)}function RWindow_appendElement(b){this.hBody.appendChild(b)}function RWindow_appendContainer(b){this.hContainer.appendChild(b)}
function RWindow_containerTop(b){var f=this.hContainer;b=RHtml.top(b)+b.offsetHeight;"auto"==f.currentStyle.overflow&&(b-=RHtml.top(f));return b-f.scrollTop}
function RWindow_dispose(){this.hBody.onload=null;this.hBody.onunload=null;this.hBody.onmousedown=null;this.hBody.onmouseup=null;this.hBody.onmousemove=null;this.hBody.onmouseover=null;this.hBody.onmousewheel=null;this.hBody.onkeydown=null;this.hBody.onkeyup=null;this.hBody.onkeypress=null;this.hBody.onresize=null;RMemory.freeHtml(this.hBody);this.panels.release();this.hShadow=this.hImg=this.hDisablePanel=this.hBody=this.hDocument=this.hWindow=this.panels=null}
var RXml=new function(){this.httpActiveX=!1;this.httpVendor=null;this.domActiveX=!1;this.domVendor=null;this.construct=RXml_construct;this.isNode=RXml_isNode;this.createConnection=RXml_createConnection;this.createDocument=RXml_createDocument;this.formatText=RXml_formatText;this.buildText=RXml_buildText;this.buildNode=RXml_buildNode;this.makeString=RXml_makeString;this.makeNode=RXml_makeNode;this.makeDocument=RXml_makeDocument;this.unpack=RXml_unpack;this.construct();return this};
function RXml_construct(){var b=window.document;if(window.ActiveXObject&&!window.XMLHttpRequest)for(var f=["MSXml2.XmlHTTP","Microsoft.XmlHTTP","MSXml.XmlHTTP","MSXml3.XmlHTTP"],h=f.length,q=0;q<h;q++){var u=f[q];try{new ActiveXObject(u);this.httpActiveX=!0;this.httpVendor=u;break}catch(z){m=z}}else if(window.XMLHttpRequest)try{this.httpActiveX=!1}catch(A){m=A}else alert("Unknown http vendor.");if(window.ActiveXObject||!window.DOMParser)for(f=["MSXml2.DOMDocument","Microsoft.XmlDOM","MSXml.DOMDocument",
"MSXml3.XmlDOM"],h=f.length,q=0;q<h;q++){u=f[q];try{new ActiveXObject(u);this.domActiveX=!0;this.domVendor=u;break}catch(B){m=B}}else if(window.DOMParser&&b&&b.implementation&&b.implementation.createDocument)try{document.implementation.createDocument("","",null),this.domActiveX=!1}catch(C){m=C}else alert("Unknown dom vendor.")}function RXml_isNode(b){return RClass.isName(b,"TNode")}
function RXml_createConnection(){var b=null;(b=this.httpActiveX?new ActiveXObject(this.httpVendor):new XMLHttpRequest)||alert("Create xml connection failure. (message="+m+")");return b}function RXml_createDocument(){var b=null;(b=this.domActiveX?new ActiveXObject(this.domVendor):document.implementation.createDocument("","",null))||alert("Create xml document failure. (message="+m+")");return b}function RXml_formatText(b){null!=b&&(b=b.replace(/\\n/g,"\n"));return b}
function RXml_buildText(b,f){if(null!=f){f=f.toString();for(var h=f.length,q=0;q<h;q++){var u=f.charAt(q);switch(u){case "<":b.append("&lt;");break;case ">":b.append("&gt;");break;case '"':b.append("&quot;");break;case "&":b.append("&amp;");break;case "\r":continue;case "\n":b.append("\\n");break;default:b.append(u)}}}return b}
function RXml_buildNode(b,f,h){var q=null,u=h.attributes;if(u){var z=u.length;if(0<z)for(var q=new TAttributes,A=0;A<z;A++){var B=u[A];B.nodeName&&q.set(B.nodeName,RXml.formatText(B.value))}}z=new TString;z.append(h.value);if(u=h.childNodes)for(B=u.length,A=0;A<B;A++){var C=u[A],D=C.nodeType;D==ENodeType.Text?z.append(C.nodeValue):D==ENodeType.Data&&z.append(C.data)}h=b.create(h.nodeName,q,RString.trim(z.toString()));f?f.push(h):b._root=h;if(u)for(f=u.length,A=0;A<f;A++)u[A].nodeType==ENodeType.Node&&
this.buildNode(b,h,u[A])}function RXml_makeString(b){var f=null;this.domActiveX?(f=new ActiveXObject(this.domVendor),f.async=!1,f.loadXML(b)):f=(new DOMParser).parseFromString(b,"text/xml");return f}function RXml_makeNode(b){if(b.documentElement){var f=new TXmlDocument;this.buildNode(f,null,b.documentElement);return f.root()}if("SCRIPT"==b.tagName){var h=b.textContent;h||(h=b.text);if(h)return f=new TXmlDocument,b=this.makeString(h),this.buildNode(f,null,b.documentElement),f.root()}return null}
function RXml_makeDocument(b){var f=new TXmlDocument;b.documentElement&&RXml.buildNode(f,null,b.documentElement);return f}function RXml_unpack(b,f){if(RString.isEmpty(b))return null;f||(f=new TNode);var h=new TAttributes;h.unpack(b);f.name=h.get("name");f.value=h.get("value");h.contains("attributes")&&f.attributes().unpack(h.get("attributes"));if(h.contains("nodes")){var q=new TStrings;q.unpack(h.get("nodes"));for(h=0;h<q.count;h++)this.unpack(q.get(h),f.create())}return f}
function MGraphicObject(b){b=RClass.inherits(this,b);b._graphicContext=null;b.graphicContext=MGraphicObject_graphicContext;b.linkGraphicContext=MGraphicObject_linkGraphicContext;b.dispose=MGraphicObject_dispose;return b}function MGraphicObject_graphicContext(){return this._graphicContext}
function MGraphicObject_linkGraphicContext(b){if(RClass.isClass(b,FGraphicContext))this._graphicContext=b;else if(RClass.isClass(b,MGraphicObject))this._graphicContext=b._graphicContext;else throw new TError(this,"Link graphic context failure. (context={1})",b);}function MGraphicObject_dispose(){this._graphicContext=null}function MGraphicRenderable(b){b=RClass.inherits(this,b,FObject);b.process=MGraphicRenderable_process;return b}function MGraphicRenderable_process(){}
function FFloatStream(b){b=RClass.inherits(this,b,FObject);b._length=0;b._memory=null;b._position=0;b.construct=FFloatStream_construct;b.length=FFloatStream_length;b.setLength=FFloatStream_setLength;b.memory=FFloatStream_memory;b.writeFloat4=FFloatStream_writeFloat4;b.writeColor4=FFloatStream_writeColor4;b.reset=FFloatStream_reset;b.clear=FFloatStream_clear;b.dispose=FFloatStream_dispose;return b}function FFloatStream_construct(){this.__base.FObject.construct.call(this)}
function FFloatStream_length(){return this._length}function FFloatStream_setLength(b){this._length=b;this._memory=new Float32Array(b)}function FFloatStream_memory(){return this._memory}function FFloatStream_writeFloat4(b,f,h,q){this._memory[this._position++]=b;this._memory[this._position++]=f;this._memory[this._position++]=h;this._memory[this._position++]=q}function FFloatStream_writeColor4(b){this.writeFloat4(b.red,b.green,b.blue,b.alpha)}function FFloatStream_reset(){this._position=0}
function FFloatStream_clear(){this._position=0}function FFloatStream_dispose(){this._memory=null;this.__base.FObject.dispose.call(this)}function FGraphicContext(b){b=RClass.inherits(this,b,FObject);b._hCanvas=null;b.construct=FGraphicContext_construct;b.linkCanvas=RMethod.virtual(b,"linkCanvas");b.dispose=FGraphicContext_dispose;return b}function FGraphicContext_construct(){this.__base.FObject.construct.call(this)}
function FGraphicContext_dispose(){this._hCanvas=null;this.__base.FObject.dispose.call(this)}function FG2dContext(b){b=RClass.inherits(this,b,FGraphicContext);b._native=null;b.construct=FG2dContext_construct;b.linkCanvas=FG2dContext_linkCanvas;b.drawLine=FG2dContext_drawLine;b.drawRecrangle=FG2dContext_drawRecrangle;b.drawText=FG2dContext_drawText;b.drawImage=FG2dContext_drawImage;b.fillRecrangle=FG2dContext_fillRecrangle;b.dispose=FG2dContext_dispose;return b}
function FG2dContext_construct(){this.__base.FGraphicContext.construct.call(this)}function FG2dContext_linkCanvas(b){this._hCanvas=b;this._native=b.getContext("2d")}function FG2dContext_drawLine(b,f,h,q){var u=this._native;u.moveTo(b,f);u.lineTo(h,q);u.stroke()}function FG2dContext_drawRecrangle(b,f,h,q){var u=this._native;u.moveTo(b,f);u.lineTo(h,f);u.lineTo(h,q);u.lineTo(b,q);u.lineTo(b,f);u.stroke()}function FG2dContext_drawText(b,f,h){this._native.fillText(h,b,f)}
function FG2dContext_drawImage(){}function FG2dContext_fillRecrangle(b,f,h,q){var u=this._native;u.beginPath();u.moveTo(b,f);u.lineTo(h,f);u.lineTo(h,q);u.lineTo(b,q);u.lineTo(b,f);u.closePath();u.fill()}function FG2dContext_dispose(){this._native=null;this.__base.FGraphicContext.dispose.call(this)}
var EG3dMaterialMap=new function(){this.AmbientColor=0;this.DiffuseColor=1;this.SpecularColor=2;this.ReflectColor=3;this.EmissiveColor=4;this.Count=8;return this},EG3dRegionParameter=new function(){this.Unknown=0;this.CameraPosition=1;this.CameraDirection=2;this.CameraViewMatrix=3;this.CameraProjectionMatrix=4;this.CameraViewProjectionMatrix=5;this.LightPosition=6;this.LightDirection=7;this.LightViewMatrix=8;this.LightProjectionMatrix=9;this.LightViewProjectionMatrix=10;this.LightInfo=11;return this},
EG3dTechniqueMode=new function(){this.Color="color";this.Ambient="ambient";this.DiffuseLevel="diffuse.level";this.DiffuseColor="diffuse.color";this.SpecularLevel="specular.level";this.SpecularColor="specular.color";this.Reflect="reflect";this.Emissive="emissive";this.Result="result";return this};
function MG3dRegion(b){b=RClass.inherits(this,b);b._changed=!1;b._spaceName=null;b._technique=null;b._techniquePass=null;b._camera=null;b._projection=null;b._directionalLight=null;b._lights=null;b._allRenderables=null;b._renderables=null;b._cameraPosition=null;b._cameraDirection=null;b._cameraViewMatrix=null;b._cameraProjectionMatrix=null;b._cameraViewProjectionMatrix=null;b._lightPosition=null;b._lightDirection=null;b._lightViewMatrix=null;b._lightProjectionMatrix=null;b._lightViewProjectionMatrix=
null;b._lightInfo=null;b._materialMap=null;b.construct=MG3dRegion_construct;b.isChanged=MG3dRegion_isChanged;b.spaceName=MG3dRegion_spaceName;b.technique=MG3dRegion_technique;b.setTechnique=MG3dRegion_setTechnique;b.techniquePass=MG3dRegion_techniquePass;b.setTechniquePass=MG3dRegion_setTechniquePass;b.camera=MG3dRegion_camera;b.directionalLight=MG3dRegion_directionalLight;b.lights=MG3dRegion_lights;b.materialMap=MG3dRegion_materialMap;b.allRenderables=MG3dRegion_allRenderables;b.renderables=MG3dRegion_renderables;
b.pushRenderable=MG3dRegion_pushRenderable;b.setup=MG3dRegion_setup;b.change=MG3dRegion_change;b.prepare=MG3dRegion_prepare;b.reset=MG3dRegion_reset;b.calculate=MG3dRegion_calculate;b.update=MG3dRegion_update;b.dispose=MG3dRegion_dispose;return b}
function MG3dRegion_construct(){this._lights=new TObjects;this._renderables=new TObjects;this._allRenderables=new TObjects;this._cameraPosition=new SPoint3;this._cameraDirection=new SVector3;this._cameraViewMatrix=new SMatrix3d;this._cameraProjectionMatrix=new SMatrix3d;this._cameraViewProjectionMatrix=new SMatrix3d;this._lightPosition=new SPoint3;this._lightDirection=new SVector3;this._lightViewMatrix=new SMatrix3d;this._lightProjectionMatrix=new SMatrix3d;this._lightViewProjectionMatrix=new SMatrix3d;
this._lightInfo=new SVector4}function MG3dRegion_isChanged(){return this._changed}function MG3dRegion_spaceName(){return this._spaceName}function MG3dRegion_technique(){return this._technique}function MG3dRegion_setTechnique(b){this._technique=b}function MG3dRegion_techniquePass(){return this._techniquePass}function MG3dRegion_setTechniquePass(b,f){this._techniquePass=b;this._spaceName=b.fullCode();this._finish=f}function MG3dRegion_camera(){return this._camera}
function MG3dRegion_directionalLight(){return this._directionalLight}function MG3dRegion_lights(){return this._lights}function MG3dRegion_materialMap(){return this._materialMap}function MG3dRegion_allRenderables(b){return this._allRenderables}function MG3dRegion_renderables(b){return this._renderables}function MG3dRegion_pushRenderable(b){this._renderables.push(b);this._allRenderables.push(b)}function MG3dRegion_setup(){}function MG3dRegion_change(){this._changed=!0}
function MG3dRegion_prepare(){this._changed=!1;var b=this._camera,f=b.projection();this._cameraPosition.assign(b.position());this._cameraDirection.assign(b.direction());this._cameraViewMatrix.assign(b.matrix());this._cameraProjectionMatrix.assign(f.matrix());this._cameraViewProjectionMatrix.assign(b.matrix());this._cameraViewProjectionMatrix.append(f.matrix());b=this._directionalLight.camera();b.position();f=b.projection();this._lightPosition.assign(b.position());this._lightDirection.assign(b.direction());
this._lightViewMatrix.assign(b.matrix());this._lightProjectionMatrix.assign(f.matrix());this._lightViewProjectionMatrix.assign(b.matrix());this._lightViewProjectionMatrix.append(f.matrix());this._lightInfo.set(0,0,f._znear,1/f.distance());this._allRenderables.clear()}function MG3dRegion_reset(){this._renderables.clear()}
function MG3dRegion_calculate(b){switch(b){case EG3dRegionParameter.CameraPosition:return this._cameraPosition;case EG3dRegionParameter.CameraDirection:return this._cameraDirection;case EG3dRegionParameter.CameraViewMatrix:return this._cameraViewMatrix;case EG3dRegionParameter.CameraProjectionMatrix:return this._cameraProjectionMatrix;case EG3dRegionParameter.CameraViewProjectionMatrix:return this._cameraViewProjectionMatrix;case EG3dRegionParameter.LightPosition:return this._lightPosition;case EG3dRegionParameter.LightDirection:return this._lightDirection;
case EG3dRegionParameter.LightViewMatrix:return this._lightViewMatrix;case EG3dRegionParameter.LightProjectionMatrix:return this._lightProjectionMatrix;case EG3dRegionParameter.LightViewProjectionMatrix:return this._lightViewProjectionMatrix;case EG3dRegionParameter.LightInfo:return this._lightInfo}throw new TError(this,"Unknown parameter type. (type_cd={1})",b);}function MG3dRegion_update(){for(var b=this._renderables,f=b.count(),h=0;h<f;h++)b.getAt(h).update(this)}
function MG3dRegion_dispose(){this._renderables=RObject.free(this._renderables);this._allRenderables=RObject.free(this._allRenderables)}
function MG3dRenderable(b){b=RClass.inherits(this,b,MGraphicRenderable);b._optionMerge=!1;b._currentMatrix=null;b._matrix=null;b._materialName=null;b._material=null;b._activeInfo=null;b._infos=null;b.construct=MG3dRenderable_construct;b.currentMatrix=MG3dRenderable_currentMatrix;b.matrix=MG3dRenderable_matrix;b.material=MG3dRenderable_material;b.activeEffect=MG3dRenderable_activeEffect;b.activeInfo=MG3dRenderable_activeInfo;b.effectFind=MG3dRenderable_effectFind;b.effectSet=MG3dRenderable_effectSet;
b.infos=MG3dRenderable_infos;b.selectInfo=MG3dRenderable_selectInfo;b.resetInfos=MG3dRenderable_resetInfos;b.testVisible=RMethod.virtual(b,"testVisible");b.update=MG3dRenderable_update;b.dispose=MG3dRenderable_dispose;return b}function MG3dRenderable_construct(){this._currentMatrix=new SMatrix3d;this._matrix=new SMatrix3d;this._material=RClass.create(FG3dMaterial)}function MG3dRenderable_currentMatrix(){return this._currentMatrix}function MG3dRenderable_matrix(){return this._matrix}
function MG3dRenderable_activeEffect(){var b=this._activeInfo;return b?b.effect:null}function MG3dRenderable_activeInfo(){return this._activeInfo}function MG3dRenderable_effectFind(b){var f=this._infos;return f&&(b=f.get(b))?b.effect:null}function MG3dRenderable_effectSet(b,f){var h=this.infos().get(b);h||(h=new SG3dRenderableInfo,es.set(b,h));h.effect=f}function MG3dRenderable_infos(){var b=this._infos;b||(b=this._infos=new TDictionary);return b}
function MG3dRenderable_selectInfo(b){var f=this.infos(),h=f.get(b);h||(h=new SG3dRenderableInfo,f.set(b,h));return this._activeInfo=h}function MG3dRenderable_resetInfos(){var b=this._infos;if(b)for(var f=b.count()-1;0<=f;f--)b.valueAt(f).reset()}function MG3dRenderable_material(){return this._material}function MG3dRenderable_update(b){}
function MG3dRenderable_dispose(){this._currentMatrix=RObject.dispose(this._currentMatrix);this._matrix=RObject.dispose(this._matrix);this._material=RObject.dispose(this._material);this._infos=RObject.dispose(this._infos)}
function SG3dEffectInfo(){this.supportInstance=this.optionNormalInvert=this.optionAlphaTest=this.blendTargetMode=this.blendSourceMode=this.optionBlendMode=this.optionDepthWrite=this.depthModeCd=this.optionDepthTest=this.cullModeCd=this.optionCullMode=this.fillModeCd=this.mergeCount=this.optionMerge=this.techniqueModeCode=this.techniqueCode=this.code=null;this.vertexCount=0;this.vertexSkeleton=this.vertexNormalFull=this.vertexNormal=this.vertexCoord=this.vertexColor=null;this.vertexBoneCount=0;this.fragmentHeight=
this.fragmentEmissive=this.fragmentRefract=this.fragmentReflect=this.fragmentLight=this.fragmentEnvironment=this.fragmentSpecularView=this.fragmentSpecularLevel=this.fragmentSpecularColor=this.fragmentDiffuseView=this.fragmentDiffuse=this.fragmentAmbient=this.fragmentBump=this.fragmentAlpha=null;this.attributes=new TArray;this.samplers=new TArray;this.attributeContains=SG3dEffectInfo_attributeContains;this.samplerContains=SG3dEffectInfo_samplerContains;this.reset=SG3dEffectInfo_reset;this.reset();
return this}function SG3dEffectInfo_attributeContains(b){return this.attributes.contains(b)}function SG3dEffectInfo_samplerContains(b){return this.samplers.contains(b)}
function SG3dEffectInfo_reset(){this.code=null;this.optionMerge=!1;this.mergeCount=0;this.fillModeCd=EG3dFillMode.Fill;this.optionCullMode=!0;this.cullModeCd=EG3dCullMode.Front;this.optionDepthTest=!0;this.depthModeCd=EG3dDepthMode.Less;this.optionDepthWrite=!0;this.optionBlendMode=!1;this.blendSourceMode=EG3dBlendMode.SourceAlpha;this.blendTargetMode=EG3dBlendMode.OneMinusSourceAlpha;this.supportInstance=this.optionNormalInvert=this.optionAlphaTest=!1;this.vertexCount=0;this.vertexSkeleton=this.vertexNormalFull=
this.vertexNormal=this.vertexCoord=this.vertexColor=!1;this.vertexBoneCount=0;this.fragmentHeight=this.fragmentEmissive=this.fragmentRefract=this.fragmentReflect=this.fragmentLight=this.fragmentEnvironment=this.fragmentSpecularView=this.fragmentSpecularLevel=this.fragmentSpecularColor=this.fragmentDiffuseView=this.fragmentDiffuse=this.fragmentAmbient=this.fragmentBump=this.fragmentAlpha=!1;this.attributes.clear();this.samplers.clear()}
function SG3dMaterialInfo(b){b||(b=this);b.effectCode="automatic";b.optionDepth=!1;b.optionDouble=null;b.optionNormalInvert=null;b.optionShadow=null;b.optionShadowSelf=null;b.optionAlpha=null;b.alphaBase=1;b.alphaRate=1;b.alphaLevel=1;b.alphaMerge=1;b.optionColor=null;b.colorMin=0;b.colorMax=1;b.colorRate=1;b.colorMerge=1;b.optionAmbient=null;b.ambientColor=new SColor4;b.ambientShadow=1;b.optionDiffuse=null;b.diffuseColor=new SColor4;b.diffuseShadow=1;b.optionDiffuseView=null;b.diffuseViewColor=new SColor4;
b.diffuseViewShadow=1;b.optionSpecular=null;b.specularColor=new SColor4;b.specularBase=1;b.specularLevel=1;b.specularAverage=1;b.specularShadow=1;b.specularInfo=null;b.optionSpecularView=null;b.specularViewColor=new SColor4;b.specularViewBase=1;b.specularViewRate=1;b.specularViewAverage=1;b.specularViewShadow=1;b.specularViewShadow=null;b.optionReflect=null;b.reflectColor=new SColor4;b.reflectMerge=1;b.reflectShadow=1;b.optionRefract=null;b.refractFrontColor=new SColor4;b.refractBackColor=new SColor4;
b.optionOpacity=null;b.opacityColor=new SColor4;b.opacityRate=1;b.opacityAlpha=1;b.opacityDepth=1;b.opacityTransmittance=1;b.optionEmissive=null;b.emissiveColor=new SColor4;b.assign=SG3dMaterialInfo_assign;b.calculate=SG3dMaterialInfo_calculate;b.reset=SG3dMaterialInfo_reset;b.reset();return b}
function SG3dMaterialInfo_assign(b){this.effectCode=b.effectCode;this.transformName=b.transformName;this.optionDepth=b.optionDepth;this.optionDouble=b.optionDouble;this.optionNormalInvert=b.optionNormalInvert;this.optionShadow=b.optionShadow;this.optionShadowSelf=b.optionShadowSelf;this.optionColor=b.optionColor;this.colorMin=b.colorMin;this.colorMax=b.colorMax;this.colorRate=b.colorRate;this.colorMerge=b.colorMerge;this.optionAlpha=b.optionAlpha;this.alphaBase=b.alphaBase;this.alphaRate=b.alphaRate;
this.alphaLevel=b.alphaLevel;this.alphaMerge=b.alphaMerge;this.optionAmbient=b.optionAmbient;this.ambientColor.assign(b.ambientColor);this.ambientShadow=b.ambientShadow;this.optionDiffuse=b.optionDiffuse;this.diffuseColor.assign(b.diffuseColor);this.diffuseShadow=b.diffuseShadow;this.optionDiffuseView=b.optionDiffuseView;this.diffuseViewColor.assign(b.diffuseViewColor);this.diffuseViewShadow=b.diffuseViewShadow;this.optionSpecular=b.optionSpecular;this.specularColor.assign(b.specularColor);this.specularBase=
b.specularBase;this.specularLevel=b.specularLevel;this.specularAverage=b.specularAverage;this.specularShadow=b.specularShadow;this.optionSpecularView=b.optionSpecularView;this.specularViewColor.assign(b.specularViewColor);this.specularViewBase=b.specularViewBase;this.specularViewRate=b.specularViewRate;this.specularViewAverage=b.specularViewAverage;this.specularViewShadow=b.specularViewShadow;this.optionReflect=b.optionReflect;this.reflectColor.assign(b.reflectColor);this.reflectMerge=RFloat.toRange(b.reflectMerge,
0,2);this.reflectShadow=b.reflectShadow;this.optionRefract=b.optionRefract;this.refractFrontColor.assign(b.refractFrontColor);this.refractFrontMerge=b.refractFrontMerge;this.refractFrontShadow=b.refractFrontShadow;this.refractBackColor.assign(b.refractBackColor);this.refractBackMerge=b.refractBackMerge;this.refractBackShadow=b.refractBackShadow;this.optionOpacity=b.optionOpacity;this.opacityColor.assign(b.opacityColor);this.opacityRate=b.opacityRate;this.opacityAlpha=b.optionAlpha;this.opacityDepth=
b.optionDepth;this.opacityTransmittance=b.optionTransmittance;this.optionEmissive=b.optionEmissive;this.emissiveColor.assign(b.emissiveColor)}
function SG3dMaterialInfo_calculate(b){this.effectCode=b.effectCode;this.transformName=b.transformName;this.optionDepth=b.optionDepth;this.optionDouble=b.optionDouble;this.optionNormalInvert=b.optionNormalInvert;this.optionShadow=b.optionShadow;this.optionShadowSelf=b.optionShadowSelf;this.optionColor=b.optionColor;this.colorMin=b.colorMin;this.colorMax=b.colorMax;this.colorRate=b.colorRate;this.colorMerge=b.colorMerge;this.optionAlpha=b.optionAlpha;this.alphaBase=b.alphaBase;this.alphaRate=b.alphaRate;
this.alphaLevel=b.alphaLevel;this.alphaMerge=b.alphaMerge;this.optionAmbient=b.optionAmbient;this.ambientColor.assignPower(b.ambientColor);this.ambientShadow=b.ambientShadow;this.optionDiffuse=b.optionDiffuse;this.diffuseColor.assignPower(b.diffuseColor);this.diffuseShadow=b.diffuseShadow;this.optionDiffuseView=b.optionDiffuseView;this.diffuseViewColor.assignPower(b.diffuseViewColor);this.diffuseViewShadow=b.diffuseViewShadow;this.optionSpecular=b.optionSpecular;this.specularColor.assignPower(b.specularColor);
this.specularBase=b.specularBase;this.specularLevel=b.specularLevel;this.specularAverage=b.specularAverage;this.specularShadow=b.specularShadow;this.optionSpecularView=b.optionSpecularView;this.specularViewColor.assignPower(b.specularViewColor);this.specularViewBase=b.specularViewBase;this.specularViewRate=b.specularViewRate;this.specularViewAverage=b.specularViewAverage;this.specularViewShadow=b.specularViewShadow;this.optionReflect=b.optionReflect;this.reflectColor.assignPower(b.reflectColor);this.reflectMerge=
RFloat.toRange(b.reflectMerge,0,2);this.reflectShadow=b.reflectShadow;this.optionRefract=b.optionRefract;this.refractFrontColor.assignPower(b.refractFrontColor);this.refractFrontMerge=b.refractFrontMerge;this.refractFrontShadow=b.refractFrontShadow;this.refractBackColor.assignPower(b.refractBackColor);this.refractBackMerge=b.refractBackMerge;this.refractBackShadow=b.refractBackShadow;this.optionOpacity=b.optionOpacity;this.opacityColor.assignPower(b.opacityColor);this.opacityRate=b.opacityRate;this.opacityAlpha=
b.optionAlpha;this.opacityDepth=b.optionDepth;this.opacityTransmittance=b.optionTransmittance;this.optionEmissive=b.optionEmissive;this.emissiveColor.assignPower(b.emissiveColor)}
function SG3dMaterialInfo_reset(){this.optionDepth=!0;this.optionNormalInvert=this.optionDouble=!1;this.optionColor=this.optionShadowSelf=this.optionShadow=!0;this.colorMin=0;this.colorMerge=this.colorRate=this.colorMax=1;this.optionAlpha=!1;this.alphaBase=.2;this.alphaMerge=this.alphaLevel=this.alphaRate=1;this.optionAmbient=!0;this.ambientColor.set(.5,.5,.5,1);this.ambientShadow=1;this.optionDiffuse=!0;this.diffuseColor.set(.5,.5,.5,1);this.diffuseShadow=1;this.optionDiffuseView=!0;this.diffuseViewColor.set(1,
1,1,1);this.diffuseViewShadow=1;this.optionSpecular=!0;this.specularColor.set(.5,.5,.5,1);this.specularBase=0;this.specularLevel=16;this.specularShadow=this.specularAverage=1;this.optionSpecularView=!0;this.specularViewColor.set(1,1,1,1);this.specularViewBase=0;this.specularViewRate=16;this.specularViewShadow=this.specularViewAverage=1;this.optionReflect=!0;this.reflectColor.set(1,1,1,1);this.reflectShadow=this.reflectMerge=1;this.optionRefract=!0;this.refractFrontColor.set(1,1,1,1);this.refractFrontShadow=
this.refractFrontMerge=1;this.refractBackColor.set(1,1,1,1);this.refractBackShadow=this.refractBackMerge=1;this.optionOpacity=!0;this.opacityColor.set(1,1,1,1);this.opacityTransmittance=this.opacityDepth=this.opacityAlpha=this.opacityRate=1;this.optionEmissive=!0;this.emissiveColor.set(1,1,1,1)}function SG3dRenderableInfo(){this.material=this.layout=this.effect=null;this.reset=SG3dRenderableInfo_reset;return this}
function SG3dRenderableInfo_reset(){this.effect=null;this.layout=RObject.dispose(this.layout)}function FG3dAnimation(b){b=RClass.inherits(this,b,FObject);b._baseTick=0;b._currentTick=0;b._lastTick=0;b._bones=null;b.construct=FG3dAnimation_construct;b.findBone=FG3dAnimation_findBone;b.process=FG3dAnimation_process;b.dispose=FG3dAnimation_dispose;return b}function FG3dAnimation_construct(){this.__base.FObject.construct.call(this);this._bones=new TObjects}
function FG3dAnimation_findBone(b){for(var f=this._bones,h=f.count(),q=0;q<h;q++){var u=f.get(q);if(u.boneId()==b)return u}return null}function FG3dAnimation_process(){var b=RTimer.current();0==this._lastTick&&(this._lastTick=b);this._currentTick=(b-this._lastTick+this._baseTick)/1E3;for(var b=this._bones,f=b.count(),h=0;h<f;h++)b.get(h).update(this._currentTick);return!0}function FG3dAnimation_dispose(){this._bones.dispose();this._bones=null;this.__base.FObject.dispose.call(this)}
function FG3dBaseMaterial(b){b=RClass.inherits(this,b,FObject);b._name=null;b._visible=!0;b._info=null;b._reference=null;b.construct=FG3dBaseMaterial_construct;b.visible=FG3dBaseMaterial_visible;b.setVisible=FG3dBaseMaterial_setVisible;b.info=FG3dBaseMaterial_info;b.reference=FG3dBaseMaterial_reference;b.testVisible=FG3dBaseMaterial_testVisible;b.assignInfo=FG3dBaseMaterial_assignInfo;b.assign=FG3dBaseMaterial_assign;b.calculate=FG3dBaseMaterial_calculate;return b}
function FG3dBaseMaterial_construct(){this.__base.FObject.construct.call(this);this._info=new SG3dMaterialInfo}function FG3dBaseMaterial_visible(){return this._visible}function FG3dBaseMaterial_setVisible(b){this._visible=b}function FG3dBaseMaterial_info(){return this._info}function FG3dBaseMaterial_reference(){return this._reference}function FG3dBaseMaterial_testVisible(){var b=this._visible;b&&this._reference&&(b=this._reference.testVisible());return b}
function FG3dBaseMaterial_assignInfo(b){this._info.assign(b)}function FG3dBaseMaterial_assign(b){this._reference=b;this._info.assign(b.info())}function FG3dBaseMaterial_calculate(b){this._reference=b;this._info.calculate(b.info())}function FG3dBone(b){b=RClass.inherits(this,b,FObject);b._boneId=0;b._modeId=null;b.update=FG3dBone_update;return b}function FG3dBone_update(b){}
function FG3dCamera(b){b=RClass.inherits(this,b,FObject);b._matrix=null;b._position=null;b._target=null;b._direction=null;b._directionTarget=null;b._centerFront=.6;b._centerBack=1;b._focalNear=.1;b._focalFar=200;b._planes=null;b._frustum=null;b._viewport=null;b.__axisUp=null;b.__axisX=null;b.__axisY=null;b.__axisZ=null;b.construct=FG3dCamera_construct;b.matrix=FG3dCamera_matrix;b.position=FG3dCamera_position;b.setPosition=FG3dCamera_setPosition;b.direction=FG3dCamera_direction;b.setDirection=FG3dCamera_setDirection;
b.frustum=FG3dCamera_frustum;b.doWalk=FG3dCamera_doWalk;b.doStrafe=FG3dCamera_doStrafe;b.doFly=FG3dCamera_doFly;b.doPitch=FG3dCamera_doPitch;b.doYaw=FG3dCamera_doYaw;b.doRoll=FG3dCamera_doRoll;b.lookAt=FG3dCamera_lookAt;b.update=FG3dCamera_update;return b}
function FG3dCamera_construct(){this.__base.FObject.construct.call(this);this._matrix=new SMatrix3d;this._position=new SPoint3;this._target=new SPoint3;this._direction=new SVector3;this._directionTarget=new SVector3;this._planes=[];this._frustum=new SFrustum;this._viewport=RClass.create(FG3dViewport);this.__axisUp=new SVector3;this.__axisUp.set(0,1,0);this.__axisX=new SVector3;this.__axisY=new SVector3;this.__axisZ=new SVector3}function FG3dCamera_position(){return this._position}
function FG3dCamera_matrix(){return this._matrix}function FG3dCamera_setPosition(b,f,h){this._position.set(b,f,h)}function FG3dCamera_direction(){return this._direction}function FG3dCamera_setDirection(b,f,h){this._direction.set(b,f,h);this._directionTarget.set(b,f,h)}function FG3dCamera_frustum(){return this._frustum}function FG3dCamera_doWalk(b){this._position.x+=this._direction.x*b;this._position.z+=this._direction.z*b}
function FG3dCamera_doStrafe(b){this._position.x+=this.__axisY.x*b;this._position.z+=this.__axisY.z*b}function FG3dCamera_doFly(b){this._position.y+=b}function FG3dCamera_doPitch(b){throw new TFatal(this,"Unsupport.");}function FG3dCamera_doYaw(b){throw new TFatal(this,"Unsupport.");}function FG3dCamera_doRoll(b){throw new TFatal(this,"Unsupport.");}
function FG3dCamera_lookAt(b,f,h){var q=this._position,u=this._direction;this._target.set(b,f,h);u.set(b-q.x,f-q.y,h-q.z);u.normalize();this._directionTarget.assign(u)}
function FG3dCamera_update(){var b=this.__axisX,f=this.__axisY,h=this.__axisZ;h.assign(this._direction);h.normalize();this.__axisUp.cross2(b,h);b.normalize();h.cross2(f,b);f.normalize();var q=this._matrix.data();q[0]=b.x;q[1]=f.x;q[2]=h.x;q[3]=0;q[4]=b.y;q[5]=f.y;q[6]=h.y;q[7]=0;q[8]=b.z;q[9]=f.z;q[10]=h.z;q[11]=0;q[12]=-b.dotPoint3(this._position);q[13]=-f.dotPoint3(this._position);q[14]=-h.dotPoint3(this._position);q[15]=1}
function FG3dDirectionalLight(b){b=RClass.inherits(this,b,FG3dLight);b._camera=null;b._viewport=null;b._direction=null;b.construct=FG3dDirectionalLight_construct;b.camera=FG3dDirectionalLight_camera;b.projection=FG3dDirectionalLight_projection;b.viewport=FG3dDirectionalLight_viewport;b.direction=FG3dDirectionalLight_direction;return b}
function FG3dDirectionalLight_construct(){this.__base.FG3dLight.construct.call(this);this._direction=new SVector3;this._camera=RClass.create(FG3dPerspectiveCamera)}function FG3dDirectionalLight_camera(){return this._camera}function FG3dDirectionalLight_projection(){return this._projection}function FG3dDirectionalLight_viewport(){return this._viewport}function FG3dDirectionalLight_direction(){return this._direction}
function FG3dEffect(b){b=RClass.inherits(this,b,FG3dObject);b._code=null;b._stateFillCd=EG3dFillMode.Face;b._stateCullCd=EG3dCullMode.Front;b._stateDepth=!0;b._stateDepthCd=EG3dDepthMode.LessEqual;b._stateDepthWrite=!0;b._stateBlend=!0;b._stateBlendSourceCd=EG3dBlendMode.SourceAlpha;b._stateBlendTargetCd=EG3dBlendMode.OneMinusSourceAlpha;b._stateAlphaTest=!1;b._optionShadow=!1;b._optionLightMap=!1;b._optionFog=!1;b._program=null;b._vertexTemplate=null;b._fragmentTemplate=null;b.setup=RMethod.empty;
b.code=FG3dEffect_code;b.program=FG3dEffect_program;b.setParameter=FG3dEffect_setParameter;b.setSampler=FG3dEffect_setSampler;b.drawRenderable=FG3dEffect_drawRenderable;b.drawGroup=FG3dEffect_drawGroup;b.drawRegion=FG3dEffect_drawRegion;b.buildInfo=FG3dEffect_buildInfo;b.loadConfig=FG3dEffect_loadConfig;b.load=FG3dEffect_load;b.build=FG3dEffect_build;return b}function FG3dEffect_code(){return this._code}function FG3dEffect_program(){return this._program}
function FG3dEffect_setParameter(b,f,h){this._program.setParameter(b,f,h)}function FG3dEffect_setSampler(b,f){this._program.setSampler(b,f)}function FG3dEffect_buildInfo(b,f){}
function FG3dEffect_drawRenderable(b,f){var h=this._graphicContext,q=this._program;if(q.hasAttribute())for(var u=q.attributes(),z=u.count(),A=0;A<z;A++){var B=u.value(A);if(B._statusUsed){var C=r.findVertexBuffer(B._linker);if(!C)throw new TError("Can't find renderable vertex buffer. (linker={1})",B._linker);q.setAttribute(B._name,C,C._formatCd)}}q=r.indexBuffer();h.drawTriangles(q,0,q.count())}
function FG3dEffect_drawGroup(b,f,h,q){this._graphicContext.setProgram(this._program);for(var u=0;u<q;u++)this.drawRenderable(b,f.getAt(h+u))}function FG3dEffect_drawRegion(b,f,h){for(var q=b.renderables(),u=0;u<h;){for(var z=u,A=h,B=q.getAt(f+z)._materialReference,C=u;C<h;C++){var D=q.getAt(f+C)._materialReference;if(B!=D){A=C;break}u++}this.drawGroup(b,q,f+z,A-z)}}
function FG3dEffect_loadConfig(b){var f=this._graphicContext,h=this._program=f.createProgram();b=b.nodes();for(var f=b.count(),q=0;q<f;q++){var u=b.get(q);if(u.isName("State")){var z=u.get("name"),A=u.get("value");if("fill_mode"==z)this._stateFillCd=REnum.parse(EG3dFillMode,A);else if("cull_mode"==z)this._stateCullCd=REnum.parse(EG3dCullMode,A);else if("depth_mode"==z)this._stateDepth=!0,this._stateDepthCd=REnum.parse(EG3dDepthMode,A);else if("depth_write"==z)this._stateDepthWrite=RBoolean.parse(A);
else if("blend_mode"==z){if(this._stateBlend=RBoolean.parse(A))this._stateBlendSourceCd=REnum.parse(EG3dBlendMode,u.get("source")),this._stateBlendTargetCd=REnum.parse(EG3dBlendMode,u.get("target"))}else"alpha_test"==z&&(this._stateAlphaTest=RBoolean.parse(A))}else if(u.isName("Option"))z=u.get("name"),A=u.get("value"),"shadow"==z?this._optionShadow=RBoolean.parse(A):"lightmap"==z?this._optionLightMap=RBoolean.parse(A):"fog"==z&&(this._optionFog=RBoolean.parse(A));else if(u.isName("Parameter"))z=
RClass.create(FG3dProgramParameter),z.loadConfig(u),h.parameters().set(z.name(),z);else if(u.isName("Attribute"))z=RClass.create(FG3dProgramAttribute),z.loadConfig(u),h.attributes().set(z.name(),z);else if(u.isName("Sampler"))z=RClass.create(FG3dProgramSampler),z.loadConfig(u),h.samplers().set(z.name(),z);else if(u.isName("Source"))if(z=u.get("name"),"vertex"==z)this._vertexSource=u.value();else if("fragment"==z)this._fragmentSource=u.value();else throw new TError(this,"Unknown source type. (name={1})",
nt);else throw new TError(this,"Unknown config type. (name={1})",u.name());}(this._vertexTemplate=RClass.create(FG3dShaderTemplate)).load(this._vertexSource);(this._fragmentTemplate=RClass.create(FG3dShaderTemplate)).load(this._fragmentSource)}
function FG3dEffect_build(b){var f=this._program,h=f._parameters,q=h.count(),u=RInstance.get(FTagContext);this.buildInfo(u,b);b=this._vertexTemplate.parse(u);b=RString.formatLines(b);f.upload(EG3dShader.Vertex,b);u=this._fragmentTemplate.parse(u);for(b=0;b<q;b++){var z=h.value(b),A=z.name();(z=z.define())&&(u=u.replace(new RegExp(A,"g"),z))}h=RString.formatLines(u);f.upload(EG3dShader.Fragment,h);f.build();f.link()}
function FG3dEffect_load(){var b=RConsole.find(FG3dEffectConsole).loadConfig(this._code);this.loadConfig(b)}
function FG3dEffectConsole(b){b=RClass.inherits(this,b,FConsole);b._configs=null;b._registerEffects=null;b._templateEffects=null;b._effects=null;b._path="/ar3/shader/";b._effectInfo=null;b._tagContext=null;b.construct=FG3dEffectConsole_construct;b.path=FG3dEffectConsole_path;b.register=FG3dEffectConsole_register;b.unregister=FG3dEffectConsole_unregister;b.create=FG3dEffectConsole_create;b.buildEffectInfo=FG3dEffectConsole_buildEffectInfo;b.findTemplate=FG3dEffectConsole_findTemplate;b.find=FG3dEffectConsole_find;
b.loadConfig=FG3dEffectConsole_loadConfig;return b}function FG3dEffectConsole_construct(){this.__base.FConsole.construct.call(this);this._configs=new TDictionary;this._registerEffects=new TDictionary;this._templateEffects=new TDictionary;this._effects=new TDictionary;this._effectInfo=new SG3dEffectInfo;this._tagContext=RClass.create(FTagContext)}function FG3dEffectConsole_path(){return this._path}function FG3dEffectConsole_register(b,f){this._registerEffects.set(b,f)}
function FG3dEffectConsole_unregister(b){this._registerEffects.set(b,null)}function FG3dEffectConsole_create(b,f){var h=this._registerEffects.get(f);if(!h)throw new TError(this,"Unknown effect type name. (type={1})",h);h=RClass.create(h);h.linkGraphicContext(b);h.setup();return h}
function FG3dEffectConsole_buildEffectInfo(b,f,h,q){h=h.technique();f.techniqueModeCode=h.activeMode().code();f.optionMerge=q._optionMerge;f.optionMerge&&(f.mergeCount=q.mergeCount());h=q.material().info();f.optionNormalInvert=h.optionNormalInvert;f.optionAmbient=h.optionAmbient;f.optionDiffuse=h.optionDiffuse;f.optionSpecular=h.optionSpecular;f.optionReflect=h.optionReflect;f.optionRefract=h.optionRefract;f.vertexCount=q.vertexCount();var u=q.vertexBuffers();h=u.count();if(u.constructor==TDictionary)for(var z=
0;z<h;z++){var A=u.value(z);f.attributes.push(A.name())}else for(z=0;z<h;z++)A=u.get(z),f.attributes.push(A.name());if(u=q.textures())for(h=u.count(),z=0;z<h;z++)f.samplers.push(u.name(z));if(h=q.bones())h=h.count(),f.vertexBoneCount=h,b=b.capability().calculateBoneCount(f.vertexBoneCount,f.vertexCount),h>b&&(h=b),q._boneLimit=h,f.vertexBoneLimit=h}
function FG3dEffectConsole_findTemplate(b,f){var h=this._templateEffects,q=h.get(f);null==q&&(q=this.create(b,f),q.load(),RLogger.info(this,"Create effect template. (name={1}, instance={2})",f,q),h.set(f,q));return q}
function FG3dEffectConsole_find(b,f,h){var q=h.material().info().effectCode;RString.isEmpty(q)&&(q="automatic");var u=f.spaceName()+"."+q,z=this.findTemplate(b,u);if(z){this._effectInfo.reset();this.buildEffectInfo(b,this._effectInfo,f,h);z.buildInfo(this._tagContext,this._effectInfo);f=u+this._tagContext.code;h=this._effects;var A=h.get(f);null==A&&(A=this.create(b,u),A._flag=f,A.load(),A.build(this._effectInfo),RLogger.info(this,"Create effect. (name={1}, instance={2})",q,A));h.set(f,A)}return A}
function FG3dEffectConsole_loadConfig(b){var f=this._configs.get(b);if(f)return f;f=RBrowser.contentPath(this._path+b+".xml");RRuntime.isDebug()&&(f+="?"+RDate.format());f=RClass.create(FXmlConnection).send(f);this._configs.set(b,f);return f}function FG3dLight(b){return b=RClass.inherits(this,b,FObject)}function FG3dLightMaterial(b){return b=RClass.inherits(this,b,FG3dBaseMaterial)}
function FG3dMaterial(b){b=RClass.inherits(this,b,FG3dBaseMaterial);b._dirty=!0;b._textures=null;b.textures=FG3dMaterial_textures;b.update=FG3dMaterial_update;return b}function FG3dMaterial_textures(){return this._textures}function FG3dMaterial_update(){this._dirty=!0}
function FG3dMaterialMap(b){b=RClass.inherits(this,b,FObject,MGraphicObject);b._size=null;b._data=null;b._texture=null;b._stride=null;b._dirty=!1;b.construct=FG3dMaterialMap_construct;b.size=FG3dMaterialMap_size;b.data=FG3dMaterialMap_data;b.texture=FG3dMaterialMap_texture;b.setup=FG3dMaterialMap_setup;b.resize=FG3dMaterialMap_resize;b.setUint8=FG3dMaterialMap_setUint8;b.setUint16=FG3dMaterialMap_setUint16;b.setUint32=FG3dMaterialMap_setUint32;b.setFloat16=FG3dMaterialMap_setFloat16;b.setFloat32=
FG3dMaterialMap_setFloat32;b.update=FG3dMaterialMap_update;return b}function FG3dMaterialMap_construct(){this.__base.FObject.construct.call(this);this._size=new SSize2}function FG3dMaterialMap_size(){return this._size}function FG3dMaterialMap_data(){return this._data}function FG3dMaterialMap_texture(){return this._texture}
function FG3dMaterialMap_setup(b,f){var h=this._texture=this._graphicContext.createFlatTexture();this.resize(b,f);h.setFilter(EG3dSamplerFilter.Nearest,EG3dSamplerFilter.Nearest);h.uploadData(this._data,b,f)}function FG3dMaterialMap_resize(b,f){var h=this._size;2048<f?f=4096:1024<f?f=2048:512<f?f=1024:256<f?f=512:128<f?f=256:64<f?f=128:32<f?f=64:16<f&&(f=32);f<h.height&&(f=h.height);if(h.width!=b||h.height!=f)h.set(b,f),this._stride=4*b,this._data=new Uint8Array(4*b*f)}
function FG3dMaterialMap_setUint8(b,f,h,q,u,z){var A=this._data;b=this._stride*b+(f<<2);h.constructor==SColor4?(q=255*h.red,A[b]!=q&&(this._dirty=!0),A[b++]=q,q=255*h.green,A[b]!=q&&(this._dirty=!0),A[b++]=q,q=255*h.blue,A[b]!=q&&(this._dirty=!0),A[b++]=q,q=255*h.alpha,A[b]!=q&&(this._dirty=!0),A[b++]=q):(A[b++]=h,A[b++]=q,A[b++]=u,A[b++]=z)}
function FG3dMaterialMap_setUint16(b,f,h,q){var u=this._data;b=this._stride*b+(f<<2);u[b++]=h>>8&255;u[b++]=h&255;u[b++]=q>>8&255;u[b++]=q&255;this._dirty=!0}function FG3dMaterialMap_setUint32(b,f,h){var q=this._data;b=this._stride*b+(f<<2);q[b++]=h>>24&255;q[b++]=h>>16&255;q[b++]=h>>8&255;q[b++]=h&255;this._dirty=!0}
function FG3dMaterialMap_setFloat16(b,f,h,q){var u=this._data;b=this._stride*b+(f<<2);parseInt(256*h);u[b++]=parseInt(h)&255;u[b++]=parseInt(256*h)&255;u[b++]=parseInt(q)&255;u[b++]=parseInt(256*q)&255;this._dirty=!0}function FG3dMaterialMap_setFloat32(b,f,h){var q=this._data;b=this._stride*b+(f<<2);q[b++]=parseInt(.00390625*h)&255;q[b++]=parseInt(h)&255;q[b++]=parseInt(256*h)&255;q[b++]=parseInt(65536*h)&255;this._dirty=!0}
function FG3dMaterialMap_update(){if(this._dirty){var b=this._size;this._texture.uploadData(this._data,b.width,b.height);this._dirty=!1}}function FG3dMaterialTexture(b){b=RClass.inherits(this,b,FG3dMaterial);b._texture=null;b.construct=FG3dMaterialTexture_construct;return b}function FG3dMaterialTexture_construct(){}function FG3dObject(b){b=RClass.inherits(this,b,FObject,MGraphicObject);b.setup=FG3dObject_setup;b.dispose=FG3dObject_dispose;return b}function FG3dObject_setup(){}
function FG3dObject_dispose(){this.__base.MGraphicObject.dispose.call(this);this.__base.FObject.dispose.call(this)}function FG3dOrthoCamera(b){b=RClass.inherits(this,b,FG3dCamera);b._projection=null;b.construct=FG3dOrthoCamera_construct;b.projection=FG3dOrthoCamera_projection;b.updateFrustum=FG3dOrthoCamera_updateFrustum;b.updateFromCamera=FG3dOrthoCamera_updateFromCamera;b.updateFlatCamera=FG3dOrthoCamera_updateFlatCamera;return b}
function FG3dOrthoCamera_construct(){this.__base.FG3dCamera.construct.call(this);this._projection=RClass.create(FG3dOrthoProjection)}function FG3dOrthoCamera_projection(){return this._projection}function FG3dOrthoCamera_updateFrustum(){var b=this._projection,f=b._size,h=this._frustum;h.update(b._angle,f.width,f.height,b._znear,b._zfar,this._centerFront,this._centerBack,this._matrix);return h}
function FG3dOrthoCamera_updateFromCamera(b){b=b.updateFrustum();var f=this._direction;f.normalize();this._position.set(b.center.x-f.x*b.radius,b.center.y-f.y*b.radius,b.center.z-f.z*b.radius);this.lookAt(b.center.x,b.center.y,b.center.z);this.update();f=this._frustum;this._matrix.transform(f.coners,b.coners,8);f.updateCenter();this._projection.updateFrustum(f)}
function FG3dOrthoCamera_updateFlatCamera(b){var f=b.updateFlatFrustum(),h=RMath.DEGREE_RATE*this._projection.angle(),h=f.radius/Math.sin(.5*h),h=Math.max(h,b._projection._zfar);b=this._direction;b.normalize();this._position.set(f.center.x-b.x*h,f.center.y-b.y*h,f.center.z-b.z*h);this.lookAt(f.center.x,f.center.y,f.center.z);this.update();this._projection._znear=.3;this._projection._zfar=1.5*h;this._projection.update()}
function FG3dOrthoProjection(b){b=RClass.inherits(this,b,FG3dProjection);b._matrix=null;b.construct=FG3dOrthoProjection_construct;b.matrix=FG3dOrthoProjection_matrix;b.update=FG3dOrthoProjection_update;b.updateFrustum=FG3dOrthoProjection_updateFrustum;return b}function FG3dOrthoProjection_construct(){this.__base.FG3dProjection.construct.call(this);this._matrix=new SOrthoMatrix3d}function FG3dOrthoProjection_matrix(){return this._matrix}
function FG3dOrthoProjection_update(){var b=this._size;this._matrix.identity();var f=this._matrix.data();f[0]=2/b.width*8;f[4]=f[8]=f[12]=0;f[5]=2/b.height*8;f[1]=f[9]=f[13]=0;f[10]=1/(this._znear-this._zfar);f[2]=f[6]=f[14]=0;f[3]=f[7]=0;f[11]=this._znear/(this._znear-this._zfar);f[15]=1}function FG3dOrthoProjection_updateFrustum(b){this._znear=b.minZ;this._zfar=b.maxZ;this.update()}
function FG3dPerspectiveCamera(b){b=RClass.inherits(this,b,FG3dCamera);b._projection=null;b._centerFront=.4;b.construct=FG3dPerspectiveCamera_construct;b.projection=FG3dPerspectiveCamera_projection;b.updateFrustum=FG3dPerspectiveCamera_updateFrustum;b.updateFlatFrustum=FG3dPerspectiveCamera_updateFlatFrustum;b.updateFromCamera=FG3dPerspectiveCamera_updateFromCamera;b.updateFlatCamera=FG3dPerspectiveCamera_updateFlatCamera;return b}
function FG3dPerspectiveCamera_construct(){this.__base.FG3dCamera.construct.call(this);this._projection=RClass.create(FG3dPerspectiveProjection)}function FG3dPerspectiveCamera_projection(){return this._projection}function FG3dPerspectiveCamera_updateFrustum(){var b=this._projection,f=b._size,h=this._frustum;h.update(b._angle,f.width,f.height,b._znear,b._zfar,this._centerFront,this._centerBack,this._matrix);return h}
function FG3dPerspectiveCamera_updateFlatFrustum(){var b=this._projection,f=b._size,h=this._frustum;h.updateFlat(b._angle,f.width,f.height,b._znear,b._zfar,this._centerFront,this._centerBack,this._matrix);return h}
function FG3dPerspectiveCamera_updateFromCamera(b){var f=this._frustum,h=b.updateFrustum(),q=RMath.DEGREE_RATE*this._projection.angle(),q=h.radius/Math.sin(.5*q),q=Math.max(q,b._projection._zfar);b=this._direction;b.normalize();this._position.set(h.center.x-b.x*q,h.center.y-b.y*q,h.center.z-b.z*q);this.lookAt(h.center.x,h.center.y,h.center.z);this.update();this._matrix.transform(f.coners,h.coners,8);f.updateCenter();this._projection.updateFrustum(f)}
function FG3dPerspectiveCamera_updateFlatCamera(b){var f=b.updateFlatFrustum(),h=RMath.DEGREE_RATE*this._projection.angle(),h=f.radius/Math.sin(.5*h),h=Math.max(h,b._projection._zfar);b=this._direction;b.normalize();this._position.set(f.center.x-b.x*h*this._centerFront,f.center.y-b.y*h*this._centerFront,f.center.z-b.z*h*this._centerFront);this.lookAt(f.center.x,f.center.y,f.center.z);this.update();this._projection._znear=.1;this._projection._zfar=h;this._projection.update()}
function FG3dPerspectiveProjection(b){b=RClass.inherits(this,b,FG3dProjection);b._matrix=null;b.construct=FG3dPerspectiveProjection_construct;b.matrix=FG3dPerspectiveProjection_matrix;b.update=FG3dPerspectiveProjection_update;b.updateFrustum=FG3dPerspectiveProjection_updateFrustum;return b}function FG3dPerspectiveProjection_construct(){this.__base.FG3dProjection.construct.call(this);this._matrix=new SPerspectiveMatrix3d}function FG3dPerspectiveProjection_matrix(){return this._matrix}
function FG3dPerspectiveProjection_update(){var b=this._size;this._fieldOfView=RMath.DEGREE_RATE*this._angle;this._matrix.perspectiveFieldOfViewLH(this._fieldOfView,b.width/b.height,this._znear,this._zfar)}function FG3dPerspectiveProjection_updateFrustum(b){this._znear=b.minZ;this._zfar=b.maxZ;this.update()}function FG3dPointLight(b){return b=RClass.inherits(this,b,FG3dLight)}
function FG3dProjection(b){b=RClass.inherits(this,b,FObject);b._size=null;b._angle=60;b._fieldOfView=0;b._znear=.1;b._zfar=200;b._scale=0;b.construct=FG3dProjection_construct;b.size=FG3dProjection_size;b.angle=FG3dProjection_angle;b.znear=FG3dProjection_znear;b.zfar=FG3dProjection_zfar;b.distance=FG3dProjection_distance;return b}function FG3dProjection_construct(){this.__base.FObject.construct.call(this);this._size=new SSize2}function FG3dProjection_size(){return this._size}
function FG3dProjection_angle(){return this._angle}function FG3dProjection_znear(){return this._znear}function FG3dProjection_zfar(){return this._zfar}function FG3dProjection_distance(){return this._zfar-this._znear}function FG3dShaderTemplate(b){b=RClass.inherits(this,b,FTagDocument);b._space="shader";return b}function FG3dSpotLight(b){return b=RClass.inherits(this,b,FG3dLight)}
function FG3dTechnique(b){b=RClass.inherits(this,b,FG3dObject);b._code=null;b._activeMode=null;b._modes=null;b._passes=null;b.construct=FG3dTechnique_construct;b.code=FG3dTechnique_code;b.activeMode=FG3dTechnique_activeMode;b.modes=FG3dTechnique_modes;b.passes=FG3dTechnique_passes;b.registerMode=FG3dTechnique_registerMode;b.selectMode=FG3dTechnique_selectMode;b.updateRegion=RMethod.empty;b.clear=FG3dTechnique_clear;b.sortRenderables=FG3dTechnique_sortRenderables;b.drawRegion=FG3dTechnique_drawRegion;
b.present=FG3dTechnique_present;return b}function FG3dTechnique_construct(){this.__base.FG3dObject.construct.call(this);this._modes=new TObjects;this._passes=new TObjects}function FG3dTechnique_code(){return this._code}function FG3dTechnique_activeMode(){return this._activeMode}function FG3dTechnique_modes(){return this._modes}function FG3dTechnique_passes(){return this._passes}
function FG3dTechnique_registerMode(b){var f=RClass.create(FG3dTechniqueMode);f.setCode(b);this._modes.push(f);return this._activeMode=f}function FG3dTechnique_selectMode(b){}function FG3dTechnique_clear(b){var f=this._graphicContext;f.setRenderTarget(null);f.clear(b.red,b.green,b.blue,b.alpha,1)}function FG3dTechnique_sortRenderables(b,f){}
function FG3dTechnique_drawRegion(b){b.setTechnique(this);for(var f=this._passes,h=f.count(),q=0;q<h;q++){var u=f.get(q);b.setTechniquePass(u,q==h-1);u.drawRegion(b)}}function FG3dTechnique_present(b){this._graphicContext.present()}function FG3dTechniqueConsole(b){b=RClass.inherits(this,b,FConsole);b._techniques=null;b.construct=FG3dTechniqueConsole_construct;b.techniques=FG3dTechniqueConsole_techniques;b.find=FG3dTechniqueConsole_find;return b}
function FG3dTechniqueConsole_construct(){this.__base.FConsole.construct.call(this);this._techniques=new TDictionary}function FG3dTechniqueConsole_techniques(){return this._techniques}function FG3dTechniqueConsole_find(b,f){var h=RClass.name(f),q=this._techniques,u=q.get(h);if(!u){u=RClass.createByName(h);u.linkGraphicContext(b);u.setup();for(var z=u.passes(),A=z.count(),B=0;B<A;B++){var C=z.get(B);C.setFullCode(u.code()+"."+C.code())}q.set(h,u)}return u}
function FG3dTechniqueMode(b){b=RClass.inherits(this,b,FObject);b._code=null;b.code=FG3dTechniqueMode_code;b.setCode=FG3dTechniqueMode_setCode;return b}function FG3dTechniqueMode_code(){return this._code}function FG3dTechniqueMode_setCode(b){this._code=b}
function FG3dTechniquePass(b){b=RClass.inherits(this,b,FG3dObject);b._fullCode=null;b._code=null;b._index=null;b._finish=!1;b._materialMap=null;b.setup=FG3dTechniquePass_setup;b.fullCode=FG3dTechniquePass_fullCode;b.setFullCode=FG3dTechniquePass_setFullCode;b.code=FG3dTechniquePass_code;b.activeEffects=FG3dTechniquePass_activeEffects;b.sortRenderables=FG3dTechniquePass_sortRenderables;b.drawRegion=FG3dTechniquePass_drawRegion;return b}
function FG3dTechniquePass_setup(){var b=this._materialMap=RClass.create(FG3dMaterialMap);b.linkGraphicContext(this);b.setup(EG3dMaterialMap.Count,32)}function FG3dTechniquePass_fullCode(){return this._fullCode}function FG3dTechniquePass_setFullCode(b){this._fullCode=b}function FG3dTechniquePass_code(){return this._code}
function FG3dTechniquePass_sortRenderables(b,f){var h=b.material().info(),q=f.material().info();if(h.optionAlpha&&q.optionAlpha)return h=b.activeEffect(),q=f.activeEffect(),h==q&&(sm=b._materialReference,tm=f._materialReference,sm&&tm)?sm.hashCode()-tm.hashCode():h.hashCode()-q.hashCode();if(h.optionAlpha&&!q.optionAlpha)return 1;if(!h.optionAlpha&&q.optionAlpha)return-1;h=b.activeEffect();q=f.activeEffect();return h==q&&(sm=b._materialReference,tm=f._materialReference,sm&&tm)?sm.hashCode()-tm.hashCode():
h.hashCode()-q.hashCode()}function FG3dTechniquePass_activeEffects(b,f){for(var h=b.spaceName(),q=f.count()-1;0<=q;q--){var u=f.get(q),z=u.selectInfo(h);z.effect||(z.effect=RConsole.find(FG3dEffectConsole).find(this._graphicContext,b,u))}}
function FG3dTechniquePass_drawRegion(b){var f=b.renderables(),h=f.count();if(0!=h){b._statistics._frameDrawSort.begin();this.activeEffects(b,f);f.sort(this.sortRenderables);b._statistics._frameDrawSort.end();if(this._graphicContext.capability().optionMaterialMap){var q=this._materialMap;q.resize(EG3dMaterialMap.Count,h);for(var u=0;u<h;u++){var z=f.get(u);z._materialId=u;z=z.material().info();q.setUint8(u,EG3dMaterialMap.AmbientColor,z.ambientColor);q.setUint8(u,EG3dMaterialMap.DiffuseColor,z.diffuseColor);
q.setUint8(u,EG3dMaterialMap.SpecularColor,z.specularColor);q.setUint8(u,EG3dMaterialMap.ReflectColor,z.reflectColor);q.setUint8(u,EG3dMaterialMap.EmissiveColor,z.emissiveColor)}q.update();b._materialMap=q}for(q=0;q<h;){for(var z=q,A=h,B=f.getAt(z).activeEffect(),u=q;u<h;u++){var C=f.getAt(u).activeEffect();if(B!=C){A=u;break}q++}B.drawRegion(b,z,A-z)}}}function FG3dTrack(b){b=RClass.inherits(this,b,FObject);b._frames=null;b.construct=FG3dTrack_construct;b.calculate=FG3dTrack_calculate;return b}
function FG3dTrack_construct(){this.__base.FObject.construct.call(this)}function FG3dTrack_update(b){b=new SG3dFrameInfo;this._trackResource.calculateFrameInfo(b,tick);b.update();this._matrix.assign(this._trackResource.matrixInvert());this._matrix.append(b.matrix);return!0}
function FG3dTrack_calculate(b){var f=this._frames.count();if(0==f)return!1;0>b&&(b=-b);var h=this._frames.Get(index),q=null,q=index<f-1?this._frames.Get(index+1):this._frames.Get(0);info.tick=b;info.currentFrame=h;info.nextFrame=q;return!0}function FG3dViewport(b){b=RClass.inherits(this,b,FObject);b.left=0;b.top=0;b.width=0;b.height=0;b.set=FG3dViewport_set;return b}function FG3dViewport_set(b,f,h,q){this.left=b;this.top=f;this.width=h;this.height=q}
var REngine3d=new function(){this.contexts=new TObjects;this.createContext=REngine3d_createContext;return this};function REngine3d_createContext(b,f,h){b=RClass.create(b);h&&(b._optionAlpha=h.alpha,b._optionAntialias=h.antialias);b.linkCanvas(f);this.contexts.push(b);return b}
var EG3dAttribute=new function(){this.Position="position";this.Color="color";this.Coord="coord";this.Normal="normal";this.Binormal="binormal";this.Tangent="tangent";this.BoneIndex="bone_index";this.BoneWeight="bone_weight";return this},EG3dAttributeFormat=new function(){this.Unknown=0;this.Float1=1;this.Float2=2;this.Float3=3;this.Float4=4;this.Byte4=5;this.Byte4Normal=6;return this},EG3dBlendMode=new function(){this.None=0;this.SourceAlpha=1;this.OneMinusSourceAlpha=2;return this},EG3dCullMode=new function(){this.None=
0;this.Front=1;this.Back=2;this.Both=3;return this},EG3dDepthMode=new function(){this.None=0;this.Equal=1;this.NotEqual=2;this.Less=3;this.LessEqual=4;this.Greater=5;this.GreaterEqual=6;this.Always=7;return this},EG3dFillMode=new function(){this.Unknown=0;this.Point=1;this.Line=2;this.Face=3;return this},EG3dIndexStride=new function(){this.Unknown=0;this.Uint16=1;this.Uint32=2;return this},EG3dParameterFormat=new function(){this.Unknown=0;this.Float1=1;this.Float2=2;this.Float3=3;this.Float4=4;this.Float3x3=
5;this.Float4x3=6;this.Float4x4=7;return this},EG3dSampler=new function(){this.Diffuse="diffuse";this.Alpha="alpha";this.Normal="normal";this.SpecularColor="specular.color";this.SpecularLevel="specular.level";this.Light="light";this.Reflect="reflect";this.Refract="refract";this.Emissive="emissive";this.Height="height";this.Environment="environment";return this},EG3dSamplerFilter=new function(){this.Unknown=0;this.Nearest=1;this.Linear=2;this.Repeat=3;this.ClampToEdge=4;this.ClampToBorder=5;return this},
EG3dShader=new function(){this.Unknown=0;this.Vertex=1;this.Fragment=2;return this},EG3dTexture=new function(){this.Unknown=0;this.Flat2d=1;this.Flat3d=2;this.Cube=3;return this};
function SG3dContextCapability(){this.shaderVersion=this.version=this.vendor=null;this.optionShaderSource=this.optionIndex32=this.optionMaterialMap=this.optionLayout=this.optionInstance=this.optionDebug=!1;this.mergeCount=0;this.attributeCount=null;this.vertexCount=65536;this.samplerCompressRgba=this.samplerCompressRgb=this.samplerSize=this.samplerCount=this.varyingCount=this.fragmentConst=this.vertexConst=null;this.calculateBoneCount=SG3dContextCapability_calculateBoneCount;this.calculateInstanceCount=
SG3dContextCapability_calculateInstanceCount;return this}function SG3dContextCapability_calculateBoneCount(b,f){var h=0,h=b%8,h=0!=h?b+8-h:b,q=(this.vertexConst-16)/4;return h>q?q:h}function SG3dContextCapability_calculateInstanceCount(b,f){var h=(this.vertexConst-16)/(4*b+4),q=cl;0<f&&(q=Math.min(h,this.vertexCount/f));64<q&&(q=64);return q}function FG3dBuffer(b){b=RClass.inherits(this,b,FG3dObject);b._name=null;b.name=FG3dBuffer_name;b.isValid=RMethod.virtual(b,"isValid");return b}
function FG3dBuffer_name(){return this._name}
function FG3dContext(b){b=RClass.inherits(this,b,FGraphicContext);b._optionAlpha=!0;b._optionAntialias=!1;b._size=null;b._capability=null;b._statistics=null;b._fillModeCd=EG3dFillMode.Face;b._optionDepth=!1;b._optionCull=!1;b._depthModeCd=0;b._cullModeCd=0;b._statusBlend=!1;b._blendSourceCd=0;b._blendTargetCd=0;b._program=null;b.construct=FG3dContext_construct;b.linkCanvas=FG3dContext_linkCanvas;b.size=FG3dContext_size;b.capability=FG3dContext_capability;b.statistics=FG3dContext_statistics;b.createProgram=
RMethod.virtual(b,"createProgram");b.createVertexBuffer=RMethod.virtual(b,"createVertexBuffer");b.createIndexBuffer=RMethod.virtual(b,"createIndexBuffer");b.createFlatTexture=RMethod.virtual(b,"createFlatTexture");b.createCubeTexture=RMethod.virtual(b,"createCubeTexture");b.createRenderTarget=RMethod.virtual(b,"createRenderTarget");b.setViewport=RMethod.virtual(b,"setViewport");b.setFillMode=RMethod.virtual(b,"setFillMode");b.setDepthMode=RMethod.virtual(b,"setDepthMode");b.setCullingMode=RMethod.virtual(b,
"setCullingMode");b.setBlendFactors=RMethod.virtual(b,"setBlendFactors");b.setScissorRectangle=RMethod.virtual(b,"setScissorRectangle");b.setRenderTarget=RMethod.virtual(b,"setRenderTarget");b.setProgram=RMethod.virtual(b,"setProgram");b.bindVertexBuffer=RMethod.virtual(b,"bindVertexBuffer");b.bindTexture=RMethod.virtual(b,"bindTexture");b.prepare=FG3dContext_prepare;b.clear=RMethod.virtual(b,"clear");b.clearColor=RMethod.virtual(b,"clearColor");b.clearDepth=RMethod.virtual(b,"clearDepth");b.drawTriangles=
RMethod.virtual(b,"drawTriangles");b.present=RMethod.virtual(b,"present");b.dispose=FG3dContext_dispose;return b}function FG3dContext_construct(){this.__base.FGraphicContext.construct.call(this);this._size=new SSize2;this._statistics=RClass.create(FG3dStatistics);RConsole.find(FStatisticsConsole).register("graphic3d.context",this._statistics)}function FG3dContext_linkCanvas(b){this._size.set(b.width,b.height)}function FG3dContext_size(){return this._size}
function FG3dContext_capability(){return this._capability}function FG3dContext_statistics(){return this._statistics}function FG3dContext_prepare(){this._statistics.resetFrame()}function FG3dContext_dispose(){this._program=null;this.__base.FGraphicContext.dispose.call(this)}function FG3dCubeTexture(b){b=RClass.inherits(this,b,FG3dTexture);b.size=0;b.construct=FG3dTexture_construct;return b}function FG3dTexture_construct(){this.__base.FG3dTexture.construct();this._textureCd=EG3dTexture.Cube}
function FG3dFlatTexture(b){b=RClass.inherits(this,b,FG3dTexture);b.width=0;b.height=0;b.construct=FG3dFlatTexture_construct;b.uploadData=RMethod.virtual(b,"uploadData");b.upload=RMethod.virtual(b,"upload");return b}function FG3dFlatTexture_construct(){this.__base.FG3dTexture.construct();this._textureCd=EG3dTexture.Flat2d}function FG3dFragmentShader(b){return b=RClass.inherits(this,b,FG3dShader)}
function FG3dIndexBuffer(b){b=RClass.inherits(this,b,FG3dBuffer);b._strideCd=EG3dIndexStride.Uint16;b._count=0;b.strideCd=FG3dIndexBuffer_strideCd;b.count=FG3dIndexBuffer_count;b.upload=RMethod.virtual(b,"upload");return b}function FG3dIndexBuffer_strideCd(){return this._strideCd}function FG3dIndexBuffer_count(){return this._count}function FG3dLayout(b){b=RClass.inherits(this,b,FG3dObject);b._elemets=null;b.elemets=FG3dLayout_elemets;b.update=FG3dLayout_update;return b}
function FG3dLayout_elemets(){return this._elemets}function FG3dLayout_update(){}function FG3dLayoutElement(b){b=RClass.inherits(this,b,FObject);b._name=0;b._buffer=null;b.name=FG3dLayoutElement_name;return b}function FG3dLayoutElement_name(){return this._name}
function FG3dProgram(b){b=RClass.inherits(this,b,FG3dObject);b._attributes=null;b._parameters=null;b._samplers=null;b._vertexShader=null;b._fragmentShader=null;b.hasAttribute=FG3dProgram_hasAttribute;b.registerAttribute=FG3dProgram_registerAttribute;b.findAttribute=FG3dProgram_findAttribute;b.attributes=FG3dProgram_attributes;b.hasParameter=FG3dProgram_hasParameter;b.registerParameter=FG3dProgram_registerParameter;b.findParameter=FG3dProgram_findParameter;b.parameters=FG3dProgram_parameters;b.hasSampler=
FG3dProgram_hasSampler;b.registerSampler=FG3dProgram_registerSampler;b.findSampler=FG3dProgram_findSampler;b.samplers=FG3dProgram_samplers;b.vertexShader=RMethod.virtual(b,"vertexShader");b.fragmentShader=RMethod.virtual(b,"fragmentShader");b.setAttribute=FG3dProgram_setAttribute;b.setParameter=FG3dProgram_setParameter;b.setParameter4=FG3dProgram_setParameter4;b.setSampler=FG3dProgram_setSampler;b.upload=RMethod.virtual(b,"upload");return b}
function FG3dProgram_hasAttribute(){var b=this._attributes;return b?!b.isEmpty():!1}function FG3dProgram_registerAttribute(b){var f=RClass.create(FG3dProgramAttribute);f._name=b;this.attributes().set(b,f);return f}function FG3dProgram_findAttribute(b){return this._attributes?this._attributes.get(b):null}function FG3dProgram_attributes(){var b=this._attributes;null==b&&(b=this._attributes=new TDictionary);return b}
function FG3dProgram_hasParameter(){var b=this._parameters;return b?!b.isEmpty():!1}function FG3dProgram_registerParameter(b,f){var h=RClass.create(FG3dProgramParameter);h._name=b;h.formatCd=f;this.parameters().set(b,h);return h}function FG3dProgram_findParameter(b){return this._parameters?this._parameters.get(b):null}function FG3dProgram_parameters(){var b=this._parameters;null==b&&(b=this._parameters=new TDictionary);return b}
function FG3dProgram_hasSampler(){var b=this._samplers;return b?!b.isEmpty():!1}function FG3dProgram_registerSampler(b){var f=RClass.create(FG3dProgramSampler);f._name=b;this.samplers().set(b,f);return f}function FG3dProgram_findSampler(b){return this._samplers?this._samplers.get(b):null}function FG3dProgram_samplers(){var b=this._samplers;null==b&&(b=this._samplers=new TDictionary);return b}
function FG3dProgram_setAttribute(b,f,h){var q=this.findAttribute(b);if(null==q)throw new TError(this,"Bind invalid attribute. (name={1})",b);this._graphicContext.bindVertexBuffer(q._slot,f,0,h)}
function FG3dProgram_setParameter(b,f,h){var q=this.findParameter(b);if(null==q)throw new TError(this,"Bind invalid parameter. (name={1})",b);var u=null,u=f.constructor;if(u==Float32Array||u==SMatrix3d||u==SPerspectiveMatrix3d)u=f;else if(u==SColor4)u=RTypeArray.float4(),u[0]=f.red,u[1]=f.green,u[2]=f.blue,u[3]=f.alpha;else if(u==SPoint3||u==SVector3)u=RTypeArray.float3(),u[0]=f.x,u[1]=f.y,u[2]=f.z;else if(u==SPoint4||u==SVector4)u=RTypeArray.float4(),u[0]=f.x,u[1]=f.y,u[2]=f.z,u[3]=f.w;else throw new TError(this,
"Bind invalid parameter type. (name={1}, type={2})",b,u);this._graphicContext.bindConst(null,q._slot,q._formatCd,u,h)}function FG3dProgram_setParameter4(b,f,h,q,u){var z=RTypeArray.float4();z[0]=f;z[1]=h;z[2]=q;z[3]=u;this.setParameter(b,z,1)}function FG3dProgram_setSampler(b,f){var h=this.findSampler(b);if(null==h)throw new TError(this,"Bind invalid sampler. (name={1})",b);this._graphicContext.bindTexture(h._slot,h._index,f)}
function FG3dProgramAttribute(b){b=RClass.inherits(this,b,FObject);b._name=null;b._linker=null;b._statusUsed=!1;b._slot=-1;b._index=-1;b._formatCd=EG3dAttributeFormat.Unknown;b.name=FG3dProgramAttribute_name;b.linker=FG3dProgramAttribute_linker;b.loadConfig=FG3dProgramAttribute_loadConfig;return b}function FG3dProgramAttribute_name(){return this._name}function FG3dProgramAttribute_linker(){return this._linker}
function FG3dProgramAttribute_loadConfig(b){this._name=b.get("name");this._linker=b.get("linker");this._formatCd=REnum.encode(EG3dAttributeFormat,b.get("format"))}
function FG3dProgramParameter(b){b=RClass.inherits(this,b,FObject);b._name=null;b._linker=null;b._formatCd=EG3dParameterFormat.Unknown;b._define=null;b._statusUsed=!1;b._slot=null;b._size=0;b._buffer=null;b.name=FG3dProgramParameter_name;b.linker=FG3dProgramParameter_linker;b.define=FG3dProgramParameter_define;b.loadConfig=FG3dProgramParameter_loadConfig;return b}function FG3dProgramParameter_name(){return this._name}function FG3dProgramParameter_linker(){return this._linker}
function FG3dProgramParameter_define(){return this._define}function FG3dProgramParameter_loadConfig(b){this._name=b.get("name");this._linker=b.get("linker");this._formatCd=REnum.encode(EG3dParameterFormat,b.get("format"));this._define=b.get("define")}
function FG3dProgramSampler(b){b=RClass.inherits(this,b,FObject);b._name=null;b._linker=null;b._statusUsed=!1;b._formatCd=EG3dTexture.Flat2d;b._bind=!0;b._slot=-1;b._index=0;b._source=null;b.name=FG3dProgramSampler_name;b.linker=FG3dProgramSampler_linker;b.formatCd=FG3dProgramSampler_formatCd;b.loadConfig=FG3dProgramSampler_loadConfig;return b}function FG3dProgramSampler_name(){return this._name}function FG3dProgramSampler_linker(){return this._linker}
function FG3dProgramSampler_formatCd(){return this._formatCd}function FG3dProgramSampler_loadConfig(b){this._name=b.get("name");this._linker=b.get("linker");this._bind=RBoolean.parse(b.get("bind","Y"));this._formatCd=REnum.encode(EG3dTexture,b.get("format","Flat2d"))}
function FG3dRenderTarget(b){b=RClass.inherits(this,b,FG3dObject);b._size=null;b._color=null;b._textures=null;b.construct=FG3dRenderTarget_construct;b.size=FG3dRenderTarget_size;b.color=FG3dRenderTarget_color;b.textures=FG3dRenderTarget_textures;return b}function FG3dRenderTarget_construct(){this.__base.FG3dObject.construct();this._size=new SSize2;this._color=new SColor4;this._color.set(0,0,0,1)}function FG3dRenderTarget_size(){return this._size}
function FG3dRenderTarget_color(){return this._color}function FG3dRenderTarget_textures(){var b=this._textures;null==b&&(b=this._textures=new TObjects);return b}function FG3dShader(b){b=RClass.inherits(this,b,FG3dObject);b._source=null;b.source=FG3dShader_source;b.upload=RMethod.virtual(b,"upload");return b}function FG3dShader_source(){return this._source}
function FG3dStatistics(b){b=RClass.inherits(this,b,FStatistics);b._frameClearCount=0;b._frameFillModeCount=0;b._frameDepthModeCount=0;b._frameCullModeCount=0;b._frameBlendModeCount=0;b._frameProgramCount=0;b._frameConstCount=0;b._frameConstLength=0;b._frameBufferCount=0;b._frameTextureCount=0;b._frameTargetCount=0;b._frameDrawCount=0;b._frameTriangleCount=0;b._programTotal=0;b._layoutTotal=0;b._vertexBufferTotal=0;b._indexBufferTotal=0;b._flatTextureTotal=0;b._cubeTextureTotal=0;b._targetTotal=0;
b.reset=FG3dStatistics_reset;b.resetFrame=FG3dStatistics_resetFrame;return b}function FG3dStatistics_reset(){o._programTotal=0;o._layoutTotal=0;o._vertexBufferTotal=0;o._indexBufferTotal=0;o._flatTextureTotal=0;o._cubeTextureTotal=0;o._targetTotal=0}
function FG3dStatistics_resetFrame(){this._frameDrawCount=this._frameTriangleCount=this._frameTargetCount=this._frameTextureCount=this._frameBufferCount=this._frameConstLength=this._frameConstCount=this._frameProgramCount=this._frameBlendModeCount=this._frameCullModeCount=this._frameDepthModeCount=this._frameFillModeCount=this._frameClearCount=0}
function FG3dTexture(b){b=RClass.inherits(this,b,FG3dObject);b._textureCd=EG3dTexture.Unknown;b._filterMinCd=EG3dSamplerFilter.Linear;b._filterMagCd=EG3dSamplerFilter.Linear;b._wrapS=EG3dSamplerFilter.Unknown;b._wrapT=EG3dSamplerFilter.Unknown;b._statusLoad=!1;b.isValid=RMethod.virtual(b,"isValid");b.textureCd=FG3dTexture_textureCd;b.filterMinCd=FG3dTexture_filterMinCd;b.filterMagCd=FG3dTexture_filterMagCd;b.setFilter=FG3dTexture_setFilter;b.wrapS=FG3dTexture_wrapS;b.wrapT=FG3dTexture_wrapT;b.setWrap=
FG3dTexture_setWrap;return b}function FG3dTexture_textureCd(){return this._textureCd}function FG3dTexture_filterMinCd(){return this._filterMinCd}function FG3dTexture_filterMagCd(){return this._filterMagCd}function FG3dTexture_setFilter(b,f){this._filterMinCd=b;this._filterMagCd=f}function FG3dTexture_wrapS(){return this._wrapS}function FG3dTexture_wrapT(){return this._wrapT}function FG3dTexture_setWrap(b,f){this._wrapS=b;this._wrapT=f}
function FG3dVertexBuffer(b){b=RClass.inherits(this,b,FG3dBuffer);b._formatCd=EG3dAttributeFormat.Unknown;b._stride=0;b._count=0;b.formatCd=FG3dVertexBuffer_formatCd;b.stride=FG3dVertexBuffer_stride;b.count=FG3dVertexBuffer_count;b.upload=RMethod.virtual(b,"upload");return b}function FG3dVertexBuffer_formatCd(){return this._formatCd}function FG3dVertexBuffer_stride(){return this._stride}function FG3dVertexBuffer_count(){return this._count}
function FG3dVertexShader(b){return b=RClass.inherits(this,b,FG3dShader)}
function FG3dAutomaticEffect(b){b=RClass.inherits(this,b,FG3dEffect);b._optionMerge=!1;b._optionBlendMode=!0;b._supportInstance=!1;b._supportLayout=!1;b._supportMaterialMap=!1;b._supportVertexColor=!0;b._supportVertexCoord=!0;b._supportVertexNormal=!0;b._supportVertexNormalFull=!0;b._supportSkeleton=!1;b._supportAlpha=!0;b._supportAmbient=!0;b._supportDiffuse=!0;b._supportDiffuseView=!0;b._supportSpecularColor=!0;b._supportSpecularLevel=!0;b._supportSpecularView=!0;b._supportLight=!0;b._supportReflect=
!0;b._supportRefract=!0;b._supportEmissive=!0;b._supportHeight=!0;b._supportEnvironment=!0;b._dynamicSkeleton=!0;b.setup=FG3dAutomaticEffect_setup;b.buildInfo=FG3dAutomaticEffect_buildInfo;b.bindAttributes=FG3dAutomaticEffect_bindAttributes;b.bindSamplers=FG3dAutomaticEffect_bindSamplers;b.bindMaterial=FG3dAutomaticEffect_bindMaterial;b.drawRenderable=FG3dAutomaticEffect_drawRenderable;return b}
function FG3dAutomaticEffect_setup(){this._supportLayout=this._graphicContext.capability().optionLayout}
function FG3dAutomaticEffect_buildInfo(b,f){var h=this._graphicContext.capability(),q=new TString;q.append(f.techniqueModeCode);b.set("technique.mode",f.techniqueModeCode);if(this._optionMerge=f.optionMerge){var u=f.mergeCount;q.append("|OI"+u);b.setBoolean("option.instance",!0);b.set("instance.count",u)}h.optionMaterialMap&&(q.append("|OM"),b.setBoolean("option.material.map",!0),this._supportMaterialMap=!0);f.optionNormalInvert&&(q.append("|ON"),b.setBoolean("option.normal.invert",!0),this._supportNormalInvert=
!0);f.optionAmbient&&(q.append("|OA"),b.setBoolean("option.ambient",!0),this.optionAmbient=!0);f.optionDiffuse&&(q.append("|OD"),b.setBoolean("option.diffuse",!0),this.optionDiffuse=!0);f.optionSpecular&&(q.append("|OS"),b.setBoolean("option.specular",!0),this.optionSpecular=!0);f.optionReflect&&(q.append("|ORL"),b.setBoolean("option.reflect",!0),this.optionReflect=!0);f.optionRefract&&(q.append("|ORF"),b.setBoolean("option.refract",!0),this.optionRefract=!0);u=f.attributeContains(EG3dAttribute.Color);
if(this._dynamicVertexColor=this._supportVertexColor&&u)q.append("|AC"),b.setBoolean("vertex.attribute.color",!0);u=f.attributeContains(EG3dAttribute.Coord);if(this._dynamicVertexCoord=this._supportVertexCoord&&u)q.append("|AD"),b.setBoolean("vertex.attribute.coord",!0);u=f.attributeContains(EG3dAttribute.Normal);if(this._dynamicVertexNormal=this._supportVertexNormal&&u)q.append("|AN"),b.setBoolean("vertex.attribute.normal",!0);var z=f.attributeContains(EG3dAttribute.Binormal),A=f.attributeContains(EG3dAttribute.Tangent);
if(this._dynamicVertexNormalFull=this._supportVertexNormalFull&&u&&z&&A)q.append("|AF"),b.setBoolean("vertex.attribute.normal.full",!0);if(this._dynamicInstance=this._supportInstance&&h.optionInstance)q.append("|SI"),f&&b.setBoolean("support.instance",!0);if(this._dynamicSkeleton=this._supportSkeleton)q.append("|SS"),f&&b.setBoolean("support.skeleton",!0);u=f.samplerContains(EG3dSampler.Diffuse);(this._dynamicAlpha=this._supportAlpha)?(q.append("|RA"),f&&b.setBoolean("support.alpha",!0),this._optionBlendMode=
!0):this._optionBlendMode=!1;if(this._dynamicAmbient=this._supportAmbient)q.append("|TA"),f&&b.setBoolean("support.ambient",!0),u&&(q.append("|TAS"),f&&b.setBoolean("support.ambient.sampler",!0));f.samplerContains(EG3dSampler.Alpha)&&b.setBoolean("support.alpha.sampler",!0);u=f.samplerContains(EG3dSampler.Normal);this._dynamicDiffuse=this._supportDiffuse&&(this._dynamicVertexNormal||u);this._supportDiffuse&&(f&&b.setBoolean("support.diffuse",!0),u?(q.append("|TDD"),f&&(b.setBoolean("support.dump",
!0),b.setBoolean("support.diffuse.dump",!0))):this._dynamicVertexNormal&&(q.append("|TDN"),f&&b.setBoolean("support.diffuse.normal",!0)));this._dynamicDiffuseView=this._supportDiffuseView&&(this._dynamicVertexNormal||u);this._supportDiffuseView&&(f&&b.setBoolean("support.diffuse.view",!0),u?(q.append("|TDVD"),f&&(b.setBoolean("support.dump",!0),b.setBoolean("support.diffuse.view.dump",!0))):this._dynamicVertexNormal&&(q.append("|TDVN"),f&&b.setBoolean("support.diffuse.view.normal",!0)));u=f.samplerContains(EG3dSampler.SpecularColor);
z=f.samplerContains(EG3dSampler.SpecularLevel);this._dynamicSpecularColor=this._supportSpecularColor&&u;this._dynamicSpecularLevel=this._supportSpecularLevel&&z;(this._dynamicSpecularColor||this._dynamicSpecularLevel)&&this._dynamicVertexNormal&&(q.append("|TS"),f&&b.setBoolean("support.specular",!0),this._dynamicSpecularColor&&(q.append("|TSC"),f&&b.setBoolean("support.specular.color",!0)),this._dynamicSpecularLevel?(q.append("|TSL"),f&&b.setBoolean("support.specular.level",!0)):(q.append("|NSL"),
f&&b.setBoolean("support.specular.normal",!0)));(this._dynamicSpecularView=this._supportSpecularView)&&this._dynamicVertexNormal&&(q.append("|TSV"),f&&b.setBoolean("support.specular.view",!0),this._dynamicSpecularColor&&(q.append("|TSVC"),f&&b.setBoolean("support.specular.view.color",!0)),this._dynamicSpecularLevel?(q.append("|TSVL"),f&&b.setBoolean("support.specular.view.level",!0)):(q.append("|NSVL"),f&&b.setBoolean("support.specular.view.normal",!0)));u=f.samplerContains(EG3dSampler.Light);if(this._dynamicLight=
this._supportLight&&u)q.append("|TL"),f&&(b.setBoolean("support.sampler.light",!0),b.setBoolean("support.light",!0));u=f.samplerContains(EG3dSampler.Reflect);if(this._dynamicReflect=this._supportReflect&&u)q.append("|TRL"),f&&(b.setBoolean("support.sampler.light",!0),b.setBoolean("support.reflect",!0));u=f.samplerContains(EG3dSampler.Refract);if(this._dynamicRefract=this._supportRefract&&u)q.append("|TRF"),f&&(b.setBoolean("support.sampler.light",!0),b.setBoolean("support.refract",!0));u=f.samplerContains(EG3dSampler.Emissive);
if(this._dynamicEmissive=this._supportEmissive&&u)q.append("|TLE"),f&&(b.setBoolean("support.sampler.light",!0),b.setBoolean("support.emissive",!0));u=f.samplerContains(EG3dSampler.Height);if(this._dynamicHeight=this._supportHeight&&u)q.append("|TH"),f&&b.setBoolean("support.height",!0);u=f.samplerContains(EG3dSampler.Environment);if(this._dynamicEnvironment=this._supportEnvironment&&u)q.append("|TE"),f&&b.setBoolean("support.environment",!0);if(this._dynamicInstance=this._supportInstance)u=h.calculateInstanceCount(f.vertexBoneCount,
f.vertexCount),b.set("instance.count",u);this._dynamicSkeleton&&(h=h.calculateBoneCount(f.vertexBoneCount,f.vertexCount),q.append("|B"+h),b.set("bone.count",h),b.setBoolean("support.bone.weight.1",!0),b.setBoolean("support.bone.weight.2",!0),b.setBoolean("support.bone.weight.3",!0),b.setBoolean("support.bone.weight.4",!0));b.code=q.toString()}
function FG3dAutomaticEffect_bindAttributes(b){var f=this._program;if(f.hasAttribute())for(var h=f.attributes(),q=h.count(),u=0;u<q;u++){var z=h.value(u);if(z._statusUsed){var A=b.findVertexBuffer(z._linker);f.setAttribute(z._name,A,A._formatCd)}}}function FG3dAutomaticEffect_bindSamplers(b){var f=this._program;if(f.hasSampler())for(var h=f.samplers(),q=h.count(),u=0;u<q;u++){var z=h.value(u);if(z._bind&&z._statusUsed){var A=z.linker(),A=b.findTexture(A);f.setSampler(z.name(),A.texture())}}}
function FG3dAutomaticEffect_bindMaterial(b){var f=this._graphicContext;b=b.info();b.optionAlpha?f.setBlendFactors(this._stateBlend,this._stateBlendSourceCd,this._stateBlendTargetCd):f.setBlendFactors(!1);b.optionDouble?f.setCullingMode(!1):f.setCullingMode(this._stateDepth,this._stateCullCd)}
function FG3dAutomaticEffect_drawRenderable(b,f){var h=this._graphicContext,q=this._program,u=null;if(this._supportLayout){var z=f.activeInfo(),u=z.layout;u||(u=z.layout=h.createLayout(),u.bind(),this.bindAttributes(f),u.unbind());u.active()}else this.bindAttributes(f);this._supportMaterialMap&&q.setSampler("fs_material",b.materialMap().texture());this.bindSamplers(f);h.drawTriangles(f.indexBuffer());this._supportLayout&&u.deactive()}
function FG3dControlAutomaticEffect(b){b=RClass.inherits(this,b,FG3dAutomaticEffect);b._code="control.automatic";b.drawRenderable=FG3dControlAutomaticEffect_drawRenderable;return b}
function FG3dControlAutomaticEffect_drawRenderable(b,f){var h=this._graphicContext,q=this._program,u=f.material(),z=u.info();this.bindMaterial(u);q.setParameter("vc_model_matrix",f.currentMatrix());q.setParameter("vc_vp_matrix",b.calculate(EG3dRegionParameter.CameraViewProjectionMatrix));q.setParameter4("fc_alpha",z.alphaBase,z.alphaRate,z.alphaLevel,z.alphaMerge);q.setParameter("fc_ambient_color",z.ambientColor);this.bindAttributes(f);this.bindSamplers(f);h.drawTriangles(f.indexBuffer())}
function FG3dControlFrameEffect(b){b=RClass.inherits(this,b,FG3dAutomaticEffect);b._code="control.frame";b.drawRenderable=FG3dControlFrameEffect_drawRenderable;return b}
function FG3dControlFrameEffect_drawRenderable(b,f){var h=this._graphicContext,q=this._program,u=b.calculate(EG3dRegionParameter.CameraPosition),z=b.calculate(EG3dRegionParameter.LightDirection),A=f.material(),B=A.info();this.bindMaterial(A);q.setParameter("vc_model_matrix",f.currentMatrix());q.setParameter("vc_vp_matrix",b.calculate(EG3dRegionParameter.CameraViewProjectionMatrix));q.setParameter("vc_camera_position",u);q.setParameter("vc_light_direction",z);q.setParameter("fc_camera_position",u);
q.setParameter("fc_light_direction",z);q.setParameter("fc_color",B.ambientColor);q.setParameter4("fc_vertex_color",B.colorMin,B.colorMax,B.colorRate,B.colorMerge);q.setParameter4("fc_alpha",B.alphaBase,B.alphaRate,B.alphaLevel,B.alphaMerge);q.setParameter("fc_ambient_color",B.ambientColor);q.setParameter("fc_diffuse_color",B.diffuseColor);q.setParameter("fc_specular_color",B.specularColor);q.setParameter4("fc_specular",B.specularBase,B.specularLevel,B.specularAverage,B.specularShadow);q.setParameter("fc_specular_view_color",
B.specularViewColor);q.setParameter4("fc_specular_view",B.specularViewBase,B.specularViewRate,B.specularViewAverage,B.specularViewShadow);q.setParameter("fc_reflect_color",B.reflectColor);q.setParameter4("fc_reflect",0,0,1-B.reflectMerge,B.reflectMerge);q.setParameter("fc_emissive_color",B.emissiveColor);this.bindAttributes(f);this.bindSamplers(f);h.drawTriangles(f.indexBuffer())}function FG3dControlPass(b){b=RClass.inherits(this,b,FG3dTechniquePass);b._code="control";return b}
function FG3dControlTechnique(b){b=RClass.inherits(this,b,FG3dTechnique);b._code="control";b._passControl=null;b.setup=FG3dControlTechnique_setup;b.passControl=FG3dControlTechnique_passControl;b.drawRegion=FG3dControlTechnique_drawRegion;return b}function FG3dControlTechnique_setup(){this.__base.FG3dTechnique.setup.call(this);this.registerMode(EG3dTechniqueMode.Result);var b=this._passControl=RClass.create(FG3dControlPass);b.linkGraphicContext(this);b.setup();this._passes.push(b)}
function FG3dControlTechnique_passControl(){return this._passControl}function FG3dControlTechnique_drawRegion(b){b.renderables().isEmpty()||(this._graphicContext.clearDepth(1),this.__base.FG3dTechnique.drawRegion.call(this,b))}function FG3dGeneralColorAutomaticEffect(b){b=RClass.inherits(this,b,FG3dAutomaticEffect);b._code="general.color.automatic";b.drawRenderable=FG3dGeneralColorAutomaticEffect_drawRenderable;return b}
function FG3dGeneralColorAutomaticEffect_drawRenderable(b,f){var h=this._program,q=b.calculate(EG3dRegionParameter.CameraPosition),u=b.calculate(EG3dRegionParameter.LightDirection),z=f.material(),A=z.info();this.bindMaterial(z);h.setParameter("vc_model_matrix",f.currentMatrix());h.setParameter("vc_vp_matrix",b.calculate(EG3dRegionParameter.CameraViewProjectionMatrix));h.setParameter("vc_camera_position",q);h.setParameter("vc_light_direction",u);h.setParameter("fc_camera_position",q);h.setParameter("fc_light_direction",
u);this._supportMaterialMap?h.setParameter4("fc_material",.03125,f._materialId/512,0,0):(h.setParameter("fc_ambient_color",A.ambientColor),h.setParameter("fc_diffuse_color",A.diffuseColor),h.setParameter("fc_specular_color",A.specularColor),h.setParameter("fc_reflect_color",A.reflectColor),h.setParameter("fc_emissive_color",A.emissiveColor));h.setParameter4("fc_color",A.colorMin,A.colorMax,A.colorRate,A.colorMerge);A.optionAlpha?h.setParameter4("fc_alpha",A.alphaBase,A.alphaRate,0,0):h.setParameter4("fc_alpha",
0,1,0,0);h.setParameter4("fc_specular",A.specularBase,A.specularLevel,A.specularAverage,A.specularShadow);h.setParameter4("fc_reflect",0,0,1-A.reflectMerge,A.reflectMerge);this.__base.FG3dAutomaticEffect.drawRenderable.call(this,b,f)}function FG3dGeneralColorPass(b){b=RClass.inherits(this,b,FG3dTechniquePass);b._code="color";return b}
function FG3dGeneralColorSkeletonEffect(b){b=RClass.inherits(this,b,FG3dAutomaticEffect);b._code="general.color.skeleton";b._supportSkeleton=!0;b.drawRenderable=FG3dGeneralColorSkeletonEffect_drawRenderable;return b}
function FG3dGeneralColorSkeletonEffect_drawRenderable(b,f){var h=this._graphicContext,q=this._program,u=b.calculate(EG3dRegionParameter.CameraPosition),z=b.calculate(EG3dRegionParameter.LightDirection),A=f.material(),B=A.info();this.bindMaterial(A);q.setParameter("vc_model_matrix",f.currentMatrix());q.setParameter("vc_vp_matrix",b.calculate(EG3dRegionParameter.CameraViewProjectionMatrix));q.setParameter("vc_camera_position",u);q.setParameter("vc_light_direction",z);q.setParameter("fc_camera_position",
u);q.setParameter("fc_light_direction",z);q.setParameter("fc_color",B.ambientColor);q.setParameter4("fc_vertex_color",B.colorMin,B.colorMax,B.colorRate,B.colorMerge);q.setParameter4("fc_alpha",B.alphaBase,B.alphaRate,B.alphaLevel,B.alphaMerge);q.setParameter("fc_ambient_color",B.ambientColor);q.setParameter("fc_diffuse_color",B.diffuseColor);q.setParameter("fc_specular_color",B.specularColor);q.setParameter4("fc_specular",B.specularBase,B.specularLevel,B.specularAverage,B.specularShadow);q.setParameter("fc_specular_view_color",
B.specularViewColor);q.setParameter4("fc_specular_view",B.specularViewBase,B.specularViewRate,B.specularViewAverage,B.specularViewShadow);q.setParameter("fc_reflect_color",B.reflectColor);if(u=f.bones()){for(var z=f._boneLimit,B=RTypeArray.findTemp(EDataType.Float,16*z),C=0;C<z;C++)A=u.get(C).matrix(),A.writeData(B,16*C);q.setParameter("vc_bone_matrix",B)}this.bindAttributes(f);this.bindSamplers(f);h.drawTriangles(f.indexBuffer())}
function FG3dGeneralTechnique(b){b=RClass.inherits(this,b,FG3dTechnique);b._code="general";b._passColor=null;b.setup=FG3dGeneralTechnique_setup;b.passColor=FG3dGeneralTechnique_passColor;return b}
function FG3dGeneralTechnique_setup(){this.__base.FG3dTechnique.setup.call(this);this.registerMode(EG3dTechniqueMode.Ambient);this.registerMode(EG3dTechniqueMode.DiffuseLevel);this.registerMode(EG3dTechniqueMode.DiffuseColor);this.registerMode(EG3dTechniqueMode.SpecularLevel);this.registerMode(EG3dTechniqueMode.SpecularColor);this.registerMode(EG3dTechniqueMode.Result);var b=this._passColor=RClass.create(FG3dGeneralColorPass);b.linkGraphicContext(this);b.setup();this._passes.push(b)}
function FG3dGeneralTechnique_passColor(){return this._passColor}function FG3dSelectAutomaticEffect(b){b=RClass.inherits(this,b,FG3dAutomaticEffect);b._code="select.automatic";b.drawRenderable=FG3dSelectAutomaticEffect_drawRenderable;return b}
function FG3dSelectAutomaticEffect_drawRenderable(b,f,h){var q=this._graphicContext,u=q.size(),z=this._program,A=b._selectX,B=b._selectY,C=f.material(),D=C.info();this.bindMaterial(C);z.setParameter("vc_model_matrix",f.currentMatrix());z.setParameter("vc_vp_matrix",b.calculate(EG3dRegionParameter.CameraViewProjectionMatrix));z.setParameter4("vc_offset",u.width,u.height,1-A/u.width*2,B/u.height*2-1);b=h+1;z.setParameter4("fc_index",(b&255)/255,(b>>8&255)/255,(b>>16&255)/255,D.alphaBase);this.bindAttributes(f);
this.bindSamplers(f);q.drawTriangles(f.indexBuffer())}function FG3dSelectPass(b){b=RClass.inherits(this,b,FG3dTechniquePass);b._code="select";b._texture=null;b._renderTarget=null;b._position=null;b._data=null;b.construct=FG3dSelectPass_construct;b.setup=FG3dSelectPass_setup;b.textureDepth=FG3dSelectPass_texture;b.drawRegion=FG3dSelectPass_drawRegion;return b}
function FG3dSelectPass_construct(){this.__base.FG3dTechniquePass.construct.call(this);this._data=new Uint8Array(4);this._position=new SPoint2}
function FG3dSelectPass_setup(){this.__base.FG3dTechniquePass.setup.call(this);var b=this._graphicContext,f=this._texture=b.createFlatTexture();f.setFilter(EG3dSamplerFilter.Nearest,EG3dSamplerFilter.Nearest);f.setWrap(EG3dSamplerFilter.ClampToEdge,EG3dSamplerFilter.ClampToEdge);b=this._renderTarget=b.createRenderTarget();b.size().set(1,1);b.textures().push(f);b.build()}function FG3dSelectPass_texture(){return this._texture}
function FG3dSelectPass_drawRegion(b){var f=this._graphicContext,h=f._native;f.setRenderTarget(this._renderTarget);f.clear(0,0,0,0,1,1);var q=b.allRenderables();this.activeEffects(b,q);for(var u=q.count(),z=0;z<u;z++){var A=q.get(z),B=A.activeEffect();f.setProgram(B.program());var C=A.display();C?C._optionFace||B.drawRenderable(b,A,z):B.drawRenderable(b,A,z)}f.clearDepth(1);for(z=0;z<u;z++)A=q.get(z),B=A.activeEffect(),f.setProgram(B.program()),(C=A.display())&&C._optionFace&&B.drawRenderable(b,A,
z);h.readPixels(0,0,1,1,h.RGBA,h.UNSIGNED_BYTE,this._data);b=this._data[0]+(this._data[1]<<8)+(this._data[2]<<16);this._selectRenderable=null;0!=b&&(this._selectRenderable=q.get(b-1))}function FG3dSelectSkeletonEffect(b){b=RClass.inherits(this,b,FG3dAutomaticEffect);b._code="select.automatic";b.drawRenderable=FG3dSelectSkeletonEffect_drawRenderable;return b}
function FG3dSelectSkeletonEffect_drawRenderable(b,f,h){var q=this._graphicContext,u=q.size(),z=this._program,A=b._selectX,B=b._selectY,C=f.material(),D=C.info();this.bindMaterial(C);z.setParameter("vc_model_matrix",f.currentMatrix());z.setParameter("vc_vp_matrix",b.calculate(EG3dRegionParameter.CameraViewProjectionMatrix));z.setParameter4("vc_offset",u.width,u.height,1-A/u.width*2,B/u.height*2-1);b=h+1;z.setParameter4("fc_index",(b&255)/255,(b>>8&255)/255,(b>>16&255)/255,D.alphaBase);this.bindAttributes(f);
this.bindSamplers(f);q.drawTriangles(f.indexBuffer())}function FG3dSelectTechnique(b){b=RClass.inherits(this,b,FG3dTechnique);b._code="select";b._passSelect=null;b.setup=FG3dSelectTechnique_setup;b.passSelect=FG3dSelectTechnique_passSelect;b.test=FG3dSelectTechnique_test;return b}
function FG3dSelectTechnique_setup(){this.__base.FG3dTechnique.setup.call(this);this.registerMode(EG3dTechniqueMode.Result);var b=this._passSelect=RClass.create(FG3dSelectPass);b.linkGraphicContext(this);b.setup();this._passes.push(b)}function FG3dSelectTechnique_passSelect(){return this._passSelect}function FG3dSelectTechnique_test(b,f,h){b._selectX=f;b._selectY=h;b.setTechnique(this);this.drawRegion(b);return this._passSelect._selectRenderable}
function FG3dShadowColorAutomaticEffect(b){b=RClass.inherits(this,b,FG3dAutomaticEffect);b._code="shadow.color.automatic";b.drawRenderable=FG3dShadowColorAutomaticEffect_drawRenderable;return b}
function FG3dShadowColorAutomaticEffect_drawRenderable(b,f){var h=this._graphicContext,q=this._program,u=b.calculate(EG3dRegionParameter.CameraPosition),z=b.calculate(EG3dRegionParameter.CameraViewProjectionMatrix),A=b.calculate(EG3dRegionParameter.LightDirection),B=b.calculate(EG3dRegionParameter.LightViewMatrix),C=b.calculate(EG3dRegionParameter.LightViewProjectionMatrix),D=b.calculate(EG3dRegionParameter.LightInfo),E=b.techniquePass(),F=f.material();this.bindMaterial(F);q.setParameter("vc_light_depth",
D);q.setParameter("vc_model_matrix",f.currentMatrix());q.setParameter("vc_vp_matrix",z);q.setParameter("vc_camera_position",u);q.setParameter("vc_light_direction",A);q.setParameter("vc_light_view_matrix",B);q.setParameter("vc_light_vp_matrix",C);q.setParameter("fc_camera_position",u);q.setParameter("fc_light_direction",A);q.setParameter4("fc_light_depth",1/4096,0,-1/4096,D.w);u=F.info();q.setParameter("fc_color",u.ambientColor);q.setParameter4("fc_vertex_color",u.colorMin,u.colorMax,u.colorRate,u.colorMerge);
q.setParameter4("fc_alpha",u.alphaBase,u.alphaRate,u.alphaLevel,u.alphaMerge);q.setParameter("fc_ambient_color",u.ambientColor);q.setParameter("fc_diffuse_color",u.diffuseColor);q.setParameter("fc_specular_color",u.specularColor);q.setParameter4("fc_specular",u.specularBase,u.specularLevel,u.specularAverage,u.specularShadow);q.setParameter("fc_specular_view_color",u.specularViewColor);q.setParameter4("fc_specular_view",u.specularViewBase,u.specularViewRate,u.specularViewAverage,u.specularViewShadow);
q.setParameter("fc_reflect_color",u.reflectColor);this.bindAttributes(f);q.setSampler("fs_light_depth",E.textureDepth());this.bindSamplers(f);h.drawTriangles(f.indexBuffer())}function FG3dShadowColorPass(b){b=RClass.inherits(this,b,FG3dTechniquePass);b._code="color";b._textureDepth=null;b.textureDepth=FG3dShadowColorPass_textureDepth;b.setTextureDepth=FG3dShadowColorPass_setTextureDepth;b.drawRegion=FG3dShadowColorPass_drawRegion;return b}
function FG3dShadowColorPass_textureDepth(){return this._textureDepth}function FG3dShadowColorPass_setTextureDepth(b){this._textureDepth=b}function FG3dShadowColorPass_drawRegion(b){this._context.setRenderTarget(null);var f=b._backgroundColor;this._context.clear(f.red,f.green,f.blue,f.alpha,1);this.__base.FG3dTechniquePass.drawRegion.call(this,b)}
function FG3dShadowColorSkeletonEffect(b){b=RClass.inherits(this,b,FG3dAutomaticEffect);b._code="shadow.color.skeleton";b._supportSkeleton=!0;b.drawRenderable=FG3dShadowColorSkeletonEffect_drawRenderable;return b}
function FG3dShadowColorSkeletonEffect_drawRenderable(b,f){var h=this._graphicContext,q=this._program,u=b.matrixViewProjection(),z=b.cameraPosition(),A=b.lightDirection();if(q.hasAttribute())for(var B=q.attributes(),C=B.count(),D=0;D<C;D++){var E=B.value(D);if(E._statusUsed){var F=f.findVertexBuffer(E._linker);if(null==F)throw new TError("Can't find renderable vertex buffer. (linker={1})",E._linker);q.setAttribute(E._name,F,F._formatCd)}}if(q.hasSampler())for(B=q.samplers(),C=B.count(),D=0;D<C;D++)if(E=
B.value(D),E._statusUsed){var F=E.linker(),G=f.findTexture(F);if(null!=G)q.setSampler(E.name(),G.texture());else throw new TError("Can't find sampler. (linker={1})",F);}q.setParameter("vc_model_matrix",f.currentMatrix());q.setParameter("vc_vp_matrix",u);q.setParameter("vc_camera_position",z);q.setParameter("vc_light_direction",A);q.setParameter("fc_camera_position",z);q.setParameter("fc_light_direction",A);u=f.material();u=u.info();q.setParameter("fc_color",u.ambientColor);q.setParameter4("fc_vertex_color",
u.colorMin,u.colorMax,u.colorRate,u.colorMerge);q.setParameter4("fc_alpha",u.alphaBase,u.alphaRate,u.alphaLevel,u.alphaMerge);q.setParameter("fc_ambient_color",u.ambientColor);q.setParameter("fc_diffuse_color",u.diffuseColor);q.setParameter("fc_specular_color",u.specularColor);q.setParameter4("fc_specular",u.specularBase,u.specularLevel,u.specularAverage,u.specularShadow);q.setParameter("fc_specular_view_color",u.specularViewColor);q.setParameter4("fc_specular_view",u.specularViewBase,u.specularViewRate,
u.specularViewAverage,u.specularViewShadow);q.setParameter("fc_reflect_color",u.reflectColor);if(z=f.bones()){A=z.count();32<A&&(A=32);D=RTypeArray.findTemp(EDataType.Float,16*A);for(B=0;B<A;B++)u=z.get(B).matrix(),u.writeData(D,16*B);q.setParameter("vc_bone_matrix",D)}q=f.indexBuffer();h.drawTriangles(q,0,q._count)}
function FG3dShadowDepthAutomaticEffect(b){b=RClass.inherits(this,b,FG3dAutomaticEffect);b._code="shadow.depth.automatic";b.drawRenderable=FG3dShadowDepthAutomaticEffect_drawRenderable;return b}
function FG3dShadowDepthAutomaticEffect_drawRenderable(b,f){var h=this._graphicContext,q=this._program,u=b.calculate(EG3dRegionParameter.LightViewMatrix),z=b.calculate(EG3dRegionParameter.LightViewProjectionMatrix),A=b.calculate(EG3dRegionParameter.LightInfo);h.setBlendFactors(!1);q.setParameter("vc_camera",A);q.setParameter("vc_model_matrix",f.currentMatrix());q.setParameter("vc_view_matrix",u);q.setParameter("vc_vp_matrix",z);q.setParameter("fc_camera",A);q.setParameter4("fc_alpha",0,0,0,.1);this.bindAttributes(f);
this.bindSamplers(f);h.drawTriangles(f.indexBuffer())}function FG3dShadowDepthPass(b){b=RClass.inherits(this,b,FG3dTechniquePass);b._code="depth";b._renderTarget=null;b._textureDepth=null;b._renderTarget=null;b.setup=FG3dShadowDepthPass_setup;b.textureDepth=FG3dShadowDepthPass_textureDepth;b.drawRegion=FG3dShadowDepthPass_drawRegion;return b}
function FG3dShadowDepthPass_setup(){this.__base.FG3dTechniquePass.setup.call(this);var b=this._context,f=this._textureDepth=b.createFlatTexture();f.setFilter(EG3dSamplerFilter.Linear,EG3dSamplerFilter.Linear);f.setWrap(EG3dSamplerFilter.ClampToEdge,EG3dSamplerFilter.ClampToEdge);b=this._renderTarget=b.createRenderTarget();b.size().set(2048,2048);b.textures().push(f);b.build()}function FG3dShadowDepthPass_textureDepth(){return this._textureDepth}
function FG3dShadowDepthPass_drawRegion(b){var f=this._context;this._finish?(f.setRenderTarget(null),f=b._backgroundColor,this._context.clear(f.red,f.green,f.blue,f.alpha,1)):(f.setRenderTarget(this._renderTarget),f.clear(0,0,0,1,1,1));b._textureDepth=this._textureDepth;this.__base.FG3dTechniquePass.drawRegion.call(this,b)}
function FG3dShadowDepthSkeletonEffect(b){b=RClass.inherits(this,b,FG3dAutomaticEffect);b._code="shadow.depth.skeleton";b._supportSkeleton=!0;b.drawRenderable=FG3dShadowDepthSkeletonEffect_drawRenderable;return b}
function FG3dShadowDepthSkeletonEffect_drawRenderable(b,f){var h=this._graphicContext,q=this._program;q.setParameter("vc_model_matrix",r.currentMatrix());q.setParameter("vc_vp_matrix",prvp);q.setParameter("vc_camera_position",prcp);q.setParameter("vc_light_direction",prld);q.setParameter("fc_camera_position",prcp);q.setParameter("fc_light_direction",prld);var u=r.material(),u=u.info();q.setParameter("fc_color",u.ambientColor);q.setParameter4("fc_vertex_color",u.colorMin,u.colorMax,u.colorRate,u.colorMerge);
q.setParameter4("fc_alpha",u.alphaBase,u.alphaRate,u.alphaLevel,u.alphaMerge);q.setParameter("fc_ambient_color",u.ambientColor);q.setParameter("fc_diffuse_color",u.diffuseColor);q.setParameter("fc_specular_color",u.specularColor);q.setParameter4("fc_specular",u.specularBase,u.specularRate,u.specularAverage,u.specularShadow);q.setParameter("fc_specular_view_color",u.specularViewColor);q.setParameter4("fc_specular_view",u.specularViewBase,u.specularViewRate,u.specularViewAverage,u.specularViewShadow);
q.setParameter("fc_reflect_color",u.reflectColor);var z=f.bones();if(z){var A=z.count();32<A&&(A=32);for(var B=RTypeArray.findTemp(EDataType.Float,16*A),C=0;C<A;C++)u=z.get(C).matrix(),u.writeData(B,16*C);q.setParameter("vc_bone_matrix",B)}this.bindAttributes(f);this.bindSamplers(f);h.drawTriangles(f.indexBuffer())}
function FG3dShadowTechnique(b){b=RClass.inherits(this,b,FG3dTechnique);b._code="shadow";b._passDepth=null;b._passColor=null;b.setup=FG3dShadowTechnique_setup;b.passDepth=FG3dShadowTechnique_passDepth;b.passColor=FG3dShadowTechnique_passColor;b.updateRegion=FG3dShadowTechnique_updateRegion;return b}
function FG3dShadowTechnique_setup(){this.__base.FG3dTechnique.setup.call(this);var b=this._passes,f=this._passDepth=RClass.create(FG3dShadowDepthPass);f.linkGraphicContext(this);f.setup();b.push(f);var h=this._passColor=RClass.create(FG3dShadowColorPass);h.linkGraphicContext(this);h.setup();b.push(h);h.setTextureDepth(f.textureDepth())}function FG3dShadowTechnique_passDepth(){return this._passDepth}function FG3dShadowTechnique_passColor(){return this._passColor}
function FG3dShadowTechnique_updateRegion(b){this.__base.FG3dTechnique.updateRegion.call(this,b);var f=b.camera();b.directionalLight().camera().updateFlatCamera(f)}
function FWglContext(b){b=RClass.inherits(this,b,FG3dContext);b._native=null;b._nativeInstance=null;b._nativeLayout=null;b._nativeDebugShader=null;b._activeRenderTarget=null;b._activeTextureSlot=null;b._parameters=null;b._extensions=null;b._data9=null;b._data16=null;b.construct=FWglContext_construct;b.linkCanvas=FWglContext_linkCanvas;b.parameters=FWglContext_parameters;b.extensions=FWglContext_extensions;b.createProgram=FWglContext_createProgram;b.createLayout=FWglContext_createLayout;b.createVertexBuffer=
FWglContext_createVertexBuffer;b.createIndexBuffer=FWglContext_createIndexBuffer;b.createFlatTexture=FWglContext_createFlatTexture;b.createCubeTexture=FWglContext_createCubeTexture;b.createRenderTarget=FWglContext_createRenderTarget;b.setViewport=FWglContext_setViewport;b.setFillMode=FWglContext_setFillMode;b.setDepthMode=FWglContext_setDepthMode;b.setCullingMode=FWglContext_setCullingMode;b.setBlendFactors=FWglContext_setBlendFactors;b.setScissorRectangle=FWglContext_setScissorRectangle;b.setRenderTarget=
FWglContext_setRenderTarget;b.setProgram=FWglContext_setProgram;b.bindConst=FWglContext_bindConst;b.bindVertexBuffer=FWglContext_bindVertexBuffer;b.bindTexture=FWglContext_bindTexture;b.clear=FWglContext_clear;b.clearColor=FWglContext_clearColor;b.clearDepth=FWglContext_clearDepth;b.drawTriangles=FWglContext_drawTriangles;b.present=FWglContext_present;b.checkError=FWglContext_checkError;return b}
function FWglContext_construct(){this.__base.FG3dContext.construct.call(this);this._capability=new SG3dContextCapability;this._data9=new Float32Array(9);this._data16=new Float32Array(16)}
function FWglContext_linkCanvas(b){this.__base.FG3dContext.linkCanvas.call(this,b);this._hCanvas=b;if(b.getContext){var f={};f.alpha=this._optionAlpha;f.antialias=this._optionAntialias;var h=b.getContext("experimental-webgl",f);null==h&&(h=b.getContext("webgl",f));if(null==h)throw new TError("Current browser can't support WebGL technique.");this._native=h;this._contextAttributes=h.getContextAttributes()}f=this._native;this.setViewport(b.width,b.height);this.setDepthMode(!0,EG3dDepthMode.LessEqual);
this.setCullingMode(!0,EG3dCullMode.Front);b=this._capability;b.vendor=f.getParameter(f.VENDOR);b.version=f.getParameter(f.VERSION);b.shaderVersion=f.getParameter(f.SHADING_LANGUAGE_VERSION);b.attributeCount=f.getParameter(f.MAX_VERTEX_ATTRIBS);b.vertexConst=f.getParameter(f.MAX_VERTEX_UNIFORM_VECTORS);b.varyingCount=f.getParameter(f.MAX_VARYING_VECTORS);b.fragmentConst=f.getParameter(f.MAX_FRAGMENT_UNIFORM_VECTORS);b.samplerCount=f.getParameter(f.MAX_VERTEX_TEXTURE_IMAGE_UNITS);b.samplerSize=f.getParameter(f.MAX_TEXTURE_SIZE);
if(h=this._nativeInstance=f.getExtension("ANGLE_instanced_arrays"))b.optionInstance=!0;b.mergeCount=parseInt((b.vertexConst-32)/4);if(h=this._nativeLayout=f.getExtension("OES_vertex_array_object"))b.optionLayout=!0;if(h=f.getExtension("OES_element_index_uint"))b.optionIndex32=!0;if(h=this._nativeSamplerS3tc=f.getExtension("WEBGL_compressed_texture_s3tc"))b.samplerCompressRgb=h.COMPRESSED_RGB_S3TC_DXT1_EXT,b.samplerCompressRgba=h.COMPRESSED_RGBA_S3TC_DXT5_EXT;var h=b.shader={},q=h.vertexPrecision=
{};q.floatLow=f.getShaderPrecisionFormat(f.VERTEX_SHADER,f.LOW_FLOAT);q.floatMedium=f.getShaderPrecisionFormat(f.VERTEX_SHADER,f.MEDIUM_FLOAT);q.floatHigh=f.getShaderPrecisionFormat(f.VERTEX_SHADER,f.HIGH_FLOAT);q.intLow=f.getShaderPrecisionFormat(f.VERTEX_SHADER,f.LOW_INT);q.intMedium=f.getShaderPrecisionFormat(f.VERTEX_SHADER,f.MEDIUM_INT);q.intHigh=f.getShaderPrecisionFormat(f.VERTEX_SHADER,f.HIGH_INT);h=h.fragmentPrecision={};h.floatLow=f.getShaderPrecisionFormat(f.FRAGMENT_SHADER,f.LOW_FLOAT);
h.floatMedium=f.getShaderPrecisionFormat(f.FRAGMENT_SHADER,f.MEDIUM_FLOAT);h.floatHigh=f.getShaderPrecisionFormat(f.FRAGMENT_SHADER,f.HIGH_FLOAT);h.intLow=f.getShaderPrecisionFormat(f.FRAGMENT_SHADER,f.LOW_INT);h.intMedium=f.getShaderPrecisionFormat(f.FRAGMENT_SHADER,f.MEDIUM_INT);h.intHigh=f.getShaderPrecisionFormat(f.FRAGMENT_SHADER,f.HIGH_INT);if(h=this._nativeDebugShader=f.getExtension("WEBGL_debug_shaders"))b.optionShaderSource=!0}
function FWglContext_parameters(){var b=this._parameters;if(b)return b;for(var f="ACTIVE_TEXTURE ALIASED_LINE_WIDTH_RANGE ALIASED_POINT_SIZE_RANGE ALPHA_BITS ARRAY_BUFFER_BINDING BLEND BLEND_COLOR BLEND_DST_ALPHA BLEND_DST_RGB BLEND_EQUATION_ALPHA BLEND_EQUATION_RGB BLEND_SRC_ALPHA BLEND_SRC_RGB BLUE_BITS COLOR_CLEAR_VALUE COLOR_WRITEMASK COMPRESSED_TEXTURE_FORMATS CULL_FACE CULL_FACE_MODE CURRENT_PROGRAM DEPTH_BITS DEPTH_CLEAR_VALUE DEPTH_FUNC DEPTH_RANGE DEPTH_TEST DEPTH_WRITEMASK DITHER ELEMENT_ARRAY_BUFFER_BINDING FRAMEBUFFER_BINDING FRONT_FACE GENERATE_MIPMAP_HINT GREEN_BITS IMPLEMENTATION_COLOR_READ_FORMAT IMPLEMENTATION_COLOR_READ_TYPE LINE_WIDTH MAX_COMBINED_TEXTURE_IMAGE_UNITS MAX_CUBE_MAP_TEXTURE_SIZE MAX_FRAGMENT_UNIFORM_VECTORS MAX_RENDERBUFFER_SIZE MAX_TEXTURE_IMAGE_UNITS MAX_TEXTURE_SIZE MAX_VARYING_VECTORS MAX_VERTEX_ATTRIBS MAX_VERTEX_TEXTURE_IMAGE_UNITS MAX_VERTEX_UNIFORM_VECTORS MAX_VIEWPORT_DIMS PACK_ALIGNMENT POLYGON_OFFSET_FACTOR POLYGON_OFFSET_FILL POLYGON_OFFSET_UNITS RED_BITS RENDERBUFFER_BINDING RENDERER SAMPLE_BUFFERS SAMPLE_COVERAGE_INVERT SAMPLE_COVERAGE_VALUE SAMPLES SCISSOR_BOX SCISSOR_TEST SHADING_LANGUAGE_VERSION STENCIL_BACK_FAIL STENCIL_BACK_FUNC STENCIL_BACK_PASS_DEPTH_FAIL STENCIL_BACK_PASS_DEPTH_PASS STENCIL_BACK_REF STENCIL_BACK_VALUE_MASK STENCIL_BACK_WRITEMASK STENCIL_BITS STENCIL_CLEAR_VALUE STENCIL_FAIL STENCIL_FUNC STENCIL_PASS_DEPTH_FAIL STENCIL_PASS_DEPTH_PASS STENCIL_REF STENCIL_TEST STENCIL_VALUE_MASK STENCIL_WRITEMASK SUBPIXEL_BITS TEXTURE_BINDING_2D TEXTURE_BINDING_CUBE_MAP UNPACK_ALIGNMENT UNPACK_COLORSPACE_CONVERSION_WEBGL UNPACK_FLIP_Y_WEBGL UNPACK_PREMULTIPLY_ALPHA_WEBGL VENDOR VERSION VIEWPORT".split(" "),
h=this._native,q=f.length,b={},u=0;u<q;u++){var z=f[u];b[z]=h.getParameter(h[z])}if(f=h.getExtension("WEBGL_debug_renderer_info"))b.UNMASKED_RENDERER_WEBGL=h.getParameter(f.UNMASKED_RENDERER_WEBGL),b.UNMASKED_VENDOR_WEBGL=h.getParameter(f.UNMASKED_VENDOR_WEBGL);return this._parameters=b}function FWglContext_extensions(){var b=this._extensions;if(!b)for(var b=this._extensions={},f=this._native,h=f.getSupportedExtensions(),q=h.length,u=0;u<q;u++){var z=h[u];b[z]=f.getExtension(z)}return b}
function FWglContext_createProgram(){var b=RClass.create(FWglProgram);b.linkGraphicContext(this);b.setup();this._statistics._programTotal++;return b}function FWglContext_createLayout(){if(!this._capability.optionLayout)throw new TError(this,"Unsupport layout.");var b=RClass.create(FWglLayout);b.linkGraphicContext(this);b.setup();this._statistics._layoutTotal++;return b}
function FWglContext_createVertexBuffer(){var b=RClass.create(FWglVertexBuffer);b.linkGraphicContext(this);b.setup();this._statistics._vertexBufferTotal++;return b}function FWglContext_createIndexBuffer(){var b=RClass.create(FWglIndexBuffer);b.linkGraphicContext(this);b.setup();this._statistics._indexBufferTotal++;return b}function FWglContext_createFlatTexture(){var b=RClass.create(FWglFlatTexture);b.linkGraphicContext(this);b.setup();this._statistics._flatTextureTotal++;return b}
function FWglContext_createCubeTexture(){var b=RClass.create(FWglCubeTexture);b.linkGraphicContext(this);b.setup();this._statistics._cubeTextureTotal++;return b}function FWglContext_createRenderTarget(){var b=RClass.create(FWglRenderTarget);b.linkGraphicContext(this);b.setup();this._statistics._targetTotal++;return b}function FWglContext_setViewport(b,f,h,q){this._size.set(h,q);this._native.viewport(b,f,h,q)}
function FWglContext_setFillMode(b){var f=this._native;if(this._fillModeCd!=b){this._statistics._frameFillModeCount++;switch(b){case EG3dFillMode.Point:f.polygonMode(f.FRONT_AND_BACK,f.POINT);break;case EG3dFillMode.Line:f.polygonMode(f.FRONT_AND_BACK,f.LINE);break;case EG3dFillMode.Face:f.polygonMode(f.FRONT,f.FILL);break;default:throw new TError("Invalid parameter. (fill_mode={1})",b);}this._fillModeCd=b;return!0}}
function FWglContext_setDepthMode(b,f){var h=this._native;if(this._optionDepth==b&&this._depthModeCd==f)return!0;this._statistics._frameDepthModeCount++;this._optionDepth!=b&&(b?h.enable(h.DEPTH_TEST):h.disable(h.DEPTH_TEST),this._optionDepth=b);if(b&&this._depthModeCd!=f){var q=RWglUtility.convertDepthMode(h,f);h.depthFunc(q);this._depthModeCd=f}return!0}
function FWglContext_setCullingMode(b,f){var h=this._native;if(this._optionCull==b&&this._cullModeCd==f)return!0;this._statistics._frameCullModeCount++;this._optionCull!=b&&(b?h.enable(h.CULL_FACE):h.disable(h.CULL_FACE),this._optionCull=b);if(b&&this._cullModeCd!=f){var q=RWglUtility.convertCullMode(h,f);h.cullFace(q);this._cullModeCd=f}return!0}
function FWglContext_setBlendFactors(b,f,h){var q=this._native;if(this._statusBlend==b&&this._blendSourceCd==f&&this._blendTargetCd==h)return!0;this._statistics._frameBlendModeCount++;this._statusBlend!=b&&(b?q.enable(q.BLEND):(q.disable(q.BLEND),this._blendTargetCd=this._blendSourceCd=0),this._statusBlend=b);if(b&&(this._blendSourceCd!=f||this._blendTargetCd!=h)){b=RWglUtility.convertBlendFactors(q,f);var u=RWglUtility.convertBlendFactors(q,h);q.blendFunc(b,u);this._blendSourceCd=f;this._blendTargetCd=
h}return!0}function FWglContext_setScissorRectangle(b,f,h,q){this._native.scissor(b,f,h,q)}
function FWglContext_setRenderTarget(b){var f=this._native;if(this._activeRenderTarget!=b){this._statistics._frameTargetCount++;var h=!0;if(null==b){f.bindFramebuffer(f.FRAMEBUFFER,null);h=this.checkError("glBindFramebuffer","Bind frame buffer. (frame_buffer={1})",null);if(!h)return h;f.viewport(0,0,this._size.width,this._size.height)}else{f.bindFramebuffer(f.FRAMEBUFFER,b._native);result=this.checkError("glBindFramebuffer","Bind frame buffer. (frame_buffer={1})",b._native);if(!h)return h;h=b.size();
f.viewport(0,0,h.width,h.height)}this._activeRenderTarget=b}}function FWglContext_setProgram(b){var f=this._native;if(this._program!=b)return this._statistics._frameProgramCount++,b?f.useProgram(b._native):f.useProgram(null),this._program=b,this.checkError("useProgram","Set program failure. (program={1}, program_native={2})",b,b._native)}
function FWglContext_bindConst(b,f,h,q,u){var z=this._native,A=!0;this._statistics._frameConstCount++;switch(h){case EG3dParameterFormat.Float1:z.uniform1fv(f,q);this._statistics._frameConstLength+=q.byteLength;A=this.checkError("uniform1fv","Bind const data failure. (shader_cd={1}, slot={2}, data={3}, count={4})",b,f,q,u);break;case EG3dParameterFormat.Float2:z.uniform2fv(f,q);this._statistics._frameConstLength+=q.byteLength;A=this.checkError("uniform2fv","Bind const data failure. (shader_cd={1}, slot={2}, data={3}, count={4})",
b,f,q,u);break;case EG3dParameterFormat.Float3:z.uniform3fv(f,q);this._statistics._frameConstLength+=q.byteLength;A=this.checkError("uniform3fv","Bind const data failure. (shader_cd={1}, slot={2}, data={3}, count={4})",b,f,q,u);break;case EG3dParameterFormat.Float4:z.uniform4fv(f,q);this._statistics._frameConstLength+=q.byteLength;A=this.checkError("uniform4fv","Bind const data failure. (shader_cd={1}, slot={2}, data={3}, count={4})",b,f,q,u);break;case EG3dParameterFormat.Float3x3:var B=this._data9;
B[0]=q[0];B[1]=q[4];B[2]=q[8];B[3]=q[1];B[4]=q[5];B[5]=q[9];B[6]=q[2];B[7]=q[6];B[8]=q[10];z.uniformMatrix3fv(f,z.FALSE,B);this._statistics._frameConstLength+=B.byteLength;A=this.checkError("uniformMatrix3fv","Bind const matrix3x3 failure. (shader_cd={1}, slot={2}, data={3}, count={4})",b,f,q,u);break;case EG3dParameterFormat.Float4x3:z.uniform4fv(f,z.FALSE,pd);this._statistics._frameConstLength+=B.byteLength;A=this.checkError("uniform4fv","Bind const matrix4x3 failure. (shader_cd={1}, slot={2}, data={3}, count={4})",
b,f,q,u);break;case EG3dParameterFormat.Float4x4:h=null;if(q.constructor==Float32Array)h=q;else if(q.writeData)h=this._data16,q.writeData(h,0);else throw new TError("Unknown data type.");z.uniformMatrix4fv(f,z.FALSE,h);this._statistics._frameConstLength+=h.byteLength;A=this.checkError("uniformMatrix4fv","Bind const matrix4x4 failure. (shader_cd=%d, slot=%d, pData=0x%08X, count=%d)",b,f,q,u)}return A}
function FWglContext_bindVertexBuffer(b,f,h,q){var u=this._native,z=!0;this._statistics._frameBufferCount++;z=null;null!=f&&(z=f._native);u.bindBuffer(u.ARRAY_BUFFER,z);z=this.checkError("bindBuffer","Bind buffer. (buffer_id=%d)",z);if(!z)return z;if(null!=f){if(u.enableVertexAttribArray(b),z=this.checkError("enableVertexAttribArray","Enable vertex attribute array. (slot=%d)",b),!z)return z}else return u.disableVertexAttribArray(b),z=this.checkError("disableVertexAttribArray","Disable vertex attribute array. (slot=%d)",
b);f=f._stride;switch(q){case EG3dAttributeFormat.Float1:u.vertexAttribPointer(b,1,u.FLOAT,!1,f,h);break;case EG3dAttributeFormat.Float2:u.vertexAttribPointer(b,2,u.FLOAT,!1,f,h);break;case EG3dAttributeFormat.Float3:u.vertexAttribPointer(b,3,u.FLOAT,!1,f,h);break;case EG3dAttributeFormat.Float4:u.vertexAttribPointer(b,4,u.FLOAT,!1,f,h);break;case EG3dAttributeFormat.Byte4:u.vertexAttribPointer(b,4,u.UNSIGNED_BYTE,!1,f,h);break;case EG3dAttributeFormat.Byte4Normal:u.vertexAttribPointer(b,4,u.UNSIGNED_BYTE,
!0,f,h);break;default:throw new TError(this,"Unknown vertex format. (format_cd=%d)",formatCd);}return z=this.checkError("glVertexAttribPointer","Bind vertex attribute pointer. (slot=%d, format_cd=%d)",b,q)}
function FWglContext_bindTexture(b,f,h){var q=this._native,u=!0;this._statistics._frameTextureCount++;if(null==h)return q.bindTexture(q.TEXTURE_2D,null),u=this.checkError("bindTexture","Bind texture clear failure. (slot=%d)",b);if(this._activeTextureSlot!=b&&(q.uniform1i(b,f),q.activeTexture(q.TEXTURE0+f),u=this.checkError("activeTexture","Active texture failure. (slot=%d, index=%d)",b,f),!u))return u;b=null;switch(h.textureCd()){case EG3dTexture.Flat2d:b=q.TEXTURE_2D;q.bindTexture(q.TEXTURE_2D,h._native);
u=this.checkError("glBindTexture","Bind flag texture failure. (texture_id=%d)",h._native);if(!u)return u;break;case EG3dTexture.Cube:b=q.TEXTURE_CUBE_MAP;q.bindTexture(q.TEXTURE_CUBE_MAP,h._native);u=this.checkError("glBindTexture","Bind cube texture failure. (texture_id=%d)",h._native);if(!u)return u;break;default:RLogger.fatal(this,null,"Unknown texture type.")}(f=RWglUtility.convertSamplerFilter(q,h.filterMinCd()))&&q.texParameteri(b,q.TEXTURE_MIN_FILTER,f);(f=RWglUtility.convertSamplerFilter(q,
h.filterMagCd()))&&q.texParameteri(b,q.TEXTURE_MAG_FILTER,f);RWglUtility.convertSamplerFilter(q,h.wrapS());RWglUtility.convertSamplerFilter(q,h.wrapT());return u}function FWglContext_clear(b,f,h,q,u){var z=this._native;z.clearColor(b,f,h,q);z.clearDepth(u);z.clear(z.COLOR_BUFFER_BIT|z.DEPTH_BUFFER_BIT);this._statistics._frameClearCount++}function FWglContext_clearColor(b,f,h,q){var u=this._native;u.clearColor(b,f,h,q);u.clear(u.COLOR_BUFFER_BIT);this._statistics._frameClearCount++}
function FWglContext_clearDepth(b){var f=this._native;f.clearDepth(b);f.clear(f.DEPTH_BUFFER_BIT);this._statistics._frameClearCount++}
function FWglContext_drawTriangles(b,f,h){var q=this._native,u=!0;null==f&&(f=0);null==h&&(h=b.count());q.bindBuffer(q.ELEMENT_ARRAY_BUFFER,b._native);u=this.checkError("bindBuffer","Bind element array buffer failure. (index=0x%08X, offset=%d, count=%d, buffer_id)",b,f,h,b._native);if(!u)return u;u=RWglUtility.convertIndexStride(q,b.strideCd());b._fillMode==EG3dFillMode.Line?q.drawElements(q.LINES,h,u,2*f):q.drawElements(q.TRIANGLES,h,u,2*f);this._statistics._frameTriangleCount+=h;this._statistics._frameDrawCount++;
u=this.checkError("drawElements","Draw triangles failure. (index=0x%08X, offset=%d, count=%d)",b,f,h);if(!u)return u;q.bindBuffer(q.ELEMENT_ARRAY_BUFFER,null);return u=this.checkError("bindBuffer","Bind element array buffer failure. (index=0x%08X, offset=%d, count=%d)",b,f,h)}function FWglContext_present(){}
function FWglContext_checkError(b,f,h){if(!this._capability.optionDebug||!RRuntime.isDebug())return!0;b=this._native;f=!1;for(var q=h=null;;){h=b.getError();if(h==b.NO_ERROR){f=!0;break}switch(h){case b.INVALID_OPERATION:q="Invalid operation.";break;case b.INVALID_ENUM:q="Invalid enum.";break;case b.INVALID_VALUE:q="Invalid value.";break;case b.INVALID_FRAMEBUFFER_OPERATION:q="Invalid paramebuffer opeartion.";break;case b.OUT_OF_MEMORY:q="Out of memory.";break;default:q="Unknown"}}f||RLogger.fatal(this,
null,"OpenGL check failure. (code={1}, description={2})",h,q);return f}function FWglCubeTexture(b){b=RClass.inherits(this,b,FG3dCubeTexture);b._native=null;b.setup=FWglCubeTexture_setup;b.isValid=FWglCubeTexture_isValid;b.makeMipmap=FWglCubeTexture_makeMipmap;b.upload=FWglCubeTexture_upload;b.dispose=FWglCubeTexture_dispose;return b}function FWglCubeTexture_setup(){var b=this._graphicContext._native;this.__base.FG3dCubeTexture.setup.call(this);this._native=b.createTexture()}
function FWglCubeTexture_isValid(){return this._graphicContext._native.isTexture(this._native)}function FWglCubeTexture_makeMipmap(){var b=this._graphicContext._native;b.bindTexture(b.TEXTURE_CUBE_MAP,this._native);b.generateMipmap(b.TEXTURE_CUBE_MAP)}
function FWglCubeTexture_upload(b,f,h,q,u,z){var A=this._graphicContext,B=A._native;B.bindTexture(B.TEXTURE_CUBE_MAP,this._native);B.texImage2D(B.TEXTURE_CUBE_MAP_POSITIVE_X,0,B.RGB,B.RGB,B.UNSIGNED_BYTE,b.image());B.texImage2D(B.TEXTURE_CUBE_MAP_NEGATIVE_X,0,B.RGB,B.RGB,B.UNSIGNED_BYTE,f.image());B.texImage2D(B.TEXTURE_CUBE_MAP_POSITIVE_Y,0,B.RGB,B.RGB,B.UNSIGNED_BYTE,h.image());B.texImage2D(B.TEXTURE_CUBE_MAP_NEGATIVE_Y,0,B.RGB,B.RGB,B.UNSIGNED_BYTE,q.image());B.texImage2D(B.TEXTURE_CUBE_MAP_POSITIVE_Z,
0,B.RGB,B.RGB,B.UNSIGNED_BYTE,u.image());B.texImage2D(B.TEXTURE_CUBE_MAP_NEGATIVE_Z,0,B.RGB,B.RGB,B.UNSIGNED_BYTE,z.image());this._statusLoad=A.checkError("texImage2D","Upload cube image failure.")}function FWglCubeTexture_dispose(){var b=this._graphicContext,f=this._native;f&&(b._native.deleteTexture(f),this._native=null);this.__base.FG3dCubeTexture.dispose.call(this)}
function FWglFlatTexture(b){b=RClass.inherits(this,b,FG3dFlatTexture);b._native=null;b.setup=FWglFlatTexture_setup;b.isValid=FWglFlatTexture_isValid;b.makeMipmap=FWglFlatTexture_makeMipmap;b.uploadData=FWglFlatTexture_uploadData;b.upload=FWglFlatTexture_upload;b.dispose=FWglFlatTexture_dispose;return b}function FWglFlatTexture_setup(){var b=this._graphicContext._native;this.__base.FG3dFlatTexture.setup.call(this);this._native=b.createTexture()}
function FWglFlatTexture_isValid(){return this._graphicContext._native.isTexture(this._native)}function FWglFlatTexture_makeMipmap(){var b=this._graphicContext._native;b.bindTexture(b.TEXTURE_2D,this._native);b.generateMipmap(b.TEXTURE_2D)}
function FWglFlatTexture_uploadData(b,f,h){var q=this._graphicContext,u=q._native,z=null;if(b.constructor==ArrayBuffer)z=new Uint8Array(b);else if(b.constructor==Uint8Array)z=b;else throw new TError("Invalid data format.");this.width=f;this.height=h;u.bindTexture(u.TEXTURE_2D,this._native);u.texImage2D(u.TEXTURE_2D,0,u.RGBA,f,h,0,u.RGBA,u.UNSIGNED_BYTE,z);this._statusLoad=q.checkError("texImage2D","Upload data failure.")}
function FWglFlatTexture_upload(b){var f=this._graphicContext;f.capability();var h=f._native,q=null;if(b.constructor==Image)q=b;else if(RClass.isClass(b,FImage))q=b.image(),b.optionAlpha();else throw new TError("Invalid image format.");h.bindTexture(h.TEXTURE_2D,this._native);h.texImage2D(h.TEXTURE_2D,0,h.RGBA,h.RGBA,h.UNSIGNED_BYTE,q);this._statusLoad=f.checkError("texImage2D","Upload image failure.")}
function FWglFlatTexture_dispose(){var b=this._graphicContext,f=this._native;f&&(b._native.deleteTexture(f),this._native=null);this.__base.FG3dFlatTexture.dispose.call(this)}function FWglFragmentShader(b){b=RClass.inherits(this,b,FG3dFragmentShader);b._native=null;b.setup=FWglFragmentShader_setup;b.targetSource=FWglFragmentShader_targetSource;b.upload=FWglFragmentShader_upload;b.dispose=FWglFragmentShader_dispose;return b}
function FWglFragmentShader_setup(){this.__base.FG3dFragmentShader.setup.call(this);var b=this._graphicContext._native;this._native=b.createShader(b.FRAGMENT_SHADER)}function FWglFragmentShader_targetSource(){var b=this._graphicContext;return b.capability().optionShaderSource?b._nativeDebugShader.getTranslatedShaderSource(this._native):this._source}
function FWglFragmentShader_upload(b){var f=this._graphicContext._native,h=this._native;f.shaderSource(h,b);f.compileShader(h);if(!f.getShaderParameter(h,f.COMPILE_STATUS)){var q=f.getShaderInfoLog(h);f.deleteShader(h);this._native=null;throw new TError(this,"Upload fragment shader source failure. (error={1})\n{2}",q,b);}this._source=b;return!0}
function FWglFragmentShader_dispose(){var b=this._graphicContext,f=this._native;f&&(b._native.deleteShader(f),this._native=null);this.__base.FG3dFragmentShader.dispose.call(this)}function FWglIndexBuffer(b){b=RClass.inherits(this,b,FG3dIndexBuffer);b._native=null;b.setup=FWglIndexBuffer_setup;b.isValid=FWglIndexBuffer_isValid;b.upload=FWglIndexBuffer_upload;b.dispose=FWglIndexBuffer_dispose;return b}
function FWglIndexBuffer_setup(){this.__base.FG3dIndexBuffer.setup.call(this);this._native=this._graphicContext._native.createBuffer()}function FWglIndexBuffer_isValid(){return this._graphicContext._native.isBuffer(this._native)}
function FWglIndexBuffer_upload(b,f){var h=this._graphicContext,q=h._native;this._count=f;var u=null;if(b.constructor==Array||b.constructor==ArrayBuffer)if(this._strideCd==EG3dIndexStride.Uint16)u=new Uint16Array(b);else if(this._strideCd==EG3dIndexStride.Uint32)u=new Uint32Array(b);else throw new TError(this,"Index stride is invalid.");else if(b.constructor==Uint16Array){if(this._strideCd!=EG3dIndexStride.Uint16)throw new TError(this,"Index stride16 is invalid.");u=b}else if(b.constructor==Uint32Array){if(this._strideCd!=
EG3dIndexStride.Uint32)throw new TError(this,"Index stride16 is invalid.");u=b}else throw new TError(this,"Upload index data type is invalid. (value={1})",b);q.bindBuffer(q.ELEMENT_ARRAY_BUFFER,this._native);h.checkError("bindBuffer","Bind buffer failure.");q.bufferData(q.ELEMENT_ARRAY_BUFFER,u,q.STATIC_DRAW);h.checkError("bufferData","Upload buffer data. (count={1})",f)}
function FWglIndexBuffer_dispose(){var b=this._graphicContext,f=this._native;f&&(b._native.deleteBuffer(f),this._native=null);this.__base.FG3dIndexBuffer.dispose.call(this)}function FWglLayout(b){b=RClass.inherits(this,b,FG3dLayout);b._native=null;b.setup=FWglLayout_setup;b.bind=FWglLayout_bind;b.unbind=FWglLayout_unbind;b.active=FWglLayout_active;b.deactive=FWglLayout_deactive;b.dispose=FWglLayout_dispose;return b}
function FWglLayout_setup(){this.__base.FG3dLayout.setup.call(this);this._native=this._graphicContext._nativeLayout.createVertexArrayOES()}function FWglLayout_bind(){this._graphicContext._nativeLayout.bindVertexArrayOES(this._native)}function FWglLayout_unbind(){this._graphicContext._nativeLayout.bindVertexArrayOES(null)}function FWglLayout_active(){this._graphicContext._nativeLayout.bindVertexArrayOES(this._native)}
function FWglLayout_deactive(){this._graphicContext._nativeLayout.bindVertexArrayOES(null)}function FWglLayout_dispose(){var b=this._graphicContext,f=this._native;f&&(b._nativeLayout.deleteVertexArrayOES(f),this._native=null);this.__base.FG3dLayout.dispose.call(this)}
function FWglProgram(b){b=RClass.inherits(this,b,FG3dProgram);b._native=null;b.setup=FWglProgram_setup;b.vertexShader=FWglProgram_vertexShader;b.fragmentShader=FWglProgram_fragmentShader;b.upload=FWglProgram_upload;b.build=FWglProgram_build;b.link=FWglProgram_link;b.dispose=FWglProgram_dispose;return b}function FWglProgram_setup(){this._native=(g=this._graphicContext)._native.createProgram()}
function FWglProgram_vertexShader(){var b=this._vertexShader;b||(b=this._vertexShader=RClass.create(FWglVertexShader),b.linkGraphicContext(this),b.setup());return b}function FWglProgram_fragmentShader(){var b=this._fragmentShader;b||(b=this._fragmentShader=RClass.create(FWglFragmentShader),b.linkGraphicContext(this),b.setup());return b}
function FWglProgram_upload(b,f){if(b==EG3dShader.Vertex)this.vertexShader().upload(f);else if(b==EG3dShader.Fragment)this.fragmentShader().upload(f);else throw Error("Unknown type");}
function FWglProgram_build(){var b=this._graphicContext,f=b._native,h=this._native,q=this.vertexShader();f.attachShader(h,q._native);var u=b.checkError("attachShader","Attach shader failure. (program_id=%d, shader_id=%d)",h,q._native);if(!u)return u;q=this.fragmentShader();f.attachShader(h,q._native);u=b.checkError("attachShader","Attach shader failure. (program_id=%d, shader_id=%d)",h,q._native);if(!u)return u;if(this.hasAttribute())for(var q=this.attributes(),z=q.count(),A=0;A<z;A++)if(u=q.value(A).name(),
f.bindAttribLocation(h,A,u),u=b.checkError("bindAttribLocation","Bind attribute location. (program_id=%d, slot=%d, name=%s)",h,A,u),!u)return u}
function FWglProgram_link(){var b=this._graphicContext,f=b._native,h=!1,q=this._native;f.linkProgram(q);h=f.getProgramParameter(q,f.LINK_STATUS);if(!h)return b=f.getProgramInfoLog(q),RLogger.fatal(this,null,"Link program failure. (status={1}, reason={2})",h,b),f.deleteProgram(this._native),this._native=null,!1;f.validateProgram(q);(h=f.getProgramParameter(q,f.VALIDATE_STATUS))||f.getProgramInfoLog(q);f.finish();h=b.checkError("finish","Finish program link faliure. (program_id={1})",q);if(!h)return h;
if(this.hasParameter())for(var u=this._parameters.count(),z=0;z<u;z++){var A=this._parameters.value(z),B=f.getUniformLocation(q,A.name()),h=b.checkError("getUniformLocation","Find parameter slot. (program_id=%d, name=%s, slot=%d)",q,A.name(),B);if(!h)return h;A._slot=B;null!=B&&(A._statusUsed=!0)}if(this.hasAttribute())for(u=this._attributes.count(),z=0;z<u;z++){A=this._attributes.value(z);B=f.getAttribLocation(q,A.name());h=b.checkError("getAttribLocation","Find attribute slot. (program_id=%d, name=%s, slot=%d)",
q,A.name(),B);if(!h)return h;A._slot=B;-1!=B&&(A._statusUsed=!0)}if(this.hasSampler()){u=this._samplers.count();for(z=0;z<u;z++){A=this._samplers.value(z);B=f.getUniformLocation(q,A.name());h=b.checkError("getUniformLocation","Find sampler slot. (program_id=%d, name=%s, slot=%d)",q,A.name(),B);if(!h)return h;A._slot=B;null!=B&&(A._statusUsed=!0)}for(z=f=0;z<u;z++)A=this._samplers.value(z),A._statusUsed&&(A._index=f++)}return h}
function FWglProgram_dispose(){var b=this._graphicContext,f=this._native;f&&(b._native.deleteProgram(f),this._native=null);this.__base.FProgram3d.dispose.call(this)}function FWglRenderTarget(b){b=RClass.inherits(this,b,FG3dRenderTarget);b._optionDepth=!0;b._native=null;b._nativeDepth=null;b.setup=FWglRenderTarget_setup;b.build=FWglRenderTarget_build;b.dispose=FWglRenderTarget_dispose;return b}
function FWglRenderTarget_setup(){this.__base.FG3dRenderTarget.setup.call(this);var b=this._graphicContext;this._native=b._native.createFramebuffer();return b.checkError("createFramebuffer","Create frame buffer failure.")}
function FWglRenderTarget_build(){var b=this._size,f=this._graphicContext,h=f._native;h.bindFramebuffer(h.FRAMEBUFFER,this._native);var q=f.checkError("bindFramebuffer","Bind frame buffer failure.");if(!q)return q;if(this._optionDepth){var u=this._nativeDepth=h.createRenderbuffer(),q=f.checkError("createRenderbuffer","Create render buffer failure.");if(!q)return q;h.bindRenderbuffer(h.RENDERBUFFER,u);q=f.checkError("bindRenderbuffer","Bind render buffer failure.");if(!q)return q;h.renderbufferStorage(h.RENDERBUFFER,
h.DEPTH_COMPONENT16,b.width,b.height);q=f.checkError("renderbufferStorage","Set render buffer storage format failure.");if(!q)return q;h.framebufferRenderbuffer(h.FRAMEBUFFER,h.DEPTH_ATTACHMENT,h.RENDERBUFFER,u);q=f.checkError("framebufferRenderbuffer","Set depth buffer to frame buffer failure. (framebuffer=%d, depthbuffer=%d)",this._native,u);if(!q)return q}for(var u=this._textures,z=u.count(),A=0;A<z;A++){var B=u.get(A);h.bindTexture(h.TEXTURE_2D,B._native);h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,
h.LINEAR);h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,h.LINEAR);h.texImage2D(h.TEXTURE_2D,0,h.RGBA,b.width,b.height,0,h.RGBA,h.UNSIGNED_BYTE,null);q=f.checkError("texImage2D","Alloc texture storage. (texture_id, size=%dx%d)",B._native,this._size.width,this._size.height);if(!q)return q;h.framebufferTexture2D(h.FRAMEBUFFER,h.COLOR_ATTACHMENT0+A,h.TEXTURE_2D,B._native,0);q=f.checkError("framebufferTexture2D","Set color buffer into frame buffer failure. (framebuffer_id=%d, texture_id=%d)",this._native,
B._native);if(!q)return q}}function FWglRenderTarget_dispose(){var b=this._graphicContext,f=this._nativeDepth;f&&(b._native.deleteRenderbuffer(f),this._nativeDepth=null);if(f=this._native)b._native.deleteFramebuffer(f),this._native=null;this.__base.FG3dRenderTarget.dispose.call(this)}
function FWglVertexBuffer(b){b=RClass.inherits(this,b,FG3dVertexBuffer);b._native=null;b.setup=FWglVertexBuffer_setup;b.isValid=FWglVertexBuffer_isValid;b.upload=FWglVertexBuffer_upload;b.dispose=FWglVertexBuffer_dispose;return b}function FWglVertexBuffer_setup(){this.__base.FG3dVertexBuffer.setup.call(this);this._native=this._graphicContext._native.createBuffer()}function FWglVertexBuffer_isValid(){return this._graphicContext._native.isBuffer(this._native)}
function FWglVertexBuffer_upload(b,f,h){var q=this._graphicContext,u=q._native;this._stride=f;this._count=h;f=null;if(b.constructor==Array||b.constructor==ArrayBuffer)f=new Float32Array(b);else if(b.constructor==Uint8Array)f=b;else if(b.constructor==Float32Array)f=b;else throw new TError(this,"Upload vertex data type is invalid. (data={1})",b);u.bindBuffer(u.ARRAY_BUFFER,this._native);q.checkError("bindBuffer","Bindbuffer");u.bufferData(u.ARRAY_BUFFER,f,u.STATIC_DRAW);q.checkError("bufferData","bufferData")}
function FWglVertexBuffer_dispose(){var b=this._graphicContext,f=this._native;f&&(b._native.deleteBuffer(f),this._native=null);this.__base.FG3dVertexBuffer.dispose.call(this)}function FWglVertexShader(b){b=RClass.inherits(this,b,FG3dVertexShader);b._native=null;b.setup=FWglVertexShader_setup;b.targetSource=FWglVertexShader_targetSource;b.upload=FWglVertexShader_upload;b.dispose=FWglVertexShader_dispose;return b}
function FWglVertexShader_setup(){this.__base.FG3dVertexShader.setup.call(this);var b=this._graphicContext._native;this._native=b.createShader(b.VERTEX_SHADER)}function FWglVertexShader_targetSource(){var b=this._graphicContext;return b.capability().optionShaderSource?b._nativeDebugShader.getTranslatedShaderSource(this._native):this._source}
function FWglVertexShader_upload(b){var f=this._graphicContext._native,h=this._native;f.shaderSource(h,b);f.compileShader(h);if(!f.getShaderParameter(h,f.COMPILE_STATUS)){var q=f.getShaderInfoLog(h);f.deleteShader(h);this._native=null;throw new TError(this,"Upload vertex shader source failure. (error={1})\n{2}",q,b);}this._source=b;return!0}
function FWglVertexShader_dispose(){var b=this._graphicContext,f=this._native;f&&(b._native.deleteShader(f),this._native=null);this.__base.FG3dVertexShader.dispose.call(this)}
var RWglUtility=new function(){this.convertFillMode=RWglUtility_convertFillMode;this.convertCullMode=RWglUtility_convertCullMode;this.convertDepthMode=RWglUtility_convertDepthMode;this.convertBlendFactors=RWglUtility_convertBlendFactors;this.convertIndexStride=RWglUtility_convertIndexStride;this.convertSamplerFilter=RWglUtility_convertSamplerFilter;return this};
function RWglUtility_convertFillMode(b,f){switch(f){case EG3dFillMode.Point:return b.POINT;case EG3dFillMode.Line:return b.LINE;case EG3dFillMode.Face:return b.FILL}throw new TError(this,"Convert fill mode failure. (fill_cd={1})",f);}function RWglUtility_convertCullMode(b,f){switch(f){case EG3dCullMode.Front:return b.FRONT;case EG3dCullMode.Back:return b.BACK;case EG3dCullMode.Both:return b.FRONT_AND_BACK}throw new TError(this,"Convert cull mode failure. (cull_cd={1})",f);}
function RWglUtility_convertDepthMode(b,f){switch(f){case EG3dDepthMode.Equal:return b.EQUAL;case EG3dDepthMode.NotEqual:return b.NOTEQUAL;case EG3dDepthMode.Less:return b.LESS;case EG3dDepthMode.LessEqual:return b.LEQUAL;case EG3dDepthMode.Greater:return b.GREATER;case EG3dDepthMode.GreaterEqual:return b.GEQUAL;case EG3dDepthMode.Always:return b.ALWAYS}throw new TError(this,"Convert depth mode failure. (depth_cd={1})",f);}
function RWglUtility_convertBlendFactors(b,f){switch(f){case EG3dBlendMode.SourceAlpha:return b.SRC_ALPHA;case EG3dBlendMode.OneMinusSourceAlpha:return b.ONE_MINUS_SRC_ALPHA}throw new TError(this,"Convert blend factors failure. (blend_cd={1})",f);}function RWglUtility_convertIndexStride(b,f){switch(f){case EG3dIndexStride.Uint16:return b.UNSIGNED_SHORT;case EG3dIndexStride.Uint32:return b.UNSIGNED_INT}throw new TError(this,"Convert index stride failure. (stride_cd={1})",f);}
function RWglUtility_convertSamplerFilter(b,f){switch(f){case EG3dSamplerFilter.Unknown:return 0;case EG3dSamplerFilter.Nearest:return b.NEAREST;case EG3dSamplerFilter.Linear:return b.LINEAR;case EG3dSamplerFilter.Repeat:return b.REPEAT;case EG3dSamplerFilter.ClampToEdge:return b.CLAMP_TO_EDGE;case EG3dSamplerFilter.ClampToBorder:return b.CLAMP_TO_BORDER}throw new TError(this,"Convert sampler filter failure. (filter_cd={1})",f);}
function MListenerEnterFrame(b){b=RClass.inherits(this,b,MListener);b.addEnterFrameListener=MListenerEnterFrame_addEnterFrameListener;b.removeEnterFrameListener=MListenerEnterFrame_removeEnterFrameListener;b.processEnterFrameListener=MListenerEnterFrame_processEnterFrameListener;return b}function MListenerEnterFrame_addEnterFrameListener(b,f){return this.addListener(EEvent.EnterFrame,b,f)}function MListenerEnterFrame_removeEnterFrameListener(b,f){this.removeListener(EEvent.EnterFrame,b,f)}
function MListenerEnterFrame_processEnterFrameListener(b,f,h,q,u){this.processListener(EEvent.EnterFrame,b,f,h,q,u)}function MListenerLeaveFrame(b){b=RClass.inherits(this,b,MListener);b.addLeaveFrameListener=MListenerLeaveFrame_addLeaveFrameListener;b.removeLeaveFrameListener=MListenerLeaveFrame_removeLeaveFrameListener;b.processLeaveFrameListener=MListenerLeaveFrame_processLeaveFrameListener;return b}
function MListenerLeaveFrame_addLeaveFrameListener(b,f){return this.addListener(EEvent.LeaveFrame,b,f)}function MListenerLeaveFrame_removeLeaveFrameListener(b,f){this.removeListener(EEvent.LeaveFrame,b,f)}function MListenerLeaveFrame_processLeaveFrameListener(b,f,h,q,u){this.processListener(EEvent.LeaveFrame,b,f,h,q,u)}
function FDisplay(b){b=RClass.inherits(this,b,FObject,MGraphicObject);b._parent=null;b._currentMatrix=null;b._name=null;b._matrix=null;b._location=null;b._rotation=null;b._scale=null;b._visible=!0;b._renderables=null;b.construct=FDisplay_construct;b.parent=FDisplay_parent;b.setParent=FDisplay_setParent;b.isName=FDisplay_isName;b.name=FDisplay_name;b.setName=FDisplay_setName;b.currentMatrix=FDisplay_currentMatrix;b.matrix=FDisplay_matrix;b.location=FDisplay_location;b.rotation=FDisplay_rotation;b.scale=
FDisplay_scale;b.hasRenderable=FDisplay_hasRenderable;b.renderables=FDisplay_renderables;b.pushRenderable=FDisplay_pushRenderable;b.removeRenderable=FDisplay_removeRenderable;b.filterDisplays=FDisplay_filterDisplays;b.filterRenderables=FDisplay_filterRenderables;b.show=FDisplay_show;b.hide=FDisplay_hide;b.setVisible=FDisplay_setVisible;b.update=FDisplay_update;b.updateMatrix=FDisplay_updateMatrix;b.process=FDisplay_process;b.remove=FDisplay_remove;b.dispose=FDisplay_dispose;return b}
function FDisplay_construct(){this.__base.FObject.construct.call(this);this._currentMatrix=new SMatrix3d;this._matrix=new SMatrix3d;this._location=new SPoint3;this._rotation=new SVector3;this._scale=new SVector3;this._scale.set(1,1,1)}function FDisplay_parent(){return this._parent}function FDisplay_setParent(b){this._parent=b}function FDisplay_isName(b){return this._name==b}function FDisplay_name(){return this._name}function FDisplay_setName(b){this._name=b}
function FDisplay_currentMatrix(){return this._currentMatrix}function FDisplay_matrix(){return this._matrix}function FDisplay_location(){return this._location}function FDisplay_rotation(){return this._rotation}function FDisplay_scale(){return this._scale}function FDisplay_hasRenderable(){var b=this._renderables;return b?!b.isEmpty():!1}function FDisplay_renderables(){var b=this._renderables;b||(b=this._renderables=new TObjects);return b}
function FDisplay_pushRenderable(b){b._display=this;this.renderables().push(b)}function FDisplay_removeRenderable(b){var f=this._renderables;f&&f.remove(b)}function FDisplay_filterDisplays(b){this._visible&&b.push(this)}function FDisplay_filterRenderables(b){if(!this._visible)return!1;var f=this._renderables;if(f)for(var h=f.count(),q=0;q<h;q++)f.getAt(q).filterDrawables(b);return!0}function FDisplay_show(){this.setVisible(!0)}function FDisplay_hide(){this.setVisible(!1)}
function FDisplay_setVisible(b){this._visible=b}function FDisplay_update(){var b=this._matrix;b.set(this._location,this._rotation,this._scale);b.update()}function FDisplay_updateMatrix(){this._currentMatrix.assign(this._matrix);var b=this._parent;b&&this._currentMatrix.append(b._currentMatrix)}function FDisplay_process(b){this.updateMatrix();var f=this._renderables;if(f)for(var h=f.count(),q=0;q<h;q++)f.getAt(q).process(b)}
function FDisplay_remove(){var b=this._parent;b&&(b.removeDisplay(this),this._parent=null)}function FDisplay_dispose(){RObject.dispose(this._currentMatrix);RObject.dispose(this._matrix);RObject.dispose(this._position);RObject.dispose(this._direction);RObject.dispose(this._scale);RObject.dispose(this._renderables);this.__base.FObject.dispose.call(this)}
function FDisplayContainer(b){b=RClass.inherits(this,b,FDisplay);b._displays=null;b.hasDisplay=FDisplayContainer_hasDisplay;b.findDisplay=FDisplayContainer_findDisplay;b.searchDisplay=FDisplayContainer_searchDisplay;b.displays=FDisplayContainer_displays;b.pushDisplay=FDisplayContainer_pushDisplay;b.removeDisplay=FDisplayContainer_removeDisplay;b.filterDisplays=FDisplayContainer_filterDisplays;b.filterRenderables=FDisplayContainer_filterRenderables;b.process=FDisplayContainer_process;b.dispose=FDisplayContainer_dispose;
return b}function FDisplayContainer_hasDisplay(){var b=this._displays;return b?!b.isEmpty():!1}function FDisplayContainer_findDisplay(b){var f=this._displays;if(f)for(var h=f.count(),q=0;q<h;q++){var u=f.get(q);if(u.isName(b))return u}return null}function FDisplayContainer_searchDisplay(b){var f=this._displays;if(f)for(var h=f.count(),q=0;q<h;q++){var u=f.get(q);if(u.isName(b)||(u=u.searchDisplay(b)))return u}return null}
function FDisplayContainer_displays(){var b=this._displays;b||(b=this._displays=new TObjects);return b}function FDisplayContainer_pushDisplay(b){b._parent=this;this.displays().push(b)}function FDisplayContainer_removeDisplay(b){this.displays().remove(b);b._parent=null}function FDisplayContainer_filterDisplays(b){this.__base.FDisplay.filterDisplays.call(this,b);if(this._visible){var f=this._displays;if(f)for(var h=f.count(),q=0;q<h;q++)f.get(q).filterDisplays(b)}}
function FDisplayContainer_filterRenderables(b){this.__base.FDisplay.filterRenderables.call(this,b);if(!this._visible)return!1;var f=this._displays;if(f)for(var h=f.count(),q=0;q<h;q++)f.getAt(q).filterRenderables(b);return!0}function FDisplayContainer_process(b){this.__base.FDisplay.process.call(this,b);var f=this._displays;if(f)for(var h=f.count(),q=0;q<h;q++)f.get(q).process(b)}
function FDisplayContainer_dispose(){var b=this._displays;if(b){for(var f=b.count()-1;0<=f;f--)b.get(f).dispose();b.dispose();this._displays=null}this.__base.FDisplay.dispose.call(this)}
function FDisplayLayer(b){b=RClass.inherits(this,b,FDisplayContainer);b._statusActive=!1;b._technique=null;b._visibleRenderables=null;b.construct=FDisplayLayer_construct;b.technique=FDisplayLayer_technique;b.setTechnique=FDisplayLayer_setTechnique;b.selectTechnique=FDisplayLayer_selectTechnique;b.visibleRenderables=FDisplayLayer_visibleRenderables;b.filterRenderables=FDisplayLayer_filterRenderables;b.active=FDisplayLayer_active;b.deactive=FDisplayLayer_deactive;return b}
function FDisplayLayer_construct(){this.__base.FDisplayContainer.construct.call(this);this._visibleRenderables=new TObjects}function FDisplayLayer_technique(){return this._technique}function FDisplayLayer_setTechnique(b){this._technique=b}function FDisplayLayer_selectTechnique(b,f){this._technique=RConsole.find(FG3dTechniqueConsole).find(b,f)}function FDisplayLayer_visibleRenderables(){return this._visibleRenderables}
function FDisplayLayer_filterRenderables(b){this.__base.FDisplayContainer.filterRenderables.call(this,b);this._visibleRenderables.assign(b.renderables())}function FDisplayLayer_active(){this._statusActive=!0}function FDisplayLayer_deactive(){this._statusActive=!1}function FDisplayUiLayer(b){return b=RClass.inherits(this,b,FDisplayLayer)}
function FDrawable(b){b=RClass.inherits(this,b,FObject);b._visible=!0;b._drawables=null;b.testVisible=FDrawable_testVisible;b.visible=FDrawable_visible;b.setVisible=FDrawable_setVisible;b.hasDrawable=FDrawable_hasDrawable;b.drawables=FDrawable_drawables;b.pushDrawable=FDrawable_pushDrawable;b.removeDrawable=FDrawable_removeDrawable;b.filterDrawables=FDrawable_filterDrawables;b.process=FDrawable_process;return b}function FDrawable_testVisible(){return this._visible}
function FDrawable_visible(){return this._visible}function FDrawable_setVisible(b){this._visible=b}function FDrawable_hasDrawable(){var b=this._drawables;return b?!b.isEmpty():!1}function FDrawable_drawables(){var b=this._drawables;b||(b=this._drawables=new TObjects);return b}function FDrawable_pushDrawable(b){b._parent=this;b._drawable=this;this.drawables().push(b)}function FDrawable_removeDrawable(b){var f=this._drawables;f&&f.remove(b)}
function FDrawable_filterDrawables(b){if(!this.testVisible())return!1;b.pushRenderable(this);var f=this._drawables;if(f)for(var h=f.count(),q=0;q<h;q++){var u=f.getAt(q);u.testVisible()&&b.pushRenderable(u)}}function FDrawable_process(b){var f=this._drawables;if(f)for(var h=f.count()-1;0<=h;h--)f.getAt(h).process(b)}function FRegion(b){return b=RClass.inherits(this,b,FObject)}
function FStage(b){b=RClass.inherits(this,b,FObject,MListenerEnterFrame,MListenerLeaveFrame);b._statusActive=!1;b._layers=null;b.onProcess=FStage_onProcess;b.construct=FStage_construct;b.registerLayer=RStage_registerLayer;b.unregisterLayer=RStage_unregisterLayer;b.layers=FStage_layers;b.active=FStage_active;b.deactive=FStage_deactive;b.process=FStage_process;b.dispose=FStage_dispose;return b}function FStage_onProcess(){for(var b=this._layers,f=b.count(),h=0;h<f;h++)b.valueAt(h).process()}
function FStage_construct(){this.__base.FObject.construct.call(this);this._layers=new TDictionary}function RStage_registerLayer(b,f){this._layers.set(b,f)}function RStage_unregisterLayer(b){this._layers.set(b,null)}function FStage_layers(){return this._layers}function FStage_active(){this._statusActive=!0;for(var b=this._layers,f=b.count(),h=0;h<f;h++)b.value(h).active()}function FStage_deactive(){for(var b=this._layers,f=b.count(),h=0;h<f;h++)b.value(h).deactive();this._statusActive=!1}
function FStage_process(){this.processEnterFrameListener(this);this.onProcess();this.processLeaveFrameListener(this)}function FStage_dispose(){this._layers=RObject.dispose(this._layers);this.__base.MListenerEnterFrame.dispose.call(this);this.__base.MListenerLeaveFrame.dispose.call(this);this.__base.FObject.dispose.call(this)}
var RStage=new function(){this._active=!0;this._interval=25;this.lsnsLeaveFrame=this.lsnsEnterFrame=this._stages=null;this.onProcess=RStage_onProcess;this.construct=RStage_construct;this.register=RStage_register;this.active=RStage_active;this.deactive=RStage_deactive;this.process=RStage_process;this.start=RStage_start;this.construct();return this};function RStage_onProcess(){RStage.process()}function RStage_construct(){this.lsnsEnterFrame=new TListeners;this.lsnsLeaveFrame=new TListeners}
function RStage_register(b,f){var h=this._stages;null==h&&(h=this._stages=new TDictionary);h.set(b,f)}function RStage_active(){var b=this._stages;if(null!=b)for(var f=b.count(),h=0;h<f;h++)b.value(h).active()}function RStage_deactive(){var b=this._stages;if(null!=b)for(var f=b.count(),h=0;h<f;h++)b.value(h).deactive()}
function RStage_process(){if(this._active){this.lsnsEnterFrame.process(this);var b=this._stages;if(b)for(var f=b.count(),h=0;h<f;h++)b.valueAt(h).process();this.lsnsLeaveFrame.process(this);RTimer.update()}}function RStage_start(b){RE3dEngine.setup();this.active();this.process();null==b&&(b=this._interval);RTimer.setup();setInterval("RStage_onProcess()",parseInt(b))}function FE2dDrawable(b){return b=RClass.inherits(this,b,FDrawable)}
function FE3dCanvas(b){b=RClass.inherits(this,b,FObject,MListenerLoad,MMouseCapture);b._optionAlpha=!0;b._optionAntialias=!1;b._context=null;b._scaleRate=1;b._interval=1E3/60;b._hPanel=null;b._hCanvas=null;b.ohTouchStart=FE3dCanvas_ohTouchStart;b.ohTouchMove=FE3dCanvas_ohTouchMove;b.ohTouchStop=FE3dCanvas_ohTouchStop;b.onTouchStart=RMethod.empty;b.onTouchMove=RMethod.empty;b.onTouchStop=RMethod.empty;b.onResize=FE3dCanvas_onResize;b.construct=FE3dCanvas_construct;b.build=FE3dCanvas_build;b.setPanel=
FE3dCanvas_setPanel;b.dispose=FE3dCanvas_dispose;return b}function FE3dCanvas_ohTouchStart(b){this.__linker.onTouchStart(b)}function FE3dCanvas_ohTouchMove(b){this.__linker.onTouchMove(b)}function FE3dCanvas_ohTouchStop(b){this.__linker.onTouchStop(b)}function FE3dCanvas_onResize(b){var f=this._hPanel;b=f.offsetWidth*this._scaleRate;var f=f.offsetHeight*this._scaleRate,h=this._hCanvas;h.width=b;h.height=f;this._context.setViewport(0,0,b,f)}
function FE3dCanvas_construct(){this.__base.FObject.construct.call(this)}
function FE3dCanvas_build(b){b=this._hCanvas=RBuilder.create(b,"CANVAS");b.__linker=this;b.style.width="100%";b.style.height="100%";b.style.display="block";RMethod.isEmpty(this.onTouchStart)||b.addEventListener("touchstart",this.ohTouchStart,!1);RMethod.isEmpty(this.onTouchMove)||b.addEventListener("touchmove",this.ohTouchMove,!1);RMethod.isEmpty(this.onTouchStop)||b.addEventListener("touchend",this.ohTouchStop,!1);var f={};f.alpha=this._optionAlpha;f.antialias=this._optionAntialias;this._context=
REngine3d.createContext(FWglContext,b,f);RStage.lsnsEnterFrame.register(this,this.onEnterFrame);RStage.start(this._interval);RWindow.lsnsResize.register(this,this.onResize);RWindow.lsnsOrientation.register(this,this.onResize);RConsole.find(FMouseConsole).register(this)}function FE3dCanvas_setPanel(b){this._hPanel=b;b.appendChild(this._hCanvas);this.onResize()}
function FE3dCanvas_dispose(){var b=this._hCanvas;b&&(b.__linker=null,b.removeEventListener("touchstart",this.ohTouchStart),b.removeEventListener("touchmove",this.ohTouchMove),b.removeEventListener("touchend",this.ohTouchStop));this._context=RObject.dispose(this._context);this._hPanel=RHtml.free(this._hPanel);this._hCanvas=RHtml.free(this._hCanvas);this.__base.FObject.dispose.call(this)}
function FE3dDisplay(b){b=RClass.inherits(this,b,FDisplay);b._materials=null;b.construct=FE3dDisplay_construct;b.materials=FE3dDisplay_materials;b.dispose=FE3dDisplay_dispose;return b}function FE3dDisplay_construct(){this.__base.FDisplay.construct.call(this);this._materials=new TDictionary}function FE3dDisplay_materials(){return this._materials}function FE3dDisplay_dispose(){this._materials=RObject.free(this._materials);this.__base.FDisplay.dispose.call(this)}
function FE3dDrawable(b){return b=RClass.inherits(this,b,FDrawable)}function FE3dRegion(b){b=RClass.inherits(this,b,FRegion,MG3dRegion,MGraphicObject);b._backgroundColor=null;b.construct=FE3dRegion_construct;b.backgroundColor=FE3dRegion_backgroundColor;b.prepare=FE3dRegion_prepare;b.dispose=FE3dRegion_dispose;return b}
function FE3dRegion_construct(){this.__base.FRegion.construct.call(this);this.__base.MG3dRegion.construct.call(this);(this._backgroundColor=new SColor4).set(0,0,0,1);this._calculateCameraMatrix=new SMatrix3d}function FE3dRegion_backgroundColor(){return this._backgroundColor}function FE3dRegion_prepare(){this.__base.MG3dRegion.prepare.call(this);this._calculateCameraMatrix.attach(this._camera.matrix())&&(this._changed=!0)}
function FE3dRegion_dispose(){this.__base.FRegion.dispose.call(this);this.__base.MG3dRegion.dispose.call(this)}
function FE3dRenderable(b){b=RClass.inherits(this,b,FE3dDrawable,MG3dRenderable,MGraphicObject);b._display=null;b._calculateMatrix=null;b._vertexCount=0;b._vertexBuffers=null;b._indexBuffer=null;b._textures=null;b.construct=FE3dRenderable_construct;b.setup=RMethod.empty;b.testVisible=FE3dRenderable_testVisible;b.display=FE3dRenderable_display;b.setDisplay=FE3dRenderable_setDisplay;b.vertexCount=FE3dRenderable_vertexCount;b.findVertexBuffer=FE3dRenderable_findVertexBuffer;b.vertexBuffers=FE3dRenderable_vertexBuffers;
b.indexBuffer=FE3dRenderable_indexBuffer;b.findTexture=FE3dRenderable_findTexture;b.textures=FE3dRenderable_textures;b.bones=RMethod.empty;b.update=FE3dRenderable_update;b.remove=FE3dRenderable_remove;return b}function FE3dRenderable_construct(){this.__base.FE3dDrawable.construct.call(this);this.__base.MG3dRenderable.construct.call(this);this._calculateMatrix=new SMatrix3d;this._vertexBuffers=new TDictionary}
function FE3dRenderable_testVisible(){var b=this.__base.FE3dDrawable.testVisible.call(this);return b&&RRuntime.isDebug()&&!this.material().testVisible()?!1:b}function FE3dRenderable_display(){return this._display}function FE3dRenderable_setDisplay(b){this._display=b}function FE3dRenderable_vertexCount(){return this._vertexCount}function FE3dRenderable_findVertexBuffer(b){return this._vertexBuffers.get(b)}function FE3dRenderable_vertexBuffers(){return this._vertexBuffers}
function FE3dRenderable_indexBuffer(){return this._indexBuffer}function FE3dRenderable_findTexture(b){return this._textures.get(b)}function FE3dRenderable_textures(){return this._textures}function FE3dRenderable_update(b){var f=this._calculateMatrix;f.assign(this._matrix);var h=this._drawable;h&&f.append(h.currentMatrix());(h=this._display)&&f.append(h.currentMatrix());this._currentMatrix.attachData(f.data())&&b&&b.change()}
function FE3dRenderable_remove(){var b=this._display;b&&(b.removeRenderable(this),this._display=null)}
function FE3dSimpleStage(b){b=RClass.inherits(this,b,FE3dStage);b._optionKeyboard=!0;b._skyLayer=null;b._mapLayer=null;b._spriteLayer=null;b._faceLayer=null;b.onKeyDown=FE3dSimpleStage_onKeyDown;b.construct=FE3dSimpleStage_construct;b.skyLayer=FE3dSimpleStage_skyLayer;b.mapLayer=FE3dSimpleStage_mapLayer;b.spriteLayer=FE3dSimpleStage_spriteLayer;b.faceLayer=FE3dSimpleStage_faceLayer;b.active=FE3dSimpleStage_active;b.deactive=FE3dSimpleStage_deactive;return b}
function FE3dSimpleStage_onKeyDown(b){var f=this._camera;switch(b.keyCode){case EKeyCode.W:f.doWalk(.3);break;case EKeyCode.S:f.doWalk(-.3);break;case EKeyCode.A:f.doStrafe(.3);break;case EKeyCode.D:f.doStrafe(-.3);break;case EKeyCode.Q:f.doFly(.3);break;case EKeyCode.E:f.doFly(-.3)}f.update()}
function FE3dSimpleStage_construct(){this.__base.FE3dStage.construct.call(this);var b=this._skyLayer=RClass.create(FDisplayLayer);this.registerLayer("sky",b);b=this._mapLayer=RClass.create(FDisplayLayer);this.registerLayer("map",b);b=this._spriteLayer=RClass.create(FDisplayLayer);this.registerLayer("sprite",b);b=this._faceLayer=RClass.create(FDisplayLayer);this.registerLayer("face",b)}function FE3dSimpleStage_skyLayer(){return this._skyLayer}
function FE3dSimpleStage_mapLayer(){return this._mapLayer}function FE3dSimpleStage_spriteLayer(){return this._spriteLayer}function FE3dSimpleStage_faceLayer(){return this._faceLayer}function FE3dSimpleStage_active(){this.__base.FE3dStage.active.call(this);this._optionKeyboard&&RWindow.lsnsKeyDown.register(this,this.onKeyDown)}function FE3dSimpleStage_deactive(){this.__base.FE3dStage.deactive.call(this);this._optionKeyboard&&RWindow.lsnsKeyDown.unregister(this,this.onKeyDown)}
function FE3dSprite(b){b=RClass.inherits(this,b,FObject);b._context=null;b._visible=!0;b.linkContext=FE3dSprite_linkContext;b.testVisible=FE3dSprite_testVisible;return b}function FE3dSprite_linkContext(b){this._context=b}function FE3dSprite_testVisible(b){return this._visible}
function FE3dStage(b){b=RClass.inherits(this,b,FStage,MGraphicObject);b._statistics=null;b._camera=null;b._directionalLight=null;b._technique=null;b._region=null;b._allDisplays=null;b.onProcess=FE3dStage_onProcess;b.construct=FE3dStage_construct;b.createRegion=FE3dStage_createRegion;b.setup=FE3dStage_setup;b.statistics=FE3dStage_statistics;b.camera=FE3dStage_camera;b.projection=FE3dStage_projection;b.directionalLight=FE3dStage_directionalLight;b.technique=FE3dStage_technique;b.selectTechnique=FE3dStage_selectTechnique;
b.region=FE3dStage_region;b.filterDisplays=FE3dStage_filterDisplays;b.allDisplays=FE3dStage_allDisplays;return b}
function FE3dStage_onProcess(){var b=this._region,f=this._technique,h=f._graphicContext,q=b._statistics=this._statistics;q.resetFrame();q._frame.begin();q._frameProcess.begin();h.prepare();f.updateRegion(b);b.prepare();b.change();for(var h=this._layers,u=h.count(),z=0;z<u;z++){var A=h.valueAt(z);b.reset();A.process();A.filterRenderables(b);b.update()}RConsole.find(FE3dStageConsole).process(b);q._frameProcess.end();q._frameDraw.begin();if(b.isChanged()){f.clear(b.backgroundColor());for(z=0;z<u;z++){var A=
h.valueAt(z),B=A.technique();B||(B=f);b.reset();b.renderables().assign(A.visibleRenderables());B.drawRegion(b)}f.present(b)}q._frameDraw.end();q._frame.end()}
function FE3dStage_construct(){this.__base.FStage.construct.call(this);this._statistics=RClass.create(FE3dStageStatistics);RConsole.find(FStatisticsConsole).register("engine.stage",this._statistics);this._allDisplays=new TObjects;var b=this._camera=RClass.create(FE3dCamera);b.position().set(0,0,-100);b.lookAt(0,0,0);b.update();b._projection.update();var f=this._directionalLight=RClass.create(FG3dDirectionalLight);f.direction().set(0,-1,0);var h=this._region=this.createRegion();h._camera=b;h._directionalLight=
f}function FE3dStage_createRegion(){return RClass.create(FE3dRegion)}function FE3dStage_setup(){this.__base.FStage.construct.call(this);this._region.linkGraphicContext(this);this._region.setup()}function FE3dStage_statistics(){return this._statistics}function FE3dStage_camera(){return this._camera}function FE3dStage_projection(){return this._projection}function FE3dStage_directionalLight(){return this._directionalLight}function FE3dStage_technique(){return this._technique}
function FE3dStage_selectTechnique(b,f){this._technique=RConsole.find(FG3dTechniqueConsole).find(b,f)}function FE3dStage_region(){return this._region}function FE3dStage_filterDisplays(b){for(var f=this._layers,h=f.count(),q=0;q<h;q++)f.value(q).filterDisplays(b)}function FE3dStage_allDisplays(){var b=this._allDisplays;b.clear();this.filterDisplays(b);return b}
function FE3dStageConsole(b){b=RClass.inherits(this,b,FConsole);b._scopeCd=EScope.Local;b._looper=null;b._renderables=null;b._thread=null;b._interval=50;b._limit=16;b.onProcess=FE3dStageConsole_onProcess;b.construct=FE3dStageConsole_construct;b.process=FE3dStageConsole_process;return b}function FE3dStageConsole_onProcess(){var b=this._looper;b.record();for(var f=this._limit-1;0<=f;f--){var h=b.next();h&&h.processDelay()}}
function FE3dStageConsole_construct(){this._looper=new TLooper;this._renderables=new TDictionary;var b=this._thread=RClass.create(FThread);b.setInterval(this._interval);b.addProcessListener(this,this.onProcess);RConsole.find(FThreadConsole).start(b)}function FE3dStageConsole_process(b){}
function FE3dStageStatistics(b){b=RClass.inherits(this,b,FStatistics);b._frame=null;b._frameProcess=null;b._frameDraw=null;b._frameDrawSort=null;b._frameDrawRenderable=null;b.construct=FE3dStageStatistics_construct;b.reset=FE3dStageStatistics_reset;b.resetFrame=FE3dStageStatistics_resetFrame;return b}
function FE3dStageStatistics_construct(){this.__base.FStatistics.construct.call(this);this._frame=new TSpeed;this._frameProcess=new TSpeed;this._frameDraw=new TSpeed;this._frameDrawSort=new TSpeed;this._frameDrawRenderable=new TSpeed}function FE3dStageStatistics_reset(){}function FE3dStageStatistics_resetFrame(){this._frame.reset();this._frameProcess.reset();this._frameDraw.reset();this._frameDrawSort.reset();this._frameDrawRenderable.reset()}
var RE3dEngine=new function(){this._setuped=!1;this.onSetup=RE3dEngine_onSetup;this.setup=RE3dEngine_setup;return this};
function RE3dEngine_onSetup(){var b=RConsole.find(FG3dEffectConsole);b.register("select.select.control",FG3dSelectAutomaticEffect);b.register("select.select.automatic",FG3dSelectAutomaticEffect);b.register("select.select.skeleton",FG3dSelectSkeletonEffect);b.register("select.select.skeleton.4",FG3dSelectSkeletonEffect);b.register("control.control.automatic",FG3dControlAutomaticEffect);b.register("general.color.control",FG3dControlAutomaticEffect);b.register("general.color.automatic",FE3dGeneralColorAutomaticEffect);
b.register("general.color.skeleton",FG3dGeneralColorSkeletonEffect);b.register("general.color.skeleton.4",FG3dGeneralColorSkeletonEffect);b.register("shadow.depth.automatic",FG3dShadowDepthAutomaticEffect);b.register("shadow.depth.skeleton",FG3dShadowDepthSkeletonEffect);b.register("shadow.color.automatic",FG3dShadowColorAutomaticEffect);b.register("shadow.color.skeleton",FG3dShadowColorSkeletonEffect)}function RE3dEngine_setup(){this._setuped||(this.onSetup(),this._setuped=!0)}
function SE3sCompressEvent(b,f,h){this.owner=b;this.process=f;this.data=h;return this}function SE3sMaterialInfo(){SG3dMaterialInfo.call(this);this.unserialize=SE3sMaterialInfo_unserialize;this.saveConfig=SE3sMaterialInfo_saveConfig;return this}
function SE3sMaterialInfo_unserialize(b){this.effectCode=b.readString();this.optionDepth=b.readBoolean();this.optionDouble=b.readBoolean();this.optionNormalInvert=b.readBoolean();this.optionShadow=b.readBoolean();this.optionShadowSelf=b.readBoolean();this.optionAlpha=b.readBoolean();this.alphaBase=b.readFloat();this.alphaRate=b.readFloat();this.optionColor=b.readBoolean();this.colorMin=b.readFloat();this.colorMax=b.readFloat();this.colorRate=b.readFloat();this.colorMerge=b.readFloat();this.optionAmbient=
b.readBoolean();this.ambientColor.unserialize(b);this.optionDiffuse=b.readBoolean();this.diffuseColor.unserialize(b);this.optionDiffuseView=b.readBoolean();this.diffuseViewColor.unserialize(b);this.optionSpecular=b.readBoolean();this.specularColor.unserialize(b);this.specularBase=b.readFloat();this.specularLevel=b.readFloat();this.optionSpecularView=b.readBoolean();this.specularViewColor.unserialize(b);this.specularViewBase=b.readFloat();this.specularViewLevel=b.readFloat();this.optionReflect=b.readBoolean();
this.reflectColor.unserialize(b);this.reflectMerge=b.readFloat();this.optionRefract=b.readBoolean();this.refractFrontColor.unserialize(b);this.refractBackColor.unserialize(b);this.optionOpacity=b.readBoolean();this.opacityColor.unserialize(b);this.opacityRate=b.readFloat();this.opacityAlpha=b.readFloat();this.opacityDepth=b.readFloat();this.opacityTransmittance=b.readFloat();this.optionEmissive=b.readBoolean();this.emissiveColor.unserialize(b)}
function SE3sMaterialInfo_saveConfig(b){b.set("effect_code",this.effectCode);b.setBoolean("option_double",this.optionDouble);b.setBoolean("option_alpha",this.optionAlpha);b.setBoolean("option_normal_invert",this.optionNormalInvert);b.setBoolean("option_shadow",this.optionShadow);b.setBoolean("option_shadow_self",this.optionShadowSelf);var f=b.create("Alpha");f.setBoolean("valid",this.optionAlpha);f.setFloat("base",this.alphaBase);f.setFloat("rate",this.alphaRate);f=b.create("Color");f.setBoolean("valid",
this.optionColor);f.setFloat("min",this.colorMin);f.setFloat("max",this.colorMax);f.setFloat("rate",this.colorRate);f.setFloat("merge",this.colorMerge);f=b.create("Ambient");f.setBoolean("valid",this.optionAmbient);this.ambientColor.savePower(f);f=b.create("Diffuse");f.setBoolean("valid",this.optionDiffuse);this.diffuseColor.savePower(f);f=b.create("DiffuseView");f.setBoolean("valid",this.optionDiffuseView);this.diffuseViewColor.savePower(f);f=b.create("Specular");f.setBoolean("valid",this.optionSpecular);
this.specularColor.savePower(f);f.setFloat("base",this.specularBase);f.setFloat("level",this.specularLevel);f=b.create("SpecularView");f.setBoolean("valid",this.optionSpecularView);this.specularViewColor.savePower(f);f.setFloat("base",this.specularViewBase);f.setFloat("level",this.specularViewLevel);f=b.create("Reflect");f.setBoolean("valid",this.optionReflect);this.reflectColor.savePower(f);f.setFloat("merge",this.reflectMerge);f=b.create("Refract");f.setBoolean("valid",this.optionRefract);this.refractFrontColor.savePower(f.create("Front"));
this.refractBackColor.savePower(f.create("Back"));f=b.create("Opacity");f.setBoolean("valid",this.optionOpacity);this.opacityColor.savePower(f);f.setFloat("rate",this.opacityRate);f.setFloat("alpha",this.opacityAlpha);f.setFloat("depth",this.opacityDepth);f.setFloat("transmittance",this.opacityTransmittance);f=b.create("Emissive");f.setBoolean("valid",this.optionEmissive);this.emissiveColor.savePower(f)}
function SE3sSceneShadow(){this.range=this.level=this.rate=this.base=null;this.unserialize=SE3sSceneShadow_unserialize;return this}function SE3sSceneShadow_unserialize(b){this.base=b.readFloat();this.rate=b.readFloat();this.level=b.readFloat();this.range=b.readFloat()}
function FE3sAnimation(b){b=RClass.inherits(this,b,FE3sObject);b._model=null;b._skeletonGuid=null;b._skeleton=null;b._frameCount=0;b._frameTick=0;b._frameSpan=0;b._tracks=null;b.skeletonGuid=FE3sAnimation_skeletonGuid;b.skeleton=FE3sAnimation_skeleton;b.tracks=FE3sAnimation_tracks;b.unserialize=FE3sAnimation_unserialize;return b}function FE3sAnimation_skeletonGuid(){return this._skeletonGuid}
function FE3sAnimation_skeleton(){var b=this._skeleton;if(!b){var f=this._skeletonGuid;f&&(b=this._skeleton=RConsole.find(FE3sModelConsole).findSkeleton(f))}return b}function FE3sAnimation_tracks(){return this._tracks}
function FE3sAnimation_unserialize(b){this.__base.FE3sObject.unserialize.call(this,b);this._skeletonGuid=b.readString();this._frameCount=b.readUint16();this._frameTick=b.readUint16();this._frameSpan=b.readUint32();var f=null,h=b.readUint16();if(0<h)for(var f=this._tracks=new TObjects,q=0;q<h;q++){var u=RClass.create(FE3sTrack);u.unserialize(b);f.push(u);if(A){var z=u.boneIndex(),z=A.findBone(z);z.setTrack(u)}}if(f&&this._skeletonGuid){for(var A=this.skeleton(),q=0;q<h;q++)u=f.get(q),z=A.findBone(u.boneIndex()),
z.setTrack(u);A.pushAnimation(this)}}function FE3sBone(b){b=RClass.inherits(this,b,FObject);b._index=null;b._track=null;b._bones=null;b.index=FE3sBone_index;b.track=FE3sBone_track;b.setTrack=FE3sBone_setTrack;b.bones=FE3sBone_bones;b.unserialize=FE3sBone_unserialize;return b}function FE3sBone_index(){return this._index}function FE3sBone_track(){return this._track}function FE3sBone_setTrack(b){this._track=b}function FE3sBone_bones(){return this._bones}
function FE3sBone_unserialize(b){this._index=b.readUint8();var f=b.readUint8();if(0<f)for(var h=this._bones=new TObjects,q=0;q<f;q++){var u=RClass.create(FE3sBone);u.unserialize(b);h.push(u)}}function FE3sBoneRefer(b){b=RClass.inherits(this,b,FObject);b._index=null;b._bone=null;b._track=null;b.index=FE3sBoneRefer_index;b.bone=FE3sBoneRefer_bone;b.setBone=FE3sBoneRefer_setBone;b.track=FE3sBoneRefer_track;b.setTrack=FE3sBoneRefer_setTrack;b.unserialize=FE3sBoneRefer_unserialize;return b}
function FE3sBoneRefer_index(){return this._index}function FE3sBoneRefer_bone(){return this._bone}function FE3sBoneRefer_setBone(b){this._bone=b}function FE3sBoneRefer_track(){return this._track}function FE3sBoneRefer_setTrack(b){this._track=b}function FE3sBoneRefer_unserialize(b){this._index=b.readUint8()}
function FE3sDisplay(b){b=RClass.inherits(this,b,FObject);b._template=null;b._typeName=null;b._modelGuid=null;b._meshGuid=null;b._matrix=null;b._activeMaterial=null;b._materials=null;b.construct=FE3sDisplay_construct;b.typeName=FE3sDisplay_typeName;b.modelGuid=FE3sDisplay_modelGuid;b.model=FE3sDisplay_model;b.meshGuid=FE3sDisplay_meshGuid;b.mesh=FE3sDisplay_mesh;b.matrix=FE3sDisplay_matrix;b.activeMaterial=FE3sDisplay_activeMaterial;b.materials=FE3sDisplay_materials;b.unserialize=FE3sDisplay_unserialize;
return b}function FE3sDisplay_construct(){this.__base.FObject.construct.call(this);this._matrix=new SMatrix3d}function FE3sDisplay_typeName(){return this._typeName}function FE3sDisplay_modelGuid(){return this._modelGuid}function FE3sDisplay_model(){return RConsole.find(FE3sModelConsole).findModel(this._modelGuid)}function FE3sDisplay_meshGuid(){return this._meshGuid}function FE3sDisplay_mesh(){return RConsole.find(FE3sModelConsole).findMesh(this._meshGuid)}
function FE3sDisplay_matrix(){return this._matrix}function FE3sDisplay_activeMaterial(){return this._activeMaterial}function FE3sDisplay_materials(){return this._materials}
function FE3sDisplay_unserialize(b){this._typeName=b.readString();this._modelGuid=b.readString();this._meshGuid=b.readString();this._matrix.unserialize(b);var f=b.readUint16();if(0<f)for(var h=this._materials=new TObjects,q=0;q<f;q++){var u=RClass.create(FE3sDisplayMaterial);u._template=this._template;u.unserialize(b);h.push(u);null==this._activeMaterial&&(this._activeMaterial=u)}}
function FE3sDisplayMaterial(b){b=RClass.inherits(this,b,FObject);b._groupGuid=null;b._material=null;b.groupGuid=FE3sDisplayMaterial_groupGuid;b.material=FE3sDisplayMaterial_material;b.unserialize=FE3sDisplayMaterial_unserialize;return b}function FE3sDisplayMaterial_groupGuid(){return this._groupGuid}function FE3sDisplayMaterial_material(){return this._material}
function FE3sDisplayMaterial_unserialize(b){this._groupGuid=b.readString();this._material=this._template._activeTheme.findMaterial(this._groupGuid)}function FE3sFrame(b){b=RClass.inherits(this,b,FObject);b._tick=0;b._translation=null;b._quaternion=null;b._scale=null;b.construct=FE3sFrame_construct;b.tick=FE3sFrame_tick;b.translation=FE3sFrame_translation;b.quaternion=FE3sFrame_quaternion;b.scale=FE3sFrame_scale;b.unserialize=FE3sFrame_unserialize;return b}
function FE3sFrame_construct(){this.__base.FObject.construct.call(this);this._translation=new SPoint3;this._quaternion=new SQuaternion;this._scale=new SVector3}function FE3sFrame_tick(){return this._tick}function FE3sFrame_translation(){return this._translation}function FE3sFrame_quaternion(){return this._quaternion}function FE3sFrame_scale(){return this._scale}
function FE3sFrame_unserialize(b){this._tick=b.readUint16();this._translation.unserialize(b);this._quaternion.unserialize(b);this._scale.unserialize(b)}
function FE3sMaterial(b){b=RClass.inherits(this,b,FE3sObject);b._groupGuid=null;b._info=null;b._textures=null;b.construct=FE3sMaterial_construct;b.groupGuid=FE3sMaterial_groupGuid;b.group=FE3sMaterial_group;b.effectCode=FE3sMaterial_effectCode;b.info=FE3sMaterial_info;b.textures=FE3sMaterial_textures;b.unserialize=FE3sMaterial_unserialize;b.saveConfig=FE3sMaterial_saveConfig;return b}function FE3sMaterial_construct(){this.__base.FE3sObject.construct.call(this);this._info=new SE3sMaterialInfo}
function FE3sMaterial_groupGuid(){return this._groupGuid}function FE3sMaterial_group(){return RConsole.find(FE3sMaterialConsole).findGroup(this._groupGuid)}function FE3sMaterial_effectCode(){return this._info.effectCode}function FE3sMaterial_info(){return this._info}function FE3sMaterial_textures(){return this._textures}
function FE3sMaterial_unserialize(b){this.__base.FE3sObject.unserialize.call(this,b);this._groupGuid=b.readString();this._info.unserialize(b);var f=b.readInt16();if(0<f)for(var h=this._textures=new TObjects,q=0;q<f;q++){var u=RClass.create(FE3sMaterialTexture);u.unserialize(b);h.push(u)}}
function FE3sMaterial_saveConfig(b){var f=this._info;b.set("guid",this._guid);b.set("code",this._code);b.set("label",this._label);b.set("option_alpha",f.optionAlpha);b.set("option_double",f.optionDouble);b.set("alpha_base",f.alphaBase);b.set("alpha_rate",f.alphaRate);b.set("ambient_color",f.ambientColor.toString());b.set("diffuse_color",f.diffuseColor.toString());b.set("specular_color",f.specularColor.toString());b.set("specular_base",f.specularBase);b.set("specular_level",f.specularLevel);b.set("reflect_color",
f.reflectColor.toString());b.set("reflect_merge",f.reflectMerge);b.set("emissive_color",f.emissiveColor.toString())}function FE3sMaterialConsole(b){b=RClass.inherits(this,b,FConsole);b._materialGroups=null;b._materials=null;b.construct=FE3sMaterialConsole_construct;b.findGroup=FE3sMaterialConsole_findGroup;b.find=FE3sMaterialConsole_find;b.unserializeGroup=FE3sMaterialConsole_unserializeGroup;b.unserialize=FE3sMaterialConsole_unserialize;return b}
function FE3sMaterialConsole_construct(){this.__base.FConsole.construct.call(this);this._materialGroups=new TDictionary;this._materials=new TDictionary}function FE3sMaterialConsole_findGroup(b){return this._materialGroups.get(b)}function FE3sMaterialConsole_find(b){return this._materials.get(b)}function FE3sMaterialConsole_unserializeGroup(b){var f=RClass.create(FE3sMaterialGroup);f.unserialize(b);this._materialGroups.set(f.guid(),f);return f}
function FE3sMaterialConsole_unserialize(b){var f=RClass.create(FE3sMaterial);f.unserialize(b);this._materials.set(f.guid(),f);return f}function FE3sMaterialGroup(b){return b=RClass.inherits(this,b,FE3sObject)}function FE3sMaterialTexture(b){b=RClass.inherits(this,b,FE3sObject);b._textureGuid=null;b._bitmapGuid=null;b.textureGuid=FE3sMaterialTexture_textureGuid;b.bitmapGuid=FE3sMaterialTexture_bitmapGuid;b.unserialize=FE3sMaterialTexture_unserialize;return b}
function FE3sMaterialTexture_textureGuid(){return this._textureGuid}function FE3sMaterialTexture_bitmapGuid(){return this._bitmapGuid}function FE3sMaterialTexture_unserialize(b){this.__base.FE3sObject.unserialize.call(this,b);this._textureGuid=b.readString();this._bitmapGuid=b.readString()}
function FE3sMesh(b){b=RClass.inherits(this,b,FE3sObject);b._outline=null;b._streams=null;b._tracks=null;b.construct=FE3sMesh_construct;b.outline=FE3sMesh_outline;b.streams=FE3sMesh_streams;b.tracks=FE3sMesh_tracks;b.unserialize=FE3sMesh_unserialize;return b}function FE3sMesh_construct(){this.__base.FE3sObject.construct.call(this);this._outline=new SOutline3}function FE3sMesh_outline(){return this._outline}function FE3sMesh_streams(){return this._streams}
function FE3sMesh_tracks(){return this._tracks}function FE3sMesh_unserialize(b){this.__base.FE3sObject.unserialize.call(this,b);this._outline.unserialize(b);var f=b.readInt8();if(0<f)for(var h=this._streams=new TObjects,q=0;q<f;q++){var u=RClass.create(FE3sStream);u.unserialize(b);h.push(u)}}
function FE3sModel(b){b=RClass.inherits(this,b,FE3sResource);b._dataCompress=!0;b._meshes=null;b._skeletons=null;b._animations=null;b.findMeshByCode=FE3sModel_findMeshByCode;b.meshes=FE3sModel_meshes;b.skeletons=FE3sModel_skeletons;b.animations=FE3sModel_animations;b.unserialize=FE3sModel_unserialize;return b}function FE3sModel_findMeshByCode(b){for(var f=this._meshes,h=f.count()-1;0<=h;h--){var q=f.getAt(h);if(q._code==b)return q}return null}function FE3sModel_meshes(){return this._meshes}
function FE3sModel_skeletons(){return this._skeletons}function FE3sModel_animations(){return this._animations}
function FE3sModel_unserialize(b){this.__base.FE3sResource.unserialize.call(this,b);var f=RConsole.find(FE3sModelConsole);f.models().set(this.guid(),this);var h=b.readInt16();if(0<h)for(var q=this._meshes=new TObjects,u=0;u<h;u++)q.push(f.unserialMesh(b));h=b.readInt16();if(0<h)for(q=this._skeletons=new TObjects,u=0;u<h;u++)q.push(f.unserialSkeleton(b));h=b.readInt16();if(0<h)for(q=this._animations=new TObjects,u=0;u<h;u++)q.push(f.unserialAnimation(this,b));RLogger.info(this,"Unserialize model success. (guid={1}, code={2})",
this._guid,this._code)}
function FE3sModelConsole(b){b=RClass.inherits(this,b,FConsole);b._models=null;b._meshs=null;b._skeletons=null;b._animations=null;b.construct=FE3sModelConsole_construct;b.findModel=FE3sModelConsole_findModel;b.models=FE3sModelConsole_models;b.findMesh=FE3sModelConsole_findMesh;b.meshs=FE3sModelConsole_meshs;b.findSkeleton=FE3sModelConsole_findSkeleton;b.skeletons=FE3sModelConsole_skeletons;b.findAnimation=FE3sModelConsole_findAnimation;b.animations=FE3sModelConsole_animations;b.unserialMesh=FE3sModelConsole_unserialMesh;
b.unserialSkeleton=FE3sModelConsole_unserialSkeleton;b.unserialAnimation=FE3sModelConsole_unserialAnimation;b.load=FE3sModelConsole_load;b.dispose=FE3sModelConsole_dispose;return b}function FE3sModelConsole_construct(){this.__base.FConsole.construct.call(this);this._models=new TDictionary;this._meshs=new TDictionary;this._skeletons=new TDictionary;this._animations=new TDictionary}function FE3sModelConsole_findModel(b){return this._models.get(b)}
function FE3sModelConsole_models(){return this._models}function FE3sModelConsole_findMesh(b){return this._meshs.get(b)}function FE3sModelConsole_meshs(){return this._meshs}function FE3sModelConsole_findSkeleton(b){return this._skeletons.get(b)}function FE3sModelConsole_skeletons(){return this._skeletons}function FE3sModelConsole_findAnimation(b){return this._animations.get(b)}function FE3sModelConsole_animations(){return this._animations}
function FE3sModelConsole_unserialMesh(b){var f=RClass.create(FE3sMesh);f.unserialize(b);this._meshs.set(f.guid(),f);return f}function FE3sModelConsole_unserialSkeleton(b){var f=RClass.create(FE3sSkeleton);f.unserialize(b);this._skeletons.set(f.guid(),f);return f}function FE3sModelConsole_unserialAnimation(b,f){var h=RClass.create(FE3sAnimation);h._model=b;h.unserialize(f);this._animations.set(h.guid(),h);return h}
function FE3sModelConsole_load(b,f){var h=this._models,q=h.get(b);if(!q){var u=RConsole.find(FE3sVendorConsole).find("model"),z=u.makeUrl(b),q=RClass.create(FE3sModel);q.setGuid(b);q.setVendor(u);q.load(z);h.set(b,q)}return q}function FE3sModelConsole_dispose(){this._materials=RObject.free(this._materials);this.__base.FConsole.dispose.call(this)}
function FE3sObject(b){b=RClass.inherits(this,b,FObject);b._guid=null;b._code=null;b._label=null;b.guid=FE3sObject_guid;b.code=FE3sObject_code;b.label=FE3sObject_label;b.setLabel=FE3sObject_setLabel;b.unserialize=FE3sObject_unserialize;b.saveConfig=FE3sObject_saveConfig;return b}function FE3sObject_guid(){return this._guid}function FE3sObject_code(){return this._code}function FE3sObject_label(){return this._label}function FE3sObject_setLabel(b){this._label=b}
function FE3sObject_unserialize(b){this._guid=b.readString();this._code=b.readString();this._label=b.readString()}function FE3sObject_saveConfig(b){b.set("guid",this._guid);b.set("code",this._code);b.set("label",this._label)}
function FE3sResource(b){b=RClass.inherits(this,b,FResource);b._dataLoad=!1;b._dataReady=!1;b._dataSize=0;b._dataCompress=!1;b._lsnsLoad=null;b._vendor=null;b.onComplete=FE3sResource_onComplete;b.onLoad=FE3sResource_onLoad;b.vendor=FE3sResource_vendor;b.setVendor=FE3sResource_setVendor;b.loadListener=FE3sResource_loadListener;b.testReady=FE3sResource_testReady;b.unserialize=FE3sResource_unserialize;b.saveConfig=FE3sResource_saveConfig;b.load=FE3sResource_load;b.dispose=FE3sResource_dispose;return b}
function FE3sResource_onComplete(b){var f=RClass.create(FDataView);f.setEndianCd(!0);b.constructor==Array?(b=new Uint8Array(b),f.link(b.buffer)):f.link(b.outputData());this.unserialize(f);f.dispose();this._dataReady=!0;this._lsnsLoad&&this._lsnsLoad.process()}function FE3sResource_onLoad(b){b=b.outputData();RConsole.find(FE3sVendorConsole).pushCompress(this,this.onComplete,new Uint8Array(b))}function FE3sResource_vendor(){return this._vendor}function FE3sResource_setVendor(b){this._vendor=b}
function FE3sResource_loadListener(){var b=this._lsnsLoad;null==b&&(b=this._lsnsLoad=new TListeners);return b}function FE3sResource_testReady(){return this._dataReady}function FE3sResource_unserialize(b){this._guid=b.readString();this._code=b.readString();this._label=b.readString()}function FE3sResource_saveConfig(b){b.set("guid",this._guid);b.set("code",this._code);b.set("label",this._label)}
function FE3sResource_load(b){b=RConsole.find(FHttpConsole).send(b);this._dataCompress?b.lsnsLoad.register(this,this.onLoad):b.lsnsLoad.register(this,this.onComplete);this._dataLoad=!0}function FE3sResource_dispose(){this._vendor=this._lsnsLoad=null;this.__base.FConsole.dispose.call(this)}
function FE3sScene(b){b=RClass.inherits(this,b,FE3sResource);b._dataCompress=!0;b._themeGuid=null;b._themeCode=null;b._technique=null;b._region=null;b._textures=null;b._templates=null;b._layers=null;b.construct=FE3sScene_construct;b.technique=FE3sScene_technique;b.region=FE3sScene_region;b.layers=FE3sScene_layers;b.unserialize=FE3sScene_unserialize;b.saveConfig=FE3sScene_saveConfig;return b}
function FE3sScene_construct(){this.__base.FE3sResource.construct.call(this);this._technique=RClass.create(FE3sSceneTechnique);this._region=RClass.create(FE3sSceneRegion)}function FE3sScene_technique(){return this._technique}function FE3sScene_region(){return this._region}function FE3sScene_layers(){return this._layers}
function FE3sScene_unserialize(b){this.__base.FE3sResource.unserialize.call(this,b);this._themeGuid=b.readString();this._themeCode=b.readString();this._technique.unserialize(b);this._region.unserialize(b);var f=b.readInt16();if(0<f)for(var h=RConsole.find(FE3sTextureConsole),q=this._textures=new TDictionary,u=0;u<f;u++){var z=h.unserialize(b);q.set(z.guid(),z)}f=b.readInt16();if(0<f)for(h=RConsole.find(FE3sTemplateConsole),q=this._templates=new TDictionary,u=0;u<f;u++)z=h.unserialize(b),q.set(z.guid(),
z);f=b.readInt16();if(0<f)for(q=this._layers=new TDictionary,u=0;u<f;u++)h=RClass.create(FE3sSceneLayer),h.unserialize(b),q.set(h.code(),h)}function FE3sScene_saveConfig(b){this.__base.FE3sResource.saveConfig.call(this,b);b.setName("Scene");b.set("theme_guid",this._themeGuid);b.set("theme_code",this._themeCode);b=b.create("LayerCollection");for(var f=this._layers,h=f.count(),q=0;q<h;q++)f.value(q).saveConfig(b.create("Layer"))}
function FE3sSceneCamera(b){b=RClass.inherits(this,b,FE3sObject);b._typeName=null;b._centerFront=null;b._centerBack=null;b._position=null;b._direction=null;b._focalNear=null;b._focalFar=null;b._projection=null;b.construct=FE3sSceneCamera_construct;b.typeName=FE3sSceneCamera_typeName;b.position=FE3sSceneCamera_position;b.direction=FE3sSceneCamera_direction;b.projection=FE3sSceneCamera_projection;b.unserialize=FE3sSceneCamera_unserialize;return b}
function FE3sSceneCamera_construct(){this.__base.FE3sObject.construct.call(this);this._position=new SPoint3;this._direction=new SVector3;this._projection=RClass.create(FE3sSceneProjection)}function FE3sSceneCamera_typeName(){return this._typeName}function FE3sSceneCamera_position(){return this._position}function FE3sSceneCamera_direction(){return this._direction}function FE3sSceneCamera_projection(){return this._projection}
function FE3sSceneCamera_unserialize(b){this.__base.FE3sObject.unserialize.call(this,b);this._typeName=b.readString();this._position.unserialize(b);this._direction.unserialize(b);this._projection.unserialize(b)}function FE3sSceneConsole(b){b=RClass.inherits(this,b,FConsole);b._scenes=null;b._venderCode="scene";b._serviceUrl="/cloud.content.scene.ws";b._dataUrl="/cloud.content.scene.wv";b.construct=FE3sSceneConsole_construct;b.load=FE3sSceneConsole_load;b.update=FE3sSceneConsole_update;return b}
function FE3sSceneConsole_construct(){this.__base.FConsole.construct.call(this);this._scenes=new TDictionary}function FE3sSceneConsole_load(b){var f=this._scenes,h=f.get(b);if(null==h){var q=RConsole.find(FE3sVendorConsole).find(this._venderCode),u=q.makeUrl(b),h=RClass.create(FE3sScene);h.setVendor(q);h.load(u);f.set(b,h)}return h}function FE3sSceneConsole_update(b){var f=RBrowser.hostPath(this._serviceUrl+"?action=updateTheme&date="+RDate.format());RConsole.find(FXmlConsole).send(f,b)}
function FE3sSceneDisplay(b){b=RClass.inherits(this,b,FE3sObject);b._templateGuid=null;b._optionMergeVertex=null;b._optionMergeMaterial=null;b._matrix=null;b._movies=null;b._materials=null;b._renderables=null;b.construct=FE3sSceneDisplay_construct;b.templateGuid=FE3sSceneDisplay_templateGuid;b.matrix=FE3sSceneDisplay_matrix;b.movies=FE3sSceneDisplay_movies;b.materials=FE3sSceneDisplay_materials;b.renderables=FE3sSceneDisplay_renderables;b.unserialize=FE3sSceneDisplay_unserialize;b.saveConfig=FE3sSceneDisplay_saveConfig;
return b}function FE3sSceneDisplay_construct(){this.__base.FE3sObject.construct.call(this);this._matrix=new SMatrix3d}function FE3sSceneDisplay_templateGuid(){return this._templateGuid}function FE3sSceneDisplay_matrix(){return this._matrix}function FE3sSceneDisplay_movies(){return this._movies}function FE3sSceneDisplay_materials(){return this._materials}function FE3sSceneDisplay_renderables(){return this._renderables}
function FE3sSceneDisplay_unserialize(b){this.__base.FE3sObject.unserialize.call(this,b);this._templateGuid=b.readString();this._matrix.unserialize(b);var f=b.readUint16();if(0<f)for(var h=this._movies=new TObjects,q=0;q<f;q++){var u=RClass.create(FE3sSceneMovie);u.unserialize(b);h.push(u)}f=b.readUint16();if(0<f)for(h=this._materials=new TObjects,q=0;q<f;q++)u=RClass.create(FE3sSceneMaterial),u.unserialize(b),h.push(u);f=b.readUint16();if(0<f)for(h=this._renderables=new TObjects,q=0;q<f;q++)u=RClass.create(FE3sTemplateRenderable),
u.unserialize(b),h.push(u)}function FE3sSceneDisplay_saveConfig(b){this.__base.FE3sObject.saveConfig.call(this,b);this._matrix.saveConfig(b.create("Matrix"));b=b.create("MaterialCollection");var f=this._materials;if(f)for(var h=f.count(),q=0;q<h;q++)f.get(q).saveConfig(b.create("Material"))}function FE3sSceneLayer(b){b=RClass.inherits(this,b,FE3sObject);b._displays=null;b.displays=FE3sSceneLayer_displays;b.unserialize=FE3sSceneLayer_unserialize;b.saveConfig=FE3sSceneLayer_saveConfig;return b}
function FE3sSceneLayer_displays(){return this._displays}function FE3sSceneLayer_unserialize(b){this.__base.FE3sObject.unserialize.call(this,b);var f=b.readUint16();if(0<f)for(var h=this._displays=new TObjects,q=0;q<f;q++){var u=RClass.create(FE3sSceneDisplay);u.unserialize(b);h.push(u)}}
function FE3sSceneLayer_saveConfig(b){this.__base.FE3sObject.saveConfig.call(this,b);b=b.create("DisplayCollection");var f=this._displays;if(f)for(var h=f.count(),q=0;q<h;q++)f.get(q).saveConfig(b.create("Display"))}
function FE3sSceneLight(b){b=RClass.inherits(this,b,FE3sObject);b._typeName=null;b._optionTrack=null;b._shadow1=null;b._shadow2=null;b._shadow3=null;b._shadowAmbientMin=null;b._shadowAmbientMax=null;b._shadowAmbientThick=null;b._shadowAmbientRange=null;b._shadowMerge1Base=null;b._shadowMerge1Rate=null;b._shadowMerge2Base=null;b._shadowMerge2Rate=null;b._material=null;b._camera=null;b.construct=FE3sSceneLight_construct;b.typeName=FE3sSceneLight_typeName;b.material=FE3sSceneLight_material;b.camera=
FE3sSceneLight_camera;b.unserialize=FE3sSceneLight_unserialize;return b}function FE3sSceneLight_construct(){this.__base.FE3sObject.construct.call(this);this._shadow1=new SE3sSceneShadow;this._shadow2=new SE3sSceneShadow;this._shadow3=new SE3sSceneShadow;this._material=RClass.create(FE3sSceneMaterial);this._camera=RClass.create(FE3sSceneCamera)}function FE3sSceneLight_typeName(){return this._typeName}function FE3sSceneLight_material(){return this._material}
function FE3sSceneLight_camera(){return this._camera}function FE3sSceneLight_unserialize(b){this.__base.FE3sObject.unserialize.call(this,b);this._typeName=b.readString();this._material.unserialize(b);this._camera.unserialize(b)}function FE3sSceneMap(b){return b=RClass.inherits(this,b,FE3sSceneSpace)}
function FE3sSceneMaterial(b){b=RClass.inherits(this,b,FE3sObject);b._groupGuid=null;b._info=null;b._heightDepth=null;b._surfaceRate=null;b._surfaceReflect=null;b._surfaceBright=null;b._surfaceBrightLevel=null;b._surfaceCoarse=null;b._surfaceCoarseLevel=null;b._surfaceMerge=null;b._surfacePower=null;b.construct=FE3sSceneMaterial_construct;b.groupGuid=FE3sSceneMaterial_groupGuid;b.info=FE3sSceneMaterial_info;b.unserialize=FE3sSceneMaterial_unserialize;b.saveConfig=FE3sSceneMaterial_saveConfig;return b}
function FE3sSceneMaterial_construct(){this.__base.FE3sObject.construct.call(this);this._info=new SE3sMaterialInfo}function FE3sSceneMaterial_groupGuid(){return this._groupGuid}function FE3sSceneMaterial_info(){return this._info}function FE3sSceneMaterial_unserialize(b){this.__base.FE3sObject.unserialize.call(this,b);this._groupGuid=b.readString();this._info.unserialize(b);this._textureCount=b.readInt16()}
function FE3sSceneMaterial_saveConfig(b){this.__base.FE3sObject.saveConfig.call(this,b);b.set("group_guid",this._groupGuid);this._info.saveConfig(b)}function FE3sSceneMovie(b){b=RClass.inherits(this,b,FE3sObject);b._interval=null;b._rotation=null;b.construct=FE3sSceneMovie_construct;b.interval=FE3sSceneMovie_interval;b.rotation=FE3sSceneMovie_rotation;b.unserialize=FE3sSceneMovie_unserialize;return b}
function FE3sSceneMovie_construct(){this.__base.FE3sObject.construct.call(this);this._rotation=new SVector3}function FE3sSceneMovie_interval(){return this._interval}function FE3sSceneMovie_rotation(){return this._rotation}function FE3sSceneMovie_unserialize(b){this.__base.FE3sObject.unserialize.call(this,b);this._interval=b.readInt32();this._rotation.unserialize(b)}
function FE3sSceneProjection(b){b=RClass.inherits(this,b,FE3sObject);b._angle=null;b._znear=null;b._zfar=null;b.angle=FE3sSceneProjection_angle;b.znear=FE3sSceneProjection_znear;b.zfar=FE3sSceneProjection_zfar;b.unserialize=FE3sSceneProjection_unserialize;return b}function FE3sSceneProjection_angle(){return this._angle}function FE3sSceneProjection_znear(){return this._znear}function FE3sSceneProjection_zfar(){return this._zfar}
function FE3sSceneProjection_unserialize(b){this.__base.FE3sObject.unserialize.call(this,b);this._angle=b.readFloat();this._znear=b.readFloat();this._zfar=b.readFloat()}
function FE3sSceneRegion(b){b=RClass.inherits(this,b,FE3sObject);b._optionBackground=!0;b._backgroundColor=null;b._colorLevel=null;b._fogNear=null;b._fogFar=null;b._fogRate=null;b._fogAttenuation=null;b._fogColor=null;b._edgeRate=null;b._edgeLevel=null;b._edgeWidth=null;b._edgeColor=null;b._faceRange=null;b._faceLimit=null;b._faceRate=null;b._camera=null;b._light=null;b.construct=FE3sSceneRegion_construct;b.optionBackground=FE3sSceneRegion_optionBackground;b.setOptionBackground=FE3sSceneRegion_setOptionBackground;
b.backgroundColor=FE3sSceneRegion_backgroundColor;b.camera=FE3sSceneRegion_camera;b.light=FE3sSceneRegion_light;b.unserialize=FE3sSceneRegion_unserialize;return b}function FE3sSceneRegion_construct(){this.__base.FE3sObject.construct.call(this);this._backgroundColor=new SColor4;this._colorLevel=new SColor4;this._fogColor=new SColor4;this._edgeColor=new SColor4;this._camera=RClass.create(FE3sSceneCamera);this._light=RClass.create(FE3sSceneLight)}
function FE3sSceneRegion_optionBackground(){return this._optionBackground}function FE3sSceneRegion_setOptionBackground(b){this._optionBackground=b}function FE3sSceneRegion_backgroundColor(){return this._backgroundColor}function FE3sSceneRegion_camera(){return this._camera}function FE3sSceneRegion_light(){return this._light}
function FE3sSceneRegion_unserialize(b){this.__base.FE3sObject.unserialize.call(this,b);this._backgroundColor.unserialize(b);this._camera.unserialize(b);this._light.unserialize(b)}function FE3sSceneRenderable(b){b=RClass.inherits(this,b,FE3sObject);b.unserialize=FE3sSceneRenderable_unserialize;return b}function FE3sSceneRenderable_unserialize(b){this.__base.FE3sObject.unserialize.call(this,b)}function FE3sSceneSky(b){return b=RClass.inherits(this,b,FE3sSceneSpace)}
function FE3sSceneSpace(b){b=RClass.inherits(this,b,FObject);b._name=null;b._type=null;b._displays=null;b.displays=FE3sSceneSpace_displays;b.unserialize=FE3sSceneSpace_unserialize;return b}function FE3sSceneSpace_displays(){return this._displays}function FE3sSceneSpace_unserialize(b){this._name=b.readString();this._type=b.readString();var f=b.readUint16();if(0<f)for(var h=this._displays=new TObjects,q=0;q<f;q++){var u=RClass.create(FE3sSceneDisplay);u.unserialize(b);h.push(u)}}
function FE3sSceneTechnique(b){b=RClass.inherits(this,b,FE3sObject);b._techniqueCode=null;b._passes=null;b.passes=FE3sSceneTechnique_passes;b.unserialize=FE3sSceneTechnique_unserialize;b.saveConfig=FE3sSceneTechnique_saveConfig;return b}function FE3sSceneTechnique_passes(){return this._passes}
function FE3sSceneTechnique_unserialize(b){this.__base.FE3sObject.unserialize.call(this,b);var f=b.readInt16();if(0<f)for(var h=this._passes=new TObjects,q=0;q<f;q++){var u=RClass.create(FE3sSceneTechniquePass);u.unserialize(b);h.push(u)}}function FE3sSceneTechnique_saveConfig(b){this.__base.FE3sObject.saveConfig.call(this,b);b.set("technique_code",this._techniqueCode)}
function FE3sSceneTechniquePass(b){b=RClass.inherits(this,b,FE3sObject);b._targetWidth=null;b._targetHeight=null;b.targetWidth=FE3sSceneTechniquePass_targetWidth;b.targetHeight=FE3sSceneTechniquePass_targetHeight;b.unserialize=FE3sSceneTechniquePass_unserialize;return b}function FE3sSceneTechniquePass_targetWidth(){return this._targetWidth}function FE3sSceneTechniquePass_targetHeight(){return this._targetHeight}
function FE3sSceneTechniquePass_unserialize(b){this.__base.FE3sObject.unserialize.call(this,b);this._targetWidth=b.readUint16();this._targetHeight=b.readUint16()}
function FE3sSkeleton(b){b=RClass.inherits(this,b,FE3sObject);b._bones=null;b._roots=null;b._skins=null;b._animations=null;b.findBone=FE3sSkeleton_findBone;b.bones=FE3sSkeleton_bones;b.roots=FE3sSkeleton_roots;b.skins=FE3sSkeleton_skins;b.animations=FE3sSkeleton_animations;b.pushAnimation=FE3sSkeleton_pushAnimation;b.innerFilter=FE3sSkeleton_innerFilter;b.unserialize=FE3sSkeleton_unserialize;return b}function FE3sSkeleton_findBone(b){return this._bones.get(b)}
function FE3sSkeleton_bones(){return this._bones}function FE3sSkeleton_roots(){return this._roots}function FE3sSkeleton_skins(){return this._skins}function FE3sSkeleton_animations(){return this._animations}function FE3sSkeleton_pushAnimation(b){var f=this._animations;f||(f=this._animations=new TObjects);f.push(b)}function FE3sSkeleton_innerFilter(b){this._bones.set(b.index(),b);if(b=b.bones())for(var f=b.count(),h=0;h<f;h++){var q=b.get(h);this.innerFilter(q)}}
function FE3sSkeleton_unserialize(b){this.__base.FE3sObject.unserialize.call(this,b);var f=b.readUint8();if(0<f){this._bones=new TDictionary;for(var h=this._roots=new TObjects,q=0;q<f;q++){var u=RClass.create(FE3sBone);u.unserialize(b);this.innerFilter(u);h.push(u)}}f=b.readUint8();if(0<f)for(h=this._skins=new TObjects,q=0;q<f;q++)u=RClass.create(FE3sSkeletonSkin),u.unserialize(b),h.push(u)}
function FE3sSkeletonSkin(b){b=RClass.inherits(this,b,FE3sObject);b._meshGuid=null;b._streams=null;b._boneRefers=null;b.meshGuid=FE3sSkeletonSkin_meshGuid;b.find=FE3sSkeletonSkin_find;b.streams=FE3sSkeletonSkin_streams;b.boneRefers=FE3sSkeletonSkin_boneRefers;b.unserialize=FE3sSkeletonSkin_unserialize;return b}function FE3sSkeletonSkin_meshGuid(){return this._meshGuid}function FE3sSkeletonSkin_find(b){return this._streams.get(b)}function FE3sSkeletonSkin_streams(){return this._streams}
function FE3sSkeletonSkin_boneRefers(){return this._boneRefers}function FE3sSkeletonSkin_unserialize(b){this.__base.FE3sObject.unserialize.call(this,b);this._meshGuid=b.readString();var f=b.readUint8();if(0<f)for(var h=this._streams=new TObjects,q=0;q<f;q++){var u=RClass.create(FE3sStream);u.unserialize(b);h.push(u)}f=b.readUint8();if(0<f)for(h=this._boneRefers=new TObjects,q=0;q<f;q++)u=RClass.create(FE3sBoneRefer),u.unserialize(b),h.push(u)}
function FE3sStream(b){b=RClass.inherits(this,b,FObject);b._code=null;b._elementDataCd=0;b._elementCount=0;b._elementNormalize=!1;b._dataStride=0;b._dataCount=0;b._dataLength=0;b._data=null;b._formatCd=EG3dAttributeFormat.Unknown;b.name=FE3sStream_name;b.formatCd=FE3sStream_formatCd;b.unserialize=FE3sStream_unserialize;b.dispose=FE3sStream_dispose;return b}function FE3sStream_name(){return this._name}function FE3sStream_formatCd(){return this._formatCd}
function FE3sStream_unserialize(b){this._code=b.readString();this._elementDataCd=b.readUint8();this._elementCount=b.readUint8();this._elementNormalize=b.readBoolean();var f=this._dataStride=b.readUint8(),h=this._dataCount=b.readInt32(),f=this._dataLength=f*h,h=this._data=new ArrayBuffer(f);b.readBytes(h,0,f)}function FE3sStream_dispose(){this.__base.FObject.dispose.call(this)}
function FE3sTemplate(b){b=RClass.inherits(this,b,FE3sResource);b._dataCompress=!0;b._materialGroups=null;b._themes=null;b._displays=null;b._activeTheme=null;b.materialGroups=FE3sTemplate_materialGroups;b.themes=FE3sTemplate_themes;b.displays=FE3sTemplate_displays;b.unserialize=FE3sTemplate_unserialize;return b}function FE3sTemplate_materialGroups(){return this._materialGroups}function FE3sTemplate_themes(){return this._themes}function FE3sTemplate_displays(){return this._displays}
function FE3sTemplate_unserialize(b){this.__base.FE3sResource.unserialize.call(this,b);var f=RConsole.find(FE3sMaterialConsole),h=b.readUint16();if(0<h)for(var q=this._materialGroups=new TDictionary,u=0;u<h;u++){var z=f.unserializeGroup(b);q.set(z.guid(),z)}h=b.readUint16();if(0<h)for(q=this._themes=new TObjects,u=0;u<h;u++)f=RClass.create(FE3sTemplateTheme),f.unserialize(b),q.push(f),null==this._activeTheme&&(this._activeTheme=f);h=b.readUint16();if(0<h)for(q=this._displays=new TObjects,u=0;u<h;u++)f=
RClass.create(FE3sDisplay),f._template=this,f.unserialize(b),q.push(f)}function FE3sTemplateConsole(b){b=RClass.inherits(this,b,FConsole);b._templates=null;b._serviceUrl="/cloud.content.template.ws";b._dataUrl="/cloud.content.template.wv";b.construct=FE3sTemplateConsole_construct;b.unserialize=FE3sTemplateConsole_unserialize;b.loadByGuid=FE3sTemplateConsole_loadByGuid;b.loadByCode=FE3sTemplateConsole_loadByCode;b.update=FE3sTemplateConsole_update;return b}
function FE3sTemplateConsole_construct(){this.__base.FConsole.construct.call(this);this._templates=new TDictionary}function FE3sTemplateConsole_unserialize(b){var f=RClass.create(FE3sTemplate);f._dataReady=!0;f.unserialize(b);this._templates.set(f.guid(),f);return f}
function FE3sTemplateConsole_loadByGuid(b){var f=this._templates,h=f.get(b);if(null==h){var q=RConsole.find(FE3sVendorConsole).find("template"),u=q.makeUrl(b,""),h=RClass.create(FE3sTemplate);h.setVendor(q);h.load(u);f.set(b,h)}return h}function FE3sTemplateConsole_loadByCode(b){var f=this._templates,h=f.get(b);if(null==h){var q=RConsole.find(FE3sVendorConsole).find("template").makeUrl("",b),h=RClass.create(FE3sTemplate);h.load(q);f.set(b,h)}return h}
function FE3sTemplateConsole_update(b){var f=RBrowser.hostPath(this._serviceUrl+"?action=update");RConsole.find(FXmlConsole).send(f,b)}function FE3sTemplateTheme(b){b=RClass.inherits(this,b,FE3sObject);b._materials=null;b.findMaterial=FE3sTemplateTheme_findMaterial;b.materials=FE3sTemplateTheme_materials;b.unserialize=FE3sTemplateTheme_unserialize;return b}function FE3sTemplateTheme_findMaterial(b){return this._materials.get(b)}function FE3sTemplateTheme_materials(){return this._materials}
function FE3sTemplateTheme_unserialize(b){this.__base.FE3sObject.unserialize.call(this,b);var f=b.readUint16();if(0<f)for(var h=RConsole.find(FE3sMaterialConsole),q=this._materials=new TDictionary,u=0;u<f;u++){var z=h.unserialize(b);q.set(z.groupGuid(),z)}}
function FE3sTexture(b){b=RClass.inherits(this,b,FE3sResource);b._dataCompress=!0;b._bitmaps=null;b._bitmapPacks=null;b.construct=FE3sTexture_construct;b.bitmaps=FE3sTexture_bitmaps;b.bitmapPacks=FE3sTexture_bitmapPacks;b.unserialize=FE3sTexture_unserialize;b.dispose=FE3sTexture_dispose;return b}function FE3sTexture_construct(){this.__base.FE3sResource.construct.call(this)}function FE3sTexture_bitmaps(){return this._bitmaps}function FE3sTexture_bitmapPacks(){return this._bitmapPacks}
function FE3sTexture_unserialize(b){this.__base.FE3sResource.unserialize.call(this,b);var f=b.readInt16();if(0<f)for(var h=this._bitmaps=new TDictionary,q=0;q<f;q++){var u=RClass.create(FE3sTextureBitmap);u.unserialize(b);h.set(u.code(),u)}f=b.readInt16();if(0<f)for(h=this._bitmapPacks=new TDictionary,q=0;q<f;q++)u=RClass.create(FE3sTextureBitmapPack),u._texture=this,u.unserialize(b),h.set(u.code(),u)}
function FE3sTexture_dispose(){this._bitmaps=RObject.free(this._bitmaps);this._bitmapPacks=RObject.free(this._bitmapPacks);this.__base.FE3sResource.dispose.call(this)}function FE3sTextureBitmap(b){b=RClass.inherits(this,b,FE3sObject);b._packCode=null;b.packCode=FE3sTextureBitmap_packCode;b.unserialize=FE3sTextureBitmap_unserialize;return b}function FE3sTextureBitmap_packCode(){return this._packCode}
function FE3sTextureBitmap_unserialize(b){this.__base.FE3sObject.unserialize.call(this,b);this._packCode=b.readString()}
function FE3sTextureBitmapPack(b){b=RClass.inherits(this,b,FE3sObject);b._optionCompress=null;b._size=null;b._data=null;b._typeName=null;b._formatName=null;b.construct=FE3sTextureBitmapPack_construct;b.optionCompress=FE3sTextureBitmapPack_optionCompress;b.size=FE3sTextureBitmapPack_size;b.data=FE3sTextureBitmapPack_data;b.unserialize=FE3sTextureBitmapPack_unserialize;b.dispose=FE3sTextureBitmapPack_dispose;return b}
function FE3sTextureBitmapPack_construct(){this.__base.FE3sObject.construct.call(this);this._size=new SSize2}function FE3sTextureBitmapPack_optionCompress(){return this._optionCompress}function FE3sTextureBitmapPack_size(){return this._size}function FE3sTextureBitmapPack_data(){return this._data}
function FE3sTextureBitmapPack_unserialize(b){this.__base.FE3sObject.unserialize.call(this,b);this._typeName=b.readString();this._formatName=b.readString();this._size.width=b.readUint16();this._size.height=b.readUint16();if("flat"==this._typeName)var f=b.readInt32();else if("cube"==this._typeName){this._data=[];for(var h=0;6>h;h++){var f=b.readInt32(),q=this._data[h]=new ArrayBuffer(f);b.readBytes(q,0,f)}}else throw new TError(this,"Unserial texture failure ");}
function FE3sTextureBitmapPack_dispose(){this._data=null;this.__base.FE3sObject.dispose.call(this)}function FE3sTextureConsole(b){b=RClass.inherits(this,b,FConsole);b._textures=null;b.construct=FE3sTextureConsole_construct;b.unserialize=FE3sTextureConsole_unserialize;b.load=FE3sTextureConsole_load;b.loadBitmap=FE3sTextureConsole_loadBitmap;b.dispose=FE3sModelConsole_dispose;return b}function FE3sTextureConsole_construct(){this.__base.FConsole.construct.call(this);this._textures=new TDictionary}
function FE3sTextureConsole_unserialize(b){var f=RClass.create(FE3sTexture);f._dataReady=!0;f.unserialize(b);this._textures.set(f.guid(),f);return f}function FE3sTextureConsole_load(b){var f=this._textures,h=f.get(b);if(h)return h;var q=RConsole.find(FE3sVendorConsole).find("texture"),u=q.makeUrl(b),h=RClass.create(FE3sTexture);h.setVendor(q);h.load(u);f.set(b,h);return h}
function FE3sTextureConsole_loadBitmap(b,f,h){b=RConsole.find(FE3sVendorConsole).find("texture.bitmap").makeUrl(b,f,h);f=this._image=RClass.create(FImage);f.loadUrl(b);return f}function FE3sTextureConsole_dispose(){this._textures=RObject.free(this._textures);this.__base.FConsole.dispose.call(this)}function FE3sTheme(b){b=RClass.inherits(this,b,FE3sResource);b._materials=null;b.materials=FE3sTheme_materials;b.find=FE3sTheme_find;b.unserialize=FE3sTheme_unserialize;return b}
function FE3sTheme_materials(){return this._materials}function FE3sTheme_find(b){var f=this._materials;return f?f.get(b):null}function FE3sTheme_unserialize(b){var f=b.readInt32();if(0<f)for(var h=this._materials=new TDictionary,q=0;q<f;q++){var u=RClass.create(FE3sMaterial);u.unserialize(b);h.set(u.code(),u)}}
function FE3sThemeConsole(b){b=RClass.inherits(this,b,FConsole);b._path="/assets/theme/";b._activeTheme=null;b._themes=null;b.construct=FE3sThemeConsole_construct;b.activeTheme=FE3sThemeConsole_activeTheme;b.find=FE3sThemeConsole_find;b.select=FE3sThemeConsole_select;return b}function FE3sThemeConsole_construct(){this.__base.FConsole.construct.call(this);this._themes=new TDictionary}function FE3sThemeConsole_activeTheme(){return this._activeTheme}
function FE3sThemeConsole_find(b){var f=this._activeTheme;if(null==f)throw new TError("Active theme is empty.");return f.find(b)}function FE3sThemeConsole_select(b){var f=this._themes.get(b);if(null==f){var h=RBrowser.contentPath(this._path+b+".ser"),f=RClass.create(FE3sTheme);f.load(h);this._themes.set(b,f)}return this._activeTheme=f}
function FE3sTrack(b){b=RClass.inherits(this,b,FObject);b._meshCode=null;b._boneIndex=0;b._frameTick=0;b._matrix=null;b._matrixInvert=null;b._frameCount=null;b._frames=null;b.construct=FE3sTrack_construct;b.boneIndex=FE3sTrack_boneIndex;b.frameTick=FE3sTrack_frameTick;b.matrix=FE3sTrack_matrix;b.matrixInvert=FE3sTrack_matrixInvert;b.frames=FE3sTrack_frames;b.calculate=FE3sTrack_calculate;b.unserialize=FE3sTrack_unserialize;return b}
function FE3sTrack_construct(){this.__base.FObject.construct.call(this);this._matrix=new SMatrix3d;this._matrixInvert=new SMatrix3d}function FE3sTrack_boneIndex(){return this._boneIndex}function FE3sTrack_frameTick(){return this._frameTick}function FE3sTrack_matrix(){return this._matrix}function FE3sTrack_matrixInvert(){return this._matrixInvert}function FE3sTrack_frames(){return this._frames}
function FE3sTrack_calculate(b,f){var h=this._frameCount;if(0==h)return!1;0>f&&(f=-f);var q=this._frameTick,u=parseInt(f/q)%h,z=this.frames(),A=z.get(u),B=null,B=u<h-1?z.get(u+1):z.get(0);b.tick=f;b.rate=f%q/q;b.currentFrame=A;b.nextFrame=B;return!0}
function FE3sTrack_unserialize(b){this._meshCode=b.readString();this._boneIndex=b.readUint8();this._frameTick=b.readUint16();this._matrix.unserialize(b);this._matrixInvert.assign(this._matrix);this._matrixInvert.invert();var f=b.readInt16();if(0<f){this._frameCount=f;for(var h=this._frames=new TObjects,q=0;q<f;q++){var u=RClass.create(FE3sFrame);u.unserialize(b);h.push(u)}}}
function FE3sVendor(b){b=RClass.inherits(this,b,FObject);b._contentUrl=null;b._parameters=null;b.construct=FE3sVendor_construct;b.contentUrl=FE3sVendor_contentUrl;b.setContentUrl=FE3sVendor_setContentUrl;b.get=FE3sVendor_get;b.set=FE3sVendor_set;b.makeSource=RMethod.virtual(b,"makeSource");b.makeUrl=FE3sVendor_makeUrl;b.reset=FE3sVendor_reset;b.dispose=FE3sVendor_dispose;return b}function FE3sVendor_construct(){this.__base.FObject.construct.call(this);this._parameters=new TAttributes}
function FE3sVendor_contentUrl(b){return this._contentUrl}function FE3sVendor_setContentUrl(b){this._contentUrl=b}function FE3sVendor_get(b){return this._parameters.get(b)}function FE3sVendor_set(b,f){this._parameters.set(b,f)}function FE3sVendor_makeUrl(b){b=this.makeSource();RRuntime.isDebug()&&(b=-1==b.indexOf("?")?b+"?":b+"&",b+="date="+RDate.format());return b}function FE3sVendor_reset(){this._parameters.clear()}
function FE3sVendor_dispose(){this._parameters=RObject.dispose(this._parameters);this.__base.FObject.dispose.call(this)}
function FE3sVendorConsole(b){b=RClass.inherits(this,b,FConsole);b._activeEvent=null;b._events=null;b._setuped=!1;b._vendors=null;b._thread=null;b._interval=100;b.onProcess=FE3sVendorConsole_onProcess;b.onComplete=FE3sVendorConsole_onComplete;b.construct=FE3sVendorConsole_construct;b.pushCompress=FE3sVendorConsole_pushCompress;b.createVendor=FE3sVendorConsole_createVendor;b.register=FE3sVendorConsole_register;b.find=FE3sVendorConsole_find;b.setup=FE3sVendorConsole_setup;return b}
function FE3sVendorConsole_onProcess(){var b=this._events;this._activeEvent||b.isEmpty()||(b=this._activeEvent=b.erase(0),LZMA.decompress(b.data,this.onComplete,null),b.data=null)}function FE3sVendorConsole_onComplete(b){var f=RConsole.find(FE3sVendorConsole),h=f._activeEvent;h.process.call(h.owner,b);h.owner=null;h.process=null;f._activeEvent=null}
function FE3sVendorConsole_construct(){this.__base.FConsole.construct.call(this);this._events=new TObjects;this._vendors=new TDictionary;var b=this._thread=RClass.create(FThread);b.setInterval(this._interval);b.addProcessListener(this,this.onProcess);RConsole.find(FThreadConsole).start(b)}function FE3sVendorConsole_pushCompress(b,f,h){this._events.push(new SE3sCompressEvent(b,f,h))}function FE3sVendorConsole_createVendor(b,f){var h=RClass.create(b);h.setContentUrl(f);return h}
function FE3sVendorConsole_register(b,f){this._vendors.set(b,f)}function FE3sVendorConsole_find(b){this._setuped||this.setup("net");return this._vendors.get(b)}
function FE3sVendorConsole_setup(b){if("net"==b)this._vendors.set("texture.bitmap",this.createVendor(FE3sVendorNet,RBrowser.hostPath("/cloud.content.texture.bitmap.wv"),"guid|code")),this._vendors.set("texture",this.createVendor(FE3sVendorNet,RBrowser.hostPath("/cloud.content.texture.wv"),"guid")),this._vendors.set("model",this.createVendor(FE3sVendorNet,RBrowser.hostPath("/cloud.content.model.wv"),"guid")),this._vendors.set("template",this.createVendor(FE3sVendorNet,RBrowser.hostPath("/cloud.content.template.wv"),
"guid|code")),this._vendors.set("scene",this.createVendor(FE3sVendorNet,RBrowser.hostPath("/cloud.content.scene.wv"),"guid|code"));else if("local"==b)this._vendors.set("texture.bitmap",this.createVendor(FE3sVendorLocal,RBrowser.contentPath("/ar3/texture/{guid}/{code}.{format}"))),this._vendors.set("texture",this.createVendor(FE3sVendorLocal,RBrowser.contentPath("/ar3/texture/{guid}.bin"))),this._vendors.set("model",this.createVendor(FE3sVendorLocal,RBrowser.contentPath("/ar3/model/{guid}.bin"))),
this._vendors.set("template",this.createVendor(FE3sVendorLocal,RBrowser.contentPath("/ar3/template/{guid}.bin"))),this._vendors.set("scene",this.createVendor(FE3sVendorLocal,RBrowser.contentPath("/ar3/scene/{guid}.bin")));else throw new TError(this,"Unknown setup code. (code={1})",b);this._setuped=!0}function FE3sVendorLocal(b){b=RClass.inherits(this,b,FE3sVendor);b.makeSource=FE3sVendorLocal_makeSource;return b}
function FE3sVendorLocal_makeSource(){var b=this._contentUrl;-1==b.indexOf("?")&&(b+="?");for(var f=_parameters,h=f.count(),q=0;q<h;q++)var u=f.name(q),z=f.value(q),b=b+(u+"="+z);return b}function FE3sVendorNet(b){b=RClass.inherits(this,b,FE3sVendor);b.makeSource=FE3sVendorNet_makeSource;return b}function FE3sVendorNet_makeSource(){for(var b=this._contentUrl,f=_parameters,h=f.count(),q=0;q<h;q++)var u=f.name(q),z=f.value(q),b=RString.replace(b,"{"+u+"}",z);return b}
function SE3rPlayInfo(b){b||(b=this);b.tick=0;b.playRate=1;b.currentFrame=null;b.nextFrame=null;b.rate=1;b.alpha=1;b.translation=new SPoint3;b.quaternion=new SQuaternion;b.scale=new SVector3;b.matrix=new SMatrix3d;b.update=SE3rPlayInfo_update;return b}
function SE3rPlayInfo_update(){var b=this.currentFrame;if(null==b)return!1;var f=this.nextFrame;if(null==f)return!1;var h=this.matrix,q=b.translation(),u=b.quaternion(),b=b.scale(),z=this.rate;0<z&&1>z?(this.translation.slerp(q,f.translation(),z),this.quaternion.slerp(u,f.quaternion(),z),this.scale.slerp(b,f.scale(),z),h.build(this.translation,this.quaternion,this.scale)):h.build(q,u,b);return!0}
function FE3rAnimation(b){b=RClass.inherits(this,b,FObject);b._baseTick=0;b._currentTick=0;b._lastTick=0;b._playRate=1;b._tracks=null;b._resource=null;b._playInfo=null;b.construct=FE3rAnimation_construct;b.findTrack=FE3rAnimation_findTrack;b.tracks=FE3rAnimation_tracks;b.resource=FE3rAnimation_resource;b.loadResource=FE3rAnimation_loadResource;b.record=FE3rAnimation_record;b.process=RMethod.virtual(b,"process");b.dispose=FE3rAnimation_dispose;return b}
function FE3rAnimation_construct(){this.__base.FObject.construct.call(this);this._tracks=new TObjects;this._playInfo=new SE3rPlayInfo}function FE3rAnimation_findTrack(b){for(var f=this._tracks,h=f.count(),q=0;q<h;q++){var u=f.get(q);if(u.boneIndex()==b)return u}return null}function FE3rAnimation_tracks(){return this._tracks}function FE3rAnimation_resource(){return this._resource}
function FE3rAnimation_loadResource(b){this._resource=b;b=b.tracks();for(var f=b.count(),h=0;h<f;h++){var q=b.get(h),u=RClass.create(FE3rTrack);u._animation=this;u.loadResource(q);this._tracks.push(u)}}function FE3rAnimation_record(){var b=RTimer.current();0==this._lastTick&&(this._lastTick=b);this._currentTick=(b-this._lastTick+this._baseTick)*this._playRate*3}function FE3rAnimation_dispose(){this._resource=this._tracks=null;this.__base.FObject.dispose.call(this)}
function FE3rBitmapConsole(b){b=RClass.inherits(this,b,FConsole);b._scopeCd=EScope.Local;b._bitmaps=null;b._dataUrl="/cloud.content.texture.bitmap.wv";b.construct=FE3rBitmapConsole_construct;b.bitmaps=FE3rBitmapConsole_bitmaps;b.load=FE3rBitmapConsole_load;return b}function FE3rBitmapConsole_construct(){this.__base.FConsole.construct.call(this);this._bitmaps=new TDictionary}function FE3rBitmapConsole_bitmaps(){return this._bitmaps}
function FE3rBitmapConsole_load(b,f,h){var q=this._bitmaps.get(f);if(q)return q;var u=RBrowser.hostPath(this._dataUrl+"?code="+f);RLogger.info(this,"Load texture from bitmap. (url={1})",u);q="environment"==RString.toLower(h)?RClass.create(FE3rTextureCube):RClass.create(FE3rTexture);q._name=f;q.linkGraphicContext(b);q.load(u);this._bitmaps.set(f,q);return q}
function FE3rBone(b){b=RClass.inherits(this,b,FObject);b._matrix=null;b._boneResource=null;b._trackResource=null;b.construct=FE3rBone_construct;b.matrix=FE3rBone_matrix;b.trackResource=FE3rBone_trackResource;b.loadResource=FE3rBone_loadResource;b.update=FE3rBone_update;b.dispose=FE3rBone_dispose;return b}function FE3rBone_construct(){this.__base.FObject.construct.call(this);this._matrix=new SMatrix3d}function FE3rBone_matrix(){return this._matrix}
function FE3rBone_trackResource(){return this._trackResource}function FE3rBone_loadResource(b){this._boneResource=b;this._trackResource=b.track()}function FE3rBone_update(b,f){var h=this._trackResource;h.calculate(b,f);b.update();var q=this._matrix;q.assign(h.matrixInvert());q.append(b.matrix)}function FE3rBone_dispose(){this._trackResource=this._boneResource=null;this.__base.FG3dBone.dispose.call(this)}
function FE3rDynamicMesh(b){b=RClass.inherits(this,b,FE3dRenderable);b._optionMerge=!0;b._vertexPosition=0;b._vertexTotal=0;b._indexPosition=0;b._indexTotal=0;b._mergeRenderables=null;b.construct=FE3rDynamicMesh_construct;b.mergeCount=FE3rDynamicMesh_mergeCount;b.mergeRenderables=FE3rDynamicMesh_mergeRenderables;b.syncVertexBuffer=FE3rDynamicMesh_syncVertexBuffer;b.mergeRenderable=FE3rDynamicMesh_mergeRenderable;b.mergeVertexBuffer=FE3rDynamicMesh_mergeVertexBuffer;b.mergeIndexBuffer=FE3rDynamicMesh_mergeIndexBuffer;
b.build=FE3rDynamicMesh_build;return b}function FE3rDynamicMesh_construct(){this.__base.FE3dRenderable.construct.call(this);this._mergeRenderables=new TObjects}function FE3rDynamicMesh_mergeCount(){return this._mergeRenderables.count()}function FE3rDynamicMesh_mergeRenderables(){return this._mergeRenderables}
function FE3rDynamicMesh_syncVertexBuffer(b){var f=b._resource._code,h=this._vertexBuffers.get(f);if(!h){var q=this._vertexTotal,h=this._graphicContext.createVertexBuffer();h._name=f;h._formatCd=b._formatCd;h._stride=b._stride;switch(b._formatCd){case EG3dAttributeFormat.Float2:h._data=new Float32Array(2*q);break;case EG3dAttributeFormat.Float3:h._data=new Float32Array(3*q);break;case EG3dAttributeFormat.Byte4:case EG3dAttributeFormat.Byte4Normal:h._data=new Uint8Array(4*q);break;default:throw new TError("Unknown code");
}this._vertexBuffers.set(f,h)}return h}function FE3rDynamicMesh_mergeRenderable(b){var f=this._graphicContext.capability(),h=b.vertexCount(),q=b.indexBuffer().count(),u=f.mergeCount;if(this._mergeRenderables.count()>=u)return!1;u=this._vertexTotal+h;if(f.optionIndex32){if(u>RInteger.MAX_UINT32)return!1}else if(u>RInteger.MAX_UINT16)return!1;this._vertexTotal+=h;this._indexTotal+=q;this._mergeRenderables.push(b);return!0}
function FE3rDynamicMesh_mergeVertexBuffer(b,f,h,q){b=this._vertexPosition;h=h._data;var u=q._dataCount;switch(f){case "position":f=new Float32Array(q._data);RFloat.copy(h,3*b,f,0,3*u);break;case "coord":f=new Float32Array(q._data);RFloat.copy(h,2*b,f,0,2*u);break;case "color":case "normal":case "binormal":case "tangent":case "bone_index":case "bone_weight":f=new Uint8Array(q._data);RByte.copy(h,4*b,f,0,4*u);break;default:throw new TError("Unknown code");}}
function FE3rDynamicMesh_mergeIndexBuffer(b){var f=this._vertexPosition,h=this._indexPosition,q=this._indexBuffer._data,u=new Uint16Array(b._data);b=3*b._dataCount;for(var z=0;z<b;z++)q[h++]=f+u[z]}
function FE3rDynamicMesh_build(){var b=this._graphicContext,f=b.capability(),h=this._vertexTotal,q=this._indexTotal,u=this._mergeRenderables,z=u.count(),A=u.first();this._material=A._material;this._textures=A._textures;var B=this._instanceVertexBuffer=this._graphicContext.createVertexBuffer();B._name="instance";B._stride=4;B._formatCd=EG3dAttributeFormat.Float1;A=B._data=new Float32Array(h);this._vertexBuffers.set(B._name,B);B=this._indexBuffer=b.createIndexBuffer();f.optionIndex32?(B._strideCd=EG3dIndexStride.Uint32,
B._data=new Uint32Array(q)):(B._strideCd=EG3dIndexStride.Uint16,B._data=new Uint16Array(q));B._count=q;for(b=0;b<z;b++){for(var C=u.getAt(b),f=C.vertexCount(),D=C.vertexBuffers(),E=D.count(),F=0;F<E;F++){var B=D.valueAt(F),G=B._resource,K=G._code,B=this.syncVertexBuffer(B);this.mergeVertexBuffer(C,K,B,G)}RFloat.fill(A,this._vertexPosition,f,b);B=C.indexBuffer();C=B.count();this.mergeIndexBuffer(B._resource);this._vertexPosition+=f;this._indexPosition+=C}D=this._vertexBuffers;E=D.count();for(F=0;F<
E;F++)B=D.valueAt(F),B.upload(B._data,B._stride,h),B._data=null;this._indexBuffer.upload(this._indexBuffer._data,q);this._indexBuffer._data=null}
function FE3rDynamicModel(b){b=RClass.inherits(this,b,FE3rObject);b._renderables=null;b._meshes=null;b._updateDate=0;b.construct=FE3rDynamicModel_construct;b.createMesh=FE3rDynamicModel_createMesh;b.renderables=FE3rDynamicModel_renderables;b.meshes=FE3rDynamicModel_meshes;b.pushRenderable=FE3rDynamicModel_pushRenderable;b.build=FE3rDynamicModel_build;b.update=FE3rDynamicModel_update;return b}
function FE3rDynamicModel_construct(){this.__base.FE3rObject.construct.call(this);this._renderables=new TObjects;this._meshes=new TObjects}function FE3rDynamicModel_createMesh(){var b=RClass.create(FE3rDynamicMesh);b.linkGraphicContext(this);this._meshes.push(b);return b}function FE3rDynamicModel_renderables(){return this._renderables}function FE3rDynamicModel_meshes(){return this._meshes}function FE3rDynamicModel_pushRenderable(b){this._renderables.push(b)}
function FE3rDynamicModel_build(){var b=this._renderables,f=this._meshes,h=b.count();if(0<h)for(var q=this.createMesh(),u=0;u<h;u++){var z=b.getAt(u);if(!q.mergeRenderable(z)&&(q=this.createMesh(),!q.mergeRenderable(z)))throw new TError(this,"Merge renderable failure.");}b=f.count();for(u=0;u<b;u++)f.getAt(u).build()}function FE3rDynamicModel_update(b){this._updateDate=RTimer.current()}
function FE3rInstanceMesh(b){b=RClass.inherits(this,b,FE3rMesh);b._merges=null;b.construct=FE3rInstanceMesh_construct;b.mergeRenderable=FE3rInstanceMesh_mergeRenderable;b.build=FE3rInstanceMesh_build;return b}function FE3rInstanceMesh_construct(){this.__base.FE3rMesh.construct.call(this);this._merges=new TObjects}function FE3rInstanceMesh_mergeRenderable(b){this._merges.push(b)}function FE3rInstanceMesh_build(){}
function FE3rMaterial(b){b=RClass.inherits(this,b,FG3dObject);b._vertexBuffers=null;b._indexBuffer=null;b._material=null;b.construct=FE3rMaterial_construct;b.findVertexBuffer=FE3rMaterial_findVertexBuffer;b.indexBuffer=FE3rMaterial_indexBuffer;b.loadResource=FE3rMaterial_loadResource;return b}function FE3rMaterial_construct(){this.__base.FG3dObject.construct.call(this);this._vertexBuffers=new TObjects}
function FE3rMaterial_findVertexBuffer(b){for(var f=this._vertexBuffers,h=f.count(),q=0;q<h;q++){var u=f.get(q);if(u.name()==b)return u}return null}function FE3rMaterial_indexBuffer(){return this._indexBuffer}
function FE3rMaterial_loadResource(b){for(var f=this._context,h=b.vertexBuffers(),q=h.count(),u=0;u<q;u++){var z=h.get(u),A=context.createVertexBuffer();A._name=z.name();A._formatCd=z.formatCd();A.upload(new Float32Array(z._data),z._stride,z._vertexCount);this._vertexBuffers.push(A)}u=b.indexBuffer();(this._indexBuffer=f.createIndexBuffer()).upload(u.data(),u.count());u=b.materialCode();b=(this._material=RConsole.find(FE3sThemeConsole).find(u)).textures();f=b.count();for(u=0;u<f;u++)b.get(u)}
function FE3rMesh(b){b=RClass.inherits(this,b,FE3rObject);b._ready=!1;b._resource=null;b._vertexCount=0;b._vertexBuffers=null;b._indexBuffer=null;b._resourceMaterial=null;b._material=null;b._skins=null;b._boneIds=null;b._textures=null;b.construct=FE3rMesh_construct;b.testReady=FE3rMesh_testReady;b.guid=FE3rMesh_guid;b.vertexCount=FE3rMesh_vertexCount;b.findVertexBuffer=FE3rMesh_findVertexBuffer;b.vertexBuffers=FE3rMesh_vertexBuffers;b.indexBuffer=FE3rMesh_indexBuffer;b.material=FE3rMesh_material;
b.skins=FE3rMesh_skins;b.pushSkin=FE3rMesh_pushSkin;b.findTexture=FE3rMesh_findTexture;b.textures=FE3rMesh_textures;b.boneIds=FE3rMesh_boneIds;b.resource=FE3rMesh_resource;b.loadResource=FE3rMesh_loadResource;return b}function FE3rMesh_construct(){this.__base.FE3rObject.construct.call(this);this._vertexBuffers=new TObjects}
function FE3rMesh_testReady(){if(!this._ready){var b=this._textures;if(null!=b)for(var f=b.count(),h=0;h<f;h++)if(!b.value(h).testReady())return!1;this._ready=!0}return this._ready}function FE3rMesh_guid(){return this._resource.guid()}function FE3rMesh_vertexCount(){return this._vertexCount}function FE3rMesh_findVertexBuffer(b){for(var f=this._vertexBuffers,h=f.count(),q=0;q<h;q++){var u=f.get(q);if(u.name()==b)return u}return null}function FE3rMesh_vertexBuffers(){return this._vertexBuffers}
function FE3rMesh_indexBuffer(){return this._indexBuffer}function FE3rMesh_material(){return this._material}function FE3rMesh_skins(){return this._skins}function FE3rMesh_pushSkin(b){var f=this._skins;f||(f=this._skins=new TObjects);f.push(b)}function FE3rMesh_findTexture(b){return this._textures.get(b)}function FE3rMesh_textures(){return this._textures}function FE3rMesh_boneIds(b){return this._boneIds}function FE3rMesh_resource(){return this._resource}
function FE3rMesh_loadResource(b){var f=this._graphicContext;this._resource=b;b=b.streams();for(var h=b.count(),q=0;q<h;q++){var u=b.get(q),z=u._code;if("index16"==z||"index32"==z){var A=this._indexBuffer=f.createIndexBuffer();A._resource=u;A.upload(u._data,3*u._dataCount)}else{A=f.createVertexBuffer();A._name=z;A._resource=u;this._vertexCount=u._dataCount;var B=null;switch(z){case "position":B=new Float32Array(u._data);A._formatCd=EG3dAttributeFormat.Float3;break;case "coord":B=new Float32Array(u._data);
A._formatCd=EG3dAttributeFormat.Float2;break;case "color":B=new Uint8Array(u._data);A._formatCd=EG3dAttributeFormat.Byte4Normal;break;case "normal":case "binormal":case "tangent":B=new Uint8Array(u._data);A._formatCd=EG3dAttributeFormat.Byte4Normal;break;default:throw new TError("Unknown code");}A.upload(B,u._dataStride,u._dataCount);this._vertexBuffers.push(A)}}}function FE3rMeshAnimation(b){b=RClass.inherits(this,b,FE3rAnimation);b.process=FE3rMeshAnimation_process;return b}
function FE3rMeshAnimation_process(b){var f=b._resource,h=this._playInfo;f.calculate(h,this._currentTick);h.update();b=b._matrix;b.assign(f.matrixInvert());b.append(h.matrix)}
function FE3rModel(b){b=RClass.inherits(this,b,FE3rObject);b._name=null;b._resource=null;b._meshes=null;b._skeletons=null;b._dataReady=!1;b.name=FE3rModel_name;b.setName=FE3rModel_setName;b.findMeshByGuid=FE3rModel_findMeshByGuid;b.geometrys=FE3rModel_geometrys;b.resource=FE3rModel_resource;b.resource=FE3rModel_resource;b.setResource=FE3rModel_setResource;b.testReady=FE3rModel_testReady;b.loadResource=FE3rModel_loadResource;b.loadSkeletonResource=FE3rModel_loadSkeletonResource;b.processLoad=FE3rModel_processLoad;
b.dispose=FE3rModel_dispose;return b}function FE3rModel_name(){return this._name}function FE3rModel_setName(b){this._name=b}function FE3rModel_findMeshByGuid(b){for(var f=this._meshes,h=f.count(),q=0;q<h;q++){var u=f.get(q);if(u._guid==b)return u}return null}function FE3rModel_geometrys(){return this._meshes}function FE3rModel_resource(){return this._resource}function FE3rModel_setResource(b){this._resource=b}function FE3rModel_testReady(){return this._dataReady}
function FE3rModel_loadSkeletonResource(b){var f=RConsole.find(FE3rModelConsole);if(b=b.skins())for(var h=b.count(),q=0;q<h;q++){var u=b.get(q),z=RClass.create(FE3rSkin);z.linkGraphicContext(this);z.loadResource(u);f.findMesh(u.meshGuid()).pushSkin(z)}}
function FE3rModel_loadResource(b){var f=RConsole.find(FE3rModelConsole),h=b.meshes();if(h)for(var q=this._meshes=new TObjects,u=h.count(),z=0;z<u;z++){var A=h.get(z),B=RClass.create(FE3rMesh);B.linkGraphicContext(this);B.loadResource(A);q.push(B);f.meshs().set(B.guid(),B)}if(b=b.skeletons())for(u=b.count(),z=0;z<u;z++)f=b.get(z),this.loadSkeletonResource(f);this._dataReady=!0}
function FE3rModel_processLoad(){if(this._dataReady)return!0;if(!this._resource.testReady())return!1;this.loadResource(this._resource);return!0}function FE3rModel_dispose(){this._ready=!1;this._resource=null;this._meshes=RObject.dispose(this._meshes);this._skeletons=RObject.dispose(this._skeletons);this.__base.FObject.dispose.call(this)}
function FE3rModelConsole(b){b=RClass.inherits(this,b,FConsole);b._scopeCd=EScope.Local;b._loadModels=null;b._models=null;b._meshs=null;b._dynamicMeshs=null;b._thread=null;b._interval=200;b.onProcess=FE3rModelConsole_onProcess;b.construct=FE3rModelConsole_construct;b.findModel=FE3rModelConsole_findModel;b.models=FE3rModelConsole_models;b.findMesh=FE3rModelConsole_findMesh;b.meshs=FE3rModelConsole_meshs;b.load=FE3rModelConsole_load;b.merge=FE3rModelConsole_merge;return b}
function FE3rModelConsole_onProcess(){var b=this._loadModels;for(b.record();b.next();)b.current().processLoad()&&b.removeCurrent()}function FE3rModelConsole_construct(){this.__base.FConsole.construct.call(this);this._loadModels=new TLooper;this._models=new TDictionary;this._meshs=new TDictionary;this._dynamicMeshs=new TDictionary;var b=this._thread=RClass.create(FThread);b.setInterval(this._interval);b.addProcessListener(this,this.onProcess);RConsole.find(FThreadConsole).start(b)}
function FE3rModelConsole_findModel(b){return this._models.get(b)}function FE3rModelConsole_models(){return this._models}function FE3rModelConsole_findMesh(b){return this._meshs.get(b)}function FE3rModelConsole_meshs(){return this._meshs}
function FE3rModelConsole_load(b,f,h){if(!RClass.isClass(b,FGraphicContext))throw new TError("Graphics context is empty");if(RString.isEmpty(f))throw new TError("Model guid is empty");if(h=this._models.get(f,h))return h;var q=RConsole.find(FE3sModelConsole).load(f);h=RClass.create(FE3rModel);h.linkGraphicContext(b);h.setName(f);h.setResource(q);this._models.set(f,h);q.testReady()?h.loadResource(q):this._loadModels.push(h);return h}
function FE3rModelConsole_merge(b,f,h,q){b="merge";for(var u=f.renderables(),z=0;z<q;z++){var A=u.getAt(h+z);b+="|"+A.hashCode()}var B=this._dynamicMeshs.get(b);if(!B){B=RClass.create(FE3rDynamicModel);for(z=0;z<q;z++)A=u.getAt(h+z),B.pushRenderable(A);B.linkGraphicContext(f);B.build();this._dynamicMeshs.set(b,B)}B.update();return B}function FE3rObject(b){return b=RClass.inherits(this,b,FObject,MGraphicObject)}
function FE3rPipeline(b){b=RClass.inherits(this,b,FObject);b._vertexBuffers=null;b._indexBuffer=null;b.construct=FE3rPipeline_construct;b.findVertexBuffer=FE3rPipeline_findVertexBuffer;b.loadResource=FE3rPipeline_loadResource;return b}function FE3rPipeline_construct(){this.__base.FRenderable.construct.call(this);this._vertexBuffers=new TObjects}function FE3rPipeline_findVertexBuffer(b){for(var f=this._vertexBuffers,h=f.count(),q=0;q<h;q++){var u=f.get(q);if(u.name()==b)return u}return null}
function FE3rPipeline_loadResource(b){for(var f=this._context,h=b.vertexBuffers(),q=h.count(),u=0;u<q;u++){var z=h.get(u),A=context.createVertexBuffer();A._name=z.name();A.upload(new Float32Array(z._data),z._stride,z._vertexCount);this._vertexBuffers.push(A)}b=b.indexBuffer();(this._indexBuffer=f.createIndexBuffer()).upload(b.data(),b.count())}
function FE3rSkeleton(b){b=RClass.inherits(this,b,FE3rObject);b._resource=null;b._bones=null;b._skins=null;b.resource=FE3rSkeleton_resource;b.bones=FE3rSkeleton_bones;b.skins=FE3rSkeleton_skins;b.loadResource=FE3rSkeleton_loadResource;return b}function FE3rSkeleton_resource(){return this._resource}function FE3rSkeleton_bones(){return this._bones}function FE3rSkeleton_skins(){return this._skins}
function FE3rSkeleton_loadResource(b){this._resource=b;b=b._bones;var f=b.count();if(0<f)for(var h=this._bones=new TObjects,q=0;q<f;q++){var u=b.value(q),z=RClass.create(FE3rBone);z.loadResource(u);h.push(z)}}function FE3rSkeletonAnimation(b){b=RClass.inherits(this,b,FE3rAnimation);b.process=FE3rSkeletonAnimation_process;return b}function FE3rSkeletonAnimation_process(b){var f=this._currentTick;b=b.bones();for(var h=b.count(),q=0;q<h;q++)b.get(q).update(this._playInfo,f)}
function FE3rSkin(b){b=RClass.inherits(this,b,FE3rObject);b._resource=null;b._streams=null;b.resource=FE3rSkin_resource;b.streams=FE3rSkin_streams;b.loadResource=FE3rSkin_loadResource;return b}function FE3rSkin_resource(){return this._resource}function FE3rSkin_streams(){return this._streams}
function FE3rSkin_loadResource(b){this._resource=b;if(b=b.streams())for(var f=this._streams=new TObjects,h=b.count(),q=0;q<h;q++){var u=RClass.create(FE3rStream);u.linkGraphicContext(this);u.loadResource(b.get(q));f.push(u)}}function FE3rStream(b){b=RClass.inherits(this,b,FE3rObject);b._buffer=null;b._resource=null;b.resource=FE3rStream_resource;b.buffer=FE3rStream_buffer;b.loadResource=FE3rStream_loadResource;return b}function FE3rStream_resource(){return this._resource}
function FE3rStream_buffer(){return this._buffer}function FE3rStream_loadResource(b){var f=b._code;this._resource=b;this._vertexCount=b._dataCount;var h=this._buffer=this._graphicContext.createVertexBuffer();h._name=f;h._resource=b;switch(f){case "bone_index":h._formatCd=EG3dAttributeFormat.Byte4;break;case "bone_weight":h._formatCd=EG3dAttributeFormat.Byte4Normal;break;default:throw new TError("Unknown code");}h.upload(b._data,b._dataStride,b._dataCount)}
function FE3rTexture(b){b=RClass.inherits(this,b,FObject,MGraphicObject);b._resource=null;b._bitmaps=null;b._bitmapPacks=null;b._ready=!1;b._dataReady=!1;b.construct=FE3rTexture_construct;b.resource=FE3rTexture_resource;b.setResource=FE3rTexture_setResource;b.bitmaps=FE3rTexture_bitmaps;b.testReady=FE3rTexture_testReady;b.loadBitmap=FE3rTexture_loadBitmap;b.loadResource=FE3rTexture_loadResource;b.load=FE3rTexture_load;b.processLoad=FE3rTexture_processLoad;b.dispose=FE3rTexture_dispose;return b}
function FE3rTexture_construct(){this.__base.FObject.construct.call(this);this._bitmaps=new TDictionary}function FE3rTexture_resource(){return this._resource}function FE3rTexture_setResource(b){this._resource=b}function FE3rTexture_bitmaps(){return this._bitmaps}function FE3rTexture_testReady(){return this._ready}function FE3rTexture_loadBitmap(b){var f=this._bitmaps,h=f.get(b);h||(h=RClass.create(FE3rTextureBitmap),f.set(b,h));return h}
function FE3rTexture_loadResource(b){if(b=b.bitmapPacks()){this._bitmapPacks=new TDictionary;for(var f=b.count(),h=0;h<f;h++){var q=b.valueAt(h),u=null;if("flat"==q._typeName)u=RClass.create(FE3rTextureBitmapFlatPack);else if("cube"==q._typeName)u=RClass.create(FE3rTextureBitmapCubePack);else throw new TError(this,"Load resource failure.");u.linkGraphicContext(this);u.loadResource(q);this._bitmapPacks.set(q.code(),u)}}this._dataReady=!0}
function FE3rTexture_load(){for(var b=this._resource.bitmaps(),f=b.count()-1;0<=f;f--){var h=b.valueAt(f),q=this.loadBitmap(h.guid()),h=this._bitmapPacks.get(h.packCode());if(!h)throw new TError("Link pack is not eists.");q.load(h)}this._ready=!0}
function FE3rTexture_processLoad(){if(this._dataReady){for(var b=this._bitmapPacks,f=b.count()-1;0<=f;f--)if(!b.valueAt(f).testReady())return!1;this.load()}else{if(!this._resource.testReady())return!1;this.loadResource(this._resource)}return this._ready}function FE3rTexture_dispose(){this._ready=!1;this._resource=null;this._bitmaps=RObject.dispose(this._bitmaps);this.__base.FObject.dispose.call(this)}
function FE3rTextureBitmap(b){b=RClass.inherits(this,b,FObject,MGraphicObject);b._ready=!1;b._bitmapPack=null;b.construct=FE3rTextureBitmap_construct;b.texture=FE3rTextureBitmap_texture;b.testReady=FE3rTextureBitmap_testReady;b.load=FE3rTextureBitmap_load;b.dispose=FE3rTextureBitmap_dispose;return b}function FE3rTextureBitmap_construct(){this.__base.FObject.construct.call(this)}function FE3rTextureBitmap_texture(){return this._bitmapPack.texture()}
function FE3rTextureBitmap_testReady(){return this._ready}function FE3rTextureBitmap_load(b){this._bitmapPack=b;this._ready=!0}function FE3rTextureBitmap_dispose(){this._context=null;this._ready=!1;this._bitmapPack=null;this.__base.FObject.dispose.call(this)}
function FE3rTextureBitmapCubePack(b){b=RClass.inherits(this,b,FE3rTextureBitmapPack);b._resource=null;b._images=null;b.onLoad=FE3rTextureBitmapCubePack_onLoad;b.construct=FE3rTextureBitmapCubePack_construct;b.loadResource=FE3rTextureBitmapCubePack_loadResource;b.dispose=FE3rTextureBitmapCubePack_dispose;return b}
function FE3rTextureBitmapCubePack_onLoad(b){var f=this._graphicContext;b=this._images;for(var h=0;6>h;h++)if(!b[h].testReady())return;(this._texture=f.createCubeTexture()).upload(b[0],b[1],b[2],b[3],b[4],b[5]);for(h=0;6>h;h++)f=b[h],window.URL.revokeObjectURL(f.url()),b[h]=RObject.dispose(f);this._images=RObject.dispose(this._images);this._dataReady=!0}function FE3rTextureBitmapCubePack_construct(){this.__base.FE3rTextureBitmapPack.construct.call(this)}
function FE3rTextureBitmapCubePack_loadResource(b){this._resource=b;var f=b.data();b=b._formatName;this._images=new TObjects;for(var h=0;6>h;h++){var q=new Blob([f[h]],{type:"image/"+b}),q=window.URL.createObjectURL(q),u=this._images[h]=RClass.create(FImage);u.setOptionAlpha(!1);u.loadUrl(q);u.addLoadListener(this,this.onLoad)}}function FE3rTextureBitmapCubePack_dispose(){this._images=RObject.dispose(this._images);this.__base.FE3rTextureBitmapPack.dispose.call(this)}
function FE3rTextureBitmapFlatPack(b){b=RClass.inherits(this,b,FE3rTextureBitmapPack);b._resource=null;b._image=null;b.onLoad=FE3rTextureBitmapFlatPack_onLoad;b.construct=FE3rTextureBitmapFlatPack_construct;b.loadResource=FE3rTextureBitmapFlatPack_loadResource;b.dispose=FE3rTextureBitmapFlatPack_dispose;return b}
function FE3rTextureBitmapFlatPack_onLoad(b){b=this._texture=this._graphicContext.createFlatTexture();b.upload(this._image);b.makeMipmap();this._image=RObject.dispose(this._image);this._dataReady=!0}function FE3rTextureBitmapFlatPack_construct(){this.__base.FE3rTextureBitmapPack.construct.call(this)}
function FE3rTextureBitmapFlatPack_loadResource(b){this._resource=b;var f=b._texture,h=b.code();(this._image=RConsole.find(FE3sTextureConsole).loadBitmap(f._guid,h,b._formatName)).addLoadListener(this,this.onLoad)}function FE3rTextureBitmapFlatPack_dispose(){this._image=RObject.dispose(this._image);this.__base.FE3rTextureBitmapPack.dispose.call(this)}
function FE3rTextureBitmapPack(b){b=RClass.inherits(this,b,FObject,MGraphicObject);b._resource=null;b._image=null;b._texture=null;b._ready=!1;b._dataReady=!1;b.onLoad=RMethod.virtual(b,"onLoad");b.construct=FE3rTextureBitmapPack_construct;b.texture=FE3rTextureBitmapPack_texture;b.testReady=FE3rTextureBitmapPack_testReady;b.loadResource=RMethod.virtual(b,"loadResource");b.dispose=FE3rTextureBitmapPack_dispose;return b}
function FE3rTextureBitmapPack_construct(){this.__base.FObject.construct.call(this)}function FE3rTextureBitmapPack_texture(){return this._texture}function FE3rTextureBitmapPack_testReady(){this._dataReady&&(this._ready=this._texture.isValid());return this._ready}function FE3rTextureBitmapPack_dispose(){this._dataReady=this._ready=!1;this.__base.FObject.dispose.call(this)}
function FE3rTextureConsole(b){b=RClass.inherits(this,b,FConsole);b._scopeCd=EScope.Local;b._loadTextures=null;b._bitmaps=null;b._textures=null;b._thread=null;b._interval=200;b.onProcess=FE3rTextureConsole_onProcess;b.construct=FE3rTextureConsole_construct;b.bitmaps=FE3rTextureConsole_bitmaps;b.textures=FE3rTextureConsole_textures;b.load=FE3rTextureConsole_load;b.loadBitmap=FE3rTextureConsole_loadBitmap;return b}
function FE3rTextureConsole_onProcess(){var b=this._loadTextures;for(b.record();b.next();)b.current().processLoad()&&b.removeCurrent()}function FE3rTextureConsole_construct(){this.__base.FConsole.construct.call(this);this._loadTextures=new TLooper;this._bitmaps=new TDictionary;this._textures=new TDictionary;var b=this._thread=RClass.create(FThread);b.setInterval(this._interval);b.addProcessListener(this,this.onProcess);RConsole.find(FThreadConsole).start(b)}
function FE3rTextureConsole_bitmaps(){return this._bitmaps}function FE3rTextureConsole_textures(){return this._textures}function FE3rTextureConsole_load(b,f){var h=this._textures,q=h.get(f);if(q)return q;var u=RConsole.find(FE3sTextureConsole).load(f),q=RClass.create(FE3rTexture);q.linkGraphicContext(b);q.setResource(u);h.set(f,q);this._loadTextures.push(q);return q}function FE3rTextureConsole_loadBitmap(b,f,h){var q=this._bitmaps.get(h);return q?q:this.load(b,f).loadBitmap(h)}
function FE3rTrack(b){b=RClass.inherits(this,b,FObject);b._matrix=null;b._resource=null;b.construct=FE3rTrack_construct;b.matrix=FE3rTrack_matrix;b.resource=FE3rTrack_resource;b.loadResource=FE3rTrack_loadResource;b.dispose=FE3rTrack_dispose;return b}function FE3rTrack_construct(){this.__base.FObject.construct.call(this);this._matrix=new SMatrix3d}function FE3rTrack_matrix(){return this._matrix}function FE3rTrack_resource(){return this._resource}
function FE3rTrack_loadResource(b){this._resource=b;var f=b.frames();null!=f&&(this._frameCount=f.count());this._frameTick=b.frameTick()}function FE3rTrack_dispose(){this._resource=null;this.__base.FG3dTrack.dispose.call(this)}
function FE3dGeneralColorAutomaticEffect(b){b=RClass.inherits(this,b,FG3dAutomaticEffect);b._code="general.color.automatic";b.buildMaterial=FE3dGeneralColorAutomaticEffect_buildMaterial;b.drawRenderable=FE3dGeneralColorAutomaticEffect_drawRenderable;b.drawGroup=FE3dGeneralColorAutomaticEffect_drawGroup;return b}
function FE3dGeneralColorAutomaticEffect_buildMaterial(b,f){var h=f.material(),q=b.material;q||(q=b.material=RClass.create(FFloatStream),q.setLength(40),h._dirty=!0);if(h._dirty){var u=h.info();q.reset();q.writeFloat4(u.colorMin,u.colorMax,u.colorRate,u.colorMerge);u.optionAlpha?q.writeFloat4(u.alphaBase,u.alphaRate,0,0):q.writeFloat4(u.alphaBase,1,0,0);q.writeColor4(u.ambientColor);q.writeColor4(u.diffuseColor);q.writeColor4(u.specularColor);q.writeFloat4(u.specularBase,u.specularLevel,u.specularAverage,
u.specularShadow);q.writeColor4(u.reflectColor);q.writeFloat4(0,0,1-u.reflectMerge,u.reflectMerge);q.writeColor4(u.emissiveColor);h._dirty=!1}}
function FE3dGeneralColorAutomaticEffect_drawRenderable(b,f){var h=this._program,q=b.calculate(EG3dRegionParameter.CameraPosition),u=b.calculate(EG3dRegionParameter.LightDirection),z=f.material();z.info();this.bindMaterial(z);if(f._optionMerge){for(var A=f.mergeRenderables(),B=A.count(),C=RTypeArray.findTemp(EDataType.Float,16*B),D=0;D<B;D++)z=A.getAt(D),z.currentMatrix().writeData(C,16*D);h.setParameter("vc_model_matrix",C)}else h.setParameter("vc_model_matrix",f.currentMatrix());h.setParameter("vc_vp_matrix",
b.calculate(EG3dRegionParameter.CameraViewProjectionMatrix));h.setParameter("vc_camera_position",q);h.setParameter("vc_light_direction",u);h.setParameter("fc_camera_position",q);h.setParameter("fc_light_direction",u);this._supportMaterialMap?(D=f._materialId,h.setParameter4("fc_material",.03125,D/512,0,0)):(q=f.activeInfo(),this.buildMaterial(q,f),h.setParameter("fc_materials",q.material.memory()));this.__base.FG3dAutomaticEffect.drawRenderable.call(this,b,f)}
function FE3dGeneralColorAutomaticEffect_drawGroup(b,f,h,q){if(1<q){var u=RConsole.find(FE3rModelConsole).merge(this,b,h,q);if(u){f=null;h=this._graphicContext;u=u.meshes();q=u.count();for(var z=b.spaceName(),A=0;A<q;A++){var B=u.getAt(A),C=B.selectInfo(z);f=C.effect;f||(f=C.effect=RConsole.find(FG3dEffectConsole).find(h,b,B))}return f.drawGroup(b,u,0,q)}}this.__base.FG3dAutomaticEffect.drawGroup.call(this,b,f,h,q)}
var EE3dScene=new function(){this.Scene="scene";this.Layer="layer";this.Display="display";this.Material="material";this.Renderable="renderable";return this};function FE3dBoundBox(b){b=RClass.inherits(this,b,FE3dRenderable);b._outline=null;b._rate=.2;b._vertexPositionBuffer=null;b._vertexColorBuffer=null;b.construct=FE3dBoundBox_construct;b.outline=FE3dBoundBox_outline;b.setup=FE3dBoundBox_setup;b.upload=FE3dBoundBox_upload;return b}
function FE3dBoundBox_construct(){this.__base.FE3dRenderable.construct.call(this);this._outline=new SOutline3}function FE3dBoundBox_outline(){return this._outline}
function FE3dBoundBox_setup(){var b=this._graphicContext,f=this._vertexPositionBuffer=b.createVertexBuffer();f._name="position";f._formatCd=EG3dAttributeFormat.Float3;this._vertexBuffers.set(f._name,f);for(var h=new Uint8Array(128),f=127;0<=f;f--)h[f]=255;f=this._vertexColorBuffer=b.createVertexBuffer();f._name="color";f._formatCd=EG3dAttributeFormat.Byte4Normal;f.upload(h,4,32);this._vertexBuffers.set(f._name,f);this._vertexCount=32;b=this._indexBuffer=b.createIndexBuffer();b._fillMode=EG3dFillMode.Line;
b._lineWidth=1;b.upload([0,1,0,4,0,12,3,2,3,5,3,13,8,6,8,9,8,14,11,7,11,10,11,15,20,16,20,21,20,24,23,17,23,22,23,25,28,18,28,26,28,29,31,19,31,27,31,30],48);this.update();b=this.material().info();b.effectCode="control";b.ambientColor.set(1,1,1,1)}
function FE3dBoundBox_upload(){var b=this._outline,f=b.max,h=f.x,q=f.y,f=f.z,u=b.min,b=u.x,z=u.y,u=u.z,A=this._rate,B=(h-b)*A,C=(q-z)*A,A=(f-u)*A;this._vertexPositionBuffer.upload([b,q,u,b+B,q,u,h-B,q,u,h,q,u,b,q-C,u,h,q-C,u,b,z+C,u,h,z+C,u,b,z,u,b+B,z,u,h-B,z,u,h,z,u,b,q,u+A,h,q,u+A,b,z,u+A,h,z,u+A,b,q,f-A,h,q,f-A,b,z,f-A,h,z,f-A,b,q,f,b+B,q,f,h-B,q,f,h,q,f,b,q-C,f,h,q-C,f,b,z+C,f,h,z+C,f,b,z,f,b+B,z,f,h-B,z,f,h,z,f],12,32)}
function FE3dCamera(b){b=RClass.inherits(this,b,FG3dPerspectiveCamera);b._rotation=null;b._rotationMatrix=null;b._quaternion=null;b._quaternionX=null;b._quaternionY=null;b._quaternionZ=null;b.construct=FE3dCamera_construct;b.rotation=FE3dCamera_rotation;b.doPitch=FE3dCamera_doPitch;b.doYaw=FE3dCamera_doYaw;b.doRoll=FE3dCamera_doRoll;b.update=FE3dCamera_update;return b}
function FE3dCamera_construct(){this.__base.FG3dPerspectiveCamera.construct.call(this);this._rotation=new SVector3;this._rotationMatrix=new SMatrix3x3;this._quaternion=new SQuaternion;this._quaternionX=new SQuaternion;this._quaternionY=new SQuaternion;this._quaternionZ=new SQuaternion}function FE3dCamera_rotation(){return this._rotation}function FE3dCamera_doPitch(b){this._rotation.x+=b}function FE3dCamera_doYaw(b){this._rotation.y+=b}function FE3dCamera_doRoll(b){this._rotation.z+=b}
function FE3dCamera_update(){var b=this._rotation;this._quaternionX.fromAxisAngle(RMath.vectorAxisX,b.x);this._quaternionY.fromAxisAngle(RMath.vectorAxisY,b.y);this._quaternionZ.fromAxisAngle(RMath.vectorAxisZ,b.z);var f=this._quaternion.identity();f.mul(this._quaternionX);f.mul(this._quaternionY);f.mul(this._quaternionZ);b=this._rotationMatrix;b.build(f);f=this._direction;b.transformPoint3(this._directionTarget,f);f.normalize();this.__base.FG3dPerspectiveCamera.update.call(this)}
function FE3dCube(b){b=RClass.inherits(this,b,FE3dRenderable);b.vertexPositionBuffer=null;b.vertexColorBuffer=null;b.indexBuffer=null;b.setup=FE3dCube_setup;return b}
function FE3dCube_setup(b){this.vertexPositionBuffer=b.createVertexBuffer();this.vertexPositionBuffer.upload([-1,1,-1,1,1,-1,1,-1,-1,-1,-1,-1,-1,1,1,1,1,1,1,-1,1,-1,-1,1],12,8);this.vertexColorBuffer=b.createVertexBuffer();this.vertexColorBuffer.upload([0,1,0,1,1,0,0,1,1,0,0,1,0,0,0,1,0,1,0,1,1,0,1,1,1,0,1,1,0,0,1,1],16,8);this.indexBuffer=context.createIndexBuffer();this.indexBuffer.upload([0,1,2,0,2,3,1,5,6,1,6,2,5,4,7,5,7,6,4,0,3,4,3,7,0,4,5,0,5,1,3,2,6,3,6,7],36);b=this.material().info();b.effectCode=
"control";b.ambientColor.set(1,1,1,1)}function FE3dDimensional(b){b=RClass.inherits(this,b,FE3dRenderable);b._cellSize=null;b._size=null;b._lineColor=null;b._lineCenterColor=null;b._vertexPositionBuffer=null;b._vertexColorBuffer=null;b.construct=FE3dDimensional_construct;b.setup=FE3dDimensional_setup;return b}function FE3dDimensional_construct(){this.__base.FE3dRenderable.construct.call(this);this._cellSize=new SSize2;this._cellSize.set(1,1);this._size=new SSize2;this._size.set(16,16)}
function FE3dDimensional_setup(){for(var b=this._graphicContext,f=this._cellSize.width,h=this._cellSize.height,q=this._size.width,u=q/2,z=this._size.height,A=z/2,B=2*(q+2+(z+2)),C=0,D=0,E=new Float32Array(3*B),F=0,G=new Uint8Array(4*B),K=0,H=new Uint16Array(B),J=0;J<=z;J++){var I=1;0==J-A&&(I=0);E[C++]=f*-u*I;E[C++]=0;E[C++]=h*(J-A);E[C++]=f*u*I;E[C++]=0;E[C++]=h*(J-A);for(I=0;8>I;I++)G[F++]=255;H[K++]=D++;H[K++]=D++}E[C++]=f*-u;E[C++]=0;E[C++]=0;E[C++]=f*u;E[C++]=0;for(I=E[C++]=0;2>I;I++)G[F++]=
255,G[F++]=0,G[F++]=0,G[F++]=255;H[K++]=D++;H[K++]=D++;for(z=0;z<=q;z++){I=1;0==z-u&&(I=0);E[C++]=f*(z-u);E[C++]=0;E[C++]=h*-A*I;E[C++]=f*(z-u);E[C++]=0;E[C++]=h*A*I;for(I=0;8>I;I++)G[F++]=255;H[K++]=D++;H[K++]=D++}E[C++]=0;E[C++]=0;E[C++]=h*-A;E[C++]=0;E[C++]=0;E[C++]=h*A;for(I=0;2>I;I++)G[F++]=255,G[F++]=0,G[F++]=0,G[F++]=255;H[K++]=D++;H[K++]=D++;this._vertexCount=B;f=this._vertexPositionBuffer=b.createVertexBuffer();f._name="position";f._formatCd=EG3dAttributeFormat.Float3;f.upload(E,12,B);this._vertexBuffers.set(f._name,
f);f=this._vertexColorBuffer=b.createVertexBuffer();f._name="color";f._formatCd=EG3dAttributeFormat.Byte4Normal;f.upload(G,4,B);this._vertexBuffers.set(f._name,f);b=this._indexBuffer=b.createIndexBuffer();b._fillMode=EG3dFillMode.Line;b.upload(H,B);B=this.material().info();B.effectCode="control";B.ambientColor.set(1,1,1,1)}
function FE3dMeshRenderable(b){b=RClass.inherits(this,b,FE3dRenderable);b._renderable=null;b._activeSkin=null;b._activeTrack=null;b._bones=null;b.renderable=FE3dMeshRenderable_renderable;b.vertexCount=FE3dMeshRenderable_vertexCount;b.indexBuffer=FE3dMeshRenderable_indexBuffer;b.findTexture=FE3dMeshRenderable_findTexture;b.textures=FE3dMeshRenderable_textures;b.bones=FE3dMeshRenderable_bones;b.process=FE3dMeshRenderable_process;b.processDelay=FE3dMeshRenderable_processDelay;b.update=FE3dMeshRenderable_update;
b.dispose=FE3dMeshRenderable_dispose;return b}function FE3dMeshRenderable_renderable(){return this._renderable}function FE3dMeshRenderable_vertexCount(){return this._renderable.vertexCount()}function FE3dMeshRenderable_indexBuffer(){return this._renderable.indexBuffer()}function FE3dMeshRenderable_findTexture(b){return this._textures.get(b)}function FE3dMeshRenderable_textures(){return this._textures}function FE3dMeshRenderable_bones(b){return this._bones}
function FE3dMeshRenderable_process(b){this.__base.FE3dRenderable.process.call(b);if((b=this._activeTrack)&&this._display._optionPlay){var f=b._animation;f&&f.process(b)}}function FE3dMeshRenderable_processDelay(){}function FE3dMeshRenderable_update(b){var f=this._display,h=this._matrix,q=this._activeTrack,u=this._calculateMatrix;q?(u.assign(q.matrix()),u.append(h)):u.assign(h);f&&(f=this._display.currentMatrix(),u.append(f));this._currentMatrix.attachData(u.data())&&b.change()}
function FE3dMeshRenderable_dispose(){var b=this._modelMatrix;b&&(b.dispose(),this._modelMatrix=null);if(b=this._vertexBuffers)b.dispose(),this._vertexBuffers=null;this.__base.FE3dRenderable.dispose.call(this)}
function FE3dModel(b){b=RClass.inherits(this,b,FDisplay3d);b._dataReady=!1;b._renderables=null;b._animation=null;b._geometrys=null;b._renderable=null;b.testReady=FE3dModel_testReady;b.loadRenderable=FE3dModel_loadRenderable;b.processLoad=FE3dModel_processLoad;b.process=FE3dModel_process;return b}function FE3dModel_testReady(){return this._dataReady}
function FE3dModel_loadRenderable(b){var f=this._context;b.resource();if(b=b.geometrys())if(f=b.count(),0<f)for(var h=this._geometrys=new TObjects,q=this.renderables(),u=0;u<f;u++){var z=b.get(u),A=RClass.create(FModelRenderable3d);A._display=this;A.load(z);h.push(A);q.push(A)}this._dataReady=!0}function FE3dModel_processLoad(){if(this._dataReady)return!0;if(!this._renderable.testReady())return!1;this.loadRenderable(this._renderable);return!0}
function FE3dModel_process(){this.__base.FDisplay3d.process.call(this);this._animation&&this._animation.process();return!0}function FE3dModelConsole(b){b=RClass.inherits(this,b,FConsole);b._scopeCd=EScope.Local;b._loadModels=null;b._models=null;b._thread=null;b._interval=100;b.onProcess=FE3dModelConsole_onProcess;b.construct=FE3dModelConsole_construct;b.models=FE3dModelConsole_models;b.alloc=FE3dModelConsole_alloc;b.free=FE3dModelConsole_free;return b}
function FE3dModelConsole_onProcess(){var b=this._loadModels;for(b.record();b.next();)b.current().processLoad()&&b.removeCurrent()}function FE3dModelConsole_construct(){this._loadModels=new TLooper;this._models=new TDictionary;var b=this._thread=RClass.create(FThread);b.setInterval(this._interval);b.addProcessListener(this,this.onProcess);RConsole.find(FThreadConsole).start(b)}function FE3dModelConsole_models(){return this._models}
function FE3dModelConsole_alloc(b,f){var h=this._models.get(f);if(h&&!h.isEmpty())return h.pop();var h=RConsole.find(FE3rModelConsole).load(b,f),q=RClass.create(FModel3d);q._context=b;q._name=f;q._modelName=f;q._renderable=h;this._loadModels.push(q);return q}function FE3dModelConsole_free(b){b.remove();var f=b._modelName,h=this._models.get(f);null==h&&(h=new TObjects,this._models.set(f,h));h.push(b)}
function FE3dModelRenderable(b){b=RClass.inherits(this,b,FG3dRenderable);b._ready=!1;b._renderable=null;b._bones=null;b._materialResource=null;b.construct=FE3dModelRenderable_construct;b.testVisible=FE3dModelRenderable_testVisible;b.vertexCount=FE3dModelRenderable_vertexCount;b.findVertexBuffer=FE3dModelRenderable_findVertexBuffer;b.vertexBuffers=FE3dModelRenderable_vertexBuffers;b.indexBuffer=FE3dModelRenderable_indexBuffer;b.findTexture=FE3dModelRenderable_findTexture;b.textures=FE3dModelRenderable_textures;
b.bones=FE3dModelRenderable_bones;b.load=FE3dModelRenderable_load;b.build=FE3dModelRenderable_build;b.update=FE3dModelRenderable_update;return b}function FE3dModelRenderable_construct(){this.__base.FG3dRenderable.construct.call(this)}function FE3dModelRenderable_testVisible(b){b=this._ready;if(!b){var f=this._renderable;f&&(b=this._ready=f.testReady())}return b}function FE3dModelRenderable_vertexCount(){return this._renderable.vertexCount()}
function FE3dModelRenderable_findVertexBuffer(b){return this._renderable.findVertexBuffer(b)}function FE3dModelRenderable_vertexBuffers(){return this._renderable.vertexBuffers()}function FE3dModelRenderable_indexBuffer(){return this._renderable.indexBuffer()}function FE3dModelRenderable_findTexture(b){return this._renderable.findTexture(b)}function FE3dModelRenderable_textures(){return this._renderable.textures()}function FE3dModelRenderable_bones(b){return this._bones}
function FE3dModelRenderable_load(b){var f=this._material,h=this._materialResource=b.material();h&&f.assignInfo(h.info());this._effectCode=f.info().effectCode;this._renderable=b}function FE3dModelRenderable_build(b){var f=this._renderable.boneIds();if(f)for(var h=this._bones=new TObjects,q=f.length(),u=0;u<q;u++){var z=f.get(u),A=b.findBone(z);if(null==A)throw new TError("Bone is not exists. (bone_id={1})",z);h.push(A)}}
function FE3dModelRenderable_update(b){b=this._display.matrix();this._matrix.assign(b)}function FE3dPolygon(b){return b=RClass.inherits(this,b,FE3dRenderable)}function FE3dRectangle(b){b=RClass.inherits(this,b,FE3dRenderable);b._vertexPositionBuffer=null;b._vertexColorBuffer=null;b._indexBuffer=null;b.setup=FE3dRectangle_setup;return b}
function FE3dRectangle_setup(b){this._vertexPositionBuffer=b.createVertexBuffer();this._vertexPositionBuffer.upload([-1,1,0,1,1,0,1,-1,0,-1,-1,0],12,4);this._vertexColorBuffer=b.createVertexBuffer();this._vertexColorBuffer.upload([0,1,0,1,1,0,0,1,1,0,0,1,0,0,0,1],16,4);this._indexBuffer=context.createIndexBuffer();this._indexBuffer.upload([0,1,2,0,2,3],6)}
function FE3dScene(b){b=RClass.inherits(this,b,FE3dStage,MListenerLoad);b._dataReady=!1;b._resource=null;b._dirty=!1;b.onProcess=FE3dScene_onProcess;b.construct=FE3dScene_construct;b.createRegion=FE3dScene_createRegion;b.resource=FE3dScene_resource;b.loadTechniqueResource=FE3dScene_loadTechniqueResource;b.loadRegionResource=FE3dScene_loadRegionResource;b.loadDisplayResource=FE3dScene_loadDisplayResource;b.loadLayerResource=FE3dScene_loadLayerResource;b.loadResource=FE3dScene_loadResource;b.dirty=
FE3dScene_dirty;b.processLoad=FE3dScene_processLoad;b.active=FE3dScene_active;b.deactive=FE3dScene_deactive;return b}function FE3dScene_onProcess(){this.__base.FE3dStage.onProcess.call(this);if(this._dirty){for(var b=this._region.allRenderables(),f=b.count()-1;0<=f;f--)b.getAt(f).resetInfos();this._dirty=!1}}function FE3dScene_construct(){this.__base.FE3dStage.construct.call(this)}function FE3dScene_createRegion(){return RClass.create(FE3dSceneRegion)}
function FE3dScene_resource(b){return this._resource}function FE3dScene_loadTechniqueResource(b){this._technique._resource=b}
function FE3dScene_loadRegionResource(b){this._region.loadResource(b);var f=b.camera(),h=f.projection(),q=this._camera;q._resource=f;var u=q._projection;q.position().assign(f.position());q.setDirection(f.direction().x,f.direction().y,f.direction().z);q.update();u.size().assign(this._graphicContext.size());u._angle=h.angle();u._znear=h.znear();u._zfar=h.zfar();u.update();h=b.light();b=h.camera();f=b.projection();q=this._directionalLight;q._resource=h;h=q._camera;q=h._projection;h.position().set(1,
1,-1);h.lookAt(0,0,0);h.position().assign(b.position());h.update();q.size().set(1024,1024);q._angle=60;q._znear=f.znear();q._zfar=f.zfar();q.update()}function FE3dScene_loadDisplayResource(b,f){var h=RConsole.find(FE3dSceneConsole).factory().create(EE3dScene.Display);h.linkGraphicContext(this);h.loadSceneResource(f);RConsole.find(FE3dTemplateConsole).loadByGuid(h,f.templateGuid());b.pushDisplay(h)}
function FE3dScene_loadLayerResource(b){var f=RConsole.find(FE3dSceneConsole).factory().create(EE3dScene.Layer);f.loadResource(b);var h=b.displays();if(h)for(var q=h.count(),u=0;u<q;u++){var z=h.get(u);this.loadDisplayResource(f,z)}this.registerLayer(b.code(),f)}function FE3dScene_loadResource(b){this.loadTechniqueResource(b.technique());this.loadRegionResource(b.region());b=b.layers();for(var f=b.count(),h=0;h<f;h++){var q=b.value(h);this.loadLayerResource(q)}}
function FE3dScene_dirty(){this._dirty=!0}function FE3dScene_processLoad(){if(this._dataReady)return!0;if(!this._resource.testReady())return!1;this.loadResource(this._resource);this.processLoadListener(this);return!0}function FE3dScene_active(){this.__base.FE3dStage.active.call(this)}function FE3dScene_deactive(){this.__base.FE3dStage.deactive.call(this)}
function FE3dSceneCanvas(b){b=RClass.inherits(this,b,FE3dCanvas);b._activeScene=null;b._captureStatus=!1;b._capturePosition=null;b._captureCameraPosition=null;b._captureCameraRotation=null;b._actionFullScreen=!1;b._actionPlay=!1;b._actionMovie=!1;b._actionUp=!1;b._actionDown=!1;b._actionForward=!1;b._actionBack=!1;b._cameraMoveRate=.4;b._cameraKeyRotation=.03;b._cameraMouseRotation=.005;b.onEnterFrame=FE3dSceneCanvas_onEnterFrame;b.onMouseCaptureStart=FE3dSceneCanvas_onMouseCaptureStart;b.onMouseCapture=
FE3dSceneCanvas_onMouseCapture;b.onMouseCaptureStop=FE3dSceneCanvas_onMouseCaptureStop;b.onTouchStart=FE3dSceneCanvas_onTouchStart;b.onTouchMove=FE3dSceneCanvas_onTouchMove;b.onTouchStop=FE3dSceneCanvas_onTouchStop;b.onSceneLoad=FE3dSceneCanvas_onSceneLoad;b.onResize=FE3dSceneCanvas_onResize;b.construct=FE3dSceneCanvas_construct;b.load=FE3dSceneCanvas_load;b.switchPlay=FE3dSceneCanvas_switchPlay;b.switchMovie=FE3dSceneCanvas_switchMovie;b.doAction=FE3dSceneCanvas_doAction;b.dispose=FE3dSceneCanvas_dispose;
return b}
function FE3dSceneCanvas_onEnterFrame(){var b=this._activeScene;if(b){var f=b.camera(),h=this._cameraMoveRate,q=this._cameraKeyRotation,u=RKeyboard.isPress(EKeyCode.W),z=RKeyboard.isPress(EKeyCode.S);(u&&!z||this._actionForward)&&f.doWalk(h);(!u&&z||this._actionBack)&&f.doWalk(-h);u=RKeyboard.isPress(EKeyCode.A);z=RKeyboard.isPress(EKeyCode.D);u&&!z&&f.doYaw(q);!u&&z&&f.doYaw(-q);u=RKeyboard.isPress(EKeyCode.Q);z=RKeyboard.isPress(EKeyCode.E);(u&&!z||this._actionUp)&&f.doFly(h);(!u&&z||this._actionDown)&&f.doFly(-h);
h=RKeyboard.isPress(EKeyCode.Z);u=RKeyboard.isPress(EKeyCode.X);h&&!u&&f.doPitch(q);!h&&u&&f.doPitch(-q);f.update();if(this._optionRotation){q=this._rotation;b=b.layers();f=b.count();for(h=0;h<f;h++)u=b.value(h).matrix(),u.setRotation(0,q.y,0),u.update();q.y+=.01}}}
function FE3dSceneCanvas_onMouseCaptureStart(b){var f=this._activeScene;if(f){var h=this._activeScene.region();RConsole.find(FG3dTechniqueConsole).find(this._context,FG3dSelectTechnique).test(h,b.offsetX,b.offsetY);this._capturePosition.set(b.clientX,b.clientY);this._captureCameraRotation.assign(f.camera()._rotation)}}
function FE3dSceneCanvas_onMouseCapture(b){if(this._activeScene){var f=b.clientX-this._capturePosition.x;b=b.clientY-this._capturePosition.y;var h=this._activeScene.camera().rotation(),q=this._captureCameraRotation;h.x=q.x+b*this._cameraMouseRotation;h.y=q.y+f*this._cameraMouseRotation}}function FE3dSceneCanvas_onMouseCaptureStop(b){}
function FE3dSceneCanvas_onTouchStart(b){var f=this._activeScene;if(f){this._activeScene.region();var h=b.touches;1==h.length&&(b.preventDefault(),b=h[0],this._captureStatus=!0,this._capturePosition.set(b.clientX,b.clientY),this._captureCameraPosition.assign(f.camera().position()),this._captureCameraRotation.assign(f.camera().rotation()))}}
function FE3dSceneCanvas_onTouchMove(b){if(this._captureStatus){var f=b.touches;if(1==f.length){b.preventDefault();b=f[0];var f=this._activeScene.camera().rotation(),h=b.clientX-this._capturePosition.x;f.x=this._captureCameraRotation.x+-(b.clientY-this._capturePosition.y)*this._cameraMouseRotation;f.y=this._captureCameraRotation.y+-h*this._cameraMouseRotation}}}function FE3dSceneCanvas_onTouchStop(b){this._captureStatus=!1}
function FE3dSceneCanvas_onSceneLoad(b){b=this._activeScene;var f=this._context.size(),h=b.camera().projection();h.size().set(f.width,f.height);h.update();this.processLoadListener(this,b)}function FE3dSceneCanvas_onResize(b){this.__base.FE3dCanvas.onResize.call(this,b);b=this._context.size();var f=this._activeScene;f&&(f=f.camera().projection(),f.size().set(b.width,b.height),f.update())}
function FE3dSceneCanvas_construct(){this.__base.FE3dCanvas.construct.call(this);this._rotation=new SVector3;this._capturePosition=new SPoint2;this._captureCameraPosition=new SPoint3;this._captureCameraRotation=new SVector3}
function FE3dSceneCanvas_load(b){var f=this._context,h=RConsole.find(FE3dSceneConsole);null!=this._activeScene&&h.free(this._activeScene);b=h.alloc(this._context,b);b.addLoadListener(this,this.onSceneLoad);b.selectTechnique(f,FG3dGeneralTechnique);this._stage=this._activeScene=b;RStage.register("stage3d",b)}function FE3dSceneCanvas_switchPlay(b){for(var f=this._activeScene.allDisplays(),h=f.count(),q=0;q<h;q++){var u=f.get(q);u._movies&&(u._optionPlay=b)}this._actionPlay=b}
function FE3dSceneCanvas_switchMovie(b){for(var f=this._activeScene.allDisplays(),h=f.count(),q=0;q<h;q++){var u=f.get(q);u._movies&&(u._optionMovie=b)}this._actionMovie=b}
function FE3dSceneCanvas_doAction(b,f,h){if(this._activeScene)switch(b.preventDefault(),this._actionBack=this._actionForward=this._actionDown=this._actionUp=!1,f){case "fullscreen":b=this._actionFullScreen=!this._actionFullScreen;RHtml.fullscreen(this._hPanel,b);break;case "play":this.switchMovie(!this._actionMovie);this.switchPlay(this._actionMovie);break;case "up":this._actionUp=h;break;case "down":this._actionDown=h;break;case "forward":this._actionForward=h;break;case "back":this._actionBack=
h}}function FE3dSceneCanvas_dispose(){var b=this._rotation;b&&(b.dispose(),this._rotation=null);this.__base.FE3dCanvas.dispose.call(this)}function FE3dSceneConsole(b){b=RClass.inherits(this,b,FConsole);b._scopeCd=EScope.Local;b._factory=null;b._loadScenes=null;b._scenes=null;b._thread=null;b._interval=100;b.onProcess=FE3dSceneConsole_onProcess;b.construct=FE3dSceneConsole_construct;b.factory=FE3dSceneConsole_factory;b.scenes=FE3dSceneConsole_scenes;b.alloc=FE3dSceneConsole_alloc;return b}
function FE3dSceneConsole_onProcess(){var b=this._loadScenes;for(b.record();b.next();)b.current().processLoad()&&b.removeCurrent()}
function FE3dSceneConsole_construct(){this._loadScenes=new TLooper;this._scenes=new TDictionary;var b=this._factory=RClass.create(FClassFactory);b.register(EE3dScene.Scene,FE3dScene);b.register(EE3dScene.Layer,FE3dSceneLayer);b.register(EE3dScene.Display,FE3dSceneDisplay);b.register(EE3dScene.Material,FE3dSceneMaterial);b.register(EE3dScene.Renderable,FE3dSceneDisplayRenderable);b=this._thread=RClass.create(FThread);b.setInterval(this._interval);b.addProcessListener(this,this.onProcess);RConsole.find(FThreadConsole).start(b)}
function FE3dSceneConsole_factory(){return this._factory}function FE3dSceneConsole_scenes(){return this._scenes}function FE3dSceneConsole_alloc(b,f){var h=RConsole.find(FE3sSceneConsole).load(f),q=RClass.create(FE3dScene);q.linkGraphicContext(b);q._name=f;q._resource=h;q.setup();h.testReady()?q.load(h):this._loadScenes.push(q);return q}
function FE3dSceneDisplay(b){b=RClass.inherits(this,b,FE3dTemplate);b._dataReady=!1;b._optionPlay=!1;b._optionMovie=!1;b._movieMatrix=null;b._resourceScene=null;b._materials=null;b._movies=null;b.construct=FE3dSceneDisplay_construct;b.resourceScene=FE3dSceneDisplay_resourceScene;b.loadSceneResource=FE3dSceneDisplay_loadSceneResource;b.loadResource=FE3dSceneDisplay_loadResource;b.updateMatrix=FE3dSceneDisplay_updateMatrix;return b}
function FE3dSceneDisplay_construct(){this.__base.FE3dTemplate.construct.call(this);this._movieMatrix=new SMatrix3d}function FE3dSceneDisplay_resourceScene(){return this._resourceScene}
function FE3dSceneDisplay_loadSceneResource(b){var f=RConsole.find(FE3dSceneConsole).factory();this._resourceScene=b;this._matrix.assign(b.matrix());var h=b.materials();if(h)for(var q=h.count(),u=this._materials=new TDictionary,z=0;z<q;z++){var A=h.get(z),B=f.create(EE3dScene.Material);B._display=this;B.loadSceneResource(A);u.set(A.groupGuid(),B)}if(h=b.movies())for(q=h.count(),u=this._movies=new TObjects,z=0;z<q;z++)A=h.get(z),B=RClass.create(FE3dSceneDisplayMovie),B.loadResource(A),u.push(B)}
function FE3dSceneDisplay_loadResource(b){var f=RConsole.find(FE3dSceneConsole).factory(),h=this._materials;b=b.displays();var q=b.count();if(0<q)for(var u=0;u<q;u++){var z=b.get(u),A=f.create(EE3dScene.Renderable);A._display=this;A.linkGraphicContext(this);A.loadResource(z);this._meshRenderables.push(A);this.pushRenderable(A);z=z.materials().first();z=h.get(z.groupGuid());A.loadMaterial(z)}}
function FE3dSceneDisplay_updateMatrix(b){b=this._currentMatrix.identity();var f=this._movies;if(f){if(this._optionMovie)for(var h=f.count(),q=0;q<h;q++)f.get(q).process(this._movieMatrix);b.append(this._movieMatrix)}b.append(this._matrix);(b=this._parent)&&this._currentMatrix.append(b._currentMatrix)}
function FE3dSceneDisplayMovie(b){b=RClass.inherits(this,b,FObject);b._resource=null;b._interval=null;b._firstTick=0;b._lastTick=0;b._matrix=new SMatrix3d;b.loadResource=FE3dSceneDisplayMovie_loadResource;b.process=FE3dSceneDisplayMovie_process;return b}function FE3dSceneDisplayMovie_loadResource(b){this._resource=b;this._interval=b._interval;this._matrix.setRotation(b._rotation.x,b._rotation.y*Math.PI/180,b._rotation.z);this._matrix.update()}
function FE3dSceneDisplayMovie_process(b){0==this._firstTick&&(this._firstTick=RTimer.current());0==this._lastTick&&(this._lastTick=RTimer.current());var f=RTimer.current();f-this._lastTick>this._interval&&("rotation"==this._resource.code()&&b.append(this._matrix),this._lastTick=f)}
function FE3dSceneDisplayRenderable(b){b=RClass.inherits(this,b,FE3dTemplateRenderable);b._materialReference=null;b.materialReference=FE3dSceneDisplayRenderable_materialReference;b.loadMaterial=FE3dSceneDisplayRenderable_loadMaterial;b.reloadResource=FE3dSceneDisplayRenderable_reloadResource;return b}function FE3dSceneDisplayRenderable_materialReference(b){return this._materialReference}function FE3dSceneDisplayRenderable_loadMaterial(b){this._materialReference=b;this._material.calculate(b)}
function FE3dSceneDisplayRenderable_reloadResource(){var b=this._material;b.calculate(this._materialReference);b.update()}function FE3dSceneLayer(b){b=RClass.inherits(this,b,FDisplayLayer);b._resource=null;b.resource=FE3dSceneLayer_resource;b.loadResource=FE3dSceneLayer_loadResource;return b}function FE3dSceneLayer_resource(){return this._resource}function FE3dSceneLayer_loadResource(b){this._resource=b}
function FE3dSceneMaterial(b){b=RClass.inherits(this,b,FG3dMaterial);b._display=null;b._resource=null;b.groupGuid=FE3dSceneMaterial_groupGuid;b.resource=FE3dSceneMaterial_resource;b.loadSceneResource=FE3dSceneMaterial_loadSceneResource;b.reload=FE3dSceneMaterial_reload;return b}function FE3dSceneMaterial_groupGuid(b){return this._resource.groupGuid()}function FE3dSceneMaterial_resource(b){return this._resource}
function FE3dSceneMaterial_loadSceneResource(b){this._resource=b;this._info.assign(b.info())}function FE3dSceneMaterial_reload(b){this._info.assign(this._resource.info())}function FE3dSceneRegion(b){b=RClass.inherits(this,b,FE3dRegion);b._resource=null;b.construct=FE3dSceneRegion_construct;b.resource=FE3dSceneRegion_resource;b.loadResource=FE3dSceneRegion_loadResource;b.reloadResource=FE3dSceneRegion_reloadResource;b.dispose=FE3dSceneRegion_dispose;return b}
function FE3dSceneRegion_construct(){this.__base.FE3dRegion.construct.call(this)}function FE3dSceneRegion_resource(){return this._resource}function FE3dSceneRegion_loadResource(b){this._resource=b;this.reloadResource()}function FE3dSceneRegion_reloadResource(){var b=this._resource;b.optionBackground()?(this._backgroundColor.assignPower(b.backgroundColor()),this._backgroundColor.alpha=1):this._backgroundColor.set(0,0,0,0)}
function FE3dSceneRegion_dispose(){this._resource=null;this.__base.FE3dRegion.dispose.call(this)}
function FE3dTemplate(b){b=RClass.inherits(this,b,FE3dDisplay,MGraphicObject,MListenerLoad);b._dataReady=!1;b._ready=!1;b._resource=null;b._meshRenderables=null;b._skeletons=null;b._animations=null;b._resource=null;b.construct=FE3dTemplate_construct;b.testReady=FE3dTemplate_testReady;b.findMeshByCode=FE3dTemplate_findMeshByCode;b.meshRenderables=FE3dTemplate_meshRenderables;b.skeletons=FE3dTemplate_skeletons;b.pushSkeleton=FE3dTemplate_pushSkeleton;b.findAnimation=FE3dTemplate_findAnimation;b.animations=
FE3dTemplate_animations;b.pushAnimation=FE3dTemplate_pushAnimation;b.resource=FE3dTemplate_resource;b.setResource=FE3dTemplate_setResource;b.loadSkeletons=FE3dTemplate_loadSkeletons;b.linkAnimation=FE3dTemplate_linkAnimation;b.loadAnimations=FE3dTemplate_loadAnimations;b.loadResource=FE3dTemplate_loadResource;b.reloadResource=FE3dTemplate_reloadResource;b.processLoad=FE3dTemplate_processLoad;b.process=FE3dTemplate_process;b.dispose=FE3dTemplate_dispose;return b}
function FE3dTemplate_construct(){this.__base.FE3dDisplay.construct.call(this);this._meshRenderables=new TObjects}function FE3dTemplate_testReady(){return this._dataReady}function FE3dTemplate_findMeshByCode(b){for(var f=this._meshRenderables,h=f.count()-1;0<=h;h--){var q=f.getAt(h);if(q._renderable._resource._code==b)return q}return null}function FE3dTemplate_meshRenderables(){return this._meshRenderables}function FE3dTemplate_skeletons(){return this._skeletons}
function FE3dTemplate_pushSkeleton(b){var f=this._skeletons;f||(f=this._skeletons=new TDictionary);this._activeSkeleton||(this._activeSkeleton=b);f.set(b._resource.guid(),b)}function FE3dTemplate_findAnimation(b){var f=this._animations;return f?f.get(b):null}function FE3dTemplate_animations(){return this._animations}function FE3dTemplate_pushAnimation(b){var f=this._animations;f||(f=this._animations=new TDictionary);var h=b.resource();f.set(h.guid(),b)}
function FE3dTemplate_resource(b){return this._resource}function FE3dTemplate_setResource(b){this._resource=b}function FE3dTemplate_loadSkeletons(b){var f=b.count();if(0<f){this.skeletons();for(var h=0;h<f;h++){var q=b.get(h),u=RClass.create(FE3rSkeleton);u.loadResource(q);this.pushSkeleton(u)}}}function FE3dTemplate_linkAnimation(b){b=b.tracks();for(var f=b.count(),h=0;h<f;h++){var q=b.get(h),u=q._resource._meshCode;u&&(this.findMeshByCode(u)._activeTrack=q)}}
function FE3dTemplate_loadAnimations(b){var f=b.count();if(0<f)for(var h=0;h<f;h++){var q=b.get(h),u=this.findAnimation(q.guid());u||(u=q.skeleton()?RClass.create(FE3rSkeletonAnimation):RClass.create(FE3rMeshAnimation),u.loadResource(q),this.pushAnimation(u))}}
function FE3dTemplate_loadResource(b){b=b.displays();var f=b.count();if(0<f)for(var h=0;h<f;h++){var q=b.get(h),u=RClass.create(FE3dTemplateRenderable);u._display=this;u.linkGraphicContext(this);u.loadResource(q);this._meshRenderables.push(u);this.pushRenderable(u)}}function FE3dTemplate_reloadResource(){var b=this._meshRenderables;if(b)for(var f=b.count(),h=0;h<f;h++)b.get(h).reloadResource()}
function FE3dTemplate_processLoad(){if(this._ready)return!0;if(!this._dataReady){if(!this._resource.testReady())return!1;this.loadResource(this._resource);this._dataReady=!0}var b=this._meshRenderables;if(b){for(var f=b.count(),h=0;h<f;h++)if(!b.get(h).testReady())return!1;for(h=0;h<f;h++)b.get(h).load()}if(b=this._animations)for(f=b.count(),h=0;h<f;h++){var q=b.value(h);null==q.resource().skeleton()&&this.linkAnimation(q)}this._ready=!0;this.processLoadListener(this);return this._ready}
function FE3dTemplate_process(){var b=this._animations;if(b)for(var f=b.count(),h=0;h<f;h++)b.value(h).record();this.__base.FE3dDisplay.process.call(this);var q=this._activeSkeleton;if(q&&b)for(f=b.count(),h=0;h<f;h++)b.value(h).process(q)}function FE3dTemplate_dispose(){this._meshRenderables=RObject.dispose(this._meshRenderables);this.__base.FE3dDisplay.dispose.call(this)}
function FE3dTemplateCanvas(b){b=RClass.inherits(this,b,FE3dCanvas);b._activeTemplate=null;b._capturePosition=null;b._captureRotation=null;b.onEnterFrame=FDsSceneCanvas_onEnterFrame;b.onMouseCaptureStart=FE3dTemplateCanvas_onMouseCaptureStart;b.onMouseCapture=FE3dTemplateCanvas_onMouseCapture;b.onMouseCaptureStop=FE3dTemplateCanvas_onMouseCaptureStop;b.onResize=FE3dTemplateCanvas_onResize;b.onTemplateLoad=FE3dTemplateCanvas_onTemplateLoad;b.construct=FE3dTemplateCanvas_construct;b.build=FE3dTemplateCanvas_build;
b.load=FE3dTemplateCanvas_load;b.setPanel=FE3dTemplateCanvas_setPanel;b.dispose=FE3dTemplateCanvas_dispose;return b}
function FE3dTemplateCanvas_onEnterFrame(){var b=this._activeTemplate;if(b){var f=b.camera(),h=.05,q=RKeyboard.isPress(EKeyCode.W),u=RKeyboard.isPress(EKeyCode.S);q&&!u&&f.doWalk(.5);!q&&u&&f.doWalk(-.5);q=RKeyboard.isPress(EKeyCode.A);u=RKeyboard.isPress(EKeyCode.D);q&&!u&&f.doYaw(h);!q&&u&&f.doYaw(-h);q=RKeyboard.isPress(EKeyCode.Q);u=RKeyboard.isPress(EKeyCode.E);q&&!u&&f.doFly(.5);!q&&u&&f.doFly(-.5);u=RKeyboard.isPress(EKeyCode.Z);q=RKeyboard.isPress(EKeyCode.X);u&&!q&&f.doPitch(h);!u&&q&&f.doPitch(-h);
f.update();if(this._optionRotation){h=this._rotation;b=b.layers();f=b.count();for(q=0;q<f;q++)u=b.value(q).matrix(),u.setRotation(0,h.y,0),u.update();h.y+=.01}}}function FE3dTemplateCanvas_onMouseCaptureStart(b){var f=this._activeTemplate;if(f){var h=this._activeTemplate.region();RConsole.find(FG3dTechniqueConsole).find(this._context,FG3dSelectTechnique).test(h,b.offsetX,b.offsetY);this._capturePosition.set(b.clientX,b.clientY);this._captureRotation.assign(f.camera()._rotation)}}
function FE3dTemplateCanvas_onMouseCapture(b){if(this._activeTemplate){var f=b.clientX-this._capturePosition.x;b=b.clientY-this._capturePosition.y;var h=this._activeTemplate.camera().rotation(),q=this._captureRotation;h.x=q.x+.003*b;h.y=q.y+.003*f}}function FE3dTemplateCanvas_onMouseCaptureStop(b){}function FE3dTemplateCanvas_onResize(){var b=this._hPanel,f=b.offsetWidth,b=b.offsetHeight,h=this._hCanvas;h.width=f;h.height=b;this._context.setViewport(0,0,f,b)}
function FE3dTemplateCanvas_onTemplateLoad(b){b=this._activeTemplate;var f=this._context.size(),h=b.camera().projection();h.size().set(f.width,f.height);h.update();this.processLoadListener(this,b)}function FE3dTemplateCanvas_construct(){this.__base.FObject.construct.call(this);this._rotation=new SVector3;this._capturePosition=new SPoint2;this._captureRotation=new SVector3}
function FE3dTemplateCanvas_build(b){b=this._hCanvas=RBuilder.create(b,"CANVAS");b.__linker=this;this._context=REngine3d.createContext(FWglContext,b);RStage.lsnsEnterFrame.register(this,this.onEnterFrame);RStage.start(1E3/60);RWindow.lsnsResize.register(this,this.onResize);RConsole.find(FMouseConsole).register(this)}
function FE3dTemplateCanvas_load(b){var f=this._context,h=RConsole.find(FE3dSceneConsole);null!=this._activeTemplate&&h.free(this._activeTemplate);b=h.alloc(this._context,b);b.addLoadListener(this,this.onTemplateLoad);b.selectTechnique(f,FG3dGeneralTechnique);this._stage=this._activeTemplate=b;RStage.register("stage3d",b)}function FE3dTemplateCanvas_setPanel(b){this._hPanel=b;b.appendChild(this._hCanvas);this.onResize()}
function FE3dTemplateCanvas_dispose(){var b=this._rotation;b&&(b.dispose(),this._rotation=null);this.__base.FObject.dispose.call(this)}
function FE3dTemplateConsole(b){b=RClass.inherits(this,b,FConsole);b._scopeCd=EScope.Local;b._loadTemplates=null;b._templates=null;b._thread=null;b._interval=200;b.onProcess=FE3dTemplateConsole_onProcess;b.construct=FE3dTemplateConsole_construct;b.allocByGuid=FE3dTemplateConsole_allocByGuid;b.allocByCode=FE3dTemplateConsole_allocByCode;b.loadByGuid=FE3dTemplateConsole_loadByGuid;b.loadByCode=FE3dTemplateConsole_loadByCode;b.free=FE3dTemplateConsole_free;return b}
function FE3dTemplateConsole_onProcess(){var b=this._loadTemplates;for(b.record();b.next();)b.current().processLoad()&&b.removeCurrent()}function FE3dTemplateConsole_construct(){this._loadTemplates=new TLooper;this._templates=new TDictionary;var b=this._thread=RClass.create(FThread);b.setInterval(this._interval);b.addProcessListener(this,this.onProcess);RConsole.find(FThreadConsole).start(b)}
function FE3dTemplateConsole_allocByGuid(b,f){var h=this._templates.get(f);if(h&&!h.isEmpty())return h.pop();var h=RConsole.find(FE3sTemplateConsole).loadByGuid(f),q=RClass.create(FE3dTemplate);q.linkGraphicContext(b);q.setName(f);q._resourceGuid=f;q.setResource(h);this._loadTemplates.push(q);return q}
function FE3dTemplateConsole_allocByCode(b,f){var h=this._templates.get(f);if(h&&!h.isEmpty())return h.pop();var h=RConsole.find(FE3sTemplateConsole).loadByCode(f),q=RClass.create(FE3dTemplate);q.linkGraphicContext(b);q.setName(f);q._resourceGuid=f;q.setResource(h);this._loadTemplates.push(q);return q}function FE3dTemplateConsole_loadByGuid(b,f){var h=RConsole.find(FE3sTemplateConsole).loadByGuid(f);b._resourceGuid=f;b.setName(f);b.setResource(h);this._loadTemplates.push(b);return b}
function FE3dTemplateConsole_loadByCode(b,f){var h=RConsole.find(FE3sTemplateConsole).loadByCode(g,f);b._resourceGuid=g;b.setName(c);b.setResource(h);this._loadTemplates.push(b);return b}function FE3dTemplateConsole_free(b){b.remove();var f=b._resourceGuid,h=this._templates.get(f);h||(h=new TObjects,this._templates.set(f,h));h.push(b)}
function FE3dTemplateRenderable(b){b=RClass.inherits(this,b,FE3dMeshRenderable);b._ready=!1;b._resource=null;b._model=null;b._materialCode=null;b._materialResource=null;b.construct=FE3dTemplateRenderable_construct;b.testReady=FE3dTemplateRenderable_testReady;b.testVisible=FE3dTemplateRenderable_testVisible;b.resource=FE3dTemplateRenderable_resource;b.loadResource=FE3dTemplateRenderable_loadResource;b.reloadResource=FE3dTemplateRenderable_reloadResource;b.load=FE3dTemplateRenderable_load;b.dispose=
FE3dTemplateRenderable_dispose;return b}function FE3dTemplateRenderable_construct(){this.__base.FE3dMeshRenderable.construct.call(this)}function FE3dTemplateRenderable_testReady(){if(!this._model.testReady())return!1;var b=this._textures;if(b)for(var f=b.count(),h=0;h<f;h++)if(!b.value(h).testReady())return!1;return!0}function FE3dTemplateRenderable_testVisible(b){return this._visible&&this._ready}function FE3dTemplateRenderable_resource(b){return this._resource}
function FE3dTemplateRenderable_loadResource(b){this._resource=b;this._matrix.assign(b.matrix());var f=b.activeMaterial().material();b.modelGuid();this._model=RConsole.find(FE3rModelConsole).load(this._graphicContext,b.modelGuid(),f.guid());f=this._materialResource=b._activeMaterial._material;this._effectCode=f.info().effectCode;this._material.calculate(f);if(b=f.textures())for(var f=RConsole.find(FE3rTextureConsole),h=this._textures=new TDictionary,q=b.count(),u=0;u<q;u++){var z=b.get(u),A=f.loadBitmap(this._graphicContext,
z.textureGuid(),z.bitmapGuid());h.set(z.code(),A)}}function FE3dTemplateRenderable_reloadResource(){var b=this._material;b.calculate(this._materialResource);b.update()}
function FE3dTemplateRenderable_load(){var b=this._display,f=this._resource,h=f.model(),q=h.skeletons();q&&b.loadSkeletons(q);(q=h.animations())&&b.loadAnimations(q);f.mesh();for(var h=this._renderable=RConsole.find(FE3rModelConsole).findMesh(f.meshGuid()),u=h._vertexBuffers,f=u.count(),q=0;q<f;q++){var z=u.get(q);this._vertexBuffers.set(z._name,z)}if(h=h.skins()){b=b._activeSkeleton;u=this._activeSkin=h.first();h=u.streams();f=h.count();for(q=0;q<f;q++)z=h.get(q).buffer(),this._vertexBuffers.set(z._name,
z);z=u.resource().boneRefers();f=z.count();if(0<f)for(h=this._bones=new TObjects,q=0;q<f;q++){u=z.get(q);u=b.bones().get(u.index());if(null==u)throw new TError(this,"Bone is not exist.");h.push(u)}}this._ready=!0}function FE3dTemplateRenderable_dispose(){this.__base.FE3dMeshRenderable.dispose.call(this)}
var EDataAction=new function(){this.Fetch="fetch";this.Search="search";this.Lov="lov";this.Zoom="zoom";this.Prepare="prepare";this.Insert="insert";this.Update="update";this.Delete="delete";this.First="first";this.Prior="prior";this.Next="next";this.Last="last";this.Action="action";this.FetchLov="fetchLov";this.EndFetch="endfetch";this.EndUpdate="endupdate";this.DsChanged="dschanged";this.Scalar="scalar";this.Complete="complete";this.Process="process";return this},EDataService=new function(){this.Dataset=
"database.dataset";this.List="design.list";this.WebForm="design.webform";this.Translate="design.translate";this.WebDataset="logic.dataset";return this},EEditConfig=new function(){this.Search="S";this.Copy="C";return this};function EEditStatusFace(b){b||(b=this);b.Blur=0;b.Cancel=1;b.Ok=2;return b}
var EEditStatus=new EEditStatusFace,EEventInvoke=new function(){this.Unknown=0;this.Before=1;this.After=2;return this},EEventStatus=new function(){this.Unknown=0;this.Continue=1;this.Stop=2;this.Cancel=3;this.Failure=4;return this},EEventType=new function(){this.Unknown=0;this.Construct=1;this.Initialize=2;this.Build=3;this.Refresh=4;this.Resize=5;this.Visible=6;this.Show=7;this.Hidden=8;this.Enable=9;this.Disable=10;this.Release=11;this.Design=12;this.Action=13;this.Valid=14;this.Mode=15;return this},
ERowStatus=new function(){this.Normal="N";this.Insert="I";this.Update="U";this.Delete="D";return this},EUiAlign=new function(){this.Left="left";this.Center="center";this.Right="right";this.Top="up";this.Middle="middle";this.Bottom="down";this.BottomLeft="bl";this.BottomRight="br";return this},EUiBorder=new function(){this.None=0;this.Square=1;this.Round=2;this.RoundIcon=3;this.RoundDrop=4;this.RoundTitle=5;this.RoundIconDrop=6;return this},EUiBorderStyle=new function(){this.Readonly=1;this.Edit=2;
this.Hover=3;return this},EUiColor=new function(){this.Normal="#FFFFFF";this.Select="#F8C59A";this.Invalid=this.Valid="#FFCCCC";this.Edit="#FFFFFF";this.EditHover="#EBFFFF";this.Require="#FF0000";this.Readonly="#F0F0F0";this.Text="#000000";this.TextEdit="#0066FF";this.TextReadonly="#333333";this.TextInvalid="red";this.Delete="#DDDDDD";this.ColumnReadonly="#FFFFFF";this.Rows=["#FFFFFF","#FAFAFA"];this.RowSelect="#cde5ff";this.RowHover="#E8E8FF";this.RowEdit="#FFFFFF";this.RowEditSelect="#FDEBDB";this.RowEditHover=
"#F8F8E0";this.RoundReadonly=[["#DAF8F8","#24C2DB","#24C2DB","#24C2DB","#DAF8F8"],["#24C2DB","#CFF6F6","#CFF6F6","#CFF6F6","#2AD6F0"],["#24C2DB","#CFF6F6","#F8F8F8","#FFFFFF","#2AD6F0"],["#24C2DB","#FFFFFF","#FFFFFF","#FFFFFF","#2AD6F0"],["#DAF8F8","#2AD6F0","#2AD6F0","#2AD6F0","#DAF8F8"]];this.RoundHover=[["#DAF8F8","#24C2DB","#24C2DB","#24C2DB","#DAF8F8"],["#24C2DB","#CFF6F6","#CFF6F6","#CFF6F6","#2AD6F0"],["#24C2DB","#CFF6F6","#F1FFFF","#FFFFFF","#2AD6F0"],["#24C2DB","#FFFFFF","#FFFFFF","#FFFFFF",
"#2AD6F0"],["#DAF8F8","#2AD6F0","#2AD6F0","#2AD6F0","#DAF8F8"]];this.RoundEdit=[["#DAF8F8","#24C2DB","#24C2DB","#24C2DB","#DAF8F8"],["#24C2DB","#CFF6F6","#CFF6F6","#CFF6F6","#2AD6F0"],["#24C2DB","#CFF6F6","#F1FFFF","#FFFFFF","#2AD6F0"],["#24C2DB","#FFFFFF","#FFFFFF","#FFFFFF","#2AD6F0"],["#DAF8F8","#2AD6F0","#2AD6F0","#2AD6F0","#DAF8F8"]];this.RoundDropReadonly=["#DAF8F8 #24C2DB #24C2DB #24C2DB #24C2DB #24C2DB #24C2DB #DAF8F8".split(" "),"#24C2DB #CFF6F6 #CFF6F6 #CFF6F6 #CFF6F6 #CFF6F6 #CFF6F6 #2AD6F0".split(" "),
"#24C2DB #CFF6F6 #F1FFFF #F1FFFF #F1FFFF #F1FFFF #FFFFFF #2AD6F0".split(" "),"#24C2DB #FFFFFF #FFFFFF #FFFFFF #FFFFFF #FFFFFF #FFFFFF #2AD6F0".split(" "),"#DAF8F8 #2AD6F0 #2AD6F0 #2AD6F0 #2AD6F0 #2AD6F0 #2AD6F0 #DAF8F8".split(" ")];this.RoundDropHover=["#DAF8F8 #24C2DB #24C2DB #24C2DB #24C2DB #24C2DB #24C2DB #DAF8F8".split(" "),"#24C2DB #CFF6F6 #CFF6F6 #CFF6F6 #CFF6F6 #CFF6F6 #CFF6F6 #2AD6F0".split(" "),"#24C2DB #CFF6F6 #F1FFFF #F1FFFF #F1FFFF #F1FFFF #FFFFFF #2AD6F0".split(" "),"#24C2DB #FFFFFF #FFFFFF #FFFFFF #FFFFFF #FFFFFF #FFFFFF #2AD6F0".split(" "),
"#DAF8F8 #2AD6F0 #2AD6F0 #2AD6F0 #2AD6F0 #2AD6F0 #2AD6F0 #DAF8F8".split(" ")];this.RoundDropEdit=["#DAF8F8 #24C2DB #24C2DB #24C2DB #24C2DB #24C2DB #24C2DB #DAF8F8".split(" "),"#24C2DB #CFF6F6 #CFF6F6 #CFF6F6 #CFF6F6 #CFF6F6 #CFF6F6 #2AD6F0".split(" "),"#24C2DB #CFF6F6 #F1FFFF #F1FFFF #F1FFFF #F1FFFF #FFFFFF #2AD6F0".split(" "),"#24C2DB #FFFFFF #FFFFFF #FFFFFF #FFFFFF #FFFFFF #FFFFFF #2AD6F0".split(" "),"#DAF8F8 #2AD6F0 #2AD6F0 #2AD6F0 #2AD6F0 #2AD6F0 #2AD6F0 #DAF8F8".split(" ")];return this},EUiDirection=
new function(){this.Horizontal="H";this.Vertical="V";return this},EUiLabelMode=new function(){this.All="A";this.Label="L";this.Hidden="H";return this},EUiLabelPosition=new function(){this.Left="left";this.Right="right";this.Top="top";this.Bottom="bottom";return this},EUiLayer=new function(){this.Default=2E4;this.Disable=this.Shadow=5E3;this.Window=2E4;this.Drop=4E4;this.Editor=1E4;this.Border=2E4;this.Move=25E3;this.Message=this.Search=45E3;return this},EUiLayout=new function(){this.Display="P";this.Search=
"S";this.Design="G";this.Insert="I";this.Update="U";this.Delete="D";this.Zoom="Z";return this},EUiMerge=new function(){this.Append="append";this.Override="override";this.Disable="disable";return this},EPanel=new function(){this.Container=0;this.Parent=1;this.Size=8;this.Border=2;this.Edit=3;this.Focus=4;this.Design=5;this.Scroll=6;this.Shadow=7;this.Move=9;this.Disable=10;this.Drop=11;return this},EUiPosition=new function(){this.Left="left";this.Right="right";this.Top="top";this.Bottom="bottom";this.Before=
1;this.After=2;this.LineBefore=3;this.LineAfter=4;return this},EUiScroll=new function(){this.None="N";this.Horizontal="H";this.HorizontalAuto="HA";this.Vertical="V";this.VerticalAuto="VA";this.Both="B";this.BothAuto="BA";return this},EUiSize=new function(){this.Normal=0;this.Horizontal=1;this.Vertical=2;this.Both=3;return this};function MDataContainer(b){b=RClass.inherits(this,b,MDataValue);b.dsDataLoad=MDataContainer_dsDataLoad;b.dsDataSave=MDataContainer_dsDataSave;return b}
function MDataContainer_dsDataLoad(b){var f=new TEventProcess(null,this,"oeDataLoad",MDataValue);f.source=b;this.process(f);f.dispose()}function MDataContainer_dsDataSave(b){var f=new TEventProcess(null,this,"oeDataSave",MDataValue);f.source=b;this.process(f);f.dispose()}
function MDataProperties(b){b=RClass.inherits(this,b);b._dataProperties=null;b.dataProperties=MDataProperties_dataProperties;b.dataPropertyGet=MDataProperties_dataPropertyGet;b.dataPropertySet=MDataProperties_dataPropertySet;return b}function MDataProperties_dataProperties(b,f){var h=this._dataProperties;null==h&&(h=this._dataProperties=new TDictionary);return h}function MDataProperties_dataPropertyGet(b){var f=this._dataProperties;return f?f.get(b):null}
function MDataProperties_dataPropertySet(b,f){this.dataProperties().set(b,f)}function MDataValue(b){b=RClass.inherits(this,b);b.oeDataLoad=RMethod.empty;b.oeDataSave=RMethod.empty;return b}function MDescribeFrame(b){b=RClass.inherits(this,b);b._frameName=null;b.buildDefine=MDescribeFrame_buildDefine;return b}function MDescribeFrame_buildDefine(b,f){RString.isEmpty(f)&&(f=this._frameName);var h=RConsole.find(FDescribeFrameConsole).load(f);RControl.build(this,h,null,b)}
function MDesign(b){b=RClass.inherits(this,b);b._statusDesign=!1;b._storage=null;b.oeDesign=MDesign_oeDesign;b.onDesignEnter=RClass.register(b,new AEventMouseEnter("onDesignEnter"),MDesign_onDesignEnter);b.onDesignLeave=RClass.register(b,new AEventMouseEnter("onDesignLeave"),MDesign_onDesignLeave);b.onDesignBegin=RClass.register(b,new AEventMouseEnter("onDesignBegin"),MDesign_onDesignBegin);b.onDesignEnd=RClass.register(b,new AEventMouseEnter("onDesignEnd"),MDesign_onDesignEnd);return b}
function MDesign_oeDesign(b){if(b.isBefore())switch(b.mode){case EDesign.Move:var f=this,h=f._hPanel;if(b.flag)f.isDesign=!0,RHtml.link(h,"className",h.className),RHtml.link(h,"onmousedown",h.onmousedown),h.onmousedown=null,f.onDesignEnter();else if(f.isDesign=!1,h.className=RHtml.findLink(h,"className"),b=RHtml.findLink(h,"onmousedown"))h.onmousedown=b;break;case EDesign.Border:h=this._hPanel,b.flag?(RHtml.link(h,"styleBorder",h.style.border),h.style.border="1 solid red"):h.style.border=RHtml.findLink(h,
"styleBorder")}}function MDesign_onDesignEnter(b){this._hPanel.className=this.style("Design")}function MDesign_onDesignLeave(b){}function MDesign_onDesignBegin(b){b=this._storage=RObject.nvlObj(this._storage);b.designStyle=this._hPanel.className;b.designLayer=this._hPanel.zIndex;this._hPanel.className=this.style("DesignDrag");this._statusDesign=!0}
function MDesign_onDesignEnd(b){b=this._storage=RObject.nvlObj(this._storage);this._hPanel.className=b.designStyle;this._hPanel.zIndex=b.designLayer;this._statusDesign=!1}
function MDisplay(b){b=RClass.inherits(this,b);b._dispDisplay=RClass.register(b,new APtySet(null,"_dispDisplay","disp_mode",EDisplayMode.Display,!1));b._dispSearch=RClass.register(b,new APtySet(null,"_dispSearch","disp_mode",EDisplayMode.Search,!1));b._dispInsert=RClass.register(b,new APtySet(null,"_dispInsert","disp_mode",EDisplayMode.Insert,!1));b._dispUpdate=RClass.register(b,new APtySet(null,"_dispUpdate","disp_mode",EDisplayMode.Update,!1));b._dispDelete=RClass.register(b,new APtySet(null,"_dispDelete",
"disp_mode",EDisplayMode.Delete,!1));b._dispZoom=RClass.register(b,new APtySet(null,"_dispZoom","disp_mode",EDisplayMode.Zoom,!1));b._dispAlign=RClass.register(b,new APtyString(null,"_dispAlign",null,EAlign.Left));b._visible=!0;b.oeMode=MDisplay_oeMode;b.canVisible=MDisplay_canVisible;return b}function MDisplay_oeMode(b){if(b.isBefore()){var f=!0;this.base.MDisplayAble||(f=this.canVisible(b.mode));this.setVisible(f)}}
function MDisplay_canVisible(b){switch(RString.nvl(b,this._emode)){case EMode.Display:return this.dispList;case EMode.Search:return this.dispSearch;case EMode.Insert:return this.dispInsert;case EMode.Update:return this.dispUpdate;case EMode.Delete:return this.dispDelete;case EMode.Zoom:return this.dispZoom}}
function MDragable(b){b=RClass.inherits(this,b);b.onDragStart=RMethod.virtual(b,"onDragStart");b.onDragMove=RMethod.virtual(b,"onDragMove");b.onDragStop=RMethod.virtual(b,"onDragStop");return b}function MDropable(b){return b=RClass.inherits(this,b)}function MDropable_onDropDoubleClick(){this._editable&&this.drop()}function MDropable_onDropClick(){this._editable&&this.drop()}
function MDropable_onBuildDrop(){var b=this.hDrop=RBuilder.newIcon(null,this.styleIcon("Drop"));b.style.width=16;b.style.borderLeft="1 solid #CCCCCC";b.className=this.style("Drop");b.style.cursor="hand";this.attachEvent("onDropEnter",b);this.attachEvent("onDropLeave",b);this.attachEvent("onDropClick",b)}function MDropable_canDrop(){return RClass.isClass(this,MDesign)?!RConsole.find(FDesignConsole).canDesignMove:!0}function MEditable(b){return b=RClass.inherits(this,b)}
function MEditable_testEdit(b){switch(RString.nvl(b,this._emode)){case EMode.Insert:return this.editInsert;case EMode.Update:return this.editUpdate;case EMode.Delete:return this.editDelete;case EMode.Zoom:return this.editZoom}}
function MEditChange(b){b=RClass.inherits(this,b);b._styleChangePanel=RClass.register(b,new AStyle("_styleChangePanel"));b._styleChangeIcon=RClass.register(b,new AStyle("_styleChangeIcon"));b._hChangePanel=null;b._hChangeIcon=null;b.onBuildEditChange=MEditChange_onBuildEditChange;b.onChangeEnter=RClass.register(b,new AEventMouseEnter("onChangeEnter"),MEditChange_onChangeEnter);b.onChangeLeave=RClass.register(b,new AEventMouseLeave("onChangeLeave"),MEditChange_onChangeLeave);b.onChangeClick=RClass.register(b,
new AEventClick("onChangeClick"),MEditChange_onChangeClick);b.construct=MEditChange_construct;b.changeSet=MEditChange_changeSet;b.dispose=MEditChange_dispose;return b}
function MEditChange_onBuildEditChange(b){b=this._hChangePanel;b.className=this.styleName("ChangePanel",MEditChange);b.vAlign="top";b.width=5;this.attachEvent("onChangeEnter",b,this.onChangeEnter);this.attachEvent("onChangeLeave",b,this.onChangeLeave);this.attachEvent("onChangeClick",b,this.onChangeClick);(this._hChangeIcon=RBuilder.appendIcon(b,this.styleName("ChangeIcon",MEditChange),"control.change"))._pname="change.icon"}function MEditChange_onChangeEnter(b){}
function MEditChange_onChangeLeave(b){}function MEditChange_onChangeClick(b){}function MEditChange_construct(){}function MEditChange_changeSet(b){}function MEditChange_dispose(){RHtml.free(this._hChangeIcon);this._hChangeIcon=null;RHtml.free(this._hChangePanel);this._hChangePanel=null}
function MEditDescriptor(b){b=RClass.inherits(this,b,MEditable);b._dataName=RClass.register(b,new APtyString(null,"_dataName"));b._dataCode=RClass.register(b,new APtyString(null,"_dataCode"));b._dataDefault=RClass.register(b,new APtyString(null,"_dataDefault"));b._labelIcon=RClass.register(b,new APtyString(null,"_labelIcon"));b._labelIconDisable=RClass.register(b,new APtyString(null,"_labelIconDisable"));b._labelColor=RClass.register(b,new APtyString(null,"_labelColor"));b._labelAlign=RClass.register(b,
new APtyString(null,"_labelAlign",null,EAlign.Left));b._labelValign=RClass.register(b,new APtyString(null,"_labelValign",null,EAlign.Middle));b._editSearch=RClass.register(b,new APtySet(null,"_editSearch","editAccess",EEditConfig.Search,!1));b._editCopy=RClass.register(b,new APtySet(null,"_editCopy","editAccess",EEditConfig.Copy,!1));b._editAlign=RClass.register(b,new APtyString(null,"_editAlign",null,EAlign.Left));b._editValign=RClass.register(b,new APtyString(null,"_editValign",null,EAlign.Middle));
b._editFormat=RClass.register(b,new APtyString(null,"_editFormat"));b._editUnit=RClass.register(b,new APtyString(null,"_editUnit"));b._editTip=RClass.register(b,new APtyString(null,"_editTip"));b._validInsert=RClass.register(b,new APtySet(null,"_validInsert","validAccess",EDisplayMode.Insert,!1));b._validUpdate=RClass.register(b,new APtySet(null,"_validUpdate","validAccess",EDisplayMode.Update,!1));b._validDelete=RClass.register(b,new APtySet(null,"_validDelete","validAccess",EDisplayMode.Delete,
!1));b._validRequire=RClass.register(b,new APtyBoolean(null,"_validRequire",null,!1));return b}function MEditDescriptor_onDataEnter(b,f){b.__progress||(b._editable&&(b._hover=!0,b.refreshStyle()),this.editTip&&(this.__tip=window.status))}function MEditDescriptor_onDataLeave(b,f){b.__progress||(b._editable&&(this._hover=!1,this.refreshStyle()),this.editTip&&(window.status=this.__tip))}
function MEditDescriptor_onDataKeyDown(b,f){b._editable&&!b._disabled&&(b._invalidText=this.validText(b.text()),b.refreshStyle())}function MEditDescriptor_onDataChange(b,f){if(b._editable&&!b._disabled&&b.isTextChanged()){var h=b.text();(b._invalidText=this.validText(h))&&b.refreshStyle();this.callEvent("onDataChange",this,this.__changedEvent)}}
function MEditDescriptor_onDataEditEnd(b,f){var h=b._invalidText=this.validText(b.text());h?RLogger.debug(this,"Edit valid failed ({0})",h):b.commitValue();b.isTextChanged()&&this.callEvent("onDataChange",this,this.__changedEvent);b.refreshStyle()}function MEditDescriptor_oeSaveCode(b){RString.isEmpty(this.dataName)||RString.isEmpty(this.dataCode)||b.values.set(this.dataName,this.dataCode);return EEventStatus.Stop}
function MEditDescriptor_canValid(b){switch(RString.nvl(b,this._emode)){case EMode.Insert:return this.validInsert;case EMode.Update:return this.validUpdate;case EMode.Delete:return this.validDelete}}function MEditDescriptor_formatValue(b){return RString.nvl(b)}function MEditDescriptor_formatText(b){return RString.nvl(b)}function MEditDescriptor_validText(b){}
function MEditDrop(b){b=RClass.inherits(this,b);b._styleDropPanel=RClass.register(b,new AStyle("_styleDropPanel"));b._styleDropIcon=RClass.register(b,new AStyle("_styleDropIcon"));b._hDropPanel=null;b._hDropIcon=null;b.onBuildEditDrop=MEditDrop_onBuildEditDrop;b.onDropEnter=RClass.register(b,new AEventMouseEnter("onDropEnter"),MEditDrop_onDropEnter);b.onDropLeave=RClass.register(b,new AEventMouseLeave("onDropLeave"),MEditDrop_onDropLeave);b.onDropClick=RClass.register(b,new AEventClick("onDropClick"),
MEditDrop_onDropClick);b.construct=MEditDrop_construct;b.dispose=MEditDrop_dispose;return b}function MEditDrop_onBuildEditDrop(b){b=this._hDropPanel;b.className=this.styleName("DropPanel",MEditDrop);b.width=11;this.attachEvent("onDropEnter",b);this.attachEvent("onDropLeave",b);this.attachEvent("onDropClick",b);(this._hDropIcon=RBuilder.appendIcon(b,this.styleName("DropIcon",MEditDrop),"control.drop")).align="center"}function MEditDrop_onDropEnter(b){}function MEditDrop_onDropLeave(b){}
function MEditDrop_onDropClick(b){}function MEditDrop_construct(){}function MEditDrop_dispose(){RHtml.free(this._hDropIcon);this._hDropIcon=null;RHtml.free(this._hDropPanel);this._hDropPanel=null}
function MEditReference(b){b=RClass.inherits(this,b);b._lovService=RClass.register(b,new APtyString("_lovService",null,EDataService.WebForm));b._lovReference=RClass.register(b,new APtyString("_lovReference"));b._lovFields=RClass.register(b,new APtyString("_lovFields"));b._lovWhere=RClass.register(b,new APtyString("_lovWhere"));b._lovOrder=RClass.register(b,new APtyString("_lovOrder"));b._listView=null;b.onListSelected=RMethod.empty;b.canListView=MEditReference_canListView;b.setLabelStyle=MEditReference_setLabelStyle;
b.doListView=MEditReference_doListView;return b}function MEditReference_onListClick(b){this.canListView()&&this.doListView()}function MEditReference_canListView(){return!RString.isEmpty(this._lovReference)&&this._editable}function MEditReference_setLabelStyle(){RString.isEmpty(this.lovRefer)||(this.hLabel.style.cursor="hand",this.attachEvent("onListClick",this.hLabel),this.hLabel.className="RLine_Underline")}
function MEditReference_doListView(b){var f=this._listView;f||(f=this._listView=top.RControl.create(top.FListWindow));f.linkConsole=RConsole;f.linkLovControl(this);f.show();f.fetch(b)}function MEditValidator(b){b=RClass.inherits(this,b);b._validable=!1;b._valid=!0;b._validText=null;b.oeValid=RMethod.empty;return b}function MEditValue(b){b=RClass.inherits(this,b);b._dataValue=RClass.register(b,new APtyString("_dataValue"));b.get=MEditValue_get;b.set=MEditValue_set;return b}
function MEditValue_get(){return this._dataValue}function MEditValue_set(b){this._dataValue=RString.nvl(b)}function MEditValue_oeClearValue(b){b=this.descriptor();RString.isEmpty(b.dataName)||(this.clearValue(),this.dataValue=this.reget());return EEventStatus.Stop}function MEditValue_oeResetValue(b){b=this.descriptor();RString.isEmpty(b.dataName)||(this.resetValue(),this.dataValue=this.reget());return EEventStatus.Stop}
function MEditValue_oeLoadValue(b){var f=this.descriptor();b=b.values;f=f.dataName;!RString.isEmpty(f)&&b.contains(f)&&(f=b.nvl(f),RControl.isInfo(f)?this.setInfoPack(f):RControl.isGroup(f)?this.setGroupPack(f):this.loadValue(b),this.recordValue(),this.dataValue=this.reget());return EEventStatus.Stop}function MEditValue_oeSaveValue(b){var f=this.descriptor();RString.isEmpty(f.dataName)||this.saveValue(b.values);return EEventStatus.Stop}
function MEditValue_oeRecordValue(){var b=this.descriptor();RString.isEmpty(b.dataName)||this.recordValue();return EEventStatus.Stop}function MEditValue_descriptor(){return this}function MEditValue_isTextChanged(){return RString.nvl(this.text())!=this.__recordText}function MEditValue_isDataChanged(){return RString.nvl(this.reget())!=this.__recordValue}function MEditValue_clearValue(){this.set(RString.EMPTY);this.dataValue=RString.EMPTY}
function MEditValue_resetValue(){var b=RString.nvl(this.descriptor().dataDefault);this.set(b);this.dataValue=b}function MEditValue_loadValue(b,f){var h=this.descriptor();EStore.Name==f?this.set(b.get(h.name)):EStore.DataNvl==f?b.contains(h.dataName)&&this.set(b.get(h.dataName)):EStore.Reset==f?this.set(RString.EMPTY):this.set(b.get(h.dataName))}function MEditValue_saveValue(b,f){var h=this.descriptor();EStore.Name==f?b.set(h.name,this.reget()):b.set(h.dataName,this.reget())}
function MEditValue_recordValue(){this.__recordText=RString.nvl(this.text());this.__recordValue=RString.nvl(this.reget())}function MEditValue_commitValue(){this.__commitValue=RString.nvl(this.reget())}function MEditValue_reget(){return this.descriptor().formatValue(this.text())}function MEditValue_setInfoPack(b){var f=this._info;f||(f=this._info=new TControlInfo);f.unpack(b);b=this.descriptor();b.setInfo(f);b!=this&&this.setInfo(f)}function MEditValue_setInfo(b){this.set(b.value)}
function MEditValue_setEditable(b){this._editable=b;this.refreshStyle()}function MEditValue_doFocus(){this._editable&&(this._editing=!0,this.descriptor().onDataEditBegin(this))}function MEditValue_doBlur(){this._editable&&this._editing&&(this.descriptor().onDataEditEnd(this),this._editing=!1)}
function MEditZoom(b){b=RClass.inherits(this,b);b._zoomReference=RClass.register(b,new APtyString("_zoomReference"));b._zoomField=RClass.register(b,new APtyString("_zoomField"));b.testZoom=MEditZoom_testZoom;b.doZoom=MEditZoom_doZoom;return b}function MEditZoom_testZoom(){return!RString.isEmpty(this._zoomReference)}function MEditZoom_doZoom(b){RFormSpace.doZoom(this,b)}
function MListenerBlur(b){b=RClass.inherits(this,b,MListener);b.addBlurListener=MListenerBlur_addBlurListener;b.processBlurListener=MListenerBlur_processBlurListener;return b}function MListenerBlur_addBlurListener(b,f){return this.addListener(EEvent.Blur,b,f)}function MListenerBlur_processBlurListener(b,f,h,q,u){this.processListener(EEvent.Blur,b,f,h,q,u)}
function MListenerClick(b){b=RClass.inherits(this,b,MListener);b.addClickListener=MListenerClick_addClickListener;b.removeClickListener=MListenerClick_removeClickListener;b.processClickListener=MListenerClick_processClickListener;return b}function MListenerClick_addClickListener(b,f){return this.addListener(EEvent.Click,b,f)}function MListenerClick_removeClickListener(b,f){return this.removeListener(EEvent.Click,b,f)}
function MListenerClick_processClickListener(b,f,h,q,u){this.processListener(EEvent.Click,b,f,h,q,u)}function MListenerDataChanged(b){b=RClass.inherits(this,b,MListener);b.addDataChangedListener=MListenerDataChanged_addDataChangedListener;b.processDataChangedListener=MListenerDataChanged_processDataChangedListener;return b}function MListenerDataChanged_addDataChangedListener(b,f){return this.addListener(EEvent.DataChanged,b,f)}
function MListenerDataChanged_processDataChangedListener(b,f,h,q,u){this.processListener(EEvent.DataChanged,b,f,h,q,u)}function MListenerDoubleClick(b){b=RClass.inherits(this,b,MListener);b.addDoubleClickListener=MListenerDoubleClick_addDoubleClickListener;b.processDoubleClickListener=MListenerDoubleClick_processDoubleClickListener;return b}function MListenerDoubleClick_addDoubleClickListener(b,f){return this.addListener(EEvent.DoubleClick,b,f)}
function MListenerDoubleClick_processDoubleClickListener(b,f,h,q,u){this.processListener(EEvent.DoubleClick,b,f,h,q,u)}function MListenerEnter(b){b=RClass.inherits(this,b,MListener);b.addEnterListener=MListenerEnter_addEnterListener;b.processEnterListener=MListenerEnter_processEnterListener;return b}function MListenerEnter_addEnterListener(b,f){return this.addListener(EEvent.Enter,b,f)}function MListenerEnter_processEnterListener(b,f,h,q,u){this.processListener(EEvent.Enter,b,f,h,q,u)}
function MListenerFocus(b){b=RClass.inherits(this,b,MListener);b.addFocusListener=MListenerFocus_addFocusListener;b.processFocusListener=MListenerFocus_processFocusListener;return b}function MListenerFocus_addFocusListener(b,f){return this.addListener(EEvent.Focus,b,f)}function MListenerFocus_processFocusListener(b,f,h,q,u){this.processListener(EEvent.Focus,b,f,h,q,u)}
function MListenerItemClick(b){b=RClass.inherits(this,b,MListener);b.addItemClickListener=MListenerItemClick_addItemClickListener;b.processItemClickListener=MListenerItemClick_processItemClickListener;return b}function MListenerItemClick_addItemClickListener(b,f){return this.addListener(EEvent.ItemClick,b,f)}function MListenerItemClick_processItemClickListener(b,f,h,q,u){this.processListener(EEvent.ItemClick,b,f,h,q,u)}
function MListenerLeave(b){b=RClass.inherits(this,b,MListener);b.addLeaveListener=MListenerLeave_addLeaveListener;b.processLeaveListener=MListenerLeave_processLeaveListener;return b}function MListenerLeave_addLeaveListener(b,f){return this.addListener(EEvent.Leave,b,f)}function MListenerLeave_processLeaveListener(b,f,h,q,u){this.processListener(EEvent.Leave,b,f,h,q,u)}
function MListenerSelected(b){b=RClass.inherits(this,b,MListener);b.addSelectedListener=MListenerSelected_addSelectedListener;b.processSelectedListener=MListenerSelected_processSelectedListener;return b}function MListenerSelected_addSelectedListener(b,f){return this.addListener(EEvent.Selected,b,f)}function MListenerSelected_processSelectedListener(b,f,h,q,u){this.processListener(EEvent.Selected,b,f,h,q,u)}
function MPropertyCheck(b){b=RClass.inherits(this,b);b._valueTrue=RClass.register(b,new APtyNumber("_valueTrue"));b._valueFalse=RClass.register(b,new APtyNumber("_valueFalse"));return b}
function MPropertyEdit(b){b=RClass.inherits(this,b,MEditValidator,MEditReference,MEditZoom);b._editCaseCd=RClass.register(b,new APtyString("_editCaseCd"));b._editPattern=RClass.register(b,new APtyString("_editPattern"));b._editLength=RClass.register(b,new APtyInteger("_editLength"));b._editComplete=RClass.register(b,new APtyBoolean("_editComplete"));b._validLengthMin=RClass.register(b,new APtyInteger("_validLengthMin"));b._validLengthMax=RClass.register(b,new APtyInteger("_validLengthMax"));b.oeValid=
MPropertyEdit_oeValid;return b}function MPropertyEdit_oeValid(b){var f=EEventStatus.Stop;if(this._visible&&this._validable){var h=this.text();if(this.validRequire&&!RValidator.validRequire(this,h))return b.controls.push(this),f;this.editLength&&!RValidator.validTextLength(this,h,this.editLength)&&b.controls.push(this)}return f}
function MPropertyNumber(b){b=RClass.inherits(this,b);b._valueMin=RClass.register(b,new APtyNumber("_valueMin"));b._valueMax=RClass.register(b,new APtyNumber("_valueMax"));return b}
function MPropertySelect(b){b=RClass.inherits(this,b,MEditValidator,MEditReference,MEditZoom);b._editCaseCd=RClass.register(b,new APtyString("_editCaseCd"));b._editPattern=RClass.register(b,new APtyString("_editPattern"));b._editLength=RClass.register(b,new APtyInteger("_editLength"));b._editComplete=RClass.register(b,new APtyBoolean("_editComplete"));b._validLengthMin=RClass.register(b,new APtyInteger("_validLengthMin"));b._validLengthMax=RClass.register(b,new APtyInteger("_validLengthMax"));b.oeValid=
MPropertySelect_oeValid;return b}function MPropertySelect_oeValid(b){var f=EEventStatus.Stop;if(this._visible&&this._validable){var h=this.text();if(this.validRequire&&!RValidator.validRequire(this,h))return b.controls.push(this),f;this.editLength&&!RValidator.validTextLength(this,h,this.editLength)&&b.controls.push(this)}return f}function MUiContainer(b){b=RClass.inherits(this,b);b.createChild=MUiContainer_createChild;b.appendChild=RMethod.empty;b.removeChild=RMethod.empty;return b}
function MUiContainer_createChild(b){b=RControl.newInstance(b);b._parent=this;return b}function MUiFocus(b){b=RClass.inherits(this,b);b.onFocus=RClass.register(b,new AEventFocus("onFocus"),MUiFocus_onFocus);b.onBlur=RClass.register(b,new AEventBlur("onBlur"));b.testFocus=RMethod.emptyTrue;b.testBlur=RMethod.emptyTrue;b.doFocus=RMethod.empty;b.doBlur=RMethod.empty;b.focus=MUiFocus_focus;b.blur=MUiFocus_blur;return b}function MUiFocus_onFocus(b){RConsole.find(FFocusConsole).focus(this,b)}
function MUiFocus_focus(){RConsole.find(FFocusConsole).focus(this)}function MUiFocus_blur(){RConsole.find(FFocusConsole).blur(this)}function MUiHorizontal(b){b=RClass.inherits(this,b);b.setVisible=MUiHorizontal_setVisible;return b}function MUiHorizontal_setVisible(b){var f=this.hPanelLine;f&&RHtml.displaySet(f,b)}
function MUiPadding(b){b=RClass.inherits(this,b);b._padding=RClass.register(b,new APtyPadding("_padding"));b.construct=MUiPadding_construct;b.padding=MUiPadding_padding;b.setPadding=MUiPadding_setPadding;b.refreshPadding=MUiPadding_refreshPadding;b.dispose=MUiPadding_dispose;return b}function MUiPadding_construct(){this._padding=new SPadding}function MUiPadding_padding(){return this._padding}
function MUiPadding_setPadding(b,f,h,q){var u=this._padding,z=this.panel(EPanel.Container);null!=b&&(u.left=b,z&&(z.style.paddingLeft=0==b?null:b+"px"));null!=f&&(u.top=f,z&&(z.style.paddingTop=0==f?null:f+"px"));null!=h&&(u.right=h,z&&(z.style.paddingRight=0==h?null:h+"px"));null!=q&&(u.bottom=q,z&&(z.style.paddingBottom=0==q?null:q+"px"))}function MUiPadding_refreshPadding(){var b=this._padding;this.setPadding(b.left,b.top,b.right,b.bottom)}
function MUiPadding_dispose(){var b=this._padding;b&&(b.dispose(),this._padding=null)}function MUiProgress(b){b=RClass.inherits(this,b);b.oeProgress=RMethod.virtual(b,"oeProgress");return b}
function MUiSize(b){b=RClass.inherits(this,b);b._location=RClass.register(b,new APtyPoint2("_location"));b._size=RClass.register(b,new APtySize2("_size"));b.construct=MUiSize_construct;b.left=MUiSize_left;b.setLeft=MUiSize_setLeft;b.top=MUiSize_top;b.setTop=MUiSize_setTop;b.location=MUiSize_location;b.setLocation=MUiSize_setLocation;b.refreshLocation=MUiSize_refreshLocation;b.width=MUiSize_width;b.setWidth=MUiSize_setWidth;b.height=MUiSize_height;b.setHeight=MUiSize_setHeight;b.size=MUiSize_size;
b.setSize=MUiSize_setSize;b.refreshSize=MUiSize_refreshSize;b.setBounds=MUiSize_setBounds;b.refreshBounds=MUiSize_refreshBounds;b.dispose=MUiSize_dispose;b.innerDump=MUiSize_innerDump;return b}function MUiSize_construct(){this._location=new SPoint2;this._size=new SSize2}function MUiSize_left(){return this._location.x}function MUiSize_setLeft(b){this.setLocation(b,null)}function MUiSize_top(){return this._location.y}function MUiSize_setTop(b){this.setLocation(null,b)}
function MUiSize_location(){return this._location}function MUiSize_setLocation(b,f){var h=this.panel(EPanel.Size);null!=b&&(this._location.x=b,h&&(h.style.left=0==b?null:b+"px"));null!=f&&(this._location.y=f,h&&(h.style.top=0==f?null:f+"px"))}function MUiSize_refreshLocation(){this.setLocation(this._location.x,this._location.y)}function MUiSize_construct(){var b=this;b._location=new SPoint2;b._size=new SSize2}function MUiSize_width(){return this._size.width}
function MUiSize_setWidth(b){this.setSize(b,null)}function MUiSize_height(){return this._size.width}function MUiSize_setHeight(b){this.setSize(null,b)}function MUiSize_size(){return this._size}function MUiSize_setSize(b,f){var h=this.panel(EPanel.Size);null!=b&&(this._size.width=b,h&&("TD"==h.tagName?0!=b&&(h.width=b):h.style.width=0==b?null:b+"px"));null!=f&&(this._size.height=f,h&&("TD"==h.tagName?0!=f&&(h.height=f):h.style.height=0==f?null:f+"px"))}
function MUiSize_refreshSize(){this.setSize(this._size.width,this._size.height)}function MUiSize_setBounds(b,f,h,q){this.setLocation(b,f);this.setSize(h,q)}function MUiSize_refreshBounds(){this.refreshLocation();this.refreshSize()}function MUiSize_dispose(){var b=this._location;b&&(b.dispose(),this._location=null);if(b=this._size)b.dispose(),this._size=null}function MUiSize_innerDump(b,f){b.append("MUiSize:");b.append(this.left,",",this.top,"-",this.width,",",this.height,"]")}
function MUiSize_resize(b,f){var h=!1,q=this.htmlPanel(EPanel.Border).style;null!=b&&(b=Math.max(parseInt(b),EMoveSize.MinWidth),this.width!=b&&(this.width=b,q.pixelWidth=b,h=!0));null!=f&&(f=Math.max(parseInt(f),EMoveSize.MinHeight),this.height!=f&&(this.height=f,q.pixelHeight=f,h=!0));if(h&&this.onSize)this.onSize()}function MUiSize_resetSize(){this.setBounds(this.left,this.top,this.left+this.width-1,this.top+this.height-1,!0)}
function MUiSize_calcRect(){this.rect=RRect.nvl(this.rect);RHtml.toRect(this.rect,this.hPanel);return this.rect}
function MUiSize_setBounds2(b,f,h,q,u){var z=this.panel(EPanel.Size);if(z){var z=z.style,A=!1;b&&0<=b&&(u||this.left!=b)&&(this.left=b,z.pixelLeft=b,A=!0);f&&0<=f&&(u||this.top!=f)&&(this.top=f,z.pixelTop=f,A=!0);h&&0<=h&&(b=h-this.left+1,u||this.width!=b)&&(this.width=b,z.pixelWidth=this.width,A=!0);q&&0<=q&&(q=q-this.top+1,u||this.height!=q)&&(this.height=q,z.pixelHeight=this.height,A=!0);if(A&&this.onSize)this.onSize()}}
function MUiSizeable(b){b=RClass.inherits(this,b);b.isSizeable=!0;b.onSize=null;b.inSizeRange=RMethod.virtual(b,"inSizeRange");b.cursor=MUiSizeable_cursor;b.setCursor=MUiSizeable_setCursor;b.resize=MUiSizeable_resize;b.setBounds=MUiSizeable_setBounds;b.startDrag=MUiSizeable_startDrag;b.stopDrag=MUiSizeable_stopDrag;return b}
function MUiSizeable_cursor(){var b=RWindow.source();if(!this.inSizeRange(b))return ECursor.Default;for(var f=this.panel(EPanel.Border),h=RHtml.rect(f),q=RWindow.offsetPos(),q=new TPoint(q.x-h.left,q.y-h.top);b;){q.x+=b.offsetLeft+b.clientLeft;q.y+=b.offsetTop+b.clientTop;if(b==f)break;b=b.offsetParent}b=EMoveSize.Border;f=EMoveSize.Range;x=q.x;y=q.y;q=h.width();h=h.height();return 0<=x&&x<=f&&0<=y&&y<=f?ECursor.NorthWest:0<=x&&x<=f&&y>=h-f&&y<=h?ECursor.SouthWest:x>=q-f&&x<=q&&y>=h-f&&y<=h?ECursor.SouthEast:
x>=q-f&&x<=q&&0<=y&&y<=f?ECursor.NorthEast:0<=x&&x<b&&y>f&&y<h-f?ECursor.West:x>f&&x<q-f&&y>=h-b&&y<=h?ECursor.South:x>=q-b&&x<=q&&y>f&&y<h-f?ECursor.East:x>f&&x<q-f&&0<=y&&y<b?ECursor.North:ECursor.Default}function MUiSizeable_setCursor(b){b||(b=this.cursor());var f=this.panel(EPanel.Size);f&&(f.style.cursor=null==b||"default"==b?"default":b+"-resize")}
function MUiSizeable_resize(b,f){var h=!1,q=this.htmlPanel(EPanel.Border).style;null!=b&&(b=Math.max(parseInt(b),EMoveSize.MinWidth),this.width!=b&&(this.width=b,q.pixelWidth=b,h=!0));null!=f&&(f=Math.max(parseInt(f),EMoveSize.MinHeight),this.height!=f&&(this.height=f,q.pixelHeight=f,h=!0));if(h&&this.onSize)this.onSize()}
function MUiSizeable_setBounds(b,f,h,q,u){var z=!1,A=this.htmlPanel(EPanel.Border).style;null!=b&&(b=null==h||null!=h&&h-b>EMoveSize.MinWidth?Math.max(b,0):this.left,u||this.left!=b)&&(this.left=b,A.pixelLeft=b,z=!0);null!=f&&(f=null==q||null!=q&&q-f>EMoveSize.MinHeight?Math.max(f,0):this.top,u||this.top!=f)&&(this.top=f,A.pixelTop=f,z=!0);null!=h&&(b=Math.max(h-this.left+1,EMoveSize.MinWidth),u||this.width!=b)&&(this.width=b,A.pixelWidth=this.width,z=!0);null!=q&&(q=Math.max(q-this.top+1,EMoveSize.MinHeight),
u||this.height!=q)&&(this.height=q,A.pixelHeight=this.height,z=!0);if(z&&this.onSize)this.onSize()}function MUiSizeable_startDrag(){}function MUiSizeable_stopDrag(){}function MUiStyle(b){b=RClass.inherits(this,b);b.construct=RMethod.empty;b.styleName=MUiStyle_styleName;b.styleIcon=MUiStyle_styleIcon;b.styleIconPath=MUiStyle_styleIconPath;b.dispose=RMethod.empty;return b}function MUiStyle_styleName(b,f){var h=RClass.name(f?f:this);return RClass.forName(h).style(b)}
function MUiStyle_styleIcon(b,f){return RClass.name(f?f:this,!0)+"_"+b}function MUiStyle_styleIconPath(b,f){return RResource.iconPath(RClass.name(f?f:this,!0)+"_"+b)}function MUiVertical(b){b=RClass.inherits(this,b);b.setVisible=MUiHorizontal_setVisible;return b}function MUiHorizontal_setVisible(b){var f=this.hPanelLine;f&&RHtml.displaySet(f,b)}function TDatasetFetchArg(b){b||(b=this);b.datasets=new TDictionary;b.saveConfig=TDatasetFetchArg_saveConfig;b.process=TDatasetFetchArg_process;return b}
function TDatasetFetchArg_saveConfig(b){b.set("name",this.name)}function TDatasetFetchArg_process(){this.owner?this.callback.call(this.owner,this):this.callback(this)}function TDatasetFetchArg_push(b){RClass.isClass(b,TSearchItem)?this.searchs.push(b):RClass.isClass(b,TOrderItem)&&this.orders.push(b)}function TDatasetFetchArg_invoke(){this.callback&&this.callback.invoke(this)}
function TEvent(b,f,h){this.owner=b;this.code=f;this.type=null;this.onProcess=h;this.isBefore=TEvent_isBefore;this.isAfter=TEvent_isAfter;this.process=TEvent_process;this.dump=TEvent_dump;return this}function TEvent_isBefore(){return EEventType.Before==this.type}function TEvent_isAfter(){return EEventType.After==this.type}
function TEvent_process(){if(!this.onProcess)return RMessage.fatal(this,null,"Process event is null. (owner={0})",RClass.dump(this.owner));var b=new TSpeed(this,"Process event (owner={0}, process={1})",this.owner,RMethod.name(this.onProcess));if(this.owner)this.onProcess.call(this.owner,this);else this.onProcess();b.record()}function TEvent_dump(){return RClass.typeOf(this)+" ["+this.owner+","+this.type+"-"+this.code+"]"}
function TEventProcess(b,f,h,q){b||(b=this);b.owner=f;b.invoke=h;b.clazz=RClass.name(q);b.invokeCd=EEventInvoke.Unknown;b.isBefore=TEventProcess_isBefore;b.isAfter=TEventProcess_isAfter;b.dispose=TEventProcess_dispose;b.dump=TEventProcess_dump;return b}function TEventProcess_isBefore(){return this.invokeCd==EEventInvoke.Before}function TEventProcess_isAfter(){return this.invokeCd==EEventInvoke.After}function TEventProcess_dispose(){this.invokeCd=this.clazz=this.invoke=this.owner=null}
function TEventProcess_dump(){return RClass.dump(this)+":owner="+this.owner+",type="+this.type+".invoke="+RMethod.name(this.invoke)}function THtmlEvent(){this.linker=null;this.events={};this.push=THtmlEvent_push;this.dispose=THtmlEvent_dispose;this.dump=THtmlEvent_dump;return this}
function THtmlEvent_push(b,f){var h=this.events,q=h[b];q||(q=[],q.handle=f.handle,h[b]=q);h=q.length;if(0<h)for(var u=f.annotation.name(),z=0;z<h;z++){var A=q[z].annotation.name();if(A==u)throw new TError(this,"Duplicate event for same control. (name={1}, source={2}, event={3})\n{4}\n{5}",A,RClass.dump(f.source),RClass.dump(f),RString.repeat("-",60),this.dump());}q[q.length]=f}
function THtmlEvent_dispose(){for(var b in this.events){var f=this.events[b];f.length&&(this.linker[f.handle]=null)}this.linker.linker&&this.linker.removeAttribute("link")}function THtmlEvent_dump(){var b=this.events,f=new TString,h;for(h in b){var q=b[h],u=q.length;f.append("event="+h+" (count="+u+")\n");for(var z=0;z<u;z++){var A=q[z];f.append("   "+z+" source="+RClass.dump(A.source)+", event="+RClass.dump(A)+"\n")}}return f.flush()}
function THtmlEvent_load(b){this.ctrlKey=b.ctrlKey;this.keyCode=b.keyCode}function TOrderItem(b){b||(b=this);return b}function TOrderItem_set(b,f){this.name=b;this.type=f}function TOrderItem_toNode(){var b=new TNode("OrderItem");b.set("name",this.name);b.set("type",this.type);return b}function TOrderItem_pack(){var b=new TAttributes;b.set("name",this.name);b.set("type",this.type);return b.pack()}
function TOrderItem_unpack(b){var f=new TAttributes;f.unpack(b);this.name=f.get("name");this.type=f.get("type")}function TOrderItems(b){b||(b=this);TObjects(b)}function TOrderItems_pack(){for(var b=new TStrings,f=this.count,h=0;h<f;h++){var q=this.get(h).pack();b.push(q)}return b.pack()}function TOrderItems_unpack(b){this.clear();var f=new TStrings;f.unpack(b);for(b=0;b<f.count;b++){t=f.get(b);var h=new TOrderItem;h.unpack(t);this.push(h)}}function TSearchItem(b){b||(b=this);return b}
function TSearchItem_set(b,f,h,q){this.name=b;this.type=RString.nvl(h,ESearch.Equals);this.value=f;this.format=q}function TSearchItem_toNode(){var b=new TNode("SearchItem");b.set("name",this.name);b.set("type",this.type);b.set("value",this.value);b.set("format",this.format);return b}function TSearchItem_equals(b){return this.name==b.name&&this.type==b.type&&this.value==b.value?!0:!1}
function TSearchItem_pack(){var b=new TAttributes;b.set("name",this.name);b.set("type",this.type);b.set("value",this.value);b.set("format",this.format);return b.pack()}function TSearchItem_unpack(b){var f=new TAttributes;f.unpack(b);this.name=f.get("name");this.type=f.get("type");this.value=f.get("value");this.format=f.get("format")}function TSearchItems(b){b||(b=this);TObjects(b)}
function TSearchItems_pack(){for(var b=new TStrings,f=this.count,h=0;h<f;h++){var q=this.get(h).pack();b.push(q)}return b.pack()}function TSearchItems_removeAll(b){if(null!=b){for(var f=0,h=this.count,q=f;q<h;q++)this.memory[q].equals(b)||(this.memory[f++]=this.memory[q]);this.count=f}}
function TSearchItems_unpack(b){this.clear();var f=new TStrings;f.unpack(b);for(var h=0;h<f.count;h++){t=f.get(h);var q=new TSearchItem;q.unpack(t);RString.isEmpty(q.name)?(this.clear(),RMessage.fatal(this,"unpack","Invalid value (value={1})",b)):this.push(q)}}
function FUiCanvas(b){b=RClass.inherits(this,b,FUiControl);b._styleCanvas=RClass.register(b,new AStyle("_styleCanvas"));b.onBuildPanel=FUiCanvas_onBuildPanel;b.onBuild=FUiCanvas_onBuild;b.construct=FUiCanvas_construct;b.dispose=FUiCanvas_dispose;return b}function FUiCanvas_onBuildPanel(b){this._hPanel=RBuilder.create(b,"CANVAS",this.styleName("Canvas"))}function FUiCanvas_onBuild(b){this.__base.FUiControl.onBuild.call(this,b)}
function FUiCanvas_construct(){this.__base.FUiControl.construct.call(this)}function FUiCanvas_dispose(){this.__base.FUiControl.dispose.call(this)}
function FUiComponent(b){b=RClass.inherits(this,b,FObject,MProperty,MClone);b._name=RClass.register(b,new APtyString("_name"));b._label=RClass.register(b,new APtyString("_label"));b._parent=null;b._components=null;b._tag=null;b.oeInitialize=FUiComponent_oeInitialize;b.oeRelease=FUiComponent_oeRelease;b.name=FUiComponent_name;b.setName=FUiComponent_setName;b.label=FUiComponent_label;b.setLabel=FUiComponent_setLabel;b.tag=FUiComponent_tag;b.setTag=FUiComponent_setTag;b.isParent=FUiComponent_isParent;
b.topComponent=FUiComponent_topComponent;b.hasComponent=FUiComponent_hasComponent;b.components=FUiComponent_components;b.push=FUiComponent_push;b.remov=FUiComponent_remove;b.clear=FUiComponent_clear;b.process=FUiComponent_process;b.psInitialize=FUiComponent_psInitialize;b.psRelease=FUiComponent_psRelease;b.toString=FUiComponent_toString;b.dispose=FUiComponent_dispose;b.innerDumpInfo=FUiComponent_innerDumpInfo;b.innerDump=FUiComponent_innerDump;return b}
function FUiComponent_oeInitialize(b){return EEventStatus.Continue}function FUiComponent_oeRelease(b){return EEventStatus.Continue}function FUiComponent_name(){return this._name}function FUiComponent_setName(b){this._name=b}function FUiComponent_label(){return this._label}function FUiComponent_setLabel(b){this._label=b}function FUiComponent_tag(){return this._tag}function FUiComponent_setTag(b){this._tag=b}function FUiComponent_isParent(b){for(;b;){if(b==this)return!0;b=b._parent}}
function FUiComponent_topComponent(b){var f=this;if(b)for(;RClass.isClass(f._parent,b);)f=f._parent;else for(;f._parent;)f=f._parent;return f}function FUiComponent_hasComponent(){var b=this._components;return b?!b.isEmpty():!1}function FUiComponent_components(){var b=this._components;null==b&&(this._components=b=new TDictionary);return b}function FUiComponent_push(b){if(RClass.isClass(b,FUiComponent)){var f=this.components();b._parent=this;null==b._name&&(b._name=f.count());f.set(b._name,b)}}
function FUiComponent_remove(b){if(RClass.isClass(b,FUiComponent))throw new TError(this,"Parameter is not componet. (component={1})",b);var f=this._components;if(!f||f&&!f.constanis(b.name()))throw new TError(this,"Parameter component is not in this component. (name={1})",b.name());f.remove(b)}function FUiComponent_clear(b){(b=this._components)&&b.clear()}
function FUiComponent_process(b){var f=this.__base[b.clazz];if(f){b.invokeCd=EEventInvoke.Before;var h=this[b.invoke];if(!h)return RLogger.fatal(this,null,"Process invoke before is null. (sender={1}, invoke={2})",RClass.dump(this),b.invoke);var q=h.call(this,b);if(q==EEventStatus.Stop||q==EEventStatus.Cancel)return q}if(RClass.isClass(this,MUiContainer)&&(h=this._components)){var u=h.count();if(u)for(var z=0;z<u;z++)if(q=h.value(z))if(q=q.process(b),q==EEventStatus.Cancel)return q}if(f){b.invokeCd=
EEventInvoke.After;h=this[b.invoke];if(!h)return RLogger.fatal(this,null,"Process invoke after is null. (sender={1}, invoke={2})",RClass.dump(this),b.invoke);q=h.call(this,b);if(q==EEventStatus.Stop||q==EEventStatus.Cancel)return q}return EEventStatus.Continue}function FUiComponent_psInitialize(){var b=new TEventProcess(null,this,"oeInitialize",FUiComponent);this.process(b);b.dispose()}
function FUiComponent_psRelease(){var b=new TEventProcess(null,this,"oeRelease",FUiComponent);this.process(b);b.dispose()}function FUiComponent_toString(){return RClass.dump(this)+":label="+this._label}function FUiComponent_dispose(){this._tag=this._label=this._name=this._parent=null;var b=this._components;b&&(b.dispose(),this._components=null);this.__base.FObject.dispose.call(this)}
function FUiComponent_innerDumpInfo(b){b.append(RClass.dump(this));b.append(",name=",this._name);b.append(",label=",this._label)}function FUiComponent_innerDump(b,f){this.innerdumpInfo(b);var h=this.components;if(h){b.appendLine();for(var q=h.count,u=0;u<q;u++){var z=h.value(u);z&&z.innerDump(b,f+1)}}return b}
function FUiContainer(b){b=RClass.inherits(this,b,FUiControl,MUiContainer);b._scrollCd=RClass.register(b,new APtyEnum("_scrollCd",null,EUiScroll,EUiScroll.None));b._controls=null;b.oeDesign=RMethod.empty;b.construct=FUiContainer_construct;b.hasControl=FUiContainer_hasControl;b.findControl=FUiContainer_findControl;b.searchControl=FUiContainer_searchControl;b.controls=FUiContainer_controls;b.panel=FUiContainer_panel;b.focusFirstControl=FUiContainer_focusFirstControl;b.setControlsProperty=FUiContainer_setControlsProperty;
b.storeConfig=FUiContainer_storeConfig;b.push=FUiContainer_push;b.remove=FUiContainer_remove;b.clear=FUiContainer_clear;b.dispose=FUiContainer_dispose;return b}function FUiContainer_construct(){this.__base.FUiControl.construct.call(this)}function FUiContainer_hasControl(){var b=this._controls;return b?!b.isEmpty():!1}function FUiContainer_findControl(b){var f=this._controls;if(f)for(var h=f.count(),q=0;q<h;q++){var u=f.value(q);if(u.name()==b)return u}return null}
function FUiContainer_searchControl(b){var f=this._controls;if(f)for(var h=f.count(),q=0;q<h;q++){var u=f.value(q);if(u.name()==b||RClass.isClass(u,FUiContainer)&&(u=u.searchControl(b)))return u}return null}function FUiContainer_controls(){var b=this._controls;null==b&&(this._controls=b=new TDictionary);return b}function FUiContainer_panel(b){return b==EPanel.Container?this._hPanel:this.__base.FUiControl.panel.call(this,b)}
function FUiContainer_focusFirstControl(){var b=this._components;if(b){for(var f=b.count(),h=0;h<f;h++)if(b.valueAt(h),RClass.isClass(f,MUiFocus)&&f.testFocus()&&!RClass.isClass(f,FCalendar)&&!RClass.isClass(f,FSelect)&&!RClass.isClass(f,FNumber))return f.focus();RConsole.find(FFocusConsole).focus(this)}}function FUiContainer_setControlsProperty(b,f){var h=this._controls;if(h)for(var q=h.count()-1;0<=q;q--)h.value(q)[b]=f[n]}
function FUiContainer_storeConfig(b){b.name=RClass.name(this);this.saveConfig(b);var f=this._components;if(f)for(var h=f.count(),q=0;q<h;q++){var u=f.value(q),z=b.create(RClass.name(u));RClass.isClass(u,FUiContainer)?u.storeConfig(z):u.saveConfig(z)}}function FUiContainer_push(b){this.__base.FUiControl.push.call(this,b);RClass.isClass(b,FUiControl)&&(this.controls().set(b._name,b),this.appendChild(b))}
function FUiContainer_remove(b){if(RClass.isClass(b,FUiControl)){var f=this._controls;if(!f||f&&!f.constanis(b.name()))throw new TError(this,"Parameter component is not in this component. (name={1})",b.name());f.remove(b)}this.__base.FUiControl.remove.call(this,b)}function FUiContainer_clear(){var b=this._controls;if(b){for(var f=b.count()-1;0<=f;f--)this.removeChild(b.valueAt(f));b.clear()}this.__base.FUiControl.clear.call(this)}
function FUiContainer_dispose(){var b=this._controls;b&&(b.dispose(),this._controls=null);this.__base.FUiControl.dispose.call(this)}
function FUiControl(b){b=RClass.inherits(this,b,FUiComponent,MUiStyle,MUiSize,MUiPadding);b._visible=RClass.register(b,new APtyBoolean("_visible"),!0);b._disable=RClass.register(b,new APtyBoolean("_disable"),!1);b._nowrap=RClass.register(b,new APtyBoolean("_nowrap"),!1);b._hint=RClass.register(b,new APtyString("_hint"));b._stylePanel=RClass.register(b,new AStyle("_stylePanel"));b._layoutCd=EUiLayout.Display;b._sizeCd=EUiSize.Normal;b._statusVisible=!0;b._statusEnable=!0;b._statusBuild=!1;b._statusBuilded=
!1;b._storage=null;b._hParent=null;b._hPanel=null;b.onEnter=RClass.register(b,new AEventMouseEnter("onEnter"),FUiControl_onEnter);b.onLeave=RClass.register(b,new AEventMouseLeave("onLeave"),FUiControl_onLeave);b.onBuildPanel=FUiControl_onBuildPanel;b.onBuild=FUiControl_onBuild;b.onBuilded=RMethod.empty;b.oeMode=FUiControl_oeMode;b.oeEnable=FUiControl_oeEnable;b.oeVisible=FUiControl_oeVisible;b.oeResize=FUiControl_oeResize;b.oeRefresh=FUiControl_oeRefresh;b.construct=FUiControl_construct;b.topControl=
FUiControl_topControl;b.panel=FUiControl_panel;b.isVisible=FUiControl_isVisible;b.setVisible=FUiControl_setVisible;b.show=FUiControl_show;b.hide=FUiControl_hide;b.isEnable=FUiControl_isEnable;b.setEnable=FUiControl_setEnable;b.enable=FUiControl_enable;b.disable=FUiControl_disable;b.attachEvent=FUiControl_attachEvent;b.linkEvent=FUiControl_linkEvent;b.callEvent=FUiControl_callEvent;b.psMode=FUiControl_psMode;b.psDesign=FUiControl_psDesign;b.psEnable=FUiControl_psEnable;b.psVisible=FUiControl_psVisible;
b.psResize=FUiControl_psResize;b.psRefresh=FUiControl_psRefresh;b.isBuild=FUiControl_isBuild;b.build=FUiControl_build;b.builded=FUiControl_builded;b.refresh=FUiControl_refresh;b.setPanel=FUiControl_setPanel;b.dispose=FUiControl_dispose;return b}function FUiControl_onEnter(b){RConsole.find(FFocusConsole).enter(this);this._hint&&RWindow.setStatus(this._hint)}function FUiControl_onLeave(b){RConsole.find(FFocusConsole).leave(this);this._hint&&RWindow.setStatus()}
function FUiControl_onBuildPanel(b){this._hPanel=RBuilder.createDiv(b,this.styleName("Panel"))}function FUiControl_onBuild(b){this.onBuildPanel(b);this._statusVisible!=this._visible&&this.setVisible(this._visible);b=this._hPanel;RHtml.linkSet(b,"control",this);this.attachEvent("onEnter",b);this.attachEvent("onLeave",b);this.refreshBounds();this.refreshPadding()}function FUiControl_oeMode(b){this._displayCd=b.displayCd;return EEventStatus.Continue}
function FUiControl_oeEnable(b){b.isBefore()&&this.setEnable(b.enable);return EEventStatus.Continue}function FUiControl_oeVisible(b){b.isBefore()&&this.setVisible(b.visible);return EEventStatus.Continue}function FUiControl_oeResize(b){return EEventStatus.Continue}function FUiControl_oeRefresh(b){return EEventStatus.Continue}
function FUiControl_construct(){this.__base.FUiComponent.construct.call(this);this.__base.MUiStyle.construct.call(this);this.__base.MUiSize.construct.call(this);this.__base.MUiPadding.construct.call(this)}function FUiControl_topControl(b){var f=this;if(b){for(;f._parent;){if(RClass.isClass(f._parent,b))return f._parent;f=f._parent}if(!RClass.isClass(f,b))return null}else for(;f._parent&&RClass.isClass(f._parent,FUiControl);)f=f._parent;return f}
function FUiControl_panel(b){switch(b){case EPanel.Parent:return this._hParent;case EPanel.Container:case EPanel.Size:return this._hPanel}return null}function FUiControl_isVisible(){return _statusVisible}function FUiControl_setVisible(b){this._statusVisible=b;var f=this.panel(EPanel.Container);f&&RHtml.visibleSet(f,b)}function FUiControl_show(){this._statusVisible||this.setVisible(!0)}function FUiControl_hide(){this._statusVisible&&this.setVisible(!1)}
function FUiControl_isEnable(){return this._statusEnable}function FUiControl_setEnable(b){this._statusEnable=b;var f=this.panel(EPanel.Container);f&&(f.style.disabled=!b)}function FUiControl_enable(){this._statusEnable||this.setEnable(!0)}function FUiControl_disable(){this._statusEnable&&this.setEnable(!1)}function FUiControl_attachEvent(b,f,h,q){return RControl.attachEvent(this,b,f,h,q)}function FUiControl_linkEvent(b,f,h,q){return RControl.linkEvent(this,b,f,h,q)}
function FUiControl_callEvent(b,f,h){var q=this._events;q&&(b=q.get(b))&&b.invoke(f,f,h)}function FUiControl_psMode(b){var f=new TEventProcess(null,this,"oeMode",FUiControl);f.displayCd=b;this.process(f);f.dispose()}function FUiControl_psDesign(b,f){RConsole.find(FDesignConsole).setFlag(b,f,this);var h=new TEventProcess(null,this,"oeDesign",MDesign);h.mode=b;h.flag=f;this.process(h);h.dispose()}
function FUiControl_psEnable(b){var f=new TEventProcess(null,this,"oeEnable",FUiControl);f.enable=b;this.process(f);f.dispose()}function FUiControl_psVisible(b){var f=new TEventProcess(null,this,"oeVisible",FUiControl);f.visible=b;this.process(f);f.dispose()}function FUiControl_psResize(){var b=new TEventProcess(null,this,"oeResize",FUiControl);this.process(b);b.dispose()}function FUiControl_psRefresh(b){b=new TEventProcess(null,this,"oeRefresh",FUiControl);this.process(b);b.dispose()}
function FUiControl_isBuild(){return this._statusBuild}
function FUiControl_build(b){if(this._statusBuild)throw new TError(this,"Current control is already builded.");var f=null;if(b.createElement)f=b;else if(b.ownerDocument&&b.ownerDocument.createElement)f=b.ownerDocument;else if(b.hDocument)f=b.hDocument;else throw new TError("Build document is invalid. (document={1})",b);b=new SArguments;b.owner=this;b.hDocument=f;this.onBuild(b);b.owner=null;b.hDocument=null;RObject.free(b);this._statusBuild=!0}
function FUiControl_builded(b){if(!this._statusBuild)throw new TError(this,"Current control is not build.");if(this._statusBuilded)throw new TError(this,"Current control is already builded.");this.onBuilded(b);this._statusBuilded=!0}function FUiControl_refresh(){if(!this._statusBuild)throw new TError(this,"Current control is not build.");}function FUiControl_setPanel(b){this._hParent=b;b.appendChild(this._hPanel)}
function FUiControl_dispose(){this._hParent=this._statusBuild=this._statusEnable=this._statusVisible=this._styleContainer=this._hint=this._nowrap=this._disable=null;this._hPanel=RHtml.free(this._hPanel);this.__base.MUiPadding.dispose.call(this);this.__base.MUiSize.dispose.call(this);this.__base.MUiStyle.dispose.call(this);this.__base.FUiComponent.dispose.call(this)}
var RControl=new function(){this.PREFIX="FUi";this.newInstance=RControl_newInstance;this.attachEvent=RControl_attachEvent;this.innerCreate=RControl_innerCreate;this.create=RControl_create;this.innerbuild=RControl_innerbuild;this.build=RControl_build;this.setStyleScroll=RControl_setStyleScroll;this.inDesign=this.inSizing=this.inMoving=!1;this.instances=new TList;this.events=new TMap;this.controls=new TMap;this.linkEvent=RControl_linkEvent;this.find=RControl_find;this.fromNode=RControl_fromNode;this.fromXml=
RControl_fromXml;this.toNode=RControl_toNode;this.toXml=RControl_toXml;this.store=RControl_store;this.htmlControl=RControl_htmlControl;this.psDesign=RControl_psDesign;this.psMode=RControl_psMode;this.isInfo=RControl_isInfo;this.isGroup=RControl_isGroup;return this};
function RControl_newInstance(b){var f=null;if(b){var h=f=null;if(b.constructor==String)RString.startsWith(b,this.PREFIX)||(f=this.PREFIX+b);else if(b.constructor==TXmlNode)f=b.get("type"),RString.isEmpty(f)?(f=b.name(),RString.startsWith(f,this.PREFIX)||(f=this.PREFIX+f)):h=f;else throw new TError(this,"Unknown parameter. (name={p})",b);f=RClass.create(f);h&&(f.__typed=!0)}if(null==f)throw new TError(this,"Create instance failure. (name={p})",b);return f}
function RControl_attachEvent(b,f,h,q,u){var z=null,A=b[f];if(!RMethod.isEmpty(A)||q)f=RClass.find(b.constructor).annotation(EAnnotation.Event,f),z=f.create(),z.annotation=f,z.source=b,z.hSource=h,z.ohProcess=q,z.onProcess=A,z.process=REvent.onProcess,REvent.find(h).push(f.linker(),z),RHtml.linkSet(h,"_plink",b),f.bind(h,u);return z}
function RControl_innerCreate(b,f,h){if(null!=b&&null!=f&&(RClass.isClass(b,MProperty)&&b.propertyLoad(f),RClass.isClass(b,MUiContainer)&&f.hasNode())){f=f.nodes();for(var q=f.count(),u=0;u<q;u++){var z=f.get(u),A=b.createChild(z,h);A&&(this.innerCreate(A,z,h),b.push(A))}}}function RControl_create(b,f,h){var q=null,q=b?b:RControl.newInstance(f.name());this.innerCreate(q,f,h);return q}
function RControl_innerbuild(b,f,h,q,u){if(null!=f&&null!=h){RClass.isClass(f,MProperty)&&f.propertyLoad(h);var z=h.get("linker");z&&b&&(b[z]=f);RClass.isClass(f,FUiControl)&&(f.isBuild()?f.refresh():f.build(u));f.__typed&&(b=f);if(RClass.isClass(f,MUiContainer)&&h.hasNode()){h=h.nodes();for(var z=h.count(),A=0;A<z;A++){var B=h.get(A),C=f.createChild(B);if(!C)throw new TError("Invalid create child.");this.innerbuild(b,C,B,q,u);f.push(C)}}RClass.isClass(f,FUiControl)&&f.builded(u)}}
function RControl_build(b,f,h,q){b||(b=RControl.newInstance(f));this.innerbuild(b,b,f,h,q);return b}
function RControl_setStyleScroll(b,f){var h=b.style;switch(f){case EUiScroll.None:h.overflowX="";h.overflowY="";break;case EUiScroll.Horizontal:h.overflowX="scroll";break;case EUiScroll.HorizontalAuto:h.overflowX="auto";break;case EUiScroll.Vertical:h.overflowY="scroll";break;case EUiScroll.VerticalAuto:h.overflowY="auto";break;case EUiScroll.Both:h.overflow="scroll";break;case EUiScroll.BothAuto:h.overflow="auto";break;default:throw new TError(o,"Unknown scroll type. (scroll_cd={1})",f);}}
function RControl_linkEvent(b,f,h,q,u){var z=b[h];if(!RMethod.isEmpty(z)||u){h=RClass.find(c.constructor).annotation(EAnnotation.Event,h);var A=new h.constructor;A.name=h.name;A.source=b;A.sender=f;A.hSource=q;A.ohProcess=u;A.onProcess=z;A.process=REvent.onProcess;REvent.find(q).push(A.type,A);q[A.handle]=REvent.ohEvent;RHtml.linkSet(q,"_plink",b);return A}}
function RControl_find(b){var f=null;if(b){b.constructor==Function?b=RMethod.name(b):b.constructor!=String&&RMsg.fatal(this,null,"Param invlid (class={0})",b);var h=this.controls,f=h.get(b);f||(f=new TControl(b),h.set(b,f))}return f}function RControl_fromNode(b,f){if(b)return this.create(b,f)}function RControl_fromXml(b,f,h){var q=null;(b=RXml.makeNode(b))&&(q=this.create(b,f,h));return q}function RControl_toNode(){}function RControl_toXml(){}
function RControl_store(b,f){var h=new TNode;h.name=RClass.name(b).substr(1);RClass.isClass(b,FContainer)?b.storeConfig(h):b.saveConfig(h);return h}function RControl_htmlControl(b,f){if(f)for(;b;){var h=RHtml.linkGet(b,"control");if(h&&RClass.isClass(h,f))return h;b=b.parentElement}else for(;b;){if(h=RHtml.linkGet(b,"control"))return h;b=b.parentElement}return null}function RControl_psDesign(b,f,h,q){var u=this.instances;if(u&&u.count)for(var z=u.count,A=0;A<z;A++)u.get(A).psDesign(b,f,h,q)}
function RControl_psMode(b,f,h,q){var u=this.instances;if(u&&u.count)for(var z=u.count,A=0;A<z;A++)u.get(A).psMode(b,f,h,q)}function RControl_isInfo(b){return b?0==b.indexOf("C#"):!1}function RControl_isGroup(b){return b?0==b.indexOf("G#"):!1}
var REvent=new function(){this._objects=[];this.ohEvent=REvent_ohEvent;this.onProcess=REvent_onProcess;this.find=REvent_find;this.process=REvent_process;this.release=REvent_release;this.current=0;this.events=[];this.nvl=REvent_nvl;this.alloc=REvent_alloc;this.free=REvent_free;return this};function REvent_ohEvent(b){REvent.process(this,b?b:window.event)}
function REvent_onProcess(b){b=this;var f=b.annotation;f._logger&&RLogger.debug(b,"Process {1}. (source={2}, html={3}, process={4})",f._handle,RClass.dump(b.source),RClass.dump(b.hSource),RMethod.name(b.onProcess));b.sender?b.onProcess.call(b.source,b.sender,b):b.onProcess.call(b.source,b)}function REvent_find(b){var f=RHtml.uid(b),h=this._objects,q=h[f];null==q&&(q=h[f]=new THtmlEvent,q.linker=b);return q}
function REvent_process(b,f){if(b&&f){var h=this.find(b);if(h&&(h=h.events[f.type])){for(var q=h.length,u=0;u<q;u++){var z=h[u],A=z.annotation;z.source=RHtml.linkGet(b,"_plink");z.hSender=RHtml.eventSource(f);z.sender=z.hSender._plinker;z.hSource=b;A.attach(z,f);z.ohProcess?(A._logger&&RLogger.debug(z,"Execute {1}. (source={2}, html={3}, process={4})",A._handle,RClass.dump(z.source),RClass.dump(z.hSource),RMethod.name(z.ohProcess)),z.ohProcess.call(z.source,z)):z.onProcess&&RConsole.find(FFrameEventConsole).push(z)}return!0}return!1}}
function REvent_release(){var b=this._objects;b&&(RMemory.free(b),this._objects=null)}function REvent_nvl(b,f,h){b||(b=new TEvent);b.sender=f;b.code=h;return b}function REvent_alloc(b,f){for(var h=null,q=this.events,u=0;u<q.length;u++)if(!q[u].inUsing){h=q[u];break}h||(h=q[q.length]=new TEvent);h.inUsing=!0;h.sender=b;h.code=f;return h}function REvent_free(b){b.inUsing=!1}var RUiLayer=new function(){this._layers=[];this.next=RUiLayer_next;this.free=RUiLayer_free;return this};
function RUiLayer_next(b){b=RInteger.nvl(b,EUiLayer.Default);var f=RInteger.nvl(this._layers[b],b);this._layers[b]=++f;return f}function RUiLayer_free(b,f){var h=RInteger.nvl(b,EUiLayer.Default),q=RInteger.nvl(this._layers[h],h);--q;q>h&&(this._layers[h]=q);return q}
function FDescribeFrameConsole(b){b=RClass.inherits(this,b,FConsole);b._scopeCd=EScope.Global;b._service="cloud.describe.frame";b._defines=null;b.lsnsLoaded=null;b.construct=FDescribeFrameConsole_construct;b.load=FDescribeFrameConsole_load;b.events=null;b.formId=0;b.createFromName=FDescribeFrameConsole_createFromName;b.loadNode=FDescribeFrameConsole_loadNode;b.loadService=FDescribeFrameConsole_loadService;b.nextFormId=FDescribeFrameConsole_nextFormId;b.get=FDescribeFrameConsole_get;b.find=FDescribeFrameConsole_find;
b.getLov=FDescribeFrameConsole_getLov;b.findLov=FDescribeFrameConsole_findLov;b.getEvents=FDescribeFrameConsole_getEvents;return b}function FDescribeFrameConsole_construct(){this._defines=new TDictionary;this.lsnsLoaded=new TListeners}
function FDescribeFrameConsole_load(b){var f=this._defines.get(b);if(f)return f;var h=new TXmlDocument,f=h.root();f.set("action","query");f.create("Frame").set("name",b);for(var f=RConsole.find(FXmlConsole).send(RService.url(this._service),h).nodes(),h=f.count(),q=0;q<h;q++){var u=f.get(q);this._defines.set(u.get("name"),u)}f=this._defines.get(b);if(null==f)throw new TError(this,"Unknown frame. (name={1])",b);return f}
function FDescribeFrameConsole_createFromName(b,f){var h=this.loadService(b,f);this.loadNode(h);return EForm.Lov==f?this.getLov(b):this.get(b)}
function FDescribeFrameConsole_loadNode(b){b=b.root();if(b.hasNode()){b=b.nodes;for(var f=b.count,h=0;h<f;h++){var q=b.get(h),u=q.get("name"),z=q.get("type");if(q.hasNode())for(var q=q.nodes,A=0;A<q.count;A++){var B=q.get(A);if(B.isName("Define")){if(B.hasNode())for(var B=B.nodes,C=0;C<B.count;C++){var D=B.get(C);this._defines.get(z).set(u,D)}}else B.isName("Events")&&this.events.set(u,B)}}}}
function FDescribeFrameConsole_loadService(b,f){f||(f=EForm.Form);var h=new TXmlDocument,q=h.root();q.set("action","loadDefine");q=q.create("WebForm");q.set("name",b);q.set("type",f);q=RService.url("logic.webform");h=RConsole.find(FXmlConsole).send(q,h);q=h.root();return RConsole.find(FMessageConsole).checkResult(new TMessageArg(q))?h:null}function FDescribeFrameConsole_nextFormId(){return++this.formId}function FDescribeFrameConsole_get(b){return this._defines.get(EForm.Form).get(b)}
function FDescribeFrameConsole_find(b,f){if(EForm.Lov==f)return this.findLov(b);var h=this.get(b);RClass.isMode(ERun.Debug)&&(RMemory.free(h),h=null,this._defines.get(EForm.Form).set(b,null));h||(h=this.createFromName(b));return h}function FDescribeFrameConsole_getLov(b){return this._defines.get(EForm.Lov).get(b)}function FDescribeFrameConsole_findLov(b){var f=this.getLov(b);f||(f=this.createFromName(b,EForm.Lov));return f}function FDescribeFrameConsole_getEvents(b){return this.events.get(b)}
function FEditorConsole(b){b=RClass.inherits(this,b,FConsole);b._scopeCd=EScope.Local;b._hoverEditor=null;b._focusEditor=null;b._editors=null;b.construct=FEditorConsole_construct;b.makeName=FEditorConsole_makeName;b.enter=FEditorConsole_enter;b.leave=FEditorConsole_leave;b.focus=FEditorConsole_focus;b.blur=FEditorConsole_blur;b.lost=FEditorConsole_lost;return b}function FEditorConsole_construct(){this.__base.FConsole.construct.call(this);this._editors=new TDictionary}
function FEditorConsole_makeName(b,f){return f?f+"@"+RClass.name(b):RClass.name(b)}function FEditorConsole_enter(b,f){var h=RClass.name(f),q=this._hoverEditors.get(h);q||(q=RClass.create(f),q.psBuild(),this._hoverEditors.set(h,q));this._hoverEditor=q;q.editable=b;q.show();return q}function FEditorConsole_leave(b){this._hoverEditor!=this._focusEditor&&(b=RObject.nvl(b,this._hoverEditor),this._hoverEditor=null,RLog.debug(this,"Leave {0}",RClass.dump(b)))}
function FEditorConsole_focus(b,f,h){this.makeName(f,h);var q=this._editors.get(h);q||(q=RClass.create(f),q.build(b._hPanel),this._editors.set(h,q));RLogger.debug(this,"Focus editor {1} (editable={2}, name={3})",RClass.dump(q),RClass.dump(b),h);q.reset();RClass.isClass(q,FUiDropEditor)&&(q.linkControl(b),this._focusEditor=q);return q}
function FEditorConsole_blur(b){if(this._focusEditor){RLogger.debug(this,"Blur editor {1}",RClass.dump(b));if(b=RObject.nvl(b,this._focusEditor))b.onEditEnd();this._focusEditor=null}}function FEditorConsole_lost(b){this.leave(b);this.blur(b)}
function FFocusConsole(b){b=RClass.inherits(this,b,FConsole);b.scope=EScope.Page;b._blurAble=!0;b._focusAble=!0;b._focusClasses=null;b._storeControl=null;b._hoverContainer=null;b._hoverControl=null;b._focusControl=null;b._blurControl=null;b._activeControl=null;b.lsnsFocus=null;b.lsnsBlur=null;b.lsnsFocusClass=null;b.onMouseDown=FFocusConsole_onMouseDown;b.onMouseWheel=FFocusConsole_onMouseWheel;b.construct=FFocusConsole_construct;b.enter=FFocusConsole_enter;b.leave=FFocusConsole_leave;b.isFocus=FFocusConsole_isFocus;
b.focus=FFocusConsole_focus;b.blur=FFocusConsole_blur;b.findClass=FFocusConsole_findClass;b.focusClass=FFocusConsole_focusClass;b.focusHtml=FFocusConsole_focusHtml;b.lockBlur=FFocusConsole_lockBlur;b.unlockBlur=FFocusConsole_unlockBlur;b.storeFocus=FFocusConsole_storeFocus;b.restoreFocus=FFocusConsole_restoreFocus;b.dispose=FFocusConsole_dispose;return b}function FFocusConsole_onMouseDown(b){this.focusHtml(b.hSource)}function FFocusConsole_onMouseWheel(b,f){}
function FFocusConsole_construct(){this.__base.FConsole.construct.call(this);this._focusClasses={};this.lsnsFocus=new TListeners;this.lsnsBlur=new TListeners;this.lsnsFocusClass=new TListeners;RLogger.info(this,"Add listener for window mouse down and wheel.");RWindow.lsnsMouseDown.register(this,this.onMouseDown);RWindow.lsnsMouseWheel.register(this,this.onMouseWheel)}function FFocusConsole_enter(b){RClass.isClass(b,MUiContainer)?this._hoverContainer=b:this._hoverControl=b}
function FFocusConsole_leave(b){this._hoverContainer==b&&(this._hoverContainer=null);this._hoverControl==b&&(this._hoverControl=null)}function FFocusConsole_isFocus(b){return this._focusControl==b}
function FFocusConsole_focus(b,f){if(RClass.isClass(b,MUiFocus)){var h=this._focusControl;h!=b&&(this._blurControl!=h&&this._blurAble&&h&&h.testBlur(b)&&(RLogger.debug(this,"Blur focus control. (name={1}, instance={2})",h.name,RClass.dump(h)),this._blurControl=h,h.doBlur(f),this.lsnsBlur.process(h)),this._focusAble&&(RLogger.debug(this,"Focus control. (name={1}, instance={2})",b.name,RClass.dump(b)),b.doFocus(f),this._focusControl=this._activeControl=b,this.lsnsFocus.process(b)))}}
function FFocusConsole_blur(b,f){var h=this._focusControl,q=this._blurControl;h&&b&&!h.testBlur(b)||(q!=b&&RClass.isClass(b,MUiFocus)&&(RLogger.debug(this,"Blur control. (name={1}, instance={2})",b.name,RClass.dump(b)),this._blurControl=b,b.doBlur(f)),h&&(RLogger.debug(this,"Blur focus control. (name={1}, instance={2})",h.name,RClass.dump(h)),h.doBlur(f),this._focusControl=null))}
function FFocusConsole_findClass(b){var f=RClass.name(b);if(this._focusClasses[f])return this._focusClasses[f];f=this._activeControl;RClass.isClass(f,FEditor)&&(f=f.source);if(f)return f.topControl(b)}function FFocusConsole_focusClass(b,f){var h=RClass.name(b);this._focusClasses[h]!=f&&(this._focusClasses[h]=f,RLogger.debug(this,"Focus class. (name={1}, class={2})",h,RClass.dump(f)),this.lsnsFocusClass.process(f,b))}
function FFocusConsole_focusHtml(b){var f=RHtml.searchLinker(b,FUiControl);RLogger.debug(this,"Focus html control. (control={1}, element={2})",RClass.dump(f),b.tagName);f?this._focusControl!=f&&this.blur(f,b):this.blur(null,b)}function FFocusConsole_lockBlur(){this._blurAble=!1}function FFocusConsole_unlockBlur(){this._blurAble=!0}function FFocusConsole_storeFocus(){this._storeControl=this._focusControl}
function FFocusConsole_restoreFocus(){this._storeControl&&(this._storeControl.focus(),this._storeControl=null)}function FFocusConsole_dispose(){this.__base.FConsole.dispose.call(this);this._focusClasses=null}function FFrameConsole(b){b=RClass.inherits(this,b,FConsole);b._scopeCd=EScope.Local;b._frames=null;b.construct=FFrameConsole_construct;b.create=FFrameConsole_create;b.find=FFrameConsole_find;b.get=FFrameConsole_get;return b}function FFrameConsole_construct(){this._frames=new TMap}
function FFrameConsole_create(b,f){var h=RConsole.find(FDescribeFrameConsole).load(f);return RControl.build(null,h,null,b._hPanel)}function FFrameConsole_find(b){return this._frames.get(b)}function FFrameConsole_get(b,f,h){var q=this._frames,u=q.get(f);u||(u=this.create(b,f),h&&u.setPanel(h),q.set(f,u));return u}function FFrameConsole_hiddenAll(){for(var b=this._frames,f=b.count,h=0;h<f;h++)b.value(h).setVisible(!1)}
function FFrameConsole_onProcessLoaded(b){var f=b.document.root(),h=b.argument;if(!b.messageChecked){var q=new TMessageArg;q.argument=h;q.form=h.form;q.config=f;q.invokeCaller=new TInvoke(this,this.onLoaded);q.invokeParam=b;q.event=b;if(!RConsole.find(FMessageConsole).checkResult(q))return}h=b.argument;if(b=f.find("Form"))b=RDataset.make(b),h.resultDataset=b,h.resultRow=b.rows.get(0);h.invoke()}
function FFrameConsole_process(b){var f=new TXmlDocument,h=f.root();h.set("action","process");b.checked&&h.set("checked",b.checked);h.push(b.toNode());h=new TEvent(this,EXmlEvent.Send,this.onProcessLoaded);h.url=RService.url(RString.nvl(b.url,"logic.webform"));h.action=EDataAction.Process;h.argument=b;h.document=f;RConsole.find(FXmlConsole).process(h)}function FFrameConsole_loadEvents(b){}
function FFrameConsole_processEvent(b){var f=this.events;if(!f.isEmpty()){var h=b.source;if(RClass.isClass(h,FControl)){var q=h.topControl();q&&(q=RString.nvl(b.name,b.handle)+"@"+h.name+"@"+q.name,f=f.get(q),h=b.caller?b.caller:h,f&&f.code&&(f.event||(f.event=new Function("o","e",f.code)),f.event.call(h,h,b)))}}}function FFrameConsole_free(b){b.setVisible(!1);this._freeFrames.push(b)}
function FFrameConsole_dispose(){RMemory.free(this._frames);RMemory.free(this._formIds);RMemory.free(this._framesLoaded);this._framesLoaded=this._formIds=this._frames=null}
function FFrameEventConsole(b){b=RClass.inherits(this,b,FConsole);b._scopeCd=EScope.Local;b._thread=null;b._interval=20;b._allow=!0;b._allows=new TAttributes;b._events=new TObjects;b._listeners=new TAttributes;b.onProcess=FFrameEventConsole_onProcess;b.construct=FFrameEventConsole_construct;b.register=FFrameEventConsole_register;b.push=FFrameEventConsole_push;b.clear=FFrameEventConsole_clear;return b}
function FFrameEventConsole_onProcess(){var b=this._events,f=b.count();if(0<f){for(;;){for(var h=!1,q=0;q<f;q++){var u=b.get(q);if(u){h=!0;u.process();var z=this._listeners.get(RMethod.name(u));z&&z.process(u);b.set(q,null)}}if(!h)break}b.clear()}}
function FFrameEventConsole_construct(){this.__base.FConsole.construct.call(this);var b=this._thread=RClass.create(FThread);b.setInterval(this._interval);b.addProcessListener(this,this.onProcess);RConsole.find(FThreadConsole).start(b);RLogger.debug(this,"Add event thread. (thread={1})",RClass.dump(b))}function FFrameEventConsole_register(b,f){this._events.push(new TEvent(b,null,f))}
function FFrameEventConsole_push(b){var f=RClass.name(b);if(this._allow){var h=!0;this._allows.contains(f)&&(h=RBoolean.isTrue(this._allows.get(f)));if(h){for(var h=this._events,q=h.count(),u=0;u<q;u++)h.get(f)==b&&h.set(f,null);h.push(b)}}}function FFrameEventConsole_clear(){this._events.clear()}function FFrameEventConsole_add(b,f){this._events.push(new TEvent(b,null,f))}function FFrameEventConsole_allowEvent(b){this._allows.set(RMethod.name(b),EBool.True)}
function FFrameEventConsole_skipEvent(b){this._allows.set(RMethod.name(b),EBool.False)}function FFrameEventConsole_allowAll(){this._allow=!0}function FFrameEventConsole_skipAll(){this._allow=!1}function FFrameEventConsole_onlyCall(b,f){this._allow=!1;f.call(b);this._allow=!0}
function FKeyConsole(b){b=RClass.inherits(this,b,FConsole);b._scopeCd=EScope.Local;b._enable=!0;b._enableRegister=!0;b._listeners={};b._disableKeys={};b.onKeyDown=FKeyConsole_onKeyDown;b.construct=FKeyConsole_construct;b.enable=FKeyConsole_enable;b.disable=FKeyConsole_disable;b.enableRegister=FKeyConsole_enableRegister;b.disableRegister=FKeyConsole_disableRegister;b.register=FKeyConsole_register;return b}
function FKeyConsole_onKeyDown(b,f){debugger;var h=REnum.tryDecode(EKey,f.keyCode);if(h&&this._enable){var q=this._listeners[h];q&&(q.process(this,f),f.keyCode=null,f.returnValue=!1)}h&&this._disableKeys[h]&&(f.keyCode=null,f.returnValue=!1)}function FKeyConsole_construct(){this.__base.FConsole.construct.call(this);RWindow.lsnsKeyDown.register(this,this.onKeyDown)}function FKeyConsole_enable(){this._enable=!0}function FKeyConsole_disable(){this._enable=!1}
function FKeyConsole_enableRegister(){this._enableRegister=!0}function FKeyConsole_disableRegister(){this._enableRegister=!1}function FKeyConsole_register(b,f,h){if(this._enableRegister){RInteger.isInteger(b)&&(b=REnum.decode(EKeyCode,b));var q=this._listeners,u=q[b];u||(u=q[b]=new TListeners);u.register(f,h)}}
function FMessageConsole(b){b=RClass.inherits(this,b,FConsole,MUiStyle);b.scope=EScope.Global;b.result=[];b.attributes=[];b.messageBox=null;b.messageWindow=null;b.parse=FMessageConsole_parse;b.popupMessage=FMessageConsole_popupMessage;b.closeMessage=FMessageConsole_closeMessage;b.checkResult=FMessageConsole_checkResult;return b}
function FMessageConsole_parse(b){var f=null;if((b=b.find("Messages"))&&b.nodes&&b.nodes.count)for(var f=new TMessages,h=0;h<b.nodes.count;h++){b.node(h);var q=new TMessage;q.loadConfig(b.node(h));f.push(q)}return f}function FMessageConsole_popupMessage(b){var f=this.messageWindow;f||(f=this.messageWindow=RControl.create("FMessageWindow"));f.loadMessages(b);f.show()}function FMessageConsole_closeMessage(){RWindow.setEnable(!0)}
function FMessageConsole_checkResult(b){var f=b.messages=this.parse(b.config);return f?((f=f.message(EMessage.Fatal))&&"session.timeout"==f.attrType?(b=RString.splitTwo(f.redirect,"@"),b=RContext.context(b[1]+"?do="+b[0]),fmMain.action=b,fmMain.target="_self",fmMain.submit()):this.popupMessage(b),!1):!0}function FResultConsole(b){b=RClass.inherits(this,b,FConsole);b.scope=EScope.Page;b.executeCommand=FResultConsole_executeCommand;b.checkService=FResultConsole_checkService;return b}
function FResultConsole_executeCommand(b){var f=b.get("name");if(EResultCommand.TreeReload==f)(f=RGlobal.get("catalog.tree"))&&f.reload();else if(EResultCommand.TreeNodeRefresh==f){if(f=RGlobal.get("catalog.tree"))if(b=b.get("uuid")){var h=f.findByUuid(b);if(h)f.reloadNode(h);else return alert("Can't find tree node. (uuid="+b+")")}else f.reloadNode()}else EResultCommand.TreeParentRefresh==f?(f=RGlobal.get("catalog.tree"))&&(h=f.focusNode)&&f.reloadNode(h.parentNode):EResultCommand.PageRedirect==f&&
(f=b.get("action"),b=top.RContext.context(b.get("page")),f&&(b+="?do="+f),fmMain.action=b,fmMain.target="",fmMain.submit())}function FResultConsole_checkService(b){if(b){if(!RConsole.find(FMessageConsole).checkResult(new TMessageArg(b)))return!1;if((b=b.find("Commands"))&&b.nodes&&b.nodes.count)for(var f=0;f<b.nodes.count;f++){var h=b.node(f);h.isName("Command")&&this.executeCommand(h)}RConsole.find(FFocusConsole).restoreFocus()}return!0}
var ESplitStyle=new function(){this.Normal="N";this.BulgeLine="B";this.HollowLine="H";return this};function MUiShadow(b){b=RClass.inherits(this,b);b._hShadow=null;b.show=MUiShadow_show;b.hide=MUiShadow_hide;b.setVisible=MUiShadow_setVisible;return b}
function MUiShadow_show(b){this._hShadow||(this._hShadow=RBuilder.createDiv(this._hPanel,"RWindow_Shadow"));this._hShadow.style.zIndex=RUiLayer.next();if(0==b)this.hide();else{if(b=this.panel(EPanel.Shadow)){var f=this._hShadow.style;f.pixelLeft=b.offsetLeft+2;f.pixelTop=b.offsetTop+2;f.pixelWidth=b.offsetWidth;f.pixelHeight=b.offsetHeight;f.display="block"}if(b=this.panel(EPanel.Panel))b.style.zIndex=RUiLayer.next()}}function MUiShadow_hide(){this._hShadow&&(this._hShadow.style.display="none")}
function MUiShadow_setVisible(b){if(b){this._hShadow||(this._hShadow=RBuilder.createDiv(this._hPanel,"RWindow_Shadow"));this._hShadow.style.zIndex=RUiLayer.next();if(b=this.panel(EPanel.Shadow)){b=RHtml.rect(b);var f=this._hShadow.style;f.pixelLeft=b.left+2;f.pixelTop=b.top+2;f.pixelWidth=b.width();f.pixelHeight=b.height();f.display="block"}if(b=this.panel(EPanel.Panel))b.style.zIndex=RUiLayer.next()}else this._hShadow&&(this._hShadow.style.display="none")}
function SUiColorBar(){this._draging=!1;this.typeCd=this.control=null;this.minValue=0;this.maxValue=1;this.hInput=this.hInputPanel=this.hSlideRowBR=this.hSlideRowBM=this.hSlideRowBL=this.hSlideRowMR=this.hSlideRowMM=this.hSlideRowML=this.hSlideRowUR=this.hSlideRowUM=this.hSlideRowUL=this.hSlideForm=this.hSlidePanel=this.hColorImage=this.hColorPanel=this.hPanel=null;this.onMouseDown=SUiColorBar_onMouseDown;this.onMouseMove=SUiColorBar_onMouseMove;this.onMouseUp=SUiColorBar_onMouseUp;this.build=SUiColorBar_build;
this.setRange=SUiColorBar_setRange;this.setColorValue=SUiColorBar_setColorValue;this.setSlideValue=SUiColorBar_setSlideValue;this.setInputValue=SUiColorBar_setInputValue;this.convertSlide=SUiColorBar_convertSlide;this.convertGet=SUiColorBar_convertGet;this.convertSet=SUiColorBar_convertSet;this.get=SUiColorBar_get;this.set=SUiColorBar_set;this.changeSlide=SUiColorBar_changeSlide;this.changeInputEdit=SUiColorBar_changeInputEdit;this.changeInputChange=SUiColorBar_changeInputChange;return this}
function SUiColorBar_onMouseDown(b){b=RHtml.clientX(b.hSource,this.hSlideForm)+b.offsetX;this._draging=!0;RWindow.setOptionSelect(!1);this.changeSlide(b)}function SUiColorBar_onMouseMove(b){this._draging&&(b=RHtml.clientX(b.hSource,this.hSlideForm)+b.offsetX,this.changeSlide(b))}function SUiColorBar_onMouseUp(b){this._draging=!1;RWindow.setOptionSelect(!0)}
function SUiColorBar_build(b){b=this.control;var f=RBuilder.appendTableRow(this.hPanel),h=this.hColorPanel=RBuilder.appendTableCell(f);h.width=13;h.style.padding="2px";this.hColorImage=RBuilder.appendIcon(h,null,"n",11,11);h=this.hSlidePanel=RBuilder.appendTableCell(f);h.style.padding="2px";h.vAlign="middle";var q=this.hSlideForm=RBuilder.appendTable(h);q.__pbar=this;q.width="100%";q.style.height="9px";q.style.cursor="pointer";var u=this.hSlideRowUp=RBuilder.appendTableRow(q);u.style.height="3px";
this.hSlideRowUL=RBuilder.appendTableCell(u);h=this.hSlideRowUM=RBuilder.appendTableCell(u);h.width=2;h.bgColor="#EEEEEE";this.hSlideRowUR=RBuilder.appendTableCell(u);u=this.hSlideRow=RBuilder.appendTableRow(q);u.style.height="3px";h=this.hSlideRowML=RBuilder.appendTableCell(u);h.bgColor="#999999";h=this.hSlideRowMM=RBuilder.appendTableCell(u);h.width=2;h.bgColor="#EEEEEE";h=this.hSlideRowMR=RBuilder.appendTableCell(u);h.bgColor="#999999";u=this.hSlideRowDown=RBuilder.appendTableRow(q);u.style.height=
"3px";this.hSlideRowBL=RBuilder.appendTableCell(u);h=this.hSlideRowBM=RBuilder.appendTableCell(u);h.width=2;h.bgColor="#EEEEEE";this.hSlideRowBR=RBuilder.appendTableCell(u);h=this.hInputPanel=RBuilder.appendTableCell(f,this.control.styleName("InputPanel"));h.width=36;f=this.hInput=RBuilder.appendEdit(h,this.control.styleName("Input"));f._pbar=this;b.attachEvent("onInputKeyPress",f,b.onInputKeyPress);b.attachEvent("onInputEdit",f,b.onInputEdit);b.attachEvent("onInputChange",f,b.onInputChange)}
function SUiColorBar_setRange(b,f){null!=b&&(this.minValue=b);null!=f&&(this.maxValue=f)}function SUiColorBar_setColorValue(b){b=RHex.format(b,2);var f=null;switch(this.typeCd){case "red":f=b+"0000";break;case "green":f="00"+b+"00";break;case "blue":f="0000"+b;break;default:throw new TError(this,"Invalid type.");}this.hColorImage.style.backgroundColor="#"+f}
function SUiColorBar_setSlideValue(b){var f=this.hSlideForm.offsetWidth;0<f&&(this.hSlideRowML.width=RInteger.toRange(b/this.maxValue*f,1,f-1))}function SUiColorBar_setInputValue(b){this.hInput.value=b}function SUiColorBar_convertGet(b){return b}function SUiColorBar_get(){return this.convertGet(this.hInput.value)}function SUiColorBar_convertSet(b){return b}function SUiColorBar_set(b){b=this.convertSet(b);this.setColorValue(b);this.setSlideValue(b);this.setInputValue(b)}
function SUiColorBar_convertSlide(b){return b}function SUiColorBar_changeSlide(b){b=this.convertSlide(b/(this.hSlideForm.offsetWidth-3));this.set(b);this.control.refreshValue()}function SUiColorBar_changeInputEdit(){var b=this.convertGet(this.hInput.value);this.setColorValue(b);this.setSlideValue(b);this.control.refreshValue()}function SUiColorBar_changeInputChange(){var b=this.convertGet(this.hInput.value);this.set(b);this.control.refreshValue()}
function SUiColorChannel(){SUiColorBar.call(this);this.minValue=0;this.maxValue=255;this.setInputValue=SUiColorChannel_setInputValue;this.convertGet=SUiColorChannel_convertGet;this.convertSet=SUiColorChannel_convertSet;return this}function SUiColorChannel_setInputValue(b){b=RInteger.toRange(b,this.minValue,this.maxValue);b=RInteger.format(b);var f=this.hInput;f.value!=b&&(f.value=b)}
function SUiColorChannel_convertGet(b){b=RInteger.parse(RString.nvl(b,"0"));return RInteger.toRange(b,this.minValue,this.maxValue)/255}function SUiColorChannel_convertSet(b){return parseInt(255*b)}
function SUiColorPower(){SUiColorBar.call(this);this.minValue=0;this.maxValue=4;this.setColorValue=SUiColorPower_setColorValue;this.setSlideValue=SUiColorPower_setSlideValue;this.setInputValue=SUiColorPower_setInputValue;this.convertGet=SUiColorPower_convertGet;this.convertSet=SUiColorPower_convertSet;this.convertSlide=SUiColorPower_convertSlide;return this}
function SUiColorPower_setColorValue(b){b=RInteger.toRange(parseInt(255*b),0,255);b=RHex.format(b,2);this.hColorImage.style.backgroundColor="#"+b+b+b}function SUiColorPower_setSlideValue(b){var f=this.hSlideForm.offsetWidth;0<f&&(this.hSlideRowML.width=RInteger.toRange(b/this.maxValue*f,1,f-1))}function SUiColorPower_setInputValue(b){var f=this.hInput;b=RFloat.toRange(b,this.minValue,this.maxValue);b=RFloat.format(b,0,null,2,null);f.value!=b&&(f.value=b)}
function SUiColorPower_convertGet(b){return RFloat.parse(b)}function SUiColorPower_convertSet(b){return b}function SUiColorPower_convertSlide(b){return b*this.maxValue}
function SUiSlide(){this._draging=!1;this.control=null;this.stepValue=1;this.minValue=0;this.range=this.maxValue=100;this.hSlideBR=this.hSlideBM=this.hSlideBL=this.hSlideB=this.hSlideMR=this.hSlideMM=this.hSlideML=this.hSlideM=this.hSlideUR=this.hSlideUM=this.hSlideUL=this.hSlideU=this.hSlideForm=this.hSlidePanel=this.hPanel=null;this.onMouseDown=SUiSlide_onMouseDown;this.onMouseMove=SUiSlide_onMouseMove;this.onMouseUp=SUiSlide_onMouseUp;this.onSlideChange=RMethod.empty;this.build=SUiSlide_build;
this.setRange=SUiSlide_setRange;this.setSlideValue=SUiSlide_setSlideValue;this.get=SUiSlide_get;this.set=SUiSlide_set;this.changeSlide=SUiSlide_changeSlide;return this}function SUiSlide_onMouseDown(b){b=RHtml.clientX(b.hSource,this.hSlideForm)+b.offsetX;this._draging=!0;RWindow.setOptionSelect(!1);this.changeSlide(b)}function SUiSlide_onMouseMove(b){this._draging&&(b=RHtml.clientX(b.hSource,this.hSlideForm)+b.offsetX,this.changeSlide(b))}
function SUiSlide_onMouseUp(b){this._draging=!1;RWindow.setOptionSelect(!0)}
function SUiSlide_build(b){b=this.hSlideForm=RBuilder.appendTable(this.hPanel);b.__pcapture=this;b.width="100%";b.style.height="9px";b.style.cursor="pointer";var f=this.hSlideU=RBuilder.appendTableRow(b);f.style.height="3px";this.hSlideUL=RBuilder.appendTableCell(f);var h=this.hSlideUM=RBuilder.appendTableCell(f);h.width=2;h.bgColor="#EEEEEE";this.hSlideUR=RBuilder.appendTableCell(f);f=this.hSlideM=RBuilder.appendTableRow(b);f.style.height="3px";h=this.hSlideML=RBuilder.appendTableCell(f);h.bgColor=
"#999999";h=this.hSlideMM=RBuilder.appendTableCell(f);h.width=2;h.bgColor="#EEEEEE";h=this.hSlideMR=RBuilder.appendTableCell(f);h.bgColor="#999999";f=this.hSlideB=RBuilder.appendTableRow(b);f.style.height="3px";this.hSlideBL=RBuilder.appendTableCell(f);h=this.hSlideBM=RBuilder.appendTableCell(f);h.width=2;h.bgColor="#EEEEEE";this.hSlideBR=RBuilder.appendTableCell(f)}
function SUiSlide_setRange(b,f){null!=b&&(this.minValue=RFloat.parse(b));null!=f&&(this.maxValue=RFloat.parse(f));this.range=this.maxValue-this.minValue}function SUiSlide_setSlideValue(b){var f=this.hSlideForm.offsetWidth;0<f&&(this.hSlideML.width=RInteger.toRange((b-this.minValue)/this.range*f,1,f-1))}function SUiSlide_get(){return p/(this.hSlideForm.offsetWidth-3)*this.range+this.minValue}function SUiSlide_set(b){this.setSlideValue(b)}
function SUiSlide_changeSlide(b){var f=this.control,h=this.hSlideForm.offsetWidth-3;this.hSlideML.width=RInteger.toRange(b,1,h-1);b=b/h*this.range+this.minValue;b=RFloat.toRange(b,this.minValue,this.maxValue);this.onSlideChange.call(f,b)}
function FListItem(b){b=RClass.inherits(this,b,FControl,MDesign,MUiHorizontal);b.styleForm=RClass.register(b,new TStyle("Form"));b.styleIcon=RClass.register(b,new TStyle("Icon"));b.styleLabel=RClass.register(b,new TStyle("Label"));b.oeBuild=FListItem_oeBuild;b.onBuildPanel=FListItem_onBuildPanel;b.formatValue=FListItem_formatValue;b.text=FListItem_text;b.setText=FListItem_setText;b.dispose=FListItem_dispose;return b}
function FListItem_oeBuild(b){this.base.FControl.oeBuild.call(this,b);if(b.isBefore()){b=(this.hForm=RBuilder.appendTable(this.hPanel,this.style("Form"))).insertRow();var f=b.insertCell();f.className=this.style("Icon");f.width=20;this.hIcon=RBuilder.appendIcon(f,"arrow");f=b.insertCell();(this.hLabel=RBuilder.append(f,"SPAN",this.style("Label"))).innerText=this.label}}function FListItem_onBuildPanel(){this.hPanel=RBuilder.create(null,"DIV")}
function FListItem_formatValue(b){return RString.nvl(b)}function FListItem_text(){return this.hEdit.value}function FListItem_setText(b){this.hEdit.value=b}function FListItem_dispose(){this.base.FControl.dispose.call(this);this.hEdit=this.hPanel=this.hLabel=this.hIcon=this.hForm=null}
function FUiButton(b){b=RClass.inherits(this,b,FControl,MDisplay,MDesign);b.labelPosition=RClass.register(b,new TPtyStr("labelPosition",EPosition.Left));b.icon=RClass.register(b,new TPtyStr("icon"));b.type=RClass.register(b,new TPtyStr("type"));b.action=RClass.register(b,new TPtyStr("action"));b.dataAction=RClass.register(b,new TPtyStr("dataAction"));b.service=RClass.register(b,new TPtyStr("service"));b.target=RClass.register(b,new TPtyStr("target"));b.page=RClass.register(b,new TPtyStr("page"));
b.method=RClass.register(b,new TPtyStr("method"));b.iconDisable=RClass.register(b,new TPtyStr("iconDisable"));b.attributes=RClass.register(b,new TPtyStr("attributes"));b.editUrl=RClass.register(b,new TPtyStr("editUrl"));b.editForm=RClass.register(b,new TPtyStr("editForm"));b.stIcon=RClass.register(b,new TStyle("Icon"));b.stLabel=RClass.register(b,new TStyle("Label"));b.stForm=RClass.register(b,new TStyle("Form"));b.stIconPanel=RClass.register(b,new TStyleIcon("Panel"));b.__process=!1;b.lsnsClick=
new TListeners;b.hForm=null;b.hLeftButton=null;b.hMiddleButton=null;b.hRightButton=null;b.hLabelPanel=null;b.hLabel=null;b.onButtonEnter=RClass.register(b,new HMouseEnter("onButtonEnter"),FUiButton_onButtonEnter);b.onButtonLeave=RClass.register(b,new HMouseLeave("onButtonLeave"),FUiButton_onButtonLeave);b.onButtonDown=RClass.register(b,new HMouseDown("onButtonDown"),FUiButton_onButtonDown);b.onButtonUp=RClass.register(b,new HMouseUp("onButtonUp"),FUiButton_onButtonUp);b.onButtonClickDelay=FUiButton_onButtonClickDelay;
b.onClick=FUiButton_onClick;b.onButtonClick=RClass.register(b,new HClick("onButtonClick"),FUiButton_onButtonClick);b.oeBuild=FUiButton_oeBuild;b.oeMode=FUiButton_oeMode;b.setLabel=FUiButton_setLabel;b.setLabelColor=FUiButton_setLabelColor;b.setLabelStyle=FUiButton_setLabelStyle;b.doClick=FUiButton_doClick;b.dispose=FUiButton_dispose;return b}
function FUiButton_onButtonEnter(b){this._disabled||(this.hLeftButton.background=this.styleIconPath("HoverLeft"),this.hMiddleButton.background=this.styleIconPath("HoverMiddle"),this.hRightButton.background=this.styleIconPath("HoverRight"))}function FUiButton_onButtonLeave(b){this._disabled||(this.hLeftButton.background=this.styleIconPath("ButtonLeft"),this.hMiddleButton.background=this.styleIconPath("Button"),this.hRightButton.background=this.styleIconPath("ButtonRight"))}
function FUiButton_onButtonDown(b){this._disabled||(this.hLeftButton.background=this.styleIconPath("PressLeft"),this.hMiddleButton.background=this.styleIconPath("PressMiddle"),this.hRightButton.background=this.styleIconPath("PressRight"))}function FUiButton_onButtonUp(b){this._disabled||(this.hLeftButton.background=this.styleIconPath("ButtonLeft"),this.hMiddleButton.background=this.styleIconPath("Button"),this.hRightButton.background=this.styleIconPath("ButtonRight"))}
function FUiButton_onButtonClickDelay(b){this.__process=!1;this.clickActive.status=EActive.Sleep}function FUiButton_onClick(b){this.doClick()}function FUiButton_onButtonClick(b){this.doClick()}
function FUiButton_oeBuild(b){this.base.FControl.oeBuild.call(this,b);b=this.hPanel;b.style.paddingTop=this.padTop?this.padTop:10;b.style.pixelHeight=26;b=this.hForm=RBuilder.appendTable(b);var f=b.insertRow();f.height=22;var h=this.hLeftButton=f.insertCell();h.width=3;h.background=this.styleIconPath("ButtonLeft");h=this.hMiddleButton=f.insertCell();h.background=this.styleIconPath("Button");f=this.hRightButton=f.insertCell();f.width=3;f.background=this.styleIconPath("ButtonRight");b.style.cursor=
"hand";b.style.border=0;this.attachEvent("onButtonEnter",b,this.onButtonEnter);this.attachEvent("onButtonLeave",b,this.onButtonLeave);this.attachEvent("onButtonDown",b,this.onButtonDown);this.attachEvent("onButtonUp",b,this.onButtonUp);this.attachEvent("onButtonClick",b);f=RBuilder.appendTable(h).insertRow();b=f.insertCell();b.width=10;this.icon&&(b=f.insertCell(),b.width=16,this.hIcon=RBuilder.appendIcon(b,this.icon),hcc=f.insertCell(),hcc.width=4);this.label&&(b=f.insertCell(),b.align="center",
b.noWrap=!0,this.hLabel=RBuilder.appendText(b,this.label),this.hLabel.style.font="icon");b=this.hFormEnd=f.insertCell();b.width=10;this.__process=!1;b=this.clickActive=new TActive(this,this.onButtonClickDelay);b.interval=500;b.status=EActive.Sleep;RConsole.find(FActiveConsole).push(b);return EEventStatus.Stop}function FUiButton_oeMode(b){this.base.FControl.oeMode.call(this,b);this.base.MDisplay.oeMode.call(this,b);return EEventStatus.Stop}
function FUiButton_setLabel(b){this.label=b;this.hLabel.innerText=b;this.hLabel.noWrap=!0}function FUiButton_setLabelColor(b){this.hLabel.style.color="#FF0000"}function FUiButton_setLabelStyle(b,f,h){this.hLabel.style.color="#FF0000";this.hLabel.style.fontWeight="bold";this.hLabel.style.fontSize="12"}
function FUiButton_doClick(){if(!this.__process){this.__process=!0;this.clickActive.status=EActive.Active;this.lsnsClick.process(this);this.action&&eval(this.action);if(this.page){var b=RHtml.form(this.hButton),f=RPage.parse(this.page);this.method&&(f.action=this.method);f.split(this.attributes);var h=this.topControl(MDataset);if(h){var q=new TAttributes;h.saveValue(q);b&&b.form_pack&&(b.form_pack.value=q.pack())}f.post(b,RString.nvl(this.target,"_self"))}this.editUrl&&(b=RConsole.find(FUiButtonConsole).find(),
b.linkUrl(this.editUrl),b.show());this.editForm&&(b=RConsole.find(FUiButtonFormConsole).find(),b.linkForm(this),b.show())}}function FUiButton_dispose(){this.base.FControl.dispose.call(this);this.hLabel=this.hFormEnd=this.hForm=null}
function FUiCalendar(b){b=RClass.inherits(this,b,FEditControl,MEditBorder,MDropable,MDescCalendar);b.editFormat=RDate.DisplayFormat;b.editHour=RClass.register(b,new TPtyBoolSet("editHour","editDate",EDateTimeMode.Hour));b.editMinute=RClass.register(b,new TPtyBoolSet("editMinute","editDate",EDateTimeMode.Minute));b.editSecond=RClass.register(b,new TPtyBoolSet("editSecond","editDate",EDateTimeMode.Second));b.borderStyle=EUiBorder.RoundDrop;b.date=null;b.lsnEditEnd=null;b.hForm=null;b.hDrop=null;b.hForm=
null;b.onKeyPress=FUiCalendar_onKeyPress;b.onDataClick=FUiCalendar_onDataClick;b.refreshStyle=FUiCalendar_refreshStyle;b.onEditEnd=FUiCalendar_onEditEnd;b.onBuildEdit=FUiCalendar_onBuildEdit;b.construct=FUiCalendar_construct;b.formatValue=FUiCalendar_formatValue;b.formatText=FUiCalendar_formatText;b.drop=FUiCalendar_drop;b.doBlur=FUiCalendar_doBlur;return b}function FUiCalendar_onDataClick(){this.editCheck||this.drop()}
function FUiCalendar_onBuildEdit(b){b=RBuilder.appendTable(b.hPanel);b.style.tableLayout="fixed";b=this.hEdit=b.insertRow();this.onBuildChange(b.insertCell());b=b.insertCell();b=this.hEdit=RBuilder.appendEdit(b,this.style("Edit"));b.style.disabled="true";this.editLength&&(b.maxLength=this.editLength)}function FUiCalendar_onEditEnd(b){b&&(this.set(b.get()),this._invalidText=this.validText(this.text()),this.refreshStyle());this.onDataEditEnd(this)}
function FUiCalendar_onKeyPress(b){RString.inChars(String.fromCharCode(b.keyCode),RDate.Chars)||RKey.eventClear(b)}function FUiCalendar_construct(){this.base.FEditControl.construct.call(this);this.date=new TDate;this.lsnEditEnd=new TListener(this,this.onEditEnd)}function FUiCalendar_formatValue(b){return b?("@now"==b.toLowerCase()?this.date.now():RDate.autoParse(this.date,b),RDate.formatDate(this.date)):RString.nvl(b)}
function FUiCalendar_formatText(b){return b?(RDate.autoParse(this.date,b),RDate.formatDate(this.date,this.editFormat)):RString.nvl(b)}function FUiCalendar_refreshStyle(){this.base.FEditControl.refreshStyle.call(this);this.editCheck||(this.hEdit.readOnly="true")}
function FUiCalendar_drop(){if(this.canDrop()&&this._editable){var b=this.editor=RConsole.find(FEditConsole).focus(this,FUiCalendarEditor,this.name);b.set(this.reget(),this.editFormat);b.setHourEditable(this.editHour);b.setMinuteEditable(this.editMinute);b.setSecondEditable(this.editSecond);b.lsnEditEnd=this.lsnEditEnd;b.show()}}function FUiCalendar_doBlur(){this.base.FEditControl.doBlur.call(this);this.editor&&this.editor.hide()}
function FUiCalendarEditor(b){b=RClass.inherits(this,b,FDropEditor,MUiFocusLooper);b.editFormat=null;b.dataValue=null;b.date=new TDate;b.hTitlePanel=null;b.hYearPrior=null;b.hYear=null;b.hYearNext=null;b.hMonthPrior=null;b.hMonth=null;b.hMonthNext=null;b.hDaysPanel=null;b.hTimePanel=null;b.hTime=null;b.hNow=null;b.hOk=null;b.hCancel=null;b.hHour=null;b.hMinute=null;b.hSecond=null;b.hSelect=null;b.editFormat=RDate.DisplayFormat;b.dateOrg=new TDate;b.dateOrgValue=null;b.dayCells=new TList;b.focusObject=
null;b.skipBlur=!1;b.styleYearMonth=RClass.register(b,new TStyle("YearMonth"));b.styleButton=RClass.register(b,new TStyle("Button"));b.styleButtonHover=RClass.register(b,new TStyle("ButtonHover"));b.styleDay=RClass.register(b,new TStyle("Day"));b.styleDaySel=RClass.register(b,new TStyle("DaySel"));b.styleDayHover=RClass.register(b,new TStyle("DayHover"));b.styleDayFree=RClass.register(b,new TStyle("DayFree"));b.styleDayNone=RClass.register(b,new TStyle("DayNone"));b.styleTitlePanel=RClass.register(b,
new TStyle("TitlePanel"));b.styleDaysPanel=RClass.register(b,new TStyle("DaysPanel"));b.styleTimePanel=RClass.register(b,new TStyle("TimePanel"));b.styleMonth=RClass.register(b,new TStyle("Year"));b.styleMonth=RClass.register(b,new TStyle("Month"));b.styleWeek=RClass.register(b,new TStyle("Week"));b.styleTime=RClass.register(b,new TStyle("Time"));b.styleHour=RClass.register(b,new TStyle("Hour"));b.styleSplit=RClass.register(b,new TStyle("Split"));b.styleMinute=RClass.register(b,new TStyle("Minute"));
b.styleSecond=RClass.register(b,new TStyle("Second"));b.styleNow=RClass.register(b,new TStyle("Now"));b.styleOk=RClass.register(b,new TStyle("Ok"));b.onDaySelect=RClass.register(b,new HMouseDown("onDaySelect"),FUiCalendarEditor_onDaySelect);b.onButtonNow=RClass.register(b,new HMouseDown("onButtonNow"),FUiCalendarEditor_onButtonNow);b.onDateKeyDown=RClass.register(b,new HKeyDown("onDateKeyDown"),FUiCalendarEditor_onDateKeyDown);b.onDateBlur=RClass.register(b,new HBlur("onDateBlur"),FUiCalendarEditor_onDateBlur);
b.onTimeBlur=RClass.register(b,new HBlur("onTimeBlur"),FUiCalendarEditor_onTimeBlur);b.onTimeClick=RClass.register(b,new HClick("onTimeClick"),FUiCalendarEditor_onTimeClick);b.onDayDbClick=RClass.register(b,new HDoubleClick("onDayDbClick"),FUiCalendarEditor_onDayDbClick);b.onDayEnter=RClass.register(b,new HMouseEnter("onDayEnter"),FUiCalendarEditor_onDayEnter);b.onDayOut=RClass.register(b,new HMouseOut("onDayOut"),FUiCalendarEditor_onDayOut);b.onButtonOk=RClass.register(b,new HMouseDown("onButtonOk"),
FUiCalendarEditor_onButtonOk);b.onButtonCancel=RClass.register(b,new HMouseDown("onButtonCancel"),FUiCalendarEditor_onButtonCancel);b.onButtonOver=RClass.register(b,new HMouseEnter("onButtonOver"),FUiCalendarEditor_onButtonOver);b.onButtonOut=RClass.register(b,new HMouseOut("onButtonOut"),FUiCalendarEditor_onButtonOut);b.onMdown=RClass.register(b,new HMouseDown("onMdown"),FUiCalendarEditor_onMdown);b.onMup=RClass.register(b,new HMouseUp("onMup"),FUiCalendarEditor_onMup);b.onBuildDrop=FUiCalendarEditor_onBuildDrop;
b.show=FUiCalendarEditor_show;b.setMinuteEditable=FUiCalendarEditor_setMinuteEditable;b.setHourEditable=FUiCalendarEditor_setHourEditable;b.setSecondEditable=FUiCalendarEditor_setSecondEditable;b.buildTitle=FUiCalendarEditor_buildTitle;b.buildDays=FUiCalendarEditor_buildDays;b.buildTime=FUiCalendarEditor_buildTime;b.testBlur=FUiCalendarEditor_testBlur;b.get=FUiCalendarEditor_get;b.set=FUiCalendarEditor_set;b.setDate=FUiCalendarEditor_setDate;b.storeChange=FUiCalendarEditor_storeChange;b.daySelectLsns=
new TListeners;b.onBuildButton=FUiCalendarEditor_onBuildButton;b.ohKdown=FUiCalendarEditor_ohKdown;b.ohDaysChange=FUiCalendarEditor_ohDaysChange;b.ohKeyCheck=FUiCalendarEditor_ohKeyCheck;b.onDateAction=FUiCalendarEditor_onDateAction;b.panel=FUiCalendarEditor_panel;b.dispose=FUiCalendarEditor_dispose;return b}function FUiCalendarEditor_onTimeClick(b){b=b.hSource;b.editAble&&b.select()}
function FUiCalendarEditor_onTimeBlur(b){b=b.hSource;b==this.hHour?b.value=Math.min(RInteger.parse(b.value),23):b==this.hMinute?b.value=Math.min(RInteger.parse(b.value),59):b==this.hSecond&&(b.value=Math.min(RInteger.parse(b.value),59));this.storeChange();this.setDate(this.date)}
function FUiCalendarEditor_onDayDbClick(b){var f=b.source;RClass.isClass(f,FUiCalendarEditor)&&0!=RInteger.parse(b.hSource.innerText)&&(f.date.setDay(b.hSource.innerText),f.dataValue=RDate.formatDate(f.date),f.editEnd())}function FUiCalendarEditor_onDaySelect(b){RClass.isClass(this,FUiCalendarEditor)&&0!=RInteger.parse(b.hSource.innerText)&&(b=b.hSource,this.hSelect&&(this.hSelect.style.border="1 solid #FFFFFF"),this.hSelect=b,b.style.border="1 solid #2BD6F0",this.date.setDay(b.innerText))}
function FUiCalendarEditor_onButtonNow(b){b=b.source;RClass.isClass(b,FUiCalendarEditor)&&(b.dataValue=RDate.format(),b.editEnd())}
function FUiCalendarEditor_onDateKeyDown(b,f){var h=b.hSource,q=h.value;EKey.Enter==b.keyCode?(this.storeChange(),this.setDate(this.date)):EKey.Up==b.keyCode?(h==this.hYear?this.hYear.value=RInteger.parse(this.hYear.value)+1:h==this.hMonth?this.hMonth.value=RInteger.parse(this.hMonth.value)+1:h==this.hHour?this.hHour.editAble&&23>q&&(h.value=RInteger.parse(h.value)+1):h==this.hMinute?this.hMinute.editAble&&59>q&&(h.value=RInteger.parse(h.value)+1):this.hSecond.editAble&&59>q&&(h.value=RInteger.parse(h.value)+
1),this.storeChange(),this.setDate(this.date)):EKey.Down==b.keyCode?(h==this.hYear?this.hYear.value=RInteger.parse(this.hYear.value)-1:h==this.hMonth?this.hMonth.value=RInteger.parse(this.hMonth.value)-1:h==this.hHour?this.hHour.editAble&&0<q&&(h.value=RInteger.parse(h.value)-1):h==this.hMinute?this.hMinute.editAble&&0<q&&(h.value=RInteger.parse(h.value)-1):this.hSecond.editAble&&0<q&&(h.value=RInteger.parse(h.value)-1),this.storeChange(),this.setDate(this.date),h.select()):h==this.hHour||h==this.hMinute||
h==this.hSecond?h.editAble?RKey.fixChars(f,RDate.Chars):(f.keyCode=0,f.returnValue=!1):RKey.fixChars(f,RDate.Chars)}function FUiCalendarEditor_onDateBlur(){this.storeChange();this.setDate(this.date)}
function FUiCalendarEditor_onBuildDrop(){this.hDatePanel=RBuilder.appendTable(this.hDropPanel);this.hDropPanel.align="center";this.hDatePanel.width="100%";var b=this.hDatePanel.insertRow(),b=this.hTitlePanel=b.insertCell();b.colSpan=2;b.className=this.style("TitlePanel");this.buildTitle();b=this.hDatePanel.insertRow();b=this.hDaysPanel=b.insertCell();b.colSpan=2;b.className=this.style("DaysPanel");this.buildDays();b=this.hDatePanel.insertRow();this.hTimePanel=b.insertCell();this.buildTime();this.pushFocus(this.hYear);
this.pushFocus(this.hMonth)}function FUiCalendarEditor_show(b){this.base.FDropEditor.show.call(this,b);b=this.hPanel;var f=this.source.getEditRange();b.style.pixelLeft=f.x;b.style.pixelTop=f.y+f.height;b.style.pixelWidth=273;this.base.MShadow.show.call(this)}
function FUiCalendarEditor_buildTitle(){var b=RBuilder.appendTable(this.hTitlePanel,null,0,5,1);b.align="center";b.width="100%";b.style.filter="progid:DXImageTransform.Microsoft.Gradient(startColorStr='#E5FAFE', endColorStr='#FFFFFF', gradientType='0')";var b=b.insertRow(),f=b.insertCell(),f=this.hYearPrior=RBuilder.append(f,"SPAN",this.style("Button"));f.link=this;f.linkAction=this.onDateAction;f.innerText="3";this.attachEvent("onButtonOver",f);this.attachEvent("onButtonOut",f);this.attachEvent("onMdown",
f);this.attachEvent("onMup",f);f=b.insertCell();f=this.hYear=RBuilder.append(f,"INPUT",this.style("Year"));f.maxLength="4";this.attachEvent("onDateBlur",f,this.onDateBlur);this.attachEvent("onDateKeyDown",f,this.onDateKeyDown);f=b.insertCell();f.innerText=RContext.get("FUiCalendarEditor:year");f.className=this.style("YearMonth");f=b.insertCell();f=this.hYearNext=RBuilder.append(f,"SPAN",this.style("Button"));f.link=this;f.linkAction=this.onDateAction;f.innerText="4";this.attachEvent("onButtonOver",
f);this.attachEvent("onButtonOut",f);this.attachEvent("onMdown",f);this.attachEvent("onMup",f);b.insertCell().width="10";f=b.insertCell();f=this.hMonthPrior=RBuilder.append(f,"SPAN",this.style("Button"));f.link=this;f.linkAction=this.onDateAction;f.innerText="3";this.attachEvent("onButtonOver",f);this.attachEvent("onButtonOut",f);this.attachEvent("onMdown",f);this.attachEvent("onMup",f);f=b.insertCell();f=this.hMonth=RBuilder.append(f,"INPUT",this.style("Month"));f.maxLength="2";this.attachEvent("onDateBlur",
f,this.onDateBlur);this.attachEvent("onDateKeyDown",f,this.onDateKeyDown);f=b.insertCell();f.innerText=RContext.get("FUiCalendarEditor:month");f.className=this.style("YearMonth");f=b.insertCell();f=this.hMonthNext=RBuilder.append(f,"SPAN",this.style("Button"));f.link=this;f.linkAction=this.onDateAction;f.innerText="4";this.attachEvent("onButtonOver",f);this.attachEvent("onButtonOut",f);this.attachEvent("onMdown",f);this.attachEvent("onMup",f)}
function FUiCalendarEditor_buildDays(){var b=RBuilder.appendTable(this.hDaysPanel,null,0,0,1);b.width="100%";for(var f=RContext.get("FUiCalendarEditor:weekdays").split(","),h=f.length,q=b.insertRow(),u=0;u<h;u++){var z=q.insertCell();z.className=this.style("Week");z.align="center";z.innerText=f[u]}for(u=0;6>u;u++)for(f=b.insertRow(),q=0;q<h;q++)z=f.insertCell(),z.link=this,z.className=this.style("DayNone"),this.attachEvent("onDayEnter",z),this.attachEvent("onDayOut",z),this.attachEvent("onDaySelect",
z),this.attachEvent("onDayDbClick",z),z.innerText=".",this.dayCells.push(z)}
function FUiCalendarEditor_buildTime(){var b=RBuilder.appendTable(this.hTimePanel,null,0,1,1);this.hTimePanel.style.filter="progid:DXImageTransform.Microsoft.Gradient(startColorStr='#FFFFFF', endColorStr='#E5FAFE', gradientType='0')";b=b.insertRow();b.insertCell().width=5;var f=b.insertCell();f.width=50;f.style.color="#1F8FB7";f.style.fontWeight="BOLD";f.innerText="\u65f6\u95f4:";var f=b.insertCell(),h=RBuilder.appendTable(f,null,0,0,0);f.style.border="1 solid #2BD6F0";f.style.backgroundColor="#FFFFFF";
f=h.insertRow();h=f.insertCell();h=this.hHour=RBuilder.appendEdit(h,this.style("Hour"));h.maxLength=2;this.attachEvent("onTimeClick",h);this.attachEvent("onDateKeyDown",h,this.onDateKeyDown);this.attachEvent("onTimeBlur",h,this.onTimeBlur);f.insertCell().innerText=":";h=f.insertCell();h=this.hMinute=RBuilder.appendEdit(h,this.style("Minute"));h.maxLength=2;this.attachEvent("onTimeClick",h);this.attachEvent("onDateKeyDown",h,this.onDateKeyDown);this.attachEvent("onTimeBlur",h,this.onTimeBlur);f.insertCell().innerText=
":";f=f.insertCell();f=this.hSecond=RBuilder.appendEdit(f,this.style("Second"));f.maxLength=2;this.attachEvent("onTimeClick",f);this.attachEvent("onDateKeyDown",f,this.onDateKeyDown);this.attachEvent("onTimeBlur",f,this.onTimeBlur);b.insertCell().width=50;f=b.insertCell();f.style.display="none";h=this.hNow=RBuilder.append(f,"SPAN",this.style("Now"));h.style.width=50;f.style.border="1 solid #2BD6F0";h.innerText=RContext.get("FUiCalendarEditor:now");h.style.display="none";h.link=this;this.attachEvent("onButtonNow",
h);f=b.insertCell();h=this.hCancel=RBuilder.append(f,"SPAN",this.style("Ok"));h.style.width=50;f.style.border="1 solid #2BD6F0";h.link=this;this.attachEvent("onButtonCancel",h);h.innerText=RContext.get("FUiCalendarEditor:cancel");b=b.insertCell();f=this.hOk=RBuilder.append(b,"SPAN",this.style("Ok"));f.style.width=50;b.style.border="1 solid #2BD6F0";f.link=this;this.attachEvent("onButtonOk",f);f.innerText=RContext.get("FUiCalendarEditor:ok")}
function FUiCalendarEditor_testBlur(b){return this.source!=b}function FUiCalendarEditor_get(){return this.dataValue}function FUiCalendarEditor_set(b,f){this.changed=!1;this.skipBlur=0;this.dateOrgValue=this.dataValue=b;this.editFormat=f;RDate.parse(this.date,b);RDate.parse(this.dateOrg,b);b||(this.date.now(),RDate.parse(this.date,b),RDate.parse(this.dateOrg,b));this.setDate(this.date)}
function FUiCalendarEditor_setDate(b){this.hYear.value=b.year;this.hMonth.value=b.month;this.hHour.value=RString.lpad(b.hour,2,"0");this.hMinute.value=RString.lpad(b.minute,2,"0");this.hSecond.value=RString.lpad(b.second,2,"0");var f=b.day;if(this.dateOrg.year!=b.year||this.dateOrg.month!=b.month)f=-1;this.hSelect&&(this.hSelect.style.border="1 solid #FFFFFF");b=this.date.monthWeekDay();for(var h=this.date.monthDays(),q=b,u=0;u<this.dayCells.count;u++){var z=this.dayCells.get(u);if(u<b)z.className=
this.style("DayNone"),z.innerText=".";else if(u<h+b){7==q&&(q=0);var A=u-b+1;A==f?(z.className=this.style("DaySel"),z.isCurrent=!0,this.hSelect=z,z.style.border="1 solid #2BD6F0"):(z.isFree=0==q||6==q,z.className=z.isFree?this.style("DayFree"):this.style("Day"),z.isCurrent=!1);z.innerText=A;q++}else z.className=this.style("DayNone"),z.innerText="."}}
function FUiCalendarEditor_setHourEditable(b){b?this.hHour.editAble=!0:(this.hHour.value="00",this.hHour.style.cursor="default",this.hHour.style.color="gray",this.hHour.editAble=!1)}function FUiCalendarEditor_setMinuteEditable(b){b?this.hMinute.editAble=!0:(this.hMinute.value="00",this.hMinute.style.cursor="default",this.hMinute.style.color="gray",this.hMinute.editAble=!1)}
function FUiCalendarEditor_setSecondEditable(b){b?this.hSecond.editAble=!0:(this.hSecond.value="00",this.hSecond.style.cursor="default",this.hSecond.style.color="gray",this.hSecond.editAble=!1)}
function FUiCalendarEditor_storeChange(){this.date.setYear(this.hYear.value);this.date.setMonth(this.hMonth.value);this.date.setHour(Math.min(RInteger.parse(this.hHour.value),23));this.date.setMinute(Math.min(RInteger.parse(this.hMinute.value),59));this.date.setSecond(Math.min(RInteger.parse(this.hSecond.value),59))}function FUiCalendarEditor_onBuildButton(){}
function FUiCalendarEditor_onMdown(b){var f=b.source;RClass.isClass(f,FUiCalendarEditor)&&(f.isSkipBlur=!0,b.hSource.linkAction&&b.hSource.linkAction.call(f,b.hSource))}function FUiCalendarEditor_onMup(b){b=b.source;RClass.isClass(b,FUiCalendarEditor)&&(b=b.focusObject)&&b.focus&&b.select&&(b.focus(),b.select())}
function FUiCalendarEditor_ohKdown(){var b=this.link;if(RClass.isClass(b,FUiCalendarEditor)){var f=RWindow.event(this);EKey.Esc==f.keyCode?(b.dataValue=b.dateOrgValue,b.editStatus=EEditStatus.Cancel,b.endEdit()):event.ctrlKey&&EKey.Enter==f.keyCode?(b.storeChange(),b.editStatus=EEditStatus.Ok,b.endEdit()):EKey.Enter==f.keyCode?(b.storeChange(),b.setDate(b.date)):EKey.Tab==f.keyCode&&(b.isSkipBlur=!0,f.shiftKey?b.focusPrior():b.focusNext(),f.returnValue=0)}}
function FUiCalendarEditor_onButtonOver(b){var f=b.source;RClass.isClass(f,FUiCalendarEditor)&&(b.hSource.className=f.style("ButtonHover"))}function FUiCalendarEditor_onButtonOut(b){var f=b.source;RClass.isClass(f,FUiCalendarEditor)&&(b.hSource.className=f.style("Button"))}function FUiCalendarEditor_onButtonOk(b){b=b.source;RClass.isClass(b,FUiCalendarEditor)&&(b.editStatus=EEditStatus.Ok,b.dataValue=RDate.formatDate(b.date),b.editEnd())}
function FUiCalendarEditor_onButtonCancel(b){b=b.source;RClass.isClass(b,FUiCalendarEditor)&&(b.editStatus=EEditStatus.Cancel,b.dataValue="",b.editEnd())}function FUiCalendarEditor_ohDaysChange(){var b=this.link;RClass.isClass(b,FUiCalendarEditor)&&(b.date.setYear(b.hYear.value),b.date.setMonth(b.hMonth.value),b.setDate(b.date))}function FUiCalendarEditor_ohKeyCheck(){var b=RWindow.event(this);RString.inChars(String.fromCharCode(b.keyCode),RDate.Chars)||(b.keyCode=0)}
function FUiCalendarEditor_onDayEnter(b){var f=b.source;RClass.isClass(f,FUiCalendarEditor)&&"."!=b.hSource.innerText&&!b.hSource.isCurrent&&(b.hSource.className=f.style("DayHover"))}function FUiCalendarEditor_onDayOut(b){var f=b.source;RClass.isClass(f,FUiCalendarEditor)&&"."!=b.hSource.innerText&&!b.hSource.isCurrent&&(b.hSource.className=b.hSource.isFree?f.style("DayFree"):f.style("Day"))}
function FUiCalendarEditor_onDateAction(b){this.hYearPrior==b?(this.date.addYear(-1),this.setDate(this.date),this.focusObject!=this.hYear&&(this.focusObject=this.hYear,this.hYear.focus(),this.hYear.select())):this.hYearNext==b?(this.date.addYear(1),this.setDate(this.date),this.focusObject!=this.hYear&&(this.focusObject=this.hYear,this.hYear.focus(),this.hYear.select())):this.hMonthPrior==b?(this.date.addMonth(-1),this.setDate(this.date),this.focusObject!=this.hMonth&&(this.focusObject=this.hMonth,
this.hMonth.focus())):this.hMonthNext==b&&(this.date.addMonth(1),this.setDate(this.date),this.focusObject!=this.hMonth&&(this.focusObject=this.hMonth,this.hMonth.focus()))}function FUiCalendarEditor_panel(b){return EPanel.Shadow==b?this.hPanel:this.base.FDropEditor.panel.call(this,b)}
function FUiCalendarEditor_dispose(){this.base.FDropEditor.dispose.call(this);this.hTimePanel=this.hTime=this.hMonth=this.hYear=this.hMonthNext=this.hButtonPanel=this.hNow=this.hOk=this.hTitlePanel=this.hDropPanel=this.hDatePanel=null}
function FUiCheck(b){b=RClass.inherits(this,b,FUiEditControl,MPropertyCheck,MListenerDataChanged);b._styleInput=RClass.register(b,new AStyle("_styleInput"));b._hInput=null;b.onBuildEditValue=FUiCheck_onBuildEditValue;b.onInputClick=RClass.register(b,new AEventClick("onInputClick"),FUiCheck_onInputClick);b.oeSaveValue=FUiCheck_oeSaveValue;b.get=FUiCheck_get;b.set=FUiCheck_set;b.refreshValue=FUiCheck_refreshValue;b.refreshStyle=FUiCheck_refreshStyle;return b}
function FUiCheck_onBuildEditValue(b){b=this._hInput=RBuilder.appendCheck(this._hValuePanel,this.styleName("Input"));this.attachEvent("onInputClick",b)}function FUiCheck_onInputClick(b){this.refreshValue()}function FUiCheck_oeSaveValue(b){return EStore.Prepare==b.store?(RBoolean.isTrue(this.reget())&&b.values.set(this.dataName,EBoolean.True),EEventStatus.Stop):this.base.FUiEditControl.oeSaveValue.call(this,b)}function FUiCheck_get(){return this._hInput.checked}
function FUiCheck_set(b){this._hInput.checked=RBoolean.parse(b)}function FUiCheck_refreshValue(){this.processDataChangedListener(this)}function FUiCheck_refreshStyle(){this.panel(EPanel.Edit).disabled=!this._editable;this._editable||(this.hEdit.style.cursor="normal")}
function FCheckPicker(b){b=RClass.inherits(this,b,FEditControl,MEditBorder,MDescCheckPicker,MDropable);b.stIconDropSelect=RClass.register(b,new TStyleIcon("DropSelect"));b.items=new TItems;b.borderStyle=EUiBorder.RoundDrop;b.onBuildEdit=FCheckPicker_onBuildEdit;b.onEditEnd=FCheckPicker_onEditEnd;b.onDataKeyDown=FCheckPicker_onDataKeyDown;b.loadConfig=FCheckPicker_loadConfig;b.formatValue=FCheckPicker_formatValue;b.validText=FCheckPicker_validText;b.formatText=FCheckPicker_formatText;b.refreshStyle=
FCheckPicker_refreshStyle;b.drop=FCheckPicker_drop;b.dispose=FCheckPicker_dispose;return b}function FCheckPicker_onBuildEdit(b){b=this.hEdit=RBuilder.appendEdit(b.hPanel,this.style("Edit"));this.editLength&&(b.maxLength=this.editLength)}function FCheckPicker_onEditEnd(b){RLog.debug(this,"Begin (editor={1}:{2} value={3})",b,b?b.value():"",this.dataValue);b&&this.set(b.values);this.onDataEditEnd(this);RLog.debug(this,"End (editor={1} value={2})",b,this.dataValue)}
function FCheckPicker_loadConfig(b){this.base.FEditControl.loadConfig.call(this,b);this.dataEmpty&&this.items.create();this.items.loadConfig(b);return EStatus.Stop}function FCheckPicker_text(){return this.hEdit.value}function FCheckPicker_setText(b){this.hEdit.value=b}
function FCheckPicker_formatValue(b){if(RString.isEmpty(b))return"";ta=RString.split(b,",");b=[];for(var f=this.items.items,h=0;h<ta.length;h++)for(var q=0;q<f.count;q++){var u=f.value(q);u.label==ta[h]&&b.push(u.value)}return RString.toUpper(b.join())}function FCheckPicker_validText(b){return RString.isEmpty(b)?!0:!RString.isEmpty(this.formatValue(b))}
function FCheckPicker_formatText(b){if(RString.isEmpty(b))return"";va=RString.split(b,",");b=[];for(var f=this.items.items,h=0;h<va.length;h++){var q=f.values[f.indexOf(va[h])];q&&b.push(q.label)}return RString.toUpper(b.join())}function FCheckPicker_refreshStyle(){this.base.FEditControl.refreshStyle.call(this);this.hDrop.src=this.styleIconPath(this._hover?"DropSelect":"Drop")}
function FCheckPicker_drop(){if(this.canDrop()&&this.canEdit&&0<this.items.count()){var b=this.editor=RConsole.find(FEditConsole).focus(this,FCheckPickerEditor,this.editRefer);b.linkControl(this)&&(b.setItems(this.items),b.set(this.reget()));b.show()}}function FCheckPicker_onDataKeyDown(b,f){this.base.FEditControl.onDataKeyDown.call(this,b,f);if(this.items.count()&&this.editor&&this.editor.source==this)this.editor.onEditKeyDown(b,f)}
function FCheckPicker_dispose(){this.base.FEditControl.dispose.call(this);RMemory.freeHtml(this.hEdit);this.hEdit=null}
function FCheckPickerEditor(b){b=RClass.inherits(this,b,FDropEditor,MShadow);b.MinWidth=120;b.onEditFocus=RClass.register(b,new HFocus("onEditFocus"));b.onEditBlur=RClass.register(b,new HBlur("onEditBlur"));b.stIconDropSelect=RClass.register(b,new TStyleIcon("DropSelect"));b.stFlag=RClass.register(b,new TStyle("Flag"));b.stEditForm=RClass.register(b,new TStyle("EditForm"));b.pattern=null;b.originItem=null;b.selectItem=null;b.items=null;b.itemClickListener=null;b.values=[];b.hBtnTextSpan=null;b.onBuildDrop=
FCheckPickerEditor_onBuildDrop;b.onBuildButton=FCheckPickerEditor_onBuildButton;b.onItemClick=FCheckPickerEditor_onItemClick;b.onEditKeyDown=FCheckPickerEditor_onEditKeyDown;b.construct=FCheckPickerEditor_construct;b.set=FCheckPickerEditor_set;b.setItems=FCheckPickerEditor_setItems;b.select=FCheckPickerEditor_select;b.linkControl=FCheckPickerEditor_linkControl;b.show=FCheckPickerEditor_show;b.hide=FCheckPickerEditor_hide;b.dispose=FCheckPickerEditor_dispose;return b}
function FCheckPickerEditor_construct(){this.itemClickListener=new TListener(this,this.onItemClick)}function FCheckPickerEditor_onBuildDrop(){this.hItemsForm=RBuilder.appendTable(this.hDropPanel);this.hItemsForm.width="100%";this.hItemsPanel=RBuilder.append(this.hItemsForm,"TBODY");this.onBuildButton()}function FCheckPickerEditor_onBuildButton(){this.base.FDropEditor.onBuildButton.call(this);(this.hBtnTextSpan=RBuilder.newSpan(this.hButtonPanel,null)).innerText="colse"}
function FCheckPickerEditor_onItemClick(b){b.setChecked(!b.checked);b=this.items.items;for(var f=this.components,h=[],q=0;q<b.count;q++){var u=f.value(q);u.checked&&h.push(u.value)}this.source.set(h.join())}function FCheckPickerEditor_select(b){var f=this.components;b=Math.min(Math.max(0,b),f.count-1);for(var h=0;h<f.count;h++)this.components.value(h).setChecked(h==b);this.position=b}function FCheckPickerEditor_onEditKeyDown(b,f){}
function FCheckPickerEditor_set(b){for(var f=this.components,h=f.count,q=0;q<h;q++)f.value(q).setChecked(!1);if(!RString.isEmpty(b))for(this.values=b,va=RString.split(b,","),q=0;q<va.length;q++)(b=f.get(va[q]))&&b.setChecked(!0)}
function FCheckPickerEditor_setItems(b){if(!this.components){var f=this.hItemsPanel;this.items=b;for(var h=b.count(),q=0;q<h;q++){if(0<q){var u=RBuilder.append(f,"TR");u.height=1;u=RBuilder.append(u,"TD");u.colSpan=3;u.style.borderTop="1 dashed #24c2db";RBuilder.appendEmpty(u)}var u=b.get(q),z=RControl.create(FSelectItem);z.name=u.value;z.lsnsClick.push(this.itemClickListener);z.set(u.icon,u.label,u.value);z.setPanel(f);this.push(z)}this.position=0}}
function FCheckPickerEditor_linkControl(b){if(this.source==b)return!1;this.source=b;RLog.debug(this,"link Panel (panel={0}, edit={1})",RClass.dump(b.hEditCell),RClass.dump(b.hEdit));RHtml.toRect(this.rect,b.hEditCell);RHtml.setPixelRect(this.hPanel,this.rect);this.hPanel.style.pixelTop=this.rect.bottom;var f=this.border.hForm;f.style.pixelWidth=b.editBorder.hForm.width;f.style.pixelHeight=b.editBorder.hForm.height;return!0}
function FCheckPickerEditor_show(b){this.base.FDropEditor.show.call(this,b);RConsole.find(FFocusConsole).focus(this);this.border.hForm.offsetWidth<this.MinWidth&&(this.border.hForm.style.pixelWidth=this.MinWidth);this.base.MShadow.show.call(this,b);this.isSkipBlur=!1}function FCheckPickerEditor_hide(){this.source=null;this.base.FDropEditor.hide.call(this);this.base.MShadow.hide.call(this)}
function FCheckPickerEditor_dispose(){this.base.FDropEditor.dispose.call(this);RMemory.freeHtml(this.hPanel);RMemory.freeHtml(this.hItemsForm);RMemory.freeHtml(this.hItemsPanel);RMemory.freeHtml(this.hBtnTextSpan);RMemory.freeHtml(this.hDropPanel);RMemory.freeHtml(this.hButtonPanel);this.hButtonPanel=this.hDropPanel=this.hBtnTextSpan=this.hItemsPanel=this.hItemsForm=this.hPanel=null}
function FUiColor(b){b=RClass.inherits(this,b,FEditControl);b._inputSize=RClass.register(b,new APtySize2("_inputSize"));b._styleInputPanel=RClass.register(b,new AStyle("_styleInputPanel"));b._styleInput=RClass.register(b,new AStyle("_styleInput"));b._hInput=null;b.onBuildEditValue=FUiColor_onBuildEditValue;b.construct=FUiColor_construct;b.get=FUiColor_get;b.set=FUiColor_set;return b}function FUiColor_oeDataLoad(b){alert(b);return EEventStatus.Stop}
function FUiColor_oeDataSave(b){return EEventStatus.Stop}function FUiColor_onBuildEditValue(b){b=this._hValuePanel;b.className=this.styleName("InputPanel");b=this._hInput=RBuilder.appendEdit(b,this.styleName("Input"));this._editLength&&(b.maxLength=this._editLength)}function FUiColor_construct(){this.__base.FEditControl.construct.call(this);this._inputSize=new SSize2(120,0)}function FUiColor_get(b){b=this.__base.FEditControl.get.call(this,b);var f=this._hInput;f&&(b=f.value);return b}
function FUiColor_set(b){this.__base.FEditControl.set.call(this,b);var f=this._hInput;f&&(f.value=RString.nvl(b))}function FUiColor_onDataKeyDown(b,f){this.__base.FEditControl.onDataKeyDown.call(this,b,f);this.editCase&&RKey.fixCase(f,this.editCase)}function FUiColor_formatValue(b){b=RString.nvl(b);ECase.Upper==this.editCase?b=RString.toUpper(b):ECase.Lower==this.editCase&&(b=RString.toLower(b));return b}
function FUiColor_setText(b){this.hEdit&&(this.hEdit.value="U"==this.editCase?RString.toUpper(b):"L"==this.editCase?RString.toLower(b):b,this.hEdit.style.textAlign="right"==this.editAlign?"right":"left"==this.editAlign?"left":"center")}
function FUiColor_validText(b){var f=this.__base.FEditControl.validText.call(this,b);if(!f){if(this.validLenmin&&this.validLenmin>b.length)return RContext.get("MDescEdit:ValidMinLength",this.validLenmin);if(this.validLenmax&&this.validLenmax<b.length)return RContext.get("MDescEdit:ValidMaxLength",this.validLenmax)}return f}
function FUiColor_findEditor(){if(this.editComplete){var b=this.editor;!b&&(this.dsControl=this.topControl(MDataset))&&(b=this.editor=RConsole.find(FUiColorConsole).focus(this,FUiColorEditor));b&&b.linkControl(this);return this.editor}}function FUiColor_drop(){var b=this.findEditor();if(b){var f=this.reget();0<f.length&&(this.finded!=f&&(b.source!=this&&b.linkControl(this),b.search(f)),this.finded=f)}}function FUiColor_clone(){var b=this._class.newInstance();GHtml_clone(b,this.hPanel);return b}
function FUiColor_link(){}
function FUiColor3Tpl(b){b=RClass.inherits(this,b,FEditControl,MListenerDataChanged);b._inputSize=RClass.register(b,new APtySize2("_inputSize"));b._styleValuePanel=RClass.register(b,new AStyle("_styleValuePanel"));b._styleInput=RClass.register(b,new AStyle("_styleInput"));b._innerOriginValue=null;b._innerDataValue=null;b._hInputRed=null;b._hInputGreen=null;b._hInputBlue=null;b.onBuildEditValue=FUiColor3Tpl_onBuildEditValue;b.onInputKeyPress=RClass.register(b,new AEventKeyPress("onInputKeyPress"),FUiColor3Tpl_onInputKeyPress);
b.onInputChanged=RClass.register(b,new AEventInputChanged("onInputChanged"),FUiColor3Tpl_onInputChanged);b.construct=FUiColor3Tpl_construct;b.get=FUiColor3Tpl_get;b.set=FUiColor3Tpl_set;return b}
function FUiColor3Tpl_onBuildEditValue(b){var f=this._hValuePanel;f.className=this.styleName("ValuePanel");f=this._hValueForm=RBuilder.appendTable(f);f.width="100%";f=this._hValueLine=RBuilder.appendTableRow(f);this._hChangePanel=RBuilder.appendTableCell(f);this.onBuildEditChange(b);var h=RBuilder.appendTableCell(f);h.style.borderRight="1px solid #666666";h=this._hInputRed=RBuilder.appendEdit(h,this.styleName("Input"));this.attachEvent("onInputKeyPress",h,this.onInputKeyPress);this.attachEvent("onInputChanged",
h,this.onInputChanged);h=RBuilder.appendTableCell(f);h.style.borderLeft="1px solid #999999";h.style.borderRight="1px solid #666666";h=this._hInputGreen=RBuilder.appendEdit(h,this.styleName("Input"));this.attachEvent("onInputKeyPress",h,this.onInputKeyPress);this.attachEvent("onInputChanged",h,this.onInputChanged);h=RBuilder.appendTableCell(f);h.style.borderLeft="1px solid #999999";h=this._hInputBlue=RBuilder.appendEdit(h,this.styleName("Input"));this.attachEvent("onInputKeyPress",h,this.onInputKeyPress);
this.attachEvent("onInputChanged",h,this.onInputChanged);(this._hDropPanel=RBuilder.appendTableCell(f)).style.borderLeft="1px solid #666666";this.onBuildEditDrop(b)}function FUiColor3Tpl_onInputKeyPress(b){EKeyCode.floatCodes[b.keyCode]||b.cancel()}function FUiColor3Tpl_onInputChanged(b){this.processDataChangedListener(this)}
function FUiColor3Tpl_construct(){this.__base.FEditControl.construct.call(this);this._inputSize=new SSize2(120,0);this._innerOriginValue=new SColor4;this._innerDataValue=new SColor4}function FUiColor3Tpl_get(b){b=this._innerDataValue;var f=this._hInputRed;f&&(b.red=RFloat.parse(f.value));if(f=this._hInputGreen)b.green=RFloat.parse(f.value);if(f=this._hInputBlue)b.blue=RFloat.parse(f.value);return b}
function FUiColor3Tpl_set(b){this.__base.FEditControl.set.call(this,b);if(b.constructor==SColor4)this._innerOriginValue.assign(b),this._innerDataValue.assign(b);else throw new TError("Invalid value format.");b=this._innerDataValue;var f=this._hInputRed;f&&(f.value=RFloat.format(b.red,0,null,2,null));if(f=this._hInputGreen)f.value=RFloat.format(b.green,0,null,2,null);if(f=this._hInputBlue)f.value=RFloat.format(b.blue,0,null,2,null);this.changeSet(!1)}
function FUiColor3Tpl_onDataKeyDown(b,f){this.__base.FEditControl.onDataKeyDown.call(this,b,f);this.editCase&&RKey.fixCase(f,this.editCase)}function FUiColor3Tpl_formatValue(b){b=RString.nvl(b);ECase.Upper==this.editCase?b=RString.toUpper(b):ECase.Lower==this.editCase&&(b=RString.toLower(b));return b}
function FUiColor3Tpl_setText(b){this.hEdit&&(this.hEdit.value="U"==this.editCase?RString.toUpper(b):"L"==this.editCase?RString.toLower(b):b,this.hEdit.style.textAlign="right"==this.editAlign?"right":"left"==this.editAlign?"left":"center")}
function FUiColor3Tpl_validText(b){var f=this.__base.FEditControl.validText.call(this,b);if(!f){if(this.validLenmin&&this.validLenmin>b.length)return RContext.get("MDescEdit:ValidMinLength",this.validLenmin);if(this.validLenmax&&this.validLenmax<b.length)return RContext.get("MDescEdit:ValidMaxLength",this.validLenmax)}return f}
function FUiColor3Tpl_findEditor(){if(this.editComplete){var b=this.editor;!b&&(this.dsControl=this.topControl(MDataset))&&(b=this.editor=RConsole.find(FUiColor3TplConsole).focus(this,FUiColor3TplEditor));b&&b.linkControl(this);return this.editor}}function FUiColor3Tpl_drop(){var b=this.findEditor();if(b){var f=this.reget();0<f.length&&(this.finded!=f&&(b.source!=this&&b.linkControl(this),b.search(f)),this.finded=f)}}
function FUiColor3Tpl_clone(){var b=this._class.newInstance();GHtml_clone(b,this.hPanel);return b}function FUiColor3Tpl_link(){}
function FUiColor4(b){b=RClass.inherits(this,b,FEditControl);b._inputSize=RClass.register(b,new APtySize2("_inputSize"));b._styleInputPanel=RClass.register(b,new AStyle("_styleInputPanel"));b._styleInput=RClass.register(b,new AStyle("_styleInput"));b._hInput=null;b.onBuildEditValue=FUiColor4_onBuildEditValue;b.construct=FUiColor4_construct;b.get=FUiColor4_get;b.set=FUiColor4_set;return b}function FUiColor4_oeDataLoad(b){alert(b);return EEventStatus.Stop}
function FUiColor4_oeDataSave(b){return EEventStatus.Stop}function FUiColor4_onBuildEditValue(b){b=this._hValuePanel;b.className=this.styleName("InputPanel");b=this._hInput=RBuilder.appendEdit(b,this.styleName("Input"));this._editLength&&(b.maxLength=this._editLength)}function FUiColor4_construct(){this.__base.FEditControl.construct.call(this);this._inputSize=new SSize2(120,0)}function FUiColor4_get(b){b=this.__base.FEditControl.get.call(this,b);var f=this._hInput;f&&(b=f.value);return b}
function FUiColor4_set(b){this.__base.FEditControl.set.call(this,b);var f=null;if(b.constructor==SColor4){var f=RFloat.format(b.red,0,null,3,null),h=RFloat.format(b.green,0,null,3,null);b=RFloat.format(b.blue,0,null,3,null);f=f+","+h+","+b}if(b=this._hInput)b.value=f}function FUiColor4_onDataKeyDown(b,f){this.__base.FEditControl.onDataKeyDown.call(this,b,f);this.editCase&&RKey.fixCase(f,this.editCase)}
function FUiColor4_formatValue(b){b=RString.nvl(b);ECase.Upper==this.editCase?b=RString.toUpper(b):ECase.Lower==this.editCase&&(b=RString.toLower(b));return b}function FUiColor4_setText(b){this.hEdit&&(this.hEdit.value="U"==this.editCase?RString.toUpper(b):"L"==this.editCase?RString.toLower(b):b,this.hEdit.style.textAlign="right"==this.editAlign?"right":"left"==this.editAlign?"left":"center")}
function FUiColor4_validText(b){var f=this.__base.FEditControl.validText.call(this,b);if(!f){if(this.validLenmin&&this.validLenmin>b.length)return RContext.get("MDescEdit:ValidMinLength",this.validLenmin);if(this.validLenmax&&this.validLenmax<b.length)return RContext.get("MDescEdit:ValidMaxLength",this.validLenmax)}return f}
function FUiColor4_findEditor(){if(this.editComplete){var b=this.editor;!b&&(this.dsControl=this.topControl(MDataset))&&(b=this.editor=RConsole.find(FUiColor4Console).focus(this,FUiColor4Editor));b&&b.linkControl(this);return this.editor}}function FUiColor4_drop(){var b=this.findEditor();if(b){var f=this.reget();0<f.length&&(this.finded!=f&&(b.source!=this&&b.linkControl(this),b.search(f)),this.finded=f)}}
function FUiColor4_clone(){var b=this._class.newInstance();GHtml_clone(b,this.hPanel);return b}function FUiColor4_link(){}
function FColorPicker(b){b=RClass.inherits(this,b,FEditControl,MEditBorder,MDescColor,MDropable);b.borderStyle=EUiBorder.RoundDrop;b.onBuildEdit=FColorPicker_onBuildEdit;b.onEditEnd=FColorPicker_onEditEnd;b.onDataKeyDown=FColorPicker_onDataKeyDown;b.checkColor=FColorPicker_checkColor;b.setText=FColorPicker_setText;b.drop=FColorPicker_drop;b.dispose=FColorPicker_dispose;return b}function FColorPicker_onBuildEdit(b){(this.hEdit=RBuilder.appendEdit(b.hPanel,this.style("Edit"))).maxLength=20}
function FColorPicker_onEditEnd(b){RLog.debug(this,"Begin (editor={0}:{1} value={2})",b,b?b.color:"",this.dataValue);b&&(this.set(b.color),this.hDrop.style.backgroundColor=b.color);this.onDataEditEnd(this);RLog.debug(this,"End (editor={0} value={1})",b,this.dataValue)}function FColorPicker_setText(b){this.base.FEditControl.setText.call(this,RString.toUpper(b));this.hDrop.style.backgroundColor=b}
function FColorPicker_checkColor(b){return""!=document.createElement("<span style='color:"+b+";'></span>").style.color?!0:!1}function FColorPicker_onDataKeyDown(b){this.base.FEditControl.onDataKeyDown.call(this,this,b);this.checkColor(this.text())?this.hDrop.style.backgroundColor=this.text():this.hDrop.style.backgroundColor=""}
function FColorPicker_drop(){if(this.canDrop()&&this.canEdit){var b=this.editor=RConsole.find(FEditConsole).focus(this,FColorPickerEditor,this.name);b.linkControl(this)&&b.set(this.reget());b.show()}}function FColorPicker_dispose(){this.base.FEditControl.dispose.call(this);RMemory.freeHtml(this.hEdit);RMemory.freeHtml(this.hDrop);this.hDrop=this.hEdit=null}
function FColorPickerEditor(b){b=RClass.inherits(this,b,FDropEditor,MShadow);b.MinWidth=240;b.ColorHex="00 33 66 99 CC FF".split(" ");b.SpColorHex="FF0000 00FF00 0000FF FFFF00 00FFFF FF00FF".split(" ");b.onCellEnter=RClass.register(b,new HMouseOver("onCellEnter"),FColorPickerEditor_onCellEnter);b.onCellSelect=RClass.register(b,new HMouseDown("onCellSelect"),FColorPickerEditor_onCellSelect);b.color=null;b.hTable=null;b.cellWidth=16;b.cellHeight=10;b.onBuildDrop=FColorPickerEditor_onBuildDrop;b.onKeyDown=
FColorPickerEditor_onKeyDown;b.onCellSelect=FColorPickerEditor_onCellSelect;b.onEditEnd=FColorPickerEditor_onEditEnd;b.makeCell=FColorPickerEditor_makeCell;b.set=FColorPickerEditor_set;b.show=FColorPickerEditor_show;b.hide=FColorPickerEditor_hide;b.linkControl=FColorPickerEditor_linkControl;b.dispose=FColorPickerEditor_dispose;return b}
function FColorPickerEditor_onBuildDrop(){this.hTable=RBuilder.appendTable(this.hDropPanel);for(var b=0;2>b;b++)for(var f=0;6>f;f++){var h=this.hTable.insertRow();this.makeCell(h,"#000000");0==b?this.makeCell(h,"#"+this.ColorHex[f]+this.ColorHex[f]+this.ColorHex[f]):this.makeCell(h,"#"+this.SpColorHex[f]);this.makeCell(h,"#000000");for(k=0;3>k;k++)for(l=0;6>l;l++)this.makeCell(h,"#"+this.ColorHex[k+3*b]+this.ColorHex[l]+this.ColorHex[f])}}
function FColorPickerEditor_linkControl(b){if(this.source==b)return!1;this.source=b;RLog.debug(this,"link Panel (panel={0}, edit={1})",RClass.dump(b.hEditCell),RClass.dump(b.hEdit));RHtml.toRect(this.rect,b.hEditCell);RHtml.setPixelRect(this.hPanel,this.rect);this.hPanel.style.pixelTop=this.rect.bottom;var f=this.border.hForm;f.style.pixelWidth=b.editBorder.hForm.width;f.style.pixelHeight=b.editBorder.hForm.height;return!0}
function FColorPickerEditor_onCellEnter(b){this.editable.hDrop.style.backgroundColor=b.hSource.style.backgroundColor}function FColorPickerEditor_onCellSelect(b){this.color=b.srcElement.style.backgroundColor;this.editStatus=EEditStatus.Ok;this.blur()}function FColorPickerEditor_makeCell(b,f){var h=b.insertCell();h.link=this;h.width=this.cellWidth;h.height=this.cellHeight;h.style.backgroundColor=f;this.attachEvent("onCellEnter",h);this.attachEvent("onCellSelect",h);return h}
function FColorPickerEditor_onKeyDown(b){alert(FColorPickerEditor_onKeyDown);var f=b.keyCode;EKey.Up==f?this.select(this.selectIndex-1):EKey.Down==f?this.select(this.selectIndex+1):EKey.Esc==f?(this.editStatus=EEditStatus.Cancel,this.selectIndex=this.originIndex,RKey.eventClear(b),this.inEdit=!1,this.hEdit.blur()):EKey.Enter==f&&(this.editStatus=EEditStatus.Ok,RKey.eventClear(b),this.inEdit=!1,this.hEdit.blur())}function FColorPickerEditor_set(b){this.color=b}
function FColorPickerEditor_show(b){this.base.FDropEditor.show.call(this,b);RConsole.find(FFocusConsole).focus(this);this.border.hForm.offsetWidth<this.MinWidth&&(this.border.hForm.style.pixelWidth=this.MinWidth);this.base.MShadow.show.call(this,b);this.isSkipBlur=!1}
function FColorPickerEditor_onEditEnd(){var b=this.editable;RLog.debug(this,"Edit end (editable={0}, status={1})",RClass.dump(b),REnum.decode(EEditStatus,this.editStatus));if(b){b.hDrop.style.backgroundColor=this.color;var f=RConsole.find(FEventConsole);EEditStatus.Cancel==this.editStatus?f.add(b,b.focus):EEditStatus.Ok==this.editStatus&&(b.onEditEnd(this),f.add(b,b.focus))}this.editable=null;this.inEdit=!1}
function FColorPickerEditor_hide(){this.source=null;this.base.FDropEditor.hide.call(this);this.base.MShadow.hide.call(this)}function FColorPickerEditor_dispose(){this.base.FDropEditor.dispose.call(this);RMemory.freeHtml(this.hTable);RMemory.freeHtml(this.hDropPanel);RMemory.freeHtml(this.hEdit);this.hEdit=this.hDropPanel=this.hTable=null}
function FUiColorPower(b){b=RClass.inherits(this,b,FUiEditControl,MListenerDataChanged,MMouseCapture);b._inputSize=RClass.register(b,new APtySize2("_inputSize"));b._valueMin=RClass.register(b,new APtyNumber("_valueMin"));b._valueMax=RClass.register(b,new APtyNumber("_valueMax"));b._styleValuePanel=RClass.register(b,new AStyle("_styleValuePanel"));b._styleInputPanel=RClass.register(b,new AStyle("_styleInputPanel"));b._styleInput=RClass.register(b,new AStyle("_styleInput"));b._innerOriginValue=null;
b._innerDataValue=null;b._barRed=null;b._barGreen=null;b._barBlue=null;b._barPower=null;b._hColorPanel=null;b._hColorImage=null;b._hChannelPanel=null;b._hChannelForm=null;b.onBuildEditValue=FUiColorPower_onBuildEditValue;b.onMouseCaptureStart=FUiColorPower_onMouseCaptureStart;b.onMouseCapture=FUiColorPower_onMouseCapture;b.onMouseCaptureStop=FUiColorPower_onMouseCaptureStop;b.onInputKeyPress=RClass.register(b,new AEventKeyPress("onInputKeyPress"),FUiColorPower_onInputKeyPress);b.onInputEdit=RClass.register(b,
new AEventInputChanged("onInputEdit"),FUiColorPower_onInputEdit);b.onInputChange=RClass.register(b,new AEventChange("onInputChange"),FUiColorPower_onInputChange);b.construct=FUiColorPower_construct;b.get=FUiColorPower_get;b.set=FUiColorPower_set;b.setDisplayColor=FUiColorPower_setDisplayColor;b.setDisplay=FUiColorPower_setDisplay;b.refreshValue=FUiColorPower_refreshValue;b.dispose=FUiColorPower_dispose;return b}
function FUiColorPower_onBuildEditValue(b){var f=this._hValuePanel;f.className=this.styleName("ValuePanel");f=this._hValueForm=RBuilder.appendTable(f);f.width="100%";f=this._hValueLine=RBuilder.appendTableRow(f);this._hChangePanel=RBuilder.appendTableCell(f);this.onBuildEditChange(b);b=this._hColorPanel=RBuilder.appendTableCell(f);b.width=16;b.style.padding="2px";this._hColorImage=RBuilder.appendIcon(b,null,"n",14,65);b=this._hChannelPanel=RBuilder.appendTableCell(f);b=this._hChannelForm=RBuilder.appendTable(b,
null,0,1,0);b.__linker=this;b.width="100%";f=this._barRed=new SUiColorChannel;f.control=this;f.typeCd="red";f.hPanel=b;f.build();f=this._barGreen=new SUiColorChannel;f.control=this;f.typeCd="green";f.hPanel=b;f.build();f=this._barBlue=new SUiColorChannel;f.control=this;f.typeCd="blue";f.hPanel=b;f.build();f=this._barPower=new SUiColorPower;f.control=this;f.typeCd="power";f.setRange(this._valueMin,this._valueMax);f.hPanel=b;f.build()}
function FUiColorPower_onMouseCaptureStart(b){var f=RHtml.searchObject(b.hSource,"__pbar");if(f)f.onMouseDown(b)}function FUiColorPower_onMouseCapture(b){var f=RHtml.searchObject(b.hSource,"__pbar");if(f)f.onMouseMove(b)}function FUiColorPower_onMouseCaptureStop(b){var f=RHtml.searchObject(b.hSource,"__pbar");if(f)f.onMouseUp(b)}function FUiColorPower_onInputKeyPress(b){var f=b.keyCode;RKeyboard.isControlKey(f)||RKeyboard.isFloatKey(f)||b.cancel()}
function FUiColorPower_onInputEdit(b){(b=b.hSender._pbar)&&b.changeInputEdit();this.processDataChangedListener(this)}function FUiColorPower_onInputChange(b){(b=b.hSender._pbar)&&b.changeInputChange();this.processDataChangedListener(this)}function FUiColorPower_construct(){this.__base.FUiEditControl.construct.call(this);this._inputSize=new SSize2(120,0);this._innerOriginValue=new SColor4;this._innerDataValue=new SColor4}
function FUiColorPower_get(b){b=this._innerDataValue;b.red=this._barRed.get();b.green=this._barGreen.get();b.blue=this._barBlue.get();b.alpha=this._barPower.get();return b}
function FUiColorPower_set(b){this.__base.FUiEditControl.set.call(this,b);if(b.constructor==SColor4)this._innerOriginValue.assign(b),this._innerDataValue.assign(b);else throw new TError("Invalid value format.");this.setDisplayColor();b=this._innerDataValue;this._barRed.set(b.red);this._barGreen.set(b.green);this._barBlue.set(b.blue);this._barPower.set(b.alpha);this.changeSet(!1)}
function FUiColorPower_setDisplayColor(){var b=this._innerDataValue,f=b.alpha,h=RHex.format(RInteger.toRange(parseInt(b.red*f*255),0,255),2),q=RHex.format(RInteger.toRange(parseInt(b.green*f*255),0,255),2),b=RHex.format(RInteger.toRange(parseInt(b.blue*f*255),0,255),2);this._hColorImage.style.backgroundColor="#"+h+q+b}
function FUiColorPower_setDisplay(){this.setDisplayColor();var b=this._innerDataValue;this._barRed.set(b.red);this._barGreen.set(b.green);this._barBlue.set(b.blue);this._barPower.set(b.alpha)}function FUiColorPower_refreshValue(){this.get();this.setDisplayColor();this.processDataChangedListener(this)}function FUiColorPower_dispose(b){this.__base.FUiEditControl.dispose.call(this,b)}
function FUiDropEditor(b){b=RClass.inherits(this,b,FUiEditor,MUiShadow);b._stylePanel=RClass.register(b,new AStyle("_stylePanel"));b._styleDropForm=RClass.register(b,new AStyle("_styleDropForm"));b._styleDropPanel=RClass.register(b,new AStyle("_styleDropPanel"));b._styleButtonPanel=RClass.register(b,new AStyle("_styleButtonPanel"));b._minWidth=160;b._minHeight=300;b._hDropForm=null;b._hDropPanel=null;b._hButtonPanel=null;b.onBuildDrop=RMethod.virtual(b,"onBuildDrop");b.onBuildButton=RMethod.empty;
b.onBuild=FUiDropEditor_onBuild;b.onDropMouseDown=RClass.register(b,new AEventMouseDown("onDropMouseDown"));b.onDropMouseUp=RClass.register(b,new AEventMouseUp("onDropMouseUp"));b.panel=FUiDropEditor_panel;b.setVisible=FUiDropEditor_setVisible;b.dispose=FUiDropEditor_dispose;return b}
function FUiDropEditor_onBuild(b){this.__base.FUiEditor.onBuild.call(this,b);b=this._hPanel;b.className=this.styleName("Panel");b=this._hDropForm=RBuilder.appendTable(b,this.styleName("DropForm"));this._hDropPanel=RBuilder.appendTableRowCell(b,this.styleName("DropPanel"));this._hButtonPanel=RBuilder.appendTableRowCell(b,this.styleName("ButtonPanel"));this.onBuildDrop();this.onBuildButton()}
function FUiDropEditor_panel(b){return b==EPanel.Shadow?this.hPanel:this.__base.FUiEditor.panel.call(this,b)}function FUiDropEditor_setVisible(b){var f=this._hPanel,h=this._hPanel.ownerDocument;b?h.body.appendChild(f):h.body.removeChild(f);this.__base.FUiEditor.setVisible.call(this,b)}function FUiDropEditor_dispose(){this._hButtonPanel=RHtml.free(this._hButtonPanel);this._hDropPanel=RHtml.free(this._hDropPanel);this._hDropForm=RHtml.free(this._hDropForm);this.__base.FControl.dispose.call(this)}
function FUiEdit(b){b=RClass.inherits(this,b,FUiEditControl,MPropertyEdit,MListenerDataChanged);b._inputSize=RClass.register(b,new APtySize2("_inputSize"));b._styleValuePanel=RClass.register(b,new AStyle("_styleValuePanel"));b._styleInputPanel=RClass.register(b,new AStyle("_styleInputPanel"));b._styleInput=RClass.register(b,new AStyle("_styleInput"));b._hValueForm=null;b._hValueLine=null;b._hInputPanel=null;b._hInput=null;b.onBuildEditValue=FUiEdit_onBuildEditValue;b.onInputEdit=RClass.register(b,
new AEventInputChanged("onInputEdit"),FUiEdit_onInputEdit);b.construct=FUiEdit_construct;b.get=FUiEdit_get;b.set=FUiEdit_set;b.refreshValue=FUiEdit_refreshValue;return b}
function FUiEdit_onBuildEditValue(b){var f=this._hValuePanel;f.className=this.styleName("ValuePanel");f=this._hValueForm=RBuilder.appendTable(f);f.width="100%";f=this._hValueLine=RBuilder.appendTableRow(f);this._hChangePanel=RBuilder.appendTableCell(f);this.onBuildEditChange(b);b=this._hInputPanel=RBuilder.appendTableCell(f);f=this._hInput=RBuilder.appendEdit(b,this.styleName("Input"));this.attachEvent("onInputEdit",f,this.onInputEdit);RHtml.setSize(b,this._inputSize);this._editLength&&(f.maxLength=
this._editLength)}function FUiEdit_onInputEdit(b){this.refreshValue()}function FUiEdit_construct(){this.__base.FUiEditControl.construct.call(this);this._inputSize=new SSize2(120,0)}function FUiEdit_get(){var b=this.__base.FUiEditControl.get.call(this);return b=this._hInput.value}function FUiEdit_set(b){this.__base.FUiEditControl.set.call(this,b);this._hInput.value=RString.nvl(b)}function FUiEdit_refreshValue(){this.processDataChangedListener(this)}
function FUiEditControl(b){b=RClass.inherits(this,b,FUiControl,MDataField,MEditValue,MEditChange,MEditDrop);b._labelModeCd=RClass.register(b,new APtyString("_labelModeCd"),EUiLabelMode.All);b._labelPositionCd=RClass.register(b,new APtyString("_labelPositionCd"),EUiLabelPosition.Left);b._labelSize=RClass.register(b,new APtySize2("_labelSize"));b._labelAlignCd=RClass.register(b,new APtyString("_labelAlignCd"),EUiAlign.Left);b._editSize=RClass.register(b,new APtySize2("_editSize"));b._dataTypeCd=RClass.register(b,
new APtyString("_dataTypeCd"));b._styleLabelPanel=RClass.register(b,new AStyle("_styleLabelPanel"));b._styleEditPanel=RClass.register(b,new AStyle("_styleEditPanel"));b._hLabelPanel=null;b._hLabelForm=null;b._hIconPanel=null;b._hIcon=null;b._hTextPanel=null;b._hText=null;b._hEditPanel=null;b._hEditForm=null;b._hValuePanel=null;b.onBuildLabelIcon=FUiEditControl_onBuildLabelIcon;b.onBuildLabelText=FUiEditControl_onBuildLabelText;b.onBuildLabel=FUiEditControl_onBuildLabel;b.onBuildEditValue=RMethod.virtual(b,
"onBuildEditValue");b.onBuildEdit=FUiEditControl_onBuildEdit;b.onBuildPanel=FUiEditControl_onBuildPanel;b.onBuild=FUiEditControl_onBuild;b.oeDataLoad=FUiEditControl_oeDataLoad;b.oeDataSave=FUiEditControl_oeDataSave;b.oeDesign=FUiEditControl_oeDesign;b.oeMode=FUiEditControl_oeMode;b.construct=FUiEditControl_construct;b.panel=FUiEditControl_panel;b.label=FUiEditControl_label;b.setLabel=FUiEditControl_setLabel;b.getValueRectangle=FUiEditControl_getValueRectangle;b.dispose=FUiEditControl_dispose;return b}
function FUiEditControl_onBuildLabelIcon(b){this._labelIcon&&(this._hIcon=RBuilder.appendIcon(this._hIconPanel,null,this._labelIcon))}function FUiEditControl_onBuildLabelText(b){this._hText=RBuilder.appendSpan(this._hTextPanel,null,this._label)}
function FUiEditControl_onBuildLabel(b){var f=this._hLabelForm=RBuilder.appendTable(this._hLabelPanel,this.styleName("LabelPanel")),h=RBuilder.appendTableRow(f);this._hIconPanel=RBuilder.appendTableCell(h);this.onBuildLabelIcon(b);h=this._hTextPanel=RBuilder.appendTableCell(h);h.noWrap=!0;this.onBuildLabelText(b);RHtml.setSize(f,this._labelSize);this._labelAlignCd&&(h.align=this._labelAlignCd,h.style.paddingRight=4);this._labelColor&&(this._hLabel.style.color=this._labelColor)}
function FUiEditControl_onBuildEdit(b){var f=this._hEditForm=RBuilder.appendTable(this._hEditPanel,this.styleName("EditPanel")),h=this._hEditLine=RBuilder.appendTableRow(f);this._hValuePanel=RBuilder.appendTableCell(h);this.onBuildEditValue(b);RHtml.setSize(f,this._editSize)}function FUiEditControl_onBuildPanel(b){this._hPanel=RBuilder.createTable(b,this.styleName("Panel"))}
function FUiEditControl_onBuild(b){this.__base.FUiControl.onBuild.call(this,b);var f=this._hPanel,h=null,q=null,u=this._labelModeCd;u==EUiLabelMode.Label?h=RBuilder.appendTableCell(RBuilder.appendTableRow(f)):u==EUiLabelMode.Hidden?q=RBuilder.appendTableCell(RBuilder.appendTableRow(f)):(h=this._labelPositionCd,h==EUiLabelPosition.Top?(h=RBuilder.appendTableRowCell(f),q=RBuilder.appendTableRowCell(f)):h==EUiLabelPosition.Right?(f=RBuilder.appendTableRow(f),q=RBuilder.appendTableCell(f),h=RBuilder.appendTableCell(f)):
h==EUiLabelPosition.Bottom?(q=RBuilder.appendTableRowCell(f),h=RBuilder.appendTableRowCell(f)):(f=RBuilder.appendTableRow(f),h=RBuilder.appendTableCell(f),q=RBuilder.appendTableCell(f)));this._hLabelPanel=h;this._hEditPanel=q;h&&(this.onBuildLabel(b),h.appendChild(this._hLabelForm),this.setLabel(this._label));if(q)this.onBuildEdit(b)}
function FUiEditControl_getValueRectangle(b){b||(b=new SRectangle);var f=this._hValuePanel,h=RHtml.clientPosition(f);b.position.assign(h);b.setSize(f.offsetWidth,f.offsetHeight);return b}function FUiEditControl_onScalar(b){this.set(b.result)}function FUiEditControl_scalar(b){b=new TDatasetScalarArg(this,null,b);b.callback=new TInvoke(this,this.onScalar);RConsole.find(FDatasetConsole).scalar(b)}
function FUiEditControl_onDataDoubleClick(){if(RClass.isClass(this,MDropable))this.onDropDoubleClick();if(RClass.isClass(this,MListView))this.onListClick()}
function FUiEditControl_onDataKeyDown(b,f){this.__base.MEditDescriptor.onDataKeyDown.call(this,b,f);var h=this.hChangeIcon;h&&(h.style.display=this.isDataChanged()?"block":"none");if(RClass.isClass(this,MDropable)&&EKey.Down==f.keyCode)this.drop();else if(f.ctrlKey&&EKey.Enter==f.keyCode&&this.editSearch&&(h=this.dsControl)&&!this.isValid){var q=new TNode("Search"),u=q.create("Item");u.set("name",this.name);u.set("data_name",this.dataName);u.set("data_value",this.dataValue);u.set("search_type",ESearch.Equals);
u.set("search_order",EOrder.None);RConsole.find(FDatasetConsole).fetch(h,q)}}function FUiEditControl_onDesignBegin(){this.__base.MDesign.onDesignBegin.call(this);this._disbaled=!0;this.hEdit.disbaled=!0}function FUiEditControl_onDesignEnd(){this.__base.MDesign.onDesignEnd.call(this);this._disbaled=!1;this.hEdit.disbaled=!1}function FUiEditControl_oeDataLoad(b){b=b.source.currentRow().get(this._dataName);this.set(b);return EEventStatus.Stop}
function FUiEditControl_oeDataSave(b){b=b.source.currentRow();var f=this.get();b.set(this._dataName,f);return EEventStatus.Stop}
function FUiEditControl_oeDesign(b){this.__base.MDesign.oeDesign.call(this,e);b=this.hLabelForm;var f=this.hEditForm;switch(e.mode){case EDesign.Move:e.flag?(this.hForm.border=1,b&&(b.cellPadding=1),this.hEdit&&(this.hEdit.disabled=!0)):(this.hForm.border=0,b&&(b.border=0,b.cellPadding=0),this.hEdit&&(this.hEdit.disabled=!1));break;case EDesign.Border:e.flag?(this.hForm.border=1,f&&(f.border=1)):(this.hForm.border=0,f&&(f.border=0))}return EEventStatus.Stop}
function FUiEditControl_oeMode(b){this.__base.FUiControl.oeMode.call(this,b);this.__base.MDisplay.oeMode.call(this,b);this._editable=this.canEdit(b.mode);this._validable=this.canValid(b.mode);this._progress||this.setEditable(this._editable);return EEventStatus.Stop}function FUiEditControl_oeProgress(b){if(this._progress&&b.enable)return EEventStatus.Stop;(this._progress=b.enable)?(b=this._editable,this.setEditable(!1),this._editable=b):this.setEditable(this._editable);return EEventStatus.Stop}
function FUiEditControl_oeLoadValue(b){b=this.__base.MEditValue.oeLoadValue.call(this,b);var f=this.hChangeIcon;f&&(f.style.display="none");return b}function FUiEditControl_doFocus(b){this.__base.MUiFocus.doFocus.call(this,b);this.__base.MEditValue.doFocus.call(this,b)}function FUiEditControl_doBlur(b){this.__base.MUiFocus.doBlur.call(this,b);this.__base.MEditValue.doBlur.call(this,b)}
function FUiEditControl_construct(){this.__base.FUiControl.construct.call(this);this.__base.MEditChange.construct.call(this);this.__base.MEditDrop.construct.call(this);this._labelSize=new SSize2(100,20);this._editSize=new SSize2(200,20)}function FUiEditControl_panel(b){return EPanel.Edit==b||EPanel.Focus==b?this.hEdit:this.__base.FUiControl.panel.call(this,b)}function FUiEditControl_label(b){return this._label}
function FUiEditControl_setLabel(b){this._label=b;this._hText&&(this._hText.innerHTML=RString.nvl(b))}function FUiEditControl_testFocus(){return this._visible&&this._editable&&!this._disbaled}function FUiEditControl_text(){return this.hEdit?this.hEdit.value:""}function FUiEditControl_setText(b){this.hEdit.value=b}
function FUiEditControl_setEditable(b){this.__base.MEditValue.setEditable.call(this,b);this.hEdit&&(this.hEdit.readOnly=!b);var f=this.hLabel;f&&(this.validRequire&&(this.hLabel.style.color=b?EColor.Require:EColor.Text),RClass.isClass(this,MListView)&&this.canListView()&&(f.style.cursor=b?"hand":"normal",f.className=b?"RLine_Underline":""))}function FUiEditControl_setVisible(b){this.__base.FUiControl.setVisible.call(this,b);this.refreshStyle()}
function FUiEditControl_focus(){this.__base.MUiFocus.focus.call(this);if(this.hEdit)try{this.hEdit.focus()}catch(b){}}
function FUiEditControl_refreshStyle(){if(this._visible){var b=EColor.TextReadonly,f=EColor.Readonly,h="normal";this._editable&&(b=EColor.TextEdit,f=EColor.Edit,h="hand",RString.isEmpty(this.editTip)||this.hEdit.innerText!=this.editTip||(b="#CCCCCC"));this._invalidText&&!RString.isEmpty(this.text())&&(b=EColor.TextInvalid,f=EColor.Invalid);this._textColor=b;this._backColor=f;var q=this.hEdit,u=this.hDrop;q&&(q.style.color=b,q.style.backgroundColor=f);u&&(q&&(q.style.cursor=h),u.style.cursor=h);this.editBorder&&
(b=EUiBorderStyle.Readonly,this._editable&&(b=EUiBorderStyle.Edit),this._hover&&(b=EUiBorderStyle.Hover),this.setEditBorderStyle(b,f))}}
function FUiEditControl_dispose(){this._dataTypeCd=this._labelAlignCd=this._labelPositionCd=this._labelModeCd=null;var b=this._labelSize;b&&(b.dispose(),this._labelSize=null);if(b=this._editSize)b.dispose(),this._editSize=null;RHtml.free(this._hLabelPanel);this._hLabelPanel=null;RHtml.free(this._hLabelForm);this._hLabelForm=null;RHtml.free(this._hIconPanel);this._hIconPanel=null;RHtml.free(this._hIcon);this._hIcon=null;RHtml.free(this._hTextPanel);this._hTextPanel=null;RHtml.free(this._hText);this._hText=
null;RHtml.free(this._hEditPanel);this._hEditPanel=null;RHtml.free(this._hEditForm);this._hEditForm=null;RHtml.free(this._hValuePanel);this._hValuePanel=null;RHtml.free(this._hDropPanel);this._hDropPanel=null;this.__base.MEditDrop.dispose.call(this);this.__base.MEditChange.dispose.call(this);this.__base.FUiControl.dispose.call(this)}
function FUiEditor(b){b=RClass.inherits(this,b,FUiControl,MUiFocus);b._visible=!1;b._statusVisible=!1;b._styleEdit=RClass.register(b,new AStyle("_styleEdit"));b._statusEditing=!1;b._source=null;b._hEdit=null;b.lsnEditBegin=null;b.lsnEditCancel=null;b.lsnEditEnd=null;b.onEditKeyDown=RClass.register(b,new AEventKeyDown("onEditKeyDown"));b.onEditKeyPress=RClass.register(b,new AEventKeyPress("onEditKeyPress"));b.onEditKeyUp=RClass.register(b,new AEventKeyUp("onEditKeyUp"));b.onEditChange=RClass.register(b,
new AEventChange("onEditChange"));b.onEditBegin=FUiEditor_onEditBegin;b.onEditChanged=FUiEditor_onEditChanged;b.onEditEnd=FUiEditor_onEditEnd;b.onBuildPanel=FUiEditor_onBuildPanel;b.onBuild=FUiEditor_onBuild;b.get=RMethod.virtual(b,"get");b.set=RMethod.virtual(b,"set");b.doBlur=FUiEditor_doBlur;b.panel=FUiEditor_panel;b.linkControl=FUiEditor_linkControl;b.editBegin=FUiEditor_editBegin;b.editCancel=FUiEditor_editCancel;b.editEnd=FUiEditor_editEnd;b.reset=FUiEditor_reset;b.setVisible=FUiEditor_setVisible;
b.dispose=FUiEditor_dispose;return b}function FUiEditor_onEditBegin(){this.editBegin()}function FUiEditor_onEditChanged(){RLogger.debug(this,"Edit changed");(this.storage=RObject.nvlObj(this.storage)).value==this.value()?this.changed&&(this.changed=!1):this.changed||(this.changed=!0)}
function FUiEditor_onEditEnd(){var b=this._source;RLogger.debug(this,"Editor end. (control={1})",RClass.dump(b));this.hide();this.lsnEditEnd&&this.lsnEditEnd.process(this);this._source=b._editor=null;this._statusEditing=!1}function FUiEditor_onBuildPanel(b){(this._hPanel=RBuilder.createSpan(b)).__linker=this}function FUiEditor_onBuild(b){this.__base.FUiControl.onBuild.call(this,b);this._hPanel.style.zIndex=EUiLayer.Editor}function FUiEditor_get(b){}function FUiEditor_set(b,f){}
function FUiEditor_doBlur(){var b=this._source;b&&(this.editCancel(),RClass.isClass(b,MUiFocus)&&b.doBlur())}function FUiEditor_panel(b){return b==EPanel.Edit||b==EPanel.Focus?this._hEdit:this.__base.FUiControl.panel.call(this,b)}function FUiEditor_linkControl(b){this._source=b}function FUiEditor_editBegin(){var b=this._source;RLogger.debug(this,"Editor begin. (control={1})",RClass.dump(b));this.lsnEditCancel&&this.lsnEditCancel.process(this);b._editor=this;this._statusEditing=!0}
function FUiEditor_editCancel(){var b=this._source;RLogger.debug(this,"Editor cancel. (control={1})",RClass.dump(b));this.hide();this.lsnEditCancel&&this.lsnEditCancel.process(this);this._source=b._editor=null;this._statusEditing=!1}function FUiEditor_editEnd(){this.onEditEnd()}function FUiEditor_reset(){this.lsnEditEnd=this.lsnEditCancel=this.lsnEditBegin=null}function FUiEditor_setVisible(b){this.__base.FUiControl.setVisible.call(this,b);b&&(this.editBegin(),this.focus())}
function FUiEditor_dispose(){this.__base.FUiControl.dispose.call(this);this._hEdit=null}
function FUiForm(b){b=RClass.inherits(this,b,FUiLayout,MDataset,MDescribeFrame);b.onMouseDown=FUiForm_onMouseDown;b.construct=FUiForm_construct;b._dataStatusCd=ERowStatus.Update;b._clearEvent=null;b._resetEvent=null;b._loadEvent=null;b._saveEvent=null;b._recordEvent=null;b._codeEvent=null;b._dataComponents=null;b.lsnsLoaded=null;b.lsnsClick=null;b.onLoadDataset=FUiForm_onLoadDataset;b.onLoadDatasetEnd=FUiForm_onLoadDatasetEnd;b.isDataChanged=FUiForm_isDataChanged;b.getFormLink=FUiForm_getFormLink;
b.allDataComponents=FUiForm_allDataComponents;b.get=FUiForm_get;b.reget=FUiForm_reget;b.set=FUiForm_set;b.getDataCodes=FUiForm_getDataCodes;b.getCurrentRow=FUiForm_getCurrentRow;b.getSelectedRows=FUiForm_getSelectedRows;b.getCurrentRows=FUiForm_getCurrentRows;b.getChangedRows=FUiForm_getChangedRows;b.getRows=FUiForm_getRows;b.clearValue=FUiForm_clearValue;b.resetValue=FUiForm_resetValue;b.loadValue=FUiForm_loadValue;b.saveValue=FUiForm_saveValue;b.recordValue=FUiForm_recordValue;b.toAttributes=FUiForm_toAttributes;
b.focus=FUiForm_focus;b.dsUpdate=FUiForm_dsUpdate;b.doPrepare=FUiForm_doPrepare;b.doUpdate=FUiForm_doUpdate;b.doDelete=FUiForm_doDelete;b.dispose=FUiForm_dispose;return b}function FUiForm_onMouseDown(b){}function FUiForm_construct(){this.__base.FUiLayout.construct.call(this)}function FUiForm_onLoadDataset(b){this.doUpdate(this.dsViewer.current())}function FUiForm_onLoadDatasetEnd(){this.topControl().topResize();this.psProgress(!1)}
function FUiForm_isDataChanged(){var b=this.allDataComponents();if(!b.isEmpty())for(var f=b.count,h=0;h<f;h++)if(b.value(h).isDataChanged())return!0}function FUiForm_getFormLink(b){if(EFormLink.Form==b)return this.name;if(EFormLink.Table==b)return this.formName;RMessage.fatal(this,null,"Form link is invalid. (type={0})",b)}
function FUiForm_allDataComponents(b,f){b||(b=this);f||(f=this._dataComponents);var h=b.components;if(h)for(var q=h.count,u=0;u<q;u++){var z=h.value(u);RClass.isClass(z,MDataset)||(RClass.isClass(z,MValue)&&f.set(z.dataName,z),this.allDataComponents(z,f))}return f}function FUiForm_get(b){var f=this.allDataComponents();if(f&&(b=f.get(b)))return b.get()}function FUiForm_reget(b){var f=this.allDataComponents();if(f&&(b=f.get(b)))return b.reget()}
function FUiForm_set(b,f){var h=this.allDataComponents();h&&(h=h.get(b))&&h.set(f)}function FUiForm_getDataCodes(){var b=this._codeEvent;b.values=new TAttributes;this.process(b);return b.values}function FUiForm_getCurrentRow(){return this.saveValue()}function FUiForm_getSelectedRows(){var b=new TList;b.push(this.saveValue());return b}function FUiForm_getCurrentRows(){var b=new TList,f=new TRow;this.toDeepAttributes(f);this.saveValue(f);b.push(f);return b}
function FUiForm_getChangedRows(){var b=new TList;if(this.isDataChanged()){var f=new TRow;this.toDeepAttributes(f);this.saveValue(f);b.push(f)}return b}function FUiForm_getRows(){var b=new TList;b.push(this.saveValue());return b}function FUiForm_clearValue(){this.process(this._clearEvent)}function FUiForm_resetValue(){this.process(this._resetEvent)}function FUiForm_loadValue(b,f){if(b){var h=this._loadEvent;h.viewer=this.dsViewer;h.store=f;h.values=b;this.process(h)}}
function FUiForm_saveValue(b,f){b||(b=new TRow);var h=this._saveEvent;h.viewer=this.dsViewer;h.store=f;h.values=b;this.process(h);b.set("_status",this._dataStatusCd);return b}function FUiForm_recordValue(){this.process(this._recordEvent)}function FUiForm_toAttributes(b,f){return this.saveValue(b,f)}function FUiForm_focus(){this.__base.MUiFocus.focus.call(this);this.focusControl();RConsole.find(FFocusConsole).focusClass(MDataset,this)}
function FUiForm_dsUpdate(b,f){if(b){this.psProgress(!0);this.psMode(EMode.Update);var h=new TDatasetFetchArg(this.name,this.formId,this.dsPageSize,0);h.form=this;h.reset=!0;this.dsSearchs.clear();b&&this.dsSearchs.push(new TSearchItem("OUID",b));f&&this.dsSearchs.push(new TSearchItem("OVER",f));h.searchs=this.dsSearchs;h.values.append(this.dsValues);h.callback=new TInvoke(this,this.onDsUpdate);this.onDsUpdateCheck(h)&&RConsole.find(FDatasetConsole).fetch(h)}else return this.__base.MDataset.dsUpdate.call(this,
b,f)}function FUiForm_setEditable(b){var f=this.allDataComponents();if(f)for(var h=f.count,q=0;q<h;q++)f.value(q).setEditable(b)}function FUiForm_doPrepare(b){this._dataStatusCd=ERowStatus.Insert;this.resetValue();this.loadValue(b);this.recordValue();this.dsLoaded()}function FUiForm_doUpdate(b){this._dataStatusCd=ERowStatus.Update;this.clearValue();this.loadValue(b);this.recordValue();this.dsLoaded()}
function FUiForm_doDelete(b){this._dataStatusCd=ERowStatus.Delete;this.clearValue();this.loadValue(b);this.recordValue();this.dsLoaded()}function FUiForm_dispose(){this.__base.FUiLayout.dispose.call(this);RMemory.freeHtml(this.hEdit);RMemory.freeHtml(this.hDrop);this.hDrop=this.hEdit=null}
function FUiForm_allNameComponents(b,f,h){var q=this._nameComponents;if(!b&&q)return q;q||(q=this._nameComponents=new TMap);b&&q.clear();f||(f=this);h||(h=q);if(b=f.components){f=b.count;for(var u=0;u<f;u++){var z=b.value(u);RClass.isClass(z,MDataset)||(RClass.isClass(z,MValue)&&h.set(z.name,z),this.allNameComponents(!1,z,h))}}return q}function FUiForm_onLoaded(){var b=this.form,f=this.document;b&&f&&(RControl.build(b,f.root()),b.isLoading=!1,b.lsnsLoaded.process(b))}
function FUiForm_onDsFetchEnd(){var b=this.dsCurrent();b&&this.loadValue(b)}function FUiForm_onDsUpdateBegin(){var b=this.dsCurrent();b&&this.saveValue(b)}function FUiForm_onDsUpdateEnd(){var b=this.dsCurrent();b&&this.loadValue(b)}
function FUiForm_connect(b,f,h,q){var u=new TXmlDocument,z=u.root();z.set("type",f);z.set("name",this.name);z.set("action",h);z.create("Attributes").value=q;f=new TEvent(this,EXmlEvent.Send);f.url=b;f.document=u;f.form=this;f.onLoad=this.onLoaded;RConsole.find(FXmlConsole).process(f)}function FUiForm_loadDocument(b){b&&(b=b.root(),b.isName("Table")&&(this.loadConfig(b),this.buildColumns(b),this.buildRows(b)))}
function FUiForm_testStatus(b){var f=this.__base.MDataset.testStatus.call(this,b);return EDataAction.Fetch==b||EDataAction.Fetch==b||EDataAction.Search==b?!0:EDataAction.First==b||EDataAction.Prior==b||EDataAction.Next==b||EDataAction.Last==b?!1:EDataAction.Action==b?!0:f}function FUiForm_hasAction(){for(var b=this.components,f=b.count,h=0;h<f;h++){var q=b.value(h);if(RClass.isClass(q,FDataAction))return!0}return!1}function FUiFrame(b){return b=RClass.inherits(this,b,FUiLayout)}
function FIconPicker(b){b=RClass.inherits(this,b,FEditControl,MEditBorder,MListView);b.iconDefault=RClass.register(b,new TPtyStr("iconDefault"));b.stIconDefault=RClass.register(b,new TStyleIcon("Default"));b.hEditIcon=null;b.borderStyle=EUiBorder.RoundIcon;b.onEditKeyDown=FIconPicker_onEditKeyDown;b.onEditKeyPress=FIconPicker_onEditKeyPress;b.onBuildEdit=FIconPicker_onBuildEdit;b.setText=FIconPicker_setText;b.dispose=FIconPicker_dispose;return b}
function FIconPicker_onEditKeyDown(b){this.base.FEditControl.onEditKeyDown.call(this,b);this.hEditIcon.src=RRes.iconPath(RString.nvl(this.text(),this.styleIcon("Default")))}function FIconPicker_onEditKeyPress(b){this.base.FEditControl.onEditKeyPress.call(this,b);this.editCase&&RKey.fixCase(b,this.editCase)}
function FIconPicker_onBuildEdit(b){var f=b.hPanel;b.hIcon.width=1;f.align="center";f.noWrap="true";b=RString.nvl(this.iconDefault,this.styleIcon("Default"));this.hEditIcon=RBuilder.appendIcon(f,b);f=this.hEdit=RBuilder.appendEdit(f,this.style("Edit"));f.autocomplete=RBool.isTrue(this.editComplete)?"on":"off";this.editLength&&(f.maxLength=this.editLength)}
function FIconPicker_setText(b){this.base.FEditControl.setText.call(this,b);this.hEditIcon.src=RResource.iconPath(RString.nvl(this.text(),this.styleIcon("Default")))}function FIconPicker_dispose(){this.base.FEditControl.dispose.call(this);this.hEdit=this.hEditIcon=null}function FUiLabel(b){b=RClass.inherits(this,b,FEditControl);b.onBuildEdit=FUiLabel_onBuildEdit;b.text=FUiLabel_text;b.setText=FUiLabel_setText;b.refreshStyle=RMethod.empty;return b}function FUiLabel_onBuildEdit(){}
function FUiLabel_text(){}function FUiLabel_setText(b){}
function FUiLayout(b){b=RClass.inherits(this,b,FUiContainer);b._styleForm=RClass.register(b,new AStyle("_styleForm","Form"));b._lastSplit=null;b._hPanelForm=null;b._hContainer=null;b._hPanelTable=null;b._hPanelLine=null;b.onBuildPanel=FUiLayout_onBuildPanel;b.onDesignBegin=FUiLayout_onDesignBegin;b.onDesignEnd=FUiLayout_onDesignEnd;b.oeDesign=FUiLayout_oeDesign;b.oeResize=FUiLayout_oeResize;b.oeRefresh=FUiLayout_oeRefresh;b.insertPosition=FUiLayout_insertPosition;b.moveChild=FUiLayout_moveChild;b.innerAppendLine=
FUiLayout_innerAppendLine;b.appendChild=FUiLayout_appendChild;b.resize=FUiLayout_resize;b.dispose=FUiLayout_dispose;return b}function FUiLayout_onBuildPanel(b){b=this._hPanel=this._hPanelForm=RBuilder.createTable(b.hDocument,this.styleName("Form"),null,0,1);this._layoutCd==EUiLayout.Design&&(b=RBuilder.appendTableRow(b),this._hContainer=RBuilder.appendTableCell(b))}function FUiLayout_onDesignBegin(){this.__base.MDesign.onDesignBegin.call(this)}
function FUiLayout_onDesignEnd(){this.__base.MDesign.onDesignEnd.call(this)}function FUiLayout_oeDesign(b){this.__base.FUiContainer.oeDesign.call(this,b);if(b.isAfter())switch(b.layoutCd){case EDesign.Border:event.flag?(this._hPanel.border=1,this._hPanel.style.border="1 solid red"):(this._hPanel.border=0,this._hPanel.style.border=null)}}function FUiLayout_oeResize(b){this.__base.FUiContainer.oeResize.call(this,b);b.isAfter()&&this.resize()}
function FUiLayout_oeRefresh(b){this.__base.FUiContainer.oeDesign.call(this,b);b.isAfter()&&this.resize()}function FUiLayout_insertPosition(b,f,h,q){q=this._components;var u=this.controls;q.removeValue(b);u.removeValue(b);if(f){var z=q.indexOfValue(f);q.insert(z+h,b.name,b);z=u.indexOfValue(f);u.insert(z+h,b.name,b)}else q.set(b.name,b),u.set(b.name,b)}
function FUiLayout_moveChild(b,f,h,q){if(b&&f&&h&&b!=f){var u=!1,z=RClass.isClass(b,MUiHorizontal),A=RHtml.parent(b._hPanel,"TD"),B=RHtml.parent(b._hPanel,"TABLE"),C=RClass.isClass(f,MUiHorizontal),D=RHtml.parent(f._hPanel,"TD"),E=RHtml.parent(D,"TABLE");switch(h){case EPosition.Before:z=E.rows[0];for(h=0;h<z.cells.length;h++)if(z.cells[h]==D){z=RBuilder.appendTableCell(z,null,D.cellIndex);z.appendChild(b._hPanel);this.insertPosition(b,f,0,q);b.nowrap=!0;b._hPanelLine=E;u=!0;break}break;case EPosition.After:z=
E.rows[0];for(h=0;h<z.cells.length;h++)if(z.cells[h]==D){A=RHtml.parent(b._hPanel,"TD");z=RBuilder.appendTableCell(z,null,D.cellIndex+1);z.appendChild(b._hPanel);this.insertPosition(b,f,1,q);b.nowrap=!1;b._hPanelLine=E;u=f.nowrap=!0;break}break;case EPosition.LineBefore:if(C)z?this._hContainer.insertBefore(b._hPanel,f._hPanel):(D=this.innerAppendLine(),this._hContainer.insertBefore(D,f._hPanel),z=RBuilder.appendTableCell(this._hPanelLine),z.appendChild(b._hPanel),b._hPanelLine=D),this.insertPosition(b,
f,0,q);else for(D=this._hContainer.children.length,h=0;h<D;h++)if(this._hContainer.children[h]==E){z?this._hContainer.insertBefore(b._hPanel,E):(D=this.innerAppendLine(),this._hContainer.insertBefore(D,E),z=RBuilder.appendTableCell(this._hPanelLine),z.appendChild(b._hPanel),b._hPanelLine=D,u=!0);this.insertPosition(b,f,0,q);b.nowrap=!1;break}break;case EPosition.LineAfter:z?this._hContainer.appendChild(b._hPanel):(this.innerAppendLine(),z=RBuilder.appendTableCell(this._hPanelLine),z.appendChild(b._hPanel),
z.appendChild(b._hPanel),u=!0),this.insertPosition(b,null,0,q),f.nowrap=!1,b.nowrap=!1}u&&(A.removeNode(!0),0==B.rows[0].cells.length&&B.removeNode(!0))}}function FUiLayout_innerAppendLine(){var b=null;this._layoutCd==EUiLayout.Design?(b=this._hPanelTable=RBuilder.appendTable(this._hContainer),b.style.paddingBottom=4,this._hPanelLine=RBuilder.appendTableRow(b)):this._hPanelLine=this._hPanelTable=null;return b}
function FUiLayout_appendChild(b){if(this._layoutCd==EUiLayout.Design)if(this._hPanelLine||this.innerAppendLine(),RClass.isClass(b,MUiHorizontal))0==this._hPanelTable.rows[0].cells.length?this._hContainer.insertBefore(b._hPanel,this._hPanelTable):(this._hContainer.appendChild(b._hPanel),this.innerAppendLine());else{var f=RBuilder.appendTableCell(this._hPanelLine);RClass.isClass(b,FUiLayout)||(b._hPanelLine=this._hPanelTable);f.appendChild(b._hPanel);b._hLayoutCell=f;b.nowrap||this.controls.last()==
b||this.innerAppendLine()}else if(b._hPanel.style.paddingTop=2,b._hPanel.style.paddingBottom=2,RSet.contains(b._sizeCd,EUiSize.Horizontal)||"100%"==b.width){RClass.isClass(b,FUiSplit)&&(this._lastSplit=b);var f=RBuilder.appendTableRow(this._hPanelForm),h=RBuilder.appendTableCell(f);h.vAlign="top";h.appendChild(b._hPanel);b._hLayoutRow=f;this._hPanelLast=h;RSet.contains(b._sizeCd,EUiSize.Vertical)?b.height&&(h.height=b.height):h.height=1;this._hPanelLine=null}else this._hPanelLine||(f=RBuilder.appendTableRow(this._hPanelForm),
f.height=1,this._lastSplit&&this._lastSplit.pushLine(f),h=RBuilder.appendTableCell(f),h.vAlign="top",f=this._hPanelTable=RBuilder.appendTable(h),this._hPanelLine=RBuilder.appendTableRow(f)),h=RBuilder.appendTableCell(this._hPanelLine),b._hLayoutRow=this._hPanelLine,this._hPanelLast=h,h.appendChild(b._hPanel),b._hLayoutCell=h,b.nowrap||(this._hPanelLine=null)}
function FUiLayout_resize(){var b=this._components;if(b)for(var b=b.count(),f=0;f<b;f++){var h=this._components.value(f);if(RClass.isClass(h,FTable)||RClass.isClass(h,FUiPageControl))break}}function FUiLayout_dispose(){this._hContainer=this._hPanel=this._hPanelTable=this._hPanelCurrent=null;this.__base.FUiContainer.dispose.call(this)}
function FUiListBox(b){b=RClass.inherits(this,b,FUiContainer,MUiHorizontal,MListenerClick);b._sizeCd=EUiSize.Horizontal;b._stylePanel=RClass.register(b,new AStyle("_stylePanel"));b._hForm=null;b.onBuildPanel=FUiListBox_onBuildPanel;b.createItem=FUiListBox_createItem;b.appendChild=FUiListBox_appendChild;b.clickItem=FUiListBox_clickItem;b.clear=FUiListBox_clear;b.dispose=FUiListBox_dispose;return b}function FUiListBox_onBuildPanel(b){this._hPanel=RBuilder.createTable(b,this.styleName("Panel"))}
function FUiListBox_createItem(b,f){var h=RClass.create(FUiListItem);h.build(this._hPanel);h.setLabel(f);return h}function FUiListBox_appendChild(b){this._hPanel.appendChild(b._hPanel)}function FUiListBox_clickItem(b){var f=this._components;if(f)for(var h=f.count(),q=0;q<h;q++){var u=f.value(q);RClass.isClass(u,FUiListItem)&&u.setChecked(u==b)}this.processClickListener(this,b)}
function FUiListBox_clear(){var b=this._components;if(b){for(var f=b.count(),h=0;h<f;h++){var q=b.value(h);RClass.isClass(q,FUiListItem)&&this._hPanel.removeChild(q._hPanel);q.dispose()}b.clear();this._controls.clear()}}function FUiListBox_dispose(){this.__base.FContainer.dispose.call(this)}
function FUiListItem(b){b=RClass.inherits(this,b,FUiControl);b._styleNormal=RClass.register(b,new AStyle("_styleNormal"));b._styleHover=RClass.register(b,new AStyle("_styleHover"));b._styleSelect=RClass.register(b,new AStyle("_styleSelect"));b._styleIconPanel=RClass.register(b,new AStyle("_styleIconPanel"));b._styleIcon=RClass.register(b,new AStyle("_styleIcon"));b._styleLabel=RClass.register(b,new AStyle("_styleLabel"));b._checked=!1;b._hPanel=null;b._hIconPanel=null;b._hIcon=null;b._hLabel=null;
b.onBuildPanel=FUiListItem_onBuildPanel;b.onBuild=FUiListItem_onBuild;b.onEnter=FUiListItem_onEnter;b.onLeave=FUiListItem_onLeave;b.onClick=RClass.register(b,new AEventClick("onClick"),FUiListItem_onClick);b.label=FUiListItem_label;b.setLabel=FUiListItem_setLabel;b.setChecked=FUiListItem_setChecked;b.dispose=FUiListItem_dispose;return b}function FUiListItem_onBuildPanel(b){this._hPanel=RBuilder.createTableRow(b,this.styleName("Normal"))}
function FUiListItem_onBuild(b){this.__base.FUiControl.onBuild.call(this,b);b=this._hPanel;this._hIconPanel=RBuilder.appendTableCell(b,this.styleName("IconPanel"));this._icon&&(this._hIcon=RBuilder.appendIcon(this._hIconPanel,this.styleName("Icon"),this._icon));this._hLabel=RBuilder.appendTableCell(b,this.styleName("Label"));this._label&&this.setLabel(this._label);this.attachEvent("onClick",b)}
function FUiListItem_onEnter(){this.__base.FUiControl.onEnter.call(this);this._hPanel.className=RBoolean.parse(this._checked)?this.styleName("Select"):this.styleName("Hover")}function FUiListItem_onLeave(){this._hPanel.className=RBoolean.parse(this._checked)?this.styleName("Select"):this.styleName("Normal");this.__base.FUiControl.onLeave.call(this)}function FUiListItem_onClick(b){this._parent.clickItem(this)}function FUiListItem_label(b){return this._label}
function FUiListItem_setLabel(b){this._label=b;this._hLabel.innerHTML=RString.nvl(b)}function FUiListItem_setChecked(b){this._checked=b;this._hIcon?this._hIcon.style.display=b?"block":"none":this._hIconPanel.innerHTML=b?"O":"";this._hPanel.className=b?this.styleName("Select"):this.styleName("Normal")}
function FUiListItem_dispose(){this._hPanel=RHtml.free(this._hPanel);this._hIconPanel=RHtml.free(this._hIconPanel);this._hIcon=RHtml.free(this._hIcon);this._hLabel=RHtml.free(this._hLabel);this.__base.FUiControl.dispose.call(this)}
function FUiListView(b){b=RClass.inherits(this,b,FContainer,MShadow);b.type=null;b.lovControl=null;b.listView=null;b.hForm=null;b.hMessages=null;b.ohClearClick=FUiListView_ohClearClick;b.ohCloseClick=FUiListView_ohCloseClick;b.ohResetClick=FUiListView_ohResetClick;b.ohLoaded=FUiListView_ohLoaded;b.oeBuild=FUiListView_oeBuild;b.onBuildPanel=FUiListView_onBuildPanel;b.onBuildFields=FUiListView_onBuildFields;b.onBuildButton=FUiListView_onBuildButton;b.onBuildData=FUiListView_onBuildData;b.onKeyDown=
FUiListView_onKeyDown;b.buildField=FUiListView_buildField;b.linkLovControl=FUiListView_linkLovControl;b.isBuilded=FUiListView_isBuilded;b.show=FUiListView_show;b.hide=FUiListView_hide;b.doSearch=FUiListView_doSearch;b.selectRow=FUiListView_selectRow;b.dispose=FUiListView_dispose;return b}function FUiListView_ohCloseClick(){this.hide()}function FUiListView_ohClearClick(){var b=this.fieldsPanel.components;if(b)for(var f=0;f<b.count;f++)b.value(f).clearSearch()}function FUiListView_ohResetClick(){}
function FUiListView_ohLoaded(){this.lovControl.onBuildData(this.document.root())}
function FUiListView_oeBuild(b){this.base.FContainer.oeBuild.call(this,b);b=RBuilder.appendTable(this.hPanel);b.width="100%";b.height="100%";var f=b.insertRow(),h=this.hTitlePanel=f.insertCell();h.className=this.style("TitlePanel");RBuilder.appendIcon(h,"tool.search");RBuilder.appendText(h,"&nbsp;List of View");h.colSpan=2;f=b.insertRow();h=this.hFieldsPanel=f.insertCell();h.className=this.style("FieldsPanel");h=this.hButtonPanel=f.insertCell();h.className=this.style("ButtonPanel");this.onBuildButton();
return EEventStatus.Stop}function FUiListView_onBuildPanel(){this.hPanel=RBuilder.append(null,"DIV");this.hPanel.style.zIndex=ELayer.Message}function FUiListView_onBuildFields(){}
function FUiListView_onBuildButton(){var b=RBuilder.appendTable(this.hButtonPanel,null,0,0,6),f=b.insertRow(),f=f.insertCell(),f=this.btnSelect=RClass.create(FButton);f.label="Select";f.width="100%";f.addClickListener(this,this.selectRow);f.build(b.insertRow().insertCell());f=this.btnClose=RClass.create(FButton);f.label="Close";f.width="100%";f.addClickListener(this,this.ohCloseClick);f.build(b.insertRow().insertCell());f=this.btnRefresh=RClass.create(FButton);f.label="Refresh";f.width="100%";f.addClickListener(this,
this.ohClearClick);f.build(b.insertRow().insertCell());f=b.insertRow();f=f.insertCell();f.innerHTML="&nbsp;"}function FUiListView_buildField(b){this.hFieldsTab.insertRow().insertCell().innerText=b.label;this.fieldsPanel=RControl.create(FPanel);this.fieldsPanel.build();this.fieldsPanel.setPanel(hCel)}
function FUiListView_linkLovControl(b){this.lovControl=b;this.lovRefer=b.lovRefer;var f=new TXmlDocument,h=f.root();h.set("action","dsPicker");RConsole.find("FEnvConsole").build(h);var q=h.create("Control");q.set("lov_refer",b.lovRefer);q.set("lov_where",b.lovWhere);q.set("lov_order",b.lovOrder);RLog.info(this,"Send lov request (service={1},node={2})",b.lovRefer,h.dump());h=new TEvent(this,EXmlEvent.Send);h.url=RService.url(b.lovService);h.document=f;h.lovControl=this;h.onLoad=this.ohLoaded;RConsole.find(FXmlConsole).process(h)}
function FUiListView_onBuildData(b){b=this.listView=RControl.fromNode(b,this.hFieldsPanel);b.hPanel.height="100%";b.resize();b.addDblClickListener(this,this.selectRow);b.addSelectListener(this,this.selectRow);b.addKeyDownListener(this,this.onKeyDown);this.show()}function FUiListView_onKeyDown(b,f){EKey.Esc==f.keyCode&&this.hide()}
function FUiListView_show(){this.isVisible()||(this.base.FContainer.show.call(this),RWindow.setEnable(!1),RWindow.moveCenter(this.hPanel),this.base.MShadow.show.call(this,!0),this.focus(),this.listView.focus())}function FUiListView_hide(){this.isVisible()&&(this.base.FContainer.hide.call(this),this.base.MShadow.hide.call(this),RWindow.setEnable(!0),this.lovControl.focus())}
function FUiListView_doSearch(){var b=this.fieldsPanel.components;if(b){for(var f=new TNode("Search"),h=0;h<b.count;h++)b.value(h).saveSearch(f);RLog.debug(this,"Search value {1}",f.dump())}this.hide()}
function FUiListView_selectRow(b,f){var h=this.lovControl.lovFields,q=this.lovControl.topControl(MDataset);if(q&&h&&(f||(f=this.listView.selectRow),f)){for(var h=RString.splitTwo(h,","),u=0;u<h.length;u++){var z=RString.splitTwo(h[u]," ");q.dsSet(RString.nvl(z[1],z[0]),f.get(z[0]))}q.loadValue(q.dsCurrent())}this.hide()}function FUiListView_isBuilded(){return null!=this.listView}
function FUiListView_dispose(){this.base.FContainer.dispose.call(this);RMemory.freeHtml(this.hEdit);RMemory.freeHtml(this.hButton);RMemory.freeHtml(this.hText);RMemory.freeHtml(this.userSrc);RMemory.freeHtml(this.femaleSrc);RMemory.freeHtml(this.errorSrc);RMemory.freeHtml(this.orgSrc);RMemory.freeHtml(this.dutySrc);RMemory.freeHtml(this.roleSrc);RMemory.freeHtml(this.userUk);this.userUk=this.roleSrc=this.dutySrc=this.orgSrc=this.errorSrc=this.femaleSrc=this.userSrc=this.hText=this.hButton=this.hEdit=
null}
function FUiNumber(b){b=RClass.inherits(this,b,FUiEditControl,MListenerDataChanged);b._inputSize=RClass.register(b,new APtySize2("_inputSize"));b._styleValuePanel=RClass.register(b,new AStyle("_styleValuePanel"));b._styleInput=RClass.register(b,new AStyle("_styleInput"));b._styleAdjustForm=RClass.register(b,new AStyle("_styleAdjustForm"));b._styleUpPanel=RClass.register(b,new AStyle("_styleUpPanel"));b._styleDownPanel=RClass.register(b,new AStyle("_styleDownPanel"));b._innerOriginValue=null;b._innerDataValue=
null;b._hInput=null;b._iconUp=null;b._iconDown=null;b.onBuildEditValue=FUiNumber_onBuildEditValue;b.onInputKeyPress=RClass.register(b,new AEventKeyPress("onInputKeyPress"),FUiNumber_onInputKeyPress);b.onInputChanged=RClass.register(b,new AEventInputChanged("onInputChanged"),FUiNumber_onInputChanged);b.construct=FUiNumber_construct;b.get=FUiNumber_get;b.set=FUiNumber_set;return b}
function FUiNumber_onBuildEditValue(b){var f=this._hValuePanel;f.className=this.styleName("ValuePanel");f=this._hValueForm=RBuilder.appendTable(f);f.width="100%";f=this._hValueLine=RBuilder.appendTableRow(f);this._hChangePanel=RBuilder.appendTableCell(f);this.onBuildEditChange(b);b=this._hInputPanel=RBuilder.appendTableCell(f);b=this._hInput=RBuilder.appendEdit(b,this.styleName("Input"));this.attachEvent("onInputKeyPress",b,this.onInputKeyPress);this.attachEvent("onInputChanged",b,this.onInputChanged);
this._editLength&&(b.maxLength=this._editLength);b=this._hAdjustPanel=RBuilder.appendTableCell(f);b.style.borderLeft="1px solid #666666";b.width=12;b=this.hAdjustForm=RBuilder.appendTable(b,this.styleName("AdjustForm"));f=RBuilder.appendTableRowCell(b);f.className=this.styleName("UpPanel");(this._hUpIcon=RBuilder.appendIcon(f,null,"control.number.up")).align="center";f=RBuilder.appendTableRowCell(b);f.className=this.styleName("DownPanel");this._hDownIcon=RBuilder.appendIcon(f,null,"control.number.down")}
function FUiNumber_onInputKeyPress(b){RKeyboard.isFloatKey(b.keyCode)||b.cancel()}function FUiNumber_onInputChanged(b){this.processDataChangedListener(this)}function FUiNumber_construct(){this.__base.FUiEditControl.construct.call(this);this._inputSize=new SSize2(120,0)}function FUiNumber_get(b){b=this.__base.FUiEditControl.get.call(this,b);var f=this._hInput;f&&(b=f.value);return b}
function FUiNumber_set(b){this.__base.FUiEditControl.set.call(this,b);var f=RString.nvl(b,"0");this._innerDataValue=this._innerOriginValue=f;this._dataDisplay=RFloat.format(b,0,null,3,null);if(b=this._hInput)b.value=this._dataDisplay;this.changeSet(!1)}function FUiNumber_onDataKeyDown(b,f){this.__base.FUiEditControl.onDataKeyDown.call(this,b,f);this.editCase&&RKey.fixCase(f,this.editCase)}
function FUiNumber_formatValue(b){b=RString.nvl(b);ECase.Upper==this.editCase?b=RString.toUpper(b):ECase.Lower==this.editCase&&(b=RString.toLower(b));return b}function FUiNumber_setText(b){this.hEdit&&(this.hEdit.value="U"==this.editCase?RString.toUpper(b):"L"==this.editCase?RString.toLower(b):b,this.hEdit.style.textAlign="right"==this.editAlign?"right":"left"==this.editAlign?"left":"center")}
function FUiNumber_validText(b){var f=this.__base.FUiEditControl.validText.call(this,b);if(!f){if(this.validLenmin&&this.validLenmin>b.length)return RContext.get("MDescEdit:ValidMinLength",this.validLenmin);if(this.validLenmax&&this.validLenmax<b.length)return RContext.get("MDescEdit:ValidMaxLength",this.validLenmax)}return f}
function FUiNumber_findEditor(){if(this.editComplete){var b=this.editor;!b&&(this.dsControl=this.topControl(MDataset))&&(b=this.editor=RConsole.find(FUiNumberConsole).focus(this,FUiNumberEditor));b&&b.linkControl(this);return this.editor}}function FUiNumber_drop(){var b=this.findEditor();if(b){var f=this.reget();0<f.length&&(this.finded!=f&&(b.source!=this&&b.linkControl(this),b.search(f)),this.finded=f)}}
function FUiNumber_clone(){var b=this._class.newInstance();GHtml_clone(b,this.hPanel);return b}function FUiNumber_link(){}
function FUiNumber2(b){b=RClass.inherits(this,b,FEditControl);b._inputSize=RClass.register(b,new APtySize2("_inputSize"));b._styleInputPanel=RClass.register(b,new AStyle("_styleInputPanel"));b._styleInput=RClass.register(b,new AStyle("_styleInput"));b._hInput=null;b.onBuildEditValue=FUiNumber2_onBuildEditValue;b.construct=FUiNumber2_construct;b.get=FUiNumber2_get;b.set=FUiNumber2_set;return b}function FUiNumber2_oeDataLoad(b){alert(b);return EEventStatus.Stop}
function FUiNumber2_oeDataSave(b){return EEventStatus.Stop}function FUiNumber2_onBuildEditValue(b){b=this._hValuePanel;b.className=this.styleName("InputPanel");b=this._hInputForm=RBuilder.appendTable(b);b=RBuilder.appendTableRow(b);var f=RBuilder.appendTableCell(b);f.style.borderRight="1px solid #666666";this._hInput1=RBuilder.appendEdit(f,this.styleName("Input"));b=RBuilder.appendTableCell(b);b.style.borderLeft="1px solid #999999";this._hInput2=RBuilder.appendEdit(b,this.styleName("Input"))}
function FUiNumber2_construct(){this.__base.FEditControl.construct.call(this);this._inputSize=new SSize2(120,0)}function FUiNumber2_get(b){b=this.__base.FEditControl.get.call(this,b);var f=this._hInput;f&&(b=f.value);return b}function FUiNumber2_set(b){this.__base.FEditControl.set.call(this,b);var f=this._hInput;f&&(f.value=RString.nvl(b))}function FUiNumber2_onDataKeyDown(b,f){this.__base.FEditControl.onDataKeyDown.call(this,b,f);this.editCase&&RKey.fixCase(f,this.editCase)}
function FUiNumber2_formatValue(b){b=RString.nvl(b);ECase.Upper==this.editCase?b=RString.toUpper(b):ECase.Lower==this.editCase&&(b=RString.toLower(b));return b}function FUiNumber2_setText(b){this.hEdit&&(this.hEdit.value="U"==this.editCase?RString.toUpper(b):"L"==this.editCase?RString.toLower(b):b,this.hEdit.style.textAlign="right"==this.editAlign?"right":"left"==this.editAlign?"left":"center")}
function FUiNumber2_validText(b){var f=this.__base.FEditControl.validText.call(this,b);if(!f){if(this.validLenmin&&this.validLenmin>b.length)return RContext.get("MDescEdit:ValidMinLength",this.validLenmin);if(this.validLenmax&&this.validLenmax<b.length)return RContext.get("MDescEdit:ValidMaxLength",this.validLenmax)}return f}
function FUiNumber2_findEditor(){if(this.editComplete){var b=this.editor;!b&&(this.dsControl=this.topControl(MDataset))&&(b=this.editor=RConsole.find(FUiNumber2Console).focus(this,FUiNumber2Editor));b&&b.linkControl(this);return this.editor}}function FUiNumber2_drop(){var b=this.findEditor();if(b){var f=this.reget();0<f.length&&(this.finded!=f&&(b.source!=this&&b.linkControl(this),b.search(f)),this.finded=f)}}
function FUiNumber2_clone(){var b=this._class.newInstance();GHtml_clone(b,this.hPanel);return b}function FUiNumber2_link(){}
function FUiNumber3(b){b=RClass.inherits(this,b,FUiEditControl,MListenerDataChanged);b._inputSize=RClass.register(b,new APtySize2("_inputSize"));b._styleValuePanel=RClass.register(b,new AStyle("_styleValuePanel"));b._styleInputPanel=RClass.register(b,new AStyle("_styleInputPanel"));b._styleInput=RClass.register(b,new AStyle("_styleInput"));b._innerOriginValue=null;b._innerDataValue=null;b._hInput=null;b.onBuildEditInput=FUiNumber3_onBuildEditInput;b.onBuildEditValue=FUiNumber3_onBuildEditValue;b.onInputKeyPress=
RClass.register(b,new AEventKeyPress("onInputKeyPress"),FUiNumber3_onInputKeyPress);b.onInputChanged=RClass.register(b,new AEventInputChanged("onInputChanged"),FUiNumber3_onInputChanged);b.construct=FUiNumber3_construct;b.get=FUiNumber3_get;b.set=FUiNumber3_set;return b}function FUiNumber3_onBuildEditInput(b,f){this.attachEvent("onInputKeyPress",f,this.onInputKeyPress);this.attachEvent("onInputChanged",f,this.onInputChanged)}
function FUiNumber3_onBuildEditValue(b){var f=this._hValuePanel;f.className=this.styleName("ValuePanel");f=this._hValueForm=RBuilder.appendTable(f);f=RBuilder.appendTableRow(f);this._hChangePanel=RBuilder.appendTableCell(f);this.onBuildEditChange(b);var h=RBuilder.appendTableCell(f,this.styleName("InputPanel"));h.style.borderRight="1px solid #666666";h=this._hInput1=RBuilder.appendEdit(h,this.styleName("Input"));this.onBuildEditInput(b,h);h=RBuilder.appendTableCell(f,this.styleName("InputPanel"));
h.style.borderLeft="1px solid #999999";h.style.borderRight="1px solid #666666";h=this._hInput2=RBuilder.appendEdit(h,this.styleName("Input"));this.onBuildEditInput(b,h);h=RBuilder.appendTableCell(f,this.styleName("InputPanel"));h.style.borderLeft="1px solid #999999";h=this._hInput3=RBuilder.appendEdit(h,this.styleName("Input"));this.onBuildEditInput(b,h)}function FUiNumber3_onInputKeyPress(b){EKeyCode.floatCodes[b.keyCode]||b.cancel()}
function FUiNumber3_onInputChanged(b){this.processDataChangedListener(this)}function FUiNumber3_construct(){this.__base.FUiEditControl.construct.call(this);this._inputSize=new SSize2(120,0);this._innerOriginValue=new SPoint3;this._innerDataValue=new SPoint3}
function FUiNumber3_get(b){this.__base.FUiEditControl.get.call(this,b);b=this._innerDataValue;var f=this._hInput1;f&&(b.x=RFloat.parse(f.value));if(f=this._hInput2)b.y=RFloat.parse(f.value);if(f=this._hInput3)b.z=RFloat.parse(f.value);return b}
function FUiNumber3_set(b){this.__base.FUiEditControl.set.call(this,b);var f=arguments,h=this._innerOriginValue,q=this._innerDataValue;if(1==f.length)if(b.constructor==SPoint3||b.constructor==SVector3)h.assign(b),q.assign(b);else throw new TError("Invalid value format.");else if(3==f.length)h.set(f[0],f[1],f[2]),q.assign(h);else throw new TError("Invalid value format.");if(f=this._hInput1)f.value=RFloat.format(q.x,0,null,3,null);if(f=this._hInput2)f.value=RFloat.format(q.y,0,null,3,null);if(f=this._hInput3)f.value=
RFloat.format(q.z,0,null,3,null);this.changeSet(!1)}function FUiNumber3_onDataKeyDown(b,f){this.__base.FUiEditControl.onDataKeyDown.call(this,b,f);this.editCase&&RKey.fixCase(f,this.editCase)}function FUiNumber3_formatValue(b){b=RString.nvl(b);ECase.Upper==this.editCase?b=RString.toUpper(b):ECase.Lower==this.editCase&&(b=RString.toLower(b));return b}
function FUiNumber3_setText(b){this.hEdit&&(this.hEdit.value="U"==this.editCase?RString.toUpper(b):"L"==this.editCase?RString.toLower(b):b,this.hEdit.style.textAlign="right"==this.editAlign?"right":"left"==this.editAlign?"left":"center")}
function FUiNumber3_validText(b){var f=this.__base.FUiEditControl.validText.call(this,b);if(!f){if(this.validLenmin&&this.validLenmin>b.length)return RContext.get("MDescEdit:ValidMinLength",this.validLenmin);if(this.validLenmax&&this.validLenmax<b.length)return RContext.get("MDescEdit:ValidMaxLength",this.validLenmax)}return f}
function FUiNumber3_findEditor(){if(this.editComplete){var b=this.editor;!b&&(this.dsControl=this.topControl(MDataset))&&(b=this.editor=RConsole.find(FUiNumber3Console).focus(this,FUiNumber3Editor));b&&b.linkControl(this);return this.editor}}function FUiNumber3_drop(){var b=this.findEditor();if(b){var f=this.reget();0<f.length&&(this.finded!=f&&(b.source!=this&&b.linkControl(this),b.search(f)),this.finded=f)}}
function FUiNumber3_clone(){var b=this._class.newInstance();GHtml_clone(b,this.hPanel);return b}function FUiNumber3_link(){}
function FUiNumber4(b){b=RClass.inherits(this,b,FEditControl);b._inputSize=RClass.register(b,new APtySize2("_inputSize"));b._styleInputPanel=RClass.register(b,new AStyle("_styleInputPanel"));b._styleInput=RClass.register(b,new AStyle("_styleInput"));b._hInput=null;b.onBuildEditValue=FUiNumber4_onBuildEditValue;b.construct=FUiNumber4_construct;b.get=FUiNumber4_get;b.set=FUiNumber4_set;return b}function FUiNumber4_oeDataLoad(b){alert(b);return EEventStatus.Stop}
function FUiNumber4_oeDataSave(b){return EEventStatus.Stop}
function FUiNumber4_onBuildEditValue(b){b=this._hValuePanel;b.className=this.styleName("InputPanel");b=this._hInputForm=RBuilder.appendTable(b);b=RBuilder.appendTableRow(b);var f=RBuilder.appendTableCell(b);f.style.borderRight="1px solid #666666";this._hInput1=RBuilder.appendEdit(f,this.styleName("Input"));f=RBuilder.appendTableCell(b);f.style.borderRight="1px solid #666666";f.style.borderLeft="1px solid #999999";this._hInput2=RBuilder.appendEdit(f,this.styleName("Input"));f=RBuilder.appendTableCell(b);
f.style.borderLeft="1px solid #999999";f.style.borderRight="1px solid #666666";this._hInput3=RBuilder.appendEdit(f,this.styleName("Input"));b=RBuilder.appendTableCell(b);b.style.borderLeft="1px solid #999999";this._hInput4=RBuilder.appendEdit(b,this.styleName("Input"))}function FUiNumber4_construct(){this.__base.FEditControl.construct.call(this);this._inputSize=new SSize2(120,0)}function FUiNumber4_get(b){b=this.__base.FEditControl.get.call(this,b);var f=this._hInput;f&&(b=f.value);return b}
function FUiNumber4_set(b){this.__base.FEditControl.set.call(this,b);var f=this._hInput;f&&(f.value=RString.nvl(b))}function FUiNumber4_onDataKeyDown(b,f){this.__base.FEditControl.onDataKeyDown.call(this,b,f);this.editCase&&RKey.fixCase(f,this.editCase)}function FUiNumber4_formatValue(b){b=RString.nvl(b);ECase.Upper==this.editCase?b=RString.toUpper(b):ECase.Lower==this.editCase&&(b=RString.toLower(b));return b}
function FUiNumber4_setText(b){this.hEdit&&(this.hEdit.value="U"==this.editCase?RString.toUpper(b):"L"==this.editCase?RString.toLower(b):b,this.hEdit.style.textAlign="right"==this.editAlign?"right":"left"==this.editAlign?"left":"center")}
function FUiNumber4_validText(b){var f=this.__base.FEditControl.validText.call(this,b);if(!f){if(this.validLenmin&&this.validLenmin>b.length)return RContext.get("MDescEdit:ValidMinLength",this.validLenmin);if(this.validLenmax&&this.validLenmax<b.length)return RContext.get("MDescEdit:ValidMaxLength",this.validLenmax)}return f}
function FUiNumber4_findEditor(){if(this.editComplete){var b=this.editor;!b&&(this.dsControl=this.topControl(MDataset))&&(b=this.editor=RConsole.find(FUiNumber4Console).focus(this,FUiNumber4Editor));b&&b.linkControl(this);return this.editor}}function FUiNumber4_drop(){var b=this.findEditor();if(b){var f=this.reget();0<f.length&&(this.finded!=f&&(b.source!=this&&b.linkControl(this),b.search(f)),this.finded=f)}}
function FUiNumber4_clone(){var b=this._class.newInstance();GHtml_clone(b,this.hPanel);return b}function FUiNumber4_link(){}
function FUiPageControl(b){b=RClass.inherits(this,b,FUiContainer);b._sizeCd=EUiSize.Horizontal;b._stylePanel=RClass.register(b,new AStyle("_stylePanel"));b._styleTitlePanel=RClass.register(b,new AStyle("_styleTitlePanel"));b._styleTitleForm=RClass.register(b,new AStyle("_styleTitleForm"));b._styleDataPanel=RClass.register(b,new AStyle("_styleDataPanel"));b._styleDataForm=RClass.register(b,new AStyle("_styleDataForm"));b._styleTop=RClass.register(b,new AStyle("_styleTop"));b._styleBottom=RClass.register(b,
new AStyle("_styleBottom"));b._styleForm=RClass.register(b,new AStyle("_styleForm"));b._sheets=null;b._activeSheet=null;b._esize=EUiSize.Both;b._hTop=null;b._hLine=null;b._hBottom=null;b._hSheets=null;b.onBuildPanel=FUiPageControl_onBuildPanel;b.onBuild=FUiPageControl_onBuild;b.oeRefresh=FUiPageControl_oeRefresh;b.construct=FUiPageControl_construct;b.appendChild=FUiPageControl_appendChild;b.select=FUiPageControl_select;b.selectByIndex=FUiPageControl_selectByIndex;b.sheet=FUiPageControl_sheet;b.push=
FUiPageControl_push;b.dispose=FUiPageControl_dispose;return b}function FUiPageControl_onBuildPanel(b){(this._hPanel=RBuilder.createTable(b,this.styleName("Panel"))).width="100%"}
function FUiPageControl_onBuild(b){this.__base.FUiContainer.onBuild.call(this,b);b=this._hPanel;var f=RBuilder.appendTableRowCell(b,this.styleName("TitlePanel")),f=this.hTitleForm=RBuilder.appendTable(f,this.styleName("TitleForm"));f.width="100%";var h=this._hTop=RBuilder.appendTableRow(f);h.height=1;this._hLine=RBuilder.appendTableRow(f);h=this._hBottom=RBuilder.appendTableRow(f);h.height=1;f=this._hFirstTop=RBuilder.appendTableCell(this._hTop);f.width=20;this._hFirst=RBuilder.appendTableCell(this._hLine);
(this._hFirstBottom=RBuilder.appendTableCell(this._hBottom)).className=this.styleName("Bottom",FUiPageSheet);f=RBuilder.appendTableRowCell(b);f.height=4;this._hLastTop=RBuilder.appendTableCell(this._hTop);this._hLast=RBuilder.appendTableCell(this._hLine);f=this._hLastBottom=RBuilder.appendTableCell(this._hBottom);f.className=this.styleName("Bottom",FUiPageSheet)}
function FUiPageControl_oeRefresh(b){var f=this.__base.FUiContainer.oeRefresh.call(this,b);b.isBefore()&&this._sheets.count()&&(this._activeSheet?this._activeSheet.oeRefresh(e):(b=this._activeSheet=this._sheets.value(0))&&b.innerSelect(!0));return f}function FUiPageControl_construct(){this.__base.FUiContainer.construct.call(this);this._sheets=new TDictionary}
function FUiPageControl_appendChild(b){if(RClass.isClass(b,FUiPageSheet)){var f=this._hLast.cellIndex,h=b._hTopL=RBuilder.appendTableCell(this._hTop,null,f);h.width=1;h.className=b.styleName("Top");h=b._hTop=RBuilder.appendTableCell(this._hTop,null,f+1);h.className=b.styleName("Top");h=b._hTopR=RBuilder.appendTableCell(this._hTop,null,f+2);h.width=1;h.className=b.styleName("Top");h=b._hLeft=RBuilder.appendTableCell(this._hLine,null,f);h.width=1;h.className=b.styleName("Left");h=b._hButtonPanel=RBuilder.appendTableCell(this._hLine,
null,f+1);b.attachEvent("onButtonEnter",h);b.attachEvent("onButtonLeave",h);b.attachEvent("onHeadMouseDown",h);h.width=1;h=b._hButton=RBuilder.append(h,"DIV",b.styleName("Button"));b.icon&&(b._hIcon=RBuilder.appendIcon(h,null,b.icon));b.label&&(b._hText=RBuilder.appendSpan(h,b.styleName("ButtonText")),b._hText.innerText=" "+b.label());h=b._hRight=RBuilder.appendTableCell(this._hLine,null,f+2);h.width=1;h.className=b.styleName("Right");h=b._hBottomL=RBuilder.appendTableCell(this._hBottom,null,f);h.width=
1;h.className=b.styleName("Bottom");h=b._hBottom=RBuilder.appendTableCell(this._hBottom,null,f+1);h.className=b.styleName("Bottom");h=b._hBottomR=RBuilder.appendTableCell(this._hBottom,null,f+2);h.width=1;h.className=b.styleName("Bottom");f=RBuilder.appendTableRow(this._hPanel);b.index&&(f.style.display="none");h=RBuilder.appendTableCell(f);b._hForm=f;h.style.verticalAlign="top";h.appendChild(b._hPanel);this.selectByIndex(0)}}function FUiPageControl_sheet(b){return this._sheets.get(b)}
function FUiPageControl_select(b){var f=this._sheets.count();this._activeSheet=b;for(var h=0;h<f;h++){var q=this._sheets.value(h);q!=b&&q.select(!1)}b.select(!0)}function FUiPageControl_selectByIndex(b){(b=this._sheets.value(b))&&this.select(b)}function FUiPageControl_push(b){if(RClass.isClass(b,FUiPageSheet)){var f=this._sheets;b._pageControl=this;b._index=f.count();f.set(b.name(),b)}this.__base.FUiContainer.push.call(this,b)}
function FUiPageControl_dispose(){this.__base.FUiContainer.dispose.call(this)}
function FUiPageSheet(b){b=RClass.inherits(this,b,FUiPanel);b._icon=RClass.register(b,new APtyString("_icon"));b._formName=RClass.register(b,new APtyString("_formName"));b._formLink=RClass.register(b,new APtyString("_formLink"));b._formWhere=RClass.register(b,new APtyString("_formWhere"));b._formOrder=RClass.register(b,new APtyString("_formOrder"));b._styleTop=RClass.register(b,new AStyle("_styleTop"));b._styleTopSelect=RClass.register(b,new AStyle("_styleTopSelect"));b._styleLeft=RClass.register(b,
new AStyle("_styleLeft"));b._styleLeftSelect=RClass.register(b,new AStyle("_styleLeftSelect"));b._styleRight=RClass.register(b,new AStyle("_styleRight"));b._styleRightSelect=RClass.register(b,new AStyle("_styleRightSelect"));b._styleRightPrior=RClass.register(b,new AStyle("_styleRightPrior"));b._styleButtom=RClass.register(b,new AStyle("_styleBottom"));b._styleBottomSelect=RClass.register(b,new AStyle("_styleBottomSelect"));b._styleButtonText=RClass.register(b,new AStyle("_styleButtonText"));b._styleButton=
RClass.register(b,new AStyle("_styleButton"));b._styleButtonHover=RClass.register(b,new AStyle("_styleButtonHover"));b._styleButtonSelect=RClass.register(b,new AStyle("_styleButtonSelect"));b._styleDataPanel=RClass.register(b,new AStyle("_styleDataPanel"));b._top=0;b._pages=null;b._index=null;b._selected=!1;b._hasBuilded=!1;b.lsnsSelect=null;b._hTopL=null;b._hTop=null;b._hTopR=null;b._hLeft=null;b._hButton=null;b._hIcon=null;b._hText=null;b._hBottomL=null;b._hBottom=null;b._hBottomR=null;b._hRight=
null;b.onBuildPanel=FUiPageSheet_onBuildPanel;b.onButtonEnter=RClass.register(b,new AEventMouseEnter("onButtonEnter"),FUiPageSheet_onButtonEnter);b.onButtonLeave=RClass.register(b,new AEventMouseLeave("onButtonLeave"),FUiPageSheet_onButtonLeave);b.onHeadMouseDown=RClass.register(b,new AEventMouseDown("onHeadMouseDown"),FUiPageSheet_onHeadMouseDown);b.construct=FUiPageSheet_construct;b.innerSelect=FUiPageSheet_innerSelect;b.select=FUiPageSheet_select;b.setVisible=FUiPageSheet_setVisible;b.dispose=
FUiPageSheet_dispose;b.innerDump=FUiPageSheet_innerDump;return b}function FUiPageSheet_onBuildPanel(b){b=this._hContainer=this._hPanel=RBuilder.createDiv(b);b.width="100%";b.height="100%";b=this._hPanelForm=RBuilder.appendTable(b);b.width="100%";b.height="100%"}function FUiPageSheet_onButtonEnter(b){this._selected||(this._hButton.className=this.styleName("ButtonHover"))}function FUiPageSheet_onButtonLeave(b){this._selected||(this._hButton.className=this.styleName("Button"))}
function FUiPageSheet_onHeadMouseDown(b){this._parent.select(this)}function FUiPageSheet_construct(){this.__base.FUiPanel.construct.call(this);this.lsnsSelect=new TListeners}
function FUiPageSheet_innerSelect(b){var f=this._parent;b&&!this._hasBuilded&&(this._hasBuilded=!0);var h=0==this._index,f=f._activeSheet._index-1==this._index;this._selected!=b&&(b&&this.lsnsSelect.process(),this._selected=b);this._hButton.className=b?this.styleName("ButtonSelect"):this.styleName("Button");this._hTop.className=b?this.styleName("TopSelect"):this.styleName("Top");this._hLeft.className=b?this.styleName("LeftSelect"):h?this.styleName("Right"):this.styleName("Left");this._hBottomL.className=
b?this.styleName("BottomSelect"):this.styleName("Bottom");this._hBottom.className=b?this.styleName("BottomSelect"):this.styleName("Bottom");this._hBottomR.className=b?this.styleName("BottomSelect"):this.styleName("Bottom");this._hRight.className=b?this.styleName("RightSelect"):f?this.styleName("RightPrior"):this.styleName("Right");this._hForm.style.display=b?"block":"none"}function FUiPageSheet_select(b){this.innerSelect(b);b&&(this.psRefresh(),this.psResize())}
function FUiPageSheet_setVisible(b){RHtml.displaySet(this._hPanel,b)}function FUiPageSheet_dispose(){RMemory.free(this._hButton);this._hButton=null;RMemory.free(this._hTop);this._hTop=null;RMemory.free(this._hLeft);this._hLeft=null;RMemory.free(this._hBottomL);this._hBottomL=null;RMemory.free(this._hBottom);this._hBottom=null;RMemory.free(this._hBottomR);this._hBottomR=null;RMemory.free(this._hRight);this._hRight=null;this.__base.FUiPanel.dispose.call(this)}
function FUiPageSheet_innerDump(b,f){b.append(f,RClass.dump(this)," [");b.append("name=",this._name,", ");b.append("icon=",this._icon,", ");b.append("label=",this.label,", ");b.append("action=",this.action,"]")}
function FUiPanel(b){b=RClass.inherits(this,b,FUiLayout,MDesign,MUiFocus);b._sizeCd=EUiSize.Horizontal;b._stylePanel=RClass.register(b,new AStyle("_stylePanel","Panel"));b._styleLabel=RClass.register(b,new AStyle("_styleLabel","Label"));b._styleBody=RClass.register(b,new AStyle("_styleBody","Body"));b._hImage=null;b._imagePlus="control.panel.plus";b._imageMinus="control.panel.minus";b._statusBody=!0;b.onBuildPanel=FUiPanel_onBuildPanel;b.onTitleClick=RClass.register(b,new AEventClick("onTitleClick"),
FUiPanel_onTitleClick);return b}
function FUiPanel_onBuildPanel(b){b=this._hPanel=RBuilder.createDiv(b,this.styleName("Panel"));var f=RBuilder.appendTable(b,this.styleName("Label"));this.attachEvent("onTitleClick",f);f.width="100%";f=RBuilder.appendTableRow(f);f.vAlign="middle";var h=RBuilder.appendTableCell(f);h.width=20;this._hImage=RBuilder.appendIcon(h,null,this._imageMinus);RBuilder.appendTableCell(f).innerHTML=this._label;b=this._hBody=RBuilder.appendDiv(b,this.styleName("Body"));this._hPanelForm=RBuilder.appendTable(b,this.styleName("Form"))}
function FUiPanel_onTitleClick(b){this._statusBody=b=!this._statusBody;this._hImage.src=RResource.iconPath(b?this._imageMinus:this._imagePlus);RHtml.displaySet(this._hBody,b)}function FUiRadio(b){b=RClass.inherits(this,b,FEditControl);b._groupName=RClass.register(b,new APtyString("_groupName"));b._styleInput=RClass.register(b,new AStyle("_styleInput","Input"));b._hInput=null;b.onBuildEditValue=FUiRadio_onBuildEditValue;return b}
function FUiRadio_onBuildEditValue(b){this._hInput=RBuilder.appendRadio(this._hValuePanel,this.styleName("Input"))}function FUiRadio_clearValue(){this.hEdit.checked=!1}function FUiRadio_resetValue(){this.hEdit.checked=this._editChecked}function FUiRadio_saveValue(b){this.hEdit.checked&&b.set(this.dataName,this.dataDefault)}function FUiRadio_text(){return this.hEdit.checked?this.dataDefault:""}function FUiRadio_setText(b){this.hEdit.checked=this.dataDefault==b}
function FUiRadio_refreshStyle(){var b=this.panel(EPanel.Edit);b.disabled=!this._editable;b.style.cursor=this._editable?"hand":"normal"}
function FUiSelect(b){b=RClass.inherits(this,b,FUiEditControl,MUiContainer,MPropertySelect,MDropable,MListenerDataChanged);b._styleValuePanel=RClass.register(b,new AStyle("_styleValuePanel"));b._styleInput=RClass.register(b,new AStyle("_styleInput"));b._hValueForm=null;b._hValueLine=null;b._hInputPanel=null;b._hInput=null;b.onBuildEditValue=FUiSelect_onBuildEditValue;b.onDoubleClick=RClass.register(b,new AEventDoubleClick("onDoubleClick"),FUiSelect_onDropClick);b.onDropClick=FUiSelect_onDropClick;
b.onKeyDown=RClass.register(b,new AEventKeyDown("onKeyDown"),FUiSelect_onKeyDown);b.construct=FUiSelect_construct;b.findItemByLabel=FUiSelect_findItemByLabel;b.findItemByData=FUiSelect_findItemByData;b.formatValue=FUiSelect_formatValue;b.formatDisplay=FUiSelect_formatDisplay;b.get=FUiSelect_get;b.set=FUiSelect_set;b.selectItem=FUiSelect_selectItem;b.refreshValue=FUiSelect_refreshValue;b.drop=FUiSelect_drop;b.dispose=FUiSelect_dispose;return b}
function FUiSelect_onBuildEditValue(b){var f=this._hValuePanel;f.className=this.styleName("ValuePanel");f=this._hValueForm=RBuilder.appendTable(f);f.width="100%";f=this._hValueLine=RBuilder.appendTableRow(f);this._hChangePanel=RBuilder.appendTableCell(f);this.onBuildEditChange(b);var h=this._hInputPanel=RBuilder.appendTableCell(f),h=this._hInput=RBuilder.appendEdit(h,this.styleName("Input"));this.attachEvent("onDoubleClick",h);this.attachEvent("onKeyDown",h);this._editLength&&(h.maxLength=this._editLength);
(this._hDropPanel=RBuilder.appendTableCell(f)).style.borderLeft="1px solid #666666";this.onBuildEditDrop(b);f=this._emptyItem=RClass.create(FUiSelectItem);f.build(b);this.push(f)}function FUiSelect_onDropClick(b){this.drop()}function FUiSelect_onKeyDown(b){var f=this._editor;if(f&&f._statusEditing&&f._source==this)f.onEditKeyDown(b);else b.keyCode==EKeyCode.Down&&this.drop()}function FUiSelect_construct(){this.__base.FUiEditControl.construct.call(this)}
function FUiSelect_findItemByLabel(b){var f=this._components;if(f)for(var h=f.count()-1;0<=h;h--){var q=f.valueAt(h);if(RString.equals(q._label,b,!0))return q}return null}function FUiSelect_findItemByData(b){var f=this._components;if(f)for(var h=f.count()-1;0<=h;h--){var q=f.valueAt(h);if(RString.equals(q._dataValue,b,!0))return q}return null}function FUiSelect_formatValue(b){var f=this.findItemByLabel(b);return f?RString.nvl(f._dataValue):b}
function FUiSelect_formatDisplay(b){var f=this.findItemByData(b);return f?RString.nvl(f._label):b}function FUiSelect_get(){return this.formatValue(this._hInput.value)}function FUiSelect_set(b){b=this.formatDisplay(b);this._hInput.value=RString.nvl(b)}function FUiSelect_selectItem(b){this._hInput.value=RString.nvl(b.label());this.refreshValue()}function FUiSelect_refreshValue(){this.processDataChangedListener(this)}
function FUiSelect_drop(){if(this.hasComponent()){var b=this._editor=RConsole.find(FEditorConsole).focus(this,FUiSelectEditor,this._name);b.buildItems(this);b.set(this.get());b.show()}}function FUiSelect_dispose(){this.__base.FUiEditControl.dispose.call(this)}function FUiSelect_onEditEnd(b){b&&(this.set(b.get()),this._invalidText=this.validText(this.text()),this.refreshStyle());this.onDataEditEnd(this)}
function FUiSelect_loadConfig(b){this.__base.FUiEditControl.loadConfig.call(this,b);this.dataEmpty&&this.items.create();this.editCheck||this.items.create("","");this.items.loadConfig(b);if(b=b.nodes)for(var f=b.count,h=0;h<f;h++){var q=b.get(h);if(q.isName("Event")){var u=RClass.create(FEvent);u.loadConfig(q);this.push(u)}}return EStatus.Stop}function FUiSelect_refreshStyle(){this.__base.FUiEditControl.refreshStyle.call(this);this.editCheck||(this.hEdit.readOnly="true")}
function FUiSelect_doBlur(){this.__base.FUiEditControl.doBlur.call(this);this._editor&&this._editor.hide()}
function FUiSelectEditor(b){b=RClass.inherits(this,b,FUiDropEditor,MListenerItemClick);b._items=null;b._position=null;b._hDropLayout=null;b._hItemsForm=null;b.onBuildDrop=FUiSelectEditor_onBuildDrop;b.onItemClick=FUiSelectEditor_onItemClick;b.onEditKeyDown=FUiSelectEditor_onEditKeyDown;b.onEditEnd=FUiSelectEditor_onEditEnd;b.construct=FUiSelectEditor_construct;b.testBlur=FUiSelectEditor_testBlur;b.buildItems=FUiSelectEditor_buildItems;b.clearItems=FUiSelectEditor_clearItems;b.get=FUiSelectEditor_get;
b.set=FUiSelectEditor_set;b.select=FUiSelectEditor_select;b.fetch=FUiSelectEditor_fetch;b.setVisible=FUiSelectEditor_setVisible;b.dispose=FUiSelectEditor_dispose;return b}function FUiSelectEditor_onBuildDrop(){var b=this._hDropLayout=RBuilder.appendDiv(this._hDropPanel),b=this._hItemsForm=RBuilder.appendTable(b);this._hItemsBody=RBuilder.append(b,"TBODY")}function FUiSelectEditor_onItemClick(b){this._position=this._items.indexOfValue(b);this.editEnd()}
function FUiSelectEditor_onEditKeyDown(b){switch(b.keyCode){case EKeyCode.Up:this.select(this._position-1);break;case EKeyCode.Down:this.select(this._position+1);break;case EKeyCode.Enter:this.editEnd();break;case EKeyCode.Esc:this.editCancel()}}function FUiSelectEditor_onEditEnd(){var b=this._source,f=this._items.value(this._position);b.selectItem(f);this.__base.FUiDropEditor.onEditEnd.call(this)}function FUiSelectEditor_construct(){this.__base.FUiDropEditor.construct.call(this)}
function FUiSelectEditor_testBlur(b){return this._source==b?!1:!this._items.contains(b)}function FUiSelectEditor_clearItems(){var b=this._hItemsBody,f=this._items;if(f)for(var h=f.count()-1;0<=h;h--){var q=f.value(h);q.removeClickListener(this,this.onItemClick);b.removeChild(q._hPanel)}this._position=0}
function FUiSelectEditor_buildItems(b){var f=this._hItemsBody;b=b.components();if(b!=this._items){this.clearItems();for(var h=b.count(),q=0;q<h;q++){var u=b.value(q);u.addClickListener(this,this.onItemClick);u.setPanel(f)}this._position=0;this._items=b}}function FUiSelectEditor_get(){return this._items.get(this._position).value}
function FUiSelectEditor_set(b){this._position=-1;for(var f=this._items,h=f.count(),q=0;q<h;q++){var u=f.value(q);RString.equals(u._dataValue,b,!0)?(this._position=q,u.setChecked(!0)):u.setChecked(!1)}}function FUiSelectEditor_select(b){var f=this._items,h=f.count();b=RInteger.toRange(b,0,h-1);for(var q=0;q<h;q++)f.value(q).setChecked(q==b);this._position=b}
function FUiSelectEditor_fetch(){if(!this.hasFetched){var b=new TCodeListServiceArg,f=this._source.topControl(MDataset);b.values=f.getCurrentRows();b.name=this._source.editRefer;if(b=RConsole.find(FCodeListConsole).fetch(b))f=this._source,f._items.clear(),f._items.loadConfig(b.root().nodes.get(0));this.hasFetched=!0}}
function FUiSelectEditor_setVisible(b){this.__base.FUiDropEditor.setVisible.call(this,b);var f=this._hPanel,h=this._hItemsForm;if(b){b=this._source.getValueRectangle(RValue.rectangle);h.width="";var q=h.offsetWidth;f.style.left=b.left()+"px";f.style.top=b.bottom()+"px";f.style.width=Math.max(q,b.width())+"px";h.width="100%";h.offsetHeight>this._minHeight&&(this._hDropLayout.style.overflowY="scroll",this._hDropLayout.style.height=this._minHeight+"px")}}
function FUiSelectEditor_dispose(){this._hDropLayout=RHtml.free(this._hDropLayout);this._hItemsForm=RHtml.free(this._hItemsForm);this.__base.FUiDropEditor.dispose.call(this)}
function FUiSelectItem(b){b=RClass.inherits(this,b,FUiControl,MListenerClick);b._icon=RClass.register(b,new APtyString("_icon"));b._note=RClass.register(b,new APtyString("_note"));b._dataValue=RClass.register(b,new APtyString("_dataValue"));b._styleNormal=RClass.register(b,new AStyle("_styleNormal"));b._styleHover=RClass.register(b,new AStyle("_styleHover"));b._styleSelect=RClass.register(b,new AStyle("_styleSelect"));b._styleIconChecked=RClass.register(b,new AStyle("_styleIcon"));b._styleLabel=RClass.register(b,
new AStyle("_styleLabel"));b._styleNote=RClass.register(b,new AStyle("_styleNote"));b._checked=!1;b._hIconPanel=null;b._hIcon=null;b._hLabelPanel=null;b._hNotePanel=null;b.onBuildPanel=FUiSelectItem_onBuildPanel;b.onBuild=FUiSelectItem_onBuild;b.onEnter=FUiSelectItem_onEnter;b.onLeave=FUiSelectItem_onLeave;b.onMouseDown=RClass.register(b,new AEventMouseDown("onMouseDown"),FUiSelectItem_onMouseDown);b.setChecked=FUiSelectItem_setChecked;b.set=FUiSelectItem_set;b.dispose=FUiSelectItem_dispose;return b}
function FUiSelectItem_onBuildPanel(b){this._hPanel=RBuilder.createTableRow(b,this.styleName("Normal"))}
function FUiSelectItem_onBuild(b){this.__base.FUiControl.onBuild.call(this,b);b=this._hPanel;this.attachEvent("onMouseDown",b);var f=this._hIconPanel=RBuilder.appendTableCell(b,this.styleName("Icon"));f.width=18;f.align="center";f=this._hLabelPanel=RBuilder.appendTableCell(b,this.styleName("Label"));f.innerHTML=this._label?this._label:"&nbsp;";this._hNotePanel=RBuilder.appendTableCell(b,this.styleName("Note"))}
function FUiSelectItem_onEnter(){this.__base.FUiControl.onEnter.call(this);this._hPanel.className=RBoolean.parse(this._checked)?this.styleName("Select"):this.styleName("Hover")}function FUiSelectItem_onLeave(){this._hPanel.className=RBoolean.parse(this._checked)?this.styleName("Select"):this.styleName("Normal");this.__base.FUiControl.onLeave.call(this)}function FUiSelectItem_onMouseDown(){this.processClickListener(this)}
function FUiSelectItem_setChecked(b){this._checked=b;this._hIcon?this._hIcon.style.display=b?"block":"none":this._hIconPanel.innerHTML=b?"O":"";this._hPanel.className=b?this.styleName("Select"):this.styleName("Normal")}
function FUiSelectItem_set(b,f,h,q){this._icon=RString.nvl(b);RString.isEmpty(this._icon)||(this._hIcon=RBuilder.appendIcon(this._hIconPanel,this.styleIcon(this._icon)));this._label=RString.nvl(f);this._value=RString.nvl(h);this._note=RString.nvl(q);this._hLabelPanel.innerText=this._label;this._hNotePanel.innerText=this._note}
function FUiSelectItem_dispose(){this._hIconPanel=RHtml.free(this._hIconPanel);this._hLabelPanel=RHtml.free(this._hLabelPanel);this._hNotePanel=RHtml.free(this._hNotePanel);this.__base.FUiControl.dispose.call(this)}
function FUiSlideNumber(b){b=RClass.inherits(this,b,FUiEditControl,MPropertyNumber,MListenerDataChanged,MMouseCapture);b._inputSize=RClass.register(b,new APtySize2("_inputSize"));b._styleSlidePanel=RClass.register(b,new AStyle("_styleSlidePanel"));b._styleValuePanel=RClass.register(b,new AStyle("_styleValuePanel"));b._styleInput=RClass.register(b,new AStyle("_styleInput"));b._styleAdjustForm=RClass.register(b,new AStyle("_styleAdjustForm"));b._styleUpPanel=RClass.register(b,new AStyle("_styleUpPanel"));
b._styleDownPanel=RClass.register(b,new AStyle("_styleDownPanel"));b._innerOriginValue=null;b._innerDataValue=null;b._slide=null;b._hInput=null;b._iconUp=null;b._iconDown=null;b.onBuildEditValue=FUiSlideNumber_onBuildEditValue;b.onMouseCaptureStart=FUiSlideNumber_onMouseCaptureStart;b.onMouseCapture=FUiSlideNumber_onMouseCapture;b.onMouseCaptureStop=FUiSlideNumber_onMouseCaptureStop;b.onSlideChange=FUiSlideNumber_onSlideChange;b.onInputKeyPress=RClass.register(b,new AEventKeyPress("onInputKeyPress"),
FUiSlideNumber_onInputKeyPress);b.onInputEdit=RClass.register(b,new AEventInputChanged("onInputEdit"),FUiSlideNumber_onInputEdit);b.onInputChange=RClass.register(b,new AEventChange("onInputChange"),FUiSlideNumber_onInputChange);b.construct=FUiSlideNumber_construct;b.get=FUiSlideNumber_get;b.set=FUiSlideNumber_set;b.setInputValue=FUiSlideNumber_setInputValue;b.refreshValue=FUiSlideNumber_refreshValue;return b}
function FUiSlideNumber_onBuildEditValue(b){var f=this._hValuePanel;f.className=this.styleName("ValuePanel");f=this._hValueForm=RBuilder.appendTable(f);f.__linker=this;f.width="100%";f=this._hValueLine=RBuilder.appendTableRow(f);this._hChangePanel=RBuilder.appendTableCell(f);this.onBuildEditChange(b);b=this._hSlidePanel=RBuilder.appendTableCell(f,this.styleName("SlidePanel"));var h=this._slide=new SUiSlide;h.control=this;h.hPanel=b;h.setRange(this._valueMin,this._valueMax);h.onSlideChange=this.onSlideChange;
h.build();b=this._hInputPanel=RBuilder.appendTableCell(f);h=this._hInput=RBuilder.appendEdit(b,this.styleName("Input"));this.attachEvent("onInputKeyPress",h,this.onInputKeyPress);this.attachEvent("onInputEdit",h,this.onInputEdit);this.attachEvent("onInputChange",h,this.onInputChange);RHtml.setSize(b,this._inputSize);this._editLength&&(h.maxLength=this._editLength);f=this._hAdjustPanel=RBuilder.appendTableCell(f);f.style.borderLeft="1px solid #666666";f.width=12;f=this.hAdjustForm=RBuilder.appendTable(f,
this.styleName("AdjustForm"));b=RBuilder.appendTableRowCell(f);b.className=this.styleName("UpPanel");(this._hUpIcon=RBuilder.appendIcon(b,null,"control.number.up")).align="center";b=RBuilder.appendTableRowCell(f);b.className=this.styleName("DownPanel");this._hDownIcon=RBuilder.appendIcon(b,null,"control.number.down")}function FUiSlideNumber_onMouseCaptureStart(b){var f=RHtml.searchObject(b.hSource,"__pcapture");if(f)f.onMouseDown(b)}
function FUiSlideNumber_onMouseCapture(b){var f=RHtml.searchObject(b.hSource,"__pcapture");if(f)f.onMouseMove(b)}function FUiSlideNumber_onMouseCaptureStop(b){var f=RHtml.searchObject(b.hSource,"__pcapture");if(f)f.onMouseUp(b)}function FUiSlideNumber_onSlideChange(b){this.setInputValue(b);this.refreshValue()}function FUiSlideNumber_onInputKeyPress(b){RKeyboard.isFloatKey(b.keyCode)||b.cancel()}function FUiSlideNumber_onInputEdit(b){this._slide.set(this._hInput.value);this.refreshValue()}
function FUiSlideNumber_onInputChange(b){b=this._hInput.value;this._slide.set(b);this.setInputValue(b);this.refreshValue()}function FUiSlideNumber_construct(){this.__base.FUiEditControl.construct.call(this);this._inputSize=new SSize2(120,0)}function FUiSlideNumber_get(b){b=RFloat.parse(this._hInput.value);return RFloat.toRange(b,this._valueMin,this._valueMax)}
function FUiSlideNumber_set(b){this.__base.FUiEditControl.set.call(this,b);this._innerDataValue=this._innerOriginValue=b=RString.nvl(b,"0");this._slide.set(b);this.setInputValue(b);this.changeSet(!1)}function FUiSlideNumber_setInputValue(b){b=RFloat.parse(b);isNaN(b)||(b=RFloat.toRange(b,this._valueMin,this._valueMax),this._dataDisplay=RFloat.format(b,0,null,2,null),this._hInput.value=this._dataDisplay)}function FUiSlideNumber_refreshValue(){this.processDataChangedListener(this)}
function FUiSplit(b){b=RClass.inherits(this,b,FControl);b._dispStyle=RClass.register(b,new APtyString("_dispStyle",ESplitStyle.Normal));b._icon=RClass.register(b,new APtyString("_icon"));b._editExtend=RClass.register(b,new APtyBoolean("_editExtend"),!0);b._styleTitle=RClass.register(b,new TStyle("Title"));b._iconMinus="ctl.collapse_nor";b._iconPlus="ctl.expand_nor";b.__lines=null;b._esize=ESize.Horizontal;b.extended=!0;b.hImage=null;b.hIcon=null;b.hText=null;b.onSplitMouseEnter=RClass.register(b,
new HMouseEnter("onSplitMouseEnter"),FUiSplit_onSplitMouseEnter);b.onSplitMouseLeave=RClass.register(b,new HMouseLeave("onSplitMouseLeave"),FUiSplit_onSplitMouseLeave);b.onMouseDown=FUiSplit_onMouseDown;b.onBuildPanel=FUiSplit_onBuildPanel;b.oeBuild=FUiSplit_oeBuild;b.oeMode=FUiSplit_oeMode;b.construct=FUiSplit_construct;b.extend=FUiSplit_extend;b.pushLine=FUiSplit_pushLine;b.dispose=FUiSplit_dispose;return b}
function FUiSplit_onSplitMouseEnter(b){this.hImage&&(this.hImage.src=RRes._iconPath(this.extended?"ctl.collapse_hvr":"ctl.expand_hvr"))}function FUiSplit_onSplitMouseLeave(b){this.hImage&&(this.hImage.src=RRes._iconPath(this.extended?"ctl.collapse_nor":"ctl.expand_nor"))}function FUiSplit_onMouseDown(){ESplitStyle.Normal==this._dispStyle&&this.extend(!this.extended)}
function FUiSplit_onBuildPanel(){this.hPanel=RBuilder.create(null,"DIV");this.hForm=RBuilder.appendTable(this.hPanel);this.hForm.width="100%"}
function FUiSplit_oeBuild(b){this.base.FControl.oeBuild.call(this,b);this.height=2;if(RString.equals(this._dispStyle,ESplitStyle.Normal)){b=this.hForm;var f=b.insertRow();this.attachEvent("onSplitMouseEnter",b);this.attachEvent("onSplitMouseLeave",b);b=f.insertCell();b.width="100%";b.height=25;b.style.padding="0 0";b.style.background="url("+RRes._iconPath("ctl.FUiSplit_Panel")+")";RBuilder.appendEmpty(b,4);this.hImage=RBuilder.appendIcon(b,this._iconMinus);this._icon&&(this.hIcon=RBuilder.appendIcon(b,
this._icon));this.hText=RBuilder.appendText(b,"&nbsp;&nbsp;"+this.label);this.hText.style.fontWeight="BOLD"}else RString.equals(this._dispStyle,ESplitStyle.BulgeLine)?(b=this.hForm.insertRow().insertCell(),b.style.borderBottom="1px solid #666666",b.style.borderTop="1px solid #DDDDDD",b.height=2):RString.equals(this._dispStyle,ESplitStyle.HollowLine)&&(b=this.hForm.insertRow().insertCell(),b.style.borderBottom="1px solid #DDDDDD",b.style.borderTop="1px solid #666666",b.height=2);return EEventStatus.Stop}
function FUiSplit_oeMode(b){var f=this.base.FControl.oeMode.call(this,b);this.base.MDisplay.oeMode.call(this,b);this.extend(this._editExtend);return f}function FUiSplit_construct(){this.__lines=new TList}
function FUiSplit_extend(b){if(EMode.Design!=this._emode&&this.extended!=b){this.extended=b;this.hImage&&(this.hImage.src=b?RResource._iconPath(this._iconMinus):RRes._iconPath(this._iconPlus));for(var f=this.__lines.count,h=0;h<f;h++)this.__lines.get(h).style.display=b?"block":"none";this.topControl().topResize(this)}}function FUiSplit_pushLine(b){this.__lines.push(b)}
function FUiSplit_dispose(){this.base.FControl.dispose.call(this);this.__lines&&(this.__lines.release(),this.__lines=null);this.hImage=this.hIcon=this.hText=this.hForm=null}var EGridColumn=new function(){this.None=0;this.Size=1;this.Drag=2;return this},EGridDisplay=new function(){this.Title="T";this.Head="H";this.Search="S";this.Total="A";this.Navigator="N";return this};
function FCell(b){b=RClass.inherits(this,b,FControl,MEditValue,MDataValue);b._stylePanel=RClass.register(b,new AStyle("_stylePanel"));b._table=null;b._column=null;b._row=null;b.onBuildPanel=FCell_onBuildPanel;b.onBuild=FCell_onBuild;b.oeDataLoad=FCell_oeDataLoad;b.oeDataSave=FCell_oeDataSave;return b}function FCell_onBuildPanel(b){this._hPanel=RBuilder.create(b,"TD",this.styleName("Panel"))}
function FCell_onBuild(b){this.__base.FControl.onBuild.call(this,b);RHtml.linkSet(this._hPanel,"control",this)}function FCell_oeDataLoad(b){var f=this._column;b=b.source.currentRow().get(f._dataName);this.set(b);return EEventStatus.Stop}function FCell_oeDataSave(b){var f=this._column;b=b.source.currentRow();var h=this.get();b.set(f._dataName,h);return EEventStatus.Stop}
function FCell_doFocus(){this._table.__focusCell=this;if(this._column.isEditAble(this)){var b=this._hPanel.style;b.borderLeft="1px solid #666666";b.borderTop="1px solid #666666";b.borderRight="1px solid #CCCCCC";b.borderBottom="1px solid #CCCCCC";this.__focus=!0;this.refreshStyle()}}
function FCell_doBlur(){if(this._column.isEditAble(this)){var b=this._hPanel.style;b.borderLeft="0px solid #666666";b.borderTop="0px solid #666666";b.borderRight="1px solid #F0F0F0";b.borderBottom="1px dotted #CCCCCC";this.__focus=!1;this.refreshStyle()}}function FCell_descriptor(){return this._column}function FCell_text(){var b=this._column;return EEditFormat.Html==b.editFormat?this._hPanel.innerHTML:b._absEdit&&this._hEdit?this._hEdit.value:this._hEditPanel?this._hEditPanel.innerText:""}
function FCell_setText(b){var f=this._column;EEditFormat.Html==f.editFormat?this._hPanel.innerHTML=b:f._absEdit&&this._hEdit?this._hEdit.value=b:this._hEditPanel&&(this._hEditPanel.innerText=b)}function FCell_focus(b){var f=this._hEdit;f&&(this._column._table.selectRow(this._row,!0,!0),f.focus(),b&&f.select())}function FCell_setVisible(b){this._hPanel.style.display=b?"block":"none"}
function FCell_refreshStyle(){var b=this._table,f=this._row,h=f.isSelect,q=this._hEdit;q&&(q.readOnly=!0,q.style.color=EColor.TextReadonly,q.style.backgroundColor=u);var u=null,u=h?EColor._rowSelect:b.__hoverRow==f?EColor._rowHover:EColor._rows[f.index%EColor._rows.length];this.__focus&&(u=EColor._rowEditHover);this._hPanel.style.backgroundColor=u}
function FCell_dispose(){this.base.FControl.dispose.call(this);RMemory.freeHtml(this._hPanel);this.hDrop=this.hDropPanel=this._hEdit=this._hEditPanel=this.hIcon=this.hIconPanel=this.hFormLine=this.hForm=this._hPanel=null}function FCell_dump(b){b=RString.nvlStr(b);b.append(RClass.dump(this),"[");b.append(this.value);b.append("]");return b}
function FCellButton(b){b=RClass.inherits(this,b,FCell);b.buttons=null;b.attributes=null;b.onButtonEnter=RClass.register(b,new AEventMouseEnter("onButtonEnter"),FCellButton_onButtonEnter);b.onButtonLeave=RClass.register(b,new AEventMouseLeave("onButtonLeave"),FCellButton_onButtonLeave);b.onCellLeave=RClass.register(b,new AEventMouseLeave("onCellLeave"),FCellButton_onCellLeave);b.onHintEnter=RClass.register(b,new AEventMouseEnter("onHintEnter"),FCellButton_onHintEnter);b.onHintLeave=RClass.register(b,
new AEventMouseLeave("onHintLeave"),FCellButton_onHintLeave);b.onButtonClick=RClass.register(b,new AEventClick("onButtonClick"),FCellButton_onButtonClick);b.construct=FCellButton_construct;b.isDataChanged=RMethod.emptyFalse;b.findButtonByPanel=FCellButton_findButtonByPanel;b.buildForm=FCellButton_buildForm;b.set=FCellButton_set;b.modifyButton=FCellButton_modifyButton;b.refreshStyle=FCellButton_refreshStyle;return b}
function FCellButton_onButtonEnter(b){if(b=this.findButtonByPanel(b.hSource)){var f=b.hPanel.style;f.color="black";f.cursor="hand";b.hintBox&&(b.hintBox.style.display="block")}this.hHintPanel&&(this.hHintPanel.style.display="")}function FCellButton_onButtonLeave(b){if(b=this.findButtonByPanel(b.hSource))b=b.hPanel.style,b.color="#0661B0",b.cursor="normal"}function FCellButton_onHintEnter(b){b.hSource.style.backgroundColor="#eeeeee"}
function FCellButton_onCellLeave(b){b=this.buttons;for(var f=b.count,h=0;h<f;h++){var q=b.value(h);q.hintBox&&(q.hintBox.style.display="none")}}function FCellButton_onHintLeave(b){b.hSource.style.backgroundColor="#ffffff";b.hSource.style.display="none"}function FCellButton_onButtonClick(b){this.table.clickCell(this);var f=this.findButtonByPanel(b.hSource);f&&f.button.callEvent("onClick",this,b)}function FCellButton_construct(){this.base.FCell.construct.call(this);this.attributes=new TAttributes}
function FCellButton_findButtonByPanel(b){for(var f=this.buttons,h=0;h<f.count;h++){var q=f.value(h);if(q.hPanel==b)return q}}
function FCellButton_buildForm(){var b=this.column,f=this.hPanel;RControl.attachEvent(this,"onCellLeave",f,this.onCellLeave);f.align="left";f.padding=1;f=this.hFormLine=(this.hForm=RBuilder.appendTable(this.hPanel)).insertRow();if(b=b.components){this.buttons=new TMap;for(var h=0;h<b.count;h++){var q=b.value(h),u=f.insertCell();u.align="center";u.style.padding="0 3";var z=RBuilder.append(u,"DIV"),A=null;q.icon?A=RBuilder.appendIcon(z,q.icon):(z.style.padding="2 6",z.style.color="#0661B0",z.style.textDecoration=
"underline");this.attachEvent("onButtonEnter",z,this.onButtonEnter);this.attachEvent("onButtonLeave",z,this.onButtonLeave);this.attachEvent("onButtonClick",z,this.onButtonClick);var B=null;q.label&&(q.icon?A.title=q.label:B=RBuilder.appendText(z,q.label));var C=new TCellButton;C.button=q;C.hLayout=u;C.hPanel=z;C.hIcon=A;C.hText=B;this.buttons.set(q.name,C)}f=this.hHintPanel=this.hForm.insertRow().insertCell();f.height=1;f.style.position="relative"}}
function FCellButton_set(b){if(!RString.isEmpty(b)){var f=new TAttributes;f.unpack(b);for(b=0;b<f.count;b++){var h=this.buttons.get(f.name(b)),q=f.value(b);if(h&&!RString.isEmpty(q)){var u=this.attributes;u.clear();u.unpack(q);this.modifyButton(h,u)}}}}
function FCellButton_modifyButton(b,f){var h=!0;f.contains("visible")&&(h=RBoolean.isTrue(f.get("visible")));b.hLayout.style.display=h?"block":"none";if(h=f.get("disabled"))RBoolean.isTrue(h)?(hc.style.padding=3,hc.style.border=0):(hc.style.padding=2,hc.style.borderLeft="1 solid #DDDDDD",hc.style.borderTop="1 solid #DDDDDD",hc.style.borderRight="1 solid #999999",hc.style.borderBottom="1 solid #999999",hc.style.backgroundColor="#FFFFFF");if(h=f.get("label"))b.icon?b.hIcon.title=h:b.hText.innerText=
h;f.contains("hint")&&(hfd=this.hFloatDrop=RBuilder.append(this.hHintPanel,"DIV"),hfd.style.borderLeft="1 solid #CCCCCC",hfd.style.borderTop="1 solid #CCCCCC",hfd.style.borderRight="1 solid #666666",hfd.style.borderBottom="1 solid #666666",hfd.style.zIndex=4E4,hfd.style.backgroundColor="#FFFFFF",hfd.style.display="none",hfd.style.position="absolute",hfd.style.padding="4 8",hfd.style.width="300px",hfd.style.pixelTop=b.offsetHeight+1,hfd.style.pixelLeft=b.hPanel.offsetWidth+20,hfd.innerHTML=f.get("hint"),
this.attachEvent("onHintEnter",hfd,this.onHintEnter),this.attachEvent("onHintLeave",hfd,this.onHintLeave),b.hintBox=hfd)}function FCellButton_refreshStyle(){var b=this.row,f=null,f=b.isSelect?EColor.RowSelect:this.column.table.__hoverRow==b?EColor.RowHover:EColor.Rows[b.index%EColor.Rows.length];this.hPanel.style.backgroundColor=f}
function FCellEdit(b){b=RClass.inherits(this,b,FCellEditControl);b._styleInput=RClass.register(b,new AStyle("_styleInput"));b._hInput=null;b.onBuildEdit=FCellEdit_onBuildEdit;b.get=FCellEdit_get;b.set=FCellEdit_set;return b}function FCellEdit_onBuildEdit(b){this._hInput=RBuilder.appendEdit(this._hEditPanel,this.styleName("Input"))}function FCellEdit_get(){var b=o.__base.FCellEditControl.get.call(o,p),f=o._hInput;f&&(b=f.value);return b}
function FCellEdit_set(b){this.__base.FCellEditControl.set.call(this,b);var f=this._hInput;f&&(f.value=RString.nvl(b))}function FCellEdit_buildDrop(){var b=this.column;if(!RString.isEmpty(b.lovRefer)){var f=this.hDropPanel;f.align="right";f.style.paddingRight=2;f=this.hLovImage=RBuilder.appendIcon(f,"ctl.FCellEdit_Lov",null,16,16);f.style.borderLeft="1 solid #CCCCCC";f.style.cursor="hand";b.linkEvent(this,"onListClick",f)}}
function FCellEdit_setInfo(b){this.base.FCellEditControl.setInfo.call(this,b);var f=this.column.iconMap,h=this.hIcon;f&&f.get(b.icon)?(h.style.display="block",h.title=b.iconHint,h.src=RResource.iconPath(f.get(b.icon))):h&&(h.style.display="none")}function FCellEdit_text(){var b=this.column;return b.canZoom()?this.hEdit.innerText:b._absEdit?this.hEdit.value:this.hEditPanel.innerText}
function FCellEdit_setText(b){var f=this.column;f.canZoom()?this.hEdit.innerText=b:f._absEdit?this.hEdit.value=b:this.hEditPanel.innerText=b}function FCellEditControl(b){b=RClass.inherits(this,b,FCell);b.onBuildIcon=FCellEditControl_onBuildIcon;b.onBuildEdit=FCellEditControl_onBuildEdit;b.onBuildDrop=RMethod.empty;b.onBuildForm=FCellEditControl_onBuildForm;b.onBuild=FCellEditControl_onBuild;return b}function FCellEditControl_onBuildIcon(b){this.hIcon=RBuilder.append(this.hIconPanel,"IMG")}
function FCellEditControl_onBuildEdit(b){}
function FCellEditControl_onBuildForm(b){var f=this._column;if(f._hasIconArea||f._hasDropArea){var h=this.hForm=RBuilder.appendTable(this._hPanel);h.width="100%";h=this.hFormLine=h.insertRow();f.hasIconArea&&(this.hIconPanel=h.insertCell(),this.hIconPanel.width=18,this.onBuildIcon(b));this._hEditPanel=h.insertCell();this.onBuildEdit(b);f.hasDropArea&&(this.hDropPanel=h.insertCell(),this.hDropPanel.width=8,this.onBuildDrop(b))}else this._hEditPanel=this._hPanel,this.onBuildEdit(b)}
function FCellEditControl_onBuild(b){this.__base.FCell.onBuild.call(this,b);this.onBuildForm(b)}function FCellEditControl_getEditRange(){var b=this.hPanel,f=RHtml.offsetPosition(b);return new TRange(f.x,f.y,b.offsetWidth,b.offsetHeight)}
function FCellEditControl_select(b){var f=this.descriptor().isEditAble(this.row);b?RClass.isClass(this,FCellCalendar)?(this.setEditStyle(EStyle.ReadonlySelect),this.column.disable()):this.setEditStyle(f?EStyle.Select:EStyle.ReadonlySelect):RClass.isClass(this,FCellCalendar)?(this.setEditStyle(EStyle.Readonly),this.column.disable()):this.setEditStyle(f?EStyle.Normal:EStyle.Readonly)}
function FCellEditControl_setVisible(b){this.hPanel.style.display=b?"block":"none";b&&(RClass.isClass(this,FCellCalendar)?(this.setEditStyle(EStyle.Readonly),this.column.disable()):(b=this.descriptor().isEditAble(this.row),this.setEditStyle(b?EStyle.Normal:EStyle.Readonly)))}
function FCellEditControl_refreshStyle(){var b=this.table,f=this.column,h=this.row,q=this.hEditPanel,u=this.hEdit,z=this.hDrop,A=f.isEditAble(h),B=h.isSelect,C=A?EColor.TextEdit:EColor.TextReadonly;u&&(u.readOnly=!A,f.zoomRefer||(u.style.color=C),z&&(u.style.cursor=A?"hand":"normal",z.style.cursor=A?"hand":"normal"));q&&(q.style.color=C);f=null;f=B?EColor.RowSelect:b.__hoverRow==h?EColor.RowHover:EColor.Rows[h.index%EColor.Rows.length];this.__focus&&(f=EColor.RowEditHover);u&&(u.style.backgroundColor=
f);this.hPanel.style.backgroundColor=f}function FCellSelected(b){b=RClass.inherits(this,b,FCell);b._dataName="_select";b._styleEdit=RClass.register(b,new AStyle("_styleEdit"));b._hSelected=null;b.onBuild=FCellSelected_onBuild;b.onSelected=FCellSelected_onSelected;return b}function FCellSelected_onBuild(b){this.__base.FCell.onBuild.call(this,b);b=this._hPanel;b.align="center";b=this._hSelected=RBuilder.appendCheck(b,this.styleName("Edit"));b.parent=this;b.onclick=this.onSelected}
function FCellSelected_onSelected(b){}function FCellSelected_refreshStyle(){var b=this.row;b.table.dispSelected?(this.hPanel.style.display="block",b.isSelect?(this._hSelected.checked=!0,this.hPanel.style.backgroundColor="#CEE7FF"):(this._hSelected.checked=!1,this.hPanel.style.backgroundColor="#FFFFFF")):this.hPanel.style.display="none"}function FCellSelected_dispose(){this.base.FCellEditControl.dispose.call(this);this._hSelected=null}
function FCellStatus(b){b=RClass.inherits(this,b,FCell);b._dataName="_status";b._hStatus=null;b.onBuild=FCellStatus_onBuild;return b}function FCellStatus_onBuild(b){this.__base.FCell.onBuild.call(this,b);b=this._hPanel;b.align="center";b.style.paddingTop=2;b.style.paddingBottom=2;b.style.cursor="normal";this._hStatus=RBuilder.appendIcon(b,null,"n")}function FCellStatus_onStatusEnter(){this.row.table.getRowBar().linkCell(this)}function FCellStatus_setIcon(b){this._hStatus.src=b}
function FCellStatus_refreshStyle(){var b=this.row,f=b.table,h=null,h=b.isDataChanged()?"Changed":(f.isFormLinked(),"Normal");this.setIcon(this.column.styleIconPath(h))}function FCellStatus_dispose(){this.base.FCellEditControl.dispose.call(this);this._hStatus=null}
function FColumn(b){b=RClass.inherits(this,b,FControl,MDataField);b._displayList=!0;b._styleLabel=RClass.register(b,new AStyle("_styleLabel"));b._styleSearchPanel=RClass.register(b,new AStyle("_styleSearchPanel"));b._styleSearchEdit=RClass.register(b,new AStyle("_styleSearchEdit"));b._styleIconSortUp=RClass.register(b,new AStyleIcon("_styleIconSortUp"));b._styleIconSortDown=RClass.register(b,new AStyleIcon("_styleIconSortDown"));b._cellClass=FCell;b._hForm=null;b._hFormLine=null;b._hIconPanel=null;
b._hIcon=null;b._hLabel=null;b._hSortPanel=null;b._hSortUp=null;b._hSortDown=null;b._hSearchEditPanel=null;b._hSearchEdit=null;b.onBuildLabel=FColumn_onBuildLabel;b.onBuildSearchIcon=RMethod.empty;b.onBuildSearchEdit=FColumn_onBuildSearchEdit;b.onBuildSearchDrop=RMethod.empty;b.onBuildSearchForm=FColumn_onBuildSearchForm;b.onBuildSearch=FColumn_onBuildSearch;b.onBuildTotal=FColumn_onBuildTotal;b.onBuildPanel=FColumn_onBuildPanel;b.onBuild=FColumn_onBuild;b.onSearchEnter=RClass.register(b,new AEventMouseEnter("onSearchEnter"));
b.onSearchClick=RClass.register(b,new AEventClick("onSearchClick"));b.onSearchLeave=RClass.register(b,new AEventMouseLeave("onSearchLeave"));b.onSearchKeyDown=RClass.register(b,new AEventKeyDown("onSearchKeyDown"));b.createCell=FColumn_createCell;return b}
function FColumn_onBuildLabel(b){b=this._hFormLine;if(this._icon){var f=this._hIconPanel=RBuilder.appendTableCell(b);this._hIcon=RBuilder.appendIcon(f,this.icon)}(this._hLabel=RBuilder.appendTableCell(b)).innerHTML=RString.nvl(this.label());b=this._hSortPanel=RBuilder.appendTableCell(b);f=this._hSortUp=RBuilder.appendIcon(b,this.styleIcon("SortUp",FColumn));f.style.display="none";f=this._hSortDown=RBuilder.appendIcon(b,this.styleIcon("SortDown",FColumn));f.style.display="none"}
function FColumn_onBuildSearchEdit(b){b=this._hSearchEditPanel=RBuilder.appendTableCell(this._hSearchFormLine,this.styleName("SearchPanel"));this._hSearchEdit=RBuilder.appendEdit(b,this.styleName("SearchEdit"))}
function FColumn_onBuildSearchForm(b){b=this._hSearchForm=RBuilder.appendTable(this._hSearchPanel);b.width="100%";b.style.backgroundColor="#FFFFFF";this._hSearchFormLine=b.insertRow();RClass.isClass(this,FColumnButton)?(this._hSearchPanel.style.backgroundColor="#EEEFF1",this._hSearchPanel.style.borderLeft="1 solid #808080",this._hSearchPanel.style.borderTop="1 solid #808080",this._hSearchPanel.style.borderBottom="1 solid #9EC4EB"):(this.onBuildSearchIcon(),this.onBuildSearchEdit(),this.onBuildSearchDrop())}
function FColumn_onBuildSearch(b){var f=this._hSearchPanel=RBuilder.create(b,"TD",this.styleName("SearchPanel"));f.style.backgroundColor="#FFFFFF";f.style.borderBottom="1 solid #9EC4EB";RHtml.linkSet(f,"control",this);this.attachEvent("onSearchEnter",f);this.attachEvent("onSearchLeave",f);this.onBuildSearchForm(b)}
function FColumn_onBuildTotal(b){b=this._hTotalPanel=RBuilder.create(b,"TD");RHtml.linkSet(b,"control",this);b.align="right";b.style.color="#686860";b.style.backgroundColor="#F8F8F0";b.style.borderBottom="1 solid #B8B8B0";b.innerText=" "}function FColumn_onBuildPanel(b){this._hPanel=RBuilder.create(b,"TD",this.styleName("Label"))}
function FColumn_onBuild(b){this._absEdit=this._editInsert||this._editUpdate||this._editDelete;this._absEdit||(RString.isEmpty(this._lovReference)?this._hasDropArea=!1:this._hasDropArea=!0);if(!RString.isEmpty(this._viewIcons)){var f=this.iconMap=new TAttributes;f.split(this._viewIcons.replace(/\n/g,";"),"=",";");this.hasIconArea=0<f.count}this.__base.FControl.onBuild.call(this,b);f=this._hPanel;f.style.padding=4;f=this._hForm=RBuilder.appendTable(f);this._orderAble||(f.style.cursor="hand");this._hFormLine=
RBuilder.appendTableRow(this._hForm);this.onBuildLabel(b);this.onBuildSearch(b);this.onBuildTotal(b);b=this._hFixPanel=RBuilder.create(b,"TD");b.height=1;b.bgColor="#FFFFFF";40>this._size.width&&(this._size.width=40);RHtml.setSize(b,this._size);this._hPanel.style.pixelWidth=this.width;this._hFixPanel.style.pixelWidth=this.width}
function FColumn_createCell(b){b=RClass.create(this._cellClass);var f=b._table=this._table;b._name=this._name;b._column=this;b.build(f._hPanel);b.setVisible(this._displayList);return b}function FColumn_onCellMouseEnter(b,f){this.table.hoverRow(b.row,!0)}function FColumn_onCellMouseLeave(b,f){this.table.hoverRow(b.row,!1)}
function FColumn_onCellMouseDown(b,f){var h=b.table,q=b.row;h.__focusCell=b;h.selectRow(q,!f.ctrlKey,!0);h=RConsole.find(FFocusConsole).focusControl;RClass.isClass(h,FDropEditor)&&h.source==b||RConsole.find(FFocusConsole).focus(b)}function FColumn_onCellClick(b,f){this.table.clickRow(b.row)}function FColumn_onCellDoubleClick(b,f){var h=b.row;this.isEditAble(h)||this.table.doubleClickRow(h)}function FColumn_onCellKeyDown(b,f,h){if(h)this.table.onCellKeyDown(b,f,h)}
function FColumn_oeMode(b){if(b.isAfter()){var f=!1;this.inModeDisplay=f=EAction.Design==b.mode?this.dispDesign:this._displayList;this.setVisible(f)}return EEventStatus.Continue}function FColumn_oeRefresh(b){b.isBefore()&&this.setVisible(this._displayList)}function FColumn_onDataKeyDown(b,f){this.__base.MEditDescriptor.onDataKeyDown.call(this,b,f)}function FColumn_onDataChanged(b,f){this.table.setDataStatus(b.row,EDataStatus.Update)}
function FColumn_onEditBegin(b){var f=b.row;this.editor=b;this.table.editRow=f;this.table.editColumn=this;this.table.select(f,!0);RLogger.debug(this,"Edit begin (column={1} row={2} editor={3})",this.name,RClass.dump(f),RClass.dump(b))}
function FColumn_onEditEnd(b){b=editor.row;var f=editor.text();this.setValue(b,this.formatValue(f));this.setText(b,f);this.table.setDataStatus(b,b.isChanged()?EDataStatus.Update:EDataStatus.Unknown);this.editor=null;RLogger.debug(this,"{1}={2}\n{3}\n{4}",RClass.dump(editor),this.formatValue(f),this.dump(),b.dump())}function FColumn_onEditChanged(b){b.row.refresh()}
function FColumn_onHeadMouseDown(b){var f=this.table,h=f.dsViewer.count,q=b.x;if(!RClass.isClass(this,FColumnButton)){var u=this._hPanel.offsetWidth-6;if(0<q&&q<u&&0<h&&!RClass.isClass(b.source,FColumnStatus)){h=f.columns;q=h.count;for(b=0;b<q;b++)u=h.value(b),u._hSortUp.style.display="none",u._hSortDown.style.display="none";f.dsOrders.clear();h=new TOrderItem;b=this.dataName;this.sortType?(h.set(b,EOrder.Desc),this._hSortUp.style.display="none",this._hSortDown.style.display="block"):(this._hSortUp.style.display=
"block",this._hSortDown.style.display="none",h.set(b,EOrder.Asc));this.sortType=!this.sortType;f.dsOrders.push(h);f.dsSearch()}}}function FColumn_onRowClick(b,f){RConsole.find(FListenerConsole).process(FGridControl,EGridAction.RowClick,b.row,b.row)}
function FColumn_createMoveable(b){b=this.cloneMove;b||(b=RClass.create(this.constructor),b.buildMode=EColumnMode.Drag,b.assign(this,EAssign.Property),b.build(),this.cloneMove=b);var f=this.panel(EPanel.Move),h=b.panel(EPanel.Move);RHtml.setPixelRect(h,RHtml.rect(f));h.className=b.styleName("DesignMove");h.style.pixelLeft=f.offsetLeft;b.show();return b}function FColumn_searchValue(){if(this._hSearchEdit)return this._hSearchEdit.value}
function FColumn_setStyleStatus(b,f){var h=this.cell(b);if(h)switch(h=h.style,f){case EStyle.Normal:b.isDelete()?h.backgroundColor=EColor.Delete:this.isEditAble(b)?h.backgroundColor=EColor.Edit:h.backgroundColor=EColor.Readonly;break;case EStyle.Select:b.isDelete()?h.backgroundColor=EColor.Select:(h.textDecoration="none",this.isEditAble(b)?h.backgroundColor=EColor.RowEditSelect:h.backgroundColor=EColor.Select);break;case EStyle.Delete:h.textDecoration="line-through",h.backgroundColor=EColor.Select}}
function FColumn_cell(b){return b.cell(this.index)}function FColumn_equalsValue(b,f){return RString.nvl(b).replace(/\n/g,"\\n").replace(/\r/g,"\\r")==RString.nvl(f).replace(/\n/g,"\\n").replace(/\r/g,"\\r")}function FColumn_setWidth(b){this._hPanel.style.pixelWidth=b;this._hFixPanel.style.pixelWidth=b}function FColumn_setVisible(b){b=(this.isDisplay=b)?"block":"none";this._hPanel.style.display=b;this._hSearchPanel.style.display=b;this._hTotalPanel.style.display=b;this._hFixPanel.style.display=b}
function FColumn_moveCellFocus(b,f){var h=this.table,q=null,u=null,z=null;if(EPosition.Top==f)q=this,(u=h.rows.get(h.rows.indexOf(b)-1))&&(z=u.cell(q.index));else if(EPosition.Bottom==f)q=this,(u=h.rows.get(h.rows.indexOf(b)+1))&&(z=u.cell(q.index));else if(EPosition.Before==f)for(var A=this.index-1,B=h.rows.indexOf(b);0<=B;B--){for(var C=h.rows.get(B);0<=A;A--){var D=h.columns.value(A);if(RClass.isClass(D,FColumn)&&D._displayList){q=D;u=C;z=u.cell(q.index);break}}if(q)break;A=h.columns.count-1}else if(EPosition.After==
f)for(var A=this.index+1,B=h.rows.indexOf(b),E=h.columns.count,F=h.rows.count;B<F;B++){for(C=h.rows.get(B);A<E;A++)if(D=h.columns.value(A),RClass.isClass(D,FColumn)&&D._displayList){q=D;u=C;z=u.cell(q.index);break}if(q)break;A=0}q&&u&&z&&(z.focus(!0),RConsole.find(FFocusConsole).focus(z))}function FColumn_getEditRange(){var b=this._hSearchPanel,f=RHtml.offsetPosition(b);return new TRange(f.x,f.y,b.offsetWidth,b.offsetHeight)}
function FColumn_dispose(){this.__base.FControl.dispose.call(this);RMemory.freeHtml(this._hSearchPanel);RMemory.freeHtml(this._hFixPanel);this._hFixPanel=this._hSearchDrop=this._hSearchDropPanel=this._hSearchEdit=this._hSearchEditPanel=this._hSearchIcon=this._hSearchIconPanel=this._hSearchFormLine=this._hSearchForm=this._hSearchPanel=this._hSortDown=this._hSortUp=this._hSortPanel=this._hLabel=this._hHeadPanel=this._hIcon=this._hIconPanel=this._hFormLine=this._hForm=null}
function FColumn_dump(b){b=RString.nvlStr(b);b.append(RClass.dump(this),"[");b.append("name=",this.name);b.appendIf(this.icon,",icon=",this.icon);b.appendIf(this.label,",label=",this.label);b.appendIf(this.align,",align=",this.align);b.appendIf(this.valign,",valign=",this.valign);b.appendIf(this.dataName,",dataName=",this.dataName);b.appendIf(this.dataDefault,",dataDefault=",this.dataDefault);b.appendIf(this.index,",index=",this.index);b.append("]");b.append(" [editAccess=");b.append(this.editInsert?
"I":"_");b.append(this.editUpdate?"U":"_");b.append("]");return b}function FColumnButton(b){b=RClass.inherits(this,b,FColumn);b.__cellClass=FCellButton;return b}function FColumnEdit(b){b=RClass.inherits(this,b,FColumnEditControl,MPropertyEdit);b._cellClass=FCellEdit;return b}function FColumnEdit_onCellMouseEnter(b,f){}function FColumnEdit_onCellMouseLeave(b,f){}function FColumnEdit_onListClick(b,f){this.table.__focusCell=b;var h=b.row.saveRow().toAttributes();this.doListView(h)}
function FColumnEdit_onZoomHover(b,f){b.hEdit.style.color="black"}function FColumnEdit_onZoomLeave(b,f){b.hEdit.style.color="blue"}function FColumnEdit_onZoomClick(b,f){this.table.clickRow(b.row);var h=b.row.saveRow().get(this.zoomField);RString.isEmpty(h)||this.doZoom(h)}function FColumnEditControl(b){b=RClass.inherits(this,b,FColumn);b.isEditAble=FColumnEditControl_isEditAble;return b}
function FColumnEditControl_isEditAble(b){if(b)return ERowStatus.Insert==b.status?this.editInsert:this.editUpdate}function FColumnEmpty(b){b=RClass.inherits(this,b,FColumn);b._dispList=!0;b.onBuildSearchForm=RMethod.empty;return b}
function FColumnSelected(b){b=RClass.inherits(this,b,FColumnEditControl);b._dataName="_select";b._styleEdit=RClass.register(b,new AStyle("_styleEdit"));b._optionFixed=!0;b._cellClass=FCellSelected;b.onBuildSearchForm=FColumnSelected_onBuildSearchForm;b.onBuild=FColumnSelected_onBuild;b.createCell=FColumnSelected_createCell;b.dispose=FColumnSelected_dispose;return b}
function FColumnSelected_onBuildSearchForm(b){b=this._hSearchForm=RBuilder.appendTable(this._hSearchPanel);b.width="100%";b=this._hSearchFormLine=RBuilder.appendTableRow(b);b=RBuilder.appendTableCell(b);b.align="center";this._hSelected=RBuilder.appendCheck(b,this.styleName("Edit"));this._hSelected.column=this;this._hSelected.onclick=this.onSelectedClick}
function FColumnSelected_onBuild(b){b=this.__base.FColumnEditControl.onBuild.call(this,b);var f=this._hPanel;f.align="center";f.style.width="30px";f.style.height="22px";RBuilder.appendEmpty(this._hPanel,12,12);return b}function FColumnSelected_createCell(b){var f=this.__base.FColumnEditControl.createCell.call(this,b);b&&(b.cellSelect=f);return f}function FColumnSelected_dispose(){this._hSelect=null;this.__base.FColumnEditControl.dispose.call(this)}
function FColumnSelected_setVisible(){var b=this._table._displayColumnSelect?"block":"none";this._hPanel.style.display=b;this._hSelected.style.display=b;this._hSearchPanel.style.display=b;this._hTotalPanel.style.display=b;this._hFixPanel.style.display=b}function FColumnSelected_onCellClick(b,f){}
function FColumnSelected_onSelectedClick(b,f){for(var h=this.column,q=h.table.rows,u=q.count,z=0;z<u;z++){var A=q.get(z);A.selectAble&&(this.checked?h.table.selectRow(A,!1,!0):h.table.clearSelectRow(A))}}function FColumnStatus(b){b=RClass.inherits(this,b,FColumnEditControl);b._dataName="_status";b._optionFixed=!0;b._cellClass=FCellStatus;b.onBuildSearchForm=FColumnStatus_onBuildSearchForm;b.onBuild=FColumnStatus_onBuild;b.createCell=FColumnStatus_createCell;return b}
function FColumnStatus_onBuildSearchForm(b){b=this._hSearchForm=RBuilder.appendTable(this._hSearchPanel);b.height=18;b.width="100%";b=this._hSearchFormLine=RBuilder.appendTableRow(b);RBuilder.appendTableCell(b).align="center"}function FColumnStatus_onBuild(b){this.__base.FColumnEditControl.onBuild.call(this,b);b=this._hPanel;b.align="center";b.style.width="30px";b.style.height="22px";RBuilder.appendEmpty(b,12,12)}
function FColumnStatus_createCell(b){var f=this.__base.FColumnEditControl.createCell.call(this,b);b&&(b._statusCell=f);return f}function FColumnStatus_onCellClick(b,f){this.table.callEvent("onTableRowDoubleClick",b.row)||RConsole.find(FListenerConsole).process(FGridControl,EGridAction.RowClick,b.row,b.row)}
function FColumnStatus_setDataStatus(b,f){var h=this.table,q=b.getStatus(),u=null;switch(f){case EDataStatus.Insert:u="Insert";break;case EDataStatus.Delete:u="Delete";break;default:u=b.isDataChanged()?"Changed":h.isFormLinked()?"NormalEnter":"Normal"}q.setIcon(this.styleIconPath(u))}function FColumnStatus_ohCellMdclk(){this.lnkCol.table.insertRow(this.lnkRow.rowIndex())}function FColumnStatus_dispose(){this.__base.FColumnEditControl.dispose.call(this);this._hSelect=null}
function FGrid(b){b=RClass.inherits(this,b,FGridControl);b.onResizeAfter=FGrid_onResizeAfter;b.onBuildData=FGrid_onBuildData;b.oeResize=FGrid_oeResize;b.oeRefresh=FGrid_oeRefresh;b.pushColumn=FGrid_pushColumn;return b}function FGrid_onResizeAfter(){var b=this.hDataPanel,f=this.hFixPanel,h=RHtml.scrollWidth(b),q=RHtml.scrollHeight(b);this.hHeadPanel.style.pixelWidth=b.offsetWidth-f.offsetWidth-h;this.hColumnPanel.style.pixelHeight=b.offsetHeight-f.offsetHeight-q+1}
function FGrid_onBuildData(){var b=o.hFixPanel=RBuilder.appendDiv(hbp);b.style.zIndex=2;b.style.position="absolute";var b=o.hFixForm=RBuilder.appendTable(b,null,1),f=RBuilder.append(b,"TBODY");b.style.tableLayout="fixed";b.frame="rhs";b.borderColorLight="#29BAD5";b.borderColorDark="#EEEEEE";o.hFixHead=RBuilder.append(f,"TR");o.hFixSearch=RBuilder.append(f,"TR");b=o.hHeadPanel=RBuilder.appendDiv(hbp);b.style.zIndex=1;b.style.position="absolute";b.style.overflowX="hidden";b.style.width=1;b=o.hHeadForm=
RBuilder.appendTable(b,null,1);b.frame="rhs";b.style.tableLayout="fixed";b.borderColorLight="#29BAD5";b.borderColorDark="#EEEEEE";o.hHead=b.insertRow();o.hSearch=b.insertRow();b=o.hColumnPanel=RBuilder.appendDiv(hbp,o.style("DataPanel"));b.style.zIndex=1;b.style.position="absolute";b.style.overflowY="hidden";b=o.hColumnForm=RBuilder.appendTable(b,o.style("DataForm"),0,0,1);o.hFixRows=RBuilder.append(b,"TBODY");o.hFixRowLine=RBuilder.append(o.hFixRows,"TR");b=o.hDataPanel=RBuilder.appendDiv(hbp,o.style("DataPanel"));
b=o.hDataForm=RBuilder.appendTable(b,o.style("DataForm"),0,0,1);o.hRows=RBuilder.append(b,"TBODY");o.hRowLine=RBuilder.append(o.hRows,"TR");o.attachEvent("onHeadMouseDown",o.hHeadForm,o.onHeadMouseDown);o.attachEvent("onHeadMouseMove",o.hHeadForm,o.onHeadMouseMove);o.attachEvent("onHeadMouseUp",o.hHeadForm,o.onHeadMouseUp);o.attachEvent("onDataScroll",o.hDataPanel,o.onDataScroll)}
function FGrid_oeResize(b){b=this.hPanel;if(b.offsetWidth&&b.offsetHeight){b=this.hTitleForm;var f=this.hFixPanel,h=this.hHeadPanel,q=this.hColumnPanel,u=this.hDataPanel;h.style.display=q.style.display=u.style.display="none";var z=this.hBorderPanel.offsetWidth,A=this.hBorderPanel.offsetHeight;h.style.display=q.style.display=u.style.display="block";h.style.pixelWidth=z-f.offsetWidth;q.style.pixelHeight=A-f.offsetHeight-1-b.offsetHeight;u.style.pixelWidth=z;u.style.pixelHeight=A-b.offsetHeight;this.dpScrollLeft&&
(u.scrollLeft=this.dpScrollLeft,this.dpScrollLeft=null);RConsole.find(FEventConsole).push(this.eventResizeAfter);return EEventStatus.Stop}}
function FGrid_oeRefresh(b){this.base.FGridControl.oeRefresh.call(this,b);if(b.isAfter()){var f=this.hFixPanel,h=this.hHeadPanel,q=this.hColumnPanel,u=this.hDataPanel,z=this.hTitleForm.offsetHeight,A=f.offsetWidth,B=f.offsetHeight;q.style.display=u.style.display="none";b=this.hBorderPanel.offsetWidth;var C=this.hBorderPanel.offsetHeight;q.style.display=u.style.display="block";f.style.pixelTop=z;h.style.pixelTop=z;h.style.pixelLeft=A;h.style.pixelWidth=b-A;h.style.pixelHeight=B;this.hHead.style.pixelHeight=
this.hFixHead.offsetHeight;this.hSearch.style.pixelHeight=this.hFixSearch.offsetHeight;q.style.pixelTop=z+B;q.style.pixelHeight=C-z-B;u.style.paddingLeft=A;u.style.paddingTop=B;u.style.pixelWidth=b;u.style.pixelHeight=C-z;f=null;h=this.columns;for(q=0;q<h.count;q++)if(u=h.value(q),u.isDisplay)if(u.dispAuto){if(f)return RMessage.fatal(this,null,"Too many auto column! (name1={0},name2={1})",f.name,u.name);f=u}else b-=u.hPanel.offsetWidth;f&&f.setWidth(Math.max(b-2,f.width?f.width:120))}}
function FGrid_pushColumn(b){b.dispFixed?(this.hFixHead.appendChild(b.hPanel),this.hFixSearch.appendChild(b.hSearchPanel),this.hFixRowLine.appendChild(b.hFixPanel)):(this.hHead.appendChild(b.hPanel),this.hSearch.appendChild(b.hSearchPanel),this.hRowLine.appendChild(b.hFixPanel));this.push(b)}
function FGridControl(b){b=RClass.inherits(this,b,FContainer);b._displayCount=RClass.register(b,new APtyInteger("_displayCount"),20);b._displayTitle=RClass.register(b,new APtySet("_displayTitle","display_title",EGridDisplay.Title),!0);b._displayColumnStatus=!0;b._displayColumnSelect=!0;b._rowHeight=RClass.register(b,new APtyInteger("rowHeight"),0);b._stylePanel=RClass.register(b,new AStyle("_stylePanel"));b._styleTitlePanel=RClass.register(b,new AStyle("_styleTitlePanel"));b._styleTitleForm=RClass.register(b,
new AStyle("_styleTitleForm"));b._styleCaption=RClass.register(b,new AStyle("_styleCaption"));b._styleContentPanel=RClass.register(b,new AStyle("_styleContentPanel"));b._styleContentForm=RClass.register(b,new AStyle("_styleContentForm"));b._styleHintPanel=RClass.register(b,new AStyle("_styleHintPanel"));b._styleHintForm=RClass.register(b,new AStyle("_styleHintForm"));b._styleHint=RClass.register(b,new AStyle("_styleHint"));b._styleButton=RClass.register(b,new AStyle("_styleButton"));b._minHeight=
80;b._buttons=null;b._columns=null;b._rowClass=FGridRow;b._rows=null;b._focusCell=null;b._focusRow=null;b._loadEvent=null;b._hTitlePanel=null;b._hTitleForm=null;b._hTitleLine=null;b._hCaption=null;b._hContentPanel=null;b._hHintPanel=null;b._hHintForm=null;b.lsnsRowClick=null;b.lsnsRowDblClick=null;b.onBuildTitle=FGridControl_onBuildTitle;b.onBuildContent=RMethod.virtual(b,"onBuildContent");b.onBuildHint=FGridControl_onBuildHint;b.onBuildPanel=FGridControl_onBuildPanel;b.onBuild=FGridControl_onBuild;
b.onDatasetLoadDelay=FGridControl_onDatasetLoadDelay;b.onDatasetLoad=FGridControl_onDatasetLoad;b.construct=FGridControl_construct;b.buildNavigatorButton=FGridControl_buildNavigatorButton;b.appendColumn=RMethod.virtual(b,"appendColumn");b.appendChild=FGridControl_appendChild;b.push=FGridControl_push;b.createRow=FGridControl_createRow;b.insertRow=FGridControl_insertRow;b.syncRow=FGridControl_syncRow;b.hideRows=FGridControl_hideRows;b.clickCell=FGridControl_clickCell;b.clickRow=FGridControl_clickRow;
b.doubleClickRow=FGridControl_doubleClickRow;return b}function FGridControl_onBuildPanel(b){this._hPanel=RBuilder.createTable(b,this.styleName("Panel"))}function FGridControl_onBuildTitle(b){b=this._hTitleForm=RBuilder.appendTable(this._hTitlePanel,this.styleName("TitleForm"));var f=this._hTitleLine=RBuilder.appendTableRow(b);(this._hCaption=RBuilder.appendTableCell(f,this.styleName("Caption"))).innerText=this.label();RHtml.displaySet(b,this._displayTitle)}
function FGridControl_onBuildHint(b){b=RBuilder.appendTableRow(this._hHintForm);var f=RBuilder.appendTableCell(b);f.width=60;this.hExtendButton=this.buildNavigatorButton(f,"control.grid.extend","&nbsp;\u5c55\u5f00",null,"hExtend");f=RBuilder.appendTableCell(b);f.width=60;this.hInsertButton=this.buildNavigatorButton(f,"control.grid.insert","&nbsp;\u65b0\u5efa",null,"hInsert");f=RBuilder.appendTableCell(b);f.width=10;f=RBuilder.appendTableCell(b);f.noWrap=!0;this._hHint=RBuilder.appendText(f,this.styleName("Hint"));
f=RBuilder.appendTableCell(b);f.noWrap=!0;f.align="right";this.hNavFirst=this.buildNavigatorButton(f,"control.grid.first","&nbsp;"+RContext.get("FGridControl:First"));this.hNavPrior=this.buildNavigatorButton(f,"control.grid.prior","&nbsp;"+RContext.get("FGridControl:Prior"));this.hNavPrior.style.paddingRight="20";this.hPage=RBuilder.appendEdit(f);this.hPage.style.width=40;this.hNavNext=this.buildNavigatorButton(f,null,RContext.get("FGridControl:Next")+"&nbsp;","control.grid.next");this.hNavLast=this.buildNavigatorButton(f,
null,RContext.get("FGridControl:Last")+"&nbsp;","control.grid.last")}
function FGridControl_onBuild(b){if(!this._size.height||160>this._size.height)this.height="100%";this.__base.FContainer.onBuild.call(this,b);this._hTitlePanel=RBuilder.appendTableRowCell(this._hPanel,this.styleName("TitlePanel"));this.onBuildTitle(b);this._hContentPanel=RBuilder.appendTableRowCell(this._hPanel,this.styleName("ContentPanel"));this.onBuildContent(b);this._hHintPanel=RBuilder.appendTableRowCell(this._hPanel,this.styleName("HintPanel"));this._hHintForm=RBuilder.appendTable(this._hHintPanel,
this.styleName("HintForm"));this.onBuildHint(b);var f=this._statusColumn=RClass.create(FColumnStatus);f._table=this;f._name="_s";f.build(b);this.push(f);f=this._selectColumn=RClass.create(FColumnSelected);f._table=this;f._name="_select";f.build(b);this.push(f)}
function FGridControl_onDatasetLoadDelay(b){var f=this._rowHeight,h=b.dataset,q=h.count(),u=b.index,z=u+b.acceleration;z>q-1&&(z=q-1);this._hHeadPanel&&(this._hHeadPanel.scrollLeft=0);this._hColumnPanel&&(this._hColumnPanel.scrollTop=0);for(;u<=z;u++){var A=this.syncRow(u);0<f&&(A._hFixPanel.height=f+"px");var B=h.row(u);A.loadRow(B);A.setVisible(!0)}z==q-1?(b.setValid(!1),this.psRefresh()):b.index+=a.acceleration}
function FGridControl_onDatasetLoad(b){this._hColumnPanel&&(this._hColumnPanel.scrollTop=0,this._hColumnPanel.scrollLeft=0);this._hDataPanel&&(this._hDataPanel.scrollTop=0,this._hDataPanel.scrollLeft=0);b.isEmpty()||(b=this._loadEvent,b.index=0,b.acceleration=5,b.dataset=this._dataset,b.setValid(!0),RConsole.find(FEventConsole).push(this._loadEvent))}
function FGridControl_construct(){this.__base.FContainer.construct.call(this);this._buttons=new TDictionary;this._columns=new TDictionary;this._rows=new TObjects;this.lsnsRowClick=new TListeners;this.lsnsRowDblClick=new TListeners;var b=this._loadEvent=RClass.create(FEvent);b.setOwner(this);b.setCallback(this.onDatasetLoadDelay);b.setValid(!1)}
function FGridControl_buildNavigatorButton(b,f,h,q,u){b=RBuilder.append(b,"SPAN",this.styleName("Button"));b.style.cursor="hand";b.style.paddingLeft="10";f&&RBuilder.appendIcon(b,null,f);h&&(u?this[u+"Text"]=RBuilder.appendText(b,null,h):RBuilder.appendText(b,null,h));q&&RBuilder.appendIcon(b,null,q);return b}function FGridControl_appendChild(b){this.__base.FContainer.appendChild.call(this,b);RClass.isClass(b,FColumn)&&this.appendColumn(b)}
function FGridControl_push(b){RClass.isClass(b,FColumn)?(b._table=this,this._columns.set(b.name(),b)):RClass.isClass(b,FTableButton)&&(b._table=this,this._buttons.set(b.name(),b));this.__base.FContainer.push.call(this,b)}function FGridControl_createRow(){var b=RClass.create(this._rowClass);b._table=b._parent=this;return b}
function FGridControl_insertRow(b,f){f.index=b;f.build();f._hFixPanel&&(this._hFixRows.appendChild(f._hFixPanel),RHtml.tableMoveRow(this._hColumnForm,f._hFixPanel.rowIndex,b+2));this._hRows.appendChild(f._hPanel);RHtml.tableMoveRow(this._hContentForm,f._hPanel.rowIndex,b+2);f.refreshStyle();this._rows.insert(b,f)}
function FGridControl_syncRow(b){var f=this._rows,h=f.get(b);if(!h)for(var q=f.count();q<=b;q++)h=this.createRow(),h._index=q,h.build(this._hPanel),h._hFixPanel&&this._hFixRows.appendChild(h._hFixPanel),this._hRows.appendChild(h._hPanel),h._hPanel.style.height=h._hFixPanel.offsetHeight+"px",f.push(h);h._extended=!1;h._childRows&&(h.hideChild(),h._childRows.clear());return h}function FGridControl_hideRows(){for(var b=this._rows,f=b.count()-1;0<=f;f--)b.get(f).setVisible(!1)}
function FGridControl_clickCell(b){this._focusCell=b}function FGridControl_clickRow(b){this.lsnsRowClick.process(b);this._focusRow=b}function FGridControl_doubleClickRow(b){this.lsnsRowDblClick.process(b);this._focusRow=b}function FGridControl_pushButton(b){var f=this._hButtons.insertCell();f.style.border="0 solid #C6D7FF";f.appendChild(b._hPanel);this.push(b)}function FGridControl_onMouseDown(b,f){}
function FGridControl_onHeadMouseDown(b){var f=this.getHeadMode(b);EGridColumn.Size==f&&(this.hoverMode=EGridColumn.Size,b.srcElement.status=EGridColumn.Size,this.hoverX=b.srcElement.offsetLeft+b.x,this.hoverDataCell=null,this._hContentForm._rows.length&&(this.hoverDataCell=this._hContentForm._rows[0].cells[this.hoverHead.index]),this._hHeadForm.setCapture())}
function FGridControl_onHeadMouseMove(b){if(EGridColumn.Size==this.hoverMode)b=b.srcElement.offsetLeft+b.x-this.hoverX+this.hoverCellLength,0<b&&(this.hoverHead._hPanel.style.pixelWidth=b,this.hoverHead._hFixPanel.style.pixelWidth=b);else if(EGridColumn.None==this.hoverMode){b=this.getHeadMode(b);var f="default";EGridColumn.Size==b?f="e-resize":EGridColumn.Drag==b&&(f="hand");this._hHeadForm.style.cursor=f}}
function FGridControl_onHeadMouseUp(b){EGridColumn.Size==this.hoverMode&&this._hHeadForm.releaseCapture();this.hoverMode=EGridColumn.None}function FGridControl_onDataScroll(){this._hHeadPanel.scrollLeft=this._hContentPanel.scrollLeft;this._hColumnPanel.scrollTop=this._hContentPanel.scrollTop}
function FGridControl_onCellKeyDown(b,f,h){var q=f.keyCode,u=b.column;b=b.row;EKey.Up==q?(u.moveCellFocus(b,EPosition.Top),RKey.eventClear(h)):EKey.Down==q?(u.moveCellFocus(b,EPosition.Bottom),RKey.eventClear(h)):EKey.Tab==q&&f.shiftKey?(u.moveCellFocus(b,EPosition.Before),RKey.eventClear(h)):EKey.Tab==q&&(u.moveCellFocus(b,EPosition.After),RKey.eventClear(h))}function FGridControl_onRowMouseEnter(b,f){this.hoverRow(b,!0)}function FGridControl_onRowMouseLeave(b,f){this.hoverRow(b,!1)}
function FGridControl_onRowClick(b,f){this.selectRow(b,!f.ctrlKey,!0);this.lsnsRowClick.process(b);f=this._eventRowClick;f||(f=this._eventRowClick=new TEvent,f.source=this);f.caller=b;f.handle="onTableRowClick";RConsole.find(FFormConsole).processEvent(f)}
function FGridControl_onColumnSearchKeyDown(b,f){EKey.Enter!=f.keyCode||this._isSearching&&this.table._isSearching||(this._isSearching=!0,this.table?(this.table.doSearch(),this.table.dpScrollLeft=this.table._hContentPanel.scrollLeft,this.table.callEvent("onSearchKeyDown",this,this._searchKeyDownEvent)):(this.doSearch(),this.dpScrollLeft=this._hContentPanel.scrollLeft,this.callEvent("onSearchKeyDown",this,this._searchKeyDownEvent)))}
function FGridControl_onButtonMouseDown(b){var f=this.dsViewer;if(f&&0!=f.dataset.pageCount)if(b=b.hSource,this.hInsertButton==b)this.onInsertButtonClick();else if(this.hExtendButton==b)this.onExtendButtonClick();else this.hNavFirst==b&&0!=f.pageIndex?this.dsMovePage(EDataAction.First):this.hNavPrior==b&&0!=f.pageIndex?this.dsMovePage(EDataAction.Prior):this.hNavNext==b&&f.pageIndex!=f.pageCount-1?this.dsMovePage(EDataAction.Next):this.hNavLast==b&&f.pageIndex!=f.pageCount-1&&this.dsMovePage(EDataAction.Last)}
function FGridControl_onPageCountDown(b){var f=this.dsViewer;if(!RString.isEmpty(this.hPage.value)&&f&&0!=f.dataset.pageCount){var h=RInt.parse(this.hPage.value);EKey.Enter==b.keyCode&&h!=f.pageIndex+1&&(1>h&&(h=1),h>f.pageCount&&(h=f.pageCount),this.dsMovePage(h-1))}}function FGridControl_onInsertButtonClick(){RFormSpace.doPrepare(this)}
function FGridControl_onExtendButtonClick(){400==this.dsPageSize?(this.dsPageSize=this.dsPageSizeStore,this.hExtendText.innerText=" \u5c55\u5f00"):(this.dsPageSizeStore=this.dsPageSize,this.dsPageSize=400,this.hExtendText.innerText=" \u6536\u7f29");this.dsSearch()}function FGridControl_oeMode(b){this.dispDelete=this.dispUpdate=!0;this.__base.FContainer.oeMode.call(this,b);this.__base.MDisplay.oeMode.call(this,b);this._editable=this.canEdit(b.mode);return EEventStatus.Stop}
function FGridControl_oeProgress(b){if("none"!=this._hPanel.currentStyle.display){var f=this._hDelayPanel;if(!f){var f=this._hDelayPanel=RBuilder.appendDiv(this.hBorderPanel),h=f.style;h.position="absolute";h.zIndex=RLayer.next();h.filter="progid:DXImageTransform.Microsoft.Alpha(opacity=100)";h.backgroundColor="#FFFFFF";h.top=0;h.width="100%";h.height="100%";h.display="none";h=this._hDelayForm=RBuilder.appendTable(f);h.style.width="100%";h.style.height="100%";h=h.insertRow().insertCell();h.align=
"center";h.vAlign="middle";RBuilder.appendIcon(h,"ctl.FGridControl_Loading");(this._hDelayText=RBuilder.append(h,"SPAN")).innerHTML="<BR><BR><FONT color='red'><B>"+RContext.get("FGridControl:Loading")+"</B></FONT>"}b.enable?(RHtml.setRect(f,this.calculateDataSize()),f.filters[0].opacity=100,f.style.display="block"):this._loadFinish&&(f.style.display="none");this.refreshHint();return EEventStatus.Stop}}function FGridControl_isFormLinked(){return this._formLinked||this._formName}
function FGridControl_isDataSelected(){for(var b=this._rows,f=b.count-1;0<=f;f--)if(b.get(f).isSelect)return!0}function FGridControl_isDataChanged(){for(var b=this._rows,f=b.count-1;0<=f;f--)if(b.get(f).isDataChanged())return!0}function FGridControl_hasAction(){for(var b=this.components,f=b.count,h=0;h<f;h++){var q=b.value(h);if(RClass.isClass(q,FDataAction))return this.isDataSelected()}}
function FGridControl_getFormLink(b){if(EFormLink.Form==b)return this._formName;if(EFormLink.Table==b)return this.name;RMessage.fatal(this,null,"Form link is invalid. (type={0})",b)}function FGridControl_getHeadMode(b){}function FGridControl_getRowBar(){var b=this._rowBar;b||(b=this._rowBar=RClass.create(FGridRowBar),b.table=this,b.psBuild(this.hBorderPanel));return b}
function FGridControl_calculateDataSize(){var b=this._dataRect;b||(b=this._dataRect=new TRect);var f=this.hTitleForm?this.hTitleForm.offsetHeight:0,h=this._hFixPanel?this._hFixPanel.offsetHeight:0;b.left=0;b.top=h+f;b.setWidth(this.hBorderPanel.offsetWidth);b.setHeight(this.hBorderPanel.offsetHeight-f-h);return b}function FGridControl_hasVisibleRow(){for(var b=this._rows,f=0;f<b.count;f++)if(b.get(f)._visible)return!0;return!1}
function FGridControl_getCurrentRow(){var b=this._focusCell;if(b)return b.row.saveRow()}function FGridControl_getSelectedRow(){for(var b=this._rows,f=b.count,h=0;h<f;h++){var q=b.get(h);if(q.isSelect)return q}}function FGridControl_getSelectedRows(){for(var b=new TList,f=this._rows,h=f.count,q=0;q<h;q++){var u=f.get(q);u.isSelect&&u.isVisible()&&b.push(u.saveRow())}return b}
function FGridControl_getChangedRows(){for(var b=new TList,f=this._rows,h=f.count,q=0;q<h;q++){var u=f.get(q);u.isVisible()&&u.isDataChanged()&&b.push(u.saveRow())}return b}function FGridControl_getRows(){for(var b=new TList,f=this._rows,h=f.count,q=0;q<h;q++){var u=f.get(q);u.isVisible()&&b.push(u.saveRow())}return b}
function FGridControl_refreshHint(){var b=this._hHint,f=this._dataset;if(f&&b){var h=0,q=this.getSelectedRow();q&&(h=this._rows.indexOf(q)+1);b.innerHTML="\u5171<FONT color='red' style='font-weight:BOLD '>"+f.pageCount+"</FONT>\u9875<FONT color='red' style='font-weight:BOLD '>"+f.total+"</FONT>\u6761\u8bb0\u5f55\uff0c\u5f53\u524d\u9009\u4e2d\u7b2c<FONT color='red' style='font-weight:BOLD '>"+(f.pageIndex+1)+"</FONT>\u9875\u7b2c<FONT color='red' style='font-weight:BOLD '>"+h+"</FONT>\u6761\u8bb0\u5f55";
this.hPage.value=f.pageIndex+1}}function FGridControl_refreshSelected(){this._columns.get("_select").hSelected.checked=!1;for(var b=this._rows,f=b.count,h=0;h<f;h++)b.get(h).isSelect=!1}function FGridControl_hoverRow(b,f){f?this._hoverRow=b:this._hoverRow==b&&(this._hoverRow=null);b.refreshStyle()}function FGridControl_selectRow(b,f,h){var q=!1;if(f){f=this._rows;for(var u=f.count,z=0;z<u;z++){var A=f.get(z);A!=b&&A.isSelect&&(A.select(!1),q=!0)}}b.select(q||!b.isSelect||h);this.refreshHint()}
function FGridControl_clearSelectRow(b){b.select(!1);this.refreshHint()}function FGridControl_clearSelectRows(){for(var b=this._rows,f=0;f<b.count;f++)b.get(f).isSelect=!1;this.refreshHint()}function FGridControl_setDataStatus(b,f){b.dataStatus=f;this._statusColumn.setDataStatus(b,f)}function FGridControl_dsInsert(){}function FGridControl_dsUpdate(b){this.psMode(EMode.Update);this.dsFetch(!0)}function FGridControl_dsDelete(){}
function FGridControl_doSearch(){this.dsSearchs.clear();for(var b=this._columns,f=0;f<b.count;f++){var h=b.value(f),q=h.searchValue();if(RClass.isClass(h,FColumnCalendar)){if(q){var u=new TSearchItem;u.set(h.dataName,q.value,ESearch.Date,q.format);this.dsSearchs.push(u)}}else RString.isEmpty(q)||(u=new TSearchItem,u.set(h.dataName,q,ESearch.Like),this.dsSearchs.push(u))}this.dsValues=this.toDeepAttributes();this.dsSearch()}
function FGridControl_focus(){RConsole.find(FFocusConsole).focusClass(MDataset,this)}function FGridControl_pack(){for(var b=this._rows,f=b.count,h=new TNode("Dataset"),q=0;q<f;q++){var u=b.get(q);u.isDataChanged()&&(u=u.toAttrs(),u=new TNode("Row",u),h.push(u))}return h}function FGridControl_setVisible(b){this.__base.FContainer.setVisible.call(this,b);this.__base.MUiHorizontal.setVisible.call(this,b)}function FGridControl_setButtonVisible(b,f){var h=this._buttons.get(b);h&&h.setVisible(f)}
function FGridControl_refreshStyle(){for(var b=this._rows,f=b.count,h=0;h<f;h++)b.get(h).refreshStyle()}
function FGridControl_dispose(){this.__base.FContainer.dispose.call(this);this._hExtendText=this._hExtendButton=this._hInsertButton=this._hHintForm=this._hRowLine=this._hRows=this._hContentForm=this._hContentPanel=this._hFixRowLine=this._hFixRows=this._hColumnForm=this._hColumnPanel=this._hSearch=this._hHead=this._hHeadForm=this._hHeadPanel=this._hFixSearch=this._hFixHead=this._hFixForm=this._hFixPanel=this._hDelayForm=this._hDelayPanel=this.hBorderPanel=null}
function FGridControl_dump(b){b=RString.nvlStr(b);b.appendLine(RClass.name(this));for(var f=this._rows,h=0;h<f.count;h++)b.appendLine(f.get(h).dump());return b}function FGridControl_storeValues(b){b||(b=new TAttributes);var f=this.getSelectRows();f.count&&(1!=f.count&&RMessage.fatal(this,"Invalid selected rows. (count={0})",f.count),f.get(0).toAttributes(b));return b}function FGridControl_buildRows(){}
function FGridControl_createChild(b){var f=this.__base.FContainer.createChild.call(this,b);if(RClass.isClass(f,FGridRow))return f.table=this,f.row=this.dsLoadRowNode(b),this._rows.push(f),null;RClass.isClass(f,FColumnEditControl)&&(f.table=this);return f}function FGridControl_setStyleStatus(b,f){if(b._hPanel)switch(f){case EStyle.Normal:b.select(!1);break;case EStyle.Select:b.select(!0)}}
function FGridControl_buildRow(b){for(var f=this._columns,h=0;h<f.count;h++){var q=f.value(h),u=q.createCell(b);q.dataName&&u.set(RString.nvl(b.get(q.dataName),q.dataDefault));b.push(u)}return b}function FGridControl_clearSelectAll(){this._columns.get("_select").hSelected.checked=!1}function FGridControl_appendRow(b){this._hRows.appendChild(b._hRow);this._rows.push(b)}
function FGridControl_deleteRow(b){b=RObject.nvl(b,this.selectedRow);if(!b)return alert("Please select row.");b.isExist()?b.isDelete()?(b.doNormal(),this.setDataStatus(b,EDataStatus.Unknown),this.setStyleStatus(b,EStyle.Select)):(b.doDelete(),this.setDataStatus(b,EDataStatus.Delete),this.setStyleStatus(b,EStyle.Delete)):b.release()}function FGridControl_clearRows(){for(var b=this._rows.count,f=0;f<b;f++){var h=this._rows.get(f);h&&h.dispose()}this._rows.clear();RHtml.clear(this._hRows)}
function FGridControl_onColumnTreeService(b){if((b=b.resultDatasets.get(b.path)._rows)&&0<b.count){var f=this.focusRow;f.extdStatus=!0;f.psResize();for(var h=f._hPanel.rowIndex+1,q=0;q<b.count;q++){var u=RClass.create(FGridRow);u.table=this;f.childRows.push(u);u.parentRow=f;u.buildChild(this._hFixRows,this._hRows,h+q);u.loadRow(b.get(q))}}}function FGridControl_getRowType(){for(var b=this.components,f=b.count,h=0;h<f;h++){var q=b.value(h);if(RClass.isClass(q,FGridRowType))return q}}
function FGridControl_onColumnTreeClick(b,f){if(this.getRowType()){var h=b.row;if(h.childRows&&0<h.childRows.count)h.extended?h.hideChild():h.showChild(),h.extended=!h.extended,b.hImg.src=h.extended?b.styleIconPath("Fold",FColumnTree):b.styleIconPath("Expend",FColumnTree);else if(this.focusRow=b.row,"Y"==this.focusRow.row.get("ochd")){b.row.extended=!0;b.hImg.src=b.styleIconPath("Fold",FColumnTree);var h=b.row.get("otyp"),q=b.row.table.component(h),u=this.topControl(MDataset),h=new TDatasetFetchArg(u.name,
u.formId,u.dsPageSize,u.dsPageIndex,null,null,this.fullPath(),q.formResearch);u.dsSearchs.clear();if(q&&q.formWhere){var z=new TSearchItem;z.set(q.dataName,q.formWhere,ESearch.Source);u.dsSearchs.push(z)}h.force=!0;h.reset=!0;h.searchs=u.dsSearchs;q=new TAttributes;b.row.toDeepAttributes(q);h.values=q;h.callback=new TInvoke(this,this.onColumnTreeService);RConsole.find(FDatasetConsole).fetch(h)}}}
function FGridRow(b){b=RClass.inherits(this,b,FGridRowControl);b._hFixPanel=null;b.onBuildPanel=FGridRow_onBuildPanel;b.setVisible=FGridRow_setVisible;b.appendChild=FGridRow_appendChild;b.dispose=FGridRow_dispose;return b}function FGridRow_onBuildPanel(b){this.__base.FGridRowControl.onBuildPanel.call(this,b);this._hFixPanel=RBuilder.createTableRow(b,this.styleName("Panel"))}
function FGridRow_setVisible(b){this._visible=b;var f=this._hFixPanel;f&&RHtml.displaySet(f,b);(f=this._hPanel)&&RHtml.displaySet(f,b)}function FGridRow_appendChild(b){this.__base.FGridRowControl.appendChild.call(this,b);b._column._optionFixed&&this._hFixPanel.appendChild(b._hPanel)}function FGridRow_dispose(){var b=this._hFixPanel;b&&(RMemory.free(b),this._hFixPanel=null);this.__base.FGridRowControl.dispose.call(this)}
function FGridRow_select(b){b=(this.isSelect=b)?EColor.RowSelect:EColor.Row;this._hFixPanel.style.backgroundColor=b;this.hPanel.style.backgroundColor=b;this.refreshStyle()}function FGridRow_refreshSize(){this.hPanel.style.pixelHeight=this._hFixPanel.offsetHeight}
function FGridRow_refreshStyle(){this.hPanel.offsetHeight>this._hFixPanel.offsetHeight?this._hFixPanel.style.pixelHeight=this.hPanel.offsetHeight:this.hPanel.style.pixelHeight=this._hFixPanel.offsetHeight;this.table.isLov&&(this._hFixPanel.style.cursor="hand");this.__base.FGridRowControl.refreshStyle.call(this)}
function FGridRowControl(b){b=RClass.inherits(this,b,FContainer,MDataContainer);b._cells=null;b._rows=null;b._clearProcess=null;b._resetProcess=null;b._loadProcess=null;b._saveProcess=null;b._recordProcess=null;b._statusCell=null;b.onBuildPanel=FGridRowControl_onBuildPanel;b.onBuild=FGridRowControl_onBuild;b.construct=FGridRowControl_construct;b.loadRow=FGridRowControl_loadRow;b.saveRow=FGridRowControl_saveRow;b.setVisible=FGridRowControl_setVisible;b.appendChild=FGridRowControl_appendChild;b.push=
FGridRowControl_push;return b}function FGridRowControl_onBuildPanel(b){this._hPanel=RBuilder.createTableRow(b,this.styleName("Panel"))}function FGridRowControl_onBuild(b){this.__base.FContainer.onBuild.call(this,b);b=this._table._columns;for(var f=b.count(),h=0;h<f;h++){var q=b.value(h).createCell();this.push(q)}}
function FGridRowControl_construct(){this.__base.FContainer.construct.call(this);this._cells=new TDictionary;this._rows=new TObjects;this._clearProcess=new TEventProcess(null,this,"oeClearValue",MEditValue);this._resetProcess=new TEventProcess(null,this,"oeResetValue",MEditValue);this._loadProcess=new TEventProcess(null,this,"oeLoadValue",MEditValue);this._saveProcess=new TEventProcess(null,this,"oeSaveValue",MEditValue);this._recordProcess=new TEventProcess(null,this,"oeRecordValue",MEditValue)}
function FGridRowControl_loadRow(b){var f=RClass.create(FDataSource);f.selectRow(b);this.dsDataLoad(f)}function FGridRowControl_saveRow(b){return r}function FGridRowControl_setVisible(b){this._visible=b;var f=this._hPanel;f&&RHtml.displaySet(f,b)}function FGridRowControl_appendChild(b){this.__base.FContainer.appendChild.call(this,b);b._column._optionFixed||this._hPanel.appendChild(b._hPanel)}
function FGridRowControl_push(b){this.__base.FContainer.push.call(this,b);b._row=this;this._cells.set(b._column._dataName,b);RClass.isClass(b,FCellStatus)&&(this._statusCell=b)}
function FGridRowControl_buildChildren(){var b=this.hFixPanel=hfp.insertRow(idx);b.className=this.style("Panel");var f=this._hPanel=hp.insertRow(idx);f.className=this.style("Panel");for(var h=this.table.columns,q=h.count,u=0;u<q;u++){var z=h.value(u),A=z.createCell(this);z.dispFixed?b.appendChild(A._hPanel):f.appendChild(A._hPanel);this._cells.set(z.dataName,A)}this.doRefresh()}
function FGridRowControl_isDataChanged(){for(var b=this._cells,f=b.count-1;0<=f;f--)if(b.value(f).isDataChanged())return!0;return!1}function FGridRowControl_isVisible(){return this._visible}function FGridRowControl_getIndex(){return this._hPanel.rowIndex}function FGridRowControl_getId(){var b=this._cells.get("ouid");return b?b.reget():""}function FGridRowControl_getVersion(){var b=this._cells.get("over");return b?b.reget():""}function FGridRowControl_getStatus(){return this._statusCell}
function FGridRowControl_cell(b){return this._cells.value(b)}function FGridRowControl_get(b){return this._cells.get(b).get()}function FGridRowControl_reget(b){return this._cells.get(b).reget()}function FGridRowControl_set(b,f){this._cells.get(b).set(f)}function FGridRowControl_loadValue(b){this.loadRow(b)}function FGridRowControl_saveValue(b){this.saveRow(b)}function FGridRowControl_recordValue(){this.process(this._recordProcess)}function FGridRowControl_toAttributes(b){this.saveRow(b)}
function FGridRowControl_toDeepAttributes(b){for(var f=new TList,h=this.table;h;){h!=this.table&&RClass.isClass(h,MDataset)&&f.push(h);if(!h.parent)break;h=h.topControl(MDataset)}for(h=f.count-1;0<=h;h--){var q=f.get(h);if(RClass.isClass(q,FForm))q.toAttributes(b);else if(RClass.isClass(q,FTable)){q=q.getSelectRows();if(1!=q.count)return RMessage.fatal(this,"Invalid selected rows. (count={0})",q.count);q.get(0).toAttributes(b)}}this.toAttributes(b)}
function FGridRowControl_select(b){this.isSelect=b;this._hPanel.style.backgroundColor=b?EColor._rowselect:EColor.Row;this.refreshStyle()}function FGridRowControl_extend(b){var f=this._rows;if(f&&f.count)for(var h=f.count,q=0;q<h;q++){var u=f.get(q);b?(u.setVisible(!0),u.extend(u.extended)):u.setVisible(!1);u.refresh()}this.extended=b}function FGridRowControl_doInsert(){this.row||(this.row=new TRow);this.status=ERowStatus.Insert;this.table.setDataStatus(this,ERowStatus.Insert)}
function FGridRowControl_doDelete(){this.status=ERowStatus.Delete;this.table.setDataStatus(this,ERowStatus.Delete)}function FGridRowControl_refresh(){this.table.setDataStatus(this,this.isDataChanged()?ERowStatus.Changed:ERowStatus.Normal)}function FGridRowControl_refreshStyle(){var b=this._cells;if(b)for(var f=b.count-1;0<=f;f--)b.value(f).refreshStyle()}
function FGridRowControl_dump(b){b=RString.nvlStr(b);b.append(RClass.dump(this),"[");b.append(this.isSelect?"S":"_");b.append("]");b.append(this.saveRow().dump());return b}
function FTable(b){b=RClass.inherits(this,b,FGridControl,MDataset);b._detailFrameName=RClass.register(b,new APtyString("_detailFrameName"));b._styleFixPanel=RClass.register(b,new AStyle("_styleFixPanel"));b._styleFixForm=RClass.register(b,new AStyle("_styleFixForm"));b._styleHeadPanel=RClass.register(b,new AStyle("_styleHeadPanel"));b._styleHeadForm=RClass.register(b,new AStyle("_styleHeadForm"));b._styleColumnPanel=RClass.register(b,new AStyle("_styleColumnPanel"));b._styleColumnForm=RClass.register(b,
new AStyle("_styleColumnForm"));b._styleDataPanel=RClass.register(b,new AStyle("_styleDataPanel"));b._styleDataForm=RClass.register(b,new AStyle("_styleDataForm"));b._hFixPanel=null;b._hFixForm=null;b._hHeadPanel=null;b._hHeadForm=null;b._hColumnPanel=null;b._hColumnForm=null;b._hDataPanel=null;b._hDataForm=null;b.onBuildContent=FTable_onBuildContent;b.oeRefresh=FTable_oeRefresh;b.appendColumn=FTable_appendColumn;return b}
function FTable_onBuildContent(b){b=this._hContentPanel;var f=this._hFixPanel=RBuilder.appendDiv(b,this.styleName("FixPanel"));f.style.zIndex=2;f.style.position="absolute";f=this._hFixForm=RBuilder.appendTable(f,this.styleName("FixForm"),0,0,1);f.borderColorLight="#D0D0D0";f.borderColorDark="#EEEEEE";this._hFixHead=RBuilder.appendTableRow(f);this._hFixSearch=RBuilder.appendTableRow(f);this._hFixTotal=RBuilder.appendTableRow(f);this._hFixTotal.style.display="none";f=this._hHeadPanel=RBuilder.appendDiv(b,
this.styleName("HeadPanel"));f.style.zIndex=1;f.style.position="absolute";f.style.overflowX="hidden";f.style.width=1;f=this._hHeadForm=RBuilder.appendTable(f,this.styleName("HeadForm"),0,0,1);f.frame="rhs";f.style.tableLayout="fixed";f.borderColorLight="#D0D0D0";f.borderColorDark="#EEEEEE";this._hHead=f.insertRow();this._hSearch=f.insertRow();this._hTotal=f.insertRow();this._hTotal.style.display="none";f=this._hColumnPanel=RBuilder.appendDiv(b,this.styleName("ColumnPanel"));f.style.zIndex=1;f.style.position=
"absolute";f.style.overflowY="hidden";f=this._hColumnForm=RBuilder.appendTable(f,this.styleName("ColumnForm"),0,0,1);this._hFixRows=RBuilder.append(f,"TBODY");this._hFixRowLine=RBuilder.append(this._hFixRows,"TR");b=this._hDataPanel=RBuilder.appendDiv(b,this.styleName("DataPanel"));b.width="100%";b.height="100%";b=this._hDataForm=RBuilder.appendTable(b,this.styleName("DataForm"),0,0,1);this._hRows=RBuilder.append(b,"TBODY");this._hRowLine=RBuilder.append(this._hRows,"TR");this.panelNavigator=!0}
function FTable_oeRefresh(b){this.__base.FGridControl.oeRefresh.call(this,b);if(b.isAfter()){b=this._hFixPanel;var f=this._hHeadPanel,h=this._hColumnPanel,q=this._hDataPanel,u=b.offsetWidth,z=b.offsetHeight;h.style.display=q.style.display="none";var A=this._hContentPanel.offsetWidth,B=this._hContentPanel.offsetHeight;h.style.display=q.style.display="block";b.style.left="0px";b.style.top="0px";f.style.left=u+"px";f.style.top="0px";f.style.width=A-u+"px";this._hHead.style.height=this._hFixHead.offsetHeight+
"px";this._hSearch.style.height=this._hFixSearch.offsetHeight+"px";h.style.top=z+"px";h.style.width=u+"px";h.style.height=B-z+"px";q.style.left="0px";q.style.top="0px";q.style.width=A-u+"px";q.style.height=B-z+"px";q.style.paddingLeft=u;q.style.paddingTop=z}}
function FTable_appendColumn(b){b._optionFixed?(this._hFixHead.appendChild(b._hPanel),this._hFixSearch.appendChild(b._hSearchPanel),this._hFixTotal.appendChild(b._hTotalPanel),this._hFixRowLine.appendChild(b._hFixPanel)):(this._hHead.appendChild(b._hPanel),this._hSearch.appendChild(b._hSearchPanel),this._hTotal.appendChild(b._hTotalPanel),this._hRowLine.appendChild(b._hFixPanel))}
function FTable_onResizeAfter(){var b=this._hDataPanel,f=this._hFixPanel,h=RHtml.scrollWidth(b),q=RHtml.scrollHeight(b);this._hHeadPanel.style.pixelWidth=b.offsetWidth-f.offsetWidth-h;this._hColumnPanel.style.pixelHeight=b.offsetHeight-f.offsetHeight-q+1}
function FTable_oeResize(b){b=this._hPanel;if(b.offsetWidth&&b.offsetHeight){var f=this._hTitleForm,h=this._hFixPanel,q=this._hHeadPanel,u=this._hColumnPanel;b=this._hDataPanel;q.style.display=u.style.display=b.style.display="none";var z=this._hBorderPanel.offsetWidth,A=this._hBorderPanel.offsetHeight;q.style.display=u.style.display=b.style.display="block";q.style.pixelWidth=z-h.offsetWidth;u.style.pixelHeight=A-h.offsetHeight-1-f.offsetHeight;b.style.pixelWidth=z;b.style.pixelHeight=A-f.offsetHeight;
f=this.rows.count;for(h=0;h<f;h++)this.rows.get(h).refreshSize();this.dpScrollLeft&&(b.scrollLeft=this.dpScrollLeft,this.dpScrollLeft=null);RConsole.find(FEventConsole).push(this.eventResizeAfter);return EEventStatus.Stop}}function MUiMenuButton(b){return b=RClass.inherits(this,b)}
function FUiMenuBar(b){b=RClass.inherits(this,b,FUiContainer,MDescribeFrame);b._mergeCd=RClass.register(b,new APtyEnum("_mergeCd",null,EUiMerge,EUiMerge.Override));b._stylePanel=RClass.register(b,new AStyle("_stylePanel"));b._styleButtonPanel=RClass.register(b,new AStyle("_styleButtonPanel"));b._hLine=null;b.onBuildPanel=FUiMenuBar_onBuildPanel;b.onEnter=RMethod.empty;b.onLeave=RMethod.empty;b.appendChild=FUiMenuBar_appendChild;b.removeChild=FUiMenuBar_removeChild;b.dispose=FUiMenuBar_dispose;return b}
function FUiMenuBar_onBuildPanel(b){b=this._hPanel=RBuilder.createTable(b,this.styleName("Panel"));this._hLine=RBuilder.appendTableRow(b)}function FUiMenuBar_appendChild(b){this.__base.FUiContainer.appendChild.call(this,b);if(RClass.isClass(b,FUiMenuButton)){var f=this._hLine,h=RBuilder.appendTableCell(f,this.styleName("ButtonPanel"));h._hParentLine=f;b.setPanel(h)}}
function FUiMenuBar_removeChild(b){RClass.isClass(b,FUiMenuButton)&&(b._hParentLine.removeChild(b._hParent),b._hParentLine=null,b._hParent=null);this.__base.FUiContainer.removeChild.call(this,b)}function FUiMenuBar_dispose(){this._hLine=RHtml.free(this._hLine);this.__base.FUiContainer.dispose.call(this)}
function FUiMenuButton(b){b=RClass.inherits(this,b,FUiControl,MUiMenuButton,MListenerClick);b._icon=RClass.register(b,new APtyString("_icon"));b._iconDisable=RClass.register(b,new APtyString("_iconDisable"));b._hotkey=RClass.register(b,new APtyString("_hotkey"));b._action=RClass.register(b,new APtyString("_action"));b._styleNormal=RClass.register(b,new AStyle("_styleNormal"));b._styleHover=RClass.register(b,new AStyle("_styleHover"));b._stylePress=RClass.register(b,new AStyle("_stylePress"));b._styleDisable=
RClass.register(b,new AStyle("_styleDisable"));b._styleIconPanel=RClass.register(b,new AStyle("_styleIconPanel"));b._styleSpacePanel=RClass.register(b,new AStyle("_styleSpacePanel"));b._styleLabelPanel=RClass.register(b,new AStyle("_styleLabelPanel"));b._disabled=!1;b._hForm=null;b._hLine=null;b._hIconPanel=null;b._hIcon=null;b._hSpacePanel=null;b._hLabelPanel=null;b.onBuildPanel=FUiMenuButton_onBuildPanel;b.onBuild=FUiMenuButton_onBuild;b.onEnter=FUiMenuButton_onEnter;b.onLeave=FUiMenuButton_onLeave;
b.onMouseDown=RClass.register(b,new AEventMouseDown("onMouseDown"),FUiMenuButton_onMouseDown);b.onMouseUp=RClass.register(b,new AEventMouseDown("onMouseUp"),FUiMenuButton_onMouseUp);b.icon=FUiMenuButton_icon;b.setIcon=FUiMenuButton_setIcon;b.setLabel=FUiMenuButton_setLabel;b.setHint=FUiMenuButton_setHint;b.setEnable=FUiMenuButton_setEnable;b.click=FUiMenuButton_click;b.dispose=FUiMenuButton_dispose;return b}
function FUiMenuButton_onBuildPanel(b){this._hPanel=RBuilder.createDiv(b,this.styleName("Normal"))}
function FUiMenuButton_onBuild(b){this.__base.FUiControl.onBuild.call(this,b);b=this._hPanel;this.attachEvent("onMouseDown",b);this.attachEvent("onMouseUp",b);b=this._hForm=RBuilder.appendTable(b);b=this._hLine=RBuilder.appendTableRow(b);if(this._icon){var f=this._hIconPanel=RBuilder.appendTableCell(b,this.styleName("IconPanel"));this._hIcon=RBuilder.appendIcon(f,null,this._icon)}this._icon&&this._label&&(this.hSpacePanel=RBuilder.appendTableCell(b,this.styleName("SpacePanel")));this._label&&((this._hLabelPanel=
RBuilder.appendTableCell(b,this.styleName("LabelPanel"))).noWrap=!0,this.setLabel(this._label));this._hotkey&&RConsole.find(FKeyConsole).register(this._hotkey,this,this.onMouseDown);this._hint&&this.setHint(this._hint)}function FUiMenuButton_onEnter(b){this._disabled||(this._hPanel.className=this.styleName("Hover"))}function FUiMenuButton_onLeave(){this._disabled||(this._hPanel.className=this.styleName("Normal"))}
function FUiMenuButton_onMouseDown(){this._disabled||(this._hPanel.className=this.styleName("Press"),this.click())}function FUiMenuButton_onMouseUp(){this._disabled||(this._hPanel.className=this.styleName("Hover"))}function FUiMenuButton_icon(){return this._icon}function FUiMenuButton_setIcon(b){this._icon=b;this._hIcon&&(this._hIcon.src=this.styleIconPath(this._icon))}function FUiMenuButton_setLabel(b){this._label=b=RString.nvl(b);RHtml.textSet(this._hLabelPanel,b)}
function FUiMenuButton_setHint(b){this._hint=b;RString.nvl(b);this._hPanel.title=this._hint}function FUiMenuButton_setEnable(b){this.__base.FUiControl.setEnable.call(this,b);b?(this._hPanel.className=this.style("Button"),this._iconDisable&&this._icon&&(this._hIcon.src=RRes._iconPath(this._icon))):(this._hPanel.className=this.style("Disable"),this._iconDisable&&(this._hIcon.src=RRes._iconPath(this._iconDisable)))}function FUiMenuButton_click(){this._disabled||this.processClickListener(this)}
function FUiMenuButton_dispose(){this._hForm=RHtml.free(this._hForm);this._hLine=RHtml.free(this._hLine);this._hIconPanel=RHtml.free(this._hIconPanel);this._hIcon=RHtml.free(this._hIcon);this._hSpacePanel=RHtml.free(this._hSpacePanel);this._hLabelPanel=RHtml.free(this._hLabelPanel);this.__base.FUiControl.dispose.call(this)}
function FUiMenuButtonMenu(b){b=RClass.inherits(this,b,FUiControl);b._action=RClass.register(b,new APtyString("action",null));b._target=RClass.register(b,new APtyString("target",null));b._page=RClass.register(b,new APtyString("page"));b._hotkey=RClass.register(b,new APtyString("hotkey"));b._method=RClass.register(b,new APtyString("method"));b._icon=RClass.register(b,new APtyString("icon",null));b._iconDisable=RClass.register(b,new APtyString("iconDisable",null));b._attributes=RClass.register(b,new APtyString("attributes"));
b._disabled=!1;b.hButton=null;b.hButtonLine=null;b.hButtonPanel=null;b.hIcon=null;b.hText=null;b.oeBuild=FUiMenuButtonMenu_oeBuild;b.oeEnable=FUiMenuButtonMenu_oeEnable;b.oeDisable=FUiMenuButtonMenu_oeDisable;b.onBuildPanel=FUiMenuButtonMenu_onBuildPanel;b.onEnter=FUiMenuButtonMenu_onEnter;b.onLeave=FUiMenuButtonMenu_onLeave;b.onMouseDown=FUiMenuButtonMenu_onMouseDown;b.onMouseUp=FUiMenuButtonMenu_onMouseUp;b.onClick=FUiMenuButtonMenu_onClick;b.construct=FUiMenuButtonMenu_construct;b.dispose=FUiMenuButtonMenu_dispose;
return b}function FUiMenuButtonMenu_oeBuild(b){this.base.FUiControl.oeBuild.call(this,b);this.hButton=RBuilder.appendTable(this.hPanel,this.style("Button"));this.linkClickEvent(this.hButton);b=(this.hButtonLine=this.hButton.insertRow()).insertCell();this._icon&&(this.hIcon=RBuilder.appendIcon(b,this._icon));this.label&&(this.hLabel=RBuilder.appendText(b,(this.hIcon?"&nbsp;":"")+this.label),this.hLabel.className=this.style("Label"));return EEventStatus.Stop}
function FUiMenuButtonMenu_onBuildPanel(){this.hPanel=RBuilder.create(null,"DIV")}function FUiMenuButtonMenu_oeEnable(b){this.base.FUiControl.oeEnable.call(this,b);this.hPanel.className=this.style("Button");this._iconDisable&&this._icon&&(this.hIcon.src=RRes._iconPath(this._icon));return EEventStatus.Stop}
function FUiMenuButtonMenu_oeDisable(b){this.base.FUiControl.oeDisable.call(this,b);this.hPanel.className=this.style("Disable");this._iconDisable&&(this.hIcon.src=RRes._iconPath(this._iconDisable));return EEventStatus.Stop}function FUiMenuButtonMenu_onEnter(){this._disabled||(this.hPanel.className=this.style("Hover"))}function FUiMenuButtonMenu_onLeave(){this._disabled||(this.hPanel.className=this.style("Panel"))}
function FUiMenuButtonMenu_onMouseDown(){this._disabled||(this.hPanel.className=this.style("Press"))}function FUiMenuButtonMenu_onMouseUp(){this._disabled||(this.hPanel.className=this.style("Hover"))}
function FUiMenuButtonMenu_onClick(){if(!this._disabled){RConsole.find(FFocusConsole).focus(this);this._action&&eval(this._action);if(this._page||this._method){var b=RHtml.form(this.hButton),f=RPage.parse(this._page);this._method&&(f._action=this._method);f.split(this._attributes);f.post(b,this._target)}this.processClick()}}function FUiMenuButtonMenu_construct(){this.base.FUiControl.construct.call(this)}
function FUiMenuButtonMenu_dispose(){this.base.FUiControl.dispose.call(this);RMemory.freeHtml(this.hPanel);RMemory.freeHtml(this.hButton);this.hLabel=this.hButtonLine=this.hButton=this.hIcon=this.hPanel=null}function FUiMenuButtonSplit(b){b=RClass.inherits(this,b,FUiControl,MUiMenuButton);b._stylePanel=RClass.register(b,new AStyle("_stylePanel"));b.onBuild=FUiMenuButtonSplit_onBuild;return b}
function FUiToolButtonSplit_onBuild(b){this.__base.FUiControl.onBuild.call(this,b);this._hPanel.className=this.styleName("Panel")}function MUiToolButton(b){return b=RClass.inherits(this,b)}
function FUiToolBar(b){b=RClass.inherits(this,b,FUiContainer,MDescribeFrame);b._alignCd=RClass.register(b,new APtyEnum("_alignCd",null,EUiAlign,EUiAlign.Left));b._directionCd=RClass.register(b,new APtyEnum("_directionCd",null,EUiDirection,EUiDirection.Horizontal));b._mergeCd=RClass.register(b,new APtyEnum("_mergeCd",null,EUiMerge,EUiMerge.Override));b._stylePanel=RClass.register(b,new AStyle("_stylePanel"));b._styleButtonPanel=RClass.register(b,new AStyle("_styleButtonPanel"));b._hLine=null;b.onBuildPanel=
FUiToolBar_onBuildPanel;b.onEnter=RMethod.empty;b.onLeave=RMethod.empty;b.appendChild=FUiToolBar_appendChild;b.removeChild=FUiToolBar_removeChild;b.dispose=FUiToolBar_dispose;return b}function FUiToolBar_onBuildPanel(b){this._hPanel=RBuilder.createTable(b,this.styleName("Panel"))}
function FUiToolBar_appendChild(b){this.__base.FUiContainer.appendChild.call(this,b);if(RClass.isClass(b,MUiToolButton)){var f=this._hPanel,h=this._hLine;this._directionCd!=EUiDirection.Horizontal||h||(h=this._hLine=RBuilder.appendTableRow(f));this._directionCd==EUiDirection.Vertical&&(h=this._hLine=RBuilder.appendTableRow(f));f=RBuilder.appendTableCell(h,this.styleName("ButtonPanel"));f._hParentLine=h;b.setPanel(f)}}
function FUiToolBar_removeChild(b){RClass.isClass(b,MUiToolButton)&&(b._hParentLine.removeChild(b._hParent),b._hParent=null,b._hParentLine=null);this.__base.FUiContainer.removeChild.call(this,b)}function FUiToolBar_dispose(){this._hLine=RHtml.free(this._hLine);this.__base.FUiContainer.dispose.call(this)}
function FUiToolButton(b){b=RClass.inherits(this,b,FUiControl,MUiToolButton,MListenerClick);b._icon=RClass.register(b,new APtyString("_icon"));b._iconDisable=RClass.register(b,new APtyString("_iconDisable"));b._hotkey=RClass.register(b,new APtyString("_hotkey"));b._action=RClass.register(b,new APtyString("_action"));b._styleNormal=RClass.register(b,new AStyle("_styleNormal"));b._styleHover=RClass.register(b,new AStyle("_styleHover"));b._stylePress=RClass.register(b,new AStyle("_stylePress"));b._styleDisable=
RClass.register(b,new AStyle("_styleDisable"));b._styleIconPanel=RClass.register(b,new AStyle("_styleIconPanel"));b._styleSpacePanel=RClass.register(b,new AStyle("_styleSpacePanel"));b._styleLabelPanel=RClass.register(b,new AStyle("_styleLabelPanel"));b._disabled=!1;b._hForm=null;b._hLine=null;b._hIconPanel=null;b._hIcon=null;b._hSpacePanel=null;b._hLabelPanel=null;b.onBuildPanel=FUiToolButton_onBuildPanel;b.onBuild=FUiToolButton_onBuild;b.onEnter=FUiToolButton_onEnter;b.onLeave=FUiToolButton_onLeave;
b.onMouseDown=RClass.register(b,new AEventMouseDown("onMouseDown"),FUiToolButton_onMouseDown);b.onMouseUp=RClass.register(b,new AEventMouseDown("onMouseUp"),FUiToolButton_onMouseUp);b.icon=FUiToolButton_icon;b.setIcon=FUiToolButton_setIcon;b.setLabel=FUiToolButton_setLabel;b.setHint=FUiToolButton_setHint;b.setEnable=FUiToolButton_setEnable;b.click=FUiToolButton_click;b.dispose=FUiToolButton_dispose;return b}
function FUiToolButton_onBuildPanel(b){this._hPanel=RBuilder.createDiv(b,this.styleName("Normal"))}
function FUiToolButton_onBuild(b){this.__base.FUiControl.onBuild.call(this,b);b=this._hPanel;this.attachEvent("onMouseDown",b);this.attachEvent("onMouseUp",b);b=this._hForm=RBuilder.appendTable(b);b=this._hLine=RBuilder.appendTableRow(b);if(this._icon){var f=this._hIconPanel=RBuilder.appendTableCell(b,this.styleName("IconPanel"));this._hIcon=RBuilder.appendIcon(f,null,this._icon)}this._icon&&this._label&&(this.hSpacePanel=RBuilder.appendTableCell(b,this.styleName("SpacePanel")));this._label&&((this._hLabelPanel=
RBuilder.appendTableCell(b,this.styleName("LabelPanel"))).noWrap=!0,this.setLabel(this._label));this._hotkey&&RConsole.find(FKeyConsole).register(this._hotkey,this,this.onMouseDown);this._hint&&this.setHint(this._hint)}function FUiToolButton_onEnter(b){this._disabled||(this._hPanel.className=this.styleName("Hover"))}function FUiToolButton_onLeave(b){this._disabled||(this._hPanel.className=this.styleName("Normal"))}
function FUiToolButton_onMouseDown(){this._disabled||(this._hPanel.className=this.styleName("Press"),this.click())}function FUiToolButton_onMouseUp(b){this._disabled||(this._hPanel.className=this.styleName("Hover"))}function FUiToolButton_icon(){return this._icon}function FUiToolButton_setIcon(b){this._icon=b;this._hIcon&&(this._hIcon.src=this.styleIconPath(this._icon))}function FUiToolButton_setLabel(b){this._label=b=RString.nvl(b);var f=this._hLabelPanel;f&&RHtml.textSet(f,b)}
function FUiToolButton_setHint(b){this._hint=b;RString.nvl(b);this._hPanel.title=this._hint}
function FUiToolButton_setEnable(b){this.__base.FUiControl.oeEnable.call(this,e);this._disabled=!e.enable;e.enable&&this._icon?(b=RRes._iconPath(this._icon),this._hIcon.src!=b&&(this._hIcon.src=b)):!e.enable&&this._iconDisable&&(b=RRes._iconPath(this._iconDisable),this._hIcon.src!=b&&(this._hIcon.src=b));b=this.styleName(e.enable?"Icon":"IconDisable");this._hIcon.className!=b&&(this._hIcon.className=b);b=this.styleName(e.enable?"Button":"Disable");this._hPanel.className!=b&&(this._hPanel.className=
b);b=this.styleIconPath(e.enable?"Button":"ButtonDisable");this._hButton.background!=b&&(this._hButton.background=b);return EEventStatus.Stop}function FUiToolButton_click(){RLogger.debug(this,"Mouse button click. (label={1})"+this._label);this.processClickListener(this)}
function FUiToolButton_dispose(){this._hForm=RHtml.free(this._hForm);this._hLine=RHtml.free(this._hLine);this._hIconPanel=RHtml.free(this._hIconPanel);this._hIcon=RHtml.free(this._hIcon);this._hSpacePanel=RHtml.free(this._hSpacePanel);this._hLabelPanel=RHtml.free(this._hLabelPanel);this.__base.FUiControl.dispose.call(this)}
function FUiToolButtonCheck(b){b=RClass.inherits(this,b,FUiToolButton);b._optionChecked=RClass.register(b,new APtyBoolean("_optionChecked","check"));b._groupName=RClass.register(b,new APtyString("_groupName"));b._groupDefault=RClass.register(b,new APtyString("_groupDefault"));b._statusChecked=!1;b.onEnter=FUiToolButtonCheck_onEnter;b.onLeave=FUiToolButtonCheck_onLeave;b.onMouseDown=FUiToolButtonCheck_onMouseDown;b.onMouseUp=FUiToolButtonCheck_onMouseUp;b.groupName=FUiToolButtonCheck_groupName;b.setGroupName=
FUiToolButtonCheck_setGroupName;b.groupDefault=FUiToolButtonCheck_groupDefault;b.setGroupDefault=FUiToolButtonCheck_setGroupDefault;b.innerCheck=FUiToolButtonCheck_innerCheck;b.check=FUiToolButtonCheck_check;b.dispose=FUiToolButtonCheck_dispose;return b}function FUiToolButtonCheck_onEnter(b){this._statusChecked||(this._hPanel.className=this.styleName("Hover"))}function FUiToolButtonCheck_onLeave(b){this._statusChecked||(this._hPanel.className=this.styleName("Normal"))}
function FUiToolButtonCheck_onMouseDown(b){this.check(!this._statusChecked);this.processClickListener(this,this._statusChecked)}function FUiToolButtonCheck_onMouseUp(){}function FUiToolButtonCheck_groupName(){return this._groupName}function FUiToolButtonCheck_setGroupName(b){this._groupName=b}function FUiToolButtonCheck_groupDefault(){return this._groupDefault}function FUiToolButtonCheck_setGroupDefault(b){this._groupDefault=b}
function FUiToolButtonCheck_innerCheck(b){this._statusChecked!=b&&(this._statusChecked=b,this._hPanel.className=b?this.styleName("Press"):this.styleName("Normal"))}
function FUiToolButtonCheck_check(b){if(b||this._groupDefault!=this)if(this.innerCheck(b),this._parent)if(b){if(!RString.isEmpty(this._groupName)){b=this._parent.components();for(var f=b.count()-1;0<=f;f--){var h=b.value(f);h!=this&&RClass.isClass(h,FUiToolButtonCheck)&&h.innerCheck(!1)}}}else RString.isEmpty(this._groupDefault)||(b=this._parent.components(),h=b.get(this._groupDefault),h.innerCheck(!0))}
function FUiToolButtonCheck_dispose(){this._groupName=this._statusChecked=null;this.__base.FUiToolButton.dispose.call(this)}
function FUiToolButtonMenu(b){b=RClass.inherits(this,b,FUiToolButton,MUiContainer,MDropable,MUiFocus);b.popup=null;b.hDropPanel=null;b._styleDropHover=RClass.register(b,new AStyleIcon("DropHover"));b.onBuild=FUiToolButtonMenu_onBuild;b.onEnter=FUiToolButtonMenu_onEnter;b.onLeave=FUiToolButtonMenu_onLeave;b.onBlur=FUiToolButtonMenu_onBlur;b.onButtonClick=FUiToolButtonMenu_onButtonClick;b.onDropClick=FUiToolButtonMenu_onDropClick;b.construct=FUiToolButtonMenu_construct;b.push=FUiToolButtonMenu_push;
b.drop=FUiToolButtonMenu_drop;b.dispose=FUiToolButtonMenu_dispose;return b}function FUiToolButtonMenu_onEnter(b){this.base.FUiToolButton.onEnter.call(this,b);this.disabled||(this.hDropIcon.src=this.styleIconPath("DropHover"))}function FUiToolButtonMenu_onLeave(b){this.popup.isVisible()||(this.base.FUiToolButton.onLeave.call(this,b),this.disabled||(this.hDropIcon.src=this.styleIconPath("Drop")))}
function FUiToolButtonMenu_onBlur(b){if(b&&this.popup.testInRange(b))return!1;this.hPanel.className=this.style("Button");this.popup.hide()}function FUiToolButtonMenu_onButtonClick(){this.disabled||(this.base.FUiToolButton.onButtonClick.call(this),this.action||this.page?this.action&&eval(this.action):this.drop())}function FUiToolButtonMenu_onDropClick(b){this.drop()}
function FUiToolButtonMenu_onBuild(b){if(b.isBefore()){this.base.FUiToolButton.onBuild.call(this,b);var f=this.hDropPanel=this.hButtonLine.insertCell();f.className=this.style("Drop");this.hDropIcon=RBuilder.appendIcon(f,this.styleIcon("Drop"));this.attachEvent("onDropClick",f)}b.isAfter()&&this.popup.psBuild();return EEventStatus.Continue}function FUiToolButtonMenu_construct(){this.popup=RClass.create(FPopupMenu);this.popup.opener=this}
function FUiToolButtonMenu_push(b){if(RClass.isClass(b,MMenuButton))return this.popup.push(b);this.base.FUiToolButton.push.call(this,b)}function FUiToolButtonMenu_drop(){this.disabled||this.popup.show(this.hDropPanel,EAlign.BottomRight)}function FUiToolButtonMenu_dispose(){this.base.FControl.dispose.call(this);this.hDropPanel=this.hDropIcon=null}
function FUiToolButtonSplit(b){b=RClass.inherits(this,b,FUiToolButton,MUiToolButton);b._stylePanel=RClass.register(b,new AStyle("_stylePanel"));b.onBuild=FUiToolButtonSplit_onBuild;return b}function FUiToolButtonSplit_onBuild(b){this.__base.FUiControl.onBuild.call(this,b);this._hPanel.className=this.styleName("Panel")}function FUiToolButtonText(b){return b=RClass.inherits(this,b,FUiToolButton)}
function FPageBar(b){b=RClass.inherits(this,b,FContainer);b.tabs=new TMap;b.selected=null;b.hTop=null;b.hLine=null;b.hBottom=null;b.hSheets=null;b.oeBuild=FPageBar_oeBuild;b.onBuildPanel=FPageBar_onBuildPanel;b.select=FPageBar_select;b.tab=FPageBar_tab;b.push=FPageBar_push;b.dispose=FPageBar_dispose;return b}
function FPageBar_oeBuild(b){this.base.FContainer.oeBuild.call(this,b);if(b.isBefore())this.hRows=RBuilder.append(this.hPanel,"TBODY"),this.hRow=RBuilder.append(this.hRows,"TR");else if(b.isAfter()){b=this.tabs;for(var f=0;f<b.count;f++)this.hRow.appendChild(b.value(f).hPanel)}}function FPageBar_onBuildPanel(){this.hPanel=RBuilder.newTable()}function FPageBar_select(b){this.selected=b;for(var f=0;f<this.tabs.count;f++){var h=this.tabs.value(f);h.select(b==h)}b.psRefresh()}
function FPageBar_tab(b){return this.sheets.get(b)}function FPageBar_push(b){this.base.FContainer.push.call(this,b);RClass.isClass(b,FPageTab)&&(b.pageBar=this,b.index=this.tabs.count,this.tabs.set(b.name,b))}function FPageBar_dispose(){this.base.FContainer.dispose.call(this);RMemory.freeHtml(this.hPanel);RMemory.freeHtml(this.hRow);this.hPanel=this.hRow=null}
function FPageTab(b){b=RClass.inherits(this,b,FControl);b.page=RClass.register(b,new TPtyStr("page",null));b.icon=RClass.register(b,new TPtyStr("icon",null));b.action=RClass.register(b,new TPtyStr("action",null));b.stPanel=RClass.register(b,new TStyle("LabelPanel"));b.stButtonIcon=RClass.register(b,new TStyleIcon("Button"));b.pageBar=null;b.index=null;b.selected=!1;b.hasBuilded=!1;b.lsnsSelect=new TListeners;b.hTopL=null;b.hTop=null;b.hTopR=null;b.hLeft=null;b.hButton=null;b.hIcon=null;b.hText=null;
b.hBottomL=null;b.hBottom=null;b.hBottomR=null;b.hRight=null;b.oeBuild=FPageTab_oeBuild;b.onBuildPanel=FPageTab_onBuildPanel;b.onEnter=FPageTab_onEnter;b.onLeave=FPageTab_onLeave;b.onMouseDown=FPageTab_onMouseDown;b.select=FPageTab_select;b.dump=FPageTab_dump;return b}
function FPageTab_oeBuild(b){this.base.FControl.oeBuild.call(this,b);var f=this.border=RBorder.create(EUiBorder.Round,this.hPanel);b=f.hPanel;this.hPanel.width="90";b.align="center";b.className=this.style("LabelPanel");b.background=this.styleIconPath("Button");this.hPanel.appendChild(f.hForm);f=this.label;this.icon&&(this.hIcon=RBuilder.appendIcon(b,this.icon),f=" "+this.label);RBuilder.appendText(b,f);return EEventStatus.Stop}
function FPageTab_onBuildPanel(){this.hPanel=RBuilder.create(null,"TD")}function FPageTab_onEnter(){}function FPageTab_onLeave(){}function FPageTab_onMouseDown(){this.action&&eval(this.action)}function FPageTab_select(b){this.selected!=b&&(b&&this.lsnsSelect.process(),this.selected=b)}
function FPageTab_dump(b,f){b=RString.nvlStr(b);b.append(f,RClass.name(this)," [");b.append("name=",this.name,", ");b.append("icon=",this.icon,", ");b.append("label=",this.label,", ");b.append("action=",this.action,"]");return b}
function FTabBar(b){b=RClass.inherits(this,b,FContainer);b.left=20;b.width="100%";b.sheets=new TMap;b.selected=null;b.hTop=null;b.hLine=null;b.hBottom=null;b.oeBuild=FTabBar_oeBuild;b.onBuildPanel=FTabBar_onBuildPanel;b.appendChild=FTabBar_appendChild;b.addClickListener=FTabBar_addClickListener;b.select=FTabBar_select;b.push=FTabBar_push;b.dispose=FTabBar_dispose;return b}
function FTabBar_oeBuild(b){this.base.FContainer.oeBuild.call(this,b);b.isBefore()?(b=this.hTop.insertCell(),RBuilder.appendEmpty(b),b.width=20,this.hLine.insertCell(),b=RBuilder.append(this.hBottom,"TD",this.style("Bottom")),RBuilder.appendEmpty(b)):b.isAfter()&&(RBuilder.append(this.hTop,"TD",this.style("Top")),b=RBuilder.append(this.hLine,"TD"),RBuilder.appendEmpty(b),RBuilder.append(this.hBottom,"TD",this.style("Bottom")),this.sheets.count&&this.select(this.sheets.value(0)))}
function FTabBar_appendChild(b){this.hTop.appendChild(b.hTopL);this.hTop.appendChild(b.hTop);this.hTop.appendChild(b.hTopR);this.hLine.appendChild(b.hLeft);this.hLine.appendChild(b.hPanel);this.hLine.appendChild(b.hRight);this.hBottom.appendChild(b.hBottomL);this.hBottom.appendChild(b.hBottom);this.hBottom.appendChild(b.hBottomR)}
function FTabBar_onBuildPanel(){var b=this.hPanel=RBuilder.append(this.hParent,"TABLE");b.border=0;b.frame="box";b.cellPadding=0;b.cellSpacing=0;this.hTop=b.insertRow();this.hLine=b.insertRow();this.hBottom=b.insertRow()}function FTabBar_addClickListener(){var b=this.components.get(name);b&&b.lsnsClick.push(new TListener(this,method))}function FTabBar_select(b){this.selected=b;for(var f=0;f<this.sheets.count;f++){var h=this.sheets.value(f);h.select(b==h)}}
function FTabBar_selectPage(b,f){this.activeIndex=b;var h=null;if(!f){for(var q=0;q<this.items.length;q++)if(this.items[q].name==this.activePageName){h=this.items[q];this.activePageName=h.name;this.activeIndex=q;break}h||(h=this.items[this.activeIndex],this.activePageName=h.name)}h?this.activePage=h:h=this.activePage;if(h&&(this.clear(),this.refresh(),h=this.items[this.activeIndex],this.activePageName=h.name,this.onSheetClick))this.onSheetClick(h);return h}
function FTabBar_push(b){this.base.FContainer.push.call(this,b);RClass.isClass(b,FTabButton)&&(b.tabBar=this,b.index=this.sheets.count,this.sheets.set(b.name,b))}function FTabBar_dispose(){this.base.FContainer.dispose.call();RMemory.freeHtml(this.hTop);RMemory.freeHtml(this.hLine);RMemory.freeHtml(this.hBottom);this.hBottom=this.hLine=this.hTop=null}
function FTabButton(b){b=RClass.inherits(this,b,FControl,MLsnClick);b.icon=null;b.caption=null;b.action=null;b.hint=null;b.pageBar=null;b.index=null;b.selected=!1;b.oeBuild=FTabButton_oeBuild;b.onBuildPanel=FTabButton_onBuildPanel;b.onEnter=FTabButton_onEnter;b.onLeave=FTabButton_onLeave;b.onMouseDown=FTabButton_onMouseDown;b.onMouseUp=FTabButton_onMouseUp;b.loadConfig=FTabButton_loadConfig;b.saveConfig=FTabButton_saveConfig;b.select=FTabButton_select;b.dump=FTabButton_dump;b.dispose=FTabButton_dispose;
return b}
function FTabButton_oeBuild(b){var f=this.tabBar;this.hTopL=RBuilder.create(null,"TD",f.style("Top"));this.hTop=RBuilder.create(null,"TD",f.style("Top"));this.hTopR=RBuilder.create(null,"TD",f.style("Top"));this.hLeft=RBuilder.create(null,"TD",f.style("Left"));RBuilder.appendEmpty(this.hLeft);this.hBottomL=RBuilder.create(null,"TD",f.style("Bottom"));this.hBottom=RBuilder.create(null,"TD",f.style("Bottom"));this.hBottomR=RBuilder.create(null,"TD",f.style("Bottom"));this.hRight=RBuilder.create(null,"TD",
f.style("Right"));RBuilder.appendEmpty(this.hRight);this.base.FControl.oeBuild.call(this,b);this.hButton=RBuilder.append(this.hPanel,"DIV",this.style("Button"));this.icon&&(this.hIcon=RBuilder.appendIcon(this.hButton,this.icon));this.caption&&(this.hText=RBuilder.append(this.hButton,"SPAN"),this.hText.innerText=" "+this.caption);return EEventStatus.Stop}function FTabButton_onBuildPanel(){this.hPanel=RBuilder.create(null,"TD",this.style("Panel"))}
function FTabButton_onEnter(){this.selected||(this.hButton.className=this.style("Hover"))}function FTabButton_onLeave(){this.selected||(this.hButton.className=this.style("Button"))}function FTabButton_onMouseDown(){this.parent.select(this)}function FTabButton_onMouseUp(){this.processClick()}function FTabButton_loadConfig(b){this.base.FControl.loadConfig.call(this,b);this.icon=b.get("icon");this.caption=b.get("caption");this.action=b.get("action");this.hint=b.get("hint")}
function FTabButton_saveConfig(b){this.base.FControl.saveConfig.call(this,b);b.set("icon",this.icon);b.set("caption",this.caption);b.set("action",this.action);b.set("hint",this.hint)}
function FTabButton_select(b){this.selected=b;var f=this.tabBar,h=0==this.index,q=!0;f.selected&&(q=f.selected.index-1==this.index);this.hButton.className=b?this.style("Select"):this.style("Button");this.hTop.className=b?f.style("TopSel"):f.style("Top");this.hLeft.className=b?f.style("LeftSel"):h?f.style("Right"):f.style("Left");this.hBottomL.className=b?f.style("BottomSel"):f.style("Bottom");this.hBottom.className=b?f.style("BottomSel"):f.style("Bottom");this.hBottomR.className=b?f.style("BottomSel"):
f.style("Bottom");this.hRight.className=b?f.style("RightSel"):q?f.style("RightP"):f.style("Right")}function FTabButton_dump(b,f){b=RString.nvlStr(b);b.append(f,RClass.name(this)," [");b.append("name=",this.name,", ");b.append("icon=",this.icon,", ");b.append("label=",this.label,", ");b.append("action=",this.action,"]");return b}
function FTabButton_dispose(){this.base.FControl.dispose.call(this);RMemory.freeHtml(this.hButton);RMemory.freeHtml(this.hTop);RMemory.freeHtml(this.hLeft);RMemory.freeHtml(this.hBottomL);RMemory.freeHtml(this.hBottom);RMemory.freeHtml(this.hBottomR);RMemory.freeHtml(this.hRight);this.hRight=this.hBottomR=this.hBottom=this.hBottomL=this.hLeft=this.hTop=this.hButton=null}
function FUiDataTreeView(b){b=RClass.inherits(this,b,FUiTreeView);b._serviceName=RClass.register(b,new APtyString("_serviceName","service"));b._statusLoading=!1;b.lsnsLoaded=new TListeners;b.lsnsNodeLoad=new TListeners;b.lsnsNodeLoaded=new TListeners;b.onLoaded=FUiDataTreeView_onLoaded;b.onNodeLoaded=FUiDataTreeView_onNodeLoaded;b.construct=FUiDataTreeView_construct;b.buildNode=FUiDataTreeView_buildNode;b.loadNode=FUiDataTreeView_loadNode;b.loadUrl=FUiDataTreeView_loadUrl;b.loadNodeUrl=FUiDataTreeView_loadNodeUrl;
b.loadService=FUiDataTreeView_loadService;b.loadNodeService=FUiDataTreeView_loadNodeService;b.reloadNode=FUiDataTreeView_reloadNode;b.reload=FUiDataTreeView_reload;b.dispose=FUiDataTreeView_dispose;b._queryService=RClass.register(b,new APtyString("_queryService"));b.onQueryLoaded=FUiDataTreeView_onQueryLoaded;b.doQuery=FUiDataTreeView_doQuery;b.removeNode=FUiDataTreeView_removeNode;b.clearNodes=FUiDataTreeView_clearNodes;b.getChangedChecks=FUiDataTreeView_getChangedChecks;b.fetchExtendsAll=FUiDataTreeView_fetchExtendsAll;
b.tempAppendNodes=FUiDataTreeView_tempAppendNodes;b.removeNodes=FUiDataTreeView_removeNodes;b.tempAppendChild=FUiDataTreeView_tempAppendChild;return b}function FUiDataTreeView_onLoaded(b){var f=b.root;if(null==f)throw new TError(this,"Load tree data failure.");f=f.find("TreeView");RControl.build(this,f,null,this._hPanel);this.lsnsLoaded.process(b);(b=f.get("service"))&&this.loadNodeService(b)}
function FUiDataTreeView_onNodeLoaded(b){var f=b.root;if(null==f)throw new TError(this,"Load tree data failure.");var h=b.connection.parentNode;this._loadingNode.hide();this._statusLoading=!1;this.buildNode(h,f);this.lsnsNodeLoaded.process(b)}function FUiDataTreeView_construct(){this.__base.FUiTreeView.construct.call(this)}
function FUiDataTreeView_buildNode(b,f){var h=f._nodes;if(h)for(var q=h.count(),u=0;u<q;u++){var z=h.get(u);if(z.isName("TreeNode")){var A=this.createNode();A.loadConfig(z);b?b.push(A):this.push(A);this.appendNode(A,b);z.hasNode()&&(this.buildNode(A,z),A.extend(!1))}}}
function FUiDataTreeView_loadNode(b,f){this._statusLoading=!0;for(var h=null,q=b,u=this._serviceName;RClass.isClass(q,FTreeNode);){if((h=q.type())&&h._service){u=h._service;break}q=q._parent}if(!u)throw new TError(this,"Unknown service name.");this.lsnsNodeLoad.process(this,b);for(var h=new TXmlDocument,z=h.root(),q=b;RClass.isClass(q,FTreeNode);){var A=z.create("TreeNode");q.propertySave(A);q=q._parent}b._extended=!0;b._child&&b._hImage&&(b._hImage.src=RResource.iconPath(this._iconMinus));q=this._loadingNode;
A=b._hPanel.rowIndex;q._hPanel.rowIndex>A&&A++;RHtml.tableMoveRow(this._hNodeForm,q._hPanel.rowIndex,A);q.setLevel(b.level()+1);q.show();u=RService.parse(RString.nvl(u,this._service));if(!u)throw new TError(this,"Unknown service.");A=RConsole.find(FXmlConsole);u=A.sendAsync(u.url,h);u.parentNode=b;u.lsnsLoad.register(this,this.onNodeLoaded)}function FUiDataTreeView_loadUrl(b){RConsole.find(FXmlConsole).sendAsync(b).lsnsLoad.register(this,this.onLoaded)}
function FUiDataTreeView_loadNodeUrl(b,f){var h=RConsole.find(FXmlConsole).sendAsync(b);h.parentNode=RObject.nvl(f,this._focusNode);h.lsnsLoad.register(this,this.onNodeLoaded)}
function FUiDataTreeView_loadService(b,f){var h=RService.parse(RString.nvl(b,this._service));if(!h)return alert("Unknown service");f=RObject.nvl(f,this._attributes);var q=(new TXmlDocument).root();q.set("action",h.action);RConsole.find(FEnvironmentConsole).build(q);f.isEmpty()||(RClass.isClass(f,TNode)&&q.push(f),RClass.isClass(f,TAttributes)?(q.create("Tree").attrs=f,q.create("Attributes").attrs=f):(q.create("Tree").value=f,q.create("Attributes").value=f))}
function FUiDataTreeView_loadNodeService(b,f){var h=RService.parse(RString.nvl(b,this._service));if(!h)throw new TError(this,"Unknown service.");var q=RObject.nvl(f,this._attributes),u=(new TXmlDocument).root();u.set("action",h.action);q.isEmpty()||(RClass.isClass(q,TNode)&&u.push(attrs),RClass.isClass(q,TAttributes));h=RConsole.find(FXmlConsole).sendAsync(h.url,u);h.parentNode=this._focusNode;h.lsnsLoad.register(this,this.onNodeLoaded)}
function FUiDataTreeView_reloadNode(b){b=RObject.nvl(b,this._focusNode);if(!b)return this.reload();b.removeChildren();this.loadNode(b)}function FUiDataTreeView_reload(){this.clear();this.loadUrl()}function FUiDataTreeView_dispose(){this.__base.FUiTreeView.dispose.call(this)}
function FUiDataTreeView_onQueryLoaded(b){if((b=b.document)&&(b=b.root().find("TreeView"))&&b._nodes)for(var f=b._nodes.count,h=0;h<f;h++){var q=b._nodes.get(h);if(q.isName("TreeNode")){var u=q.get("name");(u=this.findByName(u))&&u.loadQuery(q)}}}
function FUiDataTreeView_doQuery(){var b=RService.parse(this._queryService);if(!b)return alert("Unknown query service");var f=new TXmlDocument,h=f.root();h.set("action",b.action);h.create("Attributes").attrs=this._attributes;h=new TEvent(this,EXmlEvent.Send,this.onQueryLoaded);h.url=b.url;h.document=f;RConsole.find(FXmlConsole).process(h)}
function FUiDataTreeView_removeNode(b){if(b){for(var f=[],h=null,q=this._allNodes.length,u=0;u<q;u++)h=this._allNodes[u],h!=b&&(f[f.length]=h);this._allNodes=f;var z=b.parent;if(z){f=[];q=z._nodes.length;for(u=0;u<q;u++)h=z._nodes[u],h!=b&&(f[f.length]=h);z._nodes=f;b.parent.childrenHTML.removeChild(b.ownerHTML)}0==z._nodes.length&&(z.imageHTML.src=this.imgEmpty);return!0}return!1}function FUiDataTreeView_haveNodes(){return this.rootNode.hasChild()}
function FUiDataTreeView_clearNodes(b){b&&b.removeChildren();return!0}
function FUiDataTreeView_fetchExtendsAll(b){b&&RClass.isClass(b,FTreeNode)&&(fmMain.target="frmMain",fmMain.form_search.value="",fmMain.form_order.value="",fmMain.form_values.value="",b=node.type.typeName,"table"==b||"form"==b?(fmMain.form_name.value=node.get("form"),fmMain.action=top.RContext.context("/ent/apl/logic/form/InnerForm.wa?do=update"),fmMain.submit()):"frameTree"==b&&(fmMain.action=top.RContext.context(node.get("redirect")),fmMain.submit()))}
function FUiDataTreeView_getChangedChecks(){var b=new TNode("TreeView");b.set("name",this.name);for(var f=RObject.nvl(this.rootNode,this).controls,h=0;h<f.count;h++)f.value(h).pushChanged(b);return b}
function FUiDataTreeView_tempAppendNodes(b,f){b=RObject.nvl(b,this.workNode,this.rootNode);if(f&&f._nodes){var h=f._nodes.count;if(0<h){b.child=!0;b.loaded=!0;for(var q=0;q<h;q++){var u=f._nodes.get(q);if(u&&(u.isName("Node")||u.isName("TreeNode"))){var z=RClass.create(FTreeNode);z.parent=b;z._tree=this;z.loadConfig(u);z.icon=u._nodes?"ctl.FBrowser_Folder":"ctl.FBrowser_Txt";z.build(0);z.hide();u._nodes&&this.tempAppendNodes(z,u);b.push(z);this._allNodes.push(z)}}}}this.rootNode.extend(!0)}
function FUiDataTreeView_removeNodes(b){b=RObject.nvl(b,this.workNode,this.rootNode);b.hasChild()&&b.removeChildren();b.remove()}function FUiDataTreeView_tempAppendChild(b){var f=this._hHeadLine.insertCell();f.height="100%";RClass.isClass(b,FTreeColumn)&&f.appendChild(b._hPanel)}
function FUiTreeColumn(b){b=RClass.inherits(this,b,FUiControl);b._icon=RClass.register(b,new APtyString("_icon"));b._dataName=RClass.register(b,new APtyString("_dataName"));b._display=RClass.register(b,new APtyBoolean("_display"),EBoolean.False);b._config=RClass.register(b,new APtyConfig("_config"));b.oeBuild=FUiTreeColumn_oeBuild;b.onBuildPanel=FUiTreeColumn_onBuildPanel;return b}
function FUiTreeColumn_oeBuild(b){this.__base.FUiControl.oeBuild.call(this,b);b=this.hPanel;b.innerText=RString.nvl(this.label);b.noWrap=!0;this.display||(b.style.display="block");this.width&&(b.width=this.width);return EEventStatus.Stop}function FUiTreeColumn_onBuildPanel(){this.hPanel=RBuilder.create(null,"TD")}
function FUiTreeLevel(b){b=RClass.inherits(this,b,FUiControl);b._id=RClass.register(b,new APtyString("_id"));b._color=RClass.register(b,new APtyString("_color"));b._backColor=RClass.register(b,new APtyString("_backColor"));return b}
function FUiTreeNode(b){b=RClass.inherits(this,b,FUiContainer,MDataProperties);b._valid=RClass.register(b,new APtyBoolean("_isValid"),!0);b._typeName=RClass.register(b,new APtyString("_typeName","type"));b._uuid=RClass.register(b,new APtyString("_uuid"));b._icon=RClass.register(b,new APtyString("_icon"));b._checked=RClass.register(b,new APtyBoolean("_checked"),!1);b._extended=RClass.register(b,new APtyBoolean("_extended"),!1);b._child=RClass.register(b,new APtyBoolean("_child"),!1);b._note=RClass.register(b,
new APtyString("_note"));b._tag=RClass.register(b,new APtyString("_tag"));b._styleNormal=RClass.register(b,new AStyle("_styleNormal"));b._styleHover=RClass.register(b,new AStyle("_styleHover"));b._styleSelect=RClass.register(b,new AStyle("_styleSelect"));b._styleImage=RClass.register(b,new AStyle("_styleImage"));b._styleIcon=RClass.register(b,new AStyle("_styleIcon"));b._styleIconDisable=RClass.register(b,new AStyle("_styleIconDisable"));b._styleLabel=RClass.register(b,new AStyle("_styleLabel"));
b._styleCell=RClass.register(b,new AStyle("_styleCell"));b._tree=null;b._level=0;b._attributes=null;b._nodes=null;b._cells=null;b._statusLinked=!1;b._statusDisplay=!0;b._statusSelected=!1;b._statusLoaded=!1;b._statusHover=!1;b._hNodePanel=null;b._hCheck=null;b._hImage=null;b._hIcon=null;b._hLabel=null;b.onBuildPanel=FUiTreeNode_onBuildPanel;b.onBuild=FUiTreeNode_onBuild;b.onNodeEnter=RClass.register(b,new AEventMouseEnter("onNodeEnter"),FUiTreeNode_onNodeEnter);b.onNodeLeave=RClass.register(b,new AEventMouseLeave("onNodeLeave"),
FUiTreeNode_onNodeLeave);b.onNodeClick=RClass.register(b,new AEventClick("onNodeClick"),FUiTreeNode_onNodeClick);b.construct=FUiTreeNode_construct;b.type=FUiTreeNode_type;b.typeName=FUiTreeNode_typeName;b.setTypeName=FUiTreeNode_setTypeName;b.setLabel=FUiTreeNode_setLabel;b.setNote=FUiTreeNode_setNote;b.level=FUiTreeNode_level;b.setLevel=FUiTreeNode_setLevel;b.cell=FUiTreeNode_cell;b.cells=FUiTreeNode_cells;b.check=FUiTreeNode_check;b.setCheck=FUiTreeNode_setCheck;b.setImage=FUiTreeNode_setImage;
b.setIcon=FUiTreeNode_setIcon;b.get=FUiTreeNode_get;b.set=FUiTreeNode_set;b.hasChild=FUiTreeNode_hasChild;b.topNode=FUiTreeNode_topNode;b.topNodeByType=FUiTreeNode_topNodeByType;b.show=FUiTreeNode_show;b.hide=FUiTreeNode_hide;b.select=FUiTreeNode_select;b.extend=FUiTreeNode_extend;b.extendAll=FUiTreeNode_extendAll;b.searchLast=FUiTreeNode_searchLast;b.createChild=FUiTreeNode_createChild;b.appendChild=FUiTreeNode_appendChild;b.appendNode=FUiTreeNode_appendNode;b.push=FUiTreeNode_push;b.remove=FUiTreeNode_remove;
b.removeChildren=FUiTreeNode_removeChildren;b.reset=FUiTreeNode_reset;b.click=FUiTreeNode_click;b.refreshStyle=FUiTreeNode_refreshStyle;b.propertyLoad=FUiTreeNode_propertyLoad;b.propertySave=FUiTreeNode_propertySave;b.loadConfig=FUiTreeNode_loadConfig;b.reload=FUiTreeNode_reload;b.reloadParent=FUiTreeNode_reloadParent;b.loadQuery=FUiTreeNode_loadQuery;b.isFolder=FUiTreeNode_isFolder;b.dispose=FUiTreeNode_dispose;b.innerDump=FUiTreeNode_innerDump;b.findByName=FUiTreeNode_findByName;b.findByUuid=FUiTreeNode_findByUuid;
b.checkChanged=FUiTreeNode_checkChanged;b.pushChanged=FUiTreeNode_pushChanged;b.getFullPath=FUiTreeNode_getFullPath;return b}function FUiTreeNode_onBuildPanel(b){this._hPanel=RBuilder.createTableRow(b,this.styleName("Panel"))}
function FUiTreeNode_onBuild(b){var f=this._tree;this.__base.FUiContainer.onBuild.call(this,b);var h=this._hPanel;this.attachEvent("onNodeEnter",h,this.onNodeEnter);this.attachEvent("onNodeLeave",h,this.onNodeLeave);this.attachEvent("onNodeClick",h);h=this._hNodePanel=RBuilder.appendTableCell(h,this.styleName("Normal"));h.noWrap=!0;var q=this._hImage=RBuilder.appendIcon(h,this.styleName("Image"),null,16,16);q._linkType="image";this.setImage();q=this._hIcon=RBuilder.appendIcon(h,null,null,16,16);q._linkType=
"icon";this.setIcon(this._icon);f.dispChecked&&(q=this._hCheck=RBuilder.appendCheck(h),q.width=13,q.height=13,q.style.borderWidth=0,this.setCheck(this._checked),f.linkEvent(this,"onNodeCheckClick",q));this._hLabel=RBuilder.appendText(h,this.styleName("Label"));this.setLabel(this._label);if(f=f._nodeColumns)for(h=f.count(),q=0;q<h;q++){var u=f.value(q),z=RClass.create(FUiTreeNodeCell);z._column=u;z.build(b);this.push(z)}}
function FUiTreeNode_onNodeEnter(b){b=this._tree;if(!b._focusNode||b._focusNode&&b._focusNode!=this)this._statusHover=!0,this.refreshStyle(),b.lsnsEnter.process(b,this)}function FUiTreeNode_onNodeLeave(b){b=this._tree;if(!b._focusNode||b._focusNode&&b._focusNode!=this)this._statusHover=!1,this.refreshStyle(),b.lsnsLeave.process(b,this)}
function FUiTreeNode_onNodeClick(b){var f=this._tree,h=b.hSender.tagName;if("INPUT"!=h){var q=!1;"IMG"==h&&(q="image"==b.hSender._linkType);b=!1;for(h=f._focusNode;h;){if(h==this){b=!0;break}h=h.parent}q&&(!q||!b&&this._child)||f.selectNode(this,!0);!this._statusLoaded&&this._child?(this.extend(!0),q||f.lsnsClick.process(f,this)):(this._child&&(this.isFolder()?this.extend(!this._extended):q?this.extend(!this._extended):this.extend(!0)),(q&&b||q&&!this._child||!q)&&f.lsnsClick.process(f,this))}}
function FUiTreeNode_construct(){this.__base.FUiContainer.construct.call(this);this._attributes=new TAttributes}function FUiTreeNode_type(){var b=this._tree;return RString.isEmpty(this._typeName)?null:b.findType(this._typeName)}function FUiTreeNode_typeName(){return this._typeName}function FUiTreeNode_setTypeName(b){this._typeName=b;this.setIcon()}
function FUiTreeNode_setLabel(b){this.__base.FUiContainer.setLabel.call(this,b);if(b=this._hLabel){var f="";RString.isEmpty(this._label)||(f="&nbsp;"+this._label,this._tag&&(f+="&nbsp;<FONT color=blue>("+this._tag+")</FONT>"),this._note&&(f+="&nbsp;<FONT color=green>[ "+this._note+" ]</FONT>"));b.innerHTML=f}}function FUiTreeNode_setNote(b){this._note=RString.empty(b);this.setLabel(this._label)}function FUiTreeNode_level(){return this._level}
function FUiTreeNode_setLevel(b){this._level=b;var f=this._hNodePanel;f&&(f.style.paddingLeft=this._tree._indent*b+"px")}function FUiTreeNode_cell(b){return this._cells.get(b)}function FUiTreeNode_cells(){return this._cells}function FUiTreeNode_check(){return this._checked}function FUiTreeNode_setCheck(b){this._checked=b;RString.isEmpty(this._attributes.get("checked"))||(this._checked=RBoolean.isTrue(this._attributes.get("checked")),this._hCheck&&(this._hCheck._checked=this._checked))}
function FUiTreeNode_setImage(){var b=this._tree,f=this._hImage;f&&(f.src=RResource.iconPath(this._child?b._iconPlus:b._iconNode))}function FUiTreeNode_setIcon(b){this._icon=b;var f=this._hIcon;if(f){var h=null;this._icon?h=b:(b=this.type())&&(h=b.icon());h?(RHtml.displaySet(f,!0),f.style.width=16,f.style.height=16,f.className=this._valid?this.styleName("Icon"):this.styleName("IconDisable"),f.src=RResource.iconPath(h)):RHtml.displaySet(f,!1)}}
function FUiTreeNode_get(b){return this._attributes.get(b)}function FUiTreeNode_set(b,f){this._attributes.set(b,f)}function FUiTreeNode_hasChild(){if(this._child){var b=this._nodes;if(b)return!b.isEmpty()}return!1}function FUiTreeNode_topNode(){for(var b=this;b._parent;)b=b._parent;return b}function FUiTreeNode_topNodeByType(b){for(var f=this;f;){if(f._typeName==b)return f;f=f._parent}return null}
function FUiTreeNode_show(){var b=this._tree;RHtml.visibleSet(this._hPanel,!0);var f=this._nodes;if(f)for(var h=f.count(),q=0;q<h;q++){var u=f.get(q);u._statusLinked||b.appendNode(u,this);u._statusDisplay&&(RHtml.visibleSet(u._hPanel,!0),u._extended&&u.show())}}function FUiTreeNode_hide(){this._hPanel&&RHtml.visibleSet(this._hPanel,!1);var b=this._components;if(b)for(var f=b.count(),h=0;h<f;h++){var q=b.value(h);q&&q.hide()}}
function FUiTreeNode_select(b){if(this._statusSelected=b)this._statusHover=!1;this.refreshStyle()}
function FUiTreeNode_extend(b){var f=this._tree;if(!this._statusLoaded&&this._child){if(f.__loading)return;f.loadNode(this)}else{if(this._hImage&&!this.hasChild())return this._hImage.src=RResource.iconPath(f._iconNode),!1;this._extended=b;this._child&&this._hImage&&(this._hImage.src=RResource.iconPath(b?f._iconMinus:f._iconPlus));var h=this._nodes;if(b)this.show();else if(h)for(b=h.count()-1;0<=b;b--)h.get(b).hide()}f.refresh()}
function FUiTreeNode_extendAll(b){this.extend(b);var f=this._components;if(f)for(var h=f.count(),q=0;q<h;q++)f.value(q).extendAll(b)}function FUiTreeNode_searchLast(){var b=this._nodes;if(b)for(var f=b.count()-1;0<=f;f--){var h=b.get(f);if(h._statusLinked)return h.searchLast()}return this}function FUiTreeNode_createChild(b){var f=null;if(b.isName("Node")||b.isName("TreeNode"))f=RClass.create(FUiTreeNode),f._tree=this._tree;return f}
function FUiTreeNode_appendChild(b){RClass.isClass(b,FUiTreeNodeCell)&&this._hPanel.appendChild(b._hPanel)}function FUiTreeNode_appendNode(b){var f=this._tree;this.push(b);f.appendNode(b,this);this.extend(!0)}
function FUiTreeNode_push(b){var f=this._tree;this.__base.FUiContainer.push.call(this,b);if(RClass.isClass(b,FUiTreeNode)){this._statusLoaded=this._child=!0;var h=this._nodes;h||(h=this._nodes=new TObjects);b._tree=f;b._parent=this;h.push(b);f._allNodes.pushUnique(b)}RClass.isClass(b,FUiTreeNodeCell)&&(h=this._cells,h||(h=this._cells=new TDictionary),b._parent=this,b._tree=f,b._node=this,h.set(b._column._name,b))}
function FUiTreeNode_remove(){var b=this._tree;this._statusLinked&&(this.removeChildren(),b.freeNode(this))}function FUiTreeNode_removeChildren(){var b=this._nodes;if(b){for(var f=b.count()-1;0<=f;f--){var h=b.get(f);h&&h.remove()}b.clear()}}
function FUiTreeNode_reset(){this._uuid=this._typeName=null;this._valid=!0;this._note=this._tag=this._icon=null;this._checked=this._child=!1;this._extended=!0;this._statusLinked=!1;this._statusDisplay=!0;this._statusLoaded=this._statusSelected=this._extended=this._statusHover=!1;this._level=0}function FUiTreeNode_click(){var b=this._tree;b.selectNode(this,!0);b.lsnsClick.process(b,this)}
function FUiTreeNode_refreshStyle(){var b=this._hPanel.cells,f=b.length;if(this._statusSelected)for(var h=0;h<f;h++)b[h].className=this.styleName("Select");else if(this._statusHover)for(h=0;h<f;h++)b[h].className=this.styleName("Hover");else for(h=0;h<f;h++)b[h].className=this.styleName("Normal")}function FUiTreeNode_propertyLoad(b){this.__base.FUiContainer.propertyLoad.call(this,b);this._attributes.append(b.attrs);(b=b.get("attributes"))&&this._attributes.unpack(b)}
function FUiTreeNode_propertySave(b){this.__base.FUiContainer.propertySave.call(this,b);b.set("type_name",this._typeName);b.set("attributes",this._attributes.pack())}function FUiTreeNode_loadConfig(b){this.reset();this.propertyLoad(b);this.setLabel(this._label);this.setCheck(this._checked);this.setImage();this.setIcon(this._icon)}function FUiTreeNode_reload(b){b?this._tree.reload():this._tree.reloadNode(this)}
function FUiTreeNode_reloadParent(){this.parentNode?this._tree.reloadNode(this.parentNode):this._tree.reload()}function FUiTreeNode_loadQuery(b){var f=RString.nvl(b.get("label"),this._label),h=RString.nvl(b.get("note"),this._note),f="&nbsp;"+f;RString.isEmpty(h)||(f+="&nbsp;<FONT color=green>[ "+h+" ]</FONT>");this._hLabel.innerHTML=f;b.contains("visible")&&(this._statusDisplay=RBool.isTrue(b.get("visible")),this.setVisible(this._statusDisplay))}
function FUiTreeNode_dispose(){this.__base.FUiContainer.dispose.call(this);this._hLabel=this._hCheck=this._hIcon=this._hImage=this._hNodePanel=null}function FUiTreeNode_innerDump(b){b.append(RClass._typeNameOf(this));b.append("[level=",this._level);this._typeName&&b.append(" type=",this._typeName.name);b.append(", icon=",this._icon);b.append(", caption=",this._label);b.append(", child=",this._child);b.append("]")}
function FUiTreeNode_findByName(b){if(this.name==b)return this;var f=this.components;if(f)for(var h=f.count,q=0;q<h;q++){var u=f.value(q);if(u&&(u.name==b||u.components&&(u=u.findByName(b))))return u}return null}function FUiTreeNode_findByUuid(b){if(this._uuid==b)return this;var f=this.components;if(f)for(var h=0;h<f.count;h++){var q=f.value(h);if(q&&(q._uuid==b||q.components&&(q=q.findByUuid(b))))return q}return null}
function FUiTreeNode_pushChanged(b){var f=new TNode;f.attrs=this._attributes;f.attrs&&f.attrs.set("checked",RBoolean.toString(this.check()));b.push(f);if(this.components&&0<this.components.count)for(var f=this.components.count,h=0;h<f;h++){var q=this.components.value(h);RClass.isClass(q,FUiTreeNode)&&q.pushChanged(b)}}function FUiTreeNode_checkChanged(){return this._checked!=this.check()?!0:!1}
function FUiTreeNode_getFullPath(){var b="";this._label&&(b=this._label);if(this.parent){var f=this.parent.getFullPath();RString.isEmpty(f)||(b=f+"/"+b)}return b}function FUiTreeNode_isFolder(){if(this._typeName)return"collections"==this._typeName._typeNameName?!0:!1}
function FUiTreeNodeCell(b){b=RClass.inherits(this,b,FUiControl,MListenerClick,MListenerDoubleClick);b._stylePanel=RClass.register(b,new AStyle("_stylePanel"));b._styleCell=RClass.register(b,new AStyle("_styleCell","Cell"));b._tree=null;b._column=null;b._level=0;b._node=null;b._hImage=null;b._hIcon=null;b._hLabel=null;b.onBuildPanel=FUiTreeNodeCell_onBuildPanel;b.onBuild=FUiTreeNodeCell_onBuild;b.onClick=RClass.register(b,new AEventClick("onClick"),FUiTreeNodeCell_onClick);b.onDoubleClick=RClass.register(b,
new AEventDoubleClick("onDoubleClick"),FUiTreeNodeCell_onDoubleClick);b.construct=FUiTreeNodeCell_construct;b.icon=FUiTreeNodeCell_icon;b.setIcon=FUiTreeNodeCell_setIcon;b.get=FUiTreeNodeCell_get;b.set=FUiTreeNodeCell_set;return b}function FUiTreeNodeCell_onBuildPanel(b){this._hPanel=RBuilder.createTableCell(b,this.styleName("Panel"))}function FUiTreeNodeCell_onBuild(b){this.__base.FUiControl.onBuild.call(this,b);b=this._hPanel;this.attachEvent("onClick",b);this.attachEvent("onDoubleClick",b)}
function FUiTreeNodeCell_onClick(b){b.treeNode=this._node;b.treeColumn=this._column;b.treeNodeCell=this;this.processClickListener(b)}function FUiTreeNodeCell_onDoubleClick(b){b.treeNode=this._node;b.treeColumn=this._column;b.treeNodeCell=this;this.processDoubleClickListener(b)}function FUiTreeNodeCell_construct(){this.__base.FUiControl.construct.call(this);this._attributes=new TAttributes}function FUiTreeNodeCell_icon(){return o._icon}
function FUiTreeNodeCell_setIcon(b){var f=this._hIcon;f||(f=this._hIcon=RBuilder.appendIcon(this._hPanel,null,null,16,16));f.src=RResource.iconPath(b)}function FUiTreeNodeCell_get(){}function FUiTreeNodeCell_set(b){}
function FUiTreeNodeType(b){b=RClass.inherits(this,b,FUiComponent);b._linker=RClass.register(b,new APtyString("_linker"));b._icon=RClass.register(b,new APtyString("_icon"));b._service=RClass.register(b,new APtyString("_service"));b._action=RClass.register(b,new APtyString("_action"));b._config=RClass.register(b,new APtyConfig("_config"));b.linker=FUiTreeNodeType_linker;b.icon=FUiTreeNodeType_icon;b.service=FUiTreeNodeType_service;b.action=FUiTreeNodeType_action;b.get=FUiTreeNodeType_get;b.set=FUiTreeNodeType_set;
b.innerDump=FUiTreeNodeType_innerDump;return b}function FUiTreeNodeType_linker(){return this._linker}function FUiTreeNodeType_icon(){return this._icon}function FUiTreeNodeType_service(){return this._service}function FUiTreeNodeType_action(){return this._action}function FUiTreeNodeType_get(b){return this._config?this._config.get(b):null}function FUiTreeNodeType_set(b,f){this._config&&this._config.set(b,f)}
function FUiTreeNodeType_innerDump(b){b.append(RClass.dump(this));b.append("[linker=",this._linker);b.append(", icon=",this._icon);b.append(", service=",this._service);b.append(", action=",this._action);b.append("]")}
function FUiTreeView(b){b=RClass.inherits(this,b,FUiContainer);b._optionCheck=RClass.register(b,new APtyBoolean("_optionCheck"),!1);b._indent=RClass.register(b,new APtyInteger("_indent"),16);b._stylePanel=RClass.register(b,new AStyle("_stylePanel","Panel"));b._styleNodePanel=RClass.register(b,new AStyle("_styleNodePanel","NodePanel"));b._styleNodeForm=RClass.register(b,new AStyle("_styleNodeForm","NodeForm"));b._attributes=null;b._nodeTypes=null;b._nodeColumns=null;b._nodeLevels=null;b._nodes=null;
b._allNodes=null;b._defaultNodeType=null;b._focusNode=null;b._loadingNode=null;b._freeNodes=null;b._iconPlus="control.treeview.plus";b._iconMinus="control.treeview.minus";b._iconNode="control.treeview.node";b._iconLoading="control.treeview.loading";b._hNodePanel=null;b._hNodeForm=null;b._hHeadLine=null;b._hNodeRows=null;b.lsnsEnter=new TListeners;b.lsnsLeave=new TListeners;b.lsnsClick=new TListeners;b.onBuildPanel=FUiTreeView_onBuildPanel;b.onBuild=FUiTreeView_onBuild;b.onNodeCheckClick=RClass.register(b,
new AEventClick("onNodeCheckClick"),FUiTreeView_onNodeCheckClick);b.construct=FUiTreeView_construct;b.attributes=FUiTreeView_attributes;b.nodeTypes=FUiTreeView_nodeTypes;b.nodeColumns=FUiTreeView_nodeColumns;b.nodeLevels=FUiTreeView_nodeLevels;b.nodes=FUiTreeView_nodes;b.findType=FUiTreeView_findType;b.findByName=FUiTreeView_findByName;b.findByUuid=FUiTreeView_findByUuid;b.createChild=FUiTreeView_createChild;b.createNode=FUiTreeView_createNode;b.appendNode=FUiTreeView_appendNode;b.selectNode=FUiTreeView_selectNode;
b.push=FUiTreeView_push;b.freeNode=FUiTreeView_freeNode;b.calculateHeight=FUiTreeView_calculateHeight;b.extendAuto=FUiTreeView_extendAuto;b.extendAll=FUiTreeView_extendAll;b.loadNode=RMethod.empty;b.refresh=FUiTreeView_refresh;b.filterNode=FUiTreeView_filterNode;b.clear=FUiTreeView_clear;b.dispose=FUiTreeView_dispose;return b}function FUiTreeView_onBuildPanel(b){this._hPanel=RBuilder.createTable(b.hDocument,this.styleName("Panel"))}
function FUiTreeView_onBuild(b){this.__base.FUiContainer.onBuild.call(this,b);var f=RBuilder.appendTableRow(this._hPanel),f=RBuilder.appendTableCell(f),f=this._hNodePanel=RBuilder.appendDiv(f,this.styleName("NodePanel")),f=this._hNodeForm=RBuilder.appendTable(f,this.styleName("NodeForm"));f.width="100%";this._hHeadLine=RBuilder.appendTableRow(f);this._hNodeRows=f.children[0];f=this._loadingNode=RClass.create(FUiTreeNode);f._tree=this;f._label=RContext.get("FUiTreeView:loading");f._icon=this._iconLoading;
f.build(b);this.appendNode(f);f.hide();b=this._nodes;if(!b.isEmpty())for(var f=b.count(),h=0;h<f;h++)this.appendNode(b.get(h));this.extendAuto()}
function FUiTreeView_onNodeCheckClick(b,f){if(b&&RClass.isClass(b,FUiTreeNode)){var h=b.check(),q=b.controls;if(q)for(var u=0;u<q.count;u++){var z=q.value(u);z&&RClass.isClass(z,FUiTreeNode)&&z.setCheck(h)}for(q=b.parentNode;q;){if(h)q.setCheck(h);else{for(var z=q.controls,A=z.count,u=0;u<A;u++){var B=z.value(u);if(B&&RClass.isClass(B,FUiTreeNode)&&B.check())return}q.setCheck(!1)}q=q.parentNode}}}
function FUiTreeView_construct(){this.__base.FUiContainer.construct.call(this);this._attributes=new TAttributes;this._nodeTypes=new TDictionary;this._nodeColumns=new TDictionary;this._nodeLevels=new TDictionary;this._nodes=new TObjects;this._allNodes=new TObjects;this._freeNodes=new TObjects;this._defaultNodeType=RClass.create(FUiTreeNodeType)}function FUiTreeView_attributes(){return this._attributes}function FUiTreeView_nodeTypes(){return this._nodeTypes}
function FUiTreeView_nodeColumns(){return this._nodeColumns}function FUiTreeView_nodeLevels(){return this._nodeLevels}function FUiTreeView_nodes(){return this._nodes}function FUiTreeView_findType(b){return this._nodeTypes.get(b)}function FUiTreeView_findByName(b){var f=this._allNodes,h=f.count();if(h)for(var q=0;q<h;q++){var u=f.get(q);if(u._name==b)return u}}function FUiTreeView_findByUuid(b){var f=this._allNodes,h=f.count();if(h)for(var q=0;q<h;q++){var u=f.get(q);if(u._uuid==b)return u}}
function FUiTreeView_createChild(b){var f=null;switch(b.name()){case "TreeColumn":f=RClass.create(FUiTreeColumn);break;case "TreeLevel":f=RClass.create(FUiTreeLevel);break;case "TreeNodeType":f=RClass.create(FUiTreeNodeType);break;case "TreeNode":f=RClass.create(FUiTreeNode);break;default:throw new TError(this,"Unknown child type. (config={1})",b.xml());}f._tree=this;return f}
function FUiTreeView_createNode(){var b=this._freeNodes.pop();b||(b=RClass.create(FUiTreeNode),b._tree=this,b.build(this._hPanel));RHtml.visibleSet(b._hPanel,!0);this._allNodes.push(b);return b}
function FUiTreeView_appendNode(b,f){if(!b._statusLinked){var h=b._hPanel;if(f){var q=f.searchLast()._hPanel.rowIndex;h.parentElement?(h.rowIndex>q&&q++,RHtml.tableMoveRow(this._hNodeForm,h.rowIndex,q)):(this._hNodeRows.appendChild(h),RHtml.tableMoveRow(this._hNodeForm,h.rowIndex,q+1));b.setLevel(f._level+1)}else this._hNodeRows.appendChild(h),b.setLevel(0);b._statusLinked=!0}}
function FUiTreeView_selectNode(b,f){var h=this._focusNode;if(f){if(b){if(h){if(h==b)return;b.isFolder()?h.select(!0):h.select(!1)}b.isFolder()||(b.select(!0),this._focusNode=b)}}else b&&b.select(!1),h&&h.select(!1)}
function FUiTreeView_push(b){this.__base.FUiContainer.push.call(this,b);b._tree=this;RClass.isClass(b,FUiTreeColumn)?this._nodeColumns.set(b.name(),b):RClass.isClass(b,FUiTreeLevel)?this._nodeLevels.set(b.id(),b):RClass.isClass(b,FUiTreeNodeType)?this._nodeTypes.set(b.linker(),b):RClass.isClass(b,FUiTreeNode)&&(this._nodes.push(b),this._allNodes.push(b))}function FUiTreeView_freeNode(b){b._statusLinked&&(b._statusLinked=!1,b.hidden(),this._allNodes.remove(b),this._freeNodes.push(b))}
function FUiTreeView_calculateHeight(){for(var b=this._allNodes,f=b.count(),h=0;h<f;h++){var q=b.get(h);RHtml.displayGet(q._hPanel)&&f++}return 29*f}function FUiTreeView_extendAuto(b){if(b=b?b._nodes:this._nodes){var f=b.count;if(f)for(var h=0;h<f;h++){var q=b.get(h);q.extend(q._extended);q._extended&&this.extendAuto(q)}}}function FUiTreeView_extendAll(b,f){var h=b?b._nodes:this._nodes;if(h){var q=h.count();if(q)for(var u=0;u<q;u++){var z=h.get(u);z.extend(f);this.extendAll(z,f)}}}
function FUiTreeView_refresh(){this.parentObj&&(this.parentObj.style.height=this.calculateHeight())}
function FUiTreeView_filterNode(b,f){var h=this._allNodes.count(),q=null,u=null;if(b){label=label.toLowerCase();var z=null,A=0;f&&(f=f.toLowerCase(),z=f.split("|"),A=z.length);for(C=0;C<h;C++)if(D=this._allNodes.get(C),!D.isDelete)if(q=D.label.toLowerCase(),z)for(var u=D.linkAttr.toLowerCase(),B=0;B<A;B++){if(-1!=u.indexOf(z[B])){D.show(-1!=q.indexOf(label));break}}else D.show(-1!=q.indexOf(label))}else for(var C=0;C<h;C++){var D=this._allNodes.get(C);D.isDelete||D.show(!0)}}
function FUiTreeView_clear(){var b=this._nodes;if(b){for(var f=b.count()-1;0<=f;f--)b.get(f).remove();b.clear()}this._allNodes.clear()}function FUiTreeView_dispose(){this.__base.FUiContainer.dispose.call(this);var b=this._nodes;b&&(b.dispose(),this._nodes=null);if(b=this._allNodes)b.dispose(),this._allNodes=null;this._hHeadLine=this._hNodeForm=this._hNodePanel=null;return!0}
function FUiFramePage(b){b=RClass.inherits(this,b,FUiContainer);b._styleContainer=RClass.register(b,new AStyle("_styleContainer"));b._hContainer=null;b.onBuildPanel=FUiFramePage_onBuildPanel;b.onBuild=FUiFramePage_onBuild;b.oeResize=FUiFramePage_oeResize;b.appendChild=FUiFramePage_appendChild;return b}function FUiFramePage_onBuildPanel(b){(this._hPanel=RBuilder.createTableCell(b,this.styleName("Panel"))).vAlign="top"}
function FUiFramePage_onBuild(b){this.__base.FUiContainer.onBuild.call(this,b);b=this._hPanel;this._scrollCd!=EUiScroll.None?(b=this._hContainer=RBuilder.appendDiv(b,this.styleName("Container")),RControl.setStyleScroll(b,this._scrollCd)):this._hContainer=b}
function FUiFramePage_oeResize(b){b=this._parent;if(b._directionCd!=EUiDirection.Horizontal&&b._directionCd!=EUiDirection.Vertical)throw new TError(this,"Unknown direcion type. (direction_cd={1})",this._directionCd);return EEventStatus.Continue}function FUiFramePage_appendChild(b){this._hContainer.appendChild(b._hPanel)}
function FUiFrameSet(b){b=RClass.inherits(this,b,FUiContainer);b._directionCd=RClass.register(b,new APtyEnum("_directionCd",null,EUiDirection),EUiDirection.Vertical);b._stylePanel=RClass.register(b,new AStyle("_stylePanel"));b._frames=null;b._hLine=null;b.onBuildPanel=FUiFrameSet_onBuildPanel;b.construct=FUiFrameSet_construct;b.appendFrame=FUiFrameSet_appendFrame;b.appendSpliter=FUiFrameSet_appendSpliter;b.appendChild=FUiFrameSet_appendChild;b.dispose=FUiFrameSet_dispose;return b}
function FUiFrameSet_onBuildPanel(b){this._hPanel=RBuilder.createTable(b,this.styleName("Panel"))}function FUiFrameSet_construct(){this.__base.FUiContainer.construct.call(this);this._frames=new TObjects}
function FUiFrameSet_appendFrame(b){if(this._directionCd==EUiDirection.Horizontal){var f=this._hLine;f||(f=this._hLine=RBuilder.appendTableRow(this._hPanel));b.setPanel(f);if(f=b._size.width)b._hPanel.width=f}else if(this._directionCd==EUiDirection.Vertical){if(f=RBuilder.appendTableRow(this._hPanel),b.setPanel(f),f=b._size.height)b._hPanel.height=f}else throw new TError(this,"Unknown direcion type. (direction_cd={1})",this._directionCd);this._frames.push(b)}
function FUiFrameSet_appendSpliter(b){var f=null;b?f=b:(f=RClass.create(FUiFrameSpliter),f.build(this._hPanel));if(this._directionCd==EUiDirection.Horizontal)this._hLine.appendChild(f._hPanel),f._hPanel.style.width="4px";else if(this._directionCd==EUiDirection.Vertical)RBuilder.appendTableRow(this._hPanel).appendChild(f._hPanel),f._hPanel.style.height="4px";else throw new TError(this,"Unknown direcion type. (direction_cd={1})",this._directionCd);this._frames.push(f);return f}
function FUiFrameSet_appendChild(b){b._frameset=this;RClass.isClass(b,FUiFramePage)?this.appendFrame(b):RClass.isClass(b,FUiFrameSpliter)?this.appendSpliter(b):this.__base.FUiContainer.appendChild.call(this,b)}function FUiFrameSet_dispose(){this.__base.FUiContainer.dispose.call(this)}
function FUiFrameSpliter(b){b=RClass.inherits(this,b,FUiControl,MDragable);b._styleNormal=RClass.register(b,new AStyle("_styleNormal","Normal"));b._styleHover=RClass.register(b,new AStyle("_styleHover","Hover"));b._styleDraging=RClass.register(b,new AStyle("_styleDraging","Draging"));b._directionCd=EUiDirection.Horizontal;b._alignCd=EUiAlign.Left;b._dragClientX=0;b._dragClientY=0;b._dragPanelX=0;b._dragPanelY=0;b._dragSizeX=0;b._dragSizeY=0;b._hDrag=null;b._hSize=null;b.onBuildPanel=FUiFrameSpliter_onBuildPanel;
b.onBuild=FUiFrameSpliter_onBuild;b.onMouseEnter=RClass.register(b,new AEventMouseEnter("onMouseEnter"),FUiFrameSpliter_onMouseEnter);b.onMouseLeave=RClass.register(b,new AEventMouseLeave("onMouseLeave"),FUiFrameSpliter_onMouseLeave);b.onDragStart=FUiFrameSpliter_onDragStart;b.onDragMove=FUiFrameSpliter_onDragMove;b.onDragStop=FUiFrameSpliter_onDragStop;b.construct=FUiFrameSpliter_construct;b.dispose=FUiFrameSpliter_dispose;return b}
function FUiFrameSpliter_onBuildPanel(b){this._hPanel=RBuilder.createTableCell(b,this.styleName("Normal"))}
function FUiFrameSpliter_onBuild(b){this.__base.FUiControl.onBuild.call(this,b);var f=this._hPanel;f.__linker=this;b=this._hDrag=RBuilder.createDiv(b,this.styleName("Draging"));b.__linker=this;b.style.position="absolute";RHtml.displaySet(b,!1);RConsole.find(FDragConsole).register(this);f.appendChild(b);f.style.cursor="e-resize";f._plinker=this;this.attachEvent("onMouseEnter",f,this.onMouseEnter);this.attachEvent("onMouseLeave",f,this.onMouseLeave)}
function FUiFrameSpliter_onMouseEnter(b){this._hPanel.className=this.styleName("Hover")}function FUiFrameSpliter_onMouseLeave(b){this._hPanel.className=this.styleName("Normal")}
function FUiFrameSpliter_onDragStart(b){var f=this._hPanel,h=this._hDrag,q=h.style;if(this._directionCd==EUiDirection.Horizontal)this._dragClientX=b.clientX,this._dragPanelX=RHtml.clientX(f),this._dragSizeX=this._hSize.offsetWidth,q.cursor=EMouseCursor.HSize;else if(this._directionCd==EUiDirection.Vertical)this._dragClientY=b.clientY,this._dragPanelY=RHtml.clientY(f),this._sizeY=this._hSize.offsetHeight,q.cursor=EMouseCursor.VSize;else throw new TError(this,"Unknown direction type. (direction_cd={1})",
this._directionCd);q.left=RHtml.clientX(f)+"px";q.top=RHtml.clientY(f)+"px";q.width=f.offsetWidth+"px";q.height=f.offsetHeight+"px";RHtml.visibleSet(h,!0)}
function FUiFrameSpliter_onDragMove(b){var f=this._hDrag;if(this._directionCd==EUiDirection.Horizontal)b=this._dragPanelX+(b.clientX-this._dragClientX),40<b&&(f.style.left=b+"px");else if(this._directionCd==EUiDirection.Vertical)b=this._dragPanelY+(b.clientY-this._dragClientY),40<b&&(f.style.top=b+"px");else throw new TError(this,"Unknown direction type. (direction_cd={1})",this._directionCd);}
function FUiFrameSpliter_onDragStop(b){var f=this._hDrag;if(this._directionCd==EUiDirection.Horizontal){b=b.clientX-this._dragClientX;var h=0;if(this._alignCd===EUiAlign.Left)h=this._dragSizeX+b;else if(this._alignCd===EUiAlign.Right)h=this._dragSizeX-b;else throw new TError(this,"Unknown align type. (align_cd={1})",this._alignCd);40<h&&(this._hSize.style.width=h+"px")}else if(this._directionCd==EUiDirection.Vertical){b=b.clientY-this._dragClientY;h=this._dragSizeY+b;if(this._alignCd===EUiAlign.Top)h=
this._dragSizeY+b;else if(this._alignCd===EUiAlign.Bottom)h=this._dragSizeY-b;else throw new TError(this,"Unknown align type. (align_cd={1})",this._alignCd);40<h&&(this._hSize.style.width=h+"px")}else throw new TError(this,"Unknown direction type. (direction_cd={1})",this._directionCd);RHtml.visibleSet(f,!1)}function FUiFrameSpliter_construct(){this.__base.FUiControl.construct.call(this)}
function FUiFrameSpliter_dispose(){var b=this._hDrag;b&&(RHtml.free(b),this._hDrag=null);if(b=this._hSize)RHtml.free(b),this._hSize=null;this.__base.FUiControl.dispose.call(this)}
function FUiFrameSpliter_build(){var b=this.hForm=RBuilder.appendTable(this.hDrag);b.height=36;hc=this.hButton=b.insertRow().insertCell();hc.bgColor=this._dragBackgroundColor;hc.style.cursor="hand";this.hButtonIcon=RBuilder.appendIcon(hc,"ctl.FSpliter_Left");this.attachEvent("onSplitButtonEnter",hc,this.ohDragButtonEnter);this.attachEvent("onSplitButtonLeave",hc,this.ohDragButtonLeave);this.attachEvent("onSplitButtonClick",hc,this.ohDragButtonClick)}
function FUiFrameSpliter_link(b,f){var h=this.hDrag=b;this.attachEvent("onSplitDown",h,this.ohDragStart);this.attachEvent("onSplitMove",h,this.ohDragMove);this.attachEvent("onSplitUp",h,this.ohDragStop);this.attachEvent("onSplitDoubleClick",h,this.ohDragDoubleClick);EUiDirection.Vertical==this.direction?h.style.cursor="N-resize":EUiDirection.Horizontal==this.direction&&(h.style.cursor="E-resize");this.hSize=f;h=this.hLayer=RBuilder.append(null,"DIV");h.style.position="absolute";h.style.backgroundColor=
"#a5eaea";h.style.border="1 solid #70eaea";h.style.display="none";h.zIndex=3E4;RBuilder.appendEmpty(h,1,1)}function FUiFrameSpliter_click(){var b=this.hSize;b&&("none"==b.style.display?(b.style.display="block",this.hButtonIcon&&(this.hButtonIcon.src=RRes.iconPath("ctl.FSpliter_Left"))):(b.style.display="none",this.hButtonIcon&&(this.hButtonIcon.src=RRes.iconPath("ctl.FSpliter_Right"))))}
function FUiWorkspace(b){b=RClass.inherits(this,b,FUiContainer,MDescribeFrame);b._hContainer=null;b._frames=null;b.onBuildPanel=FUiWorkspace_onBuildPanel;b.appendChild=FUiWorkspace_appendChild;return b}function FUiWorkspace_onBuildPanel(b){this._hContainer=b.hDocument.body;this._hPanel=RBuilder.createDiv(b,this.styleName("Panel"))}function FUiWorkspace_appendChild(b){RClass.isClass(b,FUiFrameSet)&&this._hContainer.appendChild(b._hPanel)}
function MDataField(b){b=RClass.inherits(this,b,MDataValue);b._dataName=RClass.register(b,new APtyString("_dataName"));return b}
function MDataset(b){b=RClass.inherits(this,b,MDataContainer);b._dsDataset=RClass.register(b,new APtyString("_dsDataset","dataset"));b._dsPageSize=RClass.register(b,new APtyInteger("_dsPageSize","page_size"),20);b._dsInsertAction=RClass.register(b,new APtyString("_dsInsertAction","insert_action"));b._dsUpdateAction=RClass.register(b,new APtyString("_dsUpdateAction","update_action"));b._dsDeleteAction=RClass.register(b,new APtyString("_dsDeleteAction","delete_action"));b._dataSource=null;b.onDsFetch=
MDataset_onDsFetch;b.onDatasetLoadBegin=RMethod.empty;b.onDatasetLoad=RMethod.empty;b.onDatasetLoadEnd=RMethod.empty;b.oeDataLoad=MDataset_oeDataLoad;b.oeDataSave=MDataset_oeDataSave;b.oeDatasetLoad=MDataset_oeDatasetLoad;b.construct=MDataset_construct;b.loadDataset=MDataset_loadDataset;b.loadDatasets=MDataset_loadDatasets;b.dsDatasetLoad=MDataset_dsDatasetLoad;b.dsFetch=MDataset_dsFetch;return b}function MDataset_onDsFetch(b){this.dsDatasetLoad(b.datasets)}
function MDataset_oeDataLoad(b){b.isBefore()&&(b=b.source,b.selectDataset(),b.selectRow());return EEventStatus.Contine}function MDataset_oeDataSave(b){b.isBefore()&&(b=b.source,b.selectDataset(),b.selectRow());return EEventStatus.Contine}function MDataset_oeDatasetLoad(b){b.isBefore()&&(this._dataset=b=b.datasets.get(this._name),this.onDatasetLoad(b));return EEventStatus.Contine}function MDataset_construct(){}
function MDataset_loadDataset(b){this.dsStore=b;b.saveViewer(this.dsViewer);this.onLoadDataset(b)}function MDataset_loadDatasets(b){for(var f=b.count(),h=0;h<f;h++){var q=b.value(n),u=this.findByPath(q.name);if(!u)return RMessage.fatal(this,null,"Load dataset failed. (dataset={1}",q.name);u.loadDataset(q)}}function MDataset_dsDatasetLoad(b){var f=new TEventProcess(null,this,"oeDatasetLoad",MDataset);f.datasets=b;this.process(f);f.dispose()}
function MDataset_dsFetch(){var b=new TDatasetFetchArg;b.owner=this;b.name=this._name;b.callback=this.onDsFetch;RConsole.find(FDatasetConsole).fetch(b)}function MDataset_onDsPrepare(b){b.resultDatasets.set("/",null);this.loadDatasets(b.resultDatasets);this.doPrepare(b.resultRow);b.invokeSuccess()||(this.onLoadDatasetEnd(),this.focus())}function MDataset_onDsUpdate(b){this.loadDatasets(b.resultDatasets);this.onLoadDatasetEnd();this.focus()}
function MDataset_onDsCopy(b){this.loadDatasets(b.resultDatasets);this.onLoadDatasetEnd();this.focus()}function MDataset_onDsDelete(b){this.loadDatasets(b.resultDatasets);this.doDelete(b.resultRow);this.onLoadDatasetEnd();this.focus()}function MDataset_onDsProcess(b){var f=b.resultCallback;f&&f.invoke(this,b)}
function MDataset_toDeepAttributes(b,f){b||(b=new TAttributes);for(var h=new TList,q=this;q;){RClass.isClass(q,MDataset)&&h.push(q);if(!q.parent)break;q=q.topControl(MDataset)}for(var u=h.count;0<=u;u--)q=h.get(u),RClass.isClass(q,FForm)?q.toAttributes(b,f):RClass.isClass(f,FTable)&&(q=q.getCurrentRow())&&q.toAttributes(b,f);return b}function MDataset_onDsDoUpdate(b){b.invokeSuccess()||this.psRefresh();b.processFinish||(this.focus(),this.lsnsUpdateEnd.process(b));this.onLoadDatasetEnd()}
function MDataset_dsInitialize(){this.callEvent("onFormInitialize",this,this.__initializeEvent)}function MDataset_dsShow(){this.callEvent("onFormShow",this,this.__showEvent)}function MDataset_dsLoaded(){this.callEvent("onDatasetLoaded",this,this.__loadedEvent)}
function MDataset_dsSearch(b){this.psProgress(!0);var f=this.topControl(),h=this.fullPath();b&&(h=b.fullPath());b=new TDatasetFetchArg(f.name,f.formId,this.dsPageSize,0,!0,!1,h);b.mode=f._emode;b.searchs.append(this.dsGlobalSearchs);b.searchs.append(this.dsSearchs);b.orders.append(this.dsGlobalOrders);b.orders.append(this.dsOrders);this.toDeepAttributes(b.values);b.values.append(this.dsValues);b.callback=new TInvoke(this,this.onDsFetch);RConsole.find(FDatasetConsole).fetch(b)}
function MDataset_dsCopy(b){this.psProgress(!0);this.psMode(EMode.Insert);var f=new TDatasetFetchArg(this.name,this.formId,this.dsPageSize,0,!0);f.form=this;f.mode=EMode.Insert;this.dsSearchs.clear();this.dsSearchs.push(new TSearchItem("OUID",b.get("OUID")));f.searchs=this.dsSearchs;f.callback=new TInvoke(this,this.onDsCopy);this.onDsUpdateCheck(f)&&RConsole.find(FDatasetConsole).fetch(f)}
function MDataset_dsPrepare(b){this.psProgress(!0);this.psMode(EMode.Insert);var f=new TDatasetPrepareArg(this.name,this.formId);f.form=this;f.values.append(this.dsValues);f.callbackSuccess=b;this.onDsPrepareCheck(f)&&(f.callback=new TInvoke(this,this.onDsPrepare),RConsole.find(FDatasetConsole).prepare(f))}function MDataset_dsUpdate(b,f){this.psProgress(!0);this.psMode(EMode.Update);this.dsFetch(!0)}
function MDataset_dsDelete(b,f){this.psProgress(!0);this.psMode(EMode.Delete);var h=new TDatasetFetchArg(this.name,this.formId,this.dsPageSize,0,!0);h.callback=new TInvoke(this,this.onDsDelete);h.form=this;h.mode=EMode.Delete;b&&h.searchs.push(new TSearchItem("OUID",b));f&&h.searchs.push(new TSearchItem("OVER",f));h.values=this.dsValues;this.onDsDeleteCheck(h)&&RConsole.find(FDatasetConsole).fetch(h)}
function MDataset_dsMode(b){switch(b){case EMode.Insert:this.dsPrepare();break;case EMode.Update:this.dsUpdate();break;case EMode.Delete:this.dsDelete()}}
function MDataset_dsDoUpdate(b,f){if(this.psValid()){var h=this.topControl(),h=new TDatasetUpdateArg(h.name,this.formId,this.dsName);h.form=this;h.path=this.fullPath();h.mode=this._emode;h.codes=this.getDataCodes();h.callback=new TInvoke(this,this.onDsDoUpdate);h.callbackSuccess=b;if(EMode.Insert==this._emode||EMode.Delete==this._emode)h.dataset.rows.append(this.getCurrentRows());else if(h.dataset.rows.append(this.getChangedRows()),!f&&!h.hasData())return RMessage.warn(this,RContext.get("MDataset:nochange"));
this.psProgress(!0);RConsole.find(FDatasetConsole).update(h)}}function MDataset_dsProcess(b,f){if(this.psValid()){var h=new TDatasetServiceArg(this.topControl().name,b);h.form=this;h.controlName=this.name;this.toDeepAttributes(h.attributes);h.codes=this.getDataCodes();h.push(this.getCurrentRow());h.resultCallback=f;this.psProgress(!0);h.callback=new TInvoke(this,this.onDsProcess);RConsole.find(FFormConsole).process(h)}}
function MDataset_dsProcessCustom(b,f,h,q){if(q||this.psValid()){f=new TDatasetServiceArg(this.topControl().name,f);f.form=this;f.controlName=this.name;f.attributes=b;f.codes=this.getDataCodes();f.push(this.getCurrentRow());f.resultCallback=h;if(!q&&!f.hasData())return RMessage.warn(this,RContext.get("MDataset:nodata"));this.psProgress(!0);f.callback=new TInvoke(this,this.onDsProcess);RConsole.find(FFormConsole).process(f)}}
function MDataset_dsProcessSelected(b,f){if(this.psValid()){var h=new TDatasetServiceArg(this.topControl().name,b);h.form=this;h.controlName=this.name;this.toDeepAttributes(h.attributes);h.codes=this.getDataCodes();h.rows=this.getSelectedRows();if(0<h.rows.count)h.resultCallback=f,this.psProgress(!0),h.callback=new TInvoke(this,this.onDsProcess),RConsole.find(FFormConsole).process(h),this.clearSelectRows();else return RMessage.warn(this,RContext.get("MDataset:norows"))}}
function MDataset_dsProcessChanged(b,f){if(this.psValid()){var h=new TDatasetServiceArg(this.topControl().name,b);h.form=this;h.controlName=this.name;this.toDeepAttributes(h.attributes);h.codes=this.getDataCodes();h.rows=this.getChangedRows();h.resultCallback=f;if(!h.hasData())return RMessage.warn(this,RContext.get("MDataset:nochange"));this.psProgress(!0);h.callback=new TInvoke(this,this.onDsProcess);RConsole.find(FFormConsole).process(h)}}
function MDataset_dsProcessAll(b,f){if(this.psValid()){var h=new TDatasetServiceArg(this.topControl().name,b);h.form=this;h.controlName=this.name;this.toDeepAttributes(h.attributes);h.codes=this.getDataCodes();h.rows=this.getRows();h.resultCallback=f;this.psProgress(!0);h.callback=new TInvoke(this,this.onDsProcess);RConsole.find(FFormConsole).process(h)}}function MDataset_psProgress(b){if(this.__progress!=b){this.__progress=b;var f=this.__progressProcess;f.enable=b;this.process(f)}}
function MDataset_psValid(){var b=this.__validProcess,f=b.controls;f.clear();this.process(b);return f.isEmpty()?!0:(b=RConsole.find(FCheckWindowConsole).find(),b.set(f),b.show(),!1)}function MDataset_dsCurrent(){}function MDataset_dsIsChanged(){var b=this.dsStore;return b?b.isChanged():!1}function MDataset_dsCount(){return this.dsStore?this.dsStore.count:0}
function MDataset_dsMove(b){var f=this.dsStore;if(null!=b||f)RInt.isInt(b)?f.move(b):EDataAction.First==b?f.moveFirst():EDataAction.Prior==b?f.movePrior():EDataAction.Next==b?f.moveNext():EDataAction.Last==b?f.moveLast():RMessage.fatal(this,null,"Unknown position (postion={0})",b),RClass.isClass(this,MValue)&&this.loadValue(f.current())}
function MDataset_dsMovePage(b){var f=this.dsStore;RInt.isInt(b)||(EDataAction.First==b?b=0:EDataAction.Prior==b?(b=f.pageIndex,0<b&&b--):EDataAction.Next==b?(b=f.pageIndex,b<f.pageCount-1&&b++):EDataAction.Last==b?b=f.pageCount-1:RMessage.fatal(this,null,"Unknown page (page={0})",b));b!=f.pageIndex&&(this.psProgress(!0),f=this.topControl(MDataset),b=new TDatasetFetchArg(f.name,f.formId,this.dsPageSize,b,!0),b.path=this.fullPath(),b.mode=f._emode,b.searchs.append(this.dsGlobalSearchs),b.searchs.append(this.dsSearchs),
b.orders.append(this.dsGlobalOrders),b.orders.append(this.dsOrders),b.values=this.toDeepAttributes(),b.values.append(this.dsValues),b.callback=new TInvoke(this,this.onDsFetch),RConsole.find(FDatasetConsole).fetch(b))}function MDataset_dsGet(b){return this.dsStore?this.dsStore.get(b):""}function MDataset_dsSet(b,f){this.dsStore&&this.dsStore.set(b,f)}function MDataset_dsRefresh(){this.dsService&&this.dsMove(this.dsPage,!0)}
function MDataset_doSearch(){var b=this.dsSearchWindow;b||(b=this.dsSearchWindow=top.RControl.create(top.FSearchWindow),b.linkDsControl(this));b.show()}function FDatasetConsole(b){b=RClass.inherits(this,b,FConsole);b._scopeCd=EScope.Local;b._service="cloud.data.frame";b._datasets=null;b.onFetch=FDatasetConsole_onFetch;b.construct=FDatasetConsole_construct;b.loadDataset=FDatasetConsole_loadDataset;b.loadDatasets=FDatasetConsole_loadDatasets;b.fetch=FDatasetConsole_fetch;return b}
function FDatasetConsole_onFetch(b){var f=b.parameter,h=b.outputNode;if(h.hasNode()){this.loadDatasets(h);b=f.datasets;for(var h=h.nodes(),q=h.count(),u=0;u<q;u++){var z=h.get(u).get("name"),A=this._datasets.get(z);b.set(z,A)}}f.process()}function FDatasetConsole_construct(){this.__base.FConsole.construct.call(this);this._datasets=new TDictionary}
function FDatasetConsole_loadDataset(b){var f=b.get("name");if(RString.isEmpty(f))throw new TError("Unknown dataset name.");var h=this._datasets.get(f);h||(h=new TDataset,h.name=f,this._datasets.set(f,h));h.clear();h.loadConfig(b);return h}function FDatasetConsole_loadDatasets(b){if(b.hasNode()){b=b.nodes();for(var f=b.count(),h=0;h<f;h++){var q=b.get(h);q.isName("Dataset")&&this.loadDataset(q)}}}
function FDatasetConsole_fetch(b){var f=new TXmlDocument,h=f.root();h.set("action","fetch");b.saveConfig(h.create("Frame"));h=new SXmlEvent;h.owner=this;h.url=RService.url(this._service);h.action=EDataAction.Fetch;h.parameter=b;h.inputDocument=f;h.callback=this.onFetch;RConsole.find(FXmlConsole).process(h)}function FDatasetConsole_onScalarLoaded(b,f){if(f.hasNode()){var h=b.resultConfig=f.find("Control");h&&(b.result=h.get("result"))}b.invoke()}
function FDatasetConsole_scalar(b){var f=new TXmlDocument,h=f.root();h.set("action",EDataAction.Scalar);h.push(b.toNode());h=new TEvent(this,EXmlEvent.Send,this.onLoaded);h.url=RService.url("logic.webform.dataset");h.action=EDataAction.Scalar;h.argument=b;h.document=f;RConsole.find(FXmlConsole).process(h)}function FDatasetConsole_onCompleteLoaded(b,f){if(f.hasNode()){var h=f.find("Control");h&&(b.resultConfig=h)}b.invoke()}function FDatasetConsole_onLovLoadeded(b,f){b.lovNode=f;b.invoke()}
function FDatasetConsole_onPrepareLoaded(b,f){var h=b.resultDatasets;if(f.hasNode())for(var q=f.nodes,u=q.count,z=0;z<u;z++){var A=q.get(z),B=A.get("id");RString.isEmpty(B)||this.loadDatasets(h,B,A)}if(!h.isEmpty())for(q=h.count,z=0;z<q;z++)if(u=h.value(z),"/"==u.name){b.resultRow=u.row(0);break}b.invoke()}
function FDatasetConsole_onUpdateLoaded(b,f){var h=f.find("Form");if(h){var q=h.get("id");if(h=h.find("Dataset"))q=b.resultDataset=this.loadDataset(q,h),b.resultRow=q.row(0),b.invoke(),RWindow.setEnable(!0)}}
function FDatasetConsole_onLoaded(b){var f=b.document.root(),h=b.argument;if(!b.messageChecked){var q=new TMessageArg;q.argument=h;q.form=h.form;q.config=f;q.invokeCaller=new TInvoke(this,this.onLoaded);q.invokeParam=b;q.event=b;if(!RConsole.find(FMessageConsole).checkResult(q))return}h.configResult=f;switch(b.action){case EDataAction.Fetch:this.onFetchLoaded(h,f);break;case EDataAction.Prepare:this.onPrepareLoaded(h,f);break;case EDataAction.Update:this.onUpdateLoaded(h,f);break;case EDataAction.Lov:this.onLovLoaded(h,
f);break;case EDataAction.Scalar:this.onScalarLoaded(h,f);break;case EDataAction.Complete:this.onCompleteLoaded(h,f)}RConsole.find(FListenerConsole).process(MDataset,EAction.Changed,b,b)}function FDatasetConsole_complete(b){var f=new TXmlDocument,h=f.root();h.set("action","complete");h.push(b.toNode());h=new TEvent(this,EXmlEvent.Send,this.onLoaded);h.url=RService.url("logic.webform.dataset");h.action=EDataAction.Complete;h.argument=b;h.document=f;RConsole.find(FXmlConsole).process(h)}
function FDatasetConsole_lov(b){var f=new TXmlDocument,h=f.root();h.set("action","lov");h.push(b.toNode());h=new TEvent(this,EXmlEvent.Send,this.onLoaded);h.url=RService.url("logic.webform.dataset");h.action=EDataAction.Lov;h.argument=b;h.document=f;RConsole.find(FXmlConsole).process(h)}
function FDatasetConsole_prepare(b){var f=new TXmlDocument,h=f.root();h.set("action","prepare");h.push(b.toNode());h=new TEvent(this,EXmlEvent.Send,this.onLoaded);h.url=RService.url("logic.webform.dataset");h.action=EDataAction.Prepare;h.argument=b;h.document=f;RConsole.find(FXmlConsole).process(h)}
function FDatasetConsole_update(b){var f=new TXmlDocument,h=f.root();h.set("action","update");b.checked&&h.set("checked",b.checked);h.push(b.toNode());h=new TEvent(this,EXmlEvent.Send,this.onLoaded);h.url=RService.url("logic.webform.dataset");h.action=EDataAction.Update;h.argument=b;h.document=f;RConsole.find(FXmlConsole).process(h)}function FDatasetConsole_get(b){return this.forms.get(b)}function FDatasetConsole_getById(b){return this._datasets.get(b)}
function FDatasetConsole_getByPath(b,f){var h=this.get(b);return h?h.get(f):null}function FDatasetConsole_onTreeLoaded(b){alert(1)}function FDatasetConsole_onColumnFetch(b){var f=b.document.root();if(RConsole.find(FMessageConsole).checkResult(f)){b=b.arg;if(f.hasNode())for(var f=f.nodes,h=f.count,q=0;q<h;q++){var u=f.get(q);if(u.hasNode()){var u=u.nodes,z=u.count;for(n=0;n<z;n++){var A=u.get(n);if("Data"==A.name){b.resultConfig=A;break}}}}b.invoke()}}
function FDatasetConsole_columnNodeFetch(b){var f=new TXmlDocument,h=f.root();h.set("action",b.action);var q=b.toNode();h.push(q);h=RService.url(b.service);q=new TEvent(this,EXmlEvent.Send,this.onColumnFetch);q.url=h;q.document=f;q.arg=b;q.action=EDataAction.Fetch;RConsole.find(FXmlConsole).process(q)}
function FDatasetConsole_treeUpdate(b){var f=new TXmlDocument,h=f.root();h.set("action",b.action);var q=b.toNode();h.push(q);h=RService.url(b.service);q=new TEvent(this,EXmlEvent.Send,this.onTreeLoaded);q.url=h;q.document=f;q.arg=b;q.action=EDataAction.TreeUpdate;RConsole.find(FXmlConsole).process(q)}
function FDataSource(b){b=RClass.inherits(this,b,FObject);b._currentRow=null;b._currentDataset=null;b._datasets=null;b.construct=FDataSource_construct;b.selectDataset=FDataSource_selectDataset;b.currentDataset=FDataSource_currentDataset;b.selectRow=FDataSource_selectRow;b.currentRow=FDataSource_currentRow;return b}function FDataSource_construct(){this.__base.FObject.construct.call(this);this._datasets=new TDictionary}
function FDataSource_selectDataset(b){b=RString.nvl(b,"default");var f=this._datasets.get(b);null==f&&(f=new TDataset,f._name=b,this._datasets.set(b,f));this._currentDataset=f}function FDataSource_currentDataset(){return this._currentDataset}function FDataSource_selectRow(b){if(b)this._currentRow=b;else{b=this._currentDataset;var f=b.rows().first();null==f&&(f=b.createRow());return this._currentRow=f}}function FDataSource_currentRow(){return this._currentRow}
function FDataSource_create(b){return this.dataset.create(b)}function FDataSource_count(){return this.dataset.count}function FDataSource_row(b){return this.dataset.get(b)}function FDataSource_current(){return this.row(this._position)}function FDataSource_isChanged(){for(var b=this.dataset,f=0;f<b.count;f++){var h=b.get(f);if(h&&h.isSave())return!0}return!1}function FDataSource_get(b){var f=this.current();return f?f.get(b):""}function FDataSource_set(b,f){var h=this.current();h&&h.set(b,f)}
function FDataSource_move(b){this._position=b}function FDataSource_moveToRow(b){b=this.dataset.indexOf(b);-1!=b&&(this._position=b)}function FDataSource_find(){return this.dataset.findByArgs(arguments)}function FDataSource_loadNode(b){if(b&&b.nodes){b=b.nodes;for(var f=0;f<b.count;f++){var h=b.get(f);if(h&&h.isName("Row")){var q=this.dataset.create();q.loadNode(h);q.store()}}}}function FDataSource_dump(b){b=RString.nvlStr(b);b.appendLine(RClass.dump(this));this.dataset.dump(b);return b}
function FUiDataEdit(b){b=RClass.inherits(this,b,FUiEdit);b._inputSize=RClass.register(b,new APtySize2("_inputSize"));b._styleInputPanel=RClass.register(b,new AStyle("_styleInputPanel"));b._styleInput=RClass.register(b,new AStyle("_styleInput"));b._hInput=null;b.onBuildEditValue=FUiDataEdit_onBuildEditValue;b.onInputEdit=RClass.register(b,new AEventInputChanged("onInputEdit"),FUiDataEdit_onInputEdit);b.construct=FUiDataEdit_construct;b.get=FUiDataEdit_get;b.set=FUiDataEdit_set;b.refreshValue=FUiDataEdit_refreshValue;
return b}function FUiDataEdit_oeDataLoad(b){return EEventStatus.Stop}function FUiDataEdit_oeDataSave(b){return EEventStatus.Stop}function FUiDataEdit_onBuildEditValue(b){b=this._hValuePanel;b.className=this.styleName("InputPanel");b=this._hInput=RBuilder.appendEdit(b,this.styleName("Input"));this._editLength&&(b.maxLength=this._editLength)}function FUiDataEdit_onInputEdit(b){this.refreshValue()}
function FUiDataEdit_construct(){this.__base.FUiEdit.construct.call(this);this._inputSize=new SSize2(120,0)}function FUiDataEdit_get(){var b=this.__base.FUiEdit.get.call(this),f=this._hInput;f&&(b=f.value);return b}function FUiDataEdit_set(b){this.__base.FUiEdit.set.call(this,b);var f=this._hInput;f&&(f.value=RString.nvl(b))}function FUiDataEdit_refreshValue(){this.processDataChangedListener(this)}
function FUiDataEdit_onDataKeyDown(b,f){this.__base.FUiEdit.onDataKeyDown.call(this,b,f);this.editCase&&RKey.fixCase(f,this.editCase)}function FUiDataEdit_formatValue(b){b=RString.nvl(b);ECase.Upper==this.editCase?b=RString.toUpper(b):ECase.Lower==this.editCase&&(b=RString.toLower(b));return b}
function FUiDataEdit_setText(b){this.hEdit&&(this.hEdit.value="U"==this.editCase?RString.toUpper(b):"L"==this.editCase?RString.toLower(b):b,this.hEdit.style.textAlign="right"==this.editAlign?"right":"left"==this.editAlign?"left":"center")}
function FUiDataEdit_validText(b){var f=this.__base.FUiEdit.validText.call(this,b);if(!f){if(this.validLenmin&&this.validLenmin>b.length)return RContext.get("MDescEdit:ValidMinLength",this.validLenmin);if(this.validLenmax&&this.validLenmax<b.length)return RContext.get("MDescEdit:ValidMaxLength",this.validLenmax)}return f}
function FUiDataEdit_findEditor(){if(this.editComplete){var b=this.editor;!b&&(this.dsControl=this.topControl(MDataset))&&(b=this.editor=RConsole.find(FUiDataEditConsole).focus(this,FUiDataEditEditor));b&&b.linkControl(this);return this.editor}}function FUiDataEdit_drop(){var b=this.findEditor();if(b){var f=this.reget();0<f.length&&(this.finded!=f&&(b.source!=this&&b.linkControl(this),b.search(f)),this.finded=f)}}
function FUiDataEdit_clone(){var b=this._class.newInstance();GHtml_clone(b,this.hPanel);return b}function FUiDataEdit_link(){}
function FUiDataEditControl(b){b=RClass.inherits(this,b,FUiEditControl,MDataField,MEditValue,MEditChange,MEditDrop);b._labelModeCd=RClass.register(b,new APtyString("_labelModeCd"),ELabelMode.All);b._labelPositionCd=RClass.register(b,new APtyString("_labelPositionCd"),ELabelPosition.Left);b._labelSize=RClass.register(b,new APtySize2("_labelSize"));b._labelAlignCd=RClass.register(b,new APtyString("_labelAlignCd"),EAlign.Left);b._editSize=RClass.register(b,new APtySize2("_editSize"));b._dataTypeCd=RClass.register(b,
new APtyString("_dataTypeCd"));b._styleLabelPanel=RClass.register(b,new AStyle("_styleLabelPanel"));b._styleEditPanel=RClass.register(b,new AStyle("_styleEditPanel"));b._hLabelPanel=null;b._hLabelForm=null;b._hIconPanel=null;b._hIcon=null;b._hTextPanel=null;b._hText=null;b._hEditPanel=null;b._hEditForm=null;b._hValuePanel=null;b.onBuildLabelIcon=FUiDataEditControl_onBuildLabelIcon;b.onBuildLabelText=FUiDataEditControl_onBuildLabelText;b.onBuildLabel=FUiDataEditControl_onBuildLabel;b.onBuildEditValue=
RMethod.virtual(b,"onBuildEditValue");b.onBuildEdit=FUiDataEditControl_onBuildEdit;b.onBuildPanel=FUiDataEditControl_onBuildPanel;b.onBuild=FUiDataEditControl_onBuild;b.oeDataLoad=FUiDataEditControl_oeDataLoad;b.oeDataSave=FUiDataEditControl_oeDataSave;b.oeDesign=FUiDataEditControl_oeDesign;b.oeMode=FUiDataEditControl_oeMode;b.construct=FUiDataEditControl_construct;b.panel=FUiDataEditControl_panel;b.label=FUiDataEditControl_label;b.setLabel=FUiDataEditControl_setLabel;b.getEditRange=FUiDataEditControl_getEditRange;
b.dispose=FUiDataEditControl_dispose;return b}function FUiDataEditControl_onBuildLabelIcon(b){this._labelIcon&&(this._hIcon=RBuilder.appendIcon(this._hIconPanel,this._labelIcon))}function FUiDataEditControl_onBuildLabelText(b){this._hText=RBuilder.appendSpan(this._hTextPanel,null,this._label)}
function FUiDataEditControl_onBuildLabel(b){var f=this._hLabelForm=RBuilder.appendTable(this._hLabelPanel,this.styleName("LabelPanel")),h=RBuilder.appendTableRow(f);this._hIconPanel=RBuilder.appendTableCell(h);this.onBuildLabelIcon(b);h=this._hTextPanel=RBuilder.appendTableCell(h);h.noWrap=!0;this.onBuildLabelText(b);RHtml.setSize(f,this._labelSize);this._labelAlignCd&&(h.align=this._labelAlignCd,h.style.paddingRight=4);this._labelColor&&(this._hLabel.style.color=this._labelColor)}
function FUiDataEditControl_onBuildEdit(b){var f=this._hEditForm=RBuilder.appendTable(this._hEditPanel,this.styleName("EditPanel")),h=this._hEditLine=RBuilder.appendTableRow(f);this._hValuePanel=RBuilder.appendTableCell(h);this.onBuildEditValue(b);RHtml.setSize(f,this._editSize)}function FUiDataEditControl_onBuildPanel(b){this._hPanel=RBuilder.createTable(b,this.styleName("Panel"))}
function FUiDataEditControl_onBuild(b){this.__base.FUiEditControl.onBuild.call(this,b);var f=this._hPanel,h=null,q=null,u=this._labelModeCd;u==ELabelMode.Label?h=RBuilder.appendTableCell(RBuilder.appendTableRow(f)):u==ELabelMode.Hidden?q=RBuilder.appendTableCell(RBuilder.appendTableRow(f)):(h=this._labelPositionCd,h==ELabelPosition.Top?(h=RBuilder.appendTableRowCell(f),q=RBuilder.appendTableRowCell(f)):h==ELabelPosition.Right?(f=RBuilder.appendTableRow(f),q=RBuilder.appendTableCell(f),h=RBuilder.appendTableCell(f)):
h==ELabelPosition.Bottom?(q=RBuilder.appendTableRowCell(f),h=RBuilder.appendTableRowCell(f)):(f=RBuilder.appendTableRow(f),h=RBuilder.appendTableCell(f),q=RBuilder.appendTableCell(f)));this._hLabelPanel=h;this._hEditPanel=q;h&&(this.onBuildLabel(b),h.appendChild(this._hLabelForm),this.setLabel(this._label));if(q)this.onBuildEdit(b)}function FUiDataEditControl_getEditRange(){var b=this.hEditCell,f=RHtml.offsetPosition(b);return new TRange(f.x,f.y,b.offsetWidth,b.offsetHeight)}
function FUiDataEditControl_onScalar(b){this.set(b.result)}function FUiDataEditControl_scalar(b){b=new TDatasetScalarArg(this,null,b);b.callback=new TInvoke(this,this.onScalar);RConsole.find(FDatasetConsole).scalar(b)}function FUiDataEditControl_onDataDoubleClick(){if(RClass.isClass(this,MDropable))this.onDropDoubleClick();if(RClass.isClass(this,MListView))this.onListClick()}
function FUiDataEditControl_onDataKeyDown(b,f){this.__base.MEditDescriptor.onDataKeyDown.call(this,b,f);var h=this.hChangeIcon;h&&(h.style.display=this.isDataChanged()?"block":"none");if(RClass.isClass(this,MDropable)&&EKey.Down==f.keyCode)this.drop();else if(f.ctrlKey&&EKey.Enter==f.keyCode&&this.editSearch&&(h=this.dsControl)&&!this.isValid){var q=new TNode("Search"),u=q.create("Item");u.set("name",this.name);u.set("data_name",this.dataName);u.set("data_value",this.dataValue);u.set("search_type",
ESearch.Equals);u.set("search_order",EOrder.None);RConsole.find(FDatasetConsole).fetch(h,q)}}function FUiDataEditControl_onDesignBegin(){this.__base.MDesign.onDesignBegin.call(this);this._disbaled=!0;this.hEdit.disbaled=!0}function FUiDataEditControl_onDesignEnd(){this.__base.MDesign.onDesignEnd.call(this);this._disbaled=!1;this.hEdit.disbaled=!1}function FUiDataEditControl_oeDataLoad(b){b=b.source.currentRow().get(this._dataName);this.set(b);return EEventStatus.Stop}
function FUiDataEditControl_oeDataSave(b){b=b.source.currentRow();var f=this.get();b.set(this._dataName,f);return EEventStatus.Stop}
function FUiDataEditControl_oeDesign(b){this.__base.MDesign.oeDesign.call(this,e);b=this.hLabelForm;var f=this.hEditForm;switch(e.mode){case EDesign.Move:e.flag?(this.hForm.border=1,b&&(b.cellPadding=1),this.hEdit&&(this.hEdit.disabled=!0)):(this.hForm.border=0,b&&(b.border=0,b.cellPadding=0),this.hEdit&&(this.hEdit.disabled=!1));break;case EDesign.Border:e.flag?(this.hForm.border=1,f&&(f.border=1)):(this.hForm.border=0,f&&(f.border=0))}return EEventStatus.Stop}
function FUiDataEditControl_oeMode(b){this.__base.FUiEditControl.oeMode.call(this,b);this.__base.MDisplay.oeMode.call(this,b);this._editable=this.canEdit(b.mode);this._validable=this.canValid(b.mode);this._progress||this.setEditable(this._editable);return EEventStatus.Stop}
function FUiDataEditControl_oeProgress(b){if(this._progress&&b.enable)return EEventStatus.Stop;(this._progress=b.enable)?(b=this._editable,this.setEditable(!1),this._editable=b):this.setEditable(this._editable);return EEventStatus.Stop}function FUiDataEditControl_oeLoadValue(b){b=this.__base.MEditValue.oeLoadValue.call(this,b);var f=this.hChangeIcon;f&&(f.style.display="none");return b}
function FUiDataEditControl_doFocus(b){this.__base.MUiFocus.doFocus.call(this,b);this.__base.MEditValue.doFocus.call(this,b)}function FUiDataEditControl_doBlur(b){this.__base.MUiFocus.doBlur.call(this,b);this.__base.MEditValue.doBlur.call(this,b)}function FUiDataEditControl_construct(){this.__base.FUiEditControl.construct.call(this);this.__base.MEditChange.construct.call(this);this.__base.MEditDrop.construct.call(this);this._labelSize=new SSize2(100,20);this._editSize=new SSize2(200,20)}
function FUiDataEditControl_panel(b){return EPanel.Edit==b||EPanel.Focus==b?this.hEdit:this.__base.FUiEditControl.panel.call(this,b)}function FUiDataEditControl_label(b){return this._label}function FUiDataEditControl_setLabel(b){this._label=b;this._hText&&(this._hText.innerHTML=RString.nvl(b))}function FUiDataEditControl_testFocus(){return this._visible&&this._editable&&!this._disbaled}function FUiDataEditControl_text(){return this.hEdit?this.hEdit.value:""}
function FUiDataEditControl_setText(b){this.hEdit.value=b}function FUiDataEditControl_setEditable(b){this.__base.MEditValue.setEditable.call(this,b);this.hEdit&&(this.hEdit.readOnly=!b);var f=this.hLabel;f&&(this.validRequire&&(this.hLabel.style.color=b?EColor.Require:EColor.Text),RClass.isClass(this,MListView)&&this.canListView()&&(f.style.cursor=b?"hand":"normal",f.className=b?"RLine_Underline":""))}
function FUiDataEditControl_setVisible(b){this.__base.FUiEditControl.setVisible.call(this,b);this.refreshStyle()}function FUiDataEditControl_focus(){this.__base.MUiFocus.focus.call(this);if(this.hEdit)try{this.hEdit.focus()}catch(b){}}
function FUiDataEditControl_refreshStyle(){if(this._visible){var b=EColor.TextReadonly,f=EColor.Readonly,h="normal";this._editable&&(b=EColor.TextEdit,f=EColor.Edit,h="hand",RString.isEmpty(this.editTip)||this.hEdit.innerText!=this.editTip||(b="#CCCCCC"));this._invalidText&&!RString.isEmpty(this.text())&&(b=EColor.TextInvalid,f=EColor.Invalid);this._textColor=b;this._backColor=f;var q=this.hEdit,u=this.hDrop;q&&(q.style.color=b,q.style.backgroundColor=f);u&&(q&&(q.style.cursor=h),u.style.cursor=h);
this.editBorder&&(b=EUiBorderStyle.Readonly,this._editable&&(b=EUiBorderStyle.Edit),this._hover&&(b=EUiBorderStyle.Hover),this.setEditBorderStyle(b,f))}}
function FUiDataEditControl_dispose(){this._dataTypeCd=this._labelAlignCd=this._labelPositionCd=this._labelModeCd=null;var b=this._labelSize;b&&(b.dispose(),this._labelSize=null);if(b=this._editSize)b.dispose(),this._editSize=null;RHtml.free(this._hLabelPanel);this._hLabelPanel=null;RHtml.free(this._hLabelForm);this._hLabelForm=null;RHtml.free(this._hIconPanel);this._hIconPanel=null;RHtml.free(this._hIcon);this._hIcon=null;RHtml.free(this._hTextPanel);this._hTextPanel=null;RHtml.free(this._hText);
this._hText=null;RHtml.free(this._hEditPanel);this._hEditPanel=null;RHtml.free(this._hEditForm);this._hEditForm=null;RHtml.free(this._hValuePanel);this._hValuePanel=null;RHtml.free(this._hDropPanel);this._hDropPanel=null;this.__base.MEditDrop.dispose.call(this);this.__base.MEditChange.dispose.call(this);this.__base.FUiEditControl.dispose.call(this)}function FUiDataNumber(b){return b=RClass.inherits(this,b,FEditControl)}
function FUiDataNumber_onEditFocus(b){this.setText(this.formatValue(this.text()))}function FUiDataNumber_onEditBlur(b){this.setText(this.formatText(this.text()))}
function FUiDataNumber_onBuildEdit(b){var f=RBuilder.appendTable(b.hPanel);f.style.tableLayout="fixed";f=this.hEdit=f.insertRow();this.onBuildChange(f.insertCell());if(this.canZoom()){var h=f.insertCell();this.hZoom=RBuilder.appendIcon(h,"ctl.zooms");h.width=16}h=f.insertCell();h.style.width="100%";f=this.hEdit=RBuilder.appendEdit(h,this.style("Edit"));this.attachEvent("onEditFocus",f,this.onEditFocus);this.attachEvent("onEditKeyPress",f,this.onEditKeyPress);this.attachEvent("onEditBlur",f,this.onEditBlur);
this.attachEvent("onDataKeyUp",f,this.ohEditKeyUp);this.editLength&&(f.maxLength=this.editLength);this.buildAdjustForm(b.hDrop)}function FUiDataNumber_setUnitIcon(b){this.hUnit.innerHTML="<IMG src="+b+">"}function FUiDataNumber_onDataKeyDown(b,f){this.canEdit&&(EKey.Up==f.keyCode?this.adjustValue(!0):EKey.Down==f.keyCode&&this.adjustValue(!1));this.base.FEditControl.onDataKeyDown.call(this,b,f)}
function FUiDataNumber_ohEditKeyUp(b,f){EKey.Up==f.keyCode&&this.canEdit?this.hUpIcon.src=this.styleIconPath("UpSelect"):EKey.Down==f.keyCode&&this.canEdit&&(this.hDownIcon.src=this.styleIconPath("DownSelect"))}function FUiDataNumber_onEditKeyDown(b){this.canEdit&&(EKey.Up==b.keyCode?(b.source.hUpIcon.src=this.styleIconPath("up"),this.changeValue(b,"Y")):EKey.Down==b.keyCode&&(b.source.hDownIcon.src=this.styleIconPath("down"),this.changeValue(b,"N")))}
function FUiDataNumber_onEditKeyUp(b){this.canEdit&&(EKey.Up==b.keyCode?b.source.hUpIcon.src=this.styleIconPath("upSelect"):EKey.Down==b.keyCode&&(b.source.hDownIcon.src=this.styleIconPath("downSelect")))}function FUiDataNumber_onEditDoubleClick(){this.onListClick()}
function FUiDataNumber_validPattern(b){var f=!0;b=RString.nvl(b);if(!RRegExp.test(ERegExp.NUMBER,b))return!1;var h=null;if(this.dataType){for(n in ERegExp)if(RString.equals(n,this.dataType)){h=ERegExp[n];break}RString.equals(RClass.name(h),"RegExp")&&(f=RRegExp.test(h,b)?f&1:f&0)}this.editMaxvalue&&(f=parseFloat(b)<=parseFloat(this.editMaxvalue)?f&1:f&0);this.editMinvalue&&(f=parseFloat(b)>=parseFloat(this.editMinvalue)?f&1:f&0);return f}
function FUiDataNumber_refreshStyle(){this.base.FEditControl.refreshStyle.call(this);this.hUpIcon.src=this.styleIconPath(this._hover?"UpSelect":"Up");this.hDownIcon.src=this.styleIconPath(this._hover?"DownSelect":"Down")}
function FUiDataNumber_splitValue(b){b=RString.nvl(b.toString());var f=RString.findChars(b,"-"),h=RString.findChars(b,"%");b=RString.removeChars(b,"'");b=RString.removeChars(b," ");b=RString.removeChars(b,"%");b=RString.removeChars(b,"-");if(!RString.isEmpty(b)){for(var q="",u=0,z=b.length;-1<z;z--)q=0!=z&&0!=u&&0==u%3?"'"+b.charAt(z)+q:b.charAt(z)+q,u++;-1!=f&&(q="-"+q);-1!=h&&(q+="%");return q}return b}
function FUiDataNumber_removeSplit(b){b=RString.nvl(b);b=RString.removeChars(b,"'");return b=RString.removeChars(b,"%")}
function FUiDataNumber_precisionValue(b){if(RString.isEmpty(b))return b;var f,h,q=RString.nvl(this.editPrecision);b=RString.nvl(b);RString.contains(q,".")?h=q.split(".")[1].length:f=q.length;if(RString.contains(b,"."))b=b.split("."),h&&(h>b[1].length?b[1]=RString.rpad(b[1],h-b[1].length,"0"):h<=b[1].length&&(b[1]=b[1].substring(0,h))),f&&(f>b[0].length?alert(f):f<b[0].length&&(b[0]=b[0].substring(0,b[0].length-f),b[0]=RString.rpad(b[0],f,"0")),b[1]=null),b=b[1]?b[0]+"."+RString.nvl(b[1]):b[0];else{if(f)if(f<=
b.length)for(b=b.substring(0,b.length-f+1),q=0;q<f-1;q++)b=b.concat("0");else f>b.length&&(b=0);if(h)for(b+=".",q=0;q<h;q++)b=b.concat("0")}return b}function FUiDataNumber_dispose(){this.base.FEditControl.dispose.call(this);this.hChgIic=this.hDownIcon=this.hUpIcon=this.hLabel=null}
function FUiDataColumn(b){b=RClass.inherits(this,b,FControl,MDataField);b._displayList=!0;b._styleLabel=RClass.register(b,new AStyle("_styleLabel"));b._styleSearchPanel=RClass.register(b,new AStyle("_styleSearchPanel"));b._styleSearchEdit=RClass.register(b,new AStyle("_styleSearchEdit"));b._styleIconSortUp=RClass.register(b,new AStyleIcon("_styleIconSortUp"));b._styleIconSortDown=RClass.register(b,new AStyleIcon("_styleIconSortDown"));b._cellClass=FCell;b._hForm=null;b._hFormLine=null;b._hIconPanel=
null;b._hIcon=null;b._hLabel=null;b._hSortPanel=null;b._hSortUp=null;b._hSortDown=null;b._hSearchEditPanel=null;b._hSearchEdit=null;b.onBuildLabel=FUiDataColumn_onBuildLabel;b.onBuildSearchIcon=RMethod.empty;b.onBuildSearchEdit=FUiDataColumn_onBuildSearchEdit;b.onBuildSearchDrop=RMethod.empty;b.onBuildSearchForm=FUiDataColumn_onBuildSearchForm;b.onBuildSearch=FUiDataColumn_onBuildSearch;b.onBuildTotal=FUiDataColumn_onBuildTotal;b.onBuildPanel=FUiDataColumn_onBuildPanel;b.onBuild=FUiDataColumn_onBuild;
b.onSearchEnter=RClass.register(b,new AEventMouseEnter("onSearchEnter"));b.onSearchClick=RClass.register(b,new AEventClick("onSearchClick"));b.onSearchLeave=RClass.register(b,new AEventMouseLeave("onSearchLeave"));b.onSearchKeyDown=RClass.register(b,new AEventKeyDown("onSearchKeyDown"));b.createCell=FUiDataColumn_createCell;return b}
function FUiDataColumn_onBuildLabel(b){b=this._hFormLine;if(this._icon){var f=this._hIconPanel=RBuilder.appendTableCell(b);this._hIcon=RBuilder.appendIcon(f,this.icon)}(this._hLabel=RBuilder.appendTableCell(b)).innerHTML=RString.nvl(this.label());b=this._hSortPanel=RBuilder.appendTableCell(b);f=this._hSortUp=RBuilder.appendIcon(b,this.styleIcon("SortUp",FUiDataColumn));f.style.display="none";f=this._hSortDown=RBuilder.appendIcon(b,this.styleIcon("SortDown",FUiDataColumn));f.style.display="none"}
function FUiDataColumn_onBuildSearchEdit(b){b=this._hSearchEditPanel=RBuilder.appendTableCell(this._hSearchFormLine,this.styleName("SearchPanel"));this._hSearchEdit=RBuilder.appendEdit(b,this.styleName("SearchEdit"))}
function FUiDataColumn_onBuildSearchForm(b){b=this._hSearchForm=RBuilder.appendTable(this._hSearchPanel);b.width="100%";b.style.backgroundColor="#FFFFFF";this._hSearchFormLine=b.insertRow();RClass.isClass(this,FUiDataColumnButton)?(this._hSearchPanel.style.backgroundColor="#EEEFF1",this._hSearchPanel.style.borderLeft="1 solid #808080",this._hSearchPanel.style.borderTop="1 solid #808080",this._hSearchPanel.style.borderBottom="1 solid #9EC4EB"):(this.onBuildSearchIcon(),this.onBuildSearchEdit(),this.onBuildSearchDrop())}
function FUiDataColumn_onBuildSearch(b){var f=this._hSearchPanel=RBuilder.create(b,"TD",this.styleName("SearchPanel"));f.style.backgroundColor="#FFFFFF";f.style.borderBottom="1 solid #9EC4EB";RHtml.linkSet(f,"control",this);this.attachEvent("onSearchEnter",f);this.attachEvent("onSearchLeave",f);this.onBuildSearchForm(b)}
function FUiDataColumn_onBuildTotal(b){b=this._hTotalPanel=RBuilder.create(b,"TD");RHtml.linkSet(b,"control",this);b.align="right";b.style.color="#686860";b.style.backgroundColor="#F8F8F0";b.style.borderBottom="1 solid #B8B8B0";b.innerText=" "}function FUiDataColumn_onBuildPanel(b){this._hPanel=RBuilder.create(b,"TD",this.styleName("Label"))}
function FUiDataColumn_onBuild(b){this._absEdit=this._editInsert||this._editUpdate||this._editDelete;this._absEdit||(RString.isEmpty(this._lovReference)?this._hasDropArea=!1:this._hasDropArea=!0);if(!RString.isEmpty(this._viewIcons)){var f=this.iconMap=new TAttributes;f.split(this._viewIcons.replace(/\n/g,";"),"=",";");this.hasIconArea=0<f.count}this.__base.FControl.onBuild.call(this,b);f=this._hPanel;f.style.padding=4;f=this._hForm=RBuilder.appendTable(f);this._orderAble||(f.style.cursor="hand");
this._hFormLine=RBuilder.appendTableRow(this._hForm);this.onBuildLabel(b);this.onBuildSearch(b);this.onBuildTotal(b);b=this._hFixPanel=RBuilder.create(b,"TD");b.height=1;b.bgColor="#FFFFFF";40>this._size.width&&(this._size.width=40);RHtml.setSize(b,this._size);this._hPanel.style.pixelWidth=this.width;this._hFixPanel.style.pixelWidth=this.width}
function FUiDataColumn_createCell(b){b=RClass.create(this._cellClass);var f=b._table=this._table;b._name=this._name;b._column=this;b.build(f._hPanel);b.setVisible(this._displayList);return b}function FUiDataColumn_onCellMouseEnter(b,f){this.table.hoverRow(b.row,!0)}function FUiDataColumn_onCellMouseLeave(b,f){this.table.hoverRow(b.row,!1)}
function FUiDataColumn_onCellMouseDown(b,f){var h=b.table,q=b.row;h.__focusCell=b;h.selectRow(q,!f.ctrlKey,!0);h=RConsole.find(FFocusConsole).focusControl;RClass.isClass(h,FDropEditor)&&h.source==b||RConsole.find(FFocusConsole).focus(b)}function FUiDataColumn_onCellClick(b,f){this.table.clickRow(b.row)}function FUiDataColumn_onCellDoubleClick(b,f){var h=b.row;this.isEditAble(h)||this.table.doubleClickRow(h)}function FUiDataColumn_onCellKeyDown(b,f,h){if(h)this.table.onCellKeyDown(b,f,h)}
function FUiDataColumn_oeMode(b){if(b.isAfter()){var f=!1;this.inModeDisplay=f=EAction.Design==b.mode?this.dispDesign:this._displayList;this.setVisible(f)}return EEventStatus.Continue}function FUiDataColumn_oeRefresh(b){b.isBefore()&&this.setVisible(this._displayList)}function FUiDataColumn_onDataKeyDown(b,f){this.__base.MEditDescriptor.onDataKeyDown.call(this,b,f)}function FUiDataColumn_onDataChanged(b,f){this.table.setDataStatus(b.row,EDataStatus.Update)}
function FUiDataColumn_onEditBegin(b){var f=b.row;this.editor=b;this.table.editRow=f;this.table.editColumn=this;this.table.select(f,!0);RLogger.debug(this,"Edit begin (column={1} row={2} editor={3})",this.name,RClass.dump(f),RClass.dump(b))}
function FUiDataColumn_onEditEnd(b){b=editor.row;var f=editor.text();this.setValue(b,this.formatValue(f));this.setText(b,f);this.table.setDataStatus(b,b.isChanged()?EDataStatus.Update:EDataStatus.Unknown);this.editor=null;RLogger.debug(this,"{1}={2}\n{3}\n{4}",RClass.dump(editor),this.formatValue(f),this.dump(),b.dump())}function FUiDataColumn_onEditChanged(b){b.row.refresh()}
function FUiDataColumn_onHeadMouseDown(b){var f=this.table,h=f.dsViewer.count,q=b.x;if(!RClass.isClass(this,FUiDataColumnButton)){var u=this._hPanel.offsetWidth-6;if(0<q&&q<u&&0<h&&!RClass.isClass(b.source,FUiDataColumnStatus)){h=f.columns;q=h.count;for(b=0;b<q;b++)u=h.value(b),u._hSortUp.style.display="none",u._hSortDown.style.display="none";f.dsOrders.clear();h=new TOrderItem;b=this.dataName;this.sortType?(h.set(b,EOrder.Desc),this._hSortUp.style.display="none",this._hSortDown.style.display="block"):
(this._hSortUp.style.display="block",this._hSortDown.style.display="none",h.set(b,EOrder.Asc));this.sortType=!this.sortType;f.dsOrders.push(h);f.dsSearch()}}}function FUiDataColumn_onRowClick(b,f){RConsole.find(FListenerConsole).process(FGridControl,EGridAction.RowClick,b.row,b.row)}
function FUiDataColumn_createMoveable(b){b=this.cloneMove;b||(b=RClass.create(this.constructor),b.buildMode=EColumnMode.Drag,b.assign(this,EAssign.Property),b.build(),this.cloneMove=b);var f=this.panel(EPanel.Move),h=b.panel(EPanel.Move);RHtml.setPixelRect(h,RHtml.rect(f));h.className=b.styleName("DesignMove");h.style.pixelLeft=f.offsetLeft;b.show();return b}function FUiDataColumn_searchValue(){if(this._hSearchEdit)return this._hSearchEdit.value}
function FUiDataColumn_setStyleStatus(b,f){var h=this.cell(b);if(h)switch(h=h.style,f){case EStyle.Normal:b.isDelete()?h.backgroundColor=EColor.Delete:this.isEditAble(b)?h.backgroundColor=EColor.Edit:h.backgroundColor=EColor.Readonly;break;case EStyle.Select:b.isDelete()?h.backgroundColor=EColor.Select:(h.textDecoration="none",this.isEditAble(b)?h.backgroundColor=EColor.RowEditSelect:h.backgroundColor=EColor.Select);break;case EStyle.Delete:h.textDecoration="line-through",h.backgroundColor=EColor.Select}}
function FUiDataColumn_cell(b){return b.cell(this.index)}function FUiDataColumn_equalsValue(b,f){return RString.nvl(b).replace(/\n/g,"\\n").replace(/\r/g,"\\r")==RString.nvl(f).replace(/\n/g,"\\n").replace(/\r/g,"\\r")}function FUiDataColumn_setWidth(b){this._hPanel.style.pixelWidth=b;this._hFixPanel.style.pixelWidth=b}
function FUiDataColumn_setVisible(b){b=(this.isDisplay=b)?"block":"none";this._hPanel.style.display=b;this._hSearchPanel.style.display=b;this._hTotalPanel.style.display=b;this._hFixPanel.style.display=b}
function FUiDataColumn_moveCellFocus(b,f){var h=this.table,q=null,u=null,z=null;if(EPosition.Top==f)q=this,(u=h.rows.get(h.rows.indexOf(b)-1))&&(z=u.cell(q.index));else if(EPosition.Bottom==f)q=this,(u=h.rows.get(h.rows.indexOf(b)+1))&&(z=u.cell(q.index));else if(EPosition.Before==f)for(var A=this.index-1,B=h.rows.indexOf(b);0<=B;B--){for(var C=h.rows.get(B);0<=A;A--){var D=h.columns.value(A);if(RClass.isClass(D,FUiDataColumn)&&D._displayList){q=D;u=C;z=u.cell(q.index);break}}if(q)break;A=h.columns.count-
1}else if(EPosition.After==f)for(var A=this.index+1,B=h.rows.indexOf(b),E=h.columns.count,F=h.rows.count;B<F;B++){for(C=h.rows.get(B);A<E;A++)if(D=h.columns.value(A),RClass.isClass(D,FUiDataColumn)&&D._displayList){q=D;u=C;z=u.cell(q.index);break}if(q)break;A=0}q&&u&&z&&(z.focus(!0),RConsole.find(FFocusConsole).focus(z))}function FUiDataColumn_getEditRange(){var b=this._hSearchPanel,f=RHtml.offsetPosition(b);return new TRange(f.x,f.y,b.offsetWidth,b.offsetHeight)}
function FUiDataColumn_dispose(){this.__base.FControl.dispose.call(this);RMemory.freeHtml(this._hSearchPanel);RMemory.freeHtml(this._hFixPanel);this._hFixPanel=this._hSearchDrop=this._hSearchDropPanel=this._hSearchEdit=this._hSearchEditPanel=this._hSearchIcon=this._hSearchIconPanel=this._hSearchFormLine=this._hSearchForm=this._hSearchPanel=this._hSortDown=this._hSortUp=this._hSortPanel=this._hLabel=this._hHeadPanel=this._hIcon=this._hIconPanel=this._hFormLine=this._hForm=null}
function FUiDataColumn_dump(b){b=RString.nvlStr(b);b.append(RClass.dump(this),"[");b.append("name=",this.name);b.appendIf(this.icon,",icon=",this.icon);b.appendIf(this.label,",label=",this.label);b.appendIf(this.align,",align=",this.align);b.appendIf(this.valign,",valign=",this.valign);b.appendIf(this.dataName,",dataName=",this.dataName);b.appendIf(this.dataDefault,",dataDefault=",this.dataDefault);b.appendIf(this.index,",index=",this.index);b.append("]");b.append(" [editAccess=");b.append(this.editInsert?
"I":"_");b.append(this.editUpdate?"U":"_");b.append("]");return b}
var EDsCanvasDrag=new function(){this.Unknown=0;this.X=1;this.Y=2;this.Z=3;this.All=4;return this},EDsCanvasMode=new function(){this.Unknown=0;this.Drop=1;this.Select=2;this.Translate=3;this.Rotation=4;this.Scale=5;return this},EDsFrame=new function(){this.ScenePropertyFrame="design3d.scene.property.SceneFrame";this.SceneTechniquePropertyFrame="design3d.scene.property.TechniqueFrame";this.SceneRegionPropertyFrame="design3d.scene.property.RegionFrame";this.SceneCameraPropertyFrame="design3d.scene.property.CameraFrame";
this.SceneLightPropertyFrame="design3d.scene.property.LightFrame";this.SceneLayerPropertyFrame="design3d.scene.property.LayerFrame";this.SceneDisplayPropertyFrame="design3d.scene.property.DisplayFrame";this.SceneMaterialPropertyFrame="design3d.scene.property.MaterialFrame";this.SceneRenderablePropertyFrame="design3d.scene.property.RenderableFrame";return this};
function MDsBoundBox(b){b=RClass.inherits(this,b);b._boundVisible=!1;b._boundBox=null;b.boundBox=MDsBoundBox_boundBox;b.showBoundBox=MDsBoundBox_showBoundBox;b.hideBoundBox=MDsBoundBox_hideBoundBox;return b}function MDsBoundBox_boundBox(){var b=this._boundBox;b||(b=this._boundBox=RClass.create(FE3dBoundBox),b.linkGraphicContext(this),b.setup());return b}
function MDsBoundBox_showBoundBox(){var b=this.boundBox();b.remove();var f=this.resource().mesh().outline();b.outline().assign(f);b.upload();this.pushDrawable(b);this._boundVisible=!0}function MDsBoundBox_hideBoundBox(){this.removeDrawable(this._boundBox);this._boundVisible=!1}
function FDsApplication(b){b=RClass.inherits(this,b,FObject);b._name=null;b._matrix=null;b._location=null;b._rotation=null;b._scale=null;b._visible=!0;b._renderables=null;b.construct=FDsApplication_construct;b.isName=FDsApplication_isName;b.name=FDsApplication_name;b.matrix=FDsApplication_matrix;b.location=FDsApplication_location;b.rotation=FDsApplication_rotation;b.scale=FDsApplication_scale;b.hasRenderable=FDsApplication_hasRenderable;b.filterRenderables=FDsApplication_filterRenderables;b.renderables=
FDsApplication_renderables;b.pushRenderable=FDsApplication_pushRenderable;b.process=FDsApplication_process;b.update=FDsApplication_update;b.dispose=FDsApplication_dispose;return b}function FDsApplication_construct(){this.__base.FObject.construct.call(this);this._matrix=new SMatrix3d;this._location=new SPoint3;this._rotation=new SVector3;this._scale=new SVector3;this._scale.set(1,1,1)}function FDsApplication_isName(b){return this._name==b}function FDsApplication_name(){return this._name}
function FDsApplication_matrix(){return this._matrix}function FDsApplication_location(){return this._location}function FDsApplication_rotation(){return this._rotation}function FDsApplication_scale(){return this._scale}function FDsApplication_hasRenderable(){var b=this._renderables;return null!=b?!b.isEmpty():!1}
function FDsApplication_filterRenderables(b){if(!this._visible)return!1;var f=this._renderables;if(null!=f)for(var h=f.count(),q=0;q<h;q++){var u=f.get(q);u.testVisible()&&b.pushRenderable(u)}return!0}function FDsApplication_renderables(){var b=this._renderables;null==b&&(b=this._renderables=new TObjects);return b}function FDsApplication_pushRenderable(b){this.renderables().push(b)}function FDsApplication_update(){var b=this._matrix;b.set(this._location,this._rotation,this._scale);b.update()}
function FDsApplication_process(){var b=this._renderables;if(null!=b)for(var f=b.count(),h=0;h<f;h++)b.get(h).process()}function FDsApplication_dispose(){this._scale=this._direction=this._position=this._matrix=null;var b=this._renderables;null!=b&&(b.dispose(),this._renderables=null);this.__base.FObject.dispose.call(this)}
function FDsCanvas(b){b=RClass.inherits(this,b,FUiCanvas,MGraphicObject,MListenerLoad,MMouseCapture);b._stage=null;b._rotation=null;b._rotationAble=!1;b._capturePosition=null;b._captureMatrix=null;b._captureRotation=null;b._dimensional=null;b.onBuild=FDsCanvas_onBuild;b.onMouseCaptureStart=FDsCanvas_onMouseCaptureStart;b.onMouseCapture=FDsCanvas_onMouseCapture;b.onMouseCaptureStop=FDsCanvas_onMouseCaptureStop;b.onEnterFrame=FDsCanvas_onEnterFrame;b.oeRefresh=FDsCanvas_oeRefresh;b.construct=FDsCanvas_construct;
b.dispose=FDsCanvas_dispose;return b}function FDsCanvas_onBuild(b){this.__base.FUiCanvas.onBuild.call(this,b);b=this._hPanel;b.__linker=this;b=this._graphicContext=REngine3d.createContext(FWglContext,b,{alpha:!1,antialias:!0});var f=this._dimensional=RClass.create(FE3dDimensional);f.linkGraphicContext(b);f.setup();RStage.lsnsEnterFrame.register(this,this.onEnterFrame);RStage.start(1E3/60);RConsole.find(FMouseConsole).register(this)}function FDsCanvas_onMouseCaptureStart(b){}
function FDsCanvas_onMouseCapture(b){if(this._activeScene){var f=b.clientX-this._capturePosition.x;b=b.clientY-this._capturePosition.y;switch(this._toolbar._canvasModeCd){case EDsCanvasMode.Drop:var h=this._activeScene.camera().rotation(),q=this._captureRotation;h.x=q.x+.003*b;h.y=q.y+.003*f}}}function FDsCanvas_onMouseCaptureStop(b){}function FDsCanvas_onEnterFrame(){}
function FDsCanvas_oeRefresh(b){var f=this._graphicContext;this.__base.FUiCanvas.oeRefresh.call(this,b);b=this._hParent.offsetWidth;var h=this._hParent.offsetHeight,q=this._hPanel;q.width=b;q.height=h;f.setViewport(0,0,b,h);return EEventStatus.Stop}function FDsCanvas_construct(){this.__base.FUiCanvas.construct.call(this);this._capturePosition=new SPoint2;this._captureMatrix=new SMatrix3d;this._rotation=new SVector3;this._captureRotation=new SVector3}
function FDsCanvas_dispose(){var b=this._rotation;b&&(b.dispose(),this._rotation=null);this.__base.FUiCanvas.dispose.call(this)}
function FDsMainCanvas(b){b=RClass.inherits(this,b,FCanvas);b._context=null;b._stage=null;b._layer=null;b._activeModel=null;b._rotationX=0;b._rotationY=0;b._rotationZ=0;b.onBuild=FDsMainCanvas_onBuild;b.onEnterFrame=FDsMainCanvas_onEnterFrame;b.onThemeLoad=FDsMainCanvas_onThemeLoad;b.oeRefresh=FDsMainCanvas_oeRefresh;b.construct=FDsMainCanvas_construct;b.selectModel=FDsMainCanvas_selectModel;b.dispose=FDsMainCanvas_dispose;return b}
function FDsMainCanvas_onEnterFrame(){var b=this._activeModel;b&&(b.location().set(0,-6,0),b.rotation().set(0,this._rotationY,0),b.scale().set(2,2,2),b.update(),this._rotationX+=.01,this._rotationY+=.01,this._rotationZ+=.03)}
function FDsMainCanvas_onThemeLoad(){var b=this._hPanel;b.width=this._hParent.offsetWidth;b.height=this._hParent.offsetHeight;this._context=REngine3d.createContext(FWglContext,b);var f=this._stage=RClass.create(FSimpleStage3d);f.backgroundColor().set(.5,.5,.5,1);f.selectTechnique(this._context,FG3dGeneralTechnique);this._layer=this._stage.spriteLayer();RStage.register("stage3d",this._stage);f=this._stage.camera();f.setPosition(0,3,-20);f.lookAt(0,0,0);f.update();this._stage.directionalLight().direction().set(.7,
-.7,0);f=this._stage.camera().projection();f.size().set(b.width,b.height);f.update();RStage.lsnsEnterFrame.register(this,this.onEnterFrame);RStage.start()}function FDsMainCanvas_onBuild(b){this.__base.FCanvas.onBuild.call(this,b);RConsole.find(FE3sThemeConsole).select("color").loadListener().register(this,this.onThemeLoad)}function FDsMainCanvas_oeRefresh(b){this.__base.FCanvas.oeRefresh.call(this,b);return EEventStatus.Stop}
function FDsMainCanvas_construct(){this.__base.FCanvas.construct.call(this)}function FDsMainCanvas_selectModel(b){var f=RConsole.find(FModel3dConsole);null!=this._activeModel&&f.free(this._activeModel);b=f.alloc(this._context,b);this._layer.pushDisplay(b);this._activeModel=b}function FDsMainCanvas_dispose(){this.__base.FCanvas.dispose.call(this)}
function FDsMainCatalog(b){b=RClass.inherits(this,b,FDataTreeView);b.onBuild=FDsMainCatalog_onBuild;b.onNodeClick=FDsMainCatalog_onNodeClick;b.construct=FDsMainCatalog_construct;b.dispose=FDsMainCatalog_dispose;return b}function FDsMainCatalog_onBuild(b){this.__base.FDataTreeView.onBuild.call(this,b);this.lsnsClick.register(this,this.onNodeClick)}function FDsMainCatalog_onNodeClick(b,f){this._worksapce._canvas.selectModel(f.name())}
function FDsMainCatalog_construct(){this.__base.FDataTreeView.construct.call(this)}function FDsMainCatalog_dispose(){this.__base.FDataTreeView.dispose.call(this)}function FDsMainMenuBar(b){b=RClass.inherits(this,b,FMenuBar);b.onBuild=FDsMainMenuBar_onBuild;b.construct=FDsMainMenuBar_construct;b.dispose=FDsMainMenuBar_dispose;return b}
function FDsMainMenuBar_onBuild(b){this.__base.FMenuBar.onBuild.call(this,b);var f=this._framesetMain=RClass.create(FMenuButton);f.setLabel("\u6587\u4ef6");f.setIcon("design.menu.build");f.build(b);this.appendButton(f);f=this._framesetMain=RClass.create(FMenuButton);f.setLabel("\u4fdd\u5b58");f.setIcon("design.menu.save");f.build(b);this.appendButton(f);f=this._framesetMain=RClass.create(FMenuButton);f.setLabel("\u5e2e\u52a9");f.setIcon("design.menu.help");f.build(b);this.appendButton(f)}
function FDsMainMenuBar_construct(){this.__base.FMenuBar.construct.call(this)}function FDsMainMenuBar_dispose(){this.__base.FMenuBar.dispose.call(this)}function FDsMainToolBar(b){b=RClass.inherits(this,b,FToolBar);b.onPersistenceClick=FDsMainToolBar_onPersistenceClick;b.onBuild=FDsMainToolBar_onBuild;b.construct=FDsMainToolBar_construct;b.dispose=FDsMainToolBar_dispose;return b}
function FDsMainToolBar_onPersistenceClick(b){this._worksapce._catalog.loadUrl("/cloud.describe.tree.ws?action=query&code=resource3d.model")}
function FDsMainToolBar_onBuild(b){this.__base.FToolBar.onBuild.call(this,b);var f=this._persistenceButton=RClass.create(FToolButton);f.setLabel("\u6a21\u578b\u7ba1\u7406");f.build(b);f.lsnsClick.register(this,this.onPersistenceClick);this.appendButton(f);f=this._framesetMain=RClass.create(FToolButton);f.setLabel("\u6750\u8d28\u7ba1\u7406");f.build(b);this.appendButton(f);f=this._framesetMain=RClass.create(FToolButton);f.setLabel("\u6a21\u677f\u7ba1\u7406");f.build(b);this.appendButton(f);f=this._framesetMain=
RClass.create(FToolButton);f.setLabel("\u573a\u666f\u7ba1\u7406");f.build(b);this.appendButton(f)}function FDsMainToolBar_construct(){this.__base.FToolBar.construct.call(this)}function FDsMainToolBar_dispose(){this.__base.FToolBar.dispose.call(this)}
function FDsMainWindow(b){b=RClass.inherits(this,b,FObject);b._name=null;b._matrix=null;b._location=null;b._rotation=null;b._scale=null;b._visible=!0;b._renderables=null;b.construct=FDsMainWindow_construct;b.isName=FDsMainWindow_isName;b.name=FDsMainWindow_name;b.matrix=FDsMainWindow_matrix;b.location=FDsMainWindow_location;b.rotation=FDsMainWindow_rotation;b.scale=FDsMainWindow_scale;b.hasRenderable=FDsMainWindow_hasRenderable;b.filterRenderables=FDsMainWindow_filterRenderables;b.renderables=FDsMainWindow_renderables;
b.pushRenderable=FDsMainWindow_pushRenderable;b.process=FDsMainWindow_process;b.update=FDsMainWindow_update;b.dispose=FDsMainWindow_dispose;return b}function FDsMainWindow_construct(){this.__base.FObject.construct.call(this);this._matrix=new SMatrix3d;this._location=new SPoint3;this._rotation=new SVector3;this._scale=new SVector3;this._scale.set(1,1,1)}function FDsMainWindow_isName(b){return this._name==b}function FDsMainWindow_name(){return this._name}
function FDsMainWindow_matrix(){return this._matrix}function FDsMainWindow_location(){return this._location}function FDsMainWindow_rotation(){return this._rotation}function FDsMainWindow_scale(){return this._scale}function FDsMainWindow_hasRenderable(){var b=this._renderables;return null!=b?!b.isEmpty():!1}
function FDsMainWindow_filterRenderables(b){if(!this._visible)return!1;var f=this._renderables;if(null!=f)for(var h=f.count(),q=0;q<h;q++){var u=f.get(q);u.testVisible()&&b.pushRenderable(u)}return!0}function FDsMainWindow_renderables(){var b=this._renderables;null==b&&(b=this._renderables=new TObjects);return b}function FDsMainWindow_pushRenderable(b){this.renderables().push(b)}function FDsMainWindow_update(){var b=this._matrix;b.set(this._location,this._rotation,this._scale);b.update()}
function FDsMainWindow_process(){var b=this._renderables;if(null!=b)for(var f=b.count(),h=0;h<f;h++)b.get(h).process()}function FDsMainWindow_dispose(){this._scale=this._direction=this._position=this._matrix=null;var b=this._renderables;null!=b&&(b.dispose(),this._renderables=null);this.__base.FObject.dispose.call(this)}
function FDsMainWorkspace(b){b=RClass.inherits(this,b,FWorkspace);b._styleToolbarGround=RClass.register(b,new AStyle("_styleToolbarGround","Toolbar_Ground"));b._styleStatusbarGround=RClass.register(b,new AStyle("_styleStatusbarGround","Statusbar_Ground"));b._styleCatalogGround=RClass.register(b,new AStyle("_styleCatalogGround","Catalog_Ground"));b._styleWorkspaceGround=RClass.register(b,new AStyle("_styleWorkspaceGround","Workspace_Ground"));b._stylePropertyGround=RClass.register(b,new AStyle("_stylePropertyGround",
"Property_Ground"));b._framesetMain=null;b._framesetBody=null;b._frameToolBar=null;b._frameBody=null;b._frameProperty=null;b._frameCatalog=null;b._frameWorkspace=null;b._frameStatusBar=null;b.onBuild=FDsMainWorkspace_onBuild;b.construct=FDsMainWorkspace_construct;b.dispose=FDsMainWorkspace_dispose;return b}function FDsMainWorkspace_construct(){this.__base.FWorkspace.construct.call(this)}
function FDsMainWorkspace_onBuild(b){this.__base.FWorkspace.onBuild.call(this,b);this._hPanel.style.width="100%";this._hPanel.style.height="100%";var f=this._framesetMain=RClass.create(FFrameSet);f.build(b);var h=this._frameToolBar=RClass.create(FFrame);h.setHeight(26);h.build(b);h._hPanel.className=this.styleName("Toolbar_Ground");f.appendFrame(h);h=this._frameBody=RClass.create(FFrame);h.build(b);f.appendFrame(h);h=this._frameProperty=RClass.create(FFrame);h.setHeight(18);h.build(b);h._hPanel.className=
this.styleName("Statusbar_Ground");f.appendFrame(h);f.setPanel(this._hPanel);f=RClass.create(FFrameSet);f._directionCd=EDirection.Horizontal;f.build(b);h=this._frameCatalog=RClass.create(FFrame);h.setWidth(300);h.build(b);h._hPanel.className=this.styleName("Catalog_Ground");f.appendFrame(h);var q=f.appendSpliter(),h=this._frameWorkspace=RClass.create(FFrame);h.build(b);h._hPanel.className=this.styleName("Workspace_Ground");f.appendFrame(h);var u=f.appendSpliter(),h=this._frameStatusBar=RClass.create(FFrame);
h.setWidth(360);h.build(b);h._hPanel.className=this.styleName("Property_Ground");f.appendFrame(h);f.setPanel(this._frameBody._hPanel);q._alignCd=EAlign.Left;q._hSize=this._frameCatalog._hPanel;u._alignCd=EAlign.Right;u._hSize=this._frameStatusBar._hPanel;f=this._catalog=RClass.create(FDsMainCatalog);f._worksapce=this;f.build(b);f.setPanel(this._frameCatalog._hPanel);this.push(f);f=this._toolbar=RClass.create(FDsMainToolBar);f._worksapce=this;f.build(b);f.setPanel(this._frameToolBar._hPanel);f._persistenceButton.click();
this.push(f);f=this._canvas=RClass.create(FDsMainCanvas);f._worksapce=this;f.build(b);f.setPanel(this._frameWorkspace._hPanel);this.push(f)}function FDsMainWorkspace_dispose(){this.__base.FWorkspace.dispose.call(this)}var temp=0,temp=temp=0;
function FDsTemplateCanvas(b){b=RClass.inherits(this,b,FDsCanvas,MListenerLoad,MMouseCapture);b._toolbar=null;b._context=null;b._stage=null;b._layer=null;b._activeTemplate=null;b._rotation=null;b._rotationAble=!1;b._capturePosition=null;b._captureMatrix=null;b._captureRotation=null;b._dimensional=null;b._selectBoundBox=null;b.onBuild=FDsTemplateCanvas_onBuild;b.onMouseCaptureStart=FDsTemplateCanvas_onMouseCaptureStart;b.onMouseCapture=FDsTemplateCanvas_onMouseCapture;b.onMouseCaptureStop=FDsTemplateCanvas_onMouseCaptureStop;
b.onEnterFrame=FDsTemplateCanvas_onEnterFrame;b.onTemplateLoad=FDsTemplateCanvas_onTemplateLoad;b.oeRefresh=FDsTemplateCanvas_oeRefresh;b.construct=FDsTemplateCanvas_construct;b.selectRenderable=FDsTemplateCanvas_selectRenderable;b.loadTemplate=FDsTemplateCanvas_loadTemplate;b.dispose=FDsTemplateCanvas_dispose;return b}
function FDsTemplateCanvas_onBuild(b){this.__base.FDsCanvas.onBuild.call(this,b);var f=this._stage=RClass.create(FE3dSimpleStage);f.backgroundColor().set(.5,.5,.5,1);f.selectTechnique(this,FG3dGeneralTechnique);b=this._layer=this._stage.spriteLayer();RStage.register("stage3d",this._stage);var h=f.camera();h.setPosition(0,3,-10);h.lookAt(0,3,0);h.update();var q=this._hPanel,h=h.projection();h.size().set(q.width,q.height);h._angle=45;h.update();f=f.directionalLight().camera();f.setPosition(10,10,0);
f.lookAt(0,0,0);f.update();b.pushRenderable(this._dimensional)}function FDsTemplateCanvas_onMouseCaptureStart(b){var f=this._activeTemplate;f&&(f=f.renderables().get(0),this._capturePosition.set(b.clientX,b.clientY),this._captureMatrix.assign(f.matrix()),b=this._stage.camera(),this._captureRotation.assign(b._rotation))}
function FDsTemplateCanvas_onMouseCapture(b){var f=this._activeTemplate;if(f){var h=b.clientX-this._capturePosition.x;b=b.clientY-this._capturePosition.y;var f=f.renderables().get(0).matrix(),q=this._captureMatrix;switch(this._toolbar._canvasModeCd){case EDsCanvasMode.Drop:var q=this._stage.camera().rotation(),u=this._captureRotation;q.x=u.x+.003*b;q.y=u.y+.003*h;break;case EDsCanvasMode.Translate:f.tx=q.tx+h/360*3.14;f.ty=q.ty+b/360*3.14;break;case EDsCanvasMode.Rotation:f.ry=q.ry+h*RMath.DEGREE_RATE;
break;case EDsCanvasMode.Scale:f.sx=q.sx+h/100,f.sy=q.sy+h/100,f.sz=q.sz+h/100}f.updateForce()}}function FDsTemplateCanvas_onMouseCaptureStop(b){}
function FDsTemplateCanvas_onEnterFrame(){var b=this._stage;if(b){var f=b.camera(),b=.05,h=RKeyboard.isPress(EKeyCode.W),q=RKeyboard.isPress(EKeyCode.S);h&&!q&&f.doWalk(.5);!h&&q&&f.doWalk(-.5);h=RKeyboard.isPress(EKeyCode.A);q=RKeyboard.isPress(EKeyCode.D);h&&!q&&f.doYaw(b);!h&&q&&f.doYaw(-b);h=RKeyboard.isPress(EKeyCode.Q);q=RKeyboard.isPress(EKeyCode.E);h&&!q&&f.doFly(.5);!h&&q&&f.doFly(-.5);q=RKeyboard.isPress(EKeyCode.Z);h=RKeyboard.isPress(EKeyCode.X);q&&!h&&f.doPitch(b);!q&&h&&f.doPitch(-b);
f.update();if(f=this._activeTemplate)b=this._rotation,f.scale().set(.002,.002,.002),f.update(),this._rotationAble&&(b.y+=.01)}}function FDsTemplateCanvas_onTemplateLoad(b){this.processLoadListener(this)}
function FDsTemplateCanvas_oeRefresh(b){var f=this._graphicContext;this.__base.FDsCanvas.oeRefresh.call(this,b);b=this._hParent.offsetWidth;var h=this._hParent.offsetHeight,q=this._hPanel;q.width=b;q.height=h;q=this._stage.camera().projection();q.size().set(b,h);q.update();f.setViewport(0,0,b,h);return EEventStatus.Stop}
function FDsTemplateCanvas_construct(){this.__base.FDsCanvas.construct.call(this);this._capturePosition=new SPoint2;this._captureMatrix=new SMatrix3d;this._rotation=new SVector3;this._captureRotation=new SVector3}function FDsTemplateCanvas_selectRenderable(b){b.resource().mesh().outline()}
function FDsTemplateCanvas_loadTemplate(b){var f=RConsole.find(FE3dTemplateConsole);null!=this._activeTemplate&&f.free(this._activeTemplate);b=f.alloc(this._graphicContext,b);b.addLoadListener(this,this.onTemplateLoad);this._layer.pushDisplay(b);this._activeTemplate=b}function FDsTemplateCanvas_dispose(){var b=this._rotation;b&&(b.dispose(),this._rotation=null);this.__base.FDsCanvas.dispose.call(this)}
function FDsTemplateCanvasToolBar(b){b=RClass.inherits(this,b,FUiToolBar);b._refreshButton=null;b._saveButton=null;b._canvasModeCd=EDsCanvasMode.Drop;b.onBuild=FDsTemplateCanvasToolBar_onBuild;b.onModeClick=FDsTemplateCanvasToolBar_onModeClick;b.onLookClick=FDsTemplateCanvasToolBar_onLookClick;b.onRotationClick=FDsTemplateCanvasToolBar_onRotationClick;b.construct=FDsTemplateCanvasToolBar_construct;b.dispose=FDsTemplateCanvasToolBar_dispose;return b}
function FDsTemplateCanvasToolBar_onBuild(b){this.__base.FUiToolBar.onBuild.call(this,b);var f=this._dropButton=RClass.create(FUiToolButtonCheck);f.setName("dropButton");f.setIcon("design3d.canvas.hand");f.setGroupName("mode");f.setGroupDefault("dropButton");f.build(b);f._canvasModeCd=EDsCanvasMode.Drop;f.addClickListener(this,this.onModeClick);f.check(!0);this.push(f);f=this._selectButton=RClass.create(FUiToolButtonCheck);f.setName("selectButton");f.setIcon("design3d.canvas.pointer");f.setGroupName("mode");
f.setGroupDefault("dropButton");f.build(b);f._canvasModeCd=EDsCanvasMode.Select;f.addClickListener(this,this.onModeClick);this.push(f);f=RClass.create(FUiToolButtonSplit);f.build(b);this.push(f);f=this._translateButton=RClass.create(FUiToolButtonCheck);f.setName("translateButton");f.setIcon("design3d.canvas.translate");f.setGroupName("mode");f.setGroupDefault("dropButton");f.build(b);f._canvasModeCd=EDsCanvasMode.Translate;f.addClickListener(this,this.onModeClick);this.push(f);f=this._rotationButton=
RClass.create(FUiToolButtonCheck);f.setName("rotationButton");f.setIcon("design3d.canvas.rotation");f.setGroupName("mode");f.setGroupDefault("dropButton");f.build(b);f._canvasModeCd=EDsCanvasMode.Rotation;f.addClickListener(this,this.onModeClick);this.push(f);f=this._scaleButton=RClass.create(FUiToolButtonCheck);f.setName("scaleButton");f.setIcon("design3d.canvas.scale");f.setGroupName("mode");f.setGroupDefault("dropButton");f.build(b);f._canvasModeCd=EDsCanvasMode.Scale;f.addClickListener(this,this.onModeClick);
this.push(f);f=RClass.create(FUiToolButtonSplit);f.build(b);this.push(f);f=this._lookFrontButton=RClass.create(FUiToolButton);f.setName("lookFrontButton");f.setLabel("\u524d");f.build(b);f.addClickListener(this,this.onLookClick);this.push(f);f=this._lookUpButton=RClass.create(FUiToolButton);f.setName("lookUpButton");f.setLabel("\u4e0a");f.build(b);f.addClickListener(this,this.onLookClick);this.push(f);f=this._lookLeftButton=RClass.create(FUiToolButton);f.setName("lookLeftButton");f.setLabel("\u5de6");
f.build(b);f.addClickListener(this,this.onLookClick);this.push(f);f=RClass.create(FUiToolButtonSplit);f.build(b);this.push(f);f=this._playButton=RClass.create(FUiToolButtonCheck);f.setName("_playButton");f.setLabel("\u64ad\u653e");f.setIcon("design3d.tools.play");f.build(b);f.addClickListener(this,this.onRotationClick);this.push(f);f=this._viewButton=RClass.create(FUiToolButtonCheck);f.setName("_viewButton");f.setLabel("\u65cb\u8f6c");f.setIcon("design3d.tools.rotation");f.build(b);f.addClickListener(this,
this.onRotationClick);this.push(f)}function FDsTemplateCanvasToolBar_onModeClick(b){this._canvasModeCd=b._canvasModeCd}function FDsTemplateCanvasToolBar_onLookClick(b){this._canvasModeCd=b._canvasModeCd}function FDsTemplateCanvasToolBar_onRotationClick(b,f){this._workspace._canvas._rotationAble=f}function FDsTemplateCanvasToolBar_construct(){this.__base.FUiToolBar.construct.call(this)}function FDsTemplateCanvasToolBar_dispose(){this.__base.FUiToolBar.dispose.call(this)}
function FDsTemplateCatalog(b){b=RClass.inherits(this,b,FUiDataTreeView,MListenerSelected);b.onBuild=FDsTemplateCatalog_onBuild;b.onNodeClick=FDsTemplateCatalog_onNodeClick;b.lsnsSelect=null;b.construct=FDsTemplateCatalog_construct;b.buildTheme=FDsTemplateCatalog_buildTheme;b.buildDisplay=FDsTemplateCatalog_buildDisplay;b.buildTemplate=FDsTemplateCatalog_buildTemplate;b.selectObject=FDsTemplateCatalog_selectObject;b.dispose=FDsTemplateCatalog_dispose;return b}
function FDsTemplateCatalog_onBuild(b){this.__base.FUiDataTreeView.onBuild.call(this,b);this.lsnsClick.register(this,this.onNodeClick);this.loadUrl("/cloud.describe.tree.ws?action=query&code=design3d.template")}function FDsTemplateCatalog_onNodeClick(b,f){var h=f.dataPropertyGet("linker");this.selectObject(h)}function FDsTemplateCatalog_construct(){this.__base.FUiDataTreeView.construct.call(this)}
function FDsTemplateCatalog_buildTheme(b,f){var h=this.createNode();h.setLabel(f.code());h.setTypeName("theme");h.dataPropertySet("linker",f);b.appendNode(h);var q=f.materials(),u=q.count();if(0<u)for(var z=RConsole.find(FE3sMaterialConsole),A=0;A<u;A++){var B=q.value(A),C=z.findGroup(B.groupGuid()),D=this.createNode();D.setLabel(C.code());D.setTypeName("material");D.dataPropertySet("linker",B);h.appendNode(D)}}
function FDsTemplateCatalog_buildDisplay(b,f){var h=this.createNode();h.setLabel(f.code());h.setTypeName("theme");h.dataPropertySet("linker",f);b.appendNode(h);var q=f.materials(),u=q.count();if(0<u)for(var z=RConsole.find(FE3sMaterialGroupConsole),A=0;A<u;A++){var B=q.value(A),C=z.find(B.groupGuid()),D=this.createNode();D.setLabel(C.code());D.setTypeName("material");D.dataPropertySet("linker",B);h.appendNode(D)}}
function FDsTemplateCatalog_buildTemplate(b){var f=b._resource,h=this.createNode();h.setLabel(f.code());h.setTypeName("template");h.dataPropertySet("linker",b);this.appendNode(h);var f=f.themes(),q=f.count();if(0<q){var u=this.createNode();u.setLabel("Themes");u.setTypeName("themes");h.appendNode(u);for(var z=0;z<q;z++)this.buildTheme(u,f.get(z))}b=b.renderables();q=b.count();if(0<q)for(u=this.createNode(),u.setLabel("Renderables"),u.setTypeName("displays"),h.appendNode(u),z=0;z<q;z++){var h=b.get(z),
f=h.resource(),A=f.model(),f=f.mesh(),B=this.createNode();B.setLabel(A.code()+" - "+f.code());B.setTypeName("display");B.dataPropertySet("linker",h);u.appendNode(B)}}function FDsTemplateCatalog_selectObject(b){null!=b&&this.processSelectedListener(b)}function FDsTemplateCatalog_dispose(){this.__base.FUiDataTreeView.dispose.call(this)}
function FDsTemplateDisplayFrame(b){b=RClass.inherits(this,b,FUiForm);b._renderTemplate=null;b._renderDisplay=null;b.onBuilded=FDsTemplateDisplayFrame_onBuilded;b.onDataChanged=FDsTemplateDisplayFrame_onDataChanged;b.construct=FDsTemplateDisplayFrame_construct;b.loadObject=FDsTemplateDisplayFrame_loadObject;b.dispose=FDsTemplateDisplayFrame_dispose;return b}
function FDsTemplateDisplayFrame_onBuilded(b){this.__base.FUiForm.onBuilded.call(this,b);b=this.searchControl("matrixPanel");var f=this._controlTranslate=b.searchControl("translate");f.addDataChangedListener(this,this.onDataChanged);f=this._controlRotation=b.searchControl("rotation");f.addDataChangedListener(this,this.onDataChanged);f=this._controlScale=b.searchControl("scale");f.addDataChangedListener(this,this.onDataChanged)}
function FDsTemplateDisplayFrame_onDataChanged(b){b=this._renderDisplay.matrix();var f=this._controlTranslate.get();b.setTranslate(f.x,f.y,f.z);f=this._controlRotation.get();b.setRotation(f.x,f.y,f.z);f=this._controlScale.get();b.setScale(f.x,f.y,f.z);b.update()}function FDsTemplateDisplayFrame_construct(){this.__base.FUiForm.construct.call(this)}
function FDsTemplateDisplayFrame_loadObject(b,f){this._renderTemplate=b;this._renderDisplay=f;var h=f.matrix();this._controlTranslate.set(h.tx,h.ty,h.tz);this._controlRotation.set(h.rx,h.ry,h.rz);this._controlScale.set(h.sx,h.sy,h.sz)}function FDsTemplateDisplayFrame_dispose(){this.__base.FUiForm.dispose.call(this)}
function FDsTemplateDisplayPropertyFrame(b){b=RClass.inherits(this,b,FUiForm);b._visible=!1;b._frameName="design3d.template.property.DisplayFrame";b._workspace=null;b._renderTemplate=null;b._renderDisplay=null;b._renderMaterial=null;b._controlGuid=null;b._controlCode=null;b._controlLabel=null;b._displayFrame=null;b._materialFrame=null;b.onBuilded=FDsTemplateDisplayPropertyFrame_onBuilded;b.construct=FDsTemplateDisplayPropertyFrame_construct;b.loadObject=FDsTemplateDisplayPropertyFrame_loadObject;
b.dispose=FDsTemplateDisplayPropertyFrame_dispose;return b}function FDsTemplateDisplayPropertyFrame_onBuilded(b){this.__base.FUiForm.onBuilded.call(this,b);this._controlGuid=this.searchControl("guid");this._controlCode=this.searchControl("code");this._controlLabel=this.searchControl("label");this._displayFrame=this.searchControl("design3d.template.DisplayFrame");this._materialFrame=this.searchControl("design3d.template.MaterialFrame")}
function FDsTemplateDisplayPropertyFrame_construct(){this.__base.FUiForm.construct.call(this)}function FDsTemplateDisplayPropertyFrame_loadObject(b,f){var h=b._resource,q=f._resource.materials().first(),h=h.themes().first().materials().get(q.groupGuid());this._renderTemplate=b;this._renderDisplay=f;this._renderMaterial=h;this._displayFrame.loadObject(b,f);this._materialFrame.loadObject(b,h)}function FDsTemplateDisplayPropertyFrame_dispose(){this.__base.FUiForm.dispose.call(this)}
function FDsTemplateMaterialFrame(b){b=RClass.inherits(this,b,FUiForm);b._template=null;b._material=null;b._controlGuid=null;b._controlCode=null;b._controlLabel=null;b._controlAmbientColor=null;b._controlDiffuseColor=null;b._controlSpecularColor=null;b._controlSpecularLevel=null;b._controlReflectColor=null;b._controlReflectMerge=null;b._controlEmissiveColor=null;b.onBuilded=FDsTemplateMaterialFrame_onBuilded;b.onDataChanged=FDsTemplateMaterialFrame_onDataChanged;b.construct=FDsTemplateMaterialFrame_construct;
b.loadObject=FDsTemplateMaterialFrame_loadObject;b.dispose=FDsTemplateMaterialFrame_dispose;return b}
function FDsTemplateMaterialFrame_onBuilded(b){this.__base.FUiForm.onBuilded.call(this,b);this._controlGuid=this.searchControl("guid");this._controlCode=this.searchControl("code");this._controlLabel=this.searchControl("label");b=this._controlAmbientColor=this.searchControl("ambientColor");b.addDataChangedListener(this,this.onDataChanged);b=this._controlDiffuseColor=this.searchControl("diffuseColor");b.addDataChangedListener(this,this.onDataChanged);b=this._controlSpecularColor=this.searchControl("specularColor");
b.addDataChangedListener(this,this.onDataChanged);b=this._controlSpecularLevel=this.searchControl("specularLevel");b.addDataChangedListener(this,this.onDataChanged);b=this._controlReflectColor=this.searchControl("reflectColor");b.addDataChangedListener(this,this.onDataChanged);b=this._controlReflectMerge=this.searchControl("reflectMerge");b.addDataChangedListener(this,this.onDataChanged);b=this._controlEmissiveColor=this.searchControl("emissiveColor");b.addDataChangedListener(this,this.onDataChanged)}
function FDsTemplateMaterialFrame_onDataChanged(b){b=this._template;var f=this._material.info(),h=this._controlAmbientColor.get();f.ambientColor.assign(h);h=this._controlDiffuseColor.get();f.diffuseColor.assign(h);h=this._controlSpecularColor.get();f.specularColor.assign(h);h=this._controlSpecularLevel.get();f.specularLevel=h;h=this._controlReflectColor.get();f.reflectColor.assign(h);h=this._controlReflectMerge.get();f.reflectMerge=h;h=this._controlEmissiveColor.get();f.emissiveColor.assign(h);b.reloadResource()}
function FDsTemplateMaterialFrame_construct(){this.__base.FUiForm.construct.call(this)}
function FDsTemplateMaterialFrame_loadObject(b,f){this._template=b;this._material=f;var h=f.group(),q=f.info();this._controlGuid.set(f.guid());this._controlCode.set(h.code());this._controlLabel.set(f._label);this._controlAmbientColor.set(q.ambientColor);this._controlDiffuseColor.set(q.diffuseColor);this._controlSpecularColor.set(q.specularColor);this._controlSpecularLevel.set(q.specularLevel);this._controlReflectColor.set(q.reflectColor);this._controlReflectMerge.set(q.reflectMerge);this._controlEmissiveColor.set(q.emissiveColor)}
function FDsTemplateMaterialFrame_dispose(){this.__base.FUiForm.dispose.call(this)}
function FDsTemplateMaterialPropertyFrame(b){b=RClass.inherits(this,b,FUiForm);b._visible=!1;b._frameName="design3d.template.property.MaterialFrame";b._workspace=null;b._renderTemplate=null;b._renderMaterial=null;b._materialFrame=null;b.onBuilded=FDsTemplateMaterialPropertyFrame_onBuilded;b.construct=FDsTemplateMaterialPropertyFrame_construct;b.loadObject=FDsTemplateMaterialPropertyFrame_loadObject;b.dispose=FDsTemplateMaterialPropertyFrame_dispose;return b}
function FDsTemplateMaterialPropertyFrame_onBuilded(b){this.__base.FUiForm.onBuilded.call(this,b);this._materialFrame=this.searchControl("design3d.template.MaterialFrame")}function FDsTemplateMaterialPropertyFrame_construct(){this.__base.FUiForm.construct.call(this)}function FDsTemplateMaterialPropertyFrame_loadObject(b,f){this._renderTemplate=b;this._renderMaterial=f;this._materialFrame.loadObject(b,f)}function FDsTemplateMaterialPropertyFrame_dispose(){this.__base.FUiForm.dispose.call(this)}
function FDsTemplatePropertyFrame(b){b=RClass.inherits(this,b,FUiForm);b._visible=!1;b._frameName="design3d.template.property.TemplateFrame";b._workspace=null;b._renderTemplate=null;b._controlGuid=null;b._controlCode=null;b._controlLabel=null;b.onBuilded=FDsTemplatePropertyFrame_onBuilded;b.construct=FDsTemplatePropertyFrame_construct;b.loadObject=FDsTemplatePropertyFrame_loadObject;b.dispose=FDsTemplatePropertyFrame_dispose;return b}
function FDsTemplatePropertyFrame_onBuilded(b){this.__base.FUiForm.onBuilded.call(this,b);this._controlGuid=this.searchControl("guid");this._controlCode=this.searchControl("code");this._controlLabel=this.searchControl("label")}function FDsTemplatePropertyFrame_construct(){this.__base.FUiForm.construct.call(this)}function FDsTemplatePropertyFrame_loadObject(b){var f=b._resource;this._renderTemplate=b;this._controlGuid.set(f.guid());this._controlCode.set(f.code());this._controlLabel.set(f._label)}
function FDsTemplatePropertyFrame_dispose(){this.__base.FUiForm.dispose.call(this)}
function FDsTemplateThemePropertyFrame(b){b=RClass.inherits(this,b,FUiForm);b._visible=!1;b._frameName="design3d.template.property.ThemeFrame";b._workspace=null;b._renderTemplate=null;b._renderTheme=null;b._controlGuid=null;b._controlCode=null;b._controlLabel=null;b.onBuilded=FDsTemplateThemePropertyFrame_onBuilded;b.construct=FDsTemplateThemePropertyFrame_construct;b.loadObject=FDsTemplateThemePropertyFrame_loadObject;b.dispose=FDsTemplateThemePropertyFrame_dispose;return b}
function FDsTemplateThemePropertyFrame_onBuilded(b){this.__base.FUiForm.onBuilded.call(this,b);this._controlGuid=this.searchControl("guid");this._controlCode=this.searchControl("code");this._controlLabel=this.searchControl("label")}function FDsTemplateThemePropertyFrame_construct(){this.__base.FUiForm.construct.call(this)}
function FDsTemplateThemePropertyFrame_loadObject(b,f){this._renderTemplate=b;this._renderTheme=f;this._controlGuid.set(f.guid());this._controlCode.set(f.code());this._controlLabel.set(f._label)}function FDsTemplateThemePropertyFrame_dispose(){this.__base.FUiForm.dispose.call(this)}
function FDsTemplateToolBar(b){b=RClass.inherits(this,b,FUiToolBar);b._refreshButton=null;b._saveButton=null;b.onBuild=FDsTemplateToolBar_onBuild;b.onRefreshClick=FDsTemplateToolBar_onRefreshClick;b.onSaveClick=FDsTemplateToolBar_onSaveClick;b.construct=FDsTemplateToolBar_construct;b.dispose=FDsTemplateToolBar_dispose;return b}
function FDsTemplateToolBar_onBuild(b){this.__base.FUiToolBar.onBuild.call(this,b);var f=this._refreshButton=RClass.create(FUiToolButton);f.setLabel("\u5237\u65b0");f.setIcon("design3d.tools.refresh");f.build(b);f.addClickListener(this,this.onRefreshClick);this.push(f);f=this._saveButton=RClass.create(FUiToolButton);f.setLabel("\u4fdd\u5b58");f.setIcon("design3d.tools.save");f.build(b);f.addClickListener(this,this.onSaveClick);this.push(f)}function FDsTemplateToolBar_onRefreshClick(b){}
function FDsTemplateToolBar_onSaveClick(b){var f=this._workspace._activeTemplate;b=f._resource.themes();for(var h=b.count(),q=new TXmlNode,u=0;u<h;u++)for(var f=b.get(u),f=f.materials(),z=f.count(),A=0;A<z;A++)f.value(A).saveConfig(q.create("Material"));RConsole.find(FE3sTemplateConsole).update(q)}function FDsTemplateToolBar_construct(){this.__base.FUiToolBar.construct.call(this)}function FDsTemplateToolBar_dispose(){this.__base.FUiToolBar.dispose.call(this)}
function FDsTemplateWorkspace(b){b=RClass.inherits(this,b,FUiWorkspace);b._styleToolbarGround=RClass.register(b,new AStyle("_styleToolbarGround","Toolbar_Ground"));b._styleStatusbarGround=RClass.register(b,new AStyle("_styleStatusbarGround","Statusbar_Ground"));b._styleCatalogGround=RClass.register(b,new AStyle("_styleCatalogGround","Catalog_Ground"));b._styleWorkspaceGround=RClass.register(b,new AStyle("_styleWorkspaceGround","Workspace_Ground"));b._stylePropertyGround=RClass.register(b,new AStyle("_stylePropertyGround",
"Property_Ground"));b._framesetMain=null;b._framesetBody=null;b._frameToolBar=null;b._frameBody=null;b._frameProperty=null;b._frameCatalog=null;b._frameWorkspace=null;b._frameStatusBar=null;b._templatePropertyFrame=null;b._themePropertyFrame=null;b._materialPropertyFrame=null;b._displayPropertyFrame=null;b.onBuild=FDsTemplateWorkspace_onBuild;b.onTemplateLoad=FDsTemplateWorkspace_onTemplateLoad;b.onCatalogSelected=FDsTemplateWorkspace_onCatalogSelected;b.construct=FDsTemplateWorkspace_construct;b.templatePropertyFrame=
FDsTemplateWorkspace_templatePropertyFrame;b.themePropertyFrame=FDsTemplateWorkspace_themePropertyFrame;b.materialPropertyFrame=FDsTemplateWorkspace_materialPropertyFrame;b.displayPropertyFrame=FDsTemplateWorkspace_displayPropertyFrame;b.loadTemplate=FDsTemplateWorkspace_loadTemplate;b.dispose=FDsTemplateWorkspace_dispose;return b}
function FDsTemplateWorkspace_onBuild(b){this.__base.FUiWorkspace.onBuild.call(this,b);this._hPanel.style.width="100%";this._hPanel.style.height="100%";var f=this._framesetMain=RClass.create(FUiFrameSet);f.build(b);var h=this._frameToolBar=RClass.create(FUiFramePage);h.setHeight(26);h.build(b);h._hPanel.className=this.styleName("Toolbar_Ground");f.appendFrame(h);h=this._frameBody=RClass.create(FUiFramePage);h.build(b);f.appendFrame(h);h=this._frameStatusBar=RClass.create(FUiFramePage);h.setHeight(18);
h.build(b);h._hPanel.className=this.styleName("Statusbar_Ground");f.appendFrame(h);f.setPanel(this._hPanel);f=RClass.create(FUiFrameSet);f._directionCd=EUiDirection.Horizontal;f.build(b);h=this._frameCatalog=RClass.create(FUiFramePage);h.setWidth(400);h.build(b);h._hPanel.className=this.styleName("Catalog_Ground");f.appendFrame(h);var q=f.appendSpliter(),h=this._frameWorkspace=RClass.create(FUiFramePage);h.build(b);h._hPanel.className=this.styleName("Workspace_Ground");f.appendFrame(h);var u=f.appendSpliter(),
h=this._frameProperty=RClass.create(FUiFramePage);h.setWidth(240);h.build(b);h._hPanel.className=this.styleName("Property_Ground");f.appendFrame(h);f.setPanel(this._frameBody._hPanel);q._alignCd=EUiAlign.Left;q._hSize=this._frameCatalog._hPanel;u._alignCd=EUiAlign.Right;u._hSize=this._frameStatusBar._hPanel;f=this._catalog=RClass.create(FDsTemplateCatalog);f._workspace=this;f.build(b);f.setPanel(this._frameCatalog._hPanel);f.addSelectedListener(this,this.onCatalogSelected);this.push(f);f=this._toolbar=
RClass.create(FDsTemplateToolBar);f._workspace=this;f.build(b);f.setPanel(this._frameToolBar._hPanel);this.push(f);h=RBuilder.appendTable(this._frameWorkspace._hPanel);h.style.width="100%";h.style.height="100%";q=RBuilder.appendTableRowCell(h);q.height=20;f=this._canvasToolbar=RClass.create(FDsTemplateCanvasToolBar);f._workspace=this;f.build(b);f.setPanel(q);this.push(f);q=RBuilder.appendTableRowCell(h);q.vAlign="top";f=this._canvas=RClass.create(FDsTemplateCanvas);f.addLoadListener(this,this.onTemplateLoad);
f._workspace=this;f._toolbar=this._canvasToolbar;f.build(b);f.setPanel(q);this.push(f)}function FDsTemplateWorkspace_onTemplateLoad(b){b=this._activeTemplate=b._activeTemplate;this._catalog.buildTemplate(b);this.onCatalogSelected(b)}
function FDsTemplateWorkspace_onCatalogSelected(b){var f=this._activeTemplate;this._templatePropertyFrame&&this._templatePropertyFrame.hide();this._themePropertyFrame&&this._themePropertyFrame.hide();this._materialPropertyFrame&&this._materialPropertyFrame.hide();this._displayPropertyFrame&&this._displayPropertyFrame.hide();if(RClass.isClass(b,FE3dTemplate)){var h=this.templatePropertyFrame();h.show();h.loadObject(f)}else if(RClass.isClass(b,FE3sTemplateTheme))h=this.themePropertyFrame(),h.show(),
h.loadObject(f,b);else if(RClass.isClass(b,FE3sMaterial))h=this.materialPropertyFrame(),h.show(),h.loadObject(f,b);else if(RClass.isClass(b,MG3dRenderable))h=this.displayPropertyFrame(),h.show(),h.loadObject(f,b),this._canvas.selectRenderable(b);else throw new TError("Unknown select object type. (value={1})",b);}function FDsTemplateWorkspace_construct(){this.__base.FUiWorkspace.construct.call(this)}
function FDsTemplateWorkspace_templatePropertyFrame(){var b=this._templatePropertyFrame;b||(b=this._templatePropertyFrame=RClass.create(FDsTemplatePropertyFrame),b._workspace=this,b.buildDefine(this._hPanel),b.setPanel(this._frameProperty._hPanel));return b}
function FDsTemplateWorkspace_themePropertyFrame(){var b=this._themePropertyFrame;b||(b=this._themePropertyFrame=RClass.create(FDsTemplateThemePropertyFrame),b._workspace=this,b.buildDefine(this._hPanel),b.setPanel(this._frameProperty._hPanel));return b}
function FDsTemplateWorkspace_materialPropertyFrame(){var b=this._materialPropertyFrame;b||(b=this._materialPropertyFrame=RClass.create(FDsTemplateMaterialPropertyFrame),b._workspace=this,b.buildDefine(this._hPanel),b.setPanel(this._frameProperty._hPanel));return b}
function FDsTemplateWorkspace_displayPropertyFrame(){var b=this._displayPropertyFrame;b||(b=this._displayPropertyFrame=RClass.create(FDsTemplateDisplayPropertyFrame),b._workspace=this,b.buildDefine(this._hPanel),b.setPanel(this._frameProperty._hPanel));return b}function FDsTemplateWorkspace_loadTemplate(b){this._canvas.loadTemplate(b)}function FDsTemplateWorkspace_dispose(){this.__base.FUiWorkspace.dispose.call(this)}
function FDsSceneCameraFrame(b){b=RClass.inherits(this,b,FUiForm);b._visible=!1;b._workspace=null;b._camera=null;b._controlPosition=null;b._controlDirection=null;b.construct=FDsSceneCameraFrame_construct;b.loadObject=FDsSceneCameraFrame_loadObject;b.dispose=FDsSceneCameraFrame_dispose;return b}function FDsSceneCameraFrame_construct(){this.__base.FUiForm.construct.call(this)}
function FDsSceneCameraFrame_loadObject(b,f){this._camera=f;this._controlPosition.set(f.position());this._controlDirection.set(f.direction())}function FDsSceneCameraFrame_dispose(){this.__base.FUiForm.dispose.call(this)}
function FDsSceneCameraPropertyFrame(b){b=RClass.inherits(this,b,FUiForm);b._visible=!1;b._workspace=null;b._camera=null;b._controlGuid=null;b._controlCode=null;b._controlLabel=null;b._controlPosition=null;b._controlDirection=null;b.construct=FDsSceneCameraPropertyFrame_construct;b.loadObject=FDsSceneCameraPropertyFrame_loadObject;b.dispose=FDsSceneCameraPropertyFrame_dispose;return b}function FDsSceneCameraPropertyFrame_construct(){this.__base.FUiForm.construct.call(this)}
function FDsSceneCameraPropertyFrame_loadObject(b,f){var h=f._resource;this._camera=f;this._controlGuid.set(h.guid());this._controlCode.set(h.code());this._controlLabel.set(h.label());this._controlPosition.set(f.position());this._controlDirection.set(f.direction())}function FDsSceneCameraPropertyFrame_dispose(){this.__base.FUiForm.dispose.call(this)}
function FDsSceneCanvas(b){b=RClass.inherits(this,b,FDsCanvas);b._graphicContext=null;b._canvasModeCd=EDsCanvasMode.Drop;b._canvasMoveCd=EDsCanvasDrag.Unknown;b._activeScene=null;b._rotation=null;b._optionRotation=!1;b._capturePosition=null;b._captureMatrix=null;b._captureRotation=null;b._dimensional=null;b._selectObject=null;b._selectRenderables=null;b._cameraMoveRate=.8;b._cameraKeyRotation=.03;b._cameraMouseRotation=.005;b._templateMatrix=null;b._templateRenderable=null;b._templateFace=null;b._templateTranslation=
null;b._templateRotation=null;b._templateScale=null;b._templateViewScale=.05;b.onBuild=FDsSceneCanvas_onBuild;b.onMouseCaptureStart=FDsSceneCanvas_onMouseCaptureStart;b.onMouseCapture=FDsSceneCanvas_onMouseCapture;b.onMouseCaptureStop=FDsSceneCanvas_onMouseCaptureStop;b.onEnterFrame=FDsSceneCanvas_onEnterFrame;b.onSceneLoad=FDsSceneCanvas_onSceneLoad;b.oeRefresh=FDsSceneCanvas_oeRefresh;b.construct=FDsSceneCanvas_construct;b.innerSelectDisplay=FDsSceneCanvas_innerSelectDisplay;b.innerSelectLayer=
FDsSceneCanvas_innerSelectLayer;b.selectNone=FDsSceneCanvas_selectNone;b.selectLayers=FDsSceneCanvas_selectLayers;b.selectLayer=FDsSceneCanvas_selectLayer;b.selectDisplay=FDsSceneCanvas_selectDisplay;b.selectMaterial=FDsSceneCanvas_selectMaterial;b.selectRenderable=FDsSceneCanvas_selectRenderable;b.switchMode=FDsSceneCanvas_switchMode;b.switchPlay=FDsSceneCanvas_switchPlay;b.switchMovie=FDsSceneCanvas_switchMovie;b.loadScene=FDsSceneCanvas_loadScene;b.dispose=FDsSceneCanvas_dispose;return b}
function FDsSceneCanvas_onBuild(b){this.__base.FDsCanvas.onBuild.call(this,b);b=this._graphicContext;var f=RConsole.find(FE3dTemplateConsole),h=this._templateTranslation=f.allocByCode(b,"com.design.translation");h._optionFace=!0;h.hide();h=this._templateRotation=f.allocByCode(b,"com.design.rotation");h._optionFace=!0;h.hide();h=this._templateScale=f.allocByCode(b,"com.design.scale");h._optionFace=!0;h.hide()}
function FDsSceneCanvas_onMouseCaptureStart(b){var f=this._activeScene;if(f){var h=this._activeScene.region(),h=RConsole.find(FG3dTechniqueConsole).find(this._graphicContext,FG3dSelectTechnique).test(h,b.offsetX,b.offsetY);this.selectRenderable(h);this._capturePosition.set(b.clientX,b.clientY);this._captureRotation.assign(f.camera()._rotation);h&&(h=h.display(),this._captureMatrix.assign(h.matrix()));this._templateMatrix.identity();if(this._templateFace)for(this._templateFaceMatrix.assign(this._templateFace.matrix()),
b=this._selectRenderables,f=b.count()-1;0<=f;f--)h=b.getAt(f),h._dragMatrix||(h._dragMatrix=new SMatrix3d),h._dragMatrix.assign(h.matrix())}}
function FDsSceneCanvas_onMouseCapture(b){if(this._activeScene){var f=b.clientX-this._capturePosition.x,h=b.clientY-this._capturePosition.y,q=this._canvasMoveCd,u=this._templateFace;b=this._templateMatrix;switch(this._canvasModeCd){case EDsCanvasMode.Drop:var q=this._activeScene.camera().rotation(),z=this._captureRotation;q.x=z.x-h*this._cameraMouseRotation;q.y=z.y-f*this._cameraMouseRotation;break;case EDsCanvasMode.Translate:u&&(q==EDsCanvasDrag.X?b.tx=f/10:q==EDsCanvasDrag.Y?b.ty=-h/10:q==EDsCanvasDrag.Z&&
(b.tz=f/10));break;case EDsCanvasMode.Rotation:u&&(q==EDsCanvasDrag.X?b.rx=f/10:q==EDsCanvasDrag.Y?b.ry=-h/10:q==EDsCanvasDrag.Z&&(b.rz=f/10));break;case EDsCanvasMode.Scale:u&&(q==EDsCanvasDrag.X?b.sx=f/10:q==EDsCanvasDrag.Y?b.sy=-h/10:q==EDsCanvasDrag.Z?b.sz=f/10:q==EDsCanvasDrag.All&&(b.sx=f/10,b.sy=f/10,b.sz=f/10))}if(u)for(u.matrix().merge(this._templateFaceMatrix,b),f=this._selectRenderables,h=f.count()-1;0<=h;h--)q=f.getAt(h),q._matrix.merge(q._dragMatrix,b)}}
function FDsSceneCanvas_onMouseCaptureStop(b){}
function FDsSceneCanvas_onEnterFrame(){var b=this._activeScene;if(b){var f=b.camera(),h=this._cameraMoveRate,q=this._cameraKeyRotation,u=RKeyboard.isPress(EKeyCode.W),z=RKeyboard.isPress(EKeyCode.S);u&&!z&&f.doWalk(h);!u&&z&&f.doWalk(-h);u=RKeyboard.isPress(EKeyCode.A);z=RKeyboard.isPress(EKeyCode.D);u&&!z&&f.doYaw(q);!u&&z&&f.doYaw(-q);u=RKeyboard.isPress(EKeyCode.Q);z=RKeyboard.isPress(EKeyCode.E);u&&!z&&f.doFly(h);!u&&z&&f.doFly(-h);h=RKeyboard.isPress(EKeyCode.Z);u=RKeyboard.isPress(EKeyCode.X);
h&&!u&&f.doPitch(q);!h&&u&&f.doPitch(-q);f.update();if(this._optionRotation){q=this._rotation;b=b.layers();f=b.count();for(h=0;h<f;h++)u=b.value(h).matrix(),u.setRotation(0,q.y,0),u.update();q.y+=.01}}}
function FDsSceneCanvas_onSceneLoad(b){b=this._graphicContext;var f=this._activeScene,h=RClass.create(FDisplayUiLayer);h.selectTechnique(b,FG3dControlTechnique);h.pushDisplay(this._templateTranslation);h.pushDisplay(this._templateRotation);h.pushDisplay(this._templateScale);f.registerLayer("ui",h);this.processLoadListener(this)}
function FDsSceneCanvas_oeRefresh(b){var f=this._graphicContext;this.__base.FDsCanvas.oeRefresh.call(this,b);b=this._hParent.offsetWidth;var h=this._hParent.offsetHeight-6,q=this._hPanel;q.width=b;q.height=h;f.setViewport(0,0,b,h);return EEventStatus.Stop}
function FDsSceneCanvas_construct(){this.__base.FDsCanvas.construct.call(this);this._capturePosition=new SPoint2;this._captureMatrix=new SMatrix3d;this._templateMatrix=new SMatrix3d;this._templateFaceMatrix=new SMatrix3d;this._rotation=new SVector3;this._captureRotation=new SVector3;this._selectRenderables=new TObjects}
function FDsSceneCanvas_innerSelectDisplay(b){b=b.renderables();for(var f=b.count(),h=0;h<f;h++){var q=b.getAt(h);RClass.isClass(q,FDsSceneRenderable)&&(this._selectRenderables.push(q),q.showBoundBox())}}function FDsSceneCanvas_innerSelectLayer(b){b=b.displays();for(var f=b.count(),h=0;h<f;h++){var q=b.getAt(h);this.innerSelectDisplay(q)}}
function FDsSceneCanvas_selectNone(){this._selectObject=null;for(var b=this._selectRenderables,f=b.count(),h=0;h<f;h++)b.get(h).hideBoundBox();this._selectRenderables.clear()}function FDsSceneCanvas_selectLayers(b){this.selectNone();b=this._activeScene.layers();for(var f=b.count()-1;0<=f;f--)this.innerSelectLayer(b.valueAt(f))}function FDsSceneCanvas_selectLayer(b){this.selectNone();this._selectObject=b;this.innerSelectLayer(b)}
function FDsSceneCanvas_selectDisplay(b){this.selectNone();this._selectObject=b;this.innerSelectDisplay(b)}function FDsSceneCanvas_selectMaterial(b){this.selectNone();this._selectObject=b;for(var f=b._display.renderables(),h=f.count(),q=0;q<h;q++){var u=f.get(q);u._materialReference==b&&(this._selectRenderables.push(u),u._optionSelected=!0,u.showBoundBox())}}
function FDsSceneCanvas_selectRenderable(b){if(b)switch(b._renderable._resource._code){case "ms_translation_x":this._canvasMoveCd=EDsCanvasDrag.X;this._templateRenderable=b;return;case "ms_translation_y":this._canvasMoveCd=EDsCanvasDrag.Y;this._templateRenderable=b;return;case "ms_translation_z":this._canvasMoveCd=EDsCanvasDrag.Z;this._templateRenderable=b;return;case "ms_rotation_x":this._canvasMoveCd=EDsCanvasDrag.X;this._templateRenderable=b;return;case "ms_rotation_y":this._canvasMoveCd=EDsCanvasDrag.Y;
this._templateRenderable=b;return;case "ms_rotation_z":this._canvasMoveCd=EDsCanvasDrag.Z;this._templateRenderable=b;return;case "ms_scale_x":this._canvasMoveCd=EDsCanvasDrag.X;this._templateRenderable=b;return;case "ms_scale_y":this._canvasMoveCd=EDsCanvasDrag.Y;this._templateRenderable=b;return;case "ms_scale_z":this._canvasMoveCd=EDsCanvasDrag.Z;this._templateRenderable=b;return;case "ms_scale_all":this._canvasMoveCd=EDsCanvasDrag.All;this._templateRenderable=b;return;default:this._canvasMoveCd=
EDsCanvasDrag.Unknown,this._templateRenderable=null}this.selectNone();b&&(this._selectRenderables.push(b),b._optionSelected=!0,b.showBoundBox(),this._workspace._catalog.showObject(b));var f=this._templateTranslation,h=this._templateRotation,q=this._templateScale;switch(this._canvasModeCd){case EDsCanvasMode.Translate:f.setVisible(null!=b);h.hide();q.hide();this._templateFace=f;break;case EDsCanvasMode.Rotation:f.hide();h.setVisible(null!=b);q.hide();this._templateFace=h;break;case EDsCanvasMode.Scale:f.hide(),
h.hide(),q.setVisible(null!=b),this._templateFace=q}f=this._templateFace;b&&f&&(b=b.display(),f=f.matrix(),f.assign(b.matrix()),f.setScaleAll(this._templateViewScale),f.update())}function FDsSceneCanvas_switchMode(b){this._canvasModeCd=b;this.selectRenderable(this._selectRenderable)}function FDsSceneCanvas_switchPlay(b){for(var f=this._activeScene.allDisplays(),h=f.count(),q=0;q<h;q++){var u=f.get(q);u._movies&&(u._optionPlay=b)}}
function FDsSceneCanvas_switchMovie(b,f){for(var h=this._activeScene.allDisplays(),q=h.count(),u=0;u<q;u++){var z=h.get(u);z._movies&&(z._optionMovie=b)}}function FDsSceneCanvas_loadScene(b){var f=this._graphicContext,h=RConsole.find(FE3dSceneConsole);null!=this._activeScene&&h.free(this._activeScene);b=h.alloc(this._graphicContext,b);b.addLoadListener(this,this.onSceneLoad);b.selectTechnique(f,FG3dGeneralTechnique);this._stage=this._activeScene=b;RStage.register("stage3d",b)}
function FDsSceneCanvas_dispose(){var b=this._rotation;b&&(b.dispose(),this._rotation=null);this.__base.FDsCanvas.dispose.call(this)}
function FDsSceneCanvasToolBar(b){b=RClass.inherits(this,b,FUiToolBar);b._frameName="design3d.scene.CanvasToolBar";b._canvasModeCd=EDsCanvasMode.Drop;b._dropButton=null;b._selectButton=null;b._translateButton=null;b._rotationButton=null;b._scaleButton=null;b._lookFrontButton=null;b._lookUpButton=null;b._lookLeftButton=null;b._playButton=null;b._viewButton=null;b.onBuilded=FDsSceneCanvasToolBar_onBuilded;b.onModeClick=FDsSceneCanvasToolBar_onModeClick;b.onLookClick=FDsSceneCanvasToolBar_onLookClick;
b.onPlayClick=FDsSceneCanvasToolBar_onPlayClick;b.onRotationClick=FDsSceneCanvasToolBar_onRotationClick;b.construct=FDsSceneCanvasToolBar_construct;b.dispose=FDsSceneCanvasToolBar_dispose;return b}
function FDsSceneCanvasToolBar_onBuilded(b){this.__base.FUiToolBar.onBuilded.call(this,b);b=this._dropButton=this.searchControl("dropButton");b._canvasModeCd=EDsCanvasMode.Drop;b.addClickListener(this,this.onModeClick);b.check(!0);b=this._selectButton=this.searchControl("selectButton");b._canvasModeCd=EDsCanvasMode.Select;b.addClickListener(this,this.onModeClick);b=this._translateButton=this.searchControl("translateButton");b._canvasModeCd=EDsCanvasMode.Translate;b.addClickListener(this,this.onModeClick);
b=this._rotationButton=this.searchControl("rotationButton");b._canvasModeCd=EDsCanvasMode.Rotation;b.addClickListener(this,this.onModeClick);b=this._scaleButton=this.searchControl("scaleButton");b._canvasModeCd=EDsCanvasMode.Scale;b.addClickListener(this,this.onModeClick);b=this._lookFrontButton=this.searchControl("lookFrontButton");b.addClickListener(this,this.onLookClick);b=this._lookUpButton=this.searchControl("lookUpButton");b.addClickListener(this,this.onLookClick);b=this._lookLeftButton=this.searchControl("lookLeftButton");
b.addClickListener(this,this.onLookClick);b=this._playButton=this.searchControl("playButton");b.addClickListener(this,this.onPlayClick);b=this._viewButton=this.searchControl("viewButton");b.addClickListener(this,this.onRotationClick)}function FDsSceneCanvasToolBar_onModeClick(b){this._canvasModeCd=b._canvasModeCd;this._workspace._canvas.switchMode(b._canvasModeCd)}function FDsSceneCanvasToolBar_onLookClick(b){this._canvasModeCd=b._canvasModeCd}
function FDsSceneCanvasToolBar_onPlayClick(b,f){this._workspace._canvas.switchPlay(f)}function FDsSceneCanvasToolBar_onRotationClick(b,f){this._workspace._canvas.switchMovie(f)}function FDsSceneCanvasToolBar_construct(){this.__base.FUiToolBar.construct.call(this)}function FDsSceneCanvasToolBar_dispose(){this.__base.FUiToolBar.dispose.call(this)}
function FDsSceneCatalog(b){b=RClass.inherits(this,b,FUiDataTreeView,MListenerSelected);b._iconView="design3d.scene.view";b._iconViewNot="design3d.scene.viewno";b._displays=null;b._renderables=null;b._materials=null;b.onBuild=FDsSceneCatalog_onBuild;b.onLoadDisplay=FDsSceneCatalog_onLoadDisplay;b.onNodeClick=FDsSceneCatalog_onNodeClick;b.onNodeViewClick=FDsSceneCatalog_onNodeViewClick;b.onNodeViewDoubleClick=FDsSceneCatalog_onNodeViewDoubleClick;b.lsnsSelect=null;b.construct=FDsSceneCatalog_construct;
b.buildNodeView=FDsSceneCatalog_buildNodeView;b.buildTechnique=FDsSceneCatalog_buildTechnique;b.buildRegion=FDsSceneCatalog_buildRegion;b.buildRenderable=FDsSceneCatalog_buildRenderable;b.buildDisplay=FDsSceneCatalog_buildDisplay;b.buildLayer=FDsSceneCatalog_buildLayer;b.buildScene=FDsSceneCatalog_buildScene;b.selectObject=FDsSceneCatalog_selectObject;b.showObject=FDsSceneCatalog_showObject;b.dispose=FDsSceneCatalog_dispose;return b}
function FDsSceneCatalog_onBuild(b){var f=RClass.create(FUiTreeColumn);f.setName("view");this.push(f);this.__base.FUiDataTreeView.onBuild.call(this,b);this.lsnsClick.register(this,this.onNodeClick);this.loadUrl("/cloud.describe.tree.ws?action=query&code=design3d.scene")}function FDsSceneCatalog_onLoadDisplay(b){this.buildRenderable(b._linkNode,b)}function FDsSceneCatalog_onNodeClick(b,f){var h=f.dataPropertyGet("linker");this.selectObject(h)}
function FDsSceneCatalog_onNodeViewClick(b){var f=b.treeNodeCell,h=b.treeNode.dataPropertyGet("linker");if(RClass.isClass(h,FDisplay))if(b.ctrlKey){for(var q=this._displays,u=q.count()-1;0<=u;u--){var z=q.get(u);z.dataPropertyGet("linker")._visible=!1;z.cell("view").setIcon(this._iconViewNot)}h._visible=!0;f.setIcon(this._iconView)}else h._visible=!h._visible,f.setIcon(h._visible?this._iconView:this._iconViewNot);if(RClass.isClass(h,FDrawable))if(b.ctrlKey){q=this._renderables;for(u=q.count()-1;0<=
u;u--)z=q.get(u),z.dataPropertyGet("linker")._visible=!1,z.cell("view").setIcon(this._iconViewNot);h._visible=!0;f.setIcon(this._iconView)}else h._visible=!h._visible,f.setIcon(h._visible?this._iconView:this._iconViewNot);if(RClass.isClass(h,FG3dMaterial))if(b.ctrlKey){b=this._materials;for(u=b.count()-1;0<=u;u--)q=b.get(u),q.dataPropertyGet("linker")._visible=!1,q.cell("view").setIcon(this._iconViewNot);h._visible=!0;f.setIcon(this._iconView)}else h._visible=!h._visible,f.setIcon(h._visible?this._iconView:
this._iconViewNot)}
function FDsSceneCatalog_onNodeViewDoubleClick(b){b=b.treeNode;var f=b.dataPropertyGet("linker");if(RClass.isClass(f,FDisplay))for(var f=this._displays,h=f.count()-1;0<=h;h--)b=f.get(h),b.dataPropertyGet("linker")._visible=!0,b.cell("view").setIcon(this._iconView);if(RClass.isClass(f,FDrawable))for(f=this._renderables,h=f.count()-1;0<=h;h--)b=f.get(h),b.dataPropertyGet("linker")._visible=!0,b.cell("view").setIcon(this._iconView);if(RClass.isClass(f,FG3dMaterial))for(f=this._materials,h=f.count()-
1;0<=h;h--)b=f.get(h),b.dataPropertyGet("linker")._visible=!0,b.cell("view").setIcon(this._iconView)}function FDsSceneCatalog_construct(){this.__base.FUiDataTreeView.construct.call(this);this._displays=new TObjects;this._renderables=new TObjects;this._materials=new TObjects}function FDsSceneCatalog_buildNodeView(b,f){var h=b.cell("view");h.setIcon(this._iconView);h.addClickListener(this,this.onNodeViewClick);h.addDoubleClickListener(this,this.onNodeViewDoubleClick)}
function FDsSceneCatalog_buildTechnique(b,f){var h=this.createNode();h.setLabel("Technique");h.setTypeName("technique");h.dataPropertySet("linker",f);b.appendNode(h)}
function FDsSceneCatalog_buildRegion(b,f){var h=this.createNode();h.setLabel("Region");h.setTypeName("region");h.dataPropertySet("linker",f);b.appendNode(h);var q=this.createNode();q.setLabel("Camera");q.setTypeName("camera");q.dataPropertySet("linker",f.camera());h.appendNode(q);q=this.createNode();q.setLabel("Light");q.setTypeName("light");q.dataPropertySet("linker",f.directionalLight());h.appendNode(q)}
function FDsSceneCatalog_buildRenderable(b,f){var h=f.materials();if(h)for(var q=h.count(),u=0;u<q;u++){var z=h.value(u),A=z.resource(),B=this.createNode();B.setLabel(A.code());B.setNote(A.label());B.setTypeName("material");B.dataPropertySet("linker",z);this.buildNodeView(B,!0);this._materials.push(B);b.appendNode(B)}if(h=f.meshRenderables())for(q=h.count(),u=0;u<q;u++)z=h.get(u),B=z.resource(),B.model(),A=B.mesh(),B=this.createNode(),B.setLabel(A.code()),B.setTypeName("renderable"),B.dataPropertySet("linker",
z),this.buildNodeView(B,!0),this._renderables.push(B),b.appendNode(B)}function FDsSceneCatalog_buildDisplay(b,f){var h=f.displays();if(h)for(var q=h.count(),u=0;u<q;u++){var z=h.get(u),A=z.resourceScene(),B=this.createNode();B.setLabel(A.code());B.setNote(A.label());B.setTypeName("display");B.dataPropertySet("linker",z);this.buildNodeView(B,!0);this._displays.push(B);b.appendNode(B);z.addLoadListener(this,this.onLoadDisplay);z._linkNode=B}}
function FDsSceneCatalog_buildLayer(b,f){var h=this.createNode();h.setLabel("Layers");h.setTypeName("layers");h.dataPropertySet("linker","layers");this.buildNodeView(h,!0);b.appendNode(h);for(var q=f.layers(),u=q.count(),z=0;z<u;z++){var A=q.value(z);if(!RClass.isClass(A,FDisplayUiLayer)){var B=A.resource(),C=this.createNode();C.setLabel("Layer:"+B.code());C.setTypeName("layer");C.dataPropertySet("linker",A);this.buildNodeView(C,!0);h.appendNode(C);this.buildDisplay(C,A)}}}
function FDsSceneCatalog_buildScene(b){var f=b._resource,h=this.createNode();h.setLabel(f.code());h.setNote(f.label());h.setTypeName("scene");h.dataPropertySet("linker",b);this.appendNode(h);this.buildTechnique(h,b.technique());this.buildRegion(h,b.region());this.buildLayer(h,b);h.click()}function FDsSceneCatalog_selectObject(b){null!=b&&this.processSelectedListener(b,!0)}
function FDsSceneCatalog_showObject(b){if(RClass.isClass(b,FDsSceneRenderable))for(var f=this._renderables,h=f.count(),q=0;q<h;q++)f.getAt(q).dataPropertyGet("linker")==b&&this.processSelectedListener(b,!1)}function FDsSceneCatalog_dispose(){this._displays=RObject.dispose(this._displays);this._renderables=RObject.dispose(this._renderables);this._materials=RObject.dispose(this._materials);this.__base.FUiDataTreeView.dispose.call(this)}
function FDsSceneDisplay(b){return b=RClass.inherits(this,b,FE3dSceneDisplay)}function FDsSceneDisplayFrame(b){b=RClass.inherits(this,b,FUiForm);b._activeScene=null;b._activeDisplay=null;b.onBuilded=FDsSceneDisplayFrame_onBuilded;b.onDataChanged=FDsSceneDisplayFrame_onDataChanged;b.construct=FDsSceneDisplayFrame_construct;b.loadObject=FDsSceneDisplayFrame_loadObject;b.dispose=FDsSceneDisplayFrame_dispose;return b}
function FDsSceneDisplayFrame_onBuilded(b){this.__base.FUiForm.onBuilded.call(this,b);this._controlTranslate.addDataChangedListener(this,this.onDataChanged);this._controlRotation.addDataChangedListener(this,this.onDataChanged);this._controlScale.addDataChangedListener(this,this.onDataChanged)}
function FDsSceneDisplayFrame_onDataChanged(b){b=this._activeDisplay;var f=this._activeResource.matrix(),h=this._controlTranslate.get();f.setTranslate(h.x,h.y,h.z);h=this._controlRotation.get();f.setRotation(h.x,h.y,h.z);h=this._controlScale.get();f.setScale(h.x,h.y,h.z);f.update();b.matrix().assign(f)}function FDsSceneDisplayFrame_construct(){this.__base.FUiForm.construct.call(this)}
function FDsSceneDisplayFrame_loadObject(b,f){this._activeScene=b;this._activeDisplay=f;this._activeResource=f.resourceScene();var h=this._activeResource.matrix();this._controlTranslate.set(h.tx,h.ty,h.tz);this._controlRotation.set(h.rx,h.ry,h.rz);this._controlScale.set(h.sx,h.sy,h.sz)}function FDsSceneDisplayFrame_dispose(){this.__base.FUiForm.dispose.call(this)}
function FDsSceneDisplayPropertyFrame(b){b=RClass.inherits(this,b,FUiForm);b._visible=!1;b._workspace=null;b._activeDisplay=null;b._activeResource=null;b._controlGuid=null;b._controlCode=null;b._controlLabel=null;b._displayFrame=null;b._materialFrame=null;b.onBuilded=FDsSceneDisplayPropertyFrame_onBuilded;b.onDataChanged=FDsSceneDisplayPropertyFrame_onDataChanged;b.construct=FDsSceneDisplayPropertyFrame_construct;b.loadObject=FDsSceneDisplayPropertyFrame_loadObject;b.dispose=FDsSceneDisplayPropertyFrame_dispose;
return b}function FDsSceneDisplayPropertyFrame_onBuilded(b){this.__base.FUiForm.onBuilded.call(this,b);this._controlCode.addDataChangedListener(this,this.onDataChanged);this._controlLabel.addDataChangedListener(this,this.onDataChanged)}function FDsSceneDisplayPropertyFrame_onDataChanged(b){b=this._activeResource;b._code=this._controlCode.get();b._label=this._controlLabel.get()}function FDsSceneDisplayPropertyFrame_construct(){this.__base.FUiForm.construct.call(this)}
function FDsSceneDisplayPropertyFrame_loadObject(b,f){this._activeDisplay=f;b.resource();var h=this._activeResource=f.resourceScene();this._controlGuid.set(h.guid());this._controlCode.set(h.code());this._controlLabel.set(h.label());this._frameDisplay.loadObject(b,f)}function FDsSceneDisplayPropertyFrame_dispose(){this.__base.FUiForm.dispose.call(this)}function FDsSceneLayer(b){return b=RClass.inherits(this,b,FE3dSceneLayer)}
function FDsSceneLayerPropertyFrame(b){b=RClass.inherits(this,b,FUiForm);b._visible=!1;b._workspace=null;b._layer=null;b._controlGuid=null;b._controlCode=null;b._controlLabel=null;b.construct=FDsSceneLayerPropertyFrame_construct;b.loadObject=FDsSceneLayerPropertyFrame_loadObject;b.dispose=FDsSceneLayerPropertyFrame_dispose;return b}function FDsSceneLayerPropertyFrame_construct(){this.__base.FUiForm.construct.call(this)}
function FDsSceneLayerPropertyFrame_loadObject(b,f){var h=f.resource();this._layer=f;this._controlGuid.set(h.guid());this._controlCode.set(h.code());this._controlLabel.set(h._label)}function FDsSceneLayerPropertyFrame_dispose(){this.__base.FUiForm.dispose.call(this)}
function FDsSceneLightPropertyFrame(b){b=RClass.inherits(this,b,FUiForm);b._visible=!1;b._workspace=null;b._light=null;b._controlGuid=null;b._controlCode=null;b._controlLabel=null;b.construct=FDsSceneLightPropertyFrame_construct;b.loadObject=FDsSceneLightPropertyFrame_loadObject;b.dispose=FDsSceneLightPropertyFrame_dispose;return b}function FDsSceneLightPropertyFrame_construct(){this.__base.FUiForm.construct.call(this)}
function FDsSceneLightPropertyFrame_loadObject(b,f){var h=f._resource;h.material();var q=h.camera();this._light=f;this._controlGuid.set(h.guid());this._controlCode.set(h.code());this._controlLabel.set(h._label);this._frameCamera.loadObject(b,q)}function FDsSceneLightPropertyFrame_dispose(){this.__base.FUiForm.dispose.call(this)}
function FDsSceneMaterial1Frame(b){b=RClass.inherits(this,b,FUiForm);b._scene=null;b._material=null;b._controlOptionDouble=null;b._controlEffectCode=null;b._controlOptionAlpha=null;b._controlAlphaBase=null;b._controlAlphaRate=null;b._controlOptionColor=null;b._controlColorMin=null;b._controlColorMax=null;b._controlColorRate=null;b._controlColorMerge=null;b._controlOptionAmbient=null;b._controlAmbientColor=null;b._controlOptionDiffuse=null;b._controlDiffuseColor=null;b._controlOptionSpecular=null;
b._controlSpecularColor=null;b._controlSpecularBase=null;b._controlSpecularLevel=null;b._controlOptionReflect=null;b._controlReflectColor=null;b._controlReflectMerge=null;b._controlOptionEmissive=null;b._controlEmissiveColor=null;b.onBuilded=FDsSceneMaterial1Frame_onBuilded;b.onDataChanged=FDsSceneMaterial1Frame_onDataChanged;b.construct=FDsSceneMaterial1Frame_construct;b.loadObject=FDsSceneMaterial1Frame_loadObject;b.dispose=FDsSceneMaterial1Frame_dispose;return b}
function FDsSceneMaterial1Frame_onBuilded(b){this.__base.FUiForm.onBuilded.call(this,b);this._controlOptionDouble.addDataChangedListener(this,this.onDataChanged);this._controlEffectCode.addDataChangedListener(this,this.onDataChanged);this._controlOptionAlpha.addDataChangedListener(this,this.onDataChanged);this._controlAlphaBase.addDataChangedListener(this,this.onDataChanged);this._controlAlphaRate.addDataChangedListener(this,this.onDataChanged);this._controlOptionColor.addDataChangedListener(this,
this.onDataChanged);this._controlColorMin.addDataChangedListener(this,this.onDataChanged);this._controlColorMax.addDataChangedListener(this,this.onDataChanged);this._controlColorRate.addDataChangedListener(this,this.onDataChanged);this._controlColorMerge.addDataChangedListener(this,this.onDataChanged);this._controlOptionAmbient.addDataChangedListener(this,this.onDataChanged);this._controlAmbientColor.addDataChangedListener(this,this.onDataChanged);this._controlOptionDiffuse.addDataChangedListener(this,
this.onDataChanged);this._controlDiffuseColor.addDataChangedListener(this,this.onDataChanged);this._controlOptionSpecular.addDataChangedListener(this,this.onDataChanged);this._controlSpecularColor.addDataChangedListener(this,this.onDataChanged);this._controlSpecularBase.addDataChangedListener(this,this.onDataChanged);this._controlSpecularLevel.addDataChangedListener(this,this.onDataChanged);this._controlOptionReflect.addDataChangedListener(this,this.onDataChanged);this._controlReflectColor.addDataChangedListener(this,
this.onDataChanged);this._controlReflectMerge.addDataChangedListener(this,this.onDataChanged);this._controlOptionEmissive.addDataChangedListener(this,this.onDataChanged);this._controlEmissiveColor.addDataChangedListener(this,this.onDataChanged)}
function FDsSceneMaterial1Frame_onDataChanged(b){b=this._material;var f=b.resource().info();f.optionDouble=this._controlOptionDouble.get();f.effectCode=this._controlEffectCode.get();f.optionAlpha=this._controlOptionAlpha.get();f.alphaBase=this._controlAlphaBase.get();f.alphaRate=this._controlAlphaRate.get();f.optionColor=this._controlOptionAmbient.get();f.colorMin=this._controlColorMin.get();f.colorMax=this._controlColorMax.get();f.colorRate=this._controlColorRate.get();f.colorMerge=this._controlColorMerge.get();
f.optionAmbient=this._controlOptionAmbient.get();f.ambientColor.assign(this._controlAmbientColor.get());f.optionDiffuse=this._controlOptionDiffuse.get();f.diffuseColor.assign(this._controlDiffuseColor.get());f.optionSpecular=this._controlOptionSpecular.get();f.specularColor.assign(this._controlSpecularColor.get());f.specularBase=this._controlSpecularBase.get();f.specularLevel=this._controlSpecularLevel.get();f.optionReflect=this._controlOptionReflect.get();f.reflectColor.assign(this._controlReflectColor.get());
f.reflectMerge=this._controlReflectMerge.get();f.optionEmissive=this._controlOptionEmissive.get();f.emissiveColor.assign(this._controlEmissiveColor.get());b.reload();b._display.reloadResource()}function FDsSceneMaterial1Frame_construct(){this.__base.FUiForm.construct.call(this)}
function FDsSceneMaterial1Frame_loadObject(b,f){this._scene=b;this._material=f;var h=f.resource().info();this._controlOptionDouble.set(h.optionDouble);this._controlEffectCode.set(h.effectCode);this._controlOptionAlpha.set(h.optionAlpha);this._controlAlphaBase.set(h.alphaBase);this._controlAlphaRate.set(h.alphaRate);this._controlOptionColor.set(h.optionColor);this._controlColorMin.set(h.colorMin);this._controlColorMax.set(h.colorMax);this._controlColorRate.set(h.colorRate);this._controlColorMerge.set(h.colorMerge);
this._controlOptionAmbient.set(h.optionAmbient);this._controlAmbientColor.set(h.ambientColor);this._controlOptionDiffuse.set(h.optionDiffuse);this._controlDiffuseColor.set(h.diffuseColor);this._controlOptionSpecular.set(h.optionSpecular);this._controlSpecularColor.set(h.specularColor);this._controlSpecularBase.set(h.specularBase);this._controlSpecularLevel.set(h.specularLevel);this._controlOptionReflect.set(h.optionReflect);this._controlReflectColor.set(h.reflectColor);this._controlReflectMerge.set(h.reflectMerge);
this._controlOptionEmissive.set(h.optionEmissive);this._controlEmissiveColor.set(h.emissiveColor)}function FDsSceneMaterial1Frame_dispose(){this.__base.FUiForm.dispose.call(this)}
function FDsSceneMaterial2Frame(b){b=RClass.inherits(this,b,FUiForm);b._scene=null;b._material=null;b._controlDiffuseViewColor=null;b._controlSpecularViewColor=null;b._controlSpecularViewBase=null;b._controlSpecularViewLevel=null;b.onBuilded=FDsSceneMaterial2Frame_onBuilded;b.onDataChanged=FDsSceneMaterial2Frame_onDataChanged;b.construct=FDsSceneMaterial2Frame_construct;b.loadObject=FDsSceneMaterial2Frame_loadObject;b.dispose=FDsSceneMaterial2Frame_dispose;return b}
function FDsSceneMaterial2Frame_onBuilded(b){this.__base.FUiForm.onBuilded.call(this,b);this._controlOptionView.addDataChangedListener(this,this.onDataChanged);this._controlOptionNormalInvert.addDataChangedListener(this,this.onDataChanged);this._controlOptionShadow.addDataChangedListener(this,this.onDataChanged);this._controlOptionShadowSelf.addDataChangedListener(this,this.onDataChanged);this._controlDiffuseViewColor.addDataChangedListener(this,this.onDataChanged);this._controlSpecularViewColor.addDataChangedListener(this,
this.onDataChanged);this._controlSpecularViewBase.addDataChangedListener(this,this.onDataChanged);this._controlSpecularViewLevel.addDataChangedListener(this,this.onDataChanged)}
function FDsSceneMaterial2Frame_onDataChanged(b){b=this._material;var f=b.resource().info();f.optionView=this._controlOptionView.get();f.optionNormalInvert=this._controlOptionNormalInvert.get();f.optionShadow=this._controlOptionShadow.get();f.optionShadowSelf=this._controlOptionShadowSelf.get();var h=this._controlDiffuseViewColor.get();f.diffuseViewColor.assign(h);h=this._controlSpecularViewColor.get();f.specularViewColor.assign(h);f.specularViewBase=this._controlSpecularViewBase.get();f.specularViewLevel=
this._controlSpecularViewLevel.get();b.reload();b._display.reloadResource()}function FDsSceneMaterial2Frame_construct(){this.__base.FUiForm.construct.call(this)}
function FDsSceneMaterial2Frame_loadObject(b,f){this._scene=b;this._material=f;var h=f.resource().info();this._controlOptionView.set(h.optionView);this._controlOptionNormalInvert.set(h.optionNormalInvert);this._controlOptionShadow.set(h.optionShadow);this._controlOptionShadowSelf.set(h.optionShadowSelf);this._controlDiffuseViewColor.set(h.diffuseViewColor);this._controlSpecularViewColor.set(h.specularViewColor);this._controlSpecularViewBase.set(h.specularViewBase);this._controlSpecularViewLevel.set(h.specularViewLevel)}
function FDsSceneMaterial2Frame_dispose(){this.__base.FUiForm.dispose.call(this)}
function FDsSceneMaterialPropertyFrame(b){b=RClass.inherits(this,b,FUiForm);b._visible=!1;b._workspace=null;b._material=null;b._controlGuid=null;b._controlCode=null;b._controlLabel=null;b._frameMaterial1=null;b._frameMaterial2=null;b.onBuilded=FDsSceneMaterialPropertyFrame_onBuilded;b.onDataChanged=FDsSceneMaterialPropertyFrame_onDataChanged;b.construct=FDsSceneMaterialPropertyFrame_construct;b.loadObject=FDsSceneMaterialPropertyFrame_loadObject;b.dispose=FDsSceneMaterialPropertyFrame_dispose;return b}
function FDsSceneMaterialPropertyFrame_onBuilded(b){this.__base.FUiForm.onBuilded.call(this,b);this._controlLabel.addDataChangedListener(this,this.onDataChanged)}function FDsSceneMaterialPropertyFrame_onDataChanged(b){this._material.resource().setLabel(this._controlLabel.get())}function FDsSceneMaterialPropertyFrame_construct(){this.__base.FUiForm.construct.call(this)}
function FDsSceneMaterialPropertyFrame_loadObject(b,f){var h=f.resource();this._material=f;this._controlGuid.set(h.guid());this._controlCode.set(h.code());this._controlLabel.set(h.label());this._frameMaterial1.loadObject(b,f);this._frameMaterial2.loadObject(b,f)}function FDsSceneMaterialPropertyFrame_dispose(){this.__base.FUiForm.dispose.call(this)}
function FDsSceneMenuBar(b){b=RClass.inherits(this,b,FUiMenuBar);b._frameName="design3d.scene.MenuBar";b._refreshButton=null;b._saveButton=null;b._runButton=null;b.onBuilded=FDsSceneMenuBar_onBuilded;b.onRefreshClick=FDsSceneMenuBar_onRefreshClick;b.onSaveClick=FDsSceneMenuBar_onSaveClick;b.onRunClick=FDsSceneMenuBar_onRunClick;b.construct=FDsSceneMenuBar_construct;b.dispose=FDsSceneMenuBar_dispose;return b}
function FDsSceneMenuBar_onBuilded(b){this.__base.FUiMenuBar.onBuilded.call(this,b);this._refreshButton.addClickListener(this,this.onRefreshClick);this._saveButton.addClickListener(this,this.onSaveClick);this._runButton.addClickListener(this,this.onRunClick)}function FDsSceneMenuBar_onRefreshClick(b){}function FDsSceneMenuBar_onSaveClick(b){b=this._workspace._activeScene._resource;var f=new TXmlNode;b.saveConfig(f);RConsole.find(FE3sSceneConsole).update(f)}
function FDsSceneMenuBar_onRunClick(b){window.location="../design/view.html?code="+this._workspace._sceneCode}function FDsSceneMenuBar_construct(){this.__base.FUiMenuBar.construct.call(this)}function FDsSceneMenuBar_dispose(){this.__base.FUiMenuBar.dispose.call(this)}
function FDsScenePropertyFrame(b){b=RClass.inherits(this,b,FUiForm);b._visible=!1;b._frameName="design3d.scene.property.SceneFrame";b._workspace=null;b._renderTemplate=null;b._controlGuid=null;b._controlCode=null;b._controlLabel=null;b.onBuilded=FDsScenePropertyFrame_onBuilded;b.construct=FDsScenePropertyFrame_construct;b.loadObject=FDsScenePropertyFrame_loadObject;b.dispose=FDsScenePropertyFrame_dispose;return b}
function FDsScenePropertyFrame_onBuilded(b){this.__base.FUiForm.onBuilded.call(this,b);this._controlGuid=this.searchControl("guid");this._controlCode=this.searchControl("code");this._controlLabel=this.searchControl("label")}function FDsScenePropertyFrame_construct(){this.__base.FUiForm.construct.call(this)}function FDsScenePropertyFrame_loadObject(b){var f=b._resource;this._renderTemplate=b;this._controlGuid.set(f.guid());this._controlCode.set(f.code());this._controlLabel.set(f._label)}
function FDsScenePropertyFrame_dispose(){this.__base.FUiForm.dispose.call(this)}
function FDsSceneRegionPropertyFrame(b){b=RClass.inherits(this,b,FUiForm);b._visible=!1;b._workspace=null;b._scene=null;b._region=null;b._regionResource=null;b._controlOptionBackground=null;b._controlBackgroundColor=null;b.onBuilded=FDsSceneRegionPropertyFrame_onBuilded;b.onDataChanged=FDsSceneRegionPropertyFrame_onDataChanged;b.construct=FDsSceneRegionPropertyFrame_construct;b.loadObject=FDsSceneRegionPropertyFrame_loadObject;b.dispose=FDsSceneRegionPropertyFrame_dispose;return b}
function FDsSceneRegionPropertyFrame_onBuilded(b){this.__base.FUiForm.onBuilded.call(this,b);this._controlOptionBackground.addDataChangedListener(this,this.onDataChanged);this._controlBackgroundColor.addDataChangedListener(this,this.onDataChanged)}function FDsSceneRegionPropertyFrame_onDataChanged(b){b=this._regionResource;b.setOptionBackground(this._controlOptionBackground.get());b.backgroundColor().assign(this._controlBackgroundColor.get());this._region.reloadResource()}
function FDsSceneRegionPropertyFrame_construct(){this.__base.FUiForm.construct.call(this)}function FDsSceneRegionPropertyFrame_loadObject(b,f){this._scene=b;this._region=f;var h=this._regionResource=f._resource;this._controlOptionBackground.set(h.optionBackground());this._controlBackgroundColor.set(h.backgroundColor())}function FDsSceneRegionPropertyFrame_dispose(){this.__base.FUiForm.dispose.call(this)}
function FDsSceneRenderable(b){b=RClass.inherits(this,b,FE3dSceneDisplayRenderable,MDsBoundBox);b._optionSelected=!1;return b}
function FDsSceneRenderableFrame(b){b=RClass.inherits(this,b,FUiForm);b._activeScene=null;b._activeRenderable=null;b.onBuilded=FDsSceneRenderableFrame_onBuilded;b.onDataChanged=FDsSceneRenderableFrame_onDataChanged;b.onEffectClick=FDsSceneRenderableFrame_onEffectClick;b.construct=FDsSceneRenderableFrame_construct;b.loadObject=FDsSceneRenderableFrame_loadObject;b.dispose=FDsSceneRenderableFrame_dispose;return b}
function FDsSceneRenderableFrame_onBuilded(b){this.__base.FUiForm.onBuilded.call(this,b);this._controlTranslate.addDataChangedListener(this,this.onDataChanged);this._controlRotation.addDataChangedListener(this,this.onDataChanged);this._controlScale.addDataChangedListener(this,this.onDataChanged);this._controlEffects.addClickListener(this,this.onEffectClick)}
function FDsSceneRenderableFrame_onDataChanged(b){b=this._activeRenderable.matrix();var f=this._controlTranslate.get();b.setTranslate(f.x,f.y,f.z);f=this._controlRotation.get();b.setRotation(f.x,f.y,f.z);f=this._controlScale.get();b.setScale(f.x,f.y,f.z);b.update()}function FDsSceneRenderableFrame_onEffectClick(b,f){var h=f.tag()._program,q=h._vertexShader;alert(q._source);q=h._fragmentShader;alert(q._source)}function FDsSceneRenderableFrame_construct(){this.__base.FUiForm.construct.call(this)}
function FDsSceneRenderableFrame_loadObject(b,f){this._activeScene=b;this._activeRenderable=f;var h=f.matrix();this._controlTranslate.set(h.tx,h.ty,h.tz);this._controlRotation.set(h.rx,h.ry,h.rz);this._controlScale.set(h.sx,h.sy,h.sz);h=this._controlEffects;h.clear();for(var q=f.infos(),u=q.count(),z=0;z<u;z++){var A=q.value(z).effect;if(A){var B=h.createItem(null,A.code());B.setTag(A);h.push(B)}}}function FDsSceneRenderableFrame_dispose(){this.__base.FUiForm.dispose.call(this)}
function FDsSceneRenderablePropertyFrame(b){b=RClass.inherits(this,b,FUiForm);b._visible=!1;b._workspace=null;b._activeRenderable=null;b._activeMaterial=null;b._controlGuid=null;b._controlCode=null;b._controlLabel=null;b._frameRenderable=null;b._frameMaterial1=null;b._frameMaterial2=null;b.construct=FDsSceneRenderablePropertyFrame_construct;b.loadObject=FDsSceneRenderablePropertyFrame_loadObject;b.dispose=FDsSceneRenderablePropertyFrame_dispose;return b}
function FDsSceneRenderablePropertyFrame_construct(){this.__base.FUiForm.construct.call(this)}function FDsSceneRenderablePropertyFrame_loadObject(b,f){var h=f.materialReference();b=f.renderable().resource();this._activeRenderable=f;this._activeMaterial=h;this._controlGuid.set(b.guid());this._controlCode.set(b.code());this._controlLabel.set(b.label());this._frameRenderable.loadObject(b,f);this._frameMaterial1.loadObject(b,h);this._frameMaterial2.loadObject(b,h)}
function FDsSceneRenderablePropertyFrame_dispose(){this.__base.FUiForm.dispose.call(this)}
function FDsSceneTechniquePropertyFrame(b){b=RClass.inherits(this,b,FUiForm);b._visible=!1;b._thread=null;b._interval=2E3;b._workspace=null;b._scene=null;b._technique=null;b._techniqueResource=null;b._controlGuid=null;b._controlCode=null;b._controlLabel=null;b._controlTriangleCount=null;b._controlDrawCount=null;b.onBuilded=FDsSceneTechniquePropertyFrame_onBuilded;b.onDataChanged=FDsSceneTechniquePropertyFrame_onDataChanged;b.onModeClick=FDsSceneTechniquePropertyFrame_onModeClick;b.onRefresh=FDsSceneTechniquePropertyFrame_onRefresh;
b.construct=FDsSceneTechniquePropertyFrame_construct;b.loadObject=FDsSceneTechniquePropertyFrame_loadObject;b.dispose=FDsSceneTechniquePropertyFrame_dispose;return b}
function FDsSceneTechniquePropertyFrame_onBuilded(b){this.__base.FUiForm.onBuilded.call(this,b);this._controlCode.addDataChangedListener(this,this.onDataChanged);this._controlLabel.addDataChangedListener(this,this.onDataChanged);this._controlTechniqueCode.addDataChangedListener(this,this.onDataChanged);this._controlRenderModes.addClickListener(this,this.onModeClick)}
function FDsSceneTechniquePropertyFrame_onDataChanged(b){b=this._technique;b._code=this._controlCode.get();b._label=this._controlLabel.get();b._techniqueCode=this._controlTechniqueCode.get()}function FDsSceneTechniquePropertyFrame_onModeClick(b,f){var h=f.tag();this._technique._activeMode=h;this._scene.dirty()}
function FDsSceneTechniquePropertyFrame_onRefresh(){if(this._statusVisible){var b=this._scene,f=b.statistics(),b=b._graphicContext.statistics();this._controlFrameTick.set(f._frame.toString());this._controlProcessTick.set(f._frameProcess.toString()+" | "+f._frameDrawRenderable.toString());this._controlDrawTick.set(f._frameDraw.toString()+" | "+f._frameDrawSort.toString());this._controlClearCount.set(b._frameClearCount);this._controlModeInfo.set("FIL:"+b._frameFillModeCount+" | DEP:"+b._frameDepthModeCount+
" | CUL:"+b._frameCullModeCount+" | BLD:"+b._frameBlendModeCount);this._controlProgramCount.set(b._frameProgramCount);this._controlConstInfo.set(b._frameConstCount+" : length="+b._frameConstLength);this._controlBufferCount.set(b._frameBufferCount);this._controlTextureCount.set(b._frameTextureCount);this._controlTargetCount.set(b._frameTargetCount);this._controlDrawInfo.set(b._frameDrawCount+" : triangle="+b._frameTriangleCount);this._controlProgramTotal.set(b._programTotal);this._controlLayoutTotal.set(b._layoutTotal);
this._controlBufferInfo.set("Vertex:"+b._vertexBufferTotal+" Index:"+b._indexBufferTotal);this._controlTextureInfo.set("Flat:"+b._flatTextureTotal+" Cube:"+b._cubeTextureTotal);this._controlTargetTotal.set(b._targetTotal)}}function FDsSceneTechniquePropertyFrame_construct(){this.__base.FUiForm.construct.call(this);var b=this._thread=RClass.create(FThread);b.setInterval(this._interval);b.addProcessListener(this,this.onRefresh);RConsole.find(FThreadConsole).start(b)}
function FDsSceneTechniquePropertyFrame_loadObject(b,f){var h=f._resource;this._scene=b;this._technique=f;this._techniqueResource=h;this._controlGuid.set(h.guid());this._controlCode.set(h.code());this._controlLabel.set(h.label());h=this._controlRenderModes;h.clear();for(var q=f.modes(),u=q.count(),z=0;z<u;z++){var A=q.getAt(z),B=h.createItem(null,A.code());B.setTag(A);h.push(B)}this.onRefresh()}function FDsSceneTechniquePropertyFrame_dispose(){this.__base.FUiForm.dispose.call(this)}
function FDsSceneWorkspace(b){b=RClass.inherits(this,b,FUiWorkspace);b._frameName="design3d.scene.Workspace";b._styleToolbarGround=RClass.register(b,new AStyle("_styleToolbarGround","Toolbar_Ground"));b._styleStatusbarGround=RClass.register(b,new AStyle("_styleStatusbarGround","Statusbar_Ground"));b._styleCatalogGround=RClass.register(b,new AStyle("_styleCatalogGround","Catalog_Ground"));b._styleWorkspaceGround=RClass.register(b,new AStyle("_styleWorkspaceGround","Workspace_Ground"));b._stylePropertyGround=
RClass.register(b,new AStyle("_stylePropertyGround","Property_Ground"));b._framesetMain=null;b._framesetBody=null;b._frameToolBar=null;b._frameBody=null;b._frameProperty=null;b._frameCatalog=null;b._frameWorkspace=null;b._frameStatusBar=null;b._propertyFrames=null;b.onBuilded=FDsSceneWorkspace_onBuilded;b.onSceneLoad=FDsSceneWorkspace_onSceneLoad;b.onCatalogSelected=FDsSceneWorkspace_onCatalogSelected;b.construct=FDsSceneWorkspace_construct;b.findPropertyFrame=FDsSceneWorkspace_findPropertyFrame;
b.loadScene=FDsSceneWorkspace_loadScene;b.dispose=FDsSceneWorkspace_dispose;return b}
function FDsSceneWorkspace_onBuilded(b){this.__base.FUiWorkspace.onBuilded.call(this,b);var f=this._frameToolBar=this.searchControl("toolbarFrame");f._hPanel.className=this.styleName("Toolbar_Ground");f=this._frameCatalog=this.searchControl("catalogFrame");f._hPanel.className=this.styleName("Catalog_Ground");f=this._frameWorkspace=this.searchControl("spaceFrame");f._hPanel.className=this.styleName("Workspace_Ground");f=this._frameProperty=this.searchControl("propertyFrame");f._hPanel.className=this.styleName("Property_Ground");
f=this._frameStatusBar=this.searchControl("statusFrame");f._hPanel.className=this.styleName("Statusbar_Ground");f=this._catalogSplitter=this.searchControl("catalogSpliter");f._alignCd=EUiAlign.Left;f._hSize=this._frameCatalog._hPanel;f=this._propertySpliter=this.searchControl("propertySpliter");f._alignCd=EUiAlign.Right;f._hSize=this._frameStatusBar._hPanel;var h=this._toolbar=RClass.create(FDsSceneMenuBar);h._workspace=this;h.buildDefine(b);this._frameToolBar.push(h);h=this._catalog=RClass.create(FDsSceneCatalog);
h._workspace=this;h.build(b);h.addSelectedListener(this,this.onCatalogSelected);this._frameCatalog.push(h);this._canvasToolbarFrame=this.searchControl("canvasToolbarFrame");h=this._canvasToolbar=RClass.create(FDsSceneCanvasToolBar);h._workspace=this;h.buildDefine(b);this._canvasToolbarFrame.push(h);f=this._canvasFrame=this.searchControl("canvasFrame");h=this._canvas=RClass.create(FDsSceneCanvas);h._workspace=this;h._toolbar=this._canvasToolbar;h.addLoadListener(this,this.onSceneLoad);h._hParent=f._hPanel;
h._hParent.style.backgroundColor="#000000";h.build(b);this._canvasFrame.push(h)}function FDsSceneWorkspace_onSceneLoad(b){b=this._activeScene=b._activeScene;this._catalog.buildScene(b)}
function FDsSceneWorkspace_onCatalogSelected(b,f){for(var h=this._activeScene,q=this._propertyFrames,u=q.count(),z=0;z<u;z++){var A=q.value(z);A.hide()}if(RClass.isClass(b,FE3dScene))A=this.findPropertyFrame(EDsFrame.ScenePropertyFrame),A.show(),A.loadObject(h,b);else if(RClass.isClass(b,FG3dTechnique))A=this.findPropertyFrame(EDsFrame.SceneTechniquePropertyFrame),A.show(),A.loadObject(h,b);else if(RClass.isClass(b,FE3dRegion))A=this.findPropertyFrame(EDsFrame.SceneRegionPropertyFrame),A.show(),A.loadObject(h,
b);else if(RClass.isClass(b,FE3dCamera))A=this.findPropertyFrame(EDsFrame.SceneCameraPropertyFrame),A.show(),A.loadObject(h,b);else if(RClass.isClass(b,FG3dDirectionalLight))A=this.findPropertyFrame(EDsFrame.SceneLightPropertyFrame),A.show(),A.loadObject(h,b);else if("layers"==b)f&&this._canvas.selectLayers(b);else if(RClass.isClass(b,FE3dSceneLayer))f&&this._canvas.selectLayer(b),A=this.findPropertyFrame(EDsFrame.SceneLayerPropertyFrame),A.show(),A.loadObject(h,b);else if(RClass.isClass(b,FE3dSceneDisplay))f&&
this._canvas.selectDisplay(b),A=this.findPropertyFrame(EDsFrame.SceneDisplayPropertyFrame),A.show(),A.loadObject(h,b);else if(RClass.isClass(b,FE3dSceneMaterial))f&&this._canvas.selectMaterial(b),A=this.findPropertyFrame(EDsFrame.SceneMaterialPropertyFrame),A.show(),A.loadObject(h,b);else if(RClass.isClass(b,FE3dRenderable))f&&this._canvas.selectRenderable(b),A=this.findPropertyFrame(EDsFrame.SceneRenderablePropertyFrame),A.show(),A.loadObject(h,b);else throw new TError("Unknown select object type. (value={1})",
b);}function FDsSceneWorkspace_construct(){this.__base.FUiWorkspace.construct.call(this);this._propertyFrames=new TDictionary;var b=RConsole.find(FE3dSceneConsole).factory();b.register(EE3dScene.Layer,FDsSceneLayer);b.register(EE3dScene.Display,FDsSceneDisplay);b.register(EE3dScene.Renderable,FDsSceneRenderable)}
function FDsSceneWorkspace_findPropertyFrame(b){var f=this._propertyFrames.get(b);f||(f=RConsole.find(FFrameConsole).get(this,b,this._frameProperty._hContainer),f._workspace=this,this._propertyFrames.set(b,f));return f}function FDsSceneWorkspace_loadScene(b){this._sceneCode=b;this._canvas.loadScene(b)}function FDsSceneWorkspace_dispose(){this.__base.FUiWorkspace.dispose.call(this);this._propertyFrames.dispose();this._propertyFrames=null};
