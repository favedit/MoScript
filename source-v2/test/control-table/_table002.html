<HTML>
<HEAD>
<TITLE>Class Example</TITLE>
<LINK rel="stylesheet" href='../../_.css' type="text/css" media="all"/>
</HEAD>

<SCRIPT language='javascript' src='../../mobj.js'></SCRIPT>

<SCRIPT language='javascript' src='../../base/FEditor.js'></SCRIPT>
<SCRIPT language='javascript' src='../../base/FTextEditor.js'></SCRIPT>
<SCRIPT language='javascript' src='../../base/FRow.js'></SCRIPT>
<SCRIPT language='javascript' src='../../base/FDataset.js'></SCRIPT>

<SCRIPT language='javascript' src='../../core/FEditConsole.js'></SCRIPT>
<SCRIPT language='javascript' src='../../core/FFocusConsole.js'></SCRIPT>

<SCRIPT language='javascript' src='../EStyleStatus.js'></SCRIPT>
<SCRIPT language='javascript' src='../ECellStatus.js'></SCRIPT>

<SCRIPT language='javascript' src='../MColumnEditable.js'></SCRIPT>

<SCRIPT language='javascript' src='../FDataAction.js'></SCRIPT>
<SCRIPT language='javascript' src='../FPrepareAction.js'></SCRIPT>
<SCRIPT language='javascript' src='../FColumn.js'></SCRIPT>
<SCRIPT language='javascript' src='../FColumnEditable.js'></SCRIPT>
<SCRIPT language='javascript' src='../FColumnStatus.js'></SCRIPT>
<SCRIPT language='javascript' src='../FColumnEdit.js'></SCRIPT>
<SCRIPT language='javascript' src='../FTable.js'></SCRIPT>

<STYLE>
.lstType  { text-align:center; nowrap };
.lstLabel { nowrap };
.lstDate  { nowrap };
.lstUpd   { nowrap };
.lstChk   { nowrap };
</STYLE>

<SCRIPT>
var table = null;
function _da(n){
	if(n == 0){
		table.doAction("doPrepare")
	}
	if(n == 1){
		table.insertRow();
	}
	if(n == 2){
		table.doAction("doUpdate")
	}
	if(n == 3){
		table.deleteRow()
	}
}
function _dump(){
	alert(table.dump());
	//RDump.dump(_id3, table);
}
function _load(){
	RGlobal.setContext('jp','../../..','/system');
	//RLog.link(_id0);

   table = RControl.fromXml(xTable, _table);
	table.loadDataset(RXml.makeNode(xDataset));

   //RDump.dump(_id3, table)
}
</SCRIPT>

<XML ID="xTable">
	<Table insert_able='Y' update_able='Y' delete_able='Y'>
		<PrepareAction name='doPrepare' service='prepare.xml' />
		<DataAction    name='doUpdate'  service='update.xml' />

		<ColumnEdit   name='type'   width='60' data_name='type' icon='tool.insert' caption='種類' edit_insert='Y' edit_update='N'/>
		<ColumnEdit   name='label'  width='80' data_name='label' icon='tool.update' caption='名前' edit_update='Y'/>
		<Column       name='update' width='100' data_name='update' caption='更新日時' edit_update='N'/>
		<Column       name='user'   width='120' data_name='user' caption='更新者' edit_update='N'/>
		<ColumnEdit   name='check'  width='120' data_name='check' caption='チェックアウト先' edit_insert='Y' edit_update='Y'/>

		<Row type='table' label='表紙1' update='2007/12/21 19:08' user='Murakami, Takao X'/>
		<Row type='table' label='表紙2' update='2007/12/21 19:08' user='Murakami, Takao X' check='check'/>
	</Table>
</XML>

<XML ID="xDataset">
	<Dataset>
		<Row type='table' label='表紙3' update='2007/12/21 19:08' user='Murakami, Takao X' check='check'/>
		<Row type='table' label='表紙4' update='2007/12/21 19:08' user='Murakami' check='check'/>
		<Row type='table' label='表紙3' update='2007/12/21 19:08' user='Murakami, Takao X' check='check'/>
		<Row type='table' label='表紙4' update='2007/12/21 19:08' user='Murakami' check='check'/>
	</Dataset>
</XML>

<BODY onload='_load()'>

<input type='BUTTON' value='Dump' onclick='_dump()'></input> | 
<input type='BUTTON' value='Prepare' onclick='_da(0)'></input> | 
<input type='BUTTON' value='Insert'  onclick='_da(1)'></input> | 
<input type='BUTTON' value='Update'  onclick='_da(2)'></input> | 
<input type='BUTTON' value='Delete'  onclick='_da(3)'></input>
<BR>
<BUTTON onclick="oID_1.rules=''">No borders</BUTTON>
<BUTTON onclick="oID_1.rules='none'">Exterior border</BUTTON>
<BUTTON onclick="oID_1.rules='all'">All borders</BUTTON><BR>
<BUTTON onclick="oID_1.rules='cols'">Column borders</BUTTON>
<BUTTON onclick="oID_1.rules='groups'">Groups borders</BUTTON>
<BUTTON onclick="oID_1.rules='rows'">Table row borders</BUTTON>

<DIV id='_id' style='border:1 solid red'></DIV>

<BR><BR><BR><BR>
<DIV id='_table'></DIV><br>
<DIV id='_id0'></DIV><br>
<DIV id='_id1'></DIV><br>
<DIV id='_id2'></DIV><br>
<DIV id='_id3'></DIV><br>
<DIV id='_id4'></DIV><br>
<DIV id='_msg'></DIV><br>
</BODY>

</HTML>
